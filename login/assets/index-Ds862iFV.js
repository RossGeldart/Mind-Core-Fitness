const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Dashboard-DOGuCa3k.js","assets/Dashboard-kTCGLGDk.css","assets/AddClient-CvtG-fF2.js","assets/AddClient-DH1OFzHo.css","assets/ClientForms-BjrgJYv_.js","assets/ClientForms-GDNtnrAx.css","assets/ClientTools-Deb-2sGs.js","assets/ClientTools-DQRPoST3.css","assets/MacroCalculator-CdzdCWSs.js","assets/ProteinSnacks-DWLrntCz.js","assets/DailyMotivation-DKDI59rT.js","assets/CircuitDashboard-AWgEst_w.js","assets/CircuitDashboard-C8T0uect.css","assets/CircuitBooking-BD6VZOio.js","assets/CircuitBooking-ruk9Q4Wj.css","assets/Leaderboard-BhZsi2OG.js","assets/Leaderboard-Dq-r5svP.css","assets/UpgradePage-CF9PdQsk.js","assets/stripe-7qEIN5w7.js","assets/UpgradePage-Blt11CID.css","assets/Onboarding-Dx0oEWRu.js","assets/Onboarding-Bku4iVdQ.css"])))=>i.map(i=>d[i]);
(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))i(l);new MutationObserver(l=>{for(const u of l)if(u.type==="childList")for(const d of u.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&i(d)}).observe(document,{childList:!0,subtree:!0});function t(l){const u={};return l.integrity&&(u.integrity=l.integrity),l.referrerPolicy&&(u.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?u.credentials="include":l.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function i(l){if(l.ep)return;l.ep=!0;const u=t(l);fetch(l.href,u)}})();var gp={exports:{}},$c={};var v1;function gT(){if(v1)return $c;v1=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(i,l,u){var d=null;if(u!==void 0&&(d=""+u),l.key!==void 0&&(d=""+l.key),"key"in l){u={};for(var p in l)p!=="key"&&(u[p]=l[p])}else u=l;return l=u.ref,{$$typeof:n,type:i,key:d,ref:l!==void 0?l:null,props:u}}return $c.Fragment=e,$c.jsx=t,$c.jsxs=t,$c}var x1;function yT(){return x1||(x1=1,gp.exports=gT()),gp.exports}var r=yT(),yp={exports:{}},Yt={};var w1;function bT(){if(w1)return Yt;w1=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),l=Symbol.for("react.profiler"),u=Symbol.for("react.consumer"),d=Symbol.for("react.context"),p=Symbol.for("react.forward_ref"),g=Symbol.for("react.suspense"),y=Symbol.for("react.memo"),w=Symbol.for("react.lazy"),j=Symbol.for("react.activity"),T=Symbol.iterator;function V(L){return L===null||typeof L!="object"?null:(L=T&&L[T]||L["@@iterator"],typeof L=="function"?L:null)}var W={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},F=Object.assign,U={};function ne(L,se,Me){this.props=L,this.context=se,this.refs=U,this.updater=Me||W}ne.prototype.isReactComponent={},ne.prototype.setState=function(L,se){if(typeof L!="object"&&typeof L!="function"&&L!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,L,se,"setState")},ne.prototype.forceUpdate=function(L){this.updater.enqueueForceUpdate(this,L,"forceUpdate")};function Y(){}Y.prototype=ne.prototype;function oe(L,se,Me){this.props=L,this.context=se,this.refs=U,this.updater=Me||W}var be=oe.prototype=new Y;be.constructor=oe,F(be,ne.prototype),be.isPureReactComponent=!0;var Le=Array.isArray;function Ce(){}var R={H:null,A:null,T:null,S:null},E=Object.prototype.hasOwnProperty;function A(L,se,Me){var De=Me.ref;return{$$typeof:n,type:L,key:se,ref:De!==void 0?De:null,props:Me}}function O(L,se){return A(L.type,se,L.props)}function D(L){return typeof L=="object"&&L!==null&&L.$$typeof===n}function H(L){var se={"=":"=0",":":"=2"};return"$"+L.replace(/[=:]/g,function(Me){return se[Me]})}var M=/\/+/g;function We(L,se){return typeof L=="object"&&L!==null&&L.key!=null?H(""+L.key):se.toString(36)}function gt(L){switch(L.status){case"fulfilled":return L.value;case"rejected":throw L.reason;default:switch(typeof L.status=="string"?L.then(Ce,Ce):(L.status="pending",L.then(function(se){L.status==="pending"&&(L.status="fulfilled",L.value=se)},function(se){L.status==="pending"&&(L.status="rejected",L.reason=se)})),L.status){case"fulfilled":return L.value;case"rejected":throw L.reason}}throw L}function $(L,se,Me,De,Je){var Fe=typeof L;(Fe==="undefined"||Fe==="boolean")&&(L=null);var bt=!1;if(L===null)bt=!0;else switch(Fe){case"bigint":case"string":case"number":bt=!0;break;case"object":switch(L.$$typeof){case n:case e:bt=!0;break;case w:return bt=L._init,$(bt(L._payload),se,Me,De,Je)}}if(bt)return Je=Je(L),bt=De===""?"."+We(L,0):De,Le(Je)?(Me="",bt!=null&&(Me=bt.replace(M,"$&/")+"/"),$(Je,se,Me,"",function(Wt){return Wt})):Je!=null&&(D(Je)&&(Je=O(Je,Me+(Je.key==null||L&&L.key===Je.key?"":(""+Je.key).replace(M,"$&/")+"/")+bt)),se.push(Je)),1;bt=0;var kt=De===""?".":De+":";if(Le(L))for(var nt=0;nt<L.length;nt++)De=L[nt],Fe=kt+We(De,nt),bt+=$(De,se,Me,Fe,Je);else if(nt=V(L),typeof nt=="function")for(L=nt.call(L),nt=0;!(De=L.next()).done;)De=De.value,Fe=kt+We(De,nt++),bt+=$(De,se,Me,Fe,Je);else if(Fe==="object"){if(typeof L.then=="function")return $(gt(L),se,Me,De,Je);throw se=String(L),Error("Objects are not valid as a React child (found: "+(se==="[object Object]"?"object with keys {"+Object.keys(L).join(", ")+"}":se)+"). If you meant to render a collection of children, use an array instead.")}return bt}function me(L,se,Me){if(L==null)return L;var De=[],Je=0;return $(L,De,"","",function(Fe){return se.call(Me,Fe,Je++)}),De}function Ve(L){if(L._status===-1){var se=L._result;se=se(),se.then(function(Me){(L._status===0||L._status===-1)&&(L._status=1,L._result=Me)},function(Me){(L._status===0||L._status===-1)&&(L._status=2,L._result=Me)}),L._status===-1&&(L._status=0,L._result=se)}if(L._status===1)return L._result.default;throw L._result}var Ke=typeof reportError=="function"?reportError:function(L){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var se=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof L=="object"&&L!==null&&typeof L.message=="string"?String(L.message):String(L),error:L});if(!window.dispatchEvent(se))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",L);return}console.error(L)},J={map:me,forEach:function(L,se,Me){me(L,function(){se.apply(this,arguments)},Me)},count:function(L){var se=0;return me(L,function(){se++}),se},toArray:function(L){return me(L,function(se){return se})||[]},only:function(L){if(!D(L))throw Error("React.Children.only expected to receive a single React element child.");return L}};return Yt.Activity=j,Yt.Children=J,Yt.Component=ne,Yt.Fragment=t,Yt.Profiler=l,Yt.PureComponent=oe,Yt.StrictMode=i,Yt.Suspense=g,Yt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=R,Yt.__COMPILER_RUNTIME={__proto__:null,c:function(L){return R.H.useMemoCache(L)}},Yt.cache=function(L){return function(){return L.apply(null,arguments)}},Yt.cacheSignal=function(){return null},Yt.cloneElement=function(L,se,Me){if(L==null)throw Error("The argument must be a React element, but you passed "+L+".");var De=F({},L.props),Je=L.key;if(se!=null)for(Fe in se.key!==void 0&&(Je=""+se.key),se)!E.call(se,Fe)||Fe==="key"||Fe==="__self"||Fe==="__source"||Fe==="ref"&&se.ref===void 0||(De[Fe]=se[Fe]);var Fe=arguments.length-2;if(Fe===1)De.children=Me;else if(1<Fe){for(var bt=Array(Fe),kt=0;kt<Fe;kt++)bt[kt]=arguments[kt+2];De.children=bt}return A(L.type,Je,De)},Yt.createContext=function(L){return L={$$typeof:d,_currentValue:L,_currentValue2:L,_threadCount:0,Provider:null,Consumer:null},L.Provider=L,L.Consumer={$$typeof:u,_context:L},L},Yt.createElement=function(L,se,Me){var De,Je={},Fe=null;if(se!=null)for(De in se.key!==void 0&&(Fe=""+se.key),se)E.call(se,De)&&De!=="key"&&De!=="__self"&&De!=="__source"&&(Je[De]=se[De]);var bt=arguments.length-2;if(bt===1)Je.children=Me;else if(1<bt){for(var kt=Array(bt),nt=0;nt<bt;nt++)kt[nt]=arguments[nt+2];Je.children=kt}if(L&&L.defaultProps)for(De in bt=L.defaultProps,bt)Je[De]===void 0&&(Je[De]=bt[De]);return A(L,Fe,Je)},Yt.createRef=function(){return{current:null}},Yt.forwardRef=function(L){return{$$typeof:p,render:L}},Yt.isValidElement=D,Yt.lazy=function(L){return{$$typeof:w,_payload:{_status:-1,_result:L},_init:Ve}},Yt.memo=function(L,se){return{$$typeof:y,type:L,compare:se===void 0?null:se}},Yt.startTransition=function(L){var se=R.T,Me={};R.T=Me;try{var De=L(),Je=R.S;Je!==null&&Je(Me,De),typeof De=="object"&&De!==null&&typeof De.then=="function"&&De.then(Ce,Ke)}catch(Fe){Ke(Fe)}finally{se!==null&&Me.types!==null&&(se.types=Me.types),R.T=se}},Yt.unstable_useCacheRefresh=function(){return R.H.useCacheRefresh()},Yt.use=function(L){return R.H.use(L)},Yt.useActionState=function(L,se,Me){return R.H.useActionState(L,se,Me)},Yt.useCallback=function(L,se){return R.H.useCallback(L,se)},Yt.useContext=function(L){return R.H.useContext(L)},Yt.useDebugValue=function(){},Yt.useDeferredValue=function(L,se){return R.H.useDeferredValue(L,se)},Yt.useEffect=function(L,se){return R.H.useEffect(L,se)},Yt.useEffectEvent=function(L){return R.H.useEffectEvent(L)},Yt.useId=function(){return R.H.useId()},Yt.useImperativeHandle=function(L,se,Me){return R.H.useImperativeHandle(L,se,Me)},Yt.useInsertionEffect=function(L,se){return R.H.useInsertionEffect(L,se)},Yt.useLayoutEffect=function(L,se){return R.H.useLayoutEffect(L,se)},Yt.useMemo=function(L,se){return R.H.useMemo(L,se)},Yt.useOptimistic=function(L,se){return R.H.useOptimistic(L,se)},Yt.useReducer=function(L,se,Me){return R.H.useReducer(L,se,Me)},Yt.useRef=function(L){return R.H.useRef(L)},Yt.useState=function(L){return R.H.useState(L)},Yt.useSyncExternalStore=function(L,se,Me){return R.H.useSyncExternalStore(L,se,Me)},Yt.useTransition=function(){return R.H.useTransition()},Yt.version="19.2.4",Yt}var _1;function Mg(){return _1||(_1=1,yp.exports=bT()),yp.exports}var v=Mg(),bp={exports:{}},Wc={},vp={exports:{}},xp={};var k1;function vT(){return k1||(k1=1,(function(n){function e($,me){var Ve=$.length;$.push(me);e:for(;0<Ve;){var Ke=Ve-1>>>1,J=$[Ke];if(0<l(J,me))$[Ke]=me,$[Ve]=J,Ve=Ke;else break e}}function t($){return $.length===0?null:$[0]}function i($){if($.length===0)return null;var me=$[0],Ve=$.pop();if(Ve!==me){$[0]=Ve;e:for(var Ke=0,J=$.length,L=J>>>1;Ke<L;){var se=2*(Ke+1)-1,Me=$[se],De=se+1,Je=$[De];if(0>l(Me,Ve))De<J&&0>l(Je,Me)?($[Ke]=Je,$[De]=Ve,Ke=De):($[Ke]=Me,$[se]=Ve,Ke=se);else if(De<J&&0>l(Je,Ve))$[Ke]=Je,$[De]=Ve,Ke=De;else break e}}return me}function l($,me){var Ve=$.sortIndex-me.sortIndex;return Ve!==0?Ve:$.id-me.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var u=performance;n.unstable_now=function(){return u.now()}}else{var d=Date,p=d.now();n.unstable_now=function(){return d.now()-p}}var g=[],y=[],w=1,j=null,T=3,V=!1,W=!1,F=!1,U=!1,ne=typeof setTimeout=="function"?setTimeout:null,Y=typeof clearTimeout=="function"?clearTimeout:null,oe=typeof setImmediate<"u"?setImmediate:null;function be($){for(var me=t(y);me!==null;){if(me.callback===null)i(y);else if(me.startTime<=$)i(y),me.sortIndex=me.expirationTime,e(g,me);else break;me=t(y)}}function Le($){if(F=!1,be($),!W)if(t(g)!==null)W=!0,Ce||(Ce=!0,H());else{var me=t(y);me!==null&&gt(Le,me.startTime-$)}}var Ce=!1,R=-1,E=5,A=-1;function O(){return U?!0:!(n.unstable_now()-A<E)}function D(){if(U=!1,Ce){var $=n.unstable_now();A=$;var me=!0;try{e:{W=!1,F&&(F=!1,Y(R),R=-1),V=!0;var Ve=T;try{t:{for(be($),j=t(g);j!==null&&!(j.expirationTime>$&&O());){var Ke=j.callback;if(typeof Ke=="function"){j.callback=null,T=j.priorityLevel;var J=Ke(j.expirationTime<=$);if($=n.unstable_now(),typeof J=="function"){j.callback=J,be($),me=!0;break t}j===t(g)&&i(g),be($)}else i(g);j=t(g)}if(j!==null)me=!0;else{var L=t(y);L!==null&&gt(Le,L.startTime-$),me=!1}}break e}finally{j=null,T=Ve,V=!1}me=void 0}}finally{me?H():Ce=!1}}}var H;if(typeof oe=="function")H=function(){oe(D)};else if(typeof MessageChannel<"u"){var M=new MessageChannel,We=M.port2;M.port1.onmessage=D,H=function(){We.postMessage(null)}}else H=function(){ne(D,0)};function gt($,me){R=ne(function(){$(n.unstable_now())},me)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function($){$.callback=null},n.unstable_forceFrameRate=function($){0>$||125<$?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):E=0<$?Math.floor(1e3/$):5},n.unstable_getCurrentPriorityLevel=function(){return T},n.unstable_next=function($){switch(T){case 1:case 2:case 3:var me=3;break;default:me=T}var Ve=T;T=me;try{return $()}finally{T=Ve}},n.unstable_requestPaint=function(){U=!0},n.unstable_runWithPriority=function($,me){switch($){case 1:case 2:case 3:case 4:case 5:break;default:$=3}var Ve=T;T=$;try{return me()}finally{T=Ve}},n.unstable_scheduleCallback=function($,me,Ve){var Ke=n.unstable_now();switch(typeof Ve=="object"&&Ve!==null?(Ve=Ve.delay,Ve=typeof Ve=="number"&&0<Ve?Ke+Ve:Ke):Ve=Ke,$){case 1:var J=-1;break;case 2:J=250;break;case 5:J=1073741823;break;case 4:J=1e4;break;default:J=5e3}return J=Ve+J,$={id:w++,callback:me,priorityLevel:$,startTime:Ve,expirationTime:J,sortIndex:-1},Ve>Ke?($.sortIndex=Ve,e(y,$),t(g)===null&&$===t(y)&&(F?(Y(R),R=-1):F=!0,gt(Le,Ve-Ke))):($.sortIndex=J,e(g,$),W||V||(W=!0,Ce||(Ce=!0,H()))),$},n.unstable_shouldYield=O,n.unstable_wrapCallback=function($){var me=T;return function(){var Ve=T;T=me;try{return $.apply(this,arguments)}finally{T=Ve}}}})(xp)),xp}var j1;function xT(){return j1||(j1=1,vp.exports=vT()),vp.exports}var wp={exports:{}},ar={};var T1;function wT(){if(T1)return ar;T1=1;var n=Mg();function e(g){var y="https://react.dev/errors/"+g;if(1<arguments.length){y+="?args[]="+encodeURIComponent(arguments[1]);for(var w=2;w<arguments.length;w++)y+="&args[]="+encodeURIComponent(arguments[w])}return"Minified React error #"+g+"; visit "+y+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var i={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},l=Symbol.for("react.portal");function u(g,y,w){var j=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:l,key:j==null?null:""+j,children:g,containerInfo:y,implementation:w}}var d=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function p(g,y){if(g==="font")return"";if(typeof y=="string")return y==="use-credentials"?y:""}return ar.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,ar.createPortal=function(g,y){var w=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!y||y.nodeType!==1&&y.nodeType!==9&&y.nodeType!==11)throw Error(e(299));return u(g,y,null,w)},ar.flushSync=function(g){var y=d.T,w=i.p;try{if(d.T=null,i.p=2,g)return g()}finally{d.T=y,i.p=w,i.d.f()}},ar.preconnect=function(g,y){typeof g=="string"&&(y?(y=y.crossOrigin,y=typeof y=="string"?y==="use-credentials"?y:"":void 0):y=null,i.d.C(g,y))},ar.prefetchDNS=function(g){typeof g=="string"&&i.d.D(g)},ar.preinit=function(g,y){if(typeof g=="string"&&y&&typeof y.as=="string"){var w=y.as,j=p(w,y.crossOrigin),T=typeof y.integrity=="string"?y.integrity:void 0,V=typeof y.fetchPriority=="string"?y.fetchPriority:void 0;w==="style"?i.d.S(g,typeof y.precedence=="string"?y.precedence:void 0,{crossOrigin:j,integrity:T,fetchPriority:V}):w==="script"&&i.d.X(g,{crossOrigin:j,integrity:T,fetchPriority:V,nonce:typeof y.nonce=="string"?y.nonce:void 0})}},ar.preinitModule=function(g,y){if(typeof g=="string")if(typeof y=="object"&&y!==null){if(y.as==null||y.as==="script"){var w=p(y.as,y.crossOrigin);i.d.M(g,{crossOrigin:w,integrity:typeof y.integrity=="string"?y.integrity:void 0,nonce:typeof y.nonce=="string"?y.nonce:void 0})}}else y==null&&i.d.M(g)},ar.preload=function(g,y){if(typeof g=="string"&&typeof y=="object"&&y!==null&&typeof y.as=="string"){var w=y.as,j=p(w,y.crossOrigin);i.d.L(g,w,{crossOrigin:j,integrity:typeof y.integrity=="string"?y.integrity:void 0,nonce:typeof y.nonce=="string"?y.nonce:void 0,type:typeof y.type=="string"?y.type:void 0,fetchPriority:typeof y.fetchPriority=="string"?y.fetchPriority:void 0,referrerPolicy:typeof y.referrerPolicy=="string"?y.referrerPolicy:void 0,imageSrcSet:typeof y.imageSrcSet=="string"?y.imageSrcSet:void 0,imageSizes:typeof y.imageSizes=="string"?y.imageSizes:void 0,media:typeof y.media=="string"?y.media:void 0})}},ar.preloadModule=function(g,y){if(typeof g=="string")if(y){var w=p(y.as,y.crossOrigin);i.d.m(g,{as:typeof y.as=="string"&&y.as!=="script"?y.as:void 0,crossOrigin:w,integrity:typeof y.integrity=="string"?y.integrity:void 0})}else i.d.m(g)},ar.requestFormReset=function(g){i.d.r(g)},ar.unstable_batchedUpdates=function(g,y){return g(y)},ar.useFormState=function(g,y,w){return d.H.useFormState(g,y,w)},ar.useFormStatus=function(){return d.H.useHostTransitionStatus()},ar.version="19.2.4",ar}var E1;function _T(){if(E1)return wp.exports;E1=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),wp.exports=wT(),wp.exports}var N1;function kT(){if(N1)return Wc;N1=1;var n=xT(),e=Mg(),t=_T();function i(s){var a="https://react.dev/errors/"+s;if(1<arguments.length){a+="?args[]="+encodeURIComponent(arguments[1]);for(var o=2;o<arguments.length;o++)a+="&args[]="+encodeURIComponent(arguments[o])}return"Minified React error #"+s+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function l(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function u(s){var a=s,o=s;if(s.alternate)for(;a.return;)a=a.return;else{s=a;do a=s,(a.flags&4098)!==0&&(o=a.return),s=a.return;while(s)}return a.tag===3?o:null}function d(s){if(s.tag===13){var a=s.memoizedState;if(a===null&&(s=s.alternate,s!==null&&(a=s.memoizedState)),a!==null)return a.dehydrated}return null}function p(s){if(s.tag===31){var a=s.memoizedState;if(a===null&&(s=s.alternate,s!==null&&(a=s.memoizedState)),a!==null)return a.dehydrated}return null}function g(s){if(u(s)!==s)throw Error(i(188))}function y(s){var a=s.alternate;if(!a){if(a=u(s),a===null)throw Error(i(188));return a!==s?null:s}for(var o=s,c=a;;){var m=o.return;if(m===null)break;var f=m.alternate;if(f===null){if(c=m.return,c!==null){o=c;continue}break}if(m.child===f.child){for(f=m.child;f;){if(f===o)return g(m),s;if(f===c)return g(m),a;f=f.sibling}throw Error(i(188))}if(o.return!==c.return)o=m,c=f;else{for(var x=!1,N=m.child;N;){if(N===o){x=!0,o=m,c=f;break}if(N===c){x=!0,c=m,o=f;break}N=N.sibling}if(!x){for(N=f.child;N;){if(N===o){x=!0,o=f,c=m;break}if(N===c){x=!0,c=f,o=m;break}N=N.sibling}if(!x)throw Error(i(189))}}if(o.alternate!==c)throw Error(i(190))}if(o.tag!==3)throw Error(i(188));return o.stateNode.current===o?s:a}function w(s){var a=s.tag;if(a===5||a===26||a===27||a===6)return s;for(s=s.child;s!==null;){if(a=w(s),a!==null)return a;s=s.sibling}return null}var j=Object.assign,T=Symbol.for("react.element"),V=Symbol.for("react.transitional.element"),W=Symbol.for("react.portal"),F=Symbol.for("react.fragment"),U=Symbol.for("react.strict_mode"),ne=Symbol.for("react.profiler"),Y=Symbol.for("react.consumer"),oe=Symbol.for("react.context"),be=Symbol.for("react.forward_ref"),Le=Symbol.for("react.suspense"),Ce=Symbol.for("react.suspense_list"),R=Symbol.for("react.memo"),E=Symbol.for("react.lazy"),A=Symbol.for("react.activity"),O=Symbol.for("react.memo_cache_sentinel"),D=Symbol.iterator;function H(s){return s===null||typeof s!="object"?null:(s=D&&s[D]||s["@@iterator"],typeof s=="function"?s:null)}var M=Symbol.for("react.client.reference");function We(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===M?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case F:return"Fragment";case ne:return"Profiler";case U:return"StrictMode";case Le:return"Suspense";case Ce:return"SuspenseList";case A:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case W:return"Portal";case oe:return s.displayName||"Context";case Y:return(s._context.displayName||"Context")+".Consumer";case be:var a=s.render;return s=s.displayName,s||(s=a.displayName||a.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case R:return a=s.displayName||null,a!==null?a:We(s.type)||"Memo";case E:a=s._payload,s=s._init;try{return We(s(a))}catch{}}return null}var gt=Array.isArray,$=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,me=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Ve={pending:!1,data:null,method:null,action:null},Ke=[],J=-1;function L(s){return{current:s}}function se(s){0>J||(s.current=Ke[J],Ke[J]=null,J--)}function Me(s,a){J++,Ke[J]=s.current,s.current=a}var De=L(null),Je=L(null),Fe=L(null),bt=L(null);function kt(s,a){switch(Me(Fe,a),Me(Je,s),Me(De,null),a.nodeType){case 9:case 11:s=(s=a.documentElement)&&(s=s.namespaceURI)?z0(s):0;break;default:if(s=a.tagName,a=a.namespaceURI)a=z0(a),s=q0(a,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}se(De),Me(De,s)}function nt(){se(De),se(Je),se(Fe)}function Wt(s){s.memoizedState!==null&&Me(bt,s);var a=De.current,o=q0(a,s.type);a!==o&&(Me(Je,s),Me(De,o))}function ts(s){Je.current===s&&(se(De),se(Je)),bt.current===s&&(se(bt),Fc._currentValue=Ve)}var St,at;function ce(s){if(St===void 0)try{throw Error()}catch(o){var a=o.stack.trim().match(/\n( *(at )?)/);St=a&&a[1]||"",at=-1<o.stack.indexOf(`
    at`)?" (<anonymous>)":-1<o.stack.indexOf("@")?"@unknown:0:0":""}return`
`+St+s+at}var Xt=!1;function Gt(s,a){if(!s||Xt)return"";Xt=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var c={DetermineComponentFrameRoot:function(){try{if(a){var Ie=function(){throw Error()};if(Object.defineProperty(Ie.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Ie,[])}catch(ye){var le=ye}Reflect.construct(s,[],Ie)}else{try{Ie.call()}catch(ye){le=ye}s.call(Ie.prototype)}}else{try{throw Error()}catch(ye){le=ye}(Ie=s())&&typeof Ie.catch=="function"&&Ie.catch(function(){})}}catch(ye){if(ye&&le&&typeof ye.stack=="string")return[ye.stack,le.stack]}return[null,null]}};c.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var m=Object.getOwnPropertyDescriptor(c.DetermineComponentFrameRoot,"name");m&&m.configurable&&Object.defineProperty(c.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var f=c.DetermineComponentFrameRoot(),x=f[0],N=f[1];if(x&&N){var z=x.split(`
`),ie=N.split(`
`);for(m=c=0;c<z.length&&!z[c].includes("DetermineComponentFrameRoot");)c++;for(;m<ie.length&&!ie[m].includes("DetermineComponentFrameRoot");)m++;if(c===z.length||m===ie.length)for(c=z.length-1,m=ie.length-1;1<=c&&0<=m&&z[c]!==ie[m];)m--;for(;1<=c&&0<=m;c--,m--)if(z[c]!==ie[m]){if(c!==1||m!==1)do if(c--,m--,0>m||z[c]!==ie[m]){var ke=`
`+z[c].replace(" at new "," at ");return s.displayName&&ke.includes("<anonymous>")&&(ke=ke.replace("<anonymous>",s.displayName)),ke}while(1<=c&&0<=m);break}}}finally{Xt=!1,Error.prepareStackTrace=o}return(o=s?s.displayName||s.name:"")?ce(o):""}function rt(s,a){switch(s.tag){case 26:case 27:case 5:return ce(s.type);case 16:return ce("Lazy");case 13:return s.child!==a&&a!==null?ce("Suspense Fallback"):ce("Suspense");case 19:return ce("SuspenseList");case 0:case 15:return Gt(s.type,!1);case 11:return Gt(s.type.render,!1);case 1:return Gt(s.type,!0);case 31:return ce("Activity");default:return""}}function pt(s){try{var a="",o=null;do a+=rt(s,o),o=s,s=s.return;while(s);return a}catch(c){return`
Error generating stack: `+c.message+`
`+c.stack}}var it=Object.prototype.hasOwnProperty,st=n.unstable_scheduleCallback,Kt=n.unstable_cancelCallback,Ks=n.unstable_shouldYield,Ps=n.unstable_requestPaint,ss=n.unstable_now,Ct=n.unstable_getCurrentPriorityLevel,Jt=n.unstable_ImmediatePriority,vs=n.unstable_UserBlockingPriority,Bt=n.unstable_NormalPriority,As=n.unstable_LowPriority,ue=n.unstable_IdlePriority,Ee=n.log,Ae=n.unstable_setDisableYieldValue,ee=null,ge=null;function we(s){if(typeof Ee=="function"&&Ae(s),ge&&typeof ge.setStrictMode=="function")try{ge.setStrictMode(ee,s)}catch{}}var Oe=Math.clz32?Math.clz32:ft,Ue=Math.log,$e=Math.LN2;function ft(s){return s>>>=0,s===0?32:31-(Ue(s)/$e|0)|0}var jt=256,Q=262144,fe=4194304;function lt(s){var a=s&42;if(a!==0)return a;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return s&261888;case 262144:case 524288:case 1048576:case 2097152:return s&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function At(s,a,o){var c=s.pendingLanes;if(c===0)return 0;var m=0,f=s.suspendedLanes,x=s.pingedLanes;s=s.warmLanes;var N=c&134217727;return N!==0?(c=N&~f,c!==0?m=lt(c):(x&=N,x!==0?m=lt(x):o||(o=N&~s,o!==0&&(m=lt(o))))):(N=c&~f,N!==0?m=lt(N):x!==0?m=lt(x):o||(o=c&~s,o!==0&&(m=lt(o)))),m===0?0:a!==0&&a!==m&&(a&f)===0&&(f=m&-m,o=a&-a,f>=o||f===32&&(o&4194048)!==0)?a:m}function Tt(s,a){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&a)===0}function ns(s,a){switch(s){case 1:case 2:case 4:case 8:case 64:return a+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ut(){var s=fe;return fe<<=1,(fe&62914560)===0&&(fe=4194304),s}function Ot(s){for(var a=[],o=0;31>o;o++)a.push(s);return a}function Ls(s,a){s.pendingLanes|=a,a!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function Js(s,a,o,c,m,f){var x=s.pendingLanes;s.pendingLanes=o,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=o,s.entangledLanes&=o,s.errorRecoveryDisabledLanes&=o,s.shellSuspendCounter=0;var N=s.entanglements,z=s.expirationTimes,ie=s.hiddenUpdates;for(o=x&~o;0<o;){var ke=31-Oe(o),Ie=1<<ke;N[ke]=0,z[ke]=-1;var le=ie[ke];if(le!==null)for(ie[ke]=null,ke=0;ke<le.length;ke++){var ye=le[ke];ye!==null&&(ye.lane&=-536870913)}o&=~Ie}c!==0&&os(s,c,0),f!==0&&m===0&&s.tag!==0&&(s.suspendedLanes|=f&~(x&~a))}function os(s,a,o){s.pendingLanes|=a,s.suspendedLanes&=~a;var c=31-Oe(a);s.entangledLanes|=a,s.entanglements[c]=s.entanglements[c]|1073741824|o&261930}function Ss(s,a){var o=s.entangledLanes|=a;for(s=s.entanglements;o;){var c=31-Oe(o),m=1<<c;m&a|s[c]&a&&(s[c]|=a),o&=~m}}function Os(s,a){var o=a&-a;return o=(o&42)!==0?1:q(o),(o&(s.suspendedLanes|a))!==0?0:o}function q(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function xe(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function je(){var s=me.p;return s!==0?s:(s=window.event,s===void 0?32:h1(s.type))}function Te(s,a){var o=me.p;try{return me.p=s,a()}finally{me.p=o}}var _e=Math.random().toString(36).slice(2),ct="__reactFiber$"+_e,ht="__reactProps$"+_e,et="__reactContainer$"+_e,vt="__reactEvents$"+_e,Rt="__reactListeners$"+_e,js="__reactHandles$"+_e,mn="__reactResources$"+_e,ln="__reactMarker$"+_e;function _n(s){delete s[ct],delete s[ht],delete s[vt],delete s[Rt],delete s[js]}function kn(s){var a=s[ct];if(a)return a;for(var o=s.parentNode;o;){if(a=o[et]||o[ct]){if(o=a.alternate,a.child!==null||o!==null&&o.child!==null)for(s=Q0(s);s!==null;){if(o=s[ct])return o;s=Q0(s)}return a}s=o,o=s.parentNode}return null}function fn(s){if(s=s[ct]||s[et]){var a=s.tag;if(a===5||a===6||a===13||a===31||a===26||a===27||a===3)return s}return null}function Fs(s){var a=s.tag;if(a===5||a===26||a===27||a===6)return s.stateNode;throw Error(i(33))}function k(s){var a=s[mn];return a||(a=s[mn]={hoistableStyles:new Map,hoistableScripts:new Map}),a}function S(s){s[ln]=!0}var P=new Set,B={};function de(s,a){Be(s,a),Be(s+"Capture",a)}function Be(s,a){for(B[s]=a,s=0;s<a.length;s++)P.add(a[s])}var ze=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Qe={},Xe={};function qt(s){return it.call(Xe,s)?!0:it.call(Qe,s)?!1:ze.test(s)?Xe[s]=!0:(Qe[s]=!0,!1)}function xs(s,a,o){if(qt(a))if(o===null)s.removeAttribute(a);else{switch(typeof o){case"undefined":case"function":case"symbol":s.removeAttribute(a);return;case"boolean":var c=a.toLowerCase().slice(0,5);if(c!=="data-"&&c!=="aria-"){s.removeAttribute(a);return}}s.setAttribute(a,""+o)}}function ls(s,a,o){if(o===null)s.removeAttribute(a);else{switch(typeof o){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(a);return}s.setAttribute(a,""+o)}}function cs(s,a,o,c){if(c===null)s.removeAttribute(o);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(o);return}s.setAttributeNS(a,o,""+c)}}function Cs(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function K(s){var a=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(a==="checkbox"||a==="radio")}function ve(s,a,o){var c=Object.getOwnPropertyDescriptor(s.constructor.prototype,a);if(!s.hasOwnProperty(a)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var m=c.get,f=c.set;return Object.defineProperty(s,a,{configurable:!0,get:function(){return m.call(this)},set:function(x){o=""+x,f.call(this,x)}}),Object.defineProperty(s,a,{enumerable:c.enumerable}),{getValue:function(){return o},setValue:function(x){o=""+x},stopTracking:function(){s._valueTracker=null,delete s[a]}}}}function te(s){if(!s._valueTracker){var a=K(s)?"checked":"value";s._valueTracker=ve(s,a,""+s[a])}}function qe(s){if(!s)return!1;var a=s._valueTracker;if(!a)return!0;var o=a.getValue(),c="";return s&&(c=K(s)?s.checked?"true":"false":s.value),s=c,s!==o?(a.setValue(s),!0):!1}function Ge(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var ut=/[\n"\\]/g;function wt(s){return s.replace(ut,function(a){return"\\"+a.charCodeAt(0).toString(16)+" "})}function Mt(s,a,o,c,m,f,x,N){s.name="",x!=null&&typeof x!="function"&&typeof x!="symbol"&&typeof x!="boolean"?s.type=x:s.removeAttribute("type"),a!=null?x==="number"?(a===0&&s.value===""||s.value!=a)&&(s.value=""+Cs(a)):s.value!==""+Cs(a)&&(s.value=""+Cs(a)):x!=="submit"&&x!=="reset"||s.removeAttribute("value"),a!=null?cn(s,x,Cs(a)):o!=null?cn(s,x,Cs(o)):c!=null&&s.removeAttribute("value"),m==null&&f!=null&&(s.defaultChecked=!!f),m!=null&&(s.checked=m&&typeof m!="function"&&typeof m!="symbol"),N!=null&&typeof N!="function"&&typeof N!="symbol"&&typeof N!="boolean"?s.name=""+Cs(N):s.removeAttribute("name")}function ws(s,a,o,c,m,f,x,N){if(f!=null&&typeof f!="function"&&typeof f!="symbol"&&typeof f!="boolean"&&(s.type=f),a!=null||o!=null){if(!(f!=="submit"&&f!=="reset"||a!=null)){te(s);return}o=o!=null?""+Cs(o):"",a=a!=null?""+Cs(a):o,N||a===s.value||(s.value=a),s.defaultValue=a}c=c??m,c=typeof c!="function"&&typeof c!="symbol"&&!!c,s.checked=N?s.checked:!!c,s.defaultChecked=!!c,x!=null&&typeof x!="function"&&typeof x!="symbol"&&typeof x!="boolean"&&(s.name=x),te(s)}function cn(s,a,o){a==="number"&&Ge(s.ownerDocument)===s||s.defaultValue===""+o||(s.defaultValue=""+o)}function ms(s,a,o,c){if(s=s.options,a){a={};for(var m=0;m<o.length;m++)a["$"+o[m]]=!0;for(o=0;o<s.length;o++)m=a.hasOwnProperty("$"+s[o].value),s[o].selected!==m&&(s[o].selected=m),m&&c&&(s[o].defaultSelected=!0)}else{for(o=""+Cs(o),a=null,m=0;m<s.length;m++){if(s[m].value===o){s[m].selected=!0,c&&(s[m].defaultSelected=!0);return}a!==null||s[m].disabled||(a=s[m])}a!==null&&(a.selected=!0)}}function Wn(s,a,o){if(a!=null&&(a=""+Cs(a),a!==s.value&&(s.value=a),o==null)){s.defaultValue!==a&&(s.defaultValue=a);return}s.defaultValue=o!=null?""+Cs(o):""}function Gr(s,a,o,c){if(a==null){if(c!=null){if(o!=null)throw Error(i(92));if(gt(c)){if(1<c.length)throw Error(i(93));c=c[0]}o=c}o==null&&(o=""),a=o}o=Cs(a),s.defaultValue=o,c=s.textContent,c===o&&c!==""&&c!==null&&(s.value=c),te(s)}function pn(s,a){if(a){var o=s.firstChild;if(o&&o===s.lastChild&&o.nodeType===3){o.nodeValue=a;return}}s.textContent=a}var ja=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Un(s,a,o){var c=a.indexOf("--")===0;o==null||typeof o=="boolean"||o===""?c?s.setProperty(a,""):a==="float"?s.cssFloat="":s[a]="":c?s.setProperty(a,o):typeof o!="number"||o===0||ja.has(a)?a==="float"?s.cssFloat=o:s[a]=(""+o).trim():s[a]=o+"px"}function is(s,a,o){if(a!=null&&typeof a!="object")throw Error(i(62));if(s=s.style,o!=null){for(var c in o)!o.hasOwnProperty(c)||a!=null&&a.hasOwnProperty(c)||(c.indexOf("--")===0?s.setProperty(c,""):c==="float"?s.cssFloat="":s[c]="");for(var m in a)c=a[m],a.hasOwnProperty(m)&&o[m]!==c&&Un(s,m,c)}else for(var f in a)a.hasOwnProperty(f)&&Un(s,f,a[f])}function un(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var sr=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Gn=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function _r(s){return Gn.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}function tn(){}var Ln=null;function Sn(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var kr=null,jr=null;function Dr(s){var a=fn(s);if(a&&(s=a.stateNode)){var o=s[ht]||null;e:switch(s=a.stateNode,a.type){case"input":if(Mt(s,o.value,o.defaultValue,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name),a=o.name,o.type==="radio"&&a!=null){for(o=s;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll('input[name="'+wt(""+a)+'"][type="radio"]'),a=0;a<o.length;a++){var c=o[a];if(c!==s&&c.form===s.form){var m=c[ht]||null;if(!m)throw Error(i(90));Mt(c,m.value,m.defaultValue,m.defaultValue,m.checked,m.defaultChecked,m.type,m.name)}}for(a=0;a<o.length;a++)c=o[a],c.form===s.form&&qe(c)}break e;case"textarea":Wn(s,o.value,o.defaultValue);break e;case"select":a=o.value,a!=null&&ms(s,!!o.multiple,a,!1)}}}var wi=!1;function Ta(s,a,o){if(wi)return s(a,o);wi=!0;try{var c=s(a);return c}finally{if(wi=!1,(kr!==null||jr!==null)&&(Ad(),kr&&(a=kr,s=jr,jr=kr=null,Dr(a),s)))for(a=0;a<s.length;a++)Dr(s[a])}}function Pr(s,a){var o=s.stateNode;if(o===null)return null;var c=o[ht]||null;if(c===null)return null;o=c[a];e:switch(a){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(c=!c.disabled)||(s=s.type,c=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!c;break e;default:s=!1}if(s)return null;if(o&&typeof o!="function")throw Error(i(231,a,typeof o));return o}var I=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Z=!1;if(I)try{var Ne={};Object.defineProperty(Ne,"passive",{get:function(){Z=!0}}),window.addEventListener("test",Ne,Ne),window.removeEventListener("test",Ne,Ne)}catch{Z=!1}var Ze=null,_t=null,Dt=null;function ot(){if(Dt)return Dt;var s,a=_t,o=a.length,c,m="value"in Ze?Ze.value:Ze.textContent,f=m.length;for(s=0;s<o&&a[s]===m[s];s++);var x=o-s;for(c=1;c<=x&&a[o-c]===m[f-c];c++);return Dt=m.slice(s,1<c?1-c:void 0)}function Vt(s){var a=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&a===13&&(s=13)):s=a,s===10&&(s=13),32<=s||s===13?s:0}function Ht(){return!0}function as(){return!1}function Ft(s){function a(o,c,m,f,x){this._reactName=o,this._targetInst=m,this.type=c,this.nativeEvent=f,this.target=x,this.currentTarget=null;for(var N in s)s.hasOwnProperty(N)&&(o=s[N],this[N]=o?o(f):f[N]);return this.isDefaultPrevented=(f.defaultPrevented!=null?f.defaultPrevented:f.returnValue===!1)?Ht:as,this.isPropagationStopped=as,this}return j(a.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=Ht)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=Ht)},persist:function(){},isPersistent:Ht}),a}var _s={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Fn=Ft(_s),ur=j({},_s,{view:0,detail:0}),Zs=Ft(ur),Ys,zn,dn,On=j({},ur,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:_i,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==dn&&(dn&&s.type==="mousemove"?(Ys=s.screenX-dn.screenX,zn=s.screenY-dn.screenY):zn=Ys=0,dn=s),Ys)},movementY:function(s){return"movementY"in s?s.movementY:zn}}),nr=Ft(On),Kn=j({},On,{dataTransfer:0}),dr=Ft(Kn),rr=j({},ur,{relatedTarget:0}),gn=Ft(rr),hr=j({},_s,{animationName:0,elapsedTime:0,pseudoElement:0}),Tr=Ft(hr),Ha=j({},_s,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),tl=Ft(Ha),sl=j({},_s,{data:0}),mr=Ft(sl),ia={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},oa={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Wu={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Gu(s){var a=this.nativeEvent;return a.getModifierState?a.getModifierState(s):(s=Wu[s])?!!a[s]:!1}function _i(){return Gu}var fr=j({},ur,{key:function(s){if(s.key){var a=ia[s.key]||s.key;if(a!=="Unidentified")return a}return s.type==="keypress"?(s=Vt(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?oa[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:_i,charCode:function(s){return s.type==="keypress"?Vt(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?Vt(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),Ku=Ft(fr),Yu=j({},On,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),$a=Ft(Yu),h=j({},ur,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:_i}),b=Ft(h),_=j({},_s,{propertyName:0,elapsedTime:0,pseudoElement:0}),C=Ft(_),re=j({},On,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),he=Ft(re),Ye=j({},_s,{newState:0,oldState:0}),Zt=Ft(Ye),jn=[9,13,27,32],Vs=I&&"CompositionEvent"in window,rn=null;I&&"documentMode"in document&&(rn=document.documentMode);var Kr=I&&"TextEvent"in window&&!rn,Ea=I&&(!Vs||rn&&8<rn&&11>=rn),la=" ",ca=!1;function bo(s,a){switch(s){case"keyup":return jn.indexOf(a.keyCode)!==-1;case"keydown":return a.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function nl(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var rl=!1;function Uk(s,a){switch(s){case"compositionend":return nl(a);case"keypress":return a.which!==32?null:(ca=!0,la);case"textInput":return s=a.data,s===la&&ca?null:s;default:return null}}function Fk(s,a){if(rl)return s==="compositionend"||!Vs&&bo(s,a)?(s=ot(),Dt=_t=Ze=null,rl=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(a.ctrlKey||a.altKey||a.metaKey)||a.ctrlKey&&a.altKey){if(a.char&&1<a.char.length)return a.char;if(a.which)return String.fromCharCode(a.which)}return null;case"compositionend":return Ea&&a.locale!=="ko"?null:a.data;default:return null}}var zk={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Zy(s){var a=s&&s.nodeName&&s.nodeName.toLowerCase();return a==="input"?!!zk[s.type]:a==="textarea"}function eb(s,a,o,c){kr?jr?jr.push(c):jr=[c]:kr=c,a=Vd(a,"onChange"),0<a.length&&(o=new Fn("onChange","change",null,o,c),s.push({event:o,listeners:a}))}var cc=null,uc=null;function qk(s){L0(s,0)}function Qu(s){var a=Fs(s);if(qe(a))return s}function tb(s,a){if(s==="change")return a}var sb=!1;if(I){var _m;if(I){var km="oninput"in document;if(!km){var nb=document.createElement("div");nb.setAttribute("oninput","return;"),km=typeof nb.oninput=="function"}_m=km}else _m=!1;sb=_m&&(!document.documentMode||9<document.documentMode)}function rb(){cc&&(cc.detachEvent("onpropertychange",ab),uc=cc=null)}function ab(s){if(s.propertyName==="value"&&Qu(uc)){var a=[];eb(a,uc,s,Sn(s)),Ta(qk,a)}}function Hk(s,a,o){s==="focusin"?(rb(),cc=a,uc=o,cc.attachEvent("onpropertychange",ab)):s==="focusout"&&rb()}function $k(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return Qu(uc)}function Wk(s,a){if(s==="click")return Qu(a)}function Gk(s,a){if(s==="input"||s==="change")return Qu(a)}function Kk(s,a){return s===a&&(s!==0||1/s===1/a)||s!==s&&a!==a}var Lr=typeof Object.is=="function"?Object.is:Kk;function dc(s,a){if(Lr(s,a))return!0;if(typeof s!="object"||s===null||typeof a!="object"||a===null)return!1;var o=Object.keys(s),c=Object.keys(a);if(o.length!==c.length)return!1;for(c=0;c<o.length;c++){var m=o[c];if(!it.call(a,m)||!Lr(s[m],a[m]))return!1}return!0}function ib(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function ob(s,a){var o=ib(s);s=0;for(var c;o;){if(o.nodeType===3){if(c=s+o.textContent.length,s<=a&&c>=a)return{node:o,offset:a-s};s=c}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=ib(o)}}function lb(s,a){return s&&a?s===a?!0:s&&s.nodeType===3?!1:a&&a.nodeType===3?lb(s,a.parentNode):"contains"in s?s.contains(a):s.compareDocumentPosition?!!(s.compareDocumentPosition(a)&16):!1:!1}function cb(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var a=Ge(s.document);a instanceof s.HTMLIFrameElement;){try{var o=typeof a.contentWindow.location.href=="string"}catch{o=!1}if(o)s=a.contentWindow;else break;a=Ge(s.document)}return a}function jm(s){var a=s&&s.nodeName&&s.nodeName.toLowerCase();return a&&(a==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||a==="textarea"||s.contentEditable==="true")}var Yk=I&&"documentMode"in document&&11>=document.documentMode,al=null,Tm=null,hc=null,Em=!1;function ub(s,a,o){var c=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;Em||al==null||al!==Ge(c)||(c=al,"selectionStart"in c&&jm(c)?c={start:c.selectionStart,end:c.selectionEnd}:(c=(c.ownerDocument&&c.ownerDocument.defaultView||window).getSelection(),c={anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset}),hc&&dc(hc,c)||(hc=c,c=Vd(Tm,"onSelect"),0<c.length&&(a=new Fn("onSelect","select",null,a,o),s.push({event:a,listeners:c}),a.target=al)))}function vo(s,a){var o={};return o[s.toLowerCase()]=a.toLowerCase(),o["Webkit"+s]="webkit"+a,o["Moz"+s]="moz"+a,o}var il={animationend:vo("Animation","AnimationEnd"),animationiteration:vo("Animation","AnimationIteration"),animationstart:vo("Animation","AnimationStart"),transitionrun:vo("Transition","TransitionRun"),transitionstart:vo("Transition","TransitionStart"),transitioncancel:vo("Transition","TransitionCancel"),transitionend:vo("Transition","TransitionEnd")},Nm={},db={};I&&(db=document.createElement("div").style,"AnimationEvent"in window||(delete il.animationend.animation,delete il.animationiteration.animation,delete il.animationstart.animation),"TransitionEvent"in window||delete il.transitionend.transition);function xo(s){if(Nm[s])return Nm[s];if(!il[s])return s;var a=il[s],o;for(o in a)if(a.hasOwnProperty(o)&&o in db)return Nm[s]=a[o];return s}var hb=xo("animationend"),mb=xo("animationiteration"),fb=xo("animationstart"),Qk=xo("transitionrun"),Xk=xo("transitionstart"),Jk=xo("transitioncancel"),pb=xo("transitionend"),gb=new Map,Sm="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Sm.push("scrollEnd");function ua(s,a){gb.set(s,a),de(a,[s])}var Xu=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var a=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(a))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)},Yr=[],ol=0,Cm=0;function Ju(){for(var s=ol,a=Cm=ol=0;a<s;){var o=Yr[a];Yr[a++]=null;var c=Yr[a];Yr[a++]=null;var m=Yr[a];Yr[a++]=null;var f=Yr[a];if(Yr[a++]=null,c!==null&&m!==null){var x=c.pending;x===null?m.next=m:(m.next=x.next,x.next=m),c.pending=m}f!==0&&yb(o,m,f)}}function Zu(s,a,o,c){Yr[ol++]=s,Yr[ol++]=a,Yr[ol++]=o,Yr[ol++]=c,Cm|=c,s.lanes|=c,s=s.alternate,s!==null&&(s.lanes|=c)}function Rm(s,a,o,c){return Zu(s,a,o,c),ed(s)}function wo(s,a){return Zu(s,null,null,a),ed(s)}function yb(s,a,o){s.lanes|=o;var c=s.alternate;c!==null&&(c.lanes|=o);for(var m=!1,f=s.return;f!==null;)f.childLanes|=o,c=f.alternate,c!==null&&(c.childLanes|=o),f.tag===22&&(s=f.stateNode,s===null||s._visibility&1||(m=!0)),s=f,f=f.return;return s.tag===3?(f=s.stateNode,m&&a!==null&&(m=31-Oe(o),s=f.hiddenUpdates,c=s[m],c===null?s[m]=[a]:c.push(a),a.lane=o|536870912),f):null}function ed(s){if(50<Dc)throw Dc=0,Uf=null,Error(i(185));for(var a=s.return;a!==null;)s=a,a=s.return;return s.tag===3?s.stateNode:null}var ll={};function Zk(s,a,o,c){this.tag=s,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=a,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=c,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Or(s,a,o,c){return new Zk(s,a,o,c)}function Am(s){return s=s.prototype,!(!s||!s.isReactComponent)}function Wa(s,a){var o=s.alternate;return o===null?(o=Or(s.tag,a,s.key,s.mode),o.elementType=s.elementType,o.type=s.type,o.stateNode=s.stateNode,o.alternate=s,s.alternate=o):(o.pendingProps=a,o.type=s.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=s.flags&65011712,o.childLanes=s.childLanes,o.lanes=s.lanes,o.child=s.child,o.memoizedProps=s.memoizedProps,o.memoizedState=s.memoizedState,o.updateQueue=s.updateQueue,a=s.dependencies,o.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext},o.sibling=s.sibling,o.index=s.index,o.ref=s.ref,o.refCleanup=s.refCleanup,o}function bb(s,a){s.flags&=65011714;var o=s.alternate;return o===null?(s.childLanes=0,s.lanes=a,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,a=o.dependencies,s.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),s}function td(s,a,o,c,m,f){var x=0;if(c=s,typeof s=="function")Am(s)&&(x=1);else if(typeof s=="string")x=rT(s,o,De.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case A:return s=Or(31,o,a,m),s.elementType=A,s.lanes=f,s;case F:return _o(o.children,m,f,a);case U:x=8,m|=24;break;case ne:return s=Or(12,o,a,m|2),s.elementType=ne,s.lanes=f,s;case Le:return s=Or(13,o,a,m),s.elementType=Le,s.lanes=f,s;case Ce:return s=Or(19,o,a,m),s.elementType=Ce,s.lanes=f,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case oe:x=10;break e;case Y:x=9;break e;case be:x=11;break e;case R:x=14;break e;case E:x=16,c=null;break e}x=29,o=Error(i(130,s===null?"null":typeof s,"")),c=null}return a=Or(x,o,a,m),a.elementType=s,a.type=c,a.lanes=f,a}function _o(s,a,o,c){return s=Or(7,s,c,a),s.lanes=o,s}function Im(s,a,o){return s=Or(6,s,null,a),s.lanes=o,s}function vb(s){var a=Or(18,null,null,0);return a.stateNode=s,a}function Mm(s,a,o){return a=Or(4,s.children!==null?s.children:[],s.key,a),a.lanes=o,a.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},a}var xb=new WeakMap;function Qr(s,a){if(typeof s=="object"&&s!==null){var o=xb.get(s);return o!==void 0?o:(a={value:s,source:a,stack:pt(a)},xb.set(s,a),a)}return{value:s,source:a,stack:pt(a)}}var cl=[],ul=0,sd=null,mc=0,Xr=[],Jr=0,ki=null,Na=1,Sa="";function Ga(s,a){cl[ul++]=mc,cl[ul++]=sd,sd=s,mc=a}function wb(s,a,o){Xr[Jr++]=Na,Xr[Jr++]=Sa,Xr[Jr++]=ki,ki=s;var c=Na;s=Sa;var m=32-Oe(c)-1;c&=~(1<<m),o+=1;var f=32-Oe(a)+m;if(30<f){var x=m-m%5;f=(c&(1<<x)-1).toString(32),c>>=x,m-=x,Na=1<<32-Oe(a)+m|o<<m|c,Sa=f+s}else Na=1<<f|o<<m|c,Sa=s}function Dm(s){s.return!==null&&(Ga(s,1),wb(s,1,0))}function Pm(s){for(;s===sd;)sd=cl[--ul],cl[ul]=null,mc=cl[--ul],cl[ul]=null;for(;s===ki;)ki=Xr[--Jr],Xr[Jr]=null,Sa=Xr[--Jr],Xr[Jr]=null,Na=Xr[--Jr],Xr[Jr]=null}function _b(s,a){Xr[Jr++]=Na,Xr[Jr++]=Sa,Xr[Jr++]=ki,Na=a.id,Sa=a.overflow,ki=s}var Yn=null,sn=null,ks=!1,ji=null,Zr=!1,Lm=Error(i(519));function Ti(s){var a=Error(i(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw fc(Qr(a,s)),Lm}function kb(s){var a=s.stateNode,o=s.type,c=s.memoizedProps;switch(a[ct]=s,a[ht]=c,o){case"dialog":ds("cancel",a),ds("close",a);break;case"iframe":case"object":case"embed":ds("load",a);break;case"video":case"audio":for(o=0;o<Lc.length;o++)ds(Lc[o],a);break;case"source":ds("error",a);break;case"img":case"image":case"link":ds("error",a),ds("load",a);break;case"details":ds("toggle",a);break;case"input":ds("invalid",a),ws(a,c.value,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name,!0);break;case"select":ds("invalid",a);break;case"textarea":ds("invalid",a),Gr(a,c.value,c.defaultValue,c.children)}o=c.children,typeof o!="string"&&typeof o!="number"&&typeof o!="bigint"||a.textContent===""+o||c.suppressHydrationWarning===!0||U0(a.textContent,o)?(c.popover!=null&&(ds("beforetoggle",a),ds("toggle",a)),c.onScroll!=null&&ds("scroll",a),c.onScrollEnd!=null&&ds("scrollend",a),c.onClick!=null&&(a.onclick=tn),a=!0):a=!1,a||Ti(s,!0)}function jb(s){for(Yn=s.return;Yn;)switch(Yn.tag){case 5:case 31:case 13:Zr=!1;return;case 27:case 3:Zr=!0;return;default:Yn=Yn.return}}function dl(s){if(s!==Yn)return!1;if(!ks)return jb(s),ks=!0,!1;var a=s.tag,o;if((o=a!==3&&a!==27)&&((o=a===5)&&(o=s.type,o=!(o!=="form"&&o!=="button")||tp(s.type,s.memoizedProps)),o=!o),o&&sn&&Ti(s),jb(s),a===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(317));sn=Y0(s)}else if(a===31){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(317));sn=Y0(s)}else a===27?(a=sn,Bi(s.type)?(s=ip,ip=null,sn=s):sn=a):sn=Yn?ta(s.stateNode.nextSibling):null;return!0}function ko(){sn=Yn=null,ks=!1}function Om(){var s=ji;return s!==null&&(Cr===null?Cr=s:Cr.push.apply(Cr,s),ji=null),s}function fc(s){ji===null?ji=[s]:ji.push(s)}var Vm=L(null),jo=null,Ka=null;function Ei(s,a,o){Me(Vm,a._currentValue),a._currentValue=o}function Ya(s){s._currentValue=Vm.current,se(Vm)}function Bm(s,a,o){for(;s!==null;){var c=s.alternate;if((s.childLanes&a)!==a?(s.childLanes|=a,c!==null&&(c.childLanes|=a)):c!==null&&(c.childLanes&a)!==a&&(c.childLanes|=a),s===o)break;s=s.return}}function Um(s,a,o,c){var m=s.child;for(m!==null&&(m.return=s);m!==null;){var f=m.dependencies;if(f!==null){var x=m.child;f=f.firstContext;e:for(;f!==null;){var N=f;f=m;for(var z=0;z<a.length;z++)if(N.context===a[z]){f.lanes|=o,N=f.alternate,N!==null&&(N.lanes|=o),Bm(f.return,o,s),c||(x=null);break e}f=N.next}}else if(m.tag===18){if(x=m.return,x===null)throw Error(i(341));x.lanes|=o,f=x.alternate,f!==null&&(f.lanes|=o),Bm(x,o,s),x=null}else x=m.child;if(x!==null)x.return=m;else for(x=m;x!==null;){if(x===s){x=null;break}if(m=x.sibling,m!==null){m.return=x.return,x=m;break}x=x.return}m=x}}function hl(s,a,o,c){s=null;for(var m=a,f=!1;m!==null;){if(!f){if((m.flags&524288)!==0)f=!0;else if((m.flags&262144)!==0)break}if(m.tag===10){var x=m.alternate;if(x===null)throw Error(i(387));if(x=x.memoizedProps,x!==null){var N=m.type;Lr(m.pendingProps.value,x.value)||(s!==null?s.push(N):s=[N])}}else if(m===bt.current){if(x=m.alternate,x===null)throw Error(i(387));x.memoizedState.memoizedState!==m.memoizedState.memoizedState&&(s!==null?s.push(Fc):s=[Fc])}m=m.return}s!==null&&Um(a,s,o,c),a.flags|=262144}function nd(s){for(s=s.firstContext;s!==null;){if(!Lr(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function To(s){jo=s,Ka=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function Qn(s){return Tb(jo,s)}function rd(s,a){return jo===null&&To(s),Tb(s,a)}function Tb(s,a){var o=a._currentValue;if(a={context:a,memoizedValue:o,next:null},Ka===null){if(s===null)throw Error(i(308));Ka=a,s.dependencies={lanes:0,firstContext:a},s.flags|=524288}else Ka=Ka.next=a;return o}var ej=typeof AbortController<"u"?AbortController:function(){var s=[],a=this.signal={aborted:!1,addEventListener:function(o,c){s.push(c)}};this.abort=function(){a.aborted=!0,s.forEach(function(o){return o()})}},tj=n.unstable_scheduleCallback,sj=n.unstable_NormalPriority,Cn={$$typeof:oe,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Fm(){return{controller:new ej,data:new Map,refCount:0}}function pc(s){s.refCount--,s.refCount===0&&tj(sj,function(){s.controller.abort()})}var gc=null,zm=0,ml=0,fl=null;function nj(s,a){if(gc===null){var o=gc=[];zm=0,ml=Wf(),fl={status:"pending",value:void 0,then:function(c){o.push(c)}}}return zm++,a.then(Eb,Eb),a}function Eb(){if(--zm===0&&gc!==null){fl!==null&&(fl.status="fulfilled");var s=gc;gc=null,ml=0,fl=null;for(var a=0;a<s.length;a++)(0,s[a])()}}function rj(s,a){var o=[],c={status:"pending",value:null,reason:null,then:function(m){o.push(m)}};return s.then(function(){c.status="fulfilled",c.value=a;for(var m=0;m<o.length;m++)(0,o[m])(a)},function(m){for(c.status="rejected",c.reason=m,m=0;m<o.length;m++)(0,o[m])(void 0)}),c}var Nb=$.S;$.S=function(s,a){u0=ss(),typeof a=="object"&&a!==null&&typeof a.then=="function"&&nj(s,a),Nb!==null&&Nb(s,a)};var Eo=L(null);function qm(){var s=Eo.current;return s!==null?s:Qs.pooledCache}function ad(s,a){a===null?Me(Eo,Eo.current):Me(Eo,a.pool)}function Sb(){var s=qm();return s===null?null:{parent:Cn._currentValue,pool:s}}var pl=Error(i(460)),Hm=Error(i(474)),id=Error(i(542)),od={then:function(){}};function Cb(s){return s=s.status,s==="fulfilled"||s==="rejected"}function Rb(s,a,o){switch(o=s[o],o===void 0?s.push(a):o!==a&&(a.then(tn,tn),a=o),a.status){case"fulfilled":return a.value;case"rejected":throw s=a.reason,Ib(s),s;default:if(typeof a.status=="string")a.then(tn,tn);else{if(s=Qs,s!==null&&100<s.shellSuspendCounter)throw Error(i(482));s=a,s.status="pending",s.then(function(c){if(a.status==="pending"){var m=a;m.status="fulfilled",m.value=c}},function(c){if(a.status==="pending"){var m=a;m.status="rejected",m.reason=c}})}switch(a.status){case"fulfilled":return a.value;case"rejected":throw s=a.reason,Ib(s),s}throw So=a,pl}}function No(s){try{var a=s._init;return a(s._payload)}catch(o){throw o!==null&&typeof o=="object"&&typeof o.then=="function"?(So=o,pl):o}}var So=null;function Ab(){if(So===null)throw Error(i(459));var s=So;return So=null,s}function Ib(s){if(s===pl||s===id)throw Error(i(483))}var gl=null,yc=0;function ld(s){var a=yc;return yc+=1,gl===null&&(gl=[]),Rb(gl,s,a)}function bc(s,a){a=a.props.ref,s.ref=a!==void 0?a:null}function cd(s,a){throw a.$$typeof===T?Error(i(525)):(s=Object.prototype.toString.call(a),Error(i(31,s==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":s)))}function Mb(s){function a(X,G){if(s){var ae=X.deletions;ae===null?(X.deletions=[G],X.flags|=16):ae.push(G)}}function o(X,G){if(!s)return null;for(;G!==null;)a(X,G),G=G.sibling;return null}function c(X){for(var G=new Map;X!==null;)X.key!==null?G.set(X.key,X):G.set(X.index,X),X=X.sibling;return G}function m(X,G){return X=Wa(X,G),X.index=0,X.sibling=null,X}function f(X,G,ae){return X.index=ae,s?(ae=X.alternate,ae!==null?(ae=ae.index,ae<G?(X.flags|=67108866,G):ae):(X.flags|=67108866,G)):(X.flags|=1048576,G)}function x(X){return s&&X.alternate===null&&(X.flags|=67108866),X}function N(X,G,ae,Re){return G===null||G.tag!==6?(G=Im(ae,X.mode,Re),G.return=X,G):(G=m(G,ae),G.return=X,G)}function z(X,G,ae,Re){var Et=ae.type;return Et===F?ke(X,G,ae.props.children,Re,ae.key):G!==null&&(G.elementType===Et||typeof Et=="object"&&Et!==null&&Et.$$typeof===E&&No(Et)===G.type)?(G=m(G,ae.props),bc(G,ae),G.return=X,G):(G=td(ae.type,ae.key,ae.props,null,X.mode,Re),bc(G,ae),G.return=X,G)}function ie(X,G,ae,Re){return G===null||G.tag!==4||G.stateNode.containerInfo!==ae.containerInfo||G.stateNode.implementation!==ae.implementation?(G=Mm(ae,X.mode,Re),G.return=X,G):(G=m(G,ae.children||[]),G.return=X,G)}function ke(X,G,ae,Re,Et){return G===null||G.tag!==7?(G=_o(ae,X.mode,Re,Et),G.return=X,G):(G=m(G,ae),G.return=X,G)}function Ie(X,G,ae){if(typeof G=="string"&&G!==""||typeof G=="number"||typeof G=="bigint")return G=Im(""+G,X.mode,ae),G.return=X,G;if(typeof G=="object"&&G!==null){switch(G.$$typeof){case V:return ae=td(G.type,G.key,G.props,null,X.mode,ae),bc(ae,G),ae.return=X,ae;case W:return G=Mm(G,X.mode,ae),G.return=X,G;case E:return G=No(G),Ie(X,G,ae)}if(gt(G)||H(G))return G=_o(G,X.mode,ae,null),G.return=X,G;if(typeof G.then=="function")return Ie(X,ld(G),ae);if(G.$$typeof===oe)return Ie(X,rd(X,G),ae);cd(X,G)}return null}function le(X,G,ae,Re){var Et=G!==null?G.key:null;if(typeof ae=="string"&&ae!==""||typeof ae=="number"||typeof ae=="bigint")return Et!==null?null:N(X,G,""+ae,Re);if(typeof ae=="object"&&ae!==null){switch(ae.$$typeof){case V:return ae.key===Et?z(X,G,ae,Re):null;case W:return ae.key===Et?ie(X,G,ae,Re):null;case E:return ae=No(ae),le(X,G,ae,Re)}if(gt(ae)||H(ae))return Et!==null?null:ke(X,G,ae,Re,null);if(typeof ae.then=="function")return le(X,G,ld(ae),Re);if(ae.$$typeof===oe)return le(X,G,rd(X,ae),Re);cd(X,ae)}return null}function ye(X,G,ae,Re,Et){if(typeof Re=="string"&&Re!==""||typeof Re=="number"||typeof Re=="bigint")return X=X.get(ae)||null,N(G,X,""+Re,Et);if(typeof Re=="object"&&Re!==null){switch(Re.$$typeof){case V:return X=X.get(Re.key===null?ae:Re.key)||null,z(G,X,Re,Et);case W:return X=X.get(Re.key===null?ae:Re.key)||null,ie(G,X,Re,Et);case E:return Re=No(Re),ye(X,G,ae,Re,Et)}if(gt(Re)||H(Re))return X=X.get(ae)||null,ke(G,X,Re,Et,null);if(typeof Re.then=="function")return ye(X,G,ae,ld(Re),Et);if(Re.$$typeof===oe)return ye(X,G,ae,rd(G,Re),Et);cd(G,Re)}return null}function mt(X,G,ae,Re){for(var Et=null,Is=null,yt=G,rs=G=0,ps=null;yt!==null&&rs<ae.length;rs++){yt.index>rs?(ps=yt,yt=null):ps=yt.sibling;var Ms=le(X,yt,ae[rs],Re);if(Ms===null){yt===null&&(yt=ps);break}s&&yt&&Ms.alternate===null&&a(X,yt),G=f(Ms,G,rs),Is===null?Et=Ms:Is.sibling=Ms,Is=Ms,yt=ps}if(rs===ae.length)return o(X,yt),ks&&Ga(X,rs),Et;if(yt===null){for(;rs<ae.length;rs++)yt=Ie(X,ae[rs],Re),yt!==null&&(G=f(yt,G,rs),Is===null?Et=yt:Is.sibling=yt,Is=yt);return ks&&Ga(X,rs),Et}for(yt=c(yt);rs<ae.length;rs++)ps=ye(yt,X,rs,ae[rs],Re),ps!==null&&(s&&ps.alternate!==null&&yt.delete(ps.key===null?rs:ps.key),G=f(ps,G,rs),Is===null?Et=ps:Is.sibling=ps,Is=ps);return s&&yt.forEach(function(Hi){return a(X,Hi)}),ks&&Ga(X,rs),Et}function It(X,G,ae,Re){if(ae==null)throw Error(i(151));for(var Et=null,Is=null,yt=G,rs=G=0,ps=null,Ms=ae.next();yt!==null&&!Ms.done;rs++,Ms=ae.next()){yt.index>rs?(ps=yt,yt=null):ps=yt.sibling;var Hi=le(X,yt,Ms.value,Re);if(Hi===null){yt===null&&(yt=ps);break}s&&yt&&Hi.alternate===null&&a(X,yt),G=f(Hi,G,rs),Is===null?Et=Hi:Is.sibling=Hi,Is=Hi,yt=ps}if(Ms.done)return o(X,yt),ks&&Ga(X,rs),Et;if(yt===null){for(;!Ms.done;rs++,Ms=ae.next())Ms=Ie(X,Ms.value,Re),Ms!==null&&(G=f(Ms,G,rs),Is===null?Et=Ms:Is.sibling=Ms,Is=Ms);return ks&&Ga(X,rs),Et}for(yt=c(yt);!Ms.done;rs++,Ms=ae.next())Ms=ye(yt,X,rs,Ms.value,Re),Ms!==null&&(s&&Ms.alternate!==null&&yt.delete(Ms.key===null?rs:Ms.key),G=f(Ms,G,rs),Is===null?Et=Ms:Is.sibling=Ms,Is=Ms);return s&&yt.forEach(function(pT){return a(X,pT)}),ks&&Ga(X,rs),Et}function Ws(X,G,ae,Re){if(typeof ae=="object"&&ae!==null&&ae.type===F&&ae.key===null&&(ae=ae.props.children),typeof ae=="object"&&ae!==null){switch(ae.$$typeof){case V:e:{for(var Et=ae.key;G!==null;){if(G.key===Et){if(Et=ae.type,Et===F){if(G.tag===7){o(X,G.sibling),Re=m(G,ae.props.children),Re.return=X,X=Re;break e}}else if(G.elementType===Et||typeof Et=="object"&&Et!==null&&Et.$$typeof===E&&No(Et)===G.type){o(X,G.sibling),Re=m(G,ae.props),bc(Re,ae),Re.return=X,X=Re;break e}o(X,G);break}else a(X,G);G=G.sibling}ae.type===F?(Re=_o(ae.props.children,X.mode,Re,ae.key),Re.return=X,X=Re):(Re=td(ae.type,ae.key,ae.props,null,X.mode,Re),bc(Re,ae),Re.return=X,X=Re)}return x(X);case W:e:{for(Et=ae.key;G!==null;){if(G.key===Et)if(G.tag===4&&G.stateNode.containerInfo===ae.containerInfo&&G.stateNode.implementation===ae.implementation){o(X,G.sibling),Re=m(G,ae.children||[]),Re.return=X,X=Re;break e}else{o(X,G);break}else a(X,G);G=G.sibling}Re=Mm(ae,X.mode,Re),Re.return=X,X=Re}return x(X);case E:return ae=No(ae),Ws(X,G,ae,Re)}if(gt(ae))return mt(X,G,ae,Re);if(H(ae)){if(Et=H(ae),typeof Et!="function")throw Error(i(150));return ae=Et.call(ae),It(X,G,ae,Re)}if(typeof ae.then=="function")return Ws(X,G,ld(ae),Re);if(ae.$$typeof===oe)return Ws(X,G,rd(X,ae),Re);cd(X,ae)}return typeof ae=="string"&&ae!==""||typeof ae=="number"||typeof ae=="bigint"?(ae=""+ae,G!==null&&G.tag===6?(o(X,G.sibling),Re=m(G,ae),Re.return=X,X=Re):(o(X,G),Re=Im(ae,X.mode,Re),Re.return=X,X=Re),x(X)):o(X,G)}return function(X,G,ae,Re){try{yc=0;var Et=Ws(X,G,ae,Re);return gl=null,Et}catch(yt){if(yt===pl||yt===id)throw yt;var Is=Or(29,yt,null,X.mode);return Is.lanes=Re,Is.return=X,Is}}}var Co=Mb(!0),Db=Mb(!1),Ni=!1;function $m(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Wm(s,a){s=s.updateQueue,a.updateQueue===s&&(a.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function Si(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function Ci(s,a,o){var c=s.updateQueue;if(c===null)return null;if(c=c.shared,(Bs&2)!==0){var m=c.pending;return m===null?a.next=a:(a.next=m.next,m.next=a),c.pending=a,a=ed(s),yb(s,null,o),a}return Zu(s,c,a,o),ed(s)}function vc(s,a,o){if(a=a.updateQueue,a!==null&&(a=a.shared,(o&4194048)!==0)){var c=a.lanes;c&=s.pendingLanes,o|=c,a.lanes=o,Ss(s,o)}}function Gm(s,a){var o=s.updateQueue,c=s.alternate;if(c!==null&&(c=c.updateQueue,o===c)){var m=null,f=null;if(o=o.firstBaseUpdate,o!==null){do{var x={lane:o.lane,tag:o.tag,payload:o.payload,callback:null,next:null};f===null?m=f=x:f=f.next=x,o=o.next}while(o!==null);f===null?m=f=a:f=f.next=a}else m=f=a;o={baseState:c.baseState,firstBaseUpdate:m,lastBaseUpdate:f,shared:c.shared,callbacks:c.callbacks},s.updateQueue=o;return}s=o.lastBaseUpdate,s===null?o.firstBaseUpdate=a:s.next=a,o.lastBaseUpdate=a}var Km=!1;function xc(){if(Km){var s=fl;if(s!==null)throw s}}function wc(s,a,o,c){Km=!1;var m=s.updateQueue;Ni=!1;var f=m.firstBaseUpdate,x=m.lastBaseUpdate,N=m.shared.pending;if(N!==null){m.shared.pending=null;var z=N,ie=z.next;z.next=null,x===null?f=ie:x.next=ie,x=z;var ke=s.alternate;ke!==null&&(ke=ke.updateQueue,N=ke.lastBaseUpdate,N!==x&&(N===null?ke.firstBaseUpdate=ie:N.next=ie,ke.lastBaseUpdate=z))}if(f!==null){var Ie=m.baseState;x=0,ke=ie=z=null,N=f;do{var le=N.lane&-536870913,ye=le!==N.lane;if(ye?(fs&le)===le:(c&le)===le){le!==0&&le===ml&&(Km=!0),ke!==null&&(ke=ke.next={lane:0,tag:N.tag,payload:N.payload,callback:null,next:null});e:{var mt=s,It=N;le=a;var Ws=o;switch(It.tag){case 1:if(mt=It.payload,typeof mt=="function"){Ie=mt.call(Ws,Ie,le);break e}Ie=mt;break e;case 3:mt.flags=mt.flags&-65537|128;case 0:if(mt=It.payload,le=typeof mt=="function"?mt.call(Ws,Ie,le):mt,le==null)break e;Ie=j({},Ie,le);break e;case 2:Ni=!0}}le=N.callback,le!==null&&(s.flags|=64,ye&&(s.flags|=8192),ye=m.callbacks,ye===null?m.callbacks=[le]:ye.push(le))}else ye={lane:le,tag:N.tag,payload:N.payload,callback:N.callback,next:null},ke===null?(ie=ke=ye,z=Ie):ke=ke.next=ye,x|=le;if(N=N.next,N===null){if(N=m.shared.pending,N===null)break;ye=N,N=ye.next,ye.next=null,m.lastBaseUpdate=ye,m.shared.pending=null}}while(!0);ke===null&&(z=Ie),m.baseState=z,m.firstBaseUpdate=ie,m.lastBaseUpdate=ke,f===null&&(m.shared.lanes=0),Di|=x,s.lanes=x,s.memoizedState=Ie}}function Pb(s,a){if(typeof s!="function")throw Error(i(191,s));s.call(a)}function Lb(s,a){var o=s.callbacks;if(o!==null)for(s.callbacks=null,s=0;s<o.length;s++)Pb(o[s],a)}var yl=L(null),ud=L(0);function Ob(s,a){s=ri,Me(ud,s),Me(yl,a),ri=s|a.baseLanes}function Ym(){Me(ud,ri),Me(yl,yl.current)}function Qm(){ri=ud.current,se(yl),se(ud)}var Vr=L(null),ea=null;function Ri(s){var a=s.alternate;Me(Tn,Tn.current&1),Me(Vr,s),ea===null&&(a===null||yl.current!==null||a.memoizedState!==null)&&(ea=s)}function Xm(s){Me(Tn,Tn.current),Me(Vr,s),ea===null&&(ea=s)}function Vb(s){s.tag===22?(Me(Tn,Tn.current),Me(Vr,s),ea===null&&(ea=s)):Ai()}function Ai(){Me(Tn,Tn.current),Me(Vr,Vr.current)}function Br(s){se(Vr),ea===s&&(ea=null),se(Tn)}var Tn=L(0);function dd(s){for(var a=s;a!==null;){if(a.tag===13){var o=a.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||rp(o)||ap(o)))return a}else if(a.tag===19&&(a.memoizedProps.revealOrder==="forwards"||a.memoizedProps.revealOrder==="backwards"||a.memoizedProps.revealOrder==="unstable_legacy-backwards"||a.memoizedProps.revealOrder==="together")){if((a.flags&128)!==0)return a}else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===s)break;for(;a.sibling===null;){if(a.return===null||a.return===s)return null;a=a.return}a.sibling.return=a.return,a=a.sibling}return null}var Qa=0,es=null,Hs=null,Rn=null,hd=!1,bl=!1,Ro=!1,md=0,_c=0,vl=null,aj=0;function yn(){throw Error(i(321))}function Jm(s,a){if(a===null)return!1;for(var o=0;o<a.length&&o<s.length;o++)if(!Lr(s[o],a[o]))return!1;return!0}function Zm(s,a,o,c,m,f){return Qa=f,es=a,a.memoizedState=null,a.updateQueue=null,a.lanes=0,$.H=s===null||s.memoizedState===null?wv:pf,Ro=!1,f=o(c,m),Ro=!1,bl&&(f=Ub(a,o,c,m)),Bb(s),f}function Bb(s){$.H=Tc;var a=Hs!==null&&Hs.next!==null;if(Qa=0,Rn=Hs=es=null,hd=!1,_c=0,vl=null,a)throw Error(i(300));s===null||An||(s=s.dependencies,s!==null&&nd(s)&&(An=!0))}function Ub(s,a,o,c){es=s;var m=0;do{if(bl&&(vl=null),_c=0,bl=!1,25<=m)throw Error(i(301));if(m+=1,Rn=Hs=null,s.updateQueue!=null){var f=s.updateQueue;f.lastEffect=null,f.events=null,f.stores=null,f.memoCache!=null&&(f.memoCache.index=0)}$.H=_v,f=a(o,c)}while(bl);return f}function ij(){var s=$.H,a=s.useState()[0];return a=typeof a.then=="function"?kc(a):a,s=s.useState()[0],(Hs!==null?Hs.memoizedState:null)!==s&&(es.flags|=1024),a}function ef(){var s=md!==0;return md=0,s}function tf(s,a,o){a.updateQueue=s.updateQueue,a.flags&=-2053,s.lanes&=~o}function sf(s){if(hd){for(s=s.memoizedState;s!==null;){var a=s.queue;a!==null&&(a.pending=null),s=s.next}hd=!1}Qa=0,Rn=Hs=es=null,bl=!1,_c=md=0,vl=null}function pr(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Rn===null?es.memoizedState=Rn=s:Rn=Rn.next=s,Rn}function En(){if(Hs===null){var s=es.alternate;s=s!==null?s.memoizedState:null}else s=Hs.next;var a=Rn===null?es.memoizedState:Rn.next;if(a!==null)Rn=a,Hs=s;else{if(s===null)throw es.alternate===null?Error(i(467)):Error(i(310));Hs=s,s={memoizedState:Hs.memoizedState,baseState:Hs.baseState,baseQueue:Hs.baseQueue,queue:Hs.queue,next:null},Rn===null?es.memoizedState=Rn=s:Rn=Rn.next=s}return Rn}function fd(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function kc(s){var a=_c;return _c+=1,vl===null&&(vl=[]),s=Rb(vl,s,a),a=es,(Rn===null?a.memoizedState:Rn.next)===null&&(a=a.alternate,$.H=a===null||a.memoizedState===null?wv:pf),s}function pd(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return kc(s);if(s.$$typeof===oe)return Qn(s)}throw Error(i(438,String(s)))}function nf(s){var a=null,o=es.updateQueue;if(o!==null&&(a=o.memoCache),a==null){var c=es.alternate;c!==null&&(c=c.updateQueue,c!==null&&(c=c.memoCache,c!=null&&(a={data:c.data.map(function(m){return m.slice()}),index:0})))}if(a==null&&(a={data:[],index:0}),o===null&&(o=fd(),es.updateQueue=o),o.memoCache=a,o=a.data[a.index],o===void 0)for(o=a.data[a.index]=Array(s),c=0;c<s;c++)o[c]=O;return a.index++,o}function Xa(s,a){return typeof a=="function"?a(s):a}function gd(s){var a=En();return rf(a,Hs,s)}function rf(s,a,o){var c=s.queue;if(c===null)throw Error(i(311));c.lastRenderedReducer=o;var m=s.baseQueue,f=c.pending;if(f!==null){if(m!==null){var x=m.next;m.next=f.next,f.next=x}a.baseQueue=m=f,c.pending=null}if(f=s.baseState,m===null)s.memoizedState=f;else{a=m.next;var N=x=null,z=null,ie=a,ke=!1;do{var Ie=ie.lane&-536870913;if(Ie!==ie.lane?(fs&Ie)===Ie:(Qa&Ie)===Ie){var le=ie.revertLane;if(le===0)z!==null&&(z=z.next={lane:0,revertLane:0,gesture:null,action:ie.action,hasEagerState:ie.hasEagerState,eagerState:ie.eagerState,next:null}),Ie===ml&&(ke=!0);else if((Qa&le)===le){ie=ie.next,le===ml&&(ke=!0);continue}else Ie={lane:0,revertLane:ie.revertLane,gesture:null,action:ie.action,hasEagerState:ie.hasEagerState,eagerState:ie.eagerState,next:null},z===null?(N=z=Ie,x=f):z=z.next=Ie,es.lanes|=le,Di|=le;Ie=ie.action,Ro&&o(f,Ie),f=ie.hasEagerState?ie.eagerState:o(f,Ie)}else le={lane:Ie,revertLane:ie.revertLane,gesture:ie.gesture,action:ie.action,hasEagerState:ie.hasEagerState,eagerState:ie.eagerState,next:null},z===null?(N=z=le,x=f):z=z.next=le,es.lanes|=Ie,Di|=Ie;ie=ie.next}while(ie!==null&&ie!==a);if(z===null?x=f:z.next=N,!Lr(f,s.memoizedState)&&(An=!0,ke&&(o=fl,o!==null)))throw o;s.memoizedState=f,s.baseState=x,s.baseQueue=z,c.lastRenderedState=f}return m===null&&(c.lanes=0),[s.memoizedState,c.dispatch]}function af(s){var a=En(),o=a.queue;if(o===null)throw Error(i(311));o.lastRenderedReducer=s;var c=o.dispatch,m=o.pending,f=a.memoizedState;if(m!==null){o.pending=null;var x=m=m.next;do f=s(f,x.action),x=x.next;while(x!==m);Lr(f,a.memoizedState)||(An=!0),a.memoizedState=f,a.baseQueue===null&&(a.baseState=f),o.lastRenderedState=f}return[f,c]}function Fb(s,a,o){var c=es,m=En(),f=ks;if(f){if(o===void 0)throw Error(i(407));o=o()}else o=a();var x=!Lr((Hs||m).memoizedState,o);if(x&&(m.memoizedState=o,An=!0),m=m.queue,cf(Hb.bind(null,c,m,s),[s]),m.getSnapshot!==a||x||Rn!==null&&Rn.memoizedState.tag&1){if(c.flags|=2048,xl(9,{destroy:void 0},qb.bind(null,c,m,o,a),null),Qs===null)throw Error(i(349));f||(Qa&127)!==0||zb(c,a,o)}return o}function zb(s,a,o){s.flags|=16384,s={getSnapshot:a,value:o},a=es.updateQueue,a===null?(a=fd(),es.updateQueue=a,a.stores=[s]):(o=a.stores,o===null?a.stores=[s]:o.push(s))}function qb(s,a,o,c){a.value=o,a.getSnapshot=c,$b(a)&&Wb(s)}function Hb(s,a,o){return o(function(){$b(a)&&Wb(s)})}function $b(s){var a=s.getSnapshot;s=s.value;try{var o=a();return!Lr(s,o)}catch{return!0}}function Wb(s){var a=wo(s,2);a!==null&&Rr(a,s,2)}function of(s){var a=pr();if(typeof s=="function"){var o=s;if(s=o(),Ro){we(!0);try{o()}finally{we(!1)}}}return a.memoizedState=a.baseState=s,a.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Xa,lastRenderedState:s},a}function Gb(s,a,o,c){return s.baseState=o,rf(s,Hs,typeof c=="function"?c:Xa)}function oj(s,a,o,c,m){if(vd(s))throw Error(i(485));if(s=a.action,s!==null){var f={payload:m,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(x){f.listeners.push(x)}};$.T!==null?o(!0):f.isTransition=!1,c(f),o=a.pending,o===null?(f.next=a.pending=f,Kb(a,f)):(f.next=o.next,a.pending=o.next=f)}}function Kb(s,a){var o=a.action,c=a.payload,m=s.state;if(a.isTransition){var f=$.T,x={};$.T=x;try{var N=o(m,c),z=$.S;z!==null&&z(x,N),Yb(s,a,N)}catch(ie){lf(s,a,ie)}finally{f!==null&&x.types!==null&&(f.types=x.types),$.T=f}}else try{f=o(m,c),Yb(s,a,f)}catch(ie){lf(s,a,ie)}}function Yb(s,a,o){o!==null&&typeof o=="object"&&typeof o.then=="function"?o.then(function(c){Qb(s,a,c)},function(c){return lf(s,a,c)}):Qb(s,a,o)}function Qb(s,a,o){a.status="fulfilled",a.value=o,Xb(a),s.state=o,a=s.pending,a!==null&&(o=a.next,o===a?s.pending=null:(o=o.next,a.next=o,Kb(s,o)))}function lf(s,a,o){var c=s.pending;if(s.pending=null,c!==null){c=c.next;do a.status="rejected",a.reason=o,Xb(a),a=a.next;while(a!==c)}s.action=null}function Xb(s){s=s.listeners;for(var a=0;a<s.length;a++)(0,s[a])()}function Jb(s,a){return a}function Zb(s,a){if(ks){var o=Qs.formState;if(o!==null){e:{var c=es;if(ks){if(sn){t:{for(var m=sn,f=Zr;m.nodeType!==8;){if(!f){m=null;break t}if(m=ta(m.nextSibling),m===null){m=null;break t}}f=m.data,m=f==="F!"||f==="F"?m:null}if(m){sn=ta(m.nextSibling),c=m.data==="F!";break e}}Ti(c)}c=!1}c&&(a=o[0])}}return o=pr(),o.memoizedState=o.baseState=a,c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Jb,lastRenderedState:a},o.queue=c,o=bv.bind(null,es,c),c.dispatch=o,c=of(!1),f=ff.bind(null,es,!1,c.queue),c=pr(),m={state:a,dispatch:null,action:s,pending:null},c.queue=m,o=oj.bind(null,es,m,f,o),m.dispatch=o,c.memoizedState=s,[a,o,!1]}function ev(s){var a=En();return tv(a,Hs,s)}function tv(s,a,o){if(a=rf(s,a,Jb)[0],s=gd(Xa)[0],typeof a=="object"&&a!==null&&typeof a.then=="function")try{var c=kc(a)}catch(x){throw x===pl?id:x}else c=a;a=En();var m=a.queue,f=m.dispatch;return o!==a.memoizedState&&(es.flags|=2048,xl(9,{destroy:void 0},lj.bind(null,m,o),null)),[c,f,s]}function lj(s,a){s.action=a}function sv(s){var a=En(),o=Hs;if(o!==null)return tv(a,o,s);En(),a=a.memoizedState,o=En();var c=o.queue.dispatch;return o.memoizedState=s,[a,c,!1]}function xl(s,a,o,c){return s={tag:s,create:o,deps:c,inst:a,next:null},a=es.updateQueue,a===null&&(a=fd(),es.updateQueue=a),o=a.lastEffect,o===null?a.lastEffect=s.next=s:(c=o.next,o.next=s,s.next=c,a.lastEffect=s),s}function nv(){return En().memoizedState}function yd(s,a,o,c){var m=pr();es.flags|=s,m.memoizedState=xl(1|a,{destroy:void 0},o,c===void 0?null:c)}function bd(s,a,o,c){var m=En();c=c===void 0?null:c;var f=m.memoizedState.inst;Hs!==null&&c!==null&&Jm(c,Hs.memoizedState.deps)?m.memoizedState=xl(a,f,o,c):(es.flags|=s,m.memoizedState=xl(1|a,f,o,c))}function rv(s,a){yd(8390656,8,s,a)}function cf(s,a){bd(2048,8,s,a)}function cj(s){es.flags|=4;var a=es.updateQueue;if(a===null)a=fd(),es.updateQueue=a,a.events=[s];else{var o=a.events;o===null?a.events=[s]:o.push(s)}}function av(s){var a=En().memoizedState;return cj({ref:a,nextImpl:s}),function(){if((Bs&2)!==0)throw Error(i(440));return a.impl.apply(void 0,arguments)}}function iv(s,a){return bd(4,2,s,a)}function ov(s,a){return bd(4,4,s,a)}function lv(s,a){if(typeof a=="function"){s=s();var o=a(s);return function(){typeof o=="function"?o():a(null)}}if(a!=null)return s=s(),a.current=s,function(){a.current=null}}function cv(s,a,o){o=o!=null?o.concat([s]):null,bd(4,4,lv.bind(null,a,s),o)}function uf(){}function uv(s,a){var o=En();a=a===void 0?null:a;var c=o.memoizedState;return a!==null&&Jm(a,c[1])?c[0]:(o.memoizedState=[s,a],s)}function dv(s,a){var o=En();a=a===void 0?null:a;var c=o.memoizedState;if(a!==null&&Jm(a,c[1]))return c[0];if(c=s(),Ro){we(!0);try{s()}finally{we(!1)}}return o.memoizedState=[c,a],c}function df(s,a,o){return o===void 0||(Qa&1073741824)!==0&&(fs&261930)===0?s.memoizedState=a:(s.memoizedState=o,s=h0(),es.lanes|=s,Di|=s,o)}function hv(s,a,o,c){return Lr(o,a)?o:yl.current!==null?(s=df(s,o,c),Lr(s,a)||(An=!0),s):(Qa&42)===0||(Qa&1073741824)!==0&&(fs&261930)===0?(An=!0,s.memoizedState=o):(s=h0(),es.lanes|=s,Di|=s,a)}function mv(s,a,o,c,m){var f=me.p;me.p=f!==0&&8>f?f:8;var x=$.T,N={};$.T=N,ff(s,!1,a,o);try{var z=m(),ie=$.S;if(ie!==null&&ie(N,z),z!==null&&typeof z=="object"&&typeof z.then=="function"){var ke=rj(z,c);jc(s,a,ke,zr(s))}else jc(s,a,c,zr(s))}catch(Ie){jc(s,a,{then:function(){},status:"rejected",reason:Ie},zr())}finally{me.p=f,x!==null&&N.types!==null&&(x.types=N.types),$.T=x}}function uj(){}function hf(s,a,o,c){if(s.tag!==5)throw Error(i(476));var m=fv(s).queue;mv(s,m,a,Ve,o===null?uj:function(){return pv(s),o(c)})}function fv(s){var a=s.memoizedState;if(a!==null)return a;a={memoizedState:Ve,baseState:Ve,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Xa,lastRenderedState:Ve},next:null};var o={};return a.next={memoizedState:o,baseState:o,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Xa,lastRenderedState:o},next:null},s.memoizedState=a,s=s.alternate,s!==null&&(s.memoizedState=a),a}function pv(s){var a=fv(s);a.next===null&&(a=s.alternate.memoizedState),jc(s,a.next.queue,{},zr())}function mf(){return Qn(Fc)}function gv(){return En().memoizedState}function yv(){return En().memoizedState}function dj(s){for(var a=s.return;a!==null;){switch(a.tag){case 24:case 3:var o=zr();s=Si(o);var c=Ci(a,s,o);c!==null&&(Rr(c,a,o),vc(c,a,o)),a={cache:Fm()},s.payload=a;return}a=a.return}}function hj(s,a,o){var c=zr();o={lane:c,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null},vd(s)?vv(a,o):(o=Rm(s,a,o,c),o!==null&&(Rr(o,s,c),xv(o,a,c)))}function bv(s,a,o){var c=zr();jc(s,a,o,c)}function jc(s,a,o,c){var m={lane:c,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null};if(vd(s))vv(a,m);else{var f=s.alternate;if(s.lanes===0&&(f===null||f.lanes===0)&&(f=a.lastRenderedReducer,f!==null))try{var x=a.lastRenderedState,N=f(x,o);if(m.hasEagerState=!0,m.eagerState=N,Lr(N,x))return Zu(s,a,m,0),Qs===null&&Ju(),!1}catch{}if(o=Rm(s,a,m,c),o!==null)return Rr(o,s,c),xv(o,a,c),!0}return!1}function ff(s,a,o,c){if(c={lane:2,revertLane:Wf(),gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},vd(s)){if(a)throw Error(i(479))}else a=Rm(s,o,c,2),a!==null&&Rr(a,s,2)}function vd(s){var a=s.alternate;return s===es||a!==null&&a===es}function vv(s,a){bl=hd=!0;var o=s.pending;o===null?a.next=a:(a.next=o.next,o.next=a),s.pending=a}function xv(s,a,o){if((o&4194048)!==0){var c=a.lanes;c&=s.pendingLanes,o|=c,a.lanes=o,Ss(s,o)}}var Tc={readContext:Qn,use:pd,useCallback:yn,useContext:yn,useEffect:yn,useImperativeHandle:yn,useLayoutEffect:yn,useInsertionEffect:yn,useMemo:yn,useReducer:yn,useRef:yn,useState:yn,useDebugValue:yn,useDeferredValue:yn,useTransition:yn,useSyncExternalStore:yn,useId:yn,useHostTransitionStatus:yn,useFormState:yn,useActionState:yn,useOptimistic:yn,useMemoCache:yn,useCacheRefresh:yn};Tc.useEffectEvent=yn;var wv={readContext:Qn,use:pd,useCallback:function(s,a){return pr().memoizedState=[s,a===void 0?null:a],s},useContext:Qn,useEffect:rv,useImperativeHandle:function(s,a,o){o=o!=null?o.concat([s]):null,yd(4194308,4,lv.bind(null,a,s),o)},useLayoutEffect:function(s,a){return yd(4194308,4,s,a)},useInsertionEffect:function(s,a){yd(4,2,s,a)},useMemo:function(s,a){var o=pr();a=a===void 0?null:a;var c=s();if(Ro){we(!0);try{s()}finally{we(!1)}}return o.memoizedState=[c,a],c},useReducer:function(s,a,o){var c=pr();if(o!==void 0){var m=o(a);if(Ro){we(!0);try{o(a)}finally{we(!1)}}}else m=a;return c.memoizedState=c.baseState=m,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:m},c.queue=s,s=s.dispatch=hj.bind(null,es,s),[c.memoizedState,s]},useRef:function(s){var a=pr();return s={current:s},a.memoizedState=s},useState:function(s){s=of(s);var a=s.queue,o=bv.bind(null,es,a);return a.dispatch=o,[s.memoizedState,o]},useDebugValue:uf,useDeferredValue:function(s,a){var o=pr();return df(o,s,a)},useTransition:function(){var s=of(!1);return s=mv.bind(null,es,s.queue,!0,!1),pr().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,a,o){var c=es,m=pr();if(ks){if(o===void 0)throw Error(i(407));o=o()}else{if(o=a(),Qs===null)throw Error(i(349));(fs&127)!==0||zb(c,a,o)}m.memoizedState=o;var f={value:o,getSnapshot:a};return m.queue=f,rv(Hb.bind(null,c,f,s),[s]),c.flags|=2048,xl(9,{destroy:void 0},qb.bind(null,c,f,o,a),null),o},useId:function(){var s=pr(),a=Qs.identifierPrefix;if(ks){var o=Sa,c=Na;o=(c&~(1<<32-Oe(c)-1)).toString(32)+o,a="_"+a+"R_"+o,o=md++,0<o&&(a+="H"+o.toString(32)),a+="_"}else o=aj++,a="_"+a+"r_"+o.toString(32)+"_";return s.memoizedState=a},useHostTransitionStatus:mf,useFormState:Zb,useActionState:Zb,useOptimistic:function(s){var a=pr();a.memoizedState=a.baseState=s;var o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return a.queue=o,a=ff.bind(null,es,!0,o),o.dispatch=a,[s,a]},useMemoCache:nf,useCacheRefresh:function(){return pr().memoizedState=dj.bind(null,es)},useEffectEvent:function(s){var a=pr(),o={impl:s};return a.memoizedState=o,function(){if((Bs&2)!==0)throw Error(i(440));return o.impl.apply(void 0,arguments)}}},pf={readContext:Qn,use:pd,useCallback:uv,useContext:Qn,useEffect:cf,useImperativeHandle:cv,useInsertionEffect:iv,useLayoutEffect:ov,useMemo:dv,useReducer:gd,useRef:nv,useState:function(){return gd(Xa)},useDebugValue:uf,useDeferredValue:function(s,a){var o=En();return hv(o,Hs.memoizedState,s,a)},useTransition:function(){var s=gd(Xa)[0],a=En().memoizedState;return[typeof s=="boolean"?s:kc(s),a]},useSyncExternalStore:Fb,useId:gv,useHostTransitionStatus:mf,useFormState:ev,useActionState:ev,useOptimistic:function(s,a){var o=En();return Gb(o,Hs,s,a)},useMemoCache:nf,useCacheRefresh:yv};pf.useEffectEvent=av;var _v={readContext:Qn,use:pd,useCallback:uv,useContext:Qn,useEffect:cf,useImperativeHandle:cv,useInsertionEffect:iv,useLayoutEffect:ov,useMemo:dv,useReducer:af,useRef:nv,useState:function(){return af(Xa)},useDebugValue:uf,useDeferredValue:function(s,a){var o=En();return Hs===null?df(o,s,a):hv(o,Hs.memoizedState,s,a)},useTransition:function(){var s=af(Xa)[0],a=En().memoizedState;return[typeof s=="boolean"?s:kc(s),a]},useSyncExternalStore:Fb,useId:gv,useHostTransitionStatus:mf,useFormState:sv,useActionState:sv,useOptimistic:function(s,a){var o=En();return Hs!==null?Gb(o,Hs,s,a):(o.baseState=s,[s,o.queue.dispatch])},useMemoCache:nf,useCacheRefresh:yv};_v.useEffectEvent=av;function gf(s,a,o,c){a=s.memoizedState,o=o(c,a),o=o==null?a:j({},a,o),s.memoizedState=o,s.lanes===0&&(s.updateQueue.baseState=o)}var yf={enqueueSetState:function(s,a,o){s=s._reactInternals;var c=zr(),m=Si(c);m.payload=a,o!=null&&(m.callback=o),a=Ci(s,m,c),a!==null&&(Rr(a,s,c),vc(a,s,c))},enqueueReplaceState:function(s,a,o){s=s._reactInternals;var c=zr(),m=Si(c);m.tag=1,m.payload=a,o!=null&&(m.callback=o),a=Ci(s,m,c),a!==null&&(Rr(a,s,c),vc(a,s,c))},enqueueForceUpdate:function(s,a){s=s._reactInternals;var o=zr(),c=Si(o);c.tag=2,a!=null&&(c.callback=a),a=Ci(s,c,o),a!==null&&(Rr(a,s,o),vc(a,s,o))}};function kv(s,a,o,c,m,f,x){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(c,f,x):a.prototype&&a.prototype.isPureReactComponent?!dc(o,c)||!dc(m,f):!0}function jv(s,a,o,c){s=a.state,typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps(o,c),typeof a.UNSAFE_componentWillReceiveProps=="function"&&a.UNSAFE_componentWillReceiveProps(o,c),a.state!==s&&yf.enqueueReplaceState(a,a.state,null)}function Ao(s,a){var o=a;if("ref"in a){o={};for(var c in a)c!=="ref"&&(o[c]=a[c])}if(s=s.defaultProps){o===a&&(o=j({},o));for(var m in s)o[m]===void 0&&(o[m]=s[m])}return o}function Tv(s){Xu(s)}function Ev(s){console.error(s)}function Nv(s){Xu(s)}function xd(s,a){try{var o=s.onUncaughtError;o(a.value,{componentStack:a.stack})}catch(c){setTimeout(function(){throw c})}}function Sv(s,a,o){try{var c=s.onCaughtError;c(o.value,{componentStack:o.stack,errorBoundary:a.tag===1?a.stateNode:null})}catch(m){setTimeout(function(){throw m})}}function bf(s,a,o){return o=Si(o),o.tag=3,o.payload={element:null},o.callback=function(){xd(s,a)},o}function Cv(s){return s=Si(s),s.tag=3,s}function Rv(s,a,o,c){var m=o.type.getDerivedStateFromError;if(typeof m=="function"){var f=c.value;s.payload=function(){return m(f)},s.callback=function(){Sv(a,o,c)}}var x=o.stateNode;x!==null&&typeof x.componentDidCatch=="function"&&(s.callback=function(){Sv(a,o,c),typeof m!="function"&&(Pi===null?Pi=new Set([this]):Pi.add(this));var N=c.stack;this.componentDidCatch(c.value,{componentStack:N!==null?N:""})})}function mj(s,a,o,c,m){if(o.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){if(a=o.alternate,a!==null&&hl(a,o,m,!0),o=Vr.current,o!==null){switch(o.tag){case 31:case 13:return ea===null?Id():o.alternate===null&&bn===0&&(bn=3),o.flags&=-257,o.flags|=65536,o.lanes=m,c===od?o.flags|=16384:(a=o.updateQueue,a===null?o.updateQueue=new Set([c]):a.add(c),qf(s,c,m)),!1;case 22:return o.flags|=65536,c===od?o.flags|=16384:(a=o.updateQueue,a===null?(a={transitions:null,markerInstances:null,retryQueue:new Set([c])},o.updateQueue=a):(o=a.retryQueue,o===null?a.retryQueue=new Set([c]):o.add(c)),qf(s,c,m)),!1}throw Error(i(435,o.tag))}return qf(s,c,m),Id(),!1}if(ks)return a=Vr.current,a!==null?((a.flags&65536)===0&&(a.flags|=256),a.flags|=65536,a.lanes=m,c!==Lm&&(s=Error(i(422),{cause:c}),fc(Qr(s,o)))):(c!==Lm&&(a=Error(i(423),{cause:c}),fc(Qr(a,o))),s=s.current.alternate,s.flags|=65536,m&=-m,s.lanes|=m,c=Qr(c,o),m=bf(s.stateNode,c,m),Gm(s,m),bn!==4&&(bn=2)),!1;var f=Error(i(520),{cause:c});if(f=Qr(f,o),Mc===null?Mc=[f]:Mc.push(f),bn!==4&&(bn=2),a===null)return!0;c=Qr(c,o),o=a;do{switch(o.tag){case 3:return o.flags|=65536,s=m&-m,o.lanes|=s,s=bf(o.stateNode,c,s),Gm(o,s),!1;case 1:if(a=o.type,f=o.stateNode,(o.flags&128)===0&&(typeof a.getDerivedStateFromError=="function"||f!==null&&typeof f.componentDidCatch=="function"&&(Pi===null||!Pi.has(f))))return o.flags|=65536,m&=-m,o.lanes|=m,m=Cv(m),Rv(m,s,o,c),Gm(o,m),!1}o=o.return}while(o!==null);return!1}var vf=Error(i(461)),An=!1;function Xn(s,a,o,c){a.child=s===null?Db(a,null,o,c):Co(a,s.child,o,c)}function Av(s,a,o,c,m){o=o.render;var f=a.ref;if("ref"in c){var x={};for(var N in c)N!=="ref"&&(x[N]=c[N])}else x=c;return To(a),c=Zm(s,a,o,x,f,m),N=ef(),s!==null&&!An?(tf(s,a,m),Ja(s,a,m)):(ks&&N&&Dm(a),a.flags|=1,Xn(s,a,c,m),a.child)}function Iv(s,a,o,c,m){if(s===null){var f=o.type;return typeof f=="function"&&!Am(f)&&f.defaultProps===void 0&&o.compare===null?(a.tag=15,a.type=f,Mv(s,a,f,c,m)):(s=td(o.type,null,c,a,a.mode,m),s.ref=a.ref,s.return=a,a.child=s)}if(f=s.child,!Nf(s,m)){var x=f.memoizedProps;if(o=o.compare,o=o!==null?o:dc,o(x,c)&&s.ref===a.ref)return Ja(s,a,m)}return a.flags|=1,s=Wa(f,c),s.ref=a.ref,s.return=a,a.child=s}function Mv(s,a,o,c,m){if(s!==null){var f=s.memoizedProps;if(dc(f,c)&&s.ref===a.ref)if(An=!1,a.pendingProps=c=f,Nf(s,m))(s.flags&131072)!==0&&(An=!0);else return a.lanes=s.lanes,Ja(s,a,m)}return xf(s,a,o,c,m)}function Dv(s,a,o,c){var m=c.children,f=s!==null?s.memoizedState:null;if(s===null&&a.stateNode===null&&(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),c.mode==="hidden"){if((a.flags&128)!==0){if(f=f!==null?f.baseLanes|o:o,s!==null){for(c=a.child=s.child,m=0;c!==null;)m=m|c.lanes|c.childLanes,c=c.sibling;c=m&~f}else c=0,a.child=null;return Pv(s,a,f,o,c)}if((o&536870912)!==0)a.memoizedState={baseLanes:0,cachePool:null},s!==null&&ad(a,f!==null?f.cachePool:null),f!==null?Ob(a,f):Ym(),Vb(a);else return c=a.lanes=536870912,Pv(s,a,f!==null?f.baseLanes|o:o,o,c)}else f!==null?(ad(a,f.cachePool),Ob(a,f),Ai(),a.memoizedState=null):(s!==null&&ad(a,null),Ym(),Ai());return Xn(s,a,m,o),a.child}function Ec(s,a){return s!==null&&s.tag===22||a.stateNode!==null||(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),a.sibling}function Pv(s,a,o,c,m){var f=qm();return f=f===null?null:{parent:Cn._currentValue,pool:f},a.memoizedState={baseLanes:o,cachePool:f},s!==null&&ad(a,null),Ym(),Vb(a),s!==null&&hl(s,a,c,!0),a.childLanes=m,null}function wd(s,a){return a=kd({mode:a.mode,children:a.children},s.mode),a.ref=s.ref,s.child=a,a.return=s,a}function Lv(s,a,o){return Co(a,s.child,null,o),s=wd(a,a.pendingProps),s.flags|=2,Br(a),a.memoizedState=null,s}function fj(s,a,o){var c=a.pendingProps,m=(a.flags&128)!==0;if(a.flags&=-129,s===null){if(ks){if(c.mode==="hidden")return s=wd(a,c),a.lanes=536870912,Ec(null,s);if(Xm(a),(s=sn)?(s=K0(s,Zr),s=s!==null&&s.data==="&"?s:null,s!==null&&(a.memoizedState={dehydrated:s,treeContext:ki!==null?{id:Na,overflow:Sa}:null,retryLane:536870912,hydrationErrors:null},o=vb(s),o.return=a,a.child=o,Yn=a,sn=null)):s=null,s===null)throw Ti(a);return a.lanes=536870912,null}return wd(a,c)}var f=s.memoizedState;if(f!==null){var x=f.dehydrated;if(Xm(a),m)if(a.flags&256)a.flags&=-257,a=Lv(s,a,o);else if(a.memoizedState!==null)a.child=s.child,a.flags|=128,a=null;else throw Error(i(558));else if(An||hl(s,a,o,!1),m=(o&s.childLanes)!==0,An||m){if(c=Qs,c!==null&&(x=Os(c,o),x!==0&&x!==f.retryLane))throw f.retryLane=x,wo(s,x),Rr(c,s,x),vf;Id(),a=Lv(s,a,o)}else s=f.treeContext,sn=ta(x.nextSibling),Yn=a,ks=!0,ji=null,Zr=!1,s!==null&&_b(a,s),a=wd(a,c),a.flags|=4096;return a}return s=Wa(s.child,{mode:c.mode,children:c.children}),s.ref=a.ref,a.child=s,s.return=a,s}function _d(s,a){var o=a.ref;if(o===null)s!==null&&s.ref!==null&&(a.flags|=4194816);else{if(typeof o!="function"&&typeof o!="object")throw Error(i(284));(s===null||s.ref!==o)&&(a.flags|=4194816)}}function xf(s,a,o,c,m){return To(a),o=Zm(s,a,o,c,void 0,m),c=ef(),s!==null&&!An?(tf(s,a,m),Ja(s,a,m)):(ks&&c&&Dm(a),a.flags|=1,Xn(s,a,o,m),a.child)}function Ov(s,a,o,c,m,f){return To(a),a.updateQueue=null,o=Ub(a,c,o,m),Bb(s),c=ef(),s!==null&&!An?(tf(s,a,f),Ja(s,a,f)):(ks&&c&&Dm(a),a.flags|=1,Xn(s,a,o,f),a.child)}function Vv(s,a,o,c,m){if(To(a),a.stateNode===null){var f=ll,x=o.contextType;typeof x=="object"&&x!==null&&(f=Qn(x)),f=new o(c,f),a.memoizedState=f.state!==null&&f.state!==void 0?f.state:null,f.updater=yf,a.stateNode=f,f._reactInternals=a,f=a.stateNode,f.props=c,f.state=a.memoizedState,f.refs={},$m(a),x=o.contextType,f.context=typeof x=="object"&&x!==null?Qn(x):ll,f.state=a.memoizedState,x=o.getDerivedStateFromProps,typeof x=="function"&&(gf(a,o,x,c),f.state=a.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof f.getSnapshotBeforeUpdate=="function"||typeof f.UNSAFE_componentWillMount!="function"&&typeof f.componentWillMount!="function"||(x=f.state,typeof f.componentWillMount=="function"&&f.componentWillMount(),typeof f.UNSAFE_componentWillMount=="function"&&f.UNSAFE_componentWillMount(),x!==f.state&&yf.enqueueReplaceState(f,f.state,null),wc(a,c,f,m),xc(),f.state=a.memoizedState),typeof f.componentDidMount=="function"&&(a.flags|=4194308),c=!0}else if(s===null){f=a.stateNode;var N=a.memoizedProps,z=Ao(o,N);f.props=z;var ie=f.context,ke=o.contextType;x=ll,typeof ke=="object"&&ke!==null&&(x=Qn(ke));var Ie=o.getDerivedStateFromProps;ke=typeof Ie=="function"||typeof f.getSnapshotBeforeUpdate=="function",N=a.pendingProps!==N,ke||typeof f.UNSAFE_componentWillReceiveProps!="function"&&typeof f.componentWillReceiveProps!="function"||(N||ie!==x)&&jv(a,f,c,x),Ni=!1;var le=a.memoizedState;f.state=le,wc(a,c,f,m),xc(),ie=a.memoizedState,N||le!==ie||Ni?(typeof Ie=="function"&&(gf(a,o,Ie,c),ie=a.memoizedState),(z=Ni||kv(a,o,z,c,le,ie,x))?(ke||typeof f.UNSAFE_componentWillMount!="function"&&typeof f.componentWillMount!="function"||(typeof f.componentWillMount=="function"&&f.componentWillMount(),typeof f.UNSAFE_componentWillMount=="function"&&f.UNSAFE_componentWillMount()),typeof f.componentDidMount=="function"&&(a.flags|=4194308)):(typeof f.componentDidMount=="function"&&(a.flags|=4194308),a.memoizedProps=c,a.memoizedState=ie),f.props=c,f.state=ie,f.context=x,c=z):(typeof f.componentDidMount=="function"&&(a.flags|=4194308),c=!1)}else{f=a.stateNode,Wm(s,a),x=a.memoizedProps,ke=Ao(o,x),f.props=ke,Ie=a.pendingProps,le=f.context,ie=o.contextType,z=ll,typeof ie=="object"&&ie!==null&&(z=Qn(ie)),N=o.getDerivedStateFromProps,(ie=typeof N=="function"||typeof f.getSnapshotBeforeUpdate=="function")||typeof f.UNSAFE_componentWillReceiveProps!="function"&&typeof f.componentWillReceiveProps!="function"||(x!==Ie||le!==z)&&jv(a,f,c,z),Ni=!1,le=a.memoizedState,f.state=le,wc(a,c,f,m),xc();var ye=a.memoizedState;x!==Ie||le!==ye||Ni||s!==null&&s.dependencies!==null&&nd(s.dependencies)?(typeof N=="function"&&(gf(a,o,N,c),ye=a.memoizedState),(ke=Ni||kv(a,o,ke,c,le,ye,z)||s!==null&&s.dependencies!==null&&nd(s.dependencies))?(ie||typeof f.UNSAFE_componentWillUpdate!="function"&&typeof f.componentWillUpdate!="function"||(typeof f.componentWillUpdate=="function"&&f.componentWillUpdate(c,ye,z),typeof f.UNSAFE_componentWillUpdate=="function"&&f.UNSAFE_componentWillUpdate(c,ye,z)),typeof f.componentDidUpdate=="function"&&(a.flags|=4),typeof f.getSnapshotBeforeUpdate=="function"&&(a.flags|=1024)):(typeof f.componentDidUpdate!="function"||x===s.memoizedProps&&le===s.memoizedState||(a.flags|=4),typeof f.getSnapshotBeforeUpdate!="function"||x===s.memoizedProps&&le===s.memoizedState||(a.flags|=1024),a.memoizedProps=c,a.memoizedState=ye),f.props=c,f.state=ye,f.context=z,c=ke):(typeof f.componentDidUpdate!="function"||x===s.memoizedProps&&le===s.memoizedState||(a.flags|=4),typeof f.getSnapshotBeforeUpdate!="function"||x===s.memoizedProps&&le===s.memoizedState||(a.flags|=1024),c=!1)}return f=c,_d(s,a),c=(a.flags&128)!==0,f||c?(f=a.stateNode,o=c&&typeof o.getDerivedStateFromError!="function"?null:f.render(),a.flags|=1,s!==null&&c?(a.child=Co(a,s.child,null,m),a.child=Co(a,null,o,m)):Xn(s,a,o,m),a.memoizedState=f.state,s=a.child):s=Ja(s,a,m),s}function Bv(s,a,o,c){return ko(),a.flags|=256,Xn(s,a,o,c),a.child}var wf={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function _f(s){return{baseLanes:s,cachePool:Sb()}}function kf(s,a,o){return s=s!==null?s.childLanes&~o:0,a&&(s|=Fr),s}function Uv(s,a,o){var c=a.pendingProps,m=!1,f=(a.flags&128)!==0,x;if((x=f)||(x=s!==null&&s.memoizedState===null?!1:(Tn.current&2)!==0),x&&(m=!0,a.flags&=-129),x=(a.flags&32)!==0,a.flags&=-33,s===null){if(ks){if(m?Ri(a):Ai(),(s=sn)?(s=K0(s,Zr),s=s!==null&&s.data!=="&"?s:null,s!==null&&(a.memoizedState={dehydrated:s,treeContext:ki!==null?{id:Na,overflow:Sa}:null,retryLane:536870912,hydrationErrors:null},o=vb(s),o.return=a,a.child=o,Yn=a,sn=null)):s=null,s===null)throw Ti(a);return ap(s)?a.lanes=32:a.lanes=536870912,null}var N=c.children;return c=c.fallback,m?(Ai(),m=a.mode,N=kd({mode:"hidden",children:N},m),c=_o(c,m,o,null),N.return=a,c.return=a,N.sibling=c,a.child=N,c=a.child,c.memoizedState=_f(o),c.childLanes=kf(s,x,o),a.memoizedState=wf,Ec(null,c)):(Ri(a),jf(a,N))}var z=s.memoizedState;if(z!==null&&(N=z.dehydrated,N!==null)){if(f)a.flags&256?(Ri(a),a.flags&=-257,a=Tf(s,a,o)):a.memoizedState!==null?(Ai(),a.child=s.child,a.flags|=128,a=null):(Ai(),N=c.fallback,m=a.mode,c=kd({mode:"visible",children:c.children},m),N=_o(N,m,o,null),N.flags|=2,c.return=a,N.return=a,c.sibling=N,a.child=c,Co(a,s.child,null,o),c=a.child,c.memoizedState=_f(o),c.childLanes=kf(s,x,o),a.memoizedState=wf,a=Ec(null,c));else if(Ri(a),ap(N)){if(x=N.nextSibling&&N.nextSibling.dataset,x)var ie=x.dgst;x=ie,c=Error(i(419)),c.stack="",c.digest=x,fc({value:c,source:null,stack:null}),a=Tf(s,a,o)}else if(An||hl(s,a,o,!1),x=(o&s.childLanes)!==0,An||x){if(x=Qs,x!==null&&(c=Os(x,o),c!==0&&c!==z.retryLane))throw z.retryLane=c,wo(s,c),Rr(x,s,c),vf;rp(N)||Id(),a=Tf(s,a,o)}else rp(N)?(a.flags|=192,a.child=s.child,a=null):(s=z.treeContext,sn=ta(N.nextSibling),Yn=a,ks=!0,ji=null,Zr=!1,s!==null&&_b(a,s),a=jf(a,c.children),a.flags|=4096);return a}return m?(Ai(),N=c.fallback,m=a.mode,z=s.child,ie=z.sibling,c=Wa(z,{mode:"hidden",children:c.children}),c.subtreeFlags=z.subtreeFlags&65011712,ie!==null?N=Wa(ie,N):(N=_o(N,m,o,null),N.flags|=2),N.return=a,c.return=a,c.sibling=N,a.child=c,Ec(null,c),c=a.child,N=s.child.memoizedState,N===null?N=_f(o):(m=N.cachePool,m!==null?(z=Cn._currentValue,m=m.parent!==z?{parent:z,pool:z}:m):m=Sb(),N={baseLanes:N.baseLanes|o,cachePool:m}),c.memoizedState=N,c.childLanes=kf(s,x,o),a.memoizedState=wf,Ec(s.child,c)):(Ri(a),o=s.child,s=o.sibling,o=Wa(o,{mode:"visible",children:c.children}),o.return=a,o.sibling=null,s!==null&&(x=a.deletions,x===null?(a.deletions=[s],a.flags|=16):x.push(s)),a.child=o,a.memoizedState=null,o)}function jf(s,a){return a=kd({mode:"visible",children:a},s.mode),a.return=s,s.child=a}function kd(s,a){return s=Or(22,s,null,a),s.lanes=0,s}function Tf(s,a,o){return Co(a,s.child,null,o),s=jf(a,a.pendingProps.children),s.flags|=2,a.memoizedState=null,s}function Fv(s,a,o){s.lanes|=a;var c=s.alternate;c!==null&&(c.lanes|=a),Bm(s.return,a,o)}function Ef(s,a,o,c,m,f){var x=s.memoizedState;x===null?s.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:c,tail:o,tailMode:m,treeForkCount:f}:(x.isBackwards=a,x.rendering=null,x.renderingStartTime=0,x.last=c,x.tail=o,x.tailMode=m,x.treeForkCount=f)}function zv(s,a,o){var c=a.pendingProps,m=c.revealOrder,f=c.tail;c=c.children;var x=Tn.current,N=(x&2)!==0;if(N?(x=x&1|2,a.flags|=128):x&=1,Me(Tn,x),Xn(s,a,c,o),c=ks?mc:0,!N&&s!==null&&(s.flags&128)!==0)e:for(s=a.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&Fv(s,o,a);else if(s.tag===19)Fv(s,o,a);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===a)break e;for(;s.sibling===null;){if(s.return===null||s.return===a)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}switch(m){case"forwards":for(o=a.child,m=null;o!==null;)s=o.alternate,s!==null&&dd(s)===null&&(m=o),o=o.sibling;o=m,o===null?(m=a.child,a.child=null):(m=o.sibling,o.sibling=null),Ef(a,!1,m,o,f,c);break;case"backwards":case"unstable_legacy-backwards":for(o=null,m=a.child,a.child=null;m!==null;){if(s=m.alternate,s!==null&&dd(s)===null){a.child=m;break}s=m.sibling,m.sibling=o,o=m,m=s}Ef(a,!0,o,null,f,c);break;case"together":Ef(a,!1,null,null,void 0,c);break;default:a.memoizedState=null}return a.child}function Ja(s,a,o){if(s!==null&&(a.dependencies=s.dependencies),Di|=a.lanes,(o&a.childLanes)===0)if(s!==null){if(hl(s,a,o,!1),(o&a.childLanes)===0)return null}else return null;if(s!==null&&a.child!==s.child)throw Error(i(153));if(a.child!==null){for(s=a.child,o=Wa(s,s.pendingProps),a.child=o,o.return=a;s.sibling!==null;)s=s.sibling,o=o.sibling=Wa(s,s.pendingProps),o.return=a;o.sibling=null}return a.child}function Nf(s,a){return(s.lanes&a)!==0?!0:(s=s.dependencies,!!(s!==null&&nd(s)))}function pj(s,a,o){switch(a.tag){case 3:kt(a,a.stateNode.containerInfo),Ei(a,Cn,s.memoizedState.cache),ko();break;case 27:case 5:Wt(a);break;case 4:kt(a,a.stateNode.containerInfo);break;case 10:Ei(a,a.type,a.memoizedProps.value);break;case 31:if(a.memoizedState!==null)return a.flags|=128,Xm(a),null;break;case 13:var c=a.memoizedState;if(c!==null)return c.dehydrated!==null?(Ri(a),a.flags|=128,null):(o&a.child.childLanes)!==0?Uv(s,a,o):(Ri(a),s=Ja(s,a,o),s!==null?s.sibling:null);Ri(a);break;case 19:var m=(s.flags&128)!==0;if(c=(o&a.childLanes)!==0,c||(hl(s,a,o,!1),c=(o&a.childLanes)!==0),m){if(c)return zv(s,a,o);a.flags|=128}if(m=a.memoizedState,m!==null&&(m.rendering=null,m.tail=null,m.lastEffect=null),Me(Tn,Tn.current),c)break;return null;case 22:return a.lanes=0,Dv(s,a,o,a.pendingProps);case 24:Ei(a,Cn,s.memoizedState.cache)}return Ja(s,a,o)}function qv(s,a,o){if(s!==null)if(s.memoizedProps!==a.pendingProps)An=!0;else{if(!Nf(s,o)&&(a.flags&128)===0)return An=!1,pj(s,a,o);An=(s.flags&131072)!==0}else An=!1,ks&&(a.flags&1048576)!==0&&wb(a,mc,a.index);switch(a.lanes=0,a.tag){case 16:e:{var c=a.pendingProps;if(s=No(a.elementType),a.type=s,typeof s=="function")Am(s)?(c=Ao(s,c),a.tag=1,a=Vv(null,a,s,c,o)):(a.tag=0,a=xf(null,a,s,c,o));else{if(s!=null){var m=s.$$typeof;if(m===be){a.tag=11,a=Av(null,a,s,c,o);break e}else if(m===R){a.tag=14,a=Iv(null,a,s,c,o);break e}}throw a=We(s)||s,Error(i(306,a,""))}}return a;case 0:return xf(s,a,a.type,a.pendingProps,o);case 1:return c=a.type,m=Ao(c,a.pendingProps),Vv(s,a,c,m,o);case 3:e:{if(kt(a,a.stateNode.containerInfo),s===null)throw Error(i(387));c=a.pendingProps;var f=a.memoizedState;m=f.element,Wm(s,a),wc(a,c,null,o);var x=a.memoizedState;if(c=x.cache,Ei(a,Cn,c),c!==f.cache&&Um(a,[Cn],o,!0),xc(),c=x.element,f.isDehydrated)if(f={element:c,isDehydrated:!1,cache:x.cache},a.updateQueue.baseState=f,a.memoizedState=f,a.flags&256){a=Bv(s,a,c,o);break e}else if(c!==m){m=Qr(Error(i(424)),a),fc(m),a=Bv(s,a,c,o);break e}else for(s=a.stateNode.containerInfo,s.nodeType===9?s=s.body:s=s.nodeName==="HTML"?s.ownerDocument.body:s,sn=ta(s.firstChild),Yn=a,ks=!0,ji=null,Zr=!0,o=Db(a,null,c,o),a.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling;else{if(ko(),c===m){a=Ja(s,a,o);break e}Xn(s,a,c,o)}a=a.child}return a;case 26:return _d(s,a),s===null?(o=e1(a.type,null,a.pendingProps,null))?a.memoizedState=o:ks||(o=a.type,s=a.pendingProps,c=Bd(Fe.current).createElement(o),c[ct]=a,c[ht]=s,Jn(c,o,s),S(c),a.stateNode=c):a.memoizedState=e1(a.type,s.memoizedProps,a.pendingProps,s.memoizedState),null;case 27:return Wt(a),s===null&&ks&&(c=a.stateNode=X0(a.type,a.pendingProps,Fe.current),Yn=a,Zr=!0,m=sn,Bi(a.type)?(ip=m,sn=ta(c.firstChild)):sn=m),Xn(s,a,a.pendingProps.children,o),_d(s,a),s===null&&(a.flags|=4194304),a.child;case 5:return s===null&&ks&&((m=c=sn)&&(c=$j(c,a.type,a.pendingProps,Zr),c!==null?(a.stateNode=c,Yn=a,sn=ta(c.firstChild),Zr=!1,m=!0):m=!1),m||Ti(a)),Wt(a),m=a.type,f=a.pendingProps,x=s!==null?s.memoizedProps:null,c=f.children,tp(m,f)?c=null:x!==null&&tp(m,x)&&(a.flags|=32),a.memoizedState!==null&&(m=Zm(s,a,ij,null,null,o),Fc._currentValue=m),_d(s,a),Xn(s,a,c,o),a.child;case 6:return s===null&&ks&&((s=o=sn)&&(o=Wj(o,a.pendingProps,Zr),o!==null?(a.stateNode=o,Yn=a,sn=null,s=!0):s=!1),s||Ti(a)),null;case 13:return Uv(s,a,o);case 4:return kt(a,a.stateNode.containerInfo),c=a.pendingProps,s===null?a.child=Co(a,null,c,o):Xn(s,a,c,o),a.child;case 11:return Av(s,a,a.type,a.pendingProps,o);case 7:return Xn(s,a,a.pendingProps,o),a.child;case 8:return Xn(s,a,a.pendingProps.children,o),a.child;case 12:return Xn(s,a,a.pendingProps.children,o),a.child;case 10:return c=a.pendingProps,Ei(a,a.type,c.value),Xn(s,a,c.children,o),a.child;case 9:return m=a.type._context,c=a.pendingProps.children,To(a),m=Qn(m),c=c(m),a.flags|=1,Xn(s,a,c,o),a.child;case 14:return Iv(s,a,a.type,a.pendingProps,o);case 15:return Mv(s,a,a.type,a.pendingProps,o);case 19:return zv(s,a,o);case 31:return fj(s,a,o);case 22:return Dv(s,a,o,a.pendingProps);case 24:return To(a),c=Qn(Cn),s===null?(m=qm(),m===null&&(m=Qs,f=Fm(),m.pooledCache=f,f.refCount++,f!==null&&(m.pooledCacheLanes|=o),m=f),a.memoizedState={parent:c,cache:m},$m(a),Ei(a,Cn,m)):((s.lanes&o)!==0&&(Wm(s,a),wc(a,null,null,o),xc()),m=s.memoizedState,f=a.memoizedState,m.parent!==c?(m={parent:c,cache:c},a.memoizedState=m,a.lanes===0&&(a.memoizedState=a.updateQueue.baseState=m),Ei(a,Cn,c)):(c=f.cache,Ei(a,Cn,c),c!==m.cache&&Um(a,[Cn],o,!0))),Xn(s,a,a.pendingProps.children,o),a.child;case 29:throw a.pendingProps}throw Error(i(156,a.tag))}function Za(s){s.flags|=4}function Sf(s,a,o,c,m){if((a=(s.mode&32)!==0)&&(a=!1),a){if(s.flags|=16777216,(m&335544128)===m)if(s.stateNode.complete)s.flags|=8192;else if(g0())s.flags|=8192;else throw So=od,Hm}else s.flags&=-16777217}function Hv(s,a){if(a.type!=="stylesheet"||(a.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!a1(a))if(g0())s.flags|=8192;else throw So=od,Hm}function jd(s,a){a!==null&&(s.flags|=4),s.flags&16384&&(a=s.tag!==22?Ut():536870912,s.lanes|=a,jl|=a)}function Nc(s,a){if(!ks)switch(s.tailMode){case"hidden":a=s.tail;for(var o=null;a!==null;)a.alternate!==null&&(o=a),a=a.sibling;o===null?s.tail=null:o.sibling=null;break;case"collapsed":o=s.tail;for(var c=null;o!==null;)o.alternate!==null&&(c=o),o=o.sibling;c===null?a||s.tail===null?s.tail=null:s.tail.sibling=null:c.sibling=null}}function nn(s){var a=s.alternate!==null&&s.alternate.child===s.child,o=0,c=0;if(a)for(var m=s.child;m!==null;)o|=m.lanes|m.childLanes,c|=m.subtreeFlags&65011712,c|=m.flags&65011712,m.return=s,m=m.sibling;else for(m=s.child;m!==null;)o|=m.lanes|m.childLanes,c|=m.subtreeFlags,c|=m.flags,m.return=s,m=m.sibling;return s.subtreeFlags|=c,s.childLanes=o,a}function gj(s,a,o){var c=a.pendingProps;switch(Pm(a),a.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return nn(a),null;case 1:return nn(a),null;case 3:return o=a.stateNode,c=null,s!==null&&(c=s.memoizedState.cache),a.memoizedState.cache!==c&&(a.flags|=2048),Ya(Cn),nt(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(s===null||s.child===null)&&(dl(a)?Za(a):s===null||s.memoizedState.isDehydrated&&(a.flags&256)===0||(a.flags|=1024,Om())),nn(a),null;case 26:var m=a.type,f=a.memoizedState;return s===null?(Za(a),f!==null?(nn(a),Hv(a,f)):(nn(a),Sf(a,m,null,c,o))):f?f!==s.memoizedState?(Za(a),nn(a),Hv(a,f)):(nn(a),a.flags&=-16777217):(s=s.memoizedProps,s!==c&&Za(a),nn(a),Sf(a,m,s,c,o)),null;case 27:if(ts(a),o=Fe.current,m=a.type,s!==null&&a.stateNode!=null)s.memoizedProps!==c&&Za(a);else{if(!c){if(a.stateNode===null)throw Error(i(166));return nn(a),null}s=De.current,dl(a)?kb(a):(s=X0(m,c,o),a.stateNode=s,Za(a))}return nn(a),null;case 5:if(ts(a),m=a.type,s!==null&&a.stateNode!=null)s.memoizedProps!==c&&Za(a);else{if(!c){if(a.stateNode===null)throw Error(i(166));return nn(a),null}if(f=De.current,dl(a))kb(a);else{var x=Bd(Fe.current);switch(f){case 1:f=x.createElementNS("http://www.w3.org/2000/svg",m);break;case 2:f=x.createElementNS("http://www.w3.org/1998/Math/MathML",m);break;default:switch(m){case"svg":f=x.createElementNS("http://www.w3.org/2000/svg",m);break;case"math":f=x.createElementNS("http://www.w3.org/1998/Math/MathML",m);break;case"script":f=x.createElement("div"),f.innerHTML="<script><\/script>",f=f.removeChild(f.firstChild);break;case"select":f=typeof c.is=="string"?x.createElement("select",{is:c.is}):x.createElement("select"),c.multiple?f.multiple=!0:c.size&&(f.size=c.size);break;default:f=typeof c.is=="string"?x.createElement(m,{is:c.is}):x.createElement(m)}}f[ct]=a,f[ht]=c;e:for(x=a.child;x!==null;){if(x.tag===5||x.tag===6)f.appendChild(x.stateNode);else if(x.tag!==4&&x.tag!==27&&x.child!==null){x.child.return=x,x=x.child;continue}if(x===a)break e;for(;x.sibling===null;){if(x.return===null||x.return===a)break e;x=x.return}x.sibling.return=x.return,x=x.sibling}a.stateNode=f;e:switch(Jn(f,m,c),m){case"button":case"input":case"select":case"textarea":c=!!c.autoFocus;break e;case"img":c=!0;break e;default:c=!1}c&&Za(a)}}return nn(a),Sf(a,a.type,s===null?null:s.memoizedProps,a.pendingProps,o),null;case 6:if(s&&a.stateNode!=null)s.memoizedProps!==c&&Za(a);else{if(typeof c!="string"&&a.stateNode===null)throw Error(i(166));if(s=Fe.current,dl(a)){if(s=a.stateNode,o=a.memoizedProps,c=null,m=Yn,m!==null)switch(m.tag){case 27:case 5:c=m.memoizedProps}s[ct]=a,s=!!(s.nodeValue===o||c!==null&&c.suppressHydrationWarning===!0||U0(s.nodeValue,o)),s||Ti(a,!0)}else s=Bd(s).createTextNode(c),s[ct]=a,a.stateNode=s}return nn(a),null;case 31:if(o=a.memoizedState,s===null||s.memoizedState!==null){if(c=dl(a),o!==null){if(s===null){if(!c)throw Error(i(318));if(s=a.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(557));s[ct]=a}else ko(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;nn(a),s=!1}else o=Om(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=o),s=!0;if(!s)return a.flags&256?(Br(a),a):(Br(a),null);if((a.flags&128)!==0)throw Error(i(558))}return nn(a),null;case 13:if(c=a.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(m=dl(a),c!==null&&c.dehydrated!==null){if(s===null){if(!m)throw Error(i(318));if(m=a.memoizedState,m=m!==null?m.dehydrated:null,!m)throw Error(i(317));m[ct]=a}else ko(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;nn(a),m=!1}else m=Om(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=m),m=!0;if(!m)return a.flags&256?(Br(a),a):(Br(a),null)}return Br(a),(a.flags&128)!==0?(a.lanes=o,a):(o=c!==null,s=s!==null&&s.memoizedState!==null,o&&(c=a.child,m=null,c.alternate!==null&&c.alternate.memoizedState!==null&&c.alternate.memoizedState.cachePool!==null&&(m=c.alternate.memoizedState.cachePool.pool),f=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(f=c.memoizedState.cachePool.pool),f!==m&&(c.flags|=2048)),o!==s&&o&&(a.child.flags|=8192),jd(a,a.updateQueue),nn(a),null);case 4:return nt(),s===null&&Qf(a.stateNode.containerInfo),nn(a),null;case 10:return Ya(a.type),nn(a),null;case 19:if(se(Tn),c=a.memoizedState,c===null)return nn(a),null;if(m=(a.flags&128)!==0,f=c.rendering,f===null)if(m)Nc(c,!1);else{if(bn!==0||s!==null&&(s.flags&128)!==0)for(s=a.child;s!==null;){if(f=dd(s),f!==null){for(a.flags|=128,Nc(c,!1),s=f.updateQueue,a.updateQueue=s,jd(a,s),a.subtreeFlags=0,s=o,o=a.child;o!==null;)bb(o,s),o=o.sibling;return Me(Tn,Tn.current&1|2),ks&&Ga(a,c.treeForkCount),a.child}s=s.sibling}c.tail!==null&&ss()>Cd&&(a.flags|=128,m=!0,Nc(c,!1),a.lanes=4194304)}else{if(!m)if(s=dd(f),s!==null){if(a.flags|=128,m=!0,s=s.updateQueue,a.updateQueue=s,jd(a,s),Nc(c,!0),c.tail===null&&c.tailMode==="hidden"&&!f.alternate&&!ks)return nn(a),null}else 2*ss()-c.renderingStartTime>Cd&&o!==536870912&&(a.flags|=128,m=!0,Nc(c,!1),a.lanes=4194304);c.isBackwards?(f.sibling=a.child,a.child=f):(s=c.last,s!==null?s.sibling=f:a.child=f,c.last=f)}return c.tail!==null?(s=c.tail,c.rendering=s,c.tail=s.sibling,c.renderingStartTime=ss(),s.sibling=null,o=Tn.current,Me(Tn,m?o&1|2:o&1),ks&&Ga(a,c.treeForkCount),s):(nn(a),null);case 22:case 23:return Br(a),Qm(),c=a.memoizedState!==null,s!==null?s.memoizedState!==null!==c&&(a.flags|=8192):c&&(a.flags|=8192),c?(o&536870912)!==0&&(a.flags&128)===0&&(nn(a),a.subtreeFlags&6&&(a.flags|=8192)):nn(a),o=a.updateQueue,o!==null&&jd(a,o.retryQueue),o=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(o=s.memoizedState.cachePool.pool),c=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(c=a.memoizedState.cachePool.pool),c!==o&&(a.flags|=2048),s!==null&&se(Eo),null;case 24:return o=null,s!==null&&(o=s.memoizedState.cache),a.memoizedState.cache!==o&&(a.flags|=2048),Ya(Cn),nn(a),null;case 25:return null;case 30:return null}throw Error(i(156,a.tag))}function yj(s,a){switch(Pm(a),a.tag){case 1:return s=a.flags,s&65536?(a.flags=s&-65537|128,a):null;case 3:return Ya(Cn),nt(),s=a.flags,(s&65536)!==0&&(s&128)===0?(a.flags=s&-65537|128,a):null;case 26:case 27:case 5:return ts(a),null;case 31:if(a.memoizedState!==null){if(Br(a),a.alternate===null)throw Error(i(340));ko()}return s=a.flags,s&65536?(a.flags=s&-65537|128,a):null;case 13:if(Br(a),s=a.memoizedState,s!==null&&s.dehydrated!==null){if(a.alternate===null)throw Error(i(340));ko()}return s=a.flags,s&65536?(a.flags=s&-65537|128,a):null;case 19:return se(Tn),null;case 4:return nt(),null;case 10:return Ya(a.type),null;case 22:case 23:return Br(a),Qm(),s!==null&&se(Eo),s=a.flags,s&65536?(a.flags=s&-65537|128,a):null;case 24:return Ya(Cn),null;case 25:return null;default:return null}}function $v(s,a){switch(Pm(a),a.tag){case 3:Ya(Cn),nt();break;case 26:case 27:case 5:ts(a);break;case 4:nt();break;case 31:a.memoizedState!==null&&Br(a);break;case 13:Br(a);break;case 19:se(Tn);break;case 10:Ya(a.type);break;case 22:case 23:Br(a),Qm(),s!==null&&se(Eo);break;case 24:Ya(Cn)}}function Sc(s,a){try{var o=a.updateQueue,c=o!==null?o.lastEffect:null;if(c!==null){var m=c.next;o=m;do{if((o.tag&s)===s){c=void 0;var f=o.create,x=o.inst;c=f(),x.destroy=c}o=o.next}while(o!==m)}}catch(N){qs(a,a.return,N)}}function Ii(s,a,o){try{var c=a.updateQueue,m=c!==null?c.lastEffect:null;if(m!==null){var f=m.next;c=f;do{if((c.tag&s)===s){var x=c.inst,N=x.destroy;if(N!==void 0){x.destroy=void 0,m=a;var z=o,ie=N;try{ie()}catch(ke){qs(m,z,ke)}}}c=c.next}while(c!==f)}}catch(ke){qs(a,a.return,ke)}}function Wv(s){var a=s.updateQueue;if(a!==null){var o=s.stateNode;try{Lb(a,o)}catch(c){qs(s,s.return,c)}}}function Gv(s,a,o){o.props=Ao(s.type,s.memoizedProps),o.state=s.memoizedState;try{o.componentWillUnmount()}catch(c){qs(s,a,c)}}function Cc(s,a){try{var o=s.ref;if(o!==null){switch(s.tag){case 26:case 27:case 5:var c=s.stateNode;break;case 30:c=s.stateNode;break;default:c=s.stateNode}typeof o=="function"?s.refCleanup=o(c):o.current=c}}catch(m){qs(s,a,m)}}function Ca(s,a){var o=s.ref,c=s.refCleanup;if(o!==null)if(typeof c=="function")try{c()}catch(m){qs(s,a,m)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof o=="function")try{o(null)}catch(m){qs(s,a,m)}else o.current=null}function Kv(s){var a=s.type,o=s.memoizedProps,c=s.stateNode;try{e:switch(a){case"button":case"input":case"select":case"textarea":o.autoFocus&&c.focus();break e;case"img":o.src?c.src=o.src:o.srcSet&&(c.srcset=o.srcSet)}}catch(m){qs(s,s.return,m)}}function Cf(s,a,o){try{var c=s.stateNode;Bj(c,s.type,o,a),c[ht]=a}catch(m){qs(s,s.return,m)}}function Yv(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&Bi(s.type)||s.tag===4}function Rf(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||Yv(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&Bi(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function Af(s,a,o){var c=s.tag;if(c===5||c===6)s=s.stateNode,a?(o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o).insertBefore(s,a):(a=o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o,a.appendChild(s),o=o._reactRootContainer,o!=null||a.onclick!==null||(a.onclick=tn));else if(c!==4&&(c===27&&Bi(s.type)&&(o=s.stateNode,a=null),s=s.child,s!==null))for(Af(s,a,o),s=s.sibling;s!==null;)Af(s,a,o),s=s.sibling}function Td(s,a,o){var c=s.tag;if(c===5||c===6)s=s.stateNode,a?o.insertBefore(s,a):o.appendChild(s);else if(c!==4&&(c===27&&Bi(s.type)&&(o=s.stateNode),s=s.child,s!==null))for(Td(s,a,o),s=s.sibling;s!==null;)Td(s,a,o),s=s.sibling}function Qv(s){var a=s.stateNode,o=s.memoizedProps;try{for(var c=s.type,m=a.attributes;m.length;)a.removeAttributeNode(m[0]);Jn(a,c,o),a[ct]=s,a[ht]=o}catch(f){qs(s,s.return,f)}}var ei=!1,In=!1,If=!1,Xv=typeof WeakSet=="function"?WeakSet:Set,qn=null;function bj(s,a){if(s=s.containerInfo,Zf=Wd,s=cb(s),jm(s)){if("selectionStart"in s)var o={start:s.selectionStart,end:s.selectionEnd};else e:{o=(o=s.ownerDocument)&&o.defaultView||window;var c=o.getSelection&&o.getSelection();if(c&&c.rangeCount!==0){o=c.anchorNode;var m=c.anchorOffset,f=c.focusNode;c=c.focusOffset;try{o.nodeType,f.nodeType}catch{o=null;break e}var x=0,N=-1,z=-1,ie=0,ke=0,Ie=s,le=null;t:for(;;){for(var ye;Ie!==o||m!==0&&Ie.nodeType!==3||(N=x+m),Ie!==f||c!==0&&Ie.nodeType!==3||(z=x+c),Ie.nodeType===3&&(x+=Ie.nodeValue.length),(ye=Ie.firstChild)!==null;)le=Ie,Ie=ye;for(;;){if(Ie===s)break t;if(le===o&&++ie===m&&(N=x),le===f&&++ke===c&&(z=x),(ye=Ie.nextSibling)!==null)break;Ie=le,le=Ie.parentNode}Ie=ye}o=N===-1||z===-1?null:{start:N,end:z}}else o=null}o=o||{start:0,end:0}}else o=null;for(ep={focusedElem:s,selectionRange:o},Wd=!1,qn=a;qn!==null;)if(a=qn,s=a.child,(a.subtreeFlags&1028)!==0&&s!==null)s.return=a,qn=s;else for(;qn!==null;){switch(a=qn,f=a.alternate,s=a.flags,a.tag){case 0:if((s&4)!==0&&(s=a.updateQueue,s=s!==null?s.events:null,s!==null))for(o=0;o<s.length;o++)m=s[o],m.ref.impl=m.nextImpl;break;case 11:case 15:break;case 1:if((s&1024)!==0&&f!==null){s=void 0,o=a,m=f.memoizedProps,f=f.memoizedState,c=o.stateNode;try{var mt=Ao(o.type,m);s=c.getSnapshotBeforeUpdate(mt,f),c.__reactInternalSnapshotBeforeUpdate=s}catch(It){qs(o,o.return,It)}}break;case 3:if((s&1024)!==0){if(s=a.stateNode.containerInfo,o=s.nodeType,o===9)np(s);else if(o===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":np(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(i(163))}if(s=a.sibling,s!==null){s.return=a.return,qn=s;break}qn=a.return}}function Jv(s,a,o){var c=o.flags;switch(o.tag){case 0:case 11:case 15:si(s,o),c&4&&Sc(5,o);break;case 1:if(si(s,o),c&4)if(s=o.stateNode,a===null)try{s.componentDidMount()}catch(x){qs(o,o.return,x)}else{var m=Ao(o.type,a.memoizedProps);a=a.memoizedState;try{s.componentDidUpdate(m,a,s.__reactInternalSnapshotBeforeUpdate)}catch(x){qs(o,o.return,x)}}c&64&&Wv(o),c&512&&Cc(o,o.return);break;case 3:if(si(s,o),c&64&&(s=o.updateQueue,s!==null)){if(a=null,o.child!==null)switch(o.child.tag){case 27:case 5:a=o.child.stateNode;break;case 1:a=o.child.stateNode}try{Lb(s,a)}catch(x){qs(o,o.return,x)}}break;case 27:a===null&&c&4&&Qv(o);case 26:case 5:si(s,o),a===null&&c&4&&Kv(o),c&512&&Cc(o,o.return);break;case 12:si(s,o);break;case 31:si(s,o),c&4&&t0(s,o);break;case 13:si(s,o),c&4&&s0(s,o),c&64&&(s=o.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(o=Nj.bind(null,o),Gj(s,o))));break;case 22:if(c=o.memoizedState!==null||ei,!c){a=a!==null&&a.memoizedState!==null||In,m=ei;var f=In;ei=c,(In=a)&&!f?ni(s,o,(o.subtreeFlags&8772)!==0):si(s,o),ei=m,In=f}break;case 30:break;default:si(s,o)}}function Zv(s){var a=s.alternate;a!==null&&(s.alternate=null,Zv(a)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(a=s.stateNode,a!==null&&_n(a)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var an=null,Er=!1;function ti(s,a,o){for(o=o.child;o!==null;)e0(s,a,o),o=o.sibling}function e0(s,a,o){if(ge&&typeof ge.onCommitFiberUnmount=="function")try{ge.onCommitFiberUnmount(ee,o)}catch{}switch(o.tag){case 26:In||Ca(o,a),ti(s,a,o),o.memoizedState?o.memoizedState.count--:o.stateNode&&(o=o.stateNode,o.parentNode.removeChild(o));break;case 27:In||Ca(o,a);var c=an,m=Er;Bi(o.type)&&(an=o.stateNode,Er=!1),ti(s,a,o),Vc(o.stateNode),an=c,Er=m;break;case 5:In||Ca(o,a);case 6:if(c=an,m=Er,an=null,ti(s,a,o),an=c,Er=m,an!==null)if(Er)try{(an.nodeType===9?an.body:an.nodeName==="HTML"?an.ownerDocument.body:an).removeChild(o.stateNode)}catch(f){qs(o,a,f)}else try{an.removeChild(o.stateNode)}catch(f){qs(o,a,f)}break;case 18:an!==null&&(Er?(s=an,W0(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,o.stateNode),Il(s)):W0(an,o.stateNode));break;case 4:c=an,m=Er,an=o.stateNode.containerInfo,Er=!0,ti(s,a,o),an=c,Er=m;break;case 0:case 11:case 14:case 15:Ii(2,o,a),In||Ii(4,o,a),ti(s,a,o);break;case 1:In||(Ca(o,a),c=o.stateNode,typeof c.componentWillUnmount=="function"&&Gv(o,a,c)),ti(s,a,o);break;case 21:ti(s,a,o);break;case 22:In=(c=In)||o.memoizedState!==null,ti(s,a,o),In=c;break;default:ti(s,a,o)}}function t0(s,a){if(a.memoizedState===null&&(s=a.alternate,s!==null&&(s=s.memoizedState,s!==null))){s=s.dehydrated;try{Il(s)}catch(o){qs(a,a.return,o)}}}function s0(s,a){if(a.memoizedState===null&&(s=a.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{Il(s)}catch(o){qs(a,a.return,o)}}function vj(s){switch(s.tag){case 31:case 13:case 19:var a=s.stateNode;return a===null&&(a=s.stateNode=new Xv),a;case 22:return s=s.stateNode,a=s._retryCache,a===null&&(a=s._retryCache=new Xv),a;default:throw Error(i(435,s.tag))}}function Ed(s,a){var o=vj(s);a.forEach(function(c){if(!o.has(c)){o.add(c);var m=Sj.bind(null,s,c);c.then(m,m)}})}function Nr(s,a){var o=a.deletions;if(o!==null)for(var c=0;c<o.length;c++){var m=o[c],f=s,x=a,N=x;e:for(;N!==null;){switch(N.tag){case 27:if(Bi(N.type)){an=N.stateNode,Er=!1;break e}break;case 5:an=N.stateNode,Er=!1;break e;case 3:case 4:an=N.stateNode.containerInfo,Er=!0;break e}N=N.return}if(an===null)throw Error(i(160));e0(f,x,m),an=null,Er=!1,f=m.alternate,f!==null&&(f.return=null),m.return=null}if(a.subtreeFlags&13886)for(a=a.child;a!==null;)n0(a,s),a=a.sibling}var da=null;function n0(s,a){var o=s.alternate,c=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:Nr(a,s),Sr(s),c&4&&(Ii(3,s,s.return),Sc(3,s),Ii(5,s,s.return));break;case 1:Nr(a,s),Sr(s),c&512&&(In||o===null||Ca(o,o.return)),c&64&&ei&&(s=s.updateQueue,s!==null&&(c=s.callbacks,c!==null&&(o=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=o===null?c:o.concat(c))));break;case 26:var m=da;if(Nr(a,s),Sr(s),c&512&&(In||o===null||Ca(o,o.return)),c&4){var f=o!==null?o.memoizedState:null;if(c=s.memoizedState,o===null)if(c===null)if(s.stateNode===null){e:{c=s.type,o=s.memoizedProps,m=m.ownerDocument||m;t:switch(c){case"title":f=m.getElementsByTagName("title")[0],(!f||f[ln]||f[ct]||f.namespaceURI==="http://www.w3.org/2000/svg"||f.hasAttribute("itemprop"))&&(f=m.createElement(c),m.head.insertBefore(f,m.querySelector("head > title"))),Jn(f,c,o),f[ct]=s,S(f),c=f;break e;case"link":var x=n1("link","href",m).get(c+(o.href||""));if(x){for(var N=0;N<x.length;N++)if(f=x[N],f.getAttribute("href")===(o.href==null||o.href===""?null:o.href)&&f.getAttribute("rel")===(o.rel==null?null:o.rel)&&f.getAttribute("title")===(o.title==null?null:o.title)&&f.getAttribute("crossorigin")===(o.crossOrigin==null?null:o.crossOrigin)){x.splice(N,1);break t}}f=m.createElement(c),Jn(f,c,o),m.head.appendChild(f);break;case"meta":if(x=n1("meta","content",m).get(c+(o.content||""))){for(N=0;N<x.length;N++)if(f=x[N],f.getAttribute("content")===(o.content==null?null:""+o.content)&&f.getAttribute("name")===(o.name==null?null:o.name)&&f.getAttribute("property")===(o.property==null?null:o.property)&&f.getAttribute("http-equiv")===(o.httpEquiv==null?null:o.httpEquiv)&&f.getAttribute("charset")===(o.charSet==null?null:o.charSet)){x.splice(N,1);break t}}f=m.createElement(c),Jn(f,c,o),m.head.appendChild(f);break;default:throw Error(i(468,c))}f[ct]=s,S(f),c=f}s.stateNode=c}else r1(m,s.type,s.stateNode);else s.stateNode=s1(m,c,s.memoizedProps);else f!==c?(f===null?o.stateNode!==null&&(o=o.stateNode,o.parentNode.removeChild(o)):f.count--,c===null?r1(m,s.type,s.stateNode):s1(m,c,s.memoizedProps)):c===null&&s.stateNode!==null&&Cf(s,s.memoizedProps,o.memoizedProps)}break;case 27:Nr(a,s),Sr(s),c&512&&(In||o===null||Ca(o,o.return)),o!==null&&c&4&&Cf(s,s.memoizedProps,o.memoizedProps);break;case 5:if(Nr(a,s),Sr(s),c&512&&(In||o===null||Ca(o,o.return)),s.flags&32){m=s.stateNode;try{pn(m,"")}catch(mt){qs(s,s.return,mt)}}c&4&&s.stateNode!=null&&(m=s.memoizedProps,Cf(s,m,o!==null?o.memoizedProps:m)),c&1024&&(If=!0);break;case 6:if(Nr(a,s),Sr(s),c&4){if(s.stateNode===null)throw Error(i(162));c=s.memoizedProps,o=s.stateNode;try{o.nodeValue=c}catch(mt){qs(s,s.return,mt)}}break;case 3:if(zd=null,m=da,da=Ud(a.containerInfo),Nr(a,s),da=m,Sr(s),c&4&&o!==null&&o.memoizedState.isDehydrated)try{Il(a.containerInfo)}catch(mt){qs(s,s.return,mt)}If&&(If=!1,r0(s));break;case 4:c=da,da=Ud(s.stateNode.containerInfo),Nr(a,s),Sr(s),da=c;break;case 12:Nr(a,s),Sr(s);break;case 31:Nr(a,s),Sr(s),c&4&&(c=s.updateQueue,c!==null&&(s.updateQueue=null,Ed(s,c)));break;case 13:Nr(a,s),Sr(s),s.child.flags&8192&&s.memoizedState!==null!=(o!==null&&o.memoizedState!==null)&&(Sd=ss()),c&4&&(c=s.updateQueue,c!==null&&(s.updateQueue=null,Ed(s,c)));break;case 22:m=s.memoizedState!==null;var z=o!==null&&o.memoizedState!==null,ie=ei,ke=In;if(ei=ie||m,In=ke||z,Nr(a,s),In=ke,ei=ie,Sr(s),c&8192)e:for(a=s.stateNode,a._visibility=m?a._visibility&-2:a._visibility|1,m&&(o===null||z||ei||In||Io(s)),o=null,a=s;;){if(a.tag===5||a.tag===26){if(o===null){z=o=a;try{if(f=z.stateNode,m)x=f.style,typeof x.setProperty=="function"?x.setProperty("display","none","important"):x.display="none";else{N=z.stateNode;var Ie=z.memoizedProps.style,le=Ie!=null&&Ie.hasOwnProperty("display")?Ie.display:null;N.style.display=le==null||typeof le=="boolean"?"":(""+le).trim()}}catch(mt){qs(z,z.return,mt)}}}else if(a.tag===6){if(o===null){z=a;try{z.stateNode.nodeValue=m?"":z.memoizedProps}catch(mt){qs(z,z.return,mt)}}}else if(a.tag===18){if(o===null){z=a;try{var ye=z.stateNode;m?G0(ye,!0):G0(z.stateNode,!1)}catch(mt){qs(z,z.return,mt)}}}else if((a.tag!==22&&a.tag!==23||a.memoizedState===null||a===s)&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===s)break e;for(;a.sibling===null;){if(a.return===null||a.return===s)break e;o===a&&(o=null),a=a.return}o===a&&(o=null),a.sibling.return=a.return,a=a.sibling}c&4&&(c=s.updateQueue,c!==null&&(o=c.retryQueue,o!==null&&(c.retryQueue=null,Ed(s,o))));break;case 19:Nr(a,s),Sr(s),c&4&&(c=s.updateQueue,c!==null&&(s.updateQueue=null,Ed(s,c)));break;case 30:break;case 21:break;default:Nr(a,s),Sr(s)}}function Sr(s){var a=s.flags;if(a&2){try{for(var o,c=s.return;c!==null;){if(Yv(c)){o=c;break}c=c.return}if(o==null)throw Error(i(160));switch(o.tag){case 27:var m=o.stateNode,f=Rf(s);Td(s,f,m);break;case 5:var x=o.stateNode;o.flags&32&&(pn(x,""),o.flags&=-33);var N=Rf(s);Td(s,N,x);break;case 3:case 4:var z=o.stateNode.containerInfo,ie=Rf(s);Af(s,ie,z);break;default:throw Error(i(161))}}catch(ke){qs(s,s.return,ke)}s.flags&=-3}a&4096&&(s.flags&=-4097)}function r0(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var a=s;r0(a),a.tag===5&&a.flags&1024&&a.stateNode.reset(),s=s.sibling}}function si(s,a){if(a.subtreeFlags&8772)for(a=a.child;a!==null;)Jv(s,a.alternate,a),a=a.sibling}function Io(s){for(s=s.child;s!==null;){var a=s;switch(a.tag){case 0:case 11:case 14:case 15:Ii(4,a,a.return),Io(a);break;case 1:Ca(a,a.return);var o=a.stateNode;typeof o.componentWillUnmount=="function"&&Gv(a,a.return,o),Io(a);break;case 27:Vc(a.stateNode);case 26:case 5:Ca(a,a.return),Io(a);break;case 22:a.memoizedState===null&&Io(a);break;case 30:Io(a);break;default:Io(a)}s=s.sibling}}function ni(s,a,o){for(o=o&&(a.subtreeFlags&8772)!==0,a=a.child;a!==null;){var c=a.alternate,m=s,f=a,x=f.flags;switch(f.tag){case 0:case 11:case 15:ni(m,f,o),Sc(4,f);break;case 1:if(ni(m,f,o),c=f,m=c.stateNode,typeof m.componentDidMount=="function")try{m.componentDidMount()}catch(ie){qs(c,c.return,ie)}if(c=f,m=c.updateQueue,m!==null){var N=c.stateNode;try{var z=m.shared.hiddenCallbacks;if(z!==null)for(m.shared.hiddenCallbacks=null,m=0;m<z.length;m++)Pb(z[m],N)}catch(ie){qs(c,c.return,ie)}}o&&x&64&&Wv(f),Cc(f,f.return);break;case 27:Qv(f);case 26:case 5:ni(m,f,o),o&&c===null&&x&4&&Kv(f),Cc(f,f.return);break;case 12:ni(m,f,o);break;case 31:ni(m,f,o),o&&x&4&&t0(m,f);break;case 13:ni(m,f,o),o&&x&4&&s0(m,f);break;case 22:f.memoizedState===null&&ni(m,f,o),Cc(f,f.return);break;case 30:break;default:ni(m,f,o)}a=a.sibling}}function Mf(s,a){var o=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(o=s.memoizedState.cachePool.pool),s=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(s=a.memoizedState.cachePool.pool),s!==o&&(s!=null&&s.refCount++,o!=null&&pc(o))}function Df(s,a){s=null,a.alternate!==null&&(s=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==s&&(a.refCount++,s!=null&&pc(s))}function ha(s,a,o,c){if(a.subtreeFlags&10256)for(a=a.child;a!==null;)a0(s,a,o,c),a=a.sibling}function a0(s,a,o,c){var m=a.flags;switch(a.tag){case 0:case 11:case 15:ha(s,a,o,c),m&2048&&Sc(9,a);break;case 1:ha(s,a,o,c);break;case 3:ha(s,a,o,c),m&2048&&(s=null,a.alternate!==null&&(s=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==s&&(a.refCount++,s!=null&&pc(s)));break;case 12:if(m&2048){ha(s,a,o,c),s=a.stateNode;try{var f=a.memoizedProps,x=f.id,N=f.onPostCommit;typeof N=="function"&&N(x,a.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(z){qs(a,a.return,z)}}else ha(s,a,o,c);break;case 31:ha(s,a,o,c);break;case 13:ha(s,a,o,c);break;case 23:break;case 22:f=a.stateNode,x=a.alternate,a.memoizedState!==null?f._visibility&2?ha(s,a,o,c):Rc(s,a):f._visibility&2?ha(s,a,o,c):(f._visibility|=2,wl(s,a,o,c,(a.subtreeFlags&10256)!==0||!1)),m&2048&&Mf(x,a);break;case 24:ha(s,a,o,c),m&2048&&Df(a.alternate,a);break;default:ha(s,a,o,c)}}function wl(s,a,o,c,m){for(m=m&&((a.subtreeFlags&10256)!==0||!1),a=a.child;a!==null;){var f=s,x=a,N=o,z=c,ie=x.flags;switch(x.tag){case 0:case 11:case 15:wl(f,x,N,z,m),Sc(8,x);break;case 23:break;case 22:var ke=x.stateNode;x.memoizedState!==null?ke._visibility&2?wl(f,x,N,z,m):Rc(f,x):(ke._visibility|=2,wl(f,x,N,z,m)),m&&ie&2048&&Mf(x.alternate,x);break;case 24:wl(f,x,N,z,m),m&&ie&2048&&Df(x.alternate,x);break;default:wl(f,x,N,z,m)}a=a.sibling}}function Rc(s,a){if(a.subtreeFlags&10256)for(a=a.child;a!==null;){var o=s,c=a,m=c.flags;switch(c.tag){case 22:Rc(o,c),m&2048&&Mf(c.alternate,c);break;case 24:Rc(o,c),m&2048&&Df(c.alternate,c);break;default:Rc(o,c)}a=a.sibling}}var Ac=8192;function _l(s,a,o){if(s.subtreeFlags&Ac)for(s=s.child;s!==null;)i0(s,a,o),s=s.sibling}function i0(s,a,o){switch(s.tag){case 26:_l(s,a,o),s.flags&Ac&&s.memoizedState!==null&&aT(o,da,s.memoizedState,s.memoizedProps);break;case 5:_l(s,a,o);break;case 3:case 4:var c=da;da=Ud(s.stateNode.containerInfo),_l(s,a,o),da=c;break;case 22:s.memoizedState===null&&(c=s.alternate,c!==null&&c.memoizedState!==null?(c=Ac,Ac=16777216,_l(s,a,o),Ac=c):_l(s,a,o));break;default:_l(s,a,o)}}function o0(s){var a=s.alternate;if(a!==null&&(s=a.child,s!==null)){a.child=null;do a=s.sibling,s.sibling=null,s=a;while(s!==null)}}function Ic(s){var a=s.deletions;if((s.flags&16)!==0){if(a!==null)for(var o=0;o<a.length;o++){var c=a[o];qn=c,c0(c,s)}o0(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)l0(s),s=s.sibling}function l0(s){switch(s.tag){case 0:case 11:case 15:Ic(s),s.flags&2048&&Ii(9,s,s.return);break;case 3:Ic(s);break;case 12:Ic(s);break;case 22:var a=s.stateNode;s.memoizedState!==null&&a._visibility&2&&(s.return===null||s.return.tag!==13)?(a._visibility&=-3,Nd(s)):Ic(s);break;default:Ic(s)}}function Nd(s){var a=s.deletions;if((s.flags&16)!==0){if(a!==null)for(var o=0;o<a.length;o++){var c=a[o];qn=c,c0(c,s)}o0(s)}for(s=s.child;s!==null;){switch(a=s,a.tag){case 0:case 11:case 15:Ii(8,a,a.return),Nd(a);break;case 22:o=a.stateNode,o._visibility&2&&(o._visibility&=-3,Nd(a));break;default:Nd(a)}s=s.sibling}}function c0(s,a){for(;qn!==null;){var o=qn;switch(o.tag){case 0:case 11:case 15:Ii(8,o,a);break;case 23:case 22:if(o.memoizedState!==null&&o.memoizedState.cachePool!==null){var c=o.memoizedState.cachePool.pool;c!=null&&c.refCount++}break;case 24:pc(o.memoizedState.cache)}if(c=o.child,c!==null)c.return=o,qn=c;else e:for(o=s;qn!==null;){c=qn;var m=c.sibling,f=c.return;if(Zv(c),c===o){qn=null;break e}if(m!==null){m.return=f,qn=m;break e}qn=f}}}var xj={getCacheForType:function(s){var a=Qn(Cn),o=a.data.get(s);return o===void 0&&(o=s(),a.data.set(s,o)),o},cacheSignal:function(){return Qn(Cn).controller.signal}},wj=typeof WeakMap=="function"?WeakMap:Map,Bs=0,Qs=null,us=null,fs=0,zs=0,Ur=null,Mi=!1,kl=!1,Pf=!1,ri=0,bn=0,Di=0,Mo=0,Lf=0,Fr=0,jl=0,Mc=null,Cr=null,Of=!1,Sd=0,u0=0,Cd=1/0,Rd=null,Pi=null,Vn=0,Li=null,Tl=null,ai=0,Vf=0,Bf=null,d0=null,Dc=0,Uf=null;function zr(){return(Bs&2)!==0&&fs!==0?fs&-fs:$.T!==null?Wf():je()}function h0(){if(Fr===0)if((fs&536870912)===0||ks){var s=Q;Q<<=1,(Q&3932160)===0&&(Q=262144),Fr=s}else Fr=536870912;return s=Vr.current,s!==null&&(s.flags|=32),Fr}function Rr(s,a,o){(s===Qs&&(zs===2||zs===9)||s.cancelPendingCommit!==null)&&(El(s,0),Oi(s,fs,Fr,!1)),Ls(s,o),((Bs&2)===0||s!==Qs)&&(s===Qs&&((Bs&2)===0&&(Mo|=o),bn===4&&Oi(s,fs,Fr,!1)),Ra(s))}function m0(s,a,o){if((Bs&6)!==0)throw Error(i(327));var c=!o&&(a&127)===0&&(a&s.expiredLanes)===0||Tt(s,a),m=c?jj(s,a):zf(s,a,!0),f=c;do{if(m===0){kl&&!c&&Oi(s,a,0,!1);break}else{if(o=s.current.alternate,f&&!_j(o)){m=zf(s,a,!1),f=!1;continue}if(m===2){if(f=a,s.errorRecoveryDisabledLanes&f)var x=0;else x=s.pendingLanes&-536870913,x=x!==0?x:x&536870912?536870912:0;if(x!==0){a=x;e:{var N=s;m=Mc;var z=N.current.memoizedState.isDehydrated;if(z&&(El(N,x).flags|=256),x=zf(N,x,!1),x!==2){if(Pf&&!z){N.errorRecoveryDisabledLanes|=f,Mo|=f,m=4;break e}f=Cr,Cr=m,f!==null&&(Cr===null?Cr=f:Cr.push.apply(Cr,f))}m=x}if(f=!1,m!==2)continue}}if(m===1){El(s,0),Oi(s,a,0,!0);break}e:{switch(c=s,f=m,f){case 0:case 1:throw Error(i(345));case 4:if((a&4194048)!==a)break;case 6:Oi(c,a,Fr,!Mi);break e;case 2:Cr=null;break;case 3:case 5:break;default:throw Error(i(329))}if((a&62914560)===a&&(m=Sd+300-ss(),10<m)){if(Oi(c,a,Fr,!Mi),At(c,0,!0)!==0)break e;ai=a,c.timeoutHandle=H0(f0.bind(null,c,o,Cr,Rd,Of,a,Fr,Mo,jl,Mi,f,"Throttled",-0,0),m);break e}f0(c,o,Cr,Rd,Of,a,Fr,Mo,jl,Mi,f,null,-0,0)}}break}while(!0);Ra(s)}function f0(s,a,o,c,m,f,x,N,z,ie,ke,Ie,le,ye){if(s.timeoutHandle=-1,Ie=a.subtreeFlags,Ie&8192||(Ie&16785408)===16785408){Ie={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:tn},i0(a,f,Ie);var mt=(f&62914560)===f?Sd-ss():(f&4194048)===f?u0-ss():0;if(mt=iT(Ie,mt),mt!==null){ai=f,s.cancelPendingCommit=mt(_0.bind(null,s,a,f,o,c,m,x,N,z,ke,Ie,null,le,ye)),Oi(s,f,x,!ie);return}}_0(s,a,f,o,c,m,x,N,z)}function _j(s){for(var a=s;;){var o=a.tag;if((o===0||o===11||o===15)&&a.flags&16384&&(o=a.updateQueue,o!==null&&(o=o.stores,o!==null)))for(var c=0;c<o.length;c++){var m=o[c],f=m.getSnapshot;m=m.value;try{if(!Lr(f(),m))return!1}catch{return!1}}if(o=a.child,a.subtreeFlags&16384&&o!==null)o.return=a,a=o;else{if(a===s)break;for(;a.sibling===null;){if(a.return===null||a.return===s)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}}return!0}function Oi(s,a,o,c){a&=~Lf,a&=~Mo,s.suspendedLanes|=a,s.pingedLanes&=~a,c&&(s.warmLanes|=a),c=s.expirationTimes;for(var m=a;0<m;){var f=31-Oe(m),x=1<<f;c[f]=-1,m&=~x}o!==0&&os(s,o,a)}function Ad(){return(Bs&6)===0?(Pc(0),!1):!0}function Ff(){if(us!==null){if(zs===0)var s=us.return;else s=us,Ka=jo=null,sf(s),gl=null,yc=0,s=us;for(;s!==null;)$v(s.alternate,s),s=s.return;us=null}}function El(s,a){var o=s.timeoutHandle;o!==-1&&(s.timeoutHandle=-1,zj(o)),o=s.cancelPendingCommit,o!==null&&(s.cancelPendingCommit=null,o()),ai=0,Ff(),Qs=s,us=o=Wa(s.current,null),fs=a,zs=0,Ur=null,Mi=!1,kl=Tt(s,a),Pf=!1,jl=Fr=Lf=Mo=Di=bn=0,Cr=Mc=null,Of=!1,(a&8)!==0&&(a|=a&32);var c=s.entangledLanes;if(c!==0)for(s=s.entanglements,c&=a;0<c;){var m=31-Oe(c),f=1<<m;a|=s[m],c&=~f}return ri=a,Ju(),o}function p0(s,a){es=null,$.H=Tc,a===pl||a===id?(a=Ab(),zs=3):a===Hm?(a=Ab(),zs=4):zs=a===vf?8:a!==null&&typeof a=="object"&&typeof a.then=="function"?6:1,Ur=a,us===null&&(bn=1,xd(s,Qr(a,s.current)))}function g0(){var s=Vr.current;return s===null?!0:(fs&4194048)===fs?ea===null:(fs&62914560)===fs||(fs&536870912)!==0?s===ea:!1}function y0(){var s=$.H;return $.H=Tc,s===null?Tc:s}function b0(){var s=$.A;return $.A=xj,s}function Id(){bn=4,Mi||(fs&4194048)!==fs&&Vr.current!==null||(kl=!0),(Di&134217727)===0&&(Mo&134217727)===0||Qs===null||Oi(Qs,fs,Fr,!1)}function zf(s,a,o){var c=Bs;Bs|=2;var m=y0(),f=b0();(Qs!==s||fs!==a)&&(Rd=null,El(s,a)),a=!1;var x=bn;e:do try{if(zs!==0&&us!==null){var N=us,z=Ur;switch(zs){case 8:Ff(),x=6;break e;case 3:case 2:case 9:case 6:Vr.current===null&&(a=!0);var ie=zs;if(zs=0,Ur=null,Nl(s,N,z,ie),o&&kl){x=0;break e}break;default:ie=zs,zs=0,Ur=null,Nl(s,N,z,ie)}}kj(),x=bn;break}catch(ke){p0(s,ke)}while(!0);return a&&s.shellSuspendCounter++,Ka=jo=null,Bs=c,$.H=m,$.A=f,us===null&&(Qs=null,fs=0,Ju()),x}function kj(){for(;us!==null;)v0(us)}function jj(s,a){var o=Bs;Bs|=2;var c=y0(),m=b0();Qs!==s||fs!==a?(Rd=null,Cd=ss()+500,El(s,a)):kl=Tt(s,a);e:do try{if(zs!==0&&us!==null){a=us;var f=Ur;t:switch(zs){case 1:zs=0,Ur=null,Nl(s,a,f,1);break;case 2:case 9:if(Cb(f)){zs=0,Ur=null,x0(a);break}a=function(){zs!==2&&zs!==9||Qs!==s||(zs=7),Ra(s)},f.then(a,a);break e;case 3:zs=7;break e;case 4:zs=5;break e;case 7:Cb(f)?(zs=0,Ur=null,x0(a)):(zs=0,Ur=null,Nl(s,a,f,7));break;case 5:var x=null;switch(us.tag){case 26:x=us.memoizedState;case 5:case 27:var N=us;if(x?a1(x):N.stateNode.complete){zs=0,Ur=null;var z=N.sibling;if(z!==null)us=z;else{var ie=N.return;ie!==null?(us=ie,Md(ie)):us=null}break t}}zs=0,Ur=null,Nl(s,a,f,5);break;case 6:zs=0,Ur=null,Nl(s,a,f,6);break;case 8:Ff(),bn=6;break e;default:throw Error(i(462))}}Tj();break}catch(ke){p0(s,ke)}while(!0);return Ka=jo=null,$.H=c,$.A=m,Bs=o,us!==null?0:(Qs=null,fs=0,Ju(),bn)}function Tj(){for(;us!==null&&!Ks();)v0(us)}function v0(s){var a=qv(s.alternate,s,ri);s.memoizedProps=s.pendingProps,a===null?Md(s):us=a}function x0(s){var a=s,o=a.alternate;switch(a.tag){case 15:case 0:a=Ov(o,a,a.pendingProps,a.type,void 0,fs);break;case 11:a=Ov(o,a,a.pendingProps,a.type.render,a.ref,fs);break;case 5:sf(a);default:$v(o,a),a=us=bb(a,ri),a=qv(o,a,ri)}s.memoizedProps=s.pendingProps,a===null?Md(s):us=a}function Nl(s,a,o,c){Ka=jo=null,sf(a),gl=null,yc=0;var m=a.return;try{if(mj(s,m,a,o,fs)){bn=1,xd(s,Qr(o,s.current)),us=null;return}}catch(f){if(m!==null)throw us=m,f;bn=1,xd(s,Qr(o,s.current)),us=null;return}a.flags&32768?(ks||c===1?s=!0:kl||(fs&536870912)!==0?s=!1:(Mi=s=!0,(c===2||c===9||c===3||c===6)&&(c=Vr.current,c!==null&&c.tag===13&&(c.flags|=16384))),w0(a,s)):Md(a)}function Md(s){var a=s;do{if((a.flags&32768)!==0){w0(a,Mi);return}s=a.return;var o=gj(a.alternate,a,ri);if(o!==null){us=o;return}if(a=a.sibling,a!==null){us=a;return}us=a=s}while(a!==null);bn===0&&(bn=5)}function w0(s,a){do{var o=yj(s.alternate,s);if(o!==null){o.flags&=32767,us=o;return}if(o=s.return,o!==null&&(o.flags|=32768,o.subtreeFlags=0,o.deletions=null),!a&&(s=s.sibling,s!==null)){us=s;return}us=s=o}while(s!==null);bn=6,us=null}function _0(s,a,o,c,m,f,x,N,z){s.cancelPendingCommit=null;do Dd();while(Vn!==0);if((Bs&6)!==0)throw Error(i(327));if(a!==null){if(a===s.current)throw Error(i(177));if(f=a.lanes|a.childLanes,f|=Cm,Js(s,o,f,x,N,z),s===Qs&&(us=Qs=null,fs=0),Tl=a,Li=s,ai=o,Vf=f,Bf=m,d0=c,(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,Cj(Bt,function(){return N0(),null})):(s.callbackNode=null,s.callbackPriority=0),c=(a.flags&13878)!==0,(a.subtreeFlags&13878)!==0||c){c=$.T,$.T=null,m=me.p,me.p=2,x=Bs,Bs|=4;try{bj(s,a,o)}finally{Bs=x,me.p=m,$.T=c}}Vn=1,k0(),j0(),T0()}}function k0(){if(Vn===1){Vn=0;var s=Li,a=Tl,o=(a.flags&13878)!==0;if((a.subtreeFlags&13878)!==0||o){o=$.T,$.T=null;var c=me.p;me.p=2;var m=Bs;Bs|=4;try{n0(a,s);var f=ep,x=cb(s.containerInfo),N=f.focusedElem,z=f.selectionRange;if(x!==N&&N&&N.ownerDocument&&lb(N.ownerDocument.documentElement,N)){if(z!==null&&jm(N)){var ie=z.start,ke=z.end;if(ke===void 0&&(ke=ie),"selectionStart"in N)N.selectionStart=ie,N.selectionEnd=Math.min(ke,N.value.length);else{var Ie=N.ownerDocument||document,le=Ie&&Ie.defaultView||window;if(le.getSelection){var ye=le.getSelection(),mt=N.textContent.length,It=Math.min(z.start,mt),Ws=z.end===void 0?It:Math.min(z.end,mt);!ye.extend&&It>Ws&&(x=Ws,Ws=It,It=x);var X=ob(N,It),G=ob(N,Ws);if(X&&G&&(ye.rangeCount!==1||ye.anchorNode!==X.node||ye.anchorOffset!==X.offset||ye.focusNode!==G.node||ye.focusOffset!==G.offset)){var ae=Ie.createRange();ae.setStart(X.node,X.offset),ye.removeAllRanges(),It>Ws?(ye.addRange(ae),ye.extend(G.node,G.offset)):(ae.setEnd(G.node,G.offset),ye.addRange(ae))}}}}for(Ie=[],ye=N;ye=ye.parentNode;)ye.nodeType===1&&Ie.push({element:ye,left:ye.scrollLeft,top:ye.scrollTop});for(typeof N.focus=="function"&&N.focus(),N=0;N<Ie.length;N++){var Re=Ie[N];Re.element.scrollLeft=Re.left,Re.element.scrollTop=Re.top}}Wd=!!Zf,ep=Zf=null}finally{Bs=m,me.p=c,$.T=o}}s.current=a,Vn=2}}function j0(){if(Vn===2){Vn=0;var s=Li,a=Tl,o=(a.flags&8772)!==0;if((a.subtreeFlags&8772)!==0||o){o=$.T,$.T=null;var c=me.p;me.p=2;var m=Bs;Bs|=4;try{Jv(s,a.alternate,a)}finally{Bs=m,me.p=c,$.T=o}}Vn=3}}function T0(){if(Vn===4||Vn===3){Vn=0,Ps();var s=Li,a=Tl,o=ai,c=d0;(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?Vn=5:(Vn=0,Tl=Li=null,E0(s,s.pendingLanes));var m=s.pendingLanes;if(m===0&&(Pi=null),xe(o),a=a.stateNode,ge&&typeof ge.onCommitFiberRoot=="function")try{ge.onCommitFiberRoot(ee,a,void 0,(a.current.flags&128)===128)}catch{}if(c!==null){a=$.T,m=me.p,me.p=2,$.T=null;try{for(var f=s.onRecoverableError,x=0;x<c.length;x++){var N=c[x];f(N.value,{componentStack:N.stack})}}finally{$.T=a,me.p=m}}(ai&3)!==0&&Dd(),Ra(s),m=s.pendingLanes,(o&261930)!==0&&(m&42)!==0?s===Uf?Dc++:(Dc=0,Uf=s):Dc=0,Pc(0)}}function E0(s,a){(s.pooledCacheLanes&=a)===0&&(a=s.pooledCache,a!=null&&(s.pooledCache=null,pc(a)))}function Dd(){return k0(),j0(),T0(),N0()}function N0(){if(Vn!==5)return!1;var s=Li,a=Vf;Vf=0;var o=xe(ai),c=$.T,m=me.p;try{me.p=32>o?32:o,$.T=null,o=Bf,Bf=null;var f=Li,x=ai;if(Vn=0,Tl=Li=null,ai=0,(Bs&6)!==0)throw Error(i(331));var N=Bs;if(Bs|=4,l0(f.current),a0(f,f.current,x,o),Bs=N,Pc(0,!1),ge&&typeof ge.onPostCommitFiberRoot=="function")try{ge.onPostCommitFiberRoot(ee,f)}catch{}return!0}finally{me.p=m,$.T=c,E0(s,a)}}function S0(s,a,o){a=Qr(o,a),a=bf(s.stateNode,a,2),s=Ci(s,a,2),s!==null&&(Ls(s,2),Ra(s))}function qs(s,a,o){if(s.tag===3)S0(s,s,o);else for(;a!==null;){if(a.tag===3){S0(a,s,o);break}else if(a.tag===1){var c=a.stateNode;if(typeof a.type.getDerivedStateFromError=="function"||typeof c.componentDidCatch=="function"&&(Pi===null||!Pi.has(c))){s=Qr(o,s),o=Cv(2),c=Ci(a,o,2),c!==null&&(Rv(o,c,a,s),Ls(c,2),Ra(c));break}}a=a.return}}function qf(s,a,o){var c=s.pingCache;if(c===null){c=s.pingCache=new wj;var m=new Set;c.set(a,m)}else m=c.get(a),m===void 0&&(m=new Set,c.set(a,m));m.has(o)||(Pf=!0,m.add(o),s=Ej.bind(null,s,a,o),a.then(s,s))}function Ej(s,a,o){var c=s.pingCache;c!==null&&c.delete(a),s.pingedLanes|=s.suspendedLanes&o,s.warmLanes&=~o,Qs===s&&(fs&o)===o&&(bn===4||bn===3&&(fs&62914560)===fs&&300>ss()-Sd?(Bs&2)===0&&El(s,0):Lf|=o,jl===fs&&(jl=0)),Ra(s)}function C0(s,a){a===0&&(a=Ut()),s=wo(s,a),s!==null&&(Ls(s,a),Ra(s))}function Nj(s){var a=s.memoizedState,o=0;a!==null&&(o=a.retryLane),C0(s,o)}function Sj(s,a){var o=0;switch(s.tag){case 31:case 13:var c=s.stateNode,m=s.memoizedState;m!==null&&(o=m.retryLane);break;case 19:c=s.stateNode;break;case 22:c=s.stateNode._retryCache;break;default:throw Error(i(314))}c!==null&&c.delete(a),C0(s,o)}function Cj(s,a){return st(s,a)}var Pd=null,Sl=null,Hf=!1,Ld=!1,$f=!1,Vi=0;function Ra(s){s!==Sl&&s.next===null&&(Sl===null?Pd=Sl=s:Sl=Sl.next=s),Ld=!0,Hf||(Hf=!0,Aj())}function Pc(s,a){if(!$f&&Ld){$f=!0;do for(var o=!1,c=Pd;c!==null;){if(s!==0){var m=c.pendingLanes;if(m===0)var f=0;else{var x=c.suspendedLanes,N=c.pingedLanes;f=(1<<31-Oe(42|s)+1)-1,f&=m&~(x&~N),f=f&201326741?f&201326741|1:f?f|2:0}f!==0&&(o=!0,M0(c,f))}else f=fs,f=At(c,c===Qs?f:0,c.cancelPendingCommit!==null||c.timeoutHandle!==-1),(f&3)===0||Tt(c,f)||(o=!0,M0(c,f));c=c.next}while(o);$f=!1}}function Rj(){R0()}function R0(){Ld=Hf=!1;var s=0;Vi!==0&&Fj()&&(s=Vi);for(var a=ss(),o=null,c=Pd;c!==null;){var m=c.next,f=A0(c,a);f===0?(c.next=null,o===null?Pd=m:o.next=m,m===null&&(Sl=o)):(o=c,(s!==0||(f&3)!==0)&&(Ld=!0)),c=m}Vn!==0&&Vn!==5||Pc(s),Vi!==0&&(Vi=0)}function A0(s,a){for(var o=s.suspendedLanes,c=s.pingedLanes,m=s.expirationTimes,f=s.pendingLanes&-62914561;0<f;){var x=31-Oe(f),N=1<<x,z=m[x];z===-1?((N&o)===0||(N&c)!==0)&&(m[x]=ns(N,a)):z<=a&&(s.expiredLanes|=N),f&=~N}if(a=Qs,o=fs,o=At(s,s===a?o:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),c=s.callbackNode,o===0||s===a&&(zs===2||zs===9)||s.cancelPendingCommit!==null)return c!==null&&c!==null&&Kt(c),s.callbackNode=null,s.callbackPriority=0;if((o&3)===0||Tt(s,o)){if(a=o&-o,a===s.callbackPriority)return a;switch(c!==null&&Kt(c),xe(o)){case 2:case 8:o=vs;break;case 32:o=Bt;break;case 268435456:o=ue;break;default:o=Bt}return c=I0.bind(null,s),o=st(o,c),s.callbackPriority=a,s.callbackNode=o,a}return c!==null&&c!==null&&Kt(c),s.callbackPriority=2,s.callbackNode=null,2}function I0(s,a){if(Vn!==0&&Vn!==5)return s.callbackNode=null,s.callbackPriority=0,null;var o=s.callbackNode;if(Dd()&&s.callbackNode!==o)return null;var c=fs;return c=At(s,s===Qs?c:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),c===0?null:(m0(s,c,a),A0(s,ss()),s.callbackNode!=null&&s.callbackNode===o?I0.bind(null,s):null)}function M0(s,a){if(Dd())return null;m0(s,a,!0)}function Aj(){qj(function(){(Bs&6)!==0?st(Jt,Rj):R0()})}function Wf(){if(Vi===0){var s=ml;s===0&&(s=jt,jt<<=1,(jt&261888)===0&&(jt=256)),Vi=s}return Vi}function D0(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:_r(""+s)}function P0(s,a){var o=a.ownerDocument.createElement("input");return o.name=a.name,o.value=a.value,s.id&&o.setAttribute("form",s.id),a.parentNode.insertBefore(o,a),s=new FormData(s),o.parentNode.removeChild(o),s}function Ij(s,a,o,c,m){if(a==="submit"&&o&&o.stateNode===m){var f=D0((m[ht]||null).action),x=c.submitter;x&&(a=(a=x[ht]||null)?D0(a.formAction):x.getAttribute("formAction"),a!==null&&(f=a,x=null));var N=new Fn("action","action",null,c,m);s.push({event:N,listeners:[{instance:null,listener:function(){if(c.defaultPrevented){if(Vi!==0){var z=x?P0(m,x):new FormData(m);hf(o,{pending:!0,data:z,method:m.method,action:f},null,z)}}else typeof f=="function"&&(N.preventDefault(),z=x?P0(m,x):new FormData(m),hf(o,{pending:!0,data:z,method:m.method,action:f},f,z))},currentTarget:m}]})}}for(var Gf=0;Gf<Sm.length;Gf++){var Kf=Sm[Gf],Mj=Kf.toLowerCase(),Dj=Kf[0].toUpperCase()+Kf.slice(1);ua(Mj,"on"+Dj)}ua(hb,"onAnimationEnd"),ua(mb,"onAnimationIteration"),ua(fb,"onAnimationStart"),ua("dblclick","onDoubleClick"),ua("focusin","onFocus"),ua("focusout","onBlur"),ua(Qk,"onTransitionRun"),ua(Xk,"onTransitionStart"),ua(Jk,"onTransitionCancel"),ua(pb,"onTransitionEnd"),Be("onMouseEnter",["mouseout","mouseover"]),Be("onMouseLeave",["mouseout","mouseover"]),Be("onPointerEnter",["pointerout","pointerover"]),Be("onPointerLeave",["pointerout","pointerover"]),de("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),de("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),de("onBeforeInput",["compositionend","keypress","textInput","paste"]),de("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),de("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),de("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Lc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Pj=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Lc));function L0(s,a){a=(a&4)!==0;for(var o=0;o<s.length;o++){var c=s[o],m=c.event;c=c.listeners;e:{var f=void 0;if(a)for(var x=c.length-1;0<=x;x--){var N=c[x],z=N.instance,ie=N.currentTarget;if(N=N.listener,z!==f&&m.isPropagationStopped())break e;f=N,m.currentTarget=ie;try{f(m)}catch(ke){Xu(ke)}m.currentTarget=null,f=z}else for(x=0;x<c.length;x++){if(N=c[x],z=N.instance,ie=N.currentTarget,N=N.listener,z!==f&&m.isPropagationStopped())break e;f=N,m.currentTarget=ie;try{f(m)}catch(ke){Xu(ke)}m.currentTarget=null,f=z}}}}function ds(s,a){var o=a[vt];o===void 0&&(o=a[vt]=new Set);var c=s+"__bubble";o.has(c)||(O0(a,s,2,!1),o.add(c))}function Yf(s,a,o){var c=0;a&&(c|=4),O0(o,s,c,a)}var Od="_reactListening"+Math.random().toString(36).slice(2);function Qf(s){if(!s[Od]){s[Od]=!0,P.forEach(function(o){o!=="selectionchange"&&(Pj.has(o)||Yf(o,!1,s),Yf(o,!0,s))});var a=s.nodeType===9?s:s.ownerDocument;a===null||a[Od]||(a[Od]=!0,Yf("selectionchange",!1,a))}}function O0(s,a,o,c){switch(h1(a)){case 2:var m=cT;break;case 8:m=uT;break;default:m=dp}o=m.bind(null,a,o,s),m=void 0,!Z||a!=="touchstart"&&a!=="touchmove"&&a!=="wheel"||(m=!0),c?m!==void 0?s.addEventListener(a,o,{capture:!0,passive:m}):s.addEventListener(a,o,!0):m!==void 0?s.addEventListener(a,o,{passive:m}):s.addEventListener(a,o,!1)}function Xf(s,a,o,c,m){var f=c;if((a&1)===0&&(a&2)===0&&c!==null)e:for(;;){if(c===null)return;var x=c.tag;if(x===3||x===4){var N=c.stateNode.containerInfo;if(N===m)break;if(x===4)for(x=c.return;x!==null;){var z=x.tag;if((z===3||z===4)&&x.stateNode.containerInfo===m)return;x=x.return}for(;N!==null;){if(x=kn(N),x===null)return;if(z=x.tag,z===5||z===6||z===26||z===27){c=f=x;continue e}N=N.parentNode}}c=c.return}Ta(function(){var ie=f,ke=Sn(o),Ie=[];e:{var le=gb.get(s);if(le!==void 0){var ye=Fn,mt=s;switch(s){case"keypress":if(Vt(o)===0)break e;case"keydown":case"keyup":ye=Ku;break;case"focusin":mt="focus",ye=gn;break;case"focusout":mt="blur",ye=gn;break;case"beforeblur":case"afterblur":ye=gn;break;case"click":if(o.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ye=nr;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ye=dr;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ye=b;break;case hb:case mb:case fb:ye=Tr;break;case pb:ye=C;break;case"scroll":case"scrollend":ye=Zs;break;case"wheel":ye=he;break;case"copy":case"cut":case"paste":ye=tl;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ye=$a;break;case"toggle":case"beforetoggle":ye=Zt}var It=(a&4)!==0,Ws=!It&&(s==="scroll"||s==="scrollend"),X=It?le!==null?le+"Capture":null:le;It=[];for(var G=ie,ae;G!==null;){var Re=G;if(ae=Re.stateNode,Re=Re.tag,Re!==5&&Re!==26&&Re!==27||ae===null||X===null||(Re=Pr(G,X),Re!=null&&It.push(Oc(G,Re,ae))),Ws)break;G=G.return}0<It.length&&(le=new ye(le,mt,null,o,ke),Ie.push({event:le,listeners:It}))}}if((a&7)===0){e:{if(le=s==="mouseover"||s==="pointerover",ye=s==="mouseout"||s==="pointerout",le&&o!==Ln&&(mt=o.relatedTarget||o.fromElement)&&(kn(mt)||mt[et]))break e;if((ye||le)&&(le=ke.window===ke?ke:(le=ke.ownerDocument)?le.defaultView||le.parentWindow:window,ye?(mt=o.relatedTarget||o.toElement,ye=ie,mt=mt?kn(mt):null,mt!==null&&(Ws=u(mt),It=mt.tag,mt!==Ws||It!==5&&It!==27&&It!==6)&&(mt=null)):(ye=null,mt=ie),ye!==mt)){if(It=nr,Re="onMouseLeave",X="onMouseEnter",G="mouse",(s==="pointerout"||s==="pointerover")&&(It=$a,Re="onPointerLeave",X="onPointerEnter",G="pointer"),Ws=ye==null?le:Fs(ye),ae=mt==null?le:Fs(mt),le=new It(Re,G+"leave",ye,o,ke),le.target=Ws,le.relatedTarget=ae,Re=null,kn(ke)===ie&&(It=new It(X,G+"enter",mt,o,ke),It.target=ae,It.relatedTarget=Ws,Re=It),Ws=Re,ye&&mt)t:{for(It=Lj,X=ye,G=mt,ae=0,Re=X;Re;Re=It(Re))ae++;Re=0;for(var Et=G;Et;Et=It(Et))Re++;for(;0<ae-Re;)X=It(X),ae--;for(;0<Re-ae;)G=It(G),Re--;for(;ae--;){if(X===G||G!==null&&X===G.alternate){It=X;break t}X=It(X),G=It(G)}It=null}else It=null;ye!==null&&V0(Ie,le,ye,It,!1),mt!==null&&Ws!==null&&V0(Ie,Ws,mt,It,!0)}}e:{if(le=ie?Fs(ie):window,ye=le.nodeName&&le.nodeName.toLowerCase(),ye==="select"||ye==="input"&&le.type==="file")var Is=tb;else if(Zy(le))if(sb)Is=Gk;else{Is=$k;var yt=Hk}else ye=le.nodeName,!ye||ye.toLowerCase()!=="input"||le.type!=="checkbox"&&le.type!=="radio"?ie&&un(ie.elementType)&&(Is=tb):Is=Wk;if(Is&&(Is=Is(s,ie))){eb(Ie,Is,o,ke);break e}yt&&yt(s,le,ie),s==="focusout"&&ie&&le.type==="number"&&ie.memoizedProps.value!=null&&cn(le,"number",le.value)}switch(yt=ie?Fs(ie):window,s){case"focusin":(Zy(yt)||yt.contentEditable==="true")&&(al=yt,Tm=ie,hc=null);break;case"focusout":hc=Tm=al=null;break;case"mousedown":Em=!0;break;case"contextmenu":case"mouseup":case"dragend":Em=!1,ub(Ie,o,ke);break;case"selectionchange":if(Yk)break;case"keydown":case"keyup":ub(Ie,o,ke)}var rs;if(Vs)e:{switch(s){case"compositionstart":var ps="onCompositionStart";break e;case"compositionend":ps="onCompositionEnd";break e;case"compositionupdate":ps="onCompositionUpdate";break e}ps=void 0}else rl?bo(s,o)&&(ps="onCompositionEnd"):s==="keydown"&&o.keyCode===229&&(ps="onCompositionStart");ps&&(Ea&&o.locale!=="ko"&&(rl||ps!=="onCompositionStart"?ps==="onCompositionEnd"&&rl&&(rs=ot()):(Ze=ke,_t="value"in Ze?Ze.value:Ze.textContent,rl=!0)),yt=Vd(ie,ps),0<yt.length&&(ps=new mr(ps,s,null,o,ke),Ie.push({event:ps,listeners:yt}),rs?ps.data=rs:(rs=nl(o),rs!==null&&(ps.data=rs)))),(rs=Kr?Uk(s,o):Fk(s,o))&&(ps=Vd(ie,"onBeforeInput"),0<ps.length&&(yt=new mr("onBeforeInput","beforeinput",null,o,ke),Ie.push({event:yt,listeners:ps}),yt.data=rs)),Ij(Ie,s,ie,o,ke)}L0(Ie,a)})}function Oc(s,a,o){return{instance:s,listener:a,currentTarget:o}}function Vd(s,a){for(var o=a+"Capture",c=[];s!==null;){var m=s,f=m.stateNode;if(m=m.tag,m!==5&&m!==26&&m!==27||f===null||(m=Pr(s,o),m!=null&&c.unshift(Oc(s,m,f)),m=Pr(s,a),m!=null&&c.push(Oc(s,m,f))),s.tag===3)return c;s=s.return}return[]}function Lj(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function V0(s,a,o,c,m){for(var f=a._reactName,x=[];o!==null&&o!==c;){var N=o,z=N.alternate,ie=N.stateNode;if(N=N.tag,z!==null&&z===c)break;N!==5&&N!==26&&N!==27||ie===null||(z=ie,m?(ie=Pr(o,f),ie!=null&&x.unshift(Oc(o,ie,z))):m||(ie=Pr(o,f),ie!=null&&x.push(Oc(o,ie,z)))),o=o.return}x.length!==0&&s.push({event:a,listeners:x})}var Oj=/\r\n?/g,Vj=/\u0000|\uFFFD/g;function B0(s){return(typeof s=="string"?s:""+s).replace(Oj,`
`).replace(Vj,"")}function U0(s,a){return a=B0(a),B0(s)===a}function $s(s,a,o,c,m,f){switch(o){case"children":typeof c=="string"?a==="body"||a==="textarea"&&c===""||pn(s,c):(typeof c=="number"||typeof c=="bigint")&&a!=="body"&&pn(s,""+c);break;case"className":ls(s,"class",c);break;case"tabIndex":ls(s,"tabindex",c);break;case"dir":case"role":case"viewBox":case"width":case"height":ls(s,o,c);break;case"style":is(s,c,f);break;case"data":if(a!=="object"){ls(s,"data",c);break}case"src":case"href":if(c===""&&(a!=="a"||o!=="href")){s.removeAttribute(o);break}if(c==null||typeof c=="function"||typeof c=="symbol"||typeof c=="boolean"){s.removeAttribute(o);break}c=_r(""+c),s.setAttribute(o,c);break;case"action":case"formAction":if(typeof c=="function"){s.setAttribute(o,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof f=="function"&&(o==="formAction"?(a!=="input"&&$s(s,a,"name",m.name,m,null),$s(s,a,"formEncType",m.formEncType,m,null),$s(s,a,"formMethod",m.formMethod,m,null),$s(s,a,"formTarget",m.formTarget,m,null)):($s(s,a,"encType",m.encType,m,null),$s(s,a,"method",m.method,m,null),$s(s,a,"target",m.target,m,null)));if(c==null||typeof c=="symbol"||typeof c=="boolean"){s.removeAttribute(o);break}c=_r(""+c),s.setAttribute(o,c);break;case"onClick":c!=null&&(s.onclick=tn);break;case"onScroll":c!=null&&ds("scroll",s);break;case"onScrollEnd":c!=null&&ds("scrollend",s);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(i(61));if(o=c.__html,o!=null){if(m.children!=null)throw Error(i(60));s.innerHTML=o}}break;case"multiple":s.multiple=c&&typeof c!="function"&&typeof c!="symbol";break;case"muted":s.muted=c&&typeof c!="function"&&typeof c!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(c==null||typeof c=="function"||typeof c=="boolean"||typeof c=="symbol"){s.removeAttribute("xlink:href");break}o=_r(""+c),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",o);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":c!=null&&typeof c!="function"&&typeof c!="symbol"?s.setAttribute(o,""+c):s.removeAttribute(o);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":c&&typeof c!="function"&&typeof c!="symbol"?s.setAttribute(o,""):s.removeAttribute(o);break;case"capture":case"download":c===!0?s.setAttribute(o,""):c!==!1&&c!=null&&typeof c!="function"&&typeof c!="symbol"?s.setAttribute(o,c):s.removeAttribute(o);break;case"cols":case"rows":case"size":case"span":c!=null&&typeof c!="function"&&typeof c!="symbol"&&!isNaN(c)&&1<=c?s.setAttribute(o,c):s.removeAttribute(o);break;case"rowSpan":case"start":c==null||typeof c=="function"||typeof c=="symbol"||isNaN(c)?s.removeAttribute(o):s.setAttribute(o,c);break;case"popover":ds("beforetoggle",s),ds("toggle",s),xs(s,"popover",c);break;case"xlinkActuate":cs(s,"http://www.w3.org/1999/xlink","xlink:actuate",c);break;case"xlinkArcrole":cs(s,"http://www.w3.org/1999/xlink","xlink:arcrole",c);break;case"xlinkRole":cs(s,"http://www.w3.org/1999/xlink","xlink:role",c);break;case"xlinkShow":cs(s,"http://www.w3.org/1999/xlink","xlink:show",c);break;case"xlinkTitle":cs(s,"http://www.w3.org/1999/xlink","xlink:title",c);break;case"xlinkType":cs(s,"http://www.w3.org/1999/xlink","xlink:type",c);break;case"xmlBase":cs(s,"http://www.w3.org/XML/1998/namespace","xml:base",c);break;case"xmlLang":cs(s,"http://www.w3.org/XML/1998/namespace","xml:lang",c);break;case"xmlSpace":cs(s,"http://www.w3.org/XML/1998/namespace","xml:space",c);break;case"is":xs(s,"is",c);break;case"innerText":case"textContent":break;default:(!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(o=sr.get(o)||o,xs(s,o,c))}}function Jf(s,a,o,c,m,f){switch(o){case"style":is(s,c,f);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(i(61));if(o=c.__html,o!=null){if(m.children!=null)throw Error(i(60));s.innerHTML=o}}break;case"children":typeof c=="string"?pn(s,c):(typeof c=="number"||typeof c=="bigint")&&pn(s,""+c);break;case"onScroll":c!=null&&ds("scroll",s);break;case"onScrollEnd":c!=null&&ds("scrollend",s);break;case"onClick":c!=null&&(s.onclick=tn);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!B.hasOwnProperty(o))e:{if(o[0]==="o"&&o[1]==="n"&&(m=o.endsWith("Capture"),a=o.slice(2,m?o.length-7:void 0),f=s[ht]||null,f=f!=null?f[o]:null,typeof f=="function"&&s.removeEventListener(a,f,m),typeof c=="function")){typeof f!="function"&&f!==null&&(o in s?s[o]=null:s.hasAttribute(o)&&s.removeAttribute(o)),s.addEventListener(a,c,m);break e}o in s?s[o]=c:c===!0?s.setAttribute(o,""):xs(s,o,c)}}}function Jn(s,a,o){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":ds("error",s),ds("load",s);var c=!1,m=!1,f;for(f in o)if(o.hasOwnProperty(f)){var x=o[f];if(x!=null)switch(f){case"src":c=!0;break;case"srcSet":m=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,a));default:$s(s,a,f,x,o,null)}}m&&$s(s,a,"srcSet",o.srcSet,o,null),c&&$s(s,a,"src",o.src,o,null);return;case"input":ds("invalid",s);var N=f=x=m=null,z=null,ie=null;for(c in o)if(o.hasOwnProperty(c)){var ke=o[c];if(ke!=null)switch(c){case"name":m=ke;break;case"type":x=ke;break;case"checked":z=ke;break;case"defaultChecked":ie=ke;break;case"value":f=ke;break;case"defaultValue":N=ke;break;case"children":case"dangerouslySetInnerHTML":if(ke!=null)throw Error(i(137,a));break;default:$s(s,a,c,ke,o,null)}}ws(s,f,N,z,ie,x,m,!1);return;case"select":ds("invalid",s),c=x=f=null;for(m in o)if(o.hasOwnProperty(m)&&(N=o[m],N!=null))switch(m){case"value":f=N;break;case"defaultValue":x=N;break;case"multiple":c=N;default:$s(s,a,m,N,o,null)}a=f,o=x,s.multiple=!!c,a!=null?ms(s,!!c,a,!1):o!=null&&ms(s,!!c,o,!0);return;case"textarea":ds("invalid",s),f=m=c=null;for(x in o)if(o.hasOwnProperty(x)&&(N=o[x],N!=null))switch(x){case"value":c=N;break;case"defaultValue":m=N;break;case"children":f=N;break;case"dangerouslySetInnerHTML":if(N!=null)throw Error(i(91));break;default:$s(s,a,x,N,o,null)}Gr(s,c,m,f);return;case"option":for(z in o)o.hasOwnProperty(z)&&(c=o[z],c!=null)&&(z==="selected"?s.selected=c&&typeof c!="function"&&typeof c!="symbol":$s(s,a,z,c,o,null));return;case"dialog":ds("beforetoggle",s),ds("toggle",s),ds("cancel",s),ds("close",s);break;case"iframe":case"object":ds("load",s);break;case"video":case"audio":for(c=0;c<Lc.length;c++)ds(Lc[c],s);break;case"image":ds("error",s),ds("load",s);break;case"details":ds("toggle",s);break;case"embed":case"source":case"link":ds("error",s),ds("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ie in o)if(o.hasOwnProperty(ie)&&(c=o[ie],c!=null))switch(ie){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,a));default:$s(s,a,ie,c,o,null)}return;default:if(un(a)){for(ke in o)o.hasOwnProperty(ke)&&(c=o[ke],c!==void 0&&Jf(s,a,ke,c,o,void 0));return}}for(N in o)o.hasOwnProperty(N)&&(c=o[N],c!=null&&$s(s,a,N,c,o,null))}function Bj(s,a,o,c){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var m=null,f=null,x=null,N=null,z=null,ie=null,ke=null;for(ye in o){var Ie=o[ye];if(o.hasOwnProperty(ye)&&Ie!=null)switch(ye){case"checked":break;case"value":break;case"defaultValue":z=Ie;default:c.hasOwnProperty(ye)||$s(s,a,ye,null,c,Ie)}}for(var le in c){var ye=c[le];if(Ie=o[le],c.hasOwnProperty(le)&&(ye!=null||Ie!=null))switch(le){case"type":f=ye;break;case"name":m=ye;break;case"checked":ie=ye;break;case"defaultChecked":ke=ye;break;case"value":x=ye;break;case"defaultValue":N=ye;break;case"children":case"dangerouslySetInnerHTML":if(ye!=null)throw Error(i(137,a));break;default:ye!==Ie&&$s(s,a,le,ye,c,Ie)}}Mt(s,x,N,z,ie,ke,f,m);return;case"select":ye=x=N=le=null;for(f in o)if(z=o[f],o.hasOwnProperty(f)&&z!=null)switch(f){case"value":break;case"multiple":ye=z;default:c.hasOwnProperty(f)||$s(s,a,f,null,c,z)}for(m in c)if(f=c[m],z=o[m],c.hasOwnProperty(m)&&(f!=null||z!=null))switch(m){case"value":le=f;break;case"defaultValue":N=f;break;case"multiple":x=f;default:f!==z&&$s(s,a,m,f,c,z)}a=N,o=x,c=ye,le!=null?ms(s,!!o,le,!1):!!c!=!!o&&(a!=null?ms(s,!!o,a,!0):ms(s,!!o,o?[]:"",!1));return;case"textarea":ye=le=null;for(N in o)if(m=o[N],o.hasOwnProperty(N)&&m!=null&&!c.hasOwnProperty(N))switch(N){case"value":break;case"children":break;default:$s(s,a,N,null,c,m)}for(x in c)if(m=c[x],f=o[x],c.hasOwnProperty(x)&&(m!=null||f!=null))switch(x){case"value":le=m;break;case"defaultValue":ye=m;break;case"children":break;case"dangerouslySetInnerHTML":if(m!=null)throw Error(i(91));break;default:m!==f&&$s(s,a,x,m,c,f)}Wn(s,le,ye);return;case"option":for(var mt in o)le=o[mt],o.hasOwnProperty(mt)&&le!=null&&!c.hasOwnProperty(mt)&&(mt==="selected"?s.selected=!1:$s(s,a,mt,null,c,le));for(z in c)le=c[z],ye=o[z],c.hasOwnProperty(z)&&le!==ye&&(le!=null||ye!=null)&&(z==="selected"?s.selected=le&&typeof le!="function"&&typeof le!="symbol":$s(s,a,z,le,c,ye));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var It in o)le=o[It],o.hasOwnProperty(It)&&le!=null&&!c.hasOwnProperty(It)&&$s(s,a,It,null,c,le);for(ie in c)if(le=c[ie],ye=o[ie],c.hasOwnProperty(ie)&&le!==ye&&(le!=null||ye!=null))switch(ie){case"children":case"dangerouslySetInnerHTML":if(le!=null)throw Error(i(137,a));break;default:$s(s,a,ie,le,c,ye)}return;default:if(un(a)){for(var Ws in o)le=o[Ws],o.hasOwnProperty(Ws)&&le!==void 0&&!c.hasOwnProperty(Ws)&&Jf(s,a,Ws,void 0,c,le);for(ke in c)le=c[ke],ye=o[ke],!c.hasOwnProperty(ke)||le===ye||le===void 0&&ye===void 0||Jf(s,a,ke,le,c,ye);return}}for(var X in o)le=o[X],o.hasOwnProperty(X)&&le!=null&&!c.hasOwnProperty(X)&&$s(s,a,X,null,c,le);for(Ie in c)le=c[Ie],ye=o[Ie],!c.hasOwnProperty(Ie)||le===ye||le==null&&ye==null||$s(s,a,Ie,le,c,ye)}function F0(s){switch(s){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function Uj(){if(typeof performance.getEntriesByType=="function"){for(var s=0,a=0,o=performance.getEntriesByType("resource"),c=0;c<o.length;c++){var m=o[c],f=m.transferSize,x=m.initiatorType,N=m.duration;if(f&&N&&F0(x)){for(x=0,N=m.responseEnd,c+=1;c<o.length;c++){var z=o[c],ie=z.startTime;if(ie>N)break;var ke=z.transferSize,Ie=z.initiatorType;ke&&F0(Ie)&&(z=z.responseEnd,x+=ke*(z<N?1:(N-ie)/(z-ie)))}if(--c,a+=8*(f+x)/(m.duration/1e3),s++,10<s)break}}if(0<s)return a/s/1e6}return navigator.connection&&(s=navigator.connection.downlink,typeof s=="number")?s:5}var Zf=null,ep=null;function Bd(s){return s.nodeType===9?s:s.ownerDocument}function z0(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function q0(s,a){if(s===0)switch(a){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&a==="foreignObject"?0:s}function tp(s,a){return s==="textarea"||s==="noscript"||typeof a.children=="string"||typeof a.children=="number"||typeof a.children=="bigint"||typeof a.dangerouslySetInnerHTML=="object"&&a.dangerouslySetInnerHTML!==null&&a.dangerouslySetInnerHTML.__html!=null}var sp=null;function Fj(){var s=window.event;return s&&s.type==="popstate"?s===sp?!1:(sp=s,!0):(sp=null,!1)}var H0=typeof setTimeout=="function"?setTimeout:void 0,zj=typeof clearTimeout=="function"?clearTimeout:void 0,$0=typeof Promise=="function"?Promise:void 0,qj=typeof queueMicrotask=="function"?queueMicrotask:typeof $0<"u"?function(s){return $0.resolve(null).then(s).catch(Hj)}:H0;function Hj(s){setTimeout(function(){throw s})}function Bi(s){return s==="head"}function W0(s,a){var o=a,c=0;do{var m=o.nextSibling;if(s.removeChild(o),m&&m.nodeType===8)if(o=m.data,o==="/$"||o==="/&"){if(c===0){s.removeChild(m),Il(a);return}c--}else if(o==="$"||o==="$?"||o==="$~"||o==="$!"||o==="&")c++;else if(o==="html")Vc(s.ownerDocument.documentElement);else if(o==="head"){o=s.ownerDocument.head,Vc(o);for(var f=o.firstChild;f;){var x=f.nextSibling,N=f.nodeName;f[ln]||N==="SCRIPT"||N==="STYLE"||N==="LINK"&&f.rel.toLowerCase()==="stylesheet"||o.removeChild(f),f=x}}else o==="body"&&Vc(s.ownerDocument.body);o=m}while(o);Il(a)}function G0(s,a){var o=s;s=0;do{var c=o.nextSibling;if(o.nodeType===1?a?(o._stashedDisplay=o.style.display,o.style.display="none"):(o.style.display=o._stashedDisplay||"",o.getAttribute("style")===""&&o.removeAttribute("style")):o.nodeType===3&&(a?(o._stashedText=o.nodeValue,o.nodeValue=""):o.nodeValue=o._stashedText||""),c&&c.nodeType===8)if(o=c.data,o==="/$"){if(s===0)break;s--}else o!=="$"&&o!=="$?"&&o!=="$~"&&o!=="$!"||s++;o=c}while(o)}function np(s){var a=s.firstChild;for(a&&a.nodeType===10&&(a=a.nextSibling);a;){var o=a;switch(a=a.nextSibling,o.nodeName){case"HTML":case"HEAD":case"BODY":np(o),_n(o);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(o.rel.toLowerCase()==="stylesheet")continue}s.removeChild(o)}}function $j(s,a,o,c){for(;s.nodeType===1;){var m=o;if(s.nodeName.toLowerCase()!==a.toLowerCase()){if(!c&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(c){if(!s[ln])switch(a){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(f=s.getAttribute("rel"),f==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(f!==m.rel||s.getAttribute("href")!==(m.href==null||m.href===""?null:m.href)||s.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin)||s.getAttribute("title")!==(m.title==null?null:m.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(f=s.getAttribute("src"),(f!==(m.src==null?null:m.src)||s.getAttribute("type")!==(m.type==null?null:m.type)||s.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin))&&f&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(a==="input"&&s.type==="hidden"){var f=m.name==null?null:""+m.name;if(m.type==="hidden"&&s.getAttribute("name")===f)return s}else return s;if(s=ta(s.nextSibling),s===null)break}return null}function Wj(s,a,o){if(a==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!o||(s=ta(s.nextSibling),s===null))return null;return s}function K0(s,a){for(;s.nodeType!==8;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!a||(s=ta(s.nextSibling),s===null))return null;return s}function rp(s){return s.data==="$?"||s.data==="$~"}function ap(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState!=="loading"}function Gj(s,a){var o=s.ownerDocument;if(s.data==="$~")s._reactRetry=a;else if(s.data!=="$?"||o.readyState!=="loading")a();else{var c=function(){a(),o.removeEventListener("DOMContentLoaded",c)};o.addEventListener("DOMContentLoaded",c),s._reactRetry=c}}function ta(s){for(;s!=null;s=s.nextSibling){var a=s.nodeType;if(a===1||a===3)break;if(a===8){if(a=s.data,a==="$"||a==="$!"||a==="$?"||a==="$~"||a==="&"||a==="F!"||a==="F")break;if(a==="/$"||a==="/&")return null}}return s}var ip=null;function Y0(s){s=s.nextSibling;for(var a=0;s;){if(s.nodeType===8){var o=s.data;if(o==="/$"||o==="/&"){if(a===0)return ta(s.nextSibling);a--}else o!=="$"&&o!=="$!"&&o!=="$?"&&o!=="$~"&&o!=="&"||a++}s=s.nextSibling}return null}function Q0(s){s=s.previousSibling;for(var a=0;s;){if(s.nodeType===8){var o=s.data;if(o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"){if(a===0)return s;a--}else o!=="/$"&&o!=="/&"||a++}s=s.previousSibling}return null}function X0(s,a,o){switch(a=Bd(o),s){case"html":if(s=a.documentElement,!s)throw Error(i(452));return s;case"head":if(s=a.head,!s)throw Error(i(453));return s;case"body":if(s=a.body,!s)throw Error(i(454));return s;default:throw Error(i(451))}}function Vc(s){for(var a=s.attributes;a.length;)s.removeAttributeNode(a[0]);_n(s)}var sa=new Map,J0=new Set;function Ud(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var ii=me.d;me.d={f:Kj,r:Yj,D:Qj,C:Xj,L:Jj,m:Zj,X:tT,S:eT,M:sT};function Kj(){var s=ii.f(),a=Ad();return s||a}function Yj(s){var a=fn(s);a!==null&&a.tag===5&&a.type==="form"?pv(a):ii.r(s)}var Cl=typeof document>"u"?null:document;function Z0(s,a,o){var c=Cl;if(c&&typeof a=="string"&&a){var m=wt(a);m='link[rel="'+s+'"][href="'+m+'"]',typeof o=="string"&&(m+='[crossorigin="'+o+'"]'),J0.has(m)||(J0.add(m),s={rel:s,crossOrigin:o,href:a},c.querySelector(m)===null&&(a=c.createElement("link"),Jn(a,"link",s),S(a),c.head.appendChild(a)))}}function Qj(s){ii.D(s),Z0("dns-prefetch",s,null)}function Xj(s,a){ii.C(s,a),Z0("preconnect",s,a)}function Jj(s,a,o){ii.L(s,a,o);var c=Cl;if(c&&s&&a){var m='link[rel="preload"][as="'+wt(a)+'"]';a==="image"&&o&&o.imageSrcSet?(m+='[imagesrcset="'+wt(o.imageSrcSet)+'"]',typeof o.imageSizes=="string"&&(m+='[imagesizes="'+wt(o.imageSizes)+'"]')):m+='[href="'+wt(s)+'"]';var f=m;switch(a){case"style":f=Rl(s);break;case"script":f=Al(s)}sa.has(f)||(s=j({rel:"preload",href:a==="image"&&o&&o.imageSrcSet?void 0:s,as:a},o),sa.set(f,s),c.querySelector(m)!==null||a==="style"&&c.querySelector(Bc(f))||a==="script"&&c.querySelector(Uc(f))||(a=c.createElement("link"),Jn(a,"link",s),S(a),c.head.appendChild(a)))}}function Zj(s,a){ii.m(s,a);var o=Cl;if(o&&s){var c=a&&typeof a.as=="string"?a.as:"script",m='link[rel="modulepreload"][as="'+wt(c)+'"][href="'+wt(s)+'"]',f=m;switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":f=Al(s)}if(!sa.has(f)&&(s=j({rel:"modulepreload",href:s},a),sa.set(f,s),o.querySelector(m)===null)){switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(o.querySelector(Uc(f)))return}c=o.createElement("link"),Jn(c,"link",s),S(c),o.head.appendChild(c)}}}function eT(s,a,o){ii.S(s,a,o);var c=Cl;if(c&&s){var m=k(c).hoistableStyles,f=Rl(s);a=a||"default";var x=m.get(f);if(!x){var N={loading:0,preload:null};if(x=c.querySelector(Bc(f)))N.loading=5;else{s=j({rel:"stylesheet",href:s,"data-precedence":a},o),(o=sa.get(f))&&op(s,o);var z=x=c.createElement("link");S(z),Jn(z,"link",s),z._p=new Promise(function(ie,ke){z.onload=ie,z.onerror=ke}),z.addEventListener("load",function(){N.loading|=1}),z.addEventListener("error",function(){N.loading|=2}),N.loading|=4,Fd(x,a,c)}x={type:"stylesheet",instance:x,count:1,state:N},m.set(f,x)}}}function tT(s,a){ii.X(s,a);var o=Cl;if(o&&s){var c=k(o).hoistableScripts,m=Al(s),f=c.get(m);f||(f=o.querySelector(Uc(m)),f||(s=j({src:s,async:!0},a),(a=sa.get(m))&&lp(s,a),f=o.createElement("script"),S(f),Jn(f,"link",s),o.head.appendChild(f)),f={type:"script",instance:f,count:1,state:null},c.set(m,f))}}function sT(s,a){ii.M(s,a);var o=Cl;if(o&&s){var c=k(o).hoistableScripts,m=Al(s),f=c.get(m);f||(f=o.querySelector(Uc(m)),f||(s=j({src:s,async:!0,type:"module"},a),(a=sa.get(m))&&lp(s,a),f=o.createElement("script"),S(f),Jn(f,"link",s),o.head.appendChild(f)),f={type:"script",instance:f,count:1,state:null},c.set(m,f))}}function e1(s,a,o,c){var m=(m=Fe.current)?Ud(m):null;if(!m)throw Error(i(446));switch(s){case"meta":case"title":return null;case"style":return typeof o.precedence=="string"&&typeof o.href=="string"?(a=Rl(o.href),o=k(m).hoistableStyles,c=o.get(a),c||(c={type:"style",instance:null,count:0,state:null},o.set(a,c)),c):{type:"void",instance:null,count:0,state:null};case"link":if(o.rel==="stylesheet"&&typeof o.href=="string"&&typeof o.precedence=="string"){s=Rl(o.href);var f=k(m).hoistableStyles,x=f.get(s);if(x||(m=m.ownerDocument||m,x={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},f.set(s,x),(f=m.querySelector(Bc(s)))&&!f._p&&(x.instance=f,x.state.loading=5),sa.has(s)||(o={rel:"preload",as:"style",href:o.href,crossOrigin:o.crossOrigin,integrity:o.integrity,media:o.media,hrefLang:o.hrefLang,referrerPolicy:o.referrerPolicy},sa.set(s,o),f||nT(m,s,o,x.state))),a&&c===null)throw Error(i(528,""));return x}if(a&&c!==null)throw Error(i(529,""));return null;case"script":return a=o.async,o=o.src,typeof o=="string"&&a&&typeof a!="function"&&typeof a!="symbol"?(a=Al(o),o=k(m).hoistableScripts,c=o.get(a),c||(c={type:"script",instance:null,count:0,state:null},o.set(a,c)),c):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,s))}}function Rl(s){return'href="'+wt(s)+'"'}function Bc(s){return'link[rel="stylesheet"]['+s+"]"}function t1(s){return j({},s,{"data-precedence":s.precedence,precedence:null})}function nT(s,a,o,c){s.querySelector('link[rel="preload"][as="style"]['+a+"]")?c.loading=1:(a=s.createElement("link"),c.preload=a,a.addEventListener("load",function(){return c.loading|=1}),a.addEventListener("error",function(){return c.loading|=2}),Jn(a,"link",o),S(a),s.head.appendChild(a))}function Al(s){return'[src="'+wt(s)+'"]'}function Uc(s){return"script[async]"+s}function s1(s,a,o){if(a.count++,a.instance===null)switch(a.type){case"style":var c=s.querySelector('style[data-href~="'+wt(o.href)+'"]');if(c)return a.instance=c,S(c),c;var m=j({},o,{"data-href":o.href,"data-precedence":o.precedence,href:null,precedence:null});return c=(s.ownerDocument||s).createElement("style"),S(c),Jn(c,"style",m),Fd(c,o.precedence,s),a.instance=c;case"stylesheet":m=Rl(o.href);var f=s.querySelector(Bc(m));if(f)return a.state.loading|=4,a.instance=f,S(f),f;c=t1(o),(m=sa.get(m))&&op(c,m),f=(s.ownerDocument||s).createElement("link"),S(f);var x=f;return x._p=new Promise(function(N,z){x.onload=N,x.onerror=z}),Jn(f,"link",c),a.state.loading|=4,Fd(f,o.precedence,s),a.instance=f;case"script":return f=Al(o.src),(m=s.querySelector(Uc(f)))?(a.instance=m,S(m),m):(c=o,(m=sa.get(f))&&(c=j({},o),lp(c,m)),s=s.ownerDocument||s,m=s.createElement("script"),S(m),Jn(m,"link",c),s.head.appendChild(m),a.instance=m);case"void":return null;default:throw Error(i(443,a.type))}else a.type==="stylesheet"&&(a.state.loading&4)===0&&(c=a.instance,a.state.loading|=4,Fd(c,o.precedence,s));return a.instance}function Fd(s,a,o){for(var c=o.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),m=c.length?c[c.length-1]:null,f=m,x=0;x<c.length;x++){var N=c[x];if(N.dataset.precedence===a)f=N;else if(f!==m)break}f?f.parentNode.insertBefore(s,f.nextSibling):(a=o.nodeType===9?o.head:o,a.insertBefore(s,a.firstChild))}function op(s,a){s.crossOrigin==null&&(s.crossOrigin=a.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=a.referrerPolicy),s.title==null&&(s.title=a.title)}function lp(s,a){s.crossOrigin==null&&(s.crossOrigin=a.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=a.referrerPolicy),s.integrity==null&&(s.integrity=a.integrity)}var zd=null;function n1(s,a,o){if(zd===null){var c=new Map,m=zd=new Map;m.set(o,c)}else m=zd,c=m.get(o),c||(c=new Map,m.set(o,c));if(c.has(s))return c;for(c.set(s,null),o=o.getElementsByTagName(s),m=0;m<o.length;m++){var f=o[m];if(!(f[ln]||f[ct]||s==="link"&&f.getAttribute("rel")==="stylesheet")&&f.namespaceURI!=="http://www.w3.org/2000/svg"){var x=f.getAttribute(a)||"";x=s+x;var N=c.get(x);N?N.push(f):c.set(x,[f])}}return c}function r1(s,a,o){s=s.ownerDocument||s,s.head.insertBefore(o,a==="title"?s.querySelector("head > title"):null)}function rT(s,a,o){if(o===1||a.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof a.precedence!="string"||typeof a.href!="string"||a.href==="")break;return!0;case"link":if(typeof a.rel!="string"||typeof a.href!="string"||a.href===""||a.onLoad||a.onError)break;return a.rel==="stylesheet"?(s=a.disabled,typeof a.precedence=="string"&&s==null):!0;case"script":if(a.async&&typeof a.async!="function"&&typeof a.async!="symbol"&&!a.onLoad&&!a.onError&&a.src&&typeof a.src=="string")return!0}return!1}function a1(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}function aT(s,a,o,c){if(o.type==="stylesheet"&&(typeof c.media!="string"||matchMedia(c.media).matches!==!1)&&(o.state.loading&4)===0){if(o.instance===null){var m=Rl(c.href),f=a.querySelector(Bc(m));if(f){a=f._p,a!==null&&typeof a=="object"&&typeof a.then=="function"&&(s.count++,s=qd.bind(s),a.then(s,s)),o.state.loading|=4,o.instance=f,S(f);return}f=a.ownerDocument||a,c=t1(c),(m=sa.get(m))&&op(c,m),f=f.createElement("link"),S(f);var x=f;x._p=new Promise(function(N,z){x.onload=N,x.onerror=z}),Jn(f,"link",c),o.instance=f}s.stylesheets===null&&(s.stylesheets=new Map),s.stylesheets.set(o,a),(a=o.state.preload)&&(o.state.loading&3)===0&&(s.count++,o=qd.bind(s),a.addEventListener("load",o),a.addEventListener("error",o))}}var cp=0;function iT(s,a){return s.stylesheets&&s.count===0&&$d(s,s.stylesheets),0<s.count||0<s.imgCount?function(o){var c=setTimeout(function(){if(s.stylesheets&&$d(s,s.stylesheets),s.unsuspend){var f=s.unsuspend;s.unsuspend=null,f()}},6e4+a);0<s.imgBytes&&cp===0&&(cp=62500*Uj());var m=setTimeout(function(){if(s.waitingForImages=!1,s.count===0&&(s.stylesheets&&$d(s,s.stylesheets),s.unsuspend)){var f=s.unsuspend;s.unsuspend=null,f()}},(s.imgBytes>cp?50:800)+a);return s.unsuspend=o,function(){s.unsuspend=null,clearTimeout(c),clearTimeout(m)}}:null}function qd(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)$d(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var Hd=null;function $d(s,a){s.stylesheets=null,s.unsuspend!==null&&(s.count++,Hd=new Map,a.forEach(oT,s),Hd=null,qd.call(s))}function oT(s,a){if(!(a.state.loading&4)){var o=Hd.get(s);if(o)var c=o.get(null);else{o=new Map,Hd.set(s,o);for(var m=s.querySelectorAll("link[data-precedence],style[data-precedence]"),f=0;f<m.length;f++){var x=m[f];(x.nodeName==="LINK"||x.getAttribute("media")!=="not all")&&(o.set(x.dataset.precedence,x),c=x)}c&&o.set(null,c)}m=a.instance,x=m.getAttribute("data-precedence"),f=o.get(x)||c,f===c&&o.set(null,m),o.set(x,m),this.count++,c=qd.bind(this),m.addEventListener("load",c),m.addEventListener("error",c),f?f.parentNode.insertBefore(m,f.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(m,s.firstChild)),a.state.loading|=4}}var Fc={$$typeof:oe,Provider:null,Consumer:null,_currentValue:Ve,_currentValue2:Ve,_threadCount:0};function lT(s,a,o,c,m,f,x,N,z){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Ot(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ot(0),this.hiddenUpdates=Ot(null),this.identifierPrefix=c,this.onUncaughtError=m,this.onCaughtError=f,this.onRecoverableError=x,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=z,this.incompleteTransitions=new Map}function i1(s,a,o,c,m,f,x,N,z,ie,ke,Ie){return s=new lT(s,a,o,x,z,ie,ke,Ie,N),a=1,f===!0&&(a|=24),f=Or(3,null,null,a),s.current=f,f.stateNode=s,a=Fm(),a.refCount++,s.pooledCache=a,a.refCount++,f.memoizedState={element:c,isDehydrated:o,cache:a},$m(f),s}function o1(s){return s?(s=ll,s):ll}function l1(s,a,o,c,m,f){m=o1(m),c.context===null?c.context=m:c.pendingContext=m,c=Si(a),c.payload={element:o},f=f===void 0?null:f,f!==null&&(c.callback=f),o=Ci(s,c,a),o!==null&&(Rr(o,s,a),vc(o,s,a))}function c1(s,a){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var o=s.retryLane;s.retryLane=o!==0&&o<a?o:a}}function up(s,a){c1(s,a),(s=s.alternate)&&c1(s,a)}function u1(s){if(s.tag===13||s.tag===31){var a=wo(s,67108864);a!==null&&Rr(a,s,67108864),up(s,67108864)}}function d1(s){if(s.tag===13||s.tag===31){var a=zr();a=q(a);var o=wo(s,a);o!==null&&Rr(o,s,a),up(s,a)}}var Wd=!0;function cT(s,a,o,c){var m=$.T;$.T=null;var f=me.p;try{me.p=2,dp(s,a,o,c)}finally{me.p=f,$.T=m}}function uT(s,a,o,c){var m=$.T;$.T=null;var f=me.p;try{me.p=8,dp(s,a,o,c)}finally{me.p=f,$.T=m}}function dp(s,a,o,c){if(Wd){var m=hp(c);if(m===null)Xf(s,a,c,Gd,o),m1(s,c);else if(hT(m,s,a,o,c))c.stopPropagation();else if(m1(s,c),a&4&&-1<dT.indexOf(s)){for(;m!==null;){var f=fn(m);if(f!==null)switch(f.tag){case 3:if(f=f.stateNode,f.current.memoizedState.isDehydrated){var x=lt(f.pendingLanes);if(x!==0){var N=f;for(N.pendingLanes|=2,N.entangledLanes|=2;x;){var z=1<<31-Oe(x);N.entanglements[1]|=z,x&=~z}Ra(f),(Bs&6)===0&&(Cd=ss()+500,Pc(0))}}break;case 31:case 13:N=wo(f,2),N!==null&&Rr(N,f,2),Ad(),up(f,2)}if(f=hp(c),f===null&&Xf(s,a,c,Gd,o),f===m)break;m=f}m!==null&&c.stopPropagation()}else Xf(s,a,c,null,o)}}function hp(s){return s=Sn(s),mp(s)}var Gd=null;function mp(s){if(Gd=null,s=kn(s),s!==null){var a=u(s);if(a===null)s=null;else{var o=a.tag;if(o===13){if(s=d(a),s!==null)return s;s=null}else if(o===31){if(s=p(a),s!==null)return s;s=null}else if(o===3){if(a.stateNode.current.memoizedState.isDehydrated)return a.tag===3?a.stateNode.containerInfo:null;s=null}else a!==s&&(s=null)}}return Gd=s,null}function h1(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Ct()){case Jt:return 2;case vs:return 8;case Bt:case As:return 32;case ue:return 268435456;default:return 32}default:return 32}}var fp=!1,Ui=null,Fi=null,zi=null,zc=new Map,qc=new Map,qi=[],dT="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function m1(s,a){switch(s){case"focusin":case"focusout":Ui=null;break;case"dragenter":case"dragleave":Fi=null;break;case"mouseover":case"mouseout":zi=null;break;case"pointerover":case"pointerout":zc.delete(a.pointerId);break;case"gotpointercapture":case"lostpointercapture":qc.delete(a.pointerId)}}function Hc(s,a,o,c,m,f){return s===null||s.nativeEvent!==f?(s={blockedOn:a,domEventName:o,eventSystemFlags:c,nativeEvent:f,targetContainers:[m]},a!==null&&(a=fn(a),a!==null&&u1(a)),s):(s.eventSystemFlags|=c,a=s.targetContainers,m!==null&&a.indexOf(m)===-1&&a.push(m),s)}function hT(s,a,o,c,m){switch(a){case"focusin":return Ui=Hc(Ui,s,a,o,c,m),!0;case"dragenter":return Fi=Hc(Fi,s,a,o,c,m),!0;case"mouseover":return zi=Hc(zi,s,a,o,c,m),!0;case"pointerover":var f=m.pointerId;return zc.set(f,Hc(zc.get(f)||null,s,a,o,c,m)),!0;case"gotpointercapture":return f=m.pointerId,qc.set(f,Hc(qc.get(f)||null,s,a,o,c,m)),!0}return!1}function f1(s){var a=kn(s.target);if(a!==null){var o=u(a);if(o!==null){if(a=o.tag,a===13){if(a=d(o),a!==null){s.blockedOn=a,Te(s.priority,function(){d1(o)});return}}else if(a===31){if(a=p(o),a!==null){s.blockedOn=a,Te(s.priority,function(){d1(o)});return}}else if(a===3&&o.stateNode.current.memoizedState.isDehydrated){s.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}s.blockedOn=null}function Kd(s){if(s.blockedOn!==null)return!1;for(var a=s.targetContainers;0<a.length;){var o=hp(s.nativeEvent);if(o===null){o=s.nativeEvent;var c=new o.constructor(o.type,o);Ln=c,o.target.dispatchEvent(c),Ln=null}else return a=fn(o),a!==null&&u1(a),s.blockedOn=o,!1;a.shift()}return!0}function p1(s,a,o){Kd(s)&&o.delete(a)}function mT(){fp=!1,Ui!==null&&Kd(Ui)&&(Ui=null),Fi!==null&&Kd(Fi)&&(Fi=null),zi!==null&&Kd(zi)&&(zi=null),zc.forEach(p1),qc.forEach(p1)}function Yd(s,a){s.blockedOn===a&&(s.blockedOn=null,fp||(fp=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,mT)))}var Qd=null;function g1(s){Qd!==s&&(Qd=s,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){Qd===s&&(Qd=null);for(var a=0;a<s.length;a+=3){var o=s[a],c=s[a+1],m=s[a+2];if(typeof c!="function"){if(mp(c||o)===null)continue;break}var f=fn(o);f!==null&&(s.splice(a,3),a-=3,hf(f,{pending:!0,data:m,method:o.method,action:c},c,m))}}))}function Il(s){function a(z){return Yd(z,s)}Ui!==null&&Yd(Ui,s),Fi!==null&&Yd(Fi,s),zi!==null&&Yd(zi,s),zc.forEach(a),qc.forEach(a);for(var o=0;o<qi.length;o++){var c=qi[o];c.blockedOn===s&&(c.blockedOn=null)}for(;0<qi.length&&(o=qi[0],o.blockedOn===null);)f1(o),o.blockedOn===null&&qi.shift();if(o=(s.ownerDocument||s).$$reactFormReplay,o!=null)for(c=0;c<o.length;c+=3){var m=o[c],f=o[c+1],x=m[ht]||null;if(typeof f=="function")x||g1(o);else if(x){var N=null;if(f&&f.hasAttribute("formAction")){if(m=f,x=f[ht]||null)N=x.formAction;else if(mp(m)!==null)continue}else N=x.action;typeof N=="function"?o[c+1]=N:(o.splice(c,3),c-=3),g1(o)}}}function y1(){function s(f){f.canIntercept&&f.info==="react-transition"&&f.intercept({handler:function(){return new Promise(function(x){return m=x})},focusReset:"manual",scroll:"manual"})}function a(){m!==null&&(m(),m=null),c||setTimeout(o,20)}function o(){if(!c&&!navigation.transition){var f=navigation.currentEntry;f&&f.url!=null&&navigation.navigate(f.url,{state:f.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var c=!1,m=null;return navigation.addEventListener("navigate",s),navigation.addEventListener("navigatesuccess",a),navigation.addEventListener("navigateerror",a),setTimeout(o,100),function(){c=!0,navigation.removeEventListener("navigate",s),navigation.removeEventListener("navigatesuccess",a),navigation.removeEventListener("navigateerror",a),m!==null&&(m(),m=null)}}}function pp(s){this._internalRoot=s}Xd.prototype.render=pp.prototype.render=function(s){var a=this._internalRoot;if(a===null)throw Error(i(409));var o=a.current,c=zr();l1(o,c,s,a,null,null)},Xd.prototype.unmount=pp.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var a=s.containerInfo;l1(s.current,2,null,s,null,null),Ad(),a[et]=null}};function Xd(s){this._internalRoot=s}Xd.prototype.unstable_scheduleHydration=function(s){if(s){var a=je();s={blockedOn:null,target:s,priority:a};for(var o=0;o<qi.length&&a!==0&&a<qi[o].priority;o++);qi.splice(o,0,s),o===0&&f1(s)}};var b1=e.version;if(b1!=="19.2.4")throw Error(i(527,b1,"19.2.4"));me.findDOMNode=function(s){var a=s._reactInternals;if(a===void 0)throw typeof s.render=="function"?Error(i(188)):(s=Object.keys(s).join(","),Error(i(268,s)));return s=y(a),s=s!==null?w(s):null,s=s===null?null:s.stateNode,s};var fT={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:$,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Jd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Jd.isDisabled&&Jd.supportsFiber)try{ee=Jd.inject(fT),ge=Jd}catch{}}return Wc.createRoot=function(s,a){if(!l(s))throw Error(i(299));var o=!1,c="",m=Tv,f=Ev,x=Nv;return a!=null&&(a.unstable_strictMode===!0&&(o=!0),a.identifierPrefix!==void 0&&(c=a.identifierPrefix),a.onUncaughtError!==void 0&&(m=a.onUncaughtError),a.onCaughtError!==void 0&&(f=a.onCaughtError),a.onRecoverableError!==void 0&&(x=a.onRecoverableError)),a=i1(s,1,!1,null,null,o,c,null,m,f,x,y1),s[et]=a.current,Qf(s),new pp(a)},Wc.hydrateRoot=function(s,a,o){if(!l(s))throw Error(i(299));var c=!1,m="",f=Tv,x=Ev,N=Nv,z=null;return o!=null&&(o.unstable_strictMode===!0&&(c=!0),o.identifierPrefix!==void 0&&(m=o.identifierPrefix),o.onUncaughtError!==void 0&&(f=o.onUncaughtError),o.onCaughtError!==void 0&&(x=o.onCaughtError),o.onRecoverableError!==void 0&&(N=o.onRecoverableError),o.formState!==void 0&&(z=o.formState)),a=i1(s,1,!0,a,o??null,c,m,z,f,x,N,y1),a.context=o1(null),o=a.current,c=zr(),c=q(c),m=Si(c),m.callback=null,Ci(o,m,c),o=c,a.current.lanes=o,Ls(a,o),Ra(a),s[et]=a.current,Qf(s),new Xd(a)},Wc.version="19.2.4",Wc}var S1;function jT(){if(S1)return bp.exports;S1=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),bp.exports=kT(),bp.exports}var TT=jT();const ET="modulepreload",NT=function(n){return"/login/"+n},C1={},wr=function(e,t,i){let l=Promise.resolve();if(t&&t.length>0){let g=function(y){return Promise.all(y.map(w=>Promise.resolve(w).then(j=>({status:"fulfilled",value:j}),j=>({status:"rejected",reason:j}))))};document.getElementsByTagName("link");const d=document.querySelector("meta[property=csp-nonce]"),p=d?.nonce||d?.getAttribute("nonce");l=g(t.map(y=>{if(y=NT(y),y in C1)return;C1[y]=!0;const w=y.endsWith(".css"),j=w?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${y}"]${j}`))return;const T=document.createElement("link");if(T.rel=w?"stylesheet":ET,w||(T.as="script"),T.crossOrigin="",T.href=y,p&&T.setAttribute("nonce",p),document.head.appendChild(T),w)return new Promise((V,W)=>{T.addEventListener("load",V),T.addEventListener("error",()=>W(new Error(`Unable to preload CSS for ${y}`)))})}))}function u(d){const p=new Event("vite:preloadError",{cancelable:!0});if(p.payload=d,window.dispatchEvent(p),!p.defaultPrevented)throw d}return l.then(d=>{for(const p of d||[])p.status==="rejected"&&u(p.reason);return e().catch(u)})};var R1="popstate";function ST(n={}){function e(i,l){let{pathname:u,search:d,hash:p}=i.location;return sg("",{pathname:u,search:d,hash:p},l.state&&l.state.usr||null,l.state&&l.state.key||"default")}function t(i,l){return typeof l=="string"?l:fu(l)}return RT(e,t,null,n)}function on(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function ra(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function CT(){return Math.random().toString(36).substring(2,10)}function A1(n,e){return{usr:n.state,key:n.key,idx:e}}function sg(n,e,t=null,i){return{pathname:typeof n=="string"?n:n.pathname,search:"",hash:"",...typeof e=="string"?ec(e):e,state:t,key:e&&e.key||i||CT()}}function fu({pathname:n="/",search:e="",hash:t=""}){return e&&e!=="?"&&(n+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(n+=t.charAt(0)==="#"?t:"#"+t),n}function ec(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substring(t),n=n.substring(0,t));let i=n.indexOf("?");i>=0&&(e.search=n.substring(i),n=n.substring(0,i)),n&&(e.pathname=n)}return e}function RT(n,e,t,i={}){let{window:l=document.defaultView,v5Compat:u=!1}=i,d=l.history,p="POP",g=null,y=w();y==null&&(y=0,d.replaceState({...d.state,idx:y},""));function w(){return(d.state||{idx:null}).idx}function j(){p="POP";let U=w(),ne=U==null?null:U-y;y=U,g&&g({action:p,location:F.location,delta:ne})}function T(U,ne){p="PUSH";let Y=sg(F.location,U,ne);y=w()+1;let oe=A1(Y,y),be=F.createHref(Y);try{d.pushState(oe,"",be)}catch(Le){if(Le instanceof DOMException&&Le.name==="DataCloneError")throw Le;l.location.assign(be)}u&&g&&g({action:p,location:F.location,delta:1})}function V(U,ne){p="REPLACE";let Y=sg(F.location,U,ne);y=w();let oe=A1(Y,y),be=F.createHref(Y);d.replaceState(oe,"",be),u&&g&&g({action:p,location:F.location,delta:0})}function W(U){return AT(U)}let F={get action(){return p},get location(){return n(l,d)},listen(U){if(g)throw new Error("A history only accepts one active listener");return l.addEventListener(R1,j),g=U,()=>{l.removeEventListener(R1,j),g=null}},createHref(U){return e(l,U)},createURL:W,encodeLocation(U){let ne=W(U);return{pathname:ne.pathname,search:ne.search,hash:ne.hash}},push:T,replace:V,go(U){return d.go(U)}};return F}function AT(n,e=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),on(t,"No window.location.(origin|href) available to create URL");let i=typeof n=="string"?n:fu(n);return i=i.replace(/ $/,"%20"),!e&&i.startsWith("//")&&(i=t+i),new URL(i,t)}function R2(n,e,t="/"){return IT(n,e,t,!1)}function IT(n,e,t,i){let l=typeof e=="string"?ec(e):e,u=mi(l.pathname||"/",t);if(u==null)return null;let d=A2(n);MT(d);let p=null;for(let g=0;p==null&&g<d.length;++g){let y=HT(u);p=zT(d[g],y,i)}return p}function A2(n,e=[],t=[],i="",l=!1){let u=(d,p,g=l,y)=>{let w={relativePath:y===void 0?d.path||"":y,caseSensitive:d.caseSensitive===!0,childrenIndex:p,route:d};if(w.relativePath.startsWith("/")){if(!w.relativePath.startsWith(i)&&g)return;on(w.relativePath.startsWith(i),`Absolute route path "${w.relativePath}" nested under path "${i}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),w.relativePath=w.relativePath.slice(i.length)}let j=ci([i,w.relativePath]),T=t.concat(w);d.children&&d.children.length>0&&(on(d.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${j}".`),A2(d.children,e,T,j,g)),!(d.path==null&&!d.index)&&e.push({path:j,score:UT(j,d.index),routesMeta:T})};return n.forEach((d,p)=>{if(d.path===""||!d.path?.includes("?"))u(d,p);else for(let g of I2(d.path))u(d,p,!0,g)}),e}function I2(n){let e=n.split("/");if(e.length===0)return[];let[t,...i]=e,l=t.endsWith("?"),u=t.replace(/\?$/,"");if(i.length===0)return l?[u,""]:[u];let d=I2(i.join("/")),p=[];return p.push(...d.map(g=>g===""?u:[u,g].join("/"))),l&&p.push(...d),p.map(g=>n.startsWith("/")&&g===""?"/":g)}function MT(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:FT(e.routesMeta.map(i=>i.childrenIndex),t.routesMeta.map(i=>i.childrenIndex)))}var DT=/^:[\w-]+$/,PT=3,LT=2,OT=1,VT=10,BT=-2,I1=n=>n==="*";function UT(n,e){let t=n.split("/"),i=t.length;return t.some(I1)&&(i+=BT),e&&(i+=LT),t.filter(l=>!I1(l)).reduce((l,u)=>l+(DT.test(u)?PT:u===""?OT:VT),i)}function FT(n,e){return n.length===e.length&&n.slice(0,-1).every((i,l)=>i===e[l])?n[n.length-1]-e[e.length-1]:0}function zT(n,e,t=!1){let{routesMeta:i}=n,l={},u="/",d=[];for(let p=0;p<i.length;++p){let g=i[p],y=p===i.length-1,w=u==="/"?e:e.slice(u.length)||"/",j=Eh({path:g.relativePath,caseSensitive:g.caseSensitive,end:y},w),T=g.route;if(!j&&y&&t&&!i[i.length-1].route.index&&(j=Eh({path:g.relativePath,caseSensitive:g.caseSensitive,end:!1},w)),!j)return null;Object.assign(l,j.params),d.push({params:l,pathname:ci([u,j.pathname]),pathnameBase:KT(ci([u,j.pathnameBase])),route:T}),j.pathnameBase!=="/"&&(u=ci([u,j.pathnameBase]))}return d}function Eh(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,i]=qT(n.path,n.caseSensitive,n.end),l=e.match(t);if(!l)return null;let u=l[0],d=u.replace(/(.)\/+$/,"$1"),p=l.slice(1);return{params:i.reduce((y,{paramName:w,isOptional:j},T)=>{if(w==="*"){let W=p[T]||"";d=u.slice(0,u.length-W.length).replace(/(.)\/+$/,"$1")}const V=p[T];return j&&!V?y[w]=void 0:y[w]=(V||"").replace(/%2F/g,"/"),y},{}),pathname:u,pathnameBase:d,pattern:n}}function qT(n,e=!1,t=!0){ra(n==="*"||!n.endsWith("*")||n.endsWith("/*"),`Route path "${n}" will be treated as if it were "${n.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${n.replace(/\*$/,"/*")}".`);let i=[],l="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(d,p,g)=>(i.push({paramName:p,isOptional:g!=null}),g?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return n.endsWith("*")?(i.push({paramName:"*"}),l+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?l+="\\/*$":n!==""&&n!=="/"&&(l+="(?:(?=\\/|$))"),[new RegExp(l,e?void 0:"i"),i]}function HT(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return ra(!1,`The URL path "${n}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),n}}function mi(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,i=n.charAt(t);return i&&i!=="/"?null:n.slice(t)||"/"}var $T=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i;function WT(n,e="/"){let{pathname:t,search:i="",hash:l=""}=typeof n=="string"?ec(n):n,u;return t?(t=t.replace(/\/\/+/g,"/"),t.startsWith("/")?u=M1(t.substring(1),"/"):u=M1(t,e)):u=e,{pathname:u,search:YT(i),hash:QT(l)}}function M1(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(l=>{l===".."?t.length>1&&t.pop():l!=="."&&t.push(l)}),t.length>1?t.join("/"):"/"}function _p(n,e,t,i){return`Cannot include a '${n}' character in a manually specified \`to.${e}\` field [${JSON.stringify(i)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function GT(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function Dg(n){let e=GT(n);return e.map((t,i)=>i===e.length-1?t.pathname:t.pathnameBase)}function Pg(n,e,t,i=!1){let l;typeof n=="string"?l=ec(n):(l={...n},on(!l.pathname||!l.pathname.includes("?"),_p("?","pathname","search",l)),on(!l.pathname||!l.pathname.includes("#"),_p("#","pathname","hash",l)),on(!l.search||!l.search.includes("#"),_p("#","search","hash",l)));let u=n===""||l.pathname==="",d=u?"/":l.pathname,p;if(d==null)p=t;else{let j=e.length-1;if(!i&&d.startsWith("..")){let T=d.split("/");for(;T[0]==="..";)T.shift(),j-=1;l.pathname=T.join("/")}p=j>=0?e[j]:"/"}let g=WT(l,p),y=d&&d!=="/"&&d.endsWith("/"),w=(u||d===".")&&t.endsWith("/");return!g.pathname.endsWith("/")&&(y||w)&&(g.pathname+="/"),g}var ci=n=>n.join("/").replace(/\/\/+/g,"/"),KT=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),YT=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,QT=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n,XT=class{constructor(n,e,t,i=!1){this.status=n,this.statusText=e||"",this.internal=i,t instanceof Error?(this.data=t.toString(),this.error=t):this.data=t}};function JT(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}function ZT(n){return n.map(e=>e.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var M2=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function D2(n,e){let t=n;if(typeof t!="string"||!$T.test(t))return{absoluteURL:void 0,isExternal:!1,to:t};let i=t,l=!1;if(M2)try{let u=new URL(window.location.href),d=t.startsWith("//")?new URL(u.protocol+t):new URL(t),p=mi(d.pathname,e);d.origin===u.origin&&p!=null?t=p+d.search+d.hash:l=!0}catch{ra(!1,`<Link to="${t}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:i,isExternal:l,to:t}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var P2=["POST","PUT","PATCH","DELETE"];new Set(P2);var eE=["GET",...P2];new Set(eE);var tc=v.createContext(null);tc.displayName="DataRouter";var Yh=v.createContext(null);Yh.displayName="DataRouterState";var tE=v.createContext(!1),L2=v.createContext({isTransitioning:!1});L2.displayName="ViewTransition";var sE=v.createContext(new Map);sE.displayName="Fetchers";var nE=v.createContext(null);nE.displayName="Await";var Wr=v.createContext(null);Wr.displayName="Navigation";var Nu=v.createContext(null);Nu.displayName="Location";var wa=v.createContext({outlet:null,matches:[],isDataRoute:!1});wa.displayName="Route";var Lg=v.createContext(null);Lg.displayName="RouteError";var O2="REACT_ROUTER_ERROR",rE="REDIRECT",aE="ROUTE_ERROR_RESPONSE";function iE(n){if(n.startsWith(`${O2}:${rE}:{`))try{let e=JSON.parse(n.slice(28));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.location=="string"&&typeof e.reloadDocument=="boolean"&&typeof e.replace=="boolean")return e}catch{}}function oE(n){if(n.startsWith(`${O2}:${aE}:{`))try{let e=JSON.parse(n.slice(40));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string")return new XT(e.status,e.statusText,e.data)}catch{}}function lE(n,{relative:e}={}){on(sc(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:i}=v.useContext(Wr),{hash:l,pathname:u,search:d}=Su(n,{relative:e}),p=u;return t!=="/"&&(p=u==="/"?t:ci([t,u])),i.createHref({pathname:p,search:d,hash:l})}function sc(){return v.useContext(Nu)!=null}function _a(){return on(sc(),"useLocation() may be used only in the context of a <Router> component."),v.useContext(Nu).location}var V2="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function B2(n){v.useContext(Wr).static||v.useLayoutEffect(n)}function $n(){let{isDataRoute:n}=v.useContext(wa);return n?_E():cE()}function cE(){on(sc(),"useNavigate() may be used only in the context of a <Router> component.");let n=v.useContext(tc),{basename:e,navigator:t}=v.useContext(Wr),{matches:i}=v.useContext(wa),{pathname:l}=_a(),u=JSON.stringify(Dg(i)),d=v.useRef(!1);return B2(()=>{d.current=!0}),v.useCallback((g,y={})=>{if(ra(d.current,V2),!d.current)return;if(typeof g=="number"){t.go(g);return}let w=Pg(g,JSON.parse(u),l,y.relative==="path");n==null&&e!=="/"&&(w.pathname=w.pathname==="/"?e:ci([e,w.pathname])),(y.replace?t.replace:t.push)(w,y.state,y)},[e,t,u,l,n])}v.createContext(null);function uE(){let{matches:n}=v.useContext(wa),e=n[n.length-1];return e?e.params:{}}function Su(n,{relative:e}={}){let{matches:t}=v.useContext(wa),{pathname:i}=_a(),l=JSON.stringify(Dg(t));return v.useMemo(()=>Pg(n,JSON.parse(l),i,e==="path"),[n,l,i,e])}function dE(n,e){return U2(n,e)}function U2(n,e,t,i,l){on(sc(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:u}=v.useContext(Wr),{matches:d}=v.useContext(wa),p=d[d.length-1],g=p?p.params:{},y=p?p.pathname:"/",w=p?p.pathnameBase:"/",j=p&&p.route;{let Y=j&&j.path||"";z2(y,!j||Y.endsWith("*")||Y.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${y}" (under <Route path="${Y}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${Y}"> to <Route path="${Y==="/"?"*":`${Y}/*`}">.`)}let T=_a(),V;if(e){let Y=typeof e=="string"?ec(e):e;on(w==="/"||Y.pathname?.startsWith(w),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${w}" but pathname "${Y.pathname}" was given in the \`location\` prop.`),V=Y}else V=T;let W=V.pathname||"/",F=W;if(w!=="/"){let Y=w.replace(/^\//,"").split("/");F="/"+W.replace(/^\//,"").split("/").slice(Y.length).join("/")}let U=R2(n,{pathname:F});ra(j||U!=null,`No routes matched location "${V.pathname}${V.search}${V.hash}" `),ra(U==null||U[U.length-1].route.element!==void 0||U[U.length-1].route.Component!==void 0||U[U.length-1].route.lazy!==void 0,`Matched leaf route at location "${V.pathname}${V.search}${V.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let ne=gE(U&&U.map(Y=>Object.assign({},Y,{params:Object.assign({},g,Y.params),pathname:ci([w,u.encodeLocation?u.encodeLocation(Y.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:Y.pathname]),pathnameBase:Y.pathnameBase==="/"?w:ci([w,u.encodeLocation?u.encodeLocation(Y.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:Y.pathnameBase])})),d,t,i,l);return e&&ne?v.createElement(Nu.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...V},navigationType:"POP"}},ne):ne}function hE(){let n=wE(),e=JT(n)?`${n.status} ${n.statusText}`:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,i="rgba(200,200,200, 0.5)",l={padding:"0.5rem",backgroundColor:i},u={padding:"2px 4px",backgroundColor:i},d=null;return console.error("Error handled by React Router default ErrorBoundary:",n),d=v.createElement(v.Fragment,null,v.createElement("p",null," Hey developer "),v.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",v.createElement("code",{style:u},"ErrorBoundary")," or"," ",v.createElement("code",{style:u},"errorElement")," prop on your route.")),v.createElement(v.Fragment,null,v.createElement("h2",null,"Unexpected Application Error!"),v.createElement("h3",{style:{fontStyle:"italic"}},e),t?v.createElement("pre",{style:l},t):null,d)}var mE=v.createElement(hE,null),F2=class extends v.Component{constructor(n){super(n),this.state={location:n.location,revalidation:n.revalidation,error:n.error}}static getDerivedStateFromError(n){return{error:n}}static getDerivedStateFromProps(n,e){return e.location!==n.location||e.revalidation!=="idle"&&n.revalidation==="idle"?{error:n.error,location:n.location,revalidation:n.revalidation}:{error:n.error!==void 0?n.error:e.error,location:e.location,revalidation:n.revalidation||e.revalidation}}componentDidCatch(n,e){this.props.onError?this.props.onError(n,e):console.error("React Router caught the following error during render",n)}render(){let n=this.state.error;if(this.context&&typeof n=="object"&&n&&"digest"in n&&typeof n.digest=="string"){const t=oE(n.digest);t&&(n=t)}let e=n!==void 0?v.createElement(wa.Provider,{value:this.props.routeContext},v.createElement(Lg.Provider,{value:n,children:this.props.component})):this.props.children;return this.context?v.createElement(fE,{error:n},e):e}};F2.contextType=tE;var kp=new WeakMap;function fE({children:n,error:e}){let{basename:t}=v.useContext(Wr);if(typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){let i=iE(e.digest);if(i){let l=kp.get(e);if(l)throw l;let u=D2(i.location,t);if(M2&&!kp.get(e))if(u.isExternal||i.reloadDocument)window.location.href=u.absoluteURL||u.to;else{const d=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(u.to,{replace:i.replace}));throw kp.set(e,d),d}return v.createElement("meta",{httpEquiv:"refresh",content:`0;url=${u.absoluteURL||u.to}`})}}return n}function pE({routeContext:n,match:e,children:t}){let i=v.useContext(tc);return i&&i.static&&i.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=e.route.id),v.createElement(wa.Provider,{value:n},t)}function gE(n,e=[],t=null,i=null,l=null){if(n==null){if(!t)return null;if(t.errors)n=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let u=n,d=t?.errors;if(d!=null){let w=u.findIndex(j=>j.route.id&&d?.[j.route.id]!==void 0);on(w>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(d).join(",")}`),u=u.slice(0,Math.min(u.length,w+1))}let p=!1,g=-1;if(t)for(let w=0;w<u.length;w++){let j=u[w];if((j.route.HydrateFallback||j.route.hydrateFallbackElement)&&(g=w),j.route.id){let{loaderData:T,errors:V}=t,W=j.route.loader&&!T.hasOwnProperty(j.route.id)&&(!V||V[j.route.id]===void 0);if(j.route.lazy||W){p=!0,g>=0?u=u.slice(0,g+1):u=[u[0]];break}}}let y=t&&i?(w,j)=>{i(w,{location:t.location,params:t.matches?.[0]?.params??{},unstable_pattern:ZT(t.matches),errorInfo:j})}:void 0;return u.reduceRight((w,j,T)=>{let V,W=!1,F=null,U=null;t&&(V=d&&j.route.id?d[j.route.id]:void 0,F=j.route.errorElement||mE,p&&(g<0&&T===0?(z2("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),W=!0,U=null):g===T&&(W=!0,U=j.route.hydrateFallbackElement||null)));let ne=e.concat(u.slice(0,T+1)),Y=()=>{let oe;return V?oe=F:W?oe=U:j.route.Component?oe=v.createElement(j.route.Component,null):j.route.element?oe=j.route.element:oe=w,v.createElement(pE,{match:j,routeContext:{outlet:w,matches:ne,isDataRoute:t!=null},children:oe})};return t&&(j.route.ErrorBoundary||j.route.errorElement||T===0)?v.createElement(F2,{location:t.location,revalidation:t.revalidation,component:F,error:V,children:Y(),routeContext:{outlet:null,matches:ne,isDataRoute:!0},onError:y}):Y()},null)}function Og(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function yE(n){let e=v.useContext(tc);return on(e,Og(n)),e}function bE(n){let e=v.useContext(Yh);return on(e,Og(n)),e}function vE(n){let e=v.useContext(wa);return on(e,Og(n)),e}function Vg(n){let e=vE(n),t=e.matches[e.matches.length-1];return on(t.route.id,`${n} can only be used on routes that contain a unique "id"`),t.route.id}function xE(){return Vg("useRouteId")}function wE(){let n=v.useContext(Lg),e=bE("useRouteError"),t=Vg("useRouteError");return n!==void 0?n:e.errors?.[t]}function _E(){let{router:n}=yE("useNavigate"),e=Vg("useNavigate"),t=v.useRef(!1);return B2(()=>{t.current=!0}),v.useCallback(async(l,u={})=>{ra(t.current,V2),t.current&&(typeof l=="number"?await n.navigate(l):await n.navigate(l,{fromRouteId:e,...u}))},[n,e])}var D1={};function z2(n,e,t){!e&&!D1[n]&&(D1[n]=!0,ra(!1,t))}v.memo(kE);function kE({routes:n,future:e,state:t,onError:i}){return U2(n,void 0,t,i,e)}function jE({to:n,replace:e,state:t,relative:i}){on(sc(),"<Navigate> may be used only in the context of a <Router> component.");let{static:l}=v.useContext(Wr);ra(!l,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:u}=v.useContext(wa),{pathname:d}=_a(),p=$n(),g=Pg(n,Dg(u),d,i==="path"),y=JSON.stringify(g);return v.useEffect(()=>{p(JSON.parse(y),{replace:e,state:t,relative:i})},[p,y,i,e,t]),null}function Xs(n){on(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function TE({basename:n="/",children:e=null,location:t,navigationType:i="POP",navigator:l,static:u=!1,unstable_useTransitions:d}){on(!sc(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let p=n.replace(/^\/*/,"/"),g=v.useMemo(()=>({basename:p,navigator:l,static:u,unstable_useTransitions:d,future:{}}),[p,l,u,d]);typeof t=="string"&&(t=ec(t));let{pathname:y="/",search:w="",hash:j="",state:T=null,key:V="default"}=t,W=v.useMemo(()=>{let F=mi(y,p);return F==null?null:{location:{pathname:F,search:w,hash:j,state:T,key:V},navigationType:i}},[p,y,w,j,T,V,i]);return ra(W!=null,`<Router basename="${p}"> is not able to match the URL "${y}${w}${j}" because it does not start with the basename, so the <Router> won't render anything.`),W==null?null:v.createElement(Wr.Provider,{value:g},v.createElement(Nu.Provider,{children:e,value:W}))}function EE({children:n,location:e}){return dE(ng(n),e)}function ng(n,e=[]){let t=[];return v.Children.forEach(n,(i,l)=>{if(!v.isValidElement(i))return;let u=[...e,l];if(i.type===v.Fragment){t.push.apply(t,ng(i.props.children,u));return}on(i.type===Xs,`[${typeof i.type=="string"?i.type:i.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),on(!i.props.index||!i.props.children,"An index route cannot have child routes.");let d={id:i.props.id||u.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,middleware:i.props.middleware,loader:i.props.loader,action:i.props.action,hydrateFallbackElement:i.props.hydrateFallbackElement,HydrateFallback:i.props.HydrateFallback,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.hasErrorBoundary===!0||i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(d.children=ng(i.props.children,u)),t.push(d)}),t}var fh="get",ph="application/x-www-form-urlencoded";function Qh(n){return typeof HTMLElement<"u"&&n instanceof HTMLElement}function NE(n){return Qh(n)&&n.tagName.toLowerCase()==="button"}function SE(n){return Qh(n)&&n.tagName.toLowerCase()==="form"}function CE(n){return Qh(n)&&n.tagName.toLowerCase()==="input"}function RE(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function AE(n,e){return n.button===0&&(!e||e==="_self")&&!RE(n)}function rg(n=""){return new URLSearchParams(typeof n=="string"||Array.isArray(n)||n instanceof URLSearchParams?n:Object.keys(n).reduce((e,t)=>{let i=n[t];return e.concat(Array.isArray(i)?i.map(l=>[t,l]):[[t,i]])},[]))}function IE(n,e){let t=rg(n);return e&&e.forEach((i,l)=>{t.has(l)||e.getAll(l).forEach(u=>{t.append(l,u)})}),t}var Zd=null;function ME(){if(Zd===null)try{new FormData(document.createElement("form"),0),Zd=!1}catch{Zd=!0}return Zd}var DE=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function jp(n){return n!=null&&!DE.has(n)?(ra(!1,`"${n}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${ph}"`),null):n}function PE(n,e){let t,i,l,u,d;if(SE(n)){let p=n.getAttribute("action");i=p?mi(p,e):null,t=n.getAttribute("method")||fh,l=jp(n.getAttribute("enctype"))||ph,u=new FormData(n)}else if(NE(n)||CE(n)&&(n.type==="submit"||n.type==="image")){let p=n.form;if(p==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let g=n.getAttribute("formaction")||p.getAttribute("action");if(i=g?mi(g,e):null,t=n.getAttribute("formmethod")||p.getAttribute("method")||fh,l=jp(n.getAttribute("formenctype"))||jp(p.getAttribute("enctype"))||ph,u=new FormData(p,n),!ME()){let{name:y,type:w,value:j}=n;if(w==="image"){let T=y?`${y}.`:"";u.append(`${T}x`,"0"),u.append(`${T}y`,"0")}else y&&u.append(y,j)}}else{if(Qh(n))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=fh,i=null,l=ph,d=n}return u&&l==="text/plain"&&(d=u,u=void 0),{action:i,method:t.toLowerCase(),encType:l,formData:u,body:d}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function Bg(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function LE(n,e,t,i){let l=typeof n=="string"?new URL(n,typeof window>"u"?"server://singlefetch/":window.location.origin):n;return t?l.pathname.endsWith("/")?l.pathname=`${l.pathname}_.${i}`:l.pathname=`${l.pathname}.${i}`:l.pathname==="/"?l.pathname=`_root.${i}`:e&&mi(l.pathname,e)==="/"?l.pathname=`${e.replace(/\/$/,"")}/_root.${i}`:l.pathname=`${l.pathname.replace(/\/$/,"")}.${i}`,l}async function OE(n,e){if(n.id in e)return e[n.id];try{let t=await import(n.module);return e[n.id]=t,t}catch(t){return console.error(`Error loading route module \`${n.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function VE(n){return n==null?!1:n.href==null?n.rel==="preload"&&typeof n.imageSrcSet=="string"&&typeof n.imageSizes=="string":typeof n.rel=="string"&&typeof n.href=="string"}async function BE(n,e,t){let i=await Promise.all(n.map(async l=>{let u=e.routes[l.route.id];if(u){let d=await OE(u,t);return d.links?d.links():[]}return[]}));return qE(i.flat(1).filter(VE).filter(l=>l.rel==="stylesheet"||l.rel==="preload").map(l=>l.rel==="stylesheet"?{...l,rel:"prefetch",as:"style"}:{...l,rel:"prefetch"}))}function P1(n,e,t,i,l,u){let d=(g,y)=>t[y]?g.route.id!==t[y].route.id:!0,p=(g,y)=>t[y].pathname!==g.pathname||t[y].route.path?.endsWith("*")&&t[y].params["*"]!==g.params["*"];return u==="assets"?e.filter((g,y)=>d(g,y)||p(g,y)):u==="data"?e.filter((g,y)=>{let w=i.routes[g.route.id];if(!w||!w.hasLoader)return!1;if(d(g,y)||p(g,y))return!0;if(g.route.shouldRevalidate){let j=g.route.shouldRevalidate({currentUrl:new URL(l.pathname+l.search+l.hash,window.origin),currentParams:t[0]?.params||{},nextUrl:new URL(n,window.origin),nextParams:g.params,defaultShouldRevalidate:!0});if(typeof j=="boolean")return j}return!0}):[]}function UE(n,e,{includeHydrateFallback:t}={}){return FE(n.map(i=>{let l=e.routes[i.route.id];if(!l)return[];let u=[l.module];return l.clientActionModule&&(u=u.concat(l.clientActionModule)),l.clientLoaderModule&&(u=u.concat(l.clientLoaderModule)),t&&l.hydrateFallbackModule&&(u=u.concat(l.hydrateFallbackModule)),l.imports&&(u=u.concat(l.imports)),u}).flat(1))}function FE(n){return[...new Set(n)]}function zE(n){let e={},t=Object.keys(n).sort();for(let i of t)e[i]=n[i];return e}function qE(n,e){let t=new Set;return new Set(e),n.reduce((i,l)=>{let u=JSON.stringify(zE(l));return t.has(u)||(t.add(u),i.push({key:u,link:l})),i},[])}function q2(){let n=v.useContext(tc);return Bg(n,"You must render this element inside a <DataRouterContext.Provider> element"),n}function HE(){let n=v.useContext(Yh);return Bg(n,"You must render this element inside a <DataRouterStateContext.Provider> element"),n}var Ug=v.createContext(void 0);Ug.displayName="FrameworkContext";function H2(){let n=v.useContext(Ug);return Bg(n,"You must render this element inside a <HydratedRouter> element"),n}function $E(n,e){let t=v.useContext(Ug),[i,l]=v.useState(!1),[u,d]=v.useState(!1),{onFocus:p,onBlur:g,onMouseEnter:y,onMouseLeave:w,onTouchStart:j}=e,T=v.useRef(null);v.useEffect(()=>{if(n==="render"&&d(!0),n==="viewport"){let F=ne=>{ne.forEach(Y=>{d(Y.isIntersecting)})},U=new IntersectionObserver(F,{threshold:.5});return T.current&&U.observe(T.current),()=>{U.disconnect()}}},[n]),v.useEffect(()=>{if(i){let F=setTimeout(()=>{d(!0)},100);return()=>{clearTimeout(F)}}},[i]);let V=()=>{l(!0)},W=()=>{l(!1),d(!1)};return t?n!=="intent"?[u,T,{}]:[u,T,{onFocus:Gc(p,V),onBlur:Gc(g,W),onMouseEnter:Gc(y,V),onMouseLeave:Gc(w,W),onTouchStart:Gc(j,V)}]:[!1,T,{}]}function Gc(n,e){return t=>{n&&n(t),t.defaultPrevented||e(t)}}function WE({page:n,...e}){let{router:t}=q2(),i=v.useMemo(()=>R2(t.routes,n,t.basename),[t.routes,n,t.basename]);return i?v.createElement(KE,{page:n,matches:i,...e}):null}function GE(n){let{manifest:e,routeModules:t}=H2(),[i,l]=v.useState([]);return v.useEffect(()=>{let u=!1;return BE(n,e,t).then(d=>{u||l(d)}),()=>{u=!0}},[n,e,t]),i}function KE({page:n,matches:e,...t}){let i=_a(),{future:l,manifest:u,routeModules:d}=H2(),{basename:p}=q2(),{loaderData:g,matches:y}=HE(),w=v.useMemo(()=>P1(n,e,y,u,i,"data"),[n,e,y,u,i]),j=v.useMemo(()=>P1(n,e,y,u,i,"assets"),[n,e,y,u,i]),T=v.useMemo(()=>{if(n===i.pathname+i.search+i.hash)return[];let F=new Set,U=!1;if(e.forEach(Y=>{let oe=u.routes[Y.route.id];!oe||!oe.hasLoader||(!w.some(be=>be.route.id===Y.route.id)&&Y.route.id in g&&d[Y.route.id]?.shouldRevalidate||oe.hasClientLoader?U=!0:F.add(Y.route.id))}),F.size===0)return[];let ne=LE(n,p,l.unstable_trailingSlashAwareDataRequests,"data");return U&&F.size>0&&ne.searchParams.set("_routes",e.filter(Y=>F.has(Y.route.id)).map(Y=>Y.route.id).join(",")),[ne.pathname+ne.search]},[p,l.unstable_trailingSlashAwareDataRequests,g,i,u,w,e,n,d]),V=v.useMemo(()=>UE(j,u),[j,u]),W=GE(j);return v.createElement(v.Fragment,null,T.map(F=>v.createElement("link",{key:F,rel:"prefetch",as:"fetch",href:F,...t})),V.map(F=>v.createElement("link",{key:F,rel:"modulepreload",href:F,...t})),W.map(({key:F,link:U})=>v.createElement("link",{key:F,nonce:t.nonce,...U,crossOrigin:U.crossOrigin??t.crossOrigin})))}function YE(...n){return e=>{n.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var QE=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{QE&&(window.__reactRouterVersion="7.13.0")}catch{}function XE({basename:n,children:e,unstable_useTransitions:t,window:i}){let l=v.useRef();l.current==null&&(l.current=ST({window:i,v5Compat:!0}));let u=l.current,[d,p]=v.useState({action:u.action,location:u.location}),g=v.useCallback(y=>{t===!1?p(y):v.startTransition(()=>p(y))},[t]);return v.useLayoutEffect(()=>u.listen(g),[u,g]),v.createElement(TE,{basename:n,children:e,location:d.location,navigationType:d.action,navigator:u,unstable_useTransitions:t})}var $2=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,W2=v.forwardRef(function({onClick:e,discover:t="render",prefetch:i="none",relative:l,reloadDocument:u,replace:d,state:p,target:g,to:y,preventScrollReset:w,viewTransition:j,unstable_defaultShouldRevalidate:T,...V},W){let{basename:F,unstable_useTransitions:U}=v.useContext(Wr),ne=typeof y=="string"&&$2.test(y),Y=D2(y,F);y=Y.to;let oe=lE(y,{relative:l}),[be,Le,Ce]=$E(i,V),R=tN(y,{replace:d,state:p,target:g,preventScrollReset:w,relative:l,viewTransition:j,unstable_defaultShouldRevalidate:T,unstable_useTransitions:U});function E(O){e&&e(O),O.defaultPrevented||R(O)}let A=v.createElement("a",{...V,...Ce,href:Y.absoluteURL||oe,onClick:Y.isExternal||u?e:E,ref:YE(W,Le),target:g,"data-discover":!ne&&t==="render"?"true":void 0});return be&&!ne?v.createElement(v.Fragment,null,A,v.createElement(WE,{page:oe})):A});W2.displayName="Link";var JE=v.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:i="",end:l=!1,style:u,to:d,viewTransition:p,children:g,...y},w){let j=Su(d,{relative:y.relative}),T=_a(),V=v.useContext(Yh),{navigator:W,basename:F}=v.useContext(Wr),U=V!=null&&oN(j)&&p===!0,ne=W.encodeLocation?W.encodeLocation(j).pathname:j.pathname,Y=T.pathname,oe=V&&V.navigation&&V.navigation.location?V.navigation.location.pathname:null;t||(Y=Y.toLowerCase(),oe=oe?oe.toLowerCase():null,ne=ne.toLowerCase()),oe&&F&&(oe=mi(oe,F)||oe);const be=ne!=="/"&&ne.endsWith("/")?ne.length-1:ne.length;let Le=Y===ne||!l&&Y.startsWith(ne)&&Y.charAt(be)==="/",Ce=oe!=null&&(oe===ne||!l&&oe.startsWith(ne)&&oe.charAt(ne.length)==="/"),R={isActive:Le,isPending:Ce,isTransitioning:U},E=Le?e:void 0,A;typeof i=="function"?A=i(R):A=[i,Le?"active":null,Ce?"pending":null,U?"transitioning":null].filter(Boolean).join(" ");let O=typeof u=="function"?u(R):u;return v.createElement(W2,{...y,"aria-current":E,className:A,ref:w,style:O,to:d,viewTransition:p},typeof g=="function"?g(R):g)});JE.displayName="NavLink";var ZE=v.forwardRef(({discover:n="render",fetcherKey:e,navigate:t,reloadDocument:i,replace:l,state:u,method:d=fh,action:p,onSubmit:g,relative:y,preventScrollReset:w,viewTransition:j,unstable_defaultShouldRevalidate:T,...V},W)=>{let{unstable_useTransitions:F}=v.useContext(Wr),U=aN(),ne=iN(p,{relative:y}),Y=d.toLowerCase()==="get"?"get":"post",oe=typeof p=="string"&&$2.test(p),be=Le=>{if(g&&g(Le),Le.defaultPrevented)return;Le.preventDefault();let Ce=Le.nativeEvent.submitter,R=Ce?.getAttribute("formmethod")||d,E=()=>U(Ce||Le.currentTarget,{fetcherKey:e,method:R,navigate:t,replace:l,state:u,relative:y,preventScrollReset:w,viewTransition:j,unstable_defaultShouldRevalidate:T});F&&t!==!1?v.startTransition(()=>E()):E()};return v.createElement("form",{ref:W,method:Y,action:ne,onSubmit:i?g:be,...V,"data-discover":!oe&&n==="render"?"true":void 0})});ZE.displayName="Form";function eN(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function G2(n){let e=v.useContext(tc);return on(e,eN(n)),e}function tN(n,{target:e,replace:t,state:i,preventScrollReset:l,relative:u,viewTransition:d,unstable_defaultShouldRevalidate:p,unstable_useTransitions:g}={}){let y=$n(),w=_a(),j=Su(n,{relative:u});return v.useCallback(T=>{if(AE(T,e)){T.preventDefault();let V=t!==void 0?t:fu(w)===fu(j),W=()=>y(n,{replace:V,state:i,preventScrollReset:l,relative:u,viewTransition:d,unstable_defaultShouldRevalidate:p});g?v.startTransition(()=>W()):W()}},[w,y,j,t,i,e,n,l,u,d,p,g])}function sN(n){ra(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let e=v.useRef(rg(n)),t=v.useRef(!1),i=_a(),l=v.useMemo(()=>IE(i.search,t.current?null:e.current),[i.search]),u=$n(),d=v.useCallback((p,g)=>{const y=rg(typeof p=="function"?p(new URLSearchParams(l)):p);t.current=!0,u("?"+y,g)},[u,l]);return[l,d]}var nN=0,rN=()=>`__${String(++nN)}__`;function aN(){let{router:n}=G2("useSubmit"),{basename:e}=v.useContext(Wr),t=xE(),i=n.fetch,l=n.navigate;return v.useCallback(async(u,d={})=>{let{action:p,method:g,encType:y,formData:w,body:j}=PE(u,e);if(d.navigate===!1){let T=d.fetcherKey||rN();await i(T,t,d.action||p,{unstable_defaultShouldRevalidate:d.unstable_defaultShouldRevalidate,preventScrollReset:d.preventScrollReset,formData:w,body:j,formMethod:d.method||g,formEncType:d.encType||y,flushSync:d.flushSync})}else await l(d.action||p,{unstable_defaultShouldRevalidate:d.unstable_defaultShouldRevalidate,preventScrollReset:d.preventScrollReset,formData:w,body:j,formMethod:d.method||g,formEncType:d.encType||y,replace:d.replace,state:d.state,fromRouteId:t,flushSync:d.flushSync,viewTransition:d.viewTransition})},[i,l,e,t])}function iN(n,{relative:e}={}){let{basename:t}=v.useContext(Wr),i=v.useContext(wa);on(i,"useFormAction must be used inside a RouteContext");let[l]=i.matches.slice(-1),u={...Su(n||".",{relative:e})},d=_a();if(n==null){u.search=d.search;let p=new URLSearchParams(u.search),g=p.getAll("index");if(g.some(w=>w==="")){p.delete("index"),g.filter(j=>j).forEach(j=>p.append("index",j));let w=p.toString();u.search=w?`?${w}`:""}}return(!n||n===".")&&l.route.index&&(u.search=u.search?u.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(u.pathname=u.pathname==="/"?t:ci([t,u.pathname])),fu(u)}function oN(n,{relative:e}={}){let t=v.useContext(L2);on(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:i}=G2("useViewTransitionState"),l=Su(n,{relative:e});if(!t.isTransitioning)return!1;let u=mi(t.currentLocation.pathname,i)||t.currentLocation.pathname,d=mi(t.nextLocation.pathname,i)||t.nextLocation.pathname;return Eh(l.pathname,d)!=null||Eh(l.pathname,u)!=null}const lN=()=>{};var L1={};const K2=function(n){const e=[];let t=0;for(let i=0;i<n.length;i++){let l=n.charCodeAt(i);l<128?e[t++]=l:l<2048?(e[t++]=l>>6|192,e[t++]=l&63|128):(l&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(l=65536+((l&1023)<<10)+(n.charCodeAt(++i)&1023),e[t++]=l>>18|240,e[t++]=l>>12&63|128,e[t++]=l>>6&63|128,e[t++]=l&63|128):(e[t++]=l>>12|224,e[t++]=l>>6&63|128,e[t++]=l&63|128)}return e},cN=function(n){const e=[];let t=0,i=0;for(;t<n.length;){const l=n[t++];if(l<128)e[i++]=String.fromCharCode(l);else if(l>191&&l<224){const u=n[t++];e[i++]=String.fromCharCode((l&31)<<6|u&63)}else if(l>239&&l<365){const u=n[t++],d=n[t++],p=n[t++],g=((l&7)<<18|(u&63)<<12|(d&63)<<6|p&63)-65536;e[i++]=String.fromCharCode(55296+(g>>10)),e[i++]=String.fromCharCode(56320+(g&1023))}else{const u=n[t++],d=n[t++];e[i++]=String.fromCharCode((l&15)<<12|(u&63)<<6|d&63)}}return e.join("")},Y2={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let l=0;l<n.length;l+=3){const u=n[l],d=l+1<n.length,p=d?n[l+1]:0,g=l+2<n.length,y=g?n[l+2]:0,w=u>>2,j=(u&3)<<4|p>>4;let T=(p&15)<<2|y>>6,V=y&63;g||(V=64,d||(T=64)),i.push(t[w],t[j],t[T],t[V])}return i.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(K2(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):cN(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let l=0;l<n.length;){const u=t[n.charAt(l++)],p=l<n.length?t[n.charAt(l)]:0;++l;const y=l<n.length?t[n.charAt(l)]:64;++l;const j=l<n.length?t[n.charAt(l)]:64;if(++l,u==null||p==null||y==null||j==null)throw new uN;const T=u<<2|p>>4;if(i.push(T),y!==64){const V=p<<4&240|y>>2;if(i.push(V),j!==64){const W=y<<6&192|j;i.push(W)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class uN extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const dN=function(n){const e=K2(n);return Y2.encodeByteArray(e,!0)},Nh=function(n){return dN(n).replace(/\./g,"")},Q2=function(n){try{return Y2.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function hN(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const mN=()=>hN().__FIREBASE_DEFAULTS__,fN=()=>{if(typeof process>"u"||typeof L1>"u")return;const n=L1.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},pN=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&Q2(n[1]);return e&&JSON.parse(e)},Xh=()=>{try{return lN()||mN()||fN()||pN()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},X2=n=>Xh()?.emulatorHosts?.[n],J2=n=>{const e=X2(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),i]:[e.substring(0,t),i]},Z2=()=>Xh()?.config,ew=n=>Xh()?.[`_${n}`];class gN{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}}function fo(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Fg(n){return(await fetch(n,{credentials:"include"})).ok}function tw(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},i=e||"demo-project",l=n.iat||0,u=n.sub||n.user_id;if(!u)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const d={iss:`https://securetoken.google.com/${i}`,aud:i,iat:l,exp:l+3600,auth_time:l,sub:u,user_id:u,firebase:{sign_in_provider:"custom",identities:{}},...n};return[Nh(JSON.stringify(t)),Nh(JSON.stringify(d)),""].join(".")}const au={};function yN(){const n={prod:[],emulator:[]};for(const e of Object.keys(au))au[e]?n.emulator.push(e):n.prod.push(e);return n}function bN(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let O1=!1;function zg(n,e){if(typeof window>"u"||typeof document>"u"||!fo(window.location.host)||au[n]===e||au[n]||O1)return;au[n]=e;function t(T){return`__firebase__banner__${T}`}const i="__firebase__banner",u=yN().prod.length>0;function d(){const T=document.getElementById(i);T&&T.remove()}function p(T){T.style.display="flex",T.style.background="#7faaf0",T.style.position="fixed",T.style.bottom="5px",T.style.left="5px",T.style.padding=".5em",T.style.borderRadius="5px",T.style.alignItems="center"}function g(T,V){T.setAttribute("width","24"),T.setAttribute("id",V),T.setAttribute("height","24"),T.setAttribute("viewBox","0 0 24 24"),T.setAttribute("fill","none"),T.style.marginLeft="-6px"}function y(){const T=document.createElement("span");return T.style.cursor="pointer",T.style.marginLeft="16px",T.style.fontSize="24px",T.innerHTML=" &times;",T.onclick=()=>{O1=!0,d()},T}function w(T,V){T.setAttribute("id",V),T.innerText="Learn more",T.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",T.setAttribute("target","__blank"),T.style.paddingLeft="5px",T.style.textDecoration="underline"}function j(){const T=bN(i),V=t("text"),W=document.getElementById(V)||document.createElement("span"),F=t("learnmore"),U=document.getElementById(F)||document.createElement("a"),ne=t("preprendIcon"),Y=document.getElementById(ne)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(T.created){const oe=T.element;p(oe),w(U,F);const be=y();g(Y,ne),oe.append(Y,W,U,be),document.body.appendChild(oe)}u?(W.innerText="Preview backend disconnected.",Y.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(Y.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,W.innerText="Preview backend running in this workspace."),W.setAttribute("id",V)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",j):j()}function cr(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function vN(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(cr())}function xN(){const n=Xh()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function wN(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function _N(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function kN(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function jN(){const n=cr();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function TN(){return!xN()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function EN(){try{return typeof indexedDB=="object"}catch{return!1}}function NN(){return new Promise((n,e)=>{try{let t=!0;const i="validate-browser-context-for-indexeddb-analytics-module",l=self.indexedDB.open(i);l.onsuccess=()=>{l.result.close(),t||self.indexedDB.deleteDatabase(i),n(!0)},l.onupgradeneeded=()=>{t=!1},l.onerror=()=>{e(l.error?.message||"")}}catch(t){e(t)}})}const SN="FirebaseError";class qa extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=SN,Object.setPrototypeOf(this,qa.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Cu.prototype.create)}}class Cu{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){const i=t[0]||{},l=`${this.service}/${e}`,u=this.errors[e],d=u?CN(u,i):"Error",p=`${this.serviceName}: ${d} (${l}).`;return new qa(l,p,i)}}function CN(n,e){return n.replace(RN,(t,i)=>{const l=e[i];return l!=null?String(l):`<${i}?>`})}const RN=/\{\$([^}]+)}/g;function AN(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Ho(n,e){if(n===e)return!0;const t=Object.keys(n),i=Object.keys(e);for(const l of t){if(!i.includes(l))return!1;const u=n[l],d=e[l];if(V1(u)&&V1(d)){if(!Ho(u,d))return!1}else if(u!==d)return!1}for(const l of i)if(!t.includes(l))return!1;return!0}function V1(n){return n!==null&&typeof n=="object"}function Ru(n){const e=[];for(const[t,i]of Object.entries(n))Array.isArray(i)?i.forEach(l=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(l))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function Zc(n){const e={};return n.replace(/^\?/,"").split("&").forEach(i=>{if(i){const[l,u]=i.split("=");e[decodeURIComponent(l)]=decodeURIComponent(u)}}),e}function eu(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function IN(n,e){const t=new MN(n,e);return t.subscribe.bind(t)}class MN{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,i){let l;if(e===void 0&&t===void 0&&i===void 0)throw new Error("Missing Observer.");DN(e,["next","error","complete"])?l=e:l={next:e,error:t,complete:i},l.next===void 0&&(l.next=Tp),l.error===void 0&&(l.error=Tp),l.complete===void 0&&(l.complete=Tp);const u=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?l.error(this.finalError):l.complete()}catch{}}),this.observers.push(l),u}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function DN(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Tp(){}function Gs(n){return n&&n._delegate?n._delegate:n}class io{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const Oo="[DEFAULT]";class PN{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const i=new gN;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{const l=this.getOrInitializeService({instanceIdentifier:t});l&&i.resolve(l)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),i=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(l){if(i)return null;throw l}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(ON(e))try{this.getOrInitializeService({instanceIdentifier:Oo})}catch{}for(const[t,i]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(t);try{const u=this.getOrInitializeService({instanceIdentifier:l});i.resolve(u)}catch{}}}}clearInstance(e=Oo){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Oo){return this.instances.has(e)}getOptions(e=Oo){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const l=this.getOrInitializeService({instanceIdentifier:i,options:t});for(const[u,d]of this.instancesDeferred.entries()){const p=this.normalizeInstanceIdentifier(u);i===p&&d.resolve(l)}return l}onInit(e,t){const i=this.normalizeInstanceIdentifier(t),l=this.onInitCallbacks.get(i)??new Set;l.add(e),this.onInitCallbacks.set(i,l);const u=this.instances.get(i);return u&&e(u,i),()=>{l.delete(e)}}invokeOnInitCallbacks(e,t){const i=this.onInitCallbacks.get(t);if(i)for(const l of i)try{l(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:LN(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=Oo){return this.component?this.component.multipleInstances?e:Oo:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function LN(n){return n===Oo?void 0:n}function ON(n){return n.instantiationMode==="EAGER"}class VN{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new PN(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}var gs;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(gs||(gs={}));const BN={debug:gs.DEBUG,verbose:gs.VERBOSE,info:gs.INFO,warn:gs.WARN,error:gs.ERROR,silent:gs.SILENT},UN=gs.INFO,FN={[gs.DEBUG]:"log",[gs.VERBOSE]:"log",[gs.INFO]:"info",[gs.WARN]:"warn",[gs.ERROR]:"error"},zN=(n,e,...t)=>{if(e<n.logLevel)return;const i=new Date().toISOString(),l=FN[e];if(l)console[l](`[${i}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class qg{constructor(e){this.name=e,this._logLevel=UN,this._logHandler=zN,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in gs))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?BN[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,gs.DEBUG,...e),this._logHandler(this,gs.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,gs.VERBOSE,...e),this._logHandler(this,gs.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,gs.INFO,...e),this._logHandler(this,gs.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,gs.WARN,...e),this._logHandler(this,gs.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,gs.ERROR,...e),this._logHandler(this,gs.ERROR,...e)}}const qN=(n,e)=>e.some(t=>n instanceof t);let B1,U1;function HN(){return B1||(B1=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function $N(){return U1||(U1=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const sw=new WeakMap,ag=new WeakMap,nw=new WeakMap,Ep=new WeakMap,Hg=new WeakMap;function WN(n){const e=new Promise((t,i)=>{const l=()=>{n.removeEventListener("success",u),n.removeEventListener("error",d)},u=()=>{t(so(n.result)),l()},d=()=>{i(n.error),l()};n.addEventListener("success",u),n.addEventListener("error",d)});return e.then(t=>{t instanceof IDBCursor&&sw.set(t,n)}).catch(()=>{}),Hg.set(e,n),e}function GN(n){if(ag.has(n))return;const e=new Promise((t,i)=>{const l=()=>{n.removeEventListener("complete",u),n.removeEventListener("error",d),n.removeEventListener("abort",d)},u=()=>{t(),l()},d=()=>{i(n.error||new DOMException("AbortError","AbortError")),l()};n.addEventListener("complete",u),n.addEventListener("error",d),n.addEventListener("abort",d)});ag.set(n,e)}let ig={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return ag.get(n);if(e==="objectStoreNames")return n.objectStoreNames||nw.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return so(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function KN(n){ig=n(ig)}function YN(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const i=n.call(Np(this),e,...t);return nw.set(i,e.sort?e.sort():[e]),so(i)}:$N().includes(n)?function(...e){return n.apply(Np(this),e),so(sw.get(this))}:function(...e){return so(n.apply(Np(this),e))}}function QN(n){return typeof n=="function"?YN(n):(n instanceof IDBTransaction&&GN(n),qN(n,HN())?new Proxy(n,ig):n)}function so(n){if(n instanceof IDBRequest)return WN(n);if(Ep.has(n))return Ep.get(n);const e=QN(n);return e!==n&&(Ep.set(n,e),Hg.set(e,n)),e}const Np=n=>Hg.get(n);function XN(n,e,{blocked:t,upgrade:i,blocking:l,terminated:u}={}){const d=indexedDB.open(n,e),p=so(d);return i&&d.addEventListener("upgradeneeded",g=>{i(so(d.result),g.oldVersion,g.newVersion,so(d.transaction),g)}),t&&d.addEventListener("blocked",g=>t(g.oldVersion,g.newVersion,g)),p.then(g=>{u&&g.addEventListener("close",()=>u()),l&&g.addEventListener("versionchange",y=>l(y.oldVersion,y.newVersion,y))}).catch(()=>{}),p}const JN=["get","getKey","getAll","getAllKeys","count"],ZN=["put","add","delete","clear"],Sp=new Map;function F1(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Sp.get(e))return Sp.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,l=ZN.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(l||JN.includes(t)))return;const u=async function(d,...p){const g=this.transaction(d,l?"readwrite":"readonly");let y=g.store;return i&&(y=y.index(p.shift())),(await Promise.all([y[t](...p),l&&g.done]))[0]};return Sp.set(e,u),u}KN(n=>({...n,get:(e,t,i)=>F1(e,t)||n.get(e,t,i),has:(e,t)=>!!F1(e,t)||n.has(e,t)}));class eS{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(tS(t)){const i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}}function tS(n){return n.getComponent()?.type==="VERSION"}const og="@firebase/app",z1="0.14.7";const fi=new qg("@firebase/app"),sS="@firebase/app-compat",nS="@firebase/analytics-compat",rS="@firebase/analytics",aS="@firebase/app-check-compat",iS="@firebase/app-check",oS="@firebase/auth",lS="@firebase/auth-compat",cS="@firebase/database",uS="@firebase/data-connect",dS="@firebase/database-compat",hS="@firebase/functions",mS="@firebase/functions-compat",fS="@firebase/installations",pS="@firebase/installations-compat",gS="@firebase/messaging",yS="@firebase/messaging-compat",bS="@firebase/performance",vS="@firebase/performance-compat",xS="@firebase/remote-config",wS="@firebase/remote-config-compat",_S="@firebase/storage",kS="@firebase/storage-compat",jS="@firebase/firestore",TS="@firebase/ai",ES="@firebase/firestore-compat",NS="firebase",SS="12.8.0";const lg="[DEFAULT]",CS={[og]:"fire-core",[sS]:"fire-core-compat",[rS]:"fire-analytics",[nS]:"fire-analytics-compat",[iS]:"fire-app-check",[aS]:"fire-app-check-compat",[oS]:"fire-auth",[lS]:"fire-auth-compat",[cS]:"fire-rtdb",[uS]:"fire-data-connect",[dS]:"fire-rtdb-compat",[hS]:"fire-fn",[mS]:"fire-fn-compat",[fS]:"fire-iid",[pS]:"fire-iid-compat",[gS]:"fire-fcm",[yS]:"fire-fcm-compat",[bS]:"fire-perf",[vS]:"fire-perf-compat",[xS]:"fire-rc",[wS]:"fire-rc-compat",[_S]:"fire-gcs",[kS]:"fire-gcs-compat",[jS]:"fire-fst",[ES]:"fire-fst-compat",[TS]:"fire-vertex","fire-js":"fire-js",[NS]:"fire-js-all"};const Sh=new Map,RS=new Map,cg=new Map;function q1(n,e){try{n.container.addComponent(e)}catch(t){fi.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function $o(n){const e=n.name;if(cg.has(e))return fi.debug(`There were multiple attempts to register component ${e}.`),!1;cg.set(e,n);for(const t of Sh.values())q1(t,n);for(const t of RS.values())q1(t,n);return!0}function Jh(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function qr(n){return n==null?!1:n.settings!==void 0}const AS={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},no=new Cu("app","Firebase",AS);class IS{constructor(e,t,i){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new io("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw no.create("app-deleted",{appName:this._name})}}const Jo=SS;function $g(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const i={name:lg,automaticDataCollectionEnabled:!0,...e},l=i.name;if(typeof l!="string"||!l)throw no.create("bad-app-name",{appName:String(l)});if(t||(t=Z2()),!t)throw no.create("no-options");const u=Sh.get(l);if(u){if(Ho(t,u.options)&&Ho(i,u.config))return u;throw no.create("duplicate-app",{appName:l})}const d=new VN(l);for(const g of cg.values())d.addComponent(g);const p=new IS(t,i,d);return Sh.set(l,p),p}function Wg(n=lg){const e=Sh.get(n);if(!e&&n===lg&&Z2())return $g();if(!e)throw no.create("no-app",{appName:n});return e}function Pa(n,e,t){let i=CS[n]??n;t&&(i+=`-${t}`);const l=i.match(/\s|\//),u=e.match(/\s|\//);if(l||u){const d=[`Unable to register library "${i}" with version "${e}":`];l&&d.push(`library name "${i}" contains illegal characters (whitespace or "/")`),l&&u&&d.push("and"),u&&d.push(`version name "${e}" contains illegal characters (whitespace or "/")`),fi.warn(d.join(" "));return}$o(new io(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}const MS="firebase-heartbeat-database",DS=1,pu="firebase-heartbeat-store";let Cp=null;function rw(){return Cp||(Cp=XN(MS,DS,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(pu)}catch(t){console.warn(t)}}}}).catch(n=>{throw no.create("idb-open",{originalErrorMessage:n.message})})),Cp}async function PS(n){try{const t=(await rw()).transaction(pu),i=await t.objectStore(pu).get(aw(n));return await t.done,i}catch(e){if(e instanceof qa)fi.warn(e.message);else{const t=no.create("idb-get",{originalErrorMessage:e?.message});fi.warn(t.message)}}}async function H1(n,e){try{const i=(await rw()).transaction(pu,"readwrite");await i.objectStore(pu).put(e,aw(n)),await i.done}catch(t){if(t instanceof qa)fi.warn(t.message);else{const i=no.create("idb-set",{originalErrorMessage:t?.message});fi.warn(i.message)}}}function aw(n){return`${n.name}!${n.options.appId}`}const LS=1024,OS=30;class VS{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new US(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=$1();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(l=>l.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:t}),this._heartbeatsCache.heartbeats.length>OS){const l=FS(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(l,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){fi.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=$1(),{heartbeatsToSend:t,unsentEntries:i}=BS(this._heartbeatsCache.heartbeats),l=Nh(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),l}catch(e){return fi.warn(e),""}}}function $1(){return new Date().toISOString().substring(0,10)}function BS(n,e=LS){const t=[];let i=n.slice();for(const l of n){const u=t.find(d=>d.agent===l.agent);if(u){if(u.dates.push(l.date),W1(t)>e){u.dates.pop();break}}else if(t.push({agent:l.agent,dates:[l.date]}),W1(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}class US{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return EN()?NN().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await PS(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return H1(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return H1(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function W1(n){return Nh(JSON.stringify({version:2,heartbeats:n})).length}function FS(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let i=1;i<n.length;i++)n[i].date<t&&(t=n[i].date,e=i);return e}function zS(n){$o(new io("platform-logger",e=>new eS(e),"PRIVATE")),$o(new io("heartbeat",e=>new VS(e),"PRIVATE")),Pa(og,z1,n),Pa(og,z1,"esm2020"),Pa("fire-js","")}zS("");function iw(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const qS=iw,ow=new Cu("auth","Firebase",iw());const Ch=new qg("@firebase/auth");function HS(n,...e){Ch.logLevel<=gs.WARN&&Ch.warn(`Auth (${Jo}): ${n}`,...e)}function gh(n,...e){Ch.logLevel<=gs.ERROR&&Ch.error(`Auth (${Jo}): ${n}`,...e)}function ba(n,...e){throw Gg(n,...e)}function La(n,...e){return Gg(n,...e)}function lw(n,e,t){const i={...qS(),[e]:t};return new Cu("auth","Firebase",i).create(e,{appName:n.name})}function ui(n){return lw(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Gg(n,...e){if(typeof n!="string"){const t=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=n.name),n._errorFactory.create(t,...i)}return ow.create(n,...e)}function Pt(n,e,...t){if(!n)throw Gg(e,...t)}function oi(n){const e="INTERNAL ASSERTION FAILED: "+n;throw gh(e),new Error(e)}function pi(n,e){n||oi(e)}function ug(){return typeof self<"u"&&self.location?.href||""}function $S(){return G1()==="http:"||G1()==="https:"}function G1(){return typeof self<"u"&&self.location?.protocol||null}function WS(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&($S()||_N()||"connection"in navigator)?navigator.onLine:!0}function GS(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}class Au{constructor(e,t){this.shortDelay=e,this.longDelay=t,pi(t>e,"Short delay should be less than long delay!"),this.isMobile=vN()||kN()}get(){return WS()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function Kg(n,e){pi(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class cw{static initialize(e,t,i){this.fetchImpl=e,t&&(this.headersImpl=t),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;oi("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;oi("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;oi("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const KS={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const YS=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],QS=new Au(3e4,6e4);function bi(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function vi(n,e,t,i,l={}){return uw(n,l,async()=>{let u={},d={};i&&(e==="GET"?d=i:u={body:JSON.stringify(i)});const p=Ru({key:n.config.apiKey,...d}).slice(1),g=await n._getAdditionalHeaders();g["Content-Type"]="application/json",n.languageCode&&(g["X-Firebase-Locale"]=n.languageCode);const y={method:e,headers:g,...u};return wN()||(y.referrerPolicy="no-referrer"),n.emulatorConfig&&fo(n.emulatorConfig.host)&&(y.credentials="include"),cw.fetch()(await dw(n,n.config.apiHost,t,p),y)})}async function uw(n,e,t){n._canInitEmulator=!1;const i={...KS,...e};try{const l=new JS(n),u=await Promise.race([t(),l.promise]);l.clearNetworkTimeout();const d=await u.json();if("needConfirmation"in d)throw eh(n,"account-exists-with-different-credential",d);if(u.ok&&!("errorMessage"in d))return d;{const p=u.ok?d.errorMessage:d.error.message,[g,y]=p.split(" : ");if(g==="FEDERATED_USER_ID_ALREADY_LINKED")throw eh(n,"credential-already-in-use",d);if(g==="EMAIL_EXISTS")throw eh(n,"email-already-in-use",d);if(g==="USER_DISABLED")throw eh(n,"user-disabled",d);const w=i[g]||g.toLowerCase().replace(/[_\s]+/g,"-");if(y)throw lw(n,w,y);ba(n,w)}}catch(l){if(l instanceof qa)throw l;ba(n,"network-request-failed",{message:String(l)})}}async function Iu(n,e,t,i,l={}){const u=await vi(n,e,t,i,l);return"mfaPendingCredential"in u&&ba(n,"multi-factor-auth-required",{_serverResponse:u}),u}async function dw(n,e,t,i){const l=`${e}${t}?${i}`,u=n,d=u.config.emulator?Kg(n.config,l):`${n.config.apiScheme}://${l}`;return YS.includes(t)&&(await u._persistenceManagerAvailable,u._getPersistenceType()==="COOKIE")?u._getPersistence()._getFinalTarget(d).toString():d}function XS(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class JS{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,i)=>{this.timer=setTimeout(()=>i(La(this.auth,"network-request-failed")),QS.get())})}}function eh(n,e,t){const i={appName:n.name};t.email&&(i.email=t.email),t.phoneNumber&&(i.phoneNumber=t.phoneNumber);const l=La(n,e,i);return l.customData._tokenResponse=t,l}function K1(n){return n!==void 0&&n.enterprise!==void 0}class ZS{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return XS(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function eC(n,e){return vi(n,"GET","/v2/recaptchaConfig",bi(n,e))}async function tC(n,e){return vi(n,"POST","/v1/accounts:delete",e)}async function Rh(n,e){return vi(n,"POST","/v1/accounts:lookup",e)}function iu(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function sC(n,e=!1){const t=Gs(n),i=await t.getIdToken(e),l=Yg(i);Pt(l&&l.exp&&l.auth_time&&l.iat,t.auth,"internal-error");const u=typeof l.firebase=="object"?l.firebase:void 0,d=u?.sign_in_provider;return{claims:l,token:i,authTime:iu(Rp(l.auth_time)),issuedAtTime:iu(Rp(l.iat)),expirationTime:iu(Rp(l.exp)),signInProvider:d||null,signInSecondFactor:u?.sign_in_second_factor||null}}function Rp(n){return Number(n)*1e3}function Yg(n){const[e,t,i]=n.split(".");if(e===void 0||t===void 0||i===void 0)return gh("JWT malformed, contained fewer than 3 sections"),null;try{const l=Q2(t);return l?JSON.parse(l):(gh("Failed to decode base64 JWT payload"),null)}catch(l){return gh("Caught error parsing JWT payload as JSON",l?.toString()),null}}function Y1(n){const e=Yg(n);return Pt(e,"internal-error"),Pt(typeof e.exp<"u","internal-error"),Pt(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function gu(n,e,t=!1){if(t)return e;try{return await e}catch(i){throw i instanceof qa&&nC(i)&&n.auth.currentUser===n&&await n.auth.signOut(),i}}function nC({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}class rC{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const i=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class dg{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=iu(this.lastLoginAt),this.creationTime=iu(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Ah(n){const e=n.auth,t=await n.getIdToken(),i=await gu(n,Rh(e,{idToken:t}));Pt(i?.users.length,e,"internal-error");const l=i.users[0];n._notifyReloadListener(l);const u=l.providerUserInfo?.length?hw(l.providerUserInfo):[],d=iC(n.providerData,u),p=n.isAnonymous,g=!(n.email&&l.passwordHash)&&!d?.length,y=p?g:!1,w={uid:l.localId,displayName:l.displayName||null,photoURL:l.photoUrl||null,email:l.email||null,emailVerified:l.emailVerified||!1,phoneNumber:l.phoneNumber||null,tenantId:l.tenantId||null,providerData:d,metadata:new dg(l.createdAt,l.lastLoginAt),isAnonymous:y};Object.assign(n,w)}async function aC(n){const e=Gs(n);await Ah(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function iC(n,e){return[...n.filter(i=>!e.some(l=>l.providerId===i.providerId)),...e]}function hw(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}async function oC(n,e){const t=await uw(n,{},async()=>{const i=Ru({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:l,apiKey:u}=n.config,d=await dw(n,l,"/v1/token",`key=${u}`),p=await n._getAdditionalHeaders();p["Content-Type"]="application/x-www-form-urlencoded";const g={method:"POST",headers:p,body:i};return n.emulatorConfig&&fo(n.emulatorConfig.host)&&(g.credentials="include"),cw.fetch()(d,g)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function lC(n,e){return vi(n,"POST","/v2/accounts:revokeToken",bi(n,e))}class ql{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Pt(e.idToken,"internal-error"),Pt(typeof e.idToken<"u","internal-error"),Pt(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Y1(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Pt(e.length!==0,"internal-error");const t=Y1(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Pt(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:i,refreshToken:l,expiresIn:u}=await oC(e,t);this.updateTokensAndExpiration(i,l,Number(u))}updateTokensAndExpiration(e,t,i){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,t){const{refreshToken:i,accessToken:l,expirationTime:u}=t,d=new ql;return i&&(Pt(typeof i=="string","internal-error",{appName:e}),d.refreshToken=i),l&&(Pt(typeof l=="string","internal-error",{appName:e}),d.accessToken=l),u&&(Pt(typeof u=="number","internal-error",{appName:e}),d.expirationTime=u),d}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new ql,this.toJSON())}_performRefresh(){return oi("not implemented")}}function $i(n,e){Pt(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class ga{constructor({uid:e,auth:t,stsTokenManager:i,...l}){this.providerId="firebase",this.proactiveRefresh=new rC(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=l.displayName||null,this.email=l.email||null,this.emailVerified=l.emailVerified||!1,this.phoneNumber=l.phoneNumber||null,this.photoURL=l.photoURL||null,this.isAnonymous=l.isAnonymous||!1,this.tenantId=l.tenantId||null,this.providerData=l.providerData?[...l.providerData]:[],this.metadata=new dg(l.createdAt||void 0,l.lastLoginAt||void 0)}async getIdToken(e){const t=await gu(this,this.stsTokenManager.getToken(this.auth,e));return Pt(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return sC(this,e)}reload(){return aC(this)}_assign(e){this!==e&&(Pt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new ga({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){Pt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),t&&await Ah(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(qr(this.auth.app))return Promise.reject(ui(this.auth));const e=await this.getIdToken();return await gu(this,tC(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const i=t.displayName??void 0,l=t.email??void 0,u=t.phoneNumber??void 0,d=t.photoURL??void 0,p=t.tenantId??void 0,g=t._redirectEventId??void 0,y=t.createdAt??void 0,w=t.lastLoginAt??void 0,{uid:j,emailVerified:T,isAnonymous:V,providerData:W,stsTokenManager:F}=t;Pt(j&&F,e,"internal-error");const U=ql.fromJSON(this.name,F);Pt(typeof j=="string",e,"internal-error"),$i(i,e.name),$i(l,e.name),Pt(typeof T=="boolean",e,"internal-error"),Pt(typeof V=="boolean",e,"internal-error"),$i(u,e.name),$i(d,e.name),$i(p,e.name),$i(g,e.name),$i(y,e.name),$i(w,e.name);const ne=new ga({uid:j,auth:e,email:l,emailVerified:T,displayName:i,isAnonymous:V,photoURL:d,phoneNumber:u,tenantId:p,stsTokenManager:U,createdAt:y,lastLoginAt:w});return W&&Array.isArray(W)&&(ne.providerData=W.map(Y=>({...Y}))),g&&(ne._redirectEventId=g),ne}static async _fromIdTokenResponse(e,t,i=!1){const l=new ql;l.updateFromServerResponse(t);const u=new ga({uid:t.localId,auth:e,stsTokenManager:l,isAnonymous:i});return await Ah(u),u}static async _fromGetAccountInfoResponse(e,t,i){const l=t.users[0];Pt(l.localId!==void 0,"internal-error");const u=l.providerUserInfo!==void 0?hw(l.providerUserInfo):[],d=!(l.email&&l.passwordHash)&&!u?.length,p=new ql;p.updateFromIdToken(i);const g=new ga({uid:l.localId,auth:e,stsTokenManager:p,isAnonymous:d}),y={uid:l.localId,displayName:l.displayName||null,photoURL:l.photoUrl||null,email:l.email||null,emailVerified:l.emailVerified||!1,phoneNumber:l.phoneNumber||null,tenantId:l.tenantId||null,providerData:u,metadata:new dg(l.createdAt,l.lastLoginAt),isAnonymous:!(l.email&&l.passwordHash)&&!u?.length};return Object.assign(g,y),g}}const Q1=new Map;function li(n){pi(n instanceof Function,"Expected a class definition");let e=Q1.get(n);return e?(pi(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,Q1.set(n,e),e)}class mw{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}mw.type="NONE";const X1=mw;function yh(n,e,t){return`firebase:${n}:${e}:${t}`}class Hl{constructor(e,t,i){this.persistence=e,this.auth=t,this.userKey=i;const{config:l,name:u}=this.auth;this.fullUserKey=yh(this.userKey,l.apiKey,u),this.fullPersistenceKey=yh("persistence",l.apiKey,u),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await Rh(this.auth,{idToken:e}).catch(()=>{});return t?ga._fromGetAccountInfoResponse(this.auth,t,e):null}return ga._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,i="authUser"){if(!t.length)return new Hl(li(X1),e,i);const l=(await Promise.all(t.map(async y=>{if(await y._isAvailable())return y}))).filter(y=>y);let u=l[0]||li(X1);const d=yh(i,e.config.apiKey,e.name);let p=null;for(const y of t)try{const w=await y._get(d);if(w){let j;if(typeof w=="string"){const T=await Rh(e,{idToken:w}).catch(()=>{});if(!T)break;j=await ga._fromGetAccountInfoResponse(e,T,w)}else j=ga._fromJSON(e,w);y!==u&&(p=j),u=y;break}}catch{}const g=l.filter(y=>y._shouldAllowMigration);return!u._shouldAllowMigration||!g.length?new Hl(u,e,i):(u=g[0],p&&await u._set(d,p.toJSON()),await Promise.all(t.map(async y=>{if(y!==u)try{await y._remove(d)}catch{}})),new Hl(u,e,i))}}function J1(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(yw(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(fw(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(vw(e))return"Blackberry";if(xw(e))return"Webos";if(pw(e))return"Safari";if((e.includes("chrome/")||gw(e))&&!e.includes("edge/"))return"Chrome";if(bw(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=n.match(t);if(i?.length===2)return i[1]}return"Other"}function fw(n=cr()){return/firefox\//i.test(n)}function pw(n=cr()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function gw(n=cr()){return/crios\//i.test(n)}function yw(n=cr()){return/iemobile/i.test(n)}function bw(n=cr()){return/android/i.test(n)}function vw(n=cr()){return/blackberry/i.test(n)}function xw(n=cr()){return/webos/i.test(n)}function Qg(n=cr()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function cC(n=cr()){return Qg(n)&&!!window.navigator?.standalone}function uC(){return jN()&&document.documentMode===10}function ww(n=cr()){return Qg(n)||bw(n)||xw(n)||vw(n)||/windows phone/i.test(n)||yw(n)}function _w(n,e=[]){let t;switch(n){case"Browser":t=J1(cr());break;case"Worker":t=`${J1(cr())}-${n}`;break;default:t=n}const i=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Jo}/${i}`}class dC{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const i=u=>new Promise((d,p)=>{try{const g=e(u);d(g)}catch(g){p(g)}});i.onAbort=t,this.queue.push(i);const l=this.queue.length-1;return()=>{this.queue[l]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const i of this.queue)await i(e),i.onAbort&&t.push(i.onAbort)}catch(i){t.reverse();for(const l of t)try{l()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i?.message})}}}async function hC(n,e={}){return vi(n,"GET","/v2/passwordPolicy",bi(n,e))}const mC=6;class fC{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??mC,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const i=this.customStrengthOptions.minPasswordLength,l=this.customStrengthOptions.maxPasswordLength;i&&(t.meetsMinPasswordLength=e.length>=i),l&&(t.meetsMaxPasswordLength=e.length<=l)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let i;for(let l=0;l<e.length;l++)i=e.charAt(l),this.updatePasswordCharacterOptionsStatuses(t,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,t,i,l,u){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=l)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=u))}}class pC{constructor(e,t,i,l){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=i,this.config=l,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Z1(this),this.idTokenSubscription=new Z1(this),this.beforeStateQueue=new dC(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=ow,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=l.sdkClientVersion,this._persistenceManagerAvailable=new Promise(u=>this._resolvePersistenceManagerAvailable=u)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=li(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await Hl.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await Rh(this,{idToken:e}),i=await ga._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(i)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(qr(this.app)){const u=this.app.settings.authIdToken;return u?new Promise(d=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(u).then(d,d))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let i=t,l=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const u=this.redirectUser?._redirectEventId,d=i?._redirectEventId,p=await this.tryRedirectSignIn(e);(!u||u===d)&&p?.user&&(i=p.user,l=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(l)try{await this.beforeStateQueue.runMiddleware(i)}catch(u){i=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(u))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return Pt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Ah(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=GS()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(qr(this.app))return Promise.reject(ui(this));const t=e?Gs(e):null;return t&&Pt(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Pt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return qr(this.app)?Promise.reject(ui(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return qr(this.app)?Promise.reject(ui(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(li(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await hC(this),t=new fC(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Cu("auth","Firebase",e())}onAuthStateChanged(e,t,i){return this.registerStateListener(this.authStateSubscription,e,t,i)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,i){return this.registerStateListener(this.idTokenSubscription,e,t,i)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const i=this.onAuthStateChanged(()=>{i(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(i.tenantId=this.tenantId),await lC(this,i)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const i=await this.getOrInitRedirectPersistenceManager(t);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&li(e)||this._popupRedirectResolver;Pt(t,this,"argument-error"),this.redirectPersistenceManager=await Hl.create(this,[li(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,i,l){if(this._deleted)return()=>{};const u=typeof t=="function"?t:t.next.bind(t);let d=!1;const p=this._isInitialized?Promise.resolve():this._initializationPromise;if(Pt(p,this,"internal-error"),p.then(()=>{d||u(this.currentUser)}),typeof t=="function"){const g=e.addObserver(t,i,l);return()=>{d=!0,g()}}else{const g=e.addObserver(t);return()=>{d=!0,g()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Pt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=_w(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const i=await this._getAppCheckToken();return i&&(e["X-Firebase-AppCheck"]=i),e}async _getAppCheckToken(){if(qr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&HS(`Error while retrieving App Check token: ${e.error}`),e?.token}}function po(n){return Gs(n)}class Z1{constructor(e){this.auth=e,this.observer=null,this.addObserver=IN(t=>this.observer=t)}get next(){return Pt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let Zh={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function gC(n){Zh=n}function kw(n){return Zh.loadJS(n)}function yC(){return Zh.recaptchaEnterpriseScript}function bC(){return Zh.gapiScript}function vC(n){return`__${n}${Math.floor(Math.random()*1e6)}`}class xC{constructor(){this.enterprise=new wC}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class wC{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const _C="recaptcha-enterprise",jw="NO_RECAPTCHA";class kC{constructor(e){this.type=_C,this.auth=po(e)}async verify(e="verify",t=!1){async function i(u){if(!t){if(u.tenantId==null&&u._agentRecaptchaConfig!=null)return u._agentRecaptchaConfig.siteKey;if(u.tenantId!=null&&u._tenantRecaptchaConfigs[u.tenantId]!==void 0)return u._tenantRecaptchaConfigs[u.tenantId].siteKey}return new Promise(async(d,p)=>{eC(u,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(g=>{if(g.recaptchaKey===void 0)p(new Error("recaptcha Enterprise site key undefined"));else{const y=new ZS(g);return u.tenantId==null?u._agentRecaptchaConfig=y:u._tenantRecaptchaConfigs[u.tenantId]=y,d(y.siteKey)}}).catch(g=>{p(g)})})}function l(u,d,p){const g=window.grecaptcha;K1(g)?g.enterprise.ready(()=>{g.enterprise.execute(u,{action:e}).then(y=>{d(y)}).catch(()=>{d(jw)})}):p(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new xC().execute("siteKey",{action:"verify"}):new Promise((u,d)=>{i(this.auth).then(p=>{if(!t&&K1(window.grecaptcha))l(p,u,d);else{if(typeof window>"u"){d(new Error("RecaptchaVerifier is only supported in browser"));return}let g=yC();g.length!==0&&(g+=p),kw(g).then(()=>{l(p,u,d)}).catch(y=>{d(y)})}}).catch(p=>{d(p)})})}}async function ex(n,e,t,i=!1,l=!1){const u=new kC(n);let d;if(l)d=jw;else try{d=await u.verify(t)}catch{d=await u.verify(t,!0)}const p={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in p){const g=p.phoneEnrollmentInfo.phoneNumber,y=p.phoneEnrollmentInfo.recaptchaToken;Object.assign(p,{phoneEnrollmentInfo:{phoneNumber:g,recaptchaToken:y,captchaResponse:d,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in p){const g=p.phoneSignInInfo.recaptchaToken;Object.assign(p,{phoneSignInInfo:{recaptchaToken:g,captchaResponse:d,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return p}return i?Object.assign(p,{captchaResp:d}):Object.assign(p,{captchaResponse:d}),Object.assign(p,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(p,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),p}async function Ih(n,e,t,i,l){if(n._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const u=await ex(n,e,t,t==="getOobCode");return i(n,u)}else return i(n,e).catch(async u=>{if(u.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const d=await ex(n,e,t,t==="getOobCode");return i(n,d)}else return Promise.reject(u)})}function jC(n,e){const t=Jh(n,"auth");if(t.isInitialized()){const l=t.getImmediate(),u=t.getOptions();if(Ho(u,e??{}))return l;ba(l,"already-initialized")}return t.initialize({options:e})}function TC(n,e){const t=e?.persistence||[],i=(Array.isArray(t)?t:[t]).map(li);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(i,e?.popupRedirectResolver)}function EC(n,e,t){const i=po(n);Pt(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const l=!1,u=Tw(e),{host:d,port:p}=NC(e),g=p===null?"":`:${p}`,y={url:`${u}//${d}${g}/`},w=Object.freeze({host:d,port:p,protocol:u.replace(":",""),options:Object.freeze({disableWarnings:l})});if(!i._canInitEmulator){Pt(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),Pt(Ho(y,i.config.emulator)&&Ho(w,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=y,i.emulatorConfig=w,i.settings.appVerificationDisabledForTesting=!0,fo(d)?(Fg(`${u}//${d}${g}`),zg("Auth",!0)):SC()}function Tw(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function NC(n){const e=Tw(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const i=t[2].split("@").pop()||"",l=/^(\[[^\]]+\])(:|$)/.exec(i);if(l){const u=l[1];return{host:u,port:tx(i.substr(u.length+1))}}else{const[u,d]=i.split(":");return{host:u,port:tx(d)}}}function tx(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function SC(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}class Xg{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return oi("not implemented")}_getIdTokenResponse(e){return oi("not implemented")}_linkToIdToken(e,t){return oi("not implemented")}_getReauthenticationResolver(e){return oi("not implemented")}}async function CC(n,e){return vi(n,"POST","/v1/accounts:signUp",e)}async function RC(n,e){return Iu(n,"POST","/v1/accounts:signInWithPassword",bi(n,e))}async function Ew(n,e){return vi(n,"POST","/v1/accounts:sendOobCode",bi(n,e))}async function AC(n,e){return Ew(n,e)}async function IC(n,e){return Ew(n,e)}async function MC(n,e){return Iu(n,"POST","/v1/accounts:signInWithEmailLink",bi(n,e))}async function DC(n,e){return Iu(n,"POST","/v1/accounts:signInWithEmailLink",bi(n,e))}class yu extends Xg{constructor(e,t,i,l=null){super("password",i),this._email=e,this._password=t,this._tenantId=l}static _fromEmailAndPassword(e,t){return new yu(e,t,"password")}static _fromEmailAndCode(e,t,i=null){return new yu(e,t,"emailLink",i)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Ih(e,t,"signInWithPassword",RC);case"emailLink":return MC(e,{email:this._email,oobCode:this._password});default:ba(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const i={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Ih(e,i,"signUpPassword",CC);case"emailLink":return DC(e,{idToken:t,email:this._email,oobCode:this._password});default:ba(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function $l(n,e){return Iu(n,"POST","/v1/accounts:signInWithIdp",bi(n,e))}const PC="http://localhost";class Wo extends Xg{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Wo(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):ba("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:l,...u}=t;if(!i||!l)return null;const d=new Wo(i,l);return d.idToken=u.idToken||void 0,d.accessToken=u.accessToken||void 0,d.secret=u.secret,d.nonce=u.nonce,d.pendingToken=u.pendingToken||null,d}_getIdTokenResponse(e){const t=this.buildRequest();return $l(e,t)}_linkToIdToken(e,t){const i=this.buildRequest();return i.idToken=t,$l(e,i)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,$l(e,t)}buildRequest(){const e={requestUri:PC,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Ru(t)}return e}}function LC(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function OC(n){const e=Zc(eu(n)).link,t=e?Zc(eu(e)).deep_link_id:null,i=Zc(eu(n)).deep_link_id;return(i?Zc(eu(i)).link:null)||i||t||e||n}class Jg{constructor(e){const t=Zc(eu(e)),i=t.apiKey??null,l=t.oobCode??null,u=LC(t.mode??null);Pt(i&&l&&u,"argument-error"),this.apiKey=i,this.operation=u,this.code=l,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=OC(e);try{return new Jg(t)}catch{return null}}}class nc{constructor(){this.providerId=nc.PROVIDER_ID}static credential(e,t){return yu._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const i=Jg.parseLink(t);return Pt(i,"argument-error"),yu._fromEmailAndCode(e,i.code,i.tenantId)}}nc.PROVIDER_ID="password";nc.EMAIL_PASSWORD_SIGN_IN_METHOD="password";nc.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class Nw{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class Mu extends Nw{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Ki extends Mu{constructor(){super("facebook.com")}static credential(e){return Wo._fromParams({providerId:Ki.PROVIDER_ID,signInMethod:Ki.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ki.credentialFromTaggedObject(e)}static credentialFromError(e){return Ki.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ki.credential(e.oauthAccessToken)}catch{return null}}}Ki.FACEBOOK_SIGN_IN_METHOD="facebook.com";Ki.PROVIDER_ID="facebook.com";class Yi extends Mu{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Wo._fromParams({providerId:Yi.PROVIDER_ID,signInMethod:Yi.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Yi.credentialFromTaggedObject(e)}static credentialFromError(e){return Yi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:i}=e;if(!t&&!i)return null;try{return Yi.credential(t,i)}catch{return null}}}Yi.GOOGLE_SIGN_IN_METHOD="google.com";Yi.PROVIDER_ID="google.com";class Qi extends Mu{constructor(){super("github.com")}static credential(e){return Wo._fromParams({providerId:Qi.PROVIDER_ID,signInMethod:Qi.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Qi.credentialFromTaggedObject(e)}static credentialFromError(e){return Qi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Qi.credential(e.oauthAccessToken)}catch{return null}}}Qi.GITHUB_SIGN_IN_METHOD="github.com";Qi.PROVIDER_ID="github.com";class Xi extends Mu{constructor(){super("twitter.com")}static credential(e,t){return Wo._fromParams({providerId:Xi.PROVIDER_ID,signInMethod:Xi.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Xi.credentialFromTaggedObject(e)}static credentialFromError(e){return Xi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:i}=e;if(!t||!i)return null;try{return Xi.credential(t,i)}catch{return null}}}Xi.TWITTER_SIGN_IN_METHOD="twitter.com";Xi.PROVIDER_ID="twitter.com";async function VC(n,e){return Iu(n,"POST","/v1/accounts:signUp",bi(n,e))}class Go{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,i,l=!1){const u=await ga._fromIdTokenResponse(e,i,l),d=sx(i);return new Go({user:u,providerId:d,_tokenResponse:i,operationType:t})}static async _forOperation(e,t,i){await e._updateTokensIfNecessary(i,!0);const l=sx(i);return new Go({user:e,providerId:l,_tokenResponse:i,operationType:t})}}function sx(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}class Mh extends qa{constructor(e,t,i,l){super(t.code,t.message),this.operationType=i,this.user=l,Object.setPrototypeOf(this,Mh.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,t,i,l){return new Mh(e,t,i,l)}}function Sw(n,e,t,i){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(u=>{throw u.code==="auth/multi-factor-auth-required"?Mh._fromErrorAndOperation(n,u,e,i):u})}async function BC(n,e,t=!1){const i=await gu(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return Go._forOperation(n,"link",i)}async function UC(n,e,t=!1){const{auth:i}=n;if(qr(i.app))return Promise.reject(ui(i));const l="reauthenticate";try{const u=await gu(n,Sw(i,l,e,n),t);Pt(u.idToken,i,"internal-error");const d=Yg(u.idToken);Pt(d,i,"internal-error");const{sub:p}=d;return Pt(n.uid===p,i,"user-mismatch"),Go._forOperation(n,l,u)}catch(u){throw u?.code==="auth/user-not-found"&&ba(i,"user-mismatch"),u}}async function Cw(n,e,t=!1){if(qr(n.app))return Promise.reject(ui(n));const i="signIn",l=await Sw(n,i,e),u=await Go._fromIdTokenResponse(n,i,l);return t||await n._updateCurrentUser(u.user),u}async function FC(n,e){return Cw(po(n),e)}async function Rw(n){const e=po(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function zC(n,e,t){const i=po(n);await Ih(i,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",IC)}async function qC(n,e,t){if(qr(n.app))return Promise.reject(ui(n));const i=po(n),d=await Ih(i,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",VC).catch(g=>{throw g.code==="auth/password-does-not-meet-requirements"&&Rw(n),g}),p=await Go._fromIdTokenResponse(i,"signIn",d);return await i._updateCurrentUser(p.user),p}function HC(n,e,t){return qr(n.app)?Promise.reject(ui(n)):FC(Gs(n),nc.credential(e,t)).catch(async i=>{throw i.code==="auth/password-does-not-meet-requirements"&&Rw(n),i})}async function RP(n,e){const t=Gs(n),l={requestType:"VERIFY_EMAIL",idToken:await n.getIdToken()},{email:u}=await AC(t.auth,l);u!==n.email&&await n.reload()}function nx(n,e){return Gs(n).setPersistence(e)}function $C(n,e,t,i){return Gs(n).onIdTokenChanged(e,t,i)}function WC(n,e,t){return Gs(n).beforeAuthStateChanged(e,t)}function GC(n,e,t,i){return Gs(n).onAuthStateChanged(e,t,i)}function KC(n){return Gs(n).signOut()}const Dh="__sak";class Aw{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Dh,"1"),this.storage.removeItem(Dh),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const YC=1e3,QC=10;class Iw extends Aw{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=ww(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const i=this.storage.getItem(t),l=this.localCache[t];i!==l&&e(t,l,i)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((d,p,g)=>{this.notifyListeners(d,g)});return}const i=e.key;t?this.detachListener():this.stopPolling();const l=()=>{const d=this.storage.getItem(i);!t&&this.localCache[i]===d||this.notifyListeners(i,d)},u=this.storage.getItem(i);uC()&&u!==e.newValue&&e.newValue!==e.oldValue?setTimeout(l,QC):l()}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const l of Array.from(i))l(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:i}),!0)})},YC)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}Iw.type="LOCAL";const hg=Iw;class Mw extends Aw{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}Mw.type="SESSION";const Zg=Mw;function XC(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class em{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(l=>l.isListeningto(e));if(t)return t;const i=new em(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:i,eventType:l,data:u}=t.data,d=this.handlersMap[l];if(!d?.size)return;t.ports[0].postMessage({status:"ack",eventId:i,eventType:l});const p=Array.from(d).map(async y=>y(t.origin,u)),g=await XC(p);t.ports[0].postMessage({status:"done",eventId:i,eventType:l,response:g})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}em.receivers=[];function ey(n="",e=10){let t="";for(let i=0;i<e;i++)t+=Math.floor(Math.random()*10);return n+t}class JC{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,i=50){const l=typeof MessageChannel<"u"?new MessageChannel:null;if(!l)throw new Error("connection_unavailable");let u,d;return new Promise((p,g)=>{const y=ey("",20);l.port1.start();const w=setTimeout(()=>{g(new Error("unsupported_event"))},i);d={messageChannel:l,onMessage(j){const T=j;if(T.data.eventId===y)switch(T.data.status){case"ack":clearTimeout(w),u=setTimeout(()=>{g(new Error("timeout"))},3e3);break;case"done":clearTimeout(u),p(T.data.response);break;default:clearTimeout(w),clearTimeout(u),g(new Error("invalid_response"));break}}},this.handlers.add(d),l.port1.addEventListener("message",d.onMessage),this.target.postMessage({eventType:e,eventId:y,data:t},[l.port2])}).finally(()=>{d&&this.removeMessageHandler(d)})}}function Oa(){return window}function ZC(n){Oa().location.href=n}function Dw(){return typeof Oa().WorkerGlobalScope<"u"&&typeof Oa().importScripts=="function"}async function e4(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function t4(){return navigator?.serviceWorker?.controller||null}function s4(){return Dw()?self:null}const Pw="firebaseLocalStorageDb",n4=1,Ph="firebaseLocalStorage",Lw="fbase_key";class Du{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function tm(n,e){return n.transaction([Ph],e?"readwrite":"readonly").objectStore(Ph)}function r4(){const n=indexedDB.deleteDatabase(Pw);return new Du(n).toPromise()}function mg(){const n=indexedDB.open(Pw,n4);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const i=n.result;try{i.createObjectStore(Ph,{keyPath:Lw})}catch(l){t(l)}}),n.addEventListener("success",async()=>{const i=n.result;i.objectStoreNames.contains(Ph)?e(i):(i.close(),await r4(),e(await mg()))})})}async function rx(n,e,t){const i=tm(n,!0).put({[Lw]:e,value:t});return new Du(i).toPromise()}async function a4(n,e){const t=tm(n,!1).get(e),i=await new Du(t).toPromise();return i===void 0?null:i.value}function ax(n,e){const t=tm(n,!0).delete(e);return new Du(t).toPromise()}const i4=800,o4=3;class Ow{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await mg(),this.db)}async _withRetries(e){let t=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(i){if(t++>o4)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Dw()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=em._getInstance(s4()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await e4(),!this.activeServiceWorker)return;this.sender=new JC(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||t4()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await mg();return await rx(e,Dh,"1"),await ax(e,Dh),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(i=>rx(i,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(i=>a4(i,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>ax(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(l=>{const u=tm(l,!1).getAll();return new Du(u).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],i=new Set;if(e.length!==0)for(const{fbase_key:l,value:u}of e)i.add(l),JSON.stringify(this.localCache[l])!==JSON.stringify(u)&&(this.notifyListeners(l,u),t.push(l));for(const l of Object.keys(this.localCache))this.localCache[l]&&!i.has(l)&&(this.notifyListeners(l,null),t.push(l));return t}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const l of Array.from(i))l(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),i4)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}Ow.type="LOCAL";const l4=Ow;new Au(3e4,6e4);function c4(n,e){return e?li(e):(Pt(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}class ty extends Xg{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return $l(e,this._buildIdpRequest())}_linkToIdToken(e,t){return $l(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return $l(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function u4(n){return Cw(n.auth,new ty(n),n.bypassAuthState)}function d4(n){const{auth:e,user:t}=n;return Pt(t,e,"internal-error"),UC(t,new ty(n),n.bypassAuthState)}async function h4(n){const{auth:e,user:t}=n;return Pt(t,e,"internal-error"),BC(t,new ty(n),n.bypassAuthState)}class Vw{constructor(e,t,i,l,u=!1){this.auth=e,this.resolver=i,this.user=l,this.bypassAuthState=u,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:i,postBody:l,tenantId:u,error:d,type:p}=e;if(d){this.reject(d);return}const g={auth:this.auth,requestUri:t,sessionId:i,tenantId:u||void 0,postBody:l||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(p)(g))}catch(y){this.reject(y)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return u4;case"linkViaPopup":case"linkViaRedirect":return h4;case"reauthViaPopup":case"reauthViaRedirect":return d4;default:ba(this.auth,"internal-error")}}resolve(e){pi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){pi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const m4=new Au(2e3,1e4);class zl extends Vw{constructor(e,t,i,l,u){super(e,t,l,u),this.provider=i,this.authWindow=null,this.pollId=null,zl.currentPopupAction&&zl.currentPopupAction.cancel(),zl.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Pt(e,this.auth,"internal-error"),e}async onExecution(){pi(this.filter.length===1,"Popup operations only handle one event");const e=ey();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(La(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(La(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,zl.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(La(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,m4.get())};e()}}zl.currentPopupAction=null;const f4="pendingRedirect",bh=new Map;class p4 extends Vw{constructor(e,t,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,i),this.eventId=null}async execute(){let e=bh.get(this.auth._key());if(!e){try{const i=await g4(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(t){e=()=>Promise.reject(t)}bh.set(this.auth._key(),e)}return this.bypassAuthState||bh.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function g4(n,e){const t=v4(e),i=b4(n);if(!await i._isAvailable())return!1;const l=await i._get(t)==="true";return await i._remove(t),l}function y4(n,e){bh.set(n._key(),e)}function b4(n){return li(n._redirectPersistence)}function v4(n){return yh(f4,n.config.apiKey,n.name)}async function x4(n,e,t=!1){if(qr(n.app))return Promise.reject(ui(n));const i=po(n),l=c4(i,e),d=await new p4(i,l,t).execute();return d&&!t&&(delete d.user._redirectEventId,await i._persistUserIfCurrent(d.user),await i._setRedirectUser(null,e)),d}const w4=600*1e3;class _4{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(t=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!k4(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!Bw(e)){const i=e.error.code?.split("auth/")[1]||"internal-error";t.onError(La(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const i=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=w4&&this.cachedEventUids.clear(),this.cachedEventUids.has(ix(e))}saveEventToCache(e){this.cachedEventUids.add(ix(e)),this.lastProcessedEventTime=Date.now()}}function ix(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function Bw({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function k4(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Bw(n);default:return!1}}async function j4(n,e={}){return vi(n,"GET","/v1/projects",e)}const T4=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,E4=/^https?/;async function N4(n){if(n.config.emulator)return;const{authorizedDomains:e}=await j4(n);for(const t of e)try{if(S4(t))return}catch{}ba(n,"unauthorized-domain")}function S4(n){const e=ug(),{protocol:t,hostname:i}=new URL(e);if(n.startsWith("chrome-extension://")){const d=new URL(n);return d.hostname===""&&i===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&d.hostname===i}if(!E4.test(t))return!1;if(T4.test(n))return i===n;const l=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+l+"|"+l+")$","i").test(i)}const C4=new Au(3e4,6e4);function ox(){const n=Oa().___jsl;if(n?.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function R4(n){return new Promise((e,t)=>{function i(){ox(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{ox(),t(La(n,"network-request-failed"))},timeout:C4.get()})}if(Oa().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(Oa().gapi?.load)i();else{const l=vC("iframefcb");return Oa()[l]=()=>{gapi.load?i():t(La(n,"network-request-failed"))},kw(`${bC()}?onload=${l}`).catch(u=>t(u))}}).catch(e=>{throw vh=null,e})}let vh=null;function A4(n){return vh=vh||R4(n),vh}const I4=new Au(5e3,15e3),M4="__/auth/iframe",D4="emulator/auth/iframe",P4={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},L4=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function O4(n){const e=n.config;Pt(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?Kg(e,D4):`https://${n.config.authDomain}/${M4}`,i={apiKey:e.apiKey,appName:n.name,v:Jo},l=L4.get(n.config.apiHost);l&&(i.eid=l);const u=n._getFrameworks();return u.length&&(i.fw=u.join(",")),`${t}?${Ru(i).slice(1)}`}async function V4(n){const e=await A4(n),t=Oa().gapi;return Pt(t,n,"internal-error"),e.open({where:document.body,url:O4(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:P4,dontclear:!0},i=>new Promise(async(l,u)=>{await i.restyle({setHideOnLeave:!1});const d=La(n,"network-request-failed"),p=Oa().setTimeout(()=>{u(d)},I4.get());function g(){Oa().clearTimeout(p),l(i)}i.ping(g).then(g,()=>{u(d)})}))}const B4={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},U4=500,F4=600,z4="_blank",q4="http://localhost";class lx{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function H4(n,e,t,i=U4,l=F4){const u=Math.max((window.screen.availHeight-l)/2,0).toString(),d=Math.max((window.screen.availWidth-i)/2,0).toString();let p="";const g={...B4,width:i.toString(),height:l.toString(),top:u,left:d},y=cr().toLowerCase();t&&(p=gw(y)?z4:t),fw(y)&&(e=e||q4,g.scrollbars="yes");const w=Object.entries(g).reduce((T,[V,W])=>`${T}${V}=${W},`,"");if(cC(y)&&p!=="_self")return $4(e||"",p),new lx(null);const j=window.open(e||"",p,w);Pt(j,n,"popup-blocked");try{j.focus()}catch{}return new lx(j)}function $4(n,e){const t=document.createElement("a");t.href=n,t.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(i)}const W4="__/auth/handler",G4="emulator/auth/handler",K4=encodeURIComponent("fac");async function cx(n,e,t,i,l,u){Pt(n.config.authDomain,n,"auth-domain-config-required"),Pt(n.config.apiKey,n,"invalid-api-key");const d={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:i,v:Jo,eventId:l};if(e instanceof Nw){e.setDefaultLanguage(n.languageCode),d.providerId=e.providerId||"",AN(e.getCustomParameters())||(d.customParameters=JSON.stringify(e.getCustomParameters()));for(const[w,j]of Object.entries({}))d[w]=j}if(e instanceof Mu){const w=e.getScopes().filter(j=>j!=="");w.length>0&&(d.scopes=w.join(","))}n.tenantId&&(d.tid=n.tenantId);const p=d;for(const w of Object.keys(p))p[w]===void 0&&delete p[w];const g=await n._getAppCheckToken(),y=g?`#${K4}=${encodeURIComponent(g)}`:"";return`${Y4(n)}?${Ru(p).slice(1)}${y}`}function Y4({config:n}){return n.emulator?Kg(n,G4):`https://${n.authDomain}/${W4}`}const Ap="webStorageSupport";class Q4{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Zg,this._completeRedirectFn=x4,this._overrideRedirectResult=y4}async _openPopup(e,t,i,l){pi(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const u=await cx(e,t,i,ug(),l);return H4(e,u,ey())}async _openRedirect(e,t,i,l){await this._originValidation(e);const u=await cx(e,t,i,ug(),l);return ZC(u),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:l,promise:u}=this.eventManagers[t];return l?Promise.resolve(l):(pi(u,"If manager is not set, promise should be"),u)}const i=this.initAndGetManager(e);return this.eventManagers[t]={promise:i},i.catch(()=>{delete this.eventManagers[t]}),i}async initAndGetManager(e){const t=await V4(e),i=new _4(e);return t.register("authEvent",l=>(Pt(l?.authEvent,e,"invalid-auth-event"),{status:i.onEvent(l.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=t,i}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Ap,{type:Ap},l=>{const u=l?.[0]?.[Ap];u!==void 0&&t(!!u),ba(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=N4(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return ww()||pw()||Qg()}}const X4=Q4;var ux="@firebase/auth",dx="1.12.0";class J4{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(i=>{e(i?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Pt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function Z4(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function eR(n){$o(new io("auth",(e,{options:t})=>{const i=e.getProvider("app").getImmediate(),l=e.getProvider("heartbeat"),u=e.getProvider("app-check-internal"),{apiKey:d,authDomain:p}=i.options;Pt(d&&!d.includes(":"),"invalid-api-key",{appName:i.name});const g={apiKey:d,authDomain:p,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:_w(n)},y=new pC(i,l,u,g);return TC(y,t),y},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,i)=>{e.getProvider("auth-internal").initialize()})),$o(new io("auth-internal",e=>{const t=po(e.getProvider("auth").getImmediate());return(i=>new J4(i))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Pa(ux,dx,Z4(n)),Pa(ux,dx,"esm2020")}const tR=300,sR=ew("authIdTokenMaxAge")||tR;let hx=null;const nR=n=>async e=>{const t=e&&await e.getIdTokenResult(),i=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(i&&i>sR)return;const l=t?.token;hx!==l&&(hx=l,await fetch(n,{method:l?"POST":"DELETE",headers:l?{Authorization:`Bearer ${l}`}:{}}))};function Uw(n=Wg()){const e=Jh(n,"auth");if(e.isInitialized())return e.getImmediate();const t=jC(n,{popupRedirectResolver:X4,persistence:[l4,hg,Zg]}),i=ew("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const u=new URL(i,location.origin);if(location.origin===u.origin){const d=nR(u.toString());WC(t,d,()=>d(t.currentUser)),$C(t,p=>d(p))}}const l=X2("auth");return l&&EC(t,`http://${l}`),t}function rR(){return document.getElementsByTagName("head")?.[0]??document}gC({loadJS(n){return new Promise((e,t)=>{const i=document.createElement("script");i.setAttribute("src",n),i.onload=e,i.onerror=l=>{const u=La("internal-error");u.customData=l,t(u)},i.type="text/javascript",i.charset="UTF-8",rR().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});eR("Browser");var mx=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var ro,Fw;(function(){var n;function e(R,E){function A(){}A.prototype=E.prototype,R.F=E.prototype,R.prototype=new A,R.prototype.constructor=R,R.D=function(O,D,H){for(var M=Array(arguments.length-2),We=2;We<arguments.length;We++)M[We-2]=arguments[We];return E.prototype[D].apply(O,M)}}function t(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(i,t),i.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function l(R,E,A){A||(A=0);const O=Array(16);if(typeof E=="string")for(var D=0;D<16;++D)O[D]=E.charCodeAt(A++)|E.charCodeAt(A++)<<8|E.charCodeAt(A++)<<16|E.charCodeAt(A++)<<24;else for(D=0;D<16;++D)O[D]=E[A++]|E[A++]<<8|E[A++]<<16|E[A++]<<24;E=R.g[0],A=R.g[1],D=R.g[2];let H=R.g[3],M;M=E+(H^A&(D^H))+O[0]+3614090360&4294967295,E=A+(M<<7&4294967295|M>>>25),M=H+(D^E&(A^D))+O[1]+3905402710&4294967295,H=E+(M<<12&4294967295|M>>>20),M=D+(A^H&(E^A))+O[2]+606105819&4294967295,D=H+(M<<17&4294967295|M>>>15),M=A+(E^D&(H^E))+O[3]+3250441966&4294967295,A=D+(M<<22&4294967295|M>>>10),M=E+(H^A&(D^H))+O[4]+4118548399&4294967295,E=A+(M<<7&4294967295|M>>>25),M=H+(D^E&(A^D))+O[5]+1200080426&4294967295,H=E+(M<<12&4294967295|M>>>20),M=D+(A^H&(E^A))+O[6]+2821735955&4294967295,D=H+(M<<17&4294967295|M>>>15),M=A+(E^D&(H^E))+O[7]+4249261313&4294967295,A=D+(M<<22&4294967295|M>>>10),M=E+(H^A&(D^H))+O[8]+1770035416&4294967295,E=A+(M<<7&4294967295|M>>>25),M=H+(D^E&(A^D))+O[9]+2336552879&4294967295,H=E+(M<<12&4294967295|M>>>20),M=D+(A^H&(E^A))+O[10]+4294925233&4294967295,D=H+(M<<17&4294967295|M>>>15),M=A+(E^D&(H^E))+O[11]+2304563134&4294967295,A=D+(M<<22&4294967295|M>>>10),M=E+(H^A&(D^H))+O[12]+1804603682&4294967295,E=A+(M<<7&4294967295|M>>>25),M=H+(D^E&(A^D))+O[13]+4254626195&4294967295,H=E+(M<<12&4294967295|M>>>20),M=D+(A^H&(E^A))+O[14]+2792965006&4294967295,D=H+(M<<17&4294967295|M>>>15),M=A+(E^D&(H^E))+O[15]+1236535329&4294967295,A=D+(M<<22&4294967295|M>>>10),M=E+(D^H&(A^D))+O[1]+4129170786&4294967295,E=A+(M<<5&4294967295|M>>>27),M=H+(A^D&(E^A))+O[6]+3225465664&4294967295,H=E+(M<<9&4294967295|M>>>23),M=D+(E^A&(H^E))+O[11]+643717713&4294967295,D=H+(M<<14&4294967295|M>>>18),M=A+(H^E&(D^H))+O[0]+3921069994&4294967295,A=D+(M<<20&4294967295|M>>>12),M=E+(D^H&(A^D))+O[5]+3593408605&4294967295,E=A+(M<<5&4294967295|M>>>27),M=H+(A^D&(E^A))+O[10]+38016083&4294967295,H=E+(M<<9&4294967295|M>>>23),M=D+(E^A&(H^E))+O[15]+3634488961&4294967295,D=H+(M<<14&4294967295|M>>>18),M=A+(H^E&(D^H))+O[4]+3889429448&4294967295,A=D+(M<<20&4294967295|M>>>12),M=E+(D^H&(A^D))+O[9]+568446438&4294967295,E=A+(M<<5&4294967295|M>>>27),M=H+(A^D&(E^A))+O[14]+3275163606&4294967295,H=E+(M<<9&4294967295|M>>>23),M=D+(E^A&(H^E))+O[3]+4107603335&4294967295,D=H+(M<<14&4294967295|M>>>18),M=A+(H^E&(D^H))+O[8]+1163531501&4294967295,A=D+(M<<20&4294967295|M>>>12),M=E+(D^H&(A^D))+O[13]+2850285829&4294967295,E=A+(M<<5&4294967295|M>>>27),M=H+(A^D&(E^A))+O[2]+4243563512&4294967295,H=E+(M<<9&4294967295|M>>>23),M=D+(E^A&(H^E))+O[7]+1735328473&4294967295,D=H+(M<<14&4294967295|M>>>18),M=A+(H^E&(D^H))+O[12]+2368359562&4294967295,A=D+(M<<20&4294967295|M>>>12),M=E+(A^D^H)+O[5]+4294588738&4294967295,E=A+(M<<4&4294967295|M>>>28),M=H+(E^A^D)+O[8]+2272392833&4294967295,H=E+(M<<11&4294967295|M>>>21),M=D+(H^E^A)+O[11]+1839030562&4294967295,D=H+(M<<16&4294967295|M>>>16),M=A+(D^H^E)+O[14]+4259657740&4294967295,A=D+(M<<23&4294967295|M>>>9),M=E+(A^D^H)+O[1]+2763975236&4294967295,E=A+(M<<4&4294967295|M>>>28),M=H+(E^A^D)+O[4]+1272893353&4294967295,H=E+(M<<11&4294967295|M>>>21),M=D+(H^E^A)+O[7]+4139469664&4294967295,D=H+(M<<16&4294967295|M>>>16),M=A+(D^H^E)+O[10]+3200236656&4294967295,A=D+(M<<23&4294967295|M>>>9),M=E+(A^D^H)+O[13]+681279174&4294967295,E=A+(M<<4&4294967295|M>>>28),M=H+(E^A^D)+O[0]+3936430074&4294967295,H=E+(M<<11&4294967295|M>>>21),M=D+(H^E^A)+O[3]+3572445317&4294967295,D=H+(M<<16&4294967295|M>>>16),M=A+(D^H^E)+O[6]+76029189&4294967295,A=D+(M<<23&4294967295|M>>>9),M=E+(A^D^H)+O[9]+3654602809&4294967295,E=A+(M<<4&4294967295|M>>>28),M=H+(E^A^D)+O[12]+3873151461&4294967295,H=E+(M<<11&4294967295|M>>>21),M=D+(H^E^A)+O[15]+530742520&4294967295,D=H+(M<<16&4294967295|M>>>16),M=A+(D^H^E)+O[2]+3299628645&4294967295,A=D+(M<<23&4294967295|M>>>9),M=E+(D^(A|~H))+O[0]+4096336452&4294967295,E=A+(M<<6&4294967295|M>>>26),M=H+(A^(E|~D))+O[7]+1126891415&4294967295,H=E+(M<<10&4294967295|M>>>22),M=D+(E^(H|~A))+O[14]+2878612391&4294967295,D=H+(M<<15&4294967295|M>>>17),M=A+(H^(D|~E))+O[5]+4237533241&4294967295,A=D+(M<<21&4294967295|M>>>11),M=E+(D^(A|~H))+O[12]+1700485571&4294967295,E=A+(M<<6&4294967295|M>>>26),M=H+(A^(E|~D))+O[3]+2399980690&4294967295,H=E+(M<<10&4294967295|M>>>22),M=D+(E^(H|~A))+O[10]+4293915773&4294967295,D=H+(M<<15&4294967295|M>>>17),M=A+(H^(D|~E))+O[1]+2240044497&4294967295,A=D+(M<<21&4294967295|M>>>11),M=E+(D^(A|~H))+O[8]+1873313359&4294967295,E=A+(M<<6&4294967295|M>>>26),M=H+(A^(E|~D))+O[15]+4264355552&4294967295,H=E+(M<<10&4294967295|M>>>22),M=D+(E^(H|~A))+O[6]+2734768916&4294967295,D=H+(M<<15&4294967295|M>>>17),M=A+(H^(D|~E))+O[13]+1309151649&4294967295,A=D+(M<<21&4294967295|M>>>11),M=E+(D^(A|~H))+O[4]+4149444226&4294967295,E=A+(M<<6&4294967295|M>>>26),M=H+(A^(E|~D))+O[11]+3174756917&4294967295,H=E+(M<<10&4294967295|M>>>22),M=D+(E^(H|~A))+O[2]+718787259&4294967295,D=H+(M<<15&4294967295|M>>>17),M=A+(H^(D|~E))+O[9]+3951481745&4294967295,R.g[0]=R.g[0]+E&4294967295,R.g[1]=R.g[1]+(D+(M<<21&4294967295|M>>>11))&4294967295,R.g[2]=R.g[2]+D&4294967295,R.g[3]=R.g[3]+H&4294967295}i.prototype.v=function(R,E){E===void 0&&(E=R.length);const A=E-this.blockSize,O=this.C;let D=this.h,H=0;for(;H<E;){if(D==0)for(;H<=A;)l(this,R,H),H+=this.blockSize;if(typeof R=="string"){for(;H<E;)if(O[D++]=R.charCodeAt(H++),D==this.blockSize){l(this,O),D=0;break}}else for(;H<E;)if(O[D++]=R[H++],D==this.blockSize){l(this,O),D=0;break}}this.h=D,this.o+=E},i.prototype.A=function(){var R=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);R[0]=128;for(var E=1;E<R.length-8;++E)R[E]=0;E=this.o*8;for(var A=R.length-8;A<R.length;++A)R[A]=E&255,E/=256;for(this.v(R),R=Array(16),E=0,A=0;A<4;++A)for(let O=0;O<32;O+=8)R[E++]=this.g[A]>>>O&255;return R};function u(R,E){var A=p;return Object.prototype.hasOwnProperty.call(A,R)?A[R]:A[R]=E(R)}function d(R,E){this.h=E;const A=[];let O=!0;for(let D=R.length-1;D>=0;D--){const H=R[D]|0;O&&H==E||(A[D]=H,O=!1)}this.g=A}var p={};function g(R){return-128<=R&&R<128?u(R,function(E){return new d([E|0],E<0?-1:0)}):new d([R|0],R<0?-1:0)}function y(R){if(isNaN(R)||!isFinite(R))return j;if(R<0)return U(y(-R));const E=[];let A=1;for(let O=0;R>=A;O++)E[O]=R/A|0,A*=4294967296;return new d(E,0)}function w(R,E){if(R.length==0)throw Error("number format error: empty string");if(E=E||10,E<2||36<E)throw Error("radix out of range: "+E);if(R.charAt(0)=="-")return U(w(R.substring(1),E));if(R.indexOf("-")>=0)throw Error('number format error: interior "-" character');const A=y(Math.pow(E,8));let O=j;for(let H=0;H<R.length;H+=8){var D=Math.min(8,R.length-H);const M=parseInt(R.substring(H,H+D),E);D<8?(D=y(Math.pow(E,D)),O=O.j(D).add(y(M))):(O=O.j(A),O=O.add(y(M)))}return O}var j=g(0),T=g(1),V=g(16777216);n=d.prototype,n.m=function(){if(F(this))return-U(this).m();let R=0,E=1;for(let A=0;A<this.g.length;A++){const O=this.i(A);R+=(O>=0?O:4294967296+O)*E,E*=4294967296}return R},n.toString=function(R){if(R=R||10,R<2||36<R)throw Error("radix out of range: "+R);if(W(this))return"0";if(F(this))return"-"+U(this).toString(R);const E=y(Math.pow(R,6));var A=this;let O="";for(;;){const D=be(A,E).g;A=ne(A,D.j(E));let H=((A.g.length>0?A.g[0]:A.h)>>>0).toString(R);if(A=D,W(A))return H+O;for(;H.length<6;)H="0"+H;O=H+O}},n.i=function(R){return R<0?0:R<this.g.length?this.g[R]:this.h};function W(R){if(R.h!=0)return!1;for(let E=0;E<R.g.length;E++)if(R.g[E]!=0)return!1;return!0}function F(R){return R.h==-1}n.l=function(R){return R=ne(this,R),F(R)?-1:W(R)?0:1};function U(R){const E=R.g.length,A=[];for(let O=0;O<E;O++)A[O]=~R.g[O];return new d(A,~R.h).add(T)}n.abs=function(){return F(this)?U(this):this},n.add=function(R){const E=Math.max(this.g.length,R.g.length),A=[];let O=0;for(let D=0;D<=E;D++){let H=O+(this.i(D)&65535)+(R.i(D)&65535),M=(H>>>16)+(this.i(D)>>>16)+(R.i(D)>>>16);O=M>>>16,H&=65535,M&=65535,A[D]=M<<16|H}return new d(A,A[A.length-1]&-2147483648?-1:0)};function ne(R,E){return R.add(U(E))}n.j=function(R){if(W(this)||W(R))return j;if(F(this))return F(R)?U(this).j(U(R)):U(U(this).j(R));if(F(R))return U(this.j(U(R)));if(this.l(V)<0&&R.l(V)<0)return y(this.m()*R.m());const E=this.g.length+R.g.length,A=[];for(var O=0;O<2*E;O++)A[O]=0;for(O=0;O<this.g.length;O++)for(let D=0;D<R.g.length;D++){const H=this.i(O)>>>16,M=this.i(O)&65535,We=R.i(D)>>>16,gt=R.i(D)&65535;A[2*O+2*D]+=M*gt,Y(A,2*O+2*D),A[2*O+2*D+1]+=H*gt,Y(A,2*O+2*D+1),A[2*O+2*D+1]+=M*We,Y(A,2*O+2*D+1),A[2*O+2*D+2]+=H*We,Y(A,2*O+2*D+2)}for(R=0;R<E;R++)A[R]=A[2*R+1]<<16|A[2*R];for(R=E;R<2*E;R++)A[R]=0;return new d(A,0)};function Y(R,E){for(;(R[E]&65535)!=R[E];)R[E+1]+=R[E]>>>16,R[E]&=65535,E++}function oe(R,E){this.g=R,this.h=E}function be(R,E){if(W(E))throw Error("division by zero");if(W(R))return new oe(j,j);if(F(R))return E=be(U(R),E),new oe(U(E.g),U(E.h));if(F(E))return E=be(R,U(E)),new oe(U(E.g),E.h);if(R.g.length>30){if(F(R)||F(E))throw Error("slowDivide_ only works with positive integers.");for(var A=T,O=E;O.l(R)<=0;)A=Le(A),O=Le(O);var D=Ce(A,1),H=Ce(O,1);for(O=Ce(O,2),A=Ce(A,2);!W(O);){var M=H.add(O);M.l(R)<=0&&(D=D.add(A),H=M),O=Ce(O,1),A=Ce(A,1)}return E=ne(R,D.j(E)),new oe(D,E)}for(D=j;R.l(E)>=0;){for(A=Math.max(1,Math.floor(R.m()/E.m())),O=Math.ceil(Math.log(A)/Math.LN2),O=O<=48?1:Math.pow(2,O-48),H=y(A),M=H.j(E);F(M)||M.l(R)>0;)A-=O,H=y(A),M=H.j(E);W(H)&&(H=T),D=D.add(H),R=ne(R,M)}return new oe(D,R)}n.B=function(R){return be(this,R).h},n.and=function(R){const E=Math.max(this.g.length,R.g.length),A=[];for(let O=0;O<E;O++)A[O]=this.i(O)&R.i(O);return new d(A,this.h&R.h)},n.or=function(R){const E=Math.max(this.g.length,R.g.length),A=[];for(let O=0;O<E;O++)A[O]=this.i(O)|R.i(O);return new d(A,this.h|R.h)},n.xor=function(R){const E=Math.max(this.g.length,R.g.length),A=[];for(let O=0;O<E;O++)A[O]=this.i(O)^R.i(O);return new d(A,this.h^R.h)};function Le(R){const E=R.g.length+1,A=[];for(let O=0;O<E;O++)A[O]=R.i(O)<<1|R.i(O-1)>>>31;return new d(A,R.h)}function Ce(R,E){const A=E>>5;E%=32;const O=R.g.length-A,D=[];for(let H=0;H<O;H++)D[H]=E>0?R.i(H+A)>>>E|R.i(H+A+1)<<32-E:R.i(H+A);return new d(D,R.h)}i.prototype.digest=i.prototype.A,i.prototype.reset=i.prototype.u,i.prototype.update=i.prototype.v,Fw=i,d.prototype.add=d.prototype.add,d.prototype.multiply=d.prototype.j,d.prototype.modulo=d.prototype.B,d.prototype.compare=d.prototype.l,d.prototype.toNumber=d.prototype.m,d.prototype.toString=d.prototype.toString,d.prototype.getBits=d.prototype.i,d.fromNumber=y,d.fromString=w,ro=d}).apply(typeof mx<"u"?mx:typeof self<"u"?self:typeof window<"u"?window:{});var th=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var zw,tu,qw,xh,fg,Hw,$w,Ww;(function(){var n,e=Object.defineProperty;function t(h){h=[typeof globalThis=="object"&&globalThis,h,typeof window=="object"&&window,typeof self=="object"&&self,typeof th=="object"&&th];for(var b=0;b<h.length;++b){var _=h[b];if(_&&_.Math==Math)return _}throw Error("Cannot find global object")}var i=t(this);function l(h,b){if(b)e:{var _=i;h=h.split(".");for(var C=0;C<h.length-1;C++){var re=h[C];if(!(re in _))break e;_=_[re]}h=h[h.length-1],C=_[h],b=b(C),b!=C&&b!=null&&e(_,h,{configurable:!0,writable:!0,value:b})}}l("Symbol.dispose",function(h){return h||Symbol("Symbol.dispose")}),l("Array.prototype.values",function(h){return h||function(){return this[Symbol.iterator]()}}),l("Object.entries",function(h){return h||function(b){var _=[],C;for(C in b)Object.prototype.hasOwnProperty.call(b,C)&&_.push([C,b[C]]);return _}});var u=u||{},d=this||self;function p(h){var b=typeof h;return b=="object"&&h!=null||b=="function"}function g(h,b,_){return h.call.apply(h.bind,arguments)}function y(h,b,_){return y=g,y.apply(null,arguments)}function w(h,b){var _=Array.prototype.slice.call(arguments,1);return function(){var C=_.slice();return C.push.apply(C,arguments),h.apply(this,C)}}function j(h,b){function _(){}_.prototype=b.prototype,h.Z=b.prototype,h.prototype=new _,h.prototype.constructor=h,h.Ob=function(C,re,he){for(var Ye=Array(arguments.length-2),Zt=2;Zt<arguments.length;Zt++)Ye[Zt-2]=arguments[Zt];return b.prototype[re].apply(C,Ye)}}var T=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?h=>h&&AsyncContext.Snapshot.wrap(h):h=>h;function V(h){const b=h.length;if(b>0){const _=Array(b);for(let C=0;C<b;C++)_[C]=h[C];return _}return[]}function W(h,b){for(let C=1;C<arguments.length;C++){const re=arguments[C];var _=typeof re;if(_=_!="object"?_:re?Array.isArray(re)?"array":_:"null",_=="array"||_=="object"&&typeof re.length=="number"){_=h.length||0;const he=re.length||0;h.length=_+he;for(let Ye=0;Ye<he;Ye++)h[_+Ye]=re[Ye]}else h.push(re)}}class F{constructor(b,_){this.i=b,this.j=_,this.h=0,this.g=null}get(){let b;return this.h>0?(this.h--,b=this.g,this.g=b.next,b.next=null):b=this.i(),b}}function U(h){d.setTimeout(()=>{throw h},0)}function ne(){var h=R;let b=null;return h.g&&(b=h.g,h.g=h.g.next,h.g||(h.h=null),b.next=null),b}class Y{constructor(){this.h=this.g=null}add(b,_){const C=oe.get();C.set(b,_),this.h?this.h.next=C:this.g=C,this.h=C}}var oe=new F(()=>new be,h=>h.reset());class be{constructor(){this.next=this.g=this.h=null}set(b,_){this.h=b,this.g=_,this.next=null}reset(){this.next=this.g=this.h=null}}let Le,Ce=!1,R=new Y,E=()=>{const h=Promise.resolve(void 0);Le=()=>{h.then(A)}};function A(){for(var h;h=ne();){try{h.h.call(h.g)}catch(_){U(_)}var b=oe;b.j(h),b.h<100&&(b.h++,h.next=b.g,b.g=h)}Ce=!1}function O(){this.u=this.u,this.C=this.C}O.prototype.u=!1,O.prototype.dispose=function(){this.u||(this.u=!0,this.N())},O.prototype[Symbol.dispose]=function(){this.dispose()},O.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function D(h,b){this.type=h,this.g=this.target=b,this.defaultPrevented=!1}D.prototype.h=function(){this.defaultPrevented=!0};var H=(function(){if(!d.addEventListener||!Object.defineProperty)return!1;var h=!1,b=Object.defineProperty({},"passive",{get:function(){h=!0}});try{const _=()=>{};d.addEventListener("test",_,b),d.removeEventListener("test",_,b)}catch{}return h})();function M(h){return/^[\s\xa0]*$/.test(h)}function We(h,b){D.call(this,h?h.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,h&&this.init(h,b)}j(We,D),We.prototype.init=function(h,b){const _=this.type=h.type,C=h.changedTouches&&h.changedTouches.length?h.changedTouches[0]:null;this.target=h.target||h.srcElement,this.g=b,b=h.relatedTarget,b||(_=="mouseover"?b=h.fromElement:_=="mouseout"&&(b=h.toElement)),this.relatedTarget=b,C?(this.clientX=C.clientX!==void 0?C.clientX:C.pageX,this.clientY=C.clientY!==void 0?C.clientY:C.pageY,this.screenX=C.screenX||0,this.screenY=C.screenY||0):(this.clientX=h.clientX!==void 0?h.clientX:h.pageX,this.clientY=h.clientY!==void 0?h.clientY:h.pageY,this.screenX=h.screenX||0,this.screenY=h.screenY||0),this.button=h.button,this.key=h.key||"",this.ctrlKey=h.ctrlKey,this.altKey=h.altKey,this.shiftKey=h.shiftKey,this.metaKey=h.metaKey,this.pointerId=h.pointerId||0,this.pointerType=h.pointerType,this.state=h.state,this.i=h,h.defaultPrevented&&We.Z.h.call(this)},We.prototype.h=function(){We.Z.h.call(this);const h=this.i;h.preventDefault?h.preventDefault():h.returnValue=!1};var gt="closure_listenable_"+(Math.random()*1e6|0),$=0;function me(h,b,_,C,re){this.listener=h,this.proxy=null,this.src=b,this.type=_,this.capture=!!C,this.ha=re,this.key=++$,this.da=this.fa=!1}function Ve(h){h.da=!0,h.listener=null,h.proxy=null,h.src=null,h.ha=null}function Ke(h,b,_){for(const C in h)b.call(_,h[C],C,h)}function J(h,b){for(const _ in h)b.call(void 0,h[_],_,h)}function L(h){const b={};for(const _ in h)b[_]=h[_];return b}const se="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Me(h,b){let _,C;for(let re=1;re<arguments.length;re++){C=arguments[re];for(_ in C)h[_]=C[_];for(let he=0;he<se.length;he++)_=se[he],Object.prototype.hasOwnProperty.call(C,_)&&(h[_]=C[_])}}function De(h){this.src=h,this.g={},this.h=0}De.prototype.add=function(h,b,_,C,re){const he=h.toString();h=this.g[he],h||(h=this.g[he]=[],this.h++);const Ye=Fe(h,b,C,re);return Ye>-1?(b=h[Ye],_||(b.fa=!1)):(b=new me(b,this.src,he,!!C,re),b.fa=_,h.push(b)),b};function Je(h,b){const _=b.type;if(_ in h.g){var C=h.g[_],re=Array.prototype.indexOf.call(C,b,void 0),he;(he=re>=0)&&Array.prototype.splice.call(C,re,1),he&&(Ve(b),h.g[_].length==0&&(delete h.g[_],h.h--))}}function Fe(h,b,_,C){for(let re=0;re<h.length;++re){const he=h[re];if(!he.da&&he.listener==b&&he.capture==!!_&&he.ha==C)return re}return-1}var bt="closure_lm_"+(Math.random()*1e6|0),kt={};function nt(h,b,_,C,re){if(Array.isArray(b)){for(let he=0;he<b.length;he++)nt(h,b[he],_,C,re);return null}return _=pt(_),h&&h[gt]?h.J(b,_,p(C)?!!C.capture:!1,re):Wt(h,b,_,!1,C,re)}function Wt(h,b,_,C,re,he){if(!b)throw Error("Invalid event type");const Ye=p(re)?!!re.capture:!!re;let Zt=Gt(h);if(Zt||(h[bt]=Zt=new De(h)),_=Zt.add(b,_,C,Ye,he),_.proxy)return _;if(C=ts(),_.proxy=C,C.src=h,C.listener=_,h.addEventListener)H||(re=Ye),re===void 0&&(re=!1),h.addEventListener(b.toString(),C,re);else if(h.attachEvent)h.attachEvent(ce(b.toString()),C);else if(h.addListener&&h.removeListener)h.addListener(C);else throw Error("addEventListener and attachEvent are unavailable.");return _}function ts(){function h(_){return b.call(h.src,h.listener,_)}const b=Xt;return h}function St(h,b,_,C,re){if(Array.isArray(b))for(var he=0;he<b.length;he++)St(h,b[he],_,C,re);else C=p(C)?!!C.capture:!!C,_=pt(_),h&&h[gt]?(h=h.i,he=String(b).toString(),he in h.g&&(b=h.g[he],_=Fe(b,_,C,re),_>-1&&(Ve(b[_]),Array.prototype.splice.call(b,_,1),b.length==0&&(delete h.g[he],h.h--)))):h&&(h=Gt(h))&&(b=h.g[b.toString()],h=-1,b&&(h=Fe(b,_,C,re)),(_=h>-1?b[h]:null)&&at(_))}function at(h){if(typeof h!="number"&&h&&!h.da){var b=h.src;if(b&&b[gt])Je(b.i,h);else{var _=h.type,C=h.proxy;b.removeEventListener?b.removeEventListener(_,C,h.capture):b.detachEvent?b.detachEvent(ce(_),C):b.addListener&&b.removeListener&&b.removeListener(C),(_=Gt(b))?(Je(_,h),_.h==0&&(_.src=null,b[bt]=null)):Ve(h)}}}function ce(h){return h in kt?kt[h]:kt[h]="on"+h}function Xt(h,b){if(h.da)h=!0;else{b=new We(b,this);const _=h.listener,C=h.ha||h.src;h.fa&&at(h),h=_.call(C,b)}return h}function Gt(h){return h=h[bt],h instanceof De?h:null}var rt="__closure_events_fn_"+(Math.random()*1e9>>>0);function pt(h){return typeof h=="function"?h:(h[rt]||(h[rt]=function(b){return h.handleEvent(b)}),h[rt])}function it(){O.call(this),this.i=new De(this),this.M=this,this.G=null}j(it,O),it.prototype[gt]=!0,it.prototype.removeEventListener=function(h,b,_,C){St(this,h,b,_,C)};function st(h,b){var _,C=h.G;if(C)for(_=[];C;C=C.G)_.push(C);if(h=h.M,C=b.type||b,typeof b=="string")b=new D(b,h);else if(b instanceof D)b.target=b.target||h;else{var re=b;b=new D(C,h),Me(b,re)}re=!0;let he,Ye;if(_)for(Ye=_.length-1;Ye>=0;Ye--)he=b.g=_[Ye],re=Kt(he,C,!0,b)&&re;if(he=b.g=h,re=Kt(he,C,!0,b)&&re,re=Kt(he,C,!1,b)&&re,_)for(Ye=0;Ye<_.length;Ye++)he=b.g=_[Ye],re=Kt(he,C,!1,b)&&re}it.prototype.N=function(){if(it.Z.N.call(this),this.i){var h=this.i;for(const b in h.g){const _=h.g[b];for(let C=0;C<_.length;C++)Ve(_[C]);delete h.g[b],h.h--}}this.G=null},it.prototype.J=function(h,b,_,C){return this.i.add(String(h),b,!1,_,C)},it.prototype.K=function(h,b,_,C){return this.i.add(String(h),b,!0,_,C)};function Kt(h,b,_,C){if(b=h.i.g[String(b)],!b)return!0;b=b.concat();let re=!0;for(let he=0;he<b.length;++he){const Ye=b[he];if(Ye&&!Ye.da&&Ye.capture==_){const Zt=Ye.listener,jn=Ye.ha||Ye.src;Ye.fa&&Je(h.i,Ye),re=Zt.call(jn,C)!==!1&&re}}return re&&!C.defaultPrevented}function Ks(h,b){if(typeof h!="function")if(h&&typeof h.handleEvent=="function")h=y(h.handleEvent,h);else throw Error("Invalid listener argument");return Number(b)>2147483647?-1:d.setTimeout(h,b||0)}function Ps(h){h.g=Ks(()=>{h.g=null,h.i&&(h.i=!1,Ps(h))},h.l);const b=h.h;h.h=null,h.m.apply(null,b)}class ss extends O{constructor(b,_){super(),this.m=b,this.l=_,this.h=null,this.i=!1,this.g=null}j(b){this.h=arguments,this.g?this.i=!0:Ps(this)}N(){super.N(),this.g&&(d.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Ct(h){O.call(this),this.h=h,this.g={}}j(Ct,O);var Jt=[];function vs(h){Ke(h.g,function(b,_){this.g.hasOwnProperty(_)&&at(b)},h),h.g={}}Ct.prototype.N=function(){Ct.Z.N.call(this),vs(this)},Ct.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Bt=d.JSON.stringify,As=d.JSON.parse,ue=class{stringify(h){return d.JSON.stringify(h,void 0)}parse(h){return d.JSON.parse(h,void 0)}};function Ee(){}function Ae(){}var ee={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function ge(){D.call(this,"d")}j(ge,D);function we(){D.call(this,"c")}j(we,D);var Oe={},Ue=null;function $e(){return Ue=Ue||new it}Oe.Ia="serverreachability";function ft(h){D.call(this,Oe.Ia,h)}j(ft,D);function jt(h){const b=$e();st(b,new ft(b))}Oe.STAT_EVENT="statevent";function Q(h,b){D.call(this,Oe.STAT_EVENT,h),this.stat=b}j(Q,D);function fe(h){const b=$e();st(b,new Q(b,h))}Oe.Ja="timingevent";function lt(h,b){D.call(this,Oe.Ja,h),this.size=b}j(lt,D);function At(h,b){if(typeof h!="function")throw Error("Fn must not be null and must be a function");return d.setTimeout(function(){h()},b)}function Tt(){this.g=!0}Tt.prototype.ua=function(){this.g=!1};function ns(h,b,_,C,re,he){h.info(function(){if(h.g)if(he){var Ye="",Zt=he.split("&");for(let Vs=0;Vs<Zt.length;Vs++){var jn=Zt[Vs].split("=");if(jn.length>1){const rn=jn[0];jn=jn[1];const Kr=rn.split("_");Ye=Kr.length>=2&&Kr[1]=="type"?Ye+(rn+"="+jn+"&"):Ye+(rn+"=redacted&")}}}else Ye=null;else Ye=he;return"XMLHTTP REQ ("+C+") [attempt "+re+"]: "+b+`
`+_+`
`+Ye})}function Ut(h,b,_,C,re,he,Ye){h.info(function(){return"XMLHTTP RESP ("+C+") [ attempt "+re+"]: "+b+`
`+_+`
`+he+" "+Ye})}function Ot(h,b,_,C){h.info(function(){return"XMLHTTP TEXT ("+b+"): "+Js(h,_)+(C?" "+C:"")})}function Ls(h,b){h.info(function(){return"TIMEOUT: "+b})}Tt.prototype.info=function(){};function Js(h,b){if(!h.g)return b;if(!b)return null;try{const he=JSON.parse(b);if(he){for(h=0;h<he.length;h++)if(Array.isArray(he[h])){var _=he[h];if(!(_.length<2)){var C=_[1];if(Array.isArray(C)&&!(C.length<1)){var re=C[0];if(re!="noop"&&re!="stop"&&re!="close")for(let Ye=1;Ye<C.length;Ye++)C[Ye]=""}}}}return Bt(he)}catch{return b}}var os={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Ss={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Os;function q(){}j(q,Ee),q.prototype.g=function(){return new XMLHttpRequest},Os=new q;function xe(h){return encodeURIComponent(String(h))}function je(h){var b=1;h=h.split(":");const _=[];for(;b>0&&h.length;)_.push(h.shift()),b--;return h.length&&_.push(h.join(":")),_}function Te(h,b,_,C){this.j=h,this.i=b,this.l=_,this.S=C||1,this.V=new Ct(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new _e}function _e(){this.i=null,this.g="",this.h=!1}var ct={},ht={};function et(h,b,_){h.M=1,h.A=qe(cs(b)),h.u=_,h.R=!0,vt(h,null)}function vt(h,b){h.F=Date.now(),ln(h),h.B=cs(h.A);var _=h.B,C=h.S;Array.isArray(C)||(C=[String(C)]),un(_.i,"t",C),h.C=0,_=h.j.L,h.h=new _e,h.g=Wu(h.j,_?b:null,!h.u),h.P>0&&(h.O=new ss(y(h.Y,h,h.g),h.P)),b=h.V,_=h.g,C=h.ba;var re="readystatechange";Array.isArray(re)||(re&&(Jt[0]=re.toString()),re=Jt);for(let he=0;he<re.length;he++){const Ye=nt(_,re[he],C||b.handleEvent,!1,b.h||b);if(!Ye)break;b.g[Ye.key]=Ye}b=h.J?L(h.J):{},h.u?(h.v||(h.v="POST"),b["Content-Type"]="application/x-www-form-urlencoded",h.g.ea(h.B,h.v,h.u,b)):(h.v="GET",h.g.ea(h.B,h.v,null,b)),jt(),ns(h.i,h.v,h.B,h.l,h.S,h.u)}Te.prototype.ba=function(h){h=h.target;const b=this.O;b&&as(h)==3?b.j():this.Y(h)},Te.prototype.Y=function(h){try{if(h==this.g)e:{const Zt=as(this.g),jn=this.g.ya(),Vs=this.g.ca();if(!(Zt<3)&&(Zt!=3||this.g&&(this.h.h||this.g.la()||Ft(this.g)))){this.K||Zt!=4||jn==7||(jn==8||Vs<=0?jt(3):jt(2)),kn(this);var b=this.g.ca();this.X=b;var _=Rt(this);if(this.o=b==200,Ut(this.i,this.v,this.B,this.l,this.S,Zt,b),this.o){if(this.U&&!this.L){t:{if(this.g){var C,re=this.g;if((C=re.g?re.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!M(C)){var he=C;break t}}he=null}if(h=he)Ot(this.i,this.l,h,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,k(this,h);else{this.o=!1,this.m=3,fe(12),Fs(this),fn(this);break e}}if(this.R){h=!0;let rn;for(;!this.K&&this.C<_.length;)if(rn=mn(this,_),rn==ht){Zt==4&&(this.m=4,fe(14),h=!1),Ot(this.i,this.l,null,"[Incomplete Response]");break}else if(rn==ct){this.m=4,fe(15),Ot(this.i,this.l,_,"[Invalid Chunk]"),h=!1;break}else Ot(this.i,this.l,rn,null),k(this,rn);if(js(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Zt!=4||_.length!=0||this.h.h||(this.m=1,fe(16),h=!1),this.o=this.o&&h,!h)Ot(this.i,this.l,_,"[Invalid Chunked Response]"),Fs(this),fn(this);else if(_.length>0&&!this.W){this.W=!0;var Ye=this.j;Ye.g==this&&Ye.aa&&!Ye.P&&(Ye.j.info("Great, no buffering proxy detected. Bytes received: "+_.length),hr(Ye),Ye.P=!0,fe(11))}}else Ot(this.i,this.l,_,null),k(this,_);Zt==4&&Fs(this),this.o&&!this.K&&(Zt==4?tl(this.j,this):(this.o=!1,ln(this)))}else _s(this.g),b==400&&_.indexOf("Unknown SID")>0?(this.m=3,fe(12)):(this.m=0,fe(13)),Fs(this),fn(this)}}}catch{}};function Rt(h){if(!js(h))return h.g.la();const b=Ft(h.g);if(b==="")return"";let _="";const C=b.length,re=as(h.g)==4;if(!h.h.i){if(typeof TextDecoder>"u")return Fs(h),fn(h),"";h.h.i=new d.TextDecoder}for(let he=0;he<C;he++)h.h.h=!0,_+=h.h.i.decode(b[he],{stream:!(re&&he==C-1)});return b.length=0,h.h.g+=_,h.C=0,h.h.g}function js(h){return h.g?h.v=="GET"&&h.M!=2&&h.j.Aa:!1}function mn(h,b){var _=h.C,C=b.indexOf(`
`,_);return C==-1?ht:(_=Number(b.substring(_,C)),isNaN(_)?ct:(C+=1,C+_>b.length?ht:(b=b.slice(C,C+_),h.C=C+_,b)))}Te.prototype.cancel=function(){this.K=!0,Fs(this)};function ln(h){h.T=Date.now()+h.H,_n(h,h.H)}function _n(h,b){if(h.D!=null)throw Error("WatchDog timer not null");h.D=At(y(h.aa,h),b)}function kn(h){h.D&&(d.clearTimeout(h.D),h.D=null)}Te.prototype.aa=function(){this.D=null;const h=Date.now();h-this.T>=0?(Ls(this.i,this.B),this.M!=2&&(jt(),fe(17)),Fs(this),this.m=2,fn(this)):_n(this,this.T-h)};function fn(h){h.j.I==0||h.K||tl(h.j,h)}function Fs(h){kn(h);var b=h.O;b&&typeof b.dispose=="function"&&b.dispose(),h.O=null,vs(h.V),h.g&&(b=h.g,h.g=null,b.abort(),b.dispose())}function k(h,b){try{var _=h.j;if(_.I!=0&&(_.g==h||Be(_.h,h))){if(!h.L&&Be(_.h,h)&&_.I==3){try{var C=_.Ba.g.parse(b)}catch{C=null}if(Array.isArray(C)&&C.length==3){var re=C;if(re[0]==0){e:if(!_.v){if(_.g)if(_.g.F+3e3<h.F)Ha(_),Ys(_);else break e;gn(_),fe(18)}}else _.xa=re[1],0<_.xa-_.K&&re[2]<37500&&_.F&&_.A==0&&!_.C&&(_.C=At(y(_.Va,_),6e3));de(_.h)<=1&&_.ta&&(_.ta=void 0)}else mr(_,11)}else if((h.L||_.g==h)&&Ha(_),!M(b))for(re=_.Ba.g.parse(b),b=0;b<re.length;b++){let Vs=re[b];const rn=Vs[0];if(!(rn<=_.K))if(_.K=rn,Vs=Vs[1],_.I==2)if(Vs[0]=="c"){_.M=Vs[1],_.ba=Vs[2];const Kr=Vs[3];Kr!=null&&(_.ka=Kr,_.j.info("VER="+_.ka));const Ea=Vs[4];Ea!=null&&(_.za=Ea,_.j.info("SVER="+_.za));const la=Vs[5];la!=null&&typeof la=="number"&&la>0&&(C=1.5*la,_.O=C,_.j.info("backChannelRequestTimeoutMs_="+C)),C=_;const ca=h.g;if(ca){const bo=ca.g?ca.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(bo){var he=C.h;he.g||bo.indexOf("spdy")==-1&&bo.indexOf("quic")==-1&&bo.indexOf("h2")==-1||(he.j=he.l,he.g=new Set,he.h&&(ze(he,he.h),he.h=null))}if(C.G){const nl=ca.g?ca.g.getResponseHeader("X-HTTP-Session-Id"):null;nl&&(C.wa=nl,te(C.J,C.G,nl))}}_.I=3,_.l&&_.l.ra(),_.aa&&(_.T=Date.now()-h.F,_.j.info("Handshake RTT: "+_.T+"ms")),C=_;var Ye=h;if(C.na=oa(C,C.L?C.ba:null,C.W),Ye.L){Qe(C.h,Ye);var Zt=Ye,jn=C.O;jn&&(Zt.H=jn),Zt.D&&(kn(Zt),ln(Zt)),C.g=Ye}else rr(C);_.i.length>0&&dn(_)}else Vs[0]!="stop"&&Vs[0]!="close"||mr(_,7);else _.I==3&&(Vs[0]=="stop"||Vs[0]=="close"?Vs[0]=="stop"?mr(_,7):Zs(_):Vs[0]!="noop"&&_.l&&_.l.qa(Vs),_.A=0)}}jt(4)}catch{}}var S=class{constructor(h,b){this.g=h,this.map=b}};function P(h){this.l=h||10,d.PerformanceNavigationTiming?(h=d.performance.getEntriesByType("navigation"),h=h.length>0&&(h[0].nextHopProtocol=="hq"||h[0].nextHopProtocol=="h2")):h=!!(d.chrome&&d.chrome.loadTimes&&d.chrome.loadTimes()&&d.chrome.loadTimes().wasFetchedViaSpdy),this.j=h?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function B(h){return h.h?!0:h.g?h.g.size>=h.j:!1}function de(h){return h.h?1:h.g?h.g.size:0}function Be(h,b){return h.h?h.h==b:h.g?h.g.has(b):!1}function ze(h,b){h.g?h.g.add(b):h.h=b}function Qe(h,b){h.h&&h.h==b?h.h=null:h.g&&h.g.has(b)&&h.g.delete(b)}P.prototype.cancel=function(){if(this.i=Xe(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const h of this.g.values())h.cancel();this.g.clear()}};function Xe(h){if(h.h!=null)return h.i.concat(h.h.G);if(h.g!=null&&h.g.size!==0){let b=h.i;for(const _ of h.g.values())b=b.concat(_.G);return b}return V(h.i)}var qt=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function xs(h,b){if(h){h=h.split("&");for(let _=0;_<h.length;_++){const C=h[_].indexOf("=");let re,he=null;C>=0?(re=h[_].substring(0,C),he=h[_].substring(C+1)):re=h[_],b(re,he?decodeURIComponent(he.replace(/\+/g," ")):"")}}}function ls(h){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let b;h instanceof ls?(this.l=h.l,Cs(this,h.j),this.o=h.o,this.g=h.g,K(this,h.u),this.h=h.h,ve(this,sr(h.i)),this.m=h.m):h&&(b=String(h).match(qt))?(this.l=!1,Cs(this,b[1]||"",!0),this.o=Ge(b[2]||""),this.g=Ge(b[3]||"",!0),K(this,b[4]),this.h=Ge(b[5]||"",!0),ve(this,b[6]||"",!0),this.m=Ge(b[7]||"")):(this.l=!1,this.i=new Gr(null,this.l))}ls.prototype.toString=function(){const h=[];var b=this.j;b&&h.push(ut(b,Mt,!0),":");var _=this.g;return(_||b=="file")&&(h.push("//"),(b=this.o)&&h.push(ut(b,Mt,!0),"@"),h.push(xe(_).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),_=this.u,_!=null&&h.push(":",String(_))),(_=this.h)&&(this.g&&_.charAt(0)!="/"&&h.push("/"),h.push(ut(_,_.charAt(0)=="/"?cn:ws,!0))),(_=this.i.toString())&&h.push("?",_),(_=this.m)&&h.push("#",ut(_,Wn)),h.join("")},ls.prototype.resolve=function(h){const b=cs(this);let _=!!h.j;_?Cs(b,h.j):_=!!h.o,_?b.o=h.o:_=!!h.g,_?b.g=h.g:_=h.u!=null;var C=h.h;if(_)K(b,h.u);else if(_=!!h.h){if(C.charAt(0)!="/")if(this.g&&!this.h)C="/"+C;else{var re=b.h.lastIndexOf("/");re!=-1&&(C=b.h.slice(0,re+1)+C)}if(re=C,re==".."||re==".")C="";else if(re.indexOf("./")!=-1||re.indexOf("/.")!=-1){C=re.lastIndexOf("/",0)==0,re=re.split("/");const he=[];for(let Ye=0;Ye<re.length;){const Zt=re[Ye++];Zt=="."?C&&Ye==re.length&&he.push(""):Zt==".."?((he.length>1||he.length==1&&he[0]!="")&&he.pop(),C&&Ye==re.length&&he.push("")):(he.push(Zt),C=!0)}C=he.join("/")}else C=re}return _?b.h=C:_=h.i.toString()!=="",_?ve(b,sr(h.i)):_=!!h.m,_&&(b.m=h.m),b};function cs(h){return new ls(h)}function Cs(h,b,_){h.j=_?Ge(b,!0):b,h.j&&(h.j=h.j.replace(/:$/,""))}function K(h,b){if(b){if(b=Number(b),isNaN(b)||b<0)throw Error("Bad port number "+b);h.u=b}else h.u=null}function ve(h,b,_){b instanceof Gr?(h.i=b,_r(h.i,h.l)):(_||(b=ut(b,ms)),h.i=new Gr(b,h.l))}function te(h,b,_){h.i.set(b,_)}function qe(h){return te(h,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),h}function Ge(h,b){return h?b?decodeURI(h.replace(/%25/g,"%2525")):decodeURIComponent(h):""}function ut(h,b,_){return typeof h=="string"?(h=encodeURI(h).replace(b,wt),_&&(h=h.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),h):null}function wt(h){return h=h.charCodeAt(0),"%"+(h>>4&15).toString(16)+(h&15).toString(16)}var Mt=/[#\/\?@]/g,ws=/[#\?:]/g,cn=/[#\?]/g,ms=/[#\?@]/g,Wn=/#/g;function Gr(h,b){this.h=this.g=null,this.i=h||null,this.j=!!b}function pn(h){h.g||(h.g=new Map,h.h=0,h.i&&xs(h.i,function(b,_){h.add(decodeURIComponent(b.replace(/\+/g," ")),_)}))}n=Gr.prototype,n.add=function(h,b){pn(this),this.i=null,h=Gn(this,h);let _=this.g.get(h);return _||this.g.set(h,_=[]),_.push(b),this.h+=1,this};function ja(h,b){pn(h),b=Gn(h,b),h.g.has(b)&&(h.i=null,h.h-=h.g.get(b).length,h.g.delete(b))}function Un(h,b){return pn(h),b=Gn(h,b),h.g.has(b)}n.forEach=function(h,b){pn(this),this.g.forEach(function(_,C){_.forEach(function(re){h.call(b,re,C,this)},this)},this)};function is(h,b){pn(h);let _=[];if(typeof b=="string")Un(h,b)&&(_=_.concat(h.g.get(Gn(h,b))));else for(h=Array.from(h.g.values()),b=0;b<h.length;b++)_=_.concat(h[b]);return _}n.set=function(h,b){return pn(this),this.i=null,h=Gn(this,h),Un(this,h)&&(this.h-=this.g.get(h).length),this.g.set(h,[b]),this.h+=1,this},n.get=function(h,b){return h?(h=is(this,h),h.length>0?String(h[0]):b):b};function un(h,b,_){ja(h,b),_.length>0&&(h.i=null,h.g.set(Gn(h,b),V(_)),h.h+=_.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const h=[],b=Array.from(this.g.keys());for(let C=0;C<b.length;C++){var _=b[C];const re=xe(_);_=is(this,_);for(let he=0;he<_.length;he++){let Ye=re;_[he]!==""&&(Ye+="="+xe(_[he])),h.push(Ye)}}return this.i=h.join("&")};function sr(h){const b=new Gr;return b.i=h.i,h.g&&(b.g=new Map(h.g),b.h=h.h),b}function Gn(h,b){return b=String(b),h.j&&(b=b.toLowerCase()),b}function _r(h,b){b&&!h.j&&(pn(h),h.i=null,h.g.forEach(function(_,C){const re=C.toLowerCase();C!=re&&(ja(this,C),un(this,re,_))},h)),h.j=b}function tn(h,b){const _=new Tt;if(d.Image){const C=new Image;C.onload=w(Sn,_,"TestLoadImage: loaded",!0,b,C),C.onerror=w(Sn,_,"TestLoadImage: error",!1,b,C),C.onabort=w(Sn,_,"TestLoadImage: abort",!1,b,C),C.ontimeout=w(Sn,_,"TestLoadImage: timeout",!1,b,C),d.setTimeout(function(){C.ontimeout&&C.ontimeout()},1e4),C.src=h}else b(!1)}function Ln(h,b){const _=new Tt,C=new AbortController,re=setTimeout(()=>{C.abort(),Sn(_,"TestPingServer: timeout",!1,b)},1e4);fetch(h,{signal:C.signal}).then(he=>{clearTimeout(re),he.ok?Sn(_,"TestPingServer: ok",!0,b):Sn(_,"TestPingServer: server error",!1,b)}).catch(()=>{clearTimeout(re),Sn(_,"TestPingServer: error",!1,b)})}function Sn(h,b,_,C,re){try{re&&(re.onload=null,re.onerror=null,re.onabort=null,re.ontimeout=null),C(_)}catch{}}function kr(){this.g=new ue}function jr(h){this.i=h.Sb||null,this.h=h.ab||!1}j(jr,Ee),jr.prototype.g=function(){return new Dr(this.i,this.h)};function Dr(h,b){it.call(this),this.H=h,this.o=b,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}j(Dr,it),n=Dr.prototype,n.open=function(h,b){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=h,this.D=b,this.readyState=1,Pr(this)},n.send=function(h){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const b={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};h&&(b.body=h),(this.H||d).fetch(new Request(this.D,b)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Ta(this)),this.readyState=0},n.Pa=function(h){if(this.g&&(this.l=h,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=h.headers,this.readyState=2,Pr(this)),this.g&&(this.readyState=3,Pr(this),this.g)))if(this.responseType==="arraybuffer")h.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof d.ReadableStream<"u"&&"body"in h){if(this.j=h.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;wi(this)}else h.text().then(this.Oa.bind(this),this.ga.bind(this))};function wi(h){h.j.read().then(h.Ma.bind(h)).catch(h.ga.bind(h))}n.Ma=function(h){if(this.g){if(this.o&&h.value)this.response.push(h.value);else if(!this.o){var b=h.value?h.value:new Uint8Array(0);(b=this.B.decode(b,{stream:!h.done}))&&(this.response=this.responseText+=b)}h.done?Ta(this):Pr(this),this.readyState==3&&wi(this)}},n.Oa=function(h){this.g&&(this.response=this.responseText=h,Ta(this))},n.Na=function(h){this.g&&(this.response=h,Ta(this))},n.ga=function(){this.g&&Ta(this)};function Ta(h){h.readyState=4,h.l=null,h.j=null,h.B=null,Pr(h)}n.setRequestHeader=function(h,b){this.A.append(h,b)},n.getResponseHeader=function(h){return this.h&&this.h.get(h.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const h=[],b=this.h.entries();for(var _=b.next();!_.done;)_=_.value,h.push(_[0]+": "+_[1]),_=b.next();return h.join(`\r
`)};function Pr(h){h.onreadystatechange&&h.onreadystatechange.call(h)}Object.defineProperty(Dr.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(h){this.m=h?"include":"same-origin"}});function I(h){let b="";return Ke(h,function(_,C){b+=C,b+=":",b+=_,b+=`\r
`}),b}function Z(h,b,_){e:{for(C in _){var C=!1;break e}C=!0}C||(_=I(_),typeof h=="string"?_!=null&&xe(_):te(h,b,_))}function Ne(h){it.call(this),this.headers=new Map,this.L=h||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}j(Ne,it);var Ze=/^https?$/i,_t=["POST","PUT"];n=Ne.prototype,n.Fa=function(h){this.H=h},n.ea=function(h,b,_,C){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+h);b=b?b.toUpperCase():"GET",this.D=h,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Os.g(),this.g.onreadystatechange=T(y(this.Ca,this));try{this.B=!0,this.g.open(b,String(h),!0),this.B=!1}catch(he){Dt(this,he);return}if(h=_||"",_=new Map(this.headers),C)if(Object.getPrototypeOf(C)===Object.prototype)for(var re in C)_.set(re,C[re]);else if(typeof C.keys=="function"&&typeof C.get=="function")for(const he of C.keys())_.set(he,C.get(he));else throw Error("Unknown input type for opt_headers: "+String(C));C=Array.from(_.keys()).find(he=>he.toLowerCase()=="content-type"),re=d.FormData&&h instanceof d.FormData,!(Array.prototype.indexOf.call(_t,b,void 0)>=0)||C||re||_.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[he,Ye]of _)this.g.setRequestHeader(he,Ye);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(h),this.v=!1}catch(he){Dt(this,he)}};function Dt(h,b){h.h=!1,h.g&&(h.j=!0,h.g.abort(),h.j=!1),h.l=b,h.o=5,ot(h),Ht(h)}function ot(h){h.A||(h.A=!0,st(h,"complete"),st(h,"error"))}n.abort=function(h){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=h||7,st(this,"complete"),st(this,"abort"),Ht(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Ht(this,!0)),Ne.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?Vt(this):this.Xa())},n.Xa=function(){Vt(this)};function Vt(h){if(h.h&&typeof u<"u"){if(h.v&&as(h)==4)setTimeout(h.Ca.bind(h),0);else if(st(h,"readystatechange"),as(h)==4){h.h=!1;try{const he=h.ca();e:switch(he){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var b=!0;break e;default:b=!1}var _;if(!(_=b)){var C;if(C=he===0){let Ye=String(h.D).match(qt)[1]||null;!Ye&&d.self&&d.self.location&&(Ye=d.self.location.protocol.slice(0,-1)),C=!Ze.test(Ye?Ye.toLowerCase():"")}_=C}if(_)st(h,"complete"),st(h,"success");else{h.o=6;try{var re=as(h)>2?h.g.statusText:""}catch{re=""}h.l=re+" ["+h.ca()+"]",ot(h)}}finally{Ht(h)}}}}function Ht(h,b){if(h.g){h.m&&(clearTimeout(h.m),h.m=null);const _=h.g;h.g=null,b||st(h,"ready");try{_.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function as(h){return h.g?h.g.readyState:0}n.ca=function(){try{return as(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(h){if(this.g){var b=this.g.responseText;return h&&b.indexOf(h)==0&&(b=b.substring(h.length)),As(b)}};function Ft(h){try{if(!h.g)return null;if("response"in h.g)return h.g.response;switch(h.F){case"":case"text":return h.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in h.g)return h.g.mozResponseArrayBuffer}return null}catch{return null}}function _s(h){const b={};h=(h.g&&as(h)>=2&&h.g.getAllResponseHeaders()||"").split(`\r
`);for(let C=0;C<h.length;C++){if(M(h[C]))continue;var _=je(h[C]);const re=_[0];if(_=_[1],typeof _!="string")continue;_=_.trim();const he=b[re]||[];b[re]=he,he.push(_)}J(b,function(C){return C.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Fn(h,b,_){return _&&_.internalChannelParams&&_.internalChannelParams[h]||b}function ur(h){this.za=0,this.i=[],this.j=new Tt,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Fn("failFast",!1,h),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Fn("baseRetryDelayMs",5e3,h),this.Za=Fn("retryDelaySeedMs",1e4,h),this.Ta=Fn("forwardChannelMaxRetries",2,h),this.va=Fn("forwardChannelRequestTimeoutMs",2e4,h),this.ma=h&&h.xmlHttpFactory||void 0,this.Ua=h&&h.Rb||void 0,this.Aa=h&&h.useFetchStreams||!1,this.O=void 0,this.L=h&&h.supportsCrossDomainXhr||!1,this.M="",this.h=new P(h&&h.concurrentRequestLimit),this.Ba=new kr,this.S=h&&h.fastHandshake||!1,this.R=h&&h.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=h&&h.Pb||!1,h&&h.ua&&this.j.ua(),h&&h.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&h&&h.detectBufferingProxy||!1,this.ia=void 0,h&&h.longPollingTimeout&&h.longPollingTimeout>0&&(this.ia=h.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=ur.prototype,n.ka=8,n.I=1,n.connect=function(h,b,_,C){fe(0),this.W=h,this.H=b||{},_&&C!==void 0&&(this.H.OSID=_,this.H.OAID=C),this.F=this.X,this.J=oa(this,null,this.W),dn(this)};function Zs(h){if(zn(h),h.I==3){var b=h.V++,_=cs(h.J);if(te(_,"SID",h.M),te(_,"RID",b),te(_,"TYPE","terminate"),Kn(h,_),b=new Te(h,h.j,b),b.M=2,b.A=qe(cs(_)),_=!1,d.navigator&&d.navigator.sendBeacon)try{_=d.navigator.sendBeacon(b.A.toString(),"")}catch{}!_&&d.Image&&(new Image().src=b.A,_=!0),_||(b.g=Wu(b.j,null),b.g.ea(b.A)),b.F=Date.now(),ln(b)}ia(h)}function Ys(h){h.g&&(hr(h),h.g.cancel(),h.g=null)}function zn(h){Ys(h),h.v&&(d.clearTimeout(h.v),h.v=null),Ha(h),h.h.cancel(),h.m&&(typeof h.m=="number"&&d.clearTimeout(h.m),h.m=null)}function dn(h){if(!B(h.h)&&!h.m){h.m=!0;var b=h.Ea;Le||E(),Ce||(Le(),Ce=!0),R.add(b,h),h.D=0}}function On(h,b){return de(h.h)>=h.h.j-(h.m?1:0)?!1:h.m?(h.i=b.G.concat(h.i),!0):h.I==1||h.I==2||h.D>=(h.Sa?0:h.Ta)?!1:(h.m=At(y(h.Ea,h,b),sl(h,h.D)),h.D++,!0)}n.Ea=function(h){if(this.m)if(this.m=null,this.I==1){if(!h){this.V=Math.floor(Math.random()*1e5),h=this.V++;const re=new Te(this,this.j,h);let he=this.o;if(this.U&&(he?(he=L(he),Me(he,this.U)):he=this.U),this.u!==null||this.R||(re.J=he,he=null),this.S)e:{for(var b=0,_=0;_<this.i.length;_++){t:{var C=this.i[_];if("__data__"in C.map&&(C=C.map.__data__,typeof C=="string")){C=C.length;break t}C=void 0}if(C===void 0)break;if(b+=C,b>4096){b=_;break e}if(b===4096||_===this.i.length-1){b=_+1;break e}}b=1e3}else b=1e3;b=dr(this,re,b),_=cs(this.J),te(_,"RID",h),te(_,"CVER",22),this.G&&te(_,"X-HTTP-Session-Id",this.G),Kn(this,_),he&&(this.R?b="headers="+xe(I(he))+"&"+b:this.u&&Z(_,this.u,he)),ze(this.h,re),this.Ra&&te(_,"TYPE","init"),this.S?(te(_,"$req",b),te(_,"SID","null"),re.U=!0,et(re,_,null)):et(re,_,b),this.I=2}}else this.I==3&&(h?nr(this,h):this.i.length==0||B(this.h)||nr(this))};function nr(h,b){var _;b?_=b.l:_=h.V++;const C=cs(h.J);te(C,"SID",h.M),te(C,"RID",_),te(C,"AID",h.K),Kn(h,C),h.u&&h.o&&Z(C,h.u,h.o),_=new Te(h,h.j,_,h.D+1),h.u===null&&(_.J=h.o),b&&(h.i=b.G.concat(h.i)),b=dr(h,_,1e3),_.H=Math.round(h.va*.5)+Math.round(h.va*.5*Math.random()),ze(h.h,_),et(_,C,b)}function Kn(h,b){h.H&&Ke(h.H,function(_,C){te(b,C,_)}),h.l&&Ke({},function(_,C){te(b,C,_)})}function dr(h,b,_){_=Math.min(h.i.length,_);const C=h.l?y(h.l.Ka,h.l,h):null;e:{var re=h.i;let Zt=-1;for(;;){const jn=["count="+_];Zt==-1?_>0?(Zt=re[0].g,jn.push("ofs="+Zt)):Zt=0:jn.push("ofs="+Zt);let Vs=!0;for(let rn=0;rn<_;rn++){var he=re[rn].g;const Kr=re[rn].map;if(he-=Zt,he<0)Zt=Math.max(0,re[rn].g-100),Vs=!1;else try{he="req"+he+"_"||"";try{var Ye=Kr instanceof Map?Kr:Object.entries(Kr);for(const[Ea,la]of Ye){let ca=la;p(la)&&(ca=Bt(la)),jn.push(he+Ea+"="+encodeURIComponent(ca))}}catch(Ea){throw jn.push(he+"type="+encodeURIComponent("_badmap")),Ea}}catch{C&&C(Kr)}}if(Vs){Ye=jn.join("&");break e}}Ye=void 0}return h=h.i.splice(0,_),b.G=h,Ye}function rr(h){if(!h.g&&!h.v){h.Y=1;var b=h.Da;Le||E(),Ce||(Le(),Ce=!0),R.add(b,h),h.A=0}}function gn(h){return h.g||h.v||h.A>=3?!1:(h.Y++,h.v=At(y(h.Da,h),sl(h,h.A)),h.A++,!0)}n.Da=function(){if(this.v=null,Tr(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var h=4*this.T;this.j.info("BP detection timer enabled: "+h),this.B=At(y(this.Wa,this),h)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,fe(10),Ys(this),Tr(this))};function hr(h){h.B!=null&&(d.clearTimeout(h.B),h.B=null)}function Tr(h){h.g=new Te(h,h.j,"rpc",h.Y),h.u===null&&(h.g.J=h.o),h.g.P=0;var b=cs(h.na);te(b,"RID","rpc"),te(b,"SID",h.M),te(b,"AID",h.K),te(b,"CI",h.F?"0":"1"),!h.F&&h.ia&&te(b,"TO",h.ia),te(b,"TYPE","xmlhttp"),Kn(h,b),h.u&&h.o&&Z(b,h.u,h.o),h.O&&(h.g.H=h.O);var _=h.g;h=h.ba,_.M=1,_.A=qe(cs(b)),_.u=null,_.R=!0,vt(_,h)}n.Va=function(){this.C!=null&&(this.C=null,Ys(this),gn(this),fe(19))};function Ha(h){h.C!=null&&(d.clearTimeout(h.C),h.C=null)}function tl(h,b){var _=null;if(h.g==b){Ha(h),hr(h),h.g=null;var C=2}else if(Be(h.h,b))_=b.G,Qe(h.h,b),C=1;else return;if(h.I!=0){if(b.o)if(C==1){_=b.u?b.u.length:0,b=Date.now()-b.F;var re=h.D;C=$e(),st(C,new lt(C,_)),dn(h)}else rr(h);else if(re=b.m,re==3||re==0&&b.X>0||!(C==1&&On(h,b)||C==2&&gn(h)))switch(_&&_.length>0&&(b=h.h,b.i=b.i.concat(_)),re){case 1:mr(h,5);break;case 4:mr(h,10);break;case 3:mr(h,6);break;default:mr(h,2)}}}function sl(h,b){let _=h.Qa+Math.floor(Math.random()*h.Za);return h.isActive()||(_*=2),_*b}function mr(h,b){if(h.j.info("Error code "+b),b==2){var _=y(h.bb,h),C=h.Ua;const re=!C;C=new ls(C||"//www.google.com/images/cleardot.gif"),d.location&&d.location.protocol=="http"||Cs(C,"https"),qe(C),re?tn(C.toString(),_):Ln(C.toString(),_)}else fe(2);h.I=0,h.l&&h.l.pa(b),ia(h),zn(h)}n.bb=function(h){h?(this.j.info("Successfully pinged google.com"),fe(2)):(this.j.info("Failed to ping google.com"),fe(1))};function ia(h){if(h.I=0,h.ja=[],h.l){const b=Xe(h.h);(b.length!=0||h.i.length!=0)&&(W(h.ja,b),W(h.ja,h.i),h.h.i.length=0,V(h.i),h.i.length=0),h.l.oa()}}function oa(h,b,_){var C=_ instanceof ls?cs(_):new ls(_);if(C.g!="")b&&(C.g=b+"."+C.g),K(C,C.u);else{var re=d.location;C=re.protocol,b=b?b+"."+re.hostname:re.hostname,re=+re.port;const he=new ls(null);C&&Cs(he,C),b&&(he.g=b),re&&K(he,re),_&&(he.h=_),C=he}return _=h.G,b=h.wa,_&&b&&te(C,_,b),te(C,"VER",h.ka),Kn(h,C),C}function Wu(h,b,_){if(b&&!h.L)throw Error("Can't create secondary domain capable XhrIo object.");return b=h.Aa&&!h.ma?new Ne(new jr({ab:_})):new Ne(h.ma),b.Fa(h.L),b}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Gu(){}n=Gu.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function _i(){}_i.prototype.g=function(h,b){return new fr(h,b)};function fr(h,b){it.call(this),this.g=new ur(b),this.l=h,this.h=b&&b.messageUrlParams||null,h=b&&b.messageHeaders||null,b&&b.clientProtocolHeaderRequired&&(h?h["X-Client-Protocol"]="webchannel":h={"X-Client-Protocol":"webchannel"}),this.g.o=h,h=b&&b.initMessageHeaders||null,b&&b.messageContentType&&(h?h["X-WebChannel-Content-Type"]=b.messageContentType:h={"X-WebChannel-Content-Type":b.messageContentType}),b&&b.sa&&(h?h["X-WebChannel-Client-Profile"]=b.sa:h={"X-WebChannel-Client-Profile":b.sa}),this.g.U=h,(h=b&&b.Qb)&&!M(h)&&(this.g.u=h),this.A=b&&b.supportsCrossDomainXhr||!1,this.v=b&&b.sendRawJson||!1,(b=b&&b.httpSessionIdParam)&&!M(b)&&(this.g.G=b,h=this.h,h!==null&&b in h&&(h=this.h,b in h&&delete h[b])),this.j=new $a(this)}j(fr,it),fr.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},fr.prototype.close=function(){Zs(this.g)},fr.prototype.o=function(h){var b=this.g;if(typeof h=="string"){var _={};_.__data__=h,h=_}else this.v&&(_={},_.__data__=Bt(h),h=_);b.i.push(new S(b.Ya++,h)),b.I==3&&dn(b)},fr.prototype.N=function(){this.g.l=null,delete this.j,Zs(this.g),delete this.g,fr.Z.N.call(this)};function Ku(h){ge.call(this),h.__headers__&&(this.headers=h.__headers__,this.statusCode=h.__status__,delete h.__headers__,delete h.__status__);var b=h.__sm__;if(b){e:{for(const _ in b){h=_;break e}h=void 0}(this.i=h)&&(h=this.i,b=b!==null&&h in b?b[h]:void 0),this.data=b}else this.data=h}j(Ku,ge);function Yu(){we.call(this),this.status=1}j(Yu,we);function $a(h){this.g=h}j($a,Gu),$a.prototype.ra=function(){st(this.g,"a")},$a.prototype.qa=function(h){st(this.g,new Ku(h))},$a.prototype.pa=function(h){st(this.g,new Yu)},$a.prototype.oa=function(){st(this.g,"b")},_i.prototype.createWebChannel=_i.prototype.g,fr.prototype.send=fr.prototype.o,fr.prototype.open=fr.prototype.m,fr.prototype.close=fr.prototype.close,Ww=function(){return new _i},$w=function(){return $e()},Hw=Oe,fg={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},os.NO_ERROR=0,os.TIMEOUT=8,os.HTTP_ERROR=6,xh=os,Ss.COMPLETE="complete",qw=Ss,Ae.EventType=ee,ee.OPEN="a",ee.CLOSE="b",ee.ERROR="c",ee.MESSAGE="d",it.prototype.listen=it.prototype.J,tu=Ae,Ne.prototype.listenOnce=Ne.prototype.K,Ne.prototype.getLastError=Ne.prototype.Ha,Ne.prototype.getLastErrorCode=Ne.prototype.ya,Ne.prototype.getStatus=Ne.prototype.ca,Ne.prototype.getResponseJson=Ne.prototype.La,Ne.prototype.getResponseText=Ne.prototype.la,Ne.prototype.send=Ne.prototype.ea,Ne.prototype.setWithCredentials=Ne.prototype.Fa,zw=Ne}).apply(typeof th<"u"?th:typeof self<"u"?self:typeof window<"u"?window:{});class or{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}or.UNAUTHENTICATED=new or(null),or.GOOGLE_CREDENTIALS=new or("google-credentials-uid"),or.FIRST_PARTY=new or("first-party-uid"),or.MOCK_USER=new or("mock-user");let rc="12.8.0";function aR(n){rc=n}const Ko=new qg("@firebase/firestore");function Vl(){return Ko.logLevel}function dt(n,...e){if(Ko.logLevel<=gs.DEBUG){const t=e.map(sy);Ko.debug(`Firestore (${rc}): ${n}`,...t)}}function gi(n,...e){if(Ko.logLevel<=gs.ERROR){const t=e.map(sy);Ko.error(`Firestore (${rc}): ${n}`,...t)}}function Kl(n,...e){if(Ko.logLevel<=gs.WARN){const t=e.map(sy);Ko.warn(`Firestore (${rc}): ${n}`,...t)}}function sy(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}function Lt(n,e,t){let i="Unexpected state";typeof e=="string"?i=e:t=e,Gw(n,i,t)}function Gw(n,e,t){let i=`FIRESTORE (${rc}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{i+=" CONTEXT: "+JSON.stringify(t)}catch{i+=" CONTEXT: "+t}throw gi(i),new Error(i)}function Us(n,e,t,i){let l="Unexpected state";typeof t=="string"?l=t:i=t,n||Gw(e,l,i)}function Qt(n,e){return n}const Se={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class tt extends qa{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class di{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class Kw{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class iR{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(or.UNAUTHENTICATED)))}shutdown(){}}class oR{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class lR{constructor(e){this.t=e,this.currentUser=or.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Us(this.o===void 0,42304);let i=this.i;const l=g=>this.i!==i?(i=this.i,t(g)):Promise.resolve();let u=new di;this.o=()=>{this.i++,this.currentUser=this.u(),u.resolve(),u=new di,e.enqueueRetryable((()=>l(this.currentUser)))};const d=()=>{const g=u;e.enqueueRetryable((async()=>{await g.promise,await l(this.currentUser)}))},p=g=>{dt("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=g,this.o&&(this.auth.addAuthTokenListener(this.o),d())};this.t.onInit((g=>p(g))),setTimeout((()=>{if(!this.auth){const g=this.t.getImmediate({optional:!0});g?p(g):(dt("FirebaseAuthCredentialsProvider","Auth not yet detected"),u.resolve(),u=new di)}}),0),d()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((i=>this.i!==e?(dt("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(Us(typeof i.accessToken=="string",31837,{l:i}),new Kw(i.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Us(e===null||typeof e=="string",2055,{h:e}),new or(e)}}class cR{constructor(e,t,i){this.P=e,this.T=t,this.I=i,this.type="FirstParty",this.user=or.FIRST_PARTY,this.R=new Map}A(){return this.I?this.I():null}get headers(){this.R.set("X-Goog-AuthUser",this.P);const e=this.A();return e&&this.R.set("Authorization",e),this.T&&this.R.set("X-Goog-Iam-Authorization-Token",this.T),this.R}}class uR{constructor(e,t,i){this.P=e,this.T=t,this.I=i}getToken(){return Promise.resolve(new cR(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(or.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class fx{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class dR{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,qr(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Us(this.o===void 0,3512);const i=u=>{u.error!=null&&dt("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${u.error.message}`);const d=u.token!==this.m;return this.m=u.token,dt("FirebaseAppCheckTokenProvider",`Received ${d?"new":"existing"} token.`),d?t(u.token):Promise.resolve()};this.o=u=>{e.enqueueRetryable((()=>i(u)))};const l=u=>{dt("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=u,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((u=>l(u))),setTimeout((()=>{if(!this.appCheck){const u=this.V.getImmediate({optional:!0});u?l(u):dt("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new fx(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(Us(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new fx(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function hR(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let i=0;i<n;i++)t[i]=Math.floor(256*Math.random());return t}class ny{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const l=hR(40);for(let u=0;u<l.length;++u)i.length<20&&l[u]<t&&(i+=e.charAt(l[u]%62))}return i}}function ys(n,e){return n<e?-1:n>e?1:0}function pg(n,e){const t=Math.min(n.length,e.length);for(let i=0;i<t;i++){const l=n.charAt(i),u=e.charAt(i);if(l!==u)return Ip(l)===Ip(u)?ys(l,u):Ip(l)?1:-1}return ys(n.length,e.length)}const mR=55296,fR=57343;function Ip(n){const e=n.charCodeAt(0);return e>=mR&&e<=fR}function Yl(n,e,t){return n.length===e.length&&n.every(((i,l)=>t(i,e[l])))}const px="__name__";class Ia{constructor(e,t,i){t===void 0?t=0:t>e.length&&Lt(637,{offset:t,range:e.length}),i===void 0?i=e.length-t:i>e.length-t&&Lt(1746,{length:i,range:e.length-t}),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return Ia.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Ia?e.forEach((i=>{t.push(i)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const i=Math.min(e.length,t.length);for(let l=0;l<i;l++){const u=Ia.compareSegments(e.get(l),t.get(l));if(u!==0)return u}return ys(e.length,t.length)}static compareSegments(e,t){const i=Ia.isNumericId(e),l=Ia.isNumericId(t);return i&&!l?-1:!i&&l?1:i&&l?Ia.extractNumericId(e).compare(Ia.extractNumericId(t)):pg(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return ro.fromString(e.substring(4,e.length-2))}}class en extends Ia{construct(e,t,i){return new en(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const i of e){if(i.indexOf("//")>=0)throw new tt(Se.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter((l=>l.length>0)))}return new en(t)}static emptyPath(){return new en([])}}const pR=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class er extends Ia{construct(e,t,i){return new er(e,t,i)}static isValidIdentifier(e){return pR.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),er.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===px}static keyField(){return new er([px])}static fromServerFormat(e){const t=[];let i="",l=0;const u=()=>{if(i.length===0)throw new tt(Se.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""};let d=!1;for(;l<e.length;){const p=e[l];if(p==="\\"){if(l+1===e.length)throw new tt(Se.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const g=e[l+1];if(g!=="\\"&&g!=="."&&g!=="`")throw new tt(Se.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=g,l+=2}else p==="`"?(d=!d,l++):p!=="."||d?(i+=p,l++):(u(),l++)}if(u(),d)throw new tt(Se.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new er(t)}static emptyPath(){return new er([])}}class Nt{constructor(e){this.path=e}static fromPath(e){return new Nt(en.fromString(e))}static fromName(e){return new Nt(en.fromString(e).popFirst(5))}static empty(){return new Nt(en.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&en.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return en.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Nt(new en(e.slice()))}}function Yw(n,e,t){if(!t)throw new tt(Se.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function gR(n,e,t,i){if(e===!0&&i===!0)throw new tt(Se.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function gx(n){if(!Nt.isDocumentKey(n))throw new tt(Se.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function yx(n){if(Nt.isDocumentKey(n))throw new tt(Se.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function Qw(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function sm(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(i){return i.constructor?i.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Lt(12329,{type:typeof n})}function vr(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new tt(Se.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=sm(n);throw new tt(Se.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function yR(n,e){if(e<=0)throw new tt(Se.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}function Pn(n,e){const t={typeString:n};return e&&(t.value=e),t}function Pu(n,e){if(!Qw(n))throw new tt(Se.INVALID_ARGUMENT,"JSON must be an object");let t;for(const i in e)if(e[i]){const l=e[i].typeString,u="value"in e[i]?{value:e[i].value}:void 0;if(!(i in n)){t=`JSON missing required field: '${i}'`;break}const d=n[i];if(l&&typeof d!==l){t=`JSON field '${i}' must be a ${l}.`;break}if(u!==void 0&&d!==u.value){t=`Expected '${i}' field to equal '${u.value}'`;break}}if(t)throw new tt(Se.INVALID_ARGUMENT,t);return!0}const bx=-62135596800,vx=1e6;class xt{static now(){return xt.fromMillis(Date.now())}static fromDate(e){return xt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),i=Math.floor((e-1e3*t)*vx);return new xt(t,i)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new tt(Se.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new tt(Se.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<bx)throw new tt(Se.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new tt(Se.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/vx}_compareTo(e){return this.seconds===e.seconds?ys(this.nanoseconds,e.nanoseconds):ys(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:xt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Pu(e,xt._jsonSchema))return new xt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-bx;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}xt._jsonSchemaVersion="firestore/timestamp/1.0",xt._jsonSchema={type:Pn("string",xt._jsonSchemaVersion),seconds:Pn("number"),nanoseconds:Pn("number")};class $t{static fromTimestamp(e){return new $t(e)}static min(){return new $t(new xt(0,0))}static max(){return new $t(new xt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const bu=-1;function bR(n,e){const t=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,l=$t.fromTimestamp(i===1e9?new xt(t+1,0):new xt(t,i));return new oo(l,Nt.empty(),e)}function vR(n){return new oo(n.readTime,n.key,bu)}class oo{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new oo($t.min(),Nt.empty(),bu)}static max(){return new oo($t.max(),Nt.empty(),bu)}}function xR(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=Nt.comparator(n.documentKey,e.documentKey),t!==0?t:ys(n.largestBatchId,e.largestBatchId))}const wR="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class _R{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function ac(n){if(n.code!==Se.FAILED_PRECONDITION||n.message!==wR)throw n;dt("LocalStore","Unexpectedly lost primary lease")}class Pe{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Lt(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new Pe(((i,l)=>{this.nextCallback=u=>{this.wrapSuccess(e,u).next(i,l)},this.catchCallback=u=>{this.wrapFailure(t,u).next(i,l)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof Pe?t:Pe.resolve(t)}catch(t){return Pe.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):Pe.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):Pe.reject(t)}static resolve(e){return new Pe(((t,i)=>{t(e)}))}static reject(e){return new Pe(((t,i)=>{i(e)}))}static waitFor(e){return new Pe(((t,i)=>{let l=0,u=0,d=!1;e.forEach((p=>{++l,p.next((()=>{++u,d&&u===l&&t()}),(g=>i(g)))})),d=!0,u===l&&t()}))}static or(e){let t=Pe.resolve(!1);for(const i of e)t=t.next((l=>l?Pe.resolve(l):i()));return t}static forEach(e,t){const i=[];return e.forEach(((l,u)=>{i.push(t.call(this,l,u))})),this.waitFor(i)}static mapArray(e,t){return new Pe(((i,l)=>{const u=e.length,d=new Array(u);let p=0;for(let g=0;g<u;g++){const y=g;t(e[y]).next((w=>{d[y]=w,++p,p===u&&i(d)}),(w=>l(w)))}}))}static doWhile(e,t){return new Pe(((i,l)=>{const u=()=>{e()===!0?t().next((()=>{u()}),l):i()};u()}))}}function kR(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function ic(n){return n.name==="IndexedDbTransactionError"}class nm{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=i=>this.ae(i),this.ue=i=>t.writeSequenceNumber(i))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}nm.ce=-1;const ry=-1;function rm(n){return n==null}function Lh(n){return n===0&&1/n==-1/0}function jR(n){return typeof n=="number"&&Number.isInteger(n)&&!Lh(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}const Xw="";function TR(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=xx(e)),e=ER(n.get(t),e);return xx(e)}function ER(n,e){let t=e;const i=n.length;for(let l=0;l<i;l++){const u=n.charAt(l);switch(u){case"\0":t+="";break;case Xw:t+="";break;default:t+=u}}return t}function xx(n){return n+Xw+""}function wx(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function go(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function Jw(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}class hn{constructor(e,t){this.comparator=e,this.root=t||Zn.EMPTY}insert(e,t){return new hn(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Zn.BLACK,null,null))}remove(e){return new hn(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Zn.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const i=this.comparator(e,t.key);if(i===0)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){const l=this.comparator(e,i.key);if(l===0)return t+i.left.size;l<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,i)=>(e(t,i),!1)))}toString(){const e=[];return this.inorderTraversal(((t,i)=>(e.push(`${t}:${i}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new sh(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new sh(this.root,e,this.comparator,!1)}getReverseIterator(){return new sh(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new sh(this.root,e,this.comparator,!0)}}class sh{constructor(e,t,i,l){this.isReverse=l,this.nodeStack=[];let u=1;for(;!e.isEmpty();)if(u=t?i(e.key,t):1,t&&l&&(u*=-1),u<0)e=this.isReverse?e.left:e.right;else{if(u===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Zn{constructor(e,t,i,l,u){this.key=e,this.value=t,this.color=i??Zn.RED,this.left=l??Zn.EMPTY,this.right=u??Zn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,l,u){return new Zn(e??this.key,t??this.value,i??this.color,l??this.left,u??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let l=this;const u=i(e,l.key);return l=u<0?l.copy(null,null,null,l.left.insert(e,t,i),null):u===0?l.copy(null,t,null,null,null):l.copy(null,null,null,null,l.right.insert(e,t,i)),l.fixUp()}removeMin(){if(this.left.isEmpty())return Zn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,l=this;if(t(e,l.key)<0)l.left.isEmpty()||l.left.isRed()||l.left.left.isRed()||(l=l.moveRedLeft()),l=l.copy(null,null,null,l.left.remove(e,t),null);else{if(l.left.isRed()&&(l=l.rotateRight()),l.right.isEmpty()||l.right.isRed()||l.right.left.isRed()||(l=l.moveRedRight()),t(e,l.key)===0){if(l.right.isEmpty())return Zn.EMPTY;i=l.right.min(),l=l.copy(i.key,i.value,null,null,l.right.removeMin())}l=l.copy(null,null,null,null,l.right.remove(e,t))}return l.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Zn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Zn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Lt(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Lt(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Lt(27949);return e+(this.isRed()?0:1)}}Zn.EMPTY=null,Zn.RED=!0,Zn.BLACK=!1;Zn.EMPTY=new class{constructor(){this.size=0}get key(){throw Lt(57766)}get value(){throw Lt(16141)}get color(){throw Lt(16727)}get left(){throw Lt(29726)}get right(){throw Lt(36894)}copy(e,t,i,l,u){return this}insert(e,t,i){return new Zn(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Bn{constructor(e){this.comparator=e,this.data=new hn(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,i)=>(e(t),!1)))}forEachInRange(e,t){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const l=i.getNext();if(this.comparator(l.key,e[1])>=0)return;t(l.key)}}forEachWhile(e,t){let i;for(i=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new _x(this.data.getIterator())}getIteratorFrom(e){return new _x(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((i=>{t=t.add(i)})),t}isEqual(e){if(!(e instanceof Bn)||this.size!==e.size)return!1;const t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){const l=t.getNext().key,u=i.getNext().key;if(this.comparator(l,u)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new Bn(this.comparator);return t.data=e,t}}class _x{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class $r{constructor(e){this.fields=e,e.sort(er.comparator)}static empty(){return new $r([])}unionWith(e){let t=new Bn(er.comparator);for(const i of this.fields)t=t.add(i);for(const i of e)t=t.add(i);return new $r(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Yl(this.fields,e.fields,((t,i)=>t.isEqual(i)))}}class Zw extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class tr{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(l){try{return atob(l)}catch(u){throw typeof DOMException<"u"&&u instanceof DOMException?new Zw("Invalid base64 string: "+u):u}})(e);return new tr(t)}static fromUint8Array(e){const t=(function(l){let u="";for(let d=0;d<l.length;++d)u+=String.fromCharCode(l[d]);return u})(e);return new tr(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const i=new Uint8Array(t.length);for(let l=0;l<t.length;l++)i[l]=t.charCodeAt(l);return i})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ys(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}tr.EMPTY_BYTE_STRING=new tr("");const NR=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function lo(n){if(Us(!!n,39018),typeof n=="string"){let e=0;const t=NR.exec(n);if(Us(!!t,46558,{timestamp:n}),t[1]){let l=t[1];l=(l+"000000000").substr(0,9),e=Number(l)}const i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:Nn(n.seconds),nanos:Nn(n.nanos)}}function Nn(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function co(n){return typeof n=="string"?tr.fromBase64String(n):tr.fromUint8Array(n)}const e_="server_timestamp",t_="__type__",s_="__previous_value__",n_="__local_write_time__";function ay(n){return(n?.mapValue?.fields||{})[t_]?.stringValue===e_}function am(n){const e=n.mapValue.fields[s_];return ay(e)?am(e):e}function vu(n){const e=lo(n.mapValue.fields[n_].timestampValue);return new xt(e.seconds,e.nanos)}class SR{constructor(e,t,i,l,u,d,p,g,y,w,j){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=l,this.ssl=u,this.forceLongPolling=d,this.autoDetectLongPolling=p,this.longPollingOptions=g,this.useFetchStreams=y,this.isUsingEmulator=w,this.apiKey=j}}const Oh="(default)";class xu{constructor(e,t){this.projectId=e,this.database=t||Oh}static empty(){return new xu("","")}get isDefaultDatabase(){return this.database===Oh}isEqual(e){return e instanceof xu&&e.projectId===this.projectId&&e.database===this.database}}function CR(n,e){if(!Object.prototype.hasOwnProperty.apply(n.options,["projectId"]))throw new tt(Se.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new xu(n.options.projectId,e)}const r_="__type__",RR="__max__",nh={mapValue:{}},a_="__vector__",Vh="value";function uo(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?ay(n)?4:IR(n)?9007199254740991:AR(n)?10:11:Lt(28295,{value:n})}function Fa(n,e){if(n===e)return!0;const t=uo(n);if(t!==uo(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return vu(n).isEqual(vu(e));case 3:return(function(l,u){if(typeof l.timestampValue=="string"&&typeof u.timestampValue=="string"&&l.timestampValue.length===u.timestampValue.length)return l.timestampValue===u.timestampValue;const d=lo(l.timestampValue),p=lo(u.timestampValue);return d.seconds===p.seconds&&d.nanos===p.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(l,u){return co(l.bytesValue).isEqual(co(u.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(l,u){return Nn(l.geoPointValue.latitude)===Nn(u.geoPointValue.latitude)&&Nn(l.geoPointValue.longitude)===Nn(u.geoPointValue.longitude)})(n,e);case 2:return(function(l,u){if("integerValue"in l&&"integerValue"in u)return Nn(l.integerValue)===Nn(u.integerValue);if("doubleValue"in l&&"doubleValue"in u){const d=Nn(l.doubleValue),p=Nn(u.doubleValue);return d===p?Lh(d)===Lh(p):isNaN(d)&&isNaN(p)}return!1})(n,e);case 9:return Yl(n.arrayValue.values||[],e.arrayValue.values||[],Fa);case 10:case 11:return(function(l,u){const d=l.mapValue.fields||{},p=u.mapValue.fields||{};if(wx(d)!==wx(p))return!1;for(const g in d)if(d.hasOwnProperty(g)&&(p[g]===void 0||!Fa(d[g],p[g])))return!1;return!0})(n,e);default:return Lt(52216,{left:n})}}function wu(n,e){return(n.values||[]).find((t=>Fa(t,e)))!==void 0}function Ql(n,e){if(n===e)return 0;const t=uo(n),i=uo(e);if(t!==i)return ys(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return ys(n.booleanValue,e.booleanValue);case 2:return(function(u,d){const p=Nn(u.integerValue||u.doubleValue),g=Nn(d.integerValue||d.doubleValue);return p<g?-1:p>g?1:p===g?0:isNaN(p)?isNaN(g)?0:-1:1})(n,e);case 3:return kx(n.timestampValue,e.timestampValue);case 4:return kx(vu(n),vu(e));case 5:return pg(n.stringValue,e.stringValue);case 6:return(function(u,d){const p=co(u),g=co(d);return p.compareTo(g)})(n.bytesValue,e.bytesValue);case 7:return(function(u,d){const p=u.split("/"),g=d.split("/");for(let y=0;y<p.length&&y<g.length;y++){const w=ys(p[y],g[y]);if(w!==0)return w}return ys(p.length,g.length)})(n.referenceValue,e.referenceValue);case 8:return(function(u,d){const p=ys(Nn(u.latitude),Nn(d.latitude));return p!==0?p:ys(Nn(u.longitude),Nn(d.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return jx(n.arrayValue,e.arrayValue);case 10:return(function(u,d){const p=u.fields||{},g=d.fields||{},y=p[Vh]?.arrayValue,w=g[Vh]?.arrayValue,j=ys(y?.values?.length||0,w?.values?.length||0);return j!==0?j:jx(y,w)})(n.mapValue,e.mapValue);case 11:return(function(u,d){if(u===nh.mapValue&&d===nh.mapValue)return 0;if(u===nh.mapValue)return 1;if(d===nh.mapValue)return-1;const p=u.fields||{},g=Object.keys(p),y=d.fields||{},w=Object.keys(y);g.sort(),w.sort();for(let j=0;j<g.length&&j<w.length;++j){const T=pg(g[j],w[j]);if(T!==0)return T;const V=Ql(p[g[j]],y[w[j]]);if(V!==0)return V}return ys(g.length,w.length)})(n.mapValue,e.mapValue);default:throw Lt(23264,{he:t})}}function kx(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return ys(n,e);const t=lo(n),i=lo(e),l=ys(t.seconds,i.seconds);return l!==0?l:ys(t.nanos,i.nanos)}function jx(n,e){const t=n.values||[],i=e.values||[];for(let l=0;l<t.length&&l<i.length;++l){const u=Ql(t[l],i[l]);if(u)return u}return ys(t.length,i.length)}function Xl(n){return gg(n)}function gg(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const i=lo(t);return`time(${i.seconds},${i.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return co(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return Nt.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let i="[",l=!0;for(const u of t.values||[])l?l=!1:i+=",",i+=gg(u);return i+"]"})(n.arrayValue):"mapValue"in n?(function(t){const i=Object.keys(t.fields||{}).sort();let l="{",u=!0;for(const d of i)u?u=!1:l+=",",l+=`${d}:${gg(t.fields[d])}`;return l+"}"})(n.mapValue):Lt(61005,{value:n})}function wh(n){switch(uo(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=am(n);return e?16+wh(e):16;case 5:return 2*n.stringValue.length;case 6:return co(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(i){return(i.values||[]).reduce(((l,u)=>l+wh(u)),0)})(n.arrayValue);case 10:case 11:return(function(i){let l=0;return go(i.fields,((u,d)=>{l+=u.length+wh(d)})),l})(n.mapValue);default:throw Lt(13486,{value:n})}}function Tx(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function yg(n){return!!n&&"integerValue"in n}function iy(n){return!!n&&"arrayValue"in n}function Ex(n){return!!n&&"nullValue"in n}function Nx(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function _h(n){return!!n&&"mapValue"in n}function AR(n){return(n?.mapValue?.fields||{})[r_]?.stringValue===a_}function ou(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return go(n.mapValue.fields,((t,i)=>e.mapValue.fields[t]=ou(i))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=ou(n.arrayValue.values[t]);return e}return{...n}}function IR(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===RR}class Ir{constructor(e){this.value=e}static empty(){return new Ir({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!_h(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=ou(t)}setAll(e){let t=er.emptyPath(),i={},l=[];e.forEach(((d,p)=>{if(!t.isImmediateParentOf(p)){const g=this.getFieldsMap(t);this.applyChanges(g,i,l),i={},l=[],t=p.popLast()}d?i[p.lastSegment()]=ou(d):l.push(p.lastSegment())}));const u=this.getFieldsMap(t);this.applyChanges(u,i,l)}delete(e){const t=this.field(e.popLast());_h(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Fa(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let l=t.mapValue.fields[e.get(i)];_h(l)&&l.mapValue.fields||(l={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=l),t=l}return t.mapValue.fields}applyChanges(e,t,i){go(t,((l,u)=>e[l]=u));for(const l of i)delete e[l]}clone(){return new Ir(ou(this.value))}}function i_(n){const e=[];return go(n.fields,((t,i)=>{const l=new er([t]);if(_h(i)){const u=i_(i.mapValue).fields;if(u.length===0)e.push(l);else for(const d of u)e.push(l.child(d))}else e.push(l)})),new $r(e)}class lr{constructor(e,t,i,l,u,d,p){this.key=e,this.documentType=t,this.version=i,this.readTime=l,this.createTime=u,this.data=d,this.documentState=p}static newInvalidDocument(e){return new lr(e,0,$t.min(),$t.min(),$t.min(),Ir.empty(),0)}static newFoundDocument(e,t,i,l){return new lr(e,1,t,$t.min(),i,l,0)}static newNoDocument(e,t){return new lr(e,2,t,$t.min(),$t.min(),Ir.empty(),0)}static newUnknownDocument(e,t){return new lr(e,3,t,$t.min(),$t.min(),Ir.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual($t.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Ir.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Ir.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=$t.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof lr&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new lr(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Bh{constructor(e,t){this.position=e,this.inclusive=t}}function Sx(n,e,t){let i=0;for(let l=0;l<n.position.length;l++){const u=e[l],d=n.position[l];if(u.field.isKeyField()?i=Nt.comparator(Nt.fromName(d.referenceValue),t.key):i=Ql(d,t.data.field(u.field)),u.dir==="desc"&&(i*=-1),i!==0)break}return i}function Cx(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Fa(n.position[t],e.position[t]))return!1;return!0}class _u{constructor(e,t="asc"){this.field=e,this.dir=t}}function MR(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}class o_{}class Dn extends o_{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,i):new PR(e,t,i):t==="array-contains"?new VR(e,i):t==="in"?new BR(e,i):t==="not-in"?new UR(e,i):t==="array-contains-any"?new FR(e,i):new Dn(e,t,i)}static createKeyFieldInFilter(e,t,i){return t==="in"?new LR(e,i):new OR(e,i)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Ql(t,this.value)):t!==null&&uo(this.value)===uo(t)&&this.matchesComparison(Ql(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Lt(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class va extends o_{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new va(e,t)}matches(e){return l_(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function l_(n){return n.op==="and"}function c_(n){return DR(n)&&l_(n)}function DR(n){for(const e of n.filters)if(e instanceof va)return!1;return!0}function bg(n){if(n instanceof Dn)return n.field.canonicalString()+n.op.toString()+Xl(n.value);if(c_(n))return n.filters.map((e=>bg(e))).join(",");{const e=n.filters.map((t=>bg(t))).join(",");return`${n.op}(${e})`}}function u_(n,e){return n instanceof Dn?(function(i,l){return l instanceof Dn&&i.op===l.op&&i.field.isEqual(l.field)&&Fa(i.value,l.value)})(n,e):n instanceof va?(function(i,l){return l instanceof va&&i.op===l.op&&i.filters.length===l.filters.length?i.filters.reduce(((u,d,p)=>u&&u_(d,l.filters[p])),!0):!1})(n,e):void Lt(19439)}function d_(n){return n instanceof Dn?(function(t){return`${t.field.canonicalString()} ${t.op} ${Xl(t.value)}`})(n):n instanceof va?(function(t){return t.op.toString()+" {"+t.getFilters().map(d_).join(" ,")+"}"})(n):"Filter"}class PR extends Dn{constructor(e,t,i){super(e,t,i),this.key=Nt.fromName(i.referenceValue)}matches(e){const t=Nt.comparator(e.key,this.key);return this.matchesComparison(t)}}class LR extends Dn{constructor(e,t){super(e,"in",t),this.keys=h_("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class OR extends Dn{constructor(e,t){super(e,"not-in",t),this.keys=h_("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function h_(n,e){return(e.arrayValue?.values||[]).map((t=>Nt.fromName(t.referenceValue)))}class VR extends Dn{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return iy(t)&&wu(t.arrayValue,this.value)}}class BR extends Dn{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&wu(this.value.arrayValue,t)}}class UR extends Dn{constructor(e,t){super(e,"not-in",t)}matches(e){if(wu(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!wu(this.value.arrayValue,t)}}class FR extends Dn{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!iy(t)||!t.arrayValue.values)&&t.arrayValue.values.some((i=>wu(this.value.arrayValue,i)))}}class zR{constructor(e,t=null,i=[],l=[],u=null,d=null,p=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=l,this.limit=u,this.startAt=d,this.endAt=p,this.Te=null}}function Rx(n,e=null,t=[],i=[],l=null,u=null,d=null){return new zR(n,e,t,i,l,u,d)}function oy(n){const e=Qt(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((i=>bg(i))).join(","),t+="|ob:",t+=e.orderBy.map((i=>(function(u){return u.field.canonicalString()+u.dir})(i))).join(","),rm(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((i=>Xl(i))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((i=>Xl(i))).join(",")),e.Te=t}return e.Te}function ly(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!MR(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!u_(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!Cx(n.startAt,e.startAt)&&Cx(n.endAt,e.endAt)}function vg(n){return Nt.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}class oc{constructor(e,t=null,i=[],l=[],u=null,d="F",p=null,g=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=l,this.limit=u,this.limitType=d,this.startAt=p,this.endAt=g,this.Ie=null,this.Ee=null,this.Re=null,this.startAt,this.endAt}}function qR(n,e,t,i,l,u,d,p){return new oc(n,e,t,i,l,u,d,p)}function im(n){return new oc(n)}function Ax(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function HR(n){return Nt.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function m_(n){return n.collectionGroup!==null}function lu(n){const e=Qt(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const u of e.explicitOrderBy)e.Ie.push(u),t.add(u.field.canonicalString());const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(d){let p=new Bn(er.comparator);return d.filters.forEach((g=>{g.getFlattenedFilters().forEach((y=>{y.isInequality()&&(p=p.add(y.field))}))})),p})(e).forEach((u=>{t.has(u.canonicalString())||u.isKeyField()||e.Ie.push(new _u(u,i))})),t.has(er.keyField().canonicalString())||e.Ie.push(new _u(er.keyField(),i))}return e.Ie}function Va(n){const e=Qt(n);return e.Ee||(e.Ee=$R(e,lu(n))),e.Ee}function $R(n,e){if(n.limitType==="F")return Rx(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((l=>{const u=l.dir==="desc"?"asc":"desc";return new _u(l.field,u)}));const t=n.endAt?new Bh(n.endAt.position,n.endAt.inclusive):null,i=n.startAt?new Bh(n.startAt.position,n.startAt.inclusive):null;return Rx(n.path,n.collectionGroup,e,n.filters,n.limit,t,i)}}function xg(n,e){const t=n.filters.concat([e]);return new oc(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function WR(n,e){const t=n.explicitOrderBy.concat([e]);return new oc(n.path,n.collectionGroup,t,n.filters.slice(),n.limit,n.limitType,n.startAt,n.endAt)}function Uh(n,e,t){return new oc(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function om(n,e){return ly(Va(n),Va(e))&&n.limitType===e.limitType}function f_(n){return`${oy(Va(n))}|lt:${n.limitType}`}function Bl(n){return`Query(target=${(function(t){let i=t.path.canonicalString();return t.collectionGroup!==null&&(i+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(i+=`, filters: [${t.filters.map((l=>d_(l))).join(", ")}]`),rm(t.limit)||(i+=", limit: "+t.limit),t.orderBy.length>0&&(i+=`, orderBy: [${t.orderBy.map((l=>(function(d){return`${d.field.canonicalString()} (${d.dir})`})(l))).join(", ")}]`),t.startAt&&(i+=", startAt: ",i+=t.startAt.inclusive?"b:":"a:",i+=t.startAt.position.map((l=>Xl(l))).join(",")),t.endAt&&(i+=", endAt: ",i+=t.endAt.inclusive?"a:":"b:",i+=t.endAt.position.map((l=>Xl(l))).join(",")),`Target(${i})`})(Va(n))}; limitType=${n.limitType})`}function lm(n,e){return e.isFoundDocument()&&(function(i,l){const u=l.key.path;return i.collectionGroup!==null?l.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(u):Nt.isDocumentKey(i.path)?i.path.isEqual(u):i.path.isImmediateParentOf(u)})(n,e)&&(function(i,l){for(const u of lu(i))if(!u.field.isKeyField()&&l.data.field(u.field)===null)return!1;return!0})(n,e)&&(function(i,l){for(const u of i.filters)if(!u.matches(l))return!1;return!0})(n,e)&&(function(i,l){return!(i.startAt&&!(function(d,p,g){const y=Sx(d,p,g);return d.inclusive?y<=0:y<0})(i.startAt,lu(i),l)||i.endAt&&!(function(d,p,g){const y=Sx(d,p,g);return d.inclusive?y>=0:y>0})(i.endAt,lu(i),l))})(n,e)}function GR(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function p_(n){return(e,t)=>{let i=!1;for(const l of lu(n)){const u=KR(l,e,t);if(u!==0)return u;i=i||l.field.isKeyField()}return 0}}function KR(n,e,t){const i=n.field.isKeyField()?Nt.comparator(e.key,t.key):(function(u,d,p){const g=d.data.field(u),y=p.data.field(u);return g!==null&&y!==null?Ql(g,y):Lt(42886)})(n.field,e,t);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return Lt(19790,{direction:n.dir})}}class Zo{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i!==void 0){for(const[l,u]of i)if(this.equalsFn(l,e))return u}}has(e){return this.get(e)!==void 0}set(e,t){const i=this.mapKeyFn(e),l=this.inner[i];if(l===void 0)return this.inner[i]=[[e,t]],void this.innerSize++;for(let u=0;u<l.length;u++)if(this.equalsFn(l[u][0],e))return void(l[u]=[e,t]);l.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i===void 0)return!1;for(let l=0;l<i.length;l++)if(this.equalsFn(i[l][0],e))return i.length===1?delete this.inner[t]:i.splice(l,1),this.innerSize--,!0;return!1}forEach(e){go(this.inner,((t,i)=>{for(const[l,u]of i)e(l,u)}))}isEmpty(){return Jw(this.inner)}size(){return this.innerSize}}const YR=new hn(Nt.comparator);function yi(){return YR}const g_=new hn(Nt.comparator);function su(...n){let e=g_;for(const t of n)e=e.insert(t.key,t);return e}function y_(n){let e=g_;return n.forEach(((t,i)=>e=e.insert(t,i.overlayedDocument))),e}function Vo(){return cu()}function b_(){return cu()}function cu(){return new Zo((n=>n.toString()),((n,e)=>n.isEqual(e)))}const QR=new hn(Nt.comparator),XR=new Bn(Nt.comparator);function bs(...n){let e=XR;for(const t of n)e=e.add(t);return e}const JR=new Bn(ys);function ZR(){return JR}function cy(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Lh(e)?"-0":e}}function v_(n){return{integerValue:""+n}}function x_(n,e){return jR(e)?v_(e):cy(n,e)}class cm{constructor(){this._=void 0}}function eA(n,e,t){return n instanceof ku?(function(l,u){const d={fields:{[t_]:{stringValue:e_},[n_]:{timestampValue:{seconds:l.seconds,nanos:l.nanoseconds}}}};return u&&ay(u)&&(u=am(u)),u&&(d.fields[s_]=u),{mapValue:d}})(t,e):n instanceof ju?__(n,e):n instanceof Tu?k_(n,e):(function(l,u){const d=w_(l,u),p=Ix(d)+Ix(l.Ae);return yg(d)&&yg(l.Ae)?v_(p):cy(l.serializer,p)})(n,e)}function tA(n,e,t){return n instanceof ju?__(n,e):n instanceof Tu?k_(n,e):t}function w_(n,e){return n instanceof Eu?(function(i){return yg(i)||(function(u){return!!u&&"doubleValue"in u})(i)})(e)?e:{integerValue:0}:null}class ku extends cm{}class ju extends cm{constructor(e){super(),this.elements=e}}function __(n,e){const t=j_(e);for(const i of n.elements)t.some((l=>Fa(l,i)))||t.push(i);return{arrayValue:{values:t}}}class Tu extends cm{constructor(e){super(),this.elements=e}}function k_(n,e){let t=j_(e);for(const i of n.elements)t=t.filter((l=>!Fa(l,i)));return{arrayValue:{values:t}}}class Eu extends cm{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function Ix(n){return Nn(n.integerValue||n.doubleValue)}function j_(n){return iy(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class T_{constructor(e,t){this.field=e,this.transform=t}}function sA(n,e){return n.field.isEqual(e.field)&&(function(i,l){return i instanceof ju&&l instanceof ju||i instanceof Tu&&l instanceof Tu?Yl(i.elements,l.elements,Fa):i instanceof Eu&&l instanceof Eu?Fa(i.Ae,l.Ae):i instanceof ku&&l instanceof ku})(n.transform,e.transform)}class nA{constructor(e,t){this.version=e,this.transformResults=t}}class xr{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new xr}static exists(e){return new xr(void 0,e)}static updateTime(e){return new xr(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function kh(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class um{}function E_(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new dm(n.key,xr.none()):new Lu(n.key,n.data,xr.none());{const t=n.data,i=Ir.empty();let l=new Bn(er.comparator);for(let u of e.fields)if(!l.has(u)){let d=t.field(u);d===null&&u.length>1&&(u=u.popLast(),d=t.field(u)),d===null?i.delete(u):i.set(u,d),l=l.add(u)}return new yo(n.key,i,new $r(l.toArray()),xr.none())}}function rA(n,e,t){n instanceof Lu?(function(l,u,d){const p=l.value.clone(),g=Dx(l.fieldTransforms,u,d.transformResults);p.setAll(g),u.convertToFoundDocument(d.version,p).setHasCommittedMutations()})(n,e,t):n instanceof yo?(function(l,u,d){if(!kh(l.precondition,u))return void u.convertToUnknownDocument(d.version);const p=Dx(l.fieldTransforms,u,d.transformResults),g=u.data;g.setAll(N_(l)),g.setAll(p),u.convertToFoundDocument(d.version,g).setHasCommittedMutations()})(n,e,t):(function(l,u,d){u.convertToNoDocument(d.version).setHasCommittedMutations()})(0,e,t)}function uu(n,e,t,i){return n instanceof Lu?(function(u,d,p,g){if(!kh(u.precondition,d))return p;const y=u.value.clone(),w=Px(u.fieldTransforms,g,d);return y.setAll(w),d.convertToFoundDocument(d.version,y).setHasLocalMutations(),null})(n,e,t,i):n instanceof yo?(function(u,d,p,g){if(!kh(u.precondition,d))return p;const y=Px(u.fieldTransforms,g,d),w=d.data;return w.setAll(N_(u)),w.setAll(y),d.convertToFoundDocument(d.version,w).setHasLocalMutations(),p===null?null:p.unionWith(u.fieldMask.fields).unionWith(u.fieldTransforms.map((j=>j.field)))})(n,e,t,i):(function(u,d,p){return kh(u.precondition,d)?(d.convertToNoDocument(d.version).setHasLocalMutations(),null):p})(n,e,t)}function aA(n,e){let t=null;for(const i of n.fieldTransforms){const l=e.data.field(i.field),u=w_(i.transform,l||null);u!=null&&(t===null&&(t=Ir.empty()),t.set(i.field,u))}return t||null}function Mx(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(i,l){return i===void 0&&l===void 0||!(!i||!l)&&Yl(i,l,((u,d)=>sA(u,d)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class Lu extends um{constructor(e,t,i,l=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=l,this.type=0}getFieldMask(){return null}}class yo extends um{constructor(e,t,i,l,u=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=l,this.fieldTransforms=u,this.type=1}getFieldMask(){return this.fieldMask}}function N_(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const i=n.data.field(t);e.set(t,i)}})),e}function Dx(n,e,t){const i=new Map;Us(n.length===t.length,32656,{Ve:t.length,de:n.length});for(let l=0;l<t.length;l++){const u=n[l],d=u.transform,p=e.data.field(u.field);i.set(u.field,tA(d,p,t[l]))}return i}function Px(n,e,t){const i=new Map;for(const l of n){const u=l.transform,d=t.data.field(l.field);i.set(l.field,eA(u,d,e))}return i}class dm extends um{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class iA extends um{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class oA{constructor(e,t,i,l){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=l}applyToRemoteDocument(e,t){const i=t.mutationResults;for(let l=0;l<this.mutations.length;l++){const u=this.mutations[l];u.key.isEqual(e.key)&&rA(u,e,i[l])}}applyToLocalView(e,t){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(t=uu(i,e,t,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(t=uu(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const i=b_();return this.mutations.forEach((l=>{const u=e.get(l.key),d=u.overlayedDocument;let p=this.applyToLocalView(d,u.mutatedFields);p=t.has(l.key)?null:p;const g=E_(d,p);g!==null&&i.set(l.key,g),d.isValidDocument()||d.convertToNoDocument($t.min())})),i}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),bs())}isEqual(e){return this.batchId===e.batchId&&Yl(this.mutations,e.mutations,((t,i)=>Mx(t,i)))&&Yl(this.baseMutations,e.baseMutations,((t,i)=>Mx(t,i)))}}class uy{constructor(e,t,i,l){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=l}static from(e,t,i){Us(e.mutations.length===i.length,58842,{me:e.mutations.length,fe:i.length});let l=(function(){return QR})();const u=e.mutations;for(let d=0;d<u.length;d++)l=l.insert(u[d].key,i[d].version);return new uy(e,t,i,l)}}class lA{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class cA{constructor(e,t){this.count=e,this.unchangedNames=t}}var Mn,Ts;function uA(n){switch(n){case Se.OK:return Lt(64938);case Se.CANCELLED:case Se.UNKNOWN:case Se.DEADLINE_EXCEEDED:case Se.RESOURCE_EXHAUSTED:case Se.INTERNAL:case Se.UNAVAILABLE:case Se.UNAUTHENTICATED:return!1;case Se.INVALID_ARGUMENT:case Se.NOT_FOUND:case Se.ALREADY_EXISTS:case Se.PERMISSION_DENIED:case Se.FAILED_PRECONDITION:case Se.ABORTED:case Se.OUT_OF_RANGE:case Se.UNIMPLEMENTED:case Se.DATA_LOSS:return!0;default:return Lt(15467,{code:n})}}function S_(n){if(n===void 0)return gi("GRPC error has no .code"),Se.UNKNOWN;switch(n){case Mn.OK:return Se.OK;case Mn.CANCELLED:return Se.CANCELLED;case Mn.UNKNOWN:return Se.UNKNOWN;case Mn.DEADLINE_EXCEEDED:return Se.DEADLINE_EXCEEDED;case Mn.RESOURCE_EXHAUSTED:return Se.RESOURCE_EXHAUSTED;case Mn.INTERNAL:return Se.INTERNAL;case Mn.UNAVAILABLE:return Se.UNAVAILABLE;case Mn.UNAUTHENTICATED:return Se.UNAUTHENTICATED;case Mn.INVALID_ARGUMENT:return Se.INVALID_ARGUMENT;case Mn.NOT_FOUND:return Se.NOT_FOUND;case Mn.ALREADY_EXISTS:return Se.ALREADY_EXISTS;case Mn.PERMISSION_DENIED:return Se.PERMISSION_DENIED;case Mn.FAILED_PRECONDITION:return Se.FAILED_PRECONDITION;case Mn.ABORTED:return Se.ABORTED;case Mn.OUT_OF_RANGE:return Se.OUT_OF_RANGE;case Mn.UNIMPLEMENTED:return Se.UNIMPLEMENTED;case Mn.DATA_LOSS:return Se.DATA_LOSS;default:return Lt(39323,{code:n})}}(Ts=Mn||(Mn={}))[Ts.OK=0]="OK",Ts[Ts.CANCELLED=1]="CANCELLED",Ts[Ts.UNKNOWN=2]="UNKNOWN",Ts[Ts.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ts[Ts.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ts[Ts.NOT_FOUND=5]="NOT_FOUND",Ts[Ts.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ts[Ts.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ts[Ts.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ts[Ts.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ts[Ts.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ts[Ts.ABORTED=10]="ABORTED",Ts[Ts.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ts[Ts.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ts[Ts.INTERNAL=13]="INTERNAL",Ts[Ts.UNAVAILABLE=14]="UNAVAILABLE",Ts[Ts.DATA_LOSS=15]="DATA_LOSS";function dA(){return new TextEncoder}const hA=new ro([4294967295,4294967295],0);function Lx(n){const e=dA().encode(n),t=new Fw;return t.update(e),new Uint8Array(t.digest())}function Ox(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),i=e.getUint32(4,!0),l=e.getUint32(8,!0),u=e.getUint32(12,!0);return[new ro([t,i],0),new ro([l,u],0)]}class dy{constructor(e,t,i){if(this.bitmap=e,this.padding=t,this.hashCount=i,t<0||t>=8)throw new nu(`Invalid padding: ${t}`);if(i<0)throw new nu(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new nu(`Invalid hash count: ${i}`);if(e.length===0&&t!==0)throw new nu(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=ro.fromNumber(this.ge)}ye(e,t,i){let l=e.add(t.multiply(ro.fromNumber(i)));return l.compare(hA)===1&&(l=new ro([l.getBits(0),l.getBits(1)],0)),l.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=Lx(e),[i,l]=Ox(t);for(let u=0;u<this.hashCount;u++){const d=this.ye(i,l,u);if(!this.we(d))return!1}return!0}static create(e,t,i){const l=e%8==0?0:8-e%8,u=new Uint8Array(Math.ceil(e/8)),d=new dy(u,l,t);return i.forEach((p=>d.insert(p))),d}insert(e){if(this.ge===0)return;const t=Lx(e),[i,l]=Ox(t);for(let u=0;u<this.hashCount;u++){const d=this.ye(i,l,u);this.be(d)}}be(e){const t=Math.floor(e/8),i=e%8;this.bitmap[t]|=1<<i}}class nu extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class hm{constructor(e,t,i,l,u){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=i,this.documentUpdates=l,this.resolvedLimboDocuments=u}static createSynthesizedRemoteEventForCurrentChange(e,t,i){const l=new Map;return l.set(e,Ou.createSynthesizedTargetChangeForCurrentChange(e,t,i)),new hm($t.min(),l,new hn(ys),yi(),bs())}}class Ou{constructor(e,t,i,l,u){this.resumeToken=e,this.current=t,this.addedDocuments=i,this.modifiedDocuments=l,this.removedDocuments=u}static createSynthesizedTargetChangeForCurrentChange(e,t,i){return new Ou(i,t,bs(),bs(),bs())}}class jh{constructor(e,t,i,l){this.Se=e,this.removedTargetIds=t,this.key=i,this.De=l}}class C_{constructor(e,t){this.targetId=e,this.Ce=t}}class R_{constructor(e,t,i=tr.EMPTY_BYTE_STRING,l=null){this.state=e,this.targetIds=t,this.resumeToken=i,this.cause=l}}class Vx{constructor(){this.ve=0,this.Fe=Bx(),this.Me=tr.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=bs(),t=bs(),i=bs();return this.Fe.forEach(((l,u)=>{switch(u){case 0:e=e.add(l);break;case 2:t=t.add(l);break;case 1:i=i.add(l);break;default:Lt(38017,{changeType:u})}})),new Ou(this.Me,this.xe,e,t,i)}Ke(){this.Oe=!1,this.Fe=Bx()}qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}Ue(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}$e(){this.ve+=1}We(){this.ve-=1,Us(this.ve>=0,3241,{ve:this.ve})}Qe(){this.Oe=!0,this.xe=!0}}class mA{constructor(e){this.Ge=e,this.ze=new Map,this.je=yi(),this.He=rh(),this.Je=rh(),this.Ze=new hn(ys)}Xe(e){for(const t of e.Se)e.De&&e.De.isFoundDocument()?this.Ye(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const i=this.nt(t);switch(e.state){case 0:this.rt(t)&&i.Le(e.resumeToken);break;case 1:i.We(),i.Ne||i.Ke(),i.Le(e.resumeToken);break;case 2:i.We(),i.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(i.Qe(),i.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),i.Le(e.resumeToken));break;default:Lt(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((i,l)=>{this.rt(l)&&t(l)}))}st(e){const t=e.targetId,i=e.Ce.count,l=this.ot(t);if(l){const u=l.target;if(vg(u))if(i===0){const d=new Nt(u.path);this.et(t,d,lr.newNoDocument(d,$t.min()))}else Us(i===1,20013,{expectedCount:i});else{const d=this._t(t);if(d!==i){const p=this.ut(e),g=p?this.ct(p,e,d):1;if(g!==0){this.it(t);const y=g===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(t,y)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:i="",padding:l=0},hashCount:u=0}=t;let d,p;try{d=co(i).toUint8Array()}catch(g){if(g instanceof Zw)return Kl("Decoding the base64 bloom filter in existence filter failed ("+g.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw g}try{p=new dy(d,l,u)}catch(g){return Kl(g instanceof nu?"BloomFilter error: ":"Applying bloom filter failed: ",g),null}return p.ge===0?null:p}ct(e,t,i){return t.Ce.count===i-this.Pt(e,t.targetId)?0:2}Pt(e,t){const i=this.Ge.getRemoteKeysForTarget(t);let l=0;return i.forEach((u=>{const d=this.Ge.ht(),p=`projects/${d.projectId}/databases/${d.database}/documents/${u.path.canonicalString()}`;e.mightContain(p)||(this.et(t,u,null),l++)})),l}Tt(e){const t=new Map;this.ze.forEach(((u,d)=>{const p=this.ot(d);if(p){if(u.current&&vg(p.target)){const g=new Nt(p.target.path);this.It(g).has(d)||this.Et(d,g)||this.et(d,g,lr.newNoDocument(g,e))}u.Be&&(t.set(d,u.ke()),u.Ke())}}));let i=bs();this.Je.forEach(((u,d)=>{let p=!0;d.forEachWhile((g=>{const y=this.ot(g);return!y||y.purpose==="TargetPurposeLimboResolution"||(p=!1,!1)})),p&&(i=i.add(u))})),this.je.forEach(((u,d)=>d.setReadTime(e)));const l=new hm(e,t,this.Ze,this.je,i);return this.je=yi(),this.He=rh(),this.Je=rh(),this.Ze=new hn(ys),l}Ye(e,t){if(!this.rt(e))return;const i=this.Et(e,t.key)?2:0;this.nt(e).qe(t.key,i),this.je=this.je.insert(t.key,t),this.He=this.He.insert(t.key,this.It(t.key).add(e)),this.Je=this.Je.insert(t.key,this.Rt(t.key).add(e))}et(e,t,i){if(!this.rt(e))return;const l=this.nt(e);this.Et(e,t)?l.qe(t,1):l.Ue(t),this.Je=this.Je.insert(t,this.Rt(t).delete(e)),this.Je=this.Je.insert(t,this.Rt(t).add(e)),i&&(this.je=this.je.insert(t,i))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.nt(e).$e()}nt(e){let t=this.ze.get(e);return t||(t=new Vx,this.ze.set(e,t)),t}Rt(e){let t=this.Je.get(e);return t||(t=new Bn(ys),this.Je=this.Je.insert(e,t)),t}It(e){let t=this.He.get(e);return t||(t=new Bn(ys),this.He=this.He.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||dt("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new Vx),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function rh(){return new hn(Nt.comparator)}function Bx(){return new hn(Nt.comparator)}const fA={asc:"ASCENDING",desc:"DESCENDING"},pA={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},gA={and:"AND",or:"OR"};class yA{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function wg(n,e){return n.useProto3Json||rm(e)?e:{value:e}}function Fh(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function A_(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function bA(n,e){return Fh(n,e.toTimestamp())}function Ba(n){return Us(!!n,49232),$t.fromTimestamp((function(t){const i=lo(t);return new xt(i.seconds,i.nanos)})(n))}function hy(n,e){return _g(n,e).canonicalString()}function _g(n,e){const t=(function(l){return new en(["projects",l.projectId,"databases",l.database])})(n).child("documents");return e===void 0?t:t.child(e)}function I_(n){const e=en.fromString(n);return Us(O_(e),10190,{key:e.toString()}),e}function kg(n,e){return hy(n.databaseId,e.path)}function Mp(n,e){const t=I_(e);if(t.get(1)!==n.databaseId.projectId)throw new tt(Se.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new tt(Se.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new Nt(D_(t))}function M_(n,e){return hy(n.databaseId,e)}function vA(n){const e=I_(n);return e.length===4?en.emptyPath():D_(e)}function jg(n){return new en(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function D_(n){return Us(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function Ux(n,e,t){return{name:kg(n,e),fields:t.value.mapValue.fields}}function xA(n,e){let t;if("targetChange"in e){e.targetChange;const i=(function(y){return y==="NO_CHANGE"?0:y==="ADD"?1:y==="REMOVE"?2:y==="CURRENT"?3:y==="RESET"?4:Lt(39313,{state:y})})(e.targetChange.targetChangeType||"NO_CHANGE"),l=e.targetChange.targetIds||[],u=(function(y,w){return y.useProto3Json?(Us(w===void 0||typeof w=="string",58123),tr.fromBase64String(w||"")):(Us(w===void 0||w instanceof Buffer||w instanceof Uint8Array,16193),tr.fromUint8Array(w||new Uint8Array))})(n,e.targetChange.resumeToken),d=e.targetChange.cause,p=d&&(function(y){const w=y.code===void 0?Se.UNKNOWN:S_(y.code);return new tt(w,y.message||"")})(d);t=new R_(i,l,u,p||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const l=Mp(n,i.document.name),u=Ba(i.document.updateTime),d=i.document.createTime?Ba(i.document.createTime):$t.min(),p=new Ir({mapValue:{fields:i.document.fields}}),g=lr.newFoundDocument(l,u,d,p),y=i.targetIds||[],w=i.removedTargetIds||[];t=new jh(y,w,g.key,g)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const l=Mp(n,i.document),u=i.readTime?Ba(i.readTime):$t.min(),d=lr.newNoDocument(l,u),p=i.removedTargetIds||[];t=new jh([],p,d.key,d)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const l=Mp(n,i.document),u=i.removedTargetIds||[];t=new jh([],u,l,null)}else{if(!("filter"in e))return Lt(11601,{Vt:e});{e.filter;const i=e.filter;i.targetId;const{count:l=0,unchangedNames:u}=i,d=new cA(l,u),p=i.targetId;t=new C_(p,d)}}return t}function wA(n,e){let t;if(e instanceof Lu)t={update:Ux(n,e.key,e.value)};else if(e instanceof dm)t={delete:kg(n,e.key)};else if(e instanceof yo)t={update:Ux(n,e.key,e.data),updateMask:RA(e.fieldMask)};else{if(!(e instanceof iA))return Lt(16599,{dt:e.type});t={verify:kg(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((i=>(function(u,d){const p=d.transform;if(p instanceof ku)return{fieldPath:d.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(p instanceof ju)return{fieldPath:d.field.canonicalString(),appendMissingElements:{values:p.elements}};if(p instanceof Tu)return{fieldPath:d.field.canonicalString(),removeAllFromArray:{values:p.elements}};if(p instanceof Eu)return{fieldPath:d.field.canonicalString(),increment:p.Ae};throw Lt(20930,{transform:d.transform})})(0,i)))),e.precondition.isNone||(t.currentDocument=(function(l,u){return u.updateTime!==void 0?{updateTime:bA(l,u.updateTime)}:u.exists!==void 0?{exists:u.exists}:Lt(27497)})(n,e.precondition)),t}function _A(n,e){return n&&n.length>0?(Us(e!==void 0,14353),n.map((t=>(function(l,u){let d=l.updateTime?Ba(l.updateTime):Ba(u);return d.isEqual($t.min())&&(d=Ba(u)),new nA(d,l.transformResults||[])})(t,e)))):[]}function kA(n,e){return{documents:[M_(n,e.path)]}}function jA(n,e){const t={structuredQuery:{}},i=e.path;let l;e.collectionGroup!==null?(l=i,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(l=i.popLast(),t.structuredQuery.from=[{collectionId:i.lastSegment()}]),t.parent=M_(n,l);const u=(function(y){if(y.length!==0)return L_(va.create(y,"and"))})(e.filters);u&&(t.structuredQuery.where=u);const d=(function(y){if(y.length!==0)return y.map((w=>(function(T){return{field:Ul(T.field),direction:NA(T.dir)}})(w)))})(e.orderBy);d&&(t.structuredQuery.orderBy=d);const p=wg(n,e.limit);return p!==null&&(t.structuredQuery.limit=p),e.startAt&&(t.structuredQuery.startAt=(function(y){return{before:y.inclusive,values:y.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(y){return{before:!y.inclusive,values:y.position}})(e.endAt)),{ft:t,parent:l}}function TA(n){let e=vA(n.parent);const t=n.structuredQuery,i=t.from?t.from.length:0;let l=null;if(i>0){Us(i===1,65062);const w=t.from[0];w.allDescendants?l=w.collectionId:e=e.child(w.collectionId)}let u=[];t.where&&(u=(function(j){const T=P_(j);return T instanceof va&&c_(T)?T.getFilters():[T]})(t.where));let d=[];t.orderBy&&(d=(function(j){return j.map((T=>(function(W){return new _u(Fl(W.field),(function(U){switch(U){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(W.direction))})(T)))})(t.orderBy));let p=null;t.limit&&(p=(function(j){let T;return T=typeof j=="object"?j.value:j,rm(T)?null:T})(t.limit));let g=null;t.startAt&&(g=(function(j){const T=!!j.before,V=j.values||[];return new Bh(V,T)})(t.startAt));let y=null;return t.endAt&&(y=(function(j){const T=!j.before,V=j.values||[];return new Bh(V,T)})(t.endAt)),qR(e,l,d,u,p,"F",g,y)}function EA(n,e){const t=(function(l){switch(l){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Lt(28987,{purpose:l})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function P_(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const i=Fl(t.unaryFilter.field);return Dn.create(i,"==",{doubleValue:NaN});case"IS_NULL":const l=Fl(t.unaryFilter.field);return Dn.create(l,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const u=Fl(t.unaryFilter.field);return Dn.create(u,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const d=Fl(t.unaryFilter.field);return Dn.create(d,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Lt(61313);default:return Lt(60726)}})(n):n.fieldFilter!==void 0?(function(t){return Dn.create(Fl(t.fieldFilter.field),(function(l){switch(l){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Lt(58110);default:return Lt(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return va.create(t.compositeFilter.filters.map((i=>P_(i))),(function(l){switch(l){case"AND":return"and";case"OR":return"or";default:return Lt(1026)}})(t.compositeFilter.op))})(n):Lt(30097,{filter:n})}function NA(n){return fA[n]}function SA(n){return pA[n]}function CA(n){return gA[n]}function Ul(n){return{fieldPath:n.canonicalString()}}function Fl(n){return er.fromServerFormat(n.fieldPath)}function L_(n){return n instanceof Dn?(function(t){if(t.op==="=="){if(Nx(t.value))return{unaryFilter:{field:Ul(t.field),op:"IS_NAN"}};if(Ex(t.value))return{unaryFilter:{field:Ul(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(Nx(t.value))return{unaryFilter:{field:Ul(t.field),op:"IS_NOT_NAN"}};if(Ex(t.value))return{unaryFilter:{field:Ul(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ul(t.field),op:SA(t.op),value:t.value}}})(n):n instanceof va?(function(t){const i=t.getFilters().map((l=>L_(l)));return i.length===1?i[0]:{compositeFilter:{op:CA(t.op),filters:i}}})(n):Lt(54877,{filter:n})}function RA(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function O_(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}function V_(n){return!!n&&typeof n._toProto=="function"&&n._protoValueType==="ProtoValue"}class Zi{constructor(e,t,i,l,u=$t.min(),d=$t.min(),p=tr.EMPTY_BYTE_STRING,g=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=l,this.snapshotVersion=u,this.lastLimboFreeSnapshotVersion=d,this.resumeToken=p,this.expectedCount=g}withSequenceNumber(e){return new Zi(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Zi(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Zi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Zi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class AA{constructor(e){this.yt=e}}function IA(n){const e=TA({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Uh(e,e.limit,"L"):e}class MA{constructor(){this.Sn=new DA}addToCollectionParentIndex(e,t){return this.Sn.add(t),Pe.resolve()}getCollectionParents(e,t){return Pe.resolve(this.Sn.getEntries(t))}addFieldIndex(e,t){return Pe.resolve()}deleteFieldIndex(e,t){return Pe.resolve()}deleteAllFieldIndexes(e){return Pe.resolve()}createTargetIndexes(e,t){return Pe.resolve()}getDocumentsMatchingTarget(e,t){return Pe.resolve(null)}getIndexType(e,t){return Pe.resolve(0)}getFieldIndexes(e,t){return Pe.resolve([])}getNextCollectionGroupToUpdate(e){return Pe.resolve(null)}getMinOffset(e,t){return Pe.resolve(oo.min())}getMinOffsetFromCollectionGroup(e,t){return Pe.resolve(oo.min())}updateCollectionGroup(e,t,i){return Pe.resolve()}updateIndexEntries(e,t){return Pe.resolve()}}class DA{constructor(){this.index={}}add(e){const t=e.lastSegment(),i=e.popLast(),l=this.index[t]||new Bn(en.comparator),u=!l.has(i);return this.index[t]=l.add(i),u}has(e){const t=e.lastSegment(),i=e.popLast(),l=this.index[t];return l&&l.has(i)}getEntries(e){return(this.index[e]||new Bn(en.comparator)).toArray()}}const Fx={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},B_=41943040;class Ar{static withCacheSize(e){return new Ar(e,Ar.DEFAULT_COLLECTION_PERCENTILE,Ar.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}}Ar.DEFAULT_COLLECTION_PERCENTILE=10,Ar.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Ar.DEFAULT=new Ar(B_,Ar.DEFAULT_COLLECTION_PERCENTILE,Ar.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Ar.DISABLED=new Ar(-1,0,0);class Jl{constructor(e){this.sr=e}next(){return this.sr+=2,this.sr}static _r(){return new Jl(0)}static ar(){return new Jl(-1)}}const zx="LruGarbageCollector",PA=1048576;function qx([n,e],[t,i]){const l=ys(n,t);return l===0?ys(e,i):l}class LA{constructor(e){this.Pr=e,this.buffer=new Bn(qx),this.Tr=0}Ir(){return++this.Tr}Er(e){const t=[e,this.Ir()];if(this.buffer.size<this.Pr)this.buffer=this.buffer.add(t);else{const i=this.buffer.last();qx(t,i)<0&&(this.buffer=this.buffer.delete(i).add(t))}}get maxValue(){return this.buffer.last()[0]}}class OA{constructor(e,t,i){this.garbageCollector=e,this.asyncQueue=t,this.localStore=i,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Ar(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Ar(e){dt(zx,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){ic(t)?dt(zx,"Ignoring IndexedDB error during garbage collection: ",t):await ac(t)}await this.Ar(3e5)}))}}class VA{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.dr(e).next((i=>Math.floor(t/100*i)))}nthSequenceNumber(e,t){if(t===0)return Pe.resolve(nm.ce);const i=new LA(t);return this.Vr.forEachTarget(e,(l=>i.Er(l.sequenceNumber))).next((()=>this.Vr.mr(e,(l=>i.Er(l))))).next((()=>i.maxValue))}removeTargets(e,t,i){return this.Vr.removeTargets(e,t,i)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(dt("LruGarbageCollector","Garbage collection skipped; disabled"),Pe.resolve(Fx)):this.getCacheSize(e).next((i=>i<this.params.cacheSizeCollectionThreshold?(dt("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Fx):this.gr(e,t)))}getCacheSize(e){return this.Vr.getCacheSize(e)}gr(e,t){let i,l,u,d,p,g,y;const w=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((j=>(j>this.params.maximumSequenceNumbersToCollect?(dt("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${j}`),l=this.params.maximumSequenceNumbersToCollect):l=j,d=Date.now(),this.nthSequenceNumber(e,l)))).next((j=>(i=j,p=Date.now(),this.removeTargets(e,i,t)))).next((j=>(u=j,g=Date.now(),this.removeOrphanedDocuments(e,i)))).next((j=>(y=Date.now(),Vl()<=gs.DEBUG&&dt("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${d-w}ms
	Determined least recently used ${l} in `+(p-d)+`ms
	Removed ${u} targets in `+(g-p)+`ms
	Removed ${j} documents in `+(y-g)+`ms
Total Duration: ${y-w}ms`),Pe.resolve({didRun:!0,sequenceNumbersCollected:l,targetsRemoved:u,documentsRemoved:j}))))}}function BA(n,e){return new VA(n,e)}class UA{constructor(){this.changes=new Zo((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,lr.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const i=this.changes.get(t);return i!==void 0?Pe.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class FA{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class zA{constructor(e,t,i,l){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=l}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next((l=>(i=l,this.remoteDocumentCache.getEntry(e,t)))).next((l=>(i!==null&&uu(i.mutation,l,$r.empty(),xt.now()),l)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.getLocalViewOfDocuments(e,i,bs()).next((()=>i))))}getLocalViewOfDocuments(e,t,i=bs()){const l=Vo();return this.populateOverlays(e,l,t).next((()=>this.computeViews(e,t,l,i).next((u=>{let d=su();return u.forEach(((p,g)=>{d=d.insert(p,g.overlayedDocument)})),d}))))}getOverlayedDocuments(e,t){const i=Vo();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,bs())))}populateOverlays(e,t,i){const l=[];return i.forEach((u=>{t.has(u)||l.push(u)})),this.documentOverlayCache.getOverlays(e,l).next((u=>{u.forEach(((d,p)=>{t.set(d,p)}))}))}computeViews(e,t,i,l){let u=yi();const d=cu(),p=(function(){return cu()})();return t.forEach(((g,y)=>{const w=i.get(y.key);l.has(y.key)&&(w===void 0||w.mutation instanceof yo)?u=u.insert(y.key,y):w!==void 0?(d.set(y.key,w.mutation.getFieldMask()),uu(w.mutation,y,w.mutation.getFieldMask(),xt.now())):d.set(y.key,$r.empty())})),this.recalculateAndSaveOverlays(e,u).next((g=>(g.forEach(((y,w)=>d.set(y,w))),t.forEach(((y,w)=>p.set(y,new FA(w,d.get(y)??null)))),p)))}recalculateAndSaveOverlays(e,t){const i=cu();let l=new hn(((d,p)=>d-p)),u=bs();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((d=>{for(const p of d)p.keys().forEach((g=>{const y=t.get(g);if(y===null)return;let w=i.get(g)||$r.empty();w=p.applyToLocalView(y,w),i.set(g,w);const j=(l.get(p.batchId)||bs()).add(g);l=l.insert(p.batchId,j)}))})).next((()=>{const d=[],p=l.getReverseIterator();for(;p.hasNext();){const g=p.getNext(),y=g.key,w=g.value,j=b_();w.forEach((T=>{if(!u.has(T)){const V=E_(t.get(T),i.get(T));V!==null&&j.set(T,V),u=u.add(T)}})),d.push(this.documentOverlayCache.saveOverlays(e,y,j))}return Pe.waitFor(d)})).next((()=>i))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.recalculateAndSaveOverlays(e,i)))}getDocumentsMatchingQuery(e,t,i,l){return HR(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):m_(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i,l):this.getDocumentsMatchingCollectionQuery(e,t,i,l)}getNextDocuments(e,t,i,l){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,l).next((u=>{const d=l-u.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,l-u.size):Pe.resolve(Vo());let p=bu,g=u;return d.next((y=>Pe.forEach(y,((w,j)=>(p<j.largestBatchId&&(p=j.largestBatchId),u.get(w)?Pe.resolve():this.remoteDocumentCache.getEntry(e,w).next((T=>{g=g.insert(w,T)}))))).next((()=>this.populateOverlays(e,y,u))).next((()=>this.computeViews(e,g,y,bs()))).next((w=>({batchId:p,changes:y_(w)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Nt(t)).next((i=>{let l=su();return i.isFoundDocument()&&(l=l.insert(i.key,i)),l}))}getDocumentsMatchingCollectionGroupQuery(e,t,i,l){const u=t.collectionGroup;let d=su();return this.indexManager.getCollectionParents(e,u).next((p=>Pe.forEach(p,(g=>{const y=(function(j,T){return new oc(T,null,j.explicitOrderBy.slice(),j.filters.slice(),j.limit,j.limitType,j.startAt,j.endAt)})(t,g.child(u));return this.getDocumentsMatchingCollectionQuery(e,y,i,l).next((w=>{w.forEach(((j,T)=>{d=d.insert(j,T)}))}))})).next((()=>d))))}getDocumentsMatchingCollectionQuery(e,t,i,l){let u;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next((d=>(u=d,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,u,l)))).next((d=>{u.forEach(((g,y)=>{const w=y.getKey();d.get(w)===null&&(d=d.insert(w,lr.newInvalidDocument(w)))}));let p=su();return d.forEach(((g,y)=>{const w=u.get(g);w!==void 0&&uu(w.mutation,y,$r.empty(),xt.now()),lm(t,y)&&(p=p.insert(g,y))})),p}))}}class qA{constructor(e){this.serializer=e,this.Nr=new Map,this.Br=new Map}getBundleMetadata(e,t){return Pe.resolve(this.Nr.get(t))}saveBundleMetadata(e,t){return this.Nr.set(t.id,(function(l){return{id:l.id,version:l.version,createTime:Ba(l.createTime)}})(t)),Pe.resolve()}getNamedQuery(e,t){return Pe.resolve(this.Br.get(t))}saveNamedQuery(e,t){return this.Br.set(t.name,(function(l){return{name:l.name,query:IA(l.bundledQuery),readTime:Ba(l.readTime)}})(t)),Pe.resolve()}}class HA{constructor(){this.overlays=new hn(Nt.comparator),this.Lr=new Map}getOverlay(e,t){return Pe.resolve(this.overlays.get(t))}getOverlays(e,t){const i=Vo();return Pe.forEach(t,(l=>this.getOverlay(e,l).next((u=>{u!==null&&i.set(l,u)})))).next((()=>i))}saveOverlays(e,t,i){return i.forEach(((l,u)=>{this.bt(e,t,u)})),Pe.resolve()}removeOverlaysForBatchId(e,t,i){const l=this.Lr.get(i);return l!==void 0&&(l.forEach((u=>this.overlays=this.overlays.remove(u))),this.Lr.delete(i)),Pe.resolve()}getOverlaysForCollection(e,t,i){const l=Vo(),u=t.length+1,d=new Nt(t.child("")),p=this.overlays.getIteratorFrom(d);for(;p.hasNext();){const g=p.getNext().value,y=g.getKey();if(!t.isPrefixOf(y.path))break;y.path.length===u&&g.largestBatchId>i&&l.set(g.getKey(),g)}return Pe.resolve(l)}getOverlaysForCollectionGroup(e,t,i,l){let u=new hn(((y,w)=>y-w));const d=this.overlays.getIterator();for(;d.hasNext();){const y=d.getNext().value;if(y.getKey().getCollectionGroup()===t&&y.largestBatchId>i){let w=u.get(y.largestBatchId);w===null&&(w=Vo(),u=u.insert(y.largestBatchId,w)),w.set(y.getKey(),y)}}const p=Vo(),g=u.getIterator();for(;g.hasNext()&&(g.getNext().value.forEach(((y,w)=>p.set(y,w))),!(p.size()>=l)););return Pe.resolve(p)}bt(e,t,i){const l=this.overlays.get(i.key);if(l!==null){const d=this.Lr.get(l.largestBatchId).delete(i.key);this.Lr.set(l.largestBatchId,d)}this.overlays=this.overlays.insert(i.key,new lA(t,i));let u=this.Lr.get(t);u===void 0&&(u=bs(),this.Lr.set(t,u)),this.Lr.set(t,u.add(i.key))}}class $A{constructor(){this.sessionToken=tr.EMPTY_BYTE_STRING}getSessionToken(e){return Pe.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,Pe.resolve()}}class my{constructor(){this.kr=new Bn(Hn.Kr),this.qr=new Bn(Hn.Ur)}isEmpty(){return this.kr.isEmpty()}addReference(e,t){const i=new Hn(e,t);this.kr=this.kr.add(i),this.qr=this.qr.add(i)}$r(e,t){e.forEach((i=>this.addReference(i,t)))}removeReference(e,t){this.Wr(new Hn(e,t))}Qr(e,t){e.forEach((i=>this.removeReference(i,t)))}Gr(e){const t=new Nt(new en([])),i=new Hn(t,e),l=new Hn(t,e+1),u=[];return this.qr.forEachInRange([i,l],(d=>{this.Wr(d),u.push(d.key)})),u}zr(){this.kr.forEach((e=>this.Wr(e)))}Wr(e){this.kr=this.kr.delete(e),this.qr=this.qr.delete(e)}jr(e){const t=new Nt(new en([])),i=new Hn(t,e),l=new Hn(t,e+1);let u=bs();return this.qr.forEachInRange([i,l],(d=>{u=u.add(d.key)})),u}containsKey(e){const t=new Hn(e,0),i=this.kr.firstAfterOrEqual(t);return i!==null&&e.isEqual(i.key)}}class Hn{constructor(e,t){this.key=e,this.Hr=t}static Kr(e,t){return Nt.comparator(e.key,t.key)||ys(e.Hr,t.Hr)}static Ur(e,t){return ys(e.Hr,t.Hr)||Nt.comparator(e.key,t.key)}}class WA{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Yn=1,this.Jr=new Bn(Hn.Kr)}checkEmpty(e){return Pe.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,i,l){const u=this.Yn;this.Yn++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const d=new oA(u,t,i,l);this.mutationQueue.push(d);for(const p of l)this.Jr=this.Jr.add(new Hn(p.key,u)),this.indexManager.addToCollectionParentIndex(e,p.key.path.popLast());return Pe.resolve(d)}lookupMutationBatch(e,t){return Pe.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,l=this.Xr(i),u=l<0?0:l;return Pe.resolve(this.mutationQueue.length>u?this.mutationQueue[u]:null)}getHighestUnacknowledgedBatchId(){return Pe.resolve(this.mutationQueue.length===0?ry:this.Yn-1)}getAllMutationBatches(e){return Pe.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const i=new Hn(t,0),l=new Hn(t,Number.POSITIVE_INFINITY),u=[];return this.Jr.forEachInRange([i,l],(d=>{const p=this.Zr(d.Hr);u.push(p)})),Pe.resolve(u)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new Bn(ys);return t.forEach((l=>{const u=new Hn(l,0),d=new Hn(l,Number.POSITIVE_INFINITY);this.Jr.forEachInRange([u,d],(p=>{i=i.add(p.Hr)}))})),Pe.resolve(this.Yr(i))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,l=i.length+1;let u=i;Nt.isDocumentKey(u)||(u=u.child(""));const d=new Hn(new Nt(u),0);let p=new Bn(ys);return this.Jr.forEachWhile((g=>{const y=g.key.path;return!!i.isPrefixOf(y)&&(y.length===l&&(p=p.add(g.Hr)),!0)}),d),Pe.resolve(this.Yr(p))}Yr(e){const t=[];return e.forEach((i=>{const l=this.Zr(i);l!==null&&t.push(l)})),t}removeMutationBatch(e,t){Us(this.ei(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.Jr;return Pe.forEach(t.mutations,(l=>{const u=new Hn(l.key,t.batchId);return i=i.delete(u),this.referenceDelegate.markPotentiallyOrphaned(e,l.key)})).next((()=>{this.Jr=i}))}nr(e){}containsKey(e,t){const i=new Hn(t,0),l=this.Jr.firstAfterOrEqual(i);return Pe.resolve(t.isEqual(l&&l.key))}performConsistencyCheck(e){return this.mutationQueue.length,Pe.resolve()}ei(e,t){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class GA{constructor(e){this.ti=e,this.docs=(function(){return new hn(Nt.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const i=t.key,l=this.docs.get(i),u=l?l.size:0,d=this.ti(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:d}),this.size+=d-u,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const i=this.docs.get(t);return Pe.resolve(i?i.document.mutableCopy():lr.newInvalidDocument(t))}getEntries(e,t){let i=yi();return t.forEach((l=>{const u=this.docs.get(l);i=i.insert(l,u?u.document.mutableCopy():lr.newInvalidDocument(l))})),Pe.resolve(i)}getDocumentsMatchingQuery(e,t,i,l){let u=yi();const d=t.path,p=new Nt(d.child("__id-9223372036854775808__")),g=this.docs.getIteratorFrom(p);for(;g.hasNext();){const{key:y,value:{document:w}}=g.getNext();if(!d.isPrefixOf(y.path))break;y.path.length>d.length+1||xR(vR(w),i)<=0||(l.has(w.key)||lm(t,w))&&(u=u.insert(w.key,w.mutableCopy()))}return Pe.resolve(u)}getAllFromCollectionGroup(e,t,i,l){Lt(9500)}ni(e,t){return Pe.forEach(this.docs,(i=>t(i)))}newChangeBuffer(e){return new KA(this)}getSize(e){return Pe.resolve(this.size)}}class KA extends UA{constructor(e){super(),this.Mr=e}applyChanges(e){const t=[];return this.changes.forEach(((i,l)=>{l.isValidDocument()?t.push(this.Mr.addEntry(e,l)):this.Mr.removeEntry(i)})),Pe.waitFor(t)}getFromCache(e,t){return this.Mr.getEntry(e,t)}getAllFromCache(e,t){return this.Mr.getEntries(e,t)}}class YA{constructor(e){this.persistence=e,this.ri=new Zo((t=>oy(t)),ly),this.lastRemoteSnapshotVersion=$t.min(),this.highestTargetId=0,this.ii=0,this.si=new my,this.targetCount=0,this.oi=Jl._r()}forEachTarget(e,t){return this.ri.forEach(((i,l)=>t(l))),Pe.resolve()}getLastRemoteSnapshotVersion(e){return Pe.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Pe.resolve(this.ii)}allocateTargetId(e){return this.highestTargetId=this.oi.next(),Pe.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.ii&&(this.ii=t),Pe.resolve()}lr(e){this.ri.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.oi=new Jl(t),this.highestTargetId=t),e.sequenceNumber>this.ii&&(this.ii=e.sequenceNumber)}addTargetData(e,t){return this.lr(t),this.targetCount+=1,Pe.resolve()}updateTargetData(e,t){return this.lr(t),Pe.resolve()}removeTargetData(e,t){return this.ri.delete(t.target),this.si.Gr(t.targetId),this.targetCount-=1,Pe.resolve()}removeTargets(e,t,i){let l=0;const u=[];return this.ri.forEach(((d,p)=>{p.sequenceNumber<=t&&i.get(p.targetId)===null&&(this.ri.delete(d),u.push(this.removeMatchingKeysForTargetId(e,p.targetId)),l++)})),Pe.waitFor(u).next((()=>l))}getTargetCount(e){return Pe.resolve(this.targetCount)}getTargetData(e,t){const i=this.ri.get(t)||null;return Pe.resolve(i)}addMatchingKeys(e,t,i){return this.si.$r(t,i),Pe.resolve()}removeMatchingKeys(e,t,i){this.si.Qr(t,i);const l=this.persistence.referenceDelegate,u=[];return l&&t.forEach((d=>{u.push(l.markPotentiallyOrphaned(e,d))})),Pe.waitFor(u)}removeMatchingKeysForTargetId(e,t){return this.si.Gr(t),Pe.resolve()}getMatchingKeysForTargetId(e,t){const i=this.si.jr(t);return Pe.resolve(i)}containsKey(e,t){return Pe.resolve(this.si.containsKey(t))}}class U_{constructor(e,t){this._i={},this.overlays={},this.ai=new nm(0),this.ui=!1,this.ui=!0,this.ci=new $A,this.referenceDelegate=e(this),this.li=new YA(this),this.indexManager=new MA,this.remoteDocumentCache=(function(l){return new GA(l)})((i=>this.referenceDelegate.hi(i))),this.serializer=new AA(t),this.Pi=new qA(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ui=!1,Promise.resolve()}get started(){return this.ui}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new HA,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this._i[e.toKey()];return i||(i=new WA(t,this.referenceDelegate),this._i[e.toKey()]=i),i}getGlobalsCache(){return this.ci}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Pi}runTransaction(e,t,i){dt("MemoryPersistence","Starting transaction:",e);const l=new QA(this.ai.next());return this.referenceDelegate.Ti(),i(l).next((u=>this.referenceDelegate.Ii(l).next((()=>u)))).toPromise().then((u=>(l.raiseOnCommittedEvent(),u)))}Ei(e,t){return Pe.or(Object.values(this._i).map((i=>()=>i.containsKey(e,t))))}}class QA extends _R{constructor(e){super(),this.currentSequenceNumber=e}}class fy{constructor(e){this.persistence=e,this.Ri=new my,this.Ai=null}static Vi(e){return new fy(e)}get di(){if(this.Ai)return this.Ai;throw Lt(60996)}addReference(e,t,i){return this.Ri.addReference(i,t),this.di.delete(i.toString()),Pe.resolve()}removeReference(e,t,i){return this.Ri.removeReference(i,t),this.di.add(i.toString()),Pe.resolve()}markPotentiallyOrphaned(e,t){return this.di.add(t.toString()),Pe.resolve()}removeTarget(e,t){this.Ri.Gr(t.targetId).forEach((l=>this.di.add(l.toString())));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next((l=>{l.forEach((u=>this.di.add(u.toString())))})).next((()=>i.removeTargetData(e,t)))}Ti(){this.Ai=new Set}Ii(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Pe.forEach(this.di,(i=>{const l=Nt.fromPath(i);return this.mi(e,l).next((u=>{u||t.removeEntry(l,$t.min())}))})).next((()=>(this.Ai=null,t.apply(e))))}updateLimboDocument(e,t){return this.mi(e,t).next((i=>{i?this.di.delete(t.toString()):this.di.add(t.toString())}))}hi(e){return 0}mi(e,t){return Pe.or([()=>Pe.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}}class zh{constructor(e,t){this.persistence=e,this.fi=new Zo((i=>TR(i.path)),((i,l)=>i.isEqual(l))),this.garbageCollector=BA(this,t)}static Vi(e,t){return new zh(e,t)}Ti(){}Ii(e){return Pe.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}dr(e){const t=this.pr(e);return this.persistence.getTargetCache().getTargetCount(e).next((i=>t.next((l=>i+l))))}pr(e){let t=0;return this.mr(e,(i=>{t++})).next((()=>t))}mr(e,t){return Pe.forEach(this.fi,((i,l)=>this.wr(e,i,l).next((u=>u?Pe.resolve():t(l)))))}removeTargets(e,t,i){return this.persistence.getTargetCache().removeTargets(e,t,i)}removeOrphanedDocuments(e,t){let i=0;const l=this.persistence.getRemoteDocumentCache(),u=l.newChangeBuffer();return l.ni(e,(d=>this.wr(e,d,t).next((p=>{p||(i++,u.removeEntry(d,$t.min()))})))).next((()=>u.apply(e))).next((()=>i))}markPotentiallyOrphaned(e,t){return this.fi.set(t,e.currentSequenceNumber),Pe.resolve()}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,i)}addReference(e,t,i){return this.fi.set(i,e.currentSequenceNumber),Pe.resolve()}removeReference(e,t,i){return this.fi.set(i,e.currentSequenceNumber),Pe.resolve()}updateLimboDocument(e,t){return this.fi.set(t,e.currentSequenceNumber),Pe.resolve()}hi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=wh(e.data.value)),t}wr(e,t,i){return Pe.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const l=this.fi.get(t);return Pe.resolve(l!==void 0&&l>i)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class py{constructor(e,t,i,l){this.targetId=e,this.fromCache=t,this.Ts=i,this.Is=l}static Es(e,t){let i=bs(),l=bs();for(const u of t.docChanges)switch(u.type){case 0:i=i.add(u.doc.key);break;case 1:l=l.add(u.doc.key)}return new py(e,t.fromCache,i,l)}}class XA{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class JA{constructor(){this.Rs=!1,this.As=!1,this.Vs=100,this.ds=(function(){return TN()?8:kR(cr())>0?6:4})()}initialize(e,t){this.fs=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,i,l){const u={result:null};return this.gs(e,t).next((d=>{u.result=d})).next((()=>{if(!u.result)return this.ps(e,t,l,i).next((d=>{u.result=d}))})).next((()=>{if(u.result)return;const d=new XA;return this.ys(e,t,d).next((p=>{if(u.result=p,this.As)return this.ws(e,t,d,p.size)}))})).next((()=>u.result))}ws(e,t,i,l){return i.documentReadCount<this.Vs?(Vl()<=gs.DEBUG&&dt("QueryEngine","SDK will not create cache indexes for query:",Bl(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),Pe.resolve()):(Vl()<=gs.DEBUG&&dt("QueryEngine","Query:",Bl(t),"scans",i.documentReadCount,"local documents and returns",l,"documents as results."),i.documentReadCount>this.ds*l?(Vl()<=gs.DEBUG&&dt("QueryEngine","The SDK decides to create cache indexes for query:",Bl(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Va(t))):Pe.resolve())}gs(e,t){if(Ax(t))return Pe.resolve(null);let i=Va(t);return this.indexManager.getIndexType(e,i).next((l=>l===0?null:(t.limit!==null&&l===1&&(t=Uh(t,null,"F"),i=Va(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next((u=>{const d=bs(...u);return this.fs.getDocuments(e,d).next((p=>this.indexManager.getMinOffset(e,i).next((g=>{const y=this.bs(t,p);return this.Ss(t,y,d,g.readTime)?this.gs(e,Uh(t,null,"F")):this.Ds(e,y,t,g)}))))})))))}ps(e,t,i,l){return Ax(t)||l.isEqual($t.min())?Pe.resolve(null):this.fs.getDocuments(e,i).next((u=>{const d=this.bs(t,u);return this.Ss(t,d,i,l)?Pe.resolve(null):(Vl()<=gs.DEBUG&&dt("QueryEngine","Re-using previous result from %s to execute query: %s",l.toString(),Bl(t)),this.Ds(e,d,t,bR(l,bu)).next((p=>p)))}))}bs(e,t){let i=new Bn(p_(e));return t.forEach(((l,u)=>{lm(e,u)&&(i=i.add(u))})),i}Ss(e,t,i,l){if(e.limit===null)return!1;if(i.size!==t.size)return!0;const u=e.limitType==="F"?t.last():t.first();return!!u&&(u.hasPendingWrites||u.version.compareTo(l)>0)}ys(e,t,i){return Vl()<=gs.DEBUG&&dt("QueryEngine","Using full collection scan to execute query:",Bl(t)),this.fs.getDocumentsMatchingQuery(e,t,oo.min(),i)}Ds(e,t,i,l){return this.fs.getDocumentsMatchingQuery(e,i,l).next((u=>(t.forEach((d=>{u=u.insert(d.key,d)})),u)))}}const gy="LocalStore",ZA=3e8;class eI{constructor(e,t,i,l){this.persistence=e,this.Cs=t,this.serializer=l,this.vs=new hn(ys),this.Fs=new Zo((u=>oy(u)),ly),this.Ms=new Map,this.xs=e.getRemoteDocumentCache(),this.li=e.getTargetCache(),this.Pi=e.getBundleCache(),this.Os(i)}Os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new zA(this.xs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.xs.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.vs)))}}function tI(n,e,t,i){return new eI(n,e,t,i)}async function F_(n,e){const t=Qt(n);return await t.persistence.runTransaction("Handle user change","readonly",(i=>{let l;return t.mutationQueue.getAllMutationBatches(i).next((u=>(l=u,t.Os(e),t.mutationQueue.getAllMutationBatches(i)))).next((u=>{const d=[],p=[];let g=bs();for(const y of l){d.push(y.batchId);for(const w of y.mutations)g=g.add(w.key)}for(const y of u){p.push(y.batchId);for(const w of y.mutations)g=g.add(w.key)}return t.localDocuments.getDocuments(i,g).next((y=>({Ns:y,removedBatchIds:d,addedBatchIds:p})))}))}))}function sI(n,e){const t=Qt(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(i=>{const l=e.batch.keys(),u=t.xs.newChangeBuffer({trackRemovals:!0});return(function(p,g,y,w){const j=y.batch,T=j.keys();let V=Pe.resolve();return T.forEach((W=>{V=V.next((()=>w.getEntry(g,W))).next((F=>{const U=y.docVersions.get(W);Us(U!==null,48541),F.version.compareTo(U)<0&&(j.applyToRemoteDocument(F,y),F.isValidDocument()&&(F.setReadTime(y.commitVersion),w.addEntry(F)))}))})),V.next((()=>p.mutationQueue.removeMutationBatch(g,j)))})(t,i,e,u).next((()=>u.apply(i))).next((()=>t.mutationQueue.performConsistencyCheck(i))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(i,l,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,(function(p){let g=bs();for(let y=0;y<p.mutationResults.length;++y)p.mutationResults[y].transformResults.length>0&&(g=g.add(p.batch.mutations[y].key));return g})(e)))).next((()=>t.localDocuments.getDocuments(i,l)))}))}function z_(n){const e=Qt(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.li.getLastRemoteSnapshotVersion(t)))}function nI(n,e){const t=Qt(n),i=e.snapshotVersion;let l=t.vs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(u=>{const d=t.xs.newChangeBuffer({trackRemovals:!0});l=t.vs;const p=[];e.targetChanges.forEach(((w,j)=>{const T=l.get(j);if(!T)return;p.push(t.li.removeMatchingKeys(u,w.removedDocuments,j).next((()=>t.li.addMatchingKeys(u,w.addedDocuments,j))));let V=T.withSequenceNumber(u.currentSequenceNumber);e.targetMismatches.get(j)!==null?V=V.withResumeToken(tr.EMPTY_BYTE_STRING,$t.min()).withLastLimboFreeSnapshotVersion($t.min()):w.resumeToken.approximateByteSize()>0&&(V=V.withResumeToken(w.resumeToken,i)),l=l.insert(j,V),(function(F,U,ne){return F.resumeToken.approximateByteSize()===0||U.snapshotVersion.toMicroseconds()-F.snapshotVersion.toMicroseconds()>=ZA?!0:ne.addedDocuments.size+ne.modifiedDocuments.size+ne.removedDocuments.size>0})(T,V,w)&&p.push(t.li.updateTargetData(u,V))}));let g=yi(),y=bs();if(e.documentUpdates.forEach((w=>{e.resolvedLimboDocuments.has(w)&&p.push(t.persistence.referenceDelegate.updateLimboDocument(u,w))})),p.push(rI(u,d,e.documentUpdates).next((w=>{g=w.Bs,y=w.Ls}))),!i.isEqual($t.min())){const w=t.li.getLastRemoteSnapshotVersion(u).next((j=>t.li.setTargetsMetadata(u,u.currentSequenceNumber,i)));p.push(w)}return Pe.waitFor(p).next((()=>d.apply(u))).next((()=>t.localDocuments.getLocalViewOfDocuments(u,g,y))).next((()=>g))})).then((u=>(t.vs=l,u)))}function rI(n,e,t){let i=bs(),l=bs();return t.forEach((u=>i=i.add(u))),e.getEntries(n,i).next((u=>{let d=yi();return t.forEach(((p,g)=>{const y=u.get(p);g.isFoundDocument()!==y.isFoundDocument()&&(l=l.add(p)),g.isNoDocument()&&g.version.isEqual($t.min())?(e.removeEntry(p,g.readTime),d=d.insert(p,g)):!y.isValidDocument()||g.version.compareTo(y.version)>0||g.version.compareTo(y.version)===0&&y.hasPendingWrites?(e.addEntry(g),d=d.insert(p,g)):dt(gy,"Ignoring outdated watch update for ",p,". Current version:",y.version," Watch version:",g.version)})),{Bs:d,Ls:l}}))}function aI(n,e){const t=Qt(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(i=>(e===void 0&&(e=ry),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e))))}function iI(n,e){const t=Qt(n);return t.persistence.runTransaction("Allocate target","readwrite",(i=>{let l;return t.li.getTargetData(i,e).next((u=>u?(l=u,Pe.resolve(l)):t.li.allocateTargetId(i).next((d=>(l=new Zi(e,d,"TargetPurposeListen",i.currentSequenceNumber),t.li.addTargetData(i,l).next((()=>l)))))))})).then((i=>{const l=t.vs.get(i.targetId);return(l===null||i.snapshotVersion.compareTo(l.snapshotVersion)>0)&&(t.vs=t.vs.insert(i.targetId,i),t.Fs.set(e,i.targetId)),i}))}async function Tg(n,e,t){const i=Qt(n),l=i.vs.get(e),u=t?"readwrite":"readwrite-primary";try{t||await i.persistence.runTransaction("Release target",u,(d=>i.persistence.referenceDelegate.removeTarget(d,l)))}catch(d){if(!ic(d))throw d;dt(gy,`Failed to update sequence numbers for target ${e}: ${d}`)}i.vs=i.vs.remove(e),i.Fs.delete(l.target)}function Hx(n,e,t){const i=Qt(n);let l=$t.min(),u=bs();return i.persistence.runTransaction("Execute query","readwrite",(d=>(function(g,y,w){const j=Qt(g),T=j.Fs.get(w);return T!==void 0?Pe.resolve(j.vs.get(T)):j.li.getTargetData(y,w)})(i,d,Va(e)).next((p=>{if(p)return l=p.lastLimboFreeSnapshotVersion,i.li.getMatchingKeysForTargetId(d,p.targetId).next((g=>{u=g}))})).next((()=>i.Cs.getDocumentsMatchingQuery(d,e,t?l:$t.min(),t?u:bs()))).next((p=>(oI(i,GR(e),p),{documents:p,ks:u})))))}function oI(n,e,t){let i=n.Ms.get(e)||$t.min();t.forEach(((l,u)=>{u.readTime.compareTo(i)>0&&(i=u.readTime)})),n.Ms.set(e,i)}class $x{constructor(){this.activeTargetIds=ZR()}Qs(e){this.activeTargetIds=this.activeTargetIds.add(e)}Gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class lI{constructor(){this.vo=new $x,this.Fo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e,t=!0){return t&&this.vo.Qs(e),this.Fo[e]||"not-current"}updateQueryState(e,t,i){this.Fo[e]=t}removeLocalQueryTarget(e){this.vo.Gs(e)}isLocalQueryTarget(e){return this.vo.activeTargetIds.has(e)}clearQueryState(e){delete this.Fo[e]}getAllActiveQueryTargets(){return this.vo.activeTargetIds}isActiveQueryTarget(e){return this.vo.activeTargetIds.has(e)}start(){return this.vo=new $x,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class cI{Mo(e){}shutdown(){}}const Wx="ConnectivityMonitor";class Gx{constructor(){this.xo=()=>this.Oo(),this.No=()=>this.Bo(),this.Lo=[],this.ko()}Mo(e){this.Lo.push(e)}shutdown(){window.removeEventListener("online",this.xo),window.removeEventListener("offline",this.No)}ko(){window.addEventListener("online",this.xo),window.addEventListener("offline",this.No)}Oo(){dt(Wx,"Network connectivity changed: AVAILABLE");for(const e of this.Lo)e(0)}Bo(){dt(Wx,"Network connectivity changed: UNAVAILABLE");for(const e of this.Lo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let ah=null;function Eg(){return ah===null?ah=(function(){return 268435456+Math.round(2147483648*Math.random())})():ah++,"0x"+ah.toString(16)}const Dp="RestConnection",uI={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery",ExecutePipeline:"executePipeline"};class dI{get Ko(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),l=encodeURIComponent(this.databaseId.database);this.qo=t+"://"+e.host,this.Uo=`projects/${i}/databases/${l}`,this.$o=this.databaseId.database===Oh?`project_id=${i}`:`project_id=${i}&database_id=${l}`}Wo(e,t,i,l,u){const d=Eg(),p=this.Qo(e,t.toUriEncodedString());dt(Dp,`Sending RPC '${e}' ${d}:`,p,i);const g={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.$o};this.Go(g,l,u);const{host:y}=new URL(p),w=fo(y);return this.zo(e,p,g,i,w).then((j=>(dt(Dp,`Received RPC '${e}' ${d}: `,j),j)),(j=>{throw Kl(Dp,`RPC '${e}' ${d} failed with error: `,j,"url: ",p,"request:",i),j}))}jo(e,t,i,l,u,d){return this.Wo(e,t,i,l,u)}Go(e,t,i){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+rc})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((l,u)=>e[u]=l)),i&&i.headers.forEach(((l,u)=>e[u]=l))}Qo(e,t){const i=uI[e];let l=`${this.qo}/v1/${t}:${i}`;return this.databaseInfo.apiKey&&(l=`${l}?key=${encodeURIComponent(this.databaseInfo.apiKey)}`),l}terminate(){}}class hI{constructor(e){this.Ho=e.Ho,this.Jo=e.Jo}Zo(e){this.Xo=e}Yo(e){this.e_=e}t_(e){this.n_=e}onMessage(e){this.r_=e}close(){this.Jo()}send(e){this.Ho(e)}i_(){this.Xo()}s_(){this.e_()}o_(e){this.n_(e)}__(e){this.r_(e)}}const ir="WebChannelConnection",Kc=(n,e,t)=>{n.listen(e,(i=>{try{t(i)}catch(l){setTimeout((()=>{throw l}),0)}}))};class Wl extends dI{constructor(e){super(e),this.a_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}static u_(){if(!Wl.c_){const e=$w();Kc(e,Hw.STAT_EVENT,(t=>{t.stat===fg.PROXY?dt(ir,"STAT_EVENT: detected buffering proxy"):t.stat===fg.NOPROXY&&dt(ir,"STAT_EVENT: detected no buffering proxy")})),Wl.c_=!0}}zo(e,t,i,l,u){const d=Eg();return new Promise(((p,g)=>{const y=new zw;y.setWithCredentials(!0),y.listenOnce(qw.COMPLETE,(()=>{try{switch(y.getLastErrorCode()){case xh.NO_ERROR:const j=y.getResponseJson();dt(ir,`XHR for RPC '${e}' ${d} received:`,JSON.stringify(j)),p(j);break;case xh.TIMEOUT:dt(ir,`RPC '${e}' ${d} timed out`),g(new tt(Se.DEADLINE_EXCEEDED,"Request time out"));break;case xh.HTTP_ERROR:const T=y.getStatus();if(dt(ir,`RPC '${e}' ${d} failed with status:`,T,"response text:",y.getResponseText()),T>0){let V=y.getResponseJson();Array.isArray(V)&&(V=V[0]);const W=V?.error;if(W&&W.status&&W.message){const F=(function(ne){const Y=ne.toLowerCase().replace(/_/g,"-");return Object.values(Se).indexOf(Y)>=0?Y:Se.UNKNOWN})(W.status);g(new tt(F,W.message))}else g(new tt(Se.UNKNOWN,"Server responded with status "+y.getStatus()))}else g(new tt(Se.UNAVAILABLE,"Connection failed."));break;default:Lt(9055,{l_:e,streamId:d,h_:y.getLastErrorCode(),P_:y.getLastError()})}}finally{dt(ir,`RPC '${e}' ${d} completed.`)}}));const w=JSON.stringify(l);dt(ir,`RPC '${e}' ${d} sending request:`,l),y.send(t,"POST",w,i,15)}))}T_(e,t,i){const l=Eg(),u=[this.qo,"/","google.firestore.v1.Firestore","/",e,"/channel"],d=this.createWebChannelTransport(),p={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},g=this.longPollingOptions.timeoutSeconds;g!==void 0&&(p.longPollingTimeout=Math.round(1e3*g)),this.useFetchStreams&&(p.useFetchStreams=!0),this.Go(p.initMessageHeaders,t,i),p.encodeInitMessageHeaders=!0;const y=u.join("");dt(ir,`Creating RPC '${e}' stream ${l}: ${y}`,p);const w=d.createWebChannel(y,p);this.I_(w);let j=!1,T=!1;const V=new hI({Ho:W=>{T?dt(ir,`Not sending because RPC '${e}' stream ${l} is closed:`,W):(j||(dt(ir,`Opening RPC '${e}' stream ${l} transport.`),w.open(),j=!0),dt(ir,`RPC '${e}' stream ${l} sending:`,W),w.send(W))},Jo:()=>w.close()});return Kc(w,tu.EventType.OPEN,(()=>{T||(dt(ir,`RPC '${e}' stream ${l} transport opened.`),V.i_())})),Kc(w,tu.EventType.CLOSE,(()=>{T||(T=!0,dt(ir,`RPC '${e}' stream ${l} transport closed`),V.o_(),this.E_(w))})),Kc(w,tu.EventType.ERROR,(W=>{T||(T=!0,Kl(ir,`RPC '${e}' stream ${l} transport errored. Name:`,W.name,"Message:",W.message),V.o_(new tt(Se.UNAVAILABLE,"The operation could not be completed")))})),Kc(w,tu.EventType.MESSAGE,(W=>{if(!T){const F=W.data[0];Us(!!F,16349);const U=F,ne=U?.error||U[0]?.error;if(ne){dt(ir,`RPC '${e}' stream ${l} received error:`,ne);const Y=ne.status;let oe=(function(Ce){const R=Mn[Ce];if(R!==void 0)return S_(R)})(Y),be=ne.message;oe===void 0&&(oe=Se.INTERNAL,be="Unknown error status: "+Y+" with message "+ne.message),T=!0,V.o_(new tt(oe,be)),w.close()}else dt(ir,`RPC '${e}' stream ${l} received:`,F),V.__(F)}})),Wl.u_(),setTimeout((()=>{V.s_()}),0),V}terminate(){this.a_.forEach((e=>e.close())),this.a_=[]}I_(e){this.a_.push(e)}E_(e){this.a_=this.a_.filter((t=>t===e))}Go(e,t,i){super.Go(e,t,i),this.databaseInfo.apiKey&&(e["x-goog-api-key"]=this.databaseInfo.apiKey)}createWebChannelTransport(){return Ww()}}function mI(n){return new Wl(n)}function Pp(){return typeof document<"u"?document:null}function mm(n){return new yA(n,!0)}Wl.c_=!1;class q_{constructor(e,t,i=1e3,l=1.5,u=6e4){this.Ci=e,this.timerId=t,this.R_=i,this.A_=l,this.V_=u,this.d_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.d_=0}g_(){this.d_=this.V_}p_(e){this.cancel();const t=Math.floor(this.d_+this.y_()),i=Math.max(0,Date.now()-this.f_),l=Math.max(0,t-i);l>0&&dt("ExponentialBackoff",`Backing off for ${l} ms (base delay: ${this.d_} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.m_=this.Ci.enqueueAfterDelay(this.timerId,l,(()=>(this.f_=Date.now(),e()))),this.d_*=this.A_,this.d_<this.R_&&(this.d_=this.R_),this.d_>this.V_&&(this.d_=this.V_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.d_}}const Kx="PersistentStream";class H_{constructor(e,t,i,l,u,d,p,g){this.Ci=e,this.b_=i,this.S_=l,this.connection=u,this.authCredentialsProvider=d,this.appCheckCredentialsProvider=p,this.listener=g,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new q_(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Ci.enqueueAfterDelay(this.b_,6e4,(()=>this.k_())))}K_(e){this.q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===Se.RESOURCE_EXHAUSTED?(gi(t.toString()),gi("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===Se.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.t_(t)}W_(){}auth(){this.state=1;const e=this.Q_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([i,l])=>{this.D_===t&&this.G_(i,l)}),(i=>{e((()=>{const l=new tt(Se.UNKNOWN,"Fetching auth token failed: "+i.message);return this.z_(l)}))}))}G_(e,t){const i=this.Q_(this.D_);this.stream=this.j_(e,t),this.stream.Zo((()=>{i((()=>this.listener.Zo()))})),this.stream.Yo((()=>{i((()=>(this.state=2,this.v_=this.Ci.enqueueAfterDelay(this.S_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.Yo())))})),this.stream.t_((l=>{i((()=>this.z_(l)))})),this.stream.onMessage((l=>{i((()=>++this.F_==1?this.H_(l):this.onNext(l)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return dt(Kx,`close with error: ${e}`),this.stream=null,this.close(4,e)}Q_(e){return t=>{this.Ci.enqueueAndForget((()=>this.D_===e?t():(dt(Kx,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class fI extends H_{constructor(e,t,i,l,u,d){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,i,l,d),this.serializer=u}j_(e,t){return this.connection.T_("Listen",e,t)}H_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=xA(this.serializer,e),i=(function(u){if(!("targetChange"in u))return $t.min();const d=u.targetChange;return d.targetIds&&d.targetIds.length?$t.min():d.readTime?Ba(d.readTime):$t.min()})(e);return this.listener.J_(t,i)}Z_(e){const t={};t.database=jg(this.serializer),t.addTarget=(function(u,d){let p;const g=d.target;if(p=vg(g)?{documents:kA(u,g)}:{query:jA(u,g).ft},p.targetId=d.targetId,d.resumeToken.approximateByteSize()>0){p.resumeToken=A_(u,d.resumeToken);const y=wg(u,d.expectedCount);y!==null&&(p.expectedCount=y)}else if(d.snapshotVersion.compareTo($t.min())>0){p.readTime=Fh(u,d.snapshotVersion.toTimestamp());const y=wg(u,d.expectedCount);y!==null&&(p.expectedCount=y)}return p})(this.serializer,e);const i=EA(this.serializer,e);i&&(t.labels=i),this.K_(t)}X_(e){const t={};t.database=jg(this.serializer),t.removeTarget=e,this.K_(t)}}class pI extends H_{constructor(e,t,i,l,u,d){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,l,d),this.serializer=u}get Y_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.Y_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}H_(e){return Us(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Us(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Us(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=_A(e.writeResults,e.commitTime),i=Ba(e.commitTime);return this.listener.na(i,t)}ra(){const e={};e.database=jg(this.serializer),this.K_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((i=>wA(this.serializer,i)))};this.K_(t)}}class gI{}class yI extends gI{constructor(e,t,i,l){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=l,this.ia=!1}sa(){if(this.ia)throw new tt(Se.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,i,l){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([u,d])=>this.connection.Wo(e,_g(t,i),l,u,d))).catch((u=>{throw u.name==="FirebaseError"?(u.code===Se.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),u):new tt(Se.UNKNOWN,u.toString())}))}jo(e,t,i,l,u){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([d,p])=>this.connection.jo(e,_g(t,i),l,d,p,u))).catch((d=>{throw d.name==="FirebaseError"?(d.code===Se.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),d):new tt(Se.UNKNOWN,d.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}function bI(n,e,t,i){return new yI(n,e,t,i)}class vI{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(gi(t),this.aa=!1):dt("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const Yo="RemoteStore";class xI{constructor(e,t,i,l,u){this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.Ra=[],this.Aa=u,this.Aa.Mo((d=>{i.enqueueAndForget((async()=>{el(this)&&(dt(Yo,"Restarting streams for network reachability change."),await(async function(g){const y=Qt(g);y.Ea.add(4),await Vu(y),y.Va.set("Unknown"),y.Ea.delete(4),await fm(y)})(this))}))})),this.Va=new vI(i,l)}}async function fm(n){if(el(n))for(const e of n.Ra)await e(!0)}async function Vu(n){for(const e of n.Ra)await e(!1)}function $_(n,e){const t=Qt(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),xy(t)?vy(t):lc(t).O_()&&by(t,e))}function yy(n,e){const t=Qt(n),i=lc(t);t.Ia.delete(e),i.O_()&&W_(t,e),t.Ia.size===0&&(i.O_()?i.L_():el(t)&&t.Va.set("Unknown"))}function by(n,e){if(n.da.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo($t.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}lc(n).Z_(e)}function W_(n,e){n.da.$e(e),lc(n).X_(e)}function vy(n){n.da=new mA({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),lc(n).start(),n.Va.ua()}function xy(n){return el(n)&&!lc(n).x_()&&n.Ia.size>0}function el(n){return Qt(n).Ea.size===0}function G_(n){n.da=void 0}async function wI(n){n.Va.set("Online")}async function _I(n){n.Ia.forEach(((e,t)=>{by(n,e)}))}async function kI(n,e){G_(n),xy(n)?(n.Va.ha(e),vy(n)):n.Va.set("Unknown")}async function jI(n,e,t){if(n.Va.set("Online"),e instanceof R_&&e.state===2&&e.cause)try{await(async function(l,u){const d=u.cause;for(const p of u.targetIds)l.Ia.has(p)&&(await l.remoteSyncer.rejectListen(p,d),l.Ia.delete(p),l.da.removeTarget(p))})(n,e)}catch(i){dt(Yo,"Failed to remove targets %s: %s ",e.targetIds.join(","),i),await qh(n,i)}else if(e instanceof jh?n.da.Xe(e):e instanceof C_?n.da.st(e):n.da.tt(e),!t.isEqual($t.min()))try{const i=await z_(n.localStore);t.compareTo(i)>=0&&await(function(u,d){const p=u.da.Tt(d);return p.targetChanges.forEach(((g,y)=>{if(g.resumeToken.approximateByteSize()>0){const w=u.Ia.get(y);w&&u.Ia.set(y,w.withResumeToken(g.resumeToken,d))}})),p.targetMismatches.forEach(((g,y)=>{const w=u.Ia.get(g);if(!w)return;u.Ia.set(g,w.withResumeToken(tr.EMPTY_BYTE_STRING,w.snapshotVersion)),W_(u,g);const j=new Zi(w.target,g,y,w.sequenceNumber);by(u,j)})),u.remoteSyncer.applyRemoteEvent(p)})(n,t)}catch(i){dt(Yo,"Failed to raise snapshot:",i),await qh(n,i)}}async function qh(n,e,t){if(!ic(e))throw e;n.Ea.add(1),await Vu(n),n.Va.set("Offline"),t||(t=()=>z_(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{dt(Yo,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await fm(n)}))}function K_(n,e){return e().catch((t=>qh(n,t,e)))}async function pm(n){const e=Qt(n),t=ho(e);let i=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:ry;for(;TI(e);)try{const l=await aI(e.localStore,i);if(l===null){e.Ta.length===0&&t.L_();break}i=l.batchId,EI(e,l)}catch(l){await qh(e,l)}Y_(e)&&Q_(e)}function TI(n){return el(n)&&n.Ta.length<10}function EI(n,e){n.Ta.push(e);const t=ho(n);t.O_()&&t.Y_&&t.ea(e.mutations)}function Y_(n){return el(n)&&!ho(n).x_()&&n.Ta.length>0}function Q_(n){ho(n).start()}async function NI(n){ho(n).ra()}async function SI(n){const e=ho(n);for(const t of n.Ta)e.ea(t.mutations)}async function CI(n,e,t){const i=n.Ta.shift(),l=uy.from(i,e,t);await K_(n,(()=>n.remoteSyncer.applySuccessfulWrite(l))),await pm(n)}async function RI(n,e){e&&ho(n).Y_&&await(async function(i,l){if((function(d){return uA(d)&&d!==Se.ABORTED})(l.code)){const u=i.Ta.shift();ho(i).B_(),await K_(i,(()=>i.remoteSyncer.rejectFailedWrite(u.batchId,l))),await pm(i)}})(n,e),Y_(n)&&Q_(n)}async function Yx(n,e){const t=Qt(n);t.asyncQueue.verifyOperationInProgress(),dt(Yo,"RemoteStore received new credentials");const i=el(t);t.Ea.add(3),await Vu(t),i&&t.Va.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await fm(t)}async function AI(n,e){const t=Qt(n);e?(t.Ea.delete(2),await fm(t)):e||(t.Ea.add(2),await Vu(t),t.Va.set("Unknown"))}function lc(n){return n.ma||(n.ma=(function(t,i,l){const u=Qt(t);return u.sa(),new fI(i,u.connection,u.authCredentials,u.appCheckCredentials,u.serializer,l)})(n.datastore,n.asyncQueue,{Zo:wI.bind(null,n),Yo:_I.bind(null,n),t_:kI.bind(null,n),J_:jI.bind(null,n)}),n.Ra.push((async e=>{e?(n.ma.B_(),xy(n)?vy(n):n.Va.set("Unknown")):(await n.ma.stop(),G_(n))}))),n.ma}function ho(n){return n.fa||(n.fa=(function(t,i,l){const u=Qt(t);return u.sa(),new pI(i,u.connection,u.authCredentials,u.appCheckCredentials,u.serializer,l)})(n.datastore,n.asyncQueue,{Zo:()=>Promise.resolve(),Yo:NI.bind(null,n),t_:RI.bind(null,n),ta:SI.bind(null,n),na:CI.bind(null,n)}),n.Ra.push((async e=>{e?(n.fa.B_(),await pm(n)):(await n.fa.stop(),n.Ta.length>0&&(dt(Yo,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}class wy{constructor(e,t,i,l,u){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=l,this.removalCallback=u,this.deferred=new di,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((d=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,l,u){const d=Date.now()+i,p=new wy(e,t,d,l,u);return p.start(i),p}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new tt(Se.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function _y(n,e){if(gi("AsyncQueue",`${e}: ${n}`),ic(n))return new tt(Se.UNAVAILABLE,`${e}: ${n}`);throw n}class Gl{static emptySet(e){return new Gl(e.comparator)}constructor(e){this.comparator=e?(t,i)=>e(t,i)||Nt.comparator(t.key,i.key):(t,i)=>Nt.comparator(t.key,i.key),this.keyedMap=su(),this.sortedSet=new hn(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,i)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Gl)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;t.hasNext();){const l=t.getNext().key,u=i.getNext().key;if(!l.isEqual(u))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const i=new Gl;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=t,i}}class Qx{constructor(){this.ga=new hn(Nt.comparator)}track(e){const t=e.doc.key,i=this.ga.get(t);i?e.type!==0&&i.type===3?this.ga=this.ga.insert(t,e):e.type===3&&i.type!==1?this.ga=this.ga.insert(t,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.ga=this.ga.remove(t):e.type===1&&i.type===2?this.ga=this.ga.insert(t,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):Lt(63341,{Vt:e,pa:i}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,i)=>{e.push(i)})),e}}class Zl{constructor(e,t,i,l,u,d,p,g,y){this.query=e,this.docs=t,this.oldDocs=i,this.docChanges=l,this.mutatedKeys=u,this.fromCache=d,this.syncStateChanged=p,this.excludesMetadataChanges=g,this.hasCachedResults=y}static fromInitialDocuments(e,t,i,l,u){const d=[];return t.forEach((p=>{d.push({type:0,doc:p})})),new Zl(e,t,Gl.emptySet(t),d,i,l,!0,!1,u)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&om(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,i=e.docChanges;if(t.length!==i.length)return!1;for(let l=0;l<t.length;l++)if(t[l].type!==i[l].type||!t[l].doc.isEqual(i[l].doc))return!1;return!0}}class II{constructor(){this.wa=void 0,this.ba=[]}Sa(){return this.ba.some((e=>e.Da()))}}class MI{constructor(){this.queries=Xx(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,i){const l=Qt(t),u=l.queries;l.queries=Xx(),u.forEach(((d,p)=>{for(const g of p.ba)g.onError(i)}))})(this,new tt(Se.ABORTED,"Firestore shutting down"))}}function Xx(){return new Zo((n=>f_(n)),om)}async function ky(n,e){const t=Qt(n);let i=3;const l=e.query;let u=t.queries.get(l);u?!u.Sa()&&e.Da()&&(i=2):(u=new II,i=e.Da()?0:1);try{switch(i){case 0:u.wa=await t.onListen(l,!0);break;case 1:u.wa=await t.onListen(l,!1);break;case 2:await t.onFirstRemoteStoreListen(l)}}catch(d){const p=_y(d,`Initialization of query '${Bl(e.query)}' failed`);return void e.onError(p)}t.queries.set(l,u),u.ba.push(e),e.va(t.onlineState),u.wa&&e.Fa(u.wa)&&Ty(t)}async function jy(n,e){const t=Qt(n),i=e.query;let l=3;const u=t.queries.get(i);if(u){const d=u.ba.indexOf(e);d>=0&&(u.ba.splice(d,1),u.ba.length===0?l=e.Da()?0:1:!u.Sa()&&e.Da()&&(l=2))}switch(l){case 0:return t.queries.delete(i),t.onUnlisten(i,!0);case 1:return t.queries.delete(i),t.onUnlisten(i,!1);case 2:return t.onLastRemoteStoreUnlisten(i);default:return}}function DI(n,e){const t=Qt(n);let i=!1;for(const l of e){const u=l.query,d=t.queries.get(u);if(d){for(const p of d.ba)p.Fa(l)&&(i=!0);d.wa=l}}i&&Ty(t)}function PI(n,e,t){const i=Qt(n),l=i.queries.get(e);if(l)for(const u of l.ba)u.onError(t);i.queries.delete(e)}function Ty(n){n.Ca.forEach((e=>{e.next()}))}var Ng,Jx;(Jx=Ng||(Ng={})).Ma="default",Jx.Cache="cache";class Ey{constructor(e,t,i){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=i||{}}Fa(e){if(!this.options.includeMetadataChanges){const i=[];for(const l of e.docChanges)l.type!==3&&i.push(l);e=new Zl(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const i=t!=="Offline";return(!this.options.Ka||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=Zl.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Ng.Cache}}class X_{constructor(e){this.key=e}}class J_{constructor(e){this.key=e}}class LI{constructor(e,t){this.query=e,this.Za=t,this.Xa=null,this.hasCachedResults=!1,this.current=!1,this.Ya=bs(),this.mutatedKeys=bs(),this.eu=p_(e),this.tu=new Gl(this.eu)}get nu(){return this.Za}ru(e,t){const i=t?t.iu:new Qx,l=t?t.tu:this.tu;let u=t?t.mutatedKeys:this.mutatedKeys,d=l,p=!1;const g=this.query.limitType==="F"&&l.size===this.query.limit?l.last():null,y=this.query.limitType==="L"&&l.size===this.query.limit?l.first():null;if(e.inorderTraversal(((w,j)=>{const T=l.get(w),V=lm(this.query,j)?j:null,W=!!T&&this.mutatedKeys.has(T.key),F=!!V&&(V.hasLocalMutations||this.mutatedKeys.has(V.key)&&V.hasCommittedMutations);let U=!1;T&&V?T.data.isEqual(V.data)?W!==F&&(i.track({type:3,doc:V}),U=!0):this.su(T,V)||(i.track({type:2,doc:V}),U=!0,(g&&this.eu(V,g)>0||y&&this.eu(V,y)<0)&&(p=!0)):!T&&V?(i.track({type:0,doc:V}),U=!0):T&&!V&&(i.track({type:1,doc:T}),U=!0,(g||y)&&(p=!0)),U&&(V?(d=d.add(V),u=F?u.add(w):u.delete(w)):(d=d.delete(w),u=u.delete(w)))})),this.query.limit!==null)for(;d.size>this.query.limit;){const w=this.query.limitType==="F"?d.last():d.first();d=d.delete(w.key),u=u.delete(w.key),i.track({type:1,doc:w})}return{tu:d,iu:i,Ss:p,mutatedKeys:u}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,i,l){const u=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const d=e.iu.ya();d.sort(((w,j)=>(function(V,W){const F=U=>{switch(U){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Lt(20277,{Vt:U})}};return F(V)-F(W)})(w.type,j.type)||this.eu(w.doc,j.doc))),this.ou(i),l=l??!1;const p=t&&!l?this._u():[],g=this.Ya.size===0&&this.current&&!l?1:0,y=g!==this.Xa;return this.Xa=g,d.length!==0||y?{snapshot:new Zl(this.query,e.tu,u,d,e.mutatedKeys,g===0,y,!1,!!i&&i.resumeToken.approximateByteSize()>0),au:p}:{au:p}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Qx,mutatedKeys:this.mutatedKeys,Ss:!1},!1)):{au:[]}}uu(e){return!this.Za.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Za=this.Za.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Za=this.Za.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Ya;this.Ya=bs(),this.tu.forEach((i=>{this.uu(i.key)&&(this.Ya=this.Ya.add(i.key))}));const t=[];return e.forEach((i=>{this.Ya.has(i)||t.push(new J_(i))})),this.Ya.forEach((i=>{e.has(i)||t.push(new X_(i))})),t}cu(e){this.Za=e.ks,this.Ya=bs();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return Zl.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Xa===0,this.hasCachedResults)}}const Ny="SyncEngine";class OI{constructor(e,t,i){this.query=e,this.targetId=t,this.view=i}}class VI{constructor(e){this.key=e,this.hu=!1}}class BI{constructor(e,t,i,l,u,d){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=l,this.currentUser=u,this.maxConcurrentLimboResolutions=d,this.Pu={},this.Tu=new Zo((p=>f_(p)),om),this.Iu=new Map,this.Eu=new Set,this.Ru=new hn(Nt.comparator),this.Au=new Map,this.Vu=new my,this.du={},this.mu=new Map,this.fu=Jl.ar(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function UI(n,e,t=!0){const i=rk(n);let l;const u=i.Tu.get(e);return u?(i.sharedClientState.addLocalQueryTarget(u.targetId),l=u.view.lu()):l=await Z_(i,e,t,!0),l}async function FI(n,e){const t=rk(n);await Z_(t,e,!0,!1)}async function Z_(n,e,t,i){const l=await iI(n.localStore,Va(e)),u=l.targetId,d=n.sharedClientState.addLocalQueryTarget(u,t);let p;return i&&(p=await zI(n,e,u,d==="current",l.resumeToken)),n.isPrimaryClient&&t&&$_(n.remoteStore,l),p}async function zI(n,e,t,i,l){n.pu=(j,T,V)=>(async function(F,U,ne,Y){let oe=U.view.ru(ne);oe.Ss&&(oe=await Hx(F.localStore,U.query,!1).then((({documents:R})=>U.view.ru(R,oe))));const be=Y&&Y.targetChanges.get(U.targetId),Le=Y&&Y.targetMismatches.get(U.targetId)!=null,Ce=U.view.applyChanges(oe,F.isPrimaryClient,be,Le);return e2(F,U.targetId,Ce.au),Ce.snapshot})(n,j,T,V);const u=await Hx(n.localStore,e,!0),d=new LI(e,u.ks),p=d.ru(u.documents),g=Ou.createSynthesizedTargetChangeForCurrentChange(t,i&&n.onlineState!=="Offline",l),y=d.applyChanges(p,n.isPrimaryClient,g);e2(n,t,y.au);const w=new OI(e,t,d);return n.Tu.set(e,w),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),y.snapshot}async function qI(n,e,t){const i=Qt(n),l=i.Tu.get(e),u=i.Iu.get(l.targetId);if(u.length>1)return i.Iu.set(l.targetId,u.filter((d=>!om(d,e)))),void i.Tu.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(l.targetId),i.sharedClientState.isActiveQueryTarget(l.targetId)||await Tg(i.localStore,l.targetId,!1).then((()=>{i.sharedClientState.clearQueryState(l.targetId),t&&yy(i.remoteStore,l.targetId),Sg(i,l.targetId)})).catch(ac)):(Sg(i,l.targetId),await Tg(i.localStore,l.targetId,!0))}async function HI(n,e){const t=Qt(n),i=t.Tu.get(e),l=t.Iu.get(i.targetId);t.isPrimaryClient&&l.length===1&&(t.sharedClientState.removeLocalQueryTarget(i.targetId),yy(t.remoteStore,i.targetId))}async function $I(n,e,t){const i=JI(n);try{const l=await(function(d,p){const g=Qt(d),y=xt.now(),w=p.reduce(((V,W)=>V.add(W.key)),bs());let j,T;return g.persistence.runTransaction("Locally write mutations","readwrite",(V=>{let W=yi(),F=bs();return g.xs.getEntries(V,w).next((U=>{W=U,W.forEach(((ne,Y)=>{Y.isValidDocument()||(F=F.add(ne))}))})).next((()=>g.localDocuments.getOverlayedDocuments(V,W))).next((U=>{j=U;const ne=[];for(const Y of p){const oe=aA(Y,j.get(Y.key).overlayedDocument);oe!=null&&ne.push(new yo(Y.key,oe,i_(oe.value.mapValue),xr.exists(!0)))}return g.mutationQueue.addMutationBatch(V,y,ne,p)})).next((U=>{T=U;const ne=U.applyToLocalDocumentSet(j,F);return g.documentOverlayCache.saveOverlays(V,U.batchId,ne)}))})).then((()=>({batchId:T.batchId,changes:y_(j)})))})(i.localStore,e);i.sharedClientState.addPendingMutation(l.batchId),(function(d,p,g){let y=d.du[d.currentUser.toKey()];y||(y=new hn(ys)),y=y.insert(p,g),d.du[d.currentUser.toKey()]=y})(i,l.batchId,t),await Bu(i,l.changes),await pm(i.remoteStore)}catch(l){const u=_y(l,"Failed to persist write");t.reject(u)}}async function ek(n,e){const t=Qt(n);try{const i=await nI(t.localStore,e);e.targetChanges.forEach(((l,u)=>{const d=t.Au.get(u);d&&(Us(l.addedDocuments.size+l.modifiedDocuments.size+l.removedDocuments.size<=1,22616),l.addedDocuments.size>0?d.hu=!0:l.modifiedDocuments.size>0?Us(d.hu,14607):l.removedDocuments.size>0&&(Us(d.hu,42227),d.hu=!1))})),await Bu(t,i,e)}catch(i){await ac(i)}}function Zx(n,e,t){const i=Qt(n);if(i.isPrimaryClient&&t===0||!i.isPrimaryClient&&t===1){const l=[];i.Tu.forEach(((u,d)=>{const p=d.view.va(e);p.snapshot&&l.push(p.snapshot)})),(function(d,p){const g=Qt(d);g.onlineState=p;let y=!1;g.queries.forEach(((w,j)=>{for(const T of j.ba)T.va(p)&&(y=!0)})),y&&Ty(g)})(i.eventManager,e),l.length&&i.Pu.J_(l),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function WI(n,e,t){const i=Qt(n);i.sharedClientState.updateQueryState(e,"rejected",t);const l=i.Au.get(e),u=l&&l.key;if(u){let d=new hn(Nt.comparator);d=d.insert(u,lr.newNoDocument(u,$t.min()));const p=bs().add(u),g=new hm($t.min(),new Map,new hn(ys),d,p);await ek(i,g),i.Ru=i.Ru.remove(u),i.Au.delete(e),Sy(i)}else await Tg(i.localStore,e,!1).then((()=>Sg(i,e,t))).catch(ac)}async function GI(n,e){const t=Qt(n),i=e.batch.batchId;try{const l=await sI(t.localStore,e);sk(t,i,null),tk(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),await Bu(t,l)}catch(l){await ac(l)}}async function KI(n,e,t){const i=Qt(n);try{const l=await(function(d,p){const g=Qt(d);return g.persistence.runTransaction("Reject batch","readwrite-primary",(y=>{let w;return g.mutationQueue.lookupMutationBatch(y,p).next((j=>(Us(j!==null,37113),w=j.keys(),g.mutationQueue.removeMutationBatch(y,j)))).next((()=>g.mutationQueue.performConsistencyCheck(y))).next((()=>g.documentOverlayCache.removeOverlaysForBatchId(y,w,p))).next((()=>g.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(y,w))).next((()=>g.localDocuments.getDocuments(y,w)))}))})(i.localStore,e);sk(i,e,t),tk(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),await Bu(i,l)}catch(l){await ac(l)}}function tk(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function sk(n,e,t){const i=Qt(n);let l=i.du[i.currentUser.toKey()];if(l){const u=l.get(e);u&&(t?u.reject(t):u.resolve(),l=l.remove(e)),i.du[i.currentUser.toKey()]=l}}function Sg(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const i of n.Iu.get(e))n.Tu.delete(i),t&&n.Pu.yu(i,t);n.Iu.delete(e),n.isPrimaryClient&&n.Vu.Gr(e).forEach((i=>{n.Vu.containsKey(i)||nk(n,i)}))}function nk(n,e){n.Eu.delete(e.path.canonicalString());const t=n.Ru.get(e);t!==null&&(yy(n.remoteStore,t),n.Ru=n.Ru.remove(e),n.Au.delete(t),Sy(n))}function e2(n,e,t){for(const i of t)i instanceof X_?(n.Vu.addReference(i.key,e),YI(n,i)):i instanceof J_?(dt(Ny,"Document no longer in limbo: "+i.key),n.Vu.removeReference(i.key,e),n.Vu.containsKey(i.key)||nk(n,i.key)):Lt(19791,{wu:i})}function YI(n,e){const t=e.key,i=t.path.canonicalString();n.Ru.get(t)||n.Eu.has(i)||(dt(Ny,"New document in limbo: "+t),n.Eu.add(i),Sy(n))}function Sy(n){for(;n.Eu.size>0&&n.Ru.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new Nt(en.fromString(e)),i=n.fu.next();n.Au.set(i,new VI(t)),n.Ru=n.Ru.insert(t,i),$_(n.remoteStore,new Zi(Va(im(t.path)),i,"TargetPurposeLimboResolution",nm.ce))}}async function Bu(n,e,t){const i=Qt(n),l=[],u=[],d=[];i.Tu.isEmpty()||(i.Tu.forEach(((p,g)=>{d.push(i.pu(g,e,t).then((y=>{if((y||t)&&i.isPrimaryClient){const w=y?!y.fromCache:t?.targetChanges.get(g.targetId)?.current;i.sharedClientState.updateQueryState(g.targetId,w?"current":"not-current")}if(y){l.push(y);const w=py.Es(g.targetId,y);u.push(w)}})))})),await Promise.all(d),i.Pu.J_(l),await(async function(g,y){const w=Qt(g);try{await w.persistence.runTransaction("notifyLocalViewChanges","readwrite",(j=>Pe.forEach(y,(T=>Pe.forEach(T.Ts,(V=>w.persistence.referenceDelegate.addReference(j,T.targetId,V))).next((()=>Pe.forEach(T.Is,(V=>w.persistence.referenceDelegate.removeReference(j,T.targetId,V)))))))))}catch(j){if(!ic(j))throw j;dt(gy,"Failed to update sequence numbers: "+j)}for(const j of y){const T=j.targetId;if(!j.fromCache){const V=w.vs.get(T),W=V.snapshotVersion,F=V.withLastLimboFreeSnapshotVersion(W);w.vs=w.vs.insert(T,F)}}})(i.localStore,u))}async function QI(n,e){const t=Qt(n);if(!t.currentUser.isEqual(e)){dt(Ny,"User change. New user:",e.toKey());const i=await F_(t.localStore,e);t.currentUser=e,(function(u,d){u.mu.forEach((p=>{p.forEach((g=>{g.reject(new tt(Se.CANCELLED,d))}))})),u.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await Bu(t,i.Ns)}}function XI(n,e){const t=Qt(n),i=t.Au.get(e);if(i&&i.hu)return bs().add(i.key);{let l=bs();const u=t.Iu.get(e);if(!u)return l;for(const d of u){const p=t.Tu.get(d);l=l.unionWith(p.view.nu)}return l}}function rk(n){const e=Qt(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=ek.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=XI.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=WI.bind(null,e),e.Pu.J_=DI.bind(null,e.eventManager),e.Pu.yu=PI.bind(null,e.eventManager),e}function JI(n){const e=Qt(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=GI.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=KI.bind(null,e),e}class Hh{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=mm(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return tI(this.persistence,new JA,e.initialUser,this.serializer)}Cu(e){return new U_(fy.Vi,this.serializer)}Du(e){return new lI}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Hh.provider={build:()=>new Hh};class ZI extends Hh{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){Us(this.persistence.referenceDelegate instanceof zh,46915);const i=this.persistence.referenceDelegate.garbageCollector;return new OA(i,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?Ar.withCacheSize(this.cacheSizeBytes):Ar.DEFAULT;return new U_((i=>zh.Vi(i,t)),this.serializer)}}class Cg{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>Zx(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=QI.bind(null,this.syncEngine),await AI(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new MI})()}createDatastore(e){const t=mm(e.databaseInfo.databaseId),i=mI(e.databaseInfo);return bI(e.authCredentials,e.appCheckCredentials,i,t)}createRemoteStore(e){return(function(i,l,u,d,p){return new xI(i,l,u,d,p)})(this.localStore,this.datastore,e.asyncQueue,(t=>Zx(this.syncEngine,t,0)),(function(){return Gx.v()?new Gx:new cI})())}createSyncEngine(e,t){return(function(l,u,d,p,g,y,w){const j=new BI(l,u,d,p,g,y);return w&&(j.gu=!0),j})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const i=Qt(t);dt(Yo,"RemoteStore shutting down."),i.Ea.add(5),await Vu(i),i.Aa.shutdown(),i.Va.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}Cg.provider={build:()=>new Cg};class Cy{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):gi("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}const mo="FirestoreClient";class eM{constructor(e,t,i,l,u){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this._databaseInfo=l,this.user=or.UNAUTHENTICATED,this.clientId=ny.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=u,this.authCredentials.start(i,(async d=>{dt(mo,"Received user=",d.uid),await this.authCredentialListener(d),this.user=d})),this.appCheckCredentials.start(i,(d=>(dt(mo,"Received new app check token=",d),this.appCheckCredentialListener(d,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this._databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new di;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const i=_y(t,"Failed to shutdown persistence");e.reject(i)}})),e.promise}}async function Lp(n,e){n.asyncQueue.verifyOperationInProgress(),dt(mo,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let i=t.initialUser;n.setCredentialChangeListener((async l=>{i.isEqual(l)||(await F_(e.localStore,l),i=l)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function t2(n,e){n.asyncQueue.verifyOperationInProgress();const t=await tM(n);dt(mo,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((i=>Yx(e.remoteStore,i))),n.setAppCheckTokenChangeListener(((i,l)=>Yx(e.remoteStore,l))),n._onlineComponents=e}async function tM(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){dt(mo,"Using user provided OfflineComponentProvider");try{await Lp(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(l){return l.name==="FirebaseError"?l.code===Se.FAILED_PRECONDITION||l.code===Se.UNIMPLEMENTED:!(typeof DOMException<"u"&&l instanceof DOMException)||l.code===22||l.code===20||l.code===11})(t))throw t;Kl("Error using user provided cache. Falling back to memory cache: "+t),await Lp(n,new Hh)}}else dt(mo,"Using default OfflineComponentProvider"),await Lp(n,new ZI(void 0));return n._offlineComponents}async function ak(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(dt(mo,"Using user provided OnlineComponentProvider"),await t2(n,n._uninitializedComponentsProvider._online)):(dt(mo,"Using default OnlineComponentProvider"),await t2(n,new Cg))),n._onlineComponents}function sM(n){return ak(n).then((e=>e.syncEngine))}async function $h(n){const e=await ak(n),t=e.eventManager;return t.onListen=UI.bind(null,e.syncEngine),t.onUnlisten=qI.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=FI.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=HI.bind(null,e.syncEngine),t}function nM(n,e,t,i){const l=new Cy(i),u=new Ey(e,l,t);return n.asyncQueue.enqueueAndForget((async()=>ky(await $h(n),u))),()=>{l.Nu(),n.asyncQueue.enqueueAndForget((async()=>jy(await $h(n),u)))}}function rM(n,e,t={}){const i=new di;return n.asyncQueue.enqueueAndForget((async()=>(function(u,d,p,g,y){const w=new Cy({next:T=>{w.Nu(),d.enqueueAndForget((()=>jy(u,j)));const V=T.docs.has(p);!V&&T.fromCache?y.reject(new tt(Se.UNAVAILABLE,"Failed to get document because the client is offline.")):V&&T.fromCache&&g&&g.source==="server"?y.reject(new tt(Se.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):y.resolve(T)},error:T=>y.reject(T)}),j=new Ey(im(p.path),w,{includeMetadataChanges:!0,Ka:!0});return ky(u,j)})(await $h(n),n.asyncQueue,e,t,i))),i.promise}function aM(n,e,t={}){const i=new di;return n.asyncQueue.enqueueAndForget((async()=>(function(u,d,p,g,y){const w=new Cy({next:T=>{w.Nu(),d.enqueueAndForget((()=>jy(u,j))),T.fromCache&&g.source==="server"?y.reject(new tt(Se.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):y.resolve(T)},error:T=>y.reject(T)}),j=new Ey(p,w,{includeMetadataChanges:!0,Ka:!0});return ky(u,j)})(await $h(n),n.asyncQueue,e,t,i))),i.promise}function iM(n,e){const t=new di;return n.asyncQueue.enqueueAndForget((async()=>$I(await sM(n),e,t))),t.promise}function ik(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}const oM="ComponentProvider",s2=new Map;function lM(n,e,t,i,l){return new SR(n,e,t,l.host,l.ssl,l.experimentalForceLongPolling,l.experimentalAutoDetectLongPolling,ik(l.experimentalLongPollingOptions),l.useFetchStreams,l.isUsingEmulator,i)}const ok="firestore.googleapis.com",n2=!0;class r2{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new tt(Se.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=ok,this.ssl=n2}else this.host=e.host,this.ssl=e.ssl??n2;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=B_;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<PA)throw new tt(Se.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}gR("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=ik(e.experimentalLongPollingOptions??{}),(function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new tt(Se.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new tt(Se.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new tt(Se.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(i,l){return i.timeoutSeconds===l.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class gm{constructor(e,t,i,l){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=l,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new r2({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new tt(Se.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new tt(Se.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new r2(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(i){if(!i)return new iR;switch(i.type){case"firstParty":return new uR(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new tt(Se.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const i=s2.get(t);i&&(dt(oM,"Removing Datastore"),s2.delete(t),i.terminate())})(this),Promise.resolve()}}function cM(n,e,t,i={}){n=vr(n,gm);const l=fo(e),u=n._getSettings(),d={...u,emulatorOptions:n._getEmulatorOptions()},p=`${e}:${t}`;l&&(Fg(`https://${p}`),zg("Firestore",!0)),u.host!==ok&&u.host!==p&&Kl("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const g={...u,host:p,ssl:l,emulatorOptions:i};if(!Ho(g,d)&&(n._setSettings(g),i.mockUserToken)){let y,w;if(typeof i.mockUserToken=="string")y=i.mockUserToken,w=or.MOCK_USER;else{y=tw(i.mockUserToken,n._app?.options.projectId);const j=i.mockUserToken.sub||i.mockUserToken.user_id;if(!j)throw new tt(Se.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");w=new or(j)}n._authCredentials=new oR(new Kw(y,w))}}class xi{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new xi(this.firestore,e,this._query)}}class vn{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new ao(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new vn(this.firestore,e,this._key)}toJSON(){return{type:vn._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,i){if(Pu(t,vn._jsonSchema))return new vn(e,i||null,new Nt(en.fromString(t.referencePath)))}}vn._jsonSchemaVersion="firestore/documentReference/1.0",vn._jsonSchema={type:Pn("string",vn._jsonSchemaVersion),referencePath:Pn("string")};class ao extends xi{constructor(e,t,i){super(e,t,im(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new vn(this.firestore,null,new Nt(e))}withConverter(e){return new ao(this.firestore,e,this._path)}}function zt(n,e,...t){if(n=Gs(n),Yw("collection","path",e),n instanceof gm){const i=en.fromString(e,...t);return yx(i),new ao(n,null,i)}{if(!(n instanceof vn||n instanceof ao))throw new tt(Se.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(en.fromString(e,...t));return yx(i),new ao(n.firestore,null,i)}}function He(n,e,...t){if(n=Gs(n),arguments.length===1&&(e=ny.newId()),Yw("doc","path",e),n instanceof gm){const i=en.fromString(e,...t);return gx(i),new vn(n,null,new Nt(i))}{if(!(n instanceof vn||n instanceof ao))throw new tt(Se.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(en.fromString(e,...t));return gx(i),new vn(n.firestore,n instanceof ao?n.converter:null,new Nt(i))}}const a2="AsyncQueue";class i2{constructor(e=Promise.resolve()){this.Yu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new q_(this,"async_queue_retry"),this._c=()=>{const i=Pp();i&&dt(a2,"Visibility state changed to "+i.visibilityState),this.M_.w_()},this.ac=e;const t=Pp();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=Pp();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new di;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Yu.push(e),this.lc())))}async lc(){if(this.Yu.length!==0){try{await this.Yu[0](),this.Yu.shift(),this.M_.reset()}catch(e){if(!ic(e))throw e;dt(a2,"Operation failed with retryable error: "+e)}this.Yu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((i=>{throw this.nc=i,this.rc=!1,gi("INTERNAL UNHANDLED ERROR: ",o2(i)),i})).then((i=>(this.rc=!1,i))))));return this.ac=t,t}enqueueAfterDelay(e,t,i){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const l=wy.createAndSchedule(this,e,t,i,(u=>this.hc(u)));return this.tc.push(l),l}uc(){this.nc&&Lt(47125,{Pc:o2(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,i)=>t.targetTimeMs-i.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}Rc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function o2(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}class za extends gm{constructor(e,t,i,l){super(e,t,i,l),this.type="firestore",this._queue=new i2,this._persistenceKey=l?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new i2(e),this._firestoreClient=void 0,await e}}}function uM(n,e){const t=typeof n=="object"?n:Wg(),i=typeof n=="string"?n:Oh,l=Jh(t,"firestore").getImmediate({identifier:i});if(!l._initialized){const u=J2("firestore");u&&cM(l,...u)}return l}function Uu(n){if(n._terminated)throw new tt(Se.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||dM(n),n._firestoreClient}function dM(n){const e=n._freezeSettings(),t=lM(n._databaseId,n._app?.options.appId||"",n._persistenceKey,n._app?.options.apiKey,e);n._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new eM(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(l){const u=l?._online.build();return{_offline:l?._offline.build(u),_online:u}})(n._componentsProvider))}class na{constructor(e){this._byteString=e}static fromBase64String(e){try{return new na(tr.fromBase64String(e))}catch(t){throw new tt(Se.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new na(tr.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:na._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Pu(e,na._jsonSchema))return na.fromBase64String(e.bytes)}}na._jsonSchemaVersion="firestore/bytes/1.0",na._jsonSchema={type:Pn("string",na._jsonSchemaVersion),bytes:Pn("string")};class ym{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new tt(Se.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new er(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Fu{constructor(e){this._methodName=e}}class Ua{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new tt(Se.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new tt(Se.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return ys(this._lat,e._lat)||ys(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Ua._jsonSchemaVersion}}static fromJSON(e){if(Pu(e,Ua._jsonSchema))return new Ua(e.latitude,e.longitude)}}Ua._jsonSchemaVersion="firestore/geoPoint/1.0",Ua._jsonSchema={type:Pn("string",Ua._jsonSchemaVersion),latitude:Pn("number"),longitude:Pn("number")};class ya{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(i,l){if(i.length!==l.length)return!1;for(let u=0;u<i.length;++u)if(i[u]!==l[u])return!1;return!0})(this._values,e._values)}toJSON(){return{type:ya._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Pu(e,ya._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new ya(e.vectorValues);throw new tt(Se.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}ya._jsonSchemaVersion="firestore/vectorValue/1.0",ya._jsonSchema={type:Pn("string",ya._jsonSchemaVersion),vectorValues:Pn("object")};const hM=/^__.*__$/;class mM{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return this.fieldMask!==null?new yo(e,this.data,this.fieldMask,t,this.fieldTransforms):new Lu(e,this.data,t,this.fieldTransforms)}}class lk{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return new yo(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function ck(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Lt(40011,{dataSource:n})}}class Ry{constructor(e,t,i,l,u,d){this.settings=e,this.databaseId=t,this.serializer=i,this.ignoreUndefinedProperties=l,u===void 0&&this.validatePath(),this.fieldTransforms=u||[],this.fieldMask=d||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(e){return new Ry({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(e){const t=this.path?.child(e),i=this.contextWith({path:t,arrayElement:!1});return i.validatePathSegment(e),i}childContextForFieldPath(e){const t=this.path?.child(e),i=this.contextWith({path:t,arrayElement:!1});return i.validatePath(),i}childContextForArray(e){return this.contextWith({path:void 0,arrayElement:!0})}createError(e){return Wh(e,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}validatePath(){if(this.path)for(let e=0;e<this.path.length;e++)this.validatePathSegment(this.path.get(e))}validatePathSegment(e){if(e.length===0)throw this.createError("Document fields must not be empty");if(ck(this.dataSource)&&hM.test(e))throw this.createError('Document fields cannot begin and end with "__"')}}class fM{constructor(e,t,i){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=i||mm(e)}createContext(e,t,i,l=!1){return new Ry({dataSource:e,methodName:t,targetDoc:i,path:er.emptyPath(),arrayElement:!1,hasConverter:l},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function zu(n){const e=n._freezeSettings(),t=mm(n._databaseId);return new fM(n._databaseId,!!e.ignoreUndefinedProperties,t)}function Ay(n,e,t,i,l,u={}){const d=n.createContext(u.merge||u.mergeFields?2:0,e,t,l);Dy("Data must be an object, but it was:",d,i);const p=hk(i,d);let g,y;if(u.merge)g=new $r(d.fieldMask),y=d.fieldTransforms;else if(u.mergeFields){const w=[];for(const j of u.mergeFields){const T=Qo(e,j,t);if(!d.contains(T))throw new tt(Se.INVALID_ARGUMENT,`Field '${T}' is specified in your field mask but missing from your input data.`);pk(w,T)||w.push(T)}g=new $r(w),y=d.fieldTransforms.filter((j=>g.covers(j.field)))}else g=null,y=d.fieldTransforms;return new mM(new Ir(p),g,y)}class bm extends Fu{_toFieldTransform(e){if(e.dataSource!==2)throw e.dataSource===1?e.createError(`${this._methodName}() can only appear at the top level of your update data`):e.createError(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof bm}}class Iy extends Fu{_toFieldTransform(e){return new T_(e.path,new ku)}isEqual(e){return e instanceof Iy}}class My extends Fu{constructor(e,t){super(e),this.Vc=t}_toFieldTransform(e){const t=new Eu(e.serializer,x_(e.serializer,this.Vc));return new T_(e.path,t)}isEqual(e){return e instanceof My&&this.Vc===e.Vc}}function uk(n,e,t,i){const l=n.createContext(1,e,t);Dy("Data must be an object, but it was:",l,i);const u=[],d=Ir.empty();go(i,((g,y)=>{const w=fk(e,g,t);y=Gs(y);const j=l.childContextForFieldPath(w);if(y instanceof bm)u.push(w);else{const T=qu(y,j);T!=null&&(u.push(w),d.set(w,T))}}));const p=new $r(u);return new lk(d,p,l.fieldTransforms)}function dk(n,e,t,i,l,u){const d=n.createContext(1,e,t),p=[Qo(e,i,t)],g=[l];if(u.length%2!=0)throw new tt(Se.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let T=0;T<u.length;T+=2)p.push(Qo(e,u[T])),g.push(u[T+1]);const y=[],w=Ir.empty();for(let T=p.length-1;T>=0;--T)if(!pk(y,p[T])){const V=p[T];let W=g[T];W=Gs(W);const F=d.childContextForFieldPath(V);if(W instanceof bm)y.push(V);else{const U=qu(W,F);U!=null&&(y.push(V),w.set(V,U))}}const j=new $r(y);return new lk(w,j,d.fieldTransforms)}function pM(n,e,t,i=!1){return qu(t,n.createContext(i?4:3,e))}function qu(n,e){if(mk(n=Gs(n)))return Dy("Unsupported field value:",e,n),hk(n,e);if(n instanceof Fu)return(function(i,l){if(!ck(l.dataSource))throw l.createError(`${i._methodName}() can only be used with update() and set()`);if(!l.path)throw l.createError(`${i._methodName}() is not currently supported inside arrays`);const u=i._toFieldTransform(l);u&&l.fieldTransforms.push(u)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.arrayElement&&e.dataSource!==4)throw e.createError("Nested arrays are not supported");return(function(i,l){const u=[];let d=0;for(const p of i){let g=qu(p,l.childContextForArray(d));g==null&&(g={nullValue:"NULL_VALUE"}),u.push(g),d++}return{arrayValue:{values:u}}})(n,e)}return(function(i,l){if((i=Gs(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return x_(l.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const u=xt.fromDate(i);return{timestampValue:Fh(l.serializer,u)}}if(i instanceof xt){const u=new xt(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:Fh(l.serializer,u)}}if(i instanceof Ua)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof na)return{bytesValue:A_(l.serializer,i._byteString)};if(i instanceof vn){const u=l.databaseId,d=i.firestore._databaseId;if(!d.isEqual(u))throw l.createError(`Document reference is for database ${d.projectId}/${d.database} but should be for database ${u.projectId}/${u.database}`);return{referenceValue:hy(i.firestore._databaseId||l.databaseId,i._key.path)}}if(i instanceof ya)return(function(d,p){const g=d instanceof ya?d.toArray():d;return{mapValue:{fields:{[r_]:{stringValue:a_},[Vh]:{arrayValue:{values:g.map((w=>{if(typeof w!="number")throw p.createError("VectorValues must only contain numeric values.");return cy(p.serializer,w)}))}}}}}})(i,l);if(V_(i))return i._toProto(l.serializer);throw l.createError(`Unsupported field value: ${sm(i)}`)})(n,e)}function hk(n,e){const t={};return Jw(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):go(n,((i,l)=>{const u=qu(l,e.childContextForField(i));u!=null&&(t[i]=u)})),{mapValue:{fields:t}}}function mk(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof xt||n instanceof Ua||n instanceof na||n instanceof vn||n instanceof Fu||n instanceof ya||V_(n))}function Dy(n,e,t){if(!mk(t)||!Qw(t)){const i=sm(t);throw i==="an object"?e.createError(n+" a custom object"):e.createError(n+" "+i)}}function Qo(n,e,t){if((e=Gs(e))instanceof ym)return e._internalPath;if(typeof e=="string")return fk(n,e);throw Wh("Field path arguments must be of type string or ",n,!1,void 0,t)}const gM=new RegExp("[~\\*/\\[\\]]");function fk(n,e,t){if(e.search(gM)>=0)throw Wh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new ym(...e.split("."))._internalPath}catch{throw Wh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Wh(n,e,t,i,l){const u=i&&!i.isEmpty(),d=l!==void 0;let p=`Function ${e}() called with invalid data`;t&&(p+=" (via `toFirestore()`)"),p+=". ";let g="";return(u||d)&&(g+=" (found",u&&(g+=` in field ${i}`),d&&(g+=` in document ${l}`),g+=")"),new tt(Se.INVALID_ARGUMENT,p+n+g)}function pk(n,e){return n.some((t=>t.isEqual(e)))}class yM{convertValue(e,t="none"){switch(uo(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Nn(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(co(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Lt(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const i={};return go(e,((l,u)=>{i[l]=this.convertValue(u,t)})),i}convertVectorValue(e){const t=e.fields?.[Vh].arrayValue?.values?.map((i=>Nn(i.doubleValue)));return new ya(t)}convertGeoPoint(e){return new Ua(Nn(e.latitude),Nn(e.longitude))}convertArray(e,t){return(e.values||[]).map((i=>this.convertValue(i,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const i=am(e);return i==null?null:this.convertValue(i,t);case"estimate":return this.convertTimestamp(vu(e));default:return null}}convertTimestamp(e){const t=lo(e);return new xt(t.seconds,t.nanos)}convertDocumentKey(e,t){const i=en.fromString(e);Us(O_(i),9688,{name:e});const l=new xu(i.get(1),i.get(3)),u=new Nt(i.popFirst(5));return l.isEqual(t)||gi(`Document ${u} contains a document reference within a different database (${l.projectId}/${l.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),u}}class Py extends yM{constructor(e){super(),this.firestore=e}convertBytes(e){return new na(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new vn(this.firestore,null,t)}}function Hr(){return new Iy("serverTimestamp")}function Bo(n){return new My("increment",n)}const l2="@firebase/firestore",c2="4.10.0";function u2(n){return(function(t,i){if(typeof t!="object"||t===null)return!1;const l=t;for(const u of i)if(u in l&&typeof l[u]=="function")return!0;return!1})(n,["next","error","complete"])}class gk{constructor(e,t,i,l,u){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=l,this._converter=u}get id(){return this._key.path.lastSegment()}get ref(){return new vn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new bM(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}_fieldsProto(){return this._document?.data.clone().value.mapValue.fields??void 0}get(e){if(this._document){const t=this._document.data.field(Qo("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class bM extends gk{data(){return super.data()}}function yk(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new tt(Se.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Ly{}class Oy extends Ly{}function Ds(n,e,...t){let i=[];e instanceof Ly&&i.push(e),i=i.concat(t),(function(u){const d=u.filter((g=>g instanceof Vy)).length,p=u.filter((g=>g instanceof vm)).length;if(d>1||d>0&&p>0)throw new tt(Se.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(i);for(const l of i)n=l._apply(n);return n}class vm extends Oy{constructor(e,t,i){super(),this._field=e,this._op=t,this._value=i,this.type="where"}static _create(e,t,i){return new vm(e,t,i)}_apply(e){const t=this._parse(e);return bk(e._query,t),new xi(e.firestore,e.converter,xg(e._query,t))}_parse(e){const t=zu(e.firestore);return(function(u,d,p,g,y,w,j){let T;if(y.isKeyField()){if(w==="array-contains"||w==="array-contains-any")throw new tt(Se.INVALID_ARGUMENT,`Invalid Query. You can't perform '${w}' queries on documentId().`);if(w==="in"||w==="not-in"){h2(j,w);const W=[];for(const F of j)W.push(d2(g,u,F));T={arrayValue:{values:W}}}else T=d2(g,u,j)}else w!=="in"&&w!=="not-in"&&w!=="array-contains-any"||h2(j,w),T=pM(p,d,j,w==="in"||w==="not-in");return Dn.create(y,w,T)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function hs(n,e,t){const i=e,l=Qo("where",n);return vm._create(l,i,t)}class Vy extends Ly{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Vy(e,t)}_parse(e){const t=this._queryConstraints.map((i=>i._parse(e))).filter((i=>i.getFilters().length>0));return t.length===1?t[0]:va.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(l,u){let d=l;const p=u.getFlattenedFilters();for(const g of p)bk(d,g),d=xg(d,g)})(e._query,t),new xi(e.firestore,e.converter,xg(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class By extends Oy{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new By(e,t)}_apply(e){const t=(function(l,u,d){if(l.startAt!==null)throw new tt(Se.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(l.endAt!==null)throw new tt(Se.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new _u(u,d)})(e._query,this._field,this._direction);return new xi(e.firestore,e.converter,WR(e._query,t))}}function Gh(n,e="asc"){const t=e,i=Qo("orderBy",n);return By._create(i,t)}class Uy extends Oy{constructor(e,t,i){super(),this.type=e,this._limit=t,this._limitType=i}static _create(e,t,i){return new Uy(e,t,i)}_apply(e){return new xi(e.firestore,e.converter,Uh(e._query,this._limit,this._limitType))}}function Kh(n){return yR("limit",n),Uy._create("limit",n,"F")}function d2(n,e,t){if(typeof(t=Gs(t))=="string"){if(t==="")throw new tt(Se.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!m_(e)&&t.indexOf("/")!==-1)throw new tt(Se.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const i=e.path.child(en.fromString(t));if(!Nt.isDocumentKey(i))throw new tt(Se.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return Tx(n,new Nt(i))}if(t instanceof vn)return Tx(n,t._key);throw new tt(Se.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${sm(t)}.`)}function h2(n,e){if(!Array.isArray(n)||n.length===0)throw new tt(Se.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function bk(n,e){const t=(function(l,u){for(const d of l)for(const p of d.getFlattenedFilters())if(u.indexOf(p.op)>=0)return p.op;return null})(n.filters,(function(l){switch(l){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new tt(Se.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new tt(Se.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}function Fy(n,e,t){let i;return i=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,i}class ru{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Uo extends gk{constructor(e,t,i,l,u,d){super(e,t,i,l,d),this._firestore=e,this._firestoreImpl=e,this.metadata=u}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Th(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const i=this._document.data.field(Qo("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new tt(Se.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=Uo._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}Uo._jsonSchemaVersion="firestore/documentSnapshot/1.0",Uo._jsonSchema={type:Pn("string",Uo._jsonSchemaVersion),bundleSource:Pn("string","DocumentSnapshot"),bundleName:Pn("string"),bundle:Pn("string")};class Th extends Uo{data(e={}){return super.data(e)}}class Fo{constructor(e,t,i,l){this._firestore=e,this._userDataWriter=t,this._snapshot=l,this.metadata=new ru(l.hasPendingWrites,l.fromCache),this.query=i}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((i=>{e.call(t,new Th(this._firestore,this._userDataWriter,i.key,i,new ru(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new tt(Se.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(l,u){if(l._snapshot.oldDocs.isEmpty()){let d=0;return l._snapshot.docChanges.map((p=>{const g=new Th(l._firestore,l._userDataWriter,p.doc.key,p.doc,new ru(l._snapshot.mutatedKeys.has(p.doc.key),l._snapshot.fromCache),l.query.converter);return p.doc,{type:"added",doc:g,oldIndex:-1,newIndex:d++}}))}{let d=l._snapshot.oldDocs;return l._snapshot.docChanges.filter((p=>u||p.type!==3)).map((p=>{const g=new Th(l._firestore,l._userDataWriter,p.doc.key,p.doc,new ru(l._snapshot.mutatedKeys.has(p.doc.key),l._snapshot.fromCache),l.query.converter);let y=-1,w=-1;return p.type!==0&&(y=d.indexOf(p.doc.key),d=d.delete(p.doc.key)),p.type!==1&&(d=d.add(p.doc),w=d.indexOf(p.doc.key)),{type:vM(p.type),doc:g,oldIndex:y,newIndex:w}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new tt(Se.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Fo._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=ny.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],i=[],l=[];return this.docs.forEach((u=>{u._document!==null&&(t.push(u._document),i.push(this._userDataWriter.convertObjectMap(u._document.data.value.mapValue.fields,"previous")),l.push(u.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function vM(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Lt(61501,{type:n})}}Fo._jsonSchemaVersion="firestore/querySnapshot/1.0",Fo._jsonSchema={type:Pn("string",Fo._jsonSchemaVersion),bundleSource:Pn("string","QuerySnapshot"),bundleName:Pn("string"),bundle:Pn("string")};class xM{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=zu(e)}set(e,t,i){this._verifyNotCommitted();const l=Op(e,this._firestore),u=Fy(l.converter,t,i),d=Ay(this._dataReader,"WriteBatch.set",l._key,u,l.converter!==null,i);return this._mutations.push(d.toMutation(l._key,xr.none())),this}update(e,t,i,...l){this._verifyNotCommitted();const u=Op(e,this._firestore);let d;return d=typeof(t=Gs(t))=="string"||t instanceof ym?dk(this._dataReader,"WriteBatch.update",u._key,t,i,l):uk(this._dataReader,"WriteBatch.update",u._key,t),this._mutations.push(d.toMutation(u._key,xr.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=Op(e,this._firestore);return this._mutations=this._mutations.concat(new dm(t._key,xr.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new tt(Se.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Op(n,e){if((n=Gs(n)).firestore!==e)throw new tt(Se.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}function Rs(n){n=vr(n,vn);const e=vr(n.firestore,za),t=Uu(e);return rM(t,n._key).then((i=>xk(e,n,i)))}function Es(n){n=vr(n,xi);const e=vr(n.firestore,za),t=Uu(e),i=new Py(e);return yk(n._query),aM(t,n._query).then((l=>new Fo(e,i,n,l)))}function Ns(n,e,t){n=vr(n,vn);const i=vr(n.firestore,za),l=Fy(n.converter,e,t),u=zu(i);return Hu(i,[Ay(u,"setDoc",n._key,l,n.converter!==null,t).toMutation(n._key,xr.none())])}function Ma(n,e,t,...i){n=vr(n,vn);const l=vr(n.firestore,za),u=zu(l);let d;return d=typeof(e=Gs(e))=="string"||e instanceof ym?dk(u,"updateDoc",n._key,e,t,i):uk(u,"updateDoc",n._key,e),Hu(l,[d.toMutation(n._key,xr.exists(!0))])}function yr(n){return Hu(vr(n.firestore,za),[new dm(n._key,xr.none())])}function hi(n,e){const t=vr(n.firestore,za),i=He(n),l=Fy(n.converter,e),u=zu(n.firestore);return Hu(t,[Ay(u,"addDoc",i._key,l,n.converter!==null,{}).toMutation(i._key,xr.exists(!1))]).then((()=>i))}function vk(n,...e){n=Gs(n);let t={includeMetadataChanges:!1,source:"default"},i=0;typeof e[i]!="object"||u2(e[i])||(t=e[i++]);const l={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(u2(e[i])){const y=e[i];e[i]=y.next?.bind(y),e[i+1]=y.error?.bind(y),e[i+2]=y.complete?.bind(y)}let u,d,p;if(n instanceof vn)d=vr(n.firestore,za),p=im(n._key.path),u={next:y=>{e[i]&&e[i](xk(d,n,y))},error:e[i+1],complete:e[i+2]};else{const y=vr(n,xi);d=vr(y.firestore,za),p=y._query;const w=new Py(d);u={next:j=>{e[i]&&e[i](new Fo(d,w,y,j))},error:e[i+1],complete:e[i+2]},yk(n._query)}const g=Uu(d);return nM(g,p,l,u)}function Hu(n,e){const t=Uu(n);return iM(t,e)}function xk(n,e,t){const i=t.docs.get(e._key),l=new Py(n);return new Uo(n,l,e._key,i,new ru(t.hasPendingWrites,t.fromCache),e.converter)}function m2(n){return n=vr(n,za),Uu(n),new xM(n,(e=>Hu(n,e)))}(function(e,t=!0){aR(Jo),$o(new io("firestore",((i,{instanceIdentifier:l,options:u})=>{const d=i.getProvider("app").getImmediate(),p=new za(new lR(i.getProvider("auth-internal")),new dR(d,i.getProvider("app-check-internal")),CR(d,l),d);return u={useFetchStreams:t,...u},p._setSettings(u),p}),"PUBLIC").setMultipleInstances(!0)),Pa(l2,c2,e),Pa(l2,c2,"esm2020")})();var wM="firebase",_M="12.8.0";Pa(wM,_M,"app");const wk="firebasestorage.googleapis.com",_k="storageBucket",kM=120*1e3,jM=600*1e3;class wn extends qa{constructor(e,t,i=0){super(Vp(e),`Firebase Storage: ${t} (${Vp(e)})`),this.status_=i,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,wn.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Vp(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var xn;(function(n){n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(xn||(xn={}));function Vp(n){return"storage/"+n}function zy(){const n="An unknown error occurred, please check the error payload for server response.";return new wn(xn.UNKNOWN,n)}function TM(n){return new wn(xn.OBJECT_NOT_FOUND,"Object '"+n+"' does not exist.")}function EM(n){return new wn(xn.QUOTA_EXCEEDED,"Quota for bucket '"+n+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function NM(){const n="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new wn(xn.UNAUTHENTICATED,n)}function SM(){return new wn(xn.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function CM(n){return new wn(xn.UNAUTHORIZED,"User does not have permission to access '"+n+"'.")}function RM(){return new wn(xn.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function AM(){return new wn(xn.CANCELED,"User canceled the upload/download.")}function IM(n){return new wn(xn.INVALID_URL,"Invalid URL '"+n+"'.")}function MM(n){return new wn(xn.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function DM(){return new wn(xn.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+_k+"' property when initializing the app?")}function PM(){return new wn(xn.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function LM(){return new wn(xn.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function OM(n){return new wn(xn.UNSUPPORTED_ENVIRONMENT,`${n} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function Rg(n){return new wn(xn.INVALID_ARGUMENT,n)}function kk(){return new wn(xn.APP_DELETED,"The Firebase app was deleted.")}function VM(n){return new wn(xn.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function du(n,e){return new wn(xn.INVALID_FORMAT,"String does not match format '"+n+"': "+e)}function Yc(n){throw new wn(xn.INTERNAL_ERROR,"Internal error: "+n)}class br{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let i;try{i=br.makeFromUrl(e,t)}catch{return new br(e,"")}if(i.path==="")return i;throw MM(e)}static makeFromUrl(e,t){let i=null;const l="([A-Za-z0-9.\\-_]+)";function u(be){be.path.charAt(be.path.length-1)==="/"&&(be.path_=be.path_.slice(0,-1))}const d="(/(.*))?$",p=new RegExp("^gs://"+l+d,"i"),g={bucket:1,path:3};function y(be){be.path_=decodeURIComponent(be.path)}const w="v[A-Za-z0-9_]+",j=t.replace(/[.]/g,"\\."),T="(/([^?#]*).*)?$",V=new RegExp(`^https?://${j}/${w}/b/${l}/o${T}`,"i"),W={bucket:1,path:3},F=t===wk?"(?:storage.googleapis.com|storage.cloud.google.com)":t,U="([^?#]*)",ne=new RegExp(`^https?://${F}/${l}/${U}`,"i"),oe=[{regex:p,indices:g,postModify:u},{regex:V,indices:W,postModify:y},{regex:ne,indices:{bucket:1,path:2},postModify:y}];for(let be=0;be<oe.length;be++){const Le=oe[be],Ce=Le.regex.exec(e);if(Ce){const R=Ce[Le.indices.bucket];let E=Ce[Le.indices.path];E||(E=""),i=new br(R,E),Le.postModify(i);break}}if(i==null)throw IM(e);return i}}class BM{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function UM(n,e,t){let i=1,l=null,u=null,d=!1,p=0;function g(){return p===2}let y=!1;function w(...U){y||(y=!0,e.apply(null,U))}function j(U){l=setTimeout(()=>{l=null,n(V,g())},U)}function T(){u&&clearTimeout(u)}function V(U,...ne){if(y){T();return}if(U){T(),w.call(null,U,...ne);return}if(g()||d){T(),w.call(null,U,...ne);return}i<64&&(i*=2);let oe;p===1?(p=2,oe=0):oe=(i+Math.random())*1e3,j(oe)}let W=!1;function F(U){W||(W=!0,T(),!y&&(l!==null?(U||(p=2),clearTimeout(l),j(0)):U||(p=1)))}return j(0),u=setTimeout(()=>{d=!0,F(!0)},t),F}function FM(n){n(!1)}function zM(n){return n!==void 0}function qM(n){return typeof n=="object"&&!Array.isArray(n)}function qy(n){return typeof n=="string"||n instanceof String}function f2(n){return Hy()&&n instanceof Blob}function Hy(){return typeof Blob<"u"}function Ag(n,e,t,i){if(i<e)throw Rg(`Invalid value for '${n}'. Expected ${e} or greater.`);if(i>t)throw Rg(`Invalid value for '${n}'. Expected ${t} or less.`)}function xm(n,e,t){let i=e;return t==null&&(i=`https://${e}`),`${t}://${i}/v0${n}`}function jk(n){const e=encodeURIComponent;let t="?";for(const i in n)if(n.hasOwnProperty(i)){const l=e(i)+"="+e(n[i]);t=t+l+"&"}return t=t.slice(0,-1),t}var zo;(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"})(zo||(zo={}));function HM(n,e){const t=n>=500&&n<600,l=[408,429].indexOf(n)!==-1,u=e.indexOf(n)!==-1;return t||l||u}class $M{constructor(e,t,i,l,u,d,p,g,y,w,j,T=!0,V=!1){this.url_=e,this.method_=t,this.headers_=i,this.body_=l,this.successCodes_=u,this.additionalRetryCodes_=d,this.callback_=p,this.errorCallback_=g,this.timeout_=y,this.progressCallback_=w,this.connectionFactory_=j,this.retry=T,this.isUsingEmulator=V,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((W,F)=>{this.resolve_=W,this.reject_=F,this.start_()})}start_(){const e=(i,l)=>{if(l){i(!1,new ih(!1,null,!0));return}const u=this.connectionFactory_();this.pendingConnection_=u;const d=p=>{const g=p.loaded,y=p.lengthComputable?p.total:-1;this.progressCallback_!==null&&this.progressCallback_(g,y)};this.progressCallback_!==null&&u.addUploadProgressListener(d),u.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&u.removeUploadProgressListener(d),this.pendingConnection_=null;const p=u.getErrorCode()===zo.NO_ERROR,g=u.getStatus();if(!p||HM(g,this.additionalRetryCodes_)&&this.retry){const w=u.getErrorCode()===zo.ABORT;i(!1,new ih(!1,null,w));return}const y=this.successCodes_.indexOf(g)!==-1;i(!0,new ih(y,u))})},t=(i,l)=>{const u=this.resolve_,d=this.reject_,p=l.connection;if(l.wasSuccessCode)try{const g=this.callback_(p,p.getResponse());zM(g)?u(g):u()}catch(g){d(g)}else if(p!==null){const g=zy();g.serverResponse=p.getErrorText(),this.errorCallback_?d(this.errorCallback_(p,g)):d(g)}else if(l.canceled){const g=this.appDelete_?kk():AM();d(g)}else{const g=RM();d(g)}};this.canceled_?t(!1,new ih(!1,null,!0)):this.backoffId_=UM(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&FM(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class ih{constructor(e,t,i){this.wasSuccessCode=e,this.connection=t,this.canceled=!!i}}function WM(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function GM(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function KM(n,e){e&&(n["X-Firebase-GMPID"]=e)}function YM(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function QM(n,e,t,i,l,u,d=!0,p=!1){const g=jk(n.urlParams),y=n.url+g,w=Object.assign({},n.headers);return KM(w,e),WM(w,t),GM(w,u),YM(w,i),new $M(y,n.method,w,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,l,d,p)}function XM(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function JM(...n){const e=XM();if(e!==void 0){const t=new e;for(let i=0;i<n.length;i++)t.append(n[i]);return t.getBlob()}else{if(Hy())return new Blob(n);throw new wn(xn.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function ZM(n,e,t){return n.webkitSlice?n.webkitSlice(e,t):n.mozSlice?n.mozSlice(e,t):n.slice?n.slice(e,t):null}function e3(n){if(typeof atob>"u")throw OM("base-64");return atob(n)}const Da={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class Bp{constructor(e,t){this.data=e,this.contentType=t||null}}function t3(n,e){switch(n){case Da.RAW:return new Bp(Tk(e));case Da.BASE64:case Da.BASE64URL:return new Bp(Ek(n,e));case Da.DATA_URL:return new Bp(n3(e),r3(e))}throw zy()}function Tk(n){const e=[];for(let t=0;t<n.length;t++){let i=n.charCodeAt(t);if(i<=127)e.push(i);else if(i<=2047)e.push(192|i>>6,128|i&63);else if((i&64512)===55296)if(!(t<n.length-1&&(n.charCodeAt(t+1)&64512)===56320))e.push(239,191,189);else{const u=i,d=n.charCodeAt(++t);i=65536|(u&1023)<<10|d&1023,e.push(240|i>>18,128|i>>12&63,128|i>>6&63,128|i&63)}else(i&64512)===56320?e.push(239,191,189):e.push(224|i>>12,128|i>>6&63,128|i&63)}return new Uint8Array(e)}function s3(n){let e;try{e=decodeURIComponent(n)}catch{throw du(Da.DATA_URL,"Malformed data URL.")}return Tk(e)}function Ek(n,e){switch(n){case Da.BASE64:{const l=e.indexOf("-")!==-1,u=e.indexOf("_")!==-1;if(l||u)throw du(n,"Invalid character '"+(l?"-":"_")+"' found: is it base64url encoded?");break}case Da.BASE64URL:{const l=e.indexOf("+")!==-1,u=e.indexOf("/")!==-1;if(l||u)throw du(n,"Invalid character '"+(l?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let t;try{t=e3(e)}catch(l){throw l.message.includes("polyfill")?l:du(n,"Invalid character found")}const i=new Uint8Array(t.length);for(let l=0;l<t.length;l++)i[l]=t.charCodeAt(l);return i}class Nk{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(t===null)throw du(Da.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const i=t[1]||null;i!=null&&(this.base64=a3(i,";base64"),this.contentType=this.base64?i.substring(0,i.length-7):i),this.rest=e.substring(e.indexOf(",")+1)}}function n3(n){const e=new Nk(n);return e.base64?Ek(Da.BASE64,e.rest):s3(e.rest)}function r3(n){return new Nk(n).contentType}function a3(n,e){return n.length>=e.length?n.substring(n.length-e.length)===e:!1}class Ji{constructor(e,t){let i=0,l="";f2(e)?(this.data_=e,i=e.size,l=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),i=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),i=e.length),this.size_=i,this.type_=l}size(){return this.size_}type(){return this.type_}slice(e,t){if(f2(this.data_)){const i=this.data_,l=ZM(i,e,t);return l===null?null:new Ji(l)}else{const i=new Uint8Array(this.data_.buffer,e,t-e);return new Ji(i,!0)}}static getBlob(...e){if(Hy()){const t=e.map(i=>i instanceof Ji?i.data_:i);return new Ji(JM.apply(null,t))}else{const t=e.map(d=>qy(d)?t3(Da.RAW,d).data:d.data_);let i=0;t.forEach(d=>{i+=d.byteLength});const l=new Uint8Array(i);let u=0;return t.forEach(d=>{for(let p=0;p<d.length;p++)l[u++]=d[p]}),new Ji(l,!0)}}uploadData(){return this.data_}}function $y(n){let e;try{e=JSON.parse(n)}catch{return null}return qM(e)?e:null}function i3(n){if(n.length===0)return null;const e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function o3(n,e){const t=e.split("/").filter(i=>i.length>0).join("/");return n.length===0?t:n+"/"+t}function Sk(n){const e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}function l3(n,e){return e}class gr{constructor(e,t,i,l){this.server=e,this.local=t||e,this.writable=!!i,this.xform=l||l3}}let oh=null;function c3(n){return!qy(n)||n.length<2?n:Sk(n)}function Ck(){if(oh)return oh;const n=[];n.push(new gr("bucket")),n.push(new gr("generation")),n.push(new gr("metageneration")),n.push(new gr("name","fullPath",!0));function e(u,d){return c3(d)}const t=new gr("name");t.xform=e,n.push(t);function i(u,d){return d!==void 0?Number(d):d}const l=new gr("size");return l.xform=i,n.push(l),n.push(new gr("timeCreated")),n.push(new gr("updated")),n.push(new gr("md5Hash",null,!0)),n.push(new gr("cacheControl",null,!0)),n.push(new gr("contentDisposition",null,!0)),n.push(new gr("contentEncoding",null,!0)),n.push(new gr("contentLanguage",null,!0)),n.push(new gr("contentType",null,!0)),n.push(new gr("metadata","customMetadata",!0)),oh=n,oh}function u3(n,e){function t(){const i=n.bucket,l=n.fullPath,u=new br(i,l);return e._makeStorageReference(u)}Object.defineProperty(n,"ref",{get:t})}function d3(n,e,t){const i={};i.type="file";const l=t.length;for(let u=0;u<l;u++){const d=t[u];i[d.local]=d.xform(i,e[d.server])}return u3(i,n),i}function Rk(n,e,t){const i=$y(e);return i===null?null:d3(n,i,t)}function h3(n,e,t,i){const l=$y(e);if(l===null||!qy(l.downloadTokens))return null;const u=l.downloadTokens;if(u.length===0)return null;const d=encodeURIComponent;return u.split(",").map(y=>{const w=n.bucket,j=n.fullPath,T="/b/"+d(w)+"/o/"+d(j),V=xm(T,t,i),W=jk({alt:"media",token:y});return V+W})[0]}function m3(n,e){const t={},i=e.length;for(let l=0;l<i;l++){const u=e[l];u.writable&&(t[u.server]=n[u.local])}return JSON.stringify(t)}const p2="prefixes",g2="items";function f3(n,e,t){const i={prefixes:[],items:[],nextPageToken:t.nextPageToken};if(t[p2])for(const l of t[p2]){const u=l.replace(/\/$/,""),d=n._makeStorageReference(new br(e,u));i.prefixes.push(d)}if(t[g2])for(const l of t[g2]){const u=n._makeStorageReference(new br(e,l.name));i.items.push(u)}return i}function p3(n,e,t){const i=$y(t);return i===null?null:f3(n,e,i)}class Wy{constructor(e,t,i,l){this.url=e,this.method=t,this.handler=i,this.timeout=l,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function Gy(n){if(!n)throw zy()}function g3(n,e){function t(i,l){const u=Rk(n,l,e);return Gy(u!==null),u}return t}function y3(n,e){function t(i,l){const u=p3(n,e,l);return Gy(u!==null),u}return t}function b3(n,e){function t(i,l){const u=Rk(n,l,e);return Gy(u!==null),h3(u,l,n.host,n._protocol)}return t}function Ky(n){function e(t,i){let l;return t.getStatus()===401?t.getErrorText().includes("Firebase App Check token is invalid")?l=SM():l=NM():t.getStatus()===402?l=EM(n.bucket):t.getStatus()===403?l=CM(n.path):l=i,l.status=t.getStatus(),l.serverResponse=i.serverResponse,l}return e}function v3(n){const e=Ky(n);function t(i,l){let u=e(i,l);return i.getStatus()===404&&(u=TM(n.path)),u.serverResponse=l.serverResponse,u}return t}function x3(n,e,t,i,l){const u={};e.isRoot?u.prefix="":u.prefix=e.path+"/",t.length>0&&(u.delimiter=t),i&&(u.pageToken=i),l&&(u.maxResults=l);const d=e.bucketOnlyServerUrl(),p=xm(d,n.host,n._protocol),g="GET",y=n.maxOperationRetryTime,w=new Wy(p,g,y3(n,e.bucket),y);return w.urlParams=u,w.errorHandler=Ky(e),w}function w3(n,e,t){const i=e.fullServerUrl(),l=xm(i,n.host,n._protocol),u="GET",d=n.maxOperationRetryTime,p=new Wy(l,u,b3(n,t),d);return p.errorHandler=v3(e),p}function _3(n,e){return n&&n.contentType||e&&e.type()||"application/octet-stream"}function k3(n,e,t){const i=Object.assign({},t);return i.fullPath=n.path,i.size=e.size(),i.contentType||(i.contentType=_3(null,e)),i}function j3(n,e,t,i,l){const u=e.bucketOnlyServerUrl(),d={"X-Goog-Upload-Protocol":"multipart"};function p(){let oe="";for(let be=0;be<2;be++)oe=oe+Math.random().toString().slice(2);return oe}const g=p();d["Content-Type"]="multipart/related; boundary="+g;const y=k3(e,i,l),w=m3(y,t),j="--"+g+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+w+`\r
--`+g+`\r
Content-Type: `+y.contentType+`\r
\r
`,T=`\r
--`+g+"--",V=Ji.getBlob(j,i,T);if(V===null)throw PM();const W={name:y.fullPath},F=xm(u,n.host,n._protocol),U="POST",ne=n.maxUploadRetryTime,Y=new Wy(F,U,g3(n,t),ne);return Y.urlParams=W,Y.headers=d,Y.body=V.uploadData(),Y.errorHandler=Ky(e),Y}class T3{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=zo.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=zo.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=zo.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,i,l,u){if(this.sent_)throw Yc("cannot .send() more than once");if(fo(e)&&i&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(t,e,!0),u!==void 0)for(const d in u)u.hasOwnProperty(d)&&this.xhr_.setRequestHeader(d,u[d].toString());return l!==void 0?this.xhr_.send(l):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Yc("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Yc("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw Yc("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Yc("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class E3 extends T3{initXhr(){this.xhr_.responseType="text"}}function Yy(){return new E3}class Xo{constructor(e,t){this._service=e,t instanceof br?this._location=t:this._location=br.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new Xo(e,t)}get root(){const e=new br(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return Sk(this._location.path)}get storage(){return this._service}get parent(){const e=i3(this._location.path);if(e===null)return null;const t=new br(this._location.bucket,e);return new Xo(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw VM(e)}}function N3(n,e,t){n._throwIfRoot("uploadBytes");const i=j3(n.storage,n._location,Ck(),new Ji(e,!0),t);return n.storage.makeRequestWithTokens(i,Yy).then(l=>({metadata:l,ref:n}))}function S3(n){const e={prefixes:[],items:[]};return Ak(n,e).then(()=>e)}async function Ak(n,e,t){const l=await C3(n,{pageToken:t});e.prefixes.push(...l.prefixes),e.items.push(...l.items),l.nextPageToken!=null&&await Ak(n,e,l.nextPageToken)}function C3(n,e){e!=null&&typeof e.maxResults=="number"&&Ag("options.maxResults",1,1e3,e.maxResults);const t=e||{},i=x3(n.storage,n._location,"/",t.pageToken,t.maxResults);return n.storage.makeRequestWithTokens(i,Yy)}function R3(n){n._throwIfRoot("getDownloadURL");const e=w3(n.storage,n._location,Ck());return n.storage.makeRequestWithTokens(e,Yy).then(t=>{if(t===null)throw LM();return t})}function A3(n,e){const t=o3(n._location.path,e),i=new br(n._location.bucket,t);return new Xo(n.storage,i)}function I3(n){return/^[A-Za-z]+:\/\//.test(n)}function M3(n,e){return new Xo(n,e)}function Ik(n,e){if(n instanceof Qy){const t=n;if(t._bucket==null)throw DM();const i=new Xo(t,t._bucket);return e!=null?Ik(i,e):i}else return e!==void 0?A3(n,e):n}function D3(n,e){if(e&&I3(e)){if(n instanceof Qy)return M3(n,e);throw Rg("To use ref(service, url), the first argument must be a Storage instance.")}else return Ik(n,e)}function y2(n,e){const t=e?.[_k];return t==null?null:br.makeFromBucketSpec(t,n)}function P3(n,e,t,i={}){n.host=`${e}:${t}`;const l=fo(e);l&&(Fg(`https://${n.host}/b`),zg("Storage",!0)),n._isUsingEmulator=!0,n._protocol=l?"https":"http";const{mockUserToken:u}=i;u&&(n._overrideAuthToken=typeof u=="string"?u:tw(u,n.app.options.projectId))}class Qy{constructor(e,t,i,l,u,d=!1){this.app=e,this._authProvider=t,this._appCheckProvider=i,this._url=l,this._firebaseVersion=u,this._isUsingEmulator=d,this._bucket=null,this._host=wk,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=kM,this._maxUploadRetryTime=jM,this._requests=new Set,l!=null?this._bucket=br.makeFromBucketSpec(l,this._host):this._bucket=y2(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=br.makeFromBucketSpec(this._url,e):this._bucket=y2(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){Ag("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){Ag("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(qr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Xo(this,e)}_makeRequest(e,t,i,l,u=!0){if(this._deleted)return new BM(kk());{const d=QM(e,this._appId,i,l,t,this._firebaseVersion,u,this._isUsingEmulator);return this._requests.add(d),d.getPromise().then(()=>this._requests.delete(d),()=>this._requests.delete(d)),d}}async makeRequestWithTokens(e,t){const[i,l]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,i,l).getPromise()}}const b2="@firebase/storage",v2="0.14.0";const Mk="storage";function Up(n,e,t){return n=Gs(n),N3(n,e,t)}function x2(n){return n=Gs(n),S3(n)}function qo(n){return n=Gs(n),R3(n)}function eo(n,e){return n=Gs(n),D3(n,e)}function L3(n=Wg(),e){n=Gs(n);const i=Jh(n,Mk).getImmediate({identifier:e}),l=J2("storage");return l&&O3(i,...l),i}function O3(n,e,t,i={}){P3(n,e,t,i)}function V3(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),i=n.getProvider("auth-internal"),l=n.getProvider("app-check-internal");return new Qy(t,i,l,e,Jo)}function B3(){$o(new io(Mk,V3,"PUBLIC").setMultipleInstances(!0)),Pa(b2,v2,""),Pa(b2,v2,"esm2020")}B3();const Dk={apiKey:"AIzaSyBCIgMJd3By7qkWH27YiW9VooIBGE3bFLs",authDomain:"mind-core-fitness-client.firebaseapp.com",projectId:"mind-core-fitness-client",storageBucket:"mind-core-fitness-client.firebasestorage.app",messagingSenderId:"669343392406",appId:"1:669343392406:web:f5a35ee062387e7d6f58b7"},Xy=$g(Dk),Do=Uw(Xy),pe=uM(Xy),to=L3(Xy),U3=$g(Dk,"secondary"),IP=Uw(U3),F3="EYdciKDOi3UYBLk1u8hHams5tmO2",Pk=v.createContext();function Mr(){return v.useContext(Pk)}function z3({children:n}){const[e,t]=v.useState(null),[i,l]=v.useState(!1),[u,d]=v.useState(!1),[p,g]=v.useState(null),[y,w]=v.useState(!0);v.useEffect(()=>{let Y=null;const oe=GC(Do,be=>{if(t(be),Y&&(Y(),Y=null),be)if(be.uid===F3)l(!0),d(!1),g(null),w(!1);else{l(!1);const Le=Ds(zt(pe,"clients"),hs("uid","==",be.uid)),Ce=async()=>{const R=localStorage.getItem("mcf_clientId");if(R)try{const E=await Rs(He(pe,"clients",R));E.exists()&&(d(!0),g({id:E.id,...E.data()}))}catch(E){console.error("Direct client read failed:",E)}};Y=vk(Le,async R=>{if(R.empty)await Ce();else{const E=R.docs[0];d(!0),g({id:E.id,...E.data()});try{localStorage.setItem("mcf_clientId",E.id)}catch{}}w(!1)},async R=>{console.error("Error listening to client data:",R),await Ce(),w(!1)})}else l(!1),d(!1),g(null),w(!1)});return()=>{oe(),Y&&Y()}},[]);const ne={currentUser:e,isAdmin:i,isClient:u,clientData:p,updateClientData:Y=>{g(oe=>oe?{...oe,...Y}:Y)},resolveClient:async()=>{if(p)return p;const Y=localStorage.getItem("mcf_clientId");if(Y)try{const oe=await Rs(He(pe,"clients",Y));if(oe.exists()){const be={id:oe.id,...oe.data()};return d(!0),g(be),be}}catch(oe){console.error("resolveClient direct read failed:",oe)}if(e){const oe=Ds(zt(pe,"clients"),hs("uid","==",e.uid)),be=await Es(oe);if(!be.empty){const Le={id:be.docs[0].id,...be.docs[0].data()};return d(!0),g(Le),Le}}return null},login:async(Y,oe,be=!0)=>(await nx(Do,be?hg:Zg),await HC(Do,Y,oe)),signup:async(Y,oe,be)=>{await nx(Do,hg);const Le=await qC(Do,oe.trim().toLowerCase(),be),Ce=Le.user,R=He(zt(pe,"clients")),E={uid:Ce.uid,name:Y.trim(),email:oe.trim().toLowerCase(),clientType:"core_buddy",coreBuddyAccess:!0,status:"active",tier:"free",subscriptionStatus:null,signupSource:"self_signup",createdAt:xt.now()};await Ns(R,E),d(!0),g({id:R.id,...E});try{localStorage.setItem("mcf_clientId",R.id)}catch{}return Le},logout:()=>{try{localStorage.removeItem("mcf_clientId")}catch{}return KC(Do)},resetPassword:Y=>zC(Do,Y),loading:y};return r.jsx(Pk.Provider,{value:ne,children:n})}const Lk=v.createContext();function ka(){return v.useContext(Lk)}function q3({children:n}){const[e,t]=v.useState(()=>{const g=localStorage.getItem("theme");return g?g==="dark":window.matchMedia("(prefers-color-scheme: dark)").matches}),[i,l]=v.useState(()=>localStorage.getItem("accent")||"red");v.useEffect(()=>{document.documentElement.setAttribute("data-theme",e?"dark":"light"),localStorage.setItem("theme",e?"dark":"light")},[e]),v.useEffect(()=>{localStorage.setItem("accent",i)},[i]);const p={isDark:e,toggleTheme:()=>{document.documentElement.setAttribute("data-theme-transitioning",""),t(!e),setTimeout(()=>{document.documentElement.removeAttribute("data-theme-transitioning")},350)},accent:i,setAccent:g=>l(g)};return r.jsx(Lk.Provider,{value:p,children:n})}const Ok=v.createContext();function wm(){return v.useContext(Ok)}const H3=["nutrition","consistency","personalBests","achievements","buddies","programmes","leaderboard"],$3=[5,10],W3=1;function G3({children:n}){const{clientData:e,loading:t}=Mr(),i=v.useMemo(()=>{const l=e?.tier||"free",u=e?.subscriptionStatus||null,d=e&&e.signupSource!=="self_signup",p=l==="premium"||!!d;function g(y){return p?!0:!H3.includes(y)}return{tier:l,subscriptionStatus:u,isPremium:p,canAccess:g,loading:t,FREE_RANDOMISER_DURATIONS:$3,FREE_RANDOMISER_WEEKLY_LIMIT:W3}},[e?.tier,e?.subscriptionStatus,e?.signupSource,t]);return r.jsx(Ok.Provider,{value:i,children:n})}function K3(n){if(n?.signupSource==="self_signup"&&!n?.onboardingComplete)return"/onboarding";const e=n?.clientType;return e==="core_buddy"?"/client/core-buddy":e==="circuit_vip"||e==="circuit_dropin"?"/client/circuit":"/client"}function Y3({className:n=""}){const{isDark:e,toggleTheme:t}=ka();return r.jsx("button",{className:n||"theme-toggle",onClick:t,"aria-label":e?"Switch to light mode":"Switch to dark mode",children:e?r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20",children:r.jsx("path",{d:"M12 3a9 9 0 109 9c0-.46-.04-.92-.1-1.36a5.389 5.389 0 01-4.4 2.26 5.403 5.403 0 01-3.14-9.8c-.44-.06-.9-.1-1.36-.1z"})}):r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20",children:r.jsx("path",{d:"M12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zM2 13h2c.55 0 1-.45 1-1s-.45-1-1-1H2c-.55 0-1 .45-1 1s.45 1 1 1zm18 0h2c.55 0 1-.45 1-1s-.45-1-1-1h-2c-.55 0-1 .45-1 1s.45 1 1 1zM11 2v2c0 .55.45 1 1 1s1-.45 1-1V2c0-.55-.45-1-1-1s-1 .45-1 1zm0 18v2c0 .55.45 1 1 1s1-.45 1-1v-2c0-.55-.45-1-1-1s-1 .45-1 1zM5.99 4.58a.996.996 0 00-1.41 0 .996.996 0 000 1.41l1.06 1.06c.39.39 1.03.39 1.41 0s.39-1.03 0-1.41L5.99 4.58zm12.37 12.37a.996.996 0 00-1.41 0 .996.996 0 000 1.41l1.06 1.06c.39.39 1.03.39 1.41 0a.996.996 0 000-1.41l-1.06-1.06zm1.06-10.96a.996.996 0 000-1.41.996.996 0 00-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06zM7.05 18.36a.996.996 0 000-1.41.996.996 0 00-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06z"})})})}function Q3(){const[n,e]=v.useState(""),[t,i]=v.useState(""),[l,u]=v.useState(!0),[d,p]=v.useState(""),[g,y]=v.useState(!1),[w,j]=v.useState(!1),[T,V]=v.useState(!1),{login:W,resetPassword:F,currentUser:U,isAdmin:ne,isClient:Y,clientData:oe,loading:be}=Mr(),Le=$n();if(v.useEffect(()=>{!be&&U&&(ne?Le("/dashboard"):Y?Le(K3(oe)):(y(!1),p("No account found. Please sign up or contact your trainer.")))},[be,U,ne,Y,oe,Le]),be||U)return null;const Ce=async E=>{E.preventDefault(),p(""),y(!0);try{await W(n,t,l)}catch(A){p(A.message||"Failed to log in"),y(!1)}},R=async E=>{if(E.preventDefault(),p(""),!n.trim()){p("Please enter your email address");return}y(!0);try{await F(n.trim()),V(!0)}catch(A){A.code==="auth/user-not-found"?p("No account found with this email"):p(A.message||"Failed to send reset email")}y(!1)};return r.jsxs("div",{className:"login-container",children:[r.jsx(Y3,{className:"login-theme-toggle"}),r.jsxs("div",{className:"login-card",children:[r.jsxs("div",{className:"login-header",children:[r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"login-logo"}),r.jsx("p",{children:r.jsx("strong",{children:w?"Reset Password":"Sign in as 1-2-1 or a Core Buddy"})})]}),d&&r.jsx("div",{className:"error-message",children:d}),T?r.jsxs("div",{className:"reset-sent",children:[r.jsx("div",{className:"reset-sent-icon",children:r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M22 2L11 13",strokeLinecap:"round",strokeLinejoin:"round"}),r.jsx("path",{d:"M22 2L15 22L11 13L2 9L22 2Z",strokeLinecap:"round",strokeLinejoin:"round"})]})}),r.jsx("p",{children:"Reset email sent!"}),r.jsx("span",{children:"Check your inbox for a password reset link"}),r.jsx("button",{className:"login-btn",style:{marginTop:"20px"},onClick:()=>{j(!1),V(!1),p("")},children:"Back to Log In"})]}):w?r.jsxs("form",{onSubmit:R,children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"email",children:"Email"}),r.jsx("input",{type:"email",id:"email",value:n,onChange:E=>e(E.target.value),placeholder:"Enter your email",required:!0})]}),r.jsx("button",{type:"submit",className:"login-btn",disabled:g,children:g?"Sending...":"Send Reset Link"}),r.jsx("button",{type:"button",className:"forgot-link",onClick:()=>{j(!1),p("")},children:"Back to Log In"})]}):r.jsxs(r.Fragment,{children:[r.jsxs("form",{onSubmit:Ce,children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"email",children:"Email"}),r.jsx("input",{type:"email",id:"email",value:n,onChange:E=>e(E.target.value),required:!0})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"password",children:"Password"}),r.jsx("input",{type:"password",id:"password",value:t,onChange:E=>i(E.target.value),required:!0})]}),r.jsx("div",{className:"remember-me",children:r.jsxs("label",{children:[r.jsx("input",{type:"checkbox",checked:l,onChange:E=>u(E.target.checked)}),r.jsx("span",{children:"Remember me"})]})}),r.jsx("button",{type:"submit",className:"login-btn",disabled:g,children:g?"Logging in...":"Log In"})]}),r.jsx("button",{type:"button",className:"forgot-link",onClick:()=>{j(!0),p("")},children:"Forgot password?"})]}),r.jsx("a",{href:"/",className:"back-link",children:"Back to website"})]})]})}function Ml({feature:n,children:e}){const{canAccess:t,loading:i}=wm(),l=$n();return i||t(n)?e:r.jsxs("div",{className:"locked-feature-wrap",children:[r.jsx("div",{className:"locked-feature-bg","aria-hidden":"true",children:e}),r.jsx("div",{className:"locked-feature-overlay",children:r.jsxs("div",{className:"locked-feature-card",children:[r.jsx("div",{className:"locked-icon",children:r.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),r.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]})}),r.jsx("h2",{children:"Premium Feature"}),r.jsx("p",{children:"Upgrade to Core Buddy Premium to unlock this feature and get full access to everything."}),r.jsx("button",{className:"locked-upgrade-btn",onClick:()=>l("/upgrade"),children:"Upgrade Now"})]})})]})}function aa({active:n}){const e=$n(),{clientData:t}=Mr(),{isPremium:i}=wm(),l=t?.clientType==="block"&&t?.coreBuddyAccess;return r.jsxs("nav",{className:"block-bottom-nav",children:[r.jsxs("button",{className:`block-nav-tab${n==="home"?" active":""}`,onClick:()=>e("/client/core-buddy"),children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),r.jsx("circle",{cx:"12",cy:"7",r:"4"})]}),r.jsx("span",{children:"Profile"})]}),r.jsxs("button",{className:`block-nav-tab${n==="workouts"?" active":""}`,onClick:()=>e("/client/core-buddy/workouts"),children:[r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"currentColor",stroke:"none",children:r.jsx("path",{d:"M1 9h2v6H1V9zm3-2h2v10H4V7zm3 4h10v2H7v-2zm10-4h2v10h-2V7zm3 2h2v6h-2V9z"})}),r.jsx("span",{children:"Workouts"})]}),r.jsxs("button",{className:`block-nav-tab${n==="nutrition"?" active":""}`,onClick:()=>e(i?"/client/core-buddy/nutrition":"/upgrade"),children:[r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M18 8h1a4 4 0 0 1 0 8h-1M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z"})}),r.jsx("span",{children:"Nutrition"})]}),r.jsxs("button",{className:`block-nav-tab${n==="buddies"?" active":""}`,onClick:()=>e(i?"/client/core-buddy/buddies":"/upgrade"),children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),r.jsx("circle",{cx:"9",cy:"7",r:"4"}),r.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),r.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),r.jsx("span",{children:"Buddies"})]}),l&&r.jsxs("button",{className:"block-nav-tab",onClick:()=>e("/client"),children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"3",width:"7",height:"7"}),r.jsx("rect",{x:"14",y:"3",width:"7",height:"7"}),r.jsx("rect",{x:"14",y:"14",width:"7",height:"7"}),r.jsx("rect",{x:"3",y:"14",width:"7",height:"7"})]}),r.jsx("span",{children:"Block"})]})]})}function xa({children:n,onRefresh:e}){const[t,i]=v.useState(0),[l,u]=v.useState(!1),d=v.useRef(null),p=v.useRef(0),g=v.useRef(!1),y=v.useCallback(T=>{window.scrollY<=0&&(p.current=T.touches[0].clientY,g.current=!0)},[]),w=v.useCallback(T=>{if(!g.current||l)return;const V=T.touches[0].clientY-p.current;V>20&&window.scrollY<=0&&(T.preventDefault(),i(Math.min((V-20)*.35,80)))},[l]),j=v.useCallback(async()=>{t>55&&!l&&(u(!0),e?await e():window.location.reload(),u(!1)),i(0),g.current=!1},[t,l,e]);return r.jsxs("div",{ref:d,onTouchStart:y,onTouchMove:w,onTouchEnd:j,children:[r.jsxs("div",{className:`pull-refresh-indicator ${t>0?"visible":""} ${l?"refreshing":""}`,style:{height:t},children:[r.jsx("div",{className:`refresh-spinner ${l?"spinning":""}`,children:r.jsx("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:r.jsx("path",{fill:"currentColor",d:"M17.65 6.35A7.958 7.958 0 0012 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08A5.99 5.99 0 0112 18c-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"})})}),r.jsx("span",{className:"refresh-text",children:l?"Refreshing...":"Pull to refresh"})]}),n]})}function $u(n,e,t,i,l){const u=[];for(let d=0;d<n;d++){const p=(d*(360/n)-90)*(Math.PI/180);u.push({x1:e+i*Math.cos(p),y1:t+i*Math.sin(p),x2:e+l*Math.cos(p),y2:t+l*Math.sin(p),thick:d%5===0})}return u}const Jy=$u(60,100,100,85,96),hu=$u(60,100,100,78,94),X3=$u(60,100,100,82,94);$u(60,50,50,38,46);const w2=$u(60,40,40,30,37),J3="/login/assets/first_workout-B8SFkzJX.PNG",Z3="/login/assets/workouts_10-Z5R3u0xH.PNG",eD="/login/assets/workouts_25-CzxSlcAj.PNG",tD="/login/assets/workouts_50-BpzWup3V.PNG",sD="/login/assets/workouts_100-D7_r6tn1.PNG",nD="/login/assets/streak_2-CsRr-XA9.PNG",rD="/login/assets/streak_4-BHO09tbw.PNG",aD="/login/assets/streak_8-DX2UWMko.PNG",iD="/login/assets/first_pb-aVf_CNWy.PNG",oD="/login/assets/pbs_5-Cippawgg.PNG",lD="/login/assets/pbs_10-CZgGh9Kv.PNG",cD="/login/assets/pbs_100-C67b1wfS.PNG",uD="/login/assets/nutrition_7-CHVV11fj.PNG",dD="/login/assets/leaderboard_join-BLoId4Hz.PNG",hD="/login/assets/habits_7-Dvki70KO.PNG",mu=[{id:"first_workout",img:J3,name:"First Rep",desc:"Complete your first workout",category:"workouts",threshold:1},{id:"workouts_10",img:Z3,name:"On Fire",desc:"Complete 10 workouts",category:"workouts",threshold:10},{id:"workouts_25",img:eD,name:"Dedicated",desc:"Complete 25 workouts",category:"workouts",threshold:25},{id:"workouts_50",img:tD,name:"Unstoppable",desc:"Complete 50 workouts",category:"workouts",threshold:50},{id:"workouts_100",img:sD,name:"Century",desc:"Complete 100 workouts",category:"workouts",threshold:100},{id:"streak_2",img:nD,name:"2 Week Streak",desc:"Work out for 2 weeks in a row",category:"streaks",threshold:2},{id:"streak_4",img:rD,name:"Month Strong",desc:"Work out for 4 weeks in a row",category:"streaks",threshold:4},{id:"streak_8",img:aD,name:"Iron Will",desc:"Work out for 8 weeks in a row",category:"streaks",threshold:8},{id:"first_pb",img:iD,name:"First PB",desc:"Set your first personal best",category:"pbs",threshold:1},{id:"pbs_5",img:oD,name:"PB Hunter",desc:"Set 5 personal bests",category:"pbs",threshold:5},{id:"pbs_10",img:lD,name:"PB Machine",desc:"Set 10 personal bests",category:"pbs",threshold:10},{id:"pbs_100",img:cD,name:"PB Legend",desc:"Set 100 personal bests",category:"pbs",threshold:100},{id:"nutrition_7",img:uD,name:"Macro Master",desc:"Hit your macro targets 7 days in a row",category:"nutrition",threshold:7},{id:"leaderboard_join",img:dD,name:"Competitor",desc:"Join the leaderboard",category:"leaderboard",threshold:1},{id:"habits_7",img:hD,name:"Habit Streak",desc:"Complete your daily habits 7 days in a row",category:"habits",threshold:7}];function mD({steps:n,onFinish:e,active:t}){const[i,l]=v.useState(0),[u,d]=v.useState(null),[p,g]=v.useState("below"),[y,w]=v.useState(!1),j=v.useRef(null),T=v.useRef(t);T.current=t,v.useEffect(()=>{t||l(0)},[t]),v.useEffect(()=>{if(!t)return;const Le=Ce=>Ce.preventDefault();return document.addEventListener("touchmove",Le,{passive:!1}),document.addEventListener("wheel",Le,{passive:!1}),document.body.style.overflow="hidden",()=>{document.removeEventListener("touchmove",Le),document.removeEventListener("wheel",Le),document.body.style.overflow=""}},[t]);const V=v.useMemo(()=>t?n.filter(Le=>document.querySelector(Le.selector)):[],[t]),W=V[i],F=i===V.length-1,U=W?.selector,ne=v.useCallback(()=>{if(!U)return;const Le=document.querySelector(U);if(!Le){d(null);return}const Ce=Le.getBoundingClientRect(),R=8;d({top:Ce.top-R,left:Ce.left-R,width:Ce.width+R*2,height:Ce.height+R*2});const E=window.innerHeight-Ce.bottom;g(E<260?"above":"below")},[U]);if(v.useEffect(()=>{if(!t||!U)return;w(!0);const Le=document.querySelector(U);if(Le){document.body.style.overflow="",Le.scrollIntoView({behavior:"smooth",block:"center"});let Ce=null,R=0,E=0;const A=60,O=()=>{E++;const M=Le.getBoundingClientRect(),We=Math.round(M.top);if(Ce!==null&&We===Ce?R++:R=0,Ce=We,R>=3||E>=A){T.current&&(document.body.style.overflow="hidden"),ne(),w(!1);return}D=requestAnimationFrame(O)};let D;const H=setTimeout(()=>{D=requestAnimationFrame(O)},120);return()=>{clearTimeout(H),D&&cancelAnimationFrame(D),T.current&&(document.body.style.overflow="hidden")}}},[t,i,U,ne]),v.useEffect(()=>{if(!t)return;const Le=()=>{j.current&&cancelAnimationFrame(j.current),j.current=requestAnimationFrame(ne)};return window.addEventListener("scroll",Le,!0),window.addEventListener("resize",Le),()=>{window.removeEventListener("scroll",Le,!0),window.removeEventListener("resize",Le),j.current&&cancelAnimationFrame(j.current)}},[t,ne]),!t||!W||V.length===0)return null;const Y=()=>{F?e():l(i+1)},oe=()=>{i>0&&l(i-1)},be=()=>e();return r.jsxs("div",{className:"st-overlay",onClick:Le=>{Le.stopPropagation()},children:[r.jsx("div",{className:"st-backdrop",onClick:Y}),u&&r.jsx("div",{className:`st-spotlight${y?" st-transitioning":""}`,style:{top:u.top,left:u.left,width:u.width,height:u.height}}),u&&r.jsxs("div",{className:`st-tooltip st-tooltip-${p}${y?" st-transitioning":""}`,style:{top:p==="below"?Math.min(Math.max(u.top+u.height+16,16),window.innerHeight-200):void 0,bottom:p==="above"?Math.min(Math.max(window.innerHeight-u.top+16,16),window.innerHeight-60):void 0,left:Math.max(16,Math.min(u.left,window.innerWidth-320))},children:[r.jsx("div",{className:"st-dots",children:V.map((Le,Ce)=>r.jsx("span",{className:`st-dot${Ce===i?" active":""}${Ce<i?" done":""}`},Ce))}),r.jsx("h3",{className:"st-title",children:W.title}),r.jsx("p",{className:"st-body",children:W.body}),r.jsxs("div",{className:"st-actions",children:[i>0&&r.jsx("button",{className:"st-btn st-btn-back",onClick:oe,children:"Back"}),r.jsx("button",{className:"st-btn st-btn-next",onClick:Y,children:W.cta||(F?"Let's Go!":"Next")})]}),r.jsx("button",{className:"st-skip",onClick:be,children:"Skip tour"})]})]})}const Fp=[10,25,50,100,200,500,1e3],Wi=5;function Qc(n){return n.toISOString().split("T")[0]}function fD(n){let e=0;for(const t of Fp){if(n<t)return{prev:e,next:t};e=t}return{prev:Fp[Fp.length-1],next:n+100}}const pD={fullbody_4wk:{duration:4,daysPerWeek:3},fullbody_8wk:{duration:8,daysPerWeek:3},fullbody_12wk:{duration:12,daysPerWeek:3},core_4wk:{duration:4,daysPerWeek:3},core_8wk:{duration:8,daysPerWeek:3},core_12wk:{duration:12,daysPerWeek:3},upper_4wk:{duration:4,daysPerWeek:3},lower_4wk:{duration:4,daysPerWeek:3}},gD={fullbody_4wk:["Push Focus","Pull Focus","Legs & Core"],fullbody_8wk:["Strength","Power","Endurance"],fullbody_12wk:["Upper Push","Lower Body","Upper Pull"],core_4wk:["Abs","Stability","Power Core"],core_8wk:["Anti-Extension","Rotation","Power"],core_12wk:["Strength","Endurance","Power"],upper_4wk:["Push","Pull","Mixed"],lower_4wk:["Quad Dominant","Hamstring & Glute","Power & Stability"]},zp=[{text:"You have 24 hours a day...",bold:"make it count"},{text:"Discipline beats motivation...",bold:"every single time"},{text:"Rest when you're done,",bold:"not when you're tired"},{text:"Small daily gains...",bold:"create massive results"},{text:"Your body keeps score,",bold:"train it well"},{text:"Consistency over intensity...",bold:"always wins"},{text:"The only bad workout...",bold:"is the one you skipped"}];function qp(n){if(!n)return"";const e=n instanceof Date?n:n.toDate?n.toDate():new Date(n),t=Math.floor((new Date-e)/1e3);return t<60?"just now":t<3600?`${Math.floor(t/60)}m ago`:t<86400?`${Math.floor(t/3600)}h ago`:t<604800?`${Math.floor(t/86400)}d ago`:e.toLocaleDateString("en-GB",{day:"numeric",month:"short"})}function Xc(n){if(!n)return"?";const e=n.trim().split(/\s+/);return e.length===1?e[0][0].toUpperCase():(e[0][0]+e[e.length-1][0]).toUpperCase()}function yD(n,e=800){return new Promise(t=>{const i=new Image;i.onload=()=>{const l=document.createElement("canvas");let u=i.width,d=i.height;u>d?u>e&&(d=Math.round(d*e/u),u=e):d>e&&(u=Math.round(u*e/d),d=e),l.width=u,l.height=d,l.getContext("2d").drawImage(i,0,0,u,d),l.toBlob(p=>t(p),"image/jpeg",.8)},i.src=URL.createObjectURL(n)})}function bD(){const{currentUser:n,isClient:e,clientData:t,logout:i,updateClientData:l,loading:u}=Mr(),{isDark:d,toggleTheme:p}=ka(),{isPremium:g}=wm(),y=$n(),[w,j]=v.useState({hours:0,minutes:0,seconds:0}),[T,V]=v.useState(0),[W,F]=v.useState(0),[U,ne]=v.useState(""),[Y,oe]=v.useState(0),[be,Le]=v.useState(0),[Ce,R]=v.useState(!1),[E,A]=v.useState({protein:0,carbs:0,fats:0,calories:0}),[O,D]=v.useState(null),[H,M]=v.useState(0),[We,gt]=v.useState(null),[$,me]=v.useState(!1),[Ve,Ke]=v.useState(!1),[J,L]=v.useState(0),[se,Me]=v.useState(0),[De,Je]=v.useState([]),[Fe,bt]=v.useState([]),[kt,nt]=v.useState(null),[Wt,ts]=v.useState(!1),St=v.useRef(null),[at,ce]=v.useState([]),[Xt,Gt]=v.useState(null),[rt,pt]=v.useState(null),it=v.useRef(null),[st,Kt]=v.useState(0),[Ks,Ps]=v.useState(0),[ss,Ct]=v.useState(0),[Jt,vs]=v.useState(0),[Bt,As]=v.useState(null),ue=v.useCallback((I,Z="info")=>{As({message:I,type:Z}),setTimeout(()=>As(null),4e3)},[]),[Ee,Ae]=v.useState([]),[ee,ge]=v.useState(!1),[we,Oe]=v.useState(""),[Ue,$e]=v.useState(null),[ft,jt]=v.useState(null),[Q,fe]=v.useState(!1),[lt,At]=v.useState(new Set),[Tt,ns]=v.useState(new Set),[Ut,Ot]=v.useState({}),[Ls,Js]=v.useState({}),[os,Ss]=v.useState({}),[Os,q]=v.useState({}),[xe,je]=v.useState({}),[Te,_e]=v.useState({}),ct=v.useRef(null),ht=v.useRef(null),et=v.useRef({}),[vt,Rt]=v.useState([]),[js,mn]=v.useState(!1),ln=v.useRef(null),[_n,kn]=v.useState([]),[fn,Fs]=v.useState(""),[k,S]=v.useState(!1),[P,B]=v.useState(null),[de,Be]=v.useState([]),[ze,Qe]=v.useState(null),[Xe,qt]=v.useState(!1),xs=v.useRef(!1),ls=(()=>{const I=[{selector:".cb-ring-container",title:"Your 24-Hour Countdown",body:"Every day resets. This ring tracks the time you have left  tap your photo to personalise your profile.",cta:"Next"},{selector:".cb-stats-row",title:"Progress at a Glance",body:"Programme completion, workouts this week, and daily habits  all in one row. These fill up as you go."},{selector:".cb-nudge-card",title:"Smart Suggestions",body:"We'll highlight what needs your attention  your next session, unfinished habits, or a meal to log."},{selector:".cb-card-workouts-hero",title:"Workouts",body:"Quick randomiser sessions or structured programmes  pick your focus, level and time.",cta:"Next"}];return g&&I.push({selector:".cb-card-nutrition",title:"Nutrition Tracking",body:"Set your macro targets, scan barcodes, and log meals to hit your daily goals."},{selector:".cb-card-consistency",title:"Daily Habits",body:"5 simple habits each day  train, hit protein, 10k steps, sleep, and hydrate. Build your streak."},{selector:".cb-card-buddies",title:"Buddies & Social",body:"Connect with other members, share your journey, and keep each other accountable."},{selector:".cb-journey-section",title:"Share Your Journey",body:"Post photos, updates, and milestones  your fitness journey in one place. Like and comment on each other's posts."},{selector:".cb-achievements-section",title:"Achievements",body:"Every rep counts towards badges  volume milestones, workout streaks, and more to unlock."}),I.push({selector:".block-bottom-nav",title:"You're All Set!",body:"Use the nav bar to jump between your profile, workouts, nutrition, and buddies. Time to get after it.",cta:"Let's Go!"}),I})();v.useEffect(()=>{!u&&!n&&y("/")},[u,n,y]),v.useEffect(()=>{!u&&t&&t.signupSource==="self_signup"&&!t.onboardingComplete&&y("/onboarding")},[u,t,y]),v.useEffect(()=>{let I=t?.tourComplete||xs.current;if(!I&&t?.id)try{I=!!localStorage.getItem(`tourDone_${t.id}`)}catch{}if(Ce&&t&&!I){const Z=setTimeout(()=>qt(!0),600);return()=>clearTimeout(Z)}},[Ce,t]),v.useEffect(()=>{if(t)try{const I=sessionStorage.getItem(`cbDash_${t.id}`);if(I){const Z=JSON.parse(I);F(Z.programmePct??0),ne(Z.programmeName??""),oe(Z.totalWorkouts??0),Le(Z.habitWeekPct??0),A(Z.nutritionTotals??{protein:0,carbs:0,fats:0,calories:0}),D(Z.nutritionTargetData??null),M(Z.todayHabitsCount??0),gt(Z.nextSession??null),me(Z.hasProgramme??!1),Ke(Z.programmeComplete??!1),L(Z.weeklyWorkouts??0),Me(Z.pbCount??0),Je(Z.topPBs??[]),bt(Z.leaderboardTop3??[]),ce(Z.unlockedBadges??[]),it.current=Z.unlockedBadges??[],Kt(Z.streakWeeks??0),R(!0)}}catch{}},[t]),v.useEffect(()=>{t?.photoURL&&nt(t.photoURL)},[t]),v.useEffect(()=>{if(!t)return;const I=Ds(zt(pe,"notifications"),hs("toId","==",t.id)),Z=vk(I,Ne=>{const Ze=Ne.docs.map(_t=>({id:_t.id,..._t.data()}));Ze.sort((_t,Dt)=>{const ot=_t.createdAt?.toMillis?.()||0;return(Dt.createdAt?.toMillis?.()||0)-ot}),Rt(Ze.slice(0,50))},Ne=>{console.error("Notification listener error:",Ne),Ne.code==="permission-denied"&&console.warn("Firestore rules may be missing for the notifications collection. Please update your Firestore rules in the Firebase Console.")});return()=>Z()},[t]),v.useEffect(()=>{const I=Z=>{ln.current&&!ln.current.contains(Z.target)&&mn(!1)};return document.addEventListener("mousedown",I),()=>document.removeEventListener("mousedown",I)},[]),v.useEffect(()=>{if(!t)return;const I=t.id;(async()=>{try{const[Z,Ne,Ze]=await Promise.all([Es(Ds(zt(pe,"buddies"),hs("user1","==",I))),Es(Ds(zt(pe,"buddies"),hs("user2","==",I))),Es(zt(pe,"clients"))]),_t=new Set;[...Z.docs,...Ne.docs].forEach(ot=>{const Vt=ot.data();_t.add(Vt.user1===I?Vt.user2:Vt.user1)});const Dt={};Ze.docs.forEach(ot=>{Dt[ot.id]=ot.data()}),kn(Array.from(_t).filter(ot=>Dt[ot]).map(ot=>({id:ot,name:Dt[ot].name,photoURL:Dt[ot].photoURL||null})))}catch(Z){console.error("Error loading buddies for mentions:",Z)}})()},[t]);const cs=vt.filter(I=>!I.read).length,Cs=async()=>{const I=vt.filter(Ne=>!Ne.read);if(!I.length)return;const Z=m2(pe);I.forEach(Ne=>Z.update(He(pe,"notifications",Ne.id),{read:!0})),await Z.commit()},K=async()=>{if(!vt.length)return;const I=m2(pe);vt.forEach(Z=>I.delete(He(pe,"notifications",Z.id))),await I.commit()},ve=async(I,Z,Ne={})=>{if(!(!t||I===t.id))try{await hi(zt(pe,"notifications"),{toId:I,fromId:t.id,fromName:t.name||"Someone",fromPhotoURL:t.photoURL||null,type:Z,read:!1,createdAt:Hr(),...Ne})}catch(Ze){console.error("Notification create error:",Ze),Ze.code==="permission-denied"&&ue("Notifications blocked  check Firestore rules","error")}},te=(I,Z)=>{const Ne=Z==="compose"?ct.current?.selectionStart:null,_t=(Ne!=null?I.slice(0,Ne):I).match(/@(\w*)$/);if(_t){S(!0),B(Z),Fs(_t[1].toLowerCase());const Dt=_n.filter(ot=>ot.name&&ot.name.toLowerCase().includes(_t[1].toLowerCase())).slice(0,5);Be(Dt)}else S(!1),Be([])},qe=(I,Z)=>{if(Z==="compose"){const Ne=ct.current,Ze=we,_t=Ne?.selectionStart??Ze.length,Dt=Ze.slice(0,_t),ot=Ze.slice(_t),Vt=Dt.replace(/@\w*$/,`@${I.name} `);Oe(Vt+ot),setTimeout(()=>{Ne?.focus(),Ne.selectionStart=Ne.selectionEnd=Vt.length},0)}else{const Ze=(Ls[Z]||"").replace(/@\w*$/,`@${I.name} `);Js(_t=>({..._t,[Z]:Ze}))}S(!1),Be([])},Ge=I=>I&&I.split(/(@\w[\w\s]*?\s)/g).map((Ne,Ze)=>Ne.startsWith("@")&&_n.some(_t=>Ne.trim()===`@${_t.name}`)?r.jsx("span",{className:"mention-highlight",children:Ne.trim()},Ze):Ne),ut=async I=>{const Z=I.target.files?.[0];if(!(!Z||!t)){if(!Z.type.startsWith("image/")){ue("Please select an image file","error");return}if(Z.size>5*1024*1024){ue("Image must be under 5MB","error");return}ts(!0);try{const Ne=await new Promise(Dt=>{const ot=new Image;ot.onload=()=>{const Vt=document.createElement("canvas"),Ht=400;let as=ot.width,Ft=ot.height;as>Ft?(Ft=Ft/as*Ht,as=Ht):(as=as/Ft*Ht,Ft=Ht),Vt.width=as,Vt.height=Ft,Vt.getContext("2d").drawImage(ot,0,0,as,Ft),Vt.toBlob(_s=>Dt(_s),"image/jpeg",.75)},ot.src=URL.createObjectURL(Z)}),Ze=eo(to,`profilePhotos/${t.id}`);await Up(Ze,Ne);const _t=await qo(Ze);await Ma(He(pe,"clients",t.id),{photoURL:_t}),nt(_t),l({photoURL:_t}),ue("Profile photo updated!","success")}catch(Ne){console.error("Photo upload error:",Ne),ue("Failed to upload photo","error")}ts(!1),St.current&&(St.current.value="")}};v.useEffect(()=>{const I=()=>{const Ne=new Date,Ze=new Date(Ne);Ze.setHours(23,59,59,999);const _t=Ze-Ne,Dt=Math.floor(_t/(1e3*60*60)),ot=Math.floor(_t%(1e3*60*60)/(1e3*60)),Vt=Math.floor(_t%(1e3*60)/1e3);j({hours:Dt,minutes:ot,seconds:Vt}),V(60-Vt)};I();const Z=setInterval(I,1e3);return()=>clearInterval(Z)},[]),v.useEffect(()=>{const I=setInterval(()=>{vs(Z=>(Z+1)%zp.length)},8e3);return()=>clearInterval(I)},[]),v.useEffect(()=>{if(!n||!t)return;(async()=>{let Z=null,Ne=0,Ze=[],_t=!1,Dt=null;try{const ot=Qc(new Date),Vt=await Rs(He(pe,"clientProgrammes",t.id));if(Vt.exists()){const rr=Vt.data(),gn=pD[rr.templateId];if(me(!0),gn){const hr=rr.completedSessions||{},Tr=Object.keys(hr).length,Ha=gn.duration*gn.daysPerWeek;F(Ha>0?Math.round(Tr/Ha*100):0);const tl=rr.templateId.replace(/_/g," ").replace(/\b\w/g,ia=>ia.toUpperCase());ne(tl);const sl=gD[rr.templateId];let mr=!1;for(let ia=1;ia<=gn.duration&&!mr;ia++)for(let oa=0;oa<gn.daysPerWeek&&!mr;oa++)hr[`w${ia}d${oa}`]||(gt({week:ia,dayIdx:oa,label:sl?.[oa]||`Day ${oa+1}`}),mr=!0);mr||(Ke(!0),_t=!0)}}const Ht=zt(pe,"workoutLogs"),as=Ds(Ht,hs("clientId","==",t.id));Z=await Es(as),oe(Z.docs.length);const Ft=new Date,_s=Ft.getDay(),Fn=_s===0?6:_s-1,ur=new Date(Ft);ur.setDate(Ft.getDate()-Fn),ur.setHours(0,0,0,0);const Zs=ur.getTime(),Ys=Z.docs.filter(rr=>{const gn=rr.data().completedAt;return gn?(gn.toDate?gn.toDate().getTime():new Date(gn).getTime())>=Zs:!1}).length;L(Ys);const zn=zt(pe,"habitLogs"),dn=Ds(zn,hs("clientId","==",t.id),hs("date","==",ot)),On=await Es(dn);let nr=0;if(!On.empty){const rr=On.docs[0].data().habits||{};nr=Object.values(rr).filter(Boolean).length}Le(Math.round(nr/Wi*100)),M(nr);const Kn=await Rs(He(pe,"nutritionTargets",t.id));Kn.exists()&&(D(Kn.data()),Dt=Kn.data());const dr=await Rs(He(pe,"nutritionLogs",`${t.id}_${ot}`));if(dr.exists()){const gn=(dr.data().entries||[]).reduce((hr,Tr)=>({protein:hr.protein+(Tr.protein||0),carbs:hr.carbs+(Tr.carbs||0),fats:hr.fats+(Tr.fats||0),calories:hr.calories+(Tr.calories||0)}),{protein:0,carbs:0,fats:0,calories:0});A(gn)}}catch(ot){console.error("Error loading dashboard stats:",ot)}try{let ot=[];const Vt=await Rs(He(pe,"coreBuddyPBs",t.id));if(Vt.exists()){const Ht=Vt.data().exercises||{};Me(Object.keys(Ht).length),Ne=Object.keys(Ht).length,ot=Object.entries(Ht).sort(([,as],[,Ft])=>(Ft.weight||0)-(as.weight||0)).slice(0,3).map(([as,Ft])=>({name:as,weight:Ft.weight,reps:Ft.reps}))}Ze=ot,Je(ot)}catch(ot){console.error("PB fetch error:",ot)}try{const ot=zt(pe,"clients"),Vt=Ds(ot,hs("leaderboardOptIn","==",!0)),as=(await Es(Vt)).docs.map(Ft=>({id:Ft.id,name:Ft.data().name,photoURL:Ft.data().photoURL||null}));bt(as.slice(0,3))}catch(ot){console.error("Leaderboard preview error:",ot)}try{let ot=0;if(Z){const Zs=Z.docs.map(Ys=>Ys.data().date).filter(Boolean).sort().reverse();if(Zs.length>0){const Ys=new Date;let zn=new Date(Ys);e:for(let dn=0;dn<52;dn++){const On=new Date(zn),nr=On.getDay(),Kn=nr===0?6:nr-1;On.setDate(On.getDate()-Kn),On.setHours(0,0,0,0);const dr=new Date(On);dr.setDate(dr.getDate()+7);const rr=Qc(On),gn=Qc(dr);if(Zs.some(Tr=>Tr>=rr&&Tr<gn))ot++;else{if(dn>0)break e;break}zn.setDate(zn.getDate()-7)}}}Kt(ot);let Vt=0;for(let Zs=0;Zs<30;Zs++){const Ys=new Date;Ys.setDate(Ys.getDate()-Zs);const zn=Qc(Ys);try{const dn=await Es(Ds(zt(pe,"habitLogs"),hs("clientId","==",t.id),hs("date","==",zn)));if(dn.empty)break;{const On=dn.docs[0].data().habits||{};if(Object.values(On).filter(Boolean).length>=Wi)Vt++;else break}}catch{break}}Ps(Vt);let Ht=0;for(let Zs=0;Zs<30;Zs++){const Ys=new Date;Ys.setDate(Ys.getDate()-Zs);const zn=Qc(Ys);try{const dn=await Rs(He(pe,"nutritionLogs",`${t.id}_${zn}`));if(dn.exists()&&(dn.data().entries||[]).length>0)if(Dt){const nr=(dn.data().entries||[]).reduce((Kn,dr)=>({protein:Kn.protein+(dr.protein||0),carbs:Kn.carbs+(dr.carbs||0),fats:Kn.fats+(dr.fats||0)}),{protein:0,carbs:0,fats:0});if(nr.protein>=(Dt.protein||0)&&nr.carbs>=(Dt.carbs||0)&&nr.fats>=(Dt.fats||0))Ht++;else break}else Ht++;else break}catch{break}}Ct(Ht);const as=Z?Z.docs.length:0,Ft=[],_s=Zs=>Ft.push(Zs);as>=1&&_s("first_workout"),as>=10&&_s("workouts_10"),as>=25&&_s("workouts_25"),as>=50&&_s("workouts_50"),as>=100&&_s("workouts_100"),ot>=2&&_s("streak_2"),ot>=4&&_s("streak_4"),ot>=8&&_s("streak_8"),Ne>=1&&_s("first_pb"),Ne>=5&&_s("pbs_5"),Ne>=10&&_s("pbs_10"),Ne>=100&&_s("pbs_100"),Ht>=7&&_s("nutrition_7"),t.leaderboardOptIn&&_s("leaderboard_join"),Vt>=7&&_s("habits_7"),ce(Ft);const Fn=it.current;if(Fn!==null){const Zs=Ft.filter(Ys=>!Fn.includes(Ys));if(Zs.length>0){const Ys=mu.find(zn=>zn.id===Zs[Zs.length-1]);Ys&&setTimeout(()=>pt(Ys),600)}}it.current=Ft;const ur={};Ft.forEach(Zs=>{ur[Zs]={unlockedAt:new Date().toISOString()}}),Ns(He(pe,"achievements",t.id),{badges:ur,progress:{streakWeeks:ot,pbCount:Ne,nutritionStreak:Ht,habitStreak:Vt},updatedAt:new Date().toISOString()},{merge:!0}).catch(()=>{})}catch(ot){console.error("Achievement computation error:",ot)}R(!0)})()},[n,t]),v.useEffect(()=>{if(!(!Ce||!t))try{sessionStorage.setItem(`cbDash_${t.id}`,JSON.stringify({programmePct:W,programmeName:U,totalWorkouts:Y,habitWeekPct:be,nutritionTotals:E,nutritionTargetData:O,todayHabitsCount:H,nextSession:We,hasProgramme:$,programmeComplete:Ve,weeklyWorkouts:J,pbCount:se,topPBs:De,leaderboardTop3:Fe,unlockedBadges:at,streakWeeks:st}))}catch{}},[Ce,W,U,Y,be,E,O,H,We,$,Ve,J,se,De,Fe,at,st,t]);const wt=v.useCallback(async()=>{if(xs.current=!0,qt(!1),l({tourComplete:!0}),t?.id){try{localStorage.setItem(`tourDone_${t.id}`,"1")}catch{}try{await Ma(He(pe,"clients",t.id),{tourComplete:!0})}catch(I){console.error("Failed to save tour completion:",I)}}},[t,l]),Mt=I=>{const Z=I.currentTarget,Ne=Z.querySelector(".ripple");Ne&&Ne.remove();const Ze=Z.getBoundingClientRect(),_t=Math.max(Ze.width,Ze.height),Dt=I.clientX-Ze.left-_t/2,ot=I.clientY-Ze.top-_t/2,Vt=document.createElement("span");Vt.className="ripple",Vt.style.cssText=`width:${_t}px;height:${_t}px;left:${Dt}px;top:${ot}px;`,Z.appendChild(Vt),setTimeout(()=>Vt.remove(),600)},ws=t?.name?.split(" ")[0]||"there",{prev:cn,next:ms}=fD(Y),Wn=ms>cn?Math.round((Y-cn)/(ms-cn)*100):100,Gr=[{label:"Programme",value:`${W}%`,pct:W,color:"#14b8a6",size:"normal"},{label:"Workouts",value:`${Y}`,pct:Wn,color:"var(--color-primary)",size:"large"},{label:"Habits Today",value:`${be}%`,pct:be,color:"#38B6FF",size:"normal"}],pn=I=>!O||!O[I]?0:Math.min(Math.round(E[I]/O[I]*100),100),ja=(()=>{const I=new Date().getHours();return Ce&&H>=Wi&&E.calories>0?{main:"Smashed it today,",sub:"Rest up and go again tomorrow."}:I>=5&&I<12?{main:"Rise and grind,",sub:"let's get after it!"}:I>=12&&I<17?{main:"Oye",sub:"crack on and make it count!"}:I>=17&&I<21?{main:"Evening session?",sub:"Let's finish strong!"}:{main:"Burning the midnight oil,",sub:"Respect the hustle!"}})(),Un=Ce?$&&We&&!Ve?{label:"NEXT SESSION",message:`Week ${We.week}, Day ${We.dayIdx+1}  ${We.label}`,cta:"Continue",action:()=>y("/client/core-buddy/programmes"),pct:W,ringLabel:`${W}%`}:H<Wi?{label:"DAILY HABITS",message:`${H}/${Wi} completed`,cta:"Open Habits",action:()=>y("/client/core-buddy/consistency"),pct:be,ringLabel:`${H}/${Wi}`}:E.calories===0?{label:"NUTRITION",message:"No meals logged today",cta:"Log Meal",action:()=>y("/client/core-buddy/nutrition"),pct:0,ringLabel:"0"}:$?Ve?{label:"COMPLETE",message:"Programme finished!",cta:"New Programme",action:()=>y("/client/core-buddy/workouts"),pct:100,ringLabel:"100%"}:{label:"TODAY",message:"You're crushing it!",cta:null,action:null,pct:100,ringLabel:""}:{label:"PROGRAMMES",message:"Start a programme to level up",cta:"Browse",action:()=>y("/client/core-buddy/workouts"),pct:0,ringLabel:""}:null,is=v.useCallback(async()=>{if(t){ge(!0);try{const I=await Es(Ds(zt(pe,"posts"),hs("authorId","==",t.id),Gh("createdAt","desc"),Kh(30)));Ae(I.docs.map(Ne=>({id:Ne.id,...Ne.data()})));const Z=await Es(Ds(zt(pe,"postLikes"),hs("userId","==",t.id)));At(new Set(Z.docs.map(Ne=>Ne.data().postId)))}catch(I){console.error("Error loading journey:",I)}finally{ge(!1)}}},[t]);v.useEffect(()=>{Ce&&t&&is()},[Ce,t,is]);const un=I=>{const Z=I.target.files?.[0];if(Z){if(!Z.type.startsWith("image/")){ue("Please select an image file","error");return}if(Z.size>10*1024*1024){ue("Image must be under 10MB","error");return}$e(Z),jt(URL.createObjectURL(Z))}},sr=()=>{$e(null),ft&&URL.revokeObjectURL(ft),jt(null),ht.current&&(ht.current.value="")},Gn=async()=>{if(!(!we.trim()&&!Ue||Q||!t)){fe(!0);try{let I=null;if(Ue){const Ze=await yD(Ue),_t=`${Date.now()}_${Math.random().toString(36).slice(2,8)}`,Dt=eo(to,`postImages/${t.id}/${_t}`);await Up(Dt,Ze),I=await qo(Dt)}await hi(zt(pe,"posts"),{authorId:t.id,authorName:t.name||"Unknown",authorPhotoURL:t.photoURL||null,content:we.trim(),type:I?"image":"text",imageURL:I||null,createdAt:Hr(),likeCount:0,commentCount:0});const Ne=we.trim().match(/@[\w\s]+?(?=\s@|\s*$|[.,!?])/g);if(Ne){const Ze=new Set;Ne.forEach(_t=>{const Dt=_t.slice(1).trim(),ot=_n.find(Vt=>Vt.name&&Vt.name.toLowerCase()===Dt.toLowerCase());ot&&!Ze.has(ot.id)&&(Ze.add(ot.id),ve(ot.id,"mention",{}))})}Oe(""),sr(),ct.current&&(ct.current.style.height="auto"),await is(),ue("Posted!","success")}catch(I){console.error("Error posting:",I),ue(I?.message||"Failed to post","error")}finally{fe(!1)}}},_r=async I=>{if(window.confirm("Delete this post?"))try{await yr(He(pe,"posts",I)),Ae(Z=>Z.filter(Ne=>Ne.id!==I)),ue("Post deleted","info")}catch(Z){console.error("Delete error:",Z),ue("Failed to delete","error")}},tn=async I=>{if(!t)return;const Z=t.id,Ne=`${I}_${Z}`,Ze=lt.has(I),_t=new Set(lt);Ze?_t.delete(I):_t.add(I),At(_t),Ae(Dt=>Dt.map(ot=>ot.id===I?{...ot,likeCount:Math.max(0,(ot.likeCount||0)+(Ze?-1:1))}:ot));try{if(Ze)await yr(He(pe,"postLikes",Ne)),await Ma(He(pe,"posts",I),{likeCount:Bo(-1)});else{await Ns(He(pe,"postLikes",Ne),{postId:I,userId:Z,createdAt:Hr()}),await Ma(He(pe,"posts",I),{likeCount:Bo(1)});const Dt=Ee.find(ot=>ot.id===I);Dt&&ve(Dt.authorId,"like",{postId:I})}}catch(Dt){console.error("Like error:",Dt),is()}},Ln=async I=>{try{const Z=await Es(Ds(zt(pe,"postComments"),hs("postId","==",I),Gh("createdAt","asc"),Kh(50)));Ot(Ne=>({...Ne,[I]:Z.docs.map(Ze=>({id:Ze.id,...Ze.data()}))}))}catch(Z){console.error("Error loading comments:",Z)}},Sn=I=>{const Z=new Set(Tt);Z.has(I)?Z.delete(I):(Z.add(I),Ut[I]||Ln(I)),ns(Z)},kr=async I=>{const Z=(Ls[I]||"").trim(),Ne=xe[I];if(!(!Z&&!Ne||!t)){Ss(Ze=>({...Ze,[I]:!0}));try{let Ze=null;if(Ne){const Ht=eo(to,`comment-images/${Date.now()}_${Ne.name}`);await Up(Ht,Ne),Ze=await qo(Ht)}const _t={postId:I,authorId:t.id,authorName:t.name||"Unknown",authorPhotoURL:t.photoURL||null,content:Z||"",createdAt:Hr()};Ze&&(_t.imageURL=Ze);const Dt=Os[I];Dt&&(_t.replyToId=Dt.id,_t.replyToName=Dt.authorName),await hi(zt(pe,"postComments"),_t),await Ma(He(pe,"posts",I),{commentCount:Bo(1)});const ot=Ee.find(Ht=>Ht.id===I);ot&&ve(ot.authorId,"comment",{postId:I});const Vt=Z.match(/@[\w\s]+?(?=\s@|\s*$|[.,!?])/g);if(Vt){const Ht=new Set;Vt.forEach(as=>{const Ft=as.slice(1).trim(),_s=_n.find(Fn=>Fn.name&&Fn.name.toLowerCase()===Ft.toLowerCase());_s&&!Ht.has(_s.id)&&(Ht.add(_s.id),ve(_s.id,"mention",{postId:I}))})}Js(Ht=>({...Ht,[I]:""})),je(Ht=>({...Ht,[I]:null})),_e(Ht=>({...Ht,[I]:null})),q(Ht=>({...Ht,[I]:null})),et.current[I]&&(et.current[I].value=""),Ae(Ht=>Ht.map(as=>as.id===I?{...as,commentCount:(as.commentCount||0)+1}:as)),await Ln(I)}catch(Ze){console.error("Comment error:",Ze),ue("Failed to comment","error")}finally{Ss(Ze=>({...Ze,[I]:!1}))}}},jr=async(I,Z)=>{try{await yr(He(pe,"postComments",Z)),await Ma(He(pe,"posts",I),{commentCount:Bo(-1)}),Ot(Ne=>({...Ne,[I]:(Ne[I]||[]).filter(Ze=>Ze.id!==Z)})),Ae(Ne=>Ne.map(Ze=>Ze.id===I?{...Ze,commentCount:Math.max((Ze.commentCount||1)-1,0)}:Ze))}catch(Ne){console.error("Delete comment error:",Ne),ue("Failed to delete comment","error")}},Dr=(I,Z)=>{const Ne=Z.target.files?.[0];if(!Ne)return;if(Ne.size>5*1024*1024){ue("Image must be under 5MB","error");return}je(_t=>({..._t,[I]:Ne}));const Ze=new FileReader;Ze.onload=_t=>_e(Dt=>({...Dt,[I]:_t.target.result})),Ze.readAsDataURL(Ne)},wi=I=>{je(Z=>({...Z,[I]:null})),_e(Z=>({...Z,[I]:null})),et.current[I]&&(et.current[I].value="")},Ta=I=>{Oe(I.target.value),I.target.style.height="auto",I.target.style.height=Math.min(I.target.scrollHeight,120)+"px",te(I.target.value,"compose")},Pr=(I,Z)=>{Js(Ne=>({...Ne,[I]:Z})),te(Z,I)};return r.jsx(xa,{children:r.jsxs("div",{className:"cb-dashboard","data-theme":d?"dark":"light",children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsxs("div",{className:"header-notif-wrap",ref:ln,children:[r.jsxs("button",{className:"header-notif-btn",onClick:()=>{mn(!js),js||Cs()},"aria-label":"Notifications",children:[r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"}),r.jsx("path",{d:"M13.73 21a2 2 0 0 1-3.46 0"})]}),cs>0&&r.jsx("span",{className:"header-notif-badge",children:cs>9?"9+":cs})]}),js&&r.jsxs("div",{className:"notif-panel",children:[r.jsxs("div",{className:"notif-panel-header",children:[r.jsx("span",{className:"notif-panel-title",children:"Notifications"}),vt.length>0&&r.jsx("button",{className:"notif-clear-btn",onClick:K,children:"Clear all"})]}),r.jsx("div",{className:"notif-panel-list",children:vt.length===0?r.jsx("div",{className:"notif-empty",children:"No notifications yet"}):vt.map(I=>r.jsxs("div",{className:`notif-item${I.read?"":" unread"}`,onClick:()=>{if(mn(!1),I.type==="buddy_request"||I.type==="buddy_accept")y("/client/core-buddy/buddies");else if((I.type==="like"||I.type==="comment")&&I.postId){if(!Tt.has(I.postId)){const Z=new Set(Tt);Z.add(I.postId),ns(Z),Ut[I.postId]||Ln(I.postId)}setTimeout(()=>{const Z=document.getElementById(`post-${I.postId}`);Z&&Z.scrollIntoView({behavior:"smooth",block:"center"})},150)}else I.type==="like"||I.type==="comment"?document.querySelector(".cb-journey-section")?.scrollIntoView({behavior:"smooth"}):I.type==="mention"&&y(`/client/core-buddy/profile/${I.fromId}`)},children:[r.jsx("div",{className:"notif-item-avatar",children:I.fromPhotoURL?r.jsx("img",{src:I.fromPhotoURL,alt:""}):r.jsx("span",{children:(I.fromName||"?")[0]})}),r.jsxs("div",{className:"notif-item-body",children:[r.jsxs("p",{className:"notif-item-text",children:[r.jsx("strong",{children:I.fromName})," ",I.type==="buddy_request"&&"sent you a buddy request",I.type==="buddy_accept"&&"accepted your buddy request",I.type==="like"&&"liked your post",I.type==="comment"&&"commented on your post",I.type==="mention"&&"mentioned you"]}),r.jsx("span",{className:"notif-item-time",children:qp(I.createdAt)})]})]},I.id))})]})]}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsxs("div",{className:"header-actions",children:[r.jsx("button",{onClick:p,"aria-label":"Toggle theme",children:d?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})}),r.jsx("button",{onClick:i,"aria-label":"Log out",children:r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),r.jsx("polyline",{points:"16 17 21 12 16 7"}),r.jsx("line",{x1:"21",y1:"12",x2:"9",y2:"12"})]})})]})]})}),r.jsxs("main",{className:"cb-main",children:[r.jsxs("div",{className:"cb-ring-container",children:[r.jsxs("div",{className:"cb-ring",children:[r.jsx("svg",{className:"cb-ring-svg",viewBox:"0 0 200 200",children:Jy.map((I,Z)=>{const Ne=Z<T;return r.jsx("line",{x1:I.x1,y1:I.y1,x2:I.x2,y2:I.y2,className:`ring-tick ${Ne?"elapsed":"remaining"}`,strokeWidth:I.thick?"3":"2"},Z)})}),r.jsxs("div",{className:"cb-ring-center",children:[r.jsxs("div",{className:"cb-ring-logo",onClick:()=>St.current?.click(),role:"button",tabIndex:0,"aria-label":"Change profile photo",children:[r.jsx("img",{src:kt||"/Logo.webp",alt:kt?"Profile":"Mind Core Fitness"}),r.jsx("div",{className:`cb-photo-overlay${Wt?" uploading":""}`,children:Wt?r.jsx("div",{className:"cb-photo-spinner"}):r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"#fff",strokeWidth:"2",children:[r.jsx("path",{d:"M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"}),r.jsx("circle",{cx:"12",cy:"13",r:"4"})]})}),r.jsx("input",{ref:St,type:"file",accept:"image/*",onChange:ut,style:{display:"none"}})]}),!kt&&!Wt&&r.jsx("div",{className:"cb-photo-badge",onClick:()=>St.current?.click(),children:r.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"#fff",strokeWidth:"2.5",children:[r.jsx("path",{d:"M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"}),r.jsx("circle",{cx:"12",cy:"13",r:"4"})]})})]})]}),r.jsxs("div",{className:"cb-ring-countdown",children:[r.jsx("span",{className:"cb-timer-digit",children:String(w.hours).padStart(2,"0")}),r.jsx("span",{className:"cb-timer-colon",children:":"}),r.jsx("span",{className:"cb-timer-digit",children:String(w.minutes).padStart(2,"0")}),r.jsx("span",{className:"cb-timer-colon",children:":"}),r.jsx("span",{className:"cb-timer-digit cb-timer-seconds",children:String(w.seconds).padStart(2,"0")})]}),r.jsx("span",{className:"cb-ring-label",children:"remaining today"}),r.jsxs("p",{className:"cb-ring-tagline",children:[zp[Jt].text," ",r.jsx("strong",{children:zp[Jt].bold})]},Jt)]}),r.jsx("div",{className:"cb-stats-row",children:Gr.map(I=>{const Z=(I.size==="large",38),Ne=2*Math.PI*Z,Ze=Ne-I.pct/100*Ne;return r.jsxs("div",{className:`cb-stat-item${I.size==="large"?" cb-stat-large":""}`,children:[r.jsxs("div",{className:"cb-stat-ring",children:[r.jsxs("svg",{viewBox:"0 0 100 100",children:[r.jsx("circle",{className:"cb-stat-track",cx:"50",cy:"50",r:Z}),r.jsx("circle",{className:"cb-stat-fill",cx:"50",cy:"50",r:Z,style:{stroke:I.color},strokeDasharray:Ne,strokeDashoffset:Ze})]}),r.jsx("span",{className:"cb-stat-value",style:{color:I.color},children:I.value})]}),r.jsx("span",{className:"cb-stat-label",children:I.label})]},I.label)})}),r.jsxs("p",{className:"cb-coach-msg",children:[ja.main," ",r.jsx("strong",{children:ws}),"  ",ja.sub]}),Un&&r.jsxs("button",{className:"cb-nudge-card",onClick:Un.action||void 0,style:Un.action?void 0:{cursor:"default"},children:[r.jsxs("div",{className:"cb-nudge-ring",children:[r.jsxs("svg",{viewBox:"0 0 100 100",children:[r.jsx("circle",{className:"cb-nudge-ring-track",cx:"50",cy:"50",r:"38"}),r.jsx("circle",{className:"cb-nudge-ring-fill",cx:"50",cy:"50",r:"38",strokeDasharray:2*Math.PI*38,strokeDashoffset:2*Math.PI*38-Un.pct/100*2*Math.PI*38})]}),r.jsx("span",{className:"cb-nudge-ring-val",children:Un.ringLabel})]}),r.jsxs("div",{className:"cb-nudge-info",children:[r.jsx("span",{className:"cb-nudge-label",children:Un.label}),r.jsx("span",{className:"cb-nudge-title",children:Un.message}),Un.cta&&r.jsxs("span",{className:"cb-nudge-cta",children:[Un.cta," "]})]})]}),r.jsxs("div",{className:"cb-features",children:[t?.buddyEnabled&&r.jsxs("button",{className:"cb-feature-card cb-card-buddy ripple-btn",onClick:I=>{Mt(I),y("/client/core-buddy/buddy")},children:[r.jsx("div",{className:"cb-buddy-icon",children:r.jsxs("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M12 2a4 4 0 0 1 4 4v2a4 4 0 0 1-8 0V6a4 4 0 0 1 4-4z"}),r.jsx("path",{d:"M18 14c2 1 3 3 3 5v2H3v-2c0-2 1-4 3-5"}),r.jsx("circle",{cx:"9",cy:"7",r:"0.5",fill:"currentColor"}),r.jsx("circle",{cx:"15",cy:"7",r:"0.5",fill:"currentColor"}),r.jsx("path",{d:"M9.5 10a2.5 2.5 0 0 0 5 0"}),r.jsx("path",{d:"M7 13c1.5 1 3.5 1.5 5 1.5s3.5-.5 5-1.5"})]})}),r.jsxs("div",{className:"cb-card-content",children:[r.jsxs("h3",{children:["Buddy ",r.jsx("span",{className:"cb-buddy-badge",children:"AI"})]}),r.jsx("p",{className:"cb-card-desc",children:"Your AI training partner"})]}),r.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})]}),r.jsxs("button",{className:`cb-feature-card cb-card-nutrition cb-card-has-preview ripple-btn${g?"":" cb-card-locked"}`,onClick:I=>{Mt(I),y(g?"/client/core-buddy/nutrition":"/upgrade")},children:[r.jsxs("div",{className:"cb-card-top-row",children:[r.jsx("div",{className:"cb-card-content",children:r.jsxs("h3",{children:["Today's Nutrition ",!g&&r.jsx("span",{className:"cb-premium-badge",children:"PREMIUM"})]})}),r.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})]}),r.jsx("div",{className:"cb-card-preview-row",children:r.jsx("div",{className:"cb-mini-rings",children:[{label:"P",pct:pn("protein"),color:"#14b8a6"},{label:"C",pct:pn("carbs"),color:"var(--color-primary)"},{label:"F",pct:pn("fats"),color:"#eab308"},{label:"Cal",pct:pn("calories"),color:"#38B6FF"}].map(I=>{const Ne=2*Math.PI*38,Ze=Ne-I.pct/100*Ne;return r.jsxs("div",{className:"cb-mini-ring",children:[r.jsxs("svg",{viewBox:"0 0 100 100",children:[r.jsx("circle",{className:"cb-mini-track",cx:"50",cy:"50",r:38}),r.jsx("circle",{className:"cb-mini-fill",cx:"50",cy:"50",r:38,style:{stroke:I.color},strokeDasharray:Ne,strokeDashoffset:Ze})]}),r.jsx("span",{style:{color:I.color},children:I.label})]},I.label)})})}),r.jsx("p",{className:"cb-card-desc",children:"Track macros, scan barcodes, log water"})]}),r.jsxs("button",{className:"cb-feature-card cb-card-workouts-hero ripple-btn",onClick:I=>{Mt(I),y("/client/core-buddy/workouts")},children:[r.jsx("h3",{className:"cb-hero-title",children:"Workouts"}),r.jsxs("div",{className:"cb-hero-stats",children:[r.jsxs("span",{children:[J," this week"]}),r.jsx("span",{className:"cb-hero-dot",children:""}),r.jsxs("span",{children:[Y," total"]})]}),r.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})]}),r.jsxs("div",{className:"cb-grid-row",children:[r.jsxs("button",{className:`cb-feature-card cb-grid-card cb-card-consistency ripple-btn${g?"":" cb-card-locked"}`,onClick:I=>{Mt(I),y(g?"/client/core-buddy/consistency":"/upgrade")},children:[r.jsxs("div",{className:"cb-card-content",children:[r.jsxs("h3",{children:["Habits ",!g&&r.jsx("span",{className:"cb-premium-badge",children:"PREMIUM"})]}),r.jsx("div",{className:"cb-habit-dots",children:Array.from({length:Wi},(I,Z)=>r.jsx("span",{className:`cb-habit-dot${Z<H?" done":""}`},Z))}),r.jsxs("span",{className:"cb-habit-dots-label",children:[H,"/",Wi," today"]})]}),r.jsx("svg",{className:"cb-card-arrow cb-grid-arrow",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})]}),r.jsxs("button",{className:`cb-feature-card cb-grid-card cb-card-progress ripple-btn${g?"":" cb-card-locked"}`,onClick:I=>{Mt(I),y(g?"/client/personal-bests?mode=corebuddy":"/upgrade")},children:[r.jsxs("div",{className:"cb-card-content",children:[r.jsxs("h3",{children:["PBs ",!g&&r.jsx("span",{className:"cb-premium-badge",children:"PREMIUM"})]}),De.length>0?r.jsx("div",{className:"cb-pb-preview",children:De.slice(0,2).map(I=>r.jsxs("div",{className:"cb-pb-entry",children:[r.jsx("span",{className:"cb-pb-name",children:I.name}),r.jsxs("span",{className:"cb-pb-value",children:[I.weight,"kg"]})]},I.name))}):r.jsxs("div",{className:"cb-progress-preview",children:[r.jsx("svg",{className:"cb-progress-icon",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M13 2L3 14h9l-1 8 10-12h-9l1-8z"})}),r.jsx("span",{children:"Start lifting!"})]})]}),r.jsx("svg",{className:"cb-card-arrow cb-grid-arrow",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})]})]}),r.jsxs("button",{className:`cb-feature-card cb-card-leaderboard ripple-btn${g?"":" cb-card-locked"}`,onClick:I=>{Mt(I),y(g?"/client/leaderboard":"/upgrade")},children:[r.jsxs("div",{className:"cb-card-content",children:[r.jsxs("h3",{children:["Leaderboard ",!g&&r.jsx("span",{className:"cb-premium-badge",children:"PREMIUM"})]}),Fe.length>0?r.jsx("div",{className:"cb-lb-preview",children:Fe.map((I,Z)=>{const Ne=["#FFD700","#A8B4C0","#CD7F32"][Z],Ze=I.name?I.name.split(" ").map(Dt=>Dt[0]).join("").slice(0,2).toUpperCase():"?",_t=I.id===t?.id;return r.jsxs("div",{className:`cb-lb-entry${_t?" cb-lb-me":""}`,children:[r.jsx("div",{className:"cb-lb-avatar",style:{borderColor:Ne},children:I.photoURL?r.jsx("img",{src:I.photoURL,alt:"",className:"cb-lb-avatar-img"}):r.jsx("span",{children:Ze})}),r.jsxs("span",{className:"cb-lb-rank",style:{color:Ne},children:["#",Z+1]})]},I.id)})}):r.jsx("p",{children:"Opt in to compete with your Core Buddies"})]}),r.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})]}),r.jsxs("button",{className:`cb-feature-card cb-card-buddies ripple-btn${g?"":" cb-card-locked"}`,onClick:I=>{Mt(I),y(g?"/client/core-buddy/buddies":"/upgrade")},children:[r.jsxs("div",{className:"cb-card-content",children:[r.jsxs("h3",{children:["Buddies ",!g&&r.jsx("span",{className:"cb-premium-badge",children:"PREMIUM"})]}),r.jsx("p",{children:"Connect with other members and track each other's progress"})]}),r.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})]}),r.jsxs("div",{className:`cb-achievements-section${g?"":" cb-card-locked"}`,children:[r.jsxs("h3",{className:"cb-achievements-title",children:["Achievements ",!g&&r.jsx("span",{className:"cb-premium-badge",children:"PREMIUM"})]}),g?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"cb-badges-scroll",children:mu.map(I=>{const Z=at.includes(I.id);return r.jsx("button",{className:`cb-badge${Z?" unlocked":" locked"}`,onClick:()=>Gt(I),children:r.jsx("img",{src:I.img,alt:I.name,className:"cb-badge-img"})},I.id)})}),r.jsxs("p",{className:"cb-badges-count",children:[at.length,"/",mu.length," unlocked"]})]}):r.jsxs("button",{className:"cb-upgrade-teaser",onClick:()=>y("/upgrade"),children:[r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),r.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}),r.jsx("span",{children:"Upgrade to unlock achievements"})]})]}),r.jsxs("div",{className:"cb-journey-section",children:[r.jsxs("h3",{className:"cb-journey-title",children:["My Journey ",!g&&r.jsx("span",{className:"cb-premium-badge",children:"PREMIUM"})]}),g?r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"journey-compose",children:[r.jsx("div",{className:"journey-compose-avatar",children:kt?r.jsx("img",{src:kt,alt:""}):r.jsx("span",{children:Xc(t?.name)})}),r.jsxs("div",{className:"journey-compose-body",style:{position:"relative"},children:[r.jsx("textarea",{ref:ct,placeholder:"Share your progress... (use @ to mention)",value:we,onChange:Ta,rows:1,maxLength:500}),k&&P==="compose"&&de.length>0&&r.jsx("div",{className:"mention-dropdown",children:de.map(I=>r.jsxs("button",{className:"mention-option",onClick:()=>qe(I,"compose"),children:[r.jsx("div",{className:"mention-option-avatar",children:I.photoURL?r.jsx("img",{src:I.photoURL,alt:""}):r.jsx("span",{children:Xc(I.name)})}),r.jsx("span",{children:I.name})]},I.id))}),ft&&r.jsxs("div",{className:"journey-image-preview",children:[r.jsx("img",{src:ft,alt:"Preview"}),r.jsx("button",{className:"journey-image-remove",onClick:sr,"aria-label":"Remove image",children:r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",children:[r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})})]}),r.jsxs("div",{className:"journey-compose-actions",children:[r.jsx("button",{className:"journey-image-btn",onClick:()=>ht.current?.click(),"aria-label":"Add image",children:r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),r.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),r.jsx("path",{d:"M21 15l-5-5L5 21"})]})}),r.jsx("input",{ref:ht,type:"file",accept:"image/*",onChange:un,hidden:!0}),(we.trim()||Ue)&&r.jsx("button",{className:"journey-post-btn",onClick:Gn,disabled:Q,children:Q?r.jsx("div",{className:"journey-btn-spinner"}):"Post"})]})]})]}),ee?r.jsx("div",{className:"journey-loading",children:r.jsx("div",{className:"cb-spinner"})}):Ee.length===0?r.jsxs("div",{className:"journey-empty",children:[r.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),r.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),r.jsx("path",{d:"M21 15l-5-5L5 21"})]}),r.jsx("p",{children:"Start sharing your fitness journey!"})]}):r.jsx("div",{className:"journey-list",children:Ee.map(I=>r.jsxs("div",{id:`post-${I.id}`,className:"journey-post",children:[r.jsxs("div",{className:"journey-post-header",children:[r.jsx("div",{className:"journey-post-avatar",children:I.authorPhotoURL?r.jsx("img",{src:I.authorPhotoURL,alt:""}):r.jsx("span",{children:Xc(I.authorName)})}),r.jsxs("div",{className:"journey-post-meta",children:[r.jsx("span",{className:"journey-post-name",children:I.authorName}),r.jsx("span",{className:"journey-post-time",children:qp(I.createdAt)})]}),r.jsx("button",{className:"journey-delete-btn",onClick:()=>_r(I.id),"aria-label":"Delete post",children:r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M3 6h18"}),r.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),r.jsx("path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]}),I.content&&r.jsx("p",{className:"journey-post-content",children:Ge(I.content)}),I.imageURL&&r.jsx("div",{className:"journey-post-image",children:r.jsx("img",{src:I.imageURL,alt:"Post",loading:"lazy"})}),r.jsxs("div",{className:"journey-post-actions",children:[r.jsxs("button",{className:`journey-action-btn${lt.has(I.id)?" liked":""}`,onClick:()=>tn(I.id),children:[r.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:lt.has(I.id)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})}),r.jsx("span",{children:I.likeCount||0})]}),r.jsxs("button",{className:`journey-action-btn${Tt.has(I.id)?" active":""}`,onClick:()=>Sn(I.id),children:[r.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})}),r.jsx("span",{children:I.commentCount||0})]})]}),Tt.has(I.id)&&r.jsxs("div",{className:"journey-comments",children:[Ut[I.id]?.length>0?Ut[I.id].map(Z=>r.jsxs("div",{className:"journey-comment",children:[r.jsx("div",{className:"journey-comment-avatar",children:Z.authorPhotoURL?r.jsx("img",{src:Z.authorPhotoURL,alt:""}):r.jsx("span",{children:Xc(Z.authorName)})}),r.jsxs("div",{className:"journey-comment-body",children:[r.jsxs("div",{className:"journey-comment-bubble",children:[r.jsx("span",{className:"journey-comment-name",children:Z.authorName}),Z.replyToName&&r.jsxs("span",{className:"journey-comment-reply-tag",children:[r.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("polyline",{points:"9 14 4 9 9 4"}),r.jsx("path",{d:"M20 20v-7a4 4 0 0 0-4-4H4"})]}),Z.replyToName]}),Z.content&&r.jsx("span",{className:"journey-comment-text",children:Ge(Z.content)}),Z.imageURL&&r.jsx("img",{className:"journey-comment-image",src:Z.imageURL,alt:"Comment",loading:"lazy"})]}),r.jsxs("div",{className:"journey-comment-actions-row",children:[r.jsx("span",{className:"journey-comment-time",children:qp(Z.createdAt)}),r.jsx("button",{className:"journey-comment-reply-btn",onClick:()=>q(Ne=>({...Ne,[I.id]:{id:Z.id,authorName:Z.authorName}})),children:"Reply"}),r.jsx("button",{className:"journey-comment-delete-btn",onClick:()=>jr(I.id,Z.id),"aria-label":"Delete comment",children:r.jsxs("svg",{width:"13",height:"13",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M3 6h18"}),r.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),r.jsx("path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]})]})]},Z.id)):r.jsx("p",{className:"journey-no-comments",children:"No comments yet"}),Os[I.id]&&r.jsxs("div",{className:"journey-comment-replying",children:[r.jsxs("span",{children:["Replying to ",r.jsx("strong",{children:Os[I.id].authorName})]}),r.jsx("button",{onClick:()=>q(Z=>({...Z,[I.id]:null})),"aria-label":"Cancel reply",children:r.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",children:[r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})})]}),Te[I.id]&&r.jsxs("div",{className:"journey-comment-img-preview",children:[r.jsx("img",{src:Te[I.id],alt:"Preview"}),r.jsx("button",{onClick:()=>wi(I.id),"aria-label":"Remove image",children:r.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",children:[r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})})]}),r.jsxs("div",{className:"journey-comment-input",style:{position:"relative"},children:[r.jsx("button",{className:"journey-comment-img-btn",onClick:()=>et.current[I.id]?.click(),"aria-label":"Add image",children:r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),r.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),r.jsx("path",{d:"M21 15l-5-5L5 21"})]})}),r.jsx("input",{ref:Z=>{et.current[I.id]=Z},type:"file",accept:"image/*",onChange:Z=>Dr(I.id,Z),hidden:!0}),r.jsx("input",{type:"text",placeholder:"Comment",value:Ls[I.id]||"",onChange:Z=>Pr(I.id,Z.target.value),onKeyDown:Z=>{Z.key==="Enter"&&kr(I.id)},maxLength:300}),k&&P===I.id&&de.length>0&&r.jsx("div",{className:"mention-dropdown mention-dropdown-up",children:de.map(Z=>r.jsxs("button",{className:"mention-option",onClick:()=>qe(Z,I.id),children:[r.jsx("div",{className:"mention-option-avatar",children:Z.photoURL?r.jsx("img",{src:Z.photoURL,alt:""}):r.jsx("span",{children:Xc(Z.name)})}),r.jsx("span",{children:Z.name})]},Z.id))}),r.jsx("button",{onClick:()=>kr(I.id),disabled:!(Ls[I.id]||"").trim()&&!xe[I.id]||os[I.id],children:os[I.id]?r.jsx("div",{className:"journey-btn-spinner-sm"}):r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"22",y1:"2",x2:"11",y2:"13"}),r.jsx("polygon",{points:"22 2 15 22 11 13 2 9 22 2"})]})})]})]})]},I.id))})]}):r.jsxs("button",{className:"cb-upgrade-teaser",onClick:()=>y("/upgrade"),children:[r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),r.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}),r.jsx("span",{children:"Upgrade to share your journey"})]})]})]})]}),Xt&&r.jsx("div",{className:"cb-badge-overlay",onClick:()=>Gt(null),children:r.jsxs("div",{className:"cb-badge-overlay-content",onClick:I=>I.stopPropagation(),children:[r.jsx("img",{src:Xt.img,alt:Xt.name,className:`cb-badge-overlay-img${at.includes(Xt.id)?"":" cb-badge-overlay-img-locked"}`}),at.includes(Xt.id)?r.jsx("span",{className:"cb-badge-status unlocked",children:"Unlocked"}):r.jsx("span",{className:"cb-badge-status locked",children:"Locked"}),r.jsx("button",{className:"cb-badge-overlay-close",onClick:()=>Gt(null),children:"Tap to close"})]})}),r.jsx(aa,{active:"home"}),Bt&&r.jsxs("div",{className:`toast-notification ${Bt.type}`,children:[Bt.type==="info"&&r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("line",{x1:"12",y1:"16",x2:"12",y2:"12"}),r.jsx("line",{x1:"12",y1:"8",x2:"12.01",y2:"8"})]}),Bt.message]}),r.jsx(mD,{steps:ls,active:Xe,onFinish:wt}),rt&&r.jsxs("div",{className:"cb-celebration-overlay",onClick:()=>pt(null),children:[r.jsx("div",{className:"cb-confetti-container",children:Array.from({length:30},(I,Z)=>r.jsx("span",{className:"cb-confetti-piece",style:{"--angle":`${Math.random()*360}deg`,"--distance":`${80+Math.random()*120}px`,"--delay":`${Math.random()*.3}s`,"--color":["#FFD700","#FF6B6B","#4ECDC4","#45B7D1","#F7DC6F","#BB8FCE","#FF8C42","#38B6FF"][Z%8],"--size":`${6+Math.random()*6}px`,"--drift":`${(Math.random()-.5)*60}px`}},Z))}),r.jsxs("div",{className:"cb-celebration-content",onClick:I=>I.stopPropagation(),children:[r.jsx("div",{className:"cb-celebration-glow"}),r.jsx("img",{src:rt.img,alt:rt.name,className:"cb-celebration-badge-img"}),r.jsx("h2",{className:"cb-celebration-title",children:"Badge Unlocked!"}),r.jsx("p",{className:"cb-celebration-name",children:rt.name}),r.jsx("button",{className:"cb-celebration-dismiss",onClick:()=>pt(null),children:"Tap to continue"})]})]})]})})}const Hp=new Map;function Gi(){return new Date().toISOString().split("T")[0]}const _2=[{key:"breakfast",label:"Breakfast"},{key:"lunch",label:"Lunch"},{key:"dinner",label:"Dinner"},{key:"snacks",label:"Snacks"}],vD={breakfast:r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M18 8h1a4 4 0 0 1 0 8h-1"}),r.jsx("path",{d:"M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z"}),r.jsx("line",{x1:"6",y1:"1",x2:"6",y2:"4"}),r.jsx("line",{x1:"10",y1:"1",x2:"10",y2:"4"}),r.jsx("line",{x1:"14",y1:"1",x2:"14",y2:"4"})]}),lunch:r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}),dinner:r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})}),snacks:r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})})};function xD(){const n=new Date().getHours();return n<11?"breakfast":n<14?"lunch":n<17?"snacks":"dinner"}function wD(){const{currentUser:n,isClient:e,clientData:t,loading:i}=Mr(),{isDark:l,toggleTheme:u,accent:d}=ka(),p=$n(),[g,y]=v.useState("loading"),[w,j]=v.useState(null),[T,V]=v.useState({gender:"male",age:"",weight:"",weightUnit:"kg",height:"",heightUnit:"cm",heightFeet:"",heightInches:"",dailyActivity:"sedentary",trainingFrequency:"moderate",goal:"maintain",deficitLevel:"moderate"}),[W,F]=v.useState(null),[U,ne]=v.useState(Gi()),[Y,oe]=v.useState({entries:[],water:0}),[be,Le]=v.useState({protein:0,carbs:0,fats:0,calories:0}),[Ce,R]=v.useState(!1),[E,A]=v.useState(!1),[O,D]=v.useState(()=>{const k=new Date;return{year:k.getFullYear(),month:k.getMonth()}}),[H,M]=v.useState(xD),[We,gt]=v.useState(null),[$,me]=v.useState(null),[Ve,Ke]=v.useState(!1),[J,L]=v.useState(null),[se,Me]=v.useState(""),[De,Je]=v.useState(!1),[Fe,bt]=v.useState(""),[kt,nt]=v.useState([]),[Wt,ts]=v.useState(!1),[St,at]=v.useState({name:"",protein:"",carbs:"",fats:"",calories:"",serving:""}),[ce,Xt]=v.useState(null),[Gt,rt]=v.useState("100"),[pt,it]=v.useState(0),[st,Kt]=v.useState("weight"),[Ks,Ps]=v.useState(0),[ss,Ct]=v.useState(null);v.useRef(null);const Jt=v.useRef(!1),vs=v.useRef(null),Bt=v.useRef(null),As=v.useRef(null),ue=v.useCallback((k,S="info")=>{Ct({message:k,type:S}),setTimeout(()=>Ct(null),3e3)},[]);v.useEffect(()=>{!i&&(!n||!e)&&p("/")},[n,e,i,p]),v.useEffect(()=>{if(!t?.id)return;(async()=>{try{const S=await Rs(He(pe,"nutritionTargets",t.id));S.exists()?(j(S.data()),y("dashboard")):y("setup")}catch(S){console.error("Error loading nutrition data:",S),y("setup")}})()},[t?.id]),v.useEffect(()=>{if(!t?.id)return;(async()=>{try{const S=await Rs(He(pe,"nutritionLogs",`${t.id}_${U}`));if(S.exists()){const P=S.data();oe({entries:P.entries||[],water:P.water||0})}else oe({entries:[],water:0})}catch(S){console.error("Error loading log:",S),oe({entries:[],water:0})}})()},[t?.id,U]),v.useEffect(()=>{const k=Y.entries.reduce((S,P)=>({protein:S.protein+(P.protein||0),carbs:S.carbs+(P.carbs||0),fats:S.fats+(P.fats||0),calories:S.calories+(P.calories||0)}),{protein:0,carbs:0,fats:0,calories:0});Le(k)},[Y.entries]);const Ee=async k=>{try{await Ns(He(pe,"nutritionLogs",`${t.id}_${U}`),{clientId:t.id,date:U,entries:k.entries,water:k.water,updatedAt:xt.now()})}catch(S){console.error("Error saving nutrition log:",S)}},Ae=U===Gi(),ee=(k,S)=>new Date(k,S+1,0).getDate(),ge=(k,S)=>new Date(k,S,1).getDay(),we=["January","February","March","April","May","June","July","August","September","October","November","December"],Oe=["Su","Mo","Tu","We","Th","Fr","Sa"],Ue=()=>{let k=parseFloat(T.weight);T.weightUnit==="lbs"&&(k*=.453592);let S;T.heightUnit==="cm"?S=parseFloat(T.height):S=(parseFloat(T.heightFeet)||0)*30.48+(parseFloat(T.heightInches)||0)*2.54;const P=parseInt(T.age);let B=T.gender==="male"?10*k+6.25*S-5*P+5:10*k+6.25*S-5*P-161;const Be=B*{sedentary:1.2,light:1.3,moderate:1.4,active:1.5}[T.dailyActivity],ze={low:100,moderate:200,high:300,daily:400},Qe=Math.round(Be+ze[T.trainingFrequency]);let Xe=Qe,qt,xs;switch(T.goal){case"lose":Xe=Qe*(1-{light:.15,moderate:.2,harsh:.25}[T.deficitLevel]),qt=2.2,xs=.3;break;case"build":Xe=Qe*1.1,qt=2,xs=.22;break;default:qt=1.8,xs=.25}Xe=Math.max(Xe,T.gender==="male"?1400:1100);const ls=Math.round(k*qt),cs=Math.round(Xe*xs/9),Cs=Math.max(0,Math.round((Xe-ls*4-cs*9)/4));F({calories:Math.round(Xe),protein:ls,carbs:Cs,fats:cs,bmr:Math.round(B),neat:Math.round(Be),exerciseAdd:ze[T.trainingFrequency],tdee:Math.round(Qe)})},$e=async()=>{if(W)try{const k={clientId:t.id,calories:W.calories,protein:W.protein,carbs:W.carbs,fats:W.fats,waterGoal:8,goal:T.goal,updatedAt:xt.now()};await Ns(He(pe,"nutritionTargets",t.id),k),j(k),y("dashboard"),ue("Macro targets saved!","success")}catch(k){console.error("Error saving targets:",k),ue("Failed to save targets. Please try again.","error")}},ft=()=>{const k=T.weight&&parseFloat(T.weight)>0,S=T.age&&parseInt(T.age)>0,P=T.heightUnit==="cm"?T.height&&parseFloat(T.height)>0:T.heightFeet&&parseFloat(T.heightFeet)>0||T.heightInches&&parseFloat(T.heightInches)>0;return k&&S&&P},jt="nut_favourite_foods",Q=()=>{try{return JSON.parse(localStorage.getItem(jt)||"[]")}catch{return[]}},fe=k=>Q().some(S=>S.name.toLowerCase()===(k||"").toLowerCase()),lt=k=>{const S=Q(),P=S.findIndex(B=>B.name.toLowerCase()===k.name.toLowerCase());P>=0?S.splice(P,1):S.unshift({name:k.name,protein:k.protein,carbs:k.carbs,fats:k.fats,calories:k.calories,serving:k.serving,per100g:k.per100g||null,servingUnit:k.servingUnit||"g",portion:k.portion||null}),localStorage.setItem(jt,JSON.stringify(S)),Ps(B=>B+1)},At=k=>{const S=[...Y.entries,{...k,meal:H,id:Date.now(),addedAt:new Date().toISOString()}],P={...Y,entries:S};oe(P),Ee(P),me(null),Xt(null),rt("100"),it(0),Kt("weight"),at({name:"",protein:"",carbs:"",fats:"",calories:"",serving:""}),ue("Food added!","success")},Tt=k=>{const S=Y.entries.filter(B=>B.id!==k),P={...Y,entries:S};oe(P),Ee(P)},ns=v.useRef(null),Ut=async()=>{Ke(!0);const k=document.querySelector("#barcode-reader");if(!k){Ke(!1),ue("Scanner container not found.","error");return}if(!ns.current)try{const P=await wr(()=>import("./quagga.min-BbicSfvA.js").then(B=>B.q),[]);ns.current=P.default}catch(P){console.error("Failed to load barcode scanner:",P),Ke(!1),ue("Could not load scanner.","error");return}const S=ns.current;S.init({inputStream:{type:"LiveStream",target:k,constraints:{facingMode:"environment",width:{min:640,ideal:1280,max:1920},height:{min:480,ideal:720,max:1080}}},locator:{patchSize:"medium",halfSample:!0},numOfWorkers:navigator.hardwareConcurrency||2,decoder:{readers:["ean_reader","ean_8_reader","upc_reader","upc_e_reader","code_128_reader","code_39_reader"]},locate:!0},P=>{if(P){console.error("Quagga init error:",P),Ke(!1),ue("Could not access camera. Check permissions.","error");return}S.start(),Jt.current=!0}),S.onDetected(P=>{const B=P.codeResult.decodedCodes?.filter(Be=>Be.error!==void 0)?.map(Be=>Be.error)||[];if((B.length>0?B.reduce((Be,ze)=>Be+ze,0)/B.length:1)<.15){const Be=P.codeResult.code;S.offDetected(),L(Be)}})},Ot=()=>{const k=ns.current;Jt.current&&k&&(k.stop(),k.offDetected(),Jt.current=!1),Ke(!1)},Ls=/\b(milk|semi.skimmed|skimmed|whole milk|oat milk|almond milk|soy milk|juice|smoothie|water|squash|cordial|cola|pepsi|fanta|lemonade|soda|beer|wine|cider|lager|spirit|whisky|vodka|rum|gin|brandy|cream|yoghurt drink|milkshake|coffee|tea|broth|stock|soup|sauce|ketchup|vinegar|oil|syrup|honey|custard|coconut water|kombucha|energy drink|protein shake)\b/i,Js=k=>/ml|cl|\dl(?!b)|litre|liter|fl\s?oz/i.test((k||"").replace(/\s/g,"")),os=k=>{if(!k)return{value:100,unit:"g"};const S=k.toLowerCase().replace(/\s/g,""),P=S.match(/([\d.]+)/),B=P?parseFloat(P[1]):100;return Js(k)?/cl/.test(S)?{value:B*10,unit:"ml"}:/(?:^|\d)l(?!i)/.test(S)&&!/ml/.test(S)?{value:B*1e3,unit:"ml"}:{value:B,unit:"ml"}:{value:B,unit:"g"}},Ss=k=>{if(Js(k.serving_size)||Js(k.quantity))return"ml";const S=k.product_name||k.product_name_en||"";return Ls.test(S)?"ml":"g"},Os=[{pattern:/\b(toast|bread|loaf|brioche|bagel|pitta|wrap|tortilla|crumpet|muffin|waffle|pancake)\b/i,label:"slice",weight:36},{pattern:/\begg\b/i,label:"egg",weight:60},{pattern:/\b(biscuit|cookie|digestive|hobnob|rich tea|oreo)\b/i,label:"biscuit",weight:13},{pattern:/\b(sausage|banger)\b/i,label:"sausage",weight:57},{pattern:/\b(rasher|bacon)\b/i,label:"rasher",weight:25},{pattern:/\b(rice cake)\b/i,label:"cake",weight:9},{pattern:/\b(cracker|ryvita)\b/i,label:"cracker",weight:10}],q=(k,S)=>{const P=k||"",B=P.match(/\((\d+\.?\d*)\s*g\)/i),de=P.match(/(?:^|per\s+)(\d*\s*[a-z][a-z\s]*?)(?:\s*\(|\s*-\s*|\s*$)/i);if(B&&de){const Qe=parseFloat(B[1]);let Xe=de[1].replace(/^\d+\s*/,"").trim();if(Xe&&Qe>0)return{label:Xe,weight:Qe}}const Be=P.match(/(\d+\.?\d*)\s*g\s*[\/=]\s*(\d*\s*[a-z][a-z\s]*)/i);if(Be){const Qe=parseFloat(Be[1]);let Xe=Be[2].replace(/^\d+\s*/,"").trim();if(Xe&&Qe>0)return{label:Xe,weight:Qe}}const ze=S||"";for(const{pattern:Qe,label:Xe,weight:qt}of Os)if(Qe.test(ze))return{label:Xe,weight:qt};return null},xe=k=>{const S=k.nutriments||{},P=Ss(k),B=os(k.serving_size),de=P==="ml"?B.unit==="ml"?B.value:100:B.value,Be=k.product_name||k.product_name_en||"Unknown Product",ze=q(k.serving_size,Be);return{name:Be,brand:k.brands||"",image:k.image_small_url||k.image_url||null,servingSize:k.serving_size||"100g",servingValue:de,servingUnit:P,portion:ze,protein:Math.round(S.proteins_100g||S.proteins||0),carbs:Math.round(S.carbohydrates_100g||S.carbohydrates||0),fats:Math.round(S.fat_100g||S.fat||0),calories:Math.round(S["energy-kcal_100g"]||S["energy-kcal"]||(S.energy_100g?S.energy_100g/4.184:0)),per100g:!0}},je=async k=>{Je(!0);try{const S=`https://world.openfoodfacts.org/api/v2/product/${k}?fields=product_name,product_name_en,brands,image_small_url,image_url,serving_size,quantity,nutriments`,P=await fetch(S);if(!P.ok)throw new Error(`HTTP ${P.status}`);const B=await P.json();if(B.status==="success"||B.status===1||B.product){const de=xe(B.product);de.calories===0&&de.protein===0&&de.carbs===0?ue("Product found but no nutrition data available.","error"):(Xt(de),de.portion?(it(1),rt(String(de.portion.weight)),Kt("portion")):(it(0),rt(String(de.servingValue||100)),Kt("weight")),Me(""))}else ue("Product not found. Try search or manual entry.","error")}catch(S){console.error("Barcode lookup error:",S),ue("Failed to look up product. Check your connection.","error")}Je(!1)},Te=(k,S,P)=>{const B=k.toLowerCase().trim(),de=S.toLowerCase().trim(),Be=P.toLowerCase().trim();let ze=0;return(B===Be||B===Be+"s"||B+"s"===Be)&&(ze+=100),(B.endsWith(" "+Be)||B.endsWith(" "+Be+"s"))&&(ze+=40),(B.startsWith(Be+" ")||B.startsWith(Be+"s "))&&(ze+=15),Be.split(/\s+/).some(Xe=>de===Xe||de.startsWith(Xe))&&(ze+=30),ze+=Math.max(0,30-B.length),ze},_e=async()=>{if(!Fe.trim())return;vs.current&&vs.current.abort();const k=new AbortController;vs.current=k;const S=Fe.trim().toLowerCase(),P=S.split(/\s+/).filter(Boolean);if(Hp.has(S)){nt(Hp.get(S));return}ts(!0);try{const de=`https://world.openfoodfacts.org/cgi/search.pl?search_terms=${encodeURIComponent(Fe.trim())}&search_simple=1&action=process&json=1&page_size=10&lc=en&sort_by=unique_scans_n&fields=product_name,product_name_en,brands,image_small_url,image_url,serving_size,quantity,nutriments`,Be=await fetch(de,{signal:k.signal});if(!Be.ok)throw new Error(`HTTP ${Be.status}`);const Qe=((await Be.json()).products||[]).map(Xe=>xe(Xe)).filter(Xe=>Xe.name!=="Unknown Product"&&(Xe.calories>0||Xe.protein>0)).filter(Xe=>{const qt=(Xe.name+" "+Xe.brand).toLowerCase();return P.every(xs=>qt.includes(xs))}).sort((Xe,qt)=>Te(qt.name,qt.brand,S)-Te(Xe.name,Xe.brand,S)).slice(0,10);Hp.set(S,Qe),nt(Qe),Qe.length===0&&ue("No results found. Try a different search.","info")}catch(B){if(B.name==="AbortError")return;console.error("Search error:",B),ue("Search failed. Check your connection.","error")}ts(!1)};v.useEffect(()=>{if(Bt.current&&clearTimeout(Bt.current),!(!Fe.trim()||$!=="search"||ce))return Bt.current=setTimeout(()=>{_e()},700),()=>clearTimeout(Bt.current)},[Fe]);const ct=()=>{const k={...Y,water:Y.water+1};oe(k),Ee(k)},ht=()=>{if(Y.water<=0)return;const k={...Y,water:Y.water-1};oe(k),Ee(k)},et={"ring-protein":"#14b8a6","ring-carbs":"var(--color-primary)","ring-fats":"#eab308","ring-cals":"rgba(150,150,150,0.55)"},vt=80,Rt=2*Math.PI*vt,js=(k,S,P,B,de)=>{const Be=B>0?Math.min(100,Math.round(P/B*100)):0,ze=Rt-Be/100*Rt,Qe=et[de]||"#14b8a6";return r.jsxs("div",{className:"nut-ring-wrap",children:[r.jsxs("svg",{className:"nut-ring-svg",viewBox:"0 0 200 200",children:[r.jsx("circle",{className:"nut-arc-track",cx:"100",cy:"100",r:vt}),r.jsx("circle",{className:"nut-arc-fill",cx:"100",cy:"100",r:vt,style:{stroke:Qe},strokeDasharray:Rt,strokeDashoffset:ze})]}),r.jsxs("div",{className:"nut-ring-center",children:[r.jsx("span",{className:"nut-ring-value",style:{color:Qe},children:Math.round(P)}),r.jsxs("span",{className:"nut-ring-target",children:["/ ",B,k==="Calories"?"":"g"]}),r.jsx("span",{className:"nut-ring-label",style:{color:Qe},children:S})]}),r.jsxs("span",{className:"nut-ring-pct",style:{color:Qe},children:[Be,"%"]})]})};if(v.useEffect(()=>{if(!J)return;const k=setTimeout(()=>{const S=J;Ot(),L(null),je(S)},1500);return()=>clearTimeout(k)},[J]),v.useEffect(()=>()=>{const k=ns.current;if(Jt.current&&k){try{k.stop(),k.offDetected()}catch{}Jt.current=!1}},[]),i||g==="loading")return r.jsxs("div",{className:"nut-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>p("/client/core-buddy"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})]})}),r.jsx("div",{className:"nut-loading-inline",children:r.jsx("div",{className:"cb-loading-spinner"})})]});if(g==="setup")return r.jsxs("div",{className:"nut-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>p("/client/core-buddy"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),r.jsxs("main",{className:"nut-main",children:[r.jsxs("div",{className:"nut-setup-intro",children:[r.jsx("h2",{children:"Set Your Daily Targets"}),r.jsx("p",{children:"Calculate your personalised macros based on your body and goals."})]}),r.jsxs("div",{className:"nut-calc-form",children:[r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Gender"}),r.jsxs("div",{className:"nut-toggle-group",children:[r.jsx("button",{className:T.gender==="male"?"active":"",onClick:()=>{V(k=>({...k,gender:"male"})),F(null)},children:"Male"}),r.jsx("button",{className:T.gender==="female"?"active":"",onClick:()=>{V(k=>({...k,gender:"female"})),F(null)},children:"Female"})]})]}),r.jsxs("div",{className:"nut-form-row",children:[r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Age"}),r.jsx("input",{type:"number",value:T.age,onChange:k=>{V(S=>({...S,age:k.target.value})),F(null)},placeholder:"Years",min:"15",max:"100"})]}),r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Weight"}),r.jsxs("div",{className:"nut-input-unit",children:[r.jsx("input",{type:"number",value:T.weight,onChange:k=>{V(S=>({...S,weight:k.target.value})),F(null)},placeholder:T.weightUnit,min:"30",max:"300"}),r.jsxs("div",{className:"nut-unit-toggle",children:[r.jsx("button",{className:T.weightUnit==="kg"?"active":"",onClick:()=>{V(k=>({...k,weightUnit:"kg"})),F(null)},children:"kg"}),r.jsx("button",{className:T.weightUnit==="lbs"?"active":"",onClick:()=>{V(k=>({...k,weightUnit:"lbs"})),F(null)},children:"lbs"})]})]})]})]}),r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Height"}),r.jsxs("div",{className:"nut-input-unit",children:[T.heightUnit==="cm"?r.jsx("input",{type:"number",value:T.height,onChange:k=>{V(S=>({...S,height:k.target.value})),F(null)},placeholder:"cm",min:"100",max:"250"}):r.jsxs("div",{className:"nut-height-imperial",children:[r.jsx("input",{type:"number",value:T.heightFeet,onChange:k=>{V(S=>({...S,heightFeet:k.target.value})),F(null)},placeholder:"ft",min:"4",max:"7"}),r.jsx("input",{type:"number",value:T.heightInches,onChange:k=>{V(S=>({...S,heightInches:k.target.value})),F(null)},placeholder:"in",min:"0",max:"11"})]}),r.jsxs("div",{className:"nut-unit-toggle",children:[r.jsx("button",{className:T.heightUnit==="cm"?"active":"",onClick:()=>{V(k=>({...k,heightUnit:"cm"})),F(null)},children:"cm"}),r.jsx("button",{className:T.heightUnit==="ft"?"active":"",onClick:()=>{V(k=>({...k,heightUnit:"ft"})),F(null)},children:"ft/in"})]})]})]}),r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Daily Activity (outside of training)"}),r.jsxs("select",{value:T.dailyActivity,onChange:k=>{V(S=>({...S,dailyActivity:k.target.value})),F(null)},children:[r.jsx("option",{value:"sedentary",children:"Sedentary  desk job, under 5k steps"}),r.jsx("option",{value:"light",children:"Lightly Active  office + walking, 5-8k steps"}),r.jsx("option",{value:"moderate",children:"Moderately Active  on feet often, 8-12k steps"}),r.jsx("option",{value:"active",children:"Very Active  physical job, 12k+ steps"})]})]}),r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Training Sessions per Week"}),r.jsxs("select",{value:T.trainingFrequency,onChange:k=>{V(S=>({...S,trainingFrequency:k.target.value})),F(null)},children:[r.jsx("option",{value:"low",children:"1-2 sessions"}),r.jsx("option",{value:"moderate",children:"3-4 sessions"}),r.jsx("option",{value:"high",children:"5-6 sessions"}),r.jsx("option",{value:"daily",children:"7+ sessions"})]})]}),r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Fitness Goal"}),r.jsxs("div",{className:"nut-goal-options",children:[r.jsxs("button",{className:T.goal==="lose"?"active":"",onClick:()=>{V(k=>({...k,goal:"lose"})),F(null)},children:[r.jsx("span",{className:"nut-goal-icon",children:"-"}),r.jsx("span",{children:"Lose Weight"})]}),r.jsxs("button",{className:T.goal==="maintain"?"active":"",onClick:()=>{V(k=>({...k,goal:"maintain"})),F(null)},children:[r.jsx("span",{className:"nut-goal-icon",children:"="}),r.jsx("span",{children:"Maintain"})]}),r.jsxs("button",{className:T.goal==="build"?"active":"",onClick:()=>{V(k=>({...k,goal:"build"})),F(null)},children:[r.jsx("span",{className:"nut-goal-icon",children:"+"}),r.jsx("span",{children:"Build Muscle"})]})]})]}),T.goal==="lose"&&r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Deficit Level"}),r.jsxs("div",{className:"nut-deficit-options",children:[r.jsxs("button",{className:T.deficitLevel==="light"?"active":"",onClick:()=>{V(k=>({...k,deficitLevel:"light"})),F(null)},children:[r.jsx("strong",{children:"Mild"}),r.jsx("span",{children:"15% below TDEE"})]}),r.jsxs("button",{className:T.deficitLevel==="moderate"?"active":"",onClick:()=>{V(k=>({...k,deficitLevel:"moderate"})),F(null)},children:[r.jsx("strong",{children:"Moderate"}),r.jsx("span",{children:"20% below TDEE"})]}),r.jsxs("button",{className:T.deficitLevel==="harsh"?"active":"",onClick:()=>{V(k=>({...k,deficitLevel:"harsh"})),F(null)},children:[r.jsx("strong",{children:"Aggressive"}),r.jsx("span",{children:"25% below TDEE"})]})]})]}),r.jsx("button",{className:"nut-calc-btn",onClick:Ue,disabled:!ft(),children:"Calculate Macros"})]}),W&&r.jsxs("div",{className:"nut-calc-results",children:[r.jsx("h3",{children:"Your Daily Targets"}),r.jsxs("div",{className:"nut-calc-rings",children:[js("Protein","Protein",W.protein,W.protein,"ring-protein"),js("Carbs","Carbs",W.carbs,W.carbs,"ring-carbs"),js("Fats","Fats",W.fats,W.fats,"ring-fats"),js("Calories","Calories",W.calories,W.calories,"ring-cals")]}),r.jsxs("div",{className:"nut-calc-info",children:[r.jsxs("div",{className:"nut-calc-info-row",children:[r.jsx("span",{children:"BMR (body at rest)"}),r.jsxs("span",{children:[W.bmr," cal"]})]}),r.jsxs("div",{className:"nut-calc-info-row",children:[r.jsx("span",{children:"+ Daily activity (NEAT)"}),r.jsxs("span",{children:[W.neat," cal"]})]}),r.jsxs("div",{className:"nut-calc-info-row",children:[r.jsx("span",{children:"+ Training sessions"}),r.jsxs("span",{children:["+",W.exerciseAdd," cal"]})]}),r.jsxs("div",{className:"nut-calc-info-row",style:{fontWeight:600},children:[r.jsx("span",{children:"TDEE (total burn)"}),r.jsxs("span",{children:[W.tdee," cal"]})]})]}),r.jsx("button",{className:"nut-save-targets-btn",onClick:$e,children:"Set as My Daily Targets"})]})]}),ss&&r.jsx("div",{className:`toast-notification ${ss.type}`,children:ss.message})]});const mn=k=>{const S=new Date(k+"T12:00:00"),P=S.getDay(),B=new Date(S);B.setDate(S.getDate()-(P+6)%7);const de=[];for(let Be=0;Be<7;Be++){const ze=new Date(B);ze.setDate(B.getDate()+Be),de.push(ze.toISOString().split("T")[0])}return de},ln=["M","T","W","T","F","S","S"],_n=(k,S="search")=>{M(k),S==="scan"?(me("scan"),Xt(null)):S==="manual"?(me("manual"),at({name:"",protein:"",carbs:"",fats:"",calories:"",serving:""})):S==="favourites"?me("favourites"):(me("search"),nt([]),bt(""))},kn=mn(U),fn=new Date(U+"T12:00:00"),Fs=`${we[fn.getMonth()]} ${fn.getFullYear()}`;return r.jsx(xa,{children:r.jsxs("div",{className:"nut-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsxs("div",{className:"nut-dark-zone",children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>p("/client/core-buddy"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsxs("div",{className:"header-actions",children:[r.jsx("button",{onClick:()=>{y("setup"),F(null)},"aria-label":"Recalculate macros",children:r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"3"}),r.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 1 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 1 1-2.83-2.83l.06-.06A1.65 1.65 0 0 0 4.68 15a1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1 0-4h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 1 1 2.83-2.83l.06.06A1.65 1.65 0 0 0 9 4.68a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 2.83l-.06.06A1.65 1.65 0 0 0 19.4 9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1z"})]})}),r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})]})]})}),r.jsxs("div",{className:"nut-dark-content",children:[r.jsxs("div",{className:"nut-week-strip anim-fade-up",children:[r.jsxs("div",{className:"nut-week-header",children:[r.jsx("button",{className:"nut-week-arrow",onClick:()=>{const k=new Date(U+"T12:00:00");k.setDate(k.getDate()-7);const S=k.toISOString().split("T")[0];ne(S)},"aria-label":"Previous week",children:r.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:r.jsx("polyline",{points:"15 18 9 12 15 6"})})}),r.jsx("button",{className:"nut-week-month-label",onClick:()=>{R(!Ce),D({year:fn.getFullYear(),month:fn.getMonth()})},children:Fs}),r.jsx("button",{className:"nut-week-arrow",onClick:()=>{const k=new Date(U+"T12:00:00");k.setDate(k.getDate()+7);const S=k.toISOString().split("T")[0];S<=Gi()&&ne(S)},"aria-label":"Next week",disabled:kn[6]>=Gi(),children:r.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:r.jsx("polyline",{points:"9 18 15 12 9 6"})})})]}),r.jsx("div",{className:"nut-week-days",children:kn.map((k,S)=>{const P=new Date(k+"T12:00:00").getDate(),B=k===U,de=k>Gi(),Be=k===Gi();return r.jsxs("button",{className:`nut-week-day${B?" selected":""}${Be?" today":""}${de?" future":""}`,disabled:de,onClick:()=>ne(k),children:[r.jsx("span",{className:"nut-week-day-letter",children:ln[S]}),r.jsx("span",{className:"nut-week-day-num",children:P})]},k)})})]}),Ce&&r.jsxs("div",{className:"nut-calendar nut-calendar-dark",children:[r.jsxs("div",{className:"nut-cal-header",children:[r.jsx("button",{onClick:()=>D(k=>{let S=k.month-1,P=k.year;return S<0&&(S=11,P--),{year:P,month:S}}),children:r.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("polyline",{points:"15 18 9 12 15 6"})})}),r.jsxs("span",{children:[we[O.month]," ",O.year]}),r.jsx("button",{onClick:()=>D(k=>{let S=k.month+1,P=k.year;return S>11&&(S=0,P++),{year:P,month:S}}),disabled:O.year===new Date().getFullYear()&&O.month>=new Date().getMonth(),children:r.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("polyline",{points:"9 18 15 12 9 6"})})})]}),r.jsx("div",{className:"nut-cal-days-header",children:Oe.map(k=>r.jsx("span",{children:k},k))}),r.jsxs("div",{className:"nut-cal-grid",children:[[...Array(ge(O.year,O.month))].map((k,S)=>r.jsx("span",{},`e${S}`)),[...Array(ee(O.year,O.month))].map((k,S)=>{const P=S+1,B=`${O.year}-${String(O.month+1).padStart(2,"0")}-${String(P).padStart(2,"0")}`,de=B>Gi(),Be=B===U,ze=B===Gi();return r.jsx("button",{className:`nut-cal-day${Be?" selected":""}${ze?" today":""}${de?" future":""}`,disabled:de,onClick:()=>{ne(B),R(!1)},children:P},P)})]})]}),r.jsxs("div",{className:"nut-rings-row anim-fade-up-d2",children:[js("Protein","Protein",be.protein,w.protein,"ring-protein"),js("Carbs","Carbs",be.carbs,w.carbs,"ring-carbs"),js("Fats","Fats",be.fats,w.fats,"ring-fats"),js("Calories","kCal",be.calories,w.calories,"ring-cals")]})]})]}),r.jsx("div",{className:"nut-light-zone anim-fade-up-d4",children:r.jsxs("div",{className:"nut-light-content",children:[Ae&&r.jsxs("button",{className:"nut-water-quick",onClick:()=>A(!0),children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",stroke:"none",width:"18",height:"18",children:r.jsx("path",{d:"M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z"})}),r.jsxs("span",{className:"nut-water-quick-count",children:[Y.water," / ",w?.waterGoal||8]}),r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",width:"14",height:"14",children:[r.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),r.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})]}),r.jsx("div",{className:"nut-log-section",children:r.jsx("div",{className:"nut-meals-list",children:_2.map(k=>{const S=Y.entries.filter(B=>(B.meal||"snacks")===k.key),P=S.reduce((B,de)=>({protein:B.protein+(de.protein||0),carbs:B.carbs+(de.carbs||0),fats:B.fats+(de.fats||0),calories:B.calories+(de.calories||0)}),{protein:0,carbs:0,fats:0,calories:0});return r.jsxs("div",{className:"nut-meal-card",children:[r.jsxs("div",{className:"nut-meal-card-header",children:[r.jsx("span",{className:`nut-meal-card-icon nut-meal-icon-${k.key}`,children:vD[k.key]}),r.jsx("span",{className:"nut-meal-card-title",children:k.label}),S.length>0&&r.jsxs("span",{className:"nut-meal-card-cal",children:[P.calories," cal"]}),Ae&&r.jsx("button",{className:"nut-meal-add-btn",onClick:()=>gt(We===k.key?null:k.key),"aria-label":`Add to ${k.label}`,children:r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:[r.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),r.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})})]}),S.length>0&&r.jsxs("div",{className:"nut-meal-bars",children:[r.jsxs("div",{className:"nut-meal-bar-row",children:[r.jsx("span",{className:"nut-meal-bar-label nut-macro-p",children:"P"}),r.jsx("div",{className:"nut-meal-bar-track",children:r.jsx("div",{className:"nut-meal-bar-fill bar-protein",style:{width:`${Math.min(100,w.protein>0?P.protein/w.protein*100:0)}%`}})}),r.jsxs("span",{className:"nut-meal-bar-val",children:[P.protein,"g"]})]}),r.jsxs("div",{className:"nut-meal-bar-row",children:[r.jsx("span",{className:"nut-meal-bar-label nut-macro-c",children:"C"}),r.jsx("div",{className:"nut-meal-bar-track",children:r.jsx("div",{className:"nut-meal-bar-fill bar-carbs",style:{width:`${Math.min(100,w.carbs>0?P.carbs/w.carbs*100:0)}%`}})}),r.jsxs("span",{className:"nut-meal-bar-val",children:[P.carbs,"g"]})]}),r.jsxs("div",{className:"nut-meal-bar-row",children:[r.jsx("span",{className:"nut-meal-bar-label nut-macro-f",children:"F"}),r.jsx("div",{className:"nut-meal-bar-track",children:r.jsx("div",{className:"nut-meal-bar-fill bar-fats",style:{width:`${Math.min(100,w.fats>0?P.fats/w.fats*100:0)}%`}})}),r.jsxs("span",{className:"nut-meal-bar-val",children:[P.fats,"g"]})]}),r.jsxs("div",{className:"nut-meal-bar-row",children:[r.jsx("span",{className:"nut-meal-bar-label nut-macro-cal",children:"K"}),r.jsx("div",{className:"nut-meal-bar-track",children:r.jsx("div",{className:"nut-meal-bar-fill bar-cals",style:{width:`${Math.min(100,w.calories>0?P.calories/w.calories*100:0)}%`}})}),r.jsx("span",{className:"nut-meal-bar-val",children:P.calories})]})]}),S.length>0&&r.jsx("div",{className:"nut-log-list",children:S.map(B=>r.jsxs("div",{className:"nut-log-item",children:[r.jsxs("div",{className:"nut-log-item-info",children:[r.jsx("span",{className:"nut-log-item-name",children:B.name}),B.serving&&r.jsx("span",{className:"nut-log-item-serving",children:B.serving})]}),r.jsxs("div",{className:"nut-log-item-macros",children:[r.jsxs("span",{className:"nut-macro-p",children:[B.protein,"p"]}),r.jsxs("span",{className:"nut-macro-c",children:[B.carbs,"c"]}),r.jsxs("span",{className:"nut-macro-f",children:[B.fats,"f"]}),r.jsx("span",{className:"nut-macro-cal",children:B.calories})]}),Ae&&r.jsx("button",{className:"nut-log-delete",onClick:()=>Tt(B.id),"aria-label":"Remove",children:r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]},B.id))}),S.length===0&&r.jsx("div",{className:"nut-meal-empty",children:r.jsx("p",{children:Ae?"Tap + to add food":"No entries"})})]},k.key)})})})]})}),We&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"nut-add-picker-backdrop",onClick:()=>gt(null)}),r.jsxs("div",{className:"nut-add-picker",children:[r.jsx("div",{className:"nut-add-picker-handle"}),r.jsxs("h3",{className:"nut-add-picker-title",children:["Add to ",_2.find(k=>k.key===We)?.label]}),r.jsxs("div",{className:"nut-add-picker-options",children:[r.jsxs("button",{onClick:()=>{const k=We;gt(null),_n(k,"scan")},children:[r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M3 7V5a2 2 0 0 1 2-2h2"}),r.jsx("path",{d:"M17 3h2a2 2 0 0 1 2 2v2"}),r.jsx("path",{d:"M21 17v2a2 2 0 0 1-2 2h-2"}),r.jsx("path",{d:"M7 21H5a2 2 0 0 1-2-2v-2"}),r.jsx("line",{x1:"7",y1:"12",x2:"17",y2:"12"})]}),r.jsx("span",{children:"Scan Barcode"})]}),r.jsxs("button",{onClick:()=>{const k=We;gt(null),_n(k,"search")},children:[r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"11",cy:"11",r:"8"}),r.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),r.jsx("span",{children:"Search Food"})]}),r.jsxs("button",{onClick:()=>{const k=We;gt(null),_n(k,"manual")},children:[r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),r.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]}),r.jsx("span",{children:"Manual Entry"})]}),r.jsxs("button",{onClick:()=>{const k=We;gt(null),_n(k,"favourites")},children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),r.jsx("span",{children:"Favourites"})]})]})]})]}),E&&r.jsx("div",{className:"nut-modal-overlay",onClick:()=>A(!1),children:r.jsxs("div",{className:"nut-water-popup",onClick:k=>k.stopPropagation(),children:[r.jsxs("div",{className:"nut-water-popup-header",children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",stroke:"none",width:"20",height:"20",style:{color:"#2196f3"},children:r.jsx("path",{d:"M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z"})}),r.jsx("span",{children:"Water Intake"}),r.jsx("button",{className:"nut-modal-close",onClick:()=>A(!1),children:r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),r.jsxs("div",{className:"nut-water-popup-body",children:[r.jsx("div",{className:"nut-water-glasses",children:[...Array(w?.waterGoal||8)].map((k,S)=>r.jsx("div",{className:`nut-water-glass ${S<Y.water?"filled":""}`,children:r.jsx("svg",{viewBox:"0 0 24 24",fill:S<Y.water?"currentColor":"none",stroke:"currentColor",strokeWidth:"1.5",children:r.jsx("path",{d:"M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z"})})},S))}),r.jsxs("div",{className:"nut-water-popup-count",children:[Y.water," / ",w?.waterGoal||8," glasses"]}),r.jsxs("div",{className:"nut-water-btns",children:[r.jsx("button",{onClick:ht,disabled:Y.water<=0,children:"-"}),r.jsx("button",{onClick:ct,children:"+"})]})]})]})}),$&&r.jsx("div",{className:"nut-modal-overlay",onClick:()=>{Ot(),L(null),me(null),Xt(null)},children:r.jsxs("div",{className:"nut-modal",onClick:k=>k.stopPropagation(),children:[r.jsxs("div",{className:"nut-modal-header",children:[r.jsx("h3",{children:$==="scan"?"Scan Barcode":$==="search"?"Search Food":$==="favourites"?"Favourites":"Manual Entry"}),r.jsx("button",{className:"nut-modal-close",onClick:()=>{Ot(),L(null),me(null),Xt(null)},children:r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),$==="scan"&&!ce&&r.jsxs("div",{className:"nut-scan-area",children:[r.jsxs("div",{className:"nut-scanner-wrapper",children:[r.jsx("div",{id:"barcode-reader",className:"nut-scanner-view"}),Ve&&!J&&r.jsx("div",{className:"nut-scan-line"}),J&&r.jsxs("div",{className:"nut-scan-detected-overlay",children:[r.jsx("svg",{className:"nut-scan-detected-tick",viewBox:"0 0 24 24",fill:"none",stroke:"#4caf50",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M20 6L9 17l-5-5"})}),r.jsx("p",{className:"nut-scan-detected-label",children:"Barcode found!"}),r.jsx("p",{className:"nut-scan-detected-code",children:J})]})]}),!Ve&&r.jsxs("button",{className:"nut-scan-start-btn",onClick:Ut,children:[r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M3 7V5a2 2 0 0 1 2-2h2"}),r.jsx("path",{d:"M17 3h2a2 2 0 0 1 2 2v2"}),r.jsx("path",{d:"M21 17v2a2 2 0 0 1-2 2h-2"}),r.jsx("path",{d:"M7 21H5a2 2 0 0 1-2-2v-2"}),r.jsx("line",{x1:"7",y1:"12",x2:"17",y2:"12"})]}),"Open Camera"]}),Ve&&!J&&r.jsx("p",{className:"nut-scan-hint",children:"Align barcode within the frame"}),r.jsx("div",{className:"nut-barcode-divider",children:r.jsx("span",{children:"or enter barcode manually"})}),r.jsxs("div",{className:"nut-barcode-manual",children:[r.jsx("input",{type:"text",inputMode:"numeric",value:se,onChange:k=>Me(k.target.value),onKeyDown:k=>k.key==="Enter"&&se.trim()&&je(se.trim()),placeholder:"Enter barcode number"}),r.jsx("button",{onClick:()=>se.trim()&&je(se.trim()),disabled:!se.trim()||De,children:De?"...":"Look Up"})]})]}),$==="scan"&&ce&&(()=>{const k=ce.servingUnit||"g",S=ce.portion,P=st==="portion"&&S?pt*S.weight:parseFloat(Gt)||0,B=P/100,de=k==="ml"?[100,200,250,500]:[50,100,150,200],Be=st==="portion"&&S?`${pt} ${S.label}${pt!==1?"s":""} (${Math.round(P)}${k})`:`${Math.round(P)}${k}`;return r.jsxs("div",{className:"nut-product-result",children:[ce.image&&r.jsx("img",{src:ce.image,alt:ce.name||"Product",className:"nut-product-img",loading:"lazy"}),r.jsxs("div",{className:"nut-product-name-row",children:[r.jsx("h4",{children:ce.name}),r.jsx("button",{className:`nut-fav-star confirm${fe(ce.name)?" active":""}`,onClick:()=>lt({name:ce.name,protein:ce.protein,carbs:ce.carbs,fats:ce.fats,calories:ce.calories,serving:ce.servingSize,per100g:{protein:ce.protein,carbs:ce.carbs,fats:ce.fats,calories:ce.calories},servingUnit:ce.servingUnit||"g",portion:ce.portion||null}),children:r.jsx("svg",{viewBox:"0 0 24 24",width:"22",height:"22",fill:fe(ce.name)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})})]}),ce.brand&&r.jsx("p",{className:"nut-product-brand",children:ce.brand}),r.jsxs("p",{className:"nut-product-per",children:["Per 100",k,":"]}),r.jsxs("div",{className:"nut-product-macros",children:[r.jsxs("span",{className:"nut-macro-p",children:[ce.protein,"g P"]}),r.jsxs("span",{className:"nut-macro-c",children:[ce.carbs,"g C"]}),r.jsxs("span",{className:"nut-macro-f",children:[ce.fats,"g F"]}),r.jsxs("span",{className:"nut-macro-cal",children:[ce.calories," cal"]})]}),S&&r.jsxs("div",{className:"nut-mode-toggle",children:[r.jsx("button",{className:st==="portion"?"active":"",onClick:()=>{Kt("portion"),pt<1&&it(1)},children:"Portions"}),r.jsxs("button",{className:st==="weight"?"active":"",onClick:()=>{Kt("weight"),rt(String(Math.round(P)||100))},children:["Custom (",k,")"]})]}),st==="portion"&&S?r.jsxs("div",{className:"nut-portion-stepper",children:[r.jsx("button",{className:"nut-stepper-btn",onClick:()=>it(Math.max(1,pt-1)),children:"-"}),r.jsxs("div",{className:"nut-stepper-display",children:[r.jsx("span",{className:"nut-stepper-count",children:pt}),r.jsxs("span",{className:"nut-stepper-label",children:[S.label,pt!==1?"s":""]}),r.jsxs("span",{className:"nut-stepper-weight",children:[Math.round(P),k]})]}),r.jsx("button",{className:"nut-stepper-btn",onClick:()=>it(pt+1),children:"+"})]}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"nut-serving-adjust",children:[r.jsxs("label",{children:["Serving (",k,")"]}),r.jsx("input",{type:"number",inputMode:"numeric",value:Gt,onChange:ze=>rt(ze.target.value),onFocus:ze=>ze.target.select(),min:"0"})]}),r.jsx("div",{className:"nut-quick-amounts",children:de.map(ze=>r.jsxs("button",{className:`nut-quick-btn${Gt===String(ze)?" active":""}`,onClick:()=>rt(String(ze)),children:[ze,k]},ze))})]}),r.jsx("div",{className:"nut-product-total",children:r.jsxs("span",{children:["Total: ",Math.round(ce.protein*B),"p / ",Math.round(ce.carbs*B),"c / ",Math.round(ce.fats*B),"f / ",Math.round(ce.calories*B)," cal"]})}),r.jsxs("div",{className:"nut-product-actions",children:[r.jsx("button",{className:"nut-btn-secondary",onClick:()=>{Xt(null),me("scan")},children:"Scan Again"}),r.jsx("button",{className:"nut-btn-primary",onClick:()=>At({name:ce.name,protein:Math.round(ce.protein*B),carbs:Math.round(ce.carbs*B),fats:Math.round(ce.fats*B),calories:Math.round(ce.calories*B),serving:Be}),children:"Add"})]})]})})(),$==="search"&&!ce&&r.jsxs("div",{className:"nut-search-area",children:[r.jsxs("div",{className:"nut-search-bar",children:[r.jsx("input",{type:"text",ref:As,value:Fe,onChange:k=>bt(k.target.value),onKeyDown:k=>{k.key==="Enter"&&(clearTimeout(Bt.current),_e())},onFocus:()=>setTimeout(()=>As.current?.scrollIntoView({behavior:"smooth",block:"center"}),350),placeholder:"Search food or product...",autoFocus:!0}),r.jsx("button",{onClick:_e,disabled:Wt,children:Wt?"...":"Search"})]}),r.jsxs("div",{className:"nut-search-results",children:[kt.map((k,S)=>r.jsxs("button",{className:"nut-search-item",onClick:()=>{Xt(k),k.portion?(it(1),rt(String(k.portion.weight)),Kt("portion")):(it(0),rt(String(k.servingValue||100)),Kt("weight"))},children:[k.image&&r.jsx("img",{src:k.image,alt:k.name||"Product",loading:"lazy"}),r.jsxs("div",{className:"nut-search-item-info",children:[r.jsx("span",{className:"nut-search-item-name",children:k.name}),k.brand&&r.jsx("span",{className:"nut-search-item-brand",children:k.brand}),r.jsxs("span",{className:"nut-search-item-macros",children:[k.calories," cal  ",k.protein,"p  ",k.carbs,"c  ",k.fats,"f per 100",k.servingUnit||"g"]})]})]},S)),kt.length===0&&Fe&&!Wt&&r.jsx("p",{className:"nut-search-empty",children:"No results found. Try a different search or use manual entry."})]})]}),$==="search"&&ce&&(()=>{const k=ce.servingUnit||"g",S=ce.portion,P=st==="portion"&&S?pt*S.weight:parseFloat(Gt)||0,B=P/100,de=k==="ml"?[100,200,250,500]:[50,100,150,200],Be=st==="portion"&&S?`${pt} ${S.label}${pt!==1?"s":""} (${Math.round(P)}${k})`:`${Math.round(P)}${k}`;return r.jsxs("div",{className:"nut-product-result",children:[ce.image&&r.jsx("img",{src:ce.image,alt:ce.name||"Product",className:"nut-product-img",loading:"lazy"}),r.jsxs("div",{className:"nut-product-name-row",children:[r.jsx("h4",{children:ce.name}),r.jsx("button",{className:`nut-fav-star confirm${fe(ce.name)?" active":""}`,onClick:()=>lt({name:ce.name,protein:ce.protein,carbs:ce.carbs,fats:ce.fats,calories:ce.calories,serving:ce.servingSize,per100g:{protein:ce.protein,carbs:ce.carbs,fats:ce.fats,calories:ce.calories},servingUnit:ce.servingUnit||"g",portion:ce.portion||null}),children:r.jsx("svg",{viewBox:"0 0 24 24",width:"22",height:"22",fill:fe(ce.name)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})})]}),ce.brand&&r.jsx("p",{className:"nut-product-brand",children:ce.brand}),r.jsxs("p",{className:"nut-product-per",children:["Per 100",k,":"]}),r.jsxs("div",{className:"nut-product-macros",children:[r.jsxs("span",{className:"nut-macro-p",children:[ce.protein,"g P"]}),r.jsxs("span",{className:"nut-macro-c",children:[ce.carbs,"g C"]}),r.jsxs("span",{className:"nut-macro-f",children:[ce.fats,"g F"]}),r.jsxs("span",{className:"nut-macro-cal",children:[ce.calories," cal"]})]}),S&&r.jsxs("div",{className:"nut-mode-toggle",children:[r.jsx("button",{className:st==="portion"?"active":"",onClick:()=>{Kt("portion"),pt<1&&it(1)},children:"Portions"}),r.jsxs("button",{className:st==="weight"?"active":"",onClick:()=>{Kt("weight"),rt(String(Math.round(P)||100))},children:["Custom (",k,")"]})]}),st==="portion"&&S?r.jsxs("div",{className:"nut-portion-stepper",children:[r.jsx("button",{className:"nut-stepper-btn",onClick:()=>it(Math.max(1,pt-1)),children:"-"}),r.jsxs("div",{className:"nut-stepper-display",children:[r.jsx("span",{className:"nut-stepper-count",children:pt}),r.jsxs("span",{className:"nut-stepper-label",children:[S.label,pt!==1?"s":""]}),r.jsxs("span",{className:"nut-stepper-weight",children:[Math.round(P),k]})]}),r.jsx("button",{className:"nut-stepper-btn",onClick:()=>it(pt+1),children:"+"})]}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"nut-serving-adjust",children:[r.jsxs("label",{children:["Serving (",k,")"]}),r.jsx("input",{type:"number",inputMode:"numeric",value:Gt,onChange:ze=>rt(ze.target.value),onFocus:ze=>ze.target.select(),min:"0"})]}),r.jsx("div",{className:"nut-quick-amounts",children:de.map(ze=>r.jsxs("button",{className:`nut-quick-btn${Gt===String(ze)?" active":""}`,onClick:()=>rt(String(ze)),children:[ze,k]},ze))})]}),r.jsx("div",{className:"nut-product-total",children:r.jsxs("span",{children:["Total: ",Math.round(ce.protein*B),"p / ",Math.round(ce.carbs*B),"c / ",Math.round(ce.fats*B),"f / ",Math.round(ce.calories*B)," cal"]})}),r.jsxs("div",{className:"nut-product-actions",children:[r.jsx("button",{className:"nut-btn-secondary",onClick:()=>Xt(null),children:"Back to Search"}),r.jsx("button",{className:"nut-btn-primary",onClick:()=>At({name:ce.name,protein:Math.round(ce.protein*B),carbs:Math.round(ce.carbs*B),fats:Math.round(ce.fats*B),calories:Math.round(ce.calories*B),serving:Be}),children:"Add"})]})]})})(),$==="manual"&&r.jsxs("div",{className:"nut-manual-form",children:[r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Food Name"}),r.jsx("input",{type:"text",value:St.name,onChange:k=>at(S=>({...S,name:k.target.value})),placeholder:"e.g. Chicken Breast",autoFocus:!0})]}),r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Serving Size (optional)"}),r.jsx("input",{type:"text",value:St.serving,onChange:k=>at(S=>({...S,serving:k.target.value})),placeholder:"e.g. 150g, 1 cup"})]}),r.jsxs("div",{className:"nut-manual-macros",children:[r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Protein (g)"}),r.jsx("input",{type:"number",value:St.protein,onChange:k=>at(S=>({...S,protein:k.target.value})),min:"0"})]}),r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Carbs (g)"}),r.jsx("input",{type:"number",value:St.carbs,onChange:k=>at(S=>({...S,carbs:k.target.value})),min:"0"})]}),r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Fats (g)"}),r.jsx("input",{type:"number",value:St.fats,onChange:k=>at(S=>({...S,fats:k.target.value})),min:"0"})]}),r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Calories"}),r.jsx("input",{type:"number",value:St.calories,onChange:k=>at(S=>({...S,calories:k.target.value})),min:"0"})]})]}),r.jsx("button",{className:"nut-btn-primary",disabled:!St.name.trim(),onClick:()=>At({name:St.name,protein:parseFloat(St.protein)||0,carbs:parseFloat(St.carbs)||0,fats:parseFloat(St.fats)||0,calories:parseFloat(St.calories)||0,serving:St.serving||""}),children:"Add Food"})]}),$==="favourites"&&!ce&&(()=>{const k=Q(),S=P=>{if(P.per100g){const B=P.per100g;Xt({name:P.name,brand:"",image:null,servingSize:P.serving||"100g",servingValue:100,servingUnit:P.servingUnit||"g",portion:P.portion||null,protein:B.protein,carbs:B.carbs,fats:B.fats,calories:B.calories,per100g:!0}),P.portion?(it(1),rt(String(P.portion.weight)),Kt("portion")):(it(0),rt("100"),Kt("weight"))}else At({name:P.name,protein:P.protein,carbs:P.carbs,fats:P.fats,calories:P.calories,serving:P.serving||""})};return r.jsx("div",{className:"nut-recent-area",children:k.length===0?r.jsx("p",{className:"nut-search-empty",children:"No favourites yet. Tap the star on any food to save it here."}):r.jsx("div",{className:"nut-recent-list",children:k.map((P,B)=>r.jsxs("div",{className:"nut-recent-item-row",children:[r.jsx("button",{className:"nut-fav-star active",onClick:de=>{de.stopPropagation(),lt(P)},children:r.jsx("svg",{viewBox:"0 0 24 24",width:"18",height:"18",fill:"currentColor",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),r.jsxs("button",{className:"nut-recent-item",onClick:()=>S(P),children:[r.jsxs("div",{className:"nut-recent-item-info",children:[r.jsx("span",{className:"nut-recent-item-name",children:P.name}),r.jsx("span",{className:"nut-recent-item-serving",children:P.serving||""})]}),r.jsxs("span",{className:"nut-recent-item-macros",children:[P.calories," cal"]})]})]},B))})})})(),$==="favourites"&&ce&&(()=>{const k=ce.servingUnit||"g",S=ce.portion,P=st==="portion"&&S?pt*S.weight:parseFloat(Gt)||0,B=P/100,de=k==="ml"?[100,200,250,500]:[50,100,150,200],Be=st==="portion"&&S?`${pt} ${S.label}${pt!==1?"s":""} (${Math.round(P)}${k})`:`${Math.round(P)}${k}`;return r.jsxs("div",{className:"nut-product-result",children:[r.jsxs("div",{className:"nut-product-name-row",children:[r.jsx("h4",{children:ce.name}),r.jsx("button",{className:`nut-fav-star confirm${fe(ce.name)?" active":""}`,onClick:()=>lt({name:ce.name,protein:ce.protein,carbs:ce.carbs,fats:ce.fats,calories:ce.calories,serving:ce.servingSize,per100g:{protein:ce.protein,carbs:ce.carbs,fats:ce.fats,calories:ce.calories},servingUnit:ce.servingUnit||"g",portion:ce.portion||null}),children:r.jsx("svg",{viewBox:"0 0 24 24",width:"22",height:"22",fill:fe(ce.name)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})})]}),r.jsxs("p",{className:"nut-product-per",children:["Per 100",k,":"]}),r.jsxs("div",{className:"nut-product-macros",children:[r.jsxs("span",{className:"nut-macro-p",children:[ce.protein,"g P"]}),r.jsxs("span",{className:"nut-macro-c",children:[ce.carbs,"g C"]}),r.jsxs("span",{className:"nut-macro-f",children:[ce.fats,"g F"]}),r.jsxs("span",{className:"nut-macro-cal",children:[ce.calories," cal"]})]}),S&&r.jsxs("div",{className:"nut-mode-toggle",children:[r.jsx("button",{className:st==="portion"?"active":"",onClick:()=>{Kt("portion"),pt<1&&it(1)},children:"Portions"}),r.jsxs("button",{className:st==="weight"?"active":"",onClick:()=>{Kt("weight"),rt(String(Math.round(P)||100))},children:["Custom (",k,")"]})]}),st==="portion"&&S?r.jsxs("div",{className:"nut-portion-stepper",children:[r.jsx("button",{className:"nut-stepper-btn",onClick:()=>it(Math.max(1,pt-1)),children:"-"}),r.jsxs("div",{className:"nut-stepper-display",children:[r.jsx("span",{className:"nut-stepper-count",children:pt}),r.jsxs("span",{className:"nut-stepper-label",children:[S.label,pt!==1?"s":""]}),r.jsxs("span",{className:"nut-stepper-weight",children:[Math.round(P),k]})]}),r.jsx("button",{className:"nut-stepper-btn",onClick:()=>it(pt+1),children:"+"})]}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"nut-serving-adjust",children:[r.jsxs("label",{children:["Serving (",k,")"]}),r.jsx("input",{type:"number",inputMode:"numeric",value:Gt,onChange:ze=>rt(ze.target.value),onFocus:ze=>ze.target.select(),min:"0"})]}),r.jsx("div",{className:"nut-quick-amounts",children:de.map(ze=>r.jsxs("button",{className:`nut-quick-btn${Gt===String(ze)?" active":""}`,onClick:()=>rt(String(ze)),children:[ze,k]},ze))})]}),r.jsx("div",{className:"nut-product-total",children:r.jsxs("span",{children:["Total: ",Math.round(ce.protein*B),"p / ",Math.round(ce.carbs*B),"c / ",Math.round(ce.fats*B),"f / ",Math.round(ce.calories*B)," cal"]})}),r.jsxs("div",{className:"nut-product-actions",children:[r.jsx("button",{className:"nut-btn-secondary",onClick:()=>Xt(null),children:"Back to Favourites"}),r.jsx("button",{className:"nut-btn-primary",onClick:()=>At({name:ce.name,protein:Math.round(ce.protein*B),carbs:Math.round(ce.carbs*B),fats:Math.round(ce.fats*B),calories:Math.round(ce.calories*B),serving:Be}),children:"Add"})]})]})})()]})}),r.jsx(aa,{active:"nutrition"}),ss&&r.jsx("div",{className:`toast-notification ${ss.type}`,children:ss.message})]})})}const k2="/login/assets/randomiser-glq9YJkL.jpg",_D="/login/assets/programme-card-workout-CnNzTYkz.webp",kD="/login/assets/prog-fullbody-4wk-r6m9HJys.jpg",jD="/login/assets/mg-arms-BeOQU3wx.jpg",TD=60,$p=5,ED=[{threshold:1e3,label:"1 Tonne"},{threshold:5e3,label:"5 Tonne"},{threshold:1e4,label:"10 Tonne"},{threshold:25e3,label:"25 Tonne"},{threshold:5e4,label:"50 Tonne"},{threshold:1e5,label:"100 Tonne"},{threshold:25e4,label:"250 Tonne"},{threshold:5e5,label:"500 Tonne"},{threshold:1e6,label:"1 Million kg"}],ND={"Dumbbell Floor Press":"push","Seated Dumbbell Shoulder Press":"push","Seated Dumbbell Arnold Press":"push","Dumbbell Overhead Tricep Extension":"push",Skullcrushers:"push","Dumbbell Lateral Raise":"push","Dumbbell Front Raise":"push","Dumbbell Squeeze Press":"push","Incline Dumbbell Press":"push","Dumbbell Fly":"push","Dumbbell Pullover":"push","Tricep Kickback":"push","Dumbbell Shrug":"push","Dumbbell Y-Raise":"push","Dumbbell Bent Over Row":"pull","Single Arm Bent Over Row":"pull","Bicep Curl":"pull","Hammer Curl":"pull","Dumbbell Bent Over Rear Delt Fly":"pull","Renegade Row":"pull","Wide Dumbbell Bent Over Row":"pull","Reverse Fly":"pull","Concentration Curl":"pull","Wide Grip Bicep Curl":"pull","Wrist Curl":"pull","Dumbbell Goblet Squats":"lower","Romanian Deadlifts":"lower","Forward Dumbbell Lunges":"lower","Dumbbell Sumo Squats":"lower","Weighted Calf Raises":"lower","1 Legged RDL":"lower","Dumbbell Box Step Ups":"lower","Dumbbell Squat Pulses":"lower","Dumbbell Reverse Lunges":"lower","Kettlebell Romanian Deadlift":"lower","Russian Twists Dumbbell":"core","Kettlebell Russian Twist":"core","Kettlebell Side Bends":"core","Kneeling Kettlebell Halo":"core","Kettlebell Bird Dog Drag":"core"},SD={fullbody_4wk:{duration:4,daysPerWeek:3},fullbody_8wk:{duration:8,daysPerWeek:3},fullbody_12wk:{duration:12,daysPerWeek:3},core_4wk:{duration:4,daysPerWeek:3},core_8wk:{duration:8,daysPerWeek:3},core_12wk:{duration:12,daysPerWeek:3},upper_4wk:{duration:4,daysPerWeek:3},lower_4wk:{duration:4,daysPerWeek:3}},CD={fullbody:"linear-gradient(160deg, rgba(153,49,60,0.15) 0%, rgba(153,49,60,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)",core:"linear-gradient(160deg, rgba(30,80,120,0.2) 0%, rgba(30,80,120,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)",upper:"linear-gradient(160deg, rgba(100,60,140,0.2) 0%, rgba(100,60,140,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)",lower:"linear-gradient(160deg, rgba(40,120,80,0.2) 0%, rgba(40,120,80,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)"},Wp={arms:"linear-gradient(160deg, rgba(180,60,60,0.2) 0%, rgba(180,60,60,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",chest:"linear-gradient(160deg, rgba(50,100,160,0.2) 0%, rgba(50,100,160,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",back:"linear-gradient(160deg, rgba(80,130,60,0.2) 0%, rgba(80,130,60,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",shoulders:"linear-gradient(160deg, rgba(160,100,40,0.2) 0%, rgba(160,100,40,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",legs:"linear-gradient(160deg, rgba(100,50,140,0.2) 0%, rgba(100,50,140,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",core:"linear-gradient(160deg, rgba(30,80,120,0.2) 0%, rgba(30,80,120,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)"},Gp=[{id:"fullbody_4wk",name:"4-Week Full Body",focus:"fullbody",duration:4,level:"All Levels",daysPerWeek:3,image:kD},{id:"fullbody_8wk",name:"8-Week Full Body",focus:"fullbody",duration:8,level:"Intermediate",daysPerWeek:3},{id:"fullbody_12wk",name:"12-Week Full Body",focus:"fullbody",duration:12,level:"Advanced",daysPerWeek:3},{id:"core_4wk",name:"4-Week Core",focus:"core",duration:4,level:"Beginner",daysPerWeek:3},{id:"core_8wk",name:"8-Week Core",focus:"core",duration:8,level:"Intermediate",daysPerWeek:3},{id:"core_12wk",name:"12-Week Core",focus:"core",duration:12,level:"Advanced",daysPerWeek:3},{id:"upper_4wk",name:"4-Week Upper Body",focus:"upper",duration:4,level:"Intermediate",daysPerWeek:3},{id:"lower_4wk",name:"4-Week Lower Body",focus:"lower",duration:4,level:"Intermediate",daysPerWeek:3}],Jc=[{key:"arms",label:"Arms",icon:"M7 5h2v14H7V5zm8 0h2v14h-2V5zm-5 4h4v6h-4V9z",image:jD},{key:"chest",label:"Chest",icon:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 15H9v-2h2v2zm4 0h-2v-2h2v2zm3-6c0 1.1-.36 2.12-.97 2.95l-.87-.87C16.7 12.53 17 11.8 17 11c0-2.76-2.24-5-5-5S7 8.24 7 11c0 .8.3 1.53.84 2.08l-.87.87A4.977 4.977 0 0 1 6 11c0-3.31 2.69-6 6-6s6 2.69 6 6z"},{key:"back",label:"Back",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm4 18H8v-6l-4-4 1.41-1.41L8 11.17V8h8v3.17l2.59-2.58L20 10l-4 4v6z"},{key:"shoulders",label:"Shoulders",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm8 10l-3-1.5c-.5-.25-1-.5-1.5-.5h-7c-.5 0-1 .25-1.5.5L4 12l-2 6h4l1.5 4h9L18 18h4l-2-6z"},{key:"legs",label:"Legs",icon:"M16.5 3A2.5 2.5 0 0 0 14 5.5 2.5 2.5 0 0 0 16.5 8 2.5 2.5 0 0 0 19 5.5 2.5 2.5 0 0 0 16.5 3zM14 9l-3 7h2l1 6h2l1-6h2l-3-7h-2z"},{key:"core",label:"Core",icon:"M12 2a4 4 0 0 1 4 4v1h-2V6a2 2 0 1 0-4 0v1H8V6a4 4 0 0 1 4-4zM8 9h8v2H8V9zm-1 4h10l-1 9H8l-1-9z"}],j2={chest:[{id:"chest_strength",name:"Chest Strength",desc:"Heavy pressing for max strength",level:"Intermediate",overview:"A heavy pressing session designed to build raw chest strength. Focus on controlled negatives and powerful pressing movements.",tips:["Go heavy  pick a weight where the last 2 reps are a real challenge","Control the negative (lowering phase) for 2-3 seconds","Keep your shoulder blades squeezed together throughout all pressing movements","Rest 90-120 seconds between sets to allow full recovery"],exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:4,reps:8,storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Dumbbell Squeeze Press",type:"weighted",sets:3,reps:10,storagePath:null},{name:"Incline Dumbbell Press",type:"weighted",sets:3,reps:10,storagePath:null},{name:"Dumbbell Pullover",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Dumbbell Fly",type:"weighted",sets:3,reps:12,storagePath:null}]},{id:"chest_hypertrophy",name:"Chest Hypertrophy",desc:"Volume training for muscle growth",level:"Intermediate",overview:"A high-volume chest session focused on time under tension and muscle growth. Lighter weights, more reps, and slow controlled movements.",tips:["Use moderate weight  you should feel the burn by rep 10","Squeeze your chest at the top of every rep for 1 second","Keep rest periods short at 60-90 seconds to keep the pump going","On press ups, go to failure on the final set"],exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Wide Press Up",type:"reps",sets:3,reps:15,storagePath:null},{name:"Dumbbell Fly",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Incline Dumbbell Press",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Press Up",type:"reps",sets:3,reps:20,storagePath:"exercises/bodyweight/upper/press up.mp4"}]},{id:"chest_endurance",name:"Chest Endurance",desc:"Bodyweight pushing to failure",level:"All Levels",overview:"No weights needed. This bodyweight-only session builds chest endurance and muscular stamina through high-rep push up variations.",tips:["Focus on full range of motion  chest to floor on every rep","Keep your core tight and body in a straight line throughout","Scale down to knee press ups if you can't maintain form","Push through the burn  the last 5 reps are where the growth happens"],exercises:[{name:"Press Up",type:"reps",sets:4,reps:20,storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Wide Press Up",type:"reps",sets:3,reps:15,storagePath:null},{name:"Diamond Press Up",type:"reps",sets:3,reps:12,storagePath:null},{name:"Decline Press Up",type:"reps",sets:3,reps:15,storagePath:null},{name:"Press Up Hold",type:"timed",sets:3,time:30,storagePath:null}]}],back:[{id:"back_strength",name:"Back Strength",desc:"Heavy rows for a thick back",level:"Intermediate",overview:"Build a thick, powerful back with heavy rowing movements. This session targets your lats, rhomboids, and traps for overall back development.",tips:["Go heavy on rows  use a weight that challenges you by rep 6-8","Drive your elbows back and squeeze your shoulder blades together at the top","Keep a slight bend in your knees and hinge at the hips for bent over movements","Rest 90-120 seconds between sets for full recovery"],exercises:[{name:"Dumbbell Bent Over Row",type:"weighted",sets:4,reps:8,storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Single Arm Bent Over Row",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Dumbbell Pullover",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Dumbbell Shrug",type:"weighted",sets:3,reps:15,storagePath:null}]},{id:"back_hypertrophy",name:"Back Hypertrophy",desc:"Width and thickness volume work",level:"Intermediate",overview:"A volume-focused back session combining rows and isolation moves to build width and thickness. Focus on the mind-muscle connection.",tips:["Use moderate weight  feel the stretch and squeeze on every rep","On renegade rows, keep your hips square to the floor and avoid rotating","For reverse flys, use lighter weight and focus on squeezing your rear delts","Keep rest to 60-90 seconds to maintain intensity"],exercises:[{name:"Renegade Row",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/upper/renegade row.mp4"},{name:"Wide Dumbbell Bent Over Row",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Single Arm Bent Over Row",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Reverse Fly",type:"weighted",sets:3,reps:15,storagePath:null},{name:"Prone Y-T-W Raises",type:"reps",sets:3,reps:10,storagePath:null}]},{id:"back_endurance",name:"Back Endurance",desc:"Bodyweight back conditioning",level:"All Levels",overview:"A bodyweight session to strengthen your posterior chain and improve posture. Great for back health, mobility, and muscular endurance.",tips:["On superman holds, lift your arms and legs simultaneously and hold tight","Focus on slow, controlled movements  quality over speed","Breathe steadily throughout timed holds  don't hold your breath","Engage your glutes and lower back together on every movement"],exercises:[{name:"Superman Hold",type:"timed",sets:4,time:30,storagePath:"exercises/bodyweight/upper/Superman Hold.mp4"},{name:"Prone Y-T-W Raises",type:"reps",sets:3,reps:12,storagePath:null},{name:"Reverse Snow Angel",type:"reps",sets:3,reps:12,storagePath:null},{name:"Bird Dog",type:"reps",sets:3,reps:12,storagePath:"exercises/bodyweight/core/Bird Dog.mp4"},{name:"Back Extension Hold",type:"timed",sets:3,time:30,storagePath:null}]}],shoulders:[{id:"shoulders_strength",name:"Shoulder Strength",desc:"Heavy pressing for boulder shoulders",level:"Intermediate",overview:"A heavy overhead pressing session to build strong, powerful shoulders. Compound movements first, followed by isolation work for all three delt heads.",tips:["Go heavy on presses  pick a weight where you struggle on the last 2 reps","Brace your core and avoid arching your back during overhead movements","Press straight up and control the weight down slowly","Rest 90-120 seconds between pressing sets, 60 seconds for isolation moves"],exercises:[{name:"Seated Dumbbell Shoulder Press",type:"weighted",sets:4,reps:8,storagePath:"exercises/dumbbells/upper/seated dumbbell shoulder press.mp4"},{name:"Seated Dumbbell Arnold Press",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/upper/seated dumbbell arnold press.mp4"},{name:"Dumbbell Front Raise",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell front raise.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Dumbbell Shrug",type:"weighted",sets:3,reps:15,storagePath:null}]},{id:"shoulders_hypertrophy",name:"Shoulder Hypertrophy",desc:"Volume and isolation for 3D delts",level:"Intermediate",overview:"A high-volume session targeting all three heads of the deltoid for that 3D capped shoulder look. Moderate weight, high reps, constant tension.",tips:["Use lighter weight than you think  shoulders respond best to high reps","On lateral raises, lead with your elbows and don't swing the weight","Pause at the top of each raise for a 1-second squeeze","Keep rest periods at 60 seconds to maximise the pump"],exercises:[{name:"Seated Dumbbell Arnold Press",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/seated dumbbell arnold press.mp4"},{name:"Dumbbell Lateral Raise",type:"weighted",sets:4,reps:15,storagePath:"exercises/dumbbells/upper/dumbbell lateral raise.mp4"},{name:"Dumbbell Front Raise",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell front raise.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,reps:15,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Dumbbell Y-Raise",type:"weighted",sets:3,reps:12,storagePath:null}]},{id:"shoulders_endurance",name:"Shoulder Endurance",desc:"Bodyweight and high-rep work",level:"All Levels",overview:"A shoulder endurance session combining bodyweight movements with high-rep dumbbell work. Builds stamina, stability, and shoulder resilience.",tips:["On pike push ups, walk your feet close to your hands to increase the angle","For high-rep lateral raises, use a very light weight and focus on form","Wall walks are advanced  scale to pike push ups if needed","Keep your core braced throughout to protect your lower back"],exercises:[{name:"Pike Push Ups",type:"reps",sets:4,reps:12,storagePath:"exercises/bodyweight/upper/pike push ups.mp4"},{name:"Dumbbell Lateral Raise",type:"weighted",sets:3,reps:20,storagePath:"exercises/dumbbells/upper/dumbbell lateral raise.mp4"},{name:"Wall Walks",type:"reps",sets:3,reps:6,storagePath:null},{name:"Prone Y-T-W Raises",type:"reps",sets:3,reps:10,storagePath:null},{name:"Shoulder Tap Hold",type:"timed",sets:3,time:30,storagePath:null}]}],arms:[{id:"arms_bicep",name:"Bicep Focus",desc:"Curl variations for peak biceps",level:"All Levels",overview:"An arm session dedicated entirely to biceps. Multiple curl variations target different parts of the bicep for maximum peak and thickness.",tips:["Keep your elbows pinned to your sides  no swinging","Control the negative (lowering) for 2-3 seconds on every rep","Start with your heaviest weight and decrease as you fatigue","Squeeze hard at the top of each curl for a full contraction"],exercises:[{name:"Bicep Curl",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Hammer Curl",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/hammer curl.mp4"},{name:"Concentration Curl",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Wide Grip Bicep Curl",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Isometric Bicep Hold",type:"timed",sets:3,time:20,storagePath:null}]},{id:"arms_tricep",name:"Tricep Focus",desc:"Extensions and dips for horseshoe triceps",level:"All Levels",overview:"All-out tricep training with extensions, dips, and pressing movements. The triceps make up two-thirds of your arm  this session builds serious size.",tips:["On overhead extensions, keep your elbows close to your head","For skullcrushers, lower the weight slowly to just above your forehead","On dips, lean slightly forward to reduce shoulder strain","Full lockout at the top of every extension for maximum tricep contraction"],exercises:[{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Skullcrushers",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/skullcrushers.mp4"},{name:"Tricep Dips",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/upper/tricep dips.mp4"},{name:"Tricep Kickback",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Diamond Press Up",type:"reps",sets:3,reps:12,storagePath:null}]},{id:"arms_full",name:"Full Arms",desc:"Superset biceps and triceps",level:"All Levels",overview:"A balanced arm session alternating between biceps and triceps. Superset style keeps the intensity high and maximises the pump.",tips:["Superset each pair  do biceps then immediately hit triceps","Use moderate weight that lets you maintain strict form for all reps","Rest 60 seconds after each superset pair","Focus on the squeeze at the peak contraction of every rep"],exercises:[{name:"Bicep Curl",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Tricep Kickback",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Hammer Curl",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/hammer curl.mp4"},{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Wrist Curl",type:"weighted",sets:3,reps:15,storagePath:null}]}],legs:[{id:"legs_quad",name:"Quad Dominant",desc:"Squats and lunges for quad power",level:"All Levels",overview:"A quad-focused leg session built around squats and lunges. Heavy compound movements to build strong, powerful quads and overall leg strength.",tips:["On goblet squats, hold the dumbbell close to your chest and sit deep","Keep your knees tracking over your toes  don't let them cave inward","Drive through your heels on all squatting movements","Rest 90-120 seconds between heavy sets, 60 seconds on bodyweight moves"],exercises:[{name:"Dumbbell Goblet Squats",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Forward Dumbbell Lunges",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.mp4"},{name:"Dumbbell Squat Pulses",type:"weighted",sets:3,reps:15,storagePath:"exercises/dumbbells/lower/dumbbell squat pulses.mp4"},{name:"Bulgarian Split Squats",type:"reps",sets:3,reps:12,storagePath:"exercises/bodyweight/lower/bulgarian split squats.mp4"},{name:"Squat And Hold",type:"timed",sets:3,time:30,storagePath:"exercises/bodyweight/lower/squat and hold.mp4"}]},{id:"legs_ham_glute",name:"Hamstring & Glute",desc:"Posterior chain focus",level:"Intermediate",overview:"Target the back of your legs with deadlift and hip hinge variations. This session builds a strong posterior chain  hamstrings, glutes, and lower back.",tips:["On RDLs, push your hips back and feel the stretch in your hamstrings","Keep a slight bend in your knees throughout hip hinge movements","Squeeze your glutes hard at the top of every rep","For single leg work, start with your weaker side first"],exercises:[{name:"Romanian Deadlifts",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/lower/romanian deadlifts.mp4"},{name:"1 Legged RDL",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/lower/1 legged rdl.mp4"},{name:"Hip Thrusts",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/lower/hip thrusts.mp4"},{name:"Dumbbell Sumo Squats",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/dumbbell sumo squats.mp4"},{name:"Donkey Kicks",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/lower/donkey kicks.mp4"}]},{id:"legs_power",name:"Power & Plyo",desc:"Explosive leg training",level:"Intermediate",overview:"An explosive leg session combining plyometrics with weighted movements. Build power, speed, and athletic performance.",tips:["On jump squats, land softly with bent knees to absorb the impact","Explode up on every rep  power comes from speed, not just weight","Keep rest periods at 60-90 seconds to maintain intensity","Focus on landing mechanics  knees out, chest up, soft landing"],exercises:[{name:"Jump Squats",type:"reps",sets:4,reps:12,storagePath:"exercises/bodyweight/lower/jump squats.mp4"},{name:"Dumbbell Box Step Ups",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/dumbbell box step ups.mp4"},{name:"Skater Jumps",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/lower/skater jumps.mp4"},{name:"Dumbbell Reverse Lunges",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/dumbbell reverse lunges.mp4"},{name:"Weighted Calf Raises",type:"weighted",sets:4,reps:15,storagePath:"exercises/dumbbells/lower/weighted calf raises.mp4"}]}],core:[{id:"core_lower_abs",name:"Lower Abs Blast",desc:"40s work / 20s rest  3 rounds",level:"Intermediate",overview:"An interval-based core burner targeting the lower abdominals. 40 seconds of work followed by 20 seconds of rest  keep the intensity high and your lower back pressed into the floor throughout.",tips:["Press your lower back firmly into the floor on every rep","Exhale hard as you contract your abs  don't hold your breath","If your lower back lifts off the ground, reduce the range of motion","Focus on slow, controlled movements rather than speed"],interval:!0,rounds:3,work:40,rest:20,exercises:[{name:"Leg Raises",storagePath:"exercises/bodyweight/core/Leg Raises.mp4"},{name:"Reverse Crunch To Leg Raise",storagePath:"exercises/bodyweight/core/Reverse Crunch To Leg Raise.mp4"},{name:"Flutter Kicks",storagePath:"exercises/bodyweight/core/Flutter Kicks.mp4"},{name:"Dead Bug Single Leg Drop",storagePath:"exercises/bodyweight/core/Dead Bug Single Leg Drop.mp4"},{name:"Hollow Body Hold",storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"},{name:"Hollow Hold Flutter Kicks",storagePath:"exercises/bodyweight/core/Hollow Hold Flutter Kicks.mp4"}]},{id:"core_obliques",name:"Obliques & Rotation",desc:"35s work / 25s rest  3 rounds",level:"Intermediate",overview:"Target the obliques and rotational core muscles with this interval session. 35 seconds of work with 25 seconds rest  every exercise involves twisting, rotating, or side-bracing movements.",tips:["Rotate from your ribcage, not just your arms","Keep your hips as still as possible during twisting exercises","Brace your core before each movement  think about squeezing a belt","On side planks, stack your hips and push the floor away"],interval:!0,rounds:3,work:35,rest:25,exercises:[{name:"Russian Twist",storagePath:"exercises/bodyweight/core/Russian Twist.mp4"},{name:"Side Plank Rotation",storagePath:"exercises/bodyweight/core/Side Plank Rotation.mp4"},{name:"Cross Body Mountain Climbers",storagePath:"exercises/bodyweight/core/Cross Body Mountain Climbers.mp4"},{name:"Hip Dips Plank",storagePath:"exercises/bodyweight/core/Hip Dips Plank.mp4"},{name:"Bicycle Crunch",storagePath:"exercises/bodyweight/core/Bicycle Crunch.mp4"},{name:"Side Plank",storagePath:"exercises/bodyweight/core/Side Plank.mp4"}]},{id:"core_weighted",name:"Weighted Core",desc:"40s work / 20s rest  3 rounds",level:"Advanced",overview:"Add resistance to your core training with dumbbells and kettlebells. 40 seconds of weighted work followed by 20 seconds rest  this session builds serious core strength and stability.",tips:["Start with a moderate weight  form is more important than load","Brace your entire core before picking up the weight each round","Keep movements controlled  no swinging or using momentum","If grip fails before core does, go slightly lighter next time"],interval:!0,rounds:3,work:40,rest:20,exercises:[{name:"Russian Twists Dumbbell",storagePath:"exercises/dumbbells/core/russian twists dumbbell.mp4"},{name:"Kettlebell Russian Twist",storagePath:"exercises/kettlebells/core/kettlebell russian twist.mp4"},{name:"Kettlebell Side Bends",storagePath:"exercises/kettlebells/core/kettlebell side bends.mp4"},{name:"Kneeling Kettlebell Halo",storagePath:"exercises/kettlebells/core/kneeling kettlebell halo.mp4"},{name:"Kettlebell Bird Dog Drag",storagePath:"exercises/kettlebells/core/kettlebell bird dog drag.mp4"},{name:"Dumbbell Plank Pull Through",storagePath:null}]}]},T2=[{key:"bodyweight",label:"Bodyweight",icon:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 3c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm0 14.2c-2.5 0-4.71-1.28-6-3.22.03-1.99 4-3.08 6-3.08 1.99 0 5.97 1.09 6 3.08-1.29 1.94-3.5 3.22-6 3.22z"},{key:"dumbbells",label:"Dumbbells",icon:"M1 9h2v6H1V9zm3-2h2v10H4V7zm3 4h10v2H7v-2zm10-4h2v10h-2V7zm3 2h2v6h-2V9z"},{key:"kettlebells",label:"Kettlebells",icon:"M12 2C9.24 2 7 4.24 7 7c0 1.1.36 2.12.97 2.95C6.76 11.08 6 12.96 6 15c0 3.87 2.69 7 6 7s6-3.13 6-7c0-2.04-.76-3.92-1.97-5.05.61-.83.97-1.85.97-2.95 0-2.76-2.24-5-5-5zm0 2c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3z"}],Kp=[{key:"core",label:"Core",icon:"M12 2a4 4 0 0 1 4 4v1h-2V6a2 2 0 1 0-4 0v1H8V6a4 4 0 0 1 4-4zM8 9h8v2H8V9zm-1 4h10l-1 9H8l-1-9z"},{key:"upper",label:"Upper",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm8 10l-3-1.5c-.5-.25-1-.5-1.5-.5h-7c-.5 0-1 .25-1.5.5L4 12l-2 6h4l1.5 4h9L18 18h4l-2-6z"},{key:"lower",label:"Lower",icon:"M16.5 3A2.5 2.5 0 0 0 14 5.5 2.5 2.5 0 0 0 16.5 8 2.5 2.5 0 0 0 19 5.5 2.5 2.5 0 0 0 16.5 3zM14 9l-3 7h2l1 6h2l1-6h2l-3-7h-2z"},{key:"fullbody",label:"Full Body",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm-2 8h4l1 4h2l-1 4h-2l-1 4h-2l-1-4H8l-1-4h2l1-4z"},{key:"mix",label:"Mix It Up",icon:"M10.59 9.17L5.41 4 4 5.41l5.17 5.17 1.42-1.41zM14.5 4l2.04 2.04L4 18.59 5.41 20 17.96 7.46 20 9.5V4h-5.5zm-.83 9.41l-1.42 1.42L17.96 20.54l1.42-1.42-5.71-5.71z"}],Dl=[{key:"beginner",label:"Beginner",work:30,rest:30,desc:"30s work / 30s rest"},{key:"intermediate",label:"Intermediate",work:40,rest:20,desc:"40s work / 20s rest"},{key:"advanced",label:"Advanced",work:40,rest:15,desc:"40s work / 15s rest"}],Yp=[5,10,15,20,30];function RD(n){return n.replace(/\b\w/g,e=>e.toUpperCase())}function AD(n){const e=[...n];for(let t=e.length-1;t>0;t--){const i=Math.floor(Math.random()*(t+1));[e[t],e[i]]=[e[i],e[t]]}return e}function ID(){const{currentUser:n,isClient:e,clientData:t,loading:i}=Mr(),{isDark:l,toggleTheme:u,accent:d}=ka(),{isPremium:p,FREE_RANDOMISER_DURATIONS:g,FREE_RANDOMISER_WEEKLY_LIMIT:y}=wm(),w=$n(),[j,T]=v.useState("menu"),[V,W]=v.useState(["bodyweight"]),[F,U]=v.useState("core"),[ne,Y]=v.useState("intermediate"),[oe,be]=v.useState(p?15:5),[Le,Ce]=v.useState([]),[R,E]=v.useState(!1),A=v.useRef(!1),O=v.useRef([]),[D,H]=v.useState([]),[M,We]=v.useState(2),[gt,$]=v.useState(Dl[1]),[me,Ve]=v.useState(1),[Ke,J]=v.useState(0),[L,se]=v.useState("work"),[Me,De]=v.useState(0),[Je,Fe]=v.useState(!1),[bt,kt]=v.useState(0),[nt,Wt]=v.useState(null),ts=v.useRef(null);v.useRef(null),v.useRef(null);const[St,at]=v.useState(null),ce=v.useCallback((K,ve="info")=>{at({message:K,type:ve}),setTimeout(()=>at(null),3e3)},[]),[Xt,Gt]=v.useState(null),[rt,pt]=v.useState(null),[it,st]=v.useState(0),[Kt,Ks]=v.useState(0),[Ps,ss]=v.useState([]),[Ct,Jt]=v.useState(""),[vs,Bt]=v.useState(""),[As,ue]=v.useState(!1),[Ee,Ae]=v.useState(0),[ee,ge]=v.useState(!1),[we,Oe]=v.useState({}),Ue=v.useRef(null),$e=v.useRef(null),[ft,jt]=v.useState([]),[Q,fe]=v.useState(null),[lt,At]=v.useState(0),[Tt,ns]=v.useState(0),[Ut,Ot]=v.useState(0),[Ls,Js]=v.useState(0),[os,Ss]=v.useState(0),[Os,q]=v.useState(0),[xe,je]=v.useState({beginner:0,intermediate:0,advanced:0}),Te=p?Yp:Yp.filter(K=>g.includes(K)),_e=!p&&lt>=y,[ct,ht]=v.useState(null),[et,vt]=v.useState(""),[Rt,js]=v.useState(!1);v.useEffect(()=>{!i&&(!n||!e)&&w("/")},[n,e,i,w]),v.useEffect(()=>{if(!n||!t)return;(async()=>{try{const ve=zt(pe,"workoutLogs"),te=Ds(ve,hs("clientId","==",t.id)),Ge=(await Es(te)).docs.map(is=>is.data()),ut=Ge.filter(is=>is.type!=="programme");Js(ut.length);const wt=ut.reduce((is,un)=>is+(un.duration||0),0);Ss(wt);const Mt={beginner:0,intermediate:0,advanced:0};ut.forEach(is=>{is.level&&Mt[is.level]!==void 0&&Mt[is.level]++}),je(Mt);const ws=new Date,cn=ws.getDay(),ms=cn===0?-6:1-cn,Wn=new Date(ws);Wn.setDate(ws.getDate()+ms),Wn.setHours(0,0,0,0);const Gr=Wn.getTime(),pn=Ge.filter(is=>{const un=is.completedAt;return un?(un.toDate?un.toDate().getTime():new Date(un).getTime())>=Gr:!1});At(pn.filter(is=>is.type!=="programme").length);let ja=0;if(t)try{const is=await Rs(He(pe,"clientProgrammes",t.id));if(is.exists()){const un=is.data(),sr=un.templateId;ja=pn.filter(tn=>tn.type==="programme"&&tn.programmeId===sr).length,ht(sr);const Gn=Gp.find(tn=>tn.id===sr);Gn&&vt(Gn.name);const _r=SD[sr];if(_r){const tn=Object.keys(un.completedSessions||{}).length,Ln=_r.duration*_r.daysPerWeek;Ot(Ln>0?Math.round(tn/Ln*100):0)}}else ht(null),vt(""),Ot(0)}catch{}ns(ja);const Un=ut.map(is=>is.completedAt).filter(Boolean).map(is=>is.toDate?is.toDate().getTime():new Date(is).getTime()).sort((is,un)=>un-is);if(Un.length===0)q(0);else{const is=new Set;Un.forEach(Ln=>{const Sn=new Date(Ln),kr=Sn.getDay(),jr=kr===0?-6:1-kr,Dr=new Date(Sn);Dr.setDate(Sn.getDate()+jr),Dr.setHours(0,0,0,0),is.add(Dr.getTime())});const un=[...is].sort((Ln,Sn)=>Sn-Ln);let sr=0;const Gn=new Date(ws),_r=ws.getDay()===0?-6:1-ws.getDay();Gn.setDate(ws.getDate()+_r),Gn.setHours(0,0,0,0);let tn=Gn.getTime();un.includes(tn)||(tn-=10080*60*1e3);for(let Ln=0;Ln<200&&un.includes(tn);Ln++)sr++,tn-=10080*60*1e3;q(sr)}}catch(ve){console.error("Error loading workout stats:",ve)}finally{js(!0)}})()},[n,t,j]);const mn=()=>{const K=[];let ve;F==="mix"?ve=["core","upper","lower"]:F==="fullbody"?ve=["upper","lower"]:ve=[F];for(const te of V)for(const qe of ve)K.push(`exercises/${te}/${qe}`);return K},ln=async()=>{if(A.current){for(;A.current;)await new Promise(K=>setTimeout(K,200));return O.current}A.current=!0,E(!0);try{const K=mn(),ve=[];for(const ut of K)try{const wt=eo(to,ut),Mt=await x2(wt);ve.push(...Mt.items)}catch{console.warn(`Folder ${ut} not found, skipping.`)}if(ve.length===0&&V.includes("bodyweight")&&F==="core")try{const ut=eo(to,"core"),wt=await x2(ut);ve.push(...wt.items)}catch{console.warn("Legacy core/ folder not found either.")}if(ve.length===0){const ut=V.map(Mt=>T2.find(ws=>ws.key===Mt)?.label).join(" + "),wt=Kp.find(Mt=>Mt.key===F)?.label;return ce(`No exercises found for ${ut} / ${wt}. Upload videos to Firebase Storage.`,"error"),A.current=!1,E(!1),[]}const te=new Set,qe=ve.filter(ut=>{const wt=ut.name.replace(/\.(mp4|gif)$/i,"");return te.has(wt)?!1:(te.add(wt),!0)}),Ge=await Promise.all(qe.map(async ut=>{const wt=await qo(ut),Mt=RD(ut.name.replace(/\.(mp4|gif)$/i,"")),ws=/\.gif$/i.test(ut.name);return{name:Mt,videoUrl:wt,isGif:ws}}));return O.current=Ge,Ce(Ge),A.current=!1,E(!1),Ge}catch(K){console.error("Error loading exercises:",K);const ve=K.code==="storage/unauthorized"?"Storage access denied. Check Firebase Storage rules allow read access.":`Failed to load exercises: ${K.message||K.code||"Unknown error"}`;return ce(ve,"error"),A.current=!1,E(!1),[]}},_n=async()=>{if(_e)return;T("spinning"),O.current=[];const K=await ln();if(K.length===0){T("setup");return}const ve=Dl.find(cn=>cn.key===ne);$(ve);const te=ve.work+ve.rest,qe=oe*60,Ge=Math.floor(qe/te);let ut,wt;Ge<=6?(ut=Math.max(3,Math.floor(Ge/2)),wt=Math.floor(Ge/ut)):Ge<=12?(ut=Math.min(6,Math.floor(Ge/2)),wt=Math.floor(Ge/ut)):(ut=Math.min(10,Math.floor(Ge/2)),wt=Math.floor(Ge/ut)),wt=Math.max(2,wt);const Mt=AD(K),ws=Mt.slice(0,Math.min(ut,Mt.length));H(ws),We(wt),setTimeout(()=>T("preview"),2e3)},kn=()=>{T("countdown"),kt(3)};v.useEffect(()=>{if(j!=="countdown")return;if(bt<=0){T("workout"),Ve(1),J(0),se("work"),De(gt.work),Fe(!1),xs();return}qt();const K=setTimeout(()=>kt(ve=>ve-1),1e3);return()=>clearTimeout(K)},[bt,j]),v.useEffect(()=>{if(j!=="workout"||Je)return;if(Me<=0){fn();return}Me<=3&&qt();const K=setTimeout(()=>De(ve=>ve-1),1e3);return()=>clearTimeout(K)},[Me,j,Je]);const fn=()=>{if(L==="work")se("rest"),De(gt.rest);else{const K=Ke+1;if(K>=D.length){const ve=me+1;if(ve>M){T("complete"),Fs();return}Ve(ve),J(0)}else J(K);se("work"),De(gt.work),xs()}},Fs=async()=>{if(n)try{await hi(zt(pe,"workoutLogs"),{clientId:t.id,level:ne,duration:oe,equipment:V,focus:F,exerciseCount:D.length,rounds:M,exercises:D.map(K=>K.name),completedAt:xt.now()}),At(K=>K+1),Js(K=>K+1),Ss(K=>K+oe),je(K=>({...K,[ne]:(K[ne]||0)+1}))}catch(K){console.error("Error saving workout log:",K)}},k=async(K,ve,te)=>{if(!(!t||!ve))try{const qe=t.id,Ge=await Rs(He(pe,"coreBuddyPBs",qe)),wt=(Ge.exists()?Ge.data():null)?.exercises||{},Mt=wt[K];let ws=!1;if(Mt?(ve>(Mt.weight||0)||ve===(Mt.weight||0)&&te>(Mt.reps||0))&&(ws=!0):ws=!0,ws){const cn={...wt,[K]:{weight:ve,reps:te,achievedAt:xt.now()}};await Ns(He(pe,"coreBuddyPBs",qe),{clientId:t.id,exercises:cn,updatedAt:xt.now()}),ce(`New PB! ${ve}kg  ${te} reps`,"success"),qt(),await S(K,ve)}}catch(qe){console.error("Error checking PB:",qe)}},S=async(K,ve)=>{if(t)try{const te=await Rs(He(pe,"coreBuddyTargets",t.id));if(!te.exists())return;const Ge=(te.data().targets||{})[K];if(!Ge||ve<Ge.targetWeight)return;const ut=await Rs(He(pe,"coreBuddyAchievements",t.id)),wt=ut.exists()?ut.data():{clientId:t.id,badges:[],totalVolume:0};if(wt.badges.some(ms=>ms.type==="pb_target"&&ms.exercise===K&&ms.targetWeight===Ge.targetWeight))return;const ws={type:"pb_target",exercise:K,group:ND[K]||"push",targetWeight:Ge.targetWeight,achievedAt:xt.now()},cn=[...wt.badges,ws];await Ns(He(pe,"coreBuddyAchievements",t.id),{...wt,badges:cn,updatedAt:xt.now()}),jt(ms=>[...ms,ws])}catch(te){console.error("Error checking target badge:",te)}},P=async K=>{if(!(!t||K<=0))try{const ve=await Rs(He(pe,"coreBuddyAchievements",t.id)),te=ve.exists()?ve.data():{clientId:t.id,badges:[],totalVolume:0},qe=te.totalVolume||0,Ge=qe+K,ut=[];ED.forEach(Mt=>{Ge>=Mt.threshold&&qe<Mt.threshold&&(te.badges.some(cn=>cn.type==="volume_milestone"&&cn.milestone===Mt.threshold)||ut.push({type:"volume_milestone",milestone:Mt.threshold,label:Mt.label,achievedAt:xt.now()}))});const wt=[...te.badges,...ut];await Ns(He(pe,"coreBuddyAchievements",t.id),{clientId:t.id,badges:wt,totalVolume:Math.round(Ge),updatedAt:xt.now()}),ut.length>0&&jt(Mt=>[...Mt,...ut])}catch(ve){console.error("Error updating volume:",ve)}},B=async K=>{if(pt(K),K.interval){const qe=[];for(const Ge of K.exercises){let ut=null,wt=!1;if(Ge.storagePath)try{const Mt=eo(to,Ge.storagePath);ut=await qo(Mt),wt=/\.gif$/i.test(Ge.storagePath)}catch{}qe.push({name:Ge.name,videoUrl:ut,isGif:wt})}H(qe),We(K.rounds),$({work:K.work,rest:K.rest}),T("preview");return}const ve={};for(const qe of K.exercises)if(qe.storagePath)try{const Ge=eo(to,qe.storagePath);ve[qe.name]={url:await qo(Ge),isGif:/\.gif$/i.test(qe.storagePath)}}catch{}Oe(ve);const te=K.exercises.map(qe=>({name:qe.name,type:qe.type,targetSets:qe.sets,targetReps:qe.reps||0,targetTime:qe.time||0,sets:[]}));ss(te),st(0),Ks(0),Jt(""),Bt(""),ge(!1),ue(!1),Ae(0),jt([]),fe(null),T("muscle_workout")},de=()=>{const K=Ue.current;K&&(K.paused?(K.play(),ge(!0)):(K.pause(),ge(!1)))};v.useEffect(()=>{if(j!=="muscle_workout"||!As||Ee<=0){j==="muscle_workout"&&As&&Ee<=0&&(ue(!1),qt());return}return $e.current=setTimeout(()=>Ae(K=>K-1),1e3),()=>clearTimeout($e.current)},[j,As,Ee]);const Be=async()=>{const K=Ps[it];let ve={};if(K.type==="weighted"){const Ge=parseFloat(Ct)||0,ut=parseInt(vs)||0;if(ut===0){ce("Enter your reps","error");return}ve={weight:Ge,reps:ut}}else if(K.type==="reps"){const Ge=parseInt(vs)||0;if(Ge===0){ce("Enter your reps","error");return}ve={reps:Ge}}else if(K.type==="timed"){const Ge=K.targetTime-Ee;ve={time:Math.max(Ge,1)}}const te=[...Ps];te[it]={...K,sets:[...K.sets,ve]},ss(te),K.type==="weighted"&&ve.weight>0&&await k(K.name,ve.weight,ve.reps);const qe=K.sets.length+1;if(qe<K.targetSets)Ks(qe),Bt(""),ue(!1),Ae(0);else if(it+1<Ps.length){const Ge=it+1;st(Ge),Ks(0),Jt(""),Bt(""),ge(!1),ue(!1),Ae(0)}else await ze(te),T("muscle_complete")},ze=async K=>{if(!(!n||!t))try{const ve=K.reduce((qe,Ge)=>qe+Ge.sets.reduce((ut,wt)=>ut+(wt.weight||0)*(wt.reps||0),0),0),te=K.reduce((qe,Ge)=>qe+Ge.sets.length,0);await hi(zt(pe,"workoutLogs"),{clientId:t.id,type:"muscle_group",muscleGroup:Xt,sessionId:rt?.id,sessionName:rt?.name,exerciseCount:K.length,totalSets:te,duration:Math.round(te*1.5),volume:Math.round(ve),exercises:K.map(qe=>({name:qe.name,type:qe.type,sets:qe.sets})),completedAt:xt.now()}),ve>0&&await P(ve),ft.length>0&&fe({badges:[...ft]})}catch(ve){console.error("Error saving muscle group workout log:",ve)}},Qe=v.useRef(null),Xe=()=>(Qe.current||(Qe.current=new(window.AudioContext||window.webkitAudioContext)),Qe.current),qt=()=>{try{const K=Xe(),ve=K.createOscillator(),te=K.createGain();ve.connect(te),te.connect(K.destination),ve.frequency.value=880,te.gain.value=.3,ve.start(K.currentTime),ve.stop(K.currentTime+.15)}catch{}},xs=()=>{try{const K=Xe(),ve=K.createOscillator(),te=K.createGain();ve.connect(te),te.connect(K.destination),ve.frequency.value=1200,te.gain.value=.4,ve.start(K.currentTime),ve.stop(K.currentTime+.3)}catch{}};v.useEffect(()=>{if(j!=="workout"||L!=="work"||!D[Ke]?.isGif)return;const ve=setInterval(()=>{const te=ts.current;if(!te)return;const qe=te.getAttribute("src");te.removeAttribute("src"),setTimeout(()=>{ts.current&&ts.current.setAttribute("src",qe)},0)},4e3);return()=>clearInterval(ve)},[j,L,Ke,me,D]);const ls=(K,ve,te)=>{const qe=Math.round(K/ve*TD);return r.jsx("svg",{className:"wk-ring-svg",viewBox:"0 0 200 200",children:X3.map((Ge,ut)=>r.jsx("line",{x1:Ge.x1,y1:Ge.y1,x2:Ge.x2,y2:Ge.y2,className:ut<qe?`wk-tick-filled ${te}`:"wk-tick-empty",strokeWidth:Ge.thick?"3":"2"},ut))})},cs=()=>{const K=D.length*M;return((me-1)*D.length+Ke+(L==="rest"?.5:0))/K},Cs=St&&r.jsx("div",{className:`toast-notification ${St.type}`,children:St.message});if(i)return r.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>w("/client/core-buddy"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})]})}),r.jsx("div",{className:"wk-loading-inline",children:r.jsx("div",{className:"wk-loading-spinner"})})]});if(j==="menu")return r.jsx(xa,{children:r.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>w("/client/core-buddy"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),r.jsxs("main",{className:"wk-main",children:[r.jsxs("div",{className:"wk-menu-heading",children:[r.jsx("h2",{children:"Choose Your Workout"}),r.jsx("p",{children:"No excuses. Just results."})]}),r.jsx("button",{className:"wk-hero-card",onClick:()=>T("setup"),children:r.jsx("img",{src:k2,alt:"Randomise Workout",className:"wk-hero-bg"})}),r.jsxs("div",{className:"wk-section-header",children:[r.jsxs("h2",{children:["Programmes ",!p&&r.jsx("span",{className:"cb-premium-badge",children:"PREMIUM"})]}),r.jsxs("span",{className:"wk-section-count",children:[Gp.length," available"]})]}),p?r.jsx("div",{className:"wk-prog-scroll-wrap",children:r.jsx("div",{className:"wk-prog-scroll",children:Gp.map((K,ve)=>K.image?r.jsxs("button",{className:"wk-prog-img-card",onClick:()=>w("/client/core-buddy/programmes",{state:{templateId:K.id}}),style:{animationDelay:`${ve*.06}s`},children:[r.jsx("img",{src:K.image,alt:K.name,className:"wk-prog-img"}),ve===0&&r.jsx("div",{className:"wk-swipe-arrow",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})})]},K.id):r.jsxs("button",{className:"wk-prog-hero-card",onClick:()=>w("/client/core-buddy/programmes",{state:{templateId:K.id}}),style:{animationDelay:`${ve*.06}s`},children:[r.jsx("img",{src:_D,alt:"Programme",className:"wk-prog-hero-bg",loading:"lazy"}),r.jsx("div",{className:"wk-prog-hero-overlay",style:{background:CD[K.focus]}}),r.jsxs("div",{className:"wk-prog-hero-content",children:[r.jsxs("div",{className:"wk-prog-hero-top",children:[r.jsxs("span",{className:"wk-prog-hero-badge",children:[K.duration," WEEKS"]}),r.jsx("span",{className:"wk-prog-hero-level",children:K.level})]}),r.jsxs("div",{className:"wk-prog-hero-bottom",children:[r.jsx("h3",{children:K.name.toUpperCase()}),r.jsxs("p",{children:[K.daysPerWeek,"x per week  ",K.focus==="fullbody"?"Full Body":K.focus.charAt(0).toUpperCase()+K.focus.slice(1)," Focus"]}),r.jsx("span",{className:"wk-prog-hero-go",children:"VIEW PROGRAMME "})]})]}),ve===0&&r.jsx("div",{className:"wk-swipe-arrow",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})})]},K.id))})}):r.jsxs("button",{className:"cb-upgrade-teaser",onClick:()=>w("/upgrade"),children:[r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),r.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}),r.jsx("span",{children:"Upgrade to unlock programmes"})]}),r.jsxs("div",{className:"wk-section-header",children:[r.jsxs("h2",{children:["Muscle Groups ",!p&&r.jsx("span",{className:"cb-premium-badge",children:"PREMIUM"})]}),r.jsxs("span",{className:"wk-section-count",children:[Jc.length," groups"]})]}),p?r.jsx("div",{className:"wk-muscle-grid",children:Jc.map((K,ve)=>r.jsx("button",{className:`wk-muscle-hero-card${K.image?" wk-muscle-thumb":""}`,onClick:()=>{Gt(K.key),T("muscle_sessions")},style:{animationDelay:`${ve*.05}s`},children:K.image?r.jsx("img",{src:K.image,alt:K.label,className:"wk-muscle-thumb-img"}):r.jsxs(r.Fragment,{children:[r.jsx("img",{src:k2,alt:"Muscle group",className:"wk-muscle-hero-bg",loading:"lazy"}),r.jsx("div",{className:"wk-muscle-hero-overlay",style:{background:Wp[K.key]}}),r.jsxs("div",{className:"wk-muscle-hero-content",children:[r.jsx("div",{className:"wk-muscle-hero-icon",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:K.icon})})}),r.jsxs("div",{className:"wk-muscle-hero-text",children:[r.jsx("span",{className:"wk-muscle-hero-name",children:K.label}),r.jsxs("span",{className:"wk-muscle-hero-count",children:[j2[K.key]?.length||0," sessions"]})]})]})]})},K.key))}):r.jsxs("button",{className:"cb-upgrade-teaser",onClick:()=>w("/upgrade"),children:[r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),r.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}),r.jsx("span",{children:"Upgrade to unlock muscle group workouts"})]})]}),r.jsx(aa,{active:"workouts"}),Cs]})});if(j==="setup"){const K=Kp.find(te=>te.key===F)?.label||F,ve=Dl.find(te=>te.key===ne)?.label||ne;return r.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>T("menu"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),r.jsxs("main",{className:"wk-main wk-setup-main",children:[r.jsx("div",{className:"wk-stats-row",children:[{label:"Total",value:`${Ls}`,pct:Ls>0?Math.min(Math.round(Ls/100*100),100):0,color:"#14b8a6",size:"normal"},{label:"This Week",value:`${lt}/${$p}`,pct:Math.round(Math.min(lt,$p)/$p*100),color:"var(--color-primary)",size:"large"},{label:"Wk Streak",value:`${Os}`,pct:Os>0?Math.min(Math.round(Os/12*100),100):0,color:"#38B6FF",size:"normal"}].map(te=>{const Ge=2*Math.PI*38,ut=Ge-te.pct/100*Ge;return r.jsxs("div",{className:`wk-stat-item${te.size==="large"?" wk-stat-large":""}`,children:[r.jsxs("div",{className:"wk-stat-ring",children:[r.jsxs("svg",{viewBox:"0 0 100 100",children:[r.jsx("circle",{className:"wk-stat-track",cx:"50",cy:"50",r:38}),r.jsx("circle",{className:"wk-stat-fill",cx:"50",cy:"50",r:38,style:{stroke:te.color},strokeDasharray:Ge,strokeDashoffset:ut})]}),r.jsx("span",{className:"wk-stat-value",style:{color:te.color},children:te.value})]}),r.jsx("span",{className:"wk-stat-label",children:te.label})]},te.label)})}),r.jsxs("div",{className:"wk-setup-flow",children:[r.jsxs("div",{className:"wk-setup-section",children:[r.jsx("h2",{children:"Focus Area"}),r.jsx("div",{className:"wk-focus-grid",children:Kp.map(te=>r.jsxs("button",{className:`wk-equip-btn${F===te.key?" active":""}${te.key==="mix"?" wk-mix-btn":""}`,onClick:()=>U(te.key),children:[r.jsx("svg",{className:"wk-equip-icon",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:te.icon})}),r.jsx("span",{children:te.label})]},te.key))})]}),r.jsxs("div",{className:"wk-setup-section",children:[r.jsx("h2",{children:"Level"}),r.jsx("div",{className:"wk-level-cards",children:Dl.map(te=>r.jsxs("button",{className:`wk-level-card wk-level-${te.key}${ne===te.key?" active":""}`,onClick:()=>Y(te.key),children:[r.jsx("span",{className:"wk-level-name",children:te.label}),r.jsx("span",{className:"wk-level-desc",children:te.desc})]},te.key))})]}),r.jsxs("div",{className:"wk-setup-section",children:[r.jsx("h2",{children:"Time"}),r.jsx("div",{className:"wk-time-options",children:Yp.map(te=>{const qe=!Te.includes(te);return r.jsxs("button",{className:`wk-time-btn${oe===te?" active":""}${qe?" locked":""}`,onClick:()=>!qe&&be(te),disabled:qe,children:[r.jsx("span",{className:"wk-time-num",children:te}),r.jsx("span",{className:"wk-time-unit",children:qe?r.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),r.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}):"min"})]},te)})})]}),r.jsxs("div",{className:"wk-setup-section",children:[r.jsx("h2",{children:"Equipment"}),r.jsx("div",{className:"wk-equip-options",children:T2.map(te=>{const qe=V.includes(te.key);return r.jsxs("button",{className:`wk-equip-btn${qe?" active":""}`,onClick:()=>{W(Ge=>qe&&Ge.length===1?Ge:qe?Ge.filter(ut=>ut!==te.key):[...Ge,te.key])},children:[r.jsx("svg",{className:"wk-equip-icon",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:te.icon})}),r.jsx("span",{children:te.label})]},te.key)})})]}),r.jsx("div",{className:"wk-setup-summary",children:r.jsxs("span",{children:[K,"  ",ve,"  ",oe," min"]})})]})]}),r.jsxs("div",{className:"wk-go-sticky",children:[_e&&r.jsx("p",{className:"wk-free-limit-msg",children:"You've used your free workout this week. Upgrade for unlimited access."}),r.jsx("button",{className:"wk-randomise-btn",onClick:_n,disabled:R||_e,children:R?"Loading exercises...":_e?"Limit Reached":"Randomise Workout"})]}),Cs]})}if(j==="spinning")return r.jsxs("div",{className:"wk-page wk-page-center","data-theme":l?"dark":"light","data-accent":d,children:[r.jsxs("div",{className:"wk-spin-container",children:[r.jsxs("div",{className:"wk-spin-ring",children:[r.jsx("svg",{className:"wk-spin-svg",viewBox:"0 0 200 200",children:hu.map((K,ve)=>r.jsx("line",{x1:K.x1,y1:K.y1,x2:K.x2,y2:K.y2,className:"wk-spin-tick",strokeWidth:K.thick?"3.5":"2",style:{animationDelay:`${ve*.03}s`}},ve))}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"wk-spin-logo",width:"50",height:"50"})]}),r.jsx("p",{className:"wk-spin-text",children:"Generating workout..."})]}),Cs]});if(j==="preview"){const K=rt?.interval?{work:rt.work,rest:rt.rest}:Dl.find(te=>te.key===ne),ve=D.length*M*(K.work+K.rest);return r.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>T(rt?.interval?"muscle_sessions":"setup"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),r.jsxs("main",{className:"wk-main",children:[rt?.interval&&r.jsx("h2",{className:"mg-preview-title",children:rt.name}),r.jsxs("div",{className:"wk-preview-stats",children:[r.jsxs("div",{className:"wk-stat",children:[r.jsx("span",{className:"wk-stat-val",children:D.length}),r.jsx("span",{className:"wk-stat-label",children:"Exercises"})]}),r.jsxs("div",{className:"wk-stat",children:[r.jsx("span",{className:"wk-stat-val",children:M}),r.jsx("span",{className:"wk-stat-label",children:"Rounds"})]}),r.jsxs("div",{className:"wk-stat",children:[r.jsx("span",{className:"wk-stat-val",children:Math.ceil(ve/60)}),r.jsx("span",{className:"wk-stat-label",children:"Minutes"})]}),r.jsxs("div",{className:"wk-stat",children:[r.jsxs("span",{className:"wk-stat-val",children:[K.work,"/",K.rest]}),r.jsx("span",{className:"wk-stat-label",children:"Work/Rest"})]})]}),r.jsx("div",{className:"wk-preview-list",children:D.map((te,qe)=>r.jsxs("div",{className:"wk-preview-item",style:{animationDelay:`${qe*.06}s`},onClick:()=>Wt(te),children:[r.jsx("span",{className:"wk-preview-num",children:qe+1}),r.jsx("div",{className:"wk-preview-thumb",children:te.isGif?r.jsx("img",{src:te.videoUrl,alt:te.name,loading:"lazy"}):r.jsx("video",{src:`${te.videoUrl}#t=0.1`,muted:!0,playsInline:!0,preload:"auto"})}),r.jsx("span",{className:"wk-preview-name",children:te.name}),r.jsx("svg",{className:"wk-preview-play",width:"22",height:"22",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})})]},qe))}),nt&&r.jsx("div",{className:"wk-preview-modal-backdrop",onClick:()=>Wt(null),children:r.jsxs("div",{className:"wk-preview-modal",onClick:te=>te.stopPropagation(),children:[r.jsx("button",{className:"wk-preview-modal-close",onClick:()=>Wt(null),"aria-label":"Close preview",children:r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})}),r.jsx("div",{className:"wk-preview-modal-video",children:nt.isGif?r.jsx("img",{src:nt.videoUrl,alt:nt.name}):r.jsx("video",{src:nt.videoUrl,autoPlay:!0,loop:!0,muted:!0,playsInline:!0})}),r.jsx("h3",{className:"wk-preview-modal-title",children:nt.name})]})}),r.jsxs("div",{className:"wk-preview-actions",children:[!rt?.interval&&r.jsxs("button",{className:"wk-btn-secondary",onClick:()=>_n(),children:[r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("polyline",{points:"1 4 1 10 7 10"}),r.jsx("path",{d:"M3.51 15a9 9 0 1 0 2.13-9.36L1 10"})]}),"Reshuffle"]}),r.jsx("button",{className:"wk-btn-primary",onClick:kn,children:"Start Workout"})]})]})]})}if(j==="countdown")return r.jsx("div",{className:"wk-page wk-page-center wk-page-dark","data-theme":l?"dark":"light","data-accent":d,children:r.jsxs("div",{className:"wk-countdown-big",children:[r.jsx("span",{className:"wk-countdown-num",children:bt}),r.jsx("span",{className:"wk-countdown-label",children:"GET READY"})]})});if(j==="workout"){const K=D[Ke],ve=L==="work"?gt.work:gt.rest,te=L==="rest"?Ke+1<D.length?D[Ke+1]:me<M?D[0]:null:null;return r.jsxs("div",{className:"wk-page wk-page-workout","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("div",{className:"wk-video-container",children:L==="work"?K.isGif?r.jsx("img",{ref:ts,className:"wk-video",src:K.videoUrl,alt:K.name},K.videoUrl):r.jsx("video",{className:"wk-video",src:K.videoUrl,autoPlay:!0,loop:!0,muted:!0,playsInline:!0},K.videoUrl):r.jsxs("div",{className:"wk-rest-screen",children:[r.jsx("span",{className:"wk-rest-label",children:"REST"}),te&&r.jsxs("span",{className:"wk-next-label",children:["Next: ",te.name]})]})}),r.jsx("div",{className:"wk-back-row",children:r.jsxs("button",{className:"wk-back-btn",onClick:()=>{confirm("Leave workout?")&&T("menu")},children:[r.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})}),"Back"]})}),r.jsx("div",{className:"wk-spotify",children:r.jsx("iframe",{src:"https://open.spotify.com/embed/playlist/37i9dQZF1DZ06evO3FJyYF?utm_source=generator&theme=0",width:"100%",height:"80",frameBorder:"0",allow:"autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture",loading:"lazy",title:"Spotify Playlist"})}),r.jsxs("div",{className:"wk-exercise-info",children:[r.jsxs("span",{className:"wk-exercise-counter",children:[Ke+1," / ",D.length]}),r.jsx("h2",{className:"wk-exercise-name",children:K.name}),r.jsxs("span",{className:"wk-round-label",children:["Round ",me," of ",M]})]}),r.jsx("div",{className:"wk-timer-section",children:r.jsxs("div",{className:"wk-timer-ring-wrap",children:[ls(Me,ve,L==="work"?"wk-tick-work":"wk-tick-rest"),r.jsxs("div",{className:"wk-timer-center",children:[r.jsx("span",{className:"wk-timer-time",children:Me}),r.jsx("span",{className:`wk-timer-phase ${L}`,children:L==="work"?"WORK":"REST"})]})]})}),r.jsxs("div",{className:"wk-controls",children:[r.jsx("button",{className:"wk-ctrl-btn wk-ctrl-stop",onClick:()=>{confirm("End workout early?")&&T("menu")},children:r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("rect",{x:"4",y:"4",width:"16",height:"16",rx:"2"})})}),r.jsx("button",{className:"wk-ctrl-btn wk-ctrl-pause",onClick:()=>Fe(!Je),children:Je?r.jsx("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})}):r.jsxs("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"currentColor",children:[r.jsx("rect",{x:"6",y:"4",width:"4",height:"16"}),r.jsx("rect",{x:"14",y:"4",width:"4",height:"16"})]})}),r.jsx("button",{className:"wk-ctrl-btn wk-ctrl-skip",onClick:()=>{De(0)},children:r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:[r.jsx("polygon",{points:"5 4 15 12 5 20 5 4"}),r.jsx("rect",{x:"15",y:"4",width:"4",height:"16"})]})})]}),r.jsx("div",{className:"wk-progress-bar",children:r.jsx("div",{className:"wk-progress-fill",style:{width:`${cs()*100}%`}})})]})}if(j==="complete"){const K=Dl.find(te=>te.key===ne),ve=D.length*M*(K.work+K.rest);return r.jsx("div",{className:"wk-page wk-page-center","data-theme":l?"dark":"light","data-accent":d,children:r.jsxs("div",{className:"wk-complete",children:[r.jsxs("div",{className:"wk-complete-ring",children:[r.jsx("svg",{className:"wk-complete-svg",viewBox:"0 0 200 200",children:hu.map((te,qe)=>r.jsx("line",{x1:te.x1,y1:te.y1,x2:te.x2,y2:te.y2,className:"wk-tick-complete",strokeWidth:te.thick?"3.5":"2",style:{animationDelay:`${qe*.02}s`}},qe))}),r.jsx("div",{className:"wk-complete-center",children:r.jsx("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"#4caf50",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M20 6L9 17l-5-5"})})})]}),r.jsx("h2",{className:"wk-complete-title",children:"Workout Complete!"}),r.jsxs("div",{className:"wk-complete-stats",children:[r.jsxs("div",{className:"wk-stat",children:[r.jsx("span",{className:"wk-stat-val",children:Math.ceil(ve/60)}),r.jsx("span",{className:"wk-stat-label",children:"Minutes"})]}),r.jsxs("div",{className:"wk-stat",children:[r.jsx("span",{className:"wk-stat-val",children:D.length*M}),r.jsx("span",{className:"wk-stat-label",children:"Intervals"})]}),r.jsxs("div",{className:"wk-stat",children:[r.jsx("span",{className:"wk-stat-val",children:M}),r.jsx("span",{className:"wk-stat-label",children:"Rounds"})]})]}),r.jsx("div",{className:"wk-complete-actions",children:r.jsx("button",{className:"wk-btn-primary",onClick:()=>{pt(null),Gt(null),T("menu")},children:"Done"})})]})})}if(j==="muscle_sessions"){const K=Jc.find(te=>te.key===Xt),ve=j2[Xt]||[];return r.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>T("menu"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),r.jsxs("main",{className:"wk-main",children:[r.jsxs("div",{className:"mg-sessions-header",children:[r.jsx("div",{className:"mg-sessions-icon",style:{background:Wp[Xt]},children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:K?.icon})})}),r.jsxs("h2",{children:[K?.label," Workouts"]}),r.jsxs("p",{children:[ve.length," sessions available"]})]}),r.jsx("div",{className:"mg-sessions-list",children:ve.map((te,qe)=>r.jsxs("button",{className:"mg-session-card",onClick:()=>{pt(te),T("muscle_overview")},style:{animationDelay:`${qe*.08}s`},children:[r.jsxs("div",{className:"mg-session-info",children:[r.jsx("h3",{children:te.name}),r.jsx("p",{children:te.desc}),r.jsx("div",{className:"mg-session-meta",children:te.interval?r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"mg-session-tag mg-tag-interval",children:"Interval"}),r.jsxs("span",{className:"mg-session-tag",children:[te.exercises.length," exercises"]}),r.jsxs("span",{className:"mg-session-tag",children:[te.rounds," rounds"]})]}):r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"mg-session-tag mg-tag-strength",children:"Strength"}),r.jsxs("span",{className:"mg-session-tag",children:[te.exercises.length," exercises"]}),r.jsx("span",{className:"mg-session-tag",children:(()=>{const Ge=te.exercises.map(Mt=>Mt.sets||0),ut=Math.min(...Ge),wt=Math.max(...Ge);return ut===wt?`${ut} sets each`:`${ut}-${wt} sets each`})()})]})})]}),r.jsx("div",{className:"mg-session-arrow",children:r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})})]},te.id))})]}),Cs]})}if(j==="muscle_overview"){const K=rt;if(!K)return null;const ve=Jc.find(te=>te.key===Xt);return r.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>T("muscle_sessions"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),r.jsxs("main",{className:"wk-main mg-overview-main",children:[r.jsx("div",{className:"mg-overview-hero",style:{background:Wp[Xt]},children:r.jsx("div",{className:"mg-overview-hero-content",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",className:"mg-overview-hero-icon",children:r.jsx("path",{d:ve?.icon})})})}),r.jsxs("div",{className:"mg-overview-header",children:[r.jsxs("div",{className:"mg-overview-title-row",children:[r.jsx("h2",{children:K.name}),K.level&&r.jsx("span",{className:"mg-overview-level",children:K.level})]}),r.jsx("p",{className:"mg-overview-desc",children:K.desc})]}),K.overview&&r.jsxs("div",{className:"mg-overview-section",children:[r.jsxs("h3",{children:[r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("path",{d:"M12 16v-4M12 8h.01"})]}),"About This Workout"]}),r.jsx("p",{children:K.overview})]}),K.tips&&K.tips.length>0&&r.jsxs("div",{className:"mg-overview-section",children:[r.jsxs("h3",{children:[r.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 1 1 7.072 0l-.548.547A3.374 3.374 0 0 0 14 18.469V19a2 2 0 1 1-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),"Tips & Form"]}),r.jsx("ul",{className:"mg-overview-tips",children:K.tips.map((te,qe)=>r.jsx("li",{children:te},qe))})]}),r.jsxs("div",{className:"mg-overview-section",children:[r.jsxs("h3",{children:[r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M9 5H7a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-2"}),r.jsx("rect",{x:"9",y:"3",width:"6",height:"4",rx:"1"}),r.jsx("path",{d:"M9 14l2 2 4-4"})]}),"Exercises (",K.exercises.length,")"]}),r.jsx("div",{className:"mg-overview-exercises",children:K.exercises.map((te,qe)=>r.jsxs("div",{className:"mg-overview-exercise",children:[r.jsx("span",{className:"mg-overview-ex-num",children:qe+1}),r.jsxs("div",{className:"mg-overview-ex-info",children:[r.jsx("span",{className:"mg-overview-ex-name",children:te.name}),K.interval?r.jsxs("span",{className:"mg-overview-ex-detail",children:[K.work,"s work / ",K.rest,"s rest"]}):r.jsxs("span",{className:"mg-overview-ex-detail",children:[te.sets," sets  ",te.reps?`${te.reps} reps`:`${te.time}s`,te.type==="weighted"&&"  weighted"]})]})]},qe))})]}),r.jsxs("button",{className:"mg-overview-start-btn",onClick:()=>B(K),children:[r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M8 5v14l11-7z"})}),"Start Workout"]})]}),Cs]})}if(j==="muscle_workout"){const K=rt;if(!K)return null;const ve=K.exercises[it],te=Ps[it];if(!ve||!te)return null;const qe=te.sets.length,Ge=K.exercises.length,ut=K.exercises.reduce((ms,Wn)=>ms+(Wn.sets||0),0),Mt=Ps.reduce((ms,Wn)=>ms+Wn.sets.length,0)/ut*100,ws=we[ve.name];ve.type==="timed"&&Ee===0&&!As&&qe===Kt&&setTimeout(()=>Ae(ve.time),0);const cn=qe+1<ve.sets?"Log Set":it+1<Ge?"Log Set  Next Exercise":"Log Set  Complete";return r.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("div",{className:"mg-session-progress",children:r.jsx("div",{className:"mg-session-progress-fill",style:{width:`${Mt}%`}})}),r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>{confirm("End workout early?")&&T("muscle_overview")},"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsxs("span",{className:"mg-header-info",children:["Exercise ",it+1,"/",Ge]}),r.jsx("div",{style:{width:22}})]})}),r.jsxs("main",{className:"wk-main",children:[ws?r.jsxs("div",{className:"mg-video-container",onClick:de,children:[ws.isGif?r.jsx("img",{className:"mg-video",src:ws.url,alt:ve.name}):r.jsx("video",{ref:Ue,className:"mg-video",src:ws.url,loop:!0,muted:!0,playsInline:!0},ve.name),!ee&&!ws.isGif&&r.jsxs("div",{className:"mg-video-overlay",children:[r.jsx("svg",{className:"mg-play-icon",width:"48",height:"48",viewBox:"0 0 24 24",fill:"rgba(255,255,255,0.9)",children:r.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})}),r.jsx("span",{className:"mg-video-hint",children:"Tap for demo"})]})]}):r.jsxs("div",{className:"mg-video-placeholder",children:[r.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",opacity:"0.4",children:[r.jsx("rect",{x:"2",y:"2",width:"20",height:"20",rx:"2.18",ry:"2.18"}),r.jsx("line",{x1:"7",y1:"2",x2:"7",y2:"22"}),r.jsx("line",{x1:"17",y1:"2",x2:"17",y2:"22"}),r.jsx("line",{x1:"2",y1:"12",x2:"22",y2:"12"}),r.jsx("line",{x1:"2",y1:"7",x2:"7",y2:"7"}),r.jsx("line",{x1:"2",y1:"17",x2:"7",y2:"17"}),r.jsx("line",{x1:"17",y1:"7",x2:"22",y2:"7"}),r.jsx("line",{x1:"17",y1:"17",x2:"22",y2:"17"})]}),r.jsx("span",{children:"Video coming soon"})]}),r.jsx("div",{className:"wk-spotify",children:r.jsx("iframe",{src:"https://open.spotify.com/embed/playlist/37i9dQZF1DZ06evO3FJyYF?utm_source=generator&theme=0",width:"100%",height:"80",frameBorder:"0",allow:"autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture",loading:"lazy",title:"Spotify Playlist"})}),r.jsxs("div",{className:"mg-exercise-card",children:[r.jsx("h2",{className:"mg-ex-name",children:ve.name}),r.jsx("span",{className:`mg-ex-type-badge ${ve.type}`,children:ve.type==="weighted"?"Weight + Reps":ve.type==="reps"?"Reps Only":"Timed"}),r.jsxs("div",{className:"mg-ex-set-info",children:[r.jsxs("span",{className:"mg-ex-set-num",children:["Set ",qe+1," of ",ve.sets]}),ve.type!=="timed"&&r.jsxs("span",{className:"mg-ex-target",children:["Target: ",ve.reps," reps"]}),ve.type==="timed"&&r.jsxs("span",{className:"mg-ex-target",children:["Target: ",ve.time,"s"]})]}),ve.type==="weighted"&&r.jsxs("div",{className:"mg-input-area",children:[r.jsxs("div",{className:"mg-input-group",children:[r.jsx("label",{children:"Weight (kg)"}),r.jsx("input",{type:"number",inputMode:"decimal",className:"mg-input",value:Ct,onChange:ms=>Jt(ms.target.value),placeholder:"0"})]}),r.jsxs("div",{className:"mg-input-group",children:[r.jsx("label",{children:"Reps"}),r.jsx("input",{type:"number",inputMode:"numeric",className:"mg-input",value:vs,onChange:ms=>Bt(ms.target.value),placeholder:"0"})]})]}),ve.type==="reps"&&r.jsx("div",{className:"mg-input-area",children:r.jsxs("div",{className:"mg-input-group mg-input-single",children:[r.jsx("label",{children:"Reps"}),r.jsx("input",{type:"number",inputMode:"numeric",className:"mg-input",value:vs,onChange:ms=>Bt(ms.target.value),placeholder:"0"})]})}),ve.type==="timed"&&r.jsxs("div",{className:"mg-timer-area",children:[r.jsx("div",{className:"mg-timer-display",children:r.jsxs("span",{className:"mg-timer-value",children:[Ee,"s"]})}),As?r.jsx("button",{className:"mg-timer-btn mg-timer-stop",onClick:()=>ue(!1),children:"Stop"}):r.jsx("button",{className:"mg-timer-btn",onClick:()=>{Ee===0&&Ae(ve.time),ue(!0)},children:Ee<ve.time&&Ee>0?"Resume":"Start Timer"})]}),r.jsx("button",{className:"mg-log-set-btn",onClick:Be,children:cn}),te.sets.length>0&&r.jsx("div",{className:"mg-completed-sets",children:te.sets.map((ms,Wn)=>r.jsxs("div",{className:"mg-completed-set",children:[r.jsx("span",{className:"mg-completed-set-check",children:""}),r.jsxs("span",{children:["Set ",Wn+1,": ",ms.weight!=null?`${ms.weight}kg  ${ms.reps}`:ms.reps!=null?`${ms.reps} reps`:`${ms.time}s`]})]},Wn))})]})]}),Cs]})}if(j==="muscle_complete"){const K=Ps.reduce((qe,Ge)=>qe+Ge.sets.length,0),ve=Ps.reduce((qe,Ge)=>qe+Ge.sets.reduce((ut,wt)=>ut+(wt.weight||0)*(wt.reps||0),0),0),te=Jc.find(qe=>qe.key===Xt)?.label||"";return r.jsxs("div",{className:"wk-page wk-page-center","data-theme":l?"dark":"light","data-accent":d,children:[r.jsxs("div",{className:"wk-complete",children:[r.jsxs("div",{className:"wk-complete-ring",children:[r.jsx("svg",{className:"wk-complete-svg",viewBox:"0 0 200 200",children:hu.map((qe,Ge)=>r.jsx("line",{x1:qe.x1,y1:qe.y1,x2:qe.x2,y2:qe.y2,className:"wk-tick-complete",strokeWidth:qe.thick?"3.5":"2",style:{animationDelay:`${Ge*.02}s`}},Ge))}),r.jsx("div",{className:"wk-complete-center",children:r.jsx("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"#4caf50",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M20 6L9 17l-5-5"})})})]}),r.jsxs("h2",{className:"wk-complete-title",children:[te," Complete!"]}),r.jsx("p",{className:"mg-complete-session-name",children:rt?.name}),r.jsxs("div",{className:"wk-complete-stats",children:[r.jsxs("div",{className:"wk-stat",children:[r.jsx("span",{className:"wk-stat-val",children:Ps.length}),r.jsx("span",{className:"wk-stat-label",children:"Exercises"})]}),r.jsxs("div",{className:"wk-stat",children:[r.jsx("span",{className:"wk-stat-val",children:K}),r.jsx("span",{className:"wk-stat-label",children:"Sets"})]}),ve>0&&r.jsxs("div",{className:"wk-stat",children:[r.jsx("span",{className:"wk-stat-val",children:Math.round(ve).toLocaleString()}),r.jsx("span",{className:"wk-stat-label",children:"Volume (kg)"})]})]}),r.jsx("div",{className:"wk-complete-actions",children:r.jsx("button",{className:"wk-btn-primary",onClick:()=>{pt(null),Gt(null),fe(null),T("menu")},children:"Done"})})]}),Q&&r.jsx("div",{className:"mg-badge-celebration",onClick:()=>fe(null),children:r.jsxs("div",{className:"mg-badge-celebration-card",children:[r.jsx("div",{className:"mg-badge-celebration-icon",children:r.jsx("svg",{viewBox:"0 0 24 24",width:"48",height:"48",fill:"#ffc107",children:r.jsx("polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"})})}),r.jsx("h3",{className:"mg-badge-celebration-title",children:Q.badges.length===1?"Badge Earned!":`${Q.badges.length} Badges Earned!`}),r.jsx("div",{className:"mg-badge-celebration-list",children:Q.badges.map((qe,Ge)=>r.jsx("div",{className:"mg-badge-celebration-item",children:qe.type==="pb_target"?`${qe.exercise}  ${qe.targetWeight}kg`:qe.label},Ge))}),r.jsx("button",{className:"mg-badge-celebration-dismiss",children:"Tap to dismiss"})]})})]})}return null}const MD=60,DD={"Dumbbell Floor Press":"push","Seated Dumbbell Shoulder Press":"push","Seated Dumbbell Arnold Press":"push","Dumbbell Overhead Tricep Extension":"push",Skullcrushers:"push","Dumbbell Lateral Raise":"push","Dumbbell Front Raise":"push","Dumbbell Bent Over Row":"pull","Single Arm Bent Over Row":"pull","Bicep Curl":"pull","Hammer Curl":"pull","Dumbbell Bent Over Rear Delt Fly":"pull","Renegade Row":"pull","Dumbbell Goblet Squats":"lower","Romanian Deadlifts":"lower","Forward Dumbbell Lunges":"lower","Dumbbell Sumo Squats":"lower","Weighted Calf Raises":"lower","1 Legged RDL":"lower","Dumbbell Box Step Ups":"lower","Dumbbell Squat Pulses":"lower","Dumbbell Reverse Lunges":"lower","Kettlebell Romanian Deadlift":"lower","Russian Twists Dumbbell":"core","Kettlebell Russian Twist":"core","Kettlebell Side Bends":"core","Kneeling Kettlebell Halo":"core"},PD=[{threshold:1e3,label:"1 Tonne"},{threshold:5e3,label:"5 Tonne"},{threshold:1e4,label:"10 Tonne"},{threshold:25e3,label:"25 Tonne"},{threshold:5e4,label:"50 Tonne"},{threshold:1e5,label:"100 Tonne"},{threshold:25e4,label:"250 Tonne"},{threshold:5e5,label:"500 Tonne"},{threshold:1e6,label:"1 Million kg"}],E2=[{id:"fullbody_4wk",name:"4-Week Full Body",focus:"fullbody",duration:4,daysPerWeek:3,level:"All Levels",description:"Build total body strength with compound dumbbell movements and bodyweight finishers",repProg:2,timeProg:5,days:[{name:"Day 1",label:"Push Focus",exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:3,baseReps:10,pbKey:"chestPress",storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Seated Dumbbell Shoulder Press",type:"weighted",sets:3,baseReps:10,pbKey:"shoulderPress",storagePath:"exercises/dumbbells/upper/seated dumbbell shoulder press.mp4"},{name:"Dumbbell Goblet Squats",type:"weighted",sets:3,baseReps:10,pbKey:"squat",storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Press Up",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Mountain Climbers",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Mountain Climbers.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]},{name:"Day 2",label:"Pull Focus",exercises:[{name:"Dumbbell Bent Over Row",type:"weighted",sets:3,baseReps:10,pbKey:"seatedRow",storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Bicep Curl",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Romanian Deadlifts",type:"weighted",sets:3,baseReps:10,pbKey:"deadlift",storagePath:"exercises/dumbbells/lower/romanian deadlifts.GIF"},{name:"Reverse Lunge",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/lower/reverse lunge.GIF"},{name:"Russian Twist",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Russian Twist.mp4"},{name:"Side Plank",type:"timed",sets:2,baseTime:25,storagePath:"exercises/bodyweight/core/Side Plank.mp4"}]},{name:"Day 3",label:"Legs & Core",exercises:[{name:"Forward Dumbbell Lunges",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.GIF"},{name:"Dumbbell Sumo Squats",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/lower/dumbbell sumo squats.GIF"},{name:"Weighted Calf Raises",type:"weighted",sets:3,baseReps:15,storagePath:"exercises/dumbbells/lower/weighted calf raises.GIF"},{name:"Box Step Ups",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/lower/box step ups.GIF"},{name:"Burpee",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]}]},{id:"fullbody_8wk",name:"8-Week Full Body",focus:"fullbody",duration:8,daysPerWeek:3,level:"Intermediate",description:"Two-phase programme building strength and endurance across your full body",repProg:1,timeProg:3,days:[{name:"Day 1",label:"Strength",exercises:[{name:"Dumbbell Goblet Squats",type:"weighted",sets:4,baseReps:8,pbKey:"squat",storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Dumbbell Floor Press",type:"weighted",sets:4,baseReps:8,pbKey:"chestPress",storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Dumbbell Bent Over Row",type:"weighted",sets:4,baseReps:8,pbKey:"seatedRow",storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Seated Dumbbell Shoulder Press",type:"weighted",sets:3,baseReps:10,pbKey:"shoulderPress",storagePath:"exercises/dumbbells/upper/seated dumbbell shoulder press.mp4"},{name:"Mountain Climbers",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Mountain Climbers.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:35,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]},{name:"Day 2",label:"Power",exercises:[{name:"Romanian Deadlifts",type:"weighted",sets:4,baseReps:8,pbKey:"deadlift",storagePath:"exercises/dumbbells/lower/romanian deadlifts.GIF"},{name:"Forward Dumbbell Lunges",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.GIF"},{name:"Single Arm Bent Over Row",type:"weighted",sets:4,baseReps:8,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Hammer Curl",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/hammer curl.mp4"},{name:"Bulgarian Split Squats",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/lower/bulgarian split squats.GIF"},{name:"Russian Twist",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Russian Twist.mp4"}]},{name:"Day 3",label:"Endurance",exercises:[{name:"Dumbbell Sumo Squats",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/lower/dumbbell sumo squats.GIF"},{name:"Weighted Calf Raises",type:"weighted",sets:3,baseReps:15,storagePath:"exercises/dumbbells/lower/weighted calf raises.GIF"},{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Press Up",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Burpee",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:40,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]}]},{id:"fullbody_12wk",name:"12-Week Full Body",focus:"fullbody",duration:12,daysPerWeek:3,level:"Advanced",description:"Complete transformation programme: push, pull, and legs over three phases",repProg:1,timeProg:2,days:[{name:"Day 1",label:"Upper Push",exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:4,baseReps:8,pbKey:"chestPress",storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Seated Dumbbell Arnold Press",type:"weighted",sets:4,baseReps:8,storagePath:"exercises/dumbbells/upper/seated dumbbell arnold press.mp4"},{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Skullcrushers",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/skullcrushers.mp4"},{name:"Press Up",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]},{name:"Day 2",label:"Lower Body",exercises:[{name:"Dumbbell Goblet Squats",type:"weighted",sets:4,baseReps:8,pbKey:"squat",storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Romanian Deadlifts",type:"weighted",sets:4,baseReps:8,pbKey:"deadlift",storagePath:"exercises/dumbbells/lower/romanian deadlifts.GIF"},{name:"Forward Dumbbell Lunges",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.GIF"},{name:"Weighted Calf Raises",type:"weighted",sets:3,baseReps:15,storagePath:"exercises/dumbbells/lower/weighted calf raises.GIF"},{name:"Jump Squats",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/lower/jump squats.GIF"},{name:"Hollow Body Hold",type:"timed",sets:3,baseTime:30,storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"}]},{name:"Day 3",label:"Upper Pull",exercises:[{name:"Dumbbell Bent Over Row",type:"weighted",sets:4,baseReps:8,pbKey:"seatedRow",storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Single Arm Bent Over Row",type:"weighted",sets:4,baseReps:8,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Bicep Curl",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Burpee",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Side Plank",type:"timed",sets:2,baseTime:25,storagePath:"exercises/bodyweight/core/Side Plank.mp4"}]}]},{id:"core_4wk",name:"4-Week Core",focus:"core",duration:4,daysPerWeek:3,level:"Beginner",description:"Build a solid core foundation with targeted ab and stability work",repProg:2,timeProg:5,days:[{name:"Day 1",label:"Abs",exercises:[{name:"Crunch",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/core/Crunch.mp4"},{name:"Leg Raises",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Leg Raises.mp4"},{name:"Russian Twist",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Russian Twist.mp4"},{name:"Bicycle Crunch",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Bicycle Crunch.mp4"},{name:"Mountain Climbers",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Mountain Climbers.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]},{name:"Day 2",label:"Stability",exercises:[{name:"Dead Bug",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Dead Bug.mp4"},{name:"Bird Dog",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Bird Dog.mp4"},{name:"Side Plank",type:"timed",sets:2,baseTime:20,storagePath:"exercises/bodyweight/core/Side Plank.mp4"},{name:"Flutter Kicks",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Flutter Kicks.mp4"},{name:"Hollow Body Hold",type:"timed",sets:3,baseTime:20,storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"},{name:"High Plank Shoulder Taps",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/High Plank Shoulder Taps.mp4"}]},{name:"Day 3",label:"Power Core",exercises:[{name:"Single Leg V-Up",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Single Leg V-Up.mp4"},{name:"Toe Reaches",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/core/toe reaches.GIF"},{name:"Russian Twists Dumbbell",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/core/russian twists dumbbell.GIF"},{name:"Burpee",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Fast Mountain Climbers",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Fast Mountain Climbers.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]}]},{id:"core_8wk",name:"8-Week Core",focus:"core",duration:8,daysPerWeek:3,level:"Intermediate",description:"Develop deep core strength and rotational power over two phases",repProg:1,timeProg:3,days:[{name:"Day 1",label:"Anti-Extension",exercises:[{name:"Forearm Plank",type:"timed",sets:3,baseTime:35,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"},{name:"Dead Bug",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Dead Bug.mp4"},{name:"Plank Walkout",type:"reps",sets:3,baseReps:8,storagePath:"exercises/bodyweight/core/Plank Walkout.mp4"},{name:"Hollow Body Hold",type:"timed",sets:3,baseTime:25,storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"},{name:"Leg Raises",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Leg Raises.mp4"},{name:"Mountain Climbers",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Mountain Climbers.mp4"}]},{name:"Day 2",label:"Rotation",exercises:[{name:"Russian Twist",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Russian Twist.mp4"},{name:"Kettlebell Russian Twist",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/kettlebells/core/kettlebell russian twist.mp4"},{name:"Bicycle Crunch",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Bicycle Crunch.mp4"},{name:"Side Plank Rotation",type:"reps",sets:2,baseReps:10,storagePath:"exercises/bodyweight/core/Side Plank Rotation.mp4"},{name:"High Plank Shoulder Taps",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/core/High Plank Shoulder Taps.mp4"},{name:"Hollow Hold To V-Sit",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Hollow Hold To V-sit.mp4"}]},{name:"Day 3",label:"Power",exercises:[{name:"Crunch",type:"reps",sets:4,baseReps:15,storagePath:"exercises/bodyweight/core/Crunch.mp4"},{name:"Flutter Kicks",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Flutter Kicks.mp4"},{name:"Reverse Crunch To Leg Raise",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Reverse Crunch To Leg Raise.mp4"},{name:"Burpee",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Kettlebell Bird Dog Drag",type:"reps",sets:3,baseReps:10,storagePath:"exercises/kettlebells/core/kettlebell bird dog drag.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:40,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]}]},{id:"core_12wk",name:"12-Week Core",focus:"core",duration:12,daysPerWeek:3,level:"Advanced",description:"Ultimate core transformation: stability, strength, and power across three phases",repProg:1,timeProg:2,days:[{name:"Day 1",label:"Strength",exercises:[{name:"Forearm Plank",type:"timed",sets:4,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"},{name:"Plank Walkout",type:"reps",sets:4,baseReps:8,storagePath:"exercises/bodyweight/core/Plank Walkout.mp4"},{name:"Leg Raises",type:"reps",sets:4,baseReps:12,storagePath:"exercises/bodyweight/core/Leg Raises.mp4"},{name:"Kettlebell Side Bends",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/kettlebells/core/kettlebell side bends.mp4"},{name:"Dead Bug Single Leg Drop",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Dead Bug Single Leg Drop.mp4"},{name:"Hollow Body Hold",type:"timed",sets:3,baseTime:25,storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"}]},{name:"Day 2",label:"Endurance",exercises:[{name:"Crunch",type:"reps",sets:4,baseReps:15,storagePath:"exercises/bodyweight/core/Crunch.mp4"},{name:"Kettlebell Russian Twist",type:"weighted",sets:4,baseReps:15,storagePath:"exercises/kettlebells/core/kettlebell russian twist.mp4"},{name:"Bicycle Crunch",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Bicycle Crunch.mp4"},{name:"Hollow Hold Flutter Kicks",type:"reps",sets:3,baseReps:25,storagePath:"exercises/bodyweight/core/Hollow Hold Flutter Kicks.mp4"},{name:"Cross Body Mountain Climbers",type:"reps",sets:3,baseReps:25,storagePath:"exercises/bodyweight/core/Cross Body Mountain Climbers.mp4"},{name:"Side Plank",type:"timed",sets:2,baseTime:25,storagePath:"exercises/bodyweight/core/Side Plank.mp4"}]},{name:"Day 3",label:"Power",exercises:[{name:"Hollow Hold To V-Sit",type:"reps",sets:4,baseReps:10,storagePath:"exercises/bodyweight/core/Hollow Hold To V-sit.mp4"},{name:"Reverse Crunch To Leg Raise",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Reverse Crunch To Leg Raise.mp4"},{name:"Burpee",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Hip Dips Plank",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/core/Hip Dips Plank.mp4"},{name:"Kneeling Kettlebell Halo",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/kettlebells/core/kneeling kettlebell halo.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:35,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]}]},{id:"upper_4wk",name:"4-Week Upper Body",focus:"upper",duration:4,daysPerWeek:3,level:"Intermediate",description:"Sculpt and strengthen your chest, back, shoulders, and arms",repProg:2,timeProg:5,days:[{name:"Day 1",label:"Push",exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:4,baseReps:10,pbKey:"chestPress",storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Seated Dumbbell Shoulder Press",type:"weighted",sets:3,baseReps:10,pbKey:"shoulderPress",storagePath:"exercises/dumbbells/upper/seated dumbbell shoulder press.mp4"},{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Tricep Dips",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/upper/tricep dips.mp4"},{name:"Pike Push Ups",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/upper/pike push ups.GIF"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]},{name:"Day 2",label:"Pull",exercises:[{name:"Dumbbell Bent Over Row",type:"weighted",sets:4,baseReps:10,pbKey:"seatedRow",storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Single Arm Bent Over Row",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Bicep Curl",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Hammer Curl",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/hammer curl.mp4"},{name:"Reverse Plank",type:"timed",sets:3,baseTime:20,storagePath:"exercises/bodyweight/upper/reverse plank.GIF"}]},{name:"Day 3",label:"Mixed",exercises:[{name:"Seated Dumbbell Arnold Press",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/seated dumbbell arnold press.mp4"},{name:"Dumbbell Lateral Raise",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/dumbbell lateral raise.mp4"},{name:"Dumbbell Front Raise",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/dumbbell front raise.mp4"},{name:"Press Up",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Renegade Row",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/renegade row.mp4"},{name:"Superman Hold",type:"timed",sets:3,baseTime:30,storagePath:"exercises/bodyweight/core/Superman Hold.mp4"}]}]},{id:"lower_4wk",name:"4-Week Lower Body",focus:"lower",duration:4,daysPerWeek:3,level:"Intermediate",description:"Build powerful legs and glutes with squats, deadlifts, and plyometrics",repProg:2,timeProg:5,days:[{name:"Day 1",label:"Quad Dominant",exercises:[{name:"Dumbbell Goblet Squats",type:"weighted",sets:4,baseReps:10,pbKey:"squat",storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Forward Dumbbell Lunges",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.GIF"},{name:"Dumbbell Box Step Ups",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/lower/dumbbell box step ups.mp4"},{name:"Dumbbell Squat Pulses",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/lower/dumbbell squat pulses.GIF"},{name:"Jump Squats",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/lower/jump squats.GIF"},{name:"Squat And Hold",type:"timed",sets:3,baseTime:30,storagePath:"exercises/bodyweight/lower/squat and hold.GIF"}]},{name:"Day 2",label:"Hamstring & Glute",exercises:[{name:"Romanian Deadlifts",type:"weighted",sets:4,baseReps:8,pbKey:"deadlift",storagePath:"exercises/dumbbells/lower/romanian deadlifts.GIF"},{name:"1 Legged RDL",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/lower/1 legged rdl.GIF"},{name:"Hip Thrusts",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/lower/hip thrusts.GIF"},{name:"Dumbbell Reverse Lunges",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/lower/dumbbell reverse lunges.GIF"},{name:"Donkey Kicks",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/lower/donkey kicks.GIF"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]},{name:"Day 3",label:"Power & Stability",exercises:[{name:"Dumbbell Sumo Squats",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/lower/dumbbell sumo squats.GIF"},{name:"Kettlebell Romanian Deadlift",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/kettlebells/lower/kettlebell romanian deadlift.mp4"},{name:"Weighted Calf Raises",type:"weighted",sets:3,baseReps:15,storagePath:"exercises/dumbbells/lower/weighted calf raises.GIF"},{name:"Bulgarian Split Squats",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/lower/bulgarian split squats.GIF"},{name:"Skater Jumps",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/lower/skater jumps.GIF"},{name:"Side Plank",type:"timed",sets:2,baseTime:25,storagePath:"exercises/bodyweight/core/Side Plank.mp4"}]}]}];function lh(n,e,t){const i=n.baseReps?n.baseReps+(e-1)*(t.repProg||0):void 0,l=n.baseTime?n.baseTime+(e-1)*(t.timeProg||0):void 0;return{sets:n.sets,reps:i,time:l}}const LD={fullbody:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm-2 8h4l1 4h2l-1 4h-2l-1 4h-2l-1-4H8l-1-4h2l1-4z",core:"M12 2a4 4 0 0 1 4 4v1h-2V6a2 2 0 1 0-4 0v1H8V6a4 4 0 0 1 4-4zM8 9h8v2H8V9zm-1 4h10l-1 9H8l-1-9z",upper:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm8 10l-3-1.5c-.5-.25-1-.5-1.5-.5h-7c-.5 0-1 .25-1.5.5L4 12l-2 6h4l1.5 4h9L18 18h4l-2-6z",lower:"M16.5 3A2.5 2.5 0 0 0 14 5.5 2.5 2.5 0 0 0 16.5 8 2.5 2.5 0 0 0 19 5.5 2.5 2.5 0 0 0 16.5 3zM14 9l-3 7h2l1 6h2l1-6h2l-3-7h-2z"};function OD(){const{currentUser:n,isClient:e,clientData:t,loading:i}=Mr(),{isDark:l,toggleTheme:u,accent:d}=ka(),p=$n(),g=_a(),[y,w]=v.useState("loading"),[j,T]=v.useState(null),V=v.useRef(!1),[W,F]=v.useState(null),[U,ne]=v.useState(1),[Y,oe]=v.useState(0),[be,Le]=v.useState(0),[Ce,R]=v.useState(0),[E,A]=v.useState([]),[O,D]=v.useState(""),[H,M]=v.useState(""),[We,gt]=v.useState(!1),[$,me]=v.useState(0),Ve=v.useRef(null),[Ke,J]=v.useState({}),[L,se]=v.useState(!1),Me=v.useRef(null),[De,Je]=v.useState(null),[Fe,bt]=v.useState([]);v.useEffect(()=>{window.scrollTo(0,0)},[y]);const[kt,nt]=v.useState(null),Wt=v.useCallback((ue,Ee="info")=>{nt({message:ue,type:Ee}),setTimeout(()=>nt(null),4e3)},[]),ts=v.useRef(null),St=()=>(ts.current||(ts.current=new(window.AudioContext||window.webkitAudioContext)),ts.current),at=()=>{try{const ue=St(),Ee=ue.createOscillator(),Ae=ue.createGain();Ee.connect(Ae),Ae.connect(ue.destination),Ee.frequency.value=1200,Ae.gain.value=.4,Ee.start(ue.currentTime),Ee.stop(ue.currentTime+.3)}catch{}};v.useEffect(()=>{!i&&(!n||!e)&&p("/")},[n,e,i,p]),v.useEffect(()=>{if(!t)return;(async()=>{try{const Ee=He(pe,"clientProgrammes",t.id),Ae=await Rs(Ee);Ae.exists()&&F(Ae.data());const ee=g.state?.templateId;if(ee&&!V.current){const ge=E2.find(we=>we.id===ee);if(ge){V.current=!0,T(ge),w("overview");return}}Ae.exists()?w("dashboard"):p("/client/core-buddy/workouts",{replace:!0})}catch(Ee){console.error("Error loading programme:",Ee),p("/client/core-buddy/workouts",{replace:!0})}})()},[t]),v.useEffect(()=>{if(!We||$<=0){We&&$<=0&&(gt(!1),at());return}return Ve.current=setTimeout(()=>me(ue=>ue-1),1e3),()=>clearTimeout(Ve.current)},[We,$]);const ce=async ue=>{if(t)try{await Ns(He(pe,"clientProgrammes",t.id),ue),F(ue)}catch(Ee){console.error("Error saving programme:",Ee),Wt("Failed to save. Check Firestore rules for clientProgrammes.","error")}},Xt=async ue=>{const Ee={templateId:ue.id,startDate:xt.now(),completedSessions:{}};await ce(Ee),w("dashboard")},Gt=async()=>{if(t)try{await yr(He(pe,"clientProgrammes",t.id)),F(null),w("browse")}catch(ue){console.error("Error quitting programme:",ue)}},rt=()=>W?E2.find(ue=>ue.id===W.templateId):null,pt=()=>{if(!W?.startDate)return 1;const ue=W.startDate.toDate?W.startDate.toDate():new Date(W.startDate),Ae=new Date-ue,ee=Math.floor(Ae/(1e3*60*60*24));return Math.floor(ee/7)+1},it=()=>{if(!W)return{currentWeek:1,completedThisWeek:0,nextDay:0,totalCompleted:0};const ue=W.completedSessions||{},Ee=Object.keys(ue).length,Ae=rt();if(!Ae)return{currentWeek:1,completedThisWeek:0,nextDay:0,totalCompleted:0};const ee=Ae.duration*Ae.daysPerWeek,ge=pt(),we=Math.min(ge,Ae.duration);let Oe=0;for(let $e=0;$e<Ae.daysPerWeek;$e++)ue[`w${we}d${$e}`]&&Oe++;if(Ee>=ee)return{currentWeek:Ae.duration,completedThisWeek:Ae.daysPerWeek,nextDay:-1,totalCompleted:Ee,totalSessions:ee,complete:!0};if(ge>Ae.duration)return{currentWeek:Ae.duration,completedThisWeek:Oe,nextDay:-1,totalCompleted:Ee,totalSessions:ee,complete:!0};let Ue=-1;for(let $e=0;$e<Ae.daysPerWeek;$e++)if(!ue[`w${we}d${$e}`]){Ue=$e;break}return{currentWeek:we,completedThisWeek:Oe,nextDay:Ue,nextWeek:we,totalCompleted:Ee,totalSessions:ee}},st=ue=>{const Ee=pt();return ue<Ee},Kt=(ue,Ee,Ae)=>{if(!W||ue<=1)return null;const ee=`w${ue-1}d${Ee}`,ge=W.completedSessions?.[ee];if(!ge)return null;const we=ge.exercises?.find(Oe=>Oe.name===Ae);return we?.sets?.length?we.sets[we.sets.length-1]:null},Ks=(ue,Ee)=>{const Ae=rt();if(!Ae)return;ne(ue),oe(Ee),Le(0),R(0),A([]),M(""),gt(!1),me(0),se(!1),J({});const ee=Ae.days[Ee],ge=ee.exercises.map($e=>{const ft=lh($e,ue,Ae);return{name:$e.name,type:$e.type,pbKey:$e.pbKey,targetSets:ft.sets,targetReps:ft.reps,targetTime:ft.time,sets:[]}});A(ge);const we=ee.exercises[0],Oe=Kt(ue,Ee,we.name);Oe?.weight&&we.type==="weighted"?D(String(Oe.weight)):D(""),(async()=>{const $e={};for(const ft of ee.exercises)if(ft.storagePath)try{const jt=eo(to,ft.storagePath),Q=await qo(jt);$e[ft.name]={url:Q,isGif:/\.gif$/i.test(ft.storagePath)}}catch(jt){console.warn(`Video not found for ${ft.name}:`,jt)}J($e)})(),w("session")},Ps=async()=>{rt();const ue=E[be];if(!ue)return;let Ee={};if(ue.type==="weighted"){const ge=parseFloat(O)||0,we=parseInt(H)||0;if(we===0){Wt("Enter your reps","error");return}Ee={weight:ge,reps:we}}else if(ue.type==="reps"){const ge=parseInt(H)||0;if(ge===0){Wt("Enter your reps","error");return}Ee={reps:ge}}else if(ue.type==="timed"){const ge=ue.targetTime-$;Ee={time:Math.max(ge,1)}}const Ae=[...E];Ae[be]={...ue,sets:[...ue.sets,Ee]},A(Ae),ue.type==="weighted"&&Ee.weight>0&&await Jt(ue.name,Ee.weight,Ee.reps);const ee=ue.sets.length+1;if(ee<ue.targetSets)R(ee),D(Ee.weight?String(Ee.weight):""),M(""),gt(!1),me(0);else if(be+1<E.length){const ge=be+1;Le(ge),R(0),se(!1);const Oe=rt()?.days[Y]?.exercises[ge],Ue=Kt(U,Y,Oe?.name);Ue?.weight&&Oe?.type==="weighted"?D(String(Ue.weight)):D(""),M(""),gt(!1),me(0)}else await ss(Ae)},ss=async ue=>{if(!W||!t)return;const Ee=`w${U}d${Y}`,Ae={...W.completedSessions,[Ee]:{completedAt:new Date().toISOString(),exercises:ue.map(we=>({name:we.name,type:we.type,sets:we.sets}))}},ee={...W,completedSessions:Ae};await ce(ee);const ge=ue.reduce((we,Oe)=>we+Oe.sets.reduce((Ue,$e)=>Ue+($e.weight||0)*($e.reps||0),0),0);ge>0&&await Ct(ge);try{const we=rt();await hi(zt(pe,"workoutLogs"),{clientId:t.id,type:"programme",programmeId:we?.id,programmeName:we?.name,week:U,day:Y+1,exerciseCount:ue.length,duration:Math.round(ue.reduce((Oe,Ue)=>Oe+Ue.sets.length*1.5,0)),volume:Math.round(ge),completedAt:xt.now()})}catch(we){console.error("Error saving workout log:",we)}Fe.length>0&&(Je({badges:[...Fe]}),bt([])),w("sessionComplete")},Ct=async ue=>{if(t)try{const Ee=await Rs(He(pe,"coreBuddyAchievements",t.id)),Ae=Ee.exists()?Ee.data():{clientId:t.id,badges:[],totalVolume:0},ee=Ae.totalVolume||0,ge=ee+ue,we=[];PD.forEach(Ue=>{ge>=Ue.threshold&&ee<Ue.threshold&&(Ae.badges.some(ft=>ft.type==="volume_milestone"&&ft.milestone===Ue.threshold)||we.push({type:"volume_milestone",milestone:Ue.threshold,label:Ue.label,achievedAt:xt.now()}))});const Oe=[...Ae.badges,...we];await Ns(He(pe,"coreBuddyAchievements",t.id),{clientId:t.id,badges:Oe,totalVolume:Math.round(ge),updatedAt:xt.now()}),we.length>0&&bt(Ue=>[...Ue,...we])}catch(Ee){console.error("Error updating volume:",Ee)}},Jt=async(ue,Ee,Ae)=>{if(t)try{const ee=t.id,ge=await Rs(He(pe,"coreBuddyPBs",ee)),Oe=(ge.exists()?ge.data():null)?.exercises||{},Ue=Oe[ue];let $e=!1;if(Ue?(Ee>(Ue.weight||0)||Ee===(Ue.weight||0)&&Ae>(Ue.reps||0))&&($e=!0):$e=!0,$e){const ft={...Oe,[ue]:{weight:Ee,reps:Ae,achievedAt:xt.now()}};await Ns(He(pe,"coreBuddyPBs",ee),{clientId:t.id,exercises:ft,updatedAt:xt.now()}),Wt(`New PB! ${Ee}kg  ${Ae} reps`,"success"),at(),await vs(ue,Ee)}}catch(ee){console.error("Error checking PB:",ee)}},vs=async(ue,Ee)=>{if(t)try{const Ae=await Rs(He(pe,"coreBuddyTargets",t.id));if(!Ae.exists())return;const ge=(Ae.data().targets||{})[ue];if(!ge||Ee<ge.targetWeight)return;const we=await Rs(He(pe,"coreBuddyAchievements",t.id)),Oe=we.exists()?we.data():{clientId:t.id,badges:[],totalVolume:0};if(Oe.badges.some(jt=>jt.type==="pb_target"&&jt.exercise===ue&&jt.targetWeight===ge.targetWeight))return;const $e={type:"pb_target",exercise:ue,group:DD[ue]||"push",targetWeight:ge.targetWeight,achievedAt:xt.now()},ft=[...Oe.badges,$e];await Ns(He(pe,"coreBuddyAchievements",t.id),{...Oe,badges:ft,updatedAt:xt.now()}),bt(jt=>[...jt,$e])}catch(Ae){console.error("Error checking target badge:",Ae)}},Bt=kt&&r.jsxs("div",{className:`toast-notification ${kt.type}`,children:[kt.type==="success"&&r.jsx("span",{children:" "}),kt.message]}),As=(ue,Ee)=>r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:Ee,"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})});if(i||y==="loading")return r.jsx("div",{className:"cb-loading",children:r.jsx("div",{className:"cb-loading-spinner"})});if(y==="browse")return p("/client/core-buddy/workouts",{replace:!0}),null;if(y==="overview"&&j){const ue=j;return r.jsx(xa,{children:r.jsxs("div",{className:"pg-page","data-theme":l?"dark":"light","data-accent":d,children:[As(ue.name,()=>p("/client/core-buddy/workouts")),r.jsxs("main",{className:"pg-main",children:[r.jsxs("div",{className:"pg-overview-hero",children:[r.jsx("svg",{className:"pg-overview-icon",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:LD[ue.focus]})}),r.jsx("h2",{className:"pg-overview-name",children:ue.name}),r.jsx("p",{className:"pg-overview-desc",children:ue.description}),r.jsxs("div",{className:"pg-overview-stats",children:[r.jsxs("div",{className:"pg-ov-stat",children:[r.jsx("span",{className:"pg-ov-stat-num",children:ue.duration}),r.jsx("span",{className:"pg-ov-stat-label",children:"Weeks"})]}),r.jsxs("div",{className:"pg-ov-stat",children:[r.jsx("span",{className:"pg-ov-stat-num",children:ue.daysPerWeek}),r.jsx("span",{className:"pg-ov-stat-label",children:"Days/Week"})]}),r.jsxs("div",{className:"pg-ov-stat",children:[r.jsx("span",{className:"pg-ov-stat-num",children:ue.duration*ue.daysPerWeek}),r.jsx("span",{className:"pg-ov-stat-label",children:"Sessions"})]})]})]}),r.jsx("div",{className:"pg-overview-days",children:ue.days.map((Ee,Ae)=>r.jsxs("div",{className:"pg-day-card",children:[r.jsxs("div",{className:"pg-day-header",children:[r.jsx("span",{className:"pg-day-name",children:Ee.name}),r.jsx("span",{className:"pg-day-label",children:Ee.label})]}),r.jsx("div",{className:"pg-day-exercises",children:Ee.exercises.map((ee,ge)=>{const we=lh(ee,1,ue);return r.jsxs("div",{className:"pg-day-ex",children:[r.jsx("span",{className:"pg-day-ex-name",children:ee.name}),r.jsx("span",{className:"pg-day-ex-target",children:ee.type==="timed"?`${we.sets}${we.time}s`:`${we.sets}${we.reps}`}),r.jsx("span",{className:`pg-day-ex-badge pg-badge-${ee.type}`,children:ee.type==="weighted"?"WT":ee.type==="timed"?"TMR":"BW"})]},ge)})})]},Ae))}),r.jsxs("div",{className:"pg-overview-note",children:[r.jsx("strong",{children:"Progressive Overload:"})," +",ue.repProg," reps/week",ue.timeProg?`, +${ue.timeProg}s/week for timed`:""]}),r.jsx("button",{className:"pg-start-btn",onClick:()=>Xt(ue),children:"Start Programme"})]}),Bt]})})}if(y==="dashboard"){const ue=rt();if(!ue)return w("browse"),null;const Ee=it(),Ae=W?.completedSessions||{},ee=Ee.totalSessions?Math.round(Ee.totalCompleted/Ee.totalSessions*100):0;return Math.round(Ee.totalCompleted/(Ee.totalSessions||1)*MD),r.jsx(xa,{children:r.jsxs("div",{className:"pg-page","data-theme":l?"dark":"light","data-accent":d,children:[As("Programme",()=>p("/client/core-buddy/workouts")),r.jsxs("main",{className:"pg-main",children:[r.jsxs("div",{className:"pg-dash-hero",children:[r.jsxs("div",{className:"pg-dash-ring-wrap",children:[r.jsxs("svg",{viewBox:"0 0 200 200",children:[r.jsx("circle",{className:"pg-arc-track",cx:"100",cy:"100",r:"80"}),r.jsx("circle",{className:"pg-arc-fill",cx:"100",cy:"100",r:"80",strokeDasharray:2*Math.PI*80,strokeDashoffset:2*Math.PI*80-ee/100*2*Math.PI*80})]}),r.jsxs("div",{className:"pg-ring-center",children:[r.jsxs("span",{className:"pg-ring-pct",children:[ee,"%"]}),r.jsx("span",{className:"pg-ring-label",children:"complete"})]})]}),r.jsx("h2",{className:"pg-dash-name",children:ue.name}),r.jsxs("div",{className:"pg-dash-progress-text",children:[r.jsxs("span",{className:"pg-dash-pct",children:[ee,"%"]}),r.jsxs("span",{className:"pg-dash-week",children:["Week ",Ee.currentWeek," of ",ue.duration]})]})]}),r.jsx("div",{className:"pg-weeks",children:Array.from({length:ue.duration},(ge,we)=>{const Oe=we+1,Ue=st(Oe);return r.jsxs("div",{className:`pg-week-row${Oe===Ee.currentWeek?" pg-week-current":""}`,children:[r.jsxs("span",{className:"pg-week-label",children:["W",Oe]}),r.jsx("div",{className:"pg-week-days",children:ue.days.map(($e,ft)=>{const jt=`w${Oe}d${ft}`,Q=!!Ae[jt],fe=!Q&&Ue,lt=!Q&&!fe&&Oe===Ee.currentWeek&&!Ee.complete;return r.jsx("button",{className:`pg-day-dot${Q?" done":""}${fe?" missed":""}${lt?" next":""}`,disabled:!lt,onClick:()=>{lt&&Ks(Oe,ft)},children:Q?r.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:r.jsx("path",{d:"M20 6L9 17l-5-5"})}):fe?r.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]}):r.jsx("span",{children:$e.name.replace("Day ","")})},ft)})})]},we)})}),!Ee.complete&&(()=>{const ge=ue.days.map((we,Oe)=>({day:we,d:Oe})).filter(({d:we})=>!Ae[`w${Ee.currentWeek}d${we}`]);return ge.length===0?null:r.jsxs("div",{className:"pg-next-session",children:[r.jsx("h3",{children:ge.length===ue.daysPerWeek?"Choose a Session":"Remaining Sessions"}),r.jsxs("p",{className:"pg-next-info",children:["Week ",Ee.currentWeek,"  ",ge.length," session",ge.length!==1?"s":""," left this week"]}),ge.map(({day:we,d:Oe})=>r.jsxs("div",{className:"pg-available-session",children:[r.jsxs("div",{className:"pg-next-exercises",children:[r.jsxs("span",{className:"pg-avail-day-label",children:[we.name,": ",we.label]}),we.exercises.map((Ue,$e)=>{const ft=lh(Ue,Ee.currentWeek,ue);return r.jsxs("div",{className:"pg-next-ex",children:[r.jsx("span",{className:"pg-next-ex-name",children:Ue.name}),r.jsx("span",{className:"pg-next-ex-target",children:Ue.type==="timed"?`${ft.sets}${ft.time}s`:`${ft.sets}${ft.reps}`})]},$e)})]}),r.jsxs("button",{className:"pg-start-btn",onClick:()=>Ks(Ee.currentWeek,Oe),children:["Start ",we.name]})]},Oe))]})})(),Ee.complete&&r.jsxs("div",{className:"pg-complete-msg",children:[r.jsx("h3",{children:"Programme Complete! "}),r.jsxs("p",{children:["You finished all ",Ee.totalSessions," sessions."]}),r.jsx("button",{className:"pg-start-btn",onClick:Gt,children:"Choose New Programme"})]}),r.jsx("button",{className:"pg-quit-btn",onClick:()=>{confirm("Quit this programme? Progress will be lost.")&&Gt()},children:"Quit Programme"})]}),r.jsx(aa,{active:"workouts"}),Bt]})})}if(y==="session"){const ue=rt();if(!ue)return null;const Ee=ue.days[Y],Ae=Ee.exercises[be],ee=lh(Ae,U,ue),ge=E[be],we=ge?.sets?.length||0,Oe=Ee.exercises.length,Ue=(be+we/ee.sets)/Oe,$e=Ke[Ae.name],ft=Kt(U,Y,Ae.name);Ae.type==="timed"&&$===0&&!We&&we===Ce&&setTimeout(()=>me(ee.time),0);const jt=()=>{$e?.isGif?se(!L):Me.current&&(L?Me.current.pause():Me.current.play(),se(!L))};return r.jsxs("div",{className:"pg-page pg-page-session","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("div",{className:"pg-session-progress",children:r.jsx("div",{className:"pg-session-progress-fill",style:{width:`${Ue*100}%`}})}),r.jsxs("div",{className:"pg-session-header",children:[r.jsx("button",{className:"pg-session-back",onClick:()=>{confirm("Leave session? Progress will be lost.")&&w("dashboard")},children:r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M19 12H5M12 5l-7 7 7 7"})})}),r.jsxs("div",{className:"pg-session-title",children:[r.jsxs("span",{className:"pg-session-counter",children:[be+1," / ",Oe]}),r.jsxs("span",{className:"pg-session-week",children:["Week ",U,"  ",Ee.name]})]})]}),$e&&r.jsxs("div",{className:"pg-video-container",onClick:jt,children:[$e.isGif?r.jsx("img",{className:"pg-video",src:$e.url,alt:Ae.name}):r.jsx("video",{ref:Me,className:"pg-video",src:$e.url,loop:!0,muted:!0,playsInline:!0},Ae.name),!L&&r.jsxs("div",{className:"pg-video-overlay",children:[r.jsx("svg",{className:"pg-play-icon",viewBox:"0 0 24 24",fill:"white",children:r.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})}),r.jsx("span",{className:"pg-video-hint",children:"Tap for demo"})]})]}),r.jsx("div",{className:"pg-spotify",children:r.jsx("iframe",{src:"https://open.spotify.com/embed/playlist/37i9dQZF1DZ06evO3FJyYF?utm_source=generator&theme=0",width:"100%",height:"80",frameBorder:"0",allow:"autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture",loading:"lazy",title:"Spotify Playlist"})}),r.jsxs("div",{className:"pg-exercise-card",children:[r.jsx("h2",{className:"pg-ex-name",children:Ae.name}),r.jsx("span",{className:`pg-ex-type-badge pg-badge-${Ae.type}`,children:Ae.type==="weighted"?"Weight + Reps":Ae.type==="timed"?"Timed":"Reps Only"}),Ae.type==="weighted"&&ft&&r.jsxs("div",{className:"pg-last-week",children:[r.jsx("span",{className:"pg-last-week-label",children:"Last week:"}),r.jsxs("span",{className:"pg-last-week-value",children:[ft.weight,"kg x ",ft.reps," reps"]})]}),r.jsxs("div",{className:"pg-ex-set-info",children:[r.jsxs("span",{className:"pg-ex-set-num",children:["Set ",we+1," of ",ee.sets]}),r.jsxs("span",{className:"pg-ex-target",children:["Target: ",Ae.type==="timed"?`${ee.time}s hold`:`${ee.reps} reps`]})]}),Ae.type==="weighted"&&r.jsxs("div",{className:"pg-input-area",children:[r.jsxs("div",{className:"pg-input-group",children:[r.jsx("label",{children:"Weight (kg)"}),r.jsx("input",{type:"number",inputMode:"decimal",value:O,onChange:Q=>D(Q.target.value),placeholder:"0",className:"pg-input"})]}),r.jsxs("div",{className:"pg-input-group",children:[r.jsx("label",{children:"Reps"}),r.jsx("input",{type:"number",inputMode:"numeric",value:H,onChange:Q=>M(Q.target.value),placeholder:String(ee.reps),className:"pg-input"})]})]}),Ae.type==="reps"&&r.jsx("div",{className:"pg-input-area",children:r.jsxs("div",{className:"pg-input-group pg-input-single",children:[r.jsx("label",{children:"Reps"}),r.jsx("input",{type:"number",inputMode:"numeric",value:H,onChange:Q=>M(Q.target.value),placeholder:String(ee.reps),className:"pg-input"})]})}),Ae.type==="timed"&&r.jsxs("div",{className:"pg-timer-area",children:[r.jsx("div",{className:"pg-timer-display",children:r.jsxs("span",{className:"pg-timer-value",children:[$,"s"]})}),We?r.jsx("button",{className:"pg-timer-btn pg-timer-stop",onClick:()=>gt(!1),children:"Stop"}):r.jsx("button",{className:"pg-timer-btn",onClick:()=>{$===0&&me(ee.time),gt(!0)},children:$<ee.time&&$>0?"Resume":"Start Timer"})]}),r.jsx("button",{className:"pg-log-set-btn",onClick:Ps,disabled:Ae.type==="timed"&&We,children:we+1<ee.sets?"Log Set":be+1<Oe?"Log Set  Next Exercise":"Log Set  Complete"}),ge?.sets?.length>0&&r.jsx("div",{className:"pg-completed-sets",children:ge.sets.map((Q,fe)=>r.jsxs("div",{className:"pg-completed-set",children:[r.jsx("span",{className:"pg-completed-set-check",children:""}),r.jsxs("span",{children:["Set ",fe+1,": ",Q.weight!==void 0?`${Q.weight}kg  ${Q.reps}`:Q.time!==void 0?`${Q.time}s`:`${Q.reps} reps`]})]},fe))})]}),Bt]})}if(y==="sessionComplete"){const Ee=rt()?.days[Y],Ae=E.reduce((ge,we)=>ge+we.sets.length,0),ee=E.reduce((ge,we)=>ge+we.sets.reduce((Oe,Ue)=>Oe+(Ue.weight||0)*(Ue.reps||0),0),0);return r.jsxs("div",{className:"pg-page pg-page-center","data-theme":l?"dark":"light","data-accent":d,children:[r.jsxs("div",{className:"pg-session-done",children:[r.jsxs("div",{className:"pg-done-ring",children:[r.jsx("svg",{className:"pg-done-ring-svg",viewBox:"0 0 200 200",children:hu.map((ge,we)=>r.jsx("line",{x1:ge.x1,y1:ge.y1,x2:ge.x2,y2:ge.y2,className:"pg-tick-complete",strokeWidth:ge.thick?"3.5":"2",style:{animationDelay:`${we*.02}s`}},we))}),r.jsx("div",{className:"pg-done-center",children:r.jsx("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"#4caf50",strokeWidth:"2.5",strokeLinecap:"round",children:r.jsx("path",{d:"M20 6L9 17l-5-5"})})})]}),r.jsx("h2",{className:"pg-done-title",children:"Session Complete!"}),r.jsxs("p",{className:"pg-done-subtitle",children:["Week ",U,"  ",Ee?.name,": ",Ee?.label]}),r.jsxs("div",{className:"pg-done-stats",children:[r.jsxs("div",{className:"pg-done-stat",children:[r.jsx("span",{className:"pg-done-stat-num",children:E.length}),r.jsx("span",{className:"pg-done-stat-label",children:"Exercises"})]}),r.jsxs("div",{className:"pg-done-stat",children:[r.jsx("span",{className:"pg-done-stat-num",children:Ae}),r.jsx("span",{className:"pg-done-stat-label",children:"Sets"})]}),ee>0&&r.jsxs("div",{className:"pg-done-stat",children:[r.jsx("span",{className:"pg-done-stat-num",children:Math.round(ee).toLocaleString()}),r.jsx("span",{className:"pg-done-stat-label",children:"Volume (kg)"})]})]}),r.jsx("button",{className:"pg-start-btn",onClick:()=>w("dashboard"),children:"Back to Programme"})]}),De&&r.jsx("div",{className:"pg-badge-celebration",onClick:()=>Je(null),children:r.jsxs("div",{className:"pg-badge-celebration-card",onClick:ge=>ge.stopPropagation(),children:[r.jsx("div",{className:"pg-badge-celebration-icon",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),r.jsx("h3",{className:"pg-badge-celebration-title",children:De.badges.length===1?"Badge Earned!":`${De.badges.length} Badges Earned!`}),r.jsx("div",{className:"pg-badge-celebration-list",children:De.badges.map((ge,we)=>r.jsx("div",{className:"pg-badge-celebration-item",children:ge.type==="pb_target"?`${ge.exercise}  ${ge.targetWeight}kg`:ge.label},we))}),r.jsx("button",{className:"pg-badge-celebration-dismiss",onClick:()=>Je(null),children:"Tap to dismiss"})]})}),Bt]})}return null}const VD={"Dumbbell Floor Press":"push","Seated Dumbbell Shoulder Press":"push","Seated Dumbbell Arnold Press":"push","Dumbbell Overhead Tricep Extension":"push",Skullcrushers:"push","Dumbbell Lateral Raise":"push","Dumbbell Front Raise":"push","Dumbbell Bent Over Row":"pull","Single Arm Bent Over Row":"pull","Bicep Curl":"pull","Hammer Curl":"pull","Dumbbell Bent Over Rear Delt Fly":"pull","Renegade Row":"pull","Dumbbell Goblet Squats":"lower","Romanian Deadlifts":"lower","Forward Dumbbell Lunges":"lower","Dumbbell Sumo Squats":"lower","Weighted Calf Raises":"lower","1 Legged RDL":"lower","Dumbbell Box Step Ups":"lower","Dumbbell Squat Pulses":"lower","Dumbbell Reverse Lunges":"lower","Kettlebell Romanian Deadlift":"lower","Russian Twists Dumbbell":"core","Kettlebell Russian Twist":"core","Kettlebell Side Bends":"core","Kneeling Kettlebell Halo":"core"},BD={push:{label:"Push",color:"#c75f6b",icon:"M4 12h3l3-9 4 18 3-9h3"},pull:{label:"Pull",color:"#5f8ac7",icon:"M12 2v10m0 0l-4-4m4 4l4-4M4 20h16"},lower:{label:"Lower",color:"#5fc77a",icon:"M12 2v8m-4 4l4 8 4-8m-8 0h8"},core:{label:"Core",color:"#c7a45f",icon:"M12 2a4 4 0 014 4v1h-2V6a2 2 0 10-4 0v1H8V6a4 4 0 014-4zM8 9h8v2H8V9zm-1 4h10l-1 9H8l-1-9z"}},Qp=[{threshold:1e3,label:"1 Tonne",icon:"1T"},{threshold:5e3,label:"5 Tonne",icon:"5T"},{threshold:1e4,label:"10 Tonne",icon:"10T"},{threshold:25e3,label:"25 Tonne",icon:"25T"},{threshold:5e4,label:"50 Tonne",icon:"50T"},{threshold:1e5,label:"100 Tonne",icon:"100T"},{threshold:25e4,label:"250 Tonne",icon:"250T"},{threshold:5e5,label:"500 Tonne",icon:"500T"},{threshold:1e6,label:"1 Million kg",icon:"1M"}];function UD(n){return VD[n]||"push"}function FD(n){return n>=1e6?`${(n/1e6).toFixed(1)}M`:n>=1e3?`${(n/1e3).toFixed(1)}T`:`${Math.round(n)}`}function zD(n){return n>=1e6?"million kg":n>=1e3?"tonnes":"kg"}function qD(){const{currentUser:n,isClient:e,clientData:t,loading:i}=Mr(),{isDark:l,toggleTheme:u,accent:d}=ka(),p=$n(),[g,y]=v.useState(!0),[w,j]=v.useState(null),[T,V]=v.useState({}),[W,F]=v.useState([]),[U,ne]=v.useState(null),[Y,oe]=v.useState(0),[be,Le]=v.useState({});v.useRef(null),v.useEffect(()=>{!i&&(!n||!e)&&p("/")},[n,e,i,p]),v.useEffect(()=>{if(!t)return;(async()=>{try{const[me,Ve,Ke,J]=await Promise.all([Rs(He(pe,"coreBuddyAchievements",t.id)),Rs(He(pe,"coreBuddyPBs",t.id)),Rs(He(pe,"achievements",t.id)),Es(Ds(zt(pe,"workoutLogs"),hs("clientId","==",t.id)))]);me.exists()&&j(me.data()),Ve.exists()&&V(Ve.data().exercises||{}),Ke.exists()&&(F(Object.keys(Ke.data().badges||{})),Le(Ke.data().progress||{})),oe(J.docs.length)}catch(me){console.error("Error loading achievements:",me)}y(!1)})()},[t]);const Ce=w?.badges||[],R=w?.totalVolume||0,E=Ce.filter($=>$.type==="pb_target"),A=Ce.filter($=>$.type==="volume_milestone"),O={push:[],pull:[],lower:[],core:[]};E.forEach($=>{const me=$.group||UD($.exercise);O[me]&&O[me].push($)});const D=Qp.find($=>R<$.threshold),H=Qp.filter($=>R>=$.threshold).pop()?.threshold||0,M=D?(R-H)/(D.threshold-H):1;if(i||g)return r.jsxs("div",{className:"ach-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsx("div",{className:"header-content",children:r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})})}),r.jsx("div",{className:"ach-loading-inline",children:r.jsx("div",{className:"cb-loading-spinner"})})]});const We=Ce.length+W.length,gt=We>0||R>0||Y>0;return r.jsx(xa,{children:r.jsxs("div",{className:"ach-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),r.jsxs("main",{className:"ach-main",children:[r.jsx("button",{className:"nut-back-btn",onClick:()=>p("/client/personal-bests?mode=corebuddy"),children:" Back"}),r.jsxs("div",{className:"ach-stats-banner",children:[r.jsxs("div",{className:"ach-stat-item",children:[r.jsx("span",{className:"ach-stat-num",children:We}),r.jsx("span",{className:"ach-stat-label",children:We===1?"Badge":"Badges"})]}),r.jsx("div",{className:"ach-stat-divider"}),r.jsxs("div",{className:"ach-stat-item",children:[r.jsx("span",{className:"ach-stat-num",children:FD(R)}),r.jsxs("span",{className:"ach-stat-label",children:[zD(R)," lifted"]})]}),r.jsx("div",{className:"ach-stat-divider"}),r.jsxs("div",{className:"ach-stat-item",children:[r.jsx("span",{className:"ach-stat-num",children:Object.keys(T).length}),r.jsx("span",{className:"ach-stat-label",children:"PBs"})]})]}),!gt&&r.jsxs("div",{className:"ach-empty",children:[r.jsx("div",{className:"ach-empty-icon",children:r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[r.jsx("path",{d:"M12 15l-3-3h6l-3 3z"}),r.jsx("path",{d:"M5 7h14l-1.5 9h-11L5 7z"}),r.jsx("path",{d:"M8.5 7V5a3.5 3.5 0 017 0v2"})]})}),r.jsx("h4",{children:"No achievements yet"}),r.jsx("p",{children:"Complete workouts to track volume and set PB targets to start earning badges."})]}),[{key:"workouts",title:"Workout Badges",iconPath:"M20.57 14.86L22 13.43 20.57 12 17 15.57 8.43 7 12 3.43 10.57 2 9.14 3.43 7.71 2 5.57 4.14 4.14 2.71 2.71 4.14l1.43 1.43L2 7.71l1.43 1.43L2 10.57 3.43 12 7 8.43 15.57 17 12 20.57 13.43 22l1.43-1.43L16.29 22l2.14-2.14 1.43 1.43 1.43-1.43-1.43-1.43L22 16.29z"},{key:"streaks",title:"Streak Badges",iconPath:"M13.5.67s.74 2.65.74 4.8c0 2.06-1.35 3.73-3.41 3.73-2.07 0-3.63-1.67-3.63-3.73l.03-.36C5.21 7.51 4 10.62 4 14c0 4.42 3.58 8 8 8s8-3.58 8-8C20 8.61 17.41 3.8 13.5.67z"},{key:"pbs",title:"Personal Best Badges",iconPath:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"},{key:"nutrition",title:"Nutrition Badges",iconPath:"M18.06 23h1.66c.84 0 1.53-.65 1.63-1.47L23 5.05h-5V1h-2v4.05h-5l.3 2.34c1.71.47 3.31 1.32 4.27 2.26 1.44 1.42 2.43 2.89 2.43 5.29V23zM1 22v-1h15.03v1c0 .55-.45 1-1.01 1H2.01c-.56 0-1.01-.45-1.01-1zm15.03-7c0-4.87-4.66-5.84-8.03-5.97l.72 5.52L1 15.05v5.95h15.03V15z"},{key:"habits",title:"Habit Badges",iconPath:"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z"},{key:"leaderboard",title:"Leaderboard Badges",iconPath:"M7.5 21H2V9h5.5v12zm7.25-18h-5.5v18h5.5V3zM22 11h-5.5v10H22V11z"}].map($=>{const me=mu.filter(J=>J.category===$.key);if(me.length===0)return null;const Ve=(()=>{switch($.key){case"workouts":return Y;case"streaks":return be.streakWeeks||0;case"pbs":return Object.keys(T).length;case"nutrition":return be.nutritionStreak||0;case"leaderboard":return t?.leaderboardOptIn?1:0;case"habits":return be.habitStreak||0;default:return 0}})(),Ke=me.filter(J=>W.includes(J.id)).length;return r.jsxs("div",{className:"ach-section",children:[r.jsxs("h3",{className:"ach-section-title",children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20",children:r.jsx("path",{d:$.iconPath})}),$.title]}),r.jsx("div",{className:"ach-workout-carousel",children:me.map(J=>{const L=W.includes(J.id);return r.jsxs("button",{className:`ach-workout-badge${L?" unlocked":" locked"}`,onClick:()=>ne(J),children:[r.jsx("img",{src:J.img,alt:J.name,className:"ach-workout-badge-img"}),!L&&J.threshold&&r.jsx("div",{className:"ach-workout-badge-progress",children:r.jsx("div",{className:"ach-workout-badge-progress-fill",style:{width:`${Math.min(Ve/J.threshold*100,100)}%`}})})]},J.id)})}),r.jsxs("p",{className:"ach-workout-badges-count",children:[Ke,"/",me.length," unlocked"]})]},$.key)}),U&&r.jsx("div",{className:"ach-badge-overlay",onClick:()=>ne(null),children:r.jsxs("div",{className:"ach-badge-overlay-content",onClick:$=>$.stopPropagation(),children:[r.jsx("img",{src:U.img,alt:U.name,className:`ach-badge-overlay-img${W.includes(U.id)?"":" ach-badge-overlay-img-locked"}`}),r.jsx("p",{className:"ach-badge-overlay-desc",children:U.desc}),W.includes(U.id)?r.jsx("span",{className:"ach-badge-overlay-status unlocked",children:"Unlocked"}):r.jsx("span",{className:"ach-badge-overlay-status locked",children:"Locked"}),r.jsx("button",{className:"ach-badge-overlay-close",onClick:()=>ne(null),children:"Tap to close"})]})}),r.jsxs("div",{className:"ach-section",children:[r.jsxs("h3",{className:"ach-section-title",children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20",children:r.jsx("path",{d:"M20.57 14.86L22 13.43 20.57 12 17 15.57 8.43 7 12 3.43 10.57 2 9.14 3.43 7.71 2 5.57 4.14 4.14 2.71 2.71 4.14l1.43 1.43L2 7.71l1.43 1.43L2 10.57 3.43 12 7 8.43 15.57 17 12 20.57 13.43 22l1.43-1.43L16.29 22l2.14-2.14 1.43 1.43 1.43-1.43-1.43-1.43L22 16.29z"})}),"Volume Milestones"]}),r.jsxs("div",{className:"ach-volume-hero",children:[r.jsxs("div",{className:"ach-volume-ring",children:[r.jsx("svg",{className:"ach-volume-ring-svg",viewBox:"0 0 200 200",children:hu.map(($,me)=>{const Ve=me<Math.round(M*60);return r.jsx("line",{x1:$.x1,y1:$.y1,x2:$.x2,y2:$.y2,className:Ve?"ach-tick-filled":"ach-tick-empty",strokeWidth:$.thick?"3":"2"},me)})}),r.jsxs("div",{className:"ach-volume-center",children:[r.jsx("span",{className:"ach-volume-number",children:Math.round(R).toLocaleString()}),r.jsx("span",{className:"ach-volume-unit",children:"kg lifted"})]})]}),D&&r.jsxs("div",{className:"ach-volume-next",children:["Next: ",r.jsx("strong",{children:D.label})," (",(D.threshold-R).toLocaleString(),"kg to go)"]})]}),r.jsx("div",{className:"ach-milestone-shelf",children:Qp.map(($,me)=>{const Ve=R>=$.threshold,Ke=A.find(J=>J.milestone===$.threshold);return r.jsxs("div",{className:`ach-milestone ${Ve?"unlocked":"locked"}`,children:[r.jsx("div",{className:"ach-milestone-hex",children:r.jsx("span",{className:"ach-milestone-icon",children:$.icon})}),r.jsx("span",{className:"ach-milestone-label",children:$.label}),Ke?.achievedAt&&r.jsx("span",{className:"ach-milestone-date",children:(Ke.achievedAt.toDate?Ke.achievedAt.toDate():new Date(Ke.achievedAt)).toLocaleDateString("en-GB",{day:"numeric",month:"short"})})]},me)})})]}),r.jsxs("div",{className:"ach-section",children:[r.jsxs("h3",{className:"ach-section-title",children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),"PB Target Badges"]}),E.length===0?r.jsx("div",{className:"ach-pb-empty",children:r.jsxs("p",{children:["Set targets on your personal bests to start earning badges. Go to ",r.jsx("strong",{children:"My Progress"}),' and tap "Set Target" on any PB.']})}):Object.entries(O).map(([$,me])=>{if(me.length===0)return null;const Ve=BD[$];return r.jsxs("div",{className:"ach-group",children:[r.jsxs("div",{className:"ach-group-header",style:{borderLeftColor:Ve.color},children:[r.jsx("span",{className:"ach-group-label",style:{color:Ve.color},children:Ve.label}),r.jsx("span",{className:"ach-group-count",children:me.length})]}),r.jsx("div",{className:"ach-badge-grid",children:me.map((Ke,J)=>r.jsxs("div",{className:"ach-badge-card",style:{animationDelay:`${J*.06}s`,"--group-color":Ve.color},children:[r.jsx("div",{className:"ach-badge-hex",style:{borderColor:Ve.color,boxShadow:`0 0 12px ${Ve.color}33`},children:r.jsx("svg",{className:"ach-badge-hex-icon",viewBox:"0 0 24 24",fill:"none",stroke:Ve.color,strokeWidth:"2",strokeLinecap:"round",children:r.jsx("path",{d:Ve.icon})})}),r.jsxs("div",{className:"ach-badge-info",children:[r.jsx("span",{className:"ach-badge-exercise",children:Ke.exercise}),r.jsxs("span",{className:"ach-badge-value",style:{color:Ve.color},children:[Ke.targetWeight,"kg"]}),Ke.achievedAt&&r.jsx("span",{className:"ach-badge-date",children:(Ke.achievedAt.toDate?Ke.achievedAt.toDate():new Date(Ke.achievedAt)).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"})})]})]},J))})]},$)})]})]}),r.jsx(aa,{active:"home"})]})})}const HD=[{key:"trained",label:"Trained",icon:"M4 10v4M8 7v10M8 12h8M16 7v10M20 10v4",color:"#A12F3A"},{key:"protein",label:"Hit Protein",icon:"M12 22c5.52 0 10-4.48 10-10S17.52 2 12 2 2 6.48 2 12s4.48 10 10 10zM12 18c3.31 0 6-2.69 6-6s-2.69-6-6-6-6 2.69-6 6 2.69 6 6 6zM12 14a2 2 0 1 0 0-4 2 2 0 0 0 0 4z",color:"#4caf50"},{key:"steps",label:"10k Steps",icon:"M4 19.5A2.5 2.5 0 0 1 6.5 17H20M4 12.5A2.5 2.5 0 0 1 6.5 10H20M4 5.5A2.5 2.5 0 0 1 6.5 3H20",color:"#ff9800"},{key:"sleep",label:"8hrs Sleep",icon:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z",color:"#7c3aed"},{key:"water",label:"2L Water",icon:"M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z",color:"#2196f3"}],$D="M12 2l2.4 7.2L22 12l-7.6 2.8L12 22l-2.4-7.2L2 12l7.6-2.8z",WD="#e91e63",GD=700,Ig=42,Pl=2*Math.PI*Ig,ch=["Every day counts. See you tomorrow!","Consistency is your superpower.","Perfect day  keep the streak alive!","You showed up for yourself today."];function KD(n){const e=new Date(n),t=e.getDay(),i=t===0?-6:1-t;return e.setDate(e.getDate()+i),e.setHours(0,0,0,0),e}function Xp(n){return n.toISOString().split("T")[0]}function YD(n){return Array.from({length:7},(e,t)=>{const i=new Date(n);return i.setDate(n.getDate()+t),i})}function QD(){const{currentUser:n,isClient:e,clientData:t,loading:i}=Mr(),{isDark:l,toggleTheme:u,accent:d}=ka(),p=$n(),[g,y]=v.useState({}),[w,j]=v.useState([]),[T,V]=v.useState(!0),[W,F]=v.useState(!1),[U,ne]=v.useState(0),[Y,oe]=v.useState(null),[be,Le]=v.useState(null),[Ce,R]=v.useState(!1),[E,A]=v.useState(!1),[O,D]=v.useState(!1),[H,M]=v.useState(!1),[We,gt]=v.useState(""),[$,me]=v.useState(null),[Ve,Ke]=v.useState([]),[J,L]=v.useState(null),se=v.useRef(null),Me=v.useRef(null),De=v.useRef(null),Je=v.useRef(!1),Fe=v.useRef({}),bt=v.useRef([]),kt=v.useRef([]),nt=v.useRef(null),Wt=v.useRef(ch[Math.floor(Math.random()*ch.length)]),ts=v.useCallback((ee,ge="info")=>{oe({message:ee,type:ge}),setTimeout(()=>oe(null),3e3)},[]),St=new Date,at=Xp(St),ce=KD(St),Xt=YD(ce),Gt=["M","T","W","T","F","S","S"],rt=[...HD.filter(ee=>!Ve.includes(ee.key)),...w.map(ee=>({key:`custom_${ee.id}`,label:ee.label,icon:$D,color:WD,isCustom:!0,id:ee.id}))];v.useEffect(()=>{!i&&(!n||!e)&&p("/")},[n,e,i,p]),v.useEffect(()=>{if(!n||!t)return;(async()=>{try{const ge=zt(pe,"habitLogs"),we=Ds(ge,hs("clientId","==",t.id)),Oe=await Es(we),Ue={};Oe.docs.forEach(Q=>{const fe=Q.data();Ue[fe.date]={...fe,_id:Q.id}}),y(Ue);const $e=await Rs(He(pe,"customHabits",t.id));if($e.exists()){const Q=$e.data();j(Q.habits||[]),Ke(Q.hiddenDefaults||[])}let ft=0;const jt=new Date(St);for(;;){const Q=Xp(jt),fe=Ue[Q];if(fe)if(Object.values(fe.habits||{}).filter(Boolean).length>=3)ft++,jt.setDate(jt.getDate()-1);else break;else if(Q===at)jt.setDate(jt.getDate()-1);else break}ne(ft)}catch(ge){console.error("Error loading habit logs:",ge)}finally{V(!1)}})()},[n,t]);const pt=g[at]||{habits:{}};v.useEffect(()=>{Object.values(pt.habits||{}).filter(Boolean).length<rt.length&&O&&D(!1)},[rt.length,pt.habits]);const it=async ee=>{if(!(!n||W||pt.habits?.[ee])){bt.current=[...Array(10)].map((we,Oe)=>{const Ue=Oe/10*2*Math.PI,$e=18+Math.random()*20;return{tx:Math.cos(Ue)*$e,ty:Math.sin(Ue)*$e,size:3+Math.random()*4,duration:.4+Math.random()*.3}}),Le(ee),setTimeout(()=>Le(null),700),navigator.vibrate&&navigator.vibrate(50),F(!0);try{const Oe={...pt.habits||{},[ee]:!0},Ue=pt._id||`${t.id}_${at}`;y(ft=>({...ft,[at]:{clientId:t.id,date:at,habits:Oe,_id:Ue}})),await Ns(He(pe,"habitLogs",Ue),{clientId:t.id,date:at,habits:Oe}),Object.values(Oe).filter(Boolean).length===rt.length&&!O&&(Wt.current=ch[Math.floor(Math.random()*ch.length)],kt.current=[...Array(80)].map((ft,jt)=>({x:5+Math.random()*90,delay:Math.random()*3.5,color:["#A12F3A","#4caf50","#ff9800","#2196f3","#e91e63","#ffeb3b","#FFD700","#ffffff","#9c27b0"][jt%9],drift:(Math.random()-.5)*120,spin:Math.random()*720-360,duration:1.8+Math.random()*2,width:4+Math.random()*6,height:4+Math.random()*8,shape:jt%3})),setTimeout(()=>{R(!0),D(!0),setTimeout(()=>nt.current?.focus(),1100)},400))}catch(we){console.error("Error saving habit:",we),ts("Failed to save. Try again.","error"),y(Oe=>({...Oe,[at]:{...Oe[at],habits:{...Oe[at]?.habits||{},[ee]:!1}}}))}finally{F(!1)}}},st=async ee=>{if(!(!n||W)){F(!0);try{const we={...pt.habits||{},[ee]:!1},Oe=pt._id||`${t.id}_${at}`;await Ns(He(pe,"habitLogs",Oe),{clientId:t.id,date:at,habits:we}),y(Ue=>({...Ue,[at]:{clientId:t.id,date:at,habits:we,_id:Oe}}))}catch(ge){console.error("Error undoing habit:",ge),ts("Failed to undo. Try again.","error")}finally{F(!1)}}},Kt=ee=>{if(pt.habits?.[ee]||!1||W)return;Je.current=!1,L(ee),Me.current=performance.now();const we=Fe.current[ee];we&&(we.style.strokeDashoffset=Pl);const Oe=Ue=>{const $e=Ue-Me.current,ft=Math.min($e/GD,1),jt=Fe.current[ee];jt&&(jt.style.strokeDashoffset=Pl-ft*Pl),ft<1?De.current=requestAnimationFrame(Oe):(Je.current=!0,De.current=null,L(null),it(ee))};De.current=requestAnimationFrame(Oe)},Ks=()=>{De.current&&(cancelAnimationFrame(De.current),De.current=null),se.current&&(clearTimeout(se.current),se.current=null),!Je.current&&J&&Fe.current[J]&&(Fe.current[J].style.strokeDashoffset=Pl),Je.current=!1,L(null),Me.current=null};v.useEffect(()=>()=>{De.current&&cancelAnimationFrame(De.current),se.current&&clearTimeout(se.current)},[]);const Ps=()=>{A(!0),setTimeout(()=>{R(!1),A(!1)},300)},ss=async()=>{const ee=We.trim();if(!ee)return;if(!t?.id){ts("Still loading, try again","error");return}const ge=Date.now().toString(36),we=[...w,{id:ge,label:ee}];try{await Ns(He(pe,"customHabits",t.id),{clientId:t.id,habits:we,hiddenDefaults:Ve},{merge:!0}),j(we),gt(""),M(!1),ts(`Added "${ee}"`,"success")}catch(Oe){console.error("Error adding custom habit:",Oe),ts(Oe?.code==="permission-denied"?"Permission denied  check Firestore rules for customHabits":`Failed to add habit: ${Oe?.message||"Unknown error"}`,"error")}},Ct=async ee=>{if(!t?.id)return;const ge=w.filter(we=>we.id!==ee);try{await Ns(He(pe,"customHabits",t.id),{clientId:t.id,habits:ge,hiddenDefaults:Ve},{merge:!0}),j(ge),me(null),ts("Habit removed","success")}catch(we){console.error("Error deleting habit:",we),ts("Failed to remove","error")}},Jt=async ee=>{if(!t?.id)return;const ge=[...Ve,ee];try{await Ns(He(pe,"customHabits",t.id),{clientId:t.id,habits:w,hiddenDefaults:ge},{merge:!0}),Ke(ge),me(null),ts("Habit removed","success")}catch(we){console.error("Error hiding default habit:",we),ts("Failed to remove","error")}},vs=Xt.map(ee=>{const ge=Xp(ee),we=g[ge],Oe=we?Object.values(we.habits||{}).filter(Boolean).length:0;return{date:ee,dateStr:ge,completed:Oe,total:rt.length}}),Bt=vs.reduce((ee,ge)=>ee+ge.completed,0),As=vs.reduce((ee,ge)=>ee+ge.total,0),ue=As>0?Math.round(Bt/As*100):0,Ee=Object.values(pt.habits||{}).filter(Boolean).length,Ae=rt.length>0?Math.round(Ee/rt.length*100):0;return r.jsx(xa,{children:r.jsxs("div",{className:"cbc-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>p("/client/core-buddy"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),i||T?r.jsx("div",{className:"cbc-loading-inline",children:r.jsx("div",{className:"cbc-loading-spinner"})}):r.jsxs("main",{className:"cbc-main",children:[r.jsxs("div",{className:"cbc-ring-section anim-fade-up",children:[r.jsxs("div",{className:"cbc-progress-ring",children:[r.jsxs("svg",{viewBox:"0 0 200 200",children:[r.jsx("circle",{className:"cbc-arc-track",cx:"100",cy:"100",r:"80"}),r.jsx("circle",{className:"cbc-arc-fill",cx:"100",cy:"100",r:"80",strokeDasharray:2*Math.PI*80,strokeDashoffset:2*Math.PI*80-Ae/100*2*Math.PI*80})]}),r.jsxs("div",{className:"cbc-ring-center",children:[r.jsxs("span",{className:"cbc-ring-pct",children:[Ae,"%"]}),r.jsx("span",{className:"cbc-ring-label",children:"today"})]})]}),r.jsxs("div",{className:"cbc-streak",children:[r.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"var(--color-primary)",strokeWidth:"2",children:r.jsx("path",{d:"M13 2L3 14h9l-1 8 10-12h-9l1-8z"})}),r.jsx("span",{className:"cbc-streak-count",children:U}),r.jsx("span",{className:"cbc-streak-label",children:"day streak"})]})]}),r.jsxs("div",{className:"cbc-section anim-fade-up-d2",children:[r.jsx("h2",{className:"cbc-section-title",children:"Today's Habits"}),r.jsxs("div",{className:"cbc-habits-grid",children:[rt.map(ee=>{const ge=pt.habits?.[ee.key]||!1,we=be===ee.key,Oe=J===ee.key;return r.jsxs("div",{className:`cbc-habit-tile ${ge?"cbc-habit-done":""} ${we?"cbc-habit-just-checked":""}`,style:{"--habit-color":ee.color},children:[r.jsx("button",{className:"cbc-habit-delete",onClick:Ue=>{Ue.stopPropagation(),me(ee.isCustom?{type:"custom",id:ee.id,label:ee.label}:{type:"default",key:ee.key,label:ee.label})},"aria-label":`Remove ${ee.label}`,children:r.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:[r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})}),r.jsxs("div",{className:`cbc-habit-ring-touch ${Oe?"cbc-holding":""} ${ge?"cbc-ring-completed":""}`,onPointerDown:Ue=>{ge||(Ue.preventDefault(),Kt(ee.key))},onPointerUp:Ks,onPointerLeave:Ks,onPointerCancel:Ks,onClick:Ue=>{Ue.stopPropagation(),ge&&st(ee.key)},role:"button",tabIndex:0,"aria-label":ge?`Undo ${ee.label}`:`Press and hold to complete ${ee.label}`,onKeyDown:Ue=>{(Ue.key==="Enter"||Ue.key===" ")&&(Ue.preventDefault(),ge?st(ee.key):it(ee.key))},children:[r.jsxs("svg",{className:"cbc-habit-ring-svg",viewBox:"0 0 100 100",children:[r.jsx("circle",{className:"cbc-habit-ring-track",cx:"50",cy:"50",r:Ig}),r.jsx("circle",{className:"cbc-habit-ring-fill",ref:Ue=>{Ue&&(Fe.current[ee.key]=Ue)},cx:"50",cy:"50",r:Ig,style:{stroke:ee.color,strokeDasharray:Pl,strokeDashoffset:ge?0:Pl}})]}),r.jsxs("div",{className:"cbc-habit-ring-icon",style:{color:ee.color},children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:r.jsx("path",{d:ee.icon})}),(ge||we)&&r.jsx("div",{className:`cbc-habit-check-overlay ${we?"cbc-check-animate":""}`,children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:r.jsx("polyline",{points:"20 6 9 17 4 12"})})})]}),we&&r.jsx("div",{className:"cbc-particles",children:bt.current.map((Ue,$e)=>r.jsx("span",{className:"cbc-particle",style:{"--tx":`${Ue.tx}px`,"--ty":`${Ue.ty}px`,"--size":`${Ue.size}px`,"--particle-color":ee.color,animationDuration:`${Ue.duration}s`}},$e))})]}),r.jsx("span",{className:"cbc-habit-label",children:ee.label}),ge?r.jsx("span",{className:"cbc-habit-done-tag",children:"Done"}):r.jsx("span",{className:"cbc-habit-hold-hint",children:"Hold to complete"})]},ee.key)}),r.jsxs("div",{className:"cbc-habit-tile cbc-add-tile",onClick:()=>M(!0),role:"button",tabIndex:0,children:[r.jsx("div",{className:"cbc-add-ring",children:r.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),r.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})}),r.jsx("span",{className:"cbc-habit-label",children:"Add Habit"}),r.jsx("span",{className:"cbc-habit-hold-hint",children:"Your own"})]})]})]}),r.jsxs("div",{className:"cbc-section anim-fade-up-d4",children:[r.jsx("h2",{className:"cbc-section-title",children:"This Week"}),r.jsx("div",{className:"cbc-week-grid",children:vs.map((ee,ge)=>{const we=ee.dateStr===at,Oe=ee.total>0?ee.completed/ee.total:0,Ue=38,$e=2*Math.PI*Ue,ft=$e-Oe*$e;return r.jsxs("div",{className:`cbc-day-ring ${we?"cbc-day-today":""} ${ee.completed>0?"cbc-day-active":""}`,children:[r.jsxs("svg",{viewBox:"0 0 100 100",children:[r.jsx("circle",{className:"cbc-day-track",cx:"50",cy:"50",r:Ue}),r.jsx("circle",{className:"cbc-day-fill",cx:"50",cy:"50",r:Ue,strokeDasharray:$e,strokeDashoffset:ft})]}),r.jsx("span",{className:"cbc-day-label",children:Gt[ge]}),r.jsxs("span",{className:"cbc-day-count",children:[ee.completed,"/",ee.total]})]},ge)})}),r.jsxs("div",{className:"cbc-week-summary",children:[r.jsx("div",{className:"cbc-week-summary-bar",children:r.jsx("div",{className:"cbc-week-summary-fill",style:{width:`${ue}%`}})}),r.jsxs("span",{className:"cbc-week-summary-text",children:[Bt," / ",As," habits this week (",ue,"%)"]})]})]})]}),r.jsx(aa,{active:"home"}),H&&r.jsx("div",{className:"cbc-modal-overlay",onClick:()=>M(!1),children:r.jsxs("div",{className:"cbc-modal",onClick:ee=>ee.stopPropagation(),children:[r.jsx("h3",{className:"cbc-modal-title",children:"Add Habit"}),r.jsx("p",{className:"cbc-modal-desc",children:"Track something personal to your routine."}),r.jsx("input",{className:"cbc-modal-input",type:"text",placeholder:"e.g. Meditate, Stretch, Read...",value:We,onChange:ee=>gt(ee.target.value),maxLength:30,autoFocus:!0,onKeyDown:ee=>ee.key==="Enter"&&ss()}),r.jsxs("div",{className:"cbc-modal-actions",children:[r.jsx("button",{className:"cbc-modal-cancel",onClick:()=>{M(!1),gt("")},children:"Cancel"}),r.jsx("button",{className:"cbc-modal-save",onClick:ss,disabled:!We.trim(),children:"Add"})]})]})}),$&&r.jsx("div",{className:"cbc-modal-overlay",onClick:()=>me(null),children:r.jsxs("div",{className:"cbc-modal",onClick:ee=>ee.stopPropagation(),children:[r.jsxs("h3",{className:"cbc-modal-title",children:['Remove "',$.label,'"?']}),r.jsx("p",{className:"cbc-modal-desc",children:"This will remove the habit from your daily tracker. Past logs won't be affected."}),r.jsxs("div",{className:"cbc-modal-actions",children:[r.jsx("button",{className:"cbc-modal-cancel",onClick:()=>me(null),children:"Keep"}),r.jsx("button",{className:"cbc-modal-delete",onClick:()=>$.type==="custom"?Ct($.id):Jt($.key),children:"Remove"})]})]})}),Ce&&r.jsxs("div",{className:`cbc-celeb-overlay ${E?"cbc-celeb-dismissing":""}`,onClick:Ps,role:"dialog","aria-modal":"true","aria-label":"All habits complete celebration",children:[r.jsx("div",{className:"cbc-celeb-confetti","aria-hidden":"true",children:kt.current.map((ee,ge)=>r.jsx("span",{className:`cbc-celeb-confetti-piece cbc-confetti-shape-${ee.shape}`,style:{"--x":`${ee.x}%`,"--delay":`${ee.delay}s`,"--color":ee.color,"--drift":`${ee.drift}px`,"--spin":`${ee.spin}deg`,"--duration":`${ee.duration}s`,width:`${ee.width}px`,height:`${ee.height}px`}},ge))}),r.jsxs("div",{className:"cbc-celeb-content",onClick:ee=>ee.stopPropagation(),children:[r.jsx("div",{className:"cbc-celeb-logo-frame",children:r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"cbc-celeb-logo-img"})}),r.jsx("h2",{className:"cbc-celeb-heading",children:"All Habits Complete!"}),r.jsx("p",{className:"cbc-celeb-subtext",children:Wt.current}),r.jsxs("p",{className:"cbc-celeb-stats",children:[Ee,"/",rt.length," habits  Day ",U||1]}),r.jsx("button",{ref:nt,className:"cbc-celeb-btn",onClick:Ps,children:"Keep Going"})]})]}),Y&&r.jsx("div",{className:`toast-notification ${Y.type}`,children:Y.message})]})})}function uh(n){if(!n)return"?";const e=n.trim().split(/\s+/);return e.length===1?e[0][0].toUpperCase():(e[0][0]+e[e.length-1][0]).toUpperCase()}function N2(n,e){return[n,e].sort().join("_")}function XD(){const{currentUser:n,isClient:e,clientData:t,loading:i}=Mr(),{isDark:l,toggleTheme:u}=ka(),d=$n(),[p,g]=v.useState("buddies"),[y,w]=v.useState([]),[j,T]=v.useState([]),[V,W]=v.useState([]),[F,U]=v.useState(""),[ne,Y]=v.useState([]),[oe,be]=v.useState([]),[Le,Ce]=v.useState(!0),[R,E]=v.useState(null),[A,O]=v.useState(null),D=v.useCallback((J,L="info")=>{O({message:J,type:L}),setTimeout(()=>O(null),3500)},[]);v.useEffect(()=>{!i&&(!n||!e)&&d("/")},[n,e,i,d]);const H=v.useCallback(async()=>{if(t){Ce(!0);try{const J=t.id,se=(await Es(zt(pe,"clients"))).docs.map(nt=>({id:nt.id,...nt.data()}));be(se);const Me=Object.fromEntries(se.map(nt=>[nt.id,nt])),De=await Es(Ds(zt(pe,"buddies"),hs("user1","==",J))),Je=await Es(Ds(zt(pe,"buddies"),hs("user2","==",J))),Fe=new Set;[...De.docs,...Je.docs].forEach(nt=>{const Wt=nt.data(),ts=Wt.user1===J?Wt.user2:Wt.user1;Fe.add(ts)}),w(Array.from(Fe).map(nt=>Me[nt]).filter(Boolean));const bt=await Es(Ds(zt(pe,"buddyRequests"),hs("toId","==",J),hs("status","==","pending")));T(bt.docs.map(nt=>({reqId:nt.id,...nt.data(),fromClient:Me[nt.data().fromId]})).filter(nt=>nt.fromClient));const kt=await Es(Ds(zt(pe,"buddyRequests"),hs("fromId","==",J),hs("status","==","pending")));W(kt.docs.map(nt=>({reqId:nt.id,...nt.data(),toClient:Me[nt.data().toId]})).filter(nt=>nt.toClient))}catch(J){console.error("Error fetching buddy data:",J),D("Failed to load buddies","error")}finally{Ce(!1)}}},[t,D]);v.useEffect(()=>{H()},[H]),v.useEffect(()=>{if(!F.trim()||!t){Y([]);return}const J=F.toLowerCase(),L=t.id,se=new Set(y.map(Fe=>Fe.id)),Me=new Set(V.map(Fe=>Fe.toId)),De=new Set(j.map(Fe=>Fe.fromId)),Je=oe.filter(Fe=>Fe.id===L||!Fe.name||!Fe.coreBuddyAccess&&Fe.clientType!=="core_buddy"?!1:Fe.name.toLowerCase().includes(J)).map(Fe=>({...Fe,isBuddy:se.has(Fe.id),isPendingOut:Me.has(Fe.id),isPendingIn:De.has(Fe.id)})).slice(0,20);Y(Je)},[F,oe,y,V,j,t]);const M=async(J,L)=>{if(!(!t||J===t.id))try{await hi(zt(pe,"notifications"),{toId:J,fromId:t.id,fromName:t.name||"Someone",fromPhotoURL:t.photoURL||null,type:L,read:!1,createdAt:Hr()})}catch(se){console.error("Notification error:",se),se.code==="permission-denied"&&D("Notifications blocked  check Firestore rules","error")}},We=async J=>{E(J);try{const L=`${t.id}_${J}`;await Ns(He(pe,"buddyRequests",L),{fromId:t.id,toId:J,status:"pending",createdAt:Hr()}),await M(J,"buddy_request"),D("Buddy request sent!","success"),await H()}catch(L){console.error("Error sending request:",L),D("Failed to send request","error")}finally{E(null)}},gt=async J=>{E(J.reqId);try{const L=N2(J.fromId,t.id);await Ns(He(pe,"buddies",L),{user1:[J.fromId,t.id].sort()[0],user2:[J.fromId,t.id].sort()[1],connectedAt:Hr()}),await yr(He(pe,"buddyRequests",J.reqId)),await M(J.fromId,"buddy_accept"),D("Buddy added!","success"),await H()}catch(L){console.error("Error accepting request:",L),D("Failed to accept","error")}finally{E(null)}},$=async J=>{E(J.reqId);try{await yr(He(pe,"buddyRequests",J.reqId)),D("Request declined","info"),await H()}catch(L){console.error("Error declining:",L),D("Failed to decline","error")}finally{E(null)}},me=async J=>{E(J.reqId);try{await yr(He(pe,"buddyRequests",J.reqId)),D("Request cancelled","info"),await H()}catch(L){console.error("Error cancelling:",L),D("Failed to cancel","error")}finally{E(null)}},Ve=async J=>{E(J);try{const L=N2(t.id,J);await yr(He(pe,"buddies",L)),D("Buddy removed","info"),await H()}catch(L){console.error("Error removing buddy:",L),D("Failed to remove buddy","error")}finally{E(null)}},Ke=j.length;return i?r.jsx("div",{className:"bdy-loading",children:r.jsx("div",{className:"bdy-spinner"})}):!n||!e||!t?null:r.jsx(xa,{children:r.jsxs("div",{className:"bdy-page","data-theme":l?"dark":"light",children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>d("/client/core-buddy"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),r.jsxs("main",{className:"bdy-main",children:[r.jsx("h1",{className:"bdy-title",children:"Buddies"}),r.jsxs("button",{className:"bdy-leaderboard-link",onClick:()=>d("/client/leaderboard"),children:[r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5C7 4 7 7 7 7"}),r.jsx("path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5C17 4 17 7 17 7"}),r.jsx("rect",{x:"6",y:"9",width:"12",height:"13",rx:"2"}),r.jsx("path",{d:"M12 9v13"}),r.jsx("path",{d:"M2 22h20"})]}),r.jsx("span",{children:"Leaderboard"}),r.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})]}),r.jsxs("div",{className:"bdy-tabs",children:[r.jsxs("button",{className:`bdy-tab${p==="buddies"?" active":""}`,onClick:()=>g("buddies"),children:[r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),r.jsx("circle",{cx:"9",cy:"7",r:"4"}),r.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),r.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),r.jsx("span",{children:"My Buddies"})]}),r.jsxs("button",{className:`bdy-tab${p==="requests"?" active":""}`,onClick:()=>g("requests"),children:[r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),r.jsx("circle",{cx:"9",cy:"7",r:"4"}),r.jsx("line",{x1:"19",y1:"8",x2:"19",y2:"14"}),r.jsx("line",{x1:"22",y1:"11",x2:"16",y2:"11"})]}),r.jsx("span",{children:"Requests"}),Ke>0&&r.jsx("span",{className:"bdy-tab-badge",children:Ke})]}),r.jsxs("button",{className:`bdy-tab${p==="search"?" active":""}`,onClick:()=>g("search"),children:[r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("circle",{cx:"11",cy:"11",r:"8"}),r.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),r.jsx("span",{children:"Find"})]})]}),Le?r.jsx("div",{className:"bdy-content-loading",children:r.jsx("div",{className:"bdy-spinner"})}):r.jsxs(r.Fragment,{children:[p==="buddies"&&r.jsx("div",{className:"bdy-section",children:y.length===0?r.jsxs("div",{className:"bdy-empty",children:[r.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),r.jsx("circle",{cx:"9",cy:"7",r:"4"}),r.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),r.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),r.jsx("h3",{children:"No buddies yet"}),r.jsx("p",{children:"Find members and send buddy requests to connect!"}),r.jsx("button",{className:"bdy-empty-btn",onClick:()=>g("search"),children:"Find Buddies"})]}):r.jsx("div",{className:"bdy-list",children:y.map(J=>r.jsxs("div",{className:"bdy-card",onClick:()=>d(`/client/core-buddy/profile/${J.id}`),children:[r.jsx("div",{className:"bdy-avatar",children:J.photoURL?r.jsx("img",{src:J.photoURL,alt:J.name}):r.jsx("span",{children:uh(J.name)})}),r.jsx("div",{className:"bdy-card-info",children:r.jsx("span",{className:"bdy-card-name",children:J.name})}),r.jsx("button",{className:"bdy-remove-btn",onClick:L=>{L.stopPropagation(),Ve(J.id)},disabled:R===J.id,"aria-label":"Remove buddy",children:R===J.id?r.jsx("div",{className:"bdy-btn-spinner"}):r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]},J.id))})}),p==="requests"&&r.jsxs("div",{className:"bdy-section",children:[j.length>0&&r.jsxs(r.Fragment,{children:[r.jsx("h3",{className:"bdy-section-title",children:"Incoming"}),r.jsx("div",{className:"bdy-list",children:j.map(J=>r.jsxs("div",{className:"bdy-card",children:[r.jsx("div",{className:"bdy-avatar",children:J.fromClient.photoURL?r.jsx("img",{src:J.fromClient.photoURL,alt:J.fromClient.name}):r.jsx("span",{children:uh(J.fromClient.name)})}),r.jsxs("div",{className:"bdy-card-info",children:[r.jsx("span",{className:"bdy-card-name",children:J.fromClient.name}),r.jsx("span",{className:"bdy-card-sub",children:"wants to be your buddy"})]}),r.jsxs("div",{className:"bdy-action-pair",children:[r.jsx("button",{className:"bdy-accept-btn",onClick:()=>gt(J),disabled:R===J.reqId,children:R===J.reqId?r.jsx("div",{className:"bdy-btn-spinner"}):r.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:r.jsx("path",{d:"M5 13l4 4L19 7"})})}),r.jsx("button",{className:"bdy-decline-btn",onClick:()=>$(J),disabled:R===J.reqId,children:r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]})]},J.reqId))})]}),V.length>0&&r.jsxs(r.Fragment,{children:[r.jsx("h3",{className:"bdy-section-title",children:"Sent"}),r.jsx("div",{className:"bdy-list",children:V.map(J=>r.jsxs("div",{className:"bdy-card",children:[r.jsx("div",{className:"bdy-avatar",children:J.toClient?.photoURL?r.jsx("img",{src:J.toClient.photoURL,alt:J.toClient.name}):r.jsx("span",{children:uh(J.toClient?.name)})}),r.jsxs("div",{className:"bdy-card-info",children:[r.jsx("span",{className:"bdy-card-name",children:J.toClient?.name}),r.jsx("span",{className:"bdy-card-sub",children:"pending"})]}),r.jsx("button",{className:"bdy-cancel-btn",onClick:()=>me(J),disabled:R===J.reqId,children:R===J.reqId?r.jsx("div",{className:"bdy-btn-spinner"}):"Cancel"})]},J.reqId))})]}),j.length===0&&V.length===0&&r.jsxs("div",{className:"bdy-empty",children:[r.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[r.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),r.jsx("path",{d:"M22 4L12 14.01l-3-3"})]}),r.jsx("h3",{children:"No pending requests"}),r.jsx("p",{children:"All caught up!"})]})]}),p==="search"&&r.jsxs("div",{className:"bdy-section",children:[r.jsxs("div",{className:"bdy-search-bar",children:[r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("circle",{cx:"11",cy:"11",r:"8"}),r.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),r.jsx("input",{type:"text",placeholder:"Search by name...",value:F,onChange:J=>U(J.target.value),autoFocus:!0}),F&&r.jsx("button",{className:"bdy-search-clear",onClick:()=>U(""),children:r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),F.trim()&&ne.length===0&&r.jsx("div",{className:"bdy-empty bdy-empty-sm",children:r.jsxs("p",{children:['No members found for "',F,'"']})}),ne.length>0&&r.jsx("div",{className:"bdy-list",children:ne.map(J=>r.jsxs("div",{className:"bdy-card",onClick:()=>d(`/client/core-buddy/profile/${J.id}`),children:[r.jsx("div",{className:"bdy-avatar",children:J.photoURL?r.jsx("img",{src:J.photoURL,alt:J.name}):r.jsx("span",{children:uh(J.name)})}),r.jsxs("div",{className:"bdy-card-info",children:[r.jsx("span",{className:"bdy-card-name",children:J.name}),J.isBuddy&&r.jsx("span",{className:"bdy-card-badge",children:"Buddy"})]}),J.isBuddy?r.jsx("span",{className:"bdy-status-icon",children:r.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"var(--color-success)",strokeWidth:"2.5",children:r.jsx("path",{d:"M5 13l4 4L19 7"})})}):J.isPendingOut?r.jsx("span",{className:"bdy-pending-label",children:"Pending"}):J.isPendingIn?r.jsx("button",{className:"bdy-accept-btn",onClick:L=>{L.stopPropagation();const se=j.find(Me=>Me.fromId===J.id);se&&gt(se)},disabled:!!R,children:r.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:r.jsx("path",{d:"M5 13l4 4L19 7"})})}):r.jsx("button",{className:"bdy-add-btn",onClick:L=>{L.stopPropagation(),We(J.id)},disabled:R===J.id,children:R===J.id?r.jsx("div",{className:"bdy-btn-spinner"}):r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),r.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})})]},J.id))})]})]})]}),r.jsx(aa,{}),A&&r.jsxs("div",{className:`toast-notification ${A.type}`,children:[r.jsx("span",{className:"toast-icon",children:A.type==="success"?r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M5 13 L9 17 L19 7"})}):A.type==="error"?r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]}):r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),r.jsx("circle",{cx:"12",cy:"16",r:"1",fill:"currentColor"})]})}),r.jsx("span",{className:"toast-message",children:A.message})]})]})})}function dh(n){if(!n)return"?";const e=n.trim().split(/\s+/);return e.length===1?e[0][0].toUpperCase():(e[0][0]+e[e.length-1][0]).toUpperCase()}function Jp(n,e){return[n,e].sort().join("_")}const JD=5;function Zp(n){return n.toISOString().split("T")[0]}function ZD(n){return n>=1e6?`${(n/1e6).toFixed(1)}M`:n>=1e3?`${(n/1e3).toFixed(1)}T`:`${Math.round(n)}`}const eP={fullbody_4wk:{duration:4,daysPerWeek:3},fullbody_8wk:{duration:8,daysPerWeek:3},fullbody_12wk:{duration:12,daysPerWeek:3},core_4wk:{duration:4,daysPerWeek:3},core_8wk:{duration:8,daysPerWeek:3},core_12wk:{duration:12,daysPerWeek:3},upper_4wk:{duration:4,daysPerWeek:3},lower_4wk:{duration:4,daysPerWeek:3}};function S2(n){if(!n)return"";const e=n instanceof Date?n:n.toDate?n.toDate():new Date(n),t=Math.floor((new Date-e)/1e3);return t<60?"just now":t<3600?`${Math.floor(t/60)}m ago`:t<86400?`${Math.floor(t/3600)}h ago`:t<604800?`${Math.floor(t/86400)}d ago`:e.toLocaleDateString("en-GB",{day:"numeric",month:"short"})}function tP(){const{userId:n}=uE(),{currentUser:e,isClient:t,clientData:i,loading:l}=Mr(),{isDark:u,toggleTheme:d}=ka(),p=$n(),[g,y]=v.useState(null),[w,j]=v.useState("none"),[T,V]=v.useState(null),[W,F]=v.useState(!0),[U,ne]=v.useState(!1),[Y,oe]=v.useState(null),[be,Le]=v.useState([]),[Ce,R]=v.useState(!1),[E,A]=v.useState(new Set),[O,D]=v.useState(new Set),[H,M]=v.useState({}),[We,gt]=v.useState({}),[$,me]=v.useState({}),[Ve,Ke]=v.useState(!0),[J,L]=v.useState(0),[se,Me]=v.useState(0),[De,Je]=v.useState(0),[Fe,bt]=v.useState(0),[kt,nt]=v.useState([]),[Wt,ts]=v.useState([]),[St,at]=v.useState(null),[ce,Xt]=v.useState(null),[Gt,rt]=v.useState(0),[pt,it]=v.useState([]),[st,Kt]=v.useState(!1),[Ks,Ps]=v.useState(null),[ss,Ct]=v.useState([]),Jt=v.useCallback((Q,fe="info")=>{oe({message:Q,type:fe}),setTimeout(()=>oe(null),3500)},[]);v.useEffect(()=>{!l&&(!e||!t)&&p("/")},[e,t,l,p]),v.useEffect(()=>{i&&n&&i.id===n&&p("/client/core-buddy",{replace:!0})},[i,n,p]),v.useEffect(()=>{if(!i||!n||i.id===n)return;let Q=!1;return(async()=>{F(!0);try{const At=(await Es(zt(pe,"clients"))).docs.map(Ot=>({id:Ot.id,...Ot.data()})).find(Ot=>Ot.id===n);if(!At){Q||F(!1);return}Q||y(At);const Tt=i.id,ns=Jp(Tt,n);if((await Rs(He(pe,"buddies",ns))).exists())Q||j("buddy");else{const Ot=`${Tt}_${n}`,Ls=await Rs(He(pe,"buddyRequests",Ot));if(Ls.exists()&&Ls.data().status==="pending")Q||(j("pending_out"),V(Ot));else{const Js=`${n}_${Tt}`,os=await Rs(He(pe,"buddyRequests",Js));os.exists()&&os.data().status==="pending"?Q||(j("pending_in"),V(Js)):Q||j("none")}}}catch(fe){console.error("Error loading profile:",fe)}finally{Q||F(!1)}})(),()=>{Q=!0}},[i,n]),v.useEffect(()=>{if(!n||!g)return;let Q=!1;return(async()=>{Ke(!0);try{const[fe,lt,At,Tt]=await Promise.all([Es(Ds(zt(pe,"workoutLogs"),hs("clientId","==",n))),Rs(He(pe,"coreBuddyAchievements",n)),Rs(He(pe,"coreBuddyPBs",n)),Rs(He(pe,"clientProgrammes",n))]);if(Q)return;const ns=fe.docs.length;L(ns),lt.exists()&&Me(lt.data().totalVolume||0);let Ut=0;const Ot=fe.docs.map(os=>os.data().date).filter(Boolean).sort().reverse();if(Ot.length>0){const os=new Date;let Ss=new Date(os);for(let Os=0;Os<52;Os++){const q=new Date(Ss),xe=q.getDay(),je=xe===0?6:xe-1;q.setDate(q.getDate()-je),q.setHours(0,0,0,0);const Te=new Date(q);Te.setDate(Te.getDate()+7);const _e=Zp(q),ct=Zp(Te);if(Ot.some(et=>et>=_e&&et<ct))Ut++;else{if(Os>0)break;break}Ss.setDate(Ss.getDate()-7)}}if(Q||Je(Ut),At.exists()){const os=At.data().exercises||{},Ss=Object.entries(os).sort(([,Os],[,q])=>(q.weight||0)-(Os.weight||0)).slice(0,3).map(([Os,q])=>({name:Os,weight:q.weight,reps:q.reps}));Q||nt(Ss)}if(Tt.exists()){const os=Tt.data(),Ss=eP[os.templateId];if(Ss){const Os=Object.keys(os.completedSessions||{}).length,q=Ss.duration*Ss.daysPerWeek;Q||(Xt(os.templateId.replace(/_/g," ").replace(/\b\w/g,xe=>xe.toUpperCase())),rt(q>0?Math.round(Os/q*100):0))}}const Ls=await Rs(He(pe,"achievements",n));if(!Q&&Ls.exists()){const os=Ls.data().badges||{};ts(Object.keys(os))}let Js=0;for(let os=0;os<30;os++){const Ss=new Date;Ss.setDate(Ss.getDate()-os);const Os=Zp(Ss);try{const q=await Es(Ds(zt(pe,"habitLogs"),hs("clientId","==",n),hs("date","==",Os)));if(q.empty)break;{const xe=q.docs[0].data().habits||{};if(Object.values(xe).filter(Boolean).length>=JD)Js++;else break}}catch{break}}Q||bt(Js)}catch(fe){console.error("Error loading buddy stats:",fe)}finally{Q||Ke(!1)}})(),()=>{Q=!0}},[n,g]),v.useEffect(()=>{if(!i)return;const Q=i.id;(async()=>{try{const[fe,lt,At]=await Promise.all([Es(Ds(zt(pe,"buddies"),hs("user1","==",Q))),Es(Ds(zt(pe,"buddies"),hs("user2","==",Q))),Es(zt(pe,"clients"))]),Tt=new Set;[...fe.docs,...lt.docs].forEach(Ut=>{const Ot=Ut.data();Tt.add(Ot.user1===Q?Ot.user2:Ot.user1)});const ns={};At.docs.forEach(Ut=>{ns[Ut.id]=Ut.data()}),it(Array.from(Tt).filter(Ut=>ns[Ut]).map(Ut=>({id:Ut,name:ns[Ut].name,photoURL:ns[Ut].photoURL||null})))}catch(fe){console.error("Error loading buddies for mentions:",fe)}})()},[i]);const vs=async(Q,fe,lt={})=>{if(!(!i||Q===i.id))try{await hi(zt(pe,"notifications"),{toId:Q,fromId:i.id,fromName:i.name||"Someone",fromPhotoURL:i.photoURL||null,type:fe,read:!1,createdAt:Hr(),...lt})}catch(At){console.error("Notification error:",At),At.code==="permission-denied"&&Jt("Notifications blocked  check Firestore rules","error")}},Bt=async()=>{ne(!0);try{const Q=`${i.id}_${n}`;await Ns(He(pe,"buddyRequests",Q),{fromId:i.id,toId:n,status:"pending",createdAt:Hr()}),await vs(n,"buddy_request"),j("pending_out"),V(Q),Jt("Buddy request sent!","success")}catch(Q){console.error(Q),Jt("Failed to send request","error")}finally{ne(!1)}},As=async()=>{if(T){ne(!0);try{const Q=Jp(i.id,n);await Ns(He(pe,"buddies",Q),{user1:[i.id,n].sort()[0],user2:[i.id,n].sort()[1],connectedAt:Hr()}),await yr(He(pe,"buddyRequests",T)),await vs(n,"buddy_accept"),j("buddy"),Jt("Buddy added!","success")}catch(Q){console.error(Q),Jt("Failed to accept","error")}finally{ne(!1)}}},ue=async()=>{if(T){ne(!0);try{await yr(He(pe,"buddyRequests",T)),j("none"),Jt(w==="pending_out"?"Request cancelled":"Request declined","info")}catch(Q){console.error(Q),Jt("Failed","error")}finally{ne(!1)}}},Ee=async()=>{ne(!0);try{const Q=Jp(i.id,n);await yr(He(pe,"buddies",Q)),j("none"),Jt("Buddy removed","info")}catch(Q){console.error(Q),Jt("Failed to remove","error")}finally{ne(!1)}},Ae=v.useCallback(async()=>{if(n){R(!0);try{const Q=await Es(Ds(zt(pe,"posts"),hs("authorId","==",n),Gh("createdAt","desc"),Kh(30)));if(Le(Q.docs.map(fe=>({id:fe.id,...fe.data()}))),i){const fe=await Es(Ds(zt(pe,"postLikes"),hs("userId","==",i.id)));A(new Set(fe.docs.map(lt=>lt.data().postId)))}}catch(Q){console.error("Error loading journey:",Q)}finally{R(!1)}}},[n,i]);v.useEffect(()=>{!W&&g&&Ae()},[W,g,Ae]);const ee=async Q=>{if(window.confirm("Delete this post?"))try{await yr(He(pe,"posts",Q)),Le(fe=>fe.filter(lt=>lt.id!==Q)),Jt("Post deleted","info")}catch(fe){console.error("Delete error:",fe),Jt("Failed to delete","error")}},ge=async Q=>{if(!i)return;const fe=i.id,lt=`${Q}_${fe}`,At=E.has(Q),Tt=new Set(E);At?Tt.delete(Q):Tt.add(Q),A(Tt),Le(ns=>ns.map(Ut=>Ut.id===Q?{...Ut,likeCount:Math.max(0,(Ut.likeCount||0)+(At?-1:1))}:Ut));try{if(At)await yr(He(pe,"postLikes",lt)),await Ma(He(pe,"posts",Q),{likeCount:Bo(-1)});else{await Ns(He(pe,"postLikes",lt),{postId:Q,userId:fe,createdAt:Hr()}),await Ma(He(pe,"posts",Q),{likeCount:Bo(1)});const ns=be.find(Ut=>Ut.id===Q);ns&&vs(ns.authorId,"like",{postId:Q})}}catch(ns){console.error("Like error:",ns),Ae()}},we=async Q=>{try{const fe=await Es(Ds(zt(pe,"postComments"),hs("postId","==",Q),Gh("createdAt","asc"),Kh(50)));M(lt=>({...lt,[Q]:fe.docs.map(At=>({id:At.id,...At.data()}))}))}catch(fe){console.error("Error loading comments:",fe)}},Oe=Q=>{const fe=new Set(O);fe.has(Q)?fe.delete(Q):(fe.add(Q),H[Q]||we(Q)),D(fe)},Ue=(Q,fe)=>{const lt=Q.match(/@(\w*)$/);if(lt){Kt(!0),Ps(fe);const At=pt.filter(Tt=>Tt.name&&Tt.name.toLowerCase().includes(lt[1].toLowerCase())).slice(0,5);Ct(At)}else Kt(!1),Ct([])},$e=(Q,fe)=>{const At=(We[fe]||"").replace(/@\w*$/,`@${Q.name} `);gt(Tt=>({...Tt,[fe]:At})),Kt(!1),Ct([])},ft=(Q,fe)=>{gt(lt=>({...lt,[Q]:fe})),Ue(fe,Q)},jt=async Q=>{const fe=(We[Q]||"").trim();if(!(!fe||!i)){me(lt=>({...lt,[Q]:!0}));try{await hi(zt(pe,"postComments"),{postId:Q,authorId:i.id,authorName:i.name||"Unknown",authorPhotoURL:i.photoURL||null,content:fe,createdAt:Hr()}),await Ma(He(pe,"posts",Q),{commentCount:Bo(1)});const lt=be.find(Tt=>Tt.id===Q);lt&&vs(lt.authorId,"comment",{postId:Q});const At=fe.match(/@[\w\s]+?(?=\s@|\s*$|[.,!?])/g);if(At){const Tt=new Set;At.forEach(ns=>{const Ut=ns.slice(1).trim(),Ot=pt.find(Ls=>Ls.name&&Ls.name.toLowerCase()===Ut.toLowerCase());Ot&&!Tt.has(Ot.id)&&(Tt.add(Ot.id),vs(Ot.id,"mention",{postId:Q}))})}gt(Tt=>({...Tt,[Q]:""})),Le(Tt=>Tt.map(ns=>ns.id===Q?{...ns,commentCount:(ns.commentCount||0)+1}:ns)),await we(Q)}catch(lt){console.error("Comment error:",lt),Jt("Failed to comment","error")}finally{me(lt=>({...lt,[Q]:!1}))}}};return l||W||!i?r.jsx("div",{className:"prf-loading","data-theme":u?"dark":"light",children:r.jsx("div",{className:"prf-spinner"})}):!e||!t?null:g?r.jsx(xa,{children:r.jsxs("div",{className:"prf-page","data-theme":u?"dark":"light",children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>p(-1),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:d,"aria-label":"Toggle theme",children:u?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),r.jsxs("main",{className:"prf-main",children:[r.jsxs("div",{className:"prf-hero",children:[r.jsx("div",{className:"prf-avatar-lg",children:g.photoURL?r.jsx("img",{src:g.photoURL,alt:g.name}):r.jsx("span",{children:dh(g.name)})}),r.jsx("h1",{className:"prf-name",children:g.name}),r.jsxs("div",{className:"prf-buddy-action",children:[w==="none"&&r.jsx("button",{className:"prf-btn prf-btn-primary",onClick:Bt,disabled:U,children:U?r.jsx("div",{className:"prf-btn-spinner"}):r.jsxs(r.Fragment,{children:[r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),r.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),"Add Buddy"]})}),w==="pending_out"&&r.jsx("button",{className:"prf-btn prf-btn-secondary",onClick:ue,disabled:U,children:U?r.jsx("div",{className:"prf-btn-spinner dark"}):"Cancel Request"}),w==="pending_in"&&r.jsxs("div",{className:"prf-btn-pair",children:[r.jsx("button",{className:"prf-btn prf-btn-success",onClick:As,disabled:U,children:U?r.jsx("div",{className:"prf-btn-spinner"}):"Accept"}),r.jsx("button",{className:"prf-btn prf-btn-secondary",onClick:ue,disabled:U,children:"Decline"})]}),w==="buddy"&&r.jsx("button",{className:"prf-btn prf-btn-danger",onClick:Ee,disabled:U,children:U?r.jsx("div",{className:"prf-btn-spinner"}):"Remove Buddy"})]})]}),Ve?r.jsx("div",{className:"prf-stats-loading",children:r.jsx("div",{className:"prf-spinner"})}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"prf-stats",children:[r.jsxs("div",{className:"prf-stat",children:[r.jsx("span",{className:"prf-stat-value",children:J}),r.jsx("span",{className:"prf-stat-label",children:"Workouts"})]}),r.jsxs("div",{className:"prf-stat",children:[r.jsxs("span",{className:"prf-stat-value",children:[ZD(se),r.jsx("span",{className:"prf-stat-unit",children:se>=1e3?"":"kg"})]}),r.jsxs("span",{className:"prf-stat-label",children:[se>=1e6?"Million kg":se>=1e3?"Tonnes":"Volume"," Lifted"]})]}),r.jsxs("div",{className:"prf-stat",children:[r.jsxs("span",{className:"prf-stat-value",children:[De,r.jsx("span",{className:"prf-stat-unit",children:"wk"})]}),r.jsx("span",{className:"prf-stat-label",children:"Streak"})]})]}),(ce||Fe>0)&&r.jsxs("div",{className:"prf-info-row",children:[ce&&r.jsxs("div",{className:"prf-info-card info-programme",children:[r.jsx("div",{className:"prf-info-icon",children:r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M4 19.5A2.5 2.5 0 0 1 6.5 17H20"}),r.jsx("path",{d:"M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"})]})}),r.jsxs("div",{className:"prf-info-text",children:[r.jsx("span",{className:"prf-info-label",children:ce}),r.jsx("div",{className:"prf-info-progress-bar",children:r.jsx("div",{className:"prf-info-progress-fill",style:{width:`${Math.min(Gt,100)}%`}})}),r.jsxs("span",{className:"prf-info-sub",children:[Gt,"% complete"]})]})]}),Fe>0&&r.jsxs("div",{className:"prf-info-card info-habit",children:[r.jsx("div",{className:"prf-info-icon",children:r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),r.jsx("path",{d:"M22 4L12 14.01l-3-3"})]})}),r.jsxs("div",{className:"prf-info-text",children:[r.jsxs("span",{className:"prf-info-value",children:[Fe," day",Fe!==1?"s":""]}),r.jsx("span",{className:"prf-info-sub",children:"Habit Streak"})]})]})]}),kt.length>0&&r.jsxs("div",{className:"prf-section",children:[r.jsx("h2",{className:"prf-section-title",children:"Top Lifts"}),r.jsx("div",{className:"prf-pb-list",children:kt.map((Q,fe)=>r.jsxs("div",{className:"prf-pb-item",children:[r.jsx("div",{className:"prf-pb-rank",children:fe===0?r.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",stroke:"none",children:r.jsx("path",{d:"M12 2l2.4 7.4H22l-6 4.4 2.3 7.2L12 16.6 5.7 21l2.3-7.2-6-4.4h7.6z"})}):`#${fe+1}`}),r.jsx("span",{className:"prf-pb-name",children:Q.name}),r.jsxs("span",{className:"prf-pb-weight",children:[Q.weight,r.jsx("span",{className:"prf-pb-unit",children:"kg"})," x",Q.reps]})]},fe))})]}),Wt.length>0&&r.jsxs("div",{className:"prf-section",children:[r.jsxs("h2",{className:"prf-section-title",children:["Badges Earned (",Wt.length,")"]}),r.jsx("div",{className:"prf-badge-row",children:Wt.map(Q=>{const fe=mu.find(lt=>lt.id===Q);return fe?r.jsx("button",{className:"prf-badge-chip",onClick:()=>at(fe),children:r.jsx("img",{src:fe.img,alt:fe.name,className:"prf-badge-chip-img"})},Q):null})})]}),St&&r.jsx("div",{className:"prf-badge-overlay",onClick:()=>at(null),children:r.jsxs("div",{className:"prf-badge-overlay-content",onClick:Q=>Q.stopPropagation(),children:[r.jsx("img",{src:St.img,alt:St.name,className:"prf-badge-overlay-img"}),r.jsx("p",{className:"prf-badge-overlay-desc",children:St.desc}),r.jsx("button",{className:"prf-badge-overlay-close",onClick:()=>at(null),children:"Tap to close"})]})})]}),r.jsxs("div",{className:"prf-section",children:[r.jsx("h2",{className:"prf-section-title",children:`${g.name?.split(" ")[0]}'s Journey`}),Ce?r.jsx("div",{className:"journey-loading",children:r.jsx("div",{className:"prf-spinner"})}):be.length===0?r.jsxs("div",{className:"journey-empty",children:[r.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),r.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),r.jsx("path",{d:"M21 15l-5-5L5 21"})]}),r.jsx("p",{children:"No posts yet"})]}):r.jsx("div",{className:"journey-list",children:be.map(Q=>r.jsxs("div",{className:"journey-post",children:[r.jsxs("div",{className:"journey-post-header",children:[r.jsx("div",{className:"journey-post-avatar",children:Q.authorPhotoURL?r.jsx("img",{src:Q.authorPhotoURL,alt:""}):r.jsx("span",{children:dh(Q.authorName)})}),r.jsxs("div",{className:"journey-post-meta",children:[r.jsx("span",{className:"journey-post-name",children:Q.authorName}),r.jsx("span",{className:"journey-post-time",children:S2(Q.createdAt)})]}),Q.authorId===i.id&&r.jsx("button",{className:"journey-delete-btn",onClick:()=>ee(Q.id),"aria-label":"Delete post",children:r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M3 6h18"}),r.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),r.jsx("path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]}),Q.content&&r.jsx("p",{className:"journey-post-content",children:Q.content}),Q.imageURL&&r.jsx("div",{className:"journey-post-image",children:r.jsx("img",{src:Q.imageURL,alt:"Post",loading:"lazy"})}),r.jsxs("div",{className:"journey-post-actions",children:[r.jsxs("button",{className:`journey-action-btn${E.has(Q.id)?" liked":""}`,onClick:()=>ge(Q.id),children:[r.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:E.has(Q.id)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})}),r.jsx("span",{children:Q.likeCount||0})]}),r.jsxs("button",{className:`journey-action-btn${O.has(Q.id)?" active":""}`,onClick:()=>Oe(Q.id),children:[r.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})}),r.jsx("span",{children:Q.commentCount||0})]})]}),O.has(Q.id)&&r.jsxs("div",{className:"journey-comments",children:[H[Q.id]?.length>0?H[Q.id].map(fe=>r.jsxs("div",{className:"journey-comment",children:[r.jsx("div",{className:"journey-comment-avatar",onClick:()=>p(`/client/core-buddy/profile/${fe.authorId}`),children:fe.authorPhotoURL?r.jsx("img",{src:fe.authorPhotoURL,alt:""}):r.jsx("span",{children:dh(fe.authorName)})}),r.jsxs("div",{className:"journey-comment-body",children:[r.jsxs("div",{className:"journey-comment-bubble",children:[r.jsx("span",{className:"journey-comment-name",children:fe.authorName}),r.jsx("span",{className:"journey-comment-text",children:fe.content})]}),r.jsx("span",{className:"journey-comment-time",children:S2(fe.createdAt)})]})]},fe.id)):r.jsx("p",{className:"journey-no-comments",children:"No comments yet"}),r.jsxs("div",{className:"journey-comment-input",style:{position:"relative"},children:[r.jsx("input",{type:"text",placeholder:"Comment... (@ to mention)",value:We[Q.id]||"",onChange:fe=>ft(Q.id,fe.target.value),onKeyDown:fe=>{fe.key==="Enter"&&jt(Q.id)},maxLength:300}),st&&Ks===Q.id&&ss.length>0&&r.jsx("div",{className:"mention-dropdown mention-dropdown-up",children:ss.map(fe=>r.jsxs("button",{className:"mention-option",onClick:()=>$e(fe,Q.id),children:[r.jsx("div",{className:"mention-option-avatar",children:fe.photoURL?r.jsx("img",{src:fe.photoURL,alt:""}):r.jsx("span",{children:dh(fe.name)})}),r.jsx("span",{children:fe.name})]},fe.id))}),r.jsx("button",{onClick:()=>jt(Q.id),disabled:!(We[Q.id]||"").trim()||$[Q.id],children:$[Q.id]?r.jsx("div",{className:"journey-btn-spinner-sm"}):r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"22",y1:"2",x2:"11",y2:"13"}),r.jsx("polygon",{points:"22 2 15 22 11 13 2 9 22 2"})]})})]})]})]},Q.id))})]})]}),r.jsx(aa,{}),Y&&r.jsxs("div",{className:`toast-notification ${Y.type}`,children:[r.jsx("span",{className:"toast-icon",children:Y.type==="success"?r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M5 13 L9 17 L19 7"})}):Y.type==="error"?r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]}):r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),r.jsx("circle",{cx:"12",cy:"16",r:"1",fill:"currentColor"})]})}),r.jsx("span",{className:"toast-message",children:Y.message})]})]})}):r.jsxs("div",{className:"prf-page","data-theme":u?"dark":"light",children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>p(-1),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions"})]})}),r.jsx("main",{className:"prf-main",children:r.jsx("p",{style:{textAlign:"center",color:"var(--text-tertiary)",padding:"40px 0"},children:"User not found"})}),r.jsx(aa,{})]})}function sP(){const n=$n(),{clientData:e,currentUser:t,resolveClient:i,updateClientData:l}=Mr(),[u,d]=v.useState([]),[p,g]=v.useState(""),[y,w]=v.useState(!1),[j,T]=v.useState(null),[V,W]=v.useState(!1),[F,U]=v.useState(null),ne=v.useRef(null),Y=v.useRef(null);if(!e?.buddyEnabled)return r.jsxs("div",{className:"buddy-page",children:[r.jsxs("div",{className:"buddy-container",children:[r.jsx("p",{children:"Buddy is not enabled on your account."}),r.jsx("button",{onClick:()=>n("/client/core-buddy"),children:"Back to Dashboard"})]}),r.jsx(aa,{active:"home"})]});v.useEffect(()=>{ne.current&&ne.current.scrollIntoView({behavior:"smooth"})},[u,y]),v.useEffect(()=>{u.length===0&&!y&&oe([])},[]);const oe=async E=>{w(!0),T(null);try{const O=await(await fetch("/api/buddy-onboarding",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({messages:E,clientName:e?.name||t?.displayName||"there"})})).json();if(O.error){T(O.error);return}const D={role:"assistant",content:O.reply};d(H=>[...H,D]),O.profileData&&(await R(O.profileData),U(O.profileData),W(!0))}catch(A){console.error("Buddy chat error:",A),T("Something went wrong  try sending again.")}finally{w(!1)}},be=()=>{const E=p.trim();if(!E||y)return;const A={role:"user",content:E},O=[...u,A];d(O),g(""),Y.current&&Y.current.focus(),oe(O)},Le=E=>{E.key==="Enter"&&!E.shiftKey&&(E.preventDefault(),be())},Ce=E=>{const A=E?.experience||"beginner";return A==="advanced"?{id:"fullbody_12wk",name:"12-Week Full Body",duration:12,level:"Advanced",daysPerWeek:3,description:"Complete transformation programme  push, pull, and legs over three phases."}:A==="intermediate"?{id:"fullbody_8wk",name:"8-Week Full Body",duration:8,level:"Intermediate",daysPerWeek:3,description:"Two-phase programme building strength and endurance across your full body."}:{id:"fullbody_4wk",name:"4-Week Full Body",duration:4,level:"All Levels",daysPerWeek:3,description:"Build total body strength with compound dumbbell movements and bodyweight finishers."}},R=async E=>{try{const A=await i();if(!A)return;await Ns(He(pe,"onboardingSubmissions",A.id),{clientId:A.id,clientName:A.name,email:A.email,source:"buddy_chat",welcome:{dob:E.dob||null,gender:E.gender||null,goals:E.goals||[],experience:E.experience||null,injuries:E.injuries||null,activityLevel:E.activityLevel||null,exerciseHistory:E.exerciseHistory||null,sleepHours:E.sleepHours||null,stressLevel:E.stressLevel||null,dietaryInfo:E.dietaryInfo||null,availability:E.availability||null,additionalInfo:E.additionalInfo||null},submittedAt:Hr()});const O=E.goals||[];await Ma(He(pe,"clients",A.id),{fitnessGoal:O[0]||null,fitnessGoals:O,experienceLevel:E.experience||null,dob:E.dob||null,injuries:E.injuries||null}),l({fitnessGoal:O[0]||null,fitnessGoals:O,experienceLevel:E.experience,dob:E.dob})}catch(A){console.error("Save profile error:",A)}};return r.jsx(xa,{children:r.jsxs("div",{className:"buddy-page buddy-page--chat",children:[r.jsxs("div",{className:"buddy-chat-container",children:[r.jsxs("div",{className:"buddy-chat-top",children:[r.jsx("button",{className:"buddy-back",onClick:()=>n("/client/core-buddy"),children:r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsxs("div",{className:"buddy-chat-header",children:[r.jsx("div",{className:"buddy-chat-avatar",children:r.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M12 2a4 4 0 0 1 4 4v2a4 4 0 0 1-8 0V6a4 4 0 0 1 4-4z"}),r.jsx("path",{d:"M18 14c2 1 3 3 3 5v2H3v-2c0-2 1-4 3-5"}),r.jsx("circle",{cx:"9",cy:"7",r:"0.5",fill:"currentColor"}),r.jsx("circle",{cx:"15",cy:"7",r:"0.5",fill:"currentColor"}),r.jsx("path",{d:"M9.5 10a2.5 2.5 0 0 0 5 0"})]})}),r.jsxs("div",{children:[r.jsx("h2",{className:"buddy-chat-name",children:"Buddy"}),r.jsx("span",{className:"buddy-chat-status",children:y?"typing...":"Your AI Coach"})]})]})]}),r.jsxs("div",{className:"buddy-chat-messages",children:[u.map((E,A)=>r.jsxs("div",{className:`buddy-chat-bubble buddy-chat-${E.role}`,children:[E.role==="assistant"&&r.jsx("div",{className:"buddy-chat-bubble-avatar",children:"B"}),r.jsx("div",{className:"buddy-chat-bubble-content",children:E.content})]},A)),y&&r.jsxs("div",{className:"buddy-chat-bubble buddy-chat-assistant",children:[r.jsx("div",{className:"buddy-chat-bubble-avatar",children:"B"}),r.jsxs("div",{className:"buddy-chat-bubble-content buddy-chat-typing",children:[r.jsx("span",{}),r.jsx("span",{}),r.jsx("span",{})]})]}),j&&r.jsxs("div",{className:"buddy-chat-error",children:[j,r.jsx("button",{onClick:()=>oe(u),children:"Retry"})]}),r.jsx("div",{ref:ne})]}),V?r.jsx("div",{className:"buddy-chat-done",children:F?(()=>{const E=Ce(F);return r.jsxs(r.Fragment,{children:[r.jsx("p",{className:"buddy-chat-done-text",children:"Profile saved! Here's my pick for you:"}),r.jsxs("div",{className:"buddy-rec-card",onClick:()=>n("/client/core-buddy/programmes",{state:{templateId:E.id}}),children:[r.jsx("div",{className:"buddy-rec-name",children:E.name}),r.jsxs("div",{className:"buddy-rec-meta",children:[E.duration," weeks  ",E.daysPerWeek," days/week  ",E.level]}),r.jsx("div",{className:"buddy-rec-desc",children:E.description}),r.jsx("div",{className:"buddy-rec-cta",children:"View Programme"})]}),r.jsx("button",{className:"buddy-chat-skip-btn",onClick:()=>n("/client/core-buddy"),children:"Maybe later"})]})})():r.jsxs(r.Fragment,{children:[r.jsx("p",{className:"buddy-chat-done-text",children:"Profile saved  you're all set."}),r.jsx("button",{className:"buddy-chat-done-btn",onClick:()=>n("/client/core-buddy"),children:"Back to Dashboard"})]})}):r.jsxs("div",{className:"buddy-chat-input-wrap",children:[r.jsx("textarea",{ref:Y,className:"buddy-chat-input",placeholder:"Type your message...",value:p,onChange:E=>g(E.target.value),onKeyDown:Le,rows:1,disabled:y}),r.jsx("button",{className:"buddy-chat-send",onClick:be,disabled:!p.trim()||y,"aria-label":"Send message",children:r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("line",{x1:"22",y1:"2",x2:"11",y2:"13"}),r.jsx("polygon",{points:"22 2 15 22 11 13 2 9 22 2"})]})})]})]}),r.jsx(aa,{active:"home"})]})})}const ma=[{key:"pressUps",name:"Press-Ups",category:"Upper Body",unit:"reps"},{key:"squats",name:"Squats",category:"Lower Body",unit:"reps"},{key:"longJump",name:"Standing Long Jump",category:"Power",unit:"distance"},{key:"deadHang",name:"Dead Hang",category:"Upper Body",unit:"time"},{key:"plank",name:"Plank",category:"Core",unit:"time"},{key:"wallSit",name:"Wall Sit",category:"Lower Body",unit:"time"},{key:"chestPress",name:"Chest Press",category:"Upper Body",unit:"weight"}],Po=[{key:"weight",name:"Weight",suffix:"kg"},{key:"chest",name:"Chest",suffix:"cm"},{key:"waist",name:"Waist",suffix:"cm"},{key:"hips",name:"Hips",suffix:"cm"},{key:"leftArm",name:"Left Arm",suffix:"cm"},{key:"rightArm",name:"Right Arm",suffix:"cm"},{key:"leftThigh",name:"Left Thigh",suffix:"cm"},{key:"rightThigh",name:"Right Thigh",suffix:"cm"}];function nP(){const n=new Date;return`${n.getFullYear()}-${String(n.getMonth()+1).padStart(2,"0")}`}function fa(n){const[e,t]=n.split("-");return new Date(parseInt(e),parseInt(t)-1).toLocaleDateString("en-GB",{month:"long",year:"numeric"})}function rP(n){if(!n&&n!==0)return"-";const e=Math.floor(n/60),t=(n%60).toFixed(2);return e>0?`${e}m ${parseFloat(t).toFixed(0)}s`:`${parseFloat(t).toFixed(2)}s`}function aP(n,e){return!n&&n!==0?"-":!e&&e!==0?`${n}kg`:`${n}kg x ${e}`}function hh(n,e){if(!e)return"-";switch(n.unit){case"weight":return aP(e.weight,e.reps);case"time":return rP(e.time);case"reps":return e.reps?`${e.reps} reps`:"-";case"distance":return e.distance?`${e.distance} cm`:"-";default:return"-"}}function Ll(n,e){if(!e)return 0;switch(n.unit){case"weight":return(e.weight||0)*(e.reps||0);case"time":return e.time||0;case"reps":return e.reps||0;case"distance":return e.distance||0;default:return 0}}function eg(n,e){return!e||e===0?null:(n-e)/e*100}function iP({data:n,exerciseKey:e,unit:t}){if(!n||n.length<2)return r.jsx("div",{className:"pb-trend-empty",children:r.jsx("p",{children:"Not enough data for trend line yet"})});const i=n.map(F=>{const U=F.benchmarks?.[e];if(!U)return 0;switch(t){case"weight":return(U.weight||0)*(U.reps||0);case"time":return U.time||0;case"reps":return U.reps||0;case"distance":return U.distance||0;default:return 0}}),l=Math.max(...i),u=Math.min(...i),d=l-u||1,p=300,g=100,y=20,w=p-y*2,j=g-y*2,T=i.map((F,U)=>{const ne=y+U/(i.length-1)*w,Y=y+j-(F-u)/d*j;return{x:ne,y:Y,value:F}}),V=T.map((F,U)=>`${U===0?"M":"L"} ${F.x} ${F.y}`).join(" "),W=V+` L ${T[T.length-1].x} ${y+j} L ${T[0].x} ${y+j} Z`;return r.jsxs("div",{className:"pb-trend-chart",children:[r.jsxs("svg",{viewBox:`0 0 ${p} ${g}`,preserveAspectRatio:"xMidYMid meet",children:[r.jsx("defs",{children:r.jsxs("linearGradient",{id:"trendGradientJr",x1:"0",y1:"0",x2:"0",y2:"1",children:[r.jsx("stop",{offset:"0%",stopColor:"var(--color-primary)",stopOpacity:"0.3"}),r.jsx("stop",{offset:"100%",stopColor:"var(--color-primary)",stopOpacity:"0.02"})]})}),r.jsx("path",{d:W,fill:"url(#trendGradientJr)"}),r.jsx("path",{d:V,fill:"none",stroke:"var(--color-primary)",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round"}),T.map((F,U)=>r.jsx("circle",{cx:F.x,cy:F.y,r:"4",fill:"var(--bg-card)",stroke:"var(--color-primary)",strokeWidth:"2"},U))]}),r.jsx("div",{className:"pb-trend-labels",children:n.map((F,U)=>r.jsxs("span",{className:"pb-trend-label",children:[F.month.split("-")[1],"/",F.month.split("-")[0].slice(2)]},U))})]})}function oP(){const[n,e]=v.useState("bests"),[t,i]=v.useState([]),[l,u]=v.useState(!0),[d,p]=v.useState(!1),[g,y]=v.useState(0),[w,j]=v.useState(!1),[T,V]=v.useState(!1),[W,F]=v.useState(!1),[U,ne]=v.useState({}),[Y,oe]=v.useState({}),[be,Le]=v.useState({}),[Ce,R]=v.useState({}),[E,A]=v.useState({}),[O,D]=v.useState(!1),[H,M]=v.useState({}),[We,gt]=v.useState([]),[$,me]=v.useState(null),[Ve,Ke]=v.useState(null),[J,L]=v.useState(!1),[se,Me]=v.useState(""),[De,Je]=v.useState(""),Fe=v.useRef(null),bt=v.useRef(0),kt=v.useRef(0),nt=v.useRef("right"),Wt=v.useCallback(q=>{y(xe=>{const je=Math.max(0,Math.min(ma.length-1,q));return je===xe?xe:(nt.current=je>xe?"right":"left",je)})},[]),{currentUser:ts,isClient:St,clientData:at,loading:ce}=Mr(),{isDark:Xt}=ka(),Gt=$n(),rt=v.useCallback((q,xe="info")=>{Ke({message:q,type:xe}),setTimeout(()=>Ke(null),4e3)},[]);v.useEffect(()=>{!ce&&(!ts||!St)&&Gt("/")},[ts,St,ce,Gt]),v.useEffect(()=>{at&&pt()},[at]);const pt=async()=>{try{const q=Ds(zt(pe,"juniorPBs"),hs("clientId","==",at.id)),je=(await Es(q)).docs.map(et=>({id:et.id,...et.data()}));je.sort((et,vt)=>et.month.localeCompare(vt.month)),i(je);const Te=Ds(zt(pe,"juniorPBTargets"),hs("clientId","==",at.id)),_e=await Es(Te);if(!_e.empty){const et=_e.docs[0].data();Le(et.targets||{}),R(et.metricTargets||{}),A(et.targets||{}),M(et.metricTargets||{})}const ct=Ds(zt(pe,"juniorAchievements"),hs("clientId","==",at.id)),ht=await Es(ct);ht.empty||gt(ht.docs[0].data().badges||[])}catch(q){console.error("Error fetching junior personal bests:",q)}u(!1)},it=nP(),st=t.find(q=>q.month===it),Kt=t.filter(q=>q.month<it),Ks=Kt.length>0?Kt[Kt.length-1]:null;v.useEffect(()=>{st?(ne(st.benchmarks||{}),oe(st.bodyMetrics||{})):(ne({}),oe({}))},[st?.id]);const Ps=async(q,xe)=>{const je=[];if(q==="strength"?ma.forEach(Te=>{const _e=be[Te.key];if(!_e)return;const ct=xe[Te.key];if(!ct)return;let ht;if(_e.targetType==="time"){if(!_e.targetValue)return;const et=_e.startValue||0,vt=ct.time||0,Rt=_e.targetValue-et;ht=Rt===0?vt>=_e.targetValue?1:0:Math.max(0,(vt-et)/Rt)}else if(_e.targetType==="reps"){if(!_e.targetReps)return;const et=_e.startReps||0,vt=ct.reps||0,Rt=_e.targetReps-et;ht=Rt===0?vt>=_e.targetReps?1:0:Math.max(0,(vt-et)/Rt)}else if(_e.targetType==="distance"){if(!_e.targetDistance)return;const et=_e.startDistance||0,vt=ct.distance||0,Rt=_e.targetDistance-et;ht=Rt===0?vt>=_e.targetDistance?1:0:Math.max(0,(vt-et)/Rt)}else{if(!_e.targetWeight&&!_e.targetReps)return;const et=(_e.startWeight||0)*(_e.startReps||0),vt=(_e.targetWeight||0)*(_e.targetReps||0),Rt=(ct.weight||0)*(ct.reps||0),js=vt-et;ht=js===0?Rt>=vt?1:0:Math.max(0,(Rt-et)/js)}if(ht>=1){let et,vt;_e.targetType==="time"?(et=We.some(Rt=>Rt.type==="strength"&&Rt.key===Te.key&&Rt.targetValue===_e.targetValue),vt=`${Te.name} ${_e.targetValue}s`):_e.targetType==="reps"?(et=We.some(Rt=>Rt.type==="strength"&&Rt.key===Te.key&&Rt.targetReps===_e.targetReps),vt=`${Te.name} ${_e.targetReps} reps`):_e.targetType==="distance"?(et=We.some(Rt=>Rt.type==="strength"&&Rt.key===Te.key&&Rt.targetDistance===_e.targetDistance),vt=`${Te.name} ${_e.targetDistance}cm`):(et=We.some(Rt=>Rt.type==="strength"&&Rt.key===Te.key&&Rt.targetWeight===_e.targetWeight&&Rt.targetReps===_e.targetReps),vt=`${Te.name} ${_e.targetWeight}kg  ${_e.targetReps}`),et||je.push({type:"strength",key:Te.key,..._e.targetType==="time"?{targetType:"time",targetValue:_e.targetValue}:_e.targetType==="reps"?{targetType:"reps",targetReps:_e.targetReps}:_e.targetType==="distance"?{targetType:"distance",targetDistance:_e.targetDistance}:{targetWeight:_e.targetWeight,targetReps:_e.targetReps},achievedMonth:it,label:vt})}}):Po.forEach(Te=>{const _e=Ce[Te.key];if(!_e||!_e.targetValue)return;const ct=xe[Te.key];if(ct==null)return;const ht=_e.startValue||0,et=_e.targetValue,vt=et-ht;(vt===0?ct===et?1:0:Math.max(0,(ct-ht)/vt))>=1&&(We.some(mn=>mn.type==="metric"&&mn.key===Te.key&&mn.targetValue===et)||je.push({type:"metric",key:Te.key,targetValue:et,achievedMonth:it,label:`${Te.name} ${et}${Te.suffix}`}))}),je.length>0){const Te=[...We,...je];await Ns(He(pe,"juniorAchievements",at.id),{clientId:at.id,badges:Te,updatedAt:xt.now()}),gt(Te),me(je),setTimeout(()=>me(null),5e3)}},ss=(q,xe)=>{if(q==="strength"){const je=be[xe];if(!je)return!1;switch(ma.find(_e=>_e.key===xe)?.unit){case"time":return We.some(_e=>_e.type==="strength"&&_e.key===xe&&_e.targetValue===je.targetValue);case"reps":return We.some(_e=>_e.type==="strength"&&_e.key===xe&&_e.targetReps===je.targetReps);case"distance":return We.some(_e=>_e.type==="strength"&&_e.key===xe&&_e.targetDistance===je.targetDistance);default:return!je.targetWeight&&!je.targetReps?!1:We.some(_e=>_e.type==="strength"&&_e.key===xe&&_e.targetWeight===je.targetWeight&&_e.targetReps===je.targetReps)}}else{const je=Ce[xe];return!je||!je.targetValue?!1:We.some(Te=>Te.type==="metric"&&Te.key===xe&&Te.targetValue===je.targetValue)}},Ct=async()=>{p(!0);try{const q=`${at.id}_${it}`,xe=st||{};await Ns(He(pe,"juniorPBs",q),{clientId:at.id,month:it,benchmarks:U,bodyMetrics:xe.bodyMetrics||Y||{},createdAt:xe.createdAt||xt.now(),updatedAt:xt.now()}),await Ps("strength",U),rt("Benchmarks saved!","success"),j(!1),await pt()}catch(q){console.error("Error saving benchmarks:",q),rt("Failed to save. Please try again.","error")}p(!1)},Jt=async()=>{p(!0);try{const q=`${at.id}_${it}`,xe=st||{};await Ns(He(pe,"juniorPBs",q),{clientId:at.id,month:it,benchmarks:xe.benchmarks||U||{},bodyMetrics:Y,createdAt:xe.createdAt||xt.now(),updatedAt:xt.now()}),await Ps("metric",Y),rt("Body metrics saved!","success"),V(!1),await pt()}catch(q){console.error("Error saving metrics:",q),rt("Failed to save. Please try again.","error")}p(!1)},vs=(q,xe,je)=>{ne(Te=>({...Te,[q]:{...Te[q],[xe]:je===""?"":parseFloat(je)}}))},Bt=(q,xe)=>{oe(je=>({...je,[q]:xe===""?"":parseFloat(xe)}))},As=(q,xe,je)=>{A(Te=>({...Te,[q]:{...Te[q],[xe]:je===""?"":parseFloat(je)}}))},ue=async()=>{p(!0);try{const q=`targets_${at.id}`,xe=st?.benchmarks||{},je={};ma.forEach(Te=>{const _e=xe[Te.key];switch(Te.unit){case"time":E[Te.key]?.targetValue&&(je[Te.key]={targetType:"time",targetValue:E[Te.key].targetValue,startValue:_e?.time||0});break;case"reps":E[Te.key]?.targetReps&&(je[Te.key]={targetType:"reps",targetReps:E[Te.key].targetReps,startReps:_e?.reps||0});break;case"distance":E[Te.key]?.targetDistance&&(je[Te.key]={targetType:"distance",targetDistance:E[Te.key].targetDistance,startDistance:_e?.distance||0});break;default:(E[Te.key]?.targetWeight||E[Te.key]?.targetReps)&&(je[Te.key]={targetWeight:E[Te.key].targetWeight||0,targetReps:E[Te.key].targetReps||0,startWeight:_e?.weight||0,startReps:_e?.reps||0})}}),await Ns(He(pe,"juniorPBTargets",q),{clientId:at.id,targets:je,metricTargets:Ce,updatedAt:xt.now()}),Le(je),A(je),rt("Targets saved!","success"),F(!1)}catch(q){console.error("Error saving targets:",q),rt("Failed to save targets.","error")}p(!1)},Ee=(q,xe)=>{M(je=>({...je,[q]:{...je[q],targetValue:xe===""?"":parseFloat(xe)}}))},Ae=async()=>{p(!0);try{const q=`targets_${at.id}`,xe={};Po.forEach(je=>{if(H[je.key]?.targetValue){const Te=st?.bodyMetrics?.[je.key]||0;xe[je.key]={targetValue:H[je.key].targetValue,startValue:Te}}}),await Ns(He(pe,"juniorPBTargets",q),{clientId:at.id,targets:be,metricTargets:xe,updatedAt:xt.now()}),R(xe),M(xe),rt("Metric targets saved!","success"),D(!1)}catch(q){console.error("Error saving metric targets:",q),rt("Failed to save targets.","error")}p(!1)},ee=async()=>{if(window.confirm("Reset all goals? This will clear all strength and body metric targets. Your recorded benchmarks and measurements will NOT be affected.")){p(!0);try{const q=He(pe,"juniorPBTargets",`targets_${at.id}`);await yr(q),Le({}),R({}),A({}),M({}),rt("All goals have been reset","success")}catch(q){console.error("Error resetting targets:",q),rt("Failed to reset goals","error")}p(!1)}},ge=(q,xe)=>{const je=be[q];if(!je||!xe)return null;if(je.targetType==="time"){if(!je.targetValue)return null;const et=je.startValue||0,vt=je.targetValue,Rt=xe.time||0,js=vt-et;return js<=0?Rt>=vt?1:0:Math.max(0,Math.min((Rt-et)/js,1))}if(je.targetType==="reps"){if(!je.targetReps)return null;const et=je.startReps||0,vt=je.targetReps,Rt=xe.reps||0,js=vt-et;return js<=0?Rt>=vt?1:0:Math.max(0,Math.min((Rt-et)/js,1))}if(je.targetType==="distance"){if(!je.targetDistance)return null;const et=je.startDistance||0,vt=je.targetDistance,Rt=xe.distance||0,js=vt-et;return js<=0?Rt>=vt?1:0:Math.max(0,Math.min((Rt-et)/js,1))}if(!je.targetWeight&&!je.targetReps)return null;const Te=(je.startWeight||0)*(je.startReps||0),_e=(je.targetWeight||0)*(je.targetReps||0),ct=(xe.weight||0)*(xe.reps||0),ht=_e-Te;return ht<=0?ct>=_e?1:0:Math.max(0,Math.min((ct-Te)/ht,1))},we=q=>{const xe=Ce[q];if(!xe||!xe.targetValue)return null;const je=st?.bodyMetrics?.[q];if(je==null)return null;const Te=xe.startValue||0,_e=xe.targetValue,ct=_e-Te;return ct===0?je===_e?1:0:Math.max(0,Math.min((je-Te)/ct,1))},Oe=q=>{bt.current=q.touches[0].clientX,kt.current=0},Ue=q=>{kt.current=q.touches[0].clientX-bt.current},$e=()=>{kt.current<-50?Wt(g+1):kt.current>50&&Wt(g-1),kt.current=0},ft=q=>{const xe=st?.bodyMetrics?.[q],je=Ks?.bodyMetrics?.[q];return xe==null||je==null?null:parseFloat((xe-je).toFixed(2))},jt=t.find(q=>q.month===se),Q=t.find(q=>q.month===De);if(ce||l)return r.jsxs("div",{className:"pb-page",children:[r.jsx("header",{className:"client-header",children:r.jsx("div",{className:"header-content",children:r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})})}),r.jsxs("main",{className:"pb-main",children:[r.jsx("div",{className:"skeleton skeleton-title",style:{width:180,height:28,marginBottom:20}}),r.jsx("div",{className:"skeleton skeleton-card-large",style:{height:320,borderRadius:16}})]})]});if(!ts||!St||!at)return null;const fe=ma[g],lt=st?.benchmarks?.[fe.key],At=Ks?.benchmarks?.[fe.key],Tt=Ll(fe,lt),ns=Ll(fe,At),Ut=eg(Tt,ns),Ot=ge(fe.key,lt),Ls=Ot!==null,Js=Ot!==null&&Ot>=1,os=Ls?Math.round(Ot*60):Tt>0?15:0,Ss=be[fe.key],Os=q=>q?q.targetType==="time"?`${q.startValue||0}s  ${q.targetValue}s`:q.targetType==="reps"?`${q.startReps||0}  ${q.targetReps} reps`:q.targetType==="distance"?`${q.startDistance||0}  ${q.targetDistance}cm`:`${q.startWeight||0}kg${q.startReps||0}  ${q.targetWeight}kg${q.targetReps}`:null;return r.jsxs("div",{className:"pb-page",children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>Gt("/client"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})]})}),r.jsxs("main",{className:"pb-main page-transition-enter",children:[r.jsxs("div",{className:"pb-intro",children:[r.jsx("h2",{children:"Junior Strength Tests"}),r.jsx("p",{children:"Track your strength test results and body measurements each month."})]}),r.jsxs("div",{className:"pb-tabs",children:[r.jsx("button",{className:`pb-tab ${n==="bests"?"active":""}`,onClick:()=>e("bests"),children:"Strength"}),r.jsx("button",{className:`pb-tab ${n==="metrics"?"active":""}`,onClick:()=>e("metrics"),children:"Body Metrics"}),r.jsx("button",{className:`pb-tab ${n==="history"?"active":""}`,onClick:()=>e("history"),children:"History"})]}),n==="bests"&&r.jsxs("div",{className:"pb-strength-section",children:[!w&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"pb-carousel",ref:Fe,onTouchStart:Oe,onTouchMove:Ue,onTouchEnd:$e,children:[r.jsx("div",{className:`pb-ring-container slide-from-${nt.current}`,children:r.jsxs("div",{className:"pb-ring",children:[r.jsx("svg",{className:"pb-ring-svg",viewBox:"0 0 200 200",children:Jy.map((q,xe)=>{const je=xe<Math.round(os);return r.jsx("line",{x1:q.x1,y1:q.y1,x2:q.x2,y2:q.y2,className:`pb-ring-tick ${je?Js?"hit":"filled":"empty"}`,strokeWidth:q.thick?"3":"2"},xe)})}),r.jsxs("div",{className:"pb-ring-center",children:[r.jsx("div",{className:"pb-ring-category",children:fe.category}),r.jsxs("div",{className:"pb-ring-exercise",children:[fe.name,ss("strength",fe.key)&&r.jsx("svg",{className:"pb-badge-icon",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})]}),r.jsx("div",{className:"pb-ring-value",children:lt?hh(fe,lt):"-"}),Ut!==null&&r.jsxs("div",{className:`pb-ring-change ${Ut>=0?"positive":"negative"}`,children:[Ut>=0?"+":"",Ut.toFixed(1),"%"]}),Ut===null&&lt&&r.jsx("div",{className:"pb-ring-change neutral",children:"New entry"}),Ss&&r.jsx("div",{className:`pb-ring-target ${Js?"hit":""}`,children:Js?"Target hit!":Os(Ss)}),!Ss&&r.jsx("div",{className:"pb-ring-target none",children:"No target set"})]})]})},g),r.jsx("div",{className:"pb-carousel-dots",children:ma.map((q,xe)=>r.jsx("button",{className:`pb-dot ${xe===g?"active":""}`,onClick:()=>Wt(xe)},xe))}),r.jsx("button",{className:"pb-carousel-arrow left",onClick:()=>Wt(g-1),disabled:g===0,children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"})})}),r.jsx("button",{className:"pb-carousel-arrow right",onClick:()=>Wt(g+1),disabled:g===ma.length-1,children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M8.59 16.59L10 18l6-6-6-6-1.41 1.41L13.17 12z"})})})]}),r.jsxs("div",{className:"pb-trend-section",children:[r.jsx("h4",{children:"Trend"}),r.jsx(iP,{data:t,exerciseKey:fe.key,unit:fe.unit})]})]}),!w&&!W&&r.jsxs("div",{className:"pb-action-buttons",children:[r.jsx("button",{className:"pb-edit-btn",onClick:()=>j(!0),children:st?.benchmarks?"Edit This Month's Benchmarks":"Add This Month's Benchmarks"}),r.jsx("button",{className:"pb-edit-btn pb-target-btn",onClick:()=>F(!0),children:Object.keys(be).length>0?"Edit Targets":"Set Targets"}),(Object.keys(be).length>0||Object.keys(Ce).length>0)&&r.jsx("button",{className:"pb-edit-btn pb-reset-btn",onClick:ee,disabled:d,children:"Reset All Goals"})]}),w&&r.jsxs("div",{className:"pb-edit-card",children:[r.jsxs("div",{className:"pb-edit-header",children:[r.jsxs("h3",{children:["Benchmarks - ",fa(it)]}),r.jsx("button",{className:"pb-edit-close",onClick:()=>{j(!1),ne(st?.benchmarks||{})},children:""})]}),r.jsx("div",{className:"pb-edit-body",children:ma.map(q=>r.jsxs("div",{className:"pb-edit-exercise",children:[r.jsx("div",{className:"pb-edit-exercise-name",children:q.name}),q.unit==="weight"?r.jsxs("div",{className:"pb-edit-row",children:[r.jsxs("div",{className:"pb-edit-field",children:[r.jsx("label",{children:"Weight (kg)"}),r.jsx("input",{type:"number",step:"0.5",value:U[q.key]?.weight??"",onChange:xe=>vs(q.key,"weight",xe.target.value),placeholder:"0"})]}),r.jsxs("div",{className:"pb-edit-field",children:[r.jsx("label",{children:"Reps"}),r.jsx("input",{type:"number",value:U[q.key]?.reps??"",onChange:xe=>vs(q.key,"reps",xe.target.value),placeholder:"0"})]})]}):q.unit==="reps"?r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsx("label",{children:"Reps (max in 1 min)"}),r.jsx("input",{type:"number",value:U[q.key]?.reps??"",onChange:xe=>vs(q.key,"reps",xe.target.value),placeholder:"0"})]})}):q.unit==="distance"?r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsx("label",{children:"Distance (cm)"}),r.jsx("input",{type:"number",step:"0.5",value:U[q.key]?.distance??"",onChange:xe=>vs(q.key,"distance",xe.target.value),placeholder:"0"})]})}):r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsx("label",{children:"Time (seconds)"}),r.jsx("input",{type:"number",step:"0.01",value:U[q.key]?.time??"",onChange:xe=>vs(q.key,"time",xe.target.value),placeholder:"0"})]})})]},q.key))}),r.jsxs("div",{className:"pb-edit-actions",children:[r.jsx("button",{className:"pb-cancel-btn",onClick:()=>{j(!1),ne(st?.benchmarks||{})},children:"Cancel"}),r.jsx("button",{className:"pb-save-btn",onClick:Ct,disabled:d,children:d?"Saving...":"Save"})]})]}),W&&r.jsxs("div",{className:"pb-edit-card",children:[r.jsxs("div",{className:"pb-edit-header",children:[r.jsx("h3",{children:"Set Your Targets"}),r.jsx("button",{className:"pb-edit-close",onClick:()=>{F(!1),A(be)},children:""})]}),r.jsxs("div",{className:"pb-edit-body",children:[r.jsx("p",{className:"pb-target-hint",children:"Set a target for each exercise. Your current best is captured automatically from your latest benchmarks."}),ma.map(q=>{const xe=st?.benchmarks?.[q.key];let je="-";if(xe)switch(q.unit){case"weight":(xe.weight||xe.reps)&&(je=`${xe.weight||0}kg  ${xe.reps||0}`);break;case"time":xe.time&&(je=`${xe.time}s`);break;case"reps":xe.reps&&(je=`${xe.reps} reps`);break;case"distance":xe.distance&&(je=`${xe.distance} cm`);break}return r.jsxs("div",{className:"pb-edit-exercise",children:[r.jsxs("div",{className:"pb-edit-exercise-header",children:[r.jsx("div",{className:"pb-edit-exercise-name",children:q.name}),r.jsxs("div",{className:"pb-edit-current-best",children:["Current: ",je]})]}),q.unit==="weight"?r.jsxs("div",{className:"pb-edit-row",children:[r.jsxs("div",{className:"pb-edit-field",children:[r.jsx("label",{children:"Target Weight (kg)"}),r.jsx("input",{type:"number",step:"0.5",value:E[q.key]?.targetWeight??"",onChange:Te=>As(q.key,"targetWeight",Te.target.value),placeholder:"0"})]}),r.jsxs("div",{className:"pb-edit-field",children:[r.jsx("label",{children:"Target Reps"}),r.jsx("input",{type:"number",value:E[q.key]?.targetReps??"",onChange:Te=>As(q.key,"targetReps",Te.target.value),placeholder:"0"})]})]}):q.unit==="reps"?r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsx("label",{children:"Target Reps (in 1 min)"}),r.jsx("input",{type:"number",value:E[q.key]?.targetReps??"",onChange:Te=>As(q.key,"targetReps",Te.target.value),placeholder:"0"})]})}):q.unit==="distance"?r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsx("label",{children:"Target Distance (cm)"}),r.jsx("input",{type:"number",step:"0.5",value:E[q.key]?.targetDistance??"",onChange:Te=>As(q.key,"targetDistance",Te.target.value),placeholder:"0"})]})}):r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsx("label",{children:"Target (seconds)"}),r.jsx("input",{type:"number",step:"1",value:E[q.key]?.targetValue??"",onChange:Te=>As(q.key,"targetValue",Te.target.value),placeholder:"0"})]})})]},q.key)})]}),r.jsxs("div",{className:"pb-edit-actions",children:[r.jsx("button",{className:"pb-cancel-btn",onClick:()=>{F(!1),A(be)},children:"Cancel"}),r.jsx("button",{className:"pb-save-btn",onClick:ue,disabled:d,children:d?"Saving...":"Save Targets"})]})]})]}),n==="metrics"&&r.jsxs("div",{className:"pb-metrics-section",children:[!T&&!O&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"pb-metrics-card",children:[r.jsx("h3",{children:"Body Measurements"}),r.jsx("p",{className:"pb-metrics-month",children:fa(it)}),r.jsx("div",{className:"pb-metrics-list",children:Po.map(q=>{const xe=st?.bodyMetrics?.[q.key],je=ft(q.key),Te=Ce[q.key],_e=we(q.key),ct=_e!==null&&_e>=1;return r.jsxs("div",{className:"pb-metric-row",children:[r.jsxs("div",{className:"pb-metric-top",children:[r.jsxs("div",{className:"pb-metric-left",children:[r.jsxs("span",{className:"pb-metric-name",children:[q.name,ss("metric",q.key)&&r.jsx("svg",{className:"pb-badge-icon-sm",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})]}),Te&&r.jsxs("span",{className:"pb-metric-target-label",children:["Target: ",Te.targetValue," ",q.suffix]})]}),r.jsxs("div",{className:"pb-metric-values",children:[r.jsx("span",{className:"pb-metric-current",children:xe!=null?`${xe} ${q.suffix}`:"-"}),je!==null&&r.jsxs("span",{className:`pb-metric-change ${je>0?"up":je<0?"down":"same"}`,children:[je>0?"+":"",je," ",q.suffix]})]})]}),_e!==null&&r.jsxs("div",{className:"pb-metric-progress",children:[r.jsx("div",{className:"pb-metric-bar",children:r.jsx("div",{className:`pb-metric-bar-fill ${ct?"hit":""}`,style:{width:`${Math.round(_e*100)}%`}})}),r.jsx("span",{className:`pb-metric-percent ${ct?"hit":""}`,children:ct?"Hit!":`${Math.round(_e*100)}%`})]})]},q.key)})})]}),r.jsxs("div",{className:"pb-action-buttons",children:[r.jsx("button",{className:"pb-edit-btn",onClick:()=>V(!0),children:st?.bodyMetrics?"Edit This Month's Measurements":"Add This Month's Measurements"}),r.jsx("button",{className:"pb-edit-btn pb-target-btn",onClick:()=>D(!0),children:Object.keys(Ce).length>0?"Edit Targets":"Set Targets"}),(Object.keys(be).length>0||Object.keys(Ce).length>0)&&r.jsx("button",{className:"pb-edit-btn pb-reset-btn",onClick:ee,disabled:d,children:"Reset All Goals"})]})]}),T&&r.jsxs("div",{className:"pb-edit-card",children:[r.jsxs("div",{className:"pb-edit-header",children:[r.jsxs("h3",{children:["Measurements - ",fa(it)]}),r.jsx("button",{className:"pb-edit-close",onClick:()=>{V(!1),oe(st?.bodyMetrics||{})},children:""})]}),r.jsx("div",{className:"pb-edit-body",children:Po.map(q=>r.jsx("div",{className:"pb-edit-metric",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsxs("label",{children:[q.name," (",q.suffix,")"]}),r.jsx("input",{type:"number",step:"0.1",value:Y[q.key]??"",onChange:xe=>Bt(q.key,xe.target.value),placeholder:"0"})]})},q.key))}),r.jsxs("div",{className:"pb-edit-actions",children:[r.jsx("button",{className:"pb-cancel-btn",onClick:()=>{V(!1),oe(st?.bodyMetrics||{})},children:"Cancel"}),r.jsx("button",{className:"pb-save-btn",onClick:Jt,disabled:d,children:d?"Saving...":"Save"})]})]}),O&&r.jsxs("div",{className:"pb-edit-card",children:[r.jsxs("div",{className:"pb-edit-header",children:[r.jsx("h3",{children:"Body Metric Targets"}),r.jsx("button",{className:"pb-edit-close",onClick:()=>{D(!1),M(Ce)},children:""})]}),r.jsxs("div",{className:"pb-edit-body",children:[r.jsx("p",{className:"pb-target-hint",children:"Set targets for your body measurements. Your current measurement is captured automatically."}),Po.map(q=>{const xe=st?.bodyMetrics?.[q.key];return r.jsxs("div",{className:"pb-edit-exercise",children:[r.jsxs("div",{className:"pb-edit-exercise-header",children:[r.jsx("div",{className:"pb-edit-exercise-name",children:q.name}),r.jsxs("div",{className:"pb-edit-current-best",children:["Current: ",xe!=null?`${xe} ${q.suffix}`:"-"]})]}),r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsxs("label",{children:["Target (",q.suffix,")"]}),r.jsx("input",{type:"number",step:"0.1",value:H[q.key]?.targetValue??"",onChange:je=>Ee(q.key,je.target.value),placeholder:"0"})]})})]},q.key)})]}),r.jsxs("div",{className:"pb-edit-actions",children:[r.jsx("button",{className:"pb-cancel-btn",onClick:()=>{D(!1),M(Ce)},children:"Cancel"}),r.jsx("button",{className:"pb-save-btn",onClick:Ae,disabled:d,children:d?"Saving...":"Save Targets"})]})]})]}),n==="history"&&r.jsx("div",{className:"pb-history-section",children:t.length===0?r.jsxs("div",{className:"pb-empty",children:[r.jsx("h4",{children:"No records yet"}),r.jsx("p",{children:"Start adding your monthly benchmarks and measurements to track your progress over time."})]}):r.jsxs(r.Fragment,{children:[We.length>0&&r.jsxs("div",{className:"pb-achievements-wall",children:[r.jsxs("h4",{className:"pb-achievements-wall-title",children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"18",height:"18",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),"Targets Achieved"]}),r.jsx("div",{className:"pb-achievements-list",children:[...We].reverse().map((q,xe)=>r.jsxs("div",{className:"pb-achievement-item",style:{animationDelay:`${xe*.05}s`},children:[r.jsx("div",{className:"pb-achievement-star",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),r.jsxs("div",{className:"pb-achievement-info",children:[r.jsx("span",{className:"pb-achievement-label",children:q.label}),r.jsx("span",{className:"pb-achievement-date",children:fa(q.achievedMonth)})]})]},xe))})]}),r.jsx("div",{className:"pb-history-controls",children:r.jsx("button",{className:`pb-compare-toggle ${J?"active":""}`,onClick:()=>{L(!J),!J&&t.length>=2&&(Me(t[0].month),Je(t[t.length-1].month))},children:J?"Back to Timeline":"Compare Months"})}),J?r.jsxs("div",{className:"pb-compare",children:[r.jsxs("div",{className:"pb-compare-selectors",children:[r.jsxs("div",{className:"pb-compare-select",children:[r.jsx("label",{children:"From"}),r.jsx("select",{value:se,onChange:q=>Me(q.target.value),children:t.map(q=>r.jsx("option",{value:q.month,children:fa(q.month)},q.month))})]}),r.jsx("div",{className:"pb-compare-vs",children:"vs"}),r.jsxs("div",{className:"pb-compare-select",children:[r.jsx("label",{children:"To"}),r.jsx("select",{value:De,onChange:q=>Je(q.target.value),children:t.map(q=>r.jsx("option",{value:q.month,children:fa(q.month)},q.month))})]})]}),jt&&Q&&r.jsxs("div",{className:"pb-compare-results",children:[r.jsxs("div",{className:"pb-compare-group",children:[r.jsx("h4",{children:"Strength Tests"}),r.jsxs("div",{className:"pb-compare-table",children:[r.jsxs("div",{className:"pb-compare-header-row",children:[r.jsx("span",{children:"Exercise"}),r.jsx("span",{children:fa(se).split(" ")[0]}),r.jsx("span",{children:fa(De).split(" ")[0]}),r.jsx("span",{children:"Change"})]}),ma.map(q=>{const xe=jt.benchmarks?.[q.key],je=Q.benchmarks?.[q.key],Te=Ll(q,xe),_e=Ll(q,je),ct=eg(_e,Te);return r.jsxs("div",{className:"pb-compare-row",children:[r.jsx("span",{className:"pb-compare-name",children:q.name}),r.jsx("span",{className:"pb-compare-val",children:xe?hh(q,xe):"-"}),r.jsx("span",{className:"pb-compare-val",children:je?hh(q,je):"-"}),r.jsx("span",{className:`pb-compare-change ${ct!==null?ct>=0?"positive":"negative":""}`,children:ct!==null?`${ct>=0?"+":""}${ct.toFixed(1)}%`:"-"})]},q.key)})]})]}),r.jsxs("div",{className:"pb-compare-group",children:[r.jsx("h4",{children:"Body Measurements"}),r.jsxs("div",{className:"pb-compare-table",children:[r.jsxs("div",{className:"pb-compare-header-row",children:[r.jsx("span",{children:"Measurement"}),r.jsx("span",{children:fa(se).split(" ")[0]}),r.jsx("span",{children:fa(De).split(" ")[0]}),r.jsx("span",{children:"Change"})]}),Po.map(q=>{const xe=jt.bodyMetrics?.[q.key],je=Q.bodyMetrics?.[q.key],Te=xe!=null&&je!=null?parseFloat((je-xe).toFixed(2)):null;return r.jsxs("div",{className:"pb-compare-row",children:[r.jsx("span",{className:"pb-compare-name",children:q.name}),r.jsx("span",{className:"pb-compare-val",children:xe!=null?`${xe}`:"-"}),r.jsx("span",{className:"pb-compare-val",children:je!=null?`${je}`:"-"}),r.jsx("span",{className:`pb-compare-change ${Te!==null?Te>0?"positive":Te<0?"negative":"neutral":""}`,children:Te!==null?`${Te>0?"+":""}${Te} ${q.suffix}`:"-"})]},q.key)})]})]})]})]}):r.jsx("div",{className:"pb-timeline",children:[...t].reverse().map((q,xe)=>{const je=t.filter(Te=>Te.month<q.month).pop();return r.jsxs("div",{className:"pb-timeline-item",style:{animationDelay:`${xe*.05}s`},children:[r.jsx("div",{className:"pb-timeline-dot"}),r.jsxs("div",{className:"pb-timeline-card",children:[r.jsx("h4",{children:fa(q.month)}),q.benchmarks&&Object.keys(q.benchmarks).length>0&&r.jsxs("div",{className:"pb-timeline-group",children:[r.jsx("h5",{children:"Strength Tests"}),ma.map(Te=>{const _e=q.benchmarks[Te.key];if(!_e)return null;const ct=je?.benchmarks?.[Te.key],ht=Ll(Te,_e),et=Ll(Te,ct),vt=eg(ht,et);return r.jsxs("div",{className:"pb-timeline-row",children:[r.jsx("span",{className:"pb-timeline-label",children:Te.name}),r.jsxs("div",{className:"pb-timeline-values",children:[r.jsx("span",{className:"pb-timeline-value",children:hh(Te,_e)}),vt!==null&&r.jsxs("span",{className:`pb-timeline-change ${vt>=0?"positive":"negative"}`,children:[vt>=0?"+":"",vt.toFixed(1),"%"]})]})]},Te.key)})]}),q.bodyMetrics&&Object.keys(q.bodyMetrics).length>0&&r.jsxs("div",{className:"pb-timeline-group",children:[r.jsx("h5",{children:"Body Measurements"}),Po.map(Te=>{const _e=q.bodyMetrics[Te.key];if(_e==null)return null;const ct=je?.bodyMetrics?.[Te.key],ht=ct!=null?parseFloat((_e-ct).toFixed(2)):null;return r.jsxs("div",{className:"pb-timeline-row",children:[r.jsx("span",{className:"pb-timeline-label",children:Te.name}),r.jsxs("div",{className:"pb-timeline-values",children:[r.jsxs("span",{className:"pb-timeline-value",children:[_e," ",Te.suffix]}),ht!==null&&r.jsxs("span",{className:`pb-timeline-change ${ht>0?"positive":ht<0?"negative":"neutral"}`,children:[ht>0?"+":"",ht," ",Te.suffix]})]})]},Te.key)})]})]})]},q.id)})})]})})]}),$&&r.jsx("div",{className:"pb-celebration-overlay",onClick:()=>me(null),children:r.jsxs("div",{className:"pb-celebration-card",children:[r.jsx("div",{className:"pb-celebration-icon",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),r.jsx("h3",{className:"pb-celebration-title",children:$.length===1?"Target Achieved!":`${$.length} Targets Achieved!`}),r.jsx("div",{className:"pb-celebration-badges",children:$.map((q,xe)=>r.jsx("div",{className:"pb-celebration-badge",children:q.label},xe))}),r.jsx("p",{className:"pb-celebration-sub",children:"Tap to dismiss"})]})}),Ve&&r.jsxs("div",{className:`toast-notification ${Ve.type}`,children:[r.jsx("span",{className:"toast-icon",children:Ve.type==="success"?r.jsx("svg",{className:"success-check-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{className:"check-path",d:"M5 13 L9 17 L19 7"})}):r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})}),r.jsx("span",{className:"toast-message",children:Ve.message}),r.jsx("button",{className:"toast-close",onClick:()=>Ke(null),children:""})]}),r.jsxs("nav",{className:"block-bottom-nav",children:[r.jsxs("button",{className:"block-nav-tab",onClick:()=>Gt("/client"),children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}),r.jsx("polyline",{points:"9 22 9 12 15 12 15 22"})]}),r.jsx("span",{children:"Home"})]}),r.jsxs("button",{className:"block-nav-tab",onClick:()=>Gt("/client/forms"),children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),r.jsx("polyline",{points:"14 2 14 8 20 8"}),r.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),r.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"})]}),r.jsx("span",{children:"Forms"})]}),r.jsxs("button",{className:"block-nav-tab",onClick:()=>Gt("/client/tools"),children:[r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"})}),r.jsx("span",{children:"Tools"})]}),r.jsxs("button",{className:"block-nav-tab active",children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M12 20V10"}),r.jsx("path",{d:"M18 20V4"}),r.jsx("path",{d:"M6 20v-4"})]}),r.jsx("span",{children:"PBs"})]}),at?.circuitAccess&&r.jsxs("button",{className:"block-nav-tab",onClick:()=>Gt("/client/circuit"),children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("path",{d:"M12 6v6l4 2"})]}),r.jsx("span",{children:"Circuit"})]})]})]})}const Vk=[{name:"Dumbbell Floor Press",type:"weighted",equipment:"dumbbells",group:"push",pbKey:"chestPress",storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Seated Dumbbell Shoulder Press",type:"weighted",equipment:"dumbbells",group:"push",pbKey:"shoulderPress",storagePath:"exercises/dumbbells/upper/seated dumbbell shoulder press.mp4"},{name:"Seated Dumbbell Arnold Press",type:"weighted",equipment:"dumbbells",group:"push",storagePath:"exercises/dumbbells/upper/seated dumbbell arnold press.mp4"},{name:"Dumbbell Overhead Tricep Extension",type:"weighted",equipment:"dumbbells",group:"push",storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Skullcrushers",type:"weighted",equipment:"dumbbells",group:"push",storagePath:"exercises/dumbbells/upper/skullcrushers.mp4"},{name:"Dumbbell Lateral Raise",type:"weighted",equipment:"dumbbells",group:"push",storagePath:"exercises/dumbbells/upper/dumbbell lateral raise.mp4"},{name:"Dumbbell Front Raise",type:"weighted",equipment:"dumbbells",group:"push",storagePath:"exercises/dumbbells/upper/dumbbell front raise.mp4"},{name:"Press Up",type:"reps",equipment:"bodyweight",group:"push",storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Tricep Dips",type:"reps",equipment:"bodyweight",group:"push",storagePath:"exercises/bodyweight/upper/tricep dips.mp4"},{name:"Pike Push Ups",type:"reps",equipment:"bodyweight",group:"push",storagePath:"exercises/bodyweight/upper/pike push ups.GIF"},{name:"Reverse Plank",type:"timed",equipment:"bodyweight",group:"push",storagePath:"exercises/bodyweight/upper/reverse plank.GIF"},{name:"Dumbbell Squeeze Press",type:"weighted",equipment:"dumbbells",group:"push",storagePath:null},{name:"Incline Dumbbell Press",type:"weighted",equipment:"dumbbells",group:"push",storagePath:null},{name:"Dumbbell Pullover",type:"weighted",equipment:"dumbbells",group:"push",storagePath:null},{name:"Dumbbell Fly",type:"weighted",equipment:"dumbbells",group:"push",storagePath:null},{name:"Tricep Kickback",type:"weighted",equipment:"dumbbells",group:"push",storagePath:null},{name:"Dumbbell Shrug",type:"weighted",equipment:"dumbbells",group:"push",storagePath:null},{name:"Dumbbell Y-Raise",type:"weighted",equipment:"dumbbells",group:"push",storagePath:null},{name:"Wide Press Up",type:"reps",equipment:"bodyweight",group:"push",storagePath:null},{name:"Diamond Press Up",type:"reps",equipment:"bodyweight",group:"push",storagePath:null},{name:"Decline Press Up",type:"reps",equipment:"bodyweight",group:"push",storagePath:null},{name:"Wall Walks",type:"reps",equipment:"bodyweight",group:"push",storagePath:null},{name:"Press Up Hold",type:"timed",equipment:"bodyweight",group:"push",storagePath:null},{name:"Shoulder Tap Hold",type:"timed",equipment:"bodyweight",group:"push",storagePath:null},{name:"Dumbbell Bent Over Row",type:"weighted",equipment:"dumbbells",group:"pull",pbKey:"seatedRow",storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Single Arm Bent Over Row",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Bicep Curl",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Hammer Curl",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:"exercises/dumbbells/upper/hammer curl.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Renegade Row",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:"exercises/dumbbells/upper/renegade row.mp4"},{name:"Wide Dumbbell Bent Over Row",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:null},{name:"Reverse Fly",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:null},{name:"Concentration Curl",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:null},{name:"Wide Grip Bicep Curl",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:null},{name:"Wrist Curl",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:null},{name:"Prone Y-T-W Raises",type:"reps",equipment:"bodyweight",group:"pull",storagePath:null},{name:"Reverse Snow Angel",type:"reps",equipment:"bodyweight",group:"pull",storagePath:null},{name:"Isometric Bicep Hold",type:"timed",equipment:"bodyweight",group:"pull",storagePath:null},{name:"Dumbbell Goblet Squats",type:"weighted",equipment:"dumbbells",group:"lower",pbKey:"squat",storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Romanian Deadlifts",type:"weighted",equipment:"dumbbells",group:"lower",pbKey:"deadlift",storagePath:"exercises/dumbbells/lower/romanian deadlifts.GIF"},{name:"Forward Dumbbell Lunges",type:"weighted",equipment:"dumbbells",group:"lower",storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.GIF"},{name:"Dumbbell Sumo Squats",type:"weighted",equipment:"dumbbells",group:"lower",storagePath:"exercises/dumbbells/lower/dumbbell sumo squats.GIF"},{name:"Weighted Calf Raises",type:"weighted",equipment:"dumbbells",group:"lower",storagePath:"exercises/dumbbells/lower/weighted calf raises.GIF"},{name:"1 Legged RDL",type:"weighted",equipment:"dumbbells",group:"lower",storagePath:"exercises/dumbbells/lower/1 legged rdl.GIF"},{name:"Dumbbell Box Step Ups",type:"weighted",equipment:"dumbbells",group:"lower",storagePath:"exercises/dumbbells/lower/dumbbell box step ups.mp4"},{name:"Dumbbell Squat Pulses",type:"weighted",equipment:"dumbbells",group:"lower",storagePath:"exercises/dumbbells/lower/dumbbell squat pulses.GIF"},{name:"Dumbbell Reverse Lunges",type:"weighted",equipment:"dumbbells",group:"lower",storagePath:"exercises/dumbbells/lower/dumbbell reverse lunges.GIF"},{name:"Kettlebell Romanian Deadlift",type:"weighted",equipment:"kettlebell",group:"lower",storagePath:"exercises/kettlebells/lower/kettlebell romanian deadlift.mp4"},{name:"Reverse Lunge",type:"reps",equipment:"bodyweight",group:"lower",storagePath:"exercises/bodyweight/lower/reverse lunge.GIF"},{name:"Box Step Ups",type:"reps",equipment:"bodyweight",group:"lower",storagePath:"exercises/bodyweight/lower/box step ups.GIF"},{name:"Bulgarian Split Squats",type:"reps",equipment:"bodyweight",group:"lower",storagePath:"exercises/bodyweight/lower/bulgarian split squats.GIF"},{name:"Jump Squats",type:"reps",equipment:"bodyweight",group:"lower",storagePath:"exercises/bodyweight/lower/jump squats.GIF"},{name:"Hip Thrusts",type:"reps",equipment:"bodyweight",group:"lower",storagePath:"exercises/bodyweight/lower/hip thrusts.GIF"},{name:"Donkey Kicks",type:"reps",equipment:"bodyweight",group:"lower",storagePath:"exercises/bodyweight/lower/donkey kicks.GIF"},{name:"Skater Jumps",type:"reps",equipment:"bodyweight",group:"lower",storagePath:"exercises/bodyweight/lower/skater jumps.GIF"},{name:"Squat And Hold",type:"timed",equipment:"bodyweight",group:"lower",storagePath:"exercises/bodyweight/lower/squat and hold.GIF"},{name:"Forearm Plank",type:"timed",equipment:"bodyweight",group:"core",pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"},{name:"Side Plank",type:"timed",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Side Plank.mp4"},{name:"Hollow Body Hold",type:"timed",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"},{name:"Superman Hold",type:"timed",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Superman Hold.mp4"},{name:"Mountain Climbers",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Mountain Climbers.mp4"},{name:"Fast Mountain Climbers",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Fast Mountain Climbers.mp4"},{name:"Cross Body Mountain Climbers",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Cross Body Mountain Climbers.mp4"},{name:"Russian Twist",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Russian Twist.mp4"},{name:"Crunch",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Crunch.mp4"},{name:"Bicycle Crunch",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Bicycle Crunch.mp4"},{name:"Leg Raises",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Leg Raises.mp4"},{name:"Dead Bug",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Dead Bug.mp4"},{name:"Dead Bug Single Leg Drop",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Dead Bug Single Leg Drop.mp4"},{name:"Bird Dog",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Bird Dog.mp4"},{name:"Flutter Kicks",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Flutter Kicks.mp4"},{name:"Hollow Hold Flutter Kicks",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Hollow Hold Flutter Kicks.mp4"},{name:"High Plank Shoulder Taps",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/High Plank Shoulder Taps.mp4"},{name:"Hip Dips Plank",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Hip Dips Plank.mp4"},{name:"Single Leg V-Up",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Single Leg V-Up.mp4"},{name:"Hollow Hold To V-Sit",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Hollow Hold To V-sit.mp4"},{name:"Toe Reaches",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/toe reaches.GIF"},{name:"Side Plank Rotation",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Side Plank Rotation.mp4"},{name:"Plank Walkout",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Plank Walkout.mp4"},{name:"Reverse Crunch To Leg Raise",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Reverse Crunch To Leg Raise.mp4"},{name:"Burpee",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Russian Twists Dumbbell",type:"weighted",equipment:"dumbbells",group:"core",storagePath:"exercises/dumbbells/core/russian twists dumbbell.GIF"},{name:"Kettlebell Russian Twist",type:"weighted",equipment:"kettlebell",group:"core",storagePath:"exercises/kettlebells/core/kettlebell russian twist.mp4"},{name:"Kettlebell Side Bends",type:"weighted",equipment:"kettlebell",group:"core",storagePath:"exercises/kettlebells/core/kettlebell side bends.mp4"},{name:"Kneeling Kettlebell Halo",type:"weighted",equipment:"kettlebell",group:"core",storagePath:"exercises/kettlebells/core/kneeling kettlebell halo.mp4"},{name:"Kettlebell Bird Dog Drag",type:"reps",equipment:"kettlebell",group:"core",storagePath:"exercises/kettlebells/core/kettlebell bird dog drag.mp4"},{name:"Back Extension Hold",type:"timed",equipment:"bodyweight",group:"core",storagePath:null},{name:"Dumbbell Plank Pull Through",type:"weighted",equipment:"dumbbells",group:"core",storagePath:null}];Vk.filter(n=>n.storagePath!==null);const lP=[{key:"push",label:"Push",subtitle:"Chest / Shoulders / Triceps",color:"#A12F3A",icon:"M4 10v4M8 7v10M8 12h8M16 7v10M20 10v4"},{key:"pull",label:"Pull",subtitle:"Back / Biceps",color:"#2196f3",icon:"M4 12h16M12 4v16M7 7l10 10M17 7L7 17"},{key:"lower",label:"Lower",subtitle:"Legs / Glutes",color:"#ff9800",icon:"M13 2L3 14h9l-1 8 10-12h-9l1-8z"},{key:"core",label:"Core",subtitle:"Abs / Stability",color:"#7c3aed",icon:"M12 22c5.52 0 10-4.48 10-10S17.52 2 12 2 2 6.48 2 12s4.48 10 10 10zM12 18c3.31 0 6-2.69 6-6s-2.69-6-6-6-6 2.69-6 6 2.69 6 6 6zM12 14a2 2 0 1 0 0-4 2 2 0 0 0 0 4z"}],Bk={};Vk.forEach(n=>{Bk[n.name]=n.group});function cP(n){return Bk[n]||null}const Aa=[{key:"chestPress",name:"Chest Press",category:"Upper Body - Push",unit:"weight"},{key:"shoulderPress",name:"Shoulder Press",category:"Upper Body - Push",unit:"weight"},{key:"seatedRow",name:"Seated Row",category:"Upper Body - Pull",unit:"weight"},{key:"latPulldown",name:"Lat Pulldown",category:"Upper Body - Pull",unit:"weight"},{key:"squat",name:"Squat",category:"Lower Body",unit:"weight"},{key:"deadlift",name:"Deadlift",category:"Lower Body",unit:"weight"},{key:"plank",name:"Plank",category:"Core",unit:"time"}],Lo=[{key:"weight",name:"Weight",suffix:"kg"},{key:"chest",name:"Chest",suffix:"cm"},{key:"waist",name:"Waist",suffix:"cm"},{key:"hips",name:"Hips",suffix:"cm"},{key:"leftArm",name:"Left Arm",suffix:"cm"},{key:"rightArm",name:"Right Arm",suffix:"cm"},{key:"leftThigh",name:"Left Thigh",suffix:"cm"},{key:"rightThigh",name:"Right Thigh",suffix:"cm"}];function uP(){const n=new Date;return`${n.getFullYear()}-${String(n.getMonth()+1).padStart(2,"0")}`}function pa(n){const[e,t]=n.split("-");return new Date(parseInt(e),parseInt(t)-1).toLocaleDateString("en-GB",{month:"long",year:"numeric"})}function mh(n){if(!n&&n!==0)return"-";const e=Math.floor(n/60),t=(n%60).toFixed(2);return e>0?`${e}m ${parseFloat(t).toFixed(0)}s`:`${parseFloat(t).toFixed(2)}s`}function C2(n,e){return!n&&n!==0?"-":!e&&e!==0?`${n}kg`:`${n}kg x ${e}`}function Ol(n,e){return e?n.unit==="time"?e.time||0:(e.weight||0)*(e.reps||0):0}function tg(n,e){return!e||e===0?null:(n-e)/e*100}function dP({data:n,exerciseKey:e,unit:t}){if(!n||n.length<2)return r.jsx("div",{className:"pb-trend-empty",children:r.jsx("p",{children:"Not enough data for trend line yet"})});const i=n.map(F=>{const U=F.benchmarks?.[e];return U?t==="time"?U.time||0:(U.weight||0)*(U.reps||0):0}),l=Math.max(...i),u=Math.min(...i),d=l-u||1,p=300,g=100,y=20,w=p-y*2,j=g-y*2,T=i.map((F,U)=>{const ne=y+U/(i.length-1)*w,Y=y+j-(F-u)/d*j;return{x:ne,y:Y,value:F}}),V=T.map((F,U)=>`${U===0?"M":"L"} ${F.x} ${F.y}`).join(" "),W=V+` L ${T[T.length-1].x} ${y+j} L ${T[0].x} ${y+j} Z`;return r.jsxs("div",{className:"pb-trend-chart",children:[r.jsxs("svg",{viewBox:`0 0 ${p} ${g}`,preserveAspectRatio:"xMidYMid meet",children:[r.jsx("defs",{children:r.jsxs("linearGradient",{id:"trendGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[r.jsx("stop",{offset:"0%",stopColor:"var(--color-primary)",stopOpacity:"0.3"}),r.jsx("stop",{offset:"100%",stopColor:"var(--color-primary)",stopOpacity:"0.02"})]})}),r.jsx("path",{d:W,fill:"url(#trendGradient)"}),r.jsx("path",{d:V,fill:"none",stroke:"var(--color-primary)",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round"}),T.map((F,U)=>r.jsx("circle",{cx:F.x,cy:F.y,r:"4",fill:"var(--bg-card)",stroke:"var(--color-primary)",strokeWidth:"2"},U))]}),r.jsx("div",{className:"pb-trend-labels",children:n.map((F,U)=>r.jsxs("span",{className:"pb-trend-label",children:[F.month.split("-")[1],"/",F.month.split("-")[0].slice(2)]},U))})]})}function hP(){const[n,e]=v.useState("bests"),[t,i]=v.useState([]),[l,u]=v.useState(!0),[d,p]=v.useState(!1),[g,y]=v.useState(0),[w,j]=v.useState(!1),[T,V]=v.useState(!1),[W,F]=v.useState(!1),[U,ne]=v.useState({}),[Y,oe]=v.useState({}),[be,Le]=v.useState({}),[Ce,R]=v.useState({}),[E,A]=v.useState({}),[O,D]=v.useState(!1),[H,M]=v.useState({}),[We,gt]=v.useState([]),[$,me]=v.useState(null),[Ve,Ke]=v.useState(null),[J,L]=v.useState(!1),[se,Me]=v.useState(""),[De,Je]=v.useState(""),[Fe,bt]=v.useState({}),[kt,nt]=v.useState({}),[Wt,ts]=v.useState(null),[St,at]=v.useState(null),[ce,Xt]=v.useState(""),[Gt,rt]=v.useState({}),pt=v.useRef(null),it=v.useRef(0),st=v.useRef(0),Kt=v.useRef("right"),Ks=v.useCallback(k=>{y(S=>{const P=Math.max(0,Math.min(Aa.length-1,k));return P===S?S:(Kt.current=P>S?"right":"left",P)})},[]),{currentUser:Ps,isClient:ss,clientData:Ct,loading:Jt}=Mr(),{isDark:vs}=ka(),Bt=$n(),[As]=sN(),ue=As.get("mode")==="corebuddy",Ee=!ue&&(!Ct?.clientType||Ct.clientType==="block"),Ae=v.useCallback((k,S="info")=>{Ke({message:k,type:S}),setTimeout(()=>Ke(null),4e3)},[]);v.useEffect(()=>{!Jt&&(!Ps||!ss)&&Bt("/")},[Ps,ss,Jt,Bt]),v.useEffect(()=>{Ct&&(Ee?ee():(async()=>{try{const[S,P,B]=await Promise.all([Rs(He(pe,"coreBuddyPBs",Ct.id)),Rs(He(pe,"coreBuddyTargets",Ct.id)),Rs(He(pe,"coreBuddyAchievements",Ct.id))]);S.exists()&&bt(S.data().exercises||{}),P.exists()&&nt(P.data().targets||{}),B.exists()&&ts(B.data())}catch(S){console.error("Error loading Core Buddy PBs:",S)}u(!1)})())},[Ct]);const ee=async()=>{try{const k=Ds(zt(pe,"personalBests"),hs("clientId","==",Ct.id)),P=(await Es(k)).docs.map(Qe=>({id:Qe.id,...Qe.data()}));P.sort((Qe,Xe)=>Qe.month.localeCompare(Xe.month)),i(P);const B=Ds(zt(pe,"personalBestTargets"),hs("clientId","==",Ct.id)),de=await Es(B);if(!de.empty){const Qe=de.docs[0].data();Le(Qe.targets||{}),R(Qe.metricTargets||{}),A(Qe.targets||{}),M(Qe.metricTargets||{})}const Be=Ds(zt(pe,"achievements"),hs("clientId","==",Ct.id)),ze=await Es(Be);ze.empty||gt(ze.docs[0].data().badges||[])}catch(k){console.error("Error fetching personal bests:",k)}u(!1)},ge=async()=>{if(!St||!ce||!Ct)return;const k=parseFloat(ce),S=Fe[St];if(!S||k<=S.weight){Ae("Target must be higher than current PB","error");return}p(!0);try{const P={...kt,[St]:{targetWeight:k,setAt:xt.now(),currentPBWhenSet:S.weight}};await Ns(He(pe,"coreBuddyTargets",Ct.id),{clientId:Ct.id,targets:P,updatedAt:xt.now()}),nt(P),at(null),Xt(""),Ae("Target set!","success")}catch(P){console.error("Error saving target:",P),Ae("Failed to save target","error")}p(!1)},we=k=>{if(!Wt?.badges)return!1;const S=kt[k];return S?Wt.badges.some(P=>P.type==="pb_target"&&P.exercise===k&&P.targetWeight===S.targetWeight):!1},Oe=k=>{const S=kt[k];if(!S)return null;const P=Fe[k];if(!P)return 0;const B=S.currentPBWhenSet||0,de=S.targetWeight,Be=de-B;return Be<=0?P.weight>=de?1:0:Math.max(0,Math.min((P.weight-B)/Be,1))},Ue=uP(),$e=t.find(k=>k.month===Ue),ft=t.filter(k=>k.month<Ue),jt=ft.length>0?ft[ft.length-1]:null;v.useEffect(()=>{$e?(ne($e.benchmarks||{}),oe($e.bodyMetrics||{})):(ne({}),oe({}))},[$e?.id]);const Q=async(k,S)=>{const P=[];if(k==="strength"?Aa.forEach(B=>{const de=be[B.key];if(!de)return;const Be=S[B.key];if(!Be)return;let ze;if(de.targetType==="time"){if(!de.targetValue)return;const Qe=de.startValue||0,Xe=Be.time||0,qt=de.targetValue-Qe;ze=qt===0?Xe>=de.targetValue?1:0:Math.max(0,(Xe-Qe)/qt)}else{if(!de.targetWeight&&!de.targetReps)return;const Qe=(de.startWeight||0)*(de.startReps||0),Xe=(de.targetWeight||0)*(de.targetReps||0),qt=(Be.weight||0)*(Be.reps||0),xs=Xe-Qe;ze=xs===0?qt>=Xe?1:0:Math.max(0,(qt-Qe)/xs)}if(ze>=1&&!(de.targetType==="time"?We.some(Xe=>Xe.type==="strength"&&Xe.key===B.key&&Xe.targetValue===de.targetValue):We.some(Xe=>Xe.type==="strength"&&Xe.key===B.key&&Xe.targetWeight===de.targetWeight&&Xe.targetReps===de.targetReps))){const Xe=de.targetType==="time"?`${B.name} ${de.targetValue}s`:`${B.name} ${de.targetWeight}kg  ${de.targetReps}`;P.push({type:"strength",key:B.key,...de.targetType==="time"?{targetType:"time",targetValue:de.targetValue}:{targetWeight:de.targetWeight,targetReps:de.targetReps},achievedMonth:Ue,label:Xe})}}):Lo.forEach(B=>{const de=Ce[B.key];if(!de||!de.targetValue)return;const Be=S[B.key];if(Be==null)return;const ze=de.startValue||0,Qe=de.targetValue,Xe=Qe-ze;(Xe===0?Be===Qe?1:0:Math.max(0,(Be-ze)/Xe))>=1&&(We.some(ls=>ls.type==="metric"&&ls.key===B.key&&ls.targetValue===Qe)||P.push({type:"metric",key:B.key,targetValue:Qe,achievedMonth:Ue,label:`${B.name} ${Qe}${B.suffix}`}))}),P.length>0){const B=[...We,...P];await Ns(He(pe,"achievements",Ct.id),{clientId:Ct.id,badges:B,updatedAt:xt.now()}),gt(B),me(P),setTimeout(()=>me(null),5e3)}},fe=(k,S)=>{if(k==="strength"){const P=be[S];return P?P.targetType==="time"?We.some(B=>B.type==="strength"&&B.key===S&&B.targetValue===P.targetValue):!P.targetWeight&&!P.targetReps?!1:We.some(B=>B.type==="strength"&&B.key===S&&B.targetWeight===P.targetWeight&&B.targetReps===P.targetReps):!1}else{const P=Ce[S];return!P||!P.targetValue?!1:We.some(B=>B.type==="metric"&&B.key===S&&B.targetValue===P.targetValue)}},lt=async()=>{p(!0);try{const k=`${Ct.id}_${Ue}`,S=$e||{};await Ns(He(pe,"personalBests",k),{clientId:Ct.id,month:Ue,benchmarks:U,bodyMetrics:S.bodyMetrics||Y||{},createdAt:S.createdAt||xt.now(),updatedAt:xt.now()}),await Q("strength",U),Ae("Benchmarks saved!","success"),j(!1),await ee()}catch(k){console.error("Error saving benchmarks:",k),Ae("Failed to save. Please try again.","error")}p(!1)},At=async()=>{p(!0);try{const k=`${Ct.id}_${Ue}`,S=$e||{};await Ns(He(pe,"personalBests",k),{clientId:Ct.id,month:Ue,benchmarks:S.benchmarks||U||{},bodyMetrics:Y,createdAt:S.createdAt||xt.now(),updatedAt:xt.now()}),await Q("metric",Y),Ae("Body metrics saved!","success"),V(!1),await ee()}catch(k){console.error("Error saving metrics:",k),Ae("Failed to save. Please try again.","error")}p(!1)},Tt=(k,S,P)=>{ne(B=>({...B,[k]:{...B[k],[S]:P===""?"":parseFloat(P)}}))},ns=(k,S)=>{oe(P=>({...P,[k]:S===""?"":parseFloat(S)}))},Ut=(k,S,P)=>{A(B=>({...B,[k]:{...B[k],[S]:P===""?"":parseFloat(P)}}))},Ot=async()=>{p(!0);try{const k=`targets_${Ct.id}`,S=$e?.benchmarks||{},P={};Aa.forEach(B=>{const de=S[B.key];B.unit==="time"?E[B.key]?.targetValue&&(P[B.key]={targetType:"time",targetValue:E[B.key].targetValue,startValue:de?.time||0}):(E[B.key]?.targetWeight||E[B.key]?.targetReps)&&(P[B.key]={targetWeight:E[B.key].targetWeight||0,targetReps:E[B.key].targetReps||0,startWeight:de?.weight||0,startReps:de?.reps||0})}),await Ns(He(pe,"personalBestTargets",k),{clientId:Ct.id,targets:P,metricTargets:Ce,updatedAt:xt.now()}),Le(P),A(P),Ae("Targets saved!","success"),F(!1)}catch(k){console.error("Error saving targets:",k),Ae("Failed to save targets.","error")}p(!1)},Ls=(k,S)=>{M(P=>({...P,[k]:{...P[k],targetValue:S===""?"":parseFloat(S)}}))},Js=async()=>{p(!0);try{const k=`targets_${Ct.id}`,S={};Lo.forEach(P=>{if(H[P.key]?.targetValue){const B=$e?.bodyMetrics?.[P.key]||0;S[P.key]={targetValue:H[P.key].targetValue,startValue:B}}}),await Ns(He(pe,"personalBestTargets",k),{clientId:Ct.id,targets:be,metricTargets:S,updatedAt:xt.now()}),R(S),M(S),Ae("Metric targets saved!","success"),D(!1)}catch(k){console.error("Error saving metric targets:",k),Ae("Failed to save targets.","error")}p(!1)},os=async()=>{if(window.confirm("Reset all goals? This will clear all strength and body metric targets. Your recorded benchmarks and measurements will NOT be affected.")){p(!0);try{const k=He(pe,"personalBestTargets",`targets_${Ct.id}`);await yr(k),Le({}),R({}),A({}),M({}),Ae("All goals have been reset","success")}catch(k){console.error("Error resetting targets:",k),Ae("Failed to reset goals","error")}p(!1)}},Ss=(k,S)=>{const P=be[k];if(!P||!S)return null;if(P.targetType==="time"){if(!P.targetValue)return null;const Qe=P.startValue||0,Xe=P.targetValue,qt=S.time||0,xs=Xe-Qe;return xs<=0?qt>=Xe?1:0:Math.max(0,Math.min((qt-Qe)/xs,1))}if(!P.targetWeight&&!P.targetReps)return null;const B=(P.startWeight||0)*(P.startReps||0),de=(P.targetWeight||0)*(P.targetReps||0),Be=(S.weight||0)*(S.reps||0),ze=de-B;return ze<=0?Be>=de?1:0:Math.max(0,Math.min((Be-B)/ze,1))},Os=k=>{const S=Ce[k];if(!S||!S.targetValue)return null;const P=$e?.bodyMetrics?.[k];if(P==null)return null;const B=S.startValue||0,de=S.targetValue,Be=de-B;return Be===0?P===de?1:0:Math.max(0,Math.min((P-B)/Be,1))},q=k=>{it.current=k.touches[0].clientX,st.current=0},xe=k=>{st.current=k.touches[0].clientX-it.current},je=()=>{st.current<-50?Ks(g+1):st.current>50&&Ks(g-1),st.current=0},Te=k=>{const S=$e?.bodyMetrics?.[k],P=jt?.bodyMetrics?.[k];return S==null||P==null?null:parseFloat((S-P).toFixed(2))},_e=t.find(k=>k.month===se),ct=t.find(k=>k.month===De);if(Jt||l)return r.jsxs("div",{className:"pb-page",children:[r.jsx("header",{className:"client-header",children:r.jsx("div",{className:"header-content",children:r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})})}),r.jsxs("main",{className:"pb-main",children:[r.jsx("div",{className:"skeleton skeleton-title",style:{width:180,height:28,marginBottom:20}}),r.jsx("div",{className:"skeleton skeleton-card-large",style:{height:320,borderRadius:16}})]})]});if(!Ps||!ss||!Ct)return null;if(Ee&&Ct?.isJunior)return r.jsx(oP,{});const ht=Aa[g],et=$e?.benchmarks?.[ht.key],vt=jt?.benchmarks?.[ht.key],Rt=Ol(ht,et),js=Ol(ht,vt),mn=tg(Rt,js),ln=Ss(ht.key,et),_n=ln!==null,kn=ln!==null&&ln>=1,fn=_n?Math.round(ln*60):Rt>0?15:0,Fs=be[ht.key];return r.jsx(xa,{children:r.jsxs("div",{className:"pb-page",children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>Bt(ue?"/client/core-buddy":"/client"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})]})}),r.jsxs("main",{className:"pb-main page-transition-enter",children:[r.jsxs("div",{className:"pb-intro anim-fade-up",children:[r.jsx("h2",{children:"Personal Bests"}),r.jsx("p",{children:Ee?"Track your strength benchmarks and body measurements each month.":"Your all-time best lifts from programme workouts."})]}),!Ee&&r.jsxs("div",{className:"pb-cb-section anim-fade-up-d2",children:[Object.keys(Fe).length===0?r.jsxs("div",{className:"pb-empty",children:[r.jsx("div",{className:"pb-cb-empty-icon",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M20.57 14.86L22 13.43 20.57 12 17 15.57 8.43 7 12 3.43 10.57 2 9.14 3.43 7.71 2 5.57 4.14 4.14 2.71 2.71 4.14l1.43 1.43L2 7.71l1.43 1.43L2 10.57 3.43 12 7 8.43 15.57 17 12 20.57 13.43 22l1.43-1.43L16.29 22l2.14-2.14 1.43 1.43 1.43-1.43-1.43-1.43L22 16.29z"})})}),r.jsx("h4",{children:"No personal bests yet"}),r.jsx("p",{children:"Complete weight-based workouts to start tracking your personal bests."})]}):r.jsx("div",{className:"pb-cb-grouped",children:(()=>{const k={},S=[];return Object.entries(Fe).forEach(([P,B])=>{const de=cP(P);de?(k[de]||(k[de]=[]),k[de].push([P,B])):S.push([P,B])}),Object.values(k).forEach(P=>P.sort(([B],[de])=>B.localeCompare(de))),S.sort(([P],[B])=>P.localeCompare(B)),r.jsxs(r.Fragment,{children:[lP.map(P=>{const B=k[P.key];if(!B||B.length===0)return null;const de=!!Gt[P.key],Be=B.reduce((ze,[,Qe])=>!ze||Qe.weight>ze.weight?Qe:ze,null);return r.jsxs("div",{className:`pb-cb-group ${de?"open":""}`,style:{"--group-color":P.color},children:[r.jsxs("button",{className:"pb-cb-group-header",onClick:()=>rt(ze=>({...ze,[P.key]:!ze[P.key]})),children:[r.jsx("div",{className:"pb-cb-group-accent"}),r.jsx("div",{className:"pb-cb-group-icon",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:r.jsx("path",{d:P.icon})})}),r.jsxs("div",{className:"pb-cb-group-text",children:[r.jsx("h3",{className:"pb-cb-group-label",children:P.label}),r.jsx("span",{className:"pb-cb-group-subtitle",children:P.subtitle})]}),r.jsxs("div",{className:"pb-cb-group-meta",children:[r.jsxs("span",{className:"pb-cb-group-count",children:[B.length," PB",B.length!==1?"s":""]}),Be&&r.jsxs("span",{className:"pb-cb-group-best",children:["Best: ",Be.weight,"kg"]})]}),r.jsx("svg",{className:`pb-cb-group-chevron ${de?"open":""}`,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M6 9l6 6 6-6"})})]}),r.jsx("div",{className:"pb-cb-group-body",style:{display:de?"block":"none"},children:r.jsx("div",{className:"pb-cb-grid",children:B.map(([ze,Qe],Xe)=>{const qt=kt[ze],xs=Oe(ze),ls=xs!==null&&xs>=1,cs=we(ze),Cs=xs!==null?Math.round(xs*60):60;return r.jsxs("div",{className:"pb-cb-card",style:{"--group-color":P.color,animationDelay:`${Xe*.05}s`},children:[r.jsxs("div",{className:"pb-cb-card-top",children:[r.jsxs("div",{className:"pb-cb-card-ring",children:[r.jsx("svg",{className:"pb-cb-ring-svg",viewBox:"0 0 80 80",children:w2.map((K,ve)=>{const te=ve<Cs;return r.jsx("line",{x1:K.x1,y1:K.y1,x2:K.x2,y2:K.y2,className:`pb-ring-tick ${te?ls?"hit":"filled":"empty"}`,style:te&&!ls?{stroke:P.color}:void 0,strokeWidth:K.thick?"2":"1.5"},ve)})}),r.jsx("div",{className:"pb-cb-ring-icon",style:{color:P.color},children:cs?r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",className:"pb-cb-badge-earned",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}):r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:r.jsx("path",{d:P.icon})})})]}),r.jsxs("div",{className:"pb-cb-card-info",children:[r.jsx("h4",{className:"pb-cb-card-name",children:ze}),r.jsxs("div",{className:"pb-cb-card-value",style:{color:P.color},children:[Qe.weight,"kg  ",Qe.reps]}),Qe.achievedAt&&r.jsx("div",{className:"pb-cb-card-date",children:(Qe.achievedAt.toDate?Qe.achievedAt.toDate():new Date(Qe.achievedAt)).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"})}),qt&&ls&&!cs&&r.jsx("div",{className:"pb-cb-target-info hit",children:"Target hit!"}),cs&&r.jsx("div",{className:"pb-cb-target-info earned",children:"Badge earned!"})]}),r.jsx("div",{className:"pb-cb-card-action",children:r.jsx("button",{className:"pb-cb-target-btn",style:{borderColor:P.color,background:`color-mix(in srgb, ${P.color} 10%, transparent)`,color:P.color},onClick:()=>{at(ze),Xt("")},children:qt?ls&&cs?r.jsx("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M12 5v14M5 12h14"})}):r.jsxs("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),r.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]}):r.jsxs("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("circle",{cx:"12",cy:"12",r:"6"}),r.jsx("circle",{cx:"12",cy:"12",r:"2"})]})})})]}),qt&&!ls&&r.jsxs("div",{className:"pb-cb-card-progress",children:[r.jsxs("div",{className:"pb-cb-progress-labels",children:[r.jsxs("span",{className:"pb-cb-progress-current",children:[Qe.weight,"kg"]}),r.jsxs("span",{className:"pb-cb-progress-target",style:{color:P.color},children:["Target: ",qt.targetWeight,"kg"]})]}),r.jsx("div",{className:"pb-cb-progress-bar",children:r.jsx("div",{className:"pb-cb-progress-bar-fill",style:{width:`${Math.round((xs||0)*100)}%`,background:P.color}})}),r.jsxs("div",{className:"pb-cb-progress-pct",style:{color:P.color},children:[Math.round((xs||0)*100),"%"]})]}),qt&&ls&&r.jsx("div",{className:"pb-cb-card-progress",children:r.jsx("div",{className:"pb-cb-progress-bar",children:r.jsx("div",{className:"pb-cb-progress-bar-fill hit",style:{width:"100%"}})})})]},ze)})})})]},P.key)}),S.length>0&&(()=>{const P=!!Gt.other;return r.jsxs("div",{className:`pb-cb-group ${P?"open":""}`,style:{"--group-color":"var(--text-tertiary)"},children:[r.jsxs("button",{className:"pb-cb-group-header",onClick:()=>rt(B=>({...B,other:!B.other})),children:[r.jsx("div",{className:"pb-cb-group-accent"}),r.jsx("div",{className:"pb-cb-group-icon",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:r.jsx("path",{d:"M20.57 14.86L22 13.43 20.57 12 17 15.57 8.43 7 12 3.43 10.57 2 9.14 3.43 7.71 2 5.57 4.14 4.14 2.71 2.71 4.14l1.43 1.43L2 7.71l1.43 1.43L2 10.57 3.43 12 7 8.43 15.57 17 12 20.57 13.43 22l1.43-1.43L16.29 22l2.14-2.14 1.43 1.43 1.43-1.43-1.43-1.43L22 16.29z"})})}),r.jsx("div",{className:"pb-cb-group-text",children:r.jsx("h3",{className:"pb-cb-group-label",children:"Other"})}),r.jsx("div",{className:"pb-cb-group-meta",children:r.jsxs("span",{className:"pb-cb-group-count",children:[S.length," PB",S.length!==1?"s":""]})}),r.jsx("svg",{className:`pb-cb-group-chevron ${P?"open":""}`,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M6 9l6 6 6-6"})})]}),r.jsx("div",{className:"pb-cb-group-body",style:{display:P?"block":"none"},children:r.jsx("div",{className:"pb-cb-grid",children:S.map(([B,de],Be)=>{const ze=kt[B],Qe=Oe(B),Xe=Qe!==null&&Qe>=1,qt=we(B),xs=Qe!==null?Math.round(Qe*60):60;return r.jsxs("div",{className:"pb-cb-card",style:{animationDelay:`${Be*.05}s`},children:[r.jsxs("div",{className:"pb-cb-card-top",children:[r.jsxs("div",{className:"pb-cb-card-ring",children:[r.jsx("svg",{className:"pb-cb-ring-svg",viewBox:"0 0 80 80",children:w2.map((ls,cs)=>{const Cs=cs<xs;return r.jsx("line",{x1:ls.x1,y1:ls.y1,x2:ls.x2,y2:ls.y2,className:`pb-ring-tick ${Cs?Xe?"hit":"filled":"empty"}`,strokeWidth:ls.thick?"2":"1.5"},cs)})}),r.jsx("div",{className:"pb-cb-ring-icon",children:qt?r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",className:"pb-cb-badge-earned",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}):r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M20.57 14.86L22 13.43 20.57 12 17 15.57 8.43 7 12 3.43 10.57 2 9.14 3.43 7.71 2 5.57 4.14 4.14 2.71 2.71 4.14l1.43 1.43L2 7.71l1.43 1.43L2 10.57 3.43 12 7 8.43 15.57 17 12 20.57 13.43 22l1.43-1.43L16.29 22l2.14-2.14 1.43 1.43 1.43-1.43-1.43-1.43L22 16.29z"})})})]}),r.jsxs("div",{className:"pb-cb-card-info",children:[r.jsx("h4",{className:"pb-cb-card-name",children:B}),r.jsxs("div",{className:"pb-cb-card-value",children:[de.weight,"kg  ",de.reps]}),de.achievedAt&&r.jsx("div",{className:"pb-cb-card-date",children:(de.achievedAt.toDate?de.achievedAt.toDate():new Date(de.achievedAt)).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"})}),ze&&Xe&&!qt&&r.jsx("div",{className:"pb-cb-target-info hit",children:"Target hit!"}),qt&&r.jsx("div",{className:"pb-cb-target-info earned",children:"Badge earned!"})]}),r.jsx("div",{className:"pb-cb-card-action",children:r.jsx("button",{className:"pb-cb-target-btn",onClick:()=>{at(B),Xt("")},children:ze?Xe&&qt?r.jsx("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M12 5v14M5 12h14"})}):r.jsxs("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),r.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]}):r.jsxs("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("circle",{cx:"12",cy:"12",r:"6"}),r.jsx("circle",{cx:"12",cy:"12",r:"2"})]})})})]}),ze&&!Xe&&r.jsxs("div",{className:"pb-cb-card-progress",children:[r.jsxs("div",{className:"pb-cb-progress-labels",children:[r.jsxs("span",{className:"pb-cb-progress-current",children:[de.weight,"kg"]}),r.jsxs("span",{className:"pb-cb-progress-target",children:["Target: ",ze.targetWeight,"kg"]})]}),r.jsx("div",{className:"pb-cb-progress-bar",children:r.jsx("div",{className:"pb-cb-progress-bar-fill",style:{width:`${Math.round((Qe||0)*100)}%`}})}),r.jsxs("div",{className:"pb-cb-progress-pct",children:[Math.round((Qe||0)*100),"%"]})]}),ze&&Xe&&r.jsx("div",{className:"pb-cb-card-progress",children:r.jsx("div",{className:"pb-cb-progress-bar",children:r.jsx("div",{className:"pb-cb-progress-bar-fill hit",style:{width:"100%"}})})})]},B)})})})]})})()]})})()}),Object.keys(Fe).length>0&&r.jsxs("button",{className:"pb-cb-achievements-link anim-fade-up-d4",onClick:()=>Bt("/client/core-buddy/achievements"),children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"18",height:"18",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),"View Achievements",r.jsx("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})]}),St&&r.jsx("div",{className:"pb-cb-target-modal-overlay",onClick:()=>at(null),children:r.jsxs("div",{className:"pb-cb-target-modal",onClick:k=>k.stopPropagation(),children:[r.jsx("h3",{children:"Set Target"}),r.jsx("p",{className:"pb-cb-target-exercise-name",children:St}),r.jsxs("div",{className:"pb-cb-target-current",children:["Current PB: ",r.jsxs("strong",{children:[Fe[St]?.weight,"kg"]})]}),r.jsxs("div",{className:"pb-cb-target-input-wrap",children:[r.jsx("label",{children:"Your target (kg)"}),r.jsx("input",{type:"number",inputMode:"decimal",step:"0.5",value:ce,onChange:k=>Xt(k.target.value),placeholder:String((Fe[St]?.weight||0)+5),className:"pb-cb-target-input",autoFocus:!0})]}),r.jsxs("div",{className:"pb-cb-target-actions",children:[r.jsx("button",{className:"pb-cancel-btn",onClick:()=>at(null),children:"Cancel"}),r.jsx("button",{className:"pb-save-btn",onClick:ge,disabled:d,children:d?"Saving...":"Set Target"})]})]})})]}),Ee&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"pb-tabs",children:[r.jsx("button",{className:`pb-tab ${n==="bests"?"active":""}`,onClick:()=>e("bests"),children:"Strength"}),r.jsx("button",{className:`pb-tab ${n==="metrics"?"active":""}`,onClick:()=>e("metrics"),children:"Body Metrics"}),r.jsx("button",{className:`pb-tab ${n==="history"?"active":""}`,onClick:()=>e("history"),children:"History"})]}),n==="bests"&&r.jsxs("div",{className:"pb-strength-section",children:[!w&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"pb-carousel",ref:pt,onTouchStart:q,onTouchMove:xe,onTouchEnd:je,children:[r.jsx("div",{className:`pb-ring-container slide-from-${Kt.current}`,children:r.jsxs("div",{className:"pb-ring",children:[r.jsx("svg",{className:"pb-ring-svg",viewBox:"0 0 200 200",children:Jy.map((k,S)=>{const P=S<Math.round(fn);return r.jsx("line",{x1:k.x1,y1:k.y1,x2:k.x2,y2:k.y2,className:`pb-ring-tick ${P?kn?"hit":"filled":"empty"}`,strokeWidth:k.thick?"3":"2"},S)})}),r.jsxs("div",{className:"pb-ring-center",children:[r.jsx("div",{className:"pb-ring-category",children:ht.category}),r.jsxs("div",{className:"pb-ring-exercise",children:[ht.name,fe("strength",ht.key)&&r.jsx("svg",{className:"pb-badge-icon",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})]}),r.jsx("div",{className:"pb-ring-value",children:et?ht.unit==="time"?mh(et.time):C2(et.weight,et.reps):"-"}),mn!==null&&r.jsxs("div",{className:`pb-ring-change ${mn>=0?"positive":"negative"}`,children:[mn>=0?"+":"",mn.toFixed(1),"%"]}),mn===null&&et&&r.jsx("div",{className:"pb-ring-change neutral",children:"New entry"}),Fs&&r.jsx("div",{className:`pb-ring-target ${kn?"hit":""}`,children:kn?"Target hit!":Fs.targetType==="time"?`${Fs.startValue||0}s  ${Fs.targetValue}s`:`${Fs.startWeight||0}kg${Fs.startReps||0}  ${Fs.targetWeight}kg${Fs.targetReps}`}),!Fs&&r.jsx("div",{className:"pb-ring-target none",children:"No target set"})]})]})},g),r.jsx("div",{className:"pb-carousel-dots",children:Aa.map((k,S)=>r.jsx("button",{className:`pb-dot ${S===g?"active":""}`,onClick:()=>Ks(S)},S))}),r.jsx("button",{className:"pb-carousel-arrow left",onClick:()=>Ks(g-1),disabled:g===0,children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"})})}),r.jsx("button",{className:"pb-carousel-arrow right",onClick:()=>Ks(g+1),disabled:g===Aa.length-1,children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M8.59 16.59L10 18l6-6-6-6-1.41 1.41L13.17 12z"})})})]}),r.jsxs("div",{className:"pb-trend-section",children:[r.jsx("h4",{children:"Trend"}),r.jsx(dP,{data:t,exerciseKey:ht.key,unit:ht.unit})]})]}),!w&&!W&&r.jsxs("div",{className:"pb-action-buttons",children:[r.jsx("button",{className:"pb-edit-btn",onClick:()=>j(!0),children:$e?.benchmarks?"Edit This Month's Benchmarks":"Add This Month's Benchmarks"}),r.jsx("button",{className:"pb-edit-btn pb-target-btn",onClick:()=>F(!0),children:Object.keys(be).length>0?"Edit Targets":"Set Targets"}),(Object.keys(be).length>0||Object.keys(Ce).length>0)&&r.jsx("button",{className:"pb-edit-btn pb-reset-btn",onClick:os,disabled:d,children:"Reset All Goals"})]}),w&&r.jsxs("div",{className:"pb-edit-card",children:[r.jsxs("div",{className:"pb-edit-header",children:[r.jsxs("h3",{children:["Benchmarks - ",pa(Ue)]}),r.jsx("button",{className:"pb-edit-close",onClick:()=>{j(!1),ne($e?.benchmarks||{})},children:""})]}),r.jsx("div",{className:"pb-edit-body",children:Aa.map(k=>r.jsxs("div",{className:"pb-edit-exercise",children:[r.jsx("div",{className:"pb-edit-exercise-name",children:k.name}),k.unit==="weight"?r.jsxs("div",{className:"pb-edit-row",children:[r.jsxs("div",{className:"pb-edit-field",children:[r.jsx("label",{children:"Weight (kg)"}),r.jsx("input",{type:"number",step:"0.5",value:U[k.key]?.weight??"",onChange:S=>Tt(k.key,"weight",S.target.value),placeholder:"0"})]}),r.jsxs("div",{className:"pb-edit-field",children:[r.jsx("label",{children:"Reps"}),r.jsx("input",{type:"number",value:U[k.key]?.reps??"",onChange:S=>Tt(k.key,"reps",S.target.value),placeholder:"0"})]})]}):r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsx("label",{children:"Time (seconds)"}),r.jsx("input",{type:"number",step:"0.01",value:U[k.key]?.time??"",onChange:S=>Tt(k.key,"time",S.target.value),placeholder:"0"})]})})]},k.key))}),r.jsxs("div",{className:"pb-edit-actions",children:[r.jsx("button",{className:"pb-cancel-btn",onClick:()=>{j(!1),ne($e?.benchmarks||{})},children:"Cancel"}),r.jsx("button",{className:"pb-save-btn",onClick:lt,disabled:d,children:d?"Saving...":"Save"})]})]}),W&&r.jsxs("div",{className:"pb-edit-card",children:[r.jsxs("div",{className:"pb-edit-header",children:[r.jsx("h3",{children:"Set Your Targets"}),r.jsx("button",{className:"pb-edit-close",onClick:()=>{F(!1),A(be)},children:""})]}),r.jsxs("div",{className:"pb-edit-body",children:[r.jsx("p",{className:"pb-target-hint",children:"Set a target for each exercise. Your current best is captured automatically from your latest benchmarks."}),Aa.map(k=>{const S=$e?.benchmarks?.[k.key];let P="-";return S&&(k.unit==="time"&&S.time?P=`${S.time}s`:(S.weight||S.reps)&&(P=`${S.weight||0}kg  ${S.reps||0}`)),r.jsxs("div",{className:"pb-edit-exercise",children:[r.jsxs("div",{className:"pb-edit-exercise-header",children:[r.jsx("div",{className:"pb-edit-exercise-name",children:k.name}),r.jsxs("div",{className:"pb-edit-current-best",children:["Current: ",P]})]}),k.unit==="weight"?r.jsxs("div",{className:"pb-edit-row",children:[r.jsxs("div",{className:"pb-edit-field",children:[r.jsx("label",{children:"Target Weight (kg)"}),r.jsx("input",{type:"number",step:"0.5",value:E[k.key]?.targetWeight??"",onChange:B=>Ut(k.key,"targetWeight",B.target.value),placeholder:"0"})]}),r.jsxs("div",{className:"pb-edit-field",children:[r.jsx("label",{children:"Target Reps"}),r.jsx("input",{type:"number",value:E[k.key]?.targetReps??"",onChange:B=>Ut(k.key,"targetReps",B.target.value),placeholder:"0"})]})]}):r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsx("label",{children:"Target (seconds)"}),r.jsx("input",{type:"number",step:"1",value:E[k.key]?.targetValue??"",onChange:B=>Ut(k.key,"targetValue",B.target.value),placeholder:"0"})]})})]},k.key)})]}),r.jsxs("div",{className:"pb-edit-actions",children:[r.jsx("button",{className:"pb-cancel-btn",onClick:()=>{F(!1),A(be)},children:"Cancel"}),r.jsx("button",{className:"pb-save-btn",onClick:Ot,disabled:d,children:d?"Saving...":"Save Targets"})]})]})]}),n==="metrics"&&r.jsxs("div",{className:"pb-metrics-section",children:[!T&&!O&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"pb-metrics-card",children:[r.jsx("h3",{children:"Body Measurements"}),r.jsx("p",{className:"pb-metrics-month",children:pa(Ue)}),r.jsx("div",{className:"pb-metrics-list",children:Lo.map(k=>{const S=$e?.bodyMetrics?.[k.key],P=Te(k.key),B=Ce[k.key],de=Os(k.key),Be=de!==null&&de>=1;return r.jsxs("div",{className:"pb-metric-row",children:[r.jsxs("div",{className:"pb-metric-top",children:[r.jsxs("div",{className:"pb-metric-left",children:[r.jsxs("span",{className:"pb-metric-name",children:[k.name,fe("metric",k.key)&&r.jsx("svg",{className:"pb-badge-icon-sm",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})]}),B&&r.jsxs("span",{className:"pb-metric-target-label",children:["Target: ",B.targetValue," ",k.suffix]})]}),r.jsxs("div",{className:"pb-metric-values",children:[r.jsx("span",{className:"pb-metric-current",children:S!=null?`${S} ${k.suffix}`:"-"}),P!==null&&r.jsxs("span",{className:`pb-metric-change ${P>0?"up":P<0?"down":"same"}`,children:[P>0?"+":"",P," ",k.suffix]})]})]}),de!==null&&r.jsxs("div",{className:"pb-metric-progress",children:[r.jsx("div",{className:"pb-metric-bar",children:r.jsx("div",{className:`pb-metric-bar-fill ${Be?"hit":""}`,style:{width:`${Math.round(de*100)}%`}})}),r.jsx("span",{className:`pb-metric-percent ${Be?"hit":""}`,children:Be?"Hit!":`${Math.round(de*100)}%`})]})]},k.key)})})]}),r.jsxs("div",{className:"pb-action-buttons",children:[r.jsx("button",{className:"pb-edit-btn",onClick:()=>V(!0),children:$e?.bodyMetrics?"Edit This Month's Measurements":"Add This Month's Measurements"}),r.jsx("button",{className:"pb-edit-btn pb-target-btn",onClick:()=>D(!0),children:Object.keys(Ce).length>0?"Edit Targets":"Set Targets"}),(Object.keys(be).length>0||Object.keys(Ce).length>0)&&r.jsx("button",{className:"pb-edit-btn pb-reset-btn",onClick:os,disabled:d,children:"Reset All Goals"})]})]}),T&&r.jsxs("div",{className:"pb-edit-card",children:[r.jsxs("div",{className:"pb-edit-header",children:[r.jsxs("h3",{children:["Measurements - ",pa(Ue)]}),r.jsx("button",{className:"pb-edit-close",onClick:()=>{V(!1),oe($e?.bodyMetrics||{})},children:""})]}),r.jsx("div",{className:"pb-edit-body",children:Lo.map(k=>r.jsx("div",{className:"pb-edit-metric",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsxs("label",{children:[k.name," (",k.suffix,")"]}),r.jsx("input",{type:"number",step:"0.1",value:Y[k.key]??"",onChange:S=>ns(k.key,S.target.value),placeholder:"0"})]})},k.key))}),r.jsxs("div",{className:"pb-edit-actions",children:[r.jsx("button",{className:"pb-cancel-btn",onClick:()=>{V(!1),oe($e?.bodyMetrics||{})},children:"Cancel"}),r.jsx("button",{className:"pb-save-btn",onClick:At,disabled:d,children:d?"Saving...":"Save"})]})]}),O&&r.jsxs("div",{className:"pb-edit-card",children:[r.jsxs("div",{className:"pb-edit-header",children:[r.jsx("h3",{children:"Body Metric Targets"}),r.jsx("button",{className:"pb-edit-close",onClick:()=>{D(!1),M(Ce)},children:""})]}),r.jsxs("div",{className:"pb-edit-body",children:[r.jsx("p",{className:"pb-target-hint",children:"Set targets for your body measurements. Your current measurement is captured automatically."}),Lo.map(k=>{const S=$e?.bodyMetrics?.[k.key];return r.jsxs("div",{className:"pb-edit-exercise",children:[r.jsxs("div",{className:"pb-edit-exercise-header",children:[r.jsx("div",{className:"pb-edit-exercise-name",children:k.name}),r.jsxs("div",{className:"pb-edit-current-best",children:["Current: ",S!=null?`${S} ${k.suffix}`:"-"]})]}),r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsxs("label",{children:["Target (",k.suffix,")"]}),r.jsx("input",{type:"number",step:"0.1",value:H[k.key]?.targetValue??"",onChange:P=>Ls(k.key,P.target.value),placeholder:"0"})]})})]},k.key)})]}),r.jsxs("div",{className:"pb-edit-actions",children:[r.jsx("button",{className:"pb-cancel-btn",onClick:()=>{D(!1),M(Ce)},children:"Cancel"}),r.jsx("button",{className:"pb-save-btn",onClick:Js,disabled:d,children:d?"Saving...":"Save Targets"})]})]})]}),n==="history"&&r.jsx("div",{className:"pb-history-section",children:t.length===0?r.jsxs("div",{className:"pb-empty",children:[r.jsx("h4",{children:"No records yet"}),r.jsx("p",{children:"Start adding your monthly benchmarks and measurements to track your progress over time."})]}):r.jsxs(r.Fragment,{children:[We.length>0&&r.jsxs("div",{className:"pb-achievements-wall",children:[r.jsxs("h4",{className:"pb-achievements-wall-title",children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"18",height:"18",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),"Targets Achieved"]}),r.jsx("div",{className:"pb-achievements-list",children:[...We].reverse().map((k,S)=>r.jsxs("div",{className:"pb-achievement-item",style:{animationDelay:`${S*.05}s`},children:[r.jsx("div",{className:"pb-achievement-star",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),r.jsxs("div",{className:"pb-achievement-info",children:[r.jsx("span",{className:"pb-achievement-label",children:k.label}),r.jsx("span",{className:"pb-achievement-date",children:pa(k.achievedMonth)})]})]},S))})]}),r.jsx("div",{className:"pb-history-controls",children:r.jsx("button",{className:`pb-compare-toggle ${J?"active":""}`,onClick:()=>{L(!J),!J&&t.length>=2&&(Me(t[0].month),Je(t[t.length-1].month))},children:J?"Back to Timeline":"Compare Months"})}),J?r.jsxs("div",{className:"pb-compare",children:[r.jsxs("div",{className:"pb-compare-selectors",children:[r.jsxs("div",{className:"pb-compare-select",children:[r.jsx("label",{children:"From"}),r.jsx("select",{value:se,onChange:k=>Me(k.target.value),children:t.map(k=>r.jsx("option",{value:k.month,children:pa(k.month)},k.month))})]}),r.jsx("div",{className:"pb-compare-vs",children:"vs"}),r.jsxs("div",{className:"pb-compare-select",children:[r.jsx("label",{children:"To"}),r.jsx("select",{value:De,onChange:k=>Je(k.target.value),children:t.map(k=>r.jsx("option",{value:k.month,children:pa(k.month)},k.month))})]})]}),_e&&ct&&r.jsxs("div",{className:"pb-compare-results",children:[r.jsxs("div",{className:"pb-compare-group",children:[r.jsx("h4",{children:"Strength Benchmarks"}),r.jsxs("div",{className:"pb-compare-table",children:[r.jsxs("div",{className:"pb-compare-header-row",children:[r.jsx("span",{children:"Exercise"}),r.jsx("span",{children:pa(se).split(" ")[0]}),r.jsx("span",{children:pa(De).split(" ")[0]}),r.jsx("span",{children:"Change"})]}),Aa.map(k=>{const S=_e.benchmarks?.[k.key],P=ct.benchmarks?.[k.key],B=Ol(k,S),de=Ol(k,P),Be=tg(de,B);return r.jsxs("div",{className:"pb-compare-row",children:[r.jsx("span",{className:"pb-compare-name",children:k.name}),r.jsx("span",{className:"pb-compare-val",children:S?k.unit==="time"?mh(S.time):`${S.weight}x${S.reps}`:"-"}),r.jsx("span",{className:"pb-compare-val",children:P?k.unit==="time"?mh(P.time):`${P.weight}x${P.reps}`:"-"}),r.jsx("span",{className:`pb-compare-change ${Be!==null?Be>=0?"positive":"negative":""}`,children:Be!==null?`${Be>=0?"+":""}${Be.toFixed(1)}%`:"-"})]},k.key)})]})]}),r.jsxs("div",{className:"pb-compare-group",children:[r.jsx("h4",{children:"Body Measurements"}),r.jsxs("div",{className:"pb-compare-table",children:[r.jsxs("div",{className:"pb-compare-header-row",children:[r.jsx("span",{children:"Measurement"}),r.jsx("span",{children:pa(se).split(" ")[0]}),r.jsx("span",{children:pa(De).split(" ")[0]}),r.jsx("span",{children:"Change"})]}),Lo.map(k=>{const S=_e.bodyMetrics?.[k.key],P=ct.bodyMetrics?.[k.key],B=S!=null&&P!=null?parseFloat((P-S).toFixed(2)):null;return r.jsxs("div",{className:"pb-compare-row",children:[r.jsx("span",{className:"pb-compare-name",children:k.name}),r.jsx("span",{className:"pb-compare-val",children:S!=null?`${S}`:"-"}),r.jsx("span",{className:"pb-compare-val",children:P!=null?`${P}`:"-"}),r.jsx("span",{className:`pb-compare-change ${B!==null?B>0?"positive":B<0?"negative":"neutral":""}`,children:B!==null?`${B>0?"+":""}${B} ${k.suffix}`:"-"})]},k.key)})]})]})]})]}):r.jsx("div",{className:"pb-timeline",children:[...t].reverse().map((k,S)=>{const P=t.find(B=>B.month<k.month&&t.indexOf(B)===t.indexOf(k)-1)||t.filter(B=>B.month<k.month).pop();return r.jsxs("div",{className:"pb-timeline-item",style:{animationDelay:`${S*.05}s`},children:[r.jsx("div",{className:"pb-timeline-dot"}),r.jsxs("div",{className:"pb-timeline-card",children:[r.jsx("h4",{children:pa(k.month)}),k.benchmarks&&Object.keys(k.benchmarks).length>0&&r.jsxs("div",{className:"pb-timeline-group",children:[r.jsx("h5",{children:"Strength Benchmarks"}),Aa.map(B=>{const de=k.benchmarks[B.key];if(!de)return null;const Be=P?.benchmarks?.[B.key],ze=Ol(B,de),Qe=Ol(B,Be),Xe=tg(ze,Qe);return r.jsxs("div",{className:"pb-timeline-row",children:[r.jsx("span",{className:"pb-timeline-label",children:B.name}),r.jsxs("div",{className:"pb-timeline-values",children:[r.jsx("span",{className:"pb-timeline-value",children:B.unit==="time"?mh(de.time):C2(de.weight,de.reps)}),Xe!==null&&r.jsxs("span",{className:`pb-timeline-change ${Xe>=0?"positive":"negative"}`,children:[Xe>=0?"+":"",Xe.toFixed(1),"%"]})]})]},B.key)})]}),k.bodyMetrics&&Object.keys(k.bodyMetrics).length>0&&r.jsxs("div",{className:"pb-timeline-group",children:[r.jsx("h5",{children:"Body Measurements"}),Lo.map(B=>{const de=k.bodyMetrics[B.key];if(de==null)return null;const Be=P?.bodyMetrics?.[B.key],ze=Be!=null?parseFloat((de-Be).toFixed(2)):null;return r.jsxs("div",{className:"pb-timeline-row",children:[r.jsx("span",{className:"pb-timeline-label",children:B.name}),r.jsxs("div",{className:"pb-timeline-values",children:[r.jsxs("span",{className:"pb-timeline-value",children:[de," ",B.suffix]}),ze!==null&&r.jsxs("span",{className:`pb-timeline-change ${ze>0?"positive":ze<0?"negative":"neutral"}`,children:[ze>0?"+":"",ze," ",B.suffix]})]})]},B.key)})]})]})]},k.id)})})]})})]})]}),$&&r.jsx("div",{className:"pb-celebration-overlay",onClick:()=>me(null),children:r.jsxs("div",{className:"pb-celebration-card",children:[r.jsx("div",{className:"pb-celebration-icon",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),r.jsx("h3",{className:"pb-celebration-title",children:$.length===1?"Target Achieved!":`${$.length} Targets Achieved!`}),r.jsx("div",{className:"pb-celebration-badges",children:$.map((k,S)=>r.jsx("div",{className:"pb-celebration-badge",children:k.label},S))}),r.jsx("p",{className:"pb-celebration-sub",children:"Tap to dismiss"})]})}),Ve&&r.jsxs("div",{className:`toast-notification ${Ve.type}`,children:[r.jsx("span",{className:"toast-icon",children:Ve.type==="success"?r.jsx("svg",{className:"success-check-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{className:"check-path",d:"M5 13 L9 17 L19 7"})}):r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})}),r.jsx("span",{className:"toast-message",children:Ve.message}),r.jsx("button",{className:"toast-close",onClick:()=>Ke(null),children:""})]}),Ee&&r.jsxs("nav",{className:"block-bottom-nav",children:[r.jsxs("button",{className:"block-nav-tab",onClick:()=>Bt("/client"),children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}),r.jsx("polyline",{points:"9 22 9 12 15 12 15 22"})]}),r.jsx("span",{children:"Home"})]}),r.jsxs("button",{className:"block-nav-tab",onClick:()=>Bt("/client/forms"),children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),r.jsx("polyline",{points:"14 2 14 8 20 8"}),r.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),r.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"})]}),r.jsx("span",{children:"Forms"})]}),r.jsxs("button",{className:"block-nav-tab",onClick:()=>Bt("/client/tools"),children:[r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"})}),r.jsx("span",{children:"Tools"})]}),r.jsxs("button",{className:"block-nav-tab active",children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M12 20V10"}),r.jsx("path",{d:"M18 20V4"}),r.jsx("path",{d:"M6 20v-4"})]}),r.jsx("span",{children:"PBs"})]}),Ct?.circuitAccess&&r.jsxs("button",{className:"block-nav-tab",onClick:()=>Bt("/client/circuit"),children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("path",{d:"M12 6v6l4 2"})]}),r.jsx("span",{children:"Circuit"})]})]}),ue&&r.jsx(aa,{active:"progress"})]})})}const mP=v.lazy(()=>wr(()=>import("./Dashboard-DOGuCa3k.js"),__vite__mapDeps([0,1]))),fP=v.lazy(()=>wr(()=>import("./AddClient-CvtG-fF2.js"),__vite__mapDeps([2,3]))),pP=v.lazy(()=>wr(()=>import("./ClientDashboard-DgQCdDtA.js"),[])),gP=v.lazy(()=>wr(()=>import("./ClientForms-BjrgJYv_.js"),__vite__mapDeps([4,5]))),yP=v.lazy(()=>wr(()=>import("./ClientTools-Deb-2sGs.js"),__vite__mapDeps([6,7]))),bP=v.lazy(()=>wr(()=>import("./MacroCalculator-CdzdCWSs.js"),__vite__mapDeps([8,7]))),vP=v.lazy(()=>wr(()=>import("./ProteinSnacks-DWLrntCz.js"),__vite__mapDeps([9,7]))),xP=v.lazy(()=>wr(()=>import("./DailyMotivation-DKDI59rT.js"),__vite__mapDeps([10,7]))),wP=v.lazy(()=>wr(()=>import("./CircuitDashboard-AWgEst_w.js"),__vite__mapDeps([11,12]))),_P=v.lazy(()=>wr(()=>import("./CircuitBooking-BD6VZOio.js"),__vite__mapDeps([13,14,12]))),kP=v.lazy(()=>wr(()=>import("./Leaderboard-BhZsi2OG.js"),__vite__mapDeps([15,16]))),jP=v.lazy(()=>wr(()=>import("./UpgradePage-CF9PdQsk.js"),__vite__mapDeps([17,18,19]))),TP=v.lazy(()=>wr(()=>import("./SignUp-BLxTRi8f.js"),[])),EP=v.lazy(()=>wr(()=>import("./Onboarding-Dx0oEWRu.js"),__vite__mapDeps([20,18,21])));function NP({children:n}){const{pathname:e}=_a();return v.useEffect(()=>{"scrollRestoration"in window.history&&(window.history.scrollRestoration="manual")},[]),v.useEffect(()=>{window.scrollTo({top:0,left:0,behavior:"instant"})},[e]),n}function SP(){const n=$n();return v.useEffect(()=>{const e=sessionStorage.getItem("redirect");if(e){sessionStorage.removeItem("redirect");const t=e.replace("/login","")||"/";n(t,{replace:!0})}},[n]),null}function CP(){return r.jsx(q3,{children:r.jsx(z3,{children:r.jsx(G3,{children:r.jsxs(XE,{basename:"/login",children:[r.jsx(SP,{}),r.jsx(NP,{children:r.jsx(v.Suspense,{fallback:null,children:r.jsxs(EE,{children:[r.jsx(Xs,{path:"/",element:r.jsx(Q3,{})}),r.jsx(Xs,{path:"/dashboard",element:r.jsx(mP,{})}),r.jsx(Xs,{path:"/add-client",element:r.jsx(fP,{})}),r.jsx(Xs,{path:"/client",element:r.jsx(pP,{})}),r.jsx(Xs,{path:"/client/forms",element:r.jsx(gP,{})}),r.jsx(Xs,{path:"/client/tools",element:r.jsx(yP,{})}),r.jsx(Xs,{path:"/client/tools/macros",element:r.jsx(bP,{})}),r.jsx(Xs,{path:"/client/tools/snacks",element:r.jsx(vP,{})}),r.jsx(Xs,{path:"/client/tools/motivation",element:r.jsx(xP,{})}),r.jsx(Xs,{path:"/client/personal-bests",element:r.jsx(hP,{})}),r.jsx(Xs,{path:"/client/circuit",element:r.jsx(wP,{})}),r.jsx(Xs,{path:"/client/circuit/booking",element:r.jsx(_P,{})}),r.jsx(Xs,{path:"/client/core-buddy",element:r.jsx(bD,{})}),r.jsx(Xs,{path:"/client/core-buddy/nutrition",element:r.jsx(Ml,{feature:"nutrition",children:r.jsx(wD,{})})}),r.jsx(Xs,{path:"/client/core-buddy/workouts",element:r.jsx(ID,{})}),r.jsx(Xs,{path:"/client/core-buddy/programmes",element:r.jsx(Ml,{feature:"programmes",children:r.jsx(OD,{})})}),r.jsx(Xs,{path:"/client/core-buddy/achievements",element:r.jsx(Ml,{feature:"achievements",children:r.jsx(qD,{})})}),r.jsx(Xs,{path:"/client/core-buddy/consistency",element:r.jsx(Ml,{feature:"consistency",children:r.jsx(QD,{})})}),r.jsx(Xs,{path:"/client/core-buddy/buddies",element:r.jsx(Ml,{feature:"buddies",children:r.jsx(XD,{})})}),r.jsx(Xs,{path:"/client/core-buddy/buddy",element:r.jsx(sP,{})}),r.jsx(Xs,{path:"/client/core-buddy/profile/:userId",element:r.jsx(tP,{})}),r.jsx(Xs,{path:"/client/leaderboard",element:r.jsx(Ml,{feature:"leaderboard",children:r.jsx(kP,{})})}),r.jsx(Xs,{path:"/signup",element:r.jsx(TP,{})}),r.jsx(Xs,{path:"/onboarding",element:r.jsx(EP,{})}),r.jsx(Xs,{path:"/upgrade",element:r.jsx(jP,{})}),r.jsx(Xs,{path:"*",element:r.jsx(jE,{to:"/",replace:!0})})]})})})]})})})})}TT.createRoot(document.getElementById("root")).render(r.jsx(v.StrictMode,{children:r.jsx(CP,{})}));"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/login/sw.js").catch(()=>{})});export{Hr as A,aa as C,xa as P,xt as T,hi as a,yr as b,zt as c,pe as d,He as e,qC as f,Es as g,KC as h,Ns as i,r as j,Rs as k,Mr as l,ka as m,$n as n,Gh as o,Jy as p,Ds as q,v as r,IP as s,wm as t,Ma as u,Y3 as v,hs as w,K3 as x,RP as y,sN as z};
