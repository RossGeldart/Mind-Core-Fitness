const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Dashboard-DV7WaCH9.js","assets/scheduleUtils-a2tn0x12.js","assets/Dashboard-BvdLF0uv.css","assets/AddClient-Dn9akOG3.js","assets/AddClient-DH1OFzHo.css","assets/ClientDashboard-BZvAmOBW.js","assets/ClientForms-BGhY2hT7.js","assets/ClientForms-GDNtnrAx.css","assets/ClientTools-B06CmPOm.js","assets/ClientTools-DQRPoST3.css","assets/MacroCalculator-oHTmOewN.js","assets/ProteinSnacks-BPa9i5e6.js","assets/DailyMotivation-BtHbUuF-.js","assets/CircuitDashboard-BNWSUDbt.js","assets/CircuitDashboard-C8T0uect.css","assets/CircuitBooking-BVfx0-yR.js","assets/CircuitBooking-ruk9Q4Wj.css","assets/Leaderboard-djfeKhWK.js","assets/Leaderboard-Dq-r5svP.css","assets/UpgradePage-CUv4l0q5.js","assets/UpgradePage-Blt11CID.css","assets/Onboarding-CqL0Yw5I.js","assets/Onboarding-Bku4iVdQ.css"])))=>i.map(i=>d[i]);
(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))i(l);new MutationObserver(l=>{for(const u of l)if(u.type==="childList")for(const d of u.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&i(d)}).observe(document,{childList:!0,subtree:!0});function t(l){const u={};return l.integrity&&(u.integrity=l.integrity),l.referrerPolicy&&(u.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?u.credentials="include":l.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function i(l){if(l.ep)return;l.ep=!0;const u=t(l);fetch(l.href,u)}})();var _p={exports:{}},eu={};var j1;function NT(){if(j1)return eu;j1=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(i,l,u){var d=null;if(u!==void 0&&(d=""+u),l.key!==void 0&&(d=""+l.key),"key"in l){u={};for(var p in l)p!=="key"&&(u[p]=l[p])}else u=l;return l=u.ref,{$$typeof:n,type:i,key:d,ref:l!==void 0?l:null,props:u}}return eu.Fragment=e,eu.jsx=t,eu.jsxs=t,eu}var T1;function CT(){return T1||(T1=1,_p.exports=NT()),_p.exports}var r=CT(),kp={exports:{}},rs={};var S1;function RT(){if(S1)return rs;S1=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),l=Symbol.for("react.profiler"),u=Symbol.for("react.consumer"),d=Symbol.for("react.context"),p=Symbol.for("react.forward_ref"),g=Symbol.for("react.suspense"),y=Symbol.for("react.memo"),x=Symbol.for("react.lazy"),_=Symbol.for("react.activity"),j=Symbol.iterator;function O(P){return P===null||typeof P!="object"?null:(P=j&&P[j]||P["@@iterator"],typeof P=="function"?P:null)}var K={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},B=Object.assign,D={};function te(P,re,Fe){this.props=P,this.context=re,this.refs=D,this.updater=Fe||K}te.prototype.isReactComponent={},te.prototype.setState=function(P,re){if(typeof P!="object"&&typeof P!="function"&&P!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,P,re,"setState")},te.prototype.forceUpdate=function(P){this.updater.enqueueForceUpdate(this,P,"forceUpdate")};function Y(){}Y.prototype=te.prototype;function Z(P,re,Fe){this.props=P,this.context=re,this.refs=D,this.updater=Fe||K}var ke=Z.prototype=new Y;ke.constructor=Z,B(ke,te.prototype),ke.isPureReactComponent=!0;var Re=Array.isArray;function _e(){}var C={H:null,A:null,T:null,S:null},T=Object.prototype.hasOwnProperty;function M(P,re,Fe){var qe=Fe.ref;return{$$typeof:n,type:P,key:re,ref:qe!==void 0?qe:null,props:Fe}}function V(P,re){return M(P.type,re,P.props)}function I(P){return typeof P=="object"&&P!==null&&P.$$typeof===n}function L(P){var re={"=":"=0",":":"=2"};return"$"+P.replace(/[=:]/g,function(Fe){return re[Fe]})}var A=/\/+/g;function Le(P,re){return typeof P=="object"&&P!==null&&P.key!=null?L(""+P.key):re.toString(36)}function ht(P){switch(P.status){case"fulfilled":return P.value;case"rejected":throw P.reason;default:switch(typeof P.status=="string"?P.then(_e,_e):(P.status="pending",P.then(function(re){P.status==="pending"&&(P.status="fulfilled",P.value=re)},function(re){P.status==="pending"&&(P.status="rejected",P.reason=re)})),P.status){case"fulfilled":return P.value;case"rejected":throw P.reason}}throw P}function $(P,re,Fe,qe,Ve){var Me=typeof P;(Me==="undefined"||Me==="boolean")&&(P=null);var mt=!1;if(P===null)mt=!0;else switch(Me){case"bigint":case"string":case"number":mt=!0;break;case"object":switch(P.$$typeof){case n:case e:mt=!0;break;case x:return mt=P._init,$(mt(P._payload),re,Fe,qe,Ve)}}if(mt)return Ve=Ve(P),mt=qe===""?"."+Le(P,0):qe,Re(Ve)?(Fe="",mt!=null&&(Fe=mt.replace(A,"$&/")+"/"),$(Ve,re,Fe,"",function(es){return es})):Ve!=null&&(I(Ve)&&(Ve=V(Ve,Fe+(Ve.key==null||P&&P.key===Ve.key?"":(""+Ve.key).replace(A,"$&/")+"/")+mt)),re.push(Ve)),1;mt=0;var wt=qe===""?".":qe+":";if(Re(P))for(var ot=0;ot<P.length;ot++)qe=P[ot],Me=wt+Le(qe,ot),mt+=$(qe,re,Fe,Me,Ve);else if(ot=O(P),typeof ot=="function")for(P=ot.call(P),ot=0;!(qe=P.next()).done;)qe=qe.value,Me=wt+Le(qe,ot++),mt+=$(qe,re,Fe,Me,Ve);else if(Me==="object"){if(typeof P.then=="function")return $(ht(P),re,Fe,qe,Ve);throw re=String(P),Error("Objects are not valid as a React child (found: "+(re==="[object Object]"?"object with keys {"+Object.keys(P).join(", ")+"}":re)+"). If you meant to render a collection of children, use an array instead.")}return mt}function pe(P,re,Fe){if(P==null)return P;var qe=[],Ve=0;return $(P,qe,"","",function(Me){return re.call(Fe,Me,Ve++)}),qe}function Be(P){if(P._status===-1){var re=P._result;re=re(),re.then(function(Fe){(P._status===0||P._status===-1)&&(P._status=1,P._result=Fe)},function(Fe){(P._status===0||P._status===-1)&&(P._status=2,P._result=Fe)}),P._status===-1&&(P._status=0,P._result=re)}if(P._status===1)return P._result.default;throw P._result}var We=typeof reportError=="function"?reportError:function(P){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var re=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof P=="object"&&P!==null&&typeof P.message=="string"?String(P.message):String(P),error:P});if(!window.dispatchEvent(re))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",P);return}console.error(P)},J={map:pe,forEach:function(P,re,Fe){pe(P,function(){re.apply(this,arguments)},Fe)},count:function(P){var re=0;return pe(P,function(){re++}),re},toArray:function(P){return pe(P,function(re){return re})||[]},only:function(P){if(!I(P))throw Error("React.Children.only expected to receive a single React element child.");return P}};return rs.Activity=_,rs.Children=J,rs.Component=te,rs.Fragment=t,rs.Profiler=l,rs.PureComponent=Z,rs.StrictMode=i,rs.Suspense=g,rs.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=C,rs.__COMPILER_RUNTIME={__proto__:null,c:function(P){return C.H.useMemoCache(P)}},rs.cache=function(P){return function(){return P.apply(null,arguments)}},rs.cacheSignal=function(){return null},rs.cloneElement=function(P,re,Fe){if(P==null)throw Error("The argument must be a React element, but you passed "+P+".");var qe=B({},P.props),Ve=P.key;if(re!=null)for(Me in re.key!==void 0&&(Ve=""+re.key),re)!T.call(re,Me)||Me==="key"||Me==="__self"||Me==="__source"||Me==="ref"&&re.ref===void 0||(qe[Me]=re[Me]);var Me=arguments.length-2;if(Me===1)qe.children=Fe;else if(1<Me){for(var mt=Array(Me),wt=0;wt<Me;wt++)mt[wt]=arguments[wt+2];qe.children=mt}return M(P.type,Ve,qe)},rs.createContext=function(P){return P={$$typeof:d,_currentValue:P,_currentValue2:P,_threadCount:0,Provider:null,Consumer:null},P.Provider=P,P.Consumer={$$typeof:u,_context:P},P},rs.createElement=function(P,re,Fe){var qe,Ve={},Me=null;if(re!=null)for(qe in re.key!==void 0&&(Me=""+re.key),re)T.call(re,qe)&&qe!=="key"&&qe!=="__self"&&qe!=="__source"&&(Ve[qe]=re[qe]);var mt=arguments.length-2;if(mt===1)Ve.children=Fe;else if(1<mt){for(var wt=Array(mt),ot=0;ot<mt;ot++)wt[ot]=arguments[ot+2];Ve.children=wt}if(P&&P.defaultProps)for(qe in mt=P.defaultProps,mt)Ve[qe]===void 0&&(Ve[qe]=mt[qe]);return M(P,Me,Ve)},rs.createRef=function(){return{current:null}},rs.forwardRef=function(P){return{$$typeof:p,render:P}},rs.isValidElement=I,rs.lazy=function(P){return{$$typeof:x,_payload:{_status:-1,_result:P},_init:Be}},rs.memo=function(P,re){return{$$typeof:y,type:P,compare:re===void 0?null:re}},rs.startTransition=function(P){var re=C.T,Fe={};C.T=Fe;try{var qe=P(),Ve=C.S;Ve!==null&&Ve(Fe,qe),typeof qe=="object"&&qe!==null&&typeof qe.then=="function"&&qe.then(_e,We)}catch(Me){We(Me)}finally{re!==null&&Fe.types!==null&&(re.types=Fe.types),C.T=re}},rs.unstable_useCacheRefresh=function(){return C.H.useCacheRefresh()},rs.use=function(P){return C.H.use(P)},rs.useActionState=function(P,re,Fe){return C.H.useActionState(P,re,Fe)},rs.useCallback=function(P,re){return C.H.useCallback(P,re)},rs.useContext=function(P){return C.H.useContext(P)},rs.useDebugValue=function(){},rs.useDeferredValue=function(P,re){return C.H.useDeferredValue(P,re)},rs.useEffect=function(P,re){return C.H.useEffect(P,re)},rs.useEffectEvent=function(P){return C.H.useEffectEvent(P)},rs.useId=function(){return C.H.useId()},rs.useImperativeHandle=function(P,re,Fe){return C.H.useImperativeHandle(P,re,Fe)},rs.useInsertionEffect=function(P,re){return C.H.useInsertionEffect(P,re)},rs.useLayoutEffect=function(P,re){return C.H.useLayoutEffect(P,re)},rs.useMemo=function(P,re){return C.H.useMemo(P,re)},rs.useOptimistic=function(P,re){return C.H.useOptimistic(P,re)},rs.useReducer=function(P,re,Fe){return C.H.useReducer(P,re,Fe)},rs.useRef=function(P){return C.H.useRef(P)},rs.useState=function(P){return C.H.useState(P)},rs.useSyncExternalStore=function(P,re,Fe){return C.H.useSyncExternalStore(P,re,Fe)},rs.useTransition=function(){return C.H.useTransition()},rs.version="19.2.4",rs}var E1;function Bg(){return E1||(E1=1,kp.exports=RT()),kp.exports}var b=Bg(),jp={exports:{}},tu={},Tp={exports:{}},Sp={};var N1;function AT(){return N1||(N1=1,(function(n){function e($,pe){var Be=$.length;$.push(pe);e:for(;0<Be;){var We=Be-1>>>1,J=$[We];if(0<l(J,pe))$[We]=pe,$[Be]=J,Be=We;else break e}}function t($){return $.length===0?null:$[0]}function i($){if($.length===0)return null;var pe=$[0],Be=$.pop();if(Be!==pe){$[0]=Be;e:for(var We=0,J=$.length,P=J>>>1;We<P;){var re=2*(We+1)-1,Fe=$[re],qe=re+1,Ve=$[qe];if(0>l(Fe,Be))qe<J&&0>l(Ve,Fe)?($[We]=Ve,$[qe]=Be,We=qe):($[We]=Fe,$[re]=Be,We=re);else if(qe<J&&0>l(Ve,Be))$[We]=Ve,$[qe]=Be,We=qe;else break e}}return pe}function l($,pe){var Be=$.sortIndex-pe.sortIndex;return Be!==0?Be:$.id-pe.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var u=performance;n.unstable_now=function(){return u.now()}}else{var d=Date,p=d.now();n.unstable_now=function(){return d.now()-p}}var g=[],y=[],x=1,_=null,j=3,O=!1,K=!1,B=!1,D=!1,te=typeof setTimeout=="function"?setTimeout:null,Y=typeof clearTimeout=="function"?clearTimeout:null,Z=typeof setImmediate<"u"?setImmediate:null;function ke($){for(var pe=t(y);pe!==null;){if(pe.callback===null)i(y);else if(pe.startTime<=$)i(y),pe.sortIndex=pe.expirationTime,e(g,pe);else break;pe=t(y)}}function Re($){if(B=!1,ke($),!K)if(t(g)!==null)K=!0,_e||(_e=!0,L());else{var pe=t(y);pe!==null&&ht(Re,pe.startTime-$)}}var _e=!1,C=-1,T=5,M=-1;function V(){return D?!0:!(n.unstable_now()-M<T)}function I(){if(D=!1,_e){var $=n.unstable_now();M=$;var pe=!0;try{e:{K=!1,B&&(B=!1,Y(C),C=-1),O=!0;var Be=j;try{t:{for(ke($),_=t(g);_!==null&&!(_.expirationTime>$&&V());){var We=_.callback;if(typeof We=="function"){_.callback=null,j=_.priorityLevel;var J=We(_.expirationTime<=$);if($=n.unstable_now(),typeof J=="function"){_.callback=J,ke($),pe=!0;break t}_===t(g)&&i(g),ke($)}else i(g);_=t(g)}if(_!==null)pe=!0;else{var P=t(y);P!==null&&ht(Re,P.startTime-$),pe=!1}}break e}finally{_=null,j=Be,O=!1}pe=void 0}}finally{pe?L():_e=!1}}}var L;if(typeof Z=="function")L=function(){Z(I)};else if(typeof MessageChannel<"u"){var A=new MessageChannel,Le=A.port2;A.port1.onmessage=I,L=function(){Le.postMessage(null)}}else L=function(){te(I,0)};function ht($,pe){C=te(function(){$(n.unstable_now())},pe)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function($){$.callback=null},n.unstable_forceFrameRate=function($){0>$||125<$?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<$?Math.floor(1e3/$):5},n.unstable_getCurrentPriorityLevel=function(){return j},n.unstable_next=function($){switch(j){case 1:case 2:case 3:var pe=3;break;default:pe=j}var Be=j;j=pe;try{return $()}finally{j=Be}},n.unstable_requestPaint=function(){D=!0},n.unstable_runWithPriority=function($,pe){switch($){case 1:case 2:case 3:case 4:case 5:break;default:$=3}var Be=j;j=$;try{return pe()}finally{j=Be}},n.unstable_scheduleCallback=function($,pe,Be){var We=n.unstable_now();switch(typeof Be=="object"&&Be!==null?(Be=Be.delay,Be=typeof Be=="number"&&0<Be?We+Be:We):Be=We,$){case 1:var J=-1;break;case 2:J=250;break;case 5:J=1073741823;break;case 4:J=1e4;break;default:J=5e3}return J=Be+J,$={id:x++,callback:pe,priorityLevel:$,startTime:Be,expirationTime:J,sortIndex:-1},Be>We?($.sortIndex=Be,e(y,$),t(g)===null&&$===t(y)&&(B?(Y(C),C=-1):B=!0,ht(Re,Be-We))):($.sortIndex=J,e(g,$),K||O||(K=!0,_e||(_e=!0,L()))),$},n.unstable_shouldYield=V,n.unstable_wrapCallback=function($){var pe=j;return function(){var Be=j;j=pe;try{return $.apply(this,arguments)}finally{j=Be}}}})(Sp)),Sp}var C1;function MT(){return C1||(C1=1,Tp.exports=AT()),Tp.exports}var Ep={exports:{}},rr={};var R1;function IT(){if(R1)return rr;R1=1;var n=Bg();function e(g){var y="https://react.dev/errors/"+g;if(1<arguments.length){y+="?args[]="+encodeURIComponent(arguments[1]);for(var x=2;x<arguments.length;x++)y+="&args[]="+encodeURIComponent(arguments[x])}return"Minified React error #"+g+"; visit "+y+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var i={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},l=Symbol.for("react.portal");function u(g,y,x){var _=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:l,key:_==null?null:""+_,children:g,containerInfo:y,implementation:x}}var d=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function p(g,y){if(g==="font")return"";if(typeof y=="string")return y==="use-credentials"?y:""}return rr.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,rr.createPortal=function(g,y){var x=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!y||y.nodeType!==1&&y.nodeType!==9&&y.nodeType!==11)throw Error(e(299));return u(g,y,null,x)},rr.flushSync=function(g){var y=d.T,x=i.p;try{if(d.T=null,i.p=2,g)return g()}finally{d.T=y,i.p=x,i.d.f()}},rr.preconnect=function(g,y){typeof g=="string"&&(y?(y=y.crossOrigin,y=typeof y=="string"?y==="use-credentials"?y:"":void 0):y=null,i.d.C(g,y))},rr.prefetchDNS=function(g){typeof g=="string"&&i.d.D(g)},rr.preinit=function(g,y){if(typeof g=="string"&&y&&typeof y.as=="string"){var x=y.as,_=p(x,y.crossOrigin),j=typeof y.integrity=="string"?y.integrity:void 0,O=typeof y.fetchPriority=="string"?y.fetchPriority:void 0;x==="style"?i.d.S(g,typeof y.precedence=="string"?y.precedence:void 0,{crossOrigin:_,integrity:j,fetchPriority:O}):x==="script"&&i.d.X(g,{crossOrigin:_,integrity:j,fetchPriority:O,nonce:typeof y.nonce=="string"?y.nonce:void 0})}},rr.preinitModule=function(g,y){if(typeof g=="string")if(typeof y=="object"&&y!==null){if(y.as==null||y.as==="script"){var x=p(y.as,y.crossOrigin);i.d.M(g,{crossOrigin:x,integrity:typeof y.integrity=="string"?y.integrity:void 0,nonce:typeof y.nonce=="string"?y.nonce:void 0})}}else y==null&&i.d.M(g)},rr.preload=function(g,y){if(typeof g=="string"&&typeof y=="object"&&y!==null&&typeof y.as=="string"){var x=y.as,_=p(x,y.crossOrigin);i.d.L(g,x,{crossOrigin:_,integrity:typeof y.integrity=="string"?y.integrity:void 0,nonce:typeof y.nonce=="string"?y.nonce:void 0,type:typeof y.type=="string"?y.type:void 0,fetchPriority:typeof y.fetchPriority=="string"?y.fetchPriority:void 0,referrerPolicy:typeof y.referrerPolicy=="string"?y.referrerPolicy:void 0,imageSrcSet:typeof y.imageSrcSet=="string"?y.imageSrcSet:void 0,imageSizes:typeof y.imageSizes=="string"?y.imageSizes:void 0,media:typeof y.media=="string"?y.media:void 0})}},rr.preloadModule=function(g,y){if(typeof g=="string")if(y){var x=p(y.as,y.crossOrigin);i.d.m(g,{as:typeof y.as=="string"&&y.as!=="script"?y.as:void 0,crossOrigin:x,integrity:typeof y.integrity=="string"?y.integrity:void 0})}else i.d.m(g)},rr.requestFormReset=function(g){i.d.r(g)},rr.unstable_batchedUpdates=function(g,y){return g(y)},rr.useFormState=function(g,y,x){return d.H.useFormState(g,y,x)},rr.useFormStatus=function(){return d.H.useHostTransitionStatus()},rr.version="19.2.4",rr}var A1;function DT(){if(A1)return Ep.exports;A1=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Ep.exports=IT(),Ep.exports}var M1;function PT(){if(M1)return tu;M1=1;var n=MT(),e=Bg(),t=DT();function i(s){var a="https://react.dev/errors/"+s;if(1<arguments.length){a+="?args[]="+encodeURIComponent(arguments[1]);for(var o=2;o<arguments.length;o++)a+="&args[]="+encodeURIComponent(arguments[o])}return"Minified React error #"+s+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function l(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function u(s){var a=s,o=s;if(s.alternate)for(;a.return;)a=a.return;else{s=a;do a=s,(a.flags&4098)!==0&&(o=a.return),s=a.return;while(s)}return a.tag===3?o:null}function d(s){if(s.tag===13){var a=s.memoizedState;if(a===null&&(s=s.alternate,s!==null&&(a=s.memoizedState)),a!==null)return a.dehydrated}return null}function p(s){if(s.tag===31){var a=s.memoizedState;if(a===null&&(s=s.alternate,s!==null&&(a=s.memoizedState)),a!==null)return a.dehydrated}return null}function g(s){if(u(s)!==s)throw Error(i(188))}function y(s){var a=s.alternate;if(!a){if(a=u(s),a===null)throw Error(i(188));return a!==s?null:s}for(var o=s,c=a;;){var m=o.return;if(m===null)break;var f=m.alternate;if(f===null){if(c=m.return,c!==null){o=c;continue}break}if(m.child===f.child){for(f=m.child;f;){if(f===o)return g(m),s;if(f===c)return g(m),a;f=f.sibling}throw Error(i(188))}if(o.return!==c.return)o=m,c=f;else{for(var w=!1,N=m.child;N;){if(N===o){w=!0,o=m,c=f;break}if(N===c){w=!0,c=m,o=f;break}N=N.sibling}if(!w){for(N=f.child;N;){if(N===o){w=!0,o=f,c=m;break}if(N===c){w=!0,c=f,o=m;break}N=N.sibling}if(!w)throw Error(i(189))}}if(o.alternate!==c)throw Error(i(190))}if(o.tag!==3)throw Error(i(188));return o.stateNode.current===o?s:a}function x(s){var a=s.tag;if(a===5||a===26||a===27||a===6)return s;for(s=s.child;s!==null;){if(a=x(s),a!==null)return a;s=s.sibling}return null}var _=Object.assign,j=Symbol.for("react.element"),O=Symbol.for("react.transitional.element"),K=Symbol.for("react.portal"),B=Symbol.for("react.fragment"),D=Symbol.for("react.strict_mode"),te=Symbol.for("react.profiler"),Y=Symbol.for("react.consumer"),Z=Symbol.for("react.context"),ke=Symbol.for("react.forward_ref"),Re=Symbol.for("react.suspense"),_e=Symbol.for("react.suspense_list"),C=Symbol.for("react.memo"),T=Symbol.for("react.lazy"),M=Symbol.for("react.activity"),V=Symbol.for("react.memo_cache_sentinel"),I=Symbol.iterator;function L(s){return s===null||typeof s!="object"?null:(s=I&&s[I]||s["@@iterator"],typeof s=="function"?s:null)}var A=Symbol.for("react.client.reference");function Le(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===A?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case B:return"Fragment";case te:return"Profiler";case D:return"StrictMode";case Re:return"Suspense";case _e:return"SuspenseList";case M:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case K:return"Portal";case Z:return s.displayName||"Context";case Y:return(s._context.displayName||"Context")+".Consumer";case ke:var a=s.render;return s=s.displayName,s||(s=a.displayName||a.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case C:return a=s.displayName||null,a!==null?a:Le(s.type)||"Memo";case T:a=s._payload,s=s._init;try{return Le(s(a))}catch{}}return null}var ht=Array.isArray,$=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,pe=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Be={pending:!1,data:null,method:null,action:null},We=[],J=-1;function P(s){return{current:s}}function re(s){0>J||(s.current=We[J],We[J]=null,J--)}function Fe(s,a){J++,We[J]=s.current,s.current=a}var qe=P(null),Ve=P(null),Me=P(null),mt=P(null);function wt(s,a){switch(Fe(Me,a),Fe(Ve,s),Fe(qe,null),a.nodeType){case 9:case 11:s=(s=a.documentElement)&&(s=s.namespaceURI)?G0(s):0;break;default:if(s=a.tagName,a=a.namespaceURI)a=G0(a),s=K0(a,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}re(qe),Fe(qe,s)}function ot(){re(qe),re(Ve),re(Me)}function es(s){s.memoizedState!==null&&Fe(mt,s);var a=qe.current,o=K0(a,s.type);a!==o&&(Fe(Ve,s),Fe(qe,o))}function Ns(s){Ve.current===s&&(re(qe),re(Ve)),mt.current===s&&(re(mt),Qc._currentValue=Be)}var Ft,Tt;function oe(s){if(Ft===void 0)try{throw Error()}catch(o){var a=o.stack.trim().match(/\n( *(at )?)/);Ft=a&&a[1]||"",Tt=-1<o.stack.indexOf(`
    at`)?" (<anonymous>)":-1<o.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Ft+s+Tt}var Dt=!1;function Nt(s,a){if(!s||Dt)return"";Dt=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var c={DetermineComponentFrameRoot:function(){try{if(a){var ze=function(){throw Error()};if(Object.defineProperty(ze.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ze,[])}catch(we){var fe=we}Reflect.construct(s,[],ze)}else{try{ze.call()}catch(we){fe=we}s.call(ze.prototype)}}else{try{throw Error()}catch(we){fe=we}(ze=s())&&typeof ze.catch=="function"&&ze.catch(function(){})}}catch(we){if(we&&fe&&typeof we.stack=="string")return[we.stack,fe.stack]}return[null,null]}};c.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var m=Object.getOwnPropertyDescriptor(c.DetermineComponentFrameRoot,"name");m&&m.configurable&&Object.defineProperty(c.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var f=c.DetermineComponentFrameRoot(),w=f[0],N=f[1];if(w&&N){var H=w.split(`
`),he=N.split(`
`);for(m=c=0;c<H.length&&!H[c].includes("DetermineComponentFrameRoot");)c++;for(;m<he.length&&!he[m].includes("DetermineComponentFrameRoot");)m++;if(c===H.length||m===he.length)for(c=H.length-1,m=he.length-1;1<=c&&0<=m&&H[c]!==he[m];)m--;for(;1<=c&&0<=m;c--,m--)if(H[c]!==he[m]){if(c!==1||m!==1)do if(c--,m--,0>m||H[c]!==he[m]){var Ne=`
`+H[c].replace(" at new "," at ");return s.displayName&&Ne.includes("<anonymous>")&&(Ne=Ne.replace("<anonymous>",s.displayName)),Ne}while(1<=c&&0<=m);break}}}finally{Dt=!1,Error.prepareStackTrace=o}return(o=s?s.displayName||s.name:"")?oe(o):""}function Kt(s,a){switch(s.tag){case 26:case 27:case 5:return oe(s.type);case 16:return oe("Lazy");case 13:return s.child!==a&&a!==null?oe("Suspense Fallback"):oe("Suspense");case 19:return oe("SuspenseList");case 0:case 15:return Nt(s.type,!1);case 11:return Nt(s.type.render,!1);case 1:return Nt(s.type,!0);case 31:return oe("Activity");default:return""}}function Et(s){try{var a="",o=null;do a+=Kt(s,o),o=s,s=s.return;while(s);return a}catch(c){return`
Error generating stack: `+c.message+`
`+c.stack}}var Ct=Object.prototype.hasOwnProperty,lt=n.unstable_scheduleCallback,Ot=n.unstable_cancelCallback,Wt=n.unstable_shouldYield,ms=n.unstable_requestPaint,Gt=n.unstable_now,Pt=n.unstable_getCurrentPriorityLevel,us=n.unstable_ImmediatePriority,xs=n.unstable_UserBlockingPriority,is=n.unstable_NormalPriority,Qs=n.unstable_LowPriority,Ms=n.unstable_IdlePriority,Fs=n.log,os=n.unstable_setDisableYieldValue,ws=null,be=null;function Ie(s){if(typeof Fs=="function"&&os(s),be&&typeof be.setStrictMode=="function")try{be.setStrictMode(ws,s)}catch{}}var De=Math.clz32?Math.clz32:at,rt=Math.log,Ke=Math.LN2;function at(s){return s>>>=0,s===0?32:31-(rt(s)/Ke|0)|0}var gt=256,X=262144,se=4194304;function Qe(s){var a=s&42;if(a!==0)return a;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return s&261888;case 262144:case 524288:case 1048576:case 2097152:return s&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function _t(s,a,o){var c=s.pendingLanes;if(c===0)return 0;var m=0,f=s.suspendedLanes,w=s.pingedLanes;s=s.warmLanes;var N=c&134217727;return N!==0?(c=N&~f,c!==0?m=Qe(c):(w&=N,w!==0?m=Qe(w):o||(o=N&~s,o!==0&&(m=Qe(o))))):(N=c&~f,N!==0?m=Qe(N):w!==0?m=Qe(w):o||(o=c&~s,o!==0&&(m=Qe(o)))),m===0?0:a!==0&&a!==m&&(a&f)===0&&(f=m&-m,o=a&-a,f>=o||f===32&&(o&4194048)!==0)?a:m}function et(s,a){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&a)===0}function kt(s,a){switch(s){case 1:case 2:case 4:case 8:case 64:return a+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Q(){var s=se;return se<<=1,(se&62914560)===0&&(se=4194304),s}function Ae(s){for(var a=[],o=0;31>o;o++)a.push(s);return a}function Je(s,a){s.pendingLanes|=a,a!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function yt(s,a,o,c,m,f){var w=s.pendingLanes;s.pendingLanes=o,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=o,s.entangledLanes&=o,s.errorRecoveryDisabledLanes&=o,s.shellSuspendCounter=0;var N=s.entanglements,H=s.expirationTimes,he=s.hiddenUpdates;for(o=w&~o;0<o;){var Ne=31-De(o),ze=1<<Ne;N[Ne]=0,H[Ne]=-1;var fe=he[Ne];if(fe!==null)for(he[Ne]=null,Ne=0;Ne<fe.length;Ne++){var we=fe[Ne];we!==null&&(we.lane&=-536870913)}o&=~ze}c!==0&&it(s,c,0),f!==0&&m===0&&s.tag!==0&&(s.suspendedLanes|=f&~(w&~a))}function it(s,a,o){s.pendingLanes|=a,s.suspendedLanes&=~a;var c=31-De(a);s.entangledLanes|=a,s.entanglements[c]=s.entanglements[c]|1073741824|o&261930}function Jt(s,a){var o=s.entangledLanes|=a;for(s=s.entanglements;o;){var c=31-De(o),m=1<<c;m&a|s[c]&a&&(s[c]|=a),o&=~m}}function Yt(s,a){var o=a&-a;return o=(o&42)!==0?1:F(o),(o&(s.suspendedLanes|a))!==0?0:o}function F(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function ye(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function Ee(){var s=pe.p;return s!==0?s:(s=window.event,s===void 0?32:y1(s.type))}function Te(s,a){var o=pe.p;try{return pe.p=s,a()}finally{pe.p=o}}var Se=Math.random().toString(36).slice(2),bt="__reactFiber$"+Se,At="__reactProps$"+Se,ft="__reactContainer$"+Se,zt="__reactEvents$"+Se,Bt="__reactListeners$"+Se,Ps="__reactHandles$"+Se,hn="__reactResources$"+Se,tn="__reactMarker$"+Se;function En(s){delete s[bt],delete s[At],delete s[zt],delete s[Bt],delete s[Ps]}function zs(s){var a=s[bt];if(a)return a;for(var o=s.parentNode;o;){if(a=o[ft]||o[bt]){if(o=a.alternate,a.child!==null||o!==null&&o.child!==null)for(s=t1(s);s!==null;){if(o=s[bt])return o;s=t1(s)}return a}s=o,o=s.parentNode}return null}function sn(s){if(s=s[bt]||s[ft]){var a=s.tag;if(a===5||a===6||a===13||a===31||a===26||a===27||a===3)return s}return null}function hs(s){var a=s.tag;if(a===5||a===26||a===27||a===6)return s.stateNode;throw Error(i(33))}function G(s){var a=s[hn];return a||(a=s[hn]={hoistableStyles:new Map,hoistableScripts:new Map}),a}function me(s){s[tn]=!0}var ae=new Set,xe={};function E(s,a){z(s,a),z(s+"Capture",a)}function z(s,a){for(xe[s]=a,s=0;s<a.length;s++)ae.add(a[s])}var ie=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),ne={},Ze={};function nt(s){return Ct.call(Ze,s)?!0:Ct.call(ne,s)?!1:ie.test(s)?Ze[s]=!0:(ne[s]=!0,!1)}function ct(s,a,o){if(nt(a))if(o===null)s.removeAttribute(a);else{switch(typeof o){case"undefined":case"function":case"symbol":s.removeAttribute(a);return;case"boolean":var c=a.toLowerCase().slice(0,5);if(c!=="data-"&&c!=="aria-"){s.removeAttribute(a);return}}s.setAttribute(a,""+o)}}function Lt(s,a,o){if(o===null)s.removeAttribute(a);else{switch(typeof o){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(a);return}s.setAttribute(a,""+o)}}function xt(s,a,o,c){if(c===null)s.removeAttribute(o);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(o);return}s.setAttributeNS(a,o,""+c)}}function fs(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function nn(s){var a=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(a==="checkbox"||a==="radio")}function Dr(s,a,o){var c=Object.getOwnPropertyDescriptor(s.constructor.prototype,a);if(!s.hasOwnProperty(a)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var m=c.get,f=c.set;return Object.defineProperty(s,a,{configurable:!0,get:function(){return m.call(this)},set:function(w){o=""+w,f.call(this,w)}}),Object.defineProperty(s,a,{enumerable:c.enumerable}),{getValue:function(){return o},setValue:function(w){o=""+w},stopTracking:function(){s._valueTracker=null,delete s[a]}}}}function ps(s){if(!s._valueTracker){var a=nn(s)?"checked":"value";s._valueTracker=Dr(s,a,""+s[a])}}function ur(s){if(!s)return!1;var a=s._valueTracker;if(!a)return!0;var o=a.getValue(),c="";return s&&(c=nn(s)?s.checked?"true":"false":s.value),s=c,s!==o?(a.setValue(s),!0):!1}function dr(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var ua=/[\n"\\]/g;function Nn(s){return s.replace(ua,function(a){return"\\"+a.charCodeAt(0).toString(16)+" "})}function Ra(s,a,o,c,m,f,w,N){s.name="",w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"?s.type=w:s.removeAttribute("type"),a!=null?w==="number"?(a===0&&s.value===""||s.value!=a)&&(s.value=""+fs(a)):s.value!==""+fs(a)&&(s.value=""+fs(a)):w!=="submit"&&w!=="reset"||s.removeAttribute("value"),a!=null?Yr(s,w,fs(a)):o!=null?Yr(s,w,fs(o)):c!=null&&s.removeAttribute("value"),m==null&&f!=null&&(s.defaultChecked=!!f),m!=null&&(s.checked=m&&typeof m!="function"&&typeof m!="symbol"),N!=null&&typeof N!="function"&&typeof N!="symbol"&&typeof N!="boolean"?s.name=""+fs(N):s.removeAttribute("name")}function Ri(s,a,o,c,m,f,w,N){if(f!=null&&typeof f!="function"&&typeof f!="symbol"&&typeof f!="boolean"&&(s.type=f),a!=null||o!=null){if(!(f!=="submit"&&f!=="reset"||a!=null)){ps(s);return}o=o!=null?""+fs(o):"",a=a!=null?""+fs(a):o,N||a===s.value||(s.value=a),s.defaultValue=a}c=c??m,c=typeof c!="function"&&typeof c!="symbol"&&!!c,s.checked=N?s.checked:!!c,s.defaultChecked=!!c,w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"&&(s.name=w),ps(s)}function Yr(s,a,o){a==="number"&&dr(s.ownerDocument)===s||s.defaultValue===""+o||(s.defaultValue=""+o)}function hr(s,a,o,c){if(s=s.options,a){a={};for(var m=0;m<o.length;m++)a["$"+o[m]]=!0;for(o=0;o<s.length;o++)m=a.hasOwnProperty("$"+s[o].value),s[o].selected!==m&&(s[o].selected=m),m&&c&&(s[o].defaultSelected=!0)}else{for(o=""+fs(o),a=null,m=0;m<s.length;m++){if(s[m].value===o){s[m].selected=!0,c&&(s[m].defaultSelected=!0);return}a!==null||s[m].disabled||(a=s[m])}a!==null&&(a.selected=!0)}}function Xa(s,a,o){if(a!=null&&(a=""+fs(a),a!==s.value&&(s.value=a),o==null)){s.defaultValue!==a&&(s.defaultValue=a);return}s.defaultValue=o!=null?""+fs(o):""}function Pr(s,a,o,c){if(a==null){if(c!=null){if(o!=null)throw Error(i(92));if(ht(c)){if(1<c.length)throw Error(i(93));c=c[0]}o=c}o==null&&(o=""),a=o}o=fs(a),s.defaultValue=o,c=s.textContent,c===o&&c!==""&&c!==null&&(s.value=c),ps(s)}function Un(s,a){if(a){var o=s.firstChild;if(o&&o===s.lastChild&&o.nodeType===3){o.nodeValue=a;return}}s.textContent=a}var Ai=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Ja(s,a,o){var c=a.indexOf("--")===0;o==null||typeof o=="boolean"||o===""?c?s.setProperty(a,""):a==="float"?s.cssFloat="":s[a]="":c?s.setProperty(a,o):typeof o!="number"||o===0||Ai.has(a)?a==="float"?s.cssFloat=o:s[a]=(""+o).trim():s[a]=o+"px"}function _r(s,a,o){if(a!=null&&typeof a!="object")throw Error(i(62));if(s=s.style,o!=null){for(var c in o)!o.hasOwnProperty(c)||a!=null&&a.hasOwnProperty(c)||(c.indexOf("--")===0?s.setProperty(c,""):c==="float"?s.cssFloat="":s[c]="");for(var m in a)c=a[m],a.hasOwnProperty(m)&&o[m]!==c&&Ja(s,m,c)}else for(var f in a)a.hasOwnProperty(f)&&Ja(s,f,a[f])}function Aa(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Mi=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Qr=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Lr(s){return Qr.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}function Fn(){}var zn=null;function fn(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var Or=null,mr=null;function da(s){var a=sn(s);if(a&&(s=a.stateNode)){var o=s[At]||null;e:switch(s=a.stateNode,a.type){case"input":if(Ra(s,o.value,o.defaultValue,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name),a=o.name,o.type==="radio"&&a!=null){for(o=s;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll('input[name="'+Nn(""+a)+'"][type="radio"]'),a=0;a<o.length;a++){var c=o[a];if(c!==s&&c.form===s.form){var m=c[At]||null;if(!m)throw Error(i(90));Ra(c,m.value,m.defaultValue,m.defaultValue,m.checked,m.defaultChecked,m.type,m.name)}}for(a=0;a<o.length;a++)c=o[a],c.form===s.form&&ur(c)}break e;case"textarea":Xa(s,o.value,o.defaultValue);break e;case"select":a=o.value,a!=null&&hr(s,!!o.multiple,a,!1)}}}var sr=!1;function q(s,a,o){if(sr)return s(a,o);sr=!0;try{var c=s(a);return c}finally{if(sr=!1,(Or!==null||mr!==null)&&(Ld(),Or&&(a=Or,s=mr,mr=Or=null,da(a),s)))for(a=0;a<s.length;a++)da(s[a])}}function ue(s,a){var o=s.stateNode;if(o===null)return null;var c=o[At]||null;if(c===null)return null;o=c[a];e:switch(a){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(c=!c.disabled)||(s=s.type,c=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!c;break e;default:s=!1}if(s)return null;if(o&&typeof o!="function")throw Error(i(231,a,typeof o));return o}var de=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Ue=!1;if(de)try{var Ce={};Object.defineProperty(Ce,"passive",{get:function(){Ue=!0}}),window.addEventListener("test",Ce,Ce),window.removeEventListener("test",Ce,Ce)}catch{Ue=!1}var st=null,vt=null,qt=null;function ss(){if(qt)return qt;var s,a=vt,o=a.length,c,m="value"in st?st.value:st.textContent,f=m.length;for(s=0;s<o&&a[s]===m[s];s++);var w=o-s;for(c=1;c<=w&&a[o-c]===m[f-c];c++);return qt=m.slice(s,1<c?1-c:void 0)}function S(s){var a=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&a===13&&(s=13)):s=a,s===10&&(s=13),32<=s||s===13?s:0}function U(){return!0}function je(){return!1}function Ye(s){function a(o,c,m,f,w){this._reactName=o,this._targetInst=m,this.type=c,this.nativeEvent=f,this.target=w,this.currentTarget=null;for(var N in s)s.hasOwnProperty(N)&&(o=s[N],this[N]=o?o(f):f[N]);return this.isDefaultPrevented=(f.defaultPrevented!=null?f.defaultPrevented:f.returnValue===!1)?U:je,this.isPropagationStopped=je,this}return _(a.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=U)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=U)},persist:function(){},isPersistent:U}),a}var He={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},tt=Ye(He),Ge=_({},He,{view:0,detail:0}),ut=Ye(Ge),St,ns,Zt,ys=_({},Ge,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ma,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==Zt&&(Zt&&s.type==="mousemove"?(St=s.screenX-Zt.screenX,ns=s.screenY-Zt.screenY):ns=St=0,Zt=s),St)},movementY:function(s){return"movementY"in s?s.movementY:ns}}),rn=Ye(ys),ln=_({},ys,{dataTransfer:0}),Bs=Ye(ln),Zs=_({},Ge,{relatedTarget:0}),_n=Ye(Zs),pn=_({},He,{animationName:0,elapsedTime:0,pseudoElement:0}),$n=Ye(pn),Wn=_({},He,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),kr=Ye(Wn),fr=_({},He,{data:0}),gn=Ye(fr),Ln={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},jr={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Tr={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function So(s){var a=this.nativeEvent;return a.getModifierState?a.getModifierState(s):(s=Tr[s])?!!a[s]:!1}function Ma(){return So}var Gn=_({},Ge,{key:function(s){if(s.key){var a=Ln[s.key]||s.key;if(a!=="Unidentified")return a}return s.type==="keypress"?(s=S(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?jr[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ma,charCode:function(s){return s.type==="keypress"?S(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?S(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),Za=Ye(Gn),ha=_({},ys,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),nr=Ye(ha),h=_({},Ge,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ma}),v=Ye(h),k=_({},He,{propertyName:0,elapsedTime:0,pseudoElement:0}),R=Ye(k),le=_({},ys,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),ve=Ye(le),dt=_({},He,{newState:0,oldState:0}),ls=Ye(dt),kn=[9,13,27,32],Vs=de&&"CompositionEvent"in window,cn=null;de&&"documentMode"in document&&(cn=document.documentMode);var Xr=de&&"TextEvent"in window&&!cn,Ia=de&&(!Vs||cn&&8<cn&&11>=cn),ma=" ",fa=!1;function Eo(s,a){switch(s){case"keyup":return kn.indexOf(a.keyCode)!==-1;case"keydown":return a.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ul(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var dl=!1;function Jk(s,a){switch(s){case"compositionend":return ul(a);case"keypress":return a.which!==32?null:(fa=!0,ma);case"textInput":return s=a.data,s===ma&&fa?null:s;default:return null}}function Zk(s,a){if(dl)return s==="compositionend"||!Vs&&Eo(s,a)?(s=ss(),qt=vt=st=null,dl=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(a.ctrlKey||a.altKey||a.metaKey)||a.ctrlKey&&a.altKey){if(a.char&&1<a.char.length)return a.char;if(a.which)return String.fromCharCode(a.which)}return null;case"compositionend":return Ia&&a.locale!=="ko"?null:a.data;default:return null}}var ej={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function rb(s){var a=s&&s.nodeName&&s.nodeName.toLowerCase();return a==="input"?!!ej[s.type]:a==="textarea"}function ab(s,a,o,c){Or?mr?mr.push(c):mr=[c]:Or=c,a=qd(a,"onChange"),0<a.length&&(o=new tt("onChange","change",null,o,c),s.push({event:o,listeners:a}))}var bc=null,vc=null;function tj(s){F0(s,0)}function td(s){var a=hs(s);if(ur(a))return s}function ib(s,a){if(s==="change")return a}var ob=!1;if(de){var Nm;if(de){var Cm="oninput"in document;if(!Cm){var lb=document.createElement("div");lb.setAttribute("oninput","return;"),Cm=typeof lb.oninput=="function"}Nm=Cm}else Nm=!1;ob=Nm&&(!document.documentMode||9<document.documentMode)}function cb(){bc&&(bc.detachEvent("onpropertychange",ub),vc=bc=null)}function ub(s){if(s.propertyName==="value"&&td(vc)){var a=[];ab(a,vc,s,fn(s)),q(tj,a)}}function sj(s,a,o){s==="focusin"?(cb(),bc=a,vc=o,bc.attachEvent("onpropertychange",ub)):s==="focusout"&&cb()}function nj(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return td(vc)}function rj(s,a){if(s==="click")return td(a)}function aj(s,a){if(s==="input"||s==="change")return td(a)}function ij(s,a){return s===a&&(s!==0||1/s===1/a)||s!==s&&a!==a}var Br=typeof Object.is=="function"?Object.is:ij;function xc(s,a){if(Br(s,a))return!0;if(typeof s!="object"||s===null||typeof a!="object"||a===null)return!1;var o=Object.keys(s),c=Object.keys(a);if(o.length!==c.length)return!1;for(c=0;c<o.length;c++){var m=o[c];if(!Ct.call(a,m)||!Br(s[m],a[m]))return!1}return!0}function db(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function hb(s,a){var o=db(s);s=0;for(var c;o;){if(o.nodeType===3){if(c=s+o.textContent.length,s<=a&&c>=a)return{node:o,offset:a-s};s=c}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=db(o)}}function mb(s,a){return s&&a?s===a?!0:s&&s.nodeType===3?!1:a&&a.nodeType===3?mb(s,a.parentNode):"contains"in s?s.contains(a):s.compareDocumentPosition?!!(s.compareDocumentPosition(a)&16):!1:!1}function fb(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var a=dr(s.document);a instanceof s.HTMLIFrameElement;){try{var o=typeof a.contentWindow.location.href=="string"}catch{o=!1}if(o)s=a.contentWindow;else break;a=dr(s.document)}return a}function Rm(s){var a=s&&s.nodeName&&s.nodeName.toLowerCase();return a&&(a==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||a==="textarea"||s.contentEditable==="true")}var oj=de&&"documentMode"in document&&11>=document.documentMode,hl=null,Am=null,wc=null,Mm=!1;function pb(s,a,o){var c=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;Mm||hl==null||hl!==dr(c)||(c=hl,"selectionStart"in c&&Rm(c)?c={start:c.selectionStart,end:c.selectionEnd}:(c=(c.ownerDocument&&c.ownerDocument.defaultView||window).getSelection(),c={anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset}),wc&&xc(wc,c)||(wc=c,c=qd(Am,"onSelect"),0<c.length&&(a=new tt("onSelect","select",null,a,o),s.push({event:a,listeners:c}),a.target=hl)))}function No(s,a){var o={};return o[s.toLowerCase()]=a.toLowerCase(),o["Webkit"+s]="webkit"+a,o["Moz"+s]="moz"+a,o}var ml={animationend:No("Animation","AnimationEnd"),animationiteration:No("Animation","AnimationIteration"),animationstart:No("Animation","AnimationStart"),transitionrun:No("Transition","TransitionRun"),transitionstart:No("Transition","TransitionStart"),transitioncancel:No("Transition","TransitionCancel"),transitionend:No("Transition","TransitionEnd")},Im={},gb={};de&&(gb=document.createElement("div").style,"AnimationEvent"in window||(delete ml.animationend.animation,delete ml.animationiteration.animation,delete ml.animationstart.animation),"TransitionEvent"in window||delete ml.transitionend.transition);function Co(s){if(Im[s])return Im[s];if(!ml[s])return s;var a=ml[s],o;for(o in a)if(a.hasOwnProperty(o)&&o in gb)return Im[s]=a[o];return s}var yb=Co("animationend"),bb=Co("animationiteration"),vb=Co("animationstart"),lj=Co("transitionrun"),cj=Co("transitionstart"),uj=Co("transitioncancel"),xb=Co("transitionend"),wb=new Map,Dm="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Dm.push("scrollEnd");function pa(s,a){wb.set(s,a),E(a,[s])}var sd=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var a=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(a))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)},Jr=[],fl=0,Pm=0;function nd(){for(var s=fl,a=Pm=fl=0;a<s;){var o=Jr[a];Jr[a++]=null;var c=Jr[a];Jr[a++]=null;var m=Jr[a];Jr[a++]=null;var f=Jr[a];if(Jr[a++]=null,c!==null&&m!==null){var w=c.pending;w===null?m.next=m:(m.next=w.next,w.next=m),c.pending=m}f!==0&&_b(o,m,f)}}function rd(s,a,o,c){Jr[fl++]=s,Jr[fl++]=a,Jr[fl++]=o,Jr[fl++]=c,Pm|=c,s.lanes|=c,s=s.alternate,s!==null&&(s.lanes|=c)}function Lm(s,a,o,c){return rd(s,a,o,c),ad(s)}function Ro(s,a){return rd(s,null,null,a),ad(s)}function _b(s,a,o){s.lanes|=o;var c=s.alternate;c!==null&&(c.lanes|=o);for(var m=!1,f=s.return;f!==null;)f.childLanes|=o,c=f.alternate,c!==null&&(c.childLanes|=o),f.tag===22&&(s=f.stateNode,s===null||s._visibility&1||(m=!0)),s=f,f=f.return;return s.tag===3?(f=s.stateNode,m&&a!==null&&(m=31-De(o),s=f.hiddenUpdates,c=s[m],c===null?s[m]=[a]:c.push(a),a.lane=o|536870912),f):null}function ad(s){if(50<qc)throw qc=0,Wf=null,Error(i(185));for(var a=s.return;a!==null;)s=a,a=s.return;return s.tag===3?s.stateNode:null}var pl={};function dj(s,a,o,c){this.tag=s,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=a,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=c,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Vr(s,a,o,c){return new dj(s,a,o,c)}function Om(s){return s=s.prototype,!(!s||!s.isReactComponent)}function ei(s,a){var o=s.alternate;return o===null?(o=Vr(s.tag,a,s.key,s.mode),o.elementType=s.elementType,o.type=s.type,o.stateNode=s.stateNode,o.alternate=s,s.alternate=o):(o.pendingProps=a,o.type=s.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=s.flags&65011712,o.childLanes=s.childLanes,o.lanes=s.lanes,o.child=s.child,o.memoizedProps=s.memoizedProps,o.memoizedState=s.memoizedState,o.updateQueue=s.updateQueue,a=s.dependencies,o.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext},o.sibling=s.sibling,o.index=s.index,o.ref=s.ref,o.refCleanup=s.refCleanup,o}function kb(s,a){s.flags&=65011714;var o=s.alternate;return o===null?(s.childLanes=0,s.lanes=a,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,a=o.dependencies,s.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),s}function id(s,a,o,c,m,f){var w=0;if(c=s,typeof s=="function")Om(s)&&(w=1);else if(typeof s=="string")w=gT(s,o,qe.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case M:return s=Vr(31,o,a,m),s.elementType=M,s.lanes=f,s;case B:return Ao(o.children,m,f,a);case D:w=8,m|=24;break;case te:return s=Vr(12,o,a,m|2),s.elementType=te,s.lanes=f,s;case Re:return s=Vr(13,o,a,m),s.elementType=Re,s.lanes=f,s;case _e:return s=Vr(19,o,a,m),s.elementType=_e,s.lanes=f,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case Z:w=10;break e;case Y:w=9;break e;case ke:w=11;break e;case C:w=14;break e;case T:w=16,c=null;break e}w=29,o=Error(i(130,s===null?"null":typeof s,"")),c=null}return a=Vr(w,o,a,m),a.elementType=s,a.type=c,a.lanes=f,a}function Ao(s,a,o,c){return s=Vr(7,s,c,a),s.lanes=o,s}function Bm(s,a,o){return s=Vr(6,s,null,a),s.lanes=o,s}function jb(s){var a=Vr(18,null,null,0);return a.stateNode=s,a}function Vm(s,a,o){return a=Vr(4,s.children!==null?s.children:[],s.key,a),a.lanes=o,a.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},a}var Tb=new WeakMap;function Zr(s,a){if(typeof s=="object"&&s!==null){var o=Tb.get(s);return o!==void 0?o:(a={value:s,source:a,stack:Et(a)},Tb.set(s,a),a)}return{value:s,source:a,stack:Et(a)}}var gl=[],yl=0,od=null,_c=0,ea=[],ta=0,Ii=null,Da=1,Pa="";function ti(s,a){gl[yl++]=_c,gl[yl++]=od,od=s,_c=a}function Sb(s,a,o){ea[ta++]=Da,ea[ta++]=Pa,ea[ta++]=Ii,Ii=s;var c=Da;s=Pa;var m=32-De(c)-1;c&=~(1<<m),o+=1;var f=32-De(a)+m;if(30<f){var w=m-m%5;f=(c&(1<<w)-1).toString(32),c>>=w,m-=w,Da=1<<32-De(a)+m|o<<m|c,Pa=f+s}else Da=1<<f|o<<m|c,Pa=s}function Um(s){s.return!==null&&(ti(s,1),Sb(s,1,0))}function Fm(s){for(;s===od;)od=gl[--yl],gl[yl]=null,_c=gl[--yl],gl[yl]=null;for(;s===Ii;)Ii=ea[--ta],ea[ta]=null,Pa=ea[--ta],ea[ta]=null,Da=ea[--ta],ea[ta]=null}function Eb(s,a){ea[ta++]=Da,ea[ta++]=Pa,ea[ta++]=Ii,Da=a.id,Pa=a.overflow,Ii=s}var Kn=null,an=null,Cs=!1,Di=null,sa=!1,zm=Error(i(519));function Pi(s){var a=Error(i(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw kc(Zr(a,s)),zm}function Nb(s){var a=s.stateNode,o=s.type,c=s.memoizedProps;switch(a[bt]=s,a[At]=c,o){case"dialog":vs("cancel",a),vs("close",a);break;case"iframe":case"object":case"embed":vs("load",a);break;case"video":case"audio":for(o=0;o<$c.length;o++)vs($c[o],a);break;case"source":vs("error",a);break;case"img":case"image":case"link":vs("error",a),vs("load",a);break;case"details":vs("toggle",a);break;case"input":vs("invalid",a),Ri(a,c.value,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name,!0);break;case"select":vs("invalid",a);break;case"textarea":vs("invalid",a),Pr(a,c.value,c.defaultValue,c.children)}o=c.children,typeof o!="string"&&typeof o!="number"&&typeof o!="bigint"||a.textContent===""+o||c.suppressHydrationWarning===!0||$0(a.textContent,o)?(c.popover!=null&&(vs("beforetoggle",a),vs("toggle",a)),c.onScroll!=null&&vs("scroll",a),c.onScrollEnd!=null&&vs("scrollend",a),c.onClick!=null&&(a.onclick=Fn),a=!0):a=!1,a||Pi(s,!0)}function Cb(s){for(Kn=s.return;Kn;)switch(Kn.tag){case 5:case 31:case 13:sa=!1;return;case 27:case 3:sa=!0;return;default:Kn=Kn.return}}function bl(s){if(s!==Kn)return!1;if(!Cs)return Cb(s),Cs=!0,!1;var a=s.tag,o;if((o=a!==3&&a!==27)&&((o=a===5)&&(o=s.type,o=!(o!=="form"&&o!=="button")||op(s.type,s.memoizedProps)),o=!o),o&&an&&Pi(s),Cb(s),a===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(317));an=e1(s)}else if(a===31){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(317));an=e1(s)}else a===27?(a=an,Yi(s.type)?(s=hp,hp=null,an=s):an=a):an=Kn?ra(s.stateNode.nextSibling):null;return!0}function Mo(){an=Kn=null,Cs=!1}function qm(){var s=Di;return s!==null&&(Cr===null?Cr=s:Cr.push.apply(Cr,s),Di=null),s}function kc(s){Di===null?Di=[s]:Di.push(s)}var Hm=P(null),Io=null,si=null;function Li(s,a,o){Fe(Hm,a._currentValue),a._currentValue=o}function ni(s){s._currentValue=Hm.current,re(Hm)}function $m(s,a,o){for(;s!==null;){var c=s.alternate;if((s.childLanes&a)!==a?(s.childLanes|=a,c!==null&&(c.childLanes|=a)):c!==null&&(c.childLanes&a)!==a&&(c.childLanes|=a),s===o)break;s=s.return}}function Wm(s,a,o,c){var m=s.child;for(m!==null&&(m.return=s);m!==null;){var f=m.dependencies;if(f!==null){var w=m.child;f=f.firstContext;e:for(;f!==null;){var N=f;f=m;for(var H=0;H<a.length;H++)if(N.context===a[H]){f.lanes|=o,N=f.alternate,N!==null&&(N.lanes|=o),$m(f.return,o,s),c||(w=null);break e}f=N.next}}else if(m.tag===18){if(w=m.return,w===null)throw Error(i(341));w.lanes|=o,f=w.alternate,f!==null&&(f.lanes|=o),$m(w,o,s),w=null}else w=m.child;if(w!==null)w.return=m;else for(w=m;w!==null;){if(w===s){w=null;break}if(m=w.sibling,m!==null){m.return=w.return,w=m;break}w=w.return}m=w}}function vl(s,a,o,c){s=null;for(var m=a,f=!1;m!==null;){if(!f){if((m.flags&524288)!==0)f=!0;else if((m.flags&262144)!==0)break}if(m.tag===10){var w=m.alternate;if(w===null)throw Error(i(387));if(w=w.memoizedProps,w!==null){var N=m.type;Br(m.pendingProps.value,w.value)||(s!==null?s.push(N):s=[N])}}else if(m===mt.current){if(w=m.alternate,w===null)throw Error(i(387));w.memoizedState.memoizedState!==m.memoizedState.memoizedState&&(s!==null?s.push(Qc):s=[Qc])}m=m.return}s!==null&&Wm(a,s,o,c),a.flags|=262144}function ld(s){for(s=s.firstContext;s!==null;){if(!Br(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function Do(s){Io=s,si=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function Yn(s){return Rb(Io,s)}function cd(s,a){return Io===null&&Do(s),Rb(s,a)}function Rb(s,a){var o=a._currentValue;if(a={context:a,memoizedValue:o,next:null},si===null){if(s===null)throw Error(i(308));si=a,s.dependencies={lanes:0,firstContext:a},s.flags|=524288}else si=si.next=a;return o}var hj=typeof AbortController<"u"?AbortController:function(){var s=[],a=this.signal={aborted:!1,addEventListener:function(o,c){s.push(c)}};this.abort=function(){a.aborted=!0,s.forEach(function(o){return o()})}},mj=n.unstable_scheduleCallback,fj=n.unstable_NormalPriority,Cn={$$typeof:Z,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Gm(){return{controller:new hj,data:new Map,refCount:0}}function jc(s){s.refCount--,s.refCount===0&&mj(fj,function(){s.controller.abort()})}var Tc=null,Km=0,xl=0,wl=null;function pj(s,a){if(Tc===null){var o=Tc=[];Km=0,xl=Jf(),wl={status:"pending",value:void 0,then:function(c){o.push(c)}}}return Km++,a.then(Ab,Ab),a}function Ab(){if(--Km===0&&Tc!==null){wl!==null&&(wl.status="fulfilled");var s=Tc;Tc=null,xl=0,wl=null;for(var a=0;a<s.length;a++)(0,s[a])()}}function gj(s,a){var o=[],c={status:"pending",value:null,reason:null,then:function(m){o.push(m)}};return s.then(function(){c.status="fulfilled",c.value=a;for(var m=0;m<o.length;m++)(0,o[m])(a)},function(m){for(c.status="rejected",c.reason=m,m=0;m<o.length;m++)(0,o[m])(void 0)}),c}var Mb=$.S;$.S=function(s,a){p0=Gt(),typeof a=="object"&&a!==null&&typeof a.then=="function"&&pj(s,a),Mb!==null&&Mb(s,a)};var Po=P(null);function Ym(){var s=Po.current;return s!==null?s:Xs.pooledCache}function ud(s,a){a===null?Fe(Po,Po.current):Fe(Po,a.pool)}function Ib(){var s=Ym();return s===null?null:{parent:Cn._currentValue,pool:s}}var _l=Error(i(460)),Qm=Error(i(474)),dd=Error(i(542)),hd={then:function(){}};function Db(s){return s=s.status,s==="fulfilled"||s==="rejected"}function Pb(s,a,o){switch(o=s[o],o===void 0?s.push(a):o!==a&&(a.then(Fn,Fn),a=o),a.status){case"fulfilled":return a.value;case"rejected":throw s=a.reason,Ob(s),s;default:if(typeof a.status=="string")a.then(Fn,Fn);else{if(s=Xs,s!==null&&100<s.shellSuspendCounter)throw Error(i(482));s=a,s.status="pending",s.then(function(c){if(a.status==="pending"){var m=a;m.status="fulfilled",m.value=c}},function(c){if(a.status==="pending"){var m=a;m.status="rejected",m.reason=c}})}switch(a.status){case"fulfilled":return a.value;case"rejected":throw s=a.reason,Ob(s),s}throw Oo=a,_l}}function Lo(s){try{var a=s._init;return a(s._payload)}catch(o){throw o!==null&&typeof o=="object"&&typeof o.then=="function"?(Oo=o,_l):o}}var Oo=null;function Lb(){if(Oo===null)throw Error(i(459));var s=Oo;return Oo=null,s}function Ob(s){if(s===_l||s===dd)throw Error(i(483))}var kl=null,Sc=0;function md(s){var a=Sc;return Sc+=1,kl===null&&(kl=[]),Pb(kl,s,a)}function Ec(s,a){a=a.props.ref,s.ref=a!==void 0?a:null}function fd(s,a){throw a.$$typeof===j?Error(i(525)):(s=Object.prototype.toString.call(a),Error(i(31,s==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":s)))}function Bb(s){function a(ee,W){if(s){var ce=ee.deletions;ce===null?(ee.deletions=[W],ee.flags|=16):ce.push(W)}}function o(ee,W){if(!s)return null;for(;W!==null;)a(ee,W),W=W.sibling;return null}function c(ee){for(var W=new Map;ee!==null;)ee.key!==null?W.set(ee.key,ee):W.set(ee.index,ee),ee=ee.sibling;return W}function m(ee,W){return ee=ei(ee,W),ee.index=0,ee.sibling=null,ee}function f(ee,W,ce){return ee.index=ce,s?(ce=ee.alternate,ce!==null?(ce=ce.index,ce<W?(ee.flags|=67108866,W):ce):(ee.flags|=67108866,W)):(ee.flags|=1048576,W)}function w(ee){return s&&ee.alternate===null&&(ee.flags|=67108866),ee}function N(ee,W,ce,Oe){return W===null||W.tag!==6?(W=Bm(ce,ee.mode,Oe),W.return=ee,W):(W=m(W,ce),W.return=ee,W)}function H(ee,W,ce,Oe){var Vt=ce.type;return Vt===B?Ne(ee,W,ce.props.children,Oe,ce.key):W!==null&&(W.elementType===Vt||typeof Vt=="object"&&Vt!==null&&Vt.$$typeof===T&&Lo(Vt)===W.type)?(W=m(W,ce.props),Ec(W,ce),W.return=ee,W):(W=id(ce.type,ce.key,ce.props,null,ee.mode,Oe),Ec(W,ce),W.return=ee,W)}function he(ee,W,ce,Oe){return W===null||W.tag!==4||W.stateNode.containerInfo!==ce.containerInfo||W.stateNode.implementation!==ce.implementation?(W=Vm(ce,ee.mode,Oe),W.return=ee,W):(W=m(W,ce.children||[]),W.return=ee,W)}function Ne(ee,W,ce,Oe,Vt){return W===null||W.tag!==7?(W=Ao(ce,ee.mode,Oe,Vt),W.return=ee,W):(W=m(W,ce),W.return=ee,W)}function ze(ee,W,ce){if(typeof W=="string"&&W!==""||typeof W=="number"||typeof W=="bigint")return W=Bm(""+W,ee.mode,ce),W.return=ee,W;if(typeof W=="object"&&W!==null){switch(W.$$typeof){case O:return ce=id(W.type,W.key,W.props,null,ee.mode,ce),Ec(ce,W),ce.return=ee,ce;case K:return W=Vm(W,ee.mode,ce),W.return=ee,W;case T:return W=Lo(W),ze(ee,W,ce)}if(ht(W)||L(W))return W=Ao(W,ee.mode,ce,null),W.return=ee,W;if(typeof W.then=="function")return ze(ee,md(W),ce);if(W.$$typeof===Z)return ze(ee,cd(ee,W),ce);fd(ee,W)}return null}function fe(ee,W,ce,Oe){var Vt=W!==null?W.key:null;if(typeof ce=="string"&&ce!==""||typeof ce=="number"||typeof ce=="bigint")return Vt!==null?null:N(ee,W,""+ce,Oe);if(typeof ce=="object"&&ce!==null){switch(ce.$$typeof){case O:return ce.key===Vt?H(ee,W,ce,Oe):null;case K:return ce.key===Vt?he(ee,W,ce,Oe):null;case T:return ce=Lo(ce),fe(ee,W,ce,Oe)}if(ht(ce)||L(ce))return Vt!==null?null:Ne(ee,W,ce,Oe,null);if(typeof ce.then=="function")return fe(ee,W,md(ce),Oe);if(ce.$$typeof===Z)return fe(ee,W,cd(ee,ce),Oe);fd(ee,ce)}return null}function we(ee,W,ce,Oe,Vt){if(typeof Oe=="string"&&Oe!==""||typeof Oe=="number"||typeof Oe=="bigint")return ee=ee.get(ce)||null,N(W,ee,""+Oe,Vt);if(typeof Oe=="object"&&Oe!==null){switch(Oe.$$typeof){case O:return ee=ee.get(Oe.key===null?ce:Oe.key)||null,H(W,ee,Oe,Vt);case K:return ee=ee.get(Oe.key===null?ce:Oe.key)||null,he(W,ee,Oe,Vt);case T:return Oe=Lo(Oe),we(ee,W,ce,Oe,Vt)}if(ht(Oe)||L(Oe))return ee=ee.get(ce)||null,Ne(W,ee,Oe,Vt,null);if(typeof Oe.then=="function")return we(ee,W,ce,md(Oe),Vt);if(Oe.$$typeof===Z)return we(ee,W,ce,cd(W,Oe),Vt);fd(W,Oe)}return null}function Rt(ee,W,ce,Oe){for(var Vt=null,Ls=null,It=W,ds=W=0,ks=null;It!==null&&ds<ce.length;ds++){It.index>ds?(ks=It,It=null):ks=It.sibling;var Os=fe(ee,It,ce[ds],Oe);if(Os===null){It===null&&(It=ks);break}s&&It&&Os.alternate===null&&a(ee,It),W=f(Os,W,ds),Ls===null?Vt=Os:Ls.sibling=Os,Ls=Os,It=ks}if(ds===ce.length)return o(ee,It),Cs&&ti(ee,ds),Vt;if(It===null){for(;ds<ce.length;ds++)It=ze(ee,ce[ds],Oe),It!==null&&(W=f(It,W,ds),Ls===null?Vt=It:Ls.sibling=It,Ls=It);return Cs&&ti(ee,ds),Vt}for(It=c(It);ds<ce.length;ds++)ks=we(It,ee,ds,ce[ds],Oe),ks!==null&&(s&&ks.alternate!==null&&It.delete(ks.key===null?ds:ks.key),W=f(ks,W,ds),Ls===null?Vt=ks:Ls.sibling=ks,Ls=ks);return s&&It.forEach(function(eo){return a(ee,eo)}),Cs&&ti(ee,ds),Vt}function $t(ee,W,ce,Oe){if(ce==null)throw Error(i(151));for(var Vt=null,Ls=null,It=W,ds=W=0,ks=null,Os=ce.next();It!==null&&!Os.done;ds++,Os=ce.next()){It.index>ds?(ks=It,It=null):ks=It.sibling;var eo=fe(ee,It,Os.value,Oe);if(eo===null){It===null&&(It=ks);break}s&&It&&eo.alternate===null&&a(ee,It),W=f(eo,W,ds),Ls===null?Vt=eo:Ls.sibling=eo,Ls=eo,It=ks}if(Os.done)return o(ee,It),Cs&&ti(ee,ds),Vt;if(It===null){for(;!Os.done;ds++,Os=ce.next())Os=ze(ee,Os.value,Oe),Os!==null&&(W=f(Os,W,ds),Ls===null?Vt=Os:Ls.sibling=Os,Ls=Os);return Cs&&ti(ee,ds),Vt}for(It=c(It);!Os.done;ds++,Os=ce.next())Os=we(It,ee,ds,Os.value,Oe),Os!==null&&(s&&Os.alternate!==null&&It.delete(Os.key===null?ds:Os.key),W=f(Os,W,ds),Ls===null?Vt=Os:Ls.sibling=Os,Ls=Os);return s&&It.forEach(function(ET){return a(ee,ET)}),Cs&&ti(ee,ds),Vt}function Ks(ee,W,ce,Oe){if(typeof ce=="object"&&ce!==null&&ce.type===B&&ce.key===null&&(ce=ce.props.children),typeof ce=="object"&&ce!==null){switch(ce.$$typeof){case O:e:{for(var Vt=ce.key;W!==null;){if(W.key===Vt){if(Vt=ce.type,Vt===B){if(W.tag===7){o(ee,W.sibling),Oe=m(W,ce.props.children),Oe.return=ee,ee=Oe;break e}}else if(W.elementType===Vt||typeof Vt=="object"&&Vt!==null&&Vt.$$typeof===T&&Lo(Vt)===W.type){o(ee,W.sibling),Oe=m(W,ce.props),Ec(Oe,ce),Oe.return=ee,ee=Oe;break e}o(ee,W);break}else a(ee,W);W=W.sibling}ce.type===B?(Oe=Ao(ce.props.children,ee.mode,Oe,ce.key),Oe.return=ee,ee=Oe):(Oe=id(ce.type,ce.key,ce.props,null,ee.mode,Oe),Ec(Oe,ce),Oe.return=ee,ee=Oe)}return w(ee);case K:e:{for(Vt=ce.key;W!==null;){if(W.key===Vt)if(W.tag===4&&W.stateNode.containerInfo===ce.containerInfo&&W.stateNode.implementation===ce.implementation){o(ee,W.sibling),Oe=m(W,ce.children||[]),Oe.return=ee,ee=Oe;break e}else{o(ee,W);break}else a(ee,W);W=W.sibling}Oe=Vm(ce,ee.mode,Oe),Oe.return=ee,ee=Oe}return w(ee);case T:return ce=Lo(ce),Ks(ee,W,ce,Oe)}if(ht(ce))return Rt(ee,W,ce,Oe);if(L(ce)){if(Vt=L(ce),typeof Vt!="function")throw Error(i(150));return ce=Vt.call(ce),$t(ee,W,ce,Oe)}if(typeof ce.then=="function")return Ks(ee,W,md(ce),Oe);if(ce.$$typeof===Z)return Ks(ee,W,cd(ee,ce),Oe);fd(ee,ce)}return typeof ce=="string"&&ce!==""||typeof ce=="number"||typeof ce=="bigint"?(ce=""+ce,W!==null&&W.tag===6?(o(ee,W.sibling),Oe=m(W,ce),Oe.return=ee,ee=Oe):(o(ee,W),Oe=Bm(ce,ee.mode,Oe),Oe.return=ee,ee=Oe),w(ee)):o(ee,W)}return function(ee,W,ce,Oe){try{Sc=0;var Vt=Ks(ee,W,ce,Oe);return kl=null,Vt}catch(It){if(It===_l||It===dd)throw It;var Ls=Vr(29,It,null,ee.mode);return Ls.lanes=Oe,Ls.return=ee,Ls}}}var Bo=Bb(!0),Vb=Bb(!1),Oi=!1;function Xm(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Jm(s,a){s=s.updateQueue,a.updateQueue===s&&(a.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function Bi(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function Vi(s,a,o){var c=s.updateQueue;if(c===null)return null;if(c=c.shared,(Us&2)!==0){var m=c.pending;return m===null?a.next=a:(a.next=m.next,m.next=a),c.pending=a,a=ad(s),_b(s,null,o),a}return rd(s,c,a,o),ad(s)}function Nc(s,a,o){if(a=a.updateQueue,a!==null&&(a=a.shared,(o&4194048)!==0)){var c=a.lanes;c&=s.pendingLanes,o|=c,a.lanes=o,Jt(s,o)}}function Zm(s,a){var o=s.updateQueue,c=s.alternate;if(c!==null&&(c=c.updateQueue,o===c)){var m=null,f=null;if(o=o.firstBaseUpdate,o!==null){do{var w={lane:o.lane,tag:o.tag,payload:o.payload,callback:null,next:null};f===null?m=f=w:f=f.next=w,o=o.next}while(o!==null);f===null?m=f=a:f=f.next=a}else m=f=a;o={baseState:c.baseState,firstBaseUpdate:m,lastBaseUpdate:f,shared:c.shared,callbacks:c.callbacks},s.updateQueue=o;return}s=o.lastBaseUpdate,s===null?o.firstBaseUpdate=a:s.next=a,o.lastBaseUpdate=a}var ef=!1;function Cc(){if(ef){var s=wl;if(s!==null)throw s}}function Rc(s,a,o,c){ef=!1;var m=s.updateQueue;Oi=!1;var f=m.firstBaseUpdate,w=m.lastBaseUpdate,N=m.shared.pending;if(N!==null){m.shared.pending=null;var H=N,he=H.next;H.next=null,w===null?f=he:w.next=he,w=H;var Ne=s.alternate;Ne!==null&&(Ne=Ne.updateQueue,N=Ne.lastBaseUpdate,N!==w&&(N===null?Ne.firstBaseUpdate=he:N.next=he,Ne.lastBaseUpdate=H))}if(f!==null){var ze=m.baseState;w=0,Ne=he=H=null,N=f;do{var fe=N.lane&-536870913,we=fe!==N.lane;if(we?(_s&fe)===fe:(c&fe)===fe){fe!==0&&fe===xl&&(ef=!0),Ne!==null&&(Ne=Ne.next={lane:0,tag:N.tag,payload:N.payload,callback:null,next:null});e:{var Rt=s,$t=N;fe=a;var Ks=o;switch($t.tag){case 1:if(Rt=$t.payload,typeof Rt=="function"){ze=Rt.call(Ks,ze,fe);break e}ze=Rt;break e;case 3:Rt.flags=Rt.flags&-65537|128;case 0:if(Rt=$t.payload,fe=typeof Rt=="function"?Rt.call(Ks,ze,fe):Rt,fe==null)break e;ze=_({},ze,fe);break e;case 2:Oi=!0}}fe=N.callback,fe!==null&&(s.flags|=64,we&&(s.flags|=8192),we=m.callbacks,we===null?m.callbacks=[fe]:we.push(fe))}else we={lane:fe,tag:N.tag,payload:N.payload,callback:N.callback,next:null},Ne===null?(he=Ne=we,H=ze):Ne=Ne.next=we,w|=fe;if(N=N.next,N===null){if(N=m.shared.pending,N===null)break;we=N,N=we.next,we.next=null,m.lastBaseUpdate=we,m.shared.pending=null}}while(!0);Ne===null&&(H=ze),m.baseState=H,m.firstBaseUpdate=he,m.lastBaseUpdate=Ne,f===null&&(m.shared.lanes=0),Hi|=w,s.lanes=w,s.memoizedState=ze}}function Ub(s,a){if(typeof s!="function")throw Error(i(191,s));s.call(a)}function Fb(s,a){var o=s.callbacks;if(o!==null)for(s.callbacks=null,s=0;s<o.length;s++)Ub(o[s],a)}var jl=P(null),pd=P(0);function zb(s,a){s=hi,Fe(pd,s),Fe(jl,a),hi=s|a.baseLanes}function tf(){Fe(pd,hi),Fe(jl,jl.current)}function sf(){hi=pd.current,re(jl),re(pd)}var Ur=P(null),na=null;function Ui(s){var a=s.alternate;Fe(jn,jn.current&1),Fe(Ur,s),na===null&&(a===null||jl.current!==null||a.memoizedState!==null)&&(na=s)}function nf(s){Fe(jn,jn.current),Fe(Ur,s),na===null&&(na=s)}function qb(s){s.tag===22?(Fe(jn,jn.current),Fe(Ur,s),na===null&&(na=s)):Fi()}function Fi(){Fe(jn,jn.current),Fe(Ur,Ur.current)}function Fr(s){re(Ur),na===s&&(na=null),re(jn)}var jn=P(0);function gd(s){for(var a=s;a!==null;){if(a.tag===13){var o=a.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||up(o)||dp(o)))return a}else if(a.tag===19&&(a.memoizedProps.revealOrder==="forwards"||a.memoizedProps.revealOrder==="backwards"||a.memoizedProps.revealOrder==="unstable_legacy-backwards"||a.memoizedProps.revealOrder==="together")){if((a.flags&128)!==0)return a}else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===s)break;for(;a.sibling===null;){if(a.return===null||a.return===s)return null;a=a.return}a.sibling.return=a.return,a=a.sibling}return null}var ri=0,cs=null,Ws=null,Rn=null,yd=!1,Tl=!1,Vo=!1,bd=0,Ac=0,Sl=null,yj=0;function yn(){throw Error(i(321))}function rf(s,a){if(a===null)return!1;for(var o=0;o<a.length&&o<s.length;o++)if(!Br(s[o],a[o]))return!1;return!0}function af(s,a,o,c,m,f){return ri=f,cs=a,a.memoizedState=null,a.updateQueue=null,a.lanes=0,$.H=s===null||s.memoizedState===null?Sv:wf,Vo=!1,f=o(c,m),Vo=!1,Tl&&(f=$b(a,o,c,m)),Hb(s),f}function Hb(s){$.H=Dc;var a=Ws!==null&&Ws.next!==null;if(ri=0,Rn=Ws=cs=null,yd=!1,Ac=0,Sl=null,a)throw Error(i(300));s===null||An||(s=s.dependencies,s!==null&&ld(s)&&(An=!0))}function $b(s,a,o,c){cs=s;var m=0;do{if(Tl&&(Sl=null),Ac=0,Tl=!1,25<=m)throw Error(i(301));if(m+=1,Rn=Ws=null,s.updateQueue!=null){var f=s.updateQueue;f.lastEffect=null,f.events=null,f.stores=null,f.memoCache!=null&&(f.memoCache.index=0)}$.H=Ev,f=a(o,c)}while(Tl);return f}function bj(){var s=$.H,a=s.useState()[0];return a=typeof a.then=="function"?Mc(a):a,s=s.useState()[0],(Ws!==null?Ws.memoizedState:null)!==s&&(cs.flags|=1024),a}function of(){var s=bd!==0;return bd=0,s}function lf(s,a,o){a.updateQueue=s.updateQueue,a.flags&=-2053,s.lanes&=~o}function cf(s){if(yd){for(s=s.memoizedState;s!==null;){var a=s.queue;a!==null&&(a.pending=null),s=s.next}yd=!1}ri=0,Rn=Ws=cs=null,Tl=!1,Ac=bd=0,Sl=null}function pr(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Rn===null?cs.memoizedState=Rn=s:Rn=Rn.next=s,Rn}function Tn(){if(Ws===null){var s=cs.alternate;s=s!==null?s.memoizedState:null}else s=Ws.next;var a=Rn===null?cs.memoizedState:Rn.next;if(a!==null)Rn=a,Ws=s;else{if(s===null)throw cs.alternate===null?Error(i(467)):Error(i(310));Ws=s,s={memoizedState:Ws.memoizedState,baseState:Ws.baseState,baseQueue:Ws.baseQueue,queue:Ws.queue,next:null},Rn===null?cs.memoizedState=Rn=s:Rn=Rn.next=s}return Rn}function vd(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Mc(s){var a=Ac;return Ac+=1,Sl===null&&(Sl=[]),s=Pb(Sl,s,a),a=cs,(Rn===null?a.memoizedState:Rn.next)===null&&(a=a.alternate,$.H=a===null||a.memoizedState===null?Sv:wf),s}function xd(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return Mc(s);if(s.$$typeof===Z)return Yn(s)}throw Error(i(438,String(s)))}function uf(s){var a=null,o=cs.updateQueue;if(o!==null&&(a=o.memoCache),a==null){var c=cs.alternate;c!==null&&(c=c.updateQueue,c!==null&&(c=c.memoCache,c!=null&&(a={data:c.data.map(function(m){return m.slice()}),index:0})))}if(a==null&&(a={data:[],index:0}),o===null&&(o=vd(),cs.updateQueue=o),o.memoCache=a,o=a.data[a.index],o===void 0)for(o=a.data[a.index]=Array(s),c=0;c<s;c++)o[c]=V;return a.index++,o}function ai(s,a){return typeof a=="function"?a(s):a}function wd(s){var a=Tn();return df(a,Ws,s)}function df(s,a,o){var c=s.queue;if(c===null)throw Error(i(311));c.lastRenderedReducer=o;var m=s.baseQueue,f=c.pending;if(f!==null){if(m!==null){var w=m.next;m.next=f.next,f.next=w}a.baseQueue=m=f,c.pending=null}if(f=s.baseState,m===null)s.memoizedState=f;else{a=m.next;var N=w=null,H=null,he=a,Ne=!1;do{var ze=he.lane&-536870913;if(ze!==he.lane?(_s&ze)===ze:(ri&ze)===ze){var fe=he.revertLane;if(fe===0)H!==null&&(H=H.next={lane:0,revertLane:0,gesture:null,action:he.action,hasEagerState:he.hasEagerState,eagerState:he.eagerState,next:null}),ze===xl&&(Ne=!0);else if((ri&fe)===fe){he=he.next,fe===xl&&(Ne=!0);continue}else ze={lane:0,revertLane:he.revertLane,gesture:null,action:he.action,hasEagerState:he.hasEagerState,eagerState:he.eagerState,next:null},H===null?(N=H=ze,w=f):H=H.next=ze,cs.lanes|=fe,Hi|=fe;ze=he.action,Vo&&o(f,ze),f=he.hasEagerState?he.eagerState:o(f,ze)}else fe={lane:ze,revertLane:he.revertLane,gesture:he.gesture,action:he.action,hasEagerState:he.hasEagerState,eagerState:he.eagerState,next:null},H===null?(N=H=fe,w=f):H=H.next=fe,cs.lanes|=ze,Hi|=ze;he=he.next}while(he!==null&&he!==a);if(H===null?w=f:H.next=N,!Br(f,s.memoizedState)&&(An=!0,Ne&&(o=wl,o!==null)))throw o;s.memoizedState=f,s.baseState=w,s.baseQueue=H,c.lastRenderedState=f}return m===null&&(c.lanes=0),[s.memoizedState,c.dispatch]}function hf(s){var a=Tn(),o=a.queue;if(o===null)throw Error(i(311));o.lastRenderedReducer=s;var c=o.dispatch,m=o.pending,f=a.memoizedState;if(m!==null){o.pending=null;var w=m=m.next;do f=s(f,w.action),w=w.next;while(w!==m);Br(f,a.memoizedState)||(An=!0),a.memoizedState=f,a.baseQueue===null&&(a.baseState=f),o.lastRenderedState=f}return[f,c]}function Wb(s,a,o){var c=cs,m=Tn(),f=Cs;if(f){if(o===void 0)throw Error(i(407));o=o()}else o=a();var w=!Br((Ws||m).memoizedState,o);if(w&&(m.memoizedState=o,An=!0),m=m.queue,pf(Yb.bind(null,c,m,s),[s]),m.getSnapshot!==a||w||Rn!==null&&Rn.memoizedState.tag&1){if(c.flags|=2048,El(9,{destroy:void 0},Kb.bind(null,c,m,o,a),null),Xs===null)throw Error(i(349));f||(ri&127)!==0||Gb(c,a,o)}return o}function Gb(s,a,o){s.flags|=16384,s={getSnapshot:a,value:o},a=cs.updateQueue,a===null?(a=vd(),cs.updateQueue=a,a.stores=[s]):(o=a.stores,o===null?a.stores=[s]:o.push(s))}function Kb(s,a,o,c){a.value=o,a.getSnapshot=c,Qb(a)&&Xb(s)}function Yb(s,a,o){return o(function(){Qb(a)&&Xb(s)})}function Qb(s){var a=s.getSnapshot;s=s.value;try{var o=a();return!Br(s,o)}catch{return!0}}function Xb(s){var a=Ro(s,2);a!==null&&Rr(a,s,2)}function mf(s){var a=pr();if(typeof s=="function"){var o=s;if(s=o(),Vo){Ie(!0);try{o()}finally{Ie(!1)}}}return a.memoizedState=a.baseState=s,a.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ai,lastRenderedState:s},a}function Jb(s,a,o,c){return s.baseState=o,df(s,Ws,typeof c=="function"?c:ai)}function vj(s,a,o,c,m){if(jd(s))throw Error(i(485));if(s=a.action,s!==null){var f={payload:m,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(w){f.listeners.push(w)}};$.T!==null?o(!0):f.isTransition=!1,c(f),o=a.pending,o===null?(f.next=a.pending=f,Zb(a,f)):(f.next=o.next,a.pending=o.next=f)}}function Zb(s,a){var o=a.action,c=a.payload,m=s.state;if(a.isTransition){var f=$.T,w={};$.T=w;try{var N=o(m,c),H=$.S;H!==null&&H(w,N),ev(s,a,N)}catch(he){ff(s,a,he)}finally{f!==null&&w.types!==null&&(f.types=w.types),$.T=f}}else try{f=o(m,c),ev(s,a,f)}catch(he){ff(s,a,he)}}function ev(s,a,o){o!==null&&typeof o=="object"&&typeof o.then=="function"?o.then(function(c){tv(s,a,c)},function(c){return ff(s,a,c)}):tv(s,a,o)}function tv(s,a,o){a.status="fulfilled",a.value=o,sv(a),s.state=o,a=s.pending,a!==null&&(o=a.next,o===a?s.pending=null:(o=o.next,a.next=o,Zb(s,o)))}function ff(s,a,o){var c=s.pending;if(s.pending=null,c!==null){c=c.next;do a.status="rejected",a.reason=o,sv(a),a=a.next;while(a!==c)}s.action=null}function sv(s){s=s.listeners;for(var a=0;a<s.length;a++)(0,s[a])()}function nv(s,a){return a}function rv(s,a){if(Cs){var o=Xs.formState;if(o!==null){e:{var c=cs;if(Cs){if(an){t:{for(var m=an,f=sa;m.nodeType!==8;){if(!f){m=null;break t}if(m=ra(m.nextSibling),m===null){m=null;break t}}f=m.data,m=f==="F!"||f==="F"?m:null}if(m){an=ra(m.nextSibling),c=m.data==="F!";break e}}Pi(c)}c=!1}c&&(a=o[0])}}return o=pr(),o.memoizedState=o.baseState=a,c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:nv,lastRenderedState:a},o.queue=c,o=kv.bind(null,cs,c),c.dispatch=o,c=mf(!1),f=xf.bind(null,cs,!1,c.queue),c=pr(),m={state:a,dispatch:null,action:s,pending:null},c.queue=m,o=vj.bind(null,cs,m,f,o),m.dispatch=o,c.memoizedState=s,[a,o,!1]}function av(s){var a=Tn();return iv(a,Ws,s)}function iv(s,a,o){if(a=df(s,a,nv)[0],s=wd(ai)[0],typeof a=="object"&&a!==null&&typeof a.then=="function")try{var c=Mc(a)}catch(w){throw w===_l?dd:w}else c=a;a=Tn();var m=a.queue,f=m.dispatch;return o!==a.memoizedState&&(cs.flags|=2048,El(9,{destroy:void 0},xj.bind(null,m,o),null)),[c,f,s]}function xj(s,a){s.action=a}function ov(s){var a=Tn(),o=Ws;if(o!==null)return iv(a,o,s);Tn(),a=a.memoizedState,o=Tn();var c=o.queue.dispatch;return o.memoizedState=s,[a,c,!1]}function El(s,a,o,c){return s={tag:s,create:o,deps:c,inst:a,next:null},a=cs.updateQueue,a===null&&(a=vd(),cs.updateQueue=a),o=a.lastEffect,o===null?a.lastEffect=s.next=s:(c=o.next,o.next=s,s.next=c,a.lastEffect=s),s}function lv(){return Tn().memoizedState}function _d(s,a,o,c){var m=pr();cs.flags|=s,m.memoizedState=El(1|a,{destroy:void 0},o,c===void 0?null:c)}function kd(s,a,o,c){var m=Tn();c=c===void 0?null:c;var f=m.memoizedState.inst;Ws!==null&&c!==null&&rf(c,Ws.memoizedState.deps)?m.memoizedState=El(a,f,o,c):(cs.flags|=s,m.memoizedState=El(1|a,f,o,c))}function cv(s,a){_d(8390656,8,s,a)}function pf(s,a){kd(2048,8,s,a)}function wj(s){cs.flags|=4;var a=cs.updateQueue;if(a===null)a=vd(),cs.updateQueue=a,a.events=[s];else{var o=a.events;o===null?a.events=[s]:o.push(s)}}function uv(s){var a=Tn().memoizedState;return wj({ref:a,nextImpl:s}),function(){if((Us&2)!==0)throw Error(i(440));return a.impl.apply(void 0,arguments)}}function dv(s,a){return kd(4,2,s,a)}function hv(s,a){return kd(4,4,s,a)}function mv(s,a){if(typeof a=="function"){s=s();var o=a(s);return function(){typeof o=="function"?o():a(null)}}if(a!=null)return s=s(),a.current=s,function(){a.current=null}}function fv(s,a,o){o=o!=null?o.concat([s]):null,kd(4,4,mv.bind(null,a,s),o)}function gf(){}function pv(s,a){var o=Tn();a=a===void 0?null:a;var c=o.memoizedState;return a!==null&&rf(a,c[1])?c[0]:(o.memoizedState=[s,a],s)}function gv(s,a){var o=Tn();a=a===void 0?null:a;var c=o.memoizedState;if(a!==null&&rf(a,c[1]))return c[0];if(c=s(),Vo){Ie(!0);try{s()}finally{Ie(!1)}}return o.memoizedState=[c,a],c}function yf(s,a,o){return o===void 0||(ri&1073741824)!==0&&(_s&261930)===0?s.memoizedState=a:(s.memoizedState=o,s=y0(),cs.lanes|=s,Hi|=s,o)}function yv(s,a,o,c){return Br(o,a)?o:jl.current!==null?(s=yf(s,o,c),Br(s,a)||(An=!0),s):(ri&42)===0||(ri&1073741824)!==0&&(_s&261930)===0?(An=!0,s.memoizedState=o):(s=y0(),cs.lanes|=s,Hi|=s,a)}function bv(s,a,o,c,m){var f=pe.p;pe.p=f!==0&&8>f?f:8;var w=$.T,N={};$.T=N,xf(s,!1,a,o);try{var H=m(),he=$.S;if(he!==null&&he(N,H),H!==null&&typeof H=="object"&&typeof H.then=="function"){var Ne=gj(H,c);Ic(s,a,Ne,Hr(s))}else Ic(s,a,c,Hr(s))}catch(ze){Ic(s,a,{then:function(){},status:"rejected",reason:ze},Hr())}finally{pe.p=f,w!==null&&N.types!==null&&(w.types=N.types),$.T=w}}function _j(){}function bf(s,a,o,c){if(s.tag!==5)throw Error(i(476));var m=vv(s).queue;bv(s,m,a,Be,o===null?_j:function(){return xv(s),o(c)})}function vv(s){var a=s.memoizedState;if(a!==null)return a;a={memoizedState:Be,baseState:Be,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ai,lastRenderedState:Be},next:null};var o={};return a.next={memoizedState:o,baseState:o,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ai,lastRenderedState:o},next:null},s.memoizedState=a,s=s.alternate,s!==null&&(s.memoizedState=a),a}function xv(s){var a=vv(s);a.next===null&&(a=s.alternate.memoizedState),Ic(s,a.next.queue,{},Hr())}function vf(){return Yn(Qc)}function wv(){return Tn().memoizedState}function _v(){return Tn().memoizedState}function kj(s){for(var a=s.return;a!==null;){switch(a.tag){case 24:case 3:var o=Hr();s=Bi(o);var c=Vi(a,s,o);c!==null&&(Rr(c,a,o),Nc(c,a,o)),a={cache:Gm()},s.payload=a;return}a=a.return}}function jj(s,a,o){var c=Hr();o={lane:c,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null},jd(s)?jv(a,o):(o=Lm(s,a,o,c),o!==null&&(Rr(o,s,c),Tv(o,a,c)))}function kv(s,a,o){var c=Hr();Ic(s,a,o,c)}function Ic(s,a,o,c){var m={lane:c,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null};if(jd(s))jv(a,m);else{var f=s.alternate;if(s.lanes===0&&(f===null||f.lanes===0)&&(f=a.lastRenderedReducer,f!==null))try{var w=a.lastRenderedState,N=f(w,o);if(m.hasEagerState=!0,m.eagerState=N,Br(N,w))return rd(s,a,m,0),Xs===null&&nd(),!1}catch{}if(o=Lm(s,a,m,c),o!==null)return Rr(o,s,c),Tv(o,a,c),!0}return!1}function xf(s,a,o,c){if(c={lane:2,revertLane:Jf(),gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},jd(s)){if(a)throw Error(i(479))}else a=Lm(s,o,c,2),a!==null&&Rr(a,s,2)}function jd(s){var a=s.alternate;return s===cs||a!==null&&a===cs}function jv(s,a){Tl=yd=!0;var o=s.pending;o===null?a.next=a:(a.next=o.next,o.next=a),s.pending=a}function Tv(s,a,o){if((o&4194048)!==0){var c=a.lanes;c&=s.pendingLanes,o|=c,a.lanes=o,Jt(s,o)}}var Dc={readContext:Yn,use:xd,useCallback:yn,useContext:yn,useEffect:yn,useImperativeHandle:yn,useLayoutEffect:yn,useInsertionEffect:yn,useMemo:yn,useReducer:yn,useRef:yn,useState:yn,useDebugValue:yn,useDeferredValue:yn,useTransition:yn,useSyncExternalStore:yn,useId:yn,useHostTransitionStatus:yn,useFormState:yn,useActionState:yn,useOptimistic:yn,useMemoCache:yn,useCacheRefresh:yn};Dc.useEffectEvent=yn;var Sv={readContext:Yn,use:xd,useCallback:function(s,a){return pr().memoizedState=[s,a===void 0?null:a],s},useContext:Yn,useEffect:cv,useImperativeHandle:function(s,a,o){o=o!=null?o.concat([s]):null,_d(4194308,4,mv.bind(null,a,s),o)},useLayoutEffect:function(s,a){return _d(4194308,4,s,a)},useInsertionEffect:function(s,a){_d(4,2,s,a)},useMemo:function(s,a){var o=pr();a=a===void 0?null:a;var c=s();if(Vo){Ie(!0);try{s()}finally{Ie(!1)}}return o.memoizedState=[c,a],c},useReducer:function(s,a,o){var c=pr();if(o!==void 0){var m=o(a);if(Vo){Ie(!0);try{o(a)}finally{Ie(!1)}}}else m=a;return c.memoizedState=c.baseState=m,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:m},c.queue=s,s=s.dispatch=jj.bind(null,cs,s),[c.memoizedState,s]},useRef:function(s){var a=pr();return s={current:s},a.memoizedState=s},useState:function(s){s=mf(s);var a=s.queue,o=kv.bind(null,cs,a);return a.dispatch=o,[s.memoizedState,o]},useDebugValue:gf,useDeferredValue:function(s,a){var o=pr();return yf(o,s,a)},useTransition:function(){var s=mf(!1);return s=bv.bind(null,cs,s.queue,!0,!1),pr().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,a,o){var c=cs,m=pr();if(Cs){if(o===void 0)throw Error(i(407));o=o()}else{if(o=a(),Xs===null)throw Error(i(349));(_s&127)!==0||Gb(c,a,o)}m.memoizedState=o;var f={value:o,getSnapshot:a};return m.queue=f,cv(Yb.bind(null,c,f,s),[s]),c.flags|=2048,El(9,{destroy:void 0},Kb.bind(null,c,f,o,a),null),o},useId:function(){var s=pr(),a=Xs.identifierPrefix;if(Cs){var o=Pa,c=Da;o=(c&~(1<<32-De(c)-1)).toString(32)+o,a="_"+a+"R_"+o,o=bd++,0<o&&(a+="H"+o.toString(32)),a+="_"}else o=yj++,a="_"+a+"r_"+o.toString(32)+"_";return s.memoizedState=a},useHostTransitionStatus:vf,useFormState:rv,useActionState:rv,useOptimistic:function(s){var a=pr();a.memoizedState=a.baseState=s;var o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return a.queue=o,a=xf.bind(null,cs,!0,o),o.dispatch=a,[s,a]},useMemoCache:uf,useCacheRefresh:function(){return pr().memoizedState=kj.bind(null,cs)},useEffectEvent:function(s){var a=pr(),o={impl:s};return a.memoizedState=o,function(){if((Us&2)!==0)throw Error(i(440));return o.impl.apply(void 0,arguments)}}},wf={readContext:Yn,use:xd,useCallback:pv,useContext:Yn,useEffect:pf,useImperativeHandle:fv,useInsertionEffect:dv,useLayoutEffect:hv,useMemo:gv,useReducer:wd,useRef:lv,useState:function(){return wd(ai)},useDebugValue:gf,useDeferredValue:function(s,a){var o=Tn();return yv(o,Ws.memoizedState,s,a)},useTransition:function(){var s=wd(ai)[0],a=Tn().memoizedState;return[typeof s=="boolean"?s:Mc(s),a]},useSyncExternalStore:Wb,useId:wv,useHostTransitionStatus:vf,useFormState:av,useActionState:av,useOptimistic:function(s,a){var o=Tn();return Jb(o,Ws,s,a)},useMemoCache:uf,useCacheRefresh:_v};wf.useEffectEvent=uv;var Ev={readContext:Yn,use:xd,useCallback:pv,useContext:Yn,useEffect:pf,useImperativeHandle:fv,useInsertionEffect:dv,useLayoutEffect:hv,useMemo:gv,useReducer:hf,useRef:lv,useState:function(){return hf(ai)},useDebugValue:gf,useDeferredValue:function(s,a){var o=Tn();return Ws===null?yf(o,s,a):yv(o,Ws.memoizedState,s,a)},useTransition:function(){var s=hf(ai)[0],a=Tn().memoizedState;return[typeof s=="boolean"?s:Mc(s),a]},useSyncExternalStore:Wb,useId:wv,useHostTransitionStatus:vf,useFormState:ov,useActionState:ov,useOptimistic:function(s,a){var o=Tn();return Ws!==null?Jb(o,Ws,s,a):(o.baseState=s,[s,o.queue.dispatch])},useMemoCache:uf,useCacheRefresh:_v};Ev.useEffectEvent=uv;function _f(s,a,o,c){a=s.memoizedState,o=o(c,a),o=o==null?a:_({},a,o),s.memoizedState=o,s.lanes===0&&(s.updateQueue.baseState=o)}var kf={enqueueSetState:function(s,a,o){s=s._reactInternals;var c=Hr(),m=Bi(c);m.payload=a,o!=null&&(m.callback=o),a=Vi(s,m,c),a!==null&&(Rr(a,s,c),Nc(a,s,c))},enqueueReplaceState:function(s,a,o){s=s._reactInternals;var c=Hr(),m=Bi(c);m.tag=1,m.payload=a,o!=null&&(m.callback=o),a=Vi(s,m,c),a!==null&&(Rr(a,s,c),Nc(a,s,c))},enqueueForceUpdate:function(s,a){s=s._reactInternals;var o=Hr(),c=Bi(o);c.tag=2,a!=null&&(c.callback=a),a=Vi(s,c,o),a!==null&&(Rr(a,s,o),Nc(a,s,o))}};function Nv(s,a,o,c,m,f,w){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(c,f,w):a.prototype&&a.prototype.isPureReactComponent?!xc(o,c)||!xc(m,f):!0}function Cv(s,a,o,c){s=a.state,typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps(o,c),typeof a.UNSAFE_componentWillReceiveProps=="function"&&a.UNSAFE_componentWillReceiveProps(o,c),a.state!==s&&kf.enqueueReplaceState(a,a.state,null)}function Uo(s,a){var o=a;if("ref"in a){o={};for(var c in a)c!=="ref"&&(o[c]=a[c])}if(s=s.defaultProps){o===a&&(o=_({},o));for(var m in s)o[m]===void 0&&(o[m]=s[m])}return o}function Rv(s){sd(s)}function Av(s){console.error(s)}function Mv(s){sd(s)}function Td(s,a){try{var o=s.onUncaughtError;o(a.value,{componentStack:a.stack})}catch(c){setTimeout(function(){throw c})}}function Iv(s,a,o){try{var c=s.onCaughtError;c(o.value,{componentStack:o.stack,errorBoundary:a.tag===1?a.stateNode:null})}catch(m){setTimeout(function(){throw m})}}function jf(s,a,o){return o=Bi(o),o.tag=3,o.payload={element:null},o.callback=function(){Td(s,a)},o}function Dv(s){return s=Bi(s),s.tag=3,s}function Pv(s,a,o,c){var m=o.type.getDerivedStateFromError;if(typeof m=="function"){var f=c.value;s.payload=function(){return m(f)},s.callback=function(){Iv(a,o,c)}}var w=o.stateNode;w!==null&&typeof w.componentDidCatch=="function"&&(s.callback=function(){Iv(a,o,c),typeof m!="function"&&($i===null?$i=new Set([this]):$i.add(this));var N=c.stack;this.componentDidCatch(c.value,{componentStack:N!==null?N:""})})}function Tj(s,a,o,c,m){if(o.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){if(a=o.alternate,a!==null&&vl(a,o,m,!0),o=Ur.current,o!==null){switch(o.tag){case 31:case 13:return na===null?Od():o.alternate===null&&bn===0&&(bn=3),o.flags&=-257,o.flags|=65536,o.lanes=m,c===hd?o.flags|=16384:(a=o.updateQueue,a===null?o.updateQueue=new Set([c]):a.add(c),Yf(s,c,m)),!1;case 22:return o.flags|=65536,c===hd?o.flags|=16384:(a=o.updateQueue,a===null?(a={transitions:null,markerInstances:null,retryQueue:new Set([c])},o.updateQueue=a):(o=a.retryQueue,o===null?a.retryQueue=new Set([c]):o.add(c)),Yf(s,c,m)),!1}throw Error(i(435,o.tag))}return Yf(s,c,m),Od(),!1}if(Cs)return a=Ur.current,a!==null?((a.flags&65536)===0&&(a.flags|=256),a.flags|=65536,a.lanes=m,c!==zm&&(s=Error(i(422),{cause:c}),kc(Zr(s,o)))):(c!==zm&&(a=Error(i(423),{cause:c}),kc(Zr(a,o))),s=s.current.alternate,s.flags|=65536,m&=-m,s.lanes|=m,c=Zr(c,o),m=jf(s.stateNode,c,m),Zm(s,m),bn!==4&&(bn=2)),!1;var f=Error(i(520),{cause:c});if(f=Zr(f,o),zc===null?zc=[f]:zc.push(f),bn!==4&&(bn=2),a===null)return!0;c=Zr(c,o),o=a;do{switch(o.tag){case 3:return o.flags|=65536,s=m&-m,o.lanes|=s,s=jf(o.stateNode,c,s),Zm(o,s),!1;case 1:if(a=o.type,f=o.stateNode,(o.flags&128)===0&&(typeof a.getDerivedStateFromError=="function"||f!==null&&typeof f.componentDidCatch=="function"&&($i===null||!$i.has(f))))return o.flags|=65536,m&=-m,o.lanes|=m,m=Dv(m),Pv(m,s,o,c),Zm(o,m),!1}o=o.return}while(o!==null);return!1}var Tf=Error(i(461)),An=!1;function Qn(s,a,o,c){a.child=s===null?Vb(a,null,o,c):Bo(a,s.child,o,c)}function Lv(s,a,o,c,m){o=o.render;var f=a.ref;if("ref"in c){var w={};for(var N in c)N!=="ref"&&(w[N]=c[N])}else w=c;return Do(a),c=af(s,a,o,w,f,m),N=of(),s!==null&&!An?(lf(s,a,m),ii(s,a,m)):(Cs&&N&&Um(a),a.flags|=1,Qn(s,a,c,m),a.child)}function Ov(s,a,o,c,m){if(s===null){var f=o.type;return typeof f=="function"&&!Om(f)&&f.defaultProps===void 0&&o.compare===null?(a.tag=15,a.type=f,Bv(s,a,f,c,m)):(s=id(o.type,null,c,a,a.mode,m),s.ref=a.ref,s.return=a,a.child=s)}if(f=s.child,!If(s,m)){var w=f.memoizedProps;if(o=o.compare,o=o!==null?o:xc,o(w,c)&&s.ref===a.ref)return ii(s,a,m)}return a.flags|=1,s=ei(f,c),s.ref=a.ref,s.return=a,a.child=s}function Bv(s,a,o,c,m){if(s!==null){var f=s.memoizedProps;if(xc(f,c)&&s.ref===a.ref)if(An=!1,a.pendingProps=c=f,If(s,m))(s.flags&131072)!==0&&(An=!0);else return a.lanes=s.lanes,ii(s,a,m)}return Sf(s,a,o,c,m)}function Vv(s,a,o,c){var m=c.children,f=s!==null?s.memoizedState:null;if(s===null&&a.stateNode===null&&(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),c.mode==="hidden"){if((a.flags&128)!==0){if(f=f!==null?f.baseLanes|o:o,s!==null){for(c=a.child=s.child,m=0;c!==null;)m=m|c.lanes|c.childLanes,c=c.sibling;c=m&~f}else c=0,a.child=null;return Uv(s,a,f,o,c)}if((o&536870912)!==0)a.memoizedState={baseLanes:0,cachePool:null},s!==null&&ud(a,f!==null?f.cachePool:null),f!==null?zb(a,f):tf(),qb(a);else return c=a.lanes=536870912,Uv(s,a,f!==null?f.baseLanes|o:o,o,c)}else f!==null?(ud(a,f.cachePool),zb(a,f),Fi(),a.memoizedState=null):(s!==null&&ud(a,null),tf(),Fi());return Qn(s,a,m,o),a.child}function Pc(s,a){return s!==null&&s.tag===22||a.stateNode!==null||(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),a.sibling}function Uv(s,a,o,c,m){var f=Ym();return f=f===null?null:{parent:Cn._currentValue,pool:f},a.memoizedState={baseLanes:o,cachePool:f},s!==null&&ud(a,null),tf(),qb(a),s!==null&&vl(s,a,c,!0),a.childLanes=m,null}function Sd(s,a){return a=Nd({mode:a.mode,children:a.children},s.mode),a.ref=s.ref,s.child=a,a.return=s,a}function Fv(s,a,o){return Bo(a,s.child,null,o),s=Sd(a,a.pendingProps),s.flags|=2,Fr(a),a.memoizedState=null,s}function Sj(s,a,o){var c=a.pendingProps,m=(a.flags&128)!==0;if(a.flags&=-129,s===null){if(Cs){if(c.mode==="hidden")return s=Sd(a,c),a.lanes=536870912,Pc(null,s);if(nf(a),(s=an)?(s=Z0(s,sa),s=s!==null&&s.data==="&"?s:null,s!==null&&(a.memoizedState={dehydrated:s,treeContext:Ii!==null?{id:Da,overflow:Pa}:null,retryLane:536870912,hydrationErrors:null},o=jb(s),o.return=a,a.child=o,Kn=a,an=null)):s=null,s===null)throw Pi(a);return a.lanes=536870912,null}return Sd(a,c)}var f=s.memoizedState;if(f!==null){var w=f.dehydrated;if(nf(a),m)if(a.flags&256)a.flags&=-257,a=Fv(s,a,o);else if(a.memoizedState!==null)a.child=s.child,a.flags|=128,a=null;else throw Error(i(558));else if(An||vl(s,a,o,!1),m=(o&s.childLanes)!==0,An||m){if(c=Xs,c!==null&&(w=Yt(c,o),w!==0&&w!==f.retryLane))throw f.retryLane=w,Ro(s,w),Rr(c,s,w),Tf;Od(),a=Fv(s,a,o)}else s=f.treeContext,an=ra(w.nextSibling),Kn=a,Cs=!0,Di=null,sa=!1,s!==null&&Eb(a,s),a=Sd(a,c),a.flags|=4096;return a}return s=ei(s.child,{mode:c.mode,children:c.children}),s.ref=a.ref,a.child=s,s.return=a,s}function Ed(s,a){var o=a.ref;if(o===null)s!==null&&s.ref!==null&&(a.flags|=4194816);else{if(typeof o!="function"&&typeof o!="object")throw Error(i(284));(s===null||s.ref!==o)&&(a.flags|=4194816)}}function Sf(s,a,o,c,m){return Do(a),o=af(s,a,o,c,void 0,m),c=of(),s!==null&&!An?(lf(s,a,m),ii(s,a,m)):(Cs&&c&&Um(a),a.flags|=1,Qn(s,a,o,m),a.child)}function zv(s,a,o,c,m,f){return Do(a),a.updateQueue=null,o=$b(a,c,o,m),Hb(s),c=of(),s!==null&&!An?(lf(s,a,f),ii(s,a,f)):(Cs&&c&&Um(a),a.flags|=1,Qn(s,a,o,f),a.child)}function qv(s,a,o,c,m){if(Do(a),a.stateNode===null){var f=pl,w=o.contextType;typeof w=="object"&&w!==null&&(f=Yn(w)),f=new o(c,f),a.memoizedState=f.state!==null&&f.state!==void 0?f.state:null,f.updater=kf,a.stateNode=f,f._reactInternals=a,f=a.stateNode,f.props=c,f.state=a.memoizedState,f.refs={},Xm(a),w=o.contextType,f.context=typeof w=="object"&&w!==null?Yn(w):pl,f.state=a.memoizedState,w=o.getDerivedStateFromProps,typeof w=="function"&&(_f(a,o,w,c),f.state=a.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof f.getSnapshotBeforeUpdate=="function"||typeof f.UNSAFE_componentWillMount!="function"&&typeof f.componentWillMount!="function"||(w=f.state,typeof f.componentWillMount=="function"&&f.componentWillMount(),typeof f.UNSAFE_componentWillMount=="function"&&f.UNSAFE_componentWillMount(),w!==f.state&&kf.enqueueReplaceState(f,f.state,null),Rc(a,c,f,m),Cc(),f.state=a.memoizedState),typeof f.componentDidMount=="function"&&(a.flags|=4194308),c=!0}else if(s===null){f=a.stateNode;var N=a.memoizedProps,H=Uo(o,N);f.props=H;var he=f.context,Ne=o.contextType;w=pl,typeof Ne=="object"&&Ne!==null&&(w=Yn(Ne));var ze=o.getDerivedStateFromProps;Ne=typeof ze=="function"||typeof f.getSnapshotBeforeUpdate=="function",N=a.pendingProps!==N,Ne||typeof f.UNSAFE_componentWillReceiveProps!="function"&&typeof f.componentWillReceiveProps!="function"||(N||he!==w)&&Cv(a,f,c,w),Oi=!1;var fe=a.memoizedState;f.state=fe,Rc(a,c,f,m),Cc(),he=a.memoizedState,N||fe!==he||Oi?(typeof ze=="function"&&(_f(a,o,ze,c),he=a.memoizedState),(H=Oi||Nv(a,o,H,c,fe,he,w))?(Ne||typeof f.UNSAFE_componentWillMount!="function"&&typeof f.componentWillMount!="function"||(typeof f.componentWillMount=="function"&&f.componentWillMount(),typeof f.UNSAFE_componentWillMount=="function"&&f.UNSAFE_componentWillMount()),typeof f.componentDidMount=="function"&&(a.flags|=4194308)):(typeof f.componentDidMount=="function"&&(a.flags|=4194308),a.memoizedProps=c,a.memoizedState=he),f.props=c,f.state=he,f.context=w,c=H):(typeof f.componentDidMount=="function"&&(a.flags|=4194308),c=!1)}else{f=a.stateNode,Jm(s,a),w=a.memoizedProps,Ne=Uo(o,w),f.props=Ne,ze=a.pendingProps,fe=f.context,he=o.contextType,H=pl,typeof he=="object"&&he!==null&&(H=Yn(he)),N=o.getDerivedStateFromProps,(he=typeof N=="function"||typeof f.getSnapshotBeforeUpdate=="function")||typeof f.UNSAFE_componentWillReceiveProps!="function"&&typeof f.componentWillReceiveProps!="function"||(w!==ze||fe!==H)&&Cv(a,f,c,H),Oi=!1,fe=a.memoizedState,f.state=fe,Rc(a,c,f,m),Cc();var we=a.memoizedState;w!==ze||fe!==we||Oi||s!==null&&s.dependencies!==null&&ld(s.dependencies)?(typeof N=="function"&&(_f(a,o,N,c),we=a.memoizedState),(Ne=Oi||Nv(a,o,Ne,c,fe,we,H)||s!==null&&s.dependencies!==null&&ld(s.dependencies))?(he||typeof f.UNSAFE_componentWillUpdate!="function"&&typeof f.componentWillUpdate!="function"||(typeof f.componentWillUpdate=="function"&&f.componentWillUpdate(c,we,H),typeof f.UNSAFE_componentWillUpdate=="function"&&f.UNSAFE_componentWillUpdate(c,we,H)),typeof f.componentDidUpdate=="function"&&(a.flags|=4),typeof f.getSnapshotBeforeUpdate=="function"&&(a.flags|=1024)):(typeof f.componentDidUpdate!="function"||w===s.memoizedProps&&fe===s.memoizedState||(a.flags|=4),typeof f.getSnapshotBeforeUpdate!="function"||w===s.memoizedProps&&fe===s.memoizedState||(a.flags|=1024),a.memoizedProps=c,a.memoizedState=we),f.props=c,f.state=we,f.context=H,c=Ne):(typeof f.componentDidUpdate!="function"||w===s.memoizedProps&&fe===s.memoizedState||(a.flags|=4),typeof f.getSnapshotBeforeUpdate!="function"||w===s.memoizedProps&&fe===s.memoizedState||(a.flags|=1024),c=!1)}return f=c,Ed(s,a),c=(a.flags&128)!==0,f||c?(f=a.stateNode,o=c&&typeof o.getDerivedStateFromError!="function"?null:f.render(),a.flags|=1,s!==null&&c?(a.child=Bo(a,s.child,null,m),a.child=Bo(a,null,o,m)):Qn(s,a,o,m),a.memoizedState=f.state,s=a.child):s=ii(s,a,m),s}function Hv(s,a,o,c){return Mo(),a.flags|=256,Qn(s,a,o,c),a.child}var Ef={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Nf(s){return{baseLanes:s,cachePool:Ib()}}function Cf(s,a,o){return s=s!==null?s.childLanes&~o:0,a&&(s|=qr),s}function $v(s,a,o){var c=a.pendingProps,m=!1,f=(a.flags&128)!==0,w;if((w=f)||(w=s!==null&&s.memoizedState===null?!1:(jn.current&2)!==0),w&&(m=!0,a.flags&=-129),w=(a.flags&32)!==0,a.flags&=-33,s===null){if(Cs){if(m?Ui(a):Fi(),(s=an)?(s=Z0(s,sa),s=s!==null&&s.data!=="&"?s:null,s!==null&&(a.memoizedState={dehydrated:s,treeContext:Ii!==null?{id:Da,overflow:Pa}:null,retryLane:536870912,hydrationErrors:null},o=jb(s),o.return=a,a.child=o,Kn=a,an=null)):s=null,s===null)throw Pi(a);return dp(s)?a.lanes=32:a.lanes=536870912,null}var N=c.children;return c=c.fallback,m?(Fi(),m=a.mode,N=Nd({mode:"hidden",children:N},m),c=Ao(c,m,o,null),N.return=a,c.return=a,N.sibling=c,a.child=N,c=a.child,c.memoizedState=Nf(o),c.childLanes=Cf(s,w,o),a.memoizedState=Ef,Pc(null,c)):(Ui(a),Rf(a,N))}var H=s.memoizedState;if(H!==null&&(N=H.dehydrated,N!==null)){if(f)a.flags&256?(Ui(a),a.flags&=-257,a=Af(s,a,o)):a.memoizedState!==null?(Fi(),a.child=s.child,a.flags|=128,a=null):(Fi(),N=c.fallback,m=a.mode,c=Nd({mode:"visible",children:c.children},m),N=Ao(N,m,o,null),N.flags|=2,c.return=a,N.return=a,c.sibling=N,a.child=c,Bo(a,s.child,null,o),c=a.child,c.memoizedState=Nf(o),c.childLanes=Cf(s,w,o),a.memoizedState=Ef,a=Pc(null,c));else if(Ui(a),dp(N)){if(w=N.nextSibling&&N.nextSibling.dataset,w)var he=w.dgst;w=he,c=Error(i(419)),c.stack="",c.digest=w,kc({value:c,source:null,stack:null}),a=Af(s,a,o)}else if(An||vl(s,a,o,!1),w=(o&s.childLanes)!==0,An||w){if(w=Xs,w!==null&&(c=Yt(w,o),c!==0&&c!==H.retryLane))throw H.retryLane=c,Ro(s,c),Rr(w,s,c),Tf;up(N)||Od(),a=Af(s,a,o)}else up(N)?(a.flags|=192,a.child=s.child,a=null):(s=H.treeContext,an=ra(N.nextSibling),Kn=a,Cs=!0,Di=null,sa=!1,s!==null&&Eb(a,s),a=Rf(a,c.children),a.flags|=4096);return a}return m?(Fi(),N=c.fallback,m=a.mode,H=s.child,he=H.sibling,c=ei(H,{mode:"hidden",children:c.children}),c.subtreeFlags=H.subtreeFlags&65011712,he!==null?N=ei(he,N):(N=Ao(N,m,o,null),N.flags|=2),N.return=a,c.return=a,c.sibling=N,a.child=c,Pc(null,c),c=a.child,N=s.child.memoizedState,N===null?N=Nf(o):(m=N.cachePool,m!==null?(H=Cn._currentValue,m=m.parent!==H?{parent:H,pool:H}:m):m=Ib(),N={baseLanes:N.baseLanes|o,cachePool:m}),c.memoizedState=N,c.childLanes=Cf(s,w,o),a.memoizedState=Ef,Pc(s.child,c)):(Ui(a),o=s.child,s=o.sibling,o=ei(o,{mode:"visible",children:c.children}),o.return=a,o.sibling=null,s!==null&&(w=a.deletions,w===null?(a.deletions=[s],a.flags|=16):w.push(s)),a.child=o,a.memoizedState=null,o)}function Rf(s,a){return a=Nd({mode:"visible",children:a},s.mode),a.return=s,s.child=a}function Nd(s,a){return s=Vr(22,s,null,a),s.lanes=0,s}function Af(s,a,o){return Bo(a,s.child,null,o),s=Rf(a,a.pendingProps.children),s.flags|=2,a.memoizedState=null,s}function Wv(s,a,o){s.lanes|=a;var c=s.alternate;c!==null&&(c.lanes|=a),$m(s.return,a,o)}function Mf(s,a,o,c,m,f){var w=s.memoizedState;w===null?s.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:c,tail:o,tailMode:m,treeForkCount:f}:(w.isBackwards=a,w.rendering=null,w.renderingStartTime=0,w.last=c,w.tail=o,w.tailMode=m,w.treeForkCount=f)}function Gv(s,a,o){var c=a.pendingProps,m=c.revealOrder,f=c.tail;c=c.children;var w=jn.current,N=(w&2)!==0;if(N?(w=w&1|2,a.flags|=128):w&=1,Fe(jn,w),Qn(s,a,c,o),c=Cs?_c:0,!N&&s!==null&&(s.flags&128)!==0)e:for(s=a.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&Wv(s,o,a);else if(s.tag===19)Wv(s,o,a);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===a)break e;for(;s.sibling===null;){if(s.return===null||s.return===a)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}switch(m){case"forwards":for(o=a.child,m=null;o!==null;)s=o.alternate,s!==null&&gd(s)===null&&(m=o),o=o.sibling;o=m,o===null?(m=a.child,a.child=null):(m=o.sibling,o.sibling=null),Mf(a,!1,m,o,f,c);break;case"backwards":case"unstable_legacy-backwards":for(o=null,m=a.child,a.child=null;m!==null;){if(s=m.alternate,s!==null&&gd(s)===null){a.child=m;break}s=m.sibling,m.sibling=o,o=m,m=s}Mf(a,!0,o,null,f,c);break;case"together":Mf(a,!1,null,null,void 0,c);break;default:a.memoizedState=null}return a.child}function ii(s,a,o){if(s!==null&&(a.dependencies=s.dependencies),Hi|=a.lanes,(o&a.childLanes)===0)if(s!==null){if(vl(s,a,o,!1),(o&a.childLanes)===0)return null}else return null;if(s!==null&&a.child!==s.child)throw Error(i(153));if(a.child!==null){for(s=a.child,o=ei(s,s.pendingProps),a.child=o,o.return=a;s.sibling!==null;)s=s.sibling,o=o.sibling=ei(s,s.pendingProps),o.return=a;o.sibling=null}return a.child}function If(s,a){return(s.lanes&a)!==0?!0:(s=s.dependencies,!!(s!==null&&ld(s)))}function Ej(s,a,o){switch(a.tag){case 3:wt(a,a.stateNode.containerInfo),Li(a,Cn,s.memoizedState.cache),Mo();break;case 27:case 5:es(a);break;case 4:wt(a,a.stateNode.containerInfo);break;case 10:Li(a,a.type,a.memoizedProps.value);break;case 31:if(a.memoizedState!==null)return a.flags|=128,nf(a),null;break;case 13:var c=a.memoizedState;if(c!==null)return c.dehydrated!==null?(Ui(a),a.flags|=128,null):(o&a.child.childLanes)!==0?$v(s,a,o):(Ui(a),s=ii(s,a,o),s!==null?s.sibling:null);Ui(a);break;case 19:var m=(s.flags&128)!==0;if(c=(o&a.childLanes)!==0,c||(vl(s,a,o,!1),c=(o&a.childLanes)!==0),m){if(c)return Gv(s,a,o);a.flags|=128}if(m=a.memoizedState,m!==null&&(m.rendering=null,m.tail=null,m.lastEffect=null),Fe(jn,jn.current),c)break;return null;case 22:return a.lanes=0,Vv(s,a,o,a.pendingProps);case 24:Li(a,Cn,s.memoizedState.cache)}return ii(s,a,o)}function Kv(s,a,o){if(s!==null)if(s.memoizedProps!==a.pendingProps)An=!0;else{if(!If(s,o)&&(a.flags&128)===0)return An=!1,Ej(s,a,o);An=(s.flags&131072)!==0}else An=!1,Cs&&(a.flags&1048576)!==0&&Sb(a,_c,a.index);switch(a.lanes=0,a.tag){case 16:e:{var c=a.pendingProps;if(s=Lo(a.elementType),a.type=s,typeof s=="function")Om(s)?(c=Uo(s,c),a.tag=1,a=qv(null,a,s,c,o)):(a.tag=0,a=Sf(null,a,s,c,o));else{if(s!=null){var m=s.$$typeof;if(m===ke){a.tag=11,a=Lv(null,a,s,c,o);break e}else if(m===C){a.tag=14,a=Ov(null,a,s,c,o);break e}}throw a=Le(s)||s,Error(i(306,a,""))}}return a;case 0:return Sf(s,a,a.type,a.pendingProps,o);case 1:return c=a.type,m=Uo(c,a.pendingProps),qv(s,a,c,m,o);case 3:e:{if(wt(a,a.stateNode.containerInfo),s===null)throw Error(i(387));c=a.pendingProps;var f=a.memoizedState;m=f.element,Jm(s,a),Rc(a,c,null,o);var w=a.memoizedState;if(c=w.cache,Li(a,Cn,c),c!==f.cache&&Wm(a,[Cn],o,!0),Cc(),c=w.element,f.isDehydrated)if(f={element:c,isDehydrated:!1,cache:w.cache},a.updateQueue.baseState=f,a.memoizedState=f,a.flags&256){a=Hv(s,a,c,o);break e}else if(c!==m){m=Zr(Error(i(424)),a),kc(m),a=Hv(s,a,c,o);break e}else for(s=a.stateNode.containerInfo,s.nodeType===9?s=s.body:s=s.nodeName==="HTML"?s.ownerDocument.body:s,an=ra(s.firstChild),Kn=a,Cs=!0,Di=null,sa=!0,o=Vb(a,null,c,o),a.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling;else{if(Mo(),c===m){a=ii(s,a,o);break e}Qn(s,a,c,o)}a=a.child}return a;case 26:return Ed(s,a),s===null?(o=a1(a.type,null,a.pendingProps,null))?a.memoizedState=o:Cs||(o=a.type,s=a.pendingProps,c=Hd(Me.current).createElement(o),c[bt]=a,c[At]=s,Xn(c,o,s),me(c),a.stateNode=c):a.memoizedState=a1(a.type,s.memoizedProps,a.pendingProps,s.memoizedState),null;case 27:return es(a),s===null&&Cs&&(c=a.stateNode=s1(a.type,a.pendingProps,Me.current),Kn=a,sa=!0,m=an,Yi(a.type)?(hp=m,an=ra(c.firstChild)):an=m),Qn(s,a,a.pendingProps.children,o),Ed(s,a),s===null&&(a.flags|=4194304),a.child;case 5:return s===null&&Cs&&((m=c=an)&&(c=nT(c,a.type,a.pendingProps,sa),c!==null?(a.stateNode=c,Kn=a,an=ra(c.firstChild),sa=!1,m=!0):m=!1),m||Pi(a)),es(a),m=a.type,f=a.pendingProps,w=s!==null?s.memoizedProps:null,c=f.children,op(m,f)?c=null:w!==null&&op(m,w)&&(a.flags|=32),a.memoizedState!==null&&(m=af(s,a,bj,null,null,o),Qc._currentValue=m),Ed(s,a),Qn(s,a,c,o),a.child;case 6:return s===null&&Cs&&((s=o=an)&&(o=rT(o,a.pendingProps,sa),o!==null?(a.stateNode=o,Kn=a,an=null,s=!0):s=!1),s||Pi(a)),null;case 13:return $v(s,a,o);case 4:return wt(a,a.stateNode.containerInfo),c=a.pendingProps,s===null?a.child=Bo(a,null,c,o):Qn(s,a,c,o),a.child;case 11:return Lv(s,a,a.type,a.pendingProps,o);case 7:return Qn(s,a,a.pendingProps,o),a.child;case 8:return Qn(s,a,a.pendingProps.children,o),a.child;case 12:return Qn(s,a,a.pendingProps.children,o),a.child;case 10:return c=a.pendingProps,Li(a,a.type,c.value),Qn(s,a,c.children,o),a.child;case 9:return m=a.type._context,c=a.pendingProps.children,Do(a),m=Yn(m),c=c(m),a.flags|=1,Qn(s,a,c,o),a.child;case 14:return Ov(s,a,a.type,a.pendingProps,o);case 15:return Bv(s,a,a.type,a.pendingProps,o);case 19:return Gv(s,a,o);case 31:return Sj(s,a,o);case 22:return Vv(s,a,o,a.pendingProps);case 24:return Do(a),c=Yn(Cn),s===null?(m=Ym(),m===null&&(m=Xs,f=Gm(),m.pooledCache=f,f.refCount++,f!==null&&(m.pooledCacheLanes|=o),m=f),a.memoizedState={parent:c,cache:m},Xm(a),Li(a,Cn,m)):((s.lanes&o)!==0&&(Jm(s,a),Rc(a,null,null,o),Cc()),m=s.memoizedState,f=a.memoizedState,m.parent!==c?(m={parent:c,cache:c},a.memoizedState=m,a.lanes===0&&(a.memoizedState=a.updateQueue.baseState=m),Li(a,Cn,c)):(c=f.cache,Li(a,Cn,c),c!==m.cache&&Wm(a,[Cn],o,!0))),Qn(s,a,a.pendingProps.children,o),a.child;case 29:throw a.pendingProps}throw Error(i(156,a.tag))}function oi(s){s.flags|=4}function Df(s,a,o,c,m){if((a=(s.mode&32)!==0)&&(a=!1),a){if(s.flags|=16777216,(m&335544128)===m)if(s.stateNode.complete)s.flags|=8192;else if(w0())s.flags|=8192;else throw Oo=hd,Qm}else s.flags&=-16777217}function Yv(s,a){if(a.type!=="stylesheet"||(a.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!u1(a))if(w0())s.flags|=8192;else throw Oo=hd,Qm}function Cd(s,a){a!==null&&(s.flags|=4),s.flags&16384&&(a=s.tag!==22?Q():536870912,s.lanes|=a,Al|=a)}function Lc(s,a){if(!Cs)switch(s.tailMode){case"hidden":a=s.tail;for(var o=null;a!==null;)a.alternate!==null&&(o=a),a=a.sibling;o===null?s.tail=null:o.sibling=null;break;case"collapsed":o=s.tail;for(var c=null;o!==null;)o.alternate!==null&&(c=o),o=o.sibling;c===null?a||s.tail===null?s.tail=null:s.tail.sibling=null:c.sibling=null}}function on(s){var a=s.alternate!==null&&s.alternate.child===s.child,o=0,c=0;if(a)for(var m=s.child;m!==null;)o|=m.lanes|m.childLanes,c|=m.subtreeFlags&65011712,c|=m.flags&65011712,m.return=s,m=m.sibling;else for(m=s.child;m!==null;)o|=m.lanes|m.childLanes,c|=m.subtreeFlags,c|=m.flags,m.return=s,m=m.sibling;return s.subtreeFlags|=c,s.childLanes=o,a}function Nj(s,a,o){var c=a.pendingProps;switch(Fm(a),a.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return on(a),null;case 1:return on(a),null;case 3:return o=a.stateNode,c=null,s!==null&&(c=s.memoizedState.cache),a.memoizedState.cache!==c&&(a.flags|=2048),ni(Cn),ot(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(s===null||s.child===null)&&(bl(a)?oi(a):s===null||s.memoizedState.isDehydrated&&(a.flags&256)===0||(a.flags|=1024,qm())),on(a),null;case 26:var m=a.type,f=a.memoizedState;return s===null?(oi(a),f!==null?(on(a),Yv(a,f)):(on(a),Df(a,m,null,c,o))):f?f!==s.memoizedState?(oi(a),on(a),Yv(a,f)):(on(a),a.flags&=-16777217):(s=s.memoizedProps,s!==c&&oi(a),on(a),Df(a,m,s,c,o)),null;case 27:if(Ns(a),o=Me.current,m=a.type,s!==null&&a.stateNode!=null)s.memoizedProps!==c&&oi(a);else{if(!c){if(a.stateNode===null)throw Error(i(166));return on(a),null}s=qe.current,bl(a)?Nb(a):(s=s1(m,c,o),a.stateNode=s,oi(a))}return on(a),null;case 5:if(Ns(a),m=a.type,s!==null&&a.stateNode!=null)s.memoizedProps!==c&&oi(a);else{if(!c){if(a.stateNode===null)throw Error(i(166));return on(a),null}if(f=qe.current,bl(a))Nb(a);else{var w=Hd(Me.current);switch(f){case 1:f=w.createElementNS("http://www.w3.org/2000/svg",m);break;case 2:f=w.createElementNS("http://www.w3.org/1998/Math/MathML",m);break;default:switch(m){case"svg":f=w.createElementNS("http://www.w3.org/2000/svg",m);break;case"math":f=w.createElementNS("http://www.w3.org/1998/Math/MathML",m);break;case"script":f=w.createElement("div"),f.innerHTML="<script><\/script>",f=f.removeChild(f.firstChild);break;case"select":f=typeof c.is=="string"?w.createElement("select",{is:c.is}):w.createElement("select"),c.multiple?f.multiple=!0:c.size&&(f.size=c.size);break;default:f=typeof c.is=="string"?w.createElement(m,{is:c.is}):w.createElement(m)}}f[bt]=a,f[At]=c;e:for(w=a.child;w!==null;){if(w.tag===5||w.tag===6)f.appendChild(w.stateNode);else if(w.tag!==4&&w.tag!==27&&w.child!==null){w.child.return=w,w=w.child;continue}if(w===a)break e;for(;w.sibling===null;){if(w.return===null||w.return===a)break e;w=w.return}w.sibling.return=w.return,w=w.sibling}a.stateNode=f;e:switch(Xn(f,m,c),m){case"button":case"input":case"select":case"textarea":c=!!c.autoFocus;break e;case"img":c=!0;break e;default:c=!1}c&&oi(a)}}return on(a),Df(a,a.type,s===null?null:s.memoizedProps,a.pendingProps,o),null;case 6:if(s&&a.stateNode!=null)s.memoizedProps!==c&&oi(a);else{if(typeof c!="string"&&a.stateNode===null)throw Error(i(166));if(s=Me.current,bl(a)){if(s=a.stateNode,o=a.memoizedProps,c=null,m=Kn,m!==null)switch(m.tag){case 27:case 5:c=m.memoizedProps}s[bt]=a,s=!!(s.nodeValue===o||c!==null&&c.suppressHydrationWarning===!0||$0(s.nodeValue,o)),s||Pi(a,!0)}else s=Hd(s).createTextNode(c),s[bt]=a,a.stateNode=s}return on(a),null;case 31:if(o=a.memoizedState,s===null||s.memoizedState!==null){if(c=bl(a),o!==null){if(s===null){if(!c)throw Error(i(318));if(s=a.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(557));s[bt]=a}else Mo(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;on(a),s=!1}else o=qm(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=o),s=!0;if(!s)return a.flags&256?(Fr(a),a):(Fr(a),null);if((a.flags&128)!==0)throw Error(i(558))}return on(a),null;case 13:if(c=a.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(m=bl(a),c!==null&&c.dehydrated!==null){if(s===null){if(!m)throw Error(i(318));if(m=a.memoizedState,m=m!==null?m.dehydrated:null,!m)throw Error(i(317));m[bt]=a}else Mo(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;on(a),m=!1}else m=qm(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=m),m=!0;if(!m)return a.flags&256?(Fr(a),a):(Fr(a),null)}return Fr(a),(a.flags&128)!==0?(a.lanes=o,a):(o=c!==null,s=s!==null&&s.memoizedState!==null,o&&(c=a.child,m=null,c.alternate!==null&&c.alternate.memoizedState!==null&&c.alternate.memoizedState.cachePool!==null&&(m=c.alternate.memoizedState.cachePool.pool),f=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(f=c.memoizedState.cachePool.pool),f!==m&&(c.flags|=2048)),o!==s&&o&&(a.child.flags|=8192),Cd(a,a.updateQueue),on(a),null);case 4:return ot(),s===null&&sp(a.stateNode.containerInfo),on(a),null;case 10:return ni(a.type),on(a),null;case 19:if(re(jn),c=a.memoizedState,c===null)return on(a),null;if(m=(a.flags&128)!==0,f=c.rendering,f===null)if(m)Lc(c,!1);else{if(bn!==0||s!==null&&(s.flags&128)!==0)for(s=a.child;s!==null;){if(f=gd(s),f!==null){for(a.flags|=128,Lc(c,!1),s=f.updateQueue,a.updateQueue=s,Cd(a,s),a.subtreeFlags=0,s=o,o=a.child;o!==null;)kb(o,s),o=o.sibling;return Fe(jn,jn.current&1|2),Cs&&ti(a,c.treeForkCount),a.child}s=s.sibling}c.tail!==null&&Gt()>Dd&&(a.flags|=128,m=!0,Lc(c,!1),a.lanes=4194304)}else{if(!m)if(s=gd(f),s!==null){if(a.flags|=128,m=!0,s=s.updateQueue,a.updateQueue=s,Cd(a,s),Lc(c,!0),c.tail===null&&c.tailMode==="hidden"&&!f.alternate&&!Cs)return on(a),null}else 2*Gt()-c.renderingStartTime>Dd&&o!==536870912&&(a.flags|=128,m=!0,Lc(c,!1),a.lanes=4194304);c.isBackwards?(f.sibling=a.child,a.child=f):(s=c.last,s!==null?s.sibling=f:a.child=f,c.last=f)}return c.tail!==null?(s=c.tail,c.rendering=s,c.tail=s.sibling,c.renderingStartTime=Gt(),s.sibling=null,o=jn.current,Fe(jn,m?o&1|2:o&1),Cs&&ti(a,c.treeForkCount),s):(on(a),null);case 22:case 23:return Fr(a),sf(),c=a.memoizedState!==null,s!==null?s.memoizedState!==null!==c&&(a.flags|=8192):c&&(a.flags|=8192),c?(o&536870912)!==0&&(a.flags&128)===0&&(on(a),a.subtreeFlags&6&&(a.flags|=8192)):on(a),o=a.updateQueue,o!==null&&Cd(a,o.retryQueue),o=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(o=s.memoizedState.cachePool.pool),c=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(c=a.memoizedState.cachePool.pool),c!==o&&(a.flags|=2048),s!==null&&re(Po),null;case 24:return o=null,s!==null&&(o=s.memoizedState.cache),a.memoizedState.cache!==o&&(a.flags|=2048),ni(Cn),on(a),null;case 25:return null;case 30:return null}throw Error(i(156,a.tag))}function Cj(s,a){switch(Fm(a),a.tag){case 1:return s=a.flags,s&65536?(a.flags=s&-65537|128,a):null;case 3:return ni(Cn),ot(),s=a.flags,(s&65536)!==0&&(s&128)===0?(a.flags=s&-65537|128,a):null;case 26:case 27:case 5:return Ns(a),null;case 31:if(a.memoizedState!==null){if(Fr(a),a.alternate===null)throw Error(i(340));Mo()}return s=a.flags,s&65536?(a.flags=s&-65537|128,a):null;case 13:if(Fr(a),s=a.memoizedState,s!==null&&s.dehydrated!==null){if(a.alternate===null)throw Error(i(340));Mo()}return s=a.flags,s&65536?(a.flags=s&-65537|128,a):null;case 19:return re(jn),null;case 4:return ot(),null;case 10:return ni(a.type),null;case 22:case 23:return Fr(a),sf(),s!==null&&re(Po),s=a.flags,s&65536?(a.flags=s&-65537|128,a):null;case 24:return ni(Cn),null;case 25:return null;default:return null}}function Qv(s,a){switch(Fm(a),a.tag){case 3:ni(Cn),ot();break;case 26:case 27:case 5:Ns(a);break;case 4:ot();break;case 31:a.memoizedState!==null&&Fr(a);break;case 13:Fr(a);break;case 19:re(jn);break;case 10:ni(a.type);break;case 22:case 23:Fr(a),sf(),s!==null&&re(Po);break;case 24:ni(Cn)}}function Oc(s,a){try{var o=a.updateQueue,c=o!==null?o.lastEffect:null;if(c!==null){var m=c.next;o=m;do{if((o.tag&s)===s){c=void 0;var f=o.create,w=o.inst;c=f(),w.destroy=c}o=o.next}while(o!==m)}}catch(N){$s(a,a.return,N)}}function zi(s,a,o){try{var c=a.updateQueue,m=c!==null?c.lastEffect:null;if(m!==null){var f=m.next;c=f;do{if((c.tag&s)===s){var w=c.inst,N=w.destroy;if(N!==void 0){w.destroy=void 0,m=a;var H=o,he=N;try{he()}catch(Ne){$s(m,H,Ne)}}}c=c.next}while(c!==f)}}catch(Ne){$s(a,a.return,Ne)}}function Xv(s){var a=s.updateQueue;if(a!==null){var o=s.stateNode;try{Fb(a,o)}catch(c){$s(s,s.return,c)}}}function Jv(s,a,o){o.props=Uo(s.type,s.memoizedProps),o.state=s.memoizedState;try{o.componentWillUnmount()}catch(c){$s(s,a,c)}}function Bc(s,a){try{var o=s.ref;if(o!==null){switch(s.tag){case 26:case 27:case 5:var c=s.stateNode;break;case 30:c=s.stateNode;break;default:c=s.stateNode}typeof o=="function"?s.refCleanup=o(c):o.current=c}}catch(m){$s(s,a,m)}}function La(s,a){var o=s.ref,c=s.refCleanup;if(o!==null)if(typeof c=="function")try{c()}catch(m){$s(s,a,m)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof o=="function")try{o(null)}catch(m){$s(s,a,m)}else o.current=null}function Zv(s){var a=s.type,o=s.memoizedProps,c=s.stateNode;try{e:switch(a){case"button":case"input":case"select":case"textarea":o.autoFocus&&c.focus();break e;case"img":o.src?c.src=o.src:o.srcSet&&(c.srcset=o.srcSet)}}catch(m){$s(s,s.return,m)}}function Pf(s,a,o){try{var c=s.stateNode;Xj(c,s.type,o,a),c[At]=a}catch(m){$s(s,s.return,m)}}function e0(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&Yi(s.type)||s.tag===4}function Lf(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||e0(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&Yi(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function Of(s,a,o){var c=s.tag;if(c===5||c===6)s=s.stateNode,a?(o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o).insertBefore(s,a):(a=o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o,a.appendChild(s),o=o._reactRootContainer,o!=null||a.onclick!==null||(a.onclick=Fn));else if(c!==4&&(c===27&&Yi(s.type)&&(o=s.stateNode,a=null),s=s.child,s!==null))for(Of(s,a,o),s=s.sibling;s!==null;)Of(s,a,o),s=s.sibling}function Rd(s,a,o){var c=s.tag;if(c===5||c===6)s=s.stateNode,a?o.insertBefore(s,a):o.appendChild(s);else if(c!==4&&(c===27&&Yi(s.type)&&(o=s.stateNode),s=s.child,s!==null))for(Rd(s,a,o),s=s.sibling;s!==null;)Rd(s,a,o),s=s.sibling}function t0(s){var a=s.stateNode,o=s.memoizedProps;try{for(var c=s.type,m=a.attributes;m.length;)a.removeAttributeNode(m[0]);Xn(a,c,o),a[bt]=s,a[At]=o}catch(f){$s(s,s.return,f)}}var li=!1,Mn=!1,Bf=!1,s0=typeof WeakSet=="function"?WeakSet:Set,qn=null;function Rj(s,a){if(s=s.containerInfo,ap=Xd,s=fb(s),Rm(s)){if("selectionStart"in s)var o={start:s.selectionStart,end:s.selectionEnd};else e:{o=(o=s.ownerDocument)&&o.defaultView||window;var c=o.getSelection&&o.getSelection();if(c&&c.rangeCount!==0){o=c.anchorNode;var m=c.anchorOffset,f=c.focusNode;c=c.focusOffset;try{o.nodeType,f.nodeType}catch{o=null;break e}var w=0,N=-1,H=-1,he=0,Ne=0,ze=s,fe=null;t:for(;;){for(var we;ze!==o||m!==0&&ze.nodeType!==3||(N=w+m),ze!==f||c!==0&&ze.nodeType!==3||(H=w+c),ze.nodeType===3&&(w+=ze.nodeValue.length),(we=ze.firstChild)!==null;)fe=ze,ze=we;for(;;){if(ze===s)break t;if(fe===o&&++he===m&&(N=w),fe===f&&++Ne===c&&(H=w),(we=ze.nextSibling)!==null)break;ze=fe,fe=ze.parentNode}ze=we}o=N===-1||H===-1?null:{start:N,end:H}}else o=null}o=o||{start:0,end:0}}else o=null;for(ip={focusedElem:s,selectionRange:o},Xd=!1,qn=a;qn!==null;)if(a=qn,s=a.child,(a.subtreeFlags&1028)!==0&&s!==null)s.return=a,qn=s;else for(;qn!==null;){switch(a=qn,f=a.alternate,s=a.flags,a.tag){case 0:if((s&4)!==0&&(s=a.updateQueue,s=s!==null?s.events:null,s!==null))for(o=0;o<s.length;o++)m=s[o],m.ref.impl=m.nextImpl;break;case 11:case 15:break;case 1:if((s&1024)!==0&&f!==null){s=void 0,o=a,m=f.memoizedProps,f=f.memoizedState,c=o.stateNode;try{var Rt=Uo(o.type,m);s=c.getSnapshotBeforeUpdate(Rt,f),c.__reactInternalSnapshotBeforeUpdate=s}catch($t){$s(o,o.return,$t)}}break;case 3:if((s&1024)!==0){if(s=a.stateNode.containerInfo,o=s.nodeType,o===9)cp(s);else if(o===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":cp(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(i(163))}if(s=a.sibling,s!==null){s.return=a.return,qn=s;break}qn=a.return}}function n0(s,a,o){var c=o.flags;switch(o.tag){case 0:case 11:case 15:ui(s,o),c&4&&Oc(5,o);break;case 1:if(ui(s,o),c&4)if(s=o.stateNode,a===null)try{s.componentDidMount()}catch(w){$s(o,o.return,w)}else{var m=Uo(o.type,a.memoizedProps);a=a.memoizedState;try{s.componentDidUpdate(m,a,s.__reactInternalSnapshotBeforeUpdate)}catch(w){$s(o,o.return,w)}}c&64&&Xv(o),c&512&&Bc(o,o.return);break;case 3:if(ui(s,o),c&64&&(s=o.updateQueue,s!==null)){if(a=null,o.child!==null)switch(o.child.tag){case 27:case 5:a=o.child.stateNode;break;case 1:a=o.child.stateNode}try{Fb(s,a)}catch(w){$s(o,o.return,w)}}break;case 27:a===null&&c&4&&t0(o);case 26:case 5:ui(s,o),a===null&&c&4&&Zv(o),c&512&&Bc(o,o.return);break;case 12:ui(s,o);break;case 31:ui(s,o),c&4&&i0(s,o);break;case 13:ui(s,o),c&4&&o0(s,o),c&64&&(s=o.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(o=Vj.bind(null,o),aT(s,o))));break;case 22:if(c=o.memoizedState!==null||li,!c){a=a!==null&&a.memoizedState!==null||Mn,m=li;var f=Mn;li=c,(Mn=a)&&!f?di(s,o,(o.subtreeFlags&8772)!==0):ui(s,o),li=m,Mn=f}break;case 30:break;default:ui(s,o)}}function r0(s){var a=s.alternate;a!==null&&(s.alternate=null,r0(a)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(a=s.stateNode,a!==null&&En(a)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var un=null,Sr=!1;function ci(s,a,o){for(o=o.child;o!==null;)a0(s,a,o),o=o.sibling}function a0(s,a,o){if(be&&typeof be.onCommitFiberUnmount=="function")try{be.onCommitFiberUnmount(ws,o)}catch{}switch(o.tag){case 26:Mn||La(o,a),ci(s,a,o),o.memoizedState?o.memoizedState.count--:o.stateNode&&(o=o.stateNode,o.parentNode.removeChild(o));break;case 27:Mn||La(o,a);var c=un,m=Sr;Yi(o.type)&&(un=o.stateNode,Sr=!1),ci(s,a,o),Gc(o.stateNode),un=c,Sr=m;break;case 5:Mn||La(o,a);case 6:if(c=un,m=Sr,un=null,ci(s,a,o),un=c,Sr=m,un!==null)if(Sr)try{(un.nodeType===9?un.body:un.nodeName==="HTML"?un.ownerDocument.body:un).removeChild(o.stateNode)}catch(f){$s(o,a,f)}else try{un.removeChild(o.stateNode)}catch(f){$s(o,a,f)}break;case 18:un!==null&&(Sr?(s=un,X0(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,o.stateNode),Vl(s)):X0(un,o.stateNode));break;case 4:c=un,m=Sr,un=o.stateNode.containerInfo,Sr=!0,ci(s,a,o),un=c,Sr=m;break;case 0:case 11:case 14:case 15:zi(2,o,a),Mn||zi(4,o,a),ci(s,a,o);break;case 1:Mn||(La(o,a),c=o.stateNode,typeof c.componentWillUnmount=="function"&&Jv(o,a,c)),ci(s,a,o);break;case 21:ci(s,a,o);break;case 22:Mn=(c=Mn)||o.memoizedState!==null,ci(s,a,o),Mn=c;break;default:ci(s,a,o)}}function i0(s,a){if(a.memoizedState===null&&(s=a.alternate,s!==null&&(s=s.memoizedState,s!==null))){s=s.dehydrated;try{Vl(s)}catch(o){$s(a,a.return,o)}}}function o0(s,a){if(a.memoizedState===null&&(s=a.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{Vl(s)}catch(o){$s(a,a.return,o)}}function Aj(s){switch(s.tag){case 31:case 13:case 19:var a=s.stateNode;return a===null&&(a=s.stateNode=new s0),a;case 22:return s=s.stateNode,a=s._retryCache,a===null&&(a=s._retryCache=new s0),a;default:throw Error(i(435,s.tag))}}function Ad(s,a){var o=Aj(s);a.forEach(function(c){if(!o.has(c)){o.add(c);var m=Uj.bind(null,s,c);c.then(m,m)}})}function Er(s,a){var o=a.deletions;if(o!==null)for(var c=0;c<o.length;c++){var m=o[c],f=s,w=a,N=w;e:for(;N!==null;){switch(N.tag){case 27:if(Yi(N.type)){un=N.stateNode,Sr=!1;break e}break;case 5:un=N.stateNode,Sr=!1;break e;case 3:case 4:un=N.stateNode.containerInfo,Sr=!0;break e}N=N.return}if(un===null)throw Error(i(160));a0(f,w,m),un=null,Sr=!1,f=m.alternate,f!==null&&(f.return=null),m.return=null}if(a.subtreeFlags&13886)for(a=a.child;a!==null;)l0(a,s),a=a.sibling}var ga=null;function l0(s,a){var o=s.alternate,c=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:Er(a,s),Nr(s),c&4&&(zi(3,s,s.return),Oc(3,s),zi(5,s,s.return));break;case 1:Er(a,s),Nr(s),c&512&&(Mn||o===null||La(o,o.return)),c&64&&li&&(s=s.updateQueue,s!==null&&(c=s.callbacks,c!==null&&(o=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=o===null?c:o.concat(c))));break;case 26:var m=ga;if(Er(a,s),Nr(s),c&512&&(Mn||o===null||La(o,o.return)),c&4){var f=o!==null?o.memoizedState:null;if(c=s.memoizedState,o===null)if(c===null)if(s.stateNode===null){e:{c=s.type,o=s.memoizedProps,m=m.ownerDocument||m;t:switch(c){case"title":f=m.getElementsByTagName("title")[0],(!f||f[tn]||f[bt]||f.namespaceURI==="http://www.w3.org/2000/svg"||f.hasAttribute("itemprop"))&&(f=m.createElement(c),m.head.insertBefore(f,m.querySelector("head > title"))),Xn(f,c,o),f[bt]=s,me(f),c=f;break e;case"link":var w=l1("link","href",m).get(c+(o.href||""));if(w){for(var N=0;N<w.length;N++)if(f=w[N],f.getAttribute("href")===(o.href==null||o.href===""?null:o.href)&&f.getAttribute("rel")===(o.rel==null?null:o.rel)&&f.getAttribute("title")===(o.title==null?null:o.title)&&f.getAttribute("crossorigin")===(o.crossOrigin==null?null:o.crossOrigin)){w.splice(N,1);break t}}f=m.createElement(c),Xn(f,c,o),m.head.appendChild(f);break;case"meta":if(w=l1("meta","content",m).get(c+(o.content||""))){for(N=0;N<w.length;N++)if(f=w[N],f.getAttribute("content")===(o.content==null?null:""+o.content)&&f.getAttribute("name")===(o.name==null?null:o.name)&&f.getAttribute("property")===(o.property==null?null:o.property)&&f.getAttribute("http-equiv")===(o.httpEquiv==null?null:o.httpEquiv)&&f.getAttribute("charset")===(o.charSet==null?null:o.charSet)){w.splice(N,1);break t}}f=m.createElement(c),Xn(f,c,o),m.head.appendChild(f);break;default:throw Error(i(468,c))}f[bt]=s,me(f),c=f}s.stateNode=c}else c1(m,s.type,s.stateNode);else s.stateNode=o1(m,c,s.memoizedProps);else f!==c?(f===null?o.stateNode!==null&&(o=o.stateNode,o.parentNode.removeChild(o)):f.count--,c===null?c1(m,s.type,s.stateNode):o1(m,c,s.memoizedProps)):c===null&&s.stateNode!==null&&Pf(s,s.memoizedProps,o.memoizedProps)}break;case 27:Er(a,s),Nr(s),c&512&&(Mn||o===null||La(o,o.return)),o!==null&&c&4&&Pf(s,s.memoizedProps,o.memoizedProps);break;case 5:if(Er(a,s),Nr(s),c&512&&(Mn||o===null||La(o,o.return)),s.flags&32){m=s.stateNode;try{Un(m,"")}catch(Rt){$s(s,s.return,Rt)}}c&4&&s.stateNode!=null&&(m=s.memoizedProps,Pf(s,m,o!==null?o.memoizedProps:m)),c&1024&&(Bf=!0);break;case 6:if(Er(a,s),Nr(s),c&4){if(s.stateNode===null)throw Error(i(162));c=s.memoizedProps,o=s.stateNode;try{o.nodeValue=c}catch(Rt){$s(s,s.return,Rt)}}break;case 3:if(Gd=null,m=ga,ga=$d(a.containerInfo),Er(a,s),ga=m,Nr(s),c&4&&o!==null&&o.memoizedState.isDehydrated)try{Vl(a.containerInfo)}catch(Rt){$s(s,s.return,Rt)}Bf&&(Bf=!1,c0(s));break;case 4:c=ga,ga=$d(s.stateNode.containerInfo),Er(a,s),Nr(s),ga=c;break;case 12:Er(a,s),Nr(s);break;case 31:Er(a,s),Nr(s),c&4&&(c=s.updateQueue,c!==null&&(s.updateQueue=null,Ad(s,c)));break;case 13:Er(a,s),Nr(s),s.child.flags&8192&&s.memoizedState!==null!=(o!==null&&o.memoizedState!==null)&&(Id=Gt()),c&4&&(c=s.updateQueue,c!==null&&(s.updateQueue=null,Ad(s,c)));break;case 22:m=s.memoizedState!==null;var H=o!==null&&o.memoizedState!==null,he=li,Ne=Mn;if(li=he||m,Mn=Ne||H,Er(a,s),Mn=Ne,li=he,Nr(s),c&8192)e:for(a=s.stateNode,a._visibility=m?a._visibility&-2:a._visibility|1,m&&(o===null||H||li||Mn||Fo(s)),o=null,a=s;;){if(a.tag===5||a.tag===26){if(o===null){H=o=a;try{if(f=H.stateNode,m)w=f.style,typeof w.setProperty=="function"?w.setProperty("display","none","important"):w.display="none";else{N=H.stateNode;var ze=H.memoizedProps.style,fe=ze!=null&&ze.hasOwnProperty("display")?ze.display:null;N.style.display=fe==null||typeof fe=="boolean"?"":(""+fe).trim()}}catch(Rt){$s(H,H.return,Rt)}}}else if(a.tag===6){if(o===null){H=a;try{H.stateNode.nodeValue=m?"":H.memoizedProps}catch(Rt){$s(H,H.return,Rt)}}}else if(a.tag===18){if(o===null){H=a;try{var we=H.stateNode;m?J0(we,!0):J0(H.stateNode,!1)}catch(Rt){$s(H,H.return,Rt)}}}else if((a.tag!==22&&a.tag!==23||a.memoizedState===null||a===s)&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===s)break e;for(;a.sibling===null;){if(a.return===null||a.return===s)break e;o===a&&(o=null),a=a.return}o===a&&(o=null),a.sibling.return=a.return,a=a.sibling}c&4&&(c=s.updateQueue,c!==null&&(o=c.retryQueue,o!==null&&(c.retryQueue=null,Ad(s,o))));break;case 19:Er(a,s),Nr(s),c&4&&(c=s.updateQueue,c!==null&&(s.updateQueue=null,Ad(s,c)));break;case 30:break;case 21:break;default:Er(a,s),Nr(s)}}function Nr(s){var a=s.flags;if(a&2){try{for(var o,c=s.return;c!==null;){if(e0(c)){o=c;break}c=c.return}if(o==null)throw Error(i(160));switch(o.tag){case 27:var m=o.stateNode,f=Lf(s);Rd(s,f,m);break;case 5:var w=o.stateNode;o.flags&32&&(Un(w,""),o.flags&=-33);var N=Lf(s);Rd(s,N,w);break;case 3:case 4:var H=o.stateNode.containerInfo,he=Lf(s);Of(s,he,H);break;default:throw Error(i(161))}}catch(Ne){$s(s,s.return,Ne)}s.flags&=-3}a&4096&&(s.flags&=-4097)}function c0(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var a=s;c0(a),a.tag===5&&a.flags&1024&&a.stateNode.reset(),s=s.sibling}}function ui(s,a){if(a.subtreeFlags&8772)for(a=a.child;a!==null;)n0(s,a.alternate,a),a=a.sibling}function Fo(s){for(s=s.child;s!==null;){var a=s;switch(a.tag){case 0:case 11:case 14:case 15:zi(4,a,a.return),Fo(a);break;case 1:La(a,a.return);var o=a.stateNode;typeof o.componentWillUnmount=="function"&&Jv(a,a.return,o),Fo(a);break;case 27:Gc(a.stateNode);case 26:case 5:La(a,a.return),Fo(a);break;case 22:a.memoizedState===null&&Fo(a);break;case 30:Fo(a);break;default:Fo(a)}s=s.sibling}}function di(s,a,o){for(o=o&&(a.subtreeFlags&8772)!==0,a=a.child;a!==null;){var c=a.alternate,m=s,f=a,w=f.flags;switch(f.tag){case 0:case 11:case 15:di(m,f,o),Oc(4,f);break;case 1:if(di(m,f,o),c=f,m=c.stateNode,typeof m.componentDidMount=="function")try{m.componentDidMount()}catch(he){$s(c,c.return,he)}if(c=f,m=c.updateQueue,m!==null){var N=c.stateNode;try{var H=m.shared.hiddenCallbacks;if(H!==null)for(m.shared.hiddenCallbacks=null,m=0;m<H.length;m++)Ub(H[m],N)}catch(he){$s(c,c.return,he)}}o&&w&64&&Xv(f),Bc(f,f.return);break;case 27:t0(f);case 26:case 5:di(m,f,o),o&&c===null&&w&4&&Zv(f),Bc(f,f.return);break;case 12:di(m,f,o);break;case 31:di(m,f,o),o&&w&4&&i0(m,f);break;case 13:di(m,f,o),o&&w&4&&o0(m,f);break;case 22:f.memoizedState===null&&di(m,f,o),Bc(f,f.return);break;case 30:break;default:di(m,f,o)}a=a.sibling}}function Vf(s,a){var o=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(o=s.memoizedState.cachePool.pool),s=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(s=a.memoizedState.cachePool.pool),s!==o&&(s!=null&&s.refCount++,o!=null&&jc(o))}function Uf(s,a){s=null,a.alternate!==null&&(s=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==s&&(a.refCount++,s!=null&&jc(s))}function ya(s,a,o,c){if(a.subtreeFlags&10256)for(a=a.child;a!==null;)u0(s,a,o,c),a=a.sibling}function u0(s,a,o,c){var m=a.flags;switch(a.tag){case 0:case 11:case 15:ya(s,a,o,c),m&2048&&Oc(9,a);break;case 1:ya(s,a,o,c);break;case 3:ya(s,a,o,c),m&2048&&(s=null,a.alternate!==null&&(s=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==s&&(a.refCount++,s!=null&&jc(s)));break;case 12:if(m&2048){ya(s,a,o,c),s=a.stateNode;try{var f=a.memoizedProps,w=f.id,N=f.onPostCommit;typeof N=="function"&&N(w,a.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(H){$s(a,a.return,H)}}else ya(s,a,o,c);break;case 31:ya(s,a,o,c);break;case 13:ya(s,a,o,c);break;case 23:break;case 22:f=a.stateNode,w=a.alternate,a.memoizedState!==null?f._visibility&2?ya(s,a,o,c):Vc(s,a):f._visibility&2?ya(s,a,o,c):(f._visibility|=2,Nl(s,a,o,c,(a.subtreeFlags&10256)!==0||!1)),m&2048&&Vf(w,a);break;case 24:ya(s,a,o,c),m&2048&&Uf(a.alternate,a);break;default:ya(s,a,o,c)}}function Nl(s,a,o,c,m){for(m=m&&((a.subtreeFlags&10256)!==0||!1),a=a.child;a!==null;){var f=s,w=a,N=o,H=c,he=w.flags;switch(w.tag){case 0:case 11:case 15:Nl(f,w,N,H,m),Oc(8,w);break;case 23:break;case 22:var Ne=w.stateNode;w.memoizedState!==null?Ne._visibility&2?Nl(f,w,N,H,m):Vc(f,w):(Ne._visibility|=2,Nl(f,w,N,H,m)),m&&he&2048&&Vf(w.alternate,w);break;case 24:Nl(f,w,N,H,m),m&&he&2048&&Uf(w.alternate,w);break;default:Nl(f,w,N,H,m)}a=a.sibling}}function Vc(s,a){if(a.subtreeFlags&10256)for(a=a.child;a!==null;){var o=s,c=a,m=c.flags;switch(c.tag){case 22:Vc(o,c),m&2048&&Vf(c.alternate,c);break;case 24:Vc(o,c),m&2048&&Uf(c.alternate,c);break;default:Vc(o,c)}a=a.sibling}}var Uc=8192;function Cl(s,a,o){if(s.subtreeFlags&Uc)for(s=s.child;s!==null;)d0(s,a,o),s=s.sibling}function d0(s,a,o){switch(s.tag){case 26:Cl(s,a,o),s.flags&Uc&&s.memoizedState!==null&&yT(o,ga,s.memoizedState,s.memoizedProps);break;case 5:Cl(s,a,o);break;case 3:case 4:var c=ga;ga=$d(s.stateNode.containerInfo),Cl(s,a,o),ga=c;break;case 22:s.memoizedState===null&&(c=s.alternate,c!==null&&c.memoizedState!==null?(c=Uc,Uc=16777216,Cl(s,a,o),Uc=c):Cl(s,a,o));break;default:Cl(s,a,o)}}function h0(s){var a=s.alternate;if(a!==null&&(s=a.child,s!==null)){a.child=null;do a=s.sibling,s.sibling=null,s=a;while(s!==null)}}function Fc(s){var a=s.deletions;if((s.flags&16)!==0){if(a!==null)for(var o=0;o<a.length;o++){var c=a[o];qn=c,f0(c,s)}h0(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)m0(s),s=s.sibling}function m0(s){switch(s.tag){case 0:case 11:case 15:Fc(s),s.flags&2048&&zi(9,s,s.return);break;case 3:Fc(s);break;case 12:Fc(s);break;case 22:var a=s.stateNode;s.memoizedState!==null&&a._visibility&2&&(s.return===null||s.return.tag!==13)?(a._visibility&=-3,Md(s)):Fc(s);break;default:Fc(s)}}function Md(s){var a=s.deletions;if((s.flags&16)!==0){if(a!==null)for(var o=0;o<a.length;o++){var c=a[o];qn=c,f0(c,s)}h0(s)}for(s=s.child;s!==null;){switch(a=s,a.tag){case 0:case 11:case 15:zi(8,a,a.return),Md(a);break;case 22:o=a.stateNode,o._visibility&2&&(o._visibility&=-3,Md(a));break;default:Md(a)}s=s.sibling}}function f0(s,a){for(;qn!==null;){var o=qn;switch(o.tag){case 0:case 11:case 15:zi(8,o,a);break;case 23:case 22:if(o.memoizedState!==null&&o.memoizedState.cachePool!==null){var c=o.memoizedState.cachePool.pool;c!=null&&c.refCount++}break;case 24:jc(o.memoizedState.cache)}if(c=o.child,c!==null)c.return=o,qn=c;else e:for(o=s;qn!==null;){c=qn;var m=c.sibling,f=c.return;if(r0(c),c===o){qn=null;break e}if(m!==null){m.return=f,qn=m;break e}qn=f}}}var Mj={getCacheForType:function(s){var a=Yn(Cn),o=a.data.get(s);return o===void 0&&(o=s(),a.data.set(s,o)),o},cacheSignal:function(){return Yn(Cn).controller.signal}},Ij=typeof WeakMap=="function"?WeakMap:Map,Us=0,Xs=null,bs=null,_s=0,Hs=0,zr=null,qi=!1,Rl=!1,Ff=!1,hi=0,bn=0,Hi=0,zo=0,zf=0,qr=0,Al=0,zc=null,Cr=null,qf=!1,Id=0,p0=0,Dd=1/0,Pd=null,$i=null,On=0,Wi=null,Ml=null,mi=0,Hf=0,$f=null,g0=null,qc=0,Wf=null;function Hr(){return(Us&2)!==0&&_s!==0?_s&-_s:$.T!==null?Jf():Ee()}function y0(){if(qr===0)if((_s&536870912)===0||Cs){var s=X;X<<=1,(X&3932160)===0&&(X=262144),qr=s}else qr=536870912;return s=Ur.current,s!==null&&(s.flags|=32),qr}function Rr(s,a,o){(s===Xs&&(Hs===2||Hs===9)||s.cancelPendingCommit!==null)&&(Il(s,0),Gi(s,_s,qr,!1)),Je(s,o),((Us&2)===0||s!==Xs)&&(s===Xs&&((Us&2)===0&&(zo|=o),bn===4&&Gi(s,_s,qr,!1)),Oa(s))}function b0(s,a,o){if((Us&6)!==0)throw Error(i(327));var c=!o&&(a&127)===0&&(a&s.expiredLanes)===0||et(s,a),m=c?Lj(s,a):Kf(s,a,!0),f=c;do{if(m===0){Rl&&!c&&Gi(s,a,0,!1);break}else{if(o=s.current.alternate,f&&!Dj(o)){m=Kf(s,a,!1),f=!1;continue}if(m===2){if(f=a,s.errorRecoveryDisabledLanes&f)var w=0;else w=s.pendingLanes&-536870913,w=w!==0?w:w&536870912?536870912:0;if(w!==0){a=w;e:{var N=s;m=zc;var H=N.current.memoizedState.isDehydrated;if(H&&(Il(N,w).flags|=256),w=Kf(N,w,!1),w!==2){if(Ff&&!H){N.errorRecoveryDisabledLanes|=f,zo|=f,m=4;break e}f=Cr,Cr=m,f!==null&&(Cr===null?Cr=f:Cr.push.apply(Cr,f))}m=w}if(f=!1,m!==2)continue}}if(m===1){Il(s,0),Gi(s,a,0,!0);break}e:{switch(c=s,f=m,f){case 0:case 1:throw Error(i(345));case 4:if((a&4194048)!==a)break;case 6:Gi(c,a,qr,!qi);break e;case 2:Cr=null;break;case 3:case 5:break;default:throw Error(i(329))}if((a&62914560)===a&&(m=Id+300-Gt(),10<m)){if(Gi(c,a,qr,!qi),_t(c,0,!0)!==0)break e;mi=a,c.timeoutHandle=Y0(v0.bind(null,c,o,Cr,Pd,qf,a,qr,zo,Al,qi,f,"Throttled",-0,0),m);break e}v0(c,o,Cr,Pd,qf,a,qr,zo,Al,qi,f,null,-0,0)}}break}while(!0);Oa(s)}function v0(s,a,o,c,m,f,w,N,H,he,Ne,ze,fe,we){if(s.timeoutHandle=-1,ze=a.subtreeFlags,ze&8192||(ze&16785408)===16785408){ze={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Fn},d0(a,f,ze);var Rt=(f&62914560)===f?Id-Gt():(f&4194048)===f?p0-Gt():0;if(Rt=bT(ze,Rt),Rt!==null){mi=f,s.cancelPendingCommit=Rt(E0.bind(null,s,a,f,o,c,m,w,N,H,Ne,ze,null,fe,we)),Gi(s,f,w,!he);return}}E0(s,a,f,o,c,m,w,N,H)}function Dj(s){for(var a=s;;){var o=a.tag;if((o===0||o===11||o===15)&&a.flags&16384&&(o=a.updateQueue,o!==null&&(o=o.stores,o!==null)))for(var c=0;c<o.length;c++){var m=o[c],f=m.getSnapshot;m=m.value;try{if(!Br(f(),m))return!1}catch{return!1}}if(o=a.child,a.subtreeFlags&16384&&o!==null)o.return=a,a=o;else{if(a===s)break;for(;a.sibling===null;){if(a.return===null||a.return===s)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}}return!0}function Gi(s,a,o,c){a&=~zf,a&=~zo,s.suspendedLanes|=a,s.pingedLanes&=~a,c&&(s.warmLanes|=a),c=s.expirationTimes;for(var m=a;0<m;){var f=31-De(m),w=1<<f;c[f]=-1,m&=~w}o!==0&&it(s,o,a)}function Ld(){return(Us&6)===0?(Hc(0),!1):!0}function Gf(){if(bs!==null){if(Hs===0)var s=bs.return;else s=bs,si=Io=null,cf(s),kl=null,Sc=0,s=bs;for(;s!==null;)Qv(s.alternate,s),s=s.return;bs=null}}function Il(s,a){var o=s.timeoutHandle;o!==-1&&(s.timeoutHandle=-1,eT(o)),o=s.cancelPendingCommit,o!==null&&(s.cancelPendingCommit=null,o()),mi=0,Gf(),Xs=s,bs=o=ei(s.current,null),_s=a,Hs=0,zr=null,qi=!1,Rl=et(s,a),Ff=!1,Al=qr=zf=zo=Hi=bn=0,Cr=zc=null,qf=!1,(a&8)!==0&&(a|=a&32);var c=s.entangledLanes;if(c!==0)for(s=s.entanglements,c&=a;0<c;){var m=31-De(c),f=1<<m;a|=s[m],c&=~f}return hi=a,nd(),o}function x0(s,a){cs=null,$.H=Dc,a===_l||a===dd?(a=Lb(),Hs=3):a===Qm?(a=Lb(),Hs=4):Hs=a===Tf?8:a!==null&&typeof a=="object"&&typeof a.then=="function"?6:1,zr=a,bs===null&&(bn=1,Td(s,Zr(a,s.current)))}function w0(){var s=Ur.current;return s===null?!0:(_s&4194048)===_s?na===null:(_s&62914560)===_s||(_s&536870912)!==0?s===na:!1}function _0(){var s=$.H;return $.H=Dc,s===null?Dc:s}function k0(){var s=$.A;return $.A=Mj,s}function Od(){bn=4,qi||(_s&4194048)!==_s&&Ur.current!==null||(Rl=!0),(Hi&134217727)===0&&(zo&134217727)===0||Xs===null||Gi(Xs,_s,qr,!1)}function Kf(s,a,o){var c=Us;Us|=2;var m=_0(),f=k0();(Xs!==s||_s!==a)&&(Pd=null,Il(s,a)),a=!1;var w=bn;e:do try{if(Hs!==0&&bs!==null){var N=bs,H=zr;switch(Hs){case 8:Gf(),w=6;break e;case 3:case 2:case 9:case 6:Ur.current===null&&(a=!0);var he=Hs;if(Hs=0,zr=null,Dl(s,N,H,he),o&&Rl){w=0;break e}break;default:he=Hs,Hs=0,zr=null,Dl(s,N,H,he)}}Pj(),w=bn;break}catch(Ne){x0(s,Ne)}while(!0);return a&&s.shellSuspendCounter++,si=Io=null,Us=c,$.H=m,$.A=f,bs===null&&(Xs=null,_s=0,nd()),w}function Pj(){for(;bs!==null;)j0(bs)}function Lj(s,a){var o=Us;Us|=2;var c=_0(),m=k0();Xs!==s||_s!==a?(Pd=null,Dd=Gt()+500,Il(s,a)):Rl=et(s,a);e:do try{if(Hs!==0&&bs!==null){a=bs;var f=zr;t:switch(Hs){case 1:Hs=0,zr=null,Dl(s,a,f,1);break;case 2:case 9:if(Db(f)){Hs=0,zr=null,T0(a);break}a=function(){Hs!==2&&Hs!==9||Xs!==s||(Hs=7),Oa(s)},f.then(a,a);break e;case 3:Hs=7;break e;case 4:Hs=5;break e;case 7:Db(f)?(Hs=0,zr=null,T0(a)):(Hs=0,zr=null,Dl(s,a,f,7));break;case 5:var w=null;switch(bs.tag){case 26:w=bs.memoizedState;case 5:case 27:var N=bs;if(w?u1(w):N.stateNode.complete){Hs=0,zr=null;var H=N.sibling;if(H!==null)bs=H;else{var he=N.return;he!==null?(bs=he,Bd(he)):bs=null}break t}}Hs=0,zr=null,Dl(s,a,f,5);break;case 6:Hs=0,zr=null,Dl(s,a,f,6);break;case 8:Gf(),bn=6;break e;default:throw Error(i(462))}}Oj();break}catch(Ne){x0(s,Ne)}while(!0);return si=Io=null,$.H=c,$.A=m,Us=o,bs!==null?0:(Xs=null,_s=0,nd(),bn)}function Oj(){for(;bs!==null&&!Wt();)j0(bs)}function j0(s){var a=Kv(s.alternate,s,hi);s.memoizedProps=s.pendingProps,a===null?Bd(s):bs=a}function T0(s){var a=s,o=a.alternate;switch(a.tag){case 15:case 0:a=zv(o,a,a.pendingProps,a.type,void 0,_s);break;case 11:a=zv(o,a,a.pendingProps,a.type.render,a.ref,_s);break;case 5:cf(a);default:Qv(o,a),a=bs=kb(a,hi),a=Kv(o,a,hi)}s.memoizedProps=s.pendingProps,a===null?Bd(s):bs=a}function Dl(s,a,o,c){si=Io=null,cf(a),kl=null,Sc=0;var m=a.return;try{if(Tj(s,m,a,o,_s)){bn=1,Td(s,Zr(o,s.current)),bs=null;return}}catch(f){if(m!==null)throw bs=m,f;bn=1,Td(s,Zr(o,s.current)),bs=null;return}a.flags&32768?(Cs||c===1?s=!0:Rl||(_s&536870912)!==0?s=!1:(qi=s=!0,(c===2||c===9||c===3||c===6)&&(c=Ur.current,c!==null&&c.tag===13&&(c.flags|=16384))),S0(a,s)):Bd(a)}function Bd(s){var a=s;do{if((a.flags&32768)!==0){S0(a,qi);return}s=a.return;var o=Nj(a.alternate,a,hi);if(o!==null){bs=o;return}if(a=a.sibling,a!==null){bs=a;return}bs=a=s}while(a!==null);bn===0&&(bn=5)}function S0(s,a){do{var o=Cj(s.alternate,s);if(o!==null){o.flags&=32767,bs=o;return}if(o=s.return,o!==null&&(o.flags|=32768,o.subtreeFlags=0,o.deletions=null),!a&&(s=s.sibling,s!==null)){bs=s;return}bs=s=o}while(s!==null);bn=6,bs=null}function E0(s,a,o,c,m,f,w,N,H){s.cancelPendingCommit=null;do Vd();while(On!==0);if((Us&6)!==0)throw Error(i(327));if(a!==null){if(a===s.current)throw Error(i(177));if(f=a.lanes|a.childLanes,f|=Pm,yt(s,o,f,w,N,H),s===Xs&&(bs=Xs=null,_s=0),Ml=a,Wi=s,mi=o,Hf=f,$f=m,g0=c,(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,Fj(is,function(){return M0(),null})):(s.callbackNode=null,s.callbackPriority=0),c=(a.flags&13878)!==0,(a.subtreeFlags&13878)!==0||c){c=$.T,$.T=null,m=pe.p,pe.p=2,w=Us,Us|=4;try{Rj(s,a,o)}finally{Us=w,pe.p=m,$.T=c}}On=1,N0(),C0(),R0()}}function N0(){if(On===1){On=0;var s=Wi,a=Ml,o=(a.flags&13878)!==0;if((a.subtreeFlags&13878)!==0||o){o=$.T,$.T=null;var c=pe.p;pe.p=2;var m=Us;Us|=4;try{l0(a,s);var f=ip,w=fb(s.containerInfo),N=f.focusedElem,H=f.selectionRange;if(w!==N&&N&&N.ownerDocument&&mb(N.ownerDocument.documentElement,N)){if(H!==null&&Rm(N)){var he=H.start,Ne=H.end;if(Ne===void 0&&(Ne=he),"selectionStart"in N)N.selectionStart=he,N.selectionEnd=Math.min(Ne,N.value.length);else{var ze=N.ownerDocument||document,fe=ze&&ze.defaultView||window;if(fe.getSelection){var we=fe.getSelection(),Rt=N.textContent.length,$t=Math.min(H.start,Rt),Ks=H.end===void 0?$t:Math.min(H.end,Rt);!we.extend&&$t>Ks&&(w=Ks,Ks=$t,$t=w);var ee=hb(N,$t),W=hb(N,Ks);if(ee&&W&&(we.rangeCount!==1||we.anchorNode!==ee.node||we.anchorOffset!==ee.offset||we.focusNode!==W.node||we.focusOffset!==W.offset)){var ce=ze.createRange();ce.setStart(ee.node,ee.offset),we.removeAllRanges(),$t>Ks?(we.addRange(ce),we.extend(W.node,W.offset)):(ce.setEnd(W.node,W.offset),we.addRange(ce))}}}}for(ze=[],we=N;we=we.parentNode;)we.nodeType===1&&ze.push({element:we,left:we.scrollLeft,top:we.scrollTop});for(typeof N.focus=="function"&&N.focus(),N=0;N<ze.length;N++){var Oe=ze[N];Oe.element.scrollLeft=Oe.left,Oe.element.scrollTop=Oe.top}}Xd=!!ap,ip=ap=null}finally{Us=m,pe.p=c,$.T=o}}s.current=a,On=2}}function C0(){if(On===2){On=0;var s=Wi,a=Ml,o=(a.flags&8772)!==0;if((a.subtreeFlags&8772)!==0||o){o=$.T,$.T=null;var c=pe.p;pe.p=2;var m=Us;Us|=4;try{n0(s,a.alternate,a)}finally{Us=m,pe.p=c,$.T=o}}On=3}}function R0(){if(On===4||On===3){On=0,ms();var s=Wi,a=Ml,o=mi,c=g0;(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?On=5:(On=0,Ml=Wi=null,A0(s,s.pendingLanes));var m=s.pendingLanes;if(m===0&&($i=null),ye(o),a=a.stateNode,be&&typeof be.onCommitFiberRoot=="function")try{be.onCommitFiberRoot(ws,a,void 0,(a.current.flags&128)===128)}catch{}if(c!==null){a=$.T,m=pe.p,pe.p=2,$.T=null;try{for(var f=s.onRecoverableError,w=0;w<c.length;w++){var N=c[w];f(N.value,{componentStack:N.stack})}}finally{$.T=a,pe.p=m}}(mi&3)!==0&&Vd(),Oa(s),m=s.pendingLanes,(o&261930)!==0&&(m&42)!==0?s===Wf?qc++:(qc=0,Wf=s):qc=0,Hc(0)}}function A0(s,a){(s.pooledCacheLanes&=a)===0&&(a=s.pooledCache,a!=null&&(s.pooledCache=null,jc(a)))}function Vd(){return N0(),C0(),R0(),M0()}function M0(){if(On!==5)return!1;var s=Wi,a=Hf;Hf=0;var o=ye(mi),c=$.T,m=pe.p;try{pe.p=32>o?32:o,$.T=null,o=$f,$f=null;var f=Wi,w=mi;if(On=0,Ml=Wi=null,mi=0,(Us&6)!==0)throw Error(i(331));var N=Us;if(Us|=4,m0(f.current),u0(f,f.current,w,o),Us=N,Hc(0,!1),be&&typeof be.onPostCommitFiberRoot=="function")try{be.onPostCommitFiberRoot(ws,f)}catch{}return!0}finally{pe.p=m,$.T=c,A0(s,a)}}function I0(s,a,o){a=Zr(o,a),a=jf(s.stateNode,a,2),s=Vi(s,a,2),s!==null&&(Je(s,2),Oa(s))}function $s(s,a,o){if(s.tag===3)I0(s,s,o);else for(;a!==null;){if(a.tag===3){I0(a,s,o);break}else if(a.tag===1){var c=a.stateNode;if(typeof a.type.getDerivedStateFromError=="function"||typeof c.componentDidCatch=="function"&&($i===null||!$i.has(c))){s=Zr(o,s),o=Dv(2),c=Vi(a,o,2),c!==null&&(Pv(o,c,a,s),Je(c,2),Oa(c));break}}a=a.return}}function Yf(s,a,o){var c=s.pingCache;if(c===null){c=s.pingCache=new Ij;var m=new Set;c.set(a,m)}else m=c.get(a),m===void 0&&(m=new Set,c.set(a,m));m.has(o)||(Ff=!0,m.add(o),s=Bj.bind(null,s,a,o),a.then(s,s))}function Bj(s,a,o){var c=s.pingCache;c!==null&&c.delete(a),s.pingedLanes|=s.suspendedLanes&o,s.warmLanes&=~o,Xs===s&&(_s&o)===o&&(bn===4||bn===3&&(_s&62914560)===_s&&300>Gt()-Id?(Us&2)===0&&Il(s,0):zf|=o,Al===_s&&(Al=0)),Oa(s)}function D0(s,a){a===0&&(a=Q()),s=Ro(s,a),s!==null&&(Je(s,a),Oa(s))}function Vj(s){var a=s.memoizedState,o=0;a!==null&&(o=a.retryLane),D0(s,o)}function Uj(s,a){var o=0;switch(s.tag){case 31:case 13:var c=s.stateNode,m=s.memoizedState;m!==null&&(o=m.retryLane);break;case 19:c=s.stateNode;break;case 22:c=s.stateNode._retryCache;break;default:throw Error(i(314))}c!==null&&c.delete(a),D0(s,o)}function Fj(s,a){return lt(s,a)}var Ud=null,Pl=null,Qf=!1,Fd=!1,Xf=!1,Ki=0;function Oa(s){s!==Pl&&s.next===null&&(Pl===null?Ud=Pl=s:Pl=Pl.next=s),Fd=!0,Qf||(Qf=!0,qj())}function Hc(s,a){if(!Xf&&Fd){Xf=!0;do for(var o=!1,c=Ud;c!==null;){if(s!==0){var m=c.pendingLanes;if(m===0)var f=0;else{var w=c.suspendedLanes,N=c.pingedLanes;f=(1<<31-De(42|s)+1)-1,f&=m&~(w&~N),f=f&201326741?f&201326741|1:f?f|2:0}f!==0&&(o=!0,B0(c,f))}else f=_s,f=_t(c,c===Xs?f:0,c.cancelPendingCommit!==null||c.timeoutHandle!==-1),(f&3)===0||et(c,f)||(o=!0,B0(c,f));c=c.next}while(o);Xf=!1}}function zj(){P0()}function P0(){Fd=Qf=!1;var s=0;Ki!==0&&Zj()&&(s=Ki);for(var a=Gt(),o=null,c=Ud;c!==null;){var m=c.next,f=L0(c,a);f===0?(c.next=null,o===null?Ud=m:o.next=m,m===null&&(Pl=o)):(o=c,(s!==0||(f&3)!==0)&&(Fd=!0)),c=m}On!==0&&On!==5||Hc(s),Ki!==0&&(Ki=0)}function L0(s,a){for(var o=s.suspendedLanes,c=s.pingedLanes,m=s.expirationTimes,f=s.pendingLanes&-62914561;0<f;){var w=31-De(f),N=1<<w,H=m[w];H===-1?((N&o)===0||(N&c)!==0)&&(m[w]=kt(N,a)):H<=a&&(s.expiredLanes|=N),f&=~N}if(a=Xs,o=_s,o=_t(s,s===a?o:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),c=s.callbackNode,o===0||s===a&&(Hs===2||Hs===9)||s.cancelPendingCommit!==null)return c!==null&&c!==null&&Ot(c),s.callbackNode=null,s.callbackPriority=0;if((o&3)===0||et(s,o)){if(a=o&-o,a===s.callbackPriority)return a;switch(c!==null&&Ot(c),ye(o)){case 2:case 8:o=xs;break;case 32:o=is;break;case 268435456:o=Ms;break;default:o=is}return c=O0.bind(null,s),o=lt(o,c),s.callbackPriority=a,s.callbackNode=o,a}return c!==null&&c!==null&&Ot(c),s.callbackPriority=2,s.callbackNode=null,2}function O0(s,a){if(On!==0&&On!==5)return s.callbackNode=null,s.callbackPriority=0,null;var o=s.callbackNode;if(Vd()&&s.callbackNode!==o)return null;var c=_s;return c=_t(s,s===Xs?c:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),c===0?null:(b0(s,c,a),L0(s,Gt()),s.callbackNode!=null&&s.callbackNode===o?O0.bind(null,s):null)}function B0(s,a){if(Vd())return null;b0(s,a,!0)}function qj(){tT(function(){(Us&6)!==0?lt(us,zj):P0()})}function Jf(){if(Ki===0){var s=xl;s===0&&(s=gt,gt<<=1,(gt&261888)===0&&(gt=256)),Ki=s}return Ki}function V0(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:Lr(""+s)}function U0(s,a){var o=a.ownerDocument.createElement("input");return o.name=a.name,o.value=a.value,s.id&&o.setAttribute("form",s.id),a.parentNode.insertBefore(o,a),s=new FormData(s),o.parentNode.removeChild(o),s}function Hj(s,a,o,c,m){if(a==="submit"&&o&&o.stateNode===m){var f=V0((m[At]||null).action),w=c.submitter;w&&(a=(a=w[At]||null)?V0(a.formAction):w.getAttribute("formAction"),a!==null&&(f=a,w=null));var N=new tt("action","action",null,c,m);s.push({event:N,listeners:[{instance:null,listener:function(){if(c.defaultPrevented){if(Ki!==0){var H=w?U0(m,w):new FormData(m);bf(o,{pending:!0,data:H,method:m.method,action:f},null,H)}}else typeof f=="function"&&(N.preventDefault(),H=w?U0(m,w):new FormData(m),bf(o,{pending:!0,data:H,method:m.method,action:f},f,H))},currentTarget:m}]})}}for(var Zf=0;Zf<Dm.length;Zf++){var ep=Dm[Zf],$j=ep.toLowerCase(),Wj=ep[0].toUpperCase()+ep.slice(1);pa($j,"on"+Wj)}pa(yb,"onAnimationEnd"),pa(bb,"onAnimationIteration"),pa(vb,"onAnimationStart"),pa("dblclick","onDoubleClick"),pa("focusin","onFocus"),pa("focusout","onBlur"),pa(lj,"onTransitionRun"),pa(cj,"onTransitionStart"),pa(uj,"onTransitionCancel"),pa(xb,"onTransitionEnd"),z("onMouseEnter",["mouseout","mouseover"]),z("onMouseLeave",["mouseout","mouseover"]),z("onPointerEnter",["pointerout","pointerover"]),z("onPointerLeave",["pointerout","pointerover"]),E("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),E("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),E("onBeforeInput",["compositionend","keypress","textInput","paste"]),E("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),E("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),E("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var $c="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Gj=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat($c));function F0(s,a){a=(a&4)!==0;for(var o=0;o<s.length;o++){var c=s[o],m=c.event;c=c.listeners;e:{var f=void 0;if(a)for(var w=c.length-1;0<=w;w--){var N=c[w],H=N.instance,he=N.currentTarget;if(N=N.listener,H!==f&&m.isPropagationStopped())break e;f=N,m.currentTarget=he;try{f(m)}catch(Ne){sd(Ne)}m.currentTarget=null,f=H}else for(w=0;w<c.length;w++){if(N=c[w],H=N.instance,he=N.currentTarget,N=N.listener,H!==f&&m.isPropagationStopped())break e;f=N,m.currentTarget=he;try{f(m)}catch(Ne){sd(Ne)}m.currentTarget=null,f=H}}}}function vs(s,a){var o=a[zt];o===void 0&&(o=a[zt]=new Set);var c=s+"__bubble";o.has(c)||(z0(a,s,2,!1),o.add(c))}function tp(s,a,o){var c=0;a&&(c|=4),z0(o,s,c,a)}var zd="_reactListening"+Math.random().toString(36).slice(2);function sp(s){if(!s[zd]){s[zd]=!0,ae.forEach(function(o){o!=="selectionchange"&&(Gj.has(o)||tp(o,!1,s),tp(o,!0,s))});var a=s.nodeType===9?s:s.ownerDocument;a===null||a[zd]||(a[zd]=!0,tp("selectionchange",!1,a))}}function z0(s,a,o,c){switch(y1(a)){case 2:var m=wT;break;case 8:m=_T;break;default:m=yp}o=m.bind(null,a,o,s),m=void 0,!Ue||a!=="touchstart"&&a!=="touchmove"&&a!=="wheel"||(m=!0),c?m!==void 0?s.addEventListener(a,o,{capture:!0,passive:m}):s.addEventListener(a,o,!0):m!==void 0?s.addEventListener(a,o,{passive:m}):s.addEventListener(a,o,!1)}function np(s,a,o,c,m){var f=c;if((a&1)===0&&(a&2)===0&&c!==null)e:for(;;){if(c===null)return;var w=c.tag;if(w===3||w===4){var N=c.stateNode.containerInfo;if(N===m)break;if(w===4)for(w=c.return;w!==null;){var H=w.tag;if((H===3||H===4)&&w.stateNode.containerInfo===m)return;w=w.return}for(;N!==null;){if(w=zs(N),w===null)return;if(H=w.tag,H===5||H===6||H===26||H===27){c=f=w;continue e}N=N.parentNode}}c=c.return}q(function(){var he=f,Ne=fn(o),ze=[];e:{var fe=wb.get(s);if(fe!==void 0){var we=tt,Rt=s;switch(s){case"keypress":if(S(o)===0)break e;case"keydown":case"keyup":we=Za;break;case"focusin":Rt="focus",we=_n;break;case"focusout":Rt="blur",we=_n;break;case"beforeblur":case"afterblur":we=_n;break;case"click":if(o.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":we=rn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":we=Bs;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":we=v;break;case yb:case bb:case vb:we=$n;break;case xb:we=R;break;case"scroll":case"scrollend":we=ut;break;case"wheel":we=ve;break;case"copy":case"cut":case"paste":we=kr;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":we=nr;break;case"toggle":case"beforetoggle":we=ls}var $t=(a&4)!==0,Ks=!$t&&(s==="scroll"||s==="scrollend"),ee=$t?fe!==null?fe+"Capture":null:fe;$t=[];for(var W=he,ce;W!==null;){var Oe=W;if(ce=Oe.stateNode,Oe=Oe.tag,Oe!==5&&Oe!==26&&Oe!==27||ce===null||ee===null||(Oe=ue(W,ee),Oe!=null&&$t.push(Wc(W,Oe,ce))),Ks)break;W=W.return}0<$t.length&&(fe=new we(fe,Rt,null,o,Ne),ze.push({event:fe,listeners:$t}))}}if((a&7)===0){e:{if(fe=s==="mouseover"||s==="pointerover",we=s==="mouseout"||s==="pointerout",fe&&o!==zn&&(Rt=o.relatedTarget||o.fromElement)&&(zs(Rt)||Rt[ft]))break e;if((we||fe)&&(fe=Ne.window===Ne?Ne:(fe=Ne.ownerDocument)?fe.defaultView||fe.parentWindow:window,we?(Rt=o.relatedTarget||o.toElement,we=he,Rt=Rt?zs(Rt):null,Rt!==null&&(Ks=u(Rt),$t=Rt.tag,Rt!==Ks||$t!==5&&$t!==27&&$t!==6)&&(Rt=null)):(we=null,Rt=he),we!==Rt)){if($t=rn,Oe="onMouseLeave",ee="onMouseEnter",W="mouse",(s==="pointerout"||s==="pointerover")&&($t=nr,Oe="onPointerLeave",ee="onPointerEnter",W="pointer"),Ks=we==null?fe:hs(we),ce=Rt==null?fe:hs(Rt),fe=new $t(Oe,W+"leave",we,o,Ne),fe.target=Ks,fe.relatedTarget=ce,Oe=null,zs(Ne)===he&&($t=new $t(ee,W+"enter",Rt,o,Ne),$t.target=ce,$t.relatedTarget=Ks,Oe=$t),Ks=Oe,we&&Rt)t:{for($t=Kj,ee=we,W=Rt,ce=0,Oe=ee;Oe;Oe=$t(Oe))ce++;Oe=0;for(var Vt=W;Vt;Vt=$t(Vt))Oe++;for(;0<ce-Oe;)ee=$t(ee),ce--;for(;0<Oe-ce;)W=$t(W),Oe--;for(;ce--;){if(ee===W||W!==null&&ee===W.alternate){$t=ee;break t}ee=$t(ee),W=$t(W)}$t=null}else $t=null;we!==null&&q0(ze,fe,we,$t,!1),Rt!==null&&Ks!==null&&q0(ze,Ks,Rt,$t,!0)}}e:{if(fe=he?hs(he):window,we=fe.nodeName&&fe.nodeName.toLowerCase(),we==="select"||we==="input"&&fe.type==="file")var Ls=ib;else if(rb(fe))if(ob)Ls=aj;else{Ls=nj;var It=sj}else we=fe.nodeName,!we||we.toLowerCase()!=="input"||fe.type!=="checkbox"&&fe.type!=="radio"?he&&Aa(he.elementType)&&(Ls=ib):Ls=rj;if(Ls&&(Ls=Ls(s,he))){ab(ze,Ls,o,Ne);break e}It&&It(s,fe,he),s==="focusout"&&he&&fe.type==="number"&&he.memoizedProps.value!=null&&Yr(fe,"number",fe.value)}switch(It=he?hs(he):window,s){case"focusin":(rb(It)||It.contentEditable==="true")&&(hl=It,Am=he,wc=null);break;case"focusout":wc=Am=hl=null;break;case"mousedown":Mm=!0;break;case"contextmenu":case"mouseup":case"dragend":Mm=!1,pb(ze,o,Ne);break;case"selectionchange":if(oj)break;case"keydown":case"keyup":pb(ze,o,Ne)}var ds;if(Vs)e:{switch(s){case"compositionstart":var ks="onCompositionStart";break e;case"compositionend":ks="onCompositionEnd";break e;case"compositionupdate":ks="onCompositionUpdate";break e}ks=void 0}else dl?Eo(s,o)&&(ks="onCompositionEnd"):s==="keydown"&&o.keyCode===229&&(ks="onCompositionStart");ks&&(Ia&&o.locale!=="ko"&&(dl||ks!=="onCompositionStart"?ks==="onCompositionEnd"&&dl&&(ds=ss()):(st=Ne,vt="value"in st?st.value:st.textContent,dl=!0)),It=qd(he,ks),0<It.length&&(ks=new gn(ks,s,null,o,Ne),ze.push({event:ks,listeners:It}),ds?ks.data=ds:(ds=ul(o),ds!==null&&(ks.data=ds)))),(ds=Xr?Jk(s,o):Zk(s,o))&&(ks=qd(he,"onBeforeInput"),0<ks.length&&(It=new gn("onBeforeInput","beforeinput",null,o,Ne),ze.push({event:It,listeners:ks}),It.data=ds)),Hj(ze,s,he,o,Ne)}F0(ze,a)})}function Wc(s,a,o){return{instance:s,listener:a,currentTarget:o}}function qd(s,a){for(var o=a+"Capture",c=[];s!==null;){var m=s,f=m.stateNode;if(m=m.tag,m!==5&&m!==26&&m!==27||f===null||(m=ue(s,o),m!=null&&c.unshift(Wc(s,m,f)),m=ue(s,a),m!=null&&c.push(Wc(s,m,f))),s.tag===3)return c;s=s.return}return[]}function Kj(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function q0(s,a,o,c,m){for(var f=a._reactName,w=[];o!==null&&o!==c;){var N=o,H=N.alternate,he=N.stateNode;if(N=N.tag,H!==null&&H===c)break;N!==5&&N!==26&&N!==27||he===null||(H=he,m?(he=ue(o,f),he!=null&&w.unshift(Wc(o,he,H))):m||(he=ue(o,f),he!=null&&w.push(Wc(o,he,H)))),o=o.return}w.length!==0&&s.push({event:a,listeners:w})}var Yj=/\r\n?/g,Qj=/\u0000|\uFFFD/g;function H0(s){return(typeof s=="string"?s:""+s).replace(Yj,`
`).replace(Qj,"")}function $0(s,a){return a=H0(a),H0(s)===a}function Gs(s,a,o,c,m,f){switch(o){case"children":typeof c=="string"?a==="body"||a==="textarea"&&c===""||Un(s,c):(typeof c=="number"||typeof c=="bigint")&&a!=="body"&&Un(s,""+c);break;case"className":Lt(s,"class",c);break;case"tabIndex":Lt(s,"tabindex",c);break;case"dir":case"role":case"viewBox":case"width":case"height":Lt(s,o,c);break;case"style":_r(s,c,f);break;case"data":if(a!=="object"){Lt(s,"data",c);break}case"src":case"href":if(c===""&&(a!=="a"||o!=="href")){s.removeAttribute(o);break}if(c==null||typeof c=="function"||typeof c=="symbol"||typeof c=="boolean"){s.removeAttribute(o);break}c=Lr(""+c),s.setAttribute(o,c);break;case"action":case"formAction":if(typeof c=="function"){s.setAttribute(o,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof f=="function"&&(o==="formAction"?(a!=="input"&&Gs(s,a,"name",m.name,m,null),Gs(s,a,"formEncType",m.formEncType,m,null),Gs(s,a,"formMethod",m.formMethod,m,null),Gs(s,a,"formTarget",m.formTarget,m,null)):(Gs(s,a,"encType",m.encType,m,null),Gs(s,a,"method",m.method,m,null),Gs(s,a,"target",m.target,m,null)));if(c==null||typeof c=="symbol"||typeof c=="boolean"){s.removeAttribute(o);break}c=Lr(""+c),s.setAttribute(o,c);break;case"onClick":c!=null&&(s.onclick=Fn);break;case"onScroll":c!=null&&vs("scroll",s);break;case"onScrollEnd":c!=null&&vs("scrollend",s);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(i(61));if(o=c.__html,o!=null){if(m.children!=null)throw Error(i(60));s.innerHTML=o}}break;case"multiple":s.multiple=c&&typeof c!="function"&&typeof c!="symbol";break;case"muted":s.muted=c&&typeof c!="function"&&typeof c!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(c==null||typeof c=="function"||typeof c=="boolean"||typeof c=="symbol"){s.removeAttribute("xlink:href");break}o=Lr(""+c),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",o);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":c!=null&&typeof c!="function"&&typeof c!="symbol"?s.setAttribute(o,""+c):s.removeAttribute(o);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":c&&typeof c!="function"&&typeof c!="symbol"?s.setAttribute(o,""):s.removeAttribute(o);break;case"capture":case"download":c===!0?s.setAttribute(o,""):c!==!1&&c!=null&&typeof c!="function"&&typeof c!="symbol"?s.setAttribute(o,c):s.removeAttribute(o);break;case"cols":case"rows":case"size":case"span":c!=null&&typeof c!="function"&&typeof c!="symbol"&&!isNaN(c)&&1<=c?s.setAttribute(o,c):s.removeAttribute(o);break;case"rowSpan":case"start":c==null||typeof c=="function"||typeof c=="symbol"||isNaN(c)?s.removeAttribute(o):s.setAttribute(o,c);break;case"popover":vs("beforetoggle",s),vs("toggle",s),ct(s,"popover",c);break;case"xlinkActuate":xt(s,"http://www.w3.org/1999/xlink","xlink:actuate",c);break;case"xlinkArcrole":xt(s,"http://www.w3.org/1999/xlink","xlink:arcrole",c);break;case"xlinkRole":xt(s,"http://www.w3.org/1999/xlink","xlink:role",c);break;case"xlinkShow":xt(s,"http://www.w3.org/1999/xlink","xlink:show",c);break;case"xlinkTitle":xt(s,"http://www.w3.org/1999/xlink","xlink:title",c);break;case"xlinkType":xt(s,"http://www.w3.org/1999/xlink","xlink:type",c);break;case"xmlBase":xt(s,"http://www.w3.org/XML/1998/namespace","xml:base",c);break;case"xmlLang":xt(s,"http://www.w3.org/XML/1998/namespace","xml:lang",c);break;case"xmlSpace":xt(s,"http://www.w3.org/XML/1998/namespace","xml:space",c);break;case"is":ct(s,"is",c);break;case"innerText":case"textContent":break;default:(!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(o=Mi.get(o)||o,ct(s,o,c))}}function rp(s,a,o,c,m,f){switch(o){case"style":_r(s,c,f);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(i(61));if(o=c.__html,o!=null){if(m.children!=null)throw Error(i(60));s.innerHTML=o}}break;case"children":typeof c=="string"?Un(s,c):(typeof c=="number"||typeof c=="bigint")&&Un(s,""+c);break;case"onScroll":c!=null&&vs("scroll",s);break;case"onScrollEnd":c!=null&&vs("scrollend",s);break;case"onClick":c!=null&&(s.onclick=Fn);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!xe.hasOwnProperty(o))e:{if(o[0]==="o"&&o[1]==="n"&&(m=o.endsWith("Capture"),a=o.slice(2,m?o.length-7:void 0),f=s[At]||null,f=f!=null?f[o]:null,typeof f=="function"&&s.removeEventListener(a,f,m),typeof c=="function")){typeof f!="function"&&f!==null&&(o in s?s[o]=null:s.hasAttribute(o)&&s.removeAttribute(o)),s.addEventListener(a,c,m);break e}o in s?s[o]=c:c===!0?s.setAttribute(o,""):ct(s,o,c)}}}function Xn(s,a,o){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":vs("error",s),vs("load",s);var c=!1,m=!1,f;for(f in o)if(o.hasOwnProperty(f)){var w=o[f];if(w!=null)switch(f){case"src":c=!0;break;case"srcSet":m=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,a));default:Gs(s,a,f,w,o,null)}}m&&Gs(s,a,"srcSet",o.srcSet,o,null),c&&Gs(s,a,"src",o.src,o,null);return;case"input":vs("invalid",s);var N=f=w=m=null,H=null,he=null;for(c in o)if(o.hasOwnProperty(c)){var Ne=o[c];if(Ne!=null)switch(c){case"name":m=Ne;break;case"type":w=Ne;break;case"checked":H=Ne;break;case"defaultChecked":he=Ne;break;case"value":f=Ne;break;case"defaultValue":N=Ne;break;case"children":case"dangerouslySetInnerHTML":if(Ne!=null)throw Error(i(137,a));break;default:Gs(s,a,c,Ne,o,null)}}Ri(s,f,N,H,he,w,m,!1);return;case"select":vs("invalid",s),c=w=f=null;for(m in o)if(o.hasOwnProperty(m)&&(N=o[m],N!=null))switch(m){case"value":f=N;break;case"defaultValue":w=N;break;case"multiple":c=N;default:Gs(s,a,m,N,o,null)}a=f,o=w,s.multiple=!!c,a!=null?hr(s,!!c,a,!1):o!=null&&hr(s,!!c,o,!0);return;case"textarea":vs("invalid",s),f=m=c=null;for(w in o)if(o.hasOwnProperty(w)&&(N=o[w],N!=null))switch(w){case"value":c=N;break;case"defaultValue":m=N;break;case"children":f=N;break;case"dangerouslySetInnerHTML":if(N!=null)throw Error(i(91));break;default:Gs(s,a,w,N,o,null)}Pr(s,c,m,f);return;case"option":for(H in o)o.hasOwnProperty(H)&&(c=o[H],c!=null)&&(H==="selected"?s.selected=c&&typeof c!="function"&&typeof c!="symbol":Gs(s,a,H,c,o,null));return;case"dialog":vs("beforetoggle",s),vs("toggle",s),vs("cancel",s),vs("close",s);break;case"iframe":case"object":vs("load",s);break;case"video":case"audio":for(c=0;c<$c.length;c++)vs($c[c],s);break;case"image":vs("error",s),vs("load",s);break;case"details":vs("toggle",s);break;case"embed":case"source":case"link":vs("error",s),vs("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(he in o)if(o.hasOwnProperty(he)&&(c=o[he],c!=null))switch(he){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,a));default:Gs(s,a,he,c,o,null)}return;default:if(Aa(a)){for(Ne in o)o.hasOwnProperty(Ne)&&(c=o[Ne],c!==void 0&&rp(s,a,Ne,c,o,void 0));return}}for(N in o)o.hasOwnProperty(N)&&(c=o[N],c!=null&&Gs(s,a,N,c,o,null))}function Xj(s,a,o,c){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var m=null,f=null,w=null,N=null,H=null,he=null,Ne=null;for(we in o){var ze=o[we];if(o.hasOwnProperty(we)&&ze!=null)switch(we){case"checked":break;case"value":break;case"defaultValue":H=ze;default:c.hasOwnProperty(we)||Gs(s,a,we,null,c,ze)}}for(var fe in c){var we=c[fe];if(ze=o[fe],c.hasOwnProperty(fe)&&(we!=null||ze!=null))switch(fe){case"type":f=we;break;case"name":m=we;break;case"checked":he=we;break;case"defaultChecked":Ne=we;break;case"value":w=we;break;case"defaultValue":N=we;break;case"children":case"dangerouslySetInnerHTML":if(we!=null)throw Error(i(137,a));break;default:we!==ze&&Gs(s,a,fe,we,c,ze)}}Ra(s,w,N,H,he,Ne,f,m);return;case"select":we=w=N=fe=null;for(f in o)if(H=o[f],o.hasOwnProperty(f)&&H!=null)switch(f){case"value":break;case"multiple":we=H;default:c.hasOwnProperty(f)||Gs(s,a,f,null,c,H)}for(m in c)if(f=c[m],H=o[m],c.hasOwnProperty(m)&&(f!=null||H!=null))switch(m){case"value":fe=f;break;case"defaultValue":N=f;break;case"multiple":w=f;default:f!==H&&Gs(s,a,m,f,c,H)}a=N,o=w,c=we,fe!=null?hr(s,!!o,fe,!1):!!c!=!!o&&(a!=null?hr(s,!!o,a,!0):hr(s,!!o,o?[]:"",!1));return;case"textarea":we=fe=null;for(N in o)if(m=o[N],o.hasOwnProperty(N)&&m!=null&&!c.hasOwnProperty(N))switch(N){case"value":break;case"children":break;default:Gs(s,a,N,null,c,m)}for(w in c)if(m=c[w],f=o[w],c.hasOwnProperty(w)&&(m!=null||f!=null))switch(w){case"value":fe=m;break;case"defaultValue":we=m;break;case"children":break;case"dangerouslySetInnerHTML":if(m!=null)throw Error(i(91));break;default:m!==f&&Gs(s,a,w,m,c,f)}Xa(s,fe,we);return;case"option":for(var Rt in o)fe=o[Rt],o.hasOwnProperty(Rt)&&fe!=null&&!c.hasOwnProperty(Rt)&&(Rt==="selected"?s.selected=!1:Gs(s,a,Rt,null,c,fe));for(H in c)fe=c[H],we=o[H],c.hasOwnProperty(H)&&fe!==we&&(fe!=null||we!=null)&&(H==="selected"?s.selected=fe&&typeof fe!="function"&&typeof fe!="symbol":Gs(s,a,H,fe,c,we));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var $t in o)fe=o[$t],o.hasOwnProperty($t)&&fe!=null&&!c.hasOwnProperty($t)&&Gs(s,a,$t,null,c,fe);for(he in c)if(fe=c[he],we=o[he],c.hasOwnProperty(he)&&fe!==we&&(fe!=null||we!=null))switch(he){case"children":case"dangerouslySetInnerHTML":if(fe!=null)throw Error(i(137,a));break;default:Gs(s,a,he,fe,c,we)}return;default:if(Aa(a)){for(var Ks in o)fe=o[Ks],o.hasOwnProperty(Ks)&&fe!==void 0&&!c.hasOwnProperty(Ks)&&rp(s,a,Ks,void 0,c,fe);for(Ne in c)fe=c[Ne],we=o[Ne],!c.hasOwnProperty(Ne)||fe===we||fe===void 0&&we===void 0||rp(s,a,Ne,fe,c,we);return}}for(var ee in o)fe=o[ee],o.hasOwnProperty(ee)&&fe!=null&&!c.hasOwnProperty(ee)&&Gs(s,a,ee,null,c,fe);for(ze in c)fe=c[ze],we=o[ze],!c.hasOwnProperty(ze)||fe===we||fe==null&&we==null||Gs(s,a,ze,fe,c,we)}function W0(s){switch(s){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function Jj(){if(typeof performance.getEntriesByType=="function"){for(var s=0,a=0,o=performance.getEntriesByType("resource"),c=0;c<o.length;c++){var m=o[c],f=m.transferSize,w=m.initiatorType,N=m.duration;if(f&&N&&W0(w)){for(w=0,N=m.responseEnd,c+=1;c<o.length;c++){var H=o[c],he=H.startTime;if(he>N)break;var Ne=H.transferSize,ze=H.initiatorType;Ne&&W0(ze)&&(H=H.responseEnd,w+=Ne*(H<N?1:(N-he)/(H-he)))}if(--c,a+=8*(f+w)/(m.duration/1e3),s++,10<s)break}}if(0<s)return a/s/1e6}return navigator.connection&&(s=navigator.connection.downlink,typeof s=="number")?s:5}var ap=null,ip=null;function Hd(s){return s.nodeType===9?s:s.ownerDocument}function G0(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function K0(s,a){if(s===0)switch(a){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&a==="foreignObject"?0:s}function op(s,a){return s==="textarea"||s==="noscript"||typeof a.children=="string"||typeof a.children=="number"||typeof a.children=="bigint"||typeof a.dangerouslySetInnerHTML=="object"&&a.dangerouslySetInnerHTML!==null&&a.dangerouslySetInnerHTML.__html!=null}var lp=null;function Zj(){var s=window.event;return s&&s.type==="popstate"?s===lp?!1:(lp=s,!0):(lp=null,!1)}var Y0=typeof setTimeout=="function"?setTimeout:void 0,eT=typeof clearTimeout=="function"?clearTimeout:void 0,Q0=typeof Promise=="function"?Promise:void 0,tT=typeof queueMicrotask=="function"?queueMicrotask:typeof Q0<"u"?function(s){return Q0.resolve(null).then(s).catch(sT)}:Y0;function sT(s){setTimeout(function(){throw s})}function Yi(s){return s==="head"}function X0(s,a){var o=a,c=0;do{var m=o.nextSibling;if(s.removeChild(o),m&&m.nodeType===8)if(o=m.data,o==="/$"||o==="/&"){if(c===0){s.removeChild(m),Vl(a);return}c--}else if(o==="$"||o==="$?"||o==="$~"||o==="$!"||o==="&")c++;else if(o==="html")Gc(s.ownerDocument.documentElement);else if(o==="head"){o=s.ownerDocument.head,Gc(o);for(var f=o.firstChild;f;){var w=f.nextSibling,N=f.nodeName;f[tn]||N==="SCRIPT"||N==="STYLE"||N==="LINK"&&f.rel.toLowerCase()==="stylesheet"||o.removeChild(f),f=w}}else o==="body"&&Gc(s.ownerDocument.body);o=m}while(o);Vl(a)}function J0(s,a){var o=s;s=0;do{var c=o.nextSibling;if(o.nodeType===1?a?(o._stashedDisplay=o.style.display,o.style.display="none"):(o.style.display=o._stashedDisplay||"",o.getAttribute("style")===""&&o.removeAttribute("style")):o.nodeType===3&&(a?(o._stashedText=o.nodeValue,o.nodeValue=""):o.nodeValue=o._stashedText||""),c&&c.nodeType===8)if(o=c.data,o==="/$"){if(s===0)break;s--}else o!=="$"&&o!=="$?"&&o!=="$~"&&o!=="$!"||s++;o=c}while(o)}function cp(s){var a=s.firstChild;for(a&&a.nodeType===10&&(a=a.nextSibling);a;){var o=a;switch(a=a.nextSibling,o.nodeName){case"HTML":case"HEAD":case"BODY":cp(o),En(o);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(o.rel.toLowerCase()==="stylesheet")continue}s.removeChild(o)}}function nT(s,a,o,c){for(;s.nodeType===1;){var m=o;if(s.nodeName.toLowerCase()!==a.toLowerCase()){if(!c&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(c){if(!s[tn])switch(a){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(f=s.getAttribute("rel"),f==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(f!==m.rel||s.getAttribute("href")!==(m.href==null||m.href===""?null:m.href)||s.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin)||s.getAttribute("title")!==(m.title==null?null:m.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(f=s.getAttribute("src"),(f!==(m.src==null?null:m.src)||s.getAttribute("type")!==(m.type==null?null:m.type)||s.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin))&&f&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(a==="input"&&s.type==="hidden"){var f=m.name==null?null:""+m.name;if(m.type==="hidden"&&s.getAttribute("name")===f)return s}else return s;if(s=ra(s.nextSibling),s===null)break}return null}function rT(s,a,o){if(a==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!o||(s=ra(s.nextSibling),s===null))return null;return s}function Z0(s,a){for(;s.nodeType!==8;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!a||(s=ra(s.nextSibling),s===null))return null;return s}function up(s){return s.data==="$?"||s.data==="$~"}function dp(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState!=="loading"}function aT(s,a){var o=s.ownerDocument;if(s.data==="$~")s._reactRetry=a;else if(s.data!=="$?"||o.readyState!=="loading")a();else{var c=function(){a(),o.removeEventListener("DOMContentLoaded",c)};o.addEventListener("DOMContentLoaded",c),s._reactRetry=c}}function ra(s){for(;s!=null;s=s.nextSibling){var a=s.nodeType;if(a===1||a===3)break;if(a===8){if(a=s.data,a==="$"||a==="$!"||a==="$?"||a==="$~"||a==="&"||a==="F!"||a==="F")break;if(a==="/$"||a==="/&")return null}}return s}var hp=null;function e1(s){s=s.nextSibling;for(var a=0;s;){if(s.nodeType===8){var o=s.data;if(o==="/$"||o==="/&"){if(a===0)return ra(s.nextSibling);a--}else o!=="$"&&o!=="$!"&&o!=="$?"&&o!=="$~"&&o!=="&"||a++}s=s.nextSibling}return null}function t1(s){s=s.previousSibling;for(var a=0;s;){if(s.nodeType===8){var o=s.data;if(o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"){if(a===0)return s;a--}else o!=="/$"&&o!=="/&"||a++}s=s.previousSibling}return null}function s1(s,a,o){switch(a=Hd(o),s){case"html":if(s=a.documentElement,!s)throw Error(i(452));return s;case"head":if(s=a.head,!s)throw Error(i(453));return s;case"body":if(s=a.body,!s)throw Error(i(454));return s;default:throw Error(i(451))}}function Gc(s){for(var a=s.attributes;a.length;)s.removeAttributeNode(a[0]);En(s)}var aa=new Map,n1=new Set;function $d(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var fi=pe.d;pe.d={f:iT,r:oT,D:lT,C:cT,L:uT,m:dT,X:mT,S:hT,M:fT};function iT(){var s=fi.f(),a=Ld();return s||a}function oT(s){var a=sn(s);a!==null&&a.tag===5&&a.type==="form"?xv(a):fi.r(s)}var Ll=typeof document>"u"?null:document;function r1(s,a,o){var c=Ll;if(c&&typeof a=="string"&&a){var m=Nn(a);m='link[rel="'+s+'"][href="'+m+'"]',typeof o=="string"&&(m+='[crossorigin="'+o+'"]'),n1.has(m)||(n1.add(m),s={rel:s,crossOrigin:o,href:a},c.querySelector(m)===null&&(a=c.createElement("link"),Xn(a,"link",s),me(a),c.head.appendChild(a)))}}function lT(s){fi.D(s),r1("dns-prefetch",s,null)}function cT(s,a){fi.C(s,a),r1("preconnect",s,a)}function uT(s,a,o){fi.L(s,a,o);var c=Ll;if(c&&s&&a){var m='link[rel="preload"][as="'+Nn(a)+'"]';a==="image"&&o&&o.imageSrcSet?(m+='[imagesrcset="'+Nn(o.imageSrcSet)+'"]',typeof o.imageSizes=="string"&&(m+='[imagesizes="'+Nn(o.imageSizes)+'"]')):m+='[href="'+Nn(s)+'"]';var f=m;switch(a){case"style":f=Ol(s);break;case"script":f=Bl(s)}aa.has(f)||(s=_({rel:"preload",href:a==="image"&&o&&o.imageSrcSet?void 0:s,as:a},o),aa.set(f,s),c.querySelector(m)!==null||a==="style"&&c.querySelector(Kc(f))||a==="script"&&c.querySelector(Yc(f))||(a=c.createElement("link"),Xn(a,"link",s),me(a),c.head.appendChild(a)))}}function dT(s,a){fi.m(s,a);var o=Ll;if(o&&s){var c=a&&typeof a.as=="string"?a.as:"script",m='link[rel="modulepreload"][as="'+Nn(c)+'"][href="'+Nn(s)+'"]',f=m;switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":f=Bl(s)}if(!aa.has(f)&&(s=_({rel:"modulepreload",href:s},a),aa.set(f,s),o.querySelector(m)===null)){switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(o.querySelector(Yc(f)))return}c=o.createElement("link"),Xn(c,"link",s),me(c),o.head.appendChild(c)}}}function hT(s,a,o){fi.S(s,a,o);var c=Ll;if(c&&s){var m=G(c).hoistableStyles,f=Ol(s);a=a||"default";var w=m.get(f);if(!w){var N={loading:0,preload:null};if(w=c.querySelector(Kc(f)))N.loading=5;else{s=_({rel:"stylesheet",href:s,"data-precedence":a},o),(o=aa.get(f))&&mp(s,o);var H=w=c.createElement("link");me(H),Xn(H,"link",s),H._p=new Promise(function(he,Ne){H.onload=he,H.onerror=Ne}),H.addEventListener("load",function(){N.loading|=1}),H.addEventListener("error",function(){N.loading|=2}),N.loading|=4,Wd(w,a,c)}w={type:"stylesheet",instance:w,count:1,state:N},m.set(f,w)}}}function mT(s,a){fi.X(s,a);var o=Ll;if(o&&s){var c=G(o).hoistableScripts,m=Bl(s),f=c.get(m);f||(f=o.querySelector(Yc(m)),f||(s=_({src:s,async:!0},a),(a=aa.get(m))&&fp(s,a),f=o.createElement("script"),me(f),Xn(f,"link",s),o.head.appendChild(f)),f={type:"script",instance:f,count:1,state:null},c.set(m,f))}}function fT(s,a){fi.M(s,a);var o=Ll;if(o&&s){var c=G(o).hoistableScripts,m=Bl(s),f=c.get(m);f||(f=o.querySelector(Yc(m)),f||(s=_({src:s,async:!0,type:"module"},a),(a=aa.get(m))&&fp(s,a),f=o.createElement("script"),me(f),Xn(f,"link",s),o.head.appendChild(f)),f={type:"script",instance:f,count:1,state:null},c.set(m,f))}}function a1(s,a,o,c){var m=(m=Me.current)?$d(m):null;if(!m)throw Error(i(446));switch(s){case"meta":case"title":return null;case"style":return typeof o.precedence=="string"&&typeof o.href=="string"?(a=Ol(o.href),o=G(m).hoistableStyles,c=o.get(a),c||(c={type:"style",instance:null,count:0,state:null},o.set(a,c)),c):{type:"void",instance:null,count:0,state:null};case"link":if(o.rel==="stylesheet"&&typeof o.href=="string"&&typeof o.precedence=="string"){s=Ol(o.href);var f=G(m).hoistableStyles,w=f.get(s);if(w||(m=m.ownerDocument||m,w={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},f.set(s,w),(f=m.querySelector(Kc(s)))&&!f._p&&(w.instance=f,w.state.loading=5),aa.has(s)||(o={rel:"preload",as:"style",href:o.href,crossOrigin:o.crossOrigin,integrity:o.integrity,media:o.media,hrefLang:o.hrefLang,referrerPolicy:o.referrerPolicy},aa.set(s,o),f||pT(m,s,o,w.state))),a&&c===null)throw Error(i(528,""));return w}if(a&&c!==null)throw Error(i(529,""));return null;case"script":return a=o.async,o=o.src,typeof o=="string"&&a&&typeof a!="function"&&typeof a!="symbol"?(a=Bl(o),o=G(m).hoistableScripts,c=o.get(a),c||(c={type:"script",instance:null,count:0,state:null},o.set(a,c)),c):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,s))}}function Ol(s){return'href="'+Nn(s)+'"'}function Kc(s){return'link[rel="stylesheet"]['+s+"]"}function i1(s){return _({},s,{"data-precedence":s.precedence,precedence:null})}function pT(s,a,o,c){s.querySelector('link[rel="preload"][as="style"]['+a+"]")?c.loading=1:(a=s.createElement("link"),c.preload=a,a.addEventListener("load",function(){return c.loading|=1}),a.addEventListener("error",function(){return c.loading|=2}),Xn(a,"link",o),me(a),s.head.appendChild(a))}function Bl(s){return'[src="'+Nn(s)+'"]'}function Yc(s){return"script[async]"+s}function o1(s,a,o){if(a.count++,a.instance===null)switch(a.type){case"style":var c=s.querySelector('style[data-href~="'+Nn(o.href)+'"]');if(c)return a.instance=c,me(c),c;var m=_({},o,{"data-href":o.href,"data-precedence":o.precedence,href:null,precedence:null});return c=(s.ownerDocument||s).createElement("style"),me(c),Xn(c,"style",m),Wd(c,o.precedence,s),a.instance=c;case"stylesheet":m=Ol(o.href);var f=s.querySelector(Kc(m));if(f)return a.state.loading|=4,a.instance=f,me(f),f;c=i1(o),(m=aa.get(m))&&mp(c,m),f=(s.ownerDocument||s).createElement("link"),me(f);var w=f;return w._p=new Promise(function(N,H){w.onload=N,w.onerror=H}),Xn(f,"link",c),a.state.loading|=4,Wd(f,o.precedence,s),a.instance=f;case"script":return f=Bl(o.src),(m=s.querySelector(Yc(f)))?(a.instance=m,me(m),m):(c=o,(m=aa.get(f))&&(c=_({},o),fp(c,m)),s=s.ownerDocument||s,m=s.createElement("script"),me(m),Xn(m,"link",c),s.head.appendChild(m),a.instance=m);case"void":return null;default:throw Error(i(443,a.type))}else a.type==="stylesheet"&&(a.state.loading&4)===0&&(c=a.instance,a.state.loading|=4,Wd(c,o.precedence,s));return a.instance}function Wd(s,a,o){for(var c=o.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),m=c.length?c[c.length-1]:null,f=m,w=0;w<c.length;w++){var N=c[w];if(N.dataset.precedence===a)f=N;else if(f!==m)break}f?f.parentNode.insertBefore(s,f.nextSibling):(a=o.nodeType===9?o.head:o,a.insertBefore(s,a.firstChild))}function mp(s,a){s.crossOrigin==null&&(s.crossOrigin=a.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=a.referrerPolicy),s.title==null&&(s.title=a.title)}function fp(s,a){s.crossOrigin==null&&(s.crossOrigin=a.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=a.referrerPolicy),s.integrity==null&&(s.integrity=a.integrity)}var Gd=null;function l1(s,a,o){if(Gd===null){var c=new Map,m=Gd=new Map;m.set(o,c)}else m=Gd,c=m.get(o),c||(c=new Map,m.set(o,c));if(c.has(s))return c;for(c.set(s,null),o=o.getElementsByTagName(s),m=0;m<o.length;m++){var f=o[m];if(!(f[tn]||f[bt]||s==="link"&&f.getAttribute("rel")==="stylesheet")&&f.namespaceURI!=="http://www.w3.org/2000/svg"){var w=f.getAttribute(a)||"";w=s+w;var N=c.get(w);N?N.push(f):c.set(w,[f])}}return c}function c1(s,a,o){s=s.ownerDocument||s,s.head.insertBefore(o,a==="title"?s.querySelector("head > title"):null)}function gT(s,a,o){if(o===1||a.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof a.precedence!="string"||typeof a.href!="string"||a.href==="")break;return!0;case"link":if(typeof a.rel!="string"||typeof a.href!="string"||a.href===""||a.onLoad||a.onError)break;return a.rel==="stylesheet"?(s=a.disabled,typeof a.precedence=="string"&&s==null):!0;case"script":if(a.async&&typeof a.async!="function"&&typeof a.async!="symbol"&&!a.onLoad&&!a.onError&&a.src&&typeof a.src=="string")return!0}return!1}function u1(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}function yT(s,a,o,c){if(o.type==="stylesheet"&&(typeof c.media!="string"||matchMedia(c.media).matches!==!1)&&(o.state.loading&4)===0){if(o.instance===null){var m=Ol(c.href),f=a.querySelector(Kc(m));if(f){a=f._p,a!==null&&typeof a=="object"&&typeof a.then=="function"&&(s.count++,s=Kd.bind(s),a.then(s,s)),o.state.loading|=4,o.instance=f,me(f);return}f=a.ownerDocument||a,c=i1(c),(m=aa.get(m))&&mp(c,m),f=f.createElement("link"),me(f);var w=f;w._p=new Promise(function(N,H){w.onload=N,w.onerror=H}),Xn(f,"link",c),o.instance=f}s.stylesheets===null&&(s.stylesheets=new Map),s.stylesheets.set(o,a),(a=o.state.preload)&&(o.state.loading&3)===0&&(s.count++,o=Kd.bind(s),a.addEventListener("load",o),a.addEventListener("error",o))}}var pp=0;function bT(s,a){return s.stylesheets&&s.count===0&&Qd(s,s.stylesheets),0<s.count||0<s.imgCount?function(o){var c=setTimeout(function(){if(s.stylesheets&&Qd(s,s.stylesheets),s.unsuspend){var f=s.unsuspend;s.unsuspend=null,f()}},6e4+a);0<s.imgBytes&&pp===0&&(pp=62500*Jj());var m=setTimeout(function(){if(s.waitingForImages=!1,s.count===0&&(s.stylesheets&&Qd(s,s.stylesheets),s.unsuspend)){var f=s.unsuspend;s.unsuspend=null,f()}},(s.imgBytes>pp?50:800)+a);return s.unsuspend=o,function(){s.unsuspend=null,clearTimeout(c),clearTimeout(m)}}:null}function Kd(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Qd(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var Yd=null;function Qd(s,a){s.stylesheets=null,s.unsuspend!==null&&(s.count++,Yd=new Map,a.forEach(vT,s),Yd=null,Kd.call(s))}function vT(s,a){if(!(a.state.loading&4)){var o=Yd.get(s);if(o)var c=o.get(null);else{o=new Map,Yd.set(s,o);for(var m=s.querySelectorAll("link[data-precedence],style[data-precedence]"),f=0;f<m.length;f++){var w=m[f];(w.nodeName==="LINK"||w.getAttribute("media")!=="not all")&&(o.set(w.dataset.precedence,w),c=w)}c&&o.set(null,c)}m=a.instance,w=m.getAttribute("data-precedence"),f=o.get(w)||c,f===c&&o.set(null,m),o.set(w,m),this.count++,c=Kd.bind(this),m.addEventListener("load",c),m.addEventListener("error",c),f?f.parentNode.insertBefore(m,f.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(m,s.firstChild)),a.state.loading|=4}}var Qc={$$typeof:Z,Provider:null,Consumer:null,_currentValue:Be,_currentValue2:Be,_threadCount:0};function xT(s,a,o,c,m,f,w,N,H){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Ae(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ae(0),this.hiddenUpdates=Ae(null),this.identifierPrefix=c,this.onUncaughtError=m,this.onCaughtError=f,this.onRecoverableError=w,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=H,this.incompleteTransitions=new Map}function d1(s,a,o,c,m,f,w,N,H,he,Ne,ze){return s=new xT(s,a,o,w,H,he,Ne,ze,N),a=1,f===!0&&(a|=24),f=Vr(3,null,null,a),s.current=f,f.stateNode=s,a=Gm(),a.refCount++,s.pooledCache=a,a.refCount++,f.memoizedState={element:c,isDehydrated:o,cache:a},Xm(f),s}function h1(s){return s?(s=pl,s):pl}function m1(s,a,o,c,m,f){m=h1(m),c.context===null?c.context=m:c.pendingContext=m,c=Bi(a),c.payload={element:o},f=f===void 0?null:f,f!==null&&(c.callback=f),o=Vi(s,c,a),o!==null&&(Rr(o,s,a),Nc(o,s,a))}function f1(s,a){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var o=s.retryLane;s.retryLane=o!==0&&o<a?o:a}}function gp(s,a){f1(s,a),(s=s.alternate)&&f1(s,a)}function p1(s){if(s.tag===13||s.tag===31){var a=Ro(s,67108864);a!==null&&Rr(a,s,67108864),gp(s,67108864)}}function g1(s){if(s.tag===13||s.tag===31){var a=Hr();a=F(a);var o=Ro(s,a);o!==null&&Rr(o,s,a),gp(s,a)}}var Xd=!0;function wT(s,a,o,c){var m=$.T;$.T=null;var f=pe.p;try{pe.p=2,yp(s,a,o,c)}finally{pe.p=f,$.T=m}}function _T(s,a,o,c){var m=$.T;$.T=null;var f=pe.p;try{pe.p=8,yp(s,a,o,c)}finally{pe.p=f,$.T=m}}function yp(s,a,o,c){if(Xd){var m=bp(c);if(m===null)np(s,a,c,Jd,o),b1(s,c);else if(jT(m,s,a,o,c))c.stopPropagation();else if(b1(s,c),a&4&&-1<kT.indexOf(s)){for(;m!==null;){var f=sn(m);if(f!==null)switch(f.tag){case 3:if(f=f.stateNode,f.current.memoizedState.isDehydrated){var w=Qe(f.pendingLanes);if(w!==0){var N=f;for(N.pendingLanes|=2,N.entangledLanes|=2;w;){var H=1<<31-De(w);N.entanglements[1]|=H,w&=~H}Oa(f),(Us&6)===0&&(Dd=Gt()+500,Hc(0))}}break;case 31:case 13:N=Ro(f,2),N!==null&&Rr(N,f,2),Ld(),gp(f,2)}if(f=bp(c),f===null&&np(s,a,c,Jd,o),f===m)break;m=f}m!==null&&c.stopPropagation()}else np(s,a,c,null,o)}}function bp(s){return s=fn(s),vp(s)}var Jd=null;function vp(s){if(Jd=null,s=zs(s),s!==null){var a=u(s);if(a===null)s=null;else{var o=a.tag;if(o===13){if(s=d(a),s!==null)return s;s=null}else if(o===31){if(s=p(a),s!==null)return s;s=null}else if(o===3){if(a.stateNode.current.memoizedState.isDehydrated)return a.tag===3?a.stateNode.containerInfo:null;s=null}else a!==s&&(s=null)}}return Jd=s,null}function y1(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Pt()){case us:return 2;case xs:return 8;case is:case Qs:return 32;case Ms:return 268435456;default:return 32}default:return 32}}var xp=!1,Qi=null,Xi=null,Ji=null,Xc=new Map,Jc=new Map,Zi=[],kT="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function b1(s,a){switch(s){case"focusin":case"focusout":Qi=null;break;case"dragenter":case"dragleave":Xi=null;break;case"mouseover":case"mouseout":Ji=null;break;case"pointerover":case"pointerout":Xc.delete(a.pointerId);break;case"gotpointercapture":case"lostpointercapture":Jc.delete(a.pointerId)}}function Zc(s,a,o,c,m,f){return s===null||s.nativeEvent!==f?(s={blockedOn:a,domEventName:o,eventSystemFlags:c,nativeEvent:f,targetContainers:[m]},a!==null&&(a=sn(a),a!==null&&p1(a)),s):(s.eventSystemFlags|=c,a=s.targetContainers,m!==null&&a.indexOf(m)===-1&&a.push(m),s)}function jT(s,a,o,c,m){switch(a){case"focusin":return Qi=Zc(Qi,s,a,o,c,m),!0;case"dragenter":return Xi=Zc(Xi,s,a,o,c,m),!0;case"mouseover":return Ji=Zc(Ji,s,a,o,c,m),!0;case"pointerover":var f=m.pointerId;return Xc.set(f,Zc(Xc.get(f)||null,s,a,o,c,m)),!0;case"gotpointercapture":return f=m.pointerId,Jc.set(f,Zc(Jc.get(f)||null,s,a,o,c,m)),!0}return!1}function v1(s){var a=zs(s.target);if(a!==null){var o=u(a);if(o!==null){if(a=o.tag,a===13){if(a=d(o),a!==null){s.blockedOn=a,Te(s.priority,function(){g1(o)});return}}else if(a===31){if(a=p(o),a!==null){s.blockedOn=a,Te(s.priority,function(){g1(o)});return}}else if(a===3&&o.stateNode.current.memoizedState.isDehydrated){s.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}s.blockedOn=null}function Zd(s){if(s.blockedOn!==null)return!1;for(var a=s.targetContainers;0<a.length;){var o=bp(s.nativeEvent);if(o===null){o=s.nativeEvent;var c=new o.constructor(o.type,o);zn=c,o.target.dispatchEvent(c),zn=null}else return a=sn(o),a!==null&&p1(a),s.blockedOn=o,!1;a.shift()}return!0}function x1(s,a,o){Zd(s)&&o.delete(a)}function TT(){xp=!1,Qi!==null&&Zd(Qi)&&(Qi=null),Xi!==null&&Zd(Xi)&&(Xi=null),Ji!==null&&Zd(Ji)&&(Ji=null),Xc.forEach(x1),Jc.forEach(x1)}function eh(s,a){s.blockedOn===a&&(s.blockedOn=null,xp||(xp=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,TT)))}var th=null;function w1(s){th!==s&&(th=s,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){th===s&&(th=null);for(var a=0;a<s.length;a+=3){var o=s[a],c=s[a+1],m=s[a+2];if(typeof c!="function"){if(vp(c||o)===null)continue;break}var f=sn(o);f!==null&&(s.splice(a,3),a-=3,bf(f,{pending:!0,data:m,method:o.method,action:c},c,m))}}))}function Vl(s){function a(H){return eh(H,s)}Qi!==null&&eh(Qi,s),Xi!==null&&eh(Xi,s),Ji!==null&&eh(Ji,s),Xc.forEach(a),Jc.forEach(a);for(var o=0;o<Zi.length;o++){var c=Zi[o];c.blockedOn===s&&(c.blockedOn=null)}for(;0<Zi.length&&(o=Zi[0],o.blockedOn===null);)v1(o),o.blockedOn===null&&Zi.shift();if(o=(s.ownerDocument||s).$$reactFormReplay,o!=null)for(c=0;c<o.length;c+=3){var m=o[c],f=o[c+1],w=m[At]||null;if(typeof f=="function")w||w1(o);else if(w){var N=null;if(f&&f.hasAttribute("formAction")){if(m=f,w=f[At]||null)N=w.formAction;else if(vp(m)!==null)continue}else N=w.action;typeof N=="function"?o[c+1]=N:(o.splice(c,3),c-=3),w1(o)}}}function _1(){function s(f){f.canIntercept&&f.info==="react-transition"&&f.intercept({handler:function(){return new Promise(function(w){return m=w})},focusReset:"manual",scroll:"manual"})}function a(){m!==null&&(m(),m=null),c||setTimeout(o,20)}function o(){if(!c&&!navigation.transition){var f=navigation.currentEntry;f&&f.url!=null&&navigation.navigate(f.url,{state:f.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var c=!1,m=null;return navigation.addEventListener("navigate",s),navigation.addEventListener("navigatesuccess",a),navigation.addEventListener("navigateerror",a),setTimeout(o,100),function(){c=!0,navigation.removeEventListener("navigate",s),navigation.removeEventListener("navigatesuccess",a),navigation.removeEventListener("navigateerror",a),m!==null&&(m(),m=null)}}}function wp(s){this._internalRoot=s}sh.prototype.render=wp.prototype.render=function(s){var a=this._internalRoot;if(a===null)throw Error(i(409));var o=a.current,c=Hr();m1(o,c,s,a,null,null)},sh.prototype.unmount=wp.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var a=s.containerInfo;m1(s.current,2,null,s,null,null),Ld(),a[ft]=null}};function sh(s){this._internalRoot=s}sh.prototype.unstable_scheduleHydration=function(s){if(s){var a=Ee();s={blockedOn:null,target:s,priority:a};for(var o=0;o<Zi.length&&a!==0&&a<Zi[o].priority;o++);Zi.splice(o,0,s),o===0&&v1(s)}};var k1=e.version;if(k1!=="19.2.4")throw Error(i(527,k1,"19.2.4"));pe.findDOMNode=function(s){var a=s._reactInternals;if(a===void 0)throw typeof s.render=="function"?Error(i(188)):(s=Object.keys(s).join(","),Error(i(268,s)));return s=y(a),s=s!==null?x(s):null,s=s===null?null:s.stateNode,s};var ST={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:$,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var nh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!nh.isDisabled&&nh.supportsFiber)try{ws=nh.inject(ST),be=nh}catch{}}return tu.createRoot=function(s,a){if(!l(s))throw Error(i(299));var o=!1,c="",m=Rv,f=Av,w=Mv;return a!=null&&(a.unstable_strictMode===!0&&(o=!0),a.identifierPrefix!==void 0&&(c=a.identifierPrefix),a.onUncaughtError!==void 0&&(m=a.onUncaughtError),a.onCaughtError!==void 0&&(f=a.onCaughtError),a.onRecoverableError!==void 0&&(w=a.onRecoverableError)),a=d1(s,1,!1,null,null,o,c,null,m,f,w,_1),s[ft]=a.current,sp(s),new wp(a)},tu.hydrateRoot=function(s,a,o){if(!l(s))throw Error(i(299));var c=!1,m="",f=Rv,w=Av,N=Mv,H=null;return o!=null&&(o.unstable_strictMode===!0&&(c=!0),o.identifierPrefix!==void 0&&(m=o.identifierPrefix),o.onUncaughtError!==void 0&&(f=o.onUncaughtError),o.onCaughtError!==void 0&&(w=o.onCaughtError),o.onRecoverableError!==void 0&&(N=o.onRecoverableError),o.formState!==void 0&&(H=o.formState)),a=d1(s,1,!0,a,o??null,c,m,H,f,w,N,_1),a.context=h1(null),o=a.current,c=Hr(),c=F(c),m=Bi(c),m.callback=null,Vi(o,m,c),o=c,a.current.lanes=o,Je(a,o),Oa(a),s[ft]=a.current,sp(s),new sh(a)},tu.version="19.2.4",tu}var I1;function LT(){if(I1)return jp.exports;I1=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),jp.exports=PT(),jp.exports}var OT=LT();const BT="modulepreload",VT=function(n){return"/login/"+n},D1={},wr=function(e,t,i){let l=Promise.resolve();if(t&&t.length>0){let g=function(y){return Promise.all(y.map(x=>Promise.resolve(x).then(_=>({status:"fulfilled",value:_}),_=>({status:"rejected",reason:_}))))};document.getElementsByTagName("link");const d=document.querySelector("meta[property=csp-nonce]"),p=d?.nonce||d?.getAttribute("nonce");l=g(t.map(y=>{if(y=VT(y),y in D1)return;D1[y]=!0;const x=y.endsWith(".css"),_=x?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${y}"]${_}`))return;const j=document.createElement("link");if(j.rel=x?"stylesheet":BT,x||(j.as="script"),j.crossOrigin="",j.href=y,p&&j.setAttribute("nonce",p),document.head.appendChild(j),x)return new Promise((O,K)=>{j.addEventListener("load",O),j.addEventListener("error",()=>K(new Error(`Unable to preload CSS for ${y}`)))})}))}function u(d){const p=new Event("vite:preloadError",{cancelable:!0});if(p.payload=d,window.dispatchEvent(p),!p.defaultPrevented)throw d}return l.then(d=>{for(const p of d||[])p.status==="rejected"&&u(p.reason);return e().catch(u)})};var P1="popstate";function UT(n={}){function e(i,l){let{pathname:u,search:d,hash:p}=i.location;return ig("",{pathname:u,search:d,hash:p},l.state&&l.state.usr||null,l.state&&l.state.key||"default")}function t(i,l){return typeof l=="string"?l:_u(l)}return zT(e,t,null,n)}function dn(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function ca(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function FT(){return Math.random().toString(36).substring(2,10)}function L1(n,e){return{usr:n.state,key:n.key,idx:e}}function ig(n,e,t=null,i){return{pathname:typeof n=="string"?n:n.pathname,search:"",hash:"",...typeof e=="string"?lc(e):e,state:t,key:e&&e.key||i||FT()}}function _u({pathname:n="/",search:e="",hash:t=""}){return e&&e!=="?"&&(n+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(n+=t.charAt(0)==="#"?t:"#"+t),n}function lc(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substring(t),n=n.substring(0,t));let i=n.indexOf("?");i>=0&&(e.search=n.substring(i),n=n.substring(0,i)),n&&(e.pathname=n)}return e}function zT(n,e,t,i={}){let{window:l=document.defaultView,v5Compat:u=!1}=i,d=l.history,p="POP",g=null,y=x();y==null&&(y=0,d.replaceState({...d.state,idx:y},""));function x(){return(d.state||{idx:null}).idx}function _(){p="POP";let D=x(),te=D==null?null:D-y;y=D,g&&g({action:p,location:B.location,delta:te})}function j(D,te){p="PUSH";let Y=ig(B.location,D,te);y=x()+1;let Z=L1(Y,y),ke=B.createHref(Y);try{d.pushState(Z,"",ke)}catch(Re){if(Re instanceof DOMException&&Re.name==="DataCloneError")throw Re;l.location.assign(ke)}u&&g&&g({action:p,location:B.location,delta:1})}function O(D,te){p="REPLACE";let Y=ig(B.location,D,te);y=x();let Z=L1(Y,y),ke=B.createHref(Y);d.replaceState(Z,"",ke),u&&g&&g({action:p,location:B.location,delta:0})}function K(D){return qT(D)}let B={get action(){return p},get location(){return n(l,d)},listen(D){if(g)throw new Error("A history only accepts one active listener");return l.addEventListener(P1,_),g=D,()=>{l.removeEventListener(P1,_),g=null}},createHref(D){return e(l,D)},createURL:K,encodeLocation(D){let te=K(D);return{pathname:te.pathname,search:te.search,hash:te.hash}},push:j,replace:O,go(D){return d.go(D)}};return B}function qT(n,e=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),dn(t,"No window.location.(origin|href) available to create URL");let i=typeof n=="string"?n:_u(n);return i=i.replace(/ $/,"%20"),!e&&i.startsWith("//")&&(i=t+i),new URL(i,t)}function U2(n,e,t="/"){return HT(n,e,t,!1)}function HT(n,e,t,i){let l=typeof e=="string"?lc(e):e,u=_i(l.pathname||"/",t);if(u==null)return null;let d=F2(n);$T(d);let p=null;for(let g=0;p==null&&g<d.length;++g){let y=sS(u);p=eS(d[g],y,i)}return p}function F2(n,e=[],t=[],i="",l=!1){let u=(d,p,g=l,y)=>{let x={relativePath:y===void 0?d.path||"":y,caseSensitive:d.caseSensitive===!0,childrenIndex:p,route:d};if(x.relativePath.startsWith("/")){if(!x.relativePath.startsWith(i)&&g)return;dn(x.relativePath.startsWith(i),`Absolute route path "${x.relativePath}" nested under path "${i}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),x.relativePath=x.relativePath.slice(i.length)}let _=vi([i,x.relativePath]),j=t.concat(x);d.children&&d.children.length>0&&(dn(d.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${_}".`),F2(d.children,e,j,_,g)),!(d.path==null&&!d.index)&&e.push({path:_,score:JT(_,d.index),routesMeta:j})};return n.forEach((d,p)=>{if(d.path===""||!d.path?.includes("?"))u(d,p);else for(let g of z2(d.path))u(d,p,!0,g)}),e}function z2(n){let e=n.split("/");if(e.length===0)return[];let[t,...i]=e,l=t.endsWith("?"),u=t.replace(/\?$/,"");if(i.length===0)return l?[u,""]:[u];let d=z2(i.join("/")),p=[];return p.push(...d.map(g=>g===""?u:[u,g].join("/"))),l&&p.push(...d),p.map(g=>n.startsWith("/")&&g===""?"/":g)}function $T(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:ZT(e.routesMeta.map(i=>i.childrenIndex),t.routesMeta.map(i=>i.childrenIndex)))}var WT=/^:[\w-]+$/,GT=3,KT=2,YT=1,QT=10,XT=-2,O1=n=>n==="*";function JT(n,e){let t=n.split("/"),i=t.length;return t.some(O1)&&(i+=XT),e&&(i+=KT),t.filter(l=>!O1(l)).reduce((l,u)=>l+(WT.test(u)?GT:u===""?YT:QT),i)}function ZT(n,e){return n.length===e.length&&n.slice(0,-1).every((i,l)=>i===e[l])?n[n.length-1]-e[e.length-1]:0}function eS(n,e,t=!1){let{routesMeta:i}=n,l={},u="/",d=[];for(let p=0;p<i.length;++p){let g=i[p],y=p===i.length-1,x=u==="/"?e:e.slice(u.length)||"/",_=Ih({path:g.relativePath,caseSensitive:g.caseSensitive,end:y},x),j=g.route;if(!_&&y&&t&&!i[i.length-1].route.index&&(_=Ih({path:g.relativePath,caseSensitive:g.caseSensitive,end:!1},x)),!_)return null;Object.assign(l,_.params),d.push({params:l,pathname:vi([u,_.pathname]),pathnameBase:iS(vi([u,_.pathnameBase])),route:j}),_.pathnameBase!=="/"&&(u=vi([u,_.pathnameBase]))}return d}function Ih(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,i]=tS(n.path,n.caseSensitive,n.end),l=e.match(t);if(!l)return null;let u=l[0],d=u.replace(/(.)\/+$/,"$1"),p=l.slice(1);return{params:i.reduce((y,{paramName:x,isOptional:_},j)=>{if(x==="*"){let K=p[j]||"";d=u.slice(0,u.length-K.length).replace(/(.)\/+$/,"$1")}const O=p[j];return _&&!O?y[x]=void 0:y[x]=(O||"").replace(/%2F/g,"/"),y},{}),pathname:u,pathnameBase:d,pattern:n}}function tS(n,e=!1,t=!0){ca(n==="*"||!n.endsWith("*")||n.endsWith("/*"),`Route path "${n}" will be treated as if it were "${n.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${n.replace(/\*$/,"/*")}".`);let i=[],l="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(d,p,g)=>(i.push({paramName:p,isOptional:g!=null}),g?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return n.endsWith("*")?(i.push({paramName:"*"}),l+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?l+="\\/*$":n!==""&&n!=="/"&&(l+="(?:(?=\\/|$))"),[new RegExp(l,e?void 0:"i"),i]}function sS(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return ca(!1,`The URL path "${n}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),n}}function _i(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,i=n.charAt(t);return i&&i!=="/"?null:n.slice(t)||"/"}var nS=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i;function rS(n,e="/"){let{pathname:t,search:i="",hash:l=""}=typeof n=="string"?lc(n):n,u;return t?(t=t.replace(/\/\/+/g,"/"),t.startsWith("/")?u=B1(t.substring(1),"/"):u=B1(t,e)):u=e,{pathname:u,search:oS(i),hash:lS(l)}}function B1(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(l=>{l===".."?t.length>1&&t.pop():l!=="."&&t.push(l)}),t.length>1?t.join("/"):"/"}function Np(n,e,t,i){return`Cannot include a '${n}' character in a manually specified \`to.${e}\` field [${JSON.stringify(i)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function aS(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function Vg(n){let e=aS(n);return e.map((t,i)=>i===e.length-1?t.pathname:t.pathnameBase)}function Ug(n,e,t,i=!1){let l;typeof n=="string"?l=lc(n):(l={...n},dn(!l.pathname||!l.pathname.includes("?"),Np("?","pathname","search",l)),dn(!l.pathname||!l.pathname.includes("#"),Np("#","pathname","hash",l)),dn(!l.search||!l.search.includes("#"),Np("#","search","hash",l)));let u=n===""||l.pathname==="",d=u?"/":l.pathname,p;if(d==null)p=t;else{let _=e.length-1;if(!i&&d.startsWith("..")){let j=d.split("/");for(;j[0]==="..";)j.shift(),_-=1;l.pathname=j.join("/")}p=_>=0?e[_]:"/"}let g=rS(l,p),y=d&&d!=="/"&&d.endsWith("/"),x=(u||d===".")&&t.endsWith("/");return!g.pathname.endsWith("/")&&(y||x)&&(g.pathname+="/"),g}var vi=n=>n.join("/").replace(/\/\/+/g,"/"),iS=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),oS=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,lS=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n,cS=class{constructor(n,e,t,i=!1){this.status=n,this.statusText=e||"",this.internal=i,t instanceof Error?(this.data=t.toString(),this.error=t):this.data=t}};function uS(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}function dS(n){return n.map(e=>e.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var q2=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function H2(n,e){let t=n;if(typeof t!="string"||!nS.test(t))return{absoluteURL:void 0,isExternal:!1,to:t};let i=t,l=!1;if(q2)try{let u=new URL(window.location.href),d=t.startsWith("//")?new URL(u.protocol+t):new URL(t),p=_i(d.pathname,e);d.origin===u.origin&&p!=null?t=p+d.search+d.hash:l=!0}catch{ca(!1,`<Link to="${t}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:i,isExternal:l,to:t}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var $2=["POST","PUT","PATCH","DELETE"];new Set($2);var hS=["GET",...$2];new Set(hS);var cc=b.createContext(null);cc.displayName="DataRouter";var tm=b.createContext(null);tm.displayName="DataRouterState";var mS=b.createContext(!1),W2=b.createContext({isTransitioning:!1});W2.displayName="ViewTransition";var fS=b.createContext(new Map);fS.displayName="Fetchers";var pS=b.createContext(null);pS.displayName="Await";var Kr=b.createContext(null);Kr.displayName="Navigation";var Lu=b.createContext(null);Lu.displayName="Location";var Ea=b.createContext({outlet:null,matches:[],isDataRoute:!1});Ea.displayName="Route";var Fg=b.createContext(null);Fg.displayName="RouteError";var G2="REACT_ROUTER_ERROR",gS="REDIRECT",yS="ROUTE_ERROR_RESPONSE";function bS(n){if(n.startsWith(`${G2}:${gS}:{`))try{let e=JSON.parse(n.slice(28));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.location=="string"&&typeof e.reloadDocument=="boolean"&&typeof e.replace=="boolean")return e}catch{}}function vS(n){if(n.startsWith(`${G2}:${yS}:{`))try{let e=JSON.parse(n.slice(40));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string")return new cS(e.status,e.statusText,e.data)}catch{}}function xS(n,{relative:e}={}){dn(uc(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:i}=b.useContext(Kr),{hash:l,pathname:u,search:d}=Ou(n,{relative:e}),p=u;return t!=="/"&&(p=u==="/"?t:vi([t,u])),i.createHref({pathname:p,search:d,hash:l})}function uc(){return b.useContext(Lu)!=null}function Na(){return dn(uc(),"useLocation() may be used only in the context of a <Router> component."),b.useContext(Lu).location}var K2="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function Y2(n){b.useContext(Kr).static||b.useLayoutEffect(n)}function tr(){let{isDataRoute:n}=b.useContext(Ea);return n?DS():wS()}function wS(){dn(uc(),"useNavigate() may be used only in the context of a <Router> component.");let n=b.useContext(cc),{basename:e,navigator:t}=b.useContext(Kr),{matches:i}=b.useContext(Ea),{pathname:l}=Na(),u=JSON.stringify(Vg(i)),d=b.useRef(!1);return Y2(()=>{d.current=!0}),b.useCallback((g,y={})=>{if(ca(d.current,K2),!d.current)return;if(typeof g=="number"){t.go(g);return}let x=Ug(g,JSON.parse(u),l,y.relative==="path");n==null&&e!=="/"&&(x.pathname=x.pathname==="/"?e:vi([e,x.pathname])),(y.replace?t.replace:t.push)(x,y.state,y)},[e,t,u,l,n])}b.createContext(null);function _S(){let{matches:n}=b.useContext(Ea),e=n[n.length-1];return e?e.params:{}}function Ou(n,{relative:e}={}){let{matches:t}=b.useContext(Ea),{pathname:i}=Na(),l=JSON.stringify(Vg(t));return b.useMemo(()=>Ug(n,JSON.parse(l),i,e==="path"),[n,l,i,e])}function kS(n,e){return Q2(n,e)}function Q2(n,e,t,i,l){dn(uc(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:u}=b.useContext(Kr),{matches:d}=b.useContext(Ea),p=d[d.length-1],g=p?p.params:{},y=p?p.pathname:"/",x=p?p.pathnameBase:"/",_=p&&p.route;{let Y=_&&_.path||"";J2(y,!_||Y.endsWith("*")||Y.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${y}" (under <Route path="${Y}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${Y}"> to <Route path="${Y==="/"?"*":`${Y}/*`}">.`)}let j=Na(),O;if(e){let Y=typeof e=="string"?lc(e):e;dn(x==="/"||Y.pathname?.startsWith(x),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${x}" but pathname "${Y.pathname}" was given in the \`location\` prop.`),O=Y}else O=j;let K=O.pathname||"/",B=K;if(x!=="/"){let Y=x.replace(/^\//,"").split("/");B="/"+K.replace(/^\//,"").split("/").slice(Y.length).join("/")}let D=U2(n,{pathname:B});ca(_||D!=null,`No routes matched location "${O.pathname}${O.search}${O.hash}" `),ca(D==null||D[D.length-1].route.element!==void 0||D[D.length-1].route.Component!==void 0||D[D.length-1].route.lazy!==void 0,`Matched leaf route at location "${O.pathname}${O.search}${O.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let te=NS(D&&D.map(Y=>Object.assign({},Y,{params:Object.assign({},g,Y.params),pathname:vi([x,u.encodeLocation?u.encodeLocation(Y.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:Y.pathname]),pathnameBase:Y.pathnameBase==="/"?x:vi([x,u.encodeLocation?u.encodeLocation(Y.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:Y.pathnameBase])})),d,t,i,l);return e&&te?b.createElement(Lu.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...O},navigationType:"POP"}},te):te}function jS(){let n=IS(),e=uS(n)?`${n.status} ${n.statusText}`:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,i="rgba(200,200,200, 0.5)",l={padding:"0.5rem",backgroundColor:i},u={padding:"2px 4px",backgroundColor:i},d=null;return console.error("Error handled by React Router default ErrorBoundary:",n),d=b.createElement(b.Fragment,null,b.createElement("p",null," Hey developer "),b.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",b.createElement("code",{style:u},"ErrorBoundary")," or"," ",b.createElement("code",{style:u},"errorElement")," prop on your route.")),b.createElement(b.Fragment,null,b.createElement("h2",null,"Unexpected Application Error!"),b.createElement("h3",{style:{fontStyle:"italic"}},e),t?b.createElement("pre",{style:l},t):null,d)}var TS=b.createElement(jS,null),X2=class extends b.Component{constructor(n){super(n),this.state={location:n.location,revalidation:n.revalidation,error:n.error}}static getDerivedStateFromError(n){return{error:n}}static getDerivedStateFromProps(n,e){return e.location!==n.location||e.revalidation!=="idle"&&n.revalidation==="idle"?{error:n.error,location:n.location,revalidation:n.revalidation}:{error:n.error!==void 0?n.error:e.error,location:e.location,revalidation:n.revalidation||e.revalidation}}componentDidCatch(n,e){this.props.onError?this.props.onError(n,e):console.error("React Router caught the following error during render",n)}render(){let n=this.state.error;if(this.context&&typeof n=="object"&&n&&"digest"in n&&typeof n.digest=="string"){const t=vS(n.digest);t&&(n=t)}let e=n!==void 0?b.createElement(Ea.Provider,{value:this.props.routeContext},b.createElement(Fg.Provider,{value:n,children:this.props.component})):this.props.children;return this.context?b.createElement(SS,{error:n},e):e}};X2.contextType=mS;var Cp=new WeakMap;function SS({children:n,error:e}){let{basename:t}=b.useContext(Kr);if(typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){let i=bS(e.digest);if(i){let l=Cp.get(e);if(l)throw l;let u=H2(i.location,t);if(q2&&!Cp.get(e))if(u.isExternal||i.reloadDocument)window.location.href=u.absoluteURL||u.to;else{const d=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(u.to,{replace:i.replace}));throw Cp.set(e,d),d}return b.createElement("meta",{httpEquiv:"refresh",content:`0;url=${u.absoluteURL||u.to}`})}}return n}function ES({routeContext:n,match:e,children:t}){let i=b.useContext(cc);return i&&i.static&&i.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=e.route.id),b.createElement(Ea.Provider,{value:n},t)}function NS(n,e=[],t=null,i=null,l=null){if(n==null){if(!t)return null;if(t.errors)n=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let u=n,d=t?.errors;if(d!=null){let x=u.findIndex(_=>_.route.id&&d?.[_.route.id]!==void 0);dn(x>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(d).join(",")}`),u=u.slice(0,Math.min(u.length,x+1))}let p=!1,g=-1;if(t)for(let x=0;x<u.length;x++){let _=u[x];if((_.route.HydrateFallback||_.route.hydrateFallbackElement)&&(g=x),_.route.id){let{loaderData:j,errors:O}=t,K=_.route.loader&&!j.hasOwnProperty(_.route.id)&&(!O||O[_.route.id]===void 0);if(_.route.lazy||K){p=!0,g>=0?u=u.slice(0,g+1):u=[u[0]];break}}}let y=t&&i?(x,_)=>{i(x,{location:t.location,params:t.matches?.[0]?.params??{},unstable_pattern:dS(t.matches),errorInfo:_})}:void 0;return u.reduceRight((x,_,j)=>{let O,K=!1,B=null,D=null;t&&(O=d&&_.route.id?d[_.route.id]:void 0,B=_.route.errorElement||TS,p&&(g<0&&j===0?(J2("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),K=!0,D=null):g===j&&(K=!0,D=_.route.hydrateFallbackElement||null)));let te=e.concat(u.slice(0,j+1)),Y=()=>{let Z;return O?Z=B:K?Z=D:_.route.Component?Z=b.createElement(_.route.Component,null):_.route.element?Z=_.route.element:Z=x,b.createElement(ES,{match:_,routeContext:{outlet:x,matches:te,isDataRoute:t!=null},children:Z})};return t&&(_.route.ErrorBoundary||_.route.errorElement||j===0)?b.createElement(X2,{location:t.location,revalidation:t.revalidation,component:B,error:O,children:Y(),routeContext:{outlet:null,matches:te,isDataRoute:!0},onError:y}):Y()},null)}function zg(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function CS(n){let e=b.useContext(cc);return dn(e,zg(n)),e}function RS(n){let e=b.useContext(tm);return dn(e,zg(n)),e}function AS(n){let e=b.useContext(Ea);return dn(e,zg(n)),e}function qg(n){let e=AS(n),t=e.matches[e.matches.length-1];return dn(t.route.id,`${n} can only be used on routes that contain a unique "id"`),t.route.id}function MS(){return qg("useRouteId")}function IS(){let n=b.useContext(Fg),e=RS("useRouteError"),t=qg("useRouteError");return n!==void 0?n:e.errors?.[t]}function DS(){let{router:n}=CS("useNavigate"),e=qg("useNavigate"),t=b.useRef(!1);return Y2(()=>{t.current=!0}),b.useCallback(async(l,u={})=>{ca(t.current,K2),t.current&&(typeof l=="number"?await n.navigate(l):await n.navigate(l,{fromRouteId:e,...u}))},[n,e])}var V1={};function J2(n,e,t){!e&&!V1[n]&&(V1[n]=!0,ca(!1,t))}b.memo(PS);function PS({routes:n,future:e,state:t,onError:i}){return Q2(n,void 0,t,i,e)}function Z2({to:n,replace:e,state:t,relative:i}){dn(uc(),"<Navigate> may be used only in the context of a <Router> component.");let{static:l}=b.useContext(Kr);ca(!l,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:u}=b.useContext(Ea),{pathname:d}=Na(),p=tr(),g=Ug(n,Vg(u),d,i==="path"),y=JSON.stringify(g);return b.useEffect(()=>{p(JSON.parse(y),{replace:e,state:t,relative:i})},[p,y,i,e,t]),null}function Js(n){dn(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function LS({basename:n="/",children:e=null,location:t,navigationType:i="POP",navigator:l,static:u=!1,unstable_useTransitions:d}){dn(!uc(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let p=n.replace(/^\/*/,"/"),g=b.useMemo(()=>({basename:p,navigator:l,static:u,unstable_useTransitions:d,future:{}}),[p,l,u,d]);typeof t=="string"&&(t=lc(t));let{pathname:y="/",search:x="",hash:_="",state:j=null,key:O="default"}=t,K=b.useMemo(()=>{let B=_i(y,p);return B==null?null:{location:{pathname:B,search:x,hash:_,state:j,key:O},navigationType:i}},[p,y,x,_,j,O,i]);return ca(K!=null,`<Router basename="${p}"> is not able to match the URL "${y}${x}${_}" because it does not start with the basename, so the <Router> won't render anything.`),K==null?null:b.createElement(Kr.Provider,{value:g},b.createElement(Lu.Provider,{children:e,value:K}))}function OS({children:n,location:e}){return kS(og(n),e)}function og(n,e=[]){let t=[];return b.Children.forEach(n,(i,l)=>{if(!b.isValidElement(i))return;let u=[...e,l];if(i.type===b.Fragment){t.push.apply(t,og(i.props.children,u));return}dn(i.type===Js,`[${typeof i.type=="string"?i.type:i.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),dn(!i.props.index||!i.props.children,"An index route cannot have child routes.");let d={id:i.props.id||u.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,middleware:i.props.middleware,loader:i.props.loader,action:i.props.action,hydrateFallbackElement:i.props.hydrateFallbackElement,HydrateFallback:i.props.HydrateFallback,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.hasErrorBoundary===!0||i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(d.children=og(i.props.children,u)),t.push(d)}),t}var xh="get",wh="application/x-www-form-urlencoded";function sm(n){return typeof HTMLElement<"u"&&n instanceof HTMLElement}function BS(n){return sm(n)&&n.tagName.toLowerCase()==="button"}function VS(n){return sm(n)&&n.tagName.toLowerCase()==="form"}function US(n){return sm(n)&&n.tagName.toLowerCase()==="input"}function FS(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function zS(n,e){return n.button===0&&(!e||e==="_self")&&!FS(n)}function lg(n=""){return new URLSearchParams(typeof n=="string"||Array.isArray(n)||n instanceof URLSearchParams?n:Object.keys(n).reduce((e,t)=>{let i=n[t];return e.concat(Array.isArray(i)?i.map(l=>[t,l]):[[t,i]])},[]))}function qS(n,e){let t=lg(n);return e&&e.forEach((i,l)=>{t.has(l)||e.getAll(l).forEach(u=>{t.append(l,u)})}),t}var rh=null;function HS(){if(rh===null)try{new FormData(document.createElement("form"),0),rh=!1}catch{rh=!0}return rh}var $S=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Rp(n){return n!=null&&!$S.has(n)?(ca(!1,`"${n}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${wh}"`),null):n}function WS(n,e){let t,i,l,u,d;if(VS(n)){let p=n.getAttribute("action");i=p?_i(p,e):null,t=n.getAttribute("method")||xh,l=Rp(n.getAttribute("enctype"))||wh,u=new FormData(n)}else if(BS(n)||US(n)&&(n.type==="submit"||n.type==="image")){let p=n.form;if(p==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let g=n.getAttribute("formaction")||p.getAttribute("action");if(i=g?_i(g,e):null,t=n.getAttribute("formmethod")||p.getAttribute("method")||xh,l=Rp(n.getAttribute("formenctype"))||Rp(p.getAttribute("enctype"))||wh,u=new FormData(p,n),!HS()){let{name:y,type:x,value:_}=n;if(x==="image"){let j=y?`${y}.`:"";u.append(`${j}x`,"0"),u.append(`${j}y`,"0")}else y&&u.append(y,_)}}else{if(sm(n))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=xh,i=null,l=wh,d=n}return u&&l==="text/plain"&&(d=u,u=void 0),{action:i,method:t.toLowerCase(),encType:l,formData:u,body:d}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function Hg(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function GS(n,e,t,i){let l=typeof n=="string"?new URL(n,typeof window>"u"?"server://singlefetch/":window.location.origin):n;return t?l.pathname.endsWith("/")?l.pathname=`${l.pathname}_.${i}`:l.pathname=`${l.pathname}.${i}`:l.pathname==="/"?l.pathname=`_root.${i}`:e&&_i(l.pathname,e)==="/"?l.pathname=`${e.replace(/\/$/,"")}/_root.${i}`:l.pathname=`${l.pathname.replace(/\/$/,"")}.${i}`,l}async function KS(n,e){if(n.id in e)return e[n.id];try{let t=await import(n.module);return e[n.id]=t,t}catch(t){return console.error(`Error loading route module \`${n.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function YS(n){return n==null?!1:n.href==null?n.rel==="preload"&&typeof n.imageSrcSet=="string"&&typeof n.imageSizes=="string":typeof n.rel=="string"&&typeof n.href=="string"}async function QS(n,e,t){let i=await Promise.all(n.map(async l=>{let u=e.routes[l.route.id];if(u){let d=await KS(u,t);return d.links?d.links():[]}return[]}));return eE(i.flat(1).filter(YS).filter(l=>l.rel==="stylesheet"||l.rel==="preload").map(l=>l.rel==="stylesheet"?{...l,rel:"prefetch",as:"style"}:{...l,rel:"prefetch"}))}function U1(n,e,t,i,l,u){let d=(g,y)=>t[y]?g.route.id!==t[y].route.id:!0,p=(g,y)=>t[y].pathname!==g.pathname||t[y].route.path?.endsWith("*")&&t[y].params["*"]!==g.params["*"];return u==="assets"?e.filter((g,y)=>d(g,y)||p(g,y)):u==="data"?e.filter((g,y)=>{let x=i.routes[g.route.id];if(!x||!x.hasLoader)return!1;if(d(g,y)||p(g,y))return!0;if(g.route.shouldRevalidate){let _=g.route.shouldRevalidate({currentUrl:new URL(l.pathname+l.search+l.hash,window.origin),currentParams:t[0]?.params||{},nextUrl:new URL(n,window.origin),nextParams:g.params,defaultShouldRevalidate:!0});if(typeof _=="boolean")return _}return!0}):[]}function XS(n,e,{includeHydrateFallback:t}={}){return JS(n.map(i=>{let l=e.routes[i.route.id];if(!l)return[];let u=[l.module];return l.clientActionModule&&(u=u.concat(l.clientActionModule)),l.clientLoaderModule&&(u=u.concat(l.clientLoaderModule)),t&&l.hydrateFallbackModule&&(u=u.concat(l.hydrateFallbackModule)),l.imports&&(u=u.concat(l.imports)),u}).flat(1))}function JS(n){return[...new Set(n)]}function ZS(n){let e={},t=Object.keys(n).sort();for(let i of t)e[i]=n[i];return e}function eE(n,e){let t=new Set;return new Set(e),n.reduce((i,l)=>{let u=JSON.stringify(ZS(l));return t.has(u)||(t.add(u),i.push({key:u,link:l})),i},[])}function ew(){let n=b.useContext(cc);return Hg(n,"You must render this element inside a <DataRouterContext.Provider> element"),n}function tE(){let n=b.useContext(tm);return Hg(n,"You must render this element inside a <DataRouterStateContext.Provider> element"),n}var $g=b.createContext(void 0);$g.displayName="FrameworkContext";function tw(){let n=b.useContext($g);return Hg(n,"You must render this element inside a <HydratedRouter> element"),n}function sE(n,e){let t=b.useContext($g),[i,l]=b.useState(!1),[u,d]=b.useState(!1),{onFocus:p,onBlur:g,onMouseEnter:y,onMouseLeave:x,onTouchStart:_}=e,j=b.useRef(null);b.useEffect(()=>{if(n==="render"&&d(!0),n==="viewport"){let B=te=>{te.forEach(Y=>{d(Y.isIntersecting)})},D=new IntersectionObserver(B,{threshold:.5});return j.current&&D.observe(j.current),()=>{D.disconnect()}}},[n]),b.useEffect(()=>{if(i){let B=setTimeout(()=>{d(!0)},100);return()=>{clearTimeout(B)}}},[i]);let O=()=>{l(!0)},K=()=>{l(!1),d(!1)};return t?n!=="intent"?[u,j,{}]:[u,j,{onFocus:su(p,O),onBlur:su(g,K),onMouseEnter:su(y,O),onMouseLeave:su(x,K),onTouchStart:su(_,O)}]:[!1,j,{}]}function su(n,e){return t=>{n&&n(t),t.defaultPrevented||e(t)}}function nE({page:n,...e}){let{router:t}=ew(),i=b.useMemo(()=>U2(t.routes,n,t.basename),[t.routes,n,t.basename]);return i?b.createElement(aE,{page:n,matches:i,...e}):null}function rE(n){let{manifest:e,routeModules:t}=tw(),[i,l]=b.useState([]);return b.useEffect(()=>{let u=!1;return QS(n,e,t).then(d=>{u||l(d)}),()=>{u=!0}},[n,e,t]),i}function aE({page:n,matches:e,...t}){let i=Na(),{future:l,manifest:u,routeModules:d}=tw(),{basename:p}=ew(),{loaderData:g,matches:y}=tE(),x=b.useMemo(()=>U1(n,e,y,u,i,"data"),[n,e,y,u,i]),_=b.useMemo(()=>U1(n,e,y,u,i,"assets"),[n,e,y,u,i]),j=b.useMemo(()=>{if(n===i.pathname+i.search+i.hash)return[];let B=new Set,D=!1;if(e.forEach(Y=>{let Z=u.routes[Y.route.id];!Z||!Z.hasLoader||(!x.some(ke=>ke.route.id===Y.route.id)&&Y.route.id in g&&d[Y.route.id]?.shouldRevalidate||Z.hasClientLoader?D=!0:B.add(Y.route.id))}),B.size===0)return[];let te=GS(n,p,l.unstable_trailingSlashAwareDataRequests,"data");return D&&B.size>0&&te.searchParams.set("_routes",e.filter(Y=>B.has(Y.route.id)).map(Y=>Y.route.id).join(",")),[te.pathname+te.search]},[p,l.unstable_trailingSlashAwareDataRequests,g,i,u,x,e,n,d]),O=b.useMemo(()=>XS(_,u),[_,u]),K=rE(_);return b.createElement(b.Fragment,null,j.map(B=>b.createElement("link",{key:B,rel:"prefetch",as:"fetch",href:B,...t})),O.map(B=>b.createElement("link",{key:B,rel:"modulepreload",href:B,...t})),K.map(({key:B,link:D})=>b.createElement("link",{key:B,nonce:t.nonce,...D,crossOrigin:D.crossOrigin??t.crossOrigin})))}function iE(...n){return e=>{n.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var oE=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{oE&&(window.__reactRouterVersion="7.13.0")}catch{}function lE({basename:n,children:e,unstable_useTransitions:t,window:i}){let l=b.useRef();l.current==null&&(l.current=UT({window:i,v5Compat:!0}));let u=l.current,[d,p]=b.useState({action:u.action,location:u.location}),g=b.useCallback(y=>{t===!1?p(y):b.startTransition(()=>p(y))},[t]);return b.useLayoutEffect(()=>u.listen(g),[u,g]),b.createElement(LS,{basename:n,children:e,location:d.location,navigationType:d.action,navigator:u,unstable_useTransitions:t})}var sw=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,nw=b.forwardRef(function({onClick:e,discover:t="render",prefetch:i="none",relative:l,reloadDocument:u,replace:d,state:p,target:g,to:y,preventScrollReset:x,viewTransition:_,unstable_defaultShouldRevalidate:j,...O},K){let{basename:B,unstable_useTransitions:D}=b.useContext(Kr),te=typeof y=="string"&&sw.test(y),Y=H2(y,B);y=Y.to;let Z=xS(y,{relative:l}),[ke,Re,_e]=sE(i,O),C=hE(y,{replace:d,state:p,target:g,preventScrollReset:x,relative:l,viewTransition:_,unstable_defaultShouldRevalidate:j,unstable_useTransitions:D});function T(V){e&&e(V),V.defaultPrevented||C(V)}let M=b.createElement("a",{...O,..._e,href:Y.absoluteURL||Z,onClick:Y.isExternal||u?e:T,ref:iE(K,Re),target:g,"data-discover":!te&&t==="render"?"true":void 0});return ke&&!te?b.createElement(b.Fragment,null,M,b.createElement(nE,{page:Z})):M});nw.displayName="Link";var cE=b.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:i="",end:l=!1,style:u,to:d,viewTransition:p,children:g,...y},x){let _=Ou(d,{relative:y.relative}),j=Na(),O=b.useContext(tm),{navigator:K,basename:B}=b.useContext(Kr),D=O!=null&&bE(_)&&p===!0,te=K.encodeLocation?K.encodeLocation(_).pathname:_.pathname,Y=j.pathname,Z=O&&O.navigation&&O.navigation.location?O.navigation.location.pathname:null;t||(Y=Y.toLowerCase(),Z=Z?Z.toLowerCase():null,te=te.toLowerCase()),Z&&B&&(Z=_i(Z,B)||Z);const ke=te!=="/"&&te.endsWith("/")?te.length-1:te.length;let Re=Y===te||!l&&Y.startsWith(te)&&Y.charAt(ke)==="/",_e=Z!=null&&(Z===te||!l&&Z.startsWith(te)&&Z.charAt(te.length)==="/"),C={isActive:Re,isPending:_e,isTransitioning:D},T=Re?e:void 0,M;typeof i=="function"?M=i(C):M=[i,Re?"active":null,_e?"pending":null,D?"transitioning":null].filter(Boolean).join(" ");let V=typeof u=="function"?u(C):u;return b.createElement(nw,{...y,"aria-current":T,className:M,ref:x,style:V,to:d,viewTransition:p},typeof g=="function"?g(C):g)});cE.displayName="NavLink";var uE=b.forwardRef(({discover:n="render",fetcherKey:e,navigate:t,reloadDocument:i,replace:l,state:u,method:d=xh,action:p,onSubmit:g,relative:y,preventScrollReset:x,viewTransition:_,unstable_defaultShouldRevalidate:j,...O},K)=>{let{unstable_useTransitions:B}=b.useContext(Kr),D=gE(),te=yE(p,{relative:y}),Y=d.toLowerCase()==="get"?"get":"post",Z=typeof p=="string"&&sw.test(p),ke=Re=>{if(g&&g(Re),Re.defaultPrevented)return;Re.preventDefault();let _e=Re.nativeEvent.submitter,C=_e?.getAttribute("formmethod")||d,T=()=>D(_e||Re.currentTarget,{fetcherKey:e,method:C,navigate:t,replace:l,state:u,relative:y,preventScrollReset:x,viewTransition:_,unstable_defaultShouldRevalidate:j});B&&t!==!1?b.startTransition(()=>T()):T()};return b.createElement("form",{ref:K,method:Y,action:te,onSubmit:i?g:ke,...O,"data-discover":!Z&&n==="render"?"true":void 0})});uE.displayName="Form";function dE(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function rw(n){let e=b.useContext(cc);return dn(e,dE(n)),e}function hE(n,{target:e,replace:t,state:i,preventScrollReset:l,relative:u,viewTransition:d,unstable_defaultShouldRevalidate:p,unstable_useTransitions:g}={}){let y=tr(),x=Na(),_=Ou(n,{relative:u});return b.useCallback(j=>{if(zS(j,e)){j.preventDefault();let O=t!==void 0?t:_u(x)===_u(_),K=()=>y(n,{replace:O,state:i,preventScrollReset:l,relative:u,viewTransition:d,unstable_defaultShouldRevalidate:p});g?b.startTransition(()=>K()):K()}},[x,y,_,t,i,e,n,l,u,d,p,g])}function mE(n){ca(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let e=b.useRef(lg(n)),t=b.useRef(!1),i=Na(),l=b.useMemo(()=>qS(i.search,t.current?null:e.current),[i.search]),u=tr(),d=b.useCallback((p,g)=>{const y=lg(typeof p=="function"?p(new URLSearchParams(l)):p);t.current=!0,u("?"+y,g)},[u,l]);return[l,d]}var fE=0,pE=()=>`__${String(++fE)}__`;function gE(){let{router:n}=rw("useSubmit"),{basename:e}=b.useContext(Kr),t=MS(),i=n.fetch,l=n.navigate;return b.useCallback(async(u,d={})=>{let{action:p,method:g,encType:y,formData:x,body:_}=WS(u,e);if(d.navigate===!1){let j=d.fetcherKey||pE();await i(j,t,d.action||p,{unstable_defaultShouldRevalidate:d.unstable_defaultShouldRevalidate,preventScrollReset:d.preventScrollReset,formData:x,body:_,formMethod:d.method||g,formEncType:d.encType||y,flushSync:d.flushSync})}else await l(d.action||p,{unstable_defaultShouldRevalidate:d.unstable_defaultShouldRevalidate,preventScrollReset:d.preventScrollReset,formData:x,body:_,formMethod:d.method||g,formEncType:d.encType||y,replace:d.replace,state:d.state,fromRouteId:t,flushSync:d.flushSync,viewTransition:d.viewTransition})},[i,l,e,t])}function yE(n,{relative:e}={}){let{basename:t}=b.useContext(Kr),i=b.useContext(Ea);dn(i,"useFormAction must be used inside a RouteContext");let[l]=i.matches.slice(-1),u={...Ou(n||".",{relative:e})},d=Na();if(n==null){u.search=d.search;let p=new URLSearchParams(u.search),g=p.getAll("index");if(g.some(x=>x==="")){p.delete("index"),g.filter(_=>_).forEach(_=>p.append("index",_));let x=p.toString();u.search=x?`?${x}`:""}}return(!n||n===".")&&l.route.index&&(u.search=u.search?u.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(u.pathname=u.pathname==="/"?t:vi([t,u.pathname])),_u(u)}function bE(n,{relative:e}={}){let t=b.useContext(W2);dn(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:i}=rw("useViewTransitionState"),l=Ou(n,{relative:e});if(!t.isTransitioning)return!1;let u=_i(t.currentLocation.pathname,i)||t.currentLocation.pathname,d=_i(t.nextLocation.pathname,i)||t.nextLocation.pathname;return Ih(l.pathname,d)!=null||Ih(l.pathname,u)!=null}const vE=()=>{};var F1={};const aw=function(n){const e=[];let t=0;for(let i=0;i<n.length;i++){let l=n.charCodeAt(i);l<128?e[t++]=l:l<2048?(e[t++]=l>>6|192,e[t++]=l&63|128):(l&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(l=65536+((l&1023)<<10)+(n.charCodeAt(++i)&1023),e[t++]=l>>18|240,e[t++]=l>>12&63|128,e[t++]=l>>6&63|128,e[t++]=l&63|128):(e[t++]=l>>12|224,e[t++]=l>>6&63|128,e[t++]=l&63|128)}return e},xE=function(n){const e=[];let t=0,i=0;for(;t<n.length;){const l=n[t++];if(l<128)e[i++]=String.fromCharCode(l);else if(l>191&&l<224){const u=n[t++];e[i++]=String.fromCharCode((l&31)<<6|u&63)}else if(l>239&&l<365){const u=n[t++],d=n[t++],p=n[t++],g=((l&7)<<18|(u&63)<<12|(d&63)<<6|p&63)-65536;e[i++]=String.fromCharCode(55296+(g>>10)),e[i++]=String.fromCharCode(56320+(g&1023))}else{const u=n[t++],d=n[t++];e[i++]=String.fromCharCode((l&15)<<12|(u&63)<<6|d&63)}}return e.join("")},iw={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let l=0;l<n.length;l+=3){const u=n[l],d=l+1<n.length,p=d?n[l+1]:0,g=l+2<n.length,y=g?n[l+2]:0,x=u>>2,_=(u&3)<<4|p>>4;let j=(p&15)<<2|y>>6,O=y&63;g||(O=64,d||(j=64)),i.push(t[x],t[_],t[j],t[O])}return i.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(aw(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):xE(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let l=0;l<n.length;){const u=t[n.charAt(l++)],p=l<n.length?t[n.charAt(l)]:0;++l;const y=l<n.length?t[n.charAt(l)]:64;++l;const _=l<n.length?t[n.charAt(l)]:64;if(++l,u==null||p==null||y==null||_==null)throw new wE;const j=u<<2|p>>4;if(i.push(j),y!==64){const O=p<<4&240|y>>2;if(i.push(O),_!==64){const K=y<<6&192|_;i.push(K)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class wE extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const _E=function(n){const e=aw(n);return iw.encodeByteArray(e,!0)},Dh=function(n){return _E(n).replace(/\./g,"")},ow=function(n){try{return iw.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function kE(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const jE=()=>kE().__FIREBASE_DEFAULTS__,TE=()=>{if(typeof process>"u"||typeof F1>"u")return;const n=F1.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},SE=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&ow(n[1]);return e&&JSON.parse(e)},nm=()=>{try{return vE()||jE()||TE()||SE()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},lw=n=>nm()?.emulatorHosts?.[n],cw=n=>{const e=lw(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),i]:[e.substring(0,t),i]},uw=()=>nm()?.config,dw=n=>nm()?.[`_${n}`];class EE{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}}function _o(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Wg(n){return(await fetch(n,{credentials:"include"})).ok}function hw(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},i=e||"demo-project",l=n.iat||0,u=n.sub||n.user_id;if(!u)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const d={iss:`https://securetoken.google.com/${i}`,aud:i,iat:l,exp:l+3600,auth_time:l,sub:u,user_id:u,firebase:{sign_in_provider:"custom",identities:{}},...n};return[Dh(JSON.stringify(t)),Dh(JSON.stringify(d)),""].join(".")}const pu={};function NE(){const n={prod:[],emulator:[]};for(const e of Object.keys(pu))pu[e]?n.emulator.push(e):n.prod.push(e);return n}function CE(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let z1=!1;function Gg(n,e){if(typeof window>"u"||typeof document>"u"||!_o(window.location.host)||pu[n]===e||pu[n]||z1)return;pu[n]=e;function t(j){return`__firebase__banner__${j}`}const i="__firebase__banner",u=NE().prod.length>0;function d(){const j=document.getElementById(i);j&&j.remove()}function p(j){j.style.display="flex",j.style.background="#7faaf0",j.style.position="fixed",j.style.bottom="5px",j.style.left="5px",j.style.padding=".5em",j.style.borderRadius="5px",j.style.alignItems="center"}function g(j,O){j.setAttribute("width","24"),j.setAttribute("id",O),j.setAttribute("height","24"),j.setAttribute("viewBox","0 0 24 24"),j.setAttribute("fill","none"),j.style.marginLeft="-6px"}function y(){const j=document.createElement("span");return j.style.cursor="pointer",j.style.marginLeft="16px",j.style.fontSize="24px",j.innerHTML=" &times;",j.onclick=()=>{z1=!0,d()},j}function x(j,O){j.setAttribute("id",O),j.innerText="Learn more",j.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",j.setAttribute("target","__blank"),j.style.paddingLeft="5px",j.style.textDecoration="underline"}function _(){const j=CE(i),O=t("text"),K=document.getElementById(O)||document.createElement("span"),B=t("learnmore"),D=document.getElementById(B)||document.createElement("a"),te=t("preprendIcon"),Y=document.getElementById(te)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(j.created){const Z=j.element;p(Z),x(D,B);const ke=y();g(Y,te),Z.append(Y,K,D,ke),document.body.appendChild(Z)}u?(K.innerText="Preview backend disconnected.",Y.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(Y.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,K.innerText="Preview backend running in this workspace."),K.setAttribute("id",O)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",_):_()}function cr(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function RE(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(cr())}function AE(){const n=nm()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function ME(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function IE(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function DE(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function PE(){const n=cr();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function LE(){return!AE()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function OE(){try{return typeof indexedDB=="object"}catch{return!1}}function BE(){return new Promise((n,e)=>{try{let t=!0;const i="validate-browser-context-for-indexeddb-analytics-module",l=self.indexedDB.open(i);l.onsuccess=()=>{l.result.close(),t||self.indexedDB.deleteDatabase(i),n(!0)},l.onupgradeneeded=()=>{t=!1},l.onerror=()=>{e(l.error?.message||"")}}catch(t){e(t)}})}const VE="FirebaseError";class Qa extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=VE,Object.setPrototypeOf(this,Qa.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Bu.prototype.create)}}class Bu{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){const i=t[0]||{},l=`${this.service}/${e}`,u=this.errors[e],d=u?UE(u,i):"Error",p=`${this.serviceName}: ${d} (${l}).`;return new Qa(l,p,i)}}function UE(n,e){return n.replace(FE,(t,i)=>{const l=e[i];return l!=null?String(l):`<${i}?>`})}const FE=/\{\$([^}]+)}/g;function zE(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Zo(n,e){if(n===e)return!0;const t=Object.keys(n),i=Object.keys(e);for(const l of t){if(!i.includes(l))return!1;const u=n[l],d=e[l];if(q1(u)&&q1(d)){if(!Zo(u,d))return!1}else if(u!==d)return!1}for(const l of i)if(!t.includes(l))return!1;return!0}function q1(n){return n!==null&&typeof n=="object"}function Vu(n){const e=[];for(const[t,i]of Object.entries(n))Array.isArray(i)?i.forEach(l=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(l))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function cu(n){const e={};return n.replace(/^\?/,"").split("&").forEach(i=>{if(i){const[l,u]=i.split("=");e[decodeURIComponent(l)]=decodeURIComponent(u)}}),e}function uu(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function qE(n,e){const t=new HE(n,e);return t.subscribe.bind(t)}class HE{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,i){let l;if(e===void 0&&t===void 0&&i===void 0)throw new Error("Missing Observer.");$E(e,["next","error","complete"])?l=e:l={next:e,error:t,complete:i},l.next===void 0&&(l.next=Ap),l.error===void 0&&(l.error=Ap),l.complete===void 0&&(l.complete=Ap);const u=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?l.error(this.finalError):l.complete()}catch{}}),this.observers.push(l),u}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function $E(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Ap(){}function Ys(n){return n&&n._delegate?n._delegate:n}class po{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const Go="[DEFAULT]";class WE{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const i=new EE;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{const l=this.getOrInitializeService({instanceIdentifier:t});l&&i.resolve(l)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),i=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(l){if(i)return null;throw l}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(KE(e))try{this.getOrInitializeService({instanceIdentifier:Go})}catch{}for(const[t,i]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(t);try{const u=this.getOrInitializeService({instanceIdentifier:l});i.resolve(u)}catch{}}}}clearInstance(e=Go){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Go){return this.instances.has(e)}getOptions(e=Go){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const l=this.getOrInitializeService({instanceIdentifier:i,options:t});for(const[u,d]of this.instancesDeferred.entries()){const p=this.normalizeInstanceIdentifier(u);i===p&&d.resolve(l)}return l}onInit(e,t){const i=this.normalizeInstanceIdentifier(t),l=this.onInitCallbacks.get(i)??new Set;l.add(e),this.onInitCallbacks.set(i,l);const u=this.instances.get(i);return u&&e(u,i),()=>{l.delete(e)}}invokeOnInitCallbacks(e,t){const i=this.onInitCallbacks.get(t);if(i)for(const l of i)try{l(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:GE(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=Go){return this.component?this.component.multipleInstances?e:Go:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function GE(n){return n===Go?void 0:n}function KE(n){return n.instantiationMode==="EAGER"}class YE{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new WE(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}var js;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(js||(js={}));const QE={debug:js.DEBUG,verbose:js.VERBOSE,info:js.INFO,warn:js.WARN,error:js.ERROR,silent:js.SILENT},XE=js.INFO,JE={[js.DEBUG]:"log",[js.VERBOSE]:"log",[js.INFO]:"info",[js.WARN]:"warn",[js.ERROR]:"error"},ZE=(n,e,...t)=>{if(e<n.logLevel)return;const i=new Date().toISOString(),l=JE[e];if(l)console[l](`[${i}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Kg{constructor(e){this.name=e,this._logLevel=XE,this._logHandler=ZE,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in js))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?QE[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,js.DEBUG,...e),this._logHandler(this,js.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,js.VERBOSE,...e),this._logHandler(this,js.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,js.INFO,...e),this._logHandler(this,js.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,js.WARN,...e),this._logHandler(this,js.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,js.ERROR,...e),this._logHandler(this,js.ERROR,...e)}}const eN=(n,e)=>e.some(t=>n instanceof t);let H1,$1;function tN(){return H1||(H1=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function sN(){return $1||($1=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const mw=new WeakMap,cg=new WeakMap,fw=new WeakMap,Mp=new WeakMap,Yg=new WeakMap;function nN(n){const e=new Promise((t,i)=>{const l=()=>{n.removeEventListener("success",u),n.removeEventListener("error",d)},u=()=>{t(co(n.result)),l()},d=()=>{i(n.error),l()};n.addEventListener("success",u),n.addEventListener("error",d)});return e.then(t=>{t instanceof IDBCursor&&mw.set(t,n)}).catch(()=>{}),Yg.set(e,n),e}function rN(n){if(cg.has(n))return;const e=new Promise((t,i)=>{const l=()=>{n.removeEventListener("complete",u),n.removeEventListener("error",d),n.removeEventListener("abort",d)},u=()=>{t(),l()},d=()=>{i(n.error||new DOMException("AbortError","AbortError")),l()};n.addEventListener("complete",u),n.addEventListener("error",d),n.addEventListener("abort",d)});cg.set(n,e)}let ug={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return cg.get(n);if(e==="objectStoreNames")return n.objectStoreNames||fw.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return co(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function aN(n){ug=n(ug)}function iN(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const i=n.call(Ip(this),e,...t);return fw.set(i,e.sort?e.sort():[e]),co(i)}:sN().includes(n)?function(...e){return n.apply(Ip(this),e),co(mw.get(this))}:function(...e){return co(n.apply(Ip(this),e))}}function oN(n){return typeof n=="function"?iN(n):(n instanceof IDBTransaction&&rN(n),eN(n,tN())?new Proxy(n,ug):n)}function co(n){if(n instanceof IDBRequest)return nN(n);if(Mp.has(n))return Mp.get(n);const e=oN(n);return e!==n&&(Mp.set(n,e),Yg.set(e,n)),e}const Ip=n=>Yg.get(n);function lN(n,e,{blocked:t,upgrade:i,blocking:l,terminated:u}={}){const d=indexedDB.open(n,e),p=co(d);return i&&d.addEventListener("upgradeneeded",g=>{i(co(d.result),g.oldVersion,g.newVersion,co(d.transaction),g)}),t&&d.addEventListener("blocked",g=>t(g.oldVersion,g.newVersion,g)),p.then(g=>{u&&g.addEventListener("close",()=>u()),l&&g.addEventListener("versionchange",y=>l(y.oldVersion,y.newVersion,y))}).catch(()=>{}),p}const cN=["get","getKey","getAll","getAllKeys","count"],uN=["put","add","delete","clear"],Dp=new Map;function W1(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Dp.get(e))return Dp.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,l=uN.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(l||cN.includes(t)))return;const u=async function(d,...p){const g=this.transaction(d,l?"readwrite":"readonly");let y=g.store;return i&&(y=y.index(p.shift())),(await Promise.all([y[t](...p),l&&g.done]))[0]};return Dp.set(e,u),u}aN(n=>({...n,get:(e,t,i)=>W1(e,t)||n.get(e,t,i),has:(e,t)=>!!W1(e,t)||n.has(e,t)}));class dN{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(hN(t)){const i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}}function hN(n){return n.getComponent()?.type==="VERSION"}const dg="@firebase/app",G1="0.14.7";const ki=new Kg("@firebase/app"),mN="@firebase/app-compat",fN="@firebase/analytics-compat",pN="@firebase/analytics",gN="@firebase/app-check-compat",yN="@firebase/app-check",bN="@firebase/auth",vN="@firebase/auth-compat",xN="@firebase/database",wN="@firebase/data-connect",_N="@firebase/database-compat",kN="@firebase/functions",jN="@firebase/functions-compat",TN="@firebase/installations",SN="@firebase/installations-compat",EN="@firebase/messaging",NN="@firebase/messaging-compat",CN="@firebase/performance",RN="@firebase/performance-compat",AN="@firebase/remote-config",MN="@firebase/remote-config-compat",IN="@firebase/storage",DN="@firebase/storage-compat",PN="@firebase/firestore",LN="@firebase/ai",ON="@firebase/firestore-compat",BN="firebase",VN="12.8.0";const hg="[DEFAULT]",UN={[dg]:"fire-core",[mN]:"fire-core-compat",[pN]:"fire-analytics",[fN]:"fire-analytics-compat",[yN]:"fire-app-check",[gN]:"fire-app-check-compat",[bN]:"fire-auth",[vN]:"fire-auth-compat",[xN]:"fire-rtdb",[wN]:"fire-data-connect",[_N]:"fire-rtdb-compat",[kN]:"fire-fn",[jN]:"fire-fn-compat",[TN]:"fire-iid",[SN]:"fire-iid-compat",[EN]:"fire-fcm",[NN]:"fire-fcm-compat",[CN]:"fire-perf",[RN]:"fire-perf-compat",[AN]:"fire-rc",[MN]:"fire-rc-compat",[IN]:"fire-gcs",[DN]:"fire-gcs-compat",[PN]:"fire-fst",[ON]:"fire-fst-compat",[LN]:"fire-vertex","fire-js":"fire-js",[BN]:"fire-js-all"};const Ph=new Map,FN=new Map,mg=new Map;function K1(n,e){try{n.container.addComponent(e)}catch(t){ki.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function el(n){const e=n.name;if(mg.has(e))return ki.debug(`There were multiple attempts to register component ${e}.`),!1;mg.set(e,n);for(const t of Ph.values())K1(t,n);for(const t of FN.values())K1(t,n);return!0}function rm(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function $r(n){return n==null?!1:n.settings!==void 0}const zN={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},uo=new Bu("app","Firebase",zN);class qN{constructor(e,t,i){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new po("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw uo.create("app-deleted",{appName:this._name})}}const ol=VN;function Qg(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const i={name:hg,automaticDataCollectionEnabled:!0,...e},l=i.name;if(typeof l!="string"||!l)throw uo.create("bad-app-name",{appName:String(l)});if(t||(t=uw()),!t)throw uo.create("no-options");const u=Ph.get(l);if(u){if(Zo(t,u.options)&&Zo(i,u.config))return u;throw uo.create("duplicate-app",{appName:l})}const d=new YE(l);for(const g of mg.values())d.addComponent(g);const p=new qN(t,i,d);return Ph.set(l,p),p}function Xg(n=hg){const e=Ph.get(n);if(!e&&n===hg&&uw())return Qg();if(!e)throw uo.create("no-app",{appName:n});return e}function za(n,e,t){let i=UN[n]??n;t&&(i+=`-${t}`);const l=i.match(/\s|\//),u=e.match(/\s|\//);if(l||u){const d=[`Unable to register library "${i}" with version "${e}":`];l&&d.push(`library name "${i}" contains illegal characters (whitespace or "/")`),l&&u&&d.push("and"),u&&d.push(`version name "${e}" contains illegal characters (whitespace or "/")`),ki.warn(d.join(" "));return}el(new po(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}const HN="firebase-heartbeat-database",$N=1,ku="firebase-heartbeat-store";let Pp=null;function pw(){return Pp||(Pp=lN(HN,$N,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(ku)}catch(t){console.warn(t)}}}}).catch(n=>{throw uo.create("idb-open",{originalErrorMessage:n.message})})),Pp}async function WN(n){try{const t=(await pw()).transaction(ku),i=await t.objectStore(ku).get(gw(n));return await t.done,i}catch(e){if(e instanceof Qa)ki.warn(e.message);else{const t=uo.create("idb-get",{originalErrorMessage:e?.message});ki.warn(t.message)}}}async function Y1(n,e){try{const i=(await pw()).transaction(ku,"readwrite");await i.objectStore(ku).put(e,gw(n)),await i.done}catch(t){if(t instanceof Qa)ki.warn(t.message);else{const i=uo.create("idb-set",{originalErrorMessage:t?.message});ki.warn(i.message)}}}function gw(n){return`${n.name}!${n.options.appId}`}const GN=1024,KN=30;class YN{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new XN(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=Q1();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(l=>l.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:t}),this._heartbeatsCache.heartbeats.length>KN){const l=JN(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(l,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){ki.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=Q1(),{heartbeatsToSend:t,unsentEntries:i}=QN(this._heartbeatsCache.heartbeats),l=Dh(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),l}catch(e){return ki.warn(e),""}}}function Q1(){return new Date().toISOString().substring(0,10)}function QN(n,e=GN){const t=[];let i=n.slice();for(const l of n){const u=t.find(d=>d.agent===l.agent);if(u){if(u.dates.push(l.date),X1(t)>e){u.dates.pop();break}}else if(t.push({agent:l.agent,dates:[l.date]}),X1(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}class XN{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return OE()?BE().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await WN(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return Y1(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return Y1(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function X1(n){return Dh(JSON.stringify({version:2,heartbeats:n})).length}function JN(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let i=1;i<n.length;i++)n[i].date<t&&(t=n[i].date,e=i);return e}function ZN(n){el(new po("platform-logger",e=>new dN(e),"PRIVATE")),el(new po("heartbeat",e=>new YN(e),"PRIVATE")),za(dg,G1,n),za(dg,G1,"esm2020"),za("fire-js","")}ZN("");function yw(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const eC=yw,bw=new Bu("auth","Firebase",yw());const Lh=new Kg("@firebase/auth");function tC(n,...e){Lh.logLevel<=js.WARN&&Lh.warn(`Auth (${ol}): ${n}`,...e)}function _h(n,...e){Lh.logLevel<=js.ERROR&&Lh.error(`Auth (${ol}): ${n}`,...e)}function ka(n,...e){throw Jg(n,...e)}function qa(n,...e){return Jg(n,...e)}function vw(n,e,t){const i={...eC(),[e]:t};return new Bu("auth","Firebase",i).create(e,{appName:n.name})}function xi(n){return vw(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Jg(n,...e){if(typeof n!="string"){const t=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=n.name),n._errorFactory.create(t,...i)}return bw.create(n,...e)}function Qt(n,e,...t){if(!n)throw Jg(e,...t)}function pi(n){const e="INTERNAL ASSERTION FAILED: "+n;throw _h(e),new Error(e)}function ji(n,e){n||pi(e)}function fg(){return typeof self<"u"&&self.location?.href||""}function sC(){return J1()==="http:"||J1()==="https:"}function J1(){return typeof self<"u"&&self.location?.protocol||null}function nC(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(sC()||IE()||"connection"in navigator)?navigator.onLine:!0}function rC(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}class Uu{constructor(e,t){this.shortDelay=e,this.longDelay=t,ji(t>e,"Short delay should be less than long delay!"),this.isMobile=RE()||DE()}get(){return nC()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function Zg(n,e){ji(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class xw{static initialize(e,t,i){this.fetchImpl=e,t&&(this.headersImpl=t),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;pi("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;pi("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;pi("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const aC={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const iC=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],oC=new Uu(3e4,6e4);function Ei(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function Ni(n,e,t,i,l={}){return ww(n,l,async()=>{let u={},d={};i&&(e==="GET"?d=i:u={body:JSON.stringify(i)});const p=Vu({key:n.config.apiKey,...d}).slice(1),g=await n._getAdditionalHeaders();g["Content-Type"]="application/json",n.languageCode&&(g["X-Firebase-Locale"]=n.languageCode);const y={method:e,headers:g,...u};return ME()||(y.referrerPolicy="no-referrer"),n.emulatorConfig&&_o(n.emulatorConfig.host)&&(y.credentials="include"),xw.fetch()(await _w(n,n.config.apiHost,t,p),y)})}async function ww(n,e,t){n._canInitEmulator=!1;const i={...aC,...e};try{const l=new cC(n),u=await Promise.race([t(),l.promise]);l.clearNetworkTimeout();const d=await u.json();if("needConfirmation"in d)throw ah(n,"account-exists-with-different-credential",d);if(u.ok&&!("errorMessage"in d))return d;{const p=u.ok?d.errorMessage:d.error.message,[g,y]=p.split(" : ");if(g==="FEDERATED_USER_ID_ALREADY_LINKED")throw ah(n,"credential-already-in-use",d);if(g==="EMAIL_EXISTS")throw ah(n,"email-already-in-use",d);if(g==="USER_DISABLED")throw ah(n,"user-disabled",d);const x=i[g]||g.toLowerCase().replace(/[_\s]+/g,"-");if(y)throw vw(n,x,y);ka(n,x)}}catch(l){if(l instanceof Qa)throw l;ka(n,"network-request-failed",{message:String(l)})}}async function Fu(n,e,t,i,l={}){const u=await Ni(n,e,t,i,l);return"mfaPendingCredential"in u&&ka(n,"multi-factor-auth-required",{_serverResponse:u}),u}async function _w(n,e,t,i){const l=`${e}${t}?${i}`,u=n,d=u.config.emulator?Zg(n.config,l):`${n.config.apiScheme}://${l}`;return iC.includes(t)&&(await u._persistenceManagerAvailable,u._getPersistenceType()==="COOKIE")?u._getPersistence()._getFinalTarget(d).toString():d}function lC(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class cC{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,i)=>{this.timer=setTimeout(()=>i(qa(this.auth,"network-request-failed")),oC.get())})}}function ah(n,e,t){const i={appName:n.name};t.email&&(i.email=t.email),t.phoneNumber&&(i.phoneNumber=t.phoneNumber);const l=qa(n,e,i);return l.customData._tokenResponse=t,l}function Z1(n){return n!==void 0&&n.enterprise!==void 0}class uC{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return lC(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function dC(n,e){return Ni(n,"GET","/v2/recaptchaConfig",Ei(n,e))}async function hC(n,e){return Ni(n,"POST","/v1/accounts:delete",e)}async function Oh(n,e){return Ni(n,"POST","/v1/accounts:lookup",e)}function gu(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function mC(n,e=!1){const t=Ys(n),i=await t.getIdToken(e),l=ey(i);Qt(l&&l.exp&&l.auth_time&&l.iat,t.auth,"internal-error");const u=typeof l.firebase=="object"?l.firebase:void 0,d=u?.sign_in_provider;return{claims:l,token:i,authTime:gu(Lp(l.auth_time)),issuedAtTime:gu(Lp(l.iat)),expirationTime:gu(Lp(l.exp)),signInProvider:d||null,signInSecondFactor:u?.sign_in_second_factor||null}}function Lp(n){return Number(n)*1e3}function ey(n){const[e,t,i]=n.split(".");if(e===void 0||t===void 0||i===void 0)return _h("JWT malformed, contained fewer than 3 sections"),null;try{const l=ow(t);return l?JSON.parse(l):(_h("Failed to decode base64 JWT payload"),null)}catch(l){return _h("Caught error parsing JWT payload as JSON",l?.toString()),null}}function ex(n){const e=ey(n);return Qt(e,"internal-error"),Qt(typeof e.exp<"u","internal-error"),Qt(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function ju(n,e,t=!1){if(t)return e;try{return await e}catch(i){throw i instanceof Qa&&fC(i)&&n.auth.currentUser===n&&await n.auth.signOut(),i}}function fC({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}class pC{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const i=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class pg{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=gu(this.lastLoginAt),this.creationTime=gu(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Bh(n){const e=n.auth,t=await n.getIdToken(),i=await ju(n,Oh(e,{idToken:t}));Qt(i?.users.length,e,"internal-error");const l=i.users[0];n._notifyReloadListener(l);const u=l.providerUserInfo?.length?kw(l.providerUserInfo):[],d=yC(n.providerData,u),p=n.isAnonymous,g=!(n.email&&l.passwordHash)&&!d?.length,y=p?g:!1,x={uid:l.localId,displayName:l.displayName||null,photoURL:l.photoUrl||null,email:l.email||null,emailVerified:l.emailVerified||!1,phoneNumber:l.phoneNumber||null,tenantId:l.tenantId||null,providerData:d,metadata:new pg(l.createdAt,l.lastLoginAt),isAnonymous:y};Object.assign(n,x)}async function gC(n){const e=Ys(n);await Bh(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function yC(n,e){return[...n.filter(i=>!e.some(l=>l.providerId===i.providerId)),...e]}function kw(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}async function bC(n,e){const t=await ww(n,{},async()=>{const i=Vu({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:l,apiKey:u}=n.config,d=await _w(n,l,"/v1/token",`key=${u}`),p=await n._getAdditionalHeaders();p["Content-Type"]="application/x-www-form-urlencoded";const g={method:"POST",headers:p,body:i};return n.emulatorConfig&&_o(n.emulatorConfig.host)&&(g.credentials="include"),xw.fetch()(d,g)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function vC(n,e){return Ni(n,"POST","/v2/accounts:revokeToken",Ei(n,e))}class Ql{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Qt(e.idToken,"internal-error"),Qt(typeof e.idToken<"u","internal-error"),Qt(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):ex(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Qt(e.length!==0,"internal-error");const t=ex(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Qt(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:i,refreshToken:l,expiresIn:u}=await bC(e,t);this.updateTokensAndExpiration(i,l,Number(u))}updateTokensAndExpiration(e,t,i){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,t){const{refreshToken:i,accessToken:l,expirationTime:u}=t,d=new Ql;return i&&(Qt(typeof i=="string","internal-error",{appName:e}),d.refreshToken=i),l&&(Qt(typeof l=="string","internal-error",{appName:e}),d.accessToken=l),u&&(Qt(typeof u=="number","internal-error",{appName:e}),d.expirationTime=u),d}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Ql,this.toJSON())}_performRefresh(){return pi("not implemented")}}function to(n,e){Qt(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class wa{constructor({uid:e,auth:t,stsTokenManager:i,...l}){this.providerId="firebase",this.proactiveRefresh=new pC(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=l.displayName||null,this.email=l.email||null,this.emailVerified=l.emailVerified||!1,this.phoneNumber=l.phoneNumber||null,this.photoURL=l.photoURL||null,this.isAnonymous=l.isAnonymous||!1,this.tenantId=l.tenantId||null,this.providerData=l.providerData?[...l.providerData]:[],this.metadata=new pg(l.createdAt||void 0,l.lastLoginAt||void 0)}async getIdToken(e){const t=await ju(this,this.stsTokenManager.getToken(this.auth,e));return Qt(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return mC(this,e)}reload(){return gC(this)}_assign(e){this!==e&&(Qt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new wa({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){Qt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),t&&await Bh(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if($r(this.auth.app))return Promise.reject(xi(this.auth));const e=await this.getIdToken();return await ju(this,hC(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const i=t.displayName??void 0,l=t.email??void 0,u=t.phoneNumber??void 0,d=t.photoURL??void 0,p=t.tenantId??void 0,g=t._redirectEventId??void 0,y=t.createdAt??void 0,x=t.lastLoginAt??void 0,{uid:_,emailVerified:j,isAnonymous:O,providerData:K,stsTokenManager:B}=t;Qt(_&&B,e,"internal-error");const D=Ql.fromJSON(this.name,B);Qt(typeof _=="string",e,"internal-error"),to(i,e.name),to(l,e.name),Qt(typeof j=="boolean",e,"internal-error"),Qt(typeof O=="boolean",e,"internal-error"),to(u,e.name),to(d,e.name),to(p,e.name),to(g,e.name),to(y,e.name),to(x,e.name);const te=new wa({uid:_,auth:e,email:l,emailVerified:j,displayName:i,isAnonymous:O,photoURL:d,phoneNumber:u,tenantId:p,stsTokenManager:D,createdAt:y,lastLoginAt:x});return K&&Array.isArray(K)&&(te.providerData=K.map(Y=>({...Y}))),g&&(te._redirectEventId=g),te}static async _fromIdTokenResponse(e,t,i=!1){const l=new Ql;l.updateFromServerResponse(t);const u=new wa({uid:t.localId,auth:e,stsTokenManager:l,isAnonymous:i});return await Bh(u),u}static async _fromGetAccountInfoResponse(e,t,i){const l=t.users[0];Qt(l.localId!==void 0,"internal-error");const u=l.providerUserInfo!==void 0?kw(l.providerUserInfo):[],d=!(l.email&&l.passwordHash)&&!u?.length,p=new Ql;p.updateFromIdToken(i);const g=new wa({uid:l.localId,auth:e,stsTokenManager:p,isAnonymous:d}),y={uid:l.localId,displayName:l.displayName||null,photoURL:l.photoUrl||null,email:l.email||null,emailVerified:l.emailVerified||!1,phoneNumber:l.phoneNumber||null,tenantId:l.tenantId||null,providerData:u,metadata:new pg(l.createdAt,l.lastLoginAt),isAnonymous:!(l.email&&l.passwordHash)&&!u?.length};return Object.assign(g,y),g}}const tx=new Map;function gi(n){ji(n instanceof Function,"Expected a class definition");let e=tx.get(n);return e?(ji(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,tx.set(n,e),e)}class jw{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}jw.type="NONE";const sx=jw;function kh(n,e,t){return`firebase:${n}:${e}:${t}`}class Xl{constructor(e,t,i){this.persistence=e,this.auth=t,this.userKey=i;const{config:l,name:u}=this.auth;this.fullUserKey=kh(this.userKey,l.apiKey,u),this.fullPersistenceKey=kh("persistence",l.apiKey,u),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await Oh(this.auth,{idToken:e}).catch(()=>{});return t?wa._fromGetAccountInfoResponse(this.auth,t,e):null}return wa._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,i="authUser"){if(!t.length)return new Xl(gi(sx),e,i);const l=(await Promise.all(t.map(async y=>{if(await y._isAvailable())return y}))).filter(y=>y);let u=l[0]||gi(sx);const d=kh(i,e.config.apiKey,e.name);let p=null;for(const y of t)try{const x=await y._get(d);if(x){let _;if(typeof x=="string"){const j=await Oh(e,{idToken:x}).catch(()=>{});if(!j)break;_=await wa._fromGetAccountInfoResponse(e,j,x)}else _=wa._fromJSON(e,x);y!==u&&(p=_),u=y;break}}catch{}const g=l.filter(y=>y._shouldAllowMigration);return!u._shouldAllowMigration||!g.length?new Xl(u,e,i):(u=g[0],p&&await u._set(d,p.toJSON()),await Promise.all(t.map(async y=>{if(y!==u)try{await y._remove(d)}catch{}})),new Xl(u,e,i))}}function nx(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Nw(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Tw(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Rw(e))return"Blackberry";if(Aw(e))return"Webos";if(Sw(e))return"Safari";if((e.includes("chrome/")||Ew(e))&&!e.includes("edge/"))return"Chrome";if(Cw(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=n.match(t);if(i?.length===2)return i[1]}return"Other"}function Tw(n=cr()){return/firefox\//i.test(n)}function Sw(n=cr()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Ew(n=cr()){return/crios\//i.test(n)}function Nw(n=cr()){return/iemobile/i.test(n)}function Cw(n=cr()){return/android/i.test(n)}function Rw(n=cr()){return/blackberry/i.test(n)}function Aw(n=cr()){return/webos/i.test(n)}function ty(n=cr()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function xC(n=cr()){return ty(n)&&!!window.navigator?.standalone}function wC(){return PE()&&document.documentMode===10}function Mw(n=cr()){return ty(n)||Cw(n)||Aw(n)||Rw(n)||/windows phone/i.test(n)||Nw(n)}function Iw(n,e=[]){let t;switch(n){case"Browser":t=nx(cr());break;case"Worker":t=`${nx(cr())}-${n}`;break;default:t=n}const i=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${ol}/${i}`}class _C{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const i=u=>new Promise((d,p)=>{try{const g=e(u);d(g)}catch(g){p(g)}});i.onAbort=t,this.queue.push(i);const l=this.queue.length-1;return()=>{this.queue[l]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const i of this.queue)await i(e),i.onAbort&&t.push(i.onAbort)}catch(i){t.reverse();for(const l of t)try{l()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i?.message})}}}async function kC(n,e={}){return Ni(n,"GET","/v2/passwordPolicy",Ei(n,e))}const jC=6;class TC{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??jC,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const i=this.customStrengthOptions.minPasswordLength,l=this.customStrengthOptions.maxPasswordLength;i&&(t.meetsMinPasswordLength=e.length>=i),l&&(t.meetsMaxPasswordLength=e.length<=l)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let i;for(let l=0;l<e.length;l++)i=e.charAt(l),this.updatePasswordCharacterOptionsStatuses(t,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,t,i,l,u){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=l)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=u))}}class SC{constructor(e,t,i,l){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=i,this.config=l,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new rx(this),this.idTokenSubscription=new rx(this),this.beforeStateQueue=new _C(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=bw,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=l.sdkClientVersion,this._persistenceManagerAvailable=new Promise(u=>this._resolvePersistenceManagerAvailable=u)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=gi(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await Xl.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await Oh(this,{idToken:e}),i=await wa._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(i)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if($r(this.app)){const u=this.app.settings.authIdToken;return u?new Promise(d=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(u).then(d,d))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let i=t,l=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const u=this.redirectUser?._redirectEventId,d=i?._redirectEventId,p=await this.tryRedirectSignIn(e);(!u||u===d)&&p?.user&&(i=p.user,l=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(l)try{await this.beforeStateQueue.runMiddleware(i)}catch(u){i=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(u))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return Qt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Bh(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=rC()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if($r(this.app))return Promise.reject(xi(this));const t=e?Ys(e):null;return t&&Qt(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Qt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return $r(this.app)?Promise.reject(xi(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return $r(this.app)?Promise.reject(xi(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(gi(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await kC(this),t=new TC(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Bu("auth","Firebase",e())}onAuthStateChanged(e,t,i){return this.registerStateListener(this.authStateSubscription,e,t,i)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,i){return this.registerStateListener(this.idTokenSubscription,e,t,i)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const i=this.onAuthStateChanged(()=>{i(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(i.tenantId=this.tenantId),await vC(this,i)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const i=await this.getOrInitRedirectPersistenceManager(t);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&gi(e)||this._popupRedirectResolver;Qt(t,this,"argument-error"),this.redirectPersistenceManager=await Xl.create(this,[gi(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,i,l){if(this._deleted)return()=>{};const u=typeof t=="function"?t:t.next.bind(t);let d=!1;const p=this._isInitialized?Promise.resolve():this._initializationPromise;if(Qt(p,this,"internal-error"),p.then(()=>{d||u(this.currentUser)}),typeof t=="function"){const g=e.addObserver(t,i,l);return()=>{d=!0,g()}}else{const g=e.addObserver(t);return()=>{d=!0,g()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Qt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Iw(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const i=await this._getAppCheckToken();return i&&(e["X-Firebase-AppCheck"]=i),e}async _getAppCheckToken(){if($r(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&tC(`Error while retrieving App Check token: ${e.error}`),e?.token}}function ko(n){return Ys(n)}class rx{constructor(e){this.auth=e,this.observer=null,this.addObserver=qE(t=>this.observer=t)}get next(){return Qt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let am={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function EC(n){am=n}function Dw(n){return am.loadJS(n)}function NC(){return am.recaptchaEnterpriseScript}function CC(){return am.gapiScript}function RC(n){return`__${n}${Math.floor(Math.random()*1e6)}`}class AC{constructor(){this.enterprise=new MC}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class MC{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const IC="recaptcha-enterprise",Pw="NO_RECAPTCHA";class DC{constructor(e){this.type=IC,this.auth=ko(e)}async verify(e="verify",t=!1){async function i(u){if(!t){if(u.tenantId==null&&u._agentRecaptchaConfig!=null)return u._agentRecaptchaConfig.siteKey;if(u.tenantId!=null&&u._tenantRecaptchaConfigs[u.tenantId]!==void 0)return u._tenantRecaptchaConfigs[u.tenantId].siteKey}return new Promise(async(d,p)=>{dC(u,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(g=>{if(g.recaptchaKey===void 0)p(new Error("recaptcha Enterprise site key undefined"));else{const y=new uC(g);return u.tenantId==null?u._agentRecaptchaConfig=y:u._tenantRecaptchaConfigs[u.tenantId]=y,d(y.siteKey)}}).catch(g=>{p(g)})})}function l(u,d,p){const g=window.grecaptcha;Z1(g)?g.enterprise.ready(()=>{g.enterprise.execute(u,{action:e}).then(y=>{d(y)}).catch(()=>{d(Pw)})}):p(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new AC().execute("siteKey",{action:"verify"}):new Promise((u,d)=>{i(this.auth).then(p=>{if(!t&&Z1(window.grecaptcha))l(p,u,d);else{if(typeof window>"u"){d(new Error("RecaptchaVerifier is only supported in browser"));return}let g=NC();g.length!==0&&(g+=p),Dw(g).then(()=>{l(p,u,d)}).catch(y=>{d(y)})}}).catch(p=>{d(p)})})}}async function ax(n,e,t,i=!1,l=!1){const u=new DC(n);let d;if(l)d=Pw;else try{d=await u.verify(t)}catch{d=await u.verify(t,!0)}const p={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in p){const g=p.phoneEnrollmentInfo.phoneNumber,y=p.phoneEnrollmentInfo.recaptchaToken;Object.assign(p,{phoneEnrollmentInfo:{phoneNumber:g,recaptchaToken:y,captchaResponse:d,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in p){const g=p.phoneSignInInfo.recaptchaToken;Object.assign(p,{phoneSignInInfo:{recaptchaToken:g,captchaResponse:d,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return p}return i?Object.assign(p,{captchaResp:d}):Object.assign(p,{captchaResponse:d}),Object.assign(p,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(p,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),p}async function Vh(n,e,t,i,l){if(n._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const u=await ax(n,e,t,t==="getOobCode");return i(n,u)}else return i(n,e).catch(async u=>{if(u.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const d=await ax(n,e,t,t==="getOobCode");return i(n,d)}else return Promise.reject(u)})}function PC(n,e){const t=rm(n,"auth");if(t.isInitialized()){const l=t.getImmediate(),u=t.getOptions();if(Zo(u,e??{}))return l;ka(l,"already-initialized")}return t.initialize({options:e})}function LC(n,e){const t=e?.persistence||[],i=(Array.isArray(t)?t:[t]).map(gi);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(i,e?.popupRedirectResolver)}function OC(n,e,t){const i=ko(n);Qt(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const l=!1,u=Lw(e),{host:d,port:p}=BC(e),g=p===null?"":`:${p}`,y={url:`${u}//${d}${g}/`},x=Object.freeze({host:d,port:p,protocol:u.replace(":",""),options:Object.freeze({disableWarnings:l})});if(!i._canInitEmulator){Qt(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),Qt(Zo(y,i.config.emulator)&&Zo(x,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=y,i.emulatorConfig=x,i.settings.appVerificationDisabledForTesting=!0,_o(d)?(Wg(`${u}//${d}${g}`),Gg("Auth",!0)):VC()}function Lw(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function BC(n){const e=Lw(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const i=t[2].split("@").pop()||"",l=/^(\[[^\]]+\])(:|$)/.exec(i);if(l){const u=l[1];return{host:u,port:ix(i.substr(u.length+1))}}else{const[u,d]=i.split(":");return{host:u,port:ix(d)}}}function ix(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function VC(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}class sy{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return pi("not implemented")}_getIdTokenResponse(e){return pi("not implemented")}_linkToIdToken(e,t){return pi("not implemented")}_getReauthenticationResolver(e){return pi("not implemented")}}async function UC(n,e){return Ni(n,"POST","/v1/accounts:signUp",e)}async function FC(n,e){return Fu(n,"POST","/v1/accounts:signInWithPassword",Ei(n,e))}async function Ow(n,e){return Ni(n,"POST","/v1/accounts:sendOobCode",Ei(n,e))}async function zC(n,e){return Ow(n,e)}async function qC(n,e){return Ow(n,e)}async function HC(n,e){return Fu(n,"POST","/v1/accounts:signInWithEmailLink",Ei(n,e))}async function $C(n,e){return Fu(n,"POST","/v1/accounts:signInWithEmailLink",Ei(n,e))}class Tu extends sy{constructor(e,t,i,l=null){super("password",i),this._email=e,this._password=t,this._tenantId=l}static _fromEmailAndPassword(e,t){return new Tu(e,t,"password")}static _fromEmailAndCode(e,t,i=null){return new Tu(e,t,"emailLink",i)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Vh(e,t,"signInWithPassword",FC);case"emailLink":return HC(e,{email:this._email,oobCode:this._password});default:ka(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const i={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Vh(e,i,"signUpPassword",UC);case"emailLink":return $C(e,{idToken:t,email:this._email,oobCode:this._password});default:ka(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function Jl(n,e){return Fu(n,"POST","/v1/accounts:signInWithIdp",Ei(n,e))}const WC="http://localhost";class tl extends sy{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new tl(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):ka("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:l,...u}=t;if(!i||!l)return null;const d=new tl(i,l);return d.idToken=u.idToken||void 0,d.accessToken=u.accessToken||void 0,d.secret=u.secret,d.nonce=u.nonce,d.pendingToken=u.pendingToken||null,d}_getIdTokenResponse(e){const t=this.buildRequest();return Jl(e,t)}_linkToIdToken(e,t){const i=this.buildRequest();return i.idToken=t,Jl(e,i)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Jl(e,t)}buildRequest(){const e={requestUri:WC,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Vu(t)}return e}}function GC(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function KC(n){const e=cu(uu(n)).link,t=e?cu(uu(e)).deep_link_id:null,i=cu(uu(n)).deep_link_id;return(i?cu(uu(i)).link:null)||i||t||e||n}class ny{constructor(e){const t=cu(uu(e)),i=t.apiKey??null,l=t.oobCode??null,u=GC(t.mode??null);Qt(i&&l&&u,"argument-error"),this.apiKey=i,this.operation=u,this.code=l,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=KC(e);try{return new ny(t)}catch{return null}}}class dc{constructor(){this.providerId=dc.PROVIDER_ID}static credential(e,t){return Tu._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const i=ny.parseLink(t);return Qt(i,"argument-error"),Tu._fromEmailAndCode(e,i.code,i.tenantId)}}dc.PROVIDER_ID="password";dc.EMAIL_PASSWORD_SIGN_IN_METHOD="password";dc.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class Bw{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class zu extends Bw{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class no extends zu{constructor(){super("facebook.com")}static credential(e){return tl._fromParams({providerId:no.PROVIDER_ID,signInMethod:no.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return no.credentialFromTaggedObject(e)}static credentialFromError(e){return no.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return no.credential(e.oauthAccessToken)}catch{return null}}}no.FACEBOOK_SIGN_IN_METHOD="facebook.com";no.PROVIDER_ID="facebook.com";class ro extends zu{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return tl._fromParams({providerId:ro.PROVIDER_ID,signInMethod:ro.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return ro.credentialFromTaggedObject(e)}static credentialFromError(e){return ro.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:i}=e;if(!t&&!i)return null;try{return ro.credential(t,i)}catch{return null}}}ro.GOOGLE_SIGN_IN_METHOD="google.com";ro.PROVIDER_ID="google.com";class ao extends zu{constructor(){super("github.com")}static credential(e){return tl._fromParams({providerId:ao.PROVIDER_ID,signInMethod:ao.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ao.credentialFromTaggedObject(e)}static credentialFromError(e){return ao.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ao.credential(e.oauthAccessToken)}catch{return null}}}ao.GITHUB_SIGN_IN_METHOD="github.com";ao.PROVIDER_ID="github.com";class io extends zu{constructor(){super("twitter.com")}static credential(e,t){return tl._fromParams({providerId:io.PROVIDER_ID,signInMethod:io.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return io.credentialFromTaggedObject(e)}static credentialFromError(e){return io.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:i}=e;if(!t||!i)return null;try{return io.credential(t,i)}catch{return null}}}io.TWITTER_SIGN_IN_METHOD="twitter.com";io.PROVIDER_ID="twitter.com";async function YC(n,e){return Fu(n,"POST","/v1/accounts:signUp",Ei(n,e))}class sl{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,i,l=!1){const u=await wa._fromIdTokenResponse(e,i,l),d=ox(i);return new sl({user:u,providerId:d,_tokenResponse:i,operationType:t})}static async _forOperation(e,t,i){await e._updateTokensIfNecessary(i,!0);const l=ox(i);return new sl({user:e,providerId:l,_tokenResponse:i,operationType:t})}}function ox(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}class Uh extends Qa{constructor(e,t,i,l){super(t.code,t.message),this.operationType=i,this.user=l,Object.setPrototypeOf(this,Uh.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,t,i,l){return new Uh(e,t,i,l)}}function Vw(n,e,t,i){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(u=>{throw u.code==="auth/multi-factor-auth-required"?Uh._fromErrorAndOperation(n,u,e,i):u})}async function QC(n,e,t=!1){const i=await ju(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return sl._forOperation(n,"link",i)}async function XC(n,e,t=!1){const{auth:i}=n;if($r(i.app))return Promise.reject(xi(i));const l="reauthenticate";try{const u=await ju(n,Vw(i,l,e,n),t);Qt(u.idToken,i,"internal-error");const d=ey(u.idToken);Qt(d,i,"internal-error");const{sub:p}=d;return Qt(n.uid===p,i,"user-mismatch"),sl._forOperation(n,l,u)}catch(u){throw u?.code==="auth/user-not-found"&&ka(i,"user-mismatch"),u}}async function Uw(n,e,t=!1){if($r(n.app))return Promise.reject(xi(n));const i="signIn",l=await Vw(n,i,e),u=await sl._fromIdTokenResponse(n,i,l);return t||await n._updateCurrentUser(u.user),u}async function JC(n,e){return Uw(ko(n),e)}async function Fw(n){const e=ko(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function ZC(n,e,t){const i=ko(n);await Vh(i,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",qC)}async function e4(n,e,t){if($r(n.app))return Promise.reject(xi(n));const i=ko(n),d=await Vh(i,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",YC).catch(g=>{throw g.code==="auth/password-does-not-meet-requirements"&&Fw(n),g}),p=await sl._fromIdTokenResponse(i,"signIn",d);return await i._updateCurrentUser(p.user),p}function t4(n,e,t){return $r(n.app)?Promise.reject(xi(n)):JC(Ys(n),dc.credential(e,t)).catch(async i=>{throw i.code==="auth/password-does-not-meet-requirements"&&Fw(n),i})}async function gP(n,e){const t=Ys(n),l={requestType:"VERIFY_EMAIL",idToken:await n.getIdToken()},{email:u}=await zC(t.auth,l);u!==n.email&&await n.reload()}function lx(n,e){return Ys(n).setPersistence(e)}function s4(n,e,t,i){return Ys(n).onIdTokenChanged(e,t,i)}function n4(n,e,t){return Ys(n).beforeAuthStateChanged(e,t)}function r4(n,e,t,i){return Ys(n).onAuthStateChanged(e,t,i)}function a4(n){return Ys(n).signOut()}const Fh="__sak";class zw{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Fh,"1"),this.storage.removeItem(Fh),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const i4=1e3,o4=10;class qw extends zw{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Mw(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const i=this.storage.getItem(t),l=this.localCache[t];i!==l&&e(t,l,i)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((d,p,g)=>{this.notifyListeners(d,g)});return}const i=e.key;t?this.detachListener():this.stopPolling();const l=()=>{const d=this.storage.getItem(i);!t&&this.localCache[i]===d||this.notifyListeners(i,d)},u=this.storage.getItem(i);wC()&&u!==e.newValue&&e.newValue!==e.oldValue?setTimeout(l,o4):l()}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const l of Array.from(i))l(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:i}),!0)})},i4)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}qw.type="LOCAL";const gg=qw;class Hw extends zw{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}Hw.type="SESSION";const ry=Hw;function l4(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class im{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(l=>l.isListeningto(e));if(t)return t;const i=new im(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:i,eventType:l,data:u}=t.data,d=this.handlersMap[l];if(!d?.size)return;t.ports[0].postMessage({status:"ack",eventId:i,eventType:l});const p=Array.from(d).map(async y=>y(t.origin,u)),g=await l4(p);t.ports[0].postMessage({status:"done",eventId:i,eventType:l,response:g})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}im.receivers=[];function ay(n="",e=10){let t="";for(let i=0;i<e;i++)t+=Math.floor(Math.random()*10);return n+t}class c4{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,i=50){const l=typeof MessageChannel<"u"?new MessageChannel:null;if(!l)throw new Error("connection_unavailable");let u,d;return new Promise((p,g)=>{const y=ay("",20);l.port1.start();const x=setTimeout(()=>{g(new Error("unsupported_event"))},i);d={messageChannel:l,onMessage(_){const j=_;if(j.data.eventId===y)switch(j.data.status){case"ack":clearTimeout(x),u=setTimeout(()=>{g(new Error("timeout"))},3e3);break;case"done":clearTimeout(u),p(j.data.response);break;default:clearTimeout(x),clearTimeout(u),g(new Error("invalid_response"));break}}},this.handlers.add(d),l.port1.addEventListener("message",d.onMessage),this.target.postMessage({eventType:e,eventId:y,data:t},[l.port2])}).finally(()=>{d&&this.removeMessageHandler(d)})}}function Ha(){return window}function u4(n){Ha().location.href=n}function $w(){return typeof Ha().WorkerGlobalScope<"u"&&typeof Ha().importScripts=="function"}async function d4(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function h4(){return navigator?.serviceWorker?.controller||null}function m4(){return $w()?self:null}const Ww="firebaseLocalStorageDb",f4=1,zh="firebaseLocalStorage",Gw="fbase_key";class qu{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function om(n,e){return n.transaction([zh],e?"readwrite":"readonly").objectStore(zh)}function p4(){const n=indexedDB.deleteDatabase(Ww);return new qu(n).toPromise()}function yg(){const n=indexedDB.open(Ww,f4);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const i=n.result;try{i.createObjectStore(zh,{keyPath:Gw})}catch(l){t(l)}}),n.addEventListener("success",async()=>{const i=n.result;i.objectStoreNames.contains(zh)?e(i):(i.close(),await p4(),e(await yg()))})})}async function cx(n,e,t){const i=om(n,!0).put({[Gw]:e,value:t});return new qu(i).toPromise()}async function g4(n,e){const t=om(n,!1).get(e),i=await new qu(t).toPromise();return i===void 0?null:i.value}function ux(n,e){const t=om(n,!0).delete(e);return new qu(t).toPromise()}const y4=800,b4=3;class Kw{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await yg(),this.db)}async _withRetries(e){let t=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(i){if(t++>b4)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return $w()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=im._getInstance(m4()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await d4(),!this.activeServiceWorker)return;this.sender=new c4(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||h4()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await yg();return await cx(e,Fh,"1"),await ux(e,Fh),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(i=>cx(i,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(i=>g4(i,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>ux(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(l=>{const u=om(l,!1).getAll();return new qu(u).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],i=new Set;if(e.length!==0)for(const{fbase_key:l,value:u}of e)i.add(l),JSON.stringify(this.localCache[l])!==JSON.stringify(u)&&(this.notifyListeners(l,u),t.push(l));for(const l of Object.keys(this.localCache))this.localCache[l]&&!i.has(l)&&(this.notifyListeners(l,null),t.push(l));return t}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const l of Array.from(i))l(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),y4)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}Kw.type="LOCAL";const v4=Kw;new Uu(3e4,6e4);function x4(n,e){return e?gi(e):(Qt(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}class iy extends sy{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Jl(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Jl(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Jl(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function w4(n){return Uw(n.auth,new iy(n),n.bypassAuthState)}function _4(n){const{auth:e,user:t}=n;return Qt(t,e,"internal-error"),XC(t,new iy(n),n.bypassAuthState)}async function k4(n){const{auth:e,user:t}=n;return Qt(t,e,"internal-error"),QC(t,new iy(n),n.bypassAuthState)}class Yw{constructor(e,t,i,l,u=!1){this.auth=e,this.resolver=i,this.user=l,this.bypassAuthState=u,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:i,postBody:l,tenantId:u,error:d,type:p}=e;if(d){this.reject(d);return}const g={auth:this.auth,requestUri:t,sessionId:i,tenantId:u||void 0,postBody:l||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(p)(g))}catch(y){this.reject(y)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return w4;case"linkViaPopup":case"linkViaRedirect":return k4;case"reauthViaPopup":case"reauthViaRedirect":return _4;default:ka(this.auth,"internal-error")}}resolve(e){ji(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){ji(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const j4=new Uu(2e3,1e4);class Yl extends Yw{constructor(e,t,i,l,u){super(e,t,l,u),this.provider=i,this.authWindow=null,this.pollId=null,Yl.currentPopupAction&&Yl.currentPopupAction.cancel(),Yl.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Qt(e,this.auth,"internal-error"),e}async onExecution(){ji(this.filter.length===1,"Popup operations only handle one event");const e=ay();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(qa(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(qa(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Yl.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(qa(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,j4.get())};e()}}Yl.currentPopupAction=null;const T4="pendingRedirect",jh=new Map;class S4 extends Yw{constructor(e,t,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,i),this.eventId=null}async execute(){let e=jh.get(this.auth._key());if(!e){try{const i=await E4(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(t){e=()=>Promise.reject(t)}jh.set(this.auth._key(),e)}return this.bypassAuthState||jh.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function E4(n,e){const t=R4(e),i=C4(n);if(!await i._isAvailable())return!1;const l=await i._get(t)==="true";return await i._remove(t),l}function N4(n,e){jh.set(n._key(),e)}function C4(n){return gi(n._redirectPersistence)}function R4(n){return kh(T4,n.config.apiKey,n.name)}async function A4(n,e,t=!1){if($r(n.app))return Promise.reject(xi(n));const i=ko(n),l=x4(i,e),d=await new S4(i,l,t).execute();return d&&!t&&(delete d.user._redirectEventId,await i._persistUserIfCurrent(d.user),await i._setRedirectUser(null,e)),d}const M4=600*1e3;class I4{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(t=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!D4(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!Qw(e)){const i=e.error.code?.split("auth/")[1]||"internal-error";t.onError(qa(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const i=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=M4&&this.cachedEventUids.clear(),this.cachedEventUids.has(dx(e))}saveEventToCache(e){this.cachedEventUids.add(dx(e)),this.lastProcessedEventTime=Date.now()}}function dx(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function Qw({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function D4(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Qw(n);default:return!1}}async function P4(n,e={}){return Ni(n,"GET","/v1/projects",e)}const L4=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,O4=/^https?/;async function B4(n){if(n.config.emulator)return;const{authorizedDomains:e}=await P4(n);for(const t of e)try{if(V4(t))return}catch{}ka(n,"unauthorized-domain")}function V4(n){const e=fg(),{protocol:t,hostname:i}=new URL(e);if(n.startsWith("chrome-extension://")){const d=new URL(n);return d.hostname===""&&i===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&d.hostname===i}if(!O4.test(t))return!1;if(L4.test(n))return i===n;const l=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+l+"|"+l+")$","i").test(i)}const U4=new Uu(3e4,6e4);function hx(){const n=Ha().___jsl;if(n?.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function F4(n){return new Promise((e,t)=>{function i(){hx(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{hx(),t(qa(n,"network-request-failed"))},timeout:U4.get()})}if(Ha().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(Ha().gapi?.load)i();else{const l=RC("iframefcb");return Ha()[l]=()=>{gapi.load?i():t(qa(n,"network-request-failed"))},Dw(`${CC()}?onload=${l}`).catch(u=>t(u))}}).catch(e=>{throw Th=null,e})}let Th=null;function z4(n){return Th=Th||F4(n),Th}const q4=new Uu(5e3,15e3),H4="__/auth/iframe",$4="emulator/auth/iframe",W4={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},G4=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function K4(n){const e=n.config;Qt(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?Zg(e,$4):`https://${n.config.authDomain}/${H4}`,i={apiKey:e.apiKey,appName:n.name,v:ol},l=G4.get(n.config.apiHost);l&&(i.eid=l);const u=n._getFrameworks();return u.length&&(i.fw=u.join(",")),`${t}?${Vu(i).slice(1)}`}async function Y4(n){const e=await z4(n),t=Ha().gapi;return Qt(t,n,"internal-error"),e.open({where:document.body,url:K4(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:W4,dontclear:!0},i=>new Promise(async(l,u)=>{await i.restyle({setHideOnLeave:!1});const d=qa(n,"network-request-failed"),p=Ha().setTimeout(()=>{u(d)},q4.get());function g(){Ha().clearTimeout(p),l(i)}i.ping(g).then(g,()=>{u(d)})}))}const Q4={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},X4=500,J4=600,Z4="_blank",eR="http://localhost";class mx{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function tR(n,e,t,i=X4,l=J4){const u=Math.max((window.screen.availHeight-l)/2,0).toString(),d=Math.max((window.screen.availWidth-i)/2,0).toString();let p="";const g={...Q4,width:i.toString(),height:l.toString(),top:u,left:d},y=cr().toLowerCase();t&&(p=Ew(y)?Z4:t),Tw(y)&&(e=e||eR,g.scrollbars="yes");const x=Object.entries(g).reduce((j,[O,K])=>`${j}${O}=${K},`,"");if(xC(y)&&p!=="_self")return sR(e||"",p),new mx(null);const _=window.open(e||"",p,x);Qt(_,n,"popup-blocked");try{_.focus()}catch{}return new mx(_)}function sR(n,e){const t=document.createElement("a");t.href=n,t.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(i)}const nR="__/auth/handler",rR="emulator/auth/handler",aR=encodeURIComponent("fac");async function fx(n,e,t,i,l,u){Qt(n.config.authDomain,n,"auth-domain-config-required"),Qt(n.config.apiKey,n,"invalid-api-key");const d={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:i,v:ol,eventId:l};if(e instanceof Bw){e.setDefaultLanguage(n.languageCode),d.providerId=e.providerId||"",zE(e.getCustomParameters())||(d.customParameters=JSON.stringify(e.getCustomParameters()));for(const[x,_]of Object.entries({}))d[x]=_}if(e instanceof zu){const x=e.getScopes().filter(_=>_!=="");x.length>0&&(d.scopes=x.join(","))}n.tenantId&&(d.tid=n.tenantId);const p=d;for(const x of Object.keys(p))p[x]===void 0&&delete p[x];const g=await n._getAppCheckToken(),y=g?`#${aR}=${encodeURIComponent(g)}`:"";return`${iR(n)}?${Vu(p).slice(1)}${y}`}function iR({config:n}){return n.emulator?Zg(n,rR):`https://${n.authDomain}/${nR}`}const Op="webStorageSupport";class oR{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=ry,this._completeRedirectFn=A4,this._overrideRedirectResult=N4}async _openPopup(e,t,i,l){ji(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const u=await fx(e,t,i,fg(),l);return tR(e,u,ay())}async _openRedirect(e,t,i,l){await this._originValidation(e);const u=await fx(e,t,i,fg(),l);return u4(u),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:l,promise:u}=this.eventManagers[t];return l?Promise.resolve(l):(ji(u,"If manager is not set, promise should be"),u)}const i=this.initAndGetManager(e);return this.eventManagers[t]={promise:i},i.catch(()=>{delete this.eventManagers[t]}),i}async initAndGetManager(e){const t=await Y4(e),i=new I4(e);return t.register("authEvent",l=>(Qt(l?.authEvent,e,"invalid-auth-event"),{status:i.onEvent(l.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=t,i}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Op,{type:Op},l=>{const u=l?.[0]?.[Op];u!==void 0&&t(!!u),ka(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=B4(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return Mw()||Sw()||ty()}}const lR=oR;var px="@firebase/auth",gx="1.12.0";class cR{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(i=>{e(i?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Qt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function uR(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function dR(n){el(new po("auth",(e,{options:t})=>{const i=e.getProvider("app").getImmediate(),l=e.getProvider("heartbeat"),u=e.getProvider("app-check-internal"),{apiKey:d,authDomain:p}=i.options;Qt(d&&!d.includes(":"),"invalid-api-key",{appName:i.name});const g={apiKey:d,authDomain:p,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Iw(n)},y=new SC(i,l,u,g);return LC(y,t),y},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,i)=>{e.getProvider("auth-internal").initialize()})),el(new po("auth-internal",e=>{const t=ko(e.getProvider("auth").getImmediate());return(i=>new cR(i))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),za(px,gx,uR(n)),za(px,gx,"esm2020")}const hR=300,mR=dw("authIdTokenMaxAge")||hR;let yx=null;const fR=n=>async e=>{const t=e&&await e.getIdTokenResult(),i=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(i&&i>mR)return;const l=t?.token;yx!==l&&(yx=l,await fetch(n,{method:l?"POST":"DELETE",headers:l?{Authorization:`Bearer ${l}`}:{}}))};function Xw(n=Xg()){const e=rm(n,"auth");if(e.isInitialized())return e.getImmediate();const t=PC(n,{popupRedirectResolver:lR,persistence:[v4,gg,ry]}),i=dw("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const u=new URL(i,location.origin);if(location.origin===u.origin){const d=fR(u.toString());n4(t,d,()=>d(t.currentUser)),s4(t,p=>d(p))}}const l=lw("auth");return l&&OC(t,`http://${l}`),t}function pR(){return document.getElementsByTagName("head")?.[0]??document}EC({loadJS(n){return new Promise((e,t)=>{const i=document.createElement("script");i.setAttribute("src",n),i.onload=e,i.onerror=l=>{const u=qa("internal-error");u.customData=l,t(u)},i.type="text/javascript",i.charset="UTF-8",pR().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});dR("Browser");var bx=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var ho,Jw;(function(){var n;function e(C,T){function M(){}M.prototype=T.prototype,C.F=T.prototype,C.prototype=new M,C.prototype.constructor=C,C.D=function(V,I,L){for(var A=Array(arguments.length-2),Le=2;Le<arguments.length;Le++)A[Le-2]=arguments[Le];return T.prototype[I].apply(V,A)}}function t(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(i,t),i.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function l(C,T,M){M||(M=0);const V=Array(16);if(typeof T=="string")for(var I=0;I<16;++I)V[I]=T.charCodeAt(M++)|T.charCodeAt(M++)<<8|T.charCodeAt(M++)<<16|T.charCodeAt(M++)<<24;else for(I=0;I<16;++I)V[I]=T[M++]|T[M++]<<8|T[M++]<<16|T[M++]<<24;T=C.g[0],M=C.g[1],I=C.g[2];let L=C.g[3],A;A=T+(L^M&(I^L))+V[0]+3614090360&4294967295,T=M+(A<<7&4294967295|A>>>25),A=L+(I^T&(M^I))+V[1]+3905402710&4294967295,L=T+(A<<12&4294967295|A>>>20),A=I+(M^L&(T^M))+V[2]+606105819&4294967295,I=L+(A<<17&4294967295|A>>>15),A=M+(T^I&(L^T))+V[3]+3250441966&4294967295,M=I+(A<<22&4294967295|A>>>10),A=T+(L^M&(I^L))+V[4]+4118548399&4294967295,T=M+(A<<7&4294967295|A>>>25),A=L+(I^T&(M^I))+V[5]+1200080426&4294967295,L=T+(A<<12&4294967295|A>>>20),A=I+(M^L&(T^M))+V[6]+2821735955&4294967295,I=L+(A<<17&4294967295|A>>>15),A=M+(T^I&(L^T))+V[7]+4249261313&4294967295,M=I+(A<<22&4294967295|A>>>10),A=T+(L^M&(I^L))+V[8]+1770035416&4294967295,T=M+(A<<7&4294967295|A>>>25),A=L+(I^T&(M^I))+V[9]+2336552879&4294967295,L=T+(A<<12&4294967295|A>>>20),A=I+(M^L&(T^M))+V[10]+4294925233&4294967295,I=L+(A<<17&4294967295|A>>>15),A=M+(T^I&(L^T))+V[11]+2304563134&4294967295,M=I+(A<<22&4294967295|A>>>10),A=T+(L^M&(I^L))+V[12]+1804603682&4294967295,T=M+(A<<7&4294967295|A>>>25),A=L+(I^T&(M^I))+V[13]+4254626195&4294967295,L=T+(A<<12&4294967295|A>>>20),A=I+(M^L&(T^M))+V[14]+2792965006&4294967295,I=L+(A<<17&4294967295|A>>>15),A=M+(T^I&(L^T))+V[15]+1236535329&4294967295,M=I+(A<<22&4294967295|A>>>10),A=T+(I^L&(M^I))+V[1]+4129170786&4294967295,T=M+(A<<5&4294967295|A>>>27),A=L+(M^I&(T^M))+V[6]+3225465664&4294967295,L=T+(A<<9&4294967295|A>>>23),A=I+(T^M&(L^T))+V[11]+643717713&4294967295,I=L+(A<<14&4294967295|A>>>18),A=M+(L^T&(I^L))+V[0]+3921069994&4294967295,M=I+(A<<20&4294967295|A>>>12),A=T+(I^L&(M^I))+V[5]+3593408605&4294967295,T=M+(A<<5&4294967295|A>>>27),A=L+(M^I&(T^M))+V[10]+38016083&4294967295,L=T+(A<<9&4294967295|A>>>23),A=I+(T^M&(L^T))+V[15]+3634488961&4294967295,I=L+(A<<14&4294967295|A>>>18),A=M+(L^T&(I^L))+V[4]+3889429448&4294967295,M=I+(A<<20&4294967295|A>>>12),A=T+(I^L&(M^I))+V[9]+568446438&4294967295,T=M+(A<<5&4294967295|A>>>27),A=L+(M^I&(T^M))+V[14]+3275163606&4294967295,L=T+(A<<9&4294967295|A>>>23),A=I+(T^M&(L^T))+V[3]+4107603335&4294967295,I=L+(A<<14&4294967295|A>>>18),A=M+(L^T&(I^L))+V[8]+1163531501&4294967295,M=I+(A<<20&4294967295|A>>>12),A=T+(I^L&(M^I))+V[13]+2850285829&4294967295,T=M+(A<<5&4294967295|A>>>27),A=L+(M^I&(T^M))+V[2]+4243563512&4294967295,L=T+(A<<9&4294967295|A>>>23),A=I+(T^M&(L^T))+V[7]+1735328473&4294967295,I=L+(A<<14&4294967295|A>>>18),A=M+(L^T&(I^L))+V[12]+2368359562&4294967295,M=I+(A<<20&4294967295|A>>>12),A=T+(M^I^L)+V[5]+4294588738&4294967295,T=M+(A<<4&4294967295|A>>>28),A=L+(T^M^I)+V[8]+2272392833&4294967295,L=T+(A<<11&4294967295|A>>>21),A=I+(L^T^M)+V[11]+1839030562&4294967295,I=L+(A<<16&4294967295|A>>>16),A=M+(I^L^T)+V[14]+4259657740&4294967295,M=I+(A<<23&4294967295|A>>>9),A=T+(M^I^L)+V[1]+2763975236&4294967295,T=M+(A<<4&4294967295|A>>>28),A=L+(T^M^I)+V[4]+1272893353&4294967295,L=T+(A<<11&4294967295|A>>>21),A=I+(L^T^M)+V[7]+4139469664&4294967295,I=L+(A<<16&4294967295|A>>>16),A=M+(I^L^T)+V[10]+3200236656&4294967295,M=I+(A<<23&4294967295|A>>>9),A=T+(M^I^L)+V[13]+681279174&4294967295,T=M+(A<<4&4294967295|A>>>28),A=L+(T^M^I)+V[0]+3936430074&4294967295,L=T+(A<<11&4294967295|A>>>21),A=I+(L^T^M)+V[3]+3572445317&4294967295,I=L+(A<<16&4294967295|A>>>16),A=M+(I^L^T)+V[6]+76029189&4294967295,M=I+(A<<23&4294967295|A>>>9),A=T+(M^I^L)+V[9]+3654602809&4294967295,T=M+(A<<4&4294967295|A>>>28),A=L+(T^M^I)+V[12]+3873151461&4294967295,L=T+(A<<11&4294967295|A>>>21),A=I+(L^T^M)+V[15]+530742520&4294967295,I=L+(A<<16&4294967295|A>>>16),A=M+(I^L^T)+V[2]+3299628645&4294967295,M=I+(A<<23&4294967295|A>>>9),A=T+(I^(M|~L))+V[0]+4096336452&4294967295,T=M+(A<<6&4294967295|A>>>26),A=L+(M^(T|~I))+V[7]+1126891415&4294967295,L=T+(A<<10&4294967295|A>>>22),A=I+(T^(L|~M))+V[14]+2878612391&4294967295,I=L+(A<<15&4294967295|A>>>17),A=M+(L^(I|~T))+V[5]+4237533241&4294967295,M=I+(A<<21&4294967295|A>>>11),A=T+(I^(M|~L))+V[12]+1700485571&4294967295,T=M+(A<<6&4294967295|A>>>26),A=L+(M^(T|~I))+V[3]+2399980690&4294967295,L=T+(A<<10&4294967295|A>>>22),A=I+(T^(L|~M))+V[10]+4293915773&4294967295,I=L+(A<<15&4294967295|A>>>17),A=M+(L^(I|~T))+V[1]+2240044497&4294967295,M=I+(A<<21&4294967295|A>>>11),A=T+(I^(M|~L))+V[8]+1873313359&4294967295,T=M+(A<<6&4294967295|A>>>26),A=L+(M^(T|~I))+V[15]+4264355552&4294967295,L=T+(A<<10&4294967295|A>>>22),A=I+(T^(L|~M))+V[6]+2734768916&4294967295,I=L+(A<<15&4294967295|A>>>17),A=M+(L^(I|~T))+V[13]+1309151649&4294967295,M=I+(A<<21&4294967295|A>>>11),A=T+(I^(M|~L))+V[4]+4149444226&4294967295,T=M+(A<<6&4294967295|A>>>26),A=L+(M^(T|~I))+V[11]+3174756917&4294967295,L=T+(A<<10&4294967295|A>>>22),A=I+(T^(L|~M))+V[2]+718787259&4294967295,I=L+(A<<15&4294967295|A>>>17),A=M+(L^(I|~T))+V[9]+3951481745&4294967295,C.g[0]=C.g[0]+T&4294967295,C.g[1]=C.g[1]+(I+(A<<21&4294967295|A>>>11))&4294967295,C.g[2]=C.g[2]+I&4294967295,C.g[3]=C.g[3]+L&4294967295}i.prototype.v=function(C,T){T===void 0&&(T=C.length);const M=T-this.blockSize,V=this.C;let I=this.h,L=0;for(;L<T;){if(I==0)for(;L<=M;)l(this,C,L),L+=this.blockSize;if(typeof C=="string"){for(;L<T;)if(V[I++]=C.charCodeAt(L++),I==this.blockSize){l(this,V),I=0;break}}else for(;L<T;)if(V[I++]=C[L++],I==this.blockSize){l(this,V),I=0;break}}this.h=I,this.o+=T},i.prototype.A=function(){var C=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);C[0]=128;for(var T=1;T<C.length-8;++T)C[T]=0;T=this.o*8;for(var M=C.length-8;M<C.length;++M)C[M]=T&255,T/=256;for(this.v(C),C=Array(16),T=0,M=0;M<4;++M)for(let V=0;V<32;V+=8)C[T++]=this.g[M]>>>V&255;return C};function u(C,T){var M=p;return Object.prototype.hasOwnProperty.call(M,C)?M[C]:M[C]=T(C)}function d(C,T){this.h=T;const M=[];let V=!0;for(let I=C.length-1;I>=0;I--){const L=C[I]|0;V&&L==T||(M[I]=L,V=!1)}this.g=M}var p={};function g(C){return-128<=C&&C<128?u(C,function(T){return new d([T|0],T<0?-1:0)}):new d([C|0],C<0?-1:0)}function y(C){if(isNaN(C)||!isFinite(C))return _;if(C<0)return D(y(-C));const T=[];let M=1;for(let V=0;C>=M;V++)T[V]=C/M|0,M*=4294967296;return new d(T,0)}function x(C,T){if(C.length==0)throw Error("number format error: empty string");if(T=T||10,T<2||36<T)throw Error("radix out of range: "+T);if(C.charAt(0)=="-")return D(x(C.substring(1),T));if(C.indexOf("-")>=0)throw Error('number format error: interior "-" character');const M=y(Math.pow(T,8));let V=_;for(let L=0;L<C.length;L+=8){var I=Math.min(8,C.length-L);const A=parseInt(C.substring(L,L+I),T);I<8?(I=y(Math.pow(T,I)),V=V.j(I).add(y(A))):(V=V.j(M),V=V.add(y(A)))}return V}var _=g(0),j=g(1),O=g(16777216);n=d.prototype,n.m=function(){if(B(this))return-D(this).m();let C=0,T=1;for(let M=0;M<this.g.length;M++){const V=this.i(M);C+=(V>=0?V:4294967296+V)*T,T*=4294967296}return C},n.toString=function(C){if(C=C||10,C<2||36<C)throw Error("radix out of range: "+C);if(K(this))return"0";if(B(this))return"-"+D(this).toString(C);const T=y(Math.pow(C,6));var M=this;let V="";for(;;){const I=ke(M,T).g;M=te(M,I.j(T));let L=((M.g.length>0?M.g[0]:M.h)>>>0).toString(C);if(M=I,K(M))return L+V;for(;L.length<6;)L="0"+L;V=L+V}},n.i=function(C){return C<0?0:C<this.g.length?this.g[C]:this.h};function K(C){if(C.h!=0)return!1;for(let T=0;T<C.g.length;T++)if(C.g[T]!=0)return!1;return!0}function B(C){return C.h==-1}n.l=function(C){return C=te(this,C),B(C)?-1:K(C)?0:1};function D(C){const T=C.g.length,M=[];for(let V=0;V<T;V++)M[V]=~C.g[V];return new d(M,~C.h).add(j)}n.abs=function(){return B(this)?D(this):this},n.add=function(C){const T=Math.max(this.g.length,C.g.length),M=[];let V=0;for(let I=0;I<=T;I++){let L=V+(this.i(I)&65535)+(C.i(I)&65535),A=(L>>>16)+(this.i(I)>>>16)+(C.i(I)>>>16);V=A>>>16,L&=65535,A&=65535,M[I]=A<<16|L}return new d(M,M[M.length-1]&-2147483648?-1:0)};function te(C,T){return C.add(D(T))}n.j=function(C){if(K(this)||K(C))return _;if(B(this))return B(C)?D(this).j(D(C)):D(D(this).j(C));if(B(C))return D(this.j(D(C)));if(this.l(O)<0&&C.l(O)<0)return y(this.m()*C.m());const T=this.g.length+C.g.length,M=[];for(var V=0;V<2*T;V++)M[V]=0;for(V=0;V<this.g.length;V++)for(let I=0;I<C.g.length;I++){const L=this.i(V)>>>16,A=this.i(V)&65535,Le=C.i(I)>>>16,ht=C.i(I)&65535;M[2*V+2*I]+=A*ht,Y(M,2*V+2*I),M[2*V+2*I+1]+=L*ht,Y(M,2*V+2*I+1),M[2*V+2*I+1]+=A*Le,Y(M,2*V+2*I+1),M[2*V+2*I+2]+=L*Le,Y(M,2*V+2*I+2)}for(C=0;C<T;C++)M[C]=M[2*C+1]<<16|M[2*C];for(C=T;C<2*T;C++)M[C]=0;return new d(M,0)};function Y(C,T){for(;(C[T]&65535)!=C[T];)C[T+1]+=C[T]>>>16,C[T]&=65535,T++}function Z(C,T){this.g=C,this.h=T}function ke(C,T){if(K(T))throw Error("division by zero");if(K(C))return new Z(_,_);if(B(C))return T=ke(D(C),T),new Z(D(T.g),D(T.h));if(B(T))return T=ke(C,D(T)),new Z(D(T.g),T.h);if(C.g.length>30){if(B(C)||B(T))throw Error("slowDivide_ only works with positive integers.");for(var M=j,V=T;V.l(C)<=0;)M=Re(M),V=Re(V);var I=_e(M,1),L=_e(V,1);for(V=_e(V,2),M=_e(M,2);!K(V);){var A=L.add(V);A.l(C)<=0&&(I=I.add(M),L=A),V=_e(V,1),M=_e(M,1)}return T=te(C,I.j(T)),new Z(I,T)}for(I=_;C.l(T)>=0;){for(M=Math.max(1,Math.floor(C.m()/T.m())),V=Math.ceil(Math.log(M)/Math.LN2),V=V<=48?1:Math.pow(2,V-48),L=y(M),A=L.j(T);B(A)||A.l(C)>0;)M-=V,L=y(M),A=L.j(T);K(L)&&(L=j),I=I.add(L),C=te(C,A)}return new Z(I,C)}n.B=function(C){return ke(this,C).h},n.and=function(C){const T=Math.max(this.g.length,C.g.length),M=[];for(let V=0;V<T;V++)M[V]=this.i(V)&C.i(V);return new d(M,this.h&C.h)},n.or=function(C){const T=Math.max(this.g.length,C.g.length),M=[];for(let V=0;V<T;V++)M[V]=this.i(V)|C.i(V);return new d(M,this.h|C.h)},n.xor=function(C){const T=Math.max(this.g.length,C.g.length),M=[];for(let V=0;V<T;V++)M[V]=this.i(V)^C.i(V);return new d(M,this.h^C.h)};function Re(C){const T=C.g.length+1,M=[];for(let V=0;V<T;V++)M[V]=C.i(V)<<1|C.i(V-1)>>>31;return new d(M,C.h)}function _e(C,T){const M=T>>5;T%=32;const V=C.g.length-M,I=[];for(let L=0;L<V;L++)I[L]=T>0?C.i(L+M)>>>T|C.i(L+M+1)<<32-T:C.i(L+M);return new d(I,C.h)}i.prototype.digest=i.prototype.A,i.prototype.reset=i.prototype.u,i.prototype.update=i.prototype.v,Jw=i,d.prototype.add=d.prototype.add,d.prototype.multiply=d.prototype.j,d.prototype.modulo=d.prototype.B,d.prototype.compare=d.prototype.l,d.prototype.toNumber=d.prototype.m,d.prototype.toString=d.prototype.toString,d.prototype.getBits=d.prototype.i,d.fromNumber=y,d.fromString=x,ho=d}).apply(typeof bx<"u"?bx:typeof self<"u"?self:typeof window<"u"?window:{});var ih=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var Zw,du,e_,Sh,bg,t_,s_,n_;(function(){var n,e=Object.defineProperty;function t(h){h=[typeof globalThis=="object"&&globalThis,h,typeof window=="object"&&window,typeof self=="object"&&self,typeof ih=="object"&&ih];for(var v=0;v<h.length;++v){var k=h[v];if(k&&k.Math==Math)return k}throw Error("Cannot find global object")}var i=t(this);function l(h,v){if(v)e:{var k=i;h=h.split(".");for(var R=0;R<h.length-1;R++){var le=h[R];if(!(le in k))break e;k=k[le]}h=h[h.length-1],R=k[h],v=v(R),v!=R&&v!=null&&e(k,h,{configurable:!0,writable:!0,value:v})}}l("Symbol.dispose",function(h){return h||Symbol("Symbol.dispose")}),l("Array.prototype.values",function(h){return h||function(){return this[Symbol.iterator]()}}),l("Object.entries",function(h){return h||function(v){var k=[],R;for(R in v)Object.prototype.hasOwnProperty.call(v,R)&&k.push([R,v[R]]);return k}});var u=u||{},d=this||self;function p(h){var v=typeof h;return v=="object"&&h!=null||v=="function"}function g(h,v,k){return h.call.apply(h.bind,arguments)}function y(h,v,k){return y=g,y.apply(null,arguments)}function x(h,v){var k=Array.prototype.slice.call(arguments,1);return function(){var R=k.slice();return R.push.apply(R,arguments),h.apply(this,R)}}function _(h,v){function k(){}k.prototype=v.prototype,h.Z=v.prototype,h.prototype=new k,h.prototype.constructor=h,h.Ob=function(R,le,ve){for(var dt=Array(arguments.length-2),ls=2;ls<arguments.length;ls++)dt[ls-2]=arguments[ls];return v.prototype[le].apply(R,dt)}}var j=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?h=>h&&AsyncContext.Snapshot.wrap(h):h=>h;function O(h){const v=h.length;if(v>0){const k=Array(v);for(let R=0;R<v;R++)k[R]=h[R];return k}return[]}function K(h,v){for(let R=1;R<arguments.length;R++){const le=arguments[R];var k=typeof le;if(k=k!="object"?k:le?Array.isArray(le)?"array":k:"null",k=="array"||k=="object"&&typeof le.length=="number"){k=h.length||0;const ve=le.length||0;h.length=k+ve;for(let dt=0;dt<ve;dt++)h[k+dt]=le[dt]}else h.push(le)}}class B{constructor(v,k){this.i=v,this.j=k,this.h=0,this.g=null}get(){let v;return this.h>0?(this.h--,v=this.g,this.g=v.next,v.next=null):v=this.i(),v}}function D(h){d.setTimeout(()=>{throw h},0)}function te(){var h=C;let v=null;return h.g&&(v=h.g,h.g=h.g.next,h.g||(h.h=null),v.next=null),v}class Y{constructor(){this.h=this.g=null}add(v,k){const R=Z.get();R.set(v,k),this.h?this.h.next=R:this.g=R,this.h=R}}var Z=new B(()=>new ke,h=>h.reset());class ke{constructor(){this.next=this.g=this.h=null}set(v,k){this.h=v,this.g=k,this.next=null}reset(){this.next=this.g=this.h=null}}let Re,_e=!1,C=new Y,T=()=>{const h=Promise.resolve(void 0);Re=()=>{h.then(M)}};function M(){for(var h;h=te();){try{h.h.call(h.g)}catch(k){D(k)}var v=Z;v.j(h),v.h<100&&(v.h++,h.next=v.g,v.g=h)}_e=!1}function V(){this.u=this.u,this.C=this.C}V.prototype.u=!1,V.prototype.dispose=function(){this.u||(this.u=!0,this.N())},V.prototype[Symbol.dispose]=function(){this.dispose()},V.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function I(h,v){this.type=h,this.g=this.target=v,this.defaultPrevented=!1}I.prototype.h=function(){this.defaultPrevented=!0};var L=(function(){if(!d.addEventListener||!Object.defineProperty)return!1;var h=!1,v=Object.defineProperty({},"passive",{get:function(){h=!0}});try{const k=()=>{};d.addEventListener("test",k,v),d.removeEventListener("test",k,v)}catch{}return h})();function A(h){return/^[\s\xa0]*$/.test(h)}function Le(h,v){I.call(this,h?h.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,h&&this.init(h,v)}_(Le,I),Le.prototype.init=function(h,v){const k=this.type=h.type,R=h.changedTouches&&h.changedTouches.length?h.changedTouches[0]:null;this.target=h.target||h.srcElement,this.g=v,v=h.relatedTarget,v||(k=="mouseover"?v=h.fromElement:k=="mouseout"&&(v=h.toElement)),this.relatedTarget=v,R?(this.clientX=R.clientX!==void 0?R.clientX:R.pageX,this.clientY=R.clientY!==void 0?R.clientY:R.pageY,this.screenX=R.screenX||0,this.screenY=R.screenY||0):(this.clientX=h.clientX!==void 0?h.clientX:h.pageX,this.clientY=h.clientY!==void 0?h.clientY:h.pageY,this.screenX=h.screenX||0,this.screenY=h.screenY||0),this.button=h.button,this.key=h.key||"",this.ctrlKey=h.ctrlKey,this.altKey=h.altKey,this.shiftKey=h.shiftKey,this.metaKey=h.metaKey,this.pointerId=h.pointerId||0,this.pointerType=h.pointerType,this.state=h.state,this.i=h,h.defaultPrevented&&Le.Z.h.call(this)},Le.prototype.h=function(){Le.Z.h.call(this);const h=this.i;h.preventDefault?h.preventDefault():h.returnValue=!1};var ht="closure_listenable_"+(Math.random()*1e6|0),$=0;function pe(h,v,k,R,le){this.listener=h,this.proxy=null,this.src=v,this.type=k,this.capture=!!R,this.ha=le,this.key=++$,this.da=this.fa=!1}function Be(h){h.da=!0,h.listener=null,h.proxy=null,h.src=null,h.ha=null}function We(h,v,k){for(const R in h)v.call(k,h[R],R,h)}function J(h,v){for(const k in h)v.call(void 0,h[k],k,h)}function P(h){const v={};for(const k in h)v[k]=h[k];return v}const re="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Fe(h,v){let k,R;for(let le=1;le<arguments.length;le++){R=arguments[le];for(k in R)h[k]=R[k];for(let ve=0;ve<re.length;ve++)k=re[ve],Object.prototype.hasOwnProperty.call(R,k)&&(h[k]=R[k])}}function qe(h){this.src=h,this.g={},this.h=0}qe.prototype.add=function(h,v,k,R,le){const ve=h.toString();h=this.g[ve],h||(h=this.g[ve]=[],this.h++);const dt=Me(h,v,R,le);return dt>-1?(v=h[dt],k||(v.fa=!1)):(v=new pe(v,this.src,ve,!!R,le),v.fa=k,h.push(v)),v};function Ve(h,v){const k=v.type;if(k in h.g){var R=h.g[k],le=Array.prototype.indexOf.call(R,v,void 0),ve;(ve=le>=0)&&Array.prototype.splice.call(R,le,1),ve&&(Be(v),h.g[k].length==0&&(delete h.g[k],h.h--))}}function Me(h,v,k,R){for(let le=0;le<h.length;++le){const ve=h[le];if(!ve.da&&ve.listener==v&&ve.capture==!!k&&ve.ha==R)return le}return-1}var mt="closure_lm_"+(Math.random()*1e6|0),wt={};function ot(h,v,k,R,le){if(Array.isArray(v)){for(let ve=0;ve<v.length;ve++)ot(h,v[ve],k,R,le);return null}return k=Et(k),h&&h[ht]?h.J(v,k,p(R)?!!R.capture:!1,le):es(h,v,k,!1,R,le)}function es(h,v,k,R,le,ve){if(!v)throw Error("Invalid event type");const dt=p(le)?!!le.capture:!!le;let ls=Nt(h);if(ls||(h[mt]=ls=new qe(h)),k=ls.add(v,k,R,dt,ve),k.proxy)return k;if(R=Ns(),k.proxy=R,R.src=h,R.listener=k,h.addEventListener)L||(le=dt),le===void 0&&(le=!1),h.addEventListener(v.toString(),R,le);else if(h.attachEvent)h.attachEvent(oe(v.toString()),R);else if(h.addListener&&h.removeListener)h.addListener(R);else throw Error("addEventListener and attachEvent are unavailable.");return k}function Ns(){function h(k){return v.call(h.src,h.listener,k)}const v=Dt;return h}function Ft(h,v,k,R,le){if(Array.isArray(v))for(var ve=0;ve<v.length;ve++)Ft(h,v[ve],k,R,le);else R=p(R)?!!R.capture:!!R,k=Et(k),h&&h[ht]?(h=h.i,ve=String(v).toString(),ve in h.g&&(v=h.g[ve],k=Me(v,k,R,le),k>-1&&(Be(v[k]),Array.prototype.splice.call(v,k,1),v.length==0&&(delete h.g[ve],h.h--)))):h&&(h=Nt(h))&&(v=h.g[v.toString()],h=-1,v&&(h=Me(v,k,R,le)),(k=h>-1?v[h]:null)&&Tt(k))}function Tt(h){if(typeof h!="number"&&h&&!h.da){var v=h.src;if(v&&v[ht])Ve(v.i,h);else{var k=h.type,R=h.proxy;v.removeEventListener?v.removeEventListener(k,R,h.capture):v.detachEvent?v.detachEvent(oe(k),R):v.addListener&&v.removeListener&&v.removeListener(R),(k=Nt(v))?(Ve(k,h),k.h==0&&(k.src=null,v[mt]=null)):Be(h)}}}function oe(h){return h in wt?wt[h]:wt[h]="on"+h}function Dt(h,v){if(h.da)h=!0;else{v=new Le(v,this);const k=h.listener,R=h.ha||h.src;h.fa&&Tt(h),h=k.call(R,v)}return h}function Nt(h){return h=h[mt],h instanceof qe?h:null}var Kt="__closure_events_fn_"+(Math.random()*1e9>>>0);function Et(h){return typeof h=="function"?h:(h[Kt]||(h[Kt]=function(v){return h.handleEvent(v)}),h[Kt])}function Ct(){V.call(this),this.i=new qe(this),this.M=this,this.G=null}_(Ct,V),Ct.prototype[ht]=!0,Ct.prototype.removeEventListener=function(h,v,k,R){Ft(this,h,v,k,R)};function lt(h,v){var k,R=h.G;if(R)for(k=[];R;R=R.G)k.push(R);if(h=h.M,R=v.type||v,typeof v=="string")v=new I(v,h);else if(v instanceof I)v.target=v.target||h;else{var le=v;v=new I(R,h),Fe(v,le)}le=!0;let ve,dt;if(k)for(dt=k.length-1;dt>=0;dt--)ve=v.g=k[dt],le=Ot(ve,R,!0,v)&&le;if(ve=v.g=h,le=Ot(ve,R,!0,v)&&le,le=Ot(ve,R,!1,v)&&le,k)for(dt=0;dt<k.length;dt++)ve=v.g=k[dt],le=Ot(ve,R,!1,v)&&le}Ct.prototype.N=function(){if(Ct.Z.N.call(this),this.i){var h=this.i;for(const v in h.g){const k=h.g[v];for(let R=0;R<k.length;R++)Be(k[R]);delete h.g[v],h.h--}}this.G=null},Ct.prototype.J=function(h,v,k,R){return this.i.add(String(h),v,!1,k,R)},Ct.prototype.K=function(h,v,k,R){return this.i.add(String(h),v,!0,k,R)};function Ot(h,v,k,R){if(v=h.i.g[String(v)],!v)return!0;v=v.concat();let le=!0;for(let ve=0;ve<v.length;++ve){const dt=v[ve];if(dt&&!dt.da&&dt.capture==k){const ls=dt.listener,kn=dt.ha||dt.src;dt.fa&&Ve(h.i,dt),le=ls.call(kn,R)!==!1&&le}}return le&&!R.defaultPrevented}function Wt(h,v){if(typeof h!="function")if(h&&typeof h.handleEvent=="function")h=y(h.handleEvent,h);else throw Error("Invalid listener argument");return Number(v)>2147483647?-1:d.setTimeout(h,v||0)}function ms(h){h.g=Wt(()=>{h.g=null,h.i&&(h.i=!1,ms(h))},h.l);const v=h.h;h.h=null,h.m.apply(null,v)}class Gt extends V{constructor(v,k){super(),this.m=v,this.l=k,this.h=null,this.i=!1,this.g=null}j(v){this.h=arguments,this.g?this.i=!0:ms(this)}N(){super.N(),this.g&&(d.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Pt(h){V.call(this),this.h=h,this.g={}}_(Pt,V);var us=[];function xs(h){We(h.g,function(v,k){this.g.hasOwnProperty(k)&&Tt(v)},h),h.g={}}Pt.prototype.N=function(){Pt.Z.N.call(this),xs(this)},Pt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var is=d.JSON.stringify,Qs=d.JSON.parse,Ms=class{stringify(h){return d.JSON.stringify(h,void 0)}parse(h){return d.JSON.parse(h,void 0)}};function Fs(){}function os(){}var ws={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function be(){I.call(this,"d")}_(be,I);function Ie(){I.call(this,"c")}_(Ie,I);var De={},rt=null;function Ke(){return rt=rt||new Ct}De.Ia="serverreachability";function at(h){I.call(this,De.Ia,h)}_(at,I);function gt(h){const v=Ke();lt(v,new at(v))}De.STAT_EVENT="statevent";function X(h,v){I.call(this,De.STAT_EVENT,h),this.stat=v}_(X,I);function se(h){const v=Ke();lt(v,new X(v,h))}De.Ja="timingevent";function Qe(h,v){I.call(this,De.Ja,h),this.size=v}_(Qe,I);function _t(h,v){if(typeof h!="function")throw Error("Fn must not be null and must be a function");return d.setTimeout(function(){h()},v)}function et(){this.g=!0}et.prototype.ua=function(){this.g=!1};function kt(h,v,k,R,le,ve){h.info(function(){if(h.g)if(ve){var dt="",ls=ve.split("&");for(let Vs=0;Vs<ls.length;Vs++){var kn=ls[Vs].split("=");if(kn.length>1){const cn=kn[0];kn=kn[1];const Xr=cn.split("_");dt=Xr.length>=2&&Xr[1]=="type"?dt+(cn+"="+kn+"&"):dt+(cn+"=redacted&")}}}else dt=null;else dt=ve;return"XMLHTTP REQ ("+R+") [attempt "+le+"]: "+v+`
`+k+`
`+dt})}function Q(h,v,k,R,le,ve,dt){h.info(function(){return"XMLHTTP RESP ("+R+") [ attempt "+le+"]: "+v+`
`+k+`
`+ve+" "+dt})}function Ae(h,v,k,R){h.info(function(){return"XMLHTTP TEXT ("+v+"): "+yt(h,k)+(R?" "+R:"")})}function Je(h,v){h.info(function(){return"TIMEOUT: "+v})}et.prototype.info=function(){};function yt(h,v){if(!h.g)return v;if(!v)return null;try{const ve=JSON.parse(v);if(ve){for(h=0;h<ve.length;h++)if(Array.isArray(ve[h])){var k=ve[h];if(!(k.length<2)){var R=k[1];if(Array.isArray(R)&&!(R.length<1)){var le=R[0];if(le!="noop"&&le!="stop"&&le!="close")for(let dt=1;dt<R.length;dt++)R[dt]=""}}}}return is(ve)}catch{return v}}var it={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Jt={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Yt;function F(){}_(F,Fs),F.prototype.g=function(){return new XMLHttpRequest},Yt=new F;function ye(h){return encodeURIComponent(String(h))}function Ee(h){var v=1;h=h.split(":");const k=[];for(;v>0&&h.length;)k.push(h.shift()),v--;return h.length&&k.push(h.join(":")),k}function Te(h,v,k,R){this.j=h,this.i=v,this.l=k,this.S=R||1,this.V=new Pt(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Se}function Se(){this.i=null,this.g="",this.h=!1}var bt={},At={};function ft(h,v,k){h.M=1,h.A=ur(xt(v)),h.u=k,h.R=!0,zt(h,null)}function zt(h,v){h.F=Date.now(),tn(h),h.B=xt(h.A);var k=h.B,R=h.S;Array.isArray(R)||(R=[String(R)]),Aa(k.i,"t",R),h.C=0,k=h.j.L,h.h=new Se,h.g=Tr(h.j,k?v:null,!h.u),h.P>0&&(h.O=new Gt(y(h.Y,h,h.g),h.P)),v=h.V,k=h.g,R=h.ba;var le="readystatechange";Array.isArray(le)||(le&&(us[0]=le.toString()),le=us);for(let ve=0;ve<le.length;ve++){const dt=ot(k,le[ve],R||v.handleEvent,!1,v.h||v);if(!dt)break;v.g[dt.key]=dt}v=h.J?P(h.J):{},h.u?(h.v||(h.v="POST"),v["Content-Type"]="application/x-www-form-urlencoded",h.g.ea(h.B,h.v,h.u,v)):(h.v="GET",h.g.ea(h.B,h.v,null,v)),gt(),kt(h.i,h.v,h.B,h.l,h.S,h.u)}Te.prototype.ba=function(h){h=h.target;const v=this.O;v&&je(h)==3?v.j():this.Y(h)},Te.prototype.Y=function(h){try{if(h==this.g)e:{const ls=je(this.g),kn=this.g.ya(),Vs=this.g.ca();if(!(ls<3)&&(ls!=3||this.g&&(this.h.h||this.g.la()||Ye(this.g)))){this.K||ls!=4||kn==7||(kn==8||Vs<=0?gt(3):gt(2)),zs(this);var v=this.g.ca();this.X=v;var k=Bt(this);if(this.o=v==200,Q(this.i,this.v,this.B,this.l,this.S,ls,v),this.o){if(this.U&&!this.L){t:{if(this.g){var R,le=this.g;if((R=le.g?le.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!A(R)){var ve=R;break t}}ve=null}if(h=ve)Ae(this.i,this.l,h,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,G(this,h);else{this.o=!1,this.m=3,se(12),hs(this),sn(this);break e}}if(this.R){h=!0;let cn;for(;!this.K&&this.C<k.length;)if(cn=hn(this,k),cn==At){ls==4&&(this.m=4,se(14),h=!1),Ae(this.i,this.l,null,"[Incomplete Response]");break}else if(cn==bt){this.m=4,se(15),Ae(this.i,this.l,k,"[Invalid Chunk]"),h=!1;break}else Ae(this.i,this.l,cn,null),G(this,cn);if(Ps(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),ls!=4||k.length!=0||this.h.h||(this.m=1,se(16),h=!1),this.o=this.o&&h,!h)Ae(this.i,this.l,k,"[Invalid Chunked Response]"),hs(this),sn(this);else if(k.length>0&&!this.W){this.W=!0;var dt=this.j;dt.g==this&&dt.aa&&!dt.P&&(dt.j.info("Great, no buffering proxy detected. Bytes received: "+k.length),pn(dt),dt.P=!0,se(11))}}else Ae(this.i,this.l,k,null),G(this,k);ls==4&&hs(this),this.o&&!this.K&&(ls==4?kr(this.j,this):(this.o=!1,tn(this)))}else He(this.g),v==400&&k.indexOf("Unknown SID")>0?(this.m=3,se(12)):(this.m=0,se(13)),hs(this),sn(this)}}}catch{}};function Bt(h){if(!Ps(h))return h.g.la();const v=Ye(h.g);if(v==="")return"";let k="";const R=v.length,le=je(h.g)==4;if(!h.h.i){if(typeof TextDecoder>"u")return hs(h),sn(h),"";h.h.i=new d.TextDecoder}for(let ve=0;ve<R;ve++)h.h.h=!0,k+=h.h.i.decode(v[ve],{stream:!(le&&ve==R-1)});return v.length=0,h.h.g+=k,h.C=0,h.h.g}function Ps(h){return h.g?h.v=="GET"&&h.M!=2&&h.j.Aa:!1}function hn(h,v){var k=h.C,R=v.indexOf(`
`,k);return R==-1?At:(k=Number(v.substring(k,R)),isNaN(k)?bt:(R+=1,R+k>v.length?At:(v=v.slice(R,R+k),h.C=R+k,v)))}Te.prototype.cancel=function(){this.K=!0,hs(this)};function tn(h){h.T=Date.now()+h.H,En(h,h.H)}function En(h,v){if(h.D!=null)throw Error("WatchDog timer not null");h.D=_t(y(h.aa,h),v)}function zs(h){h.D&&(d.clearTimeout(h.D),h.D=null)}Te.prototype.aa=function(){this.D=null;const h=Date.now();h-this.T>=0?(Je(this.i,this.B),this.M!=2&&(gt(),se(17)),hs(this),this.m=2,sn(this)):En(this,this.T-h)};function sn(h){h.j.I==0||h.K||kr(h.j,h)}function hs(h){zs(h);var v=h.O;v&&typeof v.dispose=="function"&&v.dispose(),h.O=null,xs(h.V),h.g&&(v=h.g,h.g=null,v.abort(),v.dispose())}function G(h,v){try{var k=h.j;if(k.I!=0&&(k.g==h||z(k.h,h))){if(!h.L&&z(k.h,h)&&k.I==3){try{var R=k.Ba.g.parse(v)}catch{R=null}if(Array.isArray(R)&&R.length==3){var le=R;if(le[0]==0){e:if(!k.v){if(k.g)if(k.g.F+3e3<h.F)Wn(k),St(k);else break e;_n(k),se(18)}}else k.xa=le[1],0<k.xa-k.K&&le[2]<37500&&k.F&&k.A==0&&!k.C&&(k.C=_t(y(k.Va,k),6e3));E(k.h)<=1&&k.ta&&(k.ta=void 0)}else gn(k,11)}else if((h.L||k.g==h)&&Wn(k),!A(v))for(le=k.Ba.g.parse(v),v=0;v<le.length;v++){let Vs=le[v];const cn=Vs[0];if(!(cn<=k.K))if(k.K=cn,Vs=Vs[1],k.I==2)if(Vs[0]=="c"){k.M=Vs[1],k.ba=Vs[2];const Xr=Vs[3];Xr!=null&&(k.ka=Xr,k.j.info("VER="+k.ka));const Ia=Vs[4];Ia!=null&&(k.za=Ia,k.j.info("SVER="+k.za));const ma=Vs[5];ma!=null&&typeof ma=="number"&&ma>0&&(R=1.5*ma,k.O=R,k.j.info("backChannelRequestTimeoutMs_="+R)),R=k;const fa=h.g;if(fa){const Eo=fa.g?fa.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Eo){var ve=R.h;ve.g||Eo.indexOf("spdy")==-1&&Eo.indexOf("quic")==-1&&Eo.indexOf("h2")==-1||(ve.j=ve.l,ve.g=new Set,ve.h&&(ie(ve,ve.h),ve.h=null))}if(R.G){const ul=fa.g?fa.g.getResponseHeader("X-HTTP-Session-Id"):null;ul&&(R.wa=ul,ps(R.J,R.G,ul))}}k.I=3,k.l&&k.l.ra(),k.aa&&(k.T=Date.now()-h.F,k.j.info("Handshake RTT: "+k.T+"ms")),R=k;var dt=h;if(R.na=jr(R,R.L?R.ba:null,R.W),dt.L){ne(R.h,dt);var ls=dt,kn=R.O;kn&&(ls.H=kn),ls.D&&(zs(ls),tn(ls)),R.g=dt}else Zs(R);k.i.length>0&&Zt(k)}else Vs[0]!="stop"&&Vs[0]!="close"||gn(k,7);else k.I==3&&(Vs[0]=="stop"||Vs[0]=="close"?Vs[0]=="stop"?gn(k,7):ut(k):Vs[0]!="noop"&&k.l&&k.l.qa(Vs),k.A=0)}}gt(4)}catch{}}var me=class{constructor(h,v){this.g=h,this.map=v}};function ae(h){this.l=h||10,d.PerformanceNavigationTiming?(h=d.performance.getEntriesByType("navigation"),h=h.length>0&&(h[0].nextHopProtocol=="hq"||h[0].nextHopProtocol=="h2")):h=!!(d.chrome&&d.chrome.loadTimes&&d.chrome.loadTimes()&&d.chrome.loadTimes().wasFetchedViaSpdy),this.j=h?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function xe(h){return h.h?!0:h.g?h.g.size>=h.j:!1}function E(h){return h.h?1:h.g?h.g.size:0}function z(h,v){return h.h?h.h==v:h.g?h.g.has(v):!1}function ie(h,v){h.g?h.g.add(v):h.h=v}function ne(h,v){h.h&&h.h==v?h.h=null:h.g&&h.g.has(v)&&h.g.delete(v)}ae.prototype.cancel=function(){if(this.i=Ze(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const h of this.g.values())h.cancel();this.g.clear()}};function Ze(h){if(h.h!=null)return h.i.concat(h.h.G);if(h.g!=null&&h.g.size!==0){let v=h.i;for(const k of h.g.values())v=v.concat(k.G);return v}return O(h.i)}var nt=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function ct(h,v){if(h){h=h.split("&");for(let k=0;k<h.length;k++){const R=h[k].indexOf("=");let le,ve=null;R>=0?(le=h[k].substring(0,R),ve=h[k].substring(R+1)):le=h[k],v(le,ve?decodeURIComponent(ve.replace(/\+/g," ")):"")}}}function Lt(h){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let v;h instanceof Lt?(this.l=h.l,fs(this,h.j),this.o=h.o,this.g=h.g,nn(this,h.u),this.h=h.h,Dr(this,Mi(h.i)),this.m=h.m):h&&(v=String(h).match(nt))?(this.l=!1,fs(this,v[1]||"",!0),this.o=dr(v[2]||""),this.g=dr(v[3]||"",!0),nn(this,v[4]),this.h=dr(v[5]||"",!0),Dr(this,v[6]||"",!0),this.m=dr(v[7]||"")):(this.l=!1,this.i=new Pr(null,this.l))}Lt.prototype.toString=function(){const h=[];var v=this.j;v&&h.push(ua(v,Ra,!0),":");var k=this.g;return(k||v=="file")&&(h.push("//"),(v=this.o)&&h.push(ua(v,Ra,!0),"@"),h.push(ye(k).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),k=this.u,k!=null&&h.push(":",String(k))),(k=this.h)&&(this.g&&k.charAt(0)!="/"&&h.push("/"),h.push(ua(k,k.charAt(0)=="/"?Yr:Ri,!0))),(k=this.i.toString())&&h.push("?",k),(k=this.m)&&h.push("#",ua(k,Xa)),h.join("")},Lt.prototype.resolve=function(h){const v=xt(this);let k=!!h.j;k?fs(v,h.j):k=!!h.o,k?v.o=h.o:k=!!h.g,k?v.g=h.g:k=h.u!=null;var R=h.h;if(k)nn(v,h.u);else if(k=!!h.h){if(R.charAt(0)!="/")if(this.g&&!this.h)R="/"+R;else{var le=v.h.lastIndexOf("/");le!=-1&&(R=v.h.slice(0,le+1)+R)}if(le=R,le==".."||le==".")R="";else if(le.indexOf("./")!=-1||le.indexOf("/.")!=-1){R=le.lastIndexOf("/",0)==0,le=le.split("/");const ve=[];for(let dt=0;dt<le.length;){const ls=le[dt++];ls=="."?R&&dt==le.length&&ve.push(""):ls==".."?((ve.length>1||ve.length==1&&ve[0]!="")&&ve.pop(),R&&dt==le.length&&ve.push("")):(ve.push(ls),R=!0)}R=ve.join("/")}else R=le}return k?v.h=R:k=h.i.toString()!=="",k?Dr(v,Mi(h.i)):k=!!h.m,k&&(v.m=h.m),v};function xt(h){return new Lt(h)}function fs(h,v,k){h.j=k?dr(v,!0):v,h.j&&(h.j=h.j.replace(/:$/,""))}function nn(h,v){if(v){if(v=Number(v),isNaN(v)||v<0)throw Error("Bad port number "+v);h.u=v}else h.u=null}function Dr(h,v,k){v instanceof Pr?(h.i=v,Lr(h.i,h.l)):(k||(v=ua(v,hr)),h.i=new Pr(v,h.l))}function ps(h,v,k){h.i.set(v,k)}function ur(h){return ps(h,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),h}function dr(h,v){return h?v?decodeURI(h.replace(/%25/g,"%2525")):decodeURIComponent(h):""}function ua(h,v,k){return typeof h=="string"?(h=encodeURI(h).replace(v,Nn),k&&(h=h.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),h):null}function Nn(h){return h=h.charCodeAt(0),"%"+(h>>4&15).toString(16)+(h&15).toString(16)}var Ra=/[#\/\?@]/g,Ri=/[#\?:]/g,Yr=/[#\?]/g,hr=/[#\?@]/g,Xa=/#/g;function Pr(h,v){this.h=this.g=null,this.i=h||null,this.j=!!v}function Un(h){h.g||(h.g=new Map,h.h=0,h.i&&ct(h.i,function(v,k){h.add(decodeURIComponent(v.replace(/\+/g," ")),k)}))}n=Pr.prototype,n.add=function(h,v){Un(this),this.i=null,h=Qr(this,h);let k=this.g.get(h);return k||this.g.set(h,k=[]),k.push(v),this.h+=1,this};function Ai(h,v){Un(h),v=Qr(h,v),h.g.has(v)&&(h.i=null,h.h-=h.g.get(v).length,h.g.delete(v))}function Ja(h,v){return Un(h),v=Qr(h,v),h.g.has(v)}n.forEach=function(h,v){Un(this),this.g.forEach(function(k,R){k.forEach(function(le){h.call(v,le,R,this)},this)},this)};function _r(h,v){Un(h);let k=[];if(typeof v=="string")Ja(h,v)&&(k=k.concat(h.g.get(Qr(h,v))));else for(h=Array.from(h.g.values()),v=0;v<h.length;v++)k=k.concat(h[v]);return k}n.set=function(h,v){return Un(this),this.i=null,h=Qr(this,h),Ja(this,h)&&(this.h-=this.g.get(h).length),this.g.set(h,[v]),this.h+=1,this},n.get=function(h,v){return h?(h=_r(this,h),h.length>0?String(h[0]):v):v};function Aa(h,v,k){Ai(h,v),k.length>0&&(h.i=null,h.g.set(Qr(h,v),O(k)),h.h+=k.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const h=[],v=Array.from(this.g.keys());for(let R=0;R<v.length;R++){var k=v[R];const le=ye(k);k=_r(this,k);for(let ve=0;ve<k.length;ve++){let dt=le;k[ve]!==""&&(dt+="="+ye(k[ve])),h.push(dt)}}return this.i=h.join("&")};function Mi(h){const v=new Pr;return v.i=h.i,h.g&&(v.g=new Map(h.g),v.h=h.h),v}function Qr(h,v){return v=String(v),h.j&&(v=v.toLowerCase()),v}function Lr(h,v){v&&!h.j&&(Un(h),h.i=null,h.g.forEach(function(k,R){const le=R.toLowerCase();R!=le&&(Ai(this,R),Aa(this,le,k))},h)),h.j=v}function Fn(h,v){const k=new et;if(d.Image){const R=new Image;R.onload=x(fn,k,"TestLoadImage: loaded",!0,v,R),R.onerror=x(fn,k,"TestLoadImage: error",!1,v,R),R.onabort=x(fn,k,"TestLoadImage: abort",!1,v,R),R.ontimeout=x(fn,k,"TestLoadImage: timeout",!1,v,R),d.setTimeout(function(){R.ontimeout&&R.ontimeout()},1e4),R.src=h}else v(!1)}function zn(h,v){const k=new et,R=new AbortController,le=setTimeout(()=>{R.abort(),fn(k,"TestPingServer: timeout",!1,v)},1e4);fetch(h,{signal:R.signal}).then(ve=>{clearTimeout(le),ve.ok?fn(k,"TestPingServer: ok",!0,v):fn(k,"TestPingServer: server error",!1,v)}).catch(()=>{clearTimeout(le),fn(k,"TestPingServer: error",!1,v)})}function fn(h,v,k,R,le){try{le&&(le.onload=null,le.onerror=null,le.onabort=null,le.ontimeout=null),R(k)}catch{}}function Or(){this.g=new Ms}function mr(h){this.i=h.Sb||null,this.h=h.ab||!1}_(mr,Fs),mr.prototype.g=function(){return new da(this.i,this.h)};function da(h,v){Ct.call(this),this.H=h,this.o=v,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}_(da,Ct),n=da.prototype,n.open=function(h,v){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=h,this.D=v,this.readyState=1,ue(this)},n.send=function(h){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const v={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};h&&(v.body=h),(this.H||d).fetch(new Request(this.D,v)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,q(this)),this.readyState=0},n.Pa=function(h){if(this.g&&(this.l=h,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=h.headers,this.readyState=2,ue(this)),this.g&&(this.readyState=3,ue(this),this.g)))if(this.responseType==="arraybuffer")h.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof d.ReadableStream<"u"&&"body"in h){if(this.j=h.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;sr(this)}else h.text().then(this.Oa.bind(this),this.ga.bind(this))};function sr(h){h.j.read().then(h.Ma.bind(h)).catch(h.ga.bind(h))}n.Ma=function(h){if(this.g){if(this.o&&h.value)this.response.push(h.value);else if(!this.o){var v=h.value?h.value:new Uint8Array(0);(v=this.B.decode(v,{stream:!h.done}))&&(this.response=this.responseText+=v)}h.done?q(this):ue(this),this.readyState==3&&sr(this)}},n.Oa=function(h){this.g&&(this.response=this.responseText=h,q(this))},n.Na=function(h){this.g&&(this.response=h,q(this))},n.ga=function(){this.g&&q(this)};function q(h){h.readyState=4,h.l=null,h.j=null,h.B=null,ue(h)}n.setRequestHeader=function(h,v){this.A.append(h,v)},n.getResponseHeader=function(h){return this.h&&this.h.get(h.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const h=[],v=this.h.entries();for(var k=v.next();!k.done;)k=k.value,h.push(k[0]+": "+k[1]),k=v.next();return h.join(`\r
`)};function ue(h){h.onreadystatechange&&h.onreadystatechange.call(h)}Object.defineProperty(da.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(h){this.m=h?"include":"same-origin"}});function de(h){let v="";return We(h,function(k,R){v+=R,v+=":",v+=k,v+=`\r
`}),v}function Ue(h,v,k){e:{for(R in k){var R=!1;break e}R=!0}R||(k=de(k),typeof h=="string"?k!=null&&ye(k):ps(h,v,k))}function Ce(h){Ct.call(this),this.headers=new Map,this.L=h||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}_(Ce,Ct);var st=/^https?$/i,vt=["POST","PUT"];n=Ce.prototype,n.Fa=function(h){this.H=h},n.ea=function(h,v,k,R){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+h);v=v?v.toUpperCase():"GET",this.D=h,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Yt.g(),this.g.onreadystatechange=j(y(this.Ca,this));try{this.B=!0,this.g.open(v,String(h),!0),this.B=!1}catch(ve){qt(this,ve);return}if(h=k||"",k=new Map(this.headers),R)if(Object.getPrototypeOf(R)===Object.prototype)for(var le in R)k.set(le,R[le]);else if(typeof R.keys=="function"&&typeof R.get=="function")for(const ve of R.keys())k.set(ve,R.get(ve));else throw Error("Unknown input type for opt_headers: "+String(R));R=Array.from(k.keys()).find(ve=>ve.toLowerCase()=="content-type"),le=d.FormData&&h instanceof d.FormData,!(Array.prototype.indexOf.call(vt,v,void 0)>=0)||R||le||k.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[ve,dt]of k)this.g.setRequestHeader(ve,dt);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(h),this.v=!1}catch(ve){qt(this,ve)}};function qt(h,v){h.h=!1,h.g&&(h.j=!0,h.g.abort(),h.j=!1),h.l=v,h.o=5,ss(h),U(h)}function ss(h){h.A||(h.A=!0,lt(h,"complete"),lt(h,"error"))}n.abort=function(h){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=h||7,lt(this,"complete"),lt(this,"abort"),U(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),U(this,!0)),Ce.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?S(this):this.Xa())},n.Xa=function(){S(this)};function S(h){if(h.h&&typeof u<"u"){if(h.v&&je(h)==4)setTimeout(h.Ca.bind(h),0);else if(lt(h,"readystatechange"),je(h)==4){h.h=!1;try{const ve=h.ca();e:switch(ve){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var v=!0;break e;default:v=!1}var k;if(!(k=v)){var R;if(R=ve===0){let dt=String(h.D).match(nt)[1]||null;!dt&&d.self&&d.self.location&&(dt=d.self.location.protocol.slice(0,-1)),R=!st.test(dt?dt.toLowerCase():"")}k=R}if(k)lt(h,"complete"),lt(h,"success");else{h.o=6;try{var le=je(h)>2?h.g.statusText:""}catch{le=""}h.l=le+" ["+h.ca()+"]",ss(h)}}finally{U(h)}}}}function U(h,v){if(h.g){h.m&&(clearTimeout(h.m),h.m=null);const k=h.g;h.g=null,v||lt(h,"ready");try{k.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function je(h){return h.g?h.g.readyState:0}n.ca=function(){try{return je(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(h){if(this.g){var v=this.g.responseText;return h&&v.indexOf(h)==0&&(v=v.substring(h.length)),Qs(v)}};function Ye(h){try{if(!h.g)return null;if("response"in h.g)return h.g.response;switch(h.F){case"":case"text":return h.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in h.g)return h.g.mozResponseArrayBuffer}return null}catch{return null}}function He(h){const v={};h=(h.g&&je(h)>=2&&h.g.getAllResponseHeaders()||"").split(`\r
`);for(let R=0;R<h.length;R++){if(A(h[R]))continue;var k=Ee(h[R]);const le=k[0];if(k=k[1],typeof k!="string")continue;k=k.trim();const ve=v[le]||[];v[le]=ve,ve.push(k)}J(v,function(R){return R.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function tt(h,v,k){return k&&k.internalChannelParams&&k.internalChannelParams[h]||v}function Ge(h){this.za=0,this.i=[],this.j=new et,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=tt("failFast",!1,h),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=tt("baseRetryDelayMs",5e3,h),this.Za=tt("retryDelaySeedMs",1e4,h),this.Ta=tt("forwardChannelMaxRetries",2,h),this.va=tt("forwardChannelRequestTimeoutMs",2e4,h),this.ma=h&&h.xmlHttpFactory||void 0,this.Ua=h&&h.Rb||void 0,this.Aa=h&&h.useFetchStreams||!1,this.O=void 0,this.L=h&&h.supportsCrossDomainXhr||!1,this.M="",this.h=new ae(h&&h.concurrentRequestLimit),this.Ba=new Or,this.S=h&&h.fastHandshake||!1,this.R=h&&h.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=h&&h.Pb||!1,h&&h.ua&&this.j.ua(),h&&h.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&h&&h.detectBufferingProxy||!1,this.ia=void 0,h&&h.longPollingTimeout&&h.longPollingTimeout>0&&(this.ia=h.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=Ge.prototype,n.ka=8,n.I=1,n.connect=function(h,v,k,R){se(0),this.W=h,this.H=v||{},k&&R!==void 0&&(this.H.OSID=k,this.H.OAID=R),this.F=this.X,this.J=jr(this,null,this.W),Zt(this)};function ut(h){if(ns(h),h.I==3){var v=h.V++,k=xt(h.J);if(ps(k,"SID",h.M),ps(k,"RID",v),ps(k,"TYPE","terminate"),ln(h,k),v=new Te(h,h.j,v),v.M=2,v.A=ur(xt(k)),k=!1,d.navigator&&d.navigator.sendBeacon)try{k=d.navigator.sendBeacon(v.A.toString(),"")}catch{}!k&&d.Image&&(new Image().src=v.A,k=!0),k||(v.g=Tr(v.j,null),v.g.ea(v.A)),v.F=Date.now(),tn(v)}Ln(h)}function St(h){h.g&&(pn(h),h.g.cancel(),h.g=null)}function ns(h){St(h),h.v&&(d.clearTimeout(h.v),h.v=null),Wn(h),h.h.cancel(),h.m&&(typeof h.m=="number"&&d.clearTimeout(h.m),h.m=null)}function Zt(h){if(!xe(h.h)&&!h.m){h.m=!0;var v=h.Ea;Re||T(),_e||(Re(),_e=!0),C.add(v,h),h.D=0}}function ys(h,v){return E(h.h)>=h.h.j-(h.m?1:0)?!1:h.m?(h.i=v.G.concat(h.i),!0):h.I==1||h.I==2||h.D>=(h.Sa?0:h.Ta)?!1:(h.m=_t(y(h.Ea,h,v),fr(h,h.D)),h.D++,!0)}n.Ea=function(h){if(this.m)if(this.m=null,this.I==1){if(!h){this.V=Math.floor(Math.random()*1e5),h=this.V++;const le=new Te(this,this.j,h);let ve=this.o;if(this.U&&(ve?(ve=P(ve),Fe(ve,this.U)):ve=this.U),this.u!==null||this.R||(le.J=ve,ve=null),this.S)e:{for(var v=0,k=0;k<this.i.length;k++){t:{var R=this.i[k];if("__data__"in R.map&&(R=R.map.__data__,typeof R=="string")){R=R.length;break t}R=void 0}if(R===void 0)break;if(v+=R,v>4096){v=k;break e}if(v===4096||k===this.i.length-1){v=k+1;break e}}v=1e3}else v=1e3;v=Bs(this,le,v),k=xt(this.J),ps(k,"RID",h),ps(k,"CVER",22),this.G&&ps(k,"X-HTTP-Session-Id",this.G),ln(this,k),ve&&(this.R?v="headers="+ye(de(ve))+"&"+v:this.u&&Ue(k,this.u,ve)),ie(this.h,le),this.Ra&&ps(k,"TYPE","init"),this.S?(ps(k,"$req",v),ps(k,"SID","null"),le.U=!0,ft(le,k,null)):ft(le,k,v),this.I=2}}else this.I==3&&(h?rn(this,h):this.i.length==0||xe(this.h)||rn(this))};function rn(h,v){var k;v?k=v.l:k=h.V++;const R=xt(h.J);ps(R,"SID",h.M),ps(R,"RID",k),ps(R,"AID",h.K),ln(h,R),h.u&&h.o&&Ue(R,h.u,h.o),k=new Te(h,h.j,k,h.D+1),h.u===null&&(k.J=h.o),v&&(h.i=v.G.concat(h.i)),v=Bs(h,k,1e3),k.H=Math.round(h.va*.5)+Math.round(h.va*.5*Math.random()),ie(h.h,k),ft(k,R,v)}function ln(h,v){h.H&&We(h.H,function(k,R){ps(v,R,k)}),h.l&&We({},function(k,R){ps(v,R,k)})}function Bs(h,v,k){k=Math.min(h.i.length,k);const R=h.l?y(h.l.Ka,h.l,h):null;e:{var le=h.i;let ls=-1;for(;;){const kn=["count="+k];ls==-1?k>0?(ls=le[0].g,kn.push("ofs="+ls)):ls=0:kn.push("ofs="+ls);let Vs=!0;for(let cn=0;cn<k;cn++){var ve=le[cn].g;const Xr=le[cn].map;if(ve-=ls,ve<0)ls=Math.max(0,le[cn].g-100),Vs=!1;else try{ve="req"+ve+"_"||"";try{var dt=Xr instanceof Map?Xr:Object.entries(Xr);for(const[Ia,ma]of dt){let fa=ma;p(ma)&&(fa=is(ma)),kn.push(ve+Ia+"="+encodeURIComponent(fa))}}catch(Ia){throw kn.push(ve+"type="+encodeURIComponent("_badmap")),Ia}}catch{R&&R(Xr)}}if(Vs){dt=kn.join("&");break e}}dt=void 0}return h=h.i.splice(0,k),v.G=h,dt}function Zs(h){if(!h.g&&!h.v){h.Y=1;var v=h.Da;Re||T(),_e||(Re(),_e=!0),C.add(v,h),h.A=0}}function _n(h){return h.g||h.v||h.A>=3?!1:(h.Y++,h.v=_t(y(h.Da,h),fr(h,h.A)),h.A++,!0)}n.Da=function(){if(this.v=null,$n(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var h=4*this.T;this.j.info("BP detection timer enabled: "+h),this.B=_t(y(this.Wa,this),h)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,se(10),St(this),$n(this))};function pn(h){h.B!=null&&(d.clearTimeout(h.B),h.B=null)}function $n(h){h.g=new Te(h,h.j,"rpc",h.Y),h.u===null&&(h.g.J=h.o),h.g.P=0;var v=xt(h.na);ps(v,"RID","rpc"),ps(v,"SID",h.M),ps(v,"AID",h.K),ps(v,"CI",h.F?"0":"1"),!h.F&&h.ia&&ps(v,"TO",h.ia),ps(v,"TYPE","xmlhttp"),ln(h,v),h.u&&h.o&&Ue(v,h.u,h.o),h.O&&(h.g.H=h.O);var k=h.g;h=h.ba,k.M=1,k.A=ur(xt(v)),k.u=null,k.R=!0,zt(k,h)}n.Va=function(){this.C!=null&&(this.C=null,St(this),_n(this),se(19))};function Wn(h){h.C!=null&&(d.clearTimeout(h.C),h.C=null)}function kr(h,v){var k=null;if(h.g==v){Wn(h),pn(h),h.g=null;var R=2}else if(z(h.h,v))k=v.G,ne(h.h,v),R=1;else return;if(h.I!=0){if(v.o)if(R==1){k=v.u?v.u.length:0,v=Date.now()-v.F;var le=h.D;R=Ke(),lt(R,new Qe(R,k)),Zt(h)}else Zs(h);else if(le=v.m,le==3||le==0&&v.X>0||!(R==1&&ys(h,v)||R==2&&_n(h)))switch(k&&k.length>0&&(v=h.h,v.i=v.i.concat(k)),le){case 1:gn(h,5);break;case 4:gn(h,10);break;case 3:gn(h,6);break;default:gn(h,2)}}}function fr(h,v){let k=h.Qa+Math.floor(Math.random()*h.Za);return h.isActive()||(k*=2),k*v}function gn(h,v){if(h.j.info("Error code "+v),v==2){var k=y(h.bb,h),R=h.Ua;const le=!R;R=new Lt(R||"//www.google.com/images/cleardot.gif"),d.location&&d.location.protocol=="http"||fs(R,"https"),ur(R),le?Fn(R.toString(),k):zn(R.toString(),k)}else se(2);h.I=0,h.l&&h.l.pa(v),Ln(h),ns(h)}n.bb=function(h){h?(this.j.info("Successfully pinged google.com"),se(2)):(this.j.info("Failed to ping google.com"),se(1))};function Ln(h){if(h.I=0,h.ja=[],h.l){const v=Ze(h.h);(v.length!=0||h.i.length!=0)&&(K(h.ja,v),K(h.ja,h.i),h.h.i.length=0,O(h.i),h.i.length=0),h.l.oa()}}function jr(h,v,k){var R=k instanceof Lt?xt(k):new Lt(k);if(R.g!="")v&&(R.g=v+"."+R.g),nn(R,R.u);else{var le=d.location;R=le.protocol,v=v?v+"."+le.hostname:le.hostname,le=+le.port;const ve=new Lt(null);R&&fs(ve,R),v&&(ve.g=v),le&&nn(ve,le),k&&(ve.h=k),R=ve}return k=h.G,v=h.wa,k&&v&&ps(R,k,v),ps(R,"VER",h.ka),ln(h,R),R}function Tr(h,v,k){if(v&&!h.L)throw Error("Can't create secondary domain capable XhrIo object.");return v=h.Aa&&!h.ma?new Ce(new mr({ab:k})):new Ce(h.ma),v.Fa(h.L),v}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function So(){}n=So.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function Ma(){}Ma.prototype.g=function(h,v){return new Gn(h,v)};function Gn(h,v){Ct.call(this),this.g=new Ge(v),this.l=h,this.h=v&&v.messageUrlParams||null,h=v&&v.messageHeaders||null,v&&v.clientProtocolHeaderRequired&&(h?h["X-Client-Protocol"]="webchannel":h={"X-Client-Protocol":"webchannel"}),this.g.o=h,h=v&&v.initMessageHeaders||null,v&&v.messageContentType&&(h?h["X-WebChannel-Content-Type"]=v.messageContentType:h={"X-WebChannel-Content-Type":v.messageContentType}),v&&v.sa&&(h?h["X-WebChannel-Client-Profile"]=v.sa:h={"X-WebChannel-Client-Profile":v.sa}),this.g.U=h,(h=v&&v.Qb)&&!A(h)&&(this.g.u=h),this.A=v&&v.supportsCrossDomainXhr||!1,this.v=v&&v.sendRawJson||!1,(v=v&&v.httpSessionIdParam)&&!A(v)&&(this.g.G=v,h=this.h,h!==null&&v in h&&(h=this.h,v in h&&delete h[v])),this.j=new nr(this)}_(Gn,Ct),Gn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Gn.prototype.close=function(){ut(this.g)},Gn.prototype.o=function(h){var v=this.g;if(typeof h=="string"){var k={};k.__data__=h,h=k}else this.v&&(k={},k.__data__=is(h),h=k);v.i.push(new me(v.Ya++,h)),v.I==3&&Zt(v)},Gn.prototype.N=function(){this.g.l=null,delete this.j,ut(this.g),delete this.g,Gn.Z.N.call(this)};function Za(h){be.call(this),h.__headers__&&(this.headers=h.__headers__,this.statusCode=h.__status__,delete h.__headers__,delete h.__status__);var v=h.__sm__;if(v){e:{for(const k in v){h=k;break e}h=void 0}(this.i=h)&&(h=this.i,v=v!==null&&h in v?v[h]:void 0),this.data=v}else this.data=h}_(Za,be);function ha(){Ie.call(this),this.status=1}_(ha,Ie);function nr(h){this.g=h}_(nr,So),nr.prototype.ra=function(){lt(this.g,"a")},nr.prototype.qa=function(h){lt(this.g,new Za(h))},nr.prototype.pa=function(h){lt(this.g,new ha)},nr.prototype.oa=function(){lt(this.g,"b")},Ma.prototype.createWebChannel=Ma.prototype.g,Gn.prototype.send=Gn.prototype.o,Gn.prototype.open=Gn.prototype.m,Gn.prototype.close=Gn.prototype.close,n_=function(){return new Ma},s_=function(){return Ke()},t_=De,bg={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},it.NO_ERROR=0,it.TIMEOUT=8,it.HTTP_ERROR=6,Sh=it,Jt.COMPLETE="complete",e_=Jt,os.EventType=ws,ws.OPEN="a",ws.CLOSE="b",ws.ERROR="c",ws.MESSAGE="d",Ct.prototype.listen=Ct.prototype.J,du=os,Ce.prototype.listenOnce=Ce.prototype.K,Ce.prototype.getLastError=Ce.prototype.Ha,Ce.prototype.getLastErrorCode=Ce.prototype.ya,Ce.prototype.getStatus=Ce.prototype.ca,Ce.prototype.getResponseJson=Ce.prototype.La,Ce.prototype.getResponseText=Ce.prototype.la,Ce.prototype.send=Ce.prototype.ea,Ce.prototype.setWithCredentials=Ce.prototype.Fa,Zw=Ce}).apply(typeof ih<"u"?ih:typeof self<"u"?self:typeof window<"u"?window:{});class ir{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}ir.UNAUTHENTICATED=new ir(null),ir.GOOGLE_CREDENTIALS=new ir("google-credentials-uid"),ir.FIRST_PARTY=new ir("first-party-uid"),ir.MOCK_USER=new ir("mock-user");let hc="12.8.0";function gR(n){hc=n}const nl=new Kg("@firebase/firestore");function $l(){return nl.logLevel}function jt(n,...e){if(nl.logLevel<=js.DEBUG){const t=e.map(oy);nl.debug(`Firestore (${hc}): ${n}`,...t)}}function Ti(n,...e){if(nl.logLevel<=js.ERROR){const t=e.map(oy);nl.error(`Firestore (${hc}): ${n}`,...t)}}function tc(n,...e){if(nl.logLevel<=js.WARN){const t=e.map(oy);nl.warn(`Firestore (${hc}): ${n}`,...t)}}function oy(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}function Xt(n,e,t){let i="Unexpected state";typeof e=="string"?i=e:t=e,r_(n,i,t)}function r_(n,e,t){let i=`FIRESTORE (${hc}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{i+=" CONTEXT: "+JSON.stringify(t)}catch{i+=" CONTEXT: "+t}throw Ti(i),new Error(i)}function qs(n,e,t,i){let l="Unexpected state";typeof t=="string"?l=t:i=t,n||r_(e,l,i)}function as(n,e){return n}const Pe={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class pt extends Qa{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class wi{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class a_{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class yR{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(ir.UNAUTHENTICATED)))}shutdown(){}}class bR{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class vR{constructor(e){this.t=e,this.currentUser=ir.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){qs(this.o===void 0,42304);let i=this.i;const l=g=>this.i!==i?(i=this.i,t(g)):Promise.resolve();let u=new wi;this.o=()=>{this.i++,this.currentUser=this.u(),u.resolve(),u=new wi,e.enqueueRetryable((()=>l(this.currentUser)))};const d=()=>{const g=u;e.enqueueRetryable((async()=>{await g.promise,await l(this.currentUser)}))},p=g=>{jt("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=g,this.o&&(this.auth.addAuthTokenListener(this.o),d())};this.t.onInit((g=>p(g))),setTimeout((()=>{if(!this.auth){const g=this.t.getImmediate({optional:!0});g?p(g):(jt("FirebaseAuthCredentialsProvider","Auth not yet detected"),u.resolve(),u=new wi)}}),0),d()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((i=>this.i!==e?(jt("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(qs(typeof i.accessToken=="string",31837,{l:i}),new a_(i.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return qs(e===null||typeof e=="string",2055,{h:e}),new ir(e)}}class xR{constructor(e,t,i){this.P=e,this.T=t,this.I=i,this.type="FirstParty",this.user=ir.FIRST_PARTY,this.R=new Map}A(){return this.I?this.I():null}get headers(){this.R.set("X-Goog-AuthUser",this.P);const e=this.A();return e&&this.R.set("Authorization",e),this.T&&this.R.set("X-Goog-Iam-Authorization-Token",this.T),this.R}}class wR{constructor(e,t,i){this.P=e,this.T=t,this.I=i}getToken(){return Promise.resolve(new xR(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(ir.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class vx{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class _R{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,$r(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){qs(this.o===void 0,3512);const i=u=>{u.error!=null&&jt("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${u.error.message}`);const d=u.token!==this.m;return this.m=u.token,jt("FirebaseAppCheckTokenProvider",`Received ${d?"new":"existing"} token.`),d?t(u.token):Promise.resolve()};this.o=u=>{e.enqueueRetryable((()=>i(u)))};const l=u=>{jt("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=u,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((u=>l(u))),setTimeout((()=>{if(!this.appCheck){const u=this.V.getImmediate({optional:!0});u?l(u):jt("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new vx(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(qs(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new vx(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function kR(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let i=0;i<n;i++)t[i]=Math.floor(256*Math.random());return t}class ly{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const l=kR(40);for(let u=0;u<l.length;++u)i.length<20&&l[u]<t&&(i+=e.charAt(l[u]%62))}return i}}function Ss(n,e){return n<e?-1:n>e?1:0}function vg(n,e){const t=Math.min(n.length,e.length);for(let i=0;i<t;i++){const l=n.charAt(i),u=e.charAt(i);if(l!==u)return Bp(l)===Bp(u)?Ss(l,u):Bp(l)?1:-1}return Ss(n.length,e.length)}const jR=55296,TR=57343;function Bp(n){const e=n.charCodeAt(0);return e>=jR&&e<=TR}function sc(n,e,t){return n.length===e.length&&n.every(((i,l)=>t(i,e[l])))}const xx="__name__";class Ua{constructor(e,t,i){t===void 0?t=0:t>e.length&&Xt(637,{offset:t,range:e.length}),i===void 0?i=e.length-t:i>e.length-t&&Xt(1746,{length:i,range:e.length-t}),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return Ua.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Ua?e.forEach((i=>{t.push(i)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const i=Math.min(e.length,t.length);for(let l=0;l<i;l++){const u=Ua.compareSegments(e.get(l),t.get(l));if(u!==0)return u}return Ss(e.length,t.length)}static compareSegments(e,t){const i=Ua.isNumericId(e),l=Ua.isNumericId(t);return i&&!l?-1:!i&&l?1:i&&l?Ua.extractNumericId(e).compare(Ua.extractNumericId(t)):vg(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return ho.fromString(e.substring(4,e.length-2))}}class en extends Ua{construct(e,t,i){return new en(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const i of e){if(i.indexOf("//")>=0)throw new pt(Pe.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter((l=>l.length>0)))}return new en(t)}static emptyPath(){return new en([])}}const SR=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Zn extends Ua{construct(e,t,i){return new Zn(e,t,i)}static isValidIdentifier(e){return SR.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Zn.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===xx}static keyField(){return new Zn([xx])}static fromServerFormat(e){const t=[];let i="",l=0;const u=()=>{if(i.length===0)throw new pt(Pe.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""};let d=!1;for(;l<e.length;){const p=e[l];if(p==="\\"){if(l+1===e.length)throw new pt(Pe.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const g=e[l+1];if(g!=="\\"&&g!=="."&&g!=="`")throw new pt(Pe.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=g,l+=2}else p==="`"?(d=!d,l++):p!=="."||d?(i+=p,l++):(u(),l++)}if(u(),d)throw new pt(Pe.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Zn(t)}static emptyPath(){return new Zn([])}}class Ut{constructor(e){this.path=e}static fromPath(e){return new Ut(en.fromString(e))}static fromName(e){return new Ut(en.fromString(e).popFirst(5))}static empty(){return new Ut(en.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&en.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return en.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Ut(new en(e.slice()))}}function i_(n,e,t){if(!t)throw new pt(Pe.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function ER(n,e,t,i){if(e===!0&&i===!0)throw new pt(Pe.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function wx(n){if(!Ut.isDocumentKey(n))throw new pt(Pe.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function _x(n){if(Ut.isDocumentKey(n))throw new pt(Pe.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function o_(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function lm(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(i){return i.constructor?i.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Xt(12329,{type:typeof n})}function vr(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new pt(Pe.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=lm(n);throw new pt(Pe.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function NR(n,e){if(e<=0)throw new pt(Pe.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}function Pn(n,e){const t={typeString:n};return e&&(t.value=e),t}function Hu(n,e){if(!o_(n))throw new pt(Pe.INVALID_ARGUMENT,"JSON must be an object");let t;for(const i in e)if(e[i]){const l=e[i].typeString,u="value"in e[i]?{value:e[i].value}:void 0;if(!(i in n)){t=`JSON missing required field: '${i}'`;break}const d=n[i];if(l&&typeof d!==l){t=`JSON field '${i}' must be a ${l}.`;break}if(u!==void 0&&d!==u.value){t=`Expected '${i}' field to equal '${u.value}'`;break}}if(t)throw new pt(Pe.INVALID_ARGUMENT,t);return!0}const kx=-62135596800,jx=1e6;class Mt{static now(){return Mt.fromMillis(Date.now())}static fromDate(e){return Mt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),i=Math.floor((e-1e3*t)*jx);return new Mt(t,i)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new pt(Pe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new pt(Pe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<kx)throw new pt(Pe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new pt(Pe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/jx}_compareTo(e){return this.seconds===e.seconds?Ss(this.nanoseconds,e.nanoseconds):Ss(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Mt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Hu(e,Mt._jsonSchema))return new Mt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-kx;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Mt._jsonSchemaVersion="firestore/timestamp/1.0",Mt._jsonSchema={type:Pn("string",Mt._jsonSchemaVersion),seconds:Pn("number"),nanoseconds:Pn("number")};class ts{static fromTimestamp(e){return new ts(e)}static min(){return new ts(new Mt(0,0))}static max(){return new ts(new Mt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const Su=-1;function CR(n,e){const t=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,l=ts.fromTimestamp(i===1e9?new Mt(t+1,0):new Mt(t,i));return new go(l,Ut.empty(),e)}function RR(n){return new go(n.readTime,n.key,Su)}class go{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new go(ts.min(),Ut.empty(),Su)}static max(){return new go(ts.max(),Ut.empty(),Su)}}function AR(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=Ut.comparator(n.documentKey,e.documentKey),t!==0?t:Ss(n.largestBatchId,e.largestBatchId))}const MR="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class IR{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function mc(n){if(n.code!==Pe.FAILED_PRECONDITION||n.message!==MR)throw n;jt("LocalStore","Unexpectedly lost primary lease")}class $e{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Xt(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new $e(((i,l)=>{this.nextCallback=u=>{this.wrapSuccess(e,u).next(i,l)},this.catchCallback=u=>{this.wrapFailure(t,u).next(i,l)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof $e?t:$e.resolve(t)}catch(t){return $e.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):$e.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):$e.reject(t)}static resolve(e){return new $e(((t,i)=>{t(e)}))}static reject(e){return new $e(((t,i)=>{i(e)}))}static waitFor(e){return new $e(((t,i)=>{let l=0,u=0,d=!1;e.forEach((p=>{++l,p.next((()=>{++u,d&&u===l&&t()}),(g=>i(g)))})),d=!0,u===l&&t()}))}static or(e){let t=$e.resolve(!1);for(const i of e)t=t.next((l=>l?$e.resolve(l):i()));return t}static forEach(e,t){const i=[];return e.forEach(((l,u)=>{i.push(t.call(this,l,u))})),this.waitFor(i)}static mapArray(e,t){return new $e(((i,l)=>{const u=e.length,d=new Array(u);let p=0;for(let g=0;g<u;g++){const y=g;t(e[y]).next((x=>{d[y]=x,++p,p===u&&i(d)}),(x=>l(x)))}}))}static doWhile(e,t){return new $e(((i,l)=>{const u=()=>{e()===!0?t().next((()=>{u()}),l):i()};u()}))}}function DR(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function fc(n){return n.name==="IndexedDbTransactionError"}class cm{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=i=>this.ae(i),this.ue=i=>t.writeSequenceNumber(i))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}cm.ce=-1;const cy=-1;function um(n){return n==null}function qh(n){return n===0&&1/n==-1/0}function PR(n){return typeof n=="number"&&Number.isInteger(n)&&!qh(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}const l_="";function LR(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=Tx(e)),e=OR(n.get(t),e);return Tx(e)}function OR(n,e){let t=e;const i=n.length;for(let l=0;l<i;l++){const u=n.charAt(l);switch(u){case"\0":t+="";break;case l_:t+="";break;default:t+=u}}return t}function Tx(n){return n+l_+""}function Sx(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function jo(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function c_(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}class mn{constructor(e,t){this.comparator=e,this.root=t||Jn.EMPTY}insert(e,t){return new mn(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Jn.BLACK,null,null))}remove(e){return new mn(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Jn.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const i=this.comparator(e,t.key);if(i===0)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){const l=this.comparator(e,i.key);if(l===0)return t+i.left.size;l<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,i)=>(e(t,i),!1)))}toString(){const e=[];return this.inorderTraversal(((t,i)=>(e.push(`${t}:${i}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new oh(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new oh(this.root,e,this.comparator,!1)}getReverseIterator(){return new oh(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new oh(this.root,e,this.comparator,!0)}}class oh{constructor(e,t,i,l){this.isReverse=l,this.nodeStack=[];let u=1;for(;!e.isEmpty();)if(u=t?i(e.key,t):1,t&&l&&(u*=-1),u<0)e=this.isReverse?e.left:e.right;else{if(u===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Jn{constructor(e,t,i,l,u){this.key=e,this.value=t,this.color=i??Jn.RED,this.left=l??Jn.EMPTY,this.right=u??Jn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,l,u){return new Jn(e??this.key,t??this.value,i??this.color,l??this.left,u??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let l=this;const u=i(e,l.key);return l=u<0?l.copy(null,null,null,l.left.insert(e,t,i),null):u===0?l.copy(null,t,null,null,null):l.copy(null,null,null,null,l.right.insert(e,t,i)),l.fixUp()}removeMin(){if(this.left.isEmpty())return Jn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,l=this;if(t(e,l.key)<0)l.left.isEmpty()||l.left.isRed()||l.left.left.isRed()||(l=l.moveRedLeft()),l=l.copy(null,null,null,l.left.remove(e,t),null);else{if(l.left.isRed()&&(l=l.rotateRight()),l.right.isEmpty()||l.right.isRed()||l.right.left.isRed()||(l=l.moveRedRight()),t(e,l.key)===0){if(l.right.isEmpty())return Jn.EMPTY;i=l.right.min(),l=l.copy(i.key,i.value,null,null,l.right.removeMin())}l=l.copy(null,null,null,null,l.right.remove(e,t))}return l.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Jn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Jn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Xt(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Xt(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Xt(27949);return e+(this.isRed()?0:1)}}Jn.EMPTY=null,Jn.RED=!0,Jn.BLACK=!1;Jn.EMPTY=new class{constructor(){this.size=0}get key(){throw Xt(57766)}get value(){throw Xt(16141)}get color(){throw Xt(16727)}get left(){throw Xt(29726)}get right(){throw Xt(36894)}copy(e,t,i,l,u){return this}insert(e,t,i){return new Jn(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Vn{constructor(e){this.comparator=e,this.data=new mn(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,i)=>(e(t),!1)))}forEachInRange(e,t){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const l=i.getNext();if(this.comparator(l.key,e[1])>=0)return;t(l.key)}}forEachWhile(e,t){let i;for(i=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Ex(this.data.getIterator())}getIteratorFrom(e){return new Ex(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((i=>{t=t.add(i)})),t}isEqual(e){if(!(e instanceof Vn)||this.size!==e.size)return!1;const t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){const l=t.getNext().key,u=i.getNext().key;if(this.comparator(l,u)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new Vn(this.comparator);return t.data=e,t}}class Ex{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class Wr{constructor(e){this.fields=e,e.sort(Zn.comparator)}static empty(){return new Wr([])}unionWith(e){let t=new Vn(Zn.comparator);for(const i of this.fields)t=t.add(i);for(const i of e)t=t.add(i);return new Wr(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return sc(this.fields,e.fields,((t,i)=>t.isEqual(i)))}}class u_ extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class er{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(l){try{return atob(l)}catch(u){throw typeof DOMException<"u"&&u instanceof DOMException?new u_("Invalid base64 string: "+u):u}})(e);return new er(t)}static fromUint8Array(e){const t=(function(l){let u="";for(let d=0;d<l.length;++d)u+=String.fromCharCode(l[d]);return u})(e);return new er(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const i=new Uint8Array(t.length);for(let l=0;l<t.length;l++)i[l]=t.charCodeAt(l);return i})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Ss(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}er.EMPTY_BYTE_STRING=new er("");const BR=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function yo(n){if(qs(!!n,39018),typeof n=="string"){let e=0;const t=BR.exec(n);if(qs(!!t,46558,{timestamp:n}),t[1]){let l=t[1];l=(l+"000000000").substr(0,9),e=Number(l)}const i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:Sn(n.seconds),nanos:Sn(n.nanos)}}function Sn(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function bo(n){return typeof n=="string"?er.fromBase64String(n):er.fromUint8Array(n)}const d_="server_timestamp",h_="__type__",m_="__previous_value__",f_="__local_write_time__";function uy(n){return(n?.mapValue?.fields||{})[h_]?.stringValue===d_}function dm(n){const e=n.mapValue.fields[m_];return uy(e)?dm(e):e}function Eu(n){const e=yo(n.mapValue.fields[f_].timestampValue);return new Mt(e.seconds,e.nanos)}class VR{constructor(e,t,i,l,u,d,p,g,y,x,_){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=l,this.ssl=u,this.forceLongPolling=d,this.autoDetectLongPolling=p,this.longPollingOptions=g,this.useFetchStreams=y,this.isUsingEmulator=x,this.apiKey=_}}const Hh="(default)";class Nu{constructor(e,t){this.projectId=e,this.database=t||Hh}static empty(){return new Nu("","")}get isDefaultDatabase(){return this.database===Hh}isEqual(e){return e instanceof Nu&&e.projectId===this.projectId&&e.database===this.database}}function UR(n,e){if(!Object.prototype.hasOwnProperty.apply(n.options,["projectId"]))throw new pt(Pe.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Nu(n.options.projectId,e)}const p_="__type__",FR="__max__",lh={mapValue:{}},g_="__vector__",$h="value";function vo(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?uy(n)?4:qR(n)?9007199254740991:zR(n)?10:11:Xt(28295,{value:n})}function Ka(n,e){if(n===e)return!0;const t=vo(n);if(t!==vo(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Eu(n).isEqual(Eu(e));case 3:return(function(l,u){if(typeof l.timestampValue=="string"&&typeof u.timestampValue=="string"&&l.timestampValue.length===u.timestampValue.length)return l.timestampValue===u.timestampValue;const d=yo(l.timestampValue),p=yo(u.timestampValue);return d.seconds===p.seconds&&d.nanos===p.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(l,u){return bo(l.bytesValue).isEqual(bo(u.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(l,u){return Sn(l.geoPointValue.latitude)===Sn(u.geoPointValue.latitude)&&Sn(l.geoPointValue.longitude)===Sn(u.geoPointValue.longitude)})(n,e);case 2:return(function(l,u){if("integerValue"in l&&"integerValue"in u)return Sn(l.integerValue)===Sn(u.integerValue);if("doubleValue"in l&&"doubleValue"in u){const d=Sn(l.doubleValue),p=Sn(u.doubleValue);return d===p?qh(d)===qh(p):isNaN(d)&&isNaN(p)}return!1})(n,e);case 9:return sc(n.arrayValue.values||[],e.arrayValue.values||[],Ka);case 10:case 11:return(function(l,u){const d=l.mapValue.fields||{},p=u.mapValue.fields||{};if(Sx(d)!==Sx(p))return!1;for(const g in d)if(d.hasOwnProperty(g)&&(p[g]===void 0||!Ka(d[g],p[g])))return!1;return!0})(n,e);default:return Xt(52216,{left:n})}}function Cu(n,e){return(n.values||[]).find((t=>Ka(t,e)))!==void 0}function nc(n,e){if(n===e)return 0;const t=vo(n),i=vo(e);if(t!==i)return Ss(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return Ss(n.booleanValue,e.booleanValue);case 2:return(function(u,d){const p=Sn(u.integerValue||u.doubleValue),g=Sn(d.integerValue||d.doubleValue);return p<g?-1:p>g?1:p===g?0:isNaN(p)?isNaN(g)?0:-1:1})(n,e);case 3:return Nx(n.timestampValue,e.timestampValue);case 4:return Nx(Eu(n),Eu(e));case 5:return vg(n.stringValue,e.stringValue);case 6:return(function(u,d){const p=bo(u),g=bo(d);return p.compareTo(g)})(n.bytesValue,e.bytesValue);case 7:return(function(u,d){const p=u.split("/"),g=d.split("/");for(let y=0;y<p.length&&y<g.length;y++){const x=Ss(p[y],g[y]);if(x!==0)return x}return Ss(p.length,g.length)})(n.referenceValue,e.referenceValue);case 8:return(function(u,d){const p=Ss(Sn(u.latitude),Sn(d.latitude));return p!==0?p:Ss(Sn(u.longitude),Sn(d.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return Cx(n.arrayValue,e.arrayValue);case 10:return(function(u,d){const p=u.fields||{},g=d.fields||{},y=p[$h]?.arrayValue,x=g[$h]?.arrayValue,_=Ss(y?.values?.length||0,x?.values?.length||0);return _!==0?_:Cx(y,x)})(n.mapValue,e.mapValue);case 11:return(function(u,d){if(u===lh.mapValue&&d===lh.mapValue)return 0;if(u===lh.mapValue)return 1;if(d===lh.mapValue)return-1;const p=u.fields||{},g=Object.keys(p),y=d.fields||{},x=Object.keys(y);g.sort(),x.sort();for(let _=0;_<g.length&&_<x.length;++_){const j=vg(g[_],x[_]);if(j!==0)return j;const O=nc(p[g[_]],y[x[_]]);if(O!==0)return O}return Ss(g.length,x.length)})(n.mapValue,e.mapValue);default:throw Xt(23264,{he:t})}}function Nx(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return Ss(n,e);const t=yo(n),i=yo(e),l=Ss(t.seconds,i.seconds);return l!==0?l:Ss(t.nanos,i.nanos)}function Cx(n,e){const t=n.values||[],i=e.values||[];for(let l=0;l<t.length&&l<i.length;++l){const u=nc(t[l],i[l]);if(u)return u}return Ss(t.length,i.length)}function rc(n){return xg(n)}function xg(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const i=yo(t);return`time(${i.seconds},${i.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return bo(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return Ut.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let i="[",l=!0;for(const u of t.values||[])l?l=!1:i+=",",i+=xg(u);return i+"]"})(n.arrayValue):"mapValue"in n?(function(t){const i=Object.keys(t.fields||{}).sort();let l="{",u=!0;for(const d of i)u?u=!1:l+=",",l+=`${d}:${xg(t.fields[d])}`;return l+"}"})(n.mapValue):Xt(61005,{value:n})}function Eh(n){switch(vo(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=dm(n);return e?16+Eh(e):16;case 5:return 2*n.stringValue.length;case 6:return bo(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(i){return(i.values||[]).reduce(((l,u)=>l+Eh(u)),0)})(n.arrayValue);case 10:case 11:return(function(i){let l=0;return jo(i.fields,((u,d)=>{l+=u.length+Eh(d)})),l})(n.mapValue);default:throw Xt(13486,{value:n})}}function Rx(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function wg(n){return!!n&&"integerValue"in n}function dy(n){return!!n&&"arrayValue"in n}function Ax(n){return!!n&&"nullValue"in n}function Mx(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Nh(n){return!!n&&"mapValue"in n}function zR(n){return(n?.mapValue?.fields||{})[p_]?.stringValue===g_}function yu(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return jo(n.mapValue.fields,((t,i)=>e.mapValue.fields[t]=yu(i))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=yu(n.arrayValue.values[t]);return e}return{...n}}function qR(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===FR}class Mr{constructor(e){this.value=e}static empty(){return new Mr({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!Nh(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=yu(t)}setAll(e){let t=Zn.emptyPath(),i={},l=[];e.forEach(((d,p)=>{if(!t.isImmediateParentOf(p)){const g=this.getFieldsMap(t);this.applyChanges(g,i,l),i={},l=[],t=p.popLast()}d?i[p.lastSegment()]=yu(d):l.push(p.lastSegment())}));const u=this.getFieldsMap(t);this.applyChanges(u,i,l)}delete(e){const t=this.field(e.popLast());Nh(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Ka(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let l=t.mapValue.fields[e.get(i)];Nh(l)&&l.mapValue.fields||(l={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=l),t=l}return t.mapValue.fields}applyChanges(e,t,i){jo(t,((l,u)=>e[l]=u));for(const l of i)delete e[l]}clone(){return new Mr(yu(this.value))}}function y_(n){const e=[];return jo(n.fields,((t,i)=>{const l=new Zn([t]);if(Nh(i)){const u=y_(i.mapValue).fields;if(u.length===0)e.push(l);else for(const d of u)e.push(l.child(d))}else e.push(l)})),new Wr(e)}class or{constructor(e,t,i,l,u,d,p){this.key=e,this.documentType=t,this.version=i,this.readTime=l,this.createTime=u,this.data=d,this.documentState=p}static newInvalidDocument(e){return new or(e,0,ts.min(),ts.min(),ts.min(),Mr.empty(),0)}static newFoundDocument(e,t,i,l){return new or(e,1,t,ts.min(),i,l,0)}static newNoDocument(e,t){return new or(e,2,t,ts.min(),ts.min(),Mr.empty(),0)}static newUnknownDocument(e,t){return new or(e,3,t,ts.min(),ts.min(),Mr.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(ts.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Mr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Mr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ts.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof or&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new or(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Wh{constructor(e,t){this.position=e,this.inclusive=t}}function Ix(n,e,t){let i=0;for(let l=0;l<n.position.length;l++){const u=e[l],d=n.position[l];if(u.field.isKeyField()?i=Ut.comparator(Ut.fromName(d.referenceValue),t.key):i=nc(d,t.data.field(u.field)),u.dir==="desc"&&(i*=-1),i!==0)break}return i}function Dx(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Ka(n.position[t],e.position[t]))return!1;return!0}class Ru{constructor(e,t="asc"){this.field=e,this.dir=t}}function HR(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}class b_{}class Dn extends b_{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,i):new WR(e,t,i):t==="array-contains"?new YR(e,i):t==="in"?new QR(e,i):t==="not-in"?new XR(e,i):t==="array-contains-any"?new JR(e,i):new Dn(e,t,i)}static createKeyFieldInFilter(e,t,i){return t==="in"?new GR(e,i):new KR(e,i)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(nc(t,this.value)):t!==null&&vo(this.value)===vo(t)&&this.matchesComparison(nc(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Xt(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class ja extends b_{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new ja(e,t)}matches(e){return v_(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function v_(n){return n.op==="and"}function x_(n){return $R(n)&&v_(n)}function $R(n){for(const e of n.filters)if(e instanceof ja)return!1;return!0}function _g(n){if(n instanceof Dn)return n.field.canonicalString()+n.op.toString()+rc(n.value);if(x_(n))return n.filters.map((e=>_g(e))).join(",");{const e=n.filters.map((t=>_g(t))).join(",");return`${n.op}(${e})`}}function w_(n,e){return n instanceof Dn?(function(i,l){return l instanceof Dn&&i.op===l.op&&i.field.isEqual(l.field)&&Ka(i.value,l.value)})(n,e):n instanceof ja?(function(i,l){return l instanceof ja&&i.op===l.op&&i.filters.length===l.filters.length?i.filters.reduce(((u,d,p)=>u&&w_(d,l.filters[p])),!0):!1})(n,e):void Xt(19439)}function __(n){return n instanceof Dn?(function(t){return`${t.field.canonicalString()} ${t.op} ${rc(t.value)}`})(n):n instanceof ja?(function(t){return t.op.toString()+" {"+t.getFilters().map(__).join(" ,")+"}"})(n):"Filter"}class WR extends Dn{constructor(e,t,i){super(e,t,i),this.key=Ut.fromName(i.referenceValue)}matches(e){const t=Ut.comparator(e.key,this.key);return this.matchesComparison(t)}}class GR extends Dn{constructor(e,t){super(e,"in",t),this.keys=k_("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class KR extends Dn{constructor(e,t){super(e,"not-in",t),this.keys=k_("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function k_(n,e){return(e.arrayValue?.values||[]).map((t=>Ut.fromName(t.referenceValue)))}class YR extends Dn{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return dy(t)&&Cu(t.arrayValue,this.value)}}class QR extends Dn{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Cu(this.value.arrayValue,t)}}class XR extends Dn{constructor(e,t){super(e,"not-in",t)}matches(e){if(Cu(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Cu(this.value.arrayValue,t)}}class JR extends Dn{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!dy(t)||!t.arrayValue.values)&&t.arrayValue.values.some((i=>Cu(this.value.arrayValue,i)))}}class ZR{constructor(e,t=null,i=[],l=[],u=null,d=null,p=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=l,this.limit=u,this.startAt=d,this.endAt=p,this.Te=null}}function Px(n,e=null,t=[],i=[],l=null,u=null,d=null){return new ZR(n,e,t,i,l,u,d)}function hy(n){const e=as(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((i=>_g(i))).join(","),t+="|ob:",t+=e.orderBy.map((i=>(function(u){return u.field.canonicalString()+u.dir})(i))).join(","),um(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((i=>rc(i))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((i=>rc(i))).join(",")),e.Te=t}return e.Te}function my(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!HR(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!w_(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!Dx(n.startAt,e.startAt)&&Dx(n.endAt,e.endAt)}function kg(n){return Ut.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}class pc{constructor(e,t=null,i=[],l=[],u=null,d="F",p=null,g=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=l,this.limit=u,this.limitType=d,this.startAt=p,this.endAt=g,this.Ie=null,this.Ee=null,this.Re=null,this.startAt,this.endAt}}function eA(n,e,t,i,l,u,d,p){return new pc(n,e,t,i,l,u,d,p)}function hm(n){return new pc(n)}function Lx(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function tA(n){return Ut.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function j_(n){return n.collectionGroup!==null}function bu(n){const e=as(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const u of e.explicitOrderBy)e.Ie.push(u),t.add(u.field.canonicalString());const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(d){let p=new Vn(Zn.comparator);return d.filters.forEach((g=>{g.getFlattenedFilters().forEach((y=>{y.isInequality()&&(p=p.add(y.field))}))})),p})(e).forEach((u=>{t.has(u.canonicalString())||u.isKeyField()||e.Ie.push(new Ru(u,i))})),t.has(Zn.keyField().canonicalString())||e.Ie.push(new Ru(Zn.keyField(),i))}return e.Ie}function $a(n){const e=as(n);return e.Ee||(e.Ee=sA(e,bu(n))),e.Ee}function sA(n,e){if(n.limitType==="F")return Px(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((l=>{const u=l.dir==="desc"?"asc":"desc";return new Ru(l.field,u)}));const t=n.endAt?new Wh(n.endAt.position,n.endAt.inclusive):null,i=n.startAt?new Wh(n.startAt.position,n.startAt.inclusive):null;return Px(n.path,n.collectionGroup,e,n.filters,n.limit,t,i)}}function jg(n,e){const t=n.filters.concat([e]);return new pc(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function nA(n,e){const t=n.explicitOrderBy.concat([e]);return new pc(n.path,n.collectionGroup,t,n.filters.slice(),n.limit,n.limitType,n.startAt,n.endAt)}function Gh(n,e,t){return new pc(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function mm(n,e){return my($a(n),$a(e))&&n.limitType===e.limitType}function T_(n){return`${hy($a(n))}|lt:${n.limitType}`}function Wl(n){return`Query(target=${(function(t){let i=t.path.canonicalString();return t.collectionGroup!==null&&(i+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(i+=`, filters: [${t.filters.map((l=>__(l))).join(", ")}]`),um(t.limit)||(i+=", limit: "+t.limit),t.orderBy.length>0&&(i+=`, orderBy: [${t.orderBy.map((l=>(function(d){return`${d.field.canonicalString()} (${d.dir})`})(l))).join(", ")}]`),t.startAt&&(i+=", startAt: ",i+=t.startAt.inclusive?"b:":"a:",i+=t.startAt.position.map((l=>rc(l))).join(",")),t.endAt&&(i+=", endAt: ",i+=t.endAt.inclusive?"a:":"b:",i+=t.endAt.position.map((l=>rc(l))).join(",")),`Target(${i})`})($a(n))}; limitType=${n.limitType})`}function fm(n,e){return e.isFoundDocument()&&(function(i,l){const u=l.key.path;return i.collectionGroup!==null?l.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(u):Ut.isDocumentKey(i.path)?i.path.isEqual(u):i.path.isImmediateParentOf(u)})(n,e)&&(function(i,l){for(const u of bu(i))if(!u.field.isKeyField()&&l.data.field(u.field)===null)return!1;return!0})(n,e)&&(function(i,l){for(const u of i.filters)if(!u.matches(l))return!1;return!0})(n,e)&&(function(i,l){return!(i.startAt&&!(function(d,p,g){const y=Ix(d,p,g);return d.inclusive?y<=0:y<0})(i.startAt,bu(i),l)||i.endAt&&!(function(d,p,g){const y=Ix(d,p,g);return d.inclusive?y>=0:y>0})(i.endAt,bu(i),l))})(n,e)}function rA(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function S_(n){return(e,t)=>{let i=!1;for(const l of bu(n)){const u=aA(l,e,t);if(u!==0)return u;i=i||l.field.isKeyField()}return 0}}function aA(n,e,t){const i=n.field.isKeyField()?Ut.comparator(e.key,t.key):(function(u,d,p){const g=d.data.field(u),y=p.data.field(u);return g!==null&&y!==null?nc(g,y):Xt(42886)})(n.field,e,t);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return Xt(19790,{direction:n.dir})}}class ll{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i!==void 0){for(const[l,u]of i)if(this.equalsFn(l,e))return u}}has(e){return this.get(e)!==void 0}set(e,t){const i=this.mapKeyFn(e),l=this.inner[i];if(l===void 0)return this.inner[i]=[[e,t]],void this.innerSize++;for(let u=0;u<l.length;u++)if(this.equalsFn(l[u][0],e))return void(l[u]=[e,t]);l.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i===void 0)return!1;for(let l=0;l<i.length;l++)if(this.equalsFn(i[l][0],e))return i.length===1?delete this.inner[t]:i.splice(l,1),this.innerSize--,!0;return!1}forEach(e){jo(this.inner,((t,i)=>{for(const[l,u]of i)e(l,u)}))}isEmpty(){return c_(this.inner)}size(){return this.innerSize}}const iA=new mn(Ut.comparator);function Si(){return iA}const E_=new mn(Ut.comparator);function hu(...n){let e=E_;for(const t of n)e=e.insert(t.key,t);return e}function N_(n){let e=E_;return n.forEach(((t,i)=>e=e.insert(t,i.overlayedDocument))),e}function Ko(){return vu()}function C_(){return vu()}function vu(){return new ll((n=>n.toString()),((n,e)=>n.isEqual(e)))}const oA=new mn(Ut.comparator),lA=new Vn(Ut.comparator);function Es(...n){let e=lA;for(const t of n)e=e.add(t);return e}const cA=new Vn(Ss);function uA(){return cA}function fy(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:qh(e)?"-0":e}}function R_(n){return{integerValue:""+n}}function A_(n,e){return PR(e)?R_(e):fy(n,e)}class pm{constructor(){this._=void 0}}function dA(n,e,t){return n instanceof Au?(function(l,u){const d={fields:{[h_]:{stringValue:d_},[f_]:{timestampValue:{seconds:l.seconds,nanos:l.nanoseconds}}}};return u&&uy(u)&&(u=dm(u)),u&&(d.fields[m_]=u),{mapValue:d}})(t,e):n instanceof Mu?I_(n,e):n instanceof Iu?D_(n,e):(function(l,u){const d=M_(l,u),p=Ox(d)+Ox(l.Ae);return wg(d)&&wg(l.Ae)?R_(p):fy(l.serializer,p)})(n,e)}function hA(n,e,t){return n instanceof Mu?I_(n,e):n instanceof Iu?D_(n,e):t}function M_(n,e){return n instanceof Du?(function(i){return wg(i)||(function(u){return!!u&&"doubleValue"in u})(i)})(e)?e:{integerValue:0}:null}class Au extends pm{}class Mu extends pm{constructor(e){super(),this.elements=e}}function I_(n,e){const t=P_(e);for(const i of n.elements)t.some((l=>Ka(l,i)))||t.push(i);return{arrayValue:{values:t}}}class Iu extends pm{constructor(e){super(),this.elements=e}}function D_(n,e){let t=P_(e);for(const i of n.elements)t=t.filter((l=>!Ka(l,i)));return{arrayValue:{values:t}}}class Du extends pm{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function Ox(n){return Sn(n.integerValue||n.doubleValue)}function P_(n){return dy(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class L_{constructor(e,t){this.field=e,this.transform=t}}function mA(n,e){return n.field.isEqual(e.field)&&(function(i,l){return i instanceof Mu&&l instanceof Mu||i instanceof Iu&&l instanceof Iu?sc(i.elements,l.elements,Ka):i instanceof Du&&l instanceof Du?Ka(i.Ae,l.Ae):i instanceof Au&&l instanceof Au})(n.transform,e.transform)}class fA{constructor(e,t){this.version=e,this.transformResults=t}}class xr{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new xr}static exists(e){return new xr(void 0,e)}static updateTime(e){return new xr(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Ch(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class gm{}function O_(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new ym(n.key,xr.none()):new $u(n.key,n.data,xr.none());{const t=n.data,i=Mr.empty();let l=new Vn(Zn.comparator);for(let u of e.fields)if(!l.has(u)){let d=t.field(u);d===null&&u.length>1&&(u=u.popLast(),d=t.field(u)),d===null?i.delete(u):i.set(u,d),l=l.add(u)}return new To(n.key,i,new Wr(l.toArray()),xr.none())}}function pA(n,e,t){n instanceof $u?(function(l,u,d){const p=l.value.clone(),g=Vx(l.fieldTransforms,u,d.transformResults);p.setAll(g),u.convertToFoundDocument(d.version,p).setHasCommittedMutations()})(n,e,t):n instanceof To?(function(l,u,d){if(!Ch(l.precondition,u))return void u.convertToUnknownDocument(d.version);const p=Vx(l.fieldTransforms,u,d.transformResults),g=u.data;g.setAll(B_(l)),g.setAll(p),u.convertToFoundDocument(d.version,g).setHasCommittedMutations()})(n,e,t):(function(l,u,d){u.convertToNoDocument(d.version).setHasCommittedMutations()})(0,e,t)}function xu(n,e,t,i){return n instanceof $u?(function(u,d,p,g){if(!Ch(u.precondition,d))return p;const y=u.value.clone(),x=Ux(u.fieldTransforms,g,d);return y.setAll(x),d.convertToFoundDocument(d.version,y).setHasLocalMutations(),null})(n,e,t,i):n instanceof To?(function(u,d,p,g){if(!Ch(u.precondition,d))return p;const y=Ux(u.fieldTransforms,g,d),x=d.data;return x.setAll(B_(u)),x.setAll(y),d.convertToFoundDocument(d.version,x).setHasLocalMutations(),p===null?null:p.unionWith(u.fieldMask.fields).unionWith(u.fieldTransforms.map((_=>_.field)))})(n,e,t,i):(function(u,d,p){return Ch(u.precondition,d)?(d.convertToNoDocument(d.version).setHasLocalMutations(),null):p})(n,e,t)}function gA(n,e){let t=null;for(const i of n.fieldTransforms){const l=e.data.field(i.field),u=M_(i.transform,l||null);u!=null&&(t===null&&(t=Mr.empty()),t.set(i.field,u))}return t||null}function Bx(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(i,l){return i===void 0&&l===void 0||!(!i||!l)&&sc(i,l,((u,d)=>mA(u,d)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class $u extends gm{constructor(e,t,i,l=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=l,this.type=0}getFieldMask(){return null}}class To extends gm{constructor(e,t,i,l,u=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=l,this.fieldTransforms=u,this.type=1}getFieldMask(){return this.fieldMask}}function B_(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const i=n.data.field(t);e.set(t,i)}})),e}function Vx(n,e,t){const i=new Map;qs(n.length===t.length,32656,{Ve:t.length,de:n.length});for(let l=0;l<t.length;l++){const u=n[l],d=u.transform,p=e.data.field(u.field);i.set(u.field,hA(d,p,t[l]))}return i}function Ux(n,e,t){const i=new Map;for(const l of n){const u=l.transform,d=t.data.field(l.field);i.set(l.field,dA(u,d,e))}return i}class ym extends gm{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class yA extends gm{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class bA{constructor(e,t,i,l){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=l}applyToRemoteDocument(e,t){const i=t.mutationResults;for(let l=0;l<this.mutations.length;l++){const u=this.mutations[l];u.key.isEqual(e.key)&&pA(u,e,i[l])}}applyToLocalView(e,t){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(t=xu(i,e,t,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(t=xu(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const i=C_();return this.mutations.forEach((l=>{const u=e.get(l.key),d=u.overlayedDocument;let p=this.applyToLocalView(d,u.mutatedFields);p=t.has(l.key)?null:p;const g=O_(d,p);g!==null&&i.set(l.key,g),d.isValidDocument()||d.convertToNoDocument(ts.min())})),i}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),Es())}isEqual(e){return this.batchId===e.batchId&&sc(this.mutations,e.mutations,((t,i)=>Bx(t,i)))&&sc(this.baseMutations,e.baseMutations,((t,i)=>Bx(t,i)))}}class py{constructor(e,t,i,l){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=l}static from(e,t,i){qs(e.mutations.length===i.length,58842,{me:e.mutations.length,fe:i.length});let l=(function(){return oA})();const u=e.mutations;for(let d=0;d<u.length;d++)l=l.insert(u[d].key,i[d].version);return new py(e,t,i,l)}}class vA{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class xA{constructor(e,t){this.count=e,this.unchangedNames=t}}var In,Rs;function wA(n){switch(n){case Pe.OK:return Xt(64938);case Pe.CANCELLED:case Pe.UNKNOWN:case Pe.DEADLINE_EXCEEDED:case Pe.RESOURCE_EXHAUSTED:case Pe.INTERNAL:case Pe.UNAVAILABLE:case Pe.UNAUTHENTICATED:return!1;case Pe.INVALID_ARGUMENT:case Pe.NOT_FOUND:case Pe.ALREADY_EXISTS:case Pe.PERMISSION_DENIED:case Pe.FAILED_PRECONDITION:case Pe.ABORTED:case Pe.OUT_OF_RANGE:case Pe.UNIMPLEMENTED:case Pe.DATA_LOSS:return!0;default:return Xt(15467,{code:n})}}function V_(n){if(n===void 0)return Ti("GRPC error has no .code"),Pe.UNKNOWN;switch(n){case In.OK:return Pe.OK;case In.CANCELLED:return Pe.CANCELLED;case In.UNKNOWN:return Pe.UNKNOWN;case In.DEADLINE_EXCEEDED:return Pe.DEADLINE_EXCEEDED;case In.RESOURCE_EXHAUSTED:return Pe.RESOURCE_EXHAUSTED;case In.INTERNAL:return Pe.INTERNAL;case In.UNAVAILABLE:return Pe.UNAVAILABLE;case In.UNAUTHENTICATED:return Pe.UNAUTHENTICATED;case In.INVALID_ARGUMENT:return Pe.INVALID_ARGUMENT;case In.NOT_FOUND:return Pe.NOT_FOUND;case In.ALREADY_EXISTS:return Pe.ALREADY_EXISTS;case In.PERMISSION_DENIED:return Pe.PERMISSION_DENIED;case In.FAILED_PRECONDITION:return Pe.FAILED_PRECONDITION;case In.ABORTED:return Pe.ABORTED;case In.OUT_OF_RANGE:return Pe.OUT_OF_RANGE;case In.UNIMPLEMENTED:return Pe.UNIMPLEMENTED;case In.DATA_LOSS:return Pe.DATA_LOSS;default:return Xt(39323,{code:n})}}(Rs=In||(In={}))[Rs.OK=0]="OK",Rs[Rs.CANCELLED=1]="CANCELLED",Rs[Rs.UNKNOWN=2]="UNKNOWN",Rs[Rs.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Rs[Rs.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Rs[Rs.NOT_FOUND=5]="NOT_FOUND",Rs[Rs.ALREADY_EXISTS=6]="ALREADY_EXISTS",Rs[Rs.PERMISSION_DENIED=7]="PERMISSION_DENIED",Rs[Rs.UNAUTHENTICATED=16]="UNAUTHENTICATED",Rs[Rs.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Rs[Rs.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Rs[Rs.ABORTED=10]="ABORTED",Rs[Rs.OUT_OF_RANGE=11]="OUT_OF_RANGE",Rs[Rs.UNIMPLEMENTED=12]="UNIMPLEMENTED",Rs[Rs.INTERNAL=13]="INTERNAL",Rs[Rs.UNAVAILABLE=14]="UNAVAILABLE",Rs[Rs.DATA_LOSS=15]="DATA_LOSS";function _A(){return new TextEncoder}const kA=new ho([4294967295,4294967295],0);function Fx(n){const e=_A().encode(n),t=new Jw;return t.update(e),new Uint8Array(t.digest())}function zx(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),i=e.getUint32(4,!0),l=e.getUint32(8,!0),u=e.getUint32(12,!0);return[new ho([t,i],0),new ho([l,u],0)]}class gy{constructor(e,t,i){if(this.bitmap=e,this.padding=t,this.hashCount=i,t<0||t>=8)throw new mu(`Invalid padding: ${t}`);if(i<0)throw new mu(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new mu(`Invalid hash count: ${i}`);if(e.length===0&&t!==0)throw new mu(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=ho.fromNumber(this.ge)}ye(e,t,i){let l=e.add(t.multiply(ho.fromNumber(i)));return l.compare(kA)===1&&(l=new ho([l.getBits(0),l.getBits(1)],0)),l.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=Fx(e),[i,l]=zx(t);for(let u=0;u<this.hashCount;u++){const d=this.ye(i,l,u);if(!this.we(d))return!1}return!0}static create(e,t,i){const l=e%8==0?0:8-e%8,u=new Uint8Array(Math.ceil(e/8)),d=new gy(u,l,t);return i.forEach((p=>d.insert(p))),d}insert(e){if(this.ge===0)return;const t=Fx(e),[i,l]=zx(t);for(let u=0;u<this.hashCount;u++){const d=this.ye(i,l,u);this.be(d)}}be(e){const t=Math.floor(e/8),i=e%8;this.bitmap[t]|=1<<i}}class mu extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class bm{constructor(e,t,i,l,u){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=i,this.documentUpdates=l,this.resolvedLimboDocuments=u}static createSynthesizedRemoteEventForCurrentChange(e,t,i){const l=new Map;return l.set(e,Wu.createSynthesizedTargetChangeForCurrentChange(e,t,i)),new bm(ts.min(),l,new mn(Ss),Si(),Es())}}class Wu{constructor(e,t,i,l,u){this.resumeToken=e,this.current=t,this.addedDocuments=i,this.modifiedDocuments=l,this.removedDocuments=u}static createSynthesizedTargetChangeForCurrentChange(e,t,i){return new Wu(i,t,Es(),Es(),Es())}}class Rh{constructor(e,t,i,l){this.Se=e,this.removedTargetIds=t,this.key=i,this.De=l}}class U_{constructor(e,t){this.targetId=e,this.Ce=t}}class F_{constructor(e,t,i=er.EMPTY_BYTE_STRING,l=null){this.state=e,this.targetIds=t,this.resumeToken=i,this.cause=l}}class qx{constructor(){this.ve=0,this.Fe=Hx(),this.Me=er.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Es(),t=Es(),i=Es();return this.Fe.forEach(((l,u)=>{switch(u){case 0:e=e.add(l);break;case 2:t=t.add(l);break;case 1:i=i.add(l);break;default:Xt(38017,{changeType:u})}})),new Wu(this.Me,this.xe,e,t,i)}Ke(){this.Oe=!1,this.Fe=Hx()}qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}Ue(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}$e(){this.ve+=1}We(){this.ve-=1,qs(this.ve>=0,3241,{ve:this.ve})}Qe(){this.Oe=!0,this.xe=!0}}class jA{constructor(e){this.Ge=e,this.ze=new Map,this.je=Si(),this.He=ch(),this.Je=ch(),this.Ze=new mn(Ss)}Xe(e){for(const t of e.Se)e.De&&e.De.isFoundDocument()?this.Ye(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const i=this.nt(t);switch(e.state){case 0:this.rt(t)&&i.Le(e.resumeToken);break;case 1:i.We(),i.Ne||i.Ke(),i.Le(e.resumeToken);break;case 2:i.We(),i.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(i.Qe(),i.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),i.Le(e.resumeToken));break;default:Xt(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((i,l)=>{this.rt(l)&&t(l)}))}st(e){const t=e.targetId,i=e.Ce.count,l=this.ot(t);if(l){const u=l.target;if(kg(u))if(i===0){const d=new Ut(u.path);this.et(t,d,or.newNoDocument(d,ts.min()))}else qs(i===1,20013,{expectedCount:i});else{const d=this._t(t);if(d!==i){const p=this.ut(e),g=p?this.ct(p,e,d):1;if(g!==0){this.it(t);const y=g===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(t,y)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:i="",padding:l=0},hashCount:u=0}=t;let d,p;try{d=bo(i).toUint8Array()}catch(g){if(g instanceof u_)return tc("Decoding the base64 bloom filter in existence filter failed ("+g.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw g}try{p=new gy(d,l,u)}catch(g){return tc(g instanceof mu?"BloomFilter error: ":"Applying bloom filter failed: ",g),null}return p.ge===0?null:p}ct(e,t,i){return t.Ce.count===i-this.Pt(e,t.targetId)?0:2}Pt(e,t){const i=this.Ge.getRemoteKeysForTarget(t);let l=0;return i.forEach((u=>{const d=this.Ge.ht(),p=`projects/${d.projectId}/databases/${d.database}/documents/${u.path.canonicalString()}`;e.mightContain(p)||(this.et(t,u,null),l++)})),l}Tt(e){const t=new Map;this.ze.forEach(((u,d)=>{const p=this.ot(d);if(p){if(u.current&&kg(p.target)){const g=new Ut(p.target.path);this.It(g).has(d)||this.Et(d,g)||this.et(d,g,or.newNoDocument(g,e))}u.Be&&(t.set(d,u.ke()),u.Ke())}}));let i=Es();this.Je.forEach(((u,d)=>{let p=!0;d.forEachWhile((g=>{const y=this.ot(g);return!y||y.purpose==="TargetPurposeLimboResolution"||(p=!1,!1)})),p&&(i=i.add(u))})),this.je.forEach(((u,d)=>d.setReadTime(e)));const l=new bm(e,t,this.Ze,this.je,i);return this.je=Si(),this.He=ch(),this.Je=ch(),this.Ze=new mn(Ss),l}Ye(e,t){if(!this.rt(e))return;const i=this.Et(e,t.key)?2:0;this.nt(e).qe(t.key,i),this.je=this.je.insert(t.key,t),this.He=this.He.insert(t.key,this.It(t.key).add(e)),this.Je=this.Je.insert(t.key,this.Rt(t.key).add(e))}et(e,t,i){if(!this.rt(e))return;const l=this.nt(e);this.Et(e,t)?l.qe(t,1):l.Ue(t),this.Je=this.Je.insert(t,this.Rt(t).delete(e)),this.Je=this.Je.insert(t,this.Rt(t).add(e)),i&&(this.je=this.je.insert(t,i))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.nt(e).$e()}nt(e){let t=this.ze.get(e);return t||(t=new qx,this.ze.set(e,t)),t}Rt(e){let t=this.Je.get(e);return t||(t=new Vn(Ss),this.Je=this.Je.insert(e,t)),t}It(e){let t=this.He.get(e);return t||(t=new Vn(Ss),this.He=this.He.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||jt("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new qx),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function ch(){return new mn(Ut.comparator)}function Hx(){return new mn(Ut.comparator)}const TA={asc:"ASCENDING",desc:"DESCENDING"},SA={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},EA={and:"AND",or:"OR"};class NA{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Tg(n,e){return n.useProto3Json||um(e)?e:{value:e}}function Kh(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function z_(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function CA(n,e){return Kh(n,e.toTimestamp())}function Wa(n){return qs(!!n,49232),ts.fromTimestamp((function(t){const i=yo(t);return new Mt(i.seconds,i.nanos)})(n))}function yy(n,e){return Sg(n,e).canonicalString()}function Sg(n,e){const t=(function(l){return new en(["projects",l.projectId,"databases",l.database])})(n).child("documents");return e===void 0?t:t.child(e)}function q_(n){const e=en.fromString(n);return qs(K_(e),10190,{key:e.toString()}),e}function Eg(n,e){return yy(n.databaseId,e.path)}function Vp(n,e){const t=q_(e);if(t.get(1)!==n.databaseId.projectId)throw new pt(Pe.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new pt(Pe.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new Ut($_(t))}function H_(n,e){return yy(n.databaseId,e)}function RA(n){const e=q_(n);return e.length===4?en.emptyPath():$_(e)}function Ng(n){return new en(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function $_(n){return qs(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function $x(n,e,t){return{name:Eg(n,e),fields:t.value.mapValue.fields}}function AA(n,e){let t;if("targetChange"in e){e.targetChange;const i=(function(y){return y==="NO_CHANGE"?0:y==="ADD"?1:y==="REMOVE"?2:y==="CURRENT"?3:y==="RESET"?4:Xt(39313,{state:y})})(e.targetChange.targetChangeType||"NO_CHANGE"),l=e.targetChange.targetIds||[],u=(function(y,x){return y.useProto3Json?(qs(x===void 0||typeof x=="string",58123),er.fromBase64String(x||"")):(qs(x===void 0||x instanceof Buffer||x instanceof Uint8Array,16193),er.fromUint8Array(x||new Uint8Array))})(n,e.targetChange.resumeToken),d=e.targetChange.cause,p=d&&(function(y){const x=y.code===void 0?Pe.UNKNOWN:V_(y.code);return new pt(x,y.message||"")})(d);t=new F_(i,l,u,p||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const l=Vp(n,i.document.name),u=Wa(i.document.updateTime),d=i.document.createTime?Wa(i.document.createTime):ts.min(),p=new Mr({mapValue:{fields:i.document.fields}}),g=or.newFoundDocument(l,u,d,p),y=i.targetIds||[],x=i.removedTargetIds||[];t=new Rh(y,x,g.key,g)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const l=Vp(n,i.document),u=i.readTime?Wa(i.readTime):ts.min(),d=or.newNoDocument(l,u),p=i.removedTargetIds||[];t=new Rh([],p,d.key,d)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const l=Vp(n,i.document),u=i.removedTargetIds||[];t=new Rh([],u,l,null)}else{if(!("filter"in e))return Xt(11601,{Vt:e});{e.filter;const i=e.filter;i.targetId;const{count:l=0,unchangedNames:u}=i,d=new xA(l,u),p=i.targetId;t=new U_(p,d)}}return t}function MA(n,e){let t;if(e instanceof $u)t={update:$x(n,e.key,e.value)};else if(e instanceof ym)t={delete:Eg(n,e.key)};else if(e instanceof To)t={update:$x(n,e.key,e.data),updateMask:FA(e.fieldMask)};else{if(!(e instanceof yA))return Xt(16599,{dt:e.type});t={verify:Eg(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((i=>(function(u,d){const p=d.transform;if(p instanceof Au)return{fieldPath:d.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(p instanceof Mu)return{fieldPath:d.field.canonicalString(),appendMissingElements:{values:p.elements}};if(p instanceof Iu)return{fieldPath:d.field.canonicalString(),removeAllFromArray:{values:p.elements}};if(p instanceof Du)return{fieldPath:d.field.canonicalString(),increment:p.Ae};throw Xt(20930,{transform:d.transform})})(0,i)))),e.precondition.isNone||(t.currentDocument=(function(l,u){return u.updateTime!==void 0?{updateTime:CA(l,u.updateTime)}:u.exists!==void 0?{exists:u.exists}:Xt(27497)})(n,e.precondition)),t}function IA(n,e){return n&&n.length>0?(qs(e!==void 0,14353),n.map((t=>(function(l,u){let d=l.updateTime?Wa(l.updateTime):Wa(u);return d.isEqual(ts.min())&&(d=Wa(u)),new fA(d,l.transformResults||[])})(t,e)))):[]}function DA(n,e){return{documents:[H_(n,e.path)]}}function PA(n,e){const t={structuredQuery:{}},i=e.path;let l;e.collectionGroup!==null?(l=i,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(l=i.popLast(),t.structuredQuery.from=[{collectionId:i.lastSegment()}]),t.parent=H_(n,l);const u=(function(y){if(y.length!==0)return G_(ja.create(y,"and"))})(e.filters);u&&(t.structuredQuery.where=u);const d=(function(y){if(y.length!==0)return y.map((x=>(function(j){return{field:Gl(j.field),direction:BA(j.dir)}})(x)))})(e.orderBy);d&&(t.structuredQuery.orderBy=d);const p=Tg(n,e.limit);return p!==null&&(t.structuredQuery.limit=p),e.startAt&&(t.structuredQuery.startAt=(function(y){return{before:y.inclusive,values:y.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(y){return{before:!y.inclusive,values:y.position}})(e.endAt)),{ft:t,parent:l}}function LA(n){let e=RA(n.parent);const t=n.structuredQuery,i=t.from?t.from.length:0;let l=null;if(i>0){qs(i===1,65062);const x=t.from[0];x.allDescendants?l=x.collectionId:e=e.child(x.collectionId)}let u=[];t.where&&(u=(function(_){const j=W_(_);return j instanceof ja&&x_(j)?j.getFilters():[j]})(t.where));let d=[];t.orderBy&&(d=(function(_){return _.map((j=>(function(K){return new Ru(Kl(K.field),(function(D){switch(D){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(K.direction))})(j)))})(t.orderBy));let p=null;t.limit&&(p=(function(_){let j;return j=typeof _=="object"?_.value:_,um(j)?null:j})(t.limit));let g=null;t.startAt&&(g=(function(_){const j=!!_.before,O=_.values||[];return new Wh(O,j)})(t.startAt));let y=null;return t.endAt&&(y=(function(_){const j=!_.before,O=_.values||[];return new Wh(O,j)})(t.endAt)),eA(e,l,d,u,p,"F",g,y)}function OA(n,e){const t=(function(l){switch(l){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Xt(28987,{purpose:l})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function W_(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const i=Kl(t.unaryFilter.field);return Dn.create(i,"==",{doubleValue:NaN});case"IS_NULL":const l=Kl(t.unaryFilter.field);return Dn.create(l,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const u=Kl(t.unaryFilter.field);return Dn.create(u,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const d=Kl(t.unaryFilter.field);return Dn.create(d,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Xt(61313);default:return Xt(60726)}})(n):n.fieldFilter!==void 0?(function(t){return Dn.create(Kl(t.fieldFilter.field),(function(l){switch(l){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Xt(58110);default:return Xt(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return ja.create(t.compositeFilter.filters.map((i=>W_(i))),(function(l){switch(l){case"AND":return"and";case"OR":return"or";default:return Xt(1026)}})(t.compositeFilter.op))})(n):Xt(30097,{filter:n})}function BA(n){return TA[n]}function VA(n){return SA[n]}function UA(n){return EA[n]}function Gl(n){return{fieldPath:n.canonicalString()}}function Kl(n){return Zn.fromServerFormat(n.fieldPath)}function G_(n){return n instanceof Dn?(function(t){if(t.op==="=="){if(Mx(t.value))return{unaryFilter:{field:Gl(t.field),op:"IS_NAN"}};if(Ax(t.value))return{unaryFilter:{field:Gl(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(Mx(t.value))return{unaryFilter:{field:Gl(t.field),op:"IS_NOT_NAN"}};if(Ax(t.value))return{unaryFilter:{field:Gl(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Gl(t.field),op:VA(t.op),value:t.value}}})(n):n instanceof ja?(function(t){const i=t.getFilters().map((l=>G_(l)));return i.length===1?i[0]:{compositeFilter:{op:UA(t.op),filters:i}}})(n):Xt(54877,{filter:n})}function FA(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function K_(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}function Y_(n){return!!n&&typeof n._toProto=="function"&&n._protoValueType==="ProtoValue"}class lo{constructor(e,t,i,l,u=ts.min(),d=ts.min(),p=er.EMPTY_BYTE_STRING,g=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=l,this.snapshotVersion=u,this.lastLimboFreeSnapshotVersion=d,this.resumeToken=p,this.expectedCount=g}withSequenceNumber(e){return new lo(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new lo(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new lo(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new lo(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class zA{constructor(e){this.yt=e}}function qA(n){const e=LA({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Gh(e,e.limit,"L"):e}class HA{constructor(){this.Sn=new $A}addToCollectionParentIndex(e,t){return this.Sn.add(t),$e.resolve()}getCollectionParents(e,t){return $e.resolve(this.Sn.getEntries(t))}addFieldIndex(e,t){return $e.resolve()}deleteFieldIndex(e,t){return $e.resolve()}deleteAllFieldIndexes(e){return $e.resolve()}createTargetIndexes(e,t){return $e.resolve()}getDocumentsMatchingTarget(e,t){return $e.resolve(null)}getIndexType(e,t){return $e.resolve(0)}getFieldIndexes(e,t){return $e.resolve([])}getNextCollectionGroupToUpdate(e){return $e.resolve(null)}getMinOffset(e,t){return $e.resolve(go.min())}getMinOffsetFromCollectionGroup(e,t){return $e.resolve(go.min())}updateCollectionGroup(e,t,i){return $e.resolve()}updateIndexEntries(e,t){return $e.resolve()}}class $A{constructor(){this.index={}}add(e){const t=e.lastSegment(),i=e.popLast(),l=this.index[t]||new Vn(en.comparator),u=!l.has(i);return this.index[t]=l.add(i),u}has(e){const t=e.lastSegment(),i=e.popLast(),l=this.index[t];return l&&l.has(i)}getEntries(e){return(this.index[e]||new Vn(en.comparator)).toArray()}}const Wx={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Q_=41943040;class Ar{static withCacheSize(e){return new Ar(e,Ar.DEFAULT_COLLECTION_PERCENTILE,Ar.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}}Ar.DEFAULT_COLLECTION_PERCENTILE=10,Ar.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Ar.DEFAULT=new Ar(Q_,Ar.DEFAULT_COLLECTION_PERCENTILE,Ar.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Ar.DISABLED=new Ar(-1,0,0);class ac{constructor(e){this.sr=e}next(){return this.sr+=2,this.sr}static _r(){return new ac(0)}static ar(){return new ac(-1)}}const Gx="LruGarbageCollector",WA=1048576;function Kx([n,e],[t,i]){const l=Ss(n,t);return l===0?Ss(e,i):l}class GA{constructor(e){this.Pr=e,this.buffer=new Vn(Kx),this.Tr=0}Ir(){return++this.Tr}Er(e){const t=[e,this.Ir()];if(this.buffer.size<this.Pr)this.buffer=this.buffer.add(t);else{const i=this.buffer.last();Kx(t,i)<0&&(this.buffer=this.buffer.delete(i).add(t))}}get maxValue(){return this.buffer.last()[0]}}class KA{constructor(e,t,i){this.garbageCollector=e,this.asyncQueue=t,this.localStore=i,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Ar(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Ar(e){jt(Gx,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){fc(t)?jt(Gx,"Ignoring IndexedDB error during garbage collection: ",t):await mc(t)}await this.Ar(3e5)}))}}class YA{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.dr(e).next((i=>Math.floor(t/100*i)))}nthSequenceNumber(e,t){if(t===0)return $e.resolve(cm.ce);const i=new GA(t);return this.Vr.forEachTarget(e,(l=>i.Er(l.sequenceNumber))).next((()=>this.Vr.mr(e,(l=>i.Er(l))))).next((()=>i.maxValue))}removeTargets(e,t,i){return this.Vr.removeTargets(e,t,i)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(jt("LruGarbageCollector","Garbage collection skipped; disabled"),$e.resolve(Wx)):this.getCacheSize(e).next((i=>i<this.params.cacheSizeCollectionThreshold?(jt("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Wx):this.gr(e,t)))}getCacheSize(e){return this.Vr.getCacheSize(e)}gr(e,t){let i,l,u,d,p,g,y;const x=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((_=>(_>this.params.maximumSequenceNumbersToCollect?(jt("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${_}`),l=this.params.maximumSequenceNumbersToCollect):l=_,d=Date.now(),this.nthSequenceNumber(e,l)))).next((_=>(i=_,p=Date.now(),this.removeTargets(e,i,t)))).next((_=>(u=_,g=Date.now(),this.removeOrphanedDocuments(e,i)))).next((_=>(y=Date.now(),$l()<=js.DEBUG&&jt("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${d-x}ms
	Determined least recently used ${l} in `+(p-d)+`ms
	Removed ${u} targets in `+(g-p)+`ms
	Removed ${_} documents in `+(y-g)+`ms
Total Duration: ${y-x}ms`),$e.resolve({didRun:!0,sequenceNumbersCollected:l,targetsRemoved:u,documentsRemoved:_}))))}}function QA(n,e){return new YA(n,e)}class XA{constructor(){this.changes=new ll((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,or.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const i=this.changes.get(t);return i!==void 0?$e.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class JA{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class ZA{constructor(e,t,i,l){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=l}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next((l=>(i=l,this.remoteDocumentCache.getEntry(e,t)))).next((l=>(i!==null&&xu(i.mutation,l,Wr.empty(),Mt.now()),l)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.getLocalViewOfDocuments(e,i,Es()).next((()=>i))))}getLocalViewOfDocuments(e,t,i=Es()){const l=Ko();return this.populateOverlays(e,l,t).next((()=>this.computeViews(e,t,l,i).next((u=>{let d=hu();return u.forEach(((p,g)=>{d=d.insert(p,g.overlayedDocument)})),d}))))}getOverlayedDocuments(e,t){const i=Ko();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,Es())))}populateOverlays(e,t,i){const l=[];return i.forEach((u=>{t.has(u)||l.push(u)})),this.documentOverlayCache.getOverlays(e,l).next((u=>{u.forEach(((d,p)=>{t.set(d,p)}))}))}computeViews(e,t,i,l){let u=Si();const d=vu(),p=(function(){return vu()})();return t.forEach(((g,y)=>{const x=i.get(y.key);l.has(y.key)&&(x===void 0||x.mutation instanceof To)?u=u.insert(y.key,y):x!==void 0?(d.set(y.key,x.mutation.getFieldMask()),xu(x.mutation,y,x.mutation.getFieldMask(),Mt.now())):d.set(y.key,Wr.empty())})),this.recalculateAndSaveOverlays(e,u).next((g=>(g.forEach(((y,x)=>d.set(y,x))),t.forEach(((y,x)=>p.set(y,new JA(x,d.get(y)??null)))),p)))}recalculateAndSaveOverlays(e,t){const i=vu();let l=new mn(((d,p)=>d-p)),u=Es();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((d=>{for(const p of d)p.keys().forEach((g=>{const y=t.get(g);if(y===null)return;let x=i.get(g)||Wr.empty();x=p.applyToLocalView(y,x),i.set(g,x);const _=(l.get(p.batchId)||Es()).add(g);l=l.insert(p.batchId,_)}))})).next((()=>{const d=[],p=l.getReverseIterator();for(;p.hasNext();){const g=p.getNext(),y=g.key,x=g.value,_=C_();x.forEach((j=>{if(!u.has(j)){const O=O_(t.get(j),i.get(j));O!==null&&_.set(j,O),u=u.add(j)}})),d.push(this.documentOverlayCache.saveOverlays(e,y,_))}return $e.waitFor(d)})).next((()=>i))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.recalculateAndSaveOverlays(e,i)))}getDocumentsMatchingQuery(e,t,i,l){return tA(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):j_(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i,l):this.getDocumentsMatchingCollectionQuery(e,t,i,l)}getNextDocuments(e,t,i,l){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,l).next((u=>{const d=l-u.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,l-u.size):$e.resolve(Ko());let p=Su,g=u;return d.next((y=>$e.forEach(y,((x,_)=>(p<_.largestBatchId&&(p=_.largestBatchId),u.get(x)?$e.resolve():this.remoteDocumentCache.getEntry(e,x).next((j=>{g=g.insert(x,j)}))))).next((()=>this.populateOverlays(e,y,u))).next((()=>this.computeViews(e,g,y,Es()))).next((x=>({batchId:p,changes:N_(x)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Ut(t)).next((i=>{let l=hu();return i.isFoundDocument()&&(l=l.insert(i.key,i)),l}))}getDocumentsMatchingCollectionGroupQuery(e,t,i,l){const u=t.collectionGroup;let d=hu();return this.indexManager.getCollectionParents(e,u).next((p=>$e.forEach(p,(g=>{const y=(function(_,j){return new pc(j,null,_.explicitOrderBy.slice(),_.filters.slice(),_.limit,_.limitType,_.startAt,_.endAt)})(t,g.child(u));return this.getDocumentsMatchingCollectionQuery(e,y,i,l).next((x=>{x.forEach(((_,j)=>{d=d.insert(_,j)}))}))})).next((()=>d))))}getDocumentsMatchingCollectionQuery(e,t,i,l){let u;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next((d=>(u=d,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,u,l)))).next((d=>{u.forEach(((g,y)=>{const x=y.getKey();d.get(x)===null&&(d=d.insert(x,or.newInvalidDocument(x)))}));let p=hu();return d.forEach(((g,y)=>{const x=u.get(g);x!==void 0&&xu(x.mutation,y,Wr.empty(),Mt.now()),fm(t,y)&&(p=p.insert(g,y))})),p}))}}class e3{constructor(e){this.serializer=e,this.Nr=new Map,this.Br=new Map}getBundleMetadata(e,t){return $e.resolve(this.Nr.get(t))}saveBundleMetadata(e,t){return this.Nr.set(t.id,(function(l){return{id:l.id,version:l.version,createTime:Wa(l.createTime)}})(t)),$e.resolve()}getNamedQuery(e,t){return $e.resolve(this.Br.get(t))}saveNamedQuery(e,t){return this.Br.set(t.name,(function(l){return{name:l.name,query:qA(l.bundledQuery),readTime:Wa(l.readTime)}})(t)),$e.resolve()}}class t3{constructor(){this.overlays=new mn(Ut.comparator),this.Lr=new Map}getOverlay(e,t){return $e.resolve(this.overlays.get(t))}getOverlays(e,t){const i=Ko();return $e.forEach(t,(l=>this.getOverlay(e,l).next((u=>{u!==null&&i.set(l,u)})))).next((()=>i))}saveOverlays(e,t,i){return i.forEach(((l,u)=>{this.bt(e,t,u)})),$e.resolve()}removeOverlaysForBatchId(e,t,i){const l=this.Lr.get(i);return l!==void 0&&(l.forEach((u=>this.overlays=this.overlays.remove(u))),this.Lr.delete(i)),$e.resolve()}getOverlaysForCollection(e,t,i){const l=Ko(),u=t.length+1,d=new Ut(t.child("")),p=this.overlays.getIteratorFrom(d);for(;p.hasNext();){const g=p.getNext().value,y=g.getKey();if(!t.isPrefixOf(y.path))break;y.path.length===u&&g.largestBatchId>i&&l.set(g.getKey(),g)}return $e.resolve(l)}getOverlaysForCollectionGroup(e,t,i,l){let u=new mn(((y,x)=>y-x));const d=this.overlays.getIterator();for(;d.hasNext();){const y=d.getNext().value;if(y.getKey().getCollectionGroup()===t&&y.largestBatchId>i){let x=u.get(y.largestBatchId);x===null&&(x=Ko(),u=u.insert(y.largestBatchId,x)),x.set(y.getKey(),y)}}const p=Ko(),g=u.getIterator();for(;g.hasNext()&&(g.getNext().value.forEach(((y,x)=>p.set(y,x))),!(p.size()>=l)););return $e.resolve(p)}bt(e,t,i){const l=this.overlays.get(i.key);if(l!==null){const d=this.Lr.get(l.largestBatchId).delete(i.key);this.Lr.set(l.largestBatchId,d)}this.overlays=this.overlays.insert(i.key,new vA(t,i));let u=this.Lr.get(t);u===void 0&&(u=Es(),this.Lr.set(t,u)),this.Lr.set(t,u.add(i.key))}}class s3{constructor(){this.sessionToken=er.EMPTY_BYTE_STRING}getSessionToken(e){return $e.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,$e.resolve()}}class by{constructor(){this.kr=new Vn(Hn.Kr),this.qr=new Vn(Hn.Ur)}isEmpty(){return this.kr.isEmpty()}addReference(e,t){const i=new Hn(e,t);this.kr=this.kr.add(i),this.qr=this.qr.add(i)}$r(e,t){e.forEach((i=>this.addReference(i,t)))}removeReference(e,t){this.Wr(new Hn(e,t))}Qr(e,t){e.forEach((i=>this.removeReference(i,t)))}Gr(e){const t=new Ut(new en([])),i=new Hn(t,e),l=new Hn(t,e+1),u=[];return this.qr.forEachInRange([i,l],(d=>{this.Wr(d),u.push(d.key)})),u}zr(){this.kr.forEach((e=>this.Wr(e)))}Wr(e){this.kr=this.kr.delete(e),this.qr=this.qr.delete(e)}jr(e){const t=new Ut(new en([])),i=new Hn(t,e),l=new Hn(t,e+1);let u=Es();return this.qr.forEachInRange([i,l],(d=>{u=u.add(d.key)})),u}containsKey(e){const t=new Hn(e,0),i=this.kr.firstAfterOrEqual(t);return i!==null&&e.isEqual(i.key)}}class Hn{constructor(e,t){this.key=e,this.Hr=t}static Kr(e,t){return Ut.comparator(e.key,t.key)||Ss(e.Hr,t.Hr)}static Ur(e,t){return Ss(e.Hr,t.Hr)||Ut.comparator(e.key,t.key)}}class n3{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Yn=1,this.Jr=new Vn(Hn.Kr)}checkEmpty(e){return $e.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,i,l){const u=this.Yn;this.Yn++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const d=new bA(u,t,i,l);this.mutationQueue.push(d);for(const p of l)this.Jr=this.Jr.add(new Hn(p.key,u)),this.indexManager.addToCollectionParentIndex(e,p.key.path.popLast());return $e.resolve(d)}lookupMutationBatch(e,t){return $e.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,l=this.Xr(i),u=l<0?0:l;return $e.resolve(this.mutationQueue.length>u?this.mutationQueue[u]:null)}getHighestUnacknowledgedBatchId(){return $e.resolve(this.mutationQueue.length===0?cy:this.Yn-1)}getAllMutationBatches(e){return $e.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const i=new Hn(t,0),l=new Hn(t,Number.POSITIVE_INFINITY),u=[];return this.Jr.forEachInRange([i,l],(d=>{const p=this.Zr(d.Hr);u.push(p)})),$e.resolve(u)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new Vn(Ss);return t.forEach((l=>{const u=new Hn(l,0),d=new Hn(l,Number.POSITIVE_INFINITY);this.Jr.forEachInRange([u,d],(p=>{i=i.add(p.Hr)}))})),$e.resolve(this.Yr(i))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,l=i.length+1;let u=i;Ut.isDocumentKey(u)||(u=u.child(""));const d=new Hn(new Ut(u),0);let p=new Vn(Ss);return this.Jr.forEachWhile((g=>{const y=g.key.path;return!!i.isPrefixOf(y)&&(y.length===l&&(p=p.add(g.Hr)),!0)}),d),$e.resolve(this.Yr(p))}Yr(e){const t=[];return e.forEach((i=>{const l=this.Zr(i);l!==null&&t.push(l)})),t}removeMutationBatch(e,t){qs(this.ei(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.Jr;return $e.forEach(t.mutations,(l=>{const u=new Hn(l.key,t.batchId);return i=i.delete(u),this.referenceDelegate.markPotentiallyOrphaned(e,l.key)})).next((()=>{this.Jr=i}))}nr(e){}containsKey(e,t){const i=new Hn(t,0),l=this.Jr.firstAfterOrEqual(i);return $e.resolve(t.isEqual(l&&l.key))}performConsistencyCheck(e){return this.mutationQueue.length,$e.resolve()}ei(e,t){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class r3{constructor(e){this.ti=e,this.docs=(function(){return new mn(Ut.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const i=t.key,l=this.docs.get(i),u=l?l.size:0,d=this.ti(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:d}),this.size+=d-u,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const i=this.docs.get(t);return $e.resolve(i?i.document.mutableCopy():or.newInvalidDocument(t))}getEntries(e,t){let i=Si();return t.forEach((l=>{const u=this.docs.get(l);i=i.insert(l,u?u.document.mutableCopy():or.newInvalidDocument(l))})),$e.resolve(i)}getDocumentsMatchingQuery(e,t,i,l){let u=Si();const d=t.path,p=new Ut(d.child("__id-9223372036854775808__")),g=this.docs.getIteratorFrom(p);for(;g.hasNext();){const{key:y,value:{document:x}}=g.getNext();if(!d.isPrefixOf(y.path))break;y.path.length>d.length+1||AR(RR(x),i)<=0||(l.has(x.key)||fm(t,x))&&(u=u.insert(x.key,x.mutableCopy()))}return $e.resolve(u)}getAllFromCollectionGroup(e,t,i,l){Xt(9500)}ni(e,t){return $e.forEach(this.docs,(i=>t(i)))}newChangeBuffer(e){return new a3(this)}getSize(e){return $e.resolve(this.size)}}class a3 extends XA{constructor(e){super(),this.Mr=e}applyChanges(e){const t=[];return this.changes.forEach(((i,l)=>{l.isValidDocument()?t.push(this.Mr.addEntry(e,l)):this.Mr.removeEntry(i)})),$e.waitFor(t)}getFromCache(e,t){return this.Mr.getEntry(e,t)}getAllFromCache(e,t){return this.Mr.getEntries(e,t)}}class i3{constructor(e){this.persistence=e,this.ri=new ll((t=>hy(t)),my),this.lastRemoteSnapshotVersion=ts.min(),this.highestTargetId=0,this.ii=0,this.si=new by,this.targetCount=0,this.oi=ac._r()}forEachTarget(e,t){return this.ri.forEach(((i,l)=>t(l))),$e.resolve()}getLastRemoteSnapshotVersion(e){return $e.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return $e.resolve(this.ii)}allocateTargetId(e){return this.highestTargetId=this.oi.next(),$e.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.ii&&(this.ii=t),$e.resolve()}lr(e){this.ri.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.oi=new ac(t),this.highestTargetId=t),e.sequenceNumber>this.ii&&(this.ii=e.sequenceNumber)}addTargetData(e,t){return this.lr(t),this.targetCount+=1,$e.resolve()}updateTargetData(e,t){return this.lr(t),$e.resolve()}removeTargetData(e,t){return this.ri.delete(t.target),this.si.Gr(t.targetId),this.targetCount-=1,$e.resolve()}removeTargets(e,t,i){let l=0;const u=[];return this.ri.forEach(((d,p)=>{p.sequenceNumber<=t&&i.get(p.targetId)===null&&(this.ri.delete(d),u.push(this.removeMatchingKeysForTargetId(e,p.targetId)),l++)})),$e.waitFor(u).next((()=>l))}getTargetCount(e){return $e.resolve(this.targetCount)}getTargetData(e,t){const i=this.ri.get(t)||null;return $e.resolve(i)}addMatchingKeys(e,t,i){return this.si.$r(t,i),$e.resolve()}removeMatchingKeys(e,t,i){this.si.Qr(t,i);const l=this.persistence.referenceDelegate,u=[];return l&&t.forEach((d=>{u.push(l.markPotentiallyOrphaned(e,d))})),$e.waitFor(u)}removeMatchingKeysForTargetId(e,t){return this.si.Gr(t),$e.resolve()}getMatchingKeysForTargetId(e,t){const i=this.si.jr(t);return $e.resolve(i)}containsKey(e,t){return $e.resolve(this.si.containsKey(t))}}class X_{constructor(e,t){this._i={},this.overlays={},this.ai=new cm(0),this.ui=!1,this.ui=!0,this.ci=new s3,this.referenceDelegate=e(this),this.li=new i3(this),this.indexManager=new HA,this.remoteDocumentCache=(function(l){return new r3(l)})((i=>this.referenceDelegate.hi(i))),this.serializer=new zA(t),this.Pi=new e3(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ui=!1,Promise.resolve()}get started(){return this.ui}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new t3,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this._i[e.toKey()];return i||(i=new n3(t,this.referenceDelegate),this._i[e.toKey()]=i),i}getGlobalsCache(){return this.ci}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Pi}runTransaction(e,t,i){jt("MemoryPersistence","Starting transaction:",e);const l=new o3(this.ai.next());return this.referenceDelegate.Ti(),i(l).next((u=>this.referenceDelegate.Ii(l).next((()=>u)))).toPromise().then((u=>(l.raiseOnCommittedEvent(),u)))}Ei(e,t){return $e.or(Object.values(this._i).map((i=>()=>i.containsKey(e,t))))}}class o3 extends IR{constructor(e){super(),this.currentSequenceNumber=e}}class vy{constructor(e){this.persistence=e,this.Ri=new by,this.Ai=null}static Vi(e){return new vy(e)}get di(){if(this.Ai)return this.Ai;throw Xt(60996)}addReference(e,t,i){return this.Ri.addReference(i,t),this.di.delete(i.toString()),$e.resolve()}removeReference(e,t,i){return this.Ri.removeReference(i,t),this.di.add(i.toString()),$e.resolve()}markPotentiallyOrphaned(e,t){return this.di.add(t.toString()),$e.resolve()}removeTarget(e,t){this.Ri.Gr(t.targetId).forEach((l=>this.di.add(l.toString())));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next((l=>{l.forEach((u=>this.di.add(u.toString())))})).next((()=>i.removeTargetData(e,t)))}Ti(){this.Ai=new Set}Ii(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return $e.forEach(this.di,(i=>{const l=Ut.fromPath(i);return this.mi(e,l).next((u=>{u||t.removeEntry(l,ts.min())}))})).next((()=>(this.Ai=null,t.apply(e))))}updateLimboDocument(e,t){return this.mi(e,t).next((i=>{i?this.di.delete(t.toString()):this.di.add(t.toString())}))}hi(e){return 0}mi(e,t){return $e.or([()=>$e.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}}class Yh{constructor(e,t){this.persistence=e,this.fi=new ll((i=>LR(i.path)),((i,l)=>i.isEqual(l))),this.garbageCollector=QA(this,t)}static Vi(e,t){return new Yh(e,t)}Ti(){}Ii(e){return $e.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}dr(e){const t=this.pr(e);return this.persistence.getTargetCache().getTargetCount(e).next((i=>t.next((l=>i+l))))}pr(e){let t=0;return this.mr(e,(i=>{t++})).next((()=>t))}mr(e,t){return $e.forEach(this.fi,((i,l)=>this.wr(e,i,l).next((u=>u?$e.resolve():t(l)))))}removeTargets(e,t,i){return this.persistence.getTargetCache().removeTargets(e,t,i)}removeOrphanedDocuments(e,t){let i=0;const l=this.persistence.getRemoteDocumentCache(),u=l.newChangeBuffer();return l.ni(e,(d=>this.wr(e,d,t).next((p=>{p||(i++,u.removeEntry(d,ts.min()))})))).next((()=>u.apply(e))).next((()=>i))}markPotentiallyOrphaned(e,t){return this.fi.set(t,e.currentSequenceNumber),$e.resolve()}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,i)}addReference(e,t,i){return this.fi.set(i,e.currentSequenceNumber),$e.resolve()}removeReference(e,t,i){return this.fi.set(i,e.currentSequenceNumber),$e.resolve()}updateLimboDocument(e,t){return this.fi.set(t,e.currentSequenceNumber),$e.resolve()}hi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Eh(e.data.value)),t}wr(e,t,i){return $e.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const l=this.fi.get(t);return $e.resolve(l!==void 0&&l>i)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class xy{constructor(e,t,i,l){this.targetId=e,this.fromCache=t,this.Ts=i,this.Is=l}static Es(e,t){let i=Es(),l=Es();for(const u of t.docChanges)switch(u.type){case 0:i=i.add(u.doc.key);break;case 1:l=l.add(u.doc.key)}return new xy(e,t.fromCache,i,l)}}class l3{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class c3{constructor(){this.Rs=!1,this.As=!1,this.Vs=100,this.ds=(function(){return LE()?8:DR(cr())>0?6:4})()}initialize(e,t){this.fs=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,i,l){const u={result:null};return this.gs(e,t).next((d=>{u.result=d})).next((()=>{if(!u.result)return this.ps(e,t,l,i).next((d=>{u.result=d}))})).next((()=>{if(u.result)return;const d=new l3;return this.ys(e,t,d).next((p=>{if(u.result=p,this.As)return this.ws(e,t,d,p.size)}))})).next((()=>u.result))}ws(e,t,i,l){return i.documentReadCount<this.Vs?($l()<=js.DEBUG&&jt("QueryEngine","SDK will not create cache indexes for query:",Wl(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),$e.resolve()):($l()<=js.DEBUG&&jt("QueryEngine","Query:",Wl(t),"scans",i.documentReadCount,"local documents and returns",l,"documents as results."),i.documentReadCount>this.ds*l?($l()<=js.DEBUG&&jt("QueryEngine","The SDK decides to create cache indexes for query:",Wl(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,$a(t))):$e.resolve())}gs(e,t){if(Lx(t))return $e.resolve(null);let i=$a(t);return this.indexManager.getIndexType(e,i).next((l=>l===0?null:(t.limit!==null&&l===1&&(t=Gh(t,null,"F"),i=$a(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next((u=>{const d=Es(...u);return this.fs.getDocuments(e,d).next((p=>this.indexManager.getMinOffset(e,i).next((g=>{const y=this.bs(t,p);return this.Ss(t,y,d,g.readTime)?this.gs(e,Gh(t,null,"F")):this.Ds(e,y,t,g)}))))})))))}ps(e,t,i,l){return Lx(t)||l.isEqual(ts.min())?$e.resolve(null):this.fs.getDocuments(e,i).next((u=>{const d=this.bs(t,u);return this.Ss(t,d,i,l)?$e.resolve(null):($l()<=js.DEBUG&&jt("QueryEngine","Re-using previous result from %s to execute query: %s",l.toString(),Wl(t)),this.Ds(e,d,t,CR(l,Su)).next((p=>p)))}))}bs(e,t){let i=new Vn(S_(e));return t.forEach(((l,u)=>{fm(e,u)&&(i=i.add(u))})),i}Ss(e,t,i,l){if(e.limit===null)return!1;if(i.size!==t.size)return!0;const u=e.limitType==="F"?t.last():t.first();return!!u&&(u.hasPendingWrites||u.version.compareTo(l)>0)}ys(e,t,i){return $l()<=js.DEBUG&&jt("QueryEngine","Using full collection scan to execute query:",Wl(t)),this.fs.getDocumentsMatchingQuery(e,t,go.min(),i)}Ds(e,t,i,l){return this.fs.getDocumentsMatchingQuery(e,i,l).next((u=>(t.forEach((d=>{u=u.insert(d.key,d)})),u)))}}const wy="LocalStore",u3=3e8;class d3{constructor(e,t,i,l){this.persistence=e,this.Cs=t,this.serializer=l,this.vs=new mn(Ss),this.Fs=new ll((u=>hy(u)),my),this.Ms=new Map,this.xs=e.getRemoteDocumentCache(),this.li=e.getTargetCache(),this.Pi=e.getBundleCache(),this.Os(i)}Os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new ZA(this.xs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.xs.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.vs)))}}function h3(n,e,t,i){return new d3(n,e,t,i)}async function J_(n,e){const t=as(n);return await t.persistence.runTransaction("Handle user change","readonly",(i=>{let l;return t.mutationQueue.getAllMutationBatches(i).next((u=>(l=u,t.Os(e),t.mutationQueue.getAllMutationBatches(i)))).next((u=>{const d=[],p=[];let g=Es();for(const y of l){d.push(y.batchId);for(const x of y.mutations)g=g.add(x.key)}for(const y of u){p.push(y.batchId);for(const x of y.mutations)g=g.add(x.key)}return t.localDocuments.getDocuments(i,g).next((y=>({Ns:y,removedBatchIds:d,addedBatchIds:p})))}))}))}function m3(n,e){const t=as(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(i=>{const l=e.batch.keys(),u=t.xs.newChangeBuffer({trackRemovals:!0});return(function(p,g,y,x){const _=y.batch,j=_.keys();let O=$e.resolve();return j.forEach((K=>{O=O.next((()=>x.getEntry(g,K))).next((B=>{const D=y.docVersions.get(K);qs(D!==null,48541),B.version.compareTo(D)<0&&(_.applyToRemoteDocument(B,y),B.isValidDocument()&&(B.setReadTime(y.commitVersion),x.addEntry(B)))}))})),O.next((()=>p.mutationQueue.removeMutationBatch(g,_)))})(t,i,e,u).next((()=>u.apply(i))).next((()=>t.mutationQueue.performConsistencyCheck(i))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(i,l,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,(function(p){let g=Es();for(let y=0;y<p.mutationResults.length;++y)p.mutationResults[y].transformResults.length>0&&(g=g.add(p.batch.mutations[y].key));return g})(e)))).next((()=>t.localDocuments.getDocuments(i,l)))}))}function Z_(n){const e=as(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.li.getLastRemoteSnapshotVersion(t)))}function f3(n,e){const t=as(n),i=e.snapshotVersion;let l=t.vs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(u=>{const d=t.xs.newChangeBuffer({trackRemovals:!0});l=t.vs;const p=[];e.targetChanges.forEach(((x,_)=>{const j=l.get(_);if(!j)return;p.push(t.li.removeMatchingKeys(u,x.removedDocuments,_).next((()=>t.li.addMatchingKeys(u,x.addedDocuments,_))));let O=j.withSequenceNumber(u.currentSequenceNumber);e.targetMismatches.get(_)!==null?O=O.withResumeToken(er.EMPTY_BYTE_STRING,ts.min()).withLastLimboFreeSnapshotVersion(ts.min()):x.resumeToken.approximateByteSize()>0&&(O=O.withResumeToken(x.resumeToken,i)),l=l.insert(_,O),(function(B,D,te){return B.resumeToken.approximateByteSize()===0||D.snapshotVersion.toMicroseconds()-B.snapshotVersion.toMicroseconds()>=u3?!0:te.addedDocuments.size+te.modifiedDocuments.size+te.removedDocuments.size>0})(j,O,x)&&p.push(t.li.updateTargetData(u,O))}));let g=Si(),y=Es();if(e.documentUpdates.forEach((x=>{e.resolvedLimboDocuments.has(x)&&p.push(t.persistence.referenceDelegate.updateLimboDocument(u,x))})),p.push(p3(u,d,e.documentUpdates).next((x=>{g=x.Bs,y=x.Ls}))),!i.isEqual(ts.min())){const x=t.li.getLastRemoteSnapshotVersion(u).next((_=>t.li.setTargetsMetadata(u,u.currentSequenceNumber,i)));p.push(x)}return $e.waitFor(p).next((()=>d.apply(u))).next((()=>t.localDocuments.getLocalViewOfDocuments(u,g,y))).next((()=>g))})).then((u=>(t.vs=l,u)))}function p3(n,e,t){let i=Es(),l=Es();return t.forEach((u=>i=i.add(u))),e.getEntries(n,i).next((u=>{let d=Si();return t.forEach(((p,g)=>{const y=u.get(p);g.isFoundDocument()!==y.isFoundDocument()&&(l=l.add(p)),g.isNoDocument()&&g.version.isEqual(ts.min())?(e.removeEntry(p,g.readTime),d=d.insert(p,g)):!y.isValidDocument()||g.version.compareTo(y.version)>0||g.version.compareTo(y.version)===0&&y.hasPendingWrites?(e.addEntry(g),d=d.insert(p,g)):jt(wy,"Ignoring outdated watch update for ",p,". Current version:",y.version," Watch version:",g.version)})),{Bs:d,Ls:l}}))}function g3(n,e){const t=as(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(i=>(e===void 0&&(e=cy),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e))))}function y3(n,e){const t=as(n);return t.persistence.runTransaction("Allocate target","readwrite",(i=>{let l;return t.li.getTargetData(i,e).next((u=>u?(l=u,$e.resolve(l)):t.li.allocateTargetId(i).next((d=>(l=new lo(e,d,"TargetPurposeListen",i.currentSequenceNumber),t.li.addTargetData(i,l).next((()=>l)))))))})).then((i=>{const l=t.vs.get(i.targetId);return(l===null||i.snapshotVersion.compareTo(l.snapshotVersion)>0)&&(t.vs=t.vs.insert(i.targetId,i),t.Fs.set(e,i.targetId)),i}))}async function Cg(n,e,t){const i=as(n),l=i.vs.get(e),u=t?"readwrite":"readwrite-primary";try{t||await i.persistence.runTransaction("Release target",u,(d=>i.persistence.referenceDelegate.removeTarget(d,l)))}catch(d){if(!fc(d))throw d;jt(wy,`Failed to update sequence numbers for target ${e}: ${d}`)}i.vs=i.vs.remove(e),i.Fs.delete(l.target)}function Yx(n,e,t){const i=as(n);let l=ts.min(),u=Es();return i.persistence.runTransaction("Execute query","readwrite",(d=>(function(g,y,x){const _=as(g),j=_.Fs.get(x);return j!==void 0?$e.resolve(_.vs.get(j)):_.li.getTargetData(y,x)})(i,d,$a(e)).next((p=>{if(p)return l=p.lastLimboFreeSnapshotVersion,i.li.getMatchingKeysForTargetId(d,p.targetId).next((g=>{u=g}))})).next((()=>i.Cs.getDocumentsMatchingQuery(d,e,t?l:ts.min(),t?u:Es()))).next((p=>(b3(i,rA(e),p),{documents:p,ks:u})))))}function b3(n,e,t){let i=n.Ms.get(e)||ts.min();t.forEach(((l,u)=>{u.readTime.compareTo(i)>0&&(i=u.readTime)})),n.Ms.set(e,i)}class Qx{constructor(){this.activeTargetIds=uA()}Qs(e){this.activeTargetIds=this.activeTargetIds.add(e)}Gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class v3{constructor(){this.vo=new Qx,this.Fo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e,t=!0){return t&&this.vo.Qs(e),this.Fo[e]||"not-current"}updateQueryState(e,t,i){this.Fo[e]=t}removeLocalQueryTarget(e){this.vo.Gs(e)}isLocalQueryTarget(e){return this.vo.activeTargetIds.has(e)}clearQueryState(e){delete this.Fo[e]}getAllActiveQueryTargets(){return this.vo.activeTargetIds}isActiveQueryTarget(e){return this.vo.activeTargetIds.has(e)}start(){return this.vo=new Qx,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class x3{Mo(e){}shutdown(){}}const Xx="ConnectivityMonitor";class Jx{constructor(){this.xo=()=>this.Oo(),this.No=()=>this.Bo(),this.Lo=[],this.ko()}Mo(e){this.Lo.push(e)}shutdown(){window.removeEventListener("online",this.xo),window.removeEventListener("offline",this.No)}ko(){window.addEventListener("online",this.xo),window.addEventListener("offline",this.No)}Oo(){jt(Xx,"Network connectivity changed: AVAILABLE");for(const e of this.Lo)e(0)}Bo(){jt(Xx,"Network connectivity changed: UNAVAILABLE");for(const e of this.Lo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let uh=null;function Rg(){return uh===null?uh=(function(){return 268435456+Math.round(2147483648*Math.random())})():uh++,"0x"+uh.toString(16)}const Up="RestConnection",w3={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery",ExecutePipeline:"executePipeline"};class _3{get Ko(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),l=encodeURIComponent(this.databaseId.database);this.qo=t+"://"+e.host,this.Uo=`projects/${i}/databases/${l}`,this.$o=this.databaseId.database===Hh?`project_id=${i}`:`project_id=${i}&database_id=${l}`}Wo(e,t,i,l,u){const d=Rg(),p=this.Qo(e,t.toUriEncodedString());jt(Up,`Sending RPC '${e}' ${d}:`,p,i);const g={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.$o};this.Go(g,l,u);const{host:y}=new URL(p),x=_o(y);return this.zo(e,p,g,i,x).then((_=>(jt(Up,`Received RPC '${e}' ${d}: `,_),_)),(_=>{throw tc(Up,`RPC '${e}' ${d} failed with error: `,_,"url: ",p,"request:",i),_}))}jo(e,t,i,l,u,d){return this.Wo(e,t,i,l,u)}Go(e,t,i){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+hc})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((l,u)=>e[u]=l)),i&&i.headers.forEach(((l,u)=>e[u]=l))}Qo(e,t){const i=w3[e];let l=`${this.qo}/v1/${t}:${i}`;return this.databaseInfo.apiKey&&(l=`${l}?key=${encodeURIComponent(this.databaseInfo.apiKey)}`),l}terminate(){}}class k3{constructor(e){this.Ho=e.Ho,this.Jo=e.Jo}Zo(e){this.Xo=e}Yo(e){this.e_=e}t_(e){this.n_=e}onMessage(e){this.r_=e}close(){this.Jo()}send(e){this.Ho(e)}i_(){this.Xo()}s_(){this.e_()}o_(e){this.n_(e)}__(e){this.r_(e)}}const ar="WebChannelConnection",nu=(n,e,t)=>{n.listen(e,(i=>{try{t(i)}catch(l){setTimeout((()=>{throw l}),0)}}))};class Zl extends _3{constructor(e){super(e),this.a_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}static u_(){if(!Zl.c_){const e=s_();nu(e,t_.STAT_EVENT,(t=>{t.stat===bg.PROXY?jt(ar,"STAT_EVENT: detected buffering proxy"):t.stat===bg.NOPROXY&&jt(ar,"STAT_EVENT: detected no buffering proxy")})),Zl.c_=!0}}zo(e,t,i,l,u){const d=Rg();return new Promise(((p,g)=>{const y=new Zw;y.setWithCredentials(!0),y.listenOnce(e_.COMPLETE,(()=>{try{switch(y.getLastErrorCode()){case Sh.NO_ERROR:const _=y.getResponseJson();jt(ar,`XHR for RPC '${e}' ${d} received:`,JSON.stringify(_)),p(_);break;case Sh.TIMEOUT:jt(ar,`RPC '${e}' ${d} timed out`),g(new pt(Pe.DEADLINE_EXCEEDED,"Request time out"));break;case Sh.HTTP_ERROR:const j=y.getStatus();if(jt(ar,`RPC '${e}' ${d} failed with status:`,j,"response text:",y.getResponseText()),j>0){let O=y.getResponseJson();Array.isArray(O)&&(O=O[0]);const K=O?.error;if(K&&K.status&&K.message){const B=(function(te){const Y=te.toLowerCase().replace(/_/g,"-");return Object.values(Pe).indexOf(Y)>=0?Y:Pe.UNKNOWN})(K.status);g(new pt(B,K.message))}else g(new pt(Pe.UNKNOWN,"Server responded with status "+y.getStatus()))}else g(new pt(Pe.UNAVAILABLE,"Connection failed."));break;default:Xt(9055,{l_:e,streamId:d,h_:y.getLastErrorCode(),P_:y.getLastError()})}}finally{jt(ar,`RPC '${e}' ${d} completed.`)}}));const x=JSON.stringify(l);jt(ar,`RPC '${e}' ${d} sending request:`,l),y.send(t,"POST",x,i,15)}))}T_(e,t,i){const l=Rg(),u=[this.qo,"/","google.firestore.v1.Firestore","/",e,"/channel"],d=this.createWebChannelTransport(),p={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},g=this.longPollingOptions.timeoutSeconds;g!==void 0&&(p.longPollingTimeout=Math.round(1e3*g)),this.useFetchStreams&&(p.useFetchStreams=!0),this.Go(p.initMessageHeaders,t,i),p.encodeInitMessageHeaders=!0;const y=u.join("");jt(ar,`Creating RPC '${e}' stream ${l}: ${y}`,p);const x=d.createWebChannel(y,p);this.I_(x);let _=!1,j=!1;const O=new k3({Ho:K=>{j?jt(ar,`Not sending because RPC '${e}' stream ${l} is closed:`,K):(_||(jt(ar,`Opening RPC '${e}' stream ${l} transport.`),x.open(),_=!0),jt(ar,`RPC '${e}' stream ${l} sending:`,K),x.send(K))},Jo:()=>x.close()});return nu(x,du.EventType.OPEN,(()=>{j||(jt(ar,`RPC '${e}' stream ${l} transport opened.`),O.i_())})),nu(x,du.EventType.CLOSE,(()=>{j||(j=!0,jt(ar,`RPC '${e}' stream ${l} transport closed`),O.o_(),this.E_(x))})),nu(x,du.EventType.ERROR,(K=>{j||(j=!0,tc(ar,`RPC '${e}' stream ${l} transport errored. Name:`,K.name,"Message:",K.message),O.o_(new pt(Pe.UNAVAILABLE,"The operation could not be completed")))})),nu(x,du.EventType.MESSAGE,(K=>{if(!j){const B=K.data[0];qs(!!B,16349);const D=B,te=D?.error||D[0]?.error;if(te){jt(ar,`RPC '${e}' stream ${l} received error:`,te);const Y=te.status;let Z=(function(_e){const C=In[_e];if(C!==void 0)return V_(C)})(Y),ke=te.message;Z===void 0&&(Z=Pe.INTERNAL,ke="Unknown error status: "+Y+" with message "+te.message),j=!0,O.o_(new pt(Z,ke)),x.close()}else jt(ar,`RPC '${e}' stream ${l} received:`,B),O.__(B)}})),Zl.u_(),setTimeout((()=>{O.s_()}),0),O}terminate(){this.a_.forEach((e=>e.close())),this.a_=[]}I_(e){this.a_.push(e)}E_(e){this.a_=this.a_.filter((t=>t===e))}Go(e,t,i){super.Go(e,t,i),this.databaseInfo.apiKey&&(e["x-goog-api-key"]=this.databaseInfo.apiKey)}createWebChannelTransport(){return n_()}}function j3(n){return new Zl(n)}function Fp(){return typeof document<"u"?document:null}function vm(n){return new NA(n,!0)}Zl.c_=!1;class ek{constructor(e,t,i=1e3,l=1.5,u=6e4){this.Ci=e,this.timerId=t,this.R_=i,this.A_=l,this.V_=u,this.d_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.d_=0}g_(){this.d_=this.V_}p_(e){this.cancel();const t=Math.floor(this.d_+this.y_()),i=Math.max(0,Date.now()-this.f_),l=Math.max(0,t-i);l>0&&jt("ExponentialBackoff",`Backing off for ${l} ms (base delay: ${this.d_} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.m_=this.Ci.enqueueAfterDelay(this.timerId,l,(()=>(this.f_=Date.now(),e()))),this.d_*=this.A_,this.d_<this.R_&&(this.d_=this.R_),this.d_>this.V_&&(this.d_=this.V_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.d_}}const Zx="PersistentStream";class tk{constructor(e,t,i,l,u,d,p,g){this.Ci=e,this.b_=i,this.S_=l,this.connection=u,this.authCredentialsProvider=d,this.appCheckCredentialsProvider=p,this.listener=g,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new ek(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Ci.enqueueAfterDelay(this.b_,6e4,(()=>this.k_())))}K_(e){this.q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===Pe.RESOURCE_EXHAUSTED?(Ti(t.toString()),Ti("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===Pe.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.t_(t)}W_(){}auth(){this.state=1;const e=this.Q_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([i,l])=>{this.D_===t&&this.G_(i,l)}),(i=>{e((()=>{const l=new pt(Pe.UNKNOWN,"Fetching auth token failed: "+i.message);return this.z_(l)}))}))}G_(e,t){const i=this.Q_(this.D_);this.stream=this.j_(e,t),this.stream.Zo((()=>{i((()=>this.listener.Zo()))})),this.stream.Yo((()=>{i((()=>(this.state=2,this.v_=this.Ci.enqueueAfterDelay(this.S_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.Yo())))})),this.stream.t_((l=>{i((()=>this.z_(l)))})),this.stream.onMessage((l=>{i((()=>++this.F_==1?this.H_(l):this.onNext(l)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return jt(Zx,`close with error: ${e}`),this.stream=null,this.close(4,e)}Q_(e){return t=>{this.Ci.enqueueAndForget((()=>this.D_===e?t():(jt(Zx,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class T3 extends tk{constructor(e,t,i,l,u,d){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,i,l,d),this.serializer=u}j_(e,t){return this.connection.T_("Listen",e,t)}H_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=AA(this.serializer,e),i=(function(u){if(!("targetChange"in u))return ts.min();const d=u.targetChange;return d.targetIds&&d.targetIds.length?ts.min():d.readTime?Wa(d.readTime):ts.min()})(e);return this.listener.J_(t,i)}Z_(e){const t={};t.database=Ng(this.serializer),t.addTarget=(function(u,d){let p;const g=d.target;if(p=kg(g)?{documents:DA(u,g)}:{query:PA(u,g).ft},p.targetId=d.targetId,d.resumeToken.approximateByteSize()>0){p.resumeToken=z_(u,d.resumeToken);const y=Tg(u,d.expectedCount);y!==null&&(p.expectedCount=y)}else if(d.snapshotVersion.compareTo(ts.min())>0){p.readTime=Kh(u,d.snapshotVersion.toTimestamp());const y=Tg(u,d.expectedCount);y!==null&&(p.expectedCount=y)}return p})(this.serializer,e);const i=OA(this.serializer,e);i&&(t.labels=i),this.K_(t)}X_(e){const t={};t.database=Ng(this.serializer),t.removeTarget=e,this.K_(t)}}class S3 extends tk{constructor(e,t,i,l,u,d){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,l,d),this.serializer=u}get Y_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.Y_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}H_(e){return qs(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,qs(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){qs(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=IA(e.writeResults,e.commitTime),i=Wa(e.commitTime);return this.listener.na(i,t)}ra(){const e={};e.database=Ng(this.serializer),this.K_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((i=>MA(this.serializer,i)))};this.K_(t)}}class E3{}class N3 extends E3{constructor(e,t,i,l){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=l,this.ia=!1}sa(){if(this.ia)throw new pt(Pe.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,i,l){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([u,d])=>this.connection.Wo(e,Sg(t,i),l,u,d))).catch((u=>{throw u.name==="FirebaseError"?(u.code===Pe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),u):new pt(Pe.UNKNOWN,u.toString())}))}jo(e,t,i,l,u){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([d,p])=>this.connection.jo(e,Sg(t,i),l,d,p,u))).catch((d=>{throw d.name==="FirebaseError"?(d.code===Pe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),d):new pt(Pe.UNKNOWN,d.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}function C3(n,e,t,i){return new N3(n,e,t,i)}class R3{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Ti(t),this.aa=!1):jt("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const rl="RemoteStore";class A3{constructor(e,t,i,l,u){this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.Ra=[],this.Aa=u,this.Aa.Mo((d=>{i.enqueueAndForget((async()=>{cl(this)&&(jt(rl,"Restarting streams for network reachability change."),await(async function(g){const y=as(g);y.Ea.add(4),await Gu(y),y.Va.set("Unknown"),y.Ea.delete(4),await xm(y)})(this))}))})),this.Va=new R3(i,l)}}async function xm(n){if(cl(n))for(const e of n.Ra)await e(!0)}async function Gu(n){for(const e of n.Ra)await e(!1)}function sk(n,e){const t=as(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),Ty(t)?jy(t):gc(t).O_()&&ky(t,e))}function _y(n,e){const t=as(n),i=gc(t);t.Ia.delete(e),i.O_()&&nk(t,e),t.Ia.size===0&&(i.O_()?i.L_():cl(t)&&t.Va.set("Unknown"))}function ky(n,e){if(n.da.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(ts.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}gc(n).Z_(e)}function nk(n,e){n.da.$e(e),gc(n).X_(e)}function jy(n){n.da=new jA({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),gc(n).start(),n.Va.ua()}function Ty(n){return cl(n)&&!gc(n).x_()&&n.Ia.size>0}function cl(n){return as(n).Ea.size===0}function rk(n){n.da=void 0}async function M3(n){n.Va.set("Online")}async function I3(n){n.Ia.forEach(((e,t)=>{ky(n,e)}))}async function D3(n,e){rk(n),Ty(n)?(n.Va.ha(e),jy(n)):n.Va.set("Unknown")}async function P3(n,e,t){if(n.Va.set("Online"),e instanceof F_&&e.state===2&&e.cause)try{await(async function(l,u){const d=u.cause;for(const p of u.targetIds)l.Ia.has(p)&&(await l.remoteSyncer.rejectListen(p,d),l.Ia.delete(p),l.da.removeTarget(p))})(n,e)}catch(i){jt(rl,"Failed to remove targets %s: %s ",e.targetIds.join(","),i),await Qh(n,i)}else if(e instanceof Rh?n.da.Xe(e):e instanceof U_?n.da.st(e):n.da.tt(e),!t.isEqual(ts.min()))try{const i=await Z_(n.localStore);t.compareTo(i)>=0&&await(function(u,d){const p=u.da.Tt(d);return p.targetChanges.forEach(((g,y)=>{if(g.resumeToken.approximateByteSize()>0){const x=u.Ia.get(y);x&&u.Ia.set(y,x.withResumeToken(g.resumeToken,d))}})),p.targetMismatches.forEach(((g,y)=>{const x=u.Ia.get(g);if(!x)return;u.Ia.set(g,x.withResumeToken(er.EMPTY_BYTE_STRING,x.snapshotVersion)),nk(u,g);const _=new lo(x.target,g,y,x.sequenceNumber);ky(u,_)})),u.remoteSyncer.applyRemoteEvent(p)})(n,t)}catch(i){jt(rl,"Failed to raise snapshot:",i),await Qh(n,i)}}async function Qh(n,e,t){if(!fc(e))throw e;n.Ea.add(1),await Gu(n),n.Va.set("Offline"),t||(t=()=>Z_(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{jt(rl,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await xm(n)}))}function ak(n,e){return e().catch((t=>Qh(n,t,e)))}async function wm(n){const e=as(n),t=xo(e);let i=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:cy;for(;L3(e);)try{const l=await g3(e.localStore,i);if(l===null){e.Ta.length===0&&t.L_();break}i=l.batchId,O3(e,l)}catch(l){await Qh(e,l)}ik(e)&&ok(e)}function L3(n){return cl(n)&&n.Ta.length<10}function O3(n,e){n.Ta.push(e);const t=xo(n);t.O_()&&t.Y_&&t.ea(e.mutations)}function ik(n){return cl(n)&&!xo(n).x_()&&n.Ta.length>0}function ok(n){xo(n).start()}async function B3(n){xo(n).ra()}async function V3(n){const e=xo(n);for(const t of n.Ta)e.ea(t.mutations)}async function U3(n,e,t){const i=n.Ta.shift(),l=py.from(i,e,t);await ak(n,(()=>n.remoteSyncer.applySuccessfulWrite(l))),await wm(n)}async function F3(n,e){e&&xo(n).Y_&&await(async function(i,l){if((function(d){return wA(d)&&d!==Pe.ABORTED})(l.code)){const u=i.Ta.shift();xo(i).B_(),await ak(i,(()=>i.remoteSyncer.rejectFailedWrite(u.batchId,l))),await wm(i)}})(n,e),ik(n)&&ok(n)}async function e2(n,e){const t=as(n);t.asyncQueue.verifyOperationInProgress(),jt(rl,"RemoteStore received new credentials");const i=cl(t);t.Ea.add(3),await Gu(t),i&&t.Va.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await xm(t)}async function z3(n,e){const t=as(n);e?(t.Ea.delete(2),await xm(t)):e||(t.Ea.add(2),await Gu(t),t.Va.set("Unknown"))}function gc(n){return n.ma||(n.ma=(function(t,i,l){const u=as(t);return u.sa(),new T3(i,u.connection,u.authCredentials,u.appCheckCredentials,u.serializer,l)})(n.datastore,n.asyncQueue,{Zo:M3.bind(null,n),Yo:I3.bind(null,n),t_:D3.bind(null,n),J_:P3.bind(null,n)}),n.Ra.push((async e=>{e?(n.ma.B_(),Ty(n)?jy(n):n.Va.set("Unknown")):(await n.ma.stop(),rk(n))}))),n.ma}function xo(n){return n.fa||(n.fa=(function(t,i,l){const u=as(t);return u.sa(),new S3(i,u.connection,u.authCredentials,u.appCheckCredentials,u.serializer,l)})(n.datastore,n.asyncQueue,{Zo:()=>Promise.resolve(),Yo:B3.bind(null,n),t_:F3.bind(null,n),ta:V3.bind(null,n),na:U3.bind(null,n)}),n.Ra.push((async e=>{e?(n.fa.B_(),await wm(n)):(await n.fa.stop(),n.Ta.length>0&&(jt(rl,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}class Sy{constructor(e,t,i,l,u){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=l,this.removalCallback=u,this.deferred=new wi,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((d=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,l,u){const d=Date.now()+i,p=new Sy(e,t,d,l,u);return p.start(i),p}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new pt(Pe.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Ey(n,e){if(Ti("AsyncQueue",`${e}: ${n}`),fc(n))return new pt(Pe.UNAVAILABLE,`${e}: ${n}`);throw n}class ec{static emptySet(e){return new ec(e.comparator)}constructor(e){this.comparator=e?(t,i)=>e(t,i)||Ut.comparator(t.key,i.key):(t,i)=>Ut.comparator(t.key,i.key),this.keyedMap=hu(),this.sortedSet=new mn(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,i)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof ec)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;t.hasNext();){const l=t.getNext().key,u=i.getNext().key;if(!l.isEqual(u))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const i=new ec;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=t,i}}class t2{constructor(){this.ga=new mn(Ut.comparator)}track(e){const t=e.doc.key,i=this.ga.get(t);i?e.type!==0&&i.type===3?this.ga=this.ga.insert(t,e):e.type===3&&i.type!==1?this.ga=this.ga.insert(t,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.ga=this.ga.remove(t):e.type===1&&i.type===2?this.ga=this.ga.insert(t,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):Xt(63341,{Vt:e,pa:i}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,i)=>{e.push(i)})),e}}class ic{constructor(e,t,i,l,u,d,p,g,y){this.query=e,this.docs=t,this.oldDocs=i,this.docChanges=l,this.mutatedKeys=u,this.fromCache=d,this.syncStateChanged=p,this.excludesMetadataChanges=g,this.hasCachedResults=y}static fromInitialDocuments(e,t,i,l,u){const d=[];return t.forEach((p=>{d.push({type:0,doc:p})})),new ic(e,t,ec.emptySet(t),d,i,l,!0,!1,u)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&mm(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,i=e.docChanges;if(t.length!==i.length)return!1;for(let l=0;l<t.length;l++)if(t[l].type!==i[l].type||!t[l].doc.isEqual(i[l].doc))return!1;return!0}}class q3{constructor(){this.wa=void 0,this.ba=[]}Sa(){return this.ba.some((e=>e.Da()))}}class H3{constructor(){this.queries=s2(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,i){const l=as(t),u=l.queries;l.queries=s2(),u.forEach(((d,p)=>{for(const g of p.ba)g.onError(i)}))})(this,new pt(Pe.ABORTED,"Firestore shutting down"))}}function s2(){return new ll((n=>T_(n)),mm)}async function Ny(n,e){const t=as(n);let i=3;const l=e.query;let u=t.queries.get(l);u?!u.Sa()&&e.Da()&&(i=2):(u=new q3,i=e.Da()?0:1);try{switch(i){case 0:u.wa=await t.onListen(l,!0);break;case 1:u.wa=await t.onListen(l,!1);break;case 2:await t.onFirstRemoteStoreListen(l)}}catch(d){const p=Ey(d,`Initialization of query '${Wl(e.query)}' failed`);return void e.onError(p)}t.queries.set(l,u),u.ba.push(e),e.va(t.onlineState),u.wa&&e.Fa(u.wa)&&Ry(t)}async function Cy(n,e){const t=as(n),i=e.query;let l=3;const u=t.queries.get(i);if(u){const d=u.ba.indexOf(e);d>=0&&(u.ba.splice(d,1),u.ba.length===0?l=e.Da()?0:1:!u.Sa()&&e.Da()&&(l=2))}switch(l){case 0:return t.queries.delete(i),t.onUnlisten(i,!0);case 1:return t.queries.delete(i),t.onUnlisten(i,!1);case 2:return t.onLastRemoteStoreUnlisten(i);default:return}}function $3(n,e){const t=as(n);let i=!1;for(const l of e){const u=l.query,d=t.queries.get(u);if(d){for(const p of d.ba)p.Fa(l)&&(i=!0);d.wa=l}}i&&Ry(t)}function W3(n,e,t){const i=as(n),l=i.queries.get(e);if(l)for(const u of l.ba)u.onError(t);i.queries.delete(e)}function Ry(n){n.Ca.forEach((e=>{e.next()}))}var Ag,n2;(n2=Ag||(Ag={})).Ma="default",n2.Cache="cache";class Ay{constructor(e,t,i){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=i||{}}Fa(e){if(!this.options.includeMetadataChanges){const i=[];for(const l of e.docChanges)l.type!==3&&i.push(l);e=new ic(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const i=t!=="Offline";return(!this.options.Ka||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=ic.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Ag.Cache}}class lk{constructor(e){this.key=e}}class ck{constructor(e){this.key=e}}class G3{constructor(e,t){this.query=e,this.Za=t,this.Xa=null,this.hasCachedResults=!1,this.current=!1,this.Ya=Es(),this.mutatedKeys=Es(),this.eu=S_(e),this.tu=new ec(this.eu)}get nu(){return this.Za}ru(e,t){const i=t?t.iu:new t2,l=t?t.tu:this.tu;let u=t?t.mutatedKeys:this.mutatedKeys,d=l,p=!1;const g=this.query.limitType==="F"&&l.size===this.query.limit?l.last():null,y=this.query.limitType==="L"&&l.size===this.query.limit?l.first():null;if(e.inorderTraversal(((x,_)=>{const j=l.get(x),O=fm(this.query,_)?_:null,K=!!j&&this.mutatedKeys.has(j.key),B=!!O&&(O.hasLocalMutations||this.mutatedKeys.has(O.key)&&O.hasCommittedMutations);let D=!1;j&&O?j.data.isEqual(O.data)?K!==B&&(i.track({type:3,doc:O}),D=!0):this.su(j,O)||(i.track({type:2,doc:O}),D=!0,(g&&this.eu(O,g)>0||y&&this.eu(O,y)<0)&&(p=!0)):!j&&O?(i.track({type:0,doc:O}),D=!0):j&&!O&&(i.track({type:1,doc:j}),D=!0,(g||y)&&(p=!0)),D&&(O?(d=d.add(O),u=B?u.add(x):u.delete(x)):(d=d.delete(x),u=u.delete(x)))})),this.query.limit!==null)for(;d.size>this.query.limit;){const x=this.query.limitType==="F"?d.last():d.first();d=d.delete(x.key),u=u.delete(x.key),i.track({type:1,doc:x})}return{tu:d,iu:i,Ss:p,mutatedKeys:u}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,i,l){const u=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const d=e.iu.ya();d.sort(((x,_)=>(function(O,K){const B=D=>{switch(D){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Xt(20277,{Vt:D})}};return B(O)-B(K)})(x.type,_.type)||this.eu(x.doc,_.doc))),this.ou(i),l=l??!1;const p=t&&!l?this._u():[],g=this.Ya.size===0&&this.current&&!l?1:0,y=g!==this.Xa;return this.Xa=g,d.length!==0||y?{snapshot:new ic(this.query,e.tu,u,d,e.mutatedKeys,g===0,y,!1,!!i&&i.resumeToken.approximateByteSize()>0),au:p}:{au:p}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new t2,mutatedKeys:this.mutatedKeys,Ss:!1},!1)):{au:[]}}uu(e){return!this.Za.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Za=this.Za.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Za=this.Za.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Ya;this.Ya=Es(),this.tu.forEach((i=>{this.uu(i.key)&&(this.Ya=this.Ya.add(i.key))}));const t=[];return e.forEach((i=>{this.Ya.has(i)||t.push(new ck(i))})),this.Ya.forEach((i=>{e.has(i)||t.push(new lk(i))})),t}cu(e){this.Za=e.ks,this.Ya=Es();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return ic.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Xa===0,this.hasCachedResults)}}const My="SyncEngine";class K3{constructor(e,t,i){this.query=e,this.targetId=t,this.view=i}}class Y3{constructor(e){this.key=e,this.hu=!1}}class Q3{constructor(e,t,i,l,u,d){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=l,this.currentUser=u,this.maxConcurrentLimboResolutions=d,this.Pu={},this.Tu=new ll((p=>T_(p)),mm),this.Iu=new Map,this.Eu=new Set,this.Ru=new mn(Ut.comparator),this.Au=new Map,this.Vu=new by,this.du={},this.mu=new Map,this.fu=ac.ar(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function X3(n,e,t=!0){const i=pk(n);let l;const u=i.Tu.get(e);return u?(i.sharedClientState.addLocalQueryTarget(u.targetId),l=u.view.lu()):l=await uk(i,e,t,!0),l}async function J3(n,e){const t=pk(n);await uk(t,e,!0,!1)}async function uk(n,e,t,i){const l=await y3(n.localStore,$a(e)),u=l.targetId,d=n.sharedClientState.addLocalQueryTarget(u,t);let p;return i&&(p=await Z3(n,e,u,d==="current",l.resumeToken)),n.isPrimaryClient&&t&&sk(n.remoteStore,l),p}async function Z3(n,e,t,i,l){n.pu=(_,j,O)=>(async function(B,D,te,Y){let Z=D.view.ru(te);Z.Ss&&(Z=await Yx(B.localStore,D.query,!1).then((({documents:C})=>D.view.ru(C,Z))));const ke=Y&&Y.targetChanges.get(D.targetId),Re=Y&&Y.targetMismatches.get(D.targetId)!=null,_e=D.view.applyChanges(Z,B.isPrimaryClient,ke,Re);return a2(B,D.targetId,_e.au),_e.snapshot})(n,_,j,O);const u=await Yx(n.localStore,e,!0),d=new G3(e,u.ks),p=d.ru(u.documents),g=Wu.createSynthesizedTargetChangeForCurrentChange(t,i&&n.onlineState!=="Offline",l),y=d.applyChanges(p,n.isPrimaryClient,g);a2(n,t,y.au);const x=new K3(e,t,d);return n.Tu.set(e,x),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),y.snapshot}async function eM(n,e,t){const i=as(n),l=i.Tu.get(e),u=i.Iu.get(l.targetId);if(u.length>1)return i.Iu.set(l.targetId,u.filter((d=>!mm(d,e)))),void i.Tu.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(l.targetId),i.sharedClientState.isActiveQueryTarget(l.targetId)||await Cg(i.localStore,l.targetId,!1).then((()=>{i.sharedClientState.clearQueryState(l.targetId),t&&_y(i.remoteStore,l.targetId),Mg(i,l.targetId)})).catch(mc)):(Mg(i,l.targetId),await Cg(i.localStore,l.targetId,!0))}async function tM(n,e){const t=as(n),i=t.Tu.get(e),l=t.Iu.get(i.targetId);t.isPrimaryClient&&l.length===1&&(t.sharedClientState.removeLocalQueryTarget(i.targetId),_y(t.remoteStore,i.targetId))}async function sM(n,e,t){const i=cM(n);try{const l=await(function(d,p){const g=as(d),y=Mt.now(),x=p.reduce(((O,K)=>O.add(K.key)),Es());let _,j;return g.persistence.runTransaction("Locally write mutations","readwrite",(O=>{let K=Si(),B=Es();return g.xs.getEntries(O,x).next((D=>{K=D,K.forEach(((te,Y)=>{Y.isValidDocument()||(B=B.add(te))}))})).next((()=>g.localDocuments.getOverlayedDocuments(O,K))).next((D=>{_=D;const te=[];for(const Y of p){const Z=gA(Y,_.get(Y.key).overlayedDocument);Z!=null&&te.push(new To(Y.key,Z,y_(Z.value.mapValue),xr.exists(!0)))}return g.mutationQueue.addMutationBatch(O,y,te,p)})).next((D=>{j=D;const te=D.applyToLocalDocumentSet(_,B);return g.documentOverlayCache.saveOverlays(O,D.batchId,te)}))})).then((()=>({batchId:j.batchId,changes:N_(_)})))})(i.localStore,e);i.sharedClientState.addPendingMutation(l.batchId),(function(d,p,g){let y=d.du[d.currentUser.toKey()];y||(y=new mn(Ss)),y=y.insert(p,g),d.du[d.currentUser.toKey()]=y})(i,l.batchId,t),await Ku(i,l.changes),await wm(i.remoteStore)}catch(l){const u=Ey(l,"Failed to persist write");t.reject(u)}}async function dk(n,e){const t=as(n);try{const i=await f3(t.localStore,e);e.targetChanges.forEach(((l,u)=>{const d=t.Au.get(u);d&&(qs(l.addedDocuments.size+l.modifiedDocuments.size+l.removedDocuments.size<=1,22616),l.addedDocuments.size>0?d.hu=!0:l.modifiedDocuments.size>0?qs(d.hu,14607):l.removedDocuments.size>0&&(qs(d.hu,42227),d.hu=!1))})),await Ku(t,i,e)}catch(i){await mc(i)}}function r2(n,e,t){const i=as(n);if(i.isPrimaryClient&&t===0||!i.isPrimaryClient&&t===1){const l=[];i.Tu.forEach(((u,d)=>{const p=d.view.va(e);p.snapshot&&l.push(p.snapshot)})),(function(d,p){const g=as(d);g.onlineState=p;let y=!1;g.queries.forEach(((x,_)=>{for(const j of _.ba)j.va(p)&&(y=!0)})),y&&Ry(g)})(i.eventManager,e),l.length&&i.Pu.J_(l),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function nM(n,e,t){const i=as(n);i.sharedClientState.updateQueryState(e,"rejected",t);const l=i.Au.get(e),u=l&&l.key;if(u){let d=new mn(Ut.comparator);d=d.insert(u,or.newNoDocument(u,ts.min()));const p=Es().add(u),g=new bm(ts.min(),new Map,new mn(Ss),d,p);await dk(i,g),i.Ru=i.Ru.remove(u),i.Au.delete(e),Iy(i)}else await Cg(i.localStore,e,!1).then((()=>Mg(i,e,t))).catch(mc)}async function rM(n,e){const t=as(n),i=e.batch.batchId;try{const l=await m3(t.localStore,e);mk(t,i,null),hk(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),await Ku(t,l)}catch(l){await mc(l)}}async function aM(n,e,t){const i=as(n);try{const l=await(function(d,p){const g=as(d);return g.persistence.runTransaction("Reject batch","readwrite-primary",(y=>{let x;return g.mutationQueue.lookupMutationBatch(y,p).next((_=>(qs(_!==null,37113),x=_.keys(),g.mutationQueue.removeMutationBatch(y,_)))).next((()=>g.mutationQueue.performConsistencyCheck(y))).next((()=>g.documentOverlayCache.removeOverlaysForBatchId(y,x,p))).next((()=>g.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(y,x))).next((()=>g.localDocuments.getDocuments(y,x)))}))})(i.localStore,e);mk(i,e,t),hk(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),await Ku(i,l)}catch(l){await mc(l)}}function hk(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function mk(n,e,t){const i=as(n);let l=i.du[i.currentUser.toKey()];if(l){const u=l.get(e);u&&(t?u.reject(t):u.resolve(),l=l.remove(e)),i.du[i.currentUser.toKey()]=l}}function Mg(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const i of n.Iu.get(e))n.Tu.delete(i),t&&n.Pu.yu(i,t);n.Iu.delete(e),n.isPrimaryClient&&n.Vu.Gr(e).forEach((i=>{n.Vu.containsKey(i)||fk(n,i)}))}function fk(n,e){n.Eu.delete(e.path.canonicalString());const t=n.Ru.get(e);t!==null&&(_y(n.remoteStore,t),n.Ru=n.Ru.remove(e),n.Au.delete(t),Iy(n))}function a2(n,e,t){for(const i of t)i instanceof lk?(n.Vu.addReference(i.key,e),iM(n,i)):i instanceof ck?(jt(My,"Document no longer in limbo: "+i.key),n.Vu.removeReference(i.key,e),n.Vu.containsKey(i.key)||fk(n,i.key)):Xt(19791,{wu:i})}function iM(n,e){const t=e.key,i=t.path.canonicalString();n.Ru.get(t)||n.Eu.has(i)||(jt(My,"New document in limbo: "+t),n.Eu.add(i),Iy(n))}function Iy(n){for(;n.Eu.size>0&&n.Ru.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new Ut(en.fromString(e)),i=n.fu.next();n.Au.set(i,new Y3(t)),n.Ru=n.Ru.insert(t,i),sk(n.remoteStore,new lo($a(hm(t.path)),i,"TargetPurposeLimboResolution",cm.ce))}}async function Ku(n,e,t){const i=as(n),l=[],u=[],d=[];i.Tu.isEmpty()||(i.Tu.forEach(((p,g)=>{d.push(i.pu(g,e,t).then((y=>{if((y||t)&&i.isPrimaryClient){const x=y?!y.fromCache:t?.targetChanges.get(g.targetId)?.current;i.sharedClientState.updateQueryState(g.targetId,x?"current":"not-current")}if(y){l.push(y);const x=xy.Es(g.targetId,y);u.push(x)}})))})),await Promise.all(d),i.Pu.J_(l),await(async function(g,y){const x=as(g);try{await x.persistence.runTransaction("notifyLocalViewChanges","readwrite",(_=>$e.forEach(y,(j=>$e.forEach(j.Ts,(O=>x.persistence.referenceDelegate.addReference(_,j.targetId,O))).next((()=>$e.forEach(j.Is,(O=>x.persistence.referenceDelegate.removeReference(_,j.targetId,O)))))))))}catch(_){if(!fc(_))throw _;jt(wy,"Failed to update sequence numbers: "+_)}for(const _ of y){const j=_.targetId;if(!_.fromCache){const O=x.vs.get(j),K=O.snapshotVersion,B=O.withLastLimboFreeSnapshotVersion(K);x.vs=x.vs.insert(j,B)}}})(i.localStore,u))}async function oM(n,e){const t=as(n);if(!t.currentUser.isEqual(e)){jt(My,"User change. New user:",e.toKey());const i=await J_(t.localStore,e);t.currentUser=e,(function(u,d){u.mu.forEach((p=>{p.forEach((g=>{g.reject(new pt(Pe.CANCELLED,d))}))})),u.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await Ku(t,i.Ns)}}function lM(n,e){const t=as(n),i=t.Au.get(e);if(i&&i.hu)return Es().add(i.key);{let l=Es();const u=t.Iu.get(e);if(!u)return l;for(const d of u){const p=t.Tu.get(d);l=l.unionWith(p.view.nu)}return l}}function pk(n){const e=as(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=dk.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=lM.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=nM.bind(null,e),e.Pu.J_=$3.bind(null,e.eventManager),e.Pu.yu=W3.bind(null,e.eventManager),e}function cM(n){const e=as(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=rM.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=aM.bind(null,e),e}class Xh{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=vm(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return h3(this.persistence,new c3,e.initialUser,this.serializer)}Cu(e){return new X_(vy.Vi,this.serializer)}Du(e){return new v3}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Xh.provider={build:()=>new Xh};class uM extends Xh{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){qs(this.persistence.referenceDelegate instanceof Yh,46915);const i=this.persistence.referenceDelegate.garbageCollector;return new KA(i,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?Ar.withCacheSize(this.cacheSizeBytes):Ar.DEFAULT;return new X_((i=>Yh.Vi(i,t)),this.serializer)}}class Ig{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>r2(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=oM.bind(null,this.syncEngine),await z3(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new H3})()}createDatastore(e){const t=vm(e.databaseInfo.databaseId),i=j3(e.databaseInfo);return C3(e.authCredentials,e.appCheckCredentials,i,t)}createRemoteStore(e){return(function(i,l,u,d,p){return new A3(i,l,u,d,p)})(this.localStore,this.datastore,e.asyncQueue,(t=>r2(this.syncEngine,t,0)),(function(){return Jx.v()?new Jx:new x3})())}createSyncEngine(e,t){return(function(l,u,d,p,g,y,x){const _=new Q3(l,u,d,p,g,y);return x&&(_.gu=!0),_})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const i=as(t);jt(rl,"RemoteStore shutting down."),i.Ea.add(5),await Gu(i),i.Aa.shutdown(),i.Va.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}Ig.provider={build:()=>new Ig};class Dy{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Ti("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}const wo="FirestoreClient";class dM{constructor(e,t,i,l,u){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this._databaseInfo=l,this.user=ir.UNAUTHENTICATED,this.clientId=ly.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=u,this.authCredentials.start(i,(async d=>{jt(wo,"Received user=",d.uid),await this.authCredentialListener(d),this.user=d})),this.appCheckCredentials.start(i,(d=>(jt(wo,"Received new app check token=",d),this.appCheckCredentialListener(d,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this._databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new wi;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const i=Ey(t,"Failed to shutdown persistence");e.reject(i)}})),e.promise}}async function zp(n,e){n.asyncQueue.verifyOperationInProgress(),jt(wo,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let i=t.initialUser;n.setCredentialChangeListener((async l=>{i.isEqual(l)||(await J_(e.localStore,l),i=l)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function i2(n,e){n.asyncQueue.verifyOperationInProgress();const t=await hM(n);jt(wo,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((i=>e2(e.remoteStore,i))),n.setAppCheckTokenChangeListener(((i,l)=>e2(e.remoteStore,l))),n._onlineComponents=e}async function hM(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){jt(wo,"Using user provided OfflineComponentProvider");try{await zp(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(l){return l.name==="FirebaseError"?l.code===Pe.FAILED_PRECONDITION||l.code===Pe.UNIMPLEMENTED:!(typeof DOMException<"u"&&l instanceof DOMException)||l.code===22||l.code===20||l.code===11})(t))throw t;tc("Error using user provided cache. Falling back to memory cache: "+t),await zp(n,new Xh)}}else jt(wo,"Using default OfflineComponentProvider"),await zp(n,new uM(void 0));return n._offlineComponents}async function gk(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(jt(wo,"Using user provided OnlineComponentProvider"),await i2(n,n._uninitializedComponentsProvider._online)):(jt(wo,"Using default OnlineComponentProvider"),await i2(n,new Ig))),n._onlineComponents}function mM(n){return gk(n).then((e=>e.syncEngine))}async function Jh(n){const e=await gk(n),t=e.eventManager;return t.onListen=X3.bind(null,e.syncEngine),t.onUnlisten=eM.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=J3.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=tM.bind(null,e.syncEngine),t}function fM(n,e,t,i){const l=new Dy(i),u=new Ay(e,l,t);return n.asyncQueue.enqueueAndForget((async()=>Ny(await Jh(n),u))),()=>{l.Nu(),n.asyncQueue.enqueueAndForget((async()=>Cy(await Jh(n),u)))}}function pM(n,e,t={}){const i=new wi;return n.asyncQueue.enqueueAndForget((async()=>(function(u,d,p,g,y){const x=new Dy({next:j=>{x.Nu(),d.enqueueAndForget((()=>Cy(u,_)));const O=j.docs.has(p);!O&&j.fromCache?y.reject(new pt(Pe.UNAVAILABLE,"Failed to get document because the client is offline.")):O&&j.fromCache&&g&&g.source==="server"?y.reject(new pt(Pe.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):y.resolve(j)},error:j=>y.reject(j)}),_=new Ay(hm(p.path),x,{includeMetadataChanges:!0,Ka:!0});return Ny(u,_)})(await Jh(n),n.asyncQueue,e,t,i))),i.promise}function gM(n,e,t={}){const i=new wi;return n.asyncQueue.enqueueAndForget((async()=>(function(u,d,p,g,y){const x=new Dy({next:j=>{x.Nu(),d.enqueueAndForget((()=>Cy(u,_))),j.fromCache&&g.source==="server"?y.reject(new pt(Pe.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):y.resolve(j)},error:j=>y.reject(j)}),_=new Ay(p,x,{includeMetadataChanges:!0,Ka:!0});return Ny(u,_)})(await Jh(n),n.asyncQueue,e,t,i))),i.promise}function yM(n,e){const t=new wi;return n.asyncQueue.enqueueAndForget((async()=>sM(await mM(n),e,t))),t.promise}function yk(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}const bM="ComponentProvider",o2=new Map;function vM(n,e,t,i,l){return new VR(n,e,t,l.host,l.ssl,l.experimentalForceLongPolling,l.experimentalAutoDetectLongPolling,yk(l.experimentalLongPollingOptions),l.useFetchStreams,l.isUsingEmulator,i)}const bk="firestore.googleapis.com",l2=!0;class c2{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new pt(Pe.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=bk,this.ssl=l2}else this.host=e.host,this.ssl=e.ssl??l2;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=Q_;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<WA)throw new pt(Pe.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}ER("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=yk(e.experimentalLongPollingOptions??{}),(function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new pt(Pe.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new pt(Pe.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new pt(Pe.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(i,l){return i.timeoutSeconds===l.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class _m{constructor(e,t,i,l){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=l,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new c2({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new pt(Pe.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new pt(Pe.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new c2(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(i){if(!i)return new yR;switch(i.type){case"firstParty":return new wR(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new pt(Pe.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const i=o2.get(t);i&&(jt(bM,"Removing Datastore"),o2.delete(t),i.terminate())})(this),Promise.resolve()}}function xM(n,e,t,i={}){n=vr(n,_m);const l=_o(e),u=n._getSettings(),d={...u,emulatorOptions:n._getEmulatorOptions()},p=`${e}:${t}`;l&&(Wg(`https://${p}`),Gg("Firestore",!0)),u.host!==bk&&u.host!==p&&tc("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const g={...u,host:p,ssl:l,emulatorOptions:i};if(!Zo(g,d)&&(n._setSettings(g),i.mockUserToken)){let y,x;if(typeof i.mockUserToken=="string")y=i.mockUserToken,x=ir.MOCK_USER;else{y=hw(i.mockUserToken,n._app?.options.projectId);const _=i.mockUserToken.sub||i.mockUserToken.user_id;if(!_)throw new pt(Pe.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");x=new ir(_)}n._authCredentials=new bR(new a_(y,x))}}class Ci{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new Ci(this.firestore,e,this._query)}}class vn{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new mo(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new vn(this.firestore,e,this._key)}toJSON(){return{type:vn._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,i){if(Hu(t,vn._jsonSchema))return new vn(e,i||null,new Ut(en.fromString(t.referencePath)))}}vn._jsonSchemaVersion="firestore/documentReference/1.0",vn._jsonSchema={type:Pn("string",vn._jsonSchemaVersion),referencePath:Pn("string")};class mo extends Ci{constructor(e,t,i){super(e,t,hm(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new vn(this.firestore,null,new Ut(e))}withConverter(e){return new mo(this.firestore,e,this._path)}}function Ht(n,e,...t){if(n=Ys(n),i_("collection","path",e),n instanceof _m){const i=en.fromString(e,...t);return _x(i),new mo(n,null,i)}{if(!(n instanceof vn||n instanceof mo))throw new pt(Pe.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(en.fromString(e,...t));return _x(i),new mo(n.firestore,null,i)}}function Xe(n,e,...t){if(n=Ys(n),arguments.length===1&&(e=ly.newId()),i_("doc","path",e),n instanceof _m){const i=en.fromString(e,...t);return wx(i),new vn(n,null,new Ut(i))}{if(!(n instanceof vn||n instanceof mo))throw new pt(Pe.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(en.fromString(e,...t));return wx(i),new vn(n.firestore,n instanceof mo?n.converter:null,new Ut(i))}}const u2="AsyncQueue";class d2{constructor(e=Promise.resolve()){this.Yu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new ek(this,"async_queue_retry"),this._c=()=>{const i=Fp();i&&jt(u2,"Visibility state changed to "+i.visibilityState),this.M_.w_()},this.ac=e;const t=Fp();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=Fp();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new wi;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Yu.push(e),this.lc())))}async lc(){if(this.Yu.length!==0){try{await this.Yu[0](),this.Yu.shift(),this.M_.reset()}catch(e){if(!fc(e))throw e;jt(u2,"Operation failed with retryable error: "+e)}this.Yu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((i=>{throw this.nc=i,this.rc=!1,Ti("INTERNAL UNHANDLED ERROR: ",h2(i)),i})).then((i=>(this.rc=!1,i))))));return this.ac=t,t}enqueueAfterDelay(e,t,i){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const l=Sy.createAndSchedule(this,e,t,i,(u=>this.hc(u)));return this.tc.push(l),l}uc(){this.nc&&Xt(47125,{Pc:h2(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,i)=>t.targetTimeMs-i.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}Rc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function h2(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}class Ya extends _m{constructor(e,t,i,l){super(e,t,i,l),this.type="firestore",this._queue=new d2,this._persistenceKey=l?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new d2(e),this._firestoreClient=void 0,await e}}}function wM(n,e){const t=typeof n=="object"?n:Xg(),i=typeof n=="string"?n:Hh,l=rm(t,"firestore").getImmediate({identifier:i});if(!l._initialized){const u=cw("firestore");u&&xM(l,...u)}return l}function Yu(n){if(n._terminated)throw new pt(Pe.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||_M(n),n._firestoreClient}function _M(n){const e=n._freezeSettings(),t=vM(n._databaseId,n._app?.options.appId||"",n._persistenceKey,n._app?.options.apiKey,e);n._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new dM(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(l){const u=l?._online.build();return{_offline:l?._offline.build(u),_online:u}})(n._componentsProvider))}class la{constructor(e){this._byteString=e}static fromBase64String(e){try{return new la(er.fromBase64String(e))}catch(t){throw new pt(Pe.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new la(er.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:la._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Hu(e,la._jsonSchema))return la.fromBase64String(e.bytes)}}la._jsonSchemaVersion="firestore/bytes/1.0",la._jsonSchema={type:Pn("string",la._jsonSchemaVersion),bytes:Pn("string")};class km{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new pt(Pe.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Zn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Qu{constructor(e){this._methodName=e}}class Ga{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new pt(Pe.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new pt(Pe.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Ss(this._lat,e._lat)||Ss(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Ga._jsonSchemaVersion}}static fromJSON(e){if(Hu(e,Ga._jsonSchema))return new Ga(e.latitude,e.longitude)}}Ga._jsonSchemaVersion="firestore/geoPoint/1.0",Ga._jsonSchema={type:Pn("string",Ga._jsonSchemaVersion),latitude:Pn("number"),longitude:Pn("number")};class _a{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(i,l){if(i.length!==l.length)return!1;for(let u=0;u<i.length;++u)if(i[u]!==l[u])return!1;return!0})(this._values,e._values)}toJSON(){return{type:_a._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Hu(e,_a._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new _a(e.vectorValues);throw new pt(Pe.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}_a._jsonSchemaVersion="firestore/vectorValue/1.0",_a._jsonSchema={type:Pn("string",_a._jsonSchemaVersion),vectorValues:Pn("object")};const kM=/^__.*__$/;class jM{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return this.fieldMask!==null?new To(e,this.data,this.fieldMask,t,this.fieldTransforms):new $u(e,this.data,t,this.fieldTransforms)}}class vk{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return new To(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function xk(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Xt(40011,{dataSource:n})}}class Py{constructor(e,t,i,l,u,d){this.settings=e,this.databaseId=t,this.serializer=i,this.ignoreUndefinedProperties=l,u===void 0&&this.validatePath(),this.fieldTransforms=u||[],this.fieldMask=d||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(e){return new Py({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(e){const t=this.path?.child(e),i=this.contextWith({path:t,arrayElement:!1});return i.validatePathSegment(e),i}childContextForFieldPath(e){const t=this.path?.child(e),i=this.contextWith({path:t,arrayElement:!1});return i.validatePath(),i}childContextForArray(e){return this.contextWith({path:void 0,arrayElement:!0})}createError(e){return Zh(e,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}validatePath(){if(this.path)for(let e=0;e<this.path.length;e++)this.validatePathSegment(this.path.get(e))}validatePathSegment(e){if(e.length===0)throw this.createError("Document fields must not be empty");if(xk(this.dataSource)&&kM.test(e))throw this.createError('Document fields cannot begin and end with "__"')}}class TM{constructor(e,t,i){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=i||vm(e)}createContext(e,t,i,l=!1){return new Py({dataSource:e,methodName:t,targetDoc:i,path:Zn.emptyPath(),arrayElement:!1,hasConverter:l},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Xu(n){const e=n._freezeSettings(),t=vm(n._databaseId);return new TM(n._databaseId,!!e.ignoreUndefinedProperties,t)}function Ly(n,e,t,i,l,u={}){const d=n.createContext(u.merge||u.mergeFields?2:0,e,t,l);Vy("Data must be an object, but it was:",d,i);const p=kk(i,d);let g,y;if(u.merge)g=new Wr(d.fieldMask),y=d.fieldTransforms;else if(u.mergeFields){const x=[];for(const _ of u.mergeFields){const j=al(e,_,t);if(!d.contains(j))throw new pt(Pe.INVALID_ARGUMENT,`Field '${j}' is specified in your field mask but missing from your input data.`);Sk(x,j)||x.push(j)}g=new Wr(x),y=d.fieldTransforms.filter((_=>g.covers(_.field)))}else g=null,y=d.fieldTransforms;return new jM(new Mr(p),g,y)}class jm extends Qu{_toFieldTransform(e){if(e.dataSource!==2)throw e.dataSource===1?e.createError(`${this._methodName}() can only appear at the top level of your update data`):e.createError(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof jm}}class Oy extends Qu{_toFieldTransform(e){return new L_(e.path,new Au)}isEqual(e){return e instanceof Oy}}class By extends Qu{constructor(e,t){super(e),this.Vc=t}_toFieldTransform(e){const t=new Du(e.serializer,A_(e.serializer,this.Vc));return new L_(e.path,t)}isEqual(e){return e instanceof By&&this.Vc===e.Vc}}function wk(n,e,t,i){const l=n.createContext(1,e,t);Vy("Data must be an object, but it was:",l,i);const u=[],d=Mr.empty();jo(i,((g,y)=>{const x=Tk(e,g,t);y=Ys(y);const _=l.childContextForFieldPath(x);if(y instanceof jm)u.push(x);else{const j=Ju(y,_);j!=null&&(u.push(x),d.set(x,j))}}));const p=new Wr(u);return new vk(d,p,l.fieldTransforms)}function _k(n,e,t,i,l,u){const d=n.createContext(1,e,t),p=[al(e,i,t)],g=[l];if(u.length%2!=0)throw new pt(Pe.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let j=0;j<u.length;j+=2)p.push(al(e,u[j])),g.push(u[j+1]);const y=[],x=Mr.empty();for(let j=p.length-1;j>=0;--j)if(!Sk(y,p[j])){const O=p[j];let K=g[j];K=Ys(K);const B=d.childContextForFieldPath(O);if(K instanceof jm)y.push(O);else{const D=Ju(K,B);D!=null&&(y.push(O),x.set(O,D))}}const _=new Wr(y);return new vk(x,_,d.fieldTransforms)}function SM(n,e,t,i=!1){return Ju(t,n.createContext(i?4:3,e))}function Ju(n,e){if(jk(n=Ys(n)))return Vy("Unsupported field value:",e,n),kk(n,e);if(n instanceof Qu)return(function(i,l){if(!xk(l.dataSource))throw l.createError(`${i._methodName}() can only be used with update() and set()`);if(!l.path)throw l.createError(`${i._methodName}() is not currently supported inside arrays`);const u=i._toFieldTransform(l);u&&l.fieldTransforms.push(u)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.arrayElement&&e.dataSource!==4)throw e.createError("Nested arrays are not supported");return(function(i,l){const u=[];let d=0;for(const p of i){let g=Ju(p,l.childContextForArray(d));g==null&&(g={nullValue:"NULL_VALUE"}),u.push(g),d++}return{arrayValue:{values:u}}})(n,e)}return(function(i,l){if((i=Ys(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return A_(l.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const u=Mt.fromDate(i);return{timestampValue:Kh(l.serializer,u)}}if(i instanceof Mt){const u=new Mt(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:Kh(l.serializer,u)}}if(i instanceof Ga)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof la)return{bytesValue:z_(l.serializer,i._byteString)};if(i instanceof vn){const u=l.databaseId,d=i.firestore._databaseId;if(!d.isEqual(u))throw l.createError(`Document reference is for database ${d.projectId}/${d.database} but should be for database ${u.projectId}/${u.database}`);return{referenceValue:yy(i.firestore._databaseId||l.databaseId,i._key.path)}}if(i instanceof _a)return(function(d,p){const g=d instanceof _a?d.toArray():d;return{mapValue:{fields:{[p_]:{stringValue:g_},[$h]:{arrayValue:{values:g.map((x=>{if(typeof x!="number")throw p.createError("VectorValues must only contain numeric values.");return fy(p.serializer,x)}))}}}}}})(i,l);if(Y_(i))return i._toProto(l.serializer);throw l.createError(`Unsupported field value: ${lm(i)}`)})(n,e)}function kk(n,e){const t={};return c_(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):jo(n,((i,l)=>{const u=Ju(l,e.childContextForField(i));u!=null&&(t[i]=u)})),{mapValue:{fields:t}}}function jk(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Mt||n instanceof Ga||n instanceof la||n instanceof vn||n instanceof Qu||n instanceof _a||Y_(n))}function Vy(n,e,t){if(!jk(t)||!o_(t)){const i=lm(t);throw i==="an object"?e.createError(n+" a custom object"):e.createError(n+" "+i)}}function al(n,e,t){if((e=Ys(e))instanceof km)return e._internalPath;if(typeof e=="string")return Tk(n,e);throw Zh("Field path arguments must be of type string or ",n,!1,void 0,t)}const EM=new RegExp("[~\\*/\\[\\]]");function Tk(n,e,t){if(e.search(EM)>=0)throw Zh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new km(...e.split("."))._internalPath}catch{throw Zh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Zh(n,e,t,i,l){const u=i&&!i.isEmpty(),d=l!==void 0;let p=`Function ${e}() called with invalid data`;t&&(p+=" (via `toFirestore()`)"),p+=". ";let g="";return(u||d)&&(g+=" (found",u&&(g+=` in field ${i}`),d&&(g+=` in document ${l}`),g+=")"),new pt(Pe.INVALID_ARGUMENT,p+n+g)}function Sk(n,e){return n.some((t=>t.isEqual(e)))}class NM{convertValue(e,t="none"){switch(vo(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Sn(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(bo(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Xt(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const i={};return jo(e,((l,u)=>{i[l]=this.convertValue(u,t)})),i}convertVectorValue(e){const t=e.fields?.[$h].arrayValue?.values?.map((i=>Sn(i.doubleValue)));return new _a(t)}convertGeoPoint(e){return new Ga(Sn(e.latitude),Sn(e.longitude))}convertArray(e,t){return(e.values||[]).map((i=>this.convertValue(i,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const i=dm(e);return i==null?null:this.convertValue(i,t);case"estimate":return this.convertTimestamp(Eu(e));default:return null}}convertTimestamp(e){const t=yo(e);return new Mt(t.seconds,t.nanos)}convertDocumentKey(e,t){const i=en.fromString(e);qs(K_(i),9688,{name:e});const l=new Nu(i.get(1),i.get(3)),u=new Ut(i.popFirst(5));return l.isEqual(t)||Ti(`Document ${u} contains a document reference within a different database (${l.projectId}/${l.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),u}}class Uy extends NM{constructor(e){super(),this.firestore=e}convertBytes(e){return new la(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new vn(this.firestore,null,t)}}function yr(){return new Oy("serverTimestamp")}function Yo(n){return new By("increment",n)}const m2="@firebase/firestore",f2="4.10.0";function p2(n){return(function(t,i){if(typeof t!="object"||t===null)return!1;const l=t;for(const u of i)if(u in l&&typeof l[u]=="function")return!0;return!1})(n,["next","error","complete"])}class Ek{constructor(e,t,i,l,u){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=l,this._converter=u}get id(){return this._key.path.lastSegment()}get ref(){return new vn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new CM(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}_fieldsProto(){return this._document?.data.clone().value.mapValue.fields??void 0}get(e){if(this._document){const t=this._document.data.field(al("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class CM extends Ek{data(){return super.data()}}function Nk(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new pt(Pe.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Fy{}class zy extends Fy{}function As(n,e,...t){let i=[];e instanceof Fy&&i.push(e),i=i.concat(t),(function(u){const d=u.filter((g=>g instanceof qy)).length,p=u.filter((g=>g instanceof Tm)).length;if(d>1||d>0&&p>0)throw new pt(Pe.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(i);for(const l of i)n=l._apply(n);return n}class Tm extends zy{constructor(e,t,i){super(),this._field=e,this._op=t,this._value=i,this.type="where"}static _create(e,t,i){return new Tm(e,t,i)}_apply(e){const t=this._parse(e);return Ck(e._query,t),new Ci(e.firestore,e.converter,jg(e._query,t))}_parse(e){const t=Xu(e.firestore);return(function(u,d,p,g,y,x,_){let j;if(y.isKeyField()){if(x==="array-contains"||x==="array-contains-any")throw new pt(Pe.INVALID_ARGUMENT,`Invalid Query. You can't perform '${x}' queries on documentId().`);if(x==="in"||x==="not-in"){y2(_,x);const K=[];for(const B of _)K.push(g2(g,u,B));j={arrayValue:{values:K}}}else j=g2(g,u,_)}else x!=="in"&&x!=="not-in"&&x!=="array-contains-any"||y2(_,x),j=SM(p,d,_,x==="in"||x==="not-in");return Dn.create(y,x,j)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function gs(n,e,t){const i=e,l=al("where",n);return Tm._create(l,i,t)}class qy extends Fy{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new qy(e,t)}_parse(e){const t=this._queryConstraints.map((i=>i._parse(e))).filter((i=>i.getFilters().length>0));return t.length===1?t[0]:ja.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(l,u){let d=l;const p=u.getFlattenedFilters();for(const g of p)Ck(d,g),d=jg(d,g)})(e._query,t),new Ci(e.firestore,e.converter,jg(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Hy extends zy{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new Hy(e,t)}_apply(e){const t=(function(l,u,d){if(l.startAt!==null)throw new pt(Pe.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(l.endAt!==null)throw new pt(Pe.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Ru(u,d)})(e._query,this._field,this._direction);return new Ci(e.firestore,e.converter,nA(e._query,t))}}function oc(n,e="asc"){const t=e,i=al("orderBy",n);return Hy._create(i,t)}class $y extends zy{constructor(e,t,i){super(),this.type=e,this._limit=t,this._limitType=i}static _create(e,t,i){return new $y(e,t,i)}_apply(e){return new Ci(e.firestore,e.converter,Gh(e._query,this._limit,this._limitType))}}function Pu(n){return NR("limit",n),$y._create("limit",n,"F")}function g2(n,e,t){if(typeof(t=Ys(t))=="string"){if(t==="")throw new pt(Pe.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!j_(e)&&t.indexOf("/")!==-1)throw new pt(Pe.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const i=e.path.child(en.fromString(t));if(!Ut.isDocumentKey(i))throw new pt(Pe.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return Rx(n,new Ut(i))}if(t instanceof vn)return Rx(n,t._key);throw new pt(Pe.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${lm(t)}.`)}function y2(n,e){if(!Array.isArray(n)||n.length===0)throw new pt(Pe.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function Ck(n,e){const t=(function(l,u){for(const d of l)for(const p of d.getFlattenedFilters())if(u.indexOf(p.op)>=0)return p.op;return null})(n.filters,(function(l){switch(l){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new pt(Pe.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new pt(Pe.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}function Wy(n,e,t){let i;return i=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,i}class fu{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Qo extends Ek{constructor(e,t,i,l,u,d){super(e,t,i,l,d),this._firestore=e,this._firestoreImpl=e,this.metadata=u}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Ah(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const i=this._document.data.field(al("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new pt(Pe.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=Qo._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}Qo._jsonSchemaVersion="firestore/documentSnapshot/1.0",Qo._jsonSchema={type:Pn("string",Qo._jsonSchemaVersion),bundleSource:Pn("string","DocumentSnapshot"),bundleName:Pn("string"),bundle:Pn("string")};class Ah extends Qo{data(e={}){return super.data(e)}}class Xo{constructor(e,t,i,l){this._firestore=e,this._userDataWriter=t,this._snapshot=l,this.metadata=new fu(l.hasPendingWrites,l.fromCache),this.query=i}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((i=>{e.call(t,new Ah(this._firestore,this._userDataWriter,i.key,i,new fu(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new pt(Pe.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(l,u){if(l._snapshot.oldDocs.isEmpty()){let d=0;return l._snapshot.docChanges.map((p=>{const g=new Ah(l._firestore,l._userDataWriter,p.doc.key,p.doc,new fu(l._snapshot.mutatedKeys.has(p.doc.key),l._snapshot.fromCache),l.query.converter);return p.doc,{type:"added",doc:g,oldIndex:-1,newIndex:d++}}))}{let d=l._snapshot.oldDocs;return l._snapshot.docChanges.filter((p=>u||p.type!==3)).map((p=>{const g=new Ah(l._firestore,l._userDataWriter,p.doc.key,p.doc,new fu(l._snapshot.mutatedKeys.has(p.doc.key),l._snapshot.fromCache),l.query.converter);let y=-1,x=-1;return p.type!==0&&(y=d.indexOf(p.doc.key),d=d.delete(p.doc.key)),p.type!==1&&(d=d.add(p.doc),x=d.indexOf(p.doc.key)),{type:RM(p.type),doc:g,oldIndex:y,newIndex:x}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new pt(Pe.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Xo._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=ly.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],i=[],l=[];return this.docs.forEach((u=>{u._document!==null&&(t.push(u._document),i.push(this._userDataWriter.convertObjectMap(u._document.data.value.mapValue.fields,"previous")),l.push(u.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function RM(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Xt(61501,{type:n})}}Xo._jsonSchemaVersion="firestore/querySnapshot/1.0",Xo._jsonSchema={type:Pn("string",Xo._jsonSchemaVersion),bundleSource:Pn("string","QuerySnapshot"),bundleName:Pn("string"),bundle:Pn("string")};class AM{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Xu(e)}set(e,t,i){this._verifyNotCommitted();const l=qp(e,this._firestore),u=Wy(l.converter,t,i),d=Ly(this._dataReader,"WriteBatch.set",l._key,u,l.converter!==null,i);return this._mutations.push(d.toMutation(l._key,xr.none())),this}update(e,t,i,...l){this._verifyNotCommitted();const u=qp(e,this._firestore);let d;return d=typeof(t=Ys(t))=="string"||t instanceof km?_k(this._dataReader,"WriteBatch.update",u._key,t,i,l):wk(this._dataReader,"WriteBatch.update",u._key,t),this._mutations.push(d.toMutation(u._key,xr.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=qp(e,this._firestore);return this._mutations=this._mutations.concat(new ym(t._key,xr.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new pt(Pe.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function qp(n,e){if((n=Ys(n)).firestore!==e)throw new pt(Pe.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}function Is(n){n=vr(n,vn);const e=vr(n.firestore,Ya),t=Yu(e);return pM(t,n._key).then((i=>Ak(e,n,i)))}function Ts(n){n=vr(n,Ci);const e=vr(n.firestore,Ya),t=Yu(e),i=new Uy(e);return Nk(n._query),gM(t,n._query).then((l=>new Xo(e,i,n,l)))}function Ds(n,e,t){n=vr(n,vn);const i=vr(n.firestore,Ya),l=Wy(n.converter,e,t),u=Xu(i);return Zu(i,[Ly(u,"setDoc",n._key,l,n.converter!==null,t).toMutation(n._key,xr.none())])}function oa(n,e,t,...i){n=vr(n,vn);const l=vr(n.firestore,Ya),u=Xu(l);let d;return d=typeof(e=Ys(e))=="string"||e instanceof km?_k(u,"updateDoc",n._key,e,t,i):wk(u,"updateDoc",n._key,e),Zu(l,[d.toMutation(n._key,xr.exists(!0))])}function lr(n){return Zu(vr(n.firestore,Ya),[new ym(n._key,xr.none())])}function Gr(n,e){const t=vr(n.firestore,Ya),i=Xe(n),l=Wy(n.converter,e),u=Xu(n.firestore);return Zu(t,[Ly(u,"addDoc",i._key,l,n.converter!==null,{}).toMutation(i._key,xr.exists(!1))]).then((()=>i))}function Rk(n,...e){n=Ys(n);let t={includeMetadataChanges:!1,source:"default"},i=0;typeof e[i]!="object"||p2(e[i])||(t=e[i++]);const l={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(p2(e[i])){const y=e[i];e[i]=y.next?.bind(y),e[i+1]=y.error?.bind(y),e[i+2]=y.complete?.bind(y)}let u,d,p;if(n instanceof vn)d=vr(n.firestore,Ya),p=hm(n._key.path),u={next:y=>{e[i]&&e[i](Ak(d,n,y))},error:e[i+1],complete:e[i+2]};else{const y=vr(n,Ci);d=vr(y.firestore,Ya),p=y._query;const x=new Uy(d);u={next:_=>{e[i]&&e[i](new Xo(d,x,y,_))},error:e[i+1],complete:e[i+2]},Nk(n._query)}const g=Yu(d);return fM(g,p,l,u)}function Zu(n,e){const t=Yu(n);return yM(t,e)}function Ak(n,e,t){const i=t.docs.get(e._key),l=new Uy(n);return new Qo(n,l,e._key,i,new fu(t.hasPendingWrites,t.fromCache),e.converter)}function b2(n){return n=vr(n,Ya),Yu(n),new AM(n,(e=>Zu(n,e)))}(function(e,t=!0){gR(ol),el(new po("firestore",((i,{instanceIdentifier:l,options:u})=>{const d=i.getProvider("app").getImmediate(),p=new Ya(new vR(i.getProvider("auth-internal")),new _R(d,i.getProvider("app-check-internal")),UR(d,l),d);return u={useFetchStreams:t,...u},p._setSettings(u),p}),"PUBLIC").setMultipleInstances(!0)),za(m2,f2,e),za(m2,f2,"esm2020")})();var MM="firebase",IM="12.8.0";za(MM,IM,"app");const Mk="firebasestorage.googleapis.com",Ik="storageBucket",DM=120*1e3,PM=600*1e3;class wn extends Qa{constructor(e,t,i=0){super(Hp(e),`Firebase Storage: ${t} (${Hp(e)})`),this.status_=i,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,wn.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Hp(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var xn;(function(n){n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(xn||(xn={}));function Hp(n){return"storage/"+n}function Gy(){const n="An unknown error occurred, please check the error payload for server response.";return new wn(xn.UNKNOWN,n)}function LM(n){return new wn(xn.OBJECT_NOT_FOUND,"Object '"+n+"' does not exist.")}function OM(n){return new wn(xn.QUOTA_EXCEEDED,"Quota for bucket '"+n+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function BM(){const n="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new wn(xn.UNAUTHENTICATED,n)}function VM(){return new wn(xn.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function UM(n){return new wn(xn.UNAUTHORIZED,"User does not have permission to access '"+n+"'.")}function FM(){return new wn(xn.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function zM(){return new wn(xn.CANCELED,"User canceled the upload/download.")}function qM(n){return new wn(xn.INVALID_URL,"Invalid URL '"+n+"'.")}function HM(n){return new wn(xn.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function $M(){return new wn(xn.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+Ik+"' property when initializing the app?")}function WM(){return new wn(xn.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function GM(){return new wn(xn.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function KM(n){return new wn(xn.UNSUPPORTED_ENVIRONMENT,`${n} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function Dg(n){return new wn(xn.INVALID_ARGUMENT,n)}function Dk(){return new wn(xn.APP_DELETED,"The Firebase app was deleted.")}function YM(n){return new wn(xn.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function wu(n,e){return new wn(xn.INVALID_FORMAT,"String does not match format '"+n+"': "+e)}function ru(n){throw new wn(xn.INTERNAL_ERROR,"Internal error: "+n)}class br{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let i;try{i=br.makeFromUrl(e,t)}catch{return new br(e,"")}if(i.path==="")return i;throw HM(e)}static makeFromUrl(e,t){let i=null;const l="([A-Za-z0-9.\\-_]+)";function u(ke){ke.path.charAt(ke.path.length-1)==="/"&&(ke.path_=ke.path_.slice(0,-1))}const d="(/(.*))?$",p=new RegExp("^gs://"+l+d,"i"),g={bucket:1,path:3};function y(ke){ke.path_=decodeURIComponent(ke.path)}const x="v[A-Za-z0-9_]+",_=t.replace(/[.]/g,"\\."),j="(/([^?#]*).*)?$",O=new RegExp(`^https?://${_}/${x}/b/${l}/o${j}`,"i"),K={bucket:1,path:3},B=t===Mk?"(?:storage.googleapis.com|storage.cloud.google.com)":t,D="([^?#]*)",te=new RegExp(`^https?://${B}/${l}/${D}`,"i"),Z=[{regex:p,indices:g,postModify:u},{regex:O,indices:K,postModify:y},{regex:te,indices:{bucket:1,path:2},postModify:y}];for(let ke=0;ke<Z.length;ke++){const Re=Z[ke],_e=Re.regex.exec(e);if(_e){const C=_e[Re.indices.bucket];let T=_e[Re.indices.path];T||(T=""),i=new br(C,T),Re.postModify(i);break}}if(i==null)throw qM(e);return i}}class QM{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function XM(n,e,t){let i=1,l=null,u=null,d=!1,p=0;function g(){return p===2}let y=!1;function x(...D){y||(y=!0,e.apply(null,D))}function _(D){l=setTimeout(()=>{l=null,n(O,g())},D)}function j(){u&&clearTimeout(u)}function O(D,...te){if(y){j();return}if(D){j(),x.call(null,D,...te);return}if(g()||d){j(),x.call(null,D,...te);return}i<64&&(i*=2);let Z;p===1?(p=2,Z=0):Z=(i+Math.random())*1e3,_(Z)}let K=!1;function B(D){K||(K=!0,j(),!y&&(l!==null?(D||(p=2),clearTimeout(l),_(0)):D||(p=1)))}return _(0),u=setTimeout(()=>{d=!0,B(!0)},t),B}function JM(n){n(!1)}function ZM(n){return n!==void 0}function eI(n){return typeof n=="object"&&!Array.isArray(n)}function Ky(n){return typeof n=="string"||n instanceof String}function v2(n){return Yy()&&n instanceof Blob}function Yy(){return typeof Blob<"u"}function Pg(n,e,t,i){if(i<e)throw Dg(`Invalid value for '${n}'. Expected ${e} or greater.`);if(i>t)throw Dg(`Invalid value for '${n}'. Expected ${t} or less.`)}function Sm(n,e,t){let i=e;return t==null&&(i=`https://${e}`),`${t}://${i}/v0${n}`}function Pk(n){const e=encodeURIComponent;let t="?";for(const i in n)if(n.hasOwnProperty(i)){const l=e(i)+"="+e(n[i]);t=t+l+"&"}return t=t.slice(0,-1),t}var Jo;(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"})(Jo||(Jo={}));function tI(n,e){const t=n>=500&&n<600,l=[408,429].indexOf(n)!==-1,u=e.indexOf(n)!==-1;return t||l||u}class sI{constructor(e,t,i,l,u,d,p,g,y,x,_,j=!0,O=!1){this.url_=e,this.method_=t,this.headers_=i,this.body_=l,this.successCodes_=u,this.additionalRetryCodes_=d,this.callback_=p,this.errorCallback_=g,this.timeout_=y,this.progressCallback_=x,this.connectionFactory_=_,this.retry=j,this.isUsingEmulator=O,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((K,B)=>{this.resolve_=K,this.reject_=B,this.start_()})}start_(){const e=(i,l)=>{if(l){i(!1,new dh(!1,null,!0));return}const u=this.connectionFactory_();this.pendingConnection_=u;const d=p=>{const g=p.loaded,y=p.lengthComputable?p.total:-1;this.progressCallback_!==null&&this.progressCallback_(g,y)};this.progressCallback_!==null&&u.addUploadProgressListener(d),u.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&u.removeUploadProgressListener(d),this.pendingConnection_=null;const p=u.getErrorCode()===Jo.NO_ERROR,g=u.getStatus();if(!p||tI(g,this.additionalRetryCodes_)&&this.retry){const x=u.getErrorCode()===Jo.ABORT;i(!1,new dh(!1,null,x));return}const y=this.successCodes_.indexOf(g)!==-1;i(!0,new dh(y,u))})},t=(i,l)=>{const u=this.resolve_,d=this.reject_,p=l.connection;if(l.wasSuccessCode)try{const g=this.callback_(p,p.getResponse());ZM(g)?u(g):u()}catch(g){d(g)}else if(p!==null){const g=Gy();g.serverResponse=p.getErrorText(),this.errorCallback_?d(this.errorCallback_(p,g)):d(g)}else if(l.canceled){const g=this.appDelete_?Dk():zM();d(g)}else{const g=FM();d(g)}};this.canceled_?t(!1,new dh(!1,null,!0)):this.backoffId_=XM(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&JM(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class dh{constructor(e,t,i){this.wasSuccessCode=e,this.connection=t,this.canceled=!!i}}function nI(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function rI(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function aI(n,e){e&&(n["X-Firebase-GMPID"]=e)}function iI(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function oI(n,e,t,i,l,u,d=!0,p=!1){const g=Pk(n.urlParams),y=n.url+g,x=Object.assign({},n.headers);return aI(x,e),nI(x,t),rI(x,u),iI(x,i),new sI(y,n.method,x,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,l,d,p)}function lI(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function cI(...n){const e=lI();if(e!==void 0){const t=new e;for(let i=0;i<n.length;i++)t.append(n[i]);return t.getBlob()}else{if(Yy())return new Blob(n);throw new wn(xn.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function uI(n,e,t){return n.webkitSlice?n.webkitSlice(e,t):n.mozSlice?n.mozSlice(e,t):n.slice?n.slice(e,t):null}function dI(n){if(typeof atob>"u")throw KM("base-64");return atob(n)}const Fa={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class $p{constructor(e,t){this.data=e,this.contentType=t||null}}function hI(n,e){switch(n){case Fa.RAW:return new $p(Lk(e));case Fa.BASE64:case Fa.BASE64URL:return new $p(Ok(n,e));case Fa.DATA_URL:return new $p(fI(e),pI(e))}throw Gy()}function Lk(n){const e=[];for(let t=0;t<n.length;t++){let i=n.charCodeAt(t);if(i<=127)e.push(i);else if(i<=2047)e.push(192|i>>6,128|i&63);else if((i&64512)===55296)if(!(t<n.length-1&&(n.charCodeAt(t+1)&64512)===56320))e.push(239,191,189);else{const u=i,d=n.charCodeAt(++t);i=65536|(u&1023)<<10|d&1023,e.push(240|i>>18,128|i>>12&63,128|i>>6&63,128|i&63)}else(i&64512)===56320?e.push(239,191,189):e.push(224|i>>12,128|i>>6&63,128|i&63)}return new Uint8Array(e)}function mI(n){let e;try{e=decodeURIComponent(n)}catch{throw wu(Fa.DATA_URL,"Malformed data URL.")}return Lk(e)}function Ok(n,e){switch(n){case Fa.BASE64:{const l=e.indexOf("-")!==-1,u=e.indexOf("_")!==-1;if(l||u)throw wu(n,"Invalid character '"+(l?"-":"_")+"' found: is it base64url encoded?");break}case Fa.BASE64URL:{const l=e.indexOf("+")!==-1,u=e.indexOf("/")!==-1;if(l||u)throw wu(n,"Invalid character '"+(l?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let t;try{t=dI(e)}catch(l){throw l.message.includes("polyfill")?l:wu(n,"Invalid character found")}const i=new Uint8Array(t.length);for(let l=0;l<t.length;l++)i[l]=t.charCodeAt(l);return i}class Bk{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(t===null)throw wu(Fa.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const i=t[1]||null;i!=null&&(this.base64=gI(i,";base64"),this.contentType=this.base64?i.substring(0,i.length-7):i),this.rest=e.substring(e.indexOf(",")+1)}}function fI(n){const e=new Bk(n);return e.base64?Ok(Fa.BASE64,e.rest):mI(e.rest)}function pI(n){return new Bk(n).contentType}function gI(n,e){return n.length>=e.length?n.substring(n.length-e.length)===e:!1}class oo{constructor(e,t){let i=0,l="";v2(e)?(this.data_=e,i=e.size,l=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),i=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),i=e.length),this.size_=i,this.type_=l}size(){return this.size_}type(){return this.type_}slice(e,t){if(v2(this.data_)){const i=this.data_,l=uI(i,e,t);return l===null?null:new oo(l)}else{const i=new Uint8Array(this.data_.buffer,e,t-e);return new oo(i,!0)}}static getBlob(...e){if(Yy()){const t=e.map(i=>i instanceof oo?i.data_:i);return new oo(cI.apply(null,t))}else{const t=e.map(d=>Ky(d)?hI(Fa.RAW,d).data:d.data_);let i=0;t.forEach(d=>{i+=d.byteLength});const l=new Uint8Array(i);let u=0;return t.forEach(d=>{for(let p=0;p<d.length;p++)l[u++]=d[p]}),new oo(l,!0)}}uploadData(){return this.data_}}function Qy(n){let e;try{e=JSON.parse(n)}catch{return null}return eI(e)?e:null}function yI(n){if(n.length===0)return null;const e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function bI(n,e){const t=e.split("/").filter(i=>i.length>0).join("/");return n.length===0?t:n+"/"+t}function Vk(n){const e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}function vI(n,e){return e}class gr{constructor(e,t,i,l){this.server=e,this.local=t||e,this.writable=!!i,this.xform=l||vI}}let hh=null;function xI(n){return!Ky(n)||n.length<2?n:Vk(n)}function Uk(){if(hh)return hh;const n=[];n.push(new gr("bucket")),n.push(new gr("generation")),n.push(new gr("metageneration")),n.push(new gr("name","fullPath",!0));function e(u,d){return xI(d)}const t=new gr("name");t.xform=e,n.push(t);function i(u,d){return d!==void 0?Number(d):d}const l=new gr("size");return l.xform=i,n.push(l),n.push(new gr("timeCreated")),n.push(new gr("updated")),n.push(new gr("md5Hash",null,!0)),n.push(new gr("cacheControl",null,!0)),n.push(new gr("contentDisposition",null,!0)),n.push(new gr("contentEncoding",null,!0)),n.push(new gr("contentLanguage",null,!0)),n.push(new gr("contentType",null,!0)),n.push(new gr("metadata","customMetadata",!0)),hh=n,hh}function wI(n,e){function t(){const i=n.bucket,l=n.fullPath,u=new br(i,l);return e._makeStorageReference(u)}Object.defineProperty(n,"ref",{get:t})}function _I(n,e,t){const i={};i.type="file";const l=t.length;for(let u=0;u<l;u++){const d=t[u];i[d.local]=d.xform(i,e[d.server])}return wI(i,n),i}function Fk(n,e,t){const i=Qy(e);return i===null?null:_I(n,i,t)}function kI(n,e,t,i){const l=Qy(e);if(l===null||!Ky(l.downloadTokens))return null;const u=l.downloadTokens;if(u.length===0)return null;const d=encodeURIComponent;return u.split(",").map(y=>{const x=n.bucket,_=n.fullPath,j="/b/"+d(x)+"/o/"+d(_),O=Sm(j,t,i),K=Pk({alt:"media",token:y});return O+K})[0]}function jI(n,e){const t={},i=e.length;for(let l=0;l<i;l++){const u=e[l];u.writable&&(t[u.server]=n[u.local])}return JSON.stringify(t)}const x2="prefixes",w2="items";function TI(n,e,t){const i={prefixes:[],items:[],nextPageToken:t.nextPageToken};if(t[x2])for(const l of t[x2]){const u=l.replace(/\/$/,""),d=n._makeStorageReference(new br(e,u));i.prefixes.push(d)}if(t[w2])for(const l of t[w2]){const u=n._makeStorageReference(new br(e,l.name));i.items.push(u)}return i}function SI(n,e,t){const i=Qy(t);return i===null?null:TI(n,e,i)}class Xy{constructor(e,t,i,l){this.url=e,this.method=t,this.handler=i,this.timeout=l,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function Jy(n){if(!n)throw Gy()}function EI(n,e){function t(i,l){const u=Fk(n,l,e);return Jy(u!==null),u}return t}function NI(n,e){function t(i,l){const u=SI(n,e,l);return Jy(u!==null),u}return t}function CI(n,e){function t(i,l){const u=Fk(n,l,e);return Jy(u!==null),kI(u,l,n.host,n._protocol)}return t}function Zy(n){function e(t,i){let l;return t.getStatus()===401?t.getErrorText().includes("Firebase App Check token is invalid")?l=VM():l=BM():t.getStatus()===402?l=OM(n.bucket):t.getStatus()===403?l=UM(n.path):l=i,l.status=t.getStatus(),l.serverResponse=i.serverResponse,l}return e}function RI(n){const e=Zy(n);function t(i,l){let u=e(i,l);return i.getStatus()===404&&(u=LM(n.path)),u.serverResponse=l.serverResponse,u}return t}function AI(n,e,t,i,l){const u={};e.isRoot?u.prefix="":u.prefix=e.path+"/",t.length>0&&(u.delimiter=t),i&&(u.pageToken=i),l&&(u.maxResults=l);const d=e.bucketOnlyServerUrl(),p=Sm(d,n.host,n._protocol),g="GET",y=n.maxOperationRetryTime,x=new Xy(p,g,NI(n,e.bucket),y);return x.urlParams=u,x.errorHandler=Zy(e),x}function MI(n,e,t){const i=e.fullServerUrl(),l=Sm(i,n.host,n._protocol),u="GET",d=n.maxOperationRetryTime,p=new Xy(l,u,CI(n,t),d);return p.errorHandler=RI(e),p}function II(n,e){return n&&n.contentType||e&&e.type()||"application/octet-stream"}function DI(n,e,t){const i=Object.assign({},t);return i.fullPath=n.path,i.size=e.size(),i.contentType||(i.contentType=II(null,e)),i}function PI(n,e,t,i,l){const u=e.bucketOnlyServerUrl(),d={"X-Goog-Upload-Protocol":"multipart"};function p(){let Z="";for(let ke=0;ke<2;ke++)Z=Z+Math.random().toString().slice(2);return Z}const g=p();d["Content-Type"]="multipart/related; boundary="+g;const y=DI(e,i,l),x=jI(y,t),_="--"+g+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+x+`\r
--`+g+`\r
Content-Type: `+y.contentType+`\r
\r
`,j=`\r
--`+g+"--",O=oo.getBlob(_,i,j);if(O===null)throw WM();const K={name:y.fullPath},B=Sm(u,n.host,n._protocol),D="POST",te=n.maxUploadRetryTime,Y=new Xy(B,D,EI(n,t),te);return Y.urlParams=K,Y.headers=d,Y.body=O.uploadData(),Y.errorHandler=Zy(e),Y}class LI{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Jo.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Jo.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Jo.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,i,l,u){if(this.sent_)throw ru("cannot .send() more than once");if(_o(e)&&i&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(t,e,!0),u!==void 0)for(const d in u)u.hasOwnProperty(d)&&this.xhr_.setRequestHeader(d,u[d].toString());return l!==void 0?this.xhr_.send(l):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw ru("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw ru("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw ru("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw ru("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class OI extends LI{initXhr(){this.xhr_.responseType="text"}}function eb(){return new OI}class il{constructor(e,t){this._service=e,t instanceof br?this._location=t:this._location=br.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new il(e,t)}get root(){const e=new br(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return Vk(this._location.path)}get storage(){return this._service}get parent(){const e=yI(this._location.path);if(e===null)return null;const t=new br(this._location.bucket,e);return new il(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw YM(e)}}function BI(n,e,t){n._throwIfRoot("uploadBytes");const i=PI(n.storage,n._location,Uk(),new oo(e,!0),t);return n.storage.makeRequestWithTokens(i,eb).then(l=>({metadata:l,ref:n}))}function VI(n){const e={prefixes:[],items:[]};return zk(n,e).then(()=>e)}async function zk(n,e,t){const l=await UI(n,{pageToken:t});e.prefixes.push(...l.prefixes),e.items.push(...l.items),l.nextPageToken!=null&&await zk(n,e,l.nextPageToken)}function UI(n,e){e!=null&&typeof e.maxResults=="number"&&Pg("options.maxResults",1,1e3,e.maxResults);const t=e||{},i=AI(n.storage,n._location,"/",t.pageToken,t.maxResults);return n.storage.makeRequestWithTokens(i,eb)}function FI(n){n._throwIfRoot("getDownloadURL");const e=MI(n.storage,n._location,Uk());return n.storage.makeRequestWithTokens(e,eb).then(t=>{if(t===null)throw GM();return t})}function zI(n,e){const t=bI(n._location.path,e),i=new br(n._location.bucket,t);return new il(n.storage,i)}function qI(n){return/^[A-Za-z]+:\/\//.test(n)}function HI(n,e){return new il(n,e)}function qk(n,e){if(n instanceof tb){const t=n;if(t._bucket==null)throw $M();const i=new il(t,t._bucket);return e!=null?qk(i,e):i}else return e!==void 0?zI(n,e):n}function $I(n,e){if(e&&qI(e)){if(n instanceof tb)return HI(n,e);throw Dg("To use ref(service, url), the first argument must be a Storage instance.")}else return qk(n,e)}function _2(n,e){const t=e?.[Ik];return t==null?null:br.makeFromBucketSpec(t,n)}function WI(n,e,t,i={}){n.host=`${e}:${t}`;const l=_o(e);l&&(Wg(`https://${n.host}/b`),Gg("Storage",!0)),n._isUsingEmulator=!0,n._protocol=l?"https":"http";const{mockUserToken:u}=i;u&&(n._overrideAuthToken=typeof u=="string"?u:hw(u,n.app.options.projectId))}class tb{constructor(e,t,i,l,u,d=!1){this.app=e,this._authProvider=t,this._appCheckProvider=i,this._url=l,this._firebaseVersion=u,this._isUsingEmulator=d,this._bucket=null,this._host=Mk,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=DM,this._maxUploadRetryTime=PM,this._requests=new Set,l!=null?this._bucket=br.makeFromBucketSpec(l,this._host):this._bucket=_2(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=br.makeFromBucketSpec(this._url,e):this._bucket=_2(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){Pg("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){Pg("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if($r(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new il(this,e)}_makeRequest(e,t,i,l,u=!0){if(this._deleted)return new QM(Dk());{const d=oI(e,this._appId,i,l,t,this._firebaseVersion,u,this._isUsingEmulator);return this._requests.add(d),d.getPromise().then(()=>this._requests.delete(d),()=>this._requests.delete(d)),d}}async makeRequestWithTokens(e,t){const[i,l]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,i,l).getPromise()}}const k2="@firebase/storage",j2="0.14.0";const Hk="storage";function Mh(n,e,t){return n=Ys(n),BI(n,e,t)}function T2(n){return n=Ys(n),VI(n)}function fo(n){return n=Ys(n),FI(n)}function yi(n,e){return n=Ys(n),$I(n,e)}function GI(n=Xg(),e){n=Ys(n);const i=rm(n,Hk).getImmediate({identifier:e}),l=cw("storage");return l&&KI(i,...l),i}function KI(n,e,t,i={}){WI(n,e,t,i)}function YI(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),i=n.getProvider("auth-internal"),l=n.getProvider("app-check-internal");return new tb(t,i,l,e,ol)}function QI(){el(new po(Hk,YI,"PUBLIC").setMultipleInstances(!0)),za(k2,j2,""),za(k2,j2,"esm2020")}QI();const $k={apiKey:"AIzaSyBCIgMJd3By7qkWH27YiW9VooIBGE3bFLs",authDomain:"mind-core-fitness-client.firebaseapp.com",projectId:"mind-core-fitness-client",storageBucket:"mind-core-fitness-client.firebasestorage.app",messagingSenderId:"669343392406",appId:"1:669343392406:web:f5a35ee062387e7d6f58b7"},sb=Qg($k),qo=Xw(sb),ge=wM(sb),bi=GI(sb),XI=Qg($k,"secondary"),bP=Xw(XI),JI="EYdciKDOi3UYBLk1u8hHams5tmO2",Wk=b.createContext();function Ir(){return b.useContext(Wk)}function ZI({children:n}){const[e,t]=b.useState(null),[i,l]=b.useState(!1),[u,d]=b.useState(!1),[p,g]=b.useState(null),[y,x]=b.useState(!0);b.useEffect(()=>{let Y=null;const Z=r4(qo,ke=>{if(t(ke),Y&&(Y(),Y=null),ke)if(ke.uid===JI)l(!0),d(!1),g(null),x(!1);else{l(!1);const Re=As(Ht(ge,"clients"),gs("uid","==",ke.uid)),_e=async()=>{const C=localStorage.getItem("mcf_clientId");if(C)try{const T=await Is(Xe(ge,"clients",C));T.exists()&&(d(!0),g({id:T.id,...T.data()}))}catch(T){console.error("Direct client read failed:",T)}};Y=Rk(Re,async C=>{if(C.empty)await _e();else{const T=C.docs[0];d(!0),g({id:T.id,...T.data()});try{localStorage.setItem("mcf_clientId",T.id)}catch{}}x(!1)},async C=>{console.error("Error listening to client data:",C),await _e(),x(!1)})}else l(!1),d(!1),g(null),x(!1)});return()=>{Z(),Y&&Y()}},[]);const te={currentUser:e,isAdmin:i,isClient:u,clientData:p,updateClientData:Y=>{g(Z=>Z?{...Z,...Y}:Y)},resolveClient:async()=>{if(p)return p;const Y=localStorage.getItem("mcf_clientId");if(Y)try{const Z=await Is(Xe(ge,"clients",Y));if(Z.exists()){const ke={id:Z.id,...Z.data()};return d(!0),g(ke),ke}}catch(Z){console.error("resolveClient direct read failed:",Z)}if(e){const Z=As(Ht(ge,"clients"),gs("uid","==",e.uid)),ke=await Ts(Z);if(!ke.empty){const Re={id:ke.docs[0].id,...ke.docs[0].data()};return d(!0),g(Re),Re}}return null},login:async(Y,Z,ke=!0)=>(await lx(qo,ke?gg:ry),await t4(qo,Y,Z)),signup:async(Y,Z,ke)=>{await lx(qo,gg);const Re=await e4(qo,Z.trim().toLowerCase(),ke),_e=Re.user,C=Xe(Ht(ge,"clients")),T={uid:_e.uid,name:Y.trim(),email:Z.trim().toLowerCase(),clientType:"core_buddy",coreBuddyAccess:!0,status:"active",tier:"free",subscriptionStatus:null,signupSource:"self_signup",createdAt:Mt.now()};await Ds(C,T),d(!0),g({id:C.id,...T});try{localStorage.setItem("mcf_clientId",C.id)}catch{}return Re},logout:()=>{try{localStorage.removeItem("mcf_clientId")}catch{}return a4(qo)},resetPassword:Y=>ZC(qo,Y),loading:y};return r.jsx(Wk.Provider,{value:te,children:n})}const Gk=b.createContext();function Ca(){return b.useContext(Gk)}function eD({children:n}){const[e,t]=b.useState(()=>{const g=localStorage.getItem("theme");return g?g==="dark":window.matchMedia("(prefers-color-scheme: dark)").matches}),[i,l]=b.useState(()=>localStorage.getItem("accent")||"red");b.useEffect(()=>{document.documentElement.setAttribute("data-theme",e?"dark":"light"),localStorage.setItem("theme",e?"dark":"light")},[e]),b.useEffect(()=>{localStorage.setItem("accent",i)},[i]);const p={isDark:e,toggleTheme:()=>{document.documentElement.setAttribute("data-theme-transitioning",""),t(!e),setTimeout(()=>{document.documentElement.removeAttribute("data-theme-transitioning")},350)},accent:i,setAccent:g=>l(g)};return r.jsx(Gk.Provider,{value:p,children:n})}const Kk=b.createContext();function yc(){return b.useContext(Kk)}const tD=["nutrition","personalBests","achievements","buddies","programmes"],sD=[5,10],nD=3,rD=1;function aD({children:n}){const{clientData:e,loading:t}=Ir(),i=b.useMemo(()=>{const l=e?.tier||"free",u=e?.subscriptionStatus||null,d=e&&e.signupSource!=="self_signup",p=l==="premium"||!!d;function g(y){return p?!0:!tD.includes(y)}return{tier:l,subscriptionStatus:u,isPremium:p,canAccess:g,loading:t,FREE_RANDOMISER_DURATIONS:sD,FREE_RANDOMISER_WEEKLY_LIMIT:nD,FREE_HABIT_LIMIT:rD}},[e?.tier,e?.subscriptionStatus,e?.signupSource,t]);return r.jsx(Kk.Provider,{value:i,children:n})}function iD(n){if(n?.signupSource==="self_signup"&&!n?.onboardingComplete)return"/onboarding";const e=n?.clientType;return e==="core_buddy"?"/client/core-buddy":e==="circuit_vip"||e==="circuit_dropin"?"/client/circuit":"/client"}function oD({className:n=""}){const{isDark:e,toggleTheme:t}=Ca();return r.jsx("button",{className:n||"theme-toggle",onClick:t,"aria-label":e?"Switch to light mode":"Switch to dark mode",children:e?r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20",children:r.jsx("path",{d:"M12 3a9 9 0 109 9c0-.46-.04-.92-.1-1.36a5.389 5.389 0 01-4.4 2.26 5.403 5.403 0 01-3.14-9.8c-.44-.06-.9-.1-1.36-.1z"})}):r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20",children:r.jsx("path",{d:"M12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zM2 13h2c.55 0 1-.45 1-1s-.45-1-1-1H2c-.55 0-1 .45-1 1s.45 1 1 1zm18 0h2c.55 0 1-.45 1-1s-.45-1-1-1h-2c-.55 0-1 .45-1 1s.45 1 1 1zM11 2v2c0 .55.45 1 1 1s1-.45 1-1V2c0-.55-.45-1-1-1s-1 .45-1 1zm0 18v2c0 .55.45 1 1 1s1-.45 1-1v-2c0-.55-.45-1-1-1s-1 .45-1 1zM5.99 4.58a.996.996 0 00-1.41 0 .996.996 0 000 1.41l1.06 1.06c.39.39 1.03.39 1.41 0s.39-1.03 0-1.41L5.99 4.58zm12.37 12.37a.996.996 0 00-1.41 0 .996.996 0 000 1.41l1.06 1.06c.39.39 1.03.39 1.41 0a.996.996 0 000-1.41l-1.06-1.06zm1.06-10.96a.996.996 0 000-1.41.996.996 0 00-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06zM7.05 18.36a.996.996 0 000-1.41.996.996 0 00-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06z"})})})}function lD(){const[n,e]=b.useState(""),[t,i]=b.useState(""),[l,u]=b.useState(!0),[d,p]=b.useState(""),[g,y]=b.useState(!1),[x,_]=b.useState(!1),[j,O]=b.useState(!1),{login:K,resetPassword:B,currentUser:D,isAdmin:te,isClient:Y,clientData:Z,loading:ke}=Ir(),Re=tr();if(b.useEffect(()=>{!ke&&D&&(te?Re("/dashboard"):Y?Re(iD(Z)):(y(!1),p("No account found. Please sign up or contact your trainer.")))},[ke,D,te,Y,Z,Re]),ke||D)return r.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",minHeight:"100vh",background:"var(--bg-body)"},children:r.jsx("div",{style:{width:36,height:36,border:"3px solid var(--color-primary-light)",borderTopColor:"var(--color-primary)",borderRadius:"50%",animation:"app-spin .7s linear infinite"}})});const _e=async T=>{T.preventDefault(),p(""),y(!0);try{await K(n,t,l)}catch(M){p(M.message||"Failed to log in"),y(!1)}},C=async T=>{if(T.preventDefault(),p(""),!n.trim()){p("Please enter your email address");return}y(!0);try{await B(n.trim()),O(!0)}catch(M){M.code==="auth/user-not-found"?p("No account found with this email"):p(M.message||"Failed to send reset email")}y(!1)};return r.jsxs("div",{className:"login-container",children:[r.jsx(oD,{className:"login-theme-toggle"}),r.jsxs("div",{className:"login-card",children:[r.jsxs("div",{className:"login-header",children:[r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"login-logo"}),r.jsx("p",{children:r.jsx("strong",{children:x?"Reset Password":"Sign in as 1-2-1 or a Core Buddy"})})]}),d&&r.jsx("div",{className:"error-message",children:d}),j?r.jsxs("div",{className:"reset-sent",children:[r.jsx("div",{className:"reset-sent-icon",children:r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M22 2L11 13",strokeLinecap:"round",strokeLinejoin:"round"}),r.jsx("path",{d:"M22 2L15 22L11 13L2 9L22 2Z",strokeLinecap:"round",strokeLinejoin:"round"})]})}),r.jsx("p",{children:"Reset email sent!"}),r.jsx("span",{children:"Check your inbox for a password reset link"}),r.jsx("button",{className:"login-btn",style:{marginTop:"20px"},onClick:()=>{_(!1),O(!1),p("")},children:"Back to Log In"})]}):x?r.jsxs("form",{onSubmit:C,children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"email",children:"Email"}),r.jsx("input",{type:"email",id:"email",value:n,onChange:T=>e(T.target.value),placeholder:"Enter your email",required:!0})]}),r.jsx("button",{type:"submit",className:"login-btn",disabled:g,children:g?"Sending...":"Send Reset Link"}),r.jsx("button",{type:"button",className:"forgot-link",onClick:()=>{_(!1),p("")},children:"Back to Log In"})]}):r.jsxs(r.Fragment,{children:[r.jsxs("form",{onSubmit:_e,children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"email",children:"Email"}),r.jsx("input",{type:"email",id:"email",value:n,onChange:T=>e(T.target.value),required:!0})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"password",children:"Password"}),r.jsx("input",{type:"password",id:"password",value:t,onChange:T=>i(T.target.value),required:!0})]}),r.jsx("div",{className:"remember-me",children:r.jsxs("label",{children:[r.jsx("input",{type:"checkbox",checked:l,onChange:T=>u(T.target.checked)}),r.jsx("span",{children:"Remember me"})]})}),r.jsx("button",{type:"submit",className:"login-btn",disabled:g,children:g?"Logging in...":"Log In"})]}),r.jsx("button",{type:"button",className:"forgot-link",onClick:()=>{_(!0),p("")},children:"Forgot password?"}),r.jsx("button",{type:"button",className:"login-btn login-btn-outline",onClick:()=>Re("/signup"),children:"Don't have an account? Create one free"})]}),r.jsx("a",{href:"/",className:"back-link",children:"Back to website"})]})]})}function Ul({feature:n,children:e}){const{canAccess:t,loading:i}=yc();return i||t(n)?e:r.jsx(Z2,{to:"/upgrade",replace:!0})}function Ta({active:n}){const e=tr(),{clientData:t}=Ir(),{isPremium:i}=yc(),l=t?.clientType==="block"&&t?.coreBuddyAccess;return r.jsxs("nav",{className:"block-bottom-nav",children:[r.jsxs("button",{className:`block-nav-tab${n==="home"?" active":""}`,onClick:()=>e("/client/core-buddy"),children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),r.jsx("circle",{cx:"12",cy:"7",r:"4"})]}),r.jsx("span",{children:"Profile"})]}),r.jsxs("button",{className:`block-nav-tab${n==="workouts"?" active":""}`,onClick:()=>e("/client/core-buddy/workouts"),children:[r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"currentColor",stroke:"none",children:r.jsx("path",{d:"M1 9h2v6H1V9zm3-2h2v10H4V7zm3 4h10v2H7v-2zm10-4h2v10h-2V7zm3 2h2v6h-2V9z"})}),r.jsx("span",{children:"Workouts"})]}),i&&r.jsxs("button",{className:`block-nav-tab${n==="nutrition"?" active":""}`,onClick:()=>e("/client/core-buddy/nutrition"),children:[r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M18 8h1a4 4 0 0 1 0 8h-1M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z"})}),r.jsx("span",{children:"Nutrition"})]}),i&&r.jsxs("button",{className:`block-nav-tab${n==="buddies"?" active":""}`,onClick:()=>e("/client/core-buddy/buddies"),children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),r.jsx("circle",{cx:"9",cy:"7",r:"4"}),r.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),r.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),r.jsx("span",{children:"Buddies"})]}),l&&r.jsxs("button",{className:"block-nav-tab",onClick:()=>e("/client"),children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"3",width:"7",height:"7"}),r.jsx("rect",{x:"14",y:"3",width:"7",height:"7"}),r.jsx("rect",{x:"14",y:"14",width:"7",height:"7"}),r.jsx("rect",{x:"3",y:"14",width:"7",height:"7"})]}),r.jsx("span",{children:"Block"})]})]})}function Sa({children:n,onRefresh:e}){const[t,i]=b.useState(0),[l,u]=b.useState(!1),d=b.useRef(null),p=b.useRef(0),g=b.useRef(!1),y=b.useCallback(j=>{window.scrollY<=0&&(p.current=j.touches[0].clientY,g.current=!0)},[]),x=b.useCallback(j=>{if(!g.current||l)return;const O=j.touches[0].clientY-p.current;O>20&&window.scrollY<=0&&(j.preventDefault(),i(Math.min((O-20)*.35,80)))},[l]),_=b.useCallback(async()=>{t>55&&!l&&(u(!0),e?await e():window.location.reload(),u(!1)),i(0),g.current=!1},[t,l,e]);return r.jsxs("div",{ref:d,onTouchStart:y,onTouchMove:x,onTouchEnd:_,children:[r.jsxs("div",{className:`pull-refresh-indicator ${t>0?"visible":""} ${l?"refreshing":""}`,style:{height:t},children:[r.jsx("div",{className:`refresh-spinner ${l?"spinning":""}`,children:r.jsx("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:r.jsx("path",{fill:"currentColor",d:"M17.65 6.35A7.958 7.958 0 0012 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08A5.99 5.99 0 0112 18c-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"})})}),r.jsx("span",{className:"refresh-text",children:l?"Refreshing...":"Pull to refresh"})]}),n]})}function ed(n,e,t,i,l){const u=[];for(let d=0;d<n;d++){const p=(d*(360/n)-90)*(Math.PI/180);u.push({x1:e+i*Math.cos(p),y1:t+i*Math.sin(p),x2:e+l*Math.cos(p),y2:t+l*Math.sin(p),thick:d%5===0})}return u}const Em=ed(60,100,100,85,96),Yk=ed(60,100,100,78,94),cD=ed(60,100,100,82,94);ed(60,50,50,38,46);const S2=ed(60,40,40,30,37),uD="/login/assets/first_workout-B8SFkzJX.PNG",dD="/login/assets/workouts_10-Z5R3u0xH.PNG",hD="/login/assets/workouts_25-CzxSlcAj.PNG",mD="/login/assets/workouts_50-BpzWup3V.PNG",fD="/login/assets/workouts_100-D7_r6tn1.PNG",pD="/login/assets/streak_2-CsRr-XA9.PNG",gD="/login/assets/streak_4-BHO09tbw.PNG",yD="/login/assets/streak_8-DX2UWMko.PNG",bD="/login/assets/first_pb-aVf_CNWy.PNG",vD="/login/assets/pbs_5-Cippawgg.PNG",xD="/login/assets/pbs_10-CZgGh9Kv.PNG",wD="/login/assets/pbs_100-C67b1wfS.PNG",_D="/login/assets/nutrition_7-CHVV11fj.PNG",kD="/login/assets/leaderboard_join-BLoId4Hz.PNG",jD="/login/assets/habits_7-Dvki70KO.PNG",Bn=[{id:"first_workout",img:uD,name:"First Rep",desc:"Complete your first workout",category:"workouts",threshold:1},{id:"workouts_10",img:dD,name:"On Fire",desc:"Complete 10 workouts",category:"workouts",threshold:10},{id:"workouts_25",img:hD,name:"Dedicated",desc:"Complete 25 workouts",category:"workouts",threshold:25},{id:"workouts_50",img:mD,name:"Unstoppable",desc:"Complete 50 workouts",category:"workouts",threshold:50},{id:"workouts_100",img:fD,name:"Century",desc:"Complete 100 workouts",category:"workouts",threshold:100},{id:"streak_2",img:pD,name:"2 Week Streak",desc:"Work out for 2 weeks in a row",category:"streaks",threshold:2},{id:"streak_4",img:gD,name:"Month Strong",desc:"Work out for 4 weeks in a row",category:"streaks",threshold:4},{id:"streak_8",img:yD,name:"Iron Will",desc:"Work out for 8 weeks in a row",category:"streaks",threshold:8},{id:"first_pb",img:bD,name:"First PB",desc:"Set your first personal best",category:"pbs",threshold:1},{id:"pbs_5",img:vD,name:"PB Hunter",desc:"Set 5 personal bests",category:"pbs",threshold:5},{id:"pbs_10",img:xD,name:"PB Machine",desc:"Set 10 personal bests",category:"pbs",threshold:10},{id:"pbs_100",img:wD,name:"PB Legend",desc:"Set 100 personal bests",category:"pbs",threshold:100},{id:"nutrition_7",img:_D,name:"Macro Master",desc:"Hit your macro targets 7 days in a row",category:"nutrition",threshold:7},{id:"leaderboard_join",img:kD,name:"Competitor",desc:"Join the leaderboard",category:"leaderboard",threshold:1},{id:"habits_7",img:jD,name:"Habit Streak",desc:"Complete your daily habits 7 days in a row",category:"habits",threshold:7}];function TD({steps:n,onFinish:e,active:t}){const[i,l]=b.useState(0),[u,d]=b.useState(null),[p,g]=b.useState("below"),[y,x]=b.useState(!1),_=b.useRef(null),j=b.useRef(t);j.current=t,b.useEffect(()=>{t||l(0)},[t]),b.useEffect(()=>{if(!t)return;const Re=_e=>_e.preventDefault();return document.addEventListener("touchmove",Re,{passive:!1}),document.addEventListener("wheel",Re,{passive:!1}),document.body.style.overflow="hidden",()=>{document.removeEventListener("touchmove",Re),document.removeEventListener("wheel",Re),document.body.style.overflow=""}},[t]);const O=b.useMemo(()=>t?n.filter(Re=>document.querySelector(Re.selector)):[],[t]),K=O[i],B=i===O.length-1,D=K?.selector,te=b.useCallback(()=>{if(!D)return;const Re=document.querySelector(D);if(!Re){d(null);return}const _e=Re.getBoundingClientRect(),C=8;d({top:_e.top-C,left:_e.left-C,width:_e.width+C*2,height:_e.height+C*2});const T=window.innerHeight-_e.bottom;g(T<260?"above":"below")},[D]);if(b.useEffect(()=>{if(!t||!D)return;x(!0);const Re=document.querySelector(D);if(Re){document.body.style.overflow="",Re.scrollIntoView({behavior:"smooth",block:"center"});let _e=null,C=0,T=0;const M=60,V=()=>{T++;const A=Re.getBoundingClientRect(),Le=Math.round(A.top);if(_e!==null&&Le===_e?C++:C=0,_e=Le,C>=3||T>=M){j.current&&(document.body.style.overflow="hidden"),te(),x(!1);return}I=requestAnimationFrame(V)};let I;const L=setTimeout(()=>{I=requestAnimationFrame(V)},120);return()=>{clearTimeout(L),I&&cancelAnimationFrame(I),j.current&&(document.body.style.overflow="hidden")}}},[t,i,D,te]),b.useEffect(()=>{if(!t)return;const Re=()=>{_.current&&cancelAnimationFrame(_.current),_.current=requestAnimationFrame(te)};return window.addEventListener("scroll",Re,!0),window.addEventListener("resize",Re),()=>{window.removeEventListener("scroll",Re,!0),window.removeEventListener("resize",Re),_.current&&cancelAnimationFrame(_.current)}},[t,te]),!t||!K||O.length===0)return null;const Y=()=>{B?e():l(i+1)},Z=()=>{i>0&&l(i-1)},ke=()=>e();return r.jsxs("div",{className:"st-overlay",onClick:Re=>{Re.stopPropagation()},children:[r.jsx("div",{className:"st-backdrop",onClick:Y}),u&&r.jsx("div",{className:`st-spotlight${y?" st-transitioning":""}`,style:{top:u.top,left:u.left,width:u.width,height:u.height}}),u&&r.jsxs("div",{className:`st-tooltip st-tooltip-${p}${y?" st-transitioning":""}`,style:{top:p==="below"?Math.min(Math.max(u.top+u.height+16,16),window.innerHeight-200):void 0,bottom:p==="above"?Math.min(Math.max(window.innerHeight-u.top+16,16),window.innerHeight-60):void 0,left:Math.max(16,Math.min(u.left,window.innerWidth-320))},children:[r.jsx("div",{className:"st-dots",children:O.map((Re,_e)=>r.jsx("span",{className:`st-dot${_e===i?" active":""}${_e<i?" done":""}`},_e))}),r.jsx("h3",{className:"st-title",children:K.title}),r.jsx("p",{className:"st-body",children:K.body}),r.jsxs("div",{className:"st-actions",children:[i>0&&r.jsx("button",{className:"st-btn st-btn-back",onClick:Z,children:"Back"}),r.jsx("button",{className:"st-btn st-btn-next",onClick:Y,children:K.cta||(B?"Let's Go!":"Next")})]}),r.jsx("button",{className:"st-skip",onClick:ke,children:"Skip tour"})]})]})}const E2=3,SD=5;function au(n){return n.toISOString().split("T")[0]}const ED={fullbody_4wk:{duration:4,daysPerWeek:3},fullbody_8wk:{duration:8,daysPerWeek:3},fullbody_12wk:{duration:12,daysPerWeek:3},core_4wk:{duration:4,daysPerWeek:3},core_8wk:{duration:8,daysPerWeek:3},core_12wk:{duration:12,daysPerWeek:3},upper_4wk:{duration:4,daysPerWeek:3},lower_4wk:{duration:4,daysPerWeek:3}},ND={fullbody_4wk:["Push Focus","Pull Focus","Legs & Core"],fullbody_8wk:["Strength","Power","Endurance"],fullbody_12wk:["Upper Push","Lower Body","Upper Pull"],core_4wk:["Abs","Stability","Power Core"],core_8wk:["Anti-Extension","Rotation","Power"],core_12wk:["Strength","Endurance","Power"],upper_4wk:["Push","Pull","Mixed"],lower_4wk:["Quad Dominant","Hamstring & Glute","Power & Stability"]},Wp=[{text:"You have 24 hours a day...",bold:"make it count"},{text:"Discipline beats motivation...",bold:"every single time"},{text:"Rest when you're done,",bold:"not when you're tired"},{text:"Small daily gains...",bold:"create massive results"},{text:"Your body keeps score,",bold:"train it well"},{text:"Consistency over intensity...",bold:"always wins"},{text:"The only bad workout...",bold:"is the one you skipped"}];function Gp(n){if(!n)return"";const e=n instanceof Date?n:n.toDate?n.toDate():new Date(n),t=Math.floor((new Date-e)/1e3);return t<60?"just now":t<3600?`${Math.floor(t/60)}m ago`:t<86400?`${Math.floor(t/3600)}h ago`:t<604800?`${Math.floor(t/86400)}d ago`:e.toLocaleDateString("en-GB",{day:"numeric",month:"short"})}function iu(n){if(!n)return"?";const e=n.trim().split(/\s+/);return e.length===1?e[0][0].toUpperCase():(e[0][0]+e[e.length-1][0]).toUpperCase()}function CD(n,e=800){return new Promise(t=>{const i=new Image;i.onload=()=>{const l=document.createElement("canvas");let u=i.width,d=i.height;u>d?u>e&&(d=Math.round(d*e/u),u=e):d>e&&(u=Math.round(u*e/d),d=e),l.width=u,l.height=d,l.getContext("2d").drawImage(i,0,0,u,d),l.toBlob(p=>t(p),"image/jpeg",.8)},i.src=URL.createObjectURL(n)})}function RD(){const{currentUser:n,isClient:e,clientData:t,logout:i,updateClientData:l,loading:u}=Ir(),{isDark:d,toggleTheme:p}=Ca(),{isPremium:g,FREE_HABIT_LIMIT:y}=yc(),x=tr(),_=g?SD:y,[j,O]=b.useState({hours:0,minutes:0,seconds:0}),[K,B]=b.useState(0),[D,te]=b.useState(0),[Y,Z]=b.useState(""),[ke,Re]=b.useState(0),[_e,C]=b.useState(0),[T,M]=b.useState(!1),[V,I]=b.useState({protein:0,carbs:0,fats:0,calories:0}),[L,A]=b.useState(null),[Le,ht]=b.useState(0),[$,pe]=b.useState(null),[Be,We]=b.useState(!1),[J,P]=b.useState(!1),[re,Fe]=b.useState(0),[qe,Ve]=b.useState(E2),[Me,mt]=b.useState(!1),[wt,ot]=b.useState(!1),[es,Ns]=b.useState(0),[Ft,Tt]=b.useState([]),[oe,Dt]=b.useState([]),[Nt,Kt]=b.useState(null),[Et,Ct]=b.useState(!1),lt=b.useRef(null),[Ot,Wt]=b.useState([]),[ms,Gt]=b.useState(null),[Pt,us]=b.useState(null),xs=b.useRef(null),[is,Qs]=b.useState(0),[Ms,Fs]=b.useState(0),[os,ws]=b.useState(0),[be,Ie]=b.useState(0),[De,rt]=b.useState(null),Ke=b.useCallback((S,U="info")=>{rt({message:S,type:U}),setTimeout(()=>rt(null),4e3)},[]),[at,gt]=b.useState([]),[X,se]=b.useState(!1),[Qe,_t]=b.useState(""),[et,kt]=b.useState(null),[Q,Ae]=b.useState(null),[Je,yt]=b.useState(!1),[it,Jt]=b.useState(new Set),[Yt,F]=b.useState(new Set),[ye,Ee]=b.useState({}),[Te,Se]=b.useState({}),[bt,At]=b.useState({}),[ft,zt]=b.useState({}),[Bt,Ps]=b.useState({}),[hn,tn]=b.useState({}),En=b.useRef(null),zs=b.useRef(null),sn=b.useRef({}),[hs,G]=b.useState([]),[me,ae]=b.useState(!1),xe=b.useRef(null),[E,z]=b.useState([]),[ie,ne]=b.useState(""),[Ze,nt]=b.useState(!1),[ct,Lt]=b.useState(null),[xt,fs]=b.useState([]),[nn,Dr]=b.useState(null),[ps,ur]=b.useState(!1),dr=b.useRef(!1),ua=(()=>{const S=[{selector:".cb-ring-container",title:"Your 24-Hour Countdown",body:"Every day resets. This ring tracks the time you have left  tap your photo to personalise your profile.",cta:"Next"},{selector:".cb-stats-row",title:"Progress at a Glance",body:"Programme completion, workouts this week, and daily habits  all in one row. These fill up as you go."},{selector:".cb-nudge-card",title:"Smart Suggestions",body:"We'll highlight what needs your attention  your next session, unfinished habits, or a meal to log."},{selector:".cb-card-workouts-hero",title:"Workouts",body:"Quick randomiser sessions or structured programmes  pick your focus, level and time.",cta:"Next"}];return g&&S.push({selector:".cb-card-nutrition",title:"Nutrition Tracking",body:"Set your macro targets, scan barcodes, and log meals to hit your daily goals."},{selector:".cb-card-consistency",title:"Daily Habits",body:"5 simple habits each day  train, hit protein, 10k steps, sleep, and hydrate. Build your streak."},{selector:".cb-card-buddies",title:"Buddies & Social",body:"Connect with other members, share your journey, and keep each other accountable."},{selector:".cb-journey-section",title:"Share Your Journey",body:"Post photos, updates, and milestones  your fitness journey in one place. Like and comment on each other's posts."},{selector:".cb-achievements-section",title:"Achievements",body:"Every rep counts towards badges  volume milestones, workout streaks, and more to unlock."}),S.push({selector:".block-bottom-nav",title:"You're All Set!",body:"Use the nav bar to jump between your profile, workouts, nutrition, and buddies. Time to get after it.",cta:"Let's Go!"}),S})();b.useEffect(()=>{!u&&!n&&x("/")},[u,n,x]),b.useEffect(()=>{!u&&t&&t.signupSource==="self_signup"&&!t.onboardingComplete&&x("/onboarding")},[u,t,x]),b.useEffect(()=>{let S=t?.tourComplete||dr.current;if(!S&&t?.id)try{S=!!localStorage.getItem(`tourDone_${t.id}`)}catch{}if(T&&t&&!S){const U=setTimeout(()=>ur(!0),600);return()=>clearTimeout(U)}},[T,t]),b.useEffect(()=>{if(!(!T||!t?.id)){try{if(localStorage.getItem(`targetHint_${t.id}`))return}catch{}if(!t?.weeklyWorkoutTarget){const S=setTimeout(()=>ot(!0),1500);return()=>clearTimeout(S)}}},[T,t]),b.useEffect(()=>{if(t)try{const S=sessionStorage.getItem(`cbDash_${t.id}`);if(S){const U=JSON.parse(S);te(U.programmePct??0),Z(U.programmeName??""),Re(U.totalWorkouts??0),C(U.habitWeekPct??0),I(U.nutritionTotals??{protein:0,carbs:0,fats:0,calories:0}),A(U.nutritionTargetData??null),ht(U.todayHabitsCount??0),pe(U.nextSession??null),We(U.hasProgramme??!1),P(U.programmeComplete??!1),Fe(U.weeklyWorkouts??0),Ve(U.weeklyWorkoutTarget??E2),Ns(U.pbCount??0),Tt(U.topPBs??[]),Dt(U.leaderboardTop3??[]),Wt(U.unlockedBadges??[]),xs.current=U.unlockedBadges??[],Qs(U.streakWeeks??0),M(!0)}}catch{}},[t]),b.useEffect(()=>{t?.photoURL&&Kt(t.photoURL),t?.weeklyWorkoutTarget&&Ve(t.weeklyWorkoutTarget)},[t]),b.useEffect(()=>{if(!t)return;const S=As(Ht(ge,"notifications"),gs("toId","==",t.id)),U=Rk(S,je=>{const Ye=je.docs.map(He=>({id:He.id,...He.data()}));Ye.sort((He,tt)=>{const Ge=He.createdAt?.toMillis?.()||0;return(tt.createdAt?.toMillis?.()||0)-Ge}),G(Ye.slice(0,50))},je=>{console.error("Notification listener error:",je),je.code==="permission-denied"&&console.warn("Firestore rules may be missing for the notifications collection. Please update your Firestore rules in the Firebase Console.")});return()=>U()},[t]),b.useEffect(()=>{const S=U=>{xe.current&&!xe.current.contains(U.target)&&ae(!1)};return document.addEventListener("mousedown",S),()=>document.removeEventListener("mousedown",S)},[]),b.useEffect(()=>{if(!t)return;const S=t.id;(async()=>{try{const[U,je,Ye]=await Promise.all([Ts(As(Ht(ge,"buddies"),gs("user1","==",S))),Ts(As(Ht(ge,"buddies"),gs("user2","==",S))),Ts(Ht(ge,"clients"))]),He=new Set;[...U.docs,...je.docs].forEach(Ge=>{const ut=Ge.data();He.add(ut.user1===S?ut.user2:ut.user1)});const tt={};Ye.docs.forEach(Ge=>{tt[Ge.id]=Ge.data()}),z(Array.from(He).filter(Ge=>tt[Ge]).map(Ge=>({id:Ge,name:tt[Ge].name,photoURL:tt[Ge].photoURL||null})))}catch(U){console.error("Error loading buddies for mentions:",U)}})()},[t]);const Nn=hs.filter(S=>!S.read).length,Ra=async()=>{const S=hs.filter(je=>!je.read);if(!S.length)return;const U=b2(ge);S.forEach(je=>U.update(Xe(ge,"notifications",je.id),{read:!0})),await U.commit()},Ri=async()=>{if(!hs.length)return;const S=b2(ge);hs.forEach(U=>S.delete(Xe(ge,"notifications",U.id))),await S.commit()},Yr=async(S,U,je={})=>{if(!(!t||S===t.id))try{await Gr(Ht(ge,"notifications"),{toId:S,fromId:t.id,fromName:t.name||"Someone",fromPhotoURL:t.photoURL||null,type:U,read:!1,createdAt:yr(),...je})}catch(Ye){console.error("Notification create error:",Ye),Ye.code==="permission-denied"&&Ke("Notifications blocked  check Firestore rules","error")}},hr=(S,U)=>{const je=U==="compose"?En.current?.selectionStart:null,He=(je!=null?S.slice(0,je):S).match(/@(\w*)$/);if(He){nt(!0),Lt(U),ne(He[1].toLowerCase());const tt=E.filter(Ge=>Ge.name&&Ge.name.toLowerCase().includes(He[1].toLowerCase())).slice(0,5);fs(tt)}else nt(!1),fs([])},Xa=(S,U)=>{if(U==="compose"){const je=En.current,Ye=Qe,He=je?.selectionStart??Ye.length,tt=Ye.slice(0,He),Ge=Ye.slice(He),ut=tt.replace(/@\w*$/,`@${S.name} `);_t(ut+Ge),setTimeout(()=>{je?.focus(),je.selectionStart=je.selectionEnd=ut.length},0)}else{const Ye=(Te[U]||"").replace(/@\w*$/,`@${S.name} `);Se(He=>({...He,[U]:Ye}))}nt(!1),fs([])},Pr=S=>S&&S.split(/(@\w[\w\s]*?\s)/g).map((je,Ye)=>je.startsWith("@")&&E.some(He=>je.trim()===`@${He.name}`)?r.jsx("span",{className:"mention-highlight",children:je.trim()},Ye):je),Un=async S=>{const U=S.target.files?.[0];if(!(!U||!t)){if(!U.type.startsWith("image/")){Ke("Please select an image file","error");return}if(U.size>5*1024*1024){Ke("Image must be under 5MB","error");return}Ct(!0);try{const je=await new Promise(tt=>{const Ge=new Image;Ge.onload=()=>{const ut=document.createElement("canvas"),St=400;let ns=Ge.width,Zt=Ge.height;ns>Zt?(Zt=Zt/ns*St,ns=St):(ns=ns/Zt*St,Zt=St),ut.width=ns,ut.height=Zt,ut.getContext("2d").drawImage(Ge,0,0,ns,Zt),ut.toBlob(ys=>tt(ys),"image/jpeg",.75)},Ge.src=URL.createObjectURL(U)}),Ye=yi(bi,`profilePhotos/${t.id}`);await Mh(Ye,je);const He=await fo(Ye);await oa(Xe(ge,"clients",t.id),{photoURL:He}),Kt(He),l({photoURL:He}),Ke("Profile photo updated!","success")}catch(je){console.error("Photo upload error:",je),Ke("Failed to upload photo","error")}Ct(!1),lt.current&&(lt.current.value="")}};b.useEffect(()=>{const S=()=>{const je=new Date,Ye=new Date(je);Ye.setHours(23,59,59,999);const He=Ye-je,tt=Math.floor(He/(1e3*60*60)),Ge=Math.floor(He%(1e3*60*60)/(1e3*60)),ut=Math.floor(He%(1e3*60)/1e3);O({hours:tt,minutes:Ge,seconds:ut}),B(60-ut)};S();const U=setInterval(S,1e3);return()=>clearInterval(U)},[]),b.useEffect(()=>{const S=setInterval(()=>{Ie(U=>(U+1)%Wp.length)},8e3);return()=>clearInterval(S)},[]),b.useEffect(()=>{if(!n||!t)return;(async()=>{let U=null,je=0,Ye=[],He=!1,tt=null;try{const Ge=au(new Date),ut=await Is(Xe(ge,"clientProgrammes",t.id));if(ut.exists()){const gn=ut.data(),Ln=ED[gn.templateId];if(We(!0),Ln){const jr=gn.completedSessions||{},Tr=Object.keys(jr).length,So=Ln.duration*Ln.daysPerWeek;te(So>0?Math.round(Tr/So*100):0);const Ma=gn.templateId.replace(/_/g," ").replace(/\b\w/g,ha=>ha.toUpperCase());Z(Ma);const Gn=ND[gn.templateId];let Za=!1;for(let ha=1;ha<=Ln.duration&&!Za;ha++)for(let nr=0;nr<Ln.daysPerWeek&&!Za;nr++)jr[`w${ha}d${nr}`]||(pe({week:ha,dayIdx:nr,label:Gn?.[nr]||`Day ${nr+1}`}),Za=!0);Za||(P(!0),He=!0)}}const St=Ht(ge,"workoutLogs"),ns=As(St,gs("clientId","==",t.id));U=await Ts(ns),Re(U.docs.length);const Zt=new Date,ys=Zt.getDay(),rn=ys===0?6:ys-1,ln=new Date(Zt);ln.setDate(Zt.getDate()-rn),ln.setHours(0,0,0,0);const Bs=ln.getTime(),Zs=U.docs.filter(gn=>{const Ln=gn.data().completedAt;return Ln?(Ln.toDate?Ln.toDate().getTime():new Date(Ln).getTime())>=Bs:!1}).length;Fe(Zs);const _n=Ht(ge,"habitLogs"),pn=As(_n,gs("clientId","==",t.id),gs("date","==",Ge)),$n=await Ts(pn);let Wn=0;if(!$n.empty){const gn=$n.docs[0].data().habits||{};Wn=Math.min(Object.values(gn).filter(Boolean).length,_)}C(Math.round(Wn/_*100)),ht(Wn);const kr=await Is(Xe(ge,"nutritionTargets",t.id));kr.exists()&&(A(kr.data()),tt=kr.data());const fr=await Is(Xe(ge,"nutritionLogs",`${t.id}_${Ge}`));if(fr.exists()){const Ln=(fr.data().entries||[]).reduce((jr,Tr)=>({protein:jr.protein+(Tr.protein||0),carbs:jr.carbs+(Tr.carbs||0),fats:jr.fats+(Tr.fats||0),calories:jr.calories+(Tr.calories||0)}),{protein:0,carbs:0,fats:0,calories:0});I(Ln)}}catch(Ge){console.error("Error loading dashboard stats:",Ge)}try{let Ge=[];const ut=await Is(Xe(ge,"coreBuddyPBs",t.id));if(ut.exists()){const St=ut.data().exercises||{};Ns(Object.keys(St).length),je=Object.keys(St).length,Ge=Object.entries(St).sort(([,ns],[,Zt])=>(Zt.weight||0)-(ns.weight||0)).slice(0,3).map(([ns,Zt])=>({name:ns,weight:Zt.weight,reps:Zt.reps}))}Ye=Ge,Tt(Ge)}catch(Ge){console.error("PB fetch error:",Ge)}try{const Ge=Ht(ge,"clients"),ut=As(Ge,gs("leaderboardOptIn","==",!0)),ns=(await Ts(ut)).docs.map(Zt=>({id:Zt.id,name:Zt.data().name,photoURL:Zt.data().photoURL||null}));Dt(ns.slice(0,3))}catch(Ge){console.error("Leaderboard preview error:",Ge)}try{let Ge=0;if(U){const Bs=U.docs.map(Zs=>Zs.data().date).filter(Boolean).sort().reverse();if(Bs.length>0){const Zs=new Date;let _n=new Date(Zs);e:for(let pn=0;pn<52;pn++){const $n=new Date(_n),Wn=$n.getDay(),kr=Wn===0?6:Wn-1;$n.setDate($n.getDate()-kr),$n.setHours(0,0,0,0);const fr=new Date($n);fr.setDate(fr.getDate()+7);const gn=au($n),Ln=au(fr);if(Bs.some(Tr=>Tr>=gn&&Tr<Ln))Ge++;else{if(pn>0)break e;break}_n.setDate(_n.getDate()-7)}}}Qs(Ge);let ut=0;for(let Bs=0;Bs<30;Bs++){const Zs=new Date;Zs.setDate(Zs.getDate()-Bs);const _n=au(Zs);try{const pn=await Ts(As(Ht(ge,"habitLogs"),gs("clientId","==",t.id),gs("date","==",_n)));if(pn.empty)break;{const $n=pn.docs[0].data().habits||{};if(Object.values($n).filter(Boolean).length>=_)ut++;else break}}catch{break}}Fs(ut);let St=0;for(let Bs=0;Bs<30;Bs++){const Zs=new Date;Zs.setDate(Zs.getDate()-Bs);const _n=au(Zs);try{const pn=await Is(Xe(ge,"nutritionLogs",`${t.id}_${_n}`));if(pn.exists()&&(pn.data().entries||[]).length>0)if(tt){const Wn=(pn.data().entries||[]).reduce((kr,fr)=>({protein:kr.protein+(fr.protein||0),carbs:kr.carbs+(fr.carbs||0),fats:kr.fats+(fr.fats||0)}),{protein:0,carbs:0,fats:0});if(Wn.protein>=(tt.protein||0)&&Wn.carbs>=(tt.carbs||0)&&Wn.fats>=(tt.fats||0))St++;else break}else St++;else break}catch{break}}ws(St);const ns=U?U.docs.length:0,Zt=[],ys=Bs=>Zt.push(Bs);ns>=1&&ys("first_workout"),ns>=10&&ys("workouts_10"),ns>=25&&ys("workouts_25"),ns>=50&&ys("workouts_50"),ns>=100&&ys("workouts_100"),Ge>=2&&ys("streak_2"),Ge>=4&&ys("streak_4"),Ge>=8&&ys("streak_8"),je>=1&&ys("first_pb"),je>=5&&ys("pbs_5"),je>=10&&ys("pbs_10"),je>=100&&ys("pbs_100"),St>=7&&ys("nutrition_7"),t.leaderboardOptIn&&ys("leaderboard_join"),ut>=7&&ys("habits_7"),Wt(Zt);const rn=xs.current;if(rn!==null){const Bs=Zt.filter(Zs=>!rn.includes(Zs));if(Bs.length>0){const Zs=Bn.find(_n=>_n.id===Bs[Bs.length-1]);Zs&&setTimeout(()=>us(Zs),600)}}xs.current=Zt;const ln={};Zt.forEach(Bs=>{ln[Bs]={unlockedAt:new Date().toISOString()}}),Ds(Xe(ge,"achievements",t.id),{badges:ln,progress:{streakWeeks:Ge,pbCount:je,nutritionStreak:St,habitStreak:ut},updatedAt:new Date().toISOString()},{merge:!0}).catch(()=>{})}catch(Ge){console.error("Achievement computation error:",Ge)}M(!0)})()},[n,t,_]),b.useEffect(()=>{if(!(!T||!t))try{sessionStorage.setItem(`cbDash_${t.id}`,JSON.stringify({programmePct:D,programmeName:Y,totalWorkouts:ke,habitWeekPct:_e,nutritionTotals:V,nutritionTargetData:L,todayHabitsCount:Le,nextSession:$,hasProgramme:Be,programmeComplete:J,weeklyWorkouts:re,weeklyWorkoutTarget:qe,pbCount:es,topPBs:Ft,leaderboardTop3:oe,unlockedBadges:Ot,streakWeeks:is}))}catch{}},[T,D,Y,ke,_e,V,L,Le,$,Be,J,re,qe,es,Ft,oe,Ot,is,t]);const Ai=b.useCallback(async()=>{if(dr.current=!0,ur(!1),l({tourComplete:!0}),t?.id){try{localStorage.setItem(`tourDone_${t.id}`,"1")}catch{}try{await oa(Xe(ge,"clients",t.id),{tourComplete:!0})}catch(S){console.error("Failed to save tour completion:",S)}}},[t,l]),Ja=b.useCallback(async S=>{if(Ve(S),mt(!1),ot(!1),t?.id){try{localStorage.setItem(`targetHint_${t.id}`,"1")}catch{}try{await oa(Xe(ge,"clients",t.id),{weeklyWorkoutTarget:S})}catch(U){console.error("Failed to save weekly target:",U)}}},[t]),_r=S=>{const U=S.currentTarget,je=U.querySelector(".ripple");je&&je.remove();const Ye=U.getBoundingClientRect(),He=Math.max(Ye.width,Ye.height),tt=S.clientX-Ye.left-He/2,Ge=S.clientY-Ye.top-He/2,ut=document.createElement("span");ut.className="ripple",ut.style.cssText=`width:${He}px;height:${He}px;left:${tt}px;top:${Ge}px;`,U.appendChild(ut),setTimeout(()=>ut.remove(),600)},Aa=t?.name?.split(" ")[0]||"there",Mi=Math.min(Math.round(re/qe*100),100),Qr=[{label:"Programme",value:`${D}%`,pct:D,color:"var(--color-primary)",size:"normal"},{label:"Workouts",value:`${re}/${qe}`,pct:Mi,color:"var(--color-primary)",size:"large",editable:!0},{label:"Habits Today",value:`${_e}%`,pct:_e,color:"var(--color-primary)",size:"normal"}],Lr=S=>!L||!L[S]?0:Math.min(Math.round(V[S]/L[S]*100),100),Fn=(()=>{const S=new Date().getHours();return T&&Le>=_&&V.calories>0?{main:"Smashed it today,",sub:"Rest up and go again tomorrow."}:S>=5&&S<12?{main:"Rise and grind,",sub:"let's get after it!"}:S>=12&&S<17?{main:"Oye",sub:"crack on and make it count!"}:S>=17&&S<21?{main:"Evening session?",sub:"Let's finish strong!"}:{main:"Burning the midnight oil,",sub:"Respect the hustle!"}})(),zn=T?g&&Be&&$&&!J?{label:"NEXT SESSION",message:`Week ${$.week}, Day ${$.dayIdx+1}  ${$.label}`,cta:"Continue",action:()=>x("/client/core-buddy/programmes"),pct:D,ringLabel:`${D}%`}:Le<_?{label:"DAILY HABITS",message:`${Le}/${_} completed`,cta:"Open Habits",action:()=>x("/client/core-buddy/consistency"),pct:_e,ringLabel:`${Le}/${_}`}:g&&V.calories===0?{label:"NUTRITION",message:"No meals logged today",cta:"Log Meal",action:()=>x("/client/core-buddy/nutrition"),pct:0,ringLabel:"0"}:g&&!Be?{label:"PROGRAMMES",message:"Start a programme to level up",cta:"Browse",action:()=>x("/client/core-buddy/workouts"),pct:0,ringLabel:""}:g&&J?{label:"COMPLETE",message:"Programme finished!",cta:"New Programme",action:()=>x("/client/core-buddy/workouts"),pct:100,ringLabel:"100%"}:{label:"TODAY",message:"You're crushing it!",cta:null,action:null,pct:100,ringLabel:""}:null,fn=b.useCallback(async()=>{if(t){se(!0);try{const S=await Ts(As(Ht(ge,"posts"),gs("authorId","==",t.id),oc("createdAt","desc"),Pu(30)));gt(S.docs.map(je=>({id:je.id,...je.data()})));const U=await Ts(As(Ht(ge,"postLikes"),gs("userId","==",t.id)));Jt(new Set(U.docs.map(je=>je.data().postId)))}catch(S){console.error("Error loading journey:",S)}finally{se(!1)}}},[t]);b.useEffect(()=>{T&&t&&fn()},[T,t,fn]);const Or=S=>{const U=S.target.files?.[0];if(U){if(!U.type.startsWith("image/")){Ke("Please select an image file","error");return}if(U.size>10*1024*1024){Ke("Image must be under 10MB","error");return}kt(U),Ae(URL.createObjectURL(U))}},mr=()=>{kt(null),Q&&URL.revokeObjectURL(Q),Ae(null),zs.current&&(zs.current.value="")},da=async()=>{if(!(!Qe.trim()&&!et||Je||!t)){yt(!0);try{let S=null;if(et){const Ye=await CD(et),He=`${Date.now()}_${Math.random().toString(36).slice(2,8)}`,tt=yi(bi,`postImages/${t.id}/${He}`);await Mh(tt,Ye),S=await fo(tt)}await Gr(Ht(ge,"posts"),{authorId:t.id,authorName:t.name||"Unknown",authorPhotoURL:t.photoURL||null,content:Qe.trim(),type:S?"image":"text",imageURL:S||null,createdAt:yr(),likeCount:0,commentCount:0});const je=Qe.trim().match(/@[\w\s]+?(?=\s@|\s*$|[.,!?])/g);if(je){const Ye=new Set;je.forEach(He=>{const tt=He.slice(1).trim(),Ge=E.find(ut=>ut.name&&ut.name.toLowerCase()===tt.toLowerCase());Ge&&!Ye.has(Ge.id)&&(Ye.add(Ge.id),Yr(Ge.id,"mention",{}))})}_t(""),mr(),En.current&&(En.current.style.height="auto"),await fn(),Ke("Posted!","success")}catch(S){console.error("Error posting:",S),Ke(S?.message||"Failed to post","error")}finally{yt(!1)}}},sr=async S=>{if(window.confirm("Delete this post?"))try{await lr(Xe(ge,"posts",S)),gt(U=>U.filter(je=>je.id!==S)),Ke("Post deleted","info")}catch(U){console.error("Delete error:",U),Ke("Failed to delete","error")}},q=async S=>{if(!t)return;const U=t.id,je=`${S}_${U}`,Ye=it.has(S),He=new Set(it);Ye?He.delete(S):He.add(S),Jt(He),gt(tt=>tt.map(Ge=>Ge.id===S?{...Ge,likeCount:Math.max(0,(Ge.likeCount||0)+(Ye?-1:1))}:Ge));try{if(Ye)await lr(Xe(ge,"postLikes",je)),await oa(Xe(ge,"posts",S),{likeCount:Yo(-1)});else{await Ds(Xe(ge,"postLikes",je),{postId:S,userId:U,createdAt:yr()}),await oa(Xe(ge,"posts",S),{likeCount:Yo(1)});const tt=at.find(Ge=>Ge.id===S);tt&&Yr(tt.authorId,"like",{postId:S})}}catch(tt){console.error("Like error:",tt),fn()}},ue=async S=>{try{const U=await Ts(As(Ht(ge,"postComments"),gs("postId","==",S),oc("createdAt","asc"),Pu(50)));Ee(je=>({...je,[S]:U.docs.map(Ye=>({id:Ye.id,...Ye.data()}))}))}catch(U){console.error("Error loading comments:",U)}},de=S=>{const U=new Set(Yt);U.has(S)?U.delete(S):(U.add(S),ye[S]||ue(S)),F(U)},Ue=async S=>{const U=(Te[S]||"").trim(),je=Bt[S];if(!(!U&&!je||!t)){At(Ye=>({...Ye,[S]:!0}));try{let Ye=null;if(je){const St=yi(bi,`comment-images/${Date.now()}_${je.name}`);await Mh(St,je),Ye=await fo(St)}const He={postId:S,authorId:t.id,authorName:t.name||"Unknown",authorPhotoURL:t.photoURL||null,content:U||"",createdAt:yr()};Ye&&(He.imageURL=Ye);const tt=ft[S];tt&&(He.replyToId=tt.id,He.replyToName=tt.authorName),await Gr(Ht(ge,"postComments"),He),await oa(Xe(ge,"posts",S),{commentCount:Yo(1)});const Ge=at.find(St=>St.id===S);Ge&&Yr(Ge.authorId,"comment",{postId:S});const ut=U.match(/@[\w\s]+?(?=\s@|\s*$|[.,!?])/g);if(ut){const St=new Set;ut.forEach(ns=>{const Zt=ns.slice(1).trim(),ys=E.find(rn=>rn.name&&rn.name.toLowerCase()===Zt.toLowerCase());ys&&!St.has(ys.id)&&(St.add(ys.id),Yr(ys.id,"mention",{postId:S}))})}Se(St=>({...St,[S]:""})),Ps(St=>({...St,[S]:null})),tn(St=>({...St,[S]:null})),zt(St=>({...St,[S]:null})),sn.current[S]&&(sn.current[S].value=""),gt(St=>St.map(ns=>ns.id===S?{...ns,commentCount:(ns.commentCount||0)+1}:ns)),await ue(S)}catch(Ye){console.error("Comment error:",Ye),Ke("Failed to comment","error")}finally{At(Ye=>({...Ye,[S]:!1}))}}},Ce=async(S,U)=>{try{await lr(Xe(ge,"postComments",U)),await oa(Xe(ge,"posts",S),{commentCount:Yo(-1)}),Ee(je=>({...je,[S]:(je[S]||[]).filter(Ye=>Ye.id!==U)})),gt(je=>je.map(Ye=>Ye.id===S?{...Ye,commentCount:Math.max((Ye.commentCount||1)-1,0)}:Ye))}catch(je){console.error("Delete comment error:",je),Ke("Failed to delete comment","error")}},st=(S,U)=>{const je=U.target.files?.[0];if(!je)return;if(je.size>5*1024*1024){Ke("Image must be under 5MB","error");return}Ps(He=>({...He,[S]:je}));const Ye=new FileReader;Ye.onload=He=>tn(tt=>({...tt,[S]:He.target.result})),Ye.readAsDataURL(je)},vt=S=>{Ps(U=>({...U,[S]:null})),tn(U=>({...U,[S]:null})),sn.current[S]&&(sn.current[S].value="")},qt=S=>{_t(S.target.value),S.target.style.height="auto",S.target.style.height=Math.min(S.target.scrollHeight,120)+"px",hr(S.target.value,"compose")},ss=(S,U)=>{Se(je=>({...je,[S]:U})),hr(U,S)};return r.jsx(Sa,{children:r.jsxs("div",{className:"cb-dashboard","data-theme":d?"dark":"light",children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsxs("div",{className:"header-notif-wrap",ref:xe,children:[r.jsxs("button",{className:"header-notif-btn",onClick:()=>{ae(!me),me||Ra()},"aria-label":"Notifications",children:[r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"}),r.jsx("path",{d:"M13.73 21a2 2 0 0 1-3.46 0"})]}),Nn>0&&r.jsx("span",{className:"header-notif-badge",children:Nn>9?"9+":Nn})]}),me&&r.jsxs("div",{className:"notif-panel",children:[r.jsxs("div",{className:"notif-panel-header",children:[r.jsx("span",{className:"notif-panel-title",children:"Notifications"}),hs.length>0&&r.jsx("button",{className:"notif-clear-btn",onClick:Ri,children:"Clear all"})]}),r.jsx("div",{className:"notif-panel-list",children:hs.length===0?r.jsx("div",{className:"notif-empty",children:"No notifications yet"}):hs.map(S=>r.jsxs("div",{className:`notif-item${S.read?"":" unread"}`,onClick:()=>{if(ae(!1),S.type==="buddy_request"||S.type==="buddy_accept")x(g?"/client/core-buddy/buddies":"/upgrade");else if((S.type==="like"||S.type==="comment")&&S.postId){if(!Yt.has(S.postId)){const U=new Set(Yt);U.add(S.postId),F(U),ye[S.postId]||ue(S.postId)}setTimeout(()=>{const U=document.getElementById(`post-${S.postId}`);U&&U.scrollIntoView({behavior:"smooth",block:"center"})},150)}else S.type==="like"||S.type==="comment"?document.querySelector(".cb-journey-section")?.scrollIntoView({behavior:"smooth"}):S.type==="mention"&&x(`/client/core-buddy/profile/${S.fromId}`)},children:[r.jsx("div",{className:"notif-item-avatar",children:S.fromPhotoURL?r.jsx("img",{src:S.fromPhotoURL,alt:""}):r.jsx("span",{children:(S.fromName||"?")[0]})}),r.jsxs("div",{className:"notif-item-body",children:[r.jsxs("p",{className:"notif-item-text",children:[r.jsx("strong",{children:S.fromName})," ",S.type==="buddy_request"&&"sent you a buddy request",S.type==="buddy_accept"&&"accepted your buddy request",S.type==="like"&&"liked your post",S.type==="comment"&&"commented on your post",S.type==="mention"&&"mentioned you"]}),r.jsx("span",{className:"notif-item-time",children:Gp(S.createdAt)})]})]},S.id))})]})]}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsxs("div",{className:"header-actions",children:[r.jsx("button",{onClick:p,"aria-label":"Toggle theme",children:d?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})}),r.jsx("button",{onClick:i,"aria-label":"Log out",children:r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),r.jsx("polyline",{points:"16 17 21 12 16 7"}),r.jsx("line",{x1:"21",y1:"12",x2:"9",y2:"12"})]})})]})]})}),r.jsxs("main",{className:"cb-main",children:[r.jsxs("div",{className:"cb-ring-container",children:[r.jsxs("div",{className:"cb-ring",children:[r.jsx("svg",{className:"cb-ring-svg",viewBox:"0 0 200 200",children:Em.map((S,U)=>{const je=U<K;return r.jsx("line",{x1:S.x1,y1:S.y1,x2:S.x2,y2:S.y2,className:`ring-tick ${je?"elapsed":"remaining"}`,strokeWidth:S.thick?"3":"2"},U)})}),r.jsxs("div",{className:"cb-ring-center",children:[r.jsxs("div",{className:"cb-ring-logo",onClick:()=>lt.current?.click(),role:"button",tabIndex:0,"aria-label":"Change profile photo",children:[r.jsx("img",{src:Nt||"/Logo.webp",alt:Nt?"Profile":"Mind Core Fitness"}),r.jsx("div",{className:`cb-photo-overlay${Et?" uploading":""}`,children:Et?r.jsx("div",{className:"cb-photo-spinner"}):r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"#fff",strokeWidth:"2",children:[r.jsx("path",{d:"M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"}),r.jsx("circle",{cx:"12",cy:"13",r:"4"})]})}),r.jsx("input",{ref:lt,type:"file",accept:"image/*",onChange:Un,style:{display:"none"}})]}),!Nt&&!Et&&r.jsx("div",{className:"cb-photo-badge",onClick:()=>lt.current?.click(),children:r.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"#fff",strokeWidth:"2.5",children:[r.jsx("path",{d:"M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"}),r.jsx("circle",{cx:"12",cy:"13",r:"4"})]})})]})]}),r.jsxs("div",{className:"cb-ring-countdown",children:[r.jsx("span",{className:"cb-timer-digit",children:String(j.hours).padStart(2,"0")}),r.jsx("span",{className:"cb-timer-colon",children:":"}),r.jsx("span",{className:"cb-timer-digit",children:String(j.minutes).padStart(2,"0")}),r.jsx("span",{className:"cb-timer-colon",children:":"}),r.jsx("span",{className:"cb-timer-digit cb-timer-seconds",children:String(j.seconds).padStart(2,"0")})]}),r.jsx("span",{className:"cb-ring-label",children:"remaining today"}),r.jsxs("p",{className:"cb-ring-tagline",children:[Wp[be].text," ",r.jsx("strong",{children:Wp[be].bold})]},be)]}),r.jsx("div",{className:"cb-stats-row",children:Qr.map(S=>{const U=(S.size==="large",38),je=2*Math.PI*U,Ye=je-S.pct/100*je,He=S.editable;return r.jsxs("div",{className:`cb-stat-item${S.size==="large"?" cb-stat-large":""}`,children:[r.jsxs("div",{className:`cb-stat-ring${He?" cb-stat-tappable":""}${He&&wt?" cb-stat-hint":""}`,onClick:He?()=>{mt(!0),ot(!1)}:void 0,children:[r.jsxs("svg",{viewBox:"0 0 100 100",children:[r.jsx("circle",{className:"cb-stat-track",cx:"50",cy:"50",r:U}),r.jsx("circle",{className:"cb-stat-fill",cx:"50",cy:"50",r:U,style:{stroke:S.color},strokeDasharray:je,strokeDashoffset:Ye})]}),r.jsx("span",{className:"cb-stat-value",style:{color:S.color},children:S.value})]}),r.jsx("span",{className:"cb-stat-label",children:S.label})]},S.label)})}),Me&&r.jsx("div",{className:"cb-target-overlay",onClick:()=>mt(!1),children:r.jsxs("div",{className:"cb-target-picker",onClick:S=>S.stopPropagation(),children:[r.jsx("h4",{children:"Weekly workout goal"}),r.jsx("p",{children:"How many sessions per week?"}),r.jsx("div",{className:"cb-target-options",children:[1,2,3,4,5,6,7].map(S=>r.jsx("button",{className:`cb-target-option${S===qe?" active":""}`,onClick:()=>Ja(S),children:S},S))})]})}),r.jsxs("p",{className:"cb-coach-msg",children:[Fn.main," ",r.jsx("strong",{children:Aa}),"  ",Fn.sub]}),zn&&r.jsxs("button",{className:"cb-nudge-card",onClick:zn.action||void 0,style:zn.action?void 0:{cursor:"default"},children:[r.jsxs("div",{className:"cb-nudge-ring",children:[r.jsxs("svg",{viewBox:"0 0 100 100",children:[r.jsx("circle",{className:"cb-nudge-ring-track",cx:"50",cy:"50",r:"38"}),r.jsx("circle",{className:"cb-nudge-ring-fill",cx:"50",cy:"50",r:"38",strokeDasharray:2*Math.PI*38,strokeDashoffset:2*Math.PI*38-zn.pct/100*2*Math.PI*38})]}),r.jsx("span",{className:"cb-nudge-ring-val",children:zn.ringLabel})]}),r.jsxs("div",{className:"cb-nudge-info",children:[r.jsx("span",{className:"cb-nudge-label",children:zn.label}),r.jsx("span",{className:"cb-nudge-title",children:zn.message}),zn.cta&&r.jsxs("span",{className:"cb-nudge-cta",children:[zn.cta," "]})]})]}),r.jsxs("div",{className:"cb-features",children:[g&&r.jsxs("button",{className:"cb-feature-card cb-card-nutrition cb-card-has-preview ripple-btn",onClick:S=>{_r(S),x("/client/core-buddy/nutrition")},children:[r.jsxs("div",{className:"cb-card-top-row",children:[r.jsx("div",{className:"cb-card-content",children:r.jsx("h3",{children:"Today's Nutrition"})}),r.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})]}),r.jsx("div",{className:"cb-card-preview-row",children:r.jsx("div",{className:"cb-mini-rings",children:[{label:"P",pct:Lr("protein"),color:"var(--color-primary)"},{label:"C",pct:Lr("carbs"),color:"var(--color-primary)"},{label:"F",pct:Lr("fats"),color:"var(--color-primary)"},{label:"Cal",pct:Lr("calories"),color:"var(--color-primary)"}].map(S=>{const je=2*Math.PI*38,Ye=je-S.pct/100*je;return r.jsxs("div",{className:"cb-mini-ring",children:[r.jsxs("svg",{viewBox:"0 0 100 100",children:[r.jsx("circle",{className:"cb-mini-track",cx:"50",cy:"50",r:38}),r.jsx("circle",{className:"cb-mini-fill",cx:"50",cy:"50",r:38,style:{stroke:S.color},strokeDasharray:je,strokeDashoffset:Ye})]}),r.jsx("span",{style:{color:S.color},children:S.label})]},S.label)})})}),r.jsx("p",{className:"cb-card-desc",children:"Track macros, scan barcodes, log water"})]}),r.jsxs("button",{className:"cb-feature-card cb-card-workouts-hero ripple-btn",onClick:S=>{_r(S),x("/client/core-buddy/workouts")},children:[r.jsx("h3",{className:"cb-hero-title",children:"Workouts"}),r.jsxs("div",{className:"cb-hero-stats",children:[r.jsxs("span",{children:[re," this week"]}),r.jsx("span",{className:"cb-hero-dot",children:""}),r.jsxs("span",{children:[ke," total"]})]}),r.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})]}),r.jsxs("div",{className:`cb-grid-row${g?"":" cb-grid-single"}`,children:[r.jsxs("button",{className:"cb-feature-card cb-grid-card cb-card-consistency ripple-btn",onClick:S=>{_r(S),x("/client/core-buddy/consistency")},children:[r.jsxs("div",{className:"cb-card-content",children:[r.jsx("h3",{children:"Habits"}),r.jsx("div",{className:"cb-habit-dots",children:Array.from({length:_},(S,U)=>r.jsx("span",{className:`cb-habit-dot${U<Le?" done":""}`},U))}),r.jsxs("span",{className:"cb-habit-dots-label",children:[Le,"/",_," today"]})]}),r.jsx("svg",{className:"cb-card-arrow cb-grid-arrow",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})]}),g&&r.jsxs("button",{className:"cb-feature-card cb-grid-card cb-card-progress ripple-btn",onClick:S=>{_r(S),x("/client/personal-bests?mode=corebuddy")},children:[r.jsxs("div",{className:"cb-card-content",children:[r.jsx("h3",{children:"PBs"}),Ft.length>0?r.jsx("div",{className:"cb-pb-preview",children:Ft.slice(0,2).map(S=>r.jsxs("div",{className:"cb-pb-entry",children:[r.jsx("span",{className:"cb-pb-name",children:S.name}),r.jsxs("span",{className:"cb-pb-value",children:[S.weight,"kg"]})]},S.name))}):r.jsxs("div",{className:"cb-progress-preview",children:[r.jsx("svg",{className:"cb-progress-icon",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M13 2L3 14h9l-1 8 10-12h-9l1-8z"})}),r.jsx("span",{children:"Start lifting!"})]})]}),r.jsx("svg",{className:"cb-card-arrow cb-grid-arrow",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})]})]}),r.jsxs("button",{className:"cb-feature-card cb-card-leaderboard ripple-btn",onClick:S=>{_r(S),x("/client/leaderboard")},children:[r.jsxs("div",{className:"cb-card-content",children:[r.jsx("h3",{children:"Leaderboard"}),oe.length>0?r.jsx("div",{className:"cb-lb-preview",children:oe.map((S,U)=>{const je=["#FFD700","#A8B4C0","#CD7F32"][U],Ye=S.name?S.name.split(" ").map(tt=>tt[0]).join("").slice(0,2).toUpperCase():"?",He=S.id===t?.id;return r.jsxs("div",{className:`cb-lb-entry${He?" cb-lb-me":""}`,children:[r.jsx("div",{className:"cb-lb-avatar",style:{borderColor:je},children:S.photoURL?r.jsx("img",{src:S.photoURL,alt:"",className:"cb-lb-avatar-img"}):r.jsx("span",{children:Ye})}),r.jsxs("span",{className:"cb-lb-rank",style:{color:je},children:["#",U+1]})]},S.id)})}):r.jsx("p",{children:"Opt in to compete with your Core Buddies"})]}),r.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})]}),g&&r.jsxs("button",{className:"cb-feature-card cb-card-buddies ripple-btn",onClick:S=>{_r(S),x("/client/core-buddy/buddies")},children:[r.jsxs("div",{className:"cb-card-content",children:[r.jsx("h3",{children:"Buddies"}),r.jsx("p",{children:"Connect with other members and track each other's progress"})]}),r.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})]}),g&&r.jsxs("div",{className:"cb-achievements-section",children:[r.jsx("h3",{className:"cb-achievements-title",children:"Achievements"}),r.jsx("div",{className:"cb-badges-scroll",children:Bn.map(S=>{const U=Ot.includes(S.id);return r.jsx("button",{className:`cb-badge${U?" unlocked":" locked"}`,onClick:()=>Gt(S),children:r.jsx("img",{src:S.img,alt:S.name,className:"cb-badge-img"})},S.id)})}),r.jsxs("p",{className:"cb-badges-count",children:[Ot.length,"/",Bn.length," unlocked"]})]}),g&&r.jsxs("div",{className:"cb-journey-section",children:[r.jsx("h3",{className:"cb-journey-title",children:"My Journey"}),r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"journey-compose",children:[r.jsx("div",{className:"journey-compose-avatar",children:Nt?r.jsx("img",{src:Nt,alt:""}):r.jsx("span",{children:iu(t?.name)})}),r.jsxs("div",{className:"journey-compose-body",style:{position:"relative"},children:[r.jsx("textarea",{ref:En,placeholder:"Share your progress... (use @ to mention)",value:Qe,onChange:qt,rows:1,maxLength:500}),Ze&&ct==="compose"&&xt.length>0&&r.jsx("div",{className:"mention-dropdown",children:xt.map(S=>r.jsxs("button",{className:"mention-option",onClick:()=>Xa(S,"compose"),children:[r.jsx("div",{className:"mention-option-avatar",children:S.photoURL?r.jsx("img",{src:S.photoURL,alt:""}):r.jsx("span",{children:iu(S.name)})}),r.jsx("span",{children:S.name})]},S.id))}),Q&&r.jsxs("div",{className:"journey-image-preview",children:[r.jsx("img",{src:Q,alt:"Preview"}),r.jsx("button",{className:"journey-image-remove",onClick:mr,"aria-label":"Remove image",children:r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",children:[r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})})]}),r.jsxs("div",{className:"journey-compose-actions",children:[r.jsx("button",{className:"journey-image-btn",onClick:()=>zs.current?.click(),"aria-label":"Add image",children:r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),r.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),r.jsx("path",{d:"M21 15l-5-5L5 21"})]})}),r.jsx("input",{ref:zs,type:"file",accept:"image/*",onChange:Or,hidden:!0}),(Qe.trim()||et)&&r.jsx("button",{className:"journey-post-btn",onClick:da,disabled:Je,children:Je?r.jsx("div",{className:"journey-btn-spinner"}):"Post"})]})]})]}),X?r.jsx("div",{className:"journey-loading",children:r.jsx("div",{className:"cb-spinner"})}):at.length===0?r.jsxs("div",{className:"journey-empty",children:[r.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),r.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),r.jsx("path",{d:"M21 15l-5-5L5 21"})]}),r.jsx("p",{children:"Start sharing your fitness journey!"})]}):r.jsx("div",{className:"journey-list",children:at.map(S=>r.jsxs("div",{id:`post-${S.id}`,className:"journey-post",children:[r.jsxs("div",{className:"journey-post-header",children:[r.jsx("div",{className:"journey-post-avatar",children:S.authorPhotoURL?r.jsx("img",{src:S.authorPhotoURL,alt:""}):r.jsx("span",{children:iu(S.authorName)})}),r.jsxs("div",{className:"journey-post-meta",children:[r.jsx("span",{className:"journey-post-name",children:S.authorName}),r.jsx("span",{className:"journey-post-time",children:Gp(S.createdAt)})]}),r.jsx("button",{className:"journey-delete-btn",onClick:()=>sr(S.id),"aria-label":"Delete post",children:r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M3 6h18"}),r.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),r.jsx("path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]}),S.type==="workout_summary"&&S.metadata?r.jsxs("div",{className:"journey-card",children:[r.jsx("div",{className:"journey-card-logo-frame",children:r.jsx("img",{src:"/Logo.webp",alt:"MCF",className:"journey-card-logo-img"})}),r.jsx("h3",{className:"journey-card-title",children:S.metadata.title}),S.metadata.stats?.length>0&&r.jsx("p",{className:"journey-card-stats-line",children:S.metadata.stats.map(U=>`${U.value} ${U.label}`).join("    ")}),!S.metadata.stats?.length&&S.metadata.subtitle&&r.jsx("p",{className:"journey-card-stats-line",children:S.metadata.subtitle}),r.jsx("p",{className:"journey-card-cta",children:"I just completed a workout using Core Buddy "}),r.jsx("p",{className:"journey-card-slogan",children:"Make It Count with Core Buddy"})]}):S.type==="badge_earned"&&S.metadata?r.jsxs("div",{className:"journey-card",children:[r.jsx("div",{className:"journey-card-logo-frame journey-card-logo-badge",children:r.jsx("img",{src:(Bn.find(U=>U.name===S.metadata.title)||Bn.find(U=>S.metadata.badges?.includes(U.name)))?.img||"/Logo.webp",alt:S.metadata.title,className:"journey-card-logo-img"})}),r.jsx("h3",{className:"journey-card-title",children:S.metadata.title}),(S.metadata.badgeDesc||(Bn.find(U=>U.name===S.metadata.title)||Bn.find(U=>S.metadata.badges?.includes(U.name)))?.desc)&&r.jsx("p",{className:"journey-card-stats-line",children:S.metadata.badgeDesc||(Bn.find(U=>U.name===S.metadata.title)||Bn.find(U=>S.metadata.badges?.includes(U.name)))?.desc}),r.jsx("p",{className:"journey-card-cta",children:"I just earned a badge on Core Buddy "}),r.jsx("p",{className:"journey-card-slogan",children:"Make It Count with Core Buddy"})]}):S.type==="habits_summary"&&S.metadata?r.jsxs("div",{className:"journey-card",children:[r.jsx("div",{className:"journey-card-logo-frame",children:r.jsx("img",{src:"/Logo.webp",alt:"MCF",className:"journey-card-logo-img"})}),r.jsx("h3",{className:"journey-card-title",children:S.metadata.title}),S.metadata.stats?.length>0&&r.jsx("p",{className:"journey-card-stats-line",children:S.metadata.stats.map(U=>`${U.value} ${U.label}`).join("    ")}),S.metadata.subtitle&&r.jsx("p",{className:"journey-card-stats-line",children:S.metadata.subtitle}),r.jsx("p",{className:"journey-card-cta",children:"I just completed my daily habits with Core Buddy "}),r.jsx("p",{className:"journey-card-slogan",children:"Make It Count with Core Buddy"})]}):r.jsxs(r.Fragment,{children:[S.content&&r.jsx("p",{className:"journey-post-content",children:Pr(S.content)}),S.imageURL&&r.jsx("div",{className:"journey-post-image",children:r.jsx("img",{src:S.imageURL,alt:"Post",loading:"lazy"})})]}),r.jsxs("div",{className:"journey-post-actions",children:[r.jsxs("button",{className:`journey-action-btn${it.has(S.id)?" liked":""}`,onClick:()=>q(S.id),children:[r.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:it.has(S.id)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})}),r.jsx("span",{children:S.likeCount||0})]}),r.jsxs("button",{className:`journey-action-btn${Yt.has(S.id)?" active":""}`,onClick:()=>de(S.id),children:[r.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})}),r.jsx("span",{children:S.commentCount||0})]})]}),Yt.has(S.id)&&r.jsxs("div",{className:"journey-comments",children:[ye[S.id]?.length>0?ye[S.id].map(U=>r.jsxs("div",{className:"journey-comment",children:[r.jsx("div",{className:"journey-comment-avatar",children:U.authorPhotoURL?r.jsx("img",{src:U.authorPhotoURL,alt:""}):r.jsx("span",{children:iu(U.authorName)})}),r.jsxs("div",{className:"journey-comment-body",children:[r.jsxs("div",{className:"journey-comment-bubble",children:[r.jsx("span",{className:"journey-comment-name",children:U.authorName}),U.replyToName&&r.jsxs("span",{className:"journey-comment-reply-tag",children:[r.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("polyline",{points:"9 14 4 9 9 4"}),r.jsx("path",{d:"M20 20v-7a4 4 0 0 0-4-4H4"})]}),U.replyToName]}),U.content&&r.jsx("span",{className:"journey-comment-text",children:Pr(U.content)}),U.imageURL&&r.jsx("img",{className:"journey-comment-image",src:U.imageURL,alt:"Comment",loading:"lazy"})]}),r.jsxs("div",{className:"journey-comment-actions-row",children:[r.jsx("span",{className:"journey-comment-time",children:Gp(U.createdAt)}),r.jsx("button",{className:"journey-comment-reply-btn",onClick:()=>zt(je=>({...je,[S.id]:{id:U.id,authorName:U.authorName}})),children:"Reply"}),r.jsx("button",{className:"journey-comment-delete-btn",onClick:()=>Ce(S.id,U.id),"aria-label":"Delete comment",children:r.jsxs("svg",{width:"13",height:"13",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M3 6h18"}),r.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),r.jsx("path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]})]})]},U.id)):r.jsx("p",{className:"journey-no-comments",children:"No comments yet"}),ft[S.id]&&r.jsxs("div",{className:"journey-comment-replying",children:[r.jsxs("span",{children:["Replying to ",r.jsx("strong",{children:ft[S.id].authorName})]}),r.jsx("button",{onClick:()=>zt(U=>({...U,[S.id]:null})),"aria-label":"Cancel reply",children:r.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",children:[r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})})]}),hn[S.id]&&r.jsxs("div",{className:"journey-comment-img-preview",children:[r.jsx("img",{src:hn[S.id],alt:"Preview"}),r.jsx("button",{onClick:()=>vt(S.id),"aria-label":"Remove image",children:r.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",children:[r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})})]}),r.jsxs("div",{className:"journey-comment-input",style:{position:"relative"},children:[r.jsx("button",{className:"journey-comment-img-btn",onClick:()=>sn.current[S.id]?.click(),"aria-label":"Add image",children:r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),r.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),r.jsx("path",{d:"M21 15l-5-5L5 21"})]})}),r.jsx("input",{ref:U=>{sn.current[S.id]=U},type:"file",accept:"image/*",onChange:U=>st(S.id,U),hidden:!0}),r.jsx("input",{type:"text",placeholder:"Comment",value:Te[S.id]||"",onChange:U=>ss(S.id,U.target.value),onKeyDown:U=>{U.key==="Enter"&&Ue(S.id)},maxLength:300}),Ze&&ct===S.id&&xt.length>0&&r.jsx("div",{className:"mention-dropdown mention-dropdown-up",children:xt.map(U=>r.jsxs("button",{className:"mention-option",onClick:()=>Xa(U,S.id),children:[r.jsx("div",{className:"mention-option-avatar",children:U.photoURL?r.jsx("img",{src:U.photoURL,alt:""}):r.jsx("span",{children:iu(U.name)})}),r.jsx("span",{children:U.name})]},U.id))}),r.jsx("button",{onClick:()=>Ue(S.id),disabled:!(Te[S.id]||"").trim()&&!Bt[S.id]||bt[S.id],children:bt[S.id]?r.jsx("div",{className:"journey-btn-spinner-sm"}):r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"22",y1:"2",x2:"11",y2:"13"}),r.jsx("polygon",{points:"22 2 15 22 11 13 2 9 22 2"})]})})]})]})]},S.id))})]})]}),!g&&r.jsxs("button",{className:"cb-upgrade-cta",onClick:()=>x("/upgrade"),children:[r.jsx("span",{className:"cb-upgrade-cta-text",children:"Unlock the full experience"}),r.jsx("span",{className:"cb-upgrade-cta-sub",children:"Nutrition, buddies, achievements & more"}),r.jsxs("svg",{className:"cb-upgrade-cta-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M5 12h14"}),r.jsx("path",{d:"M12 5l7 7-7 7"})]})]})]})]}),ms&&r.jsx("div",{className:"cb-badge-overlay",onClick:()=>Gt(null),children:r.jsxs("div",{className:"cb-badge-overlay-content",onClick:S=>S.stopPropagation(),children:[r.jsx("img",{src:ms.img,alt:ms.name,className:`cb-badge-overlay-img${Ot.includes(ms.id)?"":" cb-badge-overlay-img-locked"}`}),Ot.includes(ms.id)?r.jsx("span",{className:"cb-badge-status unlocked",children:"Unlocked"}):r.jsx("span",{className:"cb-badge-status locked",children:"Locked"}),r.jsx("button",{className:"cb-badge-overlay-close",onClick:()=>Gt(null),children:"Tap to close"})]})}),r.jsx(Ta,{active:"home"}),De&&r.jsxs("div",{className:`toast-notification ${De.type}`,children:[De.type==="info"&&r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("line",{x1:"12",y1:"16",x2:"12",y2:"12"}),r.jsx("line",{x1:"12",y1:"8",x2:"12.01",y2:"8"})]}),De.message]}),r.jsx(TD,{steps:ua,active:ps,onFinish:Ai}),Pt&&r.jsxs("div",{className:"cb-celebration-overlay",onClick:()=>us(null),children:[r.jsx("div",{className:"cb-confetti-container",children:Array.from({length:30},(S,U)=>r.jsx("span",{className:"cb-confetti-piece",style:{"--angle":`${Math.random()*360}deg`,"--distance":`${80+Math.random()*120}px`,"--delay":`${Math.random()*.3}s`,"--color":["#FFD700","#FF6B6B","#4ECDC4","#45B7D1","#F7DC6F","#BB8FCE","#FF8C42","#38B6FF"][U%8],"--size":`${6+Math.random()*6}px`,"--drift":`${(Math.random()-.5)*60}px`}},U))}),r.jsxs("div",{className:"cb-celebration-content",onClick:S=>S.stopPropagation(),children:[r.jsx("div",{className:"cb-celebration-glow"}),r.jsx("img",{src:Pt.img,alt:Pt.name,className:"cb-celebration-badge-img"}),r.jsx("h2",{className:"cb-celebration-title",children:"Badge Unlocked!"}),r.jsx("p",{className:"cb-celebration-name",children:Pt.name}),r.jsx("button",{className:"cb-celebration-dismiss",onClick:()=>us(null),children:"Tap to continue"})]})]})]})})}const Kp=new Map;function so(){return new Date().toISOString().split("T")[0]}const N2=[{key:"breakfast",label:"Breakfast"},{key:"lunch",label:"Lunch"},{key:"dinner",label:"Dinner"},{key:"snacks",label:"Snacks"}],AD={breakfast:r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M18 8h1a4 4 0 0 1 0 8h-1"}),r.jsx("path",{d:"M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z"}),r.jsx("line",{x1:"6",y1:"1",x2:"6",y2:"4"}),r.jsx("line",{x1:"10",y1:"1",x2:"10",y2:"4"}),r.jsx("line",{x1:"14",y1:"1",x2:"14",y2:"4"})]}),lunch:r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}),dinner:r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})}),snacks:r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})})};function MD(){const n=new Date().getHours();return n<11?"breakfast":n<14?"lunch":n<17?"snacks":"dinner"}function ID(){const{currentUser:n,isClient:e,clientData:t,loading:i}=Ir(),{isDark:l,toggleTheme:u,accent:d}=Ca(),p=tr(),[g,y]=b.useState("loading"),[x,_]=b.useState(null),[j,O]=b.useState({gender:"male",age:"",weight:"",weightUnit:"kg",height:"",heightUnit:"cm",heightFeet:"",heightInches:"",dailyActivity:"sedentary",trainingFrequency:"moderate",goal:"maintain",deficitLevel:"moderate"}),[K,B]=b.useState(null),[D,te]=b.useState(so()),[Y,Z]=b.useState({entries:[],water:0}),[ke,Re]=b.useState({protein:0,carbs:0,fats:0,calories:0}),[_e,C]=b.useState(!1),[T,M]=b.useState(!1),[V,I]=b.useState(()=>{const E=new Date;return{year:E.getFullYear(),month:E.getMonth()}}),[L,A]=b.useState(MD),[Le,ht]=b.useState(null),[$,pe]=b.useState(null),[Be,We]=b.useState(!1),[J,P]=b.useState(null),[re,Fe]=b.useState(""),[qe,Ve]=b.useState(!1),[Me,mt]=b.useState(""),[wt,ot]=b.useState([]),[es,Ns]=b.useState(!1),[Ft,Tt]=b.useState({name:"",protein:"",carbs:"",fats:"",calories:"",serving:""}),[oe,Dt]=b.useState(null),[Nt,Kt]=b.useState("100"),[Et,Ct]=b.useState(0),[lt,Ot]=b.useState("weight"),[Wt,ms]=b.useState(0),[Gt,Pt]=b.useState(null);b.useRef(null);const us=b.useRef(!1),xs=b.useRef(null),is=b.useRef(null),Qs=b.useRef(null),Ms=b.useCallback((E,z="info")=>{Pt({message:E,type:z}),setTimeout(()=>Pt(null),3e3)},[]);b.useEffect(()=>{!i&&(!n||!e)&&p("/")},[n,e,i,p]),b.useEffect(()=>{if(!t?.id)return;(async()=>{try{const z=await Is(Xe(ge,"nutritionTargets",t.id));z.exists()?(_(z.data()),y("dashboard")):y("setup")}catch(z){console.error("Error loading nutrition data:",z),y("setup")}})()},[t?.id]),b.useEffect(()=>{if(!t?.id)return;(async()=>{try{const z=await Is(Xe(ge,"nutritionLogs",`${t.id}_${D}`));if(z.exists()){const ie=z.data();Z({entries:ie.entries||[],water:ie.water||0})}else Z({entries:[],water:0})}catch(z){console.error("Error loading log:",z),Z({entries:[],water:0})}})()},[t?.id,D]),b.useEffect(()=>{const E=Y.entries.reduce((z,ie)=>({protein:z.protein+(ie.protein||0),carbs:z.carbs+(ie.carbs||0),fats:z.fats+(ie.fats||0),calories:z.calories+(ie.calories||0)}),{protein:0,carbs:0,fats:0,calories:0});Re(E)},[Y.entries]);const Fs=async E=>{try{await Ds(Xe(ge,"nutritionLogs",`${t.id}_${D}`),{clientId:t.id,date:D,entries:E.entries,water:E.water,updatedAt:Mt.now()})}catch(z){console.error("Error saving nutrition log:",z)}},os=D===so(),ws=(E,z)=>new Date(E,z+1,0).getDate(),be=(E,z)=>new Date(E,z,1).getDay(),Ie=["January","February","March","April","May","June","July","August","September","October","November","December"],De=["Su","Mo","Tu","We","Th","Fr","Sa"],rt=()=>{let E=parseFloat(j.weight);j.weightUnit==="lbs"&&(E*=.453592);let z;j.heightUnit==="cm"?z=parseFloat(j.height):z=(parseFloat(j.heightFeet)||0)*30.48+(parseFloat(j.heightInches)||0)*2.54;const ie=parseInt(j.age);let ne=j.gender==="male"?10*E+6.25*z-5*ie+5:10*E+6.25*z-5*ie-161;const nt=ne*{sedentary:1.2,light:1.3,moderate:1.4,active:1.5}[j.dailyActivity],ct={low:100,moderate:200,high:300,daily:400},Lt=Math.round(nt+ct[j.trainingFrequency]);let xt=Lt,fs,nn;switch(j.goal){case"lose":xt=Lt*(1-{light:.15,moderate:.2,harsh:.25}[j.deficitLevel]),fs=2.2,nn=.3;break;case"build":xt=Lt*1.1,fs=2,nn=.22;break;default:fs=1.8,nn=.25}xt=Math.max(xt,j.gender==="male"?1400:1100);const Dr=Math.round(E*fs),ps=Math.round(xt*nn/9),ur=Math.max(0,Math.round((xt-Dr*4-ps*9)/4));B({calories:Math.round(xt),protein:Dr,carbs:ur,fats:ps,bmr:Math.round(ne),neat:Math.round(nt),exerciseAdd:ct[j.trainingFrequency],tdee:Math.round(Lt)})},Ke=async()=>{if(K)try{const E={clientId:t.id,calories:K.calories,protein:K.protein,carbs:K.carbs,fats:K.fats,waterGoal:8,goal:j.goal,updatedAt:Mt.now()};await Ds(Xe(ge,"nutritionTargets",t.id),E),_(E),y("dashboard"),Ms("Macro targets saved!","success")}catch(E){console.error("Error saving targets:",E),Ms("Failed to save targets. Please try again.","error")}},at=()=>{const E=j.weight&&parseFloat(j.weight)>0,z=j.age&&parseInt(j.age)>0,ie=j.heightUnit==="cm"?j.height&&parseFloat(j.height)>0:j.heightFeet&&parseFloat(j.heightFeet)>0||j.heightInches&&parseFloat(j.heightInches)>0;return E&&z&&ie},gt="nut_favourite_foods",X=()=>{try{return JSON.parse(localStorage.getItem(gt)||"[]")}catch{return[]}},se=E=>X().some(z=>z.name.toLowerCase()===(E||"").toLowerCase()),Qe=E=>{const z=X(),ie=z.findIndex(ne=>ne.name.toLowerCase()===E.name.toLowerCase());ie>=0?z.splice(ie,1):z.unshift({name:E.name,protein:E.protein,carbs:E.carbs,fats:E.fats,calories:E.calories,serving:E.serving,per100g:E.per100g||null,servingUnit:E.servingUnit||"g",portion:E.portion||null}),localStorage.setItem(gt,JSON.stringify(z)),ms(ne=>ne+1)},_t=E=>{const z=[...Y.entries,{...E,meal:L,id:Date.now(),addedAt:new Date().toISOString()}],ie={...Y,entries:z};Z(ie),Fs(ie),pe(null),Dt(null),Kt("100"),Ct(0),Ot("weight"),Tt({name:"",protein:"",carbs:"",fats:"",calories:"",serving:""}),Ms("Food added!","success")},et=E=>{const z=Y.entries.filter(ne=>ne.id!==E),ie={...Y,entries:z};Z(ie),Fs(ie)},kt=b.useRef(null),Q=b.useRef([]),Ae=3,Je=5,yt=async()=>{We(!0);const E=document.querySelector("#barcode-reader");if(!E){We(!1),Ms("Scanner container not found.","error");return}if(!kt.current)try{const ie=await wr(()=>import("./quagga.min-BbicSfvA.js").then(ne=>ne.q),[]);kt.current=ie.default}catch(ie){console.error("Failed to load barcode scanner:",ie),We(!1),Ms("Could not load scanner.","error");return}const z=kt.current;z.init({inputStream:{type:"LiveStream",target:E,constraints:{facingMode:"environment",width:{min:640,ideal:1280,max:1920},height:{min:480,ideal:720,max:1080}}},locator:{patchSize:"medium",halfSample:!0},numOfWorkers:navigator.hardwareConcurrency||2,decoder:{readers:["ean_reader","ean_8_reader","upc_reader","upc_e_reader","code_128_reader","code_39_reader"]},locate:!0},ie=>{if(ie){console.error("Quagga init error:",ie),We(!1),Ms("Could not access camera. Check permissions.","error");return}z.start(),us.current=!0}),Q.current=[],z.onDetected(ie=>{const ne=ie.codeResult.decodedCodes?.filter(nt=>nt.error!==void 0)?.map(nt=>nt.error)||[];if((ne.length>0?ne.reduce((nt,ct)=>nt+ct,0)/ne.length:1)<.15){const nt=ie.codeResult.code,ct=Q.current;ct.push(nt),ct.length>Je&&ct.shift(),ct.filter(xt=>xt===nt).length>=Ae&&(z.offDetected(),Q.current=[],P(nt))}})},it=()=>{const E=kt.current;us.current&&E&&(E.stop(),E.offDetected(),us.current=!1),We(!1)},Jt=/\b(milk|semi.skimmed|skimmed|whole milk|oat milk|almond milk|soy milk|juice|smoothie|water|squash|cordial|cola|pepsi|fanta|lemonade|soda|beer|wine|cider|lager|spirit|whisky|vodka|rum|gin|brandy|cream|yoghurt drink|milkshake|coffee|tea|broth|stock|soup|sauce|ketchup|vinegar|oil|syrup|honey|custard|coconut water|kombucha|energy drink|protein shake)\b/i,Yt=E=>/ml|cl|\dl(?!b)|litre|liter|fl\s?oz/i.test((E||"").replace(/\s/g,"")),F=E=>{if(!E)return{value:100,unit:"g"};const z=E.toLowerCase().replace(/\s/g,""),ie=z.match(/([\d.]+)/),ne=ie?parseFloat(ie[1]):100;return Yt(E)?/cl/.test(z)?{value:ne*10,unit:"ml"}:/(?:^|\d)l(?!i)/.test(z)&&!/ml/.test(z)?{value:ne*1e3,unit:"ml"}:{value:ne,unit:"ml"}:{value:ne,unit:"g"}},ye=E=>{if(Yt(E.serving_size)||Yt(E.quantity))return"ml";const z=E.product_name||E.product_name_en||"";return Jt.test(z)?"ml":"g"},Ee=[{pattern:/\b(toast|bread|loaf|brioche|bagel|pitta|wrap|tortilla|crumpet|muffin|waffle|pancake)\b/i,label:"slice",weight:36},{pattern:/\begg\b/i,label:"egg",weight:60},{pattern:/\b(biscuit|cookie|digestive|hobnob|rich tea|oreo)\b/i,label:"biscuit",weight:13},{pattern:/\b(sausage|banger)\b/i,label:"sausage",weight:57},{pattern:/\b(rasher|bacon)\b/i,label:"rasher",weight:25},{pattern:/\b(rice cake)\b/i,label:"cake",weight:9},{pattern:/\b(cracker|ryvita)\b/i,label:"cracker",weight:10}],Te=(E,z)=>{const ie=E||"",ne=ie.match(/\((\d+\.?\d*)\s*g\)/i),Ze=ie.match(/(?:^|per\s+)(\d*\s*[a-z][a-z\s]*?)(?:\s*\(|\s*-\s*|\s*$)/i);if(ne&&Ze){const Lt=parseFloat(ne[1]);let xt=Ze[1].replace(/^\d+\s*/,"").trim();if(xt&&Lt>0)return{label:xt,weight:Lt}}const nt=ie.match(/(\d+\.?\d*)\s*g\s*[\/=]\s*(\d*\s*[a-z][a-z\s]*)/i);if(nt){const Lt=parseFloat(nt[1]);let xt=nt[2].replace(/^\d+\s*/,"").trim();if(xt&&Lt>0)return{label:xt,weight:Lt}}const ct=z||"";for(const{pattern:Lt,label:xt,weight:fs}of Ee)if(Lt.test(ct))return{label:xt,weight:fs};return null},Se=E=>{const z=E.nutriments||{},ie=ye(E),ne=F(E.serving_size),Ze=ie==="ml"?ne.unit==="ml"?ne.value:100:ne.value,nt=E.product_name||E.product_name_en||"Unknown Product",ct=Te(E.serving_size,nt);return{name:nt,brand:E.brands||"",image:E.image_small_url||E.image_url||null,servingSize:E.serving_size||"100g",servingValue:Ze,servingUnit:ie,portion:ct,protein:Math.round(z.proteins_100g||z.proteins||0),carbs:Math.round(z.carbohydrates_100g||z.carbohydrates||0),fats:Math.round(z.fat_100g||z.fat||0),calories:Math.round(z["energy-kcal_100g"]||z["energy-kcal"]||(z.energy_100g?z.energy_100g/4.184:0)),per100g:!0}},bt=async E=>{Ve(!0);try{const z=`https://world.openfoodfacts.org/api/v2/product/${E}?fields=product_name,product_name_en,brands,image_small_url,image_url,serving_size,quantity,nutriments`,ie=await fetch(z);if(!ie.ok)throw new Error(`HTTP ${ie.status}`);const ne=await ie.json();if(ne.status==="success"||ne.status===1||ne.product){const Ze=Se(ne.product);Ze.calories===0&&Ze.protein===0&&Ze.carbs===0?Ms("Product found but no nutrition data available.","error"):(Dt(Ze),Ze.portion?(Ct(1),Kt(String(Ze.portion.weight)),Ot("portion")):(Ct(0),Kt(String(Ze.servingValue||100)),Ot("weight")),Fe(""))}else Ms("Product not found. Try search or manual entry.","error")}catch(z){console.error("Barcode lookup error:",z),Ms("Failed to look up product. Check your connection.","error")}Ve(!1)},At=(E,z,ie)=>{const ne=E.toLowerCase().trim(),Ze=z.toLowerCase().trim(),nt=ie.toLowerCase().trim();let ct=0;return(ne===nt||ne===nt+"s"||ne+"s"===nt)&&(ct+=100),(ne.endsWith(" "+nt)||ne.endsWith(" "+nt+"s"))&&(ct+=40),(ne.startsWith(nt+" ")||ne.startsWith(nt+"s "))&&(ct+=15),nt.split(/\s+/).some(xt=>Ze===xt||Ze.startsWith(xt))&&(ct+=30),ct+=Math.max(0,30-ne.length),ct},ft=async()=>{if(!Me.trim())return;xs.current&&xs.current.abort();const E=new AbortController;xs.current=E;const z=Me.trim().toLowerCase(),ie=z.split(/\s+/).filter(Boolean);if(Kp.has(z)){ot(Kp.get(z));return}Ns(!0);try{const Ze=`https://world.openfoodfacts.org/cgi/search.pl?search_terms=${encodeURIComponent(Me.trim())}&search_simple=1&action=process&json=1&page_size=10&lc=en&sort_by=unique_scans_n&fields=product_name,product_name_en,brands,image_small_url,image_url,serving_size,quantity,nutriments`,nt=await fetch(Ze,{signal:E.signal});if(!nt.ok)throw new Error(`HTTP ${nt.status}`);const Lt=((await nt.json()).products||[]).map(xt=>Se(xt)).filter(xt=>xt.name!=="Unknown Product"&&(xt.calories>0||xt.protein>0)).filter(xt=>{const fs=(xt.name+" "+xt.brand).toLowerCase();return ie.every(nn=>fs.includes(nn))}).sort((xt,fs)=>At(fs.name,fs.brand,z)-At(xt.name,xt.brand,z)).slice(0,10);Kp.set(z,Lt),ot(Lt),Lt.length===0&&Ms("No results found. Try a different search.","info")}catch(ne){if(ne.name==="AbortError")return;console.error("Search error:",ne),Ms("Search failed. Check your connection.","error")}Ns(!1)};b.useEffect(()=>{if(is.current&&clearTimeout(is.current),!(!Me.trim()||$!=="search"||oe))return is.current=setTimeout(()=>{ft()},700),()=>clearTimeout(is.current)},[Me]);const zt=()=>{const E={...Y,water:Y.water+1};Z(E),Fs(E)},Bt=()=>{if(Y.water<=0)return;const E={...Y,water:Y.water-1};Z(E),Fs(E)},Ps=l,hn={"ring-protein":Ps?"#2dd4bf":"#14b8a6","ring-carbs":Ps?"#fbbf24":"#f59e0b","ring-fats":Ps?"#a78bfa":"#8b5cf6","ring-cals":"var(--color-primary)"},tn=80,En=2*Math.PI*tn,zs=(E,z,ie,ne,Ze)=>{const nt=ne>0?Math.min(100,Math.round(ie/ne*100)):0,ct=En-nt/100*En,Lt=hn[Ze]||"#14b8a6";return r.jsxs("div",{className:"nut-ring-wrap",children:[r.jsxs("svg",{className:"nut-ring-svg",viewBox:"0 0 200 200",children:[r.jsx("circle",{className:"nut-arc-track",cx:"100",cy:"100",r:tn}),r.jsx("circle",{className:"nut-arc-fill",cx:"100",cy:"100",r:tn,style:{stroke:Lt},strokeDasharray:En,strokeDashoffset:ct})]}),r.jsxs("div",{className:"nut-ring-center",children:[r.jsx("span",{className:"nut-ring-value",style:{color:Lt},children:Math.round(ie)}),r.jsxs("span",{className:"nut-ring-target",children:["/ ",ne,E==="Calories"?"":"g"]}),r.jsx("span",{className:"nut-ring-label",style:{color:Lt},children:z})]}),r.jsxs("span",{className:"nut-ring-pct",style:{color:Lt},children:[nt,"%"]})]})};if(b.useEffect(()=>{if(!J)return;const E=setTimeout(()=>{const z=J;it(),P(null),bt(z)},1500);return()=>clearTimeout(E)},[J]),b.useEffect(()=>()=>{const E=kt.current;if(us.current&&E){try{E.stop(),E.offDetected()}catch{}us.current=!1}},[]),i||g==="loading")return r.jsxs("div",{className:"nut-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>p("/client/core-buddy"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})]})}),r.jsx("div",{className:"nut-loading-inline",children:r.jsx("div",{className:"cb-loading-spinner"})})]});if(g==="setup")return r.jsxs("div",{className:"nut-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>p("/client/core-buddy"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),r.jsxs("main",{className:"nut-main",children:[r.jsxs("div",{className:"nut-setup-intro",children:[r.jsx("h2",{children:"Set Your Daily Targets"}),r.jsx("p",{children:"Calculate your personalised macros based on your body and goals."})]}),r.jsxs("div",{className:"nut-calc-form",children:[r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Gender"}),r.jsxs("div",{className:"nut-toggle-group",children:[r.jsx("button",{className:j.gender==="male"?"active":"",onClick:()=>{O(E=>({...E,gender:"male"})),B(null)},children:"Male"}),r.jsx("button",{className:j.gender==="female"?"active":"",onClick:()=>{O(E=>({...E,gender:"female"})),B(null)},children:"Female"})]})]}),r.jsxs("div",{className:"nut-form-row",children:[r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Age"}),r.jsx("input",{type:"number",value:j.age,onChange:E=>{O(z=>({...z,age:E.target.value})),B(null)},placeholder:"Years",min:"15",max:"100"})]}),r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Weight"}),r.jsxs("div",{className:"nut-input-unit",children:[r.jsx("input",{type:"number",value:j.weight,onChange:E=>{O(z=>({...z,weight:E.target.value})),B(null)},placeholder:j.weightUnit,min:"30",max:"300"}),r.jsxs("div",{className:"nut-unit-toggle",children:[r.jsx("button",{className:j.weightUnit==="kg"?"active":"",onClick:()=>{O(E=>({...E,weightUnit:"kg"})),B(null)},children:"kg"}),r.jsx("button",{className:j.weightUnit==="lbs"?"active":"",onClick:()=>{O(E=>({...E,weightUnit:"lbs"})),B(null)},children:"lbs"})]})]})]})]}),r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Height"}),r.jsxs("div",{className:"nut-input-unit",children:[j.heightUnit==="cm"?r.jsx("input",{type:"number",value:j.height,onChange:E=>{O(z=>({...z,height:E.target.value})),B(null)},placeholder:"cm",min:"100",max:"250"}):r.jsxs("div",{className:"nut-height-imperial",children:[r.jsx("input",{type:"number",value:j.heightFeet,onChange:E=>{O(z=>({...z,heightFeet:E.target.value})),B(null)},placeholder:"ft",min:"4",max:"7"}),r.jsx("input",{type:"number",value:j.heightInches,onChange:E=>{O(z=>({...z,heightInches:E.target.value})),B(null)},placeholder:"in",min:"0",max:"11"})]}),r.jsxs("div",{className:"nut-unit-toggle",children:[r.jsx("button",{className:j.heightUnit==="cm"?"active":"",onClick:()=>{O(E=>({...E,heightUnit:"cm"})),B(null)},children:"cm"}),r.jsx("button",{className:j.heightUnit==="ft"?"active":"",onClick:()=>{O(E=>({...E,heightUnit:"ft"})),B(null)},children:"ft/in"})]})]})]}),r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Daily Activity (outside of training)"}),r.jsxs("select",{value:j.dailyActivity,onChange:E=>{O(z=>({...z,dailyActivity:E.target.value})),B(null)},children:[r.jsx("option",{value:"sedentary",children:"Sedentary  desk job, under 5k steps"}),r.jsx("option",{value:"light",children:"Lightly Active  office + walking, 5-8k steps"}),r.jsx("option",{value:"moderate",children:"Moderately Active  on feet often, 8-12k steps"}),r.jsx("option",{value:"active",children:"Very Active  physical job, 12k+ steps"})]})]}),r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Training Sessions per Week"}),r.jsxs("select",{value:j.trainingFrequency,onChange:E=>{O(z=>({...z,trainingFrequency:E.target.value})),B(null)},children:[r.jsx("option",{value:"low",children:"1-2 sessions"}),r.jsx("option",{value:"moderate",children:"3-4 sessions"}),r.jsx("option",{value:"high",children:"5-6 sessions"}),r.jsx("option",{value:"daily",children:"7+ sessions"})]})]}),r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Fitness Goal"}),r.jsxs("div",{className:"nut-goal-options",children:[r.jsxs("button",{className:j.goal==="lose"?"active":"",onClick:()=>{O(E=>({...E,goal:"lose"})),B(null)},children:[r.jsx("span",{className:"nut-goal-icon",children:"-"}),r.jsx("span",{children:"Lose Weight"})]}),r.jsxs("button",{className:j.goal==="maintain"?"active":"",onClick:()=>{O(E=>({...E,goal:"maintain"})),B(null)},children:[r.jsx("span",{className:"nut-goal-icon",children:"="}),r.jsx("span",{children:"Maintain"})]}),r.jsxs("button",{className:j.goal==="build"?"active":"",onClick:()=>{O(E=>({...E,goal:"build"})),B(null)},children:[r.jsx("span",{className:"nut-goal-icon",children:"+"}),r.jsx("span",{children:"Build Muscle"})]})]})]}),j.goal==="lose"&&r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Deficit Level"}),r.jsxs("div",{className:"nut-deficit-options",children:[r.jsxs("button",{className:j.deficitLevel==="light"?"active":"",onClick:()=>{O(E=>({...E,deficitLevel:"light"})),B(null)},children:[r.jsx("strong",{children:"Mild"}),r.jsx("span",{children:"15% below TDEE"})]}),r.jsxs("button",{className:j.deficitLevel==="moderate"?"active":"",onClick:()=>{O(E=>({...E,deficitLevel:"moderate"})),B(null)},children:[r.jsx("strong",{children:"Moderate"}),r.jsx("span",{children:"20% below TDEE"})]}),r.jsxs("button",{className:j.deficitLevel==="harsh"?"active":"",onClick:()=>{O(E=>({...E,deficitLevel:"harsh"})),B(null)},children:[r.jsx("strong",{children:"Aggressive"}),r.jsx("span",{children:"25% below TDEE"})]})]})]}),r.jsx("button",{className:"nut-calc-btn",onClick:rt,disabled:!at(),children:"Calculate Macros"})]}),K&&r.jsxs("div",{className:"nut-calc-results",children:[r.jsx("h3",{children:"Your Daily Targets"}),r.jsxs("div",{className:"nut-calc-rings",children:[zs("Protein","Protein",K.protein,K.protein,"ring-protein"),zs("Carbs","Carbs",K.carbs,K.carbs,"ring-carbs"),zs("Fats","Fats",K.fats,K.fats,"ring-fats"),zs("Calories","Calories",K.calories,K.calories,"ring-cals")]}),r.jsxs("div",{className:"nut-calc-info",children:[r.jsxs("div",{className:"nut-calc-info-row",children:[r.jsx("span",{children:"BMR (body at rest)"}),r.jsxs("span",{children:[K.bmr," cal"]})]}),r.jsxs("div",{className:"nut-calc-info-row",children:[r.jsx("span",{children:"+ Daily activity (NEAT)"}),r.jsxs("span",{children:[K.neat," cal"]})]}),r.jsxs("div",{className:"nut-calc-info-row",children:[r.jsx("span",{children:"+ Training sessions"}),r.jsxs("span",{children:["+",K.exerciseAdd," cal"]})]}),r.jsxs("div",{className:"nut-calc-info-row",style:{fontWeight:600},children:[r.jsx("span",{children:"TDEE (total burn)"}),r.jsxs("span",{children:[K.tdee," cal"]})]})]}),r.jsx("button",{className:"nut-save-targets-btn",onClick:Ke,children:"Set as My Daily Targets"})]})]}),Gt&&r.jsx("div",{className:`toast-notification ${Gt.type}`,children:Gt.message})]});const sn=E=>{const z=new Date(E+"T12:00:00"),ie=z.getDay(),ne=new Date(z);ne.setDate(z.getDate()-(ie+6)%7);const Ze=[];for(let nt=0;nt<7;nt++){const ct=new Date(ne);ct.setDate(ne.getDate()+nt),Ze.push(ct.toISOString().split("T")[0])}return Ze},hs=["M","T","W","T","F","S","S"],G=(E,z="search")=>{A(E),z==="scan"?(pe("scan"),Dt(null)):z==="manual"?(pe("manual"),Tt({name:"",protein:"",carbs:"",fats:"",calories:"",serving:""})):z==="favourites"?pe("favourites"):(pe("search"),ot([]),mt(""))},me=sn(D),ae=new Date(D+"T12:00:00"),xe=`${Ie[ae.getMonth()]} ${ae.getFullYear()}`;return r.jsx(Sa,{children:r.jsxs("div",{className:"nut-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsxs("div",{className:"nut-dark-zone",children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>p("/client/core-buddy"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsxs("div",{className:"header-actions",children:[r.jsx("button",{onClick:()=>{y("setup"),B(null)},"aria-label":"Recalculate macros",children:r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"3"}),r.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 1 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 1 1-2.83-2.83l.06-.06A1.65 1.65 0 0 0 4.68 15a1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1 0-4h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 1 1 2.83-2.83l.06.06A1.65 1.65 0 0 0 9 4.68a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 2.83l-.06.06A1.65 1.65 0 0 0 19.4 9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1z"})]})}),r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})]})]})}),r.jsxs("div",{className:"nut-dark-content",children:[r.jsxs("div",{className:"nut-week-strip anim-fade-up",children:[r.jsxs("div",{className:"nut-week-header",children:[r.jsx("button",{className:"nut-week-arrow",onClick:()=>{const E=new Date(D+"T12:00:00");E.setDate(E.getDate()-7);const z=E.toISOString().split("T")[0];te(z)},"aria-label":"Previous week",children:r.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:r.jsx("polyline",{points:"15 18 9 12 15 6"})})}),r.jsx("button",{className:"nut-week-month-label",onClick:()=>{C(!_e),I({year:ae.getFullYear(),month:ae.getMonth()})},children:xe}),r.jsx("button",{className:"nut-week-arrow",onClick:()=>{const E=new Date(D+"T12:00:00");E.setDate(E.getDate()+7);const z=E.toISOString().split("T")[0];z<=so()&&te(z)},"aria-label":"Next week",disabled:me[6]>=so(),children:r.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:r.jsx("polyline",{points:"9 18 15 12 9 6"})})})]}),r.jsx("div",{className:"nut-week-days",children:me.map((E,z)=>{const ie=new Date(E+"T12:00:00").getDate(),ne=E===D,Ze=E>so(),nt=E===so();return r.jsxs("button",{className:`nut-week-day${ne?" selected":""}${nt?" today":""}${Ze?" future":""}`,disabled:Ze,onClick:()=>te(E),children:[r.jsx("span",{className:"nut-week-day-letter",children:hs[z]}),r.jsx("span",{className:"nut-week-day-num",children:ie})]},E)})})]}),_e&&r.jsxs("div",{className:"nut-calendar nut-calendar-dark",children:[r.jsxs("div",{className:"nut-cal-header",children:[r.jsx("button",{onClick:()=>I(E=>{let z=E.month-1,ie=E.year;return z<0&&(z=11,ie--),{year:ie,month:z}}),children:r.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("polyline",{points:"15 18 9 12 15 6"})})}),r.jsxs("span",{children:[Ie[V.month]," ",V.year]}),r.jsx("button",{onClick:()=>I(E=>{let z=E.month+1,ie=E.year;return z>11&&(z=0,ie++),{year:ie,month:z}}),disabled:V.year===new Date().getFullYear()&&V.month>=new Date().getMonth(),children:r.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("polyline",{points:"9 18 15 12 9 6"})})})]}),r.jsx("div",{className:"nut-cal-days-header",children:De.map(E=>r.jsx("span",{children:E},E))}),r.jsxs("div",{className:"nut-cal-grid",children:[[...Array(be(V.year,V.month))].map((E,z)=>r.jsx("span",{},`e${z}`)),[...Array(ws(V.year,V.month))].map((E,z)=>{const ie=z+1,ne=`${V.year}-${String(V.month+1).padStart(2,"0")}-${String(ie).padStart(2,"0")}`,Ze=ne>so(),nt=ne===D,ct=ne===so();return r.jsx("button",{className:`nut-cal-day${nt?" selected":""}${ct?" today":""}${Ze?" future":""}`,disabled:Ze,onClick:()=>{te(ne),C(!1)},children:ie},ie)})]})]}),r.jsxs("div",{className:"nut-rings-row anim-fade-up-d2",children:[zs("Protein","Protein",ke.protein,x.protein,"ring-protein"),zs("Carbs","Carbs",ke.carbs,x.carbs,"ring-carbs"),zs("Fats","Fats",ke.fats,x.fats,"ring-fats"),zs("Calories","kCal",ke.calories,x.calories,"ring-cals")]})]})]}),r.jsx("div",{className:"nut-light-zone anim-fade-up-d4",children:r.jsxs("div",{className:"nut-light-content",children:[os&&r.jsxs("button",{className:"nut-water-quick",onClick:()=>M(!0),children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",stroke:"none",width:"18",height:"18",children:r.jsx("path",{d:"M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z"})}),r.jsxs("span",{className:"nut-water-quick-count",children:[Y.water," / ",x?.waterGoal||8]}),r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",width:"14",height:"14",children:[r.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),r.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})]}),r.jsx("div",{className:"nut-log-section",children:r.jsx("div",{className:"nut-meals-list",children:N2.map(E=>{const z=Y.entries.filter(ne=>(ne.meal||"snacks")===E.key),ie=z.reduce((ne,Ze)=>({protein:ne.protein+(Ze.protein||0),carbs:ne.carbs+(Ze.carbs||0),fats:ne.fats+(Ze.fats||0),calories:ne.calories+(Ze.calories||0)}),{protein:0,carbs:0,fats:0,calories:0});return r.jsxs("div",{className:"nut-meal-card",children:[r.jsxs("div",{className:"nut-meal-card-header",children:[r.jsx("span",{className:`nut-meal-card-icon nut-meal-icon-${E.key}`,children:AD[E.key]}),r.jsx("span",{className:"nut-meal-card-title",children:E.label}),z.length>0&&r.jsxs("span",{className:"nut-meal-card-cal",children:[ie.calories," cal"]}),os&&r.jsx("button",{className:"nut-meal-add-btn",onClick:()=>ht(Le===E.key?null:E.key),"aria-label":`Add to ${E.label}`,children:r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:[r.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),r.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})})]}),z.length>0&&r.jsxs("div",{className:"nut-meal-bars",children:[r.jsxs("div",{className:"nut-meal-bar-row",children:[r.jsx("span",{className:"nut-meal-bar-label nut-macro-p",children:"P"}),r.jsx("div",{className:"nut-meal-bar-track",children:r.jsx("div",{className:"nut-meal-bar-fill bar-protein",style:{width:`${Math.min(100,x.protein>0?ie.protein/x.protein*100:0)}%`}})}),r.jsxs("span",{className:"nut-meal-bar-val",children:[ie.protein,"g"]})]}),r.jsxs("div",{className:"nut-meal-bar-row",children:[r.jsx("span",{className:"nut-meal-bar-label nut-macro-c",children:"C"}),r.jsx("div",{className:"nut-meal-bar-track",children:r.jsx("div",{className:"nut-meal-bar-fill bar-carbs",style:{width:`${Math.min(100,x.carbs>0?ie.carbs/x.carbs*100:0)}%`}})}),r.jsxs("span",{className:"nut-meal-bar-val",children:[ie.carbs,"g"]})]}),r.jsxs("div",{className:"nut-meal-bar-row",children:[r.jsx("span",{className:"nut-meal-bar-label nut-macro-f",children:"F"}),r.jsx("div",{className:"nut-meal-bar-track",children:r.jsx("div",{className:"nut-meal-bar-fill bar-fats",style:{width:`${Math.min(100,x.fats>0?ie.fats/x.fats*100:0)}%`}})}),r.jsxs("span",{className:"nut-meal-bar-val",children:[ie.fats,"g"]})]}),r.jsxs("div",{className:"nut-meal-bar-row",children:[r.jsx("span",{className:"nut-meal-bar-label nut-macro-cal",children:"K"}),r.jsx("div",{className:"nut-meal-bar-track",children:r.jsx("div",{className:"nut-meal-bar-fill bar-cals",style:{width:`${Math.min(100,x.calories>0?ie.calories/x.calories*100:0)}%`}})}),r.jsx("span",{className:"nut-meal-bar-val",children:ie.calories})]})]}),z.length>0&&r.jsx("div",{className:"nut-log-list",children:z.map(ne=>r.jsxs("div",{className:"nut-log-item",children:[r.jsx("button",{className:`nut-fav-star log${se(ne.name)?" active":""}`,onClick:()=>Qe(ne),"aria-label":se(ne.name)?"Remove from favourites":"Add to favourites",children:r.jsx("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:se(ne.name)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),r.jsxs("div",{className:"nut-log-item-info",children:[r.jsx("span",{className:"nut-log-item-name",children:ne.name}),ne.serving&&r.jsx("span",{className:"nut-log-item-serving",children:ne.serving})]}),r.jsxs("div",{className:"nut-log-item-macros",children:[r.jsxs("span",{className:"nut-macro-p",children:[ne.protein,"p"]}),r.jsxs("span",{className:"nut-macro-c",children:[ne.carbs,"c"]}),r.jsxs("span",{className:"nut-macro-f",children:[ne.fats,"f"]}),r.jsx("span",{className:"nut-macro-cal",children:ne.calories})]}),os&&r.jsx("button",{className:"nut-log-delete",onClick:()=>et(ne.id),"aria-label":"Remove",children:r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]},ne.id))}),z.length===0&&r.jsx("div",{className:"nut-meal-empty",children:r.jsx("p",{children:os?"Tap + to add food":"No entries"})})]},E.key)})})})]})}),Le&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"nut-add-picker-backdrop",onClick:()=>ht(null)}),r.jsxs("div",{className:"nut-add-picker",children:[r.jsx("div",{className:"nut-add-picker-handle"}),r.jsxs("h3",{className:"nut-add-picker-title",children:["Add to ",N2.find(E=>E.key===Le)?.label]}),r.jsxs("div",{className:"nut-add-picker-options",children:[r.jsxs("button",{onClick:()=>{const E=Le;ht(null),G(E,"scan")},children:[r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M3 7V5a2 2 0 0 1 2-2h2"}),r.jsx("path",{d:"M17 3h2a2 2 0 0 1 2 2v2"}),r.jsx("path",{d:"M21 17v2a2 2 0 0 1-2 2h-2"}),r.jsx("path",{d:"M7 21H5a2 2 0 0 1-2-2v-2"}),r.jsx("line",{x1:"7",y1:"12",x2:"17",y2:"12"})]}),r.jsx("span",{children:"Scan Barcode"})]}),r.jsxs("button",{onClick:()=>{const E=Le;ht(null),G(E,"search")},children:[r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"11",cy:"11",r:"8"}),r.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),r.jsx("span",{children:"Search Food"})]}),r.jsxs("button",{onClick:()=>{const E=Le;ht(null),G(E,"manual")},children:[r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),r.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]}),r.jsx("span",{children:"Manual Entry"})]}),r.jsxs("button",{onClick:()=>{const E=Le;ht(null),G(E,"favourites")},children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),r.jsx("span",{children:"Favourites"})]})]})]})]}),T&&r.jsx("div",{className:"nut-modal-overlay",onClick:()=>M(!1),children:r.jsxs("div",{className:"nut-water-popup",onClick:E=>E.stopPropagation(),children:[r.jsxs("div",{className:"nut-water-popup-header",children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",stroke:"none",width:"20",height:"20",style:{color:"#2196f3"},children:r.jsx("path",{d:"M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z"})}),r.jsx("span",{children:"Water Intake"}),r.jsx("button",{className:"nut-modal-close",onClick:()=>M(!1),children:r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),r.jsxs("div",{className:"nut-water-popup-body",children:[r.jsx("div",{className:"nut-water-glasses",children:[...Array(x?.waterGoal||8)].map((E,z)=>r.jsx("div",{className:`nut-water-glass ${z<Y.water?"filled":""}`,children:r.jsx("svg",{viewBox:"0 0 24 24",fill:z<Y.water?"currentColor":"none",stroke:"currentColor",strokeWidth:"1.5",children:r.jsx("path",{d:"M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z"})})},z))}),r.jsxs("div",{className:"nut-water-popup-count",children:[Y.water," / ",x?.waterGoal||8," glasses"]}),r.jsxs("div",{className:"nut-water-btns",children:[r.jsx("button",{onClick:Bt,disabled:Y.water<=0,children:"-"}),r.jsx("button",{onClick:zt,children:"+"})]})]})]})}),$&&r.jsx("div",{className:"nut-modal-overlay",onClick:()=>{it(),P(null),pe(null),Dt(null)},children:r.jsxs("div",{className:"nut-modal",onClick:E=>E.stopPropagation(),children:[r.jsxs("div",{className:"nut-modal-header",children:[r.jsx("h3",{children:$==="scan"?"Scan Barcode":$==="search"?"Search Food":$==="favourites"?"Favourites":"Manual Entry"}),r.jsx("button",{className:"nut-modal-close",onClick:()=>{it(),P(null),pe(null),Dt(null)},children:r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),$==="scan"&&!oe&&r.jsxs("div",{className:"nut-scan-area",children:[r.jsxs("div",{className:"nut-scanner-wrapper",children:[r.jsx("div",{id:"barcode-reader",className:"nut-scanner-view"}),Be&&!J&&r.jsx("div",{className:"nut-scan-line"}),J&&r.jsxs("div",{className:"nut-scan-detected-overlay",children:[r.jsx("svg",{className:"nut-scan-detected-tick",viewBox:"0 0 24 24",fill:"none",stroke:"#4caf50",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M20 6L9 17l-5-5"})}),r.jsx("p",{className:"nut-scan-detected-label",children:"Barcode found!"}),r.jsx("p",{className:"nut-scan-detected-code",children:J})]})]}),!Be&&r.jsxs("button",{className:"nut-scan-start-btn",onClick:yt,children:[r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M3 7V5a2 2 0 0 1 2-2h2"}),r.jsx("path",{d:"M17 3h2a2 2 0 0 1 2 2v2"}),r.jsx("path",{d:"M21 17v2a2 2 0 0 1-2 2h-2"}),r.jsx("path",{d:"M7 21H5a2 2 0 0 1-2-2v-2"}),r.jsx("line",{x1:"7",y1:"12",x2:"17",y2:"12"})]}),"Open Camera"]}),Be&&!J&&r.jsx("p",{className:"nut-scan-hint",children:"Align barcode within the frame"}),r.jsx("div",{className:"nut-barcode-divider",children:r.jsx("span",{children:"or enter barcode manually"})}),r.jsxs("div",{className:"nut-barcode-manual",children:[r.jsx("input",{type:"text",inputMode:"numeric",value:re,onChange:E=>Fe(E.target.value),onKeyDown:E=>E.key==="Enter"&&re.trim()&&bt(re.trim()),placeholder:"Enter barcode number"}),r.jsx("button",{onClick:()=>re.trim()&&bt(re.trim()),disabled:!re.trim()||qe,children:qe?"...":"Look Up"})]})]}),$==="scan"&&oe&&(()=>{const E=oe.servingUnit||"g",z=oe.portion,ie=lt==="portion"&&z?Et*z.weight:parseFloat(Nt)||0,ne=ie/100,Ze=E==="ml"?[100,200,250,500]:[50,100,150,200],nt=lt==="portion"&&z?`${Et} ${z.label}${Et!==1?"s":""} (${Math.round(ie)}${E})`:`${Math.round(ie)}${E}`;return r.jsxs("div",{className:"nut-product-result",children:[oe.image&&r.jsx("img",{src:oe.image,alt:oe.name||"Product",className:"nut-product-img",loading:"lazy"}),r.jsxs("div",{className:"nut-product-name-row",children:[r.jsx("h4",{children:oe.name}),r.jsx("button",{className:`nut-fav-star confirm${se(oe.name)?" active":""}`,onClick:()=>Qe({name:oe.name,protein:oe.protein,carbs:oe.carbs,fats:oe.fats,calories:oe.calories,serving:oe.servingSize,per100g:{protein:oe.protein,carbs:oe.carbs,fats:oe.fats,calories:oe.calories},servingUnit:oe.servingUnit||"g",portion:oe.portion||null}),children:r.jsx("svg",{viewBox:"0 0 24 24",width:"22",height:"22",fill:se(oe.name)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})})]}),oe.brand&&r.jsx("p",{className:"nut-product-brand",children:oe.brand}),r.jsxs("p",{className:"nut-product-per",children:["Per 100",E,":"]}),r.jsxs("div",{className:"nut-product-macros",children:[r.jsxs("span",{className:"nut-macro-p",children:[oe.protein,"g P"]}),r.jsxs("span",{className:"nut-macro-c",children:[oe.carbs,"g C"]}),r.jsxs("span",{className:"nut-macro-f",children:[oe.fats,"g F"]}),r.jsxs("span",{className:"nut-macro-cal",children:[oe.calories," cal"]})]}),z&&r.jsxs("div",{className:"nut-mode-toggle",children:[r.jsx("button",{className:lt==="portion"?"active":"",onClick:()=>{Ot("portion"),Et<1&&Ct(1)},children:"Portions"}),r.jsxs("button",{className:lt==="weight"?"active":"",onClick:()=>{Ot("weight"),Kt(String(Math.round(ie)||100))},children:["Custom (",E,")"]})]}),lt==="portion"&&z?r.jsxs("div",{className:"nut-portion-stepper",children:[r.jsx("button",{className:"nut-stepper-btn",onClick:()=>Ct(Math.max(1,Et-1)),children:"-"}),r.jsxs("div",{className:"nut-stepper-display",children:[r.jsx("span",{className:"nut-stepper-count",children:Et}),r.jsxs("span",{className:"nut-stepper-label",children:[z.label,Et!==1?"s":""]}),r.jsxs("span",{className:"nut-stepper-weight",children:[Math.round(ie),E]})]}),r.jsx("button",{className:"nut-stepper-btn",onClick:()=>Ct(Et+1),children:"+"})]}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"nut-serving-adjust",children:[r.jsxs("label",{children:["Serving (",E,")"]}),r.jsx("input",{type:"number",inputMode:"numeric",value:Nt,onChange:ct=>Kt(ct.target.value),onFocus:ct=>ct.target.select(),min:"0"})]}),r.jsx("div",{className:"nut-quick-amounts",children:Ze.map(ct=>r.jsxs("button",{className:`nut-quick-btn${Nt===String(ct)?" active":""}`,onClick:()=>Kt(String(ct)),children:[ct,E]},ct))})]}),r.jsx("div",{className:"nut-product-total",children:r.jsxs("span",{children:["Total: ",Math.round(oe.protein*ne),"p / ",Math.round(oe.carbs*ne),"c / ",Math.round(oe.fats*ne),"f / ",Math.round(oe.calories*ne)," cal"]})}),r.jsxs("div",{className:"nut-product-actions",children:[r.jsx("button",{className:"nut-btn-secondary",onClick:()=>{Dt(null),pe("scan")},children:"Scan Again"}),r.jsx("button",{className:"nut-btn-primary",onClick:()=>_t({name:oe.name,protein:Math.round(oe.protein*ne),carbs:Math.round(oe.carbs*ne),fats:Math.round(oe.fats*ne),calories:Math.round(oe.calories*ne),serving:nt}),children:"Add"})]})]})})(),$==="search"&&!oe&&r.jsxs("div",{className:"nut-search-area",children:[r.jsxs("div",{className:"nut-search-bar",children:[r.jsx("input",{type:"text",ref:Qs,value:Me,onChange:E=>mt(E.target.value),onKeyDown:E=>{E.key==="Enter"&&(clearTimeout(is.current),ft())},onFocus:()=>setTimeout(()=>Qs.current?.scrollIntoView({behavior:"smooth",block:"center"}),350),placeholder:"Search food or product...",autoFocus:!0}),r.jsx("button",{onClick:ft,disabled:es,children:es?"...":"Search"})]}),r.jsxs("div",{className:"nut-search-results",children:[wt.map((E,z)=>r.jsxs("button",{className:"nut-search-item",onClick:()=>{Dt(E),E.portion?(Ct(1),Kt(String(E.portion.weight)),Ot("portion")):(Ct(0),Kt(String(E.servingValue||100)),Ot("weight"))},children:[E.image&&r.jsx("img",{src:E.image,alt:E.name||"Product",loading:"lazy"}),r.jsxs("div",{className:"nut-search-item-info",children:[r.jsx("span",{className:"nut-search-item-name",children:E.name}),E.brand&&r.jsx("span",{className:"nut-search-item-brand",children:E.brand}),r.jsxs("span",{className:"nut-search-item-macros",children:[E.calories," cal  ",E.protein,"p  ",E.carbs,"c  ",E.fats,"f per 100",E.servingUnit||"g"]})]})]},z)),wt.length===0&&Me&&!es&&r.jsx("p",{className:"nut-search-empty",children:"No results found. Try a different search or use manual entry."})]})]}),$==="search"&&oe&&(()=>{const E=oe.servingUnit||"g",z=oe.portion,ie=lt==="portion"&&z?Et*z.weight:parseFloat(Nt)||0,ne=ie/100,Ze=E==="ml"?[100,200,250,500]:[50,100,150,200],nt=lt==="portion"&&z?`${Et} ${z.label}${Et!==1?"s":""} (${Math.round(ie)}${E})`:`${Math.round(ie)}${E}`;return r.jsxs("div",{className:"nut-product-result",children:[oe.image&&r.jsx("img",{src:oe.image,alt:oe.name||"Product",className:"nut-product-img",loading:"lazy"}),r.jsxs("div",{className:"nut-product-name-row",children:[r.jsx("h4",{children:oe.name}),r.jsx("button",{className:`nut-fav-star confirm${se(oe.name)?" active":""}`,onClick:()=>Qe({name:oe.name,protein:oe.protein,carbs:oe.carbs,fats:oe.fats,calories:oe.calories,serving:oe.servingSize,per100g:{protein:oe.protein,carbs:oe.carbs,fats:oe.fats,calories:oe.calories},servingUnit:oe.servingUnit||"g",portion:oe.portion||null}),children:r.jsx("svg",{viewBox:"0 0 24 24",width:"22",height:"22",fill:se(oe.name)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})})]}),oe.brand&&r.jsx("p",{className:"nut-product-brand",children:oe.brand}),r.jsxs("p",{className:"nut-product-per",children:["Per 100",E,":"]}),r.jsxs("div",{className:"nut-product-macros",children:[r.jsxs("span",{className:"nut-macro-p",children:[oe.protein,"g P"]}),r.jsxs("span",{className:"nut-macro-c",children:[oe.carbs,"g C"]}),r.jsxs("span",{className:"nut-macro-f",children:[oe.fats,"g F"]}),r.jsxs("span",{className:"nut-macro-cal",children:[oe.calories," cal"]})]}),z&&r.jsxs("div",{className:"nut-mode-toggle",children:[r.jsx("button",{className:lt==="portion"?"active":"",onClick:()=>{Ot("portion"),Et<1&&Ct(1)},children:"Portions"}),r.jsxs("button",{className:lt==="weight"?"active":"",onClick:()=>{Ot("weight"),Kt(String(Math.round(ie)||100))},children:["Custom (",E,")"]})]}),lt==="portion"&&z?r.jsxs("div",{className:"nut-portion-stepper",children:[r.jsx("button",{className:"nut-stepper-btn",onClick:()=>Ct(Math.max(1,Et-1)),children:"-"}),r.jsxs("div",{className:"nut-stepper-display",children:[r.jsx("span",{className:"nut-stepper-count",children:Et}),r.jsxs("span",{className:"nut-stepper-label",children:[z.label,Et!==1?"s":""]}),r.jsxs("span",{className:"nut-stepper-weight",children:[Math.round(ie),E]})]}),r.jsx("button",{className:"nut-stepper-btn",onClick:()=>Ct(Et+1),children:"+"})]}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"nut-serving-adjust",children:[r.jsxs("label",{children:["Serving (",E,")"]}),r.jsx("input",{type:"number",inputMode:"numeric",value:Nt,onChange:ct=>Kt(ct.target.value),onFocus:ct=>ct.target.select(),min:"0"})]}),r.jsx("div",{className:"nut-quick-amounts",children:Ze.map(ct=>r.jsxs("button",{className:`nut-quick-btn${Nt===String(ct)?" active":""}`,onClick:()=>Kt(String(ct)),children:[ct,E]},ct))})]}),r.jsx("div",{className:"nut-product-total",children:r.jsxs("span",{children:["Total: ",Math.round(oe.protein*ne),"p / ",Math.round(oe.carbs*ne),"c / ",Math.round(oe.fats*ne),"f / ",Math.round(oe.calories*ne)," cal"]})}),r.jsxs("div",{className:"nut-product-actions",children:[r.jsx("button",{className:"nut-btn-secondary",onClick:()=>Dt(null),children:"Back to Search"}),r.jsx("button",{className:"nut-btn-primary",onClick:()=>_t({name:oe.name,protein:Math.round(oe.protein*ne),carbs:Math.round(oe.carbs*ne),fats:Math.round(oe.fats*ne),calories:Math.round(oe.calories*ne),serving:nt}),children:"Add"})]})]})})(),$==="manual"&&r.jsxs("div",{className:"nut-manual-form",children:[r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Food Name"}),r.jsx("input",{type:"text",value:Ft.name,onChange:E=>Tt(z=>({...z,name:E.target.value})),placeholder:"e.g. Chicken Breast",autoFocus:!0})]}),r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Serving Size (optional)"}),r.jsx("input",{type:"text",value:Ft.serving,onChange:E=>Tt(z=>({...z,serving:E.target.value})),placeholder:"e.g. 150g, 1 cup"})]}),r.jsxs("div",{className:"nut-manual-macros",children:[r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Protein (g)"}),r.jsx("input",{type:"number",value:Ft.protein,onChange:E=>Tt(z=>({...z,protein:E.target.value})),min:"0"})]}),r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Carbs (g)"}),r.jsx("input",{type:"number",value:Ft.carbs,onChange:E=>Tt(z=>({...z,carbs:E.target.value})),min:"0"})]}),r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Fats (g)"}),r.jsx("input",{type:"number",value:Ft.fats,onChange:E=>Tt(z=>({...z,fats:E.target.value})),min:"0"})]}),r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Calories"}),r.jsx("input",{type:"number",value:Ft.calories,onChange:E=>Tt(z=>({...z,calories:E.target.value})),min:"0"})]})]}),r.jsx("button",{className:"nut-btn-primary",disabled:!Ft.name.trim(),onClick:()=>_t({name:Ft.name,protein:parseFloat(Ft.protein)||0,carbs:parseFloat(Ft.carbs)||0,fats:parseFloat(Ft.fats)||0,calories:parseFloat(Ft.calories)||0,serving:Ft.serving||""}),children:"Add Food"})]}),$==="favourites"&&!oe&&(()=>{const E=X(),z=ie=>{if(ie.per100g){const ne=ie.per100g;Dt({name:ie.name,brand:"",image:null,servingSize:ie.serving||"100g",servingValue:100,servingUnit:ie.servingUnit||"g",portion:ie.portion||null,protein:ne.protein,carbs:ne.carbs,fats:ne.fats,calories:ne.calories,per100g:!0}),ie.portion?(Ct(1),Kt(String(ie.portion.weight)),Ot("portion")):(Ct(0),Kt("100"),Ot("weight"))}else _t({name:ie.name,protein:ie.protein,carbs:ie.carbs,fats:ie.fats,calories:ie.calories,serving:ie.serving||""})};return r.jsx("div",{className:"nut-recent-area",children:E.length===0?r.jsx("p",{className:"nut-search-empty",children:"No favourites yet. Tap the star on any food to save it here."}):r.jsx("div",{className:"nut-recent-list",children:E.map((ie,ne)=>r.jsxs("div",{className:"nut-recent-item-row",children:[r.jsx("button",{className:"nut-fav-star active",onClick:Ze=>{Ze.stopPropagation(),Qe(ie)},children:r.jsx("svg",{viewBox:"0 0 24 24",width:"18",height:"18",fill:"currentColor",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),r.jsxs("button",{className:"nut-recent-item",onClick:()=>z(ie),children:[r.jsxs("div",{className:"nut-recent-item-info",children:[r.jsx("span",{className:"nut-recent-item-name",children:ie.name}),r.jsx("span",{className:"nut-recent-item-serving",children:ie.serving||""})]}),r.jsxs("span",{className:"nut-recent-item-macros",children:[ie.calories," cal"]})]})]},ne))})})})(),$==="favourites"&&oe&&(()=>{const E=oe.servingUnit||"g",z=oe.portion,ie=lt==="portion"&&z?Et*z.weight:parseFloat(Nt)||0,ne=ie/100,Ze=E==="ml"?[100,200,250,500]:[50,100,150,200],nt=lt==="portion"&&z?`${Et} ${z.label}${Et!==1?"s":""} (${Math.round(ie)}${E})`:`${Math.round(ie)}${E}`;return r.jsxs("div",{className:"nut-product-result",children:[r.jsxs("div",{className:"nut-product-name-row",children:[r.jsx("h4",{children:oe.name}),r.jsx("button",{className:`nut-fav-star confirm${se(oe.name)?" active":""}`,onClick:()=>Qe({name:oe.name,protein:oe.protein,carbs:oe.carbs,fats:oe.fats,calories:oe.calories,serving:oe.servingSize,per100g:{protein:oe.protein,carbs:oe.carbs,fats:oe.fats,calories:oe.calories},servingUnit:oe.servingUnit||"g",portion:oe.portion||null}),children:r.jsx("svg",{viewBox:"0 0 24 24",width:"22",height:"22",fill:se(oe.name)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})})]}),r.jsxs("p",{className:"nut-product-per",children:["Per 100",E,":"]}),r.jsxs("div",{className:"nut-product-macros",children:[r.jsxs("span",{className:"nut-macro-p",children:[oe.protein,"g P"]}),r.jsxs("span",{className:"nut-macro-c",children:[oe.carbs,"g C"]}),r.jsxs("span",{className:"nut-macro-f",children:[oe.fats,"g F"]}),r.jsxs("span",{className:"nut-macro-cal",children:[oe.calories," cal"]})]}),z&&r.jsxs("div",{className:"nut-mode-toggle",children:[r.jsx("button",{className:lt==="portion"?"active":"",onClick:()=>{Ot("portion"),Et<1&&Ct(1)},children:"Portions"}),r.jsxs("button",{className:lt==="weight"?"active":"",onClick:()=>{Ot("weight"),Kt(String(Math.round(ie)||100))},children:["Custom (",E,")"]})]}),lt==="portion"&&z?r.jsxs("div",{className:"nut-portion-stepper",children:[r.jsx("button",{className:"nut-stepper-btn",onClick:()=>Ct(Math.max(1,Et-1)),children:"-"}),r.jsxs("div",{className:"nut-stepper-display",children:[r.jsx("span",{className:"nut-stepper-count",children:Et}),r.jsxs("span",{className:"nut-stepper-label",children:[z.label,Et!==1?"s":""]}),r.jsxs("span",{className:"nut-stepper-weight",children:[Math.round(ie),E]})]}),r.jsx("button",{className:"nut-stepper-btn",onClick:()=>Ct(Et+1),children:"+"})]}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"nut-serving-adjust",children:[r.jsxs("label",{children:["Serving (",E,")"]}),r.jsx("input",{type:"number",inputMode:"numeric",value:Nt,onChange:ct=>Kt(ct.target.value),onFocus:ct=>ct.target.select(),min:"0"})]}),r.jsx("div",{className:"nut-quick-amounts",children:Ze.map(ct=>r.jsxs("button",{className:`nut-quick-btn${Nt===String(ct)?" active":""}`,onClick:()=>Kt(String(ct)),children:[ct,E]},ct))})]}),r.jsx("div",{className:"nut-product-total",children:r.jsxs("span",{children:["Total: ",Math.round(oe.protein*ne),"p / ",Math.round(oe.carbs*ne),"c / ",Math.round(oe.fats*ne),"f / ",Math.round(oe.calories*ne)," cal"]})}),r.jsxs("div",{className:"nut-product-actions",children:[r.jsx("button",{className:"nut-btn-secondary",onClick:()=>Dt(null),children:"Back to Favourites"}),r.jsx("button",{className:"nut-btn-primary",onClick:()=>_t({name:oe.name,protein:Math.round(oe.protein*ne),carbs:Math.round(oe.carbs*ne),fats:Math.round(oe.fats*ne),calories:Math.round(oe.calories*ne),serving:nt}),children:"Add"})]})]})})()]})}),r.jsx(Ta,{active:"nutrition"}),Gt&&r.jsx("div",{className:`toast-notification ${Gt.type}`,children:Gt.message})]})})}async function nb(n){const{type:e="workout",title:t="Workout Complete!",stats:i=[],badges:l=[],badgeImage:u,badgeDesc:d}=n,p=1080,g=1920,y=document.createElement("canvas");y.width=p,y.height=g;const x=y.getContext("2d"),_="#2a2a28",j="#ffffff",O="#A12F3A",K="#1a1a1a",B="#555555";x.fillStyle=_,x.fillRect(0,0,p,g);const D=Math.round(p*.82),te=Math.round(g*.75),Y=Math.round((p-D)/2),Z=Math.round((g-te)/2),ke=28,Re=5;x.save(),x.shadowColor="rgba(0, 0, 0, 0.45)",x.shadowBlur=40,x.shadowOffsetY=10,C2(x,Y,Z,D,te,ke),x.fillStyle=j,x.fill(),x.restore(),x.save(),C2(x,Y,Z,D,te,ke),x.strokeStyle=O,x.lineWidth=Re,x.stroke(),x.restore();const _e=220,C=50,T=52,M=68,V=10,I=36,L=48,A=30,Le=34,ht=46,$=30,pe=28;x.font=`bold ${T}px 'Orbitron', sans-serif`;const Be=ou(x,t.toUpperCase(),D-100);x.font=`500 ${I}px 'Montserrat', sans-serif`;let We=[];e==="badge"&&d?We=ou(x,d,D-120):e==="badge"&&l.length>0?We=ou(x,l.join("    "),D-120):i.length>0&&(We=ou(x,i.map(Dt=>`${Dt.value} ${Dt.label}`).join("    "),D-120));const J=e==="badge"?"I just earned a badge on Core Buddy ":e==="habits"?"I just completed my daily habits with Core Buddy ":"I just completed a workout using Core Buddy ";x.font=`bold ${Le}px 'Montserrat', sans-serif`;const P=ou(x,J,D-80);let re=Be.length*M;We.length>0&&(re+=V+We.length*L),re+=A+P.length*ht,re+=$+pe;const qe=Z+te-60-re,Me=Z+40,mt=qe-C,wt=p/2,ot=(Me+mt)/2,es=e==="badge"&&u?u:"/Logo.webp";x.save();const Ns=e==="badge"?"rgba(255, 193, 7, 0.15)":"rgba(161, 47, 58, 0.12)",Ft=x.createRadialGradient(wt,ot,_e*.6,wt,ot,_e*1.5);Ft.addColorStop(0,Ns),Ft.addColorStop(1,"rgba(0, 0, 0, 0)"),x.fillStyle=Ft,x.fillRect(wt-_e*1.5,ot-_e*1.5,_e*3,_e*3),x.restore(),x.beginPath(),x.arc(wt,ot,_e+6,0,Math.PI*2),x.fillStyle=j,x.fill();const Tt=e==="badge"?"#ffc107":O;x.beginPath(),x.arc(wt,ot,_e,0,Math.PI*2),x.strokeStyle=Tt,x.lineWidth=5,x.stroke();try{const Dt=await DD(es);x.save(),x.beginPath(),x.arc(wt,ot,_e-6,0,Math.PI*2),x.clip();const Nt=(_e-6)*2;x.drawImage(Dt,wt-_e+6,ot-_e+6,Nt,Nt),x.restore()}catch{x.textAlign="center",x.textBaseline="middle",x.fillStyle=O,x.font="bold 80px 'Orbitron', sans-serif",x.fillText(e==="badge"?"":"MCF",wt,ot)}let oe=qe;x.textAlign="center",x.textBaseline="alphabetic",x.fillStyle=K,x.font=`bold ${T}px 'Orbitron', sans-serif`;for(const Dt of Be)x.fillText(Dt,p/2,oe),oe+=M;if(We.length>0){oe+=V,x.fillStyle=B,x.font=`500 ${I}px 'Montserrat', sans-serif`;for(const Dt of We)x.fillText(Dt,p/2,oe),oe+=L}oe+=A,x.fillStyle=K,x.font=`bold ${Le}px 'Montserrat', sans-serif`;for(const Dt of P)x.fillText(Dt,p/2,oe),oe+=ht;return oe+=$,x.fillStyle=O,x.font=`600 ${pe}px 'Montserrat', sans-serif`,x.fillText("Make It Count with Core Buddy",p/2,oe),new Promise(Dt=>{y.toBlob(Nt=>Dt(Nt),"image/png")})}function C2(n,e,t,i,l,u){n.beginPath(),n.moveTo(e+u,t),n.lineTo(e+i-u,t),n.quadraticCurveTo(e+i,t,e+i,t+u),n.lineTo(e+i,t+l-u),n.quadraticCurveTo(e+i,t+l,e+i-u,t+l),n.lineTo(e+u,t+l),n.quadraticCurveTo(e,t+l,e,t+l-u),n.lineTo(e,t+u),n.quadraticCurveTo(e,t,e+u,t),n.closePath()}function DD(n){return new Promise((e,t)=>{const i=new Image;i.crossOrigin="anonymous",i.onload=()=>e(i),i.onerror=t,i.src=n})}function ou(n,e,t){if(n.measureText(e).width<=t)return[e];const i=e.split(" "),l=[];let u="";for(const d of i){const p=u?`${u} ${d}`:d;n.measureText(p).width>t&&u?(l.push(u),u=d):u=p}return u&&l.push(u),l}function PD(){const n=b.useRef(null),e=b.useCallback(()=>{if(!n.current)try{n.current=new(window.AudioContext||window.webkitAudioContext)}catch{}const u=n.current;return u?.state==="suspended"&&u.resume(),u},[]),t=b.useCallback(()=>{navigator.vibrate&&navigator.vibrate([40,60,30]);const u=e();if(!u)return;const d=u.currentTime,p=u.createBiquadFilter();p.type="lowpass",p.frequency.value=500,p.Q.value=.7,p.connect(u.destination);const g=u.createOscillator(),y=u.createGain();g.type="sine",g.frequency.value=50,y.gain.value=.3,y.gain.setTargetAtTime(0,d+.08,.04),g.connect(y).connect(p),g.start(d),g.stop(d+.2);const x=u.createOscillator(),_=u.createGain();x.type="sine",x.frequency.value=70,_.gain.value=.2,_.gain.setTargetAtTime(0,d+.22,.04),x.connect(_).connect(p),x.start(d+.15),x.stop(d+.35)},[e]),i=b.useCallback(()=>{navigator.vibrate&&navigator.vibrate(30);const u=e();if(!u)return;const d=u.currentTime,p=u.createBiquadFilter();p.type="lowpass",p.frequency.value=500,p.Q.value=.7,p.connect(u.destination);const g=u.createOscillator(),y=u.createGain();g.type="sine",g.frequency.value=55,y.gain.value=.35,y.gain.setTargetAtTime(0,d+.08,.04),g.connect(y).connect(p),g.start(d),g.stop(d+.2)},[e]),l=b.useCallback(()=>{navigator.vibrate&&navigator.vibrate([50,80,100]);const u=e();u&&[0,.12].forEach((d,p)=>{const g=u.createOscillator(),y=u.createGain();g.type="sine",g.frequency.value=p===0?523:784,y.gain.value=.12,y.gain.setTargetAtTime(0,u.currentTime+d+.15,.02),g.connect(y).connect(u.destination),g.start(u.currentTime+d),g.stop(u.currentTime+d+.2)})},[e]);return b.useEffect(()=>()=>{n.current?.close()},[]),{tap:i,tick:t,complete:l}}const LD=2e3,Lg=42,Fl=2*Math.PI*Lg,OD=1200,R2=["Another one in the bank!","Consistency beats everything.","You showed up  that's what counts.","Stronger every session."];function em({title:n,subtitle:e,stats:t,onDone:i,onDismissStart:l,onShareJourney:u,userName:d,buttonLabel:p="Done",holdLabel:g="Hold To Complete Session",shareType:y="workout",hideShare:x=!1}){const[_,j]=b.useState("hold"),[O,K]=b.useState(!1),[B,D]=b.useState(0),[te,Y]=b.useState(!1),[Z,ke]=b.useState(!1),[Re,_e]=b.useState(null),C=PD(),T=b.useRef(null),M=b.useRef(null),V=b.useRef(null),I=b.useRef(null),L=b.useRef(!1),A=b.useRef(!1),Le=b.useRef(0),ht=b.useRef(R2[Math.floor(Math.random()*R2.length)]),$=b.useRef([...Array(80)].map((Ve,Me)=>({x:5+Math.random()*90,delay:Math.random()*3.5,color:["#A12F3A","#ffffff","#000000"][Me%3],drift:(Math.random()-.5)*120,spin:Math.random()*720-360,duration:1.8+Math.random()*2,width:4+Math.random()*6,height:4+Math.random()*8,shape:Me%3}))),pe=b.useCallback(()=>{if(L.current)return;L.current=!0,A.current=!1,Le.current=0,K(!0),D(0),I.current=performance.now(),C.tap(),T.current&&(T.current.style.strokeDashoffset=Fl);const Ve=Me=>{const mt=Me-I.current,wt=Math.min(mt/LD,1);if(T.current&&(T.current.style.strokeDashoffset=Fl-wt*Fl),M.current){const ot=8*(1-wt),es=1-wt,Ns=1+wt*.15;M.current.style.filter=`blur(${ot}px) grayscale(${es})`,M.current.style.transform=`scale(${Ns})`}D(wt),mt-Le.current>=OD&&(Le.current=mt,C.tick()),wt<1?V.current=requestAnimationFrame(Ve):(L.current=!1,A.current=!0,V.current=null,K(!1),D(1),C.complete(),j("celebrate"))};V.current=requestAnimationFrame(Ve)},[C]),Be=b.useCallback(()=>{L.current&&(L.current=!1,V.current&&(cancelAnimationFrame(V.current),V.current=null),T.current&&(T.current.style.strokeDashoffset=Fl),M.current&&(M.current.style.filter="",M.current.style.transform=""),K(!1),D(0))},[]),We=b.useCallback(()=>{Y(!0),l?.(),setTimeout(()=>{i?.()},300)},[i,l]),J=b.useCallback(()=>{const Ve=[n||"Workout Complete!"];return e&&Ve.push(e),t?.length&&Ve.push(t.map(Me=>`${Me.value} ${Me.label}`).join(" | ")),Ve.push("#MindCoreFitness"),Ve.join(`
`)},[n,e,t]),P=b.useCallback(async()=>{if(!(Z||!u))try{await u({type:y==="habits"?"habits_summary":"workout_summary",title:n||"Workout Complete!",subtitle:e,stats:t||[],quote:ht.current}),ke(!0),_e("Posted to Journey!"),setTimeout(()=>_e(null),2500)}catch(Ve){console.error("Journey post failed:",Ve),_e(Ve?.message||"Failed to post"),setTimeout(()=>_e(null),3500)}},[Z,u,n,e,t]),[re,Fe]=b.useState(!1),qe=b.useCallback(async()=>{Fe(!0);try{const Ve=await nb({type:y||"workout",title:n||"Workout Complete!",subtitle:e,stats:t||[],quote:ht.current,userName:d}),Me=J();if(navigator.share&&navigator.canShare?.({files:[new File([Ve],"workout.png",{type:"image/png"})]})){const mt=new File([Ve],"workout.png",{type:"image/png"});await navigator.share({title:"Mind Core Fitness",text:Me,files:[mt]})}else navigator.share?await navigator.share({title:"Mind Core Fitness",text:Me}):(await navigator.clipboard.writeText(Me),_e("Copied to clipboard!"),setTimeout(()=>_e(null),2500))}catch{try{await navigator.clipboard.writeText(J()),_e("Copied to clipboard!"),setTimeout(()=>_e(null),2500)}catch{}}finally{Fe(!1)}},[n,e,t,d,J]);return _==="hold"?r.jsxs("div",{className:"wc-hold-page",children:[r.jsx("div",{className:"wc-hold-glow","aria-hidden":"true"}),r.jsx("p",{className:"wc-hold-label",children:g}),r.jsxs("div",{className:`wc-hold-ring-touch ${O?"wc-holding":""}`,onPointerDown:Ve=>{Ve.preventDefault(),pe()},onPointerUp:Be,onPointerLeave:Be,onPointerCancel:Be,onClick:Ve=>{Ve.stopPropagation(),A.current&&(A.current=!1)},role:"button",tabIndex:0,"aria-label":"Press and hold to finish workout",onKeyDown:Ve=>{(Ve.key==="Enter"||Ve.key===" ")&&(Ve.preventDefault(),C.complete(),j("celebrate"))},children:[r.jsx("div",{className:"wc-hold-ring-glow","aria-hidden":"true"}),r.jsxs("svg",{className:"wc-hold-ring-svg",viewBox:"0 0 100 100",children:[r.jsx("circle",{className:"wc-hold-ring-track",cx:"50",cy:"50",r:Lg}),r.jsx("circle",{className:"wc-hold-ring-fill",ref:T,cx:"50",cy:"50",r:Lg,style:{strokeDasharray:Fl,strokeDashoffset:Fl}})]}),r.jsx("img",{ref:M,src:"/Logo.webp",alt:"Mind Core Fitness",className:"wc-hold-logo",draggable:!1})]})]}):r.jsxs("div",{className:`wc-celeb-overlay ${te?"wc-celeb-dismissing":""}`,children:[r.jsx("div",{className:"wc-celeb-confetti","aria-hidden":"true",children:$.current.map((Ve,Me)=>r.jsx("span",{className:`wc-celeb-confetti-piece wc-confetti-shape-${Ve.shape}`,style:{"--x":`${Ve.x}%`,"--delay":`${Ve.delay}s`,"--color":Ve.color,"--drift":`${Ve.drift}px`,"--spin":`${Ve.spin}deg`,"--duration":`${Ve.duration}s`,width:`${Ve.width}px`,height:`${Ve.height}px`}},Me))}),r.jsxs("div",{className:"wc-celeb-content",children:[r.jsx("div",{className:"wc-celeb-logo-frame",children:r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"wc-celeb-logo-img"})}),r.jsx("h2",{className:"wc-celeb-heading",children:n||"Congratulations!"}),e&&r.jsx("p",{className:"wc-celeb-subtext",children:e}),r.jsx("p",{className:"wc-celeb-quote",children:ht.current}),t&&t.length>0&&r.jsx("div",{className:"wc-celeb-stats-row",children:t.map((Ve,Me)=>r.jsxs("div",{className:"wc-celeb-stat",children:[r.jsx("span",{className:"wc-celeb-stat-val",children:Ve.value}),r.jsx("span",{className:"wc-celeb-stat-label",children:Ve.label})]},Me))}),!x&&r.jsxs("div",{className:"wc-share-row",children:[u&&r.jsxs("button",{className:`wc-share-btn wc-share-journey ${Z?"wc-share-done":""}`,onClick:P,disabled:Z,children:[r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M12 20h9"}),r.jsx("path",{d:"M16.5 3.5a2.121 2.121 0 1 1 3 3L7 19l-4 1 1-4Z"})]}),Z?"Posted!":"Post to Journey"]}),r.jsxs("button",{className:"wc-share-btn wc-share-external",onClick:qe,disabled:re,children:[r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("circle",{cx:"18",cy:"5",r:"3"}),r.jsx("circle",{cx:"6",cy:"12",r:"3"}),r.jsx("circle",{cx:"18",cy:"19",r:"3"}),r.jsx("line",{x1:"8.59",y1:"13.51",x2:"15.42",y2:"17.49"}),r.jsx("line",{x1:"15.41",y1:"6.51",x2:"8.59",y2:"10.49"})]}),re?"Generating...":"Share"]})]}),r.jsx("button",{className:"wc-celeb-btn",onClick:We,children:p}),Re&&r.jsx("div",{className:"wc-share-toast",children:Re})]})]})}const A2="/login/assets/randomiser-glq9YJkL.jpg",M2="/login/assets/programme-card-workout-CnNzTYkz.webp",BD="/login/assets/prog-fullbody-4wk-r6m9HJys.jpg",VD="/login/assets/muscle-group-arms-C9AdZL4-.png",UD="/login/assets/arms-bicep-BUrmT1o-.png",FD="/login/assets/arms-tricep-D9tAnFnS.png",zD="/login/assets/arms-full-arms-BY3TvpJm.png",qD="/login/assets/muscle-group-chest-Cxfuc7XI.png",HD="/login/assets/chest-strength-BR4BAFTH.png",$D="/login/assets/chest-hypertrophy-B8yNrvjB.png",WD="/login/assets/chest-endurance-e-OSWtWO.png",GD="/login/assets/muscle-group-shoulders-DibNtCLF.png",KD="/login/assets/shoulders-strength-CKlZBF5A.png",YD="/login/assets/shoulders-hypertrophy-BUd76jiS.png",QD="/login/assets/shoulders-endurance-HuqNG5rD.png",XD="/login/assets/muscle-group-core-CPR-bdRg.png",JD="/login/assets/core-lower-abs-TVcqGMFJ.png",ZD="/login/assets/core-obliques-rotation-Djb7Qlbk.png",e6="/login/assets/core-weighted-core-4Kwh9mTv.png",t6="/login/assets/muscle-group-back-8JPV-YUo.png",s6="/login/assets/back-strength-BmSRxnwo.png",n6="/login/assets/back-hypertrophy-CXHmsnCz.png",r6="/login/assets/back-endurance-C8qJ8l5I.png",a6="/login/assets/muscle-group-legs-B8jcbdov.png",i6="/login/assets/legs-quads-DbnfsebI.png",o6="/login/assets/legs-hamstrings-glutes-BrfsvvzX.png",l6="/login/assets/legs-power-plyo-D2qBXeUR.png",c6=60,Yp=5,u6=[{threshold:1e3,label:"1 Tonne"},{threshold:5e3,label:"5 Tonne"},{threshold:1e4,label:"10 Tonne"},{threshold:25e3,label:"25 Tonne"},{threshold:5e4,label:"50 Tonne"},{threshold:1e5,label:"100 Tonne"},{threshold:25e4,label:"250 Tonne"},{threshold:5e5,label:"500 Tonne"},{threshold:1e6,label:"1 Million kg"}],d6={"Dumbbell Floor Press":"push","Seated Dumbbell Shoulder Press":"push","Seated Dumbbell Arnold Press":"push","Dumbbell Overhead Tricep Extension":"push",Skullcrushers:"push","Dumbbell Lateral Raise":"push","Dumbbell Front Raise":"push","Dumbbell Squeeze Press":"push","Incline Dumbbell Press":"push","Dumbbell Fly":"push","Dumbbell Pullover":"push","Tricep Kickback":"push","Dumbbell Shrug":"push","Dumbbell Y-Raise":"push","Dumbbell Bent Over Row":"pull","Single Arm Bent Over Row":"pull","Bicep Curl":"pull","Hammer Curl":"pull","Dumbbell Bent Over Rear Delt Fly":"pull","Renegade Row":"pull","Wide Dumbbell Bent Over Row":"pull","Reverse Fly":"pull","Concentration Curl":"pull","Wide Grip Bicep Curl":"pull","Wrist Curl":"pull","Dumbbell Goblet Squats":"lower","Romanian Deadlifts":"lower","Forward Dumbbell Lunges":"lower","Dumbbell Sumo Squats":"lower","Weighted Calf Raises":"lower","1 Legged RDL":"lower","Dumbbell Box Step Ups":"lower","Dumbbell Squat Pulses":"lower","Dumbbell Reverse Lunges":"lower","Kettlebell Romanian Deadlift":"lower","Russian Twists Dumbbell":"core","Kettlebell Russian Twist":"core","Kettlebell Side Bends":"core","Kneeling Kettlebell Halo":"core","Kettlebell Bird Dog Drag":"core"},h6={fullbody_4wk:{duration:4,daysPerWeek:3},fullbody_8wk:{duration:8,daysPerWeek:3},fullbody_12wk:{duration:12,daysPerWeek:3},core_4wk:{duration:4,daysPerWeek:3},core_8wk:{duration:8,daysPerWeek:3},core_12wk:{duration:12,daysPerWeek:3},upper_4wk:{duration:4,daysPerWeek:3},lower_4wk:{duration:4,daysPerWeek:3}},m6={fullbody:"linear-gradient(160deg, rgba(153,49,60,0.15) 0%, rgba(153,49,60,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)",core:"linear-gradient(160deg, rgba(30,80,120,0.2) 0%, rgba(30,80,120,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)",upper:"linear-gradient(160deg, rgba(100,60,140,0.2) 0%, rgba(100,60,140,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)",lower:"linear-gradient(160deg, rgba(40,120,80,0.2) 0%, rgba(40,120,80,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)"},Qp={arms:"linear-gradient(160deg, rgba(180,60,60,0.2) 0%, rgba(180,60,60,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",chest:"linear-gradient(160deg, rgba(50,100,160,0.2) 0%, rgba(50,100,160,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",back:"linear-gradient(160deg, rgba(80,130,60,0.2) 0%, rgba(80,130,60,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",shoulders:"linear-gradient(160deg, rgba(160,100,40,0.2) 0%, rgba(160,100,40,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",legs:"linear-gradient(160deg, rgba(100,50,140,0.2) 0%, rgba(100,50,140,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",core:"linear-gradient(160deg, rgba(30,80,120,0.2) 0%, rgba(30,80,120,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)"},Xp=[{id:"fullbody_4wk",name:"4-Week Full Body",focus:"fullbody",duration:4,level:"All Levels",daysPerWeek:3,image:BD},{id:"fullbody_8wk",name:"8-Week Full Body",focus:"fullbody",duration:8,level:"Intermediate",daysPerWeek:3},{id:"fullbody_12wk",name:"12-Week Full Body",focus:"fullbody",duration:12,level:"Advanced",daysPerWeek:3},{id:"core_4wk",name:"4-Week Core",focus:"core",duration:4,level:"Beginner",daysPerWeek:3},{id:"core_8wk",name:"8-Week Core",focus:"core",duration:8,level:"Intermediate",daysPerWeek:3},{id:"core_12wk",name:"12-Week Core",focus:"core",duration:12,level:"Advanced",daysPerWeek:3},{id:"upper_4wk",name:"4-Week Upper Body",focus:"upper",duration:4,level:"Intermediate",daysPerWeek:3},{id:"lower_4wk",name:"4-Week Lower Body",focus:"lower",duration:4,level:"Intermediate",daysPerWeek:3}],lu=[{key:"arms",label:"Arms",icon:"M7 5h2v14H7V5zm8 0h2v14h-2V5zm-5 4h4v6h-4V9z",image:VD},{key:"chest",label:"Chest",icon:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 15H9v-2h2v2zm4 0h-2v-2h2v2zm3-6c0 1.1-.36 2.12-.97 2.95l-.87-.87C16.7 12.53 17 11.8 17 11c0-2.76-2.24-5-5-5S7 8.24 7 11c0 .8.3 1.53.84 2.08l-.87.87A4.977 4.977 0 0 1 6 11c0-3.31 2.69-6 6-6s6 2.69 6 6z",image:qD},{key:"back",label:"Back",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm4 18H8v-6l-4-4 1.41-1.41L8 11.17V8h8v3.17l2.59-2.58L20 10l-4 4v6z",image:t6},{key:"shoulders",label:"Shoulders",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm8 10l-3-1.5c-.5-.25-1-.5-1.5-.5h-7c-.5 0-1 .25-1.5.5L4 12l-2 6h4l1.5 4h9L18 18h4l-2-6z",image:GD},{key:"legs",label:"Legs",icon:"M16.5 3A2.5 2.5 0 0 0 14 5.5 2.5 2.5 0 0 0 16.5 8 2.5 2.5 0 0 0 19 5.5 2.5 2.5 0 0 0 16.5 3zM14 9l-3 7h2l1 6h2l1-6h2l-3-7h-2z",image:a6},{key:"core",label:"Core",icon:"M12 2a4 4 0 0 1 4 4v1h-2V6a2 2 0 1 0-4 0v1H8V6a4 4 0 0 1 4-4zM8 9h8v2H8V9zm-1 4h10l-1 9H8l-1-9z",image:XD}],I2={chest:[{id:"chest_strength",name:"Chest Strength",desc:"Heavy pressing for max strength",image:HD,level:"Intermediate",overview:"A heavy pressing session designed to build raw chest strength. Focus on controlled negatives and powerful pressing movements.",tips:["Go heavy  pick a weight where the last 2 reps are a real challenge","Control the negative (lowering phase) for 2-3 seconds","Keep your shoulder blades squeezed together throughout all pressing movements","Rest 90-120 seconds between sets to allow full recovery"],exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:4,reps:8,storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Dumbbell Squeeze Press",type:"weighted",sets:3,reps:10,storagePath:null},{name:"Incline Dumbbell Press",type:"weighted",sets:3,reps:10,storagePath:null},{name:"Dumbbell Pullover",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Dumbbell Fly",type:"weighted",sets:3,reps:12,storagePath:null}]},{id:"chest_hypertrophy",name:"Chest Hypertrophy",desc:"Volume training for muscle growth",image:$D,level:"Intermediate",overview:"A high-volume chest session focused on time under tension and muscle growth. Lighter weights, more reps, and slow controlled movements.",tips:["Use moderate weight  you should feel the burn by rep 10","Squeeze your chest at the top of every rep for 1 second","Keep rest periods short at 60-90 seconds to keep the pump going","On press ups, go to failure on the final set"],exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Wide Press Up",type:"reps",sets:3,reps:15,storagePath:null},{name:"Dumbbell Fly",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Incline Dumbbell Press",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Press Up",type:"reps",sets:3,reps:20,storagePath:"exercises/bodyweight/upper/press up.mp4"}]},{id:"chest_endurance",name:"Chest Endurance",desc:"Bodyweight pushing to failure",image:WD,level:"All Levels",overview:"No weights needed. This bodyweight-only session builds chest endurance and muscular stamina through high-rep push up variations.",tips:["Focus on full range of motion  chest to floor on every rep","Keep your core tight and body in a straight line throughout","Scale down to knee press ups if you can't maintain form","Push through the burn  the last 5 reps are where the growth happens"],exercises:[{name:"Press Up",type:"reps",sets:4,reps:20,storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Wide Press Up",type:"reps",sets:3,reps:15,storagePath:null},{name:"Diamond Press Up",type:"reps",sets:3,reps:12,storagePath:null},{name:"Decline Press Up",type:"reps",sets:3,reps:15,storagePath:null},{name:"Press Up Hold",type:"timed",sets:3,time:30,storagePath:null}]}],back:[{id:"back_strength",name:"Back Strength",desc:"Heavy rows for a thick back",image:s6,level:"Intermediate",overview:"Build a thick, powerful back with heavy rowing movements. This session targets your lats, rhomboids, and traps for overall back development.",tips:["Go heavy on rows  use a weight that challenges you by rep 6-8","Drive your elbows back and squeeze your shoulder blades together at the top","Keep a slight bend in your knees and hinge at the hips for bent over movements","Rest 90-120 seconds between sets for full recovery"],exercises:[{name:"Dumbbell Bent Over Row",type:"weighted",sets:4,reps:8,storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Single Arm Bent Over Row",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Dumbbell Pullover",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Dumbbell Shrug",type:"weighted",sets:3,reps:15,storagePath:null}]},{id:"back_hypertrophy",name:"Back Hypertrophy",desc:"Width and thickness volume work",image:n6,level:"Intermediate",overview:"A volume-focused back session combining rows and isolation moves to build width and thickness. Focus on the mind-muscle connection.",tips:["Use moderate weight  feel the stretch and squeeze on every rep","On renegade rows, keep your hips square to the floor and avoid rotating","For reverse flys, use lighter weight and focus on squeezing your rear delts","Keep rest to 60-90 seconds to maintain intensity"],exercises:[{name:"Renegade Row",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/upper/renegade row.mp4"},{name:"Wide Dumbbell Bent Over Row",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Single Arm Bent Over Row",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Reverse Fly",type:"weighted",sets:3,reps:15,storagePath:null},{name:"Prone Y-T-W Raises",type:"reps",sets:3,reps:10,storagePath:null}]},{id:"back_endurance",name:"Back Endurance",desc:"Bodyweight back conditioning",image:r6,level:"All Levels",overview:"A bodyweight session to strengthen your posterior chain and improve posture. Great for back health, mobility, and muscular endurance.",tips:["On superman holds, lift your arms and legs simultaneously and hold tight","Focus on slow, controlled movements  quality over speed","Breathe steadily throughout timed holds  don't hold your breath","Engage your glutes and lower back together on every movement"],exercises:[{name:"Superman Hold",type:"timed",sets:4,time:30,storagePath:"exercises/bodyweight/upper/Superman Hold.mp4"},{name:"Prone Y-T-W Raises",type:"reps",sets:3,reps:12,storagePath:null},{name:"Reverse Snow Angel",type:"reps",sets:3,reps:12,storagePath:null},{name:"Bird Dog",type:"reps",sets:3,reps:12,storagePath:"exercises/bodyweight/core/Bird Dog.mp4"},{name:"Back Extension Hold",type:"timed",sets:3,time:30,storagePath:null}]}],shoulders:[{id:"shoulders_strength",name:"Shoulder Strength",desc:"Heavy pressing for boulder shoulders",image:KD,level:"Intermediate",overview:"A heavy overhead pressing session to build strong, powerful shoulders. Compound movements first, followed by isolation work for all three delt heads.",tips:["Go heavy on presses  pick a weight where you struggle on the last 2 reps","Brace your core and avoid arching your back during overhead movements","Press straight up and control the weight down slowly","Rest 90-120 seconds between pressing sets, 60 seconds for isolation moves"],exercises:[{name:"Seated Dumbbell Shoulder Press",type:"weighted",sets:4,reps:8,storagePath:"exercises/dumbbells/upper/seated dumbbell shoulder press.mp4"},{name:"Seated Dumbbell Arnold Press",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/upper/seated dumbbell arnold press.mp4"},{name:"Dumbbell Front Raise",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell front raise.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Dumbbell Shrug",type:"weighted",sets:3,reps:15,storagePath:null}]},{id:"shoulders_hypertrophy",name:"Shoulder Hypertrophy",desc:"Volume and isolation for 3D delts",image:YD,level:"Intermediate",overview:"A high-volume session targeting all three heads of the deltoid for that 3D capped shoulder look. Moderate weight, high reps, constant tension.",tips:["Use lighter weight than you think  shoulders respond best to high reps","On lateral raises, lead with your elbows and don't swing the weight","Pause at the top of each raise for a 1-second squeeze","Keep rest periods at 60 seconds to maximise the pump"],exercises:[{name:"Seated Dumbbell Arnold Press",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/seated dumbbell arnold press.mp4"},{name:"Dumbbell Lateral Raise",type:"weighted",sets:4,reps:15,storagePath:"exercises/dumbbells/upper/dumbbell lateral raise.mp4"},{name:"Dumbbell Front Raise",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell front raise.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,reps:15,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Dumbbell Y-Raise",type:"weighted",sets:3,reps:12,storagePath:null}]},{id:"shoulders_endurance",name:"Shoulder Endurance",desc:"Bodyweight and high-rep work",image:QD,level:"All Levels",overview:"A shoulder endurance session combining bodyweight movements with high-rep dumbbell work. Builds stamina, stability, and shoulder resilience.",tips:["On pike push ups, walk your feet close to your hands to increase the angle","For high-rep lateral raises, use a very light weight and focus on form","Wall walks are advanced  scale to pike push ups if needed","Keep your core braced throughout to protect your lower back"],exercises:[{name:"Pike Push Ups",type:"reps",sets:4,reps:12,storagePath:"exercises/bodyweight/upper/pike push ups.mp4"},{name:"Dumbbell Lateral Raise",type:"weighted",sets:3,reps:20,storagePath:"exercises/dumbbells/upper/dumbbell lateral raise.mp4"},{name:"Wall Walks",type:"reps",sets:3,reps:6,storagePath:null},{name:"Prone Y-T-W Raises",type:"reps",sets:3,reps:10,storagePath:null},{name:"Shoulder Tap Hold",type:"timed",sets:3,time:30,storagePath:null}]}],arms:[{id:"arms_bicep",name:"Bicep Focus",desc:"Curl variations for peak biceps",image:UD,level:"All Levels",overview:"An arm session dedicated entirely to biceps. Multiple curl variations target different parts of the bicep for maximum peak and thickness.",tips:["Keep your elbows pinned to your sides  no swinging","Control the negative (lowering) for 2-3 seconds on every rep","Start with your heaviest weight and decrease as you fatigue","Squeeze hard at the top of each curl for a full contraction"],exercises:[{name:"Bicep Curl",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Hammer Curl",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/hammer curl.mp4"},{name:"Concentration Curl",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Wide Grip Bicep Curl",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Isometric Bicep Hold",type:"timed",sets:3,time:20,storagePath:null}]},{id:"arms_tricep",name:"Tricep Focus",desc:"Extensions and dips for horseshoe triceps",image:FD,level:"All Levels",overview:"All-out tricep training with extensions, dips, and pressing movements. The triceps make up two-thirds of your arm  this session builds serious size.",tips:["On overhead extensions, keep your elbows close to your head","For skullcrushers, lower the weight slowly to just above your forehead","On dips, lean slightly forward to reduce shoulder strain","Full lockout at the top of every extension for maximum tricep contraction"],exercises:[{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Skullcrushers",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/skullcrushers.mp4"},{name:"Tricep Dips",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/upper/tricep dips.mp4"},{name:"Tricep Kickback",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Diamond Press Up",type:"reps",sets:3,reps:12,storagePath:null}]},{id:"arms_full",name:"Full Arms",desc:"Superset biceps and triceps",image:zD,level:"All Levels",overview:"A balanced arm session alternating between biceps and triceps. Superset style keeps the intensity high and maximises the pump.",tips:["Superset each pair  do biceps then immediately hit triceps","Use moderate weight that lets you maintain strict form for all reps","Rest 60 seconds after each superset pair","Focus on the squeeze at the peak contraction of every rep"],exercises:[{name:"Bicep Curl",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Tricep Kickback",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Hammer Curl",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/hammer curl.mp4"},{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Wrist Curl",type:"weighted",sets:3,reps:15,storagePath:null}]}],legs:[{id:"legs_quad",name:"Quad Dominant",desc:"Squats and lunges for quad power",image:i6,level:"All Levels",overview:"A quad-focused leg session built around squats and lunges. Heavy compound movements to build strong, powerful quads and overall leg strength.",tips:["On goblet squats, hold the dumbbell close to your chest and sit deep","Keep your knees tracking over your toes  don't let them cave inward","Drive through your heels on all squatting movements","Rest 90-120 seconds between heavy sets, 60 seconds on bodyweight moves"],exercises:[{name:"Dumbbell Goblet Squats",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Forward Dumbbell Lunges",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.mp4"},{name:"Dumbbell Squat Pulses",type:"weighted",sets:3,reps:15,storagePath:"exercises/dumbbells/lower/dumbbell squat pulses.mp4"},{name:"Bulgarian Split Squats",type:"reps",sets:3,reps:12,storagePath:"exercises/bodyweight/lower/bulgarian split squats.mp4"},{name:"Squat And Hold",type:"timed",sets:3,time:30,storagePath:"exercises/bodyweight/lower/squat and hold.mp4"}]},{id:"legs_ham_glute",name:"Hamstring & Glute",desc:"Posterior chain focus",image:o6,level:"Intermediate",overview:"Target the back of your legs with deadlift and hip hinge variations. This session builds a strong posterior chain  hamstrings, glutes, and lower back.",tips:["On RDLs, push your hips back and feel the stretch in your hamstrings","Keep a slight bend in your knees throughout hip hinge movements","Squeeze your glutes hard at the top of every rep","For single leg work, start with your weaker side first"],exercises:[{name:"Romanian Deadlifts",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/lower/romanian deadlifts.mp4"},{name:"1 Legged RDL",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/lower/1 legged rdl.mp4"},{name:"Hip Thrusts",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/lower/hip thrusts.mp4"},{name:"Dumbbell Sumo Squats",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/dumbbell sumo squats.mp4"},{name:"Donkey Kicks",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/lower/donkey kicks.mp4"}]},{id:"legs_power",name:"Power & Plyo",desc:"Explosive leg training",image:l6,level:"Intermediate",overview:"An explosive leg session combining plyometrics with weighted movements. Build power, speed, and athletic performance.",tips:["On jump squats, land softly with bent knees to absorb the impact","Explode up on every rep  power comes from speed, not just weight","Keep rest periods at 60-90 seconds to maintain intensity","Focus on landing mechanics  knees out, chest up, soft landing"],exercises:[{name:"Jump Squats",type:"reps",sets:4,reps:12,storagePath:"exercises/bodyweight/lower/jump squats.mp4"},{name:"Dumbbell Box Step Ups",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/dumbbell box step ups.mp4"},{name:"Skater Jumps",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/lower/skater jumps.mp4"},{name:"Dumbbell Reverse Lunges",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/dumbbell reverse lunges.mp4"},{name:"Weighted Calf Raises",type:"weighted",sets:4,reps:15,storagePath:"exercises/dumbbells/lower/weighted calf raises.mp4"}]}],core:[{id:"core_lower_abs",name:"Lower Abs Blast",desc:"40s work / 20s rest  3 rounds",image:JD,level:"Intermediate",overview:"An interval-based core burner targeting the lower abdominals. 40 seconds of work followed by 20 seconds of rest  keep the intensity high and your lower back pressed into the floor throughout.",tips:["Press your lower back firmly into the floor on every rep","Exhale hard as you contract your abs  don't hold your breath","If your lower back lifts off the ground, reduce the range of motion","Focus on slow, controlled movements rather than speed"],interval:!0,rounds:3,work:40,rest:20,exercises:[{name:"Leg Raises",storagePath:"exercises/bodyweight/core/Leg Raises.mp4"},{name:"Reverse Crunch To Leg Raise",storagePath:"exercises/bodyweight/core/Reverse Crunch To Leg Raise.mp4"},{name:"Flutter Kicks",storagePath:"exercises/bodyweight/core/Flutter Kicks.mp4"},{name:"Dead Bug Single Leg Drop",storagePath:"exercises/bodyweight/core/Dead Bug Single Leg Drop.mp4"},{name:"Hollow Body Hold",storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"},{name:"Hollow Hold Flutter Kicks",storagePath:"exercises/bodyweight/core/Hollow Hold Flutter Kicks.mp4"}]},{id:"core_obliques",name:"Obliques & Rotation",desc:"35s work / 25s rest  3 rounds",image:ZD,level:"Intermediate",overview:"Target the obliques and rotational core muscles with this interval session. 35 seconds of work with 25 seconds rest  every exercise involves twisting, rotating, or side-bracing movements.",tips:["Rotate from your ribcage, not just your arms","Keep your hips as still as possible during twisting exercises","Brace your core before each movement  think about squeezing a belt","On side planks, stack your hips and push the floor away"],interval:!0,rounds:3,work:35,rest:25,exercises:[{name:"Russian Twist",storagePath:"exercises/bodyweight/core/Russian Twist.mp4"},{name:"Side Plank Rotation",storagePath:"exercises/bodyweight/core/Side Plank Rotation.mp4"},{name:"Cross Body Mountain Climbers",storagePath:"exercises/bodyweight/core/Cross Body Mountain Climbers.mp4"},{name:"Hip Dips Plank",storagePath:"exercises/bodyweight/core/Hip Dips Plank.mp4"},{name:"Bicycle Crunch",storagePath:"exercises/bodyweight/core/Bicycle Crunch.mp4"},{name:"Side Plank",storagePath:"exercises/bodyweight/core/Side Plank.mp4"}]},{id:"core_weighted",name:"Weighted Core",desc:"40s work / 20s rest  3 rounds",image:e6,level:"Advanced",overview:"Add resistance to your core training with dumbbells and kettlebells. 40 seconds of weighted work followed by 20 seconds rest  this session builds serious core strength and stability.",tips:["Start with a moderate weight  form is more important than load","Brace your entire core before picking up the weight each round","Keep movements controlled  no swinging or using momentum","If grip fails before core does, go slightly lighter next time"],interval:!0,rounds:3,work:40,rest:20,exercises:[{name:"Russian Twists Dumbbell",storagePath:"exercises/dumbbells/core/russian twists dumbbell.mp4"},{name:"Kettlebell Russian Twist",storagePath:"exercises/kettlebells/core/kettlebell russian twist.mp4"},{name:"Kettlebell Side Bends",storagePath:"exercises/kettlebells/core/kettlebell side bends.mp4"},{name:"Kneeling Kettlebell Halo",storagePath:"exercises/kettlebells/core/kneeling kettlebell halo.mp4"},{name:"Kettlebell Bird Dog Drag",storagePath:"exercises/kettlebells/core/kettlebell bird dog drag.mp4"},{name:"Dumbbell Plank Pull Through",storagePath:null}]}]},Jp=[{key:"bodyweight",label:"Bodyweight",icon:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 3c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm0 14.2c-2.5 0-4.71-1.28-6-3.22.03-1.99 4-3.08 6-3.08 1.99 0 5.97 1.09 6 3.08-1.29 1.94-3.5 3.22-6 3.22z"},{key:"dumbbells",label:"Dumbbells",icon:"M1 9h2v6H1V9zm3-2h2v10H4V7zm3 4h10v2H7v-2zm10-4h2v10h-2V7zm3 2h2v6h-2V9z"},{key:"kettlebells",label:"Kettlebells",icon:"M12 2C9.24 2 7 4.24 7 7c0 1.1.36 2.12.97 2.95C6.76 11.08 6 12.96 6 15c0 3.87 2.69 7 6 7s6-3.13 6-7c0-2.04-.76-3.92-1.97-5.05.61-.83.97-1.85.97-2.95 0-2.76-2.24-5-5-5zm0 2c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3z"}],ia=[{key:"core",label:"Core",icon:"M12 2a4 4 0 0 1 4 4v1h-2V6a2 2 0 1 0-4 0v1H8V6a4 4 0 0 1 4-4zM8 9h8v2H8V9zm-1 4h10l-1 9H8l-1-9z"},{key:"upper",label:"Upper",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm8 10l-3-1.5c-.5-.25-1-.5-1.5-.5h-7c-.5 0-1 .25-1.5.5L4 12l-2 6h4l1.5 4h9L18 18h4l-2-6z"},{key:"lower",label:"Lower",icon:"M16.5 3A2.5 2.5 0 0 0 14 5.5 2.5 2.5 0 0 0 16.5 8 2.5 2.5 0 0 0 19 5.5 2.5 2.5 0 0 0 16.5 3zM14 9l-3 7h2l1 6h2l1-6h2l-3-7h-2z"},{key:"fullbody",label:"Full Body",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm-2 8h4l1 4h2l-1 4h-2l-1 4h-2l-1-4H8l-1-4h2l1-4z"},{key:"mix",label:"Mix It Up",icon:"M10.59 9.17L5.41 4 4 5.41l5.17 5.17 1.42-1.41zM14.5 4l2.04 2.04L4 18.59 5.41 20 17.96 7.46 20 9.5V4h-5.5zm-.83 9.41l-1.42 1.42L17.96 20.54l1.42-1.42-5.71-5.71z"}],Ba=[{key:"beginner",label:"Beginner",work:30,rest:30,desc:"30s work / 30s rest"},{key:"intermediate",label:"Intermediate",work:40,rest:20,desc:"40s work / 20s rest"},{key:"advanced",label:"Advanced",work:40,rest:15,desc:"40s work / 15s rest"}],Zp=[5,10,15,20,30],mh={core:"#e85d04",upper:"#2196f3",lower:"#4caf50",fullbody:"#9c27b0",mix:"#ff9800"},D2=["Mix up your focus areas to build balanced strength.","Consistency beats intensity  show up and press play.","Try a new difficulty level to keep your body guessing.","Short on time? A 5-minute blast still counts.","Save your favourite combos so you can replay them anytime.","Your body adapts  switch equipment for fresh stimulus.","Rest days are growth days. Listen to your body.","Challenge yourself: go one level higher this week."];function f6(n){return n.replace(/\b\w/g,e=>e.toUpperCase())}function p6(n){const e=[...n];for(let t=e.length-1;t>0;t--){const i=Math.floor(Math.random()*(t+1));[e[t],e[i]]=[e[i],e[t]]}return e}function g6(){const{currentUser:n,isClient:e,clientData:t,loading:i}=Ir(),{isDark:l,toggleTheme:u,accent:d}=Ca(),{isPremium:p,FREE_RANDOMISER_DURATIONS:g,FREE_RANDOMISER_WEEKLY_LIMIT:y}=yc(),x=tr(),[_,j]=b.useState("menu"),[O,K]=b.useState(["bodyweight"]),[B,D]=b.useState("core"),[te,Y]=b.useState("intermediate"),[Z,ke]=b.useState(p?15:5),[Re,_e]=b.useState([]),[C,T]=b.useState(!1),M=b.useRef(!1),V=b.useRef([]),[I,L]=b.useState([]),[A,Le]=b.useState(2),[ht,$]=b.useState(Ba[1]),[pe,Be]=b.useState(1),[We,J]=b.useState(0),[P,re]=b.useState("work"),[Fe,qe]=b.useState(0),[Ve,Me]=b.useState(!1),[mt,wt]=b.useState(0),[ot,es]=b.useState(!1),[Ns,Ft]=b.useState(!1),[Tt,oe]=b.useState(null),Dt=b.useRef(null);b.useRef(null),b.useRef(null);const[Nt,Kt]=b.useState(null),Et=b.useCallback((q,ue="info")=>{Kt({message:q,type:ue}),setTimeout(()=>Kt(null),3e3)},[]),Ct=b.useCallback(async q=>{if(!t)throw new Error("Not signed in");const ue=q&&typeof q=="object"&&q.type;await Gr(Ht(ge,"posts"),{authorId:t.id,authorName:t.name||"Unknown",authorPhotoURL:t.photoURL||null,content:ue?"":q,type:ue?q.type:"text",imageURL:null,createdAt:yr(),likeCount:0,commentCount:0,...ue?{metadata:{title:q.title||"",subtitle:q.subtitle||"",stats:q.stats||[],quote:q.quote||"",badges:q.badges||[]}}:{}})},[t]),[lt,Ot]=b.useState(null),[Wt,ms]=b.useState(null),[Gt,Pt]=b.useState(0),[us,xs]=b.useState(0),[is,Qs]=b.useState([]),[Ms,Fs]=b.useState(""),[os,ws]=b.useState(""),[be,Ie]=b.useState(!1),[De,rt]=b.useState(0),[Ke,at]=b.useState(!1),[gt,X]=b.useState({}),se=b.useRef(null),Qe=b.useRef(null),[_t,et]=b.useState([]),[kt,Q]=b.useState(null),[Ae,Je]=b.useState(0),[yt,it]=b.useState(0),[Jt,Yt]=b.useState(0),[F,ye]=b.useState(0),[Ee,Te]=b.useState(0),[Se,bt]=b.useState(0),[At,ft]=b.useState({beginner:0,intermediate:0,advanced:0}),zt=p?Zp:Zp.filter(q=>g.includes(q)),Bt=!p&&Ae>=y,[Ps,hn]=b.useState([]),[tn,En]=b.useState(!1),[zs,sn]=b.useState({}),[hs,G]=b.useState(!1),[me,ae]=b.useState(!1),[xe,E]=b.useState(""),[z,ie]=b.useState(null),[ne,Ze]=b.useState([]),[nt,ct]=b.useState({total:0,favouriteFocus:null,streak:0}),[Lt,xt]=b.useState(null),[fs,nn]=b.useState(""),[Dr,ps]=b.useState(!1);b.useEffect(()=>{!i&&(!n||!e)&&x("/")},[n,e,i,x]),b.useEffect(()=>{if(!n||!t)return;(async()=>{try{const ue=Ht(ge,"workoutLogs"),de=As(ue,gs("clientId","==",t.id)),Ce=(await Ts(de)).docs.map(ut=>ut.data()),st=Ce.filter(ut=>ut.type!=="programme");ye(st.length);const vt=st.reduce((ut,St)=>ut+(St.duration||0),0);Te(vt);const qt={beginner:0,intermediate:0,advanced:0};st.forEach(ut=>{ut.level&&qt[ut.level]!==void 0&&qt[ut.level]++}),ft(qt);const ss=new Date,S=ss.getDay(),U=S===0?-6:1-S,je=new Date(ss);je.setDate(ss.getDate()+U),je.setHours(0,0,0,0);const Ye=je.getTime(),He=Ce.filter(ut=>{const St=ut.completedAt;return St?(St.toDate?St.toDate().getTime():new Date(St).getTime())>=Ye:!1});Je(He.filter(ut=>ut.type!=="programme").length);let tt=0;if(t)try{const ut=await Is(Xe(ge,"clientProgrammes",t.id));if(ut.exists()){const St=ut.data(),ns=St.templateId;tt=He.filter(rn=>rn.type==="programme"&&rn.programmeId===ns).length,xt(ns);const Zt=Xp.find(rn=>rn.id===ns);Zt&&nn(Zt.name);const ys=h6[ns];if(ys){const rn=Object.keys(St.completedSessions||{}).length,ln=ys.duration*ys.daysPerWeek;Yt(ln>0?Math.round(rn/ln*100):0)}}else xt(null),nn(""),Yt(0)}catch{}it(tt);const Ge=st.map(ut=>ut.completedAt).filter(Boolean).map(ut=>ut.toDate?ut.toDate().getTime():new Date(ut).getTime()).sort((ut,St)=>St-ut);if(Ge.length===0)bt(0);else{const ut=new Set;Ge.forEach(ln=>{const Bs=new Date(ln),Zs=Bs.getDay(),_n=Zs===0?-6:1-Zs,pn=new Date(Bs);pn.setDate(Bs.getDate()+_n),pn.setHours(0,0,0,0),ut.add(pn.getTime())});const St=[...ut].sort((ln,Bs)=>Bs-ln);let ns=0;const Zt=new Date(ss),ys=ss.getDay()===0?-6:1-ss.getDay();Zt.setDate(ss.getDate()+ys),Zt.setHours(0,0,0,0);let rn=Zt.getTime();St.includes(rn)||(rn-=10080*60*1e3);for(let ln=0;ln<200&&St.includes(rn);ln++)ns++,rn-=10080*60*1e3;bt(ns)}}catch(ue){console.error("Error loading workout stats:",ue)}finally{ps(!0)}})()},[n,t,_]),b.useEffect(()=>{if(!n||!t)return;(async()=>{try{const ue=As(Ht(ge,"savedWorkouts"),gs("clientId","==",t.id),oc("savedAt","desc")),de=await Ts(ue);hn(de.docs.map(Ue=>({id:Ue.id,...Ue.data()})))}catch(ue){console.error("Error loading saved workouts:",ue)}finally{En(!0)}})()},[n,t]),b.useEffect(()=>{if(!n||!t)return;(async()=>{try{const ue=As(Ht(ge,"workoutLogs"),gs("clientId","==",t.id),oc("completedAt","desc"),Pu(20)),Ce=(await Ts(ue)).docs.map(He=>He.data()).filter(He=>He.type!=="programme"&&He.type!=="muscle_group");Ze(Ce.slice(0,3));const st=Ce.length,vt={};Ce.forEach(He=>{He.focus&&(vt[He.focus]=(vt[He.focus]||0)+1)});const qt=Object.keys(vt).sort((He,tt)=>vt[tt]-vt[He])[0]||null;let ss=0;if(Ce.length>0){const He=new Set;Ce.forEach(ut=>{const St=ut.completedAt?.toDate?ut.completedAt.toDate():ut.completedAt?new Date(ut.completedAt):null;St&&He.add(new Date(St.getFullYear(),St.getMonth(),St.getDate()).toDateString())});const tt=new Date;tt.setHours(0,0,0,0);let Ge=new Date(tt);for(He.has(Ge.toDateString())||Ge.setDate(Ge.getDate()-1);He.has(Ge.toDateString());)ss++,Ge.setDate(Ge.getDate()-1)}ct({total:st,favouriteFocus:qt,streak:ss});const S={core:null,upper:null,lower:null,fullbody:null};Ce.forEach(He=>{if(He.focus&&S[He.focus]===null&&He.completedAt){const tt=He.completedAt.toDate?He.completedAt.toDate():new Date(He.completedAt);S[He.focus]=tt}});let U=null,je=new Date;const Ye=["core","upper","lower","fullbody"];for(const He of Ye){if(S[He]===null){const tt=ia.find(Ge=>Ge.key===He)?.label||He;U={focus:He,label:tt,daysAgo:null,message:`You haven't tried ${tt} yet`};break}if(S[He]<je){je=S[He];const tt=Math.floor((Date.now()-S[He].getTime())/864e5);if(tt>=5){const Ge=ia.find(ut=>ut.key===He)?.label||He;U={focus:He,label:Ge,daysAgo:tt,message:`${Ge}  ${tt} days ago`}}}}ie(U)}catch(ue){console.error("Error loading recent workouts:",ue)}})()},[n,t,_]);const ur=async q=>{if(!(!n||!t||I.length===0)){G(!0);try{const ue=ia.find(Ce=>Ce.key===B)?.label||B,de=q||`${ue} ${Z}min`,Ue=await Gr(Ht(ge,"savedWorkouts"),{clientId:t.id,name:de,equipment:O,focus:B,level:te,duration:Z,exercises:I.map(Ce=>({name:Ce.name,videoUrl:Ce.videoUrl,isGif:Ce.isGif||!1})),rounds:A,savedAt:Mt.now()});hn(Ce=>[{id:Ue.id,clientId:t.id,name:de,equipment:O,focus:B,level:te,duration:Z,exercises:I.map(st=>({name:st.name,videoUrl:st.videoUrl,isGif:st.isGif||!1})),rounds:A,savedAt:Mt.now()},...Ce]),Et("Workout saved!","success")}catch(ue){console.error("Error saving workout:",ue),Et("Failed to save workout","error")}finally{G(!1),ae(!1),E("")}}},dr=async q=>{try{await lr(Xe(ge,"savedWorkouts",q)),hn(ue=>ue.filter(de=>de.id!==q)),Et("Workout removed","info")}catch(ue){console.error("Error deleting saved workout:",ue),Et("Failed to remove workout","error")}},ua=q=>{K(q.equipment||["bodyweight"]),D(q.focus||"core"),Y(q.level||"intermediate"),ke(q.duration||15);const ue=Ba.find(de=>de.key===(q.level||"intermediate"));$(ue),L(q.exercises||[]),Le(q.rounds||2),j("preview")},Nn=async()=>{const q=JSON.parse(localStorage.getItem("mcf_last_randomiser")||"null");q&&(K(q.equipment||["bodyweight"]),D(q.focus||"core"),Y(q.level||"intermediate"),ke(q.duration||15)),setTimeout(()=>hr(),50)},Ra=()=>{localStorage.setItem("mcf_last_randomiser",JSON.stringify({equipment:O,focus:B,level:te,duration:Z}))};localStorage.getItem("mcf_last_randomiser");const Ri=()=>{const q=[];let ue;B==="mix"?ue=["core","upper","lower"]:B==="fullbody"?ue=["upper","lower"]:ue=[B];for(const de of O)for(const Ue of ue)q.push(`exercises/${de}/${Ue}`);return q},Yr=async()=>{if(M.current){for(;M.current;)await new Promise(q=>setTimeout(q,200));return V.current}M.current=!0,T(!0);try{const q=Ri(),ue=[];for(const st of q)try{const vt=yi(bi,st),qt=await T2(vt);ue.push(...qt.items)}catch{console.warn(`Folder ${st} not found, skipping.`)}if(ue.length===0&&O.includes("bodyweight")&&B==="core")try{const st=yi(bi,"core"),vt=await T2(st);ue.push(...vt.items)}catch{console.warn("Legacy core/ folder not found either.")}if(ue.length===0){const st=O.map(qt=>Jp.find(ss=>ss.key===qt)?.label).join(" + "),vt=ia.find(qt=>qt.key===B)?.label;return Et(`No exercises found for ${st} / ${vt}. Upload videos to Firebase Storage.`,"error"),M.current=!1,T(!1),[]}const de=new Set,Ue=ue.filter(st=>{const vt=st.name.replace(/\.(mp4|gif)$/i,"");return de.has(vt)?!1:(de.add(vt),!0)}),Ce=await Promise.all(Ue.map(async st=>{const vt=await fo(st),qt=f6(st.name.replace(/\.(mp4|gif)$/i,"")),ss=/\.gif$/i.test(st.name);return{name:qt,videoUrl:vt,isGif:ss}}));return V.current=Ce,_e(Ce),M.current=!1,T(!1),Ce}catch(q){console.error("Error loading exercises:",q);const ue=q.code==="storage/unauthorized"?"Storage access denied. Check Firebase Storage rules allow read access.":`Failed to load exercises: ${q.message||q.code||"Unknown error"}`;return Et(ue,"error"),M.current=!1,T(!1),[]}},hr=async()=>{if(Bt)return;Ra(),j("spinning"),V.current=[];const q=await Yr();if(q.length===0){j("setup");return}const ue=Ba.find(S=>S.key===te);$(ue);const de=ue.work+ue.rest,Ue=Z*60,Ce=Math.floor(Ue/de);let st,vt;Ce<=6?(st=Math.max(3,Math.floor(Ce/2)),vt=Math.floor(Ce/st)):Ce<=12?(st=Math.min(6,Math.floor(Ce/2)),vt=Math.floor(Ce/st)):(st=Math.min(10,Math.floor(Ce/2)),vt=Math.floor(Ce/st)),vt=Math.max(2,vt);const qt=p6(q),ss=qt.slice(0,Math.min(st,qt.length));L(ss),Le(vt),setTimeout(()=>j("preview"),2e3)},Xa=()=>{j("countdown"),wt(3)};b.useEffect(()=>{if(_!=="countdown")return;if(mt<=0){j("workout"),Be(1),J(0),re("work"),qe(ht.work),Me(!1),Or();return}fn();const q=setTimeout(()=>wt(ue=>ue-1),1e3);return()=>clearTimeout(q)},[mt,_]),b.useEffect(()=>{if(_!=="workout"||Ve)return;if(Fe<=0){Pr();return}Fe<=3&&fn();const q=setTimeout(()=>qe(ue=>ue-1),1e3);return()=>clearTimeout(q)},[Fe,_,Ve]);const Pr=()=>{if(P==="work")re("rest"),qe(ht.rest);else{const q=We+1;if(q>=I.length){const ue=pe+1;if(ue>A){es(!0),Un();return}Be(ue),J(0)}else J(q);re("work"),qe(ht.work),Or()}},Un=async()=>{if(n)try{await Gr(Ht(ge,"workoutLogs"),{clientId:t.id,level:te,duration:Z,equipment:O,focus:B,exerciseCount:I.length,rounds:A,exercises:I.map(q=>q.name),completedAt:Mt.now()}),Je(q=>q+1),ye(q=>q+1),Te(q=>q+Z),ft(q=>({...q,[te]:(q[te]||0)+1}))}catch(q){console.error("Error saving workout log:",q)}},Ai=async(q,ue,de)=>{if(!(!t||!ue))try{const Ue=t.id,Ce=await Is(Xe(ge,"coreBuddyPBs",Ue)),vt=(Ce.exists()?Ce.data():null)?.exercises||{},qt=vt[q];let ss=!1;if(qt?(ue>(qt.weight||0)||ue===(qt.weight||0)&&de>(qt.reps||0))&&(ss=!0):ss=!0,ss){const S={...vt,[q]:{weight:ue,reps:de,achievedAt:Mt.now()}};await Ds(Xe(ge,"coreBuddyPBs",Ue),{clientId:t.id,exercises:S,updatedAt:Mt.now()}),Et(`New PB! ${ue}kg  ${de} reps`,"success"),fn(),await Ja(q,ue)}}catch(Ue){console.error("Error checking PB:",Ue)}},Ja=async(q,ue)=>{if(t)try{const de=await Is(Xe(ge,"coreBuddyTargets",t.id));if(!de.exists())return;const Ce=(de.data().targets||{})[q];if(!Ce||ue<Ce.targetWeight)return;const st=await Is(Xe(ge,"coreBuddyAchievements",t.id)),vt=st.exists()?st.data():{clientId:t.id,badges:[],totalVolume:0};if(vt.badges.some(U=>U.type==="pb_target"&&U.exercise===q&&U.targetWeight===Ce.targetWeight))return;const ss={type:"pb_target",exercise:q,group:d6[q]||"push",targetWeight:Ce.targetWeight,achievedAt:Mt.now()},S=[...vt.badges,ss];await Ds(Xe(ge,"coreBuddyAchievements",t.id),{...vt,badges:S,updatedAt:Mt.now()}),et(U=>[...U,ss])}catch(de){console.error("Error checking target badge:",de)}},_r=async q=>{if(!(!t||q<=0))try{const ue=await Is(Xe(ge,"coreBuddyAchievements",t.id)),de=ue.exists()?ue.data():{clientId:t.id,badges:[],totalVolume:0},Ue=de.totalVolume||0,Ce=Ue+q,st=[];u6.forEach(qt=>{Ce>=qt.threshold&&Ue<qt.threshold&&(de.badges.some(S=>S.type==="volume_milestone"&&S.milestone===qt.threshold)||st.push({type:"volume_milestone",milestone:qt.threshold,label:qt.label,achievedAt:Mt.now()}))});const vt=[...de.badges,...st];await Ds(Xe(ge,"coreBuddyAchievements",t.id),{clientId:t.id,badges:vt,totalVolume:Math.round(Ce),updatedAt:Mt.now()}),st.length>0&&et(qt=>[...qt,...st])}catch(ue){console.error("Error updating volume:",ue)}},Aa=async q=>{if(ms(q),q.interval){const Ue=[];for(const Ce of q.exercises){let st=null,vt=!1;if(Ce.storagePath)try{const qt=yi(bi,Ce.storagePath);st=await fo(qt),vt=/\.gif$/i.test(Ce.storagePath)}catch{}Ue.push({name:Ce.name,videoUrl:st,isGif:vt})}L(Ue),Le(q.rounds),$({work:q.work,rest:q.rest}),j("preview");return}const ue={};for(const Ue of q.exercises)if(Ue.storagePath)try{const Ce=yi(bi,Ue.storagePath);ue[Ue.name]={url:await fo(Ce),isGif:/\.gif$/i.test(Ue.storagePath)}}catch{}X(ue);const de=q.exercises.map(Ue=>({name:Ue.name,type:Ue.type,targetSets:Ue.sets,targetReps:Ue.reps||0,targetTime:Ue.time||0,sets:[]}));Qs(de),Pt(0),xs(0),Fs(""),ws(""),at(!1),Ie(!1),rt(0),et([]),Q(null),j("muscle_workout")},Mi=()=>{const q=se.current;q&&(q.paused?(q.play(),at(!0)):(q.pause(),at(!1)))};b.useEffect(()=>{if(_!=="muscle_workout"||!be||De<=0){_==="muscle_workout"&&be&&De<=0&&(Ie(!1),fn());return}return Qe.current=setTimeout(()=>rt(q=>q-1),1e3),()=>clearTimeout(Qe.current)},[_,be,De]);const Qr=async()=>{const q=is[Gt];let ue={};if(q.type==="weighted"){const Ce=parseFloat(Ms)||0,st=parseInt(os)||0;if(st===0){Et("Enter your reps","error");return}ue={weight:Ce,reps:st}}else if(q.type==="reps"){const Ce=parseInt(os)||0;if(Ce===0){Et("Enter your reps","error");return}ue={reps:Ce}}else if(q.type==="timed"){const Ce=q.targetTime-De;ue={time:Math.max(Ce,1)}}const de=[...is];de[Gt]={...q,sets:[...q.sets,ue]},Qs(de),q.type==="weighted"&&ue.weight>0&&await Ai(q.name,ue.weight,ue.reps);const Ue=q.sets.length+1;if(Ue<q.targetSets)xs(Ue),ws(""),Ie(!1),rt(0);else if(Gt+1<is.length){const Ce=Gt+1;Pt(Ce),xs(0),Fs(""),ws(""),at(!1),Ie(!1),rt(0)}else await Lr(de),Ft(!0)},Lr=async q=>{if(!(!n||!t))try{const ue=q.reduce((Ue,Ce)=>Ue+Ce.sets.reduce((st,vt)=>st+(vt.weight||0)*(vt.reps||0),0),0),de=q.reduce((Ue,Ce)=>Ue+Ce.sets.length,0);await Gr(Ht(ge,"workoutLogs"),{clientId:t.id,type:"muscle_group",muscleGroup:lt,sessionId:Wt?.id,sessionName:Wt?.name,exerciseCount:q.length,totalSets:de,duration:Math.round(de*1.5),volume:Math.round(ue),exercises:q.map(Ue=>({name:Ue.name,type:Ue.type,sets:Ue.sets})),completedAt:Mt.now()}),ue>0&&await _r(ue),_t.length>0&&Q({badges:[..._t]})}catch(ue){console.error("Error saving muscle group workout log:",ue)}},Fn=b.useRef(null),zn=()=>(Fn.current||(Fn.current=new(window.AudioContext||window.webkitAudioContext)),Fn.current),fn=()=>{try{const q=zn(),ue=q.createOscillator(),de=q.createGain();ue.connect(de),de.connect(q.destination),ue.frequency.value=880,de.gain.value=.3,ue.start(q.currentTime),ue.stop(q.currentTime+.15)}catch{}},Or=()=>{try{const q=zn(),ue=q.createOscillator(),de=q.createGain();ue.connect(de),de.connect(q.destination),ue.frequency.value=1200,de.gain.value=.4,ue.start(q.currentTime),ue.stop(q.currentTime+.3)}catch{}};b.useEffect(()=>{if(_!=="workout"||P!=="work"||!I[We]?.isGif)return;const ue=setInterval(()=>{const de=Dt.current;if(!de)return;const Ue=de.getAttribute("src");de.removeAttribute("src"),setTimeout(()=>{Dt.current&&Dt.current.setAttribute("src",Ue)},0)},4e3);return()=>clearInterval(ue)},[_,P,We,pe,I]);const mr=(q,ue,de)=>{const Ue=Math.round(q/ue*c6);return r.jsx("svg",{className:"wk-ring-svg",viewBox:"0 0 200 200",children:cD.map((Ce,st)=>r.jsx("line",{x1:Ce.x1,y1:Ce.y1,x2:Ce.x2,y2:Ce.y2,className:st<Ue?`wk-tick-filled ${de}`:"wk-tick-empty",strokeWidth:Ce.thick?"3":"2"},st))})},da=()=>{const q=I.length*A;return((pe-1)*I.length+We+(P==="rest"?.5:0))/q},sr=Nt&&r.jsx("div",{className:`toast-notification ${Nt.type}`,children:Nt.message});if(i)return r.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>x("/client/core-buddy"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})]})}),r.jsx("div",{className:"wk-loading-inline",children:r.jsx("div",{className:"wk-loading-spinner"})})]});if(_==="menu")return r.jsx(Sa,{children:r.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>x("/client/core-buddy"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),r.jsxs("main",{className:"wk-main",children:[r.jsxs("div",{className:"wk-menu-heading",children:[r.jsx("h2",{children:"Choose Your Workout"}),r.jsx("p",{children:"No excuses. Just results."})]}),r.jsx("button",{className:"wk-hero-card",onClick:()=>j("randomiser_hub"),children:r.jsx("img",{src:A2,alt:"Randomise Workout",className:"wk-hero-bg"})}),!p&&r.jsxs("button",{className:"wk-hero-card wk-free-card-premium",onClick:()=>x("/upgrade"),children:[r.jsx("img",{src:M2,alt:"Programmes",className:"wk-hero-bg"}),r.jsx("div",{className:"wk-free-card-overlay"}),r.jsxs("div",{className:"wk-free-card-content",children:[r.jsxs("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),r.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}),r.jsx("span",{className:"wk-free-card-label",children:"Unlock Full Access"})]})]}),p&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"wk-section-header",children:[r.jsx("h2",{children:"Programmes"}),r.jsxs("span",{className:"wk-section-count",children:[Xp.length," available"]})]}),r.jsx("div",{className:"wk-prog-scroll-wrap",children:r.jsx("div",{className:"wk-prog-scroll",children:Xp.map((q,ue)=>q.image?r.jsxs("button",{className:"wk-prog-img-card",onClick:()=>x("/client/core-buddy/programmes",{state:{templateId:q.id}}),style:{animationDelay:`${ue*.06}s`},children:[r.jsx("img",{src:q.image,alt:q.name,className:"wk-prog-img"}),ue===0&&r.jsx("div",{className:"wk-swipe-arrow",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})})]},q.id):r.jsxs("button",{className:"wk-prog-hero-card",onClick:()=>x("/client/core-buddy/programmes",{state:{templateId:q.id}}),style:{animationDelay:`${ue*.06}s`},children:[r.jsx("img",{src:M2,alt:"Programme",className:"wk-prog-hero-bg",loading:"lazy"}),r.jsx("div",{className:"wk-prog-hero-overlay",style:{background:m6[q.focus]}}),r.jsxs("div",{className:"wk-prog-hero-content",children:[r.jsxs("div",{className:"wk-prog-hero-top",children:[r.jsxs("span",{className:"wk-prog-hero-badge",children:[q.duration," WEEKS"]}),r.jsx("span",{className:"wk-prog-hero-level",children:q.level})]}),r.jsxs("div",{className:"wk-prog-hero-bottom",children:[r.jsx("h3",{children:q.name.toUpperCase()}),r.jsxs("p",{children:[q.daysPerWeek,"x per week  ",q.focus==="fullbody"?"Full Body":q.focus.charAt(0).toUpperCase()+q.focus.slice(1)," Focus"]}),r.jsx("span",{className:"wk-prog-hero-go",children:"VIEW PROGRAMME "})]})]}),ue===0&&r.jsx("div",{className:"wk-swipe-arrow",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})})]},q.id))})})]}),p&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"wk-section-header",children:[r.jsx("h2",{children:"Muscle Groups"}),r.jsxs("span",{className:"wk-section-count",children:[lu.length," groups"]})]}),r.jsx("div",{className:"wk-muscle-grid",children:lu.map((q,ue)=>r.jsx("button",{className:`wk-muscle-hero-card${q.image?" wk-muscle-thumb":""}`,onClick:()=>{Ot(q.key),j("muscle_sessions")},style:{animationDelay:`${ue*.05}s`},children:q.image?r.jsx("img",{src:q.image,alt:q.label,className:"wk-muscle-thumb-img"}):r.jsxs(r.Fragment,{children:[r.jsx("img",{src:A2,alt:"Muscle group",className:"wk-muscle-hero-bg",loading:"lazy"}),r.jsx("div",{className:"wk-muscle-hero-overlay",style:{background:Qp[q.key]}}),r.jsxs("div",{className:"wk-muscle-hero-content",children:[r.jsx("div",{className:"wk-muscle-hero-icon",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:q.icon})})}),r.jsxs("div",{className:"wk-muscle-hero-text",children:[r.jsx("span",{className:"wk-muscle-hero-name",children:q.label}),r.jsxs("span",{className:"wk-muscle-hero-count",children:[I2[q.key]?.length||0," sessions"]})]})]})]})},q.key))})]})]}),r.jsx(Ta,{active:"workouts"}),sr]})});if(_==="randomiser_hub"){const q=JSON.parse(localStorage.getItem("mcf_last_randomiser")||"null"),ue=q?ia.find(Ue=>Ue.key===q.focus)?.label||q.focus:null,de=q?Ba.find(Ue=>Ue.key===q.level)?.label||q.level:null;return r.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>j("menu"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),r.jsxs("main",{className:"wk-main",children:[r.jsxs("div",{className:"wk-hub-heading",children:[r.jsx("div",{className:"wk-hub-icon-wrap",children:r.jsxs("svg",{className:"wk-hub-dice-icon",width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"3"}),r.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.2",fill:"currentColor",stroke:"none"}),r.jsx("circle",{cx:"15.5",cy:"8.5",r:"1.2",fill:"currentColor",stroke:"none"}),r.jsx("circle",{cx:"12",cy:"12",r:"1.2",fill:"currentColor",stroke:"none"}),r.jsx("circle",{cx:"8.5",cy:"15.5",r:"1.2",fill:"currentColor",stroke:"none"}),r.jsx("circle",{cx:"15.5",cy:"15.5",r:"1.2",fill:"currentColor",stroke:"none"})]})}),r.jsx("h2",{children:"Randomiser"}),r.jsx("p",{children:"Generate, save & replay workouts"})]}),nt.total>0&&r.jsxs("div",{className:"wk-hub-stats",children:[r.jsxs("div",{className:"wk-hub-stat",children:[r.jsx("span",{className:"wk-hub-stat-value",children:nt.total}),r.jsx("span",{className:"wk-hub-stat-label",children:"Workouts"})]}),nt.streak>0&&r.jsxs("div",{className:"wk-hub-stat",children:[r.jsxs("span",{className:"wk-hub-stat-value",children:[nt.streak,r.jsx("small",{children:"d"})]}),r.jsx("span",{className:"wk-hub-stat-label",children:"Streak"})]}),nt.favouriteFocus&&r.jsxs("div",{className:"wk-hub-stat",children:[r.jsx("span",{className:"wk-hub-stat-value wk-hub-stat-focus",style:{color:mh[nt.favouriteFocus]||"var(--color-primary)"},children:ia.find(Ue=>Ue.key===nt.favouriteFocus)?.label||nt.favouriteFocus}),r.jsx("span",{className:"wk-hub-stat-label",children:"Top Focus"})]})]}),r.jsxs("div",{className:"wk-hub-tip",children:[r.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 1 1 7.072 0l-.548.547A3.374 3.374 0 0 0 14 18.469V19a2 2 0 1 1-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),D2[Math.floor(Date.now()/864e5)%D2.length]]}),r.jsxs("div",{className:"wk-hub-actions",children:[r.jsxs("button",{className:"wk-hub-action-btn wk-hub-new wk-hub-new-glow",onClick:()=>j("setup"),children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),r.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),"New Workout"]}),q&&r.jsxs("button",{className:"wk-hub-action-btn wk-hub-quick",onClick:Nn,disabled:Bt,children:[r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2"})}),"Quick Start",r.jsxs("span",{className:"wk-hub-quick-meta",children:[ue,"  ",de,"  ",q.duration,"min"]})]})]}),z&&r.jsxs("div",{className:"wk-hub-section",children:[r.jsxs("h3",{className:"wk-hub-section-title",children:[r.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 1 1 7.072 0l-.548.547A3.374 3.374 0 0 0 14 18.469V19a2 2 0 1 1-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),"Suggested For You"]}),r.jsxs("button",{className:"wk-hub-suggestion",onClick:()=>{D(z.focus),j("setup")},children:[r.jsxs("div",{className:"wk-hub-suggestion-info",children:[r.jsx("span",{className:"wk-hub-suggestion-label",children:z.message}),r.jsx("span",{className:"wk-hub-suggestion-cta",children:"Tap to set up "})]}),r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})]})]}),r.jsxs("div",{className:"wk-hub-section",children:[r.jsxs("h3",{className:"wk-hub-section-title",children:[r.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"})}),"Saved Workouts",Ps.length>0&&r.jsx("span",{className:"wk-hub-count",children:Ps.length})]}),tn?Ps.length===0?r.jsxs("div",{className:"wk-hub-empty wk-hub-empty-enhanced",children:[r.jsx("svg",{className:"wk-hub-empty-icon",width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"})}),r.jsx("p",{children:r.jsx("strong",{children:"No saved workouts yet"})}),r.jsx("p",{className:"wk-hub-empty-sub",children:"Generate a workout and hit save to stash it here for quick replay."})]}):r.jsx("div",{className:"wk-hub-saved-categories",children:ia.map(Ue=>{const Ce=Ps.filter(vt=>vt.focus===Ue.key);if(Ce.length===0)return null;const st=zs[Ue.key]||!1;return r.jsxs("div",{className:"wk-hub-saved-cat",children:[r.jsxs("button",{className:`wk-hub-saved-cat-header${st?" wk-hub-saved-cat-open":""}`,style:{"--cat-color":mh[Ue.key]||"var(--color-primary)"},onClick:()=>sn(vt=>({...vt,[Ue.key]:!vt[Ue.key]})),children:[r.jsxs("span",{className:"wk-hub-saved-cat-label",children:[r.jsx("span",{className:"wk-hub-focus-pill",style:{"--pill-color":mh[Ue.key]||"var(--color-primary)"},children:Ue.label}),r.jsx("span",{className:"wk-hub-saved-cat-count",children:Ce.length})]}),r.jsx("svg",{className:`wk-hub-saved-cat-chevron${st?" wk-hub-saved-cat-chevron-open":""}`,width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("polyline",{points:"6 9 12 15 18 9"})})]}),st&&r.jsx("div",{className:"wk-hub-saved-list",children:Ce.map((vt,qt)=>{const ss=(vt.equipment||[]).map(U=>Jp.find(je=>je.key===U)?.label||U).join(", "),S=Ba.find(U=>U.key===vt.level)?.label||vt.level;return r.jsxs("div",{className:"wk-hub-saved-card",style:{animationDelay:`${qt*.05}s`},children:[r.jsxs("button",{className:"wk-hub-saved-main",onClick:()=>ua(vt),children:[r.jsxs("div",{className:"wk-hub-saved-info",children:[r.jsx("span",{className:"wk-hub-saved-name",children:vt.name}),r.jsx("span",{className:"wk-hub-saved-tags",children:r.jsxs("span",{className:"wk-hub-saved-meta",children:[S,"  ",vt.duration,"min  ",(vt.exercises||[]).length," ex"]})}),ss&&r.jsx("span",{className:"wk-hub-saved-equip",children:ss})]}),r.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})})]}),r.jsx("button",{className:"wk-hub-saved-delete",onClick:()=>dr(vt.id),"aria-label":"Remove saved workout",children:r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("polyline",{points:"3 6 5 6 21 6"}),r.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]},vt.id)})})]},Ue.key)})}):r.jsx("div",{className:"wk-hub-empty",children:r.jsx("div",{className:"wk-loading-spinner"})})]}),ne.length>0&&r.jsxs("div",{className:"wk-hub-section",children:[r.jsxs("h3",{className:"wk-hub-section-title",children:[r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("polyline",{points:"12 6 12 12 16 14"})]}),"Recent"]}),r.jsx("div",{className:"wk-hub-recent-list",children:ne.map((Ue,Ce)=>{const st=ia.find(S=>S.key===Ue.focus)?.label||Ue.focus||"",vt=Ba.find(S=>S.key===Ue.level)?.label||Ue.level||"",qt=Ue.completedAt?.toDate?Ue.completedAt.toDate():Ue.completedAt?new Date(Ue.completedAt):null,ss=qt?(()=>{const S=Math.floor((Date.now()-qt.getTime())/1e3);return S<3600?`${Math.floor(S/60)}m ago`:S<86400?`${Math.floor(S/3600)}h ago`:`${Math.floor(S/86400)}d ago`})():"";return r.jsxs("div",{className:"wk-hub-recent-card",style:{animationDelay:`${Ce*.05}s`},children:[r.jsx("div",{className:"wk-hub-recent-info",children:r.jsxs("span",{className:"wk-hub-recent-tags",children:[r.jsx("span",{className:"wk-hub-focus-pill",style:{"--pill-color":mh[Ue.focus]||"var(--color-primary)"},children:st}),r.jsxs("span",{className:"wk-hub-recent-meta",children:[vt,"  ",Ue.duration||"?","min  ",Ue.exerciseCount||"?"," ex"]})]})}),r.jsx("span",{className:"wk-hub-recent-time",children:ss})]},Ce)})})]})]}),sr]})}if(_==="setup"){const q=ia.find(de=>de.key===B)?.label||B,ue=Ba.find(de=>de.key===te)?.label||te;return r.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>j("randomiser_hub"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),r.jsxs("main",{className:"wk-main wk-setup-main",children:[r.jsx("div",{className:"wk-stats-row",children:[{label:"Total",value:`${F}`,pct:F>0?Math.min(Math.round(F/100*100),100):0,color:"#14b8a6",size:"normal"},{label:"This Week",value:`${Ae}/${Yp}`,pct:Math.round(Math.min(Ae,Yp)/Yp*100),color:"var(--color-primary)",size:"large"},{label:"Wk Streak",value:`${Se}`,pct:Se>0?Math.min(Math.round(Se/12*100),100):0,color:"#38B6FF",size:"normal"}].map(de=>{const Ce=2*Math.PI*38,st=Ce-de.pct/100*Ce;return r.jsxs("div",{className:`wk-stat-item${de.size==="large"?" wk-stat-large":""}`,children:[r.jsxs("div",{className:"wk-stat-ring",children:[r.jsxs("svg",{viewBox:"0 0 100 100",children:[r.jsx("circle",{className:"wk-stat-track",cx:"50",cy:"50",r:38}),r.jsx("circle",{className:"wk-stat-fill",cx:"50",cy:"50",r:38,style:{stroke:de.color},strokeDasharray:Ce,strokeDashoffset:st})]}),r.jsx("span",{className:"wk-stat-value",style:{color:de.color},children:de.value})]}),r.jsx("span",{className:"wk-stat-label",children:de.label})]},de.label)})}),r.jsxs("div",{className:"wk-setup-flow",children:[r.jsxs("div",{className:"wk-setup-section",children:[r.jsx("h2",{children:"Focus Area"}),r.jsx("div",{className:"wk-focus-grid",children:ia.map(de=>r.jsxs("button",{className:`wk-equip-btn${B===de.key?" active":""}${de.key==="mix"?" wk-mix-btn":""}`,onClick:()=>D(de.key),children:[r.jsx("svg",{className:"wk-equip-icon",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:de.icon})}),r.jsx("span",{children:de.label})]},de.key))})]}),r.jsxs("div",{className:"wk-setup-section",children:[r.jsx("h2",{children:"Level"}),r.jsx("div",{className:"wk-level-cards",children:Ba.map(de=>r.jsxs("button",{className:`wk-level-card wk-level-${de.key}${te===de.key?" active":""}`,onClick:()=>Y(de.key),children:[r.jsx("span",{className:"wk-level-name",children:de.label}),r.jsx("span",{className:"wk-level-desc",children:de.desc})]},de.key))})]}),r.jsxs("div",{className:"wk-setup-section",children:[r.jsx("h2",{children:"Time"}),r.jsx("div",{className:"wk-time-options",children:Zp.map(de=>{const Ue=!zt.includes(de);return r.jsxs("button",{className:`wk-time-btn${Z===de?" active":""}${Ue?" locked":""}`,onClick:()=>!Ue&&ke(de),disabled:Ue,children:[r.jsx("span",{className:"wk-time-num",children:de}),r.jsx("span",{className:"wk-time-unit",children:Ue?r.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),r.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}):"min"})]},de)})})]}),r.jsxs("div",{className:"wk-setup-section",children:[r.jsx("h2",{children:"Equipment"}),r.jsx("div",{className:"wk-equip-options",children:Jp.map(de=>{const Ue=O.includes(de.key);return r.jsxs("button",{className:`wk-equip-btn${Ue?" active":""}`,onClick:()=>{K(Ce=>Ue&&Ce.length===1?Ce:Ue?Ce.filter(st=>st!==de.key):[...Ce,de.key])},children:[r.jsx("svg",{className:"wk-equip-icon",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:de.icon})}),r.jsx("span",{children:de.label})]},de.key)})})]}),r.jsx("div",{className:"wk-setup-summary",children:r.jsxs("span",{children:[q,"  ",ue,"  ",Z," min"]})})]})]}),r.jsxs("div",{className:"wk-go-sticky",children:[Bt&&r.jsx("p",{className:"wk-free-limit-msg",children:"You've used your free workout this week. Upgrade for unlimited access."}),r.jsx("button",{className:"wk-randomise-btn",onClick:hr,disabled:C||Bt,children:C?"Loading exercises...":Bt?"Limit Reached":"Randomise Workout"})]}),sr]})}if(_==="spinning")return r.jsxs("div",{className:"wk-page wk-page-center","data-theme":l?"dark":"light","data-accent":d,children:[r.jsxs("div",{className:"wk-spin-container",children:[r.jsxs("div",{className:"wk-spin-ring",children:[r.jsx("svg",{className:"wk-spin-svg",viewBox:"0 0 200 200",children:Yk.map((q,ue)=>r.jsx("line",{x1:q.x1,y1:q.y1,x2:q.x2,y2:q.y2,className:"wk-spin-tick",strokeWidth:q.thick?"3.5":"2",style:{animationDelay:`${ue*.03}s`}},ue))}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"wk-spin-logo",width:"50",height:"50"})]}),r.jsx("p",{className:"wk-spin-text",children:"Generating workout..."})]}),sr]});if(_==="preview"){const q=Wt?.interval?{work:Wt.work,rest:Wt.rest}:Ba.find(de=>de.key===te),ue=I.length*A*(q.work+q.rest);return r.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>j(Wt?.interval?"muscle_sessions":"setup"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),r.jsxs("main",{className:"wk-main",children:[Wt?.interval&&r.jsx("h2",{className:"mg-preview-title",children:Wt.name}),r.jsxs("div",{className:"wk-preview-stats",children:[r.jsxs("div",{className:"wk-stat",children:[r.jsx("span",{className:"wk-stat-val",children:I.length}),r.jsx("span",{className:"wk-stat-label",children:"Exercises"})]}),r.jsxs("div",{className:"wk-stat",children:[r.jsx("span",{className:"wk-stat-val",children:A}),r.jsx("span",{className:"wk-stat-label",children:"Rounds"})]}),r.jsxs("div",{className:"wk-stat",children:[r.jsx("span",{className:"wk-stat-val",children:Math.ceil(ue/60)}),r.jsx("span",{className:"wk-stat-label",children:"Minutes"})]}),r.jsxs("div",{className:"wk-stat",children:[r.jsxs("span",{className:"wk-stat-val",children:[q.work,"/",q.rest]}),r.jsx("span",{className:"wk-stat-label",children:"Work/Rest"})]})]}),r.jsx("div",{className:"wk-preview-list",children:I.map((de,Ue)=>r.jsxs("div",{className:"wk-preview-item",style:{animationDelay:`${Ue*.06}s`},onClick:()=>oe(de),children:[r.jsx("span",{className:"wk-preview-num",children:Ue+1}),r.jsx("div",{className:"wk-preview-thumb",children:de.isGif?r.jsx("img",{src:de.videoUrl,alt:de.name,loading:"lazy"}):r.jsx("video",{src:`${de.videoUrl}#t=0.1`,muted:!0,playsInline:!0,preload:"auto"})}),r.jsx("span",{className:"wk-preview-name",children:de.name}),r.jsx("svg",{className:"wk-preview-play",width:"22",height:"22",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})})]},Ue))}),Tt&&r.jsx("div",{className:"wk-preview-modal-backdrop",onClick:()=>oe(null),children:r.jsxs("div",{className:"wk-preview-modal",onClick:de=>de.stopPropagation(),children:[r.jsx("button",{className:"wk-preview-modal-close",onClick:()=>oe(null),"aria-label":"Close preview",children:r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})}),r.jsx("div",{className:"wk-preview-modal-video",children:Tt.isGif?r.jsx("img",{src:Tt.videoUrl,alt:Tt.name}):r.jsx("video",{src:Tt.videoUrl,autoPlay:!0,loop:!0,muted:!0,playsInline:!0})}),r.jsx("h3",{className:"wk-preview-modal-title",children:Tt.name})]})}),r.jsxs("div",{className:"wk-preview-actions",children:[!Wt?.interval&&r.jsxs(r.Fragment,{children:[r.jsxs("button",{className:"wk-btn-secondary",onClick:()=>hr(),children:[r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("polyline",{points:"1 4 1 10 7 10"}),r.jsx("path",{d:"M3.51 15a9 9 0 1 0 2.13-9.36L1 10"})]}),"Reshuffle"]}),r.jsxs("button",{className:"wk-btn-save",onClick:()=>ae(!0),disabled:hs,children:[r.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"})}),"Save"]})]}),r.jsx("button",{className:"wk-btn-primary",onClick:Xa,children:"Start Workout"})]}),me&&r.jsx("div",{className:"wk-save-modal-backdrop",onClick:()=>ae(!1),children:r.jsxs("div",{className:"wk-save-modal",onClick:de=>de.stopPropagation(),children:[r.jsx("h3",{children:"Save Workout"}),r.jsx("p",{children:"Give this workout a name (or leave blank for auto-name)"}),r.jsx("input",{type:"text",className:"wk-save-input",value:xe,onChange:de=>E(de.target.value),placeholder:`${ia.find(de=>de.key===B)?.label||B} ${Z}min`,maxLength:40,autoFocus:!0}),r.jsxs("div",{className:"wk-save-modal-actions",children:[r.jsx("button",{className:"wk-btn-secondary",onClick:()=>ae(!1),children:"Cancel"}),r.jsx("button",{className:"wk-btn-primary",onClick:()=>ur(xe),disabled:hs,children:hs?"Saving...":"Save"})]})]})})]})]})}if(_==="countdown")return r.jsx("div",{className:"wk-page wk-page-center wk-page-dark","data-theme":l?"dark":"light","data-accent":d,children:r.jsxs("div",{className:"wk-countdown-big",children:[r.jsx("span",{className:"wk-countdown-num",children:mt}),r.jsx("span",{className:"wk-countdown-label",children:"GET READY"})]})});if(_==="workout"){const q=I[We],ue=P==="work"?ht.work:ht.rest,de=P==="rest"?We+1<I.length?I[We+1]:pe<A?I[0]:null:null;return r.jsxs("div",{className:"wk-page wk-page-workout","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("div",{className:"wk-video-container",children:P==="work"?q.isGif?r.jsx("img",{ref:Dt,className:"wk-video",src:q.videoUrl,alt:q.name},q.videoUrl):r.jsx("video",{className:"wk-video",src:q.videoUrl,autoPlay:!0,loop:!0,muted:!0,playsInline:!0},q.videoUrl):r.jsxs("div",{className:"wk-rest-screen",children:[r.jsx("span",{className:"wk-rest-label",children:"REST"}),de&&r.jsxs("span",{className:"wk-next-label",children:["Next: ",de.name]})]})}),r.jsx("div",{className:"wk-back-row",children:r.jsxs("button",{className:"wk-back-btn",onClick:()=>{confirm("Leave workout?")&&j("menu")},children:[r.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})}),"Back"]})}),r.jsx("div",{className:"wk-spotify",children:r.jsx("iframe",{src:"https://open.spotify.com/embed/playlist/37i9dQZF1DZ06evO3FJyYF?utm_source=generator&theme=0",width:"100%",height:"80",frameBorder:"0",allow:"autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture",loading:"lazy",title:"Spotify Playlist"})}),r.jsxs("div",{className:"wk-exercise-info",children:[r.jsxs("span",{className:"wk-exercise-counter",children:[We+1," / ",I.length]}),r.jsx("h2",{className:"wk-exercise-name",children:q.name}),r.jsxs("span",{className:"wk-round-label",children:["Round ",pe," of ",A]})]}),r.jsx("div",{className:"wk-timer-section",children:r.jsxs("div",{className:"wk-timer-ring-wrap",children:[mr(Fe,ue,P==="work"?"wk-tick-work":"wk-tick-rest"),r.jsxs("div",{className:"wk-timer-center",children:[r.jsx("span",{className:"wk-timer-time",children:Fe}),r.jsx("span",{className:`wk-timer-phase ${P}`,children:P==="work"?"WORK":"REST"})]})]})}),r.jsxs("div",{className:"wk-controls",children:[r.jsx("button",{className:"wk-ctrl-btn wk-ctrl-stop",onClick:()=>{confirm("End workout early?")&&j("menu")},children:r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("rect",{x:"4",y:"4",width:"16",height:"16",rx:"2"})})}),r.jsx("button",{className:"wk-ctrl-btn wk-ctrl-pause",onClick:()=>Me(!Ve),children:Ve?r.jsx("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})}):r.jsxs("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"currentColor",children:[r.jsx("rect",{x:"6",y:"4",width:"4",height:"16"}),r.jsx("rect",{x:"14",y:"4",width:"4",height:"16"})]})}),r.jsx("button",{className:"wk-ctrl-btn wk-ctrl-skip",onClick:()=>{qe(0)},children:r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:[r.jsx("polygon",{points:"5 4 15 12 5 20 5 4"}),r.jsx("rect",{x:"15",y:"4",width:"4",height:"16"})]})})]}),r.jsx("div",{className:"wk-progress-bar",children:r.jsx("div",{className:"wk-progress-fill",style:{width:`${da()*100}%`}})}),ot&&(()=>{const Ue=Ba.find(st=>st.key===te),Ce=I.length*A*(Ue.work+Ue.rest);return r.jsxs(r.Fragment,{children:[r.jsx(em,{title:"Workout Complete!",stats:[{value:Math.ceil(Ce/60),label:"Minutes"},{value:I.length*A,label:"Intervals"},{value:A,label:"Rounds"}],hideShare:!p,onShareJourney:t?Ct:null,userName:t?.name,onDismissStart:()=>j("menu"),onDone:()=>{es(!1),ms(null),Ot(null)}}),!Wt?.interval&&r.jsxs("button",{className:"wk-complete-save-btn",onClick:()=>ae(!0),disabled:hs,children:[r.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"})}),"Save This Workout"]}),me&&r.jsx("div",{className:"wk-save-modal-backdrop",onClick:()=>ae(!1),style:{zIndex:10001},children:r.jsxs("div",{className:"wk-save-modal",onClick:st=>st.stopPropagation(),children:[r.jsx("h3",{children:"Save Workout"}),r.jsx("p",{children:"Give this workout a name (or leave blank for auto-name)"}),r.jsx("input",{type:"text",className:"wk-save-input",value:xe,onChange:st=>E(st.target.value),placeholder:`${ia.find(st=>st.key===B)?.label||B} ${Z}min`,maxLength:40,autoFocus:!0}),r.jsxs("div",{className:"wk-save-modal-actions",children:[r.jsx("button",{className:"wk-btn-secondary",onClick:()=>ae(!1),children:"Cancel"}),r.jsx("button",{className:"wk-btn-primary",onClick:()=>ur(xe),disabled:hs,children:hs?"Saving...":"Save"})]})]})})]})})()]})}if(_==="muscle_sessions"){const q=lu.find(de=>de.key===lt),ue=I2[lt]||[];return r.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>j("menu"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),r.jsxs("main",{className:"wk-main",children:[r.jsxs("div",{className:"mg-sessions-header",children:[r.jsx("div",{className:"mg-sessions-icon",style:{background:Qp[lt]},children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:q?.icon})})}),r.jsxs("h2",{children:[q?.label," Workouts"]}),r.jsxs("p",{children:[ue.length," sessions available"]})]}),r.jsx("div",{className:"mg-sessions-list",children:ue.map((de,Ue)=>r.jsxs("button",{className:"mg-session-card",onClick:()=>{ms(de),j("muscle_overview")},style:{animationDelay:`${Ue*.08}s`},children:[r.jsxs("div",{className:"mg-session-info",children:[r.jsx("h3",{children:de.name}),r.jsx("p",{children:de.desc}),r.jsx("div",{className:"mg-session-meta",children:de.interval?r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"mg-session-tag mg-tag-interval",children:"Interval"}),r.jsxs("span",{className:"mg-session-tag",children:[de.exercises.length," exercises"]}),r.jsxs("span",{className:"mg-session-tag",children:[de.rounds," rounds"]})]}):r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"mg-session-tag mg-tag-strength",children:"Strength"}),r.jsxs("span",{className:"mg-session-tag",children:[de.exercises.length," exercises"]}),r.jsx("span",{className:"mg-session-tag",children:(()=>{const Ce=de.exercises.map(qt=>qt.sets||0),st=Math.min(...Ce),vt=Math.max(...Ce);return st===vt?`${st} sets each`:`${st}-${vt} sets each`})()})]})})]}),r.jsx("div",{className:"mg-session-arrow",children:r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})})]},de.id))})]}),sr]})}if(_==="muscle_overview"){const q=Wt;if(!q)return null;const ue=lu.find(de=>de.key===lt);return r.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>j("muscle_sessions"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),r.jsxs("main",{className:"wk-main mg-overview-main",children:[r.jsx("div",{className:"mg-overview-hero",style:q.image?void 0:{background:Qp[lt]},children:q.image?r.jsx("img",{src:q.image,alt:q.name,className:"mg-overview-hero-img"}):r.jsx("div",{className:"mg-overview-hero-content",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",className:"mg-overview-hero-icon",children:r.jsx("path",{d:ue?.icon})})})}),r.jsxs("div",{className:"mg-overview-header",children:[r.jsxs("div",{className:"mg-overview-title-row",children:[r.jsx("h2",{children:q.name}),q.level&&r.jsx("span",{className:"mg-overview-level",children:q.level})]}),r.jsx("p",{className:"mg-overview-desc",children:q.desc})]}),q.overview&&r.jsxs("div",{className:"mg-overview-section",children:[r.jsxs("h3",{children:[r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("path",{d:"M12 16v-4M12 8h.01"})]}),"About This Workout"]}),r.jsx("p",{children:q.overview})]}),q.tips&&q.tips.length>0&&r.jsxs("div",{className:"mg-overview-section",children:[r.jsxs("h3",{children:[r.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 1 1 7.072 0l-.548.547A3.374 3.374 0 0 0 14 18.469V19a2 2 0 1 1-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),"Tips & Form"]}),r.jsx("ul",{className:"mg-overview-tips",children:q.tips.map((de,Ue)=>r.jsx("li",{children:de},Ue))})]}),r.jsxs("div",{className:"mg-overview-section",children:[r.jsxs("h3",{children:[r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M9 5H7a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-2"}),r.jsx("rect",{x:"9",y:"3",width:"6",height:"4",rx:"1"}),r.jsx("path",{d:"M9 14l2 2 4-4"})]}),"Exercises (",q.exercises.length,")"]}),r.jsx("div",{className:"mg-overview-exercises",children:q.exercises.map((de,Ue)=>r.jsxs("div",{className:"mg-overview-exercise",children:[r.jsx("span",{className:"mg-overview-ex-num",children:Ue+1}),r.jsxs("div",{className:"mg-overview-ex-info",children:[r.jsx("span",{className:"mg-overview-ex-name",children:de.name}),q.interval?r.jsxs("span",{className:"mg-overview-ex-detail",children:[q.work,"s work / ",q.rest,"s rest"]}):r.jsxs("span",{className:"mg-overview-ex-detail",children:[de.sets," sets  ",de.reps?`${de.reps} reps`:`${de.time}s`,de.type==="weighted"&&"  weighted"]})]})]},Ue))})]}),r.jsxs("button",{className:"mg-overview-start-btn",onClick:()=>Aa(q),children:[r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M8 5v14l11-7z"})}),"Start Workout"]})]}),sr]})}if(_==="muscle_workout"){const q=Wt;if(!q)return null;const ue=q.exercises[Gt],de=is[Gt];if(!ue||!de)return null;const Ue=de.sets.length,Ce=q.exercises.length,st=q.exercises.reduce((U,je)=>U+(je.sets||0),0),qt=is.reduce((U,je)=>U+je.sets.length,0)/st*100,ss=gt[ue.name];ue.type==="timed"&&De===0&&!be&&Ue===us&&setTimeout(()=>rt(ue.time),0);const S=Ue+1<ue.sets?"Log Set":Gt+1<Ce?"Log Set  Next Exercise":"Log Set  Complete";return r.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("div",{className:"mg-session-progress",children:r.jsx("div",{className:"mg-session-progress-fill",style:{width:`${qt}%`}})}),r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>{confirm("End workout early?")&&j("muscle_overview")},"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsxs("span",{className:"mg-header-info",children:["Exercise ",Gt+1,"/",Ce]}),r.jsx("div",{style:{width:22}})]})}),r.jsxs("main",{className:"wk-main",children:[ss?r.jsxs("div",{className:"mg-video-container",onClick:Mi,children:[ss.isGif?r.jsx("img",{className:"mg-video",src:ss.url,alt:ue.name}):r.jsx("video",{ref:se,className:"mg-video",src:ss.url,loop:!0,muted:!0,playsInline:!0},ue.name),!Ke&&!ss.isGif&&r.jsxs("div",{className:"mg-video-overlay",children:[r.jsx("svg",{className:"mg-play-icon",width:"48",height:"48",viewBox:"0 0 24 24",fill:"rgba(255,255,255,0.9)",children:r.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})}),r.jsx("span",{className:"mg-video-hint",children:"Tap for demo"})]})]}):r.jsxs("div",{className:"mg-video-placeholder",children:[r.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",opacity:"0.4",children:[r.jsx("rect",{x:"2",y:"2",width:"20",height:"20",rx:"2.18",ry:"2.18"}),r.jsx("line",{x1:"7",y1:"2",x2:"7",y2:"22"}),r.jsx("line",{x1:"17",y1:"2",x2:"17",y2:"22"}),r.jsx("line",{x1:"2",y1:"12",x2:"22",y2:"12"}),r.jsx("line",{x1:"2",y1:"7",x2:"7",y2:"7"}),r.jsx("line",{x1:"2",y1:"17",x2:"7",y2:"17"}),r.jsx("line",{x1:"17",y1:"7",x2:"22",y2:"7"}),r.jsx("line",{x1:"17",y1:"17",x2:"22",y2:"17"})]}),r.jsx("span",{children:"Video coming soon"})]}),r.jsx("div",{className:"wk-spotify",children:r.jsx("iframe",{src:"https://open.spotify.com/embed/playlist/37i9dQZF1DZ06evO3FJyYF?utm_source=generator&theme=0",width:"100%",height:"80",frameBorder:"0",allow:"autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture",loading:"lazy",title:"Spotify Playlist"})}),r.jsxs("div",{className:"mg-exercise-card",children:[r.jsx("h2",{className:"mg-ex-name",children:ue.name}),r.jsx("span",{className:`mg-ex-type-badge ${ue.type}`,children:ue.type==="weighted"?"Weight + Reps":ue.type==="reps"?"Reps Only":"Timed"}),r.jsxs("div",{className:"mg-ex-set-info",children:[r.jsxs("span",{className:"mg-ex-set-num",children:["Set ",Ue+1," of ",ue.sets]}),ue.type!=="timed"&&r.jsxs("span",{className:"mg-ex-target",children:["Target: ",ue.reps," reps"]}),ue.type==="timed"&&r.jsxs("span",{className:"mg-ex-target",children:["Target: ",ue.time,"s"]})]}),ue.type==="weighted"&&r.jsxs("div",{className:"mg-input-area",children:[r.jsxs("div",{className:"mg-input-group",children:[r.jsx("label",{children:"Weight (kg)"}),r.jsx("input",{type:"number",inputMode:"decimal",className:"mg-input",value:Ms,onChange:U=>Fs(U.target.value),placeholder:"0"})]}),r.jsxs("div",{className:"mg-input-group",children:[r.jsx("label",{children:"Reps"}),r.jsx("input",{type:"number",inputMode:"numeric",className:"mg-input",value:os,onChange:U=>ws(U.target.value),placeholder:"0"})]})]}),ue.type==="reps"&&r.jsx("div",{className:"mg-input-area",children:r.jsxs("div",{className:"mg-input-group mg-input-single",children:[r.jsx("label",{children:"Reps"}),r.jsx("input",{type:"number",inputMode:"numeric",className:"mg-input",value:os,onChange:U=>ws(U.target.value),placeholder:"0"})]})}),ue.type==="timed"&&r.jsxs("div",{className:"mg-timer-area",children:[r.jsx("div",{className:"mg-timer-display",children:r.jsxs("span",{className:"mg-timer-value",children:[De,"s"]})}),be?r.jsx("button",{className:"mg-timer-btn mg-timer-stop",onClick:()=>Ie(!1),children:"Stop"}):r.jsx("button",{className:"mg-timer-btn",onClick:()=>{De===0&&rt(ue.time),Ie(!0)},children:De<ue.time&&De>0?"Resume":"Start Timer"})]}),r.jsx("button",{className:"mg-log-set-btn",onClick:Qr,children:S}),de.sets.length>0&&r.jsx("div",{className:"mg-completed-sets",children:de.sets.map((U,je)=>r.jsxs("div",{className:"mg-completed-set",children:[r.jsx("span",{className:"mg-completed-set-check",children:""}),r.jsxs("span",{children:["Set ",je+1,": ",U.weight!=null?`${U.weight}kg  ${U.reps}`:U.reps!=null?`${U.reps} reps`:`${U.time}s`]})]},je))})]})]}),sr,Ns&&(()=>{const U=is.reduce((tt,Ge)=>tt+Ge.sets.length,0),je=is.reduce((tt,Ge)=>tt+Ge.sets.reduce((ut,St)=>ut+(St.weight||0)*(St.reps||0),0),0),Ye=lu.find(tt=>tt.key===lt)?.label||"",He=[{value:is.length,label:"Exercises"},{value:U,label:"Sets"}];return je>0&&He.push({value:Math.round(je).toLocaleString(),label:"Volume (kg)"}),r.jsx(em,{title:`${Ye} Complete!`,subtitle:Wt?.name,stats:He,hideShare:!p,onShareJourney:t?Ct:null,userName:t?.name,onDismissStart:()=>j("menu"),onDone:()=>{Ft(!1),ms(null),Ot(null),Q(null)}})})(),kt&&r.jsx("div",{className:"mg-badge-celebration",onClick:()=>Q(null),children:r.jsxs("div",{className:"mg-badge-celebration-card",children:[r.jsx("div",{className:"mg-badge-celebration-icon",children:r.jsx("svg",{viewBox:"0 0 24 24",width:"48",height:"48",fill:"#ffc107",children:r.jsx("polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"})})}),r.jsx("h3",{className:"mg-badge-celebration-title",children:kt.badges.length===1?"Badge Earned!":`${kt.badges.length} Badges Earned!`}),r.jsx("div",{className:"mg-badge-celebration-list",children:kt.badges.map((U,je)=>r.jsx("div",{className:"mg-badge-celebration-item",children:U.type==="pb_target"?`${U.exercise}  ${U.targetWeight}kg`:U.label},je))}),r.jsxs("div",{className:"mg-badge-share-row",children:[r.jsxs("button",{className:"mg-badge-share-btn",onClick:async U=>{U.stopPropagation();const je=kt.badges[0],Ye=kt.badges.map(tt=>tt.type==="pb_target"?`PB Target Hit: ${tt.exercise}  ${tt.targetWeight}kg`:tt.label),He=Bn.find(tt=>tt.id===je?.id)||Bn.find(tt=>tt.name===je?.label);await Ct({type:"badge_earned",title:Ye.length===1?Ye[0]:`${Ye.length} Badges Earned!`,badges:Ye,badgeDesc:He?.desc}),Et("Posted to Journey!","success")},children:[r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M12 20h9"}),r.jsx("path",{d:"M16.5 3.5a2.121 2.121 0 1 1 3 3L7 19l-4 1 1-4Z"})]}),"Journey"]}),r.jsxs("button",{className:"mg-badge-share-btn",onClick:async U=>{U.stopPropagation();const je=kt.badges[0],Ye=kt.badges.map(Ge=>Ge.type==="pb_target"?`PB Target Hit: ${Ge.exercise}  ${Ge.targetWeight}kg`:Ge.label),He=Bn.find(Ge=>Ge.id===je?.id)||Bn.find(Ge=>Ge.name===je?.label),tt=`Badge Earned! ${Ye.join(", ")}
#MindCoreFitness`;try{const Ge=await nb({type:"badge",title:Ye.length===1?Ye[0]:"Badges Earned!",badges:Ye,badgeImage:He?.img,badgeDesc:He?.desc});navigator.share&&navigator.canShare?.({files:[new File([Ge],"badge.png",{type:"image/png"})]})?await navigator.share({title:"Mind Core Fitness",text:tt,files:[new File([Ge],"badge.png",{type:"image/png"})]}):navigator.share?await navigator.share({title:"Mind Core Fitness",text:tt}):(await navigator.clipboard.writeText(tt),Et("Copied!","success"))}catch{try{await navigator.clipboard.writeText(tt),Et("Copied!","success")}catch{}}},children:[r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("circle",{cx:"18",cy:"5",r:"3"}),r.jsx("circle",{cx:"6",cy:"12",r:"3"}),r.jsx("circle",{cx:"18",cy:"19",r:"3"}),r.jsx("line",{x1:"8.59",y1:"13.51",x2:"15.42",y2:"17.49"}),r.jsx("line",{x1:"15.41",y1:"6.51",x2:"8.59",y2:"10.49"})]}),"Share"]})]}),r.jsx("button",{className:"mg-badge-celebration-dismiss",children:"Tap to dismiss"})]})})]})}return null}const y6=60,b6={"Dumbbell Floor Press":"push","Seated Dumbbell Shoulder Press":"push","Seated Dumbbell Arnold Press":"push","Dumbbell Overhead Tricep Extension":"push",Skullcrushers:"push","Dumbbell Lateral Raise":"push","Dumbbell Front Raise":"push","Dumbbell Bent Over Row":"pull","Single Arm Bent Over Row":"pull","Bicep Curl":"pull","Hammer Curl":"pull","Dumbbell Bent Over Rear Delt Fly":"pull","Renegade Row":"pull","Dumbbell Goblet Squats":"lower","Romanian Deadlifts":"lower","Forward Dumbbell Lunges":"lower","Dumbbell Sumo Squats":"lower","Weighted Calf Raises":"lower","1 Legged RDL":"lower","Dumbbell Box Step Ups":"lower","Dumbbell Squat Pulses":"lower","Dumbbell Reverse Lunges":"lower","Kettlebell Romanian Deadlift":"lower","Russian Twists Dumbbell":"core","Kettlebell Russian Twist":"core","Kettlebell Side Bends":"core","Kneeling Kettlebell Halo":"core"},v6=[{threshold:1e3,label:"1 Tonne"},{threshold:5e3,label:"5 Tonne"},{threshold:1e4,label:"10 Tonne"},{threshold:25e3,label:"25 Tonne"},{threshold:5e4,label:"50 Tonne"},{threshold:1e5,label:"100 Tonne"},{threshold:25e4,label:"250 Tonne"},{threshold:5e5,label:"500 Tonne"},{threshold:1e6,label:"1 Million kg"}],P2=[{id:"fullbody_4wk",name:"4-Week Full Body",focus:"fullbody",duration:4,daysPerWeek:3,level:"All Levels",description:"Build total body strength with compound dumbbell movements and bodyweight finishers",repProg:2,timeProg:5,days:[{name:"Day 1",label:"Push Focus",exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:3,baseReps:10,pbKey:"chestPress",storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Seated Dumbbell Shoulder Press",type:"weighted",sets:3,baseReps:10,pbKey:"shoulderPress",storagePath:"exercises/dumbbells/upper/seated dumbbell shoulder press.mp4"},{name:"Dumbbell Goblet Squats",type:"weighted",sets:3,baseReps:10,pbKey:"squat",storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Press Up",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Mountain Climbers",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Mountain Climbers.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]},{name:"Day 2",label:"Pull Focus",exercises:[{name:"Dumbbell Bent Over Row",type:"weighted",sets:3,baseReps:10,pbKey:"seatedRow",storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Bicep Curl",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Romanian Deadlifts",type:"weighted",sets:3,baseReps:10,pbKey:"deadlift",storagePath:"exercises/dumbbells/lower/romanian deadlifts.GIF"},{name:"Reverse Lunge",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/lower/reverse lunge.GIF"},{name:"Russian Twist",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Russian Twist.mp4"},{name:"Side Plank",type:"timed",sets:2,baseTime:25,storagePath:"exercises/bodyweight/core/Side Plank.mp4"}]},{name:"Day 3",label:"Legs & Core",exercises:[{name:"Forward Dumbbell Lunges",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.GIF"},{name:"Dumbbell Sumo Squats",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/lower/dumbbell sumo squats.GIF"},{name:"Weighted Calf Raises",type:"weighted",sets:3,baseReps:15,storagePath:"exercises/dumbbells/lower/weighted calf raises.GIF"},{name:"Box Step Ups",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/lower/box step ups.GIF"},{name:"Burpee",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]}]},{id:"fullbody_8wk",name:"8-Week Full Body",focus:"fullbody",duration:8,daysPerWeek:3,level:"Intermediate",description:"Two-phase programme building strength and endurance across your full body",repProg:1,timeProg:3,days:[{name:"Day 1",label:"Strength",exercises:[{name:"Dumbbell Goblet Squats",type:"weighted",sets:4,baseReps:8,pbKey:"squat",storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Dumbbell Floor Press",type:"weighted",sets:4,baseReps:8,pbKey:"chestPress",storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Dumbbell Bent Over Row",type:"weighted",sets:4,baseReps:8,pbKey:"seatedRow",storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Seated Dumbbell Shoulder Press",type:"weighted",sets:3,baseReps:10,pbKey:"shoulderPress",storagePath:"exercises/dumbbells/upper/seated dumbbell shoulder press.mp4"},{name:"Mountain Climbers",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Mountain Climbers.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:35,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]},{name:"Day 2",label:"Power",exercises:[{name:"Romanian Deadlifts",type:"weighted",sets:4,baseReps:8,pbKey:"deadlift",storagePath:"exercises/dumbbells/lower/romanian deadlifts.GIF"},{name:"Forward Dumbbell Lunges",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.GIF"},{name:"Single Arm Bent Over Row",type:"weighted",sets:4,baseReps:8,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Hammer Curl",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/hammer curl.mp4"},{name:"Bulgarian Split Squats",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/lower/bulgarian split squats.GIF"},{name:"Russian Twist",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Russian Twist.mp4"}]},{name:"Day 3",label:"Endurance",exercises:[{name:"Dumbbell Sumo Squats",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/lower/dumbbell sumo squats.GIF"},{name:"Weighted Calf Raises",type:"weighted",sets:3,baseReps:15,storagePath:"exercises/dumbbells/lower/weighted calf raises.GIF"},{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Press Up",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Burpee",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:40,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]}]},{id:"fullbody_12wk",name:"12-Week Full Body",focus:"fullbody",duration:12,daysPerWeek:3,level:"Advanced",description:"Complete transformation programme: push, pull, and legs over three phases",repProg:1,timeProg:2,days:[{name:"Day 1",label:"Upper Push",exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:4,baseReps:8,pbKey:"chestPress",storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Seated Dumbbell Arnold Press",type:"weighted",sets:4,baseReps:8,storagePath:"exercises/dumbbells/upper/seated dumbbell arnold press.mp4"},{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Skullcrushers",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/skullcrushers.mp4"},{name:"Press Up",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]},{name:"Day 2",label:"Lower Body",exercises:[{name:"Dumbbell Goblet Squats",type:"weighted",sets:4,baseReps:8,pbKey:"squat",storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Romanian Deadlifts",type:"weighted",sets:4,baseReps:8,pbKey:"deadlift",storagePath:"exercises/dumbbells/lower/romanian deadlifts.GIF"},{name:"Forward Dumbbell Lunges",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.GIF"},{name:"Weighted Calf Raises",type:"weighted",sets:3,baseReps:15,storagePath:"exercises/dumbbells/lower/weighted calf raises.GIF"},{name:"Jump Squats",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/lower/jump squats.GIF"},{name:"Hollow Body Hold",type:"timed",sets:3,baseTime:30,storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"}]},{name:"Day 3",label:"Upper Pull",exercises:[{name:"Dumbbell Bent Over Row",type:"weighted",sets:4,baseReps:8,pbKey:"seatedRow",storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Single Arm Bent Over Row",type:"weighted",sets:4,baseReps:8,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Bicep Curl",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Burpee",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Side Plank",type:"timed",sets:2,baseTime:25,storagePath:"exercises/bodyweight/core/Side Plank.mp4"}]}]},{id:"core_4wk",name:"4-Week Core",focus:"core",duration:4,daysPerWeek:3,level:"Beginner",description:"Build a solid core foundation with targeted ab and stability work",repProg:2,timeProg:5,days:[{name:"Day 1",label:"Abs",exercises:[{name:"Crunch",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/core/Crunch.mp4"},{name:"Leg Raises",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Leg Raises.mp4"},{name:"Russian Twist",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Russian Twist.mp4"},{name:"Bicycle Crunch",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Bicycle Crunch.mp4"},{name:"Mountain Climbers",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Mountain Climbers.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]},{name:"Day 2",label:"Stability",exercises:[{name:"Dead Bug",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Dead Bug.mp4"},{name:"Bird Dog",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Bird Dog.mp4"},{name:"Side Plank",type:"timed",sets:2,baseTime:20,storagePath:"exercises/bodyweight/core/Side Plank.mp4"},{name:"Flutter Kicks",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Flutter Kicks.mp4"},{name:"Hollow Body Hold",type:"timed",sets:3,baseTime:20,storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"},{name:"High Plank Shoulder Taps",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/High Plank Shoulder Taps.mp4"}]},{name:"Day 3",label:"Power Core",exercises:[{name:"Single Leg V-Up",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Single Leg V-Up.mp4"},{name:"Toe Reaches",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/core/toe reaches.GIF"},{name:"Russian Twists Dumbbell",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/core/russian twists dumbbell.GIF"},{name:"Burpee",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Fast Mountain Climbers",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Fast Mountain Climbers.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]}]},{id:"core_8wk",name:"8-Week Core",focus:"core",duration:8,daysPerWeek:3,level:"Intermediate",description:"Develop deep core strength and rotational power over two phases",repProg:1,timeProg:3,days:[{name:"Day 1",label:"Anti-Extension",exercises:[{name:"Forearm Plank",type:"timed",sets:3,baseTime:35,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"},{name:"Dead Bug",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Dead Bug.mp4"},{name:"Plank Walkout",type:"reps",sets:3,baseReps:8,storagePath:"exercises/bodyweight/core/Plank Walkout.mp4"},{name:"Hollow Body Hold",type:"timed",sets:3,baseTime:25,storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"},{name:"Leg Raises",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Leg Raises.mp4"},{name:"Mountain Climbers",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Mountain Climbers.mp4"}]},{name:"Day 2",label:"Rotation",exercises:[{name:"Russian Twist",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Russian Twist.mp4"},{name:"Kettlebell Russian Twist",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/kettlebells/core/kettlebell russian twist.mp4"},{name:"Bicycle Crunch",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Bicycle Crunch.mp4"},{name:"Side Plank Rotation",type:"reps",sets:2,baseReps:10,storagePath:"exercises/bodyweight/core/Side Plank Rotation.mp4"},{name:"High Plank Shoulder Taps",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/core/High Plank Shoulder Taps.mp4"},{name:"Hollow Hold To V-Sit",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Hollow Hold To V-sit.mp4"}]},{name:"Day 3",label:"Power",exercises:[{name:"Crunch",type:"reps",sets:4,baseReps:15,storagePath:"exercises/bodyweight/core/Crunch.mp4"},{name:"Flutter Kicks",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Flutter Kicks.mp4"},{name:"Reverse Crunch To Leg Raise",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Reverse Crunch To Leg Raise.mp4"},{name:"Burpee",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Kettlebell Bird Dog Drag",type:"reps",sets:3,baseReps:10,storagePath:"exercises/kettlebells/core/kettlebell bird dog drag.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:40,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]}]},{id:"core_12wk",name:"12-Week Core",focus:"core",duration:12,daysPerWeek:3,level:"Advanced",description:"Ultimate core transformation: stability, strength, and power across three phases",repProg:1,timeProg:2,days:[{name:"Day 1",label:"Strength",exercises:[{name:"Forearm Plank",type:"timed",sets:4,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"},{name:"Plank Walkout",type:"reps",sets:4,baseReps:8,storagePath:"exercises/bodyweight/core/Plank Walkout.mp4"},{name:"Leg Raises",type:"reps",sets:4,baseReps:12,storagePath:"exercises/bodyweight/core/Leg Raises.mp4"},{name:"Kettlebell Side Bends",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/kettlebells/core/kettlebell side bends.mp4"},{name:"Dead Bug Single Leg Drop",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Dead Bug Single Leg Drop.mp4"},{name:"Hollow Body Hold",type:"timed",sets:3,baseTime:25,storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"}]},{name:"Day 2",label:"Endurance",exercises:[{name:"Crunch",type:"reps",sets:4,baseReps:15,storagePath:"exercises/bodyweight/core/Crunch.mp4"},{name:"Kettlebell Russian Twist",type:"weighted",sets:4,baseReps:15,storagePath:"exercises/kettlebells/core/kettlebell russian twist.mp4"},{name:"Bicycle Crunch",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Bicycle Crunch.mp4"},{name:"Hollow Hold Flutter Kicks",type:"reps",sets:3,baseReps:25,storagePath:"exercises/bodyweight/core/Hollow Hold Flutter Kicks.mp4"},{name:"Cross Body Mountain Climbers",type:"reps",sets:3,baseReps:25,storagePath:"exercises/bodyweight/core/Cross Body Mountain Climbers.mp4"},{name:"Side Plank",type:"timed",sets:2,baseTime:25,storagePath:"exercises/bodyweight/core/Side Plank.mp4"}]},{name:"Day 3",label:"Power",exercises:[{name:"Hollow Hold To V-Sit",type:"reps",sets:4,baseReps:10,storagePath:"exercises/bodyweight/core/Hollow Hold To V-sit.mp4"},{name:"Reverse Crunch To Leg Raise",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Reverse Crunch To Leg Raise.mp4"},{name:"Burpee",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Hip Dips Plank",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/core/Hip Dips Plank.mp4"},{name:"Kneeling Kettlebell Halo",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/kettlebells/core/kneeling kettlebell halo.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:35,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]}]},{id:"upper_4wk",name:"4-Week Upper Body",focus:"upper",duration:4,daysPerWeek:3,level:"Intermediate",description:"Sculpt and strengthen your chest, back, shoulders, and arms",repProg:2,timeProg:5,days:[{name:"Day 1",label:"Push",exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:4,baseReps:10,pbKey:"chestPress",storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Seated Dumbbell Shoulder Press",type:"weighted",sets:3,baseReps:10,pbKey:"shoulderPress",storagePath:"exercises/dumbbells/upper/seated dumbbell shoulder press.mp4"},{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Tricep Dips",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/upper/tricep dips.mp4"},{name:"Pike Push Ups",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/upper/pike push ups.GIF"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]},{name:"Day 2",label:"Pull",exercises:[{name:"Dumbbell Bent Over Row",type:"weighted",sets:4,baseReps:10,pbKey:"seatedRow",storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Single Arm Bent Over Row",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Bicep Curl",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Hammer Curl",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/hammer curl.mp4"},{name:"Reverse Plank",type:"timed",sets:3,baseTime:20,storagePath:"exercises/bodyweight/upper/reverse plank.GIF"}]},{name:"Day 3",label:"Mixed",exercises:[{name:"Seated Dumbbell Arnold Press",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/seated dumbbell arnold press.mp4"},{name:"Dumbbell Lateral Raise",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/dumbbell lateral raise.mp4"},{name:"Dumbbell Front Raise",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/dumbbell front raise.mp4"},{name:"Press Up",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Renegade Row",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/renegade row.mp4"},{name:"Superman Hold",type:"timed",sets:3,baseTime:30,storagePath:"exercises/bodyweight/core/Superman Hold.mp4"}]}]},{id:"lower_4wk",name:"4-Week Lower Body",focus:"lower",duration:4,daysPerWeek:3,level:"Intermediate",description:"Build powerful legs and glutes with squats, deadlifts, and plyometrics",repProg:2,timeProg:5,days:[{name:"Day 1",label:"Quad Dominant",exercises:[{name:"Dumbbell Goblet Squats",type:"weighted",sets:4,baseReps:10,pbKey:"squat",storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Forward Dumbbell Lunges",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.GIF"},{name:"Dumbbell Box Step Ups",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/lower/dumbbell box step ups.mp4"},{name:"Dumbbell Squat Pulses",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/lower/dumbbell squat pulses.GIF"},{name:"Jump Squats",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/lower/jump squats.GIF"},{name:"Squat And Hold",type:"timed",sets:3,baseTime:30,storagePath:"exercises/bodyweight/lower/squat and hold.GIF"}]},{name:"Day 2",label:"Hamstring & Glute",exercises:[{name:"Romanian Deadlifts",type:"weighted",sets:4,baseReps:8,pbKey:"deadlift",storagePath:"exercises/dumbbells/lower/romanian deadlifts.GIF"},{name:"1 Legged RDL",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/lower/1 legged rdl.GIF"},{name:"Hip Thrusts",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/lower/hip thrusts.GIF"},{name:"Dumbbell Reverse Lunges",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/lower/dumbbell reverse lunges.GIF"},{name:"Donkey Kicks",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/lower/donkey kicks.GIF"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]},{name:"Day 3",label:"Power & Stability",exercises:[{name:"Dumbbell Sumo Squats",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/lower/dumbbell sumo squats.GIF"},{name:"Kettlebell Romanian Deadlift",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/kettlebells/lower/kettlebell romanian deadlift.mp4"},{name:"Weighted Calf Raises",type:"weighted",sets:3,baseReps:15,storagePath:"exercises/dumbbells/lower/weighted calf raises.GIF"},{name:"Bulgarian Split Squats",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/lower/bulgarian split squats.GIF"},{name:"Skater Jumps",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/lower/skater jumps.GIF"},{name:"Side Plank",type:"timed",sets:2,baseTime:25,storagePath:"exercises/bodyweight/core/Side Plank.mp4"}]}]}];function fh(n,e,t){const i=n.baseReps?n.baseReps+(e-1)*(t.repProg||0):void 0,l=n.baseTime?n.baseTime+(e-1)*(t.timeProg||0):void 0;return{sets:n.sets,reps:i,time:l}}const x6={fullbody:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm-2 8h4l1 4h2l-1 4h-2l-1 4h-2l-1-4H8l-1-4h2l1-4z",core:"M12 2a4 4 0 0 1 4 4v1h-2V6a2 2 0 1 0-4 0v1H8V6a4 4 0 0 1 4-4zM8 9h8v2H8V9zm-1 4h10l-1 9H8l-1-9z",upper:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm8 10l-3-1.5c-.5-.25-1-.5-1.5-.5h-7c-.5 0-1 .25-1.5.5L4 12l-2 6h4l1.5 4h9L18 18h4l-2-6z",lower:"M16.5 3A2.5 2.5 0 0 0 14 5.5 2.5 2.5 0 0 0 16.5 8 2.5 2.5 0 0 0 19 5.5 2.5 2.5 0 0 0 16.5 3zM14 9l-3 7h2l1 6h2l1-6h2l-3-7h-2z"};function w6(){const{currentUser:n,isClient:e,clientData:t,loading:i}=Ir(),{isPremium:l}=yc(),{isDark:u,toggleTheme:d,accent:p}=Ca(),g=tr(),y=Na(),[x,_]=b.useState("loading"),[j,O]=b.useState(null),K=b.useRef(!1),[B,D]=b.useState(null),[te,Y]=b.useState(!1),[Z,ke]=b.useState(1),[Re,_e]=b.useState(0),[C,T]=b.useState(0),[M,V]=b.useState(0),[I,L]=b.useState([]),[A,Le]=b.useState(""),[ht,$]=b.useState(""),[pe,Be]=b.useState(!1),[We,J]=b.useState(0),P=b.useRef(null),[re,Fe]=b.useState({}),[qe,Ve]=b.useState(!1),Me=b.useRef(null),[mt,wt]=b.useState(null),[ot,es]=b.useState([]);b.useEffect(()=>{window.scrollTo(0,0)},[x]);const[Ns,Ft]=b.useState(null),Tt=b.useCallback((be,Ie="info")=>{Ft({message:be,type:Ie}),setTimeout(()=>Ft(null),4e3)},[]),oe=b.useCallback(async be=>{if(!t)throw new Error("Not signed in");const Ie=be&&typeof be=="object"&&be.type;await Gr(Ht(ge,"posts"),{authorId:t.id,authorName:t.name||"Unknown",authorPhotoURL:t.photoURL||null,content:Ie?"":be,type:Ie?be.type:"text",imageURL:null,createdAt:yr(),likeCount:0,commentCount:0,...Ie?{metadata:{title:be.title||"",subtitle:be.subtitle||"",stats:be.stats||[],quote:be.quote||"",badges:be.badges||[]}}:{}})},[t]),Dt=b.useRef(null),Nt=()=>(Dt.current||(Dt.current=new(window.AudioContext||window.webkitAudioContext)),Dt.current),Kt=()=>{try{const be=Nt(),Ie=be.createOscillator(),De=be.createGain();Ie.connect(De),De.connect(be.destination),Ie.frequency.value=1200,De.gain.value=.4,Ie.start(be.currentTime),Ie.stop(be.currentTime+.3)}catch{}};b.useEffect(()=>{!i&&(!n||!e)&&g("/")},[n,e,i,g]),b.useEffect(()=>{if(!t)return;(async()=>{try{const Ie=Xe(ge,"clientProgrammes",t.id),De=await Is(Ie);De.exists()&&D(De.data());const rt=y.state?.templateId;if(rt&&!K.current){const Ke=P2.find(at=>at.id===rt);if(Ke){K.current=!0,O(Ke),_("overview");return}}De.exists()?_("dashboard"):g("/client/core-buddy/workouts",{replace:!0})}catch(Ie){console.error("Error loading programme:",Ie),g("/client/core-buddy/workouts",{replace:!0})}})()},[t]),b.useEffect(()=>{if(!pe||We<=0){pe&&We<=0&&(Be(!1),Kt());return}return P.current=setTimeout(()=>J(be=>be-1),1e3),()=>clearTimeout(P.current)},[pe,We]);const Et=async be=>{if(t)try{await Ds(Xe(ge,"clientProgrammes",t.id),be),D(be)}catch(Ie){console.error("Error saving programme:",Ie),Tt("Failed to save. Check Firestore rules for clientProgrammes.","error")}},Ct=async be=>{const Ie={templateId:be.id,startDate:Mt.now(),completedSessions:{}};await Et(Ie),_("dashboard")},lt=async()=>{if(t)try{await lr(Xe(ge,"clientProgrammes",t.id)),D(null),_("browse")}catch(be){console.error("Error quitting programme:",be)}},Ot=()=>B?P2.find(be=>be.id===B.templateId):null,Wt=()=>{if(!B?.startDate)return 1;const be=B.startDate.toDate?B.startDate.toDate():new Date(B.startDate),De=new Date-be,rt=Math.floor(De/(1e3*60*60*24));return Math.floor(rt/7)+1},ms=()=>{if(!B)return{currentWeek:1,completedThisWeek:0,nextDay:0,totalCompleted:0};const be=B.completedSessions||{},Ie=Object.keys(be).length,De=Ot();if(!De)return{currentWeek:1,completedThisWeek:0,nextDay:0,totalCompleted:0};const rt=De.duration*De.daysPerWeek,Ke=Wt(),at=Math.min(Ke,De.duration);let gt=0;for(let se=0;se<De.daysPerWeek;se++)be[`w${at}d${se}`]&&gt++;if(Ie>=rt)return{currentWeek:De.duration,completedThisWeek:De.daysPerWeek,nextDay:-1,totalCompleted:Ie,totalSessions:rt,complete:!0};if(Ke>De.duration)return{currentWeek:De.duration,completedThisWeek:gt,nextDay:-1,totalCompleted:Ie,totalSessions:rt,complete:!0};let X=-1;for(let se=0;se<De.daysPerWeek;se++)if(!be[`w${at}d${se}`]){X=se;break}return{currentWeek:at,completedThisWeek:gt,nextDay:X,nextWeek:at,totalCompleted:Ie,totalSessions:rt}},Gt=be=>{const Ie=Wt();return be<Ie},Pt=(be,Ie,De)=>{if(!B||be<=1)return null;const rt=`w${be-1}d${Ie}`,Ke=B.completedSessions?.[rt];if(!Ke)return null;const at=Ke.exercises?.find(gt=>gt.name===De);return at?.sets?.length?at.sets[at.sets.length-1]:null},us=(be,Ie)=>{const De=Ot();if(!De)return;ke(be),_e(Ie),T(0),V(0),L([]),$(""),Be(!1),J(0),Ve(!1),Fe({});const rt=De.days[Ie],Ke=rt.exercises.map(se=>{const Qe=fh(se,be,De);return{name:se.name,type:se.type,pbKey:se.pbKey,targetSets:Qe.sets,targetReps:Qe.reps,targetTime:Qe.time,sets:[]}});L(Ke);const at=rt.exercises[0],gt=Pt(be,Ie,at.name);gt?.weight&&at.type==="weighted"?Le(String(gt.weight)):Le(""),(async()=>{const se={};for(const Qe of rt.exercises)if(Qe.storagePath)try{const _t=yi(bi,Qe.storagePath),et=await fo(_t);se[Qe.name]={url:et,isGif:/\.gif$/i.test(Qe.storagePath)}}catch(_t){console.warn(`Video not found for ${Qe.name}:`,_t)}Fe(se)})(),_("session")},xs=async()=>{Ot();const be=I[C];if(!be)return;let Ie={};if(be.type==="weighted"){const Ke=parseFloat(A)||0,at=parseInt(ht)||0;if(at===0){Tt("Enter your reps","error");return}Ie={weight:Ke,reps:at}}else if(be.type==="reps"){const Ke=parseInt(ht)||0;if(Ke===0){Tt("Enter your reps","error");return}Ie={reps:Ke}}else if(be.type==="timed"){const Ke=be.targetTime-We;Ie={time:Math.max(Ke,1)}}const De=[...I];De[C]={...be,sets:[...be.sets,Ie]},L(De),be.type==="weighted"&&Ie.weight>0&&await Ms(be.name,Ie.weight,Ie.reps);const rt=be.sets.length+1;if(rt<be.targetSets)V(rt),Le(Ie.weight?String(Ie.weight):""),$(""),Be(!1),J(0);else if(C+1<I.length){const Ke=C+1;T(Ke),V(0),Ve(!1);const gt=Ot()?.days[Re]?.exercises[Ke],X=Pt(Z,Re,gt?.name);X?.weight&&gt?.type==="weighted"?Le(String(X.weight)):Le(""),$(""),Be(!1),J(0)}else await is(De)},is=async be=>{if(!B||!t)return;const Ie=`w${Z}d${Re}`,De={...B.completedSessions,[Ie]:{completedAt:new Date().toISOString(),exercises:be.map(at=>({name:at.name,type:at.type,sets:at.sets}))}},rt={...B,completedSessions:De};await Et(rt);const Ke=be.reduce((at,gt)=>at+gt.sets.reduce((X,se)=>X+(se.weight||0)*(se.reps||0),0),0);Ke>0&&await Qs(Ke);try{const at=Ot();await Gr(Ht(ge,"workoutLogs"),{clientId:t.id,type:"programme",programmeId:at?.id,programmeName:at?.name,week:Z,day:Re+1,exerciseCount:be.length,duration:Math.round(be.reduce((gt,X)=>gt+X.sets.length*1.5,0)),volume:Math.round(Ke),completedAt:Mt.now()})}catch(at){console.error("Error saving workout log:",at)}ot.length>0&&(wt({badges:[...ot]}),es([])),Y(!0)},Qs=async be=>{if(t)try{const Ie=await Is(Xe(ge,"coreBuddyAchievements",t.id)),De=Ie.exists()?Ie.data():{clientId:t.id,badges:[],totalVolume:0},rt=De.totalVolume||0,Ke=rt+be,at=[];v6.forEach(X=>{Ke>=X.threshold&&rt<X.threshold&&(De.badges.some(Qe=>Qe.type==="volume_milestone"&&Qe.milestone===X.threshold)||at.push({type:"volume_milestone",milestone:X.threshold,label:X.label,achievedAt:Mt.now()}))});const gt=[...De.badges,...at];await Ds(Xe(ge,"coreBuddyAchievements",t.id),{clientId:t.id,badges:gt,totalVolume:Math.round(Ke),updatedAt:Mt.now()}),at.length>0&&es(X=>[...X,...at])}catch(Ie){console.error("Error updating volume:",Ie)}},Ms=async(be,Ie,De)=>{if(t)try{const rt=t.id,Ke=await Is(Xe(ge,"coreBuddyPBs",rt)),gt=(Ke.exists()?Ke.data():null)?.exercises||{},X=gt[be];let se=!1;if(X?(Ie>(X.weight||0)||Ie===(X.weight||0)&&De>(X.reps||0))&&(se=!0):se=!0,se){const Qe={...gt,[be]:{weight:Ie,reps:De,achievedAt:Mt.now()}};await Ds(Xe(ge,"coreBuddyPBs",rt),{clientId:t.id,exercises:Qe,updatedAt:Mt.now()}),Tt(`New PB! ${Ie}kg  ${De} reps`,"success"),Kt(),await Fs(be,Ie)}}catch(rt){console.error("Error checking PB:",rt)}},Fs=async(be,Ie)=>{if(t)try{const De=await Is(Xe(ge,"coreBuddyTargets",t.id));if(!De.exists())return;const Ke=(De.data().targets||{})[be];if(!Ke||Ie<Ke.targetWeight)return;const at=await Is(Xe(ge,"coreBuddyAchievements",t.id)),gt=at.exists()?at.data():{clientId:t.id,badges:[],totalVolume:0};if(gt.badges.some(_t=>_t.type==="pb_target"&&_t.exercise===be&&_t.targetWeight===Ke.targetWeight))return;const se={type:"pb_target",exercise:be,group:b6[be]||"push",targetWeight:Ke.targetWeight,achievedAt:Mt.now()},Qe=[...gt.badges,se];await Ds(Xe(ge,"coreBuddyAchievements",t.id),{...gt,badges:Qe,updatedAt:Mt.now()}),es(_t=>[..._t,se])}catch(De){console.error("Error checking target badge:",De)}},os=Ns&&r.jsxs("div",{className:`toast-notification ${Ns.type}`,children:[Ns.type==="success"&&r.jsx("span",{children:" "}),Ns.message]}),ws=(be,Ie)=>r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:Ie,"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:d,"aria-label":"Toggle theme",children:u?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})});if(i||x==="loading")return r.jsx("div",{className:"cb-loading",children:r.jsx("div",{className:"cb-loading-spinner"})});if(x==="browse")return g("/client/core-buddy/workouts",{replace:!0}),null;if(x==="overview"&&j){const be=j;return r.jsx(Sa,{children:r.jsxs("div",{className:"pg-page","data-theme":u?"dark":"light","data-accent":p,children:[ws(be.name,()=>g("/client/core-buddy/workouts")),r.jsxs("main",{className:"pg-main",children:[r.jsxs("div",{className:"pg-overview-hero",children:[r.jsx("svg",{className:"pg-overview-icon",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:x6[be.focus]})}),r.jsx("h2",{className:"pg-overview-name",children:be.name}),r.jsx("p",{className:"pg-overview-desc",children:be.description}),r.jsxs("div",{className:"pg-overview-stats",children:[r.jsxs("div",{className:"pg-ov-stat",children:[r.jsx("span",{className:"pg-ov-stat-num",children:be.duration}),r.jsx("span",{className:"pg-ov-stat-label",children:"Weeks"})]}),r.jsxs("div",{className:"pg-ov-stat",children:[r.jsx("span",{className:"pg-ov-stat-num",children:be.daysPerWeek}),r.jsx("span",{className:"pg-ov-stat-label",children:"Days/Week"})]}),r.jsxs("div",{className:"pg-ov-stat",children:[r.jsx("span",{className:"pg-ov-stat-num",children:be.duration*be.daysPerWeek}),r.jsx("span",{className:"pg-ov-stat-label",children:"Sessions"})]})]})]}),r.jsx("div",{className:"pg-overview-days",children:be.days.map((Ie,De)=>r.jsxs("div",{className:"pg-day-card",children:[r.jsxs("div",{className:"pg-day-header",children:[r.jsx("span",{className:"pg-day-name",children:Ie.name}),r.jsx("span",{className:"pg-day-label",children:Ie.label})]}),r.jsx("div",{className:"pg-day-exercises",children:Ie.exercises.map((rt,Ke)=>{const at=fh(rt,1,be);return r.jsxs("div",{className:"pg-day-ex",children:[r.jsx("span",{className:"pg-day-ex-name",children:rt.name}),r.jsx("span",{className:"pg-day-ex-target",children:rt.type==="timed"?`${at.sets}${at.time}s`:`${at.sets}${at.reps}`}),r.jsx("span",{className:`pg-day-ex-badge pg-badge-${rt.type}`,children:rt.type==="weighted"?"WT":rt.type==="timed"?"TMR":"BW"})]},Ke)})})]},De))}),r.jsxs("div",{className:"pg-overview-note",children:[r.jsx("strong",{children:"Progressive Overload:"})," +",be.repProg," reps/week",be.timeProg?`, +${be.timeProg}s/week for timed`:""]}),r.jsx("button",{className:"pg-start-btn",onClick:()=>Ct(be),children:"Start Programme"})]}),os]})})}if(x==="dashboard"){const be=Ot();if(!be)return _("browse"),null;const Ie=ms(),De=B?.completedSessions||{},rt=Ie.totalSessions?Math.round(Ie.totalCompleted/Ie.totalSessions*100):0;return Math.round(Ie.totalCompleted/(Ie.totalSessions||1)*y6),r.jsx(Sa,{children:r.jsxs("div",{className:"pg-page","data-theme":u?"dark":"light","data-accent":p,children:[ws("Programme",()=>g("/client/core-buddy/workouts")),r.jsxs("main",{className:"pg-main",children:[r.jsxs("div",{className:"pg-dash-hero",children:[r.jsxs("div",{className:"pg-dash-ring-wrap",children:[r.jsxs("svg",{viewBox:"0 0 200 200",children:[r.jsx("circle",{className:"pg-arc-track",cx:"100",cy:"100",r:"80"}),r.jsx("circle",{className:"pg-arc-fill",cx:"100",cy:"100",r:"80",strokeDasharray:2*Math.PI*80,strokeDashoffset:2*Math.PI*80-rt/100*2*Math.PI*80})]}),r.jsxs("div",{className:"pg-ring-center",children:[r.jsxs("span",{className:"pg-ring-pct",children:[rt,"%"]}),r.jsx("span",{className:"pg-ring-label",children:"complete"})]})]}),r.jsx("h2",{className:"pg-dash-name",children:be.name}),r.jsxs("div",{className:"pg-dash-progress-text",children:[r.jsxs("span",{className:"pg-dash-pct",children:[rt,"%"]}),r.jsxs("span",{className:"pg-dash-week",children:["Week ",Ie.currentWeek," of ",be.duration]})]})]}),r.jsx("div",{className:"pg-weeks",children:Array.from({length:be.duration},(Ke,at)=>{const gt=at+1,X=Gt(gt);return r.jsxs("div",{className:`pg-week-row${gt===Ie.currentWeek?" pg-week-current":""}`,children:[r.jsxs("span",{className:"pg-week-label",children:["W",gt]}),r.jsx("div",{className:"pg-week-days",children:be.days.map((se,Qe)=>{const _t=`w${gt}d${Qe}`,et=!!De[_t],kt=!et&&X,Q=!et&&!kt&&gt===Ie.currentWeek&&!Ie.complete;return r.jsx("button",{className:`pg-day-dot${et?" done":""}${kt?" missed":""}${Q?" next":""}`,disabled:!Q,onClick:()=>{Q&&us(gt,Qe)},children:et?r.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:r.jsx("path",{d:"M20 6L9 17l-5-5"})}):kt?r.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]}):r.jsx("span",{children:se.name.replace("Day ","")})},Qe)})})]},at)})}),!Ie.complete&&(()=>{const Ke=be.days.map((at,gt)=>({day:at,d:gt})).filter(({d:at})=>!De[`w${Ie.currentWeek}d${at}`]);return Ke.length===0?null:r.jsxs("div",{className:"pg-next-session",children:[r.jsx("h3",{children:Ke.length===be.daysPerWeek?"Choose a Session":"Remaining Sessions"}),r.jsxs("p",{className:"pg-next-info",children:["Week ",Ie.currentWeek,"  ",Ke.length," session",Ke.length!==1?"s":""," left this week"]}),Ke.map(({day:at,d:gt})=>r.jsxs("div",{className:"pg-available-session",children:[r.jsxs("div",{className:"pg-next-exercises",children:[r.jsxs("span",{className:"pg-avail-day-label",children:[at.name,": ",at.label]}),at.exercises.map((X,se)=>{const Qe=fh(X,Ie.currentWeek,be);return r.jsxs("div",{className:"pg-next-ex",children:[r.jsx("span",{className:"pg-next-ex-name",children:X.name}),r.jsx("span",{className:"pg-next-ex-target",children:X.type==="timed"?`${Qe.sets}${Qe.time}s`:`${Qe.sets}${Qe.reps}`})]},se)})]}),r.jsxs("button",{className:"pg-start-btn",onClick:()=>us(Ie.currentWeek,gt),children:["Start ",at.name]})]},gt))]})})(),Ie.complete&&r.jsxs("div",{className:"pg-complete-msg",children:[r.jsx("h3",{children:"Programme Complete! "}),r.jsxs("p",{children:["You finished all ",Ie.totalSessions," sessions."]}),r.jsx("button",{className:"pg-start-btn",onClick:lt,children:"Choose New Programme"})]}),r.jsx("button",{className:"pg-quit-btn",onClick:()=>{confirm("Quit this programme? Progress will be lost.")&&lt()},children:"Quit Programme"})]}),r.jsx(Ta,{active:"workouts"}),os]})})}if(x==="session"){const be=Ot();if(!be)return null;const Ie=be.days[Re],De=Ie.exercises[C],rt=fh(De,Z,be),Ke=I[C],at=Ke?.sets?.length||0,gt=Ie.exercises.length,X=(C+at/rt.sets)/gt,se=re[De.name],Qe=Pt(Z,Re,De.name);De.type==="timed"&&We===0&&!pe&&at===M&&setTimeout(()=>J(rt.time),0);const _t=()=>{se?.isGif?Ve(!qe):Me.current&&(qe?Me.current.pause():Me.current.play(),Ve(!qe))};return r.jsxs("div",{className:"pg-page pg-page-session","data-theme":u?"dark":"light","data-accent":p,children:[r.jsx("div",{className:"pg-session-progress",children:r.jsx("div",{className:"pg-session-progress-fill",style:{width:`${X*100}%`}})}),r.jsxs("div",{className:"pg-session-header",children:[r.jsx("button",{className:"pg-session-back",onClick:()=>{confirm("Leave session? Progress will be lost.")&&_("dashboard")},children:r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M19 12H5M12 5l-7 7 7 7"})})}),r.jsxs("div",{className:"pg-session-title",children:[r.jsxs("span",{className:"pg-session-counter",children:[C+1," / ",gt]}),r.jsxs("span",{className:"pg-session-week",children:["Week ",Z,"  ",Ie.name]})]})]}),se&&r.jsxs("div",{className:"pg-video-container",onClick:_t,children:[se.isGif?r.jsx("img",{className:"pg-video",src:se.url,alt:De.name}):r.jsx("video",{ref:Me,className:"pg-video",src:se.url,loop:!0,muted:!0,playsInline:!0},De.name),!qe&&r.jsxs("div",{className:"pg-video-overlay",children:[r.jsx("svg",{className:"pg-play-icon",viewBox:"0 0 24 24",fill:"white",children:r.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})}),r.jsx("span",{className:"pg-video-hint",children:"Tap for demo"})]})]}),r.jsx("div",{className:"pg-spotify",children:r.jsx("iframe",{src:"https://open.spotify.com/embed/playlist/37i9dQZF1DZ06evO3FJyYF?utm_source=generator&theme=0",width:"100%",height:"80",frameBorder:"0",allow:"autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture",loading:"lazy",title:"Spotify Playlist"})}),r.jsxs("div",{className:"pg-exercise-card",children:[r.jsx("h2",{className:"pg-ex-name",children:De.name}),r.jsx("span",{className:`pg-ex-type-badge pg-badge-${De.type}`,children:De.type==="weighted"?"Weight + Reps":De.type==="timed"?"Timed":"Reps Only"}),De.type==="weighted"&&Qe&&r.jsxs("div",{className:"pg-last-week",children:[r.jsx("span",{className:"pg-last-week-label",children:"Last week:"}),r.jsxs("span",{className:"pg-last-week-value",children:[Qe.weight,"kg x ",Qe.reps," reps"]})]}),r.jsxs("div",{className:"pg-ex-set-info",children:[r.jsxs("span",{className:"pg-ex-set-num",children:["Set ",at+1," of ",rt.sets]}),r.jsxs("span",{className:"pg-ex-target",children:["Target: ",De.type==="timed"?`${rt.time}s hold`:`${rt.reps} reps`]})]}),De.type==="weighted"&&r.jsxs("div",{className:"pg-input-area",children:[r.jsxs("div",{className:"pg-input-group",children:[r.jsx("label",{children:"Weight (kg)"}),r.jsx("input",{type:"number",inputMode:"decimal",value:A,onChange:et=>Le(et.target.value),placeholder:"0",className:"pg-input"})]}),r.jsxs("div",{className:"pg-input-group",children:[r.jsx("label",{children:"Reps"}),r.jsx("input",{type:"number",inputMode:"numeric",value:ht,onChange:et=>$(et.target.value),placeholder:String(rt.reps),className:"pg-input"})]})]}),De.type==="reps"&&r.jsx("div",{className:"pg-input-area",children:r.jsxs("div",{className:"pg-input-group pg-input-single",children:[r.jsx("label",{children:"Reps"}),r.jsx("input",{type:"number",inputMode:"numeric",value:ht,onChange:et=>$(et.target.value),placeholder:String(rt.reps),className:"pg-input"})]})}),De.type==="timed"&&r.jsxs("div",{className:"pg-timer-area",children:[r.jsx("div",{className:"pg-timer-display",children:r.jsxs("span",{className:"pg-timer-value",children:[We,"s"]})}),pe?r.jsx("button",{className:"pg-timer-btn pg-timer-stop",onClick:()=>Be(!1),children:"Stop"}):r.jsx("button",{className:"pg-timer-btn",onClick:()=>{We===0&&J(rt.time),Be(!0)},children:We<rt.time&&We>0?"Resume":"Start Timer"})]}),r.jsx("button",{className:"pg-log-set-btn",onClick:xs,disabled:De.type==="timed"&&pe,children:at+1<rt.sets?"Log Set":C+1<gt?"Log Set  Next Exercise":"Log Set  Complete"}),Ke?.sets?.length>0&&r.jsx("div",{className:"pg-completed-sets",children:Ke.sets.map((et,kt)=>r.jsxs("div",{className:"pg-completed-set",children:[r.jsx("span",{className:"pg-completed-set-check",children:""}),r.jsxs("span",{children:["Set ",kt+1,": ",et.weight!==void 0?`${et.weight}kg  ${et.reps}`:et.time!==void 0?`${et.time}s`:`${et.reps} reps`]})]},kt))})]}),te&&(()=>{const kt=Ot()?.days[Re],Q=I.reduce((yt,it)=>yt+it.sets.length,0),Ae=I.reduce((yt,it)=>yt+it.sets.reduce((Jt,Yt)=>Jt+(Yt.weight||0)*(Yt.reps||0),0),0),Je=[{value:I.length,label:"Exercises"},{value:Q,label:"Sets"}];return Ae>0&&Je.push({value:Math.round(Ae).toLocaleString(),label:"Volume (kg)"}),r.jsx(em,{title:"Session Complete!",subtitle:`Week ${Z}  ${kt?.name}: ${kt?.label}`,stats:Je,buttonLabel:"Back to Programme",hideShare:!l,onShareJourney:t?oe:null,userName:t?.name,onDismissStart:()=>_("dashboard"),onDone:()=>{Y(!1)}})})(),mt&&r.jsx("div",{className:"pg-badge-celebration",onClick:()=>wt(null),children:r.jsxs("div",{className:"pg-badge-celebration-card",onClick:et=>et.stopPropagation(),children:[r.jsx("div",{className:"pg-badge-celebration-icon",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),r.jsx("h3",{className:"pg-badge-celebration-title",children:mt.badges.length===1?"Badge Earned!":`${mt.badges.length} Badges Earned!`}),r.jsx("div",{className:"pg-badge-celebration-list",children:mt.badges.map((et,kt)=>r.jsx("div",{className:"pg-badge-celebration-item",children:et.type==="pb_target"?`${et.exercise}  ${et.targetWeight}kg`:et.label},kt))}),r.jsxs("div",{className:"pg-badge-share-row",children:[r.jsxs("button",{className:"pg-badge-share-btn",onClick:async et=>{et.stopPropagation();const kt=mt.badges[0],Q=mt.badges.map(Je=>Je.type==="pb_target"?`PB Target Hit: ${Je.exercise}  ${Je.targetWeight}kg`:Je.label),Ae=Bn.find(Je=>Je.id===kt?.id)||Bn.find(Je=>Je.name===kt?.label);await oe({type:"badge_earned",title:Q.length===1?Q[0]:`${Q.length} Badges Earned!`,badges:Q,badgeDesc:Ae?.desc}),Tt("Posted to Journey!","success")},children:[r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M12 20h9"}),r.jsx("path",{d:"M16.5 3.5a2.121 2.121 0 1 1 3 3L7 19l-4 1 1-4Z"})]}),"Journey"]}),r.jsxs("button",{className:"pg-badge-share-btn",onClick:async et=>{et.stopPropagation();const kt=mt.badges[0],Q=mt.badges.map(yt=>yt.type==="pb_target"?`PB Target Hit: ${yt.exercise}  ${yt.targetWeight}kg`:yt.label),Ae=Bn.find(yt=>yt.id===kt?.id)||Bn.find(yt=>yt.name===kt?.label),Je=`Badge Earned! ${Q.join(", ")}
#MindCoreFitness`;try{const yt=await nb({type:"badge",title:Q.length===1?Q[0]:"Badges Earned!",badges:Q,badgeImage:Ae?.img,badgeDesc:Ae?.desc});navigator.share&&navigator.canShare?.({files:[new File([yt],"badge.png",{type:"image/png"})]})?await navigator.share({title:"Mind Core Fitness",text:Je,files:[new File([yt],"badge.png",{type:"image/png"})]}):navigator.share?await navigator.share({title:"Mind Core Fitness",text:Je}):(await navigator.clipboard.writeText(Je),Tt("Copied!","success"))}catch{try{await navigator.clipboard.writeText(Je),Tt("Copied!","success")}catch{}}},children:[r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("circle",{cx:"18",cy:"5",r:"3"}),r.jsx("circle",{cx:"6",cy:"12",r:"3"}),r.jsx("circle",{cx:"18",cy:"19",r:"3"}),r.jsx("line",{x1:"8.59",y1:"13.51",x2:"15.42",y2:"17.49"}),r.jsx("line",{x1:"15.41",y1:"6.51",x2:"8.59",y2:"10.49"})]}),"Share"]})]}),r.jsx("button",{className:"pg-badge-celebration-dismiss",onClick:()=>wt(null),children:"Tap to dismiss"})]})}),os]})}return null}const _6={"Dumbbell Floor Press":"push","Seated Dumbbell Shoulder Press":"push","Seated Dumbbell Arnold Press":"push","Dumbbell Overhead Tricep Extension":"push",Skullcrushers:"push","Dumbbell Lateral Raise":"push","Dumbbell Front Raise":"push","Dumbbell Bent Over Row":"pull","Single Arm Bent Over Row":"pull","Bicep Curl":"pull","Hammer Curl":"pull","Dumbbell Bent Over Rear Delt Fly":"pull","Renegade Row":"pull","Dumbbell Goblet Squats":"lower","Romanian Deadlifts":"lower","Forward Dumbbell Lunges":"lower","Dumbbell Sumo Squats":"lower","Weighted Calf Raises":"lower","1 Legged RDL":"lower","Dumbbell Box Step Ups":"lower","Dumbbell Squat Pulses":"lower","Dumbbell Reverse Lunges":"lower","Kettlebell Romanian Deadlift":"lower","Russian Twists Dumbbell":"core","Kettlebell Russian Twist":"core","Kettlebell Side Bends":"core","Kneeling Kettlebell Halo":"core"},k6={push:{label:"Push",color:"#c75f6b",icon:"M4 12h3l3-9 4 18 3-9h3"},pull:{label:"Pull",color:"#5f8ac7",icon:"M12 2v10m0 0l-4-4m4 4l4-4M4 20h16"},lower:{label:"Lower",color:"#5fc77a",icon:"M12 2v8m-4 4l4 8 4-8m-8 0h8"},core:{label:"Core",color:"#c7a45f",icon:"M12 2a4 4 0 014 4v1h-2V6a2 2 0 10-4 0v1H8V6a4 4 0 014-4zM8 9h8v2H8V9zm-1 4h10l-1 9H8l-1-9z"}},eg=[{threshold:1e3,label:"1 Tonne",icon:"1T"},{threshold:5e3,label:"5 Tonne",icon:"5T"},{threshold:1e4,label:"10 Tonne",icon:"10T"},{threshold:25e3,label:"25 Tonne",icon:"25T"},{threshold:5e4,label:"50 Tonne",icon:"50T"},{threshold:1e5,label:"100 Tonne",icon:"100T"},{threshold:25e4,label:"250 Tonne",icon:"250T"},{threshold:5e5,label:"500 Tonne",icon:"500T"},{threshold:1e6,label:"1 Million kg",icon:"1M"}];function j6(n){return _6[n]||"push"}function T6(n){return n>=1e6?`${(n/1e6).toFixed(1)}M`:n>=1e3?`${(n/1e3).toFixed(1)}T`:`${Math.round(n)}`}function S6(n){return n>=1e6?"million kg":n>=1e3?"tonnes":"kg"}function E6(){const{currentUser:n,isClient:e,clientData:t,loading:i}=Ir(),{isDark:l,toggleTheme:u,accent:d}=Ca(),p=tr(),[g,y]=b.useState(!0),[x,_]=b.useState(null),[j,O]=b.useState({}),[K,B]=b.useState([]),[D,te]=b.useState(null),[Y,Z]=b.useState(0),[ke,Re]=b.useState({});b.useRef(null),b.useEffect(()=>{!i&&(!n||!e)&&p("/")},[n,e,i,p]),b.useEffect(()=>{if(!t)return;(async()=>{try{const[pe,Be,We,J]=await Promise.all([Is(Xe(ge,"coreBuddyAchievements",t.id)),Is(Xe(ge,"coreBuddyPBs",t.id)),Is(Xe(ge,"achievements",t.id)),Ts(As(Ht(ge,"workoutLogs"),gs("clientId","==",t.id)))]);pe.exists()&&_(pe.data()),Be.exists()&&O(Be.data().exercises||{}),We.exists()&&(B(Object.keys(We.data().badges||{})),Re(We.data().progress||{})),Z(J.docs.length)}catch(pe){console.error("Error loading achievements:",pe)}y(!1)})()},[t]);const _e=x?.badges||[],C=x?.totalVolume||0,T=_e.filter($=>$.type==="pb_target"),M=_e.filter($=>$.type==="volume_milestone"),V={push:[],pull:[],lower:[],core:[]};T.forEach($=>{const pe=$.group||j6($.exercise);V[pe]&&V[pe].push($)});const I=eg.find($=>C<$.threshold),L=eg.filter($=>C>=$.threshold).pop()?.threshold||0,A=I?(C-L)/(I.threshold-L):1;if(i||g)return r.jsxs("div",{className:"ach-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsx("div",{className:"header-content",children:r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})})}),r.jsx("div",{className:"ach-loading-inline",children:r.jsx("div",{className:"cb-loading-spinner"})})]});const Le=_e.length+K.length,ht=Le>0||C>0||Y>0;return r.jsx(Sa,{children:r.jsxs("div",{className:"ach-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),r.jsxs("main",{className:"ach-main",children:[r.jsx("button",{className:"nut-back-btn",onClick:()=>p("/client/personal-bests?mode=corebuddy"),children:" Back"}),r.jsxs("div",{className:"ach-stats-banner",children:[r.jsxs("div",{className:"ach-stat-item",children:[r.jsx("span",{className:"ach-stat-num",children:Le}),r.jsx("span",{className:"ach-stat-label",children:Le===1?"Badge":"Badges"})]}),r.jsx("div",{className:"ach-stat-divider"}),r.jsxs("div",{className:"ach-stat-item",children:[r.jsx("span",{className:"ach-stat-num",children:T6(C)}),r.jsxs("span",{className:"ach-stat-label",children:[S6(C)," lifted"]})]}),r.jsx("div",{className:"ach-stat-divider"}),r.jsxs("div",{className:"ach-stat-item",children:[r.jsx("span",{className:"ach-stat-num",children:Object.keys(j).length}),r.jsx("span",{className:"ach-stat-label",children:"PBs"})]})]}),!ht&&r.jsxs("div",{className:"ach-empty",children:[r.jsx("div",{className:"ach-empty-icon",children:r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[r.jsx("path",{d:"M12 15l-3-3h6l-3 3z"}),r.jsx("path",{d:"M5 7h14l-1.5 9h-11L5 7z"}),r.jsx("path",{d:"M8.5 7V5a3.5 3.5 0 017 0v2"})]})}),r.jsx("h4",{children:"No achievements yet"}),r.jsx("p",{children:"Complete workouts to track volume and set PB targets to start earning badges."})]}),[{key:"workouts",title:"Workout Badges",iconPath:"M20.57 14.86L22 13.43 20.57 12 17 15.57 8.43 7 12 3.43 10.57 2 9.14 3.43 7.71 2 5.57 4.14 4.14 2.71 2.71 4.14l1.43 1.43L2 7.71l1.43 1.43L2 10.57 3.43 12 7 8.43 15.57 17 12 20.57 13.43 22l1.43-1.43L16.29 22l2.14-2.14 1.43 1.43 1.43-1.43-1.43-1.43L22 16.29z"},{key:"streaks",title:"Streak Badges",iconPath:"M13.5.67s.74 2.65.74 4.8c0 2.06-1.35 3.73-3.41 3.73-2.07 0-3.63-1.67-3.63-3.73l.03-.36C5.21 7.51 4 10.62 4 14c0 4.42 3.58 8 8 8s8-3.58 8-8C20 8.61 17.41 3.8 13.5.67z"},{key:"pbs",title:"Personal Best Badges",iconPath:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"},{key:"nutrition",title:"Nutrition Badges",iconPath:"M18.06 23h1.66c.84 0 1.53-.65 1.63-1.47L23 5.05h-5V1h-2v4.05h-5l.3 2.34c1.71.47 3.31 1.32 4.27 2.26 1.44 1.42 2.43 2.89 2.43 5.29V23zM1 22v-1h15.03v1c0 .55-.45 1-1.01 1H2.01c-.56 0-1.01-.45-1.01-1zm15.03-7c0-4.87-4.66-5.84-8.03-5.97l.72 5.52L1 15.05v5.95h15.03V15z"},{key:"habits",title:"Habit Badges",iconPath:"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z"},{key:"leaderboard",title:"Leaderboard Badges",iconPath:"M7.5 21H2V9h5.5v12zm7.25-18h-5.5v18h5.5V3zM22 11h-5.5v10H22V11z"}].map($=>{const pe=Bn.filter(J=>J.category===$.key);if(pe.length===0)return null;const Be=(()=>{switch($.key){case"workouts":return Y;case"streaks":return ke.streakWeeks||0;case"pbs":return Object.keys(j).length;case"nutrition":return ke.nutritionStreak||0;case"leaderboard":return t?.leaderboardOptIn?1:0;case"habits":return ke.habitStreak||0;default:return 0}})(),We=pe.filter(J=>K.includes(J.id)).length;return r.jsxs("div",{className:"ach-section",children:[r.jsxs("h3",{className:"ach-section-title",children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20",children:r.jsx("path",{d:$.iconPath})}),$.title]}),r.jsx("div",{className:"ach-workout-carousel",children:pe.map(J=>{const P=K.includes(J.id);return r.jsxs("button",{className:`ach-workout-badge${P?" unlocked":" locked"}`,onClick:()=>te(J),children:[r.jsx("img",{src:J.img,alt:J.name,className:"ach-workout-badge-img"}),!P&&J.threshold&&r.jsx("div",{className:"ach-workout-badge-progress",children:r.jsx("div",{className:"ach-workout-badge-progress-fill",style:{width:`${Math.min(Be/J.threshold*100,100)}%`}})})]},J.id)})}),r.jsxs("p",{className:"ach-workout-badges-count",children:[We,"/",pe.length," unlocked"]})]},$.key)}),D&&r.jsx("div",{className:"ach-badge-overlay",onClick:()=>te(null),children:r.jsxs("div",{className:"ach-badge-overlay-content",onClick:$=>$.stopPropagation(),children:[r.jsx("img",{src:D.img,alt:D.name,className:`ach-badge-overlay-img${K.includes(D.id)?"":" ach-badge-overlay-img-locked"}`}),r.jsx("p",{className:"ach-badge-overlay-desc",children:D.desc}),K.includes(D.id)?r.jsx("span",{className:"ach-badge-overlay-status unlocked",children:"Unlocked"}):r.jsx("span",{className:"ach-badge-overlay-status locked",children:"Locked"}),r.jsx("button",{className:"ach-badge-overlay-close",onClick:()=>te(null),children:"Tap to close"})]})}),r.jsxs("div",{className:"ach-section",children:[r.jsxs("h3",{className:"ach-section-title",children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20",children:r.jsx("path",{d:"M20.57 14.86L22 13.43 20.57 12 17 15.57 8.43 7 12 3.43 10.57 2 9.14 3.43 7.71 2 5.57 4.14 4.14 2.71 2.71 4.14l1.43 1.43L2 7.71l1.43 1.43L2 10.57 3.43 12 7 8.43 15.57 17 12 20.57 13.43 22l1.43-1.43L16.29 22l2.14-2.14 1.43 1.43 1.43-1.43-1.43-1.43L22 16.29z"})}),"Volume Milestones"]}),r.jsxs("div",{className:"ach-volume-hero",children:[r.jsxs("div",{className:"ach-volume-ring",children:[r.jsx("svg",{className:"ach-volume-ring-svg",viewBox:"0 0 200 200",children:Yk.map(($,pe)=>{const Be=pe<Math.round(A*60);return r.jsx("line",{x1:$.x1,y1:$.y1,x2:$.x2,y2:$.y2,className:Be?"ach-tick-filled":"ach-tick-empty",strokeWidth:$.thick?"3":"2"},pe)})}),r.jsxs("div",{className:"ach-volume-center",children:[r.jsx("span",{className:"ach-volume-number",children:Math.round(C).toLocaleString()}),r.jsx("span",{className:"ach-volume-unit",children:"kg lifted"})]})]}),I&&r.jsxs("div",{className:"ach-volume-next",children:["Next: ",r.jsx("strong",{children:I.label})," (",(I.threshold-C).toLocaleString(),"kg to go)"]})]}),r.jsx("div",{className:"ach-milestone-shelf",children:eg.map(($,pe)=>{const Be=C>=$.threshold,We=M.find(J=>J.milestone===$.threshold);return r.jsxs("div",{className:`ach-milestone ${Be?"unlocked":"locked"}`,children:[r.jsx("div",{className:"ach-milestone-hex",children:r.jsx("span",{className:"ach-milestone-icon",children:$.icon})}),r.jsx("span",{className:"ach-milestone-label",children:$.label}),We?.achievedAt&&r.jsx("span",{className:"ach-milestone-date",children:(We.achievedAt.toDate?We.achievedAt.toDate():new Date(We.achievedAt)).toLocaleDateString("en-GB",{day:"numeric",month:"short"})})]},pe)})})]}),r.jsxs("div",{className:"ach-section",children:[r.jsxs("h3",{className:"ach-section-title",children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),"PB Target Badges"]}),T.length===0?r.jsx("div",{className:"ach-pb-empty",children:r.jsxs("p",{children:["Set targets on your personal bests to start earning badges. Go to ",r.jsx("strong",{children:"My Progress"}),' and tap "Set Target" on any PB.']})}):Object.entries(V).map(([$,pe])=>{if(pe.length===0)return null;const Be=k6[$];return r.jsxs("div",{className:"ach-group",children:[r.jsxs("div",{className:"ach-group-header",style:{borderLeftColor:Be.color},children:[r.jsx("span",{className:"ach-group-label",style:{color:Be.color},children:Be.label}),r.jsx("span",{className:"ach-group-count",children:pe.length})]}),r.jsx("div",{className:"ach-badge-grid",children:pe.map((We,J)=>r.jsxs("div",{className:"ach-badge-card",style:{animationDelay:`${J*.06}s`,"--group-color":Be.color},children:[r.jsx("div",{className:"ach-badge-hex",style:{borderColor:Be.color,boxShadow:`0 0 12px ${Be.color}33`},children:r.jsx("svg",{className:"ach-badge-hex-icon",viewBox:"0 0 24 24",fill:"none",stroke:Be.color,strokeWidth:"2",strokeLinecap:"round",children:r.jsx("path",{d:Be.icon})})}),r.jsxs("div",{className:"ach-badge-info",children:[r.jsx("span",{className:"ach-badge-exercise",children:We.exercise}),r.jsxs("span",{className:"ach-badge-value",style:{color:Be.color},children:[We.targetWeight,"kg"]}),We.achievedAt&&r.jsx("span",{className:"ach-badge-date",children:(We.achievedAt.toDate?We.achievedAt.toDate():new Date(We.achievedAt)).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"})})]})]},J))})]},$)})]})]}),r.jsx(Ta,{active:"home"})]})})}const N6=[{key:"trained",label:"Trained",icon:"M4 10v4M8 7v10M8 12h8M16 7v10M20 10v4",color:"#A12F3A",darkColor:"#E8475A"},{key:"protein",label:"Hit Protein",icon:"M12 22c5.52 0 10-4.48 10-10S17.52 2 12 2 2 6.48 2 12s4.48 10 10 10zM12 18c3.31 0 6-2.69 6-6s-2.69-6-6-6-6 2.69-6 6 2.69 6 6 6zM12 14a2 2 0 1 0 0-4 2 2 0 0 0 0 4z",color:"#4caf50",darkColor:"#5CDB61"},{key:"steps",label:"10k Steps",icon:"M4 19.5A2.5 2.5 0 0 1 6.5 17H20M4 12.5A2.5 2.5 0 0 1 6.5 10H20M4 5.5A2.5 2.5 0 0 1 6.5 3H20",color:"#ff9800",darkColor:"#FFB020"},{key:"sleep",label:"8hrs Sleep",icon:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z",color:"#7c3aed",darkColor:"#9B5AF2"},{key:"water",label:"2L Water",icon:"M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z",color:"#2196f3",darkColor:"#42A5F5"}],C6="M12 2l2.4 7.2L22 12l-7.6 2.8L12 22l-2.4-7.2L2 12l7.6-2.8z",R6="#e91e63",A6="#FF4D88",M6=700,Og=42,zl=2*Math.PI*Og,ph=["Every day counts. See you tomorrow!","Consistency is your superpower.","Perfect day  keep the streak alive!","You showed up for yourself today."];function I6(n){const e=new Date(n),t=e.getDay(),i=t===0?-6:1-t;return e.setDate(e.getDate()+i),e.setHours(0,0,0,0),e}function Ho(n){return n.toISOString().split("T")[0]}function D6(n){return Array.from({length:7},(e,t)=>{const i=new Date(n);return i.setDate(n.getDate()+t),i})}function P6(){const{currentUser:n,isClient:e,clientData:t,loading:i}=Ir(),{isDark:l,toggleTheme:u,accent:d}=Ca(),{isPremium:p,FREE_HABIT_LIMIT:g}=yc(),y=tr(),[x,_]=b.useState({}),[j,O]=b.useState([]),[K,B]=b.useState(!0),[D,te]=b.useState(!1),[Y,Z]=b.useState(0),[ke,Re]=b.useState(null),[_e,C]=b.useState(null),[T,M]=b.useState(!1),[V,I]=b.useState(!1),[L,A]=b.useState(!1),[Le,ht]=b.useState(!1),[$,pe]=b.useState(""),[Be,We]=b.useState(null),[J,P]=b.useState([]),[re,Fe]=b.useState(null),qe=b.useRef(null),Ve=b.useRef(null),Me=b.useRef(null),mt=b.useRef(null),wt=b.useRef(!1),ot=b.useRef({}),es=b.useRef([]),Ns=b.useRef([]),Ft=b.useRef(null),Tt=b.useRef(ph[Math.floor(Math.random()*ph.length)]),oe=b.useCallback((Q,Ae="info")=>{Re({message:Q,type:Ae}),setTimeout(()=>Re(null),3e3)},[]),Dt=new Date,Nt=Ho(Dt),Kt=I6(Dt),Et=D6(Kt),Ct=["M","T","W","T","F","S","S"],lt=(Q,Ae)=>l&&Ae?Ae:Q,Ot=[...N6.filter(Q=>!J.includes(Q.key)).map(Q=>({...Q,color:lt(Q.color,Q.darkColor)})),...j.map(Q=>({key:`custom_${Q.id}`,label:Q.label,icon:C6,color:lt(R6,A6),isCustom:!0,id:Q.id}))],Wt=p?Ot:Ot.slice(0,g);b.useEffect(()=>{!i&&(!n||!e)&&y("/")},[n,e,i,y]),b.useEffect(()=>{if(!n||!t)return;(async()=>{try{const Ae=Ht(ge,"habitLogs"),Je=As(Ae,gs("clientId","==",t.id)),yt=await Ts(Je),it={};yt.docs.forEach(ye=>{const Ee=ye.data();it[Ee.date]={...Ee,_id:ye.id}}),_(it);const Jt=await Is(Xe(ge,"customHabits",t.id));if(Jt.exists()){const ye=Jt.data();O(ye.habits||[]),P(ye.hiddenDefaults||[])}let Yt=0;const F=new Date(Dt);for(;;){const ye=Ho(F),Ee=it[ye];if(Ee)if(Object.values(Ee.habits||{}).filter(Boolean).length>=3)Yt++,F.setDate(F.getDate()-1);else break;else if(ye===Nt)F.setDate(F.getDate()-1);else break}Z(Yt)}catch(Ae){console.error("Error loading habit logs:",Ae)}finally{B(!1)}})()},[n,t]);const ms=x[Nt]||{habits:{}};b.useEffect(()=>{Object.values(ms.habits||{}).filter(Boolean).length<Wt.length&&L&&A(!1)},[Wt.length,ms.habits]);const Gt=async Q=>{if(!(!n||D||ms.habits?.[Q])){es.current=[...Array(10)].map((Je,yt)=>{const it=yt/10*2*Math.PI,Jt=18+Math.random()*20;return{tx:Math.cos(it)*Jt,ty:Math.sin(it)*Jt,size:3+Math.random()*4,duration:.4+Math.random()*.3}}),C(Q),setTimeout(()=>C(null),700),navigator.vibrate&&navigator.vibrate(50),te(!0);try{const yt={...ms.habits||{},[Q]:!0},it=ms._id||`${t.id}_${Nt}`;_(Yt=>({...Yt,[Nt]:{clientId:t.id,date:Nt,habits:yt,_id:it}})),await Ds(Xe(ge,"habitLogs",it),{clientId:t.id,date:Nt,habits:yt}),Object.values(yt).filter(Boolean).length===Wt.length&&!L&&(Tt.current=ph[Math.floor(Math.random()*ph.length)],Ns.current=[...Array(80)].map((Yt,F)=>({x:5+Math.random()*90,delay:Math.random()*3.5,color:["#A12F3A","#4caf50","#ff9800","#2196f3","#e91e63","#ffeb3b","#FFD700","#ffffff","#9c27b0"][F%9],drift:(Math.random()-.5)*120,spin:Math.random()*720-360,duration:1.8+Math.random()*2,width:4+Math.random()*6,height:4+Math.random()*8,shape:F%3})),setTimeout(()=>{M(!0),A(!0),setTimeout(()=>Ft.current?.focus(),1100)},400))}catch(Je){console.error("Error saving habit:",Je),oe("Failed to save. Try again.","error"),_(yt=>({...yt,[Nt]:{...yt[Nt],habits:{...yt[Nt]?.habits||{},[Q]:!1}}}))}finally{te(!1)}}},Pt=async Q=>{if(!(!n||D)){te(!0);try{const Je={...ms.habits||{},[Q]:!1},yt=ms._id||`${t.id}_${Nt}`;await Ds(Xe(ge,"habitLogs",yt),{clientId:t.id,date:Nt,habits:Je}),_(it=>({...it,[Nt]:{clientId:t.id,date:Nt,habits:Je,_id:yt}}))}catch(Ae){console.error("Error undoing habit:",Ae),oe("Failed to undo. Try again.","error")}finally{te(!1)}}},us=Q=>{if(ms.habits?.[Q]||!1||D||mt.current)return;mt.current=Q,Fe(Q),Ve.current=performance.now();const Je=ot.current[Q];Je&&(Je.style.strokeDashoffset=zl);const yt=it=>{const Jt=it-Ve.current,Yt=Math.min(Jt/M6,1),F=ot.current[Q];F&&(F.style.strokeDashoffset=zl-Yt*zl),Yt<1?Me.current=requestAnimationFrame(yt):(mt.current=null,wt.current=!0,Me.current=null,Fe(null),Gt(Q))};Me.current=requestAnimationFrame(yt)},xs=()=>{if(!mt.current)return;const Q=mt.current;mt.current=null,Me.current&&(cancelAnimationFrame(Me.current),Me.current=null),qe.current&&(clearTimeout(qe.current),qe.current=null),ot.current[Q]&&(ot.current[Q].style.strokeDashoffset=zl),Fe(null),Ve.current=null};b.useEffect(()=>()=>{Me.current&&cancelAnimationFrame(Me.current),qe.current&&clearTimeout(qe.current)},[]);const is=b.useCallback(async Q=>{if(!t)throw new Error("Not signed in");const Ae=Q&&typeof Q=="object"&&Q.type;await Gr(Ht(ge,"posts"),{authorId:t.id,authorName:t.name||"Unknown",authorPhotoURL:t.photoURL||null,content:Ae?"":Q,type:Ae?Q.type:"text",imageURL:null,createdAt:yr(),likeCount:0,commentCount:0,...Ae?{metadata:{title:Q.title||"",subtitle:Q.subtitle||"",stats:Q.stats||[],quote:Q.quote||"",badges:Q.badges||[]}}:{}})},[t]),Qs=async()=>{const Q=$.trim();if(!Q)return;if(!t?.id){oe("Still loading, try again","error");return}const Ae=Date.now().toString(36),Je=[...j,{id:Ae,label:Q}];try{await Ds(Xe(ge,"customHabits",t.id),{clientId:t.id,habits:Je,hiddenDefaults:J},{merge:!0}),O(Je),pe(""),ht(!1),oe(`Added "${Q}"`,"success")}catch(yt){console.error("Error adding custom habit:",yt),oe(yt?.code==="permission-denied"?"Permission denied  check Firestore rules for customHabits":`Failed to add habit: ${yt?.message||"Unknown error"}`,"error")}},Ms=async Q=>{if(!t?.id)return;const Ae=j.filter(Je=>Je.id!==Q);try{await Ds(Xe(ge,"customHabits",t.id),{clientId:t.id,habits:Ae,hiddenDefaults:J},{merge:!0}),O(Ae),We(null),oe("Habit removed","success")}catch(Je){console.error("Error deleting habit:",Je),oe("Failed to remove","error")}},Fs=async Q=>{if(!t?.id)return;const Ae=[...J,Q];try{await Ds(Xe(ge,"customHabits",t.id),{clientId:t.id,habits:j,hiddenDefaults:Ae},{merge:!0}),P(Ae),We(null),oe("Habit removed","success")}catch(Je){console.error("Error hiding default habit:",Je),oe("Failed to remove","error")}},os=Et.map(Q=>{const Ae=Ho(Q),Je=x[Ae],yt=Je?Object.values(Je.habits||{}).filter(Boolean).length:0;return{date:Q,dateStr:Ae,completed:yt,total:Wt.length}}),ws=os.reduce((Q,Ae)=>Q+Ae.completed,0),be=os.reduce((Q,Ae)=>Q+Ae.total,0),Ie=be>0?Math.round(ws/be*100):0,De=Object.values(ms.habits||{}).filter(Boolean).length,rt=Wt.length>0?Math.round(De/Wt.length*100):0,Ke=De===Wt.length&&Wt.length>0,at=(()=>{const Q=Object.keys(x).sort();let Ae=0,Je=0,yt=null;for(const it of Q){const Jt=x[it];if(Object.values(Jt.habits||{}).filter(Boolean).length>=3){if(yt){const F=new Date(yt);Je=(new Date(it)-F)/(1e3*60*60*24)===1?Je+1:1}else Je=1;Je>Ae&&(Ae=Je),yt=it}else Je=0,yt=null}return Math.max(Ae,Y)})(),gt=new Date(Dt.getFullYear(),Dt.getMonth(),1),X=gt.toLocaleString("default",{month:"long"}),se=new Date(Dt.getFullYear(),Dt.getMonth()+1,0).getDate(),Qe=(gt.getDay()+6)%7,_t=Array.from({length:se},(Q,Ae)=>{const Je=new Date(Dt.getFullYear(),Dt.getMonth(),Ae+1),yt=Ho(Je),it=x[yt],Jt=it?Object.values(it.habits||{}).filter(Boolean).length:0,Yt=Je>Dt;return{day:Ae+1,dateStr:yt,completed:Jt,total:Wt.length,isFuture:Yt,isToday:yt===Nt}}),et=Wt.map(Q=>({...Q,days:Et.map(Ae=>{const Je=Ho(Ae);return x[Je]?.habits?.[Q.key]||!1})})),kt=os.filter(Q=>Q.completed===Q.total&&Q.total>0).length;return r.jsx(Sa,{children:r.jsxs("div",{className:"cbc-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>y("/client/core-buddy"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),i||K?r.jsx("div",{className:"cbc-loading-inline",children:r.jsx("div",{className:"cbc-loading-spinner"})}):r.jsxs("main",{className:"cbc-main",children:[r.jsxs("div",{className:"cbc-hero anim-fade-up",children:[r.jsxs("div",{className:`cbc-progress-ring${Ke?" cbc-ring-complete":""}`,children:[r.jsxs("svg",{viewBox:"0 0 200 200",children:[r.jsx("circle",{className:"cbc-arc-track",cx:"100",cy:"100",r:"80"}),r.jsx("circle",{className:"cbc-arc-fill",cx:"100",cy:"100",r:"80",strokeDasharray:2*Math.PI*80,strokeDashoffset:2*Math.PI*80-rt/100*2*Math.PI*80})]}),r.jsxs("div",{className:"cbc-ring-center",children:[r.jsxs("span",{className:"cbc-ring-count",children:[De,r.jsx("span",{className:"cbc-ring-divider",children:"/"}),Wt.length]}),r.jsx("span",{className:"cbc-ring-label",children:Ke?"complete":"today"})]})]}),r.jsx("p",{className:"cbc-hero-tagline",children:Ke?"You showed up for yourself today.":De===0?"Start your day strong.":`${Wt.length-De} to go  keep pushing.`})]}),r.jsxs("div",{className:"cbc-streak-card anim-fade-up-d1",children:[r.jsx("div",{className:"cbc-streak-icon",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M13 2L3 14h9l-1 8 10-12h-9l1-8z"})})}),r.jsxs("div",{className:"cbc-streak-info",children:[r.jsx("span",{className:"cbc-streak-count",children:Y}),r.jsx("span",{className:"cbc-streak-label",children:"day streak"})]}),r.jsxs("div",{className:"cbc-streak-best",children:[r.jsx("span",{className:"cbc-streak-best-val",children:at}),r.jsx("span",{className:"cbc-streak-best-label",children:"best"})]})]}),r.jsxs("div",{className:"cbc-section anim-fade-up-d2",children:[r.jsx("h2",{className:"cbc-section-title",children:"Today's Habits"}),r.jsxs("div",{className:"cbc-habits-grid",children:[Wt.map(Q=>{const Ae=ms.habits?.[Q.key]||!1,Je=_e===Q.key,yt=re===Q.key;return r.jsxs("div",{className:`cbc-habit-tile ${Ae?"cbc-habit-done":""} ${Je?"cbc-habit-just-checked":""}`,style:{"--habit-color":Q.color},children:[p&&r.jsx("button",{className:"cbc-habit-delete",onClick:it=>{it.stopPropagation(),We(Q.isCustom?{type:"custom",id:Q.id,label:Q.label}:{type:"default",key:Q.key,label:Q.label})},"aria-label":`Remove ${Q.label}`,children:r.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:[r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})}),r.jsxs("div",{className:`cbc-habit-ring-touch ${yt?"cbc-holding":""} ${Ae?"cbc-ring-completed":""}`,onPointerDown:it=>{Ae||(it.preventDefault(),us(Q.key))},onPointerUp:xs,onPointerLeave:xs,onPointerCancel:xs,onClick:it=>{if(it.stopPropagation(),wt.current){wt.current=!1;return}Ae&&Pt(Q.key)},role:"button",tabIndex:0,"aria-label":Ae?`Undo ${Q.label}`:`Press and hold to complete ${Q.label}`,onKeyDown:it=>{(it.key==="Enter"||it.key===" ")&&(it.preventDefault(),Ae?Pt(Q.key):Gt(Q.key))},children:[r.jsxs("svg",{className:"cbc-habit-ring-svg",viewBox:"0 0 100 100",children:[r.jsx("circle",{className:"cbc-habit-ring-track",cx:"50",cy:"50",r:Og}),r.jsx("circle",{className:"cbc-habit-ring-fill",ref:it=>{it&&(ot.current[Q.key]=it)},cx:"50",cy:"50",r:Og,style:{stroke:Q.color,strokeDasharray:zl,strokeDashoffset:Ae?0:zl}})]}),Ae&&r.jsx("div",{className:"cbc-habit-glow-orb",style:{"--habit-color":Q.color}}),r.jsx("div",{className:"cbc-habit-ring-icon",style:{color:Q.color},children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:Q.icon})})}),Je&&r.jsx("div",{className:"cbc-particles",children:es.current.map((it,Jt)=>r.jsx("span",{className:"cbc-particle",style:{"--tx":`${it.tx}px`,"--ty":`${it.ty}px`,"--size":`${it.size}px`,"--particle-color":Q.color,animationDuration:`${it.duration}s`}},Jt))})]}),r.jsx("span",{className:"cbc-habit-label",children:Q.label}),Ae?r.jsx("span",{className:"cbc-habit-done-tag",children:"Done"}):r.jsx("span",{className:"cbc-habit-hold-hint",children:"Hold to complete"})]},Q.key)}),p?r.jsxs("div",{className:"cbc-habit-tile cbc-add-tile",onClick:()=>ht(!0),role:"button",tabIndex:0,children:[r.jsx("div",{className:"cbc-add-ring",children:r.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),r.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})}),r.jsx("span",{className:"cbc-habit-label",children:"Add Habit"}),r.jsx("span",{className:"cbc-habit-hold-hint",children:"Your own"})]}):r.jsxs("div",{className:"cbc-habit-tile cbc-unlock-tile",onClick:()=>y("/upgrade"),role:"button",tabIndex:0,children:[r.jsx("div",{className:"cbc-unlock-ring",children:r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),r.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]})}),r.jsx("span",{className:"cbc-habit-label",children:"More Habits"}),r.jsx("span",{className:"cbc-habit-hold-hint",children:"Custom & editable"})]})]})]}),r.jsxs("div",{className:"cbc-section anim-fade-up-d3",children:[r.jsxs("div",{className:"cbc-section-header",children:[r.jsx("h2",{className:"cbc-section-title",children:"This Week"}),r.jsxs("span",{className:"cbc-section-badge",children:[kt,"/7 perfect"]})]}),r.jsxs("div",{className:"cbc-weekly-card",children:[r.jsxs("div",{className:"cbc-weekly-header",children:[r.jsx("span",{className:"cbc-weekly-habit-name"}),Ct.map((Q,Ae)=>r.jsx("span",{className:`cbc-weekly-day-label${Et[Ae]&&Ho(Et[Ae])===Nt?" cbc-today-label":""}`,children:Q},Ae))]}),et.map(Q=>(Q.days.filter(Boolean).length,r.jsxs("div",{className:"cbc-weekly-row",children:[r.jsx("span",{className:"cbc-weekly-habit-name",style:{color:Q.color},children:Q.label}),Q.days.map((Ae,Je)=>r.jsx("span",{className:`cbc-weekly-dot${Ae?" cbc-dot-done":""}${Et[Je]&&Ho(Et[Je])===Nt?" cbc-dot-today":""}`,style:Ae?{background:Q.color,borderColor:Q.color,boxShadow:`0 0 6px ${Q.color}40`}:void 0},Je))]},Q.key))),r.jsxs("div",{className:"cbc-week-summary",children:[r.jsx("div",{className:"cbc-week-summary-bar",children:r.jsx("div",{className:"cbc-week-summary-fill",style:{width:`${Ie}%`}})}),r.jsxs("span",{className:"cbc-week-summary-text",children:[ws,"/",be," completed (",Ie,"%)"]})]})]})]}),r.jsxs("div",{className:"cbc-section anim-fade-up-d4",children:[r.jsx("h2",{className:"cbc-section-title",children:X}),r.jsxs("div",{className:"cbc-calendar-card",children:[r.jsx("div",{className:"cbc-cal-header",children:["M","T","W","T","F","S","S"].map((Q,Ae)=>r.jsx("span",{className:"cbc-cal-day-label",children:Q},Ae))}),r.jsxs("div",{className:"cbc-cal-grid",children:[Array.from({length:Qe},(Q,Ae)=>r.jsx("span",{className:"cbc-cal-cell cbc-cal-empty"},`e${Ae}`)),_t.map(Q=>{const Ae=Q.total>0?Q.completed/Q.total:0,Je=Q.isFuture?-1:Ae===0?0:Ae<.4?1:Ae<.75?2:Ae<1?3:4;return r.jsx("span",{className:`cbc-cal-cell${Q.isToday?" cbc-cal-today":""}${Je===4?" cbc-cal-perfect":""} cbc-cal-heat-${Je<0?"future":Je}`,children:Q.day},Q.day)})]}),r.jsxs("div",{className:"cbc-cal-legend",children:[r.jsx("span",{className:"cbc-cal-legend-label",children:"Less"}),r.jsx("span",{className:"cbc-cal-legend-swatch cbc-cal-heat-0"}),r.jsx("span",{className:"cbc-cal-legend-swatch cbc-cal-heat-1"}),r.jsx("span",{className:"cbc-cal-legend-swatch cbc-cal-heat-2"}),r.jsx("span",{className:"cbc-cal-legend-swatch cbc-cal-heat-3"}),r.jsx("span",{className:"cbc-cal-legend-swatch cbc-cal-heat-4"}),r.jsx("span",{className:"cbc-cal-legend-label",children:"More"})]})]})]})]}),r.jsx(Ta,{active:"home"}),Le&&r.jsx("div",{className:"cbc-modal-overlay",onClick:()=>ht(!1),children:r.jsxs("div",{className:"cbc-modal",onClick:Q=>Q.stopPropagation(),children:[r.jsx("h3",{className:"cbc-modal-title",children:"Add Habit"}),r.jsx("p",{className:"cbc-modal-desc",children:"Track something personal to your routine."}),r.jsx("input",{className:"cbc-modal-input",type:"text",placeholder:"e.g. Meditate, Stretch, Read...",value:$,onChange:Q=>pe(Q.target.value),maxLength:30,autoFocus:!0,onKeyDown:Q=>Q.key==="Enter"&&Qs()}),r.jsxs("div",{className:"cbc-modal-actions",children:[r.jsx("button",{className:"cbc-modal-cancel",onClick:()=>{ht(!1),pe("")},children:"Cancel"}),r.jsx("button",{className:"cbc-modal-save",onClick:Qs,disabled:!$.trim(),children:"Add"})]})]})}),Be&&r.jsx("div",{className:"cbc-modal-overlay",onClick:()=>We(null),children:r.jsxs("div",{className:"cbc-modal",onClick:Q=>Q.stopPropagation(),children:[r.jsxs("h3",{className:"cbc-modal-title",children:['Remove "',Be.label,'"?']}),r.jsx("p",{className:"cbc-modal-desc",children:"This will remove the habit from your daily tracker. Past logs won't be affected."}),r.jsxs("div",{className:"cbc-modal-actions",children:[r.jsx("button",{className:"cbc-modal-cancel",onClick:()=>We(null),children:"Keep"}),r.jsx("button",{className:"cbc-modal-delete",onClick:()=>Be.type==="custom"?Ms(Be.id):Fs(Be.key),children:"Remove"})]})]})}),T&&r.jsx(em,{title:"All Habits Complete!",subtitle:Tt.current,stats:[{value:`${De}/${Wt.length}`,label:"Habits"},{value:Y||1,label:"Day Streak"}],buttonLabel:"Keep Going",holdLabel:"Hold To Complete Today's Habits",shareType:"habits",hideShare:!p,onShareJourney:t?is:null,userName:t?.name,onDone:()=>{M(!1),I(!1)}}),ke&&r.jsx("div",{className:`toast-notification ${ke.type}`,children:ke.message})]})})}function gh(n){if(!n)return"?";const e=n.trim().split(/\s+/);return e.length===1?e[0][0].toUpperCase():(e[0][0]+e[e.length-1][0]).toUpperCase()}function L2(n,e){return[n,e].sort().join("_")}function L6(){const{currentUser:n,isClient:e,clientData:t,loading:i}=Ir(),{isDark:l,toggleTheme:u}=Ca(),d=tr(),[p,g]=b.useState("buddies"),[y,x]=b.useState([]),[_,j]=b.useState([]),[O,K]=b.useState([]),[B,D]=b.useState(""),[te,Y]=b.useState([]),[Z,ke]=b.useState([]),[Re,_e]=b.useState(!0),[C,T]=b.useState(null),[M,V]=b.useState(null),I=b.useCallback((J,P="info")=>{V({message:J,type:P}),setTimeout(()=>V(null),3500)},[]);b.useEffect(()=>{!i&&(!n||!e)&&d("/")},[n,e,i,d]);const L=b.useCallback(async()=>{if(t){_e(!0);try{const J=t.id,re=(await Ts(Ht(ge,"clients"))).docs.map(ot=>({id:ot.id,...ot.data()}));ke(re);const Fe=Object.fromEntries(re.map(ot=>[ot.id,ot])),qe=await Ts(As(Ht(ge,"buddies"),gs("user1","==",J))),Ve=await Ts(As(Ht(ge,"buddies"),gs("user2","==",J))),Me=new Set;[...qe.docs,...Ve.docs].forEach(ot=>{const es=ot.data(),Ns=es.user1===J?es.user2:es.user1;Me.add(Ns)}),x(Array.from(Me).map(ot=>Fe[ot]).filter(Boolean));const mt=await Ts(As(Ht(ge,"buddyRequests"),gs("toId","==",J),gs("status","==","pending")));j(mt.docs.map(ot=>({reqId:ot.id,...ot.data(),fromClient:Fe[ot.data().fromId]})).filter(ot=>ot.fromClient));const wt=await Ts(As(Ht(ge,"buddyRequests"),gs("fromId","==",J),gs("status","==","pending")));K(wt.docs.map(ot=>({reqId:ot.id,...ot.data(),toClient:Fe[ot.data().toId]})).filter(ot=>ot.toClient))}catch(J){console.error("Error fetching buddy data:",J),I("Failed to load buddies","error")}finally{_e(!1)}}},[t,I]);b.useEffect(()=>{L()},[L]),b.useEffect(()=>{if(!B.trim()||!t){Y([]);return}const J=B.toLowerCase(),P=t.id,re=new Set(y.map(Me=>Me.id)),Fe=new Set(O.map(Me=>Me.toId)),qe=new Set(_.map(Me=>Me.fromId)),Ve=Z.filter(Me=>Me.id===P||!Me.name||!Me.coreBuddyAccess&&Me.clientType!=="core_buddy"?!1:Me.name.toLowerCase().includes(J)).map(Me=>({...Me,isBuddy:re.has(Me.id),isPendingOut:Fe.has(Me.id),isPendingIn:qe.has(Me.id)})).slice(0,20);Y(Ve)},[B,Z,y,O,_,t]);const A=async(J,P)=>{if(!(!t||J===t.id))try{await Gr(Ht(ge,"notifications"),{toId:J,fromId:t.id,fromName:t.name||"Someone",fromPhotoURL:t.photoURL||null,type:P,read:!1,createdAt:yr()})}catch(re){console.error("Notification error:",re),re.code==="permission-denied"&&I("Notifications blocked  check Firestore rules","error")}},Le=async J=>{T(J);try{const P=`${t.id}_${J}`;await Ds(Xe(ge,"buddyRequests",P),{fromId:t.id,toId:J,status:"pending",createdAt:yr()}),await A(J,"buddy_request"),I("Buddy request sent!","success"),await L()}catch(P){console.error("Error sending request:",P),I("Failed to send request","error")}finally{T(null)}},ht=async J=>{T(J.reqId);try{const P=L2(J.fromId,t.id);await Ds(Xe(ge,"buddies",P),{user1:[J.fromId,t.id].sort()[0],user2:[J.fromId,t.id].sort()[1],connectedAt:yr()}),await lr(Xe(ge,"buddyRequests",J.reqId)),await A(J.fromId,"buddy_accept"),I("Buddy added!","success"),await L()}catch(P){console.error("Error accepting request:",P),I("Failed to accept","error")}finally{T(null)}},$=async J=>{T(J.reqId);try{await lr(Xe(ge,"buddyRequests",J.reqId)),I("Request declined","info"),await L()}catch(P){console.error("Error declining:",P),I("Failed to decline","error")}finally{T(null)}},pe=async J=>{T(J.reqId);try{await lr(Xe(ge,"buddyRequests",J.reqId)),I("Request cancelled","info"),await L()}catch(P){console.error("Error cancelling:",P),I("Failed to cancel","error")}finally{T(null)}},Be=async J=>{T(J);try{const P=L2(t.id,J);await lr(Xe(ge,"buddies",P)),I("Buddy removed","info"),await L()}catch(P){console.error("Error removing buddy:",P),I("Failed to remove buddy","error")}finally{T(null)}},We=_.length;return i?r.jsx("div",{className:"bdy-loading",children:r.jsx("div",{className:"bdy-spinner"})}):!n||!e||!t?null:r.jsx(Sa,{children:r.jsxs("div",{className:"bdy-page","data-theme":l?"dark":"light",children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>d("/client/core-buddy"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),r.jsxs("main",{className:"bdy-main",children:[r.jsx("h1",{className:"bdy-title",children:"Buddies"}),r.jsxs("button",{className:"bdy-leaderboard-link",onClick:()=>d("/client/leaderboard"),children:[r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5C7 4 7 7 7 7"}),r.jsx("path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5C17 4 17 7 17 7"}),r.jsx("rect",{x:"6",y:"9",width:"12",height:"13",rx:"2"}),r.jsx("path",{d:"M12 9v13"}),r.jsx("path",{d:"M2 22h20"})]}),r.jsx("span",{children:"Leaderboard"}),r.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})]}),r.jsxs("div",{className:"bdy-tabs",children:[r.jsxs("button",{className:`bdy-tab${p==="buddies"?" active":""}`,onClick:()=>g("buddies"),children:[r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),r.jsx("circle",{cx:"9",cy:"7",r:"4"}),r.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),r.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),r.jsx("span",{children:"My Buddies"})]}),r.jsxs("button",{className:`bdy-tab${p==="requests"?" active":""}`,onClick:()=>g("requests"),children:[r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),r.jsx("circle",{cx:"9",cy:"7",r:"4"}),r.jsx("line",{x1:"19",y1:"8",x2:"19",y2:"14"}),r.jsx("line",{x1:"22",y1:"11",x2:"16",y2:"11"})]}),r.jsx("span",{children:"Requests"}),We>0&&r.jsx("span",{className:"bdy-tab-badge",children:We})]}),r.jsxs("button",{className:`bdy-tab${p==="search"?" active":""}`,onClick:()=>g("search"),children:[r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("circle",{cx:"11",cy:"11",r:"8"}),r.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),r.jsx("span",{children:"Find"})]})]}),Re?r.jsx("div",{className:"bdy-content-loading",children:r.jsx("div",{className:"bdy-spinner"})}):r.jsxs(r.Fragment,{children:[p==="buddies"&&r.jsx("div",{className:"bdy-section",children:y.length===0?r.jsxs("div",{className:"bdy-empty",children:[r.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),r.jsx("circle",{cx:"9",cy:"7",r:"4"}),r.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),r.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),r.jsx("h3",{children:"No buddies yet"}),r.jsx("p",{children:"Find members and send buddy requests to connect!"}),r.jsx("button",{className:"bdy-empty-btn",onClick:()=>g("search"),children:"Find Buddies"})]}):r.jsx("div",{className:"bdy-list",children:y.map(J=>r.jsxs("div",{className:"bdy-card",onClick:()=>d(`/client/core-buddy/profile/${J.id}`),children:[r.jsx("div",{className:"bdy-avatar",children:J.photoURL?r.jsx("img",{src:J.photoURL,alt:J.name}):r.jsx("span",{children:gh(J.name)})}),r.jsx("div",{className:"bdy-card-info",children:r.jsx("span",{className:"bdy-card-name",children:J.name})}),r.jsx("button",{className:"bdy-remove-btn",onClick:P=>{P.stopPropagation(),Be(J.id)},disabled:C===J.id,"aria-label":"Remove buddy",children:C===J.id?r.jsx("div",{className:"bdy-btn-spinner"}):r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]},J.id))})}),p==="requests"&&r.jsxs("div",{className:"bdy-section",children:[_.length>0&&r.jsxs(r.Fragment,{children:[r.jsx("h3",{className:"bdy-section-title",children:"Incoming"}),r.jsx("div",{className:"bdy-list",children:_.map(J=>r.jsxs("div",{className:"bdy-card",children:[r.jsx("div",{className:"bdy-avatar",children:J.fromClient.photoURL?r.jsx("img",{src:J.fromClient.photoURL,alt:J.fromClient.name}):r.jsx("span",{children:gh(J.fromClient.name)})}),r.jsxs("div",{className:"bdy-card-info",children:[r.jsx("span",{className:"bdy-card-name",children:J.fromClient.name}),r.jsx("span",{className:"bdy-card-sub",children:"wants to be your buddy"})]}),r.jsxs("div",{className:"bdy-action-pair",children:[r.jsx("button",{className:"bdy-accept-btn",onClick:()=>ht(J),disabled:C===J.reqId,children:C===J.reqId?r.jsx("div",{className:"bdy-btn-spinner"}):r.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:r.jsx("path",{d:"M5 13l4 4L19 7"})})}),r.jsx("button",{className:"bdy-decline-btn",onClick:()=>$(J),disabled:C===J.reqId,children:r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]})]},J.reqId))})]}),O.length>0&&r.jsxs(r.Fragment,{children:[r.jsx("h3",{className:"bdy-section-title",children:"Sent"}),r.jsx("div",{className:"bdy-list",children:O.map(J=>r.jsxs("div",{className:"bdy-card",children:[r.jsx("div",{className:"bdy-avatar",children:J.toClient?.photoURL?r.jsx("img",{src:J.toClient.photoURL,alt:J.toClient.name}):r.jsx("span",{children:gh(J.toClient?.name)})}),r.jsxs("div",{className:"bdy-card-info",children:[r.jsx("span",{className:"bdy-card-name",children:J.toClient?.name}),r.jsx("span",{className:"bdy-card-sub",children:"pending"})]}),r.jsx("button",{className:"bdy-cancel-btn",onClick:()=>pe(J),disabled:C===J.reqId,children:C===J.reqId?r.jsx("div",{className:"bdy-btn-spinner"}):"Cancel"})]},J.reqId))})]}),_.length===0&&O.length===0&&r.jsxs("div",{className:"bdy-empty",children:[r.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[r.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),r.jsx("path",{d:"M22 4L12 14.01l-3-3"})]}),r.jsx("h3",{children:"No pending requests"}),r.jsx("p",{children:"All caught up!"})]})]}),p==="search"&&r.jsxs("div",{className:"bdy-section",children:[r.jsxs("div",{className:"bdy-search-bar",children:[r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("circle",{cx:"11",cy:"11",r:"8"}),r.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),r.jsx("input",{type:"text",placeholder:"Search by name...",value:B,onChange:J=>D(J.target.value),autoFocus:!0}),B&&r.jsx("button",{className:"bdy-search-clear",onClick:()=>D(""),children:r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),B.trim()&&te.length===0&&r.jsx("div",{className:"bdy-empty bdy-empty-sm",children:r.jsxs("p",{children:['No members found for "',B,'"']})}),te.length>0&&r.jsx("div",{className:"bdy-list",children:te.map(J=>r.jsxs("div",{className:"bdy-card",onClick:()=>d(`/client/core-buddy/profile/${J.id}`),children:[r.jsx("div",{className:"bdy-avatar",children:J.photoURL?r.jsx("img",{src:J.photoURL,alt:J.name}):r.jsx("span",{children:gh(J.name)})}),r.jsxs("div",{className:"bdy-card-info",children:[r.jsx("span",{className:"bdy-card-name",children:J.name}),J.isBuddy&&r.jsx("span",{className:"bdy-card-badge",children:"Buddy"})]}),J.isBuddy?r.jsx("span",{className:"bdy-status-icon",children:r.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"var(--color-success)",strokeWidth:"2.5",children:r.jsx("path",{d:"M5 13l4 4L19 7"})})}):J.isPendingOut?r.jsx("span",{className:"bdy-pending-label",children:"Pending"}):J.isPendingIn?r.jsx("button",{className:"bdy-accept-btn",onClick:P=>{P.stopPropagation();const re=_.find(Fe=>Fe.fromId===J.id);re&&ht(re)},disabled:!!C,children:r.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:r.jsx("path",{d:"M5 13l4 4L19 7"})})}):r.jsx("button",{className:"bdy-add-btn",onClick:P=>{P.stopPropagation(),Le(J.id)},disabled:C===J.id,children:C===J.id?r.jsx("div",{className:"bdy-btn-spinner"}):r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),r.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})})]},J.id))})]})]})]}),r.jsx(Ta,{}),M&&r.jsxs("div",{className:`toast-notification ${M.type}`,children:[r.jsx("span",{className:"toast-icon",children:M.type==="success"?r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M5 13 L9 17 L19 7"})}):M.type==="error"?r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]}):r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),r.jsx("circle",{cx:"12",cy:"16",r:"1",fill:"currentColor"})]})}),r.jsx("span",{className:"toast-message",children:M.message})]})]})})}function yh(n){if(!n)return"?";const e=n.trim().split(/\s+/);return e.length===1?e[0][0].toUpperCase():(e[0][0]+e[e.length-1][0]).toUpperCase()}function tg(n,e){return[n,e].sort().join("_")}const O6=5;function sg(n){return n.toISOString().split("T")[0]}function B6(n){return n>=1e6?`${(n/1e6).toFixed(1)}M`:n>=1e3?`${(n/1e3).toFixed(1)}T`:`${Math.round(n)}`}const V6={fullbody_4wk:{duration:4,daysPerWeek:3},fullbody_8wk:{duration:8,daysPerWeek:3},fullbody_12wk:{duration:12,daysPerWeek:3},core_4wk:{duration:4,daysPerWeek:3},core_8wk:{duration:8,daysPerWeek:3},core_12wk:{duration:12,daysPerWeek:3},upper_4wk:{duration:4,daysPerWeek:3},lower_4wk:{duration:4,daysPerWeek:3}};function O2(n){if(!n)return"";const e=n instanceof Date?n:n.toDate?n.toDate():new Date(n),t=Math.floor((new Date-e)/1e3);return t<60?"just now":t<3600?`${Math.floor(t/60)}m ago`:t<86400?`${Math.floor(t/3600)}h ago`:t<604800?`${Math.floor(t/86400)}d ago`:e.toLocaleDateString("en-GB",{day:"numeric",month:"short"})}function U6(){const{userId:n}=_S(),{currentUser:e,isClient:t,clientData:i,loading:l}=Ir(),{isDark:u,toggleTheme:d}=Ca(),p=tr(),[g,y]=b.useState(null),[x,_]=b.useState("none"),[j,O]=b.useState(null),[K,B]=b.useState(!0),[D,te]=b.useState(!1),[Y,Z]=b.useState(null),[ke,Re]=b.useState([]),[_e,C]=b.useState(!1),[T,M]=b.useState(new Set),[V,I]=b.useState(new Set),[L,A]=b.useState({}),[Le,ht]=b.useState({}),[$,pe]=b.useState({}),[Be,We]=b.useState(!0),[J,P]=b.useState(0),[re,Fe]=b.useState(0),[qe,Ve]=b.useState(0),[Me,mt]=b.useState(0),[wt,ot]=b.useState([]),[es,Ns]=b.useState([]),[Ft,Tt]=b.useState(null),[oe,Dt]=b.useState(null),[Nt,Kt]=b.useState(0),[Et,Ct]=b.useState([]),[lt,Ot]=b.useState(!1),[Wt,ms]=b.useState(null),[Gt,Pt]=b.useState([]),us=b.useCallback((X,se="info")=>{Z({message:X,type:se}),setTimeout(()=>Z(null),3500)},[]);b.useEffect(()=>{!l&&(!e||!t)&&p("/")},[e,t,l,p]),b.useEffect(()=>{i&&n&&i.id===n&&p("/client/core-buddy",{replace:!0})},[i,n,p]),b.useEffect(()=>{if(!i||!n||i.id===n)return;let X=!1;return(async()=>{B(!0);try{const _t=(await Ts(Ht(ge,"clients"))).docs.map(Ae=>({id:Ae.id,...Ae.data()})).find(Ae=>Ae.id===n);if(!_t){X||B(!1);return}X||y(_t);const et=i.id,kt=tg(et,n);if((await Is(Xe(ge,"buddies",kt))).exists())X||_("buddy");else{const Ae=`${et}_${n}`,Je=await Is(Xe(ge,"buddyRequests",Ae));if(Je.exists()&&Je.data().status==="pending")X||(_("pending_out"),O(Ae));else{const yt=`${n}_${et}`,it=await Is(Xe(ge,"buddyRequests",yt));it.exists()&&it.data().status==="pending"?X||(_("pending_in"),O(yt)):X||_("none")}}}catch(se){console.error("Error loading profile:",se)}finally{X||B(!1)}})(),()=>{X=!0}},[i,n]),b.useEffect(()=>{if(!n||!g)return;let X=!1;return(async()=>{We(!0);try{const[se,Qe,_t,et]=await Promise.all([Ts(As(Ht(ge,"workoutLogs"),gs("clientId","==",n))),Is(Xe(ge,"coreBuddyAchievements",n)),Is(Xe(ge,"coreBuddyPBs",n)),Is(Xe(ge,"clientProgrammes",n))]);if(X)return;const kt=se.docs.length;P(kt),Qe.exists()&&Fe(Qe.data().totalVolume||0);let Q=0;const Ae=se.docs.map(it=>it.data().date).filter(Boolean).sort().reverse();if(Ae.length>0){const it=new Date;let Jt=new Date(it);for(let Yt=0;Yt<52;Yt++){const F=new Date(Jt),ye=F.getDay(),Ee=ye===0?6:ye-1;F.setDate(F.getDate()-Ee),F.setHours(0,0,0,0);const Te=new Date(F);Te.setDate(Te.getDate()+7);const Se=sg(F),bt=sg(Te);if(Ae.some(ft=>ft>=Se&&ft<bt))Q++;else{if(Yt>0)break;break}Jt.setDate(Jt.getDate()-7)}}if(X||Ve(Q),_t.exists()){const it=_t.data().exercises||{},Jt=Object.entries(it).sort(([,Yt],[,F])=>(F.weight||0)-(Yt.weight||0)).slice(0,3).map(([Yt,F])=>({name:Yt,weight:F.weight,reps:F.reps}));X||ot(Jt)}if(et.exists()){const it=et.data(),Jt=V6[it.templateId];if(Jt){const Yt=Object.keys(it.completedSessions||{}).length,F=Jt.duration*Jt.daysPerWeek;X||(Dt(it.templateId.replace(/_/g," ").replace(/\b\w/g,ye=>ye.toUpperCase())),Kt(F>0?Math.round(Yt/F*100):0))}}const Je=await Is(Xe(ge,"achievements",n));if(!X&&Je.exists()){const it=Je.data().badges||{};Ns(Object.keys(it))}let yt=0;for(let it=0;it<30;it++){const Jt=new Date;Jt.setDate(Jt.getDate()-it);const Yt=sg(Jt);try{const F=await Ts(As(Ht(ge,"habitLogs"),gs("clientId","==",n),gs("date","==",Yt)));if(F.empty)break;{const ye=F.docs[0].data().habits||{};if(Object.values(ye).filter(Boolean).length>=O6)yt++;else break}}catch{break}}X||mt(yt)}catch(se){console.error("Error loading buddy stats:",se)}finally{X||We(!1)}})(),()=>{X=!0}},[n,g]),b.useEffect(()=>{if(!i)return;const X=i.id;(async()=>{try{const[se,Qe,_t]=await Promise.all([Ts(As(Ht(ge,"buddies"),gs("user1","==",X))),Ts(As(Ht(ge,"buddies"),gs("user2","==",X))),Ts(Ht(ge,"clients"))]),et=new Set;[...se.docs,...Qe.docs].forEach(Q=>{const Ae=Q.data();et.add(Ae.user1===X?Ae.user2:Ae.user1)});const kt={};_t.docs.forEach(Q=>{kt[Q.id]=Q.data()}),Ct(Array.from(et).filter(Q=>kt[Q]).map(Q=>({id:Q,name:kt[Q].name,photoURL:kt[Q].photoURL||null})))}catch(se){console.error("Error loading buddies for mentions:",se)}})()},[i]);const xs=async(X,se,Qe={})=>{if(!(!i||X===i.id))try{await Gr(Ht(ge,"notifications"),{toId:X,fromId:i.id,fromName:i.name||"Someone",fromPhotoURL:i.photoURL||null,type:se,read:!1,createdAt:yr(),...Qe})}catch(_t){console.error("Notification error:",_t),_t.code==="permission-denied"&&us("Notifications blocked  check Firestore rules","error")}},is=async()=>{te(!0);try{const X=`${i.id}_${n}`;await Ds(Xe(ge,"buddyRequests",X),{fromId:i.id,toId:n,status:"pending",createdAt:yr()}),await xs(n,"buddy_request"),_("pending_out"),O(X),us("Buddy request sent!","success")}catch(X){console.error(X),us("Failed to send request","error")}finally{te(!1)}},Qs=async()=>{if(j){te(!0);try{const X=tg(i.id,n);await Ds(Xe(ge,"buddies",X),{user1:[i.id,n].sort()[0],user2:[i.id,n].sort()[1],connectedAt:yr()}),await lr(Xe(ge,"buddyRequests",j)),await xs(n,"buddy_accept"),_("buddy"),us("Buddy added!","success")}catch(X){console.error(X),us("Failed to accept","error")}finally{te(!1)}}},Ms=async()=>{if(j){te(!0);try{await lr(Xe(ge,"buddyRequests",j)),_("none"),us(x==="pending_out"?"Request cancelled":"Request declined","info")}catch(X){console.error(X),us("Failed","error")}finally{te(!1)}}},Fs=async()=>{te(!0);try{const X=tg(i.id,n);await lr(Xe(ge,"buddies",X)),_("none"),us("Buddy removed","info")}catch(X){console.error(X),us("Failed to remove","error")}finally{te(!1)}},os=b.useCallback(async()=>{if(n){C(!0);try{const X=await Ts(As(Ht(ge,"posts"),gs("authorId","==",n),oc("createdAt","desc"),Pu(30)));if(Re(X.docs.map(se=>({id:se.id,...se.data()}))),i){const se=await Ts(As(Ht(ge,"postLikes"),gs("userId","==",i.id)));M(new Set(se.docs.map(Qe=>Qe.data().postId)))}}catch(X){console.error("Error loading journey:",X)}finally{C(!1)}}},[n,i]);b.useEffect(()=>{!K&&g&&os()},[K,g,os]);const ws=async X=>{if(window.confirm("Delete this post?"))try{await lr(Xe(ge,"posts",X)),Re(se=>se.filter(Qe=>Qe.id!==X)),us("Post deleted","info")}catch(se){console.error("Delete error:",se),us("Failed to delete","error")}},be=async X=>{if(!i)return;const se=i.id,Qe=`${X}_${se}`,_t=T.has(X),et=new Set(T);_t?et.delete(X):et.add(X),M(et),Re(kt=>kt.map(Q=>Q.id===X?{...Q,likeCount:Math.max(0,(Q.likeCount||0)+(_t?-1:1))}:Q));try{if(_t)await lr(Xe(ge,"postLikes",Qe)),await oa(Xe(ge,"posts",X),{likeCount:Yo(-1)});else{await Ds(Xe(ge,"postLikes",Qe),{postId:X,userId:se,createdAt:yr()}),await oa(Xe(ge,"posts",X),{likeCount:Yo(1)});const kt=ke.find(Q=>Q.id===X);kt&&xs(kt.authorId,"like",{postId:X})}}catch(kt){console.error("Like error:",kt),os()}},Ie=async X=>{try{const se=await Ts(As(Ht(ge,"postComments"),gs("postId","==",X),oc("createdAt","asc"),Pu(50)));A(Qe=>({...Qe,[X]:se.docs.map(_t=>({id:_t.id,..._t.data()}))}))}catch(se){console.error("Error loading comments:",se)}},De=X=>{const se=new Set(V);se.has(X)?se.delete(X):(se.add(X),L[X]||Ie(X)),I(se)},rt=(X,se)=>{const Qe=X.match(/@(\w*)$/);if(Qe){Ot(!0),ms(se);const _t=Et.filter(et=>et.name&&et.name.toLowerCase().includes(Qe[1].toLowerCase())).slice(0,5);Pt(_t)}else Ot(!1),Pt([])},Ke=(X,se)=>{const _t=(Le[se]||"").replace(/@\w*$/,`@${X.name} `);ht(et=>({...et,[se]:_t})),Ot(!1),Pt([])},at=(X,se)=>{ht(Qe=>({...Qe,[X]:se})),rt(se,X)},gt=async X=>{const se=(Le[X]||"").trim();if(!(!se||!i)){pe(Qe=>({...Qe,[X]:!0}));try{await Gr(Ht(ge,"postComments"),{postId:X,authorId:i.id,authorName:i.name||"Unknown",authorPhotoURL:i.photoURL||null,content:se,createdAt:yr()}),await oa(Xe(ge,"posts",X),{commentCount:Yo(1)});const Qe=ke.find(et=>et.id===X);Qe&&xs(Qe.authorId,"comment",{postId:X});const _t=se.match(/@[\w\s]+?(?=\s@|\s*$|[.,!?])/g);if(_t){const et=new Set;_t.forEach(kt=>{const Q=kt.slice(1).trim(),Ae=Et.find(Je=>Je.name&&Je.name.toLowerCase()===Q.toLowerCase());Ae&&!et.has(Ae.id)&&(et.add(Ae.id),xs(Ae.id,"mention",{postId:X}))})}ht(et=>({...et,[X]:""})),Re(et=>et.map(kt=>kt.id===X?{...kt,commentCount:(kt.commentCount||0)+1}:kt)),await Ie(X)}catch(Qe){console.error("Comment error:",Qe),us("Failed to comment","error")}finally{pe(Qe=>({...Qe,[X]:!1}))}}};return l||K||!i?r.jsx("div",{className:"prf-loading","data-theme":u?"dark":"light",children:r.jsx("div",{className:"prf-spinner"})}):!e||!t?null:g?r.jsx(Sa,{children:r.jsxs("div",{className:"prf-page","data-theme":u?"dark":"light",children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>p(-1),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:d,"aria-label":"Toggle theme",children:u?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),r.jsxs("main",{className:"prf-main",children:[r.jsxs("div",{className:"prf-hero",children:[r.jsx("div",{className:"prf-avatar-lg",children:g.photoURL?r.jsx("img",{src:g.photoURL,alt:g.name}):r.jsx("span",{children:yh(g.name)})}),r.jsx("h1",{className:"prf-name",children:g.name}),r.jsxs("div",{className:"prf-buddy-action",children:[x==="none"&&r.jsx("button",{className:"prf-btn prf-btn-primary",onClick:is,disabled:D,children:D?r.jsx("div",{className:"prf-btn-spinner"}):r.jsxs(r.Fragment,{children:[r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),r.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),"Add Buddy"]})}),x==="pending_out"&&r.jsx("button",{className:"prf-btn prf-btn-secondary",onClick:Ms,disabled:D,children:D?r.jsx("div",{className:"prf-btn-spinner dark"}):"Cancel Request"}),x==="pending_in"&&r.jsxs("div",{className:"prf-btn-pair",children:[r.jsx("button",{className:"prf-btn prf-btn-success",onClick:Qs,disabled:D,children:D?r.jsx("div",{className:"prf-btn-spinner"}):"Accept"}),r.jsx("button",{className:"prf-btn prf-btn-secondary",onClick:Ms,disabled:D,children:"Decline"})]}),x==="buddy"&&r.jsx("button",{className:"prf-btn prf-btn-danger",onClick:Fs,disabled:D,children:D?r.jsx("div",{className:"prf-btn-spinner"}):"Remove Buddy"})]})]}),Be?r.jsx("div",{className:"prf-stats-loading",children:r.jsx("div",{className:"prf-spinner"})}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"prf-stats",children:[r.jsxs("div",{className:"prf-stat",children:[r.jsx("span",{className:"prf-stat-value",children:J}),r.jsx("span",{className:"prf-stat-label",children:"Workouts"})]}),r.jsxs("div",{className:"prf-stat",children:[r.jsxs("span",{className:"prf-stat-value",children:[B6(re),r.jsx("span",{className:"prf-stat-unit",children:re>=1e3?"":"kg"})]}),r.jsxs("span",{className:"prf-stat-label",children:[re>=1e6?"Million kg":re>=1e3?"Tonnes":"Volume"," Lifted"]})]}),r.jsxs("div",{className:"prf-stat",children:[r.jsxs("span",{className:"prf-stat-value",children:[qe,r.jsx("span",{className:"prf-stat-unit",children:"wk"})]}),r.jsx("span",{className:"prf-stat-label",children:"Streak"})]})]}),(oe||Me>0)&&r.jsxs("div",{className:"prf-info-row",children:[oe&&r.jsxs("div",{className:"prf-info-card info-programme",children:[r.jsx("div",{className:"prf-info-icon",children:r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M4 19.5A2.5 2.5 0 0 1 6.5 17H20"}),r.jsx("path",{d:"M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"})]})}),r.jsxs("div",{className:"prf-info-text",children:[r.jsx("span",{className:"prf-info-label",children:oe}),r.jsx("div",{className:"prf-info-progress-bar",children:r.jsx("div",{className:"prf-info-progress-fill",style:{width:`${Math.min(Nt,100)}%`}})}),r.jsxs("span",{className:"prf-info-sub",children:[Nt,"% complete"]})]})]}),Me>0&&r.jsxs("div",{className:"prf-info-card info-habit",children:[r.jsx("div",{className:"prf-info-icon",children:r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),r.jsx("path",{d:"M22 4L12 14.01l-3-3"})]})}),r.jsxs("div",{className:"prf-info-text",children:[r.jsxs("span",{className:"prf-info-value",children:[Me," day",Me!==1?"s":""]}),r.jsx("span",{className:"prf-info-sub",children:"Habit Streak"})]})]})]}),wt.length>0&&r.jsxs("div",{className:"prf-section",children:[r.jsx("h2",{className:"prf-section-title",children:"Top Lifts"}),r.jsx("div",{className:"prf-pb-list",children:wt.map((X,se)=>r.jsxs("div",{className:"prf-pb-item",children:[r.jsx("div",{className:"prf-pb-rank",children:se===0?r.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",stroke:"none",children:r.jsx("path",{d:"M12 2l2.4 7.4H22l-6 4.4 2.3 7.2L12 16.6 5.7 21l2.3-7.2-6-4.4h7.6z"})}):`#${se+1}`}),r.jsx("span",{className:"prf-pb-name",children:X.name}),r.jsxs("span",{className:"prf-pb-weight",children:[X.weight,r.jsx("span",{className:"prf-pb-unit",children:"kg"})," x",X.reps]})]},se))})]}),es.length>0&&r.jsxs("div",{className:"prf-section",children:[r.jsxs("h2",{className:"prf-section-title",children:["Badges Earned (",es.length,")"]}),r.jsx("div",{className:"prf-badge-row",children:es.map(X=>{const se=Bn.find(Qe=>Qe.id===X);return se?r.jsx("button",{className:"prf-badge-chip",onClick:()=>Tt(se),children:r.jsx("img",{src:se.img,alt:se.name,className:"prf-badge-chip-img"})},X):null})})]}),Ft&&r.jsx("div",{className:"prf-badge-overlay",onClick:()=>Tt(null),children:r.jsxs("div",{className:"prf-badge-overlay-content",onClick:X=>X.stopPropagation(),children:[r.jsx("img",{src:Ft.img,alt:Ft.name,className:"prf-badge-overlay-img"}),r.jsx("p",{className:"prf-badge-overlay-desc",children:Ft.desc}),r.jsx("button",{className:"prf-badge-overlay-close",onClick:()=>Tt(null),children:"Tap to close"})]})})]}),r.jsxs("div",{className:"prf-section",children:[r.jsx("h2",{className:"prf-section-title",children:`${g.name?.split(" ")[0]}'s Journey`}),_e?r.jsx("div",{className:"journey-loading",children:r.jsx("div",{className:"prf-spinner"})}):ke.length===0?r.jsxs("div",{className:"journey-empty",children:[r.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),r.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),r.jsx("path",{d:"M21 15l-5-5L5 21"})]}),r.jsx("p",{children:"No posts yet"})]}):r.jsx("div",{className:"journey-list",children:ke.map(X=>r.jsxs("div",{className:"journey-post",children:[r.jsxs("div",{className:"journey-post-header",children:[r.jsx("div",{className:"journey-post-avatar",children:X.authorPhotoURL?r.jsx("img",{src:X.authorPhotoURL,alt:""}):r.jsx("span",{children:yh(X.authorName)})}),r.jsxs("div",{className:"journey-post-meta",children:[r.jsx("span",{className:"journey-post-name",children:X.authorName}),r.jsx("span",{className:"journey-post-time",children:O2(X.createdAt)})]}),X.authorId===i.id&&r.jsx("button",{className:"journey-delete-btn",onClick:()=>ws(X.id),"aria-label":"Delete post",children:r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M3 6h18"}),r.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),r.jsx("path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]}),X.content&&r.jsx("p",{className:"journey-post-content",children:X.content}),X.imageURL&&r.jsx("div",{className:"journey-post-image",children:r.jsx("img",{src:X.imageURL,alt:"Post",loading:"lazy"})}),r.jsxs("div",{className:"journey-post-actions",children:[r.jsxs("button",{className:`journey-action-btn${T.has(X.id)?" liked":""}`,onClick:()=>be(X.id),children:[r.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:T.has(X.id)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})}),r.jsx("span",{children:X.likeCount||0})]}),r.jsxs("button",{className:`journey-action-btn${V.has(X.id)?" active":""}`,onClick:()=>De(X.id),children:[r.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})}),r.jsx("span",{children:X.commentCount||0})]})]}),V.has(X.id)&&r.jsxs("div",{className:"journey-comments",children:[L[X.id]?.length>0?L[X.id].map(se=>r.jsxs("div",{className:"journey-comment",children:[r.jsx("div",{className:"journey-comment-avatar",onClick:()=>p(`/client/core-buddy/profile/${se.authorId}`),children:se.authorPhotoURL?r.jsx("img",{src:se.authorPhotoURL,alt:""}):r.jsx("span",{children:yh(se.authorName)})}),r.jsxs("div",{className:"journey-comment-body",children:[r.jsxs("div",{className:"journey-comment-bubble",children:[r.jsx("span",{className:"journey-comment-name",children:se.authorName}),r.jsx("span",{className:"journey-comment-text",children:se.content})]}),r.jsx("span",{className:"journey-comment-time",children:O2(se.createdAt)})]})]},se.id)):r.jsx("p",{className:"journey-no-comments",children:"No comments yet"}),r.jsxs("div",{className:"journey-comment-input",style:{position:"relative"},children:[r.jsx("input",{type:"text",placeholder:"Comment... (@ to mention)",value:Le[X.id]||"",onChange:se=>at(X.id,se.target.value),onKeyDown:se=>{se.key==="Enter"&&gt(X.id)},maxLength:300}),lt&&Wt===X.id&&Gt.length>0&&r.jsx("div",{className:"mention-dropdown mention-dropdown-up",children:Gt.map(se=>r.jsxs("button",{className:"mention-option",onClick:()=>Ke(se,X.id),children:[r.jsx("div",{className:"mention-option-avatar",children:se.photoURL?r.jsx("img",{src:se.photoURL,alt:""}):r.jsx("span",{children:yh(se.name)})}),r.jsx("span",{children:se.name})]},se.id))}),r.jsx("button",{onClick:()=>gt(X.id),disabled:!(Le[X.id]||"").trim()||$[X.id],children:$[X.id]?r.jsx("div",{className:"journey-btn-spinner-sm"}):r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"22",y1:"2",x2:"11",y2:"13"}),r.jsx("polygon",{points:"22 2 15 22 11 13 2 9 22 2"})]})})]})]})]},X.id))})]})]}),r.jsx(Ta,{}),Y&&r.jsxs("div",{className:`toast-notification ${Y.type}`,children:[r.jsx("span",{className:"toast-icon",children:Y.type==="success"?r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M5 13 L9 17 L19 7"})}):Y.type==="error"?r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]}):r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),r.jsx("circle",{cx:"12",cy:"16",r:"1",fill:"currentColor"})]})}),r.jsx("span",{className:"toast-message",children:Y.message})]})]})}):r.jsxs("div",{className:"prf-page","data-theme":u?"dark":"light",children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>p(-1),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions"})]})}),r.jsx("main",{className:"prf-main",children:r.jsx("p",{style:{textAlign:"center",color:"var(--text-tertiary)",padding:"40px 0"},children:"User not found"})}),r.jsx(Ta,{})]})}const ng=[{text:"Build your dashboard...",bold:"your way"},{text:"Pick what matters to you...",bold:"nothing else"},{text:"Your goals, your layout...",bold:"your rules"}],B2=[{id:"stats",label:"Stats Rings",desc:"Programme %, workouts this week, habits today",icon:"rings",defaultOn:!0},{id:"workouts",label:"Workouts",desc:"Sessions this week and total count",icon:"dumbbell",defaultOn:!0},{id:"habits",label:"Habits",desc:"Daily habit tracker dots",icon:"check",defaultOn:!0},{id:"pbs",label:"Personal Bests",desc:"Your top lifts at a glance",icon:"trophy"},{id:"nutrition",label:"Nutrition",desc:"Macro rings  protein, carbs, fats, cals",icon:"apple"},{id:"leaderboard",label:"Leaderboard",desc:"See where you rank among buddies",icon:"podium"},{id:"achievements",label:"Achievements",desc:"Badge showcase and progress",icon:"medal"},{id:"journey",label:"Journey",desc:"Your posts, likes and comments feed",icon:"feed"},{id:"coach",label:"Coach Message",desc:"Motivational nudge from Buddy",icon:"message",defaultOn:!0},{id:"nudge",label:"Smart Nudge",desc:"Contextual reminder of what to do next",icon:"lightbulb"}];function F6(n){switch(n){case"rings":return r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("circle",{cx:"12",cy:"12",r:"6"}),r.jsx("circle",{cx:"12",cy:"12",r:"2"})]});case"dumbbell":return r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M6.5 6.5h11v11h-11z",strokeLinejoin:"round"}),r.jsx("line",{x1:"2",y1:"12",x2:"6.5",y2:"12"}),r.jsx("line",{x1:"17.5",y1:"12",x2:"22",y2:"12"})]});case"check":return r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("polyline",{points:"20 6 9 17 4 12"})});case"trophy":return r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M6 9H3V6a1 1 0 0 1 1-1h2M18 9h3V6a1 1 0 0 0-1-1h-2"}),r.jsx("path",{d:"M6 5h12v7a6 6 0 0 1-12 0V5z"}),r.jsx("path",{d:"M9 21h6"}),r.jsx("path",{d:"M12 17v4"})]});case"apple":return r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M12 3c-1.5 0-3 1-3 1s-3-.5-4.5 1.5S3 9 3 12s1.5 6 3 8 3 3 6 3 4.5-1 6-3 3-5 3-8-1.5-4-3-6.5S13.5 3 12 3z"}),r.jsx("path",{d:"M12 3c0 0 1-2 3-2"})]});case"podium":return r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("rect",{x:"2",y:"14",width:"6",height:"8",rx:"1"}),r.jsx("rect",{x:"9",y:"8",width:"6",height:"14",rx:"1"}),r.jsx("rect",{x:"16",y:"11",width:"6",height:"11",rx:"1"})]});case"medal":return r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"15",r:"6"}),r.jsx("path",{d:"M8.21 13.89L7 2h10l-1.21 11.89"})]});case"feed":return r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"3"}),r.jsx("line",{x1:"3",y1:"9",x2:"21",y2:"9"}),r.jsx("line",{x1:"3",y1:"15",x2:"21",y2:"15"})]});case"message":return r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})});case"lightbulb":return r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M9 18h6"}),r.jsx("path",{d:"M10 22h4"}),r.jsx("path",{d:"M12 2a7 7 0 0 0-4 12.7V17h8v-2.3A7 7 0 0 0 12 2z"})]});default:return null}}function z6(){const n=tr(),{clientData:e,currentUser:t,updateClientData:i,resolveClient:l}=Ir(),[u,d]=b.useState({hours:0,minutes:0,seconds:0}),[p,g]=b.useState(0),[y,x]=b.useState(0),[_,j]=b.useState(null),[O,K]=b.useState(!1),B=b.useRef(null),[D,te]=b.useState(()=>{const L=e?.dashboardWidgets;return L&&Array.isArray(L)?L:B2.filter(A=>A.defaultOn).map(A=>A.id)}),[Y,Z]=b.useState(!1),[ke,Re]=b.useState(!1),[_e,C]=b.useState(null);b.useEffect(()=>{e?.photoURL&&j(e.photoURL)},[e?.photoURL]),b.useEffect(()=>{const L=()=>{const Le=new Date,ht=new Date(Le);ht.setHours(23,59,59,999);const $=ht-Le;d({hours:Math.floor($/36e5),minutes:Math.floor($%36e5/6e4),seconds:Math.floor($%6e4/1e3)}),g(60-Math.floor($%6e4/1e3))};L();const A=setInterval(L,1e3);return()=>clearInterval(A)},[]),b.useEffect(()=>{const L=setInterval(()=>x(A=>(A+1)%ng.length),8e3);return()=>clearInterval(L)},[]);const T=async L=>{const A=L.target.files?.[0];if(!(!A||!e?.id)){K(!0);try{const Le=yi(bi,`profilePhotos/${e.id}`);await Mh(Le,A);const ht=await fo(Le);await oa(Xe(ge,"clients",e.id),{photoURL:ht}),j(ht),i({photoURL:ht})}catch(Le){console.error("Photo upload error:",Le)}finally{K(!1)}}},M=L=>{Re(!1),te(A=>A.includes(L)?A.filter(Le=>Le!==L):[...A,L])},V=(L,A)=>{Re(!1),te(Le=>{const ht=Le.indexOf(L);if(ht<0)return Le;const $=ht+A;if($<0||$>=Le.length)return Le;const pe=[...Le];return[pe[ht],pe[$]]=[pe[$],pe[ht]],pe})},I=async()=>{Z(!0),C(null);try{const L=e||await l();if(!L?.id){C("Could not find your profile. Try refreshing."),Z(!1);return}await oa(Xe(ge,"clients",L.id),{dashboardWidgets:D}),i({dashboardWidgets:D}),Re(!0)}catch(L){console.error("Save config error:",L),C("Save failed  please try again.")}finally{Z(!1)}};return r.jsx(Sa,{children:r.jsxs("div",{className:"bldr-page",children:[r.jsxs("div",{className:"bldr-container",children:[r.jsxs("div",{className:"bldr-header",children:[r.jsx("button",{className:"bldr-back",onClick:()=>n("/client/core-buddy"),children:r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("h1",{className:"bldr-title",children:"Build Your Dashboard"})]}),r.jsxs("div",{className:"bldr-ring-container",children:[r.jsxs("div",{className:"bldr-ring",children:[r.jsx("svg",{className:"bldr-ring-svg",viewBox:"0 0 200 200",children:Em.map((L,A)=>r.jsx("line",{x1:L.x1,y1:L.y1,x2:L.x2,y2:L.y2,className:`bldr-tick ${A<p?"elapsed":"remaining"}`,strokeWidth:L.thick?"3":"2"},A))}),r.jsxs("div",{className:"bldr-ring-center",children:[r.jsxs("div",{className:"bldr-ring-photo",onClick:()=>B.current?.click(),children:[r.jsx("img",{src:_||"/Logo.webp",alt:_?"Profile":"Mind Core Fitness"}),r.jsx("div",{className:`bldr-photo-overlay${O?" uploading":""}`,children:O?r.jsx("div",{className:"bldr-photo-spinner"}):r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"#fff",strokeWidth:"2",children:[r.jsx("path",{d:"M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"}),r.jsx("circle",{cx:"12",cy:"13",r:"4"})]})}),r.jsx("input",{ref:B,type:"file",accept:"image/*",onChange:T,style:{display:"none"}})]}),!_&&!O&&r.jsx("div",{className:"bldr-photo-badge",onClick:()=>B.current?.click(),children:r.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"#fff",strokeWidth:"2.5",children:[r.jsx("path",{d:"M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"}),r.jsx("circle",{cx:"12",cy:"13",r:"4"})]})})]})]}),r.jsxs("div",{className:"bldr-countdown",children:[r.jsx("span",{className:"bldr-timer-digit",children:String(u.hours).padStart(2,"0")}),r.jsx("span",{className:"bldr-timer-colon",children:":"}),r.jsx("span",{className:"bldr-timer-digit",children:String(u.minutes).padStart(2,"0")}),r.jsx("span",{className:"bldr-timer-colon",children:":"}),r.jsx("span",{className:"bldr-timer-digit bldr-timer-sec",children:String(u.seconds).padStart(2,"0")})]}),r.jsx("span",{className:"bldr-ring-label",children:"remaining today"}),r.jsxs("p",{className:"bldr-tagline",children:[ng[y].text," ",r.jsx("strong",{children:ng[y].bold})]})]}),r.jsxs("div",{className:"bldr-section",children:[r.jsx("h2",{className:"bldr-section-title",children:"Choose Your Widgets"}),r.jsx("p",{className:"bldr-section-desc",children:"The countdown ring and your profile always stay at the top. Pick what goes below."}),r.jsx("div",{className:"bldr-widgets-list",children:B2.map(L=>{const A=D.includes(L.id),Le=D.indexOf(L.id);return r.jsxs("div",{className:`bldr-widget-card${A?" active":""}`,children:[r.jsx("div",{className:"bldr-widget-icon",children:F6(L.icon)}),r.jsxs("div",{className:"bldr-widget-info",children:[r.jsx("div",{className:"bldr-widget-label",children:L.label}),r.jsx("div",{className:"bldr-widget-desc",children:L.desc})]}),r.jsxs("div",{className:"bldr-widget-actions",children:[A&&r.jsxs("div",{className:"bldr-widget-order",children:[r.jsx("button",{className:"bldr-order-btn",onClick:()=>V(L.id,-1),disabled:Le===0,"aria-label":"Move up",children:r.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:r.jsx("path",{d:"M18 15l-6-6-6 6"})})}),r.jsx("span",{className:"bldr-order-num",children:Le+1}),r.jsx("button",{className:"bldr-order-btn",onClick:()=>V(L.id,1),disabled:Le===D.length-1,"aria-label":"Move down",children:r.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:r.jsx("path",{d:"M6 9l6 6 6-6"})})})]}),r.jsx("button",{className:`bldr-toggle${A?" on":""}`,onClick:()=>M(L.id),"aria-label":A?`Remove ${L.label}`:`Add ${L.label}`,children:r.jsx("div",{className:"bldr-toggle-thumb"})})]})]},L.id)})})]}),r.jsxs("div",{className:"bldr-save-wrap",children:[r.jsx("button",{className:`bldr-save-btn${ke?" saved":""}`,onClick:I,disabled:Y||ke,children:Y?"Saving...":ke?"Saved":"Save Dashboard"}),_e&&r.jsx("p",{className:"bldr-save-error",children:_e}),ke&&r.jsx("button",{className:"bldr-view-btn",onClick:()=>n("/client/core-buddy"),children:"View Dashboard"})]})]}),r.jsx(Ta,{active:"home"})]})})}const ba=[{key:"pressUps",name:"Press-Ups",category:"Upper Body",unit:"reps"},{key:"squats",name:"Squats",category:"Lower Body",unit:"reps"},{key:"longJump",name:"Standing Long Jump",category:"Power",unit:"distance"},{key:"deadHang",name:"Dead Hang",category:"Upper Body",unit:"time"},{key:"plank",name:"Plank",category:"Core",unit:"time"},{key:"wallSit",name:"Wall Sit",category:"Lower Body",unit:"time"},{key:"chestPress",name:"Chest Press",category:"Upper Body",unit:"weight"}],$o=[{key:"weight",name:"Weight",suffix:"kg"},{key:"chest",name:"Chest",suffix:"cm"},{key:"waist",name:"Waist",suffix:"cm"},{key:"hips",name:"Hips",suffix:"cm"},{key:"leftArm",name:"Left Arm",suffix:"cm"},{key:"rightArm",name:"Right Arm",suffix:"cm"},{key:"leftThigh",name:"Left Thigh",suffix:"cm"},{key:"rightThigh",name:"Right Thigh",suffix:"cm"}];function q6(){const n=new Date;return`${n.getFullYear()}-${String(n.getMonth()+1).padStart(2,"0")}`}function va(n){const[e,t]=n.split("-");return new Date(parseInt(e),parseInt(t)-1).toLocaleDateString("en-GB",{month:"long",year:"numeric"})}function H6(n){if(!n&&n!==0)return"-";const e=Math.floor(n/60),t=(n%60).toFixed(2);return e>0?`${e}m ${parseFloat(t).toFixed(0)}s`:`${parseFloat(t).toFixed(2)}s`}function $6(n,e){return!n&&n!==0?"-":!e&&e!==0?`${n}kg`:`${n}kg x ${e}`}function bh(n,e){if(!e)return"-";switch(n.unit){case"weight":return $6(e.weight,e.reps);case"time":return H6(e.time);case"reps":return e.reps?`${e.reps} reps`:"-";case"distance":return e.distance?`${e.distance} cm`:"-";default:return"-"}}function ql(n,e){if(!e)return 0;switch(n.unit){case"weight":return(e.weight||0)*(e.reps||0);case"time":return e.time||0;case"reps":return e.reps||0;case"distance":return e.distance||0;default:return 0}}function rg(n,e){return!e||e===0?null:(n-e)/e*100}function W6({data:n,exerciseKey:e,unit:t}){if(!n||n.length<2)return r.jsx("div",{className:"pb-trend-empty",children:r.jsx("p",{children:"Not enough data for trend line yet"})});const i=n.map(B=>{const D=B.benchmarks?.[e];if(!D)return 0;switch(t){case"weight":return(D.weight||0)*(D.reps||0);case"time":return D.time||0;case"reps":return D.reps||0;case"distance":return D.distance||0;default:return 0}}),l=Math.max(...i),u=Math.min(...i),d=l-u||1,p=300,g=100,y=20,x=p-y*2,_=g-y*2,j=i.map((B,D)=>{const te=y+D/(i.length-1)*x,Y=y+_-(B-u)/d*_;return{x:te,y:Y,value:B}}),O=j.map((B,D)=>`${D===0?"M":"L"} ${B.x} ${B.y}`).join(" "),K=O+` L ${j[j.length-1].x} ${y+_} L ${j[0].x} ${y+_} Z`;return r.jsxs("div",{className:"pb-trend-chart",children:[r.jsxs("svg",{viewBox:`0 0 ${p} ${g}`,preserveAspectRatio:"xMidYMid meet",children:[r.jsx("defs",{children:r.jsxs("linearGradient",{id:"trendGradientJr",x1:"0",y1:"0",x2:"0",y2:"1",children:[r.jsx("stop",{offset:"0%",stopColor:"var(--color-primary)",stopOpacity:"0.3"}),r.jsx("stop",{offset:"100%",stopColor:"var(--color-primary)",stopOpacity:"0.02"})]})}),r.jsx("path",{d:K,fill:"url(#trendGradientJr)"}),r.jsx("path",{d:O,fill:"none",stroke:"var(--color-primary)",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round"}),j.map((B,D)=>r.jsx("circle",{cx:B.x,cy:B.y,r:"4",fill:"var(--bg-card)",stroke:"var(--color-primary)",strokeWidth:"2"},D))]}),r.jsx("div",{className:"pb-trend-labels",children:n.map((B,D)=>r.jsxs("span",{className:"pb-trend-label",children:[B.month.split("-")[1],"/",B.month.split("-")[0].slice(2)]},D))})]})}function G6(){const[n,e]=b.useState("bests"),[t,i]=b.useState([]),[l,u]=b.useState(!0),[d,p]=b.useState(!1),[g,y]=b.useState(0),[x,_]=b.useState(!1),[j,O]=b.useState(!1),[K,B]=b.useState(!1),[D,te]=b.useState({}),[Y,Z]=b.useState({}),[ke,Re]=b.useState({}),[_e,C]=b.useState({}),[T,M]=b.useState({}),[V,I]=b.useState(!1),[L,A]=b.useState({}),[Le,ht]=b.useState([]),[$,pe]=b.useState(null),[Be,We]=b.useState(null),[J,P]=b.useState(!1),[re,Fe]=b.useState(""),[qe,Ve]=b.useState(""),Me=b.useRef(null),mt=b.useRef(0),wt=b.useRef(0),ot=b.useRef("right"),es=b.useCallback(F=>{y(ye=>{const Ee=Math.max(0,Math.min(ba.length-1,F));return Ee===ye?ye:(ot.current=Ee>ye?"right":"left",Ee)})},[]),{currentUser:Ns,isClient:Ft,clientData:Tt,loading:oe}=Ir(),{isDark:Dt}=Ca(),Nt=tr(),Kt=b.useCallback((F,ye="info")=>{We({message:F,type:ye}),setTimeout(()=>We(null),4e3)},[]);b.useEffect(()=>{!oe&&(!Ns||!Ft)&&Nt("/")},[Ns,Ft,oe,Nt]),b.useEffect(()=>{Tt&&Et()},[Tt]);const Et=async()=>{try{const F=As(Ht(ge,"juniorPBs"),gs("clientId","==",Tt.id)),Ee=(await Ts(F)).docs.map(ft=>({id:ft.id,...ft.data()}));Ee.sort((ft,zt)=>ft.month.localeCompare(zt.month)),i(Ee);const Te=As(Ht(ge,"juniorPBTargets"),gs("clientId","==",Tt.id)),Se=await Ts(Te);if(!Se.empty){const ft=Se.docs[0].data();Re(ft.targets||{}),C(ft.metricTargets||{}),M(ft.targets||{}),A(ft.metricTargets||{})}const bt=As(Ht(ge,"juniorAchievements"),gs("clientId","==",Tt.id)),At=await Ts(bt);At.empty||ht(At.docs[0].data().badges||[])}catch(F){console.error("Error fetching junior personal bests:",F)}u(!1)},Ct=q6(),lt=t.find(F=>F.month===Ct),Ot=t.filter(F=>F.month<Ct),Wt=Ot.length>0?Ot[Ot.length-1]:null;b.useEffect(()=>{lt?(te(lt.benchmarks||{}),Z(lt.bodyMetrics||{})):(te({}),Z({}))},[lt?.id]);const ms=async(F,ye)=>{const Ee=[];if(F==="strength"?ba.forEach(Te=>{const Se=ke[Te.key];if(!Se)return;const bt=ye[Te.key];if(!bt)return;let At;if(Se.targetType==="time"){if(!Se.targetValue)return;const ft=Se.startValue||0,zt=bt.time||0,Bt=Se.targetValue-ft;At=Bt===0?zt>=Se.targetValue?1:0:Math.max(0,(zt-ft)/Bt)}else if(Se.targetType==="reps"){if(!Se.targetReps)return;const ft=Se.startReps||0,zt=bt.reps||0,Bt=Se.targetReps-ft;At=Bt===0?zt>=Se.targetReps?1:0:Math.max(0,(zt-ft)/Bt)}else if(Se.targetType==="distance"){if(!Se.targetDistance)return;const ft=Se.startDistance||0,zt=bt.distance||0,Bt=Se.targetDistance-ft;At=Bt===0?zt>=Se.targetDistance?1:0:Math.max(0,(zt-ft)/Bt)}else{if(!Se.targetWeight&&!Se.targetReps)return;const ft=(Se.startWeight||0)*(Se.startReps||0),zt=(Se.targetWeight||0)*(Se.targetReps||0),Bt=(bt.weight||0)*(bt.reps||0),Ps=zt-ft;At=Ps===0?Bt>=zt?1:0:Math.max(0,(Bt-ft)/Ps)}if(At>=1){let ft,zt;Se.targetType==="time"?(ft=Le.some(Bt=>Bt.type==="strength"&&Bt.key===Te.key&&Bt.targetValue===Se.targetValue),zt=`${Te.name} ${Se.targetValue}s`):Se.targetType==="reps"?(ft=Le.some(Bt=>Bt.type==="strength"&&Bt.key===Te.key&&Bt.targetReps===Se.targetReps),zt=`${Te.name} ${Se.targetReps} reps`):Se.targetType==="distance"?(ft=Le.some(Bt=>Bt.type==="strength"&&Bt.key===Te.key&&Bt.targetDistance===Se.targetDistance),zt=`${Te.name} ${Se.targetDistance}cm`):(ft=Le.some(Bt=>Bt.type==="strength"&&Bt.key===Te.key&&Bt.targetWeight===Se.targetWeight&&Bt.targetReps===Se.targetReps),zt=`${Te.name} ${Se.targetWeight}kg  ${Se.targetReps}`),ft||Ee.push({type:"strength",key:Te.key,...Se.targetType==="time"?{targetType:"time",targetValue:Se.targetValue}:Se.targetType==="reps"?{targetType:"reps",targetReps:Se.targetReps}:Se.targetType==="distance"?{targetType:"distance",targetDistance:Se.targetDistance}:{targetWeight:Se.targetWeight,targetReps:Se.targetReps},achievedMonth:Ct,label:zt})}}):$o.forEach(Te=>{const Se=_e[Te.key];if(!Se||!Se.targetValue)return;const bt=ye[Te.key];if(bt==null)return;const At=Se.startValue||0,ft=Se.targetValue,zt=ft-At;(zt===0?bt===ft?1:0:Math.max(0,(bt-At)/zt))>=1&&(Le.some(hn=>hn.type==="metric"&&hn.key===Te.key&&hn.targetValue===ft)||Ee.push({type:"metric",key:Te.key,targetValue:ft,achievedMonth:Ct,label:`${Te.name} ${ft}${Te.suffix}`}))}),Ee.length>0){const Te=[...Le,...Ee];await Ds(Xe(ge,"juniorAchievements",Tt.id),{clientId:Tt.id,badges:Te,updatedAt:Mt.now()}),ht(Te),pe(Ee),setTimeout(()=>pe(null),5e3)}},Gt=(F,ye)=>{if(F==="strength"){const Ee=ke[ye];if(!Ee)return!1;switch(ba.find(Se=>Se.key===ye)?.unit){case"time":return Le.some(Se=>Se.type==="strength"&&Se.key===ye&&Se.targetValue===Ee.targetValue);case"reps":return Le.some(Se=>Se.type==="strength"&&Se.key===ye&&Se.targetReps===Ee.targetReps);case"distance":return Le.some(Se=>Se.type==="strength"&&Se.key===ye&&Se.targetDistance===Ee.targetDistance);default:return!Ee.targetWeight&&!Ee.targetReps?!1:Le.some(Se=>Se.type==="strength"&&Se.key===ye&&Se.targetWeight===Ee.targetWeight&&Se.targetReps===Ee.targetReps)}}else{const Ee=_e[ye];return!Ee||!Ee.targetValue?!1:Le.some(Te=>Te.type==="metric"&&Te.key===ye&&Te.targetValue===Ee.targetValue)}},Pt=async()=>{p(!0);try{const F=`${Tt.id}_${Ct}`,ye=lt||{};await Ds(Xe(ge,"juniorPBs",F),{clientId:Tt.id,month:Ct,benchmarks:D,bodyMetrics:ye.bodyMetrics||Y||{},createdAt:ye.createdAt||Mt.now(),updatedAt:Mt.now()}),await ms("strength",D),Kt("Benchmarks saved!","success"),_(!1),await Et()}catch(F){console.error("Error saving benchmarks:",F),Kt("Failed to save. Please try again.","error")}p(!1)},us=async()=>{p(!0);try{const F=`${Tt.id}_${Ct}`,ye=lt||{};await Ds(Xe(ge,"juniorPBs",F),{clientId:Tt.id,month:Ct,benchmarks:ye.benchmarks||D||{},bodyMetrics:Y,createdAt:ye.createdAt||Mt.now(),updatedAt:Mt.now()}),await ms("metric",Y),Kt("Body metrics saved!","success"),O(!1),await Et()}catch(F){console.error("Error saving metrics:",F),Kt("Failed to save. Please try again.","error")}p(!1)},xs=(F,ye,Ee)=>{te(Te=>({...Te,[F]:{...Te[F],[ye]:Ee===""?"":parseFloat(Ee)}}))},is=(F,ye)=>{Z(Ee=>({...Ee,[F]:ye===""?"":parseFloat(ye)}))},Qs=(F,ye,Ee)=>{M(Te=>({...Te,[F]:{...Te[F],[ye]:Ee===""?"":parseFloat(Ee)}}))},Ms=async()=>{p(!0);try{const F=`targets_${Tt.id}`,ye=lt?.benchmarks||{},Ee={};ba.forEach(Te=>{const Se=ye[Te.key];switch(Te.unit){case"time":T[Te.key]?.targetValue&&(Ee[Te.key]={targetType:"time",targetValue:T[Te.key].targetValue,startValue:Se?.time||0});break;case"reps":T[Te.key]?.targetReps&&(Ee[Te.key]={targetType:"reps",targetReps:T[Te.key].targetReps,startReps:Se?.reps||0});break;case"distance":T[Te.key]?.targetDistance&&(Ee[Te.key]={targetType:"distance",targetDistance:T[Te.key].targetDistance,startDistance:Se?.distance||0});break;default:(T[Te.key]?.targetWeight||T[Te.key]?.targetReps)&&(Ee[Te.key]={targetWeight:T[Te.key].targetWeight||0,targetReps:T[Te.key].targetReps||0,startWeight:Se?.weight||0,startReps:Se?.reps||0})}}),await Ds(Xe(ge,"juniorPBTargets",F),{clientId:Tt.id,targets:Ee,metricTargets:_e,updatedAt:Mt.now()}),Re(Ee),M(Ee),Kt("Targets saved!","success"),B(!1)}catch(F){console.error("Error saving targets:",F),Kt("Failed to save targets.","error")}p(!1)},Fs=(F,ye)=>{A(Ee=>({...Ee,[F]:{...Ee[F],targetValue:ye===""?"":parseFloat(ye)}}))},os=async()=>{p(!0);try{const F=`targets_${Tt.id}`,ye={};$o.forEach(Ee=>{if(L[Ee.key]?.targetValue){const Te=lt?.bodyMetrics?.[Ee.key]||0;ye[Ee.key]={targetValue:L[Ee.key].targetValue,startValue:Te}}}),await Ds(Xe(ge,"juniorPBTargets",F),{clientId:Tt.id,targets:ke,metricTargets:ye,updatedAt:Mt.now()}),C(ye),A(ye),Kt("Metric targets saved!","success"),I(!1)}catch(F){console.error("Error saving metric targets:",F),Kt("Failed to save targets.","error")}p(!1)},ws=async()=>{if(window.confirm("Reset all goals? This will clear all strength and body metric targets. Your recorded benchmarks and measurements will NOT be affected.")){p(!0);try{const F=Xe(ge,"juniorPBTargets",`targets_${Tt.id}`);await lr(F),Re({}),C({}),M({}),A({}),Kt("All goals have been reset","success")}catch(F){console.error("Error resetting targets:",F),Kt("Failed to reset goals","error")}p(!1)}},be=(F,ye)=>{const Ee=ke[F];if(!Ee||!ye)return null;if(Ee.targetType==="time"){if(!Ee.targetValue)return null;const ft=Ee.startValue||0,zt=Ee.targetValue,Bt=ye.time||0,Ps=zt-ft;return Ps<=0?Bt>=zt?1:0:Math.max(0,Math.min((Bt-ft)/Ps,1))}if(Ee.targetType==="reps"){if(!Ee.targetReps)return null;const ft=Ee.startReps||0,zt=Ee.targetReps,Bt=ye.reps||0,Ps=zt-ft;return Ps<=0?Bt>=zt?1:0:Math.max(0,Math.min((Bt-ft)/Ps,1))}if(Ee.targetType==="distance"){if(!Ee.targetDistance)return null;const ft=Ee.startDistance||0,zt=Ee.targetDistance,Bt=ye.distance||0,Ps=zt-ft;return Ps<=0?Bt>=zt?1:0:Math.max(0,Math.min((Bt-ft)/Ps,1))}if(!Ee.targetWeight&&!Ee.targetReps)return null;const Te=(Ee.startWeight||0)*(Ee.startReps||0),Se=(Ee.targetWeight||0)*(Ee.targetReps||0),bt=(ye.weight||0)*(ye.reps||0),At=Se-Te;return At<=0?bt>=Se?1:0:Math.max(0,Math.min((bt-Te)/At,1))},Ie=F=>{const ye=_e[F];if(!ye||!ye.targetValue)return null;const Ee=lt?.bodyMetrics?.[F];if(Ee==null)return null;const Te=ye.startValue||0,Se=ye.targetValue,bt=Se-Te;return bt===0?Ee===Se?1:0:Math.max(0,Math.min((Ee-Te)/bt,1))},De=F=>{mt.current=F.touches[0].clientX,wt.current=0},rt=F=>{wt.current=F.touches[0].clientX-mt.current},Ke=()=>{wt.current<-50?es(g+1):wt.current>50&&es(g-1),wt.current=0},at=F=>{const ye=lt?.bodyMetrics?.[F],Ee=Wt?.bodyMetrics?.[F];return ye==null||Ee==null?null:parseFloat((ye-Ee).toFixed(2))},gt=t.find(F=>F.month===re),X=t.find(F=>F.month===qe);if(oe||l)return r.jsxs("div",{className:"pb-page",children:[r.jsx("header",{className:"client-header",children:r.jsx("div",{className:"header-content",children:r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})})}),r.jsxs("main",{className:"pb-main",children:[r.jsx("div",{className:"skeleton skeleton-title",style:{width:180,height:28,marginBottom:20}}),r.jsx("div",{className:"skeleton skeleton-card-large",style:{height:320,borderRadius:16}})]})]});if(!Ns||!Ft||!Tt)return null;const se=ba[g],Qe=lt?.benchmarks?.[se.key],_t=Wt?.benchmarks?.[se.key],et=ql(se,Qe),kt=ql(se,_t),Q=rg(et,kt),Ae=be(se.key,Qe),Je=Ae!==null,yt=Ae!==null&&Ae>=1,it=Je?Math.round(Ae*60):et>0?15:0,Jt=ke[se.key],Yt=F=>F?F.targetType==="time"?`${F.startValue||0}s  ${F.targetValue}s`:F.targetType==="reps"?`${F.startReps||0}  ${F.targetReps} reps`:F.targetType==="distance"?`${F.startDistance||0}  ${F.targetDistance}cm`:`${F.startWeight||0}kg${F.startReps||0}  ${F.targetWeight}kg${F.targetReps}`:null;return r.jsxs("div",{className:"pb-page",children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>Nt("/client"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})]})}),r.jsxs("main",{className:"pb-main page-transition-enter",children:[r.jsxs("div",{className:"pb-intro",children:[r.jsx("h2",{children:"Junior Strength Tests"}),r.jsx("p",{children:"Track your strength test results and body measurements each month."})]}),r.jsxs("div",{className:"pb-tabs",children:[r.jsx("button",{className:`pb-tab ${n==="bests"?"active":""}`,onClick:()=>e("bests"),children:"Strength"}),r.jsx("button",{className:`pb-tab ${n==="metrics"?"active":""}`,onClick:()=>e("metrics"),children:"Body Metrics"}),r.jsx("button",{className:`pb-tab ${n==="history"?"active":""}`,onClick:()=>e("history"),children:"History"})]}),n==="bests"&&r.jsxs("div",{className:"pb-strength-section",children:[!x&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"pb-carousel",ref:Me,onTouchStart:De,onTouchMove:rt,onTouchEnd:Ke,children:[r.jsx("div",{className:`pb-ring-container slide-from-${ot.current}`,children:r.jsxs("div",{className:"pb-ring",children:[r.jsx("svg",{className:"pb-ring-svg",viewBox:"0 0 200 200",children:Em.map((F,ye)=>{const Ee=ye<Math.round(it);return r.jsx("line",{x1:F.x1,y1:F.y1,x2:F.x2,y2:F.y2,className:`pb-ring-tick ${Ee?yt?"hit":"filled":"empty"}`,strokeWidth:F.thick?"3":"2"},ye)})}),r.jsxs("div",{className:"pb-ring-center",children:[r.jsx("div",{className:"pb-ring-category",children:se.category}),r.jsxs("div",{className:"pb-ring-exercise",children:[se.name,Gt("strength",se.key)&&r.jsx("svg",{className:"pb-badge-icon",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})]}),r.jsx("div",{className:"pb-ring-value",children:Qe?bh(se,Qe):"-"}),Q!==null&&r.jsxs("div",{className:`pb-ring-change ${Q>=0?"positive":"negative"}`,children:[Q>=0?"+":"",Q.toFixed(1),"%"]}),Q===null&&Qe&&r.jsx("div",{className:"pb-ring-change neutral",children:"New entry"}),Jt&&r.jsx("div",{className:`pb-ring-target ${yt?"hit":""}`,children:yt?"Target hit!":Yt(Jt)}),!Jt&&r.jsx("div",{className:"pb-ring-target none",children:"No target set"})]})]})},g),r.jsx("div",{className:"pb-carousel-dots",children:ba.map((F,ye)=>r.jsx("button",{className:`pb-dot ${ye===g?"active":""}`,onClick:()=>es(ye)},ye))}),r.jsx("button",{className:"pb-carousel-arrow left",onClick:()=>es(g-1),disabled:g===0,children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"})})}),r.jsx("button",{className:"pb-carousel-arrow right",onClick:()=>es(g+1),disabled:g===ba.length-1,children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M8.59 16.59L10 18l6-6-6-6-1.41 1.41L13.17 12z"})})})]}),r.jsxs("div",{className:"pb-trend-section",children:[r.jsx("h4",{children:"Trend"}),r.jsx(W6,{data:t,exerciseKey:se.key,unit:se.unit})]})]}),!x&&!K&&r.jsxs("div",{className:"pb-action-buttons",children:[r.jsx("button",{className:"pb-edit-btn",onClick:()=>_(!0),children:lt?.benchmarks?"Edit This Month's Benchmarks":"Add This Month's Benchmarks"}),r.jsx("button",{className:"pb-edit-btn pb-target-btn",onClick:()=>B(!0),children:Object.keys(ke).length>0?"Edit Targets":"Set Targets"}),(Object.keys(ke).length>0||Object.keys(_e).length>0)&&r.jsx("button",{className:"pb-edit-btn pb-reset-btn",onClick:ws,disabled:d,children:"Reset All Goals"})]}),x&&r.jsxs("div",{className:"pb-edit-card",children:[r.jsxs("div",{className:"pb-edit-header",children:[r.jsxs("h3",{children:["Benchmarks - ",va(Ct)]}),r.jsx("button",{className:"pb-edit-close",onClick:()=>{_(!1),te(lt?.benchmarks||{})},children:""})]}),r.jsx("div",{className:"pb-edit-body",children:ba.map(F=>r.jsxs("div",{className:"pb-edit-exercise",children:[r.jsx("div",{className:"pb-edit-exercise-name",children:F.name}),F.unit==="weight"?r.jsxs("div",{className:"pb-edit-row",children:[r.jsxs("div",{className:"pb-edit-field",children:[r.jsx("label",{children:"Weight (kg)"}),r.jsx("input",{type:"number",step:"0.5",value:D[F.key]?.weight??"",onChange:ye=>xs(F.key,"weight",ye.target.value),placeholder:"0"})]}),r.jsxs("div",{className:"pb-edit-field",children:[r.jsx("label",{children:"Reps"}),r.jsx("input",{type:"number",value:D[F.key]?.reps??"",onChange:ye=>xs(F.key,"reps",ye.target.value),placeholder:"0"})]})]}):F.unit==="reps"?r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsx("label",{children:"Reps (max in 1 min)"}),r.jsx("input",{type:"number",value:D[F.key]?.reps??"",onChange:ye=>xs(F.key,"reps",ye.target.value),placeholder:"0"})]})}):F.unit==="distance"?r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsx("label",{children:"Distance (cm)"}),r.jsx("input",{type:"number",step:"0.5",value:D[F.key]?.distance??"",onChange:ye=>xs(F.key,"distance",ye.target.value),placeholder:"0"})]})}):r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsx("label",{children:"Time (seconds)"}),r.jsx("input",{type:"number",step:"0.01",value:D[F.key]?.time??"",onChange:ye=>xs(F.key,"time",ye.target.value),placeholder:"0"})]})})]},F.key))}),r.jsxs("div",{className:"pb-edit-actions",children:[r.jsx("button",{className:"pb-cancel-btn",onClick:()=>{_(!1),te(lt?.benchmarks||{})},children:"Cancel"}),r.jsx("button",{className:"pb-save-btn",onClick:Pt,disabled:d,children:d?"Saving...":"Save"})]})]}),K&&r.jsxs("div",{className:"pb-edit-card",children:[r.jsxs("div",{className:"pb-edit-header",children:[r.jsx("h3",{children:"Set Your Targets"}),r.jsx("button",{className:"pb-edit-close",onClick:()=>{B(!1),M(ke)},children:""})]}),r.jsxs("div",{className:"pb-edit-body",children:[r.jsx("p",{className:"pb-target-hint",children:"Set a target for each exercise. Your current best is captured automatically from your latest benchmarks."}),ba.map(F=>{const ye=lt?.benchmarks?.[F.key];let Ee="-";if(ye)switch(F.unit){case"weight":(ye.weight||ye.reps)&&(Ee=`${ye.weight||0}kg  ${ye.reps||0}`);break;case"time":ye.time&&(Ee=`${ye.time}s`);break;case"reps":ye.reps&&(Ee=`${ye.reps} reps`);break;case"distance":ye.distance&&(Ee=`${ye.distance} cm`);break}return r.jsxs("div",{className:"pb-edit-exercise",children:[r.jsxs("div",{className:"pb-edit-exercise-header",children:[r.jsx("div",{className:"pb-edit-exercise-name",children:F.name}),r.jsxs("div",{className:"pb-edit-current-best",children:["Current: ",Ee]})]}),F.unit==="weight"?r.jsxs("div",{className:"pb-edit-row",children:[r.jsxs("div",{className:"pb-edit-field",children:[r.jsx("label",{children:"Target Weight (kg)"}),r.jsx("input",{type:"number",step:"0.5",value:T[F.key]?.targetWeight??"",onChange:Te=>Qs(F.key,"targetWeight",Te.target.value),placeholder:"0"})]}),r.jsxs("div",{className:"pb-edit-field",children:[r.jsx("label",{children:"Target Reps"}),r.jsx("input",{type:"number",value:T[F.key]?.targetReps??"",onChange:Te=>Qs(F.key,"targetReps",Te.target.value),placeholder:"0"})]})]}):F.unit==="reps"?r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsx("label",{children:"Target Reps (in 1 min)"}),r.jsx("input",{type:"number",value:T[F.key]?.targetReps??"",onChange:Te=>Qs(F.key,"targetReps",Te.target.value),placeholder:"0"})]})}):F.unit==="distance"?r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsx("label",{children:"Target Distance (cm)"}),r.jsx("input",{type:"number",step:"0.5",value:T[F.key]?.targetDistance??"",onChange:Te=>Qs(F.key,"targetDistance",Te.target.value),placeholder:"0"})]})}):r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsx("label",{children:"Target (seconds)"}),r.jsx("input",{type:"number",step:"1",value:T[F.key]?.targetValue??"",onChange:Te=>Qs(F.key,"targetValue",Te.target.value),placeholder:"0"})]})})]},F.key)})]}),r.jsxs("div",{className:"pb-edit-actions",children:[r.jsx("button",{className:"pb-cancel-btn",onClick:()=>{B(!1),M(ke)},children:"Cancel"}),r.jsx("button",{className:"pb-save-btn",onClick:Ms,disabled:d,children:d?"Saving...":"Save Targets"})]})]})]}),n==="metrics"&&r.jsxs("div",{className:"pb-metrics-section",children:[!j&&!V&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"pb-metrics-card",children:[r.jsx("h3",{children:"Body Measurements"}),r.jsx("p",{className:"pb-metrics-month",children:va(Ct)}),r.jsx("div",{className:"pb-metrics-list",children:$o.map(F=>{const ye=lt?.bodyMetrics?.[F.key],Ee=at(F.key),Te=_e[F.key],Se=Ie(F.key),bt=Se!==null&&Se>=1;return r.jsxs("div",{className:"pb-metric-row",children:[r.jsxs("div",{className:"pb-metric-top",children:[r.jsxs("div",{className:"pb-metric-left",children:[r.jsxs("span",{className:"pb-metric-name",children:[F.name,Gt("metric",F.key)&&r.jsx("svg",{className:"pb-badge-icon-sm",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})]}),Te&&r.jsxs("span",{className:"pb-metric-target-label",children:["Target: ",Te.targetValue," ",F.suffix]})]}),r.jsxs("div",{className:"pb-metric-values",children:[r.jsx("span",{className:"pb-metric-current",children:ye!=null?`${ye} ${F.suffix}`:"-"}),Ee!==null&&r.jsxs("span",{className:`pb-metric-change ${Ee>0?"up":Ee<0?"down":"same"}`,children:[Ee>0?"+":"",Ee," ",F.suffix]})]})]}),Se!==null&&r.jsxs("div",{className:"pb-metric-progress",children:[r.jsx("div",{className:"pb-metric-bar",children:r.jsx("div",{className:`pb-metric-bar-fill ${bt?"hit":""}`,style:{width:`${Math.round(Se*100)}%`}})}),r.jsx("span",{className:`pb-metric-percent ${bt?"hit":""}`,children:bt?"Hit!":`${Math.round(Se*100)}%`})]})]},F.key)})})]}),r.jsxs("div",{className:"pb-action-buttons",children:[r.jsx("button",{className:"pb-edit-btn",onClick:()=>O(!0),children:lt?.bodyMetrics?"Edit This Month's Measurements":"Add This Month's Measurements"}),r.jsx("button",{className:"pb-edit-btn pb-target-btn",onClick:()=>I(!0),children:Object.keys(_e).length>0?"Edit Targets":"Set Targets"}),(Object.keys(ke).length>0||Object.keys(_e).length>0)&&r.jsx("button",{className:"pb-edit-btn pb-reset-btn",onClick:ws,disabled:d,children:"Reset All Goals"})]})]}),j&&r.jsxs("div",{className:"pb-edit-card",children:[r.jsxs("div",{className:"pb-edit-header",children:[r.jsxs("h3",{children:["Measurements - ",va(Ct)]}),r.jsx("button",{className:"pb-edit-close",onClick:()=>{O(!1),Z(lt?.bodyMetrics||{})},children:""})]}),r.jsx("div",{className:"pb-edit-body",children:$o.map(F=>r.jsx("div",{className:"pb-edit-metric",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsxs("label",{children:[F.name," (",F.suffix,")"]}),r.jsx("input",{type:"number",step:"0.1",value:Y[F.key]??"",onChange:ye=>is(F.key,ye.target.value),placeholder:"0"})]})},F.key))}),r.jsxs("div",{className:"pb-edit-actions",children:[r.jsx("button",{className:"pb-cancel-btn",onClick:()=>{O(!1),Z(lt?.bodyMetrics||{})},children:"Cancel"}),r.jsx("button",{className:"pb-save-btn",onClick:us,disabled:d,children:d?"Saving...":"Save"})]})]}),V&&r.jsxs("div",{className:"pb-edit-card",children:[r.jsxs("div",{className:"pb-edit-header",children:[r.jsx("h3",{children:"Body Metric Targets"}),r.jsx("button",{className:"pb-edit-close",onClick:()=>{I(!1),A(_e)},children:""})]}),r.jsxs("div",{className:"pb-edit-body",children:[r.jsx("p",{className:"pb-target-hint",children:"Set targets for your body measurements. Your current measurement is captured automatically."}),$o.map(F=>{const ye=lt?.bodyMetrics?.[F.key];return r.jsxs("div",{className:"pb-edit-exercise",children:[r.jsxs("div",{className:"pb-edit-exercise-header",children:[r.jsx("div",{className:"pb-edit-exercise-name",children:F.name}),r.jsxs("div",{className:"pb-edit-current-best",children:["Current: ",ye!=null?`${ye} ${F.suffix}`:"-"]})]}),r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsxs("label",{children:["Target (",F.suffix,")"]}),r.jsx("input",{type:"number",step:"0.1",value:L[F.key]?.targetValue??"",onChange:Ee=>Fs(F.key,Ee.target.value),placeholder:"0"})]})})]},F.key)})]}),r.jsxs("div",{className:"pb-edit-actions",children:[r.jsx("button",{className:"pb-cancel-btn",onClick:()=>{I(!1),A(_e)},children:"Cancel"}),r.jsx("button",{className:"pb-save-btn",onClick:os,disabled:d,children:d?"Saving...":"Save Targets"})]})]})]}),n==="history"&&r.jsx("div",{className:"pb-history-section",children:t.length===0?r.jsxs("div",{className:"pb-empty",children:[r.jsx("h4",{children:"No records yet"}),r.jsx("p",{children:"Start adding your monthly benchmarks and measurements to track your progress over time."})]}):r.jsxs(r.Fragment,{children:[Le.length>0&&r.jsxs("div",{className:"pb-achievements-wall",children:[r.jsxs("h4",{className:"pb-achievements-wall-title",children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"18",height:"18",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),"Targets Achieved"]}),r.jsx("div",{className:"pb-achievements-list",children:[...Le].reverse().map((F,ye)=>r.jsxs("div",{className:"pb-achievement-item",style:{animationDelay:`${ye*.05}s`},children:[r.jsx("div",{className:"pb-achievement-star",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),r.jsxs("div",{className:"pb-achievement-info",children:[r.jsx("span",{className:"pb-achievement-label",children:F.label}),r.jsx("span",{className:"pb-achievement-date",children:va(F.achievedMonth)})]})]},ye))})]}),r.jsx("div",{className:"pb-history-controls",children:r.jsx("button",{className:`pb-compare-toggle ${J?"active":""}`,onClick:()=>{P(!J),!J&&t.length>=2&&(Fe(t[0].month),Ve(t[t.length-1].month))},children:J?"Back to Timeline":"Compare Months"})}),J?r.jsxs("div",{className:"pb-compare",children:[r.jsxs("div",{className:"pb-compare-selectors",children:[r.jsxs("div",{className:"pb-compare-select",children:[r.jsx("label",{children:"From"}),r.jsx("select",{value:re,onChange:F=>Fe(F.target.value),children:t.map(F=>r.jsx("option",{value:F.month,children:va(F.month)},F.month))})]}),r.jsx("div",{className:"pb-compare-vs",children:"vs"}),r.jsxs("div",{className:"pb-compare-select",children:[r.jsx("label",{children:"To"}),r.jsx("select",{value:qe,onChange:F=>Ve(F.target.value),children:t.map(F=>r.jsx("option",{value:F.month,children:va(F.month)},F.month))})]})]}),gt&&X&&r.jsxs("div",{className:"pb-compare-results",children:[r.jsxs("div",{className:"pb-compare-group",children:[r.jsx("h4",{children:"Strength Tests"}),r.jsxs("div",{className:"pb-compare-table",children:[r.jsxs("div",{className:"pb-compare-header-row",children:[r.jsx("span",{children:"Exercise"}),r.jsx("span",{children:va(re).split(" ")[0]}),r.jsx("span",{children:va(qe).split(" ")[0]}),r.jsx("span",{children:"Change"})]}),ba.map(F=>{const ye=gt.benchmarks?.[F.key],Ee=X.benchmarks?.[F.key],Te=ql(F,ye),Se=ql(F,Ee),bt=rg(Se,Te);return r.jsxs("div",{className:"pb-compare-row",children:[r.jsx("span",{className:"pb-compare-name",children:F.name}),r.jsx("span",{className:"pb-compare-val",children:ye?bh(F,ye):"-"}),r.jsx("span",{className:"pb-compare-val",children:Ee?bh(F,Ee):"-"}),r.jsx("span",{className:`pb-compare-change ${bt!==null?bt>=0?"positive":"negative":""}`,children:bt!==null?`${bt>=0?"+":""}${bt.toFixed(1)}%`:"-"})]},F.key)})]})]}),r.jsxs("div",{className:"pb-compare-group",children:[r.jsx("h4",{children:"Body Measurements"}),r.jsxs("div",{className:"pb-compare-table",children:[r.jsxs("div",{className:"pb-compare-header-row",children:[r.jsx("span",{children:"Measurement"}),r.jsx("span",{children:va(re).split(" ")[0]}),r.jsx("span",{children:va(qe).split(" ")[0]}),r.jsx("span",{children:"Change"})]}),$o.map(F=>{const ye=gt.bodyMetrics?.[F.key],Ee=X.bodyMetrics?.[F.key],Te=ye!=null&&Ee!=null?parseFloat((Ee-ye).toFixed(2)):null;return r.jsxs("div",{className:"pb-compare-row",children:[r.jsx("span",{className:"pb-compare-name",children:F.name}),r.jsx("span",{className:"pb-compare-val",children:ye!=null?`${ye}`:"-"}),r.jsx("span",{className:"pb-compare-val",children:Ee!=null?`${Ee}`:"-"}),r.jsx("span",{className:`pb-compare-change ${Te!==null?Te>0?"positive":Te<0?"negative":"neutral":""}`,children:Te!==null?`${Te>0?"+":""}${Te} ${F.suffix}`:"-"})]},F.key)})]})]})]})]}):r.jsx("div",{className:"pb-timeline",children:[...t].reverse().map((F,ye)=>{const Ee=t.filter(Te=>Te.month<F.month).pop();return r.jsxs("div",{className:"pb-timeline-item",style:{animationDelay:`${ye*.05}s`},children:[r.jsx("div",{className:"pb-timeline-dot"}),r.jsxs("div",{className:"pb-timeline-card",children:[r.jsx("h4",{children:va(F.month)}),F.benchmarks&&Object.keys(F.benchmarks).length>0&&r.jsxs("div",{className:"pb-timeline-group",children:[r.jsx("h5",{children:"Strength Tests"}),ba.map(Te=>{const Se=F.benchmarks[Te.key];if(!Se)return null;const bt=Ee?.benchmarks?.[Te.key],At=ql(Te,Se),ft=ql(Te,bt),zt=rg(At,ft);return r.jsxs("div",{className:"pb-timeline-row",children:[r.jsx("span",{className:"pb-timeline-label",children:Te.name}),r.jsxs("div",{className:"pb-timeline-values",children:[r.jsx("span",{className:"pb-timeline-value",children:bh(Te,Se)}),zt!==null&&r.jsxs("span",{className:`pb-timeline-change ${zt>=0?"positive":"negative"}`,children:[zt>=0?"+":"",zt.toFixed(1),"%"]})]})]},Te.key)})]}),F.bodyMetrics&&Object.keys(F.bodyMetrics).length>0&&r.jsxs("div",{className:"pb-timeline-group",children:[r.jsx("h5",{children:"Body Measurements"}),$o.map(Te=>{const Se=F.bodyMetrics[Te.key];if(Se==null)return null;const bt=Ee?.bodyMetrics?.[Te.key],At=bt!=null?parseFloat((Se-bt).toFixed(2)):null;return r.jsxs("div",{className:"pb-timeline-row",children:[r.jsx("span",{className:"pb-timeline-label",children:Te.name}),r.jsxs("div",{className:"pb-timeline-values",children:[r.jsxs("span",{className:"pb-timeline-value",children:[Se," ",Te.suffix]}),At!==null&&r.jsxs("span",{className:`pb-timeline-change ${At>0?"positive":At<0?"negative":"neutral"}`,children:[At>0?"+":"",At," ",Te.suffix]})]})]},Te.key)})]})]})]},F.id)})})]})})]}),$&&r.jsx("div",{className:"pb-celebration-overlay",onClick:()=>pe(null),children:r.jsxs("div",{className:"pb-celebration-card",children:[r.jsx("div",{className:"pb-celebration-icon",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),r.jsx("h3",{className:"pb-celebration-title",children:$.length===1?"Target Achieved!":`${$.length} Targets Achieved!`}),r.jsx("div",{className:"pb-celebration-badges",children:$.map((F,ye)=>r.jsx("div",{className:"pb-celebration-badge",children:F.label},ye))}),r.jsx("p",{className:"pb-celebration-sub",children:"Tap to dismiss"})]})}),Be&&r.jsxs("div",{className:`toast-notification ${Be.type}`,children:[r.jsx("span",{className:"toast-icon",children:Be.type==="success"?r.jsx("svg",{className:"success-check-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{className:"check-path",d:"M5 13 L9 17 L19 7"})}):r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})}),r.jsx("span",{className:"toast-message",children:Be.message}),r.jsx("button",{className:"toast-close",onClick:()=>We(null),children:""})]}),r.jsxs("nav",{className:"block-bottom-nav",children:[r.jsxs("button",{className:"block-nav-tab",onClick:()=>Nt("/client"),children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}),r.jsx("polyline",{points:"9 22 9 12 15 12 15 22"})]}),r.jsx("span",{children:"Home"})]}),r.jsxs("button",{className:"block-nav-tab",onClick:()=>Nt("/client/forms"),children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),r.jsx("polyline",{points:"14 2 14 8 20 8"}),r.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),r.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"})]}),r.jsx("span",{children:"Forms"})]}),r.jsxs("button",{className:"block-nav-tab",onClick:()=>Nt("/client/tools"),children:[r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"})}),r.jsx("span",{children:"Tools"})]}),r.jsxs("button",{className:"block-nav-tab active",children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M12 20V10"}),r.jsx("path",{d:"M18 20V4"}),r.jsx("path",{d:"M6 20v-4"})]}),r.jsx("span",{children:"PBs"})]}),Tt?.circuitAccess&&r.jsxs("button",{className:"block-nav-tab",onClick:()=>Nt("/client/circuit"),children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("path",{d:"M12 6v6l4 2"})]}),r.jsx("span",{children:"Circuit"})]})]})]})}const Qk=[{name:"Dumbbell Floor Press",type:"weighted",equipment:"dumbbells",group:"push",pbKey:"chestPress",storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Seated Dumbbell Shoulder Press",type:"weighted",equipment:"dumbbells",group:"push",pbKey:"shoulderPress",storagePath:"exercises/dumbbells/upper/seated dumbbell shoulder press.mp4"},{name:"Seated Dumbbell Arnold Press",type:"weighted",equipment:"dumbbells",group:"push",storagePath:"exercises/dumbbells/upper/seated dumbbell arnold press.mp4"},{name:"Dumbbell Overhead Tricep Extension",type:"weighted",equipment:"dumbbells",group:"push",storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Skullcrushers",type:"weighted",equipment:"dumbbells",group:"push",storagePath:"exercises/dumbbells/upper/skullcrushers.mp4"},{name:"Dumbbell Lateral Raise",type:"weighted",equipment:"dumbbells",group:"push",storagePath:"exercises/dumbbells/upper/dumbbell lateral raise.mp4"},{name:"Dumbbell Front Raise",type:"weighted",equipment:"dumbbells",group:"push",storagePath:"exercises/dumbbells/upper/dumbbell front raise.mp4"},{name:"Press Up",type:"reps",equipment:"bodyweight",group:"push",storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Tricep Dips",type:"reps",equipment:"bodyweight",group:"push",storagePath:"exercises/bodyweight/upper/tricep dips.mp4"},{name:"Pike Push Ups",type:"reps",equipment:"bodyweight",group:"push",storagePath:"exercises/bodyweight/upper/pike push ups.GIF"},{name:"Reverse Plank",type:"timed",equipment:"bodyweight",group:"push",storagePath:"exercises/bodyweight/upper/reverse plank.GIF"},{name:"Dumbbell Squeeze Press",type:"weighted",equipment:"dumbbells",group:"push",storagePath:null},{name:"Incline Dumbbell Press",type:"weighted",equipment:"dumbbells",group:"push",storagePath:null},{name:"Dumbbell Pullover",type:"weighted",equipment:"dumbbells",group:"push",storagePath:null},{name:"Dumbbell Fly",type:"weighted",equipment:"dumbbells",group:"push",storagePath:null},{name:"Tricep Kickback",type:"weighted",equipment:"dumbbells",group:"push",storagePath:null},{name:"Dumbbell Shrug",type:"weighted",equipment:"dumbbells",group:"push",storagePath:null},{name:"Dumbbell Y-Raise",type:"weighted",equipment:"dumbbells",group:"push",storagePath:null},{name:"Wide Press Up",type:"reps",equipment:"bodyweight",group:"push",storagePath:null},{name:"Diamond Press Up",type:"reps",equipment:"bodyweight",group:"push",storagePath:null},{name:"Decline Press Up",type:"reps",equipment:"bodyweight",group:"push",storagePath:null},{name:"Wall Walks",type:"reps",equipment:"bodyweight",group:"push",storagePath:null},{name:"Press Up Hold",type:"timed",equipment:"bodyweight",group:"push",storagePath:null},{name:"Shoulder Tap Hold",type:"timed",equipment:"bodyweight",group:"push",storagePath:null},{name:"Dumbbell Bent Over Row",type:"weighted",equipment:"dumbbells",group:"pull",pbKey:"seatedRow",storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Single Arm Bent Over Row",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Bicep Curl",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Hammer Curl",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:"exercises/dumbbells/upper/hammer curl.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Renegade Row",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:"exercises/dumbbells/upper/renegade row.mp4"},{name:"Wide Dumbbell Bent Over Row",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:null},{name:"Reverse Fly",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:null},{name:"Concentration Curl",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:null},{name:"Wide Grip Bicep Curl",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:null},{name:"Wrist Curl",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:null},{name:"Prone Y-T-W Raises",type:"reps",equipment:"bodyweight",group:"pull",storagePath:null},{name:"Reverse Snow Angel",type:"reps",equipment:"bodyweight",group:"pull",storagePath:null},{name:"Isometric Bicep Hold",type:"timed",equipment:"bodyweight",group:"pull",storagePath:null},{name:"Dumbbell Goblet Squats",type:"weighted",equipment:"dumbbells",group:"lower",pbKey:"squat",storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Romanian Deadlifts",type:"weighted",equipment:"dumbbells",group:"lower",pbKey:"deadlift",storagePath:"exercises/dumbbells/lower/romanian deadlifts.GIF"},{name:"Forward Dumbbell Lunges",type:"weighted",equipment:"dumbbells",group:"lower",storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.GIF"},{name:"Dumbbell Sumo Squats",type:"weighted",equipment:"dumbbells",group:"lower",storagePath:"exercises/dumbbells/lower/dumbbell sumo squats.GIF"},{name:"Weighted Calf Raises",type:"weighted",equipment:"dumbbells",group:"lower",storagePath:"exercises/dumbbells/lower/weighted calf raises.GIF"},{name:"1 Legged RDL",type:"weighted",equipment:"dumbbells",group:"lower",storagePath:"exercises/dumbbells/lower/1 legged rdl.GIF"},{name:"Dumbbell Box Step Ups",type:"weighted",equipment:"dumbbells",group:"lower",storagePath:"exercises/dumbbells/lower/dumbbell box step ups.mp4"},{name:"Dumbbell Squat Pulses",type:"weighted",equipment:"dumbbells",group:"lower",storagePath:"exercises/dumbbells/lower/dumbbell squat pulses.GIF"},{name:"Dumbbell Reverse Lunges",type:"weighted",equipment:"dumbbells",group:"lower",storagePath:"exercises/dumbbells/lower/dumbbell reverse lunges.GIF"},{name:"Kettlebell Romanian Deadlift",type:"weighted",equipment:"kettlebell",group:"lower",storagePath:"exercises/kettlebells/lower/kettlebell romanian deadlift.mp4"},{name:"Reverse Lunge",type:"reps",equipment:"bodyweight",group:"lower",storagePath:"exercises/bodyweight/lower/reverse lunge.GIF"},{name:"Box Step Ups",type:"reps",equipment:"bodyweight",group:"lower",storagePath:"exercises/bodyweight/lower/box step ups.GIF"},{name:"Bulgarian Split Squats",type:"reps",equipment:"bodyweight",group:"lower",storagePath:"exercises/bodyweight/lower/bulgarian split squats.GIF"},{name:"Jump Squats",type:"reps",equipment:"bodyweight",group:"lower",storagePath:"exercises/bodyweight/lower/jump squats.GIF"},{name:"Hip Thrusts",type:"reps",equipment:"bodyweight",group:"lower",storagePath:"exercises/bodyweight/lower/hip thrusts.GIF"},{name:"Donkey Kicks",type:"reps",equipment:"bodyweight",group:"lower",storagePath:"exercises/bodyweight/lower/donkey kicks.GIF"},{name:"Skater Jumps",type:"reps",equipment:"bodyweight",group:"lower",storagePath:"exercises/bodyweight/lower/skater jumps.GIF"},{name:"Squat And Hold",type:"timed",equipment:"bodyweight",group:"lower",storagePath:"exercises/bodyweight/lower/squat and hold.GIF"},{name:"Forearm Plank",type:"timed",equipment:"bodyweight",group:"core",pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"},{name:"Side Plank",type:"timed",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Side Plank.mp4"},{name:"Hollow Body Hold",type:"timed",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"},{name:"Superman Hold",type:"timed",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Superman Hold.mp4"},{name:"Mountain Climbers",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Mountain Climbers.mp4"},{name:"Fast Mountain Climbers",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Fast Mountain Climbers.mp4"},{name:"Cross Body Mountain Climbers",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Cross Body Mountain Climbers.mp4"},{name:"Russian Twist",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Russian Twist.mp4"},{name:"Crunch",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Crunch.mp4"},{name:"Bicycle Crunch",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Bicycle Crunch.mp4"},{name:"Leg Raises",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Leg Raises.mp4"},{name:"Dead Bug",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Dead Bug.mp4"},{name:"Dead Bug Single Leg Drop",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Dead Bug Single Leg Drop.mp4"},{name:"Bird Dog",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Bird Dog.mp4"},{name:"Flutter Kicks",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Flutter Kicks.mp4"},{name:"Hollow Hold Flutter Kicks",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Hollow Hold Flutter Kicks.mp4"},{name:"High Plank Shoulder Taps",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/High Plank Shoulder Taps.mp4"},{name:"Hip Dips Plank",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Hip Dips Plank.mp4"},{name:"Single Leg V-Up",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Single Leg V-Up.mp4"},{name:"Hollow Hold To V-Sit",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Hollow Hold To V-sit.mp4"},{name:"Toe Reaches",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/toe reaches.GIF"},{name:"Side Plank Rotation",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Side Plank Rotation.mp4"},{name:"Plank Walkout",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Plank Walkout.mp4"},{name:"Reverse Crunch To Leg Raise",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Reverse Crunch To Leg Raise.mp4"},{name:"Burpee",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Russian Twists Dumbbell",type:"weighted",equipment:"dumbbells",group:"core",storagePath:"exercises/dumbbells/core/russian twists dumbbell.GIF"},{name:"Kettlebell Russian Twist",type:"weighted",equipment:"kettlebell",group:"core",storagePath:"exercises/kettlebells/core/kettlebell russian twist.mp4"},{name:"Kettlebell Side Bends",type:"weighted",equipment:"kettlebell",group:"core",storagePath:"exercises/kettlebells/core/kettlebell side bends.mp4"},{name:"Kneeling Kettlebell Halo",type:"weighted",equipment:"kettlebell",group:"core",storagePath:"exercises/kettlebells/core/kneeling kettlebell halo.mp4"},{name:"Kettlebell Bird Dog Drag",type:"reps",equipment:"kettlebell",group:"core",storagePath:"exercises/kettlebells/core/kettlebell bird dog drag.mp4"},{name:"Back Extension Hold",type:"timed",equipment:"bodyweight",group:"core",storagePath:null},{name:"Dumbbell Plank Pull Through",type:"weighted",equipment:"dumbbells",group:"core",storagePath:null}];Qk.filter(n=>n.storagePath!==null);const K6=[{key:"push",label:"Push",subtitle:"Chest / Shoulders / Triceps",color:"#A12F3A",icon:"M4 10v4M8 7v10M8 12h8M16 7v10M20 10v4"},{key:"pull",label:"Pull",subtitle:"Back / Biceps",color:"#2196f3",icon:"M4 12h16M12 4v16M7 7l10 10M17 7L7 17"},{key:"lower",label:"Lower",subtitle:"Legs / Glutes",color:"#ff9800",icon:"M13 2L3 14h9l-1 8 10-12h-9l1-8z"},{key:"core",label:"Core",subtitle:"Abs / Stability",color:"#7c3aed",icon:"M12 22c5.52 0 10-4.48 10-10S17.52 2 12 2 2 6.48 2 12s4.48 10 10 10zM12 18c3.31 0 6-2.69 6-6s-2.69-6-6-6-6 2.69-6 6 2.69 6 6 6zM12 14a2 2 0 1 0 0-4 2 2 0 0 0 0 4z"}],Xk={};Qk.forEach(n=>{Xk[n.name]=n.group});function Y6(n){return Xk[n]||null}const Va=[{key:"chestPress",name:"Chest Press",category:"Upper Body - Push",unit:"weight"},{key:"shoulderPress",name:"Shoulder Press",category:"Upper Body - Push",unit:"weight"},{key:"seatedRow",name:"Seated Row",category:"Upper Body - Pull",unit:"weight"},{key:"latPulldown",name:"Lat Pulldown",category:"Upper Body - Pull",unit:"weight"},{key:"squat",name:"Squat",category:"Lower Body",unit:"weight"},{key:"deadlift",name:"Deadlift",category:"Lower Body",unit:"weight"},{key:"plank",name:"Plank",category:"Core",unit:"time"}],Wo=[{key:"weight",name:"Weight",suffix:"kg"},{key:"chest",name:"Chest",suffix:"cm"},{key:"waist",name:"Waist",suffix:"cm"},{key:"hips",name:"Hips",suffix:"cm"},{key:"leftArm",name:"Left Arm",suffix:"cm"},{key:"rightArm",name:"Right Arm",suffix:"cm"},{key:"leftThigh",name:"Left Thigh",suffix:"cm"},{key:"rightThigh",name:"Right Thigh",suffix:"cm"}];function Q6(){const n=new Date;return`${n.getFullYear()}-${String(n.getMonth()+1).padStart(2,"0")}`}function xa(n){const[e,t]=n.split("-");return new Date(parseInt(e),parseInt(t)-1).toLocaleDateString("en-GB",{month:"long",year:"numeric"})}function vh(n){if(!n&&n!==0)return"-";const e=Math.floor(n/60),t=(n%60).toFixed(2);return e>0?`${e}m ${parseFloat(t).toFixed(0)}s`:`${parseFloat(t).toFixed(2)}s`}function V2(n,e){return!n&&n!==0?"-":!e&&e!==0?`${n}kg`:`${n}kg x ${e}`}function Hl(n,e){return e?n.unit==="time"?e.time||0:(e.weight||0)*(e.reps||0):0}function ag(n,e){return!e||e===0?null:(n-e)/e*100}function X6({data:n,exerciseKey:e,unit:t}){if(!n||n.length<2)return r.jsx("div",{className:"pb-trend-empty",children:r.jsx("p",{children:"Not enough data for trend line yet"})});const i=n.map(B=>{const D=B.benchmarks?.[e];return D?t==="time"?D.time||0:(D.weight||0)*(D.reps||0):0}),l=Math.max(...i),u=Math.min(...i),d=l-u||1,p=300,g=100,y=20,x=p-y*2,_=g-y*2,j=i.map((B,D)=>{const te=y+D/(i.length-1)*x,Y=y+_-(B-u)/d*_;return{x:te,y:Y,value:B}}),O=j.map((B,D)=>`${D===0?"M":"L"} ${B.x} ${B.y}`).join(" "),K=O+` L ${j[j.length-1].x} ${y+_} L ${j[0].x} ${y+_} Z`;return r.jsxs("div",{className:"pb-trend-chart",children:[r.jsxs("svg",{viewBox:`0 0 ${p} ${g}`,preserveAspectRatio:"xMidYMid meet",children:[r.jsx("defs",{children:r.jsxs("linearGradient",{id:"trendGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[r.jsx("stop",{offset:"0%",stopColor:"var(--color-primary)",stopOpacity:"0.3"}),r.jsx("stop",{offset:"100%",stopColor:"var(--color-primary)",stopOpacity:"0.02"})]})}),r.jsx("path",{d:K,fill:"url(#trendGradient)"}),r.jsx("path",{d:O,fill:"none",stroke:"var(--color-primary)",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round"}),j.map((B,D)=>r.jsx("circle",{cx:B.x,cy:B.y,r:"4",fill:"var(--bg-card)",stroke:"var(--color-primary)",strokeWidth:"2"},D))]}),r.jsx("div",{className:"pb-trend-labels",children:n.map((B,D)=>r.jsxs("span",{className:"pb-trend-label",children:[B.month.split("-")[1],"/",B.month.split("-")[0].slice(2)]},D))})]})}function J6(){const[n,e]=b.useState("bests"),[t,i]=b.useState([]),[l,u]=b.useState(!0),[d,p]=b.useState(!1),[g,y]=b.useState(0),[x,_]=b.useState(!1),[j,O]=b.useState(!1),[K,B]=b.useState(!1),[D,te]=b.useState({}),[Y,Z]=b.useState({}),[ke,Re]=b.useState({}),[_e,C]=b.useState({}),[T,M]=b.useState({}),[V,I]=b.useState(!1),[L,A]=b.useState({}),[Le,ht]=b.useState([]),[$,pe]=b.useState(null),[Be,We]=b.useState(null),[J,P]=b.useState(!1),[re,Fe]=b.useState(""),[qe,Ve]=b.useState(""),[Me,mt]=b.useState({}),[wt,ot]=b.useState({}),[es,Ns]=b.useState(null),[Ft,Tt]=b.useState(null),[oe,Dt]=b.useState(""),[Nt,Kt]=b.useState({}),Et=b.useRef(null),Ct=b.useRef(0),lt=b.useRef(0),Ot=b.useRef("right"),Wt=b.useCallback(G=>{y(me=>{const ae=Math.max(0,Math.min(Va.length-1,G));return ae===me?me:(Ot.current=ae>me?"right":"left",ae)})},[]),{currentUser:ms,isClient:Gt,clientData:Pt,loading:us}=Ir(),{isDark:xs}=Ca(),is=tr(),[Qs]=mE(),Ms=Qs.get("mode")==="corebuddy",Fs=!Ms&&(!Pt?.clientType||Pt.clientType==="block"),os=b.useCallback((G,me="info")=>{We({message:G,type:me}),setTimeout(()=>We(null),4e3)},[]);b.useEffect(()=>{!us&&(!ms||!Gt)&&is("/")},[ms,Gt,us,is]),b.useEffect(()=>{Pt&&(Fs?ws():(async()=>{try{const[me,ae,xe]=await Promise.all([Is(Xe(ge,"coreBuddyPBs",Pt.id)),Is(Xe(ge,"coreBuddyTargets",Pt.id)),Is(Xe(ge,"coreBuddyAchievements",Pt.id))]);me.exists()&&mt(me.data().exercises||{}),ae.exists()&&ot(ae.data().targets||{}),xe.exists()&&Ns(xe.data())}catch(me){console.error("Error loading Core Buddy PBs:",me)}u(!1)})())},[Pt]);const ws=async()=>{try{const G=As(Ht(ge,"personalBests"),gs("clientId","==",Pt.id)),ae=(await Ts(G)).docs.map(ne=>({id:ne.id,...ne.data()}));ae.sort((ne,Ze)=>ne.month.localeCompare(Ze.month)),i(ae);const xe=As(Ht(ge,"personalBestTargets"),gs("clientId","==",Pt.id)),E=await Ts(xe);if(!E.empty){const ne=E.docs[0].data();Re(ne.targets||{}),C(ne.metricTargets||{}),M(ne.targets||{}),A(ne.metricTargets||{})}const z=As(Ht(ge,"achievements"),gs("clientId","==",Pt.id)),ie=await Ts(z);ie.empty||ht(ie.docs[0].data().badges||[])}catch(G){console.error("Error fetching personal bests:",G)}u(!1)},be=async()=>{if(!Ft||!oe||!Pt)return;const G=parseFloat(oe),me=Me[Ft];if(!me||G<=me.weight){os("Target must be higher than current PB","error");return}p(!0);try{const ae={...wt,[Ft]:{targetWeight:G,setAt:Mt.now(),currentPBWhenSet:me.weight}};await Ds(Xe(ge,"coreBuddyTargets",Pt.id),{clientId:Pt.id,targets:ae,updatedAt:Mt.now()}),ot(ae),Tt(null),Dt(""),os("Target set!","success")}catch(ae){console.error("Error saving target:",ae),os("Failed to save target","error")}p(!1)},Ie=G=>{if(!es?.badges)return!1;const me=wt[G];return me?es.badges.some(ae=>ae.type==="pb_target"&&ae.exercise===G&&ae.targetWeight===me.targetWeight):!1},De=G=>{const me=wt[G];if(!me)return null;const ae=Me[G];if(!ae)return 0;const xe=me.currentPBWhenSet||0,E=me.targetWeight,z=E-xe;return z<=0?ae.weight>=E?1:0:Math.max(0,Math.min((ae.weight-xe)/z,1))},rt=Q6(),Ke=t.find(G=>G.month===rt),at=t.filter(G=>G.month<rt),gt=at.length>0?at[at.length-1]:null;b.useEffect(()=>{Ke?(te(Ke.benchmarks||{}),Z(Ke.bodyMetrics||{})):(te({}),Z({}))},[Ke?.id]);const X=async(G,me)=>{const ae=[];if(G==="strength"?Va.forEach(xe=>{const E=ke[xe.key];if(!E)return;const z=me[xe.key];if(!z)return;let ie;if(E.targetType==="time"){if(!E.targetValue)return;const ne=E.startValue||0,Ze=z.time||0,nt=E.targetValue-ne;ie=nt===0?Ze>=E.targetValue?1:0:Math.max(0,(Ze-ne)/nt)}else{if(!E.targetWeight&&!E.targetReps)return;const ne=(E.startWeight||0)*(E.startReps||0),Ze=(E.targetWeight||0)*(E.targetReps||0),nt=(z.weight||0)*(z.reps||0),ct=Ze-ne;ie=ct===0?nt>=Ze?1:0:Math.max(0,(nt-ne)/ct)}if(ie>=1&&!(E.targetType==="time"?Le.some(Ze=>Ze.type==="strength"&&Ze.key===xe.key&&Ze.targetValue===E.targetValue):Le.some(Ze=>Ze.type==="strength"&&Ze.key===xe.key&&Ze.targetWeight===E.targetWeight&&Ze.targetReps===E.targetReps))){const Ze=E.targetType==="time"?`${xe.name} ${E.targetValue}s`:`${xe.name} ${E.targetWeight}kg  ${E.targetReps}`;ae.push({type:"strength",key:xe.key,...E.targetType==="time"?{targetType:"time",targetValue:E.targetValue}:{targetWeight:E.targetWeight,targetReps:E.targetReps},achievedMonth:rt,label:Ze})}}):Wo.forEach(xe=>{const E=_e[xe.key];if(!E||!E.targetValue)return;const z=me[xe.key];if(z==null)return;const ie=E.startValue||0,ne=E.targetValue,Ze=ne-ie;(Ze===0?z===ne?1:0:Math.max(0,(z-ie)/Ze))>=1&&(Le.some(Lt=>Lt.type==="metric"&&Lt.key===xe.key&&Lt.targetValue===ne)||ae.push({type:"metric",key:xe.key,targetValue:ne,achievedMonth:rt,label:`${xe.name} ${ne}${xe.suffix}`}))}),ae.length>0){const xe=[...Le,...ae];await Ds(Xe(ge,"achievements",Pt.id),{clientId:Pt.id,badges:xe,updatedAt:Mt.now()}),ht(xe),pe(ae),setTimeout(()=>pe(null),5e3)}},se=(G,me)=>{if(G==="strength"){const ae=ke[me];return ae?ae.targetType==="time"?Le.some(xe=>xe.type==="strength"&&xe.key===me&&xe.targetValue===ae.targetValue):!ae.targetWeight&&!ae.targetReps?!1:Le.some(xe=>xe.type==="strength"&&xe.key===me&&xe.targetWeight===ae.targetWeight&&xe.targetReps===ae.targetReps):!1}else{const ae=_e[me];return!ae||!ae.targetValue?!1:Le.some(xe=>xe.type==="metric"&&xe.key===me&&xe.targetValue===ae.targetValue)}},Qe=async()=>{p(!0);try{const G=`${Pt.id}_${rt}`,me=Ke||{};await Ds(Xe(ge,"personalBests",G),{clientId:Pt.id,month:rt,benchmarks:D,bodyMetrics:me.bodyMetrics||Y||{},createdAt:me.createdAt||Mt.now(),updatedAt:Mt.now()}),await X("strength",D),os("Benchmarks saved!","success"),_(!1),await ws()}catch(G){console.error("Error saving benchmarks:",G),os("Failed to save. Please try again.","error")}p(!1)},_t=async()=>{p(!0);try{const G=`${Pt.id}_${rt}`,me=Ke||{};await Ds(Xe(ge,"personalBests",G),{clientId:Pt.id,month:rt,benchmarks:me.benchmarks||D||{},bodyMetrics:Y,createdAt:me.createdAt||Mt.now(),updatedAt:Mt.now()}),await X("metric",Y),os("Body metrics saved!","success"),O(!1),await ws()}catch(G){console.error("Error saving metrics:",G),os("Failed to save. Please try again.","error")}p(!1)},et=(G,me,ae)=>{te(xe=>({...xe,[G]:{...xe[G],[me]:ae===""?"":parseFloat(ae)}}))},kt=(G,me)=>{Z(ae=>({...ae,[G]:me===""?"":parseFloat(me)}))},Q=(G,me,ae)=>{M(xe=>({...xe,[G]:{...xe[G],[me]:ae===""?"":parseFloat(ae)}}))},Ae=async()=>{p(!0);try{const G=`targets_${Pt.id}`,me=Ke?.benchmarks||{},ae={};Va.forEach(xe=>{const E=me[xe.key];xe.unit==="time"?T[xe.key]?.targetValue&&(ae[xe.key]={targetType:"time",targetValue:T[xe.key].targetValue,startValue:E?.time||0}):(T[xe.key]?.targetWeight||T[xe.key]?.targetReps)&&(ae[xe.key]={targetWeight:T[xe.key].targetWeight||0,targetReps:T[xe.key].targetReps||0,startWeight:E?.weight||0,startReps:E?.reps||0})}),await Ds(Xe(ge,"personalBestTargets",G),{clientId:Pt.id,targets:ae,metricTargets:_e,updatedAt:Mt.now()}),Re(ae),M(ae),os("Targets saved!","success"),B(!1)}catch(G){console.error("Error saving targets:",G),os("Failed to save targets.","error")}p(!1)},Je=(G,me)=>{A(ae=>({...ae,[G]:{...ae[G],targetValue:me===""?"":parseFloat(me)}}))},yt=async()=>{p(!0);try{const G=`targets_${Pt.id}`,me={};Wo.forEach(ae=>{if(L[ae.key]?.targetValue){const xe=Ke?.bodyMetrics?.[ae.key]||0;me[ae.key]={targetValue:L[ae.key].targetValue,startValue:xe}}}),await Ds(Xe(ge,"personalBestTargets",G),{clientId:Pt.id,targets:ke,metricTargets:me,updatedAt:Mt.now()}),C(me),A(me),os("Metric targets saved!","success"),I(!1)}catch(G){console.error("Error saving metric targets:",G),os("Failed to save targets.","error")}p(!1)},it=async()=>{if(window.confirm("Reset all goals? This will clear all strength and body metric targets. Your recorded benchmarks and measurements will NOT be affected.")){p(!0);try{const G=Xe(ge,"personalBestTargets",`targets_${Pt.id}`);await lr(G),Re({}),C({}),M({}),A({}),os("All goals have been reset","success")}catch(G){console.error("Error resetting targets:",G),os("Failed to reset goals","error")}p(!1)}},Jt=(G,me)=>{const ae=ke[G];if(!ae||!me)return null;if(ae.targetType==="time"){if(!ae.targetValue)return null;const ne=ae.startValue||0,Ze=ae.targetValue,nt=me.time||0,ct=Ze-ne;return ct<=0?nt>=Ze?1:0:Math.max(0,Math.min((nt-ne)/ct,1))}if(!ae.targetWeight&&!ae.targetReps)return null;const xe=(ae.startWeight||0)*(ae.startReps||0),E=(ae.targetWeight||0)*(ae.targetReps||0),z=(me.weight||0)*(me.reps||0),ie=E-xe;return ie<=0?z>=E?1:0:Math.max(0,Math.min((z-xe)/ie,1))},Yt=G=>{const me=_e[G];if(!me||!me.targetValue)return null;const ae=Ke?.bodyMetrics?.[G];if(ae==null)return null;const xe=me.startValue||0,E=me.targetValue,z=E-xe;return z===0?ae===E?1:0:Math.max(0,Math.min((ae-xe)/z,1))},F=G=>{Ct.current=G.touches[0].clientX,lt.current=0},ye=G=>{lt.current=G.touches[0].clientX-Ct.current},Ee=()=>{lt.current<-50?Wt(g+1):lt.current>50&&Wt(g-1),lt.current=0},Te=G=>{const me=Ke?.bodyMetrics?.[G],ae=gt?.bodyMetrics?.[G];return me==null||ae==null?null:parseFloat((me-ae).toFixed(2))},Se=t.find(G=>G.month===re),bt=t.find(G=>G.month===qe);if(us||l)return r.jsxs("div",{className:"pb-page",children:[r.jsx("header",{className:"client-header",children:r.jsx("div",{className:"header-content",children:r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})})}),r.jsxs("main",{className:"pb-main",children:[r.jsx("div",{className:"skeleton skeleton-title",style:{width:180,height:28,marginBottom:20}}),r.jsx("div",{className:"skeleton skeleton-card-large",style:{height:320,borderRadius:16}})]})]});if(!ms||!Gt||!Pt)return null;if(Fs&&Pt?.isJunior)return r.jsx(G6,{});const At=Va[g],ft=Ke?.benchmarks?.[At.key],zt=gt?.benchmarks?.[At.key],Bt=Hl(At,ft),Ps=Hl(At,zt),hn=ag(Bt,Ps),tn=Jt(At.key,ft),En=tn!==null,zs=tn!==null&&tn>=1,sn=En?Math.round(tn*60):Bt>0?15:0,hs=ke[At.key];return r.jsx(Sa,{children:r.jsxs("div",{className:"pb-page",children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>is(Ms?"/client/core-buddy":"/client"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})]})}),r.jsxs("main",{className:"pb-main page-transition-enter",children:[r.jsxs("div",{className:"pb-intro anim-fade-up",children:[r.jsx("h2",{children:"Personal Bests"}),r.jsx("p",{children:Fs?"Track your strength benchmarks and body measurements each month.":"Your all-time best lifts from programme workouts."})]}),!Fs&&r.jsxs("div",{className:"pb-cb-section anim-fade-up-d2",children:[Object.keys(Me).length===0?r.jsxs("div",{className:"pb-empty",children:[r.jsx("div",{className:"pb-cb-empty-icon",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M20.57 14.86L22 13.43 20.57 12 17 15.57 8.43 7 12 3.43 10.57 2 9.14 3.43 7.71 2 5.57 4.14 4.14 2.71 2.71 4.14l1.43 1.43L2 7.71l1.43 1.43L2 10.57 3.43 12 7 8.43 15.57 17 12 20.57 13.43 22l1.43-1.43L16.29 22l2.14-2.14 1.43 1.43 1.43-1.43-1.43-1.43L22 16.29z"})})}),r.jsx("h4",{children:"No personal bests yet"}),r.jsx("p",{children:"Complete weight-based workouts to start tracking your personal bests."})]}):r.jsx("div",{className:"pb-cb-grouped",children:(()=>{const G={},me=[];return Object.entries(Me).forEach(([ae,xe])=>{const E=Y6(ae);E?(G[E]||(G[E]=[]),G[E].push([ae,xe])):me.push([ae,xe])}),Object.values(G).forEach(ae=>ae.sort(([xe],[E])=>xe.localeCompare(E))),me.sort(([ae],[xe])=>ae.localeCompare(xe)),r.jsxs(r.Fragment,{children:[K6.map(ae=>{const xe=G[ae.key];if(!xe||xe.length===0)return null;const E=!!Nt[ae.key],z=xe.reduce((ie,[,ne])=>!ie||ne.weight>ie.weight?ne:ie,null);return r.jsxs("div",{className:`pb-cb-group ${E?"open":""}`,style:{"--group-color":ae.color},children:[r.jsxs("button",{className:"pb-cb-group-header",onClick:()=>Kt(ie=>({...ie,[ae.key]:!ie[ae.key]})),children:[r.jsx("div",{className:"pb-cb-group-accent"}),r.jsx("div",{className:"pb-cb-group-icon",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:r.jsx("path",{d:ae.icon})})}),r.jsxs("div",{className:"pb-cb-group-text",children:[r.jsx("h3",{className:"pb-cb-group-label",children:ae.label}),r.jsx("span",{className:"pb-cb-group-subtitle",children:ae.subtitle})]}),r.jsxs("div",{className:"pb-cb-group-meta",children:[r.jsxs("span",{className:"pb-cb-group-count",children:[xe.length," PB",xe.length!==1?"s":""]}),z&&r.jsxs("span",{className:"pb-cb-group-best",children:["Best: ",z.weight,"kg"]})]}),r.jsx("svg",{className:`pb-cb-group-chevron ${E?"open":""}`,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M6 9l6 6 6-6"})})]}),r.jsx("div",{className:"pb-cb-group-body",style:{display:E?"block":"none"},children:r.jsx("div",{className:"pb-cb-grid",children:xe.map(([ie,ne],Ze)=>{const nt=wt[ie],ct=De(ie),Lt=ct!==null&&ct>=1,xt=Ie(ie),fs=ct!==null?Math.round(ct*60):60;return r.jsxs("div",{className:"pb-cb-card",style:{"--group-color":ae.color,animationDelay:`${Ze*.05}s`},children:[r.jsxs("div",{className:"pb-cb-card-top",children:[r.jsxs("div",{className:"pb-cb-card-ring",children:[r.jsx("svg",{className:"pb-cb-ring-svg",viewBox:"0 0 80 80",children:S2.map((nn,Dr)=>{const ps=Dr<fs;return r.jsx("line",{x1:nn.x1,y1:nn.y1,x2:nn.x2,y2:nn.y2,className:`pb-ring-tick ${ps?Lt?"hit":"filled":"empty"}`,style:ps&&!Lt?{stroke:ae.color}:void 0,strokeWidth:nn.thick?"2":"1.5"},Dr)})}),r.jsx("div",{className:"pb-cb-ring-icon",style:{color:ae.color},children:xt?r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",className:"pb-cb-badge-earned",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}):r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:r.jsx("path",{d:ae.icon})})})]}),r.jsxs("div",{className:"pb-cb-card-info",children:[r.jsx("h4",{className:"pb-cb-card-name",children:ie}),r.jsxs("div",{className:"pb-cb-card-value",style:{color:ae.color},children:[ne.weight,"kg  ",ne.reps]}),ne.achievedAt&&r.jsx("div",{className:"pb-cb-card-date",children:(ne.achievedAt.toDate?ne.achievedAt.toDate():new Date(ne.achievedAt)).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"})}),nt&&Lt&&!xt&&r.jsx("div",{className:"pb-cb-target-info hit",children:"Target hit!"}),xt&&r.jsx("div",{className:"pb-cb-target-info earned",children:"Badge earned!"})]}),r.jsx("div",{className:"pb-cb-card-action",children:r.jsx("button",{className:"pb-cb-target-btn",style:{borderColor:ae.color,background:`color-mix(in srgb, ${ae.color} 10%, transparent)`,color:ae.color},onClick:()=>{Tt(ie),Dt("")},children:nt?Lt&&xt?r.jsx("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M12 5v14M5 12h14"})}):r.jsxs("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),r.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]}):r.jsxs("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("circle",{cx:"12",cy:"12",r:"6"}),r.jsx("circle",{cx:"12",cy:"12",r:"2"})]})})})]}),nt&&!Lt&&r.jsxs("div",{className:"pb-cb-card-progress",children:[r.jsxs("div",{className:"pb-cb-progress-labels",children:[r.jsxs("span",{className:"pb-cb-progress-current",children:[ne.weight,"kg"]}),r.jsxs("span",{className:"pb-cb-progress-target",style:{color:ae.color},children:["Target: ",nt.targetWeight,"kg"]})]}),r.jsx("div",{className:"pb-cb-progress-bar",children:r.jsx("div",{className:"pb-cb-progress-bar-fill",style:{width:`${Math.round((ct||0)*100)}%`,background:ae.color}})}),r.jsxs("div",{className:"pb-cb-progress-pct",style:{color:ae.color},children:[Math.round((ct||0)*100),"%"]})]}),nt&&Lt&&r.jsx("div",{className:"pb-cb-card-progress",children:r.jsx("div",{className:"pb-cb-progress-bar",children:r.jsx("div",{className:"pb-cb-progress-bar-fill hit",style:{width:"100%"}})})})]},ie)})})})]},ae.key)}),me.length>0&&(()=>{const ae=!!Nt.other;return r.jsxs("div",{className:`pb-cb-group ${ae?"open":""}`,style:{"--group-color":"var(--text-tertiary)"},children:[r.jsxs("button",{className:"pb-cb-group-header",onClick:()=>Kt(xe=>({...xe,other:!xe.other})),children:[r.jsx("div",{className:"pb-cb-group-accent"}),r.jsx("div",{className:"pb-cb-group-icon",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:r.jsx("path",{d:"M20.57 14.86L22 13.43 20.57 12 17 15.57 8.43 7 12 3.43 10.57 2 9.14 3.43 7.71 2 5.57 4.14 4.14 2.71 2.71 4.14l1.43 1.43L2 7.71l1.43 1.43L2 10.57 3.43 12 7 8.43 15.57 17 12 20.57 13.43 22l1.43-1.43L16.29 22l2.14-2.14 1.43 1.43 1.43-1.43-1.43-1.43L22 16.29z"})})}),r.jsx("div",{className:"pb-cb-group-text",children:r.jsx("h3",{className:"pb-cb-group-label",children:"Other"})}),r.jsx("div",{className:"pb-cb-group-meta",children:r.jsxs("span",{className:"pb-cb-group-count",children:[me.length," PB",me.length!==1?"s":""]})}),r.jsx("svg",{className:`pb-cb-group-chevron ${ae?"open":""}`,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M6 9l6 6 6-6"})})]}),r.jsx("div",{className:"pb-cb-group-body",style:{display:ae?"block":"none"},children:r.jsx("div",{className:"pb-cb-grid",children:me.map(([xe,E],z)=>{const ie=wt[xe],ne=De(xe),Ze=ne!==null&&ne>=1,nt=Ie(xe),ct=ne!==null?Math.round(ne*60):60;return r.jsxs("div",{className:"pb-cb-card",style:{animationDelay:`${z*.05}s`},children:[r.jsxs("div",{className:"pb-cb-card-top",children:[r.jsxs("div",{className:"pb-cb-card-ring",children:[r.jsx("svg",{className:"pb-cb-ring-svg",viewBox:"0 0 80 80",children:S2.map((Lt,xt)=>{const fs=xt<ct;return r.jsx("line",{x1:Lt.x1,y1:Lt.y1,x2:Lt.x2,y2:Lt.y2,className:`pb-ring-tick ${fs?Ze?"hit":"filled":"empty"}`,strokeWidth:Lt.thick?"2":"1.5"},xt)})}),r.jsx("div",{className:"pb-cb-ring-icon",children:nt?r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",className:"pb-cb-badge-earned",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}):r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M20.57 14.86L22 13.43 20.57 12 17 15.57 8.43 7 12 3.43 10.57 2 9.14 3.43 7.71 2 5.57 4.14 4.14 2.71 2.71 4.14l1.43 1.43L2 7.71l1.43 1.43L2 10.57 3.43 12 7 8.43 15.57 17 12 20.57 13.43 22l1.43-1.43L16.29 22l2.14-2.14 1.43 1.43 1.43-1.43-1.43-1.43L22 16.29z"})})})]}),r.jsxs("div",{className:"pb-cb-card-info",children:[r.jsx("h4",{className:"pb-cb-card-name",children:xe}),r.jsxs("div",{className:"pb-cb-card-value",children:[E.weight,"kg  ",E.reps]}),E.achievedAt&&r.jsx("div",{className:"pb-cb-card-date",children:(E.achievedAt.toDate?E.achievedAt.toDate():new Date(E.achievedAt)).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"})}),ie&&Ze&&!nt&&r.jsx("div",{className:"pb-cb-target-info hit",children:"Target hit!"}),nt&&r.jsx("div",{className:"pb-cb-target-info earned",children:"Badge earned!"})]}),r.jsx("div",{className:"pb-cb-card-action",children:r.jsx("button",{className:"pb-cb-target-btn",onClick:()=>{Tt(xe),Dt("")},children:ie?Ze&&nt?r.jsx("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M12 5v14M5 12h14"})}):r.jsxs("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),r.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]}):r.jsxs("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("circle",{cx:"12",cy:"12",r:"6"}),r.jsx("circle",{cx:"12",cy:"12",r:"2"})]})})})]}),ie&&!Ze&&r.jsxs("div",{className:"pb-cb-card-progress",children:[r.jsxs("div",{className:"pb-cb-progress-labels",children:[r.jsxs("span",{className:"pb-cb-progress-current",children:[E.weight,"kg"]}),r.jsxs("span",{className:"pb-cb-progress-target",children:["Target: ",ie.targetWeight,"kg"]})]}),r.jsx("div",{className:"pb-cb-progress-bar",children:r.jsx("div",{className:"pb-cb-progress-bar-fill",style:{width:`${Math.round((ne||0)*100)}%`}})}),r.jsxs("div",{className:"pb-cb-progress-pct",children:[Math.round((ne||0)*100),"%"]})]}),ie&&Ze&&r.jsx("div",{className:"pb-cb-card-progress",children:r.jsx("div",{className:"pb-cb-progress-bar",children:r.jsx("div",{className:"pb-cb-progress-bar-fill hit",style:{width:"100%"}})})})]},xe)})})})]})})()]})})()}),Object.keys(Me).length>0&&r.jsxs("button",{className:"pb-cb-achievements-link anim-fade-up-d4",onClick:()=>is("/client/core-buddy/achievements"),children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"18",height:"18",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),"View Achievements",r.jsx("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})]}),Ft&&r.jsx("div",{className:"pb-cb-target-modal-overlay",onClick:()=>Tt(null),children:r.jsxs("div",{className:"pb-cb-target-modal",onClick:G=>G.stopPropagation(),children:[r.jsx("h3",{children:"Set Target"}),r.jsx("p",{className:"pb-cb-target-exercise-name",children:Ft}),r.jsxs("div",{className:"pb-cb-target-current",children:["Current PB: ",r.jsxs("strong",{children:[Me[Ft]?.weight,"kg"]})]}),r.jsxs("div",{className:"pb-cb-target-input-wrap",children:[r.jsx("label",{children:"Your target (kg)"}),r.jsx("input",{type:"number",inputMode:"decimal",step:"0.5",value:oe,onChange:G=>Dt(G.target.value),placeholder:String((Me[Ft]?.weight||0)+5),className:"pb-cb-target-input",autoFocus:!0})]}),r.jsxs("div",{className:"pb-cb-target-actions",children:[r.jsx("button",{className:"pb-cancel-btn",onClick:()=>Tt(null),children:"Cancel"}),r.jsx("button",{className:"pb-save-btn",onClick:be,disabled:d,children:d?"Saving...":"Set Target"})]})]})})]}),Fs&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"pb-tabs",children:[r.jsx("button",{className:`pb-tab ${n==="bests"?"active":""}`,onClick:()=>e("bests"),children:"Strength"}),r.jsx("button",{className:`pb-tab ${n==="metrics"?"active":""}`,onClick:()=>e("metrics"),children:"Body Metrics"}),r.jsx("button",{className:`pb-tab ${n==="history"?"active":""}`,onClick:()=>e("history"),children:"History"})]}),n==="bests"&&r.jsxs("div",{className:"pb-strength-section",children:[!x&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"pb-carousel",ref:Et,onTouchStart:F,onTouchMove:ye,onTouchEnd:Ee,children:[r.jsx("div",{className:`pb-ring-container slide-from-${Ot.current}`,children:r.jsxs("div",{className:"pb-ring",children:[r.jsx("svg",{className:"pb-ring-svg",viewBox:"0 0 200 200",children:Em.map((G,me)=>{const ae=me<Math.round(sn);return r.jsx("line",{x1:G.x1,y1:G.y1,x2:G.x2,y2:G.y2,className:`pb-ring-tick ${ae?zs?"hit":"filled":"empty"}`,strokeWidth:G.thick?"3":"2"},me)})}),r.jsxs("div",{className:"pb-ring-center",children:[r.jsx("div",{className:"pb-ring-category",children:At.category}),r.jsxs("div",{className:"pb-ring-exercise",children:[At.name,se("strength",At.key)&&r.jsx("svg",{className:"pb-badge-icon",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})]}),r.jsx("div",{className:"pb-ring-value",children:ft?At.unit==="time"?vh(ft.time):V2(ft.weight,ft.reps):"-"}),hn!==null&&r.jsxs("div",{className:`pb-ring-change ${hn>=0?"positive":"negative"}`,children:[hn>=0?"+":"",hn.toFixed(1),"%"]}),hn===null&&ft&&r.jsx("div",{className:"pb-ring-change neutral",children:"New entry"}),hs&&r.jsx("div",{className:`pb-ring-target ${zs?"hit":""}`,children:zs?"Target hit!":hs.targetType==="time"?`${hs.startValue||0}s  ${hs.targetValue}s`:`${hs.startWeight||0}kg${hs.startReps||0}  ${hs.targetWeight}kg${hs.targetReps}`}),!hs&&r.jsx("div",{className:"pb-ring-target none",children:"No target set"})]})]})},g),r.jsx("div",{className:"pb-carousel-dots",children:Va.map((G,me)=>r.jsx("button",{className:`pb-dot ${me===g?"active":""}`,onClick:()=>Wt(me)},me))}),r.jsx("button",{className:"pb-carousel-arrow left",onClick:()=>Wt(g-1),disabled:g===0,children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"})})}),r.jsx("button",{className:"pb-carousel-arrow right",onClick:()=>Wt(g+1),disabled:g===Va.length-1,children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M8.59 16.59L10 18l6-6-6-6-1.41 1.41L13.17 12z"})})})]}),r.jsxs("div",{className:"pb-trend-section",children:[r.jsx("h4",{children:"Trend"}),r.jsx(X6,{data:t,exerciseKey:At.key,unit:At.unit})]})]}),!x&&!K&&r.jsxs("div",{className:"pb-action-buttons",children:[r.jsx("button",{className:"pb-edit-btn",onClick:()=>_(!0),children:Ke?.benchmarks?"Edit This Month's Benchmarks":"Add This Month's Benchmarks"}),r.jsx("button",{className:"pb-edit-btn pb-target-btn",onClick:()=>B(!0),children:Object.keys(ke).length>0?"Edit Targets":"Set Targets"}),(Object.keys(ke).length>0||Object.keys(_e).length>0)&&r.jsx("button",{className:"pb-edit-btn pb-reset-btn",onClick:it,disabled:d,children:"Reset All Goals"})]}),x&&r.jsxs("div",{className:"pb-edit-card",children:[r.jsxs("div",{className:"pb-edit-header",children:[r.jsxs("h3",{children:["Benchmarks - ",xa(rt)]}),r.jsx("button",{className:"pb-edit-close",onClick:()=>{_(!1),te(Ke?.benchmarks||{})},children:""})]}),r.jsx("div",{className:"pb-edit-body",children:Va.map(G=>r.jsxs("div",{className:"pb-edit-exercise",children:[r.jsx("div",{className:"pb-edit-exercise-name",children:G.name}),G.unit==="weight"?r.jsxs("div",{className:"pb-edit-row",children:[r.jsxs("div",{className:"pb-edit-field",children:[r.jsx("label",{children:"Weight (kg)"}),r.jsx("input",{type:"number",step:"0.5",value:D[G.key]?.weight??"",onChange:me=>et(G.key,"weight",me.target.value),placeholder:"0"})]}),r.jsxs("div",{className:"pb-edit-field",children:[r.jsx("label",{children:"Reps"}),r.jsx("input",{type:"number",value:D[G.key]?.reps??"",onChange:me=>et(G.key,"reps",me.target.value),placeholder:"0"})]})]}):r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsx("label",{children:"Time (seconds)"}),r.jsx("input",{type:"number",step:"0.01",value:D[G.key]?.time??"",onChange:me=>et(G.key,"time",me.target.value),placeholder:"0"})]})})]},G.key))}),r.jsxs("div",{className:"pb-edit-actions",children:[r.jsx("button",{className:"pb-cancel-btn",onClick:()=>{_(!1),te(Ke?.benchmarks||{})},children:"Cancel"}),r.jsx("button",{className:"pb-save-btn",onClick:Qe,disabled:d,children:d?"Saving...":"Save"})]})]}),K&&r.jsxs("div",{className:"pb-edit-card",children:[r.jsxs("div",{className:"pb-edit-header",children:[r.jsx("h3",{children:"Set Your Targets"}),r.jsx("button",{className:"pb-edit-close",onClick:()=>{B(!1),M(ke)},children:""})]}),r.jsxs("div",{className:"pb-edit-body",children:[r.jsx("p",{className:"pb-target-hint",children:"Set a target for each exercise. Your current best is captured automatically from your latest benchmarks."}),Va.map(G=>{const me=Ke?.benchmarks?.[G.key];let ae="-";return me&&(G.unit==="time"&&me.time?ae=`${me.time}s`:(me.weight||me.reps)&&(ae=`${me.weight||0}kg  ${me.reps||0}`)),r.jsxs("div",{className:"pb-edit-exercise",children:[r.jsxs("div",{className:"pb-edit-exercise-header",children:[r.jsx("div",{className:"pb-edit-exercise-name",children:G.name}),r.jsxs("div",{className:"pb-edit-current-best",children:["Current: ",ae]})]}),G.unit==="weight"?r.jsxs("div",{className:"pb-edit-row",children:[r.jsxs("div",{className:"pb-edit-field",children:[r.jsx("label",{children:"Target Weight (kg)"}),r.jsx("input",{type:"number",step:"0.5",value:T[G.key]?.targetWeight??"",onChange:xe=>Q(G.key,"targetWeight",xe.target.value),placeholder:"0"})]}),r.jsxs("div",{className:"pb-edit-field",children:[r.jsx("label",{children:"Target Reps"}),r.jsx("input",{type:"number",value:T[G.key]?.targetReps??"",onChange:xe=>Q(G.key,"targetReps",xe.target.value),placeholder:"0"})]})]}):r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsx("label",{children:"Target (seconds)"}),r.jsx("input",{type:"number",step:"1",value:T[G.key]?.targetValue??"",onChange:xe=>Q(G.key,"targetValue",xe.target.value),placeholder:"0"})]})})]},G.key)})]}),r.jsxs("div",{className:"pb-edit-actions",children:[r.jsx("button",{className:"pb-cancel-btn",onClick:()=>{B(!1),M(ke)},children:"Cancel"}),r.jsx("button",{className:"pb-save-btn",onClick:Ae,disabled:d,children:d?"Saving...":"Save Targets"})]})]})]}),n==="metrics"&&r.jsxs("div",{className:"pb-metrics-section",children:[!j&&!V&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"pb-metrics-card",children:[r.jsx("h3",{children:"Body Measurements"}),r.jsx("p",{className:"pb-metrics-month",children:xa(rt)}),r.jsx("div",{className:"pb-metrics-list",children:Wo.map(G=>{const me=Ke?.bodyMetrics?.[G.key],ae=Te(G.key),xe=_e[G.key],E=Yt(G.key),z=E!==null&&E>=1;return r.jsxs("div",{className:"pb-metric-row",children:[r.jsxs("div",{className:"pb-metric-top",children:[r.jsxs("div",{className:"pb-metric-left",children:[r.jsxs("span",{className:"pb-metric-name",children:[G.name,se("metric",G.key)&&r.jsx("svg",{className:"pb-badge-icon-sm",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})]}),xe&&r.jsxs("span",{className:"pb-metric-target-label",children:["Target: ",xe.targetValue," ",G.suffix]})]}),r.jsxs("div",{className:"pb-metric-values",children:[r.jsx("span",{className:"pb-metric-current",children:me!=null?`${me} ${G.suffix}`:"-"}),ae!==null&&r.jsxs("span",{className:`pb-metric-change ${ae>0?"up":ae<0?"down":"same"}`,children:[ae>0?"+":"",ae," ",G.suffix]})]})]}),E!==null&&r.jsxs("div",{className:"pb-metric-progress",children:[r.jsx("div",{className:"pb-metric-bar",children:r.jsx("div",{className:`pb-metric-bar-fill ${z?"hit":""}`,style:{width:`${Math.round(E*100)}%`}})}),r.jsx("span",{className:`pb-metric-percent ${z?"hit":""}`,children:z?"Hit!":`${Math.round(E*100)}%`})]})]},G.key)})})]}),r.jsxs("div",{className:"pb-action-buttons",children:[r.jsx("button",{className:"pb-edit-btn",onClick:()=>O(!0),children:Ke?.bodyMetrics?"Edit This Month's Measurements":"Add This Month's Measurements"}),r.jsx("button",{className:"pb-edit-btn pb-target-btn",onClick:()=>I(!0),children:Object.keys(_e).length>0?"Edit Targets":"Set Targets"}),(Object.keys(ke).length>0||Object.keys(_e).length>0)&&r.jsx("button",{className:"pb-edit-btn pb-reset-btn",onClick:it,disabled:d,children:"Reset All Goals"})]})]}),j&&r.jsxs("div",{className:"pb-edit-card",children:[r.jsxs("div",{className:"pb-edit-header",children:[r.jsxs("h3",{children:["Measurements - ",xa(rt)]}),r.jsx("button",{className:"pb-edit-close",onClick:()=>{O(!1),Z(Ke?.bodyMetrics||{})},children:""})]}),r.jsx("div",{className:"pb-edit-body",children:Wo.map(G=>r.jsx("div",{className:"pb-edit-metric",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsxs("label",{children:[G.name," (",G.suffix,")"]}),r.jsx("input",{type:"number",step:"0.1",value:Y[G.key]??"",onChange:me=>kt(G.key,me.target.value),placeholder:"0"})]})},G.key))}),r.jsxs("div",{className:"pb-edit-actions",children:[r.jsx("button",{className:"pb-cancel-btn",onClick:()=>{O(!1),Z(Ke?.bodyMetrics||{})},children:"Cancel"}),r.jsx("button",{className:"pb-save-btn",onClick:_t,disabled:d,children:d?"Saving...":"Save"})]})]}),V&&r.jsxs("div",{className:"pb-edit-card",children:[r.jsxs("div",{className:"pb-edit-header",children:[r.jsx("h3",{children:"Body Metric Targets"}),r.jsx("button",{className:"pb-edit-close",onClick:()=>{I(!1),A(_e)},children:""})]}),r.jsxs("div",{className:"pb-edit-body",children:[r.jsx("p",{className:"pb-target-hint",children:"Set targets for your body measurements. Your current measurement is captured automatically."}),Wo.map(G=>{const me=Ke?.bodyMetrics?.[G.key];return r.jsxs("div",{className:"pb-edit-exercise",children:[r.jsxs("div",{className:"pb-edit-exercise-header",children:[r.jsx("div",{className:"pb-edit-exercise-name",children:G.name}),r.jsxs("div",{className:"pb-edit-current-best",children:["Current: ",me!=null?`${me} ${G.suffix}`:"-"]})]}),r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsxs("label",{children:["Target (",G.suffix,")"]}),r.jsx("input",{type:"number",step:"0.1",value:L[G.key]?.targetValue??"",onChange:ae=>Je(G.key,ae.target.value),placeholder:"0"})]})})]},G.key)})]}),r.jsxs("div",{className:"pb-edit-actions",children:[r.jsx("button",{className:"pb-cancel-btn",onClick:()=>{I(!1),A(_e)},children:"Cancel"}),r.jsx("button",{className:"pb-save-btn",onClick:yt,disabled:d,children:d?"Saving...":"Save Targets"})]})]})]}),n==="history"&&r.jsx("div",{className:"pb-history-section",children:t.length===0?r.jsxs("div",{className:"pb-empty",children:[r.jsx("h4",{children:"No records yet"}),r.jsx("p",{children:"Start adding your monthly benchmarks and measurements to track your progress over time."})]}):r.jsxs(r.Fragment,{children:[Le.length>0&&r.jsxs("div",{className:"pb-achievements-wall",children:[r.jsxs("h4",{className:"pb-achievements-wall-title",children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"18",height:"18",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),"Targets Achieved"]}),r.jsx("div",{className:"pb-achievements-list",children:[...Le].reverse().map((G,me)=>r.jsxs("div",{className:"pb-achievement-item",style:{animationDelay:`${me*.05}s`},children:[r.jsx("div",{className:"pb-achievement-star",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),r.jsxs("div",{className:"pb-achievement-info",children:[r.jsx("span",{className:"pb-achievement-label",children:G.label}),r.jsx("span",{className:"pb-achievement-date",children:xa(G.achievedMonth)})]})]},me))})]}),r.jsx("div",{className:"pb-history-controls",children:r.jsx("button",{className:`pb-compare-toggle ${J?"active":""}`,onClick:()=>{P(!J),!J&&t.length>=2&&(Fe(t[0].month),Ve(t[t.length-1].month))},children:J?"Back to Timeline":"Compare Months"})}),J?r.jsxs("div",{className:"pb-compare",children:[r.jsxs("div",{className:"pb-compare-selectors",children:[r.jsxs("div",{className:"pb-compare-select",children:[r.jsx("label",{children:"From"}),r.jsx("select",{value:re,onChange:G=>Fe(G.target.value),children:t.map(G=>r.jsx("option",{value:G.month,children:xa(G.month)},G.month))})]}),r.jsx("div",{className:"pb-compare-vs",children:"vs"}),r.jsxs("div",{className:"pb-compare-select",children:[r.jsx("label",{children:"To"}),r.jsx("select",{value:qe,onChange:G=>Ve(G.target.value),children:t.map(G=>r.jsx("option",{value:G.month,children:xa(G.month)},G.month))})]})]}),Se&&bt&&r.jsxs("div",{className:"pb-compare-results",children:[r.jsxs("div",{className:"pb-compare-group",children:[r.jsx("h4",{children:"Strength Benchmarks"}),r.jsxs("div",{className:"pb-compare-table",children:[r.jsxs("div",{className:"pb-compare-header-row",children:[r.jsx("span",{children:"Exercise"}),r.jsx("span",{children:xa(re).split(" ")[0]}),r.jsx("span",{children:xa(qe).split(" ")[0]}),r.jsx("span",{children:"Change"})]}),Va.map(G=>{const me=Se.benchmarks?.[G.key],ae=bt.benchmarks?.[G.key],xe=Hl(G,me),E=Hl(G,ae),z=ag(E,xe);return r.jsxs("div",{className:"pb-compare-row",children:[r.jsx("span",{className:"pb-compare-name",children:G.name}),r.jsx("span",{className:"pb-compare-val",children:me?G.unit==="time"?vh(me.time):`${me.weight}x${me.reps}`:"-"}),r.jsx("span",{className:"pb-compare-val",children:ae?G.unit==="time"?vh(ae.time):`${ae.weight}x${ae.reps}`:"-"}),r.jsx("span",{className:`pb-compare-change ${z!==null?z>=0?"positive":"negative":""}`,children:z!==null?`${z>=0?"+":""}${z.toFixed(1)}%`:"-"})]},G.key)})]})]}),r.jsxs("div",{className:"pb-compare-group",children:[r.jsx("h4",{children:"Body Measurements"}),r.jsxs("div",{className:"pb-compare-table",children:[r.jsxs("div",{className:"pb-compare-header-row",children:[r.jsx("span",{children:"Measurement"}),r.jsx("span",{children:xa(re).split(" ")[0]}),r.jsx("span",{children:xa(qe).split(" ")[0]}),r.jsx("span",{children:"Change"})]}),Wo.map(G=>{const me=Se.bodyMetrics?.[G.key],ae=bt.bodyMetrics?.[G.key],xe=me!=null&&ae!=null?parseFloat((ae-me).toFixed(2)):null;return r.jsxs("div",{className:"pb-compare-row",children:[r.jsx("span",{className:"pb-compare-name",children:G.name}),r.jsx("span",{className:"pb-compare-val",children:me!=null?`${me}`:"-"}),r.jsx("span",{className:"pb-compare-val",children:ae!=null?`${ae}`:"-"}),r.jsx("span",{className:`pb-compare-change ${xe!==null?xe>0?"positive":xe<0?"negative":"neutral":""}`,children:xe!==null?`${xe>0?"+":""}${xe} ${G.suffix}`:"-"})]},G.key)})]})]})]})]}):r.jsx("div",{className:"pb-timeline",children:[...t].reverse().map((G,me)=>{const ae=t.find(xe=>xe.month<G.month&&t.indexOf(xe)===t.indexOf(G)-1)||t.filter(xe=>xe.month<G.month).pop();return r.jsxs("div",{className:"pb-timeline-item",style:{animationDelay:`${me*.05}s`},children:[r.jsx("div",{className:"pb-timeline-dot"}),r.jsxs("div",{className:"pb-timeline-card",children:[r.jsx("h4",{children:xa(G.month)}),G.benchmarks&&Object.keys(G.benchmarks).length>0&&r.jsxs("div",{className:"pb-timeline-group",children:[r.jsx("h5",{children:"Strength Benchmarks"}),Va.map(xe=>{const E=G.benchmarks[xe.key];if(!E)return null;const z=ae?.benchmarks?.[xe.key],ie=Hl(xe,E),ne=Hl(xe,z),Ze=ag(ie,ne);return r.jsxs("div",{className:"pb-timeline-row",children:[r.jsx("span",{className:"pb-timeline-label",children:xe.name}),r.jsxs("div",{className:"pb-timeline-values",children:[r.jsx("span",{className:"pb-timeline-value",children:xe.unit==="time"?vh(E.time):V2(E.weight,E.reps)}),Ze!==null&&r.jsxs("span",{className:`pb-timeline-change ${Ze>=0?"positive":"negative"}`,children:[Ze>=0?"+":"",Ze.toFixed(1),"%"]})]})]},xe.key)})]}),G.bodyMetrics&&Object.keys(G.bodyMetrics).length>0&&r.jsxs("div",{className:"pb-timeline-group",children:[r.jsx("h5",{children:"Body Measurements"}),Wo.map(xe=>{const E=G.bodyMetrics[xe.key];if(E==null)return null;const z=ae?.bodyMetrics?.[xe.key],ie=z!=null?parseFloat((E-z).toFixed(2)):null;return r.jsxs("div",{className:"pb-timeline-row",children:[r.jsx("span",{className:"pb-timeline-label",children:xe.name}),r.jsxs("div",{className:"pb-timeline-values",children:[r.jsxs("span",{className:"pb-timeline-value",children:[E," ",xe.suffix]}),ie!==null&&r.jsxs("span",{className:`pb-timeline-change ${ie>0?"positive":ie<0?"negative":"neutral"}`,children:[ie>0?"+":"",ie," ",xe.suffix]})]})]},xe.key)})]})]})]},G.id)})})]})})]})]}),$&&r.jsx("div",{className:"pb-celebration-overlay",onClick:()=>pe(null),children:r.jsxs("div",{className:"pb-celebration-card",children:[r.jsx("div",{className:"pb-celebration-icon",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),r.jsx("h3",{className:"pb-celebration-title",children:$.length===1?"Target Achieved!":`${$.length} Targets Achieved!`}),r.jsx("div",{className:"pb-celebration-badges",children:$.map((G,me)=>r.jsx("div",{className:"pb-celebration-badge",children:G.label},me))}),r.jsx("p",{className:"pb-celebration-sub",children:"Tap to dismiss"})]})}),Be&&r.jsxs("div",{className:`toast-notification ${Be.type}`,children:[r.jsx("span",{className:"toast-icon",children:Be.type==="success"?r.jsx("svg",{className:"success-check-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{className:"check-path",d:"M5 13 L9 17 L19 7"})}):r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})}),r.jsx("span",{className:"toast-message",children:Be.message}),r.jsx("button",{className:"toast-close",onClick:()=>We(null),children:""})]}),Fs&&r.jsxs("nav",{className:"block-bottom-nav",children:[r.jsxs("button",{className:"block-nav-tab",onClick:()=>is("/client"),children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}),r.jsx("polyline",{points:"9 22 9 12 15 12 15 22"})]}),r.jsx("span",{children:"Home"})]}),r.jsxs("button",{className:"block-nav-tab",onClick:()=>is("/client/forms"),children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),r.jsx("polyline",{points:"14 2 14 8 20 8"}),r.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),r.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"})]}),r.jsx("span",{children:"Forms"})]}),r.jsxs("button",{className:"block-nav-tab",onClick:()=>is("/client/tools"),children:[r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"})}),r.jsx("span",{children:"Tools"})]}),r.jsxs("button",{className:"block-nav-tab active",children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M12 20V10"}),r.jsx("path",{d:"M18 20V4"}),r.jsx("path",{d:"M6 20v-4"})]}),r.jsx("span",{children:"PBs"})]}),Pt?.circuitAccess&&r.jsxs("button",{className:"block-nav-tab",onClick:()=>is("/client/circuit"),children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("path",{d:"M12 6v6l4 2"})]}),r.jsx("span",{children:"Circuit"})]})]}),Ms&&r.jsx(Ta,{active:"progress"})]})})}const Z6=b.lazy(()=>wr(()=>import("./Dashboard-DV7WaCH9.js"),__vite__mapDeps([0,1,2]))),eP=b.lazy(()=>wr(()=>import("./AddClient-Dn9akOG3.js"),__vite__mapDeps([3,4]))),tP=b.lazy(()=>wr(()=>import("./ClientDashboard-BZvAmOBW.js"),__vite__mapDeps([5,1]))),sP=b.lazy(()=>wr(()=>import("./ClientForms-BGhY2hT7.js"),__vite__mapDeps([6,7]))),nP=b.lazy(()=>wr(()=>import("./ClientTools-B06CmPOm.js"),__vite__mapDeps([8,9]))),rP=b.lazy(()=>wr(()=>import("./MacroCalculator-oHTmOewN.js"),__vite__mapDeps([10,9]))),aP=b.lazy(()=>wr(()=>import("./ProteinSnacks-BPa9i5e6.js"),__vite__mapDeps([11,9]))),iP=b.lazy(()=>wr(()=>import("./DailyMotivation-BtHbUuF-.js"),__vite__mapDeps([12,9]))),oP=b.lazy(()=>wr(()=>import("./CircuitDashboard-BNWSUDbt.js"),__vite__mapDeps([13,14]))),lP=b.lazy(()=>wr(()=>import("./CircuitBooking-BVfx0-yR.js"),__vite__mapDeps([15,16,14]))),cP=b.lazy(()=>wr(()=>import("./Leaderboard-djfeKhWK.js"),__vite__mapDeps([17,18]))),uP=b.lazy(()=>wr(()=>import("./UpgradePage-CUv4l0q5.js"),__vite__mapDeps([19,20]))),dP=b.lazy(()=>wr(()=>import("./SignUp-CmJIffOL.js"),[])),hP=b.lazy(()=>wr(()=>import("./Onboarding-CqL0Yw5I.js"),__vite__mapDeps([21,22])));function mP({children:n}){const{pathname:e}=Na();return b.useEffect(()=>{"scrollRestoration"in window.history&&(window.history.scrollRestoration="manual")},[]),b.useEffect(()=>{window.scrollTo({top:0,left:0,behavior:"instant"})},[e]),n}function fP(){const n=tr();return b.useEffect(()=>{const e=sessionStorage.getItem("redirect");if(e){sessionStorage.removeItem("redirect");const t=e.replace("/login","")||"/";n(t,{replace:!0})}},[n]),null}function pP(){return r.jsx(eD,{children:r.jsx(ZI,{children:r.jsx(aD,{children:r.jsxs(lE,{basename:"/login",children:[r.jsx(fP,{}),r.jsx(mP,{children:r.jsx(b.Suspense,{fallback:r.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",minHeight:"60vh"},children:r.jsx("div",{style:{width:36,height:36,border:"3px solid var(--color-primary-light)",borderTopColor:"var(--color-primary)",borderRadius:"50%",animation:"app-spin .7s linear infinite"}})}),children:r.jsxs(OS,{children:[r.jsx(Js,{path:"/",element:r.jsx(lD,{})}),r.jsx(Js,{path:"/dashboard",element:r.jsx(Z6,{})}),r.jsx(Js,{path:"/add-client",element:r.jsx(eP,{})}),r.jsx(Js,{path:"/client",element:r.jsx(tP,{})}),r.jsx(Js,{path:"/client/forms",element:r.jsx(sP,{})}),r.jsx(Js,{path:"/client/tools",element:r.jsx(nP,{})}),r.jsx(Js,{path:"/client/tools/macros",element:r.jsx(rP,{})}),r.jsx(Js,{path:"/client/tools/snacks",element:r.jsx(aP,{})}),r.jsx(Js,{path:"/client/tools/motivation",element:r.jsx(iP,{})}),r.jsx(Js,{path:"/client/personal-bests",element:r.jsx(J6,{})}),r.jsx(Js,{path:"/client/circuit",element:r.jsx(oP,{})}),r.jsx(Js,{path:"/client/circuit/booking",element:r.jsx(lP,{})}),r.jsx(Js,{path:"/client/core-buddy",element:r.jsx(RD,{})}),r.jsx(Js,{path:"/client/core-buddy/nutrition",element:r.jsx(Ul,{feature:"nutrition",children:r.jsx(ID,{})})}),r.jsx(Js,{path:"/client/core-buddy/workouts",element:r.jsx(g6,{})}),r.jsx(Js,{path:"/client/core-buddy/programmes",element:r.jsx(Ul,{feature:"programmes",children:r.jsx(w6,{})})}),r.jsx(Js,{path:"/client/core-buddy/achievements",element:r.jsx(Ul,{feature:"achievements",children:r.jsx(E6,{})})}),r.jsx(Js,{path:"/client/core-buddy/consistency",element:r.jsx(Ul,{feature:"consistency",children:r.jsx(P6,{})})}),r.jsx(Js,{path:"/client/core-buddy/buddies",element:r.jsx(Ul,{feature:"buddies",children:r.jsx(L6,{})})}),r.jsx(Js,{path:"/client/core-buddy/builder",element:r.jsx(z6,{})}),r.jsx(Js,{path:"/client/core-buddy/profile/:userId",element:r.jsx(U6,{})}),r.jsx(Js,{path:"/client/leaderboard",element:r.jsx(Ul,{feature:"leaderboard",children:r.jsx(cP,{})})}),r.jsx(Js,{path:"/signup",element:r.jsx(dP,{})}),r.jsx(Js,{path:"/onboarding",element:r.jsx(hP,{})}),r.jsx(Js,{path:"/upgrade",element:r.jsx(uP,{})}),r.jsx(Js,{path:"*",element:r.jsx(Z2,{to:"/",replace:!0})})]})})})]})})})})}OT.createRoot(document.getElementById("root")).render(r.jsx(b.StrictMode,{children:r.jsx(pP,{})}));"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/login/sw.js").then(n=>{setInterval(()=>n.update(),3600*1e3)}).catch(n=>console.warn("SW registration failed:",n))});export{yr as A,Ta as C,Sa as P,Mt as T,Gr as a,lr as b,Ht as c,ge as d,Xe as e,e4 as f,Ts as g,a4 as h,Ds as i,r as j,Is as k,Ir as l,Ca as m,tr as n,oc as o,Em as p,As as q,b as r,bP as s,yc as t,oa as u,oD as v,gs as w,iD as x,gP as y,mE as z};
