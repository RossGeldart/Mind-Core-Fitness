import{r as p,l as qs,m as Ws,n as Ds,q as Ye,c as Ke,d as W,w as Xe,g as Je,j as e,p as As,i as pe,e as K,T as O,b as Es,t as Os,P as zs,v as Rs,C as Us,k as Vs}from"./index-DDRMcrxS.js";/* empty css                        */const oe=[{key:"pressUps",name:"Press-Ups",category:"Upper Body",unit:"reps"},{key:"squats",name:"Squats",category:"Lower Body",unit:"reps"},{key:"longJump",name:"Standing Long Jump",category:"Power",unit:"distance"},{key:"deadHang",name:"Dead Hang",category:"Upper Body",unit:"time"},{key:"plank",name:"Plank",category:"Core",unit:"time"},{key:"wallSit",name:"Wall Sit",category:"Lower Body",unit:"time"},{key:"chestPress",name:"Chest Press",category:"Upper Body",unit:"weight"}],Ie=[{key:"weight",name:"Weight",suffix:"kg"},{key:"chest",name:"Chest",suffix:"cm"},{key:"waist",name:"Waist",suffix:"cm"},{key:"hips",name:"Hips",suffix:"cm"},{key:"leftArm",name:"Left Arm",suffix:"cm"},{key:"rightArm",name:"Right Arm",suffix:"cm"},{key:"leftThigh",name:"Left Thigh",suffix:"cm"},{key:"rightThigh",name:"Right Thigh",suffix:"cm"}];function _s(){const h=new Date;return`${h.getFullYear()}-${String(h.getMonth()+1).padStart(2,"0")}`}function de(h){const[u,m]=h.split("-");return new Date(parseInt(u),parseInt(m)-1).toLocaleDateString("en-GB",{month:"long",year:"numeric"})}function Ys(h){if(!h&&h!==0)return"-";const u=Math.floor(h/60),m=(h%60).toFixed(2);return u>0?`${u}m ${parseFloat(m).toFixed(0)}s`:`${parseFloat(m).toFixed(2)}s`}function Ks(h,u){return!h&&h!==0?"-":!u&&u!==0?`${h}kg`:`${h}kg x ${u}`}function ys(h,u){if(!u)return"-";switch(h.unit){case"weight":return Ks(u.weight,u.reps);case"time":return Ys(u.time);case"reps":return u.reps?`${u.reps} reps`:"-";case"distance":return u.distance?`${u.distance} cm`:"-";default:return"-"}}function Ue(h,u){if(!u)return 0;switch(h.unit){case"weight":return(u.weight||0)*(u.reps||0);case"time":return u.time||0;case"reps":return u.reps||0;case"distance":return u.distance||0;default:return 0}}function Bs(h,u){return!u||u===0?null:(h-u)/u*100}function Xs({data:h,exerciseKey:u,unit:m}){if(!h||h.length<2)return e.jsx("div",{className:"pb-trend-empty",children:e.jsx("p",{children:"Not enough data for trend line yet"})});const z=h.map(f=>{const x=f.benchmarks?.[u];if(!x)return 0;switch(m){case"weight":return(x.weight||0)*(x.reps||0);case"time":return x.time||0;case"reps":return x.reps||0;case"distance":return x.distance||0;default:return 0}}),Be=Math.max(...z),ue=Math.min(...z),M=Be-ue||1,C=300,P=100,E=20,ie=C-E*2,D=P-E*2,I=z.map((f,x)=>{const _=E+x/(z.length-1)*ie,Q=E+D-(f-ue)/M*D;return{x:_,y:Q,value:f}}),U=I.map((f,x)=>`${x===0?"M":"L"} ${f.x} ${f.y}`).join(" "),be=U+` L ${I[I.length-1].x} ${E+D} L ${I[0].x} ${E+D} Z`;return e.jsxs("div",{className:"pb-trend-chart",children:[e.jsxs("svg",{viewBox:`0 0 ${C} ${P}`,preserveAspectRatio:"xMidYMid meet",children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"trendGradientJr",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"0%",stopColor:"var(--color-primary)",stopOpacity:"0.3"}),e.jsx("stop",{offset:"100%",stopColor:"var(--color-primary)",stopOpacity:"0.02"})]})}),e.jsx("path",{d:be,fill:"url(#trendGradientJr)"}),e.jsx("path",{d:U,fill:"none",stroke:"var(--color-primary)",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round"}),I.map((f,x)=>e.jsx("circle",{cx:f.x,cy:f.y,r:"4",fill:"var(--bg-card)",stroke:"var(--color-primary)",strokeWidth:"2"},x))]}),e.jsx("div",{className:"pb-trend-labels",children:h.map((f,x)=>e.jsxs("span",{className:"pb-trend-label",children:[f.month.split("-")[1],"/",f.month.split("-")[0].slice(2)]},x))})]})}function Js(){const[h,u]=p.useState("bests"),[m,z]=p.useState([]),[Be,ue]=p.useState(!0),[M,C]=p.useState(!1),[P,E]=p.useState(0),[ie,D]=p.useState(!1),[I,U]=p.useState(!1),[be,f]=p.useState(!1),[x,_]=p.useState({}),[Q,le]=p.useState({}),[F,Pe]=p.useState({}),[q,Se]=p.useState({}),[S,Z]=p.useState({}),[Qe,xe]=p.useState(!1),[$e,ee]=p.useState({}),[L,Ze]=p.useState([]),[ye,Le]=p.useState(null),[je,Re]=p.useState(null),[ce,vs]=p.useState(!1),[ve,es]=p.useState(""),[ke,ss]=p.useState(""),Me=p.useRef(null),us=p.useRef(0),me=p.useRef(0),ts=p.useRef("right"),se=p.useCallback(s=>{E(i=>{const c=Math.max(0,Math.min(oe.length-1,s));return c===i?i:(ts.current=c>i?"right":"left",c)})},[]),{currentUser:fe,isClient:Ve,clientData:R,loading:Ge}=qs(),{isDark:ks}=Ws(),Ne=Ds(),te=p.useCallback((s,i="info")=>{Re({message:s,type:i}),setTimeout(()=>Re(null),4e3)},[]);p.useEffect(()=>{!Ge&&(!fe||!Ve)&&Ne("/")},[fe,Ve,Ge,Ne]),p.useEffect(()=>{R&&we()},[R]);const we=async()=>{try{const s=Ye(Ke(W,"juniorPBs"),Xe("clientId","==",R.id)),c=(await Je(s)).docs.map(g=>({id:g.id,...g.data()}));c.sort((g,j)=>g.month.localeCompare(j.month)),z(c);const l=Ye(Ke(W,"juniorPBTargets"),Xe("clientId","==",R.id)),o=await Je(l);if(!o.empty){const g=o.docs[0].data();Pe(g.targets||{}),Se(g.metricTargets||{}),Z(g.targets||{}),ee(g.metricTargets||{})}const w=Ye(Ke(W,"juniorAchievements"),Xe("clientId","==",R.id)),$=await Je(w);$.empty||Ze($.docs[0].data().badges||[])}catch(s){console.error("Error fetching junior personal bests:",s)}ue(!1)},X=_s(),B=m.find(s=>s.month===X),Fe=m.filter(s=>s.month<X),Oe=Fe.length>0?Fe[Fe.length-1]:null;p.useEffect(()=>{B?(_(B.benchmarks||{}),le(B.bodyMetrics||{})):(_({}),le({}))},[B?.id]);const T=async(s,i)=>{const c=[];if(s==="strength"?oe.forEach(l=>{const o=F[l.key];if(!o)return;const w=i[l.key];if(!w)return;let $;if(o.targetType==="time"){if(!o.targetValue)return;const g=o.startValue||0,j=w.time||0,y=o.targetValue-g;$=y===0?j>=o.targetValue?1:0:Math.max(0,(j-g)/y)}else if(o.targetType==="reps"){if(!o.targetReps)return;const g=o.startReps||0,j=w.reps||0,y=o.targetReps-g;$=y===0?j>=o.targetReps?1:0:Math.max(0,(j-g)/y)}else if(o.targetType==="distance"){if(!o.targetDistance)return;const g=o.startDistance||0,j=w.distance||0,y=o.targetDistance-g;$=y===0?j>=o.targetDistance?1:0:Math.max(0,(j-g)/y)}else{if(!o.targetWeight&&!o.targetReps)return;const g=(o.startWeight||0)*(o.startReps||0),j=(o.targetWeight||0)*(o.targetReps||0),y=(w.weight||0)*(w.reps||0),J=j-g;$=J===0?y>=j?1:0:Math.max(0,(y-g)/J)}if($>=1){let g,j;o.targetType==="time"?(g=L.some(y=>y.type==="strength"&&y.key===l.key&&y.targetValue===o.targetValue),j=`${l.name} ${o.targetValue}s`):o.targetType==="reps"?(g=L.some(y=>y.type==="strength"&&y.key===l.key&&y.targetReps===o.targetReps),j=`${l.name} ${o.targetReps} reps`):o.targetType==="distance"?(g=L.some(y=>y.type==="strength"&&y.key===l.key&&y.targetDistance===o.targetDistance),j=`${l.name} ${o.targetDistance}cm`):(g=L.some(y=>y.type==="strength"&&y.key===l.key&&y.targetWeight===o.targetWeight&&y.targetReps===o.targetReps),j=`${l.name} ${o.targetWeight}kg × ${o.targetReps}`),g||c.push({type:"strength",key:l.key,...o.targetType==="time"?{targetType:"time",targetValue:o.targetValue}:o.targetType==="reps"?{targetType:"reps",targetReps:o.targetReps}:o.targetType==="distance"?{targetType:"distance",targetDistance:o.targetDistance}:{targetWeight:o.targetWeight,targetReps:o.targetReps},achievedMonth:X,label:j})}}):Ie.forEach(l=>{const o=q[l.key];if(!o||!o.targetValue)return;const w=i[l.key];if(w==null)return;const $=o.startValue||0,g=o.targetValue,j=g-$;(j===0?w===g?1:0:Math.max(0,(w-$)/j))>=1&&(L.some(Ee=>Ee.type==="metric"&&Ee.key===l.key&&Ee.targetValue===g)||c.push({type:"metric",key:l.key,targetValue:g,achievedMonth:X,label:`${l.name} ${g}${l.suffix}`}))}),c.length>0){const l=[...L,...c];await pe(K(W,"juniorAchievements",R.id),{clientId:R.id,badges:l,updatedAt:O.now()}),Ze(l),Le(c),setTimeout(()=>Le(null),5e3)}},ze=(s,i)=>{if(s==="strength"){const c=F[i];if(!c)return!1;switch(oe.find(o=>o.key===i)?.unit){case"time":return L.some(o=>o.type==="strength"&&o.key===i&&o.targetValue===c.targetValue);case"reps":return L.some(o=>o.type==="strength"&&o.key===i&&o.targetReps===c.targetReps);case"distance":return L.some(o=>o.type==="strength"&&o.key===i&&o.targetDistance===c.targetDistance);default:return!c.targetWeight&&!c.targetReps?!1:L.some(o=>o.type==="strength"&&o.key===i&&o.targetWeight===c.targetWeight&&o.targetReps===c.targetReps)}}else{const c=q[i];return!c||!c.targetValue?!1:L.some(l=>l.type==="metric"&&l.key===i&&l.targetValue===c.targetValue)}},Ss=async()=>{C(!0);try{const s=`${R.id}_${X}`,i=B||{};await pe(K(W,"juniorPBs",s),{clientId:R.id,month:X,benchmarks:x,bodyMetrics:i.bodyMetrics||Q||{},createdAt:i.createdAt||O.now(),updatedAt:O.now()}),await T("strength",x),te("Benchmarks saved!","success"),D(!1),await we()}catch(s){console.error("Error saving benchmarks:",s),te("Failed to save. Please try again.","error")}C(!1)},Ce=async()=>{C(!0);try{const s=`${R.id}_${X}`,i=B||{};await pe(K(W,"juniorPBs",s),{clientId:R.id,month:X,benchmarks:i.benchmarks||x||{},bodyMetrics:Q,createdAt:i.createdAt||O.now(),updatedAt:O.now()}),await T("metric",Q),te("Body metrics saved!","success"),U(!1),await we()}catch(s){console.error("Error saving metrics:",s),te("Failed to save. Please try again.","error")}C(!1)},qe=(s,i,c)=>{_(l=>({...l,[s]:{...l[s],[i]:c===""?"":parseFloat(c)}}))},rs=(s,i)=>{le(c=>({...c,[s]:i===""?"":parseFloat(i)}))},ne=(s,i,c)=>{Z(l=>({...l,[s]:{...l[s],[i]:c===""?"":parseFloat(c)}}))},Y=async()=>{C(!0);try{const s=`targets_${R.id}`,i=B?.benchmarks||{},c={};oe.forEach(l=>{const o=i[l.key];switch(l.unit){case"time":S[l.key]?.targetValue&&(c[l.key]={targetType:"time",targetValue:S[l.key].targetValue,startValue:o?.time||0});break;case"reps":S[l.key]?.targetReps&&(c[l.key]={targetType:"reps",targetReps:S[l.key].targetReps,startReps:o?.reps||0});break;case"distance":S[l.key]?.targetDistance&&(c[l.key]={targetType:"distance",targetDistance:S[l.key].targetDistance,startDistance:o?.distance||0});break;default:(S[l.key]?.targetWeight||S[l.key]?.targetReps)&&(c[l.key]={targetWeight:S[l.key].targetWeight||0,targetReps:S[l.key].targetReps||0,startWeight:o?.weight||0,startReps:o?.reps||0})}}),await pe(K(W,"juniorPBTargets",s),{clientId:R.id,targets:c,metricTargets:q,updatedAt:O.now()}),Pe(c),Z(c),te("Targets saved!","success"),f(!1)}catch(s){console.error("Error saving targets:",s),te("Failed to save targets.","error")}C(!1)},as=(s,i)=>{ee(c=>({...c,[s]:{...c[s],targetValue:i===""?"":parseFloat(i)}}))},fs=async()=>{C(!0);try{const s=`targets_${R.id}`,i={};Ie.forEach(c=>{if($e[c.key]?.targetValue){const l=B?.bodyMetrics?.[c.key]||0;i[c.key]={targetValue:$e[c.key].targetValue,startValue:l}}}),await pe(K(W,"juniorPBTargets",s),{clientId:R.id,targets:F,metricTargets:i,updatedAt:O.now()}),Se(i),ee(i),te("Metric targets saved!","success"),xe(!1)}catch(s){console.error("Error saving metric targets:",s),te("Failed to save targets.","error")}C(!1)},ns=async()=>{if(window.confirm("Reset all goals? This will clear all strength and body metric targets. Your recorded benchmarks and measurements will NOT be affected.")){C(!0);try{const s=K(W,"juniorPBTargets",`targets_${R.id}`);await Es(s),Pe({}),Se({}),Z({}),ee({}),te("All goals have been reset","success")}catch(s){console.error("Error resetting targets:",s),te("Failed to reset goals","error")}C(!1)}},re=(s,i)=>{const c=F[s];if(!c||!i)return null;if(c.targetType==="time"){if(!c.targetValue)return null;const g=c.startValue||0,j=c.targetValue,y=i.time||0,J=j-g;return J<=0?y>=j?1:0:Math.max(0,Math.min((y-g)/J,1))}if(c.targetType==="reps"){if(!c.targetReps)return null;const g=c.startReps||0,j=c.targetReps,y=i.reps||0,J=j-g;return J<=0?y>=j?1:0:Math.max(0,Math.min((y-g)/J,1))}if(c.targetType==="distance"){if(!c.targetDistance)return null;const g=c.startDistance||0,j=c.targetDistance,y=i.distance||0,J=j-g;return J<=0?y>=j?1:0:Math.max(0,Math.min((y-g)/J,1))}if(!c.targetWeight&&!c.targetReps)return null;const l=(c.startWeight||0)*(c.startReps||0),o=(c.targetWeight||0)*(c.targetReps||0),w=(i.weight||0)*(i.reps||0),$=o-l;return $<=0?w>=o?1:0:Math.max(0,Math.min((w-l)/$,1))},V=s=>{const i=q[s];if(!i||!i.targetValue)return null;const c=B?.bodyMetrics?.[s];if(c==null)return null;const l=i.startValue||0,o=i.targetValue,w=o-l;return w===0?c===o?1:0:Math.max(0,Math.min((c-l)/w,1))},is=s=>{us.current=s.touches[0].clientX,me.current=0},ms=s=>{me.current=s.touches[0].clientX-us.current},gs=()=>{me.current<-50?se(P+1):me.current>50&&se(P-1),me.current=0},bs=s=>{const i=B?.bodyMetrics?.[s],c=Oe?.bodyMetrics?.[s];return i==null||c==null?null:parseFloat((i-c).toFixed(2))},ls=m.find(s=>s.month===ve),cs=m.find(s=>s.month===ke);if(Ge||Be)return e.jsxs("div",{className:"pb-page",children:[e.jsx("header",{className:"client-header",children:e.jsx("div",{className:"header-content",children:e.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})})}),e.jsxs("main",{className:"pb-main",children:[e.jsx("div",{className:"skeleton skeleton-title",style:{width:180,height:28,marginBottom:20}}),e.jsx("div",{className:"skeleton skeleton-card-large",style:{height:320,borderRadius:16}})]})]});if(!fe||!Ve||!R)return null;const G=oe[P],We=B?.benchmarks?.[G.key],os=Oe?.benchmarks?.[G.key],xs=Ue(G,We),Ns=Ue(G,os),De=Bs(xs,Ns),Ae=re(G.key,We),ws=Ae!==null,ds=Ae!==null&&Ae>=1,Cs=ws?Math.round(Ae*60):xs>0?15:0,hs=F[G.key],Ts=s=>s?s.targetType==="time"?`${s.startValue||0}s → ${s.targetValue}s`:s.targetType==="reps"?`${s.startReps||0} → ${s.targetReps} reps`:s.targetType==="distance"?`${s.startDistance||0} → ${s.targetDistance}cm`:`${s.startWeight||0}kg×${s.startReps||0} → ${s.targetWeight}kg×${s.targetReps}`:null;return e.jsxs("div",{className:"pb-page",children:[e.jsx("header",{className:"client-header",children:e.jsxs("div",{className:"header-content",children:[e.jsx("button",{className:"header-back-btn",onClick:()=>Ne("/client"),"aria-label":"Go back",children:e.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("path",{d:"M15 18l-6-6 6-6"})})}),e.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})]})}),e.jsxs("main",{className:"pb-main page-transition-enter",children:[e.jsxs("div",{className:"pb-intro",children:[e.jsx("h2",{children:"Junior Strength Tests"}),e.jsx("p",{children:"Track your strength test results and body measurements each month."})]}),e.jsxs("div",{className:"pb-tabs",children:[e.jsx("button",{className:`pb-tab ${h==="bests"?"active":""}`,onClick:()=>u("bests"),children:"Strength"}),e.jsx("button",{className:`pb-tab ${h==="metrics"?"active":""}`,onClick:()=>u("metrics"),children:"Body Metrics"}),e.jsx("button",{className:`pb-tab ${h==="history"?"active":""}`,onClick:()=>u("history"),children:"History"})]}),h==="bests"&&e.jsxs("div",{className:"pb-strength-section",children:[!ie&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"pb-carousel",ref:Me,onTouchStart:is,onTouchMove:ms,onTouchEnd:gs,children:[e.jsx("div",{className:`pb-ring-container slide-from-${ts.current}`,children:e.jsxs("div",{className:"pb-ring",children:[e.jsx("svg",{className:"pb-ring-svg",viewBox:"0 0 200 200",children:As.map((s,i)=>{const c=i<Math.round(Cs);return e.jsx("line",{x1:s.x1,y1:s.y1,x2:s.x2,y2:s.y2,className:`pb-ring-tick ${c?ds?"hit":"filled":"empty"}`,strokeWidth:s.thick?"3":"2"},i)})}),e.jsxs("div",{className:"pb-ring-center",children:[e.jsx("div",{className:"pb-ring-category",children:G.category}),e.jsxs("div",{className:"pb-ring-exercise",children:[G.name,ze("strength",G.key)&&e.jsx("svg",{className:"pb-badge-icon",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})]}),e.jsx("div",{className:"pb-ring-value",children:We?ys(G,We):"-"}),De!==null&&e.jsxs("div",{className:`pb-ring-change ${De>=0?"positive":"negative"}`,children:[De>=0?"+":"",De.toFixed(1),"%"]}),De===null&&We&&e.jsx("div",{className:"pb-ring-change neutral",children:"New entry"}),hs&&e.jsx("div",{className:`pb-ring-target ${ds?"hit":""}`,children:ds?"Target hit!":Ts(hs)}),!hs&&e.jsx("div",{className:"pb-ring-target none",children:"No target set"})]})]})},P),e.jsx("div",{className:"pb-carousel-dots",children:oe.map((s,i)=>e.jsx("button",{className:`pb-dot ${i===P?"active":""}`,onClick:()=>se(i)},i))}),e.jsx("button",{className:"pb-carousel-arrow left",onClick:()=>se(P-1),disabled:P===0,children:e.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"})})}),e.jsx("button",{className:"pb-carousel-arrow right",onClick:()=>se(P+1),disabled:P===oe.length-1,children:e.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M8.59 16.59L10 18l6-6-6-6-1.41 1.41L13.17 12z"})})})]}),e.jsxs("div",{className:"pb-trend-section",children:[e.jsx("h4",{children:"Trend"}),e.jsx(Xs,{data:m,exerciseKey:G.key,unit:G.unit})]})]}),!ie&&!be&&e.jsxs("div",{className:"pb-action-buttons",children:[e.jsx("button",{className:"pb-edit-btn",onClick:()=>D(!0),children:B?.benchmarks?"Edit This Month's Benchmarks":"Add This Month's Benchmarks"}),e.jsx("button",{className:"pb-edit-btn pb-target-btn",onClick:()=>f(!0),children:Object.keys(F).length>0?"Edit Targets":"Set Targets"}),(Object.keys(F).length>0||Object.keys(q).length>0)&&e.jsx("button",{className:"pb-edit-btn pb-reset-btn",onClick:ns,disabled:M,children:"Reset All Goals"})]}),ie&&e.jsxs("div",{className:"pb-edit-card",children:[e.jsxs("div",{className:"pb-edit-header",children:[e.jsxs("h3",{children:["Benchmarks - ",de(X)]}),e.jsx("button",{className:"pb-edit-close",onClick:()=>{D(!1),_(B?.benchmarks||{})},children:"×"})]}),e.jsx("div",{className:"pb-edit-body",children:oe.map(s=>e.jsxs("div",{className:"pb-edit-exercise",children:[e.jsx("div",{className:"pb-edit-exercise-name",children:s.name}),s.unit==="weight"?e.jsxs("div",{className:"pb-edit-row",children:[e.jsxs("div",{className:"pb-edit-field",children:[e.jsx("label",{children:"Weight (kg)"}),e.jsx("input",{type:"number",step:"0.5",value:x[s.key]?.weight??"",onChange:i=>qe(s.key,"weight",i.target.value),placeholder:"0"})]}),e.jsxs("div",{className:"pb-edit-field",children:[e.jsx("label",{children:"Reps"}),e.jsx("input",{type:"number",value:x[s.key]?.reps??"",onChange:i=>qe(s.key,"reps",i.target.value),placeholder:"0"})]})]}):s.unit==="reps"?e.jsx("div",{className:"pb-edit-row",children:e.jsxs("div",{className:"pb-edit-field full",children:[e.jsx("label",{children:"Reps (max in 1 min)"}),e.jsx("input",{type:"number",value:x[s.key]?.reps??"",onChange:i=>qe(s.key,"reps",i.target.value),placeholder:"0"})]})}):s.unit==="distance"?e.jsx("div",{className:"pb-edit-row",children:e.jsxs("div",{className:"pb-edit-field full",children:[e.jsx("label",{children:"Distance (cm)"}),e.jsx("input",{type:"number",step:"0.5",value:x[s.key]?.distance??"",onChange:i=>qe(s.key,"distance",i.target.value),placeholder:"0"})]})}):e.jsx("div",{className:"pb-edit-row",children:e.jsxs("div",{className:"pb-edit-field full",children:[e.jsx("label",{children:"Time (seconds)"}),e.jsx("input",{type:"number",step:"0.01",value:x[s.key]?.time??"",onChange:i=>qe(s.key,"time",i.target.value),placeholder:"0"})]})})]},s.key))}),e.jsxs("div",{className:"pb-edit-actions",children:[e.jsx("button",{className:"pb-cancel-btn",onClick:()=>{D(!1),_(B?.benchmarks||{})},children:"Cancel"}),e.jsx("button",{className:"pb-save-btn",onClick:Ss,disabled:M,children:M?"Saving...":"Save"})]})]}),be&&e.jsxs("div",{className:"pb-edit-card",children:[e.jsxs("div",{className:"pb-edit-header",children:[e.jsx("h3",{children:"Set Your Targets"}),e.jsx("button",{className:"pb-edit-close",onClick:()=>{f(!1),Z(F)},children:"×"})]}),e.jsxs("div",{className:"pb-edit-body",children:[e.jsx("p",{className:"pb-target-hint",children:"Set a target for each exercise. Your current best is captured automatically from your latest benchmarks."}),oe.map(s=>{const i=B?.benchmarks?.[s.key];let c="-";if(i)switch(s.unit){case"weight":(i.weight||i.reps)&&(c=`${i.weight||0}kg × ${i.reps||0}`);break;case"time":i.time&&(c=`${i.time}s`);break;case"reps":i.reps&&(c=`${i.reps} reps`);break;case"distance":i.distance&&(c=`${i.distance} cm`);break}return e.jsxs("div",{className:"pb-edit-exercise",children:[e.jsxs("div",{className:"pb-edit-exercise-header",children:[e.jsx("div",{className:"pb-edit-exercise-name",children:s.name}),e.jsxs("div",{className:"pb-edit-current-best",children:["Current: ",c]})]}),s.unit==="weight"?e.jsxs("div",{className:"pb-edit-row",children:[e.jsxs("div",{className:"pb-edit-field",children:[e.jsx("label",{children:"Target Weight (kg)"}),e.jsx("input",{type:"number",step:"0.5",value:S[s.key]?.targetWeight??"",onChange:l=>ne(s.key,"targetWeight",l.target.value),placeholder:"0"})]}),e.jsxs("div",{className:"pb-edit-field",children:[e.jsx("label",{children:"Target Reps"}),e.jsx("input",{type:"number",value:S[s.key]?.targetReps??"",onChange:l=>ne(s.key,"targetReps",l.target.value),placeholder:"0"})]})]}):s.unit==="reps"?e.jsx("div",{className:"pb-edit-row",children:e.jsxs("div",{className:"pb-edit-field full",children:[e.jsx("label",{children:"Target Reps (in 1 min)"}),e.jsx("input",{type:"number",value:S[s.key]?.targetReps??"",onChange:l=>ne(s.key,"targetReps",l.target.value),placeholder:"0"})]})}):s.unit==="distance"?e.jsx("div",{className:"pb-edit-row",children:e.jsxs("div",{className:"pb-edit-field full",children:[e.jsx("label",{children:"Target Distance (cm)"}),e.jsx("input",{type:"number",step:"0.5",value:S[s.key]?.targetDistance??"",onChange:l=>ne(s.key,"targetDistance",l.target.value),placeholder:"0"})]})}):e.jsx("div",{className:"pb-edit-row",children:e.jsxs("div",{className:"pb-edit-field full",children:[e.jsx("label",{children:"Target (seconds)"}),e.jsx("input",{type:"number",step:"1",value:S[s.key]?.targetValue??"",onChange:l=>ne(s.key,"targetValue",l.target.value),placeholder:"0"})]})})]},s.key)})]}),e.jsxs("div",{className:"pb-edit-actions",children:[e.jsx("button",{className:"pb-cancel-btn",onClick:()=>{f(!1),Z(F)},children:"Cancel"}),e.jsx("button",{className:"pb-save-btn",onClick:Y,disabled:M,children:M?"Saving...":"Save Targets"})]})]})]}),h==="metrics"&&e.jsxs("div",{className:"pb-metrics-section",children:[!I&&!Qe&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"pb-metrics-card",children:[e.jsx("h3",{children:"Body Measurements"}),e.jsx("p",{className:"pb-metrics-month",children:de(X)}),e.jsx("div",{className:"pb-metrics-list",children:Ie.map(s=>{const i=B?.bodyMetrics?.[s.key],c=bs(s.key),l=q[s.key],o=V(s.key),w=o!==null&&o>=1;return e.jsxs("div",{className:"pb-metric-row",children:[e.jsxs("div",{className:"pb-metric-top",children:[e.jsxs("div",{className:"pb-metric-left",children:[e.jsxs("span",{className:"pb-metric-name",children:[s.name,ze("metric",s.key)&&e.jsx("svg",{className:"pb-badge-icon-sm",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})]}),l&&e.jsxs("span",{className:"pb-metric-target-label",children:["Target: ",l.targetValue," ",s.suffix]})]}),e.jsxs("div",{className:"pb-metric-values",children:[e.jsx("span",{className:"pb-metric-current",children:i!=null?`${i} ${s.suffix}`:"-"}),c!==null&&e.jsxs("span",{className:`pb-metric-change ${c>0?"up":c<0?"down":"same"}`,children:[c>0?"+":"",c," ",s.suffix]})]})]}),o!==null&&e.jsxs("div",{className:"pb-metric-progress",children:[e.jsx("div",{className:"pb-metric-bar",children:e.jsx("div",{className:`pb-metric-bar-fill ${w?"hit":""}`,style:{width:`${Math.round(o*100)}%`}})}),e.jsx("span",{className:`pb-metric-percent ${w?"hit":""}`,children:w?"Hit!":`${Math.round(o*100)}%`})]})]},s.key)})})]}),e.jsxs("div",{className:"pb-action-buttons",children:[e.jsx("button",{className:"pb-edit-btn",onClick:()=>U(!0),children:B?.bodyMetrics?"Edit This Month's Measurements":"Add This Month's Measurements"}),e.jsx("button",{className:"pb-edit-btn pb-target-btn",onClick:()=>xe(!0),children:Object.keys(q).length>0?"Edit Targets":"Set Targets"}),(Object.keys(F).length>0||Object.keys(q).length>0)&&e.jsx("button",{className:"pb-edit-btn pb-reset-btn",onClick:ns,disabled:M,children:"Reset All Goals"})]})]}),I&&e.jsxs("div",{className:"pb-edit-card",children:[e.jsxs("div",{className:"pb-edit-header",children:[e.jsxs("h3",{children:["Measurements - ",de(X)]}),e.jsx("button",{className:"pb-edit-close",onClick:()=>{U(!1),le(B?.bodyMetrics||{})},children:"×"})]}),e.jsx("div",{className:"pb-edit-body",children:Ie.map(s=>e.jsx("div",{className:"pb-edit-metric",children:e.jsxs("div",{className:"pb-edit-field full",children:[e.jsxs("label",{children:[s.name," (",s.suffix,")"]}),e.jsx("input",{type:"number",step:"0.1",value:Q[s.key]??"",onChange:i=>rs(s.key,i.target.value),placeholder:"0"})]})},s.key))}),e.jsxs("div",{className:"pb-edit-actions",children:[e.jsx("button",{className:"pb-cancel-btn",onClick:()=>{U(!1),le(B?.bodyMetrics||{})},children:"Cancel"}),e.jsx("button",{className:"pb-save-btn",onClick:Ce,disabled:M,children:M?"Saving...":"Save"})]})]}),Qe&&e.jsxs("div",{className:"pb-edit-card",children:[e.jsxs("div",{className:"pb-edit-header",children:[e.jsx("h3",{children:"Body Metric Targets"}),e.jsx("button",{className:"pb-edit-close",onClick:()=>{xe(!1),ee(q)},children:"×"})]}),e.jsxs("div",{className:"pb-edit-body",children:[e.jsx("p",{className:"pb-target-hint",children:"Set targets for your body measurements. Your current measurement is captured automatically."}),Ie.map(s=>{const i=B?.bodyMetrics?.[s.key];return e.jsxs("div",{className:"pb-edit-exercise",children:[e.jsxs("div",{className:"pb-edit-exercise-header",children:[e.jsx("div",{className:"pb-edit-exercise-name",children:s.name}),e.jsxs("div",{className:"pb-edit-current-best",children:["Current: ",i!=null?`${i} ${s.suffix}`:"-"]})]}),e.jsx("div",{className:"pb-edit-row",children:e.jsxs("div",{className:"pb-edit-field full",children:[e.jsxs("label",{children:["Target (",s.suffix,")"]}),e.jsx("input",{type:"number",step:"0.1",value:$e[s.key]?.targetValue??"",onChange:c=>as(s.key,c.target.value),placeholder:"0"})]})})]},s.key)})]}),e.jsxs("div",{className:"pb-edit-actions",children:[e.jsx("button",{className:"pb-cancel-btn",onClick:()=>{xe(!1),ee(q)},children:"Cancel"}),e.jsx("button",{className:"pb-save-btn",onClick:fs,disabled:M,children:M?"Saving...":"Save Targets"})]})]})]}),h==="history"&&e.jsx("div",{className:"pb-history-section",children:m.length===0?e.jsxs("div",{className:"pb-empty",children:[e.jsx("h4",{children:"No records yet"}),e.jsx("p",{children:"Start adding your monthly benchmarks and measurements to track your progress over time."})]}):e.jsxs(e.Fragment,{children:[L.length>0&&e.jsxs("div",{className:"pb-achievements-wall",children:[e.jsxs("h4",{className:"pb-achievements-wall-title",children:[e.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"18",height:"18",children:e.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),"Targets Achieved"]}),e.jsx("div",{className:"pb-achievements-list",children:[...L].reverse().map((s,i)=>e.jsxs("div",{className:"pb-achievement-item",style:{animationDelay:`${i*.05}s`},children:[e.jsx("div",{className:"pb-achievement-star",children:e.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),e.jsxs("div",{className:"pb-achievement-info",children:[e.jsx("span",{className:"pb-achievement-label",children:s.label}),e.jsx("span",{className:"pb-achievement-date",children:de(s.achievedMonth)})]})]},i))})]}),e.jsx("div",{className:"pb-history-controls",children:e.jsx("button",{className:`pb-compare-toggle ${ce?"active":""}`,onClick:()=>{vs(!ce),!ce&&m.length>=2&&(es(m[0].month),ss(m[m.length-1].month))},children:ce?"Back to Timeline":"Compare Months"})}),ce?e.jsxs("div",{className:"pb-compare",children:[e.jsxs("div",{className:"pb-compare-selectors",children:[e.jsxs("div",{className:"pb-compare-select",children:[e.jsx("label",{children:"From"}),e.jsx("select",{value:ve,onChange:s=>es(s.target.value),children:m.map(s=>e.jsx("option",{value:s.month,children:de(s.month)},s.month))})]}),e.jsx("div",{className:"pb-compare-vs",children:"vs"}),e.jsxs("div",{className:"pb-compare-select",children:[e.jsx("label",{children:"To"}),e.jsx("select",{value:ke,onChange:s=>ss(s.target.value),children:m.map(s=>e.jsx("option",{value:s.month,children:de(s.month)},s.month))})]})]}),ls&&cs&&e.jsxs("div",{className:"pb-compare-results",children:[e.jsxs("div",{className:"pb-compare-group",children:[e.jsx("h4",{children:"Strength Tests"}),e.jsxs("div",{className:"pb-compare-table",children:[e.jsxs("div",{className:"pb-compare-header-row",children:[e.jsx("span",{children:"Exercise"}),e.jsx("span",{children:de(ve).split(" ")[0]}),e.jsx("span",{children:de(ke).split(" ")[0]}),e.jsx("span",{children:"Change"})]}),oe.map(s=>{const i=ls.benchmarks?.[s.key],c=cs.benchmarks?.[s.key],l=Ue(s,i),o=Ue(s,c),w=Bs(o,l);return e.jsxs("div",{className:"pb-compare-row",children:[e.jsx("span",{className:"pb-compare-name",children:s.name}),e.jsx("span",{className:"pb-compare-val",children:i?ys(s,i):"-"}),e.jsx("span",{className:"pb-compare-val",children:c?ys(s,c):"-"}),e.jsx("span",{className:`pb-compare-change ${w!==null?w>=0?"positive":"negative":""}`,children:w!==null?`${w>=0?"+":""}${w.toFixed(1)}%`:"-"})]},s.key)})]})]}),e.jsxs("div",{className:"pb-compare-group",children:[e.jsx("h4",{children:"Body Measurements"}),e.jsxs("div",{className:"pb-compare-table",children:[e.jsxs("div",{className:"pb-compare-header-row",children:[e.jsx("span",{children:"Measurement"}),e.jsx("span",{children:de(ve).split(" ")[0]}),e.jsx("span",{children:de(ke).split(" ")[0]}),e.jsx("span",{children:"Change"})]}),Ie.map(s=>{const i=ls.bodyMetrics?.[s.key],c=cs.bodyMetrics?.[s.key],l=i!=null&&c!=null?parseFloat((c-i).toFixed(2)):null;return e.jsxs("div",{className:"pb-compare-row",children:[e.jsx("span",{className:"pb-compare-name",children:s.name}),e.jsx("span",{className:"pb-compare-val",children:i!=null?`${i}`:"-"}),e.jsx("span",{className:"pb-compare-val",children:c!=null?`${c}`:"-"}),e.jsx("span",{className:`pb-compare-change ${l!==null?l>0?"positive":l<0?"negative":"neutral":""}`,children:l!==null?`${l>0?"+":""}${l} ${s.suffix}`:"-"})]},s.key)})]})]})]})]}):e.jsx("div",{className:"pb-timeline",children:[...m].reverse().map((s,i)=>{const c=m.filter(l=>l.month<s.month).pop();return e.jsxs("div",{className:"pb-timeline-item",style:{animationDelay:`${i*.05}s`},children:[e.jsx("div",{className:"pb-timeline-dot"}),e.jsxs("div",{className:"pb-timeline-card",children:[e.jsx("h4",{children:de(s.month)}),s.benchmarks&&Object.keys(s.benchmarks).length>0&&e.jsxs("div",{className:"pb-timeline-group",children:[e.jsx("h5",{children:"Strength Tests"}),oe.map(l=>{const o=s.benchmarks[l.key];if(!o)return null;const w=c?.benchmarks?.[l.key],$=Ue(l,o),g=Ue(l,w),j=Bs($,g);return e.jsxs("div",{className:"pb-timeline-row",children:[e.jsx("span",{className:"pb-timeline-label",children:l.name}),e.jsxs("div",{className:"pb-timeline-values",children:[e.jsx("span",{className:"pb-timeline-value",children:ys(l,o)}),j!==null&&e.jsxs("span",{className:`pb-timeline-change ${j>=0?"positive":"negative"}`,children:[j>=0?"+":"",j.toFixed(1),"%"]})]})]},l.key)})]}),s.bodyMetrics&&Object.keys(s.bodyMetrics).length>0&&e.jsxs("div",{className:"pb-timeline-group",children:[e.jsx("h5",{children:"Body Measurements"}),Ie.map(l=>{const o=s.bodyMetrics[l.key];if(o==null)return null;const w=c?.bodyMetrics?.[l.key],$=w!=null?parseFloat((o-w).toFixed(2)):null;return e.jsxs("div",{className:"pb-timeline-row",children:[e.jsx("span",{className:"pb-timeline-label",children:l.name}),e.jsxs("div",{className:"pb-timeline-values",children:[e.jsxs("span",{className:"pb-timeline-value",children:[o," ",l.suffix]}),$!==null&&e.jsxs("span",{className:`pb-timeline-change ${$>0?"positive":$<0?"negative":"neutral"}`,children:[$>0?"+":"",$," ",l.suffix]})]})]},l.key)})]})]})]},s.id)})})]})})]}),ye&&e.jsx("div",{className:"pb-celebration-overlay",onClick:()=>Le(null),children:e.jsxs("div",{className:"pb-celebration-card",children:[e.jsx("div",{className:"pb-celebration-icon",children:e.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),e.jsx("h3",{className:"pb-celebration-title",children:ye.length===1?"Target Achieved!":`${ye.length} Targets Achieved!`}),e.jsx("div",{className:"pb-celebration-badges",children:ye.map((s,i)=>e.jsx("div",{className:"pb-celebration-badge",children:s.label},i))}),e.jsx("p",{className:"pb-celebration-sub",children:"Tap to dismiss"})]})}),je&&e.jsxs("div",{className:`toast-notification ${je.type}`,children:[e.jsx("span",{className:"toast-icon",children:je.type==="success"?e.jsx("svg",{className:"success-check-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("path",{className:"check-path",d:"M5 13 L9 17 L19 7"})}):e.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[e.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),e.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})}),e.jsx("span",{className:"toast-message",children:je.message}),e.jsx("button",{className:"toast-close",onClick:()=>Re(null),children:"×"})]}),e.jsxs("nav",{className:"block-bottom-nav",children:[e.jsxs("button",{className:"block-nav-tab",onClick:()=>Ne("/client"),children:[e.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}),e.jsx("polyline",{points:"9 22 9 12 15 12 15 22"})]}),e.jsx("span",{children:"Home"})]}),e.jsxs("button",{className:"block-nav-tab",onClick:()=>Ne("/client/forms"),children:[e.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),e.jsx("polyline",{points:"14 2 14 8 20 8"}),e.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),e.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"})]}),e.jsx("span",{children:"Forms"})]}),e.jsxs("button",{className:"block-nav-tab",onClick:()=>Ne("/client/tools"),children:[e.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"})}),e.jsx("span",{children:"Tools"})]}),e.jsxs("button",{className:"block-nav-tab active",children:[e.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M12 20V10"}),e.jsx("path",{d:"M18 20V4"}),e.jsx("path",{d:"M6 20v-4"})]}),e.jsx("span",{children:"PBs"})]}),R?.circuitAccess&&e.jsxs("button",{className:"block-nav-tab",onClick:()=>Ne("/client/circuit"),children:[e.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("path",{d:"M12 6v6l4 2"})]}),e.jsx("span",{children:"Circuit"})]})]})]})}const Is=[{name:"Dumbbell Floor Press",type:"weighted",equipment:"dumbbells",group:"push",pbKey:"chestPress",storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Seated Dumbbell Shoulder Press",type:"weighted",equipment:"dumbbells",group:"push",pbKey:"shoulderPress",storagePath:"exercises/dumbbells/upper/seated dumbbell shoulder press.mp4"},{name:"Seated Dumbbell Arnold Press",type:"weighted",equipment:"dumbbells",group:"push",storagePath:"exercises/dumbbells/upper/seated dumbbell arnold press.mp4"},{name:"Dumbbell Overhead Tricep Extension",type:"weighted",equipment:"dumbbells",group:"push",storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Skullcrushers",type:"weighted",equipment:"dumbbells",group:"push",storagePath:"exercises/dumbbells/upper/skullcrushers.mp4"},{name:"Dumbbell Lateral Raise",type:"weighted",equipment:"dumbbells",group:"push",storagePath:"exercises/dumbbells/upper/dumbbell lateral raise.mp4"},{name:"Dumbbell Front Raise",type:"weighted",equipment:"dumbbells",group:"push",storagePath:"exercises/dumbbells/upper/dumbbell front raise.mp4"},{name:"Press Up",type:"reps",equipment:"bodyweight",group:"push",storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Tricep Dips",type:"reps",equipment:"bodyweight",group:"push",storagePath:"exercises/bodyweight/upper/tricep dips.mp4"},{name:"Pike Push Ups",type:"reps",equipment:"bodyweight",group:"push",storagePath:"exercises/bodyweight/upper/pike push ups.GIF"},{name:"Reverse Plank",type:"timed",equipment:"bodyweight",group:"push",storagePath:"exercises/bodyweight/upper/reverse plank.GIF"},{name:"Dumbbell Squeeze Press",type:"weighted",equipment:"dumbbells",group:"push",storagePath:null},{name:"Incline Dumbbell Press",type:"weighted",equipment:"dumbbells",group:"push",storagePath:null},{name:"Dumbbell Pullover",type:"weighted",equipment:"dumbbells",group:"push",storagePath:null},{name:"Dumbbell Fly",type:"weighted",equipment:"dumbbells",group:"push",storagePath:null},{name:"Tricep Kickback",type:"weighted",equipment:"dumbbells",group:"push",storagePath:null},{name:"Dumbbell Shrug",type:"weighted",equipment:"dumbbells",group:"push",storagePath:null},{name:"Dumbbell Y-Raise",type:"weighted",equipment:"dumbbells",group:"push",storagePath:null},{name:"Wide Press Up",type:"reps",equipment:"bodyweight",group:"push",storagePath:null},{name:"Diamond Press Up",type:"reps",equipment:"bodyweight",group:"push",storagePath:null},{name:"Decline Press Up",type:"reps",equipment:"bodyweight",group:"push",storagePath:null},{name:"Wall Walks",type:"reps",equipment:"bodyweight",group:"push",storagePath:null},{name:"Press Up Hold",type:"timed",equipment:"bodyweight",group:"push",storagePath:null},{name:"Shoulder Tap Hold",type:"timed",equipment:"bodyweight",group:"push",storagePath:null},{name:"Dumbbell Bent Over Row",type:"weighted",equipment:"dumbbells",group:"pull",pbKey:"seatedRow",storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Single Arm Bent Over Row",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Bicep Curl",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Hammer Curl",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:"exercises/dumbbells/upper/hammer curl.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Renegade Row",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:"exercises/dumbbells/upper/renegade row.mp4"},{name:"Wide Dumbbell Bent Over Row",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:null},{name:"Reverse Fly",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:null},{name:"Concentration Curl",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:null},{name:"Wide Grip Bicep Curl",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:null},{name:"Wrist Curl",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:null},{name:"Prone Y-T-W Raises",type:"reps",equipment:"bodyweight",group:"pull",storagePath:null},{name:"Reverse Snow Angel",type:"reps",equipment:"bodyweight",group:"pull",storagePath:null},{name:"Isometric Bicep Hold",type:"timed",equipment:"bodyweight",group:"pull",storagePath:null},{name:"Dumbbell Goblet Squats",type:"weighted",equipment:"dumbbells",group:"lower",pbKey:"squat",storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Romanian Deadlifts",type:"weighted",equipment:"dumbbells",group:"lower",pbKey:"deadlift",storagePath:"exercises/dumbbells/lower/romanian deadlifts.GIF"},{name:"Forward Dumbbell Lunges",type:"weighted",equipment:"dumbbells",group:"lower",storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.GIF"},{name:"Dumbbell Sumo Squats",type:"weighted",equipment:"dumbbells",group:"lower",storagePath:"exercises/dumbbells/lower/dumbbell sumo squats.GIF"},{name:"Weighted Calf Raises",type:"weighted",equipment:"dumbbells",group:"lower",storagePath:"exercises/dumbbells/lower/weighted calf raises.GIF"},{name:"1 Legged RDL",type:"weighted",equipment:"dumbbells",group:"lower",storagePath:"exercises/dumbbells/lower/1 legged rdl.GIF"},{name:"Dumbbell Box Step Ups",type:"weighted",equipment:"dumbbells",group:"lower",storagePath:"exercises/dumbbells/lower/dumbbell box step ups.mp4"},{name:"Dumbbell Squat Pulses",type:"weighted",equipment:"dumbbells",group:"lower",storagePath:"exercises/dumbbells/lower/dumbbell squat pulses.GIF"},{name:"Dumbbell Reverse Lunges",type:"weighted",equipment:"dumbbells",group:"lower",storagePath:"exercises/dumbbells/lower/dumbbell reverse lunges.GIF"},{name:"Kettlebell Romanian Deadlift",type:"weighted",equipment:"kettlebell",group:"lower",storagePath:"exercises/kettlebells/lower/kettlebell romanian deadlift.mp4"},{name:"Reverse Lunge",type:"reps",equipment:"bodyweight",group:"lower",storagePath:"exercises/bodyweight/lower/reverse lunge.GIF"},{name:"Box Step Ups",type:"reps",equipment:"bodyweight",group:"lower",storagePath:"exercises/bodyweight/lower/box step ups.GIF"},{name:"Bulgarian Split Squats",type:"reps",equipment:"bodyweight",group:"lower",storagePath:"exercises/bodyweight/lower/bulgarian split squats.GIF"},{name:"Jump Squats",type:"reps",equipment:"bodyweight",group:"lower",storagePath:"exercises/bodyweight/lower/jump squats.GIF"},{name:"Hip Thrusts",type:"reps",equipment:"bodyweight",group:"lower",storagePath:"exercises/bodyweight/lower/hip thrusts.GIF"},{name:"Donkey Kicks",type:"reps",equipment:"bodyweight",group:"lower",storagePath:"exercises/bodyweight/lower/donkey kicks.GIF"},{name:"Skater Jumps",type:"reps",equipment:"bodyweight",group:"lower",storagePath:"exercises/bodyweight/lower/skater jumps.GIF"},{name:"Squat And Hold",type:"timed",equipment:"bodyweight",group:"lower",storagePath:"exercises/bodyweight/lower/squat and hold.GIF"},{name:"Forearm Plank",type:"timed",equipment:"bodyweight",group:"core",pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"},{name:"Side Plank",type:"timed",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Side Plank.mp4"},{name:"Hollow Body Hold",type:"timed",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"},{name:"Superman Hold",type:"timed",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Superman Hold.mp4"},{name:"Mountain Climbers",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Mountain Climbers.mp4"},{name:"Fast Mountain Climbers",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Fast Mountain Climbers.mp4"},{name:"Cross Body Mountain Climbers",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Cross Body Mountain Climbers.mp4"},{name:"Russian Twist",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Russian Twist.mp4"},{name:"Crunch",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Crunch.mp4"},{name:"Bicycle Crunch",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Bicycle Crunch.mp4"},{name:"Leg Raises",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Leg Raises.mp4"},{name:"Dead Bug",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Dead Bug.mp4"},{name:"Dead Bug Single Leg Drop",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Dead Bug Single Leg Drop.mp4"},{name:"Bird Dog",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Bird Dog.mp4"},{name:"Flutter Kicks",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Flutter Kicks.mp4"},{name:"Hollow Hold Flutter Kicks",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Hollow Hold Flutter Kicks.mp4"},{name:"High Plank Shoulder Taps",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/High Plank Shoulder Taps.mp4"},{name:"Hip Dips Plank",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Hip Dips Plank.mp4"},{name:"Single Leg V-Up",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Single Leg V-Up.mp4"},{name:"Hollow Hold To V-Sit",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Hollow Hold To V-sit.mp4"},{name:"Toe Reaches",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/toe reaches.GIF"},{name:"Side Plank Rotation",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Side Plank Rotation.mp4"},{name:"Plank Walkout",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Plank Walkout.mp4"},{name:"Reverse Crunch To Leg Raise",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Reverse Crunch To Leg Raise.mp4"},{name:"Burpee",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Russian Twists Dumbbell",type:"weighted",equipment:"dumbbells",group:"core",storagePath:"exercises/dumbbells/core/russian twists dumbbell.GIF"},{name:"Kettlebell Russian Twist",type:"weighted",equipment:"kettlebell",group:"core",storagePath:"exercises/kettlebells/core/kettlebell russian twist.mp4"},{name:"Kettlebell Side Bends",type:"weighted",equipment:"kettlebell",group:"core",storagePath:"exercises/kettlebells/core/kettlebell side bends.mp4"},{name:"Kneeling Kettlebell Halo",type:"weighted",equipment:"kettlebell",group:"core",storagePath:"exercises/kettlebells/core/kneeling kettlebell halo.mp4"},{name:"Kettlebell Bird Dog Drag",type:"reps",equipment:"kettlebell",group:"core",storagePath:"exercises/kettlebells/core/kettlebell bird dog drag.mp4"},{name:"Back Extension Hold",type:"timed",equipment:"bodyweight",group:"core",storagePath:null},{name:"Dumbbell Plank Pull Through",type:"weighted",equipment:"dumbbells",group:"core",storagePath:null}];Is.filter(h=>h.storagePath!==null);const Qs=[{key:"push",label:"Push",subtitle:"Chest / Shoulders / Triceps",color:"#A12F3A",icon:"M4 10v4M8 7v10M8 12h8M16 7v10M20 10v4"},{key:"pull",label:"Pull",subtitle:"Back / Biceps",color:"#2196f3",icon:"M4 12h16M12 4v16M7 7l10 10M17 7L7 17"},{key:"lower",label:"Lower",subtitle:"Legs / Glutes",color:"#ff9800",icon:"M13 2L3 14h9l-1 8 10-12h-9l1-8z"},{key:"core",label:"Core",subtitle:"Abs / Stability",color:"#7c3aed",icon:"M12 22c5.52 0 10-4.48 10-10S17.52 2 12 2 2 6.48 2 12s4.48 10 10 10zM12 18c3.31 0 6-2.69 6-6s-2.69-6-6-6-6 2.69-6 6 2.69 6 6 6zM12 14a2 2 0 1 0 0-4 2 2 0 0 0 0 4z"}],Hs={};Is.forEach(h=>{Hs[h.name]=h.group});function Zs(h){return Hs[h]||null}const ge=[{key:"chestPress",name:"Chest Press",category:"Upper Body - Push",unit:"weight"},{key:"shoulderPress",name:"Shoulder Press",category:"Upper Body - Push",unit:"weight"},{key:"seatedRow",name:"Seated Row",category:"Upper Body - Pull",unit:"weight"},{key:"latPulldown",name:"Lat Pulldown",category:"Upper Body - Pull",unit:"weight"},{key:"squat",name:"Squat",category:"Lower Body",unit:"weight"},{key:"deadlift",name:"Deadlift",category:"Lower Body",unit:"weight"},{key:"plank",name:"Plank",category:"Core",unit:"time"}],He=[{key:"weight",name:"Weight",suffix:"kg"},{key:"chest",name:"Chest",suffix:"cm"},{key:"waist",name:"Waist",suffix:"cm"},{key:"hips",name:"Hips",suffix:"cm"},{key:"leftArm",name:"Left Arm",suffix:"cm"},{key:"rightArm",name:"Right Arm",suffix:"cm"},{key:"leftThigh",name:"Left Thigh",suffix:"cm"},{key:"rightThigh",name:"Right Thigh",suffix:"cm"}];function et(){const h=new Date;return`${h.getFullYear()}-${String(h.getMonth()+1).padStart(2,"0")}`}function he(h){const[u,m]=h.split("-");return new Date(parseInt(u),parseInt(m)-1).toLocaleDateString("en-GB",{month:"long",year:"numeric"})}function js(h){if(!h&&h!==0)return"-";const u=Math.floor(h/60),m=(h%60).toFixed(2);return u>0?`${u}m ${parseFloat(m).toFixed(0)}s`:`${parseFloat(m).toFixed(2)}s`}function Fs(h,u){return!h&&h!==0?"-":!u&&u!==0?`${h}kg`:`${h}kg x ${u}`}function _e(h,u){return u?h.unit==="time"?u.time||0:(u.weight||0)*(u.reps||0):0}function Ps(h,u){return!u||u===0?null:(h-u)/u*100}function st({data:h,exerciseKey:u,unit:m}){if(!h||h.length<2)return e.jsx("div",{className:"pb-trend-empty",children:e.jsx("p",{children:"Not enough data for trend line yet"})});const z=h.map(f=>{const x=f.benchmarks?.[u];return x?m==="time"?x.time||0:(x.weight||0)*(x.reps||0):0}),Be=Math.max(...z),ue=Math.min(...z),M=Be-ue||1,C=300,P=100,E=20,ie=C-E*2,D=P-E*2,I=z.map((f,x)=>{const _=E+x/(z.length-1)*ie,Q=E+D-(f-ue)/M*D;return{x:_,y:Q,value:f}}),U=I.map((f,x)=>`${x===0?"M":"L"} ${f.x} ${f.y}`).join(" "),be=U+` L ${I[I.length-1].x} ${E+D} L ${I[0].x} ${E+D} Z`;return e.jsxs("div",{className:"pb-trend-chart",children:[e.jsxs("svg",{viewBox:`0 0 ${C} ${P}`,preserveAspectRatio:"xMidYMid meet",children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"trendGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"0%",stopColor:"var(--color-primary)",stopOpacity:"0.3"}),e.jsx("stop",{offset:"100%",stopColor:"var(--color-primary)",stopOpacity:"0.02"})]})}),e.jsx("path",{d:be,fill:"url(#trendGradient)"}),e.jsx("path",{d:U,fill:"none",stroke:"var(--color-primary)",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round"}),I.map((f,x)=>e.jsx("circle",{cx:f.x,cy:f.y,r:"4",fill:"var(--bg-card)",stroke:"var(--color-primary)",strokeWidth:"2"},x))]}),e.jsx("div",{className:"pb-trend-labels",children:h.map((f,x)=>e.jsxs("span",{className:"pb-trend-label",children:[f.month.split("-")[1],"/",f.month.split("-")[0].slice(2)]},x))})]})}function at(){const[h,u]=p.useState("bests"),[m,z]=p.useState([]),[Be,ue]=p.useState(!0),[M,C]=p.useState(!1),[P,E]=p.useState(0),[ie,D]=p.useState(!1),[I,U]=p.useState(!1),[be,f]=p.useState(!1),[x,_]=p.useState({}),[Q,le]=p.useState({}),[F,Pe]=p.useState({}),[q,Se]=p.useState({}),[S,Z]=p.useState({}),[Qe,xe]=p.useState(!1),[$e,ee]=p.useState({}),[L,Ze]=p.useState([]),[ye,Le]=p.useState(null),[je,Re]=p.useState(null),[ce,vs]=p.useState(!1),[ve,es]=p.useState(""),[ke,ss]=p.useState(""),[Me,us]=p.useState({}),[me,ts]=p.useState({}),[se,fe]=p.useState(null),[Ve,R]=p.useState(""),[Ge,ks]=p.useState({}),Ne=p.useRef(null),te=p.useRef(0),we=p.useRef(0),X=p.useRef("right"),B=p.useCallback(t=>{E(n=>{const r=Math.max(0,Math.min(ge.length-1,t));return r===n?n:(X.current=r>n?"right":"left",r)})},[]),{currentUser:Fe,isClient:Oe,clientData:T,loading:ze}=qs(),{isDark:Ss}=Ws(),Ce=Ds(),[qe]=Os(),rs=qe.get("mode")==="corebuddy",ne=!rs&&(!T?.clientType||T.clientType==="block"),Y=p.useCallback((t,n="info")=>{Re({message:t,type:n}),setTimeout(()=>Re(null),4e3)},[]);p.useEffect(()=>{!ze&&(!Fe||!Oe)&&Ce("/")},[Fe,Oe,ze,Ce]),p.useEffect(()=>{T&&(ne?as():(async()=>{try{const[n,r]=await Promise.all([Vs(K(W,"coreBuddyPBs",T.id)),Vs(K(W,"coreBuddyTargets",T.id))]);n.exists()&&us(n.data().exercises||{}),r.exists()&&ts(r.data().targets||{})}catch(n){console.error("Error loading Core Buddy PBs:",n)}ue(!1)})())},[T]);const as=async()=>{try{const t=Ye(Ke(W,"personalBests"),Xe("clientId","==",T.id)),r=(await Je(t)).docs.map(b=>({id:b.id,...b.data()}));r.sort((b,N)=>b.month.localeCompare(N.month)),z(r);const a=Ye(Ke(W,"personalBestTargets"),Xe("clientId","==",T.id)),d=await Je(a);if(!d.empty){const b=d.docs[0].data();Pe(b.targets||{}),Se(b.metricTargets||{}),Z(b.targets||{}),ee(b.metricTargets||{})}const v=Ye(Ke(W,"achievements"),Xe("clientId","==",T.id)),k=await Je(v);k.empty||Ze(k.docs[0].data().badges||[])}catch(t){console.error("Error fetching personal bests:",t)}ue(!1)},fs=async()=>{if(!se||!Ve||!T)return;const t=parseFloat(Ve),n=Me[se];if(!n||t<=n.weight){Y("Target must be higher than current PB","error");return}C(!0);try{const r={...me,[se]:{targetWeight:t,setAt:O.now(),currentPBWhenSet:n.weight}};await pe(K(W,"coreBuddyTargets",T.id),{clientId:T.id,targets:r,updatedAt:O.now()}),ts(r),fe(null),R(""),Y("Target set!","success")}catch(r){console.error("Error saving target:",r),Y("Failed to save target","error")}C(!1)},ns=t=>{const n=me[t];if(!n)return null;const r=Me[t];if(!r)return 0;const a=n.currentPBWhenSet||0,d=n.targetWeight,v=d-a;return v<=0?r.weight>=d?1:0:Math.max(0,Math.min((r.weight-a)/v,1))},re=et(),V=m.find(t=>t.month===re),is=m.filter(t=>t.month<re),ms=is.length>0?is[is.length-1]:null;p.useEffect(()=>{V?(_(V.benchmarks||{}),le(V.bodyMetrics||{})):(_({}),le({}))},[V?.id]);const gs=async(t,n)=>{const r=[];if(t==="strength"?ge.forEach(a=>{const d=F[a.key];if(!d)return;const v=n[a.key];if(!v)return;let k;if(d.targetType==="time"){if(!d.targetValue)return;const b=d.startValue||0,N=v.time||0,H=d.targetValue-b;k=H===0?N>=d.targetValue?1:0:Math.max(0,(N-b)/H)}else{if(!d.targetWeight&&!d.targetReps)return;const b=(d.startWeight||0)*(d.startReps||0),N=(d.targetWeight||0)*(d.targetReps||0),H=(v.weight||0)*(v.reps||0),A=N-b;k=A===0?H>=N?1:0:Math.max(0,(H-b)/A)}if(k>=1&&!(d.targetType==="time"?L.some(N=>N.type==="strength"&&N.key===a.key&&N.targetValue===d.targetValue):L.some(N=>N.type==="strength"&&N.key===a.key&&N.targetWeight===d.targetWeight&&N.targetReps===d.targetReps))){const N=d.targetType==="time"?`${a.name} ${d.targetValue}s`:`${a.name} ${d.targetWeight}kg × ${d.targetReps}`;r.push({type:"strength",key:a.key,...d.targetType==="time"?{targetType:"time",targetValue:d.targetValue}:{targetWeight:d.targetWeight,targetReps:d.targetReps},achievedMonth:re,label:N})}}):He.forEach(a=>{const d=q[a.key];if(!d||!d.targetValue)return;const v=n[a.key];if(v==null)return;const k=d.startValue||0,b=d.targetValue,N=b-k;(N===0?v===b?1:0:Math.max(0,(v-k)/N))>=1&&(L.some(ae=>ae.type==="metric"&&ae.key===a.key&&ae.targetValue===b)||r.push({type:"metric",key:a.key,targetValue:b,achievedMonth:re,label:`${a.name} ${b}${a.suffix}`}))}),r.length>0){const a=[...L,...r];await pe(K(W,"achievements",T.id),{clientId:T.id,badges:a,updatedAt:O.now()}),Ze(a),Le(r),setTimeout(()=>Le(null),5e3)}},bs=(t,n)=>{if(t==="strength"){const r=F[n];return r?r.targetType==="time"?L.some(a=>a.type==="strength"&&a.key===n&&a.targetValue===r.targetValue):!r.targetWeight&&!r.targetReps?!1:L.some(a=>a.type==="strength"&&a.key===n&&a.targetWeight===r.targetWeight&&a.targetReps===r.targetReps):!1}else{const r=q[n];return!r||!r.targetValue?!1:L.some(a=>a.type==="metric"&&a.key===n&&a.targetValue===r.targetValue)}},ls=async()=>{C(!0);try{const t=`${T.id}_${re}`,n=V||{};await pe(K(W,"personalBests",t),{clientId:T.id,month:re,benchmarks:x,bodyMetrics:n.bodyMetrics||Q||{},createdAt:n.createdAt||O.now(),updatedAt:O.now()}),await gs("strength",x),Y("Benchmarks saved!","success"),D(!1),await as()}catch(t){console.error("Error saving benchmarks:",t),Y("Failed to save. Please try again.","error")}C(!1)},cs=async()=>{C(!0);try{const t=`${T.id}_${re}`,n=V||{};await pe(K(W,"personalBests",t),{clientId:T.id,month:re,benchmarks:n.benchmarks||x||{},bodyMetrics:Q,createdAt:n.createdAt||O.now(),updatedAt:O.now()}),await gs("metric",Q),Y("Body metrics saved!","success"),U(!1),await as()}catch(t){console.error("Error saving metrics:",t),Y("Failed to save. Please try again.","error")}C(!1)},G=(t,n,r)=>{_(a=>({...a,[t]:{...a[t],[n]:r===""?"":parseFloat(r)}}))},We=(t,n)=>{le(r=>({...r,[t]:n===""?"":parseFloat(n)}))},os=(t,n,r)=>{Z(a=>({...a,[t]:{...a[t],[n]:r===""?"":parseFloat(r)}}))},xs=async()=>{C(!0);try{const t=`targets_${T.id}`,n=V?.benchmarks||{},r={};ge.forEach(a=>{const d=n[a.key];a.unit==="time"?S[a.key]?.targetValue&&(r[a.key]={targetType:"time",targetValue:S[a.key].targetValue,startValue:d?.time||0}):(S[a.key]?.targetWeight||S[a.key]?.targetReps)&&(r[a.key]={targetWeight:S[a.key].targetWeight||0,targetReps:S[a.key].targetReps||0,startWeight:d?.weight||0,startReps:d?.reps||0})}),await pe(K(W,"personalBestTargets",t),{clientId:T.id,targets:r,metricTargets:q,updatedAt:O.now()}),Pe(r),Z(r),Y("Targets saved!","success"),f(!1)}catch(t){console.error("Error saving targets:",t),Y("Failed to save targets.","error")}C(!1)},Ns=(t,n)=>{ee(r=>({...r,[t]:{...r[t],targetValue:n===""?"":parseFloat(n)}}))},De=async()=>{C(!0);try{const t=`targets_${T.id}`,n={};He.forEach(r=>{if($e[r.key]?.targetValue){const a=V?.bodyMetrics?.[r.key]||0;n[r.key]={targetValue:$e[r.key].targetValue,startValue:a}}}),await pe(K(W,"personalBestTargets",t),{clientId:T.id,targets:F,metricTargets:n,updatedAt:O.now()}),Se(n),ee(n),Y("Metric targets saved!","success"),xe(!1)}catch(t){console.error("Error saving metric targets:",t),Y("Failed to save targets.","error")}C(!1)},Ae=async()=>{if(window.confirm("Reset all goals? This will clear all strength and body metric targets. Your recorded benchmarks and measurements will NOT be affected.")){C(!0);try{const t=K(W,"personalBestTargets",`targets_${T.id}`);await Es(t),Pe({}),Se({}),Z({}),ee({}),Y("All goals have been reset","success")}catch(t){console.error("Error resetting targets:",t),Y("Failed to reset goals","error")}C(!1)}},ws=(t,n)=>{const r=F[t];if(!r||!n)return null;if(r.targetType==="time"){if(!r.targetValue)return null;const b=r.startValue||0,N=r.targetValue,H=n.time||0,A=N-b;return A<=0?H>=N?1:0:Math.max(0,Math.min((H-b)/A,1))}if(!r.targetWeight&&!r.targetReps)return null;const a=(r.startWeight||0)*(r.startReps||0),d=(r.targetWeight||0)*(r.targetReps||0),v=(n.weight||0)*(n.reps||0),k=d-a;return k<=0?v>=d?1:0:Math.max(0,Math.min((v-a)/k,1))},ds=t=>{const n=q[t];if(!n||!n.targetValue)return null;const r=V?.bodyMetrics?.[t];if(r==null)return null;const a=n.startValue||0,d=n.targetValue,v=d-a;return v===0?r===d?1:0:Math.max(0,Math.min((r-a)/v,1))},Cs=t=>{te.current=t.touches[0].clientX,we.current=0},hs=t=>{we.current=t.touches[0].clientX-te.current},Ts=()=>{we.current<-50?B(P+1):we.current>50&&B(P-1),we.current=0},s=t=>{const n=V?.bodyMetrics?.[t],r=ms?.bodyMetrics?.[t];return n==null||r==null?null:parseFloat((n-r).toFixed(2))},i=m.find(t=>t.month===ve),c=m.find(t=>t.month===ke);if(ze||Be)return e.jsxs("div",{className:"pb-page",children:[e.jsx("header",{className:"client-header",children:e.jsx("div",{className:"header-content",children:e.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})})}),e.jsxs("main",{className:"pb-main",children:[e.jsx("div",{className:"skeleton skeleton-title",style:{width:180,height:28,marginBottom:20}}),e.jsx("div",{className:"skeleton skeleton-card-large",style:{height:320,borderRadius:16}})]})]});if(!Fe||!Oe||!T)return null;if(ne&&T?.isJunior)return e.jsx(Js,{});const l=ge[P],o=V?.benchmarks?.[l.key],w=ms?.benchmarks?.[l.key],$=_e(l,o),g=_e(l,w),j=Ps($,g),y=ws(l.key,o),J=y!==null,Ee=y!==null&&y>=1,Gs=J?Math.round(y*60):$>0?15:0,Te=F[l.key];return e.jsx(zs,{children:e.jsxs("div",{className:"pb-page",children:[e.jsx("header",{className:"client-header",children:e.jsxs("div",{className:"header-content",children:[e.jsx("button",{className:"header-back-btn",onClick:()=>Ce(rs?"/client/core-buddy":"/client"),"aria-label":"Go back",children:e.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("path",{d:"M15 18l-6-6 6-6"})})}),e.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})]})}),e.jsxs("main",{className:"pb-main page-transition-enter",children:[e.jsxs("div",{className:"pb-intro anim-fade-up",children:[e.jsx("h2",{children:"Personal Bests"}),e.jsx("p",{children:ne?"Track your strength benchmarks and body measurements each month.":"Your all-time best lifts from programme workouts."})]}),!ne&&e.jsxs("div",{className:"pb-cb-section anim-fade-up-d2",children:[Object.keys(Me).length===0?e.jsxs("div",{className:"pb-empty",children:[e.jsx("div",{className:"pb-cb-empty-icon",children:e.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("path",{d:"M20.57 14.86L22 13.43 20.57 12 17 15.57 8.43 7 12 3.43 10.57 2 9.14 3.43 7.71 2 5.57 4.14 4.14 2.71 2.71 4.14l1.43 1.43L2 7.71l1.43 1.43L2 10.57 3.43 12 7 8.43 15.57 17 12 20.57 13.43 22l1.43-1.43L16.29 22l2.14-2.14 1.43 1.43 1.43-1.43-1.43-1.43L22 16.29z"})})}),e.jsx("h4",{children:"No personal bests yet"}),e.jsx("p",{children:"Complete weight-based workouts to start tracking your personal bests."})]}):e.jsx("div",{className:"pb-cb-grouped",children:(()=>{const t={},n=[];return Object.entries(Me).forEach(([r,a])=>{const d=Zs(r);d?(t[d]||(t[d]=[]),t[d].push([r,a])):n.push([r,a])}),Object.values(t).forEach(r=>r.sort(([a],[d])=>a.localeCompare(d))),n.sort(([r],[a])=>r.localeCompare(a)),e.jsxs(e.Fragment,{children:[Qs.map(r=>{const a=t[r.key];if(!a||a.length===0)return null;const d=!!Ge[r.key],v=a.reduce((k,[,b])=>!k||b.weight>k.weight?b:k,null);return e.jsxs("div",{className:`pb-cb-group ${d?"open":""}`,style:{"--group-color":r.color},children:[e.jsxs("button",{className:"pb-cb-group-header",onClick:()=>ks(k=>({...k,[r.key]:!k[r.key]})),children:[e.jsx("div",{className:"pb-cb-group-accent"}),e.jsx("div",{className:"pb-cb-group-icon",children:e.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:e.jsx("path",{d:r.icon})})}),e.jsxs("div",{className:"pb-cb-group-text",children:[e.jsx("h3",{className:"pb-cb-group-label",children:r.label}),e.jsx("span",{className:"pb-cb-group-subtitle",children:r.subtitle})]}),e.jsxs("div",{className:"pb-cb-group-meta",children:[e.jsxs("span",{className:"pb-cb-group-count",children:[a.length," PB",a.length!==1?"s":""]}),v&&e.jsxs("span",{className:"pb-cb-group-best",children:["Best: ",v.weight,"kg"]})]}),e.jsx("svg",{className:`pb-cb-group-chevron ${d?"open":""}`,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("path",{d:"M6 9l6 6 6-6"})})]}),e.jsx("div",{className:"pb-cb-group-body",style:{display:d?"block":"none"},children:e.jsx("div",{className:"pb-cb-grid",children:a.map(([k,b],N)=>{const H=me[k],A=ns(k),ae=A!==null&&A>=1,Ms=A!==null?Math.round(A*60):60;return e.jsxs("div",{className:"pb-cb-card",style:{"--group-color":r.color,animationDelay:`${N*.05}s`},children:[e.jsxs("div",{className:"pb-cb-card-top",children:[e.jsxs("div",{className:"pb-cb-card-ring",children:[e.jsx("svg",{className:"pb-cb-ring-svg",viewBox:"0 0 80 80",children:Rs.map((ps,$s)=>{const Ls=$s<Ms;return e.jsx("line",{x1:ps.x1,y1:ps.y1,x2:ps.x2,y2:ps.y2,className:`pb-ring-tick ${Ls?ae?"hit":"filled":"empty"}`,style:Ls&&!ae?{stroke:r.color}:void 0,strokeWidth:ps.thick?"2":"1.5"},$s)})}),e.jsx("div",{className:"pb-cb-ring-icon",style:{color:r.color},children:e.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:e.jsx("path",{d:r.icon})})})]}),e.jsxs("div",{className:"pb-cb-card-info",children:[e.jsx("h4",{className:"pb-cb-card-name",children:k}),e.jsxs("div",{className:"pb-cb-card-value",style:{color:r.color},children:[b.weight,"kg × ",b.reps]}),b.achievedAt&&e.jsx("div",{className:"pb-cb-card-date",children:(b.achievedAt.toDate?b.achievedAt.toDate():new Date(b.achievedAt)).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"})}),H&&ae&&e.jsx("div",{className:"pb-cb-target-info hit",children:"Target hit!"})]}),e.jsx("div",{className:"pb-cb-card-action",children:e.jsx("button",{className:"pb-cb-target-btn",style:{borderColor:r.color,background:`color-mix(in srgb, ${r.color} 10%, transparent)`,color:r.color},onClick:()=>{fe(k),R("")},children:H?ae?e.jsx("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{d:"M12 5v14M5 12h14"})}):e.jsxs("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),e.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]}):e.jsxs("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("circle",{cx:"12",cy:"12",r:"6"}),e.jsx("circle",{cx:"12",cy:"12",r:"2"})]})})})]}),H&&!ae&&e.jsxs("div",{className:"pb-cb-card-progress",children:[e.jsxs("div",{className:"pb-cb-progress-labels",children:[e.jsxs("span",{className:"pb-cb-progress-current",children:[b.weight,"kg"]}),e.jsxs("span",{className:"pb-cb-progress-target",style:{color:r.color},children:["Target: ",H.targetWeight,"kg"]})]}),e.jsx("div",{className:"pb-cb-progress-bar",children:e.jsx("div",{className:"pb-cb-progress-bar-fill",style:{width:`${Math.round((A||0)*100)}%`,background:r.color}})}),e.jsxs("div",{className:"pb-cb-progress-pct",style:{color:r.color},children:[Math.round((A||0)*100),"%"]})]}),H&&ae&&e.jsx("div",{className:"pb-cb-card-progress",children:e.jsx("div",{className:"pb-cb-progress-bar",children:e.jsx("div",{className:"pb-cb-progress-bar-fill hit",style:{width:"100%"}})})})]},k)})})})]},r.key)}),n.length>0&&(()=>{const r=!!Ge.other;return e.jsxs("div",{className:`pb-cb-group ${r?"open":""}`,style:{"--group-color":"var(--text-tertiary)"},children:[e.jsxs("button",{className:"pb-cb-group-header",onClick:()=>ks(a=>({...a,other:!a.other})),children:[e.jsx("div",{className:"pb-cb-group-accent"}),e.jsx("div",{className:"pb-cb-group-icon",children:e.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:e.jsx("path",{d:"M20.57 14.86L22 13.43 20.57 12 17 15.57 8.43 7 12 3.43 10.57 2 9.14 3.43 7.71 2 5.57 4.14 4.14 2.71 2.71 4.14l1.43 1.43L2 7.71l1.43 1.43L2 10.57 3.43 12 7 8.43 15.57 17 12 20.57 13.43 22l1.43-1.43L16.29 22l2.14-2.14 1.43 1.43 1.43-1.43-1.43-1.43L22 16.29z"})})}),e.jsx("div",{className:"pb-cb-group-text",children:e.jsx("h3",{className:"pb-cb-group-label",children:"Other"})}),e.jsx("div",{className:"pb-cb-group-meta",children:e.jsxs("span",{className:"pb-cb-group-count",children:[n.length," PB",n.length!==1?"s":""]})}),e.jsx("svg",{className:`pb-cb-group-chevron ${r?"open":""}`,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("path",{d:"M6 9l6 6 6-6"})})]}),e.jsx("div",{className:"pb-cb-group-body",style:{display:r?"block":"none"},children:e.jsx("div",{className:"pb-cb-grid",children:n.map(([a,d],v)=>{const k=me[a],b=ns(a),N=b!==null&&b>=1,H=b!==null?Math.round(b*60):60;return e.jsxs("div",{className:"pb-cb-card",style:{animationDelay:`${v*.05}s`},children:[e.jsxs("div",{className:"pb-cb-card-top",children:[e.jsxs("div",{className:"pb-cb-card-ring",children:[e.jsx("svg",{className:"pb-cb-ring-svg",viewBox:"0 0 80 80",children:Rs.map((A,ae)=>{const Ms=ae<H;return e.jsx("line",{x1:A.x1,y1:A.y1,x2:A.x2,y2:A.y2,className:`pb-ring-tick ${Ms?N?"hit":"filled":"empty"}`,strokeWidth:A.thick?"2":"1.5"},ae)})}),e.jsx("div",{className:"pb-cb-ring-icon",children:e.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M20.57 14.86L22 13.43 20.57 12 17 15.57 8.43 7 12 3.43 10.57 2 9.14 3.43 7.71 2 5.57 4.14 4.14 2.71 2.71 4.14l1.43 1.43L2 7.71l1.43 1.43L2 10.57 3.43 12 7 8.43 15.57 17 12 20.57 13.43 22l1.43-1.43L16.29 22l2.14-2.14 1.43 1.43 1.43-1.43-1.43-1.43L22 16.29z"})})})]}),e.jsxs("div",{className:"pb-cb-card-info",children:[e.jsx("h4",{className:"pb-cb-card-name",children:a}),e.jsxs("div",{className:"pb-cb-card-value",children:[d.weight,"kg × ",d.reps]}),d.achievedAt&&e.jsx("div",{className:"pb-cb-card-date",children:(d.achievedAt.toDate?d.achievedAt.toDate():new Date(d.achievedAt)).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"})}),k&&N&&e.jsx("div",{className:"pb-cb-target-info hit",children:"Target hit!"})]}),e.jsx("div",{className:"pb-cb-card-action",children:e.jsx("button",{className:"pb-cb-target-btn",onClick:()=>{fe(a),R("")},children:k?N?e.jsx("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{d:"M12 5v14M5 12h14"})}):e.jsxs("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),e.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]}):e.jsxs("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("circle",{cx:"12",cy:"12",r:"6"}),e.jsx("circle",{cx:"12",cy:"12",r:"2"})]})})})]}),k&&!N&&e.jsxs("div",{className:"pb-cb-card-progress",children:[e.jsxs("div",{className:"pb-cb-progress-labels",children:[e.jsxs("span",{className:"pb-cb-progress-current",children:[d.weight,"kg"]}),e.jsxs("span",{className:"pb-cb-progress-target",children:["Target: ",k.targetWeight,"kg"]})]}),e.jsx("div",{className:"pb-cb-progress-bar",children:e.jsx("div",{className:"pb-cb-progress-bar-fill",style:{width:`${Math.round((b||0)*100)}%`}})}),e.jsxs("div",{className:"pb-cb-progress-pct",children:[Math.round((b||0)*100),"%"]})]}),k&&N&&e.jsx("div",{className:"pb-cb-card-progress",children:e.jsx("div",{className:"pb-cb-progress-bar",children:e.jsx("div",{className:"pb-cb-progress-bar-fill hit",style:{width:"100%"}})})})]},a)})})})]})})()]})})()}),se&&e.jsx("div",{className:"pb-cb-target-modal-overlay",onClick:()=>fe(null),children:e.jsxs("div",{className:"pb-cb-target-modal",onClick:t=>t.stopPropagation(),children:[e.jsx("h3",{children:"Set Target"}),e.jsx("p",{className:"pb-cb-target-exercise-name",children:se}),e.jsxs("div",{className:"pb-cb-target-current",children:["Current PB: ",e.jsxs("strong",{children:[Me[se]?.weight,"kg"]})]}),e.jsxs("div",{className:"pb-cb-target-input-wrap",children:[e.jsx("label",{children:"Your target (kg)"}),e.jsx("input",{type:"number",inputMode:"decimal",step:"0.5",value:Ve,onChange:t=>R(t.target.value),placeholder:String((Me[se]?.weight||0)+5),className:"pb-cb-target-input",autoFocus:!0})]}),e.jsxs("div",{className:"pb-cb-target-actions",children:[e.jsx("button",{className:"pb-cancel-btn",onClick:()=>fe(null),children:"Cancel"}),e.jsx("button",{className:"pb-save-btn",onClick:fs,disabled:M,children:M?"Saving...":"Set Target"})]})]})})]}),ne&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"pb-tabs",children:[e.jsx("button",{className:`pb-tab ${h==="bests"?"active":""}`,onClick:()=>u("bests"),children:"Strength"}),e.jsx("button",{className:`pb-tab ${h==="metrics"?"active":""}`,onClick:()=>u("metrics"),children:"Body Metrics"}),e.jsx("button",{className:`pb-tab ${h==="history"?"active":""}`,onClick:()=>u("history"),children:"History"})]}),h==="bests"&&e.jsxs("div",{className:"pb-strength-section",children:[!ie&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"pb-carousel",ref:Ne,onTouchStart:Cs,onTouchMove:hs,onTouchEnd:Ts,children:[e.jsx("div",{className:`pb-ring-container slide-from-${X.current}`,children:e.jsxs("div",{className:"pb-ring",children:[e.jsx("svg",{className:"pb-ring-svg",viewBox:"0 0 200 200",children:As.map((t,n)=>{const r=n<Math.round(Gs);return e.jsx("line",{x1:t.x1,y1:t.y1,x2:t.x2,y2:t.y2,className:`pb-ring-tick ${r?Ee?"hit":"filled":"empty"}`,strokeWidth:t.thick?"3":"2"},n)})}),e.jsxs("div",{className:"pb-ring-center",children:[e.jsx("div",{className:"pb-ring-category",children:l.category}),e.jsxs("div",{className:"pb-ring-exercise",children:[l.name,bs("strength",l.key)&&e.jsx("svg",{className:"pb-badge-icon",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})]}),e.jsx("div",{className:"pb-ring-value",children:o?l.unit==="time"?js(o.time):Fs(o.weight,o.reps):"-"}),j!==null&&e.jsxs("div",{className:`pb-ring-change ${j>=0?"positive":"negative"}`,children:[j>=0?"+":"",j.toFixed(1),"%"]}),j===null&&o&&e.jsx("div",{className:"pb-ring-change neutral",children:"New entry"}),Te&&e.jsx("div",{className:`pb-ring-target ${Ee?"hit":""}`,children:Ee?"Target hit!":Te.targetType==="time"?`${Te.startValue||0}s → ${Te.targetValue}s`:`${Te.startWeight||0}kg×${Te.startReps||0} → ${Te.targetWeight}kg×${Te.targetReps}`}),!Te&&e.jsx("div",{className:"pb-ring-target none",children:"No target set"})]})]})},P),e.jsx("div",{className:"pb-carousel-dots",children:ge.map((t,n)=>e.jsx("button",{className:`pb-dot ${n===P?"active":""}`,onClick:()=>B(n)},n))}),e.jsx("button",{className:"pb-carousel-arrow left",onClick:()=>B(P-1),disabled:P===0,children:e.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"})})}),e.jsx("button",{className:"pb-carousel-arrow right",onClick:()=>B(P+1),disabled:P===ge.length-1,children:e.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M8.59 16.59L10 18l6-6-6-6-1.41 1.41L13.17 12z"})})})]}),e.jsxs("div",{className:"pb-trend-section",children:[e.jsx("h4",{children:"Trend"}),e.jsx(st,{data:m,exerciseKey:l.key,unit:l.unit})]})]}),!ie&&!be&&e.jsxs("div",{className:"pb-action-buttons",children:[e.jsx("button",{className:"pb-edit-btn",onClick:()=>D(!0),children:V?.benchmarks?"Edit This Month's Benchmarks":"Add This Month's Benchmarks"}),e.jsx("button",{className:"pb-edit-btn pb-target-btn",onClick:()=>f(!0),children:Object.keys(F).length>0?"Edit Targets":"Set Targets"}),(Object.keys(F).length>0||Object.keys(q).length>0)&&e.jsx("button",{className:"pb-edit-btn pb-reset-btn",onClick:Ae,disabled:M,children:"Reset All Goals"})]}),ie&&e.jsxs("div",{className:"pb-edit-card",children:[e.jsxs("div",{className:"pb-edit-header",children:[e.jsxs("h3",{children:["Benchmarks - ",he(re)]}),e.jsx("button",{className:"pb-edit-close",onClick:()=>{D(!1),_(V?.benchmarks||{})},children:"×"})]}),e.jsx("div",{className:"pb-edit-body",children:ge.map(t=>e.jsxs("div",{className:"pb-edit-exercise",children:[e.jsx("div",{className:"pb-edit-exercise-name",children:t.name}),t.unit==="weight"?e.jsxs("div",{className:"pb-edit-row",children:[e.jsxs("div",{className:"pb-edit-field",children:[e.jsx("label",{children:"Weight (kg)"}),e.jsx("input",{type:"number",step:"0.5",value:x[t.key]?.weight??"",onChange:n=>G(t.key,"weight",n.target.value),placeholder:"0"})]}),e.jsxs("div",{className:"pb-edit-field",children:[e.jsx("label",{children:"Reps"}),e.jsx("input",{type:"number",value:x[t.key]?.reps??"",onChange:n=>G(t.key,"reps",n.target.value),placeholder:"0"})]})]}):e.jsx("div",{className:"pb-edit-row",children:e.jsxs("div",{className:"pb-edit-field full",children:[e.jsx("label",{children:"Time (seconds)"}),e.jsx("input",{type:"number",step:"0.01",value:x[t.key]?.time??"",onChange:n=>G(t.key,"time",n.target.value),placeholder:"0"})]})})]},t.key))}),e.jsxs("div",{className:"pb-edit-actions",children:[e.jsx("button",{className:"pb-cancel-btn",onClick:()=>{D(!1),_(V?.benchmarks||{})},children:"Cancel"}),e.jsx("button",{className:"pb-save-btn",onClick:ls,disabled:M,children:M?"Saving...":"Save"})]})]}),be&&e.jsxs("div",{className:"pb-edit-card",children:[e.jsxs("div",{className:"pb-edit-header",children:[e.jsx("h3",{children:"Set Your Targets"}),e.jsx("button",{className:"pb-edit-close",onClick:()=>{f(!1),Z(F)},children:"×"})]}),e.jsxs("div",{className:"pb-edit-body",children:[e.jsx("p",{className:"pb-target-hint",children:"Set a target for each exercise. Your current best is captured automatically from your latest benchmarks."}),ge.map(t=>{const n=V?.benchmarks?.[t.key];let r="-";return n&&(t.unit==="time"&&n.time?r=`${n.time}s`:(n.weight||n.reps)&&(r=`${n.weight||0}kg × ${n.reps||0}`)),e.jsxs("div",{className:"pb-edit-exercise",children:[e.jsxs("div",{className:"pb-edit-exercise-header",children:[e.jsx("div",{className:"pb-edit-exercise-name",children:t.name}),e.jsxs("div",{className:"pb-edit-current-best",children:["Current: ",r]})]}),t.unit==="weight"?e.jsxs("div",{className:"pb-edit-row",children:[e.jsxs("div",{className:"pb-edit-field",children:[e.jsx("label",{children:"Target Weight (kg)"}),e.jsx("input",{type:"number",step:"0.5",value:S[t.key]?.targetWeight??"",onChange:a=>os(t.key,"targetWeight",a.target.value),placeholder:"0"})]}),e.jsxs("div",{className:"pb-edit-field",children:[e.jsx("label",{children:"Target Reps"}),e.jsx("input",{type:"number",value:S[t.key]?.targetReps??"",onChange:a=>os(t.key,"targetReps",a.target.value),placeholder:"0"})]})]}):e.jsx("div",{className:"pb-edit-row",children:e.jsxs("div",{className:"pb-edit-field full",children:[e.jsx("label",{children:"Target (seconds)"}),e.jsx("input",{type:"number",step:"1",value:S[t.key]?.targetValue??"",onChange:a=>os(t.key,"targetValue",a.target.value),placeholder:"0"})]})})]},t.key)})]}),e.jsxs("div",{className:"pb-edit-actions",children:[e.jsx("button",{className:"pb-cancel-btn",onClick:()=>{f(!1),Z(F)},children:"Cancel"}),e.jsx("button",{className:"pb-save-btn",onClick:xs,disabled:M,children:M?"Saving...":"Save Targets"})]})]})]}),h==="metrics"&&e.jsxs("div",{className:"pb-metrics-section",children:[!I&&!Qe&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"pb-metrics-card",children:[e.jsx("h3",{children:"Body Measurements"}),e.jsx("p",{className:"pb-metrics-month",children:he(re)}),e.jsx("div",{className:"pb-metrics-list",children:He.map(t=>{const n=V?.bodyMetrics?.[t.key],r=s(t.key),a=q[t.key],d=ds(t.key),v=d!==null&&d>=1;return e.jsxs("div",{className:"pb-metric-row",children:[e.jsxs("div",{className:"pb-metric-top",children:[e.jsxs("div",{className:"pb-metric-left",children:[e.jsxs("span",{className:"pb-metric-name",children:[t.name,bs("metric",t.key)&&e.jsx("svg",{className:"pb-badge-icon-sm",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})]}),a&&e.jsxs("span",{className:"pb-metric-target-label",children:["Target: ",a.targetValue," ",t.suffix]})]}),e.jsxs("div",{className:"pb-metric-values",children:[e.jsx("span",{className:"pb-metric-current",children:n!=null?`${n} ${t.suffix}`:"-"}),r!==null&&e.jsxs("span",{className:`pb-metric-change ${r>0?"up":r<0?"down":"same"}`,children:[r>0?"+":"",r," ",t.suffix]})]})]}),d!==null&&e.jsxs("div",{className:"pb-metric-progress",children:[e.jsx("div",{className:"pb-metric-bar",children:e.jsx("div",{className:`pb-metric-bar-fill ${v?"hit":""}`,style:{width:`${Math.round(d*100)}%`}})}),e.jsx("span",{className:`pb-metric-percent ${v?"hit":""}`,children:v?"Hit!":`${Math.round(d*100)}%`})]})]},t.key)})})]}),e.jsxs("div",{className:"pb-action-buttons",children:[e.jsx("button",{className:"pb-edit-btn",onClick:()=>U(!0),children:V?.bodyMetrics?"Edit This Month's Measurements":"Add This Month's Measurements"}),e.jsx("button",{className:"pb-edit-btn pb-target-btn",onClick:()=>xe(!0),children:Object.keys(q).length>0?"Edit Targets":"Set Targets"}),(Object.keys(F).length>0||Object.keys(q).length>0)&&e.jsx("button",{className:"pb-edit-btn pb-reset-btn",onClick:Ae,disabled:M,children:"Reset All Goals"})]})]}),I&&e.jsxs("div",{className:"pb-edit-card",children:[e.jsxs("div",{className:"pb-edit-header",children:[e.jsxs("h3",{children:["Measurements - ",he(re)]}),e.jsx("button",{className:"pb-edit-close",onClick:()=>{U(!1),le(V?.bodyMetrics||{})},children:"×"})]}),e.jsx("div",{className:"pb-edit-body",children:He.map(t=>e.jsx("div",{className:"pb-edit-metric",children:e.jsxs("div",{className:"pb-edit-field full",children:[e.jsxs("label",{children:[t.name," (",t.suffix,")"]}),e.jsx("input",{type:"number",step:"0.1",value:Q[t.key]??"",onChange:n=>We(t.key,n.target.value),placeholder:"0"})]})},t.key))}),e.jsxs("div",{className:"pb-edit-actions",children:[e.jsx("button",{className:"pb-cancel-btn",onClick:()=>{U(!1),le(V?.bodyMetrics||{})},children:"Cancel"}),e.jsx("button",{className:"pb-save-btn",onClick:cs,disabled:M,children:M?"Saving...":"Save"})]})]}),Qe&&e.jsxs("div",{className:"pb-edit-card",children:[e.jsxs("div",{className:"pb-edit-header",children:[e.jsx("h3",{children:"Body Metric Targets"}),e.jsx("button",{className:"pb-edit-close",onClick:()=>{xe(!1),ee(q)},children:"×"})]}),e.jsxs("div",{className:"pb-edit-body",children:[e.jsx("p",{className:"pb-target-hint",children:"Set targets for your body measurements. Your current measurement is captured automatically."}),He.map(t=>{const n=V?.bodyMetrics?.[t.key];return e.jsxs("div",{className:"pb-edit-exercise",children:[e.jsxs("div",{className:"pb-edit-exercise-header",children:[e.jsx("div",{className:"pb-edit-exercise-name",children:t.name}),e.jsxs("div",{className:"pb-edit-current-best",children:["Current: ",n!=null?`${n} ${t.suffix}`:"-"]})]}),e.jsx("div",{className:"pb-edit-row",children:e.jsxs("div",{className:"pb-edit-field full",children:[e.jsxs("label",{children:["Target (",t.suffix,")"]}),e.jsx("input",{type:"number",step:"0.1",value:$e[t.key]?.targetValue??"",onChange:r=>Ns(t.key,r.target.value),placeholder:"0"})]})})]},t.key)})]}),e.jsxs("div",{className:"pb-edit-actions",children:[e.jsx("button",{className:"pb-cancel-btn",onClick:()=>{xe(!1),ee(q)},children:"Cancel"}),e.jsx("button",{className:"pb-save-btn",onClick:De,disabled:M,children:M?"Saving...":"Save Targets"})]})]})]}),h==="history"&&e.jsx("div",{className:"pb-history-section",children:m.length===0?e.jsxs("div",{className:"pb-empty",children:[e.jsx("h4",{children:"No records yet"}),e.jsx("p",{children:"Start adding your monthly benchmarks and measurements to track your progress over time."})]}):e.jsxs(e.Fragment,{children:[L.length>0&&e.jsxs("div",{className:"pb-achievements-wall",children:[e.jsxs("h4",{className:"pb-achievements-wall-title",children:[e.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"18",height:"18",children:e.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),"Targets Achieved"]}),e.jsx("div",{className:"pb-achievements-list",children:[...L].reverse().map((t,n)=>e.jsxs("div",{className:"pb-achievement-item",style:{animationDelay:`${n*.05}s`},children:[e.jsx("div",{className:"pb-achievement-star",children:e.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),e.jsxs("div",{className:"pb-achievement-info",children:[e.jsx("span",{className:"pb-achievement-label",children:t.label}),e.jsx("span",{className:"pb-achievement-date",children:he(t.achievedMonth)})]})]},n))})]}),e.jsx("div",{className:"pb-history-controls",children:e.jsx("button",{className:`pb-compare-toggle ${ce?"active":""}`,onClick:()=>{vs(!ce),!ce&&m.length>=2&&(es(m[0].month),ss(m[m.length-1].month))},children:ce?"Back to Timeline":"Compare Months"})}),ce?e.jsxs("div",{className:"pb-compare",children:[e.jsxs("div",{className:"pb-compare-selectors",children:[e.jsxs("div",{className:"pb-compare-select",children:[e.jsx("label",{children:"From"}),e.jsx("select",{value:ve,onChange:t=>es(t.target.value),children:m.map(t=>e.jsx("option",{value:t.month,children:he(t.month)},t.month))})]}),e.jsx("div",{className:"pb-compare-vs",children:"vs"}),e.jsxs("div",{className:"pb-compare-select",children:[e.jsx("label",{children:"To"}),e.jsx("select",{value:ke,onChange:t=>ss(t.target.value),children:m.map(t=>e.jsx("option",{value:t.month,children:he(t.month)},t.month))})]})]}),i&&c&&e.jsxs("div",{className:"pb-compare-results",children:[e.jsxs("div",{className:"pb-compare-group",children:[e.jsx("h4",{children:"Strength Benchmarks"}),e.jsxs("div",{className:"pb-compare-table",children:[e.jsxs("div",{className:"pb-compare-header-row",children:[e.jsx("span",{children:"Exercise"}),e.jsx("span",{children:he(ve).split(" ")[0]}),e.jsx("span",{children:he(ke).split(" ")[0]}),e.jsx("span",{children:"Change"})]}),ge.map(t=>{const n=i.benchmarks?.[t.key],r=c.benchmarks?.[t.key],a=_e(t,n),d=_e(t,r),v=Ps(d,a);return e.jsxs("div",{className:"pb-compare-row",children:[e.jsx("span",{className:"pb-compare-name",children:t.name}),e.jsx("span",{className:"pb-compare-val",children:n?t.unit==="time"?js(n.time):`${n.weight}x${n.reps}`:"-"}),e.jsx("span",{className:"pb-compare-val",children:r?t.unit==="time"?js(r.time):`${r.weight}x${r.reps}`:"-"}),e.jsx("span",{className:`pb-compare-change ${v!==null?v>=0?"positive":"negative":""}`,children:v!==null?`${v>=0?"+":""}${v.toFixed(1)}%`:"-"})]},t.key)})]})]}),e.jsxs("div",{className:"pb-compare-group",children:[e.jsx("h4",{children:"Body Measurements"}),e.jsxs("div",{className:"pb-compare-table",children:[e.jsxs("div",{className:"pb-compare-header-row",children:[e.jsx("span",{children:"Measurement"}),e.jsx("span",{children:he(ve).split(" ")[0]}),e.jsx("span",{children:he(ke).split(" ")[0]}),e.jsx("span",{children:"Change"})]}),He.map(t=>{const n=i.bodyMetrics?.[t.key],r=c.bodyMetrics?.[t.key],a=n!=null&&r!=null?parseFloat((r-n).toFixed(2)):null;return e.jsxs("div",{className:"pb-compare-row",children:[e.jsx("span",{className:"pb-compare-name",children:t.name}),e.jsx("span",{className:"pb-compare-val",children:n!=null?`${n}`:"-"}),e.jsx("span",{className:"pb-compare-val",children:r!=null?`${r}`:"-"}),e.jsx("span",{className:`pb-compare-change ${a!==null?a>0?"positive":a<0?"negative":"neutral":""}`,children:a!==null?`${a>0?"+":""}${a} ${t.suffix}`:"-"})]},t.key)})]})]})]})]}):e.jsx("div",{className:"pb-timeline",children:[...m].reverse().map((t,n)=>{const r=m.find(a=>a.month<t.month&&m.indexOf(a)===m.indexOf(t)-1)||m.filter(a=>a.month<t.month).pop();return e.jsxs("div",{className:"pb-timeline-item",style:{animationDelay:`${n*.05}s`},children:[e.jsx("div",{className:"pb-timeline-dot"}),e.jsxs("div",{className:"pb-timeline-card",children:[e.jsx("h4",{children:he(t.month)}),t.benchmarks&&Object.keys(t.benchmarks).length>0&&e.jsxs("div",{className:"pb-timeline-group",children:[e.jsx("h5",{children:"Strength Benchmarks"}),ge.map(a=>{const d=t.benchmarks[a.key];if(!d)return null;const v=r?.benchmarks?.[a.key],k=_e(a,d),b=_e(a,v),N=Ps(k,b);return e.jsxs("div",{className:"pb-timeline-row",children:[e.jsx("span",{className:"pb-timeline-label",children:a.name}),e.jsxs("div",{className:"pb-timeline-values",children:[e.jsx("span",{className:"pb-timeline-value",children:a.unit==="time"?js(d.time):Fs(d.weight,d.reps)}),N!==null&&e.jsxs("span",{className:`pb-timeline-change ${N>=0?"positive":"negative"}`,children:[N>=0?"+":"",N.toFixed(1),"%"]})]})]},a.key)})]}),t.bodyMetrics&&Object.keys(t.bodyMetrics).length>0&&e.jsxs("div",{className:"pb-timeline-group",children:[e.jsx("h5",{children:"Body Measurements"}),He.map(a=>{const d=t.bodyMetrics[a.key];if(d==null)return null;const v=r?.bodyMetrics?.[a.key],k=v!=null?parseFloat((d-v).toFixed(2)):null;return e.jsxs("div",{className:"pb-timeline-row",children:[e.jsx("span",{className:"pb-timeline-label",children:a.name}),e.jsxs("div",{className:"pb-timeline-values",children:[e.jsxs("span",{className:"pb-timeline-value",children:[d," ",a.suffix]}),k!==null&&e.jsxs("span",{className:`pb-timeline-change ${k>0?"positive":k<0?"negative":"neutral"}`,children:[k>0?"+":"",k," ",a.suffix]})]})]},a.key)})]})]})]},t.id)})})]})})]})]}),ye&&e.jsx("div",{className:"pb-celebration-overlay",onClick:()=>Le(null),children:e.jsxs("div",{className:"pb-celebration-card",children:[e.jsx("div",{className:"pb-celebration-icon",children:e.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),e.jsx("h3",{className:"pb-celebration-title",children:ye.length===1?"Target Achieved!":`${ye.length} Targets Achieved!`}),e.jsx("div",{className:"pb-celebration-badges",children:ye.map((t,n)=>e.jsx("div",{className:"pb-celebration-badge",children:t.label},n))}),e.jsx("p",{className:"pb-celebration-sub",children:"Tap to dismiss"})]})}),je&&e.jsxs("div",{className:`toast-notification ${je.type}`,children:[e.jsx("span",{className:"toast-icon",children:je.type==="success"?e.jsx("svg",{className:"success-check-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("path",{className:"check-path",d:"M5 13 L9 17 L19 7"})}):e.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[e.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),e.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})}),e.jsx("span",{className:"toast-message",children:je.message}),e.jsx("button",{className:"toast-close",onClick:()=>Re(null),children:"×"})]}),ne&&e.jsxs("nav",{className:"block-bottom-nav",children:[e.jsxs("button",{className:"block-nav-tab",onClick:()=>Ce("/client"),children:[e.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}),e.jsx("polyline",{points:"9 22 9 12 15 12 15 22"})]}),e.jsx("span",{children:"Home"})]}),e.jsxs("button",{className:"block-nav-tab",onClick:()=>Ce("/client/forms"),children:[e.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),e.jsx("polyline",{points:"14 2 14 8 20 8"}),e.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),e.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"})]}),e.jsx("span",{children:"Forms"})]}),e.jsxs("button",{className:"block-nav-tab",onClick:()=>Ce("/client/tools"),children:[e.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"})}),e.jsx("span",{children:"Tools"})]}),e.jsxs("button",{className:"block-nav-tab active",children:[e.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M12 20V10"}),e.jsx("path",{d:"M18 20V4"}),e.jsx("path",{d:"M6 20v-4"})]}),e.jsx("span",{children:"PBs"})]}),T?.circuitAccess&&e.jsxs("button",{className:"block-nav-tab",onClick:()=>Ce("/client/circuit"),children:[e.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("path",{d:"M12 6v6l4 2"})]}),e.jsx("span",{children:"Circuit"})]})]}),rs&&e.jsx(Us,{active:"progress"})]})})}export{at as default};
