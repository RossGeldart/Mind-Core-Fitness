const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Dashboard-BkwHwkOp.js","assets/scheduleUtils-a2tn0x12.js","assets/Dashboard-BvdLF0uv.css","assets/AddClient-DuqSTIqd.js","assets/AddClient-DH1OFzHo.css","assets/ClientDashboard-CE-glWgz.js","assets/ClientDashboard-BI8UXFpK.css","assets/ClientForms-B4ZE4vmn.js","assets/ClientForms-GDNtnrAx.css","assets/ClientTools-BOytcvR0.js","assets/ClientTools-DQRPoST3.css","assets/MacroCalculator-BBDR7pK7.js","assets/ProteinSnacks-DIFd1OZb.js","assets/DailyMotivation-B3rbXfBR.js","assets/CircuitDashboard-SG6h_NTU.js","assets/CircuitDashboard-C8T0uect.css","assets/CircuitBooking-DsrGTivU.js","assets/CircuitBooking-ruk9Q4Wj.css","assets/PersonalBests-CkcVqzQ_.js","assets/PersonalBests-BkG3fixu.css","assets/Leaderboard-DcsdUS-3.js","assets/Leaderboard-Dq-r5svP.css","assets/UpgradePage-5mXRd2be.js","assets/stripe-Da7IPrZW.js","assets/UpgradePage-Chom0F_j.css","assets/Onboarding-DwVNTHWn.js","assets/Onboarding-C0Tgk2QJ.css"])))=>i.map(i=>d[i]);
(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))i(l);new MutationObserver(l=>{for(const u of l)if(u.type==="childList")for(const h of u.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&i(h)}).observe(document,{childList:!0,subtree:!0});function t(l){const u={};return l.integrity&&(u.integrity=l.integrity),l.referrerPolicy&&(u.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?u.credentials="include":l.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function i(l){if(l.ep)return;l.ep=!0;const u=t(l);fetch(l.href,u)}})();var op={exports:{}},Rc={};var ob;function ak(){if(ob)return Rc;ob=1;var s=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(i,l,u){var h=null;if(u!==void 0&&(h=""+u),l.key!==void 0&&(h=""+l.key),"key"in l){u={};for(var p in l)p!=="key"&&(u[p]=l[p])}else u=l;return l=u.ref,{$$typeof:s,type:i,key:h,ref:l!==void 0?l:null,props:u}}return Rc.Fragment=e,Rc.jsx=t,Rc.jsxs=t,Rc}var lb;function ok(){return lb||(lb=1,op.exports=ak()),op.exports}var o=ok(),lp={exports:{}},Ct={};var cb;function lk(){if(cb)return Ct;cb=1;var s=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),l=Symbol.for("react.profiler"),u=Symbol.for("react.consumer"),h=Symbol.for("react.context"),p=Symbol.for("react.forward_ref"),g=Symbol.for("react.suspense"),y=Symbol.for("react.memo"),b=Symbol.for("react.lazy"),E=Symbol.for("react.activity"),T=Symbol.iterator;function O(L){return L===null||typeof L!="object"?null:(L=T&&L[T]||L["@@iterator"],typeof L=="function"?L:null)}var H={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},q=Object.assign,B={};function te(L,ie,_e){this.props=L,this.context=ie,this.refs=B,this.updater=_e||H}te.prototype.isReactComponent={},te.prototype.setState=function(L,ie){if(typeof L!="object"&&typeof L!="function"&&L!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,L,ie,"setState")},te.prototype.forceUpdate=function(L){this.updater.enqueueForceUpdate(this,L,"forceUpdate")};function W(){}W.prototype=te.prototype;function ee(L,ie,_e){this.props=L,this.context=ie,this.refs=B,this.updater=_e||H}var pe=ee.prototype=new W;pe.constructor=ee,q(pe,te.prototype),pe.isPureReactComponent=!0;var Te=Array.isArray;function ve(){}var A={H:null,A:null,T:null,S:null},S=Object.prototype.hasOwnProperty;function I(L,ie,_e){var ke=_e.ref;return{$$typeof:s,type:L,key:ie,ref:ke!==void 0?ke:null,props:_e}}function V(L,ie){return I(L.type,ie,L.props)}function D(L){return typeof L=="object"&&L!==null&&L.$$typeof===s}function M(L){var ie={"=":"=0",":":"=2"};return"$"+L.replace(/[=:]/g,function(_e){return ie[_e]})}var N=/\/+/g;function Ue(L,ie){return typeof L=="object"&&L!==null&&L.key!=null?M(""+L.key):ie.toString(36)}function Ze(L){switch(L.status){case"fulfilled":return L.value;case"rejected":throw L.reason;default:switch(typeof L.status=="string"?L.then(ve,ve):(L.status="pending",L.then(function(ie){L.status==="pending"&&(L.status="fulfilled",L.value=ie)},function(ie){L.status==="pending"&&(L.status="rejected",L.reason=ie)})),L.status){case"fulfilled":return L.value;case"rejected":throw L.reason}}throw L}function Z(L,ie,_e,ke,Ee){var xe=typeof L;(xe==="undefined"||xe==="boolean")&&(L=null);var Ke=!1;if(L===null)Ke=!0;else switch(xe){case"bigint":case"string":case"number":Ke=!0;break;case"object":switch(L.$$typeof){case s:case e:Ke=!0;break;case b:return Ke=L._init,Z(Ke(L._payload),ie,_e,ke,Ee)}}if(Ke)return Ee=Ee(L),Ke=ke===""?"."+Ue(L,0):ke,Te(Ee)?(_e="",Ke!=null&&(_e=Ke.replace(N,"$&/")+"/"),Z(Ee,ie,_e,"",function(tn){return tn})):Ee!=null&&(D(Ee)&&(Ee=V(Ee,_e+(Ee.key==null||L&&L.key===Ee.key?"":(""+Ee.key).replace(N,"$&/")+"/")+Ke)),ie.push(Ee)),1;Ke=0;var ct=ke===""?".":ke+":";if(Te(L))for(var Pe=0;Pe<L.length;Pe++)ke=L[Pe],xe=ct+Ue(ke,Pe),Ke+=Z(ke,ie,_e,xe,Ee);else if(Pe=O(L),typeof Pe=="function")for(L=Pe.call(L),Pe=0;!(ke=L.next()).done;)ke=ke.value,xe=ct+Ue(ke,Pe++),Ke+=Z(ke,ie,_e,xe,Ee);else if(xe==="object"){if(typeof L.then=="function")return Z(Ze(L),ie,_e,ke,Ee);throw ie=String(L),Error("Objects are not valid as a React child (found: "+(ie==="[object Object]"?"object with keys {"+Object.keys(L).join(", ")+"}":ie)+"). If you meant to render a collection of children, use an array instead.")}return Ke}function we(L,ie,_e){if(L==null)return L;var ke=[],Ee=0;return Z(L,ke,"","",function(xe){return ie.call(_e,xe,Ee++)}),ke}function Ie(L){if(L._status===-1){var ie=L._result;ie=ie(),ie.then(function(_e){(L._status===0||L._status===-1)&&(L._status=1,L._result=_e)},function(_e){(L._status===0||L._status===-1)&&(L._status=2,L._result=_e)}),L._status===-1&&(L._status=0,L._result=ie)}if(L._status===1)return L._result.default;throw L._result}var Be=typeof reportError=="function"?reportError:function(L){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var ie=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof L=="object"&&L!==null&&typeof L.message=="string"?String(L.message):String(L),error:L});if(!window.dispatchEvent(ie))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",L);return}console.error(L)},re={map:we,forEach:function(L,ie,_e){we(L,function(){ie.apply(this,arguments)},_e)},count:function(L){var ie=0;return we(L,function(){ie++}),ie},toArray:function(L){return we(L,function(ie){return ie})||[]},only:function(L){if(!D(L))throw Error("React.Children.only expected to receive a single React element child.");return L}};return Ct.Activity=E,Ct.Children=re,Ct.Component=te,Ct.Fragment=t,Ct.Profiler=l,Ct.PureComponent=ee,Ct.StrictMode=i,Ct.Suspense=g,Ct.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=A,Ct.__COMPILER_RUNTIME={__proto__:null,c:function(L){return A.H.useMemoCache(L)}},Ct.cache=function(L){return function(){return L.apply(null,arguments)}},Ct.cacheSignal=function(){return null},Ct.cloneElement=function(L,ie,_e){if(L==null)throw Error("The argument must be a React element, but you passed "+L+".");var ke=q({},L.props),Ee=L.key;if(ie!=null)for(xe in ie.key!==void 0&&(Ee=""+ie.key),ie)!S.call(ie,xe)||xe==="key"||xe==="__self"||xe==="__source"||xe==="ref"&&ie.ref===void 0||(ke[xe]=ie[xe]);var xe=arguments.length-2;if(xe===1)ke.children=_e;else if(1<xe){for(var Ke=Array(xe),ct=0;ct<xe;ct++)Ke[ct]=arguments[ct+2];ke.children=Ke}return I(L.type,Ee,ke)},Ct.createContext=function(L){return L={$$typeof:h,_currentValue:L,_currentValue2:L,_threadCount:0,Provider:null,Consumer:null},L.Provider=L,L.Consumer={$$typeof:u,_context:L},L},Ct.createElement=function(L,ie,_e){var ke,Ee={},xe=null;if(ie!=null)for(ke in ie.key!==void 0&&(xe=""+ie.key),ie)S.call(ie,ke)&&ke!=="key"&&ke!=="__self"&&ke!=="__source"&&(Ee[ke]=ie[ke]);var Ke=arguments.length-2;if(Ke===1)Ee.children=_e;else if(1<Ke){for(var ct=Array(Ke),Pe=0;Pe<Ke;Pe++)ct[Pe]=arguments[Pe+2];Ee.children=ct}if(L&&L.defaultProps)for(ke in Ke=L.defaultProps,Ke)Ee[ke]===void 0&&(Ee[ke]=Ke[ke]);return I(L,xe,Ee)},Ct.createRef=function(){return{current:null}},Ct.forwardRef=function(L){return{$$typeof:p,render:L}},Ct.isValidElement=D,Ct.lazy=function(L){return{$$typeof:b,_payload:{_status:-1,_result:L},_init:Ie}},Ct.memo=function(L,ie){return{$$typeof:y,type:L,compare:ie===void 0?null:ie}},Ct.startTransition=function(L){var ie=A.T,_e={};A.T=_e;try{var ke=L(),Ee=A.S;Ee!==null&&Ee(_e,ke),typeof ke=="object"&&ke!==null&&typeof ke.then=="function"&&ke.then(ve,Be)}catch(xe){Be(xe)}finally{ie!==null&&_e.types!==null&&(ie.types=_e.types),A.T=ie}},Ct.unstable_useCacheRefresh=function(){return A.H.useCacheRefresh()},Ct.use=function(L){return A.H.use(L)},Ct.useActionState=function(L,ie,_e){return A.H.useActionState(L,ie,_e)},Ct.useCallback=function(L,ie){return A.H.useCallback(L,ie)},Ct.useContext=function(L){return A.H.useContext(L)},Ct.useDebugValue=function(){},Ct.useDeferredValue=function(L,ie){return A.H.useDeferredValue(L,ie)},Ct.useEffect=function(L,ie){return A.H.useEffect(L,ie)},Ct.useEffectEvent=function(L){return A.H.useEffectEvent(L)},Ct.useId=function(){return A.H.useId()},Ct.useImperativeHandle=function(L,ie,_e){return A.H.useImperativeHandle(L,ie,_e)},Ct.useInsertionEffect=function(L,ie){return A.H.useInsertionEffect(L,ie)},Ct.useLayoutEffect=function(L,ie){return A.H.useLayoutEffect(L,ie)},Ct.useMemo=function(L,ie){return A.H.useMemo(L,ie)},Ct.useOptimistic=function(L,ie){return A.H.useOptimistic(L,ie)},Ct.useReducer=function(L,ie,_e){return A.H.useReducer(L,ie,_e)},Ct.useRef=function(L){return A.H.useRef(L)},Ct.useState=function(L){return A.H.useState(L)},Ct.useSyncExternalStore=function(L,ie,_e){return A.H.useSyncExternalStore(L,ie,_e)},Ct.useTransition=function(){return A.H.useTransition()},Ct.version="19.2.4",Ct}var ub;function xg(){return ub||(ub=1,lp.exports=lk()),lp.exports}var w=xg(),cp={exports:{}},Ic={},up={exports:{}},hp={};var hb;function ck(){return hb||(hb=1,(function(s){function e(Z,we){var Ie=Z.length;Z.push(we);e:for(;0<Ie;){var Be=Ie-1>>>1,re=Z[Be];if(0<l(re,we))Z[Be]=we,Z[Ie]=re,Ie=Be;else break e}}function t(Z){return Z.length===0?null:Z[0]}function i(Z){if(Z.length===0)return null;var we=Z[0],Ie=Z.pop();if(Ie!==we){Z[0]=Ie;e:for(var Be=0,re=Z.length,L=re>>>1;Be<L;){var ie=2*(Be+1)-1,_e=Z[ie],ke=ie+1,Ee=Z[ke];if(0>l(_e,Ie))ke<re&&0>l(Ee,_e)?(Z[Be]=Ee,Z[ke]=Ie,Be=ke):(Z[Be]=_e,Z[ie]=Ie,Be=ie);else if(ke<re&&0>l(Ee,Ie))Z[Be]=Ee,Z[ke]=Ie,Be=ke;else break e}}return we}function l(Z,we){var Ie=Z.sortIndex-we.sortIndex;return Ie!==0?Ie:Z.id-we.id}if(s.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var u=performance;s.unstable_now=function(){return u.now()}}else{var h=Date,p=h.now();s.unstable_now=function(){return h.now()-p}}var g=[],y=[],b=1,E=null,T=3,O=!1,H=!1,q=!1,B=!1,te=typeof setTimeout=="function"?setTimeout:null,W=typeof clearTimeout=="function"?clearTimeout:null,ee=typeof setImmediate<"u"?setImmediate:null;function pe(Z){for(var we=t(y);we!==null;){if(we.callback===null)i(y);else if(we.startTime<=Z)i(y),we.sortIndex=we.expirationTime,e(g,we);else break;we=t(y)}}function Te(Z){if(q=!1,pe(Z),!H)if(t(g)!==null)H=!0,ve||(ve=!0,M());else{var we=t(y);we!==null&&Ze(Te,we.startTime-Z)}}var ve=!1,A=-1,S=5,I=-1;function V(){return B?!0:!(s.unstable_now()-I<S)}function D(){if(B=!1,ve){var Z=s.unstable_now();I=Z;var we=!0;try{e:{H=!1,q&&(q=!1,W(A),A=-1),O=!0;var Ie=T;try{t:{for(pe(Z),E=t(g);E!==null&&!(E.expirationTime>Z&&V());){var Be=E.callback;if(typeof Be=="function"){E.callback=null,T=E.priorityLevel;var re=Be(E.expirationTime<=Z);if(Z=s.unstable_now(),typeof re=="function"){E.callback=re,pe(Z),we=!0;break t}E===t(g)&&i(g),pe(Z)}else i(g);E=t(g)}if(E!==null)we=!0;else{var L=t(y);L!==null&&Ze(Te,L.startTime-Z),we=!1}}break e}finally{E=null,T=Ie,O=!1}we=void 0}}finally{we?M():ve=!1}}}var M;if(typeof ee=="function")M=function(){ee(D)};else if(typeof MessageChannel<"u"){var N=new MessageChannel,Ue=N.port2;N.port1.onmessage=D,M=function(){Ue.postMessage(null)}}else M=function(){te(D,0)};function Ze(Z,we){A=te(function(){Z(s.unstable_now())},we)}s.unstable_IdlePriority=5,s.unstable_ImmediatePriority=1,s.unstable_LowPriority=4,s.unstable_NormalPriority=3,s.unstable_Profiling=null,s.unstable_UserBlockingPriority=2,s.unstable_cancelCallback=function(Z){Z.callback=null},s.unstable_forceFrameRate=function(Z){0>Z||125<Z?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):S=0<Z?Math.floor(1e3/Z):5},s.unstable_getCurrentPriorityLevel=function(){return T},s.unstable_next=function(Z){switch(T){case 1:case 2:case 3:var we=3;break;default:we=T}var Ie=T;T=we;try{return Z()}finally{T=Ie}},s.unstable_requestPaint=function(){B=!0},s.unstable_runWithPriority=function(Z,we){switch(Z){case 1:case 2:case 3:case 4:case 5:break;default:Z=3}var Ie=T;T=Z;try{return we()}finally{T=Ie}},s.unstable_scheduleCallback=function(Z,we,Ie){var Be=s.unstable_now();switch(typeof Ie=="object"&&Ie!==null?(Ie=Ie.delay,Ie=typeof Ie=="number"&&0<Ie?Be+Ie:Be):Ie=Be,Z){case 1:var re=-1;break;case 2:re=250;break;case 5:re=1073741823;break;case 4:re=1e4;break;default:re=5e3}return re=Ie+re,Z={id:b++,callback:we,priorityLevel:Z,startTime:Ie,expirationTime:re,sortIndex:-1},Ie>Be?(Z.sortIndex=Ie,e(y,Z),t(g)===null&&Z===t(y)&&(q?(W(A),A=-1):q=!0,Ze(Te,Ie-Be))):(Z.sortIndex=re,e(g,Z),H||O||(H=!0,ve||(ve=!0,M()))),Z},s.unstable_shouldYield=V,s.unstable_wrapCallback=function(Z){var we=T;return function(){var Ie=T;T=we;try{return Z.apply(this,arguments)}finally{T=Ie}}}})(hp)),hp}var db;function uk(){return db||(db=1,up.exports=ck()),up.exports}var dp={exports:{}},Fs={};var fb;function hk(){if(fb)return Fs;fb=1;var s=xg();function e(g){var y="https://react.dev/errors/"+g;if(1<arguments.length){y+="?args[]="+encodeURIComponent(arguments[1]);for(var b=2;b<arguments.length;b++)y+="&args[]="+encodeURIComponent(arguments[b])}return"Minified React error #"+g+"; visit "+y+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var i={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},l=Symbol.for("react.portal");function u(g,y,b){var E=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:l,key:E==null?null:""+E,children:g,containerInfo:y,implementation:b}}var h=s.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function p(g,y){if(g==="font")return"";if(typeof y=="string")return y==="use-credentials"?y:""}return Fs.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,Fs.createPortal=function(g,y){var b=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!y||y.nodeType!==1&&y.nodeType!==9&&y.nodeType!==11)throw Error(e(299));return u(g,y,null,b)},Fs.flushSync=function(g){var y=h.T,b=i.p;try{if(h.T=null,i.p=2,g)return g()}finally{h.T=y,i.p=b,i.d.f()}},Fs.preconnect=function(g,y){typeof g=="string"&&(y?(y=y.crossOrigin,y=typeof y=="string"?y==="use-credentials"?y:"":void 0):y=null,i.d.C(g,y))},Fs.prefetchDNS=function(g){typeof g=="string"&&i.d.D(g)},Fs.preinit=function(g,y){if(typeof g=="string"&&y&&typeof y.as=="string"){var b=y.as,E=p(b,y.crossOrigin),T=typeof y.integrity=="string"?y.integrity:void 0,O=typeof y.fetchPriority=="string"?y.fetchPriority:void 0;b==="style"?i.d.S(g,typeof y.precedence=="string"?y.precedence:void 0,{crossOrigin:E,integrity:T,fetchPriority:O}):b==="script"&&i.d.X(g,{crossOrigin:E,integrity:T,fetchPriority:O,nonce:typeof y.nonce=="string"?y.nonce:void 0})}},Fs.preinitModule=function(g,y){if(typeof g=="string")if(typeof y=="object"&&y!==null){if(y.as==null||y.as==="script"){var b=p(y.as,y.crossOrigin);i.d.M(g,{crossOrigin:b,integrity:typeof y.integrity=="string"?y.integrity:void 0,nonce:typeof y.nonce=="string"?y.nonce:void 0})}}else y==null&&i.d.M(g)},Fs.preload=function(g,y){if(typeof g=="string"&&typeof y=="object"&&y!==null&&typeof y.as=="string"){var b=y.as,E=p(b,y.crossOrigin);i.d.L(g,b,{crossOrigin:E,integrity:typeof y.integrity=="string"?y.integrity:void 0,nonce:typeof y.nonce=="string"?y.nonce:void 0,type:typeof y.type=="string"?y.type:void 0,fetchPriority:typeof y.fetchPriority=="string"?y.fetchPriority:void 0,referrerPolicy:typeof y.referrerPolicy=="string"?y.referrerPolicy:void 0,imageSrcSet:typeof y.imageSrcSet=="string"?y.imageSrcSet:void 0,imageSizes:typeof y.imageSizes=="string"?y.imageSizes:void 0,media:typeof y.media=="string"?y.media:void 0})}},Fs.preloadModule=function(g,y){if(typeof g=="string")if(y){var b=p(y.as,y.crossOrigin);i.d.m(g,{as:typeof y.as=="string"&&y.as!=="script"?y.as:void 0,crossOrigin:b,integrity:typeof y.integrity=="string"?y.integrity:void 0})}else i.d.m(g)},Fs.requestFormReset=function(g){i.d.r(g)},Fs.unstable_batchedUpdates=function(g,y){return g(y)},Fs.useFormState=function(g,y,b){return h.H.useFormState(g,y,b)},Fs.useFormStatus=function(){return h.H.useHostTransitionStatus()},Fs.version="19.2.4",Fs}var mb;function dk(){if(mb)return dp.exports;mb=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(e){console.error(e)}}return s(),dp.exports=hk(),dp.exports}var pb;function fk(){if(pb)return Ic;pb=1;var s=uk(),e=xg(),t=dk();function i(n){var r="https://react.dev/errors/"+n;if(1<arguments.length){r+="?args[]="+encodeURIComponent(arguments[1]);for(var a=2;a<arguments.length;a++)r+="&args[]="+encodeURIComponent(arguments[a])}return"Minified React error #"+n+"; visit "+r+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function l(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function u(n){var r=n,a=n;if(n.alternate)for(;r.return;)r=r.return;else{n=r;do r=n,(r.flags&4098)!==0&&(a=r.return),n=r.return;while(n)}return r.tag===3?a:null}function h(n){if(n.tag===13){var r=n.memoizedState;if(r===null&&(n=n.alternate,n!==null&&(r=n.memoizedState)),r!==null)return r.dehydrated}return null}function p(n){if(n.tag===31){var r=n.memoizedState;if(r===null&&(n=n.alternate,n!==null&&(r=n.memoizedState)),r!==null)return r.dehydrated}return null}function g(n){if(u(n)!==n)throw Error(i(188))}function y(n){var r=n.alternate;if(!r){if(r=u(n),r===null)throw Error(i(188));return r!==n?null:n}for(var a=n,c=r;;){var f=a.return;if(f===null)break;var m=f.alternate;if(m===null){if(c=f.return,c!==null){a=c;continue}break}if(f.child===m.child){for(m=f.child;m;){if(m===a)return g(f),n;if(m===c)return g(f),r;m=m.sibling}throw Error(i(188))}if(a.return!==c.return)a=f,c=m;else{for(var _=!1,k=f.child;k;){if(k===a){_=!0,a=f,c=m;break}if(k===c){_=!0,c=f,a=m;break}k=k.sibling}if(!_){for(k=m.child;k;){if(k===a){_=!0,a=m,c=f;break}if(k===c){_=!0,c=m,a=f;break}k=k.sibling}if(!_)throw Error(i(189))}}if(a.alternate!==c)throw Error(i(190))}if(a.tag!==3)throw Error(i(188));return a.stateNode.current===a?n:r}function b(n){var r=n.tag;if(r===5||r===26||r===27||r===6)return n;for(n=n.child;n!==null;){if(r=b(n),r!==null)return r;n=n.sibling}return null}var E=Object.assign,T=Symbol.for("react.element"),O=Symbol.for("react.transitional.element"),H=Symbol.for("react.portal"),q=Symbol.for("react.fragment"),B=Symbol.for("react.strict_mode"),te=Symbol.for("react.profiler"),W=Symbol.for("react.consumer"),ee=Symbol.for("react.context"),pe=Symbol.for("react.forward_ref"),Te=Symbol.for("react.suspense"),ve=Symbol.for("react.suspense_list"),A=Symbol.for("react.memo"),S=Symbol.for("react.lazy"),I=Symbol.for("react.activity"),V=Symbol.for("react.memo_cache_sentinel"),D=Symbol.iterator;function M(n){return n===null||typeof n!="object"?null:(n=D&&n[D]||n["@@iterator"],typeof n=="function"?n:null)}var N=Symbol.for("react.client.reference");function Ue(n){if(n==null)return null;if(typeof n=="function")return n.$$typeof===N?null:n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case q:return"Fragment";case te:return"Profiler";case B:return"StrictMode";case Te:return"Suspense";case ve:return"SuspenseList";case I:return"Activity"}if(typeof n=="object")switch(n.$$typeof){case H:return"Portal";case ee:return n.displayName||"Context";case W:return(n._context.displayName||"Context")+".Consumer";case pe:var r=n.render;return n=n.displayName,n||(n=r.displayName||r.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case A:return r=n.displayName||null,r!==null?r:Ue(n.type)||"Memo";case S:r=n._payload,n=n._init;try{return Ue(n(r))}catch{}}return null}var Ze=Array.isArray,Z=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,we=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Ie={pending:!1,data:null,method:null,action:null},Be=[],re=-1;function L(n){return{current:n}}function ie(n){0>re||(n.current=Be[re],Be[re]=null,re--)}function _e(n,r){re++,Be[re]=n.current,n.current=r}var ke=L(null),Ee=L(null),xe=L(null),Ke=L(null);function ct(n,r){switch(_e(xe,r),_e(Ee,n),_e(ke,null),r.nodeType){case 9:case 11:n=(n=r.documentElement)&&(n=n.namespaceURI)?A1(n):0;break;default:if(n=r.tagName,r=r.namespaceURI)r=A1(r),n=R1(r,n);else switch(n){case"svg":n=1;break;case"math":n=2;break;default:n=0}}ie(ke),_e(ke,n)}function Pe(){ie(ke),ie(Ee),ie(xe)}function tn(n){n.memoizedState!==null&&_e(Ke,n);var r=ke.current,a=R1(r,n.type);r!==a&&(_e(Ee,n),_e(ke,a))}function jn(n){Ee.current===n&&(ie(ke),ie(Ee)),Ke.current===n&&(ie(Ke),jc._currentValue=Ie)}var Un,Lt;function rt(n){if(Un===void 0)try{throw Error()}catch(a){var r=a.stack.trim().match(/\n( *(at )?)/);Un=r&&r[1]||"",Lt=-1<a.stack.indexOf(`
    at`)?" (<anonymous>)":-1<a.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Un+n+Lt}var gt=!1;function ut(n,r){if(!n||gt)return"";gt=!0;var a=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var c={DetermineComponentFrameRoot:function(){try{if(r){var ge=function(){throw Error()};if(Object.defineProperty(ge.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ge,[])}catch(he){var se=he}Reflect.construct(n,[],ge)}else{try{ge.call()}catch(he){se=he}n.call(ge.prototype)}}else{try{throw Error()}catch(he){se=he}(ge=n())&&typeof ge.catch=="function"&&ge.catch(function(){})}}catch(he){if(he&&se&&typeof he.stack=="string")return[he.stack,se.stack]}return[null,null]}};c.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var f=Object.getOwnPropertyDescriptor(c.DetermineComponentFrameRoot,"name");f&&f.configurable&&Object.defineProperty(c.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var m=c.DetermineComponentFrameRoot(),_=m[0],k=m[1];if(_&&k){var U=_.split(`
`),J=k.split(`
`);for(f=c=0;c<U.length&&!U[c].includes("DetermineComponentFrameRoot");)c++;for(;f<J.length&&!J[f].includes("DetermineComponentFrameRoot");)f++;if(c===U.length||f===J.length)for(c=U.length-1,f=J.length-1;1<=c&&0<=f&&U[c]!==J[f];)f--;for(;1<=c&&0<=f;c--,f--)if(U[c]!==J[f]){if(c!==1||f!==1)do if(c--,f--,0>f||U[c]!==J[f]){var de=`
`+U[c].replace(" at new "," at ");return n.displayName&&de.includes("<anonymous>")&&(de=de.replace("<anonymous>",n.displayName)),de}while(1<=c&&0<=f);break}}}finally{gt=!1,Error.prepareStackTrace=a}return(a=n?n.displayName||n.name:"")?rt(a):""}function Bn(n,r){switch(n.tag){case 26:case 27:case 5:return rt(n.type);case 16:return rt("Lazy");case 13:return n.child!==r&&r!==null?rt("Suspense Fallback"):rt("Suspense");case 19:return rt("SuspenseList");case 0:case 15:return ut(n.type,!1);case 11:return ut(n.type.render,!1);case 1:return ut(n.type,!0);case 31:return rt("Activity");default:return""}}function ue(n){try{var r="",a=null;do r+=Bn(n,a),a=n,n=n.return;while(n);return r}catch(c){return`
Error generating stack: `+c.message+`
`+c.stack}}var Rt=Object.prototype.hasOwnProperty,yt=s.unstable_scheduleCallback,Vt=s.unstable_cancelCallback,Je=s.unstable_shouldYield,At=s.unstable_requestPaint,vt=s.unstable_now,nn=s.unstable_getCurrentPriorityLevel,js=s.unstable_ImmediatePriority,rs=s.unstable_UserBlockingPriority,Xt=s.unstable_NormalPriority,ne=s.unstable_LowPriority,Ne=s.unstable_IdlePriority,xt=s.log,bt=s.unstable_setDisableYieldValue,it=null,$e=null;function st(n){if(typeof xt=="function"&&bt(n),$e&&typeof $e.setStrictMode=="function")try{$e.setStrictMode(it,n)}catch{}}var Fe=Math.clz32?Math.clz32:Mn,sn=Math.log,on=Math.LN2;function Mn(n){return n>>>=0,n===0?32:31-(sn(n)/on|0)|0}var zn=256,Xn=262144,Yt=4194304;function Fn(n){var r=n&42;if(r!==0)return r;switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return n&261888;case 262144:case 524288:case 1048576:case 2097152:return n&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return n&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return n}}function Cn(n,r,a){var c=n.pendingLanes;if(c===0)return 0;var f=0,m=n.suspendedLanes,_=n.pingedLanes;n=n.warmLanes;var k=c&134217727;return k!==0?(c=k&~m,c!==0?f=Fn(c):(_&=k,_!==0?f=Fn(_):a||(a=k&~n,a!==0&&(f=Fn(a))))):(k=c&~m,k!==0?f=Fn(k):_!==0?f=Fn(_):a||(a=c&~n,a!==0&&(f=Fn(a)))),f===0?0:r!==0&&r!==f&&(r&m)===0&&(m=f&-f,a=r&-r,m>=a||m===32&&(a&4194048)!==0)?r:f}function ln(n,r){return(n.pendingLanes&~(n.suspendedLanes&~n.pingedLanes)&r)===0}function fr(n,r){switch(n){case 1:case 2:case 4:case 8:case 64:return r+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function oe(){var n=Yt;return Yt<<=1,(Yt&62914560)===0&&(Yt=4194304),n}function Ae(n){for(var r=[],a=0;31>a;a++)r.push(n);return r}function Ge(n,r){n.pendingLanes|=r,r!==268435456&&(n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0)}function mt(n,r,a,c,f,m){var _=n.pendingLanes;n.pendingLanes=a,n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0,n.expiredLanes&=a,n.entangledLanes&=a,n.errorRecoveryDisabledLanes&=a,n.shellSuspendCounter=0;var k=n.entanglements,U=n.expirationTimes,J=n.hiddenUpdates;for(a=_&~a;0<a;){var de=31-Fe(a),ge=1<<de;k[de]=0,U[de]=-1;var se=J[de];if(se!==null)for(J[de]=null,de=0;de<se.length;de++){var he=se[de];he!==null&&(he.lane&=-536870913)}a&=~ge}c!==0&&lt(n,c,0),m!==0&&f===0&&n.tag!==0&&(n.suspendedLanes|=m&~(_&~r))}function lt(n,r,a){n.pendingLanes|=r,n.suspendedLanes&=~r;var c=31-Fe(r);n.entangledLanes|=r,n.entanglements[c]=n.entanglements[c]|1073741824|a&261930}function yn(n,r){var a=n.entangledLanes|=r;for(n=n.entanglements;a;){var c=31-Fe(a),f=1<<c;f&r|n[c]&r&&(n[c]|=r),a&=~f}}function Nn(n,r){var a=r&-r;return a=(a&42)!==0?1:dn(a),(a&(n.suspendedLanes|r))!==0?0:a}function dn(n){switch(n){case 2:n=1;break;case 8:n=4;break;case 32:n=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:n=128;break;case 268435456:n=134217728;break;default:n=0}return n}function vn(n){return n&=-n,2<n?8<n?(n&134217727)!==0?32:268435456:8:2}function Cs(){var n=we.p;return n!==0?n:(n=window.event,n===void 0?32:eb(n.type))}function is(n,r){var a=we.p;try{return we.p=n,r()}finally{we.p=a}}var ds=Math.random().toString(36).slice(2),Jt="__reactFiber$"+ds,An="__reactProps$"+ds,Ns="__reactContainer$"+ds,jr="__reactEvents$"+ds,ai="__reactListeners$"+ds,Cr="__reactHandles$"+ds,Nr="__reactResources$"+ds,qn="__reactMarker$"+ds;function Ks(n){delete n[Jt],delete n[An],delete n[jr],delete n[ai],delete n[Cr]}function ws(n){var r=n[Jt];if(r)return r;for(var a=n.parentNode;a;){if(r=a[Ns]||a[Jt]){if(a=r.alternate,r.child!==null||a!==null&&a.child!==null)for(n=V1(n);n!==null;){if(a=n[Jt])return a;n=V1(n)}return r}n=a,a=n.parentNode}return null}function kn(n){if(n=n[Jt]||n[Ns]){var r=n.tag;if(r===5||r===6||r===13||r===31||r===26||r===27||r===3)return n}return null}function Ln(n){var r=n.tag;if(r===5||r===26||r===27||r===6)return n.stateNode;throw Error(i(33))}function as(n){var r=n[Nr];return r||(r=n[Nr]={hoistableStyles:new Map,hoistableScripts:new Map}),r}function zt(n){n[qn]=!0}var Gr=new Set,Ar={};function xs(n,r){bn(n,r),bn(n+"Capture",r)}function bn(n,r){for(Ar[n]=r,n=0;n<r.length;n++)Gr.add(r[n])}var nr=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),oi={},R={};function z(n){return Rt.call(R,n)?!0:Rt.call(oi,n)?!1:nr.test(n)?R[n]=!0:(oi[n]=!0,!1)}function ae(n,r,a){if(z(r))if(a===null)n.removeAttribute(r);else{switch(typeof a){case"undefined":case"function":case"symbol":n.removeAttribute(r);return;case"boolean":var c=r.toLowerCase().slice(0,5);if(c!=="data-"&&c!=="aria-"){n.removeAttribute(r);return}}n.setAttribute(r,""+a)}}function le(n,r,a){if(a===null)n.removeAttribute(r);else{switch(typeof a){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(r);return}n.setAttribute(r,""+a)}}function Me(n,r,a,c){if(c===null)n.removeAttribute(a);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(a);return}n.setAttributeNS(r,a,""+c)}}function Le(n){switch(typeof n){case"bigint":case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function He(n){var r=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(r==="checkbox"||r==="radio")}function Ft(n,r,a){var c=Object.getOwnPropertyDescriptor(n.constructor.prototype,r);if(!n.hasOwnProperty(r)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var f=c.get,m=c.set;return Object.defineProperty(n,r,{configurable:!0,get:function(){return f.call(this)},set:function(_){a=""+_,m.call(this,_)}}),Object.defineProperty(n,r,{enumerable:c.enumerable}),{getValue:function(){return a},setValue:function(_){a=""+_},stopTracking:function(){n._valueTracker=null,delete n[r]}}}}function Ye(n){if(!n._valueTracker){var r=He(n)?"checked":"value";n._valueTracker=Ft(n,r,""+n[r])}}function Kn(n){if(!n)return!1;var r=n._valueTracker;if(!r)return!0;var a=r.getValue(),c="";return n&&(c=He(n)?n.checked?"true":"false":n.value),n=c,n!==a?(r.setValue(n),!0):!1}function os(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}var Vs=/[\n"\\]/g;function Yn(n){return n.replace(Vs,function(r){return"\\"+r.charCodeAt(0).toString(16)+" "})}function mr(n,r,a,c,f,m,_,k){n.name="",_!=null&&typeof _!="function"&&typeof _!="symbol"&&typeof _!="boolean"?n.type=_:n.removeAttribute("type"),r!=null?_==="number"?(r===0&&n.value===""||n.value!=r)&&(n.value=""+Le(r)):n.value!==""+Le(r)&&(n.value=""+Le(r)):_!=="submit"&&_!=="reset"||n.removeAttribute("value"),r!=null?Ni(n,_,Le(r)):a!=null?Ni(n,_,Le(a)):c!=null&&n.removeAttribute("value"),f==null&&m!=null&&(n.defaultChecked=!!m),f!=null&&(n.checked=f&&typeof f!="function"&&typeof f!="symbol"),k!=null&&typeof k!="function"&&typeof k!="symbol"&&typeof k!="boolean"?n.name=""+Le(k):n.removeAttribute("name")}function oa(n,r,a,c,f,m,_,k){if(m!=null&&typeof m!="function"&&typeof m!="symbol"&&typeof m!="boolean"&&(n.type=m),r!=null||a!=null){if(!(m!=="submit"&&m!=="reset"||r!=null)){Ye(n);return}a=a!=null?""+Le(a):"",r=r!=null?""+Le(r):a,k||r===n.value||(n.value=r),n.defaultValue=r}c=c??f,c=typeof c!="function"&&typeof c!="symbol"&&!!c,n.checked=k?n.checked:!!c,n.defaultChecked=!!c,_!=null&&typeof _!="function"&&typeof _!="symbol"&&typeof _!="boolean"&&(n.name=_),Ye(n)}function Ni(n,r,a){r==="number"&&os(n.ownerDocument)===n||n.defaultValue===""+a||(n.defaultValue=""+a)}function Rr(n,r,a,c){if(n=n.options,r){r={};for(var f=0;f<a.length;f++)r["$"+a[f]]=!0;for(a=0;a<n.length;a++)f=r.hasOwnProperty("$"+n[a].value),n[a].selected!==f&&(n[a].selected=f),f&&c&&(n[a].defaultSelected=!0)}else{for(a=""+Le(a),r=null,f=0;f<n.length;f++){if(n[f].value===a){n[f].selected=!0,c&&(n[f].defaultSelected=!0);return}r!==null||n[f].disabled||(r=n[f])}r!==null&&(r.selected=!0)}}function la(n,r,a){if(r!=null&&(r=""+Le(r),r!==n.value&&(n.value=r),a==null)){n.defaultValue!==r&&(n.defaultValue=r);return}n.defaultValue=a!=null?""+Le(a):""}function Ir(n,r,a,c){if(r==null){if(c!=null){if(a!=null)throw Error(i(92));if(Ze(c)){if(1<c.length)throw Error(i(93));c=c[0]}a=c}a==null&&(a=""),r=a}a=Le(r),n.defaultValue=a,c=n.textContent,c===a&&c!==""&&c!==null&&(n.value=c),Ye(n)}function j(n,r){if(r){var a=n.firstChild;if(a&&a===n.lastChild&&a.nodeType===3){a.nodeValue=r;return}}n.textContent=r}var G=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Ce(n,r,a){var c=r.indexOf("--")===0;a==null||typeof a=="boolean"||a===""?c?n.setProperty(r,""):r==="float"?n.cssFloat="":n[r]="":c?n.setProperty(r,a):typeof a!="number"||a===0||G.has(r)?r==="float"?n.cssFloat=a:n[r]=(""+a).trim():n[r]=a+"px"}function Re(n,r,a){if(r!=null&&typeof r!="object")throw Error(i(62));if(n=n.style,a!=null){for(var c in a)!a.hasOwnProperty(c)||r!=null&&r.hasOwnProperty(c)||(c.indexOf("--")===0?n.setProperty(c,""):c==="float"?n.cssFloat="":n[c]="");for(var f in r)c=r[f],r.hasOwnProperty(f)&&a[f]!==c&&Ce(n,f,c)}else for(var m in r)r.hasOwnProperty(m)&&Ce(n,m,r[m])}function ze(n){if(n.indexOf("-")===-1)return!1;switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ht=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),et=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function kt(n){return et.test(""+n)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":n}function dt(){}var P=null;function Y(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var X=null,ye=null;function je(n){var r=kn(n);if(r&&(n=r.stateNode)){var a=n[An]||null;e:switch(n=r.stateNode,r.type){case"input":if(mr(n,a.value,a.defaultValue,a.defaultValue,a.checked,a.defaultChecked,a.type,a.name),r=a.name,a.type==="radio"&&r!=null){for(a=n;a.parentNode;)a=a.parentNode;for(a=a.querySelectorAll('input[name="'+Yn(""+r)+'"][type="radio"]'),r=0;r<a.length;r++){var c=a[r];if(c!==n&&c.form===n.form){var f=c[An]||null;if(!f)throw Error(i(90));mr(c,f.value,f.defaultValue,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name)}}for(r=0;r<a.length;r++)c=a[r],c.form===n.form&&Kn(c)}break e;case"textarea":la(n,a.value,a.defaultValue);break e;case"select":r=a.value,r!=null&&Rr(n,!!a.multiple,r,!1)}}}var Oe=!1;function qe(n,r,a){if(Oe)return n(r,a);Oe=!0;try{var c=n(r);return c}finally{if(Oe=!1,(X!==null||ye!==null)&&(kh(),X&&(r=X,n=ye,ye=X=null,je(r),n)))for(r=0;r<n.length;r++)je(n[r])}}function pt(n,r){var a=n.stateNode;if(a===null)return null;var c=a[An]||null;if(c===null)return null;a=c[r];e:switch(r){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(c=!c.disabled)||(n=n.type,c=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!c;break e;default:n=!1}if(n)return null;if(a&&typeof a!="function")throw Error(i(231,r,typeof a));return a}var Et=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Pt=!1;if(Et)try{var Qe={};Object.defineProperty(Qe,"passive",{get:function(){Pt=!0}}),window.addEventListener("test",Qe,Qe),window.removeEventListener("test",Qe,Qe)}catch{Pt=!1}var Zt=null,Us=null,Tt=null;function Hn(){if(Tt)return Tt;var n,r=Us,a=r.length,c,f="value"in Zt?Zt.value:Zt.textContent,m=f.length;for(n=0;n<a&&r[n]===f[n];n++);var _=a-n;for(c=1;c<=_&&r[a-c]===f[m-c];c++);return Tt=f.slice(n,1<c?1-c:void 0)}function Jn(n){var r=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&r===13&&(n=13)):n=r,n===10&&(n=13),32<=n||n===13?n:0}function St(){return!0}function cn(){return!1}function Rn(n){function r(a,c,f,m,_){this._reactName=a,this._targetInst=f,this.type=c,this.nativeEvent=m,this.target=_,this.currentTarget=null;for(var k in n)n.hasOwnProperty(k)&&(a=n[k],this[k]=a?a(m):m[k]);return this.isDefaultPrevented=(m.defaultPrevented!=null?m.defaultPrevented:m.returnValue===!1)?St:cn,this.isPropagationStopped=cn,this}return E(r.prototype,{preventDefault:function(){this.defaultPrevented=!0;var a=this.nativeEvent;a&&(a.preventDefault?a.preventDefault():typeof a.returnValue!="unknown"&&(a.returnValue=!1),this.isDefaultPrevented=St)},stopPropagation:function(){var a=this.nativeEvent;a&&(a.stopPropagation?a.stopPropagation():typeof a.cancelBubble!="unknown"&&(a.cancelBubble=!0),this.isPropagationStopped=St)},persist:function(){},isPersistent:St}),r}var Bs={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},zs=Rn(Bs),fs=E({},Bs,{view:0,detail:0}),Ys=Rn(fs),sr,Ai,Dr,li=E({},fs,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ca,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==Dr&&(Dr&&n.type==="mousemove"?(sr=n.screenX-Dr.screenX,Ai=n.screenY-Dr.screenY):Ai=sr=0,Dr=n),sr)},movementY:function(n){return"movementY"in n?n.movementY:Ai}}),Gl=Rn(li),no=E({},li,{dataTransfer:0}),Du=Rn(no),Mu=E({},fs,{relatedTarget:0}),so=Rn(Mu),Kl=E({},Bs,{animationName:0,elapsedTime:0,pseudoElement:0}),Lu=Rn(Kl),qo=E({},Bs,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),Ou=Rn(qo),Pu=E({},Bs,{data:0}),ci=Rn(Pu),Vu={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Uu={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Bu={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function zu(n){var r=this.nativeEvent;return r.getModifierState?r.getModifierState(n):(n=Bu[n])?!!r[n]:!1}function ca(){return zu}var Qs=E({},fs,{key:function(n){if(n.key){var r=Vu[n.key]||n.key;if(r!=="Unidentified")return r}return n.type==="keypress"?(n=Jn(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?Uu[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ca,charCode:function(n){return n.type==="keypress"?Jn(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?Jn(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),Fu=Rn(Qs),qu=E({},li,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ri=Rn(qu),d=E({},fs,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ca}),v=Rn(d),x=E({},Bs,{propertyName:0,elapsedTime:0,pseudoElement:0}),C=Rn(x),K=E({},li,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),ce=Rn(K),De=E({},Bs,{newState:0,oldState:0}),It=Rn(De),ls=[9,13,27,32],un=Et&&"CompositionEvent"in window,$n=null;Et&&"documentMode"in document&&($n=document.documentMode);var Mr=Et&&"TextEvent"in window&&!$n,ui=Et&&(!un||$n&&8<$n&&11>=$n),Kr=" ",Yr=!1;function ro(n,r){switch(n){case"keyup":return ls.indexOf(r.keyCode)!==-1;case"keydown":return r.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ho(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var $o=!1;function AE(n,r){switch(n){case"compositionend":return Ho(r);case"keypress":return r.which!==32?null:(Yr=!0,Kr);case"textInput":return n=r.data,n===Kr&&Yr?null:n;default:return null}}function RE(n,r){if($o)return n==="compositionend"||!un&&ro(n,r)?(n=Hn(),Tt=Us=Zt=null,$o=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(r.ctrlKey||r.altKey||r.metaKey)||r.ctrlKey&&r.altKey){if(r.char&&1<r.char.length)return r.char;if(r.which)return String.fromCharCode(r.which)}return null;case"compositionend":return ui&&r.locale!=="ko"?null:r.data;default:return null}}var IE={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function zy(n){var r=n&&n.nodeName&&n.nodeName.toLowerCase();return r==="input"?!!IE[n.type]:r==="textarea"}function Fy(n,r,a,c){X?ye?ye.push(c):ye=[c]:X=c,r=Ih(r,"onChange"),0<r.length&&(a=new zs("onChange","change",null,a,c),n.push({event:a,listeners:r}))}var Yl=null,Ql=null;function DE(n){T1(n,0)}function Hu(n){var r=Ln(n);if(Kn(r))return n}function qy(n,r){if(n==="change")return r}var Hy=!1;if(Et){var mf;if(Et){var pf="oninput"in document;if(!pf){var $y=document.createElement("div");$y.setAttribute("oninput","return;"),pf=typeof $y.oninput=="function"}mf=pf}else mf=!1;Hy=mf&&(!document.documentMode||9<document.documentMode)}function Wy(){Yl&&(Yl.detachEvent("onpropertychange",Gy),Ql=Yl=null)}function Gy(n){if(n.propertyName==="value"&&Hu(Ql)){var r=[];Fy(r,Ql,n,Y(n)),qe(DE,r)}}function ME(n,r,a){n==="focusin"?(Wy(),Yl=r,Ql=a,Yl.attachEvent("onpropertychange",Gy)):n==="focusout"&&Wy()}function LE(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return Hu(Ql)}function OE(n,r){if(n==="click")return Hu(r)}function PE(n,r){if(n==="input"||n==="change")return Hu(r)}function VE(n,r){return n===r&&(n!==0||1/n===1/r)||n!==n&&r!==r}var pr=typeof Object.is=="function"?Object.is:VE;function Xl(n,r){if(pr(n,r))return!0;if(typeof n!="object"||n===null||typeof r!="object"||r===null)return!1;var a=Object.keys(n),c=Object.keys(r);if(a.length!==c.length)return!1;for(c=0;c<a.length;c++){var f=a[c];if(!Rt.call(r,f)||!pr(n[f],r[f]))return!1}return!0}function Ky(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function Yy(n,r){var a=Ky(n);n=0;for(var c;a;){if(a.nodeType===3){if(c=n+a.textContent.length,n<=r&&c>=r)return{node:a,offset:r-n};n=c}e:{for(;a;){if(a.nextSibling){a=a.nextSibling;break e}a=a.parentNode}a=void 0}a=Ky(a)}}function Qy(n,r){return n&&r?n===r?!0:n&&n.nodeType===3?!1:r&&r.nodeType===3?Qy(n,r.parentNode):"contains"in n?n.contains(r):n.compareDocumentPosition?!!(n.compareDocumentPosition(r)&16):!1:!1}function Xy(n){n=n!=null&&n.ownerDocument!=null&&n.ownerDocument.defaultView!=null?n.ownerDocument.defaultView:window;for(var r=os(n.document);r instanceof n.HTMLIFrameElement;){try{var a=typeof r.contentWindow.location.href=="string"}catch{a=!1}if(a)n=r.contentWindow;else break;r=os(n.document)}return r}function gf(n){var r=n&&n.nodeName&&n.nodeName.toLowerCase();return r&&(r==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||r==="textarea"||n.contentEditable==="true")}var UE=Et&&"documentMode"in document&&11>=document.documentMode,Wo=null,yf=null,Jl=null,vf=!1;function Jy(n,r,a){var c=a.window===a?a.document:a.nodeType===9?a:a.ownerDocument;vf||Wo==null||Wo!==os(c)||(c=Wo,"selectionStart"in c&&gf(c)?c={start:c.selectionStart,end:c.selectionEnd}:(c=(c.ownerDocument&&c.ownerDocument.defaultView||window).getSelection(),c={anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset}),Jl&&Xl(Jl,c)||(Jl=c,c=Ih(yf,"onSelect"),0<c.length&&(r=new zs("onSelect","select",null,r,a),n.push({event:r,listeners:c}),r.target=Wo)))}function io(n,r){var a={};return a[n.toLowerCase()]=r.toLowerCase(),a["Webkit"+n]="webkit"+r,a["Moz"+n]="moz"+r,a}var Go={animationend:io("Animation","AnimationEnd"),animationiteration:io("Animation","AnimationIteration"),animationstart:io("Animation","AnimationStart"),transitionrun:io("Transition","TransitionRun"),transitionstart:io("Transition","TransitionStart"),transitioncancel:io("Transition","TransitionCancel"),transitionend:io("Transition","TransitionEnd")},bf={},Zy={};Et&&(Zy=document.createElement("div").style,"AnimationEvent"in window||(delete Go.animationend.animation,delete Go.animationiteration.animation,delete Go.animationstart.animation),"TransitionEvent"in window||delete Go.transitionend.transition);function ao(n){if(bf[n])return bf[n];if(!Go[n])return n;var r=Go[n],a;for(a in r)if(r.hasOwnProperty(a)&&a in Zy)return bf[n]=r[a];return n}var ev=ao("animationend"),tv=ao("animationiteration"),nv=ao("animationstart"),BE=ao("transitionrun"),zE=ao("transitionstart"),FE=ao("transitioncancel"),sv=ao("transitionend"),rv=new Map,_f="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");_f.push("scrollEnd");function Qr(n,r){rv.set(n,r),xs(r,[n])}var $u=typeof reportError=="function"?reportError:function(n){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var r=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof n=="object"&&n!==null&&typeof n.message=="string"?String(n.message):String(n),error:n});if(!window.dispatchEvent(r))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",n);return}console.error(n)},Lr=[],Ko=0,wf=0;function Wu(){for(var n=Ko,r=wf=Ko=0;r<n;){var a=Lr[r];Lr[r++]=null;var c=Lr[r];Lr[r++]=null;var f=Lr[r];Lr[r++]=null;var m=Lr[r];if(Lr[r++]=null,c!==null&&f!==null){var _=c.pending;_===null?f.next=f:(f.next=_.next,_.next=f),c.pending=f}m!==0&&iv(a,f,m)}}function Gu(n,r,a,c){Lr[Ko++]=n,Lr[Ko++]=r,Lr[Ko++]=a,Lr[Ko++]=c,wf|=c,n.lanes|=c,n=n.alternate,n!==null&&(n.lanes|=c)}function xf(n,r,a,c){return Gu(n,r,a,c),Ku(n)}function oo(n,r){return Gu(n,null,null,r),Ku(n)}function iv(n,r,a){n.lanes|=a;var c=n.alternate;c!==null&&(c.lanes|=a);for(var f=!1,m=n.return;m!==null;)m.childLanes|=a,c=m.alternate,c!==null&&(c.childLanes|=a),m.tag===22&&(n=m.stateNode,n===null||n._visibility&1||(f=!0)),n=m,m=m.return;return n.tag===3?(m=n.stateNode,f&&r!==null&&(f=31-Fe(a),n=m.hiddenUpdates,c=n[f],c===null?n[f]=[r]:c.push(r),r.lane=a|536870912),m):null}function Ku(n){if(50<_c)throw _c=0,Rm=null,Error(i(185));for(var r=n.return;r!==null;)n=r,r=n.return;return n.tag===3?n.stateNode:null}var Yo={};function qE(n,r,a,c){this.tag=n,this.key=a,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=r,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=c,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function gr(n,r,a,c){return new qE(n,r,a,c)}function Ef(n){return n=n.prototype,!(!n||!n.isReactComponent)}function Ii(n,r){var a=n.alternate;return a===null?(a=gr(n.tag,r,n.key,n.mode),a.elementType=n.elementType,a.type=n.type,a.stateNode=n.stateNode,a.alternate=n,n.alternate=a):(a.pendingProps=r,a.type=n.type,a.flags=0,a.subtreeFlags=0,a.deletions=null),a.flags=n.flags&65011712,a.childLanes=n.childLanes,a.lanes=n.lanes,a.child=n.child,a.memoizedProps=n.memoizedProps,a.memoizedState=n.memoizedState,a.updateQueue=n.updateQueue,r=n.dependencies,a.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext},a.sibling=n.sibling,a.index=n.index,a.ref=n.ref,a.refCleanup=n.refCleanup,a}function av(n,r){n.flags&=65011714;var a=n.alternate;return a===null?(n.childLanes=0,n.lanes=r,n.child=null,n.subtreeFlags=0,n.memoizedProps=null,n.memoizedState=null,n.updateQueue=null,n.dependencies=null,n.stateNode=null):(n.childLanes=a.childLanes,n.lanes=a.lanes,n.child=a.child,n.subtreeFlags=0,n.deletions=null,n.memoizedProps=a.memoizedProps,n.memoizedState=a.memoizedState,n.updateQueue=a.updateQueue,n.type=a.type,r=a.dependencies,n.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext}),n}function Yu(n,r,a,c,f,m){var _=0;if(c=n,typeof n=="function")Ef(n)&&(_=1);else if(typeof n=="string")_=KT(n,a,ke.current)?26:n==="html"||n==="head"||n==="body"?27:5;else e:switch(n){case I:return n=gr(31,a,r,f),n.elementType=I,n.lanes=m,n;case q:return lo(a.children,f,m,r);case B:_=8,f|=24;break;case te:return n=gr(12,a,r,f|2),n.elementType=te,n.lanes=m,n;case Te:return n=gr(13,a,r,f),n.elementType=Te,n.lanes=m,n;case ve:return n=gr(19,a,r,f),n.elementType=ve,n.lanes=m,n;default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case ee:_=10;break e;case W:_=9;break e;case pe:_=11;break e;case A:_=14;break e;case S:_=16,c=null;break e}_=29,a=Error(i(130,n===null?"null":typeof n,"")),c=null}return r=gr(_,a,r,f),r.elementType=n,r.type=c,r.lanes=m,r}function lo(n,r,a,c){return n=gr(7,n,c,r),n.lanes=a,n}function Tf(n,r,a){return n=gr(6,n,null,r),n.lanes=a,n}function ov(n){var r=gr(18,null,null,0);return r.stateNode=n,r}function kf(n,r,a){return r=gr(4,n.children!==null?n.children:[],n.key,r),r.lanes=a,r.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},r}var lv=new WeakMap;function Or(n,r){if(typeof n=="object"&&n!==null){var a=lv.get(n);return a!==void 0?a:(r={value:n,source:r,stack:ue(r)},lv.set(n,r),r)}return{value:n,source:r,stack:ue(r)}}var Qo=[],Xo=0,Qu=null,Zl=0,Pr=[],Vr=0,ua=null,hi=1,di="";function Di(n,r){Qo[Xo++]=Zl,Qo[Xo++]=Qu,Qu=n,Zl=r}function cv(n,r,a){Pr[Vr++]=hi,Pr[Vr++]=di,Pr[Vr++]=ua,ua=n;var c=hi;n=di;var f=32-Fe(c)-1;c&=~(1<<f),a+=1;var m=32-Fe(r)+f;if(30<m){var _=f-f%5;m=(c&(1<<_)-1).toString(32),c>>=_,f-=_,hi=1<<32-Fe(r)+f|a<<f|c,di=m+n}else hi=1<<m|a<<f|c,di=n}function Sf(n){n.return!==null&&(Di(n,1),cv(n,1,0))}function jf(n){for(;n===Qu;)Qu=Qo[--Xo],Qo[Xo]=null,Zl=Qo[--Xo],Qo[Xo]=null;for(;n===ua;)ua=Pr[--Vr],Pr[Vr]=null,di=Pr[--Vr],Pr[Vr]=null,hi=Pr[--Vr],Pr[Vr]=null}function uv(n,r){Pr[Vr++]=hi,Pr[Vr++]=di,Pr[Vr++]=ua,hi=r.id,di=r.overflow,ua=n}var As=null,On=null,Qt=!1,ha=null,Ur=!1,Cf=Error(i(519));function da(n){var r=Error(i(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw ec(Or(r,n)),Cf}function hv(n){var r=n.stateNode,a=n.type,c=n.memoizedProps;switch(r[Jt]=n,r[An]=c,a){case"dialog":Bt("cancel",r),Bt("close",r);break;case"iframe":case"object":case"embed":Bt("load",r);break;case"video":case"audio":for(a=0;a<xc.length;a++)Bt(xc[a],r);break;case"source":Bt("error",r);break;case"img":case"image":case"link":Bt("error",r),Bt("load",r);break;case"details":Bt("toggle",r);break;case"input":Bt("invalid",r),oa(r,c.value,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name,!0);break;case"select":Bt("invalid",r);break;case"textarea":Bt("invalid",r),Ir(r,c.value,c.defaultValue,c.children)}a=c.children,typeof a!="string"&&typeof a!="number"&&typeof a!="bigint"||r.textContent===""+a||c.suppressHydrationWarning===!0||C1(r.textContent,a)?(c.popover!=null&&(Bt("beforetoggle",r),Bt("toggle",r)),c.onScroll!=null&&Bt("scroll",r),c.onScrollEnd!=null&&Bt("scrollend",r),c.onClick!=null&&(r.onclick=dt),r=!0):r=!1,r||da(n,!0)}function dv(n){for(As=n.return;As;)switch(As.tag){case 5:case 31:case 13:Ur=!1;return;case 27:case 3:Ur=!0;return;default:As=As.return}}function Jo(n){if(n!==As)return!1;if(!Qt)return dv(n),Qt=!0,!1;var r=n.tag,a;if((a=r!==3&&r!==27)&&((a=r===5)&&(a=n.type,a=!(a!=="form"&&a!=="button")||Wm(n.type,n.memoizedProps)),a=!a),a&&On&&da(n),dv(n),r===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(i(317));On=P1(n)}else if(r===31){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(i(317));On=P1(n)}else r===27?(r=On,Sa(n.type)?(n=Xm,Xm=null,On=n):On=r):On=As?zr(n.stateNode.nextSibling):null;return!0}function co(){On=As=null,Qt=!1}function Nf(){var n=ha;return n!==null&&(or===null?or=n:or.push.apply(or,n),ha=null),n}function ec(n){ha===null?ha=[n]:ha.push(n)}var Af=L(null),uo=null,Mi=null;function fa(n,r,a){_e(Af,r._currentValue),r._currentValue=a}function Li(n){n._currentValue=Af.current,ie(Af)}function Rf(n,r,a){for(;n!==null;){var c=n.alternate;if((n.childLanes&r)!==r?(n.childLanes|=r,c!==null&&(c.childLanes|=r)):c!==null&&(c.childLanes&r)!==r&&(c.childLanes|=r),n===a)break;n=n.return}}function If(n,r,a,c){var f=n.child;for(f!==null&&(f.return=n);f!==null;){var m=f.dependencies;if(m!==null){var _=f.child;m=m.firstContext;e:for(;m!==null;){var k=m;m=f;for(var U=0;U<r.length;U++)if(k.context===r[U]){m.lanes|=a,k=m.alternate,k!==null&&(k.lanes|=a),Rf(m.return,a,n),c||(_=null);break e}m=k.next}}else if(f.tag===18){if(_=f.return,_===null)throw Error(i(341));_.lanes|=a,m=_.alternate,m!==null&&(m.lanes|=a),Rf(_,a,n),_=null}else _=f.child;if(_!==null)_.return=f;else for(_=f;_!==null;){if(_===n){_=null;break}if(f=_.sibling,f!==null){f.return=_.return,_=f;break}_=_.return}f=_}}function Zo(n,r,a,c){n=null;for(var f=r,m=!1;f!==null;){if(!m){if((f.flags&524288)!==0)m=!0;else if((f.flags&262144)!==0)break}if(f.tag===10){var _=f.alternate;if(_===null)throw Error(i(387));if(_=_.memoizedProps,_!==null){var k=f.type;pr(f.pendingProps.value,_.value)||(n!==null?n.push(k):n=[k])}}else if(f===Ke.current){if(_=f.alternate,_===null)throw Error(i(387));_.memoizedState.memoizedState!==f.memoizedState.memoizedState&&(n!==null?n.push(jc):n=[jc])}f=f.return}n!==null&&If(r,n,a,c),r.flags|=262144}function Xu(n){for(n=n.firstContext;n!==null;){if(!pr(n.context._currentValue,n.memoizedValue))return!0;n=n.next}return!1}function ho(n){uo=n,Mi=null,n=n.dependencies,n!==null&&(n.firstContext=null)}function Rs(n){return fv(uo,n)}function Ju(n,r){return uo===null&&ho(n),fv(n,r)}function fv(n,r){var a=r._currentValue;if(r={context:r,memoizedValue:a,next:null},Mi===null){if(n===null)throw Error(i(308));Mi=r,n.dependencies={lanes:0,firstContext:r},n.flags|=524288}else Mi=Mi.next=r;return a}var HE=typeof AbortController<"u"?AbortController:function(){var n=[],r=this.signal={aborted:!1,addEventListener:function(a,c){n.push(c)}};this.abort=function(){r.aborted=!0,n.forEach(function(a){return a()})}},$E=s.unstable_scheduleCallback,WE=s.unstable_NormalPriority,ms={$$typeof:ee,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Df(){return{controller:new HE,data:new Map,refCount:0}}function tc(n){n.refCount--,n.refCount===0&&$E(WE,function(){n.controller.abort()})}var nc=null,Mf=0,el=0,tl=null;function GE(n,r){if(nc===null){var a=nc=[];Mf=0,el=Pm(),tl={status:"pending",value:void 0,then:function(c){a.push(c)}}}return Mf++,r.then(mv,mv),r}function mv(){if(--Mf===0&&nc!==null){tl!==null&&(tl.status="fulfilled");var n=nc;nc=null,el=0,tl=null;for(var r=0;r<n.length;r++)(0,n[r])()}}function KE(n,r){var a=[],c={status:"pending",value:null,reason:null,then:function(f){a.push(f)}};return n.then(function(){c.status="fulfilled",c.value=r;for(var f=0;f<a.length;f++)(0,a[f])(r)},function(f){for(c.status="rejected",c.reason=f,f=0;f<a.length;f++)(0,a[f])(void 0)}),c}var pv=Z.S;Z.S=function(n,r){J0=vt(),typeof r=="object"&&r!==null&&typeof r.then=="function"&&GE(n,r),pv!==null&&pv(n,r)};var fo=L(null);function Lf(){var n=fo.current;return n!==null?n:Sn.pooledCache}function Zu(n,r){r===null?_e(fo,fo.current):_e(fo,r.pool)}function gv(){var n=Lf();return n===null?null:{parent:ms._currentValue,pool:n}}var nl=Error(i(460)),Of=Error(i(474)),eh=Error(i(542)),th={then:function(){}};function yv(n){return n=n.status,n==="fulfilled"||n==="rejected"}function vv(n,r,a){switch(a=n[a],a===void 0?n.push(r):a!==r&&(r.then(dt,dt),r=a),r.status){case"fulfilled":return r.value;case"rejected":throw n=r.reason,_v(n),n;default:if(typeof r.status=="string")r.then(dt,dt);else{if(n=Sn,n!==null&&100<n.shellSuspendCounter)throw Error(i(482));n=r,n.status="pending",n.then(function(c){if(r.status==="pending"){var f=r;f.status="fulfilled",f.value=c}},function(c){if(r.status==="pending"){var f=r;f.status="rejected",f.reason=c}})}switch(r.status){case"fulfilled":return r.value;case"rejected":throw n=r.reason,_v(n),n}throw po=r,nl}}function mo(n){try{var r=n._init;return r(n._payload)}catch(a){throw a!==null&&typeof a=="object"&&typeof a.then=="function"?(po=a,nl):a}}var po=null;function bv(){if(po===null)throw Error(i(459));var n=po;return po=null,n}function _v(n){if(n===nl||n===eh)throw Error(i(483))}var sl=null,sc=0;function nh(n){var r=sc;return sc+=1,sl===null&&(sl=[]),vv(sl,n,r)}function rc(n,r){r=r.props.ref,n.ref=r!==void 0?r:null}function sh(n,r){throw r.$$typeof===T?Error(i(525)):(n=Object.prototype.toString.call(r),Error(i(31,n==="[object Object]"?"object with keys {"+Object.keys(r).join(", ")+"}":n)))}function wv(n){function r($,F){if(n){var Q=$.deletions;Q===null?($.deletions=[F],$.flags|=16):Q.push(F)}}function a($,F){if(!n)return null;for(;F!==null;)r($,F),F=F.sibling;return null}function c($){for(var F=new Map;$!==null;)$.key!==null?F.set($.key,$):F.set($.index,$),$=$.sibling;return F}function f($,F){return $=Ii($,F),$.index=0,$.sibling=null,$}function m($,F,Q){return $.index=Q,n?(Q=$.alternate,Q!==null?(Q=Q.index,Q<F?($.flags|=67108866,F):Q):($.flags|=67108866,F)):($.flags|=1048576,F)}function _($){return n&&$.alternate===null&&($.flags|=67108866),$}function k($,F,Q,me){return F===null||F.tag!==6?(F=Tf(Q,$.mode,me),F.return=$,F):(F=f(F,Q),F.return=$,F)}function U($,F,Q,me){var at=Q.type;return at===q?de($,F,Q.props.children,me,Q.key):F!==null&&(F.elementType===at||typeof at=="object"&&at!==null&&at.$$typeof===S&&mo(at)===F.type)?(F=f(F,Q.props),rc(F,Q),F.return=$,F):(F=Yu(Q.type,Q.key,Q.props,null,$.mode,me),rc(F,Q),F.return=$,F)}function J($,F,Q,me){return F===null||F.tag!==4||F.stateNode.containerInfo!==Q.containerInfo||F.stateNode.implementation!==Q.implementation?(F=kf(Q,$.mode,me),F.return=$,F):(F=f(F,Q.children||[]),F.return=$,F)}function de($,F,Q,me,at){return F===null||F.tag!==7?(F=lo(Q,$.mode,me,at),F.return=$,F):(F=f(F,Q),F.return=$,F)}function ge($,F,Q){if(typeof F=="string"&&F!==""||typeof F=="number"||typeof F=="bigint")return F=Tf(""+F,$.mode,Q),F.return=$,F;if(typeof F=="object"&&F!==null){switch(F.$$typeof){case O:return Q=Yu(F.type,F.key,F.props,null,$.mode,Q),rc(Q,F),Q.return=$,Q;case H:return F=kf(F,$.mode,Q),F.return=$,F;case S:return F=mo(F),ge($,F,Q)}if(Ze(F)||M(F))return F=lo(F,$.mode,Q,null),F.return=$,F;if(typeof F.then=="function")return ge($,nh(F),Q);if(F.$$typeof===ee)return ge($,Ju($,F),Q);sh($,F)}return null}function se($,F,Q,me){var at=F!==null?F.key:null;if(typeof Q=="string"&&Q!==""||typeof Q=="number"||typeof Q=="bigint")return at!==null?null:k($,F,""+Q,me);if(typeof Q=="object"&&Q!==null){switch(Q.$$typeof){case O:return Q.key===at?U($,F,Q,me):null;case H:return Q.key===at?J($,F,Q,me):null;case S:return Q=mo(Q),se($,F,Q,me)}if(Ze(Q)||M(Q))return at!==null?null:de($,F,Q,me,null);if(typeof Q.then=="function")return se($,F,nh(Q),me);if(Q.$$typeof===ee)return se($,F,Ju($,Q),me);sh($,Q)}return null}function he($,F,Q,me,at){if(typeof me=="string"&&me!==""||typeof me=="number"||typeof me=="bigint")return $=$.get(Q)||null,k(F,$,""+me,at);if(typeof me=="object"&&me!==null){switch(me.$$typeof){case O:return $=$.get(me.key===null?Q:me.key)||null,U(F,$,me,at);case H:return $=$.get(me.key===null?Q:me.key)||null,J(F,$,me,at);case S:return me=mo(me),he($,F,Q,me,at)}if(Ze(me)||M(me))return $=$.get(Q)||null,de(F,$,me,at,null);if(typeof me.then=="function")return he($,F,Q,nh(me),at);if(me.$$typeof===ee)return he($,F,Q,Ju(F,me),at);sh(F,me)}return null}function Xe($,F,Q,me){for(var at=null,rn=null,tt=F,Ot=F=0,Ht=null;tt!==null&&Ot<Q.length;Ot++){tt.index>Ot?(Ht=tt,tt=null):Ht=tt.sibling;var an=se($,tt,Q[Ot],me);if(an===null){tt===null&&(tt=Ht);break}n&&tt&&an.alternate===null&&r($,tt),F=m(an,F,Ot),rn===null?at=an:rn.sibling=an,rn=an,tt=Ht}if(Ot===Q.length)return a($,tt),Qt&&Di($,Ot),at;if(tt===null){for(;Ot<Q.length;Ot++)tt=ge($,Q[Ot],me),tt!==null&&(F=m(tt,F,Ot),rn===null?at=tt:rn.sibling=tt,rn=tt);return Qt&&Di($,Ot),at}for(tt=c(tt);Ot<Q.length;Ot++)Ht=he(tt,$,Ot,Q[Ot],me),Ht!==null&&(n&&Ht.alternate!==null&&tt.delete(Ht.key===null?Ot:Ht.key),F=m(Ht,F,Ot),rn===null?at=Ht:rn.sibling=Ht,rn=Ht);return n&&tt.forEach(function(Ra){return r($,Ra)}),Qt&&Di($,Ot),at}function ft($,F,Q,me){if(Q==null)throw Error(i(151));for(var at=null,rn=null,tt=F,Ot=F=0,Ht=null,an=Q.next();tt!==null&&!an.done;Ot++,an=Q.next()){tt.index>Ot?(Ht=tt,tt=null):Ht=tt.sibling;var Ra=se($,tt,an.value,me);if(Ra===null){tt===null&&(tt=Ht);break}n&&tt&&Ra.alternate===null&&r($,tt),F=m(Ra,F,Ot),rn===null?at=Ra:rn.sibling=Ra,rn=Ra,tt=Ht}if(an.done)return a($,tt),Qt&&Di($,Ot),at;if(tt===null){for(;!an.done;Ot++,an=Q.next())an=ge($,an.value,me),an!==null&&(F=m(an,F,Ot),rn===null?at=an:rn.sibling=an,rn=an);return Qt&&Di($,Ot),at}for(tt=c(tt);!an.done;Ot++,an=Q.next())an=he(tt,$,Ot,an.value,me),an!==null&&(n&&an.alternate!==null&&tt.delete(an.key===null?Ot:an.key),F=m(an,F,Ot),rn===null?at=an:rn.sibling=an,rn=an);return n&&tt.forEach(function(ik){return r($,ik)}),Qt&&Di($,Ot),at}function xn($,F,Q,me){if(typeof Q=="object"&&Q!==null&&Q.type===q&&Q.key===null&&(Q=Q.props.children),typeof Q=="object"&&Q!==null){switch(Q.$$typeof){case O:e:{for(var at=Q.key;F!==null;){if(F.key===at){if(at=Q.type,at===q){if(F.tag===7){a($,F.sibling),me=f(F,Q.props.children),me.return=$,$=me;break e}}else if(F.elementType===at||typeof at=="object"&&at!==null&&at.$$typeof===S&&mo(at)===F.type){a($,F.sibling),me=f(F,Q.props),rc(me,Q),me.return=$,$=me;break e}a($,F);break}else r($,F);F=F.sibling}Q.type===q?(me=lo(Q.props.children,$.mode,me,Q.key),me.return=$,$=me):(me=Yu(Q.type,Q.key,Q.props,null,$.mode,me),rc(me,Q),me.return=$,$=me)}return _($);case H:e:{for(at=Q.key;F!==null;){if(F.key===at)if(F.tag===4&&F.stateNode.containerInfo===Q.containerInfo&&F.stateNode.implementation===Q.implementation){a($,F.sibling),me=f(F,Q.children||[]),me.return=$,$=me;break e}else{a($,F);break}else r($,F);F=F.sibling}me=kf(Q,$.mode,me),me.return=$,$=me}return _($);case S:return Q=mo(Q),xn($,F,Q,me)}if(Ze(Q))return Xe($,F,Q,me);if(M(Q)){if(at=M(Q),typeof at!="function")throw Error(i(150));return Q=at.call(Q),ft($,F,Q,me)}if(typeof Q.then=="function")return xn($,F,nh(Q),me);if(Q.$$typeof===ee)return xn($,F,Ju($,Q),me);sh($,Q)}return typeof Q=="string"&&Q!==""||typeof Q=="number"||typeof Q=="bigint"?(Q=""+Q,F!==null&&F.tag===6?(a($,F.sibling),me=f(F,Q),me.return=$,$=me):(a($,F),me=Tf(Q,$.mode,me),me.return=$,$=me),_($)):a($,F)}return function($,F,Q,me){try{sc=0;var at=xn($,F,Q,me);return sl=null,at}catch(tt){if(tt===nl||tt===eh)throw tt;var rn=gr(29,tt,null,$.mode);return rn.lanes=me,rn.return=$,rn}}}var go=wv(!0),xv=wv(!1),ma=!1;function Pf(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Vf(n,r){n=n.updateQueue,r.updateQueue===n&&(r.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,callbacks:null})}function pa(n){return{lane:n,tag:0,payload:null,callback:null,next:null}}function ga(n,r,a){var c=n.updateQueue;if(c===null)return null;if(c=c.shared,(hn&2)!==0){var f=c.pending;return f===null?r.next=r:(r.next=f.next,f.next=r),c.pending=r,r=Ku(n),iv(n,null,a),r}return Gu(n,c,r,a),Ku(n)}function ic(n,r,a){if(r=r.updateQueue,r!==null&&(r=r.shared,(a&4194048)!==0)){var c=r.lanes;c&=n.pendingLanes,a|=c,r.lanes=a,yn(n,a)}}function Uf(n,r){var a=n.updateQueue,c=n.alternate;if(c!==null&&(c=c.updateQueue,a===c)){var f=null,m=null;if(a=a.firstBaseUpdate,a!==null){do{var _={lane:a.lane,tag:a.tag,payload:a.payload,callback:null,next:null};m===null?f=m=_:m=m.next=_,a=a.next}while(a!==null);m===null?f=m=r:m=m.next=r}else f=m=r;a={baseState:c.baseState,firstBaseUpdate:f,lastBaseUpdate:m,shared:c.shared,callbacks:c.callbacks},n.updateQueue=a;return}n=a.lastBaseUpdate,n===null?a.firstBaseUpdate=r:n.next=r,a.lastBaseUpdate=r}var Bf=!1;function ac(){if(Bf){var n=tl;if(n!==null)throw n}}function oc(n,r,a,c){Bf=!1;var f=n.updateQueue;ma=!1;var m=f.firstBaseUpdate,_=f.lastBaseUpdate,k=f.shared.pending;if(k!==null){f.shared.pending=null;var U=k,J=U.next;U.next=null,_===null?m=J:_.next=J,_=U;var de=n.alternate;de!==null&&(de=de.updateQueue,k=de.lastBaseUpdate,k!==_&&(k===null?de.firstBaseUpdate=J:k.next=J,de.lastBaseUpdate=U))}if(m!==null){var ge=f.baseState;_=0,de=J=U=null,k=m;do{var se=k.lane&-536870913,he=se!==k.lane;if(he?(qt&se)===se:(c&se)===se){se!==0&&se===el&&(Bf=!0),de!==null&&(de=de.next={lane:0,tag:k.tag,payload:k.payload,callback:null,next:null});e:{var Xe=n,ft=k;se=r;var xn=a;switch(ft.tag){case 1:if(Xe=ft.payload,typeof Xe=="function"){ge=Xe.call(xn,ge,se);break e}ge=Xe;break e;case 3:Xe.flags=Xe.flags&-65537|128;case 0:if(Xe=ft.payload,se=typeof Xe=="function"?Xe.call(xn,ge,se):Xe,se==null)break e;ge=E({},ge,se);break e;case 2:ma=!0}}se=k.callback,se!==null&&(n.flags|=64,he&&(n.flags|=8192),he=f.callbacks,he===null?f.callbacks=[se]:he.push(se))}else he={lane:se,tag:k.tag,payload:k.payload,callback:k.callback,next:null},de===null?(J=de=he,U=ge):de=de.next=he,_|=se;if(k=k.next,k===null){if(k=f.shared.pending,k===null)break;he=k,k=he.next,he.next=null,f.lastBaseUpdate=he,f.shared.pending=null}}while(!0);de===null&&(U=ge),f.baseState=U,f.firstBaseUpdate=J,f.lastBaseUpdate=de,m===null&&(f.shared.lanes=0),wa|=_,n.lanes=_,n.memoizedState=ge}}function Ev(n,r){if(typeof n!="function")throw Error(i(191,n));n.call(r)}function Tv(n,r){var a=n.callbacks;if(a!==null)for(n.callbacks=null,n=0;n<a.length;n++)Ev(a[n],r)}var rl=L(null),rh=L(0);function kv(n,r){n=Hi,_e(rh,n),_e(rl,r),Hi=n|r.baseLanes}function zf(){_e(rh,Hi),_e(rl,rl.current)}function Ff(){Hi=rh.current,ie(rl),ie(rh)}var yr=L(null),Br=null;function ya(n){var r=n.alternate;_e(cs,cs.current&1),_e(yr,n),Br===null&&(r===null||rl.current!==null||r.memoizedState!==null)&&(Br=n)}function qf(n){_e(cs,cs.current),_e(yr,n),Br===null&&(Br=n)}function Sv(n){n.tag===22?(_e(cs,cs.current),_e(yr,n),Br===null&&(Br=n)):va()}function va(){_e(cs,cs.current),_e(yr,yr.current)}function vr(n){ie(yr),Br===n&&(Br=null),ie(cs)}var cs=L(0);function ih(n){for(var r=n;r!==null;){if(r.tag===13){var a=r.memoizedState;if(a!==null&&(a=a.dehydrated,a===null||Ym(a)||Qm(a)))return r}else if(r.tag===19&&(r.memoizedProps.revealOrder==="forwards"||r.memoizedProps.revealOrder==="backwards"||r.memoizedProps.revealOrder==="unstable_legacy-backwards"||r.memoizedProps.revealOrder==="together")){if((r.flags&128)!==0)return r}else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===n)break;for(;r.sibling===null;){if(r.return===null||r.return===n)return null;r=r.return}r.sibling.return=r.return,r=r.sibling}return null}var Oi=0,Dt=null,_n=null,ps=null,ah=!1,il=!1,yo=!1,oh=0,lc=0,al=null,YE=0;function Zn(){throw Error(i(321))}function Hf(n,r){if(r===null)return!1;for(var a=0;a<r.length&&a<n.length;a++)if(!pr(n[a],r[a]))return!1;return!0}function $f(n,r,a,c,f,m){return Oi=m,Dt=r,r.memoizedState=null,r.updateQueue=null,r.lanes=0,Z.H=n===null||n.memoizedState===null?c0:am,yo=!1,m=a(c,f),yo=!1,il&&(m=Cv(r,a,c,f)),jv(n),m}function jv(n){Z.H=hc;var r=_n!==null&&_n.next!==null;if(Oi=0,ps=_n=Dt=null,ah=!1,lc=0,al=null,r)throw Error(i(300));n===null||gs||(n=n.dependencies,n!==null&&Xu(n)&&(gs=!0))}function Cv(n,r,a,c){Dt=n;var f=0;do{if(il&&(al=null),lc=0,il=!1,25<=f)throw Error(i(301));if(f+=1,ps=_n=null,n.updateQueue!=null){var m=n.updateQueue;m.lastEffect=null,m.events=null,m.stores=null,m.memoCache!=null&&(m.memoCache.index=0)}Z.H=u0,m=r(a,c)}while(il);return m}function QE(){var n=Z.H,r=n.useState()[0];return r=typeof r.then=="function"?cc(r):r,n=n.useState()[0],(_n!==null?_n.memoizedState:null)!==n&&(Dt.flags|=1024),r}function Wf(){var n=oh!==0;return oh=0,n}function Gf(n,r,a){r.updateQueue=n.updateQueue,r.flags&=-2053,n.lanes&=~a}function Kf(n){if(ah){for(n=n.memoizedState;n!==null;){var r=n.queue;r!==null&&(r.pending=null),n=n.next}ah=!1}Oi=0,ps=_n=Dt=null,il=!1,lc=oh=0,al=null}function Xs(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ps===null?Dt.memoizedState=ps=n:ps=ps.next=n,ps}function us(){if(_n===null){var n=Dt.alternate;n=n!==null?n.memoizedState:null}else n=_n.next;var r=ps===null?Dt.memoizedState:ps.next;if(r!==null)ps=r,_n=n;else{if(n===null)throw Dt.alternate===null?Error(i(467)):Error(i(310));_n=n,n={memoizedState:_n.memoizedState,baseState:_n.baseState,baseQueue:_n.baseQueue,queue:_n.queue,next:null},ps===null?Dt.memoizedState=ps=n:ps=ps.next=n}return ps}function lh(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function cc(n){var r=lc;return lc+=1,al===null&&(al=[]),n=vv(al,n,r),r=Dt,(ps===null?r.memoizedState:ps.next)===null&&(r=r.alternate,Z.H=r===null||r.memoizedState===null?c0:am),n}function ch(n){if(n!==null&&typeof n=="object"){if(typeof n.then=="function")return cc(n);if(n.$$typeof===ee)return Rs(n)}throw Error(i(438,String(n)))}function Yf(n){var r=null,a=Dt.updateQueue;if(a!==null&&(r=a.memoCache),r==null){var c=Dt.alternate;c!==null&&(c=c.updateQueue,c!==null&&(c=c.memoCache,c!=null&&(r={data:c.data.map(function(f){return f.slice()}),index:0})))}if(r==null&&(r={data:[],index:0}),a===null&&(a=lh(),Dt.updateQueue=a),a.memoCache=r,a=r.data[r.index],a===void 0)for(a=r.data[r.index]=Array(n),c=0;c<n;c++)a[c]=V;return r.index++,a}function Pi(n,r){return typeof r=="function"?r(n):r}function uh(n){var r=us();return Qf(r,_n,n)}function Qf(n,r,a){var c=n.queue;if(c===null)throw Error(i(311));c.lastRenderedReducer=a;var f=n.baseQueue,m=c.pending;if(m!==null){if(f!==null){var _=f.next;f.next=m.next,m.next=_}r.baseQueue=f=m,c.pending=null}if(m=n.baseState,f===null)n.memoizedState=m;else{r=f.next;var k=_=null,U=null,J=r,de=!1;do{var ge=J.lane&-536870913;if(ge!==J.lane?(qt&ge)===ge:(Oi&ge)===ge){var se=J.revertLane;if(se===0)U!==null&&(U=U.next={lane:0,revertLane:0,gesture:null,action:J.action,hasEagerState:J.hasEagerState,eagerState:J.eagerState,next:null}),ge===el&&(de=!0);else if((Oi&se)===se){J=J.next,se===el&&(de=!0);continue}else ge={lane:0,revertLane:J.revertLane,gesture:null,action:J.action,hasEagerState:J.hasEagerState,eagerState:J.eagerState,next:null},U===null?(k=U=ge,_=m):U=U.next=ge,Dt.lanes|=se,wa|=se;ge=J.action,yo&&a(m,ge),m=J.hasEagerState?J.eagerState:a(m,ge)}else se={lane:ge,revertLane:J.revertLane,gesture:J.gesture,action:J.action,hasEagerState:J.hasEagerState,eagerState:J.eagerState,next:null},U===null?(k=U=se,_=m):U=U.next=se,Dt.lanes|=ge,wa|=ge;J=J.next}while(J!==null&&J!==r);if(U===null?_=m:U.next=k,!pr(m,n.memoizedState)&&(gs=!0,de&&(a=tl,a!==null)))throw a;n.memoizedState=m,n.baseState=_,n.baseQueue=U,c.lastRenderedState=m}return f===null&&(c.lanes=0),[n.memoizedState,c.dispatch]}function Xf(n){var r=us(),a=r.queue;if(a===null)throw Error(i(311));a.lastRenderedReducer=n;var c=a.dispatch,f=a.pending,m=r.memoizedState;if(f!==null){a.pending=null;var _=f=f.next;do m=n(m,_.action),_=_.next;while(_!==f);pr(m,r.memoizedState)||(gs=!0),r.memoizedState=m,r.baseQueue===null&&(r.baseState=m),a.lastRenderedState=m}return[m,c]}function Nv(n,r,a){var c=Dt,f=us(),m=Qt;if(m){if(a===void 0)throw Error(i(407));a=a()}else a=r();var _=!pr((_n||f).memoizedState,a);if(_&&(f.memoizedState=a,gs=!0),f=f.queue,em(Iv.bind(null,c,f,n),[n]),f.getSnapshot!==r||_||ps!==null&&ps.memoizedState.tag&1){if(c.flags|=2048,ol(9,{destroy:void 0},Rv.bind(null,c,f,a,r),null),Sn===null)throw Error(i(349));m||(Oi&127)!==0||Av(c,r,a)}return a}function Av(n,r,a){n.flags|=16384,n={getSnapshot:r,value:a},r=Dt.updateQueue,r===null?(r=lh(),Dt.updateQueue=r,r.stores=[n]):(a=r.stores,a===null?r.stores=[n]:a.push(n))}function Rv(n,r,a,c){r.value=a,r.getSnapshot=c,Dv(r)&&Mv(n)}function Iv(n,r,a){return a(function(){Dv(r)&&Mv(n)})}function Dv(n){var r=n.getSnapshot;n=n.value;try{var a=r();return!pr(n,a)}catch{return!0}}function Mv(n){var r=oo(n,2);r!==null&&lr(r,n,2)}function Jf(n){var r=Xs();if(typeof n=="function"){var a=n;if(n=a(),yo){st(!0);try{a()}finally{st(!1)}}}return r.memoizedState=r.baseState=n,r.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Pi,lastRenderedState:n},r}function Lv(n,r,a,c){return n.baseState=a,Qf(n,_n,typeof c=="function"?c:Pi)}function XE(n,r,a,c,f){if(fh(n))throw Error(i(485));if(n=r.action,n!==null){var m={payload:f,action:n,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(_){m.listeners.push(_)}};Z.T!==null?a(!0):m.isTransition=!1,c(m),a=r.pending,a===null?(m.next=r.pending=m,Ov(r,m)):(m.next=a.next,r.pending=a.next=m)}}function Ov(n,r){var a=r.action,c=r.payload,f=n.state;if(r.isTransition){var m=Z.T,_={};Z.T=_;try{var k=a(f,c),U=Z.S;U!==null&&U(_,k),Pv(n,r,k)}catch(J){Zf(n,r,J)}finally{m!==null&&_.types!==null&&(m.types=_.types),Z.T=m}}else try{m=a(f,c),Pv(n,r,m)}catch(J){Zf(n,r,J)}}function Pv(n,r,a){a!==null&&typeof a=="object"&&typeof a.then=="function"?a.then(function(c){Vv(n,r,c)},function(c){return Zf(n,r,c)}):Vv(n,r,a)}function Vv(n,r,a){r.status="fulfilled",r.value=a,Uv(r),n.state=a,r=n.pending,r!==null&&(a=r.next,a===r?n.pending=null:(a=a.next,r.next=a,Ov(n,a)))}function Zf(n,r,a){var c=n.pending;if(n.pending=null,c!==null){c=c.next;do r.status="rejected",r.reason=a,Uv(r),r=r.next;while(r!==c)}n.action=null}function Uv(n){n=n.listeners;for(var r=0;r<n.length;r++)(0,n[r])()}function Bv(n,r){return r}function zv(n,r){if(Qt){var a=Sn.formState;if(a!==null){e:{var c=Dt;if(Qt){if(On){t:{for(var f=On,m=Ur;f.nodeType!==8;){if(!m){f=null;break t}if(f=zr(f.nextSibling),f===null){f=null;break t}}m=f.data,f=m==="F!"||m==="F"?f:null}if(f){On=zr(f.nextSibling),c=f.data==="F!";break e}}da(c)}c=!1}c&&(r=a[0])}}return a=Xs(),a.memoizedState=a.baseState=r,c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Bv,lastRenderedState:r},a.queue=c,a=a0.bind(null,Dt,c),c.dispatch=a,c=Jf(!1),m=im.bind(null,Dt,!1,c.queue),c=Xs(),f={state:r,dispatch:null,action:n,pending:null},c.queue=f,a=XE.bind(null,Dt,f,m,a),f.dispatch=a,c.memoizedState=n,[r,a,!1]}function Fv(n){var r=us();return qv(r,_n,n)}function qv(n,r,a){if(r=Qf(n,r,Bv)[0],n=uh(Pi)[0],typeof r=="object"&&r!==null&&typeof r.then=="function")try{var c=cc(r)}catch(_){throw _===nl?eh:_}else c=r;r=us();var f=r.queue,m=f.dispatch;return a!==r.memoizedState&&(Dt.flags|=2048,ol(9,{destroy:void 0},JE.bind(null,f,a),null)),[c,m,n]}function JE(n,r){n.action=r}function Hv(n){var r=us(),a=_n;if(a!==null)return qv(r,a,n);us(),r=r.memoizedState,a=us();var c=a.queue.dispatch;return a.memoizedState=n,[r,c,!1]}function ol(n,r,a,c){return n={tag:n,create:a,deps:c,inst:r,next:null},r=Dt.updateQueue,r===null&&(r=lh(),Dt.updateQueue=r),a=r.lastEffect,a===null?r.lastEffect=n.next=n:(c=a.next,a.next=n,n.next=c,r.lastEffect=n),n}function $v(){return us().memoizedState}function hh(n,r,a,c){var f=Xs();Dt.flags|=n,f.memoizedState=ol(1|r,{destroy:void 0},a,c===void 0?null:c)}function dh(n,r,a,c){var f=us();c=c===void 0?null:c;var m=f.memoizedState.inst;_n!==null&&c!==null&&Hf(c,_n.memoizedState.deps)?f.memoizedState=ol(r,m,a,c):(Dt.flags|=n,f.memoizedState=ol(1|r,m,a,c))}function Wv(n,r){hh(8390656,8,n,r)}function em(n,r){dh(2048,8,n,r)}function ZE(n){Dt.flags|=4;var r=Dt.updateQueue;if(r===null)r=lh(),Dt.updateQueue=r,r.events=[n];else{var a=r.events;a===null?r.events=[n]:a.push(n)}}function Gv(n){var r=us().memoizedState;return ZE({ref:r,nextImpl:n}),function(){if((hn&2)!==0)throw Error(i(440));return r.impl.apply(void 0,arguments)}}function Kv(n,r){return dh(4,2,n,r)}function Yv(n,r){return dh(4,4,n,r)}function Qv(n,r){if(typeof r=="function"){n=n();var a=r(n);return function(){typeof a=="function"?a():r(null)}}if(r!=null)return n=n(),r.current=n,function(){r.current=null}}function Xv(n,r,a){a=a!=null?a.concat([n]):null,dh(4,4,Qv.bind(null,r,n),a)}function tm(){}function Jv(n,r){var a=us();r=r===void 0?null:r;var c=a.memoizedState;return r!==null&&Hf(r,c[1])?c[0]:(a.memoizedState=[n,r],n)}function Zv(n,r){var a=us();r=r===void 0?null:r;var c=a.memoizedState;if(r!==null&&Hf(r,c[1]))return c[0];if(c=n(),yo){st(!0);try{n()}finally{st(!1)}}return a.memoizedState=[c,r],c}function nm(n,r,a){return a===void 0||(Oi&1073741824)!==0&&(qt&261930)===0?n.memoizedState=r:(n.memoizedState=a,n=e1(),Dt.lanes|=n,wa|=n,a)}function e0(n,r,a,c){return pr(a,r)?a:rl.current!==null?(n=nm(n,a,c),pr(n,r)||(gs=!0),n):(Oi&42)===0||(Oi&1073741824)!==0&&(qt&261930)===0?(gs=!0,n.memoizedState=a):(n=e1(),Dt.lanes|=n,wa|=n,r)}function t0(n,r,a,c,f){var m=we.p;we.p=m!==0&&8>m?m:8;var _=Z.T,k={};Z.T=k,im(n,!1,r,a);try{var U=f(),J=Z.S;if(J!==null&&J(k,U),U!==null&&typeof U=="object"&&typeof U.then=="function"){var de=KE(U,c);uc(n,r,de,wr(n))}else uc(n,r,c,wr(n))}catch(ge){uc(n,r,{then:function(){},status:"rejected",reason:ge},wr())}finally{we.p=m,_!==null&&k.types!==null&&(_.types=k.types),Z.T=_}}function eT(){}function sm(n,r,a,c){if(n.tag!==5)throw Error(i(476));var f=n0(n).queue;t0(n,f,r,Ie,a===null?eT:function(){return s0(n),a(c)})}function n0(n){var r=n.memoizedState;if(r!==null)return r;r={memoizedState:Ie,baseState:Ie,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Pi,lastRenderedState:Ie},next:null};var a={};return r.next={memoizedState:a,baseState:a,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Pi,lastRenderedState:a},next:null},n.memoizedState=r,n=n.alternate,n!==null&&(n.memoizedState=r),r}function s0(n){var r=n0(n);r.next===null&&(r=n.alternate.memoizedState),uc(n,r.next.queue,{},wr())}function rm(){return Rs(jc)}function r0(){return us().memoizedState}function i0(){return us().memoizedState}function tT(n){for(var r=n.return;r!==null;){switch(r.tag){case 24:case 3:var a=wr();n=pa(a);var c=ga(r,n,a);c!==null&&(lr(c,r,a),ic(c,r,a)),r={cache:Df()},n.payload=r;return}r=r.return}}function nT(n,r,a){var c=wr();a={lane:c,revertLane:0,gesture:null,action:a,hasEagerState:!1,eagerState:null,next:null},fh(n)?o0(r,a):(a=xf(n,r,a,c),a!==null&&(lr(a,n,c),l0(a,r,c)))}function a0(n,r,a){var c=wr();uc(n,r,a,c)}function uc(n,r,a,c){var f={lane:c,revertLane:0,gesture:null,action:a,hasEagerState:!1,eagerState:null,next:null};if(fh(n))o0(r,f);else{var m=n.alternate;if(n.lanes===0&&(m===null||m.lanes===0)&&(m=r.lastRenderedReducer,m!==null))try{var _=r.lastRenderedState,k=m(_,a);if(f.hasEagerState=!0,f.eagerState=k,pr(k,_))return Gu(n,r,f,0),Sn===null&&Wu(),!1}catch{}if(a=xf(n,r,f,c),a!==null)return lr(a,n,c),l0(a,r,c),!0}return!1}function im(n,r,a,c){if(c={lane:2,revertLane:Pm(),gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},fh(n)){if(r)throw Error(i(479))}else r=xf(n,a,c,2),r!==null&&lr(r,n,2)}function fh(n){var r=n.alternate;return n===Dt||r!==null&&r===Dt}function o0(n,r){il=ah=!0;var a=n.pending;a===null?r.next=r:(r.next=a.next,a.next=r),n.pending=r}function l0(n,r,a){if((a&4194048)!==0){var c=r.lanes;c&=n.pendingLanes,a|=c,r.lanes=a,yn(n,a)}}var hc={readContext:Rs,use:ch,useCallback:Zn,useContext:Zn,useEffect:Zn,useImperativeHandle:Zn,useLayoutEffect:Zn,useInsertionEffect:Zn,useMemo:Zn,useReducer:Zn,useRef:Zn,useState:Zn,useDebugValue:Zn,useDeferredValue:Zn,useTransition:Zn,useSyncExternalStore:Zn,useId:Zn,useHostTransitionStatus:Zn,useFormState:Zn,useActionState:Zn,useOptimistic:Zn,useMemoCache:Zn,useCacheRefresh:Zn};hc.useEffectEvent=Zn;var c0={readContext:Rs,use:ch,useCallback:function(n,r){return Xs().memoizedState=[n,r===void 0?null:r],n},useContext:Rs,useEffect:Wv,useImperativeHandle:function(n,r,a){a=a!=null?a.concat([n]):null,hh(4194308,4,Qv.bind(null,r,n),a)},useLayoutEffect:function(n,r){return hh(4194308,4,n,r)},useInsertionEffect:function(n,r){hh(4,2,n,r)},useMemo:function(n,r){var a=Xs();r=r===void 0?null:r;var c=n();if(yo){st(!0);try{n()}finally{st(!1)}}return a.memoizedState=[c,r],c},useReducer:function(n,r,a){var c=Xs();if(a!==void 0){var f=a(r);if(yo){st(!0);try{a(r)}finally{st(!1)}}}else f=r;return c.memoizedState=c.baseState=f,n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:f},c.queue=n,n=n.dispatch=nT.bind(null,Dt,n),[c.memoizedState,n]},useRef:function(n){var r=Xs();return n={current:n},r.memoizedState=n},useState:function(n){n=Jf(n);var r=n.queue,a=a0.bind(null,Dt,r);return r.dispatch=a,[n.memoizedState,a]},useDebugValue:tm,useDeferredValue:function(n,r){var a=Xs();return nm(a,n,r)},useTransition:function(){var n=Jf(!1);return n=t0.bind(null,Dt,n.queue,!0,!1),Xs().memoizedState=n,[!1,n]},useSyncExternalStore:function(n,r,a){var c=Dt,f=Xs();if(Qt){if(a===void 0)throw Error(i(407));a=a()}else{if(a=r(),Sn===null)throw Error(i(349));(qt&127)!==0||Av(c,r,a)}f.memoizedState=a;var m={value:a,getSnapshot:r};return f.queue=m,Wv(Iv.bind(null,c,m,n),[n]),c.flags|=2048,ol(9,{destroy:void 0},Rv.bind(null,c,m,a,r),null),a},useId:function(){var n=Xs(),r=Sn.identifierPrefix;if(Qt){var a=di,c=hi;a=(c&~(1<<32-Fe(c)-1)).toString(32)+a,r="_"+r+"R_"+a,a=oh++,0<a&&(r+="H"+a.toString(32)),r+="_"}else a=YE++,r="_"+r+"r_"+a.toString(32)+"_";return n.memoizedState=r},useHostTransitionStatus:rm,useFormState:zv,useActionState:zv,useOptimistic:function(n){var r=Xs();r.memoizedState=r.baseState=n;var a={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return r.queue=a,r=im.bind(null,Dt,!0,a),a.dispatch=r,[n,r]},useMemoCache:Yf,useCacheRefresh:function(){return Xs().memoizedState=tT.bind(null,Dt)},useEffectEvent:function(n){var r=Xs(),a={impl:n};return r.memoizedState=a,function(){if((hn&2)!==0)throw Error(i(440));return a.impl.apply(void 0,arguments)}}},am={readContext:Rs,use:ch,useCallback:Jv,useContext:Rs,useEffect:em,useImperativeHandle:Xv,useInsertionEffect:Kv,useLayoutEffect:Yv,useMemo:Zv,useReducer:uh,useRef:$v,useState:function(){return uh(Pi)},useDebugValue:tm,useDeferredValue:function(n,r){var a=us();return e0(a,_n.memoizedState,n,r)},useTransition:function(){var n=uh(Pi)[0],r=us().memoizedState;return[typeof n=="boolean"?n:cc(n),r]},useSyncExternalStore:Nv,useId:r0,useHostTransitionStatus:rm,useFormState:Fv,useActionState:Fv,useOptimistic:function(n,r){var a=us();return Lv(a,_n,n,r)},useMemoCache:Yf,useCacheRefresh:i0};am.useEffectEvent=Gv;var u0={readContext:Rs,use:ch,useCallback:Jv,useContext:Rs,useEffect:em,useImperativeHandle:Xv,useInsertionEffect:Kv,useLayoutEffect:Yv,useMemo:Zv,useReducer:Xf,useRef:$v,useState:function(){return Xf(Pi)},useDebugValue:tm,useDeferredValue:function(n,r){var a=us();return _n===null?nm(a,n,r):e0(a,_n.memoizedState,n,r)},useTransition:function(){var n=Xf(Pi)[0],r=us().memoizedState;return[typeof n=="boolean"?n:cc(n),r]},useSyncExternalStore:Nv,useId:r0,useHostTransitionStatus:rm,useFormState:Hv,useActionState:Hv,useOptimistic:function(n,r){var a=us();return _n!==null?Lv(a,_n,n,r):(a.baseState=n,[n,a.queue.dispatch])},useMemoCache:Yf,useCacheRefresh:i0};u0.useEffectEvent=Gv;function om(n,r,a,c){r=n.memoizedState,a=a(c,r),a=a==null?r:E({},r,a),n.memoizedState=a,n.lanes===0&&(n.updateQueue.baseState=a)}var lm={enqueueSetState:function(n,r,a){n=n._reactInternals;var c=wr(),f=pa(c);f.payload=r,a!=null&&(f.callback=a),r=ga(n,f,c),r!==null&&(lr(r,n,c),ic(r,n,c))},enqueueReplaceState:function(n,r,a){n=n._reactInternals;var c=wr(),f=pa(c);f.tag=1,f.payload=r,a!=null&&(f.callback=a),r=ga(n,f,c),r!==null&&(lr(r,n,c),ic(r,n,c))},enqueueForceUpdate:function(n,r){n=n._reactInternals;var a=wr(),c=pa(a);c.tag=2,r!=null&&(c.callback=r),r=ga(n,c,a),r!==null&&(lr(r,n,a),ic(r,n,a))}};function h0(n,r,a,c,f,m,_){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(c,m,_):r.prototype&&r.prototype.isPureReactComponent?!Xl(a,c)||!Xl(f,m):!0}function d0(n,r,a,c){n=r.state,typeof r.componentWillReceiveProps=="function"&&r.componentWillReceiveProps(a,c),typeof r.UNSAFE_componentWillReceiveProps=="function"&&r.UNSAFE_componentWillReceiveProps(a,c),r.state!==n&&lm.enqueueReplaceState(r,r.state,null)}function vo(n,r){var a=r;if("ref"in r){a={};for(var c in r)c!=="ref"&&(a[c]=r[c])}if(n=n.defaultProps){a===r&&(a=E({},a));for(var f in n)a[f]===void 0&&(a[f]=n[f])}return a}function f0(n){$u(n)}function m0(n){console.error(n)}function p0(n){$u(n)}function mh(n,r){try{var a=n.onUncaughtError;a(r.value,{componentStack:r.stack})}catch(c){setTimeout(function(){throw c})}}function g0(n,r,a){try{var c=n.onCaughtError;c(a.value,{componentStack:a.stack,errorBoundary:r.tag===1?r.stateNode:null})}catch(f){setTimeout(function(){throw f})}}function cm(n,r,a){return a=pa(a),a.tag=3,a.payload={element:null},a.callback=function(){mh(n,r)},a}function y0(n){return n=pa(n),n.tag=3,n}function v0(n,r,a,c){var f=a.type.getDerivedStateFromError;if(typeof f=="function"){var m=c.value;n.payload=function(){return f(m)},n.callback=function(){g0(r,a,c)}}var _=a.stateNode;_!==null&&typeof _.componentDidCatch=="function"&&(n.callback=function(){g0(r,a,c),typeof f!="function"&&(xa===null?xa=new Set([this]):xa.add(this));var k=c.stack;this.componentDidCatch(c.value,{componentStack:k!==null?k:""})})}function sT(n,r,a,c,f){if(a.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){if(r=a.alternate,r!==null&&Zo(r,a,f,!0),a=yr.current,a!==null){switch(a.tag){case 31:case 13:return Br===null?Sh():a.alternate===null&&es===0&&(es=3),a.flags&=-257,a.flags|=65536,a.lanes=f,c===th?a.flags|=16384:(r=a.updateQueue,r===null?a.updateQueue=new Set([c]):r.add(c),Mm(n,c,f)),!1;case 22:return a.flags|=65536,c===th?a.flags|=16384:(r=a.updateQueue,r===null?(r={transitions:null,markerInstances:null,retryQueue:new Set([c])},a.updateQueue=r):(a=r.retryQueue,a===null?r.retryQueue=new Set([c]):a.add(c)),Mm(n,c,f)),!1}throw Error(i(435,a.tag))}return Mm(n,c,f),Sh(),!1}if(Qt)return r=yr.current,r!==null?((r.flags&65536)===0&&(r.flags|=256),r.flags|=65536,r.lanes=f,c!==Cf&&(n=Error(i(422),{cause:c}),ec(Or(n,a)))):(c!==Cf&&(r=Error(i(423),{cause:c}),ec(Or(r,a))),n=n.current.alternate,n.flags|=65536,f&=-f,n.lanes|=f,c=Or(c,a),f=cm(n.stateNode,c,f),Uf(n,f),es!==4&&(es=2)),!1;var m=Error(i(520),{cause:c});if(m=Or(m,a),bc===null?bc=[m]:bc.push(m),es!==4&&(es=2),r===null)return!0;c=Or(c,a),a=r;do{switch(a.tag){case 3:return a.flags|=65536,n=f&-f,a.lanes|=n,n=cm(a.stateNode,c,n),Uf(a,n),!1;case 1:if(r=a.type,m=a.stateNode,(a.flags&128)===0&&(typeof r.getDerivedStateFromError=="function"||m!==null&&typeof m.componentDidCatch=="function"&&(xa===null||!xa.has(m))))return a.flags|=65536,f&=-f,a.lanes|=f,f=y0(f),v0(f,n,a,c),Uf(a,f),!1}a=a.return}while(a!==null);return!1}var um=Error(i(461)),gs=!1;function Is(n,r,a,c){r.child=n===null?xv(r,null,a,c):go(r,n.child,a,c)}function b0(n,r,a,c,f){a=a.render;var m=r.ref;if("ref"in c){var _={};for(var k in c)k!=="ref"&&(_[k]=c[k])}else _=c;return ho(r),c=$f(n,r,a,_,m,f),k=Wf(),n!==null&&!gs?(Gf(n,r,f),Vi(n,r,f)):(Qt&&k&&Sf(r),r.flags|=1,Is(n,r,c,f),r.child)}function _0(n,r,a,c,f){if(n===null){var m=a.type;return typeof m=="function"&&!Ef(m)&&m.defaultProps===void 0&&a.compare===null?(r.tag=15,r.type=m,w0(n,r,m,c,f)):(n=Yu(a.type,null,c,r,r.mode,f),n.ref=r.ref,n.return=r,r.child=n)}if(m=n.child,!vm(n,f)){var _=m.memoizedProps;if(a=a.compare,a=a!==null?a:Xl,a(_,c)&&n.ref===r.ref)return Vi(n,r,f)}return r.flags|=1,n=Ii(m,c),n.ref=r.ref,n.return=r,r.child=n}function w0(n,r,a,c,f){if(n!==null){var m=n.memoizedProps;if(Xl(m,c)&&n.ref===r.ref)if(gs=!1,r.pendingProps=c=m,vm(n,f))(n.flags&131072)!==0&&(gs=!0);else return r.lanes=n.lanes,Vi(n,r,f)}return hm(n,r,a,c,f)}function x0(n,r,a,c){var f=c.children,m=n!==null?n.memoizedState:null;if(n===null&&r.stateNode===null&&(r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),c.mode==="hidden"){if((r.flags&128)!==0){if(m=m!==null?m.baseLanes|a:a,n!==null){for(c=r.child=n.child,f=0;c!==null;)f=f|c.lanes|c.childLanes,c=c.sibling;c=f&~m}else c=0,r.child=null;return E0(n,r,m,a,c)}if((a&536870912)!==0)r.memoizedState={baseLanes:0,cachePool:null},n!==null&&Zu(r,m!==null?m.cachePool:null),m!==null?kv(r,m):zf(),Sv(r);else return c=r.lanes=536870912,E0(n,r,m!==null?m.baseLanes|a:a,a,c)}else m!==null?(Zu(r,m.cachePool),kv(r,m),va(),r.memoizedState=null):(n!==null&&Zu(r,null),zf(),va());return Is(n,r,f,a),r.child}function dc(n,r){return n!==null&&n.tag===22||r.stateNode!==null||(r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),r.sibling}function E0(n,r,a,c,f){var m=Lf();return m=m===null?null:{parent:ms._currentValue,pool:m},r.memoizedState={baseLanes:a,cachePool:m},n!==null&&Zu(r,null),zf(),Sv(r),n!==null&&Zo(n,r,c,!0),r.childLanes=f,null}function ph(n,r){return r=yh({mode:r.mode,children:r.children},n.mode),r.ref=n.ref,n.child=r,r.return=n,r}function T0(n,r,a){return go(r,n.child,null,a),n=ph(r,r.pendingProps),n.flags|=2,vr(r),r.memoizedState=null,n}function rT(n,r,a){var c=r.pendingProps,f=(r.flags&128)!==0;if(r.flags&=-129,n===null){if(Qt){if(c.mode==="hidden")return n=ph(r,c),r.lanes=536870912,dc(null,n);if(qf(r),(n=On)?(n=O1(n,Ur),n=n!==null&&n.data==="&"?n:null,n!==null&&(r.memoizedState={dehydrated:n,treeContext:ua!==null?{id:hi,overflow:di}:null,retryLane:536870912,hydrationErrors:null},a=ov(n),a.return=r,r.child=a,As=r,On=null)):n=null,n===null)throw da(r);return r.lanes=536870912,null}return ph(r,c)}var m=n.memoizedState;if(m!==null){var _=m.dehydrated;if(qf(r),f)if(r.flags&256)r.flags&=-257,r=T0(n,r,a);else if(r.memoizedState!==null)r.child=n.child,r.flags|=128,r=null;else throw Error(i(558));else if(gs||Zo(n,r,a,!1),f=(a&n.childLanes)!==0,gs||f){if(c=Sn,c!==null&&(_=Nn(c,a),_!==0&&_!==m.retryLane))throw m.retryLane=_,oo(n,_),lr(c,n,_),um;Sh(),r=T0(n,r,a)}else n=m.treeContext,On=zr(_.nextSibling),As=r,Qt=!0,ha=null,Ur=!1,n!==null&&uv(r,n),r=ph(r,c),r.flags|=4096;return r}return n=Ii(n.child,{mode:c.mode,children:c.children}),n.ref=r.ref,r.child=n,n.return=r,n}function gh(n,r){var a=r.ref;if(a===null)n!==null&&n.ref!==null&&(r.flags|=4194816);else{if(typeof a!="function"&&typeof a!="object")throw Error(i(284));(n===null||n.ref!==a)&&(r.flags|=4194816)}}function hm(n,r,a,c,f){return ho(r),a=$f(n,r,a,c,void 0,f),c=Wf(),n!==null&&!gs?(Gf(n,r,f),Vi(n,r,f)):(Qt&&c&&Sf(r),r.flags|=1,Is(n,r,a,f),r.child)}function k0(n,r,a,c,f,m){return ho(r),r.updateQueue=null,a=Cv(r,c,a,f),jv(n),c=Wf(),n!==null&&!gs?(Gf(n,r,m),Vi(n,r,m)):(Qt&&c&&Sf(r),r.flags|=1,Is(n,r,a,m),r.child)}function S0(n,r,a,c,f){if(ho(r),r.stateNode===null){var m=Yo,_=a.contextType;typeof _=="object"&&_!==null&&(m=Rs(_)),m=new a(c,m),r.memoizedState=m.state!==null&&m.state!==void 0?m.state:null,m.updater=lm,r.stateNode=m,m._reactInternals=r,m=r.stateNode,m.props=c,m.state=r.memoizedState,m.refs={},Pf(r),_=a.contextType,m.context=typeof _=="object"&&_!==null?Rs(_):Yo,m.state=r.memoizedState,_=a.getDerivedStateFromProps,typeof _=="function"&&(om(r,a,_,c),m.state=r.memoizedState),typeof a.getDerivedStateFromProps=="function"||typeof m.getSnapshotBeforeUpdate=="function"||typeof m.UNSAFE_componentWillMount!="function"&&typeof m.componentWillMount!="function"||(_=m.state,typeof m.componentWillMount=="function"&&m.componentWillMount(),typeof m.UNSAFE_componentWillMount=="function"&&m.UNSAFE_componentWillMount(),_!==m.state&&lm.enqueueReplaceState(m,m.state,null),oc(r,c,m,f),ac(),m.state=r.memoizedState),typeof m.componentDidMount=="function"&&(r.flags|=4194308),c=!0}else if(n===null){m=r.stateNode;var k=r.memoizedProps,U=vo(a,k);m.props=U;var J=m.context,de=a.contextType;_=Yo,typeof de=="object"&&de!==null&&(_=Rs(de));var ge=a.getDerivedStateFromProps;de=typeof ge=="function"||typeof m.getSnapshotBeforeUpdate=="function",k=r.pendingProps!==k,de||typeof m.UNSAFE_componentWillReceiveProps!="function"&&typeof m.componentWillReceiveProps!="function"||(k||J!==_)&&d0(r,m,c,_),ma=!1;var se=r.memoizedState;m.state=se,oc(r,c,m,f),ac(),J=r.memoizedState,k||se!==J||ma?(typeof ge=="function"&&(om(r,a,ge,c),J=r.memoizedState),(U=ma||h0(r,a,U,c,se,J,_))?(de||typeof m.UNSAFE_componentWillMount!="function"&&typeof m.componentWillMount!="function"||(typeof m.componentWillMount=="function"&&m.componentWillMount(),typeof m.UNSAFE_componentWillMount=="function"&&m.UNSAFE_componentWillMount()),typeof m.componentDidMount=="function"&&(r.flags|=4194308)):(typeof m.componentDidMount=="function"&&(r.flags|=4194308),r.memoizedProps=c,r.memoizedState=J),m.props=c,m.state=J,m.context=_,c=U):(typeof m.componentDidMount=="function"&&(r.flags|=4194308),c=!1)}else{m=r.stateNode,Vf(n,r),_=r.memoizedProps,de=vo(a,_),m.props=de,ge=r.pendingProps,se=m.context,J=a.contextType,U=Yo,typeof J=="object"&&J!==null&&(U=Rs(J)),k=a.getDerivedStateFromProps,(J=typeof k=="function"||typeof m.getSnapshotBeforeUpdate=="function")||typeof m.UNSAFE_componentWillReceiveProps!="function"&&typeof m.componentWillReceiveProps!="function"||(_!==ge||se!==U)&&d0(r,m,c,U),ma=!1,se=r.memoizedState,m.state=se,oc(r,c,m,f),ac();var he=r.memoizedState;_!==ge||se!==he||ma||n!==null&&n.dependencies!==null&&Xu(n.dependencies)?(typeof k=="function"&&(om(r,a,k,c),he=r.memoizedState),(de=ma||h0(r,a,de,c,se,he,U)||n!==null&&n.dependencies!==null&&Xu(n.dependencies))?(J||typeof m.UNSAFE_componentWillUpdate!="function"&&typeof m.componentWillUpdate!="function"||(typeof m.componentWillUpdate=="function"&&m.componentWillUpdate(c,he,U),typeof m.UNSAFE_componentWillUpdate=="function"&&m.UNSAFE_componentWillUpdate(c,he,U)),typeof m.componentDidUpdate=="function"&&(r.flags|=4),typeof m.getSnapshotBeforeUpdate=="function"&&(r.flags|=1024)):(typeof m.componentDidUpdate!="function"||_===n.memoizedProps&&se===n.memoizedState||(r.flags|=4),typeof m.getSnapshotBeforeUpdate!="function"||_===n.memoizedProps&&se===n.memoizedState||(r.flags|=1024),r.memoizedProps=c,r.memoizedState=he),m.props=c,m.state=he,m.context=U,c=de):(typeof m.componentDidUpdate!="function"||_===n.memoizedProps&&se===n.memoizedState||(r.flags|=4),typeof m.getSnapshotBeforeUpdate!="function"||_===n.memoizedProps&&se===n.memoizedState||(r.flags|=1024),c=!1)}return m=c,gh(n,r),c=(r.flags&128)!==0,m||c?(m=r.stateNode,a=c&&typeof a.getDerivedStateFromError!="function"?null:m.render(),r.flags|=1,n!==null&&c?(r.child=go(r,n.child,null,f),r.child=go(r,null,a,f)):Is(n,r,a,f),r.memoizedState=m.state,n=r.child):n=Vi(n,r,f),n}function j0(n,r,a,c){return co(),r.flags|=256,Is(n,r,a,c),r.child}var dm={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function fm(n){return{baseLanes:n,cachePool:gv()}}function mm(n,r,a){return n=n!==null?n.childLanes&~a:0,r&&(n|=_r),n}function C0(n,r,a){var c=r.pendingProps,f=!1,m=(r.flags&128)!==0,_;if((_=m)||(_=n!==null&&n.memoizedState===null?!1:(cs.current&2)!==0),_&&(f=!0,r.flags&=-129),_=(r.flags&32)!==0,r.flags&=-33,n===null){if(Qt){if(f?ya(r):va(),(n=On)?(n=O1(n,Ur),n=n!==null&&n.data!=="&"?n:null,n!==null&&(r.memoizedState={dehydrated:n,treeContext:ua!==null?{id:hi,overflow:di}:null,retryLane:536870912,hydrationErrors:null},a=ov(n),a.return=r,r.child=a,As=r,On=null)):n=null,n===null)throw da(r);return Qm(n)?r.lanes=32:r.lanes=536870912,null}var k=c.children;return c=c.fallback,f?(va(),f=r.mode,k=yh({mode:"hidden",children:k},f),c=lo(c,f,a,null),k.return=r,c.return=r,k.sibling=c,r.child=k,c=r.child,c.memoizedState=fm(a),c.childLanes=mm(n,_,a),r.memoizedState=dm,dc(null,c)):(ya(r),pm(r,k))}var U=n.memoizedState;if(U!==null&&(k=U.dehydrated,k!==null)){if(m)r.flags&256?(ya(r),r.flags&=-257,r=gm(n,r,a)):r.memoizedState!==null?(va(),r.child=n.child,r.flags|=128,r=null):(va(),k=c.fallback,f=r.mode,c=yh({mode:"visible",children:c.children},f),k=lo(k,f,a,null),k.flags|=2,c.return=r,k.return=r,c.sibling=k,r.child=c,go(r,n.child,null,a),c=r.child,c.memoizedState=fm(a),c.childLanes=mm(n,_,a),r.memoizedState=dm,r=dc(null,c));else if(ya(r),Qm(k)){if(_=k.nextSibling&&k.nextSibling.dataset,_)var J=_.dgst;_=J,c=Error(i(419)),c.stack="",c.digest=_,ec({value:c,source:null,stack:null}),r=gm(n,r,a)}else if(gs||Zo(n,r,a,!1),_=(a&n.childLanes)!==0,gs||_){if(_=Sn,_!==null&&(c=Nn(_,a),c!==0&&c!==U.retryLane))throw U.retryLane=c,oo(n,c),lr(_,n,c),um;Ym(k)||Sh(),r=gm(n,r,a)}else Ym(k)?(r.flags|=192,r.child=n.child,r=null):(n=U.treeContext,On=zr(k.nextSibling),As=r,Qt=!0,ha=null,Ur=!1,n!==null&&uv(r,n),r=pm(r,c.children),r.flags|=4096);return r}return f?(va(),k=c.fallback,f=r.mode,U=n.child,J=U.sibling,c=Ii(U,{mode:"hidden",children:c.children}),c.subtreeFlags=U.subtreeFlags&65011712,J!==null?k=Ii(J,k):(k=lo(k,f,a,null),k.flags|=2),k.return=r,c.return=r,c.sibling=k,r.child=c,dc(null,c),c=r.child,k=n.child.memoizedState,k===null?k=fm(a):(f=k.cachePool,f!==null?(U=ms._currentValue,f=f.parent!==U?{parent:U,pool:U}:f):f=gv(),k={baseLanes:k.baseLanes|a,cachePool:f}),c.memoizedState=k,c.childLanes=mm(n,_,a),r.memoizedState=dm,dc(n.child,c)):(ya(r),a=n.child,n=a.sibling,a=Ii(a,{mode:"visible",children:c.children}),a.return=r,a.sibling=null,n!==null&&(_=r.deletions,_===null?(r.deletions=[n],r.flags|=16):_.push(n)),r.child=a,r.memoizedState=null,a)}function pm(n,r){return r=yh({mode:"visible",children:r},n.mode),r.return=n,n.child=r}function yh(n,r){return n=gr(22,n,null,r),n.lanes=0,n}function gm(n,r,a){return go(r,n.child,null,a),n=pm(r,r.pendingProps.children),n.flags|=2,r.memoizedState=null,n}function N0(n,r,a){n.lanes|=r;var c=n.alternate;c!==null&&(c.lanes|=r),Rf(n.return,r,a)}function ym(n,r,a,c,f,m){var _=n.memoizedState;_===null?n.memoizedState={isBackwards:r,rendering:null,renderingStartTime:0,last:c,tail:a,tailMode:f,treeForkCount:m}:(_.isBackwards=r,_.rendering=null,_.renderingStartTime=0,_.last=c,_.tail=a,_.tailMode=f,_.treeForkCount=m)}function A0(n,r,a){var c=r.pendingProps,f=c.revealOrder,m=c.tail;c=c.children;var _=cs.current,k=(_&2)!==0;if(k?(_=_&1|2,r.flags|=128):_&=1,_e(cs,_),Is(n,r,c,a),c=Qt?Zl:0,!k&&n!==null&&(n.flags&128)!==0)e:for(n=r.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&N0(n,a,r);else if(n.tag===19)N0(n,a,r);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===r)break e;for(;n.sibling===null;){if(n.return===null||n.return===r)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}switch(f){case"forwards":for(a=r.child,f=null;a!==null;)n=a.alternate,n!==null&&ih(n)===null&&(f=a),a=a.sibling;a=f,a===null?(f=r.child,r.child=null):(f=a.sibling,a.sibling=null),ym(r,!1,f,a,m,c);break;case"backwards":case"unstable_legacy-backwards":for(a=null,f=r.child,r.child=null;f!==null;){if(n=f.alternate,n!==null&&ih(n)===null){r.child=f;break}n=f.sibling,f.sibling=a,a=f,f=n}ym(r,!0,a,null,m,c);break;case"together":ym(r,!1,null,null,void 0,c);break;default:r.memoizedState=null}return r.child}function Vi(n,r,a){if(n!==null&&(r.dependencies=n.dependencies),wa|=r.lanes,(a&r.childLanes)===0)if(n!==null){if(Zo(n,r,a,!1),(a&r.childLanes)===0)return null}else return null;if(n!==null&&r.child!==n.child)throw Error(i(153));if(r.child!==null){for(n=r.child,a=Ii(n,n.pendingProps),r.child=a,a.return=r;n.sibling!==null;)n=n.sibling,a=a.sibling=Ii(n,n.pendingProps),a.return=r;a.sibling=null}return r.child}function vm(n,r){return(n.lanes&r)!==0?!0:(n=n.dependencies,!!(n!==null&&Xu(n)))}function iT(n,r,a){switch(r.tag){case 3:ct(r,r.stateNode.containerInfo),fa(r,ms,n.memoizedState.cache),co();break;case 27:case 5:tn(r);break;case 4:ct(r,r.stateNode.containerInfo);break;case 10:fa(r,r.type,r.memoizedProps.value);break;case 31:if(r.memoizedState!==null)return r.flags|=128,qf(r),null;break;case 13:var c=r.memoizedState;if(c!==null)return c.dehydrated!==null?(ya(r),r.flags|=128,null):(a&r.child.childLanes)!==0?C0(n,r,a):(ya(r),n=Vi(n,r,a),n!==null?n.sibling:null);ya(r);break;case 19:var f=(n.flags&128)!==0;if(c=(a&r.childLanes)!==0,c||(Zo(n,r,a,!1),c=(a&r.childLanes)!==0),f){if(c)return A0(n,r,a);r.flags|=128}if(f=r.memoizedState,f!==null&&(f.rendering=null,f.tail=null,f.lastEffect=null),_e(cs,cs.current),c)break;return null;case 22:return r.lanes=0,x0(n,r,a,r.pendingProps);case 24:fa(r,ms,n.memoizedState.cache)}return Vi(n,r,a)}function R0(n,r,a){if(n!==null)if(n.memoizedProps!==r.pendingProps)gs=!0;else{if(!vm(n,a)&&(r.flags&128)===0)return gs=!1,iT(n,r,a);gs=(n.flags&131072)!==0}else gs=!1,Qt&&(r.flags&1048576)!==0&&cv(r,Zl,r.index);switch(r.lanes=0,r.tag){case 16:e:{var c=r.pendingProps;if(n=mo(r.elementType),r.type=n,typeof n=="function")Ef(n)?(c=vo(n,c),r.tag=1,r=S0(null,r,n,c,a)):(r.tag=0,r=hm(null,r,n,c,a));else{if(n!=null){var f=n.$$typeof;if(f===pe){r.tag=11,r=b0(null,r,n,c,a);break e}else if(f===A){r.tag=14,r=_0(null,r,n,c,a);break e}}throw r=Ue(n)||n,Error(i(306,r,""))}}return r;case 0:return hm(n,r,r.type,r.pendingProps,a);case 1:return c=r.type,f=vo(c,r.pendingProps),S0(n,r,c,f,a);case 3:e:{if(ct(r,r.stateNode.containerInfo),n===null)throw Error(i(387));c=r.pendingProps;var m=r.memoizedState;f=m.element,Vf(n,r),oc(r,c,null,a);var _=r.memoizedState;if(c=_.cache,fa(r,ms,c),c!==m.cache&&If(r,[ms],a,!0),ac(),c=_.element,m.isDehydrated)if(m={element:c,isDehydrated:!1,cache:_.cache},r.updateQueue.baseState=m,r.memoizedState=m,r.flags&256){r=j0(n,r,c,a);break e}else if(c!==f){f=Or(Error(i(424)),r),ec(f),r=j0(n,r,c,a);break e}else for(n=r.stateNode.containerInfo,n.nodeType===9?n=n.body:n=n.nodeName==="HTML"?n.ownerDocument.body:n,On=zr(n.firstChild),As=r,Qt=!0,ha=null,Ur=!0,a=xv(r,null,c,a),r.child=a;a;)a.flags=a.flags&-3|4096,a=a.sibling;else{if(co(),c===f){r=Vi(n,r,a);break e}Is(n,r,c,a)}r=r.child}return r;case 26:return gh(n,r),n===null?(a=F1(r.type,null,r.pendingProps,null))?r.memoizedState=a:Qt||(a=r.type,n=r.pendingProps,c=Dh(xe.current).createElement(a),c[Jt]=r,c[An]=n,Ds(c,a,n),zt(c),r.stateNode=c):r.memoizedState=F1(r.type,n.memoizedProps,r.pendingProps,n.memoizedState),null;case 27:return tn(r),n===null&&Qt&&(c=r.stateNode=U1(r.type,r.pendingProps,xe.current),As=r,Ur=!0,f=On,Sa(r.type)?(Xm=f,On=zr(c.firstChild)):On=f),Is(n,r,r.pendingProps.children,a),gh(n,r),n===null&&(r.flags|=4194304),r.child;case 5:return n===null&&Qt&&((f=c=On)&&(c=LT(c,r.type,r.pendingProps,Ur),c!==null?(r.stateNode=c,As=r,On=zr(c.firstChild),Ur=!1,f=!0):f=!1),f||da(r)),tn(r),f=r.type,m=r.pendingProps,_=n!==null?n.memoizedProps:null,c=m.children,Wm(f,m)?c=null:_!==null&&Wm(f,_)&&(r.flags|=32),r.memoizedState!==null&&(f=$f(n,r,QE,null,null,a),jc._currentValue=f),gh(n,r),Is(n,r,c,a),r.child;case 6:return n===null&&Qt&&((n=a=On)&&(a=OT(a,r.pendingProps,Ur),a!==null?(r.stateNode=a,As=r,On=null,n=!0):n=!1),n||da(r)),null;case 13:return C0(n,r,a);case 4:return ct(r,r.stateNode.containerInfo),c=r.pendingProps,n===null?r.child=go(r,null,c,a):Is(n,r,c,a),r.child;case 11:return b0(n,r,r.type,r.pendingProps,a);case 7:return Is(n,r,r.pendingProps,a),r.child;case 8:return Is(n,r,r.pendingProps.children,a),r.child;case 12:return Is(n,r,r.pendingProps.children,a),r.child;case 10:return c=r.pendingProps,fa(r,r.type,c.value),Is(n,r,c.children,a),r.child;case 9:return f=r.type._context,c=r.pendingProps.children,ho(r),f=Rs(f),c=c(f),r.flags|=1,Is(n,r,c,a),r.child;case 14:return _0(n,r,r.type,r.pendingProps,a);case 15:return w0(n,r,r.type,r.pendingProps,a);case 19:return A0(n,r,a);case 31:return rT(n,r,a);case 22:return x0(n,r,a,r.pendingProps);case 24:return ho(r),c=Rs(ms),n===null?(f=Lf(),f===null&&(f=Sn,m=Df(),f.pooledCache=m,m.refCount++,m!==null&&(f.pooledCacheLanes|=a),f=m),r.memoizedState={parent:c,cache:f},Pf(r),fa(r,ms,f)):((n.lanes&a)!==0&&(Vf(n,r),oc(r,null,null,a),ac()),f=n.memoizedState,m=r.memoizedState,f.parent!==c?(f={parent:c,cache:c},r.memoizedState=f,r.lanes===0&&(r.memoizedState=r.updateQueue.baseState=f),fa(r,ms,c)):(c=m.cache,fa(r,ms,c),c!==f.cache&&If(r,[ms],a,!0))),Is(n,r,r.pendingProps.children,a),r.child;case 29:throw r.pendingProps}throw Error(i(156,r.tag))}function Ui(n){n.flags|=4}function bm(n,r,a,c,f){if((r=(n.mode&32)!==0)&&(r=!1),r){if(n.flags|=16777216,(f&335544128)===f)if(n.stateNode.complete)n.flags|=8192;else if(r1())n.flags|=8192;else throw po=th,Of}else n.flags&=-16777217}function I0(n,r){if(r.type!=="stylesheet"||(r.state.loading&4)!==0)n.flags&=-16777217;else if(n.flags|=16777216,!G1(r))if(r1())n.flags|=8192;else throw po=th,Of}function vh(n,r){r!==null&&(n.flags|=4),n.flags&16384&&(r=n.tag!==22?oe():536870912,n.lanes|=r,hl|=r)}function fc(n,r){if(!Qt)switch(n.tailMode){case"hidden":r=n.tail;for(var a=null;r!==null;)r.alternate!==null&&(a=r),r=r.sibling;a===null?n.tail=null:a.sibling=null;break;case"collapsed":a=n.tail;for(var c=null;a!==null;)a.alternate!==null&&(c=a),a=a.sibling;c===null?r||n.tail===null?n.tail=null:n.tail.sibling=null:c.sibling=null}}function Pn(n){var r=n.alternate!==null&&n.alternate.child===n.child,a=0,c=0;if(r)for(var f=n.child;f!==null;)a|=f.lanes|f.childLanes,c|=f.subtreeFlags&65011712,c|=f.flags&65011712,f.return=n,f=f.sibling;else for(f=n.child;f!==null;)a|=f.lanes|f.childLanes,c|=f.subtreeFlags,c|=f.flags,f.return=n,f=f.sibling;return n.subtreeFlags|=c,n.childLanes=a,r}function aT(n,r,a){var c=r.pendingProps;switch(jf(r),r.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Pn(r),null;case 1:return Pn(r),null;case 3:return a=r.stateNode,c=null,n!==null&&(c=n.memoizedState.cache),r.memoizedState.cache!==c&&(r.flags|=2048),Li(ms),Pe(),a.pendingContext&&(a.context=a.pendingContext,a.pendingContext=null),(n===null||n.child===null)&&(Jo(r)?Ui(r):n===null||n.memoizedState.isDehydrated&&(r.flags&256)===0||(r.flags|=1024,Nf())),Pn(r),null;case 26:var f=r.type,m=r.memoizedState;return n===null?(Ui(r),m!==null?(Pn(r),I0(r,m)):(Pn(r),bm(r,f,null,c,a))):m?m!==n.memoizedState?(Ui(r),Pn(r),I0(r,m)):(Pn(r),r.flags&=-16777217):(n=n.memoizedProps,n!==c&&Ui(r),Pn(r),bm(r,f,n,c,a)),null;case 27:if(jn(r),a=xe.current,f=r.type,n!==null&&r.stateNode!=null)n.memoizedProps!==c&&Ui(r);else{if(!c){if(r.stateNode===null)throw Error(i(166));return Pn(r),null}n=ke.current,Jo(r)?hv(r):(n=U1(f,c,a),r.stateNode=n,Ui(r))}return Pn(r),null;case 5:if(jn(r),f=r.type,n!==null&&r.stateNode!=null)n.memoizedProps!==c&&Ui(r);else{if(!c){if(r.stateNode===null)throw Error(i(166));return Pn(r),null}if(m=ke.current,Jo(r))hv(r);else{var _=Dh(xe.current);switch(m){case 1:m=_.createElementNS("http://www.w3.org/2000/svg",f);break;case 2:m=_.createElementNS("http://www.w3.org/1998/Math/MathML",f);break;default:switch(f){case"svg":m=_.createElementNS("http://www.w3.org/2000/svg",f);break;case"math":m=_.createElementNS("http://www.w3.org/1998/Math/MathML",f);break;case"script":m=_.createElement("div"),m.innerHTML="<script><\/script>",m=m.removeChild(m.firstChild);break;case"select":m=typeof c.is=="string"?_.createElement("select",{is:c.is}):_.createElement("select"),c.multiple?m.multiple=!0:c.size&&(m.size=c.size);break;default:m=typeof c.is=="string"?_.createElement(f,{is:c.is}):_.createElement(f)}}m[Jt]=r,m[An]=c;e:for(_=r.child;_!==null;){if(_.tag===5||_.tag===6)m.appendChild(_.stateNode);else if(_.tag!==4&&_.tag!==27&&_.child!==null){_.child.return=_,_=_.child;continue}if(_===r)break e;for(;_.sibling===null;){if(_.return===null||_.return===r)break e;_=_.return}_.sibling.return=_.return,_=_.sibling}r.stateNode=m;e:switch(Ds(m,f,c),f){case"button":case"input":case"select":case"textarea":c=!!c.autoFocus;break e;case"img":c=!0;break e;default:c=!1}c&&Ui(r)}}return Pn(r),bm(r,r.type,n===null?null:n.memoizedProps,r.pendingProps,a),null;case 6:if(n&&r.stateNode!=null)n.memoizedProps!==c&&Ui(r);else{if(typeof c!="string"&&r.stateNode===null)throw Error(i(166));if(n=xe.current,Jo(r)){if(n=r.stateNode,a=r.memoizedProps,c=null,f=As,f!==null)switch(f.tag){case 27:case 5:c=f.memoizedProps}n[Jt]=r,n=!!(n.nodeValue===a||c!==null&&c.suppressHydrationWarning===!0||C1(n.nodeValue,a)),n||da(r,!0)}else n=Dh(n).createTextNode(c),n[Jt]=r,r.stateNode=n}return Pn(r),null;case 31:if(a=r.memoizedState,n===null||n.memoizedState!==null){if(c=Jo(r),a!==null){if(n===null){if(!c)throw Error(i(318));if(n=r.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(i(557));n[Jt]=r}else co(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;Pn(r),n=!1}else a=Nf(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=a),n=!0;if(!n)return r.flags&256?(vr(r),r):(vr(r),null);if((r.flags&128)!==0)throw Error(i(558))}return Pn(r),null;case 13:if(c=r.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(f=Jo(r),c!==null&&c.dehydrated!==null){if(n===null){if(!f)throw Error(i(318));if(f=r.memoizedState,f=f!==null?f.dehydrated:null,!f)throw Error(i(317));f[Jt]=r}else co(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;Pn(r),f=!1}else f=Nf(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=f),f=!0;if(!f)return r.flags&256?(vr(r),r):(vr(r),null)}return vr(r),(r.flags&128)!==0?(r.lanes=a,r):(a=c!==null,n=n!==null&&n.memoizedState!==null,a&&(c=r.child,f=null,c.alternate!==null&&c.alternate.memoizedState!==null&&c.alternate.memoizedState.cachePool!==null&&(f=c.alternate.memoizedState.cachePool.pool),m=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(m=c.memoizedState.cachePool.pool),m!==f&&(c.flags|=2048)),a!==n&&a&&(r.child.flags|=8192),vh(r,r.updateQueue),Pn(r),null);case 4:return Pe(),n===null&&zm(r.stateNode.containerInfo),Pn(r),null;case 10:return Li(r.type),Pn(r),null;case 19:if(ie(cs),c=r.memoizedState,c===null)return Pn(r),null;if(f=(r.flags&128)!==0,m=c.rendering,m===null)if(f)fc(c,!1);else{if(es!==0||n!==null&&(n.flags&128)!==0)for(n=r.child;n!==null;){if(m=ih(n),m!==null){for(r.flags|=128,fc(c,!1),n=m.updateQueue,r.updateQueue=n,vh(r,n),r.subtreeFlags=0,n=a,a=r.child;a!==null;)av(a,n),a=a.sibling;return _e(cs,cs.current&1|2),Qt&&Di(r,c.treeForkCount),r.child}n=n.sibling}c.tail!==null&&vt()>Eh&&(r.flags|=128,f=!0,fc(c,!1),r.lanes=4194304)}else{if(!f)if(n=ih(m),n!==null){if(r.flags|=128,f=!0,n=n.updateQueue,r.updateQueue=n,vh(r,n),fc(c,!0),c.tail===null&&c.tailMode==="hidden"&&!m.alternate&&!Qt)return Pn(r),null}else 2*vt()-c.renderingStartTime>Eh&&a!==536870912&&(r.flags|=128,f=!0,fc(c,!1),r.lanes=4194304);c.isBackwards?(m.sibling=r.child,r.child=m):(n=c.last,n!==null?n.sibling=m:r.child=m,c.last=m)}return c.tail!==null?(n=c.tail,c.rendering=n,c.tail=n.sibling,c.renderingStartTime=vt(),n.sibling=null,a=cs.current,_e(cs,f?a&1|2:a&1),Qt&&Di(r,c.treeForkCount),n):(Pn(r),null);case 22:case 23:return vr(r),Ff(),c=r.memoizedState!==null,n!==null?n.memoizedState!==null!==c&&(r.flags|=8192):c&&(r.flags|=8192),c?(a&536870912)!==0&&(r.flags&128)===0&&(Pn(r),r.subtreeFlags&6&&(r.flags|=8192)):Pn(r),a=r.updateQueue,a!==null&&vh(r,a.retryQueue),a=null,n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(a=n.memoizedState.cachePool.pool),c=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(c=r.memoizedState.cachePool.pool),c!==a&&(r.flags|=2048),n!==null&&ie(fo),null;case 24:return a=null,n!==null&&(a=n.memoizedState.cache),r.memoizedState.cache!==a&&(r.flags|=2048),Li(ms),Pn(r),null;case 25:return null;case 30:return null}throw Error(i(156,r.tag))}function oT(n,r){switch(jf(r),r.tag){case 1:return n=r.flags,n&65536?(r.flags=n&-65537|128,r):null;case 3:return Li(ms),Pe(),n=r.flags,(n&65536)!==0&&(n&128)===0?(r.flags=n&-65537|128,r):null;case 26:case 27:case 5:return jn(r),null;case 31:if(r.memoizedState!==null){if(vr(r),r.alternate===null)throw Error(i(340));co()}return n=r.flags,n&65536?(r.flags=n&-65537|128,r):null;case 13:if(vr(r),n=r.memoizedState,n!==null&&n.dehydrated!==null){if(r.alternate===null)throw Error(i(340));co()}return n=r.flags,n&65536?(r.flags=n&-65537|128,r):null;case 19:return ie(cs),null;case 4:return Pe(),null;case 10:return Li(r.type),null;case 22:case 23:return vr(r),Ff(),n!==null&&ie(fo),n=r.flags,n&65536?(r.flags=n&-65537|128,r):null;case 24:return Li(ms),null;case 25:return null;default:return null}}function D0(n,r){switch(jf(r),r.tag){case 3:Li(ms),Pe();break;case 26:case 27:case 5:jn(r);break;case 4:Pe();break;case 31:r.memoizedState!==null&&vr(r);break;case 13:vr(r);break;case 19:ie(cs);break;case 10:Li(r.type);break;case 22:case 23:vr(r),Ff(),n!==null&&ie(fo);break;case 24:Li(ms)}}function mc(n,r){try{var a=r.updateQueue,c=a!==null?a.lastEffect:null;if(c!==null){var f=c.next;a=f;do{if((a.tag&n)===n){c=void 0;var m=a.create,_=a.inst;c=m(),_.destroy=c}a=a.next}while(a!==f)}}catch(k){gn(r,r.return,k)}}function ba(n,r,a){try{var c=r.updateQueue,f=c!==null?c.lastEffect:null;if(f!==null){var m=f.next;c=m;do{if((c.tag&n)===n){var _=c.inst,k=_.destroy;if(k!==void 0){_.destroy=void 0,f=r;var U=a,J=k;try{J()}catch(de){gn(f,U,de)}}}c=c.next}while(c!==m)}}catch(de){gn(r,r.return,de)}}function M0(n){var r=n.updateQueue;if(r!==null){var a=n.stateNode;try{Tv(r,a)}catch(c){gn(n,n.return,c)}}}function L0(n,r,a){a.props=vo(n.type,n.memoizedProps),a.state=n.memoizedState;try{a.componentWillUnmount()}catch(c){gn(n,r,c)}}function pc(n,r){try{var a=n.ref;if(a!==null){switch(n.tag){case 26:case 27:case 5:var c=n.stateNode;break;case 30:c=n.stateNode;break;default:c=n.stateNode}typeof a=="function"?n.refCleanup=a(c):a.current=c}}catch(f){gn(n,r,f)}}function fi(n,r){var a=n.ref,c=n.refCleanup;if(a!==null)if(typeof c=="function")try{c()}catch(f){gn(n,r,f)}finally{n.refCleanup=null,n=n.alternate,n!=null&&(n.refCleanup=null)}else if(typeof a=="function")try{a(null)}catch(f){gn(n,r,f)}else a.current=null}function O0(n){var r=n.type,a=n.memoizedProps,c=n.stateNode;try{e:switch(r){case"button":case"input":case"select":case"textarea":a.autoFocus&&c.focus();break e;case"img":a.src?c.src=a.src:a.srcSet&&(c.srcset=a.srcSet)}}catch(f){gn(n,n.return,f)}}function _m(n,r,a){try{var c=n.stateNode;NT(c,n.type,a,r),c[An]=r}catch(f){gn(n,n.return,f)}}function P0(n){return n.tag===5||n.tag===3||n.tag===26||n.tag===27&&Sa(n.type)||n.tag===4}function wm(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||P0(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.tag===27&&Sa(n.type)||n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function xm(n,r,a){var c=n.tag;if(c===5||c===6)n=n.stateNode,r?(a.nodeType===9?a.body:a.nodeName==="HTML"?a.ownerDocument.body:a).insertBefore(n,r):(r=a.nodeType===9?a.body:a.nodeName==="HTML"?a.ownerDocument.body:a,r.appendChild(n),a=a._reactRootContainer,a!=null||r.onclick!==null||(r.onclick=dt));else if(c!==4&&(c===27&&Sa(n.type)&&(a=n.stateNode,r=null),n=n.child,n!==null))for(xm(n,r,a),n=n.sibling;n!==null;)xm(n,r,a),n=n.sibling}function bh(n,r,a){var c=n.tag;if(c===5||c===6)n=n.stateNode,r?a.insertBefore(n,r):a.appendChild(n);else if(c!==4&&(c===27&&Sa(n.type)&&(a=n.stateNode),n=n.child,n!==null))for(bh(n,r,a),n=n.sibling;n!==null;)bh(n,r,a),n=n.sibling}function V0(n){var r=n.stateNode,a=n.memoizedProps;try{for(var c=n.type,f=r.attributes;f.length;)r.removeAttributeNode(f[0]);Ds(r,c,a),r[Jt]=n,r[An]=a}catch(m){gn(n,n.return,m)}}var Bi=!1,ys=!1,Em=!1,U0=typeof WeakSet=="function"?WeakSet:Set,ks=null;function lT(n,r){if(n=n.containerInfo,Hm=Bh,n=Xy(n),gf(n)){if("selectionStart"in n)var a={start:n.selectionStart,end:n.selectionEnd};else e:{a=(a=n.ownerDocument)&&a.defaultView||window;var c=a.getSelection&&a.getSelection();if(c&&c.rangeCount!==0){a=c.anchorNode;var f=c.anchorOffset,m=c.focusNode;c=c.focusOffset;try{a.nodeType,m.nodeType}catch{a=null;break e}var _=0,k=-1,U=-1,J=0,de=0,ge=n,se=null;t:for(;;){for(var he;ge!==a||f!==0&&ge.nodeType!==3||(k=_+f),ge!==m||c!==0&&ge.nodeType!==3||(U=_+c),ge.nodeType===3&&(_+=ge.nodeValue.length),(he=ge.firstChild)!==null;)se=ge,ge=he;for(;;){if(ge===n)break t;if(se===a&&++J===f&&(k=_),se===m&&++de===c&&(U=_),(he=ge.nextSibling)!==null)break;ge=se,se=ge.parentNode}ge=he}a=k===-1||U===-1?null:{start:k,end:U}}else a=null}a=a||{start:0,end:0}}else a=null;for($m={focusedElem:n,selectionRange:a},Bh=!1,ks=r;ks!==null;)if(r=ks,n=r.child,(r.subtreeFlags&1028)!==0&&n!==null)n.return=r,ks=n;else for(;ks!==null;){switch(r=ks,m=r.alternate,n=r.flags,r.tag){case 0:if((n&4)!==0&&(n=r.updateQueue,n=n!==null?n.events:null,n!==null))for(a=0;a<n.length;a++)f=n[a],f.ref.impl=f.nextImpl;break;case 11:case 15:break;case 1:if((n&1024)!==0&&m!==null){n=void 0,a=r,f=m.memoizedProps,m=m.memoizedState,c=a.stateNode;try{var Xe=vo(a.type,f);n=c.getSnapshotBeforeUpdate(Xe,m),c.__reactInternalSnapshotBeforeUpdate=n}catch(ft){gn(a,a.return,ft)}}break;case 3:if((n&1024)!==0){if(n=r.stateNode.containerInfo,a=n.nodeType,a===9)Km(n);else if(a===1)switch(n.nodeName){case"HEAD":case"HTML":case"BODY":Km(n);break;default:n.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((n&1024)!==0)throw Error(i(163))}if(n=r.sibling,n!==null){n.return=r.return,ks=n;break}ks=r.return}}function B0(n,r,a){var c=a.flags;switch(a.tag){case 0:case 11:case 15:Fi(n,a),c&4&&mc(5,a);break;case 1:if(Fi(n,a),c&4)if(n=a.stateNode,r===null)try{n.componentDidMount()}catch(_){gn(a,a.return,_)}else{var f=vo(a.type,r.memoizedProps);r=r.memoizedState;try{n.componentDidUpdate(f,r,n.__reactInternalSnapshotBeforeUpdate)}catch(_){gn(a,a.return,_)}}c&64&&M0(a),c&512&&pc(a,a.return);break;case 3:if(Fi(n,a),c&64&&(n=a.updateQueue,n!==null)){if(r=null,a.child!==null)switch(a.child.tag){case 27:case 5:r=a.child.stateNode;break;case 1:r=a.child.stateNode}try{Tv(n,r)}catch(_){gn(a,a.return,_)}}break;case 27:r===null&&c&4&&V0(a);case 26:case 5:Fi(n,a),r===null&&c&4&&O0(a),c&512&&pc(a,a.return);break;case 12:Fi(n,a);break;case 31:Fi(n,a),c&4&&q0(n,a);break;case 13:Fi(n,a),c&4&&H0(n,a),c&64&&(n=a.memoizedState,n!==null&&(n=n.dehydrated,n!==null&&(a=yT.bind(null,a),PT(n,a))));break;case 22:if(c=a.memoizedState!==null||Bi,!c){r=r!==null&&r.memoizedState!==null||ys,f=Bi;var m=ys;Bi=c,(ys=r)&&!m?qi(n,a,(a.subtreeFlags&8772)!==0):Fi(n,a),Bi=f,ys=m}break;case 30:break;default:Fi(n,a)}}function z0(n){var r=n.alternate;r!==null&&(n.alternate=null,z0(r)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(r=n.stateNode,r!==null&&Ks(r)),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}var Wn=null,rr=!1;function zi(n,r,a){for(a=a.child;a!==null;)F0(n,r,a),a=a.sibling}function F0(n,r,a){if($e&&typeof $e.onCommitFiberUnmount=="function")try{$e.onCommitFiberUnmount(it,a)}catch{}switch(a.tag){case 26:ys||fi(a,r),zi(n,r,a),a.memoizedState?a.memoizedState.count--:a.stateNode&&(a=a.stateNode,a.parentNode.removeChild(a));break;case 27:ys||fi(a,r);var c=Wn,f=rr;Sa(a.type)&&(Wn=a.stateNode,rr=!1),zi(n,r,a),Tc(a.stateNode),Wn=c,rr=f;break;case 5:ys||fi(a,r);case 6:if(c=Wn,f=rr,Wn=null,zi(n,r,a),Wn=c,rr=f,Wn!==null)if(rr)try{(Wn.nodeType===9?Wn.body:Wn.nodeName==="HTML"?Wn.ownerDocument.body:Wn).removeChild(a.stateNode)}catch(m){gn(a,r,m)}else try{Wn.removeChild(a.stateNode)}catch(m){gn(a,r,m)}break;case 18:Wn!==null&&(rr?(n=Wn,M1(n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n,a.stateNode),bl(n)):M1(Wn,a.stateNode));break;case 4:c=Wn,f=rr,Wn=a.stateNode.containerInfo,rr=!0,zi(n,r,a),Wn=c,rr=f;break;case 0:case 11:case 14:case 15:ba(2,a,r),ys||ba(4,a,r),zi(n,r,a);break;case 1:ys||(fi(a,r),c=a.stateNode,typeof c.componentWillUnmount=="function"&&L0(a,r,c)),zi(n,r,a);break;case 21:zi(n,r,a);break;case 22:ys=(c=ys)||a.memoizedState!==null,zi(n,r,a),ys=c;break;default:zi(n,r,a)}}function q0(n,r){if(r.memoizedState===null&&(n=r.alternate,n!==null&&(n=n.memoizedState,n!==null))){n=n.dehydrated;try{bl(n)}catch(a){gn(r,r.return,a)}}}function H0(n,r){if(r.memoizedState===null&&(n=r.alternate,n!==null&&(n=n.memoizedState,n!==null&&(n=n.dehydrated,n!==null))))try{bl(n)}catch(a){gn(r,r.return,a)}}function cT(n){switch(n.tag){case 31:case 13:case 19:var r=n.stateNode;return r===null&&(r=n.stateNode=new U0),r;case 22:return n=n.stateNode,r=n._retryCache,r===null&&(r=n._retryCache=new U0),r;default:throw Error(i(435,n.tag))}}function _h(n,r){var a=cT(n);r.forEach(function(c){if(!a.has(c)){a.add(c);var f=vT.bind(null,n,c);c.then(f,f)}})}function ir(n,r){var a=r.deletions;if(a!==null)for(var c=0;c<a.length;c++){var f=a[c],m=n,_=r,k=_;e:for(;k!==null;){switch(k.tag){case 27:if(Sa(k.type)){Wn=k.stateNode,rr=!1;break e}break;case 5:Wn=k.stateNode,rr=!1;break e;case 3:case 4:Wn=k.stateNode.containerInfo,rr=!0;break e}k=k.return}if(Wn===null)throw Error(i(160));F0(m,_,f),Wn=null,rr=!1,m=f.alternate,m!==null&&(m.return=null),f.return=null}if(r.subtreeFlags&13886)for(r=r.child;r!==null;)$0(r,n),r=r.sibling}var Xr=null;function $0(n,r){var a=n.alternate,c=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:ir(r,n),ar(n),c&4&&(ba(3,n,n.return),mc(3,n),ba(5,n,n.return));break;case 1:ir(r,n),ar(n),c&512&&(ys||a===null||fi(a,a.return)),c&64&&Bi&&(n=n.updateQueue,n!==null&&(c=n.callbacks,c!==null&&(a=n.shared.hiddenCallbacks,n.shared.hiddenCallbacks=a===null?c:a.concat(c))));break;case 26:var f=Xr;if(ir(r,n),ar(n),c&512&&(ys||a===null||fi(a,a.return)),c&4){var m=a!==null?a.memoizedState:null;if(c=n.memoizedState,a===null)if(c===null)if(n.stateNode===null){e:{c=n.type,a=n.memoizedProps,f=f.ownerDocument||f;t:switch(c){case"title":m=f.getElementsByTagName("title")[0],(!m||m[qn]||m[Jt]||m.namespaceURI==="http://www.w3.org/2000/svg"||m.hasAttribute("itemprop"))&&(m=f.createElement(c),f.head.insertBefore(m,f.querySelector("head > title"))),Ds(m,c,a),m[Jt]=n,zt(m),c=m;break e;case"link":var _=$1("link","href",f).get(c+(a.href||""));if(_){for(var k=0;k<_.length;k++)if(m=_[k],m.getAttribute("href")===(a.href==null||a.href===""?null:a.href)&&m.getAttribute("rel")===(a.rel==null?null:a.rel)&&m.getAttribute("title")===(a.title==null?null:a.title)&&m.getAttribute("crossorigin")===(a.crossOrigin==null?null:a.crossOrigin)){_.splice(k,1);break t}}m=f.createElement(c),Ds(m,c,a),f.head.appendChild(m);break;case"meta":if(_=$1("meta","content",f).get(c+(a.content||""))){for(k=0;k<_.length;k++)if(m=_[k],m.getAttribute("content")===(a.content==null?null:""+a.content)&&m.getAttribute("name")===(a.name==null?null:a.name)&&m.getAttribute("property")===(a.property==null?null:a.property)&&m.getAttribute("http-equiv")===(a.httpEquiv==null?null:a.httpEquiv)&&m.getAttribute("charset")===(a.charSet==null?null:a.charSet)){_.splice(k,1);break t}}m=f.createElement(c),Ds(m,c,a),f.head.appendChild(m);break;default:throw Error(i(468,c))}m[Jt]=n,zt(m),c=m}n.stateNode=c}else W1(f,n.type,n.stateNode);else n.stateNode=H1(f,c,n.memoizedProps);else m!==c?(m===null?a.stateNode!==null&&(a=a.stateNode,a.parentNode.removeChild(a)):m.count--,c===null?W1(f,n.type,n.stateNode):H1(f,c,n.memoizedProps)):c===null&&n.stateNode!==null&&_m(n,n.memoizedProps,a.memoizedProps)}break;case 27:ir(r,n),ar(n),c&512&&(ys||a===null||fi(a,a.return)),a!==null&&c&4&&_m(n,n.memoizedProps,a.memoizedProps);break;case 5:if(ir(r,n),ar(n),c&512&&(ys||a===null||fi(a,a.return)),n.flags&32){f=n.stateNode;try{j(f,"")}catch(Xe){gn(n,n.return,Xe)}}c&4&&n.stateNode!=null&&(f=n.memoizedProps,_m(n,f,a!==null?a.memoizedProps:f)),c&1024&&(Em=!0);break;case 6:if(ir(r,n),ar(n),c&4){if(n.stateNode===null)throw Error(i(162));c=n.memoizedProps,a=n.stateNode;try{a.nodeValue=c}catch(Xe){gn(n,n.return,Xe)}}break;case 3:if(Oh=null,f=Xr,Xr=Mh(r.containerInfo),ir(r,n),Xr=f,ar(n),c&4&&a!==null&&a.memoizedState.isDehydrated)try{bl(r.containerInfo)}catch(Xe){gn(n,n.return,Xe)}Em&&(Em=!1,W0(n));break;case 4:c=Xr,Xr=Mh(n.stateNode.containerInfo),ir(r,n),ar(n),Xr=c;break;case 12:ir(r,n),ar(n);break;case 31:ir(r,n),ar(n),c&4&&(c=n.updateQueue,c!==null&&(n.updateQueue=null,_h(n,c)));break;case 13:ir(r,n),ar(n),n.child.flags&8192&&n.memoizedState!==null!=(a!==null&&a.memoizedState!==null)&&(xh=vt()),c&4&&(c=n.updateQueue,c!==null&&(n.updateQueue=null,_h(n,c)));break;case 22:f=n.memoizedState!==null;var U=a!==null&&a.memoizedState!==null,J=Bi,de=ys;if(Bi=J||f,ys=de||U,ir(r,n),ys=de,Bi=J,ar(n),c&8192)e:for(r=n.stateNode,r._visibility=f?r._visibility&-2:r._visibility|1,f&&(a===null||U||Bi||ys||bo(n)),a=null,r=n;;){if(r.tag===5||r.tag===26){if(a===null){U=a=r;try{if(m=U.stateNode,f)_=m.style,typeof _.setProperty=="function"?_.setProperty("display","none","important"):_.display="none";else{k=U.stateNode;var ge=U.memoizedProps.style,se=ge!=null&&ge.hasOwnProperty("display")?ge.display:null;k.style.display=se==null||typeof se=="boolean"?"":(""+se).trim()}}catch(Xe){gn(U,U.return,Xe)}}}else if(r.tag===6){if(a===null){U=r;try{U.stateNode.nodeValue=f?"":U.memoizedProps}catch(Xe){gn(U,U.return,Xe)}}}else if(r.tag===18){if(a===null){U=r;try{var he=U.stateNode;f?L1(he,!0):L1(U.stateNode,!1)}catch(Xe){gn(U,U.return,Xe)}}}else if((r.tag!==22&&r.tag!==23||r.memoizedState===null||r===n)&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===n)break e;for(;r.sibling===null;){if(r.return===null||r.return===n)break e;a===r&&(a=null),r=r.return}a===r&&(a=null),r.sibling.return=r.return,r=r.sibling}c&4&&(c=n.updateQueue,c!==null&&(a=c.retryQueue,a!==null&&(c.retryQueue=null,_h(n,a))));break;case 19:ir(r,n),ar(n),c&4&&(c=n.updateQueue,c!==null&&(n.updateQueue=null,_h(n,c)));break;case 30:break;case 21:break;default:ir(r,n),ar(n)}}function ar(n){var r=n.flags;if(r&2){try{for(var a,c=n.return;c!==null;){if(P0(c)){a=c;break}c=c.return}if(a==null)throw Error(i(160));switch(a.tag){case 27:var f=a.stateNode,m=wm(n);bh(n,m,f);break;case 5:var _=a.stateNode;a.flags&32&&(j(_,""),a.flags&=-33);var k=wm(n);bh(n,k,_);break;case 3:case 4:var U=a.stateNode.containerInfo,J=wm(n);xm(n,J,U);break;default:throw Error(i(161))}}catch(de){gn(n,n.return,de)}n.flags&=-3}r&4096&&(n.flags&=-4097)}function W0(n){if(n.subtreeFlags&1024)for(n=n.child;n!==null;){var r=n;W0(r),r.tag===5&&r.flags&1024&&r.stateNode.reset(),n=n.sibling}}function Fi(n,r){if(r.subtreeFlags&8772)for(r=r.child;r!==null;)B0(n,r.alternate,r),r=r.sibling}function bo(n){for(n=n.child;n!==null;){var r=n;switch(r.tag){case 0:case 11:case 14:case 15:ba(4,r,r.return),bo(r);break;case 1:fi(r,r.return);var a=r.stateNode;typeof a.componentWillUnmount=="function"&&L0(r,r.return,a),bo(r);break;case 27:Tc(r.stateNode);case 26:case 5:fi(r,r.return),bo(r);break;case 22:r.memoizedState===null&&bo(r);break;case 30:bo(r);break;default:bo(r)}n=n.sibling}}function qi(n,r,a){for(a=a&&(r.subtreeFlags&8772)!==0,r=r.child;r!==null;){var c=r.alternate,f=n,m=r,_=m.flags;switch(m.tag){case 0:case 11:case 15:qi(f,m,a),mc(4,m);break;case 1:if(qi(f,m,a),c=m,f=c.stateNode,typeof f.componentDidMount=="function")try{f.componentDidMount()}catch(J){gn(c,c.return,J)}if(c=m,f=c.updateQueue,f!==null){var k=c.stateNode;try{var U=f.shared.hiddenCallbacks;if(U!==null)for(f.shared.hiddenCallbacks=null,f=0;f<U.length;f++)Ev(U[f],k)}catch(J){gn(c,c.return,J)}}a&&_&64&&M0(m),pc(m,m.return);break;case 27:V0(m);case 26:case 5:qi(f,m,a),a&&c===null&&_&4&&O0(m),pc(m,m.return);break;case 12:qi(f,m,a);break;case 31:qi(f,m,a),a&&_&4&&q0(f,m);break;case 13:qi(f,m,a),a&&_&4&&H0(f,m);break;case 22:m.memoizedState===null&&qi(f,m,a),pc(m,m.return);break;case 30:break;default:qi(f,m,a)}r=r.sibling}}function Tm(n,r){var a=null;n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(a=n.memoizedState.cachePool.pool),n=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(n=r.memoizedState.cachePool.pool),n!==a&&(n!=null&&n.refCount++,a!=null&&tc(a))}function km(n,r){n=null,r.alternate!==null&&(n=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==n&&(r.refCount++,n!=null&&tc(n))}function Jr(n,r,a,c){if(r.subtreeFlags&10256)for(r=r.child;r!==null;)G0(n,r,a,c),r=r.sibling}function G0(n,r,a,c){var f=r.flags;switch(r.tag){case 0:case 11:case 15:Jr(n,r,a,c),f&2048&&mc(9,r);break;case 1:Jr(n,r,a,c);break;case 3:Jr(n,r,a,c),f&2048&&(n=null,r.alternate!==null&&(n=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==n&&(r.refCount++,n!=null&&tc(n)));break;case 12:if(f&2048){Jr(n,r,a,c),n=r.stateNode;try{var m=r.memoizedProps,_=m.id,k=m.onPostCommit;typeof k=="function"&&k(_,r.alternate===null?"mount":"update",n.passiveEffectDuration,-0)}catch(U){gn(r,r.return,U)}}else Jr(n,r,a,c);break;case 31:Jr(n,r,a,c);break;case 13:Jr(n,r,a,c);break;case 23:break;case 22:m=r.stateNode,_=r.alternate,r.memoizedState!==null?m._visibility&2?Jr(n,r,a,c):gc(n,r):m._visibility&2?Jr(n,r,a,c):(m._visibility|=2,ll(n,r,a,c,(r.subtreeFlags&10256)!==0||!1)),f&2048&&Tm(_,r);break;case 24:Jr(n,r,a,c),f&2048&&km(r.alternate,r);break;default:Jr(n,r,a,c)}}function ll(n,r,a,c,f){for(f=f&&((r.subtreeFlags&10256)!==0||!1),r=r.child;r!==null;){var m=n,_=r,k=a,U=c,J=_.flags;switch(_.tag){case 0:case 11:case 15:ll(m,_,k,U,f),mc(8,_);break;case 23:break;case 22:var de=_.stateNode;_.memoizedState!==null?de._visibility&2?ll(m,_,k,U,f):gc(m,_):(de._visibility|=2,ll(m,_,k,U,f)),f&&J&2048&&Tm(_.alternate,_);break;case 24:ll(m,_,k,U,f),f&&J&2048&&km(_.alternate,_);break;default:ll(m,_,k,U,f)}r=r.sibling}}function gc(n,r){if(r.subtreeFlags&10256)for(r=r.child;r!==null;){var a=n,c=r,f=c.flags;switch(c.tag){case 22:gc(a,c),f&2048&&Tm(c.alternate,c);break;case 24:gc(a,c),f&2048&&km(c.alternate,c);break;default:gc(a,c)}r=r.sibling}}var yc=8192;function cl(n,r,a){if(n.subtreeFlags&yc)for(n=n.child;n!==null;)K0(n,r,a),n=n.sibling}function K0(n,r,a){switch(n.tag){case 26:cl(n,r,a),n.flags&yc&&n.memoizedState!==null&&YT(a,Xr,n.memoizedState,n.memoizedProps);break;case 5:cl(n,r,a);break;case 3:case 4:var c=Xr;Xr=Mh(n.stateNode.containerInfo),cl(n,r,a),Xr=c;break;case 22:n.memoizedState===null&&(c=n.alternate,c!==null&&c.memoizedState!==null?(c=yc,yc=16777216,cl(n,r,a),yc=c):cl(n,r,a));break;default:cl(n,r,a)}}function Y0(n){var r=n.alternate;if(r!==null&&(n=r.child,n!==null)){r.child=null;do r=n.sibling,n.sibling=null,n=r;while(n!==null)}}function vc(n){var r=n.deletions;if((n.flags&16)!==0){if(r!==null)for(var a=0;a<r.length;a++){var c=r[a];ks=c,X0(c,n)}Y0(n)}if(n.subtreeFlags&10256)for(n=n.child;n!==null;)Q0(n),n=n.sibling}function Q0(n){switch(n.tag){case 0:case 11:case 15:vc(n),n.flags&2048&&ba(9,n,n.return);break;case 3:vc(n);break;case 12:vc(n);break;case 22:var r=n.stateNode;n.memoizedState!==null&&r._visibility&2&&(n.return===null||n.return.tag!==13)?(r._visibility&=-3,wh(n)):vc(n);break;default:vc(n)}}function wh(n){var r=n.deletions;if((n.flags&16)!==0){if(r!==null)for(var a=0;a<r.length;a++){var c=r[a];ks=c,X0(c,n)}Y0(n)}for(n=n.child;n!==null;){switch(r=n,r.tag){case 0:case 11:case 15:ba(8,r,r.return),wh(r);break;case 22:a=r.stateNode,a._visibility&2&&(a._visibility&=-3,wh(r));break;default:wh(r)}n=n.sibling}}function X0(n,r){for(;ks!==null;){var a=ks;switch(a.tag){case 0:case 11:case 15:ba(8,a,r);break;case 23:case 22:if(a.memoizedState!==null&&a.memoizedState.cachePool!==null){var c=a.memoizedState.cachePool.pool;c!=null&&c.refCount++}break;case 24:tc(a.memoizedState.cache)}if(c=a.child,c!==null)c.return=a,ks=c;else e:for(a=n;ks!==null;){c=ks;var f=c.sibling,m=c.return;if(z0(c),c===a){ks=null;break e}if(f!==null){f.return=m,ks=f;break e}ks=m}}}var uT={getCacheForType:function(n){var r=Rs(ms),a=r.data.get(n);return a===void 0&&(a=n(),r.data.set(n,a)),a},cacheSignal:function(){return Rs(ms).controller.signal}},hT=typeof WeakMap=="function"?WeakMap:Map,hn=0,Sn=null,Ut=null,qt=0,pn=0,br=null,_a=!1,ul=!1,Sm=!1,Hi=0,es=0,wa=0,_o=0,jm=0,_r=0,hl=0,bc=null,or=null,Cm=!1,xh=0,J0=0,Eh=1/0,Th=null,xa=null,Es=0,Ea=null,dl=null,$i=0,Nm=0,Am=null,Z0=null,_c=0,Rm=null;function wr(){return(hn&2)!==0&&qt!==0?qt&-qt:Z.T!==null?Pm():Cs()}function e1(){if(_r===0)if((qt&536870912)===0||Qt){var n=Xn;Xn<<=1,(Xn&3932160)===0&&(Xn=262144),_r=n}else _r=536870912;return n=yr.current,n!==null&&(n.flags|=32),_r}function lr(n,r,a){(n===Sn&&(pn===2||pn===9)||n.cancelPendingCommit!==null)&&(fl(n,0),Ta(n,qt,_r,!1)),Ge(n,a),((hn&2)===0||n!==Sn)&&(n===Sn&&((hn&2)===0&&(_o|=a),es===4&&Ta(n,qt,_r,!1)),mi(n))}function t1(n,r,a){if((hn&6)!==0)throw Error(i(327));var c=!a&&(r&127)===0&&(r&n.expiredLanes)===0||ln(n,r),f=c?mT(n,r):Dm(n,r,!0),m=c;do{if(f===0){ul&&!c&&Ta(n,r,0,!1);break}else{if(a=n.current.alternate,m&&!dT(a)){f=Dm(n,r,!1),m=!1;continue}if(f===2){if(m=r,n.errorRecoveryDisabledLanes&m)var _=0;else _=n.pendingLanes&-536870913,_=_!==0?_:_&536870912?536870912:0;if(_!==0){r=_;e:{var k=n;f=bc;var U=k.current.memoizedState.isDehydrated;if(U&&(fl(k,_).flags|=256),_=Dm(k,_,!1),_!==2){if(Sm&&!U){k.errorRecoveryDisabledLanes|=m,_o|=m,f=4;break e}m=or,or=f,m!==null&&(or===null?or=m:or.push.apply(or,m))}f=_}if(m=!1,f!==2)continue}}if(f===1){fl(n,0),Ta(n,r,0,!0);break}e:{switch(c=n,m=f,m){case 0:case 1:throw Error(i(345));case 4:if((r&4194048)!==r)break;case 6:Ta(c,r,_r,!_a);break e;case 2:or=null;break;case 3:case 5:break;default:throw Error(i(329))}if((r&62914560)===r&&(f=xh+300-vt(),10<f)){if(Ta(c,r,_r,!_a),Cn(c,0,!0)!==0)break e;$i=r,c.timeoutHandle=I1(n1.bind(null,c,a,or,Th,Cm,r,_r,_o,hl,_a,m,"Throttled",-0,0),f);break e}n1(c,a,or,Th,Cm,r,_r,_o,hl,_a,m,null,-0,0)}}break}while(!0);mi(n)}function n1(n,r,a,c,f,m,_,k,U,J,de,ge,se,he){if(n.timeoutHandle=-1,ge=r.subtreeFlags,ge&8192||(ge&16785408)===16785408){ge={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:dt},K0(r,m,ge);var Xe=(m&62914560)===m?xh-vt():(m&4194048)===m?J0-vt():0;if(Xe=QT(ge,Xe),Xe!==null){$i=m,n.cancelPendingCommit=Xe(u1.bind(null,n,r,m,a,c,f,_,k,U,de,ge,null,se,he)),Ta(n,m,_,!J);return}}u1(n,r,m,a,c,f,_,k,U)}function dT(n){for(var r=n;;){var a=r.tag;if((a===0||a===11||a===15)&&r.flags&16384&&(a=r.updateQueue,a!==null&&(a=a.stores,a!==null)))for(var c=0;c<a.length;c++){var f=a[c],m=f.getSnapshot;f=f.value;try{if(!pr(m(),f))return!1}catch{return!1}}if(a=r.child,r.subtreeFlags&16384&&a!==null)a.return=r,r=a;else{if(r===n)break;for(;r.sibling===null;){if(r.return===null||r.return===n)return!0;r=r.return}r.sibling.return=r.return,r=r.sibling}}return!0}function Ta(n,r,a,c){r&=~jm,r&=~_o,n.suspendedLanes|=r,n.pingedLanes&=~r,c&&(n.warmLanes|=r),c=n.expirationTimes;for(var f=r;0<f;){var m=31-Fe(f),_=1<<m;c[m]=-1,f&=~_}a!==0&&lt(n,a,r)}function kh(){return(hn&6)===0?(wc(0),!1):!0}function Im(){if(Ut!==null){if(pn===0)var n=Ut.return;else n=Ut,Mi=uo=null,Kf(n),sl=null,sc=0,n=Ut;for(;n!==null;)D0(n.alternate,n),n=n.return;Ut=null}}function fl(n,r){var a=n.timeoutHandle;a!==-1&&(n.timeoutHandle=-1,IT(a)),a=n.cancelPendingCommit,a!==null&&(n.cancelPendingCommit=null,a()),$i=0,Im(),Sn=n,Ut=a=Ii(n.current,null),qt=r,pn=0,br=null,_a=!1,ul=ln(n,r),Sm=!1,hl=_r=jm=_o=wa=es=0,or=bc=null,Cm=!1,(r&8)!==0&&(r|=r&32);var c=n.entangledLanes;if(c!==0)for(n=n.entanglements,c&=r;0<c;){var f=31-Fe(c),m=1<<f;r|=n[f],c&=~m}return Hi=r,Wu(),a}function s1(n,r){Dt=null,Z.H=hc,r===nl||r===eh?(r=bv(),pn=3):r===Of?(r=bv(),pn=4):pn=r===um?8:r!==null&&typeof r=="object"&&typeof r.then=="function"?6:1,br=r,Ut===null&&(es=1,mh(n,Or(r,n.current)))}function r1(){var n=yr.current;return n===null?!0:(qt&4194048)===qt?Br===null:(qt&62914560)===qt||(qt&536870912)!==0?n===Br:!1}function i1(){var n=Z.H;return Z.H=hc,n===null?hc:n}function a1(){var n=Z.A;return Z.A=uT,n}function Sh(){es=4,_a||(qt&4194048)!==qt&&yr.current!==null||(ul=!0),(wa&134217727)===0&&(_o&134217727)===0||Sn===null||Ta(Sn,qt,_r,!1)}function Dm(n,r,a){var c=hn;hn|=2;var f=i1(),m=a1();(Sn!==n||qt!==r)&&(Th=null,fl(n,r)),r=!1;var _=es;e:do try{if(pn!==0&&Ut!==null){var k=Ut,U=br;switch(pn){case 8:Im(),_=6;break e;case 3:case 2:case 9:case 6:yr.current===null&&(r=!0);var J=pn;if(pn=0,br=null,ml(n,k,U,J),a&&ul){_=0;break e}break;default:J=pn,pn=0,br=null,ml(n,k,U,J)}}fT(),_=es;break}catch(de){s1(n,de)}while(!0);return r&&n.shellSuspendCounter++,Mi=uo=null,hn=c,Z.H=f,Z.A=m,Ut===null&&(Sn=null,qt=0,Wu()),_}function fT(){for(;Ut!==null;)o1(Ut)}function mT(n,r){var a=hn;hn|=2;var c=i1(),f=a1();Sn!==n||qt!==r?(Th=null,Eh=vt()+500,fl(n,r)):ul=ln(n,r);e:do try{if(pn!==0&&Ut!==null){r=Ut;var m=br;t:switch(pn){case 1:pn=0,br=null,ml(n,r,m,1);break;case 2:case 9:if(yv(m)){pn=0,br=null,l1(r);break}r=function(){pn!==2&&pn!==9||Sn!==n||(pn=7),mi(n)},m.then(r,r);break e;case 3:pn=7;break e;case 4:pn=5;break e;case 7:yv(m)?(pn=0,br=null,l1(r)):(pn=0,br=null,ml(n,r,m,7));break;case 5:var _=null;switch(Ut.tag){case 26:_=Ut.memoizedState;case 5:case 27:var k=Ut;if(_?G1(_):k.stateNode.complete){pn=0,br=null;var U=k.sibling;if(U!==null)Ut=U;else{var J=k.return;J!==null?(Ut=J,jh(J)):Ut=null}break t}}pn=0,br=null,ml(n,r,m,5);break;case 6:pn=0,br=null,ml(n,r,m,6);break;case 8:Im(),es=6;break e;default:throw Error(i(462))}}pT();break}catch(de){s1(n,de)}while(!0);return Mi=uo=null,Z.H=c,Z.A=f,hn=a,Ut!==null?0:(Sn=null,qt=0,Wu(),es)}function pT(){for(;Ut!==null&&!Je();)o1(Ut)}function o1(n){var r=R0(n.alternate,n,Hi);n.memoizedProps=n.pendingProps,r===null?jh(n):Ut=r}function l1(n){var r=n,a=r.alternate;switch(r.tag){case 15:case 0:r=k0(a,r,r.pendingProps,r.type,void 0,qt);break;case 11:r=k0(a,r,r.pendingProps,r.type.render,r.ref,qt);break;case 5:Kf(r);default:D0(a,r),r=Ut=av(r,Hi),r=R0(a,r,Hi)}n.memoizedProps=n.pendingProps,r===null?jh(n):Ut=r}function ml(n,r,a,c){Mi=uo=null,Kf(r),sl=null,sc=0;var f=r.return;try{if(sT(n,f,r,a,qt)){es=1,mh(n,Or(a,n.current)),Ut=null;return}}catch(m){if(f!==null)throw Ut=f,m;es=1,mh(n,Or(a,n.current)),Ut=null;return}r.flags&32768?(Qt||c===1?n=!0:ul||(qt&536870912)!==0?n=!1:(_a=n=!0,(c===2||c===9||c===3||c===6)&&(c=yr.current,c!==null&&c.tag===13&&(c.flags|=16384))),c1(r,n)):jh(r)}function jh(n){var r=n;do{if((r.flags&32768)!==0){c1(r,_a);return}n=r.return;var a=aT(r.alternate,r,Hi);if(a!==null){Ut=a;return}if(r=r.sibling,r!==null){Ut=r;return}Ut=r=n}while(r!==null);es===0&&(es=5)}function c1(n,r){do{var a=oT(n.alternate,n);if(a!==null){a.flags&=32767,Ut=a;return}if(a=n.return,a!==null&&(a.flags|=32768,a.subtreeFlags=0,a.deletions=null),!r&&(n=n.sibling,n!==null)){Ut=n;return}Ut=n=a}while(n!==null);es=6,Ut=null}function u1(n,r,a,c,f,m,_,k,U){n.cancelPendingCommit=null;do Ch();while(Es!==0);if((hn&6)!==0)throw Error(i(327));if(r!==null){if(r===n.current)throw Error(i(177));if(m=r.lanes|r.childLanes,m|=wf,mt(n,a,m,_,k,U),n===Sn&&(Ut=Sn=null,qt=0),dl=r,Ea=n,$i=a,Nm=m,Am=f,Z0=c,(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?(n.callbackNode=null,n.callbackPriority=0,bT(Xt,function(){return p1(),null})):(n.callbackNode=null,n.callbackPriority=0),c=(r.flags&13878)!==0,(r.subtreeFlags&13878)!==0||c){c=Z.T,Z.T=null,f=we.p,we.p=2,_=hn,hn|=4;try{lT(n,r,a)}finally{hn=_,we.p=f,Z.T=c}}Es=1,h1(),d1(),f1()}}function h1(){if(Es===1){Es=0;var n=Ea,r=dl,a=(r.flags&13878)!==0;if((r.subtreeFlags&13878)!==0||a){a=Z.T,Z.T=null;var c=we.p;we.p=2;var f=hn;hn|=4;try{$0(r,n);var m=$m,_=Xy(n.containerInfo),k=m.focusedElem,U=m.selectionRange;if(_!==k&&k&&k.ownerDocument&&Qy(k.ownerDocument.documentElement,k)){if(U!==null&&gf(k)){var J=U.start,de=U.end;if(de===void 0&&(de=J),"selectionStart"in k)k.selectionStart=J,k.selectionEnd=Math.min(de,k.value.length);else{var ge=k.ownerDocument||document,se=ge&&ge.defaultView||window;if(se.getSelection){var he=se.getSelection(),Xe=k.textContent.length,ft=Math.min(U.start,Xe),xn=U.end===void 0?ft:Math.min(U.end,Xe);!he.extend&&ft>xn&&(_=xn,xn=ft,ft=_);var $=Yy(k,ft),F=Yy(k,xn);if($&&F&&(he.rangeCount!==1||he.anchorNode!==$.node||he.anchorOffset!==$.offset||he.focusNode!==F.node||he.focusOffset!==F.offset)){var Q=ge.createRange();Q.setStart($.node,$.offset),he.removeAllRanges(),ft>xn?(he.addRange(Q),he.extend(F.node,F.offset)):(Q.setEnd(F.node,F.offset),he.addRange(Q))}}}}for(ge=[],he=k;he=he.parentNode;)he.nodeType===1&&ge.push({element:he,left:he.scrollLeft,top:he.scrollTop});for(typeof k.focus=="function"&&k.focus(),k=0;k<ge.length;k++){var me=ge[k];me.element.scrollLeft=me.left,me.element.scrollTop=me.top}}Bh=!!Hm,$m=Hm=null}finally{hn=f,we.p=c,Z.T=a}}n.current=r,Es=2}}function d1(){if(Es===2){Es=0;var n=Ea,r=dl,a=(r.flags&8772)!==0;if((r.subtreeFlags&8772)!==0||a){a=Z.T,Z.T=null;var c=we.p;we.p=2;var f=hn;hn|=4;try{B0(n,r.alternate,r)}finally{hn=f,we.p=c,Z.T=a}}Es=3}}function f1(){if(Es===4||Es===3){Es=0,At();var n=Ea,r=dl,a=$i,c=Z0;(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?Es=5:(Es=0,dl=Ea=null,m1(n,n.pendingLanes));var f=n.pendingLanes;if(f===0&&(xa=null),vn(a),r=r.stateNode,$e&&typeof $e.onCommitFiberRoot=="function")try{$e.onCommitFiberRoot(it,r,void 0,(r.current.flags&128)===128)}catch{}if(c!==null){r=Z.T,f=we.p,we.p=2,Z.T=null;try{for(var m=n.onRecoverableError,_=0;_<c.length;_++){var k=c[_];m(k.value,{componentStack:k.stack})}}finally{Z.T=r,we.p=f}}($i&3)!==0&&Ch(),mi(n),f=n.pendingLanes,(a&261930)!==0&&(f&42)!==0?n===Rm?_c++:(_c=0,Rm=n):_c=0,wc(0)}}function m1(n,r){(n.pooledCacheLanes&=r)===0&&(r=n.pooledCache,r!=null&&(n.pooledCache=null,tc(r)))}function Ch(){return h1(),d1(),f1(),p1()}function p1(){if(Es!==5)return!1;var n=Ea,r=Nm;Nm=0;var a=vn($i),c=Z.T,f=we.p;try{we.p=32>a?32:a,Z.T=null,a=Am,Am=null;var m=Ea,_=$i;if(Es=0,dl=Ea=null,$i=0,(hn&6)!==0)throw Error(i(331));var k=hn;if(hn|=4,Q0(m.current),G0(m,m.current,_,a),hn=k,wc(0,!1),$e&&typeof $e.onPostCommitFiberRoot=="function")try{$e.onPostCommitFiberRoot(it,m)}catch{}return!0}finally{we.p=f,Z.T=c,m1(n,r)}}function g1(n,r,a){r=Or(a,r),r=cm(n.stateNode,r,2),n=ga(n,r,2),n!==null&&(Ge(n,2),mi(n))}function gn(n,r,a){if(n.tag===3)g1(n,n,a);else for(;r!==null;){if(r.tag===3){g1(r,n,a);break}else if(r.tag===1){var c=r.stateNode;if(typeof r.type.getDerivedStateFromError=="function"||typeof c.componentDidCatch=="function"&&(xa===null||!xa.has(c))){n=Or(a,n),a=y0(2),c=ga(r,a,2),c!==null&&(v0(a,c,r,n),Ge(c,2),mi(c));break}}r=r.return}}function Mm(n,r,a){var c=n.pingCache;if(c===null){c=n.pingCache=new hT;var f=new Set;c.set(r,f)}else f=c.get(r),f===void 0&&(f=new Set,c.set(r,f));f.has(a)||(Sm=!0,f.add(a),n=gT.bind(null,n,r,a),r.then(n,n))}function gT(n,r,a){var c=n.pingCache;c!==null&&c.delete(r),n.pingedLanes|=n.suspendedLanes&a,n.warmLanes&=~a,Sn===n&&(qt&a)===a&&(es===4||es===3&&(qt&62914560)===qt&&300>vt()-xh?(hn&2)===0&&fl(n,0):jm|=a,hl===qt&&(hl=0)),mi(n)}function y1(n,r){r===0&&(r=oe()),n=oo(n,r),n!==null&&(Ge(n,r),mi(n))}function yT(n){var r=n.memoizedState,a=0;r!==null&&(a=r.retryLane),y1(n,a)}function vT(n,r){var a=0;switch(n.tag){case 31:case 13:var c=n.stateNode,f=n.memoizedState;f!==null&&(a=f.retryLane);break;case 19:c=n.stateNode;break;case 22:c=n.stateNode._retryCache;break;default:throw Error(i(314))}c!==null&&c.delete(r),y1(n,a)}function bT(n,r){return yt(n,r)}var Nh=null,pl=null,Lm=!1,Ah=!1,Om=!1,ka=0;function mi(n){n!==pl&&n.next===null&&(pl===null?Nh=pl=n:pl=pl.next=n),Ah=!0,Lm||(Lm=!0,wT())}function wc(n,r){if(!Om&&Ah){Om=!0;do for(var a=!1,c=Nh;c!==null;){if(n!==0){var f=c.pendingLanes;if(f===0)var m=0;else{var _=c.suspendedLanes,k=c.pingedLanes;m=(1<<31-Fe(42|n)+1)-1,m&=f&~(_&~k),m=m&201326741?m&201326741|1:m?m|2:0}m!==0&&(a=!0,w1(c,m))}else m=qt,m=Cn(c,c===Sn?m:0,c.cancelPendingCommit!==null||c.timeoutHandle!==-1),(m&3)===0||ln(c,m)||(a=!0,w1(c,m));c=c.next}while(a);Om=!1}}function _T(){v1()}function v1(){Ah=Lm=!1;var n=0;ka!==0&&RT()&&(n=ka);for(var r=vt(),a=null,c=Nh;c!==null;){var f=c.next,m=b1(c,r);m===0?(c.next=null,a===null?Nh=f:a.next=f,f===null&&(pl=a)):(a=c,(n!==0||(m&3)!==0)&&(Ah=!0)),c=f}Es!==0&&Es!==5||wc(n),ka!==0&&(ka=0)}function b1(n,r){for(var a=n.suspendedLanes,c=n.pingedLanes,f=n.expirationTimes,m=n.pendingLanes&-62914561;0<m;){var _=31-Fe(m),k=1<<_,U=f[_];U===-1?((k&a)===0||(k&c)!==0)&&(f[_]=fr(k,r)):U<=r&&(n.expiredLanes|=k),m&=~k}if(r=Sn,a=qt,a=Cn(n,n===r?a:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),c=n.callbackNode,a===0||n===r&&(pn===2||pn===9)||n.cancelPendingCommit!==null)return c!==null&&c!==null&&Vt(c),n.callbackNode=null,n.callbackPriority=0;if((a&3)===0||ln(n,a)){if(r=a&-a,r===n.callbackPriority)return r;switch(c!==null&&Vt(c),vn(a)){case 2:case 8:a=rs;break;case 32:a=Xt;break;case 268435456:a=Ne;break;default:a=Xt}return c=_1.bind(null,n),a=yt(a,c),n.callbackPriority=r,n.callbackNode=a,r}return c!==null&&c!==null&&Vt(c),n.callbackPriority=2,n.callbackNode=null,2}function _1(n,r){if(Es!==0&&Es!==5)return n.callbackNode=null,n.callbackPriority=0,null;var a=n.callbackNode;if(Ch()&&n.callbackNode!==a)return null;var c=qt;return c=Cn(n,n===Sn?c:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),c===0?null:(t1(n,c,r),b1(n,vt()),n.callbackNode!=null&&n.callbackNode===a?_1.bind(null,n):null)}function w1(n,r){if(Ch())return null;t1(n,r,!0)}function wT(){DT(function(){(hn&6)!==0?yt(js,_T):v1()})}function Pm(){if(ka===0){var n=el;n===0&&(n=zn,zn<<=1,(zn&261888)===0&&(zn=256)),ka=n}return ka}function x1(n){return n==null||typeof n=="symbol"||typeof n=="boolean"?null:typeof n=="function"?n:kt(""+n)}function E1(n,r){var a=r.ownerDocument.createElement("input");return a.name=r.name,a.value=r.value,n.id&&a.setAttribute("form",n.id),r.parentNode.insertBefore(a,r),n=new FormData(n),a.parentNode.removeChild(a),n}function xT(n,r,a,c,f){if(r==="submit"&&a&&a.stateNode===f){var m=x1((f[An]||null).action),_=c.submitter;_&&(r=(r=_[An]||null)?x1(r.formAction):_.getAttribute("formAction"),r!==null&&(m=r,_=null));var k=new zs("action","action",null,c,f);n.push({event:k,listeners:[{instance:null,listener:function(){if(c.defaultPrevented){if(ka!==0){var U=_?E1(f,_):new FormData(f);sm(a,{pending:!0,data:U,method:f.method,action:m},null,U)}}else typeof m=="function"&&(k.preventDefault(),U=_?E1(f,_):new FormData(f),sm(a,{pending:!0,data:U,method:f.method,action:m},m,U))},currentTarget:f}]})}}for(var Vm=0;Vm<_f.length;Vm++){var Um=_f[Vm],ET=Um.toLowerCase(),TT=Um[0].toUpperCase()+Um.slice(1);Qr(ET,"on"+TT)}Qr(ev,"onAnimationEnd"),Qr(tv,"onAnimationIteration"),Qr(nv,"onAnimationStart"),Qr("dblclick","onDoubleClick"),Qr("focusin","onFocus"),Qr("focusout","onBlur"),Qr(BE,"onTransitionRun"),Qr(zE,"onTransitionStart"),Qr(FE,"onTransitionCancel"),Qr(sv,"onTransitionEnd"),bn("onMouseEnter",["mouseout","mouseover"]),bn("onMouseLeave",["mouseout","mouseover"]),bn("onPointerEnter",["pointerout","pointerover"]),bn("onPointerLeave",["pointerout","pointerover"]),xs("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),xs("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),xs("onBeforeInput",["compositionend","keypress","textInput","paste"]),xs("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),xs("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),xs("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var xc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),kT=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(xc));function T1(n,r){r=(r&4)!==0;for(var a=0;a<n.length;a++){var c=n[a],f=c.event;c=c.listeners;e:{var m=void 0;if(r)for(var _=c.length-1;0<=_;_--){var k=c[_],U=k.instance,J=k.currentTarget;if(k=k.listener,U!==m&&f.isPropagationStopped())break e;m=k,f.currentTarget=J;try{m(f)}catch(de){$u(de)}f.currentTarget=null,m=U}else for(_=0;_<c.length;_++){if(k=c[_],U=k.instance,J=k.currentTarget,k=k.listener,U!==m&&f.isPropagationStopped())break e;m=k,f.currentTarget=J;try{m(f)}catch(de){$u(de)}f.currentTarget=null,m=U}}}}function Bt(n,r){var a=r[jr];a===void 0&&(a=r[jr]=new Set);var c=n+"__bubble";a.has(c)||(k1(r,n,2,!1),a.add(c))}function Bm(n,r,a){var c=0;r&&(c|=4),k1(a,n,c,r)}var Rh="_reactListening"+Math.random().toString(36).slice(2);function zm(n){if(!n[Rh]){n[Rh]=!0,Gr.forEach(function(a){a!=="selectionchange"&&(kT.has(a)||Bm(a,!1,n),Bm(a,!0,n))});var r=n.nodeType===9?n:n.ownerDocument;r===null||r[Rh]||(r[Rh]=!0,Bm("selectionchange",!1,r))}}function k1(n,r,a,c){switch(eb(r)){case 2:var f=ZT;break;case 8:f=ek;break;default:f=np}a=f.bind(null,r,a,n),f=void 0,!Pt||r!=="touchstart"&&r!=="touchmove"&&r!=="wheel"||(f=!0),c?f!==void 0?n.addEventListener(r,a,{capture:!0,passive:f}):n.addEventListener(r,a,!0):f!==void 0?n.addEventListener(r,a,{passive:f}):n.addEventListener(r,a,!1)}function Fm(n,r,a,c,f){var m=c;if((r&1)===0&&(r&2)===0&&c!==null)e:for(;;){if(c===null)return;var _=c.tag;if(_===3||_===4){var k=c.stateNode.containerInfo;if(k===f)break;if(_===4)for(_=c.return;_!==null;){var U=_.tag;if((U===3||U===4)&&_.stateNode.containerInfo===f)return;_=_.return}for(;k!==null;){if(_=ws(k),_===null)return;if(U=_.tag,U===5||U===6||U===26||U===27){c=m=_;continue e}k=k.parentNode}}c=c.return}qe(function(){var J=m,de=Y(a),ge=[];e:{var se=rv.get(n);if(se!==void 0){var he=zs,Xe=n;switch(n){case"keypress":if(Jn(a)===0)break e;case"keydown":case"keyup":he=Fu;break;case"focusin":Xe="focus",he=so;break;case"focusout":Xe="blur",he=so;break;case"beforeblur":case"afterblur":he=so;break;case"click":if(a.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":he=Gl;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":he=Du;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":he=v;break;case ev:case tv:case nv:he=Lu;break;case sv:he=C;break;case"scroll":case"scrollend":he=Ys;break;case"wheel":he=ce;break;case"copy":case"cut":case"paste":he=Ou;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":he=Ri;break;case"toggle":case"beforetoggle":he=It}var ft=(r&4)!==0,xn=!ft&&(n==="scroll"||n==="scrollend"),$=ft?se!==null?se+"Capture":null:se;ft=[];for(var F=J,Q;F!==null;){var me=F;if(Q=me.stateNode,me=me.tag,me!==5&&me!==26&&me!==27||Q===null||$===null||(me=pt(F,$),me!=null&&ft.push(Ec(F,me,Q))),xn)break;F=F.return}0<ft.length&&(se=new he(se,Xe,null,a,de),ge.push({event:se,listeners:ft}))}}if((r&7)===0){e:{if(se=n==="mouseover"||n==="pointerover",he=n==="mouseout"||n==="pointerout",se&&a!==P&&(Xe=a.relatedTarget||a.fromElement)&&(ws(Xe)||Xe[Ns]))break e;if((he||se)&&(se=de.window===de?de:(se=de.ownerDocument)?se.defaultView||se.parentWindow:window,he?(Xe=a.relatedTarget||a.toElement,he=J,Xe=Xe?ws(Xe):null,Xe!==null&&(xn=u(Xe),ft=Xe.tag,Xe!==xn||ft!==5&&ft!==27&&ft!==6)&&(Xe=null)):(he=null,Xe=J),he!==Xe)){if(ft=Gl,me="onMouseLeave",$="onMouseEnter",F="mouse",(n==="pointerout"||n==="pointerover")&&(ft=Ri,me="onPointerLeave",$="onPointerEnter",F="pointer"),xn=he==null?se:Ln(he),Q=Xe==null?se:Ln(Xe),se=new ft(me,F+"leave",he,a,de),se.target=xn,se.relatedTarget=Q,me=null,ws(de)===J&&(ft=new ft($,F+"enter",Xe,a,de),ft.target=Q,ft.relatedTarget=xn,me=ft),xn=me,he&&Xe)t:{for(ft=ST,$=he,F=Xe,Q=0,me=$;me;me=ft(me))Q++;me=0;for(var at=F;at;at=ft(at))me++;for(;0<Q-me;)$=ft($),Q--;for(;0<me-Q;)F=ft(F),me--;for(;Q--;){if($===F||F!==null&&$===F.alternate){ft=$;break t}$=ft($),F=ft(F)}ft=null}else ft=null;he!==null&&S1(ge,se,he,ft,!1),Xe!==null&&xn!==null&&S1(ge,xn,Xe,ft,!0)}}e:{if(se=J?Ln(J):window,he=se.nodeName&&se.nodeName.toLowerCase(),he==="select"||he==="input"&&se.type==="file")var rn=qy;else if(zy(se))if(Hy)rn=PE;else{rn=LE;var tt=ME}else he=se.nodeName,!he||he.toLowerCase()!=="input"||se.type!=="checkbox"&&se.type!=="radio"?J&&ze(J.elementType)&&(rn=qy):rn=OE;if(rn&&(rn=rn(n,J))){Fy(ge,rn,a,de);break e}tt&&tt(n,se,J),n==="focusout"&&J&&se.type==="number"&&J.memoizedProps.value!=null&&Ni(se,"number",se.value)}switch(tt=J?Ln(J):window,n){case"focusin":(zy(tt)||tt.contentEditable==="true")&&(Wo=tt,yf=J,Jl=null);break;case"focusout":Jl=yf=Wo=null;break;case"mousedown":vf=!0;break;case"contextmenu":case"mouseup":case"dragend":vf=!1,Jy(ge,a,de);break;case"selectionchange":if(UE)break;case"keydown":case"keyup":Jy(ge,a,de)}var Ot;if(un)e:{switch(n){case"compositionstart":var Ht="onCompositionStart";break e;case"compositionend":Ht="onCompositionEnd";break e;case"compositionupdate":Ht="onCompositionUpdate";break e}Ht=void 0}else $o?ro(n,a)&&(Ht="onCompositionEnd"):n==="keydown"&&a.keyCode===229&&(Ht="onCompositionStart");Ht&&(ui&&a.locale!=="ko"&&($o||Ht!=="onCompositionStart"?Ht==="onCompositionEnd"&&$o&&(Ot=Hn()):(Zt=de,Us="value"in Zt?Zt.value:Zt.textContent,$o=!0)),tt=Ih(J,Ht),0<tt.length&&(Ht=new ci(Ht,n,null,a,de),ge.push({event:Ht,listeners:tt}),Ot?Ht.data=Ot:(Ot=Ho(a),Ot!==null&&(Ht.data=Ot)))),(Ot=Mr?AE(n,a):RE(n,a))&&(Ht=Ih(J,"onBeforeInput"),0<Ht.length&&(tt=new ci("onBeforeInput","beforeinput",null,a,de),ge.push({event:tt,listeners:Ht}),tt.data=Ot)),xT(ge,n,J,a,de)}T1(ge,r)})}function Ec(n,r,a){return{instance:n,listener:r,currentTarget:a}}function Ih(n,r){for(var a=r+"Capture",c=[];n!==null;){var f=n,m=f.stateNode;if(f=f.tag,f!==5&&f!==26&&f!==27||m===null||(f=pt(n,a),f!=null&&c.unshift(Ec(n,f,m)),f=pt(n,r),f!=null&&c.push(Ec(n,f,m))),n.tag===3)return c;n=n.return}return[]}function ST(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5&&n.tag!==27);return n||null}function S1(n,r,a,c,f){for(var m=r._reactName,_=[];a!==null&&a!==c;){var k=a,U=k.alternate,J=k.stateNode;if(k=k.tag,U!==null&&U===c)break;k!==5&&k!==26&&k!==27||J===null||(U=J,f?(J=pt(a,m),J!=null&&_.unshift(Ec(a,J,U))):f||(J=pt(a,m),J!=null&&_.push(Ec(a,J,U)))),a=a.return}_.length!==0&&n.push({event:r,listeners:_})}var jT=/\r\n?/g,CT=/\u0000|\uFFFD/g;function j1(n){return(typeof n=="string"?n:""+n).replace(jT,`
`).replace(CT,"")}function C1(n,r){return r=j1(r),j1(n)===r}function wn(n,r,a,c,f,m){switch(a){case"children":typeof c=="string"?r==="body"||r==="textarea"&&c===""||j(n,c):(typeof c=="number"||typeof c=="bigint")&&r!=="body"&&j(n,""+c);break;case"className":le(n,"class",c);break;case"tabIndex":le(n,"tabindex",c);break;case"dir":case"role":case"viewBox":case"width":case"height":le(n,a,c);break;case"style":Re(n,c,m);break;case"data":if(r!=="object"){le(n,"data",c);break}case"src":case"href":if(c===""&&(r!=="a"||a!=="href")){n.removeAttribute(a);break}if(c==null||typeof c=="function"||typeof c=="symbol"||typeof c=="boolean"){n.removeAttribute(a);break}c=kt(""+c),n.setAttribute(a,c);break;case"action":case"formAction":if(typeof c=="function"){n.setAttribute(a,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof m=="function"&&(a==="formAction"?(r!=="input"&&wn(n,r,"name",f.name,f,null),wn(n,r,"formEncType",f.formEncType,f,null),wn(n,r,"formMethod",f.formMethod,f,null),wn(n,r,"formTarget",f.formTarget,f,null)):(wn(n,r,"encType",f.encType,f,null),wn(n,r,"method",f.method,f,null),wn(n,r,"target",f.target,f,null)));if(c==null||typeof c=="symbol"||typeof c=="boolean"){n.removeAttribute(a);break}c=kt(""+c),n.setAttribute(a,c);break;case"onClick":c!=null&&(n.onclick=dt);break;case"onScroll":c!=null&&Bt("scroll",n);break;case"onScrollEnd":c!=null&&Bt("scrollend",n);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(i(61));if(a=c.__html,a!=null){if(f.children!=null)throw Error(i(60));n.innerHTML=a}}break;case"multiple":n.multiple=c&&typeof c!="function"&&typeof c!="symbol";break;case"muted":n.muted=c&&typeof c!="function"&&typeof c!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(c==null||typeof c=="function"||typeof c=="boolean"||typeof c=="symbol"){n.removeAttribute("xlink:href");break}a=kt(""+c),n.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",a);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":c!=null&&typeof c!="function"&&typeof c!="symbol"?n.setAttribute(a,""+c):n.removeAttribute(a);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":c&&typeof c!="function"&&typeof c!="symbol"?n.setAttribute(a,""):n.removeAttribute(a);break;case"capture":case"download":c===!0?n.setAttribute(a,""):c!==!1&&c!=null&&typeof c!="function"&&typeof c!="symbol"?n.setAttribute(a,c):n.removeAttribute(a);break;case"cols":case"rows":case"size":case"span":c!=null&&typeof c!="function"&&typeof c!="symbol"&&!isNaN(c)&&1<=c?n.setAttribute(a,c):n.removeAttribute(a);break;case"rowSpan":case"start":c==null||typeof c=="function"||typeof c=="symbol"||isNaN(c)?n.removeAttribute(a):n.setAttribute(a,c);break;case"popover":Bt("beforetoggle",n),Bt("toggle",n),ae(n,"popover",c);break;case"xlinkActuate":Me(n,"http://www.w3.org/1999/xlink","xlink:actuate",c);break;case"xlinkArcrole":Me(n,"http://www.w3.org/1999/xlink","xlink:arcrole",c);break;case"xlinkRole":Me(n,"http://www.w3.org/1999/xlink","xlink:role",c);break;case"xlinkShow":Me(n,"http://www.w3.org/1999/xlink","xlink:show",c);break;case"xlinkTitle":Me(n,"http://www.w3.org/1999/xlink","xlink:title",c);break;case"xlinkType":Me(n,"http://www.w3.org/1999/xlink","xlink:type",c);break;case"xmlBase":Me(n,"http://www.w3.org/XML/1998/namespace","xml:base",c);break;case"xmlLang":Me(n,"http://www.w3.org/XML/1998/namespace","xml:lang",c);break;case"xmlSpace":Me(n,"http://www.w3.org/XML/1998/namespace","xml:space",c);break;case"is":ae(n,"is",c);break;case"innerText":case"textContent":break;default:(!(2<a.length)||a[0]!=="o"&&a[0]!=="O"||a[1]!=="n"&&a[1]!=="N")&&(a=ht.get(a)||a,ae(n,a,c))}}function qm(n,r,a,c,f,m){switch(a){case"style":Re(n,c,m);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(i(61));if(a=c.__html,a!=null){if(f.children!=null)throw Error(i(60));n.innerHTML=a}}break;case"children":typeof c=="string"?j(n,c):(typeof c=="number"||typeof c=="bigint")&&j(n,""+c);break;case"onScroll":c!=null&&Bt("scroll",n);break;case"onScrollEnd":c!=null&&Bt("scrollend",n);break;case"onClick":c!=null&&(n.onclick=dt);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Ar.hasOwnProperty(a))e:{if(a[0]==="o"&&a[1]==="n"&&(f=a.endsWith("Capture"),r=a.slice(2,f?a.length-7:void 0),m=n[An]||null,m=m!=null?m[a]:null,typeof m=="function"&&n.removeEventListener(r,m,f),typeof c=="function")){typeof m!="function"&&m!==null&&(a in n?n[a]=null:n.hasAttribute(a)&&n.removeAttribute(a)),n.addEventListener(r,c,f);break e}a in n?n[a]=c:c===!0?n.setAttribute(a,""):ae(n,a,c)}}}function Ds(n,r,a){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Bt("error",n),Bt("load",n);var c=!1,f=!1,m;for(m in a)if(a.hasOwnProperty(m)){var _=a[m];if(_!=null)switch(m){case"src":c=!0;break;case"srcSet":f=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,r));default:wn(n,r,m,_,a,null)}}f&&wn(n,r,"srcSet",a.srcSet,a,null),c&&wn(n,r,"src",a.src,a,null);return;case"input":Bt("invalid",n);var k=m=_=f=null,U=null,J=null;for(c in a)if(a.hasOwnProperty(c)){var de=a[c];if(de!=null)switch(c){case"name":f=de;break;case"type":_=de;break;case"checked":U=de;break;case"defaultChecked":J=de;break;case"value":m=de;break;case"defaultValue":k=de;break;case"children":case"dangerouslySetInnerHTML":if(de!=null)throw Error(i(137,r));break;default:wn(n,r,c,de,a,null)}}oa(n,m,k,U,J,_,f,!1);return;case"select":Bt("invalid",n),c=_=m=null;for(f in a)if(a.hasOwnProperty(f)&&(k=a[f],k!=null))switch(f){case"value":m=k;break;case"defaultValue":_=k;break;case"multiple":c=k;default:wn(n,r,f,k,a,null)}r=m,a=_,n.multiple=!!c,r!=null?Rr(n,!!c,r,!1):a!=null&&Rr(n,!!c,a,!0);return;case"textarea":Bt("invalid",n),m=f=c=null;for(_ in a)if(a.hasOwnProperty(_)&&(k=a[_],k!=null))switch(_){case"value":c=k;break;case"defaultValue":f=k;break;case"children":m=k;break;case"dangerouslySetInnerHTML":if(k!=null)throw Error(i(91));break;default:wn(n,r,_,k,a,null)}Ir(n,c,f,m);return;case"option":for(U in a)a.hasOwnProperty(U)&&(c=a[U],c!=null)&&(U==="selected"?n.selected=c&&typeof c!="function"&&typeof c!="symbol":wn(n,r,U,c,a,null));return;case"dialog":Bt("beforetoggle",n),Bt("toggle",n),Bt("cancel",n),Bt("close",n);break;case"iframe":case"object":Bt("load",n);break;case"video":case"audio":for(c=0;c<xc.length;c++)Bt(xc[c],n);break;case"image":Bt("error",n),Bt("load",n);break;case"details":Bt("toggle",n);break;case"embed":case"source":case"link":Bt("error",n),Bt("load",n);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(J in a)if(a.hasOwnProperty(J)&&(c=a[J],c!=null))switch(J){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,r));default:wn(n,r,J,c,a,null)}return;default:if(ze(r)){for(de in a)a.hasOwnProperty(de)&&(c=a[de],c!==void 0&&qm(n,r,de,c,a,void 0));return}}for(k in a)a.hasOwnProperty(k)&&(c=a[k],c!=null&&wn(n,r,k,c,a,null))}function NT(n,r,a,c){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var f=null,m=null,_=null,k=null,U=null,J=null,de=null;for(he in a){var ge=a[he];if(a.hasOwnProperty(he)&&ge!=null)switch(he){case"checked":break;case"value":break;case"defaultValue":U=ge;default:c.hasOwnProperty(he)||wn(n,r,he,null,c,ge)}}for(var se in c){var he=c[se];if(ge=a[se],c.hasOwnProperty(se)&&(he!=null||ge!=null))switch(se){case"type":m=he;break;case"name":f=he;break;case"checked":J=he;break;case"defaultChecked":de=he;break;case"value":_=he;break;case"defaultValue":k=he;break;case"children":case"dangerouslySetInnerHTML":if(he!=null)throw Error(i(137,r));break;default:he!==ge&&wn(n,r,se,he,c,ge)}}mr(n,_,k,U,J,de,m,f);return;case"select":he=_=k=se=null;for(m in a)if(U=a[m],a.hasOwnProperty(m)&&U!=null)switch(m){case"value":break;case"multiple":he=U;default:c.hasOwnProperty(m)||wn(n,r,m,null,c,U)}for(f in c)if(m=c[f],U=a[f],c.hasOwnProperty(f)&&(m!=null||U!=null))switch(f){case"value":se=m;break;case"defaultValue":k=m;break;case"multiple":_=m;default:m!==U&&wn(n,r,f,m,c,U)}r=k,a=_,c=he,se!=null?Rr(n,!!a,se,!1):!!c!=!!a&&(r!=null?Rr(n,!!a,r,!0):Rr(n,!!a,a?[]:"",!1));return;case"textarea":he=se=null;for(k in a)if(f=a[k],a.hasOwnProperty(k)&&f!=null&&!c.hasOwnProperty(k))switch(k){case"value":break;case"children":break;default:wn(n,r,k,null,c,f)}for(_ in c)if(f=c[_],m=a[_],c.hasOwnProperty(_)&&(f!=null||m!=null))switch(_){case"value":se=f;break;case"defaultValue":he=f;break;case"children":break;case"dangerouslySetInnerHTML":if(f!=null)throw Error(i(91));break;default:f!==m&&wn(n,r,_,f,c,m)}la(n,se,he);return;case"option":for(var Xe in a)se=a[Xe],a.hasOwnProperty(Xe)&&se!=null&&!c.hasOwnProperty(Xe)&&(Xe==="selected"?n.selected=!1:wn(n,r,Xe,null,c,se));for(U in c)se=c[U],he=a[U],c.hasOwnProperty(U)&&se!==he&&(se!=null||he!=null)&&(U==="selected"?n.selected=se&&typeof se!="function"&&typeof se!="symbol":wn(n,r,U,se,c,he));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var ft in a)se=a[ft],a.hasOwnProperty(ft)&&se!=null&&!c.hasOwnProperty(ft)&&wn(n,r,ft,null,c,se);for(J in c)if(se=c[J],he=a[J],c.hasOwnProperty(J)&&se!==he&&(se!=null||he!=null))switch(J){case"children":case"dangerouslySetInnerHTML":if(se!=null)throw Error(i(137,r));break;default:wn(n,r,J,se,c,he)}return;default:if(ze(r)){for(var xn in a)se=a[xn],a.hasOwnProperty(xn)&&se!==void 0&&!c.hasOwnProperty(xn)&&qm(n,r,xn,void 0,c,se);for(de in c)se=c[de],he=a[de],!c.hasOwnProperty(de)||se===he||se===void 0&&he===void 0||qm(n,r,de,se,c,he);return}}for(var $ in a)se=a[$],a.hasOwnProperty($)&&se!=null&&!c.hasOwnProperty($)&&wn(n,r,$,null,c,se);for(ge in c)se=c[ge],he=a[ge],!c.hasOwnProperty(ge)||se===he||se==null&&he==null||wn(n,r,ge,se,c,he)}function N1(n){switch(n){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function AT(){if(typeof performance.getEntriesByType=="function"){for(var n=0,r=0,a=performance.getEntriesByType("resource"),c=0;c<a.length;c++){var f=a[c],m=f.transferSize,_=f.initiatorType,k=f.duration;if(m&&k&&N1(_)){for(_=0,k=f.responseEnd,c+=1;c<a.length;c++){var U=a[c],J=U.startTime;if(J>k)break;var de=U.transferSize,ge=U.initiatorType;de&&N1(ge)&&(U=U.responseEnd,_+=de*(U<k?1:(k-J)/(U-J)))}if(--c,r+=8*(m+_)/(f.duration/1e3),n++,10<n)break}}if(0<n)return r/n/1e6}return navigator.connection&&(n=navigator.connection.downlink,typeof n=="number")?n:5}var Hm=null,$m=null;function Dh(n){return n.nodeType===9?n:n.ownerDocument}function A1(n){switch(n){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function R1(n,r){if(n===0)switch(r){case"svg":return 1;case"math":return 2;default:return 0}return n===1&&r==="foreignObject"?0:n}function Wm(n,r){return n==="textarea"||n==="noscript"||typeof r.children=="string"||typeof r.children=="number"||typeof r.children=="bigint"||typeof r.dangerouslySetInnerHTML=="object"&&r.dangerouslySetInnerHTML!==null&&r.dangerouslySetInnerHTML.__html!=null}var Gm=null;function RT(){var n=window.event;return n&&n.type==="popstate"?n===Gm?!1:(Gm=n,!0):(Gm=null,!1)}var I1=typeof setTimeout=="function"?setTimeout:void 0,IT=typeof clearTimeout=="function"?clearTimeout:void 0,D1=typeof Promise=="function"?Promise:void 0,DT=typeof queueMicrotask=="function"?queueMicrotask:typeof D1<"u"?function(n){return D1.resolve(null).then(n).catch(MT)}:I1;function MT(n){setTimeout(function(){throw n})}function Sa(n){return n==="head"}function M1(n,r){var a=r,c=0;do{var f=a.nextSibling;if(n.removeChild(a),f&&f.nodeType===8)if(a=f.data,a==="/$"||a==="/&"){if(c===0){n.removeChild(f),bl(r);return}c--}else if(a==="$"||a==="$?"||a==="$~"||a==="$!"||a==="&")c++;else if(a==="html")Tc(n.ownerDocument.documentElement);else if(a==="head"){a=n.ownerDocument.head,Tc(a);for(var m=a.firstChild;m;){var _=m.nextSibling,k=m.nodeName;m[qn]||k==="SCRIPT"||k==="STYLE"||k==="LINK"&&m.rel.toLowerCase()==="stylesheet"||a.removeChild(m),m=_}}else a==="body"&&Tc(n.ownerDocument.body);a=f}while(a);bl(r)}function L1(n,r){var a=n;n=0;do{var c=a.nextSibling;if(a.nodeType===1?r?(a._stashedDisplay=a.style.display,a.style.display="none"):(a.style.display=a._stashedDisplay||"",a.getAttribute("style")===""&&a.removeAttribute("style")):a.nodeType===3&&(r?(a._stashedText=a.nodeValue,a.nodeValue=""):a.nodeValue=a._stashedText||""),c&&c.nodeType===8)if(a=c.data,a==="/$"){if(n===0)break;n--}else a!=="$"&&a!=="$?"&&a!=="$~"&&a!=="$!"||n++;a=c}while(a)}function Km(n){var r=n.firstChild;for(r&&r.nodeType===10&&(r=r.nextSibling);r;){var a=r;switch(r=r.nextSibling,a.nodeName){case"HTML":case"HEAD":case"BODY":Km(a),Ks(a);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(a.rel.toLowerCase()==="stylesheet")continue}n.removeChild(a)}}function LT(n,r,a,c){for(;n.nodeType===1;){var f=a;if(n.nodeName.toLowerCase()!==r.toLowerCase()){if(!c&&(n.nodeName!=="INPUT"||n.type!=="hidden"))break}else if(c){if(!n[qn])switch(r){case"meta":if(!n.hasAttribute("itemprop"))break;return n;case"link":if(m=n.getAttribute("rel"),m==="stylesheet"&&n.hasAttribute("data-precedence"))break;if(m!==f.rel||n.getAttribute("href")!==(f.href==null||f.href===""?null:f.href)||n.getAttribute("crossorigin")!==(f.crossOrigin==null?null:f.crossOrigin)||n.getAttribute("title")!==(f.title==null?null:f.title))break;return n;case"style":if(n.hasAttribute("data-precedence"))break;return n;case"script":if(m=n.getAttribute("src"),(m!==(f.src==null?null:f.src)||n.getAttribute("type")!==(f.type==null?null:f.type)||n.getAttribute("crossorigin")!==(f.crossOrigin==null?null:f.crossOrigin))&&m&&n.hasAttribute("async")&&!n.hasAttribute("itemprop"))break;return n;default:return n}}else if(r==="input"&&n.type==="hidden"){var m=f.name==null?null:""+f.name;if(f.type==="hidden"&&n.getAttribute("name")===m)return n}else return n;if(n=zr(n.nextSibling),n===null)break}return null}function OT(n,r,a){if(r==="")return null;for(;n.nodeType!==3;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!a||(n=zr(n.nextSibling),n===null))return null;return n}function O1(n,r){for(;n.nodeType!==8;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!r||(n=zr(n.nextSibling),n===null))return null;return n}function Ym(n){return n.data==="$?"||n.data==="$~"}function Qm(n){return n.data==="$!"||n.data==="$?"&&n.ownerDocument.readyState!=="loading"}function PT(n,r){var a=n.ownerDocument;if(n.data==="$~")n._reactRetry=r;else if(n.data!=="$?"||a.readyState!=="loading")r();else{var c=function(){r(),a.removeEventListener("DOMContentLoaded",c)};a.addEventListener("DOMContentLoaded",c),n._reactRetry=c}}function zr(n){for(;n!=null;n=n.nextSibling){var r=n.nodeType;if(r===1||r===3)break;if(r===8){if(r=n.data,r==="$"||r==="$!"||r==="$?"||r==="$~"||r==="&"||r==="F!"||r==="F")break;if(r==="/$"||r==="/&")return null}}return n}var Xm=null;function P1(n){n=n.nextSibling;for(var r=0;n;){if(n.nodeType===8){var a=n.data;if(a==="/$"||a==="/&"){if(r===0)return zr(n.nextSibling);r--}else a!=="$"&&a!=="$!"&&a!=="$?"&&a!=="$~"&&a!=="&"||r++}n=n.nextSibling}return null}function V1(n){n=n.previousSibling;for(var r=0;n;){if(n.nodeType===8){var a=n.data;if(a==="$"||a==="$!"||a==="$?"||a==="$~"||a==="&"){if(r===0)return n;r--}else a!=="/$"&&a!=="/&"||r++}n=n.previousSibling}return null}function U1(n,r,a){switch(r=Dh(a),n){case"html":if(n=r.documentElement,!n)throw Error(i(452));return n;case"head":if(n=r.head,!n)throw Error(i(453));return n;case"body":if(n=r.body,!n)throw Error(i(454));return n;default:throw Error(i(451))}}function Tc(n){for(var r=n.attributes;r.length;)n.removeAttributeNode(r[0]);Ks(n)}var Fr=new Map,B1=new Set;function Mh(n){return typeof n.getRootNode=="function"?n.getRootNode():n.nodeType===9?n:n.ownerDocument}var Wi=we.d;we.d={f:VT,r:UT,D:BT,C:zT,L:FT,m:qT,X:$T,S:HT,M:WT};function VT(){var n=Wi.f(),r=kh();return n||r}function UT(n){var r=kn(n);r!==null&&r.tag===5&&r.type==="form"?s0(r):Wi.r(n)}var gl=typeof document>"u"?null:document;function z1(n,r,a){var c=gl;if(c&&typeof r=="string"&&r){var f=Yn(r);f='link[rel="'+n+'"][href="'+f+'"]',typeof a=="string"&&(f+='[crossorigin="'+a+'"]'),B1.has(f)||(B1.add(f),n={rel:n,crossOrigin:a,href:r},c.querySelector(f)===null&&(r=c.createElement("link"),Ds(r,"link",n),zt(r),c.head.appendChild(r)))}}function BT(n){Wi.D(n),z1("dns-prefetch",n,null)}function zT(n,r){Wi.C(n,r),z1("preconnect",n,r)}function FT(n,r,a){Wi.L(n,r,a);var c=gl;if(c&&n&&r){var f='link[rel="preload"][as="'+Yn(r)+'"]';r==="image"&&a&&a.imageSrcSet?(f+='[imagesrcset="'+Yn(a.imageSrcSet)+'"]',typeof a.imageSizes=="string"&&(f+='[imagesizes="'+Yn(a.imageSizes)+'"]')):f+='[href="'+Yn(n)+'"]';var m=f;switch(r){case"style":m=yl(n);break;case"script":m=vl(n)}Fr.has(m)||(n=E({rel:"preload",href:r==="image"&&a&&a.imageSrcSet?void 0:n,as:r},a),Fr.set(m,n),c.querySelector(f)!==null||r==="style"&&c.querySelector(kc(m))||r==="script"&&c.querySelector(Sc(m))||(r=c.createElement("link"),Ds(r,"link",n),zt(r),c.head.appendChild(r)))}}function qT(n,r){Wi.m(n,r);var a=gl;if(a&&n){var c=r&&typeof r.as=="string"?r.as:"script",f='link[rel="modulepreload"][as="'+Yn(c)+'"][href="'+Yn(n)+'"]',m=f;switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":m=vl(n)}if(!Fr.has(m)&&(n=E({rel:"modulepreload",href:n},r),Fr.set(m,n),a.querySelector(f)===null)){switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(a.querySelector(Sc(m)))return}c=a.createElement("link"),Ds(c,"link",n),zt(c),a.head.appendChild(c)}}}function HT(n,r,a){Wi.S(n,r,a);var c=gl;if(c&&n){var f=as(c).hoistableStyles,m=yl(n);r=r||"default";var _=f.get(m);if(!_){var k={loading:0,preload:null};if(_=c.querySelector(kc(m)))k.loading=5;else{n=E({rel:"stylesheet",href:n,"data-precedence":r},a),(a=Fr.get(m))&&Jm(n,a);var U=_=c.createElement("link");zt(U),Ds(U,"link",n),U._p=new Promise(function(J,de){U.onload=J,U.onerror=de}),U.addEventListener("load",function(){k.loading|=1}),U.addEventListener("error",function(){k.loading|=2}),k.loading|=4,Lh(_,r,c)}_={type:"stylesheet",instance:_,count:1,state:k},f.set(m,_)}}}function $T(n,r){Wi.X(n,r);var a=gl;if(a&&n){var c=as(a).hoistableScripts,f=vl(n),m=c.get(f);m||(m=a.querySelector(Sc(f)),m||(n=E({src:n,async:!0},r),(r=Fr.get(f))&&Zm(n,r),m=a.createElement("script"),zt(m),Ds(m,"link",n),a.head.appendChild(m)),m={type:"script",instance:m,count:1,state:null},c.set(f,m))}}function WT(n,r){Wi.M(n,r);var a=gl;if(a&&n){var c=as(a).hoistableScripts,f=vl(n),m=c.get(f);m||(m=a.querySelector(Sc(f)),m||(n=E({src:n,async:!0,type:"module"},r),(r=Fr.get(f))&&Zm(n,r),m=a.createElement("script"),zt(m),Ds(m,"link",n),a.head.appendChild(m)),m={type:"script",instance:m,count:1,state:null},c.set(f,m))}}function F1(n,r,a,c){var f=(f=xe.current)?Mh(f):null;if(!f)throw Error(i(446));switch(n){case"meta":case"title":return null;case"style":return typeof a.precedence=="string"&&typeof a.href=="string"?(r=yl(a.href),a=as(f).hoistableStyles,c=a.get(r),c||(c={type:"style",instance:null,count:0,state:null},a.set(r,c)),c):{type:"void",instance:null,count:0,state:null};case"link":if(a.rel==="stylesheet"&&typeof a.href=="string"&&typeof a.precedence=="string"){n=yl(a.href);var m=as(f).hoistableStyles,_=m.get(n);if(_||(f=f.ownerDocument||f,_={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},m.set(n,_),(m=f.querySelector(kc(n)))&&!m._p&&(_.instance=m,_.state.loading=5),Fr.has(n)||(a={rel:"preload",as:"style",href:a.href,crossOrigin:a.crossOrigin,integrity:a.integrity,media:a.media,hrefLang:a.hrefLang,referrerPolicy:a.referrerPolicy},Fr.set(n,a),m||GT(f,n,a,_.state))),r&&c===null)throw Error(i(528,""));return _}if(r&&c!==null)throw Error(i(529,""));return null;case"script":return r=a.async,a=a.src,typeof a=="string"&&r&&typeof r!="function"&&typeof r!="symbol"?(r=vl(a),a=as(f).hoistableScripts,c=a.get(r),c||(c={type:"script",instance:null,count:0,state:null},a.set(r,c)),c):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,n))}}function yl(n){return'href="'+Yn(n)+'"'}function kc(n){return'link[rel="stylesheet"]['+n+"]"}function q1(n){return E({},n,{"data-precedence":n.precedence,precedence:null})}function GT(n,r,a,c){n.querySelector('link[rel="preload"][as="style"]['+r+"]")?c.loading=1:(r=n.createElement("link"),c.preload=r,r.addEventListener("load",function(){return c.loading|=1}),r.addEventListener("error",function(){return c.loading|=2}),Ds(r,"link",a),zt(r),n.head.appendChild(r))}function vl(n){return'[src="'+Yn(n)+'"]'}function Sc(n){return"script[async]"+n}function H1(n,r,a){if(r.count++,r.instance===null)switch(r.type){case"style":var c=n.querySelector('style[data-href~="'+Yn(a.href)+'"]');if(c)return r.instance=c,zt(c),c;var f=E({},a,{"data-href":a.href,"data-precedence":a.precedence,href:null,precedence:null});return c=(n.ownerDocument||n).createElement("style"),zt(c),Ds(c,"style",f),Lh(c,a.precedence,n),r.instance=c;case"stylesheet":f=yl(a.href);var m=n.querySelector(kc(f));if(m)return r.state.loading|=4,r.instance=m,zt(m),m;c=q1(a),(f=Fr.get(f))&&Jm(c,f),m=(n.ownerDocument||n).createElement("link"),zt(m);var _=m;return _._p=new Promise(function(k,U){_.onload=k,_.onerror=U}),Ds(m,"link",c),r.state.loading|=4,Lh(m,a.precedence,n),r.instance=m;case"script":return m=vl(a.src),(f=n.querySelector(Sc(m)))?(r.instance=f,zt(f),f):(c=a,(f=Fr.get(m))&&(c=E({},a),Zm(c,f)),n=n.ownerDocument||n,f=n.createElement("script"),zt(f),Ds(f,"link",c),n.head.appendChild(f),r.instance=f);case"void":return null;default:throw Error(i(443,r.type))}else r.type==="stylesheet"&&(r.state.loading&4)===0&&(c=r.instance,r.state.loading|=4,Lh(c,a.precedence,n));return r.instance}function Lh(n,r,a){for(var c=a.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),f=c.length?c[c.length-1]:null,m=f,_=0;_<c.length;_++){var k=c[_];if(k.dataset.precedence===r)m=k;else if(m!==f)break}m?m.parentNode.insertBefore(n,m.nextSibling):(r=a.nodeType===9?a.head:a,r.insertBefore(n,r.firstChild))}function Jm(n,r){n.crossOrigin==null&&(n.crossOrigin=r.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=r.referrerPolicy),n.title==null&&(n.title=r.title)}function Zm(n,r){n.crossOrigin==null&&(n.crossOrigin=r.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=r.referrerPolicy),n.integrity==null&&(n.integrity=r.integrity)}var Oh=null;function $1(n,r,a){if(Oh===null){var c=new Map,f=Oh=new Map;f.set(a,c)}else f=Oh,c=f.get(a),c||(c=new Map,f.set(a,c));if(c.has(n))return c;for(c.set(n,null),a=a.getElementsByTagName(n),f=0;f<a.length;f++){var m=a[f];if(!(m[qn]||m[Jt]||n==="link"&&m.getAttribute("rel")==="stylesheet")&&m.namespaceURI!=="http://www.w3.org/2000/svg"){var _=m.getAttribute(r)||"";_=n+_;var k=c.get(_);k?k.push(m):c.set(_,[m])}}return c}function W1(n,r,a){n=n.ownerDocument||n,n.head.insertBefore(a,r==="title"?n.querySelector("head > title"):null)}function KT(n,r,a){if(a===1||r.itemProp!=null)return!1;switch(n){case"meta":case"title":return!0;case"style":if(typeof r.precedence!="string"||typeof r.href!="string"||r.href==="")break;return!0;case"link":if(typeof r.rel!="string"||typeof r.href!="string"||r.href===""||r.onLoad||r.onError)break;return r.rel==="stylesheet"?(n=r.disabled,typeof r.precedence=="string"&&n==null):!0;case"script":if(r.async&&typeof r.async!="function"&&typeof r.async!="symbol"&&!r.onLoad&&!r.onError&&r.src&&typeof r.src=="string")return!0}return!1}function G1(n){return!(n.type==="stylesheet"&&(n.state.loading&3)===0)}function YT(n,r,a,c){if(a.type==="stylesheet"&&(typeof c.media!="string"||matchMedia(c.media).matches!==!1)&&(a.state.loading&4)===0){if(a.instance===null){var f=yl(c.href),m=r.querySelector(kc(f));if(m){r=m._p,r!==null&&typeof r=="object"&&typeof r.then=="function"&&(n.count++,n=Ph.bind(n),r.then(n,n)),a.state.loading|=4,a.instance=m,zt(m);return}m=r.ownerDocument||r,c=q1(c),(f=Fr.get(f))&&Jm(c,f),m=m.createElement("link"),zt(m);var _=m;_._p=new Promise(function(k,U){_.onload=k,_.onerror=U}),Ds(m,"link",c),a.instance=m}n.stylesheets===null&&(n.stylesheets=new Map),n.stylesheets.set(a,r),(r=a.state.preload)&&(a.state.loading&3)===0&&(n.count++,a=Ph.bind(n),r.addEventListener("load",a),r.addEventListener("error",a))}}var ep=0;function QT(n,r){return n.stylesheets&&n.count===0&&Uh(n,n.stylesheets),0<n.count||0<n.imgCount?function(a){var c=setTimeout(function(){if(n.stylesheets&&Uh(n,n.stylesheets),n.unsuspend){var m=n.unsuspend;n.unsuspend=null,m()}},6e4+r);0<n.imgBytes&&ep===0&&(ep=62500*AT());var f=setTimeout(function(){if(n.waitingForImages=!1,n.count===0&&(n.stylesheets&&Uh(n,n.stylesheets),n.unsuspend)){var m=n.unsuspend;n.unsuspend=null,m()}},(n.imgBytes>ep?50:800)+r);return n.unsuspend=a,function(){n.unsuspend=null,clearTimeout(c),clearTimeout(f)}}:null}function Ph(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Uh(this,this.stylesheets);else if(this.unsuspend){var n=this.unsuspend;this.unsuspend=null,n()}}}var Vh=null;function Uh(n,r){n.stylesheets=null,n.unsuspend!==null&&(n.count++,Vh=new Map,r.forEach(XT,n),Vh=null,Ph.call(n))}function XT(n,r){if(!(r.state.loading&4)){var a=Vh.get(n);if(a)var c=a.get(null);else{a=new Map,Vh.set(n,a);for(var f=n.querySelectorAll("link[data-precedence],style[data-precedence]"),m=0;m<f.length;m++){var _=f[m];(_.nodeName==="LINK"||_.getAttribute("media")!=="not all")&&(a.set(_.dataset.precedence,_),c=_)}c&&a.set(null,c)}f=r.instance,_=f.getAttribute("data-precedence"),m=a.get(_)||c,m===c&&a.set(null,f),a.set(_,f),this.count++,c=Ph.bind(this),f.addEventListener("load",c),f.addEventListener("error",c),m?m.parentNode.insertBefore(f,m.nextSibling):(n=n.nodeType===9?n.head:n,n.insertBefore(f,n.firstChild)),r.state.loading|=4}}var jc={$$typeof:ee,Provider:null,Consumer:null,_currentValue:Ie,_currentValue2:Ie,_threadCount:0};function JT(n,r,a,c,f,m,_,k,U){this.tag=1,this.containerInfo=n,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Ae(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ae(0),this.hiddenUpdates=Ae(null),this.identifierPrefix=c,this.onUncaughtError=f,this.onCaughtError=m,this.onRecoverableError=_,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=U,this.incompleteTransitions=new Map}function K1(n,r,a,c,f,m,_,k,U,J,de,ge){return n=new JT(n,r,a,_,U,J,de,ge,k),r=1,m===!0&&(r|=24),m=gr(3,null,null,r),n.current=m,m.stateNode=n,r=Df(),r.refCount++,n.pooledCache=r,r.refCount++,m.memoizedState={element:c,isDehydrated:a,cache:r},Pf(m),n}function Y1(n){return n?(n=Yo,n):Yo}function Q1(n,r,a,c,f,m){f=Y1(f),c.context===null?c.context=f:c.pendingContext=f,c=pa(r),c.payload={element:a},m=m===void 0?null:m,m!==null&&(c.callback=m),a=ga(n,c,r),a!==null&&(lr(a,n,r),ic(a,n,r))}function X1(n,r){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var a=n.retryLane;n.retryLane=a!==0&&a<r?a:r}}function tp(n,r){X1(n,r),(n=n.alternate)&&X1(n,r)}function J1(n){if(n.tag===13||n.tag===31){var r=oo(n,67108864);r!==null&&lr(r,n,67108864),tp(n,67108864)}}function Z1(n){if(n.tag===13||n.tag===31){var r=wr();r=dn(r);var a=oo(n,r);a!==null&&lr(a,n,r),tp(n,r)}}var Bh=!0;function ZT(n,r,a,c){var f=Z.T;Z.T=null;var m=we.p;try{we.p=2,np(n,r,a,c)}finally{we.p=m,Z.T=f}}function ek(n,r,a,c){var f=Z.T;Z.T=null;var m=we.p;try{we.p=8,np(n,r,a,c)}finally{we.p=m,Z.T=f}}function np(n,r,a,c){if(Bh){var f=sp(c);if(f===null)Fm(n,r,c,zh,a),tb(n,c);else if(nk(f,n,r,a,c))c.stopPropagation();else if(tb(n,c),r&4&&-1<tk.indexOf(n)){for(;f!==null;){var m=kn(f);if(m!==null)switch(m.tag){case 3:if(m=m.stateNode,m.current.memoizedState.isDehydrated){var _=Fn(m.pendingLanes);if(_!==0){var k=m;for(k.pendingLanes|=2,k.entangledLanes|=2;_;){var U=1<<31-Fe(_);k.entanglements[1]|=U,_&=~U}mi(m),(hn&6)===0&&(Eh=vt()+500,wc(0))}}break;case 31:case 13:k=oo(m,2),k!==null&&lr(k,m,2),kh(),tp(m,2)}if(m=sp(c),m===null&&Fm(n,r,c,zh,a),m===f)break;f=m}f!==null&&c.stopPropagation()}else Fm(n,r,c,null,a)}}function sp(n){return n=Y(n),rp(n)}var zh=null;function rp(n){if(zh=null,n=ws(n),n!==null){var r=u(n);if(r===null)n=null;else{var a=r.tag;if(a===13){if(n=h(r),n!==null)return n;n=null}else if(a===31){if(n=p(r),n!==null)return n;n=null}else if(a===3){if(r.stateNode.current.memoizedState.isDehydrated)return r.tag===3?r.stateNode.containerInfo:null;n=null}else r!==n&&(n=null)}}return zh=n,null}function eb(n){switch(n){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(nn()){case js:return 2;case rs:return 8;case Xt:case ne:return 32;case Ne:return 268435456;default:return 32}default:return 32}}var ip=!1,ja=null,Ca=null,Na=null,Cc=new Map,Nc=new Map,Aa=[],tk="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function tb(n,r){switch(n){case"focusin":case"focusout":ja=null;break;case"dragenter":case"dragleave":Ca=null;break;case"mouseover":case"mouseout":Na=null;break;case"pointerover":case"pointerout":Cc.delete(r.pointerId);break;case"gotpointercapture":case"lostpointercapture":Nc.delete(r.pointerId)}}function Ac(n,r,a,c,f,m){return n===null||n.nativeEvent!==m?(n={blockedOn:r,domEventName:a,eventSystemFlags:c,nativeEvent:m,targetContainers:[f]},r!==null&&(r=kn(r),r!==null&&J1(r)),n):(n.eventSystemFlags|=c,r=n.targetContainers,f!==null&&r.indexOf(f)===-1&&r.push(f),n)}function nk(n,r,a,c,f){switch(r){case"focusin":return ja=Ac(ja,n,r,a,c,f),!0;case"dragenter":return Ca=Ac(Ca,n,r,a,c,f),!0;case"mouseover":return Na=Ac(Na,n,r,a,c,f),!0;case"pointerover":var m=f.pointerId;return Cc.set(m,Ac(Cc.get(m)||null,n,r,a,c,f)),!0;case"gotpointercapture":return m=f.pointerId,Nc.set(m,Ac(Nc.get(m)||null,n,r,a,c,f)),!0}return!1}function nb(n){var r=ws(n.target);if(r!==null){var a=u(r);if(a!==null){if(r=a.tag,r===13){if(r=h(a),r!==null){n.blockedOn=r,is(n.priority,function(){Z1(a)});return}}else if(r===31){if(r=p(a),r!==null){n.blockedOn=r,is(n.priority,function(){Z1(a)});return}}else if(r===3&&a.stateNode.current.memoizedState.isDehydrated){n.blockedOn=a.tag===3?a.stateNode.containerInfo:null;return}}}n.blockedOn=null}function Fh(n){if(n.blockedOn!==null)return!1;for(var r=n.targetContainers;0<r.length;){var a=sp(n.nativeEvent);if(a===null){a=n.nativeEvent;var c=new a.constructor(a.type,a);P=c,a.target.dispatchEvent(c),P=null}else return r=kn(a),r!==null&&J1(r),n.blockedOn=a,!1;r.shift()}return!0}function sb(n,r,a){Fh(n)&&a.delete(r)}function sk(){ip=!1,ja!==null&&Fh(ja)&&(ja=null),Ca!==null&&Fh(Ca)&&(Ca=null),Na!==null&&Fh(Na)&&(Na=null),Cc.forEach(sb),Nc.forEach(sb)}function qh(n,r){n.blockedOn===r&&(n.blockedOn=null,ip||(ip=!0,s.unstable_scheduleCallback(s.unstable_NormalPriority,sk)))}var Hh=null;function rb(n){Hh!==n&&(Hh=n,s.unstable_scheduleCallback(s.unstable_NormalPriority,function(){Hh===n&&(Hh=null);for(var r=0;r<n.length;r+=3){var a=n[r],c=n[r+1],f=n[r+2];if(typeof c!="function"){if(rp(c||a)===null)continue;break}var m=kn(a);m!==null&&(n.splice(r,3),r-=3,sm(m,{pending:!0,data:f,method:a.method,action:c},c,f))}}))}function bl(n){function r(U){return qh(U,n)}ja!==null&&qh(ja,n),Ca!==null&&qh(Ca,n),Na!==null&&qh(Na,n),Cc.forEach(r),Nc.forEach(r);for(var a=0;a<Aa.length;a++){var c=Aa[a];c.blockedOn===n&&(c.blockedOn=null)}for(;0<Aa.length&&(a=Aa[0],a.blockedOn===null);)nb(a),a.blockedOn===null&&Aa.shift();if(a=(n.ownerDocument||n).$$reactFormReplay,a!=null)for(c=0;c<a.length;c+=3){var f=a[c],m=a[c+1],_=f[An]||null;if(typeof m=="function")_||rb(a);else if(_){var k=null;if(m&&m.hasAttribute("formAction")){if(f=m,_=m[An]||null)k=_.formAction;else if(rp(f)!==null)continue}else k=_.action;typeof k=="function"?a[c+1]=k:(a.splice(c,3),c-=3),rb(a)}}}function ib(){function n(m){m.canIntercept&&m.info==="react-transition"&&m.intercept({handler:function(){return new Promise(function(_){return f=_})},focusReset:"manual",scroll:"manual"})}function r(){f!==null&&(f(),f=null),c||setTimeout(a,20)}function a(){if(!c&&!navigation.transition){var m=navigation.currentEntry;m&&m.url!=null&&navigation.navigate(m.url,{state:m.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var c=!1,f=null;return navigation.addEventListener("navigate",n),navigation.addEventListener("navigatesuccess",r),navigation.addEventListener("navigateerror",r),setTimeout(a,100),function(){c=!0,navigation.removeEventListener("navigate",n),navigation.removeEventListener("navigatesuccess",r),navigation.removeEventListener("navigateerror",r),f!==null&&(f(),f=null)}}}function ap(n){this._internalRoot=n}$h.prototype.render=ap.prototype.render=function(n){var r=this._internalRoot;if(r===null)throw Error(i(409));var a=r.current,c=wr();Q1(a,c,n,r,null,null)},$h.prototype.unmount=ap.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var r=n.containerInfo;Q1(n.current,2,null,n,null,null),kh(),r[Ns]=null}};function $h(n){this._internalRoot=n}$h.prototype.unstable_scheduleHydration=function(n){if(n){var r=Cs();n={blockedOn:null,target:n,priority:r};for(var a=0;a<Aa.length&&r!==0&&r<Aa[a].priority;a++);Aa.splice(a,0,n),a===0&&nb(n)}};var ab=e.version;if(ab!=="19.2.4")throw Error(i(527,ab,"19.2.4"));we.findDOMNode=function(n){var r=n._reactInternals;if(r===void 0)throw typeof n.render=="function"?Error(i(188)):(n=Object.keys(n).join(","),Error(i(268,n)));return n=y(r),n=n!==null?b(n):null,n=n===null?null:n.stateNode,n};var rk={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:Z,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Wh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Wh.isDisabled&&Wh.supportsFiber)try{it=Wh.inject(rk),$e=Wh}catch{}}return Ic.createRoot=function(n,r){if(!l(n))throw Error(i(299));var a=!1,c="",f=f0,m=m0,_=p0;return r!=null&&(r.unstable_strictMode===!0&&(a=!0),r.identifierPrefix!==void 0&&(c=r.identifierPrefix),r.onUncaughtError!==void 0&&(f=r.onUncaughtError),r.onCaughtError!==void 0&&(m=r.onCaughtError),r.onRecoverableError!==void 0&&(_=r.onRecoverableError)),r=K1(n,1,!1,null,null,a,c,null,f,m,_,ib),n[Ns]=r.current,zm(n),new ap(r)},Ic.hydrateRoot=function(n,r,a){if(!l(n))throw Error(i(299));var c=!1,f="",m=f0,_=m0,k=p0,U=null;return a!=null&&(a.unstable_strictMode===!0&&(c=!0),a.identifierPrefix!==void 0&&(f=a.identifierPrefix),a.onUncaughtError!==void 0&&(m=a.onUncaughtError),a.onCaughtError!==void 0&&(_=a.onCaughtError),a.onRecoverableError!==void 0&&(k=a.onRecoverableError),a.formState!==void 0&&(U=a.formState)),r=K1(n,1,!0,r,a??null,c,f,U,m,_,k,ib),r.context=Y1(null),a=r.current,c=wr(),c=dn(c),f=pa(c),f.callback=null,ga(a,f,c),a=c,r.current.lanes=a,Ge(r,a),mi(r),n[Ns]=r.current,zm(n),new $h(r)},Ic.version="19.2.4",Ic}var gb;function mk(){if(gb)return cp.exports;gb=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(e){console.error(e)}}return s(),cp.exports=fk(),cp.exports}var pk=mk();const gk="modulepreload",yk=function(s){return"/login/"+s},yb={},Gs=function(e,t,i){let l=Promise.resolve();if(t&&t.length>0){let g=function(y){return Promise.all(y.map(b=>Promise.resolve(b).then(E=>({status:"fulfilled",value:E}),E=>({status:"rejected",reason:E}))))};document.getElementsByTagName("link");const h=document.querySelector("meta[property=csp-nonce]"),p=h?.nonce||h?.getAttribute("nonce");l=g(t.map(y=>{if(y=yk(y),y in yb)return;yb[y]=!0;const b=y.endsWith(".css"),E=b?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${y}"]${E}`))return;const T=document.createElement("link");if(T.rel=b?"stylesheet":gk,b||(T.as="script"),T.crossOrigin="",T.href=y,p&&T.setAttribute("nonce",p),document.head.appendChild(T),b)return new Promise((O,H)=>{T.addEventListener("load",O),T.addEventListener("error",()=>H(new Error(`Unable to preload CSS for ${y}`)))})}))}function u(h){const p=new Event("vite:preloadError",{cancelable:!0});if(p.payload=h,window.dispatchEvent(p),!p.defaultPrevented)throw h}return l.then(h=>{for(const p of h||[])p.status==="rejected"&&u(p.reason);return e().catch(u)})};var vb="popstate";function vk(s={}){function e(i,l){let{pathname:u,search:h,hash:p}=i.location;return qp("",{pathname:u,search:h,hash:p},l.state&&l.state.usr||null,l.state&&l.state.key||"default")}function t(i,l){return typeof l=="string"?l:Jc(l)}return _k(e,t,null,s)}function Gn(s,e){if(s===!1||s===null||typeof s>"u")throw new Error(e)}function Wr(s,e){if(!s){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function bk(){return Math.random().toString(36).substring(2,10)}function bb(s,e){return{usr:s.state,key:s.key,idx:e}}function qp(s,e,t=null,i){return{pathname:typeof s=="string"?s:s.pathname,search:"",hash:"",...typeof e=="string"?Vl(e):e,state:t,key:e&&e.key||i||bk()}}function Jc({pathname:s="/",search:e="",hash:t=""}){return e&&e!=="?"&&(s+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(s+=t.charAt(0)==="#"?t:"#"+t),s}function Vl(s){let e={};if(s){let t=s.indexOf("#");t>=0&&(e.hash=s.substring(t),s=s.substring(0,t));let i=s.indexOf("?");i>=0&&(e.search=s.substring(i),s=s.substring(0,i)),s&&(e.pathname=s)}return e}function _k(s,e,t,i={}){let{window:l=document.defaultView,v5Compat:u=!1}=i,h=l.history,p="POP",g=null,y=b();y==null&&(y=0,h.replaceState({...h.state,idx:y},""));function b(){return(h.state||{idx:null}).idx}function E(){p="POP";let B=b(),te=B==null?null:B-y;y=B,g&&g({action:p,location:q.location,delta:te})}function T(B,te){p="PUSH";let W=qp(q.location,B,te);y=b()+1;let ee=bb(W,y),pe=q.createHref(W);try{h.pushState(ee,"",pe)}catch(Te){if(Te instanceof DOMException&&Te.name==="DataCloneError")throw Te;l.location.assign(pe)}u&&g&&g({action:p,location:q.location,delta:1})}function O(B,te){p="REPLACE";let W=qp(q.location,B,te);y=b();let ee=bb(W,y),pe=q.createHref(W);h.replaceState(ee,"",pe),u&&g&&g({action:p,location:q.location,delta:0})}function H(B){return wk(B)}let q={get action(){return p},get location(){return s(l,h)},listen(B){if(g)throw new Error("A history only accepts one active listener");return l.addEventListener(vb,E),g=B,()=>{l.removeEventListener(vb,E),g=null}},createHref(B){return e(l,B)},createURL:H,encodeLocation(B){let te=H(B);return{pathname:te.pathname,search:te.search,hash:te.hash}},push:T,replace:O,go(B){return h.go(B)}};return q}function wk(s,e=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),Gn(t,"No window.location.(origin|href) available to create URL");let i=typeof s=="string"?s:Jc(s);return i=i.replace(/ $/,"%20"),!e&&i.startsWith("//")&&(i=t+i),new URL(i,t)}function __(s,e,t="/"){return xk(s,e,t,!1)}function xk(s,e,t,i){let l=typeof e=="string"?Vl(e):e,u=Ji(l.pathname||"/",t);if(u==null)return null;let h=w_(s);Ek(h);let p=null;for(let g=0;p==null&&g<h.length;++g){let y=Mk(u);p=Ik(h[g],y,i)}return p}function w_(s,e=[],t=[],i="",l=!1){let u=(h,p,g=l,y)=>{let b={relativePath:y===void 0?h.path||"":y,caseSensitive:h.caseSensitive===!0,childrenIndex:p,route:h};if(b.relativePath.startsWith("/")){if(!b.relativePath.startsWith(i)&&g)return;Gn(b.relativePath.startsWith(i),`Absolute route path "${b.relativePath}" nested under path "${i}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),b.relativePath=b.relativePath.slice(i.length)}let E=Yi([i,b.relativePath]),T=t.concat(b);h.children&&h.children.length>0&&(Gn(h.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${E}".`),w_(h.children,e,T,E,g)),!(h.path==null&&!h.index)&&e.push({path:E,score:Ak(E,h.index),routesMeta:T})};return s.forEach((h,p)=>{if(h.path===""||!h.path?.includes("?"))u(h,p);else for(let g of x_(h.path))u(h,p,!0,g)}),e}function x_(s){let e=s.split("/");if(e.length===0)return[];let[t,...i]=e,l=t.endsWith("?"),u=t.replace(/\?$/,"");if(i.length===0)return l?[u,""]:[u];let h=x_(i.join("/")),p=[];return p.push(...h.map(g=>g===""?u:[u,g].join("/"))),l&&p.push(...h),p.map(g=>s.startsWith("/")&&g===""?"/":g)}function Ek(s){s.sort((e,t)=>e.score!==t.score?t.score-e.score:Rk(e.routesMeta.map(i=>i.childrenIndex),t.routesMeta.map(i=>i.childrenIndex)))}var Tk=/^:[\w-]+$/,kk=3,Sk=2,jk=1,Ck=10,Nk=-2,_b=s=>s==="*";function Ak(s,e){let t=s.split("/"),i=t.length;return t.some(_b)&&(i+=Nk),e&&(i+=Sk),t.filter(l=>!_b(l)).reduce((l,u)=>l+(Tk.test(u)?kk:u===""?jk:Ck),i)}function Rk(s,e){return s.length===e.length&&s.slice(0,-1).every((i,l)=>i===e[l])?s[s.length-1]-e[e.length-1]:0}function Ik(s,e,t=!1){let{routesMeta:i}=s,l={},u="/",h=[];for(let p=0;p<i.length;++p){let g=i[p],y=p===i.length-1,b=u==="/"?e:e.slice(u.length)||"/",E=_d({path:g.relativePath,caseSensitive:g.caseSensitive,end:y},b),T=g.route;if(!E&&y&&t&&!i[i.length-1].route.index&&(E=_d({path:g.relativePath,caseSensitive:g.caseSensitive,end:!1},b)),!E)return null;Object.assign(l,E.params),h.push({params:l,pathname:Yi([u,E.pathname]),pathnameBase:Vk(Yi([u,E.pathnameBase])),route:T}),E.pathnameBase!=="/"&&(u=Yi([u,E.pathnameBase]))}return h}function _d(s,e){typeof s=="string"&&(s={path:s,caseSensitive:!1,end:!0});let[t,i]=Dk(s.path,s.caseSensitive,s.end),l=e.match(t);if(!l)return null;let u=l[0],h=u.replace(/(.)\/+$/,"$1"),p=l.slice(1);return{params:i.reduce((y,{paramName:b,isOptional:E},T)=>{if(b==="*"){let H=p[T]||"";h=u.slice(0,u.length-H.length).replace(/(.)\/+$/,"$1")}const O=p[T];return E&&!O?y[b]=void 0:y[b]=(O||"").replace(/%2F/g,"/"),y},{}),pathname:u,pathnameBase:h,pattern:s}}function Dk(s,e=!1,t=!0){Wr(s==="*"||!s.endsWith("*")||s.endsWith("/*"),`Route path "${s}" will be treated as if it were "${s.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${s.replace(/\*$/,"/*")}".`);let i=[],l="^"+s.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(h,p,g)=>(i.push({paramName:p,isOptional:g!=null}),g?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return s.endsWith("*")?(i.push({paramName:"*"}),l+=s==="*"||s==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?l+="\\/*$":s!==""&&s!=="/"&&(l+="(?:(?=\\/|$))"),[new RegExp(l,e?void 0:"i"),i]}function Mk(s){try{return s.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Wr(!1,`The URL path "${s}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),s}}function Ji(s,e){if(e==="/")return s;if(!s.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,i=s.charAt(t);return i&&i!=="/"?null:s.slice(t)||"/"}var Lk=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i;function Ok(s,e="/"){let{pathname:t,search:i="",hash:l=""}=typeof s=="string"?Vl(s):s,u;return t?(t=t.replace(/\/\/+/g,"/"),t.startsWith("/")?u=wb(t.substring(1),"/"):u=wb(t,e)):u=e,{pathname:u,search:Uk(i),hash:Bk(l)}}function wb(s,e){let t=e.replace(/\/+$/,"").split("/");return s.split("/").forEach(l=>{l===".."?t.length>1&&t.pop():l!=="."&&t.push(l)}),t.length>1?t.join("/"):"/"}function fp(s,e,t,i){return`Cannot include a '${s}' character in a manually specified \`to.${e}\` field [${JSON.stringify(i)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function Pk(s){return s.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function Eg(s){let e=Pk(s);return e.map((t,i)=>i===e.length-1?t.pathname:t.pathnameBase)}function Tg(s,e,t,i=!1){let l;typeof s=="string"?l=Vl(s):(l={...s},Gn(!l.pathname||!l.pathname.includes("?"),fp("?","pathname","search",l)),Gn(!l.pathname||!l.pathname.includes("#"),fp("#","pathname","hash",l)),Gn(!l.search||!l.search.includes("#"),fp("#","search","hash",l)));let u=s===""||l.pathname==="",h=u?"/":l.pathname,p;if(h==null)p=t;else{let E=e.length-1;if(!i&&h.startsWith("..")){let T=h.split("/");for(;T[0]==="..";)T.shift(),E-=1;l.pathname=T.join("/")}p=E>=0?e[E]:"/"}let g=Ok(l,p),y=h&&h!=="/"&&h.endsWith("/"),b=(u||h===".")&&t.endsWith("/");return!g.pathname.endsWith("/")&&(y||b)&&(g.pathname+="/"),g}var Yi=s=>s.join("/").replace(/\/\/+/g,"/"),Vk=s=>s.replace(/\/+$/,"").replace(/^\/*/,"/"),Uk=s=>!s||s==="?"?"":s.startsWith("?")?s:"?"+s,Bk=s=>!s||s==="#"?"":s.startsWith("#")?s:"#"+s,zk=class{constructor(s,e,t,i=!1){this.status=s,this.statusText=e||"",this.internal=i,t instanceof Error?(this.data=t.toString(),this.error=t):this.data=t}};function Fk(s){return s!=null&&typeof s.status=="number"&&typeof s.statusText=="string"&&typeof s.internal=="boolean"&&"data"in s}function qk(s){return s.map(e=>e.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var E_=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function T_(s,e){let t=s;if(typeof t!="string"||!Lk.test(t))return{absoluteURL:void 0,isExternal:!1,to:t};let i=t,l=!1;if(E_)try{let u=new URL(window.location.href),h=t.startsWith("//")?new URL(u.protocol+t):new URL(t),p=Ji(h.pathname,e);h.origin===u.origin&&p!=null?t=p+h.search+h.hash:l=!0}catch{Wr(!1,`<Link to="${t}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:i,isExternal:l,to:t}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var k_=["POST","PUT","PATCH","DELETE"];new Set(k_);var Hk=["GET",...k_];new Set(Hk);var Ul=w.createContext(null);Ul.displayName="DataRouter";var zd=w.createContext(null);zd.displayName="DataRouterState";var $k=w.createContext(!1),S_=w.createContext({isTransitioning:!1});S_.displayName="ViewTransition";var Wk=w.createContext(new Map);Wk.displayName="Fetchers";var Gk=w.createContext(null);Gk.displayName="Await";var kr=w.createContext(null);kr.displayName="Navigation";var fu=w.createContext(null);fu.displayName="Location";var ii=w.createContext({outlet:null,matches:[],isDataRoute:!1});ii.displayName="Route";var kg=w.createContext(null);kg.displayName="RouteError";var j_="REACT_ROUTER_ERROR",Kk="REDIRECT",Yk="ROUTE_ERROR_RESPONSE";function Qk(s){if(s.startsWith(`${j_}:${Kk}:{`))try{let e=JSON.parse(s.slice(28));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.location=="string"&&typeof e.reloadDocument=="boolean"&&typeof e.replace=="boolean")return e}catch{}}function Xk(s){if(s.startsWith(`${j_}:${Yk}:{`))try{let e=JSON.parse(s.slice(40));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string")return new zk(e.status,e.statusText,e.data)}catch{}}function Jk(s,{relative:e}={}){Gn(Bl(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:i}=w.useContext(kr),{hash:l,pathname:u,search:h}=mu(s,{relative:e}),p=u;return t!=="/"&&(p=u==="/"?t:Yi([t,u])),i.createHref({pathname:p,search:h,hash:l})}function Bl(){return w.useContext(fu)!=null}function Si(){return Gn(Bl(),"useLocation() may be used only in the context of a <Router> component."),w.useContext(fu).location}var C_="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function N_(s){w.useContext(kr).static||w.useLayoutEffect(s)}function Sr(){let{isDataRoute:s}=w.useContext(ii);return s?dS():Zk()}function Zk(){Gn(Bl(),"useNavigate() may be used only in the context of a <Router> component.");let s=w.useContext(Ul),{basename:e,navigator:t}=w.useContext(kr),{matches:i}=w.useContext(ii),{pathname:l}=Si(),u=JSON.stringify(Eg(i)),h=w.useRef(!1);return N_(()=>{h.current=!0}),w.useCallback((g,y={})=>{if(Wr(h.current,C_),!h.current)return;if(typeof g=="number"){t.go(g);return}let b=Tg(g,JSON.parse(u),l,y.relative==="path");s==null&&e!=="/"&&(b.pathname=b.pathname==="/"?e:Yi([e,b.pathname])),(y.replace?t.replace:t.push)(b,y.state,y)},[e,t,u,l,s])}w.createContext(null);function eS(){let{matches:s}=w.useContext(ii),e=s[s.length-1];return e?e.params:{}}function mu(s,{relative:e}={}){let{matches:t}=w.useContext(ii),{pathname:i}=Si(),l=JSON.stringify(Eg(t));return w.useMemo(()=>Tg(s,JSON.parse(l),i,e==="path"),[s,l,i,e])}function tS(s,e){return A_(s,e)}function A_(s,e,t,i,l){Gn(Bl(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:u}=w.useContext(kr),{matches:h}=w.useContext(ii),p=h[h.length-1],g=p?p.params:{},y=p?p.pathname:"/",b=p?p.pathnameBase:"/",E=p&&p.route;{let W=E&&E.path||"";I_(y,!E||W.endsWith("*")||W.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${y}" (under <Route path="${W}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${W}"> to <Route path="${W==="/"?"*":`${W}/*`}">.`)}let T=Si(),O;if(e){let W=typeof e=="string"?Vl(e):e;Gn(b==="/"||W.pathname?.startsWith(b),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${b}" but pathname "${W.pathname}" was given in the \`location\` prop.`),O=W}else O=T;let H=O.pathname||"/",q=H;if(b!=="/"){let W=b.replace(/^\//,"").split("/");q="/"+H.replace(/^\//,"").split("/").slice(W.length).join("/")}let B=__(s,{pathname:q});Wr(E||B!=null,`No routes matched location "${O.pathname}${O.search}${O.hash}" `),Wr(B==null||B[B.length-1].route.element!==void 0||B[B.length-1].route.Component!==void 0||B[B.length-1].route.lazy!==void 0,`Matched leaf route at location "${O.pathname}${O.search}${O.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let te=aS(B&&B.map(W=>Object.assign({},W,{params:Object.assign({},g,W.params),pathname:Yi([b,u.encodeLocation?u.encodeLocation(W.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:W.pathname]),pathnameBase:W.pathnameBase==="/"?b:Yi([b,u.encodeLocation?u.encodeLocation(W.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:W.pathnameBase])})),h,t,i,l);return e&&te?w.createElement(fu.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...O},navigationType:"POP"}},te):te}function nS(){let s=hS(),e=Fk(s)?`${s.status} ${s.statusText}`:s instanceof Error?s.message:JSON.stringify(s),t=s instanceof Error?s.stack:null,i="rgba(200,200,200, 0.5)",l={padding:"0.5rem",backgroundColor:i},u={padding:"2px 4px",backgroundColor:i},h=null;return console.error("Error handled by React Router default ErrorBoundary:",s),h=w.createElement(w.Fragment,null,w.createElement("p",null," Hey developer "),w.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",w.createElement("code",{style:u},"ErrorBoundary")," or"," ",w.createElement("code",{style:u},"errorElement")," prop on your route.")),w.createElement(w.Fragment,null,w.createElement("h2",null,"Unexpected Application Error!"),w.createElement("h3",{style:{fontStyle:"italic"}},e),t?w.createElement("pre",{style:l},t):null,h)}var sS=w.createElement(nS,null),R_=class extends w.Component{constructor(s){super(s),this.state={location:s.location,revalidation:s.revalidation,error:s.error}}static getDerivedStateFromError(s){return{error:s}}static getDerivedStateFromProps(s,e){return e.location!==s.location||e.revalidation!=="idle"&&s.revalidation==="idle"?{error:s.error,location:s.location,revalidation:s.revalidation}:{error:s.error!==void 0?s.error:e.error,location:e.location,revalidation:s.revalidation||e.revalidation}}componentDidCatch(s,e){this.props.onError?this.props.onError(s,e):console.error("React Router caught the following error during render",s)}render(){let s=this.state.error;if(this.context&&typeof s=="object"&&s&&"digest"in s&&typeof s.digest=="string"){const t=Xk(s.digest);t&&(s=t)}let e=s!==void 0?w.createElement(ii.Provider,{value:this.props.routeContext},w.createElement(kg.Provider,{value:s,children:this.props.component})):this.props.children;return this.context?w.createElement(rS,{error:s},e):e}};R_.contextType=$k;var mp=new WeakMap;function rS({children:s,error:e}){let{basename:t}=w.useContext(kr);if(typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){let i=Qk(e.digest);if(i){let l=mp.get(e);if(l)throw l;let u=T_(i.location,t);if(E_&&!mp.get(e))if(u.isExternal||i.reloadDocument)window.location.href=u.absoluteURL||u.to;else{const h=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(u.to,{replace:i.replace}));throw mp.set(e,h),h}return w.createElement("meta",{httpEquiv:"refresh",content:`0;url=${u.absoluteURL||u.to}`})}}return s}function iS({routeContext:s,match:e,children:t}){let i=w.useContext(Ul);return i&&i.static&&i.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=e.route.id),w.createElement(ii.Provider,{value:s},t)}function aS(s,e=[],t=null,i=null,l=null){if(s==null){if(!t)return null;if(t.errors)s=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)s=t.matches;else return null}let u=s,h=t?.errors;if(h!=null){let b=u.findIndex(E=>E.route.id&&h?.[E.route.id]!==void 0);Gn(b>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(h).join(",")}`),u=u.slice(0,Math.min(u.length,b+1))}let p=!1,g=-1;if(t)for(let b=0;b<u.length;b++){let E=u[b];if((E.route.HydrateFallback||E.route.hydrateFallbackElement)&&(g=b),E.route.id){let{loaderData:T,errors:O}=t,H=E.route.loader&&!T.hasOwnProperty(E.route.id)&&(!O||O[E.route.id]===void 0);if(E.route.lazy||H){p=!0,g>=0?u=u.slice(0,g+1):u=[u[0]];break}}}let y=t&&i?(b,E)=>{i(b,{location:t.location,params:t.matches?.[0]?.params??{},unstable_pattern:qk(t.matches),errorInfo:E})}:void 0;return u.reduceRight((b,E,T)=>{let O,H=!1,q=null,B=null;t&&(O=h&&E.route.id?h[E.route.id]:void 0,q=E.route.errorElement||sS,p&&(g<0&&T===0?(I_("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),H=!0,B=null):g===T&&(H=!0,B=E.route.hydrateFallbackElement||null)));let te=e.concat(u.slice(0,T+1)),W=()=>{let ee;return O?ee=q:H?ee=B:E.route.Component?ee=w.createElement(E.route.Component,null):E.route.element?ee=E.route.element:ee=b,w.createElement(iS,{match:E,routeContext:{outlet:b,matches:te,isDataRoute:t!=null},children:ee})};return t&&(E.route.ErrorBoundary||E.route.errorElement||T===0)?w.createElement(R_,{location:t.location,revalidation:t.revalidation,component:q,error:O,children:W(),routeContext:{outlet:null,matches:te,isDataRoute:!0},onError:y}):W()},null)}function Sg(s){return`${s} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function oS(s){let e=w.useContext(Ul);return Gn(e,Sg(s)),e}function lS(s){let e=w.useContext(zd);return Gn(e,Sg(s)),e}function cS(s){let e=w.useContext(ii);return Gn(e,Sg(s)),e}function jg(s){let e=cS(s),t=e.matches[e.matches.length-1];return Gn(t.route.id,`${s} can only be used on routes that contain a unique "id"`),t.route.id}function uS(){return jg("useRouteId")}function hS(){let s=w.useContext(kg),e=lS("useRouteError"),t=jg("useRouteError");return s!==void 0?s:e.errors?.[t]}function dS(){let{router:s}=oS("useNavigate"),e=jg("useNavigate"),t=w.useRef(!1);return N_(()=>{t.current=!0}),w.useCallback(async(l,u={})=>{Wr(t.current,C_),t.current&&(typeof l=="number"?await s.navigate(l):await s.navigate(l,{fromRouteId:e,...u}))},[s,e])}var xb={};function I_(s,e,t){!e&&!xb[s]&&(xb[s]=!0,Wr(!1,t))}w.memo(fS);function fS({routes:s,future:e,state:t,onError:i}){return A_(s,void 0,t,i,e)}function D_({to:s,replace:e,state:t,relative:i}){Gn(Bl(),"<Navigate> may be used only in the context of a <Router> component.");let{static:l}=w.useContext(kr);Wr(!l,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:u}=w.useContext(ii),{pathname:h}=Si(),p=Sr(),g=Tg(s,Eg(u),h,i==="path"),y=JSON.stringify(g);return w.useEffect(()=>{p(JSON.parse(y),{replace:e,state:t,relative:i})},[p,y,i,e,t]),null}function Vn(s){Gn(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function mS({basename:s="/",children:e=null,location:t,navigationType:i="POP",navigator:l,static:u=!1,unstable_useTransitions:h}){Gn(!Bl(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let p=s.replace(/^\/*/,"/"),g=w.useMemo(()=>({basename:p,navigator:l,static:u,unstable_useTransitions:h,future:{}}),[p,l,u,h]);typeof t=="string"&&(t=Vl(t));let{pathname:y="/",search:b="",hash:E="",state:T=null,key:O="default"}=t,H=w.useMemo(()=>{let q=Ji(y,p);return q==null?null:{location:{pathname:q,search:b,hash:E,state:T,key:O},navigationType:i}},[p,y,b,E,T,O,i]);return Wr(H!=null,`<Router basename="${p}"> is not able to match the URL "${y}${b}${E}" because it does not start with the basename, so the <Router> won't render anything.`),H==null?null:w.createElement(kr.Provider,{value:g},w.createElement(fu.Provider,{children:e,value:H}))}function pS({children:s,location:e}){return tS(Hp(s),e)}function Hp(s,e=[]){let t=[];return w.Children.forEach(s,(i,l)=>{if(!w.isValidElement(i))return;let u=[...e,l];if(i.type===w.Fragment){t.push.apply(t,Hp(i.props.children,u));return}Gn(i.type===Vn,`[${typeof i.type=="string"?i.type:i.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Gn(!i.props.index||!i.props.children,"An index route cannot have child routes.");let h={id:i.props.id||u.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,middleware:i.props.middleware,loader:i.props.loader,action:i.props.action,hydrateFallbackElement:i.props.hydrateFallbackElement,HydrateFallback:i.props.HydrateFallback,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.hasErrorBoundary===!0||i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(h.children=Hp(i.props.children,u)),t.push(h)}),t}var od="get",ld="application/x-www-form-urlencoded";function Fd(s){return typeof HTMLElement<"u"&&s instanceof HTMLElement}function gS(s){return Fd(s)&&s.tagName.toLowerCase()==="button"}function yS(s){return Fd(s)&&s.tagName.toLowerCase()==="form"}function vS(s){return Fd(s)&&s.tagName.toLowerCase()==="input"}function bS(s){return!!(s.metaKey||s.altKey||s.ctrlKey||s.shiftKey)}function _S(s,e){return s.button===0&&(!e||e==="_self")&&!bS(s)}function $p(s=""){return new URLSearchParams(typeof s=="string"||Array.isArray(s)||s instanceof URLSearchParams?s:Object.keys(s).reduce((e,t)=>{let i=s[t];return e.concat(Array.isArray(i)?i.map(l=>[t,l]):[[t,i]])},[]))}function wS(s,e){let t=$p(s);return e&&e.forEach((i,l)=>{t.has(l)||e.getAll(l).forEach(u=>{t.append(l,u)})}),t}var Gh=null;function xS(){if(Gh===null)try{new FormData(document.createElement("form"),0),Gh=!1}catch{Gh=!0}return Gh}var ES=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function pp(s){return s!=null&&!ES.has(s)?(Wr(!1,`"${s}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${ld}"`),null):s}function TS(s,e){let t,i,l,u,h;if(yS(s)){let p=s.getAttribute("action");i=p?Ji(p,e):null,t=s.getAttribute("method")||od,l=pp(s.getAttribute("enctype"))||ld,u=new FormData(s)}else if(gS(s)||vS(s)&&(s.type==="submit"||s.type==="image")){let p=s.form;if(p==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let g=s.getAttribute("formaction")||p.getAttribute("action");if(i=g?Ji(g,e):null,t=s.getAttribute("formmethod")||p.getAttribute("method")||od,l=pp(s.getAttribute("formenctype"))||pp(p.getAttribute("enctype"))||ld,u=new FormData(p,s),!xS()){let{name:y,type:b,value:E}=s;if(b==="image"){let T=y?`${y}.`:"";u.append(`${T}x`,"0"),u.append(`${T}y`,"0")}else y&&u.append(y,E)}}else{if(Fd(s))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=od,i=null,l=ld,h=s}return u&&l==="text/plain"&&(h=u,u=void 0),{action:i,method:t.toLowerCase(),encType:l,formData:u,body:h}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function Cg(s,e){if(s===!1||s===null||typeof s>"u")throw new Error(e)}function kS(s,e,t,i){let l=typeof s=="string"?new URL(s,typeof window>"u"?"server://singlefetch/":window.location.origin):s;return t?l.pathname.endsWith("/")?l.pathname=`${l.pathname}_.${i}`:l.pathname=`${l.pathname}.${i}`:l.pathname==="/"?l.pathname=`_root.${i}`:e&&Ji(l.pathname,e)==="/"?l.pathname=`${e.replace(/\/$/,"")}/_root.${i}`:l.pathname=`${l.pathname.replace(/\/$/,"")}.${i}`,l}async function SS(s,e){if(s.id in e)return e[s.id];try{let t=await import(s.module);return e[s.id]=t,t}catch(t){return console.error(`Error loading route module \`${s.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function jS(s){return s==null?!1:s.href==null?s.rel==="preload"&&typeof s.imageSrcSet=="string"&&typeof s.imageSizes=="string":typeof s.rel=="string"&&typeof s.href=="string"}async function CS(s,e,t){let i=await Promise.all(s.map(async l=>{let u=e.routes[l.route.id];if(u){let h=await SS(u,t);return h.links?h.links():[]}return[]}));return IS(i.flat(1).filter(jS).filter(l=>l.rel==="stylesheet"||l.rel==="preload").map(l=>l.rel==="stylesheet"?{...l,rel:"prefetch",as:"style"}:{...l,rel:"prefetch"}))}function Eb(s,e,t,i,l,u){let h=(g,y)=>t[y]?g.route.id!==t[y].route.id:!0,p=(g,y)=>t[y].pathname!==g.pathname||t[y].route.path?.endsWith("*")&&t[y].params["*"]!==g.params["*"];return u==="assets"?e.filter((g,y)=>h(g,y)||p(g,y)):u==="data"?e.filter((g,y)=>{let b=i.routes[g.route.id];if(!b||!b.hasLoader)return!1;if(h(g,y)||p(g,y))return!0;if(g.route.shouldRevalidate){let E=g.route.shouldRevalidate({currentUrl:new URL(l.pathname+l.search+l.hash,window.origin),currentParams:t[0]?.params||{},nextUrl:new URL(s,window.origin),nextParams:g.params,defaultShouldRevalidate:!0});if(typeof E=="boolean")return E}return!0}):[]}function NS(s,e,{includeHydrateFallback:t}={}){return AS(s.map(i=>{let l=e.routes[i.route.id];if(!l)return[];let u=[l.module];return l.clientActionModule&&(u=u.concat(l.clientActionModule)),l.clientLoaderModule&&(u=u.concat(l.clientLoaderModule)),t&&l.hydrateFallbackModule&&(u=u.concat(l.hydrateFallbackModule)),l.imports&&(u=u.concat(l.imports)),u}).flat(1))}function AS(s){return[...new Set(s)]}function RS(s){let e={},t=Object.keys(s).sort();for(let i of t)e[i]=s[i];return e}function IS(s,e){let t=new Set;return new Set(e),s.reduce((i,l)=>{let u=JSON.stringify(RS(l));return t.has(u)||(t.add(u),i.push({key:u,link:l})),i},[])}function M_(){let s=w.useContext(Ul);return Cg(s,"You must render this element inside a <DataRouterContext.Provider> element"),s}function DS(){let s=w.useContext(zd);return Cg(s,"You must render this element inside a <DataRouterStateContext.Provider> element"),s}var Ng=w.createContext(void 0);Ng.displayName="FrameworkContext";function L_(){let s=w.useContext(Ng);return Cg(s,"You must render this element inside a <HydratedRouter> element"),s}function MS(s,e){let t=w.useContext(Ng),[i,l]=w.useState(!1),[u,h]=w.useState(!1),{onFocus:p,onBlur:g,onMouseEnter:y,onMouseLeave:b,onTouchStart:E}=e,T=w.useRef(null);w.useEffect(()=>{if(s==="render"&&h(!0),s==="viewport"){let q=te=>{te.forEach(W=>{h(W.isIntersecting)})},B=new IntersectionObserver(q,{threshold:.5});return T.current&&B.observe(T.current),()=>{B.disconnect()}}},[s]),w.useEffect(()=>{if(i){let q=setTimeout(()=>{h(!0)},100);return()=>{clearTimeout(q)}}},[i]);let O=()=>{l(!0)},H=()=>{l(!1),h(!1)};return t?s!=="intent"?[u,T,{}]:[u,T,{onFocus:Dc(p,O),onBlur:Dc(g,H),onMouseEnter:Dc(y,O),onMouseLeave:Dc(b,H),onTouchStart:Dc(E,O)}]:[!1,T,{}]}function Dc(s,e){return t=>{s&&s(t),t.defaultPrevented||e(t)}}function LS({page:s,...e}){let{router:t}=M_(),i=w.useMemo(()=>__(t.routes,s,t.basename),[t.routes,s,t.basename]);return i?w.createElement(PS,{page:s,matches:i,...e}):null}function OS(s){let{manifest:e,routeModules:t}=L_(),[i,l]=w.useState([]);return w.useEffect(()=>{let u=!1;return CS(s,e,t).then(h=>{u||l(h)}),()=>{u=!0}},[s,e,t]),i}function PS({page:s,matches:e,...t}){let i=Si(),{future:l,manifest:u,routeModules:h}=L_(),{basename:p}=M_(),{loaderData:g,matches:y}=DS(),b=w.useMemo(()=>Eb(s,e,y,u,i,"data"),[s,e,y,u,i]),E=w.useMemo(()=>Eb(s,e,y,u,i,"assets"),[s,e,y,u,i]),T=w.useMemo(()=>{if(s===i.pathname+i.search+i.hash)return[];let q=new Set,B=!1;if(e.forEach(W=>{let ee=u.routes[W.route.id];!ee||!ee.hasLoader||(!b.some(pe=>pe.route.id===W.route.id)&&W.route.id in g&&h[W.route.id]?.shouldRevalidate||ee.hasClientLoader?B=!0:q.add(W.route.id))}),q.size===0)return[];let te=kS(s,p,l.unstable_trailingSlashAwareDataRequests,"data");return B&&q.size>0&&te.searchParams.set("_routes",e.filter(W=>q.has(W.route.id)).map(W=>W.route.id).join(",")),[te.pathname+te.search]},[p,l.unstable_trailingSlashAwareDataRequests,g,i,u,b,e,s,h]),O=w.useMemo(()=>NS(E,u),[E,u]),H=OS(E);return w.createElement(w.Fragment,null,T.map(q=>w.createElement("link",{key:q,rel:"prefetch",as:"fetch",href:q,...t})),O.map(q=>w.createElement("link",{key:q,rel:"modulepreload",href:q,...t})),H.map(({key:q,link:B})=>w.createElement("link",{key:q,nonce:t.nonce,...B,crossOrigin:B.crossOrigin??t.crossOrigin})))}function VS(...s){return e=>{s.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var US=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{US&&(window.__reactRouterVersion="7.13.0")}catch{}function BS({basename:s,children:e,unstable_useTransitions:t,window:i}){let l=w.useRef();l.current==null&&(l.current=vk({window:i,v5Compat:!0}));let u=l.current,[h,p]=w.useState({action:u.action,location:u.location}),g=w.useCallback(y=>{t===!1?p(y):w.startTransition(()=>p(y))},[t]);return w.useLayoutEffect(()=>u.listen(g),[u,g]),w.createElement(mS,{basename:s,children:e,location:h.location,navigationType:h.action,navigator:u,unstable_useTransitions:t})}var O_=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,P_=w.forwardRef(function({onClick:e,discover:t="render",prefetch:i="none",relative:l,reloadDocument:u,replace:h,state:p,target:g,to:y,preventScrollReset:b,viewTransition:E,unstable_defaultShouldRevalidate:T,...O},H){let{basename:q,unstable_useTransitions:B}=w.useContext(kr),te=typeof y=="string"&&O_.test(y),W=T_(y,q);y=W.to;let ee=Jk(y,{relative:l}),[pe,Te,ve]=MS(i,O),A=HS(y,{replace:h,state:p,target:g,preventScrollReset:b,relative:l,viewTransition:E,unstable_defaultShouldRevalidate:T,unstable_useTransitions:B});function S(V){e&&e(V),V.defaultPrevented||A(V)}let I=w.createElement("a",{...O,...ve,href:W.absoluteURL||ee,onClick:W.isExternal||u?e:S,ref:VS(H,Te),target:g,"data-discover":!te&&t==="render"?"true":void 0});return pe&&!te?w.createElement(w.Fragment,null,I,w.createElement(LS,{page:ee})):I});P_.displayName="Link";var zS=w.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:i="",end:l=!1,style:u,to:h,viewTransition:p,children:g,...y},b){let E=mu(h,{relative:y.relative}),T=Si(),O=w.useContext(zd),{navigator:H,basename:q}=w.useContext(kr),B=O!=null&&YS(E)&&p===!0,te=H.encodeLocation?H.encodeLocation(E).pathname:E.pathname,W=T.pathname,ee=O&&O.navigation&&O.navigation.location?O.navigation.location.pathname:null;t||(W=W.toLowerCase(),ee=ee?ee.toLowerCase():null,te=te.toLowerCase()),ee&&q&&(ee=Ji(ee,q)||ee);const pe=te!=="/"&&te.endsWith("/")?te.length-1:te.length;let Te=W===te||!l&&W.startsWith(te)&&W.charAt(pe)==="/",ve=ee!=null&&(ee===te||!l&&ee.startsWith(te)&&ee.charAt(te.length)==="/"),A={isActive:Te,isPending:ve,isTransitioning:B},S=Te?e:void 0,I;typeof i=="function"?I=i(A):I=[i,Te?"active":null,ve?"pending":null,B?"transitioning":null].filter(Boolean).join(" ");let V=typeof u=="function"?u(A):u;return w.createElement(P_,{...y,"aria-current":S,className:I,ref:b,style:V,to:h,viewTransition:p},typeof g=="function"?g(A):g)});zS.displayName="NavLink";var FS=w.forwardRef(({discover:s="render",fetcherKey:e,navigate:t,reloadDocument:i,replace:l,state:u,method:h=od,action:p,onSubmit:g,relative:y,preventScrollReset:b,viewTransition:E,unstable_defaultShouldRevalidate:T,...O},H)=>{let{unstable_useTransitions:q}=w.useContext(kr),B=GS(),te=KS(p,{relative:y}),W=h.toLowerCase()==="get"?"get":"post",ee=typeof p=="string"&&O_.test(p),pe=Te=>{if(g&&g(Te),Te.defaultPrevented)return;Te.preventDefault();let ve=Te.nativeEvent.submitter,A=ve?.getAttribute("formmethod")||h,S=()=>B(ve||Te.currentTarget,{fetcherKey:e,method:A,navigate:t,replace:l,state:u,relative:y,preventScrollReset:b,viewTransition:E,unstable_defaultShouldRevalidate:T});q&&t!==!1?w.startTransition(()=>S()):S()};return w.createElement("form",{ref:H,method:W,action:te,onSubmit:i?g:pe,...O,"data-discover":!ee&&s==="render"?"true":void 0})});FS.displayName="Form";function qS(s){return`${s} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function V_(s){let e=w.useContext(Ul);return Gn(e,qS(s)),e}function HS(s,{target:e,replace:t,state:i,preventScrollReset:l,relative:u,viewTransition:h,unstable_defaultShouldRevalidate:p,unstable_useTransitions:g}={}){let y=Sr(),b=Si(),E=mu(s,{relative:u});return w.useCallback(T=>{if(_S(T,e)){T.preventDefault();let O=t!==void 0?t:Jc(b)===Jc(E),H=()=>y(s,{replace:O,state:i,preventScrollReset:l,relative:u,viewTransition:h,unstable_defaultShouldRevalidate:p});g?w.startTransition(()=>H()):H()}},[b,y,E,t,i,e,s,l,u,h,p,g])}function l3(s){Wr(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let e=w.useRef($p(s)),t=w.useRef(!1),i=Si(),l=w.useMemo(()=>wS(i.search,t.current?null:e.current),[i.search]),u=Sr(),h=w.useCallback((p,g)=>{const y=$p(typeof p=="function"?p(new URLSearchParams(l)):p);t.current=!0,u("?"+y,g)},[u,l]);return[l,h]}var $S=0,WS=()=>`__${String(++$S)}__`;function GS(){let{router:s}=V_("useSubmit"),{basename:e}=w.useContext(kr),t=uS(),i=s.fetch,l=s.navigate;return w.useCallback(async(u,h={})=>{let{action:p,method:g,encType:y,formData:b,body:E}=TS(u,e);if(h.navigate===!1){let T=h.fetcherKey||WS();await i(T,t,h.action||p,{unstable_defaultShouldRevalidate:h.unstable_defaultShouldRevalidate,preventScrollReset:h.preventScrollReset,formData:b,body:E,formMethod:h.method||g,formEncType:h.encType||y,flushSync:h.flushSync})}else await l(h.action||p,{unstable_defaultShouldRevalidate:h.unstable_defaultShouldRevalidate,preventScrollReset:h.preventScrollReset,formData:b,body:E,formMethod:h.method||g,formEncType:h.encType||y,replace:h.replace,state:h.state,fromRouteId:t,flushSync:h.flushSync,viewTransition:h.viewTransition})},[i,l,e,t])}function KS(s,{relative:e}={}){let{basename:t}=w.useContext(kr),i=w.useContext(ii);Gn(i,"useFormAction must be used inside a RouteContext");let[l]=i.matches.slice(-1),u={...mu(s||".",{relative:e})},h=Si();if(s==null){u.search=h.search;let p=new URLSearchParams(u.search),g=p.getAll("index");if(g.some(b=>b==="")){p.delete("index"),g.filter(E=>E).forEach(E=>p.append("index",E));let b=p.toString();u.search=b?`?${b}`:""}}return(!s||s===".")&&l.route.index&&(u.search=u.search?u.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(u.pathname=u.pathname==="/"?t:Yi([t,u.pathname])),Jc(u)}function YS(s,{relative:e}={}){let t=w.useContext(S_);Gn(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:i}=V_("useViewTransitionState"),l=mu(s,{relative:e});if(!t.isTransitioning)return!1;let u=Ji(t.currentLocation.pathname,i)||t.currentLocation.pathname,h=Ji(t.nextLocation.pathname,i)||t.nextLocation.pathname;return _d(l.pathname,h)!=null||_d(l.pathname,u)!=null}const QS=()=>{};var Tb={};const U_=function(s){const e=[];let t=0;for(let i=0;i<s.length;i++){let l=s.charCodeAt(i);l<128?e[t++]=l:l<2048?(e[t++]=l>>6|192,e[t++]=l&63|128):(l&64512)===55296&&i+1<s.length&&(s.charCodeAt(i+1)&64512)===56320?(l=65536+((l&1023)<<10)+(s.charCodeAt(++i)&1023),e[t++]=l>>18|240,e[t++]=l>>12&63|128,e[t++]=l>>6&63|128,e[t++]=l&63|128):(e[t++]=l>>12|224,e[t++]=l>>6&63|128,e[t++]=l&63|128)}return e},XS=function(s){const e=[];let t=0,i=0;for(;t<s.length;){const l=s[t++];if(l<128)e[i++]=String.fromCharCode(l);else if(l>191&&l<224){const u=s[t++];e[i++]=String.fromCharCode((l&31)<<6|u&63)}else if(l>239&&l<365){const u=s[t++],h=s[t++],p=s[t++],g=((l&7)<<18|(u&63)<<12|(h&63)<<6|p&63)-65536;e[i++]=String.fromCharCode(55296+(g>>10)),e[i++]=String.fromCharCode(56320+(g&1023))}else{const u=s[t++],h=s[t++];e[i++]=String.fromCharCode((l&15)<<12|(u&63)<<6|h&63)}}return e.join("")},B_={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(s,e){if(!Array.isArray(s))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let l=0;l<s.length;l+=3){const u=s[l],h=l+1<s.length,p=h?s[l+1]:0,g=l+2<s.length,y=g?s[l+2]:0,b=u>>2,E=(u&3)<<4|p>>4;let T=(p&15)<<2|y>>6,O=y&63;g||(O=64,h||(T=64)),i.push(t[b],t[E],t[T],t[O])}return i.join("")},encodeString(s,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(s):this.encodeByteArray(U_(s),e)},decodeString(s,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(s):XS(this.decodeStringToByteArray(s,e))},decodeStringToByteArray(s,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let l=0;l<s.length;){const u=t[s.charAt(l++)],p=l<s.length?t[s.charAt(l)]:0;++l;const y=l<s.length?t[s.charAt(l)]:64;++l;const E=l<s.length?t[s.charAt(l)]:64;if(++l,u==null||p==null||y==null||E==null)throw new JS;const T=u<<2|p>>4;if(i.push(T),y!==64){const O=p<<4&240|y>>2;if(i.push(O),E!==64){const H=y<<6&192|E;i.push(H)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let s=0;s<this.ENCODED_VALS.length;s++)this.byteToCharMap_[s]=this.ENCODED_VALS.charAt(s),this.charToByteMap_[this.byteToCharMap_[s]]=s,this.byteToCharMapWebSafe_[s]=this.ENCODED_VALS_WEBSAFE.charAt(s),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[s]]=s,s>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(s)]=s,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(s)]=s)}}};class JS extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const ZS=function(s){const e=U_(s);return B_.encodeByteArray(e,!0)},wd=function(s){return ZS(s).replace(/\./g,"")},z_=function(s){try{return B_.decodeString(s,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function ej(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const tj=()=>ej().__FIREBASE_DEFAULTS__,nj=()=>{if(typeof process>"u"||typeof Tb>"u")return;const s=Tb.__FIREBASE_DEFAULTS__;if(s)return JSON.parse(s)},sj=()=>{if(typeof document>"u")return;let s;try{s=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=s&&z_(s[1]);return e&&JSON.parse(e)},qd=()=>{try{return QS()||tj()||nj()||sj()}catch(s){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${s}`);return}},F_=s=>qd()?.emulatorHosts?.[s],q_=s=>{const e=F_(s);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),i]:[e.substring(0,t),i]},H_=()=>qd()?.config,$_=s=>qd()?.[`_${s}`];class rj{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}}function Ja(s){try{return(s.startsWith("http://")||s.startsWith("https://")?new URL(s).hostname:s).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Ag(s){return(await fetch(s,{credentials:"include"})).ok}function W_(s,e){if(s.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},i=e||"demo-project",l=s.iat||0,u=s.sub||s.user_id;if(!u)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const h={iss:`https://securetoken.google.com/${i}`,aud:i,iat:l,exp:l+3600,auth_time:l,sub:u,user_id:u,firebase:{sign_in_provider:"custom",identities:{}},...s};return[wd(JSON.stringify(t)),wd(JSON.stringify(h)),""].join(".")}const $c={};function ij(){const s={prod:[],emulator:[]};for(const e of Object.keys($c))$c[e]?s.emulator.push(e):s.prod.push(e);return s}function aj(s){let e=document.getElementById(s),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",s),t=!0),{created:t,element:e}}let kb=!1;function Rg(s,e){if(typeof window>"u"||typeof document>"u"||!Ja(window.location.host)||$c[s]===e||$c[s]||kb)return;$c[s]=e;function t(T){return`__firebase__banner__${T}`}const i="__firebase__banner",u=ij().prod.length>0;function h(){const T=document.getElementById(i);T&&T.remove()}function p(T){T.style.display="flex",T.style.background="#7faaf0",T.style.position="fixed",T.style.bottom="5px",T.style.left="5px",T.style.padding=".5em",T.style.borderRadius="5px",T.style.alignItems="center"}function g(T,O){T.setAttribute("width","24"),T.setAttribute("id",O),T.setAttribute("height","24"),T.setAttribute("viewBox","0 0 24 24"),T.setAttribute("fill","none"),T.style.marginLeft="-6px"}function y(){const T=document.createElement("span");return T.style.cursor="pointer",T.style.marginLeft="16px",T.style.fontSize="24px",T.innerHTML=" &times;",T.onclick=()=>{kb=!0,h()},T}function b(T,O){T.setAttribute("id",O),T.innerText="Learn more",T.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",T.setAttribute("target","__blank"),T.style.paddingLeft="5px",T.style.textDecoration="underline"}function E(){const T=aj(i),O=t("text"),H=document.getElementById(O)||document.createElement("span"),q=t("learnmore"),B=document.getElementById(q)||document.createElement("a"),te=t("preprendIcon"),W=document.getElementById(te)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(T.created){const ee=T.element;p(ee),b(B,q);const pe=y();g(W,te),ee.append(W,H,B,pe),document.body.appendChild(ee)}u?(H.innerText="Preview backend disconnected.",W.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(W.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,H.innerText="Preview backend running in this workspace."),H.setAttribute("id",O)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",E):E()}function Ws(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function oj(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Ws())}function lj(){const s=qd()?.forceEnvironment;if(s==="node")return!0;if(s==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function cj(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function uj(){const s=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof s=="object"&&s.id!==void 0}function hj(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function dj(){const s=Ws();return s.indexOf("MSIE ")>=0||s.indexOf("Trident/")>=0}function fj(){return!lj()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function mj(){try{return typeof indexedDB=="object"}catch{return!1}}function pj(){return new Promise((s,e)=>{try{let t=!0;const i="validate-browser-context-for-indexeddb-analytics-module",l=self.indexedDB.open(i);l.onsuccess=()=>{l.result.close(),t||self.indexedDB.deleteDatabase(i),s(!0)},l.onupgradeneeded=()=>{t=!1},l.onerror=()=>{e(l.error?.message||"")}}catch(t){e(t)}})}const gj="FirebaseError";class ji extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=gj,Object.setPrototypeOf(this,ji.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,pu.prototype.create)}}class pu{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){const i=t[0]||{},l=`${this.service}/${e}`,u=this.errors[e],h=u?yj(u,i):"Error",p=`${this.serviceName}: ${h} (${l}).`;return new ji(l,p,i)}}function yj(s,e){return s.replace(vj,(t,i)=>{const l=e[i];return l!=null?String(l):`<${i}?>`})}const vj=/\{\$([^}]+)}/g;function bj(s){for(const e in s)if(Object.prototype.hasOwnProperty.call(s,e))return!1;return!0}function Ao(s,e){if(s===e)return!0;const t=Object.keys(s),i=Object.keys(e);for(const l of t){if(!i.includes(l))return!1;const u=s[l],h=e[l];if(Sb(u)&&Sb(h)){if(!Ao(u,h))return!1}else if(u!==h)return!1}for(const l of i)if(!t.includes(l))return!1;return!0}function Sb(s){return s!==null&&typeof s=="object"}function gu(s){const e=[];for(const[t,i]of Object.entries(s))Array.isArray(i)?i.forEach(l=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(l))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function Uc(s){const e={};return s.replace(/^\?/,"").split("&").forEach(i=>{if(i){const[l,u]=i.split("=");e[decodeURIComponent(l)]=decodeURIComponent(u)}}),e}function Bc(s){const e=s.indexOf("?");if(!e)return"";const t=s.indexOf("#",e);return s.substring(e,t>0?t:void 0)}function _j(s,e){const t=new wj(s,e);return t.subscribe.bind(t)}class wj{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,i){let l;if(e===void 0&&t===void 0&&i===void 0)throw new Error("Missing Observer.");xj(e,["next","error","complete"])?l=e:l={next:e,error:t,complete:i},l.next===void 0&&(l.next=gp),l.error===void 0&&(l.error=gp),l.complete===void 0&&(l.complete=gp);const u=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?l.error(this.finalError):l.complete()}catch{}}),this.observers.push(l),u}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function xj(s,e){if(typeof s!="object"||s===null)return!1;for(const t of e)if(t in s&&typeof s[t]=="function")return!0;return!1}function gp(){}function Tn(s){return s&&s._delegate?s._delegate:s}class $a{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const Eo="[DEFAULT]";class Ej{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const i=new rj;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{const l=this.getOrInitializeService({instanceIdentifier:t});l&&i.resolve(l)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),i=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(l){if(i)return null;throw l}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(kj(e))try{this.getOrInitializeService({instanceIdentifier:Eo})}catch{}for(const[t,i]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(t);try{const u=this.getOrInitializeService({instanceIdentifier:l});i.resolve(u)}catch{}}}}clearInstance(e=Eo){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Eo){return this.instances.has(e)}getOptions(e=Eo){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const l=this.getOrInitializeService({instanceIdentifier:i,options:t});for(const[u,h]of this.instancesDeferred.entries()){const p=this.normalizeInstanceIdentifier(u);i===p&&h.resolve(l)}return l}onInit(e,t){const i=this.normalizeInstanceIdentifier(t),l=this.onInitCallbacks.get(i)??new Set;l.add(e),this.onInitCallbacks.set(i,l);const u=this.instances.get(i);return u&&e(u,i),()=>{l.delete(e)}}invokeOnInitCallbacks(e,t){const i=this.onInitCallbacks.get(t);if(i)for(const l of i)try{l(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:Tj(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=Eo){return this.component?this.component.multipleInstances?e:Eo:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function Tj(s){return s===Eo?void 0:s}function kj(s){return s.instantiationMode==="EAGER"}class Sj{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new Ej(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}var $t;(function(s){s[s.DEBUG=0]="DEBUG",s[s.VERBOSE=1]="VERBOSE",s[s.INFO=2]="INFO",s[s.WARN=3]="WARN",s[s.ERROR=4]="ERROR",s[s.SILENT=5]="SILENT"})($t||($t={}));const jj={debug:$t.DEBUG,verbose:$t.VERBOSE,info:$t.INFO,warn:$t.WARN,error:$t.ERROR,silent:$t.SILENT},Cj=$t.INFO,Nj={[$t.DEBUG]:"log",[$t.VERBOSE]:"log",[$t.INFO]:"info",[$t.WARN]:"warn",[$t.ERROR]:"error"},Aj=(s,e,...t)=>{if(e<s.logLevel)return;const i=new Date().toISOString(),l=Nj[e];if(l)console[l](`[${i}]  ${s.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Ig{constructor(e){this.name=e,this._logLevel=Cj,this._logHandler=Aj,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in $t))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?jj[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,$t.DEBUG,...e),this._logHandler(this,$t.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,$t.VERBOSE,...e),this._logHandler(this,$t.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,$t.INFO,...e),this._logHandler(this,$t.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,$t.WARN,...e),this._logHandler(this,$t.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,$t.ERROR,...e),this._logHandler(this,$t.ERROR,...e)}}const Rj=(s,e)=>e.some(t=>s instanceof t);let jb,Cb;function Ij(){return jb||(jb=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Dj(){return Cb||(Cb=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const G_=new WeakMap,Wp=new WeakMap,K_=new WeakMap,yp=new WeakMap,Dg=new WeakMap;function Mj(s){const e=new Promise((t,i)=>{const l=()=>{s.removeEventListener("success",u),s.removeEventListener("error",h)},u=()=>{t(za(s.result)),l()},h=()=>{i(s.error),l()};s.addEventListener("success",u),s.addEventListener("error",h)});return e.then(t=>{t instanceof IDBCursor&&G_.set(t,s)}).catch(()=>{}),Dg.set(e,s),e}function Lj(s){if(Wp.has(s))return;const e=new Promise((t,i)=>{const l=()=>{s.removeEventListener("complete",u),s.removeEventListener("error",h),s.removeEventListener("abort",h)},u=()=>{t(),l()},h=()=>{i(s.error||new DOMException("AbortError","AbortError")),l()};s.addEventListener("complete",u),s.addEventListener("error",h),s.addEventListener("abort",h)});Wp.set(s,e)}let Gp={get(s,e,t){if(s instanceof IDBTransaction){if(e==="done")return Wp.get(s);if(e==="objectStoreNames")return s.objectStoreNames||K_.get(s);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return za(s[e])},set(s,e,t){return s[e]=t,!0},has(s,e){return s instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in s}};function Oj(s){Gp=s(Gp)}function Pj(s){return s===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const i=s.call(vp(this),e,...t);return K_.set(i,e.sort?e.sort():[e]),za(i)}:Dj().includes(s)?function(...e){return s.apply(vp(this),e),za(G_.get(this))}:function(...e){return za(s.apply(vp(this),e))}}function Vj(s){return typeof s=="function"?Pj(s):(s instanceof IDBTransaction&&Lj(s),Rj(s,Ij())?new Proxy(s,Gp):s)}function za(s){if(s instanceof IDBRequest)return Mj(s);if(yp.has(s))return yp.get(s);const e=Vj(s);return e!==s&&(yp.set(s,e),Dg.set(e,s)),e}const vp=s=>Dg.get(s);function Uj(s,e,{blocked:t,upgrade:i,blocking:l,terminated:u}={}){const h=indexedDB.open(s,e),p=za(h);return i&&h.addEventListener("upgradeneeded",g=>{i(za(h.result),g.oldVersion,g.newVersion,za(h.transaction),g)}),t&&h.addEventListener("blocked",g=>t(g.oldVersion,g.newVersion,g)),p.then(g=>{u&&g.addEventListener("close",()=>u()),l&&g.addEventListener("versionchange",y=>l(y.oldVersion,y.newVersion,y))}).catch(()=>{}),p}const Bj=["get","getKey","getAll","getAllKeys","count"],zj=["put","add","delete","clear"],bp=new Map;function Nb(s,e){if(!(s instanceof IDBDatabase&&!(e in s)&&typeof e=="string"))return;if(bp.get(e))return bp.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,l=zj.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(l||Bj.includes(t)))return;const u=async function(h,...p){const g=this.transaction(h,l?"readwrite":"readonly");let y=g.store;return i&&(y=y.index(p.shift())),(await Promise.all([y[t](...p),l&&g.done]))[0]};return bp.set(e,u),u}Oj(s=>({...s,get:(e,t,i)=>Nb(e,t)||s.get(e,t,i),has:(e,t)=>!!Nb(e,t)||s.has(e,t)}));class Fj{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(qj(t)){const i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}}function qj(s){return s.getComponent()?.type==="VERSION"}const Kp="@firebase/app",Ab="0.14.7";const Zi=new Ig("@firebase/app"),Hj="@firebase/app-compat",$j="@firebase/analytics-compat",Wj="@firebase/analytics",Gj="@firebase/app-check-compat",Kj="@firebase/app-check",Yj="@firebase/auth",Qj="@firebase/auth-compat",Xj="@firebase/database",Jj="@firebase/data-connect",Zj="@firebase/database-compat",eC="@firebase/functions",tC="@firebase/functions-compat",nC="@firebase/installations",sC="@firebase/installations-compat",rC="@firebase/messaging",iC="@firebase/messaging-compat",aC="@firebase/performance",oC="@firebase/performance-compat",lC="@firebase/remote-config",cC="@firebase/remote-config-compat",uC="@firebase/storage",hC="@firebase/storage-compat",dC="@firebase/firestore",fC="@firebase/ai",mC="@firebase/firestore-compat",pC="firebase",gC="12.8.0";const Yp="[DEFAULT]",yC={[Kp]:"fire-core",[Hj]:"fire-core-compat",[Wj]:"fire-analytics",[$j]:"fire-analytics-compat",[Kj]:"fire-app-check",[Gj]:"fire-app-check-compat",[Yj]:"fire-auth",[Qj]:"fire-auth-compat",[Xj]:"fire-rtdb",[Jj]:"fire-data-connect",[Zj]:"fire-rtdb-compat",[eC]:"fire-fn",[tC]:"fire-fn-compat",[nC]:"fire-iid",[sC]:"fire-iid-compat",[rC]:"fire-fcm",[iC]:"fire-fcm-compat",[aC]:"fire-perf",[oC]:"fire-perf-compat",[lC]:"fire-rc",[cC]:"fire-rc-compat",[uC]:"fire-gcs",[hC]:"fire-gcs-compat",[dC]:"fire-fst",[mC]:"fire-fst-compat",[fC]:"fire-vertex","fire-js":"fire-js",[pC]:"fire-js-all"};const xd=new Map,vC=new Map,Qp=new Map;function Rb(s,e){try{s.container.addComponent(e)}catch(t){Zi.debug(`Component ${e.name} failed to register with FirebaseApp ${s.name}`,t)}}function Ro(s){const e=s.name;if(Qp.has(e))return Zi.debug(`There were multiple attempts to register component ${e}.`),!1;Qp.set(e,s);for(const t of xd.values())Rb(t,s);for(const t of vC.values())Rb(t,s);return!0}function Hd(s,e){const t=s.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),s.container.getProvider(e)}function xr(s){return s==null?!1:s.settings!==void 0}const bC={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Fa=new pu("app","Firebase",bC);class _C{constructor(e,t,i){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new $a("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Fa.create("app-deleted",{appName:this._name})}}const Vo=gC;function Mg(s,e={}){let t=s;typeof e!="object"&&(e={name:e});const i={name:Yp,automaticDataCollectionEnabled:!0,...e},l=i.name;if(typeof l!="string"||!l)throw Fa.create("bad-app-name",{appName:String(l)});if(t||(t=H_()),!t)throw Fa.create("no-options");const u=xd.get(l);if(u){if(Ao(t,u.options)&&Ao(i,u.config))return u;throw Fa.create("duplicate-app",{appName:l})}const h=new Sj(l);for(const g of Qp.values())h.addComponent(g);const p=new _C(t,i,h);return xd.set(l,p),p}function Lg(s=Yp){const e=xd.get(s);if(!e&&s===Yp&&H_())return Mg();if(!e)throw Fa.create("no-app",{appName:s});return e}function vi(s,e,t){let i=yC[s]??s;t&&(i+=`-${t}`);const l=i.match(/\s|\//),u=e.match(/\s|\//);if(l||u){const h=[`Unable to register library "${i}" with version "${e}":`];l&&h.push(`library name "${i}" contains illegal characters (whitespace or "/")`),l&&u&&h.push("and"),u&&h.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Zi.warn(h.join(" "));return}Ro(new $a(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}const wC="firebase-heartbeat-database",xC=1,Zc="firebase-heartbeat-store";let _p=null;function Y_(){return _p||(_p=Uj(wC,xC,{upgrade:(s,e)=>{switch(e){case 0:try{s.createObjectStore(Zc)}catch(t){console.warn(t)}}}}).catch(s=>{throw Fa.create("idb-open",{originalErrorMessage:s.message})})),_p}async function EC(s){try{const t=(await Y_()).transaction(Zc),i=await t.objectStore(Zc).get(Q_(s));return await t.done,i}catch(e){if(e instanceof ji)Zi.warn(e.message);else{const t=Fa.create("idb-get",{originalErrorMessage:e?.message});Zi.warn(t.message)}}}async function Ib(s,e){try{const i=(await Y_()).transaction(Zc,"readwrite");await i.objectStore(Zc).put(e,Q_(s)),await i.done}catch(t){if(t instanceof ji)Zi.warn(t.message);else{const i=Fa.create("idb-set",{originalErrorMessage:t?.message});Zi.warn(i.message)}}}function Q_(s){return`${s.name}!${s.options.appId}`}const TC=1024,kC=30;class SC{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new CC(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=Db();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(l=>l.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:t}),this._heartbeatsCache.heartbeats.length>kC){const l=NC(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(l,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){Zi.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=Db(),{heartbeatsToSend:t,unsentEntries:i}=jC(this._heartbeatsCache.heartbeats),l=wd(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),l}catch(e){return Zi.warn(e),""}}}function Db(){return new Date().toISOString().substring(0,10)}function jC(s,e=TC){const t=[];let i=s.slice();for(const l of s){const u=t.find(h=>h.agent===l.agent);if(u){if(u.dates.push(l.date),Mb(t)>e){u.dates.pop();break}}else if(t.push({agent:l.agent,dates:[l.date]}),Mb(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}class CC{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return mj()?pj().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await EC(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return Ib(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return Ib(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function Mb(s){return wd(JSON.stringify({version:2,heartbeats:s})).length}function NC(s){if(s.length===0)return-1;let e=0,t=s[0].date;for(let i=1;i<s.length;i++)s[i].date<t&&(t=s[i].date,e=i);return e}function AC(s){Ro(new $a("platform-logger",e=>new Fj(e),"PRIVATE")),Ro(new $a("heartbeat",e=>new SC(e),"PRIVATE")),vi(Kp,Ab,s),vi(Kp,Ab,"esm2020"),vi("fire-js","")}AC("");function X_(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const RC=X_,J_=new pu("auth","Firebase",X_());const Ed=new Ig("@firebase/auth");function IC(s,...e){Ed.logLevel<=$t.WARN&&Ed.warn(`Auth (${Vo}): ${s}`,...e)}function cd(s,...e){Ed.logLevel<=$t.ERROR&&Ed.error(`Auth (${Vo}): ${s}`,...e)}function si(s,...e){throw Og(s,...e)}function bi(s,...e){return Og(s,...e)}function Z_(s,e,t){const i={...RC(),[e]:t};return new pu("auth","Firebase",i).create(e,{appName:s.name})}function Qi(s){return Z_(s,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Og(s,...e){if(typeof s!="string"){const t=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=s.name),s._errorFactory.create(t,...i)}return J_.create(s,...e)}function _t(s,e,...t){if(!s)throw Og(e,...t)}function Gi(s){const e="INTERNAL ASSERTION FAILED: "+s;throw cd(e),new Error(e)}function ea(s,e){s||Gi(e)}function Xp(){return typeof self<"u"&&self.location?.href||""}function DC(){return Lb()==="http:"||Lb()==="https:"}function Lb(){return typeof self<"u"&&self.location?.protocol||null}function MC(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(DC()||uj()||"connection"in navigator)?navigator.onLine:!0}function LC(){if(typeof navigator>"u")return null;const s=navigator;return s.languages&&s.languages[0]||s.language||null}class yu{constructor(e,t){this.shortDelay=e,this.longDelay=t,ea(t>e,"Short delay should be less than long delay!"),this.isMobile=oj()||hj()}get(){return MC()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function Pg(s,e){ea(s.emulator,"Emulator should always be set here");const{url:t}=s.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class ew{static initialize(e,t,i){this.fetchImpl=e,t&&(this.headersImpl=t),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Gi("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Gi("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Gi("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const OC={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const PC=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],VC=new yu(3e4,6e4);function ra(s,e){return s.tenantId&&!e.tenantId?{...e,tenantId:s.tenantId}:e}async function ia(s,e,t,i,l={}){return tw(s,l,async()=>{let u={},h={};i&&(e==="GET"?h=i:u={body:JSON.stringify(i)});const p=gu({key:s.config.apiKey,...h}).slice(1),g=await s._getAdditionalHeaders();g["Content-Type"]="application/json",s.languageCode&&(g["X-Firebase-Locale"]=s.languageCode);const y={method:e,headers:g,...u};return cj()||(y.referrerPolicy="no-referrer"),s.emulatorConfig&&Ja(s.emulatorConfig.host)&&(y.credentials="include"),ew.fetch()(await nw(s,s.config.apiHost,t,p),y)})}async function tw(s,e,t){s._canInitEmulator=!1;const i={...OC,...e};try{const l=new BC(s),u=await Promise.race([t(),l.promise]);l.clearNetworkTimeout();const h=await u.json();if("needConfirmation"in h)throw Kh(s,"account-exists-with-different-credential",h);if(u.ok&&!("errorMessage"in h))return h;{const p=u.ok?h.errorMessage:h.error.message,[g,y]=p.split(" : ");if(g==="FEDERATED_USER_ID_ALREADY_LINKED")throw Kh(s,"credential-already-in-use",h);if(g==="EMAIL_EXISTS")throw Kh(s,"email-already-in-use",h);if(g==="USER_DISABLED")throw Kh(s,"user-disabled",h);const b=i[g]||g.toLowerCase().replace(/[_\s]+/g,"-");if(y)throw Z_(s,b,y);si(s,b)}}catch(l){if(l instanceof ji)throw l;si(s,"network-request-failed",{message:String(l)})}}async function vu(s,e,t,i,l={}){const u=await ia(s,e,t,i,l);return"mfaPendingCredential"in u&&si(s,"multi-factor-auth-required",{_serverResponse:u}),u}async function nw(s,e,t,i){const l=`${e}${t}?${i}`,u=s,h=u.config.emulator?Pg(s.config,l):`${s.config.apiScheme}://${l}`;return PC.includes(t)&&(await u._persistenceManagerAvailable,u._getPersistenceType()==="COOKIE")?u._getPersistence()._getFinalTarget(h).toString():h}function UC(s){switch(s){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class BC{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,i)=>{this.timer=setTimeout(()=>i(bi(this.auth,"network-request-failed")),VC.get())})}}function Kh(s,e,t){const i={appName:s.name};t.email&&(i.email=t.email),t.phoneNumber&&(i.phoneNumber=t.phoneNumber);const l=bi(s,e,i);return l.customData._tokenResponse=t,l}function Ob(s){return s!==void 0&&s.enterprise!==void 0}class zC{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return UC(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function FC(s,e){return ia(s,"GET","/v2/recaptchaConfig",ra(s,e))}async function qC(s,e){return ia(s,"POST","/v1/accounts:delete",e)}async function Td(s,e){return ia(s,"POST","/v1/accounts:lookup",e)}function Wc(s){if(s)try{const e=new Date(Number(s));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function HC(s,e=!1){const t=Tn(s),i=await t.getIdToken(e),l=Vg(i);_t(l&&l.exp&&l.auth_time&&l.iat,t.auth,"internal-error");const u=typeof l.firebase=="object"?l.firebase:void 0,h=u?.sign_in_provider;return{claims:l,token:i,authTime:Wc(wp(l.auth_time)),issuedAtTime:Wc(wp(l.iat)),expirationTime:Wc(wp(l.exp)),signInProvider:h||null,signInSecondFactor:u?.sign_in_second_factor||null}}function wp(s){return Number(s)*1e3}function Vg(s){const[e,t,i]=s.split(".");if(e===void 0||t===void 0||i===void 0)return cd("JWT malformed, contained fewer than 3 sections"),null;try{const l=z_(t);return l?JSON.parse(l):(cd("Failed to decode base64 JWT payload"),null)}catch(l){return cd("Caught error parsing JWT payload as JSON",l?.toString()),null}}function Pb(s){const e=Vg(s);return _t(e,"internal-error"),_t(typeof e.exp<"u","internal-error"),_t(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function eu(s,e,t=!1){if(t)return e;try{return await e}catch(i){throw i instanceof ji&&$C(i)&&s.auth.currentUser===s&&await s.auth.signOut(),i}}function $C({code:s}){return s==="auth/user-disabled"||s==="auth/user-token-expired"}class WC{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const i=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class Jp{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Wc(this.lastLoginAt),this.creationTime=Wc(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function kd(s){const e=s.auth,t=await s.getIdToken(),i=await eu(s,Td(e,{idToken:t}));_t(i?.users.length,e,"internal-error");const l=i.users[0];s._notifyReloadListener(l);const u=l.providerUserInfo?.length?sw(l.providerUserInfo):[],h=KC(s.providerData,u),p=s.isAnonymous,g=!(s.email&&l.passwordHash)&&!h?.length,y=p?g:!1,b={uid:l.localId,displayName:l.displayName||null,photoURL:l.photoUrl||null,email:l.email||null,emailVerified:l.emailVerified||!1,phoneNumber:l.phoneNumber||null,tenantId:l.tenantId||null,providerData:h,metadata:new Jp(l.createdAt,l.lastLoginAt),isAnonymous:y};Object.assign(s,b)}async function GC(s){const e=Tn(s);await kd(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function KC(s,e){return[...s.filter(i=>!e.some(l=>l.providerId===i.providerId)),...e]}function sw(s){return s.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}async function YC(s,e){const t=await tw(s,{},async()=>{const i=gu({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:l,apiKey:u}=s.config,h=await nw(s,l,"/v1/token",`key=${u}`),p=await s._getAdditionalHeaders();p["Content-Type"]="application/x-www-form-urlencoded";const g={method:"POST",headers:p,body:i};return s.emulatorConfig&&Ja(s.emulatorConfig.host)&&(g.credentials="include"),ew.fetch()(h,g)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function QC(s,e){return ia(s,"POST","/v2/accounts:revokeToken",ra(s,e))}class jl{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){_t(e.idToken,"internal-error"),_t(typeof e.idToken<"u","internal-error"),_t(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Pb(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){_t(e.length!==0,"internal-error");const t=Pb(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(_t(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:i,refreshToken:l,expiresIn:u}=await YC(e,t);this.updateTokensAndExpiration(i,l,Number(u))}updateTokensAndExpiration(e,t,i){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,t){const{refreshToken:i,accessToken:l,expirationTime:u}=t,h=new jl;return i&&(_t(typeof i=="string","internal-error",{appName:e}),h.refreshToken=i),l&&(_t(typeof l=="string","internal-error",{appName:e}),h.accessToken=l),u&&(_t(typeof u=="number","internal-error",{appName:e}),h.expirationTime=u),h}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new jl,this.toJSON())}_performRefresh(){return Gi("not implemented")}}function Ia(s,e){_t(typeof s=="string"||typeof s>"u","internal-error",{appName:e})}class ei{constructor({uid:e,auth:t,stsTokenManager:i,...l}){this.providerId="firebase",this.proactiveRefresh=new WC(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=l.displayName||null,this.email=l.email||null,this.emailVerified=l.emailVerified||!1,this.phoneNumber=l.phoneNumber||null,this.photoURL=l.photoURL||null,this.isAnonymous=l.isAnonymous||!1,this.tenantId=l.tenantId||null,this.providerData=l.providerData?[...l.providerData]:[],this.metadata=new Jp(l.createdAt||void 0,l.lastLoginAt||void 0)}async getIdToken(e){const t=await eu(this,this.stsTokenManager.getToken(this.auth,e));return _t(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return HC(this,e)}reload(){return GC(this)}_assign(e){this!==e&&(_t(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new ei({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){_t(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),t&&await kd(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(xr(this.auth.app))return Promise.reject(Qi(this.auth));const e=await this.getIdToken();return await eu(this,qC(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const i=t.displayName??void 0,l=t.email??void 0,u=t.phoneNumber??void 0,h=t.photoURL??void 0,p=t.tenantId??void 0,g=t._redirectEventId??void 0,y=t.createdAt??void 0,b=t.lastLoginAt??void 0,{uid:E,emailVerified:T,isAnonymous:O,providerData:H,stsTokenManager:q}=t;_t(E&&q,e,"internal-error");const B=jl.fromJSON(this.name,q);_t(typeof E=="string",e,"internal-error"),Ia(i,e.name),Ia(l,e.name),_t(typeof T=="boolean",e,"internal-error"),_t(typeof O=="boolean",e,"internal-error"),Ia(u,e.name),Ia(h,e.name),Ia(p,e.name),Ia(g,e.name),Ia(y,e.name),Ia(b,e.name);const te=new ei({uid:E,auth:e,email:l,emailVerified:T,displayName:i,isAnonymous:O,photoURL:h,phoneNumber:u,tenantId:p,stsTokenManager:B,createdAt:y,lastLoginAt:b});return H&&Array.isArray(H)&&(te.providerData=H.map(W=>({...W}))),g&&(te._redirectEventId=g),te}static async _fromIdTokenResponse(e,t,i=!1){const l=new jl;l.updateFromServerResponse(t);const u=new ei({uid:t.localId,auth:e,stsTokenManager:l,isAnonymous:i});return await kd(u),u}static async _fromGetAccountInfoResponse(e,t,i){const l=t.users[0];_t(l.localId!==void 0,"internal-error");const u=l.providerUserInfo!==void 0?sw(l.providerUserInfo):[],h=!(l.email&&l.passwordHash)&&!u?.length,p=new jl;p.updateFromIdToken(i);const g=new ei({uid:l.localId,auth:e,stsTokenManager:p,isAnonymous:h}),y={uid:l.localId,displayName:l.displayName||null,photoURL:l.photoUrl||null,email:l.email||null,emailVerified:l.emailVerified||!1,phoneNumber:l.phoneNumber||null,tenantId:l.tenantId||null,providerData:u,metadata:new Jp(l.createdAt,l.lastLoginAt),isAnonymous:!(l.email&&l.passwordHash)&&!u?.length};return Object.assign(g,y),g}}const Vb=new Map;function Ki(s){ea(s instanceof Function,"Expected a class definition");let e=Vb.get(s);return e?(ea(e instanceof s,"Instance stored in cache mismatched with class"),e):(e=new s,Vb.set(s,e),e)}class rw{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}rw.type="NONE";const Ub=rw;function ud(s,e,t){return`firebase:${s}:${e}:${t}`}class Cl{constructor(e,t,i){this.persistence=e,this.auth=t,this.userKey=i;const{config:l,name:u}=this.auth;this.fullUserKey=ud(this.userKey,l.apiKey,u),this.fullPersistenceKey=ud("persistence",l.apiKey,u),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await Td(this.auth,{idToken:e}).catch(()=>{});return t?ei._fromGetAccountInfoResponse(this.auth,t,e):null}return ei._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,i="authUser"){if(!t.length)return new Cl(Ki(Ub),e,i);const l=(await Promise.all(t.map(async y=>{if(await y._isAvailable())return y}))).filter(y=>y);let u=l[0]||Ki(Ub);const h=ud(i,e.config.apiKey,e.name);let p=null;for(const y of t)try{const b=await y._get(h);if(b){let E;if(typeof b=="string"){const T=await Td(e,{idToken:b}).catch(()=>{});if(!T)break;E=await ei._fromGetAccountInfoResponse(e,T,b)}else E=ei._fromJSON(e,b);y!==u&&(p=E),u=y;break}}catch{}const g=l.filter(y=>y._shouldAllowMigration);return!u._shouldAllowMigration||!g.length?new Cl(u,e,i):(u=g[0],p&&await u._set(h,p.toJSON()),await Promise.all(t.map(async y=>{if(y!==u)try{await y._remove(h)}catch{}})),new Cl(u,e,i))}}function Bb(s){const e=s.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(lw(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(iw(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(uw(e))return"Blackberry";if(hw(e))return"Webos";if(aw(e))return"Safari";if((e.includes("chrome/")||ow(e))&&!e.includes("edge/"))return"Chrome";if(cw(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=s.match(t);if(i?.length===2)return i[1]}return"Other"}function iw(s=Ws()){return/firefox\//i.test(s)}function aw(s=Ws()){const e=s.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function ow(s=Ws()){return/crios\//i.test(s)}function lw(s=Ws()){return/iemobile/i.test(s)}function cw(s=Ws()){return/android/i.test(s)}function uw(s=Ws()){return/blackberry/i.test(s)}function hw(s=Ws()){return/webos/i.test(s)}function Ug(s=Ws()){return/iphone|ipad|ipod/i.test(s)||/macintosh/i.test(s)&&/mobile/i.test(s)}function XC(s=Ws()){return Ug(s)&&!!window.navigator?.standalone}function JC(){return dj()&&document.documentMode===10}function dw(s=Ws()){return Ug(s)||cw(s)||hw(s)||uw(s)||/windows phone/i.test(s)||lw(s)}function fw(s,e=[]){let t;switch(s){case"Browser":t=Bb(Ws());break;case"Worker":t=`${Bb(Ws())}-${s}`;break;default:t=s}const i=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Vo}/${i}`}class ZC{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const i=u=>new Promise((h,p)=>{try{const g=e(u);h(g)}catch(g){p(g)}});i.onAbort=t,this.queue.push(i);const l=this.queue.length-1;return()=>{this.queue[l]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const i of this.queue)await i(e),i.onAbort&&t.push(i.onAbort)}catch(i){t.reverse();for(const l of t)try{l()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i?.message})}}}async function eN(s,e={}){return ia(s,"GET","/v2/passwordPolicy",ra(s,e))}const tN=6;class nN{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??tN,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const i=this.customStrengthOptions.minPasswordLength,l=this.customStrengthOptions.maxPasswordLength;i&&(t.meetsMinPasswordLength=e.length>=i),l&&(t.meetsMaxPasswordLength=e.length<=l)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let i;for(let l=0;l<e.length;l++)i=e.charAt(l),this.updatePasswordCharacterOptionsStatuses(t,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,t,i,l,u){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=l)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=u))}}class sN{constructor(e,t,i,l){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=i,this.config=l,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new zb(this),this.idTokenSubscription=new zb(this),this.beforeStateQueue=new ZC(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=J_,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=l.sdkClientVersion,this._persistenceManagerAvailable=new Promise(u=>this._resolvePersistenceManagerAvailable=u)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Ki(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await Cl.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await Td(this,{idToken:e}),i=await ei._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(i)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(xr(this.app)){const u=this.app.settings.authIdToken;return u?new Promise(h=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(u).then(h,h))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let i=t,l=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const u=this.redirectUser?._redirectEventId,h=i?._redirectEventId,p=await this.tryRedirectSignIn(e);(!u||u===h)&&p?.user&&(i=p.user,l=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(l)try{await this.beforeStateQueue.runMiddleware(i)}catch(u){i=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(u))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return _t(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await kd(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=LC()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(xr(this.app))return Promise.reject(Qi(this));const t=e?Tn(e):null;return t&&_t(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&_t(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return xr(this.app)?Promise.reject(Qi(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return xr(this.app)?Promise.reject(Qi(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Ki(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await eN(this),t=new nN(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new pu("auth","Firebase",e())}onAuthStateChanged(e,t,i){return this.registerStateListener(this.authStateSubscription,e,t,i)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,i){return this.registerStateListener(this.idTokenSubscription,e,t,i)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const i=this.onAuthStateChanged(()=>{i(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(i.tenantId=this.tenantId),await QC(this,i)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const i=await this.getOrInitRedirectPersistenceManager(t);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Ki(e)||this._popupRedirectResolver;_t(t,this,"argument-error"),this.redirectPersistenceManager=await Cl.create(this,[Ki(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,i,l){if(this._deleted)return()=>{};const u=typeof t=="function"?t:t.next.bind(t);let h=!1;const p=this._isInitialized?Promise.resolve():this._initializationPromise;if(_t(p,this,"internal-error"),p.then(()=>{h||u(this.currentUser)}),typeof t=="function"){const g=e.addObserver(t,i,l);return()=>{h=!0,g()}}else{const g=e.addObserver(t);return()=>{h=!0,g()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return _t(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=fw(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const i=await this._getAppCheckToken();return i&&(e["X-Firebase-AppCheck"]=i),e}async _getAppCheckToken(){if(xr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&IC(`Error while retrieving App Check token: ${e.error}`),e?.token}}function Za(s){return Tn(s)}class zb{constructor(e){this.auth=e,this.observer=null,this.addObserver=_j(t=>this.observer=t)}get next(){return _t(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let $d={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function rN(s){$d=s}function mw(s){return $d.loadJS(s)}function iN(){return $d.recaptchaEnterpriseScript}function aN(){return $d.gapiScript}function oN(s){return`__${s}${Math.floor(Math.random()*1e6)}`}class lN{constructor(){this.enterprise=new cN}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class cN{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const uN="recaptcha-enterprise",pw="NO_RECAPTCHA";class hN{constructor(e){this.type=uN,this.auth=Za(e)}async verify(e="verify",t=!1){async function i(u){if(!t){if(u.tenantId==null&&u._agentRecaptchaConfig!=null)return u._agentRecaptchaConfig.siteKey;if(u.tenantId!=null&&u._tenantRecaptchaConfigs[u.tenantId]!==void 0)return u._tenantRecaptchaConfigs[u.tenantId].siteKey}return new Promise(async(h,p)=>{FC(u,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(g=>{if(g.recaptchaKey===void 0)p(new Error("recaptcha Enterprise site key undefined"));else{const y=new zC(g);return u.tenantId==null?u._agentRecaptchaConfig=y:u._tenantRecaptchaConfigs[u.tenantId]=y,h(y.siteKey)}}).catch(g=>{p(g)})})}function l(u,h,p){const g=window.grecaptcha;Ob(g)?g.enterprise.ready(()=>{g.enterprise.execute(u,{action:e}).then(y=>{h(y)}).catch(()=>{h(pw)})}):p(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new lN().execute("siteKey",{action:"verify"}):new Promise((u,h)=>{i(this.auth).then(p=>{if(!t&&Ob(window.grecaptcha))l(p,u,h);else{if(typeof window>"u"){h(new Error("RecaptchaVerifier is only supported in browser"));return}let g=iN();g.length!==0&&(g+=p),mw(g).then(()=>{l(p,u,h)}).catch(y=>{h(y)})}}).catch(p=>{h(p)})})}}async function Fb(s,e,t,i=!1,l=!1){const u=new hN(s);let h;if(l)h=pw;else try{h=await u.verify(t)}catch{h=await u.verify(t,!0)}const p={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in p){const g=p.phoneEnrollmentInfo.phoneNumber,y=p.phoneEnrollmentInfo.recaptchaToken;Object.assign(p,{phoneEnrollmentInfo:{phoneNumber:g,recaptchaToken:y,captchaResponse:h,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in p){const g=p.phoneSignInInfo.recaptchaToken;Object.assign(p,{phoneSignInInfo:{recaptchaToken:g,captchaResponse:h,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return p}return i?Object.assign(p,{captchaResp:h}):Object.assign(p,{captchaResponse:h}),Object.assign(p,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(p,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),p}async function Sd(s,e,t,i,l){if(s._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const u=await Fb(s,e,t,t==="getOobCode");return i(s,u)}else return i(s,e).catch(async u=>{if(u.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const h=await Fb(s,e,t,t==="getOobCode");return i(s,h)}else return Promise.reject(u)})}function dN(s,e){const t=Hd(s,"auth");if(t.isInitialized()){const l=t.getImmediate(),u=t.getOptions();if(Ao(u,e??{}))return l;si(l,"already-initialized")}return t.initialize({options:e})}function fN(s,e){const t=e?.persistence||[],i=(Array.isArray(t)?t:[t]).map(Ki);e?.errorMap&&s._updateErrorMap(e.errorMap),s._initializeWithPersistence(i,e?.popupRedirectResolver)}function mN(s,e,t){const i=Za(s);_t(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const l=!1,u=gw(e),{host:h,port:p}=pN(e),g=p===null?"":`:${p}`,y={url:`${u}//${h}${g}/`},b=Object.freeze({host:h,port:p,protocol:u.replace(":",""),options:Object.freeze({disableWarnings:l})});if(!i._canInitEmulator){_t(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),_t(Ao(y,i.config.emulator)&&Ao(b,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=y,i.emulatorConfig=b,i.settings.appVerificationDisabledForTesting=!0,Ja(h)?(Ag(`${u}//${h}${g}`),Rg("Auth",!0)):gN()}function gw(s){const e=s.indexOf(":");return e<0?"":s.substr(0,e+1)}function pN(s){const e=gw(s),t=/(\/\/)?([^?#/]+)/.exec(s.substr(e.length));if(!t)return{host:"",port:null};const i=t[2].split("@").pop()||"",l=/^(\[[^\]]+\])(:|$)/.exec(i);if(l){const u=l[1];return{host:u,port:qb(i.substr(u.length+1))}}else{const[u,h]=i.split(":");return{host:u,port:qb(h)}}}function qb(s){if(!s)return null;const e=Number(s);return isNaN(e)?null:e}function gN(){function s(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",s):s())}class Bg{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Gi("not implemented")}_getIdTokenResponse(e){return Gi("not implemented")}_linkToIdToken(e,t){return Gi("not implemented")}_getReauthenticationResolver(e){return Gi("not implemented")}}async function yN(s,e){return ia(s,"POST","/v1/accounts:signUp",e)}async function vN(s,e){return vu(s,"POST","/v1/accounts:signInWithPassword",ra(s,e))}async function yw(s,e){return ia(s,"POST","/v1/accounts:sendOobCode",ra(s,e))}async function bN(s,e){return yw(s,e)}async function _N(s,e){return yw(s,e)}async function wN(s,e){return vu(s,"POST","/v1/accounts:signInWithEmailLink",ra(s,e))}async function xN(s,e){return vu(s,"POST","/v1/accounts:signInWithEmailLink",ra(s,e))}class tu extends Bg{constructor(e,t,i,l=null){super("password",i),this._email=e,this._password=t,this._tenantId=l}static _fromEmailAndPassword(e,t){return new tu(e,t,"password")}static _fromEmailAndCode(e,t,i=null){return new tu(e,t,"emailLink",i)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Sd(e,t,"signInWithPassword",vN);case"emailLink":return wN(e,{email:this._email,oobCode:this._password});default:si(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const i={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Sd(e,i,"signUpPassword",yN);case"emailLink":return xN(e,{idToken:t,email:this._email,oobCode:this._password});default:si(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function Nl(s,e){return vu(s,"POST","/v1/accounts:signInWithIdp",ra(s,e))}const EN="http://localhost";class Io extends Bg{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Io(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):si("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:l,...u}=t;if(!i||!l)return null;const h=new Io(i,l);return h.idToken=u.idToken||void 0,h.accessToken=u.accessToken||void 0,h.secret=u.secret,h.nonce=u.nonce,h.pendingToken=u.pendingToken||null,h}_getIdTokenResponse(e){const t=this.buildRequest();return Nl(e,t)}_linkToIdToken(e,t){const i=this.buildRequest();return i.idToken=t,Nl(e,i)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Nl(e,t)}buildRequest(){const e={requestUri:EN,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=gu(t)}return e}}function TN(s){switch(s){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function kN(s){const e=Uc(Bc(s)).link,t=e?Uc(Bc(e)).deep_link_id:null,i=Uc(Bc(s)).deep_link_id;return(i?Uc(Bc(i)).link:null)||i||t||e||s}class zg{constructor(e){const t=Uc(Bc(e)),i=t.apiKey??null,l=t.oobCode??null,u=TN(t.mode??null);_t(i&&l&&u,"argument-error"),this.apiKey=i,this.operation=u,this.code=l,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=kN(e);try{return new zg(t)}catch{return null}}}class zl{constructor(){this.providerId=zl.PROVIDER_ID}static credential(e,t){return tu._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const i=zg.parseLink(t);return _t(i,"argument-error"),tu._fromEmailAndCode(e,i.code,i.tenantId)}}zl.PROVIDER_ID="password";zl.EMAIL_PASSWORD_SIGN_IN_METHOD="password";zl.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class vw{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class bu extends vw{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Da extends bu{constructor(){super("facebook.com")}static credential(e){return Io._fromParams({providerId:Da.PROVIDER_ID,signInMethod:Da.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Da.credentialFromTaggedObject(e)}static credentialFromError(e){return Da.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Da.credential(e.oauthAccessToken)}catch{return null}}}Da.FACEBOOK_SIGN_IN_METHOD="facebook.com";Da.PROVIDER_ID="facebook.com";class Ma extends bu{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Io._fromParams({providerId:Ma.PROVIDER_ID,signInMethod:Ma.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Ma.credentialFromTaggedObject(e)}static credentialFromError(e){return Ma.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:i}=e;if(!t&&!i)return null;try{return Ma.credential(t,i)}catch{return null}}}Ma.GOOGLE_SIGN_IN_METHOD="google.com";Ma.PROVIDER_ID="google.com";class La extends bu{constructor(){super("github.com")}static credential(e){return Io._fromParams({providerId:La.PROVIDER_ID,signInMethod:La.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return La.credentialFromTaggedObject(e)}static credentialFromError(e){return La.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return La.credential(e.oauthAccessToken)}catch{return null}}}La.GITHUB_SIGN_IN_METHOD="github.com";La.PROVIDER_ID="github.com";class Oa extends bu{constructor(){super("twitter.com")}static credential(e,t){return Io._fromParams({providerId:Oa.PROVIDER_ID,signInMethod:Oa.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Oa.credentialFromTaggedObject(e)}static credentialFromError(e){return Oa.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:i}=e;if(!t||!i)return null;try{return Oa.credential(t,i)}catch{return null}}}Oa.TWITTER_SIGN_IN_METHOD="twitter.com";Oa.PROVIDER_ID="twitter.com";async function SN(s,e){return vu(s,"POST","/v1/accounts:signUp",ra(s,e))}class Do{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,i,l=!1){const u=await ei._fromIdTokenResponse(e,i,l),h=Hb(i);return new Do({user:u,providerId:h,_tokenResponse:i,operationType:t})}static async _forOperation(e,t,i){await e._updateTokensIfNecessary(i,!0);const l=Hb(i);return new Do({user:e,providerId:l,_tokenResponse:i,operationType:t})}}function Hb(s){return s.providerId?s.providerId:"phoneNumber"in s?"phone":null}class jd extends ji{constructor(e,t,i,l){super(t.code,t.message),this.operationType=i,this.user=l,Object.setPrototypeOf(this,jd.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,t,i,l){return new jd(e,t,i,l)}}function bw(s,e,t,i){return(e==="reauthenticate"?t._getReauthenticationResolver(s):t._getIdTokenResponse(s)).catch(u=>{throw u.code==="auth/multi-factor-auth-required"?jd._fromErrorAndOperation(s,u,e,i):u})}async function jN(s,e,t=!1){const i=await eu(s,e._linkToIdToken(s.auth,await s.getIdToken()),t);return Do._forOperation(s,"link",i)}async function CN(s,e,t=!1){const{auth:i}=s;if(xr(i.app))return Promise.reject(Qi(i));const l="reauthenticate";try{const u=await eu(s,bw(i,l,e,s),t);_t(u.idToken,i,"internal-error");const h=Vg(u.idToken);_t(h,i,"internal-error");const{sub:p}=h;return _t(s.uid===p,i,"user-mismatch"),Do._forOperation(s,l,u)}catch(u){throw u?.code==="auth/user-not-found"&&si(i,"user-mismatch"),u}}async function _w(s,e,t=!1){if(xr(s.app))return Promise.reject(Qi(s));const i="signIn",l=await bw(s,i,e),u=await Do._fromIdTokenResponse(s,i,l);return t||await s._updateCurrentUser(u.user),u}async function NN(s,e){return _w(Za(s),e)}async function ww(s){const e=Za(s);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function AN(s,e,t){const i=Za(s);await Sd(i,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",_N)}async function RN(s,e,t){if(xr(s.app))return Promise.reject(Qi(s));const i=Za(s),h=await Sd(i,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",SN).catch(g=>{throw g.code==="auth/password-does-not-meet-requirements"&&ww(s),g}),p=await Do._fromIdTokenResponse(i,"signIn",h);return await i._updateCurrentUser(p.user),p}function IN(s,e,t){return xr(s.app)?Promise.reject(Qi(s)):NN(Tn(s),zl.credential(e,t)).catch(async i=>{throw i.code==="auth/password-does-not-meet-requirements"&&ww(s),i})}async function c3(s,e){const t=Tn(s),l={requestType:"VERIFY_EMAIL",idToken:await s.getIdToken()},{email:u}=await bN(t.auth,l);u!==s.email&&await s.reload()}function $b(s,e){return Tn(s).setPersistence(e)}function DN(s,e,t,i){return Tn(s).onIdTokenChanged(e,t,i)}function MN(s,e,t){return Tn(s).beforeAuthStateChanged(e,t)}function LN(s,e,t,i){return Tn(s).onAuthStateChanged(e,t,i)}function ON(s){return Tn(s).signOut()}const Cd="__sak";class xw{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Cd,"1"),this.storage.removeItem(Cd),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const PN=1e3,VN=10;class Ew extends xw{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=dw(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const i=this.storage.getItem(t),l=this.localCache[t];i!==l&&e(t,l,i)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((h,p,g)=>{this.notifyListeners(h,g)});return}const i=e.key;t?this.detachListener():this.stopPolling();const l=()=>{const h=this.storage.getItem(i);!t&&this.localCache[i]===h||this.notifyListeners(i,h)},u=this.storage.getItem(i);JC()&&u!==e.newValue&&e.newValue!==e.oldValue?setTimeout(l,VN):l()}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const l of Array.from(i))l(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:i}),!0)})},PN)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}Ew.type="LOCAL";const Zp=Ew;class Tw extends xw{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}Tw.type="SESSION";const Fg=Tw;function UN(s){return Promise.all(s.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class Wd{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(l=>l.isListeningto(e));if(t)return t;const i=new Wd(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:i,eventType:l,data:u}=t.data,h=this.handlersMap[l];if(!h?.size)return;t.ports[0].postMessage({status:"ack",eventId:i,eventType:l});const p=Array.from(h).map(async y=>y(t.origin,u)),g=await UN(p);t.ports[0].postMessage({status:"done",eventId:i,eventType:l,response:g})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Wd.receivers=[];function qg(s="",e=10){let t="";for(let i=0;i<e;i++)t+=Math.floor(Math.random()*10);return s+t}class BN{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,i=50){const l=typeof MessageChannel<"u"?new MessageChannel:null;if(!l)throw new Error("connection_unavailable");let u,h;return new Promise((p,g)=>{const y=qg("",20);l.port1.start();const b=setTimeout(()=>{g(new Error("unsupported_event"))},i);h={messageChannel:l,onMessage(E){const T=E;if(T.data.eventId===y)switch(T.data.status){case"ack":clearTimeout(b),u=setTimeout(()=>{g(new Error("timeout"))},3e3);break;case"done":clearTimeout(u),p(T.data.response);break;default:clearTimeout(b),clearTimeout(u),g(new Error("invalid_response"));break}}},this.handlers.add(h),l.port1.addEventListener("message",h.onMessage),this.target.postMessage({eventType:e,eventId:y,data:t},[l.port2])}).finally(()=>{h&&this.removeMessageHandler(h)})}}function _i(){return window}function zN(s){_i().location.href=s}function kw(){return typeof _i().WorkerGlobalScope<"u"&&typeof _i().importScripts=="function"}async function FN(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function qN(){return navigator?.serviceWorker?.controller||null}function HN(){return kw()?self:null}const Sw="firebaseLocalStorageDb",$N=1,Nd="firebaseLocalStorage",jw="fbase_key";class _u{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Gd(s,e){return s.transaction([Nd],e?"readwrite":"readonly").objectStore(Nd)}function WN(){const s=indexedDB.deleteDatabase(Sw);return new _u(s).toPromise()}function eg(){const s=indexedDB.open(Sw,$N);return new Promise((e,t)=>{s.addEventListener("error",()=>{t(s.error)}),s.addEventListener("upgradeneeded",()=>{const i=s.result;try{i.createObjectStore(Nd,{keyPath:jw})}catch(l){t(l)}}),s.addEventListener("success",async()=>{const i=s.result;i.objectStoreNames.contains(Nd)?e(i):(i.close(),await WN(),e(await eg()))})})}async function Wb(s,e,t){const i=Gd(s,!0).put({[jw]:e,value:t});return new _u(i).toPromise()}async function GN(s,e){const t=Gd(s,!1).get(e),i=await new _u(t).toPromise();return i===void 0?null:i.value}function Gb(s,e){const t=Gd(s,!0).delete(e);return new _u(t).toPromise()}const KN=800,YN=3;class Cw{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await eg(),this.db)}async _withRetries(e){let t=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(i){if(t++>YN)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return kw()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Wd._getInstance(HN()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await FN(),!this.activeServiceWorker)return;this.sender=new BN(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||qN()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await eg();return await Wb(e,Cd,"1"),await Gb(e,Cd),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(i=>Wb(i,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(i=>GN(i,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>Gb(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(l=>{const u=Gd(l,!1).getAll();return new _u(u).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],i=new Set;if(e.length!==0)for(const{fbase_key:l,value:u}of e)i.add(l),JSON.stringify(this.localCache[l])!==JSON.stringify(u)&&(this.notifyListeners(l,u),t.push(l));for(const l of Object.keys(this.localCache))this.localCache[l]&&!i.has(l)&&(this.notifyListeners(l,null),t.push(l));return t}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const l of Array.from(i))l(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),KN)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}Cw.type="LOCAL";const QN=Cw;new yu(3e4,6e4);function XN(s,e){return e?Ki(e):(_t(s._popupRedirectResolver,s,"argument-error"),s._popupRedirectResolver)}class Hg extends Bg{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Nl(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Nl(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Nl(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function JN(s){return _w(s.auth,new Hg(s),s.bypassAuthState)}function ZN(s){const{auth:e,user:t}=s;return _t(t,e,"internal-error"),CN(t,new Hg(s),s.bypassAuthState)}async function eA(s){const{auth:e,user:t}=s;return _t(t,e,"internal-error"),jN(t,new Hg(s),s.bypassAuthState)}class Nw{constructor(e,t,i,l,u=!1){this.auth=e,this.resolver=i,this.user=l,this.bypassAuthState=u,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:i,postBody:l,tenantId:u,error:h,type:p}=e;if(h){this.reject(h);return}const g={auth:this.auth,requestUri:t,sessionId:i,tenantId:u||void 0,postBody:l||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(p)(g))}catch(y){this.reject(y)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return JN;case"linkViaPopup":case"linkViaRedirect":return eA;case"reauthViaPopup":case"reauthViaRedirect":return ZN;default:si(this.auth,"internal-error")}}resolve(e){ea(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){ea(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const tA=new yu(2e3,1e4);class Sl extends Nw{constructor(e,t,i,l,u){super(e,t,l,u),this.provider=i,this.authWindow=null,this.pollId=null,Sl.currentPopupAction&&Sl.currentPopupAction.cancel(),Sl.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return _t(e,this.auth,"internal-error"),e}async onExecution(){ea(this.filter.length===1,"Popup operations only handle one event");const e=qg();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(bi(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(bi(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Sl.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(bi(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,tA.get())};e()}}Sl.currentPopupAction=null;const nA="pendingRedirect",hd=new Map;class sA extends Nw{constructor(e,t,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,i),this.eventId=null}async execute(){let e=hd.get(this.auth._key());if(!e){try{const i=await rA(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(t){e=()=>Promise.reject(t)}hd.set(this.auth._key(),e)}return this.bypassAuthState||hd.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function rA(s,e){const t=oA(e),i=aA(s);if(!await i._isAvailable())return!1;const l=await i._get(t)==="true";return await i._remove(t),l}function iA(s,e){hd.set(s._key(),e)}function aA(s){return Ki(s._redirectPersistence)}function oA(s){return ud(nA,s.config.apiKey,s.name)}async function lA(s,e,t=!1){if(xr(s.app))return Promise.reject(Qi(s));const i=Za(s),l=XN(i,e),h=await new sA(i,l,t).execute();return h&&!t&&(delete h.user._redirectEventId,await i._persistUserIfCurrent(h.user),await i._setRedirectUser(null,e)),h}const cA=600*1e3;class uA{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(t=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!hA(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!Aw(e)){const i=e.error.code?.split("auth/")[1]||"internal-error";t.onError(bi(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const i=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=cA&&this.cachedEventUids.clear(),this.cachedEventUids.has(Kb(e))}saveEventToCache(e){this.cachedEventUids.add(Kb(e)),this.lastProcessedEventTime=Date.now()}}function Kb(s){return[s.type,s.eventId,s.sessionId,s.tenantId].filter(e=>e).join("-")}function Aw({type:s,error:e}){return s==="unknown"&&e?.code==="auth/no-auth-event"}function hA(s){switch(s.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Aw(s);default:return!1}}async function dA(s,e={}){return ia(s,"GET","/v1/projects",e)}const fA=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,mA=/^https?/;async function pA(s){if(s.config.emulator)return;const{authorizedDomains:e}=await dA(s);for(const t of e)try{if(gA(t))return}catch{}si(s,"unauthorized-domain")}function gA(s){const e=Xp(),{protocol:t,hostname:i}=new URL(e);if(s.startsWith("chrome-extension://")){const h=new URL(s);return h.hostname===""&&i===""?t==="chrome-extension:"&&s.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&h.hostname===i}if(!mA.test(t))return!1;if(fA.test(s))return i===s;const l=s.replace(/\./g,"\\.");return new RegExp("^(.+\\."+l+"|"+l+")$","i").test(i)}const yA=new yu(3e4,6e4);function Yb(){const s=_i().___jsl;if(s?.H){for(const e of Object.keys(s.H))if(s.H[e].r=s.H[e].r||[],s.H[e].L=s.H[e].L||[],s.H[e].r=[...s.H[e].L],s.CP)for(let t=0;t<s.CP.length;t++)s.CP[t]=null}}function vA(s){return new Promise((e,t)=>{function i(){Yb(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Yb(),t(bi(s,"network-request-failed"))},timeout:yA.get()})}if(_i().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(_i().gapi?.load)i();else{const l=oN("iframefcb");return _i()[l]=()=>{gapi.load?i():t(bi(s,"network-request-failed"))},mw(`${aN()}?onload=${l}`).catch(u=>t(u))}}).catch(e=>{throw dd=null,e})}let dd=null;function bA(s){return dd=dd||vA(s),dd}const _A=new yu(5e3,15e3),wA="__/auth/iframe",xA="emulator/auth/iframe",EA={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},TA=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function kA(s){const e=s.config;_t(e.authDomain,s,"auth-domain-config-required");const t=e.emulator?Pg(e,xA):`https://${s.config.authDomain}/${wA}`,i={apiKey:e.apiKey,appName:s.name,v:Vo},l=TA.get(s.config.apiHost);l&&(i.eid=l);const u=s._getFrameworks();return u.length&&(i.fw=u.join(",")),`${t}?${gu(i).slice(1)}`}async function SA(s){const e=await bA(s),t=_i().gapi;return _t(t,s,"internal-error"),e.open({where:document.body,url:kA(s),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:EA,dontclear:!0},i=>new Promise(async(l,u)=>{await i.restyle({setHideOnLeave:!1});const h=bi(s,"network-request-failed"),p=_i().setTimeout(()=>{u(h)},_A.get());function g(){_i().clearTimeout(p),l(i)}i.ping(g).then(g,()=>{u(h)})}))}const jA={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},CA=500,NA=600,AA="_blank",RA="http://localhost";class Qb{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function IA(s,e,t,i=CA,l=NA){const u=Math.max((window.screen.availHeight-l)/2,0).toString(),h=Math.max((window.screen.availWidth-i)/2,0).toString();let p="";const g={...jA,width:i.toString(),height:l.toString(),top:u,left:h},y=Ws().toLowerCase();t&&(p=ow(y)?AA:t),iw(y)&&(e=e||RA,g.scrollbars="yes");const b=Object.entries(g).reduce((T,[O,H])=>`${T}${O}=${H},`,"");if(XC(y)&&p!=="_self")return DA(e||"",p),new Qb(null);const E=window.open(e||"",p,b);_t(E,s,"popup-blocked");try{E.focus()}catch{}return new Qb(E)}function DA(s,e){const t=document.createElement("a");t.href=s,t.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(i)}const MA="__/auth/handler",LA="emulator/auth/handler",OA=encodeURIComponent("fac");async function Xb(s,e,t,i,l,u){_t(s.config.authDomain,s,"auth-domain-config-required"),_t(s.config.apiKey,s,"invalid-api-key");const h={apiKey:s.config.apiKey,appName:s.name,authType:t,redirectUrl:i,v:Vo,eventId:l};if(e instanceof vw){e.setDefaultLanguage(s.languageCode),h.providerId=e.providerId||"",bj(e.getCustomParameters())||(h.customParameters=JSON.stringify(e.getCustomParameters()));for(const[b,E]of Object.entries({}))h[b]=E}if(e instanceof bu){const b=e.getScopes().filter(E=>E!=="");b.length>0&&(h.scopes=b.join(","))}s.tenantId&&(h.tid=s.tenantId);const p=h;for(const b of Object.keys(p))p[b]===void 0&&delete p[b];const g=await s._getAppCheckToken(),y=g?`#${OA}=${encodeURIComponent(g)}`:"";return`${PA(s)}?${gu(p).slice(1)}${y}`}function PA({config:s}){return s.emulator?Pg(s,LA):`https://${s.authDomain}/${MA}`}const xp="webStorageSupport";class VA{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Fg,this._completeRedirectFn=lA,this._overrideRedirectResult=iA}async _openPopup(e,t,i,l){ea(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const u=await Xb(e,t,i,Xp(),l);return IA(e,u,qg())}async _openRedirect(e,t,i,l){await this._originValidation(e);const u=await Xb(e,t,i,Xp(),l);return zN(u),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:l,promise:u}=this.eventManagers[t];return l?Promise.resolve(l):(ea(u,"If manager is not set, promise should be"),u)}const i=this.initAndGetManager(e);return this.eventManagers[t]={promise:i},i.catch(()=>{delete this.eventManagers[t]}),i}async initAndGetManager(e){const t=await SA(e),i=new uA(e);return t.register("authEvent",l=>(_t(l?.authEvent,e,"invalid-auth-event"),{status:i.onEvent(l.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=t,i}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(xp,{type:xp},l=>{const u=l?.[0]?.[xp];u!==void 0&&t(!!u),si(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=pA(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return dw()||aw()||Ug()}}const UA=VA;var Jb="@firebase/auth",Zb="1.12.0";class BA{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(i=>{e(i?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){_t(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function zA(s){switch(s){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function FA(s){Ro(new $a("auth",(e,{options:t})=>{const i=e.getProvider("app").getImmediate(),l=e.getProvider("heartbeat"),u=e.getProvider("app-check-internal"),{apiKey:h,authDomain:p}=i.options;_t(h&&!h.includes(":"),"invalid-api-key",{appName:i.name});const g={apiKey:h,authDomain:p,clientPlatform:s,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:fw(s)},y=new sN(i,l,u,g);return fN(y,t),y},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,i)=>{e.getProvider("auth-internal").initialize()})),Ro(new $a("auth-internal",e=>{const t=Za(e.getProvider("auth").getImmediate());return(i=>new BA(i))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),vi(Jb,Zb,zA(s)),vi(Jb,Zb,"esm2020")}const qA=300,HA=$_("authIdTokenMaxAge")||qA;let e2=null;const $A=s=>async e=>{const t=e&&await e.getIdTokenResult(),i=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(i&&i>HA)return;const l=t?.token;e2!==l&&(e2=l,await fetch(s,{method:l?"POST":"DELETE",headers:l?{Authorization:`Bearer ${l}`}:{}}))};function Rw(s=Lg()){const e=Hd(s,"auth");if(e.isInitialized())return e.getImmediate();const t=dN(s,{popupRedirectResolver:UA,persistence:[QN,Zp,Fg]}),i=$_("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const u=new URL(i,location.origin);if(location.origin===u.origin){const h=$A(u.toString());MN(t,h,()=>h(t.currentUser)),DN(t,p=>h(p))}}const l=F_("auth");return l&&mN(t,`http://${l}`),t}function WA(){return document.getElementsByTagName("head")?.[0]??document}rN({loadJS(s){return new Promise((e,t)=>{const i=document.createElement("script");i.setAttribute("src",s),i.onload=e,i.onerror=l=>{const u=bi("internal-error");u.customData=l,t(u)},i.type="text/javascript",i.charset="UTF-8",WA().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});FA("Browser");var t2=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var qa,Iw;(function(){var s;function e(A,S){function I(){}I.prototype=S.prototype,A.F=S.prototype,A.prototype=new I,A.prototype.constructor=A,A.D=function(V,D,M){for(var N=Array(arguments.length-2),Ue=2;Ue<arguments.length;Ue++)N[Ue-2]=arguments[Ue];return S.prototype[D].apply(V,N)}}function t(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(i,t),i.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function l(A,S,I){I||(I=0);const V=Array(16);if(typeof S=="string")for(var D=0;D<16;++D)V[D]=S.charCodeAt(I++)|S.charCodeAt(I++)<<8|S.charCodeAt(I++)<<16|S.charCodeAt(I++)<<24;else for(D=0;D<16;++D)V[D]=S[I++]|S[I++]<<8|S[I++]<<16|S[I++]<<24;S=A.g[0],I=A.g[1],D=A.g[2];let M=A.g[3],N;N=S+(M^I&(D^M))+V[0]+3614090360&4294967295,S=I+(N<<7&4294967295|N>>>25),N=M+(D^S&(I^D))+V[1]+3905402710&4294967295,M=S+(N<<12&4294967295|N>>>20),N=D+(I^M&(S^I))+V[2]+606105819&4294967295,D=M+(N<<17&4294967295|N>>>15),N=I+(S^D&(M^S))+V[3]+3250441966&4294967295,I=D+(N<<22&4294967295|N>>>10),N=S+(M^I&(D^M))+V[4]+4118548399&4294967295,S=I+(N<<7&4294967295|N>>>25),N=M+(D^S&(I^D))+V[5]+1200080426&4294967295,M=S+(N<<12&4294967295|N>>>20),N=D+(I^M&(S^I))+V[6]+2821735955&4294967295,D=M+(N<<17&4294967295|N>>>15),N=I+(S^D&(M^S))+V[7]+4249261313&4294967295,I=D+(N<<22&4294967295|N>>>10),N=S+(M^I&(D^M))+V[8]+1770035416&4294967295,S=I+(N<<7&4294967295|N>>>25),N=M+(D^S&(I^D))+V[9]+2336552879&4294967295,M=S+(N<<12&4294967295|N>>>20),N=D+(I^M&(S^I))+V[10]+4294925233&4294967295,D=M+(N<<17&4294967295|N>>>15),N=I+(S^D&(M^S))+V[11]+2304563134&4294967295,I=D+(N<<22&4294967295|N>>>10),N=S+(M^I&(D^M))+V[12]+1804603682&4294967295,S=I+(N<<7&4294967295|N>>>25),N=M+(D^S&(I^D))+V[13]+4254626195&4294967295,M=S+(N<<12&4294967295|N>>>20),N=D+(I^M&(S^I))+V[14]+2792965006&4294967295,D=M+(N<<17&4294967295|N>>>15),N=I+(S^D&(M^S))+V[15]+1236535329&4294967295,I=D+(N<<22&4294967295|N>>>10),N=S+(D^M&(I^D))+V[1]+4129170786&4294967295,S=I+(N<<5&4294967295|N>>>27),N=M+(I^D&(S^I))+V[6]+3225465664&4294967295,M=S+(N<<9&4294967295|N>>>23),N=D+(S^I&(M^S))+V[11]+643717713&4294967295,D=M+(N<<14&4294967295|N>>>18),N=I+(M^S&(D^M))+V[0]+3921069994&4294967295,I=D+(N<<20&4294967295|N>>>12),N=S+(D^M&(I^D))+V[5]+3593408605&4294967295,S=I+(N<<5&4294967295|N>>>27),N=M+(I^D&(S^I))+V[10]+38016083&4294967295,M=S+(N<<9&4294967295|N>>>23),N=D+(S^I&(M^S))+V[15]+3634488961&4294967295,D=M+(N<<14&4294967295|N>>>18),N=I+(M^S&(D^M))+V[4]+3889429448&4294967295,I=D+(N<<20&4294967295|N>>>12),N=S+(D^M&(I^D))+V[9]+568446438&4294967295,S=I+(N<<5&4294967295|N>>>27),N=M+(I^D&(S^I))+V[14]+3275163606&4294967295,M=S+(N<<9&4294967295|N>>>23),N=D+(S^I&(M^S))+V[3]+4107603335&4294967295,D=M+(N<<14&4294967295|N>>>18),N=I+(M^S&(D^M))+V[8]+1163531501&4294967295,I=D+(N<<20&4294967295|N>>>12),N=S+(D^M&(I^D))+V[13]+2850285829&4294967295,S=I+(N<<5&4294967295|N>>>27),N=M+(I^D&(S^I))+V[2]+4243563512&4294967295,M=S+(N<<9&4294967295|N>>>23),N=D+(S^I&(M^S))+V[7]+1735328473&4294967295,D=M+(N<<14&4294967295|N>>>18),N=I+(M^S&(D^M))+V[12]+2368359562&4294967295,I=D+(N<<20&4294967295|N>>>12),N=S+(I^D^M)+V[5]+4294588738&4294967295,S=I+(N<<4&4294967295|N>>>28),N=M+(S^I^D)+V[8]+2272392833&4294967295,M=S+(N<<11&4294967295|N>>>21),N=D+(M^S^I)+V[11]+1839030562&4294967295,D=M+(N<<16&4294967295|N>>>16),N=I+(D^M^S)+V[14]+4259657740&4294967295,I=D+(N<<23&4294967295|N>>>9),N=S+(I^D^M)+V[1]+2763975236&4294967295,S=I+(N<<4&4294967295|N>>>28),N=M+(S^I^D)+V[4]+1272893353&4294967295,M=S+(N<<11&4294967295|N>>>21),N=D+(M^S^I)+V[7]+4139469664&4294967295,D=M+(N<<16&4294967295|N>>>16),N=I+(D^M^S)+V[10]+3200236656&4294967295,I=D+(N<<23&4294967295|N>>>9),N=S+(I^D^M)+V[13]+681279174&4294967295,S=I+(N<<4&4294967295|N>>>28),N=M+(S^I^D)+V[0]+3936430074&4294967295,M=S+(N<<11&4294967295|N>>>21),N=D+(M^S^I)+V[3]+3572445317&4294967295,D=M+(N<<16&4294967295|N>>>16),N=I+(D^M^S)+V[6]+76029189&4294967295,I=D+(N<<23&4294967295|N>>>9),N=S+(I^D^M)+V[9]+3654602809&4294967295,S=I+(N<<4&4294967295|N>>>28),N=M+(S^I^D)+V[12]+3873151461&4294967295,M=S+(N<<11&4294967295|N>>>21),N=D+(M^S^I)+V[15]+530742520&4294967295,D=M+(N<<16&4294967295|N>>>16),N=I+(D^M^S)+V[2]+3299628645&4294967295,I=D+(N<<23&4294967295|N>>>9),N=S+(D^(I|~M))+V[0]+4096336452&4294967295,S=I+(N<<6&4294967295|N>>>26),N=M+(I^(S|~D))+V[7]+1126891415&4294967295,M=S+(N<<10&4294967295|N>>>22),N=D+(S^(M|~I))+V[14]+2878612391&4294967295,D=M+(N<<15&4294967295|N>>>17),N=I+(M^(D|~S))+V[5]+4237533241&4294967295,I=D+(N<<21&4294967295|N>>>11),N=S+(D^(I|~M))+V[12]+1700485571&4294967295,S=I+(N<<6&4294967295|N>>>26),N=M+(I^(S|~D))+V[3]+2399980690&4294967295,M=S+(N<<10&4294967295|N>>>22),N=D+(S^(M|~I))+V[10]+4293915773&4294967295,D=M+(N<<15&4294967295|N>>>17),N=I+(M^(D|~S))+V[1]+2240044497&4294967295,I=D+(N<<21&4294967295|N>>>11),N=S+(D^(I|~M))+V[8]+1873313359&4294967295,S=I+(N<<6&4294967295|N>>>26),N=M+(I^(S|~D))+V[15]+4264355552&4294967295,M=S+(N<<10&4294967295|N>>>22),N=D+(S^(M|~I))+V[6]+2734768916&4294967295,D=M+(N<<15&4294967295|N>>>17),N=I+(M^(D|~S))+V[13]+1309151649&4294967295,I=D+(N<<21&4294967295|N>>>11),N=S+(D^(I|~M))+V[4]+4149444226&4294967295,S=I+(N<<6&4294967295|N>>>26),N=M+(I^(S|~D))+V[11]+3174756917&4294967295,M=S+(N<<10&4294967295|N>>>22),N=D+(S^(M|~I))+V[2]+718787259&4294967295,D=M+(N<<15&4294967295|N>>>17),N=I+(M^(D|~S))+V[9]+3951481745&4294967295,A.g[0]=A.g[0]+S&4294967295,A.g[1]=A.g[1]+(D+(N<<21&4294967295|N>>>11))&4294967295,A.g[2]=A.g[2]+D&4294967295,A.g[3]=A.g[3]+M&4294967295}i.prototype.v=function(A,S){S===void 0&&(S=A.length);const I=S-this.blockSize,V=this.C;let D=this.h,M=0;for(;M<S;){if(D==0)for(;M<=I;)l(this,A,M),M+=this.blockSize;if(typeof A=="string"){for(;M<S;)if(V[D++]=A.charCodeAt(M++),D==this.blockSize){l(this,V),D=0;break}}else for(;M<S;)if(V[D++]=A[M++],D==this.blockSize){l(this,V),D=0;break}}this.h=D,this.o+=S},i.prototype.A=function(){var A=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);A[0]=128;for(var S=1;S<A.length-8;++S)A[S]=0;S=this.o*8;for(var I=A.length-8;I<A.length;++I)A[I]=S&255,S/=256;for(this.v(A),A=Array(16),S=0,I=0;I<4;++I)for(let V=0;V<32;V+=8)A[S++]=this.g[I]>>>V&255;return A};function u(A,S){var I=p;return Object.prototype.hasOwnProperty.call(I,A)?I[A]:I[A]=S(A)}function h(A,S){this.h=S;const I=[];let V=!0;for(let D=A.length-1;D>=0;D--){const M=A[D]|0;V&&M==S||(I[D]=M,V=!1)}this.g=I}var p={};function g(A){return-128<=A&&A<128?u(A,function(S){return new h([S|0],S<0?-1:0)}):new h([A|0],A<0?-1:0)}function y(A){if(isNaN(A)||!isFinite(A))return E;if(A<0)return B(y(-A));const S=[];let I=1;for(let V=0;A>=I;V++)S[V]=A/I|0,I*=4294967296;return new h(S,0)}function b(A,S){if(A.length==0)throw Error("number format error: empty string");if(S=S||10,S<2||36<S)throw Error("radix out of range: "+S);if(A.charAt(0)=="-")return B(b(A.substring(1),S));if(A.indexOf("-")>=0)throw Error('number format error: interior "-" character');const I=y(Math.pow(S,8));let V=E;for(let M=0;M<A.length;M+=8){var D=Math.min(8,A.length-M);const N=parseInt(A.substring(M,M+D),S);D<8?(D=y(Math.pow(S,D)),V=V.j(D).add(y(N))):(V=V.j(I),V=V.add(y(N)))}return V}var E=g(0),T=g(1),O=g(16777216);s=h.prototype,s.m=function(){if(q(this))return-B(this).m();let A=0,S=1;for(let I=0;I<this.g.length;I++){const V=this.i(I);A+=(V>=0?V:4294967296+V)*S,S*=4294967296}return A},s.toString=function(A){if(A=A||10,A<2||36<A)throw Error("radix out of range: "+A);if(H(this))return"0";if(q(this))return"-"+B(this).toString(A);const S=y(Math.pow(A,6));var I=this;let V="";for(;;){const D=pe(I,S).g;I=te(I,D.j(S));let M=((I.g.length>0?I.g[0]:I.h)>>>0).toString(A);if(I=D,H(I))return M+V;for(;M.length<6;)M="0"+M;V=M+V}},s.i=function(A){return A<0?0:A<this.g.length?this.g[A]:this.h};function H(A){if(A.h!=0)return!1;for(let S=0;S<A.g.length;S++)if(A.g[S]!=0)return!1;return!0}function q(A){return A.h==-1}s.l=function(A){return A=te(this,A),q(A)?-1:H(A)?0:1};function B(A){const S=A.g.length,I=[];for(let V=0;V<S;V++)I[V]=~A.g[V];return new h(I,~A.h).add(T)}s.abs=function(){return q(this)?B(this):this},s.add=function(A){const S=Math.max(this.g.length,A.g.length),I=[];let V=0;for(let D=0;D<=S;D++){let M=V+(this.i(D)&65535)+(A.i(D)&65535),N=(M>>>16)+(this.i(D)>>>16)+(A.i(D)>>>16);V=N>>>16,M&=65535,N&=65535,I[D]=N<<16|M}return new h(I,I[I.length-1]&-2147483648?-1:0)};function te(A,S){return A.add(B(S))}s.j=function(A){if(H(this)||H(A))return E;if(q(this))return q(A)?B(this).j(B(A)):B(B(this).j(A));if(q(A))return B(this.j(B(A)));if(this.l(O)<0&&A.l(O)<0)return y(this.m()*A.m());const S=this.g.length+A.g.length,I=[];for(var V=0;V<2*S;V++)I[V]=0;for(V=0;V<this.g.length;V++)for(let D=0;D<A.g.length;D++){const M=this.i(V)>>>16,N=this.i(V)&65535,Ue=A.i(D)>>>16,Ze=A.i(D)&65535;I[2*V+2*D]+=N*Ze,W(I,2*V+2*D),I[2*V+2*D+1]+=M*Ze,W(I,2*V+2*D+1),I[2*V+2*D+1]+=N*Ue,W(I,2*V+2*D+1),I[2*V+2*D+2]+=M*Ue,W(I,2*V+2*D+2)}for(A=0;A<S;A++)I[A]=I[2*A+1]<<16|I[2*A];for(A=S;A<2*S;A++)I[A]=0;return new h(I,0)};function W(A,S){for(;(A[S]&65535)!=A[S];)A[S+1]+=A[S]>>>16,A[S]&=65535,S++}function ee(A,S){this.g=A,this.h=S}function pe(A,S){if(H(S))throw Error("division by zero");if(H(A))return new ee(E,E);if(q(A))return S=pe(B(A),S),new ee(B(S.g),B(S.h));if(q(S))return S=pe(A,B(S)),new ee(B(S.g),S.h);if(A.g.length>30){if(q(A)||q(S))throw Error("slowDivide_ only works with positive integers.");for(var I=T,V=S;V.l(A)<=0;)I=Te(I),V=Te(V);var D=ve(I,1),M=ve(V,1);for(V=ve(V,2),I=ve(I,2);!H(V);){var N=M.add(V);N.l(A)<=0&&(D=D.add(I),M=N),V=ve(V,1),I=ve(I,1)}return S=te(A,D.j(S)),new ee(D,S)}for(D=E;A.l(S)>=0;){for(I=Math.max(1,Math.floor(A.m()/S.m())),V=Math.ceil(Math.log(I)/Math.LN2),V=V<=48?1:Math.pow(2,V-48),M=y(I),N=M.j(S);q(N)||N.l(A)>0;)I-=V,M=y(I),N=M.j(S);H(M)&&(M=T),D=D.add(M),A=te(A,N)}return new ee(D,A)}s.B=function(A){return pe(this,A).h},s.and=function(A){const S=Math.max(this.g.length,A.g.length),I=[];for(let V=0;V<S;V++)I[V]=this.i(V)&A.i(V);return new h(I,this.h&A.h)},s.or=function(A){const S=Math.max(this.g.length,A.g.length),I=[];for(let V=0;V<S;V++)I[V]=this.i(V)|A.i(V);return new h(I,this.h|A.h)},s.xor=function(A){const S=Math.max(this.g.length,A.g.length),I=[];for(let V=0;V<S;V++)I[V]=this.i(V)^A.i(V);return new h(I,this.h^A.h)};function Te(A){const S=A.g.length+1,I=[];for(let V=0;V<S;V++)I[V]=A.i(V)<<1|A.i(V-1)>>>31;return new h(I,A.h)}function ve(A,S){const I=S>>5;S%=32;const V=A.g.length-I,D=[];for(let M=0;M<V;M++)D[M]=S>0?A.i(M+I)>>>S|A.i(M+I+1)<<32-S:A.i(M+I);return new h(D,A.h)}i.prototype.digest=i.prototype.A,i.prototype.reset=i.prototype.u,i.prototype.update=i.prototype.v,Iw=i,h.prototype.add=h.prototype.add,h.prototype.multiply=h.prototype.j,h.prototype.modulo=h.prototype.B,h.prototype.compare=h.prototype.l,h.prototype.toNumber=h.prototype.m,h.prototype.toString=h.prototype.toString,h.prototype.getBits=h.prototype.i,h.fromNumber=y,h.fromString=b,qa=h}).apply(typeof t2<"u"?t2:typeof self<"u"?self:typeof window<"u"?window:{});var Yh=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var Dw,zc,Mw,fd,tg,Lw,Ow,Pw;(function(){var s,e=Object.defineProperty;function t(d){d=[typeof globalThis=="object"&&globalThis,d,typeof window=="object"&&window,typeof self=="object"&&self,typeof Yh=="object"&&Yh];for(var v=0;v<d.length;++v){var x=d[v];if(x&&x.Math==Math)return x}throw Error("Cannot find global object")}var i=t(this);function l(d,v){if(v)e:{var x=i;d=d.split(".");for(var C=0;C<d.length-1;C++){var K=d[C];if(!(K in x))break e;x=x[K]}d=d[d.length-1],C=x[d],v=v(C),v!=C&&v!=null&&e(x,d,{configurable:!0,writable:!0,value:v})}}l("Symbol.dispose",function(d){return d||Symbol("Symbol.dispose")}),l("Array.prototype.values",function(d){return d||function(){return this[Symbol.iterator]()}}),l("Object.entries",function(d){return d||function(v){var x=[],C;for(C in v)Object.prototype.hasOwnProperty.call(v,C)&&x.push([C,v[C]]);return x}});var u=u||{},h=this||self;function p(d){var v=typeof d;return v=="object"&&d!=null||v=="function"}function g(d,v,x){return d.call.apply(d.bind,arguments)}function y(d,v,x){return y=g,y.apply(null,arguments)}function b(d,v){var x=Array.prototype.slice.call(arguments,1);return function(){var C=x.slice();return C.push.apply(C,arguments),d.apply(this,C)}}function E(d,v){function x(){}x.prototype=v.prototype,d.Z=v.prototype,d.prototype=new x,d.prototype.constructor=d,d.Ob=function(C,K,ce){for(var De=Array(arguments.length-2),It=2;It<arguments.length;It++)De[It-2]=arguments[It];return v.prototype[K].apply(C,De)}}var T=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?d=>d&&AsyncContext.Snapshot.wrap(d):d=>d;function O(d){const v=d.length;if(v>0){const x=Array(v);for(let C=0;C<v;C++)x[C]=d[C];return x}return[]}function H(d,v){for(let C=1;C<arguments.length;C++){const K=arguments[C];var x=typeof K;if(x=x!="object"?x:K?Array.isArray(K)?"array":x:"null",x=="array"||x=="object"&&typeof K.length=="number"){x=d.length||0;const ce=K.length||0;d.length=x+ce;for(let De=0;De<ce;De++)d[x+De]=K[De]}else d.push(K)}}class q{constructor(v,x){this.i=v,this.j=x,this.h=0,this.g=null}get(){let v;return this.h>0?(this.h--,v=this.g,this.g=v.next,v.next=null):v=this.i(),v}}function B(d){h.setTimeout(()=>{throw d},0)}function te(){var d=A;let v=null;return d.g&&(v=d.g,d.g=d.g.next,d.g||(d.h=null),v.next=null),v}class W{constructor(){this.h=this.g=null}add(v,x){const C=ee.get();C.set(v,x),this.h?this.h.next=C:this.g=C,this.h=C}}var ee=new q(()=>new pe,d=>d.reset());class pe{constructor(){this.next=this.g=this.h=null}set(v,x){this.h=v,this.g=x,this.next=null}reset(){this.next=this.g=this.h=null}}let Te,ve=!1,A=new W,S=()=>{const d=Promise.resolve(void 0);Te=()=>{d.then(I)}};function I(){for(var d;d=te();){try{d.h.call(d.g)}catch(x){B(x)}var v=ee;v.j(d),v.h<100&&(v.h++,d.next=v.g,v.g=d)}ve=!1}function V(){this.u=this.u,this.C=this.C}V.prototype.u=!1,V.prototype.dispose=function(){this.u||(this.u=!0,this.N())},V.prototype[Symbol.dispose]=function(){this.dispose()},V.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function D(d,v){this.type=d,this.g=this.target=v,this.defaultPrevented=!1}D.prototype.h=function(){this.defaultPrevented=!0};var M=(function(){if(!h.addEventListener||!Object.defineProperty)return!1;var d=!1,v=Object.defineProperty({},"passive",{get:function(){d=!0}});try{const x=()=>{};h.addEventListener("test",x,v),h.removeEventListener("test",x,v)}catch{}return d})();function N(d){return/^[\s\xa0]*$/.test(d)}function Ue(d,v){D.call(this,d?d.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,d&&this.init(d,v)}E(Ue,D),Ue.prototype.init=function(d,v){const x=this.type=d.type,C=d.changedTouches&&d.changedTouches.length?d.changedTouches[0]:null;this.target=d.target||d.srcElement,this.g=v,v=d.relatedTarget,v||(x=="mouseover"?v=d.fromElement:x=="mouseout"&&(v=d.toElement)),this.relatedTarget=v,C?(this.clientX=C.clientX!==void 0?C.clientX:C.pageX,this.clientY=C.clientY!==void 0?C.clientY:C.pageY,this.screenX=C.screenX||0,this.screenY=C.screenY||0):(this.clientX=d.clientX!==void 0?d.clientX:d.pageX,this.clientY=d.clientY!==void 0?d.clientY:d.pageY,this.screenX=d.screenX||0,this.screenY=d.screenY||0),this.button=d.button,this.key=d.key||"",this.ctrlKey=d.ctrlKey,this.altKey=d.altKey,this.shiftKey=d.shiftKey,this.metaKey=d.metaKey,this.pointerId=d.pointerId||0,this.pointerType=d.pointerType,this.state=d.state,this.i=d,d.defaultPrevented&&Ue.Z.h.call(this)},Ue.prototype.h=function(){Ue.Z.h.call(this);const d=this.i;d.preventDefault?d.preventDefault():d.returnValue=!1};var Ze="closure_listenable_"+(Math.random()*1e6|0),Z=0;function we(d,v,x,C,K){this.listener=d,this.proxy=null,this.src=v,this.type=x,this.capture=!!C,this.ha=K,this.key=++Z,this.da=this.fa=!1}function Ie(d){d.da=!0,d.listener=null,d.proxy=null,d.src=null,d.ha=null}function Be(d,v,x){for(const C in d)v.call(x,d[C],C,d)}function re(d,v){for(const x in d)v.call(void 0,d[x],x,d)}function L(d){const v={};for(const x in d)v[x]=d[x];return v}const ie="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function _e(d,v){let x,C;for(let K=1;K<arguments.length;K++){C=arguments[K];for(x in C)d[x]=C[x];for(let ce=0;ce<ie.length;ce++)x=ie[ce],Object.prototype.hasOwnProperty.call(C,x)&&(d[x]=C[x])}}function ke(d){this.src=d,this.g={},this.h=0}ke.prototype.add=function(d,v,x,C,K){const ce=d.toString();d=this.g[ce],d||(d=this.g[ce]=[],this.h++);const De=xe(d,v,C,K);return De>-1?(v=d[De],x||(v.fa=!1)):(v=new we(v,this.src,ce,!!C,K),v.fa=x,d.push(v)),v};function Ee(d,v){const x=v.type;if(x in d.g){var C=d.g[x],K=Array.prototype.indexOf.call(C,v,void 0),ce;(ce=K>=0)&&Array.prototype.splice.call(C,K,1),ce&&(Ie(v),d.g[x].length==0&&(delete d.g[x],d.h--))}}function xe(d,v,x,C){for(let K=0;K<d.length;++K){const ce=d[K];if(!ce.da&&ce.listener==v&&ce.capture==!!x&&ce.ha==C)return K}return-1}var Ke="closure_lm_"+(Math.random()*1e6|0),ct={};function Pe(d,v,x,C,K){if(Array.isArray(v)){for(let ce=0;ce<v.length;ce++)Pe(d,v[ce],x,C,K);return null}return x=ue(x),d&&d[Ze]?d.J(v,x,p(C)?!!C.capture:!1,K):tn(d,v,x,!1,C,K)}function tn(d,v,x,C,K,ce){if(!v)throw Error("Invalid event type");const De=p(K)?!!K.capture:!!K;let It=ut(d);if(It||(d[Ke]=It=new ke(d)),x=It.add(v,x,C,De,ce),x.proxy)return x;if(C=jn(),x.proxy=C,C.src=d,C.listener=x,d.addEventListener)M||(K=De),K===void 0&&(K=!1),d.addEventListener(v.toString(),C,K);else if(d.attachEvent)d.attachEvent(rt(v.toString()),C);else if(d.addListener&&d.removeListener)d.addListener(C);else throw Error("addEventListener and attachEvent are unavailable.");return x}function jn(){function d(x){return v.call(d.src,d.listener,x)}const v=gt;return d}function Un(d,v,x,C,K){if(Array.isArray(v))for(var ce=0;ce<v.length;ce++)Un(d,v[ce],x,C,K);else C=p(C)?!!C.capture:!!C,x=ue(x),d&&d[Ze]?(d=d.i,ce=String(v).toString(),ce in d.g&&(v=d.g[ce],x=xe(v,x,C,K),x>-1&&(Ie(v[x]),Array.prototype.splice.call(v,x,1),v.length==0&&(delete d.g[ce],d.h--)))):d&&(d=ut(d))&&(v=d.g[v.toString()],d=-1,v&&(d=xe(v,x,C,K)),(x=d>-1?v[d]:null)&&Lt(x))}function Lt(d){if(typeof d!="number"&&d&&!d.da){var v=d.src;if(v&&v[Ze])Ee(v.i,d);else{var x=d.type,C=d.proxy;v.removeEventListener?v.removeEventListener(x,C,d.capture):v.detachEvent?v.detachEvent(rt(x),C):v.addListener&&v.removeListener&&v.removeListener(C),(x=ut(v))?(Ee(x,d),x.h==0&&(x.src=null,v[Ke]=null)):Ie(d)}}}function rt(d){return d in ct?ct[d]:ct[d]="on"+d}function gt(d,v){if(d.da)d=!0;else{v=new Ue(v,this);const x=d.listener,C=d.ha||d.src;d.fa&&Lt(d),d=x.call(C,v)}return d}function ut(d){return d=d[Ke],d instanceof ke?d:null}var Bn="__closure_events_fn_"+(Math.random()*1e9>>>0);function ue(d){return typeof d=="function"?d:(d[Bn]||(d[Bn]=function(v){return d.handleEvent(v)}),d[Bn])}function Rt(){V.call(this),this.i=new ke(this),this.M=this,this.G=null}E(Rt,V),Rt.prototype[Ze]=!0,Rt.prototype.removeEventListener=function(d,v,x,C){Un(this,d,v,x,C)};function yt(d,v){var x,C=d.G;if(C)for(x=[];C;C=C.G)x.push(C);if(d=d.M,C=v.type||v,typeof v=="string")v=new D(v,d);else if(v instanceof D)v.target=v.target||d;else{var K=v;v=new D(C,d),_e(v,K)}K=!0;let ce,De;if(x)for(De=x.length-1;De>=0;De--)ce=v.g=x[De],K=Vt(ce,C,!0,v)&&K;if(ce=v.g=d,K=Vt(ce,C,!0,v)&&K,K=Vt(ce,C,!1,v)&&K,x)for(De=0;De<x.length;De++)ce=v.g=x[De],K=Vt(ce,C,!1,v)&&K}Rt.prototype.N=function(){if(Rt.Z.N.call(this),this.i){var d=this.i;for(const v in d.g){const x=d.g[v];for(let C=0;C<x.length;C++)Ie(x[C]);delete d.g[v],d.h--}}this.G=null},Rt.prototype.J=function(d,v,x,C){return this.i.add(String(d),v,!1,x,C)},Rt.prototype.K=function(d,v,x,C){return this.i.add(String(d),v,!0,x,C)};function Vt(d,v,x,C){if(v=d.i.g[String(v)],!v)return!0;v=v.concat();let K=!0;for(let ce=0;ce<v.length;++ce){const De=v[ce];if(De&&!De.da&&De.capture==x){const It=De.listener,ls=De.ha||De.src;De.fa&&Ee(d.i,De),K=It.call(ls,C)!==!1&&K}}return K&&!C.defaultPrevented}function Je(d,v){if(typeof d!="function")if(d&&typeof d.handleEvent=="function")d=y(d.handleEvent,d);else throw Error("Invalid listener argument");return Number(v)>2147483647?-1:h.setTimeout(d,v||0)}function At(d){d.g=Je(()=>{d.g=null,d.i&&(d.i=!1,At(d))},d.l);const v=d.h;d.h=null,d.m.apply(null,v)}class vt extends V{constructor(v,x){super(),this.m=v,this.l=x,this.h=null,this.i=!1,this.g=null}j(v){this.h=arguments,this.g?this.i=!0:At(this)}N(){super.N(),this.g&&(h.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function nn(d){V.call(this),this.h=d,this.g={}}E(nn,V);var js=[];function rs(d){Be(d.g,function(v,x){this.g.hasOwnProperty(x)&&Lt(v)},d),d.g={}}nn.prototype.N=function(){nn.Z.N.call(this),rs(this)},nn.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Xt=h.JSON.stringify,ne=h.JSON.parse,Ne=class{stringify(d){return h.JSON.stringify(d,void 0)}parse(d){return h.JSON.parse(d,void 0)}};function xt(){}function bt(){}var it={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function $e(){D.call(this,"d")}E($e,D);function st(){D.call(this,"c")}E(st,D);var Fe={},sn=null;function on(){return sn=sn||new Rt}Fe.Ia="serverreachability";function Mn(d){D.call(this,Fe.Ia,d)}E(Mn,D);function zn(d){const v=on();yt(v,new Mn(v))}Fe.STAT_EVENT="statevent";function Xn(d,v){D.call(this,Fe.STAT_EVENT,d),this.stat=v}E(Xn,D);function Yt(d){const v=on();yt(v,new Xn(v,d))}Fe.Ja="timingevent";function Fn(d,v){D.call(this,Fe.Ja,d),this.size=v}E(Fn,D);function Cn(d,v){if(typeof d!="function")throw Error("Fn must not be null and must be a function");return h.setTimeout(function(){d()},v)}function ln(){this.g=!0}ln.prototype.ua=function(){this.g=!1};function fr(d,v,x,C,K,ce){d.info(function(){if(d.g)if(ce){var De="",It=ce.split("&");for(let un=0;un<It.length;un++){var ls=It[un].split("=");if(ls.length>1){const $n=ls[0];ls=ls[1];const Mr=$n.split("_");De=Mr.length>=2&&Mr[1]=="type"?De+($n+"="+ls+"&"):De+($n+"=redacted&")}}}else De=null;else De=ce;return"XMLHTTP REQ ("+C+") [attempt "+K+"]: "+v+`
`+x+`
`+De})}function oe(d,v,x,C,K,ce,De){d.info(function(){return"XMLHTTP RESP ("+C+") [ attempt "+K+"]: "+v+`
`+x+`
`+ce+" "+De})}function Ae(d,v,x,C){d.info(function(){return"XMLHTTP TEXT ("+v+"): "+mt(d,x)+(C?" "+C:"")})}function Ge(d,v){d.info(function(){return"TIMEOUT: "+v})}ln.prototype.info=function(){};function mt(d,v){if(!d.g)return v;if(!v)return null;try{const ce=JSON.parse(v);if(ce){for(d=0;d<ce.length;d++)if(Array.isArray(ce[d])){var x=ce[d];if(!(x.length<2)){var C=x[1];if(Array.isArray(C)&&!(C.length<1)){var K=C[0];if(K!="noop"&&K!="stop"&&K!="close")for(let De=1;De<C.length;De++)C[De]=""}}}}return Xt(ce)}catch{return v}}var lt={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},yn={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Nn;function dn(){}E(dn,xt),dn.prototype.g=function(){return new XMLHttpRequest},Nn=new dn;function vn(d){return encodeURIComponent(String(d))}function Cs(d){var v=1;d=d.split(":");const x=[];for(;v>0&&d.length;)x.push(d.shift()),v--;return d.length&&x.push(d.join(":")),x}function is(d,v,x,C){this.j=d,this.i=v,this.l=x,this.S=C||1,this.V=new nn(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new ds}function ds(){this.i=null,this.g="",this.h=!1}var Jt={},An={};function Ns(d,v,x){d.M=1,d.A=Kn(Me(v)),d.u=x,d.R=!0,jr(d,null)}function jr(d,v){d.F=Date.now(),qn(d),d.B=Me(d.A);var x=d.B,C=d.S;Array.isArray(C)||(C=[String(C)]),ze(x.i,"t",C),d.C=0,x=d.j.L,d.h=new ds,d.g=Bu(d.j,x?v:null,!d.u),d.P>0&&(d.O=new vt(y(d.Y,d,d.g),d.P)),v=d.V,x=d.g,C=d.ba;var K="readystatechange";Array.isArray(K)||(K&&(js[0]=K.toString()),K=js);for(let ce=0;ce<K.length;ce++){const De=Pe(x,K[ce],C||v.handleEvent,!1,v.h||v);if(!De)break;v.g[De.key]=De}v=d.J?L(d.J):{},d.u?(d.v||(d.v="POST"),v["Content-Type"]="application/x-www-form-urlencoded",d.g.ea(d.B,d.v,d.u,v)):(d.v="GET",d.g.ea(d.B,d.v,null,v)),zn(),fr(d.i,d.v,d.B,d.l,d.S,d.u)}is.prototype.ba=function(d){d=d.target;const v=this.O;v&&cn(d)==3?v.j():this.Y(d)},is.prototype.Y=function(d){try{if(d==this.g)e:{const It=cn(this.g),ls=this.g.ya(),un=this.g.ca();if(!(It<3)&&(It!=3||this.g&&(this.h.h||this.g.la()||Rn(this.g)))){this.K||It!=4||ls==7||(ls==8||un<=0?zn(3):zn(2)),ws(this);var v=this.g.ca();this.X=v;var x=ai(this);if(this.o=v==200,oe(this.i,this.v,this.B,this.l,this.S,It,v),this.o){if(this.U&&!this.L){t:{if(this.g){var C,K=this.g;if((C=K.g?K.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!N(C)){var ce=C;break t}}ce=null}if(d=ce)Ae(this.i,this.l,d,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,as(this,d);else{this.o=!1,this.m=3,Yt(12),Ln(this),kn(this);break e}}if(this.R){d=!0;let $n;for(;!this.K&&this.C<x.length;)if($n=Nr(this,x),$n==An){It==4&&(this.m=4,Yt(14),d=!1),Ae(this.i,this.l,null,"[Incomplete Response]");break}else if($n==Jt){this.m=4,Yt(15),Ae(this.i,this.l,x,"[Invalid Chunk]"),d=!1;break}else Ae(this.i,this.l,$n,null),as(this,$n);if(Cr(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),It!=4||x.length!=0||this.h.h||(this.m=1,Yt(16),d=!1),this.o=this.o&&d,!d)Ae(this.i,this.l,x,"[Invalid Chunked Response]"),Ln(this),kn(this);else if(x.length>0&&!this.W){this.W=!0;var De=this.j;De.g==this&&De.aa&&!De.P&&(De.j.info("Great, no buffering proxy detected. Bytes received: "+x.length),Kl(De),De.P=!0,Yt(11))}}else Ae(this.i,this.l,x,null),as(this,x);It==4&&Ln(this),this.o&&!this.K&&(It==4?Ou(this.j,this):(this.o=!1,qn(this)))}else Bs(this.g),v==400&&x.indexOf("Unknown SID")>0?(this.m=3,Yt(12)):(this.m=0,Yt(13)),Ln(this),kn(this)}}}catch{}};function ai(d){if(!Cr(d))return d.g.la();const v=Rn(d.g);if(v==="")return"";let x="";const C=v.length,K=cn(d.g)==4;if(!d.h.i){if(typeof TextDecoder>"u")return Ln(d),kn(d),"";d.h.i=new h.TextDecoder}for(let ce=0;ce<C;ce++)d.h.h=!0,x+=d.h.i.decode(v[ce],{stream:!(K&&ce==C-1)});return v.length=0,d.h.g+=x,d.C=0,d.h.g}function Cr(d){return d.g?d.v=="GET"&&d.M!=2&&d.j.Aa:!1}function Nr(d,v){var x=d.C,C=v.indexOf(`
`,x);return C==-1?An:(x=Number(v.substring(x,C)),isNaN(x)?Jt:(C+=1,C+x>v.length?An:(v=v.slice(C,C+x),d.C=C+x,v)))}is.prototype.cancel=function(){this.K=!0,Ln(this)};function qn(d){d.T=Date.now()+d.H,Ks(d,d.H)}function Ks(d,v){if(d.D!=null)throw Error("WatchDog timer not null");d.D=Cn(y(d.aa,d),v)}function ws(d){d.D&&(h.clearTimeout(d.D),d.D=null)}is.prototype.aa=function(){this.D=null;const d=Date.now();d-this.T>=0?(Ge(this.i,this.B),this.M!=2&&(zn(),Yt(17)),Ln(this),this.m=2,kn(this)):Ks(this,this.T-d)};function kn(d){d.j.I==0||d.K||Ou(d.j,d)}function Ln(d){ws(d);var v=d.O;v&&typeof v.dispose=="function"&&v.dispose(),d.O=null,rs(d.V),d.g&&(v=d.g,d.g=null,v.abort(),v.dispose())}function as(d,v){try{var x=d.j;if(x.I!=0&&(x.g==d||bn(x.h,d))){if(!d.L&&bn(x.h,d)&&x.I==3){try{var C=x.Ba.g.parse(v)}catch{C=null}if(Array.isArray(C)&&C.length==3){var K=C;if(K[0]==0){e:if(!x.v){if(x.g)if(x.g.F+3e3<d.F)qo(x),sr(x);else break e;so(x),Yt(18)}}else x.xa=K[1],0<x.xa-x.K&&K[2]<37500&&x.F&&x.A==0&&!x.C&&(x.C=Cn(y(x.Va,x),6e3));xs(x.h)<=1&&x.ta&&(x.ta=void 0)}else ci(x,11)}else if((d.L||x.g==d)&&qo(x),!N(v))for(K=x.Ba.g.parse(v),v=0;v<K.length;v++){let un=K[v];const $n=un[0];if(!($n<=x.K))if(x.K=$n,un=un[1],x.I==2)if(un[0]=="c"){x.M=un[1],x.ba=un[2];const Mr=un[3];Mr!=null&&(x.ka=Mr,x.j.info("VER="+x.ka));const ui=un[4];ui!=null&&(x.za=ui,x.j.info("SVER="+x.za));const Kr=un[5];Kr!=null&&typeof Kr=="number"&&Kr>0&&(C=1.5*Kr,x.O=C,x.j.info("backChannelRequestTimeoutMs_="+C)),C=x;const Yr=d.g;if(Yr){const ro=Yr.g?Yr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(ro){var ce=C.h;ce.g||ro.indexOf("spdy")==-1&&ro.indexOf("quic")==-1&&ro.indexOf("h2")==-1||(ce.j=ce.l,ce.g=new Set,ce.h&&(nr(ce,ce.h),ce.h=null))}if(C.G){const Ho=Yr.g?Yr.g.getResponseHeader("X-HTTP-Session-Id"):null;Ho&&(C.wa=Ho,Ye(C.J,C.G,Ho))}}x.I=3,x.l&&x.l.ra(),x.aa&&(x.T=Date.now()-d.F,x.j.info("Handshake RTT: "+x.T+"ms")),C=x;var De=d;if(C.na=Uu(C,C.L?C.ba:null,C.W),De.L){oi(C.h,De);var It=De,ls=C.O;ls&&(It.H=ls),It.D&&(ws(It),qn(It)),C.g=De}else Mu(C);x.i.length>0&&Dr(x)}else un[0]!="stop"&&un[0]!="close"||ci(x,7);else x.I==3&&(un[0]=="stop"||un[0]=="close"?un[0]=="stop"?ci(x,7):Ys(x):un[0]!="noop"&&x.l&&x.l.qa(un),x.A=0)}}zn(4)}catch{}}var zt=class{constructor(d,v){this.g=d,this.map=v}};function Gr(d){this.l=d||10,h.PerformanceNavigationTiming?(d=h.performance.getEntriesByType("navigation"),d=d.length>0&&(d[0].nextHopProtocol=="hq"||d[0].nextHopProtocol=="h2")):d=!!(h.chrome&&h.chrome.loadTimes&&h.chrome.loadTimes()&&h.chrome.loadTimes().wasFetchedViaSpdy),this.j=d?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Ar(d){return d.h?!0:d.g?d.g.size>=d.j:!1}function xs(d){return d.h?1:d.g?d.g.size:0}function bn(d,v){return d.h?d.h==v:d.g?d.g.has(v):!1}function nr(d,v){d.g?d.g.add(v):d.h=v}function oi(d,v){d.h&&d.h==v?d.h=null:d.g&&d.g.has(v)&&d.g.delete(v)}Gr.prototype.cancel=function(){if(this.i=R(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const d of this.g.values())d.cancel();this.g.clear()}};function R(d){if(d.h!=null)return d.i.concat(d.h.G);if(d.g!=null&&d.g.size!==0){let v=d.i;for(const x of d.g.values())v=v.concat(x.G);return v}return O(d.i)}var z=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function ae(d,v){if(d){d=d.split("&");for(let x=0;x<d.length;x++){const C=d[x].indexOf("=");let K,ce=null;C>=0?(K=d[x].substring(0,C),ce=d[x].substring(C+1)):K=d[x],v(K,ce?decodeURIComponent(ce.replace(/\+/g," ")):"")}}}function le(d){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let v;d instanceof le?(this.l=d.l,Le(this,d.j),this.o=d.o,this.g=d.g,He(this,d.u),this.h=d.h,Ft(this,ht(d.i)),this.m=d.m):d&&(v=String(d).match(z))?(this.l=!1,Le(this,v[1]||"",!0),this.o=os(v[2]||""),this.g=os(v[3]||"",!0),He(this,v[4]),this.h=os(v[5]||"",!0),Ft(this,v[6]||"",!0),this.m=os(v[7]||"")):(this.l=!1,this.i=new Ir(null,this.l))}le.prototype.toString=function(){const d=[];var v=this.j;v&&d.push(Vs(v,mr,!0),":");var x=this.g;return(x||v=="file")&&(d.push("//"),(v=this.o)&&d.push(Vs(v,mr,!0),"@"),d.push(vn(x).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),x=this.u,x!=null&&d.push(":",String(x))),(x=this.h)&&(this.g&&x.charAt(0)!="/"&&d.push("/"),d.push(Vs(x,x.charAt(0)=="/"?Ni:oa,!0))),(x=this.i.toString())&&d.push("?",x),(x=this.m)&&d.push("#",Vs(x,la)),d.join("")},le.prototype.resolve=function(d){const v=Me(this);let x=!!d.j;x?Le(v,d.j):x=!!d.o,x?v.o=d.o:x=!!d.g,x?v.g=d.g:x=d.u!=null;var C=d.h;if(x)He(v,d.u);else if(x=!!d.h){if(C.charAt(0)!="/")if(this.g&&!this.h)C="/"+C;else{var K=v.h.lastIndexOf("/");K!=-1&&(C=v.h.slice(0,K+1)+C)}if(K=C,K==".."||K==".")C="";else if(K.indexOf("./")!=-1||K.indexOf("/.")!=-1){C=K.lastIndexOf("/",0)==0,K=K.split("/");const ce=[];for(let De=0;De<K.length;){const It=K[De++];It=="."?C&&De==K.length&&ce.push(""):It==".."?((ce.length>1||ce.length==1&&ce[0]!="")&&ce.pop(),C&&De==K.length&&ce.push("")):(ce.push(It),C=!0)}C=ce.join("/")}else C=K}return x?v.h=C:x=d.i.toString()!=="",x?Ft(v,ht(d.i)):x=!!d.m,x&&(v.m=d.m),v};function Me(d){return new le(d)}function Le(d,v,x){d.j=x?os(v,!0):v,d.j&&(d.j=d.j.replace(/:$/,""))}function He(d,v){if(v){if(v=Number(v),isNaN(v)||v<0)throw Error("Bad port number "+v);d.u=v}else d.u=null}function Ft(d,v,x){v instanceof Ir?(d.i=v,kt(d.i,d.l)):(x||(v=Vs(v,Rr)),d.i=new Ir(v,d.l))}function Ye(d,v,x){d.i.set(v,x)}function Kn(d){return Ye(d,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),d}function os(d,v){return d?v?decodeURI(d.replace(/%25/g,"%2525")):decodeURIComponent(d):""}function Vs(d,v,x){return typeof d=="string"?(d=encodeURI(d).replace(v,Yn),x&&(d=d.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),d):null}function Yn(d){return d=d.charCodeAt(0),"%"+(d>>4&15).toString(16)+(d&15).toString(16)}var mr=/[#\/\?@]/g,oa=/[#\?:]/g,Ni=/[#\?]/g,Rr=/[#\?@]/g,la=/#/g;function Ir(d,v){this.h=this.g=null,this.i=d||null,this.j=!!v}function j(d){d.g||(d.g=new Map,d.h=0,d.i&&ae(d.i,function(v,x){d.add(decodeURIComponent(v.replace(/\+/g," ")),x)}))}s=Ir.prototype,s.add=function(d,v){j(this),this.i=null,d=et(this,d);let x=this.g.get(d);return x||this.g.set(d,x=[]),x.push(v),this.h+=1,this};function G(d,v){j(d),v=et(d,v),d.g.has(v)&&(d.i=null,d.h-=d.g.get(v).length,d.g.delete(v))}function Ce(d,v){return j(d),v=et(d,v),d.g.has(v)}s.forEach=function(d,v){j(this),this.g.forEach(function(x,C){x.forEach(function(K){d.call(v,K,C,this)},this)},this)};function Re(d,v){j(d);let x=[];if(typeof v=="string")Ce(d,v)&&(x=x.concat(d.g.get(et(d,v))));else for(d=Array.from(d.g.values()),v=0;v<d.length;v++)x=x.concat(d[v]);return x}s.set=function(d,v){return j(this),this.i=null,d=et(this,d),Ce(this,d)&&(this.h-=this.g.get(d).length),this.g.set(d,[v]),this.h+=1,this},s.get=function(d,v){return d?(d=Re(this,d),d.length>0?String(d[0]):v):v};function ze(d,v,x){G(d,v),x.length>0&&(d.i=null,d.g.set(et(d,v),O(x)),d.h+=x.length)}s.toString=function(){if(this.i)return this.i;if(!this.g)return"";const d=[],v=Array.from(this.g.keys());for(let C=0;C<v.length;C++){var x=v[C];const K=vn(x);x=Re(this,x);for(let ce=0;ce<x.length;ce++){let De=K;x[ce]!==""&&(De+="="+vn(x[ce])),d.push(De)}}return this.i=d.join("&")};function ht(d){const v=new Ir;return v.i=d.i,d.g&&(v.g=new Map(d.g),v.h=d.h),v}function et(d,v){return v=String(v),d.j&&(v=v.toLowerCase()),v}function kt(d,v){v&&!d.j&&(j(d),d.i=null,d.g.forEach(function(x,C){const K=C.toLowerCase();C!=K&&(G(this,C),ze(this,K,x))},d)),d.j=v}function dt(d,v){const x=new ln;if(h.Image){const C=new Image;C.onload=b(Y,x,"TestLoadImage: loaded",!0,v,C),C.onerror=b(Y,x,"TestLoadImage: error",!1,v,C),C.onabort=b(Y,x,"TestLoadImage: abort",!1,v,C),C.ontimeout=b(Y,x,"TestLoadImage: timeout",!1,v,C),h.setTimeout(function(){C.ontimeout&&C.ontimeout()},1e4),C.src=d}else v(!1)}function P(d,v){const x=new ln,C=new AbortController,K=setTimeout(()=>{C.abort(),Y(x,"TestPingServer: timeout",!1,v)},1e4);fetch(d,{signal:C.signal}).then(ce=>{clearTimeout(K),ce.ok?Y(x,"TestPingServer: ok",!0,v):Y(x,"TestPingServer: server error",!1,v)}).catch(()=>{clearTimeout(K),Y(x,"TestPingServer: error",!1,v)})}function Y(d,v,x,C,K){try{K&&(K.onload=null,K.onerror=null,K.onabort=null,K.ontimeout=null),C(x)}catch{}}function X(){this.g=new Ne}function ye(d){this.i=d.Sb||null,this.h=d.ab||!1}E(ye,xt),ye.prototype.g=function(){return new je(this.i,this.h)};function je(d,v){Rt.call(this),this.H=d,this.o=v,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}E(je,Rt),s=je.prototype,s.open=function(d,v){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=d,this.D=v,this.readyState=1,pt(this)},s.send=function(d){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const v={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};d&&(v.body=d),(this.H||h).fetch(new Request(this.D,v)).then(this.Pa.bind(this),this.ga.bind(this))},s.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,qe(this)),this.readyState=0},s.Pa=function(d){if(this.g&&(this.l=d,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=d.headers,this.readyState=2,pt(this)),this.g&&(this.readyState=3,pt(this),this.g)))if(this.responseType==="arraybuffer")d.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof h.ReadableStream<"u"&&"body"in d){if(this.j=d.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Oe(this)}else d.text().then(this.Oa.bind(this),this.ga.bind(this))};function Oe(d){d.j.read().then(d.Ma.bind(d)).catch(d.ga.bind(d))}s.Ma=function(d){if(this.g){if(this.o&&d.value)this.response.push(d.value);else if(!this.o){var v=d.value?d.value:new Uint8Array(0);(v=this.B.decode(v,{stream:!d.done}))&&(this.response=this.responseText+=v)}d.done?qe(this):pt(this),this.readyState==3&&Oe(this)}},s.Oa=function(d){this.g&&(this.response=this.responseText=d,qe(this))},s.Na=function(d){this.g&&(this.response=d,qe(this))},s.ga=function(){this.g&&qe(this)};function qe(d){d.readyState=4,d.l=null,d.j=null,d.B=null,pt(d)}s.setRequestHeader=function(d,v){this.A.append(d,v)},s.getResponseHeader=function(d){return this.h&&this.h.get(d.toLowerCase())||""},s.getAllResponseHeaders=function(){if(!this.h)return"";const d=[],v=this.h.entries();for(var x=v.next();!x.done;)x=x.value,d.push(x[0]+": "+x[1]),x=v.next();return d.join(`\r
`)};function pt(d){d.onreadystatechange&&d.onreadystatechange.call(d)}Object.defineProperty(je.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(d){this.m=d?"include":"same-origin"}});function Et(d){let v="";return Be(d,function(x,C){v+=C,v+=":",v+=x,v+=`\r
`}),v}function Pt(d,v,x){e:{for(C in x){var C=!1;break e}C=!0}C||(x=Et(x),typeof d=="string"?x!=null&&vn(x):Ye(d,v,x))}function Qe(d){Rt.call(this),this.headers=new Map,this.L=d||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}E(Qe,Rt);var Zt=/^https?$/i,Us=["POST","PUT"];s=Qe.prototype,s.Fa=function(d){this.H=d},s.ea=function(d,v,x,C){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+d);v=v?v.toUpperCase():"GET",this.D=d,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Nn.g(),this.g.onreadystatechange=T(y(this.Ca,this));try{this.B=!0,this.g.open(v,String(d),!0),this.B=!1}catch(ce){Tt(this,ce);return}if(d=x||"",x=new Map(this.headers),C)if(Object.getPrototypeOf(C)===Object.prototype)for(var K in C)x.set(K,C[K]);else if(typeof C.keys=="function"&&typeof C.get=="function")for(const ce of C.keys())x.set(ce,C.get(ce));else throw Error("Unknown input type for opt_headers: "+String(C));C=Array.from(x.keys()).find(ce=>ce.toLowerCase()=="content-type"),K=h.FormData&&d instanceof h.FormData,!(Array.prototype.indexOf.call(Us,v,void 0)>=0)||C||K||x.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[ce,De]of x)this.g.setRequestHeader(ce,De);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(d),this.v=!1}catch(ce){Tt(this,ce)}};function Tt(d,v){d.h=!1,d.g&&(d.j=!0,d.g.abort(),d.j=!1),d.l=v,d.o=5,Hn(d),St(d)}function Hn(d){d.A||(d.A=!0,yt(d,"complete"),yt(d,"error"))}s.abort=function(d){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=d||7,yt(this,"complete"),yt(this,"abort"),St(this))},s.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),St(this,!0)),Qe.Z.N.call(this)},s.Ca=function(){this.u||(this.B||this.v||this.j?Jn(this):this.Xa())},s.Xa=function(){Jn(this)};function Jn(d){if(d.h&&typeof u<"u"){if(d.v&&cn(d)==4)setTimeout(d.Ca.bind(d),0);else if(yt(d,"readystatechange"),cn(d)==4){d.h=!1;try{const ce=d.ca();e:switch(ce){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var v=!0;break e;default:v=!1}var x;if(!(x=v)){var C;if(C=ce===0){let De=String(d.D).match(z)[1]||null;!De&&h.self&&h.self.location&&(De=h.self.location.protocol.slice(0,-1)),C=!Zt.test(De?De.toLowerCase():"")}x=C}if(x)yt(d,"complete"),yt(d,"success");else{d.o=6;try{var K=cn(d)>2?d.g.statusText:""}catch{K=""}d.l=K+" ["+d.ca()+"]",Hn(d)}}finally{St(d)}}}}function St(d,v){if(d.g){d.m&&(clearTimeout(d.m),d.m=null);const x=d.g;d.g=null,v||yt(d,"ready");try{x.onreadystatechange=null}catch{}}}s.isActive=function(){return!!this.g};function cn(d){return d.g?d.g.readyState:0}s.ca=function(){try{return cn(this)>2?this.g.status:-1}catch{return-1}},s.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},s.La=function(d){if(this.g){var v=this.g.responseText;return d&&v.indexOf(d)==0&&(v=v.substring(d.length)),ne(v)}};function Rn(d){try{if(!d.g)return null;if("response"in d.g)return d.g.response;switch(d.F){case"":case"text":return d.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in d.g)return d.g.mozResponseArrayBuffer}return null}catch{return null}}function Bs(d){const v={};d=(d.g&&cn(d)>=2&&d.g.getAllResponseHeaders()||"").split(`\r
`);for(let C=0;C<d.length;C++){if(N(d[C]))continue;var x=Cs(d[C]);const K=x[0];if(x=x[1],typeof x!="string")continue;x=x.trim();const ce=v[K]||[];v[K]=ce,ce.push(x)}re(v,function(C){return C.join(", ")})}s.ya=function(){return this.o},s.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function zs(d,v,x){return x&&x.internalChannelParams&&x.internalChannelParams[d]||v}function fs(d){this.za=0,this.i=[],this.j=new ln,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=zs("failFast",!1,d),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=zs("baseRetryDelayMs",5e3,d),this.Za=zs("retryDelaySeedMs",1e4,d),this.Ta=zs("forwardChannelMaxRetries",2,d),this.va=zs("forwardChannelRequestTimeoutMs",2e4,d),this.ma=d&&d.xmlHttpFactory||void 0,this.Ua=d&&d.Rb||void 0,this.Aa=d&&d.useFetchStreams||!1,this.O=void 0,this.L=d&&d.supportsCrossDomainXhr||!1,this.M="",this.h=new Gr(d&&d.concurrentRequestLimit),this.Ba=new X,this.S=d&&d.fastHandshake||!1,this.R=d&&d.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=d&&d.Pb||!1,d&&d.ua&&this.j.ua(),d&&d.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&d&&d.detectBufferingProxy||!1,this.ia=void 0,d&&d.longPollingTimeout&&d.longPollingTimeout>0&&(this.ia=d.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}s=fs.prototype,s.ka=8,s.I=1,s.connect=function(d,v,x,C){Yt(0),this.W=d,this.H=v||{},x&&C!==void 0&&(this.H.OSID=x,this.H.OAID=C),this.F=this.X,this.J=Uu(this,null,this.W),Dr(this)};function Ys(d){if(Ai(d),d.I==3){var v=d.V++,x=Me(d.J);if(Ye(x,"SID",d.M),Ye(x,"RID",v),Ye(x,"TYPE","terminate"),no(d,x),v=new is(d,d.j,v),v.M=2,v.A=Kn(Me(x)),x=!1,h.navigator&&h.navigator.sendBeacon)try{x=h.navigator.sendBeacon(v.A.toString(),"")}catch{}!x&&h.Image&&(new Image().src=v.A,x=!0),x||(v.g=Bu(v.j,null),v.g.ea(v.A)),v.F=Date.now(),qn(v)}Vu(d)}function sr(d){d.g&&(Kl(d),d.g.cancel(),d.g=null)}function Ai(d){sr(d),d.v&&(h.clearTimeout(d.v),d.v=null),qo(d),d.h.cancel(),d.m&&(typeof d.m=="number"&&h.clearTimeout(d.m),d.m=null)}function Dr(d){if(!Ar(d.h)&&!d.m){d.m=!0;var v=d.Ea;Te||S(),ve||(Te(),ve=!0),A.add(v,d),d.D=0}}function li(d,v){return xs(d.h)>=d.h.j-(d.m?1:0)?!1:d.m?(d.i=v.G.concat(d.i),!0):d.I==1||d.I==2||d.D>=(d.Sa?0:d.Ta)?!1:(d.m=Cn(y(d.Ea,d,v),Pu(d,d.D)),d.D++,!0)}s.Ea=function(d){if(this.m)if(this.m=null,this.I==1){if(!d){this.V=Math.floor(Math.random()*1e5),d=this.V++;const K=new is(this,this.j,d);let ce=this.o;if(this.U&&(ce?(ce=L(ce),_e(ce,this.U)):ce=this.U),this.u!==null||this.R||(K.J=ce,ce=null),this.S)e:{for(var v=0,x=0;x<this.i.length;x++){t:{var C=this.i[x];if("__data__"in C.map&&(C=C.map.__data__,typeof C=="string")){C=C.length;break t}C=void 0}if(C===void 0)break;if(v+=C,v>4096){v=x;break e}if(v===4096||x===this.i.length-1){v=x+1;break e}}v=1e3}else v=1e3;v=Du(this,K,v),x=Me(this.J),Ye(x,"RID",d),Ye(x,"CVER",22),this.G&&Ye(x,"X-HTTP-Session-Id",this.G),no(this,x),ce&&(this.R?v="headers="+vn(Et(ce))+"&"+v:this.u&&Pt(x,this.u,ce)),nr(this.h,K),this.Ra&&Ye(x,"TYPE","init"),this.S?(Ye(x,"$req",v),Ye(x,"SID","null"),K.U=!0,Ns(K,x,null)):Ns(K,x,v),this.I=2}}else this.I==3&&(d?Gl(this,d):this.i.length==0||Ar(this.h)||Gl(this))};function Gl(d,v){var x;v?x=v.l:x=d.V++;const C=Me(d.J);Ye(C,"SID",d.M),Ye(C,"RID",x),Ye(C,"AID",d.K),no(d,C),d.u&&d.o&&Pt(C,d.u,d.o),x=new is(d,d.j,x,d.D+1),d.u===null&&(x.J=d.o),v&&(d.i=v.G.concat(d.i)),v=Du(d,x,1e3),x.H=Math.round(d.va*.5)+Math.round(d.va*.5*Math.random()),nr(d.h,x),Ns(x,C,v)}function no(d,v){d.H&&Be(d.H,function(x,C){Ye(v,C,x)}),d.l&&Be({},function(x,C){Ye(v,C,x)})}function Du(d,v,x){x=Math.min(d.i.length,x);const C=d.l?y(d.l.Ka,d.l,d):null;e:{var K=d.i;let It=-1;for(;;){const ls=["count="+x];It==-1?x>0?(It=K[0].g,ls.push("ofs="+It)):It=0:ls.push("ofs="+It);let un=!0;for(let $n=0;$n<x;$n++){var ce=K[$n].g;const Mr=K[$n].map;if(ce-=It,ce<0)It=Math.max(0,K[$n].g-100),un=!1;else try{ce="req"+ce+"_"||"";try{var De=Mr instanceof Map?Mr:Object.entries(Mr);for(const[ui,Kr]of De){let Yr=Kr;p(Kr)&&(Yr=Xt(Kr)),ls.push(ce+ui+"="+encodeURIComponent(Yr))}}catch(ui){throw ls.push(ce+"type="+encodeURIComponent("_badmap")),ui}}catch{C&&C(Mr)}}if(un){De=ls.join("&");break e}}De=void 0}return d=d.i.splice(0,x),v.G=d,De}function Mu(d){if(!d.g&&!d.v){d.Y=1;var v=d.Da;Te||S(),ve||(Te(),ve=!0),A.add(v,d),d.A=0}}function so(d){return d.g||d.v||d.A>=3?!1:(d.Y++,d.v=Cn(y(d.Da,d),Pu(d,d.A)),d.A++,!0)}s.Da=function(){if(this.v=null,Lu(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var d=4*this.T;this.j.info("BP detection timer enabled: "+d),this.B=Cn(y(this.Wa,this),d)}},s.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Yt(10),sr(this),Lu(this))};function Kl(d){d.B!=null&&(h.clearTimeout(d.B),d.B=null)}function Lu(d){d.g=new is(d,d.j,"rpc",d.Y),d.u===null&&(d.g.J=d.o),d.g.P=0;var v=Me(d.na);Ye(v,"RID","rpc"),Ye(v,"SID",d.M),Ye(v,"AID",d.K),Ye(v,"CI",d.F?"0":"1"),!d.F&&d.ia&&Ye(v,"TO",d.ia),Ye(v,"TYPE","xmlhttp"),no(d,v),d.u&&d.o&&Pt(v,d.u,d.o),d.O&&(d.g.H=d.O);var x=d.g;d=d.ba,x.M=1,x.A=Kn(Me(v)),x.u=null,x.R=!0,jr(x,d)}s.Va=function(){this.C!=null&&(this.C=null,sr(this),so(this),Yt(19))};function qo(d){d.C!=null&&(h.clearTimeout(d.C),d.C=null)}function Ou(d,v){var x=null;if(d.g==v){qo(d),Kl(d),d.g=null;var C=2}else if(bn(d.h,v))x=v.G,oi(d.h,v),C=1;else return;if(d.I!=0){if(v.o)if(C==1){x=v.u?v.u.length:0,v=Date.now()-v.F;var K=d.D;C=on(),yt(C,new Fn(C,x)),Dr(d)}else Mu(d);else if(K=v.m,K==3||K==0&&v.X>0||!(C==1&&li(d,v)||C==2&&so(d)))switch(x&&x.length>0&&(v=d.h,v.i=v.i.concat(x)),K){case 1:ci(d,5);break;case 4:ci(d,10);break;case 3:ci(d,6);break;default:ci(d,2)}}}function Pu(d,v){let x=d.Qa+Math.floor(Math.random()*d.Za);return d.isActive()||(x*=2),x*v}function ci(d,v){if(d.j.info("Error code "+v),v==2){var x=y(d.bb,d),C=d.Ua;const K=!C;C=new le(C||"//www.google.com/images/cleardot.gif"),h.location&&h.location.protocol=="http"||Le(C,"https"),Kn(C),K?dt(C.toString(),x):P(C.toString(),x)}else Yt(2);d.I=0,d.l&&d.l.pa(v),Vu(d),Ai(d)}s.bb=function(d){d?(this.j.info("Successfully pinged google.com"),Yt(2)):(this.j.info("Failed to ping google.com"),Yt(1))};function Vu(d){if(d.I=0,d.ja=[],d.l){const v=R(d.h);(v.length!=0||d.i.length!=0)&&(H(d.ja,v),H(d.ja,d.i),d.h.i.length=0,O(d.i),d.i.length=0),d.l.oa()}}function Uu(d,v,x){var C=x instanceof le?Me(x):new le(x);if(C.g!="")v&&(C.g=v+"."+C.g),He(C,C.u);else{var K=h.location;C=K.protocol,v=v?v+"."+K.hostname:K.hostname,K=+K.port;const ce=new le(null);C&&Le(ce,C),v&&(ce.g=v),K&&He(ce,K),x&&(ce.h=x),C=ce}return x=d.G,v=d.wa,x&&v&&Ye(C,x,v),Ye(C,"VER",d.ka),no(d,C),C}function Bu(d,v,x){if(v&&!d.L)throw Error("Can't create secondary domain capable XhrIo object.");return v=d.Aa&&!d.ma?new Qe(new ye({ab:x})):new Qe(d.ma),v.Fa(d.L),v}s.isActive=function(){return!!this.l&&this.l.isActive(this)};function zu(){}s=zu.prototype,s.ra=function(){},s.qa=function(){},s.pa=function(){},s.oa=function(){},s.isActive=function(){return!0},s.Ka=function(){};function ca(){}ca.prototype.g=function(d,v){return new Qs(d,v)};function Qs(d,v){Rt.call(this),this.g=new fs(v),this.l=d,this.h=v&&v.messageUrlParams||null,d=v&&v.messageHeaders||null,v&&v.clientProtocolHeaderRequired&&(d?d["X-Client-Protocol"]="webchannel":d={"X-Client-Protocol":"webchannel"}),this.g.o=d,d=v&&v.initMessageHeaders||null,v&&v.messageContentType&&(d?d["X-WebChannel-Content-Type"]=v.messageContentType:d={"X-WebChannel-Content-Type":v.messageContentType}),v&&v.sa&&(d?d["X-WebChannel-Client-Profile"]=v.sa:d={"X-WebChannel-Client-Profile":v.sa}),this.g.U=d,(d=v&&v.Qb)&&!N(d)&&(this.g.u=d),this.A=v&&v.supportsCrossDomainXhr||!1,this.v=v&&v.sendRawJson||!1,(v=v&&v.httpSessionIdParam)&&!N(v)&&(this.g.G=v,d=this.h,d!==null&&v in d&&(d=this.h,v in d&&delete d[v])),this.j=new Ri(this)}E(Qs,Rt),Qs.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Qs.prototype.close=function(){Ys(this.g)},Qs.prototype.o=function(d){var v=this.g;if(typeof d=="string"){var x={};x.__data__=d,d=x}else this.v&&(x={},x.__data__=Xt(d),d=x);v.i.push(new zt(v.Ya++,d)),v.I==3&&Dr(v)},Qs.prototype.N=function(){this.g.l=null,delete this.j,Ys(this.g),delete this.g,Qs.Z.N.call(this)};function Fu(d){$e.call(this),d.__headers__&&(this.headers=d.__headers__,this.statusCode=d.__status__,delete d.__headers__,delete d.__status__);var v=d.__sm__;if(v){e:{for(const x in v){d=x;break e}d=void 0}(this.i=d)&&(d=this.i,v=v!==null&&d in v?v[d]:void 0),this.data=v}else this.data=d}E(Fu,$e);function qu(){st.call(this),this.status=1}E(qu,st);function Ri(d){this.g=d}E(Ri,zu),Ri.prototype.ra=function(){yt(this.g,"a")},Ri.prototype.qa=function(d){yt(this.g,new Fu(d))},Ri.prototype.pa=function(d){yt(this.g,new qu)},Ri.prototype.oa=function(){yt(this.g,"b")},ca.prototype.createWebChannel=ca.prototype.g,Qs.prototype.send=Qs.prototype.o,Qs.prototype.open=Qs.prototype.m,Qs.prototype.close=Qs.prototype.close,Pw=function(){return new ca},Ow=function(){return on()},Lw=Fe,tg={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},lt.NO_ERROR=0,lt.TIMEOUT=8,lt.HTTP_ERROR=6,fd=lt,yn.COMPLETE="complete",Mw=yn,bt.EventType=it,it.OPEN="a",it.CLOSE="b",it.ERROR="c",it.MESSAGE="d",Rt.prototype.listen=Rt.prototype.J,zc=bt,Qe.prototype.listenOnce=Qe.prototype.K,Qe.prototype.getLastError=Qe.prototype.Ha,Qe.prototype.getLastErrorCode=Qe.prototype.ya,Qe.prototype.getStatus=Qe.prototype.ca,Qe.prototype.getResponseJson=Qe.prototype.La,Qe.prototype.getResponseText=Qe.prototype.la,Qe.prototype.send=Qe.prototype.ea,Qe.prototype.setWithCredentials=Qe.prototype.Fa,Dw=Qe}).apply(typeof Yh<"u"?Yh:typeof self<"u"?self:typeof window<"u"?window:{});class Hs{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Hs.UNAUTHENTICATED=new Hs(null),Hs.GOOGLE_CREDENTIALS=new Hs("google-credentials-uid"),Hs.FIRST_PARTY=new Hs("first-party-uid"),Hs.MOCK_USER=new Hs("mock-user");let Fl="12.8.0";function GA(s){Fl=s}const Mo=new Ig("@firebase/firestore");function xl(){return Mo.logLevel}function We(s,...e){if(Mo.logLevel<=$t.DEBUG){const t=e.map($g);Mo.debug(`Firestore (${Fl}): ${s}`,...t)}}function ta(s,...e){if(Mo.logLevel<=$t.ERROR){const t=e.map($g);Mo.error(`Firestore (${Fl}): ${s}`,...t)}}function Il(s,...e){if(Mo.logLevel<=$t.WARN){const t=e.map($g);Mo.warn(`Firestore (${Fl}): ${s}`,...t)}}function $g(s){if(typeof s=="string")return s;try{return(function(t){return JSON.stringify(t)})(s)}catch{return s}}function wt(s,e,t){let i="Unexpected state";typeof e=="string"?i=e:t=e,Vw(s,i,t)}function Vw(s,e,t){let i=`FIRESTORE (${Fl}) INTERNAL ASSERTION FAILED: ${e} (ID: ${s.toString(16)})`;if(t!==void 0)try{i+=" CONTEXT: "+JSON.stringify(t)}catch{i+=" CONTEXT: "+t}throw ta(i),new Error(i)}function mn(s,e,t,i){let l="Unexpected state";typeof t=="string"?l=t:i=t,s||Vw(e,l,i)}function Nt(s,e){return s}const fe={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ve extends ji{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Xi{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class Uw{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class KA{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(Hs.UNAUTHENTICATED)))}shutdown(){}}class YA{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class QA{constructor(e){this.t=e,this.currentUser=Hs.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){mn(this.o===void 0,42304);let i=this.i;const l=g=>this.i!==i?(i=this.i,t(g)):Promise.resolve();let u=new Xi;this.o=()=>{this.i++,this.currentUser=this.u(),u.resolve(),u=new Xi,e.enqueueRetryable((()=>l(this.currentUser)))};const h=()=>{const g=u;e.enqueueRetryable((async()=>{await g.promise,await l(this.currentUser)}))},p=g=>{We("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=g,this.o&&(this.auth.addAuthTokenListener(this.o),h())};this.t.onInit((g=>p(g))),setTimeout((()=>{if(!this.auth){const g=this.t.getImmediate({optional:!0});g?p(g):(We("FirebaseAuthCredentialsProvider","Auth not yet detected"),u.resolve(),u=new Xi)}}),0),h()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((i=>this.i!==e?(We("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(mn(typeof i.accessToken=="string",31837,{l:i}),new Uw(i.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return mn(e===null||typeof e=="string",2055,{h:e}),new Hs(e)}}class XA{constructor(e,t,i){this.P=e,this.T=t,this.I=i,this.type="FirstParty",this.user=Hs.FIRST_PARTY,this.R=new Map}A(){return this.I?this.I():null}get headers(){this.R.set("X-Goog-AuthUser",this.P);const e=this.A();return e&&this.R.set("Authorization",e),this.T&&this.R.set("X-Goog-Iam-Authorization-Token",this.T),this.R}}class JA{constructor(e,t,i){this.P=e,this.T=t,this.I=i}getToken(){return Promise.resolve(new XA(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(Hs.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class n2{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class ZA{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,xr(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){mn(this.o===void 0,3512);const i=u=>{u.error!=null&&We("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${u.error.message}`);const h=u.token!==this.m;return this.m=u.token,We("FirebaseAppCheckTokenProvider",`Received ${h?"new":"existing"} token.`),h?t(u.token):Promise.resolve()};this.o=u=>{e.enqueueRetryable((()=>i(u)))};const l=u=>{We("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=u,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((u=>l(u))),setTimeout((()=>{if(!this.appCheck){const u=this.V.getImmediate({optional:!0});u?l(u):We("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new n2(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(mn(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new n2(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function eR(s){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(s);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let i=0;i<s;i++)t[i]=Math.floor(256*Math.random());return t}class Wg{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const l=eR(40);for(let u=0;u<l.length;++u)i.length<20&&l[u]<t&&(i+=e.charAt(l[u]%62))}return i}}function Wt(s,e){return s<e?-1:s>e?1:0}function ng(s,e){const t=Math.min(s.length,e.length);for(let i=0;i<t;i++){const l=s.charAt(i),u=e.charAt(i);if(l!==u)return Ep(l)===Ep(u)?Wt(l,u):Ep(l)?1:-1}return Wt(s.length,e.length)}const tR=55296,nR=57343;function Ep(s){const e=s.charCodeAt(0);return e>=tR&&e<=nR}function Dl(s,e,t){return s.length===e.length&&s.every(((i,l)=>t(i,e[l])))}const s2="__name__";class gi{constructor(e,t,i){t===void 0?t=0:t>e.length&&wt(637,{offset:t,range:e.length}),i===void 0?i=e.length-t:i>e.length-t&&wt(1746,{length:i,range:e.length-t}),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return gi.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof gi?e.forEach((i=>{t.push(i)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const i=Math.min(e.length,t.length);for(let l=0;l<i;l++){const u=gi.compareSegments(e.get(l),t.get(l));if(u!==0)return u}return Wt(e.length,t.length)}static compareSegments(e,t){const i=gi.isNumericId(e),l=gi.isNumericId(t);return i&&!l?-1:!i&&l?1:i&&l?gi.extractNumericId(e).compare(gi.extractNumericId(t)):ng(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return qa.fromString(e.substring(4,e.length-2))}}class Dn extends gi{construct(e,t,i){return new Dn(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const i of e){if(i.indexOf("//")>=0)throw new Ve(fe.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter((l=>l.length>0)))}return new Dn(t)}static emptyPath(){return new Dn([])}}const sR=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Ls extends gi{construct(e,t,i){return new Ls(e,t,i)}static isValidIdentifier(e){return sR.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Ls.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===s2}static keyField(){return new Ls([s2])}static fromServerFormat(e){const t=[];let i="",l=0;const u=()=>{if(i.length===0)throw new Ve(fe.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""};let h=!1;for(;l<e.length;){const p=e[l];if(p==="\\"){if(l+1===e.length)throw new Ve(fe.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const g=e[l+1];if(g!=="\\"&&g!=="."&&g!=="`")throw new Ve(fe.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=g,l+=2}else p==="`"?(h=!h,l++):p!=="."||h?(i+=p,l++):(u(),l++)}if(u(),h)throw new Ve(fe.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Ls(t)}static emptyPath(){return new Ls([])}}class ot{constructor(e){this.path=e}static fromPath(e){return new ot(Dn.fromString(e))}static fromName(e){return new ot(Dn.fromString(e).popFirst(5))}static empty(){return new ot(Dn.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Dn.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Dn.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ot(new Dn(e.slice()))}}function Bw(s,e,t){if(!t)throw new Ve(fe.INVALID_ARGUMENT,`Function ${s}() cannot be called with an empty ${e}.`)}function rR(s,e,t,i){if(e===!0&&i===!0)throw new Ve(fe.INVALID_ARGUMENT,`${s} and ${t} cannot be used together.`)}function r2(s){if(!ot.isDocumentKey(s))throw new Ve(fe.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${s} has ${s.length}.`)}function i2(s){if(ot.isDocumentKey(s))throw new Ve(fe.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${s} has ${s.length}.`)}function zw(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}function Kd(s){if(s===void 0)return"undefined";if(s===null)return"null";if(typeof s=="string")return s.length>20&&(s=`${s.substring(0,20)}...`),JSON.stringify(s);if(typeof s=="number"||typeof s=="boolean")return""+s;if(typeof s=="object"){if(s instanceof Array)return"an array";{const e=(function(i){return i.constructor?i.constructor.name:null})(s);return e?`a custom ${e} object`:"an object"}}return typeof s=="function"?"a function":wt(12329,{type:typeof s})}function er(s,e){if("_delegate"in s&&(s=s._delegate),!(s instanceof e)){if(e.name===s.constructor.name)throw new Ve(fe.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=Kd(s);throw new Ve(fe.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return s}function iR(s,e){if(e<=0)throw new Ve(fe.INVALID_ARGUMENT,`Function ${s}() requires a positive number, but it was: ${e}.`)}function _s(s,e){const t={typeString:s};return e&&(t.value=e),t}function wu(s,e){if(!zw(s))throw new Ve(fe.INVALID_ARGUMENT,"JSON must be an object");let t;for(const i in e)if(e[i]){const l=e[i].typeString,u="value"in e[i]?{value:e[i].value}:void 0;if(!(i in s)){t=`JSON missing required field: '${i}'`;break}const h=s[i];if(l&&typeof h!==l){t=`JSON field '${i}' must be a ${l}.`;break}if(u!==void 0&&h!==u.value){t=`Expected '${i}' field to equal '${u.value}'`;break}}if(t)throw new Ve(fe.INVALID_ARGUMENT,t);return!0}const a2=-62135596800,o2=1e6;class Gt{static now(){return Gt.fromMillis(Date.now())}static fromDate(e){return Gt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),i=Math.floor((e-1e3*t)*o2);return new Gt(t,i)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Ve(fe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Ve(fe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<a2)throw new Ve(fe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Ve(fe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/o2}_compareTo(e){return this.seconds===e.seconds?Wt(this.nanoseconds,e.nanoseconds):Wt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Gt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(wu(e,Gt._jsonSchema))return new Gt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-a2;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Gt._jsonSchemaVersion="firestore/timestamp/1.0",Gt._jsonSchema={type:_s("string",Gt._jsonSchemaVersion),seconds:_s("number"),nanoseconds:_s("number")};class jt{static fromTimestamp(e){return new jt(e)}static min(){return new jt(new Gt(0,0))}static max(){return new jt(new Gt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const nu=-1;function aR(s,e){const t=s.toTimestamp().seconds,i=s.toTimestamp().nanoseconds+1,l=jt.fromTimestamp(i===1e9?new Gt(t+1,0):new Gt(t,i));return new Wa(l,ot.empty(),e)}function oR(s){return new Wa(s.readTime,s.key,nu)}class Wa{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new Wa(jt.min(),ot.empty(),nu)}static max(){return new Wa(jt.max(),ot.empty(),nu)}}function lR(s,e){let t=s.readTime.compareTo(e.readTime);return t!==0?t:(t=ot.comparator(s.documentKey,e.documentKey),t!==0?t:Wt(s.largestBatchId,e.largestBatchId))}const cR="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class uR{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function ql(s){if(s.code!==fe.FAILED_PRECONDITION||s.message!==cR)throw s;We("LocalStore","Unexpectedly lost primary lease")}class be{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&wt(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new be(((i,l)=>{this.nextCallback=u=>{this.wrapSuccess(e,u).next(i,l)},this.catchCallback=u=>{this.wrapFailure(t,u).next(i,l)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof be?t:be.resolve(t)}catch(t){return be.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):be.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):be.reject(t)}static resolve(e){return new be(((t,i)=>{t(e)}))}static reject(e){return new be(((t,i)=>{i(e)}))}static waitFor(e){return new be(((t,i)=>{let l=0,u=0,h=!1;e.forEach((p=>{++l,p.next((()=>{++u,h&&u===l&&t()}),(g=>i(g)))})),h=!0,u===l&&t()}))}static or(e){let t=be.resolve(!1);for(const i of e)t=t.next((l=>l?be.resolve(l):i()));return t}static forEach(e,t){const i=[];return e.forEach(((l,u)=>{i.push(t.call(this,l,u))})),this.waitFor(i)}static mapArray(e,t){return new be(((i,l)=>{const u=e.length,h=new Array(u);let p=0;for(let g=0;g<u;g++){const y=g;t(e[y]).next((b=>{h[y]=b,++p,p===u&&i(h)}),(b=>l(b)))}}))}static doWhile(e,t){return new be(((i,l)=>{const u=()=>{e()===!0?t().next((()=>{u()}),l):i()};u()}))}}function hR(s){const e=s.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function Hl(s){return s.name==="IndexedDbTransactionError"}class Yd{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=i=>this.ae(i),this.ue=i=>t.writeSequenceNumber(i))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Yd.ce=-1;const Gg=-1;function Qd(s){return s==null}function Ad(s){return s===0&&1/s==-1/0}function dR(s){return typeof s=="number"&&Number.isInteger(s)&&!Ad(s)&&s<=Number.MAX_SAFE_INTEGER&&s>=Number.MIN_SAFE_INTEGER}const Fw="";function fR(s){let e="";for(let t=0;t<s.length;t++)e.length>0&&(e=l2(e)),e=mR(s.get(t),e);return l2(e)}function mR(s,e){let t=e;const i=s.length;for(let l=0;l<i;l++){const u=s.charAt(l);switch(u){case"\0":t+="";break;case Fw:t+="";break;default:t+=u}}return t}function l2(s){return s+Fw+""}function c2(s){let e=0;for(const t in s)Object.prototype.hasOwnProperty.call(s,t)&&e++;return e}function eo(s,e){for(const t in s)Object.prototype.hasOwnProperty.call(s,t)&&e(t,s[t])}function qw(s){for(const e in s)if(Object.prototype.hasOwnProperty.call(s,e))return!1;return!0}class Qn{constructor(e,t){this.comparator=e,this.root=t||Ms.EMPTY}insert(e,t){return new Qn(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Ms.BLACK,null,null))}remove(e){return new Qn(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Ms.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const i=this.comparator(e,t.key);if(i===0)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){const l=this.comparator(e,i.key);if(l===0)return t+i.left.size;l<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,i)=>(e(t,i),!1)))}toString(){const e=[];return this.inorderTraversal(((t,i)=>(e.push(`${t}:${i}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Qh(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Qh(this.root,e,this.comparator,!1)}getReverseIterator(){return new Qh(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Qh(this.root,e,this.comparator,!0)}}class Qh{constructor(e,t,i,l){this.isReverse=l,this.nodeStack=[];let u=1;for(;!e.isEmpty();)if(u=t?i(e.key,t):1,t&&l&&(u*=-1),u<0)e=this.isReverse?e.left:e.right;else{if(u===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Ms{constructor(e,t,i,l,u){this.key=e,this.value=t,this.color=i??Ms.RED,this.left=l??Ms.EMPTY,this.right=u??Ms.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,l,u){return new Ms(e??this.key,t??this.value,i??this.color,l??this.left,u??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let l=this;const u=i(e,l.key);return l=u<0?l.copy(null,null,null,l.left.insert(e,t,i),null):u===0?l.copy(null,t,null,null,null):l.copy(null,null,null,null,l.right.insert(e,t,i)),l.fixUp()}removeMin(){if(this.left.isEmpty())return Ms.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,l=this;if(t(e,l.key)<0)l.left.isEmpty()||l.left.isRed()||l.left.left.isRed()||(l=l.moveRedLeft()),l=l.copy(null,null,null,l.left.remove(e,t),null);else{if(l.left.isRed()&&(l=l.rotateRight()),l.right.isEmpty()||l.right.isRed()||l.right.left.isRed()||(l=l.moveRedRight()),t(e,l.key)===0){if(l.right.isEmpty())return Ms.EMPTY;i=l.right.min(),l=l.copy(i.key,i.value,null,null,l.right.removeMin())}l=l.copy(null,null,null,null,l.right.remove(e,t))}return l.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Ms.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Ms.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw wt(43730,{key:this.key,value:this.value});if(this.right.isRed())throw wt(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw wt(27949);return e+(this.isRed()?0:1)}}Ms.EMPTY=null,Ms.RED=!0,Ms.BLACK=!1;Ms.EMPTY=new class{constructor(){this.size=0}get key(){throw wt(57766)}get value(){throw wt(16141)}get color(){throw wt(16727)}get left(){throw wt(29726)}get right(){throw wt(36894)}copy(e,t,i,l,u){return this}insert(e,t,i){return new Ms(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Ts{constructor(e){this.comparator=e,this.data=new Qn(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,i)=>(e(t),!1)))}forEachInRange(e,t){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const l=i.getNext();if(this.comparator(l.key,e[1])>=0)return;t(l.key)}}forEachWhile(e,t){let i;for(i=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new u2(this.data.getIterator())}getIteratorFrom(e){return new u2(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((i=>{t=t.add(i)})),t}isEqual(e){if(!(e instanceof Ts)||this.size!==e.size)return!1;const t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){const l=t.getNext().key,u=i.getNext().key;if(this.comparator(l,u)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new Ts(this.comparator);return t.data=e,t}}class u2{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class Tr{constructor(e){this.fields=e,e.sort(Ls.comparator)}static empty(){return new Tr([])}unionWith(e){let t=new Ts(Ls.comparator);for(const i of this.fields)t=t.add(i);for(const i of e)t=t.add(i);return new Tr(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Dl(this.fields,e.fields,((t,i)=>t.isEqual(i)))}}class Hw extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Ps{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(l){try{return atob(l)}catch(u){throw typeof DOMException<"u"&&u instanceof DOMException?new Hw("Invalid base64 string: "+u):u}})(e);return new Ps(t)}static fromUint8Array(e){const t=(function(l){let u="";for(let h=0;h<l.length;++h)u+=String.fromCharCode(l[h]);return u})(e);return new Ps(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const i=new Uint8Array(t.length);for(let l=0;l<t.length;l++)i[l]=t.charCodeAt(l);return i})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Wt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Ps.EMPTY_BYTE_STRING=new Ps("");const pR=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ga(s){if(mn(!!s,39018),typeof s=="string"){let e=0;const t=pR.exec(s);if(mn(!!t,46558,{timestamp:s}),t[1]){let l=t[1];l=(l+"000000000").substr(0,9),e=Number(l)}const i=new Date(s);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:hs(s.seconds),nanos:hs(s.nanos)}}function hs(s){return typeof s=="number"?s:typeof s=="string"?Number(s):0}function Ka(s){return typeof s=="string"?Ps.fromBase64String(s):Ps.fromUint8Array(s)}const $w="server_timestamp",Ww="__type__",Gw="__previous_value__",Kw="__local_write_time__";function Kg(s){return(s?.mapValue?.fields||{})[Ww]?.stringValue===$w}function Xd(s){const e=s.mapValue.fields[Gw];return Kg(e)?Xd(e):e}function su(s){const e=Ga(s.mapValue.fields[Kw].timestampValue);return new Gt(e.seconds,e.nanos)}class gR{constructor(e,t,i,l,u,h,p,g,y,b,E){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=l,this.ssl=u,this.forceLongPolling=h,this.autoDetectLongPolling=p,this.longPollingOptions=g,this.useFetchStreams=y,this.isUsingEmulator=b,this.apiKey=E}}const Rd="(default)";class ru{constructor(e,t){this.projectId=e,this.database=t||Rd}static empty(){return new ru("","")}get isDefaultDatabase(){return this.database===Rd}isEqual(e){return e instanceof ru&&e.projectId===this.projectId&&e.database===this.database}}function yR(s,e){if(!Object.prototype.hasOwnProperty.apply(s.options,["projectId"]))throw new Ve(fe.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ru(s.options.projectId,e)}const Yw="__type__",vR="__max__",Xh={mapValue:{}},Qw="__vector__",Id="value";function Ya(s){return"nullValue"in s?0:"booleanValue"in s?1:"integerValue"in s||"doubleValue"in s?2:"timestampValue"in s?3:"stringValue"in s?5:"bytesValue"in s?6:"referenceValue"in s?7:"geoPointValue"in s?8:"arrayValue"in s?9:"mapValue"in s?Kg(s)?4:_R(s)?9007199254740991:bR(s)?10:11:wt(28295,{value:s})}function Ti(s,e){if(s===e)return!0;const t=Ya(s);if(t!==Ya(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return s.booleanValue===e.booleanValue;case 4:return su(s).isEqual(su(e));case 3:return(function(l,u){if(typeof l.timestampValue=="string"&&typeof u.timestampValue=="string"&&l.timestampValue.length===u.timestampValue.length)return l.timestampValue===u.timestampValue;const h=Ga(l.timestampValue),p=Ga(u.timestampValue);return h.seconds===p.seconds&&h.nanos===p.nanos})(s,e);case 5:return s.stringValue===e.stringValue;case 6:return(function(l,u){return Ka(l.bytesValue).isEqual(Ka(u.bytesValue))})(s,e);case 7:return s.referenceValue===e.referenceValue;case 8:return(function(l,u){return hs(l.geoPointValue.latitude)===hs(u.geoPointValue.latitude)&&hs(l.geoPointValue.longitude)===hs(u.geoPointValue.longitude)})(s,e);case 2:return(function(l,u){if("integerValue"in l&&"integerValue"in u)return hs(l.integerValue)===hs(u.integerValue);if("doubleValue"in l&&"doubleValue"in u){const h=hs(l.doubleValue),p=hs(u.doubleValue);return h===p?Ad(h)===Ad(p):isNaN(h)&&isNaN(p)}return!1})(s,e);case 9:return Dl(s.arrayValue.values||[],e.arrayValue.values||[],Ti);case 10:case 11:return(function(l,u){const h=l.mapValue.fields||{},p=u.mapValue.fields||{};if(c2(h)!==c2(p))return!1;for(const g in h)if(h.hasOwnProperty(g)&&(p[g]===void 0||!Ti(h[g],p[g])))return!1;return!0})(s,e);default:return wt(52216,{left:s})}}function iu(s,e){return(s.values||[]).find((t=>Ti(t,e)))!==void 0}function Ml(s,e){if(s===e)return 0;const t=Ya(s),i=Ya(e);if(t!==i)return Wt(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return Wt(s.booleanValue,e.booleanValue);case 2:return(function(u,h){const p=hs(u.integerValue||u.doubleValue),g=hs(h.integerValue||h.doubleValue);return p<g?-1:p>g?1:p===g?0:isNaN(p)?isNaN(g)?0:-1:1})(s,e);case 3:return h2(s.timestampValue,e.timestampValue);case 4:return h2(su(s),su(e));case 5:return ng(s.stringValue,e.stringValue);case 6:return(function(u,h){const p=Ka(u),g=Ka(h);return p.compareTo(g)})(s.bytesValue,e.bytesValue);case 7:return(function(u,h){const p=u.split("/"),g=h.split("/");for(let y=0;y<p.length&&y<g.length;y++){const b=Wt(p[y],g[y]);if(b!==0)return b}return Wt(p.length,g.length)})(s.referenceValue,e.referenceValue);case 8:return(function(u,h){const p=Wt(hs(u.latitude),hs(h.latitude));return p!==0?p:Wt(hs(u.longitude),hs(h.longitude))})(s.geoPointValue,e.geoPointValue);case 9:return d2(s.arrayValue,e.arrayValue);case 10:return(function(u,h){const p=u.fields||{},g=h.fields||{},y=p[Id]?.arrayValue,b=g[Id]?.arrayValue,E=Wt(y?.values?.length||0,b?.values?.length||0);return E!==0?E:d2(y,b)})(s.mapValue,e.mapValue);case 11:return(function(u,h){if(u===Xh.mapValue&&h===Xh.mapValue)return 0;if(u===Xh.mapValue)return 1;if(h===Xh.mapValue)return-1;const p=u.fields||{},g=Object.keys(p),y=h.fields||{},b=Object.keys(y);g.sort(),b.sort();for(let E=0;E<g.length&&E<b.length;++E){const T=ng(g[E],b[E]);if(T!==0)return T;const O=Ml(p[g[E]],y[b[E]]);if(O!==0)return O}return Wt(g.length,b.length)})(s.mapValue,e.mapValue);default:throw wt(23264,{he:t})}}function h2(s,e){if(typeof s=="string"&&typeof e=="string"&&s.length===e.length)return Wt(s,e);const t=Ga(s),i=Ga(e),l=Wt(t.seconds,i.seconds);return l!==0?l:Wt(t.nanos,i.nanos)}function d2(s,e){const t=s.values||[],i=e.values||[];for(let l=0;l<t.length&&l<i.length;++l){const u=Ml(t[l],i[l]);if(u)return u}return Wt(t.length,i.length)}function Ll(s){return sg(s)}function sg(s){return"nullValue"in s?"null":"booleanValue"in s?""+s.booleanValue:"integerValue"in s?""+s.integerValue:"doubleValue"in s?""+s.doubleValue:"timestampValue"in s?(function(t){const i=Ga(t);return`time(${i.seconds},${i.nanos})`})(s.timestampValue):"stringValue"in s?s.stringValue:"bytesValue"in s?(function(t){return Ka(t).toBase64()})(s.bytesValue):"referenceValue"in s?(function(t){return ot.fromName(t).toString()})(s.referenceValue):"geoPointValue"in s?(function(t){return`geo(${t.latitude},${t.longitude})`})(s.geoPointValue):"arrayValue"in s?(function(t){let i="[",l=!0;for(const u of t.values||[])l?l=!1:i+=",",i+=sg(u);return i+"]"})(s.arrayValue):"mapValue"in s?(function(t){const i=Object.keys(t.fields||{}).sort();let l="{",u=!0;for(const h of i)u?u=!1:l+=",",l+=`${h}:${sg(t.fields[h])}`;return l+"}"})(s.mapValue):wt(61005,{value:s})}function md(s){switch(Ya(s)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Xd(s);return e?16+md(e):16;case 5:return 2*s.stringValue.length;case 6:return Ka(s.bytesValue).approximateByteSize();case 7:return s.referenceValue.length;case 9:return(function(i){return(i.values||[]).reduce(((l,u)=>l+md(u)),0)})(s.arrayValue);case 10:case 11:return(function(i){let l=0;return eo(i.fields,((u,h)=>{l+=u.length+md(h)})),l})(s.mapValue);default:throw wt(13486,{value:s})}}function f2(s,e){return{referenceValue:`projects/${s.projectId}/databases/${s.database}/documents/${e.path.canonicalString()}`}}function rg(s){return!!s&&"integerValue"in s}function Yg(s){return!!s&&"arrayValue"in s}function m2(s){return!!s&&"nullValue"in s}function p2(s){return!!s&&"doubleValue"in s&&isNaN(Number(s.doubleValue))}function pd(s){return!!s&&"mapValue"in s}function bR(s){return(s?.mapValue?.fields||{})[Yw]?.stringValue===Qw}function Gc(s){if(s.geoPointValue)return{geoPointValue:{...s.geoPointValue}};if(s.timestampValue&&typeof s.timestampValue=="object")return{timestampValue:{...s.timestampValue}};if(s.mapValue){const e={mapValue:{fields:{}}};return eo(s.mapValue.fields,((t,i)=>e.mapValue.fields[t]=Gc(i))),e}if(s.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(s.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Gc(s.arrayValue.values[t]);return e}return{...s}}function _R(s){return(((s.mapValue||{}).fields||{}).__type__||{}).stringValue===vR}class ur{constructor(e){this.value=e}static empty(){return new ur({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!pd(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Gc(t)}setAll(e){let t=Ls.emptyPath(),i={},l=[];e.forEach(((h,p)=>{if(!t.isImmediateParentOf(p)){const g=this.getFieldsMap(t);this.applyChanges(g,i,l),i={},l=[],t=p.popLast()}h?i[p.lastSegment()]=Gc(h):l.push(p.lastSegment())}));const u=this.getFieldsMap(t);this.applyChanges(u,i,l)}delete(e){const t=this.field(e.popLast());pd(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Ti(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let l=t.mapValue.fields[e.get(i)];pd(l)&&l.mapValue.fields||(l={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=l),t=l}return t.mapValue.fields}applyChanges(e,t,i){eo(t,((l,u)=>e[l]=u));for(const l of i)delete e[l]}clone(){return new ur(Gc(this.value))}}function Xw(s){const e=[];return eo(s.fields,((t,i)=>{const l=new Ls([t]);if(pd(i)){const u=Xw(i.mapValue).fields;if(u.length===0)e.push(l);else for(const h of u)e.push(l.child(h))}else e.push(l)})),new Tr(e)}class $s{constructor(e,t,i,l,u,h,p){this.key=e,this.documentType=t,this.version=i,this.readTime=l,this.createTime=u,this.data=h,this.documentState=p}static newInvalidDocument(e){return new $s(e,0,jt.min(),jt.min(),jt.min(),ur.empty(),0)}static newFoundDocument(e,t,i,l){return new $s(e,1,t,jt.min(),i,l,0)}static newNoDocument(e,t){return new $s(e,2,t,jt.min(),jt.min(),ur.empty(),0)}static newUnknownDocument(e,t){return new $s(e,3,t,jt.min(),jt.min(),ur.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(jt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=ur.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=ur.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=jt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof $s&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new $s(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Dd{constructor(e,t){this.position=e,this.inclusive=t}}function g2(s,e,t){let i=0;for(let l=0;l<s.position.length;l++){const u=e[l],h=s.position[l];if(u.field.isKeyField()?i=ot.comparator(ot.fromName(h.referenceValue),t.key):i=Ml(h,t.data.field(u.field)),u.dir==="desc"&&(i*=-1),i!==0)break}return i}function y2(s,e){if(s===null)return e===null;if(e===null||s.inclusive!==e.inclusive||s.position.length!==e.position.length)return!1;for(let t=0;t<s.position.length;t++)if(!Ti(s.position[t],e.position[t]))return!1;return!0}class au{constructor(e,t="asc"){this.field=e,this.dir=t}}function wR(s,e){return s.dir===e.dir&&s.field.isEqual(e.field)}class Jw{}class bs extends Jw{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,i):new ER(e,t,i):t==="array-contains"?new SR(e,i):t==="in"?new jR(e,i):t==="not-in"?new CR(e,i):t==="array-contains-any"?new NR(e,i):new bs(e,t,i)}static createKeyFieldInFilter(e,t,i){return t==="in"?new TR(e,i):new kR(e,i)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Ml(t,this.value)):t!==null&&Ya(this.value)===Ya(t)&&this.matchesComparison(Ml(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return wt(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class ri extends Jw{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new ri(e,t)}matches(e){return Zw(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function Zw(s){return s.op==="and"}function ex(s){return xR(s)&&Zw(s)}function xR(s){for(const e of s.filters)if(e instanceof ri)return!1;return!0}function ig(s){if(s instanceof bs)return s.field.canonicalString()+s.op.toString()+Ll(s.value);if(ex(s))return s.filters.map((e=>ig(e))).join(",");{const e=s.filters.map((t=>ig(t))).join(",");return`${s.op}(${e})`}}function tx(s,e){return s instanceof bs?(function(i,l){return l instanceof bs&&i.op===l.op&&i.field.isEqual(l.field)&&Ti(i.value,l.value)})(s,e):s instanceof ri?(function(i,l){return l instanceof ri&&i.op===l.op&&i.filters.length===l.filters.length?i.filters.reduce(((u,h,p)=>u&&tx(h,l.filters[p])),!0):!1})(s,e):void wt(19439)}function nx(s){return s instanceof bs?(function(t){return`${t.field.canonicalString()} ${t.op} ${Ll(t.value)}`})(s):s instanceof ri?(function(t){return t.op.toString()+" {"+t.getFilters().map(nx).join(" ,")+"}"})(s):"Filter"}class ER extends bs{constructor(e,t,i){super(e,t,i),this.key=ot.fromName(i.referenceValue)}matches(e){const t=ot.comparator(e.key,this.key);return this.matchesComparison(t)}}class TR extends bs{constructor(e,t){super(e,"in",t),this.keys=sx("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class kR extends bs{constructor(e,t){super(e,"not-in",t),this.keys=sx("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function sx(s,e){return(e.arrayValue?.values||[]).map((t=>ot.fromName(t.referenceValue)))}class SR extends bs{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Yg(t)&&iu(t.arrayValue,this.value)}}class jR extends bs{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&iu(this.value.arrayValue,t)}}class CR extends bs{constructor(e,t){super(e,"not-in",t)}matches(e){if(iu(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!iu(this.value.arrayValue,t)}}class NR extends bs{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Yg(t)||!t.arrayValue.values)&&t.arrayValue.values.some((i=>iu(this.value.arrayValue,i)))}}class AR{constructor(e,t=null,i=[],l=[],u=null,h=null,p=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=l,this.limit=u,this.startAt=h,this.endAt=p,this.Te=null}}function v2(s,e=null,t=[],i=[],l=null,u=null,h=null){return new AR(s,e,t,i,l,u,h)}function Qg(s){const e=Nt(s);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((i=>ig(i))).join(","),t+="|ob:",t+=e.orderBy.map((i=>(function(u){return u.field.canonicalString()+u.dir})(i))).join(","),Qd(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((i=>Ll(i))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((i=>Ll(i))).join(",")),e.Te=t}return e.Te}function Xg(s,e){if(s.limit!==e.limit||s.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<s.orderBy.length;t++)if(!wR(s.orderBy[t],e.orderBy[t]))return!1;if(s.filters.length!==e.filters.length)return!1;for(let t=0;t<s.filters.length;t++)if(!tx(s.filters[t],e.filters[t]))return!1;return s.collectionGroup===e.collectionGroup&&!!s.path.isEqual(e.path)&&!!y2(s.startAt,e.startAt)&&y2(s.endAt,e.endAt)}function ag(s){return ot.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}class $l{constructor(e,t=null,i=[],l=[],u=null,h="F",p=null,g=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=l,this.limit=u,this.limitType=h,this.startAt=p,this.endAt=g,this.Ie=null,this.Ee=null,this.Re=null,this.startAt,this.endAt}}function RR(s,e,t,i,l,u,h,p){return new $l(s,e,t,i,l,u,h,p)}function Jd(s){return new $l(s)}function b2(s){return s.filters.length===0&&s.limit===null&&s.startAt==null&&s.endAt==null&&(s.explicitOrderBy.length===0||s.explicitOrderBy.length===1&&s.explicitOrderBy[0].field.isKeyField())}function IR(s){return ot.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}function rx(s){return s.collectionGroup!==null}function Kc(s){const e=Nt(s);if(e.Ie===null){e.Ie=[];const t=new Set;for(const u of e.explicitOrderBy)e.Ie.push(u),t.add(u.field.canonicalString());const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(h){let p=new Ts(Ls.comparator);return h.filters.forEach((g=>{g.getFlattenedFilters().forEach((y=>{y.isInequality()&&(p=p.add(y.field))}))})),p})(e).forEach((u=>{t.has(u.canonicalString())||u.isKeyField()||e.Ie.push(new au(u,i))})),t.has(Ls.keyField().canonicalString())||e.Ie.push(new au(Ls.keyField(),i))}return e.Ie}function wi(s){const e=Nt(s);return e.Ee||(e.Ee=DR(e,Kc(s))),e.Ee}function DR(s,e){if(s.limitType==="F")return v2(s.path,s.collectionGroup,e,s.filters,s.limit,s.startAt,s.endAt);{e=e.map((l=>{const u=l.dir==="desc"?"asc":"desc";return new au(l.field,u)}));const t=s.endAt?new Dd(s.endAt.position,s.endAt.inclusive):null,i=s.startAt?new Dd(s.startAt.position,s.startAt.inclusive):null;return v2(s.path,s.collectionGroup,e,s.filters,s.limit,t,i)}}function og(s,e){const t=s.filters.concat([e]);return new $l(s.path,s.collectionGroup,s.explicitOrderBy.slice(),t,s.limit,s.limitType,s.startAt,s.endAt)}function MR(s,e){const t=s.explicitOrderBy.concat([e]);return new $l(s.path,s.collectionGroup,t,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}function Md(s,e,t){return new $l(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),e,t,s.startAt,s.endAt)}function Zd(s,e){return Xg(wi(s),wi(e))&&s.limitType===e.limitType}function ix(s){return`${Qg(wi(s))}|lt:${s.limitType}`}function El(s){return`Query(target=${(function(t){let i=t.path.canonicalString();return t.collectionGroup!==null&&(i+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(i+=`, filters: [${t.filters.map((l=>nx(l))).join(", ")}]`),Qd(t.limit)||(i+=", limit: "+t.limit),t.orderBy.length>0&&(i+=`, orderBy: [${t.orderBy.map((l=>(function(h){return`${h.field.canonicalString()} (${h.dir})`})(l))).join(", ")}]`),t.startAt&&(i+=", startAt: ",i+=t.startAt.inclusive?"b:":"a:",i+=t.startAt.position.map((l=>Ll(l))).join(",")),t.endAt&&(i+=", endAt: ",i+=t.endAt.inclusive?"a:":"b:",i+=t.endAt.position.map((l=>Ll(l))).join(",")),`Target(${i})`})(wi(s))}; limitType=${s.limitType})`}function ef(s,e){return e.isFoundDocument()&&(function(i,l){const u=l.key.path;return i.collectionGroup!==null?l.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(u):ot.isDocumentKey(i.path)?i.path.isEqual(u):i.path.isImmediateParentOf(u)})(s,e)&&(function(i,l){for(const u of Kc(i))if(!u.field.isKeyField()&&l.data.field(u.field)===null)return!1;return!0})(s,e)&&(function(i,l){for(const u of i.filters)if(!u.matches(l))return!1;return!0})(s,e)&&(function(i,l){return!(i.startAt&&!(function(h,p,g){const y=g2(h,p,g);return h.inclusive?y<=0:y<0})(i.startAt,Kc(i),l)||i.endAt&&!(function(h,p,g){const y=g2(h,p,g);return h.inclusive?y>=0:y>0})(i.endAt,Kc(i),l))})(s,e)}function LR(s){return s.collectionGroup||(s.path.length%2==1?s.path.lastSegment():s.path.get(s.path.length-2))}function ax(s){return(e,t)=>{let i=!1;for(const l of Kc(s)){const u=OR(l,e,t);if(u!==0)return u;i=i||l.field.isKeyField()}return 0}}function OR(s,e,t){const i=s.field.isKeyField()?ot.comparator(e.key,t.key):(function(u,h,p){const g=h.data.field(u),y=p.data.field(u);return g!==null&&y!==null?Ml(g,y):wt(42886)})(s.field,e,t);switch(s.dir){case"asc":return i;case"desc":return-1*i;default:return wt(19790,{direction:s.dir})}}class Uo{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i!==void 0){for(const[l,u]of i)if(this.equalsFn(l,e))return u}}has(e){return this.get(e)!==void 0}set(e,t){const i=this.mapKeyFn(e),l=this.inner[i];if(l===void 0)return this.inner[i]=[[e,t]],void this.innerSize++;for(let u=0;u<l.length;u++)if(this.equalsFn(l[u][0],e))return void(l[u]=[e,t]);l.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i===void 0)return!1;for(let l=0;l<i.length;l++)if(this.equalsFn(i[l][0],e))return i.length===1?delete this.inner[t]:i.splice(l,1),this.innerSize--,!0;return!1}forEach(e){eo(this.inner,((t,i)=>{for(const[l,u]of i)e(l,u)}))}isEmpty(){return qw(this.inner)}size(){return this.innerSize}}const PR=new Qn(ot.comparator);function na(){return PR}const ox=new Qn(ot.comparator);function Fc(...s){let e=ox;for(const t of s)e=e.insert(t.key,t);return e}function lx(s){let e=ox;return s.forEach(((t,i)=>e=e.insert(t,i.overlayedDocument))),e}function To(){return Yc()}function cx(){return Yc()}function Yc(){return new Uo((s=>s.toString()),((s,e)=>s.isEqual(e)))}const VR=new Qn(ot.comparator),UR=new Ts(ot.comparator);function Kt(...s){let e=UR;for(const t of s)e=e.add(t);return e}const BR=new Ts(Wt);function zR(){return BR}function Jg(s,e){if(s.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ad(e)?"-0":e}}function ux(s){return{integerValue:""+s}}function hx(s,e){return dR(e)?ux(e):Jg(s,e)}class tf{constructor(){this._=void 0}}function FR(s,e,t){return s instanceof ou?(function(l,u){const h={fields:{[Ww]:{stringValue:$w},[Kw]:{timestampValue:{seconds:l.seconds,nanos:l.nanoseconds}}}};return u&&Kg(u)&&(u=Xd(u)),u&&(h.fields[Gw]=u),{mapValue:h}})(t,e):s instanceof lu?fx(s,e):s instanceof cu?mx(s,e):(function(l,u){const h=dx(l,u),p=_2(h)+_2(l.Ae);return rg(h)&&rg(l.Ae)?ux(p):Jg(l.serializer,p)})(s,e)}function qR(s,e,t){return s instanceof lu?fx(s,e):s instanceof cu?mx(s,e):t}function dx(s,e){return s instanceof uu?(function(i){return rg(i)||(function(u){return!!u&&"doubleValue"in u})(i)})(e)?e:{integerValue:0}:null}class ou extends tf{}class lu extends tf{constructor(e){super(),this.elements=e}}function fx(s,e){const t=px(e);for(const i of s.elements)t.some((l=>Ti(l,i)))||t.push(i);return{arrayValue:{values:t}}}class cu extends tf{constructor(e){super(),this.elements=e}}function mx(s,e){let t=px(e);for(const i of s.elements)t=t.filter((l=>!Ti(l,i)));return{arrayValue:{values:t}}}class uu extends tf{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function _2(s){return hs(s.integerValue||s.doubleValue)}function px(s){return Yg(s)&&s.arrayValue.values?s.arrayValue.values.slice():[]}class gx{constructor(e,t){this.field=e,this.transform=t}}function HR(s,e){return s.field.isEqual(e.field)&&(function(i,l){return i instanceof lu&&l instanceof lu||i instanceof cu&&l instanceof cu?Dl(i.elements,l.elements,Ti):i instanceof uu&&l instanceof uu?Ti(i.Ae,l.Ae):i instanceof ou&&l instanceof ou})(s.transform,e.transform)}class $R{constructor(e,t){this.version=e,this.transformResults=t}}class tr{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new tr}static exists(e){return new tr(void 0,e)}static updateTime(e){return new tr(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function gd(s,e){return s.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(s.updateTime):s.exists===void 0||s.exists===e.isFoundDocument()}class nf{}function yx(s,e){if(!s.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return s.isNoDocument()?new sf(s.key,tr.none()):new xu(s.key,s.data,tr.none());{const t=s.data,i=ur.empty();let l=new Ts(Ls.comparator);for(let u of e.fields)if(!l.has(u)){let h=t.field(u);h===null&&u.length>1&&(u=u.popLast(),h=t.field(u)),h===null?i.delete(u):i.set(u,h),l=l.add(u)}return new to(s.key,i,new Tr(l.toArray()),tr.none())}}function WR(s,e,t){s instanceof xu?(function(l,u,h){const p=l.value.clone(),g=x2(l.fieldTransforms,u,h.transformResults);p.setAll(g),u.convertToFoundDocument(h.version,p).setHasCommittedMutations()})(s,e,t):s instanceof to?(function(l,u,h){if(!gd(l.precondition,u))return void u.convertToUnknownDocument(h.version);const p=x2(l.fieldTransforms,u,h.transformResults),g=u.data;g.setAll(vx(l)),g.setAll(p),u.convertToFoundDocument(h.version,g).setHasCommittedMutations()})(s,e,t):(function(l,u,h){u.convertToNoDocument(h.version).setHasCommittedMutations()})(0,e,t)}function Qc(s,e,t,i){return s instanceof xu?(function(u,h,p,g){if(!gd(u.precondition,h))return p;const y=u.value.clone(),b=E2(u.fieldTransforms,g,h);return y.setAll(b),h.convertToFoundDocument(h.version,y).setHasLocalMutations(),null})(s,e,t,i):s instanceof to?(function(u,h,p,g){if(!gd(u.precondition,h))return p;const y=E2(u.fieldTransforms,g,h),b=h.data;return b.setAll(vx(u)),b.setAll(y),h.convertToFoundDocument(h.version,b).setHasLocalMutations(),p===null?null:p.unionWith(u.fieldMask.fields).unionWith(u.fieldTransforms.map((E=>E.field)))})(s,e,t,i):(function(u,h,p){return gd(u.precondition,h)?(h.convertToNoDocument(h.version).setHasLocalMutations(),null):p})(s,e,t)}function GR(s,e){let t=null;for(const i of s.fieldTransforms){const l=e.data.field(i.field),u=dx(i.transform,l||null);u!=null&&(t===null&&(t=ur.empty()),t.set(i.field,u))}return t||null}function w2(s,e){return s.type===e.type&&!!s.key.isEqual(e.key)&&!!s.precondition.isEqual(e.precondition)&&!!(function(i,l){return i===void 0&&l===void 0||!(!i||!l)&&Dl(i,l,((u,h)=>HR(u,h)))})(s.fieldTransforms,e.fieldTransforms)&&(s.type===0?s.value.isEqual(e.value):s.type!==1||s.data.isEqual(e.data)&&s.fieldMask.isEqual(e.fieldMask))}class xu extends nf{constructor(e,t,i,l=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=l,this.type=0}getFieldMask(){return null}}class to extends nf{constructor(e,t,i,l,u=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=l,this.fieldTransforms=u,this.type=1}getFieldMask(){return this.fieldMask}}function vx(s){const e=new Map;return s.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const i=s.data.field(t);e.set(t,i)}})),e}function x2(s,e,t){const i=new Map;mn(s.length===t.length,32656,{Ve:t.length,de:s.length});for(let l=0;l<t.length;l++){const u=s[l],h=u.transform,p=e.data.field(u.field);i.set(u.field,qR(h,p,t[l]))}return i}function E2(s,e,t){const i=new Map;for(const l of s){const u=l.transform,h=t.data.field(l.field);i.set(l.field,FR(u,h,e))}return i}class sf extends nf{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class KR extends nf{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class YR{constructor(e,t,i,l){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=l}applyToRemoteDocument(e,t){const i=t.mutationResults;for(let l=0;l<this.mutations.length;l++){const u=this.mutations[l];u.key.isEqual(e.key)&&WR(u,e,i[l])}}applyToLocalView(e,t){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(t=Qc(i,e,t,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(t=Qc(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const i=cx();return this.mutations.forEach((l=>{const u=e.get(l.key),h=u.overlayedDocument;let p=this.applyToLocalView(h,u.mutatedFields);p=t.has(l.key)?null:p;const g=yx(h,p);g!==null&&i.set(l.key,g),h.isValidDocument()||h.convertToNoDocument(jt.min())})),i}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),Kt())}isEqual(e){return this.batchId===e.batchId&&Dl(this.mutations,e.mutations,((t,i)=>w2(t,i)))&&Dl(this.baseMutations,e.baseMutations,((t,i)=>w2(t,i)))}}class Zg{constructor(e,t,i,l){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=l}static from(e,t,i){mn(e.mutations.length===i.length,58842,{me:e.mutations.length,fe:i.length});let l=(function(){return VR})();const u=e.mutations;for(let h=0;h<u.length;h++)l=l.insert(u[h].key,i[h].version);return new Zg(e,t,i,l)}}class QR{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class XR{constructor(e,t){this.count=e,this.unchangedNames=t}}var vs,en;function JR(s){switch(s){case fe.OK:return wt(64938);case fe.CANCELLED:case fe.UNKNOWN:case fe.DEADLINE_EXCEEDED:case fe.RESOURCE_EXHAUSTED:case fe.INTERNAL:case fe.UNAVAILABLE:case fe.UNAUTHENTICATED:return!1;case fe.INVALID_ARGUMENT:case fe.NOT_FOUND:case fe.ALREADY_EXISTS:case fe.PERMISSION_DENIED:case fe.FAILED_PRECONDITION:case fe.ABORTED:case fe.OUT_OF_RANGE:case fe.UNIMPLEMENTED:case fe.DATA_LOSS:return!0;default:return wt(15467,{code:s})}}function bx(s){if(s===void 0)return ta("GRPC error has no .code"),fe.UNKNOWN;switch(s){case vs.OK:return fe.OK;case vs.CANCELLED:return fe.CANCELLED;case vs.UNKNOWN:return fe.UNKNOWN;case vs.DEADLINE_EXCEEDED:return fe.DEADLINE_EXCEEDED;case vs.RESOURCE_EXHAUSTED:return fe.RESOURCE_EXHAUSTED;case vs.INTERNAL:return fe.INTERNAL;case vs.UNAVAILABLE:return fe.UNAVAILABLE;case vs.UNAUTHENTICATED:return fe.UNAUTHENTICATED;case vs.INVALID_ARGUMENT:return fe.INVALID_ARGUMENT;case vs.NOT_FOUND:return fe.NOT_FOUND;case vs.ALREADY_EXISTS:return fe.ALREADY_EXISTS;case vs.PERMISSION_DENIED:return fe.PERMISSION_DENIED;case vs.FAILED_PRECONDITION:return fe.FAILED_PRECONDITION;case vs.ABORTED:return fe.ABORTED;case vs.OUT_OF_RANGE:return fe.OUT_OF_RANGE;case vs.UNIMPLEMENTED:return fe.UNIMPLEMENTED;case vs.DATA_LOSS:return fe.DATA_LOSS;default:return wt(39323,{code:s})}}(en=vs||(vs={}))[en.OK=0]="OK",en[en.CANCELLED=1]="CANCELLED",en[en.UNKNOWN=2]="UNKNOWN",en[en.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",en[en.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",en[en.NOT_FOUND=5]="NOT_FOUND",en[en.ALREADY_EXISTS=6]="ALREADY_EXISTS",en[en.PERMISSION_DENIED=7]="PERMISSION_DENIED",en[en.UNAUTHENTICATED=16]="UNAUTHENTICATED",en[en.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",en[en.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",en[en.ABORTED=10]="ABORTED",en[en.OUT_OF_RANGE=11]="OUT_OF_RANGE",en[en.UNIMPLEMENTED=12]="UNIMPLEMENTED",en[en.INTERNAL=13]="INTERNAL",en[en.UNAVAILABLE=14]="UNAVAILABLE",en[en.DATA_LOSS=15]="DATA_LOSS";function ZR(){return new TextEncoder}const e4=new qa([4294967295,4294967295],0);function T2(s){const e=ZR().encode(s),t=new Iw;return t.update(e),new Uint8Array(t.digest())}function k2(s){const e=new DataView(s.buffer),t=e.getUint32(0,!0),i=e.getUint32(4,!0),l=e.getUint32(8,!0),u=e.getUint32(12,!0);return[new qa([t,i],0),new qa([l,u],0)]}class ey{constructor(e,t,i){if(this.bitmap=e,this.padding=t,this.hashCount=i,t<0||t>=8)throw new qc(`Invalid padding: ${t}`);if(i<0)throw new qc(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new qc(`Invalid hash count: ${i}`);if(e.length===0&&t!==0)throw new qc(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=qa.fromNumber(this.ge)}ye(e,t,i){let l=e.add(t.multiply(qa.fromNumber(i)));return l.compare(e4)===1&&(l=new qa([l.getBits(0),l.getBits(1)],0)),l.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=T2(e),[i,l]=k2(t);for(let u=0;u<this.hashCount;u++){const h=this.ye(i,l,u);if(!this.we(h))return!1}return!0}static create(e,t,i){const l=e%8==0?0:8-e%8,u=new Uint8Array(Math.ceil(e/8)),h=new ey(u,l,t);return i.forEach((p=>h.insert(p))),h}insert(e){if(this.ge===0)return;const t=T2(e),[i,l]=k2(t);for(let u=0;u<this.hashCount;u++){const h=this.ye(i,l,u);this.be(h)}}be(e){const t=Math.floor(e/8),i=e%8;this.bitmap[t]|=1<<i}}class qc extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class rf{constructor(e,t,i,l,u){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=i,this.documentUpdates=l,this.resolvedLimboDocuments=u}static createSynthesizedRemoteEventForCurrentChange(e,t,i){const l=new Map;return l.set(e,Eu.createSynthesizedTargetChangeForCurrentChange(e,t,i)),new rf(jt.min(),l,new Qn(Wt),na(),Kt())}}class Eu{constructor(e,t,i,l,u){this.resumeToken=e,this.current=t,this.addedDocuments=i,this.modifiedDocuments=l,this.removedDocuments=u}static createSynthesizedTargetChangeForCurrentChange(e,t,i){return new Eu(i,t,Kt(),Kt(),Kt())}}class yd{constructor(e,t,i,l){this.Se=e,this.removedTargetIds=t,this.key=i,this.De=l}}class _x{constructor(e,t){this.targetId=e,this.Ce=t}}class wx{constructor(e,t,i=Ps.EMPTY_BYTE_STRING,l=null){this.state=e,this.targetIds=t,this.resumeToken=i,this.cause=l}}class S2{constructor(){this.ve=0,this.Fe=j2(),this.Me=Ps.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Kt(),t=Kt(),i=Kt();return this.Fe.forEach(((l,u)=>{switch(u){case 0:e=e.add(l);break;case 2:t=t.add(l);break;case 1:i=i.add(l);break;default:wt(38017,{changeType:u})}})),new Eu(this.Me,this.xe,e,t,i)}Ke(){this.Oe=!1,this.Fe=j2()}qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}Ue(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}$e(){this.ve+=1}We(){this.ve-=1,mn(this.ve>=0,3241,{ve:this.ve})}Qe(){this.Oe=!0,this.xe=!0}}class t4{constructor(e){this.Ge=e,this.ze=new Map,this.je=na(),this.He=Jh(),this.Je=Jh(),this.Ze=new Qn(Wt)}Xe(e){for(const t of e.Se)e.De&&e.De.isFoundDocument()?this.Ye(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const i=this.nt(t);switch(e.state){case 0:this.rt(t)&&i.Le(e.resumeToken);break;case 1:i.We(),i.Ne||i.Ke(),i.Le(e.resumeToken);break;case 2:i.We(),i.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(i.Qe(),i.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),i.Le(e.resumeToken));break;default:wt(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((i,l)=>{this.rt(l)&&t(l)}))}st(e){const t=e.targetId,i=e.Ce.count,l=this.ot(t);if(l){const u=l.target;if(ag(u))if(i===0){const h=new ot(u.path);this.et(t,h,$s.newNoDocument(h,jt.min()))}else mn(i===1,20013,{expectedCount:i});else{const h=this._t(t);if(h!==i){const p=this.ut(e),g=p?this.ct(p,e,h):1;if(g!==0){this.it(t);const y=g===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(t,y)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:i="",padding:l=0},hashCount:u=0}=t;let h,p;try{h=Ka(i).toUint8Array()}catch(g){if(g instanceof Hw)return Il("Decoding the base64 bloom filter in existence filter failed ("+g.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw g}try{p=new ey(h,l,u)}catch(g){return Il(g instanceof qc?"BloomFilter error: ":"Applying bloom filter failed: ",g),null}return p.ge===0?null:p}ct(e,t,i){return t.Ce.count===i-this.Pt(e,t.targetId)?0:2}Pt(e,t){const i=this.Ge.getRemoteKeysForTarget(t);let l=0;return i.forEach((u=>{const h=this.Ge.ht(),p=`projects/${h.projectId}/databases/${h.database}/documents/${u.path.canonicalString()}`;e.mightContain(p)||(this.et(t,u,null),l++)})),l}Tt(e){const t=new Map;this.ze.forEach(((u,h)=>{const p=this.ot(h);if(p){if(u.current&&ag(p.target)){const g=new ot(p.target.path);this.It(g).has(h)||this.Et(h,g)||this.et(h,g,$s.newNoDocument(g,e))}u.Be&&(t.set(h,u.ke()),u.Ke())}}));let i=Kt();this.Je.forEach(((u,h)=>{let p=!0;h.forEachWhile((g=>{const y=this.ot(g);return!y||y.purpose==="TargetPurposeLimboResolution"||(p=!1,!1)})),p&&(i=i.add(u))})),this.je.forEach(((u,h)=>h.setReadTime(e)));const l=new rf(e,t,this.Ze,this.je,i);return this.je=na(),this.He=Jh(),this.Je=Jh(),this.Ze=new Qn(Wt),l}Ye(e,t){if(!this.rt(e))return;const i=this.Et(e,t.key)?2:0;this.nt(e).qe(t.key,i),this.je=this.je.insert(t.key,t),this.He=this.He.insert(t.key,this.It(t.key).add(e)),this.Je=this.Je.insert(t.key,this.Rt(t.key).add(e))}et(e,t,i){if(!this.rt(e))return;const l=this.nt(e);this.Et(e,t)?l.qe(t,1):l.Ue(t),this.Je=this.Je.insert(t,this.Rt(t).delete(e)),this.Je=this.Je.insert(t,this.Rt(t).add(e)),i&&(this.je=this.je.insert(t,i))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.nt(e).$e()}nt(e){let t=this.ze.get(e);return t||(t=new S2,this.ze.set(e,t)),t}Rt(e){let t=this.Je.get(e);return t||(t=new Ts(Wt),this.Je=this.Je.insert(e,t)),t}It(e){let t=this.He.get(e);return t||(t=new Ts(Wt),this.He=this.He.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||We("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new S2),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function Jh(){return new Qn(ot.comparator)}function j2(){return new Qn(ot.comparator)}const n4={asc:"ASCENDING",desc:"DESCENDING"},s4={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},r4={and:"AND",or:"OR"};class i4{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function lg(s,e){return s.useProto3Json||Qd(e)?e:{value:e}}function Ld(s,e){return s.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function xx(s,e){return s.useProto3Json?e.toBase64():e.toUint8Array()}function a4(s,e){return Ld(s,e.toTimestamp())}function xi(s){return mn(!!s,49232),jt.fromTimestamp((function(t){const i=Ga(t);return new Gt(i.seconds,i.nanos)})(s))}function ty(s,e){return cg(s,e).canonicalString()}function cg(s,e){const t=(function(l){return new Dn(["projects",l.projectId,"databases",l.database])})(s).child("documents");return e===void 0?t:t.child(e)}function Ex(s){const e=Dn.fromString(s);return mn(Cx(e),10190,{key:e.toString()}),e}function ug(s,e){return ty(s.databaseId,e.path)}function Tp(s,e){const t=Ex(e);if(t.get(1)!==s.databaseId.projectId)throw new Ve(fe.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+s.databaseId.projectId);if(t.get(3)!==s.databaseId.database)throw new Ve(fe.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+s.databaseId.database);return new ot(kx(t))}function Tx(s,e){return ty(s.databaseId,e)}function o4(s){const e=Ex(s);return e.length===4?Dn.emptyPath():kx(e)}function hg(s){return new Dn(["projects",s.databaseId.projectId,"databases",s.databaseId.database]).canonicalString()}function kx(s){return mn(s.length>4&&s.get(4)==="documents",29091,{key:s.toString()}),s.popFirst(5)}function C2(s,e,t){return{name:ug(s,e),fields:t.value.mapValue.fields}}function l4(s,e){let t;if("targetChange"in e){e.targetChange;const i=(function(y){return y==="NO_CHANGE"?0:y==="ADD"?1:y==="REMOVE"?2:y==="CURRENT"?3:y==="RESET"?4:wt(39313,{state:y})})(e.targetChange.targetChangeType||"NO_CHANGE"),l=e.targetChange.targetIds||[],u=(function(y,b){return y.useProto3Json?(mn(b===void 0||typeof b=="string",58123),Ps.fromBase64String(b||"")):(mn(b===void 0||b instanceof Buffer||b instanceof Uint8Array,16193),Ps.fromUint8Array(b||new Uint8Array))})(s,e.targetChange.resumeToken),h=e.targetChange.cause,p=h&&(function(y){const b=y.code===void 0?fe.UNKNOWN:bx(y.code);return new Ve(b,y.message||"")})(h);t=new wx(i,l,u,p||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const l=Tp(s,i.document.name),u=xi(i.document.updateTime),h=i.document.createTime?xi(i.document.createTime):jt.min(),p=new ur({mapValue:{fields:i.document.fields}}),g=$s.newFoundDocument(l,u,h,p),y=i.targetIds||[],b=i.removedTargetIds||[];t=new yd(y,b,g.key,g)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const l=Tp(s,i.document),u=i.readTime?xi(i.readTime):jt.min(),h=$s.newNoDocument(l,u),p=i.removedTargetIds||[];t=new yd([],p,h.key,h)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const l=Tp(s,i.document),u=i.removedTargetIds||[];t=new yd([],u,l,null)}else{if(!("filter"in e))return wt(11601,{Vt:e});{e.filter;const i=e.filter;i.targetId;const{count:l=0,unchangedNames:u}=i,h=new XR(l,u),p=i.targetId;t=new _x(p,h)}}return t}function c4(s,e){let t;if(e instanceof xu)t={update:C2(s,e.key,e.value)};else if(e instanceof sf)t={delete:ug(s,e.key)};else if(e instanceof to)t={update:C2(s,e.key,e.data),updateMask:v4(e.fieldMask)};else{if(!(e instanceof KR))return wt(16599,{dt:e.type});t={verify:ug(s,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((i=>(function(u,h){const p=h.transform;if(p instanceof ou)return{fieldPath:h.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(p instanceof lu)return{fieldPath:h.field.canonicalString(),appendMissingElements:{values:p.elements}};if(p instanceof cu)return{fieldPath:h.field.canonicalString(),removeAllFromArray:{values:p.elements}};if(p instanceof uu)return{fieldPath:h.field.canonicalString(),increment:p.Ae};throw wt(20930,{transform:h.transform})})(0,i)))),e.precondition.isNone||(t.currentDocument=(function(l,u){return u.updateTime!==void 0?{updateTime:a4(l,u.updateTime)}:u.exists!==void 0?{exists:u.exists}:wt(27497)})(s,e.precondition)),t}function u4(s,e){return s&&s.length>0?(mn(e!==void 0,14353),s.map((t=>(function(l,u){let h=l.updateTime?xi(l.updateTime):xi(u);return h.isEqual(jt.min())&&(h=xi(u)),new $R(h,l.transformResults||[])})(t,e)))):[]}function h4(s,e){return{documents:[Tx(s,e.path)]}}function d4(s,e){const t={structuredQuery:{}},i=e.path;let l;e.collectionGroup!==null?(l=i,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(l=i.popLast(),t.structuredQuery.from=[{collectionId:i.lastSegment()}]),t.parent=Tx(s,l);const u=(function(y){if(y.length!==0)return jx(ri.create(y,"and"))})(e.filters);u&&(t.structuredQuery.where=u);const h=(function(y){if(y.length!==0)return y.map((b=>(function(T){return{field:Tl(T.field),direction:p4(T.dir)}})(b)))})(e.orderBy);h&&(t.structuredQuery.orderBy=h);const p=lg(s,e.limit);return p!==null&&(t.structuredQuery.limit=p),e.startAt&&(t.structuredQuery.startAt=(function(y){return{before:y.inclusive,values:y.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(y){return{before:!y.inclusive,values:y.position}})(e.endAt)),{ft:t,parent:l}}function f4(s){let e=o4(s.parent);const t=s.structuredQuery,i=t.from?t.from.length:0;let l=null;if(i>0){mn(i===1,65062);const b=t.from[0];b.allDescendants?l=b.collectionId:e=e.child(b.collectionId)}let u=[];t.where&&(u=(function(E){const T=Sx(E);return T instanceof ri&&ex(T)?T.getFilters():[T]})(t.where));let h=[];t.orderBy&&(h=(function(E){return E.map((T=>(function(H){return new au(kl(H.field),(function(B){switch(B){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(H.direction))})(T)))})(t.orderBy));let p=null;t.limit&&(p=(function(E){let T;return T=typeof E=="object"?E.value:E,Qd(T)?null:T})(t.limit));let g=null;t.startAt&&(g=(function(E){const T=!!E.before,O=E.values||[];return new Dd(O,T)})(t.startAt));let y=null;return t.endAt&&(y=(function(E){const T=!E.before,O=E.values||[];return new Dd(O,T)})(t.endAt)),RR(e,l,h,u,p,"F",g,y)}function m4(s,e){const t=(function(l){switch(l){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return wt(28987,{purpose:l})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function Sx(s){return s.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const i=kl(t.unaryFilter.field);return bs.create(i,"==",{doubleValue:NaN});case"IS_NULL":const l=kl(t.unaryFilter.field);return bs.create(l,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const u=kl(t.unaryFilter.field);return bs.create(u,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const h=kl(t.unaryFilter.field);return bs.create(h,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return wt(61313);default:return wt(60726)}})(s):s.fieldFilter!==void 0?(function(t){return bs.create(kl(t.fieldFilter.field),(function(l){switch(l){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return wt(58110);default:return wt(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(s):s.compositeFilter!==void 0?(function(t){return ri.create(t.compositeFilter.filters.map((i=>Sx(i))),(function(l){switch(l){case"AND":return"and";case"OR":return"or";default:return wt(1026)}})(t.compositeFilter.op))})(s):wt(30097,{filter:s})}function p4(s){return n4[s]}function g4(s){return s4[s]}function y4(s){return r4[s]}function Tl(s){return{fieldPath:s.canonicalString()}}function kl(s){return Ls.fromServerFormat(s.fieldPath)}function jx(s){return s instanceof bs?(function(t){if(t.op==="=="){if(p2(t.value))return{unaryFilter:{field:Tl(t.field),op:"IS_NAN"}};if(m2(t.value))return{unaryFilter:{field:Tl(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(p2(t.value))return{unaryFilter:{field:Tl(t.field),op:"IS_NOT_NAN"}};if(m2(t.value))return{unaryFilter:{field:Tl(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Tl(t.field),op:g4(t.op),value:t.value}}})(s):s instanceof ri?(function(t){const i=t.getFilters().map((l=>jx(l)));return i.length===1?i[0]:{compositeFilter:{op:y4(t.op),filters:i}}})(s):wt(54877,{filter:s})}function v4(s){const e=[];return s.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function Cx(s){return s.length>=4&&s.get(0)==="projects"&&s.get(2)==="databases"}function Nx(s){return!!s&&typeof s._toProto=="function"&&s._protoValueType==="ProtoValue"}class Va{constructor(e,t,i,l,u=jt.min(),h=jt.min(),p=Ps.EMPTY_BYTE_STRING,g=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=l,this.snapshotVersion=u,this.lastLimboFreeSnapshotVersion=h,this.resumeToken=p,this.expectedCount=g}withSequenceNumber(e){return new Va(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Va(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Va(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Va(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class b4{constructor(e){this.yt=e}}function _4(s){const e=f4({parent:s.parent,structuredQuery:s.structuredQuery});return s.limitType==="LAST"?Md(e,e.limit,"L"):e}class w4{constructor(){this.Sn=new x4}addToCollectionParentIndex(e,t){return this.Sn.add(t),be.resolve()}getCollectionParents(e,t){return be.resolve(this.Sn.getEntries(t))}addFieldIndex(e,t){return be.resolve()}deleteFieldIndex(e,t){return be.resolve()}deleteAllFieldIndexes(e){return be.resolve()}createTargetIndexes(e,t){return be.resolve()}getDocumentsMatchingTarget(e,t){return be.resolve(null)}getIndexType(e,t){return be.resolve(0)}getFieldIndexes(e,t){return be.resolve([])}getNextCollectionGroupToUpdate(e){return be.resolve(null)}getMinOffset(e,t){return be.resolve(Wa.min())}getMinOffsetFromCollectionGroup(e,t){return be.resolve(Wa.min())}updateCollectionGroup(e,t,i){return be.resolve()}updateIndexEntries(e,t){return be.resolve()}}class x4{constructor(){this.index={}}add(e){const t=e.lastSegment(),i=e.popLast(),l=this.index[t]||new Ts(Dn.comparator),u=!l.has(i);return this.index[t]=l.add(i),u}has(e){const t=e.lastSegment(),i=e.popLast(),l=this.index[t];return l&&l.has(i)}getEntries(e){return(this.index[e]||new Ts(Dn.comparator)).toArray()}}const N2={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Ax=41943040;class cr{static withCacheSize(e){return new cr(e,cr.DEFAULT_COLLECTION_PERCENTILE,cr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}}cr.DEFAULT_COLLECTION_PERCENTILE=10,cr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,cr.DEFAULT=new cr(Ax,cr.DEFAULT_COLLECTION_PERCENTILE,cr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),cr.DISABLED=new cr(-1,0,0);class Ol{constructor(e){this.sr=e}next(){return this.sr+=2,this.sr}static _r(){return new Ol(0)}static ar(){return new Ol(-1)}}const A2="LruGarbageCollector",E4=1048576;function R2([s,e],[t,i]){const l=Wt(s,t);return l===0?Wt(e,i):l}class T4{constructor(e){this.Pr=e,this.buffer=new Ts(R2),this.Tr=0}Ir(){return++this.Tr}Er(e){const t=[e,this.Ir()];if(this.buffer.size<this.Pr)this.buffer=this.buffer.add(t);else{const i=this.buffer.last();R2(t,i)<0&&(this.buffer=this.buffer.delete(i).add(t))}}get maxValue(){return this.buffer.last()[0]}}class k4{constructor(e,t,i){this.garbageCollector=e,this.asyncQueue=t,this.localStore=i,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Ar(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Ar(e){We(A2,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Hl(t)?We(A2,"Ignoring IndexedDB error during garbage collection: ",t):await ql(t)}await this.Ar(3e5)}))}}class S4{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.dr(e).next((i=>Math.floor(t/100*i)))}nthSequenceNumber(e,t){if(t===0)return be.resolve(Yd.ce);const i=new T4(t);return this.Vr.forEachTarget(e,(l=>i.Er(l.sequenceNumber))).next((()=>this.Vr.mr(e,(l=>i.Er(l))))).next((()=>i.maxValue))}removeTargets(e,t,i){return this.Vr.removeTargets(e,t,i)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(We("LruGarbageCollector","Garbage collection skipped; disabled"),be.resolve(N2)):this.getCacheSize(e).next((i=>i<this.params.cacheSizeCollectionThreshold?(We("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),N2):this.gr(e,t)))}getCacheSize(e){return this.Vr.getCacheSize(e)}gr(e,t){let i,l,u,h,p,g,y;const b=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((E=>(E>this.params.maximumSequenceNumbersToCollect?(We("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${E}`),l=this.params.maximumSequenceNumbersToCollect):l=E,h=Date.now(),this.nthSequenceNumber(e,l)))).next((E=>(i=E,p=Date.now(),this.removeTargets(e,i,t)))).next((E=>(u=E,g=Date.now(),this.removeOrphanedDocuments(e,i)))).next((E=>(y=Date.now(),xl()<=$t.DEBUG&&We("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${h-b}ms
	Determined least recently used ${l} in `+(p-h)+`ms
	Removed ${u} targets in `+(g-p)+`ms
	Removed ${E} documents in `+(y-g)+`ms
Total Duration: ${y-b}ms`),be.resolve({didRun:!0,sequenceNumbersCollected:l,targetsRemoved:u,documentsRemoved:E}))))}}function j4(s,e){return new S4(s,e)}class C4{constructor(){this.changes=new Uo((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,$s.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const i=this.changes.get(t);return i!==void 0?be.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class N4{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class A4{constructor(e,t,i,l){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=l}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next((l=>(i=l,this.remoteDocumentCache.getEntry(e,t)))).next((l=>(i!==null&&Qc(i.mutation,l,Tr.empty(),Gt.now()),l)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.getLocalViewOfDocuments(e,i,Kt()).next((()=>i))))}getLocalViewOfDocuments(e,t,i=Kt()){const l=To();return this.populateOverlays(e,l,t).next((()=>this.computeViews(e,t,l,i).next((u=>{let h=Fc();return u.forEach(((p,g)=>{h=h.insert(p,g.overlayedDocument)})),h}))))}getOverlayedDocuments(e,t){const i=To();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,Kt())))}populateOverlays(e,t,i){const l=[];return i.forEach((u=>{t.has(u)||l.push(u)})),this.documentOverlayCache.getOverlays(e,l).next((u=>{u.forEach(((h,p)=>{t.set(h,p)}))}))}computeViews(e,t,i,l){let u=na();const h=Yc(),p=(function(){return Yc()})();return t.forEach(((g,y)=>{const b=i.get(y.key);l.has(y.key)&&(b===void 0||b.mutation instanceof to)?u=u.insert(y.key,y):b!==void 0?(h.set(y.key,b.mutation.getFieldMask()),Qc(b.mutation,y,b.mutation.getFieldMask(),Gt.now())):h.set(y.key,Tr.empty())})),this.recalculateAndSaveOverlays(e,u).next((g=>(g.forEach(((y,b)=>h.set(y,b))),t.forEach(((y,b)=>p.set(y,new N4(b,h.get(y)??null)))),p)))}recalculateAndSaveOverlays(e,t){const i=Yc();let l=new Qn(((h,p)=>h-p)),u=Kt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((h=>{for(const p of h)p.keys().forEach((g=>{const y=t.get(g);if(y===null)return;let b=i.get(g)||Tr.empty();b=p.applyToLocalView(y,b),i.set(g,b);const E=(l.get(p.batchId)||Kt()).add(g);l=l.insert(p.batchId,E)}))})).next((()=>{const h=[],p=l.getReverseIterator();for(;p.hasNext();){const g=p.getNext(),y=g.key,b=g.value,E=cx();b.forEach((T=>{if(!u.has(T)){const O=yx(t.get(T),i.get(T));O!==null&&E.set(T,O),u=u.add(T)}})),h.push(this.documentOverlayCache.saveOverlays(e,y,E))}return be.waitFor(h)})).next((()=>i))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.recalculateAndSaveOverlays(e,i)))}getDocumentsMatchingQuery(e,t,i,l){return IR(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):rx(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i,l):this.getDocumentsMatchingCollectionQuery(e,t,i,l)}getNextDocuments(e,t,i,l){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,l).next((u=>{const h=l-u.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,l-u.size):be.resolve(To());let p=nu,g=u;return h.next((y=>be.forEach(y,((b,E)=>(p<E.largestBatchId&&(p=E.largestBatchId),u.get(b)?be.resolve():this.remoteDocumentCache.getEntry(e,b).next((T=>{g=g.insert(b,T)}))))).next((()=>this.populateOverlays(e,y,u))).next((()=>this.computeViews(e,g,y,Kt()))).next((b=>({batchId:p,changes:lx(b)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new ot(t)).next((i=>{let l=Fc();return i.isFoundDocument()&&(l=l.insert(i.key,i)),l}))}getDocumentsMatchingCollectionGroupQuery(e,t,i,l){const u=t.collectionGroup;let h=Fc();return this.indexManager.getCollectionParents(e,u).next((p=>be.forEach(p,(g=>{const y=(function(E,T){return new $l(T,null,E.explicitOrderBy.slice(),E.filters.slice(),E.limit,E.limitType,E.startAt,E.endAt)})(t,g.child(u));return this.getDocumentsMatchingCollectionQuery(e,y,i,l).next((b=>{b.forEach(((E,T)=>{h=h.insert(E,T)}))}))})).next((()=>h))))}getDocumentsMatchingCollectionQuery(e,t,i,l){let u;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next((h=>(u=h,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,u,l)))).next((h=>{u.forEach(((g,y)=>{const b=y.getKey();h.get(b)===null&&(h=h.insert(b,$s.newInvalidDocument(b)))}));let p=Fc();return h.forEach(((g,y)=>{const b=u.get(g);b!==void 0&&Qc(b.mutation,y,Tr.empty(),Gt.now()),ef(t,y)&&(p=p.insert(g,y))})),p}))}}class R4{constructor(e){this.serializer=e,this.Nr=new Map,this.Br=new Map}getBundleMetadata(e,t){return be.resolve(this.Nr.get(t))}saveBundleMetadata(e,t){return this.Nr.set(t.id,(function(l){return{id:l.id,version:l.version,createTime:xi(l.createTime)}})(t)),be.resolve()}getNamedQuery(e,t){return be.resolve(this.Br.get(t))}saveNamedQuery(e,t){return this.Br.set(t.name,(function(l){return{name:l.name,query:_4(l.bundledQuery),readTime:xi(l.readTime)}})(t)),be.resolve()}}class I4{constructor(){this.overlays=new Qn(ot.comparator),this.Lr=new Map}getOverlay(e,t){return be.resolve(this.overlays.get(t))}getOverlays(e,t){const i=To();return be.forEach(t,(l=>this.getOverlay(e,l).next((u=>{u!==null&&i.set(l,u)})))).next((()=>i))}saveOverlays(e,t,i){return i.forEach(((l,u)=>{this.bt(e,t,u)})),be.resolve()}removeOverlaysForBatchId(e,t,i){const l=this.Lr.get(i);return l!==void 0&&(l.forEach((u=>this.overlays=this.overlays.remove(u))),this.Lr.delete(i)),be.resolve()}getOverlaysForCollection(e,t,i){const l=To(),u=t.length+1,h=new ot(t.child("")),p=this.overlays.getIteratorFrom(h);for(;p.hasNext();){const g=p.getNext().value,y=g.getKey();if(!t.isPrefixOf(y.path))break;y.path.length===u&&g.largestBatchId>i&&l.set(g.getKey(),g)}return be.resolve(l)}getOverlaysForCollectionGroup(e,t,i,l){let u=new Qn(((y,b)=>y-b));const h=this.overlays.getIterator();for(;h.hasNext();){const y=h.getNext().value;if(y.getKey().getCollectionGroup()===t&&y.largestBatchId>i){let b=u.get(y.largestBatchId);b===null&&(b=To(),u=u.insert(y.largestBatchId,b)),b.set(y.getKey(),y)}}const p=To(),g=u.getIterator();for(;g.hasNext()&&(g.getNext().value.forEach(((y,b)=>p.set(y,b))),!(p.size()>=l)););return be.resolve(p)}bt(e,t,i){const l=this.overlays.get(i.key);if(l!==null){const h=this.Lr.get(l.largestBatchId).delete(i.key);this.Lr.set(l.largestBatchId,h)}this.overlays=this.overlays.insert(i.key,new QR(t,i));let u=this.Lr.get(t);u===void 0&&(u=Kt(),this.Lr.set(t,u)),this.Lr.set(t,u.add(i.key))}}class D4{constructor(){this.sessionToken=Ps.EMPTY_BYTE_STRING}getSessionToken(e){return be.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,be.resolve()}}class ny{constructor(){this.kr=new Ts(Ss.Kr),this.qr=new Ts(Ss.Ur)}isEmpty(){return this.kr.isEmpty()}addReference(e,t){const i=new Ss(e,t);this.kr=this.kr.add(i),this.qr=this.qr.add(i)}$r(e,t){e.forEach((i=>this.addReference(i,t)))}removeReference(e,t){this.Wr(new Ss(e,t))}Qr(e,t){e.forEach((i=>this.removeReference(i,t)))}Gr(e){const t=new ot(new Dn([])),i=new Ss(t,e),l=new Ss(t,e+1),u=[];return this.qr.forEachInRange([i,l],(h=>{this.Wr(h),u.push(h.key)})),u}zr(){this.kr.forEach((e=>this.Wr(e)))}Wr(e){this.kr=this.kr.delete(e),this.qr=this.qr.delete(e)}jr(e){const t=new ot(new Dn([])),i=new Ss(t,e),l=new Ss(t,e+1);let u=Kt();return this.qr.forEachInRange([i,l],(h=>{u=u.add(h.key)})),u}containsKey(e){const t=new Ss(e,0),i=this.kr.firstAfterOrEqual(t);return i!==null&&e.isEqual(i.key)}}class Ss{constructor(e,t){this.key=e,this.Hr=t}static Kr(e,t){return ot.comparator(e.key,t.key)||Wt(e.Hr,t.Hr)}static Ur(e,t){return Wt(e.Hr,t.Hr)||ot.comparator(e.key,t.key)}}class M4{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Yn=1,this.Jr=new Ts(Ss.Kr)}checkEmpty(e){return be.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,i,l){const u=this.Yn;this.Yn++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const h=new YR(u,t,i,l);this.mutationQueue.push(h);for(const p of l)this.Jr=this.Jr.add(new Ss(p.key,u)),this.indexManager.addToCollectionParentIndex(e,p.key.path.popLast());return be.resolve(h)}lookupMutationBatch(e,t){return be.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,l=this.Xr(i),u=l<0?0:l;return be.resolve(this.mutationQueue.length>u?this.mutationQueue[u]:null)}getHighestUnacknowledgedBatchId(){return be.resolve(this.mutationQueue.length===0?Gg:this.Yn-1)}getAllMutationBatches(e){return be.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const i=new Ss(t,0),l=new Ss(t,Number.POSITIVE_INFINITY),u=[];return this.Jr.forEachInRange([i,l],(h=>{const p=this.Zr(h.Hr);u.push(p)})),be.resolve(u)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new Ts(Wt);return t.forEach((l=>{const u=new Ss(l,0),h=new Ss(l,Number.POSITIVE_INFINITY);this.Jr.forEachInRange([u,h],(p=>{i=i.add(p.Hr)}))})),be.resolve(this.Yr(i))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,l=i.length+1;let u=i;ot.isDocumentKey(u)||(u=u.child(""));const h=new Ss(new ot(u),0);let p=new Ts(Wt);return this.Jr.forEachWhile((g=>{const y=g.key.path;return!!i.isPrefixOf(y)&&(y.length===l&&(p=p.add(g.Hr)),!0)}),h),be.resolve(this.Yr(p))}Yr(e){const t=[];return e.forEach((i=>{const l=this.Zr(i);l!==null&&t.push(l)})),t}removeMutationBatch(e,t){mn(this.ei(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.Jr;return be.forEach(t.mutations,(l=>{const u=new Ss(l.key,t.batchId);return i=i.delete(u),this.referenceDelegate.markPotentiallyOrphaned(e,l.key)})).next((()=>{this.Jr=i}))}nr(e){}containsKey(e,t){const i=new Ss(t,0),l=this.Jr.firstAfterOrEqual(i);return be.resolve(t.isEqual(l&&l.key))}performConsistencyCheck(e){return this.mutationQueue.length,be.resolve()}ei(e,t){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class L4{constructor(e){this.ti=e,this.docs=(function(){return new Qn(ot.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const i=t.key,l=this.docs.get(i),u=l?l.size:0,h=this.ti(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:h}),this.size+=h-u,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const i=this.docs.get(t);return be.resolve(i?i.document.mutableCopy():$s.newInvalidDocument(t))}getEntries(e,t){let i=na();return t.forEach((l=>{const u=this.docs.get(l);i=i.insert(l,u?u.document.mutableCopy():$s.newInvalidDocument(l))})),be.resolve(i)}getDocumentsMatchingQuery(e,t,i,l){let u=na();const h=t.path,p=new ot(h.child("__id-9223372036854775808__")),g=this.docs.getIteratorFrom(p);for(;g.hasNext();){const{key:y,value:{document:b}}=g.getNext();if(!h.isPrefixOf(y.path))break;y.path.length>h.length+1||lR(oR(b),i)<=0||(l.has(b.key)||ef(t,b))&&(u=u.insert(b.key,b.mutableCopy()))}return be.resolve(u)}getAllFromCollectionGroup(e,t,i,l){wt(9500)}ni(e,t){return be.forEach(this.docs,(i=>t(i)))}newChangeBuffer(e){return new O4(this)}getSize(e){return be.resolve(this.size)}}class O4 extends C4{constructor(e){super(),this.Mr=e}applyChanges(e){const t=[];return this.changes.forEach(((i,l)=>{l.isValidDocument()?t.push(this.Mr.addEntry(e,l)):this.Mr.removeEntry(i)})),be.waitFor(t)}getFromCache(e,t){return this.Mr.getEntry(e,t)}getAllFromCache(e,t){return this.Mr.getEntries(e,t)}}class P4{constructor(e){this.persistence=e,this.ri=new Uo((t=>Qg(t)),Xg),this.lastRemoteSnapshotVersion=jt.min(),this.highestTargetId=0,this.ii=0,this.si=new ny,this.targetCount=0,this.oi=Ol._r()}forEachTarget(e,t){return this.ri.forEach(((i,l)=>t(l))),be.resolve()}getLastRemoteSnapshotVersion(e){return be.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return be.resolve(this.ii)}allocateTargetId(e){return this.highestTargetId=this.oi.next(),be.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.ii&&(this.ii=t),be.resolve()}lr(e){this.ri.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.oi=new Ol(t),this.highestTargetId=t),e.sequenceNumber>this.ii&&(this.ii=e.sequenceNumber)}addTargetData(e,t){return this.lr(t),this.targetCount+=1,be.resolve()}updateTargetData(e,t){return this.lr(t),be.resolve()}removeTargetData(e,t){return this.ri.delete(t.target),this.si.Gr(t.targetId),this.targetCount-=1,be.resolve()}removeTargets(e,t,i){let l=0;const u=[];return this.ri.forEach(((h,p)=>{p.sequenceNumber<=t&&i.get(p.targetId)===null&&(this.ri.delete(h),u.push(this.removeMatchingKeysForTargetId(e,p.targetId)),l++)})),be.waitFor(u).next((()=>l))}getTargetCount(e){return be.resolve(this.targetCount)}getTargetData(e,t){const i=this.ri.get(t)||null;return be.resolve(i)}addMatchingKeys(e,t,i){return this.si.$r(t,i),be.resolve()}removeMatchingKeys(e,t,i){this.si.Qr(t,i);const l=this.persistence.referenceDelegate,u=[];return l&&t.forEach((h=>{u.push(l.markPotentiallyOrphaned(e,h))})),be.waitFor(u)}removeMatchingKeysForTargetId(e,t){return this.si.Gr(t),be.resolve()}getMatchingKeysForTargetId(e,t){const i=this.si.jr(t);return be.resolve(i)}containsKey(e,t){return be.resolve(this.si.containsKey(t))}}class Rx{constructor(e,t){this._i={},this.overlays={},this.ai=new Yd(0),this.ui=!1,this.ui=!0,this.ci=new D4,this.referenceDelegate=e(this),this.li=new P4(this),this.indexManager=new w4,this.remoteDocumentCache=(function(l){return new L4(l)})((i=>this.referenceDelegate.hi(i))),this.serializer=new b4(t),this.Pi=new R4(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ui=!1,Promise.resolve()}get started(){return this.ui}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new I4,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this._i[e.toKey()];return i||(i=new M4(t,this.referenceDelegate),this._i[e.toKey()]=i),i}getGlobalsCache(){return this.ci}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Pi}runTransaction(e,t,i){We("MemoryPersistence","Starting transaction:",e);const l=new V4(this.ai.next());return this.referenceDelegate.Ti(),i(l).next((u=>this.referenceDelegate.Ii(l).next((()=>u)))).toPromise().then((u=>(l.raiseOnCommittedEvent(),u)))}Ei(e,t){return be.or(Object.values(this._i).map((i=>()=>i.containsKey(e,t))))}}class V4 extends uR{constructor(e){super(),this.currentSequenceNumber=e}}class sy{constructor(e){this.persistence=e,this.Ri=new ny,this.Ai=null}static Vi(e){return new sy(e)}get di(){if(this.Ai)return this.Ai;throw wt(60996)}addReference(e,t,i){return this.Ri.addReference(i,t),this.di.delete(i.toString()),be.resolve()}removeReference(e,t,i){return this.Ri.removeReference(i,t),this.di.add(i.toString()),be.resolve()}markPotentiallyOrphaned(e,t){return this.di.add(t.toString()),be.resolve()}removeTarget(e,t){this.Ri.Gr(t.targetId).forEach((l=>this.di.add(l.toString())));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next((l=>{l.forEach((u=>this.di.add(u.toString())))})).next((()=>i.removeTargetData(e,t)))}Ti(){this.Ai=new Set}Ii(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return be.forEach(this.di,(i=>{const l=ot.fromPath(i);return this.mi(e,l).next((u=>{u||t.removeEntry(l,jt.min())}))})).next((()=>(this.Ai=null,t.apply(e))))}updateLimboDocument(e,t){return this.mi(e,t).next((i=>{i?this.di.delete(t.toString()):this.di.add(t.toString())}))}hi(e){return 0}mi(e,t){return be.or([()=>be.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}}class Od{constructor(e,t){this.persistence=e,this.fi=new Uo((i=>fR(i.path)),((i,l)=>i.isEqual(l))),this.garbageCollector=j4(this,t)}static Vi(e,t){return new Od(e,t)}Ti(){}Ii(e){return be.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}dr(e){const t=this.pr(e);return this.persistence.getTargetCache().getTargetCount(e).next((i=>t.next((l=>i+l))))}pr(e){let t=0;return this.mr(e,(i=>{t++})).next((()=>t))}mr(e,t){return be.forEach(this.fi,((i,l)=>this.wr(e,i,l).next((u=>u?be.resolve():t(l)))))}removeTargets(e,t,i){return this.persistence.getTargetCache().removeTargets(e,t,i)}removeOrphanedDocuments(e,t){let i=0;const l=this.persistence.getRemoteDocumentCache(),u=l.newChangeBuffer();return l.ni(e,(h=>this.wr(e,h,t).next((p=>{p||(i++,u.removeEntry(h,jt.min()))})))).next((()=>u.apply(e))).next((()=>i))}markPotentiallyOrphaned(e,t){return this.fi.set(t,e.currentSequenceNumber),be.resolve()}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,i)}addReference(e,t,i){return this.fi.set(i,e.currentSequenceNumber),be.resolve()}removeReference(e,t,i){return this.fi.set(i,e.currentSequenceNumber),be.resolve()}updateLimboDocument(e,t){return this.fi.set(t,e.currentSequenceNumber),be.resolve()}hi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=md(e.data.value)),t}wr(e,t,i){return be.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const l=this.fi.get(t);return be.resolve(l!==void 0&&l>i)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class ry{constructor(e,t,i,l){this.targetId=e,this.fromCache=t,this.Ts=i,this.Is=l}static Es(e,t){let i=Kt(),l=Kt();for(const u of t.docChanges)switch(u.type){case 0:i=i.add(u.doc.key);break;case 1:l=l.add(u.doc.key)}return new ry(e,t.fromCache,i,l)}}class U4{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class B4{constructor(){this.Rs=!1,this.As=!1,this.Vs=100,this.ds=(function(){return fj()?8:hR(Ws())>0?6:4})()}initialize(e,t){this.fs=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,i,l){const u={result:null};return this.gs(e,t).next((h=>{u.result=h})).next((()=>{if(!u.result)return this.ps(e,t,l,i).next((h=>{u.result=h}))})).next((()=>{if(u.result)return;const h=new U4;return this.ys(e,t,h).next((p=>{if(u.result=p,this.As)return this.ws(e,t,h,p.size)}))})).next((()=>u.result))}ws(e,t,i,l){return i.documentReadCount<this.Vs?(xl()<=$t.DEBUG&&We("QueryEngine","SDK will not create cache indexes for query:",El(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),be.resolve()):(xl()<=$t.DEBUG&&We("QueryEngine","Query:",El(t),"scans",i.documentReadCount,"local documents and returns",l,"documents as results."),i.documentReadCount>this.ds*l?(xl()<=$t.DEBUG&&We("QueryEngine","The SDK decides to create cache indexes for query:",El(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,wi(t))):be.resolve())}gs(e,t){if(b2(t))return be.resolve(null);let i=wi(t);return this.indexManager.getIndexType(e,i).next((l=>l===0?null:(t.limit!==null&&l===1&&(t=Md(t,null,"F"),i=wi(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next((u=>{const h=Kt(...u);return this.fs.getDocuments(e,h).next((p=>this.indexManager.getMinOffset(e,i).next((g=>{const y=this.bs(t,p);return this.Ss(t,y,h,g.readTime)?this.gs(e,Md(t,null,"F")):this.Ds(e,y,t,g)}))))})))))}ps(e,t,i,l){return b2(t)||l.isEqual(jt.min())?be.resolve(null):this.fs.getDocuments(e,i).next((u=>{const h=this.bs(t,u);return this.Ss(t,h,i,l)?be.resolve(null):(xl()<=$t.DEBUG&&We("QueryEngine","Re-using previous result from %s to execute query: %s",l.toString(),El(t)),this.Ds(e,h,t,aR(l,nu)).next((p=>p)))}))}bs(e,t){let i=new Ts(ax(e));return t.forEach(((l,u)=>{ef(e,u)&&(i=i.add(u))})),i}Ss(e,t,i,l){if(e.limit===null)return!1;if(i.size!==t.size)return!0;const u=e.limitType==="F"?t.last():t.first();return!!u&&(u.hasPendingWrites||u.version.compareTo(l)>0)}ys(e,t,i){return xl()<=$t.DEBUG&&We("QueryEngine","Using full collection scan to execute query:",El(t)),this.fs.getDocumentsMatchingQuery(e,t,Wa.min(),i)}Ds(e,t,i,l){return this.fs.getDocumentsMatchingQuery(e,i,l).next((u=>(t.forEach((h=>{u=u.insert(h.key,h)})),u)))}}const iy="LocalStore",z4=3e8;class F4{constructor(e,t,i,l){this.persistence=e,this.Cs=t,this.serializer=l,this.vs=new Qn(Wt),this.Fs=new Uo((u=>Qg(u)),Xg),this.Ms=new Map,this.xs=e.getRemoteDocumentCache(),this.li=e.getTargetCache(),this.Pi=e.getBundleCache(),this.Os(i)}Os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new A4(this.xs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.xs.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.vs)))}}function q4(s,e,t,i){return new F4(s,e,t,i)}async function Ix(s,e){const t=Nt(s);return await t.persistence.runTransaction("Handle user change","readonly",(i=>{let l;return t.mutationQueue.getAllMutationBatches(i).next((u=>(l=u,t.Os(e),t.mutationQueue.getAllMutationBatches(i)))).next((u=>{const h=[],p=[];let g=Kt();for(const y of l){h.push(y.batchId);for(const b of y.mutations)g=g.add(b.key)}for(const y of u){p.push(y.batchId);for(const b of y.mutations)g=g.add(b.key)}return t.localDocuments.getDocuments(i,g).next((y=>({Ns:y,removedBatchIds:h,addedBatchIds:p})))}))}))}function H4(s,e){const t=Nt(s);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(i=>{const l=e.batch.keys(),u=t.xs.newChangeBuffer({trackRemovals:!0});return(function(p,g,y,b){const E=y.batch,T=E.keys();let O=be.resolve();return T.forEach((H=>{O=O.next((()=>b.getEntry(g,H))).next((q=>{const B=y.docVersions.get(H);mn(B!==null,48541),q.version.compareTo(B)<0&&(E.applyToRemoteDocument(q,y),q.isValidDocument()&&(q.setReadTime(y.commitVersion),b.addEntry(q)))}))})),O.next((()=>p.mutationQueue.removeMutationBatch(g,E)))})(t,i,e,u).next((()=>u.apply(i))).next((()=>t.mutationQueue.performConsistencyCheck(i))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(i,l,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,(function(p){let g=Kt();for(let y=0;y<p.mutationResults.length;++y)p.mutationResults[y].transformResults.length>0&&(g=g.add(p.batch.mutations[y].key));return g})(e)))).next((()=>t.localDocuments.getDocuments(i,l)))}))}function Dx(s){const e=Nt(s);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.li.getLastRemoteSnapshotVersion(t)))}function $4(s,e){const t=Nt(s),i=e.snapshotVersion;let l=t.vs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(u=>{const h=t.xs.newChangeBuffer({trackRemovals:!0});l=t.vs;const p=[];e.targetChanges.forEach(((b,E)=>{const T=l.get(E);if(!T)return;p.push(t.li.removeMatchingKeys(u,b.removedDocuments,E).next((()=>t.li.addMatchingKeys(u,b.addedDocuments,E))));let O=T.withSequenceNumber(u.currentSequenceNumber);e.targetMismatches.get(E)!==null?O=O.withResumeToken(Ps.EMPTY_BYTE_STRING,jt.min()).withLastLimboFreeSnapshotVersion(jt.min()):b.resumeToken.approximateByteSize()>0&&(O=O.withResumeToken(b.resumeToken,i)),l=l.insert(E,O),(function(q,B,te){return q.resumeToken.approximateByteSize()===0||B.snapshotVersion.toMicroseconds()-q.snapshotVersion.toMicroseconds()>=z4?!0:te.addedDocuments.size+te.modifiedDocuments.size+te.removedDocuments.size>0})(T,O,b)&&p.push(t.li.updateTargetData(u,O))}));let g=na(),y=Kt();if(e.documentUpdates.forEach((b=>{e.resolvedLimboDocuments.has(b)&&p.push(t.persistence.referenceDelegate.updateLimboDocument(u,b))})),p.push(W4(u,h,e.documentUpdates).next((b=>{g=b.Bs,y=b.Ls}))),!i.isEqual(jt.min())){const b=t.li.getLastRemoteSnapshotVersion(u).next((E=>t.li.setTargetsMetadata(u,u.currentSequenceNumber,i)));p.push(b)}return be.waitFor(p).next((()=>h.apply(u))).next((()=>t.localDocuments.getLocalViewOfDocuments(u,g,y))).next((()=>g))})).then((u=>(t.vs=l,u)))}function W4(s,e,t){let i=Kt(),l=Kt();return t.forEach((u=>i=i.add(u))),e.getEntries(s,i).next((u=>{let h=na();return t.forEach(((p,g)=>{const y=u.get(p);g.isFoundDocument()!==y.isFoundDocument()&&(l=l.add(p)),g.isNoDocument()&&g.version.isEqual(jt.min())?(e.removeEntry(p,g.readTime),h=h.insert(p,g)):!y.isValidDocument()||g.version.compareTo(y.version)>0||g.version.compareTo(y.version)===0&&y.hasPendingWrites?(e.addEntry(g),h=h.insert(p,g)):We(iy,"Ignoring outdated watch update for ",p,". Current version:",y.version," Watch version:",g.version)})),{Bs:h,Ls:l}}))}function G4(s,e){const t=Nt(s);return t.persistence.runTransaction("Get next mutation batch","readonly",(i=>(e===void 0&&(e=Gg),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e))))}function K4(s,e){const t=Nt(s);return t.persistence.runTransaction("Allocate target","readwrite",(i=>{let l;return t.li.getTargetData(i,e).next((u=>u?(l=u,be.resolve(l)):t.li.allocateTargetId(i).next((h=>(l=new Va(e,h,"TargetPurposeListen",i.currentSequenceNumber),t.li.addTargetData(i,l).next((()=>l)))))))})).then((i=>{const l=t.vs.get(i.targetId);return(l===null||i.snapshotVersion.compareTo(l.snapshotVersion)>0)&&(t.vs=t.vs.insert(i.targetId,i),t.Fs.set(e,i.targetId)),i}))}async function dg(s,e,t){const i=Nt(s),l=i.vs.get(e),u=t?"readwrite":"readwrite-primary";try{t||await i.persistence.runTransaction("Release target",u,(h=>i.persistence.referenceDelegate.removeTarget(h,l)))}catch(h){if(!Hl(h))throw h;We(iy,`Failed to update sequence numbers for target ${e}: ${h}`)}i.vs=i.vs.remove(e),i.Fs.delete(l.target)}function I2(s,e,t){const i=Nt(s);let l=jt.min(),u=Kt();return i.persistence.runTransaction("Execute query","readwrite",(h=>(function(g,y,b){const E=Nt(g),T=E.Fs.get(b);return T!==void 0?be.resolve(E.vs.get(T)):E.li.getTargetData(y,b)})(i,h,wi(e)).next((p=>{if(p)return l=p.lastLimboFreeSnapshotVersion,i.li.getMatchingKeysForTargetId(h,p.targetId).next((g=>{u=g}))})).next((()=>i.Cs.getDocumentsMatchingQuery(h,e,t?l:jt.min(),t?u:Kt()))).next((p=>(Y4(i,LR(e),p),{documents:p,ks:u})))))}function Y4(s,e,t){let i=s.Ms.get(e)||jt.min();t.forEach(((l,u)=>{u.readTime.compareTo(i)>0&&(i=u.readTime)})),s.Ms.set(e,i)}class D2{constructor(){this.activeTargetIds=zR()}Qs(e){this.activeTargetIds=this.activeTargetIds.add(e)}Gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Q4{constructor(){this.vo=new D2,this.Fo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e,t=!0){return t&&this.vo.Qs(e),this.Fo[e]||"not-current"}updateQueryState(e,t,i){this.Fo[e]=t}removeLocalQueryTarget(e){this.vo.Gs(e)}isLocalQueryTarget(e){return this.vo.activeTargetIds.has(e)}clearQueryState(e){delete this.Fo[e]}getAllActiveQueryTargets(){return this.vo.activeTargetIds}isActiveQueryTarget(e){return this.vo.activeTargetIds.has(e)}start(){return this.vo=new D2,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class X4{Mo(e){}shutdown(){}}const M2="ConnectivityMonitor";class L2{constructor(){this.xo=()=>this.Oo(),this.No=()=>this.Bo(),this.Lo=[],this.ko()}Mo(e){this.Lo.push(e)}shutdown(){window.removeEventListener("online",this.xo),window.removeEventListener("offline",this.No)}ko(){window.addEventListener("online",this.xo),window.addEventListener("offline",this.No)}Oo(){We(M2,"Network connectivity changed: AVAILABLE");for(const e of this.Lo)e(0)}Bo(){We(M2,"Network connectivity changed: UNAVAILABLE");for(const e of this.Lo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let Zh=null;function fg(){return Zh===null?Zh=(function(){return 268435456+Math.round(2147483648*Math.random())})():Zh++,"0x"+Zh.toString(16)}const kp="RestConnection",J4={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery",ExecutePipeline:"executePipeline"};class Z4{get Ko(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),l=encodeURIComponent(this.databaseId.database);this.qo=t+"://"+e.host,this.Uo=`projects/${i}/databases/${l}`,this.$o=this.databaseId.database===Rd?`project_id=${i}`:`project_id=${i}&database_id=${l}`}Wo(e,t,i,l,u){const h=fg(),p=this.Qo(e,t.toUriEncodedString());We(kp,`Sending RPC '${e}' ${h}:`,p,i);const g={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.$o};this.Go(g,l,u);const{host:y}=new URL(p),b=Ja(y);return this.zo(e,p,g,i,b).then((E=>(We(kp,`Received RPC '${e}' ${h}: `,E),E)),(E=>{throw Il(kp,`RPC '${e}' ${h} failed with error: `,E,"url: ",p,"request:",i),E}))}jo(e,t,i,l,u,h){return this.Wo(e,t,i,l,u)}Go(e,t,i){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Fl})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((l,u)=>e[u]=l)),i&&i.headers.forEach(((l,u)=>e[u]=l))}Qo(e,t){const i=J4[e];let l=`${this.qo}/v1/${t}:${i}`;return this.databaseInfo.apiKey&&(l=`${l}?key=${encodeURIComponent(this.databaseInfo.apiKey)}`),l}terminate(){}}class eI{constructor(e){this.Ho=e.Ho,this.Jo=e.Jo}Zo(e){this.Xo=e}Yo(e){this.e_=e}t_(e){this.n_=e}onMessage(e){this.r_=e}close(){this.Jo()}send(e){this.Ho(e)}i_(){this.Xo()}s_(){this.e_()}o_(e){this.n_(e)}__(e){this.r_(e)}}const qs="WebChannelConnection",Mc=(s,e,t)=>{s.listen(e,(i=>{try{t(i)}catch(l){setTimeout((()=>{throw l}),0)}}))};class Al extends Z4{constructor(e){super(e),this.a_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}static u_(){if(!Al.c_){const e=Ow();Mc(e,Lw.STAT_EVENT,(t=>{t.stat===tg.PROXY?We(qs,"STAT_EVENT: detected buffering proxy"):t.stat===tg.NOPROXY&&We(qs,"STAT_EVENT: detected no buffering proxy")})),Al.c_=!0}}zo(e,t,i,l,u){const h=fg();return new Promise(((p,g)=>{const y=new Dw;y.setWithCredentials(!0),y.listenOnce(Mw.COMPLETE,(()=>{try{switch(y.getLastErrorCode()){case fd.NO_ERROR:const E=y.getResponseJson();We(qs,`XHR for RPC '${e}' ${h} received:`,JSON.stringify(E)),p(E);break;case fd.TIMEOUT:We(qs,`RPC '${e}' ${h} timed out`),g(new Ve(fe.DEADLINE_EXCEEDED,"Request time out"));break;case fd.HTTP_ERROR:const T=y.getStatus();if(We(qs,`RPC '${e}' ${h} failed with status:`,T,"response text:",y.getResponseText()),T>0){let O=y.getResponseJson();Array.isArray(O)&&(O=O[0]);const H=O?.error;if(H&&H.status&&H.message){const q=(function(te){const W=te.toLowerCase().replace(/_/g,"-");return Object.values(fe).indexOf(W)>=0?W:fe.UNKNOWN})(H.status);g(new Ve(q,H.message))}else g(new Ve(fe.UNKNOWN,"Server responded with status "+y.getStatus()))}else g(new Ve(fe.UNAVAILABLE,"Connection failed."));break;default:wt(9055,{l_:e,streamId:h,h_:y.getLastErrorCode(),P_:y.getLastError()})}}finally{We(qs,`RPC '${e}' ${h} completed.`)}}));const b=JSON.stringify(l);We(qs,`RPC '${e}' ${h} sending request:`,l),y.send(t,"POST",b,i,15)}))}T_(e,t,i){const l=fg(),u=[this.qo,"/","google.firestore.v1.Firestore","/",e,"/channel"],h=this.createWebChannelTransport(),p={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},g=this.longPollingOptions.timeoutSeconds;g!==void 0&&(p.longPollingTimeout=Math.round(1e3*g)),this.useFetchStreams&&(p.useFetchStreams=!0),this.Go(p.initMessageHeaders,t,i),p.encodeInitMessageHeaders=!0;const y=u.join("");We(qs,`Creating RPC '${e}' stream ${l}: ${y}`,p);const b=h.createWebChannel(y,p);this.I_(b);let E=!1,T=!1;const O=new eI({Ho:H=>{T?We(qs,`Not sending because RPC '${e}' stream ${l} is closed:`,H):(E||(We(qs,`Opening RPC '${e}' stream ${l} transport.`),b.open(),E=!0),We(qs,`RPC '${e}' stream ${l} sending:`,H),b.send(H))},Jo:()=>b.close()});return Mc(b,zc.EventType.OPEN,(()=>{T||(We(qs,`RPC '${e}' stream ${l} transport opened.`),O.i_())})),Mc(b,zc.EventType.CLOSE,(()=>{T||(T=!0,We(qs,`RPC '${e}' stream ${l} transport closed`),O.o_(),this.E_(b))})),Mc(b,zc.EventType.ERROR,(H=>{T||(T=!0,Il(qs,`RPC '${e}' stream ${l} transport errored. Name:`,H.name,"Message:",H.message),O.o_(new Ve(fe.UNAVAILABLE,"The operation could not be completed")))})),Mc(b,zc.EventType.MESSAGE,(H=>{if(!T){const q=H.data[0];mn(!!q,16349);const B=q,te=B?.error||B[0]?.error;if(te){We(qs,`RPC '${e}' stream ${l} received error:`,te);const W=te.status;let ee=(function(ve){const A=vs[ve];if(A!==void 0)return bx(A)})(W),pe=te.message;ee===void 0&&(ee=fe.INTERNAL,pe="Unknown error status: "+W+" with message "+te.message),T=!0,O.o_(new Ve(ee,pe)),b.close()}else We(qs,`RPC '${e}' stream ${l} received:`,q),O.__(q)}})),Al.u_(),setTimeout((()=>{O.s_()}),0),O}terminate(){this.a_.forEach((e=>e.close())),this.a_=[]}I_(e){this.a_.push(e)}E_(e){this.a_=this.a_.filter((t=>t===e))}Go(e,t,i){super.Go(e,t,i),this.databaseInfo.apiKey&&(e["x-goog-api-key"]=this.databaseInfo.apiKey)}createWebChannelTransport(){return Pw()}}function tI(s){return new Al(s)}function Sp(){return typeof document<"u"?document:null}function af(s){return new i4(s,!0)}Al.c_=!1;class Mx{constructor(e,t,i=1e3,l=1.5,u=6e4){this.Ci=e,this.timerId=t,this.R_=i,this.A_=l,this.V_=u,this.d_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.d_=0}g_(){this.d_=this.V_}p_(e){this.cancel();const t=Math.floor(this.d_+this.y_()),i=Math.max(0,Date.now()-this.f_),l=Math.max(0,t-i);l>0&&We("ExponentialBackoff",`Backing off for ${l} ms (base delay: ${this.d_} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.m_=this.Ci.enqueueAfterDelay(this.timerId,l,(()=>(this.f_=Date.now(),e()))),this.d_*=this.A_,this.d_<this.R_&&(this.d_=this.R_),this.d_>this.V_&&(this.d_=this.V_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.d_}}const O2="PersistentStream";class Lx{constructor(e,t,i,l,u,h,p,g){this.Ci=e,this.b_=i,this.S_=l,this.connection=u,this.authCredentialsProvider=h,this.appCheckCredentialsProvider=p,this.listener=g,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new Mx(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Ci.enqueueAfterDelay(this.b_,6e4,(()=>this.k_())))}K_(e){this.q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===fe.RESOURCE_EXHAUSTED?(ta(t.toString()),ta("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===fe.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.t_(t)}W_(){}auth(){this.state=1;const e=this.Q_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([i,l])=>{this.D_===t&&this.G_(i,l)}),(i=>{e((()=>{const l=new Ve(fe.UNKNOWN,"Fetching auth token failed: "+i.message);return this.z_(l)}))}))}G_(e,t){const i=this.Q_(this.D_);this.stream=this.j_(e,t),this.stream.Zo((()=>{i((()=>this.listener.Zo()))})),this.stream.Yo((()=>{i((()=>(this.state=2,this.v_=this.Ci.enqueueAfterDelay(this.S_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.Yo())))})),this.stream.t_((l=>{i((()=>this.z_(l)))})),this.stream.onMessage((l=>{i((()=>++this.F_==1?this.H_(l):this.onNext(l)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return We(O2,`close with error: ${e}`),this.stream=null,this.close(4,e)}Q_(e){return t=>{this.Ci.enqueueAndForget((()=>this.D_===e?t():(We(O2,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class nI extends Lx{constructor(e,t,i,l,u,h){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,i,l,h),this.serializer=u}j_(e,t){return this.connection.T_("Listen",e,t)}H_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=l4(this.serializer,e),i=(function(u){if(!("targetChange"in u))return jt.min();const h=u.targetChange;return h.targetIds&&h.targetIds.length?jt.min():h.readTime?xi(h.readTime):jt.min()})(e);return this.listener.J_(t,i)}Z_(e){const t={};t.database=hg(this.serializer),t.addTarget=(function(u,h){let p;const g=h.target;if(p=ag(g)?{documents:h4(u,g)}:{query:d4(u,g).ft},p.targetId=h.targetId,h.resumeToken.approximateByteSize()>0){p.resumeToken=xx(u,h.resumeToken);const y=lg(u,h.expectedCount);y!==null&&(p.expectedCount=y)}else if(h.snapshotVersion.compareTo(jt.min())>0){p.readTime=Ld(u,h.snapshotVersion.toTimestamp());const y=lg(u,h.expectedCount);y!==null&&(p.expectedCount=y)}return p})(this.serializer,e);const i=m4(this.serializer,e);i&&(t.labels=i),this.K_(t)}X_(e){const t={};t.database=hg(this.serializer),t.removeTarget=e,this.K_(t)}}class sI extends Lx{constructor(e,t,i,l,u,h){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,l,h),this.serializer=u}get Y_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.Y_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}H_(e){return mn(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,mn(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){mn(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=u4(e.writeResults,e.commitTime),i=xi(e.commitTime);return this.listener.na(i,t)}ra(){const e={};e.database=hg(this.serializer),this.K_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((i=>c4(this.serializer,i)))};this.K_(t)}}class rI{}class iI extends rI{constructor(e,t,i,l){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=l,this.ia=!1}sa(){if(this.ia)throw new Ve(fe.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,i,l){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([u,h])=>this.connection.Wo(e,cg(t,i),l,u,h))).catch((u=>{throw u.name==="FirebaseError"?(u.code===fe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),u):new Ve(fe.UNKNOWN,u.toString())}))}jo(e,t,i,l,u){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([h,p])=>this.connection.jo(e,cg(t,i),l,h,p,u))).catch((h=>{throw h.name==="FirebaseError"?(h.code===fe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),h):new Ve(fe.UNKNOWN,h.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}function aI(s,e,t,i){return new iI(s,e,t,i)}class oI{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(ta(t),this.aa=!1):We("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const Lo="RemoteStore";class lI{constructor(e,t,i,l,u){this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.Ra=[],this.Aa=u,this.Aa.Mo((h=>{i.enqueueAndForget((async()=>{Bo(this)&&(We(Lo,"Restarting streams for network reachability change."),await(async function(g){const y=Nt(g);y.Ea.add(4),await Tu(y),y.Va.set("Unknown"),y.Ea.delete(4),await of(y)})(this))}))})),this.Va=new oI(i,l)}}async function of(s){if(Bo(s))for(const e of s.Ra)await e(!0)}async function Tu(s){for(const e of s.Ra)await e(!1)}function Ox(s,e){const t=Nt(s);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),cy(t)?ly(t):Wl(t).O_()&&oy(t,e))}function ay(s,e){const t=Nt(s),i=Wl(t);t.Ia.delete(e),i.O_()&&Px(t,e),t.Ia.size===0&&(i.O_()?i.L_():Bo(t)&&t.Va.set("Unknown"))}function oy(s,e){if(s.da.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(jt.min())>0){const t=s.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Wl(s).Z_(e)}function Px(s,e){s.da.$e(e),Wl(s).X_(e)}function ly(s){s.da=new t4({getRemoteKeysForTarget:e=>s.remoteSyncer.getRemoteKeysForTarget(e),At:e=>s.Ia.get(e)||null,ht:()=>s.datastore.serializer.databaseId}),Wl(s).start(),s.Va.ua()}function cy(s){return Bo(s)&&!Wl(s).x_()&&s.Ia.size>0}function Bo(s){return Nt(s).Ea.size===0}function Vx(s){s.da=void 0}async function cI(s){s.Va.set("Online")}async function uI(s){s.Ia.forEach(((e,t)=>{oy(s,e)}))}async function hI(s,e){Vx(s),cy(s)?(s.Va.ha(e),ly(s)):s.Va.set("Unknown")}async function dI(s,e,t){if(s.Va.set("Online"),e instanceof wx&&e.state===2&&e.cause)try{await(async function(l,u){const h=u.cause;for(const p of u.targetIds)l.Ia.has(p)&&(await l.remoteSyncer.rejectListen(p,h),l.Ia.delete(p),l.da.removeTarget(p))})(s,e)}catch(i){We(Lo,"Failed to remove targets %s: %s ",e.targetIds.join(","),i),await Pd(s,i)}else if(e instanceof yd?s.da.Xe(e):e instanceof _x?s.da.st(e):s.da.tt(e),!t.isEqual(jt.min()))try{const i=await Dx(s.localStore);t.compareTo(i)>=0&&await(function(u,h){const p=u.da.Tt(h);return p.targetChanges.forEach(((g,y)=>{if(g.resumeToken.approximateByteSize()>0){const b=u.Ia.get(y);b&&u.Ia.set(y,b.withResumeToken(g.resumeToken,h))}})),p.targetMismatches.forEach(((g,y)=>{const b=u.Ia.get(g);if(!b)return;u.Ia.set(g,b.withResumeToken(Ps.EMPTY_BYTE_STRING,b.snapshotVersion)),Px(u,g);const E=new Va(b.target,g,y,b.sequenceNumber);oy(u,E)})),u.remoteSyncer.applyRemoteEvent(p)})(s,t)}catch(i){We(Lo,"Failed to raise snapshot:",i),await Pd(s,i)}}async function Pd(s,e,t){if(!Hl(e))throw e;s.Ea.add(1),await Tu(s),s.Va.set("Offline"),t||(t=()=>Dx(s.localStore)),s.asyncQueue.enqueueRetryable((async()=>{We(Lo,"Retrying IndexedDB access"),await t(),s.Ea.delete(1),await of(s)}))}function Ux(s,e){return e().catch((t=>Pd(s,t,e)))}async function lf(s){const e=Nt(s),t=Qa(e);let i=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Gg;for(;fI(e);)try{const l=await G4(e.localStore,i);if(l===null){e.Ta.length===0&&t.L_();break}i=l.batchId,mI(e,l)}catch(l){await Pd(e,l)}Bx(e)&&zx(e)}function fI(s){return Bo(s)&&s.Ta.length<10}function mI(s,e){s.Ta.push(e);const t=Qa(s);t.O_()&&t.Y_&&t.ea(e.mutations)}function Bx(s){return Bo(s)&&!Qa(s).x_()&&s.Ta.length>0}function zx(s){Qa(s).start()}async function pI(s){Qa(s).ra()}async function gI(s){const e=Qa(s);for(const t of s.Ta)e.ea(t.mutations)}async function yI(s,e,t){const i=s.Ta.shift(),l=Zg.from(i,e,t);await Ux(s,(()=>s.remoteSyncer.applySuccessfulWrite(l))),await lf(s)}async function vI(s,e){e&&Qa(s).Y_&&await(async function(i,l){if((function(h){return JR(h)&&h!==fe.ABORTED})(l.code)){const u=i.Ta.shift();Qa(i).B_(),await Ux(i,(()=>i.remoteSyncer.rejectFailedWrite(u.batchId,l))),await lf(i)}})(s,e),Bx(s)&&zx(s)}async function P2(s,e){const t=Nt(s);t.asyncQueue.verifyOperationInProgress(),We(Lo,"RemoteStore received new credentials");const i=Bo(t);t.Ea.add(3),await Tu(t),i&&t.Va.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await of(t)}async function bI(s,e){const t=Nt(s);e?(t.Ea.delete(2),await of(t)):e||(t.Ea.add(2),await Tu(t),t.Va.set("Unknown"))}function Wl(s){return s.ma||(s.ma=(function(t,i,l){const u=Nt(t);return u.sa(),new nI(i,u.connection,u.authCredentials,u.appCheckCredentials,u.serializer,l)})(s.datastore,s.asyncQueue,{Zo:cI.bind(null,s),Yo:uI.bind(null,s),t_:hI.bind(null,s),J_:dI.bind(null,s)}),s.Ra.push((async e=>{e?(s.ma.B_(),cy(s)?ly(s):s.Va.set("Unknown")):(await s.ma.stop(),Vx(s))}))),s.ma}function Qa(s){return s.fa||(s.fa=(function(t,i,l){const u=Nt(t);return u.sa(),new sI(i,u.connection,u.authCredentials,u.appCheckCredentials,u.serializer,l)})(s.datastore,s.asyncQueue,{Zo:()=>Promise.resolve(),Yo:pI.bind(null,s),t_:vI.bind(null,s),ta:gI.bind(null,s),na:yI.bind(null,s)}),s.Ra.push((async e=>{e?(s.fa.B_(),await lf(s)):(await s.fa.stop(),s.Ta.length>0&&(We(Lo,`Stopping write stream with ${s.Ta.length} pending writes`),s.Ta=[]))}))),s.fa}class uy{constructor(e,t,i,l,u){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=l,this.removalCallback=u,this.deferred=new Xi,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((h=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,l,u){const h=Date.now()+i,p=new uy(e,t,h,l,u);return p.start(i),p}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Ve(fe.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function hy(s,e){if(ta("AsyncQueue",`${e}: ${s}`),Hl(s))return new Ve(fe.UNAVAILABLE,`${e}: ${s}`);throw s}class Rl{static emptySet(e){return new Rl(e.comparator)}constructor(e){this.comparator=e?(t,i)=>e(t,i)||ot.comparator(t.key,i.key):(t,i)=>ot.comparator(t.key,i.key),this.keyedMap=Fc(),this.sortedSet=new Qn(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,i)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Rl)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;t.hasNext();){const l=t.getNext().key,u=i.getNext().key;if(!l.isEqual(u))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const i=new Rl;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=t,i}}class V2{constructor(){this.ga=new Qn(ot.comparator)}track(e){const t=e.doc.key,i=this.ga.get(t);i?e.type!==0&&i.type===3?this.ga=this.ga.insert(t,e):e.type===3&&i.type!==1?this.ga=this.ga.insert(t,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.ga=this.ga.remove(t):e.type===1&&i.type===2?this.ga=this.ga.insert(t,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):wt(63341,{Vt:e,pa:i}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,i)=>{e.push(i)})),e}}class Pl{constructor(e,t,i,l,u,h,p,g,y){this.query=e,this.docs=t,this.oldDocs=i,this.docChanges=l,this.mutatedKeys=u,this.fromCache=h,this.syncStateChanged=p,this.excludesMetadataChanges=g,this.hasCachedResults=y}static fromInitialDocuments(e,t,i,l,u){const h=[];return t.forEach((p=>{h.push({type:0,doc:p})})),new Pl(e,t,Rl.emptySet(t),h,i,l,!0,!1,u)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Zd(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,i=e.docChanges;if(t.length!==i.length)return!1;for(let l=0;l<t.length;l++)if(t[l].type!==i[l].type||!t[l].doc.isEqual(i[l].doc))return!1;return!0}}class _I{constructor(){this.wa=void 0,this.ba=[]}Sa(){return this.ba.some((e=>e.Da()))}}class wI{constructor(){this.queries=U2(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,i){const l=Nt(t),u=l.queries;l.queries=U2(),u.forEach(((h,p)=>{for(const g of p.ba)g.onError(i)}))})(this,new Ve(fe.ABORTED,"Firestore shutting down"))}}function U2(){return new Uo((s=>ix(s)),Zd)}async function dy(s,e){const t=Nt(s);let i=3;const l=e.query;let u=t.queries.get(l);u?!u.Sa()&&e.Da()&&(i=2):(u=new _I,i=e.Da()?0:1);try{switch(i){case 0:u.wa=await t.onListen(l,!0);break;case 1:u.wa=await t.onListen(l,!1);break;case 2:await t.onFirstRemoteStoreListen(l)}}catch(h){const p=hy(h,`Initialization of query '${El(e.query)}' failed`);return void e.onError(p)}t.queries.set(l,u),u.ba.push(e),e.va(t.onlineState),u.wa&&e.Fa(u.wa)&&my(t)}async function fy(s,e){const t=Nt(s),i=e.query;let l=3;const u=t.queries.get(i);if(u){const h=u.ba.indexOf(e);h>=0&&(u.ba.splice(h,1),u.ba.length===0?l=e.Da()?0:1:!u.Sa()&&e.Da()&&(l=2))}switch(l){case 0:return t.queries.delete(i),t.onUnlisten(i,!0);case 1:return t.queries.delete(i),t.onUnlisten(i,!1);case 2:return t.onLastRemoteStoreUnlisten(i);default:return}}function xI(s,e){const t=Nt(s);let i=!1;for(const l of e){const u=l.query,h=t.queries.get(u);if(h){for(const p of h.ba)p.Fa(l)&&(i=!0);h.wa=l}}i&&my(t)}function EI(s,e,t){const i=Nt(s),l=i.queries.get(e);if(l)for(const u of l.ba)u.onError(t);i.queries.delete(e)}function my(s){s.Ca.forEach((e=>{e.next()}))}var mg,B2;(B2=mg||(mg={})).Ma="default",B2.Cache="cache";class py{constructor(e,t,i){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=i||{}}Fa(e){if(!this.options.includeMetadataChanges){const i=[];for(const l of e.docChanges)l.type!==3&&i.push(l);e=new Pl(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const i=t!=="Offline";return(!this.options.Ka||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=Pl.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==mg.Cache}}class Fx{constructor(e){this.key=e}}class qx{constructor(e){this.key=e}}class TI{constructor(e,t){this.query=e,this.Za=t,this.Xa=null,this.hasCachedResults=!1,this.current=!1,this.Ya=Kt(),this.mutatedKeys=Kt(),this.eu=ax(e),this.tu=new Rl(this.eu)}get nu(){return this.Za}ru(e,t){const i=t?t.iu:new V2,l=t?t.tu:this.tu;let u=t?t.mutatedKeys:this.mutatedKeys,h=l,p=!1;const g=this.query.limitType==="F"&&l.size===this.query.limit?l.last():null,y=this.query.limitType==="L"&&l.size===this.query.limit?l.first():null;if(e.inorderTraversal(((b,E)=>{const T=l.get(b),O=ef(this.query,E)?E:null,H=!!T&&this.mutatedKeys.has(T.key),q=!!O&&(O.hasLocalMutations||this.mutatedKeys.has(O.key)&&O.hasCommittedMutations);let B=!1;T&&O?T.data.isEqual(O.data)?H!==q&&(i.track({type:3,doc:O}),B=!0):this.su(T,O)||(i.track({type:2,doc:O}),B=!0,(g&&this.eu(O,g)>0||y&&this.eu(O,y)<0)&&(p=!0)):!T&&O?(i.track({type:0,doc:O}),B=!0):T&&!O&&(i.track({type:1,doc:T}),B=!0,(g||y)&&(p=!0)),B&&(O?(h=h.add(O),u=q?u.add(b):u.delete(b)):(h=h.delete(b),u=u.delete(b)))})),this.query.limit!==null)for(;h.size>this.query.limit;){const b=this.query.limitType==="F"?h.last():h.first();h=h.delete(b.key),u=u.delete(b.key),i.track({type:1,doc:b})}return{tu:h,iu:i,Ss:p,mutatedKeys:u}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,i,l){const u=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const h=e.iu.ya();h.sort(((b,E)=>(function(O,H){const q=B=>{switch(B){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return wt(20277,{Vt:B})}};return q(O)-q(H)})(b.type,E.type)||this.eu(b.doc,E.doc))),this.ou(i),l=l??!1;const p=t&&!l?this._u():[],g=this.Ya.size===0&&this.current&&!l?1:0,y=g!==this.Xa;return this.Xa=g,h.length!==0||y?{snapshot:new Pl(this.query,e.tu,u,h,e.mutatedKeys,g===0,y,!1,!!i&&i.resumeToken.approximateByteSize()>0),au:p}:{au:p}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new V2,mutatedKeys:this.mutatedKeys,Ss:!1},!1)):{au:[]}}uu(e){return!this.Za.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Za=this.Za.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Za=this.Za.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Ya;this.Ya=Kt(),this.tu.forEach((i=>{this.uu(i.key)&&(this.Ya=this.Ya.add(i.key))}));const t=[];return e.forEach((i=>{this.Ya.has(i)||t.push(new qx(i))})),this.Ya.forEach((i=>{e.has(i)||t.push(new Fx(i))})),t}cu(e){this.Za=e.ks,this.Ya=Kt();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return Pl.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Xa===0,this.hasCachedResults)}}const gy="SyncEngine";class kI{constructor(e,t,i){this.query=e,this.targetId=t,this.view=i}}class SI{constructor(e){this.key=e,this.hu=!1}}class jI{constructor(e,t,i,l,u,h){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=l,this.currentUser=u,this.maxConcurrentLimboResolutions=h,this.Pu={},this.Tu=new Uo((p=>ix(p)),Zd),this.Iu=new Map,this.Eu=new Set,this.Ru=new Qn(ot.comparator),this.Au=new Map,this.Vu=new ny,this.du={},this.mu=new Map,this.fu=Ol.ar(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function CI(s,e,t=!0){const i=Yx(s);let l;const u=i.Tu.get(e);return u?(i.sharedClientState.addLocalQueryTarget(u.targetId),l=u.view.lu()):l=await Hx(i,e,t,!0),l}async function NI(s,e){const t=Yx(s);await Hx(t,e,!0,!1)}async function Hx(s,e,t,i){const l=await K4(s.localStore,wi(e)),u=l.targetId,h=s.sharedClientState.addLocalQueryTarget(u,t);let p;return i&&(p=await AI(s,e,u,h==="current",l.resumeToken)),s.isPrimaryClient&&t&&Ox(s.remoteStore,l),p}async function AI(s,e,t,i,l){s.pu=(E,T,O)=>(async function(q,B,te,W){let ee=B.view.ru(te);ee.Ss&&(ee=await I2(q.localStore,B.query,!1).then((({documents:A})=>B.view.ru(A,ee))));const pe=W&&W.targetChanges.get(B.targetId),Te=W&&W.targetMismatches.get(B.targetId)!=null,ve=B.view.applyChanges(ee,q.isPrimaryClient,pe,Te);return F2(q,B.targetId,ve.au),ve.snapshot})(s,E,T,O);const u=await I2(s.localStore,e,!0),h=new TI(e,u.ks),p=h.ru(u.documents),g=Eu.createSynthesizedTargetChangeForCurrentChange(t,i&&s.onlineState!=="Offline",l),y=h.applyChanges(p,s.isPrimaryClient,g);F2(s,t,y.au);const b=new kI(e,t,h);return s.Tu.set(e,b),s.Iu.has(t)?s.Iu.get(t).push(e):s.Iu.set(t,[e]),y.snapshot}async function RI(s,e,t){const i=Nt(s),l=i.Tu.get(e),u=i.Iu.get(l.targetId);if(u.length>1)return i.Iu.set(l.targetId,u.filter((h=>!Zd(h,e)))),void i.Tu.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(l.targetId),i.sharedClientState.isActiveQueryTarget(l.targetId)||await dg(i.localStore,l.targetId,!1).then((()=>{i.sharedClientState.clearQueryState(l.targetId),t&&ay(i.remoteStore,l.targetId),pg(i,l.targetId)})).catch(ql)):(pg(i,l.targetId),await dg(i.localStore,l.targetId,!0))}async function II(s,e){const t=Nt(s),i=t.Tu.get(e),l=t.Iu.get(i.targetId);t.isPrimaryClient&&l.length===1&&(t.sharedClientState.removeLocalQueryTarget(i.targetId),ay(t.remoteStore,i.targetId))}async function DI(s,e,t){const i=BI(s);try{const l=await(function(h,p){const g=Nt(h),y=Gt.now(),b=p.reduce(((O,H)=>O.add(H.key)),Kt());let E,T;return g.persistence.runTransaction("Locally write mutations","readwrite",(O=>{let H=na(),q=Kt();return g.xs.getEntries(O,b).next((B=>{H=B,H.forEach(((te,W)=>{W.isValidDocument()||(q=q.add(te))}))})).next((()=>g.localDocuments.getOverlayedDocuments(O,H))).next((B=>{E=B;const te=[];for(const W of p){const ee=GR(W,E.get(W.key).overlayedDocument);ee!=null&&te.push(new to(W.key,ee,Xw(ee.value.mapValue),tr.exists(!0)))}return g.mutationQueue.addMutationBatch(O,y,te,p)})).next((B=>{T=B;const te=B.applyToLocalDocumentSet(E,q);return g.documentOverlayCache.saveOverlays(O,B.batchId,te)}))})).then((()=>({batchId:T.batchId,changes:lx(E)})))})(i.localStore,e);i.sharedClientState.addPendingMutation(l.batchId),(function(h,p,g){let y=h.du[h.currentUser.toKey()];y||(y=new Qn(Wt)),y=y.insert(p,g),h.du[h.currentUser.toKey()]=y})(i,l.batchId,t),await ku(i,l.changes),await lf(i.remoteStore)}catch(l){const u=hy(l,"Failed to persist write");t.reject(u)}}async function $x(s,e){const t=Nt(s);try{const i=await $4(t.localStore,e);e.targetChanges.forEach(((l,u)=>{const h=t.Au.get(u);h&&(mn(l.addedDocuments.size+l.modifiedDocuments.size+l.removedDocuments.size<=1,22616),l.addedDocuments.size>0?h.hu=!0:l.modifiedDocuments.size>0?mn(h.hu,14607):l.removedDocuments.size>0&&(mn(h.hu,42227),h.hu=!1))})),await ku(t,i,e)}catch(i){await ql(i)}}function z2(s,e,t){const i=Nt(s);if(i.isPrimaryClient&&t===0||!i.isPrimaryClient&&t===1){const l=[];i.Tu.forEach(((u,h)=>{const p=h.view.va(e);p.snapshot&&l.push(p.snapshot)})),(function(h,p){const g=Nt(h);g.onlineState=p;let y=!1;g.queries.forEach(((b,E)=>{for(const T of E.ba)T.va(p)&&(y=!0)})),y&&my(g)})(i.eventManager,e),l.length&&i.Pu.J_(l),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function MI(s,e,t){const i=Nt(s);i.sharedClientState.updateQueryState(e,"rejected",t);const l=i.Au.get(e),u=l&&l.key;if(u){let h=new Qn(ot.comparator);h=h.insert(u,$s.newNoDocument(u,jt.min()));const p=Kt().add(u),g=new rf(jt.min(),new Map,new Qn(Wt),h,p);await $x(i,g),i.Ru=i.Ru.remove(u),i.Au.delete(e),yy(i)}else await dg(i.localStore,e,!1).then((()=>pg(i,e,t))).catch(ql)}async function LI(s,e){const t=Nt(s),i=e.batch.batchId;try{const l=await H4(t.localStore,e);Gx(t,i,null),Wx(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),await ku(t,l)}catch(l){await ql(l)}}async function OI(s,e,t){const i=Nt(s);try{const l=await(function(h,p){const g=Nt(h);return g.persistence.runTransaction("Reject batch","readwrite-primary",(y=>{let b;return g.mutationQueue.lookupMutationBatch(y,p).next((E=>(mn(E!==null,37113),b=E.keys(),g.mutationQueue.removeMutationBatch(y,E)))).next((()=>g.mutationQueue.performConsistencyCheck(y))).next((()=>g.documentOverlayCache.removeOverlaysForBatchId(y,b,p))).next((()=>g.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(y,b))).next((()=>g.localDocuments.getDocuments(y,b)))}))})(i.localStore,e);Gx(i,e,t),Wx(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),await ku(i,l)}catch(l){await ql(l)}}function Wx(s,e){(s.mu.get(e)||[]).forEach((t=>{t.resolve()})),s.mu.delete(e)}function Gx(s,e,t){const i=Nt(s);let l=i.du[i.currentUser.toKey()];if(l){const u=l.get(e);u&&(t?u.reject(t):u.resolve(),l=l.remove(e)),i.du[i.currentUser.toKey()]=l}}function pg(s,e,t=null){s.sharedClientState.removeLocalQueryTarget(e);for(const i of s.Iu.get(e))s.Tu.delete(i),t&&s.Pu.yu(i,t);s.Iu.delete(e),s.isPrimaryClient&&s.Vu.Gr(e).forEach((i=>{s.Vu.containsKey(i)||Kx(s,i)}))}function Kx(s,e){s.Eu.delete(e.path.canonicalString());const t=s.Ru.get(e);t!==null&&(ay(s.remoteStore,t),s.Ru=s.Ru.remove(e),s.Au.delete(t),yy(s))}function F2(s,e,t){for(const i of t)i instanceof Fx?(s.Vu.addReference(i.key,e),PI(s,i)):i instanceof qx?(We(gy,"Document no longer in limbo: "+i.key),s.Vu.removeReference(i.key,e),s.Vu.containsKey(i.key)||Kx(s,i.key)):wt(19791,{wu:i})}function PI(s,e){const t=e.key,i=t.path.canonicalString();s.Ru.get(t)||s.Eu.has(i)||(We(gy,"New document in limbo: "+t),s.Eu.add(i),yy(s))}function yy(s){for(;s.Eu.size>0&&s.Ru.size<s.maxConcurrentLimboResolutions;){const e=s.Eu.values().next().value;s.Eu.delete(e);const t=new ot(Dn.fromString(e)),i=s.fu.next();s.Au.set(i,new SI(t)),s.Ru=s.Ru.insert(t,i),Ox(s.remoteStore,new Va(wi(Jd(t.path)),i,"TargetPurposeLimboResolution",Yd.ce))}}async function ku(s,e,t){const i=Nt(s),l=[],u=[],h=[];i.Tu.isEmpty()||(i.Tu.forEach(((p,g)=>{h.push(i.pu(g,e,t).then((y=>{if((y||t)&&i.isPrimaryClient){const b=y?!y.fromCache:t?.targetChanges.get(g.targetId)?.current;i.sharedClientState.updateQueryState(g.targetId,b?"current":"not-current")}if(y){l.push(y);const b=ry.Es(g.targetId,y);u.push(b)}})))})),await Promise.all(h),i.Pu.J_(l),await(async function(g,y){const b=Nt(g);try{await b.persistence.runTransaction("notifyLocalViewChanges","readwrite",(E=>be.forEach(y,(T=>be.forEach(T.Ts,(O=>b.persistence.referenceDelegate.addReference(E,T.targetId,O))).next((()=>be.forEach(T.Is,(O=>b.persistence.referenceDelegate.removeReference(E,T.targetId,O)))))))))}catch(E){if(!Hl(E))throw E;We(iy,"Failed to update sequence numbers: "+E)}for(const E of y){const T=E.targetId;if(!E.fromCache){const O=b.vs.get(T),H=O.snapshotVersion,q=O.withLastLimboFreeSnapshotVersion(H);b.vs=b.vs.insert(T,q)}}})(i.localStore,u))}async function VI(s,e){const t=Nt(s);if(!t.currentUser.isEqual(e)){We(gy,"User change. New user:",e.toKey());const i=await Ix(t.localStore,e);t.currentUser=e,(function(u,h){u.mu.forEach((p=>{p.forEach((g=>{g.reject(new Ve(fe.CANCELLED,h))}))})),u.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await ku(t,i.Ns)}}function UI(s,e){const t=Nt(s),i=t.Au.get(e);if(i&&i.hu)return Kt().add(i.key);{let l=Kt();const u=t.Iu.get(e);if(!u)return l;for(const h of u){const p=t.Tu.get(h);l=l.unionWith(p.view.nu)}return l}}function Yx(s){const e=Nt(s);return e.remoteStore.remoteSyncer.applyRemoteEvent=$x.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=UI.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=MI.bind(null,e),e.Pu.J_=xI.bind(null,e.eventManager),e.Pu.yu=EI.bind(null,e.eventManager),e}function BI(s){const e=Nt(s);return e.remoteStore.remoteSyncer.applySuccessfulWrite=LI.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=OI.bind(null,e),e}class Vd{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=af(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return q4(this.persistence,new B4,e.initialUser,this.serializer)}Cu(e){return new Rx(sy.Vi,this.serializer)}Du(e){return new Q4}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Vd.provider={build:()=>new Vd};class zI extends Vd{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){mn(this.persistence.referenceDelegate instanceof Od,46915);const i=this.persistence.referenceDelegate.garbageCollector;return new k4(i,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?cr.withCacheSize(this.cacheSizeBytes):cr.DEFAULT;return new Rx((i=>Od.Vi(i,t)),this.serializer)}}class gg{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>z2(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=VI.bind(null,this.syncEngine),await bI(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new wI})()}createDatastore(e){const t=af(e.databaseInfo.databaseId),i=tI(e.databaseInfo);return aI(e.authCredentials,e.appCheckCredentials,i,t)}createRemoteStore(e){return(function(i,l,u,h,p){return new lI(i,l,u,h,p)})(this.localStore,this.datastore,e.asyncQueue,(t=>z2(this.syncEngine,t,0)),(function(){return L2.v()?new L2:new X4})())}createSyncEngine(e,t){return(function(l,u,h,p,g,y,b){const E=new jI(l,u,h,p,g,y);return b&&(E.gu=!0),E})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const i=Nt(t);We(Lo,"RemoteStore shutting down."),i.Ea.add(5),await Tu(i),i.Aa.shutdown(),i.Va.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}gg.provider={build:()=>new gg};class vy{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):ta("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}const Xa="FirestoreClient";class FI{constructor(e,t,i,l,u){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this._databaseInfo=l,this.user=Hs.UNAUTHENTICATED,this.clientId=Wg.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=u,this.authCredentials.start(i,(async h=>{We(Xa,"Received user=",h.uid),await this.authCredentialListener(h),this.user=h})),this.appCheckCredentials.start(i,(h=>(We(Xa,"Received new app check token=",h),this.appCheckCredentialListener(h,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this._databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Xi;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const i=hy(t,"Failed to shutdown persistence");e.reject(i)}})),e.promise}}async function jp(s,e){s.asyncQueue.verifyOperationInProgress(),We(Xa,"Initializing OfflineComponentProvider");const t=s.configuration;await e.initialize(t);let i=t.initialUser;s.setCredentialChangeListener((async l=>{i.isEqual(l)||(await Ix(e.localStore,l),i=l)})),e.persistence.setDatabaseDeletedListener((()=>s.terminate())),s._offlineComponents=e}async function q2(s,e){s.asyncQueue.verifyOperationInProgress();const t=await qI(s);We(Xa,"Initializing OnlineComponentProvider"),await e.initialize(t,s.configuration),s.setCredentialChangeListener((i=>P2(e.remoteStore,i))),s.setAppCheckTokenChangeListener(((i,l)=>P2(e.remoteStore,l))),s._onlineComponents=e}async function qI(s){if(!s._offlineComponents)if(s._uninitializedComponentsProvider){We(Xa,"Using user provided OfflineComponentProvider");try{await jp(s,s._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(l){return l.name==="FirebaseError"?l.code===fe.FAILED_PRECONDITION||l.code===fe.UNIMPLEMENTED:!(typeof DOMException<"u"&&l instanceof DOMException)||l.code===22||l.code===20||l.code===11})(t))throw t;Il("Error using user provided cache. Falling back to memory cache: "+t),await jp(s,new Vd)}}else We(Xa,"Using default OfflineComponentProvider"),await jp(s,new zI(void 0));return s._offlineComponents}async function Qx(s){return s._onlineComponents||(s._uninitializedComponentsProvider?(We(Xa,"Using user provided OnlineComponentProvider"),await q2(s,s._uninitializedComponentsProvider._online)):(We(Xa,"Using default OnlineComponentProvider"),await q2(s,new gg))),s._onlineComponents}function HI(s){return Qx(s).then((e=>e.syncEngine))}async function Ud(s){const e=await Qx(s),t=e.eventManager;return t.onListen=CI.bind(null,e.syncEngine),t.onUnlisten=RI.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=NI.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=II.bind(null,e.syncEngine),t}function $I(s,e,t,i){const l=new vy(i),u=new py(e,l,t);return s.asyncQueue.enqueueAndForget((async()=>dy(await Ud(s),u))),()=>{l.Nu(),s.asyncQueue.enqueueAndForget((async()=>fy(await Ud(s),u)))}}function WI(s,e,t={}){const i=new Xi;return s.asyncQueue.enqueueAndForget((async()=>(function(u,h,p,g,y){const b=new vy({next:T=>{b.Nu(),h.enqueueAndForget((()=>fy(u,E)));const O=T.docs.has(p);!O&&T.fromCache?y.reject(new Ve(fe.UNAVAILABLE,"Failed to get document because the client is offline.")):O&&T.fromCache&&g&&g.source==="server"?y.reject(new Ve(fe.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):y.resolve(T)},error:T=>y.reject(T)}),E=new py(Jd(p.path),b,{includeMetadataChanges:!0,Ka:!0});return dy(u,E)})(await Ud(s),s.asyncQueue,e,t,i))),i.promise}function GI(s,e,t={}){const i=new Xi;return s.asyncQueue.enqueueAndForget((async()=>(function(u,h,p,g,y){const b=new vy({next:T=>{b.Nu(),h.enqueueAndForget((()=>fy(u,E))),T.fromCache&&g.source==="server"?y.reject(new Ve(fe.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):y.resolve(T)},error:T=>y.reject(T)}),E=new py(p,b,{includeMetadataChanges:!0,Ka:!0});return dy(u,E)})(await Ud(s),s.asyncQueue,e,t,i))),i.promise}function KI(s,e){const t=new Xi;return s.asyncQueue.enqueueAndForget((async()=>DI(await HI(s),e,t))),t.promise}function Xx(s){const e={};return s.timeoutSeconds!==void 0&&(e.timeoutSeconds=s.timeoutSeconds),e}const YI="ComponentProvider",H2=new Map;function QI(s,e,t,i,l){return new gR(s,e,t,l.host,l.ssl,l.experimentalForceLongPolling,l.experimentalAutoDetectLongPolling,Xx(l.experimentalLongPollingOptions),l.useFetchStreams,l.isUsingEmulator,i)}const Jx="firestore.googleapis.com",$2=!0;class W2{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Ve(fe.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Jx,this.ssl=$2}else this.host=e.host,this.ssl=e.ssl??$2;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=Ax;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<E4)throw new Ve(fe.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}rR("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Xx(e.experimentalLongPollingOptions??{}),(function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new Ve(fe.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new Ve(fe.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new Ve(fe.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(i,l){return i.timeoutSeconds===l.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class cf{constructor(e,t,i,l){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=l,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new W2({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Ve(fe.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Ve(fe.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new W2(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(i){if(!i)return new KA;switch(i.type){case"firstParty":return new JA(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new Ve(fe.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const i=H2.get(t);i&&(We(YI,"Removing Datastore"),H2.delete(t),i.terminate())})(this),Promise.resolve()}}function XI(s,e,t,i={}){s=er(s,cf);const l=Ja(e),u=s._getSettings(),h={...u,emulatorOptions:s._getEmulatorOptions()},p=`${e}:${t}`;l&&(Ag(`https://${p}`),Rg("Firestore",!0)),u.host!==Jx&&u.host!==p&&Il("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const g={...u,host:p,ssl:l,emulatorOptions:i};if(!Ao(g,h)&&(s._setSettings(g),i.mockUserToken)){let y,b;if(typeof i.mockUserToken=="string")y=i.mockUserToken,b=Hs.MOCK_USER;else{y=W_(i.mockUserToken,s._app?.options.projectId);const E=i.mockUserToken.sub||i.mockUserToken.user_id;if(!E)throw new Ve(fe.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");b=new Hs(E)}s._authCredentials=new YA(new Uw(y,b))}}class aa{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new aa(this.firestore,e,this._query)}}class ts{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ha(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new ts(this.firestore,e,this._key)}toJSON(){return{type:ts._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,i){if(wu(t,ts._jsonSchema))return new ts(e,i||null,new ot(Dn.fromString(t.referencePath)))}}ts._jsonSchemaVersion="firestore/documentReference/1.0",ts._jsonSchema={type:_s("string",ts._jsonSchemaVersion),referencePath:_s("string")};class Ha extends aa{constructor(e,t,i){super(e,t,Jd(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new ts(this.firestore,null,new ot(e))}withConverter(e){return new Ha(this.firestore,e,this._path)}}function Mt(s,e,...t){if(s=Tn(s),Bw("collection","path",e),s instanceof cf){const i=Dn.fromString(e,...t);return i2(i),new Ha(s,null,i)}{if(!(s instanceof ts||s instanceof Ha))throw new Ve(fe.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=s._path.child(Dn.fromString(e,...t));return i2(i),new Ha(s.firestore,null,i)}}function nt(s,e,...t){if(s=Tn(s),arguments.length===1&&(e=Wg.newId()),Bw("doc","path",e),s instanceof cf){const i=Dn.fromString(e,...t);return r2(i),new ts(s,null,new ot(i))}{if(!(s instanceof ts||s instanceof Ha))throw new Ve(fe.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=s._path.child(Dn.fromString(e,...t));return r2(i),new ts(s.firestore,s instanceof Ha?s.converter:null,new ot(i))}}const G2="AsyncQueue";class K2{constructor(e=Promise.resolve()){this.Yu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new Mx(this,"async_queue_retry"),this._c=()=>{const i=Sp();i&&We(G2,"Visibility state changed to "+i.visibilityState),this.M_.w_()},this.ac=e;const t=Sp();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=Sp();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new Xi;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Yu.push(e),this.lc())))}async lc(){if(this.Yu.length!==0){try{await this.Yu[0](),this.Yu.shift(),this.M_.reset()}catch(e){if(!Hl(e))throw e;We(G2,"Operation failed with retryable error: "+e)}this.Yu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((i=>{throw this.nc=i,this.rc=!1,ta("INTERNAL UNHANDLED ERROR: ",Y2(i)),i})).then((i=>(this.rc=!1,i))))));return this.ac=t,t}enqueueAfterDelay(e,t,i){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const l=uy.createAndSchedule(this,e,t,i,(u=>this.hc(u)));return this.tc.push(l),l}uc(){this.nc&&wt(47125,{Pc:Y2(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,i)=>t.targetTimeMs-i.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}Rc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function Y2(s){let e=s.message||"";return s.stack&&(e=s.stack.includes(s.message)?s.stack:s.message+`
`+s.stack),e}class ki extends cf{constructor(e,t,i,l){super(e,t,i,l),this.type="firestore",this._queue=new K2,this._persistenceKey=l?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new K2(e),this._firestoreClient=void 0,await e}}}function JI(s,e){const t=typeof s=="object"?s:Lg(),i=typeof s=="string"?s:Rd,l=Hd(t,"firestore").getImmediate({identifier:i});if(!l._initialized){const u=q_("firestore");u&&XI(l,...u)}return l}function Su(s){if(s._terminated)throw new Ve(fe.FAILED_PRECONDITION,"The client has already been terminated.");return s._firestoreClient||ZI(s),s._firestoreClient}function ZI(s){const e=s._freezeSettings(),t=QI(s._databaseId,s._app?.options.appId||"",s._persistenceKey,s._app?.options.apiKey,e);s._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(s._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),s._firestoreClient=new FI(s._authCredentials,s._appCheckCredentials,s._queue,t,s._componentsProvider&&(function(l){const u=l?._online.build();return{_offline:l?._offline.build(u),_online:u}})(s._componentsProvider))}class $r{constructor(e){this._byteString=e}static fromBase64String(e){try{return new $r(Ps.fromBase64String(e))}catch(t){throw new Ve(fe.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new $r(Ps.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:$r._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(wu(e,$r._jsonSchema))return $r.fromBase64String(e.bytes)}}$r._jsonSchemaVersion="firestore/bytes/1.0",$r._jsonSchema={type:_s("string",$r._jsonSchemaVersion),bytes:_s("string")};class uf{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new Ve(fe.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ls(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class ju{constructor(e){this._methodName=e}}class Ei{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Ve(fe.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Ve(fe.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Wt(this._lat,e._lat)||Wt(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Ei._jsonSchemaVersion}}static fromJSON(e){if(wu(e,Ei._jsonSchema))return new Ei(e.latitude,e.longitude)}}Ei._jsonSchemaVersion="firestore/geoPoint/1.0",Ei._jsonSchema={type:_s("string",Ei._jsonSchemaVersion),latitude:_s("number"),longitude:_s("number")};class ni{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(i,l){if(i.length!==l.length)return!1;for(let u=0;u<i.length;++u)if(i[u]!==l[u])return!1;return!0})(this._values,e._values)}toJSON(){return{type:ni._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(wu(e,ni._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new ni(e.vectorValues);throw new Ve(fe.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}ni._jsonSchemaVersion="firestore/vectorValue/1.0",ni._jsonSchema={type:_s("string",ni._jsonSchemaVersion),vectorValues:_s("object")};const eD=/^__.*__$/;class tD{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return this.fieldMask!==null?new to(e,this.data,this.fieldMask,t,this.fieldTransforms):new xu(e,this.data,t,this.fieldTransforms)}}class Zx{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return new to(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function eE(s){switch(s){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw wt(40011,{dataSource:s})}}class by{constructor(e,t,i,l,u,h){this.settings=e,this.databaseId=t,this.serializer=i,this.ignoreUndefinedProperties=l,u===void 0&&this.validatePath(),this.fieldTransforms=u||[],this.fieldMask=h||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(e){return new by({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(e){const t=this.path?.child(e),i=this.contextWith({path:t,arrayElement:!1});return i.validatePathSegment(e),i}childContextForFieldPath(e){const t=this.path?.child(e),i=this.contextWith({path:t,arrayElement:!1});return i.validatePath(),i}childContextForArray(e){return this.contextWith({path:void 0,arrayElement:!0})}createError(e){return Bd(e,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}validatePath(){if(this.path)for(let e=0;e<this.path.length;e++)this.validatePathSegment(this.path.get(e))}validatePathSegment(e){if(e.length===0)throw this.createError("Document fields must not be empty");if(eE(this.dataSource)&&eD.test(e))throw this.createError('Document fields cannot begin and end with "__"')}}class nD{constructor(e,t,i){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=i||af(e)}createContext(e,t,i,l=!1){return new by({dataSource:e,methodName:t,targetDoc:i,path:Ls.emptyPath(),arrayElement:!1,hasConverter:l},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Cu(s){const e=s._freezeSettings(),t=af(s._databaseId);return new nD(s._databaseId,!!e.ignoreUndefinedProperties,t)}function _y(s,e,t,i,l,u={}){const h=s.createContext(u.merge||u.mergeFields?2:0,e,t,l);Ey("Data must be an object, but it was:",h,i);const p=sE(i,h);let g,y;if(u.merge)g=new Tr(h.fieldMask),y=h.fieldTransforms;else if(u.mergeFields){const b=[];for(const E of u.mergeFields){const T=Oo(e,E,t);if(!h.contains(T))throw new Ve(fe.INVALID_ARGUMENT,`Field '${T}' is specified in your field mask but missing from your input data.`);aE(b,T)||b.push(T)}g=new Tr(b),y=h.fieldTransforms.filter((E=>g.covers(E.field)))}else g=null,y=h.fieldTransforms;return new tD(new ur(p),g,y)}class hf extends ju{_toFieldTransform(e){if(e.dataSource!==2)throw e.dataSource===1?e.createError(`${this._methodName}() can only appear at the top level of your update data`):e.createError(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof hf}}class wy extends ju{_toFieldTransform(e){return new gx(e.path,new ou)}isEqual(e){return e instanceof wy}}class xy extends ju{constructor(e,t){super(e),this.Vc=t}_toFieldTransform(e){const t=new uu(e.serializer,hx(e.serializer,this.Vc));return new gx(e.path,t)}isEqual(e){return e instanceof xy&&this.Vc===e.Vc}}function tE(s,e,t,i){const l=s.createContext(1,e,t);Ey("Data must be an object, but it was:",l,i);const u=[],h=ur.empty();eo(i,((g,y)=>{const b=iE(e,g,t);y=Tn(y);const E=l.childContextForFieldPath(b);if(y instanceof hf)u.push(b);else{const T=Nu(y,E);T!=null&&(u.push(b),h.set(b,T))}}));const p=new Tr(u);return new Zx(h,p,l.fieldTransforms)}function nE(s,e,t,i,l,u){const h=s.createContext(1,e,t),p=[Oo(e,i,t)],g=[l];if(u.length%2!=0)throw new Ve(fe.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let T=0;T<u.length;T+=2)p.push(Oo(e,u[T])),g.push(u[T+1]);const y=[],b=ur.empty();for(let T=p.length-1;T>=0;--T)if(!aE(y,p[T])){const O=p[T];let H=g[T];H=Tn(H);const q=h.childContextForFieldPath(O);if(H instanceof hf)y.push(O);else{const B=Nu(H,q);B!=null&&(y.push(O),b.set(O,B))}}const E=new Tr(y);return new Zx(b,E,h.fieldTransforms)}function sD(s,e,t,i=!1){return Nu(t,s.createContext(i?4:3,e))}function Nu(s,e){if(rE(s=Tn(s)))return Ey("Unsupported field value:",e,s),sE(s,e);if(s instanceof ju)return(function(i,l){if(!eE(l.dataSource))throw l.createError(`${i._methodName}() can only be used with update() and set()`);if(!l.path)throw l.createError(`${i._methodName}() is not currently supported inside arrays`);const u=i._toFieldTransform(l);u&&l.fieldTransforms.push(u)})(s,e),null;if(s===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),s instanceof Array){if(e.settings.arrayElement&&e.dataSource!==4)throw e.createError("Nested arrays are not supported");return(function(i,l){const u=[];let h=0;for(const p of i){let g=Nu(p,l.childContextForArray(h));g==null&&(g={nullValue:"NULL_VALUE"}),u.push(g),h++}return{arrayValue:{values:u}}})(s,e)}return(function(i,l){if((i=Tn(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return hx(l.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const u=Gt.fromDate(i);return{timestampValue:Ld(l.serializer,u)}}if(i instanceof Gt){const u=new Gt(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:Ld(l.serializer,u)}}if(i instanceof Ei)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof $r)return{bytesValue:xx(l.serializer,i._byteString)};if(i instanceof ts){const u=l.databaseId,h=i.firestore._databaseId;if(!h.isEqual(u))throw l.createError(`Document reference is for database ${h.projectId}/${h.database} but should be for database ${u.projectId}/${u.database}`);return{referenceValue:ty(i.firestore._databaseId||l.databaseId,i._key.path)}}if(i instanceof ni)return(function(h,p){const g=h instanceof ni?h.toArray():h;return{mapValue:{fields:{[Yw]:{stringValue:Qw},[Id]:{arrayValue:{values:g.map((b=>{if(typeof b!="number")throw p.createError("VectorValues must only contain numeric values.");return Jg(p.serializer,b)}))}}}}}})(i,l);if(Nx(i))return i._toProto(l.serializer);throw l.createError(`Unsupported field value: ${Kd(i)}`)})(s,e)}function sE(s,e){const t={};return qw(s)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):eo(s,((i,l)=>{const u=Nu(l,e.childContextForField(i));u!=null&&(t[i]=u)})),{mapValue:{fields:t}}}function rE(s){return!(typeof s!="object"||s===null||s instanceof Array||s instanceof Date||s instanceof Gt||s instanceof Ei||s instanceof $r||s instanceof ts||s instanceof ju||s instanceof ni||Nx(s))}function Ey(s,e,t){if(!rE(t)||!zw(t)){const i=Kd(t);throw i==="an object"?e.createError(s+" a custom object"):e.createError(s+" "+i)}}function Oo(s,e,t){if((e=Tn(e))instanceof uf)return e._internalPath;if(typeof e=="string")return iE(s,e);throw Bd("Field path arguments must be of type string or ",s,!1,void 0,t)}const rD=new RegExp("[~\\*/\\[\\]]");function iE(s,e,t){if(e.search(rD)>=0)throw Bd(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,s,!1,void 0,t);try{return new uf(...e.split("."))._internalPath}catch{throw Bd(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,s,!1,void 0,t)}}function Bd(s,e,t,i,l){const u=i&&!i.isEmpty(),h=l!==void 0;let p=`Function ${e}() called with invalid data`;t&&(p+=" (via `toFirestore()`)"),p+=". ";let g="";return(u||h)&&(g+=" (found",u&&(g+=` in field ${i}`),h&&(g+=` in document ${l}`),g+=")"),new Ve(fe.INVALID_ARGUMENT,p+s+g)}function aE(s,e){return s.some((t=>t.isEqual(e)))}class iD{convertValue(e,t="none"){switch(Ya(e)){case 0:return null;case 1:return e.booleanValue;case 2:return hs(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Ka(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw wt(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const i={};return eo(e,((l,u)=>{i[l]=this.convertValue(u,t)})),i}convertVectorValue(e){const t=e.fields?.[Id].arrayValue?.values?.map((i=>hs(i.doubleValue)));return new ni(t)}convertGeoPoint(e){return new Ei(hs(e.latitude),hs(e.longitude))}convertArray(e,t){return(e.values||[]).map((i=>this.convertValue(i,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const i=Xd(e);return i==null?null:this.convertValue(i,t);case"estimate":return this.convertTimestamp(su(e));default:return null}}convertTimestamp(e){const t=Ga(e);return new Gt(t.seconds,t.nanos)}convertDocumentKey(e,t){const i=Dn.fromString(e);mn(Cx(i),9688,{name:e});const l=new ru(i.get(1),i.get(3)),u=new ot(i.popFirst(5));return l.isEqual(t)||ta(`Document ${u} contains a document reference within a different database (${l.projectId}/${l.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),u}}class Ty extends iD{constructor(e){super(),this.firestore=e}convertBytes(e){return new $r(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new ts(this.firestore,null,t)}}function hr(){return new wy("serverTimestamp")}function ko(s){return new xy("increment",s)}const Q2="@firebase/firestore",X2="4.10.0";function J2(s){return(function(t,i){if(typeof t!="object"||t===null)return!1;const l=t;for(const u of i)if(u in l&&typeof l[u]=="function")return!0;return!1})(s,["next","error","complete"])}class oE{constructor(e,t,i,l,u){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=l,this._converter=u}get id(){return this._key.path.lastSegment()}get ref(){return new ts(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new aD(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}_fieldsProto(){return this._document?.data.clone().value.mapValue.fields??void 0}get(e){if(this._document){const t=this._document.data.field(Oo("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class aD extends oE{data(){return super.data()}}function lE(s){if(s.limitType==="L"&&s.explicitOrderBy.length===0)throw new Ve(fe.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class ky{}class Sy extends ky{}function In(s,e,...t){let i=[];e instanceof ky&&i.push(e),i=i.concat(t),(function(u){const h=u.filter((g=>g instanceof jy)).length,p=u.filter((g=>g instanceof df)).length;if(h>1||h>0&&p>0)throw new Ve(fe.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(i);for(const l of i)s=l._apply(s);return s}class df extends Sy{constructor(e,t,i){super(),this._field=e,this._op=t,this._value=i,this.type="where"}static _create(e,t,i){return new df(e,t,i)}_apply(e){const t=this._parse(e);return cE(e._query,t),new aa(e.firestore,e.converter,og(e._query,t))}_parse(e){const t=Cu(e.firestore);return(function(u,h,p,g,y,b,E){let T;if(y.isKeyField()){if(b==="array-contains"||b==="array-contains-any")throw new Ve(fe.INVALID_ARGUMENT,`Invalid Query. You can't perform '${b}' queries on documentId().`);if(b==="in"||b==="not-in"){e_(E,b);const H=[];for(const q of E)H.push(Z2(g,u,q));T={arrayValue:{values:H}}}else T=Z2(g,u,E)}else b!=="in"&&b!=="not-in"&&b!=="array-contains-any"||e_(E,b),T=sD(p,h,E,b==="in"||b==="not-in");return bs.create(y,b,T)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function fn(s,e,t){const i=e,l=Oo("where",s);return df._create(l,i,t)}class jy extends ky{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new jy(e,t)}_parse(e){const t=this._queryConstraints.map((i=>i._parse(e))).filter((i=>i.getFilters().length>0));return t.length===1?t[0]:ri.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(l,u){let h=l;const p=u.getFlattenedFilters();for(const g of p)cE(h,g),h=og(h,g)})(e._query,t),new aa(e.firestore,e.converter,og(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Cy extends Sy{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new Cy(e,t)}_apply(e){const t=(function(l,u,h){if(l.startAt!==null)throw new Ve(fe.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(l.endAt!==null)throw new Ve(fe.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new au(u,h)})(e._query,this._field,this._direction);return new aa(e.firestore,e.converter,MR(e._query,t))}}function hu(s,e="asc"){const t=e,i=Oo("orderBy",s);return Cy._create(i,t)}class Ny extends Sy{constructor(e,t,i){super(),this.type=e,this._limit=t,this._limitType=i}static _create(e,t,i){return new Ny(e,t,i)}_apply(e){return new aa(e.firestore,e.converter,Md(e._query,this._limit,this._limitType))}}function du(s){return iR("limit",s),Ny._create("limit",s,"F")}function Z2(s,e,t){if(typeof(t=Tn(t))=="string"){if(t==="")throw new Ve(fe.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!rx(e)&&t.indexOf("/")!==-1)throw new Ve(fe.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const i=e.path.child(Dn.fromString(t));if(!ot.isDocumentKey(i))throw new Ve(fe.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return f2(s,new ot(i))}if(t instanceof ts)return f2(s,t._key);throw new Ve(fe.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Kd(t)}.`)}function e_(s,e){if(!Array.isArray(s)||s.length===0)throw new Ve(fe.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function cE(s,e){const t=(function(l,u){for(const h of l)for(const p of h.getFlattenedFilters())if(u.indexOf(p.op)>=0)return p.op;return null})(s.filters,(function(l){switch(l){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new Ve(fe.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Ve(fe.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}function Ay(s,e,t){let i;return i=s?t&&(t.merge||t.mergeFields)?s.toFirestore(e,t):s.toFirestore(e):e,i}class Hc{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class So extends oE{constructor(e,t,i,l,u,h){super(e,t,i,l,h),this._firestore=e,this._firestoreImpl=e,this.metadata=u}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new vd(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const i=this._document.data.field(Oo("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Ve(fe.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=So._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}So._jsonSchemaVersion="firestore/documentSnapshot/1.0",So._jsonSchema={type:_s("string",So._jsonSchemaVersion),bundleSource:_s("string","DocumentSnapshot"),bundleName:_s("string"),bundle:_s("string")};class vd extends So{data(e={}){return super.data(e)}}class jo{constructor(e,t,i,l){this._firestore=e,this._userDataWriter=t,this._snapshot=l,this.metadata=new Hc(l.hasPendingWrites,l.fromCache),this.query=i}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((i=>{e.call(t,new vd(this._firestore,this._userDataWriter,i.key,i,new Hc(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Ve(fe.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(l,u){if(l._snapshot.oldDocs.isEmpty()){let h=0;return l._snapshot.docChanges.map((p=>{const g=new vd(l._firestore,l._userDataWriter,p.doc.key,p.doc,new Hc(l._snapshot.mutatedKeys.has(p.doc.key),l._snapshot.fromCache),l.query.converter);return p.doc,{type:"added",doc:g,oldIndex:-1,newIndex:h++}}))}{let h=l._snapshot.oldDocs;return l._snapshot.docChanges.filter((p=>u||p.type!==3)).map((p=>{const g=new vd(l._firestore,l._userDataWriter,p.doc.key,p.doc,new Hc(l._snapshot.mutatedKeys.has(p.doc.key),l._snapshot.fromCache),l.query.converter);let y=-1,b=-1;return p.type!==0&&(y=h.indexOf(p.doc.key),h=h.delete(p.doc.key)),p.type!==1&&(h=h.add(p.doc),b=h.indexOf(p.doc.key)),{type:oD(p.type),doc:g,oldIndex:y,newIndex:b}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Ve(fe.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=jo._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Wg.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],i=[],l=[];return this.docs.forEach((u=>{u._document!==null&&(t.push(u._document),i.push(this._userDataWriter.convertObjectMap(u._document.data.value.mapValue.fields,"previous")),l.push(u.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function oD(s){switch(s){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return wt(61501,{type:s})}}jo._jsonSchemaVersion="firestore/querySnapshot/1.0",jo._jsonSchema={type:_s("string",jo._jsonSchemaVersion),bundleSource:_s("string","QuerySnapshot"),bundleName:_s("string"),bundle:_s("string")};class lD{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Cu(e)}set(e,t,i){this._verifyNotCommitted();const l=Cp(e,this._firestore),u=Ay(l.converter,t,i),h=_y(this._dataReader,"WriteBatch.set",l._key,u,l.converter!==null,i);return this._mutations.push(h.toMutation(l._key,tr.none())),this}update(e,t,i,...l){this._verifyNotCommitted();const u=Cp(e,this._firestore);let h;return h=typeof(t=Tn(t))=="string"||t instanceof uf?nE(this._dataReader,"WriteBatch.update",u._key,t,i,l):tE(this._dataReader,"WriteBatch.update",u._key,t),this._mutations.push(h.toMutation(u._key,tr.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=Cp(e,this._firestore);return this._mutations=this._mutations.concat(new sf(t._key,tr.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new Ve(fe.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Cp(s,e){if((s=Tn(s)).firestore!==e)throw new Ve(fe.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return s}function dr(s){s=er(s,ts);const e=er(s.firestore,ki),t=Su(e);return WI(t,s._key).then((i=>hE(e,s,i)))}function En(s){s=er(s,aa);const e=er(s.firestore,ki),t=Su(e),i=new Ty(e);return lE(s._query),GI(t,s._query).then((l=>new jo(e,i,s,l)))}function Os(s,e,t){s=er(s,ts);const i=er(s.firestore,ki),l=Ay(s.converter,e,t),u=Cu(i);return Au(i,[_y(u,"setDoc",s._key,l,s.converter!==null,t).toMutation(s._key,tr.none())])}function Hr(s,e,t,...i){s=er(s,ts);const l=er(s.firestore,ki),u=Cu(l);let h;return h=typeof(e=Tn(e))=="string"||e instanceof uf?nE(u,"updateDoc",s._key,e,t,i):tE(u,"updateDoc",s._key,e),Au(l,[h.toMutation(s._key,tr.exists(!0))])}function Er(s){return Au(er(s.firestore,ki),[new sf(s._key,tr.none())])}function ti(s,e){const t=er(s.firestore,ki),i=nt(s),l=Ay(s.converter,e),u=Cu(s.firestore);return Au(t,[_y(u,"addDoc",i._key,l,s.converter!==null,{}).toMutation(i._key,tr.exists(!1))]).then((()=>i))}function uE(s,...e){s=Tn(s);let t={includeMetadataChanges:!1,source:"default"},i=0;typeof e[i]!="object"||J2(e[i])||(t=e[i++]);const l={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(J2(e[i])){const y=e[i];e[i]=y.next?.bind(y),e[i+1]=y.error?.bind(y),e[i+2]=y.complete?.bind(y)}let u,h,p;if(s instanceof ts)h=er(s.firestore,ki),p=Jd(s._key.path),u={next:y=>{e[i]&&e[i](hE(h,s,y))},error:e[i+1],complete:e[i+2]};else{const y=er(s,aa);h=er(y.firestore,ki),p=y._query;const b=new Ty(h);u={next:E=>{e[i]&&e[i](new jo(h,b,y,E))},error:e[i+1],complete:e[i+2]},lE(s._query)}const g=Su(h);return $I(g,p,l,u)}function Au(s,e){const t=Su(s);return KI(t,e)}function hE(s,e,t){const i=t.docs.get(e._key),l=new Ty(s);return new So(s,l,e._key,i,new Hc(t.hasPendingWrites,t.fromCache),e.converter)}function t_(s){return s=er(s,ki),Su(s),new lD(s,(e=>Au(s,e)))}(function(e,t=!0){GA(Vo),Ro(new $a("firestore",((i,{instanceIdentifier:l,options:u})=>{const h=i.getProvider("app").getImmediate(),p=new ki(new QA(i.getProvider("auth-internal")),new ZA(h,i.getProvider("app-check-internal")),yR(h,l),h);return u={useFetchStreams:t,...u},p._setSettings(u),p}),"PUBLIC").setMultipleInstances(!0)),vi(Q2,X2,e),vi(Q2,X2,"esm2020")})();var cD="firebase",uD="12.8.0";vi(cD,uD,"app");const dE="firebasestorage.googleapis.com",fE="storageBucket",hD=120*1e3,dD=600*1e3;class ss extends ji{constructor(e,t,i=0){super(Np(e),`Firebase Storage: ${t} (${Np(e)})`),this.status_=i,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,ss.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Np(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var ns;(function(s){s.UNKNOWN="unknown",s.OBJECT_NOT_FOUND="object-not-found",s.BUCKET_NOT_FOUND="bucket-not-found",s.PROJECT_NOT_FOUND="project-not-found",s.QUOTA_EXCEEDED="quota-exceeded",s.UNAUTHENTICATED="unauthenticated",s.UNAUTHORIZED="unauthorized",s.UNAUTHORIZED_APP="unauthorized-app",s.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",s.INVALID_CHECKSUM="invalid-checksum",s.CANCELED="canceled",s.INVALID_EVENT_NAME="invalid-event-name",s.INVALID_URL="invalid-url",s.INVALID_DEFAULT_BUCKET="invalid-default-bucket",s.NO_DEFAULT_BUCKET="no-default-bucket",s.CANNOT_SLICE_BLOB="cannot-slice-blob",s.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",s.NO_DOWNLOAD_URL="no-download-url",s.INVALID_ARGUMENT="invalid-argument",s.INVALID_ARGUMENT_COUNT="invalid-argument-count",s.APP_DELETED="app-deleted",s.INVALID_ROOT_OPERATION="invalid-root-operation",s.INVALID_FORMAT="invalid-format",s.INTERNAL_ERROR="internal-error",s.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(ns||(ns={}));function Np(s){return"storage/"+s}function Ry(){const s="An unknown error occurred, please check the error payload for server response.";return new ss(ns.UNKNOWN,s)}function fD(s){return new ss(ns.OBJECT_NOT_FOUND,"Object '"+s+"' does not exist.")}function mD(s){return new ss(ns.QUOTA_EXCEEDED,"Quota for bucket '"+s+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function pD(){const s="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new ss(ns.UNAUTHENTICATED,s)}function gD(){return new ss(ns.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function yD(s){return new ss(ns.UNAUTHORIZED,"User does not have permission to access '"+s+"'.")}function vD(){return new ss(ns.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function bD(){return new ss(ns.CANCELED,"User canceled the upload/download.")}function _D(s){return new ss(ns.INVALID_URL,"Invalid URL '"+s+"'.")}function wD(s){return new ss(ns.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+s+"'.")}function xD(){return new ss(ns.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+fE+"' property when initializing the app?")}function ED(){return new ss(ns.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function TD(){return new ss(ns.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function kD(s){return new ss(ns.UNSUPPORTED_ENVIRONMENT,`${s} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function yg(s){return new ss(ns.INVALID_ARGUMENT,s)}function mE(){return new ss(ns.APP_DELETED,"The Firebase app was deleted.")}function SD(s){return new ss(ns.INVALID_ROOT_OPERATION,"The operation '"+s+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function Xc(s,e){return new ss(ns.INVALID_FORMAT,"String does not match format '"+s+"': "+e)}function Lc(s){throw new ss(ns.INTERNAL_ERROR,"Internal error: "+s)}class Zs{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let i;try{i=Zs.makeFromUrl(e,t)}catch{return new Zs(e,"")}if(i.path==="")return i;throw wD(e)}static makeFromUrl(e,t){let i=null;const l="([A-Za-z0-9.\\-_]+)";function u(pe){pe.path.charAt(pe.path.length-1)==="/"&&(pe.path_=pe.path_.slice(0,-1))}const h="(/(.*))?$",p=new RegExp("^gs://"+l+h,"i"),g={bucket:1,path:3};function y(pe){pe.path_=decodeURIComponent(pe.path)}const b="v[A-Za-z0-9_]+",E=t.replace(/[.]/g,"\\."),T="(/([^?#]*).*)?$",O=new RegExp(`^https?://${E}/${b}/b/${l}/o${T}`,"i"),H={bucket:1,path:3},q=t===dE?"(?:storage.googleapis.com|storage.cloud.google.com)":t,B="([^?#]*)",te=new RegExp(`^https?://${q}/${l}/${B}`,"i"),ee=[{regex:p,indices:g,postModify:u},{regex:O,indices:H,postModify:y},{regex:te,indices:{bucket:1,path:2},postModify:y}];for(let pe=0;pe<ee.length;pe++){const Te=ee[pe],ve=Te.regex.exec(e);if(ve){const A=ve[Te.indices.bucket];let S=ve[Te.indices.path];S||(S=""),i=new Zs(A,S),Te.postModify(i);break}}if(i==null)throw _D(e);return i}}class jD{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function CD(s,e,t){let i=1,l=null,u=null,h=!1,p=0;function g(){return p===2}let y=!1;function b(...B){y||(y=!0,e.apply(null,B))}function E(B){l=setTimeout(()=>{l=null,s(O,g())},B)}function T(){u&&clearTimeout(u)}function O(B,...te){if(y){T();return}if(B){T(),b.call(null,B,...te);return}if(g()||h){T(),b.call(null,B,...te);return}i<64&&(i*=2);let ee;p===1?(p=2,ee=0):ee=(i+Math.random())*1e3,E(ee)}let H=!1;function q(B){H||(H=!0,T(),!y&&(l!==null?(B||(p=2),clearTimeout(l),E(0)):B||(p=1)))}return E(0),u=setTimeout(()=>{h=!0,q(!0)},t),q}function ND(s){s(!1)}function AD(s){return s!==void 0}function RD(s){return typeof s=="object"&&!Array.isArray(s)}function Iy(s){return typeof s=="string"||s instanceof String}function n_(s){return Dy()&&s instanceof Blob}function Dy(){return typeof Blob<"u"}function vg(s,e,t,i){if(i<e)throw yg(`Invalid value for '${s}'. Expected ${e} or greater.`);if(i>t)throw yg(`Invalid value for '${s}'. Expected ${t} or less.`)}function ff(s,e,t){let i=e;return t==null&&(i=`https://${e}`),`${t}://${i}/v0${s}`}function pE(s){const e=encodeURIComponent;let t="?";for(const i in s)if(s.hasOwnProperty(i)){const l=e(i)+"="+e(s[i]);t=t+l+"&"}return t=t.slice(0,-1),t}var Co;(function(s){s[s.NO_ERROR=0]="NO_ERROR",s[s.NETWORK_ERROR=1]="NETWORK_ERROR",s[s.ABORT=2]="ABORT"})(Co||(Co={}));function ID(s,e){const t=s>=500&&s<600,l=[408,429].indexOf(s)!==-1,u=e.indexOf(s)!==-1;return t||l||u}class DD{constructor(e,t,i,l,u,h,p,g,y,b,E,T=!0,O=!1){this.url_=e,this.method_=t,this.headers_=i,this.body_=l,this.successCodes_=u,this.additionalRetryCodes_=h,this.callback_=p,this.errorCallback_=g,this.timeout_=y,this.progressCallback_=b,this.connectionFactory_=E,this.retry=T,this.isUsingEmulator=O,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((H,q)=>{this.resolve_=H,this.reject_=q,this.start_()})}start_(){const e=(i,l)=>{if(l){i(!1,new ed(!1,null,!0));return}const u=this.connectionFactory_();this.pendingConnection_=u;const h=p=>{const g=p.loaded,y=p.lengthComputable?p.total:-1;this.progressCallback_!==null&&this.progressCallback_(g,y)};this.progressCallback_!==null&&u.addUploadProgressListener(h),u.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&u.removeUploadProgressListener(h),this.pendingConnection_=null;const p=u.getErrorCode()===Co.NO_ERROR,g=u.getStatus();if(!p||ID(g,this.additionalRetryCodes_)&&this.retry){const b=u.getErrorCode()===Co.ABORT;i(!1,new ed(!1,null,b));return}const y=this.successCodes_.indexOf(g)!==-1;i(!0,new ed(y,u))})},t=(i,l)=>{const u=this.resolve_,h=this.reject_,p=l.connection;if(l.wasSuccessCode)try{const g=this.callback_(p,p.getResponse());AD(g)?u(g):u()}catch(g){h(g)}else if(p!==null){const g=Ry();g.serverResponse=p.getErrorText(),this.errorCallback_?h(this.errorCallback_(p,g)):h(g)}else if(l.canceled){const g=this.appDelete_?mE():bD();h(g)}else{const g=vD();h(g)}};this.canceled_?t(!1,new ed(!1,null,!0)):this.backoffId_=CD(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&ND(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class ed{constructor(e,t,i){this.wasSuccessCode=e,this.connection=t,this.canceled=!!i}}function MD(s,e){e!==null&&e.length>0&&(s.Authorization="Firebase "+e)}function LD(s,e){s["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function OD(s,e){e&&(s["X-Firebase-GMPID"]=e)}function PD(s,e){e!==null&&(s["X-Firebase-AppCheck"]=e)}function VD(s,e,t,i,l,u,h=!0,p=!1){const g=pE(s.urlParams),y=s.url+g,b=Object.assign({},s.headers);return OD(b,e),MD(b,t),LD(b,u),PD(b,i),new DD(y,s.method,b,s.body,s.successCodes,s.additionalRetryCodes,s.handler,s.errorHandler,s.timeout,s.progressCallback,l,h,p)}function UD(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function BD(...s){const e=UD();if(e!==void 0){const t=new e;for(let i=0;i<s.length;i++)t.append(s[i]);return t.getBlob()}else{if(Dy())return new Blob(s);throw new ss(ns.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function zD(s,e,t){return s.webkitSlice?s.webkitSlice(e,t):s.mozSlice?s.mozSlice(e,t):s.slice?s.slice(e,t):null}function FD(s){if(typeof atob>"u")throw kD("base-64");return atob(s)}const yi={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class Ap{constructor(e,t){this.data=e,this.contentType=t||null}}function qD(s,e){switch(s){case yi.RAW:return new Ap(gE(e));case yi.BASE64:case yi.BASE64URL:return new Ap(yE(s,e));case yi.DATA_URL:return new Ap($D(e),WD(e))}throw Ry()}function gE(s){const e=[];for(let t=0;t<s.length;t++){let i=s.charCodeAt(t);if(i<=127)e.push(i);else if(i<=2047)e.push(192|i>>6,128|i&63);else if((i&64512)===55296)if(!(t<s.length-1&&(s.charCodeAt(t+1)&64512)===56320))e.push(239,191,189);else{const u=i,h=s.charCodeAt(++t);i=65536|(u&1023)<<10|h&1023,e.push(240|i>>18,128|i>>12&63,128|i>>6&63,128|i&63)}else(i&64512)===56320?e.push(239,191,189):e.push(224|i>>12,128|i>>6&63,128|i&63)}return new Uint8Array(e)}function HD(s){let e;try{e=decodeURIComponent(s)}catch{throw Xc(yi.DATA_URL,"Malformed data URL.")}return gE(e)}function yE(s,e){switch(s){case yi.BASE64:{const l=e.indexOf("-")!==-1,u=e.indexOf("_")!==-1;if(l||u)throw Xc(s,"Invalid character '"+(l?"-":"_")+"' found: is it base64url encoded?");break}case yi.BASE64URL:{const l=e.indexOf("+")!==-1,u=e.indexOf("/")!==-1;if(l||u)throw Xc(s,"Invalid character '"+(l?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let t;try{t=FD(e)}catch(l){throw l.message.includes("polyfill")?l:Xc(s,"Invalid character found")}const i=new Uint8Array(t.length);for(let l=0;l<t.length;l++)i[l]=t.charCodeAt(l);return i}class vE{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(t===null)throw Xc(yi.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const i=t[1]||null;i!=null&&(this.base64=GD(i,";base64"),this.contentType=this.base64?i.substring(0,i.length-7):i),this.rest=e.substring(e.indexOf(",")+1)}}function $D(s){const e=new vE(s);return e.base64?yE(yi.BASE64,e.rest):HD(e.rest)}function WD(s){return new vE(s).contentType}function GD(s,e){return s.length>=e.length?s.substring(s.length-e.length)===e:!1}class Pa{constructor(e,t){let i=0,l="";n_(e)?(this.data_=e,i=e.size,l=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),i=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),i=e.length),this.size_=i,this.type_=l}size(){return this.size_}type(){return this.type_}slice(e,t){if(n_(this.data_)){const i=this.data_,l=zD(i,e,t);return l===null?null:new Pa(l)}else{const i=new Uint8Array(this.data_.buffer,e,t-e);return new Pa(i,!0)}}static getBlob(...e){if(Dy()){const t=e.map(i=>i instanceof Pa?i.data_:i);return new Pa(BD.apply(null,t))}else{const t=e.map(h=>Iy(h)?qD(yi.RAW,h).data:h.data_);let i=0;t.forEach(h=>{i+=h.byteLength});const l=new Uint8Array(i);let u=0;return t.forEach(h=>{for(let p=0;p<h.length;p++)l[u++]=h[p]}),new Pa(l,!0)}}uploadData(){return this.data_}}function My(s){let e;try{e=JSON.parse(s)}catch{return null}return RD(e)?e:null}function KD(s){if(s.length===0)return null;const e=s.lastIndexOf("/");return e===-1?"":s.slice(0,e)}function YD(s,e){const t=e.split("/").filter(i=>i.length>0).join("/");return s.length===0?t:s+"/"+t}function bE(s){const e=s.lastIndexOf("/",s.length-2);return e===-1?s:s.slice(e+1)}function QD(s,e){return e}class Js{constructor(e,t,i,l){this.server=e,this.local=t||e,this.writable=!!i,this.xform=l||QD}}let td=null;function XD(s){return!Iy(s)||s.length<2?s:bE(s)}function _E(){if(td)return td;const s=[];s.push(new Js("bucket")),s.push(new Js("generation")),s.push(new Js("metageneration")),s.push(new Js("name","fullPath",!0));function e(u,h){return XD(h)}const t=new Js("name");t.xform=e,s.push(t);function i(u,h){return h!==void 0?Number(h):h}const l=new Js("size");return l.xform=i,s.push(l),s.push(new Js("timeCreated")),s.push(new Js("updated")),s.push(new Js("md5Hash",null,!0)),s.push(new Js("cacheControl",null,!0)),s.push(new Js("contentDisposition",null,!0)),s.push(new Js("contentEncoding",null,!0)),s.push(new Js("contentLanguage",null,!0)),s.push(new Js("contentType",null,!0)),s.push(new Js("metadata","customMetadata",!0)),td=s,td}function JD(s,e){function t(){const i=s.bucket,l=s.fullPath,u=new Zs(i,l);return e._makeStorageReference(u)}Object.defineProperty(s,"ref",{get:t})}function ZD(s,e,t){const i={};i.type="file";const l=t.length;for(let u=0;u<l;u++){const h=t[u];i[h.local]=h.xform(i,e[h.server])}return JD(i,s),i}function wE(s,e,t){const i=My(e);return i===null?null:ZD(s,i,t)}function eM(s,e,t,i){const l=My(e);if(l===null||!Iy(l.downloadTokens))return null;const u=l.downloadTokens;if(u.length===0)return null;const h=encodeURIComponent;return u.split(",").map(y=>{const b=s.bucket,E=s.fullPath,T="/b/"+h(b)+"/o/"+h(E),O=ff(T,t,i),H=pE({alt:"media",token:y});return O+H})[0]}function tM(s,e){const t={},i=e.length;for(let l=0;l<i;l++){const u=e[l];u.writable&&(t[u.server]=s[u.local])}return JSON.stringify(t)}const s_="prefixes",r_="items";function nM(s,e,t){const i={prefixes:[],items:[],nextPageToken:t.nextPageToken};if(t[s_])for(const l of t[s_]){const u=l.replace(/\/$/,""),h=s._makeStorageReference(new Zs(e,u));i.prefixes.push(h)}if(t[r_])for(const l of t[r_]){const u=s._makeStorageReference(new Zs(e,l.name));i.items.push(u)}return i}function sM(s,e,t){const i=My(t);return i===null?null:nM(s,e,i)}class Ly{constructor(e,t,i,l){this.url=e,this.method=t,this.handler=i,this.timeout=l,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function Oy(s){if(!s)throw Ry()}function rM(s,e){function t(i,l){const u=wE(s,l,e);return Oy(u!==null),u}return t}function iM(s,e){function t(i,l){const u=sM(s,e,l);return Oy(u!==null),u}return t}function aM(s,e){function t(i,l){const u=wE(s,l,e);return Oy(u!==null),eM(u,l,s.host,s._protocol)}return t}function Py(s){function e(t,i){let l;return t.getStatus()===401?t.getErrorText().includes("Firebase App Check token is invalid")?l=gD():l=pD():t.getStatus()===402?l=mD(s.bucket):t.getStatus()===403?l=yD(s.path):l=i,l.status=t.getStatus(),l.serverResponse=i.serverResponse,l}return e}function oM(s){const e=Py(s);function t(i,l){let u=e(i,l);return i.getStatus()===404&&(u=fD(s.path)),u.serverResponse=l.serverResponse,u}return t}function lM(s,e,t,i,l){const u={};e.isRoot?u.prefix="":u.prefix=e.path+"/",t.length>0&&(u.delimiter=t),i&&(u.pageToken=i),l&&(u.maxResults=l);const h=e.bucketOnlyServerUrl(),p=ff(h,s.host,s._protocol),g="GET",y=s.maxOperationRetryTime,b=new Ly(p,g,iM(s,e.bucket),y);return b.urlParams=u,b.errorHandler=Py(e),b}function cM(s,e,t){const i=e.fullServerUrl(),l=ff(i,s.host,s._protocol),u="GET",h=s.maxOperationRetryTime,p=new Ly(l,u,aM(s,t),h);return p.errorHandler=oM(e),p}function uM(s,e){return s&&s.contentType||e&&e.type()||"application/octet-stream"}function hM(s,e,t){const i=Object.assign({},t);return i.fullPath=s.path,i.size=e.size(),i.contentType||(i.contentType=uM(null,e)),i}function dM(s,e,t,i,l){const u=e.bucketOnlyServerUrl(),h={"X-Goog-Upload-Protocol":"multipart"};function p(){let ee="";for(let pe=0;pe<2;pe++)ee=ee+Math.random().toString().slice(2);return ee}const g=p();h["Content-Type"]="multipart/related; boundary="+g;const y=hM(e,i,l),b=tM(y,t),E="--"+g+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+b+`\r
--`+g+`\r
Content-Type: `+y.contentType+`\r
\r
`,T=`\r
--`+g+"--",O=Pa.getBlob(E,i,T);if(O===null)throw ED();const H={name:y.fullPath},q=ff(u,s.host,s._protocol),B="POST",te=s.maxUploadRetryTime,W=new Ly(q,B,rM(s,t),te);return W.urlParams=H,W.headers=h,W.body=O.uploadData(),W.errorHandler=Py(e),W}class fM{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Co.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Co.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Co.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,i,l,u){if(this.sent_)throw Lc("cannot .send() more than once");if(Ja(e)&&i&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(t,e,!0),u!==void 0)for(const h in u)u.hasOwnProperty(h)&&this.xhr_.setRequestHeader(h,u[h].toString());return l!==void 0?this.xhr_.send(l):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Lc("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Lc("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw Lc("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Lc("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class mM extends fM{initXhr(){this.xhr_.responseType="text"}}function Vy(){return new mM}class Po{constructor(e,t){this._service=e,t instanceof Zs?this._location=t:this._location=Zs.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new Po(e,t)}get root(){const e=new Zs(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return bE(this._location.path)}get storage(){return this._service}get parent(){const e=KD(this._location.path);if(e===null)return null;const t=new Zs(this._location.bucket,e);return new Po(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw SD(e)}}function pM(s,e,t){s._throwIfRoot("uploadBytes");const i=dM(s.storage,s._location,_E(),new Pa(e,!0),t);return s.storage.makeRequestWithTokens(i,Vy).then(l=>({metadata:l,ref:s}))}function gM(s){const e={prefixes:[],items:[]};return xE(s,e).then(()=>e)}async function xE(s,e,t){const l=await yM(s,{pageToken:t});e.prefixes.push(...l.prefixes),e.items.push(...l.items),l.nextPageToken!=null&&await xE(s,e,l.nextPageToken)}function yM(s,e){e!=null&&typeof e.maxResults=="number"&&vg("options.maxResults",1,1e3,e.maxResults);const t=e||{},i=lM(s.storage,s._location,"/",t.pageToken,t.maxResults);return s.storage.makeRequestWithTokens(i,Vy)}function vM(s){s._throwIfRoot("getDownloadURL");const e=cM(s.storage,s._location,_E());return s.storage.makeRequestWithTokens(e,Vy).then(t=>{if(t===null)throw TD();return t})}function bM(s,e){const t=YD(s._location.path,e),i=new Zs(s._location.bucket,t);return new Po(s.storage,i)}function _M(s){return/^[A-Za-z]+:\/\//.test(s)}function wM(s,e){return new Po(s,e)}function EE(s,e){if(s instanceof Uy){const t=s;if(t._bucket==null)throw xD();const i=new Po(t,t._bucket);return e!=null?EE(i,e):i}else return e!==void 0?bM(s,e):s}function xM(s,e){if(e&&_M(e)){if(s instanceof Uy)return wM(s,e);throw yg("To use ref(service, url), the first argument must be a Storage instance.")}else return EE(s,e)}function i_(s,e){const t=e?.[fE];return t==null?null:Zs.makeFromBucketSpec(t,s)}function EM(s,e,t,i={}){s.host=`${e}:${t}`;const l=Ja(e);l&&(Ag(`https://${s.host}/b`),Rg("Storage",!0)),s._isUsingEmulator=!0,s._protocol=l?"https":"http";const{mockUserToken:u}=i;u&&(s._overrideAuthToken=typeof u=="string"?u:W_(u,s.app.options.projectId))}class Uy{constructor(e,t,i,l,u,h=!1){this.app=e,this._authProvider=t,this._appCheckProvider=i,this._url=l,this._firebaseVersion=u,this._isUsingEmulator=h,this._bucket=null,this._host=dE,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=hD,this._maxUploadRetryTime=dD,this._requests=new Set,l!=null?this._bucket=Zs.makeFromBucketSpec(l,this._host):this._bucket=i_(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Zs.makeFromBucketSpec(this._url,e):this._bucket=i_(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){vg("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){vg("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(xr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Po(this,e)}_makeRequest(e,t,i,l,u=!0){if(this._deleted)return new jD(mE());{const h=VD(e,this._appId,i,l,t,this._firebaseVersion,u,this._isUsingEmulator);return this._requests.add(h),h.getPromise().then(()=>this._requests.delete(h),()=>this._requests.delete(h)),h}}async makeRequestWithTokens(e,t){const[i,l]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,i,l).getPromise()}}const a_="@firebase/storage",o_="0.14.0";const TE="storage";function bd(s,e,t){return s=Tn(s),pM(s,e,t)}function l_(s){return s=Tn(s),gM(s)}function No(s){return s=Tn(s),vM(s)}function Ua(s,e){return s=Tn(s),xM(s,e)}function TM(s=Lg(),e){s=Tn(s);const i=Hd(s,TE).getImmediate({identifier:e}),l=q_("storage");return l&&kM(i,...l),i}function kM(s,e,t,i={}){EM(s,e,t,i)}function SM(s,{instanceIdentifier:e}){const t=s.getProvider("app").getImmediate(),i=s.getProvider("auth-internal"),l=s.getProvider("app-check-internal");return new Uy(t,i,l,e,Vo)}function jM(){Ro(new $a(TE,SM,"PUBLIC").setMultipleInstances(!0)),vi(a_,o_,""),vi(a_,o_,"esm2020")}jM();const kE={apiKey:"AIzaSyBCIgMJd3By7qkWH27YiW9VooIBGE3bFLs",authDomain:"mind-core-fitness-client.firebaseapp.com",projectId:"mind-core-fitness-client",storageBucket:"mind-core-fitness-client.firebasestorage.app",messagingSenderId:"669343392406",appId:"1:669343392406:web:f5a35ee062387e7d6f58b7"},By=Mg(kE),wo=Rw(By),Se=JI(By),Ba=TM(By),CM=Mg(kE,"secondary"),h3=Rw(CM),NM="EYdciKDOi3UYBLk1u8hHams5tmO2",SE=w.createContext();function Ci(){return w.useContext(SE)}function AM({children:s}){const[e,t]=w.useState(null),[i,l]=w.useState(!1),[u,h]=w.useState(!1),[p,g]=w.useState(null),[y,b]=w.useState(!0);w.useEffect(()=>{let W=null;const ee=LN(wo,pe=>{if(t(pe),W&&(W(),W=null),pe)if(pe.uid===NM)l(!0),h(!1),g(null),b(!1);else{l(!1);const Te=In(Mt(Se,"clients"),fn("uid","==",pe.uid)),ve=async()=>{const A=localStorage.getItem("mcf_clientId");if(A)try{const S=await dr(nt(Se,"clients",A));S.exists()&&(h(!0),g({id:S.id,...S.data()}))}catch(S){console.error("Direct client read failed:",S)}};W=uE(Te,async A=>{if(A.empty)await ve();else{const S=A.docs[0];h(!0),g({id:S.id,...S.data()});try{localStorage.setItem("mcf_clientId",S.id)}catch{}}b(!1)},async A=>{console.error("Error listening to client data:",A),await ve(),b(!1)})}else l(!1),h(!1),g(null),b(!1)});return()=>{ee(),W&&W()}},[]);const te={currentUser:e,isAdmin:i,isClient:u,clientData:p,updateClientData:W=>{g(ee=>ee?{...ee,...W}:W)},resolveClient:async()=>{if(p)return p;const W=localStorage.getItem("mcf_clientId");if(W)try{const ee=await dr(nt(Se,"clients",W));if(ee.exists()){const pe={id:ee.id,...ee.data()};return h(!0),g(pe),pe}}catch(ee){console.error("resolveClient direct read failed:",ee)}if(e){const ee=In(Mt(Se,"clients"),fn("uid","==",e.uid)),pe=await En(ee);if(!pe.empty){const Te={id:pe.docs[0].id,...pe.docs[0].data()};return h(!0),g(Te),Te}}return null},login:async(W,ee,pe=!0)=>(await $b(wo,pe?Zp:Fg),await IN(wo,W,ee)),signup:async(W,ee,pe)=>{await $b(wo,Zp);const Te=await RN(wo,ee.trim().toLowerCase(),pe),ve=Te.user,A=nt(Mt(Se,"clients")),S={uid:ve.uid,name:W.trim(),email:ee.trim().toLowerCase(),clientType:"core_buddy",coreBuddyAccess:!0,status:"active",tier:"free",subscriptionStatus:null,signupSource:"self_signup",createdAt:Gt.now()};await Os(A,S),h(!0),g({id:A.id,...S});try{localStorage.setItem("mcf_clientId",A.id)}catch{}return Te},logout:()=>{try{localStorage.removeItem("mcf_clientId")}catch{}return ON(wo)},resetPassword:W=>AN(wo,W),loading:y};return o.jsx(SE.Provider,{value:te,children:s})}const jE=w.createContext();function zo(){return w.useContext(jE)}function RM({children:s}){const[e,t]=w.useState(()=>{const g=localStorage.getItem("theme");return g?g==="dark":window.matchMedia("(prefers-color-scheme: dark)").matches}),[i,l]=w.useState(()=>localStorage.getItem("accent")||"red");w.useEffect(()=>{document.documentElement.setAttribute("data-theme",e?"dark":"light"),localStorage.setItem("theme",e?"dark":"light")},[e]),w.useEffect(()=>{localStorage.setItem("accent",i)},[i]);const p={isDark:e,toggleTheme:()=>{document.documentElement.setAttribute("data-theme-transitioning",""),t(!e),setTimeout(()=>{document.documentElement.removeAttribute("data-theme-transitioning")},350)},accent:i,setAccent:g=>l(g)};return o.jsx(jE.Provider,{value:p,children:s})}const CE=w.createContext();function Ru(){return w.useContext(CE)}const IM=["nutrition","buddies"],DM=[5,10],MM=3,LM=1;function OM({children:s}){const{clientData:e,loading:t}=Ci(),i=w.useMemo(()=>{const l=e?.tier||"free",u=e?.subscriptionStatus||null,h=e&&e.signupSource!=="self_signup",p=l==="premium"||!!h;function g(y){return p?!0:!IM.includes(y)}return{tier:l,subscriptionStatus:u,isPremium:p,canAccess:g,loading:t,FREE_RANDOMISER_DURATIONS:DM,FREE_RANDOMISER_WEEKLY_LIMIT:MM,FREE_HABIT_LIMIT:LM}},[e?.tier,e?.subscriptionStatus,e?.signupSource,t]);return o.jsx(CE.Provider,{value:i,children:s})}function PM(s){if(s?.signupSource==="self_signup"&&!s?.onboardingComplete)return"/onboarding";const e=s?.clientType;return e==="core_buddy"?"/client/core-buddy":e==="circuit_vip"||e==="circuit_dropin"?"/client/circuit":"/client"}function VM({className:s=""}){const{isDark:e,toggleTheme:t}=zo();return o.jsx("button",{className:s||"theme-toggle",onClick:t,"aria-label":e?"Switch to light mode":"Switch to dark mode",children:e?o.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20",children:o.jsx("path",{d:"M12 3a9 9 0 109 9c0-.46-.04-.92-.1-1.36a5.389 5.389 0 01-4.4 2.26 5.403 5.403 0 01-3.14-9.8c-.44-.06-.9-.1-1.36-.1z"})}):o.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20",children:o.jsx("path",{d:"M12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zM2 13h2c.55 0 1-.45 1-1s-.45-1-1-1H2c-.55 0-1 .45-1 1s.45 1 1 1zm18 0h2c.55 0 1-.45 1-1s-.45-1-1-1h-2c-.55 0-1 .45-1 1s.45 1 1 1zM11 2v2c0 .55.45 1 1 1s1-.45 1-1V2c0-.55-.45-1-1-1s-1 .45-1 1zm0 18v2c0 .55.45 1 1 1s1-.45 1-1v-2c0-.55-.45-1-1-1s-1 .45-1 1zM5.99 4.58a.996.996 0 00-1.41 0 .996.996 0 000 1.41l1.06 1.06c.39.39 1.03.39 1.41 0s.39-1.03 0-1.41L5.99 4.58zm12.37 12.37a.996.996 0 00-1.41 0 .996.996 0 000 1.41l1.06 1.06c.39.39 1.03.39 1.41 0a.996.996 0 000-1.41l-1.06-1.06zm1.06-10.96a.996.996 0 000-1.41.996.996 0 00-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06zM7.05 18.36a.996.996 0 000-1.41.996.996 0 00-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06z"})})})}function UM(){const[s,e]=w.useState(""),[t,i]=w.useState(""),[l,u]=w.useState(!0),[h,p]=w.useState(""),[g,y]=w.useState(!1),[b,E]=w.useState(!1),[T,O]=w.useState(!1),{login:H,resetPassword:q,currentUser:B,isAdmin:te,isClient:W,clientData:ee,loading:pe}=Ci(),Te=Sr();if(w.useEffect(()=>{!pe&&B&&(te?Te("/dashboard"):W?Te(PM(ee)):(y(!1),p("No account found. Please sign up or contact your trainer.")))},[pe,B,te,W,ee,Te]),pe||B)return o.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",minHeight:"100vh",background:"var(--bg-body)"},children:o.jsx("div",{style:{width:36,height:36,border:"3px solid var(--color-primary-light)",borderTopColor:"var(--color-primary)",borderRadius:"50%",animation:"app-spin .7s linear infinite"}})});const ve=async S=>{S.preventDefault(),p(""),y(!0);try{await H(s,t,l)}catch(I){p(I.message||"Failed to log in"),y(!1)}},A=async S=>{if(S.preventDefault(),p(""),!s.trim()){p("Please enter your email address");return}y(!0);try{await q(s.trim()),O(!0)}catch(I){I.code==="auth/user-not-found"?p("No account found with this email"):p(I.message||"Failed to send reset email")}y(!1)};return o.jsxs("div",{className:"login-container",children:[o.jsx(VM,{className:"login-theme-toggle"}),o.jsxs("div",{className:"login-card",children:[o.jsxs("div",{className:"login-header",children:[o.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"login-logo"}),o.jsx("p",{children:o.jsx("strong",{children:b?"Reset Password":"Sign in as 1-2-1 or a Core Buddy"})})]}),h&&o.jsx("div",{className:"error-message",children:h}),T?o.jsxs("div",{className:"reset-sent",children:[o.jsx("div",{className:"reset-sent-icon",children:o.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("path",{d:"M22 2L11 13",strokeLinecap:"round",strokeLinejoin:"round"}),o.jsx("path",{d:"M22 2L15 22L11 13L2 9L22 2Z",strokeLinecap:"round",strokeLinejoin:"round"})]})}),o.jsx("p",{children:"Reset email sent!"}),o.jsx("span",{children:"Check your inbox for a password reset link"}),o.jsx("button",{className:"login-btn",style:{marginTop:"20px"},onClick:()=>{E(!1),O(!1),p("")},children:"Back to Log In"})]}):b?o.jsxs("form",{onSubmit:A,children:[o.jsxs("div",{className:"form-group",children:[o.jsx("label",{htmlFor:"email",children:"Email"}),o.jsx("input",{type:"email",id:"email",value:s,onChange:S=>e(S.target.value),placeholder:"Enter your email",required:!0})]}),o.jsx("button",{type:"submit",className:"login-btn",disabled:g,children:g?"Sending...":"Send Reset Link"}),o.jsx("button",{type:"button",className:"forgot-link",onClick:()=>{E(!1),p("")},children:"Back to Log In"})]}):o.jsxs(o.Fragment,{children:[o.jsxs("form",{onSubmit:ve,children:[o.jsxs("div",{className:"form-group",children:[o.jsx("label",{htmlFor:"email",children:"Email"}),o.jsx("input",{type:"email",id:"email",value:s,onChange:S=>e(S.target.value),required:!0})]}),o.jsxs("div",{className:"form-group",children:[o.jsx("label",{htmlFor:"password",children:"Password"}),o.jsx("input",{type:"password",id:"password",value:t,onChange:S=>i(S.target.value),required:!0})]}),o.jsx("div",{className:"remember-me",children:o.jsxs("label",{children:[o.jsx("input",{type:"checkbox",checked:l,onChange:S=>u(S.target.checked)}),o.jsx("span",{children:"Remember me"})]})}),o.jsx("button",{type:"submit",className:"login-btn",disabled:g,children:g?"Logging in...":"Log In"})]}),o.jsx("button",{type:"button",className:"forgot-link",onClick:()=>{E(!0),p("")},children:"Forgot password?"}),o.jsx("button",{type:"button",className:"login-btn login-btn-outline",onClick:()=>Te("/signup"),children:"Don't have an account? Create one free"})]}),o.jsx("a",{href:"/",className:"back-link",children:"Back to website"})]})]})}function nd({feature:s,children:e}){const{canAccess:t,loading:i}=Ru();return i||t(s)?e:o.jsx(D_,{to:"/upgrade",replace:!0})}function sa({active:s}){const e=Sr(),{clientData:t}=Ci(),{isPremium:i}=Ru(),l=t?.clientType==="block"&&t?.coreBuddyAccess;return o.jsxs("nav",{className:"block-bottom-nav",children:[o.jsxs("button",{className:`block-nav-tab${s==="home"?" active":""}`,onClick:()=>e("/client/core-buddy"),children:[o.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[o.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),o.jsx("circle",{cx:"12",cy:"7",r:"4"})]}),o.jsx("span",{children:"Profile"})]}),o.jsxs("button",{className:`block-nav-tab${s==="workouts"?" active":""}`,onClick:()=>e("/client/core-buddy/workouts"),children:[o.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"currentColor",stroke:"none",children:o.jsx("path",{d:"M1 9h2v6H1V9zm3-2h2v10H4V7zm3 4h10v2H7v-2zm10-4h2v10h-2V7zm3 2h2v6h-2V9z"})}),o.jsx("span",{children:"Workout"})]}),i&&o.jsxs("button",{className:`block-nav-tab${s==="nutrition"?" active":""}`,onClick:()=>e("/client/core-buddy/nutrition"),children:[o.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:o.jsx("path",{d:"M18 8h1a4 4 0 0 1 0 8h-1M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z"})}),o.jsx("span",{children:"Nutrition"})]}),i&&o.jsxs("button",{className:`block-nav-tab${s==="buddies"?" active":""}`,onClick:()=>e("/client/core-buddy/buddies"),children:[o.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[o.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),o.jsx("circle",{cx:"9",cy:"7",r:"4"}),o.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),o.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),o.jsx("span",{children:"Buddies"})]}),l&&o.jsxs("button",{className:"block-nav-tab",onClick:()=>e("/client"),children:[o.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[o.jsx("rect",{x:"3",y:"3",width:"7",height:"7"}),o.jsx("rect",{x:"14",y:"3",width:"7",height:"7"}),o.jsx("rect",{x:"14",y:"14",width:"7",height:"7"}),o.jsx("rect",{x:"3",y:"14",width:"7",height:"7"})]}),o.jsx("span",{children:"Block"})]})]})}function Fo({children:s,onRefresh:e}){const[t,i]=w.useState(0),[l,u]=w.useState(!1),h=w.useRef(null),p=w.useRef(0),g=w.useRef(!1),y=w.useCallback(T=>{window.scrollY<=0&&(p.current=T.touches[0].clientY,g.current=!0)},[]),b=w.useCallback(T=>{if(!g.current||l)return;const O=T.touches[0].clientY-p.current;O>20&&window.scrollY<=0&&(T.preventDefault(),i(Math.min((O-20)*.35,80)))},[l]),E=w.useCallback(async()=>{t>55&&!l&&(u(!0),e?await e():window.location.reload(),u(!1)),i(0),g.current=!1},[t,l,e]);return o.jsxs("div",{ref:h,onTouchStart:y,onTouchMove:b,onTouchEnd:E,children:[o.jsxs("div",{className:`pull-refresh-indicator ${t>0?"visible":""} ${l?"refreshing":""}`,style:{height:t},children:[o.jsx("div",{className:`refresh-spinner ${l?"spinning":""}`,children:o.jsx("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:o.jsx("path",{fill:"currentColor",d:"M17.65 6.35A7.958 7.958 0 0012 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08A5.99 5.99 0 0112 18c-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"})})}),o.jsx("span",{className:"refresh-text",children:l?"Refreshing...":"Pull to refresh"})]}),s]})}function Iu(s,e,t,i,l){const u=[];for(let h=0;h<s;h++){const p=(h*(360/s)-90)*(Math.PI/180);u.push({x1:e+i*Math.cos(p),y1:t+i*Math.sin(p),x2:e+l*Math.cos(p),y2:t+l*Math.sin(p),thick:h%5===0})}return u}const NE=Iu(60,100,100,85,96),BM=Iu(60,100,100,78,94),zM=Iu(60,100,100,82,94);Iu(60,50,50,38,46);const d3=Iu(60,40,40,30,37);function FM({steps:s,onFinish:e,active:t}){const[i,l]=w.useState(0),[u,h]=w.useState(null),[p,g]=w.useState("below"),[y,b]=w.useState(!1),E=w.useRef(null),T=w.useRef(t);T.current=t,w.useEffect(()=>{t||l(0)},[t]),w.useEffect(()=>{if(!t)return;const Te=ve=>ve.preventDefault();return document.addEventListener("touchmove",Te,{passive:!1}),document.addEventListener("wheel",Te,{passive:!1}),document.body.style.overflow="hidden",()=>{document.removeEventListener("touchmove",Te),document.removeEventListener("wheel",Te),document.body.style.overflow=""}},[t]);const O=w.useMemo(()=>t?s.filter(Te=>document.querySelector(Te.selector)):[],[t]),H=O[i],q=i===O.length-1,B=H?.selector,te=w.useCallback(()=>{if(!B)return;const Te=document.querySelector(B);if(!Te){h(null);return}const ve=Te.getBoundingClientRect(),A=8;h({top:ve.top-A,left:ve.left-A,width:ve.width+A*2,height:ve.height+A*2});const S=window.innerHeight-ve.bottom;g(S<260?"above":"below")},[B]);if(w.useEffect(()=>{if(!t||!B)return;b(!0);const Te=document.querySelector(B);if(Te){document.body.style.overflow="",Te.scrollIntoView({behavior:"smooth",block:"center"});let ve=null,A=0,S=0;const I=60,V=()=>{S++;const N=Te.getBoundingClientRect(),Ue=Math.round(N.top);if(ve!==null&&Ue===ve?A++:A=0,ve=Ue,A>=3||S>=I){T.current&&(document.body.style.overflow="hidden"),te(),b(!1);return}D=requestAnimationFrame(V)};let D;const M=setTimeout(()=>{D=requestAnimationFrame(V)},120);return()=>{clearTimeout(M),D&&cancelAnimationFrame(D),T.current&&(document.body.style.overflow="hidden")}}},[t,i,B,te]),w.useEffect(()=>{if(!t)return;const Te=()=>{E.current&&cancelAnimationFrame(E.current),E.current=requestAnimationFrame(te)};return window.addEventListener("scroll",Te,!0),window.addEventListener("resize",Te),()=>{window.removeEventListener("scroll",Te,!0),window.removeEventListener("resize",Te),E.current&&cancelAnimationFrame(E.current)}},[t,te]),!t||!H||O.length===0)return null;const W=()=>{q?e():l(i+1)},ee=()=>{i>0&&l(i-1)},pe=()=>e();return o.jsxs("div",{className:"st-overlay",onClick:Te=>{Te.stopPropagation()},children:[o.jsx("div",{className:"st-backdrop",onClick:W}),u&&o.jsx("div",{className:`st-spotlight${y?" st-transitioning":""}`,style:{top:u.top,left:u.left,width:u.width,height:u.height}}),u&&o.jsxs("div",{className:`st-tooltip st-tooltip-${p}${y?" st-transitioning":""}`,style:{top:p==="below"?Math.min(Math.max(u.top+u.height+16,16),window.innerHeight-200):void 0,bottom:p==="above"?Math.min(Math.max(window.innerHeight-u.top+16,16),window.innerHeight-60):void 0,left:Math.max(16,Math.min(u.left,window.innerWidth-320))},children:[o.jsx("div",{className:"st-dots",children:O.map((Te,ve)=>o.jsx("span",{className:`st-dot${ve===i?" active":""}${ve<i?" done":""}`},ve))}),o.jsx("h3",{className:"st-title",children:H.title}),o.jsx("p",{className:"st-body",children:H.body}),o.jsxs("div",{className:"st-actions",children:[i>0&&o.jsx("button",{className:"st-btn st-btn-back",onClick:ee,children:"Back"}),o.jsx("button",{className:"st-btn st-btn-next",onClick:W,children:H.cta||(q?"Let's Go!":"Next")})]}),o.jsx("button",{className:"st-skip",onClick:pe,children:"Skip tour"})]})]})}const c_=3,qM=5;function Rp(s){return s.toISOString().split("T")[0]}const Ip=[{text:"You have 24 hours a day...",bold:"make it count"},{text:"Discipline beats motivation...",bold:"every single time"},{text:"Rest when you're done,",bold:"not when you're tired"},{text:"Small daily gains...",bold:"create massive results"},{text:"Your body keeps score,",bold:"train it well"},{text:"Consistency over intensity...",bold:"always wins"},{text:"The only bad workout...",bold:"is the one you skipped"}];function Dp(s){if(!s)return"";const e=s instanceof Date?s:s.toDate?s.toDate():new Date(s),t=Math.floor((new Date-e)/1e3);return t<60?"just now":t<3600?`${Math.floor(t/60)}m ago`:t<86400?`${Math.floor(t/3600)}h ago`:t<604800?`${Math.floor(t/86400)}d ago`:e.toLocaleDateString("en-GB",{day:"numeric",month:"short"})}function Oc(s){if(!s)return"?";const e=s.trim().split(/\s+/);return e.length===1?e[0][0].toUpperCase():(e[0][0]+e[e.length-1][0]).toUpperCase()}function HM(s,e=800){return new Promise(t=>{const i=new Image;i.onload=()=>{const l=document.createElement("canvas");let u=i.width,h=i.height;u>h?u>e&&(h=Math.round(h*e/u),u=e):h>e&&(u=Math.round(u*e/h),h=e),l.width=u,l.height=h,l.getContext("2d").drawImage(i,0,0,u,h),l.toBlob(p=>t(p),"image/jpeg",.8)},i.src=URL.createObjectURL(s)})}function $M(){const{currentUser:s,isClient:e,clientData:t,logout:i,updateClientData:l,loading:u}=Ci(),{isDark:h,toggleTheme:p}=zo(),{isPremium:g,FREE_HABIT_LIMIT:y}=Ru(),b=Sr(),E=g?qM:y,[T,O]=w.useState({hours:0,minutes:0,seconds:0}),[H,q]=w.useState(0),[B,te]=w.useState(0),[W,ee]=w.useState(0),[pe,Te]=w.useState(!1),[ve,A]=w.useState({protein:0,carbs:0,fats:0,calories:0}),[S,I]=w.useState(null),[V,D]=w.useState(0),[M,N]=w.useState(0),[Ue,Ze]=w.useState(c_),[Z,we]=w.useState(!1),[Ie,Be]=w.useState(!1),[re,L]=w.useState([]),[ie,_e]=w.useState(null),[ke,Ee]=w.useState(!1),xe=w.useRef(null),[Ke,ct]=w.useState(0),[Pe,tn]=w.useState(0),[jn,Un]=w.useState(null),Lt=w.useCallback((j,G="info")=>{Un({message:j,type:G}),setTimeout(()=>Un(null),4e3)},[]),[rt,gt]=w.useState([]),[ut,Bn]=w.useState(!1),[ue,Rt]=w.useState(""),[yt,Vt]=w.useState(null),[Je,At]=w.useState(null),[vt,nn]=w.useState(!1),[js,rs]=w.useState(new Set),[Xt,ne]=w.useState(new Set),[Ne,xt]=w.useState({}),[bt,it]=w.useState({}),[$e,st]=w.useState({}),[Fe,sn]=w.useState({}),[on,Mn]=w.useState({}),[zn,Xn]=w.useState({}),Yt=w.useRef(null),Fn=w.useRef(null),Cn=w.useRef({}),[ln,fr]=w.useState([]),[oe,Ae]=w.useState(!1),Ge=w.useRef(null),[mt,lt]=w.useState([]),[yn,Nn]=w.useState(""),[dn,vn]=w.useState(!1),[Cs,is]=w.useState(null),[ds,Jt]=w.useState([]),[An,Ns]=w.useState(null),[jr,ai]=w.useState(!1),Cr=w.useRef(!1),Nr=(()=>{const j=[{selector:".cb-ring-container",title:"Your 24-Hour Countdown",body:"Every day resets. This ring tracks the time you have left  tap your photo to personalise your profile.",cta:"Next"},{selector:".cb-stats-row",title:"Progress at a Glance",body:"Your workout streak, sessions this week, and daily habits  all in one row. These fill up as you go."},{selector:".cb-nudge-card",title:"Smart Suggestions",body:"We'll highlight what needs your attention  your next session, unfinished habits, or a meal to log."},{selector:".cb-card-workouts-hero",title:"Workout",body:"Randomiser workouts  pick your focus, level and time. Save and replay your favourites.",cta:"Next"}];return g&&j.push({selector:".cb-card-nutrition",title:"Nutrition Tracking",body:"Set your macro targets, scan barcodes, and log meals to hit your daily goals."},{selector:".cb-card-consistency",title:"Daily Habits",body:"5 simple habits each day  train, hit protein, 10k steps, sleep, and hydrate. Build your streak."},{selector:".cb-card-buddies",title:"Buddies & Social",body:"Connect with other members, share your journey, and keep each other accountable."},{selector:".cb-journey-section",title:"Share Your Journey",body:"Post photos, updates, and milestones  your fitness journey in one place. Like and comment on each other's posts."}),j.push({selector:".block-bottom-nav",title:"You're All Set!",body:"Use the nav bar to jump between your profile, workouts, nutrition, and buddies. Time to get after it.",cta:"Let's Go!"}),j})();w.useEffect(()=>{!u&&!s&&b("/")},[u,s,b]),w.useEffect(()=>{!u&&t&&t.signupSource==="self_signup"&&!t.onboardingComplete&&b("/onboarding")},[u,t,b]),w.useEffect(()=>{let j=t?.tourComplete||Cr.current;if(!j&&t?.id)try{j=!!localStorage.getItem(`tourDone_${t.id}`)}catch{}if(pe&&t&&!j){const G=setTimeout(()=>ai(!0),600);return()=>clearTimeout(G)}},[pe,t]),w.useEffect(()=>{if(!(!pe||!t?.id)){try{if(localStorage.getItem(`targetHint_${t.id}`))return}catch{}if(!t?.weeklyWorkoutTarget){const j=setTimeout(()=>Be(!0),1500);return()=>clearTimeout(j)}}},[pe,t]),w.useEffect(()=>{if(t)try{const j=sessionStorage.getItem(`cbDash_${t.id}`);if(j){const G=JSON.parse(j);te(G.totalWorkouts??0),ee(G.habitWeekPct??0),A(G.nutritionTotals??{protein:0,carbs:0,fats:0,calories:0}),I(G.nutritionTargetData??null),D(G.todayHabitsCount??0),N(G.weeklyWorkouts??0),Ze(G.weeklyWorkoutTarget??c_),L(G.leaderboardTop3??[]),ct(G.streakWeeks??0),Te(!0)}}catch{}},[t]),w.useEffect(()=>{t?.photoURL&&_e(t.photoURL),t?.weeklyWorkoutTarget&&Ze(t.weeklyWorkoutTarget)},[t]),w.useEffect(()=>{if(!t)return;const j=In(Mt(Se,"notifications"),fn("toId","==",t.id)),G=uE(j,Ce=>{const Re=Ce.docs.map(ze=>({id:ze.id,...ze.data()}));Re.sort((ze,ht)=>{const et=ze.createdAt?.toMillis?.()||0;return(ht.createdAt?.toMillis?.()||0)-et}),fr(Re.slice(0,50))},Ce=>{console.error("Notification listener error:",Ce),Ce.code==="permission-denied"&&console.warn("Firestore rules may be missing for the notifications collection. Please update your Firestore rules in the Firebase Console.")});return()=>G()},[t]),w.useEffect(()=>{const j=G=>{Ge.current&&!Ge.current.contains(G.target)&&Ae(!1)};return document.addEventListener("mousedown",j),()=>document.removeEventListener("mousedown",j)},[]),w.useEffect(()=>{if(!t)return;const j=t.id;(async()=>{try{const[G,Ce,Re]=await Promise.all([En(In(Mt(Se,"buddies"),fn("user1","==",j))),En(In(Mt(Se,"buddies"),fn("user2","==",j))),En(Mt(Se,"clients"))]),ze=new Set;[...G.docs,...Ce.docs].forEach(et=>{const kt=et.data();ze.add(kt.user1===j?kt.user2:kt.user1)});const ht={};Re.docs.forEach(et=>{ht[et.id]=et.data()}),lt(Array.from(ze).filter(et=>ht[et]).map(et=>({id:et,name:ht[et].name,photoURL:ht[et].photoURL||null})))}catch(G){console.error("Error loading buddies for mentions:",G)}})()},[t]);const qn=ln.filter(j=>!j.read).length,Ks=async()=>{const j=ln.filter(Ce=>!Ce.read);if(!j.length)return;const G=t_(Se);j.forEach(Ce=>G.update(nt(Se,"notifications",Ce.id),{read:!0})),await G.commit()},ws=async()=>{if(!ln.length)return;const j=t_(Se);ln.forEach(G=>j.delete(nt(Se,"notifications",G.id))),await j.commit()},kn=async(j,G,Ce={})=>{if(!(!t||j===t.id))try{await ti(Mt(Se,"notifications"),{toId:j,fromId:t.id,fromName:t.name||"Someone",fromPhotoURL:t.photoURL||null,type:G,read:!1,createdAt:hr(),...Ce})}catch(Re){console.error("Notification create error:",Re),Re.code==="permission-denied"&&Lt("Notifications blocked  check Firestore rules","error")}},Ln=(j,G)=>{const Ce=G==="compose"?Yt.current?.selectionStart:null,ze=(Ce!=null?j.slice(0,Ce):j).match(/@(\w*)$/);if(ze){vn(!0),is(G),Nn(ze[1].toLowerCase());const ht=mt.filter(et=>et.name&&et.name.toLowerCase().includes(ze[1].toLowerCase())).slice(0,5);Jt(ht)}else vn(!1),Jt([])},as=(j,G)=>{if(G==="compose"){const Ce=Yt.current,Re=ue,ze=Ce?.selectionStart??Re.length,ht=Re.slice(0,ze),et=Re.slice(ze),kt=ht.replace(/@\w*$/,`@${j.name} `);Rt(kt+et),setTimeout(()=>{Ce?.focus(),Ce.selectionStart=Ce.selectionEnd=kt.length},0)}else{const Re=(bt[G]||"").replace(/@\w*$/,`@${j.name} `);it(ze=>({...ze,[G]:Re}))}vn(!1),Jt([])},zt=j=>j&&j.split(/(@\w[\w\s]*?\s)/g).map((Ce,Re)=>Ce.startsWith("@")&&mt.some(ze=>Ce.trim()===`@${ze.name}`)?o.jsx("span",{className:"mention-highlight",children:Ce.trim()},Re):Ce),Gr=async j=>{const G=j.target.files?.[0];if(!(!G||!t)){if(!G.type.startsWith("image/")){Lt("Please select an image file","error");return}if(G.size>5*1024*1024){Lt("Image must be under 5MB","error");return}Ee(!0);try{const Ce=await new Promise(ht=>{const et=new Image;et.onload=()=>{const kt=document.createElement("canvas"),dt=400;let P=et.width,Y=et.height;P>Y?(Y=Y/P*dt,P=dt):(P=P/Y*dt,Y=dt),kt.width=P,kt.height=Y,kt.getContext("2d").drawImage(et,0,0,P,Y),kt.toBlob(X=>ht(X),"image/jpeg",.75)},et.src=URL.createObjectURL(G)}),Re=Ua(Ba,`profilePhotos/${t.id}`);await bd(Re,Ce);const ze=await No(Re);await Hr(nt(Se,"clients",t.id),{photoURL:ze}),_e(ze),l({photoURL:ze}),Lt("Profile photo updated!","success")}catch(Ce){console.error("Photo upload error:",Ce),Lt("Failed to upload photo","error")}Ee(!1),xe.current&&(xe.current.value="")}};w.useEffect(()=>{const j=()=>{const Ce=new Date,Re=new Date(Ce);Re.setHours(23,59,59,999);const ze=Re-Ce,ht=Math.floor(ze/(1e3*60*60)),et=Math.floor(ze%(1e3*60*60)/(1e3*60)),kt=Math.floor(ze%(1e3*60)/1e3);O({hours:ht,minutes:et,seconds:kt}),q(60-kt)};j();const G=setInterval(j,1e3);return()=>clearInterval(G)},[]),w.useEffect(()=>{const j=setInterval(()=>{tn(G=>(G+1)%Ip.length)},8e3);return()=>clearInterval(j)},[]),w.useEffect(()=>{if(!s||!t)return;(async()=>{let G=null,Ce=null;try{const Re=Rp(new Date),ze=Mt(Se,"workoutLogs"),ht=In(ze,fn("clientId","==",t.id));G=await En(ht),te(G.docs.length);const et=new Date,kt=et.getDay(),dt=kt===0?6:kt-1,P=new Date(et);P.setDate(et.getDate()-dt),P.setHours(0,0,0,0);const Y=P.getTime(),X=G.docs.filter(Pt=>{const Qe=Pt.data().completedAt;return Qe?(Qe.toDate?Qe.toDate().getTime():new Date(Qe).getTime())>=Y:!1}).length;N(X);const ye=Mt(Se,"habitLogs"),je=In(ye,fn("clientId","==",t.id),fn("date","==",Re)),Oe=await En(je);let qe=0;if(!Oe.empty){const Pt=Oe.docs[0].data().habits||{};qe=Math.min(Object.values(Pt).filter(Boolean).length,E)}ee(Math.round(qe/E*100)),D(qe);const pt=await dr(nt(Se,"nutritionTargets",t.id));pt.exists()&&(I(pt.data()),Ce=pt.data());const Et=await dr(nt(Se,"nutritionLogs",`${t.id}_${Re}`));if(Et.exists()){const Qe=(Et.data().entries||[]).reduce((Zt,Us)=>({protein:Zt.protein+(Us.protein||0),carbs:Zt.carbs+(Us.carbs||0),fats:Zt.fats+(Us.fats||0),calories:Zt.calories+(Us.calories||0)}),{protein:0,carbs:0,fats:0,calories:0});A(Qe)}}catch(Re){console.error("Error loading dashboard stats:",Re)}try{const Re=Mt(Se,"clients"),ze=In(Re,fn("leaderboardOptIn","==",!0)),et=(await En(ze)).docs.map(kt=>({id:kt.id,name:kt.data().name,photoURL:kt.data().photoURL||null}));L(et.slice(0,3))}catch(Re){console.error("Leaderboard preview error:",Re)}try{let Re=0;if(G){const ze=G.docs.map(ht=>ht.data().date).filter(Boolean).sort().reverse();if(ze.length>0){const ht=new Date;let et=new Date(ht);e:for(let kt=0;kt<52;kt++){const dt=new Date(et),P=dt.getDay(),Y=P===0?6:P-1;dt.setDate(dt.getDate()-Y),dt.setHours(0,0,0,0);const X=new Date(dt);X.setDate(X.getDate()+7);const ye=Rp(dt),je=Rp(X);if(ze.some(qe=>qe>=ye&&qe<je))Re++;else{if(kt>0)break e;break}et.setDate(et.getDate()-7)}}}ct(Re)}catch(Re){console.error("Streak computation error:",Re)}Te(!0)})()},[s,t,E]),w.useEffect(()=>{if(!(!pe||!t))try{sessionStorage.setItem(`cbDash_${t.id}`,JSON.stringify({totalWorkouts:B,habitWeekPct:W,nutritionTotals:ve,nutritionTargetData:S,todayHabitsCount:V,weeklyWorkouts:M,weeklyWorkoutTarget:Ue,leaderboardTop3:re,streakWeeks:Ke}))}catch{}},[pe,B,W,ve,S,V,M,Ue,re,Ke,t]);const Ar=w.useCallback(async()=>{if(Cr.current=!0,ai(!1),l({tourComplete:!0}),t?.id){try{localStorage.setItem(`tourDone_${t.id}`,"1")}catch{}try{await Hr(nt(Se,"clients",t.id),{tourComplete:!0})}catch(j){console.error("Failed to save tour completion:",j)}}},[t,l]),xs=w.useCallback(async j=>{if(Ze(j),we(!1),Be(!1),t?.id){try{localStorage.setItem(`targetHint_${t.id}`,"1")}catch{}try{await Hr(nt(Se,"clients",t.id),{weeklyWorkoutTarget:j})}catch(G){console.error("Failed to save weekly target:",G)}}},[t]),bn=j=>{const G=j.currentTarget,Ce=G.querySelector(".ripple");Ce&&Ce.remove();const Re=G.getBoundingClientRect(),ze=Math.max(Re.width,Re.height),ht=j.clientX-Re.left-ze/2,et=j.clientY-Re.top-ze/2,kt=document.createElement("span");kt.className="ripple",kt.style.cssText=`width:${ze}px;height:${ze}px;left:${ht}px;top:${et}px;`,G.appendChild(kt),setTimeout(()=>kt.remove(),600)},nr=t?.name?.split(" ")[0]||"there",oi=Math.min(Math.round(M/Ue*100),100),R=Ke>0?Math.min(Math.round(Ke/12*100),100):0,z=[{label:"Wk Streak",value:`${Ke}`,pct:R,color:"var(--color-primary)",size:"normal"},{label:"Workouts",value:`${M}/${Ue}`,pct:oi,color:"var(--color-primary)",size:"large",editable:!0},{label:"Habits Today",value:`${W}%`,pct:W,color:"var(--color-primary)",size:"normal"}],ae=j=>!S||!S[j]?0:Math.min(Math.round(ve[j]/S[j]*100),100),le=(()=>{const j=new Date().getHours();return pe&&V>=E&&ve.calories>0?{main:"Smashed it today,",sub:"Rest up and go again tomorrow."}:j>=5&&j<12?{main:"Rise and grind,",sub:"let's get after it!"}:j>=12&&j<17?{main:"Oye",sub:"crack on and make it count!"}:j>=17&&j<21?{main:"Evening session?",sub:"Let's finish strong!"}:{main:"Burning the midnight oil,",sub:"Respect the hustle!"}})(),Me=pe?M===0?{label:"WORKOUT",message:"No workouts this week yet",cta:"Start One",action:()=>b("/client/core-buddy/workouts"),pct:0,ringLabel:"0"}:V<E?{label:"DAILY HABITS",message:`${V}/${E} completed`,cta:"Open Habits",action:()=>b("/client/core-buddy/consistency"),pct:W,ringLabel:`${V}/${E}`}:g&&ve.calories===0?{label:"NUTRITION",message:"No meals logged today",cta:"Log Meal",action:()=>b("/client/core-buddy/nutrition"),pct:0,ringLabel:"0"}:{label:"TODAY",message:"You're crushing it!",cta:null,action:null,pct:100,ringLabel:""}:null,Le=w.useCallback(async()=>{if(t){Bn(!0);try{const j=await En(In(Mt(Se,"posts"),fn("authorId","==",t.id),hu("createdAt","desc"),du(30)));gt(j.docs.map(Ce=>({id:Ce.id,...Ce.data()})));const G=await En(In(Mt(Se,"postLikes"),fn("userId","==",t.id)));rs(new Set(G.docs.map(Ce=>Ce.data().postId)))}catch(j){console.error("Error loading journey:",j)}finally{Bn(!1)}}},[t]);w.useEffect(()=>{pe&&t&&Le()},[pe,t,Le]);const He=j=>{const G=j.target.files?.[0];if(G){if(!G.type.startsWith("image/")){Lt("Please select an image file","error");return}if(G.size>10*1024*1024){Lt("Image must be under 10MB","error");return}Vt(G),At(URL.createObjectURL(G))}},Ft=()=>{Vt(null),Je&&URL.revokeObjectURL(Je),At(null),Fn.current&&(Fn.current.value="")},Ye=async()=>{if(!(!ue.trim()&&!yt||vt||!t)){nn(!0);try{let j=null;if(yt){const Re=await HM(yt),ze=`${Date.now()}_${Math.random().toString(36).slice(2,8)}`,ht=Ua(Ba,`postImages/${t.id}/${ze}`);await bd(ht,Re),j=await No(ht)}await ti(Mt(Se,"posts"),{authorId:t.id,authorName:t.name||"Unknown",authorPhotoURL:t.photoURL||null,content:ue.trim(),type:j?"image":"text",imageURL:j||null,createdAt:hr(),likeCount:0,commentCount:0});const Ce=ue.trim().match(/@[\w\s]+?(?=\s@|\s*$|[.,!?])/g);if(Ce){const Re=new Set;Ce.forEach(ze=>{const ht=ze.slice(1).trim(),et=mt.find(kt=>kt.name&&kt.name.toLowerCase()===ht.toLowerCase());et&&!Re.has(et.id)&&(Re.add(et.id),kn(et.id,"mention",{}))})}Rt(""),Ft(),Yt.current&&(Yt.current.style.height="auto"),await Le(),Lt("Posted!","success")}catch(j){console.error("Error posting:",j),Lt(j?.message||"Failed to post","error")}finally{nn(!1)}}},Kn=async j=>{if(window.confirm("Delete this post?"))try{await Er(nt(Se,"posts",j)),gt(G=>G.filter(Ce=>Ce.id!==j)),Lt("Post deleted","info")}catch(G){console.error("Delete error:",G),Lt("Failed to delete","error")}},os=async j=>{if(!t)return;const G=t.id,Ce=`${j}_${G}`,Re=js.has(j),ze=new Set(js);Re?ze.delete(j):ze.add(j),rs(ze),gt(ht=>ht.map(et=>et.id===j?{...et,likeCount:Math.max(0,(et.likeCount||0)+(Re?-1:1))}:et));try{if(Re)await Er(nt(Se,"postLikes",Ce)),await Hr(nt(Se,"posts",j),{likeCount:ko(-1)});else{await Os(nt(Se,"postLikes",Ce),{postId:j,userId:G,createdAt:hr()}),await Hr(nt(Se,"posts",j),{likeCount:ko(1)});const ht=rt.find(et=>et.id===j);ht&&kn(ht.authorId,"like",{postId:j})}}catch(ht){console.error("Like error:",ht),Le()}},Vs=async j=>{try{const G=await En(In(Mt(Se,"postComments"),fn("postId","==",j),hu("createdAt","asc"),du(50)));xt(Ce=>({...Ce,[j]:G.docs.map(Re=>({id:Re.id,...Re.data()}))}))}catch(G){console.error("Error loading comments:",G)}},Yn=j=>{const G=new Set(Xt);G.has(j)?G.delete(j):(G.add(j),Ne[j]||Vs(j)),ne(G)},mr=async j=>{const G=(bt[j]||"").trim(),Ce=on[j];if(!(!G&&!Ce||!t)){st(Re=>({...Re,[j]:!0}));try{let Re=null;if(Ce){const dt=Ua(Ba,`comment-images/${Date.now()}_${Ce.name}`);await bd(dt,Ce),Re=await No(dt)}const ze={postId:j,authorId:t.id,authorName:t.name||"Unknown",authorPhotoURL:t.photoURL||null,content:G||"",createdAt:hr()};Re&&(ze.imageURL=Re);const ht=Fe[j];ht&&(ze.replyToId=ht.id,ze.replyToName=ht.authorName),await ti(Mt(Se,"postComments"),ze),await Hr(nt(Se,"posts",j),{commentCount:ko(1)});const et=rt.find(dt=>dt.id===j);et&&kn(et.authorId,"comment",{postId:j});const kt=G.match(/@[\w\s]+?(?=\s@|\s*$|[.,!?])/g);if(kt){const dt=new Set;kt.forEach(P=>{const Y=P.slice(1).trim(),X=mt.find(ye=>ye.name&&ye.name.toLowerCase()===Y.toLowerCase());X&&!dt.has(X.id)&&(dt.add(X.id),kn(X.id,"mention",{postId:j}))})}it(dt=>({...dt,[j]:""})),Mn(dt=>({...dt,[j]:null})),Xn(dt=>({...dt,[j]:null})),sn(dt=>({...dt,[j]:null})),Cn.current[j]&&(Cn.current[j].value=""),gt(dt=>dt.map(P=>P.id===j?{...P,commentCount:(P.commentCount||0)+1}:P)),await Vs(j)}catch(Re){console.error("Comment error:",Re),Lt("Failed to comment","error")}finally{st(Re=>({...Re,[j]:!1}))}}},oa=async(j,G)=>{try{await Er(nt(Se,"postComments",G)),await Hr(nt(Se,"posts",j),{commentCount:ko(-1)}),xt(Ce=>({...Ce,[j]:(Ce[j]||[]).filter(Re=>Re.id!==G)})),gt(Ce=>Ce.map(Re=>Re.id===j?{...Re,commentCount:Math.max((Re.commentCount||1)-1,0)}:Re))}catch(Ce){console.error("Delete comment error:",Ce),Lt("Failed to delete comment","error")}},Ni=(j,G)=>{const Ce=G.target.files?.[0];if(!Ce)return;if(Ce.size>5*1024*1024){Lt("Image must be under 5MB","error");return}Mn(ze=>({...ze,[j]:Ce}));const Re=new FileReader;Re.onload=ze=>Xn(ht=>({...ht,[j]:ze.target.result})),Re.readAsDataURL(Ce)},Rr=j=>{Mn(G=>({...G,[j]:null})),Xn(G=>({...G,[j]:null})),Cn.current[j]&&(Cn.current[j].value="")},la=j=>{Rt(j.target.value),j.target.style.height="auto",j.target.style.height=Math.min(j.target.scrollHeight,120)+"px",Ln(j.target.value,"compose")},Ir=(j,G)=>{it(Ce=>({...Ce,[j]:G})),Ln(G,j)};return o.jsx(Fo,{children:o.jsxs("div",{className:"cb-dashboard","data-theme":h?"dark":"light",children:[o.jsx("header",{className:"client-header",children:o.jsxs("div",{className:"header-content",children:[o.jsxs("div",{className:"header-notif-wrap",ref:Ge,children:[o.jsxs("button",{className:"header-notif-btn",onClick:()=>{Ae(!oe),oe||Ks()},"aria-label":"Notifications",children:[o.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[o.jsx("path",{d:"M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"}),o.jsx("path",{d:"M13.73 21a2 2 0 0 1-3.46 0"})]}),qn>0&&o.jsx("span",{className:"header-notif-badge",children:qn>9?"9+":qn})]}),oe&&o.jsxs("div",{className:"notif-panel",children:[o.jsxs("div",{className:"notif-panel-header",children:[o.jsx("span",{className:"notif-panel-title",children:"Notifications"}),ln.length>0&&o.jsx("button",{className:"notif-clear-btn",onClick:ws,children:"Clear all"})]}),o.jsx("div",{className:"notif-panel-list",children:ln.length===0?o.jsx("div",{className:"notif-empty",children:"No notifications yet"}):ln.map(j=>o.jsxs("div",{className:`notif-item${j.read?"":" unread"}`,onClick:()=>{if(Ae(!1),j.type==="buddy_request"||j.type==="buddy_accept")b(g?"/client/core-buddy/buddies":"/upgrade");else if((j.type==="like"||j.type==="comment")&&j.postId){if(!Xt.has(j.postId)){const G=new Set(Xt);G.add(j.postId),ne(G),Ne[j.postId]||Vs(j.postId)}setTimeout(()=>{const G=document.getElementById(`post-${j.postId}`);G&&G.scrollIntoView({behavior:"smooth",block:"center"})},150)}else j.type==="like"||j.type==="comment"?document.querySelector(".cb-journey-section")?.scrollIntoView({behavior:"smooth"}):j.type==="mention"&&b(`/client/core-buddy/profile/${j.fromId}`)},children:[o.jsx("div",{className:"notif-item-avatar",children:j.fromPhotoURL?o.jsx("img",{src:j.fromPhotoURL,alt:""}):o.jsx("span",{children:(j.fromName||"?")[0]})}),o.jsxs("div",{className:"notif-item-body",children:[o.jsxs("p",{className:"notif-item-text",children:[o.jsx("strong",{children:j.fromName})," ",j.type==="buddy_request"&&"sent you a buddy request",j.type==="buddy_accept"&&"accepted your buddy request",j.type==="like"&&"liked your post",j.type==="comment"&&"commented on your post",j.type==="mention"&&"mentioned you"]}),o.jsx("span",{className:"notif-item-time",children:Dp(j.createdAt)})]})]},j.id))})]})]}),o.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),o.jsxs("div",{className:"header-actions",children:[o.jsx("button",{onClick:p,"aria-label":"Toggle theme",children:h?o.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("circle",{cx:"12",cy:"12",r:"5"}),o.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):o.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})}),o.jsx("button",{onClick:i,"aria-label":"Log out",children:o.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),o.jsx("polyline",{points:"16 17 21 12 16 7"}),o.jsx("line",{x1:"21",y1:"12",x2:"9",y2:"12"})]})})]})]})}),o.jsxs("main",{className:"cb-main",children:[o.jsxs("div",{className:"cb-ring-container",children:[o.jsxs("div",{className:"cb-ring",children:[o.jsx("svg",{className:"cb-ring-svg",viewBox:"0 0 200 200",children:NE.map((j,G)=>{const Ce=G<H;return o.jsx("line",{x1:j.x1,y1:j.y1,x2:j.x2,y2:j.y2,className:`ring-tick ${Ce?"elapsed":"remaining"}`,strokeWidth:j.thick?"3":"2"},G)})}),o.jsxs("div",{className:"cb-ring-center",children:[o.jsxs("div",{className:"cb-ring-logo",onClick:()=>xe.current?.click(),role:"button",tabIndex:0,"aria-label":"Change profile photo",children:[o.jsx("img",{src:ie||"/Logo.webp",alt:ie?"Profile":"Mind Core Fitness"}),o.jsx("div",{className:`cb-photo-overlay${ke?" uploading":""}`,children:ke?o.jsx("div",{className:"cb-photo-spinner"}):o.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"#fff",strokeWidth:"2",children:[o.jsx("path",{d:"M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"}),o.jsx("circle",{cx:"12",cy:"13",r:"4"})]})}),o.jsx("input",{ref:xe,type:"file",accept:"image/*",onChange:Gr,style:{display:"none"}})]}),!ie&&!ke&&o.jsx("div",{className:"cb-photo-badge",onClick:()=>xe.current?.click(),children:o.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"#fff",strokeWidth:"2.5",children:[o.jsx("path",{d:"M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"}),o.jsx("circle",{cx:"12",cy:"13",r:"4"})]})})]})]}),o.jsxs("div",{className:"cb-ring-countdown",children:[o.jsx("span",{className:"cb-timer-digit",children:String(T.hours).padStart(2,"0")}),o.jsx("span",{className:"cb-timer-colon",children:":"}),o.jsx("span",{className:"cb-timer-digit",children:String(T.minutes).padStart(2,"0")}),o.jsx("span",{className:"cb-timer-colon",children:":"}),o.jsx("span",{className:"cb-timer-digit cb-timer-seconds",children:String(T.seconds).padStart(2,"0")})]}),o.jsx("span",{className:"cb-ring-label",children:"remaining today"}),o.jsxs("p",{className:"cb-ring-tagline",children:[Ip[Pe].text," ",o.jsx("strong",{children:Ip[Pe].bold})]},Pe)]}),o.jsx("div",{className:"cb-stats-row",children:z.map(j=>{const G=(j.size==="large",38),Ce=2*Math.PI*G,Re=Ce-j.pct/100*Ce,ze=j.editable;return o.jsxs("div",{className:`cb-stat-item${j.size==="large"?" cb-stat-large":""}`,children:[o.jsxs("div",{className:`cb-stat-ring${ze?" cb-stat-tappable":""}${ze&&Ie?" cb-stat-hint":""}`,onClick:ze?()=>{we(!0),Be(!1)}:void 0,children:[o.jsxs("svg",{viewBox:"0 0 100 100",children:[o.jsx("circle",{className:"cb-stat-track",cx:"50",cy:"50",r:G}),o.jsx("circle",{className:"cb-stat-fill",cx:"50",cy:"50",r:G,style:{stroke:j.color},strokeDasharray:Ce,strokeDashoffset:Re})]}),o.jsx("span",{className:"cb-stat-value",style:{color:j.color},children:j.value})]}),o.jsx("span",{className:"cb-stat-label",children:j.label})]},j.label)})}),Z&&o.jsx("div",{className:"cb-target-overlay",onClick:()=>we(!1),children:o.jsxs("div",{className:"cb-target-picker",onClick:j=>j.stopPropagation(),children:[o.jsx("h4",{children:"Weekly workout goal"}),o.jsx("p",{children:"How many sessions per week?"}),o.jsx("div",{className:"cb-target-options",children:[1,2,3,4,5,6,7].map(j=>o.jsx("button",{className:`cb-target-option${j===Ue?" active":""}`,onClick:()=>xs(j),children:j},j))})]})}),o.jsxs("p",{className:"cb-coach-msg",children:[le.main," ",o.jsx("strong",{children:nr}),"  ",le.sub]}),Me&&o.jsxs("button",{className:"cb-nudge-card",onClick:Me.action||void 0,style:Me.action?void 0:{cursor:"default"},children:[o.jsxs("div",{className:"cb-nudge-ring",children:[o.jsxs("svg",{viewBox:"0 0 100 100",children:[o.jsx("circle",{className:"cb-nudge-ring-track",cx:"50",cy:"50",r:"38"}),o.jsx("circle",{className:"cb-nudge-ring-fill",cx:"50",cy:"50",r:"38",strokeDasharray:2*Math.PI*38,strokeDashoffset:2*Math.PI*38-Me.pct/100*2*Math.PI*38})]}),o.jsx("span",{className:"cb-nudge-ring-val",children:Me.ringLabel})]}),o.jsxs("div",{className:"cb-nudge-info",children:[o.jsx("span",{className:"cb-nudge-label",children:Me.label}),o.jsx("span",{className:"cb-nudge-title",children:Me.message}),Me.cta&&o.jsxs("span",{className:"cb-nudge-cta",children:[Me.cta," "]})]})]}),o.jsxs("div",{className:"cb-features",children:[g&&o.jsxs("button",{className:"cb-feature-card cb-card-nutrition cb-card-has-preview ripple-btn",onClick:j=>{bn(j),b("/client/core-buddy/nutrition")},children:[o.jsxs("div",{className:"cb-card-top-row",children:[o.jsx("div",{className:"cb-card-content",children:o.jsx("h3",{children:"Today's Nutrition"})}),o.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M9 18l6-6-6-6"})})]}),o.jsx("div",{className:"cb-card-preview-row",children:o.jsx("div",{className:"cb-mini-rings",children:[{label:"P",pct:ae("protein"),color:"var(--color-primary)"},{label:"C",pct:ae("carbs"),color:"var(--color-primary)"},{label:"F",pct:ae("fats"),color:"var(--color-primary)"},{label:"Cal",pct:ae("calories"),color:"var(--color-primary)"}].map(j=>{const Ce=2*Math.PI*38,Re=Ce-j.pct/100*Ce;return o.jsxs("div",{className:"cb-mini-ring",children:[o.jsxs("svg",{viewBox:"0 0 100 100",children:[o.jsx("circle",{className:"cb-mini-track",cx:"50",cy:"50",r:38}),o.jsx("circle",{className:"cb-mini-fill",cx:"50",cy:"50",r:38,style:{stroke:j.color},strokeDasharray:Ce,strokeDashoffset:Re})]}),o.jsx("span",{style:{color:j.color},children:j.label})]},j.label)})})}),o.jsx("p",{className:"cb-card-desc",children:"Track macros, scan barcodes, log water"})]}),o.jsxs("button",{className:"cb-feature-card cb-card-workouts-hero ripple-btn",onClick:j=>{bn(j),b("/client/core-buddy/workouts")},children:[o.jsx("h3",{className:"cb-hero-title",children:"Workout"}),o.jsxs("div",{className:"cb-hero-stats",children:[o.jsxs("span",{children:[M," this week"]}),o.jsx("span",{className:"cb-hero-dot",children:""}),o.jsxs("span",{children:[B," total"]})]}),o.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M9 18l6-6-6-6"})})]}),o.jsxs("button",{className:"cb-feature-card cb-card-consistency ripple-btn",onClick:j=>{bn(j),b("/client/core-buddy/consistency")},children:[o.jsxs("div",{className:"cb-card-content",children:[o.jsx("h3",{children:"Habits"}),o.jsx("div",{className:"cb-habit-dots",children:Array.from({length:E},(j,G)=>o.jsx("span",{className:`cb-habit-dot${G<V?" done":""}`},G))}),o.jsxs("span",{className:"cb-habit-dots-label",children:[V,"/",E," today"]})]}),o.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M9 18l6-6-6-6"})})]}),o.jsxs("button",{className:"cb-feature-card cb-card-leaderboard ripple-btn",onClick:j=>{bn(j),b("/client/leaderboard")},children:[o.jsxs("div",{className:"cb-card-content",children:[o.jsx("h3",{children:"Leaderboard"}),re.length>0?o.jsx("div",{className:"cb-lb-preview",children:re.map((j,G)=>{const Ce=["#FFD700","#A8B4C0","#CD7F32"][G],Re=j.name?j.name.split(" ").map(ht=>ht[0]).join("").slice(0,2).toUpperCase():"?",ze=j.id===t?.id;return o.jsxs("div",{className:`cb-lb-entry${ze?" cb-lb-me":""}`,children:[o.jsx("div",{className:"cb-lb-avatar",style:{borderColor:Ce},children:j.photoURL?o.jsx("img",{src:j.photoURL,alt:"",className:"cb-lb-avatar-img"}):o.jsx("span",{children:Re})}),o.jsxs("span",{className:"cb-lb-rank",style:{color:Ce},children:["#",G+1]})]},j.id)})}):o.jsx("p",{children:"Opt in to compete with your Core Buddies"})]}),o.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M9 18l6-6-6-6"})})]}),g&&o.jsxs("button",{className:"cb-feature-card cb-card-buddies ripple-btn",onClick:j=>{bn(j),b("/client/core-buddy/buddies")},children:[o.jsxs("div",{className:"cb-card-content",children:[o.jsx("h3",{children:"Buddies"}),o.jsx("p",{children:"Connect with other members and track each other's progress"})]}),o.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M9 18l6-6-6-6"})})]}),g&&o.jsxs("div",{className:"cb-journey-section",children:[o.jsx("h3",{className:"cb-journey-title",children:"My Journey"}),o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"journey-compose",children:[o.jsx("div",{className:"journey-compose-avatar",children:ie?o.jsx("img",{src:ie,alt:""}):o.jsx("span",{children:Oc(t?.name)})}),o.jsxs("div",{className:"journey-compose-body",style:{position:"relative"},children:[o.jsx("textarea",{ref:Yt,placeholder:"Share your progress... (use @ to mention)",value:ue,onChange:la,rows:1,maxLength:500}),dn&&Cs==="compose"&&ds.length>0&&o.jsx("div",{className:"mention-dropdown",children:ds.map(j=>o.jsxs("button",{className:"mention-option",onClick:()=>as(j,"compose"),children:[o.jsx("div",{className:"mention-option-avatar",children:j.photoURL?o.jsx("img",{src:j.photoURL,alt:""}):o.jsx("span",{children:Oc(j.name)})}),o.jsx("span",{children:j.name})]},j.id))}),Je&&o.jsxs("div",{className:"journey-image-preview",children:[o.jsx("img",{src:Je,alt:"Preview"}),o.jsx("button",{className:"journey-image-remove",onClick:Ft,"aria-label":"Remove image",children:o.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",children:[o.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),o.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})})]}),o.jsxs("div",{className:"journey-compose-actions",children:[o.jsx("button",{className:"journey-image-btn",onClick:()=>Fn.current?.click(),"aria-label":"Add image",children:o.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[o.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),o.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),o.jsx("path",{d:"M21 15l-5-5L5 21"})]})}),o.jsx("input",{ref:Fn,type:"file",accept:"image/*",onChange:He,hidden:!0}),(ue.trim()||yt)&&o.jsx("button",{className:"journey-post-btn",onClick:Ye,disabled:vt,children:vt?o.jsx("div",{className:"journey-btn-spinner"}):"Post"})]})]})]}),ut?o.jsx("div",{className:"journey-loading",children:o.jsx("div",{className:"cb-spinner"})}):rt.length===0?o.jsxs("div",{className:"journey-empty",children:[o.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[o.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),o.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),o.jsx("path",{d:"M21 15l-5-5L5 21"})]}),o.jsx("p",{children:"Start sharing your fitness journey!"})]}):o.jsx("div",{className:"journey-list",children:rt.map(j=>o.jsxs("div",{id:`post-${j.id}`,className:"journey-post",children:[o.jsxs("div",{className:"journey-post-header",children:[o.jsx("div",{className:"journey-post-avatar",children:j.authorPhotoURL?o.jsx("img",{src:j.authorPhotoURL,alt:""}):o.jsx("span",{children:Oc(j.authorName)})}),o.jsxs("div",{className:"journey-post-meta",children:[o.jsx("span",{className:"journey-post-name",children:j.authorName}),o.jsx("span",{className:"journey-post-time",children:Dp(j.createdAt)})]}),o.jsx("button",{className:"journey-delete-btn",onClick:()=>Kn(j.id),"aria-label":"Delete post",children:o.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("path",{d:"M3 6h18"}),o.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),o.jsx("path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]}),j.type==="workout_summary"&&j.metadata?o.jsxs("div",{className:"journey-card",children:[o.jsx("div",{className:"journey-card-logo-frame",children:o.jsx("img",{src:"/Logo.webp",alt:"MCF",className:"journey-card-logo-img"})}),o.jsx("h3",{className:"journey-card-title",children:j.metadata.title}),j.metadata.stats?.length>0&&o.jsx("p",{className:"journey-card-stats-line",children:j.metadata.stats.map(G=>`${G.value} ${G.label}`).join("    ")}),!j.metadata.stats?.length&&j.metadata.subtitle&&o.jsx("p",{className:"journey-card-stats-line",children:j.metadata.subtitle}),o.jsx("p",{className:"journey-card-cta",children:"I just completed a workout using Core Buddy "}),o.jsx("p",{className:"journey-card-slogan",children:"Make It Count with Core Buddy"})]}):j.type==="badge_earned"&&j.metadata?o.jsxs("div",{className:"journey-card",children:[o.jsx("div",{className:"journey-card-logo-frame journey-card-logo-badge",children:o.jsx("img",{src:"/Logo.webp",alt:j.metadata.title,className:"journey-card-logo-img"})}),o.jsx("h3",{className:"journey-card-title",children:j.metadata.title}),j.metadata.badgeDesc&&o.jsx("p",{className:"journey-card-stats-line",children:j.metadata.badgeDesc}),o.jsx("p",{className:"journey-card-cta",children:"I just earned a badge on Core Buddy"}),o.jsx("p",{className:"journey-card-slogan",children:"Make It Count with Core Buddy"})]}):j.type==="habits_summary"&&j.metadata?o.jsxs("div",{className:"journey-card",children:[o.jsx("div",{className:"journey-card-logo-frame",children:o.jsx("img",{src:"/Logo.webp",alt:"MCF",className:"journey-card-logo-img"})}),o.jsx("h3",{className:"journey-card-title",children:j.metadata.title}),j.metadata.stats?.length>0&&o.jsx("p",{className:"journey-card-stats-line",children:j.metadata.stats.map(G=>`${G.value} ${G.label}`).join("    ")}),j.metadata.subtitle&&o.jsx("p",{className:"journey-card-stats-line",children:j.metadata.subtitle}),o.jsx("p",{className:"journey-card-cta",children:"I just completed my daily habits with Core Buddy "}),o.jsx("p",{className:"journey-card-slogan",children:"Make It Count with Core Buddy"})]}):o.jsxs(o.Fragment,{children:[j.content&&o.jsx("p",{className:"journey-post-content",children:zt(j.content)}),j.imageURL&&o.jsx("div",{className:"journey-post-image",children:o.jsx("img",{src:j.imageURL,alt:"Post",loading:"lazy"})})]}),o.jsxs("div",{className:"journey-post-actions",children:[o.jsxs("button",{className:`journey-action-btn${js.has(j.id)?" liked":""}`,onClick:()=>os(j.id),children:[o.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:js.has(j.id)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})}),o.jsx("span",{children:j.likeCount||0})]}),o.jsxs("button",{className:`journey-action-btn${Xt.has(j.id)?" active":""}`,onClick:()=>Yn(j.id),children:[o.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})}),o.jsx("span",{children:j.commentCount||0})]})]}),Xt.has(j.id)&&o.jsxs("div",{className:"journey-comments",children:[Ne[j.id]?.length>0?Ne[j.id].map(G=>o.jsxs("div",{className:"journey-comment",children:[o.jsx("div",{className:"journey-comment-avatar",children:G.authorPhotoURL?o.jsx("img",{src:G.authorPhotoURL,alt:""}):o.jsx("span",{children:Oc(G.authorName)})}),o.jsxs("div",{className:"journey-comment-body",children:[o.jsxs("div",{className:"journey-comment-bubble",children:[o.jsx("span",{className:"journey-comment-name",children:G.authorName}),G.replyToName&&o.jsxs("span",{className:"journey-comment-reply-tag",children:[o.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("polyline",{points:"9 14 4 9 9 4"}),o.jsx("path",{d:"M20 20v-7a4 4 0 0 0-4-4H4"})]}),G.replyToName]}),G.content&&o.jsx("span",{className:"journey-comment-text",children:zt(G.content)}),G.imageURL&&o.jsx("img",{className:"journey-comment-image",src:G.imageURL,alt:"Comment",loading:"lazy"})]}),o.jsxs("div",{className:"journey-comment-actions-row",children:[o.jsx("span",{className:"journey-comment-time",children:Dp(G.createdAt)}),o.jsx("button",{className:"journey-comment-reply-btn",onClick:()=>sn(Ce=>({...Ce,[j.id]:{id:G.id,authorName:G.authorName}})),children:"Reply"}),o.jsx("button",{className:"journey-comment-delete-btn",onClick:()=>oa(j.id,G.id),"aria-label":"Delete comment",children:o.jsxs("svg",{width:"13",height:"13",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("path",{d:"M3 6h18"}),o.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),o.jsx("path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]})]})]},G.id)):o.jsx("p",{className:"journey-no-comments",children:"No comments yet"}),Fe[j.id]&&o.jsxs("div",{className:"journey-comment-replying",children:[o.jsxs("span",{children:["Replying to ",o.jsx("strong",{children:Fe[j.id].authorName})]}),o.jsx("button",{onClick:()=>sn(G=>({...G,[j.id]:null})),"aria-label":"Cancel reply",children:o.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",children:[o.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),o.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})})]}),zn[j.id]&&o.jsxs("div",{className:"journey-comment-img-preview",children:[o.jsx("img",{src:zn[j.id],alt:"Preview"}),o.jsx("button",{onClick:()=>Rr(j.id),"aria-label":"Remove image",children:o.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",children:[o.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),o.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})})]}),o.jsxs("div",{className:"journey-comment-input",style:{position:"relative"},children:[o.jsx("button",{className:"journey-comment-img-btn",onClick:()=>Cn.current[j.id]?.click(),"aria-label":"Add image",children:o.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[o.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),o.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),o.jsx("path",{d:"M21 15l-5-5L5 21"})]})}),o.jsx("input",{ref:G=>{Cn.current[j.id]=G},type:"file",accept:"image/*",onChange:G=>Ni(j.id,G),hidden:!0}),o.jsx("input",{type:"text",placeholder:"Comment",value:bt[j.id]||"",onChange:G=>Ir(j.id,G.target.value),onKeyDown:G=>{G.key==="Enter"&&mr(j.id)},maxLength:300}),dn&&Cs===j.id&&ds.length>0&&o.jsx("div",{className:"mention-dropdown mention-dropdown-up",children:ds.map(G=>o.jsxs("button",{className:"mention-option",onClick:()=>as(G,j.id),children:[o.jsx("div",{className:"mention-option-avatar",children:G.photoURL?o.jsx("img",{src:G.photoURL,alt:""}):o.jsx("span",{children:Oc(G.name)})}),o.jsx("span",{children:G.name})]},G.id))}),o.jsx("button",{onClick:()=>mr(j.id),disabled:!(bt[j.id]||"").trim()&&!on[j.id]||$e[j.id],children:$e[j.id]?o.jsx("div",{className:"journey-btn-spinner-sm"}):o.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("line",{x1:"22",y1:"2",x2:"11",y2:"13"}),o.jsx("polygon",{points:"22 2 15 22 11 13 2 9 22 2"})]})})]})]})]},j.id))})]})]}),!g&&o.jsxs("button",{className:"cb-upgrade-cta",onClick:()=>b("/upgrade"),children:[o.jsx("span",{className:"cb-upgrade-cta-text",children:"Unlock the full experience"}),o.jsx("span",{className:"cb-upgrade-cta-sub",children:"Unlimited workout times, nutrition, buddies & more"}),o.jsxs("svg",{className:"cb-upgrade-cta-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("path",{d:"M5 12h14"}),o.jsx("path",{d:"M12 5l7 7-7 7"})]})]})]})]}),o.jsx(sa,{active:"home"}),jn&&o.jsxs("div",{className:`toast-notification ${jn.type}`,children:[jn.type==="info"&&o.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("circle",{cx:"12",cy:"12",r:"10"}),o.jsx("line",{x1:"12",y1:"16",x2:"12",y2:"12"}),o.jsx("line",{x1:"12",y1:"8",x2:"12.01",y2:"8"})]}),jn.message]}),o.jsx(FM,{steps:Nr,active:jr,onFinish:Ar})]})})}const Mp=new Map;function Zr(){return new Date().toISOString().split("T")[0]}const u_=[{key:"breakfast",label:"Breakfast"},{key:"lunch",label:"Lunch"},{key:"dinner",label:"Dinner"},{key:"snacks",label:"Snacks"}],WM={breakfast:o.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[o.jsx("path",{d:"M18 8h1a4 4 0 0 1 0 8h-1"}),o.jsx("path",{d:"M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z"}),o.jsx("line",{x1:"6",y1:"1",x2:"6",y2:"4"}),o.jsx("line",{x1:"10",y1:"1",x2:"10",y2:"4"}),o.jsx("line",{x1:"14",y1:"1",x2:"14",y2:"4"})]}),lunch:o.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[o.jsx("circle",{cx:"12",cy:"12",r:"5"}),o.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}),dinner:o.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:o.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})}),snacks:o.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:o.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})})};function GM(){const s=new Date().getHours();return s<11?"breakfast":s<14?"lunch":s<17?"snacks":"dinner"}function KM(){const{currentUser:s,isClient:e,clientData:t,loading:i}=Ci(),{isDark:l,toggleTheme:u,accent:h}=zo(),p=Sr(),[g,y]=w.useState("loading"),[b,E]=w.useState(null),[T,O]=w.useState({gender:"male",age:"",weight:"",weightUnit:"kg",height:"",heightUnit:"cm",heightFeet:"",heightInches:"",dailyActivity:"sedentary",trainingFrequency:"moderate",goal:"maintain",deficitLevel:"moderate"}),[H,q]=w.useState(null),[B,te]=w.useState(Zr()),[W,ee]=w.useState({entries:[]}),[pe,Te]=w.useState({protein:0,carbs:0,fats:0,calories:0}),[ve,A]=w.useState(!1),[S,I]=w.useState(()=>{const R=new Date;return{year:R.getFullYear(),month:R.getMonth()}}),[V,D]=w.useState(!1),[M,N]=w.useState(()=>{const R=new Date;return{year:R.getFullYear(),month:R.getMonth()}}),[Ue,Ze]=w.useState(!1),[Z,we]=w.useState(GM),[Ie,Be]=w.useState(null),[re,L]=w.useState(null),[ie,_e]=w.useState(!1),[ke,Ee]=w.useState(null),[xe,Ke]=w.useState(""),[ct,Pe]=w.useState(!1),[tn,jn]=w.useState(""),[Un,Lt]=w.useState([]),[rt,gt]=w.useState(!1),[ut,Bn]=w.useState({name:"",protein:"",carbs:"",fats:"",calories:"",serving:""}),[ue,Rt]=w.useState(null),[yt,Vt]=w.useState("100"),[Je,At]=w.useState(0),[vt,nn]=w.useState("weight"),[js,rs]=w.useState(0),[Xt,ne]=w.useState(null);w.useRef(null);const Ne=w.useRef(!1),xt=w.useRef(null),bt=w.useRef(null),it=w.useRef(null),$e=w.useCallback((R,z="info")=>{ne({message:R,type:z}),setTimeout(()=>ne(null),3e3)},[]);w.useEffect(()=>{!i&&(!s||!e)&&p("/")},[s,e,i,p]),w.useEffect(()=>{if(!t?.id)return;(async()=>{try{const z=await dr(nt(Se,"nutritionTargets",t.id));z.exists()?(E(z.data()),y("dashboard")):y("setup")}catch(z){console.error("Error loading nutrition data:",z),y("setup")}})()},[t?.id]),w.useEffect(()=>{if(!t?.id)return;(async()=>{try{const z=await dr(nt(Se,"nutritionLogs",`${t.id}_${B}`));if(z.exists()){const ae=z.data();ee({entries:ae.entries||[]})}else ee({entries:[]})}catch(z){console.error("Error loading log:",z),ee({entries:[]})}})()},[t?.id,B]),w.useEffect(()=>{const R=W.entries.reduce((z,ae)=>({protein:z.protein+(ae.protein||0),carbs:z.carbs+(ae.carbs||0),fats:z.fats+(ae.fats||0),calories:z.calories+(ae.calories||0)}),{protein:0,carbs:0,fats:0,calories:0});Te(R)},[W.entries]);const st=async R=>{try{await Os(nt(Se,"nutritionLogs",`${t.id}_${B}`),{clientId:t.id,date:B,entries:R.entries,updatedAt:Gt.now()})}catch(z){console.error("Error saving nutrition log:",z)}},Fe=B===Zr(),sn=(R,z)=>new Date(R,z+1,0).getDate(),on=(R,z)=>new Date(R,z,1).getDay(),Mn=R=>{if(R===Zr())return"Today";const z=new Date(R+"T12:00:00"),ae=new Date;return ae.setDate(ae.getDate()-1),R===ae.toISOString().split("T")[0]?"Yesterday":z.toLocaleDateString("en-GB",{weekday:"short",day:"numeric",month:"short"})},zn=["January","February","March","April","May","June","July","August","September","October","November","December"],Xn=["Su","Mo","Tu","We","Th","Fr","Sa"],Yt=()=>{let R=parseFloat(T.weight);T.weightUnit==="lbs"&&(R*=.453592);let z;T.heightUnit==="cm"?z=parseFloat(T.height):z=(parseFloat(T.heightFeet)||0)*30.48+(parseFloat(T.heightInches)||0)*2.54;const ae=parseInt(T.age);let le=T.gender==="male"?10*R+6.25*z-5*ae+5:10*R+6.25*z-5*ae-161;const Le=le*{sedentary:1.2,light:1.3,moderate:1.4,active:1.5}[T.dailyActivity],He={low:100,moderate:200,high:300,daily:400},Ft=Math.round(Le+He[T.trainingFrequency]);let Ye=Ft,Kn,os;switch(T.goal){case"lose":Ye=Ft*(1-{light:.15,moderate:.2,harsh:.25}[T.deficitLevel]),Kn=2.2,os=.3;break;case"build":Ye=Ft*1.1,Kn=2,os=.22;break;default:Kn=1.8,os=.25}Ye=Math.max(Ye,T.gender==="male"?1400:1100);const Vs=Math.round(R*Kn),Yn=Math.round(Ye*os/9),mr=Math.max(0,Math.round((Ye-Vs*4-Yn*9)/4));q({calories:Math.round(Ye),protein:Vs,carbs:mr,fats:Yn,bmr:Math.round(le),neat:Math.round(Le),exerciseAdd:He[T.trainingFrequency],tdee:Math.round(Ft)})},Fn=async()=>{if(H)try{const R={clientId:t.id,calories:H.calories,protein:H.protein,carbs:H.carbs,fats:H.fats,goal:T.goal,updatedAt:Gt.now()};await Os(nt(Se,"nutritionTargets",t.id),R),E(R),y("dashboard"),$e("Macro targets saved!","success")}catch(R){console.error("Error saving targets:",R),$e("Failed to save targets. Please try again.","error")}},Cn=()=>{const R=T.weight&&parseFloat(T.weight)>0,z=T.age&&parseInt(T.age)>0,ae=T.heightUnit==="cm"?T.height&&parseFloat(T.height)>0:T.heightFeet&&parseFloat(T.heightFeet)>0||T.heightInches&&parseFloat(T.heightInches)>0;return R&&z&&ae},ln="nut_favourite_foods",fr=()=>{try{return JSON.parse(localStorage.getItem(ln)||"[]")}catch{return[]}};w.useEffect(()=>{if(!t?.id)return;(async()=>{try{const z=await dr(nt(Se,"favouriteFoods",t.id));if(z.exists()){const ae=z.data().items||[];localStorage.setItem(ln,JSON.stringify(ae)),rs(le=>le+1)}else{const ae=fr();ae.length>0&&await Os(nt(Se,"favouriteFoods",t.id),{items:ae,updatedAt:Gt.now()})}}catch(z){console.error("Error loading favourites:",z)}})()},[t?.id]);const oe=R=>fr().some(z=>z.name.toLowerCase()===(R||"").toLowerCase()),Ae=R=>{const z=fr(),ae=z.findIndex(le=>le.name.toLowerCase()===R.name.toLowerCase());ae>=0?z.splice(ae,1):z.unshift({name:R.name,protein:R.protein,carbs:R.carbs,fats:R.fats,calories:R.calories,serving:R.serving,per100g:R.per100g||null,servingUnit:R.servingUnit||"g",portion:R.portion||null}),localStorage.setItem(ln,JSON.stringify(z)),t?.id&&Os(nt(Se,"favouriteFoods",t.id),{items:z,updatedAt:Gt.now()}).catch(le=>console.error("Error saving favourites:",le)),rs(le=>le+1)},Ge=R=>{const z=[...W.entries,{...R,meal:Z,id:Date.now(),addedAt:new Date().toISOString()}],ae={...W,entries:z};ee(ae),st(ae),L(null),Rt(null),Vt("100"),At(0),nn("weight"),Bn({name:"",protein:"",carbs:"",fats:"",calories:"",serving:""}),$e("Food added!","success")},mt=R=>{const z=W.entries.filter(le=>le.id!==R),ae={...W,entries:z};ee(ae),st(ae)},lt=async R=>{if(!(!t?.id||R===B)){Ze(!0);try{const z=await dr(nt(Se,"nutritionLogs",`${t.id}_${R}`));if(!z.exists()||!z.data().entries?.length){$e("No food logged on that day","error");return}const ae=z.data().entries.map(Le=>({...Le,id:Date.now()+Math.random(),addedAt:new Date().toISOString()})),le=[...W.entries,...ae],Me={...W,entries:le};ee(Me),st(Me),D(!1),$e(`Copied ${ae.length} items from ${Mn(R)}`,"success")}catch(z){console.error("Error copying day:",z),$e("Failed to copy day","error")}finally{Ze(!1)}}},yn=w.useRef(null),Nn=w.useRef([]),dn=3,vn=5,Cs=async()=>{_e(!0);const R=document.querySelector("#barcode-reader");if(!R){_e(!1),$e("Scanner container not found.","error");return}if(!yn.current)try{const ae=await Gs(()=>import("./quagga.min-BbicSfvA.js").then(le=>le.q),[]);yn.current=ae.default}catch(ae){console.error("Failed to load barcode scanner:",ae),_e(!1),$e("Could not load scanner.","error");return}const z=yn.current;z.init({inputStream:{type:"LiveStream",target:R,constraints:{facingMode:"environment",width:{min:640,ideal:1280,max:1920},height:{min:480,ideal:720,max:1080}}},locator:{patchSize:"medium",halfSample:!0},numOfWorkers:navigator.hardwareConcurrency||2,decoder:{readers:["ean_reader","ean_8_reader","upc_reader","upc_e_reader","code_128_reader","code_39_reader"]},locate:!0},ae=>{if(ae){console.error("Quagga init error:",ae),_e(!1),$e("Could not access camera. Check permissions.","error");return}z.start(),Ne.current=!0}),Nn.current=[],z.onDetected(ae=>{const le=ae.codeResult.decodedCodes?.filter(Le=>Le.error!==void 0)?.map(Le=>Le.error)||[];if((le.length>0?le.reduce((Le,He)=>Le+He,0)/le.length:1)<.15){const Le=ae.codeResult.code,He=Nn.current;He.push(Le),He.length>vn&&He.shift(),He.filter(Ye=>Ye===Le).length>=dn&&(z.offDetected(),Nn.current=[],Ee(Le))}})},is=()=>{const R=yn.current;Ne.current&&R&&(R.stop(),R.offDetected(),Ne.current=!1),_e(!1)},ds=/\b(milk|semi.skimmed|skimmed|whole milk|oat milk|almond milk|soy milk|juice|smoothie|water|squash|cordial|cola|pepsi|fanta|lemonade|soda|beer|wine|cider|lager|spirit|whisky|vodka|rum|gin|brandy|cream|yoghurt drink|milkshake|coffee|tea|broth|stock|soup|sauce|ketchup|vinegar|oil|syrup|honey|custard|coconut water|kombucha|energy drink|protein shake)\b/i,Jt=R=>/ml|cl|\dl(?!b)|litre|liter|fl\s?oz/i.test((R||"").replace(/\s/g,"")),An=R=>{if(!R)return{value:100,unit:"g"};const z=R.toLowerCase().replace(/\s/g,""),ae=z.match(/([\d.]+)/),le=ae?parseFloat(ae[1]):100;return Jt(R)?/cl/.test(z)?{value:le*10,unit:"ml"}:/(?:^|\d)l(?!i)/.test(z)&&!/ml/.test(z)?{value:le*1e3,unit:"ml"}:{value:le,unit:"ml"}:{value:le,unit:"g"}},Ns=R=>{if(Jt(R.serving_size)||Jt(R.quantity))return"ml";const z=R.product_name||R.product_name_en||"";return ds.test(z)?"ml":"g"},jr=[{pattern:/\b(toast|bread|loaf|brioche|bagel|pitta|wrap|tortilla|crumpet|muffin|waffle|pancake)\b/i,label:"slice",weight:36},{pattern:/\begg\b/i,label:"egg",weight:60},{pattern:/\b(biscuit|cookie|digestive|hobnob|rich tea|oreo)\b/i,label:"biscuit",weight:13},{pattern:/\b(sausage|banger)\b/i,label:"sausage",weight:57},{pattern:/\b(rasher|bacon)\b/i,label:"rasher",weight:25},{pattern:/\b(rice cake)\b/i,label:"cake",weight:9},{pattern:/\b(cracker|ryvita)\b/i,label:"cracker",weight:10}],ai=(R,z)=>{const ae=R||"",le=ae.match(/\((\d+\.?\d*)\s*g\)/i),Me=ae.match(/(?:^|per\s+)(\d*\s*[a-z][a-z\s]*?)(?:\s*\(|\s*-\s*|\s*$)/i);if(le&&Me){const Ft=parseFloat(le[1]);let Ye=Me[1].replace(/^\d+\s*/,"").trim();if(Ye&&Ft>0)return{label:Ye,weight:Ft}}const Le=ae.match(/(\d+\.?\d*)\s*g\s*[\/=]\s*(\d*\s*[a-z][a-z\s]*)/i);if(Le){const Ft=parseFloat(Le[1]);let Ye=Le[2].replace(/^\d+\s*/,"").trim();if(Ye&&Ft>0)return{label:Ye,weight:Ft}}const He=z||"";for(const{pattern:Ft,label:Ye,weight:Kn}of jr)if(Ft.test(He))return{label:Ye,weight:Kn};return null},Cr=R=>{const z=R.nutriments||{},ae=Ns(R),le=An(R.serving_size),Me=ae==="ml"?le.unit==="ml"?le.value:100:le.value,Le=R.product_name||R.product_name_en||"Unknown Product",He=ai(R.serving_size,Le);return{name:Le,brand:R.brands||"",image:R.image_small_url||R.image_url||null,servingSize:R.serving_size||"100g",servingValue:Me,servingUnit:ae,portion:He,protein:Math.round(z.proteins_100g||z.proteins||0),carbs:Math.round(z.carbohydrates_100g||z.carbohydrates||0),fats:Math.round(z.fat_100g||z.fat||0),calories:Math.round(z["energy-kcal_100g"]||z["energy-kcal"]||(z.energy_100g?z.energy_100g/4.184:0)),per100g:!0}},Nr=async R=>{Pe(!0);try{const z=`https://world.openfoodfacts.org/api/v2/product/${R}?fields=product_name,product_name_en,brands,image_small_url,image_url,serving_size,quantity,nutriments`,ae=await fetch(z);if(!ae.ok)throw new Error(`HTTP ${ae.status}`);const le=await ae.json();if(le.status==="success"||le.status===1||le.product){const Me=Cr(le.product);Me.calories===0&&Me.protein===0&&Me.carbs===0?$e("Product found but no nutrition data available.","error"):(Rt(Me),Me.portion?(At(1),Vt(String(Me.portion.weight)),nn("portion")):(At(0),Vt(String(Me.servingValue||100)),nn("weight")),Ke(""))}else $e("Product not found. Try search or manual entry.","error")}catch(z){console.error("Barcode lookup error:",z),$e("Failed to look up product. Check your connection.","error")}Pe(!1)},qn=(R,z,ae)=>{const le=R.toLowerCase().trim(),Me=z.toLowerCase().trim(),Le=ae.toLowerCase().trim();let He=0;return(le===Le||le===Le+"s"||le+"s"===Le)&&(He+=100),(le.endsWith(" "+Le)||le.endsWith(" "+Le+"s"))&&(He+=40),(le.startsWith(Le+" ")||le.startsWith(Le+"s "))&&(He+=15),Le.split(/\s+/).some(Ye=>Me===Ye||Me.startsWith(Ye))&&(He+=30),He+=Math.max(0,30-le.length),He},Ks=async()=>{if(!tn.trim())return;xt.current&&xt.current.abort();const R=new AbortController;xt.current=R;const z=tn.trim().toLowerCase(),ae=z.split(/\s+/).filter(Boolean);if(Mp.has(z)){Lt(Mp.get(z));return}gt(!0);try{const Me=`https://world.openfoodfacts.org/cgi/search.pl?search_terms=${encodeURIComponent(tn.trim())}&search_simple=1&action=process&json=1&page_size=10&lc=en&sort_by=unique_scans_n&fields=product_name,product_name_en,brands,image_small_url,image_url,serving_size,quantity,nutriments`,Le=await fetch(Me,{signal:R.signal});if(!Le.ok)throw new Error(`HTTP ${Le.status}`);const Ft=((await Le.json()).products||[]).map(Ye=>Cr(Ye)).filter(Ye=>Ye.name!=="Unknown Product"&&(Ye.calories>0||Ye.protein>0)).filter(Ye=>{const Kn=(Ye.name+" "+Ye.brand).toLowerCase();return ae.every(os=>Kn.includes(os))}).sort((Ye,Kn)=>qn(Kn.name,Kn.brand,z)-qn(Ye.name,Ye.brand,z)).slice(0,10);Mp.set(z,Ft),Lt(Ft),Ft.length===0&&$e("No results found. Try a different search.","info")}catch(le){if(le.name==="AbortError")return;console.error("Search error:",le),$e("Search failed. Check your connection.","error")}gt(!1)};w.useEffect(()=>{if(bt.current&&clearTimeout(bt.current),!(!tn.trim()||re!=="search"||ue))return bt.current=setTimeout(()=>{Ks()},700),()=>clearTimeout(bt.current)},[tn]);const ws=l,kn={"ring-protein":ws?"#2dd4bf":"#14b8a6","ring-carbs":ws?"#fbbf24":"#f59e0b","ring-fats":ws?"#a78bfa":"#8b5cf6","ring-cals":"var(--color-primary)"},Ln=80,as=2*Math.PI*Ln,zt=(R,z,ae,le,Me)=>{const Le=le>0?Math.min(100,Math.round(ae/le*100)):0,He=as-Le/100*as,Ft=kn[Me]||"#14b8a6";return o.jsxs("div",{className:"nut-ring-wrap",children:[o.jsxs("svg",{className:"nut-ring-svg",viewBox:"0 0 200 200",children:[o.jsx("circle",{className:"nut-arc-track",cx:"100",cy:"100",r:Ln}),o.jsx("circle",{className:"nut-arc-fill",cx:"100",cy:"100",r:Ln,style:{stroke:Ft},strokeDasharray:as,strokeDashoffset:He})]}),o.jsxs("div",{className:"nut-ring-center",children:[o.jsx("span",{className:"nut-ring-value",style:{color:Ft},children:Math.round(ae)}),o.jsxs("span",{className:"nut-ring-target",children:["/ ",le,R==="Calories"?"":"g"]}),o.jsx("span",{className:"nut-ring-label",style:{color:Ft},children:z})]}),o.jsxs("span",{className:"nut-ring-pct",style:{color:Ft},children:[Le,"%"]})]})};if(w.useEffect(()=>{if(!ke)return;const R=setTimeout(()=>{const z=ke;is(),Ee(null),Nr(z)},1500);return()=>clearTimeout(R)},[ke]),w.useEffect(()=>()=>{const R=yn.current;if(Ne.current&&R){try{R.stop(),R.offDetected()}catch{}Ne.current=!1}},[]),i||g==="loading")return o.jsxs("div",{className:"nut-page","data-theme":l?"dark":"light","data-accent":h,children:[o.jsx("header",{className:"client-header",children:o.jsxs("div",{className:"header-content",children:[o.jsx("button",{className:"header-back-btn",onClick:()=>p("/client/core-buddy"),"aria-label":"Go back",children:o.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:o.jsx("path",{d:"M15 18l-6-6 6-6"})})}),o.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})]})}),o.jsx("div",{className:"nut-loading-inline",children:o.jsx("div",{className:"cb-loading-spinner"})})]});if(g==="setup")return o.jsxs("div",{className:"nut-page","data-theme":l?"dark":"light","data-accent":h,children:[o.jsx("header",{className:"client-header",children:o.jsxs("div",{className:"header-content",children:[o.jsx("button",{className:"header-back-btn",onClick:()=>p("/client/core-buddy"),"aria-label":"Go back",children:o.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:o.jsx("path",{d:"M15 18l-6-6 6-6"})})}),o.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),o.jsx("div",{className:"header-actions",children:o.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?o.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("circle",{cx:"12",cy:"12",r:"5"}),o.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):o.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),o.jsxs("main",{className:"nut-main",children:[o.jsxs("div",{className:"nut-setup-intro",children:[o.jsx("h2",{children:"Set Your Daily Targets"}),o.jsx("p",{children:"Calculate your personalised macros based on your body and goals."})]}),o.jsxs("div",{className:"nut-calc-form",children:[o.jsxs("div",{className:"nut-form-group",children:[o.jsx("label",{children:"Gender"}),o.jsxs("div",{className:"nut-toggle-group",children:[o.jsx("button",{className:T.gender==="male"?"active":"",onClick:()=>{O(R=>({...R,gender:"male"})),q(null)},children:"Male"}),o.jsx("button",{className:T.gender==="female"?"active":"",onClick:()=>{O(R=>({...R,gender:"female"})),q(null)},children:"Female"})]})]}),o.jsxs("div",{className:"nut-form-row",children:[o.jsxs("div",{className:"nut-form-group",children:[o.jsx("label",{children:"Age"}),o.jsx("input",{type:"number",value:T.age,onChange:R=>{O(z=>({...z,age:R.target.value})),q(null)},placeholder:"Years",min:"15",max:"100"})]}),o.jsxs("div",{className:"nut-form-group",children:[o.jsx("label",{children:"Weight"}),o.jsxs("div",{className:"nut-input-unit",children:[o.jsx("input",{type:"number",value:T.weight,onChange:R=>{O(z=>({...z,weight:R.target.value})),q(null)},placeholder:T.weightUnit,min:"30",max:"300"}),o.jsxs("div",{className:"nut-unit-toggle",children:[o.jsx("button",{className:T.weightUnit==="kg"?"active":"",onClick:()=>{O(R=>({...R,weightUnit:"kg"})),q(null)},children:"kg"}),o.jsx("button",{className:T.weightUnit==="lbs"?"active":"",onClick:()=>{O(R=>({...R,weightUnit:"lbs"})),q(null)},children:"lbs"})]})]})]})]}),o.jsxs("div",{className:"nut-form-group",children:[o.jsx("label",{children:"Height"}),o.jsxs("div",{className:"nut-input-unit",children:[T.heightUnit==="cm"?o.jsx("input",{type:"number",value:T.height,onChange:R=>{O(z=>({...z,height:R.target.value})),q(null)},placeholder:"cm",min:"100",max:"250"}):o.jsxs("div",{className:"nut-height-imperial",children:[o.jsx("input",{type:"number",value:T.heightFeet,onChange:R=>{O(z=>({...z,heightFeet:R.target.value})),q(null)},placeholder:"ft",min:"4",max:"7"}),o.jsx("input",{type:"number",value:T.heightInches,onChange:R=>{O(z=>({...z,heightInches:R.target.value})),q(null)},placeholder:"in",min:"0",max:"11"})]}),o.jsxs("div",{className:"nut-unit-toggle",children:[o.jsx("button",{className:T.heightUnit==="cm"?"active":"",onClick:()=>{O(R=>({...R,heightUnit:"cm"})),q(null)},children:"cm"}),o.jsx("button",{className:T.heightUnit==="ft"?"active":"",onClick:()=>{O(R=>({...R,heightUnit:"ft"})),q(null)},children:"ft/in"})]})]})]}),o.jsxs("div",{className:"nut-form-group",children:[o.jsx("label",{children:"Daily Activity (outside of training)"}),o.jsxs("select",{value:T.dailyActivity,onChange:R=>{O(z=>({...z,dailyActivity:R.target.value})),q(null)},children:[o.jsx("option",{value:"sedentary",children:"Sedentary  desk job, under 5k steps"}),o.jsx("option",{value:"light",children:"Lightly Active  office + walking, 5-8k steps"}),o.jsx("option",{value:"moderate",children:"Moderately Active  on feet often, 8-12k steps"}),o.jsx("option",{value:"active",children:"Very Active  physical job, 12k+ steps"})]})]}),o.jsxs("div",{className:"nut-form-group",children:[o.jsx("label",{children:"Training Sessions per Week"}),o.jsxs("select",{value:T.trainingFrequency,onChange:R=>{O(z=>({...z,trainingFrequency:R.target.value})),q(null)},children:[o.jsx("option",{value:"low",children:"1-2 sessions"}),o.jsx("option",{value:"moderate",children:"3-4 sessions"}),o.jsx("option",{value:"high",children:"5-6 sessions"}),o.jsx("option",{value:"daily",children:"7+ sessions"})]})]}),o.jsxs("div",{className:"nut-form-group",children:[o.jsx("label",{children:"Fitness Goal"}),o.jsxs("div",{className:"nut-goal-options",children:[o.jsxs("button",{className:T.goal==="lose"?"active":"",onClick:()=>{O(R=>({...R,goal:"lose"})),q(null)},children:[o.jsx("span",{className:"nut-goal-icon",children:"-"}),o.jsx("span",{children:"Lose Weight"})]}),o.jsxs("button",{className:T.goal==="maintain"?"active":"",onClick:()=>{O(R=>({...R,goal:"maintain"})),q(null)},children:[o.jsx("span",{className:"nut-goal-icon",children:"="}),o.jsx("span",{children:"Maintain"})]}),o.jsxs("button",{className:T.goal==="build"?"active":"",onClick:()=>{O(R=>({...R,goal:"build"})),q(null)},children:[o.jsx("span",{className:"nut-goal-icon",children:"+"}),o.jsx("span",{children:"Build Muscle"})]})]})]}),T.goal==="lose"&&o.jsxs("div",{className:"nut-form-group",children:[o.jsx("label",{children:"Deficit Level"}),o.jsxs("div",{className:"nut-deficit-options",children:[o.jsxs("button",{className:T.deficitLevel==="light"?"active":"",onClick:()=>{O(R=>({...R,deficitLevel:"light"})),q(null)},children:[o.jsx("strong",{children:"Mild"}),o.jsx("span",{children:"15% below TDEE"})]}),o.jsxs("button",{className:T.deficitLevel==="moderate"?"active":"",onClick:()=>{O(R=>({...R,deficitLevel:"moderate"})),q(null)},children:[o.jsx("strong",{children:"Moderate"}),o.jsx("span",{children:"20% below TDEE"})]}),o.jsxs("button",{className:T.deficitLevel==="harsh"?"active":"",onClick:()=>{O(R=>({...R,deficitLevel:"harsh"})),q(null)},children:[o.jsx("strong",{children:"Aggressive"}),o.jsx("span",{children:"25% below TDEE"})]})]})]}),o.jsx("button",{className:"nut-calc-btn",onClick:Yt,disabled:!Cn(),children:"Calculate Macros"})]}),H&&o.jsxs("div",{className:"nut-calc-results",children:[o.jsx("h3",{children:"Your Daily Targets"}),o.jsxs("div",{className:"nut-calc-rings",children:[zt("Protein","Protein",H.protein,H.protein,"ring-protein"),zt("Carbs","Carbs",H.carbs,H.carbs,"ring-carbs"),zt("Fats","Fats",H.fats,H.fats,"ring-fats"),zt("Calories","Calories",H.calories,H.calories,"ring-cals")]}),o.jsxs("div",{className:"nut-calc-info",children:[o.jsxs("div",{className:"nut-calc-info-row",children:[o.jsx("span",{children:"BMR (body at rest)"}),o.jsxs("span",{children:[H.bmr," cal"]})]}),o.jsxs("div",{className:"nut-calc-info-row",children:[o.jsx("span",{children:"+ Daily activity (NEAT)"}),o.jsxs("span",{children:[H.neat," cal"]})]}),o.jsxs("div",{className:"nut-calc-info-row",children:[o.jsx("span",{children:"+ Training sessions"}),o.jsxs("span",{children:["+",H.exerciseAdd," cal"]})]}),o.jsxs("div",{className:"nut-calc-info-row",style:{fontWeight:600},children:[o.jsx("span",{children:"TDEE (total burn)"}),o.jsxs("span",{children:[H.tdee," cal"]})]})]}),o.jsx("button",{className:"nut-save-targets-btn",onClick:Fn,children:"Set as My Daily Targets"})]})]}),Xt&&o.jsx("div",{className:`toast-notification ${Xt.type}`,children:Xt.message})]});const Gr=R=>{const z=new Date(R+"T12:00:00"),ae=z.getDay(),le=new Date(z);le.setDate(z.getDate()-(ae+6)%7);const Me=[];for(let Le=0;Le<7;Le++){const He=new Date(le);He.setDate(le.getDate()+Le),Me.push(He.toISOString().split("T")[0])}return Me},Ar=["M","T","W","T","F","S","S"],xs=(R,z="search")=>{we(R),z==="scan"?(L("scan"),Rt(null)):z==="manual"?(L("manual"),Bn({name:"",protein:"",carbs:"",fats:"",calories:"",serving:""})):z==="favourites"?L("favourites"):(L("search"),Lt([]),jn(""))},bn=Gr(B),nr=new Date(B+"T12:00:00"),oi=`${zn[nr.getMonth()]} ${nr.getFullYear()}`;return o.jsx(Fo,{children:o.jsxs("div",{className:"nut-page","data-theme":l?"dark":"light","data-accent":h,children:[o.jsxs("div",{className:"nut-dark-zone",children:[o.jsx("header",{className:"client-header",children:o.jsxs("div",{className:"header-content",children:[o.jsx("button",{className:"header-back-btn",onClick:()=>p("/client/core-buddy"),"aria-label":"Go back",children:o.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:o.jsx("path",{d:"M15 18l-6-6 6-6"})})}),o.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),o.jsxs("div",{className:"header-actions",children:[o.jsx("button",{onClick:()=>{y("setup"),q(null)},"aria-label":"Recalculate macros",children:o.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("circle",{cx:"12",cy:"12",r:"3"}),o.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 1 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 1 1-2.83-2.83l.06-.06A1.65 1.65 0 0 0 4.68 15a1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1 0-4h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 1 1 2.83-2.83l.06.06A1.65 1.65 0 0 0 9 4.68a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 2.83l-.06.06A1.65 1.65 0 0 0 19.4 9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1z"})]})}),o.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?o.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("circle",{cx:"12",cy:"12",r:"5"}),o.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):o.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})]})]})}),o.jsxs("div",{className:"nut-dark-content",children:[o.jsxs("div",{className:"nut-week-strip anim-fade-up",children:[o.jsxs("div",{className:"nut-week-header",children:[o.jsx("button",{className:"nut-week-arrow",onClick:()=>{const R=new Date(B+"T12:00:00");R.setDate(R.getDate()-7);const z=R.toISOString().split("T")[0];te(z)},"aria-label":"Previous week",children:o.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:o.jsx("polyline",{points:"15 18 9 12 15 6"})})}),o.jsx("button",{className:"nut-week-month-label",onClick:()=>{A(!ve),I({year:nr.getFullYear(),month:nr.getMonth()})},children:oi}),o.jsx("button",{className:"nut-week-arrow",onClick:()=>{const R=new Date(B+"T12:00:00");R.setDate(R.getDate()+7);const z=R.toISOString().split("T")[0];z<=Zr()&&te(z)},"aria-label":"Next week",disabled:bn[6]>=Zr(),children:o.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:o.jsx("polyline",{points:"9 18 15 12 9 6"})})})]}),o.jsx("div",{className:"nut-week-days",children:bn.map((R,z)=>{const ae=new Date(R+"T12:00:00").getDate(),le=R===B,Me=R>Zr(),Le=R===Zr();return o.jsxs("button",{className:`nut-week-day${le?" selected":""}${Le?" today":""}${Me?" future":""}`,disabled:Me,onClick:()=>te(R),children:[o.jsx("span",{className:"nut-week-day-letter",children:Ar[z]}),o.jsx("span",{className:"nut-week-day-num",children:ae})]},R)})})]}),ve&&o.jsxs("div",{className:"nut-calendar nut-calendar-dark",children:[o.jsxs("div",{className:"nut-cal-header",children:[o.jsx("button",{onClick:()=>I(R=>{let z=R.month-1,ae=R.year;return z<0&&(z=11,ae--),{year:ae,month:z}}),children:o.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("polyline",{points:"15 18 9 12 15 6"})})}),o.jsxs("span",{children:[zn[S.month]," ",S.year]}),o.jsx("button",{onClick:()=>I(R=>{let z=R.month+1,ae=R.year;return z>11&&(z=0,ae++),{year:ae,month:z}}),disabled:S.year===new Date().getFullYear()&&S.month>=new Date().getMonth(),children:o.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("polyline",{points:"9 18 15 12 9 6"})})})]}),o.jsx("div",{className:"nut-cal-days-header",children:Xn.map(R=>o.jsx("span",{children:R},R))}),o.jsxs("div",{className:"nut-cal-grid",children:[[...Array(on(S.year,S.month))].map((R,z)=>o.jsx("span",{},`e${z}`)),[...Array(sn(S.year,S.month))].map((R,z)=>{const ae=z+1,le=`${S.year}-${String(S.month+1).padStart(2,"0")}-${String(ae).padStart(2,"0")}`,Me=le>Zr(),Le=le===B,He=le===Zr();return o.jsx("button",{className:`nut-cal-day${Le?" selected":""}${He?" today":""}${Me?" future":""}`,disabled:Me,onClick:()=>{te(le),A(!1)},children:ae},ae)})]})]}),o.jsxs("div",{className:"nut-rings-row anim-fade-up-d2",children:[zt("Protein","Protein",pe.protein,b.protein,"ring-protein"),zt("Carbs","Carbs",pe.carbs,b.carbs,"ring-carbs"),zt("Fats","Fats",pe.fats,b.fats,"ring-fats"),zt("Calories","kCal",pe.calories,b.calories,"ring-cals")]})]})]}),o.jsx("div",{className:"nut-light-zone anim-fade-up-d4",children:o.jsxs("div",{className:"nut-light-content",children:[Fe&&o.jsx("div",{className:"nut-quick-row",children:o.jsxs("button",{className:"nut-copy-day-btn",onClick:()=>{D(!0),N({year:new Date().getFullYear(),month:new Date().getMonth()})},children:[o.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",width:"18",height:"18",strokeLinecap:"round",strokeLinejoin:"round",children:[o.jsx("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"}),o.jsx("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"})]}),o.jsx("span",{children:"Copy day"})]})}),o.jsx("div",{className:"nut-log-section",children:o.jsx("div",{className:"nut-meals-list",children:u_.map(R=>{const z=W.entries.filter(le=>(le.meal||"snacks")===R.key),ae=z.reduce((le,Me)=>({protein:le.protein+(Me.protein||0),carbs:le.carbs+(Me.carbs||0),fats:le.fats+(Me.fats||0),calories:le.calories+(Me.calories||0)}),{protein:0,carbs:0,fats:0,calories:0});return o.jsxs("div",{className:"nut-meal-card",children:[o.jsxs("div",{className:"nut-meal-card-header",children:[o.jsx("span",{className:`nut-meal-card-icon nut-meal-icon-${R.key}`,children:WM[R.key]}),o.jsx("span",{className:"nut-meal-card-title",children:R.label}),z.length>0&&o.jsxs("span",{className:"nut-meal-card-cal",children:[ae.calories," cal"]}),Fe&&o.jsx("button",{className:"nut-meal-add-btn",onClick:()=>Be(Ie===R.key?null:R.key),"aria-label":`Add to ${R.label}`,children:o.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:[o.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),o.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})})]}),z.length>0&&o.jsxs("div",{className:"nut-meal-bars",children:[o.jsxs("div",{className:"nut-meal-bar-row",children:[o.jsx("span",{className:"nut-meal-bar-label nut-macro-p",children:"P"}),o.jsx("div",{className:"nut-meal-bar-track",children:o.jsx("div",{className:"nut-meal-bar-fill bar-protein",style:{width:`${Math.min(100,b.protein>0?ae.protein/b.protein*100:0)}%`}})}),o.jsxs("span",{className:"nut-meal-bar-val",children:[ae.protein,"g"]})]}),o.jsxs("div",{className:"nut-meal-bar-row",children:[o.jsx("span",{className:"nut-meal-bar-label nut-macro-c",children:"C"}),o.jsx("div",{className:"nut-meal-bar-track",children:o.jsx("div",{className:"nut-meal-bar-fill bar-carbs",style:{width:`${Math.min(100,b.carbs>0?ae.carbs/b.carbs*100:0)}%`}})}),o.jsxs("span",{className:"nut-meal-bar-val",children:[ae.carbs,"g"]})]}),o.jsxs("div",{className:"nut-meal-bar-row",children:[o.jsx("span",{className:"nut-meal-bar-label nut-macro-f",children:"F"}),o.jsx("div",{className:"nut-meal-bar-track",children:o.jsx("div",{className:"nut-meal-bar-fill bar-fats",style:{width:`${Math.min(100,b.fats>0?ae.fats/b.fats*100:0)}%`}})}),o.jsxs("span",{className:"nut-meal-bar-val",children:[ae.fats,"g"]})]}),o.jsxs("div",{className:"nut-meal-bar-row",children:[o.jsx("span",{className:"nut-meal-bar-label nut-macro-cal",children:"K"}),o.jsx("div",{className:"nut-meal-bar-track",children:o.jsx("div",{className:"nut-meal-bar-fill bar-cals",style:{width:`${Math.min(100,b.calories>0?ae.calories/b.calories*100:0)}%`}})}),o.jsx("span",{className:"nut-meal-bar-val",children:ae.calories})]})]}),z.length>0&&o.jsx("div",{className:"nut-log-list",children:z.map(le=>o.jsxs("div",{className:"nut-log-item",children:[o.jsx("button",{className:`nut-fav-star log${oe(le.name)?" active":""}`,onClick:()=>Ae(le),"aria-label":oe(le.name)?"Remove from favourites":"Add to favourites",children:o.jsx("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:oe(le.name)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),o.jsxs("div",{className:"nut-log-item-info",children:[o.jsx("span",{className:"nut-log-item-name",children:le.name}),le.serving&&o.jsx("span",{className:"nut-log-item-serving",children:le.serving})]}),o.jsxs("div",{className:"nut-log-item-macros",children:[o.jsxs("span",{className:"nut-macro-p",children:[le.protein,"p"]}),o.jsxs("span",{className:"nut-macro-c",children:[le.carbs,"c"]}),o.jsxs("span",{className:"nut-macro-f",children:[le.fats,"f"]}),o.jsx("span",{className:"nut-macro-cal",children:le.calories})]}),Fe&&o.jsx("button",{className:"nut-log-delete",onClick:()=>mt(le.id),"aria-label":"Remove",children:o.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),o.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]},le.id))}),z.length===0&&o.jsx("div",{className:"nut-meal-empty",children:o.jsx("p",{children:Fe?"Tap + to add food":"No entries"})})]},R.key)})})})]})}),Ie&&o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"nut-add-picker-backdrop",onClick:()=>Be(null)}),o.jsxs("div",{className:"nut-add-picker",children:[o.jsx("div",{className:"nut-add-picker-handle"}),o.jsxs("h3",{className:"nut-add-picker-title",children:["Add to ",u_.find(R=>R.key===Ie)?.label]}),o.jsxs("div",{className:"nut-add-picker-options",children:[o.jsxs("button",{onClick:()=>{const R=Ie;Be(null),xs(R,"scan")},children:[o.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("path",{d:"M3 7V5a2 2 0 0 1 2-2h2"}),o.jsx("path",{d:"M17 3h2a2 2 0 0 1 2 2v2"}),o.jsx("path",{d:"M21 17v2a2 2 0 0 1-2 2h-2"}),o.jsx("path",{d:"M7 21H5a2 2 0 0 1-2-2v-2"}),o.jsx("line",{x1:"7",y1:"12",x2:"17",y2:"12"})]}),o.jsx("span",{children:"Scan Barcode"})]}),o.jsxs("button",{onClick:()=>{const R=Ie;Be(null),xs(R,"search")},children:[o.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("circle",{cx:"11",cy:"11",r:"8"}),o.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),o.jsx("span",{children:"Search Food"})]}),o.jsxs("button",{onClick:()=>{const R=Ie;Be(null),xs(R,"manual")},children:[o.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),o.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]}),o.jsx("span",{children:"Manual Entry"})]}),o.jsxs("button",{onClick:()=>{const R=Ie;Be(null),xs(R,"favourites")},children:[o.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),o.jsx("span",{children:"Favourites"})]})]})]})]}),V&&o.jsx("div",{className:"nut-modal-overlay",onClick:()=>D(!1),children:o.jsxs("div",{className:"nut-copy-from-popup",onClick:R=>R.stopPropagation(),children:[o.jsxs("div",{className:"nut-copy-from-header",children:[o.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",width:"20",height:"20",strokeLinecap:"round",strokeLinejoin:"round",children:[o.jsx("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"}),o.jsx("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"})]}),o.jsx("span",{children:"Copy from..."}),o.jsx("button",{className:"nut-modal-close",onClick:()=>D(!1),children:o.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),o.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),o.jsx("p",{className:"nut-copy-from-hint",children:"Pick a day to copy its food log into today"}),o.jsxs("div",{className:"nut-cal-header",children:[o.jsx("button",{onClick:()=>N(R=>{let z=R.month-1,ae=R.year;return z<0&&(z=11,ae--),{year:ae,month:z}}),children:o.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("polyline",{points:"15 18 9 12 15 6"})})}),o.jsxs("span",{children:[zn[M.month]," ",M.year]}),o.jsx("button",{onClick:()=>N(R=>{let z=R.month+1,ae=R.year;return z>11&&(z=0,ae++),{year:ae,month:z}}),disabled:M.year===new Date().getFullYear()&&M.month>=new Date().getMonth(),children:o.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("polyline",{points:"9 18 15 12 9 6"})})})]}),o.jsx("div",{className:"nut-cal-days-header",children:Xn.map(R=>o.jsx("span",{children:R},R))}),o.jsxs("div",{className:"nut-cal-grid",children:[[...Array(on(M.year,M.month))].map((R,z)=>o.jsx("span",{},`e${z}`)),[...Array(sn(M.year,M.month))].map((R,z)=>{const ae=z+1,le=`${M.year}-${String(M.month+1).padStart(2,"0")}-${String(ae).padStart(2,"0")}`,Me=le>Zr(),Le=le===B,He=le===Zr(),Ft=Me||Le;return o.jsx("button",{className:`nut-cal-day${Le?" selected":""}${He?" today":""}${Me?" future":""}`,disabled:Ft,onClick:()=>lt(le),children:ae},ae)})]}),Ue&&o.jsxs("div",{className:"nut-copy-from-loading",children:[o.jsx("div",{className:"wk-loading-spinner"}),o.jsx("span",{children:"Copying..."})]})]})}),re&&o.jsx("div",{className:"nut-modal-overlay",onClick:()=>{is(),Ee(null),L(null),Rt(null)},children:o.jsxs("div",{className:"nut-modal",onClick:R=>R.stopPropagation(),children:[o.jsxs("div",{className:"nut-modal-header",children:[o.jsx("h3",{children:re==="scan"?"Scan Barcode":re==="search"?"Search Food":re==="favourites"?"Favourites":"Manual Entry"}),o.jsx("button",{className:"nut-modal-close",onClick:()=>{is(),Ee(null),L(null),Rt(null)},children:o.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),o.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),re==="scan"&&!ue&&o.jsxs("div",{className:"nut-scan-area",children:[o.jsxs("div",{className:"nut-scanner-wrapper",children:[o.jsx("div",{id:"barcode-reader",className:"nut-scanner-view"}),ie&&!ke&&o.jsx("div",{className:"nut-scan-line"}),ke&&o.jsxs("div",{className:"nut-scan-detected-overlay",children:[o.jsx("svg",{className:"nut-scan-detected-tick",viewBox:"0 0 24 24",fill:"none",stroke:"#4caf50",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:o.jsx("path",{d:"M20 6L9 17l-5-5"})}),o.jsx("p",{className:"nut-scan-detected-label",children:"Barcode found!"}),o.jsx("p",{className:"nut-scan-detected-code",children:ke})]})]}),!ie&&o.jsxs("button",{className:"nut-scan-start-btn",onClick:Cs,children:[o.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("path",{d:"M3 7V5a2 2 0 0 1 2-2h2"}),o.jsx("path",{d:"M17 3h2a2 2 0 0 1 2 2v2"}),o.jsx("path",{d:"M21 17v2a2 2 0 0 1-2 2h-2"}),o.jsx("path",{d:"M7 21H5a2 2 0 0 1-2-2v-2"}),o.jsx("line",{x1:"7",y1:"12",x2:"17",y2:"12"})]}),"Open Camera"]}),ie&&!ke&&o.jsx("p",{className:"nut-scan-hint",children:"Align barcode within the frame"}),o.jsx("div",{className:"nut-barcode-divider",children:o.jsx("span",{children:"or enter barcode manually"})}),o.jsxs("div",{className:"nut-barcode-manual",children:[o.jsx("input",{type:"text",inputMode:"numeric",value:xe,onChange:R=>Ke(R.target.value),onKeyDown:R=>R.key==="Enter"&&xe.trim()&&Nr(xe.trim()),placeholder:"Enter barcode number"}),o.jsx("button",{onClick:()=>xe.trim()&&Nr(xe.trim()),disabled:!xe.trim()||ct,children:ct?"...":"Look Up"})]})]}),re==="scan"&&ue&&(()=>{const R=ue.servingUnit||"g",z=ue.portion,ae=vt==="portion"&&z?Je*z.weight:parseFloat(yt)||0,le=ae/100,Me=R==="ml"?[100,200,250,500]:[50,100,150,200],Le=vt==="portion"&&z?`${Je} ${z.label}${Je!==1?"s":""} (${Math.round(ae)}${R})`:`${Math.round(ae)}${R}`;return o.jsxs("div",{className:"nut-product-result",children:[ue.image&&o.jsx("img",{src:ue.image,alt:ue.name||"Product",className:"nut-product-img",loading:"lazy"}),o.jsxs("div",{className:"nut-product-name-row",children:[o.jsx("h4",{children:ue.name}),o.jsx("button",{className:`nut-fav-star confirm${oe(ue.name)?" active":""}`,onClick:()=>Ae({name:ue.name,protein:ue.protein,carbs:ue.carbs,fats:ue.fats,calories:ue.calories,serving:ue.servingSize,per100g:{protein:ue.protein,carbs:ue.carbs,fats:ue.fats,calories:ue.calories},servingUnit:ue.servingUnit||"g",portion:ue.portion||null}),children:o.jsx("svg",{viewBox:"0 0 24 24",width:"22",height:"22",fill:oe(ue.name)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})})]}),ue.brand&&o.jsx("p",{className:"nut-product-brand",children:ue.brand}),o.jsxs("p",{className:"nut-product-per",children:["Per 100",R,":"]}),o.jsxs("div",{className:"nut-product-macros",children:[o.jsxs("span",{className:"nut-macro-p",children:[ue.protein,"g P"]}),o.jsxs("span",{className:"nut-macro-c",children:[ue.carbs,"g C"]}),o.jsxs("span",{className:"nut-macro-f",children:[ue.fats,"g F"]}),o.jsxs("span",{className:"nut-macro-cal",children:[ue.calories," cal"]})]}),z&&o.jsxs("div",{className:"nut-mode-toggle",children:[o.jsx("button",{className:vt==="portion"?"active":"",onClick:()=>{nn("portion"),Je<1&&At(1)},children:"Portions"}),o.jsxs("button",{className:vt==="weight"?"active":"",onClick:()=>{nn("weight"),Vt(String(Math.round(ae)||100))},children:["Custom (",R,")"]})]}),vt==="portion"&&z?o.jsxs("div",{className:"nut-portion-stepper",children:[o.jsx("button",{className:"nut-stepper-btn",onClick:()=>At(Math.max(1,Je-1)),children:"-"}),o.jsxs("div",{className:"nut-stepper-display",children:[o.jsx("span",{className:"nut-stepper-count",children:Je}),o.jsxs("span",{className:"nut-stepper-label",children:[z.label,Je!==1?"s":""]}),o.jsxs("span",{className:"nut-stepper-weight",children:[Math.round(ae),R]})]}),o.jsx("button",{className:"nut-stepper-btn",onClick:()=>At(Je+1),children:"+"})]}):o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"nut-serving-adjust",children:[o.jsxs("label",{children:["Serving (",R,")"]}),o.jsx("input",{type:"number",inputMode:"numeric",value:yt,onChange:He=>Vt(He.target.value),onFocus:He=>He.target.select(),min:"0"})]}),o.jsx("div",{className:"nut-quick-amounts",children:Me.map(He=>o.jsxs("button",{className:`nut-quick-btn${yt===String(He)?" active":""}`,onClick:()=>Vt(String(He)),children:[He,R]},He))})]}),o.jsx("div",{className:"nut-product-total",children:o.jsxs("span",{children:["Total: ",Math.round(ue.protein*le),"p / ",Math.round(ue.carbs*le),"c / ",Math.round(ue.fats*le),"f / ",Math.round(ue.calories*le)," cal"]})}),o.jsxs("div",{className:"nut-product-actions",children:[o.jsx("button",{className:"nut-btn-secondary",onClick:()=>{Rt(null),L("scan")},children:"Scan Again"}),o.jsx("button",{className:"nut-btn-primary",onClick:()=>Ge({name:ue.name,protein:Math.round(ue.protein*le),carbs:Math.round(ue.carbs*le),fats:Math.round(ue.fats*le),calories:Math.round(ue.calories*le),serving:Le}),children:"Add"})]})]})})(),re==="search"&&!ue&&o.jsxs("div",{className:"nut-search-area",children:[o.jsxs("div",{className:"nut-search-bar",children:[o.jsx("input",{type:"text",ref:it,value:tn,onChange:R=>jn(R.target.value),onKeyDown:R=>{R.key==="Enter"&&(clearTimeout(bt.current),Ks())},onFocus:()=>setTimeout(()=>it.current?.scrollIntoView({behavior:"smooth",block:"center"}),350),placeholder:"Search food or product...",autoFocus:!0}),o.jsx("button",{onClick:Ks,disabled:rt,children:rt?"...":"Search"})]}),o.jsxs("div",{className:"nut-search-results",children:[Un.map((R,z)=>o.jsxs("button",{className:"nut-search-item",onClick:()=>{Rt(R),R.portion?(At(1),Vt(String(R.portion.weight)),nn("portion")):(At(0),Vt(String(R.servingValue||100)),nn("weight"))},children:[R.image&&o.jsx("img",{src:R.image,alt:R.name||"Product",loading:"lazy"}),o.jsxs("div",{className:"nut-search-item-info",children:[o.jsx("span",{className:"nut-search-item-name",children:R.name}),R.brand&&o.jsx("span",{className:"nut-search-item-brand",children:R.brand}),o.jsxs("span",{className:"nut-search-item-macros",children:[R.calories," cal  ",R.protein,"p  ",R.carbs,"c  ",R.fats,"f per 100",R.servingUnit||"g"]})]})]},z)),Un.length===0&&tn&&!rt&&o.jsx("p",{className:"nut-search-empty",children:"No results found. Try a different search or use manual entry."})]})]}),re==="search"&&ue&&(()=>{const R=ue.servingUnit||"g",z=ue.portion,ae=vt==="portion"&&z?Je*z.weight:parseFloat(yt)||0,le=ae/100,Me=R==="ml"?[100,200,250,500]:[50,100,150,200],Le=vt==="portion"&&z?`${Je} ${z.label}${Je!==1?"s":""} (${Math.round(ae)}${R})`:`${Math.round(ae)}${R}`;return o.jsxs("div",{className:"nut-product-result",children:[ue.image&&o.jsx("img",{src:ue.image,alt:ue.name||"Product",className:"nut-product-img",loading:"lazy"}),o.jsxs("div",{className:"nut-product-name-row",children:[o.jsx("h4",{children:ue.name}),o.jsx("button",{className:`nut-fav-star confirm${oe(ue.name)?" active":""}`,onClick:()=>Ae({name:ue.name,protein:ue.protein,carbs:ue.carbs,fats:ue.fats,calories:ue.calories,serving:ue.servingSize,per100g:{protein:ue.protein,carbs:ue.carbs,fats:ue.fats,calories:ue.calories},servingUnit:ue.servingUnit||"g",portion:ue.portion||null}),children:o.jsx("svg",{viewBox:"0 0 24 24",width:"22",height:"22",fill:oe(ue.name)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})})]}),ue.brand&&o.jsx("p",{className:"nut-product-brand",children:ue.brand}),o.jsxs("p",{className:"nut-product-per",children:["Per 100",R,":"]}),o.jsxs("div",{className:"nut-product-macros",children:[o.jsxs("span",{className:"nut-macro-p",children:[ue.protein,"g P"]}),o.jsxs("span",{className:"nut-macro-c",children:[ue.carbs,"g C"]}),o.jsxs("span",{className:"nut-macro-f",children:[ue.fats,"g F"]}),o.jsxs("span",{className:"nut-macro-cal",children:[ue.calories," cal"]})]}),z&&o.jsxs("div",{className:"nut-mode-toggle",children:[o.jsx("button",{className:vt==="portion"?"active":"",onClick:()=>{nn("portion"),Je<1&&At(1)},children:"Portions"}),o.jsxs("button",{className:vt==="weight"?"active":"",onClick:()=>{nn("weight"),Vt(String(Math.round(ae)||100))},children:["Custom (",R,")"]})]}),vt==="portion"&&z?o.jsxs("div",{className:"nut-portion-stepper",children:[o.jsx("button",{className:"nut-stepper-btn",onClick:()=>At(Math.max(1,Je-1)),children:"-"}),o.jsxs("div",{className:"nut-stepper-display",children:[o.jsx("span",{className:"nut-stepper-count",children:Je}),o.jsxs("span",{className:"nut-stepper-label",children:[z.label,Je!==1?"s":""]}),o.jsxs("span",{className:"nut-stepper-weight",children:[Math.round(ae),R]})]}),o.jsx("button",{className:"nut-stepper-btn",onClick:()=>At(Je+1),children:"+"})]}):o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"nut-serving-adjust",children:[o.jsxs("label",{children:["Serving (",R,")"]}),o.jsx("input",{type:"number",inputMode:"numeric",value:yt,onChange:He=>Vt(He.target.value),onFocus:He=>He.target.select(),min:"0"})]}),o.jsx("div",{className:"nut-quick-amounts",children:Me.map(He=>o.jsxs("button",{className:`nut-quick-btn${yt===String(He)?" active":""}`,onClick:()=>Vt(String(He)),children:[He,R]},He))})]}),o.jsx("div",{className:"nut-product-total",children:o.jsxs("span",{children:["Total: ",Math.round(ue.protein*le),"p / ",Math.round(ue.carbs*le),"c / ",Math.round(ue.fats*le),"f / ",Math.round(ue.calories*le)," cal"]})}),o.jsxs("div",{className:"nut-product-actions",children:[o.jsx("button",{className:"nut-btn-secondary",onClick:()=>Rt(null),children:"Back to Search"}),o.jsx("button",{className:"nut-btn-primary",onClick:()=>Ge({name:ue.name,protein:Math.round(ue.protein*le),carbs:Math.round(ue.carbs*le),fats:Math.round(ue.fats*le),calories:Math.round(ue.calories*le),serving:Le}),children:"Add"})]})]})})(),re==="manual"&&o.jsxs("div",{className:"nut-manual-form",children:[o.jsxs("div",{className:"nut-form-group",children:[o.jsx("label",{children:"Food Name"}),o.jsx("input",{type:"text",value:ut.name,onChange:R=>Bn(z=>({...z,name:R.target.value})),placeholder:"e.g. Chicken Breast",autoFocus:!0})]}),o.jsxs("div",{className:"nut-form-group",children:[o.jsx("label",{children:"Serving Size (optional)"}),o.jsx("input",{type:"text",value:ut.serving,onChange:R=>Bn(z=>({...z,serving:R.target.value})),placeholder:"e.g. 150g, 1 cup"})]}),o.jsxs("div",{className:"nut-manual-macros",children:[o.jsxs("div",{className:"nut-form-group",children:[o.jsx("label",{children:"Protein (g)"}),o.jsx("input",{type:"number",value:ut.protein,onChange:R=>Bn(z=>({...z,protein:R.target.value})),min:"0"})]}),o.jsxs("div",{className:"nut-form-group",children:[o.jsx("label",{children:"Carbs (g)"}),o.jsx("input",{type:"number",value:ut.carbs,onChange:R=>Bn(z=>({...z,carbs:R.target.value})),min:"0"})]}),o.jsxs("div",{className:"nut-form-group",children:[o.jsx("label",{children:"Fats (g)"}),o.jsx("input",{type:"number",value:ut.fats,onChange:R=>Bn(z=>({...z,fats:R.target.value})),min:"0"})]}),o.jsxs("div",{className:"nut-form-group",children:[o.jsx("label",{children:"Calories"}),o.jsx("input",{type:"number",value:ut.calories,onChange:R=>Bn(z=>({...z,calories:R.target.value})),min:"0"})]})]}),o.jsx("button",{className:"nut-btn-primary",disabled:!ut.name.trim(),onClick:()=>Ge({name:ut.name,protein:parseFloat(ut.protein)||0,carbs:parseFloat(ut.carbs)||0,fats:parseFloat(ut.fats)||0,calories:parseFloat(ut.calories)||0,serving:ut.serving||""}),children:"Add Food"})]}),re==="favourites"&&!ue&&(()=>{const R=fr(),z=ae=>{if(ae.per100g){const le=ae.per100g;Rt({name:ae.name,brand:"",image:null,servingSize:ae.serving||"100g",servingValue:100,servingUnit:ae.servingUnit||"g",portion:ae.portion||null,protein:le.protein,carbs:le.carbs,fats:le.fats,calories:le.calories,per100g:!0}),ae.portion?(At(1),Vt(String(ae.portion.weight)),nn("portion")):(At(0),Vt("100"),nn("weight"))}else Ge({name:ae.name,protein:ae.protein,carbs:ae.carbs,fats:ae.fats,calories:ae.calories,serving:ae.serving||""})};return o.jsx("div",{className:"nut-recent-area",children:R.length===0?o.jsx("p",{className:"nut-search-empty",children:"No favourites yet. Tap the star on any food to save it here."}):o.jsx("div",{className:"nut-recent-list",children:R.map((ae,le)=>o.jsxs("div",{className:"nut-recent-item-row",children:[o.jsx("button",{className:"nut-fav-star active",onClick:Me=>{Me.stopPropagation(),Ae(ae)},children:o.jsx("svg",{viewBox:"0 0 24 24",width:"18",height:"18",fill:"currentColor",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),o.jsxs("button",{className:"nut-recent-item",onClick:()=>z(ae),children:[o.jsxs("div",{className:"nut-recent-item-info",children:[o.jsx("span",{className:"nut-recent-item-name",children:ae.name}),o.jsx("span",{className:"nut-recent-item-serving",children:ae.serving||""})]}),o.jsxs("span",{className:"nut-recent-item-macros",children:[ae.calories," cal"]})]})]},le))})})})(),re==="favourites"&&ue&&(()=>{const R=ue.servingUnit||"g",z=ue.portion,ae=vt==="portion"&&z?Je*z.weight:parseFloat(yt)||0,le=ae/100,Me=R==="ml"?[100,200,250,500]:[50,100,150,200],Le=vt==="portion"&&z?`${Je} ${z.label}${Je!==1?"s":""} (${Math.round(ae)}${R})`:`${Math.round(ae)}${R}`;return o.jsxs("div",{className:"nut-product-result",children:[o.jsxs("div",{className:"nut-product-name-row",children:[o.jsx("h4",{children:ue.name}),o.jsx("button",{className:`nut-fav-star confirm${oe(ue.name)?" active":""}`,onClick:()=>Ae({name:ue.name,protein:ue.protein,carbs:ue.carbs,fats:ue.fats,calories:ue.calories,serving:ue.servingSize,per100g:{protein:ue.protein,carbs:ue.carbs,fats:ue.fats,calories:ue.calories},servingUnit:ue.servingUnit||"g",portion:ue.portion||null}),children:o.jsx("svg",{viewBox:"0 0 24 24",width:"22",height:"22",fill:oe(ue.name)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})})]}),o.jsxs("p",{className:"nut-product-per",children:["Per 100",R,":"]}),o.jsxs("div",{className:"nut-product-macros",children:[o.jsxs("span",{className:"nut-macro-p",children:[ue.protein,"g P"]}),o.jsxs("span",{className:"nut-macro-c",children:[ue.carbs,"g C"]}),o.jsxs("span",{className:"nut-macro-f",children:[ue.fats,"g F"]}),o.jsxs("span",{className:"nut-macro-cal",children:[ue.calories," cal"]})]}),z&&o.jsxs("div",{className:"nut-mode-toggle",children:[o.jsx("button",{className:vt==="portion"?"active":"",onClick:()=>{nn("portion"),Je<1&&At(1)},children:"Portions"}),o.jsxs("button",{className:vt==="weight"?"active":"",onClick:()=>{nn("weight"),Vt(String(Math.round(ae)||100))},children:["Custom (",R,")"]})]}),vt==="portion"&&z?o.jsxs("div",{className:"nut-portion-stepper",children:[o.jsx("button",{className:"nut-stepper-btn",onClick:()=>At(Math.max(1,Je-1)),children:"-"}),o.jsxs("div",{className:"nut-stepper-display",children:[o.jsx("span",{className:"nut-stepper-count",children:Je}),o.jsxs("span",{className:"nut-stepper-label",children:[z.label,Je!==1?"s":""]}),o.jsxs("span",{className:"nut-stepper-weight",children:[Math.round(ae),R]})]}),o.jsx("button",{className:"nut-stepper-btn",onClick:()=>At(Je+1),children:"+"})]}):o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"nut-serving-adjust",children:[o.jsxs("label",{children:["Serving (",R,")"]}),o.jsx("input",{type:"number",inputMode:"numeric",value:yt,onChange:He=>Vt(He.target.value),onFocus:He=>He.target.select(),min:"0"})]}),o.jsx("div",{className:"nut-quick-amounts",children:Me.map(He=>o.jsxs("button",{className:`nut-quick-btn${yt===String(He)?" active":""}`,onClick:()=>Vt(String(He)),children:[He,R]},He))})]}),o.jsx("div",{className:"nut-product-total",children:o.jsxs("span",{children:["Total: ",Math.round(ue.protein*le),"p / ",Math.round(ue.carbs*le),"c / ",Math.round(ue.fats*le),"f / ",Math.round(ue.calories*le)," cal"]})}),o.jsxs("div",{className:"nut-product-actions",children:[o.jsx("button",{className:"nut-btn-secondary",onClick:()=>Rt(null),children:"Back to Favourites"}),o.jsx("button",{className:"nut-btn-primary",onClick:()=>Ge({name:ue.name,protein:Math.round(ue.protein*le),carbs:Math.round(ue.carbs*le),fats:Math.round(ue.fats*le),calories:Math.round(ue.calories*le),serving:Le}),children:"Add"})]})]})})()]})}),o.jsx(sa,{active:"nutrition"}),Xt&&o.jsx("div",{className:`toast-notification ${Xt.type}`,children:Xt.message})]})})}async function YM(s){const{type:e="workout",title:t="Workout Complete!",stats:i=[],badges:l=[],badgeImage:u,badgeDesc:h}=s,p=1080,g=1920,y=document.createElement("canvas");y.width=p,y.height=g;const b=y.getContext("2d"),E="#2a2a28",T="#ffffff",O="#A12F3A",H="#1a1a1a",q="#555555";b.fillStyle=E,b.fillRect(0,0,p,g);const B=Math.round(p*.82),te=Math.round(g*.75),W=Math.round((p-B)/2),ee=Math.round((g-te)/2),pe=28,Te=5;b.save(),b.shadowColor="rgba(0, 0, 0, 0.45)",b.shadowBlur=40,b.shadowOffsetY=10,h_(b,W,ee,B,te,pe),b.fillStyle=T,b.fill(),b.restore(),b.save(),h_(b,W,ee,B,te,pe),b.strokeStyle=O,b.lineWidth=Te,b.stroke(),b.restore();const ve=220,A=50,S=52,I=68,V=10,D=36,M=48,N=30,Ue=34,Ze=46,Z=30,we=28;b.font=`bold ${S}px 'Orbitron', sans-serif`;const Ie=Pc(b,t.toUpperCase(),B-100);b.font=`500 ${D}px 'Montserrat', sans-serif`;let Be=[];e==="badge"&&h?Be=Pc(b,h,B-120):e==="badge"&&l.length>0?Be=Pc(b,l.join("    "),B-120):i.length>0&&(Be=Pc(b,i.map(gt=>`${gt.value} ${gt.label}`).join("    "),B-120));const re=e==="badge"?"I just earned a badge on Core Buddy ":e==="habits"?"I just completed my daily habits with Core Buddy ":"I just completed a workout using Core Buddy ";b.font=`bold ${Ue}px 'Montserrat', sans-serif`;const L=Pc(b,re,B-80);let ie=Ie.length*I;Be.length>0&&(ie+=V+Be.length*M),ie+=N+L.length*Ze,ie+=Z+we;const ke=ee+te-60-ie,xe=ee+40,Ke=ke-A,ct=p/2,Pe=(xe+Ke)/2,tn=e==="badge"&&u?u:"/Logo.webp";b.save();const jn=e==="badge"?"rgba(255, 193, 7, 0.15)":"rgba(161, 47, 58, 0.12)",Un=b.createRadialGradient(ct,Pe,ve*.6,ct,Pe,ve*1.5);Un.addColorStop(0,jn),Un.addColorStop(1,"rgba(0, 0, 0, 0)"),b.fillStyle=Un,b.fillRect(ct-ve*1.5,Pe-ve*1.5,ve*3,ve*3),b.restore(),b.beginPath(),b.arc(ct,Pe,ve+6,0,Math.PI*2),b.fillStyle=T,b.fill();const Lt=e==="badge"?"#ffc107":O;b.beginPath(),b.arc(ct,Pe,ve,0,Math.PI*2),b.strokeStyle=Lt,b.lineWidth=5,b.stroke();try{const gt=await QM(tn);b.save(),b.beginPath(),b.arc(ct,Pe,ve-6,0,Math.PI*2),b.clip();const ut=(ve-6)*2;b.drawImage(gt,ct-ve+6,Pe-ve+6,ut,ut),b.restore()}catch{b.textAlign="center",b.textBaseline="middle",b.fillStyle=O,b.font="bold 80px 'Orbitron', sans-serif",b.fillText(e==="badge"?"":"MCF",ct,Pe)}let rt=ke;b.textAlign="center",b.textBaseline="alphabetic",b.fillStyle=H,b.font=`bold ${S}px 'Orbitron', sans-serif`;for(const gt of Ie)b.fillText(gt,p/2,rt),rt+=I;if(Be.length>0){rt+=V,b.fillStyle=q,b.font=`500 ${D}px 'Montserrat', sans-serif`;for(const gt of Be)b.fillText(gt,p/2,rt),rt+=M}rt+=N,b.fillStyle=H,b.font=`bold ${Ue}px 'Montserrat', sans-serif`;for(const gt of L)b.fillText(gt,p/2,rt),rt+=Ze;return rt+=Z,b.fillStyle=O,b.font=`600 ${we}px 'Montserrat', sans-serif`,b.fillText("Make It Count with Core Buddy",p/2,rt),new Promise(gt=>{y.toBlob(ut=>gt(ut),"image/png")})}function h_(s,e,t,i,l,u){s.beginPath(),s.moveTo(e+u,t),s.lineTo(e+i-u,t),s.quadraticCurveTo(e+i,t,e+i,t+u),s.lineTo(e+i,t+l-u),s.quadraticCurveTo(e+i,t+l,e+i-u,t+l),s.lineTo(e+u,t+l),s.quadraticCurveTo(e,t+l,e,t+l-u),s.lineTo(e,t+u),s.quadraticCurveTo(e,t,e+u,t),s.closePath()}function QM(s){return new Promise((e,t)=>{const i=new Image;i.crossOrigin="anonymous",i.onload=()=>e(i),i.onerror=t,i.src=s})}function Pc(s,e,t){if(s.measureText(e).width<=t)return[e];const i=e.split(" "),l=[];let u="";for(const h of i){const p=u?`${u} ${h}`:h;s.measureText(p).width>t&&u?(l.push(u),u=h):u=p}return u&&l.push(u),l}function XM(){const s=w.useRef(null),e=w.useCallback(()=>{if(!s.current)try{s.current=new(window.AudioContext||window.webkitAudioContext)}catch{}const u=s.current;return u?.state==="suspended"&&u.resume(),u},[]),t=w.useCallback(()=>{navigator.vibrate&&navigator.vibrate([40,60,30]);const u=e();if(!u)return;const h=u.currentTime,p=u.createBiquadFilter();p.type="lowpass",p.frequency.value=500,p.Q.value=.7,p.connect(u.destination);const g=u.createOscillator(),y=u.createGain();g.type="sine",g.frequency.value=50,y.gain.value=.3,y.gain.setTargetAtTime(0,h+.08,.04),g.connect(y).connect(p),g.start(h),g.stop(h+.2);const b=u.createOscillator(),E=u.createGain();b.type="sine",b.frequency.value=70,E.gain.value=.2,E.gain.setTargetAtTime(0,h+.22,.04),b.connect(E).connect(p),b.start(h+.15),b.stop(h+.35)},[e]),i=w.useCallback(()=>{navigator.vibrate&&navigator.vibrate(30);const u=e();if(!u)return;const h=u.currentTime,p=u.createBiquadFilter();p.type="lowpass",p.frequency.value=500,p.Q.value=.7,p.connect(u.destination);const g=u.createOscillator(),y=u.createGain();g.type="sine",g.frequency.value=55,y.gain.value=.35,y.gain.setTargetAtTime(0,h+.08,.04),g.connect(y).connect(p),g.start(h),g.stop(h+.2)},[e]),l=w.useCallback(()=>{navigator.vibrate&&navigator.vibrate([50,80,100]);const u=e();u&&[0,.12].forEach((h,p)=>{const g=u.createOscillator(),y=u.createGain();g.type="sine",g.frequency.value=p===0?523:784,y.gain.value=.12,y.gain.setTargetAtTime(0,u.currentTime+h+.15,.02),g.connect(y).connect(u.destination),g.start(u.currentTime+h),g.stop(u.currentTime+h+.2)})},[e]);return w.useEffect(()=>()=>{s.current?.close()},[]),{tap:i,tick:t,complete:l}}const JM=2e3,bg=42,_l=2*Math.PI*bg,ZM=1200,d_=["Another one in the bank!","Consistency beats everything.","You showed up  that's what counts.","Stronger every session."];function _g({title:s,subtitle:e,stats:t,onDone:i,onDismissStart:l,onShareJourney:u,userName:h,buttonLabel:p="Done",holdLabel:g="Hold To Complete Session",shareType:y="workout",hideShare:b=!1}){const[E,T]=w.useState("hold"),[O,H]=w.useState(!1),[q,B]=w.useState(0),[te,W]=w.useState(!1),[ee,pe]=w.useState(!1),[Te,ve]=w.useState(null),A=XM(),S=w.useRef(null),I=w.useRef(null),V=w.useRef(null),D=w.useRef(null),M=w.useRef(!1),N=w.useRef(!1),Ue=w.useRef(0),Ze=w.useRef(d_[Math.floor(Math.random()*d_.length)]),Z=w.useRef([...Array(80)].map((Ee,xe)=>({x:5+Math.random()*90,delay:Math.random()*3.5,color:["#A12F3A","#ffffff","#000000"][xe%3],drift:(Math.random()-.5)*120,spin:Math.random()*720-360,duration:1.8+Math.random()*2,width:4+Math.random()*6,height:4+Math.random()*8,shape:xe%3}))),we=w.useCallback(()=>{if(M.current)return;M.current=!0,N.current=!1,Ue.current=0,H(!0),B(0),D.current=performance.now(),A.tap(),S.current&&(S.current.style.strokeDashoffset=_l);const Ee=xe=>{const Ke=xe-D.current,ct=Math.min(Ke/JM,1);if(S.current&&(S.current.style.strokeDashoffset=_l-ct*_l),I.current){const Pe=8*(1-ct),tn=1-ct,jn=1+ct*.15;I.current.style.filter=`blur(${Pe}px) grayscale(${tn})`,I.current.style.transform=`scale(${jn})`}B(ct),Ke-Ue.current>=ZM&&(Ue.current=Ke,A.tick()),ct<1?V.current=requestAnimationFrame(Ee):(M.current=!1,N.current=!0,V.current=null,H(!1),B(1),A.complete(),T("celebrate"))};V.current=requestAnimationFrame(Ee)},[A]),Ie=w.useCallback(()=>{M.current&&(M.current=!1,V.current&&(cancelAnimationFrame(V.current),V.current=null),S.current&&(S.current.style.strokeDashoffset=_l),I.current&&(I.current.style.filter="",I.current.style.transform=""),H(!1),B(0))},[]),Be=w.useCallback(()=>{W(!0),l?.(),setTimeout(()=>{i?.()},300)},[i,l]),re=w.useCallback(()=>{const Ee=[s||"Workout Complete!"];return e&&Ee.push(e),t?.length&&Ee.push(t.map(xe=>`${xe.value} ${xe.label}`).join(" | ")),Ee.push("#MindCoreFitness"),Ee.join(`
`)},[s,e,t]),L=w.useCallback(async()=>{if(!(ee||!u))try{await u({type:y==="habits"?"habits_summary":"workout_summary",title:s||"Workout Complete!",subtitle:e,stats:t||[],quote:Ze.current}),pe(!0),ve("Posted to Journey!"),setTimeout(()=>ve(null),2500)}catch(Ee){console.error("Journey post failed:",Ee),ve(Ee?.message||"Failed to post"),setTimeout(()=>ve(null),3500)}},[ee,u,s,e,t]),[ie,_e]=w.useState(!1),ke=w.useCallback(async()=>{_e(!0);try{const Ee=await YM({type:y||"workout",title:s||"Workout Complete!",subtitle:e,stats:t||[],quote:Ze.current,userName:h}),xe=re();if(navigator.share&&navigator.canShare?.({files:[new File([Ee],"workout.png",{type:"image/png"})]})){const Ke=new File([Ee],"workout.png",{type:"image/png"});await navigator.share({title:"Mind Core Fitness",text:xe,files:[Ke]})}else navigator.share?await navigator.share({title:"Mind Core Fitness",text:xe}):(await navigator.clipboard.writeText(xe),ve("Copied to clipboard!"),setTimeout(()=>ve(null),2500))}catch{try{await navigator.clipboard.writeText(re()),ve("Copied to clipboard!"),setTimeout(()=>ve(null),2500)}catch{}}finally{_e(!1)}},[s,e,t,h,re]);return E==="hold"?o.jsxs("div",{className:"wc-hold-page",children:[o.jsx("div",{className:"wc-hold-glow","aria-hidden":"true"}),o.jsx("p",{className:"wc-hold-label",children:g}),o.jsxs("div",{className:`wc-hold-ring-touch ${O?"wc-holding":""}`,onPointerDown:Ee=>{Ee.preventDefault(),we()},onPointerUp:Ie,onPointerLeave:Ie,onPointerCancel:Ie,onClick:Ee=>{Ee.stopPropagation(),N.current&&(N.current=!1)},role:"button",tabIndex:0,"aria-label":"Press and hold to finish workout",onKeyDown:Ee=>{(Ee.key==="Enter"||Ee.key===" ")&&(Ee.preventDefault(),A.complete(),T("celebrate"))},children:[o.jsx("div",{className:"wc-hold-ring-glow","aria-hidden":"true"}),o.jsxs("svg",{className:"wc-hold-ring-svg",viewBox:"0 0 100 100",children:[o.jsx("circle",{className:"wc-hold-ring-track",cx:"50",cy:"50",r:bg}),o.jsx("circle",{className:"wc-hold-ring-fill",ref:S,cx:"50",cy:"50",r:bg,style:{strokeDasharray:_l,strokeDashoffset:_l}})]}),o.jsx("img",{ref:I,src:"/Logo.webp",alt:"Mind Core Fitness",className:"wc-hold-logo",draggable:!1})]})]}):o.jsxs("div",{className:`wc-celeb-overlay ${te?"wc-celeb-dismissing":""}`,children:[o.jsx("div",{className:"wc-celeb-confetti","aria-hidden":"true",children:Z.current.map((Ee,xe)=>o.jsx("span",{className:`wc-celeb-confetti-piece wc-confetti-shape-${Ee.shape}`,style:{"--x":`${Ee.x}%`,"--delay":`${Ee.delay}s`,"--color":Ee.color,"--drift":`${Ee.drift}px`,"--spin":`${Ee.spin}deg`,"--duration":`${Ee.duration}s`,width:`${Ee.width}px`,height:`${Ee.height}px`}},xe))}),o.jsxs("div",{className:"wc-celeb-content",children:[o.jsx("div",{className:"wc-celeb-logo-frame",children:o.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"wc-celeb-logo-img"})}),o.jsx("h2",{className:"wc-celeb-heading",children:s||"Congratulations!"}),e&&o.jsx("p",{className:"wc-celeb-subtext",children:e}),o.jsx("p",{className:"wc-celeb-quote",children:Ze.current}),t&&t.length>0&&o.jsx("div",{className:"wc-celeb-stats-row",children:t.map((Ee,xe)=>o.jsxs("div",{className:"wc-celeb-stat",children:[o.jsx("span",{className:"wc-celeb-stat-val",children:Ee.value}),o.jsx("span",{className:"wc-celeb-stat-label",children:Ee.label})]},xe))}),!b&&o.jsxs("div",{className:"wc-share-row",children:[u&&o.jsxs("button",{className:`wc-share-btn wc-share-journey ${ee?"wc-share-done":""}`,onClick:L,disabled:ee,children:[o.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[o.jsx("path",{d:"M12 20h9"}),o.jsx("path",{d:"M16.5 3.5a2.121 2.121 0 1 1 3 3L7 19l-4 1 1-4Z"})]}),ee?"Posted!":"Post to Journey"]}),o.jsxs("button",{className:"wc-share-btn wc-share-external",onClick:ke,disabled:ie,children:[o.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[o.jsx("circle",{cx:"18",cy:"5",r:"3"}),o.jsx("circle",{cx:"6",cy:"12",r:"3"}),o.jsx("circle",{cx:"18",cy:"19",r:"3"}),o.jsx("line",{x1:"8.59",y1:"13.51",x2:"15.42",y2:"17.49"}),o.jsx("line",{x1:"15.41",y1:"6.51",x2:"8.59",y2:"10.49"})]}),ie?"Generating...":"Share"]})]}),o.jsx("button",{className:"wc-celeb-btn",onClick:Be,children:p}),Te&&o.jsx("div",{className:"wc-share-toast",children:Te})]})]})}const f_="/login/assets/randomiser-glq9YJkL.jpg",m_="/login/assets/programme-card-workout-CnNzTYkz.webp",e6="/login/assets/prog-fullbody-4wk-r6m9HJys.jpg",t6="/login/assets/muscle-group-arms-C9AdZL4-.png",n6="/login/assets/arms-bicep-BUrmT1o-.png",s6="/login/assets/arms-tricep-D9tAnFnS.png",r6="/login/assets/arms-full-arms-BY3TvpJm.png",i6="/login/assets/muscle-group-chest-Cxfuc7XI.png",a6="/login/assets/chest-strength-BR4BAFTH.png",o6="/login/assets/chest-hypertrophy-B8yNrvjB.png",l6="/login/assets/chest-endurance-e-OSWtWO.png",c6="/login/assets/muscle-group-shoulders-DibNtCLF.png",u6="/login/assets/shoulders-strength-CKlZBF5A.png",h6="/login/assets/shoulders-hypertrophy-BUd76jiS.png",d6="/login/assets/shoulders-endurance-HuqNG5rD.png",f6="/login/assets/muscle-group-core-CPR-bdRg.png",m6="/login/assets/core-lower-abs-TVcqGMFJ.png",p6="/login/assets/core-obliques-rotation-Djb7Qlbk.png",g6="/login/assets/core-weighted-core-4Kwh9mTv.png",y6="/login/assets/muscle-group-back-8JPV-YUo.png",v6="/login/assets/back-strength-BmSRxnwo.png",b6="/login/assets/back-hypertrophy-CXHmsnCz.png",_6="/login/assets/back-endurance-C8qJ8l5I.png",w6="/login/assets/muscle-group-legs-B8jcbdov.png",x6="/login/assets/legs-quads-DbnfsebI.png",E6="/login/assets/legs-hamstrings-glutes-BrfsvvzX.png",T6="/login/assets/legs-power-plyo-D2qBXeUR.png",k6=60,Lp=5,S6={fullbody_4wk:{duration:4,daysPerWeek:3},fullbody_8wk:{duration:8,daysPerWeek:3},fullbody_12wk:{duration:12,daysPerWeek:3},core_4wk:{duration:4,daysPerWeek:3},core_8wk:{duration:8,daysPerWeek:3},core_12wk:{duration:12,daysPerWeek:3},upper_4wk:{duration:4,daysPerWeek:3},lower_4wk:{duration:4,daysPerWeek:3}},j6={fullbody:"linear-gradient(160deg, rgba(153,49,60,0.15) 0%, rgba(153,49,60,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)",core:"linear-gradient(160deg, rgba(30,80,120,0.2) 0%, rgba(30,80,120,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)",upper:"linear-gradient(160deg, rgba(100,60,140,0.2) 0%, rgba(100,60,140,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)",lower:"linear-gradient(160deg, rgba(40,120,80,0.2) 0%, rgba(40,120,80,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)"},Op={arms:"linear-gradient(160deg, rgba(180,60,60,0.2) 0%, rgba(180,60,60,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",chest:"linear-gradient(160deg, rgba(50,100,160,0.2) 0%, rgba(50,100,160,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",back:"linear-gradient(160deg, rgba(80,130,60,0.2) 0%, rgba(80,130,60,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",shoulders:"linear-gradient(160deg, rgba(160,100,40,0.2) 0%, rgba(160,100,40,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",legs:"linear-gradient(160deg, rgba(100,50,140,0.2) 0%, rgba(100,50,140,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",core:"linear-gradient(160deg, rgba(30,80,120,0.2) 0%, rgba(30,80,120,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)"},Pp=[{id:"fullbody_4wk",name:"4-Week Full Body",focus:"fullbody",duration:4,level:"All Levels",daysPerWeek:3,image:e6},{id:"fullbody_8wk",name:"8-Week Full Body",focus:"fullbody",duration:8,level:"Intermediate",daysPerWeek:3},{id:"fullbody_12wk",name:"12-Week Full Body",focus:"fullbody",duration:12,level:"Advanced",daysPerWeek:3},{id:"core_4wk",name:"4-Week Core",focus:"core",duration:4,level:"Beginner",daysPerWeek:3},{id:"core_8wk",name:"8-Week Core",focus:"core",duration:8,level:"Intermediate",daysPerWeek:3},{id:"core_12wk",name:"12-Week Core",focus:"core",duration:12,level:"Advanced",daysPerWeek:3},{id:"upper_4wk",name:"4-Week Upper Body",focus:"upper",duration:4,level:"Intermediate",daysPerWeek:3},{id:"lower_4wk",name:"4-Week Lower Body",focus:"lower",duration:4,level:"Intermediate",daysPerWeek:3}],Vc=[{key:"arms",label:"Arms",icon:"M7 5h2v14H7V5zm8 0h2v14h-2V5zm-5 4h4v6h-4V9z",image:t6},{key:"chest",label:"Chest",icon:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 15H9v-2h2v2zm4 0h-2v-2h2v2zm3-6c0 1.1-.36 2.12-.97 2.95l-.87-.87C16.7 12.53 17 11.8 17 11c0-2.76-2.24-5-5-5S7 8.24 7 11c0 .8.3 1.53.84 2.08l-.87.87A4.977 4.977 0 0 1 6 11c0-3.31 2.69-6 6-6s6 2.69 6 6z",image:i6},{key:"back",label:"Back",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm4 18H8v-6l-4-4 1.41-1.41L8 11.17V8h8v3.17l2.59-2.58L20 10l-4 4v6z",image:y6},{key:"shoulders",label:"Shoulders",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm8 10l-3-1.5c-.5-.25-1-.5-1.5-.5h-7c-.5 0-1 .25-1.5.5L4 12l-2 6h4l1.5 4h9L18 18h4l-2-6z",image:c6},{key:"legs",label:"Legs",icon:"M16.5 3A2.5 2.5 0 0 0 14 5.5 2.5 2.5 0 0 0 16.5 8 2.5 2.5 0 0 0 19 5.5 2.5 2.5 0 0 0 16.5 3zM14 9l-3 7h2l1 6h2l1-6h2l-3-7h-2z",image:w6},{key:"core",label:"Core",icon:"M12 2a4 4 0 0 1 4 4v1h-2V6a2 2 0 1 0-4 0v1H8V6a4 4 0 0 1 4-4zM8 9h8v2H8V9zm-1 4h10l-1 9H8l-1-9z",image:f6}],p_={chest:[{id:"chest_strength",name:"Chest Strength",desc:"Heavy pressing for max strength",image:a6,level:"Intermediate",overview:"A heavy pressing session designed to build raw chest strength. Focus on controlled negatives and powerful pressing movements.",tips:["Go heavy  pick a weight where the last 2 reps are a real challenge","Control the negative (lowering phase) for 2-3 seconds","Keep your shoulder blades squeezed together throughout all pressing movements","Rest 90-120 seconds between sets to allow full recovery"],exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:4,reps:8,storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Dumbbell Squeeze Press",type:"weighted",sets:3,reps:10,storagePath:null},{name:"Incline Dumbbell Press",type:"weighted",sets:3,reps:10,storagePath:null},{name:"Dumbbell Pullover",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Dumbbell Fly",type:"weighted",sets:3,reps:12,storagePath:null}]},{id:"chest_hypertrophy",name:"Chest Hypertrophy",desc:"Volume training for muscle growth",image:o6,level:"Intermediate",overview:"A high-volume chest session focused on time under tension and muscle growth. Lighter weights, more reps, and slow controlled movements.",tips:["Use moderate weight  you should feel the burn by rep 10","Squeeze your chest at the top of every rep for 1 second","Keep rest periods short at 60-90 seconds to keep the pump going","On press ups, go to failure on the final set"],exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Wide Press Up",type:"reps",sets:3,reps:15,storagePath:null},{name:"Dumbbell Fly",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Incline Dumbbell Press",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Press Up",type:"reps",sets:3,reps:20,storagePath:"exercises/bodyweight/upper/press up.mp4"}]},{id:"chest_endurance",name:"Chest Endurance",desc:"Bodyweight pushing to failure",image:l6,level:"All Levels",overview:"No weights needed. This bodyweight-only session builds chest endurance and muscular stamina through high-rep push up variations.",tips:["Focus on full range of motion  chest to floor on every rep","Keep your core tight and body in a straight line throughout","Scale down to knee press ups if you can't maintain form","Push through the burn  the last 5 reps are where the growth happens"],exercises:[{name:"Press Up",type:"reps",sets:4,reps:20,storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Wide Press Up",type:"reps",sets:3,reps:15,storagePath:null},{name:"Diamond Press Up",type:"reps",sets:3,reps:12,storagePath:null},{name:"Decline Press Up",type:"reps",sets:3,reps:15,storagePath:null},{name:"Press Up Hold",type:"timed",sets:3,time:30,storagePath:null}]}],back:[{id:"back_strength",name:"Back Strength",desc:"Heavy rows for a thick back",image:v6,level:"Intermediate",overview:"Build a thick, powerful back with heavy rowing movements. This session targets your lats, rhomboids, and traps for overall back development.",tips:["Go heavy on rows  use a weight that challenges you by rep 6-8","Drive your elbows back and squeeze your shoulder blades together at the top","Keep a slight bend in your knees and hinge at the hips for bent over movements","Rest 90-120 seconds between sets for full recovery"],exercises:[{name:"Dumbbell Bent Over Row",type:"weighted",sets:4,reps:8,storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Single Arm Bent Over Row",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Dumbbell Pullover",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Dumbbell Shrug",type:"weighted",sets:3,reps:15,storagePath:null}]},{id:"back_hypertrophy",name:"Back Hypertrophy",desc:"Width and thickness volume work",image:b6,level:"Intermediate",overview:"A volume-focused back session combining rows and isolation moves to build width and thickness. Focus on the mind-muscle connection.",tips:["Use moderate weight  feel the stretch and squeeze on every rep","On renegade rows, keep your hips square to the floor and avoid rotating","For reverse flys, use lighter weight and focus on squeezing your rear delts","Keep rest to 60-90 seconds to maintain intensity"],exercises:[{name:"Renegade Row",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/upper/renegade row.mp4"},{name:"Wide Dumbbell Bent Over Row",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Single Arm Bent Over Row",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Reverse Fly",type:"weighted",sets:3,reps:15,storagePath:null},{name:"Prone Y-T-W Raises",type:"reps",sets:3,reps:10,storagePath:null}]},{id:"back_endurance",name:"Back Endurance",desc:"Bodyweight back conditioning",image:_6,level:"All Levels",overview:"A bodyweight session to strengthen your posterior chain and improve posture. Great for back health, mobility, and muscular endurance.",tips:["On superman holds, lift your arms and legs simultaneously and hold tight","Focus on slow, controlled movements  quality over speed","Breathe steadily throughout timed holds  don't hold your breath","Engage your glutes and lower back together on every movement"],exercises:[{name:"Superman Hold",type:"timed",sets:4,time:30,storagePath:"exercises/bodyweight/upper/Superman Hold.mp4"},{name:"Prone Y-T-W Raises",type:"reps",sets:3,reps:12,storagePath:null},{name:"Reverse Snow Angel",type:"reps",sets:3,reps:12,storagePath:null},{name:"Bird Dog",type:"reps",sets:3,reps:12,storagePath:"exercises/bodyweight/core/Bird Dog.mp4"},{name:"Back Extension Hold",type:"timed",sets:3,time:30,storagePath:null}]}],shoulders:[{id:"shoulders_strength",name:"Shoulder Strength",desc:"Heavy pressing for boulder shoulders",image:u6,level:"Intermediate",overview:"A heavy overhead pressing session to build strong, powerful shoulders. Compound movements first, followed by isolation work for all three delt heads.",tips:["Go heavy on presses  pick a weight where you struggle on the last 2 reps","Brace your core and avoid arching your back during overhead movements","Press straight up and control the weight down slowly","Rest 90-120 seconds between pressing sets, 60 seconds for isolation moves"],exercises:[{name:"Seated Dumbbell Shoulder Press",type:"weighted",sets:4,reps:8,storagePath:"exercises/dumbbells/upper/seated dumbbell shoulder press.mp4"},{name:"Seated Dumbbell Arnold Press",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/upper/seated dumbbell arnold press.mp4"},{name:"Dumbbell Front Raise",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell front raise.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Dumbbell Shrug",type:"weighted",sets:3,reps:15,storagePath:null}]},{id:"shoulders_hypertrophy",name:"Shoulder Hypertrophy",desc:"Volume and isolation for 3D delts",image:h6,level:"Intermediate",overview:"A high-volume session targeting all three heads of the deltoid for that 3D capped shoulder look. Moderate weight, high reps, constant tension.",tips:["Use lighter weight than you think  shoulders respond best to high reps","On lateral raises, lead with your elbows and don't swing the weight","Pause at the top of each raise for a 1-second squeeze","Keep rest periods at 60 seconds to maximise the pump"],exercises:[{name:"Seated Dumbbell Arnold Press",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/seated dumbbell arnold press.mp4"},{name:"Dumbbell Lateral Raise",type:"weighted",sets:4,reps:15,storagePath:"exercises/dumbbells/upper/dumbbell lateral raise.mp4"},{name:"Dumbbell Front Raise",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell front raise.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,reps:15,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Dumbbell Y-Raise",type:"weighted",sets:3,reps:12,storagePath:null}]},{id:"shoulders_endurance",name:"Shoulder Endurance",desc:"Bodyweight and high-rep work",image:d6,level:"All Levels",overview:"A shoulder endurance session combining bodyweight movements with high-rep dumbbell work. Builds stamina, stability, and shoulder resilience.",tips:["On pike push ups, walk your feet close to your hands to increase the angle","For high-rep lateral raises, use a very light weight and focus on form","Wall walks are advanced  scale to pike push ups if needed","Keep your core braced throughout to protect your lower back"],exercises:[{name:"Pike Push Ups",type:"reps",sets:4,reps:12,storagePath:"exercises/bodyweight/upper/pike push ups.mp4"},{name:"Dumbbell Lateral Raise",type:"weighted",sets:3,reps:20,storagePath:"exercises/dumbbells/upper/dumbbell lateral raise.mp4"},{name:"Wall Walks",type:"reps",sets:3,reps:6,storagePath:null},{name:"Prone Y-T-W Raises",type:"reps",sets:3,reps:10,storagePath:null},{name:"Shoulder Tap Hold",type:"timed",sets:3,time:30,storagePath:null}]}],arms:[{id:"arms_bicep",name:"Bicep Focus",desc:"Curl variations for peak biceps",image:n6,level:"All Levels",overview:"An arm session dedicated entirely to biceps. Multiple curl variations target different parts of the bicep for maximum peak and thickness.",tips:["Keep your elbows pinned to your sides  no swinging","Control the negative (lowering) for 2-3 seconds on every rep","Start with your heaviest weight and decrease as you fatigue","Squeeze hard at the top of each curl for a full contraction"],exercises:[{name:"Bicep Curl",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Hammer Curl",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/hammer curl.mp4"},{name:"Concentration Curl",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Wide Grip Bicep Curl",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Isometric Bicep Hold",type:"timed",sets:3,time:20,storagePath:null}]},{id:"arms_tricep",name:"Tricep Focus",desc:"Extensions and dips for horseshoe triceps",image:s6,level:"All Levels",overview:"All-out tricep training with extensions, dips, and pressing movements. The triceps make up two-thirds of your arm  this session builds serious size.",tips:["On overhead extensions, keep your elbows close to your head","For skullcrushers, lower the weight slowly to just above your forehead","On dips, lean slightly forward to reduce shoulder strain","Full lockout at the top of every extension for maximum tricep contraction"],exercises:[{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Skullcrushers",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/skullcrushers.mp4"},{name:"Tricep Dips",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/upper/tricep dips.mp4"},{name:"Tricep Kickback",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Diamond Press Up",type:"reps",sets:3,reps:12,storagePath:null}]},{id:"arms_full",name:"Full Arms",desc:"Superset biceps and triceps",image:r6,level:"All Levels",overview:"A balanced arm session alternating between biceps and triceps. Superset style keeps the intensity high and maximises the pump.",tips:["Superset each pair  do biceps then immediately hit triceps","Use moderate weight that lets you maintain strict form for all reps","Rest 60 seconds after each superset pair","Focus on the squeeze at the peak contraction of every rep"],exercises:[{name:"Bicep Curl",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Tricep Kickback",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Hammer Curl",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/hammer curl.mp4"},{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Wrist Curl",type:"weighted",sets:3,reps:15,storagePath:null}]}],legs:[{id:"legs_quad",name:"Quad Dominant",desc:"Squats and lunges for quad power",image:x6,level:"All Levels",overview:"A quad-focused leg session built around squats and lunges. Heavy compound movements to build strong, powerful quads and overall leg strength.",tips:["On goblet squats, hold the dumbbell close to your chest and sit deep","Keep your knees tracking over your toes  don't let them cave inward","Drive through your heels on all squatting movements","Rest 90-120 seconds between heavy sets, 60 seconds on bodyweight moves"],exercises:[{name:"Dumbbell Goblet Squats",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Forward Dumbbell Lunges",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.mp4"},{name:"Dumbbell Squat Pulses",type:"weighted",sets:3,reps:15,storagePath:"exercises/dumbbells/lower/dumbbell squat pulses.mp4"},{name:"Bulgarian Split Squats",type:"reps",sets:3,reps:12,storagePath:"exercises/bodyweight/lower/bulgarian split squats.mp4"},{name:"Squat And Hold",type:"timed",sets:3,time:30,storagePath:"exercises/bodyweight/lower/squat and hold.mp4"}]},{id:"legs_ham_glute",name:"Hamstring & Glute",desc:"Posterior chain focus",image:E6,level:"Intermediate",overview:"Target the back of your legs with deadlift and hip hinge variations. This session builds a strong posterior chain  hamstrings, glutes, and lower back.",tips:["On RDLs, push your hips back and feel the stretch in your hamstrings","Keep a slight bend in your knees throughout hip hinge movements","Squeeze your glutes hard at the top of every rep","For single leg work, start with your weaker side first"],exercises:[{name:"Romanian Deadlifts",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/lower/romanian deadlifts.mp4"},{name:"1 Legged RDL",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/lower/1 legged rdl.mp4"},{name:"Hip Thrusts",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/lower/hip thrusts.mp4"},{name:"Dumbbell Sumo Squats",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/dumbbell sumo squats.mp4"},{name:"Donkey Kicks",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/lower/donkey kicks.mp4"}]},{id:"legs_power",name:"Power & Plyo",desc:"Explosive leg training",image:T6,level:"Intermediate",overview:"An explosive leg session combining plyometrics with weighted movements. Build power, speed, and athletic performance.",tips:["On jump squats, land softly with bent knees to absorb the impact","Explode up on every rep  power comes from speed, not just weight","Keep rest periods at 60-90 seconds to maintain intensity","Focus on landing mechanics  knees out, chest up, soft landing"],exercises:[{name:"Jump Squats",type:"reps",sets:4,reps:12,storagePath:"exercises/bodyweight/lower/jump squats.mp4"},{name:"Dumbbell Box Step Ups",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/dumbbell box step ups.mp4"},{name:"Skater Jumps",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/lower/skater jumps.mp4"},{name:"Dumbbell Reverse Lunges",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/dumbbell reverse lunges.mp4"},{name:"Weighted Calf Raises",type:"weighted",sets:4,reps:15,storagePath:"exercises/dumbbells/lower/weighted calf raises.mp4"}]}],core:[{id:"core_lower_abs",name:"Lower Abs Blast",desc:"40s work / 20s rest  3 rounds",image:m6,level:"Intermediate",overview:"An interval-based core burner targeting the lower abdominals. 40 seconds of work followed by 20 seconds of rest  keep the intensity high and your lower back pressed into the floor throughout.",tips:["Press your lower back firmly into the floor on every rep","Exhale hard as you contract your abs  don't hold your breath","If your lower back lifts off the ground, reduce the range of motion","Focus on slow, controlled movements rather than speed"],interval:!0,rounds:3,work:40,rest:20,exercises:[{name:"Leg Raises",storagePath:"exercises/bodyweight/core/Leg Raises.mp4"},{name:"Reverse Crunch To Leg Raise",storagePath:"exercises/bodyweight/core/Reverse Crunch To Leg Raise.mp4"},{name:"Flutter Kicks",storagePath:"exercises/bodyweight/core/Flutter Kicks.mp4"},{name:"Dead Bug Single Leg Drop",storagePath:"exercises/bodyweight/core/Dead Bug Single Leg Drop.mp4"},{name:"Hollow Body Hold",storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"},{name:"Hollow Hold Flutter Kicks",storagePath:"exercises/bodyweight/core/Hollow Hold Flutter Kicks.mp4"}]},{id:"core_obliques",name:"Obliques & Rotation",desc:"35s work / 25s rest  3 rounds",image:p6,level:"Intermediate",overview:"Target the obliques and rotational core muscles with this interval session. 35 seconds of work with 25 seconds rest  every exercise involves twisting, rotating, or side-bracing movements.",tips:["Rotate from your ribcage, not just your arms","Keep your hips as still as possible during twisting exercises","Brace your core before each movement  think about squeezing a belt","On side planks, stack your hips and push the floor away"],interval:!0,rounds:3,work:35,rest:25,exercises:[{name:"Russian Twist",storagePath:"exercises/bodyweight/core/Russian Twist.mp4"},{name:"Side Plank Rotation",storagePath:"exercises/bodyweight/core/Side Plank Rotation.mp4"},{name:"Cross Body Mountain Climbers",storagePath:"exercises/bodyweight/core/Cross Body Mountain Climbers.mp4"},{name:"Hip Dips Plank",storagePath:"exercises/bodyweight/core/Hip Dips Plank.mp4"},{name:"Bicycle Crunch",storagePath:"exercises/bodyweight/core/Bicycle Crunch.mp4"},{name:"Side Plank",storagePath:"exercises/bodyweight/core/Side Plank.mp4"}]},{id:"core_weighted",name:"Weighted Core",desc:"40s work / 20s rest  3 rounds",image:g6,level:"Advanced",overview:"Add resistance to your core training with dumbbells and kettlebells. 40 seconds of weighted work followed by 20 seconds rest  this session builds serious core strength and stability.",tips:["Start with a moderate weight  form is more important than load","Brace your entire core before picking up the weight each round","Keep movements controlled  no swinging or using momentum","If grip fails before core does, go slightly lighter next time"],interval:!0,rounds:3,work:40,rest:20,exercises:[{name:"Russian Twists Dumbbell",storagePath:"exercises/dumbbells/core/russian twists dumbbell.mp4"},{name:"Kettlebell Russian Twist",storagePath:"exercises/kettlebells/core/kettlebell russian twist.mp4"},{name:"Kettlebell Side Bends",storagePath:"exercises/kettlebells/core/kettlebell side bends.mp4"},{name:"Kneeling Kettlebell Halo",storagePath:"exercises/kettlebells/core/kneeling kettlebell halo.mp4"},{name:"Kettlebell Bird Dog Drag",storagePath:"exercises/kettlebells/core/kettlebell bird dog drag.mp4"},{name:"Dumbbell Plank Pull Through",storagePath:null}]}]},Vp=[{key:"bodyweight",label:"Bodyweight",icon:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 3c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm0 14.2c-2.5 0-4.71-1.28-6-3.22.03-1.99 4-3.08 6-3.08 1.99 0 5.97 1.09 6 3.08-1.29 1.94-3.5 3.22-6 3.22z"},{key:"dumbbells",label:"Dumbbells",icon:"M1 9h2v6H1V9zm3-2h2v10H4V7zm3 4h10v2H7v-2zm10-4h2v10h-2V7zm3 2h2v6h-2V9z"},{key:"kettlebells",label:"Kettlebells",icon:"M12 2C9.24 2 7 4.24 7 7c0 1.1.36 2.12.97 2.95C6.76 11.08 6 12.96 6 15c0 3.87 2.69 7 6 7s6-3.13 6-7c0-2.04-.76-3.92-1.97-5.05.61-.83.97-1.85.97-2.95 0-2.76-2.24-5-5-5zm0 2c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3z"}],qr=[{key:"core",label:"Core",icon:"M12 2a4 4 0 0 1 4 4v1h-2V6a2 2 0 1 0-4 0v1H8V6a4 4 0 0 1 4-4zM8 9h8v2H8V9zm-1 4h10l-1 9H8l-1-9z"},{key:"upper",label:"Upper",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm8 10l-3-1.5c-.5-.25-1-.5-1.5-.5h-7c-.5 0-1 .25-1.5.5L4 12l-2 6h4l1.5 4h9L18 18h4l-2-6z"},{key:"lower",label:"Lower",icon:"M16.5 3A2.5 2.5 0 0 0 14 5.5 2.5 2.5 0 0 0 16.5 8 2.5 2.5 0 0 0 19 5.5 2.5 2.5 0 0 0 16.5 3zM14 9l-3 7h2l1 6h2l1-6h2l-3-7h-2z"},{key:"fullbody",label:"Full Body",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm-2 8h4l1 4h2l-1 4h-2l-1 4h-2l-1-4H8l-1-4h2l1-4z"},{key:"mix",label:"Mix It Up",icon:"M10.59 9.17L5.41 4 4 5.41l5.17 5.17 1.42-1.41zM14.5 4l2.04 2.04L4 18.59 5.41 20 17.96 7.46 20 9.5V4h-5.5zm-.83 9.41l-1.42 1.42L17.96 20.54l1.42-1.42-5.71-5.71z"}],pi=[{key:"beginner",label:"Beginner",work:30,rest:30,desc:"30s work / 30s rest"},{key:"intermediate",label:"Intermediate",work:40,rest:20,desc:"40s work / 20s rest"},{key:"advanced",label:"Advanced",work:40,rest:15,desc:"40s work / 15s rest"}],Up=[5,10,15,20,30],sd={core:"#e85d04",upper:"#2196f3",lower:"#4caf50",fullbody:"#9c27b0",mix:"#ff9800"},g_=["Mix up your focus areas to build balanced strength.","Consistency beats intensity  show up and press play.","Try a new difficulty level to keep your body guessing.","Short on time? A 5-minute blast still counts.","Save your favourite combos so you can replay them anytime.","Your body adapts  switch equipment for fresh stimulus.","Rest days are growth days. Listen to your body.","Challenge yourself: go one level higher this week."];function C6(s){return s.replace(/\b\w/g,e=>e.toUpperCase())}function N6(s){const e=[...s];for(let t=e.length-1;t>0;t--){const i=Math.floor(Math.random()*(t+1));[e[t],e[i]]=[e[i],e[t]]}return e}function A6(){const{currentUser:s,isClient:e,clientData:t,loading:i}=Ci(),{isDark:l,toggleTheme:u,accent:h}=zo(),{isPremium:p,FREE_RANDOMISER_DURATIONS:g,FREE_RANDOMISER_WEEKLY_LIMIT:y}=Ru(),b=Sr(),[E,T]=w.useState("randomiser_hub"),[O,H]=w.useState(["bodyweight"]),[q,B]=w.useState("core"),[te,W]=w.useState("intermediate"),[ee,pe]=w.useState(p?15:5),[Te,ve]=w.useState([]),[A,S]=w.useState(!1),I=w.useRef(!1),V=w.useRef([]),[D,M]=w.useState([]),[N,Ue]=w.useState(2),[Ze,Z]=w.useState(pi[1]),[we,Ie]=w.useState(1),[Be,re]=w.useState(0),[L,ie]=w.useState("work"),[_e,ke]=w.useState(0),[Ee,xe]=w.useState(!1),[Ke,ct]=w.useState(0),[Pe,tn]=w.useState(!1),[jn,Un]=w.useState(!1),[Lt,rt]=w.useState(null),gt=w.useRef(null);w.useRef(null),w.useRef(null);const[ut,Bn]=w.useState(null),ue=w.useCallback((P,Y="info")=>{Bn({message:P,type:Y}),setTimeout(()=>Bn(null),3e3)},[]),Rt=w.useCallback(async P=>{if(!t)throw new Error("Not signed in");const Y=P&&typeof P=="object"&&P.type;await ti(Mt(Se,"posts"),{authorId:t.id,authorName:t.name||"Unknown",authorPhotoURL:t.photoURL||null,content:Y?"":P,type:Y?P.type:"text",imageURL:null,createdAt:hr(),likeCount:0,commentCount:0,...Y?{metadata:{title:P.title||"",subtitle:P.subtitle||"",stats:P.stats||[],quote:P.quote||"",badges:P.badges||[]}}:{}})},[t]),[yt,Vt]=w.useState(null),[Je,At]=w.useState(null),[vt,nn]=w.useState(0),[js,rs]=w.useState(0),[Xt,ne]=w.useState([]),[Ne,xt]=w.useState(""),[bt,it]=w.useState(""),[$e,st]=w.useState(!1),[Fe,sn]=w.useState(0),[on,Mn]=w.useState(!1),[zn,Xn]=w.useState({}),Yt=w.useRef(null),Fn=w.useRef(null),[Cn,ln]=w.useState(0),[fr,oe]=w.useState(0),[Ae,Ge]=w.useState(0),[mt,lt]=w.useState(0),[yn,Nn]=w.useState(0),[dn,vn]=w.useState(0),[Cs,is]=w.useState({beginner:0,intermediate:0,advanced:0}),ds=p?Up:Up.filter(P=>g.includes(P)),Jt=!p&&Cn>=y,[An,Ns]=w.useState([]),[jr,ai]=w.useState(!1),[Cr,Nr]=w.useState({}),[qn,Ks]=w.useState(!1),[ws,kn]=w.useState(!1),[Ln,as]=w.useState(""),[zt,Gr]=w.useState(null),[Ar,xs]=w.useState([]),[bn,nr]=w.useState({total:0,favouriteFocus:null,streak:0}),[oi,R]=w.useState(null),[z,ae]=w.useState(""),[le,Me]=w.useState(!1);w.useEffect(()=>{!i&&(!s||!e)&&b("/")},[s,e,i,b]),w.useEffect(()=>{if(!s||!t)return;(async()=>{try{const Y=Mt(Se,"workoutLogs"),X=In(Y,fn("clientId","==",t.id)),je=(await En(X)).docs.map(St=>St.data()),Oe=je.filter(St=>St.type!=="programme");lt(Oe.length);const qe=Oe.reduce((St,cn)=>St+(cn.duration||0),0);Nn(qe);const pt={beginner:0,intermediate:0,advanced:0};Oe.forEach(St=>{St.level&&pt[St.level]!==void 0&&pt[St.level]++}),is(pt);const Et=new Date,Pt=Et.getDay(),Qe=Pt===0?-6:1-Pt,Zt=new Date(Et);Zt.setDate(Et.getDate()+Qe),Zt.setHours(0,0,0,0);const Us=Zt.getTime(),Tt=je.filter(St=>{const cn=St.completedAt;return cn?(cn.toDate?cn.toDate().getTime():new Date(cn).getTime())>=Us:!1});ln(Tt.filter(St=>St.type!=="programme").length);let Hn=0;if(t)try{const St=await dr(nt(Se,"clientProgrammes",t.id));if(St.exists()){const cn=St.data(),Rn=cn.templateId;Hn=Tt.filter(fs=>fs.type==="programme"&&fs.programmeId===Rn).length,R(Rn);const Bs=Pp.find(fs=>fs.id===Rn);Bs&&ae(Bs.name);const zs=S6[Rn];if(zs){const fs=Object.keys(cn.completedSessions||{}).length,Ys=zs.duration*zs.daysPerWeek;Ge(Ys>0?Math.round(fs/Ys*100):0)}}else R(null),ae(""),Ge(0)}catch{}oe(Hn);const Jn=Oe.map(St=>St.completedAt).filter(Boolean).map(St=>St.toDate?St.toDate().getTime():new Date(St).getTime()).sort((St,cn)=>cn-St);if(Jn.length===0)vn(0);else{const St=new Set;Jn.forEach(Ys=>{const sr=new Date(Ys),Ai=sr.getDay(),Dr=Ai===0?-6:1-Ai,li=new Date(sr);li.setDate(sr.getDate()+Dr),li.setHours(0,0,0,0),St.add(li.getTime())});const cn=[...St].sort((Ys,sr)=>sr-Ys);let Rn=0;const Bs=new Date(Et),zs=Et.getDay()===0?-6:1-Et.getDay();Bs.setDate(Et.getDate()+zs),Bs.setHours(0,0,0,0);let fs=Bs.getTime();cn.includes(fs)||(fs-=10080*60*1e3);for(let Ys=0;Ys<200&&cn.includes(fs);Ys++)Rn++,fs-=10080*60*1e3;vn(Rn)}}catch(Y){console.error("Error loading workout stats:",Y)}finally{Me(!0)}})()},[s,t,E]),w.useEffect(()=>{if(!s||!t)return;(async()=>{try{const Y=In(Mt(Se,"savedWorkouts"),fn("clientId","==",t.id)),ye=(await En(Y)).docs.map(je=>({id:je.id,...je.data()}));ye.sort((je,Oe)=>{const qe=je.savedAt?.toMillis?.()||je.savedAt?.seconds*1e3||0;return(Oe.savedAt?.toMillis?.()||Oe.savedAt?.seconds*1e3||0)-qe}),Ns(ye)}catch(Y){console.error("Error loading saved workouts:",Y)}finally{ai(!0)}})()},[s,t]),w.useEffect(()=>{if(!s||!t)return;(async()=>{try{const Y=In(Mt(Se,"workoutLogs"),fn("clientId","==",t.id),hu("completedAt","desc"),du(20)),je=(await En(Y)).docs.map(Tt=>Tt.data()).filter(Tt=>Tt.type!=="programme"&&Tt.type!=="muscle_group");xs(je.slice(0,3));const Oe=je.length,qe={};je.forEach(Tt=>{Tt.focus&&(qe[Tt.focus]=(qe[Tt.focus]||0)+1)});const pt=Object.keys(qe).sort((Tt,Hn)=>qe[Hn]-qe[Tt])[0]||null;let Et=0;if(je.length>0){const Tt=new Set;je.forEach(St=>{const cn=St.completedAt?.toDate?St.completedAt.toDate():St.completedAt?new Date(St.completedAt):null;cn&&Tt.add(new Date(cn.getFullYear(),cn.getMonth(),cn.getDate()).toDateString())});const Hn=new Date;Hn.setHours(0,0,0,0);let Jn=new Date(Hn);for(Tt.has(Jn.toDateString())||Jn.setDate(Jn.getDate()-1);Tt.has(Jn.toDateString());)Et++,Jn.setDate(Jn.getDate()-1)}nr({total:Oe,favouriteFocus:pt,streak:Et});const Pt={core:null,upper:null,lower:null,fullbody:null};je.forEach(Tt=>{if(Tt.focus&&Pt[Tt.focus]===null&&Tt.completedAt){const Hn=Tt.completedAt.toDate?Tt.completedAt.toDate():new Date(Tt.completedAt);Pt[Tt.focus]=Hn}});let Qe=null,Zt=new Date;const Us=["core","upper","lower","fullbody"];for(const Tt of Us){if(Pt[Tt]===null){const Hn=qr.find(Jn=>Jn.key===Tt)?.label||Tt;Qe={focus:Tt,label:Hn,daysAgo:null,message:`You haven't tried ${Hn} yet`};break}if(Pt[Tt]<Zt){Zt=Pt[Tt];const Hn=Math.floor((Date.now()-Pt[Tt].getTime())/864e5);if(Hn>=5){const Jn=qr.find(St=>St.key===Tt)?.label||Tt;Qe={focus:Tt,label:Jn,daysAgo:Hn,message:`${Jn}  ${Hn} days ago`}}}}Gr(Qe)}catch(Y){console.error("Error loading recent workouts:",Y)}})()},[s,t,E]);const Le=async P=>{if(!(!s||!t||D.length===0)){Ks(!0);try{const Y=qr.find(je=>je.key===q)?.label||q,X=P||`${Y} ${ee}min`,ye=await ti(Mt(Se,"savedWorkouts"),{clientId:t.id,name:X,equipment:O,focus:q,level:te,duration:ee,exercises:D.map(je=>({name:je.name,videoUrl:je.videoUrl,isGif:je.isGif||!1})),rounds:N,savedAt:Gt.now()});Ns(je=>[{id:ye.id,clientId:t.id,name:X,equipment:O,focus:q,level:te,duration:ee,exercises:D.map(Oe=>({name:Oe.name,videoUrl:Oe.videoUrl,isGif:Oe.isGif||!1})),rounds:N,savedAt:Gt.now()},...je]),ue("Workout saved!","success")}catch(Y){console.error("Error saving workout:",Y),ue("Failed to save workout","error")}finally{Ks(!1),kn(!1),as("")}}},He=async P=>{try{await Er(nt(Se,"savedWorkouts",P)),Ns(Y=>Y.filter(X=>X.id!==P)),ue("Workout removed","info")}catch(Y){console.error("Error deleting saved workout:",Y),ue("Failed to remove workout","error")}},Ft=P=>{H(P.equipment||["bodyweight"]),B(P.focus||"core"),W(P.level||"intermediate"),pe(P.duration||15);const Y=pi.find(X=>X.key===(P.level||"intermediate"));Z(Y),M(P.exercises||[]),Ue(P.rounds||2),T("preview")},Ye=async()=>{const P=JSON.parse(localStorage.getItem("mcf_last_randomiser")||"null");H(P?.equipment||["bodyweight"]),B(P?.focus||"core"),W(P?.level||"intermediate"),pe(P?.duration||15),setTimeout(()=>Yn(),50)},Kn=()=>{localStorage.setItem("mcf_last_randomiser",JSON.stringify({equipment:O,focus:q,level:te,duration:ee}))};localStorage.getItem("mcf_last_randomiser");const os=()=>{const P=[];let Y;q==="mix"?Y=["core","upper","lower"]:q==="fullbody"?Y=["upper","lower"]:Y=[q];for(const X of O)for(const ye of Y)P.push(`exercises/${X}/${ye}`);return P},Vs=async()=>{if(I.current){for(;I.current;)await new Promise(P=>setTimeout(P,200));return V.current}I.current=!0,S(!0);try{const P=os(),Y=[];for(const Oe of P)try{const qe=Ua(Ba,Oe),pt=await l_(qe);Y.push(...pt.items)}catch{console.warn(`Folder ${Oe} not found, skipping.`)}if(Y.length===0&&O.includes("bodyweight")&&q==="core")try{const Oe=Ua(Ba,"core"),qe=await l_(Oe);Y.push(...qe.items)}catch{console.warn("Legacy core/ folder not found either.")}if(Y.length===0){const Oe=O.map(pt=>Vp.find(Et=>Et.key===pt)?.label).join(" + "),qe=qr.find(pt=>pt.key===q)?.label;return ue(`No exercises found for ${Oe} / ${qe}. Upload videos to Firebase Storage.`,"error"),I.current=!1,S(!1),[]}const X=new Set,ye=Y.filter(Oe=>{const qe=Oe.name.replace(/\.(mp4|gif)$/i,"");return X.has(qe)?!1:(X.add(qe),!0)}),je=await Promise.all(ye.map(async Oe=>{const qe=await No(Oe),pt=C6(Oe.name.replace(/\.(mp4|gif)$/i,"")),Et=/\.gif$/i.test(Oe.name);return{name:pt,videoUrl:qe,isGif:Et}}));return V.current=je,ve(je),I.current=!1,S(!1),je}catch(P){console.error("Error loading exercises:",P);const Y=P.code==="storage/unauthorized"?"Storage access denied. Check Firebase Storage rules allow read access.":`Failed to load exercises: ${P.message||P.code||"Unknown error"}`;return ue(Y,"error"),I.current=!1,S(!1),[]}},Yn=async()=>{if(Jt)return;Kn(),T("spinning"),V.current=[];const P=await Vs();if(P.length===0){T("setup");return}const Y=pi.find(Pt=>Pt.key===te);Z(Y);const X=Y.work+Y.rest,ye=ee*60,je=Math.floor(ye/X);let Oe,qe;je<=6?(Oe=Math.max(3,Math.floor(je/2)),qe=Math.floor(je/Oe)):je<=12?(Oe=Math.min(6,Math.floor(je/2)),qe=Math.floor(je/Oe)):(Oe=Math.min(10,Math.floor(je/2)),qe=Math.floor(je/Oe)),qe=Math.max(2,qe);const pt=N6(P),Et=pt.slice(0,Math.min(Oe,pt.length));M(Et),Ue(qe),setTimeout(()=>T("preview"),2e3)},mr=()=>{T("countdown"),ct(3)};w.useEffect(()=>{if(E!=="countdown")return;if(Ke<=0){T("workout"),Ie(1),re(0),ie("work"),ke(Ze.work),xe(!1),ht();return}ze();const P=setTimeout(()=>ct(Y=>Y-1),1e3);return()=>clearTimeout(P)},[Ke,E]),w.useEffect(()=>{if(E!=="workout"||Ee)return;if(_e<=0){oa();return}_e<=3&&ze();const P=setTimeout(()=>ke(Y=>Y-1),1e3);return()=>clearTimeout(P)},[_e,E,Ee]);const oa=()=>{if(L==="work")ie("rest"),ke(Ze.rest);else{const P=Be+1;if(P>=D.length){const Y=we+1;if(Y>N){tn(!0),Ni();return}Ie(Y),re(0)}else re(P);ie("work"),ke(Ze.work),ht()}},Ni=async()=>{if(s)try{await ti(Mt(Se,"workoutLogs"),{clientId:t.id,level:te,duration:ee,equipment:O,focus:q,exerciseCount:D.length,rounds:N,exercises:D.map(P=>P.name),completedAt:Gt.now()}),ln(P=>P+1),lt(P=>P+1),Nn(P=>P+ee),is(P=>({...P,[te]:(P[te]||0)+1}))}catch(P){console.error("Error saving workout log:",P)}},Rr=async(P,Y,X)=>{if(!(!t||!Y))try{const ye=t.id,je=await dr(nt(Se,"coreBuddyPBs",ye)),qe=(je.exists()?je.data():null)?.exercises||{},pt=qe[P];let Et=!1;if(pt?(Y>(pt.weight||0)||Y===(pt.weight||0)&&X>(pt.reps||0))&&(Et=!0):Et=!0,Et){const Pt={...qe,[P]:{weight:Y,reps:X,achievedAt:Gt.now()}};await Os(nt(Se,"coreBuddyPBs",ye),{clientId:t.id,exercises:Pt,updatedAt:Gt.now()}),ue(`New PB! ${Y}kg  ${X} reps`,"success"),ze()}}catch(ye){console.error("Error checking PB:",ye)}},la=async P=>{if(At(P),P.interval){const ye=[];for(const je of P.exercises){let Oe=null,qe=!1;if(je.storagePath)try{const pt=Ua(Ba,je.storagePath);Oe=await No(pt),qe=/\.gif$/i.test(je.storagePath)}catch{}ye.push({name:je.name,videoUrl:Oe,isGif:qe})}M(ye),Ue(P.rounds),Z({work:P.work,rest:P.rest}),T("preview");return}const Y={};for(const ye of P.exercises)if(ye.storagePath)try{const je=Ua(Ba,ye.storagePath);Y[ye.name]={url:await No(je),isGif:/\.gif$/i.test(ye.storagePath)}}catch{}Xn(Y);const X=P.exercises.map(ye=>({name:ye.name,type:ye.type,targetSets:ye.sets,targetReps:ye.reps||0,targetTime:ye.time||0,sets:[]}));ne(X),nn(0),rs(0),xt(""),it(""),Mn(!1),st(!1),sn(0),setMgSessionBadges([]),setMgBadgeCelebration(null),T("muscle_workout")},Ir=()=>{const P=Yt.current;P&&(P.paused?(P.play(),Mn(!0)):(P.pause(),Mn(!1)))};w.useEffect(()=>{if(E!=="muscle_workout"||!$e||Fe<=0){E==="muscle_workout"&&$e&&Fe<=0&&(st(!1),ze());return}return Fn.current=setTimeout(()=>sn(P=>P-1),1e3),()=>clearTimeout(Fn.current)},[E,$e,Fe]);const j=async()=>{const P=Xt[vt];let Y={};if(P.type==="weighted"){const je=parseFloat(Ne)||0,Oe=parseInt(bt)||0;if(Oe===0){ue("Enter your reps","error");return}Y={weight:je,reps:Oe}}else if(P.type==="reps"){const je=parseInt(bt)||0;if(je===0){ue("Enter your reps","error");return}Y={reps:je}}else if(P.type==="timed"){const je=P.targetTime-Fe;Y={time:Math.max(je,1)}}const X=[...Xt];X[vt]={...P,sets:[...P.sets,Y]},ne(X),P.type==="weighted"&&Y.weight>0&&await Rr(P.name,Y.weight,Y.reps);const ye=P.sets.length+1;if(ye<P.targetSets)rs(ye),it(""),st(!1),sn(0);else if(vt+1<Xt.length){const je=vt+1;nn(je),rs(0),xt(""),it(""),Mn(!1),st(!1),sn(0)}else await G(X),Un(!0)},G=async P=>{if(!(!s||!t))try{const Y=P.reduce((X,ye)=>X+ye.sets.length,0);await ti(Mt(Se,"workoutLogs"),{clientId:t.id,type:"muscle_group",muscleGroup:yt,sessionId:Je?.id,sessionName:Je?.name,exerciseCount:P.length,totalSets:Y,duration:Math.round(Y*1.5),exercises:P.map(X=>({name:X.name,type:X.type,sets:X.sets})),completedAt:Gt.now()})}catch(Y){console.error("Error saving muscle group workout log:",Y)}},Ce=w.useRef(null),Re=()=>(Ce.current||(Ce.current=new(window.AudioContext||window.webkitAudioContext)),Ce.current),ze=()=>{try{const P=Re(),Y=P.createOscillator(),X=P.createGain();Y.connect(X),X.connect(P.destination),Y.frequency.value=880,X.gain.value=.3,Y.start(P.currentTime),Y.stop(P.currentTime+.15)}catch{}},ht=()=>{try{const P=Re(),Y=P.createOscillator(),X=P.createGain();Y.connect(X),X.connect(P.destination),Y.frequency.value=1200,X.gain.value=.4,Y.start(P.currentTime),Y.stop(P.currentTime+.3)}catch{}};w.useEffect(()=>{if(E!=="workout"||L!=="work"||!D[Be]?.isGif)return;const Y=setInterval(()=>{const X=gt.current;if(!X)return;const ye=X.getAttribute("src");X.removeAttribute("src"),setTimeout(()=>{gt.current&&gt.current.setAttribute("src",ye)},0)},4e3);return()=>clearInterval(Y)},[E,L,Be,we,D]);const et=(P,Y,X)=>{const ye=Math.round(P/Y*k6);return o.jsx("svg",{className:"wk-ring-svg",viewBox:"0 0 200 200",children:zM.map((je,Oe)=>o.jsx("line",{x1:je.x1,y1:je.y1,x2:je.x2,y2:je.y2,className:Oe<ye?`wk-tick-filled ${X}`:"wk-tick-empty",strokeWidth:je.thick?"3":"2"},Oe))})},kt=()=>{const P=D.length*N;return((we-1)*D.length+Be+(L==="rest"?.5:0))/P},dt=ut&&o.jsx("div",{className:`toast-notification ${ut.type}`,children:ut.message});if(i)return o.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":h,children:[o.jsx("header",{className:"client-header",children:o.jsxs("div",{className:"header-content",children:[o.jsx("button",{className:"header-back-btn",onClick:()=>b("/client/core-buddy"),"aria-label":"Go back",children:o.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:o.jsx("path",{d:"M15 18l-6-6 6-6"})})}),o.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})]})}),o.jsx("div",{className:"wk-loading-inline",children:o.jsx("div",{className:"wk-loading-spinner"})})]});if(E==="menu")return o.jsx(Fo,{children:o.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":h,children:[o.jsx("header",{className:"client-header",children:o.jsxs("div",{className:"header-content",children:[o.jsx("button",{className:"header-back-btn",onClick:()=>b("/client/core-buddy"),"aria-label":"Go back",children:o.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:o.jsx("path",{d:"M15 18l-6-6 6-6"})})}),o.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),o.jsx("div",{className:"header-actions",children:o.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?o.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("circle",{cx:"12",cy:"12",r:"5"}),o.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):o.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),o.jsxs("main",{className:"wk-main",children:[o.jsxs("div",{className:"wk-menu-heading",children:[o.jsx("h2",{children:"Choose Your Workout"}),o.jsx("p",{children:"No excuses. Just results."})]}),o.jsx("button",{className:"wk-hero-card",onClick:()=>T("randomiser_hub"),children:o.jsx("img",{src:f_,alt:"Randomise Workout",className:"wk-hero-bg"})}),!p&&o.jsxs("button",{className:"wk-hero-card wk-free-card-premium",onClick:()=>b("/upgrade"),children:[o.jsx("img",{src:m_,alt:"Programmes",className:"wk-hero-bg"}),o.jsx("div",{className:"wk-free-card-overlay"}),o.jsxs("div",{className:"wk-free-card-content",children:[o.jsxs("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[o.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),o.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}),o.jsx("span",{className:"wk-free-card-label",children:"Unlock Full Access"})]})]}),p&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"wk-section-header",children:[o.jsx("h2",{children:"Programmes"}),o.jsxs("span",{className:"wk-section-count",children:[Pp.length," available"]})]}),o.jsx("div",{className:"wk-prog-scroll-wrap",children:o.jsx("div",{className:"wk-prog-scroll",children:Pp.map((P,Y)=>P.image?o.jsxs("button",{className:"wk-prog-img-card",onClick:()=>b("/client/core-buddy/programmes",{state:{templateId:P.id}}),style:{animationDelay:`${Y*.06}s`},children:[o.jsx("img",{src:P.image,alt:P.name,className:"wk-prog-img"}),Y===0&&o.jsx("div",{className:"wk-swipe-arrow",children:o.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:o.jsx("path",{d:"M9 18l6-6-6-6"})})})]},P.id):o.jsxs("button",{className:"wk-prog-hero-card",onClick:()=>b("/client/core-buddy/programmes",{state:{templateId:P.id}}),style:{animationDelay:`${Y*.06}s`},children:[o.jsx("img",{src:m_,alt:"Programme",className:"wk-prog-hero-bg",loading:"lazy"}),o.jsx("div",{className:"wk-prog-hero-overlay",style:{background:j6[P.focus]}}),o.jsxs("div",{className:"wk-prog-hero-content",children:[o.jsxs("div",{className:"wk-prog-hero-top",children:[o.jsxs("span",{className:"wk-prog-hero-badge",children:[P.duration," WEEKS"]}),o.jsx("span",{className:"wk-prog-hero-level",children:P.level})]}),o.jsxs("div",{className:"wk-prog-hero-bottom",children:[o.jsx("h3",{children:P.name.toUpperCase()}),o.jsxs("p",{children:[P.daysPerWeek,"x per week  ",P.focus==="fullbody"?"Full Body":P.focus.charAt(0).toUpperCase()+P.focus.slice(1)," Focus"]}),o.jsx("span",{className:"wk-prog-hero-go",children:"VIEW PROGRAMME "})]})]}),Y===0&&o.jsx("div",{className:"wk-swipe-arrow",children:o.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:o.jsx("path",{d:"M9 18l6-6-6-6"})})})]},P.id))})})]}),p&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"wk-section-header",children:[o.jsx("h2",{children:"Muscle Groups"}),o.jsxs("span",{className:"wk-section-count",children:[Vc.length," groups"]})]}),o.jsx("div",{className:"wk-muscle-grid",children:Vc.map((P,Y)=>o.jsx("button",{className:`wk-muscle-hero-card${P.image?" wk-muscle-thumb":""}`,onClick:()=>{Vt(P.key),T("muscle_sessions")},style:{animationDelay:`${Y*.05}s`},children:P.image?o.jsx("img",{src:P.image,alt:P.label,className:"wk-muscle-thumb-img"}):o.jsxs(o.Fragment,{children:[o.jsx("img",{src:f_,alt:"Muscle group",className:"wk-muscle-hero-bg",loading:"lazy"}),o.jsx("div",{className:"wk-muscle-hero-overlay",style:{background:Op[P.key]}}),o.jsxs("div",{className:"wk-muscle-hero-content",children:[o.jsx("div",{className:"wk-muscle-hero-icon",children:o.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:o.jsx("path",{d:P.icon})})}),o.jsxs("div",{className:"wk-muscle-hero-text",children:[o.jsx("span",{className:"wk-muscle-hero-name",children:P.label}),o.jsxs("span",{className:"wk-muscle-hero-count",children:[p_[P.key]?.length||0," sessions"]})]})]})]})},P.key))})]})]}),o.jsx(sa,{active:"workouts"}),dt]})});if(E==="randomiser_hub"){const P=JSON.parse(localStorage.getItem("mcf_last_randomiser")||"null")||{focus:"core",level:"intermediate",duration:15},Y=qr.find(ye=>ye.key===P.focus)?.label||P.focus,X=pi.find(ye=>ye.key===P.level)?.label||P.level;return o.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":h,children:[o.jsx("header",{className:"client-header",children:o.jsxs("div",{className:"header-content",children:[o.jsx("button",{className:"header-back-btn",onClick:()=>b("/client/core-buddy"),"aria-label":"Go back",children:o.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:o.jsx("path",{d:"M15 18l-6-6 6-6"})})}),o.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),o.jsx("div",{className:"header-actions",children:o.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?o.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("circle",{cx:"12",cy:"12",r:"5"}),o.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):o.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),o.jsxs("main",{className:"wk-main",children:[o.jsxs("div",{className:"wk-hub-heading wk-hub-heading-hero",children:[o.jsxs("div",{className:"wk-hub-logo-wrap",children:[o.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"wk-hub-logo-img"}),o.jsx("div",{className:"wk-hub-dice-float",children:o.jsxs("svg",{className:"wk-hub-dice-icon",width:"36",height:"36",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round",children:[o.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"3"}),o.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.2",fill:"currentColor",stroke:"none"}),o.jsx("circle",{cx:"15.5",cy:"8.5",r:"1.2",fill:"currentColor",stroke:"none"}),o.jsx("circle",{cx:"12",cy:"12",r:"1.2",fill:"currentColor",stroke:"none"}),o.jsx("circle",{cx:"8.5",cy:"15.5",r:"1.2",fill:"currentColor",stroke:"none"}),o.jsx("circle",{cx:"15.5",cy:"15.5",r:"1.2",fill:"currentColor",stroke:"none"})]})})]}),o.jsx("h2",{children:"Randomiser"}),o.jsx("p",{children:"Generate, save & replay workouts"})]}),bn.total>0&&o.jsxs("div",{className:"wk-hub-stats",children:[o.jsxs("div",{className:"wk-hub-stat",children:[o.jsx("span",{className:"wk-hub-stat-value",children:bn.total}),o.jsx("span",{className:"wk-hub-stat-label",children:"Workouts"})]}),bn.streak>0&&o.jsxs("div",{className:"wk-hub-stat",children:[o.jsxs("span",{className:"wk-hub-stat-value",children:[bn.streak,o.jsx("small",{children:"d"})]}),o.jsx("span",{className:"wk-hub-stat-label",children:"Streak"})]}),bn.favouriteFocus&&o.jsxs("div",{className:"wk-hub-stat",children:[o.jsx("span",{className:"wk-hub-stat-value wk-hub-stat-focus",style:{color:sd[bn.favouriteFocus]||"var(--color-primary)"},children:qr.find(ye=>ye.key===bn.favouriteFocus)?.label||bn.favouriteFocus}),o.jsx("span",{className:"wk-hub-stat-label",children:"Top Focus"})]})]}),o.jsxs("div",{className:"wk-hub-tip",children:[o.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:o.jsx("path",{d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 1 1 7.072 0l-.548.547A3.374 3.374 0 0 0 14 18.469V19a2 2 0 1 1-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),g_[Math.floor(Date.now()/864e5)%g_.length]]}),o.jsxs("div",{className:"wk-hub-actions",children:[o.jsxs("button",{className:"wk-hub-action-btn wk-hub-new wk-hub-new-glow",onClick:()=>T("setup"),children:[o.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[o.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),o.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),"New Workout"]}),o.jsxs("button",{className:"wk-hub-action-btn wk-hub-quick",onClick:Ye,disabled:Jt,children:[o.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:o.jsx("polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2"})}),"Quick Start",o.jsxs("span",{className:"wk-hub-quick-meta",children:[Y,"  ",X,"  ",P.duration,"min"]})]})]}),zt&&o.jsxs("div",{className:"wk-hub-section",children:[o.jsxs("h3",{className:"wk-hub-section-title",children:[o.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:o.jsx("path",{d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 1 1 7.072 0l-.548.547A3.374 3.374 0 0 0 14 18.469V19a2 2 0 1 1-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),"Suggested For You"]}),o.jsxs("button",{className:"wk-hub-suggestion",onClick:()=>{B(zt.focus),T("setup")},children:[o.jsxs("div",{className:"wk-hub-suggestion-info",children:[o.jsx("span",{className:"wk-hub-suggestion-label",children:zt.message}),o.jsx("span",{className:"wk-hub-suggestion-cta",children:"Tap to set up "})]}),o.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:o.jsx("path",{d:"M9 18l6-6-6-6"})})]})]}),p&&o.jsxs("div",{className:"wk-hub-section",children:[o.jsxs("h3",{className:"wk-hub-section-title",children:[o.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:o.jsx("path",{d:"M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"})}),"Saved Workouts",An.length>0&&o.jsx("span",{className:"wk-hub-count",children:An.length})]}),jr?An.length===0?o.jsxs("div",{className:"wk-hub-empty wk-hub-empty-enhanced",children:[o.jsx("svg",{className:"wk-hub-empty-icon",width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:o.jsx("path",{d:"M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"})}),o.jsx("p",{children:o.jsx("strong",{children:"No saved workouts yet"})}),o.jsx("p",{className:"wk-hub-empty-sub",children:"Generate a workout and hit save to stash it here for quick replay."})]}):o.jsx("div",{className:"wk-hub-saved-categories",children:qr.map(ye=>{const je=An.filter(qe=>qe.focus===ye.key);if(je.length===0)return null;const Oe=Cr[ye.key]||!1;return o.jsxs("div",{className:"wk-hub-saved-cat",children:[o.jsxs("button",{className:`wk-hub-saved-cat-header${Oe?" wk-hub-saved-cat-open":""}`,style:{"--cat-color":sd[ye.key]||"var(--color-primary)"},onClick:()=>Nr(qe=>({...qe,[ye.key]:!qe[ye.key]})),children:[o.jsxs("span",{className:"wk-hub-saved-cat-label",children:[o.jsx("span",{className:"wk-hub-focus-pill",style:{"--pill-color":sd[ye.key]||"var(--color-primary)"},children:ye.label}),o.jsx("span",{className:"wk-hub-saved-cat-count",children:je.length})]}),o.jsx("svg",{className:`wk-hub-saved-cat-chevron${Oe?" wk-hub-saved-cat-chevron-open":""}`,width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:o.jsx("polyline",{points:"6 9 12 15 18 9"})})]}),Oe&&o.jsx("div",{className:"wk-hub-saved-list",children:je.map((qe,pt)=>{const Et=(qe.equipment||[]).map(Qe=>Vp.find(Zt=>Zt.key===Qe)?.label||Qe).join(", "),Pt=pi.find(Qe=>Qe.key===qe.level)?.label||qe.level;return o.jsxs("div",{className:"wk-hub-saved-card",style:{animationDelay:`${pt*.05}s`},children:[o.jsxs("button",{className:"wk-hub-saved-main",onClick:()=>Ft(qe),children:[o.jsxs("div",{className:"wk-hub-saved-info",children:[o.jsx("span",{className:"wk-hub-saved-name",children:qe.name}),o.jsx("span",{className:"wk-hub-saved-tags",children:o.jsxs("span",{className:"wk-hub-saved-meta",children:[Pt,"  ",qe.duration,"min  ",(qe.exercises||[]).length," ex"]})}),Et&&o.jsx("span",{className:"wk-hub-saved-equip",children:Et})]}),o.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"currentColor",children:o.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})})]}),o.jsx("button",{className:"wk-hub-saved-delete",onClick:()=>He(qe.id),"aria-label":"Remove saved workout",children:o.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[o.jsx("polyline",{points:"3 6 5 6 21 6"}),o.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]},qe.id)})})]},ye.key)})}):o.jsx("div",{className:"wk-hub-empty",children:o.jsx("div",{className:"wk-loading-spinner"})})]}),Ar.length>0&&o.jsxs("div",{className:"wk-hub-section",children:[o.jsxs("h3",{className:"wk-hub-section-title",children:[o.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[o.jsx("circle",{cx:"12",cy:"12",r:"10"}),o.jsx("polyline",{points:"12 6 12 12 16 14"})]}),"Recent"]}),o.jsx("div",{className:"wk-hub-recent-list",children:Ar.map((ye,je)=>{const Oe=qr.find(Pt=>Pt.key===ye.focus)?.label||ye.focus||"",qe=pi.find(Pt=>Pt.key===ye.level)?.label||ye.level||"",pt=ye.completedAt?.toDate?ye.completedAt.toDate():ye.completedAt?new Date(ye.completedAt):null,Et=pt?(()=>{const Pt=Math.floor((Date.now()-pt.getTime())/1e3);return Pt<3600?`${Math.floor(Pt/60)}m ago`:Pt<86400?`${Math.floor(Pt/3600)}h ago`:`${Math.floor(Pt/86400)}d ago`})():"";return o.jsxs("div",{className:"wk-hub-recent-card",style:{animationDelay:`${je*.05}s`},children:[o.jsx("div",{className:"wk-hub-recent-info",children:o.jsxs("span",{className:"wk-hub-recent-tags",children:[o.jsx("span",{className:"wk-hub-focus-pill",style:{"--pill-color":sd[ye.focus]||"var(--color-primary)"},children:Oe}),o.jsxs("span",{className:"wk-hub-recent-meta",children:[qe,"  ",ye.duration||"?","min  ",ye.exerciseCount||"?"," ex"]})]})}),o.jsx("span",{className:"wk-hub-recent-time",children:Et})]},je)})})]})]}),o.jsx(sa,{active:"workouts"}),dt]})}if(E==="setup"){const P=qr.find(X=>X.key===q)?.label||q,Y=pi.find(X=>X.key===te)?.label||te;return o.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":h,children:[o.jsx("header",{className:"client-header",children:o.jsxs("div",{className:"header-content",children:[o.jsx("button",{className:"header-back-btn",onClick:()=>T("randomiser_hub"),"aria-label":"Go back",children:o.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:o.jsx("path",{d:"M15 18l-6-6 6-6"})})}),o.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),o.jsx("div",{className:"header-actions",children:o.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?o.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("circle",{cx:"12",cy:"12",r:"5"}),o.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):o.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),o.jsxs("main",{className:"wk-main wk-setup-main",children:[o.jsx("div",{className:"wk-stats-row",children:[{label:"Total",value:`${mt}`,pct:mt>0?Math.min(Math.round(mt/100*100),100):0,color:"#14b8a6",size:"normal"},{label:"This Week",value:`${Cn}/${Lp}`,pct:Math.round(Math.min(Cn,Lp)/Lp*100),color:"var(--color-primary)",size:"large"},{label:"Wk Streak",value:`${dn}`,pct:dn>0?Math.min(Math.round(dn/12*100),100):0,color:"#38B6FF",size:"normal"}].map(X=>{const je=2*Math.PI*38,Oe=je-X.pct/100*je;return o.jsxs("div",{className:`wk-stat-item${X.size==="large"?" wk-stat-large":""}`,children:[o.jsxs("div",{className:"wk-stat-ring",children:[o.jsxs("svg",{viewBox:"0 0 100 100",children:[o.jsx("circle",{className:"wk-stat-track",cx:"50",cy:"50",r:38}),o.jsx("circle",{className:"wk-stat-fill",cx:"50",cy:"50",r:38,style:{stroke:X.color},strokeDasharray:je,strokeDashoffset:Oe})]}),o.jsx("span",{className:"wk-stat-value",style:{color:X.color},children:X.value})]}),o.jsx("span",{className:"wk-stat-label",children:X.label})]},X.label)})}),o.jsxs("div",{className:"wk-setup-flow",children:[o.jsxs("div",{className:"wk-setup-section",children:[o.jsx("h2",{children:"Focus Area"}),o.jsx("div",{className:"wk-focus-grid",children:qr.map(X=>o.jsxs("button",{className:`wk-equip-btn${q===X.key?" active":""}${X.key==="mix"?" wk-mix-btn":""}`,onClick:()=>B(X.key),children:[o.jsx("svg",{className:"wk-equip-icon",viewBox:"0 0 24 24",fill:"currentColor",children:o.jsx("path",{d:X.icon})}),o.jsx("span",{children:X.label})]},X.key))})]}),o.jsxs("div",{className:"wk-setup-section",children:[o.jsx("h2",{children:"Level"}),o.jsx("div",{className:"wk-level-cards",children:pi.map(X=>o.jsxs("button",{className:`wk-level-card wk-level-${X.key}${te===X.key?" active":""}`,onClick:()=>W(X.key),children:[o.jsx("span",{className:"wk-level-name",children:X.label}),o.jsx("span",{className:"wk-level-desc",children:X.desc})]},X.key))})]}),o.jsxs("div",{className:"wk-setup-section",children:[o.jsx("h2",{children:"Time"}),o.jsx("div",{className:"wk-time-options",children:Up.map(X=>{const ye=!ds.includes(X);return o.jsxs("button",{className:`wk-time-btn${ee===X?" active":""}${ye?" locked":""}`,onClick:()=>!ye&&pe(X),disabled:ye,children:[o.jsx("span",{className:"wk-time-num",children:X}),o.jsx("span",{className:"wk-time-unit",children:ye?o.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[o.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),o.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}):"min"})]},X)})})]}),o.jsxs("div",{className:"wk-setup-section",children:[o.jsx("h2",{children:"Equipment"}),o.jsx("div",{className:"wk-equip-options",children:Vp.map(X=>{const ye=O.includes(X.key);return o.jsxs("button",{className:`wk-equip-btn${ye?" active":""}`,onClick:()=>{H(je=>ye&&je.length===1?je:ye?je.filter(Oe=>Oe!==X.key):[...je,X.key])},children:[o.jsx("svg",{className:"wk-equip-icon",viewBox:"0 0 24 24",fill:"currentColor",children:o.jsx("path",{d:X.icon})}),o.jsx("span",{children:X.label})]},X.key)})})]}),o.jsx("div",{className:"wk-setup-summary",children:o.jsxs("span",{children:[P,"  ",Y,"  ",ee," min"]})})]})]}),o.jsxs("div",{className:"wk-go-sticky",children:[Jt&&o.jsx("p",{className:"wk-free-limit-msg",children:"You've used your free workout this week. Upgrade for unlimited access."}),o.jsx("button",{className:"wk-randomise-btn",onClick:Yn,disabled:A||Jt,children:A?"Loading exercises...":Jt?"Limit Reached":"Randomise Workout"})]}),dt]})}if(E==="spinning")return o.jsxs("div",{className:"wk-page wk-page-center","data-theme":l?"dark":"light","data-accent":h,children:[o.jsxs("div",{className:"wk-spin-container",children:[o.jsxs("div",{className:"wk-spin-ring",children:[o.jsx("svg",{className:"wk-spin-svg",viewBox:"0 0 200 200",children:BM.map((P,Y)=>o.jsx("line",{x1:P.x1,y1:P.y1,x2:P.x2,y2:P.y2,className:"wk-spin-tick",strokeWidth:P.thick?"3.5":"2",style:{animationDelay:`${Y*.03}s`}},Y))}),o.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"wk-spin-logo",width:"50",height:"50"})]}),o.jsx("p",{className:"wk-spin-text",children:"Generating workout..."})]}),dt]});if(E==="preview"){const P=Je?.interval?{work:Je.work,rest:Je.rest}:pi.find(X=>X.key===te),Y=D.length*N*(P.work+P.rest);return o.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":h,children:[o.jsx("header",{className:"client-header",children:o.jsxs("div",{className:"header-content",children:[o.jsx("button",{className:"header-back-btn",onClick:()=>T(Je?.interval?"muscle_sessions":"setup"),"aria-label":"Go back",children:o.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:o.jsx("path",{d:"M15 18l-6-6 6-6"})})}),o.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),o.jsx("div",{className:"header-actions",children:o.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?o.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("circle",{cx:"12",cy:"12",r:"5"}),o.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):o.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),o.jsxs("main",{className:"wk-main",children:[Je?.interval&&o.jsx("h2",{className:"mg-preview-title",children:Je.name}),o.jsxs("div",{className:"wk-preview-stats",children:[o.jsxs("div",{className:"wk-stat",children:[o.jsx("span",{className:"wk-stat-val",children:D.length}),o.jsx("span",{className:"wk-stat-label",children:"Exercises"})]}),o.jsxs("div",{className:"wk-stat",children:[o.jsx("span",{className:"wk-stat-val",children:N}),o.jsx("span",{className:"wk-stat-label",children:"Rounds"})]}),o.jsxs("div",{className:"wk-stat",children:[o.jsx("span",{className:"wk-stat-val",children:Math.ceil(Y/60)}),o.jsx("span",{className:"wk-stat-label",children:"Minutes"})]}),o.jsxs("div",{className:"wk-stat",children:[o.jsxs("span",{className:"wk-stat-val",children:[P.work,"/",P.rest]}),o.jsx("span",{className:"wk-stat-label",children:"Work/Rest"})]})]}),o.jsx("div",{className:"wk-preview-list",children:D.map((X,ye)=>o.jsxs("div",{className:"wk-preview-item",style:{animationDelay:`${ye*.06}s`},onClick:()=>rt(X),children:[o.jsx("span",{className:"wk-preview-num",children:ye+1}),o.jsx("div",{className:"wk-preview-thumb",children:X.isGif?o.jsx("img",{src:X.videoUrl,alt:X.name,loading:"lazy"}):o.jsx("video",{src:`${X.videoUrl}#t=0.1`,muted:!0,playsInline:!0,preload:"auto"})}),o.jsx("span",{className:"wk-preview-name",children:X.name}),o.jsx("svg",{className:"wk-preview-play",width:"22",height:"22",viewBox:"0 0 24 24",fill:"currentColor",children:o.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})})]},ye))}),Lt&&o.jsx("div",{className:"wk-preview-modal-backdrop",onClick:()=>rt(null),children:o.jsxs("div",{className:"wk-preview-modal",onClick:X=>X.stopPropagation(),children:[o.jsx("button",{className:"wk-preview-modal-close",onClick:()=>rt(null),"aria-label":"Close preview",children:o.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[o.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),o.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})}),o.jsx("div",{className:"wk-preview-modal-video",children:Lt.isGif?o.jsx("img",{src:Lt.videoUrl,alt:Lt.name}):o.jsx("video",{src:Lt.videoUrl,autoPlay:!0,loop:!0,muted:!0,playsInline:!0})}),o.jsx("h3",{className:"wk-preview-modal-title",children:Lt.name})]})}),o.jsxs("div",{className:"wk-preview-actions",children:[!Je?.interval&&o.jsxs("div",{className:"wk-preview-actions-row",children:[o.jsxs("button",{className:"wk-btn-secondary wk-btn-half",onClick:()=>Yn(),children:[o.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("polyline",{points:"1 4 1 10 7 10"}),o.jsx("path",{d:"M3.51 15a9 9 0 1 0 2.13-9.36L1 10"})]}),"Reshuffle"]}),p&&o.jsxs("button",{className:"wk-btn-secondary wk-btn-half",onClick:()=>kn(!0),disabled:qn,children:[o.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:o.jsx("path",{d:"M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"})}),"Save"]})]}),o.jsx("button",{className:"wk-btn-primary wk-btn-full",onClick:mr,children:"Start Workout"})]}),ws&&o.jsx("div",{className:"wk-save-modal-backdrop",onClick:()=>kn(!1),children:o.jsxs("div",{className:"wk-save-modal",onClick:X=>X.stopPropagation(),children:[o.jsx("h3",{children:"Save Workout"}),o.jsx("p",{children:"Give this workout a name (or leave blank for auto-name)"}),o.jsx("input",{type:"text",className:"wk-save-input",value:Ln,onChange:X=>as(X.target.value),placeholder:`${qr.find(X=>X.key===q)?.label||q} ${ee}min`,maxLength:40,autoFocus:!0}),o.jsxs("div",{className:"wk-save-modal-actions",children:[o.jsx("button",{className:"wk-btn-secondary",onClick:()=>kn(!1),children:"Cancel"}),o.jsx("button",{className:"wk-btn-primary",onClick:()=>Le(Ln),disabled:qn,children:qn?"Saving...":"Save"})]})]})})]})]})}if(E==="countdown")return o.jsx("div",{className:"wk-page wk-page-center wk-page-dark","data-theme":l?"dark":"light","data-accent":h,children:o.jsxs("div",{className:"wk-countdown-big",children:[o.jsx("span",{className:"wk-countdown-num",children:Ke}),o.jsx("span",{className:"wk-countdown-label",children:"GET READY"})]})});if(E==="workout"){const P=D[Be],Y=L==="work"?Ze.work:Ze.rest,X=L==="rest"?Be+1<D.length?D[Be+1]:we<N?D[0]:null:null;return o.jsxs("div",{className:"wk-page wk-page-workout","data-theme":l?"dark":"light","data-accent":h,children:[o.jsx("div",{className:"wk-video-container",children:L==="work"?P.isGif?o.jsx("img",{ref:gt,className:"wk-video",src:P.videoUrl,alt:P.name},P.videoUrl):o.jsx("video",{className:"wk-video",src:P.videoUrl,autoPlay:!0,loop:!0,muted:!0,playsInline:!0},P.videoUrl):o.jsxs("div",{className:"wk-rest-screen",children:[o.jsx("span",{className:"wk-rest-label",children:"REST"}),X&&o.jsxs("span",{className:"wk-next-label",children:["Next: ",X.name]})]})}),o.jsx("div",{className:"wk-back-row",children:o.jsxs("button",{className:"wk-back-btn",onClick:()=>{confirm("Leave workout?")&&T("randomiser_hub")},children:[o.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:o.jsx("path",{d:"M15 18l-6-6 6-6"})}),"Back"]})}),o.jsx("div",{className:"wk-spotify",children:o.jsx("iframe",{src:"https://open.spotify.com/embed/playlist/37i9dQZF1DZ06evO3FJyYF?utm_source=generator&theme=0",width:"100%",height:"80",frameBorder:"0",allow:"autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture",loading:"lazy",title:"Spotify Playlist"})}),o.jsxs("div",{className:"wk-exercise-info",children:[o.jsxs("span",{className:"wk-exercise-counter",children:[Be+1," / ",D.length]}),o.jsx("h2",{className:"wk-exercise-name",children:P.name}),o.jsxs("span",{className:"wk-round-label",children:["Round ",we," of ",N]})]}),o.jsx("div",{className:"wk-timer-section",children:o.jsxs("div",{className:"wk-timer-ring-wrap",children:[et(_e,Y,L==="work"?"wk-tick-work":"wk-tick-rest"),o.jsxs("div",{className:"wk-timer-center",children:[o.jsx("span",{className:"wk-timer-time",children:_e}),o.jsx("span",{className:`wk-timer-phase ${L}`,children:L==="work"?"WORK":"REST"})]})]})}),o.jsxs("div",{className:"wk-controls",children:[o.jsx("button",{className:"wk-ctrl-btn wk-ctrl-stop",onClick:()=>{confirm("End workout early?")&&T("randomiser_hub")},children:o.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:o.jsx("rect",{x:"4",y:"4",width:"16",height:"16",rx:"2"})})}),o.jsx("button",{className:"wk-ctrl-btn wk-ctrl-pause",onClick:()=>xe(!Ee),children:Ee?o.jsx("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"currentColor",children:o.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})}):o.jsxs("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"currentColor",children:[o.jsx("rect",{x:"6",y:"4",width:"4",height:"16"}),o.jsx("rect",{x:"14",y:"4",width:"4",height:"16"})]})}),o.jsx("button",{className:"wk-ctrl-btn wk-ctrl-skip",onClick:()=>{ke(0)},children:o.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:[o.jsx("polygon",{points:"5 4 15 12 5 20 5 4"}),o.jsx("rect",{x:"15",y:"4",width:"4",height:"16"})]})})]}),o.jsx("div",{className:"wk-progress-bar",children:o.jsx("div",{className:"wk-progress-fill",style:{width:`${kt()*100}%`}})}),Pe&&(()=>{const ye=pi.find(Oe=>Oe.key===te),je=D.length*N*(ye.work+ye.rest);return o.jsxs(o.Fragment,{children:[o.jsx(_g,{title:"Workout Complete!",stats:[{value:Math.ceil(je/60),label:"Minutes"},{value:D.length*N,label:"Intervals"},{value:N,label:"Rounds"}],hideShare:!p,onShareJourney:t?Rt:null,userName:t?.name,onDismissStart:()=>T("randomiser_hub"),onDone:()=>{tn(!1),At(null),Vt(null)}}),!Je?.interval&&o.jsxs("button",{className:"wk-complete-save-btn",onClick:()=>kn(!0),disabled:qn,children:[o.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:o.jsx("path",{d:"M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"})}),"Save This Workout"]}),ws&&o.jsx("div",{className:"wk-save-modal-backdrop",onClick:()=>kn(!1),style:{zIndex:10001},children:o.jsxs("div",{className:"wk-save-modal",onClick:Oe=>Oe.stopPropagation(),children:[o.jsx("h3",{children:"Save Workout"}),o.jsx("p",{children:"Give this workout a name (or leave blank for auto-name)"}),o.jsx("input",{type:"text",className:"wk-save-input",value:Ln,onChange:Oe=>as(Oe.target.value),placeholder:`${qr.find(Oe=>Oe.key===q)?.label||q} ${ee}min`,maxLength:40,autoFocus:!0}),o.jsxs("div",{className:"wk-save-modal-actions",children:[o.jsx("button",{className:"wk-btn-secondary",onClick:()=>kn(!1),children:"Cancel"}),o.jsx("button",{className:"wk-btn-primary",onClick:()=>Le(Ln),disabled:qn,children:qn?"Saving...":"Save"})]})]})})]})})()]})}if(E==="muscle_sessions"){const P=Vc.find(X=>X.key===yt),Y=p_[yt]||[];return o.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":h,children:[o.jsx("header",{className:"client-header",children:o.jsxs("div",{className:"header-content",children:[o.jsx("button",{className:"header-back-btn",onClick:()=>T("randomiser_hub"),"aria-label":"Go back",children:o.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:o.jsx("path",{d:"M15 18l-6-6 6-6"})})}),o.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),o.jsx("div",{className:"header-actions",children:o.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?o.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("circle",{cx:"12",cy:"12",r:"5"}),o.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):o.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),o.jsxs("main",{className:"wk-main",children:[o.jsxs("div",{className:"mg-sessions-header",children:[o.jsx("div",{className:"mg-sessions-icon",style:{background:Op[yt]},children:o.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:o.jsx("path",{d:P?.icon})})}),o.jsxs("h2",{children:[P?.label," Workouts"]}),o.jsxs("p",{children:[Y.length," sessions available"]})]}),o.jsx("div",{className:"mg-sessions-list",children:Y.map((X,ye)=>o.jsxs("button",{className:"mg-session-card",onClick:()=>{At(X),T("muscle_overview")},style:{animationDelay:`${ye*.08}s`},children:[o.jsxs("div",{className:"mg-session-info",children:[o.jsx("h3",{children:X.name}),o.jsx("p",{children:X.desc}),o.jsx("div",{className:"mg-session-meta",children:X.interval?o.jsxs(o.Fragment,{children:[o.jsx("span",{className:"mg-session-tag mg-tag-interval",children:"Interval"}),o.jsxs("span",{className:"mg-session-tag",children:[X.exercises.length," exercises"]}),o.jsxs("span",{className:"mg-session-tag",children:[X.rounds," rounds"]})]}):o.jsxs(o.Fragment,{children:[o.jsx("span",{className:"mg-session-tag mg-tag-strength",children:"Strength"}),o.jsxs("span",{className:"mg-session-tag",children:[X.exercises.length," exercises"]}),o.jsx("span",{className:"mg-session-tag",children:(()=>{const je=X.exercises.map(pt=>pt.sets||0),Oe=Math.min(...je),qe=Math.max(...je);return Oe===qe?`${Oe} sets each`:`${Oe}-${qe} sets each`})()})]})})]}),o.jsx("div",{className:"mg-session-arrow",children:o.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:o.jsx("path",{d:"M9 18l6-6-6-6"})})})]},X.id))})]}),dt]})}if(E==="muscle_overview"){const P=Je;if(!P)return null;const Y=Vc.find(X=>X.key===yt);return o.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":h,children:[o.jsx("header",{className:"client-header",children:o.jsxs("div",{className:"header-content",children:[o.jsx("button",{className:"header-back-btn",onClick:()=>T("muscle_sessions"),"aria-label":"Go back",children:o.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:o.jsx("path",{d:"M15 18l-6-6 6-6"})})}),o.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),o.jsx("div",{className:"header-actions",children:o.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?o.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("circle",{cx:"12",cy:"12",r:"5"}),o.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):o.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),o.jsxs("main",{className:"wk-main mg-overview-main",children:[o.jsx("div",{className:"mg-overview-hero",style:P.image?void 0:{background:Op[yt]},children:P.image?o.jsx("img",{src:P.image,alt:P.name,className:"mg-overview-hero-img"}):o.jsx("div",{className:"mg-overview-hero-content",children:o.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",className:"mg-overview-hero-icon",children:o.jsx("path",{d:Y?.icon})})})}),o.jsxs("div",{className:"mg-overview-header",children:[o.jsxs("div",{className:"mg-overview-title-row",children:[o.jsx("h2",{children:P.name}),P.level&&o.jsx("span",{className:"mg-overview-level",children:P.level})]}),o.jsx("p",{className:"mg-overview-desc",children:P.desc})]}),P.overview&&o.jsxs("div",{className:"mg-overview-section",children:[o.jsxs("h3",{children:[o.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[o.jsx("circle",{cx:"12",cy:"12",r:"10"}),o.jsx("path",{d:"M12 16v-4M12 8h.01"})]}),"About This Workout"]}),o.jsx("p",{children:P.overview})]}),P.tips&&P.tips.length>0&&o.jsxs("div",{className:"mg-overview-section",children:[o.jsxs("h3",{children:[o.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:o.jsx("path",{d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 1 1 7.072 0l-.548.547A3.374 3.374 0 0 0 14 18.469V19a2 2 0 1 1-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),"Tips & Form"]}),o.jsx("ul",{className:"mg-overview-tips",children:P.tips.map((X,ye)=>o.jsx("li",{children:X},ye))})]}),o.jsxs("div",{className:"mg-overview-section",children:[o.jsxs("h3",{children:[o.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[o.jsx("path",{d:"M9 5H7a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-2"}),o.jsx("rect",{x:"9",y:"3",width:"6",height:"4",rx:"1"}),o.jsx("path",{d:"M9 14l2 2 4-4"})]}),"Exercises (",P.exercises.length,")"]}),o.jsx("div",{className:"mg-overview-exercises",children:P.exercises.map((X,ye)=>o.jsxs("div",{className:"mg-overview-exercise",children:[o.jsx("span",{className:"mg-overview-ex-num",children:ye+1}),o.jsxs("div",{className:"mg-overview-ex-info",children:[o.jsx("span",{className:"mg-overview-ex-name",children:X.name}),P.interval?o.jsxs("span",{className:"mg-overview-ex-detail",children:[P.work,"s work / ",P.rest,"s rest"]}):o.jsxs("span",{className:"mg-overview-ex-detail",children:[X.sets," sets  ",X.reps?`${X.reps} reps`:`${X.time}s`,X.type==="weighted"&&"  weighted"]})]})]},ye))})]}),o.jsxs("button",{className:"mg-overview-start-btn",onClick:()=>la(P),children:[o.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"currentColor",children:o.jsx("path",{d:"M8 5v14l11-7z"})}),"Start Workout"]})]}),dt]})}if(E==="muscle_workout"){const P=Je;if(!P)return null;const Y=P.exercises[vt],X=Xt[vt];if(!Y||!X)return null;const ye=X.sets.length,je=P.exercises.length,Oe=P.exercises.reduce((Qe,Zt)=>Qe+(Zt.sets||0),0),pt=Xt.reduce((Qe,Zt)=>Qe+Zt.sets.length,0)/Oe*100,Et=zn[Y.name];Y.type==="timed"&&Fe===0&&!$e&&ye===js&&setTimeout(()=>sn(Y.time),0);const Pt=ye+1<Y.sets?"Log Set":vt+1<je?"Log Set  Next Exercise":"Log Set  Complete";return o.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":h,children:[o.jsx("div",{className:"mg-session-progress",children:o.jsx("div",{className:"mg-session-progress-fill",style:{width:`${pt}%`}})}),o.jsx("header",{className:"client-header",children:o.jsxs("div",{className:"header-content",children:[o.jsx("button",{className:"header-back-btn",onClick:()=>{confirm("End workout early?")&&T("muscle_overview")},"aria-label":"Go back",children:o.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:o.jsx("path",{d:"M15 18l-6-6 6-6"})})}),o.jsxs("span",{className:"mg-header-info",children:["Exercise ",vt+1,"/",je]}),o.jsx("div",{style:{width:22}})]})}),o.jsxs("main",{className:"wk-main",children:[Et?o.jsxs("div",{className:"mg-video-container",onClick:Ir,children:[Et.isGif?o.jsx("img",{className:"mg-video",src:Et.url,alt:Y.name}):o.jsx("video",{ref:Yt,className:"mg-video",src:Et.url,loop:!0,muted:!0,playsInline:!0},Y.name),!on&&!Et.isGif&&o.jsxs("div",{className:"mg-video-overlay",children:[o.jsx("svg",{className:"mg-play-icon",width:"48",height:"48",viewBox:"0 0 24 24",fill:"rgba(255,255,255,0.9)",children:o.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})}),o.jsx("span",{className:"mg-video-hint",children:"Tap for demo"})]})]}):o.jsxs("div",{className:"mg-video-placeholder",children:[o.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",opacity:"0.4",children:[o.jsx("rect",{x:"2",y:"2",width:"20",height:"20",rx:"2.18",ry:"2.18"}),o.jsx("line",{x1:"7",y1:"2",x2:"7",y2:"22"}),o.jsx("line",{x1:"17",y1:"2",x2:"17",y2:"22"}),o.jsx("line",{x1:"2",y1:"12",x2:"22",y2:"12"}),o.jsx("line",{x1:"2",y1:"7",x2:"7",y2:"7"}),o.jsx("line",{x1:"2",y1:"17",x2:"7",y2:"17"}),o.jsx("line",{x1:"17",y1:"7",x2:"22",y2:"7"}),o.jsx("line",{x1:"17",y1:"17",x2:"22",y2:"17"})]}),o.jsx("span",{children:"Video coming soon"})]}),o.jsx("div",{className:"wk-spotify",children:o.jsx("iframe",{src:"https://open.spotify.com/embed/playlist/37i9dQZF1DZ06evO3FJyYF?utm_source=generator&theme=0",width:"100%",height:"80",frameBorder:"0",allow:"autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture",loading:"lazy",title:"Spotify Playlist"})}),o.jsxs("div",{className:"mg-exercise-card",children:[o.jsx("h2",{className:"mg-ex-name",children:Y.name}),o.jsx("span",{className:`mg-ex-type-badge ${Y.type}`,children:Y.type==="weighted"?"Weight + Reps":Y.type==="reps"?"Reps Only":"Timed"}),o.jsxs("div",{className:"mg-ex-set-info",children:[o.jsxs("span",{className:"mg-ex-set-num",children:["Set ",ye+1," of ",Y.sets]}),Y.type!=="timed"&&o.jsxs("span",{className:"mg-ex-target",children:["Target: ",Y.reps," reps"]}),Y.type==="timed"&&o.jsxs("span",{className:"mg-ex-target",children:["Target: ",Y.time,"s"]})]}),Y.type==="weighted"&&o.jsxs("div",{className:"mg-input-area",children:[o.jsxs("div",{className:"mg-input-group",children:[o.jsx("label",{children:"Weight (kg)"}),o.jsx("input",{type:"number",inputMode:"decimal",className:"mg-input",value:Ne,onChange:Qe=>xt(Qe.target.value),placeholder:"0"})]}),o.jsxs("div",{className:"mg-input-group",children:[o.jsx("label",{children:"Reps"}),o.jsx("input",{type:"number",inputMode:"numeric",className:"mg-input",value:bt,onChange:Qe=>it(Qe.target.value),placeholder:"0"})]})]}),Y.type==="reps"&&o.jsx("div",{className:"mg-input-area",children:o.jsxs("div",{className:"mg-input-group mg-input-single",children:[o.jsx("label",{children:"Reps"}),o.jsx("input",{type:"number",inputMode:"numeric",className:"mg-input",value:bt,onChange:Qe=>it(Qe.target.value),placeholder:"0"})]})}),Y.type==="timed"&&o.jsxs("div",{className:"mg-timer-area",children:[o.jsx("div",{className:"mg-timer-display",children:o.jsxs("span",{className:"mg-timer-value",children:[Fe,"s"]})}),$e?o.jsx("button",{className:"mg-timer-btn mg-timer-stop",onClick:()=>st(!1),children:"Stop"}):o.jsx("button",{className:"mg-timer-btn",onClick:()=>{Fe===0&&sn(Y.time),st(!0)},children:Fe<Y.time&&Fe>0?"Resume":"Start Timer"})]}),o.jsx("button",{className:"mg-log-set-btn",onClick:j,children:Pt}),X.sets.length>0&&o.jsx("div",{className:"mg-completed-sets",children:X.sets.map((Qe,Zt)=>o.jsxs("div",{className:"mg-completed-set",children:[o.jsx("span",{className:"mg-completed-set-check",children:""}),o.jsxs("span",{children:["Set ",Zt+1,": ",Qe.weight!=null?`${Qe.weight}kg  ${Qe.reps}`:Qe.reps!=null?`${Qe.reps} reps`:`${Qe.time}s`]})]},Zt))})]})]}),dt,jn&&(()=>{const Qe=Xt.reduce((Tt,Hn)=>Tt+Hn.sets.length,0),Zt=Vc.find(Tt=>Tt.key===yt)?.label||"",Us=[{value:Xt.length,label:"Exercises"},{value:Qe,label:"Sets"}];return o.jsx(_g,{title:`${Zt} Complete!`,subtitle:Je?.name,stats:Us,hideShare:!p,onShareJourney:t?Rt:null,userName:t?.name,onDismissStart:()=>T("randomiser_hub"),onDone:()=>{Un(!1),At(null),Vt(null)}})})()]})}return null}const R6=[{key:"trained",label:"Trained",icon:"M4 10v4M8 7v10M8 12h8M16 7v10M20 10v4",color:"#A12F3A",darkColor:"#E8475A"},{key:"protein",label:"Hit Protein",icon:"M12 22c5.52 0 10-4.48 10-10S17.52 2 12 2 2 6.48 2 12s4.48 10 10 10zM12 18c3.31 0 6-2.69 6-6s-2.69-6-6-6-6 2.69-6 6 2.69 6 6 6zM12 14a2 2 0 1 0 0-4 2 2 0 0 0 0 4z",color:"#4caf50",darkColor:"#5CDB61"},{key:"steps",label:"10k Steps",icon:"M4 19.5A2.5 2.5 0 0 1 6.5 17H20M4 12.5A2.5 2.5 0 0 1 6.5 10H20M4 5.5A2.5 2.5 0 0 1 6.5 3H20",color:"#ff9800",darkColor:"#FFB020"},{key:"sleep",label:"8hrs Sleep",icon:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z",color:"#7c3aed",darkColor:"#9B5AF2"},{key:"water",label:"2L Water",icon:"M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z",color:"#2196f3",darkColor:"#42A5F5"}],I6="M12 2l2.4 7.2L22 12l-7.6 2.8L12 22l-2.4-7.2L2 12l7.6-2.8z",D6="#e91e63",M6="#FF4D88",L6=700,wg=42,wl=2*Math.PI*wg,rd=["Every day counts. See you tomorrow!","Consistency is your superpower.","Perfect day  keep the streak alive!","You showed up for yourself today."];function O6(s){const e=new Date(s),t=e.getDay(),i=t===0?-6:1-t;return e.setDate(e.getDate()+i),e.setHours(0,0,0,0),e}function xo(s){return s.toISOString().split("T")[0]}function P6(s){return Array.from({length:7},(e,t)=>{const i=new Date(s);return i.setDate(s.getDate()+t),i})}function V6(){const{currentUser:s,isClient:e,clientData:t,loading:i}=Ci(),{isDark:l,toggleTheme:u,accent:h}=zo(),{isPremium:p,FREE_HABIT_LIMIT:g}=Ru(),y=Sr(),[b,E]=w.useState({}),[T,O]=w.useState([]),[H,q]=w.useState(!0),[B,te]=w.useState(!1),[W,ee]=w.useState(0),[pe,Te]=w.useState(null),[ve,A]=w.useState(null),[S,I]=w.useState(!1),[V,D]=w.useState(!1),[M,N]=w.useState(!1),[Ue,Ze]=w.useState(!1),[Z,we]=w.useState(""),[Ie,Be]=w.useState(null),[re,L]=w.useState([]),[ie,_e]=w.useState(null),ke=w.useRef(null),Ee=w.useRef(null),xe=w.useRef(null),Ke=w.useRef(null),ct=w.useRef(!1),Pe=w.useRef({}),tn=w.useRef([]),jn=w.useRef([]),Un=w.useRef(null),Lt=w.useRef(rd[Math.floor(Math.random()*rd.length)]),rt=w.useCallback((oe,Ae="info")=>{Te({message:oe,type:Ae}),setTimeout(()=>Te(null),3e3)},[]),gt=new Date,ut=xo(gt),Bn=O6(gt),ue=P6(Bn),Rt=["M","T","W","T","F","S","S"],yt=(oe,Ae)=>l&&Ae?Ae:oe,Vt=[...R6.filter(oe=>!re.includes(oe.key)).map(oe=>({...oe,color:yt(oe.color,oe.darkColor)})),...T.map(oe=>({key:`custom_${oe.id}`,label:oe.label,icon:I6,color:yt(D6,M6),isCustom:!0,id:oe.id}))],Je=p?Vt:Vt.slice(0,g);w.useEffect(()=>{!i&&(!s||!e)&&y("/")},[s,e,i,y]),w.useEffect(()=>{if(!s||!t)return;(async()=>{try{const Ae=Mt(Se,"habitLogs"),Ge=In(Ae,fn("clientId","==",t.id)),mt=await En(Ge),lt={};mt.docs.forEach(vn=>{const Cs=vn.data();lt[Cs.date]={...Cs,_id:vn.id}}),E(lt);const yn=await dr(nt(Se,"customHabits",t.id));if(yn.exists()){const vn=yn.data();O(vn.habits||[]),L(vn.hiddenDefaults||[])}let Nn=0;const dn=new Date(gt);for(;;){const vn=xo(dn),Cs=lt[vn];if(Cs)if(Object.values(Cs.habits||{}).filter(Boolean).length>=3)Nn++,dn.setDate(dn.getDate()-1);else break;else if(vn===ut)dn.setDate(dn.getDate()-1);else break}ee(Nn)}catch(Ae){console.error("Error loading habit logs:",Ae)}finally{q(!1)}})()},[s,t]);const At=b[ut]||{habits:{}};w.useEffect(()=>{Object.values(At.habits||{}).filter(Boolean).length<Je.length&&M&&N(!1)},[Je.length,At.habits]);const vt=async oe=>{if(!(!s||B||At.habits?.[oe])){tn.current=[...Array(10)].map((Ge,mt)=>{const lt=mt/10*2*Math.PI,yn=18+Math.random()*20;return{tx:Math.cos(lt)*yn,ty:Math.sin(lt)*yn,size:3+Math.random()*4,duration:.4+Math.random()*.3}}),A(oe),setTimeout(()=>A(null),700),navigator.vibrate&&navigator.vibrate(50),te(!0);try{const mt={...At.habits||{},[oe]:!0},lt=At._id||`${t.id}_${ut}`;E(Nn=>({...Nn,[ut]:{clientId:t.id,date:ut,habits:mt,_id:lt}})),await Os(nt(Se,"habitLogs",lt),{clientId:t.id,date:ut,habits:mt}),Object.values(mt).filter(Boolean).length===Je.length&&!M&&(Lt.current=rd[Math.floor(Math.random()*rd.length)],jn.current=[...Array(80)].map((Nn,dn)=>({x:5+Math.random()*90,delay:Math.random()*3.5,color:["#A12F3A","#4caf50","#ff9800","#2196f3","#e91e63","#ffeb3b","#FFD700","#ffffff","#9c27b0"][dn%9],drift:(Math.random()-.5)*120,spin:Math.random()*720-360,duration:1.8+Math.random()*2,width:4+Math.random()*6,height:4+Math.random()*8,shape:dn%3})),setTimeout(()=>{I(!0),N(!0),setTimeout(()=>Un.current?.focus(),1100)},400))}catch(Ge){console.error("Error saving habit:",Ge),rt("Failed to save. Try again.","error"),E(mt=>({...mt,[ut]:{...mt[ut],habits:{...mt[ut]?.habits||{},[oe]:!1}}}))}finally{te(!1)}}},nn=async oe=>{if(!(!s||B)){te(!0);try{const Ge={...At.habits||{},[oe]:!1},mt=At._id||`${t.id}_${ut}`;await Os(nt(Se,"habitLogs",mt),{clientId:t.id,date:ut,habits:Ge}),E(lt=>({...lt,[ut]:{clientId:t.id,date:ut,habits:Ge,_id:mt}}))}catch(Ae){console.error("Error undoing habit:",Ae),rt("Failed to undo. Try again.","error")}finally{te(!1)}}},js=oe=>{if(At.habits?.[oe]||!1||B||Ke.current)return;Ke.current=oe,_e(oe),Ee.current=performance.now();const Ge=Pe.current[oe];Ge&&(Ge.style.strokeDashoffset=wl);const mt=lt=>{const yn=lt-Ee.current,Nn=Math.min(yn/L6,1),dn=Pe.current[oe];dn&&(dn.style.strokeDashoffset=wl-Nn*wl),Nn<1?xe.current=requestAnimationFrame(mt):(Ke.current=null,ct.current=!0,xe.current=null,_e(null),vt(oe))};xe.current=requestAnimationFrame(mt)},rs=()=>{if(!Ke.current)return;const oe=Ke.current;Ke.current=null,xe.current&&(cancelAnimationFrame(xe.current),xe.current=null),ke.current&&(clearTimeout(ke.current),ke.current=null),Pe.current[oe]&&(Pe.current[oe].style.strokeDashoffset=wl),_e(null),Ee.current=null};w.useEffect(()=>()=>{xe.current&&cancelAnimationFrame(xe.current),ke.current&&clearTimeout(ke.current)},[]);const Xt=w.useCallback(async oe=>{if(!t)throw new Error("Not signed in");const Ae=oe&&typeof oe=="object"&&oe.type;await ti(Mt(Se,"posts"),{authorId:t.id,authorName:t.name||"Unknown",authorPhotoURL:t.photoURL||null,content:Ae?"":oe,type:Ae?oe.type:"text",imageURL:null,createdAt:hr(),likeCount:0,commentCount:0,...Ae?{metadata:{title:oe.title||"",subtitle:oe.subtitle||"",stats:oe.stats||[],quote:oe.quote||"",badges:oe.badges||[]}}:{}})},[t]),ne=async()=>{const oe=Z.trim();if(!oe)return;if(!t?.id){rt("Still loading, try again","error");return}const Ae=Date.now().toString(36),Ge=[...T,{id:Ae,label:oe}];try{await Os(nt(Se,"customHabits",t.id),{clientId:t.id,habits:Ge,hiddenDefaults:re},{merge:!0}),O(Ge),we(""),Ze(!1),rt(`Added "${oe}"`,"success")}catch(mt){console.error("Error adding custom habit:",mt),rt(mt?.code==="permission-denied"?"Permission denied  check Firestore rules for customHabits":`Failed to add habit: ${mt?.message||"Unknown error"}`,"error")}},Ne=async oe=>{if(!t?.id)return;const Ae=T.filter(Ge=>Ge.id!==oe);try{await Os(nt(Se,"customHabits",t.id),{clientId:t.id,habits:Ae,hiddenDefaults:re},{merge:!0}),O(Ae),Be(null),rt("Habit removed","success")}catch(Ge){console.error("Error deleting habit:",Ge),rt("Failed to remove","error")}},xt=async oe=>{if(!t?.id)return;const Ae=[...re,oe];try{await Os(nt(Se,"customHabits",t.id),{clientId:t.id,habits:T,hiddenDefaults:Ae},{merge:!0}),L(Ae),Be(null),rt("Habit removed","success")}catch(Ge){console.error("Error hiding default habit:",Ge),rt("Failed to remove","error")}},bt=ue.map(oe=>{const Ae=xo(oe),Ge=b[Ae],mt=Ge?Object.values(Ge.habits||{}).filter(Boolean).length:0;return{date:oe,dateStr:Ae,completed:mt,total:Je.length}}),it=bt.reduce((oe,Ae)=>oe+Ae.completed,0),$e=bt.reduce((oe,Ae)=>oe+Ae.total,0),st=$e>0?Math.round(it/$e*100):0,Fe=Object.values(At.habits||{}).filter(Boolean).length,sn=Je.length>0?Math.round(Fe/Je.length*100):0,on=Fe===Je.length&&Je.length>0,Mn=(()=>{const oe=Object.keys(b).sort();let Ae=0,Ge=0,mt=null;for(const lt of oe){const yn=b[lt];if(Object.values(yn.habits||{}).filter(Boolean).length>=3){if(mt){const dn=new Date(mt);Ge=(new Date(lt)-dn)/(1e3*60*60*24)===1?Ge+1:1}else Ge=1;Ge>Ae&&(Ae=Ge),mt=lt}else Ge=0,mt=null}return Math.max(Ae,W)})(),zn=new Date(gt.getFullYear(),gt.getMonth(),1),Xn=zn.toLocaleString("default",{month:"long"}),Yt=new Date(gt.getFullYear(),gt.getMonth()+1,0).getDate(),Fn=(zn.getDay()+6)%7,Cn=Array.from({length:Yt},(oe,Ae)=>{const Ge=new Date(gt.getFullYear(),gt.getMonth(),Ae+1),mt=xo(Ge),lt=b[mt],yn=lt?Object.values(lt.habits||{}).filter(Boolean).length:0,Nn=Ge>gt;return{day:Ae+1,dateStr:mt,completed:yn,total:Je.length,isFuture:Nn,isToday:mt===ut}}),ln=Je.map(oe=>({...oe,days:ue.map(Ae=>{const Ge=xo(Ae);return b[Ge]?.habits?.[oe.key]||!1})})),fr=bt.filter(oe=>oe.completed===oe.total&&oe.total>0).length;return o.jsx(Fo,{children:o.jsxs("div",{className:"cbc-page","data-theme":l?"dark":"light","data-accent":h,children:[o.jsx("header",{className:"client-header",children:o.jsxs("div",{className:"header-content",children:[o.jsx("button",{className:"header-back-btn",onClick:()=>y("/client/core-buddy"),"aria-label":"Go back",children:o.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:o.jsx("path",{d:"M15 18l-6-6 6-6"})})}),o.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),o.jsx("div",{className:"header-actions",children:o.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?o.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("circle",{cx:"12",cy:"12",r:"5"}),o.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):o.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),i||H?o.jsx("div",{className:"cbc-loading-inline",children:o.jsx("div",{className:"cbc-loading-spinner"})}):o.jsxs("main",{className:"cbc-main",children:[o.jsxs("div",{className:"cbc-hero anim-fade-up",children:[o.jsxs("div",{className:`cbc-progress-ring${on?" cbc-ring-complete":""}`,children:[o.jsxs("svg",{viewBox:"0 0 200 200",children:[o.jsx("circle",{className:"cbc-arc-track",cx:"100",cy:"100",r:"80"}),o.jsx("circle",{className:"cbc-arc-fill",cx:"100",cy:"100",r:"80",strokeDasharray:2*Math.PI*80,strokeDashoffset:2*Math.PI*80-sn/100*2*Math.PI*80})]}),o.jsxs("div",{className:"cbc-ring-center",children:[o.jsxs("span",{className:"cbc-ring-count",children:[Fe,o.jsx("span",{className:"cbc-ring-divider",children:"/"}),Je.length]}),o.jsx("span",{className:"cbc-ring-label",children:on?"complete":"today"})]})]}),o.jsx("p",{className:"cbc-hero-tagline",children:on?"You showed up for yourself today.":Fe===0?"Start your day strong.":`${Je.length-Fe} to go  keep pushing.`})]}),o.jsxs("div",{className:"cbc-streak-card anim-fade-up-d1",children:[o.jsx("div",{className:"cbc-streak-icon",children:o.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:o.jsx("path",{d:"M13 2L3 14h9l-1 8 10-12h-9l1-8z"})})}),o.jsxs("div",{className:"cbc-streak-info",children:[o.jsx("span",{className:"cbc-streak-count",children:W}),o.jsx("span",{className:"cbc-streak-label",children:"day streak"})]}),o.jsxs("div",{className:"cbc-streak-best",children:[o.jsx("span",{className:"cbc-streak-best-val",children:Mn}),o.jsx("span",{className:"cbc-streak-best-label",children:"best"})]})]}),o.jsxs("div",{className:"cbc-section anim-fade-up-d2",children:[o.jsx("h2",{className:"cbc-section-title",children:"Today's Habits"}),o.jsxs("div",{className:"cbc-habits-grid",children:[Je.map(oe=>{const Ae=At.habits?.[oe.key]||!1,Ge=ve===oe.key,mt=ie===oe.key;return o.jsxs("div",{className:`cbc-habit-tile ${Ae?"cbc-habit-done":""} ${Ge?"cbc-habit-just-checked":""}`,style:{"--habit-color":oe.color},children:[p&&o.jsx("button",{className:"cbc-habit-delete",onClick:lt=>{lt.stopPropagation(),Be(oe.isCustom?{type:"custom",id:oe.id,label:oe.label}:{type:"default",key:oe.key,label:oe.label})},"aria-label":`Remove ${oe.label}`,children:o.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:[o.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),o.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})}),o.jsxs("div",{className:`cbc-habit-ring-touch ${mt?"cbc-holding":""} ${Ae?"cbc-ring-completed":""}`,onPointerDown:lt=>{Ae||(lt.preventDefault(),js(oe.key))},onPointerUp:rs,onPointerLeave:rs,onPointerCancel:rs,onClick:lt=>{if(lt.stopPropagation(),ct.current){ct.current=!1;return}Ae&&nn(oe.key)},role:"button",tabIndex:0,"aria-label":Ae?`Undo ${oe.label}`:`Press and hold to complete ${oe.label}`,onKeyDown:lt=>{(lt.key==="Enter"||lt.key===" ")&&(lt.preventDefault(),Ae?nn(oe.key):vt(oe.key))},children:[o.jsxs("svg",{className:"cbc-habit-ring-svg",viewBox:"0 0 100 100",children:[o.jsx("circle",{className:"cbc-habit-ring-track",cx:"50",cy:"50",r:wg}),o.jsx("circle",{className:"cbc-habit-ring-fill",ref:lt=>{lt&&(Pe.current[oe.key]=lt)},cx:"50",cy:"50",r:wg,style:{stroke:oe.color,strokeDasharray:wl,strokeDashoffset:Ae?0:wl}})]}),Ae&&o.jsx("div",{className:"cbc-habit-glow-orb",style:{"--habit-color":oe.color}}),o.jsx("div",{className:"cbc-habit-ring-icon",style:{color:oe.color},children:o.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:oe.icon})})}),Ge&&o.jsx("div",{className:"cbc-particles",children:tn.current.map((lt,yn)=>o.jsx("span",{className:"cbc-particle",style:{"--tx":`${lt.tx}px`,"--ty":`${lt.ty}px`,"--size":`${lt.size}px`,"--particle-color":oe.color,animationDuration:`${lt.duration}s`}},yn))})]}),o.jsx("span",{className:"cbc-habit-label",children:oe.label}),Ae?o.jsx("span",{className:"cbc-habit-done-tag",children:"Done"}):o.jsx("span",{className:"cbc-habit-hold-hint",children:"Hold to complete"})]},oe.key)}),p?o.jsxs("div",{className:"cbc-habit-tile cbc-add-tile",onClick:()=>Ze(!0),role:"button",tabIndex:0,children:[o.jsx("div",{className:"cbc-add-ring",children:o.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),o.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})}),o.jsx("span",{className:"cbc-habit-label",children:"Add Habit"}),o.jsx("span",{className:"cbc-habit-hold-hint",children:"Your own"})]}):o.jsxs("div",{className:"cbc-habit-tile cbc-unlock-tile",onClick:()=>y("/upgrade"),role:"button",tabIndex:0,children:[o.jsx("div",{className:"cbc-unlock-ring",children:o.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[o.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),o.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]})}),o.jsx("span",{className:"cbc-habit-label",children:"More Habits"}),o.jsx("span",{className:"cbc-habit-hold-hint",children:"Custom & editable"})]})]})]}),o.jsxs("div",{className:"cbc-section anim-fade-up-d3",children:[o.jsxs("div",{className:"cbc-section-header",children:[o.jsx("h2",{className:"cbc-section-title",children:"This Week"}),o.jsxs("span",{className:"cbc-section-badge",children:[fr,"/7 perfect"]})]}),o.jsxs("div",{className:"cbc-weekly-card",children:[o.jsxs("div",{className:"cbc-weekly-header",children:[o.jsx("span",{className:"cbc-weekly-habit-name"}),Rt.map((oe,Ae)=>o.jsx("span",{className:`cbc-weekly-day-label${ue[Ae]&&xo(ue[Ae])===ut?" cbc-today-label":""}`,children:oe},Ae))]}),ln.map(oe=>(oe.days.filter(Boolean).length,o.jsxs("div",{className:"cbc-weekly-row",children:[o.jsx("span",{className:"cbc-weekly-habit-name",style:{color:oe.color},children:oe.label}),oe.days.map((Ae,Ge)=>o.jsx("span",{className:`cbc-weekly-dot${Ae?" cbc-dot-done":""}${ue[Ge]&&xo(ue[Ge])===ut?" cbc-dot-today":""}`,style:Ae?{background:oe.color,borderColor:oe.color,boxShadow:`0 0 6px ${oe.color}40`}:void 0},Ge))]},oe.key))),o.jsxs("div",{className:"cbc-week-summary",children:[o.jsx("div",{className:"cbc-week-summary-bar",children:o.jsx("div",{className:"cbc-week-summary-fill",style:{width:`${st}%`}})}),o.jsxs("span",{className:"cbc-week-summary-text",children:[it,"/",$e," completed (",st,"%)"]})]})]})]}),o.jsxs("div",{className:"cbc-section anim-fade-up-d4",children:[o.jsx("h2",{className:"cbc-section-title",children:Xn}),o.jsxs("div",{className:"cbc-calendar-card",children:[o.jsx("div",{className:"cbc-cal-header",children:["M","T","W","T","F","S","S"].map((oe,Ae)=>o.jsx("span",{className:"cbc-cal-day-label",children:oe},Ae))}),o.jsxs("div",{className:"cbc-cal-grid",children:[Array.from({length:Fn},(oe,Ae)=>o.jsx("span",{className:"cbc-cal-cell cbc-cal-empty"},`e${Ae}`)),Cn.map(oe=>{const Ae=oe.total>0?oe.completed/oe.total:0,Ge=oe.isFuture?-1:Ae===0?0:Ae<.4?1:Ae<.75?2:Ae<1?3:4;return o.jsx("span",{className:`cbc-cal-cell${oe.isToday?" cbc-cal-today":""}${Ge===4?" cbc-cal-perfect":""} cbc-cal-heat-${Ge<0?"future":Ge}`,children:oe.day},oe.day)})]}),o.jsxs("div",{className:"cbc-cal-legend",children:[o.jsx("span",{className:"cbc-cal-legend-label",children:"Less"}),o.jsx("span",{className:"cbc-cal-legend-swatch cbc-cal-heat-0"}),o.jsx("span",{className:"cbc-cal-legend-swatch cbc-cal-heat-1"}),o.jsx("span",{className:"cbc-cal-legend-swatch cbc-cal-heat-2"}),o.jsx("span",{className:"cbc-cal-legend-swatch cbc-cal-heat-3"}),o.jsx("span",{className:"cbc-cal-legend-swatch cbc-cal-heat-4"}),o.jsx("span",{className:"cbc-cal-legend-label",children:"More"})]})]})]})]}),o.jsx(sa,{active:"home"}),Ue&&o.jsx("div",{className:"cbc-modal-overlay",onClick:()=>Ze(!1),children:o.jsxs("div",{className:"cbc-modal",onClick:oe=>oe.stopPropagation(),children:[o.jsx("h3",{className:"cbc-modal-title",children:"Add Habit"}),o.jsx("p",{className:"cbc-modal-desc",children:"Track something personal to your routine."}),o.jsx("input",{className:"cbc-modal-input",type:"text",placeholder:"e.g. Meditate, Stretch, Read...",value:Z,onChange:oe=>we(oe.target.value),maxLength:30,autoFocus:!0,onKeyDown:oe=>oe.key==="Enter"&&ne()}),o.jsxs("div",{className:"cbc-modal-actions",children:[o.jsx("button",{className:"cbc-modal-cancel",onClick:()=>{Ze(!1),we("")},children:"Cancel"}),o.jsx("button",{className:"cbc-modal-save",onClick:ne,disabled:!Z.trim(),children:"Add"})]})]})}),Ie&&o.jsx("div",{className:"cbc-modal-overlay",onClick:()=>Be(null),children:o.jsxs("div",{className:"cbc-modal",onClick:oe=>oe.stopPropagation(),children:[o.jsxs("h3",{className:"cbc-modal-title",children:['Remove "',Ie.label,'"?']}),o.jsx("p",{className:"cbc-modal-desc",children:"This will remove the habit from your daily tracker. Past logs won't be affected."}),o.jsxs("div",{className:"cbc-modal-actions",children:[o.jsx("button",{className:"cbc-modal-cancel",onClick:()=>Be(null),children:"Keep"}),o.jsx("button",{className:"cbc-modal-delete",onClick:()=>Ie.type==="custom"?Ne(Ie.id):xt(Ie.key),children:"Remove"})]})]})}),S&&o.jsx(_g,{title:"All Habits Complete!",subtitle:Lt.current,stats:[{value:`${Fe}/${Je.length}`,label:"Habits"},{value:W||1,label:"Day Streak"}],buttonLabel:"Keep Going",holdLabel:"Hold To Complete Today's Habits",shareType:"habits",hideShare:!p,onShareJourney:t?Xt:null,userName:t?.name,onDone:()=>{I(!1),D(!1)}}),pe&&o.jsx("div",{className:`toast-notification ${pe.type}`,children:pe.message})]})})}function id(s){if(!s)return"?";const e=s.trim().split(/\s+/);return e.length===1?e[0][0].toUpperCase():(e[0][0]+e[e.length-1][0]).toUpperCase()}function y_(s,e){return[s,e].sort().join("_")}function U6(){const{currentUser:s,isClient:e,clientData:t,loading:i}=Ci(),{isDark:l,toggleTheme:u}=zo(),h=Sr(),[p,g]=w.useState("buddies"),[y,b]=w.useState([]),[E,T]=w.useState([]),[O,H]=w.useState([]),[q,B]=w.useState(""),[te,W]=w.useState([]),[ee,pe]=w.useState([]),[Te,ve]=w.useState(!0),[A,S]=w.useState(null),[I,V]=w.useState(null),D=w.useCallback((re,L="info")=>{V({message:re,type:L}),setTimeout(()=>V(null),3500)},[]);w.useEffect(()=>{!i&&(!s||!e)&&h("/")},[s,e,i,h]);const M=w.useCallback(async()=>{if(t){ve(!0);try{const re=t.id,ie=(await En(Mt(Se,"clients"))).docs.map(Pe=>({id:Pe.id,...Pe.data()}));pe(ie);const _e=Object.fromEntries(ie.map(Pe=>[Pe.id,Pe])),ke=await En(In(Mt(Se,"buddies"),fn("user1","==",re))),Ee=await En(In(Mt(Se,"buddies"),fn("user2","==",re))),xe=new Set;[...ke.docs,...Ee.docs].forEach(Pe=>{const tn=Pe.data(),jn=tn.user1===re?tn.user2:tn.user1;xe.add(jn)}),b(Array.from(xe).map(Pe=>_e[Pe]).filter(Boolean));const Ke=await En(In(Mt(Se,"buddyRequests"),fn("toId","==",re),fn("status","==","pending")));T(Ke.docs.map(Pe=>({reqId:Pe.id,...Pe.data(),fromClient:_e[Pe.data().fromId]})).filter(Pe=>Pe.fromClient));const ct=await En(In(Mt(Se,"buddyRequests"),fn("fromId","==",re),fn("status","==","pending")));H(ct.docs.map(Pe=>({reqId:Pe.id,...Pe.data(),toClient:_e[Pe.data().toId]})).filter(Pe=>Pe.toClient))}catch(re){console.error("Error fetching buddy data:",re),D("Failed to load buddies","error")}finally{ve(!1)}}},[t,D]);w.useEffect(()=>{M()},[M]),w.useEffect(()=>{if(!q.trim()||!t){W([]);return}const re=q.toLowerCase(),L=t.id,ie=new Set(y.map(xe=>xe.id)),_e=new Set(O.map(xe=>xe.toId)),ke=new Set(E.map(xe=>xe.fromId)),Ee=ee.filter(xe=>xe.id===L||!xe.name||!xe.coreBuddyAccess&&xe.clientType!=="core_buddy"?!1:xe.name.toLowerCase().includes(re)).map(xe=>({...xe,isBuddy:ie.has(xe.id),isPendingOut:_e.has(xe.id),isPendingIn:ke.has(xe.id)})).slice(0,20);W(Ee)},[q,ee,y,O,E,t]);const N=async(re,L)=>{if(!(!t||re===t.id))try{await ti(Mt(Se,"notifications"),{toId:re,fromId:t.id,fromName:t.name||"Someone",fromPhotoURL:t.photoURL||null,type:L,read:!1,createdAt:hr()})}catch(ie){console.error("Notification error:",ie),ie.code==="permission-denied"&&D("Notifications blocked  check Firestore rules","error")}},Ue=async re=>{S(re);try{const L=`${t.id}_${re}`;await Os(nt(Se,"buddyRequests",L),{fromId:t.id,toId:re,status:"pending",createdAt:hr()}),await N(re,"buddy_request"),D("Buddy request sent!","success"),await M()}catch(L){console.error("Error sending request:",L),D("Failed to send request","error")}finally{S(null)}},Ze=async re=>{S(re.reqId);try{const L=y_(re.fromId,t.id);await Os(nt(Se,"buddies",L),{user1:[re.fromId,t.id].sort()[0],user2:[re.fromId,t.id].sort()[1],connectedAt:hr()}),await Er(nt(Se,"buddyRequests",re.reqId)),await N(re.fromId,"buddy_accept"),D("Buddy added!","success"),await M()}catch(L){console.error("Error accepting request:",L),D("Failed to accept","error")}finally{S(null)}},Z=async re=>{S(re.reqId);try{await Er(nt(Se,"buddyRequests",re.reqId)),D("Request declined","info"),await M()}catch(L){console.error("Error declining:",L),D("Failed to decline","error")}finally{S(null)}},we=async re=>{S(re.reqId);try{await Er(nt(Se,"buddyRequests",re.reqId)),D("Request cancelled","info"),await M()}catch(L){console.error("Error cancelling:",L),D("Failed to cancel","error")}finally{S(null)}},Ie=async re=>{S(re);try{const L=y_(t.id,re);await Er(nt(Se,"buddies",L)),D("Buddy removed","info"),await M()}catch(L){console.error("Error removing buddy:",L),D("Failed to remove buddy","error")}finally{S(null)}},Be=E.length;return i?o.jsx("div",{className:"bdy-loading",children:o.jsx("div",{className:"bdy-spinner"})}):!s||!e||!t?null:o.jsx(Fo,{children:o.jsxs("div",{className:"bdy-page","data-theme":l?"dark":"light",children:[o.jsx("header",{className:"client-header",children:o.jsxs("div",{className:"header-content",children:[o.jsx("button",{className:"header-back-btn",onClick:()=>h("/client/core-buddy"),"aria-label":"Go back",children:o.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:o.jsx("path",{d:"M15 18l-6-6 6-6"})})}),o.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),o.jsx("div",{className:"header-actions",children:o.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?o.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("circle",{cx:"12",cy:"12",r:"5"}),o.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):o.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),o.jsxs("main",{className:"bdy-main",children:[o.jsx("h1",{className:"bdy-title",children:"Buddies"}),o.jsxs("button",{className:"bdy-leaderboard-link",onClick:()=>h("/client/leaderboard"),children:[o.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[o.jsx("path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5C7 4 7 7 7 7"}),o.jsx("path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5C17 4 17 7 17 7"}),o.jsx("rect",{x:"6",y:"9",width:"12",height:"13",rx:"2"}),o.jsx("path",{d:"M12 9v13"}),o.jsx("path",{d:"M2 22h20"})]}),o.jsx("span",{children:"Leaderboard"}),o.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:o.jsx("path",{d:"M9 18l6-6-6-6"})})]}),o.jsxs("div",{className:"bdy-tabs",children:[o.jsxs("button",{className:`bdy-tab${p==="buddies"?" active":""}`,onClick:()=>g("buddies"),children:[o.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[o.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),o.jsx("circle",{cx:"9",cy:"7",r:"4"}),o.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),o.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),o.jsx("span",{children:"My Buddies"})]}),o.jsxs("button",{className:`bdy-tab${p==="requests"?" active":""}`,onClick:()=>g("requests"),children:[o.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[o.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),o.jsx("circle",{cx:"9",cy:"7",r:"4"}),o.jsx("line",{x1:"19",y1:"8",x2:"19",y2:"14"}),o.jsx("line",{x1:"22",y1:"11",x2:"16",y2:"11"})]}),o.jsx("span",{children:"Requests"}),Be>0&&o.jsx("span",{className:"bdy-tab-badge",children:Be})]}),o.jsxs("button",{className:`bdy-tab${p==="search"?" active":""}`,onClick:()=>g("search"),children:[o.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[o.jsx("circle",{cx:"11",cy:"11",r:"8"}),o.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),o.jsx("span",{children:"Find"})]})]}),Te?o.jsx("div",{className:"bdy-content-loading",children:o.jsx("div",{className:"bdy-spinner"})}):o.jsxs(o.Fragment,{children:[p==="buddies"&&o.jsx("div",{className:"bdy-section",children:y.length===0?o.jsxs("div",{className:"bdy-empty",children:[o.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[o.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),o.jsx("circle",{cx:"9",cy:"7",r:"4"}),o.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),o.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),o.jsx("h3",{children:"No buddies yet"}),o.jsx("p",{children:"Find members and send buddy requests to connect!"}),o.jsx("button",{className:"bdy-empty-btn",onClick:()=>g("search"),children:"Find Buddies"})]}):o.jsx("div",{className:"bdy-list",children:y.map(re=>o.jsxs("div",{className:"bdy-card",onClick:()=>h(`/client/core-buddy/profile/${re.id}`),children:[o.jsx("div",{className:"bdy-avatar",children:re.photoURL?o.jsx("img",{src:re.photoURL,alt:re.name}):o.jsx("span",{children:id(re.name)})}),o.jsx("div",{className:"bdy-card-info",children:o.jsx("span",{className:"bdy-card-name",children:re.name})}),o.jsx("button",{className:"bdy-remove-btn",onClick:L=>{L.stopPropagation(),Ie(re.id)},disabled:A===re.id,"aria-label":"Remove buddy",children:A===re.id?o.jsx("div",{className:"bdy-btn-spinner"}):o.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),o.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]},re.id))})}),p==="requests"&&o.jsxs("div",{className:"bdy-section",children:[E.length>0&&o.jsxs(o.Fragment,{children:[o.jsx("h3",{className:"bdy-section-title",children:"Incoming"}),o.jsx("div",{className:"bdy-list",children:E.map(re=>o.jsxs("div",{className:"bdy-card",children:[o.jsx("div",{className:"bdy-avatar",children:re.fromClient.photoURL?o.jsx("img",{src:re.fromClient.photoURL,alt:re.fromClient.name}):o.jsx("span",{children:id(re.fromClient.name)})}),o.jsxs("div",{className:"bdy-card-info",children:[o.jsx("span",{className:"bdy-card-name",children:re.fromClient.name}),o.jsx("span",{className:"bdy-card-sub",children:"wants to be your buddy"})]}),o.jsxs("div",{className:"bdy-action-pair",children:[o.jsx("button",{className:"bdy-accept-btn",onClick:()=>Ze(re),disabled:A===re.reqId,children:A===re.reqId?o.jsx("div",{className:"bdy-btn-spinner"}):o.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:o.jsx("path",{d:"M5 13l4 4L19 7"})})}),o.jsx("button",{className:"bdy-decline-btn",onClick:()=>Z(re),disabled:A===re.reqId,children:o.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),o.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]})]},re.reqId))})]}),O.length>0&&o.jsxs(o.Fragment,{children:[o.jsx("h3",{className:"bdy-section-title",children:"Sent"}),o.jsx("div",{className:"bdy-list",children:O.map(re=>o.jsxs("div",{className:"bdy-card",children:[o.jsx("div",{className:"bdy-avatar",children:re.toClient?.photoURL?o.jsx("img",{src:re.toClient.photoURL,alt:re.toClient.name}):o.jsx("span",{children:id(re.toClient?.name)})}),o.jsxs("div",{className:"bdy-card-info",children:[o.jsx("span",{className:"bdy-card-name",children:re.toClient?.name}),o.jsx("span",{className:"bdy-card-sub",children:"pending"})]}),o.jsx("button",{className:"bdy-cancel-btn",onClick:()=>we(re),disabled:A===re.reqId,children:A===re.reqId?o.jsx("div",{className:"bdy-btn-spinner"}):"Cancel"})]},re.reqId))})]}),E.length===0&&O.length===0&&o.jsxs("div",{className:"bdy-empty",children:[o.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[o.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),o.jsx("path",{d:"M22 4L12 14.01l-3-3"})]}),o.jsx("h3",{children:"No pending requests"}),o.jsx("p",{children:"All caught up!"})]})]}),p==="search"&&o.jsxs("div",{className:"bdy-section",children:[o.jsxs("div",{className:"bdy-search-bar",children:[o.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[o.jsx("circle",{cx:"11",cy:"11",r:"8"}),o.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),o.jsx("input",{type:"text",placeholder:"Search by name...",value:q,onChange:re=>B(re.target.value),autoFocus:!0}),q&&o.jsx("button",{className:"bdy-search-clear",onClick:()=>B(""),children:o.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),o.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),q.trim()&&te.length===0&&o.jsx("div",{className:"bdy-empty bdy-empty-sm",children:o.jsxs("p",{children:['No members found for "',q,'"']})}),te.length>0&&o.jsx("div",{className:"bdy-list",children:te.map(re=>o.jsxs("div",{className:"bdy-card",onClick:()=>h(`/client/core-buddy/profile/${re.id}`),children:[o.jsx("div",{className:"bdy-avatar",children:re.photoURL?o.jsx("img",{src:re.photoURL,alt:re.name}):o.jsx("span",{children:id(re.name)})}),o.jsxs("div",{className:"bdy-card-info",children:[o.jsx("span",{className:"bdy-card-name",children:re.name}),re.isBuddy&&o.jsx("span",{className:"bdy-card-badge",children:"Buddy"})]}),re.isBuddy?o.jsx("span",{className:"bdy-status-icon",children:o.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"var(--color-success)",strokeWidth:"2.5",children:o.jsx("path",{d:"M5 13l4 4L19 7"})})}):re.isPendingOut?o.jsx("span",{className:"bdy-pending-label",children:"Pending"}):re.isPendingIn?o.jsx("button",{className:"bdy-accept-btn",onClick:L=>{L.stopPropagation();const ie=E.find(_e=>_e.fromId===re.id);ie&&Ze(ie)},disabled:!!A,children:o.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:o.jsx("path",{d:"M5 13l4 4L19 7"})})}):o.jsx("button",{className:"bdy-add-btn",onClick:L=>{L.stopPropagation(),Ue(re.id)},disabled:A===re.id,children:A===re.id?o.jsx("div",{className:"bdy-btn-spinner"}):o.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),o.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})})]},re.id))})]})]})]}),o.jsx(sa,{}),I&&o.jsxs("div",{className:`toast-notification ${I.type}`,children:[o.jsx("span",{className:"toast-icon",children:I.type==="success"?o.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:o.jsx("path",{d:"M5 13 L9 17 L19 7"})}):I.type==="error"?o.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[o.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),o.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]}):o.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:[o.jsx("circle",{cx:"12",cy:"12",r:"10"}),o.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),o.jsx("circle",{cx:"12",cy:"16",r:"1",fill:"currentColor"})]})}),o.jsx("span",{className:"toast-message",children:I.message})]})]})})}function ad(s){if(!s)return"?";const e=s.trim().split(/\s+/);return e.length===1?e[0][0].toUpperCase():(e[0][0]+e[e.length-1][0]).toUpperCase()}function Bp(s,e){return[s,e].sort().join("_")}const B6=5;function zp(s){return s.toISOString().split("T")[0]}function v_(s){if(!s)return"";const e=s instanceof Date?s:s.toDate?s.toDate():new Date(s),t=Math.floor((new Date-e)/1e3);return t<60?"just now":t<3600?`${Math.floor(t/60)}m ago`:t<86400?`${Math.floor(t/3600)}h ago`:t<604800?`${Math.floor(t/86400)}d ago`:e.toLocaleDateString("en-GB",{day:"numeric",month:"short"})}function z6(){const{userId:s}=eS(),{currentUser:e,isClient:t,clientData:i,loading:l}=Ci(),{isDark:u,toggleTheme:h}=zo(),p=Sr(),[g,y]=w.useState(null),[b,E]=w.useState("none"),[T,O]=w.useState(null),[H,q]=w.useState(!0),[B,te]=w.useState(!1),[W,ee]=w.useState(null),[pe,Te]=w.useState([]),[ve,A]=w.useState(!1),[S,I]=w.useState(new Set),[V,D]=w.useState(new Set),[M,N]=w.useState({}),[Ue,Ze]=w.useState({}),[Z,we]=w.useState({}),[Ie,Be]=w.useState(!0),[re,L]=w.useState(0),[ie,_e]=w.useState(0),[ke,Ee]=w.useState(0),[xe,Ke]=w.useState([]),[ct,Pe]=w.useState(!1),[tn,jn]=w.useState(null),[Un,Lt]=w.useState([]),rt=w.useCallback((ne,Ne="info")=>{ee({message:ne,type:Ne}),setTimeout(()=>ee(null),3500)},[]);w.useEffect(()=>{!l&&(!e||!t)&&p("/")},[e,t,l,p]),w.useEffect(()=>{i&&s&&i.id===s&&p("/client/core-buddy",{replace:!0})},[i,s,p]),w.useEffect(()=>{if(!i||!s||i.id===s)return;let ne=!1;return(async()=>{q(!0);try{const bt=(await En(Mt(Se,"clients"))).docs.map(Fe=>({id:Fe.id,...Fe.data()})).find(Fe=>Fe.id===s);if(!bt){ne||q(!1);return}ne||y(bt);const it=i.id,$e=Bp(it,s);if((await dr(nt(Se,"buddies",$e))).exists())ne||E("buddy");else{const Fe=`${it}_${s}`,sn=await dr(nt(Se,"buddyRequests",Fe));if(sn.exists()&&sn.data().status==="pending")ne||(E("pending_out"),O(Fe));else{const on=`${s}_${it}`,Mn=await dr(nt(Se,"buddyRequests",on));Mn.exists()&&Mn.data().status==="pending"?ne||(E("pending_in"),O(on)):ne||E("none")}}}catch(Ne){console.error("Error loading profile:",Ne)}finally{ne||q(!1)}})(),()=>{ne=!0}},[i,s]),w.useEffect(()=>{if(!s||!g)return;let ne=!1;return(async()=>{Be(!0);try{const Ne=await En(In(Mt(Se,"workoutLogs"),fn("clientId","==",s)));if(ne)return;const xt=Ne.docs.length;L(xt);let bt=0;const it=Ne.docs.map(st=>st.data().date).filter(Boolean).sort().reverse();if(it.length>0){const st=new Date;let Fe=new Date(st);for(let sn=0;sn<52;sn++){const on=new Date(Fe),Mn=on.getDay(),zn=Mn===0?6:Mn-1;on.setDate(on.getDate()-zn),on.setHours(0,0,0,0);const Xn=new Date(on);Xn.setDate(Xn.getDate()+7);const Yt=zp(on),Fn=zp(Xn);if(it.some(ln=>ln>=Yt&&ln<Fn))bt++;else{if(sn>0)break;break}Fe.setDate(Fe.getDate()-7)}}ne||_e(bt);let $e=0;for(let st=0;st<30;st++){const Fe=new Date;Fe.setDate(Fe.getDate()-st);const sn=zp(Fe);try{const on=await En(In(Mt(Se,"habitLogs"),fn("clientId","==",s),fn("date","==",sn)));if(on.empty)break;{const Mn=on.docs[0].data().habits||{};if(Object.values(Mn).filter(Boolean).length>=B6)$e++;else break}}catch{break}}ne||Ee($e)}catch(Ne){console.error("Error loading buddy stats:",Ne)}finally{ne||Be(!1)}})(),()=>{ne=!0}},[s,g]),w.useEffect(()=>{if(!i)return;const ne=i.id;(async()=>{try{const[Ne,xt,bt]=await Promise.all([En(In(Mt(Se,"buddies"),fn("user1","==",ne))),En(In(Mt(Se,"buddies"),fn("user2","==",ne))),En(Mt(Se,"clients"))]),it=new Set;[...Ne.docs,...xt.docs].forEach(st=>{const Fe=st.data();it.add(Fe.user1===ne?Fe.user2:Fe.user1)});const $e={};bt.docs.forEach(st=>{$e[st.id]=st.data()}),Ke(Array.from(it).filter(st=>$e[st]).map(st=>({id:st,name:$e[st].name,photoURL:$e[st].photoURL||null})))}catch(Ne){console.error("Error loading buddies for mentions:",Ne)}})()},[i]);const gt=async(ne,Ne,xt={})=>{if(!(!i||ne===i.id))try{await ti(Mt(Se,"notifications"),{toId:ne,fromId:i.id,fromName:i.name||"Someone",fromPhotoURL:i.photoURL||null,type:Ne,read:!1,createdAt:hr(),...xt})}catch(bt){console.error("Notification error:",bt),bt.code==="permission-denied"&&rt("Notifications blocked  check Firestore rules","error")}},ut=async()=>{te(!0);try{const ne=`${i.id}_${s}`;await Os(nt(Se,"buddyRequests",ne),{fromId:i.id,toId:s,status:"pending",createdAt:hr()}),await gt(s,"buddy_request"),E("pending_out"),O(ne),rt("Buddy request sent!","success")}catch(ne){console.error(ne),rt("Failed to send request","error")}finally{te(!1)}},Bn=async()=>{if(T){te(!0);try{const ne=Bp(i.id,s);await Os(nt(Se,"buddies",ne),{user1:[i.id,s].sort()[0],user2:[i.id,s].sort()[1],connectedAt:hr()}),await Er(nt(Se,"buddyRequests",T)),await gt(s,"buddy_accept"),E("buddy"),rt("Buddy added!","success")}catch(ne){console.error(ne),rt("Failed to accept","error")}finally{te(!1)}}},ue=async()=>{if(T){te(!0);try{await Er(nt(Se,"buddyRequests",T)),E("none"),rt(b==="pending_out"?"Request cancelled":"Request declined","info")}catch(ne){console.error(ne),rt("Failed","error")}finally{te(!1)}}},Rt=async()=>{te(!0);try{const ne=Bp(i.id,s);await Er(nt(Se,"buddies",ne)),E("none"),rt("Buddy removed","info")}catch(ne){console.error(ne),rt("Failed to remove","error")}finally{te(!1)}},yt=w.useCallback(async()=>{if(s){A(!0);try{const ne=await En(In(Mt(Se,"posts"),fn("authorId","==",s),hu("createdAt","desc"),du(30)));if(Te(ne.docs.map(Ne=>({id:Ne.id,...Ne.data()}))),i){const Ne=await En(In(Mt(Se,"postLikes"),fn("userId","==",i.id)));I(new Set(Ne.docs.map(xt=>xt.data().postId)))}}catch(ne){console.error("Error loading journey:",ne)}finally{A(!1)}}},[s,i]);w.useEffect(()=>{!H&&g&&yt()},[H,g,yt]);const Vt=async ne=>{if(window.confirm("Delete this post?"))try{await Er(nt(Se,"posts",ne)),Te(Ne=>Ne.filter(xt=>xt.id!==ne)),rt("Post deleted","info")}catch(Ne){console.error("Delete error:",Ne),rt("Failed to delete","error")}},Je=async ne=>{if(!i)return;const Ne=i.id,xt=`${ne}_${Ne}`,bt=S.has(ne),it=new Set(S);bt?it.delete(ne):it.add(ne),I(it),Te($e=>$e.map(st=>st.id===ne?{...st,likeCount:Math.max(0,(st.likeCount||0)+(bt?-1:1))}:st));try{if(bt)await Er(nt(Se,"postLikes",xt)),await Hr(nt(Se,"posts",ne),{likeCount:ko(-1)});else{await Os(nt(Se,"postLikes",xt),{postId:ne,userId:Ne,createdAt:hr()}),await Hr(nt(Se,"posts",ne),{likeCount:ko(1)});const $e=pe.find(st=>st.id===ne);$e&&gt($e.authorId,"like",{postId:ne})}}catch($e){console.error("Like error:",$e),yt()}},At=async ne=>{try{const Ne=await En(In(Mt(Se,"postComments"),fn("postId","==",ne),hu("createdAt","asc"),du(50)));N(xt=>({...xt,[ne]:Ne.docs.map(bt=>({id:bt.id,...bt.data()}))}))}catch(Ne){console.error("Error loading comments:",Ne)}},vt=ne=>{const Ne=new Set(V);Ne.has(ne)?Ne.delete(ne):(Ne.add(ne),M[ne]||At(ne)),D(Ne)},nn=(ne,Ne)=>{const xt=ne.match(/@(\w*)$/);if(xt){Pe(!0),jn(Ne);const bt=xe.filter(it=>it.name&&it.name.toLowerCase().includes(xt[1].toLowerCase())).slice(0,5);Lt(bt)}else Pe(!1),Lt([])},js=(ne,Ne)=>{const bt=(Ue[Ne]||"").replace(/@\w*$/,`@${ne.name} `);Ze(it=>({...it,[Ne]:bt})),Pe(!1),Lt([])},rs=(ne,Ne)=>{Ze(xt=>({...xt,[ne]:Ne})),nn(Ne,ne)},Xt=async ne=>{const Ne=(Ue[ne]||"").trim();if(!(!Ne||!i)){we(xt=>({...xt,[ne]:!0}));try{await ti(Mt(Se,"postComments"),{postId:ne,authorId:i.id,authorName:i.name||"Unknown",authorPhotoURL:i.photoURL||null,content:Ne,createdAt:hr()}),await Hr(nt(Se,"posts",ne),{commentCount:ko(1)});const xt=pe.find(it=>it.id===ne);xt&&gt(xt.authorId,"comment",{postId:ne});const bt=Ne.match(/@[\w\s]+?(?=\s@|\s*$|[.,!?])/g);if(bt){const it=new Set;bt.forEach($e=>{const st=$e.slice(1).trim(),Fe=xe.find(sn=>sn.name&&sn.name.toLowerCase()===st.toLowerCase());Fe&&!it.has(Fe.id)&&(it.add(Fe.id),gt(Fe.id,"mention",{postId:ne}))})}Ze(it=>({...it,[ne]:""})),Te(it=>it.map($e=>$e.id===ne?{...$e,commentCount:($e.commentCount||0)+1}:$e)),await At(ne)}catch(xt){console.error("Comment error:",xt),rt("Failed to comment","error")}finally{we(xt=>({...xt,[ne]:!1}))}}};return l||H||!i?o.jsx("div",{className:"prf-loading","data-theme":u?"dark":"light",children:o.jsx("div",{className:"prf-spinner"})}):!e||!t?null:g?o.jsx(Fo,{children:o.jsxs("div",{className:"prf-page","data-theme":u?"dark":"light",children:[o.jsx("header",{className:"client-header",children:o.jsxs("div",{className:"header-content",children:[o.jsx("button",{className:"header-back-btn",onClick:()=>p(-1),"aria-label":"Go back",children:o.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:o.jsx("path",{d:"M15 18l-6-6 6-6"})})}),o.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),o.jsx("div",{className:"header-actions",children:o.jsx("button",{onClick:h,"aria-label":"Toggle theme",children:u?o.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("circle",{cx:"12",cy:"12",r:"5"}),o.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):o.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),o.jsxs("main",{className:"prf-main",children:[o.jsxs("div",{className:"prf-hero",children:[o.jsx("div",{className:"prf-avatar-lg",children:g.photoURL?o.jsx("img",{src:g.photoURL,alt:g.name}):o.jsx("span",{children:ad(g.name)})}),o.jsx("h1",{className:"prf-name",children:g.name}),o.jsxs("div",{className:"prf-buddy-action",children:[b==="none"&&o.jsx("button",{className:"prf-btn prf-btn-primary",onClick:ut,disabled:B,children:B?o.jsx("div",{className:"prf-btn-spinner"}):o.jsxs(o.Fragment,{children:[o.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),o.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),"Add Buddy"]})}),b==="pending_out"&&o.jsx("button",{className:"prf-btn prf-btn-secondary",onClick:ue,disabled:B,children:B?o.jsx("div",{className:"prf-btn-spinner dark"}):"Cancel Request"}),b==="pending_in"&&o.jsxs("div",{className:"prf-btn-pair",children:[o.jsx("button",{className:"prf-btn prf-btn-success",onClick:Bn,disabled:B,children:B?o.jsx("div",{className:"prf-btn-spinner"}):"Accept"}),o.jsx("button",{className:"prf-btn prf-btn-secondary",onClick:ue,disabled:B,children:"Decline"})]}),b==="buddy"&&o.jsx("button",{className:"prf-btn prf-btn-danger",onClick:Rt,disabled:B,children:B?o.jsx("div",{className:"prf-btn-spinner"}):"Remove Buddy"})]})]}),Ie?o.jsx("div",{className:"prf-stats-loading",children:o.jsx("div",{className:"prf-spinner"})}):o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"prf-stats",children:[o.jsxs("div",{className:"prf-stat",children:[o.jsx("span",{className:"prf-stat-value",children:re}),o.jsx("span",{className:"prf-stat-label",children:"Workouts"})]}),o.jsxs("div",{className:"prf-stat",children:[o.jsxs("span",{className:"prf-stat-value",children:[ie,o.jsx("span",{className:"prf-stat-unit",children:"wk"})]}),o.jsx("span",{className:"prf-stat-label",children:"Streak"})]})]}),ke>0&&o.jsx("div",{className:"prf-info-row",children:o.jsxs("div",{className:"prf-info-card info-habit",children:[o.jsx("div",{className:"prf-info-icon",children:o.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[o.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),o.jsx("path",{d:"M22 4L12 14.01l-3-3"})]})}),o.jsxs("div",{className:"prf-info-text",children:[o.jsxs("span",{className:"prf-info-value",children:[ke," day",ke!==1?"s":""]}),o.jsx("span",{className:"prf-info-sub",children:"Habit Streak"})]})]})})]}),o.jsxs("div",{className:"prf-section",children:[o.jsx("h2",{className:"prf-section-title",children:`${g.name?.split(" ")[0]}'s Journey`}),ve?o.jsx("div",{className:"journey-loading",children:o.jsx("div",{className:"prf-spinner"})}):pe.length===0?o.jsxs("div",{className:"journey-empty",children:[o.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[o.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),o.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),o.jsx("path",{d:"M21 15l-5-5L5 21"})]}),o.jsx("p",{children:"No posts yet"})]}):o.jsx("div",{className:"journey-list",children:pe.map(ne=>o.jsxs("div",{className:"journey-post",children:[o.jsxs("div",{className:"journey-post-header",children:[o.jsx("div",{className:"journey-post-avatar",children:ne.authorPhotoURL?o.jsx("img",{src:ne.authorPhotoURL,alt:""}):o.jsx("span",{children:ad(ne.authorName)})}),o.jsxs("div",{className:"journey-post-meta",children:[o.jsx("span",{className:"journey-post-name",children:ne.authorName}),o.jsx("span",{className:"journey-post-time",children:v_(ne.createdAt)})]}),ne.authorId===i.id&&o.jsx("button",{className:"journey-delete-btn",onClick:()=>Vt(ne.id),"aria-label":"Delete post",children:o.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("path",{d:"M3 6h18"}),o.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),o.jsx("path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]}),ne.type==="workout_summary"&&ne.metadata?o.jsxs("div",{className:"journey-card",children:[o.jsx("div",{className:"journey-card-logo-frame",children:o.jsx("img",{src:"/Logo.webp",alt:"MCF",className:"journey-card-logo-img"})}),o.jsx("h3",{className:"journey-card-title",children:ne.metadata.title}),ne.metadata.stats?.length>0&&o.jsx("p",{className:"journey-card-stats-line",children:ne.metadata.stats.map(Ne=>`${Ne.value} ${Ne.label}`).join("    ")}),!ne.metadata.stats?.length&&ne.metadata.subtitle&&o.jsx("p",{className:"journey-card-stats-line",children:ne.metadata.subtitle}),o.jsx("p",{className:"journey-card-cta",children:"I just completed a workout using Core Buddy "}),o.jsx("p",{className:"journey-card-slogan",children:"Make It Count with Core Buddy"})]}):ne.type==="badge_earned"&&ne.metadata?o.jsxs("div",{className:"journey-card",children:[o.jsx("div",{className:"journey-card-logo-frame journey-card-logo-badge",children:o.jsx("img",{src:"/Logo.webp",alt:ne.metadata.title,className:"journey-card-logo-img"})}),o.jsx("h3",{className:"journey-card-title",children:ne.metadata.title}),ne.metadata.badgeDesc&&o.jsx("p",{className:"journey-card-stats-line",children:ne.metadata.badgeDesc}),o.jsx("p",{className:"journey-card-cta",children:"I just earned a badge on Core Buddy"}),o.jsx("p",{className:"journey-card-slogan",children:"Make It Count with Core Buddy"})]}):ne.type==="habits_summary"&&ne.metadata?o.jsxs("div",{className:"journey-card",children:[o.jsx("div",{className:"journey-card-logo-frame",children:o.jsx("img",{src:"/Logo.webp",alt:"MCF",className:"journey-card-logo-img"})}),o.jsx("h3",{className:"journey-card-title",children:ne.metadata.title}),ne.metadata.stats?.length>0&&o.jsx("p",{className:"journey-card-stats-line",children:ne.metadata.stats.map(Ne=>`${Ne.value} ${Ne.label}`).join("    ")}),ne.metadata.subtitle&&o.jsx("p",{className:"journey-card-stats-line",children:ne.metadata.subtitle}),o.jsx("p",{className:"journey-card-cta",children:"I just completed my daily habits with Core Buddy "}),o.jsx("p",{className:"journey-card-slogan",children:"Make It Count with Core Buddy"})]}):o.jsxs(o.Fragment,{children:[ne.content&&o.jsx("p",{className:"journey-post-content",children:ne.content}),ne.imageURL&&o.jsx("div",{className:"journey-post-image",children:o.jsx("img",{src:ne.imageURL,alt:"Post",loading:"lazy"})})]}),o.jsxs("div",{className:"journey-post-actions",children:[o.jsxs("button",{className:`journey-action-btn${S.has(ne.id)?" liked":""}`,onClick:()=>Je(ne.id),children:[o.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:S.has(ne.id)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})}),o.jsx("span",{children:ne.likeCount||0})]}),o.jsxs("button",{className:`journey-action-btn${V.has(ne.id)?" active":""}`,onClick:()=>vt(ne.id),children:[o.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})}),o.jsx("span",{children:ne.commentCount||0})]})]}),V.has(ne.id)&&o.jsxs("div",{className:"journey-comments",children:[M[ne.id]?.length>0?M[ne.id].map(Ne=>o.jsxs("div",{className:"journey-comment",children:[o.jsx("div",{className:"journey-comment-avatar",onClick:()=>p(`/client/core-buddy/profile/${Ne.authorId}`),children:Ne.authorPhotoURL?o.jsx("img",{src:Ne.authorPhotoURL,alt:""}):o.jsx("span",{children:ad(Ne.authorName)})}),o.jsxs("div",{className:"journey-comment-body",children:[o.jsxs("div",{className:"journey-comment-bubble",children:[o.jsx("span",{className:"journey-comment-name",children:Ne.authorName}),o.jsx("span",{className:"journey-comment-text",children:Ne.content})]}),o.jsx("span",{className:"journey-comment-time",children:v_(Ne.createdAt)})]})]},Ne.id)):o.jsx("p",{className:"journey-no-comments",children:"No comments yet"}),o.jsxs("div",{className:"journey-comment-input",style:{position:"relative"},children:[o.jsx("input",{type:"text",placeholder:"Comment... (@ to mention)",value:Ue[ne.id]||"",onChange:Ne=>rs(ne.id,Ne.target.value),onKeyDown:Ne=>{Ne.key==="Enter"&&Xt(ne.id)},maxLength:300}),ct&&tn===ne.id&&Un.length>0&&o.jsx("div",{className:"mention-dropdown mention-dropdown-up",children:Un.map(Ne=>o.jsxs("button",{className:"mention-option",onClick:()=>js(Ne,ne.id),children:[o.jsx("div",{className:"mention-option-avatar",children:Ne.photoURL?o.jsx("img",{src:Ne.photoURL,alt:""}):o.jsx("span",{children:ad(Ne.name)})}),o.jsx("span",{children:Ne.name})]},Ne.id))}),o.jsx("button",{onClick:()=>Xt(ne.id),disabled:!(Ue[ne.id]||"").trim()||Z[ne.id],children:Z[ne.id]?o.jsx("div",{className:"journey-btn-spinner-sm"}):o.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("line",{x1:"22",y1:"2",x2:"11",y2:"13"}),o.jsx("polygon",{points:"22 2 15 22 11 13 2 9 22 2"})]})})]})]})]},ne.id))})]})]}),o.jsx(sa,{}),W&&o.jsxs("div",{className:`toast-notification ${W.type}`,children:[o.jsx("span",{className:"toast-icon",children:W.type==="success"?o.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:o.jsx("path",{d:"M5 13 L9 17 L19 7"})}):W.type==="error"?o.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[o.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),o.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]}):o.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:[o.jsx("circle",{cx:"12",cy:"12",r:"10"}),o.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),o.jsx("circle",{cx:"12",cy:"16",r:"1",fill:"currentColor"})]})}),o.jsx("span",{className:"toast-message",children:W.message})]})]})}):o.jsxs("div",{className:"prf-page","data-theme":u?"dark":"light",children:[o.jsx("header",{className:"client-header",children:o.jsxs("div",{className:"header-content",children:[o.jsx("button",{className:"header-back-btn",onClick:()=>p(-1),"aria-label":"Go back",children:o.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:o.jsx("path",{d:"M15 18l-6-6 6-6"})})}),o.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),o.jsx("div",{className:"header-actions"})]})}),o.jsx("main",{className:"prf-main",children:o.jsx("p",{style:{textAlign:"center",color:"var(--text-tertiary)",padding:"40px 0"},children:"User not found"})}),o.jsx(sa,{})]})}const Fp=[{text:"Build your dashboard...",bold:"your way"},{text:"Pick what matters to you...",bold:"nothing else"},{text:"Your goals, your layout...",bold:"your rules"}],b_=[{id:"stats",label:"Stats Rings",desc:"Programme %, workouts this week, habits today",icon:"rings",defaultOn:!0},{id:"workouts",label:"Workouts",desc:"Sessions this week and total count",icon:"dumbbell",defaultOn:!0},{id:"habits",label:"Habits",desc:"Daily habit tracker dots",icon:"check",defaultOn:!0},{id:"pbs",label:"Personal Bests",desc:"Your top lifts at a glance",icon:"trophy"},{id:"nutrition",label:"Nutrition",desc:"Macro rings  protein, carbs, fats, cals",icon:"apple"},{id:"leaderboard",label:"Leaderboard",desc:"See where you rank among buddies",icon:"podium"},{id:"journey",label:"Journey",desc:"Your posts, likes and comments feed",icon:"feed"},{id:"coach",label:"Coach Message",desc:"Motivational nudge from Buddy",icon:"message",defaultOn:!0},{id:"nudge",label:"Smart Nudge",desc:"Contextual reminder of what to do next",icon:"lightbulb"}];function F6(s){switch(s){case"rings":return o.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("circle",{cx:"12",cy:"12",r:"10"}),o.jsx("circle",{cx:"12",cy:"12",r:"6"}),o.jsx("circle",{cx:"12",cy:"12",r:"2"})]});case"dumbbell":return o.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("path",{d:"M6.5 6.5h11v11h-11z",strokeLinejoin:"round"}),o.jsx("line",{x1:"2",y1:"12",x2:"6.5",y2:"12"}),o.jsx("line",{x1:"17.5",y1:"12",x2:"22",y2:"12"})]});case"check":return o.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("polyline",{points:"20 6 9 17 4 12"})});case"trophy":return o.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("path",{d:"M6 9H3V6a1 1 0 0 1 1-1h2M18 9h3V6a1 1 0 0 0-1-1h-2"}),o.jsx("path",{d:"M6 5h12v7a6 6 0 0 1-12 0V5z"}),o.jsx("path",{d:"M9 21h6"}),o.jsx("path",{d:"M12 17v4"})]});case"apple":return o.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("path",{d:"M12 3c-1.5 0-3 1-3 1s-3-.5-4.5 1.5S3 9 3 12s1.5 6 3 8 3 3 6 3 4.5-1 6-3 3-5 3-8-1.5-4-3-6.5S13.5 3 12 3z"}),o.jsx("path",{d:"M12 3c0 0 1-2 3-2"})]});case"podium":return o.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("rect",{x:"2",y:"14",width:"6",height:"8",rx:"1"}),o.jsx("rect",{x:"9",y:"8",width:"6",height:"14",rx:"1"}),o.jsx("rect",{x:"16",y:"11",width:"6",height:"11",rx:"1"})]});case"medal":return o.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("circle",{cx:"12",cy:"15",r:"6"}),o.jsx("path",{d:"M8.21 13.89L7 2h10l-1.21 11.89"})]});case"feed":return o.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"3"}),o.jsx("line",{x1:"3",y1:"9",x2:"21",y2:"9"}),o.jsx("line",{x1:"3",y1:"15",x2:"21",y2:"15"})]});case"message":return o.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})});case"lightbulb":return o.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("path",{d:"M9 18h6"}),o.jsx("path",{d:"M10 22h4"}),o.jsx("path",{d:"M12 2a7 7 0 0 0-4 12.7V17h8v-2.3A7 7 0 0 0 12 2z"})]});default:return null}}function q6(){const s=Sr(),{clientData:e,currentUser:t,updateClientData:i,resolveClient:l}=Ci(),[u,h]=w.useState({hours:0,minutes:0,seconds:0}),[p,g]=w.useState(0),[y,b]=w.useState(0),[E,T]=w.useState(null),[O,H]=w.useState(!1),q=w.useRef(null),[B,te]=w.useState(()=>{const M=e?.dashboardWidgets;return M&&Array.isArray(M)?M:b_.filter(N=>N.defaultOn).map(N=>N.id)}),[W,ee]=w.useState(!1),[pe,Te]=w.useState(!1),[ve,A]=w.useState(null);w.useEffect(()=>{e?.photoURL&&T(e.photoURL)},[e?.photoURL]),w.useEffect(()=>{const M=()=>{const Ue=new Date,Ze=new Date(Ue);Ze.setHours(23,59,59,999);const Z=Ze-Ue;h({hours:Math.floor(Z/36e5),minutes:Math.floor(Z%36e5/6e4),seconds:Math.floor(Z%6e4/1e3)}),g(60-Math.floor(Z%6e4/1e3))};M();const N=setInterval(M,1e3);return()=>clearInterval(N)},[]),w.useEffect(()=>{const M=setInterval(()=>b(N=>(N+1)%Fp.length),8e3);return()=>clearInterval(M)},[]);const S=async M=>{const N=M.target.files?.[0];if(!(!N||!e?.id)){H(!0);try{const Ue=Ua(Ba,`profilePhotos/${e.id}`);await bd(Ue,N);const Ze=await No(Ue);await Hr(nt(Se,"clients",e.id),{photoURL:Ze}),T(Ze),i({photoURL:Ze})}catch(Ue){console.error("Photo upload error:",Ue)}finally{H(!1)}}},I=M=>{Te(!1),te(N=>N.includes(M)?N.filter(Ue=>Ue!==M):[...N,M])},V=(M,N)=>{Te(!1),te(Ue=>{const Ze=Ue.indexOf(M);if(Ze<0)return Ue;const Z=Ze+N;if(Z<0||Z>=Ue.length)return Ue;const we=[...Ue];return[we[Ze],we[Z]]=[we[Z],we[Ze]],we})},D=async()=>{ee(!0),A(null);try{const M=e||await l();if(!M?.id){A("Could not find your profile. Try refreshing."),ee(!1);return}await Hr(nt(Se,"clients",M.id),{dashboardWidgets:B}),i({dashboardWidgets:B}),Te(!0)}catch(M){console.error("Save config error:",M),A("Save failed  please try again.")}finally{ee(!1)}};return o.jsx(Fo,{children:o.jsxs("div",{className:"bldr-page",children:[o.jsxs("div",{className:"bldr-container",children:[o.jsxs("div",{className:"bldr-header",children:[o.jsx("button",{className:"bldr-back",onClick:()=>s("/client/core-buddy"),children:o.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M15 18l-6-6 6-6"})})}),o.jsx("h1",{className:"bldr-title",children:"Build Your Dashboard"})]}),o.jsxs("div",{className:"bldr-ring-container",children:[o.jsxs("div",{className:"bldr-ring",children:[o.jsx("svg",{className:"bldr-ring-svg",viewBox:"0 0 200 200",children:NE.map((M,N)=>o.jsx("line",{x1:M.x1,y1:M.y1,x2:M.x2,y2:M.y2,className:`bldr-tick ${N<p?"elapsed":"remaining"}`,strokeWidth:M.thick?"3":"2"},N))}),o.jsxs("div",{className:"bldr-ring-center",children:[o.jsxs("div",{className:"bldr-ring-photo",onClick:()=>q.current?.click(),children:[o.jsx("img",{src:E||"/Logo.webp",alt:E?"Profile":"Mind Core Fitness"}),o.jsx("div",{className:`bldr-photo-overlay${O?" uploading":""}`,children:O?o.jsx("div",{className:"bldr-photo-spinner"}):o.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"#fff",strokeWidth:"2",children:[o.jsx("path",{d:"M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"}),o.jsx("circle",{cx:"12",cy:"13",r:"4"})]})}),o.jsx("input",{ref:q,type:"file",accept:"image/*",onChange:S,style:{display:"none"}})]}),!E&&!O&&o.jsx("div",{className:"bldr-photo-badge",onClick:()=>q.current?.click(),children:o.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"#fff",strokeWidth:"2.5",children:[o.jsx("path",{d:"M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"}),o.jsx("circle",{cx:"12",cy:"13",r:"4"})]})})]})]}),o.jsxs("div",{className:"bldr-countdown",children:[o.jsx("span",{className:"bldr-timer-digit",children:String(u.hours).padStart(2,"0")}),o.jsx("span",{className:"bldr-timer-colon",children:":"}),o.jsx("span",{className:"bldr-timer-digit",children:String(u.minutes).padStart(2,"0")}),o.jsx("span",{className:"bldr-timer-colon",children:":"}),o.jsx("span",{className:"bldr-timer-digit bldr-timer-sec",children:String(u.seconds).padStart(2,"0")})]}),o.jsx("span",{className:"bldr-ring-label",children:"remaining today"}),o.jsxs("p",{className:"bldr-tagline",children:[Fp[y].text," ",o.jsx("strong",{children:Fp[y].bold})]})]}),o.jsxs("div",{className:"bldr-section",children:[o.jsx("h2",{className:"bldr-section-title",children:"Choose Your Widgets"}),o.jsx("p",{className:"bldr-section-desc",children:"The countdown ring and your profile always stay at the top. Pick what goes below."}),o.jsx("div",{className:"bldr-widgets-list",children:b_.map(M=>{const N=B.includes(M.id),Ue=B.indexOf(M.id);return o.jsxs("div",{className:`bldr-widget-card${N?" active":""}`,children:[o.jsx("div",{className:"bldr-widget-icon",children:F6(M.icon)}),o.jsxs("div",{className:"bldr-widget-info",children:[o.jsx("div",{className:"bldr-widget-label",children:M.label}),o.jsx("div",{className:"bldr-widget-desc",children:M.desc})]}),o.jsxs("div",{className:"bldr-widget-actions",children:[N&&o.jsxs("div",{className:"bldr-widget-order",children:[o.jsx("button",{className:"bldr-order-btn",onClick:()=>V(M.id,-1),disabled:Ue===0,"aria-label":"Move up",children:o.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:o.jsx("path",{d:"M18 15l-6-6-6 6"})})}),o.jsx("span",{className:"bldr-order-num",children:Ue+1}),o.jsx("button",{className:"bldr-order-btn",onClick:()=>V(M.id,1),disabled:Ue===B.length-1,"aria-label":"Move down",children:o.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:o.jsx("path",{d:"M6 9l6 6 6-6"})})})]}),o.jsx("button",{className:`bldr-toggle${N?" on":""}`,onClick:()=>I(M.id),"aria-label":N?`Remove ${M.label}`:`Add ${M.label}`,children:o.jsx("div",{className:"bldr-toggle-thumb"})})]})]},M.id)})})]}),o.jsxs("div",{className:"bldr-save-wrap",children:[o.jsx("button",{className:`bldr-save-btn${pe?" saved":""}`,onClick:D,disabled:W||pe,children:W?"Saving...":pe?"Saved":"Save Dashboard"}),ve&&o.jsx("p",{className:"bldr-save-error",children:ve}),pe&&o.jsx("button",{className:"bldr-view-btn",onClick:()=>s("/client/core-buddy"),children:"View Dashboard"})]})]}),o.jsx(sa,{active:"home"})]})})}const H6=w.lazy(()=>Gs(()=>import("./Dashboard-BkwHwkOp.js"),__vite__mapDeps([0,1,2]))),$6=w.lazy(()=>Gs(()=>import("./AddClient-DuqSTIqd.js"),__vite__mapDeps([3,4]))),W6=w.lazy(()=>Gs(()=>import("./ClientDashboard-CE-glWgz.js"),__vite__mapDeps([5,1,6]))),G6=w.lazy(()=>Gs(()=>import("./ClientForms-B4ZE4vmn.js"),__vite__mapDeps([7,8,6]))),K6=w.lazy(()=>Gs(()=>import("./ClientTools-BOytcvR0.js"),__vite__mapDeps([9,10,6]))),Y6=w.lazy(()=>Gs(()=>import("./MacroCalculator-BBDR7pK7.js"),__vite__mapDeps([11,10,6]))),Q6=w.lazy(()=>Gs(()=>import("./ProteinSnacks-DIFd1OZb.js"),__vite__mapDeps([12,10,6]))),X6=w.lazy(()=>Gs(()=>import("./DailyMotivation-B3rbXfBR.js"),__vite__mapDeps([13,10,6]))),J6=w.lazy(()=>Gs(()=>import("./CircuitDashboard-SG6h_NTU.js"),__vite__mapDeps([14,15]))),Z6=w.lazy(()=>Gs(()=>import("./CircuitBooking-DsrGTivU.js"),__vite__mapDeps([16,17,15]))),e3=w.lazy(()=>Gs(()=>import("./PersonalBests-CkcVqzQ_.js"),__vite__mapDeps([18,19,6]))),t3=w.lazy(()=>Gs(()=>import("./Leaderboard-DcsdUS-3.js"),__vite__mapDeps([20,21]))),n3=w.lazy(()=>Gs(()=>import("./UpgradePage-5mXRd2be.js"),__vite__mapDeps([22,23,24]))),s3=w.lazy(()=>Gs(()=>import("./SignUp-ByWY6HII.js"),[])),r3=w.lazy(()=>Gs(()=>import("./Onboarding-DwVNTHWn.js"),__vite__mapDeps([25,23,26])));function i3({children:s}){const{pathname:e}=Si();return w.useEffect(()=>{"scrollRestoration"in window.history&&(window.history.scrollRestoration="manual")},[]),w.useEffect(()=>{window.scrollTo({top:0,left:0,behavior:"instant"})},[e]),s}function a3(){const s=Sr();return w.useEffect(()=>{const e=sessionStorage.getItem("redirect");if(e){sessionStorage.removeItem("redirect");const t=e.replace("/login","")||"/";s(t,{replace:!0})}},[s]),null}function o3(){return o.jsx(RM,{children:o.jsx(AM,{children:o.jsx(OM,{children:o.jsxs(BS,{basename:"/login",children:[o.jsx(a3,{}),o.jsx(i3,{children:o.jsx(w.Suspense,{fallback:o.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",minHeight:"60vh"},children:o.jsx("div",{style:{width:36,height:36,border:"3px solid var(--color-primary-light)",borderTopColor:"var(--color-primary)",borderRadius:"50%",animation:"app-spin .7s linear infinite"}})}),children:o.jsxs(pS,{children:[o.jsx(Vn,{path:"/",element:o.jsx(UM,{})}),o.jsx(Vn,{path:"/dashboard",element:o.jsx(H6,{})}),o.jsx(Vn,{path:"/add-client",element:o.jsx($6,{})}),o.jsx(Vn,{path:"/client",element:o.jsx(W6,{})}),o.jsx(Vn,{path:"/client/forms",element:o.jsx(G6,{})}),o.jsx(Vn,{path:"/client/tools",element:o.jsx(K6,{})}),o.jsx(Vn,{path:"/client/tools/macros",element:o.jsx(Y6,{})}),o.jsx(Vn,{path:"/client/tools/snacks",element:o.jsx(Q6,{})}),o.jsx(Vn,{path:"/client/tools/motivation",element:o.jsx(X6,{})}),o.jsx(Vn,{path:"/client/personal-bests",element:o.jsx(e3,{})}),o.jsx(Vn,{path:"/client/circuit",element:o.jsx(J6,{})}),o.jsx(Vn,{path:"/client/circuit/booking",element:o.jsx(Z6,{})}),o.jsx(Vn,{path:"/client/core-buddy",element:o.jsx($M,{})}),o.jsx(Vn,{path:"/client/core-buddy/nutrition",element:o.jsx(nd,{feature:"nutrition",children:o.jsx(KM,{})})}),o.jsx(Vn,{path:"/client/core-buddy/workouts",element:o.jsx(A6,{})}),o.jsx(Vn,{path:"/client/core-buddy/consistency",element:o.jsx(nd,{feature:"consistency",children:o.jsx(V6,{})})}),o.jsx(Vn,{path:"/client/core-buddy/buddies",element:o.jsx(nd,{feature:"buddies",children:o.jsx(U6,{})})}),o.jsx(Vn,{path:"/client/core-buddy/builder",element:o.jsx(q6,{})}),o.jsx(Vn,{path:"/client/core-buddy/profile/:userId",element:o.jsx(z6,{})}),o.jsx(Vn,{path:"/client/leaderboard",element:o.jsx(nd,{feature:"leaderboard",children:o.jsx(t3,{})})}),o.jsx(Vn,{path:"/signup",element:o.jsx(s3,{})}),o.jsx(Vn,{path:"/onboarding",element:o.jsx(r3,{})}),o.jsx(Vn,{path:"/upgrade",element:o.jsx(n3,{})}),o.jsx(Vn,{path:"*",element:o.jsx(D_,{to:"/",replace:!0})})]})})})]})})})})}pk.createRoot(document.getElementById("root")).render(o.jsx(w.StrictMode,{children:o.jsx(o3,{})}));"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/login/sw.js").then(s=>{setInterval(()=>s.update(),3600*1e3)}).catch(s=>console.warn("SW registration failed:",s))});export{c3 as A,hr as B,sa as C,Fo as P,Gt as T,ti as a,Er as b,Mt as c,Se as d,nt as e,RN as f,En as g,ON as h,Os as i,o as j,dr as k,Ci as l,zo as m,Sr as n,hu as o,NE as p,In as q,w as r,h3 as s,l3 as t,Hr as u,d3 as v,fn as w,Ru as x,VM as y,PM as z};
