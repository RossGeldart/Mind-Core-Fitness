import{r as h,k as Lt,l as Rt,m as Wt,q as Ue,c as qe,d as A,w as Xe,g as Je,j as e,n as At,p as de,e as z,T as H,b as Ft,t as Pt,v as Dt,C as It,i as Mt}from"./index-DCT0kasD.js";/* empty css                        */const ce=[{key:"pressUps",name:"Press-Ups",category:"Upper Body",unit:"reps"},{key:"squats",name:"Squats",category:"Lower Body",unit:"reps"},{key:"longJump",name:"Standing Long Jump",category:"Power",unit:"distance"},{key:"deadHang",name:"Dead Hang",category:"Upper Body",unit:"time"},{key:"plank",name:"Plank",category:"Core",unit:"time"},{key:"wallSit",name:"Wall Sit",category:"Lower Body",unit:"time"},{key:"chestPress",name:"Chest Press",category:"Upper Body",unit:"weight"}],Pe=[{key:"weight",name:"Weight",suffix:"kg"},{key:"chest",name:"Chest",suffix:"cm"},{key:"waist",name:"Waist",suffix:"cm"},{key:"hips",name:"Hips",suffix:"cm"},{key:"leftArm",name:"Left Arm",suffix:"cm"},{key:"rightArm",name:"Right Arm",suffix:"cm"},{key:"leftThigh",name:"Left Thigh",suffix:"cm"},{key:"rightThigh",name:"Right Thigh",suffix:"cm"}];function Ot(){const p=new Date;return`${p.getFullYear()}-${String(p.getMonth()+1).padStart(2,"0")}`}function le(p){const[m,g]=p.split("-");return new Date(parseInt(m),parseInt(g)-1).toLocaleDateString("en-GB",{month:"long",year:"numeric"})}function zt(p){if(!p&&p!==0)return"-";const m=Math.floor(p/60),g=(p%60).toFixed(2);return m>0?`${m}m ${parseFloat(g).toFixed(0)}s`:`${parseFloat(g).toFixed(2)}s`}function Ht(p,m){return!p&&p!==0?"-":!m&&m!==0?`${p}kg`:`${p}kg x ${m}`}function bt(p,m){if(!m)return"-";switch(p.unit){case"weight":return Ht(m.weight,m.reps);case"time":return zt(m.time);case"reps":return m.reps?`${m.reps} reps`:"-";case"distance":return m.distance?`${m.distance} cm`:"-";default:return"-"}}function Ye(p,m){if(!m)return 0;switch(p.unit){case"weight":return(m.weight||0)*(m.reps||0);case"time":return m.time||0;case"reps":return m.reps||0;case"distance":return m.distance||0;default:return 0}}function $t(p,m){return!m||m===0?null:(p-m)/m*100}function _t({data:p,exerciseKey:m,unit:g}){if(!p||p.length<2)return e.jsx("div",{className:"pb-trend-empty",children:e.jsx("p",{children:"Not enough data for trend line yet"})});const _=p.map(k=>{const x=k.benchmarks?.[m];if(!x)return 0;switch(g){case"weight":return(x.weight||0)*(x.reps||0);case"time":return x.time||0;case"reps":return x.reps||0;case"distance":return x.distance||0;default:return 0}}),$e=Math.max(..._),he=Math.min(..._),T=$e-he||1,w=300,$=100,D=20,ae=w-D*2,P=$-D*2,I=_.map((k,x)=>{const G=D+x/(_.length-1)*ae,J=D+P-(k-he)/T*P;return{x:G,y:J,value:k}}),Y=I.map((k,x)=>`${x===0?"M":"L"} ${k.x} ${k.y}`).join(" "),ge=Y+` L ${I[I.length-1].x} ${D+P} L ${I[0].x} ${D+P} Z`;return e.jsxs("div",{className:"pb-trend-chart",children:[e.jsxs("svg",{viewBox:`0 0 ${w} ${$}`,preserveAspectRatio:"xMidYMid meet",children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"trendGradientJr",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"0%",stopColor:"var(--color-primary)",stopOpacity:"0.3"}),e.jsx("stop",{offset:"100%",stopColor:"var(--color-primary)",stopOpacity:"0.02"})]})}),e.jsx("path",{d:ge,fill:"url(#trendGradientJr)"}),e.jsx("path",{d:Y,fill:"none",stroke:"var(--color-primary)",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round"}),I.map((k,x)=>e.jsx("circle",{cx:k.x,cy:k.y,r:"4",fill:"var(--bg-card)",stroke:"var(--color-primary)",strokeWidth:"2"},x))]}),e.jsx("div",{className:"pb-trend-labels",children:p.map((k,x)=>e.jsxs("span",{className:"pb-trend-label",children:[k.month.split("-")[1],"/",k.month.split("-")[0].slice(2)]},x))})]})}function Yt(){const[p,m]=h.useState("bests"),[g,_]=h.useState([]),[$e,he]=h.useState(!0),[T,w]=h.useState(!1),[$,D]=h.useState(0),[ae,P]=h.useState(!1),[I,Y]=h.useState(!1),[ge,k]=h.useState(!1),[x,G]=h.useState({}),[J,re]=h.useState({}),[F,Be]=h.useState({}),[E,Ve]=h.useState({}),[B,Q]=h.useState({}),[Qe,be]=h.useState(!1),[Se,Z]=h.useState({}),[R,Ze]=h.useState([]),[xe,Le]=h.useState(null),[je,Re]=h.useState(null),[ne,jt]=h.useState(!1),[ve,Ke]=h.useState(""),[ye,et]=h.useState(""),ke=h.useRef(null),ht=h.useRef(0),pe=h.useRef(0),tt=h.useRef("right"),Te=h.useCallback(t=>{D(r=>{const c=Math.max(0,Math.min(ce.length-1,t));return c===r?r:(tt.current=c>r?"right":"left",c)})},[]),{currentUser:st,isClient:ie,clientData:S,loading:We}=Lt(),{isDark:at}=Rt(),fe=Wt(),K=h.useCallback((t,r="info")=>{Re({message:t,type:r}),setTimeout(()=>Re(null),4e3)},[]);h.useEffect(()=>{!We&&(!st||!ie)&&fe("/")},[st,ie,We,fe]),h.useEffect(()=>{S&&Ne()},[S]);const Ne=async()=>{try{const t=Ue(qe(A,"juniorPBs"),Xe("clientId","==",S.id)),c=(await Je(t)).docs.map(u=>({id:u.id,...u.data()}));c.sort((u,y)=>u.month.localeCompare(y.month)),_(c);const o=Ue(qe(A,"juniorPBTargets"),Xe("clientId","==",S.id)),n=await Je(o);if(!n.empty){const u=n.docs[0].data();Be(u.targets||{}),Ve(u.metricTargets||{}),Q(u.targets||{}),Z(u.metricTargets||{})}const j=Ue(qe(A,"juniorAchievements"),Xe("clientId","==",S.id)),L=await Je(j);L.empty||Ze(L.docs[0].data().badges||[])}catch(t){console.error("Error fetching junior personal bests:",t)}he(!1)},q=Ot(),M=g.find(t=>t.month===q),Ae=g.filter(t=>t.month<q),Ie=Ae.length>0?Ae[Ae.length-1]:null;h.useEffect(()=>{M?(G(M.benchmarks||{}),re(M.bodyMetrics||{})):(G({}),re({}))},[M?.id]);const N=async(t,r)=>{const c=[];if(t==="strength"?ce.forEach(o=>{const n=F[o.key];if(!n)return;const j=r[o.key];if(!j)return;let L;if(n.targetType==="time"){if(!n.targetValue)return;const u=n.startValue||0,y=j.time||0,b=n.targetValue-u;L=b===0?y>=n.targetValue?1:0:Math.max(0,(y-u)/b)}else if(n.targetType==="reps"){if(!n.targetReps)return;const u=n.startReps||0,y=j.reps||0,b=n.targetReps-u;L=b===0?y>=n.targetReps?1:0:Math.max(0,(y-u)/b)}else if(n.targetType==="distance"){if(!n.targetDistance)return;const u=n.startDistance||0,y=j.distance||0,b=n.targetDistance-u;L=b===0?y>=n.targetDistance?1:0:Math.max(0,(y-u)/b)}else{if(!n.targetWeight&&!n.targetReps)return;const u=(n.startWeight||0)*(n.startReps||0),y=(n.targetWeight||0)*(n.targetReps||0),b=(j.weight||0)*(j.reps||0),O=y-u;L=O===0?b>=y?1:0:Math.max(0,(b-u)/O)}if(L>=1){let u,y;n.targetType==="time"?(u=R.some(b=>b.type==="strength"&&b.key===o.key&&b.targetValue===n.targetValue),y=`${o.name} ${n.targetValue}s`):n.targetType==="reps"?(u=R.some(b=>b.type==="strength"&&b.key===o.key&&b.targetReps===n.targetReps),y=`${o.name} ${n.targetReps} reps`):n.targetType==="distance"?(u=R.some(b=>b.type==="strength"&&b.key===o.key&&b.targetDistance===n.targetDistance),y=`${o.name} ${n.targetDistance}cm`):(u=R.some(b=>b.type==="strength"&&b.key===o.key&&b.targetWeight===n.targetWeight&&b.targetReps===n.targetReps),y=`${o.name} ${n.targetWeight}kg × ${n.targetReps}`),u||c.push({type:"strength",key:o.key,...n.targetType==="time"?{targetType:"time",targetValue:n.targetValue}:n.targetType==="reps"?{targetType:"reps",targetReps:n.targetReps}:n.targetType==="distance"?{targetType:"distance",targetDistance:n.targetDistance}:{targetWeight:n.targetWeight,targetReps:n.targetReps},achievedMonth:q,label:y})}}):Pe.forEach(o=>{const n=E[o.key];if(!n||!n.targetValue)return;const j=r[o.key];if(j==null)return;const L=n.startValue||0,u=n.targetValue,y=u-L;(y===0?j===u?1:0:Math.max(0,(j-L)/y))>=1&&(R.some(dt=>dt.type==="metric"&&dt.key===o.key&&dt.targetValue===u)||c.push({type:"metric",key:o.key,targetValue:u,achievedMonth:q,label:`${o.name} ${u}${o.suffix}`}))}),c.length>0){const o=[...R,...c];await de(z(A,"juniorAchievements",S.id),{clientId:S.id,badges:o,updatedAt:H.now()}),Ze(o),Le(c),setTimeout(()=>Le(null),5e3)}},Oe=(t,r)=>{if(t==="strength"){const c=F[r];if(!c)return!1;switch(ce.find(n=>n.key===r)?.unit){case"time":return R.some(n=>n.type==="strength"&&n.key===r&&n.targetValue===c.targetValue);case"reps":return R.some(n=>n.type==="strength"&&n.key===r&&n.targetReps===c.targetReps);case"distance":return R.some(n=>n.type==="strength"&&n.key===r&&n.targetDistance===c.targetDistance);default:return!c.targetWeight&&!c.targetReps?!1:R.some(n=>n.type==="strength"&&n.key===r&&n.targetWeight===c.targetWeight&&n.targetReps===c.targetReps)}}else{const c=E[r];return!c||!c.targetValue?!1:R.some(o=>o.type==="metric"&&o.key===r&&o.targetValue===c.targetValue)}},Vt=async()=>{w(!0);try{const t=`${S.id}_${q}`,r=M||{};await de(z(A,"juniorPBs",t),{clientId:S.id,month:q,benchmarks:x,bodyMetrics:r.bodyMetrics||J||{},createdAt:r.createdAt||H.now(),updatedAt:H.now()}),await N("strength",x),K("Benchmarks saved!","success"),P(!1),await Ne()}catch(t){console.error("Error saving benchmarks:",t),K("Failed to save. Please try again.","error")}w(!1)},me=async()=>{w(!0);try{const t=`${S.id}_${q}`,r=M||{};await de(z(A,"juniorPBs",t),{clientId:S.id,month:q,benchmarks:r.benchmarks||x||{},bodyMetrics:J,createdAt:r.createdAt||H.now(),updatedAt:H.now()}),await N("metric",J),K("Body metrics saved!","success"),Y(!1),await Ne()}catch(t){console.error("Error saving metrics:",t),K("Failed to save. Please try again.","error")}w(!1)},Fe=(t,r,c)=>{G(o=>({...o,[t]:{...o[t],[r]:c===""?"":parseFloat(c)}}))},rt=(t,r)=>{re(c=>({...c,[t]:r===""?"":parseFloat(r)}))},te=(t,r,c)=>{Q(o=>({...o,[t]:{...o[t],[r]:c===""?"":parseFloat(c)}}))},U=async()=>{w(!0);try{const t=`targets_${S.id}`,r=M?.benchmarks||{},c={};ce.forEach(o=>{const n=r[o.key];switch(o.unit){case"time":B[o.key]?.targetValue&&(c[o.key]={targetType:"time",targetValue:B[o.key].targetValue,startValue:n?.time||0});break;case"reps":B[o.key]?.targetReps&&(c[o.key]={targetType:"reps",targetReps:B[o.key].targetReps,startReps:n?.reps||0});break;case"distance":B[o.key]?.targetDistance&&(c[o.key]={targetType:"distance",targetDistance:B[o.key].targetDistance,startDistance:n?.distance||0});break;default:(B[o.key]?.targetWeight||B[o.key]?.targetReps)&&(c[o.key]={targetWeight:B[o.key].targetWeight||0,targetReps:B[o.key].targetReps||0,startWeight:n?.weight||0,startReps:n?.reps||0})}}),await de(z(A,"juniorPBTargets",t),{clientId:S.id,targets:c,metricTargets:E,updatedAt:H.now()}),Be(c),Q(c),K("Targets saved!","success"),k(!1)}catch(t){console.error("Error saving targets:",t),K("Failed to save targets.","error")}w(!1)},nt=(t,r)=>{Z(c=>({...c,[t]:{...c[t],targetValue:r===""?"":parseFloat(r)}}))},vt=async()=>{w(!0);try{const t=`targets_${S.id}`,r={};Pe.forEach(c=>{if(Se[c.key]?.targetValue){const o=M?.bodyMetrics?.[c.key]||0;r[c.key]={targetValue:Se[c.key].targetValue,startValue:o}}}),await de(z(A,"juniorPBTargets",t),{clientId:S.id,targets:F,metricTargets:r,updatedAt:H.now()}),Ve(r),Z(r),K("Metric targets saved!","success"),be(!1)}catch(t){console.error("Error saving metric targets:",t),K("Failed to save targets.","error")}w(!1)},pt=async()=>{if(window.confirm("Reset all goals? This will clear all strength and body metric targets. Your recorded benchmarks and measurements will NOT be affected.")){w(!0);try{const t=z(A,"juniorPBTargets",`targets_${S.id}`);await Ft(t),Be({}),Ve({}),Q({}),Z({}),K("All goals have been reset","success")}catch(t){console.error("Error resetting targets:",t),K("Failed to reset goals","error")}w(!1)}},yt=(t,r)=>{const c=F[t];if(!c||!r)return null;if(c.targetType==="time"){if(!c.targetValue)return null;const u=c.startValue||0,y=c.targetValue,b=r.time||0,O=y-u;return O<=0?b>=y?1:0:Math.max(0,Math.min((b-u)/O,1))}if(c.targetType==="reps"){if(!c.targetReps)return null;const u=c.startReps||0,y=c.targetReps,b=r.reps||0,O=y-u;return O<=0?b>=y?1:0:Math.max(0,Math.min((b-u)/O,1))}if(c.targetType==="distance"){if(!c.targetDistance)return null;const u=c.startDistance||0,y=c.targetDistance,b=r.distance||0,O=y-u;return O<=0?b>=y?1:0:Math.max(0,Math.min((b-u)/O,1))}if(!c.targetWeight&&!c.targetReps)return null;const o=(c.startWeight||0)*(c.startReps||0),n=(c.targetWeight||0)*(c.targetReps||0),j=(r.weight||0)*(r.reps||0),L=n-o;return L<=0?j>=n?1:0:Math.max(0,Math.min((j-o)/L,1))},ee=t=>{const r=E[t];if(!r||!r.targetValue)return null;const c=M?.bodyMetrics?.[t];if(c==null)return null;const o=r.startValue||0,n=r.targetValue,j=n-o;return j===0?c===n?1:0:Math.max(0,Math.min((c-o)/j,1))},W=t=>{ht.current=t.touches[0].clientX,pe.current=0},it=t=>{pe.current=t.touches[0].clientX-ht.current},mt=()=>{pe.current<-50?Te($+1):pe.current>50&&Te($-1),pe.current=0},ut=t=>{const r=M?.bodyMetrics?.[t],c=Ie?.bodyMetrics?.[t];return r==null||c==null?null:parseFloat((r-c).toFixed(2))},ze=g.find(t=>t.month===ve),ct=g.find(t=>t.month===ye);if(We||$e)return e.jsxs("div",{className:"pb-page",children:[e.jsx("header",{className:"client-header",children:e.jsx("div",{className:"header-content",children:e.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})})}),e.jsxs("main",{className:"pb-main",children:[e.jsx("div",{className:"skeleton skeleton-title",style:{width:180,height:28,marginBottom:20}}),e.jsx("div",{className:"skeleton skeleton-card-large",style:{height:320,borderRadius:16}})]})]});if(!st||!ie||!S)return null;const X=ce[$],we=M?.benchmarks?.[X.key],kt=Ie?.benchmarks?.[X.key],He=Ye(X,we),ft=Ye(X,kt),Ee=$t(He,ft),_e=yt(X.key,we),gt=_e!==null,lt=_e!==null&&_e>=1,Nt=gt?Math.round(_e*60):He>0?15:0,ot=F[X.key],wt=t=>t?t.targetType==="time"?`${t.startValue||0}s → ${t.targetValue}s`:t.targetType==="reps"?`${t.startReps||0} → ${t.targetReps} reps`:t.targetType==="distance"?`${t.startDistance||0} → ${t.targetDistance}cm`:`${t.startWeight||0}kg×${t.startReps||0} → ${t.targetWeight}kg×${t.targetReps}`:null;return e.jsxs("div",{className:"pb-page",children:[e.jsx("header",{className:"client-header",children:e.jsxs("div",{className:"header-content",children:[e.jsx("button",{className:"header-back-btn",onClick:()=>fe("/client"),"aria-label":"Go back",children:e.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("path",{d:"M15 18l-6-6 6-6"})})}),e.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})]})}),e.jsxs("main",{className:"pb-main page-transition-enter",children:[e.jsxs("div",{className:"pb-intro",children:[e.jsx("h2",{children:"Junior Strength Tests"}),e.jsx("p",{children:"Track your strength test results and body measurements each month."})]}),e.jsxs("div",{className:"pb-tabs",children:[e.jsx("button",{className:`pb-tab ${p==="bests"?"active":""}`,onClick:()=>m("bests"),children:"Strength"}),e.jsx("button",{className:`pb-tab ${p==="metrics"?"active":""}`,onClick:()=>m("metrics"),children:"Body Metrics"}),e.jsx("button",{className:`pb-tab ${p==="history"?"active":""}`,onClick:()=>m("history"),children:"History"})]}),p==="bests"&&e.jsxs("div",{className:"pb-strength-section",children:[!ae&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"pb-carousel",ref:ke,onTouchStart:W,onTouchMove:it,onTouchEnd:mt,children:[e.jsx("div",{className:`pb-ring-container slide-from-${tt.current}`,children:e.jsxs("div",{className:"pb-ring",children:[e.jsx("svg",{className:"pb-ring-svg",viewBox:"0 0 200 200",children:At.map((t,r)=>{const c=r<Math.round(Nt);return e.jsx("line",{x1:t.x1,y1:t.y1,x2:t.x2,y2:t.y2,className:`pb-ring-tick ${c?lt?"hit":"filled":"empty"}`,strokeWidth:t.thick?"3":"2"},r)})}),e.jsxs("div",{className:"pb-ring-center",children:[e.jsx("div",{className:"pb-ring-category",children:X.category}),e.jsxs("div",{className:"pb-ring-exercise",children:[X.name,Oe("strength",X.key)&&e.jsx("svg",{className:"pb-badge-icon",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})]}),e.jsx("div",{className:"pb-ring-value",children:we?bt(X,we):"-"}),Ee!==null&&e.jsxs("div",{className:`pb-ring-change ${Ee>=0?"positive":"negative"}`,children:[Ee>=0?"+":"",Ee.toFixed(1),"%"]}),Ee===null&&we&&e.jsx("div",{className:"pb-ring-change neutral",children:"New entry"}),ot&&e.jsx("div",{className:`pb-ring-target ${lt?"hit":""}`,children:lt?"Target hit!":wt(ot)}),!ot&&e.jsx("div",{className:"pb-ring-target none",children:"No target set"})]})]})},$),e.jsx("div",{className:"pb-carousel-dots",children:ce.map((t,r)=>e.jsx("button",{className:`pb-dot ${r===$?"active":""}`,onClick:()=>Te(r)},r))}),e.jsx("button",{className:"pb-carousel-arrow left",onClick:()=>Te($-1),disabled:$===0,children:e.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"})})}),e.jsx("button",{className:"pb-carousel-arrow right",onClick:()=>Te($+1),disabled:$===ce.length-1,children:e.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M8.59 16.59L10 18l6-6-6-6-1.41 1.41L13.17 12z"})})})]}),e.jsxs("div",{className:"pb-trend-section",children:[e.jsx("h4",{children:"Trend"}),e.jsx(_t,{data:g,exerciseKey:X.key,unit:X.unit})]})]}),!ae&&!ge&&e.jsxs("div",{className:"pb-action-buttons",children:[e.jsx("button",{className:"pb-edit-btn",onClick:()=>P(!0),children:M?.benchmarks?"Edit This Month's Benchmarks":"Add This Month's Benchmarks"}),e.jsx("button",{className:"pb-edit-btn pb-target-btn",onClick:()=>k(!0),children:Object.keys(F).length>0?"Edit Targets":"Set Targets"}),(Object.keys(F).length>0||Object.keys(E).length>0)&&e.jsx("button",{className:"pb-edit-btn pb-reset-btn",onClick:pt,disabled:T,children:"Reset All Goals"})]}),ae&&e.jsxs("div",{className:"pb-edit-card",children:[e.jsxs("div",{className:"pb-edit-header",children:[e.jsxs("h3",{children:["Benchmarks - ",le(q)]}),e.jsx("button",{className:"pb-edit-close",onClick:()=>{P(!1),G(M?.benchmarks||{})},children:"×"})]}),e.jsx("div",{className:"pb-edit-body",children:ce.map(t=>e.jsxs("div",{className:"pb-edit-exercise",children:[e.jsx("div",{className:"pb-edit-exercise-name",children:t.name}),t.unit==="weight"?e.jsxs("div",{className:"pb-edit-row",children:[e.jsxs("div",{className:"pb-edit-field",children:[e.jsx("label",{children:"Weight (kg)"}),e.jsx("input",{type:"number",step:"0.5",value:x[t.key]?.weight??"",onChange:r=>Fe(t.key,"weight",r.target.value),placeholder:"0"})]}),e.jsxs("div",{className:"pb-edit-field",children:[e.jsx("label",{children:"Reps"}),e.jsx("input",{type:"number",value:x[t.key]?.reps??"",onChange:r=>Fe(t.key,"reps",r.target.value),placeholder:"0"})]})]}):t.unit==="reps"?e.jsx("div",{className:"pb-edit-row",children:e.jsxs("div",{className:"pb-edit-field full",children:[e.jsx("label",{children:"Reps (max in 1 min)"}),e.jsx("input",{type:"number",value:x[t.key]?.reps??"",onChange:r=>Fe(t.key,"reps",r.target.value),placeholder:"0"})]})}):t.unit==="distance"?e.jsx("div",{className:"pb-edit-row",children:e.jsxs("div",{className:"pb-edit-field full",children:[e.jsx("label",{children:"Distance (cm)"}),e.jsx("input",{type:"number",step:"0.5",value:x[t.key]?.distance??"",onChange:r=>Fe(t.key,"distance",r.target.value),placeholder:"0"})]})}):e.jsx("div",{className:"pb-edit-row",children:e.jsxs("div",{className:"pb-edit-field full",children:[e.jsx("label",{children:"Time (seconds)"}),e.jsx("input",{type:"number",step:"0.01",value:x[t.key]?.time??"",onChange:r=>Fe(t.key,"time",r.target.value),placeholder:"0"})]})})]},t.key))}),e.jsxs("div",{className:"pb-edit-actions",children:[e.jsx("button",{className:"pb-cancel-btn",onClick:()=>{P(!1),G(M?.benchmarks||{})},children:"Cancel"}),e.jsx("button",{className:"pb-save-btn",onClick:Vt,disabled:T,children:T?"Saving...":"Save"})]})]}),ge&&e.jsxs("div",{className:"pb-edit-card",children:[e.jsxs("div",{className:"pb-edit-header",children:[e.jsx("h3",{children:"Set Your Targets"}),e.jsx("button",{className:"pb-edit-close",onClick:()=>{k(!1),Q(F)},children:"×"})]}),e.jsxs("div",{className:"pb-edit-body",children:[e.jsx("p",{className:"pb-target-hint",children:"Set a target for each exercise. Your current best is captured automatically from your latest benchmarks."}),ce.map(t=>{const r=M?.benchmarks?.[t.key];let c="-";if(r)switch(t.unit){case"weight":(r.weight||r.reps)&&(c=`${r.weight||0}kg × ${r.reps||0}`);break;case"time":r.time&&(c=`${r.time}s`);break;case"reps":r.reps&&(c=`${r.reps} reps`);break;case"distance":r.distance&&(c=`${r.distance} cm`);break}return e.jsxs("div",{className:"pb-edit-exercise",children:[e.jsxs("div",{className:"pb-edit-exercise-header",children:[e.jsx("div",{className:"pb-edit-exercise-name",children:t.name}),e.jsxs("div",{className:"pb-edit-current-best",children:["Current: ",c]})]}),t.unit==="weight"?e.jsxs("div",{className:"pb-edit-row",children:[e.jsxs("div",{className:"pb-edit-field",children:[e.jsx("label",{children:"Target Weight (kg)"}),e.jsx("input",{type:"number",step:"0.5",value:B[t.key]?.targetWeight??"",onChange:o=>te(t.key,"targetWeight",o.target.value),placeholder:"0"})]}),e.jsxs("div",{className:"pb-edit-field",children:[e.jsx("label",{children:"Target Reps"}),e.jsx("input",{type:"number",value:B[t.key]?.targetReps??"",onChange:o=>te(t.key,"targetReps",o.target.value),placeholder:"0"})]})]}):t.unit==="reps"?e.jsx("div",{className:"pb-edit-row",children:e.jsxs("div",{className:"pb-edit-field full",children:[e.jsx("label",{children:"Target Reps (in 1 min)"}),e.jsx("input",{type:"number",value:B[t.key]?.targetReps??"",onChange:o=>te(t.key,"targetReps",o.target.value),placeholder:"0"})]})}):t.unit==="distance"?e.jsx("div",{className:"pb-edit-row",children:e.jsxs("div",{className:"pb-edit-field full",children:[e.jsx("label",{children:"Target Distance (cm)"}),e.jsx("input",{type:"number",step:"0.5",value:B[t.key]?.targetDistance??"",onChange:o=>te(t.key,"targetDistance",o.target.value),placeholder:"0"})]})}):e.jsx("div",{className:"pb-edit-row",children:e.jsxs("div",{className:"pb-edit-field full",children:[e.jsx("label",{children:"Target (seconds)"}),e.jsx("input",{type:"number",step:"1",value:B[t.key]?.targetValue??"",onChange:o=>te(t.key,"targetValue",o.target.value),placeholder:"0"})]})})]},t.key)})]}),e.jsxs("div",{className:"pb-edit-actions",children:[e.jsx("button",{className:"pb-cancel-btn",onClick:()=>{k(!1),Q(F)},children:"Cancel"}),e.jsx("button",{className:"pb-save-btn",onClick:U,disabled:T,children:T?"Saving...":"Save Targets"})]})]})]}),p==="metrics"&&e.jsxs("div",{className:"pb-metrics-section",children:[!I&&!Qe&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"pb-metrics-card",children:[e.jsx("h3",{children:"Body Measurements"}),e.jsx("p",{className:"pb-metrics-month",children:le(q)}),e.jsx("div",{className:"pb-metrics-list",children:Pe.map(t=>{const r=M?.bodyMetrics?.[t.key],c=ut(t.key),o=E[t.key],n=ee(t.key),j=n!==null&&n>=1;return e.jsxs("div",{className:"pb-metric-row",children:[e.jsxs("div",{className:"pb-metric-top",children:[e.jsxs("div",{className:"pb-metric-left",children:[e.jsxs("span",{className:"pb-metric-name",children:[t.name,Oe("metric",t.key)&&e.jsx("svg",{className:"pb-badge-icon-sm",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})]}),o&&e.jsxs("span",{className:"pb-metric-target-label",children:["Target: ",o.targetValue," ",t.suffix]})]}),e.jsxs("div",{className:"pb-metric-values",children:[e.jsx("span",{className:"pb-metric-current",children:r!=null?`${r} ${t.suffix}`:"-"}),c!==null&&e.jsxs("span",{className:`pb-metric-change ${c>0?"up":c<0?"down":"same"}`,children:[c>0?"+":"",c," ",t.suffix]})]})]}),n!==null&&e.jsxs("div",{className:"pb-metric-progress",children:[e.jsx("div",{className:"pb-metric-bar",children:e.jsx("div",{className:`pb-metric-bar-fill ${j?"hit":""}`,style:{width:`${Math.round(n*100)}%`}})}),e.jsx("span",{className:`pb-metric-percent ${j?"hit":""}`,children:j?"Hit!":`${Math.round(n*100)}%`})]})]},t.key)})})]}),e.jsxs("div",{className:"pb-action-buttons",children:[e.jsx("button",{className:"pb-edit-btn",onClick:()=>Y(!0),children:M?.bodyMetrics?"Edit This Month's Measurements":"Add This Month's Measurements"}),e.jsx("button",{className:"pb-edit-btn pb-target-btn",onClick:()=>be(!0),children:Object.keys(E).length>0?"Edit Targets":"Set Targets"}),(Object.keys(F).length>0||Object.keys(E).length>0)&&e.jsx("button",{className:"pb-edit-btn pb-reset-btn",onClick:pt,disabled:T,children:"Reset All Goals"})]})]}),I&&e.jsxs("div",{className:"pb-edit-card",children:[e.jsxs("div",{className:"pb-edit-header",children:[e.jsxs("h3",{children:["Measurements - ",le(q)]}),e.jsx("button",{className:"pb-edit-close",onClick:()=>{Y(!1),re(M?.bodyMetrics||{})},children:"×"})]}),e.jsx("div",{className:"pb-edit-body",children:Pe.map(t=>e.jsx("div",{className:"pb-edit-metric",children:e.jsxs("div",{className:"pb-edit-field full",children:[e.jsxs("label",{children:[t.name," (",t.suffix,")"]}),e.jsx("input",{type:"number",step:"0.1",value:J[t.key]??"",onChange:r=>rt(t.key,r.target.value),placeholder:"0"})]})},t.key))}),e.jsxs("div",{className:"pb-edit-actions",children:[e.jsx("button",{className:"pb-cancel-btn",onClick:()=>{Y(!1),re(M?.bodyMetrics||{})},children:"Cancel"}),e.jsx("button",{className:"pb-save-btn",onClick:me,disabled:T,children:T?"Saving...":"Save"})]})]}),Qe&&e.jsxs("div",{className:"pb-edit-card",children:[e.jsxs("div",{className:"pb-edit-header",children:[e.jsx("h3",{children:"Body Metric Targets"}),e.jsx("button",{className:"pb-edit-close",onClick:()=>{be(!1),Z(E)},children:"×"})]}),e.jsxs("div",{className:"pb-edit-body",children:[e.jsx("p",{className:"pb-target-hint",children:"Set targets for your body measurements. Your current measurement is captured automatically."}),Pe.map(t=>{const r=M?.bodyMetrics?.[t.key];return e.jsxs("div",{className:"pb-edit-exercise",children:[e.jsxs("div",{className:"pb-edit-exercise-header",children:[e.jsx("div",{className:"pb-edit-exercise-name",children:t.name}),e.jsxs("div",{className:"pb-edit-current-best",children:["Current: ",r!=null?`${r} ${t.suffix}`:"-"]})]}),e.jsx("div",{className:"pb-edit-row",children:e.jsxs("div",{className:"pb-edit-field full",children:[e.jsxs("label",{children:["Target (",t.suffix,")"]}),e.jsx("input",{type:"number",step:"0.1",value:Se[t.key]?.targetValue??"",onChange:c=>nt(t.key,c.target.value),placeholder:"0"})]})})]},t.key)})]}),e.jsxs("div",{className:"pb-edit-actions",children:[e.jsx("button",{className:"pb-cancel-btn",onClick:()=>{be(!1),Z(E)},children:"Cancel"}),e.jsx("button",{className:"pb-save-btn",onClick:vt,disabled:T,children:T?"Saving...":"Save Targets"})]})]})]}),p==="history"&&e.jsx("div",{className:"pb-history-section",children:g.length===0?e.jsxs("div",{className:"pb-empty",children:[e.jsx("h4",{children:"No records yet"}),e.jsx("p",{children:"Start adding your monthly benchmarks and measurements to track your progress over time."})]}):e.jsxs(e.Fragment,{children:[R.length>0&&e.jsxs("div",{className:"pb-achievements-wall",children:[e.jsxs("h4",{className:"pb-achievements-wall-title",children:[e.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"18",height:"18",children:e.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),"Targets Achieved"]}),e.jsx("div",{className:"pb-achievements-list",children:[...R].reverse().map((t,r)=>e.jsxs("div",{className:"pb-achievement-item",style:{animationDelay:`${r*.05}s`},children:[e.jsx("div",{className:"pb-achievement-star",children:e.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),e.jsxs("div",{className:"pb-achievement-info",children:[e.jsx("span",{className:"pb-achievement-label",children:t.label}),e.jsx("span",{className:"pb-achievement-date",children:le(t.achievedMonth)})]})]},r))})]}),e.jsx("div",{className:"pb-history-controls",children:e.jsx("button",{className:`pb-compare-toggle ${ne?"active":""}`,onClick:()=>{jt(!ne),!ne&&g.length>=2&&(Ke(g[0].month),et(g[g.length-1].month))},children:ne?"Back to Timeline":"Compare Months"})}),ne?e.jsxs("div",{className:"pb-compare",children:[e.jsxs("div",{className:"pb-compare-selectors",children:[e.jsxs("div",{className:"pb-compare-select",children:[e.jsx("label",{children:"From"}),e.jsx("select",{value:ve,onChange:t=>Ke(t.target.value),children:g.map(t=>e.jsx("option",{value:t.month,children:le(t.month)},t.month))})]}),e.jsx("div",{className:"pb-compare-vs",children:"vs"}),e.jsxs("div",{className:"pb-compare-select",children:[e.jsx("label",{children:"To"}),e.jsx("select",{value:ye,onChange:t=>et(t.target.value),children:g.map(t=>e.jsx("option",{value:t.month,children:le(t.month)},t.month))})]})]}),ze&&ct&&e.jsxs("div",{className:"pb-compare-results",children:[e.jsxs("div",{className:"pb-compare-group",children:[e.jsx("h4",{children:"Strength Tests"}),e.jsxs("div",{className:"pb-compare-table",children:[e.jsxs("div",{className:"pb-compare-header-row",children:[e.jsx("span",{children:"Exercise"}),e.jsx("span",{children:le(ve).split(" ")[0]}),e.jsx("span",{children:le(ye).split(" ")[0]}),e.jsx("span",{children:"Change"})]}),ce.map(t=>{const r=ze.benchmarks?.[t.key],c=ct.benchmarks?.[t.key],o=Ye(t,r),n=Ye(t,c),j=$t(n,o);return e.jsxs("div",{className:"pb-compare-row",children:[e.jsx("span",{className:"pb-compare-name",children:t.name}),e.jsx("span",{className:"pb-compare-val",children:r?bt(t,r):"-"}),e.jsx("span",{className:"pb-compare-val",children:c?bt(t,c):"-"}),e.jsx("span",{className:`pb-compare-change ${j!==null?j>=0?"positive":"negative":""}`,children:j!==null?`${j>=0?"+":""}${j.toFixed(1)}%`:"-"})]},t.key)})]})]}),e.jsxs("div",{className:"pb-compare-group",children:[e.jsx("h4",{children:"Body Measurements"}),e.jsxs("div",{className:"pb-compare-table",children:[e.jsxs("div",{className:"pb-compare-header-row",children:[e.jsx("span",{children:"Measurement"}),e.jsx("span",{children:le(ve).split(" ")[0]}),e.jsx("span",{children:le(ye).split(" ")[0]}),e.jsx("span",{children:"Change"})]}),Pe.map(t=>{const r=ze.bodyMetrics?.[t.key],c=ct.bodyMetrics?.[t.key],o=r!=null&&c!=null?parseFloat((c-r).toFixed(2)):null;return e.jsxs("div",{className:"pb-compare-row",children:[e.jsx("span",{className:"pb-compare-name",children:t.name}),e.jsx("span",{className:"pb-compare-val",children:r!=null?`${r}`:"-"}),e.jsx("span",{className:"pb-compare-val",children:c!=null?`${c}`:"-"}),e.jsx("span",{className:`pb-compare-change ${o!==null?o>0?"positive":o<0?"negative":"neutral":""}`,children:o!==null?`${o>0?"+":""}${o} ${t.suffix}`:"-"})]},t.key)})]})]})]})]}):e.jsx("div",{className:"pb-timeline",children:[...g].reverse().map((t,r)=>{const c=g.filter(o=>o.month<t.month).pop();return e.jsxs("div",{className:"pb-timeline-item",style:{animationDelay:`${r*.05}s`},children:[e.jsx("div",{className:"pb-timeline-dot"}),e.jsxs("div",{className:"pb-timeline-card",children:[e.jsx("h4",{children:le(t.month)}),t.benchmarks&&Object.keys(t.benchmarks).length>0&&e.jsxs("div",{className:"pb-timeline-group",children:[e.jsx("h5",{children:"Strength Tests"}),ce.map(o=>{const n=t.benchmarks[o.key];if(!n)return null;const j=c?.benchmarks?.[o.key],L=Ye(o,n),u=Ye(o,j),y=$t(L,u);return e.jsxs("div",{className:"pb-timeline-row",children:[e.jsx("span",{className:"pb-timeline-label",children:o.name}),e.jsxs("div",{className:"pb-timeline-values",children:[e.jsx("span",{className:"pb-timeline-value",children:bt(o,n)}),y!==null&&e.jsxs("span",{className:`pb-timeline-change ${y>=0?"positive":"negative"}`,children:[y>=0?"+":"",y.toFixed(1),"%"]})]})]},o.key)})]}),t.bodyMetrics&&Object.keys(t.bodyMetrics).length>0&&e.jsxs("div",{className:"pb-timeline-group",children:[e.jsx("h5",{children:"Body Measurements"}),Pe.map(o=>{const n=t.bodyMetrics[o.key];if(n==null)return null;const j=c?.bodyMetrics?.[o.key],L=j!=null?parseFloat((n-j).toFixed(2)):null;return e.jsxs("div",{className:"pb-timeline-row",children:[e.jsx("span",{className:"pb-timeline-label",children:o.name}),e.jsxs("div",{className:"pb-timeline-values",children:[e.jsxs("span",{className:"pb-timeline-value",children:[n," ",o.suffix]}),L!==null&&e.jsxs("span",{className:`pb-timeline-change ${L>0?"positive":L<0?"negative":"neutral"}`,children:[L>0?"+":"",L," ",o.suffix]})]})]},o.key)})]})]})]},t.id)})})]})})]}),xe&&e.jsx("div",{className:"pb-celebration-overlay",onClick:()=>Le(null),children:e.jsxs("div",{className:"pb-celebration-card",children:[e.jsx("div",{className:"pb-celebration-icon",children:e.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),e.jsx("h3",{className:"pb-celebration-title",children:xe.length===1?"Target Achieved!":`${xe.length} Targets Achieved!`}),e.jsx("div",{className:"pb-celebration-badges",children:xe.map((t,r)=>e.jsx("div",{className:"pb-celebration-badge",children:t.label},r))}),e.jsx("p",{className:"pb-celebration-sub",children:"Tap to dismiss"})]})}),je&&e.jsxs("div",{className:`toast-notification ${je.type}`,children:[e.jsx("span",{className:"toast-icon",children:je.type==="success"?e.jsx("svg",{className:"success-check-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("path",{className:"check-path",d:"M5 13 L9 17 L19 7"})}):e.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[e.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),e.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})}),e.jsx("span",{className:"toast-message",children:je.message}),e.jsx("button",{className:"toast-close",onClick:()=>Re(null),children:"×"})]}),e.jsxs("nav",{className:"block-bottom-nav",children:[e.jsxs("button",{className:"block-nav-tab",onClick:()=>fe("/client"),children:[e.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}),e.jsx("polyline",{points:"9 22 9 12 15 12 15 22"})]}),e.jsx("span",{children:"Home"})]}),e.jsxs("button",{className:"block-nav-tab",onClick:()=>fe("/client/forms"),children:[e.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),e.jsx("polyline",{points:"14 2 14 8 20 8"}),e.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),e.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"})]}),e.jsx("span",{children:"Forms"})]}),e.jsxs("button",{className:"block-nav-tab",onClick:()=>fe("/client/tools"),children:[e.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"})}),e.jsx("span",{children:"Tools"})]}),e.jsxs("button",{className:"block-nav-tab active",children:[e.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M12 20V10"}),e.jsx("path",{d:"M18 20V4"}),e.jsx("path",{d:"M6 20v-4"})]}),e.jsx("span",{children:"PBs"})]}),S?.circuitAccess&&e.jsxs("button",{className:"block-nav-tab",onClick:()=>fe("/client/circuit"),children:[e.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("path",{d:"M12 6v6l4 2"})]}),e.jsx("span",{children:"Circuit"})]})]})]})}const ue=[{key:"chestPress",name:"Chest Press",category:"Upper Body - Push",unit:"weight"},{key:"shoulderPress",name:"Shoulder Press",category:"Upper Body - Push",unit:"weight"},{key:"seatedRow",name:"Seated Row",category:"Upper Body - Pull",unit:"weight"},{key:"latPulldown",name:"Lat Pulldown",category:"Upper Body - Pull",unit:"weight"},{key:"squat",name:"Squat",category:"Lower Body",unit:"weight"},{key:"deadlift",name:"Deadlift",category:"Lower Body",unit:"weight"},{key:"plank",name:"Plank",category:"Core",unit:"time"}],De=[{key:"weight",name:"Weight",suffix:"kg"},{key:"chest",name:"Chest",suffix:"cm"},{key:"waist",name:"Waist",suffix:"cm"},{key:"hips",name:"Hips",suffix:"cm"},{key:"leftArm",name:"Left Arm",suffix:"cm"},{key:"rightArm",name:"Right Arm",suffix:"cm"},{key:"leftThigh",name:"Left Thigh",suffix:"cm"},{key:"rightThigh",name:"Right Thigh",suffix:"cm"}];function Gt(){const p=new Date;return`${p.getFullYear()}-${String(p.getMonth()+1).padStart(2,"0")}`}function oe(p){const[m,g]=p.split("-");return new Date(parseInt(m),parseInt(g)-1).toLocaleDateString("en-GB",{month:"long",year:"numeric"})}function xt(p){if(!p&&p!==0)return"-";const m=Math.floor(p/60),g=(p%60).toFixed(2);return m>0?`${m}m ${parseFloat(g).toFixed(0)}s`:`${parseFloat(g).toFixed(2)}s`}function St(p,m){return!p&&p!==0?"-":!m&&m!==0?`${p}kg`:`${p}kg x ${m}`}function Ge(p,m){return m?p.unit==="time"?m.time||0:(m.weight||0)*(m.reps||0):0}function Bt(p,m){return!m||m===0?null:(p-m)/m*100}function Ut({data:p,exerciseKey:m,unit:g}){if(!p||p.length<2)return e.jsx("div",{className:"pb-trend-empty",children:e.jsx("p",{children:"Not enough data for trend line yet"})});const _=p.map(k=>{const x=k.benchmarks?.[m];return x?g==="time"?x.time||0:(x.weight||0)*(x.reps||0):0}),$e=Math.max(..._),he=Math.min(..._),T=$e-he||1,w=300,$=100,D=20,ae=w-D*2,P=$-D*2,I=_.map((k,x)=>{const G=D+x/(_.length-1)*ae,J=D+P-(k-he)/T*P;return{x:G,y:J,value:k}}),Y=I.map((k,x)=>`${x===0?"M":"L"} ${k.x} ${k.y}`).join(" "),ge=Y+` L ${I[I.length-1].x} ${D+P} L ${I[0].x} ${D+P} Z`;return e.jsxs("div",{className:"pb-trend-chart",children:[e.jsxs("svg",{viewBox:`0 0 ${w} ${$}`,preserveAspectRatio:"xMidYMid meet",children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"trendGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"0%",stopColor:"var(--color-primary)",stopOpacity:"0.3"}),e.jsx("stop",{offset:"100%",stopColor:"var(--color-primary)",stopOpacity:"0.02"})]})}),e.jsx("path",{d:ge,fill:"url(#trendGradient)"}),e.jsx("path",{d:Y,fill:"none",stroke:"var(--color-primary)",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round"}),I.map((k,x)=>e.jsx("circle",{cx:k.x,cy:k.y,r:"4",fill:"var(--bg-card)",stroke:"var(--color-primary)",strokeWidth:"2"},x))]}),e.jsx("div",{className:"pb-trend-labels",children:p.map((k,x)=>e.jsxs("span",{className:"pb-trend-label",children:[k.month.split("-")[1],"/",k.month.split("-")[0].slice(2)]},x))})]})}function Jt(){const[p,m]=h.useState("bests"),[g,_]=h.useState([]),[$e,he]=h.useState(!0),[T,w]=h.useState(!1),[$,D]=h.useState(0),[ae,P]=h.useState(!1),[I,Y]=h.useState(!1),[ge,k]=h.useState(!1),[x,G]=h.useState({}),[J,re]=h.useState({}),[F,Be]=h.useState({}),[E,Ve]=h.useState({}),[B,Q]=h.useState({}),[Qe,be]=h.useState(!1),[Se,Z]=h.useState({}),[R,Ze]=h.useState([]),[xe,Le]=h.useState(null),[je,Re]=h.useState(null),[ne,jt]=h.useState(!1),[ve,Ke]=h.useState(""),[ye,et]=h.useState(""),[ke,ht]=h.useState({}),[pe,tt]=h.useState({}),[Te,st]=h.useState(null),[ie,S]=h.useState(null),[We,at]=h.useState(""),fe=h.useRef(null),K=h.useRef(0),Ne=h.useRef(0),q=h.useRef("right"),M=h.useCallback(s=>{D(a=>{const i=Math.max(0,Math.min(ue.length-1,s));return i===a?a:(q.current=i>a?"right":"left",i)})},[]),{currentUser:Ae,isClient:Ie,clientData:N,loading:Oe}=Lt(),{isDark:Vt}=Rt(),me=Wt(),[Fe]=Pt(),rt=Fe.get("mode")==="corebuddy",te=!rt&&(!N?.clientType||N.clientType==="block"),U=h.useCallback((s,a="info")=>{Re({message:s,type:a}),setTimeout(()=>Re(null),4e3)},[]);h.useEffect(()=>{!Oe&&(!Ae||!Ie)&&me("/")},[Ae,Ie,Oe,me]),h.useEffect(()=>{N&&(te?nt():(async()=>{try{const[a,i,l]=await Promise.all([Mt(z(A,"coreBuddyPBs",N.id)),Mt(z(A,"coreBuddyTargets",N.id)),Mt(z(A,"coreBuddyAchievements",N.id))]);a.exists()&&ht(a.data().exercises||{}),i.exists()&&tt(i.data().targets||{}),l.exists()&&st(l.data())}catch(a){console.error("Error loading Core Buddy PBs:",a)}he(!1)})())},[N]);const nt=async()=>{try{const s=Ue(qe(A,"personalBests"),Xe("clientId","==",N.id)),i=(await Je(s)).docs.map(C=>({id:C.id,...C.data()}));i.sort((C,f)=>C.month.localeCompare(f.month)),_(i);const l=Ue(qe(A,"personalBestTargets"),Xe("clientId","==",N.id)),d=await Je(l);if(!d.empty){const C=d.docs[0].data();Be(C.targets||{}),Ve(C.metricTargets||{}),Q(C.targets||{}),Z(C.metricTargets||{})}const v=Ue(qe(A,"achievements"),Xe("clientId","==",N.id)),V=await Je(v);V.empty||Ze(V.docs[0].data().badges||[])}catch(s){console.error("Error fetching personal bests:",s)}he(!1)},vt=async()=>{if(!ie||!We||!N)return;const s=parseFloat(We),a=ke[ie];if(!a||s<=a.weight){U("Target must be higher than current PB","error");return}w(!0);try{const i={...pe,[ie]:{targetWeight:s,setAt:H.now(),currentPBWhenSet:a.weight}};await de(z(A,"coreBuddyTargets",N.id),{clientId:N.id,targets:i,updatedAt:H.now()}),tt(i),S(null),at(""),U("Target set!","success")}catch(i){console.error("Error saving target:",i),U("Failed to save target","error")}w(!1)},pt=s=>{if(!Te?.badges)return!1;const a=pe[s];return a?Te.badges.some(i=>i.type==="pb_target"&&i.exercise===s&&i.targetWeight===a.targetWeight):!1},yt=s=>{const a=pe[s];if(!a)return null;const i=ke[s];if(!i)return 0;const l=a.currentPBWhenSet||0,d=a.targetWeight,v=d-l;return v<=0?i.weight>=d?1:0:Math.max(0,Math.min((i.weight-l)/v,1))},ee=Gt(),W=g.find(s=>s.month===ee),it=g.filter(s=>s.month<ee),mt=it.length>0?it[it.length-1]:null;h.useEffect(()=>{W?(G(W.benchmarks||{}),re(W.bodyMetrics||{})):(G({}),re({}))},[W?.id]);const ut=async(s,a)=>{const i=[];if(s==="strength"?ue.forEach(l=>{const d=F[l.key];if(!d)return;const v=a[l.key];if(!v)return;let V;if(d.targetType==="time"){if(!d.targetValue)return;const C=d.startValue||0,f=v.time||0,se=d.targetValue-C;V=se===0?f>=d.targetValue?1:0:Math.max(0,(f-C)/se)}else{if(!d.targetWeight&&!d.targetReps)return;const C=(d.startWeight||0)*(d.startReps||0),f=(d.targetWeight||0)*(d.targetReps||0),se=(v.weight||0)*(v.reps||0),Me=f-C;V=Me===0?se>=f?1:0:Math.max(0,(se-C)/Me)}if(V>=1&&!(d.targetType==="time"?R.some(f=>f.type==="strength"&&f.key===l.key&&f.targetValue===d.targetValue):R.some(f=>f.type==="strength"&&f.key===l.key&&f.targetWeight===d.targetWeight&&f.targetReps===d.targetReps))){const f=d.targetType==="time"?`${l.name} ${d.targetValue}s`:`${l.name} ${d.targetWeight}kg × ${d.targetReps}`;i.push({type:"strength",key:l.key,...d.targetType==="time"?{targetType:"time",targetValue:d.targetValue}:{targetWeight:d.targetWeight,targetReps:d.targetReps},achievedMonth:ee,label:f})}}):De.forEach(l=>{const d=E[l.key];if(!d||!d.targetValue)return;const v=a[l.key];if(v==null)return;const V=d.startValue||0,C=d.targetValue,f=C-V;(f===0?v===C?1:0:Math.max(0,(v-V)/f))>=1&&(R.some(Tt=>Tt.type==="metric"&&Tt.key===l.key&&Tt.targetValue===C)||i.push({type:"metric",key:l.key,targetValue:C,achievedMonth:ee,label:`${l.name} ${C}${l.suffix}`}))}),i.length>0){const l=[...R,...i];await de(z(A,"achievements",N.id),{clientId:N.id,badges:l,updatedAt:H.now()}),Ze(l),Le(i),setTimeout(()=>Le(null),5e3)}},ze=(s,a)=>{if(s==="strength"){const i=F[a];return i?i.targetType==="time"?R.some(l=>l.type==="strength"&&l.key===a&&l.targetValue===i.targetValue):!i.targetWeight&&!i.targetReps?!1:R.some(l=>l.type==="strength"&&l.key===a&&l.targetWeight===i.targetWeight&&l.targetReps===i.targetReps):!1}else{const i=E[a];return!i||!i.targetValue?!1:R.some(l=>l.type==="metric"&&l.key===a&&l.targetValue===i.targetValue)}},ct=async()=>{w(!0);try{const s=`${N.id}_${ee}`,a=W||{};await de(z(A,"personalBests",s),{clientId:N.id,month:ee,benchmarks:x,bodyMetrics:a.bodyMetrics||J||{},createdAt:a.createdAt||H.now(),updatedAt:H.now()}),await ut("strength",x),U("Benchmarks saved!","success"),P(!1),await nt()}catch(s){console.error("Error saving benchmarks:",s),U("Failed to save. Please try again.","error")}w(!1)},X=async()=>{w(!0);try{const s=`${N.id}_${ee}`,a=W||{};await de(z(A,"personalBests",s),{clientId:N.id,month:ee,benchmarks:a.benchmarks||x||{},bodyMetrics:J,createdAt:a.createdAt||H.now(),updatedAt:H.now()}),await ut("metric",J),U("Body metrics saved!","success"),Y(!1),await nt()}catch(s){console.error("Error saving metrics:",s),U("Failed to save. Please try again.","error")}w(!1)},we=(s,a,i)=>{G(l=>({...l,[s]:{...l[s],[a]:i===""?"":parseFloat(i)}}))},kt=(s,a)=>{re(i=>({...i,[s]:a===""?"":parseFloat(a)}))},He=(s,a,i)=>{Q(l=>({...l,[s]:{...l[s],[a]:i===""?"":parseFloat(i)}}))},ft=async()=>{w(!0);try{const s=`targets_${N.id}`,a=W?.benchmarks||{},i={};ue.forEach(l=>{const d=a[l.key];l.unit==="time"?B[l.key]?.targetValue&&(i[l.key]={targetType:"time",targetValue:B[l.key].targetValue,startValue:d?.time||0}):(B[l.key]?.targetWeight||B[l.key]?.targetReps)&&(i[l.key]={targetWeight:B[l.key].targetWeight||0,targetReps:B[l.key].targetReps||0,startWeight:d?.weight||0,startReps:d?.reps||0})}),await de(z(A,"personalBestTargets",s),{clientId:N.id,targets:i,metricTargets:E,updatedAt:H.now()}),Be(i),Q(i),U("Targets saved!","success"),k(!1)}catch(s){console.error("Error saving targets:",s),U("Failed to save targets.","error")}w(!1)},Ee=(s,a)=>{Z(i=>({...i,[s]:{...i[s],targetValue:a===""?"":parseFloat(a)}}))},_e=async()=>{w(!0);try{const s=`targets_${N.id}`,a={};De.forEach(i=>{if(Se[i.key]?.targetValue){const l=W?.bodyMetrics?.[i.key]||0;a[i.key]={targetValue:Se[i.key].targetValue,startValue:l}}}),await de(z(A,"personalBestTargets",s),{clientId:N.id,targets:F,metricTargets:a,updatedAt:H.now()}),Ve(a),Z(a),U("Metric targets saved!","success"),be(!1)}catch(s){console.error("Error saving metric targets:",s),U("Failed to save targets.","error")}w(!1)},gt=async()=>{if(window.confirm("Reset all goals? This will clear all strength and body metric targets. Your recorded benchmarks and measurements will NOT be affected.")){w(!0);try{const s=z(A,"personalBestTargets",`targets_${N.id}`);await Ft(s),Be({}),Ve({}),Q({}),Z({}),U("All goals have been reset","success")}catch(s){console.error("Error resetting targets:",s),U("Failed to reset goals","error")}w(!1)}},lt=(s,a)=>{const i=F[s];if(!i||!a)return null;if(i.targetType==="time"){if(!i.targetValue)return null;const C=i.startValue||0,f=i.targetValue,se=a.time||0,Me=f-C;return Me<=0?se>=f?1:0:Math.max(0,Math.min((se-C)/Me,1))}if(!i.targetWeight&&!i.targetReps)return null;const l=(i.startWeight||0)*(i.startReps||0),d=(i.targetWeight||0)*(i.targetReps||0),v=(a.weight||0)*(a.reps||0),V=d-l;return V<=0?v>=d?1:0:Math.max(0,Math.min((v-l)/V,1))},Nt=s=>{const a=E[s];if(!a||!a.targetValue)return null;const i=W?.bodyMetrics?.[s];if(i==null)return null;const l=a.startValue||0,d=a.targetValue,v=d-l;return v===0?i===d?1:0:Math.max(0,Math.min((i-l)/v,1))},ot=s=>{K.current=s.touches[0].clientX,Ne.current=0},wt=s=>{Ne.current=s.touches[0].clientX-K.current},t=()=>{Ne.current<-50?M($+1):Ne.current>50&&M($-1),Ne.current=0},r=s=>{const a=W?.bodyMetrics?.[s],i=mt?.bodyMetrics?.[s];return a==null||i==null?null:parseFloat((a-i).toFixed(2))},c=g.find(s=>s.month===ve),o=g.find(s=>s.month===ye);if(Oe||$e)return e.jsxs("div",{className:"pb-page",children:[e.jsx("header",{className:"client-header",children:e.jsx("div",{className:"header-content",children:e.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})})}),e.jsxs("main",{className:"pb-main",children:[e.jsx("div",{className:"skeleton skeleton-title",style:{width:180,height:28,marginBottom:20}}),e.jsx("div",{className:"skeleton skeleton-card-large",style:{height:320,borderRadius:16}})]})]});if(!Ae||!Ie||!N)return null;if(te&&N?.isJunior)return e.jsx(Yt,{});const n=ue[$],j=W?.benchmarks?.[n.key],L=mt?.benchmarks?.[n.key],u=Ge(n,j),y=Ge(n,L),b=Bt(u,y),O=lt(n.key,j),dt=O!==null,Ct=O!==null&&O>=1,Et=dt?Math.round(O*60):u>0?15:0,Ce=F[n.key];return e.jsxs("div",{className:"pb-page",children:[e.jsx("header",{className:"client-header",children:e.jsxs("div",{className:"header-content",children:[e.jsx("button",{className:"header-back-btn",onClick:()=>me(rt?"/client/core-buddy":"/client"),"aria-label":"Go back",children:e.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("path",{d:"M15 18l-6-6 6-6"})})}),e.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})]})}),e.jsxs("main",{className:"pb-main page-transition-enter",children:[e.jsxs("div",{className:"pb-intro",children:[e.jsx("h2",{children:"Personal Bests"}),e.jsx("p",{children:te?"Track your strength benchmarks and body measurements each month.":"Your all-time best lifts from programme workouts."})]}),!te&&e.jsxs("div",{className:"pb-cb-section",children:[Object.keys(ke).length===0?e.jsxs("div",{className:"pb-empty",children:[e.jsx("div",{className:"pb-cb-empty-icon",children:e.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("path",{d:"M20.57 14.86L22 13.43 20.57 12 17 15.57 8.43 7 12 3.43 10.57 2 9.14 3.43 7.71 2 5.57 4.14 4.14 2.71 2.71 4.14l1.43 1.43L2 7.71l1.43 1.43L2 10.57 3.43 12 7 8.43 15.57 17 12 20.57 13.43 22l1.43-1.43L16.29 22l2.14-2.14 1.43 1.43 1.43-1.43-1.43-1.43L22 16.29z"})})}),e.jsx("h4",{children:"No personal bests yet"}),e.jsx("p",{children:"Complete weight-based workouts to start tracking your personal bests."})]}):e.jsx("div",{className:"pb-cb-grid",children:Object.entries(ke).sort(([s],[a])=>s.localeCompare(a)).map(([s,a],i)=>{const l=pe[s],d=yt(s),v=d!==null&&d>=1,V=pt(s),C=d!==null?Math.round(d*60):60;return e.jsxs("div",{className:"pb-cb-card",style:{animationDelay:`${i*.05}s`},children:[e.jsxs("div",{className:"pb-cb-card-ring",children:[e.jsx("svg",{className:"pb-cb-ring-svg",viewBox:"0 0 80 80",children:Dt.map((f,se)=>{const Me=se<C;return e.jsx("line",{x1:f.x1,y1:f.y1,x2:f.x2,y2:f.y2,className:`pb-ring-tick ${Me?v?"hit":"filled":"empty"}`,strokeWidth:f.thick?"2":"1.5"},se)})}),e.jsx("div",{className:"pb-cb-ring-icon",children:V?e.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",className:"pb-cb-badge-earned",children:e.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}):e.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M20.57 14.86L22 13.43 20.57 12 17 15.57 8.43 7 12 3.43 10.57 2 9.14 3.43 7.71 2 5.57 4.14 4.14 2.71 2.71 4.14l1.43 1.43L2 7.71l1.43 1.43L2 10.57 3.43 12 7 8.43 15.57 17 12 20.57 13.43 22l1.43-1.43L16.29 22l2.14-2.14 1.43 1.43 1.43-1.43-1.43-1.43L22 16.29z"})})})]}),e.jsxs("div",{className:"pb-cb-card-info",children:[e.jsx("h4",{className:"pb-cb-card-name",children:s}),e.jsxs("div",{className:"pb-cb-card-value",children:[a.weight,"kg × ",a.reps]}),a.achievedAt&&e.jsx("div",{className:"pb-cb-card-date",children:(a.achievedAt.toDate?a.achievedAt.toDate():new Date(a.achievedAt)).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"})}),l&&!v&&e.jsxs("div",{className:"pb-cb-target-info",children:["Target: ",l.targetWeight,"kg (",Math.round((d||0)*100),"%)"]}),l&&v&&!V&&e.jsx("div",{className:"pb-cb-target-info hit",children:"Target hit!"}),V&&e.jsx("div",{className:"pb-cb-target-info earned",children:"Badge earned!"})]}),e.jsx("div",{className:"pb-cb-card-action",children:l?v&&V?e.jsx("button",{className:"pb-cb-target-btn",onClick:()=>{S(s),at("")},children:e.jsx("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{d:"M12 5v14M5 12h14"})})}):null:e.jsx("button",{className:"pb-cb-target-btn",onClick:()=>{S(s),at("")},children:e.jsxs("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("circle",{cx:"12",cy:"12",r:"6"}),e.jsx("circle",{cx:"12",cy:"12",r:"2"})]})})})]},s)})}),Object.keys(ke).length>0&&e.jsxs("button",{className:"pb-cb-achievements-link",onClick:()=>me("/client/core-buddy/achievements"),children:[e.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"18",height:"18",children:e.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),"View Achievements",e.jsx("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{d:"M9 18l6-6-6-6"})})]}),ie&&e.jsx("div",{className:"pb-cb-target-modal-overlay",onClick:()=>S(null),children:e.jsxs("div",{className:"pb-cb-target-modal",onClick:s=>s.stopPropagation(),children:[e.jsx("h3",{children:"Set Target"}),e.jsx("p",{className:"pb-cb-target-exercise-name",children:ie}),e.jsxs("div",{className:"pb-cb-target-current",children:["Current PB: ",e.jsxs("strong",{children:[ke[ie]?.weight,"kg"]})]}),e.jsxs("div",{className:"pb-cb-target-input-wrap",children:[e.jsx("label",{children:"Your target (kg)"}),e.jsx("input",{type:"number",inputMode:"decimal",step:"0.5",value:We,onChange:s=>at(s.target.value),placeholder:String((ke[ie]?.weight||0)+5),className:"pb-cb-target-input",autoFocus:!0})]}),e.jsxs("div",{className:"pb-cb-target-actions",children:[e.jsx("button",{className:"pb-cancel-btn",onClick:()=>S(null),children:"Cancel"}),e.jsx("button",{className:"pb-save-btn",onClick:vt,disabled:T,children:T?"Saving...":"Set Target"})]})]})})]}),te&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"pb-tabs",children:[e.jsx("button",{className:`pb-tab ${p==="bests"?"active":""}`,onClick:()=>m("bests"),children:"Strength"}),e.jsx("button",{className:`pb-tab ${p==="metrics"?"active":""}`,onClick:()=>m("metrics"),children:"Body Metrics"}),e.jsx("button",{className:`pb-tab ${p==="history"?"active":""}`,onClick:()=>m("history"),children:"History"})]}),p==="bests"&&e.jsxs("div",{className:"pb-strength-section",children:[!ae&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"pb-carousel",ref:fe,onTouchStart:ot,onTouchMove:wt,onTouchEnd:t,children:[e.jsx("div",{className:`pb-ring-container slide-from-${q.current}`,children:e.jsxs("div",{className:"pb-ring",children:[e.jsx("svg",{className:"pb-ring-svg",viewBox:"0 0 200 200",children:At.map((s,a)=>{const i=a<Math.round(Et);return e.jsx("line",{x1:s.x1,y1:s.y1,x2:s.x2,y2:s.y2,className:`pb-ring-tick ${i?Ct?"hit":"filled":"empty"}`,strokeWidth:s.thick?"3":"2"},a)})}),e.jsxs("div",{className:"pb-ring-center",children:[e.jsx("div",{className:"pb-ring-category",children:n.category}),e.jsxs("div",{className:"pb-ring-exercise",children:[n.name,ze("strength",n.key)&&e.jsx("svg",{className:"pb-badge-icon",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})]}),e.jsx("div",{className:"pb-ring-value",children:j?n.unit==="time"?xt(j.time):St(j.weight,j.reps):"-"}),b!==null&&e.jsxs("div",{className:`pb-ring-change ${b>=0?"positive":"negative"}`,children:[b>=0?"+":"",b.toFixed(1),"%"]}),b===null&&j&&e.jsx("div",{className:"pb-ring-change neutral",children:"New entry"}),Ce&&e.jsx("div",{className:`pb-ring-target ${Ct?"hit":""}`,children:Ct?"Target hit!":Ce.targetType==="time"?`${Ce.startValue||0}s → ${Ce.targetValue}s`:`${Ce.startWeight||0}kg×${Ce.startReps||0} → ${Ce.targetWeight}kg×${Ce.targetReps}`}),!Ce&&e.jsx("div",{className:"pb-ring-target none",children:"No target set"})]})]})},$),e.jsx("div",{className:"pb-carousel-dots",children:ue.map((s,a)=>e.jsx("button",{className:`pb-dot ${a===$?"active":""}`,onClick:()=>M(a)},a))}),e.jsx("button",{className:"pb-carousel-arrow left",onClick:()=>M($-1),disabled:$===0,children:e.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"})})}),e.jsx("button",{className:"pb-carousel-arrow right",onClick:()=>M($+1),disabled:$===ue.length-1,children:e.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M8.59 16.59L10 18l6-6-6-6-1.41 1.41L13.17 12z"})})})]}),e.jsxs("div",{className:"pb-trend-section",children:[e.jsx("h4",{children:"Trend"}),e.jsx(Ut,{data:g,exerciseKey:n.key,unit:n.unit})]})]}),!ae&&!ge&&e.jsxs("div",{className:"pb-action-buttons",children:[e.jsx("button",{className:"pb-edit-btn",onClick:()=>P(!0),children:W?.benchmarks?"Edit This Month's Benchmarks":"Add This Month's Benchmarks"}),e.jsx("button",{className:"pb-edit-btn pb-target-btn",onClick:()=>k(!0),children:Object.keys(F).length>0?"Edit Targets":"Set Targets"}),(Object.keys(F).length>0||Object.keys(E).length>0)&&e.jsx("button",{className:"pb-edit-btn pb-reset-btn",onClick:gt,disabled:T,children:"Reset All Goals"})]}),ae&&e.jsxs("div",{className:"pb-edit-card",children:[e.jsxs("div",{className:"pb-edit-header",children:[e.jsxs("h3",{children:["Benchmarks - ",oe(ee)]}),e.jsx("button",{className:"pb-edit-close",onClick:()=>{P(!1),G(W?.benchmarks||{})},children:"×"})]}),e.jsx("div",{className:"pb-edit-body",children:ue.map(s=>e.jsxs("div",{className:"pb-edit-exercise",children:[e.jsx("div",{className:"pb-edit-exercise-name",children:s.name}),s.unit==="weight"?e.jsxs("div",{className:"pb-edit-row",children:[e.jsxs("div",{className:"pb-edit-field",children:[e.jsx("label",{children:"Weight (kg)"}),e.jsx("input",{type:"number",step:"0.5",value:x[s.key]?.weight??"",onChange:a=>we(s.key,"weight",a.target.value),placeholder:"0"})]}),e.jsxs("div",{className:"pb-edit-field",children:[e.jsx("label",{children:"Reps"}),e.jsx("input",{type:"number",value:x[s.key]?.reps??"",onChange:a=>we(s.key,"reps",a.target.value),placeholder:"0"})]})]}):e.jsx("div",{className:"pb-edit-row",children:e.jsxs("div",{className:"pb-edit-field full",children:[e.jsx("label",{children:"Time (seconds)"}),e.jsx("input",{type:"number",step:"0.01",value:x[s.key]?.time??"",onChange:a=>we(s.key,"time",a.target.value),placeholder:"0"})]})})]},s.key))}),e.jsxs("div",{className:"pb-edit-actions",children:[e.jsx("button",{className:"pb-cancel-btn",onClick:()=>{P(!1),G(W?.benchmarks||{})},children:"Cancel"}),e.jsx("button",{className:"pb-save-btn",onClick:ct,disabled:T,children:T?"Saving...":"Save"})]})]}),ge&&e.jsxs("div",{className:"pb-edit-card",children:[e.jsxs("div",{className:"pb-edit-header",children:[e.jsx("h3",{children:"Set Your Targets"}),e.jsx("button",{className:"pb-edit-close",onClick:()=>{k(!1),Q(F)},children:"×"})]}),e.jsxs("div",{className:"pb-edit-body",children:[e.jsx("p",{className:"pb-target-hint",children:"Set a target for each exercise. Your current best is captured automatically from your latest benchmarks."}),ue.map(s=>{const a=W?.benchmarks?.[s.key];let i="-";return a&&(s.unit==="time"&&a.time?i=`${a.time}s`:(a.weight||a.reps)&&(i=`${a.weight||0}kg × ${a.reps||0}`)),e.jsxs("div",{className:"pb-edit-exercise",children:[e.jsxs("div",{className:"pb-edit-exercise-header",children:[e.jsx("div",{className:"pb-edit-exercise-name",children:s.name}),e.jsxs("div",{className:"pb-edit-current-best",children:["Current: ",i]})]}),s.unit==="weight"?e.jsxs("div",{className:"pb-edit-row",children:[e.jsxs("div",{className:"pb-edit-field",children:[e.jsx("label",{children:"Target Weight (kg)"}),e.jsx("input",{type:"number",step:"0.5",value:B[s.key]?.targetWeight??"",onChange:l=>He(s.key,"targetWeight",l.target.value),placeholder:"0"})]}),e.jsxs("div",{className:"pb-edit-field",children:[e.jsx("label",{children:"Target Reps"}),e.jsx("input",{type:"number",value:B[s.key]?.targetReps??"",onChange:l=>He(s.key,"targetReps",l.target.value),placeholder:"0"})]})]}):e.jsx("div",{className:"pb-edit-row",children:e.jsxs("div",{className:"pb-edit-field full",children:[e.jsx("label",{children:"Target (seconds)"}),e.jsx("input",{type:"number",step:"1",value:B[s.key]?.targetValue??"",onChange:l=>He(s.key,"targetValue",l.target.value),placeholder:"0"})]})})]},s.key)})]}),e.jsxs("div",{className:"pb-edit-actions",children:[e.jsx("button",{className:"pb-cancel-btn",onClick:()=>{k(!1),Q(F)},children:"Cancel"}),e.jsx("button",{className:"pb-save-btn",onClick:ft,disabled:T,children:T?"Saving...":"Save Targets"})]})]})]}),p==="metrics"&&e.jsxs("div",{className:"pb-metrics-section",children:[!I&&!Qe&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"pb-metrics-card",children:[e.jsx("h3",{children:"Body Measurements"}),e.jsx("p",{className:"pb-metrics-month",children:oe(ee)}),e.jsx("div",{className:"pb-metrics-list",children:De.map(s=>{const a=W?.bodyMetrics?.[s.key],i=r(s.key),l=E[s.key],d=Nt(s.key),v=d!==null&&d>=1;return e.jsxs("div",{className:"pb-metric-row",children:[e.jsxs("div",{className:"pb-metric-top",children:[e.jsxs("div",{className:"pb-metric-left",children:[e.jsxs("span",{className:"pb-metric-name",children:[s.name,ze("metric",s.key)&&e.jsx("svg",{className:"pb-badge-icon-sm",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})]}),l&&e.jsxs("span",{className:"pb-metric-target-label",children:["Target: ",l.targetValue," ",s.suffix]})]}),e.jsxs("div",{className:"pb-metric-values",children:[e.jsx("span",{className:"pb-metric-current",children:a!=null?`${a} ${s.suffix}`:"-"}),i!==null&&e.jsxs("span",{className:`pb-metric-change ${i>0?"up":i<0?"down":"same"}`,children:[i>0?"+":"",i," ",s.suffix]})]})]}),d!==null&&e.jsxs("div",{className:"pb-metric-progress",children:[e.jsx("div",{className:"pb-metric-bar",children:e.jsx("div",{className:`pb-metric-bar-fill ${v?"hit":""}`,style:{width:`${Math.round(d*100)}%`}})}),e.jsx("span",{className:`pb-metric-percent ${v?"hit":""}`,children:v?"Hit!":`${Math.round(d*100)}%`})]})]},s.key)})})]}),e.jsxs("div",{className:"pb-action-buttons",children:[e.jsx("button",{className:"pb-edit-btn",onClick:()=>Y(!0),children:W?.bodyMetrics?"Edit This Month's Measurements":"Add This Month's Measurements"}),e.jsx("button",{className:"pb-edit-btn pb-target-btn",onClick:()=>be(!0),children:Object.keys(E).length>0?"Edit Targets":"Set Targets"}),(Object.keys(F).length>0||Object.keys(E).length>0)&&e.jsx("button",{className:"pb-edit-btn pb-reset-btn",onClick:gt,disabled:T,children:"Reset All Goals"})]})]}),I&&e.jsxs("div",{className:"pb-edit-card",children:[e.jsxs("div",{className:"pb-edit-header",children:[e.jsxs("h3",{children:["Measurements - ",oe(ee)]}),e.jsx("button",{className:"pb-edit-close",onClick:()=>{Y(!1),re(W?.bodyMetrics||{})},children:"×"})]}),e.jsx("div",{className:"pb-edit-body",children:De.map(s=>e.jsx("div",{className:"pb-edit-metric",children:e.jsxs("div",{className:"pb-edit-field full",children:[e.jsxs("label",{children:[s.name," (",s.suffix,")"]}),e.jsx("input",{type:"number",step:"0.1",value:J[s.key]??"",onChange:a=>kt(s.key,a.target.value),placeholder:"0"})]})},s.key))}),e.jsxs("div",{className:"pb-edit-actions",children:[e.jsx("button",{className:"pb-cancel-btn",onClick:()=>{Y(!1),re(W?.bodyMetrics||{})},children:"Cancel"}),e.jsx("button",{className:"pb-save-btn",onClick:X,disabled:T,children:T?"Saving...":"Save"})]})]}),Qe&&e.jsxs("div",{className:"pb-edit-card",children:[e.jsxs("div",{className:"pb-edit-header",children:[e.jsx("h3",{children:"Body Metric Targets"}),e.jsx("button",{className:"pb-edit-close",onClick:()=>{be(!1),Z(E)},children:"×"})]}),e.jsxs("div",{className:"pb-edit-body",children:[e.jsx("p",{className:"pb-target-hint",children:"Set targets for your body measurements. Your current measurement is captured automatically."}),De.map(s=>{const a=W?.bodyMetrics?.[s.key];return e.jsxs("div",{className:"pb-edit-exercise",children:[e.jsxs("div",{className:"pb-edit-exercise-header",children:[e.jsx("div",{className:"pb-edit-exercise-name",children:s.name}),e.jsxs("div",{className:"pb-edit-current-best",children:["Current: ",a!=null?`${a} ${s.suffix}`:"-"]})]}),e.jsx("div",{className:"pb-edit-row",children:e.jsxs("div",{className:"pb-edit-field full",children:[e.jsxs("label",{children:["Target (",s.suffix,")"]}),e.jsx("input",{type:"number",step:"0.1",value:Se[s.key]?.targetValue??"",onChange:i=>Ee(s.key,i.target.value),placeholder:"0"})]})})]},s.key)})]}),e.jsxs("div",{className:"pb-edit-actions",children:[e.jsx("button",{className:"pb-cancel-btn",onClick:()=>{be(!1),Z(E)},children:"Cancel"}),e.jsx("button",{className:"pb-save-btn",onClick:_e,disabled:T,children:T?"Saving...":"Save Targets"})]})]})]}),p==="history"&&e.jsx("div",{className:"pb-history-section",children:g.length===0?e.jsxs("div",{className:"pb-empty",children:[e.jsx("h4",{children:"No records yet"}),e.jsx("p",{children:"Start adding your monthly benchmarks and measurements to track your progress over time."})]}):e.jsxs(e.Fragment,{children:[R.length>0&&e.jsxs("div",{className:"pb-achievements-wall",children:[e.jsxs("h4",{className:"pb-achievements-wall-title",children:[e.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"18",height:"18",children:e.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),"Targets Achieved"]}),e.jsx("div",{className:"pb-achievements-list",children:[...R].reverse().map((s,a)=>e.jsxs("div",{className:"pb-achievement-item",style:{animationDelay:`${a*.05}s`},children:[e.jsx("div",{className:"pb-achievement-star",children:e.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),e.jsxs("div",{className:"pb-achievement-info",children:[e.jsx("span",{className:"pb-achievement-label",children:s.label}),e.jsx("span",{className:"pb-achievement-date",children:oe(s.achievedMonth)})]})]},a))})]}),e.jsx("div",{className:"pb-history-controls",children:e.jsx("button",{className:`pb-compare-toggle ${ne?"active":""}`,onClick:()=>{jt(!ne),!ne&&g.length>=2&&(Ke(g[0].month),et(g[g.length-1].month))},children:ne?"Back to Timeline":"Compare Months"})}),ne?e.jsxs("div",{className:"pb-compare",children:[e.jsxs("div",{className:"pb-compare-selectors",children:[e.jsxs("div",{className:"pb-compare-select",children:[e.jsx("label",{children:"From"}),e.jsx("select",{value:ve,onChange:s=>Ke(s.target.value),children:g.map(s=>e.jsx("option",{value:s.month,children:oe(s.month)},s.month))})]}),e.jsx("div",{className:"pb-compare-vs",children:"vs"}),e.jsxs("div",{className:"pb-compare-select",children:[e.jsx("label",{children:"To"}),e.jsx("select",{value:ye,onChange:s=>et(s.target.value),children:g.map(s=>e.jsx("option",{value:s.month,children:oe(s.month)},s.month))})]})]}),c&&o&&e.jsxs("div",{className:"pb-compare-results",children:[e.jsxs("div",{className:"pb-compare-group",children:[e.jsx("h4",{children:"Strength Benchmarks"}),e.jsxs("div",{className:"pb-compare-table",children:[e.jsxs("div",{className:"pb-compare-header-row",children:[e.jsx("span",{children:"Exercise"}),e.jsx("span",{children:oe(ve).split(" ")[0]}),e.jsx("span",{children:oe(ye).split(" ")[0]}),e.jsx("span",{children:"Change"})]}),ue.map(s=>{const a=c.benchmarks?.[s.key],i=o.benchmarks?.[s.key],l=Ge(s,a),d=Ge(s,i),v=Bt(d,l);return e.jsxs("div",{className:"pb-compare-row",children:[e.jsx("span",{className:"pb-compare-name",children:s.name}),e.jsx("span",{className:"pb-compare-val",children:a?s.unit==="time"?xt(a.time):`${a.weight}x${a.reps}`:"-"}),e.jsx("span",{className:"pb-compare-val",children:i?s.unit==="time"?xt(i.time):`${i.weight}x${i.reps}`:"-"}),e.jsx("span",{className:`pb-compare-change ${v!==null?v>=0?"positive":"negative":""}`,children:v!==null?`${v>=0?"+":""}${v.toFixed(1)}%`:"-"})]},s.key)})]})]}),e.jsxs("div",{className:"pb-compare-group",children:[e.jsx("h4",{children:"Body Measurements"}),e.jsxs("div",{className:"pb-compare-table",children:[e.jsxs("div",{className:"pb-compare-header-row",children:[e.jsx("span",{children:"Measurement"}),e.jsx("span",{children:oe(ve).split(" ")[0]}),e.jsx("span",{children:oe(ye).split(" ")[0]}),e.jsx("span",{children:"Change"})]}),De.map(s=>{const a=c.bodyMetrics?.[s.key],i=o.bodyMetrics?.[s.key],l=a!=null&&i!=null?parseFloat((i-a).toFixed(2)):null;return e.jsxs("div",{className:"pb-compare-row",children:[e.jsx("span",{className:"pb-compare-name",children:s.name}),e.jsx("span",{className:"pb-compare-val",children:a!=null?`${a}`:"-"}),e.jsx("span",{className:"pb-compare-val",children:i!=null?`${i}`:"-"}),e.jsx("span",{className:`pb-compare-change ${l!==null?l>0?"positive":l<0?"negative":"neutral":""}`,children:l!==null?`${l>0?"+":""}${l} ${s.suffix}`:"-"})]},s.key)})]})]})]})]}):e.jsx("div",{className:"pb-timeline",children:[...g].reverse().map((s,a)=>{const i=g.find(l=>l.month<s.month&&g.indexOf(l)===g.indexOf(s)-1)||g.filter(l=>l.month<s.month).pop();return e.jsxs("div",{className:"pb-timeline-item",style:{animationDelay:`${a*.05}s`},children:[e.jsx("div",{className:"pb-timeline-dot"}),e.jsxs("div",{className:"pb-timeline-card",children:[e.jsx("h4",{children:oe(s.month)}),s.benchmarks&&Object.keys(s.benchmarks).length>0&&e.jsxs("div",{className:"pb-timeline-group",children:[e.jsx("h5",{children:"Strength Benchmarks"}),ue.map(l=>{const d=s.benchmarks[l.key];if(!d)return null;const v=i?.benchmarks?.[l.key],V=Ge(l,d),C=Ge(l,v),f=Bt(V,C);return e.jsxs("div",{className:"pb-timeline-row",children:[e.jsx("span",{className:"pb-timeline-label",children:l.name}),e.jsxs("div",{className:"pb-timeline-values",children:[e.jsx("span",{className:"pb-timeline-value",children:l.unit==="time"?xt(d.time):St(d.weight,d.reps)}),f!==null&&e.jsxs("span",{className:`pb-timeline-change ${f>=0?"positive":"negative"}`,children:[f>=0?"+":"",f.toFixed(1),"%"]})]})]},l.key)})]}),s.bodyMetrics&&Object.keys(s.bodyMetrics).length>0&&e.jsxs("div",{className:"pb-timeline-group",children:[e.jsx("h5",{children:"Body Measurements"}),De.map(l=>{const d=s.bodyMetrics[l.key];if(d==null)return null;const v=i?.bodyMetrics?.[l.key],V=v!=null?parseFloat((d-v).toFixed(2)):null;return e.jsxs("div",{className:"pb-timeline-row",children:[e.jsx("span",{className:"pb-timeline-label",children:l.name}),e.jsxs("div",{className:"pb-timeline-values",children:[e.jsxs("span",{className:"pb-timeline-value",children:[d," ",l.suffix]}),V!==null&&e.jsxs("span",{className:`pb-timeline-change ${V>0?"positive":V<0?"negative":"neutral"}`,children:[V>0?"+":"",V," ",l.suffix]})]})]},l.key)})]})]})]},s.id)})})]})})]})]}),xe&&e.jsx("div",{className:"pb-celebration-overlay",onClick:()=>Le(null),children:e.jsxs("div",{className:"pb-celebration-card",children:[e.jsx("div",{className:"pb-celebration-icon",children:e.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),e.jsx("h3",{className:"pb-celebration-title",children:xe.length===1?"Target Achieved!":`${xe.length} Targets Achieved!`}),e.jsx("div",{className:"pb-celebration-badges",children:xe.map((s,a)=>e.jsx("div",{className:"pb-celebration-badge",children:s.label},a))}),e.jsx("p",{className:"pb-celebration-sub",children:"Tap to dismiss"})]})}),je&&e.jsxs("div",{className:`toast-notification ${je.type}`,children:[e.jsx("span",{className:"toast-icon",children:je.type==="success"?e.jsx("svg",{className:"success-check-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("path",{className:"check-path",d:"M5 13 L9 17 L19 7"})}):e.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[e.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),e.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})}),e.jsx("span",{className:"toast-message",children:je.message}),e.jsx("button",{className:"toast-close",onClick:()=>Re(null),children:"×"})]}),te&&e.jsxs("nav",{className:"block-bottom-nav",children:[e.jsxs("button",{className:"block-nav-tab",onClick:()=>me("/client"),children:[e.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}),e.jsx("polyline",{points:"9 22 9 12 15 12 15 22"})]}),e.jsx("span",{children:"Home"})]}),e.jsxs("button",{className:"block-nav-tab",onClick:()=>me("/client/forms"),children:[e.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),e.jsx("polyline",{points:"14 2 14 8 20 8"}),e.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),e.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"})]}),e.jsx("span",{children:"Forms"})]}),e.jsxs("button",{className:"block-nav-tab",onClick:()=>me("/client/tools"),children:[e.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"})}),e.jsx("span",{children:"Tools"})]}),e.jsxs("button",{className:"block-nav-tab active",children:[e.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M12 20V10"}),e.jsx("path",{d:"M18 20V4"}),e.jsx("path",{d:"M6 20v-4"})]}),e.jsx("span",{children:"PBs"})]}),N?.circuitAccess&&e.jsxs("button",{className:"block-nav-tab",onClick:()=>me("/client/circuit"),children:[e.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("path",{d:"M12 6v6l4 2"})]}),e.jsx("span",{children:"Circuit"})]})]}),rt&&e.jsx(It,{active:"progress"})]})}export{Jt as default};
