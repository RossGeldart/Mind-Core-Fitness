const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Dashboard-CynWfaRo.js","assets/scheduleUtils-BAUZ6756.js","assets/Dashboard-Cd6_Unan.css","assets/AddClient-Duzc89tF.js","assets/AddClient-DH1OFzHo.css","assets/ClientDashboard-B7Bs4uRW.js","assets/ClientForms-T3q7URiU.js","assets/ClientForms-GDNtnrAx.css","assets/ClientTools-aO1NLFV6.js","assets/ClientTools-DQRPoST3.css","assets/MacroCalculator-CwmqqbUc.js","assets/ProteinSnacks-DQIF4oP_.js","assets/DailyMotivation-CTIDI4qE.js","assets/CircuitDashboard-oQvFUlAQ.js","assets/CircuitDashboard-C8T0uect.css","assets/CircuitBooking-BJEsggik.js","assets/CircuitBooking-ruk9Q4Wj.css","assets/Leaderboard-Dccg1RGT.js","assets/Leaderboard-Dq-r5svP.css","assets/UpgradePage-CLcaE5Q9.js","assets/UpgradePage-Blt11CID.css","assets/Onboarding-HsVeyEQm.js","assets/Onboarding-Bku4iVdQ.css"])))=>i.map(i=>d[i]);
(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))i(l);new MutationObserver(l=>{for(const u of l)if(u.type==="childList")for(const d of u.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&i(d)}).observe(document,{childList:!0,subtree:!0});function t(l){const u={};return l.integrity&&(u.integrity=l.integrity),l.referrerPolicy&&(u.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?u.credentials="include":l.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function i(l){if(l.ep)return;l.ep=!0;const u=t(l);fetch(l.href,u)}})();var yp={exports:{}},Kc={};var _1;function kT(){if(_1)return Kc;_1=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(i,l,u){var d=null;if(u!==void 0&&(d=""+u),l.key!==void 0&&(d=""+l.key),"key"in l){u={};for(var p in l)p!=="key"&&(u[p]=l[p])}else u=l;return l=u.ref,{$$typeof:n,type:i,key:d,ref:l!==void 0?l:null,props:u}}return Kc.Fragment=e,Kc.jsx=t,Kc.jsxs=t,Kc}var k1;function jT(){return k1||(k1=1,yp.exports=kT()),yp.exports}var r=jT(),bp={exports:{}},Zt={};var j1;function TT(){if(j1)return Zt;j1=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),l=Symbol.for("react.profiler"),u=Symbol.for("react.consumer"),d=Symbol.for("react.context"),p=Symbol.for("react.forward_ref"),g=Symbol.for("react.suspense"),y=Symbol.for("react.memo"),x=Symbol.for("react.lazy"),k=Symbol.for("react.activity"),T=Symbol.iterator;function O(L){return L===null||typeof L!="object"?null:(L=T&&L[T]||L["@@iterator"],typeof L=="function"?L:null)}var G={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},F=Object.assign,V={};function te(L,ne,Ie){this.props=L,this.context=ne,this.refs=V,this.updater=Ie||G}te.prototype.isReactComponent={},te.prototype.setState=function(L,ne){if(typeof L!="object"&&typeof L!="function"&&L!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,L,ne,"setState")},te.prototype.forceUpdate=function(L){this.updater.enqueueForceUpdate(this,L,"forceUpdate")};function Y(){}Y.prototype=te.prototype;function ie(L,ne,Ie){this.props=L,this.context=ne,this.refs=V,this.updater=Ie||G}var he=ie.prototype=new Y;he.constructor=ie,F(he,te.prototype),he.isPureReactComponent=!0;var Ne=Array.isArray;function fe(){}var R={H:null,A:null,T:null,S:null},E=Object.prototype.hasOwnProperty;function M(L,ne,Ie){var de=Ie.ref;return{$$typeof:n,type:L,key:ne,ref:de!==void 0?de:null,props:Ie}}function B(L,ne){return M(L.type,ne,L.props)}function D(L){return typeof L=="object"&&L!==null&&L.$$typeof===n}function H(L){var ne={"=":"=0",":":"=2"};return"$"+L.replace(/[=:]/g,function(Ie){return ne[Ie]})}var I=/\/+/g;function ze(L,ne){return typeof L=="object"&&L!==null&&L.key!=null?H(""+L.key):ne.toString(36)}function mt(L){switch(L.status){case"fulfilled":return L.value;case"rejected":throw L.reason;default:switch(typeof L.status=="string"?L.then(fe,fe):(L.status="pending",L.then(function(ne){L.status==="pending"&&(L.status="fulfilled",L.value=ne)},function(ne){L.status==="pending"&&(L.status="rejected",L.reason=ne)})),L.status){case"fulfilled":return L.value;case"rejected":throw L.reason}}throw L}function W(L,ne,Ie,de,qe){var Me=typeof L;(Me==="undefined"||Me==="boolean")&&(L=null);var ot=!1;if(L===null)ot=!0;else switch(Me){case"bigint":case"string":case"number":ot=!0;break;case"object":switch(L.$$typeof){case n:case e:ot=!0;break;case x:return ot=L._init,W(ot(L._payload),ne,Ie,de,qe)}}if(ot)return qe=qe(L),ot=de===""?"."+ze(L,0):de,Ne(qe)?(Ie="",ot!=null&&(Ie=ot.replace(I,"$&/")+"/"),W(qe,ne,Ie,"",function(Vt){return Vt})):qe!=null&&(D(qe)&&(qe=B(qe,Ie+(qe.key==null||L&&L.key===qe.key?"":(""+qe.key).replace(I,"$&/")+"/")+ot)),ne.push(qe)),1;ot=0;var ft=de===""?".":de+":";if(Ne(L))for(var Qe=0;Qe<L.length;Qe++)de=L[Qe],Me=ft+ze(de,Qe),ot+=W(de,ne,Ie,Me,qe);else if(Qe=O(L),typeof Qe=="function")for(L=Qe.call(L),Qe=0;!(de=L.next()).done;)de=de.value,Me=ft+ze(de,Qe++),ot+=W(de,ne,Ie,Me,qe);else if(Me==="object"){if(typeof L.then=="function")return W(mt(L),ne,Ie,de,qe);throw ne=String(L),Error("Objects are not valid as a React child (found: "+(ne==="[object Object]"?"object with keys {"+Object.keys(L).join(", ")+"}":ne)+"). If you meant to render a collection of children, use an array instead.")}return ot}function ue(L,ne,Ie){if(L==null)return L;var de=[],qe=0;return W(L,de,"","",function(Me){return ne.call(Ie,Me,qe++)}),de}function Re(L){if(L._status===-1){var ne=L._result;ne=ne(),ne.then(function(Ie){(L._status===0||L._status===-1)&&(L._status=1,L._result=Ie)},function(Ie){(L._status===0||L._status===-1)&&(L._status=2,L._result=Ie)}),L._status===-1&&(L._status=0,L._result=ne)}if(L._status===1)return L._result.default;throw L._result}var Le=typeof reportError=="function"?reportError:function(L){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var ne=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof L=="object"&&L!==null&&typeof L.message=="string"?String(L.message):String(L),error:L});if(!window.dispatchEvent(ne))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",L);return}console.error(L)},Z={map:ue,forEach:function(L,ne,Ie){ue(L,function(){ne.apply(this,arguments)},Ie)},count:function(L){var ne=0;return ue(L,function(){ne++}),ne},toArray:function(L){return ue(L,function(ne){return ne})||[]},only:function(L){if(!D(L))throw Error("React.Children.only expected to receive a single React element child.");return L}};return Zt.Activity=k,Zt.Children=Z,Zt.Component=te,Zt.Fragment=t,Zt.Profiler=l,Zt.PureComponent=ie,Zt.StrictMode=i,Zt.Suspense=g,Zt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=R,Zt.__COMPILER_RUNTIME={__proto__:null,c:function(L){return R.H.useMemoCache(L)}},Zt.cache=function(L){return function(){return L.apply(null,arguments)}},Zt.cacheSignal=function(){return null},Zt.cloneElement=function(L,ne,Ie){if(L==null)throw Error("The argument must be a React element, but you passed "+L+".");var de=F({},L.props),qe=L.key;if(ne!=null)for(Me in ne.key!==void 0&&(qe=""+ne.key),ne)!E.call(ne,Me)||Me==="key"||Me==="__self"||Me==="__source"||Me==="ref"&&ne.ref===void 0||(de[Me]=ne[Me]);var Me=arguments.length-2;if(Me===1)de.children=Ie;else if(1<Me){for(var ot=Array(Me),ft=0;ft<Me;ft++)ot[ft]=arguments[ft+2];de.children=ot}return M(L.type,qe,de)},Zt.createContext=function(L){return L={$$typeof:d,_currentValue:L,_currentValue2:L,_threadCount:0,Provider:null,Consumer:null},L.Provider=L,L.Consumer={$$typeof:u,_context:L},L},Zt.createElement=function(L,ne,Ie){var de,qe={},Me=null;if(ne!=null)for(de in ne.key!==void 0&&(Me=""+ne.key),ne)E.call(ne,de)&&de!=="key"&&de!=="__self"&&de!=="__source"&&(qe[de]=ne[de]);var ot=arguments.length-2;if(ot===1)qe.children=Ie;else if(1<ot){for(var ft=Array(ot),Qe=0;Qe<ot;Qe++)ft[Qe]=arguments[Qe+2];qe.children=ft}if(L&&L.defaultProps)for(de in ot=L.defaultProps,ot)qe[de]===void 0&&(qe[de]=ot[de]);return M(L,Me,qe)},Zt.createRef=function(){return{current:null}},Zt.forwardRef=function(L){return{$$typeof:p,render:L}},Zt.isValidElement=D,Zt.lazy=function(L){return{$$typeof:x,_payload:{_status:-1,_result:L},_init:Re}},Zt.memo=function(L,ne){return{$$typeof:y,type:L,compare:ne===void 0?null:ne}},Zt.startTransition=function(L){var ne=R.T,Ie={};R.T=Ie;try{var de=L(),qe=R.S;qe!==null&&qe(Ie,de),typeof de=="object"&&de!==null&&typeof de.then=="function"&&de.then(fe,Le)}catch(Me){Le(Me)}finally{ne!==null&&Ie.types!==null&&(ne.types=Ie.types),R.T=ne}},Zt.unstable_useCacheRefresh=function(){return R.H.useCacheRefresh()},Zt.use=function(L){return R.H.use(L)},Zt.useActionState=function(L,ne,Ie){return R.H.useActionState(L,ne,Ie)},Zt.useCallback=function(L,ne){return R.H.useCallback(L,ne)},Zt.useContext=function(L){return R.H.useContext(L)},Zt.useDebugValue=function(){},Zt.useDeferredValue=function(L,ne){return R.H.useDeferredValue(L,ne)},Zt.useEffect=function(L,ne){return R.H.useEffect(L,ne)},Zt.useEffectEvent=function(L){return R.H.useEffectEvent(L)},Zt.useId=function(){return R.H.useId()},Zt.useImperativeHandle=function(L,ne,Ie){return R.H.useImperativeHandle(L,ne,Ie)},Zt.useInsertionEffect=function(L,ne){return R.H.useInsertionEffect(L,ne)},Zt.useLayoutEffect=function(L,ne){return R.H.useLayoutEffect(L,ne)},Zt.useMemo=function(L,ne){return R.H.useMemo(L,ne)},Zt.useOptimistic=function(L,ne){return R.H.useOptimistic(L,ne)},Zt.useReducer=function(L,ne,Ie){return R.H.useReducer(L,ne,Ie)},Zt.useRef=function(L){return R.H.useRef(L)},Zt.useState=function(L){return R.H.useState(L)},Zt.useSyncExternalStore=function(L,ne,Ie){return R.H.useSyncExternalStore(L,ne,Ie)},Zt.useTransition=function(){return R.H.useTransition()},Zt.version="19.2.4",Zt}var T1;function Pg(){return T1||(T1=1,bp.exports=TT()),bp.exports}var v=Pg(),vp={exports:{}},Yc={},xp={exports:{}},wp={};var E1;function ET(){return E1||(E1=1,(function(n){function e(W,ue){var Re=W.length;W.push(ue);e:for(;0<Re;){var Le=Re-1>>>1,Z=W[Le];if(0<l(Z,ue))W[Le]=ue,W[Re]=Z,Re=Le;else break e}}function t(W){return W.length===0?null:W[0]}function i(W){if(W.length===0)return null;var ue=W[0],Re=W.pop();if(Re!==ue){W[0]=Re;e:for(var Le=0,Z=W.length,L=Z>>>1;Le<L;){var ne=2*(Le+1)-1,Ie=W[ne],de=ne+1,qe=W[de];if(0>l(Ie,Re))de<Z&&0>l(qe,Ie)?(W[Le]=qe,W[de]=Re,Le=de):(W[Le]=Ie,W[ne]=Re,Le=ne);else if(de<Z&&0>l(qe,Re))W[Le]=qe,W[de]=Re,Le=de;else break e}}return ue}function l(W,ue){var Re=W.sortIndex-ue.sortIndex;return Re!==0?Re:W.id-ue.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var u=performance;n.unstable_now=function(){return u.now()}}else{var d=Date,p=d.now();n.unstable_now=function(){return d.now()-p}}var g=[],y=[],x=1,k=null,T=3,O=!1,G=!1,F=!1,V=!1,te=typeof setTimeout=="function"?setTimeout:null,Y=typeof clearTimeout=="function"?clearTimeout:null,ie=typeof setImmediate<"u"?setImmediate:null;function he(W){for(var ue=t(y);ue!==null;){if(ue.callback===null)i(y);else if(ue.startTime<=W)i(y),ue.sortIndex=ue.expirationTime,e(g,ue);else break;ue=t(y)}}function Ne(W){if(F=!1,he(W),!G)if(t(g)!==null)G=!0,fe||(fe=!0,H());else{var ue=t(y);ue!==null&&mt(Ne,ue.startTime-W)}}var fe=!1,R=-1,E=5,M=-1;function B(){return V?!0:!(n.unstable_now()-M<E)}function D(){if(V=!1,fe){var W=n.unstable_now();M=W;var ue=!0;try{e:{G=!1,F&&(F=!1,Y(R),R=-1),O=!0;var Re=T;try{t:{for(he(W),k=t(g);k!==null&&!(k.expirationTime>W&&B());){var Le=k.callback;if(typeof Le=="function"){k.callback=null,T=k.priorityLevel;var Z=Le(k.expirationTime<=W);if(W=n.unstable_now(),typeof Z=="function"){k.callback=Z,he(W),ue=!0;break t}k===t(g)&&i(g),he(W)}else i(g);k=t(g)}if(k!==null)ue=!0;else{var L=t(y);L!==null&&mt(Ne,L.startTime-W),ue=!1}}break e}finally{k=null,T=Re,O=!1}ue=void 0}}finally{ue?H():fe=!1}}}var H;if(typeof ie=="function")H=function(){ie(D)};else if(typeof MessageChannel<"u"){var I=new MessageChannel,ze=I.port2;I.port1.onmessage=D,H=function(){ze.postMessage(null)}}else H=function(){te(D,0)};function mt(W,ue){R=te(function(){W(n.unstable_now())},ue)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(W){W.callback=null},n.unstable_forceFrameRate=function(W){0>W||125<W?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):E=0<W?Math.floor(1e3/W):5},n.unstable_getCurrentPriorityLevel=function(){return T},n.unstable_next=function(W){switch(T){case 1:case 2:case 3:var ue=3;break;default:ue=T}var Re=T;T=ue;try{return W()}finally{T=Re}},n.unstable_requestPaint=function(){V=!0},n.unstable_runWithPriority=function(W,ue){switch(W){case 1:case 2:case 3:case 4:case 5:break;default:W=3}var Re=T;T=W;try{return ue()}finally{T=Re}},n.unstable_scheduleCallback=function(W,ue,Re){var Le=n.unstable_now();switch(typeof Re=="object"&&Re!==null?(Re=Re.delay,Re=typeof Re=="number"&&0<Re?Le+Re:Le):Re=Le,W){case 1:var Z=-1;break;case 2:Z=250;break;case 5:Z=1073741823;break;case 4:Z=1e4;break;default:Z=5e3}return Z=Re+Z,W={id:x++,callback:ue,priorityLevel:W,startTime:Re,expirationTime:Z,sortIndex:-1},Re>Le?(W.sortIndex=Re,e(y,W),t(g)===null&&W===t(y)&&(F?(Y(R),R=-1):F=!0,mt(Ne,Re-Le))):(W.sortIndex=Z,e(g,W),G||O||(G=!0,fe||(fe=!0,H()))),W},n.unstable_shouldYield=B,n.unstable_wrapCallback=function(W){var ue=T;return function(){var Re=T;T=ue;try{return W.apply(this,arguments)}finally{T=Re}}}})(wp)),wp}var S1;function ST(){return S1||(S1=1,xp.exports=ET()),xp.exports}var _p={exports:{}},mr={};var N1;function NT(){if(N1)return mr;N1=1;var n=Pg();function e(g){var y="https://react.dev/errors/"+g;if(1<arguments.length){y+="?args[]="+encodeURIComponent(arguments[1]);for(var x=2;x<arguments.length;x++)y+="&args[]="+encodeURIComponent(arguments[x])}return"Minified React error #"+g+"; visit "+y+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var i={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},l=Symbol.for("react.portal");function u(g,y,x){var k=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:l,key:k==null?null:""+k,children:g,containerInfo:y,implementation:x}}var d=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function p(g,y){if(g==="font")return"";if(typeof y=="string")return y==="use-credentials"?y:""}return mr.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,mr.createPortal=function(g,y){var x=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!y||y.nodeType!==1&&y.nodeType!==9&&y.nodeType!==11)throw Error(e(299));return u(g,y,null,x)},mr.flushSync=function(g){var y=d.T,x=i.p;try{if(d.T=null,i.p=2,g)return g()}finally{d.T=y,i.p=x,i.d.f()}},mr.preconnect=function(g,y){typeof g=="string"&&(y?(y=y.crossOrigin,y=typeof y=="string"?y==="use-credentials"?y:"":void 0):y=null,i.d.C(g,y))},mr.prefetchDNS=function(g){typeof g=="string"&&i.d.D(g)},mr.preinit=function(g,y){if(typeof g=="string"&&y&&typeof y.as=="string"){var x=y.as,k=p(x,y.crossOrigin),T=typeof y.integrity=="string"?y.integrity:void 0,O=typeof y.fetchPriority=="string"?y.fetchPriority:void 0;x==="style"?i.d.S(g,typeof y.precedence=="string"?y.precedence:void 0,{crossOrigin:k,integrity:T,fetchPriority:O}):x==="script"&&i.d.X(g,{crossOrigin:k,integrity:T,fetchPriority:O,nonce:typeof y.nonce=="string"?y.nonce:void 0})}},mr.preinitModule=function(g,y){if(typeof g=="string")if(typeof y=="object"&&y!==null){if(y.as==null||y.as==="script"){var x=p(y.as,y.crossOrigin);i.d.M(g,{crossOrigin:x,integrity:typeof y.integrity=="string"?y.integrity:void 0,nonce:typeof y.nonce=="string"?y.nonce:void 0})}}else y==null&&i.d.M(g)},mr.preload=function(g,y){if(typeof g=="string"&&typeof y=="object"&&y!==null&&typeof y.as=="string"){var x=y.as,k=p(x,y.crossOrigin);i.d.L(g,x,{crossOrigin:k,integrity:typeof y.integrity=="string"?y.integrity:void 0,nonce:typeof y.nonce=="string"?y.nonce:void 0,type:typeof y.type=="string"?y.type:void 0,fetchPriority:typeof y.fetchPriority=="string"?y.fetchPriority:void 0,referrerPolicy:typeof y.referrerPolicy=="string"?y.referrerPolicy:void 0,imageSrcSet:typeof y.imageSrcSet=="string"?y.imageSrcSet:void 0,imageSizes:typeof y.imageSizes=="string"?y.imageSizes:void 0,media:typeof y.media=="string"?y.media:void 0})}},mr.preloadModule=function(g,y){if(typeof g=="string")if(y){var x=p(y.as,y.crossOrigin);i.d.m(g,{as:typeof y.as=="string"&&y.as!=="script"?y.as:void 0,crossOrigin:x,integrity:typeof y.integrity=="string"?y.integrity:void 0})}else i.d.m(g)},mr.requestFormReset=function(g){i.d.r(g)},mr.unstable_batchedUpdates=function(g,y){return g(y)},mr.useFormState=function(g,y,x){return d.H.useFormState(g,y,x)},mr.useFormStatus=function(){return d.H.useHostTransitionStatus()},mr.version="19.2.4",mr}var C1;function CT(){if(C1)return _p.exports;C1=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),_p.exports=NT(),_p.exports}var R1;function RT(){if(R1)return Yc;R1=1;var n=ST(),e=Pg(),t=CT();function i(s){var a="https://react.dev/errors/"+s;if(1<arguments.length){a+="?args[]="+encodeURIComponent(arguments[1]);for(var o=2;o<arguments.length;o++)a+="&args[]="+encodeURIComponent(arguments[o])}return"Minified React error #"+s+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function l(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function u(s){var a=s,o=s;if(s.alternate)for(;a.return;)a=a.return;else{s=a;do a=s,(a.flags&4098)!==0&&(o=a.return),s=a.return;while(s)}return a.tag===3?o:null}function d(s){if(s.tag===13){var a=s.memoizedState;if(a===null&&(s=s.alternate,s!==null&&(a=s.memoizedState)),a!==null)return a.dehydrated}return null}function p(s){if(s.tag===31){var a=s.memoizedState;if(a===null&&(s=s.alternate,s!==null&&(a=s.memoizedState)),a!==null)return a.dehydrated}return null}function g(s){if(u(s)!==s)throw Error(i(188))}function y(s){var a=s.alternate;if(!a){if(a=u(s),a===null)throw Error(i(188));return a!==s?null:s}for(var o=s,c=a;;){var m=o.return;if(m===null)break;var f=m.alternate;if(f===null){if(c=m.return,c!==null){o=c;continue}break}if(m.child===f.child){for(f=m.child;f;){if(f===o)return g(m),s;if(f===c)return g(m),a;f=f.sibling}throw Error(i(188))}if(o.return!==c.return)o=m,c=f;else{for(var w=!1,S=m.child;S;){if(S===o){w=!0,o=m,c=f;break}if(S===c){w=!0,c=m,o=f;break}S=S.sibling}if(!w){for(S=f.child;S;){if(S===o){w=!0,o=f,c=m;break}if(S===c){w=!0,c=f,o=m;break}S=S.sibling}if(!w)throw Error(i(189))}}if(o.alternate!==c)throw Error(i(190))}if(o.tag!==3)throw Error(i(188));return o.stateNode.current===o?s:a}function x(s){var a=s.tag;if(a===5||a===26||a===27||a===6)return s;for(s=s.child;s!==null;){if(a=x(s),a!==null)return a;s=s.sibling}return null}var k=Object.assign,T=Symbol.for("react.element"),O=Symbol.for("react.transitional.element"),G=Symbol.for("react.portal"),F=Symbol.for("react.fragment"),V=Symbol.for("react.strict_mode"),te=Symbol.for("react.profiler"),Y=Symbol.for("react.consumer"),ie=Symbol.for("react.context"),he=Symbol.for("react.forward_ref"),Ne=Symbol.for("react.suspense"),fe=Symbol.for("react.suspense_list"),R=Symbol.for("react.memo"),E=Symbol.for("react.lazy"),M=Symbol.for("react.activity"),B=Symbol.for("react.memo_cache_sentinel"),D=Symbol.iterator;function H(s){return s===null||typeof s!="object"?null:(s=D&&s[D]||s["@@iterator"],typeof s=="function"?s:null)}var I=Symbol.for("react.client.reference");function ze(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===I?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case F:return"Fragment";case te:return"Profiler";case V:return"StrictMode";case Ne:return"Suspense";case fe:return"SuspenseList";case M:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case G:return"Portal";case ie:return s.displayName||"Context";case Y:return(s._context.displayName||"Context")+".Consumer";case he:var a=s.render;return s=s.displayName,s||(s=a.displayName||a.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case R:return a=s.displayName||null,a!==null?a:ze(s.type)||"Memo";case E:a=s._payload,s=s._init;try{return ze(s(a))}catch{}}return null}var mt=Array.isArray,W=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ue=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Re={pending:!1,data:null,method:null,action:null},Le=[],Z=-1;function L(s){return{current:s}}function ne(s){0>Z||(s.current=Le[Z],Le[Z]=null,Z--)}function Ie(s,a){Z++,Le[Z]=s.current,s.current=a}var de=L(null),qe=L(null),Me=L(null),ot=L(null);function ft(s,a){switch(Ie(Me,a),Ie(qe,s),Ie(de,null),a.nodeType){case 9:case 11:s=(s=a.documentElement)&&(s=s.namespaceURI)?$v(s):0;break;default:if(s=a.tagName,a=a.namespaceURI)a=$v(a),s=Wv(a,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}ne(de),Ie(de,s)}function Qe(){ne(de),ne(qe),ne(Me)}function Vt(s){s.memoizedState!==null&&Ie(ot,s);var a=de.current,o=Wv(a,s.type);a!==o&&(Ie(qe,s),Ie(de,o))}function Ls(s){qe.current===s&&(ne(de),ne(qe)),ot.current===s&&(ne(ot),Hc._currentValue=Re)}var jt,yt;function re(s){if(jt===void 0)try{throw Error()}catch(o){var a=o.stack.trim().match(/\n( *(at )?)/);jt=a&&a[1]||"",yt=-1<o.stack.indexOf(`
    at`)?" (<anonymous>)":-1<o.stack.indexOf("@")?"@unknown:0:0":""}return`
`+jt+s+yt}var Nt=!1;function vt(s,a){if(!s||Nt)return"";Nt=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var c={DetermineComponentFrameRoot:function(){try{if(a){var De=function(){throw Error()};if(Object.defineProperty(De.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(De,[])}catch(xe){var ce=xe}Reflect.construct(s,[],De)}else{try{De.call()}catch(xe){ce=xe}s.call(De.prototype)}}else{try{throw Error()}catch(xe){ce=xe}(De=s())&&typeof De.catch=="function"&&De.catch(function(){})}}catch(xe){if(xe&&ce&&typeof xe.stack=="string")return[xe.stack,ce.stack]}return[null,null]}};c.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var m=Object.getOwnPropertyDescriptor(c.DetermineComponentFrameRoot,"name");m&&m.configurable&&Object.defineProperty(c.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var f=c.DetermineComponentFrameRoot(),w=f[0],S=f[1];if(w&&S){var q=w.split(`
`),le=S.split(`
`);for(m=c=0;c<q.length&&!q[c].includes("DetermineComponentFrameRoot");)c++;for(;m<le.length&&!le[m].includes("DetermineComponentFrameRoot");)m++;if(c===q.length||m===le.length)for(c=q.length-1,m=le.length-1;1<=c&&0<=m&&q[c]!==le[m];)m--;for(;1<=c&&0<=m;c--,m--)if(q[c]!==le[m]){if(c!==1||m!==1)do if(c--,m--,0>m||q[c]!==le[m]){var je=`
`+q[c].replace(" at new "," at ");return s.displayName&&je.includes("<anonymous>")&&(je=je.replace("<anonymous>",s.displayName)),je}while(1<=c&&0<=m);break}}}finally{Nt=!1,Error.prepareStackTrace=o}return(o=s?s.displayName||s.name:"")?re(o):""}function Pt(s,a){switch(s.tag){case 26:case 27:case 5:return re(s.type);case 16:return re("Lazy");case 13:return s.child!==a&&a!==null?re("Suspense Fallback"):re("Suspense");case 19:return re("SuspenseList");case 0:case 15:return vt(s.type,!1);case 11:return vt(s.type.render,!1);case 1:return vt(s.type,!0);case 31:return re("Activity");default:return""}}function Et(s){try{var a="",o=null;do a+=Pt(s,o),o=s,s=s.return;while(s);return a}catch(c){return`
Error generating stack: `+c.message+`
`+c.stack}}var ut=Object.prototype.hasOwnProperty,Ye=n.unstable_scheduleCallback,It=n.unstable_cancelCallback,Xt=n.unstable_shouldYield,Ks=n.unstable_requestPaint,Ut=n.unstable_now,Mt=n.unstable_getCurrentPriorityLevel,is=n.unstable_ImmediatePriority,Ms=n.unstable_UserBlockingPriority,Kt=n.unstable_NormalPriority,on=n.unstable_LowPriority,ds=n.unstable_IdlePriority,_s=n.log,Ct=n.unstable_setDisableYieldValue,be=null,Te=null;function Be(s){if(typeof _s=="function"&&Ct(s),Te&&typeof Te.setStrictMode=="function")try{Te.setStrictMode(be,s)}catch{}}var Ue=Math.clz32?Math.clz32:We,J=Math.log,ge=Math.LN2;function We(s){return s>>>=0,s===0?32:31-(J(s)/ge|0)|0}var Ke=256,z=262144,se=4194304;function Ge(s){var a=s&42;if(a!==0)return a;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return s&261888;case 262144:case 524288:case 1048576:case 2097152:return s&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function He(s,a,o){var c=s.pendingLanes;if(c===0)return 0;var m=0,f=s.suspendedLanes,w=s.pingedLanes;s=s.warmLanes;var S=c&134217727;return S!==0?(c=S&~f,c!==0?m=Ge(c):(w&=S,w!==0?m=Ge(w):o||(o=S&~s,o!==0&&(m=Ge(o))))):(S=c&~f,S!==0?m=Ge(S):w!==0?m=Ge(w):o||(o=c&~s,o!==0&&(m=Ge(o)))),m===0?0:a!==0&&a!==m&&(a&f)===0&&(f=m&-m,o=a&-a,f>=o||f===32&&(o&4194048)!==0)?a:m}function Xe(s,a){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&a)===0}function lt(s,a){switch(s){case 1:case 2:case 4:case 8:case 64:return a+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function _t(){var s=se;return se<<=1,(se&62914560)===0&&(se=4194304),s}function pt(s){for(var a=[],o=0;31>o;o++)a.push(s);return a}function Wt(s,a){s.pendingLanes|=a,a!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function en(s,a,o,c,m,f){var w=s.pendingLanes;s.pendingLanes=o,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=o,s.entangledLanes&=o,s.errorRecoveryDisabledLanes&=o,s.shellSuspendCounter=0;var S=s.entanglements,q=s.expirationTimes,le=s.hiddenUpdates;for(o=w&~o;0<o;){var je=31-Ue(o),De=1<<je;S[je]=0,q[je]=-1;var ce=le[je];if(ce!==null)for(le[je]=null,je=0;je<ce.length;je++){var xe=ce[je];xe!==null&&(xe.lane&=-536870913)}o&=~De}c!==0&&ts(s,c,0),f!==0&&m===0&&s.tag!==0&&(s.suspendedLanes|=f&~(w&~a))}function ts(s,a,o){s.pendingLanes|=a,s.suspendedLanes&=~a;var c=31-Ue(a);s.entangledLanes|=a,s.entanglements[c]=s.entanglements[c]|1073741824|o&261930}function ks(s,a){var o=s.entangledLanes|=a;for(s=s.entanglements;o;){var c=31-Ue(o),m=1<<c;m&a|s[c]&a&&(s[c]|=a),o&=~m}}function zs(s,a){var o=a&-a;return o=(o&42)!==0?1:$(o),(o&(s.suspendedLanes|a))!==0?0:o}function $(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function we(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function Se(){var s=ue.p;return s!==0?s:(s=window.event,s===void 0?32:p1(s.type))}function Ee(s,a){var o=ue.p;try{return ue.p=s,a()}finally{ue.p=o}}var ke=Math.random().toString(36).slice(2),dt="__reactFiber$"+ke,bt="__reactProps$"+ke,st="__reactContainer$"+ke,St="__reactEvents$"+ke,xt="__reactListeners$"+ke,hs="__reactHandles$"+ke,Tn="__reactResources$"+ke,yn="__reactMarker$"+ke;function Rn(s){delete s[dt],delete s[bt],delete s[St],delete s[xt],delete s[hs]}function bn(s){var a=s[dt];if(a)return a;for(var o=s.parentNode;o;){if(a=o[st]||o[dt]){if(o=a.alternate,a.child!==null||o!==null&&o.child!==null)for(s=Zv(s);s!==null;){if(o=s[dt])return o;s=Zv(s)}return a}s=o,o=s.parentNode}return null}function rn(s){if(s=s[dt]||s[st]){var a=s.tag;if(a===5||a===6||a===13||a===31||a===26||a===27||a===3)return s}return null}function qs(s){var a=s.tag;if(a===5||a===26||a===27||a===6)return s.stateNode;throw Error(i(33))}function j(s){var a=s[Tn];return a||(a=s[Tn]={hoistableStyles:new Map,hoistableScripts:new Map}),a}function C(s){s[yn]=!0}var P=new Set,U={};function ye(s,a){Ve(s,a),Ve(s+"Capture",a)}function Ve(s,a){for(U[s]=a,s=0;s<a.length;s++)P.add(a[s])}var Oe=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),et={},nt={};function as(s){return ut.call(nt,s)?!0:ut.call(et,s)?!1:Oe.test(s)?nt[s]=!0:(et[s]=!0,!1)}function Cs(s,a,o){if(as(a))if(o===null)s.removeAttribute(a);else{switch(typeof o){case"undefined":case"function":case"symbol":s.removeAttribute(a);return;case"boolean":var c=a.toLowerCase().slice(0,5);if(c!=="data-"&&c!=="aria-"){s.removeAttribute(a);return}}s.setAttribute(a,""+o)}}function ls(s,a,o){if(o===null)s.removeAttribute(a);else{switch(typeof o){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(a);return}s.setAttribute(a,""+o)}}function cs(s,a,o,c){if(c===null)s.removeAttribute(o);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(o);return}s.setAttributeNS(a,o,""+c)}}function Hs(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function fn(s){var a=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(a==="checkbox"||a==="radio")}function Ur(s,a,o){var c=Object.getOwnPropertyDescriptor(s.constructor.prototype,a);if(!s.hasOwnProperty(a)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var m=c.get,f=c.set;return Object.defineProperty(s,a,{configurable:!0,get:function(){return m.call(this)},set:function(w){o=""+w,f.call(this,w)}}),Object.defineProperty(s,a,{enumerable:c.enumerable}),{getValue:function(){return o},setValue:function(w){o=""+w},stopTracking:function(){s._valueTracker=null,delete s[a]}}}}function gs(s){if(!s._valueTracker){var a=fn(s)?"checked":"value";s._valueTracker=Ur(s,a,""+s[a])}}function Cr(s){if(!s)return!1;var a=s._valueTracker;if(!a)return!0;var o=a.getValue(),c="";return s&&(c=fn(s)?s.checked?"true":"false":s.value),s=c,s!==o?(a.setValue(s),!0):!1}function An(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var Q=/[\n"\\]/g;function ve(s){return s.replace(Q,function(a){return"\\"+a.charCodeAt(0).toString(16)+" "})}function _e(s,a,o,c,m,f,w,S){s.name="",w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"?s.type=w:s.removeAttribute("type"),a!=null?w==="number"?(a===0&&s.value===""||s.value!=a)&&(s.value=""+Hs(a)):s.value!==""+Hs(a)&&(s.value=""+Hs(a)):w!=="submit"&&w!=="reset"||s.removeAttribute("value"),a!=null?Je(s,w,Hs(a)):o!=null?Je(s,w,Hs(o)):c!=null&&s.removeAttribute("value"),m==null&&f!=null&&(s.defaultChecked=!!f),m!=null&&(s.checked=m&&typeof m!="function"&&typeof m!="symbol"),S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"?s.name=""+Hs(S):s.removeAttribute("name")}function tt(s,a,o,c,m,f,w,S){if(f!=null&&typeof f!="function"&&typeof f!="symbol"&&typeof f!="boolean"&&(s.type=f),a!=null||o!=null){if(!(f!=="submit"&&f!=="reset"||a!=null)){gs(s);return}o=o!=null?""+Hs(o):"",a=a!=null?""+Hs(a):o,S||a===s.value||(s.value=a),s.defaultValue=a}c=c??m,c=typeof c!="function"&&typeof c!="symbol"&&!!c,s.checked=S?s.checked:!!c,s.defaultChecked=!!c,w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"&&(s.name=w),gs(s)}function Je(s,a,o){a==="number"&&An(s.ownerDocument)===s||s.defaultValue===""+o||(s.defaultValue=""+o)}function ct(s,a,o,c){if(s=s.options,a){a={};for(var m=0;m<o.length;m++)a["$"+o[m]]=!0;for(o=0;o<s.length;o++)m=a.hasOwnProperty("$"+s[o].value),s[o].selected!==m&&(s[o].selected=m),m&&c&&(s[o].defaultSelected=!0)}else{for(o=""+Hs(o),a=null,m=0;m<s.length;m++){if(s[m].value===o){s[m].selected=!0,c&&(s[m].defaultSelected=!0);return}a!==null||s[m].disabled||(a=s[m])}a!==null&&(a.selected=!0)}}function Ht(s,a,o){if(a!=null&&(a=""+Hs(a),a!==s.value&&(s.value=a),o==null)){s.defaultValue!==a&&(s.defaultValue=a);return}s.defaultValue=o!=null?""+Hs(o):""}function $t(s,a,o,c){if(a==null){if(c!=null){if(o!=null)throw Error(i(92));if(mt(c)){if(1<c.length)throw Error(i(93));c=c[0]}o=c}o==null&&(o=""),a=o}o=Hs(a),s.defaultValue=o,c=s.textContent,c===o&&c!==""&&c!==null&&(s.value=c),gs(s)}function Yt(s,a){if(a){var o=s.firstChild;if(o&&o===s.lastChild&&o.nodeType===3){o.nodeValue=a;return}}s.textContent=a}var Mn=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Gt(s,a,o){var c=a.indexOf("--")===0;o==null||typeof o=="boolean"||o===""?c?s.setProperty(a,""):a==="float"?s.cssFloat="":s[a]="":c?s.setProperty(a,o):typeof o!="number"||o===0||Mn.has(a)?a==="float"?s.cssFloat=o:s[a]=(""+o).trim():s[a]=o+"px"}function Vs(s,a,o){if(a!=null&&typeof a!="object")throw Error(i(62));if(s=s.style,o!=null){for(var c in o)!o.hasOwnProperty(c)||a!=null&&a.hasOwnProperty(c)||(c.indexOf("--")===0?s.setProperty(c,""):c==="float"?s.cssFloat="":s[c]="");for(var m in a)c=a[m],a.hasOwnProperty(m)&&o[m]!==c&&Gt(s,m,c)}else for(var f in a)a.hasOwnProperty(f)&&Gt(s,f,a[f])}function Us(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var In=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Rs=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Ys(s){return Rs.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}function Jt(){}var ln=null;function pn(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var zn=null,Gn=null;function vn(s){var a=rn(s);if(a&&(s=a.stateNode)){var o=s[bt]||null;e:switch(s=a.stateNode,a.type){case"input":if(_e(s,o.value,o.defaultValue,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name),a=o.name,o.type==="radio"&&a!=null){for(o=s;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll('input[name="'+ve(""+a)+'"][type="radio"]'),a=0;a<o.length;a++){var c=o[a];if(c!==s&&c.form===s.form){var m=c[bt]||null;if(!m)throw Error(i(90));_e(c,m.value,m.defaultValue,m.defaultValue,m.checked,m.defaultChecked,m.type,m.name)}}for(a=0;a<o.length;a++)c=o[a],c.form===s.form&&Cr(c)}break e;case"textarea":Ht(s,o.value,o.defaultValue);break e;case"select":a=o.value,a!=null&&ct(s,!!o.multiple,a,!1)}}}var Kn=!1;function cr(s,a,o){if(Kn)return s(a,o);Kn=!0;try{var c=s(a);return c}finally{if(Kn=!1,(zn!==null||Gn!==null)&&(Md(),zn&&(a=zn,s=Gn,Gn=zn=null,vn(a),s)))for(a=0;a<s.length;a++)vn(s[a])}}function ur(s,a){var o=s.stateNode;if(o===null)return null;var c=o[bt]||null;if(c===null)return null;o=c[a];e:switch(a){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(c=!c.disabled)||(s=s.type,c=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!c;break e;default:s=!1}if(s)return null;if(o&&typeof o!="function")throw Error(i(231,a,typeof o));return o}var dr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Fr=!1;if(dr)try{var N={};Object.defineProperty(N,"passive",{get:function(){Fr=!0}}),window.addEventListener("test",N,N),window.removeEventListener("test",N,N)}catch{Fr=!1}var X=null,Fe=null,it=null;function Tt(){if(it)return it;var s,a=Fe,o=a.length,c,m="value"in X?X.value:X.textContent,f=m.length;for(s=0;s<o&&a[s]===m[s];s++);var w=o-s;for(c=1;c<=w&&a[o-c]===m[f-c];c++);return it=m.slice(s,1<c?1-c:void 0)}function Bt(s){var a=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&a===13&&(s=13)):s=a,s===10&&(s=13),32<=s||s===13?s:0}function rt(){return!0}function Lt(){return!1}function Dt(s){function a(o,c,m,f,w){this._reactName=o,this._targetInst=m,this.type=c,this.nativeEvent=f,this.target=w,this.currentTarget=null;for(var S in s)s.hasOwnProperty(S)&&(o=s[S],this[S]=o?o(f):f[S]);return this.isDefaultPrevented=(f.defaultPrevented!=null?f.defaultPrevented:f.returnValue===!1)?rt:Lt,this.isPropagationStopped=Lt,this}return k(a.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=rt)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=rt)},persist:function(){},isPersistent:rt}),a}var us={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},os=Dt(us),Ts=k({},us,{view:0,detail:0}),zr=Dt(Ts),vr,tn,$s,Yn=k({},Ts,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ti,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==$s&&($s&&s.type==="mousemove"?(vr=s.screenX-$s.screenX,tn=s.screenY-$s.screenY):tn=vr=0,$s=s),vr)},movementY:function(s){return"movementY"in s?s.movementY:tn}}),Qn=Dt(Yn),Dn=k({},Yn,{dataTransfer:0}),xr=Dt(Dn),Rr=k({},Ts,{relatedTarget:0}),Xn=Dt(Rr),er=k({},us,{animationName:0,elapsedTime:0,pseudoElement:0}),qn=Dt(er),hr=k({},us,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),Ar=Dt(hr),xo=k({},us,{data:0}),Zr=Dt(xo),rl={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Ya={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ma={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function fa(s){var a=this.nativeEvent;return a.getModifierState?a.getModifierState(s):(s=ma[s])?!!a[s]:!1}function Ti(){return fa}var wr=k({},Ts,{key:function(s){if(s.key){var a=rl[s.key]||s.key;if(a!=="Unidentified")return a}return s.type==="keypress"?(s=Bt(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?Ya[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ti,charCode:function(s){return s.type==="keypress"?Bt(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?Bt(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),Yu=Dt(wr),Qu=k({},Yn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Qa=Dt(Qu),h=k({},Ts,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ti}),b=Dt(h),_=k({},us,{propertyName:0,elapsedTime:0,pseudoElement:0}),A=Dt(_),ae=k({},Yn,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),pe=Dt(ae),Ze=k({},us,{newState:0,oldState:0}),ss=Dt(Ze),En=[9,13,27,32],Os=dr&&"CompositionEvent"in window,dn=null;dr&&"documentMode"in document&&(dn=document.documentMode);var ea=dr&&"TextEvent"in window&&!dn,Aa=dr&&(!Os||dn&&8<dn&&11>=dn),pa=" ",ga=!1;function wo(s,a){switch(s){case"keyup":return En.indexOf(a.keyCode)!==-1;case"keydown":return a.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function al(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var il=!1;function Gk(s,a){switch(s){case"compositionend":return al(a);case"keypress":return a.which!==32?null:(ga=!0,pa);case"textInput":return s=a.data,s===pa&&ga?null:s;default:return null}}function Kk(s,a){if(il)return s==="compositionend"||!Os&&wo(s,a)?(s=Tt(),it=Fe=X=null,il=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(a.ctrlKey||a.altKey||a.metaKey)||a.ctrlKey&&a.altKey){if(a.char&&1<a.char.length)return a.char;if(a.which)return String.fromCharCode(a.which)}return null;case"compositionend":return Aa&&a.locale!=="ko"?null:a.data;default:return null}}var Yk={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function sb(s){var a=s&&s.nodeName&&s.nodeName.toLowerCase();return a==="input"?!!Yk[s.type]:a==="textarea"}function nb(s,a,o,c){zn?Gn?Gn.push(c):Gn=[c]:zn=c,a=Vd(a,"onChange"),0<a.length&&(o=new os("onChange","change",null,o,c),s.push({event:o,listeners:a}))}var hc=null,mc=null;function Qk(s){Vv(s,0)}function Xu(s){var a=qs(s);if(Cr(a))return s}function rb(s,a){if(s==="change")return a}var ab=!1;if(dr){var km;if(dr){var jm="oninput"in document;if(!jm){var ib=document.createElement("div");ib.setAttribute("oninput","return;"),jm=typeof ib.oninput=="function"}km=jm}else km=!1;ab=km&&(!document.documentMode||9<document.documentMode)}function ob(){hc&&(hc.detachEvent("onpropertychange",lb),mc=hc=null)}function lb(s){if(s.propertyName==="value"&&Xu(mc)){var a=[];nb(a,mc,s,pn(s)),cr(Qk,a)}}function Xk(s,a,o){s==="focusin"?(ob(),hc=a,mc=o,hc.attachEvent("onpropertychange",lb)):s==="focusout"&&ob()}function Jk(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return Xu(mc)}function Zk(s,a){if(s==="click")return Xu(a)}function ej(s,a){if(s==="input"||s==="change")return Xu(a)}function tj(s,a){return s===a&&(s!==0||1/s===1/a)||s!==s&&a!==a}var qr=typeof Object.is=="function"?Object.is:tj;function fc(s,a){if(qr(s,a))return!0;if(typeof s!="object"||s===null||typeof a!="object"||a===null)return!1;var o=Object.keys(s),c=Object.keys(a);if(o.length!==c.length)return!1;for(c=0;c<o.length;c++){var m=o[c];if(!ut.call(a,m)||!qr(s[m],a[m]))return!1}return!0}function cb(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function ub(s,a){var o=cb(s);s=0;for(var c;o;){if(o.nodeType===3){if(c=s+o.textContent.length,s<=a&&c>=a)return{node:o,offset:a-s};s=c}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=cb(o)}}function db(s,a){return s&&a?s===a?!0:s&&s.nodeType===3?!1:a&&a.nodeType===3?db(s,a.parentNode):"contains"in s?s.contains(a):s.compareDocumentPosition?!!(s.compareDocumentPosition(a)&16):!1:!1}function hb(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var a=An(s.document);a instanceof s.HTMLIFrameElement;){try{var o=typeof a.contentWindow.location.href=="string"}catch{o=!1}if(o)s=a.contentWindow;else break;a=An(s.document)}return a}function Tm(s){var a=s&&s.nodeName&&s.nodeName.toLowerCase();return a&&(a==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||a==="textarea"||s.contentEditable==="true")}var sj=dr&&"documentMode"in document&&11>=document.documentMode,ol=null,Em=null,pc=null,Sm=!1;function mb(s,a,o){var c=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;Sm||ol==null||ol!==An(c)||(c=ol,"selectionStart"in c&&Tm(c)?c={start:c.selectionStart,end:c.selectionEnd}:(c=(c.ownerDocument&&c.ownerDocument.defaultView||window).getSelection(),c={anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset}),pc&&fc(pc,c)||(pc=c,c=Vd(Em,"onSelect"),0<c.length&&(a=new os("onSelect","select",null,a,o),s.push({event:a,listeners:c}),a.target=ol)))}function _o(s,a){var o={};return o[s.toLowerCase()]=a.toLowerCase(),o["Webkit"+s]="webkit"+a,o["Moz"+s]="moz"+a,o}var ll={animationend:_o("Animation","AnimationEnd"),animationiteration:_o("Animation","AnimationIteration"),animationstart:_o("Animation","AnimationStart"),transitionrun:_o("Transition","TransitionRun"),transitionstart:_o("Transition","TransitionStart"),transitioncancel:_o("Transition","TransitionCancel"),transitionend:_o("Transition","TransitionEnd")},Nm={},fb={};dr&&(fb=document.createElement("div").style,"AnimationEvent"in window||(delete ll.animationend.animation,delete ll.animationiteration.animation,delete ll.animationstart.animation),"TransitionEvent"in window||delete ll.transitionend.transition);function ko(s){if(Nm[s])return Nm[s];if(!ll[s])return s;var a=ll[s],o;for(o in a)if(a.hasOwnProperty(o)&&o in fb)return Nm[s]=a[o];return s}var pb=ko("animationend"),gb=ko("animationiteration"),yb=ko("animationstart"),nj=ko("transitionrun"),rj=ko("transitionstart"),aj=ko("transitioncancel"),bb=ko("transitionend"),vb=new Map,Cm="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Cm.push("scrollEnd");function ya(s,a){vb.set(s,a),ye(a,[s])}var Ju=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var a=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(a))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)},ta=[],cl=0,Rm=0;function Zu(){for(var s=cl,a=Rm=cl=0;a<s;){var o=ta[a];ta[a++]=null;var c=ta[a];ta[a++]=null;var m=ta[a];ta[a++]=null;var f=ta[a];if(ta[a++]=null,c!==null&&m!==null){var w=c.pending;w===null?m.next=m:(m.next=w.next,w.next=m),c.pending=m}f!==0&&xb(o,m,f)}}function ed(s,a,o,c){ta[cl++]=s,ta[cl++]=a,ta[cl++]=o,ta[cl++]=c,Rm|=c,s.lanes|=c,s=s.alternate,s!==null&&(s.lanes|=c)}function Am(s,a,o,c){return ed(s,a,o,c),td(s)}function jo(s,a){return ed(s,null,null,a),td(s)}function xb(s,a,o){s.lanes|=o;var c=s.alternate;c!==null&&(c.lanes|=o);for(var m=!1,f=s.return;f!==null;)f.childLanes|=o,c=f.alternate,c!==null&&(c.childLanes|=o),f.tag===22&&(s=f.stateNode,s===null||s._visibility&1||(m=!0)),s=f,f=f.return;return s.tag===3?(f=s.stateNode,m&&a!==null&&(m=31-Ue(o),s=f.hiddenUpdates,c=s[m],c===null?s[m]=[a]:c.push(a),a.lane=o|536870912),f):null}function td(s){if(50<Oc)throw Oc=0,Ff=null,Error(i(185));for(var a=s.return;a!==null;)s=a,a=s.return;return s.tag===3?s.stateNode:null}var ul={};function ij(s,a,o,c){this.tag=s,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=a,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=c,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Hr(s,a,o,c){return new ij(s,a,o,c)}function Mm(s){return s=s.prototype,!(!s||!s.isReactComponent)}function Xa(s,a){var o=s.alternate;return o===null?(o=Hr(s.tag,a,s.key,s.mode),o.elementType=s.elementType,o.type=s.type,o.stateNode=s.stateNode,o.alternate=s,s.alternate=o):(o.pendingProps=a,o.type=s.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=s.flags&65011712,o.childLanes=s.childLanes,o.lanes=s.lanes,o.child=s.child,o.memoizedProps=s.memoizedProps,o.memoizedState=s.memoizedState,o.updateQueue=s.updateQueue,a=s.dependencies,o.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext},o.sibling=s.sibling,o.index=s.index,o.ref=s.ref,o.refCleanup=s.refCleanup,o}function wb(s,a){s.flags&=65011714;var o=s.alternate;return o===null?(s.childLanes=0,s.lanes=a,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,a=o.dependencies,s.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),s}function sd(s,a,o,c,m,f){var w=0;if(c=s,typeof s=="function")Mm(s)&&(w=1);else if(typeof s=="string")w=dT(s,o,de.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case M:return s=Hr(31,o,a,m),s.elementType=M,s.lanes=f,s;case F:return To(o.children,m,f,a);case V:w=8,m|=24;break;case te:return s=Hr(12,o,a,m|2),s.elementType=te,s.lanes=f,s;case Ne:return s=Hr(13,o,a,m),s.elementType=Ne,s.lanes=f,s;case fe:return s=Hr(19,o,a,m),s.elementType=fe,s.lanes=f,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case ie:w=10;break e;case Y:w=9;break e;case he:w=11;break e;case R:w=14;break e;case E:w=16,c=null;break e}w=29,o=Error(i(130,s===null?"null":typeof s,"")),c=null}return a=Hr(w,o,a,m),a.elementType=s,a.type=c,a.lanes=f,a}function To(s,a,o,c){return s=Hr(7,s,c,a),s.lanes=o,s}function Im(s,a,o){return s=Hr(6,s,null,a),s.lanes=o,s}function _b(s){var a=Hr(18,null,null,0);return a.stateNode=s,a}function Dm(s,a,o){return a=Hr(4,s.children!==null?s.children:[],s.key,a),a.lanes=o,a.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},a}var kb=new WeakMap;function sa(s,a){if(typeof s=="object"&&s!==null){var o=kb.get(s);return o!==void 0?o:(a={value:s,source:a,stack:Et(a)},kb.set(s,a),a)}return{value:s,source:a,stack:Et(a)}}var dl=[],hl=0,nd=null,gc=0,na=[],ra=0,Ei=null,Ma=1,Ia="";function Ja(s,a){dl[hl++]=gc,dl[hl++]=nd,nd=s,gc=a}function jb(s,a,o){na[ra++]=Ma,na[ra++]=Ia,na[ra++]=Ei,Ei=s;var c=Ma;s=Ia;var m=32-Ue(c)-1;c&=~(1<<m),o+=1;var f=32-Ue(a)+m;if(30<f){var w=m-m%5;f=(c&(1<<w)-1).toString(32),c>>=w,m-=w,Ma=1<<32-Ue(a)+m|o<<m|c,Ia=f+s}else Ma=1<<f|o<<m|c,Ia=s}function Pm(s){s.return!==null&&(Ja(s,1),jb(s,1,0))}function Lm(s){for(;s===nd;)nd=dl[--hl],dl[hl]=null,gc=dl[--hl],dl[hl]=null;for(;s===Ei;)Ei=na[--ra],na[ra]=null,Ia=na[--ra],na[ra]=null,Ma=na[--ra],na[ra]=null}function Tb(s,a){na[ra++]=Ma,na[ra++]=Ia,na[ra++]=Ei,Ma=a.id,Ia=a.overflow,Ei=s}var tr=null,cn=null,js=!1,Si=null,aa=!1,Om=Error(i(519));function Ni(s){var a=Error(i(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw yc(sa(a,s)),Om}function Eb(s){var a=s.stateNode,o=s.type,c=s.memoizedProps;switch(a[dt]=s,a[bt]=c,o){case"dialog":fs("cancel",a),fs("close",a);break;case"iframe":case"object":case"embed":fs("load",a);break;case"video":case"audio":for(o=0;o<Vc.length;o++)fs(Vc[o],a);break;case"source":fs("error",a);break;case"img":case"image":case"link":fs("error",a),fs("load",a);break;case"details":fs("toggle",a);break;case"input":fs("invalid",a),tt(a,c.value,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name,!0);break;case"select":fs("invalid",a);break;case"textarea":fs("invalid",a),$t(a,c.value,c.defaultValue,c.children)}o=c.children,typeof o!="string"&&typeof o!="number"&&typeof o!="bigint"||a.textContent===""+o||c.suppressHydrationWarning===!0||qv(a.textContent,o)?(c.popover!=null&&(fs("beforetoggle",a),fs("toggle",a)),c.onScroll!=null&&fs("scroll",a),c.onScrollEnd!=null&&fs("scrollend",a),c.onClick!=null&&(a.onclick=Jt),a=!0):a=!1,a||Ni(s,!0)}function Sb(s){for(tr=s.return;tr;)switch(tr.tag){case 5:case 31:case 13:aa=!1;return;case 27:case 3:aa=!0;return;default:tr=tr.return}}function ml(s){if(s!==tr)return!1;if(!js)return Sb(s),js=!0,!1;var a=s.tag,o;if((o=a!==3&&a!==27)&&((o=a===5)&&(o=s.type,o=!(o!=="form"&&o!=="button")||sp(s.type,s.memoizedProps)),o=!o),o&&cn&&Ni(s),Sb(s),a===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(317));cn=Jv(s)}else if(a===31){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(317));cn=Jv(s)}else a===27?(a=cn,zi(s.type)?(s=op,op=null,cn=s):cn=a):cn=tr?oa(s.stateNode.nextSibling):null;return!0}function Eo(){cn=tr=null,js=!1}function Bm(){var s=Si;return s!==null&&(Pr===null?Pr=s:Pr.push.apply(Pr,s),Si=null),s}function yc(s){Si===null?Si=[s]:Si.push(s)}var Vm=L(null),So=null,Za=null;function Ci(s,a,o){Ie(Vm,a._currentValue),a._currentValue=o}function ei(s){s._currentValue=Vm.current,ne(Vm)}function Um(s,a,o){for(;s!==null;){var c=s.alternate;if((s.childLanes&a)!==a?(s.childLanes|=a,c!==null&&(c.childLanes|=a)):c!==null&&(c.childLanes&a)!==a&&(c.childLanes|=a),s===o)break;s=s.return}}function Fm(s,a,o,c){var m=s.child;for(m!==null&&(m.return=s);m!==null;){var f=m.dependencies;if(f!==null){var w=m.child;f=f.firstContext;e:for(;f!==null;){var S=f;f=m;for(var q=0;q<a.length;q++)if(S.context===a[q]){f.lanes|=o,S=f.alternate,S!==null&&(S.lanes|=o),Um(f.return,o,s),c||(w=null);break e}f=S.next}}else if(m.tag===18){if(w=m.return,w===null)throw Error(i(341));w.lanes|=o,f=w.alternate,f!==null&&(f.lanes|=o),Um(w,o,s),w=null}else w=m.child;if(w!==null)w.return=m;else for(w=m;w!==null;){if(w===s){w=null;break}if(m=w.sibling,m!==null){m.return=w.return,w=m;break}w=w.return}m=w}}function fl(s,a,o,c){s=null;for(var m=a,f=!1;m!==null;){if(!f){if((m.flags&524288)!==0)f=!0;else if((m.flags&262144)!==0)break}if(m.tag===10){var w=m.alternate;if(w===null)throw Error(i(387));if(w=w.memoizedProps,w!==null){var S=m.type;qr(m.pendingProps.value,w.value)||(s!==null?s.push(S):s=[S])}}else if(m===ot.current){if(w=m.alternate,w===null)throw Error(i(387));w.memoizedState.memoizedState!==m.memoizedState.memoizedState&&(s!==null?s.push(Hc):s=[Hc])}m=m.return}s!==null&&Fm(a,s,o,c),a.flags|=262144}function rd(s){for(s=s.firstContext;s!==null;){if(!qr(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function No(s){So=s,Za=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function sr(s){return Nb(So,s)}function ad(s,a){return So===null&&No(s),Nb(s,a)}function Nb(s,a){var o=a._currentValue;if(a={context:a,memoizedValue:o,next:null},Za===null){if(s===null)throw Error(i(308));Za=a,s.dependencies={lanes:0,firstContext:a},s.flags|=524288}else Za=Za.next=a;return o}var oj=typeof AbortController<"u"?AbortController:function(){var s=[],a=this.signal={aborted:!1,addEventListener:function(o,c){s.push(c)}};this.abort=function(){a.aborted=!0,s.forEach(function(o){return o()})}},lj=n.unstable_scheduleCallback,cj=n.unstable_NormalPriority,Pn={$$typeof:ie,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function zm(){return{controller:new oj,data:new Map,refCount:0}}function bc(s){s.refCount--,s.refCount===0&&lj(cj,function(){s.controller.abort()})}var vc=null,qm=0,pl=0,gl=null;function uj(s,a){if(vc===null){var o=vc=[];qm=0,pl=Gf(),gl={status:"pending",value:void 0,then:function(c){o.push(c)}}}return qm++,a.then(Cb,Cb),a}function Cb(){if(--qm===0&&vc!==null){gl!==null&&(gl.status="fulfilled");var s=vc;vc=null,pl=0,gl=null;for(var a=0;a<s.length;a++)(0,s[a])()}}function dj(s,a){var o=[],c={status:"pending",value:null,reason:null,then:function(m){o.push(m)}};return s.then(function(){c.status="fulfilled",c.value=a;for(var m=0;m<o.length;m++)(0,o[m])(a)},function(m){for(c.status="rejected",c.reason=m,m=0;m<o.length;m++)(0,o[m])(void 0)}),c}var Rb=W.S;W.S=function(s,a){mv=Ut(),typeof a=="object"&&a!==null&&typeof a.then=="function"&&uj(s,a),Rb!==null&&Rb(s,a)};var Co=L(null);function Hm(){var s=Co.current;return s!==null?s:sn.pooledCache}function id(s,a){a===null?Ie(Co,Co.current):Ie(Co,a.pool)}function Ab(){var s=Hm();return s===null?null:{parent:Pn._currentValue,pool:s}}var yl=Error(i(460)),$m=Error(i(474)),od=Error(i(542)),ld={then:function(){}};function Mb(s){return s=s.status,s==="fulfilled"||s==="rejected"}function Ib(s,a,o){switch(o=s[o],o===void 0?s.push(a):o!==a&&(a.then(Jt,Jt),a=o),a.status){case"fulfilled":return a.value;case"rejected":throw s=a.reason,Pb(s),s;default:if(typeof a.status=="string")a.then(Jt,Jt);else{if(s=sn,s!==null&&100<s.shellSuspendCounter)throw Error(i(482));s=a,s.status="pending",s.then(function(c){if(a.status==="pending"){var m=a;m.status="fulfilled",m.value=c}},function(c){if(a.status==="pending"){var m=a;m.status="rejected",m.reason=c}})}switch(a.status){case"fulfilled":return a.value;case"rejected":throw s=a.reason,Pb(s),s}throw Ao=a,yl}}function Ro(s){try{var a=s._init;return a(s._payload)}catch(o){throw o!==null&&typeof o=="object"&&typeof o.then=="function"?(Ao=o,yl):o}}var Ao=null;function Db(){if(Ao===null)throw Error(i(459));var s=Ao;return Ao=null,s}function Pb(s){if(s===yl||s===od)throw Error(i(483))}var bl=null,xc=0;function cd(s){var a=xc;return xc+=1,bl===null&&(bl=[]),Ib(bl,s,a)}function wc(s,a){a=a.props.ref,s.ref=a!==void 0?a:null}function ud(s,a){throw a.$$typeof===T?Error(i(525)):(s=Object.prototype.toString.call(a),Error(i(31,s==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":s)))}function Lb(s){function a(ee,K){if(s){var oe=ee.deletions;oe===null?(ee.deletions=[K],ee.flags|=16):oe.push(K)}}function o(ee,K){if(!s)return null;for(;K!==null;)a(ee,K),K=K.sibling;return null}function c(ee){for(var K=new Map;ee!==null;)ee.key!==null?K.set(ee.key,ee):K.set(ee.index,ee),ee=ee.sibling;return K}function m(ee,K){return ee=Xa(ee,K),ee.index=0,ee.sibling=null,ee}function f(ee,K,oe){return ee.index=oe,s?(oe=ee.alternate,oe!==null?(oe=oe.index,oe<K?(ee.flags|=67108866,K):oe):(ee.flags|=67108866,K)):(ee.flags|=1048576,K)}function w(ee){return s&&ee.alternate===null&&(ee.flags|=67108866),ee}function S(ee,K,oe,Ae){return K===null||K.tag!==6?(K=Im(oe,ee.mode,Ae),K.return=ee,K):(K=m(K,oe),K.return=ee,K)}function q(ee,K,oe,Ae){var Rt=oe.type;return Rt===F?je(ee,K,oe.props.children,Ae,oe.key):K!==null&&(K.elementType===Rt||typeof Rt=="object"&&Rt!==null&&Rt.$$typeof===E&&Ro(Rt)===K.type)?(K=m(K,oe.props),wc(K,oe),K.return=ee,K):(K=sd(oe.type,oe.key,oe.props,null,ee.mode,Ae),wc(K,oe),K.return=ee,K)}function le(ee,K,oe,Ae){return K===null||K.tag!==4||K.stateNode.containerInfo!==oe.containerInfo||K.stateNode.implementation!==oe.implementation?(K=Dm(oe,ee.mode,Ae),K.return=ee,K):(K=m(K,oe.children||[]),K.return=ee,K)}function je(ee,K,oe,Ae,Rt){return K===null||K.tag!==7?(K=To(oe,ee.mode,Ae,Rt),K.return=ee,K):(K=m(K,oe),K.return=ee,K)}function De(ee,K,oe){if(typeof K=="string"&&K!==""||typeof K=="number"||typeof K=="bigint")return K=Im(""+K,ee.mode,oe),K.return=ee,K;if(typeof K=="object"&&K!==null){switch(K.$$typeof){case O:return oe=sd(K.type,K.key,K.props,null,ee.mode,oe),wc(oe,K),oe.return=ee,oe;case G:return K=Dm(K,ee.mode,oe),K.return=ee,K;case E:return K=Ro(K),De(ee,K,oe)}if(mt(K)||H(K))return K=To(K,ee.mode,oe,null),K.return=ee,K;if(typeof K.then=="function")return De(ee,cd(K),oe);if(K.$$typeof===ie)return De(ee,ad(ee,K),oe);ud(ee,K)}return null}function ce(ee,K,oe,Ae){var Rt=K!==null?K.key:null;if(typeof oe=="string"&&oe!==""||typeof oe=="number"||typeof oe=="bigint")return Rt!==null?null:S(ee,K,""+oe,Ae);if(typeof oe=="object"&&oe!==null){switch(oe.$$typeof){case O:return oe.key===Rt?q(ee,K,oe,Ae):null;case G:return oe.key===Rt?le(ee,K,oe,Ae):null;case E:return oe=Ro(oe),ce(ee,K,oe,Ae)}if(mt(oe)||H(oe))return Rt!==null?null:je(ee,K,oe,Ae,null);if(typeof oe.then=="function")return ce(ee,K,cd(oe),Ae);if(oe.$$typeof===ie)return ce(ee,K,ad(ee,oe),Ae);ud(ee,oe)}return null}function xe(ee,K,oe,Ae,Rt){if(typeof Ae=="string"&&Ae!==""||typeof Ae=="number"||typeof Ae=="bigint")return ee=ee.get(oe)||null,S(K,ee,""+Ae,Rt);if(typeof Ae=="object"&&Ae!==null){switch(Ae.$$typeof){case O:return ee=ee.get(Ae.key===null?oe:Ae.key)||null,q(K,ee,Ae,Rt);case G:return ee=ee.get(Ae.key===null?oe:Ae.key)||null,le(K,ee,Ae,Rt);case E:return Ae=Ro(Ae),xe(ee,K,oe,Ae,Rt)}if(mt(Ae)||H(Ae))return ee=ee.get(oe)||null,je(K,ee,Ae,Rt,null);if(typeof Ae.then=="function")return xe(ee,K,oe,cd(Ae),Rt);if(Ae.$$typeof===ie)return xe(ee,K,oe,ad(K,Ae),Rt);ud(K,Ae)}return null}function gt(ee,K,oe,Ae){for(var Rt=null,Is=null,wt=K,rs=K=0,bs=null;wt!==null&&rs<oe.length;rs++){wt.index>rs?(bs=wt,wt=null):bs=wt.sibling;var Ds=ce(ee,wt,oe[rs],Ae);if(Ds===null){wt===null&&(wt=bs);break}s&&wt&&Ds.alternate===null&&a(ee,wt),K=f(Ds,K,rs),Is===null?Rt=Ds:Is.sibling=Ds,Is=Ds,wt=bs}if(rs===oe.length)return o(ee,wt),js&&Ja(ee,rs),Rt;if(wt===null){for(;rs<oe.length;rs++)wt=De(ee,oe[rs],Ae),wt!==null&&(K=f(wt,K,rs),Is===null?Rt=wt:Is.sibling=wt,Is=wt);return js&&Ja(ee,rs),Rt}for(wt=c(wt);rs<oe.length;rs++)bs=xe(wt,ee,rs,oe[rs],Ae),bs!==null&&(s&&bs.alternate!==null&&wt.delete(bs.key===null?rs:bs.key),K=f(bs,K,rs),Is===null?Rt=bs:Is.sibling=bs,Is=bs);return s&&wt.forEach(function(Gi){return a(ee,Gi)}),js&&Ja(ee,rs),Rt}function Ot(ee,K,oe,Ae){if(oe==null)throw Error(i(151));for(var Rt=null,Is=null,wt=K,rs=K=0,bs=null,Ds=oe.next();wt!==null&&!Ds.done;rs++,Ds=oe.next()){wt.index>rs?(bs=wt,wt=null):bs=wt.sibling;var Gi=ce(ee,wt,Ds.value,Ae);if(Gi===null){wt===null&&(wt=bs);break}s&&wt&&Gi.alternate===null&&a(ee,wt),K=f(Gi,K,rs),Is===null?Rt=Gi:Is.sibling=Gi,Is=Gi,wt=bs}if(Ds.done)return o(ee,wt),js&&Ja(ee,rs),Rt;if(wt===null){for(;!Ds.done;rs++,Ds=oe.next())Ds=De(ee,Ds.value,Ae),Ds!==null&&(K=f(Ds,K,rs),Is===null?Rt=Ds:Is.sibling=Ds,Is=Ds);return js&&Ja(ee,rs),Rt}for(wt=c(wt);!Ds.done;rs++,Ds=oe.next())Ds=xe(wt,ee,rs,Ds.value,Ae),Ds!==null&&(s&&Ds.alternate!==null&&wt.delete(Ds.key===null?rs:Ds.key),K=f(Ds,K,rs),Is===null?Rt=Ds:Is.sibling=Ds,Is=Ds);return s&&wt.forEach(function(_T){return a(ee,_T)}),js&&Ja(ee,rs),Rt}function Js(ee,K,oe,Ae){if(typeof oe=="object"&&oe!==null&&oe.type===F&&oe.key===null&&(oe=oe.props.children),typeof oe=="object"&&oe!==null){switch(oe.$$typeof){case O:e:{for(var Rt=oe.key;K!==null;){if(K.key===Rt){if(Rt=oe.type,Rt===F){if(K.tag===7){o(ee,K.sibling),Ae=m(K,oe.props.children),Ae.return=ee,ee=Ae;break e}}else if(K.elementType===Rt||typeof Rt=="object"&&Rt!==null&&Rt.$$typeof===E&&Ro(Rt)===K.type){o(ee,K.sibling),Ae=m(K,oe.props),wc(Ae,oe),Ae.return=ee,ee=Ae;break e}o(ee,K);break}else a(ee,K);K=K.sibling}oe.type===F?(Ae=To(oe.props.children,ee.mode,Ae,oe.key),Ae.return=ee,ee=Ae):(Ae=sd(oe.type,oe.key,oe.props,null,ee.mode,Ae),wc(Ae,oe),Ae.return=ee,ee=Ae)}return w(ee);case G:e:{for(Rt=oe.key;K!==null;){if(K.key===Rt)if(K.tag===4&&K.stateNode.containerInfo===oe.containerInfo&&K.stateNode.implementation===oe.implementation){o(ee,K.sibling),Ae=m(K,oe.children||[]),Ae.return=ee,ee=Ae;break e}else{o(ee,K);break}else a(ee,K);K=K.sibling}Ae=Dm(oe,ee.mode,Ae),Ae.return=ee,ee=Ae}return w(ee);case E:return oe=Ro(oe),Js(ee,K,oe,Ae)}if(mt(oe))return gt(ee,K,oe,Ae);if(H(oe)){if(Rt=H(oe),typeof Rt!="function")throw Error(i(150));return oe=Rt.call(oe),Ot(ee,K,oe,Ae)}if(typeof oe.then=="function")return Js(ee,K,cd(oe),Ae);if(oe.$$typeof===ie)return Js(ee,K,ad(ee,oe),Ae);ud(ee,oe)}return typeof oe=="string"&&oe!==""||typeof oe=="number"||typeof oe=="bigint"?(oe=""+oe,K!==null&&K.tag===6?(o(ee,K.sibling),Ae=m(K,oe),Ae.return=ee,ee=Ae):(o(ee,K),Ae=Im(oe,ee.mode,Ae),Ae.return=ee,ee=Ae),w(ee)):o(ee,K)}return function(ee,K,oe,Ae){try{xc=0;var Rt=Js(ee,K,oe,Ae);return bl=null,Rt}catch(wt){if(wt===yl||wt===od)throw wt;var Is=Hr(29,wt,null,ee.mode);return Is.lanes=Ae,Is.return=ee,Is}}}var Mo=Lb(!0),Ob=Lb(!1),Ri=!1;function Wm(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Gm(s,a){s=s.updateQueue,a.updateQueue===s&&(a.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function Ai(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function Mi(s,a,o){var c=s.updateQueue;if(c===null)return null;if(c=c.shared,(Bs&2)!==0){var m=c.pending;return m===null?a.next=a:(a.next=m.next,m.next=a),c.pending=a,a=td(s),xb(s,null,o),a}return ed(s,c,a,o),td(s)}function _c(s,a,o){if(a=a.updateQueue,a!==null&&(a=a.shared,(o&4194048)!==0)){var c=a.lanes;c&=s.pendingLanes,o|=c,a.lanes=o,ks(s,o)}}function Km(s,a){var o=s.updateQueue,c=s.alternate;if(c!==null&&(c=c.updateQueue,o===c)){var m=null,f=null;if(o=o.firstBaseUpdate,o!==null){do{var w={lane:o.lane,tag:o.tag,payload:o.payload,callback:null,next:null};f===null?m=f=w:f=f.next=w,o=o.next}while(o!==null);f===null?m=f=a:f=f.next=a}else m=f=a;o={baseState:c.baseState,firstBaseUpdate:m,lastBaseUpdate:f,shared:c.shared,callbacks:c.callbacks},s.updateQueue=o;return}s=o.lastBaseUpdate,s===null?o.firstBaseUpdate=a:s.next=a,o.lastBaseUpdate=a}var Ym=!1;function kc(){if(Ym){var s=gl;if(s!==null)throw s}}function jc(s,a,o,c){Ym=!1;var m=s.updateQueue;Ri=!1;var f=m.firstBaseUpdate,w=m.lastBaseUpdate,S=m.shared.pending;if(S!==null){m.shared.pending=null;var q=S,le=q.next;q.next=null,w===null?f=le:w.next=le,w=q;var je=s.alternate;je!==null&&(je=je.updateQueue,S=je.lastBaseUpdate,S!==w&&(S===null?je.firstBaseUpdate=le:S.next=le,je.lastBaseUpdate=q))}if(f!==null){var De=m.baseState;w=0,je=le=q=null,S=f;do{var ce=S.lane&-536870913,xe=ce!==S.lane;if(xe?(ys&ce)===ce:(c&ce)===ce){ce!==0&&ce===pl&&(Ym=!0),je!==null&&(je=je.next={lane:0,tag:S.tag,payload:S.payload,callback:null,next:null});e:{var gt=s,Ot=S;ce=a;var Js=o;switch(Ot.tag){case 1:if(gt=Ot.payload,typeof gt=="function"){De=gt.call(Js,De,ce);break e}De=gt;break e;case 3:gt.flags=gt.flags&-65537|128;case 0:if(gt=Ot.payload,ce=typeof gt=="function"?gt.call(Js,De,ce):gt,ce==null)break e;De=k({},De,ce);break e;case 2:Ri=!0}}ce=S.callback,ce!==null&&(s.flags|=64,xe&&(s.flags|=8192),xe=m.callbacks,xe===null?m.callbacks=[ce]:xe.push(ce))}else xe={lane:ce,tag:S.tag,payload:S.payload,callback:S.callback,next:null},je===null?(le=je=xe,q=De):je=je.next=xe,w|=ce;if(S=S.next,S===null){if(S=m.shared.pending,S===null)break;xe=S,S=xe.next,xe.next=null,m.lastBaseUpdate=xe,m.shared.pending=null}}while(!0);je===null&&(q=De),m.baseState=q,m.firstBaseUpdate=le,m.lastBaseUpdate=je,f===null&&(m.shared.lanes=0),Oi|=w,s.lanes=w,s.memoizedState=De}}function Bb(s,a){if(typeof s!="function")throw Error(i(191,s));s.call(a)}function Vb(s,a){var o=s.callbacks;if(o!==null)for(s.callbacks=null,s=0;s<o.length;s++)Bb(o[s],a)}var vl=L(null),dd=L(0);function Ub(s,a){s=ci,Ie(dd,s),Ie(vl,a),ci=s|a.baseLanes}function Qm(){Ie(dd,ci),Ie(vl,vl.current)}function Xm(){ci=dd.current,ne(vl),ne(dd)}var $r=L(null),ia=null;function Ii(s){var a=s.alternate;Ie(Sn,Sn.current&1),Ie($r,s),ia===null&&(a===null||vl.current!==null||a.memoizedState!==null)&&(ia=s)}function Jm(s){Ie(Sn,Sn.current),Ie($r,s),ia===null&&(ia=s)}function Fb(s){s.tag===22?(Ie(Sn,Sn.current),Ie($r,s),ia===null&&(ia=s)):Di()}function Di(){Ie(Sn,Sn.current),Ie($r,$r.current)}function Wr(s){ne($r),ia===s&&(ia=null),ne(Sn)}var Sn=L(0);function hd(s){for(var a=s;a!==null;){if(a.tag===13){var o=a.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||ap(o)||ip(o)))return a}else if(a.tag===19&&(a.memoizedProps.revealOrder==="forwards"||a.memoizedProps.revealOrder==="backwards"||a.memoizedProps.revealOrder==="unstable_legacy-backwards"||a.memoizedProps.revealOrder==="together")){if((a.flags&128)!==0)return a}else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===s)break;for(;a.sibling===null;){if(a.return===null||a.return===s)return null;a=a.return}a.sibling.return=a.return,a=a.sibling}return null}var ti=0,ns=null,Qs=null,Ln=null,md=!1,xl=!1,Io=!1,fd=0,Tc=0,wl=null,hj=0;function xn(){throw Error(i(321))}function Zm(s,a){if(a===null)return!1;for(var o=0;o<a.length&&o<s.length;o++)if(!qr(s[o],a[o]))return!1;return!0}function ef(s,a,o,c,m,f){return ti=f,ns=a,a.memoizedState=null,a.updateQueue=null,a.lanes=0,W.H=s===null||s.memoizedState===null?j0:gf,Io=!1,f=o(c,m),Io=!1,xl&&(f=qb(a,o,c,m)),zb(s),f}function zb(s){W.H=Nc;var a=Qs!==null&&Qs.next!==null;if(ti=0,Ln=Qs=ns=null,md=!1,Tc=0,wl=null,a)throw Error(i(300));s===null||On||(s=s.dependencies,s!==null&&rd(s)&&(On=!0))}function qb(s,a,o,c){ns=s;var m=0;do{if(xl&&(wl=null),Tc=0,xl=!1,25<=m)throw Error(i(301));if(m+=1,Ln=Qs=null,s.updateQueue!=null){var f=s.updateQueue;f.lastEffect=null,f.events=null,f.stores=null,f.memoCache!=null&&(f.memoCache.index=0)}W.H=T0,f=a(o,c)}while(xl);return f}function mj(){var s=W.H,a=s.useState()[0];return a=typeof a.then=="function"?Ec(a):a,s=s.useState()[0],(Qs!==null?Qs.memoizedState:null)!==s&&(ns.flags|=1024),a}function tf(){var s=fd!==0;return fd=0,s}function sf(s,a,o){a.updateQueue=s.updateQueue,a.flags&=-2053,s.lanes&=~o}function nf(s){if(md){for(s=s.memoizedState;s!==null;){var a=s.queue;a!==null&&(a.pending=null),s=s.next}md=!1}ti=0,Ln=Qs=ns=null,xl=!1,Tc=fd=0,wl=null}function _r(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ln===null?ns.memoizedState=Ln=s:Ln=Ln.next=s,Ln}function Nn(){if(Qs===null){var s=ns.alternate;s=s!==null?s.memoizedState:null}else s=Qs.next;var a=Ln===null?ns.memoizedState:Ln.next;if(a!==null)Ln=a,Qs=s;else{if(s===null)throw ns.alternate===null?Error(i(467)):Error(i(310));Qs=s,s={memoizedState:Qs.memoizedState,baseState:Qs.baseState,baseQueue:Qs.baseQueue,queue:Qs.queue,next:null},Ln===null?ns.memoizedState=Ln=s:Ln=Ln.next=s}return Ln}function pd(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Ec(s){var a=Tc;return Tc+=1,wl===null&&(wl=[]),s=Ib(wl,s,a),a=ns,(Ln===null?a.memoizedState:Ln.next)===null&&(a=a.alternate,W.H=a===null||a.memoizedState===null?j0:gf),s}function gd(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return Ec(s);if(s.$$typeof===ie)return sr(s)}throw Error(i(438,String(s)))}function rf(s){var a=null,o=ns.updateQueue;if(o!==null&&(a=o.memoCache),a==null){var c=ns.alternate;c!==null&&(c=c.updateQueue,c!==null&&(c=c.memoCache,c!=null&&(a={data:c.data.map(function(m){return m.slice()}),index:0})))}if(a==null&&(a={data:[],index:0}),o===null&&(o=pd(),ns.updateQueue=o),o.memoCache=a,o=a.data[a.index],o===void 0)for(o=a.data[a.index]=Array(s),c=0;c<s;c++)o[c]=B;return a.index++,o}function si(s,a){return typeof a=="function"?a(s):a}function yd(s){var a=Nn();return af(a,Qs,s)}function af(s,a,o){var c=s.queue;if(c===null)throw Error(i(311));c.lastRenderedReducer=o;var m=s.baseQueue,f=c.pending;if(f!==null){if(m!==null){var w=m.next;m.next=f.next,f.next=w}a.baseQueue=m=f,c.pending=null}if(f=s.baseState,m===null)s.memoizedState=f;else{a=m.next;var S=w=null,q=null,le=a,je=!1;do{var De=le.lane&-536870913;if(De!==le.lane?(ys&De)===De:(ti&De)===De){var ce=le.revertLane;if(ce===0)q!==null&&(q=q.next={lane:0,revertLane:0,gesture:null,action:le.action,hasEagerState:le.hasEagerState,eagerState:le.eagerState,next:null}),De===pl&&(je=!0);else if((ti&ce)===ce){le=le.next,ce===pl&&(je=!0);continue}else De={lane:0,revertLane:le.revertLane,gesture:null,action:le.action,hasEagerState:le.hasEagerState,eagerState:le.eagerState,next:null},q===null?(S=q=De,w=f):q=q.next=De,ns.lanes|=ce,Oi|=ce;De=le.action,Io&&o(f,De),f=le.hasEagerState?le.eagerState:o(f,De)}else ce={lane:De,revertLane:le.revertLane,gesture:le.gesture,action:le.action,hasEagerState:le.hasEagerState,eagerState:le.eagerState,next:null},q===null?(S=q=ce,w=f):q=q.next=ce,ns.lanes|=De,Oi|=De;le=le.next}while(le!==null&&le!==a);if(q===null?w=f:q.next=S,!qr(f,s.memoizedState)&&(On=!0,je&&(o=gl,o!==null)))throw o;s.memoizedState=f,s.baseState=w,s.baseQueue=q,c.lastRenderedState=f}return m===null&&(c.lanes=0),[s.memoizedState,c.dispatch]}function of(s){var a=Nn(),o=a.queue;if(o===null)throw Error(i(311));o.lastRenderedReducer=s;var c=o.dispatch,m=o.pending,f=a.memoizedState;if(m!==null){o.pending=null;var w=m=m.next;do f=s(f,w.action),w=w.next;while(w!==m);qr(f,a.memoizedState)||(On=!0),a.memoizedState=f,a.baseQueue===null&&(a.baseState=f),o.lastRenderedState=f}return[f,c]}function Hb(s,a,o){var c=ns,m=Nn(),f=js;if(f){if(o===void 0)throw Error(i(407));o=o()}else o=a();var w=!qr((Qs||m).memoizedState,o);if(w&&(m.memoizedState=o,On=!0),m=m.queue,uf(Gb.bind(null,c,m,s),[s]),m.getSnapshot!==a||w||Ln!==null&&Ln.memoizedState.tag&1){if(c.flags|=2048,_l(9,{destroy:void 0},Wb.bind(null,c,m,o,a),null),sn===null)throw Error(i(349));f||(ti&127)!==0||$b(c,a,o)}return o}function $b(s,a,o){s.flags|=16384,s={getSnapshot:a,value:o},a=ns.updateQueue,a===null?(a=pd(),ns.updateQueue=a,a.stores=[s]):(o=a.stores,o===null?a.stores=[s]:o.push(s))}function Wb(s,a,o,c){a.value=o,a.getSnapshot=c,Kb(a)&&Yb(s)}function Gb(s,a,o){return o(function(){Kb(a)&&Yb(s)})}function Kb(s){var a=s.getSnapshot;s=s.value;try{var o=a();return!qr(s,o)}catch{return!0}}function Yb(s){var a=jo(s,2);a!==null&&Lr(a,s,2)}function lf(s){var a=_r();if(typeof s=="function"){var o=s;if(s=o(),Io){Be(!0);try{o()}finally{Be(!1)}}}return a.memoizedState=a.baseState=s,a.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:si,lastRenderedState:s},a}function Qb(s,a,o,c){return s.baseState=o,af(s,Qs,typeof c=="function"?c:si)}function fj(s,a,o,c,m){if(xd(s))throw Error(i(485));if(s=a.action,s!==null){var f={payload:m,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(w){f.listeners.push(w)}};W.T!==null?o(!0):f.isTransition=!1,c(f),o=a.pending,o===null?(f.next=a.pending=f,Xb(a,f)):(f.next=o.next,a.pending=o.next=f)}}function Xb(s,a){var o=a.action,c=a.payload,m=s.state;if(a.isTransition){var f=W.T,w={};W.T=w;try{var S=o(m,c),q=W.S;q!==null&&q(w,S),Jb(s,a,S)}catch(le){cf(s,a,le)}finally{f!==null&&w.types!==null&&(f.types=w.types),W.T=f}}else try{f=o(m,c),Jb(s,a,f)}catch(le){cf(s,a,le)}}function Jb(s,a,o){o!==null&&typeof o=="object"&&typeof o.then=="function"?o.then(function(c){Zb(s,a,c)},function(c){return cf(s,a,c)}):Zb(s,a,o)}function Zb(s,a,o){a.status="fulfilled",a.value=o,e0(a),s.state=o,a=s.pending,a!==null&&(o=a.next,o===a?s.pending=null:(o=o.next,a.next=o,Xb(s,o)))}function cf(s,a,o){var c=s.pending;if(s.pending=null,c!==null){c=c.next;do a.status="rejected",a.reason=o,e0(a),a=a.next;while(a!==c)}s.action=null}function e0(s){s=s.listeners;for(var a=0;a<s.length;a++)(0,s[a])()}function t0(s,a){return a}function s0(s,a){if(js){var o=sn.formState;if(o!==null){e:{var c=ns;if(js){if(cn){t:{for(var m=cn,f=aa;m.nodeType!==8;){if(!f){m=null;break t}if(m=oa(m.nextSibling),m===null){m=null;break t}}f=m.data,m=f==="F!"||f==="F"?m:null}if(m){cn=oa(m.nextSibling),c=m.data==="F!";break e}}Ni(c)}c=!1}c&&(a=o[0])}}return o=_r(),o.memoizedState=o.baseState=a,c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:t0,lastRenderedState:a},o.queue=c,o=w0.bind(null,ns,c),c.dispatch=o,c=lf(!1),f=pf.bind(null,ns,!1,c.queue),c=_r(),m={state:a,dispatch:null,action:s,pending:null},c.queue=m,o=fj.bind(null,ns,m,f,o),m.dispatch=o,c.memoizedState=s,[a,o,!1]}function n0(s){var a=Nn();return r0(a,Qs,s)}function r0(s,a,o){if(a=af(s,a,t0)[0],s=yd(si)[0],typeof a=="object"&&a!==null&&typeof a.then=="function")try{var c=Ec(a)}catch(w){throw w===yl?od:w}else c=a;a=Nn();var m=a.queue,f=m.dispatch;return o!==a.memoizedState&&(ns.flags|=2048,_l(9,{destroy:void 0},pj.bind(null,m,o),null)),[c,f,s]}function pj(s,a){s.action=a}function a0(s){var a=Nn(),o=Qs;if(o!==null)return r0(a,o,s);Nn(),a=a.memoizedState,o=Nn();var c=o.queue.dispatch;return o.memoizedState=s,[a,c,!1]}function _l(s,a,o,c){return s={tag:s,create:o,deps:c,inst:a,next:null},a=ns.updateQueue,a===null&&(a=pd(),ns.updateQueue=a),o=a.lastEffect,o===null?a.lastEffect=s.next=s:(c=o.next,o.next=s,s.next=c,a.lastEffect=s),s}function i0(){return Nn().memoizedState}function bd(s,a,o,c){var m=_r();ns.flags|=s,m.memoizedState=_l(1|a,{destroy:void 0},o,c===void 0?null:c)}function vd(s,a,o,c){var m=Nn();c=c===void 0?null:c;var f=m.memoizedState.inst;Qs!==null&&c!==null&&Zm(c,Qs.memoizedState.deps)?m.memoizedState=_l(a,f,o,c):(ns.flags|=s,m.memoizedState=_l(1|a,f,o,c))}function o0(s,a){bd(8390656,8,s,a)}function uf(s,a){vd(2048,8,s,a)}function gj(s){ns.flags|=4;var a=ns.updateQueue;if(a===null)a=pd(),ns.updateQueue=a,a.events=[s];else{var o=a.events;o===null?a.events=[s]:o.push(s)}}function l0(s){var a=Nn().memoizedState;return gj({ref:a,nextImpl:s}),function(){if((Bs&2)!==0)throw Error(i(440));return a.impl.apply(void 0,arguments)}}function c0(s,a){return vd(4,2,s,a)}function u0(s,a){return vd(4,4,s,a)}function d0(s,a){if(typeof a=="function"){s=s();var o=a(s);return function(){typeof o=="function"?o():a(null)}}if(a!=null)return s=s(),a.current=s,function(){a.current=null}}function h0(s,a,o){o=o!=null?o.concat([s]):null,vd(4,4,d0.bind(null,a,s),o)}function df(){}function m0(s,a){var o=Nn();a=a===void 0?null:a;var c=o.memoizedState;return a!==null&&Zm(a,c[1])?c[0]:(o.memoizedState=[s,a],s)}function f0(s,a){var o=Nn();a=a===void 0?null:a;var c=o.memoizedState;if(a!==null&&Zm(a,c[1]))return c[0];if(c=s(),Io){Be(!0);try{s()}finally{Be(!1)}}return o.memoizedState=[c,a],c}function hf(s,a,o){return o===void 0||(ti&1073741824)!==0&&(ys&261930)===0?s.memoizedState=a:(s.memoizedState=o,s=pv(),ns.lanes|=s,Oi|=s,o)}function p0(s,a,o,c){return qr(o,a)?o:vl.current!==null?(s=hf(s,o,c),qr(s,a)||(On=!0),s):(ti&42)===0||(ti&1073741824)!==0&&(ys&261930)===0?(On=!0,s.memoizedState=o):(s=pv(),ns.lanes|=s,Oi|=s,a)}function g0(s,a,o,c,m){var f=ue.p;ue.p=f!==0&&8>f?f:8;var w=W.T,S={};W.T=S,pf(s,!1,a,o);try{var q=m(),le=W.S;if(le!==null&&le(S,q),q!==null&&typeof q=="object"&&typeof q.then=="function"){var je=dj(q,c);Sc(s,a,je,Yr(s))}else Sc(s,a,c,Yr(s))}catch(De){Sc(s,a,{then:function(){},status:"rejected",reason:De},Yr())}finally{ue.p=f,w!==null&&S.types!==null&&(w.types=S.types),W.T=w}}function yj(){}function mf(s,a,o,c){if(s.tag!==5)throw Error(i(476));var m=y0(s).queue;g0(s,m,a,Re,o===null?yj:function(){return b0(s),o(c)})}function y0(s){var a=s.memoizedState;if(a!==null)return a;a={memoizedState:Re,baseState:Re,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:si,lastRenderedState:Re},next:null};var o={};return a.next={memoizedState:o,baseState:o,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:si,lastRenderedState:o},next:null},s.memoizedState=a,s=s.alternate,s!==null&&(s.memoizedState=a),a}function b0(s){var a=y0(s);a.next===null&&(a=s.alternate.memoizedState),Sc(s,a.next.queue,{},Yr())}function ff(){return sr(Hc)}function v0(){return Nn().memoizedState}function x0(){return Nn().memoizedState}function bj(s){for(var a=s.return;a!==null;){switch(a.tag){case 24:case 3:var o=Yr();s=Ai(o);var c=Mi(a,s,o);c!==null&&(Lr(c,a,o),_c(c,a,o)),a={cache:zm()},s.payload=a;return}a=a.return}}function vj(s,a,o){var c=Yr();o={lane:c,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null},xd(s)?_0(a,o):(o=Am(s,a,o,c),o!==null&&(Lr(o,s,c),k0(o,a,c)))}function w0(s,a,o){var c=Yr();Sc(s,a,o,c)}function Sc(s,a,o,c){var m={lane:c,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null};if(xd(s))_0(a,m);else{var f=s.alternate;if(s.lanes===0&&(f===null||f.lanes===0)&&(f=a.lastRenderedReducer,f!==null))try{var w=a.lastRenderedState,S=f(w,o);if(m.hasEagerState=!0,m.eagerState=S,qr(S,w))return ed(s,a,m,0),sn===null&&Zu(),!1}catch{}if(o=Am(s,a,m,c),o!==null)return Lr(o,s,c),k0(o,a,c),!0}return!1}function pf(s,a,o,c){if(c={lane:2,revertLane:Gf(),gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},xd(s)){if(a)throw Error(i(479))}else a=Am(s,o,c,2),a!==null&&Lr(a,s,2)}function xd(s){var a=s.alternate;return s===ns||a!==null&&a===ns}function _0(s,a){xl=md=!0;var o=s.pending;o===null?a.next=a:(a.next=o.next,o.next=a),s.pending=a}function k0(s,a,o){if((o&4194048)!==0){var c=a.lanes;c&=s.pendingLanes,o|=c,a.lanes=o,ks(s,o)}}var Nc={readContext:sr,use:gd,useCallback:xn,useContext:xn,useEffect:xn,useImperativeHandle:xn,useLayoutEffect:xn,useInsertionEffect:xn,useMemo:xn,useReducer:xn,useRef:xn,useState:xn,useDebugValue:xn,useDeferredValue:xn,useTransition:xn,useSyncExternalStore:xn,useId:xn,useHostTransitionStatus:xn,useFormState:xn,useActionState:xn,useOptimistic:xn,useMemoCache:xn,useCacheRefresh:xn};Nc.useEffectEvent=xn;var j0={readContext:sr,use:gd,useCallback:function(s,a){return _r().memoizedState=[s,a===void 0?null:a],s},useContext:sr,useEffect:o0,useImperativeHandle:function(s,a,o){o=o!=null?o.concat([s]):null,bd(4194308,4,d0.bind(null,a,s),o)},useLayoutEffect:function(s,a){return bd(4194308,4,s,a)},useInsertionEffect:function(s,a){bd(4,2,s,a)},useMemo:function(s,a){var o=_r();a=a===void 0?null:a;var c=s();if(Io){Be(!0);try{s()}finally{Be(!1)}}return o.memoizedState=[c,a],c},useReducer:function(s,a,o){var c=_r();if(o!==void 0){var m=o(a);if(Io){Be(!0);try{o(a)}finally{Be(!1)}}}else m=a;return c.memoizedState=c.baseState=m,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:m},c.queue=s,s=s.dispatch=vj.bind(null,ns,s),[c.memoizedState,s]},useRef:function(s){var a=_r();return s={current:s},a.memoizedState=s},useState:function(s){s=lf(s);var a=s.queue,o=w0.bind(null,ns,a);return a.dispatch=o,[s.memoizedState,o]},useDebugValue:df,useDeferredValue:function(s,a){var o=_r();return hf(o,s,a)},useTransition:function(){var s=lf(!1);return s=g0.bind(null,ns,s.queue,!0,!1),_r().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,a,o){var c=ns,m=_r();if(js){if(o===void 0)throw Error(i(407));o=o()}else{if(o=a(),sn===null)throw Error(i(349));(ys&127)!==0||$b(c,a,o)}m.memoizedState=o;var f={value:o,getSnapshot:a};return m.queue=f,o0(Gb.bind(null,c,f,s),[s]),c.flags|=2048,_l(9,{destroy:void 0},Wb.bind(null,c,f,o,a),null),o},useId:function(){var s=_r(),a=sn.identifierPrefix;if(js){var o=Ia,c=Ma;o=(c&~(1<<32-Ue(c)-1)).toString(32)+o,a="_"+a+"R_"+o,o=fd++,0<o&&(a+="H"+o.toString(32)),a+="_"}else o=hj++,a="_"+a+"r_"+o.toString(32)+"_";return s.memoizedState=a},useHostTransitionStatus:ff,useFormState:s0,useActionState:s0,useOptimistic:function(s){var a=_r();a.memoizedState=a.baseState=s;var o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return a.queue=o,a=pf.bind(null,ns,!0,o),o.dispatch=a,[s,a]},useMemoCache:rf,useCacheRefresh:function(){return _r().memoizedState=bj.bind(null,ns)},useEffectEvent:function(s){var a=_r(),o={impl:s};return a.memoizedState=o,function(){if((Bs&2)!==0)throw Error(i(440));return o.impl.apply(void 0,arguments)}}},gf={readContext:sr,use:gd,useCallback:m0,useContext:sr,useEffect:uf,useImperativeHandle:h0,useInsertionEffect:c0,useLayoutEffect:u0,useMemo:f0,useReducer:yd,useRef:i0,useState:function(){return yd(si)},useDebugValue:df,useDeferredValue:function(s,a){var o=Nn();return p0(o,Qs.memoizedState,s,a)},useTransition:function(){var s=yd(si)[0],a=Nn().memoizedState;return[typeof s=="boolean"?s:Ec(s),a]},useSyncExternalStore:Hb,useId:v0,useHostTransitionStatus:ff,useFormState:n0,useActionState:n0,useOptimistic:function(s,a){var o=Nn();return Qb(o,Qs,s,a)},useMemoCache:rf,useCacheRefresh:x0};gf.useEffectEvent=l0;var T0={readContext:sr,use:gd,useCallback:m0,useContext:sr,useEffect:uf,useImperativeHandle:h0,useInsertionEffect:c0,useLayoutEffect:u0,useMemo:f0,useReducer:of,useRef:i0,useState:function(){return of(si)},useDebugValue:df,useDeferredValue:function(s,a){var o=Nn();return Qs===null?hf(o,s,a):p0(o,Qs.memoizedState,s,a)},useTransition:function(){var s=of(si)[0],a=Nn().memoizedState;return[typeof s=="boolean"?s:Ec(s),a]},useSyncExternalStore:Hb,useId:v0,useHostTransitionStatus:ff,useFormState:a0,useActionState:a0,useOptimistic:function(s,a){var o=Nn();return Qs!==null?Qb(o,Qs,s,a):(o.baseState=s,[s,o.queue.dispatch])},useMemoCache:rf,useCacheRefresh:x0};T0.useEffectEvent=l0;function yf(s,a,o,c){a=s.memoizedState,o=o(c,a),o=o==null?a:k({},a,o),s.memoizedState=o,s.lanes===0&&(s.updateQueue.baseState=o)}var bf={enqueueSetState:function(s,a,o){s=s._reactInternals;var c=Yr(),m=Ai(c);m.payload=a,o!=null&&(m.callback=o),a=Mi(s,m,c),a!==null&&(Lr(a,s,c),_c(a,s,c))},enqueueReplaceState:function(s,a,o){s=s._reactInternals;var c=Yr(),m=Ai(c);m.tag=1,m.payload=a,o!=null&&(m.callback=o),a=Mi(s,m,c),a!==null&&(Lr(a,s,c),_c(a,s,c))},enqueueForceUpdate:function(s,a){s=s._reactInternals;var o=Yr(),c=Ai(o);c.tag=2,a!=null&&(c.callback=a),a=Mi(s,c,o),a!==null&&(Lr(a,s,o),_c(a,s,o))}};function E0(s,a,o,c,m,f,w){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(c,f,w):a.prototype&&a.prototype.isPureReactComponent?!fc(o,c)||!fc(m,f):!0}function S0(s,a,o,c){s=a.state,typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps(o,c),typeof a.UNSAFE_componentWillReceiveProps=="function"&&a.UNSAFE_componentWillReceiveProps(o,c),a.state!==s&&bf.enqueueReplaceState(a,a.state,null)}function Do(s,a){var o=a;if("ref"in a){o={};for(var c in a)c!=="ref"&&(o[c]=a[c])}if(s=s.defaultProps){o===a&&(o=k({},o));for(var m in s)o[m]===void 0&&(o[m]=s[m])}return o}function N0(s){Ju(s)}function C0(s){console.error(s)}function R0(s){Ju(s)}function wd(s,a){try{var o=s.onUncaughtError;o(a.value,{componentStack:a.stack})}catch(c){setTimeout(function(){throw c})}}function A0(s,a,o){try{var c=s.onCaughtError;c(o.value,{componentStack:o.stack,errorBoundary:a.tag===1?a.stateNode:null})}catch(m){setTimeout(function(){throw m})}}function vf(s,a,o){return o=Ai(o),o.tag=3,o.payload={element:null},o.callback=function(){wd(s,a)},o}function M0(s){return s=Ai(s),s.tag=3,s}function I0(s,a,o,c){var m=o.type.getDerivedStateFromError;if(typeof m=="function"){var f=c.value;s.payload=function(){return m(f)},s.callback=function(){A0(a,o,c)}}var w=o.stateNode;w!==null&&typeof w.componentDidCatch=="function"&&(s.callback=function(){A0(a,o,c),typeof m!="function"&&(Bi===null?Bi=new Set([this]):Bi.add(this));var S=c.stack;this.componentDidCatch(c.value,{componentStack:S!==null?S:""})})}function xj(s,a,o,c,m){if(o.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){if(a=o.alternate,a!==null&&fl(a,o,m,!0),o=$r.current,o!==null){switch(o.tag){case 31:case 13:return ia===null?Id():o.alternate===null&&wn===0&&(wn=3),o.flags&=-257,o.flags|=65536,o.lanes=m,c===ld?o.flags|=16384:(a=o.updateQueue,a===null?o.updateQueue=new Set([c]):a.add(c),Hf(s,c,m)),!1;case 22:return o.flags|=65536,c===ld?o.flags|=16384:(a=o.updateQueue,a===null?(a={transitions:null,markerInstances:null,retryQueue:new Set([c])},o.updateQueue=a):(o=a.retryQueue,o===null?a.retryQueue=new Set([c]):o.add(c)),Hf(s,c,m)),!1}throw Error(i(435,o.tag))}return Hf(s,c,m),Id(),!1}if(js)return a=$r.current,a!==null?((a.flags&65536)===0&&(a.flags|=256),a.flags|=65536,a.lanes=m,c!==Om&&(s=Error(i(422),{cause:c}),yc(sa(s,o)))):(c!==Om&&(a=Error(i(423),{cause:c}),yc(sa(a,o))),s=s.current.alternate,s.flags|=65536,m&=-m,s.lanes|=m,c=sa(c,o),m=vf(s.stateNode,c,m),Km(s,m),wn!==4&&(wn=2)),!1;var f=Error(i(520),{cause:c});if(f=sa(f,o),Lc===null?Lc=[f]:Lc.push(f),wn!==4&&(wn=2),a===null)return!0;c=sa(c,o),o=a;do{switch(o.tag){case 3:return o.flags|=65536,s=m&-m,o.lanes|=s,s=vf(o.stateNode,c,s),Km(o,s),!1;case 1:if(a=o.type,f=o.stateNode,(o.flags&128)===0&&(typeof a.getDerivedStateFromError=="function"||f!==null&&typeof f.componentDidCatch=="function"&&(Bi===null||!Bi.has(f))))return o.flags|=65536,m&=-m,o.lanes|=m,m=M0(m),I0(m,s,o,c),Km(o,m),!1}o=o.return}while(o!==null);return!1}var xf=Error(i(461)),On=!1;function nr(s,a,o,c){a.child=s===null?Ob(a,null,o,c):Mo(a,s.child,o,c)}function D0(s,a,o,c,m){o=o.render;var f=a.ref;if("ref"in c){var w={};for(var S in c)S!=="ref"&&(w[S]=c[S])}else w=c;return No(a),c=ef(s,a,o,w,f,m),S=tf(),s!==null&&!On?(sf(s,a,m),ni(s,a,m)):(js&&S&&Pm(a),a.flags|=1,nr(s,a,c,m),a.child)}function P0(s,a,o,c,m){if(s===null){var f=o.type;return typeof f=="function"&&!Mm(f)&&f.defaultProps===void 0&&o.compare===null?(a.tag=15,a.type=f,L0(s,a,f,c,m)):(s=sd(o.type,null,c,a,a.mode,m),s.ref=a.ref,s.return=a,a.child=s)}if(f=s.child,!Nf(s,m)){var w=f.memoizedProps;if(o=o.compare,o=o!==null?o:fc,o(w,c)&&s.ref===a.ref)return ni(s,a,m)}return a.flags|=1,s=Xa(f,c),s.ref=a.ref,s.return=a,a.child=s}function L0(s,a,o,c,m){if(s!==null){var f=s.memoizedProps;if(fc(f,c)&&s.ref===a.ref)if(On=!1,a.pendingProps=c=f,Nf(s,m))(s.flags&131072)!==0&&(On=!0);else return a.lanes=s.lanes,ni(s,a,m)}return wf(s,a,o,c,m)}function O0(s,a,o,c){var m=c.children,f=s!==null?s.memoizedState:null;if(s===null&&a.stateNode===null&&(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),c.mode==="hidden"){if((a.flags&128)!==0){if(f=f!==null?f.baseLanes|o:o,s!==null){for(c=a.child=s.child,m=0;c!==null;)m=m|c.lanes|c.childLanes,c=c.sibling;c=m&~f}else c=0,a.child=null;return B0(s,a,f,o,c)}if((o&536870912)!==0)a.memoizedState={baseLanes:0,cachePool:null},s!==null&&id(a,f!==null?f.cachePool:null),f!==null?Ub(a,f):Qm(),Fb(a);else return c=a.lanes=536870912,B0(s,a,f!==null?f.baseLanes|o:o,o,c)}else f!==null?(id(a,f.cachePool),Ub(a,f),Di(),a.memoizedState=null):(s!==null&&id(a,null),Qm(),Di());return nr(s,a,m,o),a.child}function Cc(s,a){return s!==null&&s.tag===22||a.stateNode!==null||(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),a.sibling}function B0(s,a,o,c,m){var f=Hm();return f=f===null?null:{parent:Pn._currentValue,pool:f},a.memoizedState={baseLanes:o,cachePool:f},s!==null&&id(a,null),Qm(),Fb(a),s!==null&&fl(s,a,c,!0),a.childLanes=m,null}function _d(s,a){return a=jd({mode:a.mode,children:a.children},s.mode),a.ref=s.ref,s.child=a,a.return=s,a}function V0(s,a,o){return Mo(a,s.child,null,o),s=_d(a,a.pendingProps),s.flags|=2,Wr(a),a.memoizedState=null,s}function wj(s,a,o){var c=a.pendingProps,m=(a.flags&128)!==0;if(a.flags&=-129,s===null){if(js){if(c.mode==="hidden")return s=_d(a,c),a.lanes=536870912,Cc(null,s);if(Jm(a),(s=cn)?(s=Xv(s,aa),s=s!==null&&s.data==="&"?s:null,s!==null&&(a.memoizedState={dehydrated:s,treeContext:Ei!==null?{id:Ma,overflow:Ia}:null,retryLane:536870912,hydrationErrors:null},o=_b(s),o.return=a,a.child=o,tr=a,cn=null)):s=null,s===null)throw Ni(a);return a.lanes=536870912,null}return _d(a,c)}var f=s.memoizedState;if(f!==null){var w=f.dehydrated;if(Jm(a),m)if(a.flags&256)a.flags&=-257,a=V0(s,a,o);else if(a.memoizedState!==null)a.child=s.child,a.flags|=128,a=null;else throw Error(i(558));else if(On||fl(s,a,o,!1),m=(o&s.childLanes)!==0,On||m){if(c=sn,c!==null&&(w=zs(c,o),w!==0&&w!==f.retryLane))throw f.retryLane=w,jo(s,w),Lr(c,s,w),xf;Id(),a=V0(s,a,o)}else s=f.treeContext,cn=oa(w.nextSibling),tr=a,js=!0,Si=null,aa=!1,s!==null&&Tb(a,s),a=_d(a,c),a.flags|=4096;return a}return s=Xa(s.child,{mode:c.mode,children:c.children}),s.ref=a.ref,a.child=s,s.return=a,s}function kd(s,a){var o=a.ref;if(o===null)s!==null&&s.ref!==null&&(a.flags|=4194816);else{if(typeof o!="function"&&typeof o!="object")throw Error(i(284));(s===null||s.ref!==o)&&(a.flags|=4194816)}}function wf(s,a,o,c,m){return No(a),o=ef(s,a,o,c,void 0,m),c=tf(),s!==null&&!On?(sf(s,a,m),ni(s,a,m)):(js&&c&&Pm(a),a.flags|=1,nr(s,a,o,m),a.child)}function U0(s,a,o,c,m,f){return No(a),a.updateQueue=null,o=qb(a,c,o,m),zb(s),c=tf(),s!==null&&!On?(sf(s,a,f),ni(s,a,f)):(js&&c&&Pm(a),a.flags|=1,nr(s,a,o,f),a.child)}function F0(s,a,o,c,m){if(No(a),a.stateNode===null){var f=ul,w=o.contextType;typeof w=="object"&&w!==null&&(f=sr(w)),f=new o(c,f),a.memoizedState=f.state!==null&&f.state!==void 0?f.state:null,f.updater=bf,a.stateNode=f,f._reactInternals=a,f=a.stateNode,f.props=c,f.state=a.memoizedState,f.refs={},Wm(a),w=o.contextType,f.context=typeof w=="object"&&w!==null?sr(w):ul,f.state=a.memoizedState,w=o.getDerivedStateFromProps,typeof w=="function"&&(yf(a,o,w,c),f.state=a.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof f.getSnapshotBeforeUpdate=="function"||typeof f.UNSAFE_componentWillMount!="function"&&typeof f.componentWillMount!="function"||(w=f.state,typeof f.componentWillMount=="function"&&f.componentWillMount(),typeof f.UNSAFE_componentWillMount=="function"&&f.UNSAFE_componentWillMount(),w!==f.state&&bf.enqueueReplaceState(f,f.state,null),jc(a,c,f,m),kc(),f.state=a.memoizedState),typeof f.componentDidMount=="function"&&(a.flags|=4194308),c=!0}else if(s===null){f=a.stateNode;var S=a.memoizedProps,q=Do(o,S);f.props=q;var le=f.context,je=o.contextType;w=ul,typeof je=="object"&&je!==null&&(w=sr(je));var De=o.getDerivedStateFromProps;je=typeof De=="function"||typeof f.getSnapshotBeforeUpdate=="function",S=a.pendingProps!==S,je||typeof f.UNSAFE_componentWillReceiveProps!="function"&&typeof f.componentWillReceiveProps!="function"||(S||le!==w)&&S0(a,f,c,w),Ri=!1;var ce=a.memoizedState;f.state=ce,jc(a,c,f,m),kc(),le=a.memoizedState,S||ce!==le||Ri?(typeof De=="function"&&(yf(a,o,De,c),le=a.memoizedState),(q=Ri||E0(a,o,q,c,ce,le,w))?(je||typeof f.UNSAFE_componentWillMount!="function"&&typeof f.componentWillMount!="function"||(typeof f.componentWillMount=="function"&&f.componentWillMount(),typeof f.UNSAFE_componentWillMount=="function"&&f.UNSAFE_componentWillMount()),typeof f.componentDidMount=="function"&&(a.flags|=4194308)):(typeof f.componentDidMount=="function"&&(a.flags|=4194308),a.memoizedProps=c,a.memoizedState=le),f.props=c,f.state=le,f.context=w,c=q):(typeof f.componentDidMount=="function"&&(a.flags|=4194308),c=!1)}else{f=a.stateNode,Gm(s,a),w=a.memoizedProps,je=Do(o,w),f.props=je,De=a.pendingProps,ce=f.context,le=o.contextType,q=ul,typeof le=="object"&&le!==null&&(q=sr(le)),S=o.getDerivedStateFromProps,(le=typeof S=="function"||typeof f.getSnapshotBeforeUpdate=="function")||typeof f.UNSAFE_componentWillReceiveProps!="function"&&typeof f.componentWillReceiveProps!="function"||(w!==De||ce!==q)&&S0(a,f,c,q),Ri=!1,ce=a.memoizedState,f.state=ce,jc(a,c,f,m),kc();var xe=a.memoizedState;w!==De||ce!==xe||Ri||s!==null&&s.dependencies!==null&&rd(s.dependencies)?(typeof S=="function"&&(yf(a,o,S,c),xe=a.memoizedState),(je=Ri||E0(a,o,je,c,ce,xe,q)||s!==null&&s.dependencies!==null&&rd(s.dependencies))?(le||typeof f.UNSAFE_componentWillUpdate!="function"&&typeof f.componentWillUpdate!="function"||(typeof f.componentWillUpdate=="function"&&f.componentWillUpdate(c,xe,q),typeof f.UNSAFE_componentWillUpdate=="function"&&f.UNSAFE_componentWillUpdate(c,xe,q)),typeof f.componentDidUpdate=="function"&&(a.flags|=4),typeof f.getSnapshotBeforeUpdate=="function"&&(a.flags|=1024)):(typeof f.componentDidUpdate!="function"||w===s.memoizedProps&&ce===s.memoizedState||(a.flags|=4),typeof f.getSnapshotBeforeUpdate!="function"||w===s.memoizedProps&&ce===s.memoizedState||(a.flags|=1024),a.memoizedProps=c,a.memoizedState=xe),f.props=c,f.state=xe,f.context=q,c=je):(typeof f.componentDidUpdate!="function"||w===s.memoizedProps&&ce===s.memoizedState||(a.flags|=4),typeof f.getSnapshotBeforeUpdate!="function"||w===s.memoizedProps&&ce===s.memoizedState||(a.flags|=1024),c=!1)}return f=c,kd(s,a),c=(a.flags&128)!==0,f||c?(f=a.stateNode,o=c&&typeof o.getDerivedStateFromError!="function"?null:f.render(),a.flags|=1,s!==null&&c?(a.child=Mo(a,s.child,null,m),a.child=Mo(a,null,o,m)):nr(s,a,o,m),a.memoizedState=f.state,s=a.child):s=ni(s,a,m),s}function z0(s,a,o,c){return Eo(),a.flags|=256,nr(s,a,o,c),a.child}var _f={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function kf(s){return{baseLanes:s,cachePool:Ab()}}function jf(s,a,o){return s=s!==null?s.childLanes&~o:0,a&&(s|=Kr),s}function q0(s,a,o){var c=a.pendingProps,m=!1,f=(a.flags&128)!==0,w;if((w=f)||(w=s!==null&&s.memoizedState===null?!1:(Sn.current&2)!==0),w&&(m=!0,a.flags&=-129),w=(a.flags&32)!==0,a.flags&=-33,s===null){if(js){if(m?Ii(a):Di(),(s=cn)?(s=Xv(s,aa),s=s!==null&&s.data!=="&"?s:null,s!==null&&(a.memoizedState={dehydrated:s,treeContext:Ei!==null?{id:Ma,overflow:Ia}:null,retryLane:536870912,hydrationErrors:null},o=_b(s),o.return=a,a.child=o,tr=a,cn=null)):s=null,s===null)throw Ni(a);return ip(s)?a.lanes=32:a.lanes=536870912,null}var S=c.children;return c=c.fallback,m?(Di(),m=a.mode,S=jd({mode:"hidden",children:S},m),c=To(c,m,o,null),S.return=a,c.return=a,S.sibling=c,a.child=S,c=a.child,c.memoizedState=kf(o),c.childLanes=jf(s,w,o),a.memoizedState=_f,Cc(null,c)):(Ii(a),Tf(a,S))}var q=s.memoizedState;if(q!==null&&(S=q.dehydrated,S!==null)){if(f)a.flags&256?(Ii(a),a.flags&=-257,a=Ef(s,a,o)):a.memoizedState!==null?(Di(),a.child=s.child,a.flags|=128,a=null):(Di(),S=c.fallback,m=a.mode,c=jd({mode:"visible",children:c.children},m),S=To(S,m,o,null),S.flags|=2,c.return=a,S.return=a,c.sibling=S,a.child=c,Mo(a,s.child,null,o),c=a.child,c.memoizedState=kf(o),c.childLanes=jf(s,w,o),a.memoizedState=_f,a=Cc(null,c));else if(Ii(a),ip(S)){if(w=S.nextSibling&&S.nextSibling.dataset,w)var le=w.dgst;w=le,c=Error(i(419)),c.stack="",c.digest=w,yc({value:c,source:null,stack:null}),a=Ef(s,a,o)}else if(On||fl(s,a,o,!1),w=(o&s.childLanes)!==0,On||w){if(w=sn,w!==null&&(c=zs(w,o),c!==0&&c!==q.retryLane))throw q.retryLane=c,jo(s,c),Lr(w,s,c),xf;ap(S)||Id(),a=Ef(s,a,o)}else ap(S)?(a.flags|=192,a.child=s.child,a=null):(s=q.treeContext,cn=oa(S.nextSibling),tr=a,js=!0,Si=null,aa=!1,s!==null&&Tb(a,s),a=Tf(a,c.children),a.flags|=4096);return a}return m?(Di(),S=c.fallback,m=a.mode,q=s.child,le=q.sibling,c=Xa(q,{mode:"hidden",children:c.children}),c.subtreeFlags=q.subtreeFlags&65011712,le!==null?S=Xa(le,S):(S=To(S,m,o,null),S.flags|=2),S.return=a,c.return=a,c.sibling=S,a.child=c,Cc(null,c),c=a.child,S=s.child.memoizedState,S===null?S=kf(o):(m=S.cachePool,m!==null?(q=Pn._currentValue,m=m.parent!==q?{parent:q,pool:q}:m):m=Ab(),S={baseLanes:S.baseLanes|o,cachePool:m}),c.memoizedState=S,c.childLanes=jf(s,w,o),a.memoizedState=_f,Cc(s.child,c)):(Ii(a),o=s.child,s=o.sibling,o=Xa(o,{mode:"visible",children:c.children}),o.return=a,o.sibling=null,s!==null&&(w=a.deletions,w===null?(a.deletions=[s],a.flags|=16):w.push(s)),a.child=o,a.memoizedState=null,o)}function Tf(s,a){return a=jd({mode:"visible",children:a},s.mode),a.return=s,s.child=a}function jd(s,a){return s=Hr(22,s,null,a),s.lanes=0,s}function Ef(s,a,o){return Mo(a,s.child,null,o),s=Tf(a,a.pendingProps.children),s.flags|=2,a.memoizedState=null,s}function H0(s,a,o){s.lanes|=a;var c=s.alternate;c!==null&&(c.lanes|=a),Um(s.return,a,o)}function Sf(s,a,o,c,m,f){var w=s.memoizedState;w===null?s.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:c,tail:o,tailMode:m,treeForkCount:f}:(w.isBackwards=a,w.rendering=null,w.renderingStartTime=0,w.last=c,w.tail=o,w.tailMode=m,w.treeForkCount=f)}function $0(s,a,o){var c=a.pendingProps,m=c.revealOrder,f=c.tail;c=c.children;var w=Sn.current,S=(w&2)!==0;if(S?(w=w&1|2,a.flags|=128):w&=1,Ie(Sn,w),nr(s,a,c,o),c=js?gc:0,!S&&s!==null&&(s.flags&128)!==0)e:for(s=a.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&H0(s,o,a);else if(s.tag===19)H0(s,o,a);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===a)break e;for(;s.sibling===null;){if(s.return===null||s.return===a)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}switch(m){case"forwards":for(o=a.child,m=null;o!==null;)s=o.alternate,s!==null&&hd(s)===null&&(m=o),o=o.sibling;o=m,o===null?(m=a.child,a.child=null):(m=o.sibling,o.sibling=null),Sf(a,!1,m,o,f,c);break;case"backwards":case"unstable_legacy-backwards":for(o=null,m=a.child,a.child=null;m!==null;){if(s=m.alternate,s!==null&&hd(s)===null){a.child=m;break}s=m.sibling,m.sibling=o,o=m,m=s}Sf(a,!0,o,null,f,c);break;case"together":Sf(a,!1,null,null,void 0,c);break;default:a.memoizedState=null}return a.child}function ni(s,a,o){if(s!==null&&(a.dependencies=s.dependencies),Oi|=a.lanes,(o&a.childLanes)===0)if(s!==null){if(fl(s,a,o,!1),(o&a.childLanes)===0)return null}else return null;if(s!==null&&a.child!==s.child)throw Error(i(153));if(a.child!==null){for(s=a.child,o=Xa(s,s.pendingProps),a.child=o,o.return=a;s.sibling!==null;)s=s.sibling,o=o.sibling=Xa(s,s.pendingProps),o.return=a;o.sibling=null}return a.child}function Nf(s,a){return(s.lanes&a)!==0?!0:(s=s.dependencies,!!(s!==null&&rd(s)))}function _j(s,a,o){switch(a.tag){case 3:ft(a,a.stateNode.containerInfo),Ci(a,Pn,s.memoizedState.cache),Eo();break;case 27:case 5:Vt(a);break;case 4:ft(a,a.stateNode.containerInfo);break;case 10:Ci(a,a.type,a.memoizedProps.value);break;case 31:if(a.memoizedState!==null)return a.flags|=128,Jm(a),null;break;case 13:var c=a.memoizedState;if(c!==null)return c.dehydrated!==null?(Ii(a),a.flags|=128,null):(o&a.child.childLanes)!==0?q0(s,a,o):(Ii(a),s=ni(s,a,o),s!==null?s.sibling:null);Ii(a);break;case 19:var m=(s.flags&128)!==0;if(c=(o&a.childLanes)!==0,c||(fl(s,a,o,!1),c=(o&a.childLanes)!==0),m){if(c)return $0(s,a,o);a.flags|=128}if(m=a.memoizedState,m!==null&&(m.rendering=null,m.tail=null,m.lastEffect=null),Ie(Sn,Sn.current),c)break;return null;case 22:return a.lanes=0,O0(s,a,o,a.pendingProps);case 24:Ci(a,Pn,s.memoizedState.cache)}return ni(s,a,o)}function W0(s,a,o){if(s!==null)if(s.memoizedProps!==a.pendingProps)On=!0;else{if(!Nf(s,o)&&(a.flags&128)===0)return On=!1,_j(s,a,o);On=(s.flags&131072)!==0}else On=!1,js&&(a.flags&1048576)!==0&&jb(a,gc,a.index);switch(a.lanes=0,a.tag){case 16:e:{var c=a.pendingProps;if(s=Ro(a.elementType),a.type=s,typeof s=="function")Mm(s)?(c=Do(s,c),a.tag=1,a=F0(null,a,s,c,o)):(a.tag=0,a=wf(null,a,s,c,o));else{if(s!=null){var m=s.$$typeof;if(m===he){a.tag=11,a=D0(null,a,s,c,o);break e}else if(m===R){a.tag=14,a=P0(null,a,s,c,o);break e}}throw a=ze(s)||s,Error(i(306,a,""))}}return a;case 0:return wf(s,a,a.type,a.pendingProps,o);case 1:return c=a.type,m=Do(c,a.pendingProps),F0(s,a,c,m,o);case 3:e:{if(ft(a,a.stateNode.containerInfo),s===null)throw Error(i(387));c=a.pendingProps;var f=a.memoizedState;m=f.element,Gm(s,a),jc(a,c,null,o);var w=a.memoizedState;if(c=w.cache,Ci(a,Pn,c),c!==f.cache&&Fm(a,[Pn],o,!0),kc(),c=w.element,f.isDehydrated)if(f={element:c,isDehydrated:!1,cache:w.cache},a.updateQueue.baseState=f,a.memoizedState=f,a.flags&256){a=z0(s,a,c,o);break e}else if(c!==m){m=sa(Error(i(424)),a),yc(m),a=z0(s,a,c,o);break e}else for(s=a.stateNode.containerInfo,s.nodeType===9?s=s.body:s=s.nodeName==="HTML"?s.ownerDocument.body:s,cn=oa(s.firstChild),tr=a,js=!0,Si=null,aa=!0,o=Ob(a,null,c,o),a.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling;else{if(Eo(),c===m){a=ni(s,a,o);break e}nr(s,a,c,o)}a=a.child}return a;case 26:return kd(s,a),s===null?(o=n1(a.type,null,a.pendingProps,null))?a.memoizedState=o:js||(o=a.type,s=a.pendingProps,c=Ud(Me.current).createElement(o),c[dt]=a,c[bt]=s,rr(c,o,s),C(c),a.stateNode=c):a.memoizedState=n1(a.type,s.memoizedProps,a.pendingProps,s.memoizedState),null;case 27:return Vt(a),s===null&&js&&(c=a.stateNode=e1(a.type,a.pendingProps,Me.current),tr=a,aa=!0,m=cn,zi(a.type)?(op=m,cn=oa(c.firstChild)):cn=m),nr(s,a,a.pendingProps.children,o),kd(s,a),s===null&&(a.flags|=4194304),a.child;case 5:return s===null&&js&&((m=c=cn)&&(c=Jj(c,a.type,a.pendingProps,aa),c!==null?(a.stateNode=c,tr=a,cn=oa(c.firstChild),aa=!1,m=!0):m=!1),m||Ni(a)),Vt(a),m=a.type,f=a.pendingProps,w=s!==null?s.memoizedProps:null,c=f.children,sp(m,f)?c=null:w!==null&&sp(m,w)&&(a.flags|=32),a.memoizedState!==null&&(m=ef(s,a,mj,null,null,o),Hc._currentValue=m),kd(s,a),nr(s,a,c,o),a.child;case 6:return s===null&&js&&((s=o=cn)&&(o=Zj(o,a.pendingProps,aa),o!==null?(a.stateNode=o,tr=a,cn=null,s=!0):s=!1),s||Ni(a)),null;case 13:return q0(s,a,o);case 4:return ft(a,a.stateNode.containerInfo),c=a.pendingProps,s===null?a.child=Mo(a,null,c,o):nr(s,a,c,o),a.child;case 11:return D0(s,a,a.type,a.pendingProps,o);case 7:return nr(s,a,a.pendingProps,o),a.child;case 8:return nr(s,a,a.pendingProps.children,o),a.child;case 12:return nr(s,a,a.pendingProps.children,o),a.child;case 10:return c=a.pendingProps,Ci(a,a.type,c.value),nr(s,a,c.children,o),a.child;case 9:return m=a.type._context,c=a.pendingProps.children,No(a),m=sr(m),c=c(m),a.flags|=1,nr(s,a,c,o),a.child;case 14:return P0(s,a,a.type,a.pendingProps,o);case 15:return L0(s,a,a.type,a.pendingProps,o);case 19:return $0(s,a,o);case 31:return wj(s,a,o);case 22:return O0(s,a,o,a.pendingProps);case 24:return No(a),c=sr(Pn),s===null?(m=Hm(),m===null&&(m=sn,f=zm(),m.pooledCache=f,f.refCount++,f!==null&&(m.pooledCacheLanes|=o),m=f),a.memoizedState={parent:c,cache:m},Wm(a),Ci(a,Pn,m)):((s.lanes&o)!==0&&(Gm(s,a),jc(a,null,null,o),kc()),m=s.memoizedState,f=a.memoizedState,m.parent!==c?(m={parent:c,cache:c},a.memoizedState=m,a.lanes===0&&(a.memoizedState=a.updateQueue.baseState=m),Ci(a,Pn,c)):(c=f.cache,Ci(a,Pn,c),c!==m.cache&&Fm(a,[Pn],o,!0))),nr(s,a,a.pendingProps.children,o),a.child;case 29:throw a.pendingProps}throw Error(i(156,a.tag))}function ri(s){s.flags|=4}function Cf(s,a,o,c,m){if((a=(s.mode&32)!==0)&&(a=!1),a){if(s.flags|=16777216,(m&335544128)===m)if(s.stateNode.complete)s.flags|=8192;else if(vv())s.flags|=8192;else throw Ao=ld,$m}else s.flags&=-16777217}function G0(s,a){if(a.type!=="stylesheet"||(a.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!l1(a))if(vv())s.flags|=8192;else throw Ao=ld,$m}function Td(s,a){a!==null&&(s.flags|=4),s.flags&16384&&(a=s.tag!==22?_t():536870912,s.lanes|=a,El|=a)}function Rc(s,a){if(!js)switch(s.tailMode){case"hidden":a=s.tail;for(var o=null;a!==null;)a.alternate!==null&&(o=a),a=a.sibling;o===null?s.tail=null:o.sibling=null;break;case"collapsed":o=s.tail;for(var c=null;o!==null;)o.alternate!==null&&(c=o),o=o.sibling;c===null?a||s.tail===null?s.tail=null:s.tail.sibling=null:c.sibling=null}}function un(s){var a=s.alternate!==null&&s.alternate.child===s.child,o=0,c=0;if(a)for(var m=s.child;m!==null;)o|=m.lanes|m.childLanes,c|=m.subtreeFlags&65011712,c|=m.flags&65011712,m.return=s,m=m.sibling;else for(m=s.child;m!==null;)o|=m.lanes|m.childLanes,c|=m.subtreeFlags,c|=m.flags,m.return=s,m=m.sibling;return s.subtreeFlags|=c,s.childLanes=o,a}function kj(s,a,o){var c=a.pendingProps;switch(Lm(a),a.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return un(a),null;case 1:return un(a),null;case 3:return o=a.stateNode,c=null,s!==null&&(c=s.memoizedState.cache),a.memoizedState.cache!==c&&(a.flags|=2048),ei(Pn),Qe(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(s===null||s.child===null)&&(ml(a)?ri(a):s===null||s.memoizedState.isDehydrated&&(a.flags&256)===0||(a.flags|=1024,Bm())),un(a),null;case 26:var m=a.type,f=a.memoizedState;return s===null?(ri(a),f!==null?(un(a),G0(a,f)):(un(a),Cf(a,m,null,c,o))):f?f!==s.memoizedState?(ri(a),un(a),G0(a,f)):(un(a),a.flags&=-16777217):(s=s.memoizedProps,s!==c&&ri(a),un(a),Cf(a,m,s,c,o)),null;case 27:if(Ls(a),o=Me.current,m=a.type,s!==null&&a.stateNode!=null)s.memoizedProps!==c&&ri(a);else{if(!c){if(a.stateNode===null)throw Error(i(166));return un(a),null}s=de.current,ml(a)?Eb(a):(s=e1(m,c,o),a.stateNode=s,ri(a))}return un(a),null;case 5:if(Ls(a),m=a.type,s!==null&&a.stateNode!=null)s.memoizedProps!==c&&ri(a);else{if(!c){if(a.stateNode===null)throw Error(i(166));return un(a),null}if(f=de.current,ml(a))Eb(a);else{var w=Ud(Me.current);switch(f){case 1:f=w.createElementNS("http://www.w3.org/2000/svg",m);break;case 2:f=w.createElementNS("http://www.w3.org/1998/Math/MathML",m);break;default:switch(m){case"svg":f=w.createElementNS("http://www.w3.org/2000/svg",m);break;case"math":f=w.createElementNS("http://www.w3.org/1998/Math/MathML",m);break;case"script":f=w.createElement("div"),f.innerHTML="<script><\/script>",f=f.removeChild(f.firstChild);break;case"select":f=typeof c.is=="string"?w.createElement("select",{is:c.is}):w.createElement("select"),c.multiple?f.multiple=!0:c.size&&(f.size=c.size);break;default:f=typeof c.is=="string"?w.createElement(m,{is:c.is}):w.createElement(m)}}f[dt]=a,f[bt]=c;e:for(w=a.child;w!==null;){if(w.tag===5||w.tag===6)f.appendChild(w.stateNode);else if(w.tag!==4&&w.tag!==27&&w.child!==null){w.child.return=w,w=w.child;continue}if(w===a)break e;for(;w.sibling===null;){if(w.return===null||w.return===a)break e;w=w.return}w.sibling.return=w.return,w=w.sibling}a.stateNode=f;e:switch(rr(f,m,c),m){case"button":case"input":case"select":case"textarea":c=!!c.autoFocus;break e;case"img":c=!0;break e;default:c=!1}c&&ri(a)}}return un(a),Cf(a,a.type,s===null?null:s.memoizedProps,a.pendingProps,o),null;case 6:if(s&&a.stateNode!=null)s.memoizedProps!==c&&ri(a);else{if(typeof c!="string"&&a.stateNode===null)throw Error(i(166));if(s=Me.current,ml(a)){if(s=a.stateNode,o=a.memoizedProps,c=null,m=tr,m!==null)switch(m.tag){case 27:case 5:c=m.memoizedProps}s[dt]=a,s=!!(s.nodeValue===o||c!==null&&c.suppressHydrationWarning===!0||qv(s.nodeValue,o)),s||Ni(a,!0)}else s=Ud(s).createTextNode(c),s[dt]=a,a.stateNode=s}return un(a),null;case 31:if(o=a.memoizedState,s===null||s.memoizedState!==null){if(c=ml(a),o!==null){if(s===null){if(!c)throw Error(i(318));if(s=a.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(557));s[dt]=a}else Eo(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;un(a),s=!1}else o=Bm(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=o),s=!0;if(!s)return a.flags&256?(Wr(a),a):(Wr(a),null);if((a.flags&128)!==0)throw Error(i(558))}return un(a),null;case 13:if(c=a.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(m=ml(a),c!==null&&c.dehydrated!==null){if(s===null){if(!m)throw Error(i(318));if(m=a.memoizedState,m=m!==null?m.dehydrated:null,!m)throw Error(i(317));m[dt]=a}else Eo(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;un(a),m=!1}else m=Bm(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=m),m=!0;if(!m)return a.flags&256?(Wr(a),a):(Wr(a),null)}return Wr(a),(a.flags&128)!==0?(a.lanes=o,a):(o=c!==null,s=s!==null&&s.memoizedState!==null,o&&(c=a.child,m=null,c.alternate!==null&&c.alternate.memoizedState!==null&&c.alternate.memoizedState.cachePool!==null&&(m=c.alternate.memoizedState.cachePool.pool),f=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(f=c.memoizedState.cachePool.pool),f!==m&&(c.flags|=2048)),o!==s&&o&&(a.child.flags|=8192),Td(a,a.updateQueue),un(a),null);case 4:return Qe(),s===null&&Xf(a.stateNode.containerInfo),un(a),null;case 10:return ei(a.type),un(a),null;case 19:if(ne(Sn),c=a.memoizedState,c===null)return un(a),null;if(m=(a.flags&128)!==0,f=c.rendering,f===null)if(m)Rc(c,!1);else{if(wn!==0||s!==null&&(s.flags&128)!==0)for(s=a.child;s!==null;){if(f=hd(s),f!==null){for(a.flags|=128,Rc(c,!1),s=f.updateQueue,a.updateQueue=s,Td(a,s),a.subtreeFlags=0,s=o,o=a.child;o!==null;)wb(o,s),o=o.sibling;return Ie(Sn,Sn.current&1|2),js&&Ja(a,c.treeForkCount),a.child}s=s.sibling}c.tail!==null&&Ut()>Rd&&(a.flags|=128,m=!0,Rc(c,!1),a.lanes=4194304)}else{if(!m)if(s=hd(f),s!==null){if(a.flags|=128,m=!0,s=s.updateQueue,a.updateQueue=s,Td(a,s),Rc(c,!0),c.tail===null&&c.tailMode==="hidden"&&!f.alternate&&!js)return un(a),null}else 2*Ut()-c.renderingStartTime>Rd&&o!==536870912&&(a.flags|=128,m=!0,Rc(c,!1),a.lanes=4194304);c.isBackwards?(f.sibling=a.child,a.child=f):(s=c.last,s!==null?s.sibling=f:a.child=f,c.last=f)}return c.tail!==null?(s=c.tail,c.rendering=s,c.tail=s.sibling,c.renderingStartTime=Ut(),s.sibling=null,o=Sn.current,Ie(Sn,m?o&1|2:o&1),js&&Ja(a,c.treeForkCount),s):(un(a),null);case 22:case 23:return Wr(a),Xm(),c=a.memoizedState!==null,s!==null?s.memoizedState!==null!==c&&(a.flags|=8192):c&&(a.flags|=8192),c?(o&536870912)!==0&&(a.flags&128)===0&&(un(a),a.subtreeFlags&6&&(a.flags|=8192)):un(a),o=a.updateQueue,o!==null&&Td(a,o.retryQueue),o=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(o=s.memoizedState.cachePool.pool),c=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(c=a.memoizedState.cachePool.pool),c!==o&&(a.flags|=2048),s!==null&&ne(Co),null;case 24:return o=null,s!==null&&(o=s.memoizedState.cache),a.memoizedState.cache!==o&&(a.flags|=2048),ei(Pn),un(a),null;case 25:return null;case 30:return null}throw Error(i(156,a.tag))}function jj(s,a){switch(Lm(a),a.tag){case 1:return s=a.flags,s&65536?(a.flags=s&-65537|128,a):null;case 3:return ei(Pn),Qe(),s=a.flags,(s&65536)!==0&&(s&128)===0?(a.flags=s&-65537|128,a):null;case 26:case 27:case 5:return Ls(a),null;case 31:if(a.memoizedState!==null){if(Wr(a),a.alternate===null)throw Error(i(340));Eo()}return s=a.flags,s&65536?(a.flags=s&-65537|128,a):null;case 13:if(Wr(a),s=a.memoizedState,s!==null&&s.dehydrated!==null){if(a.alternate===null)throw Error(i(340));Eo()}return s=a.flags,s&65536?(a.flags=s&-65537|128,a):null;case 19:return ne(Sn),null;case 4:return Qe(),null;case 10:return ei(a.type),null;case 22:case 23:return Wr(a),Xm(),s!==null&&ne(Co),s=a.flags,s&65536?(a.flags=s&-65537|128,a):null;case 24:return ei(Pn),null;case 25:return null;default:return null}}function K0(s,a){switch(Lm(a),a.tag){case 3:ei(Pn),Qe();break;case 26:case 27:case 5:Ls(a);break;case 4:Qe();break;case 31:a.memoizedState!==null&&Wr(a);break;case 13:Wr(a);break;case 19:ne(Sn);break;case 10:ei(a.type);break;case 22:case 23:Wr(a),Xm(),s!==null&&ne(Co);break;case 24:ei(Pn)}}function Ac(s,a){try{var o=a.updateQueue,c=o!==null?o.lastEffect:null;if(c!==null){var m=c.next;o=m;do{if((o.tag&s)===s){c=void 0;var f=o.create,w=o.inst;c=f(),w.destroy=c}o=o.next}while(o!==m)}}catch(S){Gs(a,a.return,S)}}function Pi(s,a,o){try{var c=a.updateQueue,m=c!==null?c.lastEffect:null;if(m!==null){var f=m.next;c=f;do{if((c.tag&s)===s){var w=c.inst,S=w.destroy;if(S!==void 0){w.destroy=void 0,m=a;var q=o,le=S;try{le()}catch(je){Gs(m,q,je)}}}c=c.next}while(c!==f)}}catch(je){Gs(a,a.return,je)}}function Y0(s){var a=s.updateQueue;if(a!==null){var o=s.stateNode;try{Vb(a,o)}catch(c){Gs(s,s.return,c)}}}function Q0(s,a,o){o.props=Do(s.type,s.memoizedProps),o.state=s.memoizedState;try{o.componentWillUnmount()}catch(c){Gs(s,a,c)}}function Mc(s,a){try{var o=s.ref;if(o!==null){switch(s.tag){case 26:case 27:case 5:var c=s.stateNode;break;case 30:c=s.stateNode;break;default:c=s.stateNode}typeof o=="function"?s.refCleanup=o(c):o.current=c}}catch(m){Gs(s,a,m)}}function Da(s,a){var o=s.ref,c=s.refCleanup;if(o!==null)if(typeof c=="function")try{c()}catch(m){Gs(s,a,m)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof o=="function")try{o(null)}catch(m){Gs(s,a,m)}else o.current=null}function X0(s){var a=s.type,o=s.memoizedProps,c=s.stateNode;try{e:switch(a){case"button":case"input":case"select":case"textarea":o.autoFocus&&c.focus();break e;case"img":o.src?c.src=o.src:o.srcSet&&(c.srcset=o.srcSet)}}catch(m){Gs(s,s.return,m)}}function Rf(s,a,o){try{var c=s.stateNode;Wj(c,s.type,o,a),c[bt]=a}catch(m){Gs(s,s.return,m)}}function J0(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&zi(s.type)||s.tag===4}function Af(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||J0(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&zi(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function Mf(s,a,o){var c=s.tag;if(c===5||c===6)s=s.stateNode,a?(o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o).insertBefore(s,a):(a=o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o,a.appendChild(s),o=o._reactRootContainer,o!=null||a.onclick!==null||(a.onclick=Jt));else if(c!==4&&(c===27&&zi(s.type)&&(o=s.stateNode,a=null),s=s.child,s!==null))for(Mf(s,a,o),s=s.sibling;s!==null;)Mf(s,a,o),s=s.sibling}function Ed(s,a,o){var c=s.tag;if(c===5||c===6)s=s.stateNode,a?o.insertBefore(s,a):o.appendChild(s);else if(c!==4&&(c===27&&zi(s.type)&&(o=s.stateNode),s=s.child,s!==null))for(Ed(s,a,o),s=s.sibling;s!==null;)Ed(s,a,o),s=s.sibling}function Z0(s){var a=s.stateNode,o=s.memoizedProps;try{for(var c=s.type,m=a.attributes;m.length;)a.removeAttributeNode(m[0]);rr(a,c,o),a[dt]=s,a[bt]=o}catch(f){Gs(s,s.return,f)}}var ai=!1,Bn=!1,If=!1,ev=typeof WeakSet=="function"?WeakSet:Set,Jn=null;function Tj(s,a){if(s=s.containerInfo,ep=Gd,s=hb(s),Tm(s)){if("selectionStart"in s)var o={start:s.selectionStart,end:s.selectionEnd};else e:{o=(o=s.ownerDocument)&&o.defaultView||window;var c=o.getSelection&&o.getSelection();if(c&&c.rangeCount!==0){o=c.anchorNode;var m=c.anchorOffset,f=c.focusNode;c=c.focusOffset;try{o.nodeType,f.nodeType}catch{o=null;break e}var w=0,S=-1,q=-1,le=0,je=0,De=s,ce=null;t:for(;;){for(var xe;De!==o||m!==0&&De.nodeType!==3||(S=w+m),De!==f||c!==0&&De.nodeType!==3||(q=w+c),De.nodeType===3&&(w+=De.nodeValue.length),(xe=De.firstChild)!==null;)ce=De,De=xe;for(;;){if(De===s)break t;if(ce===o&&++le===m&&(S=w),ce===f&&++je===c&&(q=w),(xe=De.nextSibling)!==null)break;De=ce,ce=De.parentNode}De=xe}o=S===-1||q===-1?null:{start:S,end:q}}else o=null}o=o||{start:0,end:0}}else o=null;for(tp={focusedElem:s,selectionRange:o},Gd=!1,Jn=a;Jn!==null;)if(a=Jn,s=a.child,(a.subtreeFlags&1028)!==0&&s!==null)s.return=a,Jn=s;else for(;Jn!==null;){switch(a=Jn,f=a.alternate,s=a.flags,a.tag){case 0:if((s&4)!==0&&(s=a.updateQueue,s=s!==null?s.events:null,s!==null))for(o=0;o<s.length;o++)m=s[o],m.ref.impl=m.nextImpl;break;case 11:case 15:break;case 1:if((s&1024)!==0&&f!==null){s=void 0,o=a,m=f.memoizedProps,f=f.memoizedState,c=o.stateNode;try{var gt=Do(o.type,m);s=c.getSnapshotBeforeUpdate(gt,f),c.__reactInternalSnapshotBeforeUpdate=s}catch(Ot){Gs(o,o.return,Ot)}}break;case 3:if((s&1024)!==0){if(s=a.stateNode.containerInfo,o=s.nodeType,o===9)rp(s);else if(o===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":rp(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(i(163))}if(s=a.sibling,s!==null){s.return=a.return,Jn=s;break}Jn=a.return}}function tv(s,a,o){var c=o.flags;switch(o.tag){case 0:case 11:case 15:oi(s,o),c&4&&Ac(5,o);break;case 1:if(oi(s,o),c&4)if(s=o.stateNode,a===null)try{s.componentDidMount()}catch(w){Gs(o,o.return,w)}else{var m=Do(o.type,a.memoizedProps);a=a.memoizedState;try{s.componentDidUpdate(m,a,s.__reactInternalSnapshotBeforeUpdate)}catch(w){Gs(o,o.return,w)}}c&64&&Y0(o),c&512&&Mc(o,o.return);break;case 3:if(oi(s,o),c&64&&(s=o.updateQueue,s!==null)){if(a=null,o.child!==null)switch(o.child.tag){case 27:case 5:a=o.child.stateNode;break;case 1:a=o.child.stateNode}try{Vb(s,a)}catch(w){Gs(o,o.return,w)}}break;case 27:a===null&&c&4&&Z0(o);case 26:case 5:oi(s,o),a===null&&c&4&&X0(o),c&512&&Mc(o,o.return);break;case 12:oi(s,o);break;case 31:oi(s,o),c&4&&rv(s,o);break;case 13:oi(s,o),c&4&&av(s,o),c&64&&(s=o.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(o=Dj.bind(null,o),eT(s,o))));break;case 22:if(c=o.memoizedState!==null||ai,!c){a=a!==null&&a.memoizedState!==null||Bn,m=ai;var f=Bn;ai=c,(Bn=a)&&!f?li(s,o,(o.subtreeFlags&8772)!==0):oi(s,o),ai=m,Bn=f}break;case 30:break;default:oi(s,o)}}function sv(s){var a=s.alternate;a!==null&&(s.alternate=null,sv(a)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(a=s.stateNode,a!==null&&Rn(a)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var hn=null,Mr=!1;function ii(s,a,o){for(o=o.child;o!==null;)nv(s,a,o),o=o.sibling}function nv(s,a,o){if(Te&&typeof Te.onCommitFiberUnmount=="function")try{Te.onCommitFiberUnmount(be,o)}catch{}switch(o.tag){case 26:Bn||Da(o,a),ii(s,a,o),o.memoizedState?o.memoizedState.count--:o.stateNode&&(o=o.stateNode,o.parentNode.removeChild(o));break;case 27:Bn||Da(o,a);var c=hn,m=Mr;zi(o.type)&&(hn=o.stateNode,Mr=!1),ii(s,a,o),Fc(o.stateNode),hn=c,Mr=m;break;case 5:Bn||Da(o,a);case 6:if(c=hn,m=Mr,hn=null,ii(s,a,o),hn=c,Mr=m,hn!==null)if(Mr)try{(hn.nodeType===9?hn.body:hn.nodeName==="HTML"?hn.ownerDocument.body:hn).removeChild(o.stateNode)}catch(f){Gs(o,a,f)}else try{hn.removeChild(o.stateNode)}catch(f){Gs(o,a,f)}break;case 18:hn!==null&&(Mr?(s=hn,Yv(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,o.stateNode),Dl(s)):Yv(hn,o.stateNode));break;case 4:c=hn,m=Mr,hn=o.stateNode.containerInfo,Mr=!0,ii(s,a,o),hn=c,Mr=m;break;case 0:case 11:case 14:case 15:Pi(2,o,a),Bn||Pi(4,o,a),ii(s,a,o);break;case 1:Bn||(Da(o,a),c=o.stateNode,typeof c.componentWillUnmount=="function"&&Q0(o,a,c)),ii(s,a,o);break;case 21:ii(s,a,o);break;case 22:Bn=(c=Bn)||o.memoizedState!==null,ii(s,a,o),Bn=c;break;default:ii(s,a,o)}}function rv(s,a){if(a.memoizedState===null&&(s=a.alternate,s!==null&&(s=s.memoizedState,s!==null))){s=s.dehydrated;try{Dl(s)}catch(o){Gs(a,a.return,o)}}}function av(s,a){if(a.memoizedState===null&&(s=a.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{Dl(s)}catch(o){Gs(a,a.return,o)}}function Ej(s){switch(s.tag){case 31:case 13:case 19:var a=s.stateNode;return a===null&&(a=s.stateNode=new ev),a;case 22:return s=s.stateNode,a=s._retryCache,a===null&&(a=s._retryCache=new ev),a;default:throw Error(i(435,s.tag))}}function Sd(s,a){var o=Ej(s);a.forEach(function(c){if(!o.has(c)){o.add(c);var m=Pj.bind(null,s,c);c.then(m,m)}})}function Ir(s,a){var o=a.deletions;if(o!==null)for(var c=0;c<o.length;c++){var m=o[c],f=s,w=a,S=w;e:for(;S!==null;){switch(S.tag){case 27:if(zi(S.type)){hn=S.stateNode,Mr=!1;break e}break;case 5:hn=S.stateNode,Mr=!1;break e;case 3:case 4:hn=S.stateNode.containerInfo,Mr=!0;break e}S=S.return}if(hn===null)throw Error(i(160));nv(f,w,m),hn=null,Mr=!1,f=m.alternate,f!==null&&(f.return=null),m.return=null}if(a.subtreeFlags&13886)for(a=a.child;a!==null;)iv(a,s),a=a.sibling}var ba=null;function iv(s,a){var o=s.alternate,c=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:Ir(a,s),Dr(s),c&4&&(Pi(3,s,s.return),Ac(3,s),Pi(5,s,s.return));break;case 1:Ir(a,s),Dr(s),c&512&&(Bn||o===null||Da(o,o.return)),c&64&&ai&&(s=s.updateQueue,s!==null&&(c=s.callbacks,c!==null&&(o=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=o===null?c:o.concat(c))));break;case 26:var m=ba;if(Ir(a,s),Dr(s),c&512&&(Bn||o===null||Da(o,o.return)),c&4){var f=o!==null?o.memoizedState:null;if(c=s.memoizedState,o===null)if(c===null)if(s.stateNode===null){e:{c=s.type,o=s.memoizedProps,m=m.ownerDocument||m;t:switch(c){case"title":f=m.getElementsByTagName("title")[0],(!f||f[yn]||f[dt]||f.namespaceURI==="http://www.w3.org/2000/svg"||f.hasAttribute("itemprop"))&&(f=m.createElement(c),m.head.insertBefore(f,m.querySelector("head > title"))),rr(f,c,o),f[dt]=s,C(f),c=f;break e;case"link":var w=i1("link","href",m).get(c+(o.href||""));if(w){for(var S=0;S<w.length;S++)if(f=w[S],f.getAttribute("href")===(o.href==null||o.href===""?null:o.href)&&f.getAttribute("rel")===(o.rel==null?null:o.rel)&&f.getAttribute("title")===(o.title==null?null:o.title)&&f.getAttribute("crossorigin")===(o.crossOrigin==null?null:o.crossOrigin)){w.splice(S,1);break t}}f=m.createElement(c),rr(f,c,o),m.head.appendChild(f);break;case"meta":if(w=i1("meta","content",m).get(c+(o.content||""))){for(S=0;S<w.length;S++)if(f=w[S],f.getAttribute("content")===(o.content==null?null:""+o.content)&&f.getAttribute("name")===(o.name==null?null:o.name)&&f.getAttribute("property")===(o.property==null?null:o.property)&&f.getAttribute("http-equiv")===(o.httpEquiv==null?null:o.httpEquiv)&&f.getAttribute("charset")===(o.charSet==null?null:o.charSet)){w.splice(S,1);break t}}f=m.createElement(c),rr(f,c,o),m.head.appendChild(f);break;default:throw Error(i(468,c))}f[dt]=s,C(f),c=f}s.stateNode=c}else o1(m,s.type,s.stateNode);else s.stateNode=a1(m,c,s.memoizedProps);else f!==c?(f===null?o.stateNode!==null&&(o=o.stateNode,o.parentNode.removeChild(o)):f.count--,c===null?o1(m,s.type,s.stateNode):a1(m,c,s.memoizedProps)):c===null&&s.stateNode!==null&&Rf(s,s.memoizedProps,o.memoizedProps)}break;case 27:Ir(a,s),Dr(s),c&512&&(Bn||o===null||Da(o,o.return)),o!==null&&c&4&&Rf(s,s.memoizedProps,o.memoizedProps);break;case 5:if(Ir(a,s),Dr(s),c&512&&(Bn||o===null||Da(o,o.return)),s.flags&32){m=s.stateNode;try{Yt(m,"")}catch(gt){Gs(s,s.return,gt)}}c&4&&s.stateNode!=null&&(m=s.memoizedProps,Rf(s,m,o!==null?o.memoizedProps:m)),c&1024&&(If=!0);break;case 6:if(Ir(a,s),Dr(s),c&4){if(s.stateNode===null)throw Error(i(162));c=s.memoizedProps,o=s.stateNode;try{o.nodeValue=c}catch(gt){Gs(s,s.return,gt)}}break;case 3:if(qd=null,m=ba,ba=Fd(a.containerInfo),Ir(a,s),ba=m,Dr(s),c&4&&o!==null&&o.memoizedState.isDehydrated)try{Dl(a.containerInfo)}catch(gt){Gs(s,s.return,gt)}If&&(If=!1,ov(s));break;case 4:c=ba,ba=Fd(s.stateNode.containerInfo),Ir(a,s),Dr(s),ba=c;break;case 12:Ir(a,s),Dr(s);break;case 31:Ir(a,s),Dr(s),c&4&&(c=s.updateQueue,c!==null&&(s.updateQueue=null,Sd(s,c)));break;case 13:Ir(a,s),Dr(s),s.child.flags&8192&&s.memoizedState!==null!=(o!==null&&o.memoizedState!==null)&&(Cd=Ut()),c&4&&(c=s.updateQueue,c!==null&&(s.updateQueue=null,Sd(s,c)));break;case 22:m=s.memoizedState!==null;var q=o!==null&&o.memoizedState!==null,le=ai,je=Bn;if(ai=le||m,Bn=je||q,Ir(a,s),Bn=je,ai=le,Dr(s),c&8192)e:for(a=s.stateNode,a._visibility=m?a._visibility&-2:a._visibility|1,m&&(o===null||q||ai||Bn||Po(s)),o=null,a=s;;){if(a.tag===5||a.tag===26){if(o===null){q=o=a;try{if(f=q.stateNode,m)w=f.style,typeof w.setProperty=="function"?w.setProperty("display","none","important"):w.display="none";else{S=q.stateNode;var De=q.memoizedProps.style,ce=De!=null&&De.hasOwnProperty("display")?De.display:null;S.style.display=ce==null||typeof ce=="boolean"?"":(""+ce).trim()}}catch(gt){Gs(q,q.return,gt)}}}else if(a.tag===6){if(o===null){q=a;try{q.stateNode.nodeValue=m?"":q.memoizedProps}catch(gt){Gs(q,q.return,gt)}}}else if(a.tag===18){if(o===null){q=a;try{var xe=q.stateNode;m?Qv(xe,!0):Qv(q.stateNode,!1)}catch(gt){Gs(q,q.return,gt)}}}else if((a.tag!==22&&a.tag!==23||a.memoizedState===null||a===s)&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===s)break e;for(;a.sibling===null;){if(a.return===null||a.return===s)break e;o===a&&(o=null),a=a.return}o===a&&(o=null),a.sibling.return=a.return,a=a.sibling}c&4&&(c=s.updateQueue,c!==null&&(o=c.retryQueue,o!==null&&(c.retryQueue=null,Sd(s,o))));break;case 19:Ir(a,s),Dr(s),c&4&&(c=s.updateQueue,c!==null&&(s.updateQueue=null,Sd(s,c)));break;case 30:break;case 21:break;default:Ir(a,s),Dr(s)}}function Dr(s){var a=s.flags;if(a&2){try{for(var o,c=s.return;c!==null;){if(J0(c)){o=c;break}c=c.return}if(o==null)throw Error(i(160));switch(o.tag){case 27:var m=o.stateNode,f=Af(s);Ed(s,f,m);break;case 5:var w=o.stateNode;o.flags&32&&(Yt(w,""),o.flags&=-33);var S=Af(s);Ed(s,S,w);break;case 3:case 4:var q=o.stateNode.containerInfo,le=Af(s);Mf(s,le,q);break;default:throw Error(i(161))}}catch(je){Gs(s,s.return,je)}s.flags&=-3}a&4096&&(s.flags&=-4097)}function ov(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var a=s;ov(a),a.tag===5&&a.flags&1024&&a.stateNode.reset(),s=s.sibling}}function oi(s,a){if(a.subtreeFlags&8772)for(a=a.child;a!==null;)tv(s,a.alternate,a),a=a.sibling}function Po(s){for(s=s.child;s!==null;){var a=s;switch(a.tag){case 0:case 11:case 14:case 15:Pi(4,a,a.return),Po(a);break;case 1:Da(a,a.return);var o=a.stateNode;typeof o.componentWillUnmount=="function"&&Q0(a,a.return,o),Po(a);break;case 27:Fc(a.stateNode);case 26:case 5:Da(a,a.return),Po(a);break;case 22:a.memoizedState===null&&Po(a);break;case 30:Po(a);break;default:Po(a)}s=s.sibling}}function li(s,a,o){for(o=o&&(a.subtreeFlags&8772)!==0,a=a.child;a!==null;){var c=a.alternate,m=s,f=a,w=f.flags;switch(f.tag){case 0:case 11:case 15:li(m,f,o),Ac(4,f);break;case 1:if(li(m,f,o),c=f,m=c.stateNode,typeof m.componentDidMount=="function")try{m.componentDidMount()}catch(le){Gs(c,c.return,le)}if(c=f,m=c.updateQueue,m!==null){var S=c.stateNode;try{var q=m.shared.hiddenCallbacks;if(q!==null)for(m.shared.hiddenCallbacks=null,m=0;m<q.length;m++)Bb(q[m],S)}catch(le){Gs(c,c.return,le)}}o&&w&64&&Y0(f),Mc(f,f.return);break;case 27:Z0(f);case 26:case 5:li(m,f,o),o&&c===null&&w&4&&X0(f),Mc(f,f.return);break;case 12:li(m,f,o);break;case 31:li(m,f,o),o&&w&4&&rv(m,f);break;case 13:li(m,f,o),o&&w&4&&av(m,f);break;case 22:f.memoizedState===null&&li(m,f,o),Mc(f,f.return);break;case 30:break;default:li(m,f,o)}a=a.sibling}}function Df(s,a){var o=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(o=s.memoizedState.cachePool.pool),s=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(s=a.memoizedState.cachePool.pool),s!==o&&(s!=null&&s.refCount++,o!=null&&bc(o))}function Pf(s,a){s=null,a.alternate!==null&&(s=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==s&&(a.refCount++,s!=null&&bc(s))}function va(s,a,o,c){if(a.subtreeFlags&10256)for(a=a.child;a!==null;)lv(s,a,o,c),a=a.sibling}function lv(s,a,o,c){var m=a.flags;switch(a.tag){case 0:case 11:case 15:va(s,a,o,c),m&2048&&Ac(9,a);break;case 1:va(s,a,o,c);break;case 3:va(s,a,o,c),m&2048&&(s=null,a.alternate!==null&&(s=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==s&&(a.refCount++,s!=null&&bc(s)));break;case 12:if(m&2048){va(s,a,o,c),s=a.stateNode;try{var f=a.memoizedProps,w=f.id,S=f.onPostCommit;typeof S=="function"&&S(w,a.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(q){Gs(a,a.return,q)}}else va(s,a,o,c);break;case 31:va(s,a,o,c);break;case 13:va(s,a,o,c);break;case 23:break;case 22:f=a.stateNode,w=a.alternate,a.memoizedState!==null?f._visibility&2?va(s,a,o,c):Ic(s,a):f._visibility&2?va(s,a,o,c):(f._visibility|=2,kl(s,a,o,c,(a.subtreeFlags&10256)!==0||!1)),m&2048&&Df(w,a);break;case 24:va(s,a,o,c),m&2048&&Pf(a.alternate,a);break;default:va(s,a,o,c)}}function kl(s,a,o,c,m){for(m=m&&((a.subtreeFlags&10256)!==0||!1),a=a.child;a!==null;){var f=s,w=a,S=o,q=c,le=w.flags;switch(w.tag){case 0:case 11:case 15:kl(f,w,S,q,m),Ac(8,w);break;case 23:break;case 22:var je=w.stateNode;w.memoizedState!==null?je._visibility&2?kl(f,w,S,q,m):Ic(f,w):(je._visibility|=2,kl(f,w,S,q,m)),m&&le&2048&&Df(w.alternate,w);break;case 24:kl(f,w,S,q,m),m&&le&2048&&Pf(w.alternate,w);break;default:kl(f,w,S,q,m)}a=a.sibling}}function Ic(s,a){if(a.subtreeFlags&10256)for(a=a.child;a!==null;){var o=s,c=a,m=c.flags;switch(c.tag){case 22:Ic(o,c),m&2048&&Df(c.alternate,c);break;case 24:Ic(o,c),m&2048&&Pf(c.alternate,c);break;default:Ic(o,c)}a=a.sibling}}var Dc=8192;function jl(s,a,o){if(s.subtreeFlags&Dc)for(s=s.child;s!==null;)cv(s,a,o),s=s.sibling}function cv(s,a,o){switch(s.tag){case 26:jl(s,a,o),s.flags&Dc&&s.memoizedState!==null&&hT(o,ba,s.memoizedState,s.memoizedProps);break;case 5:jl(s,a,o);break;case 3:case 4:var c=ba;ba=Fd(s.stateNode.containerInfo),jl(s,a,o),ba=c;break;case 22:s.memoizedState===null&&(c=s.alternate,c!==null&&c.memoizedState!==null?(c=Dc,Dc=16777216,jl(s,a,o),Dc=c):jl(s,a,o));break;default:jl(s,a,o)}}function uv(s){var a=s.alternate;if(a!==null&&(s=a.child,s!==null)){a.child=null;do a=s.sibling,s.sibling=null,s=a;while(s!==null)}}function Pc(s){var a=s.deletions;if((s.flags&16)!==0){if(a!==null)for(var o=0;o<a.length;o++){var c=a[o];Jn=c,hv(c,s)}uv(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)dv(s),s=s.sibling}function dv(s){switch(s.tag){case 0:case 11:case 15:Pc(s),s.flags&2048&&Pi(9,s,s.return);break;case 3:Pc(s);break;case 12:Pc(s);break;case 22:var a=s.stateNode;s.memoizedState!==null&&a._visibility&2&&(s.return===null||s.return.tag!==13)?(a._visibility&=-3,Nd(s)):Pc(s);break;default:Pc(s)}}function Nd(s){var a=s.deletions;if((s.flags&16)!==0){if(a!==null)for(var o=0;o<a.length;o++){var c=a[o];Jn=c,hv(c,s)}uv(s)}for(s=s.child;s!==null;){switch(a=s,a.tag){case 0:case 11:case 15:Pi(8,a,a.return),Nd(a);break;case 22:o=a.stateNode,o._visibility&2&&(o._visibility&=-3,Nd(a));break;default:Nd(a)}s=s.sibling}}function hv(s,a){for(;Jn!==null;){var o=Jn;switch(o.tag){case 0:case 11:case 15:Pi(8,o,a);break;case 23:case 22:if(o.memoizedState!==null&&o.memoizedState.cachePool!==null){var c=o.memoizedState.cachePool.pool;c!=null&&c.refCount++}break;case 24:bc(o.memoizedState.cache)}if(c=o.child,c!==null)c.return=o,Jn=c;else e:for(o=s;Jn!==null;){c=Jn;var m=c.sibling,f=c.return;if(sv(c),c===o){Jn=null;break e}if(m!==null){m.return=f,Jn=m;break e}Jn=f}}}var Sj={getCacheForType:function(s){var a=sr(Pn),o=a.data.get(s);return o===void 0&&(o=s(),a.data.set(s,o)),o},cacheSignal:function(){return sr(Pn).controller.signal}},Nj=typeof WeakMap=="function"?WeakMap:Map,Bs=0,sn=null,ms=null,ys=0,Ws=0,Gr=null,Li=!1,Tl=!1,Lf=!1,ci=0,wn=0,Oi=0,Lo=0,Of=0,Kr=0,El=0,Lc=null,Pr=null,Bf=!1,Cd=0,mv=0,Rd=1/0,Ad=null,Bi=null,Hn=0,Vi=null,Sl=null,ui=0,Vf=0,Uf=null,fv=null,Oc=0,Ff=null;function Yr(){return(Bs&2)!==0&&ys!==0?ys&-ys:W.T!==null?Gf():Se()}function pv(){if(Kr===0)if((ys&536870912)===0||js){var s=z;z<<=1,(z&3932160)===0&&(z=262144),Kr=s}else Kr=536870912;return s=$r.current,s!==null&&(s.flags|=32),Kr}function Lr(s,a,o){(s===sn&&(Ws===2||Ws===9)||s.cancelPendingCommit!==null)&&(Nl(s,0),Ui(s,ys,Kr,!1)),Wt(s,o),((Bs&2)===0||s!==sn)&&(s===sn&&((Bs&2)===0&&(Lo|=o),wn===4&&Ui(s,ys,Kr,!1)),Pa(s))}function gv(s,a,o){if((Bs&6)!==0)throw Error(i(327));var c=!o&&(a&127)===0&&(a&s.expiredLanes)===0||Xe(s,a),m=c?Aj(s,a):qf(s,a,!0),f=c;do{if(m===0){Tl&&!c&&Ui(s,a,0,!1);break}else{if(o=s.current.alternate,f&&!Cj(o)){m=qf(s,a,!1),f=!1;continue}if(m===2){if(f=a,s.errorRecoveryDisabledLanes&f)var w=0;else w=s.pendingLanes&-536870913,w=w!==0?w:w&536870912?536870912:0;if(w!==0){a=w;e:{var S=s;m=Lc;var q=S.current.memoizedState.isDehydrated;if(q&&(Nl(S,w).flags|=256),w=qf(S,w,!1),w!==2){if(Lf&&!q){S.errorRecoveryDisabledLanes|=f,Lo|=f,m=4;break e}f=Pr,Pr=m,f!==null&&(Pr===null?Pr=f:Pr.push.apply(Pr,f))}m=w}if(f=!1,m!==2)continue}}if(m===1){Nl(s,0),Ui(s,a,0,!0);break}e:{switch(c=s,f=m,f){case 0:case 1:throw Error(i(345));case 4:if((a&4194048)!==a)break;case 6:Ui(c,a,Kr,!Li);break e;case 2:Pr=null;break;case 3:case 5:break;default:throw Error(i(329))}if((a&62914560)===a&&(m=Cd+300-Ut(),10<m)){if(Ui(c,a,Kr,!Li),He(c,0,!0)!==0)break e;ui=a,c.timeoutHandle=Gv(yv.bind(null,c,o,Pr,Ad,Bf,a,Kr,Lo,El,Li,f,"Throttled",-0,0),m);break e}yv(c,o,Pr,Ad,Bf,a,Kr,Lo,El,Li,f,null,-0,0)}}break}while(!0);Pa(s)}function yv(s,a,o,c,m,f,w,S,q,le,je,De,ce,xe){if(s.timeoutHandle=-1,De=a.subtreeFlags,De&8192||(De&16785408)===16785408){De={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Jt},cv(a,f,De);var gt=(f&62914560)===f?Cd-Ut():(f&4194048)===f?mv-Ut():0;if(gt=mT(De,gt),gt!==null){ui=f,s.cancelPendingCommit=gt(Tv.bind(null,s,a,f,o,c,m,w,S,q,je,De,null,ce,xe)),Ui(s,f,w,!le);return}}Tv(s,a,f,o,c,m,w,S,q)}function Cj(s){for(var a=s;;){var o=a.tag;if((o===0||o===11||o===15)&&a.flags&16384&&(o=a.updateQueue,o!==null&&(o=o.stores,o!==null)))for(var c=0;c<o.length;c++){var m=o[c],f=m.getSnapshot;m=m.value;try{if(!qr(f(),m))return!1}catch{return!1}}if(o=a.child,a.subtreeFlags&16384&&o!==null)o.return=a,a=o;else{if(a===s)break;for(;a.sibling===null;){if(a.return===null||a.return===s)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}}return!0}function Ui(s,a,o,c){a&=~Of,a&=~Lo,s.suspendedLanes|=a,s.pingedLanes&=~a,c&&(s.warmLanes|=a),c=s.expirationTimes;for(var m=a;0<m;){var f=31-Ue(m),w=1<<f;c[f]=-1,m&=~w}o!==0&&ts(s,o,a)}function Md(){return(Bs&6)===0?(Bc(0),!1):!0}function zf(){if(ms!==null){if(Ws===0)var s=ms.return;else s=ms,Za=So=null,nf(s),bl=null,xc=0,s=ms;for(;s!==null;)K0(s.alternate,s),s=s.return;ms=null}}function Nl(s,a){var o=s.timeoutHandle;o!==-1&&(s.timeoutHandle=-1,Yj(o)),o=s.cancelPendingCommit,o!==null&&(s.cancelPendingCommit=null,o()),ui=0,zf(),sn=s,ms=o=Xa(s.current,null),ys=a,Ws=0,Gr=null,Li=!1,Tl=Xe(s,a),Lf=!1,El=Kr=Of=Lo=Oi=wn=0,Pr=Lc=null,Bf=!1,(a&8)!==0&&(a|=a&32);var c=s.entangledLanes;if(c!==0)for(s=s.entanglements,c&=a;0<c;){var m=31-Ue(c),f=1<<m;a|=s[m],c&=~f}return ci=a,Zu(),o}function bv(s,a){ns=null,W.H=Nc,a===yl||a===od?(a=Db(),Ws=3):a===$m?(a=Db(),Ws=4):Ws=a===xf?8:a!==null&&typeof a=="object"&&typeof a.then=="function"?6:1,Gr=a,ms===null&&(wn=1,wd(s,sa(a,s.current)))}function vv(){var s=$r.current;return s===null?!0:(ys&4194048)===ys?ia===null:(ys&62914560)===ys||(ys&536870912)!==0?s===ia:!1}function xv(){var s=W.H;return W.H=Nc,s===null?Nc:s}function wv(){var s=W.A;return W.A=Sj,s}function Id(){wn=4,Li||(ys&4194048)!==ys&&$r.current!==null||(Tl=!0),(Oi&134217727)===0&&(Lo&134217727)===0||sn===null||Ui(sn,ys,Kr,!1)}function qf(s,a,o){var c=Bs;Bs|=2;var m=xv(),f=wv();(sn!==s||ys!==a)&&(Ad=null,Nl(s,a)),a=!1;var w=wn;e:do try{if(Ws!==0&&ms!==null){var S=ms,q=Gr;switch(Ws){case 8:zf(),w=6;break e;case 3:case 2:case 9:case 6:$r.current===null&&(a=!0);var le=Ws;if(Ws=0,Gr=null,Cl(s,S,q,le),o&&Tl){w=0;break e}break;default:le=Ws,Ws=0,Gr=null,Cl(s,S,q,le)}}Rj(),w=wn;break}catch(je){bv(s,je)}while(!0);return a&&s.shellSuspendCounter++,Za=So=null,Bs=c,W.H=m,W.A=f,ms===null&&(sn=null,ys=0,Zu()),w}function Rj(){for(;ms!==null;)_v(ms)}function Aj(s,a){var o=Bs;Bs|=2;var c=xv(),m=wv();sn!==s||ys!==a?(Ad=null,Rd=Ut()+500,Nl(s,a)):Tl=Xe(s,a);e:do try{if(Ws!==0&&ms!==null){a=ms;var f=Gr;t:switch(Ws){case 1:Ws=0,Gr=null,Cl(s,a,f,1);break;case 2:case 9:if(Mb(f)){Ws=0,Gr=null,kv(a);break}a=function(){Ws!==2&&Ws!==9||sn!==s||(Ws=7),Pa(s)},f.then(a,a);break e;case 3:Ws=7;break e;case 4:Ws=5;break e;case 7:Mb(f)?(Ws=0,Gr=null,kv(a)):(Ws=0,Gr=null,Cl(s,a,f,7));break;case 5:var w=null;switch(ms.tag){case 26:w=ms.memoizedState;case 5:case 27:var S=ms;if(w?l1(w):S.stateNode.complete){Ws=0,Gr=null;var q=S.sibling;if(q!==null)ms=q;else{var le=S.return;le!==null?(ms=le,Dd(le)):ms=null}break t}}Ws=0,Gr=null,Cl(s,a,f,5);break;case 6:Ws=0,Gr=null,Cl(s,a,f,6);break;case 8:zf(),wn=6;break e;default:throw Error(i(462))}}Mj();break}catch(je){bv(s,je)}while(!0);return Za=So=null,W.H=c,W.A=m,Bs=o,ms!==null?0:(sn=null,ys=0,Zu(),wn)}function Mj(){for(;ms!==null&&!Xt();)_v(ms)}function _v(s){var a=W0(s.alternate,s,ci);s.memoizedProps=s.pendingProps,a===null?Dd(s):ms=a}function kv(s){var a=s,o=a.alternate;switch(a.tag){case 15:case 0:a=U0(o,a,a.pendingProps,a.type,void 0,ys);break;case 11:a=U0(o,a,a.pendingProps,a.type.render,a.ref,ys);break;case 5:nf(a);default:K0(o,a),a=ms=wb(a,ci),a=W0(o,a,ci)}s.memoizedProps=s.pendingProps,a===null?Dd(s):ms=a}function Cl(s,a,o,c){Za=So=null,nf(a),bl=null,xc=0;var m=a.return;try{if(xj(s,m,a,o,ys)){wn=1,wd(s,sa(o,s.current)),ms=null;return}}catch(f){if(m!==null)throw ms=m,f;wn=1,wd(s,sa(o,s.current)),ms=null;return}a.flags&32768?(js||c===1?s=!0:Tl||(ys&536870912)!==0?s=!1:(Li=s=!0,(c===2||c===9||c===3||c===6)&&(c=$r.current,c!==null&&c.tag===13&&(c.flags|=16384))),jv(a,s)):Dd(a)}function Dd(s){var a=s;do{if((a.flags&32768)!==0){jv(a,Li);return}s=a.return;var o=kj(a.alternate,a,ci);if(o!==null){ms=o;return}if(a=a.sibling,a!==null){ms=a;return}ms=a=s}while(a!==null);wn===0&&(wn=5)}function jv(s,a){do{var o=jj(s.alternate,s);if(o!==null){o.flags&=32767,ms=o;return}if(o=s.return,o!==null&&(o.flags|=32768,o.subtreeFlags=0,o.deletions=null),!a&&(s=s.sibling,s!==null)){ms=s;return}ms=s=o}while(s!==null);wn=6,ms=null}function Tv(s,a,o,c,m,f,w,S,q){s.cancelPendingCommit=null;do Pd();while(Hn!==0);if((Bs&6)!==0)throw Error(i(327));if(a!==null){if(a===s.current)throw Error(i(177));if(f=a.lanes|a.childLanes,f|=Rm,en(s,o,f,w,S,q),s===sn&&(ms=sn=null,ys=0),Sl=a,Vi=s,ui=o,Vf=f,Uf=m,fv=c,(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,Lj(Kt,function(){return Rv(),null})):(s.callbackNode=null,s.callbackPriority=0),c=(a.flags&13878)!==0,(a.subtreeFlags&13878)!==0||c){c=W.T,W.T=null,m=ue.p,ue.p=2,w=Bs,Bs|=4;try{Tj(s,a,o)}finally{Bs=w,ue.p=m,W.T=c}}Hn=1,Ev(),Sv(),Nv()}}function Ev(){if(Hn===1){Hn=0;var s=Vi,a=Sl,o=(a.flags&13878)!==0;if((a.subtreeFlags&13878)!==0||o){o=W.T,W.T=null;var c=ue.p;ue.p=2;var m=Bs;Bs|=4;try{iv(a,s);var f=tp,w=hb(s.containerInfo),S=f.focusedElem,q=f.selectionRange;if(w!==S&&S&&S.ownerDocument&&db(S.ownerDocument.documentElement,S)){if(q!==null&&Tm(S)){var le=q.start,je=q.end;if(je===void 0&&(je=le),"selectionStart"in S)S.selectionStart=le,S.selectionEnd=Math.min(je,S.value.length);else{var De=S.ownerDocument||document,ce=De&&De.defaultView||window;if(ce.getSelection){var xe=ce.getSelection(),gt=S.textContent.length,Ot=Math.min(q.start,gt),Js=q.end===void 0?Ot:Math.min(q.end,gt);!xe.extend&&Ot>Js&&(w=Js,Js=Ot,Ot=w);var ee=ub(S,Ot),K=ub(S,Js);if(ee&&K&&(xe.rangeCount!==1||xe.anchorNode!==ee.node||xe.anchorOffset!==ee.offset||xe.focusNode!==K.node||xe.focusOffset!==K.offset)){var oe=De.createRange();oe.setStart(ee.node,ee.offset),xe.removeAllRanges(),Ot>Js?(xe.addRange(oe),xe.extend(K.node,K.offset)):(oe.setEnd(K.node,K.offset),xe.addRange(oe))}}}}for(De=[],xe=S;xe=xe.parentNode;)xe.nodeType===1&&De.push({element:xe,left:xe.scrollLeft,top:xe.scrollTop});for(typeof S.focus=="function"&&S.focus(),S=0;S<De.length;S++){var Ae=De[S];Ae.element.scrollLeft=Ae.left,Ae.element.scrollTop=Ae.top}}Gd=!!ep,tp=ep=null}finally{Bs=m,ue.p=c,W.T=o}}s.current=a,Hn=2}}function Sv(){if(Hn===2){Hn=0;var s=Vi,a=Sl,o=(a.flags&8772)!==0;if((a.subtreeFlags&8772)!==0||o){o=W.T,W.T=null;var c=ue.p;ue.p=2;var m=Bs;Bs|=4;try{tv(s,a.alternate,a)}finally{Bs=m,ue.p=c,W.T=o}}Hn=3}}function Nv(){if(Hn===4||Hn===3){Hn=0,Ks();var s=Vi,a=Sl,o=ui,c=fv;(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?Hn=5:(Hn=0,Sl=Vi=null,Cv(s,s.pendingLanes));var m=s.pendingLanes;if(m===0&&(Bi=null),we(o),a=a.stateNode,Te&&typeof Te.onCommitFiberRoot=="function")try{Te.onCommitFiberRoot(be,a,void 0,(a.current.flags&128)===128)}catch{}if(c!==null){a=W.T,m=ue.p,ue.p=2,W.T=null;try{for(var f=s.onRecoverableError,w=0;w<c.length;w++){var S=c[w];f(S.value,{componentStack:S.stack})}}finally{W.T=a,ue.p=m}}(ui&3)!==0&&Pd(),Pa(s),m=s.pendingLanes,(o&261930)!==0&&(m&42)!==0?s===Ff?Oc++:(Oc=0,Ff=s):Oc=0,Bc(0)}}function Cv(s,a){(s.pooledCacheLanes&=a)===0&&(a=s.pooledCache,a!=null&&(s.pooledCache=null,bc(a)))}function Pd(){return Ev(),Sv(),Nv(),Rv()}function Rv(){if(Hn!==5)return!1;var s=Vi,a=Vf;Vf=0;var o=we(ui),c=W.T,m=ue.p;try{ue.p=32>o?32:o,W.T=null,o=Uf,Uf=null;var f=Vi,w=ui;if(Hn=0,Sl=Vi=null,ui=0,(Bs&6)!==0)throw Error(i(331));var S=Bs;if(Bs|=4,dv(f.current),lv(f,f.current,w,o),Bs=S,Bc(0,!1),Te&&typeof Te.onPostCommitFiberRoot=="function")try{Te.onPostCommitFiberRoot(be,f)}catch{}return!0}finally{ue.p=m,W.T=c,Cv(s,a)}}function Av(s,a,o){a=sa(o,a),a=vf(s.stateNode,a,2),s=Mi(s,a,2),s!==null&&(Wt(s,2),Pa(s))}function Gs(s,a,o){if(s.tag===3)Av(s,s,o);else for(;a!==null;){if(a.tag===3){Av(a,s,o);break}else if(a.tag===1){var c=a.stateNode;if(typeof a.type.getDerivedStateFromError=="function"||typeof c.componentDidCatch=="function"&&(Bi===null||!Bi.has(c))){s=sa(o,s),o=M0(2),c=Mi(a,o,2),c!==null&&(I0(o,c,a,s),Wt(c,2),Pa(c));break}}a=a.return}}function Hf(s,a,o){var c=s.pingCache;if(c===null){c=s.pingCache=new Nj;var m=new Set;c.set(a,m)}else m=c.get(a),m===void 0&&(m=new Set,c.set(a,m));m.has(o)||(Lf=!0,m.add(o),s=Ij.bind(null,s,a,o),a.then(s,s))}function Ij(s,a,o){var c=s.pingCache;c!==null&&c.delete(a),s.pingedLanes|=s.suspendedLanes&o,s.warmLanes&=~o,sn===s&&(ys&o)===o&&(wn===4||wn===3&&(ys&62914560)===ys&&300>Ut()-Cd?(Bs&2)===0&&Nl(s,0):Of|=o,El===ys&&(El=0)),Pa(s)}function Mv(s,a){a===0&&(a=_t()),s=jo(s,a),s!==null&&(Wt(s,a),Pa(s))}function Dj(s){var a=s.memoizedState,o=0;a!==null&&(o=a.retryLane),Mv(s,o)}function Pj(s,a){var o=0;switch(s.tag){case 31:case 13:var c=s.stateNode,m=s.memoizedState;m!==null&&(o=m.retryLane);break;case 19:c=s.stateNode;break;case 22:c=s.stateNode._retryCache;break;default:throw Error(i(314))}c!==null&&c.delete(a),Mv(s,o)}function Lj(s,a){return Ye(s,a)}var Ld=null,Rl=null,$f=!1,Od=!1,Wf=!1,Fi=0;function Pa(s){s!==Rl&&s.next===null&&(Rl===null?Ld=Rl=s:Rl=Rl.next=s),Od=!0,$f||($f=!0,Bj())}function Bc(s,a){if(!Wf&&Od){Wf=!0;do for(var o=!1,c=Ld;c!==null;){if(s!==0){var m=c.pendingLanes;if(m===0)var f=0;else{var w=c.suspendedLanes,S=c.pingedLanes;f=(1<<31-Ue(42|s)+1)-1,f&=m&~(w&~S),f=f&201326741?f&201326741|1:f?f|2:0}f!==0&&(o=!0,Lv(c,f))}else f=ys,f=He(c,c===sn?f:0,c.cancelPendingCommit!==null||c.timeoutHandle!==-1),(f&3)===0||Xe(c,f)||(o=!0,Lv(c,f));c=c.next}while(o);Wf=!1}}function Oj(){Iv()}function Iv(){Od=$f=!1;var s=0;Fi!==0&&Kj()&&(s=Fi);for(var a=Ut(),o=null,c=Ld;c!==null;){var m=c.next,f=Dv(c,a);f===0?(c.next=null,o===null?Ld=m:o.next=m,m===null&&(Rl=o)):(o=c,(s!==0||(f&3)!==0)&&(Od=!0)),c=m}Hn!==0&&Hn!==5||Bc(s),Fi!==0&&(Fi=0)}function Dv(s,a){for(var o=s.suspendedLanes,c=s.pingedLanes,m=s.expirationTimes,f=s.pendingLanes&-62914561;0<f;){var w=31-Ue(f),S=1<<w,q=m[w];q===-1?((S&o)===0||(S&c)!==0)&&(m[w]=lt(S,a)):q<=a&&(s.expiredLanes|=S),f&=~S}if(a=sn,o=ys,o=He(s,s===a?o:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),c=s.callbackNode,o===0||s===a&&(Ws===2||Ws===9)||s.cancelPendingCommit!==null)return c!==null&&c!==null&&It(c),s.callbackNode=null,s.callbackPriority=0;if((o&3)===0||Xe(s,o)){if(a=o&-o,a===s.callbackPriority)return a;switch(c!==null&&It(c),we(o)){case 2:case 8:o=Ms;break;case 32:o=Kt;break;case 268435456:o=ds;break;default:o=Kt}return c=Pv.bind(null,s),o=Ye(o,c),s.callbackPriority=a,s.callbackNode=o,a}return c!==null&&c!==null&&It(c),s.callbackPriority=2,s.callbackNode=null,2}function Pv(s,a){if(Hn!==0&&Hn!==5)return s.callbackNode=null,s.callbackPriority=0,null;var o=s.callbackNode;if(Pd()&&s.callbackNode!==o)return null;var c=ys;return c=He(s,s===sn?c:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),c===0?null:(gv(s,c,a),Dv(s,Ut()),s.callbackNode!=null&&s.callbackNode===o?Pv.bind(null,s):null)}function Lv(s,a){if(Pd())return null;gv(s,a,!0)}function Bj(){Qj(function(){(Bs&6)!==0?Ye(is,Oj):Iv()})}function Gf(){if(Fi===0){var s=pl;s===0&&(s=Ke,Ke<<=1,(Ke&261888)===0&&(Ke=256)),Fi=s}return Fi}function Ov(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:Ys(""+s)}function Bv(s,a){var o=a.ownerDocument.createElement("input");return o.name=a.name,o.value=a.value,s.id&&o.setAttribute("form",s.id),a.parentNode.insertBefore(o,a),s=new FormData(s),o.parentNode.removeChild(o),s}function Vj(s,a,o,c,m){if(a==="submit"&&o&&o.stateNode===m){var f=Ov((m[bt]||null).action),w=c.submitter;w&&(a=(a=w[bt]||null)?Ov(a.formAction):w.getAttribute("formAction"),a!==null&&(f=a,w=null));var S=new os("action","action",null,c,m);s.push({event:S,listeners:[{instance:null,listener:function(){if(c.defaultPrevented){if(Fi!==0){var q=w?Bv(m,w):new FormData(m);mf(o,{pending:!0,data:q,method:m.method,action:f},null,q)}}else typeof f=="function"&&(S.preventDefault(),q=w?Bv(m,w):new FormData(m),mf(o,{pending:!0,data:q,method:m.method,action:f},f,q))},currentTarget:m}]})}}for(var Kf=0;Kf<Cm.length;Kf++){var Yf=Cm[Kf],Uj=Yf.toLowerCase(),Fj=Yf[0].toUpperCase()+Yf.slice(1);ya(Uj,"on"+Fj)}ya(pb,"onAnimationEnd"),ya(gb,"onAnimationIteration"),ya(yb,"onAnimationStart"),ya("dblclick","onDoubleClick"),ya("focusin","onFocus"),ya("focusout","onBlur"),ya(nj,"onTransitionRun"),ya(rj,"onTransitionStart"),ya(aj,"onTransitionCancel"),ya(bb,"onTransitionEnd"),Ve("onMouseEnter",["mouseout","mouseover"]),Ve("onMouseLeave",["mouseout","mouseover"]),Ve("onPointerEnter",["pointerout","pointerover"]),Ve("onPointerLeave",["pointerout","pointerover"]),ye("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),ye("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),ye("onBeforeInput",["compositionend","keypress","textInput","paste"]),ye("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),ye("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),ye("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Vc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),zj=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Vc));function Vv(s,a){a=(a&4)!==0;for(var o=0;o<s.length;o++){var c=s[o],m=c.event;c=c.listeners;e:{var f=void 0;if(a)for(var w=c.length-1;0<=w;w--){var S=c[w],q=S.instance,le=S.currentTarget;if(S=S.listener,q!==f&&m.isPropagationStopped())break e;f=S,m.currentTarget=le;try{f(m)}catch(je){Ju(je)}m.currentTarget=null,f=q}else for(w=0;w<c.length;w++){if(S=c[w],q=S.instance,le=S.currentTarget,S=S.listener,q!==f&&m.isPropagationStopped())break e;f=S,m.currentTarget=le;try{f(m)}catch(je){Ju(je)}m.currentTarget=null,f=q}}}}function fs(s,a){var o=a[St];o===void 0&&(o=a[St]=new Set);var c=s+"__bubble";o.has(c)||(Uv(a,s,2,!1),o.add(c))}function Qf(s,a,o){var c=0;a&&(c|=4),Uv(o,s,c,a)}var Bd="_reactListening"+Math.random().toString(36).slice(2);function Xf(s){if(!s[Bd]){s[Bd]=!0,P.forEach(function(o){o!=="selectionchange"&&(zj.has(o)||Qf(o,!1,s),Qf(o,!0,s))});var a=s.nodeType===9?s:s.ownerDocument;a===null||a[Bd]||(a[Bd]=!0,Qf("selectionchange",!1,a))}}function Uv(s,a,o,c){switch(p1(a)){case 2:var m=gT;break;case 8:m=yT;break;default:m=hp}o=m.bind(null,a,o,s),m=void 0,!Fr||a!=="touchstart"&&a!=="touchmove"&&a!=="wheel"||(m=!0),c?m!==void 0?s.addEventListener(a,o,{capture:!0,passive:m}):s.addEventListener(a,o,!0):m!==void 0?s.addEventListener(a,o,{passive:m}):s.addEventListener(a,o,!1)}function Jf(s,a,o,c,m){var f=c;if((a&1)===0&&(a&2)===0&&c!==null)e:for(;;){if(c===null)return;var w=c.tag;if(w===3||w===4){var S=c.stateNode.containerInfo;if(S===m)break;if(w===4)for(w=c.return;w!==null;){var q=w.tag;if((q===3||q===4)&&w.stateNode.containerInfo===m)return;w=w.return}for(;S!==null;){if(w=bn(S),w===null)return;if(q=w.tag,q===5||q===6||q===26||q===27){c=f=w;continue e}S=S.parentNode}}c=c.return}cr(function(){var le=f,je=pn(o),De=[];e:{var ce=vb.get(s);if(ce!==void 0){var xe=os,gt=s;switch(s){case"keypress":if(Bt(o)===0)break e;case"keydown":case"keyup":xe=Yu;break;case"focusin":gt="focus",xe=Xn;break;case"focusout":gt="blur",xe=Xn;break;case"beforeblur":case"afterblur":xe=Xn;break;case"click":if(o.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":xe=Qn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":xe=xr;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":xe=b;break;case pb:case gb:case yb:xe=qn;break;case bb:xe=A;break;case"scroll":case"scrollend":xe=zr;break;case"wheel":xe=pe;break;case"copy":case"cut":case"paste":xe=Ar;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":xe=Qa;break;case"toggle":case"beforetoggle":xe=ss}var Ot=(a&4)!==0,Js=!Ot&&(s==="scroll"||s==="scrollend"),ee=Ot?ce!==null?ce+"Capture":null:ce;Ot=[];for(var K=le,oe;K!==null;){var Ae=K;if(oe=Ae.stateNode,Ae=Ae.tag,Ae!==5&&Ae!==26&&Ae!==27||oe===null||ee===null||(Ae=ur(K,ee),Ae!=null&&Ot.push(Uc(K,Ae,oe))),Js)break;K=K.return}0<Ot.length&&(ce=new xe(ce,gt,null,o,je),De.push({event:ce,listeners:Ot}))}}if((a&7)===0){e:{if(ce=s==="mouseover"||s==="pointerover",xe=s==="mouseout"||s==="pointerout",ce&&o!==ln&&(gt=o.relatedTarget||o.fromElement)&&(bn(gt)||gt[st]))break e;if((xe||ce)&&(ce=je.window===je?je:(ce=je.ownerDocument)?ce.defaultView||ce.parentWindow:window,xe?(gt=o.relatedTarget||o.toElement,xe=le,gt=gt?bn(gt):null,gt!==null&&(Js=u(gt),Ot=gt.tag,gt!==Js||Ot!==5&&Ot!==27&&Ot!==6)&&(gt=null)):(xe=null,gt=le),xe!==gt)){if(Ot=Qn,Ae="onMouseLeave",ee="onMouseEnter",K="mouse",(s==="pointerout"||s==="pointerover")&&(Ot=Qa,Ae="onPointerLeave",ee="onPointerEnter",K="pointer"),Js=xe==null?ce:qs(xe),oe=gt==null?ce:qs(gt),ce=new Ot(Ae,K+"leave",xe,o,je),ce.target=Js,ce.relatedTarget=oe,Ae=null,bn(je)===le&&(Ot=new Ot(ee,K+"enter",gt,o,je),Ot.target=oe,Ot.relatedTarget=Js,Ae=Ot),Js=Ae,xe&&gt)t:{for(Ot=qj,ee=xe,K=gt,oe=0,Ae=ee;Ae;Ae=Ot(Ae))oe++;Ae=0;for(var Rt=K;Rt;Rt=Ot(Rt))Ae++;for(;0<oe-Ae;)ee=Ot(ee),oe--;for(;0<Ae-oe;)K=Ot(K),Ae--;for(;oe--;){if(ee===K||K!==null&&ee===K.alternate){Ot=ee;break t}ee=Ot(ee),K=Ot(K)}Ot=null}else Ot=null;xe!==null&&Fv(De,ce,xe,Ot,!1),gt!==null&&Js!==null&&Fv(De,Js,gt,Ot,!0)}}e:{if(ce=le?qs(le):window,xe=ce.nodeName&&ce.nodeName.toLowerCase(),xe==="select"||xe==="input"&&ce.type==="file")var Is=rb;else if(sb(ce))if(ab)Is=ej;else{Is=Jk;var wt=Xk}else xe=ce.nodeName,!xe||xe.toLowerCase()!=="input"||ce.type!=="checkbox"&&ce.type!=="radio"?le&&Us(le.elementType)&&(Is=rb):Is=Zk;if(Is&&(Is=Is(s,le))){nb(De,Is,o,je);break e}wt&&wt(s,ce,le),s==="focusout"&&le&&ce.type==="number"&&le.memoizedProps.value!=null&&Je(ce,"number",ce.value)}switch(wt=le?qs(le):window,s){case"focusin":(sb(wt)||wt.contentEditable==="true")&&(ol=wt,Em=le,pc=null);break;case"focusout":pc=Em=ol=null;break;case"mousedown":Sm=!0;break;case"contextmenu":case"mouseup":case"dragend":Sm=!1,mb(De,o,je);break;case"selectionchange":if(sj)break;case"keydown":case"keyup":mb(De,o,je)}var rs;if(Os)e:{switch(s){case"compositionstart":var bs="onCompositionStart";break e;case"compositionend":bs="onCompositionEnd";break e;case"compositionupdate":bs="onCompositionUpdate";break e}bs=void 0}else il?wo(s,o)&&(bs="onCompositionEnd"):s==="keydown"&&o.keyCode===229&&(bs="onCompositionStart");bs&&(Aa&&o.locale!=="ko"&&(il||bs!=="onCompositionStart"?bs==="onCompositionEnd"&&il&&(rs=Tt()):(X=je,Fe="value"in X?X.value:X.textContent,il=!0)),wt=Vd(le,bs),0<wt.length&&(bs=new Zr(bs,s,null,o,je),De.push({event:bs,listeners:wt}),rs?bs.data=rs:(rs=al(o),rs!==null&&(bs.data=rs)))),(rs=ea?Gk(s,o):Kk(s,o))&&(bs=Vd(le,"onBeforeInput"),0<bs.length&&(wt=new Zr("onBeforeInput","beforeinput",null,o,je),De.push({event:wt,listeners:bs}),wt.data=rs)),Vj(De,s,le,o,je)}Vv(De,a)})}function Uc(s,a,o){return{instance:s,listener:a,currentTarget:o}}function Vd(s,a){for(var o=a+"Capture",c=[];s!==null;){var m=s,f=m.stateNode;if(m=m.tag,m!==5&&m!==26&&m!==27||f===null||(m=ur(s,o),m!=null&&c.unshift(Uc(s,m,f)),m=ur(s,a),m!=null&&c.push(Uc(s,m,f))),s.tag===3)return c;s=s.return}return[]}function qj(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function Fv(s,a,o,c,m){for(var f=a._reactName,w=[];o!==null&&o!==c;){var S=o,q=S.alternate,le=S.stateNode;if(S=S.tag,q!==null&&q===c)break;S!==5&&S!==26&&S!==27||le===null||(q=le,m?(le=ur(o,f),le!=null&&w.unshift(Uc(o,le,q))):m||(le=ur(o,f),le!=null&&w.push(Uc(o,le,q)))),o=o.return}w.length!==0&&s.push({event:a,listeners:w})}var Hj=/\r\n?/g,$j=/\u0000|\uFFFD/g;function zv(s){return(typeof s=="string"?s:""+s).replace(Hj,`
`).replace($j,"")}function qv(s,a){return a=zv(a),zv(s)===a}function Xs(s,a,o,c,m,f){switch(o){case"children":typeof c=="string"?a==="body"||a==="textarea"&&c===""||Yt(s,c):(typeof c=="number"||typeof c=="bigint")&&a!=="body"&&Yt(s,""+c);break;case"className":ls(s,"class",c);break;case"tabIndex":ls(s,"tabindex",c);break;case"dir":case"role":case"viewBox":case"width":case"height":ls(s,o,c);break;case"style":Vs(s,c,f);break;case"data":if(a!=="object"){ls(s,"data",c);break}case"src":case"href":if(c===""&&(a!=="a"||o!=="href")){s.removeAttribute(o);break}if(c==null||typeof c=="function"||typeof c=="symbol"||typeof c=="boolean"){s.removeAttribute(o);break}c=Ys(""+c),s.setAttribute(o,c);break;case"action":case"formAction":if(typeof c=="function"){s.setAttribute(o,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof f=="function"&&(o==="formAction"?(a!=="input"&&Xs(s,a,"name",m.name,m,null),Xs(s,a,"formEncType",m.formEncType,m,null),Xs(s,a,"formMethod",m.formMethod,m,null),Xs(s,a,"formTarget",m.formTarget,m,null)):(Xs(s,a,"encType",m.encType,m,null),Xs(s,a,"method",m.method,m,null),Xs(s,a,"target",m.target,m,null)));if(c==null||typeof c=="symbol"||typeof c=="boolean"){s.removeAttribute(o);break}c=Ys(""+c),s.setAttribute(o,c);break;case"onClick":c!=null&&(s.onclick=Jt);break;case"onScroll":c!=null&&fs("scroll",s);break;case"onScrollEnd":c!=null&&fs("scrollend",s);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(i(61));if(o=c.__html,o!=null){if(m.children!=null)throw Error(i(60));s.innerHTML=o}}break;case"multiple":s.multiple=c&&typeof c!="function"&&typeof c!="symbol";break;case"muted":s.muted=c&&typeof c!="function"&&typeof c!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(c==null||typeof c=="function"||typeof c=="boolean"||typeof c=="symbol"){s.removeAttribute("xlink:href");break}o=Ys(""+c),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",o);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":c!=null&&typeof c!="function"&&typeof c!="symbol"?s.setAttribute(o,""+c):s.removeAttribute(o);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":c&&typeof c!="function"&&typeof c!="symbol"?s.setAttribute(o,""):s.removeAttribute(o);break;case"capture":case"download":c===!0?s.setAttribute(o,""):c!==!1&&c!=null&&typeof c!="function"&&typeof c!="symbol"?s.setAttribute(o,c):s.removeAttribute(o);break;case"cols":case"rows":case"size":case"span":c!=null&&typeof c!="function"&&typeof c!="symbol"&&!isNaN(c)&&1<=c?s.setAttribute(o,c):s.removeAttribute(o);break;case"rowSpan":case"start":c==null||typeof c=="function"||typeof c=="symbol"||isNaN(c)?s.removeAttribute(o):s.setAttribute(o,c);break;case"popover":fs("beforetoggle",s),fs("toggle",s),Cs(s,"popover",c);break;case"xlinkActuate":cs(s,"http://www.w3.org/1999/xlink","xlink:actuate",c);break;case"xlinkArcrole":cs(s,"http://www.w3.org/1999/xlink","xlink:arcrole",c);break;case"xlinkRole":cs(s,"http://www.w3.org/1999/xlink","xlink:role",c);break;case"xlinkShow":cs(s,"http://www.w3.org/1999/xlink","xlink:show",c);break;case"xlinkTitle":cs(s,"http://www.w3.org/1999/xlink","xlink:title",c);break;case"xlinkType":cs(s,"http://www.w3.org/1999/xlink","xlink:type",c);break;case"xmlBase":cs(s,"http://www.w3.org/XML/1998/namespace","xml:base",c);break;case"xmlLang":cs(s,"http://www.w3.org/XML/1998/namespace","xml:lang",c);break;case"xmlSpace":cs(s,"http://www.w3.org/XML/1998/namespace","xml:space",c);break;case"is":Cs(s,"is",c);break;case"innerText":case"textContent":break;default:(!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(o=In.get(o)||o,Cs(s,o,c))}}function Zf(s,a,o,c,m,f){switch(o){case"style":Vs(s,c,f);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(i(61));if(o=c.__html,o!=null){if(m.children!=null)throw Error(i(60));s.innerHTML=o}}break;case"children":typeof c=="string"?Yt(s,c):(typeof c=="number"||typeof c=="bigint")&&Yt(s,""+c);break;case"onScroll":c!=null&&fs("scroll",s);break;case"onScrollEnd":c!=null&&fs("scrollend",s);break;case"onClick":c!=null&&(s.onclick=Jt);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!U.hasOwnProperty(o))e:{if(o[0]==="o"&&o[1]==="n"&&(m=o.endsWith("Capture"),a=o.slice(2,m?o.length-7:void 0),f=s[bt]||null,f=f!=null?f[o]:null,typeof f=="function"&&s.removeEventListener(a,f,m),typeof c=="function")){typeof f!="function"&&f!==null&&(o in s?s[o]=null:s.hasAttribute(o)&&s.removeAttribute(o)),s.addEventListener(a,c,m);break e}o in s?s[o]=c:c===!0?s.setAttribute(o,""):Cs(s,o,c)}}}function rr(s,a,o){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":fs("error",s),fs("load",s);var c=!1,m=!1,f;for(f in o)if(o.hasOwnProperty(f)){var w=o[f];if(w!=null)switch(f){case"src":c=!0;break;case"srcSet":m=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,a));default:Xs(s,a,f,w,o,null)}}m&&Xs(s,a,"srcSet",o.srcSet,o,null),c&&Xs(s,a,"src",o.src,o,null);return;case"input":fs("invalid",s);var S=f=w=m=null,q=null,le=null;for(c in o)if(o.hasOwnProperty(c)){var je=o[c];if(je!=null)switch(c){case"name":m=je;break;case"type":w=je;break;case"checked":q=je;break;case"defaultChecked":le=je;break;case"value":f=je;break;case"defaultValue":S=je;break;case"children":case"dangerouslySetInnerHTML":if(je!=null)throw Error(i(137,a));break;default:Xs(s,a,c,je,o,null)}}tt(s,f,S,q,le,w,m,!1);return;case"select":fs("invalid",s),c=w=f=null;for(m in o)if(o.hasOwnProperty(m)&&(S=o[m],S!=null))switch(m){case"value":f=S;break;case"defaultValue":w=S;break;case"multiple":c=S;default:Xs(s,a,m,S,o,null)}a=f,o=w,s.multiple=!!c,a!=null?ct(s,!!c,a,!1):o!=null&&ct(s,!!c,o,!0);return;case"textarea":fs("invalid",s),f=m=c=null;for(w in o)if(o.hasOwnProperty(w)&&(S=o[w],S!=null))switch(w){case"value":c=S;break;case"defaultValue":m=S;break;case"children":f=S;break;case"dangerouslySetInnerHTML":if(S!=null)throw Error(i(91));break;default:Xs(s,a,w,S,o,null)}$t(s,c,m,f);return;case"option":for(q in o)o.hasOwnProperty(q)&&(c=o[q],c!=null)&&(q==="selected"?s.selected=c&&typeof c!="function"&&typeof c!="symbol":Xs(s,a,q,c,o,null));return;case"dialog":fs("beforetoggle",s),fs("toggle",s),fs("cancel",s),fs("close",s);break;case"iframe":case"object":fs("load",s);break;case"video":case"audio":for(c=0;c<Vc.length;c++)fs(Vc[c],s);break;case"image":fs("error",s),fs("load",s);break;case"details":fs("toggle",s);break;case"embed":case"source":case"link":fs("error",s),fs("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(le in o)if(o.hasOwnProperty(le)&&(c=o[le],c!=null))switch(le){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,a));default:Xs(s,a,le,c,o,null)}return;default:if(Us(a)){for(je in o)o.hasOwnProperty(je)&&(c=o[je],c!==void 0&&Zf(s,a,je,c,o,void 0));return}}for(S in o)o.hasOwnProperty(S)&&(c=o[S],c!=null&&Xs(s,a,S,c,o,null))}function Wj(s,a,o,c){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var m=null,f=null,w=null,S=null,q=null,le=null,je=null;for(xe in o){var De=o[xe];if(o.hasOwnProperty(xe)&&De!=null)switch(xe){case"checked":break;case"value":break;case"defaultValue":q=De;default:c.hasOwnProperty(xe)||Xs(s,a,xe,null,c,De)}}for(var ce in c){var xe=c[ce];if(De=o[ce],c.hasOwnProperty(ce)&&(xe!=null||De!=null))switch(ce){case"type":f=xe;break;case"name":m=xe;break;case"checked":le=xe;break;case"defaultChecked":je=xe;break;case"value":w=xe;break;case"defaultValue":S=xe;break;case"children":case"dangerouslySetInnerHTML":if(xe!=null)throw Error(i(137,a));break;default:xe!==De&&Xs(s,a,ce,xe,c,De)}}_e(s,w,S,q,le,je,f,m);return;case"select":xe=w=S=ce=null;for(f in o)if(q=o[f],o.hasOwnProperty(f)&&q!=null)switch(f){case"value":break;case"multiple":xe=q;default:c.hasOwnProperty(f)||Xs(s,a,f,null,c,q)}for(m in c)if(f=c[m],q=o[m],c.hasOwnProperty(m)&&(f!=null||q!=null))switch(m){case"value":ce=f;break;case"defaultValue":S=f;break;case"multiple":w=f;default:f!==q&&Xs(s,a,m,f,c,q)}a=S,o=w,c=xe,ce!=null?ct(s,!!o,ce,!1):!!c!=!!o&&(a!=null?ct(s,!!o,a,!0):ct(s,!!o,o?[]:"",!1));return;case"textarea":xe=ce=null;for(S in o)if(m=o[S],o.hasOwnProperty(S)&&m!=null&&!c.hasOwnProperty(S))switch(S){case"value":break;case"children":break;default:Xs(s,a,S,null,c,m)}for(w in c)if(m=c[w],f=o[w],c.hasOwnProperty(w)&&(m!=null||f!=null))switch(w){case"value":ce=m;break;case"defaultValue":xe=m;break;case"children":break;case"dangerouslySetInnerHTML":if(m!=null)throw Error(i(91));break;default:m!==f&&Xs(s,a,w,m,c,f)}Ht(s,ce,xe);return;case"option":for(var gt in o)ce=o[gt],o.hasOwnProperty(gt)&&ce!=null&&!c.hasOwnProperty(gt)&&(gt==="selected"?s.selected=!1:Xs(s,a,gt,null,c,ce));for(q in c)ce=c[q],xe=o[q],c.hasOwnProperty(q)&&ce!==xe&&(ce!=null||xe!=null)&&(q==="selected"?s.selected=ce&&typeof ce!="function"&&typeof ce!="symbol":Xs(s,a,q,ce,c,xe));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Ot in o)ce=o[Ot],o.hasOwnProperty(Ot)&&ce!=null&&!c.hasOwnProperty(Ot)&&Xs(s,a,Ot,null,c,ce);for(le in c)if(ce=c[le],xe=o[le],c.hasOwnProperty(le)&&ce!==xe&&(ce!=null||xe!=null))switch(le){case"children":case"dangerouslySetInnerHTML":if(ce!=null)throw Error(i(137,a));break;default:Xs(s,a,le,ce,c,xe)}return;default:if(Us(a)){for(var Js in o)ce=o[Js],o.hasOwnProperty(Js)&&ce!==void 0&&!c.hasOwnProperty(Js)&&Zf(s,a,Js,void 0,c,ce);for(je in c)ce=c[je],xe=o[je],!c.hasOwnProperty(je)||ce===xe||ce===void 0&&xe===void 0||Zf(s,a,je,ce,c,xe);return}}for(var ee in o)ce=o[ee],o.hasOwnProperty(ee)&&ce!=null&&!c.hasOwnProperty(ee)&&Xs(s,a,ee,null,c,ce);for(De in c)ce=c[De],xe=o[De],!c.hasOwnProperty(De)||ce===xe||ce==null&&xe==null||Xs(s,a,De,ce,c,xe)}function Hv(s){switch(s){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function Gj(){if(typeof performance.getEntriesByType=="function"){for(var s=0,a=0,o=performance.getEntriesByType("resource"),c=0;c<o.length;c++){var m=o[c],f=m.transferSize,w=m.initiatorType,S=m.duration;if(f&&S&&Hv(w)){for(w=0,S=m.responseEnd,c+=1;c<o.length;c++){var q=o[c],le=q.startTime;if(le>S)break;var je=q.transferSize,De=q.initiatorType;je&&Hv(De)&&(q=q.responseEnd,w+=je*(q<S?1:(S-le)/(q-le)))}if(--c,a+=8*(f+w)/(m.duration/1e3),s++,10<s)break}}if(0<s)return a/s/1e6}return navigator.connection&&(s=navigator.connection.downlink,typeof s=="number")?s:5}var ep=null,tp=null;function Ud(s){return s.nodeType===9?s:s.ownerDocument}function $v(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Wv(s,a){if(s===0)switch(a){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&a==="foreignObject"?0:s}function sp(s,a){return s==="textarea"||s==="noscript"||typeof a.children=="string"||typeof a.children=="number"||typeof a.children=="bigint"||typeof a.dangerouslySetInnerHTML=="object"&&a.dangerouslySetInnerHTML!==null&&a.dangerouslySetInnerHTML.__html!=null}var np=null;function Kj(){var s=window.event;return s&&s.type==="popstate"?s===np?!1:(np=s,!0):(np=null,!1)}var Gv=typeof setTimeout=="function"?setTimeout:void 0,Yj=typeof clearTimeout=="function"?clearTimeout:void 0,Kv=typeof Promise=="function"?Promise:void 0,Qj=typeof queueMicrotask=="function"?queueMicrotask:typeof Kv<"u"?function(s){return Kv.resolve(null).then(s).catch(Xj)}:Gv;function Xj(s){setTimeout(function(){throw s})}function zi(s){return s==="head"}function Yv(s,a){var o=a,c=0;do{var m=o.nextSibling;if(s.removeChild(o),m&&m.nodeType===8)if(o=m.data,o==="/$"||o==="/&"){if(c===0){s.removeChild(m),Dl(a);return}c--}else if(o==="$"||o==="$?"||o==="$~"||o==="$!"||o==="&")c++;else if(o==="html")Fc(s.ownerDocument.documentElement);else if(o==="head"){o=s.ownerDocument.head,Fc(o);for(var f=o.firstChild;f;){var w=f.nextSibling,S=f.nodeName;f[yn]||S==="SCRIPT"||S==="STYLE"||S==="LINK"&&f.rel.toLowerCase()==="stylesheet"||o.removeChild(f),f=w}}else o==="body"&&Fc(s.ownerDocument.body);o=m}while(o);Dl(a)}function Qv(s,a){var o=s;s=0;do{var c=o.nextSibling;if(o.nodeType===1?a?(o._stashedDisplay=o.style.display,o.style.display="none"):(o.style.display=o._stashedDisplay||"",o.getAttribute("style")===""&&o.removeAttribute("style")):o.nodeType===3&&(a?(o._stashedText=o.nodeValue,o.nodeValue=""):o.nodeValue=o._stashedText||""),c&&c.nodeType===8)if(o=c.data,o==="/$"){if(s===0)break;s--}else o!=="$"&&o!=="$?"&&o!=="$~"&&o!=="$!"||s++;o=c}while(o)}function rp(s){var a=s.firstChild;for(a&&a.nodeType===10&&(a=a.nextSibling);a;){var o=a;switch(a=a.nextSibling,o.nodeName){case"HTML":case"HEAD":case"BODY":rp(o),Rn(o);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(o.rel.toLowerCase()==="stylesheet")continue}s.removeChild(o)}}function Jj(s,a,o,c){for(;s.nodeType===1;){var m=o;if(s.nodeName.toLowerCase()!==a.toLowerCase()){if(!c&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(c){if(!s[yn])switch(a){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(f=s.getAttribute("rel"),f==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(f!==m.rel||s.getAttribute("href")!==(m.href==null||m.href===""?null:m.href)||s.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin)||s.getAttribute("title")!==(m.title==null?null:m.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(f=s.getAttribute("src"),(f!==(m.src==null?null:m.src)||s.getAttribute("type")!==(m.type==null?null:m.type)||s.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin))&&f&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(a==="input"&&s.type==="hidden"){var f=m.name==null?null:""+m.name;if(m.type==="hidden"&&s.getAttribute("name")===f)return s}else return s;if(s=oa(s.nextSibling),s===null)break}return null}function Zj(s,a,o){if(a==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!o||(s=oa(s.nextSibling),s===null))return null;return s}function Xv(s,a){for(;s.nodeType!==8;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!a||(s=oa(s.nextSibling),s===null))return null;return s}function ap(s){return s.data==="$?"||s.data==="$~"}function ip(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState!=="loading"}function eT(s,a){var o=s.ownerDocument;if(s.data==="$~")s._reactRetry=a;else if(s.data!=="$?"||o.readyState!=="loading")a();else{var c=function(){a(),o.removeEventListener("DOMContentLoaded",c)};o.addEventListener("DOMContentLoaded",c),s._reactRetry=c}}function oa(s){for(;s!=null;s=s.nextSibling){var a=s.nodeType;if(a===1||a===3)break;if(a===8){if(a=s.data,a==="$"||a==="$!"||a==="$?"||a==="$~"||a==="&"||a==="F!"||a==="F")break;if(a==="/$"||a==="/&")return null}}return s}var op=null;function Jv(s){s=s.nextSibling;for(var a=0;s;){if(s.nodeType===8){var o=s.data;if(o==="/$"||o==="/&"){if(a===0)return oa(s.nextSibling);a--}else o!=="$"&&o!=="$!"&&o!=="$?"&&o!=="$~"&&o!=="&"||a++}s=s.nextSibling}return null}function Zv(s){s=s.previousSibling;for(var a=0;s;){if(s.nodeType===8){var o=s.data;if(o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"){if(a===0)return s;a--}else o!=="/$"&&o!=="/&"||a++}s=s.previousSibling}return null}function e1(s,a,o){switch(a=Ud(o),s){case"html":if(s=a.documentElement,!s)throw Error(i(452));return s;case"head":if(s=a.head,!s)throw Error(i(453));return s;case"body":if(s=a.body,!s)throw Error(i(454));return s;default:throw Error(i(451))}}function Fc(s){for(var a=s.attributes;a.length;)s.removeAttributeNode(a[0]);Rn(s)}var la=new Map,t1=new Set;function Fd(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var di=ue.d;ue.d={f:tT,r:sT,D:nT,C:rT,L:aT,m:iT,X:lT,S:oT,M:cT};function tT(){var s=di.f(),a=Md();return s||a}function sT(s){var a=rn(s);a!==null&&a.tag===5&&a.type==="form"?b0(a):di.r(s)}var Al=typeof document>"u"?null:document;function s1(s,a,o){var c=Al;if(c&&typeof a=="string"&&a){var m=ve(a);m='link[rel="'+s+'"][href="'+m+'"]',typeof o=="string"&&(m+='[crossorigin="'+o+'"]'),t1.has(m)||(t1.add(m),s={rel:s,crossOrigin:o,href:a},c.querySelector(m)===null&&(a=c.createElement("link"),rr(a,"link",s),C(a),c.head.appendChild(a)))}}function nT(s){di.D(s),s1("dns-prefetch",s,null)}function rT(s,a){di.C(s,a),s1("preconnect",s,a)}function aT(s,a,o){di.L(s,a,o);var c=Al;if(c&&s&&a){var m='link[rel="preload"][as="'+ve(a)+'"]';a==="image"&&o&&o.imageSrcSet?(m+='[imagesrcset="'+ve(o.imageSrcSet)+'"]',typeof o.imageSizes=="string"&&(m+='[imagesizes="'+ve(o.imageSizes)+'"]')):m+='[href="'+ve(s)+'"]';var f=m;switch(a){case"style":f=Ml(s);break;case"script":f=Il(s)}la.has(f)||(s=k({rel:"preload",href:a==="image"&&o&&o.imageSrcSet?void 0:s,as:a},o),la.set(f,s),c.querySelector(m)!==null||a==="style"&&c.querySelector(zc(f))||a==="script"&&c.querySelector(qc(f))||(a=c.createElement("link"),rr(a,"link",s),C(a),c.head.appendChild(a)))}}function iT(s,a){di.m(s,a);var o=Al;if(o&&s){var c=a&&typeof a.as=="string"?a.as:"script",m='link[rel="modulepreload"][as="'+ve(c)+'"][href="'+ve(s)+'"]',f=m;switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":f=Il(s)}if(!la.has(f)&&(s=k({rel:"modulepreload",href:s},a),la.set(f,s),o.querySelector(m)===null)){switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(o.querySelector(qc(f)))return}c=o.createElement("link"),rr(c,"link",s),C(c),o.head.appendChild(c)}}}function oT(s,a,o){di.S(s,a,o);var c=Al;if(c&&s){var m=j(c).hoistableStyles,f=Ml(s);a=a||"default";var w=m.get(f);if(!w){var S={loading:0,preload:null};if(w=c.querySelector(zc(f)))S.loading=5;else{s=k({rel:"stylesheet",href:s,"data-precedence":a},o),(o=la.get(f))&&lp(s,o);var q=w=c.createElement("link");C(q),rr(q,"link",s),q._p=new Promise(function(le,je){q.onload=le,q.onerror=je}),q.addEventListener("load",function(){S.loading|=1}),q.addEventListener("error",function(){S.loading|=2}),S.loading|=4,zd(w,a,c)}w={type:"stylesheet",instance:w,count:1,state:S},m.set(f,w)}}}function lT(s,a){di.X(s,a);var o=Al;if(o&&s){var c=j(o).hoistableScripts,m=Il(s),f=c.get(m);f||(f=o.querySelector(qc(m)),f||(s=k({src:s,async:!0},a),(a=la.get(m))&&cp(s,a),f=o.createElement("script"),C(f),rr(f,"link",s),o.head.appendChild(f)),f={type:"script",instance:f,count:1,state:null},c.set(m,f))}}function cT(s,a){di.M(s,a);var o=Al;if(o&&s){var c=j(o).hoistableScripts,m=Il(s),f=c.get(m);f||(f=o.querySelector(qc(m)),f||(s=k({src:s,async:!0,type:"module"},a),(a=la.get(m))&&cp(s,a),f=o.createElement("script"),C(f),rr(f,"link",s),o.head.appendChild(f)),f={type:"script",instance:f,count:1,state:null},c.set(m,f))}}function n1(s,a,o,c){var m=(m=Me.current)?Fd(m):null;if(!m)throw Error(i(446));switch(s){case"meta":case"title":return null;case"style":return typeof o.precedence=="string"&&typeof o.href=="string"?(a=Ml(o.href),o=j(m).hoistableStyles,c=o.get(a),c||(c={type:"style",instance:null,count:0,state:null},o.set(a,c)),c):{type:"void",instance:null,count:0,state:null};case"link":if(o.rel==="stylesheet"&&typeof o.href=="string"&&typeof o.precedence=="string"){s=Ml(o.href);var f=j(m).hoistableStyles,w=f.get(s);if(w||(m=m.ownerDocument||m,w={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},f.set(s,w),(f=m.querySelector(zc(s)))&&!f._p&&(w.instance=f,w.state.loading=5),la.has(s)||(o={rel:"preload",as:"style",href:o.href,crossOrigin:o.crossOrigin,integrity:o.integrity,media:o.media,hrefLang:o.hrefLang,referrerPolicy:o.referrerPolicy},la.set(s,o),f||uT(m,s,o,w.state))),a&&c===null)throw Error(i(528,""));return w}if(a&&c!==null)throw Error(i(529,""));return null;case"script":return a=o.async,o=o.src,typeof o=="string"&&a&&typeof a!="function"&&typeof a!="symbol"?(a=Il(o),o=j(m).hoistableScripts,c=o.get(a),c||(c={type:"script",instance:null,count:0,state:null},o.set(a,c)),c):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,s))}}function Ml(s){return'href="'+ve(s)+'"'}function zc(s){return'link[rel="stylesheet"]['+s+"]"}function r1(s){return k({},s,{"data-precedence":s.precedence,precedence:null})}function uT(s,a,o,c){s.querySelector('link[rel="preload"][as="style"]['+a+"]")?c.loading=1:(a=s.createElement("link"),c.preload=a,a.addEventListener("load",function(){return c.loading|=1}),a.addEventListener("error",function(){return c.loading|=2}),rr(a,"link",o),C(a),s.head.appendChild(a))}function Il(s){return'[src="'+ve(s)+'"]'}function qc(s){return"script[async]"+s}function a1(s,a,o){if(a.count++,a.instance===null)switch(a.type){case"style":var c=s.querySelector('style[data-href~="'+ve(o.href)+'"]');if(c)return a.instance=c,C(c),c;var m=k({},o,{"data-href":o.href,"data-precedence":o.precedence,href:null,precedence:null});return c=(s.ownerDocument||s).createElement("style"),C(c),rr(c,"style",m),zd(c,o.precedence,s),a.instance=c;case"stylesheet":m=Ml(o.href);var f=s.querySelector(zc(m));if(f)return a.state.loading|=4,a.instance=f,C(f),f;c=r1(o),(m=la.get(m))&&lp(c,m),f=(s.ownerDocument||s).createElement("link"),C(f);var w=f;return w._p=new Promise(function(S,q){w.onload=S,w.onerror=q}),rr(f,"link",c),a.state.loading|=4,zd(f,o.precedence,s),a.instance=f;case"script":return f=Il(o.src),(m=s.querySelector(qc(f)))?(a.instance=m,C(m),m):(c=o,(m=la.get(f))&&(c=k({},o),cp(c,m)),s=s.ownerDocument||s,m=s.createElement("script"),C(m),rr(m,"link",c),s.head.appendChild(m),a.instance=m);case"void":return null;default:throw Error(i(443,a.type))}else a.type==="stylesheet"&&(a.state.loading&4)===0&&(c=a.instance,a.state.loading|=4,zd(c,o.precedence,s));return a.instance}function zd(s,a,o){for(var c=o.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),m=c.length?c[c.length-1]:null,f=m,w=0;w<c.length;w++){var S=c[w];if(S.dataset.precedence===a)f=S;else if(f!==m)break}f?f.parentNode.insertBefore(s,f.nextSibling):(a=o.nodeType===9?o.head:o,a.insertBefore(s,a.firstChild))}function lp(s,a){s.crossOrigin==null&&(s.crossOrigin=a.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=a.referrerPolicy),s.title==null&&(s.title=a.title)}function cp(s,a){s.crossOrigin==null&&(s.crossOrigin=a.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=a.referrerPolicy),s.integrity==null&&(s.integrity=a.integrity)}var qd=null;function i1(s,a,o){if(qd===null){var c=new Map,m=qd=new Map;m.set(o,c)}else m=qd,c=m.get(o),c||(c=new Map,m.set(o,c));if(c.has(s))return c;for(c.set(s,null),o=o.getElementsByTagName(s),m=0;m<o.length;m++){var f=o[m];if(!(f[yn]||f[dt]||s==="link"&&f.getAttribute("rel")==="stylesheet")&&f.namespaceURI!=="http://www.w3.org/2000/svg"){var w=f.getAttribute(a)||"";w=s+w;var S=c.get(w);S?S.push(f):c.set(w,[f])}}return c}function o1(s,a,o){s=s.ownerDocument||s,s.head.insertBefore(o,a==="title"?s.querySelector("head > title"):null)}function dT(s,a,o){if(o===1||a.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof a.precedence!="string"||typeof a.href!="string"||a.href==="")break;return!0;case"link":if(typeof a.rel!="string"||typeof a.href!="string"||a.href===""||a.onLoad||a.onError)break;return a.rel==="stylesheet"?(s=a.disabled,typeof a.precedence=="string"&&s==null):!0;case"script":if(a.async&&typeof a.async!="function"&&typeof a.async!="symbol"&&!a.onLoad&&!a.onError&&a.src&&typeof a.src=="string")return!0}return!1}function l1(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}function hT(s,a,o,c){if(o.type==="stylesheet"&&(typeof c.media!="string"||matchMedia(c.media).matches!==!1)&&(o.state.loading&4)===0){if(o.instance===null){var m=Ml(c.href),f=a.querySelector(zc(m));if(f){a=f._p,a!==null&&typeof a=="object"&&typeof a.then=="function"&&(s.count++,s=Hd.bind(s),a.then(s,s)),o.state.loading|=4,o.instance=f,C(f);return}f=a.ownerDocument||a,c=r1(c),(m=la.get(m))&&lp(c,m),f=f.createElement("link"),C(f);var w=f;w._p=new Promise(function(S,q){w.onload=S,w.onerror=q}),rr(f,"link",c),o.instance=f}s.stylesheets===null&&(s.stylesheets=new Map),s.stylesheets.set(o,a),(a=o.state.preload)&&(o.state.loading&3)===0&&(s.count++,o=Hd.bind(s),a.addEventListener("load",o),a.addEventListener("error",o))}}var up=0;function mT(s,a){return s.stylesheets&&s.count===0&&Wd(s,s.stylesheets),0<s.count||0<s.imgCount?function(o){var c=setTimeout(function(){if(s.stylesheets&&Wd(s,s.stylesheets),s.unsuspend){var f=s.unsuspend;s.unsuspend=null,f()}},6e4+a);0<s.imgBytes&&up===0&&(up=62500*Gj());var m=setTimeout(function(){if(s.waitingForImages=!1,s.count===0&&(s.stylesheets&&Wd(s,s.stylesheets),s.unsuspend)){var f=s.unsuspend;s.unsuspend=null,f()}},(s.imgBytes>up?50:800)+a);return s.unsuspend=o,function(){s.unsuspend=null,clearTimeout(c),clearTimeout(m)}}:null}function Hd(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Wd(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var $d=null;function Wd(s,a){s.stylesheets=null,s.unsuspend!==null&&(s.count++,$d=new Map,a.forEach(fT,s),$d=null,Hd.call(s))}function fT(s,a){if(!(a.state.loading&4)){var o=$d.get(s);if(o)var c=o.get(null);else{o=new Map,$d.set(s,o);for(var m=s.querySelectorAll("link[data-precedence],style[data-precedence]"),f=0;f<m.length;f++){var w=m[f];(w.nodeName==="LINK"||w.getAttribute("media")!=="not all")&&(o.set(w.dataset.precedence,w),c=w)}c&&o.set(null,c)}m=a.instance,w=m.getAttribute("data-precedence"),f=o.get(w)||c,f===c&&o.set(null,m),o.set(w,m),this.count++,c=Hd.bind(this),m.addEventListener("load",c),m.addEventListener("error",c),f?f.parentNode.insertBefore(m,f.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(m,s.firstChild)),a.state.loading|=4}}var Hc={$$typeof:ie,Provider:null,Consumer:null,_currentValue:Re,_currentValue2:Re,_threadCount:0};function pT(s,a,o,c,m,f,w,S,q){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=pt(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=pt(0),this.hiddenUpdates=pt(null),this.identifierPrefix=c,this.onUncaughtError=m,this.onCaughtError=f,this.onRecoverableError=w,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=q,this.incompleteTransitions=new Map}function c1(s,a,o,c,m,f,w,S,q,le,je,De){return s=new pT(s,a,o,w,q,le,je,De,S),a=1,f===!0&&(a|=24),f=Hr(3,null,null,a),s.current=f,f.stateNode=s,a=zm(),a.refCount++,s.pooledCache=a,a.refCount++,f.memoizedState={element:c,isDehydrated:o,cache:a},Wm(f),s}function u1(s){return s?(s=ul,s):ul}function d1(s,a,o,c,m,f){m=u1(m),c.context===null?c.context=m:c.pendingContext=m,c=Ai(a),c.payload={element:o},f=f===void 0?null:f,f!==null&&(c.callback=f),o=Mi(s,c,a),o!==null&&(Lr(o,s,a),_c(o,s,a))}function h1(s,a){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var o=s.retryLane;s.retryLane=o!==0&&o<a?o:a}}function dp(s,a){h1(s,a),(s=s.alternate)&&h1(s,a)}function m1(s){if(s.tag===13||s.tag===31){var a=jo(s,67108864);a!==null&&Lr(a,s,67108864),dp(s,67108864)}}function f1(s){if(s.tag===13||s.tag===31){var a=Yr();a=$(a);var o=jo(s,a);o!==null&&Lr(o,s,a),dp(s,a)}}var Gd=!0;function gT(s,a,o,c){var m=W.T;W.T=null;var f=ue.p;try{ue.p=2,hp(s,a,o,c)}finally{ue.p=f,W.T=m}}function yT(s,a,o,c){var m=W.T;W.T=null;var f=ue.p;try{ue.p=8,hp(s,a,o,c)}finally{ue.p=f,W.T=m}}function hp(s,a,o,c){if(Gd){var m=mp(c);if(m===null)Jf(s,a,c,Kd,o),g1(s,c);else if(vT(m,s,a,o,c))c.stopPropagation();else if(g1(s,c),a&4&&-1<bT.indexOf(s)){for(;m!==null;){var f=rn(m);if(f!==null)switch(f.tag){case 3:if(f=f.stateNode,f.current.memoizedState.isDehydrated){var w=Ge(f.pendingLanes);if(w!==0){var S=f;for(S.pendingLanes|=2,S.entangledLanes|=2;w;){var q=1<<31-Ue(w);S.entanglements[1]|=q,w&=~q}Pa(f),(Bs&6)===0&&(Rd=Ut()+500,Bc(0))}}break;case 31:case 13:S=jo(f,2),S!==null&&Lr(S,f,2),Md(),dp(f,2)}if(f=mp(c),f===null&&Jf(s,a,c,Kd,o),f===m)break;m=f}m!==null&&c.stopPropagation()}else Jf(s,a,c,null,o)}}function mp(s){return s=pn(s),fp(s)}var Kd=null;function fp(s){if(Kd=null,s=bn(s),s!==null){var a=u(s);if(a===null)s=null;else{var o=a.tag;if(o===13){if(s=d(a),s!==null)return s;s=null}else if(o===31){if(s=p(a),s!==null)return s;s=null}else if(o===3){if(a.stateNode.current.memoizedState.isDehydrated)return a.tag===3?a.stateNode.containerInfo:null;s=null}else a!==s&&(s=null)}}return Kd=s,null}function p1(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Mt()){case is:return 2;case Ms:return 8;case Kt:case on:return 32;case ds:return 268435456;default:return 32}default:return 32}}var pp=!1,qi=null,Hi=null,$i=null,$c=new Map,Wc=new Map,Wi=[],bT="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function g1(s,a){switch(s){case"focusin":case"focusout":qi=null;break;case"dragenter":case"dragleave":Hi=null;break;case"mouseover":case"mouseout":$i=null;break;case"pointerover":case"pointerout":$c.delete(a.pointerId);break;case"gotpointercapture":case"lostpointercapture":Wc.delete(a.pointerId)}}function Gc(s,a,o,c,m,f){return s===null||s.nativeEvent!==f?(s={blockedOn:a,domEventName:o,eventSystemFlags:c,nativeEvent:f,targetContainers:[m]},a!==null&&(a=rn(a),a!==null&&m1(a)),s):(s.eventSystemFlags|=c,a=s.targetContainers,m!==null&&a.indexOf(m)===-1&&a.push(m),s)}function vT(s,a,o,c,m){switch(a){case"focusin":return qi=Gc(qi,s,a,o,c,m),!0;case"dragenter":return Hi=Gc(Hi,s,a,o,c,m),!0;case"mouseover":return $i=Gc($i,s,a,o,c,m),!0;case"pointerover":var f=m.pointerId;return $c.set(f,Gc($c.get(f)||null,s,a,o,c,m)),!0;case"gotpointercapture":return f=m.pointerId,Wc.set(f,Gc(Wc.get(f)||null,s,a,o,c,m)),!0}return!1}function y1(s){var a=bn(s.target);if(a!==null){var o=u(a);if(o!==null){if(a=o.tag,a===13){if(a=d(o),a!==null){s.blockedOn=a,Ee(s.priority,function(){f1(o)});return}}else if(a===31){if(a=p(o),a!==null){s.blockedOn=a,Ee(s.priority,function(){f1(o)});return}}else if(a===3&&o.stateNode.current.memoizedState.isDehydrated){s.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}s.blockedOn=null}function Yd(s){if(s.blockedOn!==null)return!1;for(var a=s.targetContainers;0<a.length;){var o=mp(s.nativeEvent);if(o===null){o=s.nativeEvent;var c=new o.constructor(o.type,o);ln=c,o.target.dispatchEvent(c),ln=null}else return a=rn(o),a!==null&&m1(a),s.blockedOn=o,!1;a.shift()}return!0}function b1(s,a,o){Yd(s)&&o.delete(a)}function xT(){pp=!1,qi!==null&&Yd(qi)&&(qi=null),Hi!==null&&Yd(Hi)&&(Hi=null),$i!==null&&Yd($i)&&($i=null),$c.forEach(b1),Wc.forEach(b1)}function Qd(s,a){s.blockedOn===a&&(s.blockedOn=null,pp||(pp=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,xT)))}var Xd=null;function v1(s){Xd!==s&&(Xd=s,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){Xd===s&&(Xd=null);for(var a=0;a<s.length;a+=3){var o=s[a],c=s[a+1],m=s[a+2];if(typeof c!="function"){if(fp(c||o)===null)continue;break}var f=rn(o);f!==null&&(s.splice(a,3),a-=3,mf(f,{pending:!0,data:m,method:o.method,action:c},c,m))}}))}function Dl(s){function a(q){return Qd(q,s)}qi!==null&&Qd(qi,s),Hi!==null&&Qd(Hi,s),$i!==null&&Qd($i,s),$c.forEach(a),Wc.forEach(a);for(var o=0;o<Wi.length;o++){var c=Wi[o];c.blockedOn===s&&(c.blockedOn=null)}for(;0<Wi.length&&(o=Wi[0],o.blockedOn===null);)y1(o),o.blockedOn===null&&Wi.shift();if(o=(s.ownerDocument||s).$$reactFormReplay,o!=null)for(c=0;c<o.length;c+=3){var m=o[c],f=o[c+1],w=m[bt]||null;if(typeof f=="function")w||v1(o);else if(w){var S=null;if(f&&f.hasAttribute("formAction")){if(m=f,w=f[bt]||null)S=w.formAction;else if(fp(m)!==null)continue}else S=w.action;typeof S=="function"?o[c+1]=S:(o.splice(c,3),c-=3),v1(o)}}}function x1(){function s(f){f.canIntercept&&f.info==="react-transition"&&f.intercept({handler:function(){return new Promise(function(w){return m=w})},focusReset:"manual",scroll:"manual"})}function a(){m!==null&&(m(),m=null),c||setTimeout(o,20)}function o(){if(!c&&!navigation.transition){var f=navigation.currentEntry;f&&f.url!=null&&navigation.navigate(f.url,{state:f.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var c=!1,m=null;return navigation.addEventListener("navigate",s),navigation.addEventListener("navigatesuccess",a),navigation.addEventListener("navigateerror",a),setTimeout(o,100),function(){c=!0,navigation.removeEventListener("navigate",s),navigation.removeEventListener("navigatesuccess",a),navigation.removeEventListener("navigateerror",a),m!==null&&(m(),m=null)}}}function gp(s){this._internalRoot=s}Jd.prototype.render=gp.prototype.render=function(s){var a=this._internalRoot;if(a===null)throw Error(i(409));var o=a.current,c=Yr();d1(o,c,s,a,null,null)},Jd.prototype.unmount=gp.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var a=s.containerInfo;d1(s.current,2,null,s,null,null),Md(),a[st]=null}};function Jd(s){this._internalRoot=s}Jd.prototype.unstable_scheduleHydration=function(s){if(s){var a=Se();s={blockedOn:null,target:s,priority:a};for(var o=0;o<Wi.length&&a!==0&&a<Wi[o].priority;o++);Wi.splice(o,0,s),o===0&&y1(s)}};var w1=e.version;if(w1!=="19.2.4")throw Error(i(527,w1,"19.2.4"));ue.findDOMNode=function(s){var a=s._reactInternals;if(a===void 0)throw typeof s.render=="function"?Error(i(188)):(s=Object.keys(s).join(","),Error(i(268,s)));return s=y(a),s=s!==null?x(s):null,s=s===null?null:s.stateNode,s};var wT={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:W,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Zd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Zd.isDisabled&&Zd.supportsFiber)try{be=Zd.inject(wT),Te=Zd}catch{}}return Yc.createRoot=function(s,a){if(!l(s))throw Error(i(299));var o=!1,c="",m=N0,f=C0,w=R0;return a!=null&&(a.unstable_strictMode===!0&&(o=!0),a.identifierPrefix!==void 0&&(c=a.identifierPrefix),a.onUncaughtError!==void 0&&(m=a.onUncaughtError),a.onCaughtError!==void 0&&(f=a.onCaughtError),a.onRecoverableError!==void 0&&(w=a.onRecoverableError)),a=c1(s,1,!1,null,null,o,c,null,m,f,w,x1),s[st]=a.current,Xf(s),new gp(a)},Yc.hydrateRoot=function(s,a,o){if(!l(s))throw Error(i(299));var c=!1,m="",f=N0,w=C0,S=R0,q=null;return o!=null&&(o.unstable_strictMode===!0&&(c=!0),o.identifierPrefix!==void 0&&(m=o.identifierPrefix),o.onUncaughtError!==void 0&&(f=o.onUncaughtError),o.onCaughtError!==void 0&&(w=o.onCaughtError),o.onRecoverableError!==void 0&&(S=o.onRecoverableError),o.formState!==void 0&&(q=o.formState)),a=c1(s,1,!0,a,o??null,c,m,q,f,w,S,x1),a.context=u1(null),o=a.current,c=Yr(),c=$(c),m=Ai(c),m.callback=null,Mi(o,m,c),o=c,a.current.lanes=o,Wt(a,o),Pa(a),s[st]=a.current,Xf(s),new Jd(a)},Yc.version="19.2.4",Yc}var A1;function AT(){if(A1)return vp.exports;A1=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),vp.exports=RT(),vp.exports}var MT=AT();const IT="modulepreload",DT=function(n){return"/login/"+n},M1={},Nr=function(e,t,i){let l=Promise.resolve();if(t&&t.length>0){let g=function(y){return Promise.all(y.map(x=>Promise.resolve(x).then(k=>({status:"fulfilled",value:k}),k=>({status:"rejected",reason:k}))))};document.getElementsByTagName("link");const d=document.querySelector("meta[property=csp-nonce]"),p=d?.nonce||d?.getAttribute("nonce");l=g(t.map(y=>{if(y=DT(y),y in M1)return;M1[y]=!0;const x=y.endsWith(".css"),k=x?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${y}"]${k}`))return;const T=document.createElement("link");if(T.rel=x?"stylesheet":IT,x||(T.as="script"),T.crossOrigin="",T.href=y,p&&T.setAttribute("nonce",p),document.head.appendChild(T),x)return new Promise((O,G)=>{T.addEventListener("load",O),T.addEventListener("error",()=>G(new Error(`Unable to preload CSS for ${y}`)))})}))}function u(d){const p=new Event("vite:preloadError",{cancelable:!0});if(p.payload=d,window.dispatchEvent(p),!p.defaultPrevented)throw d}return l.then(d=>{for(const p of d||[])p.status==="rejected"&&u(p.reason);return e().catch(u)})};var I1="popstate";function PT(n={}){function e(i,l){let{pathname:u,search:d,hash:p}=i.location;return ng("",{pathname:u,search:d,hash:p},l.state&&l.state.usr||null,l.state&&l.state.key||"default")}function t(i,l){return typeof l=="string"?l:gu(l)}return OT(e,t,null,n)}function mn(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function da(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function LT(){return Math.random().toString(36).substring(2,10)}function D1(n,e){return{usr:n.state,key:n.key,idx:e}}function ng(n,e,t=null,i){return{pathname:typeof n=="string"?n:n.pathname,search:"",hash:"",...typeof e=="string"?nc(e):e,state:t,key:e&&e.key||i||LT()}}function gu({pathname:n="/",search:e="",hash:t=""}){return e&&e!=="?"&&(n+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(n+=t.charAt(0)==="#"?t:"#"+t),n}function nc(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substring(t),n=n.substring(0,t));let i=n.indexOf("?");i>=0&&(e.search=n.substring(i),n=n.substring(0,i)),n&&(e.pathname=n)}return e}function OT(n,e,t,i={}){let{window:l=document.defaultView,v5Compat:u=!1}=i,d=l.history,p="POP",g=null,y=x();y==null&&(y=0,d.replaceState({...d.state,idx:y},""));function x(){return(d.state||{idx:null}).idx}function k(){p="POP";let V=x(),te=V==null?null:V-y;y=V,g&&g({action:p,location:F.location,delta:te})}function T(V,te){p="PUSH";let Y=ng(F.location,V,te);y=x()+1;let ie=D1(Y,y),he=F.createHref(Y);try{d.pushState(ie,"",he)}catch(Ne){if(Ne instanceof DOMException&&Ne.name==="DataCloneError")throw Ne;l.location.assign(he)}u&&g&&g({action:p,location:F.location,delta:1})}function O(V,te){p="REPLACE";let Y=ng(F.location,V,te);y=x();let ie=D1(Y,y),he=F.createHref(Y);d.replaceState(ie,"",he),u&&g&&g({action:p,location:F.location,delta:0})}function G(V){return BT(V)}let F={get action(){return p},get location(){return n(l,d)},listen(V){if(g)throw new Error("A history only accepts one active listener");return l.addEventListener(I1,k),g=V,()=>{l.removeEventListener(I1,k),g=null}},createHref(V){return e(l,V)},createURL:G,encodeLocation(V){let te=G(V);return{pathname:te.pathname,search:te.search,hash:te.hash}},push:T,replace:O,go(V){return d.go(V)}};return F}function BT(n,e=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),mn(t,"No window.location.(origin|href) available to create URL");let i=typeof n=="string"?n:gu(n);return i=i.replace(/ $/,"%20"),!e&&i.startsWith("//")&&(i=t+i),new URL(i,t)}function P2(n,e,t="/"){return VT(n,e,t,!1)}function VT(n,e,t,i){let l=typeof e=="string"?nc(e):e,u=yi(l.pathname||"/",t);if(u==null)return null;let d=L2(n);UT(d);let p=null;for(let g=0;p==null&&g<d.length;++g){let y=XT(u);p=YT(d[g],y,i)}return p}function L2(n,e=[],t=[],i="",l=!1){let u=(d,p,g=l,y)=>{let x={relativePath:y===void 0?d.path||"":y,caseSensitive:d.caseSensitive===!0,childrenIndex:p,route:d};if(x.relativePath.startsWith("/")){if(!x.relativePath.startsWith(i)&&g)return;mn(x.relativePath.startsWith(i),`Absolute route path "${x.relativePath}" nested under path "${i}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),x.relativePath=x.relativePath.slice(i.length)}let k=fi([i,x.relativePath]),T=t.concat(x);d.children&&d.children.length>0&&(mn(d.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${k}".`),L2(d.children,e,T,k,g)),!(d.path==null&&!d.index)&&e.push({path:k,score:GT(k,d.index),routesMeta:T})};return n.forEach((d,p)=>{if(d.path===""||!d.path?.includes("?"))u(d,p);else for(let g of O2(d.path))u(d,p,!0,g)}),e}function O2(n){let e=n.split("/");if(e.length===0)return[];let[t,...i]=e,l=t.endsWith("?"),u=t.replace(/\?$/,"");if(i.length===0)return l?[u,""]:[u];let d=O2(i.join("/")),p=[];return p.push(...d.map(g=>g===""?u:[u,g].join("/"))),l&&p.push(...d),p.map(g=>n.startsWith("/")&&g===""?"/":g)}function UT(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:KT(e.routesMeta.map(i=>i.childrenIndex),t.routesMeta.map(i=>i.childrenIndex)))}var FT=/^:[\w-]+$/,zT=3,qT=2,HT=1,$T=10,WT=-2,P1=n=>n==="*";function GT(n,e){let t=n.split("/"),i=t.length;return t.some(P1)&&(i+=WT),e&&(i+=qT),t.filter(l=>!P1(l)).reduce((l,u)=>l+(FT.test(u)?zT:u===""?HT:$T),i)}function KT(n,e){return n.length===e.length&&n.slice(0,-1).every((i,l)=>i===e[l])?n[n.length-1]-e[e.length-1]:0}function YT(n,e,t=!1){let{routesMeta:i}=n,l={},u="/",d=[];for(let p=0;p<i.length;++p){let g=i[p],y=p===i.length-1,x=u==="/"?e:e.slice(u.length)||"/",k=Sh({path:g.relativePath,caseSensitive:g.caseSensitive,end:y},x),T=g.route;if(!k&&y&&t&&!i[i.length-1].route.index&&(k=Sh({path:g.relativePath,caseSensitive:g.caseSensitive,end:!1},x)),!k)return null;Object.assign(l,k.params),d.push({params:l,pathname:fi([u,k.pathname]),pathnameBase:tE(fi([u,k.pathnameBase])),route:T}),k.pathnameBase!=="/"&&(u=fi([u,k.pathnameBase]))}return d}function Sh(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,i]=QT(n.path,n.caseSensitive,n.end),l=e.match(t);if(!l)return null;let u=l[0],d=u.replace(/(.)\/+$/,"$1"),p=l.slice(1);return{params:i.reduce((y,{paramName:x,isOptional:k},T)=>{if(x==="*"){let G=p[T]||"";d=u.slice(0,u.length-G.length).replace(/(.)\/+$/,"$1")}const O=p[T];return k&&!O?y[x]=void 0:y[x]=(O||"").replace(/%2F/g,"/"),y},{}),pathname:u,pathnameBase:d,pattern:n}}function QT(n,e=!1,t=!0){da(n==="*"||!n.endsWith("*")||n.endsWith("/*"),`Route path "${n}" will be treated as if it were "${n.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${n.replace(/\*$/,"/*")}".`);let i=[],l="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(d,p,g)=>(i.push({paramName:p,isOptional:g!=null}),g?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return n.endsWith("*")?(i.push({paramName:"*"}),l+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?l+="\\/*$":n!==""&&n!=="/"&&(l+="(?:(?=\\/|$))"),[new RegExp(l,e?void 0:"i"),i]}function XT(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return da(!1,`The URL path "${n}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),n}}function yi(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,i=n.charAt(t);return i&&i!=="/"?null:n.slice(t)||"/"}var JT=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i;function ZT(n,e="/"){let{pathname:t,search:i="",hash:l=""}=typeof n=="string"?nc(n):n,u;return t?(t=t.replace(/\/\/+/g,"/"),t.startsWith("/")?u=L1(t.substring(1),"/"):u=L1(t,e)):u=e,{pathname:u,search:sE(i),hash:nE(l)}}function L1(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(l=>{l===".."?t.length>1&&t.pop():l!=="."&&t.push(l)}),t.length>1?t.join("/"):"/"}function kp(n,e,t,i){return`Cannot include a '${n}' character in a manually specified \`to.${e}\` field [${JSON.stringify(i)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function eE(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function Lg(n){let e=eE(n);return e.map((t,i)=>i===e.length-1?t.pathname:t.pathnameBase)}function Og(n,e,t,i=!1){let l;typeof n=="string"?l=nc(n):(l={...n},mn(!l.pathname||!l.pathname.includes("?"),kp("?","pathname","search",l)),mn(!l.pathname||!l.pathname.includes("#"),kp("#","pathname","hash",l)),mn(!l.search||!l.search.includes("#"),kp("#","search","hash",l)));let u=n===""||l.pathname==="",d=u?"/":l.pathname,p;if(d==null)p=t;else{let k=e.length-1;if(!i&&d.startsWith("..")){let T=d.split("/");for(;T[0]==="..";)T.shift(),k-=1;l.pathname=T.join("/")}p=k>=0?e[k]:"/"}let g=ZT(l,p),y=d&&d!=="/"&&d.endsWith("/"),x=(u||d===".")&&t.endsWith("/");return!g.pathname.endsWith("/")&&(y||x)&&(g.pathname+="/"),g}var fi=n=>n.join("/").replace(/\/\/+/g,"/"),tE=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),sE=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,nE=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n,rE=class{constructor(n,e,t,i=!1){this.status=n,this.statusText=e||"",this.internal=i,t instanceof Error?(this.data=t.toString(),this.error=t):this.data=t}};function aE(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}function iE(n){return n.map(e=>e.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var B2=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function V2(n,e){let t=n;if(typeof t!="string"||!JT.test(t))return{absoluteURL:void 0,isExternal:!1,to:t};let i=t,l=!1;if(B2)try{let u=new URL(window.location.href),d=t.startsWith("//")?new URL(u.protocol+t):new URL(t),p=yi(d.pathname,e);d.origin===u.origin&&p!=null?t=p+d.search+d.hash:l=!0}catch{da(!1,`<Link to="${t}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:i,isExternal:l,to:t}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var U2=["POST","PUT","PATCH","DELETE"];new Set(U2);var oE=["GET",...U2];new Set(oE);var rc=v.createContext(null);rc.displayName="DataRouter";var Xh=v.createContext(null);Xh.displayName="DataRouterState";var lE=v.createContext(!1),F2=v.createContext({isTransitioning:!1});F2.displayName="ViewTransition";var cE=v.createContext(new Map);cE.displayName="Fetchers";var uE=v.createContext(null);uE.displayName="Await";var Jr=v.createContext(null);Jr.displayName="Navigation";var Cu=v.createContext(null);Cu.displayName="Location";var Na=v.createContext({outlet:null,matches:[],isDataRoute:!1});Na.displayName="Route";var Bg=v.createContext(null);Bg.displayName="RouteError";var z2="REACT_ROUTER_ERROR",dE="REDIRECT",hE="ROUTE_ERROR_RESPONSE";function mE(n){if(n.startsWith(`${z2}:${dE}:{`))try{let e=JSON.parse(n.slice(28));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.location=="string"&&typeof e.reloadDocument=="boolean"&&typeof e.replace=="boolean")return e}catch{}}function fE(n){if(n.startsWith(`${z2}:${hE}:{`))try{let e=JSON.parse(n.slice(40));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string")return new rE(e.status,e.statusText,e.data)}catch{}}function pE(n,{relative:e}={}){mn(ac(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:i}=v.useContext(Jr),{hash:l,pathname:u,search:d}=Ru(n,{relative:e}),p=u;return t!=="/"&&(p=u==="/"?t:fi([t,u])),i.createHref({pathname:p,search:d,hash:l})}function ac(){return v.useContext(Cu)!=null}function Ca(){return mn(ac(),"useLocation() may be used only in the context of a <Router> component."),v.useContext(Cu).location}var q2="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function H2(n){v.useContext(Jr).static||v.useLayoutEffect(n)}function lr(){let{isDataRoute:n}=v.useContext(Na);return n?CE():gE()}function gE(){mn(ac(),"useNavigate() may be used only in the context of a <Router> component.");let n=v.useContext(rc),{basename:e,navigator:t}=v.useContext(Jr),{matches:i}=v.useContext(Na),{pathname:l}=Ca(),u=JSON.stringify(Lg(i)),d=v.useRef(!1);return H2(()=>{d.current=!0}),v.useCallback((g,y={})=>{if(da(d.current,q2),!d.current)return;if(typeof g=="number"){t.go(g);return}let x=Og(g,JSON.parse(u),l,y.relative==="path");n==null&&e!=="/"&&(x.pathname=x.pathname==="/"?e:fi([e,x.pathname])),(y.replace?t.replace:t.push)(x,y.state,y)},[e,t,u,l,n])}v.createContext(null);function yE(){let{matches:n}=v.useContext(Na),e=n[n.length-1];return e?e.params:{}}function Ru(n,{relative:e}={}){let{matches:t}=v.useContext(Na),{pathname:i}=Ca(),l=JSON.stringify(Lg(t));return v.useMemo(()=>Og(n,JSON.parse(l),i,e==="path"),[n,l,i,e])}function bE(n,e){return $2(n,e)}function $2(n,e,t,i,l){mn(ac(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:u}=v.useContext(Jr),{matches:d}=v.useContext(Na),p=d[d.length-1],g=p?p.params:{},y=p?p.pathname:"/",x=p?p.pathnameBase:"/",k=p&&p.route;{let Y=k&&k.path||"";G2(y,!k||Y.endsWith("*")||Y.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${y}" (under <Route path="${Y}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${Y}"> to <Route path="${Y==="/"?"*":`${Y}/*`}">.`)}let T=Ca(),O;if(e){let Y=typeof e=="string"?nc(e):e;mn(x==="/"||Y.pathname?.startsWith(x),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${x}" but pathname "${Y.pathname}" was given in the \`location\` prop.`),O=Y}else O=T;let G=O.pathname||"/",F=G;if(x!=="/"){let Y=x.replace(/^\//,"").split("/");F="/"+G.replace(/^\//,"").split("/").slice(Y.length).join("/")}let V=P2(n,{pathname:F});da(k||V!=null,`No routes matched location "${O.pathname}${O.search}${O.hash}" `),da(V==null||V[V.length-1].route.element!==void 0||V[V.length-1].route.Component!==void 0||V[V.length-1].route.lazy!==void 0,`Matched leaf route at location "${O.pathname}${O.search}${O.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let te=kE(V&&V.map(Y=>Object.assign({},Y,{params:Object.assign({},g,Y.params),pathname:fi([x,u.encodeLocation?u.encodeLocation(Y.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:Y.pathname]),pathnameBase:Y.pathnameBase==="/"?x:fi([x,u.encodeLocation?u.encodeLocation(Y.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:Y.pathnameBase])})),d,t,i,l);return e&&te?v.createElement(Cu.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...O},navigationType:"POP"}},te):te}function vE(){let n=NE(),e=aE(n)?`${n.status} ${n.statusText}`:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,i="rgba(200,200,200, 0.5)",l={padding:"0.5rem",backgroundColor:i},u={padding:"2px 4px",backgroundColor:i},d=null;return console.error("Error handled by React Router default ErrorBoundary:",n),d=v.createElement(v.Fragment,null,v.createElement("p",null," Hey developer "),v.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",v.createElement("code",{style:u},"ErrorBoundary")," or"," ",v.createElement("code",{style:u},"errorElement")," prop on your route.")),v.createElement(v.Fragment,null,v.createElement("h2",null,"Unexpected Application Error!"),v.createElement("h3",{style:{fontStyle:"italic"}},e),t?v.createElement("pre",{style:l},t):null,d)}var xE=v.createElement(vE,null),W2=class extends v.Component{constructor(n){super(n),this.state={location:n.location,revalidation:n.revalidation,error:n.error}}static getDerivedStateFromError(n){return{error:n}}static getDerivedStateFromProps(n,e){return e.location!==n.location||e.revalidation!=="idle"&&n.revalidation==="idle"?{error:n.error,location:n.location,revalidation:n.revalidation}:{error:n.error!==void 0?n.error:e.error,location:e.location,revalidation:n.revalidation||e.revalidation}}componentDidCatch(n,e){this.props.onError?this.props.onError(n,e):console.error("React Router caught the following error during render",n)}render(){let n=this.state.error;if(this.context&&typeof n=="object"&&n&&"digest"in n&&typeof n.digest=="string"){const t=fE(n.digest);t&&(n=t)}let e=n!==void 0?v.createElement(Na.Provider,{value:this.props.routeContext},v.createElement(Bg.Provider,{value:n,children:this.props.component})):this.props.children;return this.context?v.createElement(wE,{error:n},e):e}};W2.contextType=lE;var jp=new WeakMap;function wE({children:n,error:e}){let{basename:t}=v.useContext(Jr);if(typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){let i=mE(e.digest);if(i){let l=jp.get(e);if(l)throw l;let u=V2(i.location,t);if(B2&&!jp.get(e))if(u.isExternal||i.reloadDocument)window.location.href=u.absoluteURL||u.to;else{const d=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(u.to,{replace:i.replace}));throw jp.set(e,d),d}return v.createElement("meta",{httpEquiv:"refresh",content:`0;url=${u.absoluteURL||u.to}`})}}return n}function _E({routeContext:n,match:e,children:t}){let i=v.useContext(rc);return i&&i.static&&i.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=e.route.id),v.createElement(Na.Provider,{value:n},t)}function kE(n,e=[],t=null,i=null,l=null){if(n==null){if(!t)return null;if(t.errors)n=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let u=n,d=t?.errors;if(d!=null){let x=u.findIndex(k=>k.route.id&&d?.[k.route.id]!==void 0);mn(x>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(d).join(",")}`),u=u.slice(0,Math.min(u.length,x+1))}let p=!1,g=-1;if(t)for(let x=0;x<u.length;x++){let k=u[x];if((k.route.HydrateFallback||k.route.hydrateFallbackElement)&&(g=x),k.route.id){let{loaderData:T,errors:O}=t,G=k.route.loader&&!T.hasOwnProperty(k.route.id)&&(!O||O[k.route.id]===void 0);if(k.route.lazy||G){p=!0,g>=0?u=u.slice(0,g+1):u=[u[0]];break}}}let y=t&&i?(x,k)=>{i(x,{location:t.location,params:t.matches?.[0]?.params??{},unstable_pattern:iE(t.matches),errorInfo:k})}:void 0;return u.reduceRight((x,k,T)=>{let O,G=!1,F=null,V=null;t&&(O=d&&k.route.id?d[k.route.id]:void 0,F=k.route.errorElement||xE,p&&(g<0&&T===0?(G2("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),G=!0,V=null):g===T&&(G=!0,V=k.route.hydrateFallbackElement||null)));let te=e.concat(u.slice(0,T+1)),Y=()=>{let ie;return O?ie=F:G?ie=V:k.route.Component?ie=v.createElement(k.route.Component,null):k.route.element?ie=k.route.element:ie=x,v.createElement(_E,{match:k,routeContext:{outlet:x,matches:te,isDataRoute:t!=null},children:ie})};return t&&(k.route.ErrorBoundary||k.route.errorElement||T===0)?v.createElement(W2,{location:t.location,revalidation:t.revalidation,component:F,error:O,children:Y(),routeContext:{outlet:null,matches:te,isDataRoute:!0},onError:y}):Y()},null)}function Vg(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function jE(n){let e=v.useContext(rc);return mn(e,Vg(n)),e}function TE(n){let e=v.useContext(Xh);return mn(e,Vg(n)),e}function EE(n){let e=v.useContext(Na);return mn(e,Vg(n)),e}function Ug(n){let e=EE(n),t=e.matches[e.matches.length-1];return mn(t.route.id,`${n} can only be used on routes that contain a unique "id"`),t.route.id}function SE(){return Ug("useRouteId")}function NE(){let n=v.useContext(Bg),e=TE("useRouteError"),t=Ug("useRouteError");return n!==void 0?n:e.errors?.[t]}function CE(){let{router:n}=jE("useNavigate"),e=Ug("useNavigate"),t=v.useRef(!1);return H2(()=>{t.current=!0}),v.useCallback(async(l,u={})=>{da(t.current,q2),t.current&&(typeof l=="number"?await n.navigate(l):await n.navigate(l,{fromRouteId:e,...u}))},[n,e])}var O1={};function G2(n,e,t){!e&&!O1[n]&&(O1[n]=!0,da(!1,t))}v.memo(RE);function RE({routes:n,future:e,state:t,onError:i}){return $2(n,void 0,t,i,e)}function K2({to:n,replace:e,state:t,relative:i}){mn(ac(),"<Navigate> may be used only in the context of a <Router> component.");let{static:l}=v.useContext(Jr);da(!l,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:u}=v.useContext(Na),{pathname:d}=Ca(),p=lr(),g=Og(n,Lg(u),d,i==="path"),y=JSON.stringify(g);return v.useEffect(()=>{p(JSON.parse(y),{replace:e,state:t,relative:i})},[p,y,i,e,t]),null}function nn(n){mn(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function AE({basename:n="/",children:e=null,location:t,navigationType:i="POP",navigator:l,static:u=!1,unstable_useTransitions:d}){mn(!ac(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let p=n.replace(/^\/*/,"/"),g=v.useMemo(()=>({basename:p,navigator:l,static:u,unstable_useTransitions:d,future:{}}),[p,l,u,d]);typeof t=="string"&&(t=nc(t));let{pathname:y="/",search:x="",hash:k="",state:T=null,key:O="default"}=t,G=v.useMemo(()=>{let F=yi(y,p);return F==null?null:{location:{pathname:F,search:x,hash:k,state:T,key:O},navigationType:i}},[p,y,x,k,T,O,i]);return da(G!=null,`<Router basename="${p}"> is not able to match the URL "${y}${x}${k}" because it does not start with the basename, so the <Router> won't render anything.`),G==null?null:v.createElement(Jr.Provider,{value:g},v.createElement(Cu.Provider,{children:e,value:G}))}function ME({children:n,location:e}){return bE(rg(n),e)}function rg(n,e=[]){let t=[];return v.Children.forEach(n,(i,l)=>{if(!v.isValidElement(i))return;let u=[...e,l];if(i.type===v.Fragment){t.push.apply(t,rg(i.props.children,u));return}mn(i.type===nn,`[${typeof i.type=="string"?i.type:i.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),mn(!i.props.index||!i.props.children,"An index route cannot have child routes.");let d={id:i.props.id||u.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,middleware:i.props.middleware,loader:i.props.loader,action:i.props.action,hydrateFallbackElement:i.props.hydrateFallbackElement,HydrateFallback:i.props.HydrateFallback,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.hasErrorBoundary===!0||i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(d.children=rg(i.props.children,u)),t.push(d)}),t}var ph="get",gh="application/x-www-form-urlencoded";function Jh(n){return typeof HTMLElement<"u"&&n instanceof HTMLElement}function IE(n){return Jh(n)&&n.tagName.toLowerCase()==="button"}function DE(n){return Jh(n)&&n.tagName.toLowerCase()==="form"}function PE(n){return Jh(n)&&n.tagName.toLowerCase()==="input"}function LE(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function OE(n,e){return n.button===0&&(!e||e==="_self")&&!LE(n)}function ag(n=""){return new URLSearchParams(typeof n=="string"||Array.isArray(n)||n instanceof URLSearchParams?n:Object.keys(n).reduce((e,t)=>{let i=n[t];return e.concat(Array.isArray(i)?i.map(l=>[t,l]):[[t,i]])},[]))}function BE(n,e){let t=ag(n);return e&&e.forEach((i,l)=>{t.has(l)||e.getAll(l).forEach(u=>{t.append(l,u)})}),t}var eh=null;function VE(){if(eh===null)try{new FormData(document.createElement("form"),0),eh=!1}catch{eh=!0}return eh}var UE=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Tp(n){return n!=null&&!UE.has(n)?(da(!1,`"${n}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${gh}"`),null):n}function FE(n,e){let t,i,l,u,d;if(DE(n)){let p=n.getAttribute("action");i=p?yi(p,e):null,t=n.getAttribute("method")||ph,l=Tp(n.getAttribute("enctype"))||gh,u=new FormData(n)}else if(IE(n)||PE(n)&&(n.type==="submit"||n.type==="image")){let p=n.form;if(p==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let g=n.getAttribute("formaction")||p.getAttribute("action");if(i=g?yi(g,e):null,t=n.getAttribute("formmethod")||p.getAttribute("method")||ph,l=Tp(n.getAttribute("formenctype"))||Tp(p.getAttribute("enctype"))||gh,u=new FormData(p,n),!VE()){let{name:y,type:x,value:k}=n;if(x==="image"){let T=y?`${y}.`:"";u.append(`${T}x`,"0"),u.append(`${T}y`,"0")}else y&&u.append(y,k)}}else{if(Jh(n))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=ph,i=null,l=gh,d=n}return u&&l==="text/plain"&&(d=u,u=void 0),{action:i,method:t.toLowerCase(),encType:l,formData:u,body:d}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function Fg(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function zE(n,e,t,i){let l=typeof n=="string"?new URL(n,typeof window>"u"?"server://singlefetch/":window.location.origin):n;return t?l.pathname.endsWith("/")?l.pathname=`${l.pathname}_.${i}`:l.pathname=`${l.pathname}.${i}`:l.pathname==="/"?l.pathname=`_root.${i}`:e&&yi(l.pathname,e)==="/"?l.pathname=`${e.replace(/\/$/,"")}/_root.${i}`:l.pathname=`${l.pathname.replace(/\/$/,"")}.${i}`,l}async function qE(n,e){if(n.id in e)return e[n.id];try{let t=await import(n.module);return e[n.id]=t,t}catch(t){return console.error(`Error loading route module \`${n.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function HE(n){return n==null?!1:n.href==null?n.rel==="preload"&&typeof n.imageSrcSet=="string"&&typeof n.imageSizes=="string":typeof n.rel=="string"&&typeof n.href=="string"}async function $E(n,e,t){let i=await Promise.all(n.map(async l=>{let u=e.routes[l.route.id];if(u){let d=await qE(u,t);return d.links?d.links():[]}return[]}));return YE(i.flat(1).filter(HE).filter(l=>l.rel==="stylesheet"||l.rel==="preload").map(l=>l.rel==="stylesheet"?{...l,rel:"prefetch",as:"style"}:{...l,rel:"prefetch"}))}function B1(n,e,t,i,l,u){let d=(g,y)=>t[y]?g.route.id!==t[y].route.id:!0,p=(g,y)=>t[y].pathname!==g.pathname||t[y].route.path?.endsWith("*")&&t[y].params["*"]!==g.params["*"];return u==="assets"?e.filter((g,y)=>d(g,y)||p(g,y)):u==="data"?e.filter((g,y)=>{let x=i.routes[g.route.id];if(!x||!x.hasLoader)return!1;if(d(g,y)||p(g,y))return!0;if(g.route.shouldRevalidate){let k=g.route.shouldRevalidate({currentUrl:new URL(l.pathname+l.search+l.hash,window.origin),currentParams:t[0]?.params||{},nextUrl:new URL(n,window.origin),nextParams:g.params,defaultShouldRevalidate:!0});if(typeof k=="boolean")return k}return!0}):[]}function WE(n,e,{includeHydrateFallback:t}={}){return GE(n.map(i=>{let l=e.routes[i.route.id];if(!l)return[];let u=[l.module];return l.clientActionModule&&(u=u.concat(l.clientActionModule)),l.clientLoaderModule&&(u=u.concat(l.clientLoaderModule)),t&&l.hydrateFallbackModule&&(u=u.concat(l.hydrateFallbackModule)),l.imports&&(u=u.concat(l.imports)),u}).flat(1))}function GE(n){return[...new Set(n)]}function KE(n){let e={},t=Object.keys(n).sort();for(let i of t)e[i]=n[i];return e}function YE(n,e){let t=new Set;return new Set(e),n.reduce((i,l)=>{let u=JSON.stringify(KE(l));return t.has(u)||(t.add(u),i.push({key:u,link:l})),i},[])}function Y2(){let n=v.useContext(rc);return Fg(n,"You must render this element inside a <DataRouterContext.Provider> element"),n}function QE(){let n=v.useContext(Xh);return Fg(n,"You must render this element inside a <DataRouterStateContext.Provider> element"),n}var zg=v.createContext(void 0);zg.displayName="FrameworkContext";function Q2(){let n=v.useContext(zg);return Fg(n,"You must render this element inside a <HydratedRouter> element"),n}function XE(n,e){let t=v.useContext(zg),[i,l]=v.useState(!1),[u,d]=v.useState(!1),{onFocus:p,onBlur:g,onMouseEnter:y,onMouseLeave:x,onTouchStart:k}=e,T=v.useRef(null);v.useEffect(()=>{if(n==="render"&&d(!0),n==="viewport"){let F=te=>{te.forEach(Y=>{d(Y.isIntersecting)})},V=new IntersectionObserver(F,{threshold:.5});return T.current&&V.observe(T.current),()=>{V.disconnect()}}},[n]),v.useEffect(()=>{if(i){let F=setTimeout(()=>{d(!0)},100);return()=>{clearTimeout(F)}}},[i]);let O=()=>{l(!0)},G=()=>{l(!1),d(!1)};return t?n!=="intent"?[u,T,{}]:[u,T,{onFocus:Qc(p,O),onBlur:Qc(g,G),onMouseEnter:Qc(y,O),onMouseLeave:Qc(x,G),onTouchStart:Qc(k,O)}]:[!1,T,{}]}function Qc(n,e){return t=>{n&&n(t),t.defaultPrevented||e(t)}}function JE({page:n,...e}){let{router:t}=Y2(),i=v.useMemo(()=>P2(t.routes,n,t.basename),[t.routes,n,t.basename]);return i?v.createElement(eS,{page:n,matches:i,...e}):null}function ZE(n){let{manifest:e,routeModules:t}=Q2(),[i,l]=v.useState([]);return v.useEffect(()=>{let u=!1;return $E(n,e,t).then(d=>{u||l(d)}),()=>{u=!0}},[n,e,t]),i}function eS({page:n,matches:e,...t}){let i=Ca(),{future:l,manifest:u,routeModules:d}=Q2(),{basename:p}=Y2(),{loaderData:g,matches:y}=QE(),x=v.useMemo(()=>B1(n,e,y,u,i,"data"),[n,e,y,u,i]),k=v.useMemo(()=>B1(n,e,y,u,i,"assets"),[n,e,y,u,i]),T=v.useMemo(()=>{if(n===i.pathname+i.search+i.hash)return[];let F=new Set,V=!1;if(e.forEach(Y=>{let ie=u.routes[Y.route.id];!ie||!ie.hasLoader||(!x.some(he=>he.route.id===Y.route.id)&&Y.route.id in g&&d[Y.route.id]?.shouldRevalidate||ie.hasClientLoader?V=!0:F.add(Y.route.id))}),F.size===0)return[];let te=zE(n,p,l.unstable_trailingSlashAwareDataRequests,"data");return V&&F.size>0&&te.searchParams.set("_routes",e.filter(Y=>F.has(Y.route.id)).map(Y=>Y.route.id).join(",")),[te.pathname+te.search]},[p,l.unstable_trailingSlashAwareDataRequests,g,i,u,x,e,n,d]),O=v.useMemo(()=>WE(k,u),[k,u]),G=ZE(k);return v.createElement(v.Fragment,null,T.map(F=>v.createElement("link",{key:F,rel:"prefetch",as:"fetch",href:F,...t})),O.map(F=>v.createElement("link",{key:F,rel:"modulepreload",href:F,...t})),G.map(({key:F,link:V})=>v.createElement("link",{key:F,nonce:t.nonce,...V,crossOrigin:V.crossOrigin??t.crossOrigin})))}function tS(...n){return e=>{n.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var sS=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{sS&&(window.__reactRouterVersion="7.13.0")}catch{}function nS({basename:n,children:e,unstable_useTransitions:t,window:i}){let l=v.useRef();l.current==null&&(l.current=PT({window:i,v5Compat:!0}));let u=l.current,[d,p]=v.useState({action:u.action,location:u.location}),g=v.useCallback(y=>{t===!1?p(y):v.startTransition(()=>p(y))},[t]);return v.useLayoutEffect(()=>u.listen(g),[u,g]),v.createElement(AE,{basename:n,children:e,location:d.location,navigationType:d.action,navigator:u,unstable_useTransitions:t})}var X2=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,J2=v.forwardRef(function({onClick:e,discover:t="render",prefetch:i="none",relative:l,reloadDocument:u,replace:d,state:p,target:g,to:y,preventScrollReset:x,viewTransition:k,unstable_defaultShouldRevalidate:T,...O},G){let{basename:F,unstable_useTransitions:V}=v.useContext(Jr),te=typeof y=="string"&&X2.test(y),Y=V2(y,F);y=Y.to;let ie=pE(y,{relative:l}),[he,Ne,fe]=XE(i,O),R=oS(y,{replace:d,state:p,target:g,preventScrollReset:x,relative:l,viewTransition:k,unstable_defaultShouldRevalidate:T,unstable_useTransitions:V});function E(B){e&&e(B),B.defaultPrevented||R(B)}let M=v.createElement("a",{...O,...fe,href:Y.absoluteURL||ie,onClick:Y.isExternal||u?e:E,ref:tS(G,Ne),target:g,"data-discover":!te&&t==="render"?"true":void 0});return he&&!te?v.createElement(v.Fragment,null,M,v.createElement(JE,{page:ie})):M});J2.displayName="Link";var rS=v.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:i="",end:l=!1,style:u,to:d,viewTransition:p,children:g,...y},x){let k=Ru(d,{relative:y.relative}),T=Ca(),O=v.useContext(Xh),{navigator:G,basename:F}=v.useContext(Jr),V=O!=null&&mS(k)&&p===!0,te=G.encodeLocation?G.encodeLocation(k).pathname:k.pathname,Y=T.pathname,ie=O&&O.navigation&&O.navigation.location?O.navigation.location.pathname:null;t||(Y=Y.toLowerCase(),ie=ie?ie.toLowerCase():null,te=te.toLowerCase()),ie&&F&&(ie=yi(ie,F)||ie);const he=te!=="/"&&te.endsWith("/")?te.length-1:te.length;let Ne=Y===te||!l&&Y.startsWith(te)&&Y.charAt(he)==="/",fe=ie!=null&&(ie===te||!l&&ie.startsWith(te)&&ie.charAt(te.length)==="/"),R={isActive:Ne,isPending:fe,isTransitioning:V},E=Ne?e:void 0,M;typeof i=="function"?M=i(R):M=[i,Ne?"active":null,fe?"pending":null,V?"transitioning":null].filter(Boolean).join(" ");let B=typeof u=="function"?u(R):u;return v.createElement(J2,{...y,"aria-current":E,className:M,ref:x,style:B,to:d,viewTransition:p},typeof g=="function"?g(R):g)});rS.displayName="NavLink";var aS=v.forwardRef(({discover:n="render",fetcherKey:e,navigate:t,reloadDocument:i,replace:l,state:u,method:d=ph,action:p,onSubmit:g,relative:y,preventScrollReset:x,viewTransition:k,unstable_defaultShouldRevalidate:T,...O},G)=>{let{unstable_useTransitions:F}=v.useContext(Jr),V=dS(),te=hS(p,{relative:y}),Y=d.toLowerCase()==="get"?"get":"post",ie=typeof p=="string"&&X2.test(p),he=Ne=>{if(g&&g(Ne),Ne.defaultPrevented)return;Ne.preventDefault();let fe=Ne.nativeEvent.submitter,R=fe?.getAttribute("formmethod")||d,E=()=>V(fe||Ne.currentTarget,{fetcherKey:e,method:R,navigate:t,replace:l,state:u,relative:y,preventScrollReset:x,viewTransition:k,unstable_defaultShouldRevalidate:T});F&&t!==!1?v.startTransition(()=>E()):E()};return v.createElement("form",{ref:G,method:Y,action:te,onSubmit:i?g:he,...O,"data-discover":!ie&&n==="render"?"true":void 0})});aS.displayName="Form";function iS(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Z2(n){let e=v.useContext(rc);return mn(e,iS(n)),e}function oS(n,{target:e,replace:t,state:i,preventScrollReset:l,relative:u,viewTransition:d,unstable_defaultShouldRevalidate:p,unstable_useTransitions:g}={}){let y=lr(),x=Ca(),k=Ru(n,{relative:u});return v.useCallback(T=>{if(OE(T,e)){T.preventDefault();let O=t!==void 0?t:gu(x)===gu(k),G=()=>y(n,{replace:O,state:i,preventScrollReset:l,relative:u,viewTransition:d,unstable_defaultShouldRevalidate:p});g?v.startTransition(()=>G()):G()}},[x,y,k,t,i,e,n,l,u,d,p,g])}function lS(n){da(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let e=v.useRef(ag(n)),t=v.useRef(!1),i=Ca(),l=v.useMemo(()=>BE(i.search,t.current?null:e.current),[i.search]),u=lr(),d=v.useCallback((p,g)=>{const y=ag(typeof p=="function"?p(new URLSearchParams(l)):p);t.current=!0,u("?"+y,g)},[u,l]);return[l,d]}var cS=0,uS=()=>`__${String(++cS)}__`;function dS(){let{router:n}=Z2("useSubmit"),{basename:e}=v.useContext(Jr),t=SE(),i=n.fetch,l=n.navigate;return v.useCallback(async(u,d={})=>{let{action:p,method:g,encType:y,formData:x,body:k}=FE(u,e);if(d.navigate===!1){let T=d.fetcherKey||uS();await i(T,t,d.action||p,{unstable_defaultShouldRevalidate:d.unstable_defaultShouldRevalidate,preventScrollReset:d.preventScrollReset,formData:x,body:k,formMethod:d.method||g,formEncType:d.encType||y,flushSync:d.flushSync})}else await l(d.action||p,{unstable_defaultShouldRevalidate:d.unstable_defaultShouldRevalidate,preventScrollReset:d.preventScrollReset,formData:x,body:k,formMethod:d.method||g,formEncType:d.encType||y,replace:d.replace,state:d.state,fromRouteId:t,flushSync:d.flushSync,viewTransition:d.viewTransition})},[i,l,e,t])}function hS(n,{relative:e}={}){let{basename:t}=v.useContext(Jr),i=v.useContext(Na);mn(i,"useFormAction must be used inside a RouteContext");let[l]=i.matches.slice(-1),u={...Ru(n||".",{relative:e})},d=Ca();if(n==null){u.search=d.search;let p=new URLSearchParams(u.search),g=p.getAll("index");if(g.some(x=>x==="")){p.delete("index"),g.filter(k=>k).forEach(k=>p.append("index",k));let x=p.toString();u.search=x?`?${x}`:""}}return(!n||n===".")&&l.route.index&&(u.search=u.search?u.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(u.pathname=u.pathname==="/"?t:fi([t,u.pathname])),gu(u)}function mS(n,{relative:e}={}){let t=v.useContext(F2);mn(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:i}=Z2("useViewTransitionState"),l=Ru(n,{relative:e});if(!t.isTransitioning)return!1;let u=yi(t.currentLocation.pathname,i)||t.currentLocation.pathname,d=yi(t.nextLocation.pathname,i)||t.nextLocation.pathname;return Sh(l.pathname,d)!=null||Sh(l.pathname,u)!=null}const fS=()=>{};var V1={};const ew=function(n){const e=[];let t=0;for(let i=0;i<n.length;i++){let l=n.charCodeAt(i);l<128?e[t++]=l:l<2048?(e[t++]=l>>6|192,e[t++]=l&63|128):(l&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(l=65536+((l&1023)<<10)+(n.charCodeAt(++i)&1023),e[t++]=l>>18|240,e[t++]=l>>12&63|128,e[t++]=l>>6&63|128,e[t++]=l&63|128):(e[t++]=l>>12|224,e[t++]=l>>6&63|128,e[t++]=l&63|128)}return e},pS=function(n){const e=[];let t=0,i=0;for(;t<n.length;){const l=n[t++];if(l<128)e[i++]=String.fromCharCode(l);else if(l>191&&l<224){const u=n[t++];e[i++]=String.fromCharCode((l&31)<<6|u&63)}else if(l>239&&l<365){const u=n[t++],d=n[t++],p=n[t++],g=((l&7)<<18|(u&63)<<12|(d&63)<<6|p&63)-65536;e[i++]=String.fromCharCode(55296+(g>>10)),e[i++]=String.fromCharCode(56320+(g&1023))}else{const u=n[t++],d=n[t++];e[i++]=String.fromCharCode((l&15)<<12|(u&63)<<6|d&63)}}return e.join("")},tw={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let l=0;l<n.length;l+=3){const u=n[l],d=l+1<n.length,p=d?n[l+1]:0,g=l+2<n.length,y=g?n[l+2]:0,x=u>>2,k=(u&3)<<4|p>>4;let T=(p&15)<<2|y>>6,O=y&63;g||(O=64,d||(T=64)),i.push(t[x],t[k],t[T],t[O])}return i.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(ew(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):pS(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let l=0;l<n.length;){const u=t[n.charAt(l++)],p=l<n.length?t[n.charAt(l)]:0;++l;const y=l<n.length?t[n.charAt(l)]:64;++l;const k=l<n.length?t[n.charAt(l)]:64;if(++l,u==null||p==null||y==null||k==null)throw new gS;const T=u<<2|p>>4;if(i.push(T),y!==64){const O=p<<4&240|y>>2;if(i.push(O),k!==64){const G=y<<6&192|k;i.push(G)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class gS extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const yS=function(n){const e=ew(n);return tw.encodeByteArray(e,!0)},Nh=function(n){return yS(n).replace(/\./g,"")},sw=function(n){try{return tw.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function bS(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const vS=()=>bS().__FIREBASE_DEFAULTS__,xS=()=>{if(typeof process>"u"||typeof V1>"u")return;const n=V1.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},wS=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&sw(n[1]);return e&&JSON.parse(e)},Zh=()=>{try{return fS()||vS()||xS()||wS()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},nw=n=>Zh()?.emulatorHosts?.[n],rw=n=>{const e=nw(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),i]:[e.substring(0,t),i]},aw=()=>Zh()?.config,iw=n=>Zh()?.[`_${n}`];class _S{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}}function go(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function qg(n){return(await fetch(n,{credentials:"include"})).ok}function ow(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},i=e||"demo-project",l=n.iat||0,u=n.sub||n.user_id;if(!u)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const d={iss:`https://securetoken.google.com/${i}`,aud:i,iat:l,exp:l+3600,auth_time:l,sub:u,user_id:u,firebase:{sign_in_provider:"custom",identities:{}},...n};return[Nh(JSON.stringify(t)),Nh(JSON.stringify(d)),""].join(".")}const cu={};function kS(){const n={prod:[],emulator:[]};for(const e of Object.keys(cu))cu[e]?n.emulator.push(e):n.prod.push(e);return n}function jS(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let U1=!1;function Hg(n,e){if(typeof window>"u"||typeof document>"u"||!go(window.location.host)||cu[n]===e||cu[n]||U1)return;cu[n]=e;function t(T){return`__firebase__banner__${T}`}const i="__firebase__banner",u=kS().prod.length>0;function d(){const T=document.getElementById(i);T&&T.remove()}function p(T){T.style.display="flex",T.style.background="#7faaf0",T.style.position="fixed",T.style.bottom="5px",T.style.left="5px",T.style.padding=".5em",T.style.borderRadius="5px",T.style.alignItems="center"}function g(T,O){T.setAttribute("width","24"),T.setAttribute("id",O),T.setAttribute("height","24"),T.setAttribute("viewBox","0 0 24 24"),T.setAttribute("fill","none"),T.style.marginLeft="-6px"}function y(){const T=document.createElement("span");return T.style.cursor="pointer",T.style.marginLeft="16px",T.style.fontSize="24px",T.innerHTML=" &times;",T.onclick=()=>{U1=!0,d()},T}function x(T,O){T.setAttribute("id",O),T.innerText="Learn more",T.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",T.setAttribute("target","__blank"),T.style.paddingLeft="5px",T.style.textDecoration="underline"}function k(){const T=jS(i),O=t("text"),G=document.getElementById(O)||document.createElement("span"),F=t("learnmore"),V=document.getElementById(F)||document.createElement("a"),te=t("preprendIcon"),Y=document.getElementById(te)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(T.created){const ie=T.element;p(ie),x(V,F);const he=y();g(Y,te),ie.append(Y,G,V,he),document.body.appendChild(ie)}u?(G.innerText="Preview backend disconnected.",Y.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(Y.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,G.innerText="Preview backend running in this workspace."),G.setAttribute("id",O)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",k):k()}function br(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function TS(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(br())}function ES(){const n=Zh()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function SS(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function NS(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function CS(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function RS(){const n=br();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function AS(){return!ES()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function MS(){try{return typeof indexedDB=="object"}catch{return!1}}function IS(){return new Promise((n,e)=>{try{let t=!0;const i="validate-browser-context-for-indexeddb-analytics-module",l=self.indexedDB.open(i);l.onsuccess=()=>{l.result.close(),t||self.indexedDB.deleteDatabase(i),n(!0)},l.onupgradeneeded=()=>{t=!1},l.onerror=()=>{e(l.error?.message||"")}}catch(t){e(t)}})}const DS="FirebaseError";class Ka extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=DS,Object.setPrototypeOf(this,Ka.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Au.prototype.create)}}class Au{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){const i=t[0]||{},l=`${this.service}/${e}`,u=this.errors[e],d=u?PS(u,i):"Error",p=`${this.serviceName}: ${d} (${l}).`;return new Ka(l,p,i)}}function PS(n,e){return n.replace(LS,(t,i)=>{const l=e[i];return l!=null?String(l):`<${i}?>`})}const LS=/\{\$([^}]+)}/g;function OS(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Go(n,e){if(n===e)return!0;const t=Object.keys(n),i=Object.keys(e);for(const l of t){if(!i.includes(l))return!1;const u=n[l],d=e[l];if(F1(u)&&F1(d)){if(!Go(u,d))return!1}else if(u!==d)return!1}for(const l of i)if(!t.includes(l))return!1;return!0}function F1(n){return n!==null&&typeof n=="object"}function Mu(n){const e=[];for(const[t,i]of Object.entries(n))Array.isArray(i)?i.forEach(l=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(l))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function nu(n){const e={};return n.replace(/^\?/,"").split("&").forEach(i=>{if(i){const[l,u]=i.split("=");e[decodeURIComponent(l)]=decodeURIComponent(u)}}),e}function ru(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function BS(n,e){const t=new VS(n,e);return t.subscribe.bind(t)}class VS{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,i){let l;if(e===void 0&&t===void 0&&i===void 0)throw new Error("Missing Observer.");US(e,["next","error","complete"])?l=e:l={next:e,error:t,complete:i},l.next===void 0&&(l.next=Ep),l.error===void 0&&(l.error=Ep),l.complete===void 0&&(l.complete=Ep);const u=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?l.error(this.finalError):l.complete()}catch{}}),this.observers.push(l),u}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function US(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Ep(){}function Zs(n){return n&&n._delegate?n._delegate:n}class lo{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const Uo="[DEFAULT]";class FS{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const i=new _S;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{const l=this.getOrInitializeService({instanceIdentifier:t});l&&i.resolve(l)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),i=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(l){if(i)return null;throw l}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(qS(e))try{this.getOrInitializeService({instanceIdentifier:Uo})}catch{}for(const[t,i]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(t);try{const u=this.getOrInitializeService({instanceIdentifier:l});i.resolve(u)}catch{}}}}clearInstance(e=Uo){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Uo){return this.instances.has(e)}getOptions(e=Uo){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const l=this.getOrInitializeService({instanceIdentifier:i,options:t});for(const[u,d]of this.instancesDeferred.entries()){const p=this.normalizeInstanceIdentifier(u);i===p&&d.resolve(l)}return l}onInit(e,t){const i=this.normalizeInstanceIdentifier(t),l=this.onInitCallbacks.get(i)??new Set;l.add(e),this.onInitCallbacks.set(i,l);const u=this.instances.get(i);return u&&e(u,i),()=>{l.delete(e)}}invokeOnInitCallbacks(e,t){const i=this.onInitCallbacks.get(t);if(i)for(const l of i)try{l(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:zS(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=Uo){return this.component?this.component.multipleInstances?e:Uo:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function zS(n){return n===Uo?void 0:n}function qS(n){return n.instantiationMode==="EAGER"}class HS{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new FS(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}var vs;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(vs||(vs={}));const $S={debug:vs.DEBUG,verbose:vs.VERBOSE,info:vs.INFO,warn:vs.WARN,error:vs.ERROR,silent:vs.SILENT},WS=vs.INFO,GS={[vs.DEBUG]:"log",[vs.VERBOSE]:"log",[vs.INFO]:"info",[vs.WARN]:"warn",[vs.ERROR]:"error"},KS=(n,e,...t)=>{if(e<n.logLevel)return;const i=new Date().toISOString(),l=GS[e];if(l)console[l](`[${i}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class $g{constructor(e){this.name=e,this._logLevel=WS,this._logHandler=KS,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in vs))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?$S[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,vs.DEBUG,...e),this._logHandler(this,vs.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,vs.VERBOSE,...e),this._logHandler(this,vs.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,vs.INFO,...e),this._logHandler(this,vs.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,vs.WARN,...e),this._logHandler(this,vs.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,vs.ERROR,...e),this._logHandler(this,vs.ERROR,...e)}}const YS=(n,e)=>e.some(t=>n instanceof t);let z1,q1;function QS(){return z1||(z1=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function XS(){return q1||(q1=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const lw=new WeakMap,ig=new WeakMap,cw=new WeakMap,Sp=new WeakMap,Wg=new WeakMap;function JS(n){const e=new Promise((t,i)=>{const l=()=>{n.removeEventListener("success",u),n.removeEventListener("error",d)},u=()=>{t(ro(n.result)),l()},d=()=>{i(n.error),l()};n.addEventListener("success",u),n.addEventListener("error",d)});return e.then(t=>{t instanceof IDBCursor&&lw.set(t,n)}).catch(()=>{}),Wg.set(e,n),e}function ZS(n){if(ig.has(n))return;const e=new Promise((t,i)=>{const l=()=>{n.removeEventListener("complete",u),n.removeEventListener("error",d),n.removeEventListener("abort",d)},u=()=>{t(),l()},d=()=>{i(n.error||new DOMException("AbortError","AbortError")),l()};n.addEventListener("complete",u),n.addEventListener("error",d),n.addEventListener("abort",d)});ig.set(n,e)}let og={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return ig.get(n);if(e==="objectStoreNames")return n.objectStoreNames||cw.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return ro(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function eN(n){og=n(og)}function tN(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const i=n.call(Np(this),e,...t);return cw.set(i,e.sort?e.sort():[e]),ro(i)}:XS().includes(n)?function(...e){return n.apply(Np(this),e),ro(lw.get(this))}:function(...e){return ro(n.apply(Np(this),e))}}function sN(n){return typeof n=="function"?tN(n):(n instanceof IDBTransaction&&ZS(n),YS(n,QS())?new Proxy(n,og):n)}function ro(n){if(n instanceof IDBRequest)return JS(n);if(Sp.has(n))return Sp.get(n);const e=sN(n);return e!==n&&(Sp.set(n,e),Wg.set(e,n)),e}const Np=n=>Wg.get(n);function nN(n,e,{blocked:t,upgrade:i,blocking:l,terminated:u}={}){const d=indexedDB.open(n,e),p=ro(d);return i&&d.addEventListener("upgradeneeded",g=>{i(ro(d.result),g.oldVersion,g.newVersion,ro(d.transaction),g)}),t&&d.addEventListener("blocked",g=>t(g.oldVersion,g.newVersion,g)),p.then(g=>{u&&g.addEventListener("close",()=>u()),l&&g.addEventListener("versionchange",y=>l(y.oldVersion,y.newVersion,y))}).catch(()=>{}),p}const rN=["get","getKey","getAll","getAllKeys","count"],aN=["put","add","delete","clear"],Cp=new Map;function H1(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Cp.get(e))return Cp.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,l=aN.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(l||rN.includes(t)))return;const u=async function(d,...p){const g=this.transaction(d,l?"readwrite":"readonly");let y=g.store;return i&&(y=y.index(p.shift())),(await Promise.all([y[t](...p),l&&g.done]))[0]};return Cp.set(e,u),u}eN(n=>({...n,get:(e,t,i)=>H1(e,t)||n.get(e,t,i),has:(e,t)=>!!H1(e,t)||n.has(e,t)}));class iN{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(oN(t)){const i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}}function oN(n){return n.getComponent()?.type==="VERSION"}const lg="@firebase/app",$1="0.14.7";const bi=new $g("@firebase/app"),lN="@firebase/app-compat",cN="@firebase/analytics-compat",uN="@firebase/analytics",dN="@firebase/app-check-compat",hN="@firebase/app-check",mN="@firebase/auth",fN="@firebase/auth-compat",pN="@firebase/database",gN="@firebase/data-connect",yN="@firebase/database-compat",bN="@firebase/functions",vN="@firebase/functions-compat",xN="@firebase/installations",wN="@firebase/installations-compat",_N="@firebase/messaging",kN="@firebase/messaging-compat",jN="@firebase/performance",TN="@firebase/performance-compat",EN="@firebase/remote-config",SN="@firebase/remote-config-compat",NN="@firebase/storage",CN="@firebase/storage-compat",RN="@firebase/firestore",AN="@firebase/ai",MN="@firebase/firestore-compat",IN="firebase",DN="12.8.0";const cg="[DEFAULT]",PN={[lg]:"fire-core",[lN]:"fire-core-compat",[uN]:"fire-analytics",[cN]:"fire-analytics-compat",[hN]:"fire-app-check",[dN]:"fire-app-check-compat",[mN]:"fire-auth",[fN]:"fire-auth-compat",[pN]:"fire-rtdb",[gN]:"fire-data-connect",[yN]:"fire-rtdb-compat",[bN]:"fire-fn",[vN]:"fire-fn-compat",[xN]:"fire-iid",[wN]:"fire-iid-compat",[_N]:"fire-fcm",[kN]:"fire-fcm-compat",[jN]:"fire-perf",[TN]:"fire-perf-compat",[EN]:"fire-rc",[SN]:"fire-rc-compat",[NN]:"fire-gcs",[CN]:"fire-gcs-compat",[RN]:"fire-fst",[MN]:"fire-fst-compat",[AN]:"fire-vertex","fire-js":"fire-js",[IN]:"fire-js-all"};const Ch=new Map,LN=new Map,ug=new Map;function W1(n,e){try{n.container.addComponent(e)}catch(t){bi.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Ko(n){const e=n.name;if(ug.has(e))return bi.debug(`There were multiple attempts to register component ${e}.`),!1;ug.set(e,n);for(const t of Ch.values())W1(t,n);for(const t of LN.values())W1(t,n);return!0}function em(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Qr(n){return n==null?!1:n.settings!==void 0}const ON={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},ao=new Au("app","Firebase",ON);class BN{constructor(e,t,i){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new lo("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ao.create("app-deleted",{appName:this._name})}}const tl=DN;function Gg(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const i={name:cg,automaticDataCollectionEnabled:!0,...e},l=i.name;if(typeof l!="string"||!l)throw ao.create("bad-app-name",{appName:String(l)});if(t||(t=aw()),!t)throw ao.create("no-options");const u=Ch.get(l);if(u){if(Go(t,u.options)&&Go(i,u.config))return u;throw ao.create("duplicate-app",{appName:l})}const d=new HS(l);for(const g of ug.values())d.addComponent(g);const p=new BN(t,i,d);return Ch.set(l,p),p}function Kg(n=cg){const e=Ch.get(n);if(!e&&n===cg&&aw())return Gg();if(!e)throw ao.create("no-app",{appName:n});return e}function Ua(n,e,t){let i=PN[n]??n;t&&(i+=`-${t}`);const l=i.match(/\s|\//),u=e.match(/\s|\//);if(l||u){const d=[`Unable to register library "${i}" with version "${e}":`];l&&d.push(`library name "${i}" contains illegal characters (whitespace or "/")`),l&&u&&d.push("and"),u&&d.push(`version name "${e}" contains illegal characters (whitespace or "/")`),bi.warn(d.join(" "));return}Ko(new lo(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}const VN="firebase-heartbeat-database",UN=1,yu="firebase-heartbeat-store";let Rp=null;function uw(){return Rp||(Rp=nN(VN,UN,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(yu)}catch(t){console.warn(t)}}}}).catch(n=>{throw ao.create("idb-open",{originalErrorMessage:n.message})})),Rp}async function FN(n){try{const t=(await uw()).transaction(yu),i=await t.objectStore(yu).get(dw(n));return await t.done,i}catch(e){if(e instanceof Ka)bi.warn(e.message);else{const t=ao.create("idb-get",{originalErrorMessage:e?.message});bi.warn(t.message)}}}async function G1(n,e){try{const i=(await uw()).transaction(yu,"readwrite");await i.objectStore(yu).put(e,dw(n)),await i.done}catch(t){if(t instanceof Ka)bi.warn(t.message);else{const i=ao.create("idb-set",{originalErrorMessage:t?.message});bi.warn(i.message)}}}function dw(n){return`${n.name}!${n.options.appId}`}const zN=1024,qN=30;class HN{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new WN(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=K1();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(l=>l.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:t}),this._heartbeatsCache.heartbeats.length>qN){const l=GN(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(l,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){bi.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=K1(),{heartbeatsToSend:t,unsentEntries:i}=$N(this._heartbeatsCache.heartbeats),l=Nh(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),l}catch(e){return bi.warn(e),""}}}function K1(){return new Date().toISOString().substring(0,10)}function $N(n,e=zN){const t=[];let i=n.slice();for(const l of n){const u=t.find(d=>d.agent===l.agent);if(u){if(u.dates.push(l.date),Y1(t)>e){u.dates.pop();break}}else if(t.push({agent:l.agent,dates:[l.date]}),Y1(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}class WN{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return MS()?IS().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await FN(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return G1(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return G1(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function Y1(n){return Nh(JSON.stringify({version:2,heartbeats:n})).length}function GN(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let i=1;i<n.length;i++)n[i].date<t&&(t=n[i].date,e=i);return e}function KN(n){Ko(new lo("platform-logger",e=>new iN(e),"PRIVATE")),Ko(new lo("heartbeat",e=>new HN(e),"PRIVATE")),Ua(lg,$1,n),Ua(lg,$1,"esm2020"),Ua("fire-js","")}KN("");function hw(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const YN=hw,mw=new Au("auth","Firebase",hw());const Rh=new $g("@firebase/auth");function QN(n,...e){Rh.logLevel<=vs.WARN&&Rh.warn(`Auth (${tl}): ${n}`,...e)}function yh(n,...e){Rh.logLevel<=vs.ERROR&&Rh.error(`Auth (${tl}): ${n}`,...e)}function Ta(n,...e){throw Yg(n,...e)}function Fa(n,...e){return Yg(n,...e)}function fw(n,e,t){const i={...YN(),[e]:t};return new Au("auth","Firebase",i).create(e,{appName:n.name})}function pi(n){return fw(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Yg(n,...e){if(typeof n!="string"){const t=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=n.name),n._errorFactory.create(t,...i)}return mw.create(n,...e)}function zt(n,e,...t){if(!n)throw Yg(e,...t)}function hi(n){const e="INTERNAL ASSERTION FAILED: "+n;throw yh(e),new Error(e)}function vi(n,e){n||hi(e)}function dg(){return typeof self<"u"&&self.location?.href||""}function XN(){return Q1()==="http:"||Q1()==="https:"}function Q1(){return typeof self<"u"&&self.location?.protocol||null}function JN(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(XN()||NS()||"connection"in navigator)?navigator.onLine:!0}function ZN(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}class Iu{constructor(e,t){this.shortDelay=e,this.longDelay=t,vi(t>e,"Short delay should be less than long delay!"),this.isMobile=TS()||CS()}get(){return JN()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function Qg(n,e){vi(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class pw{static initialize(e,t,i){this.fetchImpl=e,t&&(this.headersImpl=t),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;hi("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;hi("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;hi("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const eC={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const tC=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],sC=new Iu(3e4,6e4);function _i(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function ki(n,e,t,i,l={}){return gw(n,l,async()=>{let u={},d={};i&&(e==="GET"?d=i:u={body:JSON.stringify(i)});const p=Mu({key:n.config.apiKey,...d}).slice(1),g=await n._getAdditionalHeaders();g["Content-Type"]="application/json",n.languageCode&&(g["X-Firebase-Locale"]=n.languageCode);const y={method:e,headers:g,...u};return SS()||(y.referrerPolicy="no-referrer"),n.emulatorConfig&&go(n.emulatorConfig.host)&&(y.credentials="include"),pw.fetch()(await yw(n,n.config.apiHost,t,p),y)})}async function gw(n,e,t){n._canInitEmulator=!1;const i={...eC,...e};try{const l=new rC(n),u=await Promise.race([t(),l.promise]);l.clearNetworkTimeout();const d=await u.json();if("needConfirmation"in d)throw th(n,"account-exists-with-different-credential",d);if(u.ok&&!("errorMessage"in d))return d;{const p=u.ok?d.errorMessage:d.error.message,[g,y]=p.split(" : ");if(g==="FEDERATED_USER_ID_ALREADY_LINKED")throw th(n,"credential-already-in-use",d);if(g==="EMAIL_EXISTS")throw th(n,"email-already-in-use",d);if(g==="USER_DISABLED")throw th(n,"user-disabled",d);const x=i[g]||g.toLowerCase().replace(/[_\s]+/g,"-");if(y)throw fw(n,x,y);Ta(n,x)}}catch(l){if(l instanceof Ka)throw l;Ta(n,"network-request-failed",{message:String(l)})}}async function Du(n,e,t,i,l={}){const u=await ki(n,e,t,i,l);return"mfaPendingCredential"in u&&Ta(n,"multi-factor-auth-required",{_serverResponse:u}),u}async function yw(n,e,t,i){const l=`${e}${t}?${i}`,u=n,d=u.config.emulator?Qg(n.config,l):`${n.config.apiScheme}://${l}`;return tC.includes(t)&&(await u._persistenceManagerAvailable,u._getPersistenceType()==="COOKIE")?u._getPersistence()._getFinalTarget(d).toString():d}function nC(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class rC{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,i)=>{this.timer=setTimeout(()=>i(Fa(this.auth,"network-request-failed")),sC.get())})}}function th(n,e,t){const i={appName:n.name};t.email&&(i.email=t.email),t.phoneNumber&&(i.phoneNumber=t.phoneNumber);const l=Fa(n,e,i);return l.customData._tokenResponse=t,l}function X1(n){return n!==void 0&&n.enterprise!==void 0}class aC{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return nC(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function iC(n,e){return ki(n,"GET","/v2/recaptchaConfig",_i(n,e))}async function oC(n,e){return ki(n,"POST","/v1/accounts:delete",e)}async function Ah(n,e){return ki(n,"POST","/v1/accounts:lookup",e)}function uu(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function lC(n,e=!1){const t=Zs(n),i=await t.getIdToken(e),l=Xg(i);zt(l&&l.exp&&l.auth_time&&l.iat,t.auth,"internal-error");const u=typeof l.firebase=="object"?l.firebase:void 0,d=u?.sign_in_provider;return{claims:l,token:i,authTime:uu(Ap(l.auth_time)),issuedAtTime:uu(Ap(l.iat)),expirationTime:uu(Ap(l.exp)),signInProvider:d||null,signInSecondFactor:u?.sign_in_second_factor||null}}function Ap(n){return Number(n)*1e3}function Xg(n){const[e,t,i]=n.split(".");if(e===void 0||t===void 0||i===void 0)return yh("JWT malformed, contained fewer than 3 sections"),null;try{const l=sw(t);return l?JSON.parse(l):(yh("Failed to decode base64 JWT payload"),null)}catch(l){return yh("Caught error parsing JWT payload as JSON",l?.toString()),null}}function J1(n){const e=Xg(n);return zt(e,"internal-error"),zt(typeof e.exp<"u","internal-error"),zt(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function bu(n,e,t=!1){if(t)return e;try{return await e}catch(i){throw i instanceof Ka&&cC(i)&&n.auth.currentUser===n&&await n.auth.signOut(),i}}function cC({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}class uC{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const i=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class hg{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=uu(this.lastLoginAt),this.creationTime=uu(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Mh(n){const e=n.auth,t=await n.getIdToken(),i=await bu(n,Ah(e,{idToken:t}));zt(i?.users.length,e,"internal-error");const l=i.users[0];n._notifyReloadListener(l);const u=l.providerUserInfo?.length?bw(l.providerUserInfo):[],d=hC(n.providerData,u),p=n.isAnonymous,g=!(n.email&&l.passwordHash)&&!d?.length,y=p?g:!1,x={uid:l.localId,displayName:l.displayName||null,photoURL:l.photoUrl||null,email:l.email||null,emailVerified:l.emailVerified||!1,phoneNumber:l.phoneNumber||null,tenantId:l.tenantId||null,providerData:d,metadata:new hg(l.createdAt,l.lastLoginAt),isAnonymous:y};Object.assign(n,x)}async function dC(n){const e=Zs(n);await Mh(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function hC(n,e){return[...n.filter(i=>!e.some(l=>l.providerId===i.providerId)),...e]}function bw(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}async function mC(n,e){const t=await gw(n,{},async()=>{const i=Mu({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:l,apiKey:u}=n.config,d=await yw(n,l,"/v1/token",`key=${u}`),p=await n._getAdditionalHeaders();p["Content-Type"]="application/x-www-form-urlencoded";const g={method:"POST",headers:p,body:i};return n.emulatorConfig&&go(n.emulatorConfig.host)&&(g.credentials="include"),pw.fetch()(d,g)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function fC(n,e){return ki(n,"POST","/v2/accounts:revokeToken",_i(n,e))}class Wl{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){zt(e.idToken,"internal-error"),zt(typeof e.idToken<"u","internal-error"),zt(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):J1(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){zt(e.length!==0,"internal-error");const t=J1(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(zt(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:i,refreshToken:l,expiresIn:u}=await mC(e,t);this.updateTokensAndExpiration(i,l,Number(u))}updateTokensAndExpiration(e,t,i){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,t){const{refreshToken:i,accessToken:l,expirationTime:u}=t,d=new Wl;return i&&(zt(typeof i=="string","internal-error",{appName:e}),d.refreshToken=i),l&&(zt(typeof l=="string","internal-error",{appName:e}),d.accessToken=l),u&&(zt(typeof u=="number","internal-error",{appName:e}),d.expirationTime=u),d}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Wl,this.toJSON())}_performRefresh(){return hi("not implemented")}}function Ki(n,e){zt(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class ka{constructor({uid:e,auth:t,stsTokenManager:i,...l}){this.providerId="firebase",this.proactiveRefresh=new uC(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=l.displayName||null,this.email=l.email||null,this.emailVerified=l.emailVerified||!1,this.phoneNumber=l.phoneNumber||null,this.photoURL=l.photoURL||null,this.isAnonymous=l.isAnonymous||!1,this.tenantId=l.tenantId||null,this.providerData=l.providerData?[...l.providerData]:[],this.metadata=new hg(l.createdAt||void 0,l.lastLoginAt||void 0)}async getIdToken(e){const t=await bu(this,this.stsTokenManager.getToken(this.auth,e));return zt(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return lC(this,e)}reload(){return dC(this)}_assign(e){this!==e&&(zt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new ka({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){zt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),t&&await Mh(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Qr(this.auth.app))return Promise.reject(pi(this.auth));const e=await this.getIdToken();return await bu(this,oC(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const i=t.displayName??void 0,l=t.email??void 0,u=t.phoneNumber??void 0,d=t.photoURL??void 0,p=t.tenantId??void 0,g=t._redirectEventId??void 0,y=t.createdAt??void 0,x=t.lastLoginAt??void 0,{uid:k,emailVerified:T,isAnonymous:O,providerData:G,stsTokenManager:F}=t;zt(k&&F,e,"internal-error");const V=Wl.fromJSON(this.name,F);zt(typeof k=="string",e,"internal-error"),Ki(i,e.name),Ki(l,e.name),zt(typeof T=="boolean",e,"internal-error"),zt(typeof O=="boolean",e,"internal-error"),Ki(u,e.name),Ki(d,e.name),Ki(p,e.name),Ki(g,e.name),Ki(y,e.name),Ki(x,e.name);const te=new ka({uid:k,auth:e,email:l,emailVerified:T,displayName:i,isAnonymous:O,photoURL:d,phoneNumber:u,tenantId:p,stsTokenManager:V,createdAt:y,lastLoginAt:x});return G&&Array.isArray(G)&&(te.providerData=G.map(Y=>({...Y}))),g&&(te._redirectEventId=g),te}static async _fromIdTokenResponse(e,t,i=!1){const l=new Wl;l.updateFromServerResponse(t);const u=new ka({uid:t.localId,auth:e,stsTokenManager:l,isAnonymous:i});return await Mh(u),u}static async _fromGetAccountInfoResponse(e,t,i){const l=t.users[0];zt(l.localId!==void 0,"internal-error");const u=l.providerUserInfo!==void 0?bw(l.providerUserInfo):[],d=!(l.email&&l.passwordHash)&&!u?.length,p=new Wl;p.updateFromIdToken(i);const g=new ka({uid:l.localId,auth:e,stsTokenManager:p,isAnonymous:d}),y={uid:l.localId,displayName:l.displayName||null,photoURL:l.photoUrl||null,email:l.email||null,emailVerified:l.emailVerified||!1,phoneNumber:l.phoneNumber||null,tenantId:l.tenantId||null,providerData:u,metadata:new hg(l.createdAt,l.lastLoginAt),isAnonymous:!(l.email&&l.passwordHash)&&!u?.length};return Object.assign(g,y),g}}const Z1=new Map;function mi(n){vi(n instanceof Function,"Expected a class definition");let e=Z1.get(n);return e?(vi(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,Z1.set(n,e),e)}class vw{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}vw.type="NONE";const ex=vw;function bh(n,e,t){return`firebase:${n}:${e}:${t}`}class Gl{constructor(e,t,i){this.persistence=e,this.auth=t,this.userKey=i;const{config:l,name:u}=this.auth;this.fullUserKey=bh(this.userKey,l.apiKey,u),this.fullPersistenceKey=bh("persistence",l.apiKey,u),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await Ah(this.auth,{idToken:e}).catch(()=>{});return t?ka._fromGetAccountInfoResponse(this.auth,t,e):null}return ka._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,i="authUser"){if(!t.length)return new Gl(mi(ex),e,i);const l=(await Promise.all(t.map(async y=>{if(await y._isAvailable())return y}))).filter(y=>y);let u=l[0]||mi(ex);const d=bh(i,e.config.apiKey,e.name);let p=null;for(const y of t)try{const x=await y._get(d);if(x){let k;if(typeof x=="string"){const T=await Ah(e,{idToken:x}).catch(()=>{});if(!T)break;k=await ka._fromGetAccountInfoResponse(e,T,x)}else k=ka._fromJSON(e,x);y!==u&&(p=k),u=y;break}}catch{}const g=l.filter(y=>y._shouldAllowMigration);return!u._shouldAllowMigration||!g.length?new Gl(u,e,i):(u=g[0],p&&await u._set(d,p.toJSON()),await Promise.all(t.map(async y=>{if(y!==u)try{await y._remove(d)}catch{}})),new Gl(u,e,i))}}function tx(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(kw(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(xw(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Tw(e))return"Blackberry";if(Ew(e))return"Webos";if(ww(e))return"Safari";if((e.includes("chrome/")||_w(e))&&!e.includes("edge/"))return"Chrome";if(jw(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=n.match(t);if(i?.length===2)return i[1]}return"Other"}function xw(n=br()){return/firefox\//i.test(n)}function ww(n=br()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function _w(n=br()){return/crios\//i.test(n)}function kw(n=br()){return/iemobile/i.test(n)}function jw(n=br()){return/android/i.test(n)}function Tw(n=br()){return/blackberry/i.test(n)}function Ew(n=br()){return/webos/i.test(n)}function Jg(n=br()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function pC(n=br()){return Jg(n)&&!!window.navigator?.standalone}function gC(){return RS()&&document.documentMode===10}function Sw(n=br()){return Jg(n)||jw(n)||Ew(n)||Tw(n)||/windows phone/i.test(n)||kw(n)}function Nw(n,e=[]){let t;switch(n){case"Browser":t=tx(br());break;case"Worker":t=`${tx(br())}-${n}`;break;default:t=n}const i=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${tl}/${i}`}class yC{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const i=u=>new Promise((d,p)=>{try{const g=e(u);d(g)}catch(g){p(g)}});i.onAbort=t,this.queue.push(i);const l=this.queue.length-1;return()=>{this.queue[l]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const i of this.queue)await i(e),i.onAbort&&t.push(i.onAbort)}catch(i){t.reverse();for(const l of t)try{l()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i?.message})}}}async function bC(n,e={}){return ki(n,"GET","/v2/passwordPolicy",_i(n,e))}const vC=6;class xC{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??vC,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const i=this.customStrengthOptions.minPasswordLength,l=this.customStrengthOptions.maxPasswordLength;i&&(t.meetsMinPasswordLength=e.length>=i),l&&(t.meetsMaxPasswordLength=e.length<=l)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let i;for(let l=0;l<e.length;l++)i=e.charAt(l),this.updatePasswordCharacterOptionsStatuses(t,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,t,i,l,u){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=l)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=u))}}class wC{constructor(e,t,i,l){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=i,this.config=l,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new sx(this),this.idTokenSubscription=new sx(this),this.beforeStateQueue=new yC(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=mw,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=l.sdkClientVersion,this._persistenceManagerAvailable=new Promise(u=>this._resolvePersistenceManagerAvailable=u)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=mi(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await Gl.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await Ah(this,{idToken:e}),i=await ka._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(i)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(Qr(this.app)){const u=this.app.settings.authIdToken;return u?new Promise(d=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(u).then(d,d))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let i=t,l=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const u=this.redirectUser?._redirectEventId,d=i?._redirectEventId,p=await this.tryRedirectSignIn(e);(!u||u===d)&&p?.user&&(i=p.user,l=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(l)try{await this.beforeStateQueue.runMiddleware(i)}catch(u){i=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(u))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return zt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Mh(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=ZN()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Qr(this.app))return Promise.reject(pi(this));const t=e?Zs(e):null;return t&&zt(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&zt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Qr(this.app)?Promise.reject(pi(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Qr(this.app)?Promise.reject(pi(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(mi(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await bC(this),t=new xC(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Au("auth","Firebase",e())}onAuthStateChanged(e,t,i){return this.registerStateListener(this.authStateSubscription,e,t,i)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,i){return this.registerStateListener(this.idTokenSubscription,e,t,i)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const i=this.onAuthStateChanged(()=>{i(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(i.tenantId=this.tenantId),await fC(this,i)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const i=await this.getOrInitRedirectPersistenceManager(t);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&mi(e)||this._popupRedirectResolver;zt(t,this,"argument-error"),this.redirectPersistenceManager=await Gl.create(this,[mi(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,i,l){if(this._deleted)return()=>{};const u=typeof t=="function"?t:t.next.bind(t);let d=!1;const p=this._isInitialized?Promise.resolve():this._initializationPromise;if(zt(p,this,"internal-error"),p.then(()=>{d||u(this.currentUser)}),typeof t=="function"){const g=e.addObserver(t,i,l);return()=>{d=!0,g()}}else{const g=e.addObserver(t);return()=>{d=!0,g()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return zt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Nw(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const i=await this._getAppCheckToken();return i&&(e["X-Firebase-AppCheck"]=i),e}async _getAppCheckToken(){if(Qr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&QN(`Error while retrieving App Check token: ${e.error}`),e?.token}}function yo(n){return Zs(n)}class sx{constructor(e){this.auth=e,this.observer=null,this.addObserver=BS(t=>this.observer=t)}get next(){return zt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let tm={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function _C(n){tm=n}function Cw(n){return tm.loadJS(n)}function kC(){return tm.recaptchaEnterpriseScript}function jC(){return tm.gapiScript}function TC(n){return`__${n}${Math.floor(Math.random()*1e6)}`}class EC{constructor(){this.enterprise=new SC}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class SC{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const NC="recaptcha-enterprise",Rw="NO_RECAPTCHA";class CC{constructor(e){this.type=NC,this.auth=yo(e)}async verify(e="verify",t=!1){async function i(u){if(!t){if(u.tenantId==null&&u._agentRecaptchaConfig!=null)return u._agentRecaptchaConfig.siteKey;if(u.tenantId!=null&&u._tenantRecaptchaConfigs[u.tenantId]!==void 0)return u._tenantRecaptchaConfigs[u.tenantId].siteKey}return new Promise(async(d,p)=>{iC(u,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(g=>{if(g.recaptchaKey===void 0)p(new Error("recaptcha Enterprise site key undefined"));else{const y=new aC(g);return u.tenantId==null?u._agentRecaptchaConfig=y:u._tenantRecaptchaConfigs[u.tenantId]=y,d(y.siteKey)}}).catch(g=>{p(g)})})}function l(u,d,p){const g=window.grecaptcha;X1(g)?g.enterprise.ready(()=>{g.enterprise.execute(u,{action:e}).then(y=>{d(y)}).catch(()=>{d(Rw)})}):p(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new EC().execute("siteKey",{action:"verify"}):new Promise((u,d)=>{i(this.auth).then(p=>{if(!t&&X1(window.grecaptcha))l(p,u,d);else{if(typeof window>"u"){d(new Error("RecaptchaVerifier is only supported in browser"));return}let g=kC();g.length!==0&&(g+=p),Cw(g).then(()=>{l(p,u,d)}).catch(y=>{d(y)})}}).catch(p=>{d(p)})})}}async function nx(n,e,t,i=!1,l=!1){const u=new CC(n);let d;if(l)d=Rw;else try{d=await u.verify(t)}catch{d=await u.verify(t,!0)}const p={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in p){const g=p.phoneEnrollmentInfo.phoneNumber,y=p.phoneEnrollmentInfo.recaptchaToken;Object.assign(p,{phoneEnrollmentInfo:{phoneNumber:g,recaptchaToken:y,captchaResponse:d,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in p){const g=p.phoneSignInInfo.recaptchaToken;Object.assign(p,{phoneSignInInfo:{recaptchaToken:g,captchaResponse:d,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return p}return i?Object.assign(p,{captchaResp:d}):Object.assign(p,{captchaResponse:d}),Object.assign(p,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(p,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),p}async function Ih(n,e,t,i,l){if(n._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const u=await nx(n,e,t,t==="getOobCode");return i(n,u)}else return i(n,e).catch(async u=>{if(u.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const d=await nx(n,e,t,t==="getOobCode");return i(n,d)}else return Promise.reject(u)})}function RC(n,e){const t=em(n,"auth");if(t.isInitialized()){const l=t.getImmediate(),u=t.getOptions();if(Go(u,e??{}))return l;Ta(l,"already-initialized")}return t.initialize({options:e})}function AC(n,e){const t=e?.persistence||[],i=(Array.isArray(t)?t:[t]).map(mi);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(i,e?.popupRedirectResolver)}function MC(n,e,t){const i=yo(n);zt(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const l=!1,u=Aw(e),{host:d,port:p}=IC(e),g=p===null?"":`:${p}`,y={url:`${u}//${d}${g}/`},x=Object.freeze({host:d,port:p,protocol:u.replace(":",""),options:Object.freeze({disableWarnings:l})});if(!i._canInitEmulator){zt(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),zt(Go(y,i.config.emulator)&&Go(x,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=y,i.emulatorConfig=x,i.settings.appVerificationDisabledForTesting=!0,go(d)?(qg(`${u}//${d}${g}`),Hg("Auth",!0)):DC()}function Aw(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function IC(n){const e=Aw(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const i=t[2].split("@").pop()||"",l=/^(\[[^\]]+\])(:|$)/.exec(i);if(l){const u=l[1];return{host:u,port:rx(i.substr(u.length+1))}}else{const[u,d]=i.split(":");return{host:u,port:rx(d)}}}function rx(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function DC(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}class Zg{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return hi("not implemented")}_getIdTokenResponse(e){return hi("not implemented")}_linkToIdToken(e,t){return hi("not implemented")}_getReauthenticationResolver(e){return hi("not implemented")}}async function PC(n,e){return ki(n,"POST","/v1/accounts:signUp",e)}async function LC(n,e){return Du(n,"POST","/v1/accounts:signInWithPassword",_i(n,e))}async function Mw(n,e){return ki(n,"POST","/v1/accounts:sendOobCode",_i(n,e))}async function OC(n,e){return Mw(n,e)}async function BC(n,e){return Mw(n,e)}async function VC(n,e){return Du(n,"POST","/v1/accounts:signInWithEmailLink",_i(n,e))}async function UC(n,e){return Du(n,"POST","/v1/accounts:signInWithEmailLink",_i(n,e))}class vu extends Zg{constructor(e,t,i,l=null){super("password",i),this._email=e,this._password=t,this._tenantId=l}static _fromEmailAndPassword(e,t){return new vu(e,t,"password")}static _fromEmailAndCode(e,t,i=null){return new vu(e,t,"emailLink",i)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Ih(e,t,"signInWithPassword",LC);case"emailLink":return VC(e,{email:this._email,oobCode:this._password});default:Ta(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const i={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Ih(e,i,"signUpPassword",PC);case"emailLink":return UC(e,{idToken:t,email:this._email,oobCode:this._password});default:Ta(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function Kl(n,e){return Du(n,"POST","/v1/accounts:signInWithIdp",_i(n,e))}const FC="http://localhost";class Yo extends Zg{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Yo(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Ta("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:l,...u}=t;if(!i||!l)return null;const d=new Yo(i,l);return d.idToken=u.idToken||void 0,d.accessToken=u.accessToken||void 0,d.secret=u.secret,d.nonce=u.nonce,d.pendingToken=u.pendingToken||null,d}_getIdTokenResponse(e){const t=this.buildRequest();return Kl(e,t)}_linkToIdToken(e,t){const i=this.buildRequest();return i.idToken=t,Kl(e,i)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Kl(e,t)}buildRequest(){const e={requestUri:FC,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Mu(t)}return e}}function zC(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function qC(n){const e=nu(ru(n)).link,t=e?nu(ru(e)).deep_link_id:null,i=nu(ru(n)).deep_link_id;return(i?nu(ru(i)).link:null)||i||t||e||n}class ey{constructor(e){const t=nu(ru(e)),i=t.apiKey??null,l=t.oobCode??null,u=zC(t.mode??null);zt(i&&l&&u,"argument-error"),this.apiKey=i,this.operation=u,this.code=l,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=qC(e);try{return new ey(t)}catch{return null}}}class ic{constructor(){this.providerId=ic.PROVIDER_ID}static credential(e,t){return vu._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const i=ey.parseLink(t);return zt(i,"argument-error"),vu._fromEmailAndCode(e,i.code,i.tenantId)}}ic.PROVIDER_ID="password";ic.EMAIL_PASSWORD_SIGN_IN_METHOD="password";ic.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class Iw{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class Pu extends Iw{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Qi extends Pu{constructor(){super("facebook.com")}static credential(e){return Yo._fromParams({providerId:Qi.PROVIDER_ID,signInMethod:Qi.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Qi.credentialFromTaggedObject(e)}static credentialFromError(e){return Qi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Qi.credential(e.oauthAccessToken)}catch{return null}}}Qi.FACEBOOK_SIGN_IN_METHOD="facebook.com";Qi.PROVIDER_ID="facebook.com";class Xi extends Pu{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Yo._fromParams({providerId:Xi.PROVIDER_ID,signInMethod:Xi.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Xi.credentialFromTaggedObject(e)}static credentialFromError(e){return Xi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:i}=e;if(!t&&!i)return null;try{return Xi.credential(t,i)}catch{return null}}}Xi.GOOGLE_SIGN_IN_METHOD="google.com";Xi.PROVIDER_ID="google.com";class Ji extends Pu{constructor(){super("github.com")}static credential(e){return Yo._fromParams({providerId:Ji.PROVIDER_ID,signInMethod:Ji.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ji.credentialFromTaggedObject(e)}static credentialFromError(e){return Ji.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ji.credential(e.oauthAccessToken)}catch{return null}}}Ji.GITHUB_SIGN_IN_METHOD="github.com";Ji.PROVIDER_ID="github.com";class Zi extends Pu{constructor(){super("twitter.com")}static credential(e,t){return Yo._fromParams({providerId:Zi.PROVIDER_ID,signInMethod:Zi.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Zi.credentialFromTaggedObject(e)}static credentialFromError(e){return Zi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:i}=e;if(!t||!i)return null;try{return Zi.credential(t,i)}catch{return null}}}Zi.TWITTER_SIGN_IN_METHOD="twitter.com";Zi.PROVIDER_ID="twitter.com";async function HC(n,e){return Du(n,"POST","/v1/accounts:signUp",_i(n,e))}class Qo{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,i,l=!1){const u=await ka._fromIdTokenResponse(e,i,l),d=ax(i);return new Qo({user:u,providerId:d,_tokenResponse:i,operationType:t})}static async _forOperation(e,t,i){await e._updateTokensIfNecessary(i,!0);const l=ax(i);return new Qo({user:e,providerId:l,_tokenResponse:i,operationType:t})}}function ax(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}class Dh extends Ka{constructor(e,t,i,l){super(t.code,t.message),this.operationType=i,this.user=l,Object.setPrototypeOf(this,Dh.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,t,i,l){return new Dh(e,t,i,l)}}function Dw(n,e,t,i){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(u=>{throw u.code==="auth/multi-factor-auth-required"?Dh._fromErrorAndOperation(n,u,e,i):u})}async function $C(n,e,t=!1){const i=await bu(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return Qo._forOperation(n,"link",i)}async function WC(n,e,t=!1){const{auth:i}=n;if(Qr(i.app))return Promise.reject(pi(i));const l="reauthenticate";try{const u=await bu(n,Dw(i,l,e,n),t);zt(u.idToken,i,"internal-error");const d=Xg(u.idToken);zt(d,i,"internal-error");const{sub:p}=d;return zt(n.uid===p,i,"user-mismatch"),Qo._forOperation(n,l,u)}catch(u){throw u?.code==="auth/user-not-found"&&Ta(i,"user-mismatch"),u}}async function Pw(n,e,t=!1){if(Qr(n.app))return Promise.reject(pi(n));const i="signIn",l=await Dw(n,i,e),u=await Qo._fromIdTokenResponse(n,i,l);return t||await n._updateCurrentUser(u.user),u}async function GC(n,e){return Pw(yo(n),e)}async function Lw(n){const e=yo(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function KC(n,e,t){const i=yo(n);await Ih(i,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",BC)}async function YC(n,e,t){if(Qr(n.app))return Promise.reject(pi(n));const i=yo(n),d=await Ih(i,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",HC).catch(g=>{throw g.code==="auth/password-does-not-meet-requirements"&&Lw(n),g}),p=await Qo._fromIdTokenResponse(i,"signIn",d);return await i._updateCurrentUser(p.user),p}function QC(n,e,t){return Qr(n.app)?Promise.reject(pi(n)):GC(Zs(n),ic.credential(e,t)).catch(async i=>{throw i.code==="auth/password-does-not-meet-requirements"&&Lw(n),i})}async function zP(n,e){const t=Zs(n),l={requestType:"VERIFY_EMAIL",idToken:await n.getIdToken()},{email:u}=await OC(t.auth,l);u!==n.email&&await n.reload()}function ix(n,e){return Zs(n).setPersistence(e)}function XC(n,e,t,i){return Zs(n).onIdTokenChanged(e,t,i)}function JC(n,e,t){return Zs(n).beforeAuthStateChanged(e,t)}function ZC(n,e,t,i){return Zs(n).onAuthStateChanged(e,t,i)}function e4(n){return Zs(n).signOut()}const Ph="__sak";class Ow{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Ph,"1"),this.storage.removeItem(Ph),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const t4=1e3,s4=10;class Bw extends Ow{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Sw(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const i=this.storage.getItem(t),l=this.localCache[t];i!==l&&e(t,l,i)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((d,p,g)=>{this.notifyListeners(d,g)});return}const i=e.key;t?this.detachListener():this.stopPolling();const l=()=>{const d=this.storage.getItem(i);!t&&this.localCache[i]===d||this.notifyListeners(i,d)},u=this.storage.getItem(i);gC()&&u!==e.newValue&&e.newValue!==e.oldValue?setTimeout(l,s4):l()}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const l of Array.from(i))l(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:i}),!0)})},t4)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}Bw.type="LOCAL";const mg=Bw;class Vw extends Ow{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}Vw.type="SESSION";const ty=Vw;function n4(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class sm{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(l=>l.isListeningto(e));if(t)return t;const i=new sm(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:i,eventType:l,data:u}=t.data,d=this.handlersMap[l];if(!d?.size)return;t.ports[0].postMessage({status:"ack",eventId:i,eventType:l});const p=Array.from(d).map(async y=>y(t.origin,u)),g=await n4(p);t.ports[0].postMessage({status:"done",eventId:i,eventType:l,response:g})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}sm.receivers=[];function sy(n="",e=10){let t="";for(let i=0;i<e;i++)t+=Math.floor(Math.random()*10);return n+t}class r4{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,i=50){const l=typeof MessageChannel<"u"?new MessageChannel:null;if(!l)throw new Error("connection_unavailable");let u,d;return new Promise((p,g)=>{const y=sy("",20);l.port1.start();const x=setTimeout(()=>{g(new Error("unsupported_event"))},i);d={messageChannel:l,onMessage(k){const T=k;if(T.data.eventId===y)switch(T.data.status){case"ack":clearTimeout(x),u=setTimeout(()=>{g(new Error("timeout"))},3e3);break;case"done":clearTimeout(u),p(T.data.response);break;default:clearTimeout(x),clearTimeout(u),g(new Error("invalid_response"));break}}},this.handlers.add(d),l.port1.addEventListener("message",d.onMessage),this.target.postMessage({eventType:e,eventId:y,data:t},[l.port2])}).finally(()=>{d&&this.removeMessageHandler(d)})}}function za(){return window}function a4(n){za().location.href=n}function Uw(){return typeof za().WorkerGlobalScope<"u"&&typeof za().importScripts=="function"}async function i4(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function o4(){return navigator?.serviceWorker?.controller||null}function l4(){return Uw()?self:null}const Fw="firebaseLocalStorageDb",c4=1,Lh="firebaseLocalStorage",zw="fbase_key";class Lu{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function nm(n,e){return n.transaction([Lh],e?"readwrite":"readonly").objectStore(Lh)}function u4(){const n=indexedDB.deleteDatabase(Fw);return new Lu(n).toPromise()}function fg(){const n=indexedDB.open(Fw,c4);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const i=n.result;try{i.createObjectStore(Lh,{keyPath:zw})}catch(l){t(l)}}),n.addEventListener("success",async()=>{const i=n.result;i.objectStoreNames.contains(Lh)?e(i):(i.close(),await u4(),e(await fg()))})})}async function ox(n,e,t){const i=nm(n,!0).put({[zw]:e,value:t});return new Lu(i).toPromise()}async function d4(n,e){const t=nm(n,!1).get(e),i=await new Lu(t).toPromise();return i===void 0?null:i.value}function lx(n,e){const t=nm(n,!0).delete(e);return new Lu(t).toPromise()}const h4=800,m4=3;class qw{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await fg(),this.db)}async _withRetries(e){let t=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(i){if(t++>m4)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Uw()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=sm._getInstance(l4()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await i4(),!this.activeServiceWorker)return;this.sender=new r4(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||o4()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await fg();return await ox(e,Ph,"1"),await lx(e,Ph),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(i=>ox(i,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(i=>d4(i,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>lx(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(l=>{const u=nm(l,!1).getAll();return new Lu(u).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],i=new Set;if(e.length!==0)for(const{fbase_key:l,value:u}of e)i.add(l),JSON.stringify(this.localCache[l])!==JSON.stringify(u)&&(this.notifyListeners(l,u),t.push(l));for(const l of Object.keys(this.localCache))this.localCache[l]&&!i.has(l)&&(this.notifyListeners(l,null),t.push(l));return t}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const l of Array.from(i))l(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),h4)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}qw.type="LOCAL";const f4=qw;new Iu(3e4,6e4);function p4(n,e){return e?mi(e):(zt(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}class ny extends Zg{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Kl(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Kl(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Kl(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function g4(n){return Pw(n.auth,new ny(n),n.bypassAuthState)}function y4(n){const{auth:e,user:t}=n;return zt(t,e,"internal-error"),WC(t,new ny(n),n.bypassAuthState)}async function b4(n){const{auth:e,user:t}=n;return zt(t,e,"internal-error"),$C(t,new ny(n),n.bypassAuthState)}class Hw{constructor(e,t,i,l,u=!1){this.auth=e,this.resolver=i,this.user=l,this.bypassAuthState=u,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:i,postBody:l,tenantId:u,error:d,type:p}=e;if(d){this.reject(d);return}const g={auth:this.auth,requestUri:t,sessionId:i,tenantId:u||void 0,postBody:l||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(p)(g))}catch(y){this.reject(y)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return g4;case"linkViaPopup":case"linkViaRedirect":return b4;case"reauthViaPopup":case"reauthViaRedirect":return y4;default:Ta(this.auth,"internal-error")}}resolve(e){vi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){vi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const v4=new Iu(2e3,1e4);class $l extends Hw{constructor(e,t,i,l,u){super(e,t,l,u),this.provider=i,this.authWindow=null,this.pollId=null,$l.currentPopupAction&&$l.currentPopupAction.cancel(),$l.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return zt(e,this.auth,"internal-error"),e}async onExecution(){vi(this.filter.length===1,"Popup operations only handle one event");const e=sy();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Fa(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(Fa(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,$l.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Fa(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,v4.get())};e()}}$l.currentPopupAction=null;const x4="pendingRedirect",vh=new Map;class w4 extends Hw{constructor(e,t,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,i),this.eventId=null}async execute(){let e=vh.get(this.auth._key());if(!e){try{const i=await _4(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(t){e=()=>Promise.reject(t)}vh.set(this.auth._key(),e)}return this.bypassAuthState||vh.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function _4(n,e){const t=T4(e),i=j4(n);if(!await i._isAvailable())return!1;const l=await i._get(t)==="true";return await i._remove(t),l}function k4(n,e){vh.set(n._key(),e)}function j4(n){return mi(n._redirectPersistence)}function T4(n){return bh(x4,n.config.apiKey,n.name)}async function E4(n,e,t=!1){if(Qr(n.app))return Promise.reject(pi(n));const i=yo(n),l=p4(i,e),d=await new w4(i,l,t).execute();return d&&!t&&(delete d.user._redirectEventId,await i._persistUserIfCurrent(d.user),await i._setRedirectUser(null,e)),d}const S4=600*1e3;class N4{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(t=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!C4(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!$w(e)){const i=e.error.code?.split("auth/")[1]||"internal-error";t.onError(Fa(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const i=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=S4&&this.cachedEventUids.clear(),this.cachedEventUids.has(cx(e))}saveEventToCache(e){this.cachedEventUids.add(cx(e)),this.lastProcessedEventTime=Date.now()}}function cx(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function $w({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function C4(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return $w(n);default:return!1}}async function R4(n,e={}){return ki(n,"GET","/v1/projects",e)}const A4=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,M4=/^https?/;async function I4(n){if(n.config.emulator)return;const{authorizedDomains:e}=await R4(n);for(const t of e)try{if(D4(t))return}catch{}Ta(n,"unauthorized-domain")}function D4(n){const e=dg(),{protocol:t,hostname:i}=new URL(e);if(n.startsWith("chrome-extension://")){const d=new URL(n);return d.hostname===""&&i===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&d.hostname===i}if(!M4.test(t))return!1;if(A4.test(n))return i===n;const l=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+l+"|"+l+")$","i").test(i)}const P4=new Iu(3e4,6e4);function ux(){const n=za().___jsl;if(n?.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function L4(n){return new Promise((e,t)=>{function i(){ux(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{ux(),t(Fa(n,"network-request-failed"))},timeout:P4.get()})}if(za().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(za().gapi?.load)i();else{const l=TC("iframefcb");return za()[l]=()=>{gapi.load?i():t(Fa(n,"network-request-failed"))},Cw(`${jC()}?onload=${l}`).catch(u=>t(u))}}).catch(e=>{throw xh=null,e})}let xh=null;function O4(n){return xh=xh||L4(n),xh}const B4=new Iu(5e3,15e3),V4="__/auth/iframe",U4="emulator/auth/iframe",F4={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},z4=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function q4(n){const e=n.config;zt(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?Qg(e,U4):`https://${n.config.authDomain}/${V4}`,i={apiKey:e.apiKey,appName:n.name,v:tl},l=z4.get(n.config.apiHost);l&&(i.eid=l);const u=n._getFrameworks();return u.length&&(i.fw=u.join(",")),`${t}?${Mu(i).slice(1)}`}async function H4(n){const e=await O4(n),t=za().gapi;return zt(t,n,"internal-error"),e.open({where:document.body,url:q4(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:F4,dontclear:!0},i=>new Promise(async(l,u)=>{await i.restyle({setHideOnLeave:!1});const d=Fa(n,"network-request-failed"),p=za().setTimeout(()=>{u(d)},B4.get());function g(){za().clearTimeout(p),l(i)}i.ping(g).then(g,()=>{u(d)})}))}const $4={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},W4=500,G4=600,K4="_blank",Y4="http://localhost";class dx{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function Q4(n,e,t,i=W4,l=G4){const u=Math.max((window.screen.availHeight-l)/2,0).toString(),d=Math.max((window.screen.availWidth-i)/2,0).toString();let p="";const g={...$4,width:i.toString(),height:l.toString(),top:u,left:d},y=br().toLowerCase();t&&(p=_w(y)?K4:t),xw(y)&&(e=e||Y4,g.scrollbars="yes");const x=Object.entries(g).reduce((T,[O,G])=>`${T}${O}=${G},`,"");if(pC(y)&&p!=="_self")return X4(e||"",p),new dx(null);const k=window.open(e||"",p,x);zt(k,n,"popup-blocked");try{k.focus()}catch{}return new dx(k)}function X4(n,e){const t=document.createElement("a");t.href=n,t.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(i)}const J4="__/auth/handler",Z4="emulator/auth/handler",eR=encodeURIComponent("fac");async function hx(n,e,t,i,l,u){zt(n.config.authDomain,n,"auth-domain-config-required"),zt(n.config.apiKey,n,"invalid-api-key");const d={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:i,v:tl,eventId:l};if(e instanceof Iw){e.setDefaultLanguage(n.languageCode),d.providerId=e.providerId||"",OS(e.getCustomParameters())||(d.customParameters=JSON.stringify(e.getCustomParameters()));for(const[x,k]of Object.entries({}))d[x]=k}if(e instanceof Pu){const x=e.getScopes().filter(k=>k!=="");x.length>0&&(d.scopes=x.join(","))}n.tenantId&&(d.tid=n.tenantId);const p=d;for(const x of Object.keys(p))p[x]===void 0&&delete p[x];const g=await n._getAppCheckToken(),y=g?`#${eR}=${encodeURIComponent(g)}`:"";return`${tR(n)}?${Mu(p).slice(1)}${y}`}function tR({config:n}){return n.emulator?Qg(n,Z4):`https://${n.authDomain}/${J4}`}const Mp="webStorageSupport";class sR{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=ty,this._completeRedirectFn=E4,this._overrideRedirectResult=k4}async _openPopup(e,t,i,l){vi(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const u=await hx(e,t,i,dg(),l);return Q4(e,u,sy())}async _openRedirect(e,t,i,l){await this._originValidation(e);const u=await hx(e,t,i,dg(),l);return a4(u),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:l,promise:u}=this.eventManagers[t];return l?Promise.resolve(l):(vi(u,"If manager is not set, promise should be"),u)}const i=this.initAndGetManager(e);return this.eventManagers[t]={promise:i},i.catch(()=>{delete this.eventManagers[t]}),i}async initAndGetManager(e){const t=await H4(e),i=new N4(e);return t.register("authEvent",l=>(zt(l?.authEvent,e,"invalid-auth-event"),{status:i.onEvent(l.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=t,i}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Mp,{type:Mp},l=>{const u=l?.[0]?.[Mp];u!==void 0&&t(!!u),Ta(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=I4(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return Sw()||ww()||Jg()}}const nR=sR;var mx="@firebase/auth",fx="1.12.0";class rR{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(i=>{e(i?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){zt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function aR(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function iR(n){Ko(new lo("auth",(e,{options:t})=>{const i=e.getProvider("app").getImmediate(),l=e.getProvider("heartbeat"),u=e.getProvider("app-check-internal"),{apiKey:d,authDomain:p}=i.options;zt(d&&!d.includes(":"),"invalid-api-key",{appName:i.name});const g={apiKey:d,authDomain:p,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Nw(n)},y=new wC(i,l,u,g);return AC(y,t),y},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,i)=>{e.getProvider("auth-internal").initialize()})),Ko(new lo("auth-internal",e=>{const t=yo(e.getProvider("auth").getImmediate());return(i=>new rR(i))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Ua(mx,fx,aR(n)),Ua(mx,fx,"esm2020")}const oR=300,lR=iw("authIdTokenMaxAge")||oR;let px=null;const cR=n=>async e=>{const t=e&&await e.getIdTokenResult(),i=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(i&&i>lR)return;const l=t?.token;px!==l&&(px=l,await fetch(n,{method:l?"POST":"DELETE",headers:l?{Authorization:`Bearer ${l}`}:{}}))};function Ww(n=Kg()){const e=em(n,"auth");if(e.isInitialized())return e.getImmediate();const t=RC(n,{popupRedirectResolver:nR,persistence:[f4,mg,ty]}),i=iw("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const u=new URL(i,location.origin);if(location.origin===u.origin){const d=cR(u.toString());JC(t,d,()=>d(t.currentUser)),XC(t,p=>d(p))}}const l=nw("auth");return l&&MC(t,`http://${l}`),t}function uR(){return document.getElementsByTagName("head")?.[0]??document}_C({loadJS(n){return new Promise((e,t)=>{const i=document.createElement("script");i.setAttribute("src",n),i.onload=e,i.onerror=l=>{const u=Fa("internal-error");u.customData=l,t(u)},i.type="text/javascript",i.charset="UTF-8",uR().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});iR("Browser");var gx=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var io,Gw;(function(){var n;function e(R,E){function M(){}M.prototype=E.prototype,R.F=E.prototype,R.prototype=new M,R.prototype.constructor=R,R.D=function(B,D,H){for(var I=Array(arguments.length-2),ze=2;ze<arguments.length;ze++)I[ze-2]=arguments[ze];return E.prototype[D].apply(B,I)}}function t(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(i,t),i.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function l(R,E,M){M||(M=0);const B=Array(16);if(typeof E=="string")for(var D=0;D<16;++D)B[D]=E.charCodeAt(M++)|E.charCodeAt(M++)<<8|E.charCodeAt(M++)<<16|E.charCodeAt(M++)<<24;else for(D=0;D<16;++D)B[D]=E[M++]|E[M++]<<8|E[M++]<<16|E[M++]<<24;E=R.g[0],M=R.g[1],D=R.g[2];let H=R.g[3],I;I=E+(H^M&(D^H))+B[0]+3614090360&4294967295,E=M+(I<<7&4294967295|I>>>25),I=H+(D^E&(M^D))+B[1]+3905402710&4294967295,H=E+(I<<12&4294967295|I>>>20),I=D+(M^H&(E^M))+B[2]+606105819&4294967295,D=H+(I<<17&4294967295|I>>>15),I=M+(E^D&(H^E))+B[3]+3250441966&4294967295,M=D+(I<<22&4294967295|I>>>10),I=E+(H^M&(D^H))+B[4]+4118548399&4294967295,E=M+(I<<7&4294967295|I>>>25),I=H+(D^E&(M^D))+B[5]+1200080426&4294967295,H=E+(I<<12&4294967295|I>>>20),I=D+(M^H&(E^M))+B[6]+2821735955&4294967295,D=H+(I<<17&4294967295|I>>>15),I=M+(E^D&(H^E))+B[7]+4249261313&4294967295,M=D+(I<<22&4294967295|I>>>10),I=E+(H^M&(D^H))+B[8]+1770035416&4294967295,E=M+(I<<7&4294967295|I>>>25),I=H+(D^E&(M^D))+B[9]+2336552879&4294967295,H=E+(I<<12&4294967295|I>>>20),I=D+(M^H&(E^M))+B[10]+4294925233&4294967295,D=H+(I<<17&4294967295|I>>>15),I=M+(E^D&(H^E))+B[11]+2304563134&4294967295,M=D+(I<<22&4294967295|I>>>10),I=E+(H^M&(D^H))+B[12]+1804603682&4294967295,E=M+(I<<7&4294967295|I>>>25),I=H+(D^E&(M^D))+B[13]+4254626195&4294967295,H=E+(I<<12&4294967295|I>>>20),I=D+(M^H&(E^M))+B[14]+2792965006&4294967295,D=H+(I<<17&4294967295|I>>>15),I=M+(E^D&(H^E))+B[15]+1236535329&4294967295,M=D+(I<<22&4294967295|I>>>10),I=E+(D^H&(M^D))+B[1]+4129170786&4294967295,E=M+(I<<5&4294967295|I>>>27),I=H+(M^D&(E^M))+B[6]+3225465664&4294967295,H=E+(I<<9&4294967295|I>>>23),I=D+(E^M&(H^E))+B[11]+643717713&4294967295,D=H+(I<<14&4294967295|I>>>18),I=M+(H^E&(D^H))+B[0]+3921069994&4294967295,M=D+(I<<20&4294967295|I>>>12),I=E+(D^H&(M^D))+B[5]+3593408605&4294967295,E=M+(I<<5&4294967295|I>>>27),I=H+(M^D&(E^M))+B[10]+38016083&4294967295,H=E+(I<<9&4294967295|I>>>23),I=D+(E^M&(H^E))+B[15]+3634488961&4294967295,D=H+(I<<14&4294967295|I>>>18),I=M+(H^E&(D^H))+B[4]+3889429448&4294967295,M=D+(I<<20&4294967295|I>>>12),I=E+(D^H&(M^D))+B[9]+568446438&4294967295,E=M+(I<<5&4294967295|I>>>27),I=H+(M^D&(E^M))+B[14]+3275163606&4294967295,H=E+(I<<9&4294967295|I>>>23),I=D+(E^M&(H^E))+B[3]+4107603335&4294967295,D=H+(I<<14&4294967295|I>>>18),I=M+(H^E&(D^H))+B[8]+1163531501&4294967295,M=D+(I<<20&4294967295|I>>>12),I=E+(D^H&(M^D))+B[13]+2850285829&4294967295,E=M+(I<<5&4294967295|I>>>27),I=H+(M^D&(E^M))+B[2]+4243563512&4294967295,H=E+(I<<9&4294967295|I>>>23),I=D+(E^M&(H^E))+B[7]+1735328473&4294967295,D=H+(I<<14&4294967295|I>>>18),I=M+(H^E&(D^H))+B[12]+2368359562&4294967295,M=D+(I<<20&4294967295|I>>>12),I=E+(M^D^H)+B[5]+4294588738&4294967295,E=M+(I<<4&4294967295|I>>>28),I=H+(E^M^D)+B[8]+2272392833&4294967295,H=E+(I<<11&4294967295|I>>>21),I=D+(H^E^M)+B[11]+1839030562&4294967295,D=H+(I<<16&4294967295|I>>>16),I=M+(D^H^E)+B[14]+4259657740&4294967295,M=D+(I<<23&4294967295|I>>>9),I=E+(M^D^H)+B[1]+2763975236&4294967295,E=M+(I<<4&4294967295|I>>>28),I=H+(E^M^D)+B[4]+1272893353&4294967295,H=E+(I<<11&4294967295|I>>>21),I=D+(H^E^M)+B[7]+4139469664&4294967295,D=H+(I<<16&4294967295|I>>>16),I=M+(D^H^E)+B[10]+3200236656&4294967295,M=D+(I<<23&4294967295|I>>>9),I=E+(M^D^H)+B[13]+681279174&4294967295,E=M+(I<<4&4294967295|I>>>28),I=H+(E^M^D)+B[0]+3936430074&4294967295,H=E+(I<<11&4294967295|I>>>21),I=D+(H^E^M)+B[3]+3572445317&4294967295,D=H+(I<<16&4294967295|I>>>16),I=M+(D^H^E)+B[6]+76029189&4294967295,M=D+(I<<23&4294967295|I>>>9),I=E+(M^D^H)+B[9]+3654602809&4294967295,E=M+(I<<4&4294967295|I>>>28),I=H+(E^M^D)+B[12]+3873151461&4294967295,H=E+(I<<11&4294967295|I>>>21),I=D+(H^E^M)+B[15]+530742520&4294967295,D=H+(I<<16&4294967295|I>>>16),I=M+(D^H^E)+B[2]+3299628645&4294967295,M=D+(I<<23&4294967295|I>>>9),I=E+(D^(M|~H))+B[0]+4096336452&4294967295,E=M+(I<<6&4294967295|I>>>26),I=H+(M^(E|~D))+B[7]+1126891415&4294967295,H=E+(I<<10&4294967295|I>>>22),I=D+(E^(H|~M))+B[14]+2878612391&4294967295,D=H+(I<<15&4294967295|I>>>17),I=M+(H^(D|~E))+B[5]+4237533241&4294967295,M=D+(I<<21&4294967295|I>>>11),I=E+(D^(M|~H))+B[12]+1700485571&4294967295,E=M+(I<<6&4294967295|I>>>26),I=H+(M^(E|~D))+B[3]+2399980690&4294967295,H=E+(I<<10&4294967295|I>>>22),I=D+(E^(H|~M))+B[10]+4293915773&4294967295,D=H+(I<<15&4294967295|I>>>17),I=M+(H^(D|~E))+B[1]+2240044497&4294967295,M=D+(I<<21&4294967295|I>>>11),I=E+(D^(M|~H))+B[8]+1873313359&4294967295,E=M+(I<<6&4294967295|I>>>26),I=H+(M^(E|~D))+B[15]+4264355552&4294967295,H=E+(I<<10&4294967295|I>>>22),I=D+(E^(H|~M))+B[6]+2734768916&4294967295,D=H+(I<<15&4294967295|I>>>17),I=M+(H^(D|~E))+B[13]+1309151649&4294967295,M=D+(I<<21&4294967295|I>>>11),I=E+(D^(M|~H))+B[4]+4149444226&4294967295,E=M+(I<<6&4294967295|I>>>26),I=H+(M^(E|~D))+B[11]+3174756917&4294967295,H=E+(I<<10&4294967295|I>>>22),I=D+(E^(H|~M))+B[2]+718787259&4294967295,D=H+(I<<15&4294967295|I>>>17),I=M+(H^(D|~E))+B[9]+3951481745&4294967295,R.g[0]=R.g[0]+E&4294967295,R.g[1]=R.g[1]+(D+(I<<21&4294967295|I>>>11))&4294967295,R.g[2]=R.g[2]+D&4294967295,R.g[3]=R.g[3]+H&4294967295}i.prototype.v=function(R,E){E===void 0&&(E=R.length);const M=E-this.blockSize,B=this.C;let D=this.h,H=0;for(;H<E;){if(D==0)for(;H<=M;)l(this,R,H),H+=this.blockSize;if(typeof R=="string"){for(;H<E;)if(B[D++]=R.charCodeAt(H++),D==this.blockSize){l(this,B),D=0;break}}else for(;H<E;)if(B[D++]=R[H++],D==this.blockSize){l(this,B),D=0;break}}this.h=D,this.o+=E},i.prototype.A=function(){var R=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);R[0]=128;for(var E=1;E<R.length-8;++E)R[E]=0;E=this.o*8;for(var M=R.length-8;M<R.length;++M)R[M]=E&255,E/=256;for(this.v(R),R=Array(16),E=0,M=0;M<4;++M)for(let B=0;B<32;B+=8)R[E++]=this.g[M]>>>B&255;return R};function u(R,E){var M=p;return Object.prototype.hasOwnProperty.call(M,R)?M[R]:M[R]=E(R)}function d(R,E){this.h=E;const M=[];let B=!0;for(let D=R.length-1;D>=0;D--){const H=R[D]|0;B&&H==E||(M[D]=H,B=!1)}this.g=M}var p={};function g(R){return-128<=R&&R<128?u(R,function(E){return new d([E|0],E<0?-1:0)}):new d([R|0],R<0?-1:0)}function y(R){if(isNaN(R)||!isFinite(R))return k;if(R<0)return V(y(-R));const E=[];let M=1;for(let B=0;R>=M;B++)E[B]=R/M|0,M*=4294967296;return new d(E,0)}function x(R,E){if(R.length==0)throw Error("number format error: empty string");if(E=E||10,E<2||36<E)throw Error("radix out of range: "+E);if(R.charAt(0)=="-")return V(x(R.substring(1),E));if(R.indexOf("-")>=0)throw Error('number format error: interior "-" character');const M=y(Math.pow(E,8));let B=k;for(let H=0;H<R.length;H+=8){var D=Math.min(8,R.length-H);const I=parseInt(R.substring(H,H+D),E);D<8?(D=y(Math.pow(E,D)),B=B.j(D).add(y(I))):(B=B.j(M),B=B.add(y(I)))}return B}var k=g(0),T=g(1),O=g(16777216);n=d.prototype,n.m=function(){if(F(this))return-V(this).m();let R=0,E=1;for(let M=0;M<this.g.length;M++){const B=this.i(M);R+=(B>=0?B:4294967296+B)*E,E*=4294967296}return R},n.toString=function(R){if(R=R||10,R<2||36<R)throw Error("radix out of range: "+R);if(G(this))return"0";if(F(this))return"-"+V(this).toString(R);const E=y(Math.pow(R,6));var M=this;let B="";for(;;){const D=he(M,E).g;M=te(M,D.j(E));let H=((M.g.length>0?M.g[0]:M.h)>>>0).toString(R);if(M=D,G(M))return H+B;for(;H.length<6;)H="0"+H;B=H+B}},n.i=function(R){return R<0?0:R<this.g.length?this.g[R]:this.h};function G(R){if(R.h!=0)return!1;for(let E=0;E<R.g.length;E++)if(R.g[E]!=0)return!1;return!0}function F(R){return R.h==-1}n.l=function(R){return R=te(this,R),F(R)?-1:G(R)?0:1};function V(R){const E=R.g.length,M=[];for(let B=0;B<E;B++)M[B]=~R.g[B];return new d(M,~R.h).add(T)}n.abs=function(){return F(this)?V(this):this},n.add=function(R){const E=Math.max(this.g.length,R.g.length),M=[];let B=0;for(let D=0;D<=E;D++){let H=B+(this.i(D)&65535)+(R.i(D)&65535),I=(H>>>16)+(this.i(D)>>>16)+(R.i(D)>>>16);B=I>>>16,H&=65535,I&=65535,M[D]=I<<16|H}return new d(M,M[M.length-1]&-2147483648?-1:0)};function te(R,E){return R.add(V(E))}n.j=function(R){if(G(this)||G(R))return k;if(F(this))return F(R)?V(this).j(V(R)):V(V(this).j(R));if(F(R))return V(this.j(V(R)));if(this.l(O)<0&&R.l(O)<0)return y(this.m()*R.m());const E=this.g.length+R.g.length,M=[];for(var B=0;B<2*E;B++)M[B]=0;for(B=0;B<this.g.length;B++)for(let D=0;D<R.g.length;D++){const H=this.i(B)>>>16,I=this.i(B)&65535,ze=R.i(D)>>>16,mt=R.i(D)&65535;M[2*B+2*D]+=I*mt,Y(M,2*B+2*D),M[2*B+2*D+1]+=H*mt,Y(M,2*B+2*D+1),M[2*B+2*D+1]+=I*ze,Y(M,2*B+2*D+1),M[2*B+2*D+2]+=H*ze,Y(M,2*B+2*D+2)}for(R=0;R<E;R++)M[R]=M[2*R+1]<<16|M[2*R];for(R=E;R<2*E;R++)M[R]=0;return new d(M,0)};function Y(R,E){for(;(R[E]&65535)!=R[E];)R[E+1]+=R[E]>>>16,R[E]&=65535,E++}function ie(R,E){this.g=R,this.h=E}function he(R,E){if(G(E))throw Error("division by zero");if(G(R))return new ie(k,k);if(F(R))return E=he(V(R),E),new ie(V(E.g),V(E.h));if(F(E))return E=he(R,V(E)),new ie(V(E.g),E.h);if(R.g.length>30){if(F(R)||F(E))throw Error("slowDivide_ only works with positive integers.");for(var M=T,B=E;B.l(R)<=0;)M=Ne(M),B=Ne(B);var D=fe(M,1),H=fe(B,1);for(B=fe(B,2),M=fe(M,2);!G(B);){var I=H.add(B);I.l(R)<=0&&(D=D.add(M),H=I),B=fe(B,1),M=fe(M,1)}return E=te(R,D.j(E)),new ie(D,E)}for(D=k;R.l(E)>=0;){for(M=Math.max(1,Math.floor(R.m()/E.m())),B=Math.ceil(Math.log(M)/Math.LN2),B=B<=48?1:Math.pow(2,B-48),H=y(M),I=H.j(E);F(I)||I.l(R)>0;)M-=B,H=y(M),I=H.j(E);G(H)&&(H=T),D=D.add(H),R=te(R,I)}return new ie(D,R)}n.B=function(R){return he(this,R).h},n.and=function(R){const E=Math.max(this.g.length,R.g.length),M=[];for(let B=0;B<E;B++)M[B]=this.i(B)&R.i(B);return new d(M,this.h&R.h)},n.or=function(R){const E=Math.max(this.g.length,R.g.length),M=[];for(let B=0;B<E;B++)M[B]=this.i(B)|R.i(B);return new d(M,this.h|R.h)},n.xor=function(R){const E=Math.max(this.g.length,R.g.length),M=[];for(let B=0;B<E;B++)M[B]=this.i(B)^R.i(B);return new d(M,this.h^R.h)};function Ne(R){const E=R.g.length+1,M=[];for(let B=0;B<E;B++)M[B]=R.i(B)<<1|R.i(B-1)>>>31;return new d(M,R.h)}function fe(R,E){const M=E>>5;E%=32;const B=R.g.length-M,D=[];for(let H=0;H<B;H++)D[H]=E>0?R.i(H+M)>>>E|R.i(H+M+1)<<32-E:R.i(H+M);return new d(D,R.h)}i.prototype.digest=i.prototype.A,i.prototype.reset=i.prototype.u,i.prototype.update=i.prototype.v,Gw=i,d.prototype.add=d.prototype.add,d.prototype.multiply=d.prototype.j,d.prototype.modulo=d.prototype.B,d.prototype.compare=d.prototype.l,d.prototype.toNumber=d.prototype.m,d.prototype.toString=d.prototype.toString,d.prototype.getBits=d.prototype.i,d.fromNumber=y,d.fromString=x,io=d}).apply(typeof gx<"u"?gx:typeof self<"u"?self:typeof window<"u"?window:{});var sh=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var Kw,au,Yw,wh,pg,Qw,Xw,Jw;(function(){var n,e=Object.defineProperty;function t(h){h=[typeof globalThis=="object"&&globalThis,h,typeof window=="object"&&window,typeof self=="object"&&self,typeof sh=="object"&&sh];for(var b=0;b<h.length;++b){var _=h[b];if(_&&_.Math==Math)return _}throw Error("Cannot find global object")}var i=t(this);function l(h,b){if(b)e:{var _=i;h=h.split(".");for(var A=0;A<h.length-1;A++){var ae=h[A];if(!(ae in _))break e;_=_[ae]}h=h[h.length-1],A=_[h],b=b(A),b!=A&&b!=null&&e(_,h,{configurable:!0,writable:!0,value:b})}}l("Symbol.dispose",function(h){return h||Symbol("Symbol.dispose")}),l("Array.prototype.values",function(h){return h||function(){return this[Symbol.iterator]()}}),l("Object.entries",function(h){return h||function(b){var _=[],A;for(A in b)Object.prototype.hasOwnProperty.call(b,A)&&_.push([A,b[A]]);return _}});var u=u||{},d=this||self;function p(h){var b=typeof h;return b=="object"&&h!=null||b=="function"}function g(h,b,_){return h.call.apply(h.bind,arguments)}function y(h,b,_){return y=g,y.apply(null,arguments)}function x(h,b){var _=Array.prototype.slice.call(arguments,1);return function(){var A=_.slice();return A.push.apply(A,arguments),h.apply(this,A)}}function k(h,b){function _(){}_.prototype=b.prototype,h.Z=b.prototype,h.prototype=new _,h.prototype.constructor=h,h.Ob=function(A,ae,pe){for(var Ze=Array(arguments.length-2),ss=2;ss<arguments.length;ss++)Ze[ss-2]=arguments[ss];return b.prototype[ae].apply(A,Ze)}}var T=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?h=>h&&AsyncContext.Snapshot.wrap(h):h=>h;function O(h){const b=h.length;if(b>0){const _=Array(b);for(let A=0;A<b;A++)_[A]=h[A];return _}return[]}function G(h,b){for(let A=1;A<arguments.length;A++){const ae=arguments[A];var _=typeof ae;if(_=_!="object"?_:ae?Array.isArray(ae)?"array":_:"null",_=="array"||_=="object"&&typeof ae.length=="number"){_=h.length||0;const pe=ae.length||0;h.length=_+pe;for(let Ze=0;Ze<pe;Ze++)h[_+Ze]=ae[Ze]}else h.push(ae)}}class F{constructor(b,_){this.i=b,this.j=_,this.h=0,this.g=null}get(){let b;return this.h>0?(this.h--,b=this.g,this.g=b.next,b.next=null):b=this.i(),b}}function V(h){d.setTimeout(()=>{throw h},0)}function te(){var h=R;let b=null;return h.g&&(b=h.g,h.g=h.g.next,h.g||(h.h=null),b.next=null),b}class Y{constructor(){this.h=this.g=null}add(b,_){const A=ie.get();A.set(b,_),this.h?this.h.next=A:this.g=A,this.h=A}}var ie=new F(()=>new he,h=>h.reset());class he{constructor(){this.next=this.g=this.h=null}set(b,_){this.h=b,this.g=_,this.next=null}reset(){this.next=this.g=this.h=null}}let Ne,fe=!1,R=new Y,E=()=>{const h=Promise.resolve(void 0);Ne=()=>{h.then(M)}};function M(){for(var h;h=te();){try{h.h.call(h.g)}catch(_){V(_)}var b=ie;b.j(h),b.h<100&&(b.h++,h.next=b.g,b.g=h)}fe=!1}function B(){this.u=this.u,this.C=this.C}B.prototype.u=!1,B.prototype.dispose=function(){this.u||(this.u=!0,this.N())},B.prototype[Symbol.dispose]=function(){this.dispose()},B.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function D(h,b){this.type=h,this.g=this.target=b,this.defaultPrevented=!1}D.prototype.h=function(){this.defaultPrevented=!0};var H=(function(){if(!d.addEventListener||!Object.defineProperty)return!1;var h=!1,b=Object.defineProperty({},"passive",{get:function(){h=!0}});try{const _=()=>{};d.addEventListener("test",_,b),d.removeEventListener("test",_,b)}catch{}return h})();function I(h){return/^[\s\xa0]*$/.test(h)}function ze(h,b){D.call(this,h?h.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,h&&this.init(h,b)}k(ze,D),ze.prototype.init=function(h,b){const _=this.type=h.type,A=h.changedTouches&&h.changedTouches.length?h.changedTouches[0]:null;this.target=h.target||h.srcElement,this.g=b,b=h.relatedTarget,b||(_=="mouseover"?b=h.fromElement:_=="mouseout"&&(b=h.toElement)),this.relatedTarget=b,A?(this.clientX=A.clientX!==void 0?A.clientX:A.pageX,this.clientY=A.clientY!==void 0?A.clientY:A.pageY,this.screenX=A.screenX||0,this.screenY=A.screenY||0):(this.clientX=h.clientX!==void 0?h.clientX:h.pageX,this.clientY=h.clientY!==void 0?h.clientY:h.pageY,this.screenX=h.screenX||0,this.screenY=h.screenY||0),this.button=h.button,this.key=h.key||"",this.ctrlKey=h.ctrlKey,this.altKey=h.altKey,this.shiftKey=h.shiftKey,this.metaKey=h.metaKey,this.pointerId=h.pointerId||0,this.pointerType=h.pointerType,this.state=h.state,this.i=h,h.defaultPrevented&&ze.Z.h.call(this)},ze.prototype.h=function(){ze.Z.h.call(this);const h=this.i;h.preventDefault?h.preventDefault():h.returnValue=!1};var mt="closure_listenable_"+(Math.random()*1e6|0),W=0;function ue(h,b,_,A,ae){this.listener=h,this.proxy=null,this.src=b,this.type=_,this.capture=!!A,this.ha=ae,this.key=++W,this.da=this.fa=!1}function Re(h){h.da=!0,h.listener=null,h.proxy=null,h.src=null,h.ha=null}function Le(h,b,_){for(const A in h)b.call(_,h[A],A,h)}function Z(h,b){for(const _ in h)b.call(void 0,h[_],_,h)}function L(h){const b={};for(const _ in h)b[_]=h[_];return b}const ne="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Ie(h,b){let _,A;for(let ae=1;ae<arguments.length;ae++){A=arguments[ae];for(_ in A)h[_]=A[_];for(let pe=0;pe<ne.length;pe++)_=ne[pe],Object.prototype.hasOwnProperty.call(A,_)&&(h[_]=A[_])}}function de(h){this.src=h,this.g={},this.h=0}de.prototype.add=function(h,b,_,A,ae){const pe=h.toString();h=this.g[pe],h||(h=this.g[pe]=[],this.h++);const Ze=Me(h,b,A,ae);return Ze>-1?(b=h[Ze],_||(b.fa=!1)):(b=new ue(b,this.src,pe,!!A,ae),b.fa=_,h.push(b)),b};function qe(h,b){const _=b.type;if(_ in h.g){var A=h.g[_],ae=Array.prototype.indexOf.call(A,b,void 0),pe;(pe=ae>=0)&&Array.prototype.splice.call(A,ae,1),pe&&(Re(b),h.g[_].length==0&&(delete h.g[_],h.h--))}}function Me(h,b,_,A){for(let ae=0;ae<h.length;++ae){const pe=h[ae];if(!pe.da&&pe.listener==b&&pe.capture==!!_&&pe.ha==A)return ae}return-1}var ot="closure_lm_"+(Math.random()*1e6|0),ft={};function Qe(h,b,_,A,ae){if(Array.isArray(b)){for(let pe=0;pe<b.length;pe++)Qe(h,b[pe],_,A,ae);return null}return _=Et(_),h&&h[mt]?h.J(b,_,p(A)?!!A.capture:!1,ae):Vt(h,b,_,!1,A,ae)}function Vt(h,b,_,A,ae,pe){if(!b)throw Error("Invalid event type");const Ze=p(ae)?!!ae.capture:!!ae;let ss=vt(h);if(ss||(h[ot]=ss=new de(h)),_=ss.add(b,_,A,Ze,pe),_.proxy)return _;if(A=Ls(),_.proxy=A,A.src=h,A.listener=_,h.addEventListener)H||(ae=Ze),ae===void 0&&(ae=!1),h.addEventListener(b.toString(),A,ae);else if(h.attachEvent)h.attachEvent(re(b.toString()),A);else if(h.addListener&&h.removeListener)h.addListener(A);else throw Error("addEventListener and attachEvent are unavailable.");return _}function Ls(){function h(_){return b.call(h.src,h.listener,_)}const b=Nt;return h}function jt(h,b,_,A,ae){if(Array.isArray(b))for(var pe=0;pe<b.length;pe++)jt(h,b[pe],_,A,ae);else A=p(A)?!!A.capture:!!A,_=Et(_),h&&h[mt]?(h=h.i,pe=String(b).toString(),pe in h.g&&(b=h.g[pe],_=Me(b,_,A,ae),_>-1&&(Re(b[_]),Array.prototype.splice.call(b,_,1),b.length==0&&(delete h.g[pe],h.h--)))):h&&(h=vt(h))&&(b=h.g[b.toString()],h=-1,b&&(h=Me(b,_,A,ae)),(_=h>-1?b[h]:null)&&yt(_))}function yt(h){if(typeof h!="number"&&h&&!h.da){var b=h.src;if(b&&b[mt])qe(b.i,h);else{var _=h.type,A=h.proxy;b.removeEventListener?b.removeEventListener(_,A,h.capture):b.detachEvent?b.detachEvent(re(_),A):b.addListener&&b.removeListener&&b.removeListener(A),(_=vt(b))?(qe(_,h),_.h==0&&(_.src=null,b[ot]=null)):Re(h)}}}function re(h){return h in ft?ft[h]:ft[h]="on"+h}function Nt(h,b){if(h.da)h=!0;else{b=new ze(b,this);const _=h.listener,A=h.ha||h.src;h.fa&&yt(h),h=_.call(A,b)}return h}function vt(h){return h=h[ot],h instanceof de?h:null}var Pt="__closure_events_fn_"+(Math.random()*1e9>>>0);function Et(h){return typeof h=="function"?h:(h[Pt]||(h[Pt]=function(b){return h.handleEvent(b)}),h[Pt])}function ut(){B.call(this),this.i=new de(this),this.M=this,this.G=null}k(ut,B),ut.prototype[mt]=!0,ut.prototype.removeEventListener=function(h,b,_,A){jt(this,h,b,_,A)};function Ye(h,b){var _,A=h.G;if(A)for(_=[];A;A=A.G)_.push(A);if(h=h.M,A=b.type||b,typeof b=="string")b=new D(b,h);else if(b instanceof D)b.target=b.target||h;else{var ae=b;b=new D(A,h),Ie(b,ae)}ae=!0;let pe,Ze;if(_)for(Ze=_.length-1;Ze>=0;Ze--)pe=b.g=_[Ze],ae=It(pe,A,!0,b)&&ae;if(pe=b.g=h,ae=It(pe,A,!0,b)&&ae,ae=It(pe,A,!1,b)&&ae,_)for(Ze=0;Ze<_.length;Ze++)pe=b.g=_[Ze],ae=It(pe,A,!1,b)&&ae}ut.prototype.N=function(){if(ut.Z.N.call(this),this.i){var h=this.i;for(const b in h.g){const _=h.g[b];for(let A=0;A<_.length;A++)Re(_[A]);delete h.g[b],h.h--}}this.G=null},ut.prototype.J=function(h,b,_,A){return this.i.add(String(h),b,!1,_,A)},ut.prototype.K=function(h,b,_,A){return this.i.add(String(h),b,!0,_,A)};function It(h,b,_,A){if(b=h.i.g[String(b)],!b)return!0;b=b.concat();let ae=!0;for(let pe=0;pe<b.length;++pe){const Ze=b[pe];if(Ze&&!Ze.da&&Ze.capture==_){const ss=Ze.listener,En=Ze.ha||Ze.src;Ze.fa&&qe(h.i,Ze),ae=ss.call(En,A)!==!1&&ae}}return ae&&!A.defaultPrevented}function Xt(h,b){if(typeof h!="function")if(h&&typeof h.handleEvent=="function")h=y(h.handleEvent,h);else throw Error("Invalid listener argument");return Number(b)>2147483647?-1:d.setTimeout(h,b||0)}function Ks(h){h.g=Xt(()=>{h.g=null,h.i&&(h.i=!1,Ks(h))},h.l);const b=h.h;h.h=null,h.m.apply(null,b)}class Ut extends B{constructor(b,_){super(),this.m=b,this.l=_,this.h=null,this.i=!1,this.g=null}j(b){this.h=arguments,this.g?this.i=!0:Ks(this)}N(){super.N(),this.g&&(d.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Mt(h){B.call(this),this.h=h,this.g={}}k(Mt,B);var is=[];function Ms(h){Le(h.g,function(b,_){this.g.hasOwnProperty(_)&&yt(b)},h),h.g={}}Mt.prototype.N=function(){Mt.Z.N.call(this),Ms(this)},Mt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Kt=d.JSON.stringify,on=d.JSON.parse,ds=class{stringify(h){return d.JSON.stringify(h,void 0)}parse(h){return d.JSON.parse(h,void 0)}};function _s(){}function Ct(){}var be={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Te(){D.call(this,"d")}k(Te,D);function Be(){D.call(this,"c")}k(Be,D);var Ue={},J=null;function ge(){return J=J||new ut}Ue.Ia="serverreachability";function We(h){D.call(this,Ue.Ia,h)}k(We,D);function Ke(h){const b=ge();Ye(b,new We(b))}Ue.STAT_EVENT="statevent";function z(h,b){D.call(this,Ue.STAT_EVENT,h),this.stat=b}k(z,D);function se(h){const b=ge();Ye(b,new z(b,h))}Ue.Ja="timingevent";function Ge(h,b){D.call(this,Ue.Ja,h),this.size=b}k(Ge,D);function He(h,b){if(typeof h!="function")throw Error("Fn must not be null and must be a function");return d.setTimeout(function(){h()},b)}function Xe(){this.g=!0}Xe.prototype.ua=function(){this.g=!1};function lt(h,b,_,A,ae,pe){h.info(function(){if(h.g)if(pe){var Ze="",ss=pe.split("&");for(let Os=0;Os<ss.length;Os++){var En=ss[Os].split("=");if(En.length>1){const dn=En[0];En=En[1];const ea=dn.split("_");Ze=ea.length>=2&&ea[1]=="type"?Ze+(dn+"="+En+"&"):Ze+(dn+"=redacted&")}}}else Ze=null;else Ze=pe;return"XMLHTTP REQ ("+A+") [attempt "+ae+"]: "+b+`
`+_+`
`+Ze})}function _t(h,b,_,A,ae,pe,Ze){h.info(function(){return"XMLHTTP RESP ("+A+") [ attempt "+ae+"]: "+b+`
`+_+`
`+pe+" "+Ze})}function pt(h,b,_,A){h.info(function(){return"XMLHTTP TEXT ("+b+"): "+en(h,_)+(A?" "+A:"")})}function Wt(h,b){h.info(function(){return"TIMEOUT: "+b})}Xe.prototype.info=function(){};function en(h,b){if(!h.g)return b;if(!b)return null;try{const pe=JSON.parse(b);if(pe){for(h=0;h<pe.length;h++)if(Array.isArray(pe[h])){var _=pe[h];if(!(_.length<2)){var A=_[1];if(Array.isArray(A)&&!(A.length<1)){var ae=A[0];if(ae!="noop"&&ae!="stop"&&ae!="close")for(let Ze=1;Ze<A.length;Ze++)A[Ze]=""}}}}return Kt(pe)}catch{return b}}var ts={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},ks={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},zs;function $(){}k($,_s),$.prototype.g=function(){return new XMLHttpRequest},zs=new $;function we(h){return encodeURIComponent(String(h))}function Se(h){var b=1;h=h.split(":");const _=[];for(;b>0&&h.length;)_.push(h.shift()),b--;return h.length&&_.push(h.join(":")),_}function Ee(h,b,_,A){this.j=h,this.i=b,this.l=_,this.S=A||1,this.V=new Mt(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new ke}function ke(){this.i=null,this.g="",this.h=!1}var dt={},bt={};function st(h,b,_){h.M=1,h.A=Cr(cs(b)),h.u=_,h.R=!0,St(h,null)}function St(h,b){h.F=Date.now(),yn(h),h.B=cs(h.A);var _=h.B,A=h.S;Array.isArray(A)||(A=[String(A)]),Us(_.i,"t",A),h.C=0,_=h.j.L,h.h=new ke,h.g=ma(h.j,_?b:null,!h.u),h.P>0&&(h.O=new Ut(y(h.Y,h,h.g),h.P)),b=h.V,_=h.g,A=h.ba;var ae="readystatechange";Array.isArray(ae)||(ae&&(is[0]=ae.toString()),ae=is);for(let pe=0;pe<ae.length;pe++){const Ze=Qe(_,ae[pe],A||b.handleEvent,!1,b.h||b);if(!Ze)break;b.g[Ze.key]=Ze}b=h.J?L(h.J):{},h.u?(h.v||(h.v="POST"),b["Content-Type"]="application/x-www-form-urlencoded",h.g.ea(h.B,h.v,h.u,b)):(h.v="GET",h.g.ea(h.B,h.v,null,b)),Ke(),lt(h.i,h.v,h.B,h.l,h.S,h.u)}Ee.prototype.ba=function(h){h=h.target;const b=this.O;b&&Lt(h)==3?b.j():this.Y(h)},Ee.prototype.Y=function(h){try{if(h==this.g)e:{const ss=Lt(this.g),En=this.g.ya(),Os=this.g.ca();if(!(ss<3)&&(ss!=3||this.g&&(this.h.h||this.g.la()||Dt(this.g)))){this.K||ss!=4||En==7||(En==8||Os<=0?Ke(3):Ke(2)),bn(this);var b=this.g.ca();this.X=b;var _=xt(this);if(this.o=b==200,_t(this.i,this.v,this.B,this.l,this.S,ss,b),this.o){if(this.U&&!this.L){t:{if(this.g){var A,ae=this.g;if((A=ae.g?ae.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!I(A)){var pe=A;break t}}pe=null}if(h=pe)pt(this.i,this.l,h,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,j(this,h);else{this.o=!1,this.m=3,se(12),qs(this),rn(this);break e}}if(this.R){h=!0;let dn;for(;!this.K&&this.C<_.length;)if(dn=Tn(this,_),dn==bt){ss==4&&(this.m=4,se(14),h=!1),pt(this.i,this.l,null,"[Incomplete Response]");break}else if(dn==dt){this.m=4,se(15),pt(this.i,this.l,_,"[Invalid Chunk]"),h=!1;break}else pt(this.i,this.l,dn,null),j(this,dn);if(hs(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),ss!=4||_.length!=0||this.h.h||(this.m=1,se(16),h=!1),this.o=this.o&&h,!h)pt(this.i,this.l,_,"[Invalid Chunked Response]"),qs(this),rn(this);else if(_.length>0&&!this.W){this.W=!0;var Ze=this.j;Ze.g==this&&Ze.aa&&!Ze.P&&(Ze.j.info("Great, no buffering proxy detected. Bytes received: "+_.length),er(Ze),Ze.P=!0,se(11))}}else pt(this.i,this.l,_,null),j(this,_);ss==4&&qs(this),this.o&&!this.K&&(ss==4?Ar(this.j,this):(this.o=!1,yn(this)))}else us(this.g),b==400&&_.indexOf("Unknown SID")>0?(this.m=3,se(12)):(this.m=0,se(13)),qs(this),rn(this)}}}catch{}};function xt(h){if(!hs(h))return h.g.la();const b=Dt(h.g);if(b==="")return"";let _="";const A=b.length,ae=Lt(h.g)==4;if(!h.h.i){if(typeof TextDecoder>"u")return qs(h),rn(h),"";h.h.i=new d.TextDecoder}for(let pe=0;pe<A;pe++)h.h.h=!0,_+=h.h.i.decode(b[pe],{stream:!(ae&&pe==A-1)});return b.length=0,h.h.g+=_,h.C=0,h.h.g}function hs(h){return h.g?h.v=="GET"&&h.M!=2&&h.j.Aa:!1}function Tn(h,b){var _=h.C,A=b.indexOf(`
`,_);return A==-1?bt:(_=Number(b.substring(_,A)),isNaN(_)?dt:(A+=1,A+_>b.length?bt:(b=b.slice(A,A+_),h.C=A+_,b)))}Ee.prototype.cancel=function(){this.K=!0,qs(this)};function yn(h){h.T=Date.now()+h.H,Rn(h,h.H)}function Rn(h,b){if(h.D!=null)throw Error("WatchDog timer not null");h.D=He(y(h.aa,h),b)}function bn(h){h.D&&(d.clearTimeout(h.D),h.D=null)}Ee.prototype.aa=function(){this.D=null;const h=Date.now();h-this.T>=0?(Wt(this.i,this.B),this.M!=2&&(Ke(),se(17)),qs(this),this.m=2,rn(this)):Rn(this,this.T-h)};function rn(h){h.j.I==0||h.K||Ar(h.j,h)}function qs(h){bn(h);var b=h.O;b&&typeof b.dispose=="function"&&b.dispose(),h.O=null,Ms(h.V),h.g&&(b=h.g,h.g=null,b.abort(),b.dispose())}function j(h,b){try{var _=h.j;if(_.I!=0&&(_.g==h||Ve(_.h,h))){if(!h.L&&Ve(_.h,h)&&_.I==3){try{var A=_.Ba.g.parse(b)}catch{A=null}if(Array.isArray(A)&&A.length==3){var ae=A;if(ae[0]==0){e:if(!_.v){if(_.g)if(_.g.F+3e3<h.F)hr(_),vr(_);else break e;Xn(_),se(18)}}else _.xa=ae[1],0<_.xa-_.K&&ae[2]<37500&&_.F&&_.A==0&&!_.C&&(_.C=He(y(_.Va,_),6e3));ye(_.h)<=1&&_.ta&&(_.ta=void 0)}else Zr(_,11)}else if((h.L||_.g==h)&&hr(_),!I(b))for(ae=_.Ba.g.parse(b),b=0;b<ae.length;b++){let Os=ae[b];const dn=Os[0];if(!(dn<=_.K))if(_.K=dn,Os=Os[1],_.I==2)if(Os[0]=="c"){_.M=Os[1],_.ba=Os[2];const ea=Os[3];ea!=null&&(_.ka=ea,_.j.info("VER="+_.ka));const Aa=Os[4];Aa!=null&&(_.za=Aa,_.j.info("SVER="+_.za));const pa=Os[5];pa!=null&&typeof pa=="number"&&pa>0&&(A=1.5*pa,_.O=A,_.j.info("backChannelRequestTimeoutMs_="+A)),A=_;const ga=h.g;if(ga){const wo=ga.g?ga.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(wo){var pe=A.h;pe.g||wo.indexOf("spdy")==-1&&wo.indexOf("quic")==-1&&wo.indexOf("h2")==-1||(pe.j=pe.l,pe.g=new Set,pe.h&&(Oe(pe,pe.h),pe.h=null))}if(A.G){const al=ga.g?ga.g.getResponseHeader("X-HTTP-Session-Id"):null;al&&(A.wa=al,gs(A.J,A.G,al))}}_.I=3,_.l&&_.l.ra(),_.aa&&(_.T=Date.now()-h.F,_.j.info("Handshake RTT: "+_.T+"ms")),A=_;var Ze=h;if(A.na=Ya(A,A.L?A.ba:null,A.W),Ze.L){et(A.h,Ze);var ss=Ze,En=A.O;En&&(ss.H=En),ss.D&&(bn(ss),yn(ss)),A.g=Ze}else Rr(A);_.i.length>0&&$s(_)}else Os[0]!="stop"&&Os[0]!="close"||Zr(_,7);else _.I==3&&(Os[0]=="stop"||Os[0]=="close"?Os[0]=="stop"?Zr(_,7):zr(_):Os[0]!="noop"&&_.l&&_.l.qa(Os),_.A=0)}}Ke(4)}catch{}}var C=class{constructor(h,b){this.g=h,this.map=b}};function P(h){this.l=h||10,d.PerformanceNavigationTiming?(h=d.performance.getEntriesByType("navigation"),h=h.length>0&&(h[0].nextHopProtocol=="hq"||h[0].nextHopProtocol=="h2")):h=!!(d.chrome&&d.chrome.loadTimes&&d.chrome.loadTimes()&&d.chrome.loadTimes().wasFetchedViaSpdy),this.j=h?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function U(h){return h.h?!0:h.g?h.g.size>=h.j:!1}function ye(h){return h.h?1:h.g?h.g.size:0}function Ve(h,b){return h.h?h.h==b:h.g?h.g.has(b):!1}function Oe(h,b){h.g?h.g.add(b):h.h=b}function et(h,b){h.h&&h.h==b?h.h=null:h.g&&h.g.has(b)&&h.g.delete(b)}P.prototype.cancel=function(){if(this.i=nt(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const h of this.g.values())h.cancel();this.g.clear()}};function nt(h){if(h.h!=null)return h.i.concat(h.h.G);if(h.g!=null&&h.g.size!==0){let b=h.i;for(const _ of h.g.values())b=b.concat(_.G);return b}return O(h.i)}var as=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Cs(h,b){if(h){h=h.split("&");for(let _=0;_<h.length;_++){const A=h[_].indexOf("=");let ae,pe=null;A>=0?(ae=h[_].substring(0,A),pe=h[_].substring(A+1)):ae=h[_],b(ae,pe?decodeURIComponent(pe.replace(/\+/g," ")):"")}}}function ls(h){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let b;h instanceof ls?(this.l=h.l,Hs(this,h.j),this.o=h.o,this.g=h.g,fn(this,h.u),this.h=h.h,Ur(this,In(h.i)),this.m=h.m):h&&(b=String(h).match(as))?(this.l=!1,Hs(this,b[1]||"",!0),this.o=An(b[2]||""),this.g=An(b[3]||"",!0),fn(this,b[4]),this.h=An(b[5]||"",!0),Ur(this,b[6]||"",!0),this.m=An(b[7]||"")):(this.l=!1,this.i=new $t(null,this.l))}ls.prototype.toString=function(){const h=[];var b=this.j;b&&h.push(Q(b,_e,!0),":");var _=this.g;return(_||b=="file")&&(h.push("//"),(b=this.o)&&h.push(Q(b,_e,!0),"@"),h.push(we(_).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),_=this.u,_!=null&&h.push(":",String(_))),(_=this.h)&&(this.g&&_.charAt(0)!="/"&&h.push("/"),h.push(Q(_,_.charAt(0)=="/"?Je:tt,!0))),(_=this.i.toString())&&h.push("?",_),(_=this.m)&&h.push("#",Q(_,Ht)),h.join("")},ls.prototype.resolve=function(h){const b=cs(this);let _=!!h.j;_?Hs(b,h.j):_=!!h.o,_?b.o=h.o:_=!!h.g,_?b.g=h.g:_=h.u!=null;var A=h.h;if(_)fn(b,h.u);else if(_=!!h.h){if(A.charAt(0)!="/")if(this.g&&!this.h)A="/"+A;else{var ae=b.h.lastIndexOf("/");ae!=-1&&(A=b.h.slice(0,ae+1)+A)}if(ae=A,ae==".."||ae==".")A="";else if(ae.indexOf("./")!=-1||ae.indexOf("/.")!=-1){A=ae.lastIndexOf("/",0)==0,ae=ae.split("/");const pe=[];for(let Ze=0;Ze<ae.length;){const ss=ae[Ze++];ss=="."?A&&Ze==ae.length&&pe.push(""):ss==".."?((pe.length>1||pe.length==1&&pe[0]!="")&&pe.pop(),A&&Ze==ae.length&&pe.push("")):(pe.push(ss),A=!0)}A=pe.join("/")}else A=ae}return _?b.h=A:_=h.i.toString()!=="",_?Ur(b,In(h.i)):_=!!h.m,_&&(b.m=h.m),b};function cs(h){return new ls(h)}function Hs(h,b,_){h.j=_?An(b,!0):b,h.j&&(h.j=h.j.replace(/:$/,""))}function fn(h,b){if(b){if(b=Number(b),isNaN(b)||b<0)throw Error("Bad port number "+b);h.u=b}else h.u=null}function Ur(h,b,_){b instanceof $t?(h.i=b,Ys(h.i,h.l)):(_||(b=Q(b,ct)),h.i=new $t(b,h.l))}function gs(h,b,_){h.i.set(b,_)}function Cr(h){return gs(h,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),h}function An(h,b){return h?b?decodeURI(h.replace(/%25/g,"%2525")):decodeURIComponent(h):""}function Q(h,b,_){return typeof h=="string"?(h=encodeURI(h).replace(b,ve),_&&(h=h.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),h):null}function ve(h){return h=h.charCodeAt(0),"%"+(h>>4&15).toString(16)+(h&15).toString(16)}var _e=/[#\/\?@]/g,tt=/[#\?:]/g,Je=/[#\?]/g,ct=/[#\?@]/g,Ht=/#/g;function $t(h,b){this.h=this.g=null,this.i=h||null,this.j=!!b}function Yt(h){h.g||(h.g=new Map,h.h=0,h.i&&Cs(h.i,function(b,_){h.add(decodeURIComponent(b.replace(/\+/g," ")),_)}))}n=$t.prototype,n.add=function(h,b){Yt(this),this.i=null,h=Rs(this,h);let _=this.g.get(h);return _||this.g.set(h,_=[]),_.push(b),this.h+=1,this};function Mn(h,b){Yt(h),b=Rs(h,b),h.g.has(b)&&(h.i=null,h.h-=h.g.get(b).length,h.g.delete(b))}function Gt(h,b){return Yt(h),b=Rs(h,b),h.g.has(b)}n.forEach=function(h,b){Yt(this),this.g.forEach(function(_,A){_.forEach(function(ae){h.call(b,ae,A,this)},this)},this)};function Vs(h,b){Yt(h);let _=[];if(typeof b=="string")Gt(h,b)&&(_=_.concat(h.g.get(Rs(h,b))));else for(h=Array.from(h.g.values()),b=0;b<h.length;b++)_=_.concat(h[b]);return _}n.set=function(h,b){return Yt(this),this.i=null,h=Rs(this,h),Gt(this,h)&&(this.h-=this.g.get(h).length),this.g.set(h,[b]),this.h+=1,this},n.get=function(h,b){return h?(h=Vs(this,h),h.length>0?String(h[0]):b):b};function Us(h,b,_){Mn(h,b),_.length>0&&(h.i=null,h.g.set(Rs(h,b),O(_)),h.h+=_.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const h=[],b=Array.from(this.g.keys());for(let A=0;A<b.length;A++){var _=b[A];const ae=we(_);_=Vs(this,_);for(let pe=0;pe<_.length;pe++){let Ze=ae;_[pe]!==""&&(Ze+="="+we(_[pe])),h.push(Ze)}}return this.i=h.join("&")};function In(h){const b=new $t;return b.i=h.i,h.g&&(b.g=new Map(h.g),b.h=h.h),b}function Rs(h,b){return b=String(b),h.j&&(b=b.toLowerCase()),b}function Ys(h,b){b&&!h.j&&(Yt(h),h.i=null,h.g.forEach(function(_,A){const ae=A.toLowerCase();A!=ae&&(Mn(this,A),Us(this,ae,_))},h)),h.j=b}function Jt(h,b){const _=new Xe;if(d.Image){const A=new Image;A.onload=x(pn,_,"TestLoadImage: loaded",!0,b,A),A.onerror=x(pn,_,"TestLoadImage: error",!1,b,A),A.onabort=x(pn,_,"TestLoadImage: abort",!1,b,A),A.ontimeout=x(pn,_,"TestLoadImage: timeout",!1,b,A),d.setTimeout(function(){A.ontimeout&&A.ontimeout()},1e4),A.src=h}else b(!1)}function ln(h,b){const _=new Xe,A=new AbortController,ae=setTimeout(()=>{A.abort(),pn(_,"TestPingServer: timeout",!1,b)},1e4);fetch(h,{signal:A.signal}).then(pe=>{clearTimeout(ae),pe.ok?pn(_,"TestPingServer: ok",!0,b):pn(_,"TestPingServer: server error",!1,b)}).catch(()=>{clearTimeout(ae),pn(_,"TestPingServer: error",!1,b)})}function pn(h,b,_,A,ae){try{ae&&(ae.onload=null,ae.onerror=null,ae.onabort=null,ae.ontimeout=null),A(_)}catch{}}function zn(){this.g=new ds}function Gn(h){this.i=h.Sb||null,this.h=h.ab||!1}k(Gn,_s),Gn.prototype.g=function(){return new vn(this.i,this.h)};function vn(h,b){ut.call(this),this.H=h,this.o=b,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}k(vn,ut),n=vn.prototype,n.open=function(h,b){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=h,this.D=b,this.readyState=1,ur(this)},n.send=function(h){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const b={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};h&&(b.body=h),(this.H||d).fetch(new Request(this.D,b)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,cr(this)),this.readyState=0},n.Pa=function(h){if(this.g&&(this.l=h,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=h.headers,this.readyState=2,ur(this)),this.g&&(this.readyState=3,ur(this),this.g)))if(this.responseType==="arraybuffer")h.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof d.ReadableStream<"u"&&"body"in h){if(this.j=h.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Kn(this)}else h.text().then(this.Oa.bind(this),this.ga.bind(this))};function Kn(h){h.j.read().then(h.Ma.bind(h)).catch(h.ga.bind(h))}n.Ma=function(h){if(this.g){if(this.o&&h.value)this.response.push(h.value);else if(!this.o){var b=h.value?h.value:new Uint8Array(0);(b=this.B.decode(b,{stream:!h.done}))&&(this.response=this.responseText+=b)}h.done?cr(this):ur(this),this.readyState==3&&Kn(this)}},n.Oa=function(h){this.g&&(this.response=this.responseText=h,cr(this))},n.Na=function(h){this.g&&(this.response=h,cr(this))},n.ga=function(){this.g&&cr(this)};function cr(h){h.readyState=4,h.l=null,h.j=null,h.B=null,ur(h)}n.setRequestHeader=function(h,b){this.A.append(h,b)},n.getResponseHeader=function(h){return this.h&&this.h.get(h.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const h=[],b=this.h.entries();for(var _=b.next();!_.done;)_=_.value,h.push(_[0]+": "+_[1]),_=b.next();return h.join(`\r
`)};function ur(h){h.onreadystatechange&&h.onreadystatechange.call(h)}Object.defineProperty(vn.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(h){this.m=h?"include":"same-origin"}});function dr(h){let b="";return Le(h,function(_,A){b+=A,b+=":",b+=_,b+=`\r
`}),b}function Fr(h,b,_){e:{for(A in _){var A=!1;break e}A=!0}A||(_=dr(_),typeof h=="string"?_!=null&&we(_):gs(h,b,_))}function N(h){ut.call(this),this.headers=new Map,this.L=h||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}k(N,ut);var X=/^https?$/i,Fe=["POST","PUT"];n=N.prototype,n.Fa=function(h){this.H=h},n.ea=function(h,b,_,A){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+h);b=b?b.toUpperCase():"GET",this.D=h,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():zs.g(),this.g.onreadystatechange=T(y(this.Ca,this));try{this.B=!0,this.g.open(b,String(h),!0),this.B=!1}catch(pe){it(this,pe);return}if(h=_||"",_=new Map(this.headers),A)if(Object.getPrototypeOf(A)===Object.prototype)for(var ae in A)_.set(ae,A[ae]);else if(typeof A.keys=="function"&&typeof A.get=="function")for(const pe of A.keys())_.set(pe,A.get(pe));else throw Error("Unknown input type for opt_headers: "+String(A));A=Array.from(_.keys()).find(pe=>pe.toLowerCase()=="content-type"),ae=d.FormData&&h instanceof d.FormData,!(Array.prototype.indexOf.call(Fe,b,void 0)>=0)||A||ae||_.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[pe,Ze]of _)this.g.setRequestHeader(pe,Ze);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(h),this.v=!1}catch(pe){it(this,pe)}};function it(h,b){h.h=!1,h.g&&(h.j=!0,h.g.abort(),h.j=!1),h.l=b,h.o=5,Tt(h),rt(h)}function Tt(h){h.A||(h.A=!0,Ye(h,"complete"),Ye(h,"error"))}n.abort=function(h){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=h||7,Ye(this,"complete"),Ye(this,"abort"),rt(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),rt(this,!0)),N.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?Bt(this):this.Xa())},n.Xa=function(){Bt(this)};function Bt(h){if(h.h&&typeof u<"u"){if(h.v&&Lt(h)==4)setTimeout(h.Ca.bind(h),0);else if(Ye(h,"readystatechange"),Lt(h)==4){h.h=!1;try{const pe=h.ca();e:switch(pe){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var b=!0;break e;default:b=!1}var _;if(!(_=b)){var A;if(A=pe===0){let Ze=String(h.D).match(as)[1]||null;!Ze&&d.self&&d.self.location&&(Ze=d.self.location.protocol.slice(0,-1)),A=!X.test(Ze?Ze.toLowerCase():"")}_=A}if(_)Ye(h,"complete"),Ye(h,"success");else{h.o=6;try{var ae=Lt(h)>2?h.g.statusText:""}catch{ae=""}h.l=ae+" ["+h.ca()+"]",Tt(h)}}finally{rt(h)}}}}function rt(h,b){if(h.g){h.m&&(clearTimeout(h.m),h.m=null);const _=h.g;h.g=null,b||Ye(h,"ready");try{_.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function Lt(h){return h.g?h.g.readyState:0}n.ca=function(){try{return Lt(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(h){if(this.g){var b=this.g.responseText;return h&&b.indexOf(h)==0&&(b=b.substring(h.length)),on(b)}};function Dt(h){try{if(!h.g)return null;if("response"in h.g)return h.g.response;switch(h.F){case"":case"text":return h.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in h.g)return h.g.mozResponseArrayBuffer}return null}catch{return null}}function us(h){const b={};h=(h.g&&Lt(h)>=2&&h.g.getAllResponseHeaders()||"").split(`\r
`);for(let A=0;A<h.length;A++){if(I(h[A]))continue;var _=Se(h[A]);const ae=_[0];if(_=_[1],typeof _!="string")continue;_=_.trim();const pe=b[ae]||[];b[ae]=pe,pe.push(_)}Z(b,function(A){return A.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function os(h,b,_){return _&&_.internalChannelParams&&_.internalChannelParams[h]||b}function Ts(h){this.za=0,this.i=[],this.j=new Xe,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=os("failFast",!1,h),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=os("baseRetryDelayMs",5e3,h),this.Za=os("retryDelaySeedMs",1e4,h),this.Ta=os("forwardChannelMaxRetries",2,h),this.va=os("forwardChannelRequestTimeoutMs",2e4,h),this.ma=h&&h.xmlHttpFactory||void 0,this.Ua=h&&h.Rb||void 0,this.Aa=h&&h.useFetchStreams||!1,this.O=void 0,this.L=h&&h.supportsCrossDomainXhr||!1,this.M="",this.h=new P(h&&h.concurrentRequestLimit),this.Ba=new zn,this.S=h&&h.fastHandshake||!1,this.R=h&&h.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=h&&h.Pb||!1,h&&h.ua&&this.j.ua(),h&&h.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&h&&h.detectBufferingProxy||!1,this.ia=void 0,h&&h.longPollingTimeout&&h.longPollingTimeout>0&&(this.ia=h.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=Ts.prototype,n.ka=8,n.I=1,n.connect=function(h,b,_,A){se(0),this.W=h,this.H=b||{},_&&A!==void 0&&(this.H.OSID=_,this.H.OAID=A),this.F=this.X,this.J=Ya(this,null,this.W),$s(this)};function zr(h){if(tn(h),h.I==3){var b=h.V++,_=cs(h.J);if(gs(_,"SID",h.M),gs(_,"RID",b),gs(_,"TYPE","terminate"),Dn(h,_),b=new Ee(h,h.j,b),b.M=2,b.A=Cr(cs(_)),_=!1,d.navigator&&d.navigator.sendBeacon)try{_=d.navigator.sendBeacon(b.A.toString(),"")}catch{}!_&&d.Image&&(new Image().src=b.A,_=!0),_||(b.g=ma(b.j,null),b.g.ea(b.A)),b.F=Date.now(),yn(b)}rl(h)}function vr(h){h.g&&(er(h),h.g.cancel(),h.g=null)}function tn(h){vr(h),h.v&&(d.clearTimeout(h.v),h.v=null),hr(h),h.h.cancel(),h.m&&(typeof h.m=="number"&&d.clearTimeout(h.m),h.m=null)}function $s(h){if(!U(h.h)&&!h.m){h.m=!0;var b=h.Ea;Ne||E(),fe||(Ne(),fe=!0),R.add(b,h),h.D=0}}function Yn(h,b){return ye(h.h)>=h.h.j-(h.m?1:0)?!1:h.m?(h.i=b.G.concat(h.i),!0):h.I==1||h.I==2||h.D>=(h.Sa?0:h.Ta)?!1:(h.m=He(y(h.Ea,h,b),xo(h,h.D)),h.D++,!0)}n.Ea=function(h){if(this.m)if(this.m=null,this.I==1){if(!h){this.V=Math.floor(Math.random()*1e5),h=this.V++;const ae=new Ee(this,this.j,h);let pe=this.o;if(this.U&&(pe?(pe=L(pe),Ie(pe,this.U)):pe=this.U),this.u!==null||this.R||(ae.J=pe,pe=null),this.S)e:{for(var b=0,_=0;_<this.i.length;_++){t:{var A=this.i[_];if("__data__"in A.map&&(A=A.map.__data__,typeof A=="string")){A=A.length;break t}A=void 0}if(A===void 0)break;if(b+=A,b>4096){b=_;break e}if(b===4096||_===this.i.length-1){b=_+1;break e}}b=1e3}else b=1e3;b=xr(this,ae,b),_=cs(this.J),gs(_,"RID",h),gs(_,"CVER",22),this.G&&gs(_,"X-HTTP-Session-Id",this.G),Dn(this,_),pe&&(this.R?b="headers="+we(dr(pe))+"&"+b:this.u&&Fr(_,this.u,pe)),Oe(this.h,ae),this.Ra&&gs(_,"TYPE","init"),this.S?(gs(_,"$req",b),gs(_,"SID","null"),ae.U=!0,st(ae,_,null)):st(ae,_,b),this.I=2}}else this.I==3&&(h?Qn(this,h):this.i.length==0||U(this.h)||Qn(this))};function Qn(h,b){var _;b?_=b.l:_=h.V++;const A=cs(h.J);gs(A,"SID",h.M),gs(A,"RID",_),gs(A,"AID",h.K),Dn(h,A),h.u&&h.o&&Fr(A,h.u,h.o),_=new Ee(h,h.j,_,h.D+1),h.u===null&&(_.J=h.o),b&&(h.i=b.G.concat(h.i)),b=xr(h,_,1e3),_.H=Math.round(h.va*.5)+Math.round(h.va*.5*Math.random()),Oe(h.h,_),st(_,A,b)}function Dn(h,b){h.H&&Le(h.H,function(_,A){gs(b,A,_)}),h.l&&Le({},function(_,A){gs(b,A,_)})}function xr(h,b,_){_=Math.min(h.i.length,_);const A=h.l?y(h.l.Ka,h.l,h):null;e:{var ae=h.i;let ss=-1;for(;;){const En=["count="+_];ss==-1?_>0?(ss=ae[0].g,En.push("ofs="+ss)):ss=0:En.push("ofs="+ss);let Os=!0;for(let dn=0;dn<_;dn++){var pe=ae[dn].g;const ea=ae[dn].map;if(pe-=ss,pe<0)ss=Math.max(0,ae[dn].g-100),Os=!1;else try{pe="req"+pe+"_"||"";try{var Ze=ea instanceof Map?ea:Object.entries(ea);for(const[Aa,pa]of Ze){let ga=pa;p(pa)&&(ga=Kt(pa)),En.push(pe+Aa+"="+encodeURIComponent(ga))}}catch(Aa){throw En.push(pe+"type="+encodeURIComponent("_badmap")),Aa}}catch{A&&A(ea)}}if(Os){Ze=En.join("&");break e}}Ze=void 0}return h=h.i.splice(0,_),b.G=h,Ze}function Rr(h){if(!h.g&&!h.v){h.Y=1;var b=h.Da;Ne||E(),fe||(Ne(),fe=!0),R.add(b,h),h.A=0}}function Xn(h){return h.g||h.v||h.A>=3?!1:(h.Y++,h.v=He(y(h.Da,h),xo(h,h.A)),h.A++,!0)}n.Da=function(){if(this.v=null,qn(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var h=4*this.T;this.j.info("BP detection timer enabled: "+h),this.B=He(y(this.Wa,this),h)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,se(10),vr(this),qn(this))};function er(h){h.B!=null&&(d.clearTimeout(h.B),h.B=null)}function qn(h){h.g=new Ee(h,h.j,"rpc",h.Y),h.u===null&&(h.g.J=h.o),h.g.P=0;var b=cs(h.na);gs(b,"RID","rpc"),gs(b,"SID",h.M),gs(b,"AID",h.K),gs(b,"CI",h.F?"0":"1"),!h.F&&h.ia&&gs(b,"TO",h.ia),gs(b,"TYPE","xmlhttp"),Dn(h,b),h.u&&h.o&&Fr(b,h.u,h.o),h.O&&(h.g.H=h.O);var _=h.g;h=h.ba,_.M=1,_.A=Cr(cs(b)),_.u=null,_.R=!0,St(_,h)}n.Va=function(){this.C!=null&&(this.C=null,vr(this),Xn(this),se(19))};function hr(h){h.C!=null&&(d.clearTimeout(h.C),h.C=null)}function Ar(h,b){var _=null;if(h.g==b){hr(h),er(h),h.g=null;var A=2}else if(Ve(h.h,b))_=b.G,et(h.h,b),A=1;else return;if(h.I!=0){if(b.o)if(A==1){_=b.u?b.u.length:0,b=Date.now()-b.F;var ae=h.D;A=ge(),Ye(A,new Ge(A,_)),$s(h)}else Rr(h);else if(ae=b.m,ae==3||ae==0&&b.X>0||!(A==1&&Yn(h,b)||A==2&&Xn(h)))switch(_&&_.length>0&&(b=h.h,b.i=b.i.concat(_)),ae){case 1:Zr(h,5);break;case 4:Zr(h,10);break;case 3:Zr(h,6);break;default:Zr(h,2)}}}function xo(h,b){let _=h.Qa+Math.floor(Math.random()*h.Za);return h.isActive()||(_*=2),_*b}function Zr(h,b){if(h.j.info("Error code "+b),b==2){var _=y(h.bb,h),A=h.Ua;const ae=!A;A=new ls(A||"//www.google.com/images/cleardot.gif"),d.location&&d.location.protocol=="http"||Hs(A,"https"),Cr(A),ae?Jt(A.toString(),_):ln(A.toString(),_)}else se(2);h.I=0,h.l&&h.l.pa(b),rl(h),tn(h)}n.bb=function(h){h?(this.j.info("Successfully pinged google.com"),se(2)):(this.j.info("Failed to ping google.com"),se(1))};function rl(h){if(h.I=0,h.ja=[],h.l){const b=nt(h.h);(b.length!=0||h.i.length!=0)&&(G(h.ja,b),G(h.ja,h.i),h.h.i.length=0,O(h.i),h.i.length=0),h.l.oa()}}function Ya(h,b,_){var A=_ instanceof ls?cs(_):new ls(_);if(A.g!="")b&&(A.g=b+"."+A.g),fn(A,A.u);else{var ae=d.location;A=ae.protocol,b=b?b+"."+ae.hostname:ae.hostname,ae=+ae.port;const pe=new ls(null);A&&Hs(pe,A),b&&(pe.g=b),ae&&fn(pe,ae),_&&(pe.h=_),A=pe}return _=h.G,b=h.wa,_&&b&&gs(A,_,b),gs(A,"VER",h.ka),Dn(h,A),A}function ma(h,b,_){if(b&&!h.L)throw Error("Can't create secondary domain capable XhrIo object.");return b=h.Aa&&!h.ma?new N(new Gn({ab:_})):new N(h.ma),b.Fa(h.L),b}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function fa(){}n=fa.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function Ti(){}Ti.prototype.g=function(h,b){return new wr(h,b)};function wr(h,b){ut.call(this),this.g=new Ts(b),this.l=h,this.h=b&&b.messageUrlParams||null,h=b&&b.messageHeaders||null,b&&b.clientProtocolHeaderRequired&&(h?h["X-Client-Protocol"]="webchannel":h={"X-Client-Protocol":"webchannel"}),this.g.o=h,h=b&&b.initMessageHeaders||null,b&&b.messageContentType&&(h?h["X-WebChannel-Content-Type"]=b.messageContentType:h={"X-WebChannel-Content-Type":b.messageContentType}),b&&b.sa&&(h?h["X-WebChannel-Client-Profile"]=b.sa:h={"X-WebChannel-Client-Profile":b.sa}),this.g.U=h,(h=b&&b.Qb)&&!I(h)&&(this.g.u=h),this.A=b&&b.supportsCrossDomainXhr||!1,this.v=b&&b.sendRawJson||!1,(b=b&&b.httpSessionIdParam)&&!I(b)&&(this.g.G=b,h=this.h,h!==null&&b in h&&(h=this.h,b in h&&delete h[b])),this.j=new Qa(this)}k(wr,ut),wr.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},wr.prototype.close=function(){zr(this.g)},wr.prototype.o=function(h){var b=this.g;if(typeof h=="string"){var _={};_.__data__=h,h=_}else this.v&&(_={},_.__data__=Kt(h),h=_);b.i.push(new C(b.Ya++,h)),b.I==3&&$s(b)},wr.prototype.N=function(){this.g.l=null,delete this.j,zr(this.g),delete this.g,wr.Z.N.call(this)};function Yu(h){Te.call(this),h.__headers__&&(this.headers=h.__headers__,this.statusCode=h.__status__,delete h.__headers__,delete h.__status__);var b=h.__sm__;if(b){e:{for(const _ in b){h=_;break e}h=void 0}(this.i=h)&&(h=this.i,b=b!==null&&h in b?b[h]:void 0),this.data=b}else this.data=h}k(Yu,Te);function Qu(){Be.call(this),this.status=1}k(Qu,Be);function Qa(h){this.g=h}k(Qa,fa),Qa.prototype.ra=function(){Ye(this.g,"a")},Qa.prototype.qa=function(h){Ye(this.g,new Yu(h))},Qa.prototype.pa=function(h){Ye(this.g,new Qu)},Qa.prototype.oa=function(){Ye(this.g,"b")},Ti.prototype.createWebChannel=Ti.prototype.g,wr.prototype.send=wr.prototype.o,wr.prototype.open=wr.prototype.m,wr.prototype.close=wr.prototype.close,Jw=function(){return new Ti},Xw=function(){return ge()},Qw=Ue,pg={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},ts.NO_ERROR=0,ts.TIMEOUT=8,ts.HTTP_ERROR=6,wh=ts,ks.COMPLETE="complete",Yw=ks,Ct.EventType=be,be.OPEN="a",be.CLOSE="b",be.ERROR="c",be.MESSAGE="d",ut.prototype.listen=ut.prototype.J,au=Ct,N.prototype.listenOnce=N.prototype.K,N.prototype.getLastError=N.prototype.Ha,N.prototype.getLastErrorCode=N.prototype.ya,N.prototype.getStatus=N.prototype.ca,N.prototype.getResponseJson=N.prototype.La,N.prototype.getResponseText=N.prototype.la,N.prototype.send=N.prototype.ea,N.prototype.setWithCredentials=N.prototype.Fa,Kw=N}).apply(typeof sh<"u"?sh:typeof self<"u"?self:typeof window<"u"?window:{});class pr{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}pr.UNAUTHENTICATED=new pr(null),pr.GOOGLE_CREDENTIALS=new pr("google-credentials-uid"),pr.FIRST_PARTY=new pr("first-party-uid"),pr.MOCK_USER=new pr("mock-user");let oc="12.8.0";function dR(n){oc=n}const Xo=new $g("@firebase/firestore");function Fl(){return Xo.logLevel}function ht(n,...e){if(Xo.logLevel<=vs.DEBUG){const t=e.map(ry);Xo.debug(`Firestore (${oc}): ${n}`,...t)}}function xi(n,...e){if(Xo.logLevel<=vs.ERROR){const t=e.map(ry);Xo.error(`Firestore (${oc}): ${n}`,...t)}}function Xl(n,...e){if(Xo.logLevel<=vs.WARN){const t=e.map(ry);Xo.warn(`Firestore (${oc}): ${n}`,...t)}}function ry(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}function qt(n,e,t){let i="Unexpected state";typeof e=="string"?i=e:t=e,Zw(n,i,t)}function Zw(n,e,t){let i=`FIRESTORE (${oc}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{i+=" CONTEXT: "+JSON.stringify(t)}catch{i+=" CONTEXT: "+t}throw xi(i),new Error(i)}function Fs(n,e,t,i){let l="Unexpected state";typeof t=="string"?l=t:i=t,n||Zw(e,l,i)}function es(n,e){return n}const Ce={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class at extends Ka{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class gi{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class e_{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class hR{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(pr.UNAUTHENTICATED)))}shutdown(){}}class mR{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class fR{constructor(e){this.t=e,this.currentUser=pr.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Fs(this.o===void 0,42304);let i=this.i;const l=g=>this.i!==i?(i=this.i,t(g)):Promise.resolve();let u=new gi;this.o=()=>{this.i++,this.currentUser=this.u(),u.resolve(),u=new gi,e.enqueueRetryable((()=>l(this.currentUser)))};const d=()=>{const g=u;e.enqueueRetryable((async()=>{await g.promise,await l(this.currentUser)}))},p=g=>{ht("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=g,this.o&&(this.auth.addAuthTokenListener(this.o),d())};this.t.onInit((g=>p(g))),setTimeout((()=>{if(!this.auth){const g=this.t.getImmediate({optional:!0});g?p(g):(ht("FirebaseAuthCredentialsProvider","Auth not yet detected"),u.resolve(),u=new gi)}}),0),d()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((i=>this.i!==e?(ht("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(Fs(typeof i.accessToken=="string",31837,{l:i}),new e_(i.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Fs(e===null||typeof e=="string",2055,{h:e}),new pr(e)}}class pR{constructor(e,t,i){this.P=e,this.T=t,this.I=i,this.type="FirstParty",this.user=pr.FIRST_PARTY,this.R=new Map}A(){return this.I?this.I():null}get headers(){this.R.set("X-Goog-AuthUser",this.P);const e=this.A();return e&&this.R.set("Authorization",e),this.T&&this.R.set("X-Goog-Iam-Authorization-Token",this.T),this.R}}class gR{constructor(e,t,i){this.P=e,this.T=t,this.I=i}getToken(){return Promise.resolve(new pR(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(pr.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class yx{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class yR{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Qr(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Fs(this.o===void 0,3512);const i=u=>{u.error!=null&&ht("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${u.error.message}`);const d=u.token!==this.m;return this.m=u.token,ht("FirebaseAppCheckTokenProvider",`Received ${d?"new":"existing"} token.`),d?t(u.token):Promise.resolve()};this.o=u=>{e.enqueueRetryable((()=>i(u)))};const l=u=>{ht("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=u,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((u=>l(u))),setTimeout((()=>{if(!this.appCheck){const u=this.V.getImmediate({optional:!0});u?l(u):ht("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new yx(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(Fs(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new yx(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function bR(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let i=0;i<n;i++)t[i]=Math.floor(256*Math.random());return t}class ay{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const l=bR(40);for(let u=0;u<l.length;++u)i.length<20&&l[u]<t&&(i+=e.charAt(l[u]%62))}return i}}function xs(n,e){return n<e?-1:n>e?1:0}function gg(n,e){const t=Math.min(n.length,e.length);for(let i=0;i<t;i++){const l=n.charAt(i),u=e.charAt(i);if(l!==u)return Ip(l)===Ip(u)?xs(l,u):Ip(l)?1:-1}return xs(n.length,e.length)}const vR=55296,xR=57343;function Ip(n){const e=n.charCodeAt(0);return e>=vR&&e<=xR}function Jl(n,e,t){return n.length===e.length&&n.every(((i,l)=>t(i,e[l])))}const bx="__name__";class Oa{constructor(e,t,i){t===void 0?t=0:t>e.length&&qt(637,{offset:t,range:e.length}),i===void 0?i=e.length-t:i>e.length-t&&qt(1746,{length:i,range:e.length-t}),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return Oa.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Oa?e.forEach((i=>{t.push(i)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const i=Math.min(e.length,t.length);for(let l=0;l<i;l++){const u=Oa.compareSegments(e.get(l),t.get(l));if(u!==0)return u}return xs(e.length,t.length)}static compareSegments(e,t){const i=Oa.isNumericId(e),l=Oa.isNumericId(t);return i&&!l?-1:!i&&l?1:i&&l?Oa.extractNumericId(e).compare(Oa.extractNumericId(t)):gg(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return io.fromString(e.substring(4,e.length-2))}}class an extends Oa{construct(e,t,i){return new an(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const i of e){if(i.indexOf("//")>=0)throw new at(Ce.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter((l=>l.length>0)))}return new an(t)}static emptyPath(){return new an([])}}const wR=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class ir extends Oa{construct(e,t,i){return new ir(e,t,i)}static isValidIdentifier(e){return wR.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),ir.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===bx}static keyField(){return new ir([bx])}static fromServerFormat(e){const t=[];let i="",l=0;const u=()=>{if(i.length===0)throw new at(Ce.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""};let d=!1;for(;l<e.length;){const p=e[l];if(p==="\\"){if(l+1===e.length)throw new at(Ce.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const g=e[l+1];if(g!=="\\"&&g!=="."&&g!=="`")throw new at(Ce.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=g,l+=2}else p==="`"?(d=!d,l++):p!=="."||d?(i+=p,l++):(u(),l++)}if(u(),d)throw new at(Ce.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new ir(t)}static emptyPath(){return new ir([])}}class At{constructor(e){this.path=e}static fromPath(e){return new At(an.fromString(e))}static fromName(e){return new At(an.fromString(e).popFirst(5))}static empty(){return new At(an.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&an.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return an.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new At(new an(e.slice()))}}function t_(n,e,t){if(!t)throw new at(Ce.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function _R(n,e,t,i){if(e===!0&&i===!0)throw new at(Ce.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function vx(n){if(!At.isDocumentKey(n))throw new at(Ce.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function xx(n){if(At.isDocumentKey(n))throw new at(Ce.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function s_(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function rm(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(i){return i.constructor?i.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":qt(12329,{type:typeof n})}function Er(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new at(Ce.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=rm(n);throw new at(Ce.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function kR(n,e){if(e<=0)throw new at(Ce.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}function Fn(n,e){const t={typeString:n};return e&&(t.value=e),t}function Ou(n,e){if(!s_(n))throw new at(Ce.INVALID_ARGUMENT,"JSON must be an object");let t;for(const i in e)if(e[i]){const l=e[i].typeString,u="value"in e[i]?{value:e[i].value}:void 0;if(!(i in n)){t=`JSON missing required field: '${i}'`;break}const d=n[i];if(l&&typeof d!==l){t=`JSON field '${i}' must be a ${l}.`;break}if(u!==void 0&&d!==u.value){t=`Expected '${i}' field to equal '${u.value}'`;break}}if(t)throw new at(Ce.INVALID_ARGUMENT,t);return!0}const wx=-62135596800,_x=1e6;class kt{static now(){return kt.fromMillis(Date.now())}static fromDate(e){return kt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),i=Math.floor((e-1e3*t)*_x);return new kt(t,i)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new at(Ce.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new at(Ce.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<wx)throw new at(Ce.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new at(Ce.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/_x}_compareTo(e){return this.seconds===e.seconds?xs(this.nanoseconds,e.nanoseconds):xs(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:kt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Ou(e,kt._jsonSchema))return new kt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-wx;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}kt._jsonSchemaVersion="firestore/timestamp/1.0",kt._jsonSchema={type:Fn("string",kt._jsonSchemaVersion),seconds:Fn("number"),nanoseconds:Fn("number")};class Qt{static fromTimestamp(e){return new Qt(e)}static min(){return new Qt(new kt(0,0))}static max(){return new Qt(new kt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const xu=-1;function jR(n,e){const t=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,l=Qt.fromTimestamp(i===1e9?new kt(t+1,0):new kt(t,i));return new co(l,At.empty(),e)}function TR(n){return new co(n.readTime,n.key,xu)}class co{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new co(Qt.min(),At.empty(),xu)}static max(){return new co(Qt.max(),At.empty(),xu)}}function ER(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=At.comparator(n.documentKey,e.documentKey),t!==0?t:xs(n.largestBatchId,e.largestBatchId))}const SR="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class NR{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function lc(n){if(n.code!==Ce.FAILED_PRECONDITION||n.message!==SR)throw n;ht("LocalStore","Unexpectedly lost primary lease")}class Pe{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&qt(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new Pe(((i,l)=>{this.nextCallback=u=>{this.wrapSuccess(e,u).next(i,l)},this.catchCallback=u=>{this.wrapFailure(t,u).next(i,l)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof Pe?t:Pe.resolve(t)}catch(t){return Pe.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):Pe.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):Pe.reject(t)}static resolve(e){return new Pe(((t,i)=>{t(e)}))}static reject(e){return new Pe(((t,i)=>{i(e)}))}static waitFor(e){return new Pe(((t,i)=>{let l=0,u=0,d=!1;e.forEach((p=>{++l,p.next((()=>{++u,d&&u===l&&t()}),(g=>i(g)))})),d=!0,u===l&&t()}))}static or(e){let t=Pe.resolve(!1);for(const i of e)t=t.next((l=>l?Pe.resolve(l):i()));return t}static forEach(e,t){const i=[];return e.forEach(((l,u)=>{i.push(t.call(this,l,u))})),this.waitFor(i)}static mapArray(e,t){return new Pe(((i,l)=>{const u=e.length,d=new Array(u);let p=0;for(let g=0;g<u;g++){const y=g;t(e[y]).next((x=>{d[y]=x,++p,p===u&&i(d)}),(x=>l(x)))}}))}static doWhile(e,t){return new Pe(((i,l)=>{const u=()=>{e()===!0?t().next((()=>{u()}),l):i()};u()}))}}function CR(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function cc(n){return n.name==="IndexedDbTransactionError"}class am{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=i=>this.ae(i),this.ue=i=>t.writeSequenceNumber(i))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}am.ce=-1;const iy=-1;function im(n){return n==null}function Oh(n){return n===0&&1/n==-1/0}function RR(n){return typeof n=="number"&&Number.isInteger(n)&&!Oh(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}const n_="";function AR(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=kx(e)),e=MR(n.get(t),e);return kx(e)}function MR(n,e){let t=e;const i=n.length;for(let l=0;l<i;l++){const u=n.charAt(l);switch(u){case"\0":t+="";break;case n_:t+="";break;default:t+=u}}return t}function kx(n){return n+n_+""}function jx(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function bo(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function r_(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}class gn{constructor(e,t){this.comparator=e,this.root=t||ar.EMPTY}insert(e,t){return new gn(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,ar.BLACK,null,null))}remove(e){return new gn(this.comparator,this.root.remove(e,this.comparator).copy(null,null,ar.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const i=this.comparator(e,t.key);if(i===0)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){const l=this.comparator(e,i.key);if(l===0)return t+i.left.size;l<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,i)=>(e(t,i),!1)))}toString(){const e=[];return this.inorderTraversal(((t,i)=>(e.push(`${t}:${i}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new nh(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new nh(this.root,e,this.comparator,!1)}getReverseIterator(){return new nh(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new nh(this.root,e,this.comparator,!0)}}class nh{constructor(e,t,i,l){this.isReverse=l,this.nodeStack=[];let u=1;for(;!e.isEmpty();)if(u=t?i(e.key,t):1,t&&l&&(u*=-1),u<0)e=this.isReverse?e.left:e.right;else{if(u===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class ar{constructor(e,t,i,l,u){this.key=e,this.value=t,this.color=i??ar.RED,this.left=l??ar.EMPTY,this.right=u??ar.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,l,u){return new ar(e??this.key,t??this.value,i??this.color,l??this.left,u??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let l=this;const u=i(e,l.key);return l=u<0?l.copy(null,null,null,l.left.insert(e,t,i),null):u===0?l.copy(null,t,null,null,null):l.copy(null,null,null,null,l.right.insert(e,t,i)),l.fixUp()}removeMin(){if(this.left.isEmpty())return ar.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,l=this;if(t(e,l.key)<0)l.left.isEmpty()||l.left.isRed()||l.left.left.isRed()||(l=l.moveRedLeft()),l=l.copy(null,null,null,l.left.remove(e,t),null);else{if(l.left.isRed()&&(l=l.rotateRight()),l.right.isEmpty()||l.right.isRed()||l.right.left.isRed()||(l=l.moveRedRight()),t(e,l.key)===0){if(l.right.isEmpty())return ar.EMPTY;i=l.right.min(),l=l.copy(i.key,i.value,null,null,l.right.removeMin())}l=l.copy(null,null,null,null,l.right.remove(e,t))}return l.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,ar.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,ar.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw qt(43730,{key:this.key,value:this.value});if(this.right.isRed())throw qt(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw qt(27949);return e+(this.isRed()?0:1)}}ar.EMPTY=null,ar.RED=!0,ar.BLACK=!1;ar.EMPTY=new class{constructor(){this.size=0}get key(){throw qt(57766)}get value(){throw qt(16141)}get color(){throw qt(16727)}get left(){throw qt(29726)}get right(){throw qt(36894)}copy(e,t,i,l,u){return this}insert(e,t,i){return new ar(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Wn{constructor(e){this.comparator=e,this.data=new gn(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,i)=>(e(t),!1)))}forEachInRange(e,t){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const l=i.getNext();if(this.comparator(l.key,e[1])>=0)return;t(l.key)}}forEachWhile(e,t){let i;for(i=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Tx(this.data.getIterator())}getIteratorFrom(e){return new Tx(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((i=>{t=t.add(i)})),t}isEqual(e){if(!(e instanceof Wn)||this.size!==e.size)return!1;const t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){const l=t.getNext().key,u=i.getNext().key;if(this.comparator(l,u)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new Wn(this.comparator);return t.data=e,t}}class Tx{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class Xr{constructor(e){this.fields=e,e.sort(ir.comparator)}static empty(){return new Xr([])}unionWith(e){let t=new Wn(ir.comparator);for(const i of this.fields)t=t.add(i);for(const i of e)t=t.add(i);return new Xr(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Jl(this.fields,e.fields,((t,i)=>t.isEqual(i)))}}class a_ extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class or{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(l){try{return atob(l)}catch(u){throw typeof DOMException<"u"&&u instanceof DOMException?new a_("Invalid base64 string: "+u):u}})(e);return new or(t)}static fromUint8Array(e){const t=(function(l){let u="";for(let d=0;d<l.length;++d)u+=String.fromCharCode(l[d]);return u})(e);return new or(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const i=new Uint8Array(t.length);for(let l=0;l<t.length;l++)i[l]=t.charCodeAt(l);return i})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return xs(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}or.EMPTY_BYTE_STRING=new or("");const IR=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function uo(n){if(Fs(!!n,39018),typeof n=="string"){let e=0;const t=IR.exec(n);if(Fs(!!t,46558,{timestamp:n}),t[1]){let l=t[1];l=(l+"000000000").substr(0,9),e=Number(l)}const i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:Cn(n.seconds),nanos:Cn(n.nanos)}}function Cn(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function ho(n){return typeof n=="string"?or.fromBase64String(n):or.fromUint8Array(n)}const i_="server_timestamp",o_="__type__",l_="__previous_value__",c_="__local_write_time__";function oy(n){return(n?.mapValue?.fields||{})[o_]?.stringValue===i_}function om(n){const e=n.mapValue.fields[l_];return oy(e)?om(e):e}function wu(n){const e=uo(n.mapValue.fields[c_].timestampValue);return new kt(e.seconds,e.nanos)}class DR{constructor(e,t,i,l,u,d,p,g,y,x,k){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=l,this.ssl=u,this.forceLongPolling=d,this.autoDetectLongPolling=p,this.longPollingOptions=g,this.useFetchStreams=y,this.isUsingEmulator=x,this.apiKey=k}}const Bh="(default)";class _u{constructor(e,t){this.projectId=e,this.database=t||Bh}static empty(){return new _u("","")}get isDefaultDatabase(){return this.database===Bh}isEqual(e){return e instanceof _u&&e.projectId===this.projectId&&e.database===this.database}}function PR(n,e){if(!Object.prototype.hasOwnProperty.apply(n.options,["projectId"]))throw new at(Ce.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new _u(n.options.projectId,e)}const u_="__type__",LR="__max__",rh={mapValue:{}},d_="__vector__",Vh="value";function mo(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?oy(n)?4:BR(n)?9007199254740991:OR(n)?10:11:qt(28295,{value:n})}function Wa(n,e){if(n===e)return!0;const t=mo(n);if(t!==mo(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return wu(n).isEqual(wu(e));case 3:return(function(l,u){if(typeof l.timestampValue=="string"&&typeof u.timestampValue=="string"&&l.timestampValue.length===u.timestampValue.length)return l.timestampValue===u.timestampValue;const d=uo(l.timestampValue),p=uo(u.timestampValue);return d.seconds===p.seconds&&d.nanos===p.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(l,u){return ho(l.bytesValue).isEqual(ho(u.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(l,u){return Cn(l.geoPointValue.latitude)===Cn(u.geoPointValue.latitude)&&Cn(l.geoPointValue.longitude)===Cn(u.geoPointValue.longitude)})(n,e);case 2:return(function(l,u){if("integerValue"in l&&"integerValue"in u)return Cn(l.integerValue)===Cn(u.integerValue);if("doubleValue"in l&&"doubleValue"in u){const d=Cn(l.doubleValue),p=Cn(u.doubleValue);return d===p?Oh(d)===Oh(p):isNaN(d)&&isNaN(p)}return!1})(n,e);case 9:return Jl(n.arrayValue.values||[],e.arrayValue.values||[],Wa);case 10:case 11:return(function(l,u){const d=l.mapValue.fields||{},p=u.mapValue.fields||{};if(jx(d)!==jx(p))return!1;for(const g in d)if(d.hasOwnProperty(g)&&(p[g]===void 0||!Wa(d[g],p[g])))return!1;return!0})(n,e);default:return qt(52216,{left:n})}}function ku(n,e){return(n.values||[]).find((t=>Wa(t,e)))!==void 0}function Zl(n,e){if(n===e)return 0;const t=mo(n),i=mo(e);if(t!==i)return xs(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return xs(n.booleanValue,e.booleanValue);case 2:return(function(u,d){const p=Cn(u.integerValue||u.doubleValue),g=Cn(d.integerValue||d.doubleValue);return p<g?-1:p>g?1:p===g?0:isNaN(p)?isNaN(g)?0:-1:1})(n,e);case 3:return Ex(n.timestampValue,e.timestampValue);case 4:return Ex(wu(n),wu(e));case 5:return gg(n.stringValue,e.stringValue);case 6:return(function(u,d){const p=ho(u),g=ho(d);return p.compareTo(g)})(n.bytesValue,e.bytesValue);case 7:return(function(u,d){const p=u.split("/"),g=d.split("/");for(let y=0;y<p.length&&y<g.length;y++){const x=xs(p[y],g[y]);if(x!==0)return x}return xs(p.length,g.length)})(n.referenceValue,e.referenceValue);case 8:return(function(u,d){const p=xs(Cn(u.latitude),Cn(d.latitude));return p!==0?p:xs(Cn(u.longitude),Cn(d.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return Sx(n.arrayValue,e.arrayValue);case 10:return(function(u,d){const p=u.fields||{},g=d.fields||{},y=p[Vh]?.arrayValue,x=g[Vh]?.arrayValue,k=xs(y?.values?.length||0,x?.values?.length||0);return k!==0?k:Sx(y,x)})(n.mapValue,e.mapValue);case 11:return(function(u,d){if(u===rh.mapValue&&d===rh.mapValue)return 0;if(u===rh.mapValue)return 1;if(d===rh.mapValue)return-1;const p=u.fields||{},g=Object.keys(p),y=d.fields||{},x=Object.keys(y);g.sort(),x.sort();for(let k=0;k<g.length&&k<x.length;++k){const T=gg(g[k],x[k]);if(T!==0)return T;const O=Zl(p[g[k]],y[x[k]]);if(O!==0)return O}return xs(g.length,x.length)})(n.mapValue,e.mapValue);default:throw qt(23264,{he:t})}}function Ex(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return xs(n,e);const t=uo(n),i=uo(e),l=xs(t.seconds,i.seconds);return l!==0?l:xs(t.nanos,i.nanos)}function Sx(n,e){const t=n.values||[],i=e.values||[];for(let l=0;l<t.length&&l<i.length;++l){const u=Zl(t[l],i[l]);if(u)return u}return xs(t.length,i.length)}function ec(n){return yg(n)}function yg(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const i=uo(t);return`time(${i.seconds},${i.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return ho(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return At.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let i="[",l=!0;for(const u of t.values||[])l?l=!1:i+=",",i+=yg(u);return i+"]"})(n.arrayValue):"mapValue"in n?(function(t){const i=Object.keys(t.fields||{}).sort();let l="{",u=!0;for(const d of i)u?u=!1:l+=",",l+=`${d}:${yg(t.fields[d])}`;return l+"}"})(n.mapValue):qt(61005,{value:n})}function _h(n){switch(mo(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=om(n);return e?16+_h(e):16;case 5:return 2*n.stringValue.length;case 6:return ho(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(i){return(i.values||[]).reduce(((l,u)=>l+_h(u)),0)})(n.arrayValue);case 10:case 11:return(function(i){let l=0;return bo(i.fields,((u,d)=>{l+=u.length+_h(d)})),l})(n.mapValue);default:throw qt(13486,{value:n})}}function Nx(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function bg(n){return!!n&&"integerValue"in n}function ly(n){return!!n&&"arrayValue"in n}function Cx(n){return!!n&&"nullValue"in n}function Rx(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function kh(n){return!!n&&"mapValue"in n}function OR(n){return(n?.mapValue?.fields||{})[u_]?.stringValue===d_}function du(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return bo(n.mapValue.fields,((t,i)=>e.mapValue.fields[t]=du(i))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=du(n.arrayValue.values[t]);return e}return{...n}}function BR(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===LR}class Br{constructor(e){this.value=e}static empty(){return new Br({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!kh(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=du(t)}setAll(e){let t=ir.emptyPath(),i={},l=[];e.forEach(((d,p)=>{if(!t.isImmediateParentOf(p)){const g=this.getFieldsMap(t);this.applyChanges(g,i,l),i={},l=[],t=p.popLast()}d?i[p.lastSegment()]=du(d):l.push(p.lastSegment())}));const u=this.getFieldsMap(t);this.applyChanges(u,i,l)}delete(e){const t=this.field(e.popLast());kh(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Wa(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let l=t.mapValue.fields[e.get(i)];kh(l)&&l.mapValue.fields||(l={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=l),t=l}return t.mapValue.fields}applyChanges(e,t,i){bo(t,((l,u)=>e[l]=u));for(const l of i)delete e[l]}clone(){return new Br(du(this.value))}}function h_(n){const e=[];return bo(n.fields,((t,i)=>{const l=new ir([t]);if(kh(i)){const u=h_(i.mapValue).fields;if(u.length===0)e.push(l);else for(const d of u)e.push(l.child(d))}else e.push(l)})),new Xr(e)}class gr{constructor(e,t,i,l,u,d,p){this.key=e,this.documentType=t,this.version=i,this.readTime=l,this.createTime=u,this.data=d,this.documentState=p}static newInvalidDocument(e){return new gr(e,0,Qt.min(),Qt.min(),Qt.min(),Br.empty(),0)}static newFoundDocument(e,t,i,l){return new gr(e,1,t,Qt.min(),i,l,0)}static newNoDocument(e,t){return new gr(e,2,t,Qt.min(),Qt.min(),Br.empty(),0)}static newUnknownDocument(e,t){return new gr(e,3,t,Qt.min(),Qt.min(),Br.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Qt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Br.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Br.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Qt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof gr&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new gr(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Uh{constructor(e,t){this.position=e,this.inclusive=t}}function Ax(n,e,t){let i=0;for(let l=0;l<n.position.length;l++){const u=e[l],d=n.position[l];if(u.field.isKeyField()?i=At.comparator(At.fromName(d.referenceValue),t.key):i=Zl(d,t.data.field(u.field)),u.dir==="desc"&&(i*=-1),i!==0)break}return i}function Mx(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Wa(n.position[t],e.position[t]))return!1;return!0}class ju{constructor(e,t="asc"){this.field=e,this.dir=t}}function VR(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}class m_{}class Un extends m_{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,i):new FR(e,t,i):t==="array-contains"?new HR(e,i):t==="in"?new $R(e,i):t==="not-in"?new WR(e,i):t==="array-contains-any"?new GR(e,i):new Un(e,t,i)}static createKeyFieldInFilter(e,t,i){return t==="in"?new zR(e,i):new qR(e,i)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Zl(t,this.value)):t!==null&&mo(this.value)===mo(t)&&this.matchesComparison(Zl(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return qt(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Ea extends m_{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new Ea(e,t)}matches(e){return f_(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function f_(n){return n.op==="and"}function p_(n){return UR(n)&&f_(n)}function UR(n){for(const e of n.filters)if(e instanceof Ea)return!1;return!0}function vg(n){if(n instanceof Un)return n.field.canonicalString()+n.op.toString()+ec(n.value);if(p_(n))return n.filters.map((e=>vg(e))).join(",");{const e=n.filters.map((t=>vg(t))).join(",");return`${n.op}(${e})`}}function g_(n,e){return n instanceof Un?(function(i,l){return l instanceof Un&&i.op===l.op&&i.field.isEqual(l.field)&&Wa(i.value,l.value)})(n,e):n instanceof Ea?(function(i,l){return l instanceof Ea&&i.op===l.op&&i.filters.length===l.filters.length?i.filters.reduce(((u,d,p)=>u&&g_(d,l.filters[p])),!0):!1})(n,e):void qt(19439)}function y_(n){return n instanceof Un?(function(t){return`${t.field.canonicalString()} ${t.op} ${ec(t.value)}`})(n):n instanceof Ea?(function(t){return t.op.toString()+" {"+t.getFilters().map(y_).join(" ,")+"}"})(n):"Filter"}class FR extends Un{constructor(e,t,i){super(e,t,i),this.key=At.fromName(i.referenceValue)}matches(e){const t=At.comparator(e.key,this.key);return this.matchesComparison(t)}}class zR extends Un{constructor(e,t){super(e,"in",t),this.keys=b_("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class qR extends Un{constructor(e,t){super(e,"not-in",t),this.keys=b_("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function b_(n,e){return(e.arrayValue?.values||[]).map((t=>At.fromName(t.referenceValue)))}class HR extends Un{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return ly(t)&&ku(t.arrayValue,this.value)}}class $R extends Un{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&ku(this.value.arrayValue,t)}}class WR extends Un{constructor(e,t){super(e,"not-in",t)}matches(e){if(ku(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!ku(this.value.arrayValue,t)}}class GR extends Un{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!ly(t)||!t.arrayValue.values)&&t.arrayValue.values.some((i=>ku(this.value.arrayValue,i)))}}class KR{constructor(e,t=null,i=[],l=[],u=null,d=null,p=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=l,this.limit=u,this.startAt=d,this.endAt=p,this.Te=null}}function Ix(n,e=null,t=[],i=[],l=null,u=null,d=null){return new KR(n,e,t,i,l,u,d)}function cy(n){const e=es(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((i=>vg(i))).join(","),t+="|ob:",t+=e.orderBy.map((i=>(function(u){return u.field.canonicalString()+u.dir})(i))).join(","),im(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((i=>ec(i))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((i=>ec(i))).join(",")),e.Te=t}return e.Te}function uy(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!VR(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!g_(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!Mx(n.startAt,e.startAt)&&Mx(n.endAt,e.endAt)}function xg(n){return At.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}class uc{constructor(e,t=null,i=[],l=[],u=null,d="F",p=null,g=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=l,this.limit=u,this.limitType=d,this.startAt=p,this.endAt=g,this.Ie=null,this.Ee=null,this.Re=null,this.startAt,this.endAt}}function YR(n,e,t,i,l,u,d,p){return new uc(n,e,t,i,l,u,d,p)}function lm(n){return new uc(n)}function Dx(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function QR(n){return At.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function v_(n){return n.collectionGroup!==null}function hu(n){const e=es(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const u of e.explicitOrderBy)e.Ie.push(u),t.add(u.field.canonicalString());const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(d){let p=new Wn(ir.comparator);return d.filters.forEach((g=>{g.getFlattenedFilters().forEach((y=>{y.isInequality()&&(p=p.add(y.field))}))})),p})(e).forEach((u=>{t.has(u.canonicalString())||u.isKeyField()||e.Ie.push(new ju(u,i))})),t.has(ir.keyField().canonicalString())||e.Ie.push(new ju(ir.keyField(),i))}return e.Ie}function qa(n){const e=es(n);return e.Ee||(e.Ee=XR(e,hu(n))),e.Ee}function XR(n,e){if(n.limitType==="F")return Ix(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((l=>{const u=l.dir==="desc"?"asc":"desc";return new ju(l.field,u)}));const t=n.endAt?new Uh(n.endAt.position,n.endAt.inclusive):null,i=n.startAt?new Uh(n.startAt.position,n.startAt.inclusive):null;return Ix(n.path,n.collectionGroup,e,n.filters,n.limit,t,i)}}function wg(n,e){const t=n.filters.concat([e]);return new uc(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function JR(n,e){const t=n.explicitOrderBy.concat([e]);return new uc(n.path,n.collectionGroup,t,n.filters.slice(),n.limit,n.limitType,n.startAt,n.endAt)}function Fh(n,e,t){return new uc(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function cm(n,e){return uy(qa(n),qa(e))&&n.limitType===e.limitType}function x_(n){return`${cy(qa(n))}|lt:${n.limitType}`}function zl(n){return`Query(target=${(function(t){let i=t.path.canonicalString();return t.collectionGroup!==null&&(i+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(i+=`, filters: [${t.filters.map((l=>y_(l))).join(", ")}]`),im(t.limit)||(i+=", limit: "+t.limit),t.orderBy.length>0&&(i+=`, orderBy: [${t.orderBy.map((l=>(function(d){return`${d.field.canonicalString()} (${d.dir})`})(l))).join(", ")}]`),t.startAt&&(i+=", startAt: ",i+=t.startAt.inclusive?"b:":"a:",i+=t.startAt.position.map((l=>ec(l))).join(",")),t.endAt&&(i+=", endAt: ",i+=t.endAt.inclusive?"a:":"b:",i+=t.endAt.position.map((l=>ec(l))).join(",")),`Target(${i})`})(qa(n))}; limitType=${n.limitType})`}function um(n,e){return e.isFoundDocument()&&(function(i,l){const u=l.key.path;return i.collectionGroup!==null?l.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(u):At.isDocumentKey(i.path)?i.path.isEqual(u):i.path.isImmediateParentOf(u)})(n,e)&&(function(i,l){for(const u of hu(i))if(!u.field.isKeyField()&&l.data.field(u.field)===null)return!1;return!0})(n,e)&&(function(i,l){for(const u of i.filters)if(!u.matches(l))return!1;return!0})(n,e)&&(function(i,l){return!(i.startAt&&!(function(d,p,g){const y=Ax(d,p,g);return d.inclusive?y<=0:y<0})(i.startAt,hu(i),l)||i.endAt&&!(function(d,p,g){const y=Ax(d,p,g);return d.inclusive?y>=0:y>0})(i.endAt,hu(i),l))})(n,e)}function ZR(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function w_(n){return(e,t)=>{let i=!1;for(const l of hu(n)){const u=eA(l,e,t);if(u!==0)return u;i=i||l.field.isKeyField()}return 0}}function eA(n,e,t){const i=n.field.isKeyField()?At.comparator(e.key,t.key):(function(u,d,p){const g=d.data.field(u),y=p.data.field(u);return g!==null&&y!==null?Zl(g,y):qt(42886)})(n.field,e,t);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return qt(19790,{direction:n.dir})}}class sl{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i!==void 0){for(const[l,u]of i)if(this.equalsFn(l,e))return u}}has(e){return this.get(e)!==void 0}set(e,t){const i=this.mapKeyFn(e),l=this.inner[i];if(l===void 0)return this.inner[i]=[[e,t]],void this.innerSize++;for(let u=0;u<l.length;u++)if(this.equalsFn(l[u][0],e))return void(l[u]=[e,t]);l.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i===void 0)return!1;for(let l=0;l<i.length;l++)if(this.equalsFn(i[l][0],e))return i.length===1?delete this.inner[t]:i.splice(l,1),this.innerSize--,!0;return!1}forEach(e){bo(this.inner,((t,i)=>{for(const[l,u]of i)e(l,u)}))}isEmpty(){return r_(this.inner)}size(){return this.innerSize}}const tA=new gn(At.comparator);function wi(){return tA}const __=new gn(At.comparator);function iu(...n){let e=__;for(const t of n)e=e.insert(t.key,t);return e}function k_(n){let e=__;return n.forEach(((t,i)=>e=e.insert(t,i.overlayedDocument))),e}function Fo(){return mu()}function j_(){return mu()}function mu(){return new sl((n=>n.toString()),((n,e)=>n.isEqual(e)))}const sA=new gn(At.comparator),nA=new Wn(At.comparator);function ws(...n){let e=nA;for(const t of n)e=e.add(t);return e}const rA=new Wn(xs);function aA(){return rA}function dy(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Oh(e)?"-0":e}}function T_(n){return{integerValue:""+n}}function E_(n,e){return RR(e)?T_(e):dy(n,e)}class dm{constructor(){this._=void 0}}function iA(n,e,t){return n instanceof Tu?(function(l,u){const d={fields:{[o_]:{stringValue:i_},[c_]:{timestampValue:{seconds:l.seconds,nanos:l.nanoseconds}}}};return u&&oy(u)&&(u=om(u)),u&&(d.fields[l_]=u),{mapValue:d}})(t,e):n instanceof Eu?N_(n,e):n instanceof Su?C_(n,e):(function(l,u){const d=S_(l,u),p=Px(d)+Px(l.Ae);return bg(d)&&bg(l.Ae)?T_(p):dy(l.serializer,p)})(n,e)}function oA(n,e,t){return n instanceof Eu?N_(n,e):n instanceof Su?C_(n,e):t}function S_(n,e){return n instanceof Nu?(function(i){return bg(i)||(function(u){return!!u&&"doubleValue"in u})(i)})(e)?e:{integerValue:0}:null}class Tu extends dm{}class Eu extends dm{constructor(e){super(),this.elements=e}}function N_(n,e){const t=R_(e);for(const i of n.elements)t.some((l=>Wa(l,i)))||t.push(i);return{arrayValue:{values:t}}}class Su extends dm{constructor(e){super(),this.elements=e}}function C_(n,e){let t=R_(e);for(const i of n.elements)t=t.filter((l=>!Wa(l,i)));return{arrayValue:{values:t}}}class Nu extends dm{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function Px(n){return Cn(n.integerValue||n.doubleValue)}function R_(n){return ly(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class A_{constructor(e,t){this.field=e,this.transform=t}}function lA(n,e){return n.field.isEqual(e.field)&&(function(i,l){return i instanceof Eu&&l instanceof Eu||i instanceof Su&&l instanceof Su?Jl(i.elements,l.elements,Wa):i instanceof Nu&&l instanceof Nu?Wa(i.Ae,l.Ae):i instanceof Tu&&l instanceof Tu})(n.transform,e.transform)}class cA{constructor(e,t){this.version=e,this.transformResults=t}}class Sr{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Sr}static exists(e){return new Sr(void 0,e)}static updateTime(e){return new Sr(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function jh(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class hm{}function M_(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new mm(n.key,Sr.none()):new Bu(n.key,n.data,Sr.none());{const t=n.data,i=Br.empty();let l=new Wn(ir.comparator);for(let u of e.fields)if(!l.has(u)){let d=t.field(u);d===null&&u.length>1&&(u=u.popLast(),d=t.field(u)),d===null?i.delete(u):i.set(u,d),l=l.add(u)}return new vo(n.key,i,new Xr(l.toArray()),Sr.none())}}function uA(n,e,t){n instanceof Bu?(function(l,u,d){const p=l.value.clone(),g=Ox(l.fieldTransforms,u,d.transformResults);p.setAll(g),u.convertToFoundDocument(d.version,p).setHasCommittedMutations()})(n,e,t):n instanceof vo?(function(l,u,d){if(!jh(l.precondition,u))return void u.convertToUnknownDocument(d.version);const p=Ox(l.fieldTransforms,u,d.transformResults),g=u.data;g.setAll(I_(l)),g.setAll(p),u.convertToFoundDocument(d.version,g).setHasCommittedMutations()})(n,e,t):(function(l,u,d){u.convertToNoDocument(d.version).setHasCommittedMutations()})(0,e,t)}function fu(n,e,t,i){return n instanceof Bu?(function(u,d,p,g){if(!jh(u.precondition,d))return p;const y=u.value.clone(),x=Bx(u.fieldTransforms,g,d);return y.setAll(x),d.convertToFoundDocument(d.version,y).setHasLocalMutations(),null})(n,e,t,i):n instanceof vo?(function(u,d,p,g){if(!jh(u.precondition,d))return p;const y=Bx(u.fieldTransforms,g,d),x=d.data;return x.setAll(I_(u)),x.setAll(y),d.convertToFoundDocument(d.version,x).setHasLocalMutations(),p===null?null:p.unionWith(u.fieldMask.fields).unionWith(u.fieldTransforms.map((k=>k.field)))})(n,e,t,i):(function(u,d,p){return jh(u.precondition,d)?(d.convertToNoDocument(d.version).setHasLocalMutations(),null):p})(n,e,t)}function dA(n,e){let t=null;for(const i of n.fieldTransforms){const l=e.data.field(i.field),u=S_(i.transform,l||null);u!=null&&(t===null&&(t=Br.empty()),t.set(i.field,u))}return t||null}function Lx(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(i,l){return i===void 0&&l===void 0||!(!i||!l)&&Jl(i,l,((u,d)=>lA(u,d)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class Bu extends hm{constructor(e,t,i,l=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=l,this.type=0}getFieldMask(){return null}}class vo extends hm{constructor(e,t,i,l,u=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=l,this.fieldTransforms=u,this.type=1}getFieldMask(){return this.fieldMask}}function I_(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const i=n.data.field(t);e.set(t,i)}})),e}function Ox(n,e,t){const i=new Map;Fs(n.length===t.length,32656,{Ve:t.length,de:n.length});for(let l=0;l<t.length;l++){const u=n[l],d=u.transform,p=e.data.field(u.field);i.set(u.field,oA(d,p,t[l]))}return i}function Bx(n,e,t){const i=new Map;for(const l of n){const u=l.transform,d=t.data.field(l.field);i.set(l.field,iA(u,d,e))}return i}class mm extends hm{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class hA extends hm{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class mA{constructor(e,t,i,l){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=l}applyToRemoteDocument(e,t){const i=t.mutationResults;for(let l=0;l<this.mutations.length;l++){const u=this.mutations[l];u.key.isEqual(e.key)&&uA(u,e,i[l])}}applyToLocalView(e,t){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(t=fu(i,e,t,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(t=fu(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const i=j_();return this.mutations.forEach((l=>{const u=e.get(l.key),d=u.overlayedDocument;let p=this.applyToLocalView(d,u.mutatedFields);p=t.has(l.key)?null:p;const g=M_(d,p);g!==null&&i.set(l.key,g),d.isValidDocument()||d.convertToNoDocument(Qt.min())})),i}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),ws())}isEqual(e){return this.batchId===e.batchId&&Jl(this.mutations,e.mutations,((t,i)=>Lx(t,i)))&&Jl(this.baseMutations,e.baseMutations,((t,i)=>Lx(t,i)))}}class hy{constructor(e,t,i,l){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=l}static from(e,t,i){Fs(e.mutations.length===i.length,58842,{me:e.mutations.length,fe:i.length});let l=(function(){return sA})();const u=e.mutations;for(let d=0;d<u.length;d++)l=l.insert(u[d].key,i[d].version);return new hy(e,t,i,l)}}class fA{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class pA{constructor(e,t){this.count=e,this.unchangedNames=t}}var Vn,Es;function gA(n){switch(n){case Ce.OK:return qt(64938);case Ce.CANCELLED:case Ce.UNKNOWN:case Ce.DEADLINE_EXCEEDED:case Ce.RESOURCE_EXHAUSTED:case Ce.INTERNAL:case Ce.UNAVAILABLE:case Ce.UNAUTHENTICATED:return!1;case Ce.INVALID_ARGUMENT:case Ce.NOT_FOUND:case Ce.ALREADY_EXISTS:case Ce.PERMISSION_DENIED:case Ce.FAILED_PRECONDITION:case Ce.ABORTED:case Ce.OUT_OF_RANGE:case Ce.UNIMPLEMENTED:case Ce.DATA_LOSS:return!0;default:return qt(15467,{code:n})}}function D_(n){if(n===void 0)return xi("GRPC error has no .code"),Ce.UNKNOWN;switch(n){case Vn.OK:return Ce.OK;case Vn.CANCELLED:return Ce.CANCELLED;case Vn.UNKNOWN:return Ce.UNKNOWN;case Vn.DEADLINE_EXCEEDED:return Ce.DEADLINE_EXCEEDED;case Vn.RESOURCE_EXHAUSTED:return Ce.RESOURCE_EXHAUSTED;case Vn.INTERNAL:return Ce.INTERNAL;case Vn.UNAVAILABLE:return Ce.UNAVAILABLE;case Vn.UNAUTHENTICATED:return Ce.UNAUTHENTICATED;case Vn.INVALID_ARGUMENT:return Ce.INVALID_ARGUMENT;case Vn.NOT_FOUND:return Ce.NOT_FOUND;case Vn.ALREADY_EXISTS:return Ce.ALREADY_EXISTS;case Vn.PERMISSION_DENIED:return Ce.PERMISSION_DENIED;case Vn.FAILED_PRECONDITION:return Ce.FAILED_PRECONDITION;case Vn.ABORTED:return Ce.ABORTED;case Vn.OUT_OF_RANGE:return Ce.OUT_OF_RANGE;case Vn.UNIMPLEMENTED:return Ce.UNIMPLEMENTED;case Vn.DATA_LOSS:return Ce.DATA_LOSS;default:return qt(39323,{code:n})}}(Es=Vn||(Vn={}))[Es.OK=0]="OK",Es[Es.CANCELLED=1]="CANCELLED",Es[Es.UNKNOWN=2]="UNKNOWN",Es[Es.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Es[Es.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Es[Es.NOT_FOUND=5]="NOT_FOUND",Es[Es.ALREADY_EXISTS=6]="ALREADY_EXISTS",Es[Es.PERMISSION_DENIED=7]="PERMISSION_DENIED",Es[Es.UNAUTHENTICATED=16]="UNAUTHENTICATED",Es[Es.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Es[Es.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Es[Es.ABORTED=10]="ABORTED",Es[Es.OUT_OF_RANGE=11]="OUT_OF_RANGE",Es[Es.UNIMPLEMENTED=12]="UNIMPLEMENTED",Es[Es.INTERNAL=13]="INTERNAL",Es[Es.UNAVAILABLE=14]="UNAVAILABLE",Es[Es.DATA_LOSS=15]="DATA_LOSS";function yA(){return new TextEncoder}const bA=new io([4294967295,4294967295],0);function Vx(n){const e=yA().encode(n),t=new Gw;return t.update(e),new Uint8Array(t.digest())}function Ux(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),i=e.getUint32(4,!0),l=e.getUint32(8,!0),u=e.getUint32(12,!0);return[new io([t,i],0),new io([l,u],0)]}class my{constructor(e,t,i){if(this.bitmap=e,this.padding=t,this.hashCount=i,t<0||t>=8)throw new ou(`Invalid padding: ${t}`);if(i<0)throw new ou(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new ou(`Invalid hash count: ${i}`);if(e.length===0&&t!==0)throw new ou(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=io.fromNumber(this.ge)}ye(e,t,i){let l=e.add(t.multiply(io.fromNumber(i)));return l.compare(bA)===1&&(l=new io([l.getBits(0),l.getBits(1)],0)),l.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=Vx(e),[i,l]=Ux(t);for(let u=0;u<this.hashCount;u++){const d=this.ye(i,l,u);if(!this.we(d))return!1}return!0}static create(e,t,i){const l=e%8==0?0:8-e%8,u=new Uint8Array(Math.ceil(e/8)),d=new my(u,l,t);return i.forEach((p=>d.insert(p))),d}insert(e){if(this.ge===0)return;const t=Vx(e),[i,l]=Ux(t);for(let u=0;u<this.hashCount;u++){const d=this.ye(i,l,u);this.be(d)}}be(e){const t=Math.floor(e/8),i=e%8;this.bitmap[t]|=1<<i}}class ou extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class fm{constructor(e,t,i,l,u){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=i,this.documentUpdates=l,this.resolvedLimboDocuments=u}static createSynthesizedRemoteEventForCurrentChange(e,t,i){const l=new Map;return l.set(e,Vu.createSynthesizedTargetChangeForCurrentChange(e,t,i)),new fm(Qt.min(),l,new gn(xs),wi(),ws())}}class Vu{constructor(e,t,i,l,u){this.resumeToken=e,this.current=t,this.addedDocuments=i,this.modifiedDocuments=l,this.removedDocuments=u}static createSynthesizedTargetChangeForCurrentChange(e,t,i){return new Vu(i,t,ws(),ws(),ws())}}class Th{constructor(e,t,i,l){this.Se=e,this.removedTargetIds=t,this.key=i,this.De=l}}class P_{constructor(e,t){this.targetId=e,this.Ce=t}}class L_{constructor(e,t,i=or.EMPTY_BYTE_STRING,l=null){this.state=e,this.targetIds=t,this.resumeToken=i,this.cause=l}}class Fx{constructor(){this.ve=0,this.Fe=zx(),this.Me=or.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=ws(),t=ws(),i=ws();return this.Fe.forEach(((l,u)=>{switch(u){case 0:e=e.add(l);break;case 2:t=t.add(l);break;case 1:i=i.add(l);break;default:qt(38017,{changeType:u})}})),new Vu(this.Me,this.xe,e,t,i)}Ke(){this.Oe=!1,this.Fe=zx()}qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}Ue(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}$e(){this.ve+=1}We(){this.ve-=1,Fs(this.ve>=0,3241,{ve:this.ve})}Qe(){this.Oe=!0,this.xe=!0}}class vA{constructor(e){this.Ge=e,this.ze=new Map,this.je=wi(),this.He=ah(),this.Je=ah(),this.Ze=new gn(xs)}Xe(e){for(const t of e.Se)e.De&&e.De.isFoundDocument()?this.Ye(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const i=this.nt(t);switch(e.state){case 0:this.rt(t)&&i.Le(e.resumeToken);break;case 1:i.We(),i.Ne||i.Ke(),i.Le(e.resumeToken);break;case 2:i.We(),i.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(i.Qe(),i.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),i.Le(e.resumeToken));break;default:qt(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((i,l)=>{this.rt(l)&&t(l)}))}st(e){const t=e.targetId,i=e.Ce.count,l=this.ot(t);if(l){const u=l.target;if(xg(u))if(i===0){const d=new At(u.path);this.et(t,d,gr.newNoDocument(d,Qt.min()))}else Fs(i===1,20013,{expectedCount:i});else{const d=this._t(t);if(d!==i){const p=this.ut(e),g=p?this.ct(p,e,d):1;if(g!==0){this.it(t);const y=g===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(t,y)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:i="",padding:l=0},hashCount:u=0}=t;let d,p;try{d=ho(i).toUint8Array()}catch(g){if(g instanceof a_)return Xl("Decoding the base64 bloom filter in existence filter failed ("+g.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw g}try{p=new my(d,l,u)}catch(g){return Xl(g instanceof ou?"BloomFilter error: ":"Applying bloom filter failed: ",g),null}return p.ge===0?null:p}ct(e,t,i){return t.Ce.count===i-this.Pt(e,t.targetId)?0:2}Pt(e,t){const i=this.Ge.getRemoteKeysForTarget(t);let l=0;return i.forEach((u=>{const d=this.Ge.ht(),p=`projects/${d.projectId}/databases/${d.database}/documents/${u.path.canonicalString()}`;e.mightContain(p)||(this.et(t,u,null),l++)})),l}Tt(e){const t=new Map;this.ze.forEach(((u,d)=>{const p=this.ot(d);if(p){if(u.current&&xg(p.target)){const g=new At(p.target.path);this.It(g).has(d)||this.Et(d,g)||this.et(d,g,gr.newNoDocument(g,e))}u.Be&&(t.set(d,u.ke()),u.Ke())}}));let i=ws();this.Je.forEach(((u,d)=>{let p=!0;d.forEachWhile((g=>{const y=this.ot(g);return!y||y.purpose==="TargetPurposeLimboResolution"||(p=!1,!1)})),p&&(i=i.add(u))})),this.je.forEach(((u,d)=>d.setReadTime(e)));const l=new fm(e,t,this.Ze,this.je,i);return this.je=wi(),this.He=ah(),this.Je=ah(),this.Ze=new gn(xs),l}Ye(e,t){if(!this.rt(e))return;const i=this.Et(e,t.key)?2:0;this.nt(e).qe(t.key,i),this.je=this.je.insert(t.key,t),this.He=this.He.insert(t.key,this.It(t.key).add(e)),this.Je=this.Je.insert(t.key,this.Rt(t.key).add(e))}et(e,t,i){if(!this.rt(e))return;const l=this.nt(e);this.Et(e,t)?l.qe(t,1):l.Ue(t),this.Je=this.Je.insert(t,this.Rt(t).delete(e)),this.Je=this.Je.insert(t,this.Rt(t).add(e)),i&&(this.je=this.je.insert(t,i))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.nt(e).$e()}nt(e){let t=this.ze.get(e);return t||(t=new Fx,this.ze.set(e,t)),t}Rt(e){let t=this.Je.get(e);return t||(t=new Wn(xs),this.Je=this.Je.insert(e,t)),t}It(e){let t=this.He.get(e);return t||(t=new Wn(xs),this.He=this.He.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||ht("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new Fx),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function ah(){return new gn(At.comparator)}function zx(){return new gn(At.comparator)}const xA={asc:"ASCENDING",desc:"DESCENDING"},wA={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},_A={and:"AND",or:"OR"};class kA{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function _g(n,e){return n.useProto3Json||im(e)?e:{value:e}}function zh(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function O_(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function jA(n,e){return zh(n,e.toTimestamp())}function Ha(n){return Fs(!!n,49232),Qt.fromTimestamp((function(t){const i=uo(t);return new kt(i.seconds,i.nanos)})(n))}function fy(n,e){return kg(n,e).canonicalString()}function kg(n,e){const t=(function(l){return new an(["projects",l.projectId,"databases",l.database])})(n).child("documents");return e===void 0?t:t.child(e)}function B_(n){const e=an.fromString(n);return Fs(q_(e),10190,{key:e.toString()}),e}function jg(n,e){return fy(n.databaseId,e.path)}function Dp(n,e){const t=B_(e);if(t.get(1)!==n.databaseId.projectId)throw new at(Ce.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new at(Ce.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new At(U_(t))}function V_(n,e){return fy(n.databaseId,e)}function TA(n){const e=B_(n);return e.length===4?an.emptyPath():U_(e)}function Tg(n){return new an(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function U_(n){return Fs(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function qx(n,e,t){return{name:jg(n,e),fields:t.value.mapValue.fields}}function EA(n,e){let t;if("targetChange"in e){e.targetChange;const i=(function(y){return y==="NO_CHANGE"?0:y==="ADD"?1:y==="REMOVE"?2:y==="CURRENT"?3:y==="RESET"?4:qt(39313,{state:y})})(e.targetChange.targetChangeType||"NO_CHANGE"),l=e.targetChange.targetIds||[],u=(function(y,x){return y.useProto3Json?(Fs(x===void 0||typeof x=="string",58123),or.fromBase64String(x||"")):(Fs(x===void 0||x instanceof Buffer||x instanceof Uint8Array,16193),or.fromUint8Array(x||new Uint8Array))})(n,e.targetChange.resumeToken),d=e.targetChange.cause,p=d&&(function(y){const x=y.code===void 0?Ce.UNKNOWN:D_(y.code);return new at(x,y.message||"")})(d);t=new L_(i,l,u,p||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const l=Dp(n,i.document.name),u=Ha(i.document.updateTime),d=i.document.createTime?Ha(i.document.createTime):Qt.min(),p=new Br({mapValue:{fields:i.document.fields}}),g=gr.newFoundDocument(l,u,d,p),y=i.targetIds||[],x=i.removedTargetIds||[];t=new Th(y,x,g.key,g)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const l=Dp(n,i.document),u=i.readTime?Ha(i.readTime):Qt.min(),d=gr.newNoDocument(l,u),p=i.removedTargetIds||[];t=new Th([],p,d.key,d)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const l=Dp(n,i.document),u=i.removedTargetIds||[];t=new Th([],u,l,null)}else{if(!("filter"in e))return qt(11601,{Vt:e});{e.filter;const i=e.filter;i.targetId;const{count:l=0,unchangedNames:u}=i,d=new pA(l,u),p=i.targetId;t=new P_(p,d)}}return t}function SA(n,e){let t;if(e instanceof Bu)t={update:qx(n,e.key,e.value)};else if(e instanceof mm)t={delete:jg(n,e.key)};else if(e instanceof vo)t={update:qx(n,e.key,e.data),updateMask:LA(e.fieldMask)};else{if(!(e instanceof hA))return qt(16599,{dt:e.type});t={verify:jg(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((i=>(function(u,d){const p=d.transform;if(p instanceof Tu)return{fieldPath:d.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(p instanceof Eu)return{fieldPath:d.field.canonicalString(),appendMissingElements:{values:p.elements}};if(p instanceof Su)return{fieldPath:d.field.canonicalString(),removeAllFromArray:{values:p.elements}};if(p instanceof Nu)return{fieldPath:d.field.canonicalString(),increment:p.Ae};throw qt(20930,{transform:d.transform})})(0,i)))),e.precondition.isNone||(t.currentDocument=(function(l,u){return u.updateTime!==void 0?{updateTime:jA(l,u.updateTime)}:u.exists!==void 0?{exists:u.exists}:qt(27497)})(n,e.precondition)),t}function NA(n,e){return n&&n.length>0?(Fs(e!==void 0,14353),n.map((t=>(function(l,u){let d=l.updateTime?Ha(l.updateTime):Ha(u);return d.isEqual(Qt.min())&&(d=Ha(u)),new cA(d,l.transformResults||[])})(t,e)))):[]}function CA(n,e){return{documents:[V_(n,e.path)]}}function RA(n,e){const t={structuredQuery:{}},i=e.path;let l;e.collectionGroup!==null?(l=i,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(l=i.popLast(),t.structuredQuery.from=[{collectionId:i.lastSegment()}]),t.parent=V_(n,l);const u=(function(y){if(y.length!==0)return z_(Ea.create(y,"and"))})(e.filters);u&&(t.structuredQuery.where=u);const d=(function(y){if(y.length!==0)return y.map((x=>(function(T){return{field:ql(T.field),direction:IA(T.dir)}})(x)))})(e.orderBy);d&&(t.structuredQuery.orderBy=d);const p=_g(n,e.limit);return p!==null&&(t.structuredQuery.limit=p),e.startAt&&(t.structuredQuery.startAt=(function(y){return{before:y.inclusive,values:y.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(y){return{before:!y.inclusive,values:y.position}})(e.endAt)),{ft:t,parent:l}}function AA(n){let e=TA(n.parent);const t=n.structuredQuery,i=t.from?t.from.length:0;let l=null;if(i>0){Fs(i===1,65062);const x=t.from[0];x.allDescendants?l=x.collectionId:e=e.child(x.collectionId)}let u=[];t.where&&(u=(function(k){const T=F_(k);return T instanceof Ea&&p_(T)?T.getFilters():[T]})(t.where));let d=[];t.orderBy&&(d=(function(k){return k.map((T=>(function(G){return new ju(Hl(G.field),(function(V){switch(V){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(G.direction))})(T)))})(t.orderBy));let p=null;t.limit&&(p=(function(k){let T;return T=typeof k=="object"?k.value:k,im(T)?null:T})(t.limit));let g=null;t.startAt&&(g=(function(k){const T=!!k.before,O=k.values||[];return new Uh(O,T)})(t.startAt));let y=null;return t.endAt&&(y=(function(k){const T=!k.before,O=k.values||[];return new Uh(O,T)})(t.endAt)),YR(e,l,d,u,p,"F",g,y)}function MA(n,e){const t=(function(l){switch(l){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return qt(28987,{purpose:l})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function F_(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const i=Hl(t.unaryFilter.field);return Un.create(i,"==",{doubleValue:NaN});case"IS_NULL":const l=Hl(t.unaryFilter.field);return Un.create(l,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const u=Hl(t.unaryFilter.field);return Un.create(u,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const d=Hl(t.unaryFilter.field);return Un.create(d,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return qt(61313);default:return qt(60726)}})(n):n.fieldFilter!==void 0?(function(t){return Un.create(Hl(t.fieldFilter.field),(function(l){switch(l){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return qt(58110);default:return qt(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return Ea.create(t.compositeFilter.filters.map((i=>F_(i))),(function(l){switch(l){case"AND":return"and";case"OR":return"or";default:return qt(1026)}})(t.compositeFilter.op))})(n):qt(30097,{filter:n})}function IA(n){return xA[n]}function DA(n){return wA[n]}function PA(n){return _A[n]}function ql(n){return{fieldPath:n.canonicalString()}}function Hl(n){return ir.fromServerFormat(n.fieldPath)}function z_(n){return n instanceof Un?(function(t){if(t.op==="=="){if(Rx(t.value))return{unaryFilter:{field:ql(t.field),op:"IS_NAN"}};if(Cx(t.value))return{unaryFilter:{field:ql(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(Rx(t.value))return{unaryFilter:{field:ql(t.field),op:"IS_NOT_NAN"}};if(Cx(t.value))return{unaryFilter:{field:ql(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ql(t.field),op:DA(t.op),value:t.value}}})(n):n instanceof Ea?(function(t){const i=t.getFilters().map((l=>z_(l)));return i.length===1?i[0]:{compositeFilter:{op:PA(t.op),filters:i}}})(n):qt(54877,{filter:n})}function LA(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function q_(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}function H_(n){return!!n&&typeof n._toProto=="function"&&n._protoValueType==="ProtoValue"}class to{constructor(e,t,i,l,u=Qt.min(),d=Qt.min(),p=or.EMPTY_BYTE_STRING,g=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=l,this.snapshotVersion=u,this.lastLimboFreeSnapshotVersion=d,this.resumeToken=p,this.expectedCount=g}withSequenceNumber(e){return new to(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new to(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new to(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new to(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class OA{constructor(e){this.yt=e}}function BA(n){const e=AA({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Fh(e,e.limit,"L"):e}class VA{constructor(){this.Sn=new UA}addToCollectionParentIndex(e,t){return this.Sn.add(t),Pe.resolve()}getCollectionParents(e,t){return Pe.resolve(this.Sn.getEntries(t))}addFieldIndex(e,t){return Pe.resolve()}deleteFieldIndex(e,t){return Pe.resolve()}deleteAllFieldIndexes(e){return Pe.resolve()}createTargetIndexes(e,t){return Pe.resolve()}getDocumentsMatchingTarget(e,t){return Pe.resolve(null)}getIndexType(e,t){return Pe.resolve(0)}getFieldIndexes(e,t){return Pe.resolve([])}getNextCollectionGroupToUpdate(e){return Pe.resolve(null)}getMinOffset(e,t){return Pe.resolve(co.min())}getMinOffsetFromCollectionGroup(e,t){return Pe.resolve(co.min())}updateCollectionGroup(e,t,i){return Pe.resolve()}updateIndexEntries(e,t){return Pe.resolve()}}class UA{constructor(){this.index={}}add(e){const t=e.lastSegment(),i=e.popLast(),l=this.index[t]||new Wn(an.comparator),u=!l.has(i);return this.index[t]=l.add(i),u}has(e){const t=e.lastSegment(),i=e.popLast(),l=this.index[t];return l&&l.has(i)}getEntries(e){return(this.index[e]||new Wn(an.comparator)).toArray()}}const Hx={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},$_=41943040;class Or{static withCacheSize(e){return new Or(e,Or.DEFAULT_COLLECTION_PERCENTILE,Or.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}}Or.DEFAULT_COLLECTION_PERCENTILE=10,Or.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Or.DEFAULT=new Or($_,Or.DEFAULT_COLLECTION_PERCENTILE,Or.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Or.DISABLED=new Or(-1,0,0);class tc{constructor(e){this.sr=e}next(){return this.sr+=2,this.sr}static _r(){return new tc(0)}static ar(){return new tc(-1)}}const $x="LruGarbageCollector",FA=1048576;function Wx([n,e],[t,i]){const l=xs(n,t);return l===0?xs(e,i):l}class zA{constructor(e){this.Pr=e,this.buffer=new Wn(Wx),this.Tr=0}Ir(){return++this.Tr}Er(e){const t=[e,this.Ir()];if(this.buffer.size<this.Pr)this.buffer=this.buffer.add(t);else{const i=this.buffer.last();Wx(t,i)<0&&(this.buffer=this.buffer.delete(i).add(t))}}get maxValue(){return this.buffer.last()[0]}}class qA{constructor(e,t,i){this.garbageCollector=e,this.asyncQueue=t,this.localStore=i,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Ar(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Ar(e){ht($x,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){cc(t)?ht($x,"Ignoring IndexedDB error during garbage collection: ",t):await lc(t)}await this.Ar(3e5)}))}}class HA{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.dr(e).next((i=>Math.floor(t/100*i)))}nthSequenceNumber(e,t){if(t===0)return Pe.resolve(am.ce);const i=new zA(t);return this.Vr.forEachTarget(e,(l=>i.Er(l.sequenceNumber))).next((()=>this.Vr.mr(e,(l=>i.Er(l))))).next((()=>i.maxValue))}removeTargets(e,t,i){return this.Vr.removeTargets(e,t,i)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(ht("LruGarbageCollector","Garbage collection skipped; disabled"),Pe.resolve(Hx)):this.getCacheSize(e).next((i=>i<this.params.cacheSizeCollectionThreshold?(ht("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Hx):this.gr(e,t)))}getCacheSize(e){return this.Vr.getCacheSize(e)}gr(e,t){let i,l,u,d,p,g,y;const x=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((k=>(k>this.params.maximumSequenceNumbersToCollect?(ht("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${k}`),l=this.params.maximumSequenceNumbersToCollect):l=k,d=Date.now(),this.nthSequenceNumber(e,l)))).next((k=>(i=k,p=Date.now(),this.removeTargets(e,i,t)))).next((k=>(u=k,g=Date.now(),this.removeOrphanedDocuments(e,i)))).next((k=>(y=Date.now(),Fl()<=vs.DEBUG&&ht("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${d-x}ms
	Determined least recently used ${l} in `+(p-d)+`ms
	Removed ${u} targets in `+(g-p)+`ms
	Removed ${k} documents in `+(y-g)+`ms
Total Duration: ${y-x}ms`),Pe.resolve({didRun:!0,sequenceNumbersCollected:l,targetsRemoved:u,documentsRemoved:k}))))}}function $A(n,e){return new HA(n,e)}class WA{constructor(){this.changes=new sl((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,gr.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const i=this.changes.get(t);return i!==void 0?Pe.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class GA{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class KA{constructor(e,t,i,l){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=l}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next((l=>(i=l,this.remoteDocumentCache.getEntry(e,t)))).next((l=>(i!==null&&fu(i.mutation,l,Xr.empty(),kt.now()),l)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.getLocalViewOfDocuments(e,i,ws()).next((()=>i))))}getLocalViewOfDocuments(e,t,i=ws()){const l=Fo();return this.populateOverlays(e,l,t).next((()=>this.computeViews(e,t,l,i).next((u=>{let d=iu();return u.forEach(((p,g)=>{d=d.insert(p,g.overlayedDocument)})),d}))))}getOverlayedDocuments(e,t){const i=Fo();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,ws())))}populateOverlays(e,t,i){const l=[];return i.forEach((u=>{t.has(u)||l.push(u)})),this.documentOverlayCache.getOverlays(e,l).next((u=>{u.forEach(((d,p)=>{t.set(d,p)}))}))}computeViews(e,t,i,l){let u=wi();const d=mu(),p=(function(){return mu()})();return t.forEach(((g,y)=>{const x=i.get(y.key);l.has(y.key)&&(x===void 0||x.mutation instanceof vo)?u=u.insert(y.key,y):x!==void 0?(d.set(y.key,x.mutation.getFieldMask()),fu(x.mutation,y,x.mutation.getFieldMask(),kt.now())):d.set(y.key,Xr.empty())})),this.recalculateAndSaveOverlays(e,u).next((g=>(g.forEach(((y,x)=>d.set(y,x))),t.forEach(((y,x)=>p.set(y,new GA(x,d.get(y)??null)))),p)))}recalculateAndSaveOverlays(e,t){const i=mu();let l=new gn(((d,p)=>d-p)),u=ws();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((d=>{for(const p of d)p.keys().forEach((g=>{const y=t.get(g);if(y===null)return;let x=i.get(g)||Xr.empty();x=p.applyToLocalView(y,x),i.set(g,x);const k=(l.get(p.batchId)||ws()).add(g);l=l.insert(p.batchId,k)}))})).next((()=>{const d=[],p=l.getReverseIterator();for(;p.hasNext();){const g=p.getNext(),y=g.key,x=g.value,k=j_();x.forEach((T=>{if(!u.has(T)){const O=M_(t.get(T),i.get(T));O!==null&&k.set(T,O),u=u.add(T)}})),d.push(this.documentOverlayCache.saveOverlays(e,y,k))}return Pe.waitFor(d)})).next((()=>i))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.recalculateAndSaveOverlays(e,i)))}getDocumentsMatchingQuery(e,t,i,l){return QR(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):v_(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i,l):this.getDocumentsMatchingCollectionQuery(e,t,i,l)}getNextDocuments(e,t,i,l){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,l).next((u=>{const d=l-u.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,l-u.size):Pe.resolve(Fo());let p=xu,g=u;return d.next((y=>Pe.forEach(y,((x,k)=>(p<k.largestBatchId&&(p=k.largestBatchId),u.get(x)?Pe.resolve():this.remoteDocumentCache.getEntry(e,x).next((T=>{g=g.insert(x,T)}))))).next((()=>this.populateOverlays(e,y,u))).next((()=>this.computeViews(e,g,y,ws()))).next((x=>({batchId:p,changes:k_(x)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new At(t)).next((i=>{let l=iu();return i.isFoundDocument()&&(l=l.insert(i.key,i)),l}))}getDocumentsMatchingCollectionGroupQuery(e,t,i,l){const u=t.collectionGroup;let d=iu();return this.indexManager.getCollectionParents(e,u).next((p=>Pe.forEach(p,(g=>{const y=(function(k,T){return new uc(T,null,k.explicitOrderBy.slice(),k.filters.slice(),k.limit,k.limitType,k.startAt,k.endAt)})(t,g.child(u));return this.getDocumentsMatchingCollectionQuery(e,y,i,l).next((x=>{x.forEach(((k,T)=>{d=d.insert(k,T)}))}))})).next((()=>d))))}getDocumentsMatchingCollectionQuery(e,t,i,l){let u;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next((d=>(u=d,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,u,l)))).next((d=>{u.forEach(((g,y)=>{const x=y.getKey();d.get(x)===null&&(d=d.insert(x,gr.newInvalidDocument(x)))}));let p=iu();return d.forEach(((g,y)=>{const x=u.get(g);x!==void 0&&fu(x.mutation,y,Xr.empty(),kt.now()),um(t,y)&&(p=p.insert(g,y))})),p}))}}class YA{constructor(e){this.serializer=e,this.Nr=new Map,this.Br=new Map}getBundleMetadata(e,t){return Pe.resolve(this.Nr.get(t))}saveBundleMetadata(e,t){return this.Nr.set(t.id,(function(l){return{id:l.id,version:l.version,createTime:Ha(l.createTime)}})(t)),Pe.resolve()}getNamedQuery(e,t){return Pe.resolve(this.Br.get(t))}saveNamedQuery(e,t){return this.Br.set(t.name,(function(l){return{name:l.name,query:BA(l.bundledQuery),readTime:Ha(l.readTime)}})(t)),Pe.resolve()}}class QA{constructor(){this.overlays=new gn(At.comparator),this.Lr=new Map}getOverlay(e,t){return Pe.resolve(this.overlays.get(t))}getOverlays(e,t){const i=Fo();return Pe.forEach(t,(l=>this.getOverlay(e,l).next((u=>{u!==null&&i.set(l,u)})))).next((()=>i))}saveOverlays(e,t,i){return i.forEach(((l,u)=>{this.bt(e,t,u)})),Pe.resolve()}removeOverlaysForBatchId(e,t,i){const l=this.Lr.get(i);return l!==void 0&&(l.forEach((u=>this.overlays=this.overlays.remove(u))),this.Lr.delete(i)),Pe.resolve()}getOverlaysForCollection(e,t,i){const l=Fo(),u=t.length+1,d=new At(t.child("")),p=this.overlays.getIteratorFrom(d);for(;p.hasNext();){const g=p.getNext().value,y=g.getKey();if(!t.isPrefixOf(y.path))break;y.path.length===u&&g.largestBatchId>i&&l.set(g.getKey(),g)}return Pe.resolve(l)}getOverlaysForCollectionGroup(e,t,i,l){let u=new gn(((y,x)=>y-x));const d=this.overlays.getIterator();for(;d.hasNext();){const y=d.getNext().value;if(y.getKey().getCollectionGroup()===t&&y.largestBatchId>i){let x=u.get(y.largestBatchId);x===null&&(x=Fo(),u=u.insert(y.largestBatchId,x)),x.set(y.getKey(),y)}}const p=Fo(),g=u.getIterator();for(;g.hasNext()&&(g.getNext().value.forEach(((y,x)=>p.set(y,x))),!(p.size()>=l)););return Pe.resolve(p)}bt(e,t,i){const l=this.overlays.get(i.key);if(l!==null){const d=this.Lr.get(l.largestBatchId).delete(i.key);this.Lr.set(l.largestBatchId,d)}this.overlays=this.overlays.insert(i.key,new fA(t,i));let u=this.Lr.get(t);u===void 0&&(u=ws(),this.Lr.set(t,u)),this.Lr.set(t,u.add(i.key))}}class XA{constructor(){this.sessionToken=or.EMPTY_BYTE_STRING}getSessionToken(e){return Pe.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,Pe.resolve()}}class py{constructor(){this.kr=new Wn(Zn.Kr),this.qr=new Wn(Zn.Ur)}isEmpty(){return this.kr.isEmpty()}addReference(e,t){const i=new Zn(e,t);this.kr=this.kr.add(i),this.qr=this.qr.add(i)}$r(e,t){e.forEach((i=>this.addReference(i,t)))}removeReference(e,t){this.Wr(new Zn(e,t))}Qr(e,t){e.forEach((i=>this.removeReference(i,t)))}Gr(e){const t=new At(new an([])),i=new Zn(t,e),l=new Zn(t,e+1),u=[];return this.qr.forEachInRange([i,l],(d=>{this.Wr(d),u.push(d.key)})),u}zr(){this.kr.forEach((e=>this.Wr(e)))}Wr(e){this.kr=this.kr.delete(e),this.qr=this.qr.delete(e)}jr(e){const t=new At(new an([])),i=new Zn(t,e),l=new Zn(t,e+1);let u=ws();return this.qr.forEachInRange([i,l],(d=>{u=u.add(d.key)})),u}containsKey(e){const t=new Zn(e,0),i=this.kr.firstAfterOrEqual(t);return i!==null&&e.isEqual(i.key)}}class Zn{constructor(e,t){this.key=e,this.Hr=t}static Kr(e,t){return At.comparator(e.key,t.key)||xs(e.Hr,t.Hr)}static Ur(e,t){return xs(e.Hr,t.Hr)||At.comparator(e.key,t.key)}}class JA{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Yn=1,this.Jr=new Wn(Zn.Kr)}checkEmpty(e){return Pe.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,i,l){const u=this.Yn;this.Yn++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const d=new mA(u,t,i,l);this.mutationQueue.push(d);for(const p of l)this.Jr=this.Jr.add(new Zn(p.key,u)),this.indexManager.addToCollectionParentIndex(e,p.key.path.popLast());return Pe.resolve(d)}lookupMutationBatch(e,t){return Pe.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,l=this.Xr(i),u=l<0?0:l;return Pe.resolve(this.mutationQueue.length>u?this.mutationQueue[u]:null)}getHighestUnacknowledgedBatchId(){return Pe.resolve(this.mutationQueue.length===0?iy:this.Yn-1)}getAllMutationBatches(e){return Pe.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const i=new Zn(t,0),l=new Zn(t,Number.POSITIVE_INFINITY),u=[];return this.Jr.forEachInRange([i,l],(d=>{const p=this.Zr(d.Hr);u.push(p)})),Pe.resolve(u)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new Wn(xs);return t.forEach((l=>{const u=new Zn(l,0),d=new Zn(l,Number.POSITIVE_INFINITY);this.Jr.forEachInRange([u,d],(p=>{i=i.add(p.Hr)}))})),Pe.resolve(this.Yr(i))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,l=i.length+1;let u=i;At.isDocumentKey(u)||(u=u.child(""));const d=new Zn(new At(u),0);let p=new Wn(xs);return this.Jr.forEachWhile((g=>{const y=g.key.path;return!!i.isPrefixOf(y)&&(y.length===l&&(p=p.add(g.Hr)),!0)}),d),Pe.resolve(this.Yr(p))}Yr(e){const t=[];return e.forEach((i=>{const l=this.Zr(i);l!==null&&t.push(l)})),t}removeMutationBatch(e,t){Fs(this.ei(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.Jr;return Pe.forEach(t.mutations,(l=>{const u=new Zn(l.key,t.batchId);return i=i.delete(u),this.referenceDelegate.markPotentiallyOrphaned(e,l.key)})).next((()=>{this.Jr=i}))}nr(e){}containsKey(e,t){const i=new Zn(t,0),l=this.Jr.firstAfterOrEqual(i);return Pe.resolve(t.isEqual(l&&l.key))}performConsistencyCheck(e){return this.mutationQueue.length,Pe.resolve()}ei(e,t){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class ZA{constructor(e){this.ti=e,this.docs=(function(){return new gn(At.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const i=t.key,l=this.docs.get(i),u=l?l.size:0,d=this.ti(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:d}),this.size+=d-u,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const i=this.docs.get(t);return Pe.resolve(i?i.document.mutableCopy():gr.newInvalidDocument(t))}getEntries(e,t){let i=wi();return t.forEach((l=>{const u=this.docs.get(l);i=i.insert(l,u?u.document.mutableCopy():gr.newInvalidDocument(l))})),Pe.resolve(i)}getDocumentsMatchingQuery(e,t,i,l){let u=wi();const d=t.path,p=new At(d.child("__id-9223372036854775808__")),g=this.docs.getIteratorFrom(p);for(;g.hasNext();){const{key:y,value:{document:x}}=g.getNext();if(!d.isPrefixOf(y.path))break;y.path.length>d.length+1||ER(TR(x),i)<=0||(l.has(x.key)||um(t,x))&&(u=u.insert(x.key,x.mutableCopy()))}return Pe.resolve(u)}getAllFromCollectionGroup(e,t,i,l){qt(9500)}ni(e,t){return Pe.forEach(this.docs,(i=>t(i)))}newChangeBuffer(e){return new eM(this)}getSize(e){return Pe.resolve(this.size)}}class eM extends WA{constructor(e){super(),this.Mr=e}applyChanges(e){const t=[];return this.changes.forEach(((i,l)=>{l.isValidDocument()?t.push(this.Mr.addEntry(e,l)):this.Mr.removeEntry(i)})),Pe.waitFor(t)}getFromCache(e,t){return this.Mr.getEntry(e,t)}getAllFromCache(e,t){return this.Mr.getEntries(e,t)}}class tM{constructor(e){this.persistence=e,this.ri=new sl((t=>cy(t)),uy),this.lastRemoteSnapshotVersion=Qt.min(),this.highestTargetId=0,this.ii=0,this.si=new py,this.targetCount=0,this.oi=tc._r()}forEachTarget(e,t){return this.ri.forEach(((i,l)=>t(l))),Pe.resolve()}getLastRemoteSnapshotVersion(e){return Pe.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Pe.resolve(this.ii)}allocateTargetId(e){return this.highestTargetId=this.oi.next(),Pe.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.ii&&(this.ii=t),Pe.resolve()}lr(e){this.ri.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.oi=new tc(t),this.highestTargetId=t),e.sequenceNumber>this.ii&&(this.ii=e.sequenceNumber)}addTargetData(e,t){return this.lr(t),this.targetCount+=1,Pe.resolve()}updateTargetData(e,t){return this.lr(t),Pe.resolve()}removeTargetData(e,t){return this.ri.delete(t.target),this.si.Gr(t.targetId),this.targetCount-=1,Pe.resolve()}removeTargets(e,t,i){let l=0;const u=[];return this.ri.forEach(((d,p)=>{p.sequenceNumber<=t&&i.get(p.targetId)===null&&(this.ri.delete(d),u.push(this.removeMatchingKeysForTargetId(e,p.targetId)),l++)})),Pe.waitFor(u).next((()=>l))}getTargetCount(e){return Pe.resolve(this.targetCount)}getTargetData(e,t){const i=this.ri.get(t)||null;return Pe.resolve(i)}addMatchingKeys(e,t,i){return this.si.$r(t,i),Pe.resolve()}removeMatchingKeys(e,t,i){this.si.Qr(t,i);const l=this.persistence.referenceDelegate,u=[];return l&&t.forEach((d=>{u.push(l.markPotentiallyOrphaned(e,d))})),Pe.waitFor(u)}removeMatchingKeysForTargetId(e,t){return this.si.Gr(t),Pe.resolve()}getMatchingKeysForTargetId(e,t){const i=this.si.jr(t);return Pe.resolve(i)}containsKey(e,t){return Pe.resolve(this.si.containsKey(t))}}class W_{constructor(e,t){this._i={},this.overlays={},this.ai=new am(0),this.ui=!1,this.ui=!0,this.ci=new XA,this.referenceDelegate=e(this),this.li=new tM(this),this.indexManager=new VA,this.remoteDocumentCache=(function(l){return new ZA(l)})((i=>this.referenceDelegate.hi(i))),this.serializer=new OA(t),this.Pi=new YA(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ui=!1,Promise.resolve()}get started(){return this.ui}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new QA,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this._i[e.toKey()];return i||(i=new JA(t,this.referenceDelegate),this._i[e.toKey()]=i),i}getGlobalsCache(){return this.ci}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Pi}runTransaction(e,t,i){ht("MemoryPersistence","Starting transaction:",e);const l=new sM(this.ai.next());return this.referenceDelegate.Ti(),i(l).next((u=>this.referenceDelegate.Ii(l).next((()=>u)))).toPromise().then((u=>(l.raiseOnCommittedEvent(),u)))}Ei(e,t){return Pe.or(Object.values(this._i).map((i=>()=>i.containsKey(e,t))))}}class sM extends NR{constructor(e){super(),this.currentSequenceNumber=e}}class gy{constructor(e){this.persistence=e,this.Ri=new py,this.Ai=null}static Vi(e){return new gy(e)}get di(){if(this.Ai)return this.Ai;throw qt(60996)}addReference(e,t,i){return this.Ri.addReference(i,t),this.di.delete(i.toString()),Pe.resolve()}removeReference(e,t,i){return this.Ri.removeReference(i,t),this.di.add(i.toString()),Pe.resolve()}markPotentiallyOrphaned(e,t){return this.di.add(t.toString()),Pe.resolve()}removeTarget(e,t){this.Ri.Gr(t.targetId).forEach((l=>this.di.add(l.toString())));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next((l=>{l.forEach((u=>this.di.add(u.toString())))})).next((()=>i.removeTargetData(e,t)))}Ti(){this.Ai=new Set}Ii(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Pe.forEach(this.di,(i=>{const l=At.fromPath(i);return this.mi(e,l).next((u=>{u||t.removeEntry(l,Qt.min())}))})).next((()=>(this.Ai=null,t.apply(e))))}updateLimboDocument(e,t){return this.mi(e,t).next((i=>{i?this.di.delete(t.toString()):this.di.add(t.toString())}))}hi(e){return 0}mi(e,t){return Pe.or([()=>Pe.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}}class qh{constructor(e,t){this.persistence=e,this.fi=new sl((i=>AR(i.path)),((i,l)=>i.isEqual(l))),this.garbageCollector=$A(this,t)}static Vi(e,t){return new qh(e,t)}Ti(){}Ii(e){return Pe.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}dr(e){const t=this.pr(e);return this.persistence.getTargetCache().getTargetCount(e).next((i=>t.next((l=>i+l))))}pr(e){let t=0;return this.mr(e,(i=>{t++})).next((()=>t))}mr(e,t){return Pe.forEach(this.fi,((i,l)=>this.wr(e,i,l).next((u=>u?Pe.resolve():t(l)))))}removeTargets(e,t,i){return this.persistence.getTargetCache().removeTargets(e,t,i)}removeOrphanedDocuments(e,t){let i=0;const l=this.persistence.getRemoteDocumentCache(),u=l.newChangeBuffer();return l.ni(e,(d=>this.wr(e,d,t).next((p=>{p||(i++,u.removeEntry(d,Qt.min()))})))).next((()=>u.apply(e))).next((()=>i))}markPotentiallyOrphaned(e,t){return this.fi.set(t,e.currentSequenceNumber),Pe.resolve()}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,i)}addReference(e,t,i){return this.fi.set(i,e.currentSequenceNumber),Pe.resolve()}removeReference(e,t,i){return this.fi.set(i,e.currentSequenceNumber),Pe.resolve()}updateLimboDocument(e,t){return this.fi.set(t,e.currentSequenceNumber),Pe.resolve()}hi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=_h(e.data.value)),t}wr(e,t,i){return Pe.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const l=this.fi.get(t);return Pe.resolve(l!==void 0&&l>i)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class yy{constructor(e,t,i,l){this.targetId=e,this.fromCache=t,this.Ts=i,this.Is=l}static Es(e,t){let i=ws(),l=ws();for(const u of t.docChanges)switch(u.type){case 0:i=i.add(u.doc.key);break;case 1:l=l.add(u.doc.key)}return new yy(e,t.fromCache,i,l)}}class nM{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class rM{constructor(){this.Rs=!1,this.As=!1,this.Vs=100,this.ds=(function(){return AS()?8:CR(br())>0?6:4})()}initialize(e,t){this.fs=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,i,l){const u={result:null};return this.gs(e,t).next((d=>{u.result=d})).next((()=>{if(!u.result)return this.ps(e,t,l,i).next((d=>{u.result=d}))})).next((()=>{if(u.result)return;const d=new nM;return this.ys(e,t,d).next((p=>{if(u.result=p,this.As)return this.ws(e,t,d,p.size)}))})).next((()=>u.result))}ws(e,t,i,l){return i.documentReadCount<this.Vs?(Fl()<=vs.DEBUG&&ht("QueryEngine","SDK will not create cache indexes for query:",zl(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),Pe.resolve()):(Fl()<=vs.DEBUG&&ht("QueryEngine","Query:",zl(t),"scans",i.documentReadCount,"local documents and returns",l,"documents as results."),i.documentReadCount>this.ds*l?(Fl()<=vs.DEBUG&&ht("QueryEngine","The SDK decides to create cache indexes for query:",zl(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,qa(t))):Pe.resolve())}gs(e,t){if(Dx(t))return Pe.resolve(null);let i=qa(t);return this.indexManager.getIndexType(e,i).next((l=>l===0?null:(t.limit!==null&&l===1&&(t=Fh(t,null,"F"),i=qa(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next((u=>{const d=ws(...u);return this.fs.getDocuments(e,d).next((p=>this.indexManager.getMinOffset(e,i).next((g=>{const y=this.bs(t,p);return this.Ss(t,y,d,g.readTime)?this.gs(e,Fh(t,null,"F")):this.Ds(e,y,t,g)}))))})))))}ps(e,t,i,l){return Dx(t)||l.isEqual(Qt.min())?Pe.resolve(null):this.fs.getDocuments(e,i).next((u=>{const d=this.bs(t,u);return this.Ss(t,d,i,l)?Pe.resolve(null):(Fl()<=vs.DEBUG&&ht("QueryEngine","Re-using previous result from %s to execute query: %s",l.toString(),zl(t)),this.Ds(e,d,t,jR(l,xu)).next((p=>p)))}))}bs(e,t){let i=new Wn(w_(e));return t.forEach(((l,u)=>{um(e,u)&&(i=i.add(u))})),i}Ss(e,t,i,l){if(e.limit===null)return!1;if(i.size!==t.size)return!0;const u=e.limitType==="F"?t.last():t.first();return!!u&&(u.hasPendingWrites||u.version.compareTo(l)>0)}ys(e,t,i){return Fl()<=vs.DEBUG&&ht("QueryEngine","Using full collection scan to execute query:",zl(t)),this.fs.getDocumentsMatchingQuery(e,t,co.min(),i)}Ds(e,t,i,l){return this.fs.getDocumentsMatchingQuery(e,i,l).next((u=>(t.forEach((d=>{u=u.insert(d.key,d)})),u)))}}const by="LocalStore",aM=3e8;class iM{constructor(e,t,i,l){this.persistence=e,this.Cs=t,this.serializer=l,this.vs=new gn(xs),this.Fs=new sl((u=>cy(u)),uy),this.Ms=new Map,this.xs=e.getRemoteDocumentCache(),this.li=e.getTargetCache(),this.Pi=e.getBundleCache(),this.Os(i)}Os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new KA(this.xs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.xs.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.vs)))}}function oM(n,e,t,i){return new iM(n,e,t,i)}async function G_(n,e){const t=es(n);return await t.persistence.runTransaction("Handle user change","readonly",(i=>{let l;return t.mutationQueue.getAllMutationBatches(i).next((u=>(l=u,t.Os(e),t.mutationQueue.getAllMutationBatches(i)))).next((u=>{const d=[],p=[];let g=ws();for(const y of l){d.push(y.batchId);for(const x of y.mutations)g=g.add(x.key)}for(const y of u){p.push(y.batchId);for(const x of y.mutations)g=g.add(x.key)}return t.localDocuments.getDocuments(i,g).next((y=>({Ns:y,removedBatchIds:d,addedBatchIds:p})))}))}))}function lM(n,e){const t=es(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(i=>{const l=e.batch.keys(),u=t.xs.newChangeBuffer({trackRemovals:!0});return(function(p,g,y,x){const k=y.batch,T=k.keys();let O=Pe.resolve();return T.forEach((G=>{O=O.next((()=>x.getEntry(g,G))).next((F=>{const V=y.docVersions.get(G);Fs(V!==null,48541),F.version.compareTo(V)<0&&(k.applyToRemoteDocument(F,y),F.isValidDocument()&&(F.setReadTime(y.commitVersion),x.addEntry(F)))}))})),O.next((()=>p.mutationQueue.removeMutationBatch(g,k)))})(t,i,e,u).next((()=>u.apply(i))).next((()=>t.mutationQueue.performConsistencyCheck(i))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(i,l,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,(function(p){let g=ws();for(let y=0;y<p.mutationResults.length;++y)p.mutationResults[y].transformResults.length>0&&(g=g.add(p.batch.mutations[y].key));return g})(e)))).next((()=>t.localDocuments.getDocuments(i,l)))}))}function K_(n){const e=es(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.li.getLastRemoteSnapshotVersion(t)))}function cM(n,e){const t=es(n),i=e.snapshotVersion;let l=t.vs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(u=>{const d=t.xs.newChangeBuffer({trackRemovals:!0});l=t.vs;const p=[];e.targetChanges.forEach(((x,k)=>{const T=l.get(k);if(!T)return;p.push(t.li.removeMatchingKeys(u,x.removedDocuments,k).next((()=>t.li.addMatchingKeys(u,x.addedDocuments,k))));let O=T.withSequenceNumber(u.currentSequenceNumber);e.targetMismatches.get(k)!==null?O=O.withResumeToken(or.EMPTY_BYTE_STRING,Qt.min()).withLastLimboFreeSnapshotVersion(Qt.min()):x.resumeToken.approximateByteSize()>0&&(O=O.withResumeToken(x.resumeToken,i)),l=l.insert(k,O),(function(F,V,te){return F.resumeToken.approximateByteSize()===0||V.snapshotVersion.toMicroseconds()-F.snapshotVersion.toMicroseconds()>=aM?!0:te.addedDocuments.size+te.modifiedDocuments.size+te.removedDocuments.size>0})(T,O,x)&&p.push(t.li.updateTargetData(u,O))}));let g=wi(),y=ws();if(e.documentUpdates.forEach((x=>{e.resolvedLimboDocuments.has(x)&&p.push(t.persistence.referenceDelegate.updateLimboDocument(u,x))})),p.push(uM(u,d,e.documentUpdates).next((x=>{g=x.Bs,y=x.Ls}))),!i.isEqual(Qt.min())){const x=t.li.getLastRemoteSnapshotVersion(u).next((k=>t.li.setTargetsMetadata(u,u.currentSequenceNumber,i)));p.push(x)}return Pe.waitFor(p).next((()=>d.apply(u))).next((()=>t.localDocuments.getLocalViewOfDocuments(u,g,y))).next((()=>g))})).then((u=>(t.vs=l,u)))}function uM(n,e,t){let i=ws(),l=ws();return t.forEach((u=>i=i.add(u))),e.getEntries(n,i).next((u=>{let d=wi();return t.forEach(((p,g)=>{const y=u.get(p);g.isFoundDocument()!==y.isFoundDocument()&&(l=l.add(p)),g.isNoDocument()&&g.version.isEqual(Qt.min())?(e.removeEntry(p,g.readTime),d=d.insert(p,g)):!y.isValidDocument()||g.version.compareTo(y.version)>0||g.version.compareTo(y.version)===0&&y.hasPendingWrites?(e.addEntry(g),d=d.insert(p,g)):ht(by,"Ignoring outdated watch update for ",p,". Current version:",y.version," Watch version:",g.version)})),{Bs:d,Ls:l}}))}function dM(n,e){const t=es(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(i=>(e===void 0&&(e=iy),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e))))}function hM(n,e){const t=es(n);return t.persistence.runTransaction("Allocate target","readwrite",(i=>{let l;return t.li.getTargetData(i,e).next((u=>u?(l=u,Pe.resolve(l)):t.li.allocateTargetId(i).next((d=>(l=new to(e,d,"TargetPurposeListen",i.currentSequenceNumber),t.li.addTargetData(i,l).next((()=>l)))))))})).then((i=>{const l=t.vs.get(i.targetId);return(l===null||i.snapshotVersion.compareTo(l.snapshotVersion)>0)&&(t.vs=t.vs.insert(i.targetId,i),t.Fs.set(e,i.targetId)),i}))}async function Eg(n,e,t){const i=es(n),l=i.vs.get(e),u=t?"readwrite":"readwrite-primary";try{t||await i.persistence.runTransaction("Release target",u,(d=>i.persistence.referenceDelegate.removeTarget(d,l)))}catch(d){if(!cc(d))throw d;ht(by,`Failed to update sequence numbers for target ${e}: ${d}`)}i.vs=i.vs.remove(e),i.Fs.delete(l.target)}function Gx(n,e,t){const i=es(n);let l=Qt.min(),u=ws();return i.persistence.runTransaction("Execute query","readwrite",(d=>(function(g,y,x){const k=es(g),T=k.Fs.get(x);return T!==void 0?Pe.resolve(k.vs.get(T)):k.li.getTargetData(y,x)})(i,d,qa(e)).next((p=>{if(p)return l=p.lastLimboFreeSnapshotVersion,i.li.getMatchingKeysForTargetId(d,p.targetId).next((g=>{u=g}))})).next((()=>i.Cs.getDocumentsMatchingQuery(d,e,t?l:Qt.min(),t?u:ws()))).next((p=>(mM(i,ZR(e),p),{documents:p,ks:u})))))}function mM(n,e,t){let i=n.Ms.get(e)||Qt.min();t.forEach(((l,u)=>{u.readTime.compareTo(i)>0&&(i=u.readTime)})),n.Ms.set(e,i)}class Kx{constructor(){this.activeTargetIds=aA()}Qs(e){this.activeTargetIds=this.activeTargetIds.add(e)}Gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class fM{constructor(){this.vo=new Kx,this.Fo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e,t=!0){return t&&this.vo.Qs(e),this.Fo[e]||"not-current"}updateQueryState(e,t,i){this.Fo[e]=t}removeLocalQueryTarget(e){this.vo.Gs(e)}isLocalQueryTarget(e){return this.vo.activeTargetIds.has(e)}clearQueryState(e){delete this.Fo[e]}getAllActiveQueryTargets(){return this.vo.activeTargetIds}isActiveQueryTarget(e){return this.vo.activeTargetIds.has(e)}start(){return this.vo=new Kx,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class pM{Mo(e){}shutdown(){}}const Yx="ConnectivityMonitor";class Qx{constructor(){this.xo=()=>this.Oo(),this.No=()=>this.Bo(),this.Lo=[],this.ko()}Mo(e){this.Lo.push(e)}shutdown(){window.removeEventListener("online",this.xo),window.removeEventListener("offline",this.No)}ko(){window.addEventListener("online",this.xo),window.addEventListener("offline",this.No)}Oo(){ht(Yx,"Network connectivity changed: AVAILABLE");for(const e of this.Lo)e(0)}Bo(){ht(Yx,"Network connectivity changed: UNAVAILABLE");for(const e of this.Lo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let ih=null;function Sg(){return ih===null?ih=(function(){return 268435456+Math.round(2147483648*Math.random())})():ih++,"0x"+ih.toString(16)}const Pp="RestConnection",gM={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery",ExecutePipeline:"executePipeline"};class yM{get Ko(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),l=encodeURIComponent(this.databaseId.database);this.qo=t+"://"+e.host,this.Uo=`projects/${i}/databases/${l}`,this.$o=this.databaseId.database===Bh?`project_id=${i}`:`project_id=${i}&database_id=${l}`}Wo(e,t,i,l,u){const d=Sg(),p=this.Qo(e,t.toUriEncodedString());ht(Pp,`Sending RPC '${e}' ${d}:`,p,i);const g={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.$o};this.Go(g,l,u);const{host:y}=new URL(p),x=go(y);return this.zo(e,p,g,i,x).then((k=>(ht(Pp,`Received RPC '${e}' ${d}: `,k),k)),(k=>{throw Xl(Pp,`RPC '${e}' ${d} failed with error: `,k,"url: ",p,"request:",i),k}))}jo(e,t,i,l,u,d){return this.Wo(e,t,i,l,u)}Go(e,t,i){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+oc})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((l,u)=>e[u]=l)),i&&i.headers.forEach(((l,u)=>e[u]=l))}Qo(e,t){const i=gM[e];let l=`${this.qo}/v1/${t}:${i}`;return this.databaseInfo.apiKey&&(l=`${l}?key=${encodeURIComponent(this.databaseInfo.apiKey)}`),l}terminate(){}}class bM{constructor(e){this.Ho=e.Ho,this.Jo=e.Jo}Zo(e){this.Xo=e}Yo(e){this.e_=e}t_(e){this.n_=e}onMessage(e){this.r_=e}close(){this.Jo()}send(e){this.Ho(e)}i_(){this.Xo()}s_(){this.e_()}o_(e){this.n_(e)}__(e){this.r_(e)}}const fr="WebChannelConnection",Xc=(n,e,t)=>{n.listen(e,(i=>{try{t(i)}catch(l){setTimeout((()=>{throw l}),0)}}))};class Yl extends yM{constructor(e){super(e),this.a_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}static u_(){if(!Yl.c_){const e=Xw();Xc(e,Qw.STAT_EVENT,(t=>{t.stat===pg.PROXY?ht(fr,"STAT_EVENT: detected buffering proxy"):t.stat===pg.NOPROXY&&ht(fr,"STAT_EVENT: detected no buffering proxy")})),Yl.c_=!0}}zo(e,t,i,l,u){const d=Sg();return new Promise(((p,g)=>{const y=new Kw;y.setWithCredentials(!0),y.listenOnce(Yw.COMPLETE,(()=>{try{switch(y.getLastErrorCode()){case wh.NO_ERROR:const k=y.getResponseJson();ht(fr,`XHR for RPC '${e}' ${d} received:`,JSON.stringify(k)),p(k);break;case wh.TIMEOUT:ht(fr,`RPC '${e}' ${d} timed out`),g(new at(Ce.DEADLINE_EXCEEDED,"Request time out"));break;case wh.HTTP_ERROR:const T=y.getStatus();if(ht(fr,`RPC '${e}' ${d} failed with status:`,T,"response text:",y.getResponseText()),T>0){let O=y.getResponseJson();Array.isArray(O)&&(O=O[0]);const G=O?.error;if(G&&G.status&&G.message){const F=(function(te){const Y=te.toLowerCase().replace(/_/g,"-");return Object.values(Ce).indexOf(Y)>=0?Y:Ce.UNKNOWN})(G.status);g(new at(F,G.message))}else g(new at(Ce.UNKNOWN,"Server responded with status "+y.getStatus()))}else g(new at(Ce.UNAVAILABLE,"Connection failed."));break;default:qt(9055,{l_:e,streamId:d,h_:y.getLastErrorCode(),P_:y.getLastError()})}}finally{ht(fr,`RPC '${e}' ${d} completed.`)}}));const x=JSON.stringify(l);ht(fr,`RPC '${e}' ${d} sending request:`,l),y.send(t,"POST",x,i,15)}))}T_(e,t,i){const l=Sg(),u=[this.qo,"/","google.firestore.v1.Firestore","/",e,"/channel"],d=this.createWebChannelTransport(),p={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},g=this.longPollingOptions.timeoutSeconds;g!==void 0&&(p.longPollingTimeout=Math.round(1e3*g)),this.useFetchStreams&&(p.useFetchStreams=!0),this.Go(p.initMessageHeaders,t,i),p.encodeInitMessageHeaders=!0;const y=u.join("");ht(fr,`Creating RPC '${e}' stream ${l}: ${y}`,p);const x=d.createWebChannel(y,p);this.I_(x);let k=!1,T=!1;const O=new bM({Ho:G=>{T?ht(fr,`Not sending because RPC '${e}' stream ${l} is closed:`,G):(k||(ht(fr,`Opening RPC '${e}' stream ${l} transport.`),x.open(),k=!0),ht(fr,`RPC '${e}' stream ${l} sending:`,G),x.send(G))},Jo:()=>x.close()});return Xc(x,au.EventType.OPEN,(()=>{T||(ht(fr,`RPC '${e}' stream ${l} transport opened.`),O.i_())})),Xc(x,au.EventType.CLOSE,(()=>{T||(T=!0,ht(fr,`RPC '${e}' stream ${l} transport closed`),O.o_(),this.E_(x))})),Xc(x,au.EventType.ERROR,(G=>{T||(T=!0,Xl(fr,`RPC '${e}' stream ${l} transport errored. Name:`,G.name,"Message:",G.message),O.o_(new at(Ce.UNAVAILABLE,"The operation could not be completed")))})),Xc(x,au.EventType.MESSAGE,(G=>{if(!T){const F=G.data[0];Fs(!!F,16349);const V=F,te=V?.error||V[0]?.error;if(te){ht(fr,`RPC '${e}' stream ${l} received error:`,te);const Y=te.status;let ie=(function(fe){const R=Vn[fe];if(R!==void 0)return D_(R)})(Y),he=te.message;ie===void 0&&(ie=Ce.INTERNAL,he="Unknown error status: "+Y+" with message "+te.message),T=!0,O.o_(new at(ie,he)),x.close()}else ht(fr,`RPC '${e}' stream ${l} received:`,F),O.__(F)}})),Yl.u_(),setTimeout((()=>{O.s_()}),0),O}terminate(){this.a_.forEach((e=>e.close())),this.a_=[]}I_(e){this.a_.push(e)}E_(e){this.a_=this.a_.filter((t=>t===e))}Go(e,t,i){super.Go(e,t,i),this.databaseInfo.apiKey&&(e["x-goog-api-key"]=this.databaseInfo.apiKey)}createWebChannelTransport(){return Jw()}}function vM(n){return new Yl(n)}function Lp(){return typeof document<"u"?document:null}function pm(n){return new kA(n,!0)}Yl.c_=!1;class Y_{constructor(e,t,i=1e3,l=1.5,u=6e4){this.Ci=e,this.timerId=t,this.R_=i,this.A_=l,this.V_=u,this.d_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.d_=0}g_(){this.d_=this.V_}p_(e){this.cancel();const t=Math.floor(this.d_+this.y_()),i=Math.max(0,Date.now()-this.f_),l=Math.max(0,t-i);l>0&&ht("ExponentialBackoff",`Backing off for ${l} ms (base delay: ${this.d_} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.m_=this.Ci.enqueueAfterDelay(this.timerId,l,(()=>(this.f_=Date.now(),e()))),this.d_*=this.A_,this.d_<this.R_&&(this.d_=this.R_),this.d_>this.V_&&(this.d_=this.V_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.d_}}const Xx="PersistentStream";class Q_{constructor(e,t,i,l,u,d,p,g){this.Ci=e,this.b_=i,this.S_=l,this.connection=u,this.authCredentialsProvider=d,this.appCheckCredentialsProvider=p,this.listener=g,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new Y_(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Ci.enqueueAfterDelay(this.b_,6e4,(()=>this.k_())))}K_(e){this.q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===Ce.RESOURCE_EXHAUSTED?(xi(t.toString()),xi("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===Ce.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.t_(t)}W_(){}auth(){this.state=1;const e=this.Q_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([i,l])=>{this.D_===t&&this.G_(i,l)}),(i=>{e((()=>{const l=new at(Ce.UNKNOWN,"Fetching auth token failed: "+i.message);return this.z_(l)}))}))}G_(e,t){const i=this.Q_(this.D_);this.stream=this.j_(e,t),this.stream.Zo((()=>{i((()=>this.listener.Zo()))})),this.stream.Yo((()=>{i((()=>(this.state=2,this.v_=this.Ci.enqueueAfterDelay(this.S_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.Yo())))})),this.stream.t_((l=>{i((()=>this.z_(l)))})),this.stream.onMessage((l=>{i((()=>++this.F_==1?this.H_(l):this.onNext(l)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return ht(Xx,`close with error: ${e}`),this.stream=null,this.close(4,e)}Q_(e){return t=>{this.Ci.enqueueAndForget((()=>this.D_===e?t():(ht(Xx,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class xM extends Q_{constructor(e,t,i,l,u,d){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,i,l,d),this.serializer=u}j_(e,t){return this.connection.T_("Listen",e,t)}H_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=EA(this.serializer,e),i=(function(u){if(!("targetChange"in u))return Qt.min();const d=u.targetChange;return d.targetIds&&d.targetIds.length?Qt.min():d.readTime?Ha(d.readTime):Qt.min()})(e);return this.listener.J_(t,i)}Z_(e){const t={};t.database=Tg(this.serializer),t.addTarget=(function(u,d){let p;const g=d.target;if(p=xg(g)?{documents:CA(u,g)}:{query:RA(u,g).ft},p.targetId=d.targetId,d.resumeToken.approximateByteSize()>0){p.resumeToken=O_(u,d.resumeToken);const y=_g(u,d.expectedCount);y!==null&&(p.expectedCount=y)}else if(d.snapshotVersion.compareTo(Qt.min())>0){p.readTime=zh(u,d.snapshotVersion.toTimestamp());const y=_g(u,d.expectedCount);y!==null&&(p.expectedCount=y)}return p})(this.serializer,e);const i=MA(this.serializer,e);i&&(t.labels=i),this.K_(t)}X_(e){const t={};t.database=Tg(this.serializer),t.removeTarget=e,this.K_(t)}}class wM extends Q_{constructor(e,t,i,l,u,d){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,l,d),this.serializer=u}get Y_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.Y_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}H_(e){return Fs(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Fs(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Fs(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=NA(e.writeResults,e.commitTime),i=Ha(e.commitTime);return this.listener.na(i,t)}ra(){const e={};e.database=Tg(this.serializer),this.K_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((i=>SA(this.serializer,i)))};this.K_(t)}}class _M{}class kM extends _M{constructor(e,t,i,l){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=l,this.ia=!1}sa(){if(this.ia)throw new at(Ce.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,i,l){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([u,d])=>this.connection.Wo(e,kg(t,i),l,u,d))).catch((u=>{throw u.name==="FirebaseError"?(u.code===Ce.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),u):new at(Ce.UNKNOWN,u.toString())}))}jo(e,t,i,l,u){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([d,p])=>this.connection.jo(e,kg(t,i),l,d,p,u))).catch((d=>{throw d.name==="FirebaseError"?(d.code===Ce.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),d):new at(Ce.UNKNOWN,d.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}function jM(n,e,t,i){return new kM(n,e,t,i)}class TM{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(xi(t),this.aa=!1):ht("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const Jo="RemoteStore";class EM{constructor(e,t,i,l,u){this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.Ra=[],this.Aa=u,this.Aa.Mo((d=>{i.enqueueAndForget((async()=>{nl(this)&&(ht(Jo,"Restarting streams for network reachability change."),await(async function(g){const y=es(g);y.Ea.add(4),await Uu(y),y.Va.set("Unknown"),y.Ea.delete(4),await gm(y)})(this))}))})),this.Va=new TM(i,l)}}async function gm(n){if(nl(n))for(const e of n.Ra)await e(!0)}async function Uu(n){for(const e of n.Ra)await e(!1)}function X_(n,e){const t=es(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),_y(t)?wy(t):dc(t).O_()&&xy(t,e))}function vy(n,e){const t=es(n),i=dc(t);t.Ia.delete(e),i.O_()&&J_(t,e),t.Ia.size===0&&(i.O_()?i.L_():nl(t)&&t.Va.set("Unknown"))}function xy(n,e){if(n.da.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Qt.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}dc(n).Z_(e)}function J_(n,e){n.da.$e(e),dc(n).X_(e)}function wy(n){n.da=new vA({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),dc(n).start(),n.Va.ua()}function _y(n){return nl(n)&&!dc(n).x_()&&n.Ia.size>0}function nl(n){return es(n).Ea.size===0}function Z_(n){n.da=void 0}async function SM(n){n.Va.set("Online")}async function NM(n){n.Ia.forEach(((e,t)=>{xy(n,e)}))}async function CM(n,e){Z_(n),_y(n)?(n.Va.ha(e),wy(n)):n.Va.set("Unknown")}async function RM(n,e,t){if(n.Va.set("Online"),e instanceof L_&&e.state===2&&e.cause)try{await(async function(l,u){const d=u.cause;for(const p of u.targetIds)l.Ia.has(p)&&(await l.remoteSyncer.rejectListen(p,d),l.Ia.delete(p),l.da.removeTarget(p))})(n,e)}catch(i){ht(Jo,"Failed to remove targets %s: %s ",e.targetIds.join(","),i),await Hh(n,i)}else if(e instanceof Th?n.da.Xe(e):e instanceof P_?n.da.st(e):n.da.tt(e),!t.isEqual(Qt.min()))try{const i=await K_(n.localStore);t.compareTo(i)>=0&&await(function(u,d){const p=u.da.Tt(d);return p.targetChanges.forEach(((g,y)=>{if(g.resumeToken.approximateByteSize()>0){const x=u.Ia.get(y);x&&u.Ia.set(y,x.withResumeToken(g.resumeToken,d))}})),p.targetMismatches.forEach(((g,y)=>{const x=u.Ia.get(g);if(!x)return;u.Ia.set(g,x.withResumeToken(or.EMPTY_BYTE_STRING,x.snapshotVersion)),J_(u,g);const k=new to(x.target,g,y,x.sequenceNumber);xy(u,k)})),u.remoteSyncer.applyRemoteEvent(p)})(n,t)}catch(i){ht(Jo,"Failed to raise snapshot:",i),await Hh(n,i)}}async function Hh(n,e,t){if(!cc(e))throw e;n.Ea.add(1),await Uu(n),n.Va.set("Offline"),t||(t=()=>K_(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{ht(Jo,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await gm(n)}))}function ek(n,e){return e().catch((t=>Hh(n,t,e)))}async function ym(n){const e=es(n),t=fo(e);let i=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:iy;for(;AM(e);)try{const l=await dM(e.localStore,i);if(l===null){e.Ta.length===0&&t.L_();break}i=l.batchId,MM(e,l)}catch(l){await Hh(e,l)}tk(e)&&sk(e)}function AM(n){return nl(n)&&n.Ta.length<10}function MM(n,e){n.Ta.push(e);const t=fo(n);t.O_()&&t.Y_&&t.ea(e.mutations)}function tk(n){return nl(n)&&!fo(n).x_()&&n.Ta.length>0}function sk(n){fo(n).start()}async function IM(n){fo(n).ra()}async function DM(n){const e=fo(n);for(const t of n.Ta)e.ea(t.mutations)}async function PM(n,e,t){const i=n.Ta.shift(),l=hy.from(i,e,t);await ek(n,(()=>n.remoteSyncer.applySuccessfulWrite(l))),await ym(n)}async function LM(n,e){e&&fo(n).Y_&&await(async function(i,l){if((function(d){return gA(d)&&d!==Ce.ABORTED})(l.code)){const u=i.Ta.shift();fo(i).B_(),await ek(i,(()=>i.remoteSyncer.rejectFailedWrite(u.batchId,l))),await ym(i)}})(n,e),tk(n)&&sk(n)}async function Jx(n,e){const t=es(n);t.asyncQueue.verifyOperationInProgress(),ht(Jo,"RemoteStore received new credentials");const i=nl(t);t.Ea.add(3),await Uu(t),i&&t.Va.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await gm(t)}async function OM(n,e){const t=es(n);e?(t.Ea.delete(2),await gm(t)):e||(t.Ea.add(2),await Uu(t),t.Va.set("Unknown"))}function dc(n){return n.ma||(n.ma=(function(t,i,l){const u=es(t);return u.sa(),new xM(i,u.connection,u.authCredentials,u.appCheckCredentials,u.serializer,l)})(n.datastore,n.asyncQueue,{Zo:SM.bind(null,n),Yo:NM.bind(null,n),t_:CM.bind(null,n),J_:RM.bind(null,n)}),n.Ra.push((async e=>{e?(n.ma.B_(),_y(n)?wy(n):n.Va.set("Unknown")):(await n.ma.stop(),Z_(n))}))),n.ma}function fo(n){return n.fa||(n.fa=(function(t,i,l){const u=es(t);return u.sa(),new wM(i,u.connection,u.authCredentials,u.appCheckCredentials,u.serializer,l)})(n.datastore,n.asyncQueue,{Zo:()=>Promise.resolve(),Yo:IM.bind(null,n),t_:LM.bind(null,n),ta:DM.bind(null,n),na:PM.bind(null,n)}),n.Ra.push((async e=>{e?(n.fa.B_(),await ym(n)):(await n.fa.stop(),n.Ta.length>0&&(ht(Jo,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}class ky{constructor(e,t,i,l,u){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=l,this.removalCallback=u,this.deferred=new gi,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((d=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,l,u){const d=Date.now()+i,p=new ky(e,t,d,l,u);return p.start(i),p}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new at(Ce.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function jy(n,e){if(xi("AsyncQueue",`${e}: ${n}`),cc(n))return new at(Ce.UNAVAILABLE,`${e}: ${n}`);throw n}class Ql{static emptySet(e){return new Ql(e.comparator)}constructor(e){this.comparator=e?(t,i)=>e(t,i)||At.comparator(t.key,i.key):(t,i)=>At.comparator(t.key,i.key),this.keyedMap=iu(),this.sortedSet=new gn(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,i)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Ql)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;t.hasNext();){const l=t.getNext().key,u=i.getNext().key;if(!l.isEqual(u))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const i=new Ql;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=t,i}}class Zx{constructor(){this.ga=new gn(At.comparator)}track(e){const t=e.doc.key,i=this.ga.get(t);i?e.type!==0&&i.type===3?this.ga=this.ga.insert(t,e):e.type===3&&i.type!==1?this.ga=this.ga.insert(t,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.ga=this.ga.remove(t):e.type===1&&i.type===2?this.ga=this.ga.insert(t,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):qt(63341,{Vt:e,pa:i}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,i)=>{e.push(i)})),e}}class sc{constructor(e,t,i,l,u,d,p,g,y){this.query=e,this.docs=t,this.oldDocs=i,this.docChanges=l,this.mutatedKeys=u,this.fromCache=d,this.syncStateChanged=p,this.excludesMetadataChanges=g,this.hasCachedResults=y}static fromInitialDocuments(e,t,i,l,u){const d=[];return t.forEach((p=>{d.push({type:0,doc:p})})),new sc(e,t,Ql.emptySet(t),d,i,l,!0,!1,u)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&cm(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,i=e.docChanges;if(t.length!==i.length)return!1;for(let l=0;l<t.length;l++)if(t[l].type!==i[l].type||!t[l].doc.isEqual(i[l].doc))return!1;return!0}}class BM{constructor(){this.wa=void 0,this.ba=[]}Sa(){return this.ba.some((e=>e.Da()))}}class VM{constructor(){this.queries=e2(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,i){const l=es(t),u=l.queries;l.queries=e2(),u.forEach(((d,p)=>{for(const g of p.ba)g.onError(i)}))})(this,new at(Ce.ABORTED,"Firestore shutting down"))}}function e2(){return new sl((n=>x_(n)),cm)}async function Ty(n,e){const t=es(n);let i=3;const l=e.query;let u=t.queries.get(l);u?!u.Sa()&&e.Da()&&(i=2):(u=new BM,i=e.Da()?0:1);try{switch(i){case 0:u.wa=await t.onListen(l,!0);break;case 1:u.wa=await t.onListen(l,!1);break;case 2:await t.onFirstRemoteStoreListen(l)}}catch(d){const p=jy(d,`Initialization of query '${zl(e.query)}' failed`);return void e.onError(p)}t.queries.set(l,u),u.ba.push(e),e.va(t.onlineState),u.wa&&e.Fa(u.wa)&&Sy(t)}async function Ey(n,e){const t=es(n),i=e.query;let l=3;const u=t.queries.get(i);if(u){const d=u.ba.indexOf(e);d>=0&&(u.ba.splice(d,1),u.ba.length===0?l=e.Da()?0:1:!u.Sa()&&e.Da()&&(l=2))}switch(l){case 0:return t.queries.delete(i),t.onUnlisten(i,!0);case 1:return t.queries.delete(i),t.onUnlisten(i,!1);case 2:return t.onLastRemoteStoreUnlisten(i);default:return}}function UM(n,e){const t=es(n);let i=!1;for(const l of e){const u=l.query,d=t.queries.get(u);if(d){for(const p of d.ba)p.Fa(l)&&(i=!0);d.wa=l}}i&&Sy(t)}function FM(n,e,t){const i=es(n),l=i.queries.get(e);if(l)for(const u of l.ba)u.onError(t);i.queries.delete(e)}function Sy(n){n.Ca.forEach((e=>{e.next()}))}var Ng,t2;(t2=Ng||(Ng={})).Ma="default",t2.Cache="cache";class Ny{constructor(e,t,i){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=i||{}}Fa(e){if(!this.options.includeMetadataChanges){const i=[];for(const l of e.docChanges)l.type!==3&&i.push(l);e=new sc(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const i=t!=="Offline";return(!this.options.Ka||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=sc.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Ng.Cache}}class nk{constructor(e){this.key=e}}class rk{constructor(e){this.key=e}}class zM{constructor(e,t){this.query=e,this.Za=t,this.Xa=null,this.hasCachedResults=!1,this.current=!1,this.Ya=ws(),this.mutatedKeys=ws(),this.eu=w_(e),this.tu=new Ql(this.eu)}get nu(){return this.Za}ru(e,t){const i=t?t.iu:new Zx,l=t?t.tu:this.tu;let u=t?t.mutatedKeys:this.mutatedKeys,d=l,p=!1;const g=this.query.limitType==="F"&&l.size===this.query.limit?l.last():null,y=this.query.limitType==="L"&&l.size===this.query.limit?l.first():null;if(e.inorderTraversal(((x,k)=>{const T=l.get(x),O=um(this.query,k)?k:null,G=!!T&&this.mutatedKeys.has(T.key),F=!!O&&(O.hasLocalMutations||this.mutatedKeys.has(O.key)&&O.hasCommittedMutations);let V=!1;T&&O?T.data.isEqual(O.data)?G!==F&&(i.track({type:3,doc:O}),V=!0):this.su(T,O)||(i.track({type:2,doc:O}),V=!0,(g&&this.eu(O,g)>0||y&&this.eu(O,y)<0)&&(p=!0)):!T&&O?(i.track({type:0,doc:O}),V=!0):T&&!O&&(i.track({type:1,doc:T}),V=!0,(g||y)&&(p=!0)),V&&(O?(d=d.add(O),u=F?u.add(x):u.delete(x)):(d=d.delete(x),u=u.delete(x)))})),this.query.limit!==null)for(;d.size>this.query.limit;){const x=this.query.limitType==="F"?d.last():d.first();d=d.delete(x.key),u=u.delete(x.key),i.track({type:1,doc:x})}return{tu:d,iu:i,Ss:p,mutatedKeys:u}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,i,l){const u=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const d=e.iu.ya();d.sort(((x,k)=>(function(O,G){const F=V=>{switch(V){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return qt(20277,{Vt:V})}};return F(O)-F(G)})(x.type,k.type)||this.eu(x.doc,k.doc))),this.ou(i),l=l??!1;const p=t&&!l?this._u():[],g=this.Ya.size===0&&this.current&&!l?1:0,y=g!==this.Xa;return this.Xa=g,d.length!==0||y?{snapshot:new sc(this.query,e.tu,u,d,e.mutatedKeys,g===0,y,!1,!!i&&i.resumeToken.approximateByteSize()>0),au:p}:{au:p}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Zx,mutatedKeys:this.mutatedKeys,Ss:!1},!1)):{au:[]}}uu(e){return!this.Za.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Za=this.Za.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Za=this.Za.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Ya;this.Ya=ws(),this.tu.forEach((i=>{this.uu(i.key)&&(this.Ya=this.Ya.add(i.key))}));const t=[];return e.forEach((i=>{this.Ya.has(i)||t.push(new rk(i))})),this.Ya.forEach((i=>{e.has(i)||t.push(new nk(i))})),t}cu(e){this.Za=e.ks,this.Ya=ws();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return sc.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Xa===0,this.hasCachedResults)}}const Cy="SyncEngine";class qM{constructor(e,t,i){this.query=e,this.targetId=t,this.view=i}}class HM{constructor(e){this.key=e,this.hu=!1}}class $M{constructor(e,t,i,l,u,d){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=l,this.currentUser=u,this.maxConcurrentLimboResolutions=d,this.Pu={},this.Tu=new sl((p=>x_(p)),cm),this.Iu=new Map,this.Eu=new Set,this.Ru=new gn(At.comparator),this.Au=new Map,this.Vu=new py,this.du={},this.mu=new Map,this.fu=tc.ar(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function WM(n,e,t=!0){const i=uk(n);let l;const u=i.Tu.get(e);return u?(i.sharedClientState.addLocalQueryTarget(u.targetId),l=u.view.lu()):l=await ak(i,e,t,!0),l}async function GM(n,e){const t=uk(n);await ak(t,e,!0,!1)}async function ak(n,e,t,i){const l=await hM(n.localStore,qa(e)),u=l.targetId,d=n.sharedClientState.addLocalQueryTarget(u,t);let p;return i&&(p=await KM(n,e,u,d==="current",l.resumeToken)),n.isPrimaryClient&&t&&X_(n.remoteStore,l),p}async function KM(n,e,t,i,l){n.pu=(k,T,O)=>(async function(F,V,te,Y){let ie=V.view.ru(te);ie.Ss&&(ie=await Gx(F.localStore,V.query,!1).then((({documents:R})=>V.view.ru(R,ie))));const he=Y&&Y.targetChanges.get(V.targetId),Ne=Y&&Y.targetMismatches.get(V.targetId)!=null,fe=V.view.applyChanges(ie,F.isPrimaryClient,he,Ne);return n2(F,V.targetId,fe.au),fe.snapshot})(n,k,T,O);const u=await Gx(n.localStore,e,!0),d=new zM(e,u.ks),p=d.ru(u.documents),g=Vu.createSynthesizedTargetChangeForCurrentChange(t,i&&n.onlineState!=="Offline",l),y=d.applyChanges(p,n.isPrimaryClient,g);n2(n,t,y.au);const x=new qM(e,t,d);return n.Tu.set(e,x),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),y.snapshot}async function YM(n,e,t){const i=es(n),l=i.Tu.get(e),u=i.Iu.get(l.targetId);if(u.length>1)return i.Iu.set(l.targetId,u.filter((d=>!cm(d,e)))),void i.Tu.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(l.targetId),i.sharedClientState.isActiveQueryTarget(l.targetId)||await Eg(i.localStore,l.targetId,!1).then((()=>{i.sharedClientState.clearQueryState(l.targetId),t&&vy(i.remoteStore,l.targetId),Cg(i,l.targetId)})).catch(lc)):(Cg(i,l.targetId),await Eg(i.localStore,l.targetId,!0))}async function QM(n,e){const t=es(n),i=t.Tu.get(e),l=t.Iu.get(i.targetId);t.isPrimaryClient&&l.length===1&&(t.sharedClientState.removeLocalQueryTarget(i.targetId),vy(t.remoteStore,i.targetId))}async function XM(n,e,t){const i=rI(n);try{const l=await(function(d,p){const g=es(d),y=kt.now(),x=p.reduce(((O,G)=>O.add(G.key)),ws());let k,T;return g.persistence.runTransaction("Locally write mutations","readwrite",(O=>{let G=wi(),F=ws();return g.xs.getEntries(O,x).next((V=>{G=V,G.forEach(((te,Y)=>{Y.isValidDocument()||(F=F.add(te))}))})).next((()=>g.localDocuments.getOverlayedDocuments(O,G))).next((V=>{k=V;const te=[];for(const Y of p){const ie=dA(Y,k.get(Y.key).overlayedDocument);ie!=null&&te.push(new vo(Y.key,ie,h_(ie.value.mapValue),Sr.exists(!0)))}return g.mutationQueue.addMutationBatch(O,y,te,p)})).next((V=>{T=V;const te=V.applyToLocalDocumentSet(k,F);return g.documentOverlayCache.saveOverlays(O,V.batchId,te)}))})).then((()=>({batchId:T.batchId,changes:k_(k)})))})(i.localStore,e);i.sharedClientState.addPendingMutation(l.batchId),(function(d,p,g){let y=d.du[d.currentUser.toKey()];y||(y=new gn(xs)),y=y.insert(p,g),d.du[d.currentUser.toKey()]=y})(i,l.batchId,t),await Fu(i,l.changes),await ym(i.remoteStore)}catch(l){const u=jy(l,"Failed to persist write");t.reject(u)}}async function ik(n,e){const t=es(n);try{const i=await cM(t.localStore,e);e.targetChanges.forEach(((l,u)=>{const d=t.Au.get(u);d&&(Fs(l.addedDocuments.size+l.modifiedDocuments.size+l.removedDocuments.size<=1,22616),l.addedDocuments.size>0?d.hu=!0:l.modifiedDocuments.size>0?Fs(d.hu,14607):l.removedDocuments.size>0&&(Fs(d.hu,42227),d.hu=!1))})),await Fu(t,i,e)}catch(i){await lc(i)}}function s2(n,e,t){const i=es(n);if(i.isPrimaryClient&&t===0||!i.isPrimaryClient&&t===1){const l=[];i.Tu.forEach(((u,d)=>{const p=d.view.va(e);p.snapshot&&l.push(p.snapshot)})),(function(d,p){const g=es(d);g.onlineState=p;let y=!1;g.queries.forEach(((x,k)=>{for(const T of k.ba)T.va(p)&&(y=!0)})),y&&Sy(g)})(i.eventManager,e),l.length&&i.Pu.J_(l),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function JM(n,e,t){const i=es(n);i.sharedClientState.updateQueryState(e,"rejected",t);const l=i.Au.get(e),u=l&&l.key;if(u){let d=new gn(At.comparator);d=d.insert(u,gr.newNoDocument(u,Qt.min()));const p=ws().add(u),g=new fm(Qt.min(),new Map,new gn(xs),d,p);await ik(i,g),i.Ru=i.Ru.remove(u),i.Au.delete(e),Ry(i)}else await Eg(i.localStore,e,!1).then((()=>Cg(i,e,t))).catch(lc)}async function ZM(n,e){const t=es(n),i=e.batch.batchId;try{const l=await lM(t.localStore,e);lk(t,i,null),ok(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),await Fu(t,l)}catch(l){await lc(l)}}async function eI(n,e,t){const i=es(n);try{const l=await(function(d,p){const g=es(d);return g.persistence.runTransaction("Reject batch","readwrite-primary",(y=>{let x;return g.mutationQueue.lookupMutationBatch(y,p).next((k=>(Fs(k!==null,37113),x=k.keys(),g.mutationQueue.removeMutationBatch(y,k)))).next((()=>g.mutationQueue.performConsistencyCheck(y))).next((()=>g.documentOverlayCache.removeOverlaysForBatchId(y,x,p))).next((()=>g.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(y,x))).next((()=>g.localDocuments.getDocuments(y,x)))}))})(i.localStore,e);lk(i,e,t),ok(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),await Fu(i,l)}catch(l){await lc(l)}}function ok(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function lk(n,e,t){const i=es(n);let l=i.du[i.currentUser.toKey()];if(l){const u=l.get(e);u&&(t?u.reject(t):u.resolve(),l=l.remove(e)),i.du[i.currentUser.toKey()]=l}}function Cg(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const i of n.Iu.get(e))n.Tu.delete(i),t&&n.Pu.yu(i,t);n.Iu.delete(e),n.isPrimaryClient&&n.Vu.Gr(e).forEach((i=>{n.Vu.containsKey(i)||ck(n,i)}))}function ck(n,e){n.Eu.delete(e.path.canonicalString());const t=n.Ru.get(e);t!==null&&(vy(n.remoteStore,t),n.Ru=n.Ru.remove(e),n.Au.delete(t),Ry(n))}function n2(n,e,t){for(const i of t)i instanceof nk?(n.Vu.addReference(i.key,e),tI(n,i)):i instanceof rk?(ht(Cy,"Document no longer in limbo: "+i.key),n.Vu.removeReference(i.key,e),n.Vu.containsKey(i.key)||ck(n,i.key)):qt(19791,{wu:i})}function tI(n,e){const t=e.key,i=t.path.canonicalString();n.Ru.get(t)||n.Eu.has(i)||(ht(Cy,"New document in limbo: "+t),n.Eu.add(i),Ry(n))}function Ry(n){for(;n.Eu.size>0&&n.Ru.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new At(an.fromString(e)),i=n.fu.next();n.Au.set(i,new HM(t)),n.Ru=n.Ru.insert(t,i),X_(n.remoteStore,new to(qa(lm(t.path)),i,"TargetPurposeLimboResolution",am.ce))}}async function Fu(n,e,t){const i=es(n),l=[],u=[],d=[];i.Tu.isEmpty()||(i.Tu.forEach(((p,g)=>{d.push(i.pu(g,e,t).then((y=>{if((y||t)&&i.isPrimaryClient){const x=y?!y.fromCache:t?.targetChanges.get(g.targetId)?.current;i.sharedClientState.updateQueryState(g.targetId,x?"current":"not-current")}if(y){l.push(y);const x=yy.Es(g.targetId,y);u.push(x)}})))})),await Promise.all(d),i.Pu.J_(l),await(async function(g,y){const x=es(g);try{await x.persistence.runTransaction("notifyLocalViewChanges","readwrite",(k=>Pe.forEach(y,(T=>Pe.forEach(T.Ts,(O=>x.persistence.referenceDelegate.addReference(k,T.targetId,O))).next((()=>Pe.forEach(T.Is,(O=>x.persistence.referenceDelegate.removeReference(k,T.targetId,O)))))))))}catch(k){if(!cc(k))throw k;ht(by,"Failed to update sequence numbers: "+k)}for(const k of y){const T=k.targetId;if(!k.fromCache){const O=x.vs.get(T),G=O.snapshotVersion,F=O.withLastLimboFreeSnapshotVersion(G);x.vs=x.vs.insert(T,F)}}})(i.localStore,u))}async function sI(n,e){const t=es(n);if(!t.currentUser.isEqual(e)){ht(Cy,"User change. New user:",e.toKey());const i=await G_(t.localStore,e);t.currentUser=e,(function(u,d){u.mu.forEach((p=>{p.forEach((g=>{g.reject(new at(Ce.CANCELLED,d))}))})),u.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await Fu(t,i.Ns)}}function nI(n,e){const t=es(n),i=t.Au.get(e);if(i&&i.hu)return ws().add(i.key);{let l=ws();const u=t.Iu.get(e);if(!u)return l;for(const d of u){const p=t.Tu.get(d);l=l.unionWith(p.view.nu)}return l}}function uk(n){const e=es(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=ik.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=nI.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=JM.bind(null,e),e.Pu.J_=UM.bind(null,e.eventManager),e.Pu.yu=FM.bind(null,e.eventManager),e}function rI(n){const e=es(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=ZM.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=eI.bind(null,e),e}class $h{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=pm(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return oM(this.persistence,new rM,e.initialUser,this.serializer)}Cu(e){return new W_(gy.Vi,this.serializer)}Du(e){return new fM}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}$h.provider={build:()=>new $h};class aI extends $h{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){Fs(this.persistence.referenceDelegate instanceof qh,46915);const i=this.persistence.referenceDelegate.garbageCollector;return new qA(i,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?Or.withCacheSize(this.cacheSizeBytes):Or.DEFAULT;return new W_((i=>qh.Vi(i,t)),this.serializer)}}class Rg{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>s2(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=sI.bind(null,this.syncEngine),await OM(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new VM})()}createDatastore(e){const t=pm(e.databaseInfo.databaseId),i=vM(e.databaseInfo);return jM(e.authCredentials,e.appCheckCredentials,i,t)}createRemoteStore(e){return(function(i,l,u,d,p){return new EM(i,l,u,d,p)})(this.localStore,this.datastore,e.asyncQueue,(t=>s2(this.syncEngine,t,0)),(function(){return Qx.v()?new Qx:new pM})())}createSyncEngine(e,t){return(function(l,u,d,p,g,y,x){const k=new $M(l,u,d,p,g,y);return x&&(k.gu=!0),k})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const i=es(t);ht(Jo,"RemoteStore shutting down."),i.Ea.add(5),await Uu(i),i.Aa.shutdown(),i.Va.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}Rg.provider={build:()=>new Rg};class Ay{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):xi("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}const po="FirestoreClient";class iI{constructor(e,t,i,l,u){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this._databaseInfo=l,this.user=pr.UNAUTHENTICATED,this.clientId=ay.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=u,this.authCredentials.start(i,(async d=>{ht(po,"Received user=",d.uid),await this.authCredentialListener(d),this.user=d})),this.appCheckCredentials.start(i,(d=>(ht(po,"Received new app check token=",d),this.appCheckCredentialListener(d,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this._databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new gi;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const i=jy(t,"Failed to shutdown persistence");e.reject(i)}})),e.promise}}async function Op(n,e){n.asyncQueue.verifyOperationInProgress(),ht(po,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let i=t.initialUser;n.setCredentialChangeListener((async l=>{i.isEqual(l)||(await G_(e.localStore,l),i=l)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function r2(n,e){n.asyncQueue.verifyOperationInProgress();const t=await oI(n);ht(po,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((i=>Jx(e.remoteStore,i))),n.setAppCheckTokenChangeListener(((i,l)=>Jx(e.remoteStore,l))),n._onlineComponents=e}async function oI(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){ht(po,"Using user provided OfflineComponentProvider");try{await Op(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(l){return l.name==="FirebaseError"?l.code===Ce.FAILED_PRECONDITION||l.code===Ce.UNIMPLEMENTED:!(typeof DOMException<"u"&&l instanceof DOMException)||l.code===22||l.code===20||l.code===11})(t))throw t;Xl("Error using user provided cache. Falling back to memory cache: "+t),await Op(n,new $h)}}else ht(po,"Using default OfflineComponentProvider"),await Op(n,new aI(void 0));return n._offlineComponents}async function dk(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(ht(po,"Using user provided OnlineComponentProvider"),await r2(n,n._uninitializedComponentsProvider._online)):(ht(po,"Using default OnlineComponentProvider"),await r2(n,new Rg))),n._onlineComponents}function lI(n){return dk(n).then((e=>e.syncEngine))}async function Wh(n){const e=await dk(n),t=e.eventManager;return t.onListen=WM.bind(null,e.syncEngine),t.onUnlisten=YM.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=GM.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=QM.bind(null,e.syncEngine),t}function cI(n,e,t,i){const l=new Ay(i),u=new Ny(e,l,t);return n.asyncQueue.enqueueAndForget((async()=>Ty(await Wh(n),u))),()=>{l.Nu(),n.asyncQueue.enqueueAndForget((async()=>Ey(await Wh(n),u)))}}function uI(n,e,t={}){const i=new gi;return n.asyncQueue.enqueueAndForget((async()=>(function(u,d,p,g,y){const x=new Ay({next:T=>{x.Nu(),d.enqueueAndForget((()=>Ey(u,k)));const O=T.docs.has(p);!O&&T.fromCache?y.reject(new at(Ce.UNAVAILABLE,"Failed to get document because the client is offline.")):O&&T.fromCache&&g&&g.source==="server"?y.reject(new at(Ce.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):y.resolve(T)},error:T=>y.reject(T)}),k=new Ny(lm(p.path),x,{includeMetadataChanges:!0,Ka:!0});return Ty(u,k)})(await Wh(n),n.asyncQueue,e,t,i))),i.promise}function dI(n,e,t={}){const i=new gi;return n.asyncQueue.enqueueAndForget((async()=>(function(u,d,p,g,y){const x=new Ay({next:T=>{x.Nu(),d.enqueueAndForget((()=>Ey(u,k))),T.fromCache&&g.source==="server"?y.reject(new at(Ce.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):y.resolve(T)},error:T=>y.reject(T)}),k=new Ny(p,x,{includeMetadataChanges:!0,Ka:!0});return Ty(u,k)})(await Wh(n),n.asyncQueue,e,t,i))),i.promise}function hI(n,e){const t=new gi;return n.asyncQueue.enqueueAndForget((async()=>XM(await lI(n),e,t))),t.promise}function hk(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}const mI="ComponentProvider",a2=new Map;function fI(n,e,t,i,l){return new DR(n,e,t,l.host,l.ssl,l.experimentalForceLongPolling,l.experimentalAutoDetectLongPolling,hk(l.experimentalLongPollingOptions),l.useFetchStreams,l.isUsingEmulator,i)}const mk="firestore.googleapis.com",i2=!0;class o2{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new at(Ce.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=mk,this.ssl=i2}else this.host=e.host,this.ssl=e.ssl??i2;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=$_;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<FA)throw new at(Ce.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}_R("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=hk(e.experimentalLongPollingOptions??{}),(function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new at(Ce.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new at(Ce.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new at(Ce.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(i,l){return i.timeoutSeconds===l.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class bm{constructor(e,t,i,l){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=l,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new o2({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new at(Ce.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new at(Ce.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new o2(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(i){if(!i)return new hR;switch(i.type){case"firstParty":return new gR(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new at(Ce.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const i=a2.get(t);i&&(ht(mI,"Removing Datastore"),a2.delete(t),i.terminate())})(this),Promise.resolve()}}function pI(n,e,t,i={}){n=Er(n,bm);const l=go(e),u=n._getSettings(),d={...u,emulatorOptions:n._getEmulatorOptions()},p=`${e}:${t}`;l&&(qg(`https://${p}`),Hg("Firestore",!0)),u.host!==mk&&u.host!==p&&Xl("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const g={...u,host:p,ssl:l,emulatorOptions:i};if(!Go(g,d)&&(n._setSettings(g),i.mockUserToken)){let y,x;if(typeof i.mockUserToken=="string")y=i.mockUserToken,x=pr.MOCK_USER;else{y=ow(i.mockUserToken,n._app?.options.projectId);const k=i.mockUserToken.sub||i.mockUserToken.user_id;if(!k)throw new at(Ce.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");x=new pr(k)}n._authCredentials=new mR(new e_(y,x))}}class ji{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new ji(this.firestore,e,this._query)}}class _n{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new oo(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new _n(this.firestore,e,this._key)}toJSON(){return{type:_n._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,i){if(Ou(t,_n._jsonSchema))return new _n(e,i||null,new At(an.fromString(t.referencePath)))}}_n._jsonSchemaVersion="firestore/documentReference/1.0",_n._jsonSchema={type:Fn("string",_n._jsonSchemaVersion),referencePath:Fn("string")};class oo extends ji{constructor(e,t,i){super(e,t,lm(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new _n(this.firestore,null,new At(e))}withConverter(e){return new oo(this.firestore,e,this._path)}}function Ft(n,e,...t){if(n=Zs(n),t_("collection","path",e),n instanceof bm){const i=an.fromString(e,...t);return xx(i),new oo(n,null,i)}{if(!(n instanceof _n||n instanceof oo))throw new at(Ce.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(an.fromString(e,...t));return xx(i),new oo(n.firestore,null,i)}}function $e(n,e,...t){if(n=Zs(n),arguments.length===1&&(e=ay.newId()),t_("doc","path",e),n instanceof bm){const i=an.fromString(e,...t);return vx(i),new _n(n,null,new At(i))}{if(!(n instanceof _n||n instanceof oo))throw new at(Ce.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(an.fromString(e,...t));return vx(i),new _n(n.firestore,n instanceof oo?n.converter:null,new At(i))}}const l2="AsyncQueue";class c2{constructor(e=Promise.resolve()){this.Yu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new Y_(this,"async_queue_retry"),this._c=()=>{const i=Lp();i&&ht(l2,"Visibility state changed to "+i.visibilityState),this.M_.w_()},this.ac=e;const t=Lp();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=Lp();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new gi;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Yu.push(e),this.lc())))}async lc(){if(this.Yu.length!==0){try{await this.Yu[0](),this.Yu.shift(),this.M_.reset()}catch(e){if(!cc(e))throw e;ht(l2,"Operation failed with retryable error: "+e)}this.Yu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((i=>{throw this.nc=i,this.rc=!1,xi("INTERNAL UNHANDLED ERROR: ",u2(i)),i})).then((i=>(this.rc=!1,i))))));return this.ac=t,t}enqueueAfterDelay(e,t,i){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const l=ky.createAndSchedule(this,e,t,i,(u=>this.hc(u)));return this.tc.push(l),l}uc(){this.nc&&qt(47125,{Pc:u2(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,i)=>t.targetTimeMs-i.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}Rc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function u2(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}class Ga extends bm{constructor(e,t,i,l){super(e,t,i,l),this.type="firestore",this._queue=new c2,this._persistenceKey=l?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new c2(e),this._firestoreClient=void 0,await e}}}function gI(n,e){const t=typeof n=="object"?n:Kg(),i=typeof n=="string"?n:Bh,l=em(t,"firestore").getImmediate({identifier:i});if(!l._initialized){const u=rw("firestore");u&&pI(l,...u)}return l}function zu(n){if(n._terminated)throw new at(Ce.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||yI(n),n._firestoreClient}function yI(n){const e=n._freezeSettings(),t=fI(n._databaseId,n._app?.options.appId||"",n._persistenceKey,n._app?.options.apiKey,e);n._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new iI(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(l){const u=l?._online.build();return{_offline:l?._offline.build(u),_online:u}})(n._componentsProvider))}class ca{constructor(e){this._byteString=e}static fromBase64String(e){try{return new ca(or.fromBase64String(e))}catch(t){throw new at(Ce.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new ca(or.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:ca._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Ou(e,ca._jsonSchema))return ca.fromBase64String(e.bytes)}}ca._jsonSchemaVersion="firestore/bytes/1.0",ca._jsonSchema={type:Fn("string",ca._jsonSchemaVersion),bytes:Fn("string")};class vm{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new at(Ce.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ir(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class qu{constructor(e){this._methodName=e}}class $a{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new at(Ce.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new at(Ce.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return xs(this._lat,e._lat)||xs(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:$a._jsonSchemaVersion}}static fromJSON(e){if(Ou(e,$a._jsonSchema))return new $a(e.latitude,e.longitude)}}$a._jsonSchemaVersion="firestore/geoPoint/1.0",$a._jsonSchema={type:Fn("string",$a._jsonSchemaVersion),latitude:Fn("number"),longitude:Fn("number")};class ja{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(i,l){if(i.length!==l.length)return!1;for(let u=0;u<i.length;++u)if(i[u]!==l[u])return!1;return!0})(this._values,e._values)}toJSON(){return{type:ja._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Ou(e,ja._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new ja(e.vectorValues);throw new at(Ce.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}ja._jsonSchemaVersion="firestore/vectorValue/1.0",ja._jsonSchema={type:Fn("string",ja._jsonSchemaVersion),vectorValues:Fn("object")};const bI=/^__.*__$/;class vI{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return this.fieldMask!==null?new vo(e,this.data,this.fieldMask,t,this.fieldTransforms):new Bu(e,this.data,t,this.fieldTransforms)}}class fk{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return new vo(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function pk(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw qt(40011,{dataSource:n})}}class My{constructor(e,t,i,l,u,d){this.settings=e,this.databaseId=t,this.serializer=i,this.ignoreUndefinedProperties=l,u===void 0&&this.validatePath(),this.fieldTransforms=u||[],this.fieldMask=d||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(e){return new My({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(e){const t=this.path?.child(e),i=this.contextWith({path:t,arrayElement:!1});return i.validatePathSegment(e),i}childContextForFieldPath(e){const t=this.path?.child(e),i=this.contextWith({path:t,arrayElement:!1});return i.validatePath(),i}childContextForArray(e){return this.contextWith({path:void 0,arrayElement:!0})}createError(e){return Gh(e,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}validatePath(){if(this.path)for(let e=0;e<this.path.length;e++)this.validatePathSegment(this.path.get(e))}validatePathSegment(e){if(e.length===0)throw this.createError("Document fields must not be empty");if(pk(this.dataSource)&&bI.test(e))throw this.createError('Document fields cannot begin and end with "__"')}}class xI{constructor(e,t,i){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=i||pm(e)}createContext(e,t,i,l=!1){return new My({dataSource:e,methodName:t,targetDoc:i,path:ir.emptyPath(),arrayElement:!1,hasConverter:l},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Hu(n){const e=n._freezeSettings(),t=pm(n._databaseId);return new xI(n._databaseId,!!e.ignoreUndefinedProperties,t)}function Iy(n,e,t,i,l,u={}){const d=n.createContext(u.merge||u.mergeFields?2:0,e,t,l);Ly("Data must be an object, but it was:",d,i);const p=bk(i,d);let g,y;if(u.merge)g=new Xr(d.fieldMask),y=d.fieldTransforms;else if(u.mergeFields){const x=[];for(const k of u.mergeFields){const T=Zo(e,k,t);if(!d.contains(T))throw new at(Ce.INVALID_ARGUMENT,`Field '${T}' is specified in your field mask but missing from your input data.`);wk(x,T)||x.push(T)}g=new Xr(x),y=d.fieldTransforms.filter((k=>g.covers(k.field)))}else g=null,y=d.fieldTransforms;return new vI(new Br(p),g,y)}class xm extends qu{_toFieldTransform(e){if(e.dataSource!==2)throw e.dataSource===1?e.createError(`${this._methodName}() can only appear at the top level of your update data`):e.createError(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof xm}}class Dy extends qu{_toFieldTransform(e){return new A_(e.path,new Tu)}isEqual(e){return e instanceof Dy}}class Py extends qu{constructor(e,t){super(e),this.Vc=t}_toFieldTransform(e){const t=new Nu(e.serializer,E_(e.serializer,this.Vc));return new A_(e.path,t)}isEqual(e){return e instanceof Py&&this.Vc===e.Vc}}function gk(n,e,t,i){const l=n.createContext(1,e,t);Ly("Data must be an object, but it was:",l,i);const u=[],d=Br.empty();bo(i,((g,y)=>{const x=xk(e,g,t);y=Zs(y);const k=l.childContextForFieldPath(x);if(y instanceof xm)u.push(x);else{const T=$u(y,k);T!=null&&(u.push(x),d.set(x,T))}}));const p=new Xr(u);return new fk(d,p,l.fieldTransforms)}function yk(n,e,t,i,l,u){const d=n.createContext(1,e,t),p=[Zo(e,i,t)],g=[l];if(u.length%2!=0)throw new at(Ce.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let T=0;T<u.length;T+=2)p.push(Zo(e,u[T])),g.push(u[T+1]);const y=[],x=Br.empty();for(let T=p.length-1;T>=0;--T)if(!wk(y,p[T])){const O=p[T];let G=g[T];G=Zs(G);const F=d.childContextForFieldPath(O);if(G instanceof xm)y.push(O);else{const V=$u(G,F);V!=null&&(y.push(O),x.set(O,V))}}const k=new Xr(y);return new fk(x,k,d.fieldTransforms)}function wI(n,e,t,i=!1){return $u(t,n.createContext(i?4:3,e))}function $u(n,e){if(vk(n=Zs(n)))return Ly("Unsupported field value:",e,n),bk(n,e);if(n instanceof qu)return(function(i,l){if(!pk(l.dataSource))throw l.createError(`${i._methodName}() can only be used with update() and set()`);if(!l.path)throw l.createError(`${i._methodName}() is not currently supported inside arrays`);const u=i._toFieldTransform(l);u&&l.fieldTransforms.push(u)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.arrayElement&&e.dataSource!==4)throw e.createError("Nested arrays are not supported");return(function(i,l){const u=[];let d=0;for(const p of i){let g=$u(p,l.childContextForArray(d));g==null&&(g={nullValue:"NULL_VALUE"}),u.push(g),d++}return{arrayValue:{values:u}}})(n,e)}return(function(i,l){if((i=Zs(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return E_(l.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const u=kt.fromDate(i);return{timestampValue:zh(l.serializer,u)}}if(i instanceof kt){const u=new kt(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:zh(l.serializer,u)}}if(i instanceof $a)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof ca)return{bytesValue:O_(l.serializer,i._byteString)};if(i instanceof _n){const u=l.databaseId,d=i.firestore._databaseId;if(!d.isEqual(u))throw l.createError(`Document reference is for database ${d.projectId}/${d.database} but should be for database ${u.projectId}/${u.database}`);return{referenceValue:fy(i.firestore._databaseId||l.databaseId,i._key.path)}}if(i instanceof ja)return(function(d,p){const g=d instanceof ja?d.toArray():d;return{mapValue:{fields:{[u_]:{stringValue:d_},[Vh]:{arrayValue:{values:g.map((x=>{if(typeof x!="number")throw p.createError("VectorValues must only contain numeric values.");return dy(p.serializer,x)}))}}}}}})(i,l);if(H_(i))return i._toProto(l.serializer);throw l.createError(`Unsupported field value: ${rm(i)}`)})(n,e)}function bk(n,e){const t={};return r_(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):bo(n,((i,l)=>{const u=$u(l,e.childContextForField(i));u!=null&&(t[i]=u)})),{mapValue:{fields:t}}}function vk(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof kt||n instanceof $a||n instanceof ca||n instanceof _n||n instanceof qu||n instanceof ja||H_(n))}function Ly(n,e,t){if(!vk(t)||!s_(t)){const i=rm(t);throw i==="an object"?e.createError(n+" a custom object"):e.createError(n+" "+i)}}function Zo(n,e,t){if((e=Zs(e))instanceof vm)return e._internalPath;if(typeof e=="string")return xk(n,e);throw Gh("Field path arguments must be of type string or ",n,!1,void 0,t)}const _I=new RegExp("[~\\*/\\[\\]]");function xk(n,e,t){if(e.search(_I)>=0)throw Gh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new vm(...e.split("."))._internalPath}catch{throw Gh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Gh(n,e,t,i,l){const u=i&&!i.isEmpty(),d=l!==void 0;let p=`Function ${e}() called with invalid data`;t&&(p+=" (via `toFirestore()`)"),p+=". ";let g="";return(u||d)&&(g+=" (found",u&&(g+=` in field ${i}`),d&&(g+=` in document ${l}`),g+=")"),new at(Ce.INVALID_ARGUMENT,p+n+g)}function wk(n,e){return n.some((t=>t.isEqual(e)))}class kI{convertValue(e,t="none"){switch(mo(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Cn(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(ho(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw qt(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const i={};return bo(e,((l,u)=>{i[l]=this.convertValue(u,t)})),i}convertVectorValue(e){const t=e.fields?.[Vh].arrayValue?.values?.map((i=>Cn(i.doubleValue)));return new ja(t)}convertGeoPoint(e){return new $a(Cn(e.latitude),Cn(e.longitude))}convertArray(e,t){return(e.values||[]).map((i=>this.convertValue(i,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const i=om(e);return i==null?null:this.convertValue(i,t);case"estimate":return this.convertTimestamp(wu(e));default:return null}}convertTimestamp(e){const t=uo(e);return new kt(t.seconds,t.nanos)}convertDocumentKey(e,t){const i=an.fromString(e);Fs(q_(i),9688,{name:e});const l=new _u(i.get(1),i.get(3)),u=new At(i.popFirst(5));return l.isEqual(t)||xi(`Document ${u} contains a document reference within a different database (${l.projectId}/${l.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),u}}class Oy extends kI{constructor(e){super(),this.firestore=e}convertBytes(e){return new ca(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new _n(this.firestore,null,t)}}function yr(){return new Dy("serverTimestamp")}function zo(n){return new Py("increment",n)}const d2="@firebase/firestore",h2="4.10.0";function m2(n){return(function(t,i){if(typeof t!="object"||t===null)return!1;const l=t;for(const u of i)if(u in l&&typeof l[u]=="function")return!0;return!1})(n,["next","error","complete"])}class _k{constructor(e,t,i,l,u){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=l,this._converter=u}get id(){return this._key.path.lastSegment()}get ref(){return new _n(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new jI(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}_fieldsProto(){return this._document?.data.clone().value.mapValue.fields??void 0}get(e){if(this._document){const t=this._document.data.field(Zo("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class jI extends _k{data(){return super.data()}}function kk(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new at(Ce.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class By{}class Vy extends By{}function Ps(n,e,...t){let i=[];e instanceof By&&i.push(e),i=i.concat(t),(function(u){const d=u.filter((g=>g instanceof Uy)).length,p=u.filter((g=>g instanceof wm)).length;if(d>1||d>0&&p>0)throw new at(Ce.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(i);for(const l of i)n=l._apply(n);return n}class wm extends Vy{constructor(e,t,i){super(),this._field=e,this._op=t,this._value=i,this.type="where"}static _create(e,t,i){return new wm(e,t,i)}_apply(e){const t=this._parse(e);return jk(e._query,t),new ji(e.firestore,e.converter,wg(e._query,t))}_parse(e){const t=Hu(e.firestore);return(function(u,d,p,g,y,x,k){let T;if(y.isKeyField()){if(x==="array-contains"||x==="array-contains-any")throw new at(Ce.INVALID_ARGUMENT,`Invalid Query. You can't perform '${x}' queries on documentId().`);if(x==="in"||x==="not-in"){p2(k,x);const G=[];for(const F of k)G.push(f2(g,u,F));T={arrayValue:{values:G}}}else T=f2(g,u,k)}else x!=="in"&&x!=="not-in"&&x!=="array-contains-any"||p2(k,x),T=wI(p,d,k,x==="in"||x==="not-in");return Un.create(y,x,T)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function ps(n,e,t){const i=e,l=Zo("where",n);return wm._create(l,i,t)}class Uy extends By{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Uy(e,t)}_parse(e){const t=this._queryConstraints.map((i=>i._parse(e))).filter((i=>i.getFilters().length>0));return t.length===1?t[0]:Ea.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(l,u){let d=l;const p=u.getFlattenedFilters();for(const g of p)jk(d,g),d=wg(d,g)})(e._query,t),new ji(e.firestore,e.converter,wg(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Fy extends Vy{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new Fy(e,t)}_apply(e){const t=(function(l,u,d){if(l.startAt!==null)throw new at(Ce.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(l.endAt!==null)throw new at(Ce.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new ju(u,d)})(e._query,this._field,this._direction);return new ji(e.firestore,e.converter,JR(e._query,t))}}function Kh(n,e="asc"){const t=e,i=Zo("orderBy",n);return Fy._create(i,t)}class zy extends Vy{constructor(e,t,i){super(),this.type=e,this._limit=t,this._limitType=i}static _create(e,t,i){return new zy(e,t,i)}_apply(e){return new ji(e.firestore,e.converter,Fh(e._query,this._limit,this._limitType))}}function Yh(n){return kR("limit",n),zy._create("limit",n,"F")}function f2(n,e,t){if(typeof(t=Zs(t))=="string"){if(t==="")throw new at(Ce.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!v_(e)&&t.indexOf("/")!==-1)throw new at(Ce.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const i=e.path.child(an.fromString(t));if(!At.isDocumentKey(i))throw new at(Ce.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return Nx(n,new At(i))}if(t instanceof _n)return Nx(n,t._key);throw new at(Ce.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${rm(t)}.`)}function p2(n,e){if(!Array.isArray(n)||n.length===0)throw new at(Ce.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function jk(n,e){const t=(function(l,u){for(const d of l)for(const p of d.getFlattenedFilters())if(u.indexOf(p.op)>=0)return p.op;return null})(n.filters,(function(l){switch(l){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new at(Ce.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new at(Ce.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}function qy(n,e,t){let i;return i=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,i}class lu{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class qo extends _k{constructor(e,t,i,l,u,d){super(e,t,i,l,d),this._firestore=e,this._firestoreImpl=e,this.metadata=u}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Eh(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const i=this._document.data.field(Zo("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new at(Ce.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=qo._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}qo._jsonSchemaVersion="firestore/documentSnapshot/1.0",qo._jsonSchema={type:Fn("string",qo._jsonSchemaVersion),bundleSource:Fn("string","DocumentSnapshot"),bundleName:Fn("string"),bundle:Fn("string")};class Eh extends qo{data(e={}){return super.data(e)}}class Ho{constructor(e,t,i,l){this._firestore=e,this._userDataWriter=t,this._snapshot=l,this.metadata=new lu(l.hasPendingWrites,l.fromCache),this.query=i}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((i=>{e.call(t,new Eh(this._firestore,this._userDataWriter,i.key,i,new lu(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new at(Ce.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(l,u){if(l._snapshot.oldDocs.isEmpty()){let d=0;return l._snapshot.docChanges.map((p=>{const g=new Eh(l._firestore,l._userDataWriter,p.doc.key,p.doc,new lu(l._snapshot.mutatedKeys.has(p.doc.key),l._snapshot.fromCache),l.query.converter);return p.doc,{type:"added",doc:g,oldIndex:-1,newIndex:d++}}))}{let d=l._snapshot.oldDocs;return l._snapshot.docChanges.filter((p=>u||p.type!==3)).map((p=>{const g=new Eh(l._firestore,l._userDataWriter,p.doc.key,p.doc,new lu(l._snapshot.mutatedKeys.has(p.doc.key),l._snapshot.fromCache),l.query.converter);let y=-1,x=-1;return p.type!==0&&(y=d.indexOf(p.doc.key),d=d.delete(p.doc.key)),p.type!==1&&(d=d.add(p.doc),x=d.indexOf(p.doc.key)),{type:TI(p.type),doc:g,oldIndex:y,newIndex:x}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new at(Ce.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Ho._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=ay.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],i=[],l=[];return this.docs.forEach((u=>{u._document!==null&&(t.push(u._document),i.push(this._userDataWriter.convertObjectMap(u._document.data.value.mapValue.fields,"previous")),l.push(u.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function TI(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return qt(61501,{type:n})}}Ho._jsonSchemaVersion="firestore/querySnapshot/1.0",Ho._jsonSchema={type:Fn("string",Ho._jsonSchemaVersion),bundleSource:Fn("string","QuerySnapshot"),bundleName:Fn("string"),bundle:Fn("string")};class EI{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Hu(e)}set(e,t,i){this._verifyNotCommitted();const l=Bp(e,this._firestore),u=qy(l.converter,t,i),d=Iy(this._dataReader,"WriteBatch.set",l._key,u,l.converter!==null,i);return this._mutations.push(d.toMutation(l._key,Sr.none())),this}update(e,t,i,...l){this._verifyNotCommitted();const u=Bp(e,this._firestore);let d;return d=typeof(t=Zs(t))=="string"||t instanceof vm?yk(this._dataReader,"WriteBatch.update",u._key,t,i,l):gk(this._dataReader,"WriteBatch.update",u._key,t),this._mutations.push(d.toMutation(u._key,Sr.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=Bp(e,this._firestore);return this._mutations=this._mutations.concat(new mm(t._key,Sr.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new at(Ce.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Bp(n,e){if((n=Zs(n)).firestore!==e)throw new at(Ce.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}function As(n){n=Er(n,_n);const e=Er(n.firestore,Ga),t=zu(e);return uI(t,n._key).then((i=>Ek(e,n,i)))}function Ss(n){n=Er(n,ji);const e=Er(n.firestore,Ga),t=zu(e),i=new Oy(e);return kk(n._query),dI(t,n._query).then((l=>new Ho(e,i,n,l)))}function Ns(n,e,t){n=Er(n,_n);const i=Er(n.firestore,Ga),l=qy(n.converter,e,t),u=Hu(i);return Wu(i,[Iy(u,"setDoc",n._key,l,n.converter!==null,t).toMutation(n._key,Sr.none())])}function Ba(n,e,t,...i){n=Er(n,_n);const l=Er(n.firestore,Ga),u=Hu(l);let d;return d=typeof(e=Zs(e))=="string"||e instanceof vm?yk(u,"updateDoc",n._key,e,t,i):gk(u,"updateDoc",n._key,e),Wu(l,[d.toMutation(n._key,Sr.exists(!0))])}function jr(n){return Wu(Er(n.firestore,Ga),[new mm(n._key,Sr.none())])}function ua(n,e){const t=Er(n.firestore,Ga),i=$e(n),l=qy(n.converter,e),u=Hu(n.firestore);return Wu(t,[Iy(u,"addDoc",i._key,l,n.converter!==null,{}).toMutation(i._key,Sr.exists(!1))]).then((()=>i))}function Tk(n,...e){n=Zs(n);let t={includeMetadataChanges:!1,source:"default"},i=0;typeof e[i]!="object"||m2(e[i])||(t=e[i++]);const l={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(m2(e[i])){const y=e[i];e[i]=y.next?.bind(y),e[i+1]=y.error?.bind(y),e[i+2]=y.complete?.bind(y)}let u,d,p;if(n instanceof _n)d=Er(n.firestore,Ga),p=lm(n._key.path),u={next:y=>{e[i]&&e[i](Ek(d,n,y))},error:e[i+1],complete:e[i+2]};else{const y=Er(n,ji);d=Er(y.firestore,Ga),p=y._query;const x=new Oy(d);u={next:k=>{e[i]&&e[i](new Ho(d,x,y,k))},error:e[i+1],complete:e[i+2]},kk(n._query)}const g=zu(d);return cI(g,p,l,u)}function Wu(n,e){const t=zu(n);return hI(t,e)}function Ek(n,e,t){const i=t.docs.get(e._key),l=new Oy(n);return new qo(n,l,e._key,i,new lu(t.hasPendingWrites,t.fromCache),e.converter)}function g2(n){return n=Er(n,Ga),zu(n),new EI(n,(e=>Wu(n,e)))}(function(e,t=!0){dR(tl),Ko(new lo("firestore",((i,{instanceIdentifier:l,options:u})=>{const d=i.getProvider("app").getImmediate(),p=new Ga(new fR(i.getProvider("auth-internal")),new yR(d,i.getProvider("app-check-internal")),PR(d,l),d);return u={useFetchStreams:t,...u},p._setSettings(u),p}),"PUBLIC").setMultipleInstances(!0)),Ua(d2,h2,e),Ua(d2,h2,"esm2020")})();var SI="firebase",NI="12.8.0";Ua(SI,NI,"app");const Sk="firebasestorage.googleapis.com",Nk="storageBucket",CI=120*1e3,RI=600*1e3;class jn extends Ka{constructor(e,t,i=0){super(Vp(e),`Firebase Storage: ${t} (${Vp(e)})`),this.status_=i,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,jn.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Vp(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var kn;(function(n){n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(kn||(kn={}));function Vp(n){return"storage/"+n}function Hy(){const n="An unknown error occurred, please check the error payload for server response.";return new jn(kn.UNKNOWN,n)}function AI(n){return new jn(kn.OBJECT_NOT_FOUND,"Object '"+n+"' does not exist.")}function MI(n){return new jn(kn.QUOTA_EXCEEDED,"Quota for bucket '"+n+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function II(){const n="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new jn(kn.UNAUTHENTICATED,n)}function DI(){return new jn(kn.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function PI(n){return new jn(kn.UNAUTHORIZED,"User does not have permission to access '"+n+"'.")}function LI(){return new jn(kn.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function OI(){return new jn(kn.CANCELED,"User canceled the upload/download.")}function BI(n){return new jn(kn.INVALID_URL,"Invalid URL '"+n+"'.")}function VI(n){return new jn(kn.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function UI(){return new jn(kn.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+Nk+"' property when initializing the app?")}function FI(){return new jn(kn.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function zI(){return new jn(kn.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function qI(n){return new jn(kn.UNSUPPORTED_ENVIRONMENT,`${n} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function Ag(n){return new jn(kn.INVALID_ARGUMENT,n)}function Ck(){return new jn(kn.APP_DELETED,"The Firebase app was deleted.")}function HI(n){return new jn(kn.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function pu(n,e){return new jn(kn.INVALID_FORMAT,"String does not match format '"+n+"': "+e)}function Jc(n){throw new jn(kn.INTERNAL_ERROR,"Internal error: "+n)}class Tr{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let i;try{i=Tr.makeFromUrl(e,t)}catch{return new Tr(e,"")}if(i.path==="")return i;throw VI(e)}static makeFromUrl(e,t){let i=null;const l="([A-Za-z0-9.\\-_]+)";function u(he){he.path.charAt(he.path.length-1)==="/"&&(he.path_=he.path_.slice(0,-1))}const d="(/(.*))?$",p=new RegExp("^gs://"+l+d,"i"),g={bucket:1,path:3};function y(he){he.path_=decodeURIComponent(he.path)}const x="v[A-Za-z0-9_]+",k=t.replace(/[.]/g,"\\."),T="(/([^?#]*).*)?$",O=new RegExp(`^https?://${k}/${x}/b/${l}/o${T}`,"i"),G={bucket:1,path:3},F=t===Sk?"(?:storage.googleapis.com|storage.cloud.google.com)":t,V="([^?#]*)",te=new RegExp(`^https?://${F}/${l}/${V}`,"i"),ie=[{regex:p,indices:g,postModify:u},{regex:O,indices:G,postModify:y},{regex:te,indices:{bucket:1,path:2},postModify:y}];for(let he=0;he<ie.length;he++){const Ne=ie[he],fe=Ne.regex.exec(e);if(fe){const R=fe[Ne.indices.bucket];let E=fe[Ne.indices.path];E||(E=""),i=new Tr(R,E),Ne.postModify(i);break}}if(i==null)throw BI(e);return i}}class $I{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function WI(n,e,t){let i=1,l=null,u=null,d=!1,p=0;function g(){return p===2}let y=!1;function x(...V){y||(y=!0,e.apply(null,V))}function k(V){l=setTimeout(()=>{l=null,n(O,g())},V)}function T(){u&&clearTimeout(u)}function O(V,...te){if(y){T();return}if(V){T(),x.call(null,V,...te);return}if(g()||d){T(),x.call(null,V,...te);return}i<64&&(i*=2);let ie;p===1?(p=2,ie=0):ie=(i+Math.random())*1e3,k(ie)}let G=!1;function F(V){G||(G=!0,T(),!y&&(l!==null?(V||(p=2),clearTimeout(l),k(0)):V||(p=1)))}return k(0),u=setTimeout(()=>{d=!0,F(!0)},t),F}function GI(n){n(!1)}function KI(n){return n!==void 0}function YI(n){return typeof n=="object"&&!Array.isArray(n)}function $y(n){return typeof n=="string"||n instanceof String}function y2(n){return Wy()&&n instanceof Blob}function Wy(){return typeof Blob<"u"}function Mg(n,e,t,i){if(i<e)throw Ag(`Invalid value for '${n}'. Expected ${e} or greater.`);if(i>t)throw Ag(`Invalid value for '${n}'. Expected ${t} or less.`)}function _m(n,e,t){let i=e;return t==null&&(i=`https://${e}`),`${t}://${i}/v0${n}`}function Rk(n){const e=encodeURIComponent;let t="?";for(const i in n)if(n.hasOwnProperty(i)){const l=e(i)+"="+e(n[i]);t=t+l+"&"}return t=t.slice(0,-1),t}var $o;(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"})($o||($o={}));function QI(n,e){const t=n>=500&&n<600,l=[408,429].indexOf(n)!==-1,u=e.indexOf(n)!==-1;return t||l||u}class XI{constructor(e,t,i,l,u,d,p,g,y,x,k,T=!0,O=!1){this.url_=e,this.method_=t,this.headers_=i,this.body_=l,this.successCodes_=u,this.additionalRetryCodes_=d,this.callback_=p,this.errorCallback_=g,this.timeout_=y,this.progressCallback_=x,this.connectionFactory_=k,this.retry=T,this.isUsingEmulator=O,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((G,F)=>{this.resolve_=G,this.reject_=F,this.start_()})}start_(){const e=(i,l)=>{if(l){i(!1,new oh(!1,null,!0));return}const u=this.connectionFactory_();this.pendingConnection_=u;const d=p=>{const g=p.loaded,y=p.lengthComputable?p.total:-1;this.progressCallback_!==null&&this.progressCallback_(g,y)};this.progressCallback_!==null&&u.addUploadProgressListener(d),u.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&u.removeUploadProgressListener(d),this.pendingConnection_=null;const p=u.getErrorCode()===$o.NO_ERROR,g=u.getStatus();if(!p||QI(g,this.additionalRetryCodes_)&&this.retry){const x=u.getErrorCode()===$o.ABORT;i(!1,new oh(!1,null,x));return}const y=this.successCodes_.indexOf(g)!==-1;i(!0,new oh(y,u))})},t=(i,l)=>{const u=this.resolve_,d=this.reject_,p=l.connection;if(l.wasSuccessCode)try{const g=this.callback_(p,p.getResponse());KI(g)?u(g):u()}catch(g){d(g)}else if(p!==null){const g=Hy();g.serverResponse=p.getErrorText(),this.errorCallback_?d(this.errorCallback_(p,g)):d(g)}else if(l.canceled){const g=this.appDelete_?Ck():OI();d(g)}else{const g=LI();d(g)}};this.canceled_?t(!1,new oh(!1,null,!0)):this.backoffId_=WI(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&GI(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class oh{constructor(e,t,i){this.wasSuccessCode=e,this.connection=t,this.canceled=!!i}}function JI(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function ZI(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function e3(n,e){e&&(n["X-Firebase-GMPID"]=e)}function t3(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function s3(n,e,t,i,l,u,d=!0,p=!1){const g=Rk(n.urlParams),y=n.url+g,x=Object.assign({},n.headers);return e3(x,e),JI(x,t),ZI(x,u),t3(x,i),new XI(y,n.method,x,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,l,d,p)}function n3(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function r3(...n){const e=n3();if(e!==void 0){const t=new e;for(let i=0;i<n.length;i++)t.append(n[i]);return t.getBlob()}else{if(Wy())return new Blob(n);throw new jn(kn.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function a3(n,e,t){return n.webkitSlice?n.webkitSlice(e,t):n.mozSlice?n.mozSlice(e,t):n.slice?n.slice(e,t):null}function i3(n){if(typeof atob>"u")throw qI("base-64");return atob(n)}const Va={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class Up{constructor(e,t){this.data=e,this.contentType=t||null}}function o3(n,e){switch(n){case Va.RAW:return new Up(Ak(e));case Va.BASE64:case Va.BASE64URL:return new Up(Mk(n,e));case Va.DATA_URL:return new Up(c3(e),u3(e))}throw Hy()}function Ak(n){const e=[];for(let t=0;t<n.length;t++){let i=n.charCodeAt(t);if(i<=127)e.push(i);else if(i<=2047)e.push(192|i>>6,128|i&63);else if((i&64512)===55296)if(!(t<n.length-1&&(n.charCodeAt(t+1)&64512)===56320))e.push(239,191,189);else{const u=i,d=n.charCodeAt(++t);i=65536|(u&1023)<<10|d&1023,e.push(240|i>>18,128|i>>12&63,128|i>>6&63,128|i&63)}else(i&64512)===56320?e.push(239,191,189):e.push(224|i>>12,128|i>>6&63,128|i&63)}return new Uint8Array(e)}function l3(n){let e;try{e=decodeURIComponent(n)}catch{throw pu(Va.DATA_URL,"Malformed data URL.")}return Ak(e)}function Mk(n,e){switch(n){case Va.BASE64:{const l=e.indexOf("-")!==-1,u=e.indexOf("_")!==-1;if(l||u)throw pu(n,"Invalid character '"+(l?"-":"_")+"' found: is it base64url encoded?");break}case Va.BASE64URL:{const l=e.indexOf("+")!==-1,u=e.indexOf("/")!==-1;if(l||u)throw pu(n,"Invalid character '"+(l?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let t;try{t=i3(e)}catch(l){throw l.message.includes("polyfill")?l:pu(n,"Invalid character found")}const i=new Uint8Array(t.length);for(let l=0;l<t.length;l++)i[l]=t.charCodeAt(l);return i}class Ik{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(t===null)throw pu(Va.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const i=t[1]||null;i!=null&&(this.base64=d3(i,";base64"),this.contentType=this.base64?i.substring(0,i.length-7):i),this.rest=e.substring(e.indexOf(",")+1)}}function c3(n){const e=new Ik(n);return e.base64?Mk(Va.BASE64,e.rest):l3(e.rest)}function u3(n){return new Ik(n).contentType}function d3(n,e){return n.length>=e.length?n.substring(n.length-e.length)===e:!1}class eo{constructor(e,t){let i=0,l="";y2(e)?(this.data_=e,i=e.size,l=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),i=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),i=e.length),this.size_=i,this.type_=l}size(){return this.size_}type(){return this.type_}slice(e,t){if(y2(this.data_)){const i=this.data_,l=a3(i,e,t);return l===null?null:new eo(l)}else{const i=new Uint8Array(this.data_.buffer,e,t-e);return new eo(i,!0)}}static getBlob(...e){if(Wy()){const t=e.map(i=>i instanceof eo?i.data_:i);return new eo(r3.apply(null,t))}else{const t=e.map(d=>$y(d)?o3(Va.RAW,d).data:d.data_);let i=0;t.forEach(d=>{i+=d.byteLength});const l=new Uint8Array(i);let u=0;return t.forEach(d=>{for(let p=0;p<d.length;p++)l[u++]=d[p]}),new eo(l,!0)}}uploadData(){return this.data_}}function Gy(n){let e;try{e=JSON.parse(n)}catch{return null}return YI(e)?e:null}function h3(n){if(n.length===0)return null;const e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function m3(n,e){const t=e.split("/").filter(i=>i.length>0).join("/");return n.length===0?t:n+"/"+t}function Dk(n){const e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}function f3(n,e){return e}class kr{constructor(e,t,i,l){this.server=e,this.local=t||e,this.writable=!!i,this.xform=l||f3}}let lh=null;function p3(n){return!$y(n)||n.length<2?n:Dk(n)}function Pk(){if(lh)return lh;const n=[];n.push(new kr("bucket")),n.push(new kr("generation")),n.push(new kr("metageneration")),n.push(new kr("name","fullPath",!0));function e(u,d){return p3(d)}const t=new kr("name");t.xform=e,n.push(t);function i(u,d){return d!==void 0?Number(d):d}const l=new kr("size");return l.xform=i,n.push(l),n.push(new kr("timeCreated")),n.push(new kr("updated")),n.push(new kr("md5Hash",null,!0)),n.push(new kr("cacheControl",null,!0)),n.push(new kr("contentDisposition",null,!0)),n.push(new kr("contentEncoding",null,!0)),n.push(new kr("contentLanguage",null,!0)),n.push(new kr("contentType",null,!0)),n.push(new kr("metadata","customMetadata",!0)),lh=n,lh}function g3(n,e){function t(){const i=n.bucket,l=n.fullPath,u=new Tr(i,l);return e._makeStorageReference(u)}Object.defineProperty(n,"ref",{get:t})}function y3(n,e,t){const i={};i.type="file";const l=t.length;for(let u=0;u<l;u++){const d=t[u];i[d.local]=d.xform(i,e[d.server])}return g3(i,n),i}function Lk(n,e,t){const i=Gy(e);return i===null?null:y3(n,i,t)}function b3(n,e,t,i){const l=Gy(e);if(l===null||!$y(l.downloadTokens))return null;const u=l.downloadTokens;if(u.length===0)return null;const d=encodeURIComponent;return u.split(",").map(y=>{const x=n.bucket,k=n.fullPath,T="/b/"+d(x)+"/o/"+d(k),O=_m(T,t,i),G=Rk({alt:"media",token:y});return O+G})[0]}function v3(n,e){const t={},i=e.length;for(let l=0;l<i;l++){const u=e[l];u.writable&&(t[u.server]=n[u.local])}return JSON.stringify(t)}const b2="prefixes",v2="items";function x3(n,e,t){const i={prefixes:[],items:[],nextPageToken:t.nextPageToken};if(t[b2])for(const l of t[b2]){const u=l.replace(/\/$/,""),d=n._makeStorageReference(new Tr(e,u));i.prefixes.push(d)}if(t[v2])for(const l of t[v2]){const u=n._makeStorageReference(new Tr(e,l.name));i.items.push(u)}return i}function w3(n,e,t){const i=Gy(t);return i===null?null:x3(n,e,i)}class Ky{constructor(e,t,i,l){this.url=e,this.method=t,this.handler=i,this.timeout=l,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function Yy(n){if(!n)throw Hy()}function _3(n,e){function t(i,l){const u=Lk(n,l,e);return Yy(u!==null),u}return t}function k3(n,e){function t(i,l){const u=w3(n,e,l);return Yy(u!==null),u}return t}function j3(n,e){function t(i,l){const u=Lk(n,l,e);return Yy(u!==null),b3(u,l,n.host,n._protocol)}return t}function Qy(n){function e(t,i){let l;return t.getStatus()===401?t.getErrorText().includes("Firebase App Check token is invalid")?l=DI():l=II():t.getStatus()===402?l=MI(n.bucket):t.getStatus()===403?l=PI(n.path):l=i,l.status=t.getStatus(),l.serverResponse=i.serverResponse,l}return e}function T3(n){const e=Qy(n);function t(i,l){let u=e(i,l);return i.getStatus()===404&&(u=AI(n.path)),u.serverResponse=l.serverResponse,u}return t}function E3(n,e,t,i,l){const u={};e.isRoot?u.prefix="":u.prefix=e.path+"/",t.length>0&&(u.delimiter=t),i&&(u.pageToken=i),l&&(u.maxResults=l);const d=e.bucketOnlyServerUrl(),p=_m(d,n.host,n._protocol),g="GET",y=n.maxOperationRetryTime,x=new Ky(p,g,k3(n,e.bucket),y);return x.urlParams=u,x.errorHandler=Qy(e),x}function S3(n,e,t){const i=e.fullServerUrl(),l=_m(i,n.host,n._protocol),u="GET",d=n.maxOperationRetryTime,p=new Ky(l,u,j3(n,t),d);return p.errorHandler=T3(e),p}function N3(n,e){return n&&n.contentType||e&&e.type()||"application/octet-stream"}function C3(n,e,t){const i=Object.assign({},t);return i.fullPath=n.path,i.size=e.size(),i.contentType||(i.contentType=N3(null,e)),i}function R3(n,e,t,i,l){const u=e.bucketOnlyServerUrl(),d={"X-Goog-Upload-Protocol":"multipart"};function p(){let ie="";for(let he=0;he<2;he++)ie=ie+Math.random().toString().slice(2);return ie}const g=p();d["Content-Type"]="multipart/related; boundary="+g;const y=C3(e,i,l),x=v3(y,t),k="--"+g+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+x+`\r
--`+g+`\r
Content-Type: `+y.contentType+`\r
\r
`,T=`\r
--`+g+"--",O=eo.getBlob(k,i,T);if(O===null)throw FI();const G={name:y.fullPath},F=_m(u,n.host,n._protocol),V="POST",te=n.maxUploadRetryTime,Y=new Ky(F,V,_3(n,t),te);return Y.urlParams=G,Y.headers=d,Y.body=O.uploadData(),Y.errorHandler=Qy(e),Y}class A3{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=$o.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=$o.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=$o.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,i,l,u){if(this.sent_)throw Jc("cannot .send() more than once");if(go(e)&&i&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(t,e,!0),u!==void 0)for(const d in u)u.hasOwnProperty(d)&&this.xhr_.setRequestHeader(d,u[d].toString());return l!==void 0?this.xhr_.send(l):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Jc("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Jc("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw Jc("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Jc("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class M3 extends A3{initXhr(){this.xhr_.responseType="text"}}function Xy(){return new M3}class el{constructor(e,t){this._service=e,t instanceof Tr?this._location=t:this._location=Tr.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new el(e,t)}get root(){const e=new Tr(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return Dk(this._location.path)}get storage(){return this._service}get parent(){const e=h3(this._location.path);if(e===null)return null;const t=new Tr(this._location.bucket,e);return new el(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw HI(e)}}function I3(n,e,t){n._throwIfRoot("uploadBytes");const i=R3(n.storage,n._location,Pk(),new eo(e,!0),t);return n.storage.makeRequestWithTokens(i,Xy).then(l=>({metadata:l,ref:n}))}function D3(n){const e={prefixes:[],items:[]};return Ok(n,e).then(()=>e)}async function Ok(n,e,t){const l=await P3(n,{pageToken:t});e.prefixes.push(...l.prefixes),e.items.push(...l.items),l.nextPageToken!=null&&await Ok(n,e,l.nextPageToken)}function P3(n,e){e!=null&&typeof e.maxResults=="number"&&Mg("options.maxResults",1,1e3,e.maxResults);const t=e||{},i=E3(n.storage,n._location,"/",t.pageToken,t.maxResults);return n.storage.makeRequestWithTokens(i,Xy)}function L3(n){n._throwIfRoot("getDownloadURL");const e=S3(n.storage,n._location,Pk());return n.storage.makeRequestWithTokens(e,Xy).then(t=>{if(t===null)throw zI();return t})}function O3(n,e){const t=m3(n._location.path,e),i=new Tr(n._location.bucket,t);return new el(n.storage,i)}function B3(n){return/^[A-Za-z]+:\/\//.test(n)}function V3(n,e){return new el(n,e)}function Bk(n,e){if(n instanceof Jy){const t=n;if(t._bucket==null)throw UI();const i=new el(t,t._bucket);return e!=null?Bk(i,e):i}else return e!==void 0?O3(n,e):n}function U3(n,e){if(e&&B3(e)){if(n instanceof Jy)return V3(n,e);throw Ag("To use ref(service, url), the first argument must be a Storage instance.")}else return Bk(n,e)}function x2(n,e){const t=e?.[Nk];return t==null?null:Tr.makeFromBucketSpec(t,n)}function F3(n,e,t,i={}){n.host=`${e}:${t}`;const l=go(e);l&&(qg(`https://${n.host}/b`),Hg("Storage",!0)),n._isUsingEmulator=!0,n._protocol=l?"https":"http";const{mockUserToken:u}=i;u&&(n._overrideAuthToken=typeof u=="string"?u:ow(u,n.app.options.projectId))}class Jy{constructor(e,t,i,l,u,d=!1){this.app=e,this._authProvider=t,this._appCheckProvider=i,this._url=l,this._firebaseVersion=u,this._isUsingEmulator=d,this._bucket=null,this._host=Sk,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=CI,this._maxUploadRetryTime=RI,this._requests=new Set,l!=null?this._bucket=Tr.makeFromBucketSpec(l,this._host):this._bucket=x2(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Tr.makeFromBucketSpec(this._url,e):this._bucket=x2(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){Mg("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){Mg("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(Qr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new el(this,e)}_makeRequest(e,t,i,l,u=!0){if(this._deleted)return new $I(Ck());{const d=s3(e,this._appId,i,l,t,this._firebaseVersion,u,this._isUsingEmulator);return this._requests.add(d),d.getPromise().then(()=>this._requests.delete(d),()=>this._requests.delete(d)),d}}async makeRequestWithTokens(e,t){const[i,l]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,i,l).getPromise()}}const w2="@firebase/storage",_2="0.14.0";const Vk="storage";function Fp(n,e,t){return n=Zs(n),I3(n,e,t)}function k2(n){return n=Zs(n),D3(n)}function Wo(n){return n=Zs(n),L3(n)}function so(n,e){return n=Zs(n),U3(n,e)}function z3(n=Kg(),e){n=Zs(n);const i=em(n,Vk).getImmediate({identifier:e}),l=rw("storage");return l&&q3(i,...l),i}function q3(n,e,t,i={}){F3(n,e,t,i)}function H3(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),i=n.getProvider("auth-internal"),l=n.getProvider("app-check-internal");return new Jy(t,i,l,e,tl)}function $3(){Ko(new lo(Vk,H3,"PUBLIC").setMultipleInstances(!0)),Ua(w2,_2,""),Ua(w2,_2,"esm2020")}$3();const Uk={apiKey:"AIzaSyBCIgMJd3By7qkWH27YiW9VooIBGE3bFLs",authDomain:"mind-core-fitness-client.firebaseapp.com",projectId:"mind-core-fitness-client",storageBucket:"mind-core-fitness-client.firebasestorage.app",messagingSenderId:"669343392406",appId:"1:669343392406:web:f5a35ee062387e7d6f58b7"},Zy=Gg(Uk),Oo=Ww(Zy),me=gI(Zy),no=z3(Zy),W3=Gg(Uk,"secondary"),HP=Ww(W3),G3="EYdciKDOi3UYBLk1u8hHams5tmO2",Fk=v.createContext();function Vr(){return v.useContext(Fk)}function K3({children:n}){const[e,t]=v.useState(null),[i,l]=v.useState(!1),[u,d]=v.useState(!1),[p,g]=v.useState(null),[y,x]=v.useState(!0);v.useEffect(()=>{let Y=null;const ie=ZC(Oo,he=>{if(t(he),Y&&(Y(),Y=null),he)if(he.uid===G3)l(!0),d(!1),g(null),x(!1);else{l(!1);const Ne=Ps(Ft(me,"clients"),ps("uid","==",he.uid)),fe=async()=>{const R=localStorage.getItem("mcf_clientId");if(R)try{const E=await As($e(me,"clients",R));E.exists()&&(d(!0),g({id:E.id,...E.data()}))}catch(E){console.error("Direct client read failed:",E)}};Y=Tk(Ne,async R=>{if(R.empty)await fe();else{const E=R.docs[0];d(!0),g({id:E.id,...E.data()});try{localStorage.setItem("mcf_clientId",E.id)}catch{}}x(!1)},async R=>{console.error("Error listening to client data:",R),await fe(),x(!1)})}else l(!1),d(!1),g(null),x(!1)});return()=>{ie(),Y&&Y()}},[]);const te={currentUser:e,isAdmin:i,isClient:u,clientData:p,updateClientData:Y=>{g(ie=>ie?{...ie,...Y}:Y)},resolveClient:async()=>{if(p)return p;const Y=localStorage.getItem("mcf_clientId");if(Y)try{const ie=await As($e(me,"clients",Y));if(ie.exists()){const he={id:ie.id,...ie.data()};return d(!0),g(he),he}}catch(ie){console.error("resolveClient direct read failed:",ie)}if(e){const ie=Ps(Ft(me,"clients"),ps("uid","==",e.uid)),he=await Ss(ie);if(!he.empty){const Ne={id:he.docs[0].id,...he.docs[0].data()};return d(!0),g(Ne),Ne}}return null},login:async(Y,ie,he=!0)=>(await ix(Oo,he?mg:ty),await QC(Oo,Y,ie)),signup:async(Y,ie,he)=>{await ix(Oo,mg);const Ne=await YC(Oo,ie.trim().toLowerCase(),he),fe=Ne.user,R=$e(Ft(me,"clients")),E={uid:fe.uid,name:Y.trim(),email:ie.trim().toLowerCase(),clientType:"core_buddy",coreBuddyAccess:!0,status:"active",tier:"free",subscriptionStatus:null,signupSource:"self_signup",createdAt:kt.now()};await Ns(R,E),d(!0),g({id:R.id,...E});try{localStorage.setItem("mcf_clientId",R.id)}catch{}return Ne},logout:()=>{try{localStorage.removeItem("mcf_clientId")}catch{}return e4(Oo)},resetPassword:Y=>KC(Oo,Y),loading:y};return r.jsx(Fk.Provider,{value:te,children:n})}const zk=v.createContext();function Ra(){return v.useContext(zk)}function Y3({children:n}){const[e,t]=v.useState(()=>{const g=localStorage.getItem("theme");return g?g==="dark":window.matchMedia("(prefers-color-scheme: dark)").matches}),[i,l]=v.useState(()=>localStorage.getItem("accent")||"red");v.useEffect(()=>{document.documentElement.setAttribute("data-theme",e?"dark":"light"),localStorage.setItem("theme",e?"dark":"light")},[e]),v.useEffect(()=>{localStorage.setItem("accent",i)},[i]);const p={isDark:e,toggleTheme:()=>{document.documentElement.setAttribute("data-theme-transitioning",""),t(!e),setTimeout(()=>{document.documentElement.removeAttribute("data-theme-transitioning")},350)},accent:i,setAccent:g=>l(g)};return r.jsx(zk.Provider,{value:p,children:n})}const qk=v.createContext();function Gu(){return v.useContext(qk)}const Q3=["nutrition","personalBests","achievements","buddies","programmes"],X3=[5,10],J3=3,Z3=1;function eD({children:n}){const{clientData:e,loading:t}=Vr(),i=v.useMemo(()=>{const l=e?.tier||"free",u=e?.subscriptionStatus||null,d=e&&e.signupSource!=="self_signup",p=l==="premium"||!!d;function g(y){return p?!0:!Q3.includes(y)}return{tier:l,subscriptionStatus:u,isPremium:p,canAccess:g,loading:t,FREE_RANDOMISER_DURATIONS:X3,FREE_RANDOMISER_WEEKLY_LIMIT:J3,FREE_HABIT_LIMIT:Z3}},[e?.tier,e?.subscriptionStatus,e?.signupSource,t]);return r.jsx(qk.Provider,{value:i,children:n})}function tD(n){if(n?.signupSource==="self_signup"&&!n?.onboardingComplete)return"/onboarding";const e=n?.clientType;return e==="core_buddy"?"/client/core-buddy":e==="circuit_vip"||e==="circuit_dropin"?"/client/circuit":"/client"}function sD({className:n=""}){const{isDark:e,toggleTheme:t}=Ra();return r.jsx("button",{className:n||"theme-toggle",onClick:t,"aria-label":e?"Switch to light mode":"Switch to dark mode",children:e?r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20",children:r.jsx("path",{d:"M12 3a9 9 0 109 9c0-.46-.04-.92-.1-1.36a5.389 5.389 0 01-4.4 2.26 5.403 5.403 0 01-3.14-9.8c-.44-.06-.9-.1-1.36-.1z"})}):r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20",children:r.jsx("path",{d:"M12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zM2 13h2c.55 0 1-.45 1-1s-.45-1-1-1H2c-.55 0-1 .45-1 1s.45 1 1 1zm18 0h2c.55 0 1-.45 1-1s-.45-1-1-1h-2c-.55 0-1 .45-1 1s.45 1 1 1zM11 2v2c0 .55.45 1 1 1s1-.45 1-1V2c0-.55-.45-1-1-1s-1 .45-1 1zm0 18v2c0 .55.45 1 1 1s1-.45 1-1v-2c0-.55-.45-1-1-1s-1 .45-1 1zM5.99 4.58a.996.996 0 00-1.41 0 .996.996 0 000 1.41l1.06 1.06c.39.39 1.03.39 1.41 0s.39-1.03 0-1.41L5.99 4.58zm12.37 12.37a.996.996 0 00-1.41 0 .996.996 0 000 1.41l1.06 1.06c.39.39 1.03.39 1.41 0a.996.996 0 000-1.41l-1.06-1.06zm1.06-10.96a.996.996 0 000-1.41.996.996 0 00-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06zM7.05 18.36a.996.996 0 000-1.41.996.996 0 00-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06z"})})})}function nD(){const[n,e]=v.useState(""),[t,i]=v.useState(""),[l,u]=v.useState(!0),[d,p]=v.useState(""),[g,y]=v.useState(!1),[x,k]=v.useState(!1),[T,O]=v.useState(!1),{login:G,resetPassword:F,currentUser:V,isAdmin:te,isClient:Y,clientData:ie,loading:he}=Vr(),Ne=lr();if(v.useEffect(()=>{!he&&V&&(te?Ne("/dashboard"):Y?Ne(tD(ie)):(y(!1),p("No account found. Please sign up or contact your trainer.")))},[he,V,te,Y,ie,Ne]),he||V)return null;const fe=async E=>{E.preventDefault(),p(""),y(!0);try{await G(n,t,l)}catch(M){p(M.message||"Failed to log in"),y(!1)}},R=async E=>{if(E.preventDefault(),p(""),!n.trim()){p("Please enter your email address");return}y(!0);try{await F(n.trim()),O(!0)}catch(M){M.code==="auth/user-not-found"?p("No account found with this email"):p(M.message||"Failed to send reset email")}y(!1)};return r.jsxs("div",{className:"login-container",children:[r.jsx(sD,{className:"login-theme-toggle"}),r.jsxs("div",{className:"login-card",children:[r.jsxs("div",{className:"login-header",children:[r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"login-logo"}),r.jsx("p",{children:r.jsx("strong",{children:x?"Reset Password":"Sign in as 1-2-1 or a Core Buddy"})})]}),d&&r.jsx("div",{className:"error-message",children:d}),T?r.jsxs("div",{className:"reset-sent",children:[r.jsx("div",{className:"reset-sent-icon",children:r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M22 2L11 13",strokeLinecap:"round",strokeLinejoin:"round"}),r.jsx("path",{d:"M22 2L15 22L11 13L2 9L22 2Z",strokeLinecap:"round",strokeLinejoin:"round"})]})}),r.jsx("p",{children:"Reset email sent!"}),r.jsx("span",{children:"Check your inbox for a password reset link"}),r.jsx("button",{className:"login-btn",style:{marginTop:"20px"},onClick:()=>{k(!1),O(!1),p("")},children:"Back to Log In"})]}):x?r.jsxs("form",{onSubmit:R,children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"email",children:"Email"}),r.jsx("input",{type:"email",id:"email",value:n,onChange:E=>e(E.target.value),placeholder:"Enter your email",required:!0})]}),r.jsx("button",{type:"submit",className:"login-btn",disabled:g,children:g?"Sending...":"Send Reset Link"}),r.jsx("button",{type:"button",className:"forgot-link",onClick:()=>{k(!1),p("")},children:"Back to Log In"})]}):r.jsxs(r.Fragment,{children:[r.jsxs("form",{onSubmit:fe,children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"email",children:"Email"}),r.jsx("input",{type:"email",id:"email",value:n,onChange:E=>e(E.target.value),required:!0})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"password",children:"Password"}),r.jsx("input",{type:"password",id:"password",value:t,onChange:E=>i(E.target.value),required:!0})]}),r.jsx("div",{className:"remember-me",children:r.jsxs("label",{children:[r.jsx("input",{type:"checkbox",checked:l,onChange:E=>u(E.target.checked)}),r.jsx("span",{children:"Remember me"})]})}),r.jsx("button",{type:"submit",className:"login-btn",disabled:g,children:g?"Logging in...":"Log In"})]}),r.jsx("button",{type:"button",className:"forgot-link",onClick:()=>{k(!0),p("")},children:"Forgot password?"}),r.jsx("button",{type:"button",className:"login-btn login-btn-outline",onClick:()=>Ne("/signup"),children:"Don't have an account? Create one free"})]}),r.jsx("a",{href:"/",className:"back-link",children:"Back to website"})]})]})}function Pl({feature:n,children:e}){const{canAccess:t,loading:i}=Gu();return i||t(n)?e:r.jsx(K2,{to:"/upgrade",replace:!0})}function ha({active:n}){const e=lr(),{clientData:t}=Vr(),{isPremium:i}=Gu(),l=t?.clientType==="block"&&t?.coreBuddyAccess;return r.jsxs("nav",{className:"block-bottom-nav",children:[r.jsxs("button",{className:`block-nav-tab${n==="home"?" active":""}`,onClick:()=>e("/client/core-buddy"),children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),r.jsx("circle",{cx:"12",cy:"7",r:"4"})]}),r.jsx("span",{children:"Profile"})]}),r.jsxs("button",{className:`block-nav-tab${n==="workouts"?" active":""}`,onClick:()=>e("/client/core-buddy/workouts"),children:[r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"currentColor",stroke:"none",children:r.jsx("path",{d:"M1 9h2v6H1V9zm3-2h2v10H4V7zm3 4h10v2H7v-2zm10-4h2v10h-2V7zm3 2h2v6h-2V9z"})}),r.jsx("span",{children:"Workouts"})]}),r.jsxs("button",{className:`block-nav-tab${n==="nutrition"?" active":""}${i?"":" nav-locked"}`,onClick:()=>e(i?"/client/core-buddy/nutrition":"/upgrade"),children:[r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M18 8h1a4 4 0 0 1 0 8h-1M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z"})}),r.jsx("span",{children:"Nutrition"})]}),r.jsxs("button",{className:`block-nav-tab${n==="buddies"?" active":""}${i?"":" nav-locked"}`,onClick:()=>e(i?"/client/core-buddy/buddies":"/upgrade"),children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),r.jsx("circle",{cx:"9",cy:"7",r:"4"}),r.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),r.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),r.jsx("span",{children:"Buddies"})]}),l&&r.jsxs("button",{className:"block-nav-tab",onClick:()=>e("/client"),children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"3",width:"7",height:"7"}),r.jsx("rect",{x:"14",y:"3",width:"7",height:"7"}),r.jsx("rect",{x:"14",y:"14",width:"7",height:"7"}),r.jsx("rect",{x:"3",y:"14",width:"7",height:"7"})]}),r.jsx("span",{children:"Block"})]})]})}function Sa({children:n,onRefresh:e}){const[t,i]=v.useState(0),[l,u]=v.useState(!1),d=v.useRef(null),p=v.useRef(0),g=v.useRef(!1),y=v.useCallback(T=>{window.scrollY<=0&&(p.current=T.touches[0].clientY,g.current=!0)},[]),x=v.useCallback(T=>{if(!g.current||l)return;const O=T.touches[0].clientY-p.current;O>20&&window.scrollY<=0&&(T.preventDefault(),i(Math.min((O-20)*.35,80)))},[l]),k=v.useCallback(async()=>{t>55&&!l&&(u(!0),e?await e():window.location.reload(),u(!1)),i(0),g.current=!1},[t,l,e]);return r.jsxs("div",{ref:d,onTouchStart:y,onTouchMove:x,onTouchEnd:k,children:[r.jsxs("div",{className:`pull-refresh-indicator ${t>0?"visible":""} ${l?"refreshing":""}`,style:{height:t},children:[r.jsx("div",{className:`refresh-spinner ${l?"spinning":""}`,children:r.jsx("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:r.jsx("path",{fill:"currentColor",d:"M17.65 6.35A7.958 7.958 0 0012 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08A5.99 5.99 0 0112 18c-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"})})}),r.jsx("span",{className:"refresh-text",children:l?"Refreshing...":"Pull to refresh"})]}),n]})}function Ku(n,e,t,i,l){const u=[];for(let d=0;d<n;d++){const p=(d*(360/n)-90)*(Math.PI/180);u.push({x1:e+i*Math.cos(p),y1:t+i*Math.sin(p),x2:e+l*Math.cos(p),y2:t+l*Math.sin(p),thick:d%5===0})}return u}const eb=Ku(60,100,100,85,96),Hk=Ku(60,100,100,78,94),rD=Ku(60,100,100,82,94);Ku(60,50,50,38,46);const j2=Ku(60,40,40,30,37),aD="/login/assets/first_workout-B8SFkzJX.PNG",iD="/login/assets/workouts_10-Z5R3u0xH.PNG",oD="/login/assets/workouts_25-CzxSlcAj.PNG",lD="/login/assets/workouts_50-BpzWup3V.PNG",cD="/login/assets/workouts_100-D7_r6tn1.PNG",uD="/login/assets/streak_2-CsRr-XA9.PNG",dD="/login/assets/streak_4-BHO09tbw.PNG",hD="/login/assets/streak_8-DX2UWMko.PNG",mD="/login/assets/first_pb-aVf_CNWy.PNG",fD="/login/assets/pbs_5-Cippawgg.PNG",pD="/login/assets/pbs_10-CZgGh9Kv.PNG",gD="/login/assets/pbs_100-C67b1wfS.PNG",yD="/login/assets/nutrition_7-CHVV11fj.PNG",bD="/login/assets/leaderboard_join-BLoId4Hz.PNG",vD="/login/assets/habits_7-Dvki70KO.PNG",$n=[{id:"first_workout",img:aD,name:"First Rep",desc:"Complete your first workout",category:"workouts",threshold:1},{id:"workouts_10",img:iD,name:"On Fire",desc:"Complete 10 workouts",category:"workouts",threshold:10},{id:"workouts_25",img:oD,name:"Dedicated",desc:"Complete 25 workouts",category:"workouts",threshold:25},{id:"workouts_50",img:lD,name:"Unstoppable",desc:"Complete 50 workouts",category:"workouts",threshold:50},{id:"workouts_100",img:cD,name:"Century",desc:"Complete 100 workouts",category:"workouts",threshold:100},{id:"streak_2",img:uD,name:"2 Week Streak",desc:"Work out for 2 weeks in a row",category:"streaks",threshold:2},{id:"streak_4",img:dD,name:"Month Strong",desc:"Work out for 4 weeks in a row",category:"streaks",threshold:4},{id:"streak_8",img:hD,name:"Iron Will",desc:"Work out for 8 weeks in a row",category:"streaks",threshold:8},{id:"first_pb",img:mD,name:"First PB",desc:"Set your first personal best",category:"pbs",threshold:1},{id:"pbs_5",img:fD,name:"PB Hunter",desc:"Set 5 personal bests",category:"pbs",threshold:5},{id:"pbs_10",img:pD,name:"PB Machine",desc:"Set 10 personal bests",category:"pbs",threshold:10},{id:"pbs_100",img:gD,name:"PB Legend",desc:"Set 100 personal bests",category:"pbs",threshold:100},{id:"nutrition_7",img:yD,name:"Macro Master",desc:"Hit your macro targets 7 days in a row",category:"nutrition",threshold:7},{id:"leaderboard_join",img:bD,name:"Competitor",desc:"Join the leaderboard",category:"leaderboard",threshold:1},{id:"habits_7",img:vD,name:"Habit Streak",desc:"Complete your daily habits 7 days in a row",category:"habits",threshold:7}];function xD({steps:n,onFinish:e,active:t}){const[i,l]=v.useState(0),[u,d]=v.useState(null),[p,g]=v.useState("below"),[y,x]=v.useState(!1),k=v.useRef(null),T=v.useRef(t);T.current=t,v.useEffect(()=>{t||l(0)},[t]),v.useEffect(()=>{if(!t)return;const Ne=fe=>fe.preventDefault();return document.addEventListener("touchmove",Ne,{passive:!1}),document.addEventListener("wheel",Ne,{passive:!1}),document.body.style.overflow="hidden",()=>{document.removeEventListener("touchmove",Ne),document.removeEventListener("wheel",Ne),document.body.style.overflow=""}},[t]);const O=v.useMemo(()=>t?n.filter(Ne=>document.querySelector(Ne.selector)):[],[t]),G=O[i],F=i===O.length-1,V=G?.selector,te=v.useCallback(()=>{if(!V)return;const Ne=document.querySelector(V);if(!Ne){d(null);return}const fe=Ne.getBoundingClientRect(),R=8;d({top:fe.top-R,left:fe.left-R,width:fe.width+R*2,height:fe.height+R*2});const E=window.innerHeight-fe.bottom;g(E<260?"above":"below")},[V]);if(v.useEffect(()=>{if(!t||!V)return;x(!0);const Ne=document.querySelector(V);if(Ne){document.body.style.overflow="",Ne.scrollIntoView({behavior:"smooth",block:"center"});let fe=null,R=0,E=0;const M=60,B=()=>{E++;const I=Ne.getBoundingClientRect(),ze=Math.round(I.top);if(fe!==null&&ze===fe?R++:R=0,fe=ze,R>=3||E>=M){T.current&&(document.body.style.overflow="hidden"),te(),x(!1);return}D=requestAnimationFrame(B)};let D;const H=setTimeout(()=>{D=requestAnimationFrame(B)},120);return()=>{clearTimeout(H),D&&cancelAnimationFrame(D),T.current&&(document.body.style.overflow="hidden")}}},[t,i,V,te]),v.useEffect(()=>{if(!t)return;const Ne=()=>{k.current&&cancelAnimationFrame(k.current),k.current=requestAnimationFrame(te)};return window.addEventListener("scroll",Ne,!0),window.addEventListener("resize",Ne),()=>{window.removeEventListener("scroll",Ne,!0),window.removeEventListener("resize",Ne),k.current&&cancelAnimationFrame(k.current)}},[t,te]),!t||!G||O.length===0)return null;const Y=()=>{F?e():l(i+1)},ie=()=>{i>0&&l(i-1)},he=()=>e();return r.jsxs("div",{className:"st-overlay",onClick:Ne=>{Ne.stopPropagation()},children:[r.jsx("div",{className:"st-backdrop",onClick:Y}),u&&r.jsx("div",{className:`st-spotlight${y?" st-transitioning":""}`,style:{top:u.top,left:u.left,width:u.width,height:u.height}}),u&&r.jsxs("div",{className:`st-tooltip st-tooltip-${p}${y?" st-transitioning":""}`,style:{top:p==="below"?Math.min(Math.max(u.top+u.height+16,16),window.innerHeight-200):void 0,bottom:p==="above"?Math.min(Math.max(window.innerHeight-u.top+16,16),window.innerHeight-60):void 0,left:Math.max(16,Math.min(u.left,window.innerWidth-320))},children:[r.jsx("div",{className:"st-dots",children:O.map((Ne,fe)=>r.jsx("span",{className:`st-dot${fe===i?" active":""}${fe<i?" done":""}`},fe))}),r.jsx("h3",{className:"st-title",children:G.title}),r.jsx("p",{className:"st-body",children:G.body}),r.jsxs("div",{className:"st-actions",children:[i>0&&r.jsx("button",{className:"st-btn st-btn-back",onClick:ie,children:"Back"}),r.jsx("button",{className:"st-btn st-btn-next",onClick:Y,children:G.cta||(F?"Let's Go!":"Next")})]}),r.jsx("button",{className:"st-skip",onClick:he,children:"Skip tour"})]})]})}const zp=[10,25,50,100,200,500,1e3],wD=5;function Zc(n){return n.toISOString().split("T")[0]}function _D(n){let e=0;for(const t of zp){if(n<t)return{prev:e,next:t};e=t}return{prev:zp[zp.length-1],next:n+100}}const kD={fullbody_4wk:{duration:4,daysPerWeek:3},fullbody_8wk:{duration:8,daysPerWeek:3},fullbody_12wk:{duration:12,daysPerWeek:3},core_4wk:{duration:4,daysPerWeek:3},core_8wk:{duration:8,daysPerWeek:3},core_12wk:{duration:12,daysPerWeek:3},upper_4wk:{duration:4,daysPerWeek:3},lower_4wk:{duration:4,daysPerWeek:3}},jD={fullbody_4wk:["Push Focus","Pull Focus","Legs & Core"],fullbody_8wk:["Strength","Power","Endurance"],fullbody_12wk:["Upper Push","Lower Body","Upper Pull"],core_4wk:["Abs","Stability","Power Core"],core_8wk:["Anti-Extension","Rotation","Power"],core_12wk:["Strength","Endurance","Power"],upper_4wk:["Push","Pull","Mixed"],lower_4wk:["Quad Dominant","Hamstring & Glute","Power & Stability"]},qp=[{text:"You have 24 hours a day...",bold:"make it count"},{text:"Discipline beats motivation...",bold:"every single time"},{text:"Rest when you're done,",bold:"not when you're tired"},{text:"Small daily gains...",bold:"create massive results"},{text:"Your body keeps score,",bold:"train it well"},{text:"Consistency over intensity...",bold:"always wins"},{text:"The only bad workout...",bold:"is the one you skipped"}];function Hp(n){if(!n)return"";const e=n instanceof Date?n:n.toDate?n.toDate():new Date(n),t=Math.floor((new Date-e)/1e3);return t<60?"just now":t<3600?`${Math.floor(t/60)}m ago`:t<86400?`${Math.floor(t/3600)}h ago`:t<604800?`${Math.floor(t/86400)}d ago`:e.toLocaleDateString("en-GB",{day:"numeric",month:"short"})}function eu(n){if(!n)return"?";const e=n.trim().split(/\s+/);return e.length===1?e[0][0].toUpperCase():(e[0][0]+e[e.length-1][0]).toUpperCase()}function TD(n,e=800){return new Promise(t=>{const i=new Image;i.onload=()=>{const l=document.createElement("canvas");let u=i.width,d=i.height;u>d?u>e&&(d=Math.round(d*e/u),u=e):d>e&&(u=Math.round(u*e/d),d=e),l.width=u,l.height=d,l.getContext("2d").drawImage(i,0,0,u,d),l.toBlob(p=>t(p),"image/jpeg",.8)},i.src=URL.createObjectURL(n)})}function ED(){const{currentUser:n,isClient:e,clientData:t,logout:i,updateClientData:l,loading:u}=Vr(),{isDark:d,toggleTheme:p}=Ra(),{isPremium:g,FREE_HABIT_LIMIT:y}=Gu(),x=lr(),k=g?wD:y,[T,O]=v.useState({hours:0,minutes:0,seconds:0}),[G,F]=v.useState(0),[V,te]=v.useState(0),[Y,ie]=v.useState(""),[he,Ne]=v.useState(0),[fe,R]=v.useState(0),[E,M]=v.useState(!1),[B,D]=v.useState({protein:0,carbs:0,fats:0,calories:0}),[H,I]=v.useState(null),[ze,mt]=v.useState(0),[W,ue]=v.useState(null),[Re,Le]=v.useState(!1),[Z,L]=v.useState(!1),[ne,Ie]=v.useState(0),[de,qe]=v.useState(0),[Me,ot]=v.useState([]),[ft,Qe]=v.useState([]),[Vt,Ls]=v.useState(null),[jt,yt]=v.useState(!1),re=v.useRef(null),[Nt,vt]=v.useState([]),[Pt,Et]=v.useState(null),[ut,Ye]=v.useState(null),It=v.useRef(null),[Xt,Ks]=v.useState(0),[Ut,Mt]=v.useState(0),[is,Ms]=v.useState(0),[Kt,on]=v.useState(0),[ds,_s]=v.useState(null),Ct=v.useCallback((N,X="info")=>{_s({message:N,type:X}),setTimeout(()=>_s(null),4e3)},[]),[be,Te]=v.useState([]),[Be,Ue]=v.useState(!1),[J,ge]=v.useState(""),[We,Ke]=v.useState(null),[z,se]=v.useState(null),[Ge,He]=v.useState(!1),[Xe,lt]=v.useState(new Set),[_t,pt]=v.useState(new Set),[Wt,en]=v.useState({}),[ts,ks]=v.useState({}),[zs,$]=v.useState({}),[we,Se]=v.useState({}),[Ee,ke]=v.useState({}),[dt,bt]=v.useState({}),st=v.useRef(null),St=v.useRef(null),xt=v.useRef({}),[hs,Tn]=v.useState([]),[yn,Rn]=v.useState(!1),bn=v.useRef(null),[rn,qs]=v.useState([]),[j,C]=v.useState(""),[P,U]=v.useState(!1),[ye,Ve]=v.useState(null),[Oe,et]=v.useState([]),[nt,as]=v.useState(null),[Cs,ls]=v.useState(!1),cs=v.useRef(!1),Hs=(()=>{const N=[{selector:".cb-ring-container",title:"Your 24-Hour Countdown",body:"Every day resets. This ring tracks the time you have left  tap your photo to personalise your profile.",cta:"Next"},{selector:".cb-stats-row",title:"Progress at a Glance",body:"Programme completion, workouts this week, and daily habits  all in one row. These fill up as you go."},{selector:".cb-nudge-card",title:"Smart Suggestions",body:"We'll highlight what needs your attention  your next session, unfinished habits, or a meal to log."},{selector:".cb-card-workouts-hero",title:"Workouts",body:"Quick randomiser sessions or structured programmes  pick your focus, level and time.",cta:"Next"}];return g&&N.push({selector:".cb-card-nutrition",title:"Nutrition Tracking",body:"Set your macro targets, scan barcodes, and log meals to hit your daily goals."},{selector:".cb-card-consistency",title:"Daily Habits",body:"5 simple habits each day  train, hit protein, 10k steps, sleep, and hydrate. Build your streak."},{selector:".cb-card-buddies",title:"Buddies & Social",body:"Connect with other members, share your journey, and keep each other accountable."},{selector:".cb-journey-section",title:"Share Your Journey",body:"Post photos, updates, and milestones  your fitness journey in one place. Like and comment on each other's posts."},{selector:".cb-achievements-section",title:"Achievements",body:"Every rep counts towards badges  volume milestones, workout streaks, and more to unlock."}),N.push({selector:".block-bottom-nav",title:"You're All Set!",body:"Use the nav bar to jump between your profile, workouts, nutrition, and buddies. Time to get after it.",cta:"Let's Go!"}),N})();v.useEffect(()=>{!u&&!n&&x("/")},[u,n,x]),v.useEffect(()=>{!u&&t&&t.signupSource==="self_signup"&&!t.onboardingComplete&&x("/onboarding")},[u,t,x]),v.useEffect(()=>{let N=t?.tourComplete||cs.current;if(!N&&t?.id)try{N=!!localStorage.getItem(`tourDone_${t.id}`)}catch{}if(E&&t&&!N){const X=setTimeout(()=>ls(!0),600);return()=>clearTimeout(X)}},[E,t]),v.useEffect(()=>{if(t)try{const N=sessionStorage.getItem(`cbDash_${t.id}`);if(N){const X=JSON.parse(N);te(X.programmePct??0),ie(X.programmeName??""),Ne(X.totalWorkouts??0),R(X.habitWeekPct??0),D(X.nutritionTotals??{protein:0,carbs:0,fats:0,calories:0}),I(X.nutritionTargetData??null),mt(X.todayHabitsCount??0),ue(X.nextSession??null),Le(X.hasProgramme??!1),L(X.programmeComplete??!1),Ie(X.weeklyWorkouts??0),qe(X.pbCount??0),ot(X.topPBs??[]),Qe(X.leaderboardTop3??[]),vt(X.unlockedBadges??[]),It.current=X.unlockedBadges??[],Ks(X.streakWeeks??0),M(!0)}}catch{}},[t]),v.useEffect(()=>{t?.photoURL&&Ls(t.photoURL)},[t]),v.useEffect(()=>{if(!t)return;const N=Ps(Ft(me,"notifications"),ps("toId","==",t.id)),X=Tk(N,Fe=>{const it=Fe.docs.map(Tt=>({id:Tt.id,...Tt.data()}));it.sort((Tt,Bt)=>{const rt=Tt.createdAt?.toMillis?.()||0;return(Bt.createdAt?.toMillis?.()||0)-rt}),Tn(it.slice(0,50))},Fe=>{console.error("Notification listener error:",Fe),Fe.code==="permission-denied"&&console.warn("Firestore rules may be missing for the notifications collection. Please update your Firestore rules in the Firebase Console.")});return()=>X()},[t]),v.useEffect(()=>{const N=X=>{bn.current&&!bn.current.contains(X.target)&&Rn(!1)};return document.addEventListener("mousedown",N),()=>document.removeEventListener("mousedown",N)},[]),v.useEffect(()=>{if(!t)return;const N=t.id;(async()=>{try{const[X,Fe,it]=await Promise.all([Ss(Ps(Ft(me,"buddies"),ps("user1","==",N))),Ss(Ps(Ft(me,"buddies"),ps("user2","==",N))),Ss(Ft(me,"clients"))]),Tt=new Set;[...X.docs,...Fe.docs].forEach(rt=>{const Lt=rt.data();Tt.add(Lt.user1===N?Lt.user2:Lt.user1)});const Bt={};it.docs.forEach(rt=>{Bt[rt.id]=rt.data()}),qs(Array.from(Tt).filter(rt=>Bt[rt]).map(rt=>({id:rt,name:Bt[rt].name,photoURL:Bt[rt].photoURL||null})))}catch(X){console.error("Error loading buddies for mentions:",X)}})()},[t]);const fn=hs.filter(N=>!N.read).length,Ur=async()=>{const N=hs.filter(Fe=>!Fe.read);if(!N.length)return;const X=g2(me);N.forEach(Fe=>X.update($e(me,"notifications",Fe.id),{read:!0})),await X.commit()},gs=async()=>{if(!hs.length)return;const N=g2(me);hs.forEach(X=>N.delete($e(me,"notifications",X.id))),await N.commit()},Cr=async(N,X,Fe={})=>{if(!(!t||N===t.id))try{await ua(Ft(me,"notifications"),{toId:N,fromId:t.id,fromName:t.name||"Someone",fromPhotoURL:t.photoURL||null,type:X,read:!1,createdAt:yr(),...Fe})}catch(it){console.error("Notification create error:",it),it.code==="permission-denied"&&Ct("Notifications blocked  check Firestore rules","error")}},An=(N,X)=>{const Fe=X==="compose"?st.current?.selectionStart:null,Tt=(Fe!=null?N.slice(0,Fe):N).match(/@(\w*)$/);if(Tt){U(!0),Ve(X),C(Tt[1].toLowerCase());const Bt=rn.filter(rt=>rt.name&&rt.name.toLowerCase().includes(Tt[1].toLowerCase())).slice(0,5);et(Bt)}else U(!1),et([])},Q=(N,X)=>{if(X==="compose"){const Fe=st.current,it=J,Tt=Fe?.selectionStart??it.length,Bt=it.slice(0,Tt),rt=it.slice(Tt),Lt=Bt.replace(/@\w*$/,`@${N.name} `);ge(Lt+rt),setTimeout(()=>{Fe?.focus(),Fe.selectionStart=Fe.selectionEnd=Lt.length},0)}else{const it=(ts[X]||"").replace(/@\w*$/,`@${N.name} `);ks(Tt=>({...Tt,[X]:it}))}U(!1),et([])},ve=N=>N&&N.split(/(@\w[\w\s]*?\s)/g).map((Fe,it)=>Fe.startsWith("@")&&rn.some(Tt=>Fe.trim()===`@${Tt.name}`)?r.jsx("span",{className:"mention-highlight",children:Fe.trim()},it):Fe),_e=async N=>{const X=N.target.files?.[0];if(!(!X||!t)){if(!X.type.startsWith("image/")){Ct("Please select an image file","error");return}if(X.size>5*1024*1024){Ct("Image must be under 5MB","error");return}yt(!0);try{const Fe=await new Promise(Bt=>{const rt=new Image;rt.onload=()=>{const Lt=document.createElement("canvas"),Dt=400;let us=rt.width,os=rt.height;us>os?(os=os/us*Dt,us=Dt):(us=us/os*Dt,os=Dt),Lt.width=us,Lt.height=os,Lt.getContext("2d").drawImage(rt,0,0,us,os),Lt.toBlob(Ts=>Bt(Ts),"image/jpeg",.75)},rt.src=URL.createObjectURL(X)}),it=so(no,`profilePhotos/${t.id}`);await Fp(it,Fe);const Tt=await Wo(it);await Ba($e(me,"clients",t.id),{photoURL:Tt}),Ls(Tt),l({photoURL:Tt}),Ct("Profile photo updated!","success")}catch(Fe){console.error("Photo upload error:",Fe),Ct("Failed to upload photo","error")}yt(!1),re.current&&(re.current.value="")}};v.useEffect(()=>{const N=()=>{const Fe=new Date,it=new Date(Fe);it.setHours(23,59,59,999);const Tt=it-Fe,Bt=Math.floor(Tt/(1e3*60*60)),rt=Math.floor(Tt%(1e3*60*60)/(1e3*60)),Lt=Math.floor(Tt%(1e3*60)/1e3);O({hours:Bt,minutes:rt,seconds:Lt}),F(60-Lt)};N();const X=setInterval(N,1e3);return()=>clearInterval(X)},[]),v.useEffect(()=>{const N=setInterval(()=>{on(X=>(X+1)%qp.length)},8e3);return()=>clearInterval(N)},[]),v.useEffect(()=>{if(!n||!t)return;(async()=>{let X=null,Fe=0,it=[],Tt=!1,Bt=null;try{const rt=Zc(new Date),Lt=await As($e(me,"clientProgrammes",t.id));if(Lt.exists()){const er=Lt.data(),qn=kD[er.templateId];if(Le(!0),qn){const hr=er.completedSessions||{},Ar=Object.keys(hr).length,xo=qn.duration*qn.daysPerWeek;te(xo>0?Math.round(Ar/xo*100):0);const Zr=er.templateId.replace(/_/g," ").replace(/\b\w/g,ma=>ma.toUpperCase());ie(Zr);const rl=jD[er.templateId];let Ya=!1;for(let ma=1;ma<=qn.duration&&!Ya;ma++)for(let fa=0;fa<qn.daysPerWeek&&!Ya;fa++)hr[`w${ma}d${fa}`]||(ue({week:ma,dayIdx:fa,label:rl?.[fa]||`Day ${fa+1}`}),Ya=!0);Ya||(L(!0),Tt=!0)}}const Dt=Ft(me,"workoutLogs"),us=Ps(Dt,ps("clientId","==",t.id));X=await Ss(us),Ne(X.docs.length);const os=new Date,Ts=os.getDay(),zr=Ts===0?6:Ts-1,vr=new Date(os);vr.setDate(os.getDate()-zr),vr.setHours(0,0,0,0);const tn=vr.getTime(),$s=X.docs.filter(er=>{const qn=er.data().completedAt;return qn?(qn.toDate?qn.toDate().getTime():new Date(qn).getTime())>=tn:!1}).length;Ie($s);const Yn=Ft(me,"habitLogs"),Qn=Ps(Yn,ps("clientId","==",t.id),ps("date","==",rt)),Dn=await Ss(Qn);let xr=0;if(!Dn.empty){const er=Dn.docs[0].data().habits||{};xr=Math.min(Object.values(er).filter(Boolean).length,k)}R(Math.round(xr/k*100)),mt(xr);const Rr=await As($e(me,"nutritionTargets",t.id));Rr.exists()&&(I(Rr.data()),Bt=Rr.data());const Xn=await As($e(me,"nutritionLogs",`${t.id}_${rt}`));if(Xn.exists()){const qn=(Xn.data().entries||[]).reduce((hr,Ar)=>({protein:hr.protein+(Ar.protein||0),carbs:hr.carbs+(Ar.carbs||0),fats:hr.fats+(Ar.fats||0),calories:hr.calories+(Ar.calories||0)}),{protein:0,carbs:0,fats:0,calories:0});D(qn)}}catch(rt){console.error("Error loading dashboard stats:",rt)}try{let rt=[];const Lt=await As($e(me,"coreBuddyPBs",t.id));if(Lt.exists()){const Dt=Lt.data().exercises||{};qe(Object.keys(Dt).length),Fe=Object.keys(Dt).length,rt=Object.entries(Dt).sort(([,us],[,os])=>(os.weight||0)-(us.weight||0)).slice(0,3).map(([us,os])=>({name:us,weight:os.weight,reps:os.reps}))}it=rt,ot(rt)}catch(rt){console.error("PB fetch error:",rt)}try{const rt=Ft(me,"clients"),Lt=Ps(rt,ps("leaderboardOptIn","==",!0)),us=(await Ss(Lt)).docs.map(os=>({id:os.id,name:os.data().name,photoURL:os.data().photoURL||null}));Qe(us.slice(0,3))}catch(rt){console.error("Leaderboard preview error:",rt)}try{let rt=0;if(X){const tn=X.docs.map($s=>$s.data().date).filter(Boolean).sort().reverse();if(tn.length>0){const $s=new Date;let Yn=new Date($s);e:for(let Qn=0;Qn<52;Qn++){const Dn=new Date(Yn),xr=Dn.getDay(),Rr=xr===0?6:xr-1;Dn.setDate(Dn.getDate()-Rr),Dn.setHours(0,0,0,0);const Xn=new Date(Dn);Xn.setDate(Xn.getDate()+7);const er=Zc(Dn),qn=Zc(Xn);if(tn.some(Ar=>Ar>=er&&Ar<qn))rt++;else{if(Qn>0)break e;break}Yn.setDate(Yn.getDate()-7)}}}Ks(rt);let Lt=0;for(let tn=0;tn<30;tn++){const $s=new Date;$s.setDate($s.getDate()-tn);const Yn=Zc($s);try{const Qn=await Ss(Ps(Ft(me,"habitLogs"),ps("clientId","==",t.id),ps("date","==",Yn)));if(Qn.empty)break;{const Dn=Qn.docs[0].data().habits||{};if(Object.values(Dn).filter(Boolean).length>=k)Lt++;else break}}catch{break}}Mt(Lt);let Dt=0;for(let tn=0;tn<30;tn++){const $s=new Date;$s.setDate($s.getDate()-tn);const Yn=Zc($s);try{const Qn=await As($e(me,"nutritionLogs",`${t.id}_${Yn}`));if(Qn.exists()&&(Qn.data().entries||[]).length>0)if(Bt){const xr=(Qn.data().entries||[]).reduce((Rr,Xn)=>({protein:Rr.protein+(Xn.protein||0),carbs:Rr.carbs+(Xn.carbs||0),fats:Rr.fats+(Xn.fats||0)}),{protein:0,carbs:0,fats:0});if(xr.protein>=(Bt.protein||0)&&xr.carbs>=(Bt.carbs||0)&&xr.fats>=(Bt.fats||0))Dt++;else break}else Dt++;else break}catch{break}}Ms(Dt);const us=X?X.docs.length:0,os=[],Ts=tn=>os.push(tn);us>=1&&Ts("first_workout"),us>=10&&Ts("workouts_10"),us>=25&&Ts("workouts_25"),us>=50&&Ts("workouts_50"),us>=100&&Ts("workouts_100"),rt>=2&&Ts("streak_2"),rt>=4&&Ts("streak_4"),rt>=8&&Ts("streak_8"),Fe>=1&&Ts("first_pb"),Fe>=5&&Ts("pbs_5"),Fe>=10&&Ts("pbs_10"),Fe>=100&&Ts("pbs_100"),Dt>=7&&Ts("nutrition_7"),t.leaderboardOptIn&&Ts("leaderboard_join"),Lt>=7&&Ts("habits_7"),vt(os);const zr=It.current;if(zr!==null){const tn=os.filter($s=>!zr.includes($s));if(tn.length>0){const $s=$n.find(Yn=>Yn.id===tn[tn.length-1]);$s&&setTimeout(()=>Ye($s),600)}}It.current=os;const vr={};os.forEach(tn=>{vr[tn]={unlockedAt:new Date().toISOString()}}),Ns($e(me,"achievements",t.id),{badges:vr,progress:{streakWeeks:rt,pbCount:Fe,nutritionStreak:Dt,habitStreak:Lt},updatedAt:new Date().toISOString()},{merge:!0}).catch(()=>{})}catch(rt){console.error("Achievement computation error:",rt)}M(!0)})()},[n,t,k]),v.useEffect(()=>{if(!(!E||!t))try{sessionStorage.setItem(`cbDash_${t.id}`,JSON.stringify({programmePct:V,programmeName:Y,totalWorkouts:he,habitWeekPct:fe,nutritionTotals:B,nutritionTargetData:H,todayHabitsCount:ze,nextSession:W,hasProgramme:Re,programmeComplete:Z,weeklyWorkouts:ne,pbCount:de,topPBs:Me,leaderboardTop3:ft,unlockedBadges:Nt,streakWeeks:Xt}))}catch{}},[E,V,Y,he,fe,B,H,ze,W,Re,Z,ne,de,Me,ft,Nt,Xt,t]);const tt=v.useCallback(async()=>{if(cs.current=!0,ls(!1),l({tourComplete:!0}),t?.id){try{localStorage.setItem(`tourDone_${t.id}`,"1")}catch{}try{await Ba($e(me,"clients",t.id),{tourComplete:!0})}catch(N){console.error("Failed to save tour completion:",N)}}},[t,l]),Je=N=>{const X=N.currentTarget,Fe=X.querySelector(".ripple");Fe&&Fe.remove();const it=X.getBoundingClientRect(),Tt=Math.max(it.width,it.height),Bt=N.clientX-it.left-Tt/2,rt=N.clientY-it.top-Tt/2,Lt=document.createElement("span");Lt.className="ripple",Lt.style.cssText=`width:${Tt}px;height:${Tt}px;left:${Bt}px;top:${rt}px;`,X.appendChild(Lt),setTimeout(()=>Lt.remove(),600)},ct=t?.name?.split(" ")[0]||"there",{prev:Ht,next:$t}=_D(he),Yt=$t>Ht?Math.round((he-Ht)/($t-Ht)*100):100,Mn=[{label:"Programme",value:`${V}%`,pct:V,color:"#14b8a6",size:"normal"},{label:"Workouts",value:`${he}`,pct:Yt,color:"var(--color-primary)",size:"large"},{label:"Habits Today",value:`${fe}%`,pct:fe,color:"#38B6FF",size:"normal"}],Gt=N=>!H||!H[N]?0:Math.min(Math.round(B[N]/H[N]*100),100),Vs=(()=>{const N=new Date().getHours();return E&&ze>=k&&B.calories>0?{main:"Smashed it today,",sub:"Rest up and go again tomorrow."}:N>=5&&N<12?{main:"Rise and grind,",sub:"let's get after it!"}:N>=12&&N<17?{main:"Oye",sub:"crack on and make it count!"}:N>=17&&N<21?{main:"Evening session?",sub:"Let's finish strong!"}:{main:"Burning the midnight oil,",sub:"Respect the hustle!"}})(),Us=E?g&&Re&&W&&!Z?{label:"NEXT SESSION",message:`Week ${W.week}, Day ${W.dayIdx+1}  ${W.label}`,cta:"Continue",action:()=>x("/client/core-buddy/programmes"),pct:V,ringLabel:`${V}%`}:ze<k?{label:"DAILY HABITS",message:`${ze}/${k} completed`,cta:"Open Habits",action:()=>x("/client/core-buddy/consistency"),pct:fe,ringLabel:`${ze}/${k}`}:g&&B.calories===0?{label:"NUTRITION",message:"No meals logged today",cta:"Log Meal",action:()=>x("/client/core-buddy/nutrition"),pct:0,ringLabel:"0"}:g&&!Re?{label:"PROGRAMMES",message:"Start a programme to level up",cta:"Browse",action:()=>x("/client/core-buddy/workouts"),pct:0,ringLabel:""}:g&&Z?{label:"COMPLETE",message:"Programme finished!",cta:"New Programme",action:()=>x("/client/core-buddy/workouts"),pct:100,ringLabel:"100%"}:{label:"TODAY",message:"You're crushing it!",cta:null,action:null,pct:100,ringLabel:""}:null,In=v.useCallback(async()=>{if(t){Ue(!0);try{const N=await Ss(Ps(Ft(me,"posts"),ps("authorId","==",t.id),Kh("createdAt","desc"),Yh(30)));Te(N.docs.map(Fe=>({id:Fe.id,...Fe.data()})));const X=await Ss(Ps(Ft(me,"postLikes"),ps("userId","==",t.id)));lt(new Set(X.docs.map(Fe=>Fe.data().postId)))}catch(N){console.error("Error loading journey:",N)}finally{Ue(!1)}}},[t]);v.useEffect(()=>{E&&t&&In()},[E,t,In]);const Rs=N=>{const X=N.target.files?.[0];if(X){if(!X.type.startsWith("image/")){Ct("Please select an image file","error");return}if(X.size>10*1024*1024){Ct("Image must be under 10MB","error");return}Ke(X),se(URL.createObjectURL(X))}},Ys=()=>{Ke(null),z&&URL.revokeObjectURL(z),se(null),St.current&&(St.current.value="")},Jt=async()=>{if(!(!J.trim()&&!We||Ge||!t)){He(!0);try{let N=null;if(We){const it=await TD(We),Tt=`${Date.now()}_${Math.random().toString(36).slice(2,8)}`,Bt=so(no,`postImages/${t.id}/${Tt}`);await Fp(Bt,it),N=await Wo(Bt)}await ua(Ft(me,"posts"),{authorId:t.id,authorName:t.name||"Unknown",authorPhotoURL:t.photoURL||null,content:J.trim(),type:N?"image":"text",imageURL:N||null,createdAt:yr(),likeCount:0,commentCount:0});const Fe=J.trim().match(/@[\w\s]+?(?=\s@|\s*$|[.,!?])/g);if(Fe){const it=new Set;Fe.forEach(Tt=>{const Bt=Tt.slice(1).trim(),rt=rn.find(Lt=>Lt.name&&Lt.name.toLowerCase()===Bt.toLowerCase());rt&&!it.has(rt.id)&&(it.add(rt.id),Cr(rt.id,"mention",{}))})}ge(""),Ys(),st.current&&(st.current.style.height="auto"),await In(),Ct("Posted!","success")}catch(N){console.error("Error posting:",N),Ct(N?.message||"Failed to post","error")}finally{He(!1)}}},ln=async N=>{if(window.confirm("Delete this post?"))try{await jr($e(me,"posts",N)),Te(X=>X.filter(Fe=>Fe.id!==N)),Ct("Post deleted","info")}catch(X){console.error("Delete error:",X),Ct("Failed to delete","error")}},pn=async N=>{if(!t)return;const X=t.id,Fe=`${N}_${X}`,it=Xe.has(N),Tt=new Set(Xe);it?Tt.delete(N):Tt.add(N),lt(Tt),Te(Bt=>Bt.map(rt=>rt.id===N?{...rt,likeCount:Math.max(0,(rt.likeCount||0)+(it?-1:1))}:rt));try{if(it)await jr($e(me,"postLikes",Fe)),await Ba($e(me,"posts",N),{likeCount:zo(-1)});else{await Ns($e(me,"postLikes",Fe),{postId:N,userId:X,createdAt:yr()}),await Ba($e(me,"posts",N),{likeCount:zo(1)});const Bt=be.find(rt=>rt.id===N);Bt&&Cr(Bt.authorId,"like",{postId:N})}}catch(Bt){console.error("Like error:",Bt),In()}},zn=async N=>{try{const X=await Ss(Ps(Ft(me,"postComments"),ps("postId","==",N),Kh("createdAt","asc"),Yh(50)));en(Fe=>({...Fe,[N]:X.docs.map(it=>({id:it.id,...it.data()}))}))}catch(X){console.error("Error loading comments:",X)}},Gn=N=>{const X=new Set(_t);X.has(N)?X.delete(N):(X.add(N),Wt[N]||zn(N)),pt(X)},vn=async N=>{const X=(ts[N]||"").trim(),Fe=Ee[N];if(!(!X&&!Fe||!t)){$(it=>({...it,[N]:!0}));try{let it=null;if(Fe){const Dt=so(no,`comment-images/${Date.now()}_${Fe.name}`);await Fp(Dt,Fe),it=await Wo(Dt)}const Tt={postId:N,authorId:t.id,authorName:t.name||"Unknown",authorPhotoURL:t.photoURL||null,content:X||"",createdAt:yr()};it&&(Tt.imageURL=it);const Bt=we[N];Bt&&(Tt.replyToId=Bt.id,Tt.replyToName=Bt.authorName),await ua(Ft(me,"postComments"),Tt),await Ba($e(me,"posts",N),{commentCount:zo(1)});const rt=be.find(Dt=>Dt.id===N);rt&&Cr(rt.authorId,"comment",{postId:N});const Lt=X.match(/@[\w\s]+?(?=\s@|\s*$|[.,!?])/g);if(Lt){const Dt=new Set;Lt.forEach(us=>{const os=us.slice(1).trim(),Ts=rn.find(zr=>zr.name&&zr.name.toLowerCase()===os.toLowerCase());Ts&&!Dt.has(Ts.id)&&(Dt.add(Ts.id),Cr(Ts.id,"mention",{postId:N}))})}ks(Dt=>({...Dt,[N]:""})),ke(Dt=>({...Dt,[N]:null})),bt(Dt=>({...Dt,[N]:null})),Se(Dt=>({...Dt,[N]:null})),xt.current[N]&&(xt.current[N].value=""),Te(Dt=>Dt.map(us=>us.id===N?{...us,commentCount:(us.commentCount||0)+1}:us)),await zn(N)}catch(it){console.error("Comment error:",it),Ct("Failed to comment","error")}finally{$(it=>({...it,[N]:!1}))}}},Kn=async(N,X)=>{try{await jr($e(me,"postComments",X)),await Ba($e(me,"posts",N),{commentCount:zo(-1)}),en(Fe=>({...Fe,[N]:(Fe[N]||[]).filter(it=>it.id!==X)})),Te(Fe=>Fe.map(it=>it.id===N?{...it,commentCount:Math.max((it.commentCount||1)-1,0)}:it))}catch(Fe){console.error("Delete comment error:",Fe),Ct("Failed to delete comment","error")}},cr=(N,X)=>{const Fe=X.target.files?.[0];if(!Fe)return;if(Fe.size>5*1024*1024){Ct("Image must be under 5MB","error");return}ke(Tt=>({...Tt,[N]:Fe}));const it=new FileReader;it.onload=Tt=>bt(Bt=>({...Bt,[N]:Tt.target.result})),it.readAsDataURL(Fe)},ur=N=>{ke(X=>({...X,[N]:null})),bt(X=>({...X,[N]:null})),xt.current[N]&&(xt.current[N].value="")},dr=N=>{ge(N.target.value),N.target.style.height="auto",N.target.style.height=Math.min(N.target.scrollHeight,120)+"px",An(N.target.value,"compose")},Fr=(N,X)=>{ks(Fe=>({...Fe,[N]:X})),An(X,N)};return r.jsx(Sa,{children:r.jsxs("div",{className:"cb-dashboard","data-theme":d?"dark":"light",children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsxs("div",{className:"header-notif-wrap",ref:bn,children:[r.jsxs("button",{className:"header-notif-btn",onClick:()=>{Rn(!yn),yn||Ur()},"aria-label":"Notifications",children:[r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"}),r.jsx("path",{d:"M13.73 21a2 2 0 0 1-3.46 0"})]}),fn>0&&r.jsx("span",{className:"header-notif-badge",children:fn>9?"9+":fn})]}),yn&&r.jsxs("div",{className:"notif-panel",children:[r.jsxs("div",{className:"notif-panel-header",children:[r.jsx("span",{className:"notif-panel-title",children:"Notifications"}),hs.length>0&&r.jsx("button",{className:"notif-clear-btn",onClick:gs,children:"Clear all"})]}),r.jsx("div",{className:"notif-panel-list",children:hs.length===0?r.jsx("div",{className:"notif-empty",children:"No notifications yet"}):hs.map(N=>r.jsxs("div",{className:`notif-item${N.read?"":" unread"}`,onClick:()=>{if(Rn(!1),N.type==="buddy_request"||N.type==="buddy_accept")x(g?"/client/core-buddy/buddies":"/upgrade");else if((N.type==="like"||N.type==="comment")&&N.postId){if(!_t.has(N.postId)){const X=new Set(_t);X.add(N.postId),pt(X),Wt[N.postId]||zn(N.postId)}setTimeout(()=>{const X=document.getElementById(`post-${N.postId}`);X&&X.scrollIntoView({behavior:"smooth",block:"center"})},150)}else N.type==="like"||N.type==="comment"?document.querySelector(".cb-journey-section")?.scrollIntoView({behavior:"smooth"}):N.type==="mention"&&x(`/client/core-buddy/profile/${N.fromId}`)},children:[r.jsx("div",{className:"notif-item-avatar",children:N.fromPhotoURL?r.jsx("img",{src:N.fromPhotoURL,alt:""}):r.jsx("span",{children:(N.fromName||"?")[0]})}),r.jsxs("div",{className:"notif-item-body",children:[r.jsxs("p",{className:"notif-item-text",children:[r.jsx("strong",{children:N.fromName})," ",N.type==="buddy_request"&&"sent you a buddy request",N.type==="buddy_accept"&&"accepted your buddy request",N.type==="like"&&"liked your post",N.type==="comment"&&"commented on your post",N.type==="mention"&&"mentioned you"]}),r.jsx("span",{className:"notif-item-time",children:Hp(N.createdAt)})]})]},N.id))})]})]}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsxs("div",{className:"header-actions",children:[r.jsx("button",{onClick:p,"aria-label":"Toggle theme",children:d?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})}),r.jsx("button",{onClick:i,"aria-label":"Log out",children:r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),r.jsx("polyline",{points:"16 17 21 12 16 7"}),r.jsx("line",{x1:"21",y1:"12",x2:"9",y2:"12"})]})})]})]})}),r.jsxs("main",{className:"cb-main",children:[r.jsxs("div",{className:"cb-ring-container",children:[r.jsxs("div",{className:"cb-ring",children:[r.jsx("svg",{className:"cb-ring-svg",viewBox:"0 0 200 200",children:eb.map((N,X)=>{const Fe=X<G;return r.jsx("line",{x1:N.x1,y1:N.y1,x2:N.x2,y2:N.y2,className:`ring-tick ${Fe?"elapsed":"remaining"}`,strokeWidth:N.thick?"3":"2"},X)})}),r.jsxs("div",{className:"cb-ring-center",children:[r.jsxs("div",{className:"cb-ring-logo",onClick:()=>re.current?.click(),role:"button",tabIndex:0,"aria-label":"Change profile photo",children:[r.jsx("img",{src:Vt||"/Logo.webp",alt:Vt?"Profile":"Mind Core Fitness"}),r.jsx("div",{className:`cb-photo-overlay${jt?" uploading":""}`,children:jt?r.jsx("div",{className:"cb-photo-spinner"}):r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"#fff",strokeWidth:"2",children:[r.jsx("path",{d:"M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"}),r.jsx("circle",{cx:"12",cy:"13",r:"4"})]})}),r.jsx("input",{ref:re,type:"file",accept:"image/*",onChange:_e,style:{display:"none"}})]}),!Vt&&!jt&&r.jsx("div",{className:"cb-photo-badge",onClick:()=>re.current?.click(),children:r.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"#fff",strokeWidth:"2.5",children:[r.jsx("path",{d:"M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"}),r.jsx("circle",{cx:"12",cy:"13",r:"4"})]})})]})]}),r.jsxs("div",{className:"cb-ring-countdown",children:[r.jsx("span",{className:"cb-timer-digit",children:String(T.hours).padStart(2,"0")}),r.jsx("span",{className:"cb-timer-colon",children:":"}),r.jsx("span",{className:"cb-timer-digit",children:String(T.minutes).padStart(2,"0")}),r.jsx("span",{className:"cb-timer-colon",children:":"}),r.jsx("span",{className:"cb-timer-digit cb-timer-seconds",children:String(T.seconds).padStart(2,"0")})]}),r.jsx("span",{className:"cb-ring-label",children:"remaining today"}),r.jsxs("p",{className:"cb-ring-tagline",children:[qp[Kt].text," ",r.jsx("strong",{children:qp[Kt].bold})]},Kt)]}),r.jsx("div",{className:"cb-stats-row",children:Mn.map(N=>{const X=(N.size==="large",38),Fe=2*Math.PI*X,it=Fe-N.pct/100*Fe;return r.jsxs("div",{className:`cb-stat-item${N.size==="large"?" cb-stat-large":""}`,children:[r.jsxs("div",{className:"cb-stat-ring",children:[r.jsxs("svg",{viewBox:"0 0 100 100",children:[r.jsx("circle",{className:"cb-stat-track",cx:"50",cy:"50",r:X}),r.jsx("circle",{className:"cb-stat-fill",cx:"50",cy:"50",r:X,style:{stroke:N.color},strokeDasharray:Fe,strokeDashoffset:it})]}),r.jsx("span",{className:"cb-stat-value",style:{color:N.color},children:N.value})]}),r.jsx("span",{className:"cb-stat-label",children:N.label})]},N.label)})}),r.jsxs("p",{className:"cb-coach-msg",children:[Vs.main," ",r.jsx("strong",{children:ct}),"  ",Vs.sub]}),Us&&r.jsxs("button",{className:"cb-nudge-card",onClick:Us.action||void 0,style:Us.action?void 0:{cursor:"default"},children:[r.jsxs("div",{className:"cb-nudge-ring",children:[r.jsxs("svg",{viewBox:"0 0 100 100",children:[r.jsx("circle",{className:"cb-nudge-ring-track",cx:"50",cy:"50",r:"38"}),r.jsx("circle",{className:"cb-nudge-ring-fill",cx:"50",cy:"50",r:"38",strokeDasharray:2*Math.PI*38,strokeDashoffset:2*Math.PI*38-Us.pct/100*2*Math.PI*38})]}),r.jsx("span",{className:"cb-nudge-ring-val",children:Us.ringLabel})]}),r.jsxs("div",{className:"cb-nudge-info",children:[r.jsx("span",{className:"cb-nudge-label",children:Us.label}),r.jsx("span",{className:"cb-nudge-title",children:Us.message}),Us.cta&&r.jsxs("span",{className:"cb-nudge-cta",children:[Us.cta," "]})]})]}),r.jsxs("div",{className:"cb-features",children:[t?.buddyEnabled&&r.jsxs("button",{className:"cb-feature-card cb-card-buddy ripple-btn",onClick:N=>{Je(N),x("/client/core-buddy/buddy")},children:[r.jsx("div",{className:"cb-buddy-icon",children:r.jsxs("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M12 2a4 4 0 0 1 4 4v2a4 4 0 0 1-8 0V6a4 4 0 0 1 4-4z"}),r.jsx("path",{d:"M18 14c2 1 3 3 3 5v2H3v-2c0-2 1-4 3-5"}),r.jsx("circle",{cx:"9",cy:"7",r:"0.5",fill:"currentColor"}),r.jsx("circle",{cx:"15",cy:"7",r:"0.5",fill:"currentColor"}),r.jsx("path",{d:"M9.5 10a2.5 2.5 0 0 0 5 0"}),r.jsx("path",{d:"M7 13c1.5 1 3.5 1.5 5 1.5s3.5-.5 5-1.5"})]})}),r.jsxs("div",{className:"cb-card-content",children:[r.jsxs("h3",{children:["Buddy ",r.jsx("span",{className:"cb-buddy-badge",children:"AI"})]}),r.jsx("p",{className:"cb-card-desc",children:"Your AI training partner"})]}),r.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})]}),r.jsxs("button",{className:`cb-feature-card cb-card-nutrition cb-card-has-preview ripple-btn${g?"":" cb-card-locked"}`,onClick:N=>{Je(N),x(g?"/client/core-buddy/nutrition":"/upgrade")},children:[r.jsxs("div",{className:"cb-card-top-row",children:[r.jsx("div",{className:"cb-card-content",children:r.jsxs("h3",{children:["Today's Nutrition ",!g&&r.jsx("span",{className:"cb-premium-badge",children:"PREMIUM"})]})}),r.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})]}),g&&r.jsx("div",{className:"cb-card-preview-row",children:r.jsx("div",{className:"cb-mini-rings",children:[{label:"P",pct:Gt("protein"),color:"#14b8a6"},{label:"C",pct:Gt("carbs"),color:"var(--color-primary)"},{label:"F",pct:Gt("fats"),color:"#eab308"},{label:"Cal",pct:Gt("calories"),color:"#38B6FF"}].map(N=>{const Fe=2*Math.PI*38,it=Fe-N.pct/100*Fe;return r.jsxs("div",{className:"cb-mini-ring",children:[r.jsxs("svg",{viewBox:"0 0 100 100",children:[r.jsx("circle",{className:"cb-mini-track",cx:"50",cy:"50",r:38}),r.jsx("circle",{className:"cb-mini-fill",cx:"50",cy:"50",r:38,style:{stroke:N.color},strokeDasharray:Fe,strokeDashoffset:it})]}),r.jsx("span",{style:{color:N.color},children:N.label})]},N.label)})})}),r.jsx("p",{className:"cb-card-desc",children:"Track macros, scan barcodes, log water"})]}),r.jsxs("button",{className:"cb-feature-card cb-card-workouts-hero ripple-btn",onClick:N=>{Je(N),x("/client/core-buddy/workouts")},children:[r.jsx("h3",{className:"cb-hero-title",children:"Workouts"}),r.jsxs("div",{className:"cb-hero-stats",children:[r.jsxs("span",{children:[ne," this week"]}),r.jsx("span",{className:"cb-hero-dot",children:""}),r.jsxs("span",{children:[he," total"]})]}),r.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})]}),r.jsxs("div",{className:"cb-grid-row",children:[r.jsxs("button",{className:"cb-feature-card cb-grid-card cb-card-consistency ripple-btn",onClick:N=>{Je(N),x("/client/core-buddy/consistency")},children:[r.jsxs("div",{className:"cb-card-content",children:[r.jsx("h3",{children:"Habits"}),r.jsx("div",{className:"cb-habit-dots",children:Array.from({length:k},(N,X)=>r.jsx("span",{className:`cb-habit-dot${X<ze?" done":""}`},X))}),r.jsxs("span",{className:"cb-habit-dots-label",children:[ze,"/",k," today"]})]}),r.jsx("svg",{className:"cb-card-arrow cb-grid-arrow",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})]}),r.jsxs("button",{className:`cb-feature-card cb-grid-card cb-card-progress ripple-btn${g?"":" cb-card-locked"}`,onClick:N=>{Je(N),x(g?"/client/personal-bests?mode=corebuddy":"/upgrade")},children:[r.jsxs("div",{className:"cb-card-content",children:[r.jsxs("h3",{children:["PBs ",!g&&r.jsx("span",{className:"cb-premium-badge",children:"PREMIUM"})]}),Me.length>0?r.jsx("div",{className:"cb-pb-preview",children:Me.slice(0,2).map(N=>r.jsxs("div",{className:"cb-pb-entry",children:[r.jsx("span",{className:"cb-pb-name",children:N.name}),r.jsxs("span",{className:"cb-pb-value",children:[N.weight,"kg"]})]},N.name))}):r.jsxs("div",{className:"cb-progress-preview",children:[r.jsx("svg",{className:"cb-progress-icon",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M13 2L3 14h9l-1 8 10-12h-9l1-8z"})}),r.jsx("span",{children:"Start lifting!"})]})]}),r.jsx("svg",{className:"cb-card-arrow cb-grid-arrow",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})]})]}),r.jsxs("button",{className:"cb-feature-card cb-card-leaderboard ripple-btn",onClick:N=>{Je(N),x("/client/leaderboard")},children:[r.jsxs("div",{className:"cb-card-content",children:[r.jsx("h3",{children:"Leaderboard"}),ft.length>0?r.jsx("div",{className:"cb-lb-preview",children:ft.map((N,X)=>{const Fe=["#FFD700","#A8B4C0","#CD7F32"][X],it=N.name?N.name.split(" ").map(Bt=>Bt[0]).join("").slice(0,2).toUpperCase():"?",Tt=N.id===t?.id;return r.jsxs("div",{className:`cb-lb-entry${Tt?" cb-lb-me":""}`,children:[r.jsx("div",{className:"cb-lb-avatar",style:{borderColor:Fe},children:N.photoURL?r.jsx("img",{src:N.photoURL,alt:"",className:"cb-lb-avatar-img"}):r.jsx("span",{children:it})}),r.jsxs("span",{className:"cb-lb-rank",style:{color:Fe},children:["#",X+1]})]},N.id)})}):r.jsx("p",{children:"Opt in to compete with your Core Buddies"})]}),r.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})]}),r.jsxs("button",{className:`cb-feature-card cb-card-buddies ripple-btn${g?"":" cb-card-locked"}`,onClick:N=>{Je(N),x(g?"/client/core-buddy/buddies":"/upgrade")},children:[r.jsxs("div",{className:"cb-card-content",children:[r.jsxs("h3",{children:["Buddies ",!g&&r.jsx("span",{className:"cb-premium-badge",children:"PREMIUM"})]}),r.jsx("p",{children:"Connect with other members and track each other's progress"})]}),r.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})]}),r.jsxs("div",{className:`cb-achievements-section${g?"":" cb-card-locked"}`,children:[r.jsxs("h3",{className:"cb-achievements-title",children:["Achievements ",!g&&r.jsx("span",{className:"cb-premium-badge",children:"PREMIUM"})]}),g?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"cb-badges-scroll",children:$n.map(N=>{const X=Nt.includes(N.id);return r.jsx("button",{className:`cb-badge${X?" unlocked":" locked"}`,onClick:()=>Et(N),children:r.jsx("img",{src:N.img,alt:N.name,className:"cb-badge-img"})},N.id)})}),r.jsxs("p",{className:"cb-badges-count",children:[Nt.length,"/",$n.length," unlocked"]})]}):r.jsxs("button",{className:"cb-upgrade-teaser",onClick:()=>x("/upgrade"),children:[r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),r.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}),r.jsx("span",{children:"Upgrade to unlock achievements"})]})]}),r.jsxs("div",{className:"cb-journey-section",children:[r.jsxs("h3",{className:"cb-journey-title",children:["My Journey ",!g&&r.jsx("span",{className:"cb-premium-badge",children:"PREMIUM"})]}),g?r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"journey-compose",children:[r.jsx("div",{className:"journey-compose-avatar",children:Vt?r.jsx("img",{src:Vt,alt:""}):r.jsx("span",{children:eu(t?.name)})}),r.jsxs("div",{className:"journey-compose-body",style:{position:"relative"},children:[r.jsx("textarea",{ref:st,placeholder:"Share your progress... (use @ to mention)",value:J,onChange:dr,rows:1,maxLength:500}),P&&ye==="compose"&&Oe.length>0&&r.jsx("div",{className:"mention-dropdown",children:Oe.map(N=>r.jsxs("button",{className:"mention-option",onClick:()=>Q(N,"compose"),children:[r.jsx("div",{className:"mention-option-avatar",children:N.photoURL?r.jsx("img",{src:N.photoURL,alt:""}):r.jsx("span",{children:eu(N.name)})}),r.jsx("span",{children:N.name})]},N.id))}),z&&r.jsxs("div",{className:"journey-image-preview",children:[r.jsx("img",{src:z,alt:"Preview"}),r.jsx("button",{className:"journey-image-remove",onClick:Ys,"aria-label":"Remove image",children:r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",children:[r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})})]}),r.jsxs("div",{className:"journey-compose-actions",children:[r.jsx("button",{className:"journey-image-btn",onClick:()=>St.current?.click(),"aria-label":"Add image",children:r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),r.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),r.jsx("path",{d:"M21 15l-5-5L5 21"})]})}),r.jsx("input",{ref:St,type:"file",accept:"image/*",onChange:Rs,hidden:!0}),(J.trim()||We)&&r.jsx("button",{className:"journey-post-btn",onClick:Jt,disabled:Ge,children:Ge?r.jsx("div",{className:"journey-btn-spinner"}):"Post"})]})]})]}),Be?r.jsx("div",{className:"journey-loading",children:r.jsx("div",{className:"cb-spinner"})}):be.length===0?r.jsxs("div",{className:"journey-empty",children:[r.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),r.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),r.jsx("path",{d:"M21 15l-5-5L5 21"})]}),r.jsx("p",{children:"Start sharing your fitness journey!"})]}):r.jsx("div",{className:"journey-list",children:be.map(N=>r.jsxs("div",{id:`post-${N.id}`,className:"journey-post",children:[r.jsxs("div",{className:"journey-post-header",children:[r.jsx("div",{className:"journey-post-avatar",children:N.authorPhotoURL?r.jsx("img",{src:N.authorPhotoURL,alt:""}):r.jsx("span",{children:eu(N.authorName)})}),r.jsxs("div",{className:"journey-post-meta",children:[r.jsx("span",{className:"journey-post-name",children:N.authorName}),r.jsx("span",{className:"journey-post-time",children:Hp(N.createdAt)})]}),r.jsx("button",{className:"journey-delete-btn",onClick:()=>ln(N.id),"aria-label":"Delete post",children:r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M3 6h18"}),r.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),r.jsx("path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]}),N.type==="workout_summary"&&N.metadata?r.jsxs("div",{className:"journey-card",children:[r.jsx("div",{className:"journey-card-logo-frame",children:r.jsx("img",{src:"/Logo.webp",alt:"MCF",className:"journey-card-logo-img"})}),r.jsx("h3",{className:"journey-card-title",children:N.metadata.title}),N.metadata.stats?.length>0&&r.jsx("p",{className:"journey-card-stats-line",children:N.metadata.stats.map(X=>`${X.value} ${X.label}`).join("    ")}),!N.metadata.stats?.length&&N.metadata.subtitle&&r.jsx("p",{className:"journey-card-stats-line",children:N.metadata.subtitle}),r.jsx("p",{className:"journey-card-cta",children:"I just completed a workout using Core Buddy "}),r.jsx("p",{className:"journey-card-slogan",children:"Make It Count with Core Buddy"})]}):N.type==="badge_earned"&&N.metadata?r.jsxs("div",{className:"journey-card",children:[r.jsx("div",{className:"journey-card-logo-frame journey-card-logo-badge",children:r.jsx("img",{src:($n.find(X=>X.name===N.metadata.title)||$n.find(X=>N.metadata.badges?.includes(X.name)))?.img||"/Logo.webp",alt:N.metadata.title,className:"journey-card-logo-img"})}),r.jsx("h3",{className:"journey-card-title",children:N.metadata.title}),(N.metadata.badgeDesc||($n.find(X=>X.name===N.metadata.title)||$n.find(X=>N.metadata.badges?.includes(X.name)))?.desc)&&r.jsx("p",{className:"journey-card-stats-line",children:N.metadata.badgeDesc||($n.find(X=>X.name===N.metadata.title)||$n.find(X=>N.metadata.badges?.includes(X.name)))?.desc}),r.jsx("p",{className:"journey-card-cta",children:"I just earned a badge on Core Buddy "}),r.jsx("p",{className:"journey-card-slogan",children:"Make It Count with Core Buddy"})]}):N.type==="habits_summary"&&N.metadata?r.jsxs("div",{className:"journey-card",children:[r.jsx("div",{className:"journey-card-logo-frame",children:r.jsx("img",{src:"/Logo.webp",alt:"MCF",className:"journey-card-logo-img"})}),r.jsx("h3",{className:"journey-card-title",children:N.metadata.title}),N.metadata.stats?.length>0&&r.jsx("p",{className:"journey-card-stats-line",children:N.metadata.stats.map(X=>`${X.value} ${X.label}`).join("    ")}),N.metadata.subtitle&&r.jsx("p",{className:"journey-card-stats-line",children:N.metadata.subtitle}),r.jsx("p",{className:"journey-card-cta",children:"I just completed my daily habits with Core Buddy "}),r.jsx("p",{className:"journey-card-slogan",children:"Make It Count with Core Buddy"})]}):r.jsxs(r.Fragment,{children:[N.content&&r.jsx("p",{className:"journey-post-content",children:ve(N.content)}),N.imageURL&&r.jsx("div",{className:"journey-post-image",children:r.jsx("img",{src:N.imageURL,alt:"Post",loading:"lazy"})})]}),r.jsxs("div",{className:"journey-post-actions",children:[r.jsxs("button",{className:`journey-action-btn${Xe.has(N.id)?" liked":""}`,onClick:()=>pn(N.id),children:[r.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:Xe.has(N.id)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})}),r.jsx("span",{children:N.likeCount||0})]}),r.jsxs("button",{className:`journey-action-btn${_t.has(N.id)?" active":""}`,onClick:()=>Gn(N.id),children:[r.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})}),r.jsx("span",{children:N.commentCount||0})]})]}),_t.has(N.id)&&r.jsxs("div",{className:"journey-comments",children:[Wt[N.id]?.length>0?Wt[N.id].map(X=>r.jsxs("div",{className:"journey-comment",children:[r.jsx("div",{className:"journey-comment-avatar",children:X.authorPhotoURL?r.jsx("img",{src:X.authorPhotoURL,alt:""}):r.jsx("span",{children:eu(X.authorName)})}),r.jsxs("div",{className:"journey-comment-body",children:[r.jsxs("div",{className:"journey-comment-bubble",children:[r.jsx("span",{className:"journey-comment-name",children:X.authorName}),X.replyToName&&r.jsxs("span",{className:"journey-comment-reply-tag",children:[r.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("polyline",{points:"9 14 4 9 9 4"}),r.jsx("path",{d:"M20 20v-7a4 4 0 0 0-4-4H4"})]}),X.replyToName]}),X.content&&r.jsx("span",{className:"journey-comment-text",children:ve(X.content)}),X.imageURL&&r.jsx("img",{className:"journey-comment-image",src:X.imageURL,alt:"Comment",loading:"lazy"})]}),r.jsxs("div",{className:"journey-comment-actions-row",children:[r.jsx("span",{className:"journey-comment-time",children:Hp(X.createdAt)}),r.jsx("button",{className:"journey-comment-reply-btn",onClick:()=>Se(Fe=>({...Fe,[N.id]:{id:X.id,authorName:X.authorName}})),children:"Reply"}),r.jsx("button",{className:"journey-comment-delete-btn",onClick:()=>Kn(N.id,X.id),"aria-label":"Delete comment",children:r.jsxs("svg",{width:"13",height:"13",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M3 6h18"}),r.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),r.jsx("path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]})]})]},X.id)):r.jsx("p",{className:"journey-no-comments",children:"No comments yet"}),we[N.id]&&r.jsxs("div",{className:"journey-comment-replying",children:[r.jsxs("span",{children:["Replying to ",r.jsx("strong",{children:we[N.id].authorName})]}),r.jsx("button",{onClick:()=>Se(X=>({...X,[N.id]:null})),"aria-label":"Cancel reply",children:r.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",children:[r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})})]}),dt[N.id]&&r.jsxs("div",{className:"journey-comment-img-preview",children:[r.jsx("img",{src:dt[N.id],alt:"Preview"}),r.jsx("button",{onClick:()=>ur(N.id),"aria-label":"Remove image",children:r.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",children:[r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})})]}),r.jsxs("div",{className:"journey-comment-input",style:{position:"relative"},children:[r.jsx("button",{className:"journey-comment-img-btn",onClick:()=>xt.current[N.id]?.click(),"aria-label":"Add image",children:r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),r.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),r.jsx("path",{d:"M21 15l-5-5L5 21"})]})}),r.jsx("input",{ref:X=>{xt.current[N.id]=X},type:"file",accept:"image/*",onChange:X=>cr(N.id,X),hidden:!0}),r.jsx("input",{type:"text",placeholder:"Comment",value:ts[N.id]||"",onChange:X=>Fr(N.id,X.target.value),onKeyDown:X=>{X.key==="Enter"&&vn(N.id)},maxLength:300}),P&&ye===N.id&&Oe.length>0&&r.jsx("div",{className:"mention-dropdown mention-dropdown-up",children:Oe.map(X=>r.jsxs("button",{className:"mention-option",onClick:()=>Q(X,N.id),children:[r.jsx("div",{className:"mention-option-avatar",children:X.photoURL?r.jsx("img",{src:X.photoURL,alt:""}):r.jsx("span",{children:eu(X.name)})}),r.jsx("span",{children:X.name})]},X.id))}),r.jsx("button",{onClick:()=>vn(N.id),disabled:!(ts[N.id]||"").trim()&&!Ee[N.id]||zs[N.id],children:zs[N.id]?r.jsx("div",{className:"journey-btn-spinner-sm"}):r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"22",y1:"2",x2:"11",y2:"13"}),r.jsx("polygon",{points:"22 2 15 22 11 13 2 9 22 2"})]})})]})]})]},N.id))})]}):r.jsxs("button",{className:"cb-upgrade-teaser",onClick:()=>x("/upgrade"),children:[r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),r.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}),r.jsx("span",{children:"Upgrade to share your journey"})]})]})]})]}),Pt&&r.jsx("div",{className:"cb-badge-overlay",onClick:()=>Et(null),children:r.jsxs("div",{className:"cb-badge-overlay-content",onClick:N=>N.stopPropagation(),children:[r.jsx("img",{src:Pt.img,alt:Pt.name,className:`cb-badge-overlay-img${Nt.includes(Pt.id)?"":" cb-badge-overlay-img-locked"}`}),Nt.includes(Pt.id)?r.jsx("span",{className:"cb-badge-status unlocked",children:"Unlocked"}):r.jsx("span",{className:"cb-badge-status locked",children:"Locked"}),r.jsx("button",{className:"cb-badge-overlay-close",onClick:()=>Et(null),children:"Tap to close"})]})}),r.jsx(ha,{active:"home"}),ds&&r.jsxs("div",{className:`toast-notification ${ds.type}`,children:[ds.type==="info"&&r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("line",{x1:"12",y1:"16",x2:"12",y2:"12"}),r.jsx("line",{x1:"12",y1:"8",x2:"12.01",y2:"8"})]}),ds.message]}),r.jsx(xD,{steps:Hs,active:Cs,onFinish:tt}),ut&&r.jsxs("div",{className:"cb-celebration-overlay",onClick:()=>Ye(null),children:[r.jsx("div",{className:"cb-confetti-container",children:Array.from({length:30},(N,X)=>r.jsx("span",{className:"cb-confetti-piece",style:{"--angle":`${Math.random()*360}deg`,"--distance":`${80+Math.random()*120}px`,"--delay":`${Math.random()*.3}s`,"--color":["#FFD700","#FF6B6B","#4ECDC4","#45B7D1","#F7DC6F","#BB8FCE","#FF8C42","#38B6FF"][X%8],"--size":`${6+Math.random()*6}px`,"--drift":`${(Math.random()-.5)*60}px`}},X))}),r.jsxs("div",{className:"cb-celebration-content",onClick:N=>N.stopPropagation(),children:[r.jsx("div",{className:"cb-celebration-glow"}),r.jsx("img",{src:ut.img,alt:ut.name,className:"cb-celebration-badge-img"}),r.jsx("h2",{className:"cb-celebration-title",children:"Badge Unlocked!"}),r.jsx("p",{className:"cb-celebration-name",children:ut.name}),r.jsx("button",{className:"cb-celebration-dismiss",onClick:()=>Ye(null),children:"Tap to continue"})]})]})]})})}const $p=new Map;function Yi(){return new Date().toISOString().split("T")[0]}const T2=[{key:"breakfast",label:"Breakfast"},{key:"lunch",label:"Lunch"},{key:"dinner",label:"Dinner"},{key:"snacks",label:"Snacks"}],SD={breakfast:r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M18 8h1a4 4 0 0 1 0 8h-1"}),r.jsx("path",{d:"M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z"}),r.jsx("line",{x1:"6",y1:"1",x2:"6",y2:"4"}),r.jsx("line",{x1:"10",y1:"1",x2:"10",y2:"4"}),r.jsx("line",{x1:"14",y1:"1",x2:"14",y2:"4"})]}),lunch:r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}),dinner:r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})}),snacks:r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})})};function ND(){const n=new Date().getHours();return n<11?"breakfast":n<14?"lunch":n<17?"snacks":"dinner"}function CD(){const{currentUser:n,isClient:e,clientData:t,loading:i}=Vr(),{isDark:l,toggleTheme:u,accent:d}=Ra(),p=lr(),[g,y]=v.useState("loading"),[x,k]=v.useState(null),[T,O]=v.useState({gender:"male",age:"",weight:"",weightUnit:"kg",height:"",heightUnit:"cm",heightFeet:"",heightInches:"",dailyActivity:"sedentary",trainingFrequency:"moderate",goal:"maintain",deficitLevel:"moderate"}),[G,F]=v.useState(null),[V,te]=v.useState(Yi()),[Y,ie]=v.useState({entries:[],water:0}),[he,Ne]=v.useState({protein:0,carbs:0,fats:0,calories:0}),[fe,R]=v.useState(!1),[E,M]=v.useState(!1),[B,D]=v.useState(()=>{const j=new Date;return{year:j.getFullYear(),month:j.getMonth()}}),[H,I]=v.useState(ND),[ze,mt]=v.useState(null),[W,ue]=v.useState(null),[Re,Le]=v.useState(!1),[Z,L]=v.useState(null),[ne,Ie]=v.useState(""),[de,qe]=v.useState(!1),[Me,ot]=v.useState(""),[ft,Qe]=v.useState([]),[Vt,Ls]=v.useState(!1),[jt,yt]=v.useState({name:"",protein:"",carbs:"",fats:"",calories:"",serving:""}),[re,Nt]=v.useState(null),[vt,Pt]=v.useState("100"),[Et,ut]=v.useState(0),[Ye,It]=v.useState("weight"),[Xt,Ks]=v.useState(0),[Ut,Mt]=v.useState(null);v.useRef(null);const is=v.useRef(!1),Ms=v.useRef(null),Kt=v.useRef(null),on=v.useRef(null),ds=v.useCallback((j,C="info")=>{Mt({message:j,type:C}),setTimeout(()=>Mt(null),3e3)},[]);v.useEffect(()=>{!i&&(!n||!e)&&p("/")},[n,e,i,p]),v.useEffect(()=>{if(!t?.id)return;(async()=>{try{const C=await As($e(me,"nutritionTargets",t.id));C.exists()?(k(C.data()),y("dashboard")):y("setup")}catch(C){console.error("Error loading nutrition data:",C),y("setup")}})()},[t?.id]),v.useEffect(()=>{if(!t?.id)return;(async()=>{try{const C=await As($e(me,"nutritionLogs",`${t.id}_${V}`));if(C.exists()){const P=C.data();ie({entries:P.entries||[],water:P.water||0})}else ie({entries:[],water:0})}catch(C){console.error("Error loading log:",C),ie({entries:[],water:0})}})()},[t?.id,V]),v.useEffect(()=>{const j=Y.entries.reduce((C,P)=>({protein:C.protein+(P.protein||0),carbs:C.carbs+(P.carbs||0),fats:C.fats+(P.fats||0),calories:C.calories+(P.calories||0)}),{protein:0,carbs:0,fats:0,calories:0});Ne(j)},[Y.entries]);const _s=async j=>{try{await Ns($e(me,"nutritionLogs",`${t.id}_${V}`),{clientId:t.id,date:V,entries:j.entries,water:j.water,updatedAt:kt.now()})}catch(C){console.error("Error saving nutrition log:",C)}},Ct=V===Yi(),be=(j,C)=>new Date(j,C+1,0).getDate(),Te=(j,C)=>new Date(j,C,1).getDay(),Be=["January","February","March","April","May","June","July","August","September","October","November","December"],Ue=["Su","Mo","Tu","We","Th","Fr","Sa"],J=()=>{let j=parseFloat(T.weight);T.weightUnit==="lbs"&&(j*=.453592);let C;T.heightUnit==="cm"?C=parseFloat(T.height):C=(parseFloat(T.heightFeet)||0)*30.48+(parseFloat(T.heightInches)||0)*2.54;const P=parseInt(T.age);let U=T.gender==="male"?10*j+6.25*C-5*P+5:10*j+6.25*C-5*P-161;const Ve=U*{sedentary:1.2,light:1.3,moderate:1.4,active:1.5}[T.dailyActivity],Oe={low:100,moderate:200,high:300,daily:400},et=Math.round(Ve+Oe[T.trainingFrequency]);let nt=et,as,Cs;switch(T.goal){case"lose":nt=et*(1-{light:.15,moderate:.2,harsh:.25}[T.deficitLevel]),as=2.2,Cs=.3;break;case"build":nt=et*1.1,as=2,Cs=.22;break;default:as=1.8,Cs=.25}nt=Math.max(nt,T.gender==="male"?1400:1100);const ls=Math.round(j*as),cs=Math.round(nt*Cs/9),Hs=Math.max(0,Math.round((nt-ls*4-cs*9)/4));F({calories:Math.round(nt),protein:ls,carbs:Hs,fats:cs,bmr:Math.round(U),neat:Math.round(Ve),exerciseAdd:Oe[T.trainingFrequency],tdee:Math.round(et)})},ge=async()=>{if(G)try{const j={clientId:t.id,calories:G.calories,protein:G.protein,carbs:G.carbs,fats:G.fats,waterGoal:8,goal:T.goal,updatedAt:kt.now()};await Ns($e(me,"nutritionTargets",t.id),j),k(j),y("dashboard"),ds("Macro targets saved!","success")}catch(j){console.error("Error saving targets:",j),ds("Failed to save targets. Please try again.","error")}},We=()=>{const j=T.weight&&parseFloat(T.weight)>0,C=T.age&&parseInt(T.age)>0,P=T.heightUnit==="cm"?T.height&&parseFloat(T.height)>0:T.heightFeet&&parseFloat(T.heightFeet)>0||T.heightInches&&parseFloat(T.heightInches)>0;return j&&C&&P},Ke="nut_favourite_foods",z=()=>{try{return JSON.parse(localStorage.getItem(Ke)||"[]")}catch{return[]}},se=j=>z().some(C=>C.name.toLowerCase()===(j||"").toLowerCase()),Ge=j=>{const C=z(),P=C.findIndex(U=>U.name.toLowerCase()===j.name.toLowerCase());P>=0?C.splice(P,1):C.unshift({name:j.name,protein:j.protein,carbs:j.carbs,fats:j.fats,calories:j.calories,serving:j.serving,per100g:j.per100g||null,servingUnit:j.servingUnit||"g",portion:j.portion||null}),localStorage.setItem(Ke,JSON.stringify(C)),Ks(U=>U+1)},He=j=>{const C=[...Y.entries,{...j,meal:H,id:Date.now(),addedAt:new Date().toISOString()}],P={...Y,entries:C};ie(P),_s(P),ue(null),Nt(null),Pt("100"),ut(0),It("weight"),yt({name:"",protein:"",carbs:"",fats:"",calories:"",serving:""}),ds("Food added!","success")},Xe=j=>{const C=Y.entries.filter(U=>U.id!==j),P={...Y,entries:C};ie(P),_s(P)},lt=v.useRef(null),_t=async()=>{Le(!0);const j=document.querySelector("#barcode-reader");if(!j){Le(!1),ds("Scanner container not found.","error");return}if(!lt.current)try{const P=await Nr(()=>import("./quagga.min-BbicSfvA.js").then(U=>U.q),[]);lt.current=P.default}catch(P){console.error("Failed to load barcode scanner:",P),Le(!1),ds("Could not load scanner.","error");return}const C=lt.current;C.init({inputStream:{type:"LiveStream",target:j,constraints:{facingMode:"environment",width:{min:640,ideal:1280,max:1920},height:{min:480,ideal:720,max:1080}}},locator:{patchSize:"medium",halfSample:!0},numOfWorkers:navigator.hardwareConcurrency||2,decoder:{readers:["ean_reader","ean_8_reader","upc_reader","upc_e_reader","code_128_reader","code_39_reader"]},locate:!0},P=>{if(P){console.error("Quagga init error:",P),Le(!1),ds("Could not access camera. Check permissions.","error");return}C.start(),is.current=!0}),C.onDetected(P=>{const U=P.codeResult.decodedCodes?.filter(Ve=>Ve.error!==void 0)?.map(Ve=>Ve.error)||[];if((U.length>0?U.reduce((Ve,Oe)=>Ve+Oe,0)/U.length:1)<.15){const Ve=P.codeResult.code;C.offDetected(),L(Ve)}})},pt=()=>{const j=lt.current;is.current&&j&&(j.stop(),j.offDetected(),is.current=!1),Le(!1)},Wt=/\b(milk|semi.skimmed|skimmed|whole milk|oat milk|almond milk|soy milk|juice|smoothie|water|squash|cordial|cola|pepsi|fanta|lemonade|soda|beer|wine|cider|lager|spirit|whisky|vodka|rum|gin|brandy|cream|yoghurt drink|milkshake|coffee|tea|broth|stock|soup|sauce|ketchup|vinegar|oil|syrup|honey|custard|coconut water|kombucha|energy drink|protein shake)\b/i,en=j=>/ml|cl|\dl(?!b)|litre|liter|fl\s?oz/i.test((j||"").replace(/\s/g,"")),ts=j=>{if(!j)return{value:100,unit:"g"};const C=j.toLowerCase().replace(/\s/g,""),P=C.match(/([\d.]+)/),U=P?parseFloat(P[1]):100;return en(j)?/cl/.test(C)?{value:U*10,unit:"ml"}:/(?:^|\d)l(?!i)/.test(C)&&!/ml/.test(C)?{value:U*1e3,unit:"ml"}:{value:U,unit:"ml"}:{value:U,unit:"g"}},ks=j=>{if(en(j.serving_size)||en(j.quantity))return"ml";const C=j.product_name||j.product_name_en||"";return Wt.test(C)?"ml":"g"},zs=[{pattern:/\b(toast|bread|loaf|brioche|bagel|pitta|wrap|tortilla|crumpet|muffin|waffle|pancake)\b/i,label:"slice",weight:36},{pattern:/\begg\b/i,label:"egg",weight:60},{pattern:/\b(biscuit|cookie|digestive|hobnob|rich tea|oreo)\b/i,label:"biscuit",weight:13},{pattern:/\b(sausage|banger)\b/i,label:"sausage",weight:57},{pattern:/\b(rasher|bacon)\b/i,label:"rasher",weight:25},{pattern:/\b(rice cake)\b/i,label:"cake",weight:9},{pattern:/\b(cracker|ryvita)\b/i,label:"cracker",weight:10}],$=(j,C)=>{const P=j||"",U=P.match(/\((\d+\.?\d*)\s*g\)/i),ye=P.match(/(?:^|per\s+)(\d*\s*[a-z][a-z\s]*?)(?:\s*\(|\s*-\s*|\s*$)/i);if(U&&ye){const et=parseFloat(U[1]);let nt=ye[1].replace(/^\d+\s*/,"").trim();if(nt&&et>0)return{label:nt,weight:et}}const Ve=P.match(/(\d+\.?\d*)\s*g\s*[\/=]\s*(\d*\s*[a-z][a-z\s]*)/i);if(Ve){const et=parseFloat(Ve[1]);let nt=Ve[2].replace(/^\d+\s*/,"").trim();if(nt&&et>0)return{label:nt,weight:et}}const Oe=C||"";for(const{pattern:et,label:nt,weight:as}of zs)if(et.test(Oe))return{label:nt,weight:as};return null},we=j=>{const C=j.nutriments||{},P=ks(j),U=ts(j.serving_size),ye=P==="ml"?U.unit==="ml"?U.value:100:U.value,Ve=j.product_name||j.product_name_en||"Unknown Product",Oe=$(j.serving_size,Ve);return{name:Ve,brand:j.brands||"",image:j.image_small_url||j.image_url||null,servingSize:j.serving_size||"100g",servingValue:ye,servingUnit:P,portion:Oe,protein:Math.round(C.proteins_100g||C.proteins||0),carbs:Math.round(C.carbohydrates_100g||C.carbohydrates||0),fats:Math.round(C.fat_100g||C.fat||0),calories:Math.round(C["energy-kcal_100g"]||C["energy-kcal"]||(C.energy_100g?C.energy_100g/4.184:0)),per100g:!0}},Se=async j=>{qe(!0);try{const C=`https://world.openfoodfacts.org/api/v2/product/${j}?fields=product_name,product_name_en,brands,image_small_url,image_url,serving_size,quantity,nutriments`,P=await fetch(C);if(!P.ok)throw new Error(`HTTP ${P.status}`);const U=await P.json();if(U.status==="success"||U.status===1||U.product){const ye=we(U.product);ye.calories===0&&ye.protein===0&&ye.carbs===0?ds("Product found but no nutrition data available.","error"):(Nt(ye),ye.portion?(ut(1),Pt(String(ye.portion.weight)),It("portion")):(ut(0),Pt(String(ye.servingValue||100)),It("weight")),Ie(""))}else ds("Product not found. Try search or manual entry.","error")}catch(C){console.error("Barcode lookup error:",C),ds("Failed to look up product. Check your connection.","error")}qe(!1)},Ee=(j,C,P)=>{const U=j.toLowerCase().trim(),ye=C.toLowerCase().trim(),Ve=P.toLowerCase().trim();let Oe=0;return(U===Ve||U===Ve+"s"||U+"s"===Ve)&&(Oe+=100),(U.endsWith(" "+Ve)||U.endsWith(" "+Ve+"s"))&&(Oe+=40),(U.startsWith(Ve+" ")||U.startsWith(Ve+"s "))&&(Oe+=15),Ve.split(/\s+/).some(nt=>ye===nt||ye.startsWith(nt))&&(Oe+=30),Oe+=Math.max(0,30-U.length),Oe},ke=async()=>{if(!Me.trim())return;Ms.current&&Ms.current.abort();const j=new AbortController;Ms.current=j;const C=Me.trim().toLowerCase(),P=C.split(/\s+/).filter(Boolean);if($p.has(C)){Qe($p.get(C));return}Ls(!0);try{const ye=`https://world.openfoodfacts.org/cgi/search.pl?search_terms=${encodeURIComponent(Me.trim())}&search_simple=1&action=process&json=1&page_size=10&lc=en&sort_by=unique_scans_n&fields=product_name,product_name_en,brands,image_small_url,image_url,serving_size,quantity,nutriments`,Ve=await fetch(ye,{signal:j.signal});if(!Ve.ok)throw new Error(`HTTP ${Ve.status}`);const et=((await Ve.json()).products||[]).map(nt=>we(nt)).filter(nt=>nt.name!=="Unknown Product"&&(nt.calories>0||nt.protein>0)).filter(nt=>{const as=(nt.name+" "+nt.brand).toLowerCase();return P.every(Cs=>as.includes(Cs))}).sort((nt,as)=>Ee(as.name,as.brand,C)-Ee(nt.name,nt.brand,C)).slice(0,10);$p.set(C,et),Qe(et),et.length===0&&ds("No results found. Try a different search.","info")}catch(U){if(U.name==="AbortError")return;console.error("Search error:",U),ds("Search failed. Check your connection.","error")}Ls(!1)};v.useEffect(()=>{if(Kt.current&&clearTimeout(Kt.current),!(!Me.trim()||W!=="search"||re))return Kt.current=setTimeout(()=>{ke()},700),()=>clearTimeout(Kt.current)},[Me]);const dt=()=>{const j={...Y,water:Y.water+1};ie(j),_s(j)},bt=()=>{if(Y.water<=0)return;const j={...Y,water:Y.water-1};ie(j),_s(j)},st={"ring-protein":"#14b8a6","ring-carbs":"var(--color-primary)","ring-fats":"#eab308","ring-cals":"rgba(150,150,150,0.55)"},St=80,xt=2*Math.PI*St,hs=(j,C,P,U,ye)=>{const Ve=U>0?Math.min(100,Math.round(P/U*100)):0,Oe=xt-Ve/100*xt,et=st[ye]||"#14b8a6";return r.jsxs("div",{className:"nut-ring-wrap",children:[r.jsxs("svg",{className:"nut-ring-svg",viewBox:"0 0 200 200",children:[r.jsx("circle",{className:"nut-arc-track",cx:"100",cy:"100",r:St}),r.jsx("circle",{className:"nut-arc-fill",cx:"100",cy:"100",r:St,style:{stroke:et},strokeDasharray:xt,strokeDashoffset:Oe})]}),r.jsxs("div",{className:"nut-ring-center",children:[r.jsx("span",{className:"nut-ring-value",style:{color:et},children:Math.round(P)}),r.jsxs("span",{className:"nut-ring-target",children:["/ ",U,j==="Calories"?"":"g"]}),r.jsx("span",{className:"nut-ring-label",style:{color:et},children:C})]}),r.jsxs("span",{className:"nut-ring-pct",style:{color:et},children:[Ve,"%"]})]})};if(v.useEffect(()=>{if(!Z)return;const j=setTimeout(()=>{const C=Z;pt(),L(null),Se(C)},1500);return()=>clearTimeout(j)},[Z]),v.useEffect(()=>()=>{const j=lt.current;if(is.current&&j){try{j.stop(),j.offDetected()}catch{}is.current=!1}},[]),i||g==="loading")return r.jsxs("div",{className:"nut-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>p("/client/core-buddy"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})]})}),r.jsx("div",{className:"nut-loading-inline",children:r.jsx("div",{className:"cb-loading-spinner"})})]});if(g==="setup")return r.jsxs("div",{className:"nut-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>p("/client/core-buddy"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),r.jsxs("main",{className:"nut-main",children:[r.jsxs("div",{className:"nut-setup-intro",children:[r.jsx("h2",{children:"Set Your Daily Targets"}),r.jsx("p",{children:"Calculate your personalised macros based on your body and goals."})]}),r.jsxs("div",{className:"nut-calc-form",children:[r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Gender"}),r.jsxs("div",{className:"nut-toggle-group",children:[r.jsx("button",{className:T.gender==="male"?"active":"",onClick:()=>{O(j=>({...j,gender:"male"})),F(null)},children:"Male"}),r.jsx("button",{className:T.gender==="female"?"active":"",onClick:()=>{O(j=>({...j,gender:"female"})),F(null)},children:"Female"})]})]}),r.jsxs("div",{className:"nut-form-row",children:[r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Age"}),r.jsx("input",{type:"number",value:T.age,onChange:j=>{O(C=>({...C,age:j.target.value})),F(null)},placeholder:"Years",min:"15",max:"100"})]}),r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Weight"}),r.jsxs("div",{className:"nut-input-unit",children:[r.jsx("input",{type:"number",value:T.weight,onChange:j=>{O(C=>({...C,weight:j.target.value})),F(null)},placeholder:T.weightUnit,min:"30",max:"300"}),r.jsxs("div",{className:"nut-unit-toggle",children:[r.jsx("button",{className:T.weightUnit==="kg"?"active":"",onClick:()=>{O(j=>({...j,weightUnit:"kg"})),F(null)},children:"kg"}),r.jsx("button",{className:T.weightUnit==="lbs"?"active":"",onClick:()=>{O(j=>({...j,weightUnit:"lbs"})),F(null)},children:"lbs"})]})]})]})]}),r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Height"}),r.jsxs("div",{className:"nut-input-unit",children:[T.heightUnit==="cm"?r.jsx("input",{type:"number",value:T.height,onChange:j=>{O(C=>({...C,height:j.target.value})),F(null)},placeholder:"cm",min:"100",max:"250"}):r.jsxs("div",{className:"nut-height-imperial",children:[r.jsx("input",{type:"number",value:T.heightFeet,onChange:j=>{O(C=>({...C,heightFeet:j.target.value})),F(null)},placeholder:"ft",min:"4",max:"7"}),r.jsx("input",{type:"number",value:T.heightInches,onChange:j=>{O(C=>({...C,heightInches:j.target.value})),F(null)},placeholder:"in",min:"0",max:"11"})]}),r.jsxs("div",{className:"nut-unit-toggle",children:[r.jsx("button",{className:T.heightUnit==="cm"?"active":"",onClick:()=>{O(j=>({...j,heightUnit:"cm"})),F(null)},children:"cm"}),r.jsx("button",{className:T.heightUnit==="ft"?"active":"",onClick:()=>{O(j=>({...j,heightUnit:"ft"})),F(null)},children:"ft/in"})]})]})]}),r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Daily Activity (outside of training)"}),r.jsxs("select",{value:T.dailyActivity,onChange:j=>{O(C=>({...C,dailyActivity:j.target.value})),F(null)},children:[r.jsx("option",{value:"sedentary",children:"Sedentary  desk job, under 5k steps"}),r.jsx("option",{value:"light",children:"Lightly Active  office + walking, 5-8k steps"}),r.jsx("option",{value:"moderate",children:"Moderately Active  on feet often, 8-12k steps"}),r.jsx("option",{value:"active",children:"Very Active  physical job, 12k+ steps"})]})]}),r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Training Sessions per Week"}),r.jsxs("select",{value:T.trainingFrequency,onChange:j=>{O(C=>({...C,trainingFrequency:j.target.value})),F(null)},children:[r.jsx("option",{value:"low",children:"1-2 sessions"}),r.jsx("option",{value:"moderate",children:"3-4 sessions"}),r.jsx("option",{value:"high",children:"5-6 sessions"}),r.jsx("option",{value:"daily",children:"7+ sessions"})]})]}),r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Fitness Goal"}),r.jsxs("div",{className:"nut-goal-options",children:[r.jsxs("button",{className:T.goal==="lose"?"active":"",onClick:()=>{O(j=>({...j,goal:"lose"})),F(null)},children:[r.jsx("span",{className:"nut-goal-icon",children:"-"}),r.jsx("span",{children:"Lose Weight"})]}),r.jsxs("button",{className:T.goal==="maintain"?"active":"",onClick:()=>{O(j=>({...j,goal:"maintain"})),F(null)},children:[r.jsx("span",{className:"nut-goal-icon",children:"="}),r.jsx("span",{children:"Maintain"})]}),r.jsxs("button",{className:T.goal==="build"?"active":"",onClick:()=>{O(j=>({...j,goal:"build"})),F(null)},children:[r.jsx("span",{className:"nut-goal-icon",children:"+"}),r.jsx("span",{children:"Build Muscle"})]})]})]}),T.goal==="lose"&&r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Deficit Level"}),r.jsxs("div",{className:"nut-deficit-options",children:[r.jsxs("button",{className:T.deficitLevel==="light"?"active":"",onClick:()=>{O(j=>({...j,deficitLevel:"light"})),F(null)},children:[r.jsx("strong",{children:"Mild"}),r.jsx("span",{children:"15% below TDEE"})]}),r.jsxs("button",{className:T.deficitLevel==="moderate"?"active":"",onClick:()=>{O(j=>({...j,deficitLevel:"moderate"})),F(null)},children:[r.jsx("strong",{children:"Moderate"}),r.jsx("span",{children:"20% below TDEE"})]}),r.jsxs("button",{className:T.deficitLevel==="harsh"?"active":"",onClick:()=>{O(j=>({...j,deficitLevel:"harsh"})),F(null)},children:[r.jsx("strong",{children:"Aggressive"}),r.jsx("span",{children:"25% below TDEE"})]})]})]}),r.jsx("button",{className:"nut-calc-btn",onClick:J,disabled:!We(),children:"Calculate Macros"})]}),G&&r.jsxs("div",{className:"nut-calc-results",children:[r.jsx("h3",{children:"Your Daily Targets"}),r.jsxs("div",{className:"nut-calc-rings",children:[hs("Protein","Protein",G.protein,G.protein,"ring-protein"),hs("Carbs","Carbs",G.carbs,G.carbs,"ring-carbs"),hs("Fats","Fats",G.fats,G.fats,"ring-fats"),hs("Calories","Calories",G.calories,G.calories,"ring-cals")]}),r.jsxs("div",{className:"nut-calc-info",children:[r.jsxs("div",{className:"nut-calc-info-row",children:[r.jsx("span",{children:"BMR (body at rest)"}),r.jsxs("span",{children:[G.bmr," cal"]})]}),r.jsxs("div",{className:"nut-calc-info-row",children:[r.jsx("span",{children:"+ Daily activity (NEAT)"}),r.jsxs("span",{children:[G.neat," cal"]})]}),r.jsxs("div",{className:"nut-calc-info-row",children:[r.jsx("span",{children:"+ Training sessions"}),r.jsxs("span",{children:["+",G.exerciseAdd," cal"]})]}),r.jsxs("div",{className:"nut-calc-info-row",style:{fontWeight:600},children:[r.jsx("span",{children:"TDEE (total burn)"}),r.jsxs("span",{children:[G.tdee," cal"]})]})]}),r.jsx("button",{className:"nut-save-targets-btn",onClick:ge,children:"Set as My Daily Targets"})]})]}),Ut&&r.jsx("div",{className:`toast-notification ${Ut.type}`,children:Ut.message})]});const Tn=j=>{const C=new Date(j+"T12:00:00"),P=C.getDay(),U=new Date(C);U.setDate(C.getDate()-(P+6)%7);const ye=[];for(let Ve=0;Ve<7;Ve++){const Oe=new Date(U);Oe.setDate(U.getDate()+Ve),ye.push(Oe.toISOString().split("T")[0])}return ye},yn=["M","T","W","T","F","S","S"],Rn=(j,C="search")=>{I(j),C==="scan"?(ue("scan"),Nt(null)):C==="manual"?(ue("manual"),yt({name:"",protein:"",carbs:"",fats:"",calories:"",serving:""})):C==="favourites"?ue("favourites"):(ue("search"),Qe([]),ot(""))},bn=Tn(V),rn=new Date(V+"T12:00:00"),qs=`${Be[rn.getMonth()]} ${rn.getFullYear()}`;return r.jsx(Sa,{children:r.jsxs("div",{className:"nut-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsxs("div",{className:"nut-dark-zone",children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>p("/client/core-buddy"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsxs("div",{className:"header-actions",children:[r.jsx("button",{onClick:()=>{y("setup"),F(null)},"aria-label":"Recalculate macros",children:r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"3"}),r.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 1 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 1 1-2.83-2.83l.06-.06A1.65 1.65 0 0 0 4.68 15a1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1 0-4h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 1 1 2.83-2.83l.06.06A1.65 1.65 0 0 0 9 4.68a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 2.83l-.06.06A1.65 1.65 0 0 0 19.4 9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1z"})]})}),r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})]})]})}),r.jsxs("div",{className:"nut-dark-content",children:[r.jsxs("div",{className:"nut-week-strip anim-fade-up",children:[r.jsxs("div",{className:"nut-week-header",children:[r.jsx("button",{className:"nut-week-arrow",onClick:()=>{const j=new Date(V+"T12:00:00");j.setDate(j.getDate()-7);const C=j.toISOString().split("T")[0];te(C)},"aria-label":"Previous week",children:r.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:r.jsx("polyline",{points:"15 18 9 12 15 6"})})}),r.jsx("button",{className:"nut-week-month-label",onClick:()=>{R(!fe),D({year:rn.getFullYear(),month:rn.getMonth()})},children:qs}),r.jsx("button",{className:"nut-week-arrow",onClick:()=>{const j=new Date(V+"T12:00:00");j.setDate(j.getDate()+7);const C=j.toISOString().split("T")[0];C<=Yi()&&te(C)},"aria-label":"Next week",disabled:bn[6]>=Yi(),children:r.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:r.jsx("polyline",{points:"9 18 15 12 9 6"})})})]}),r.jsx("div",{className:"nut-week-days",children:bn.map((j,C)=>{const P=new Date(j+"T12:00:00").getDate(),U=j===V,ye=j>Yi(),Ve=j===Yi();return r.jsxs("button",{className:`nut-week-day${U?" selected":""}${Ve?" today":""}${ye?" future":""}`,disabled:ye,onClick:()=>te(j),children:[r.jsx("span",{className:"nut-week-day-letter",children:yn[C]}),r.jsx("span",{className:"nut-week-day-num",children:P})]},j)})})]}),fe&&r.jsxs("div",{className:"nut-calendar nut-calendar-dark",children:[r.jsxs("div",{className:"nut-cal-header",children:[r.jsx("button",{onClick:()=>D(j=>{let C=j.month-1,P=j.year;return C<0&&(C=11,P--),{year:P,month:C}}),children:r.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("polyline",{points:"15 18 9 12 15 6"})})}),r.jsxs("span",{children:[Be[B.month]," ",B.year]}),r.jsx("button",{onClick:()=>D(j=>{let C=j.month+1,P=j.year;return C>11&&(C=0,P++),{year:P,month:C}}),disabled:B.year===new Date().getFullYear()&&B.month>=new Date().getMonth(),children:r.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("polyline",{points:"9 18 15 12 9 6"})})})]}),r.jsx("div",{className:"nut-cal-days-header",children:Ue.map(j=>r.jsx("span",{children:j},j))}),r.jsxs("div",{className:"nut-cal-grid",children:[[...Array(Te(B.year,B.month))].map((j,C)=>r.jsx("span",{},`e${C}`)),[...Array(be(B.year,B.month))].map((j,C)=>{const P=C+1,U=`${B.year}-${String(B.month+1).padStart(2,"0")}-${String(P).padStart(2,"0")}`,ye=U>Yi(),Ve=U===V,Oe=U===Yi();return r.jsx("button",{className:`nut-cal-day${Ve?" selected":""}${Oe?" today":""}${ye?" future":""}`,disabled:ye,onClick:()=>{te(U),R(!1)},children:P},P)})]})]}),r.jsxs("div",{className:"nut-rings-row anim-fade-up-d2",children:[hs("Protein","Protein",he.protein,x.protein,"ring-protein"),hs("Carbs","Carbs",he.carbs,x.carbs,"ring-carbs"),hs("Fats","Fats",he.fats,x.fats,"ring-fats"),hs("Calories","kCal",he.calories,x.calories,"ring-cals")]})]})]}),r.jsx("div",{className:"nut-light-zone anim-fade-up-d4",children:r.jsxs("div",{className:"nut-light-content",children:[Ct&&r.jsxs("button",{className:"nut-water-quick",onClick:()=>M(!0),children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",stroke:"none",width:"18",height:"18",children:r.jsx("path",{d:"M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z"})}),r.jsxs("span",{className:"nut-water-quick-count",children:[Y.water," / ",x?.waterGoal||8]}),r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",width:"14",height:"14",children:[r.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),r.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})]}),r.jsx("div",{className:"nut-log-section",children:r.jsx("div",{className:"nut-meals-list",children:T2.map(j=>{const C=Y.entries.filter(U=>(U.meal||"snacks")===j.key),P=C.reduce((U,ye)=>({protein:U.protein+(ye.protein||0),carbs:U.carbs+(ye.carbs||0),fats:U.fats+(ye.fats||0),calories:U.calories+(ye.calories||0)}),{protein:0,carbs:0,fats:0,calories:0});return r.jsxs("div",{className:"nut-meal-card",children:[r.jsxs("div",{className:"nut-meal-card-header",children:[r.jsx("span",{className:`nut-meal-card-icon nut-meal-icon-${j.key}`,children:SD[j.key]}),r.jsx("span",{className:"nut-meal-card-title",children:j.label}),C.length>0&&r.jsxs("span",{className:"nut-meal-card-cal",children:[P.calories," cal"]}),Ct&&r.jsx("button",{className:"nut-meal-add-btn",onClick:()=>mt(ze===j.key?null:j.key),"aria-label":`Add to ${j.label}`,children:r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:[r.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),r.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})})]}),C.length>0&&r.jsxs("div",{className:"nut-meal-bars",children:[r.jsxs("div",{className:"nut-meal-bar-row",children:[r.jsx("span",{className:"nut-meal-bar-label nut-macro-p",children:"P"}),r.jsx("div",{className:"nut-meal-bar-track",children:r.jsx("div",{className:"nut-meal-bar-fill bar-protein",style:{width:`${Math.min(100,x.protein>0?P.protein/x.protein*100:0)}%`}})}),r.jsxs("span",{className:"nut-meal-bar-val",children:[P.protein,"g"]})]}),r.jsxs("div",{className:"nut-meal-bar-row",children:[r.jsx("span",{className:"nut-meal-bar-label nut-macro-c",children:"C"}),r.jsx("div",{className:"nut-meal-bar-track",children:r.jsx("div",{className:"nut-meal-bar-fill bar-carbs",style:{width:`${Math.min(100,x.carbs>0?P.carbs/x.carbs*100:0)}%`}})}),r.jsxs("span",{className:"nut-meal-bar-val",children:[P.carbs,"g"]})]}),r.jsxs("div",{className:"nut-meal-bar-row",children:[r.jsx("span",{className:"nut-meal-bar-label nut-macro-f",children:"F"}),r.jsx("div",{className:"nut-meal-bar-track",children:r.jsx("div",{className:"nut-meal-bar-fill bar-fats",style:{width:`${Math.min(100,x.fats>0?P.fats/x.fats*100:0)}%`}})}),r.jsxs("span",{className:"nut-meal-bar-val",children:[P.fats,"g"]})]}),r.jsxs("div",{className:"nut-meal-bar-row",children:[r.jsx("span",{className:"nut-meal-bar-label nut-macro-cal",children:"K"}),r.jsx("div",{className:"nut-meal-bar-track",children:r.jsx("div",{className:"nut-meal-bar-fill bar-cals",style:{width:`${Math.min(100,x.calories>0?P.calories/x.calories*100:0)}%`}})}),r.jsx("span",{className:"nut-meal-bar-val",children:P.calories})]})]}),C.length>0&&r.jsx("div",{className:"nut-log-list",children:C.map(U=>r.jsxs("div",{className:"nut-log-item",children:[r.jsx("button",{className:`nut-fav-star log${se(U.name)?" active":""}`,onClick:()=>Ge(U),"aria-label":se(U.name)?"Remove from favourites":"Add to favourites",children:r.jsx("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:se(U.name)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),r.jsxs("div",{className:"nut-log-item-info",children:[r.jsx("span",{className:"nut-log-item-name",children:U.name}),U.serving&&r.jsx("span",{className:"nut-log-item-serving",children:U.serving})]}),r.jsxs("div",{className:"nut-log-item-macros",children:[r.jsxs("span",{className:"nut-macro-p",children:[U.protein,"p"]}),r.jsxs("span",{className:"nut-macro-c",children:[U.carbs,"c"]}),r.jsxs("span",{className:"nut-macro-f",children:[U.fats,"f"]}),r.jsx("span",{className:"nut-macro-cal",children:U.calories})]}),Ct&&r.jsx("button",{className:"nut-log-delete",onClick:()=>Xe(U.id),"aria-label":"Remove",children:r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]},U.id))}),C.length===0&&r.jsx("div",{className:"nut-meal-empty",children:r.jsx("p",{children:Ct?"Tap + to add food":"No entries"})})]},j.key)})})})]})}),ze&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"nut-add-picker-backdrop",onClick:()=>mt(null)}),r.jsxs("div",{className:"nut-add-picker",children:[r.jsx("div",{className:"nut-add-picker-handle"}),r.jsxs("h3",{className:"nut-add-picker-title",children:["Add to ",T2.find(j=>j.key===ze)?.label]}),r.jsxs("div",{className:"nut-add-picker-options",children:[r.jsxs("button",{onClick:()=>{const j=ze;mt(null),Rn(j,"scan")},children:[r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M3 7V5a2 2 0 0 1 2-2h2"}),r.jsx("path",{d:"M17 3h2a2 2 0 0 1 2 2v2"}),r.jsx("path",{d:"M21 17v2a2 2 0 0 1-2 2h-2"}),r.jsx("path",{d:"M7 21H5a2 2 0 0 1-2-2v-2"}),r.jsx("line",{x1:"7",y1:"12",x2:"17",y2:"12"})]}),r.jsx("span",{children:"Scan Barcode"})]}),r.jsxs("button",{onClick:()=>{const j=ze;mt(null),Rn(j,"search")},children:[r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"11",cy:"11",r:"8"}),r.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),r.jsx("span",{children:"Search Food"})]}),r.jsxs("button",{onClick:()=>{const j=ze;mt(null),Rn(j,"manual")},children:[r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),r.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]}),r.jsx("span",{children:"Manual Entry"})]}),r.jsxs("button",{onClick:()=>{const j=ze;mt(null),Rn(j,"favourites")},children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),r.jsx("span",{children:"Favourites"})]})]})]})]}),E&&r.jsx("div",{className:"nut-modal-overlay",onClick:()=>M(!1),children:r.jsxs("div",{className:"nut-water-popup",onClick:j=>j.stopPropagation(),children:[r.jsxs("div",{className:"nut-water-popup-header",children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",stroke:"none",width:"20",height:"20",style:{color:"#2196f3"},children:r.jsx("path",{d:"M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z"})}),r.jsx("span",{children:"Water Intake"}),r.jsx("button",{className:"nut-modal-close",onClick:()=>M(!1),children:r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),r.jsxs("div",{className:"nut-water-popup-body",children:[r.jsx("div",{className:"nut-water-glasses",children:[...Array(x?.waterGoal||8)].map((j,C)=>r.jsx("div",{className:`nut-water-glass ${C<Y.water?"filled":""}`,children:r.jsx("svg",{viewBox:"0 0 24 24",fill:C<Y.water?"currentColor":"none",stroke:"currentColor",strokeWidth:"1.5",children:r.jsx("path",{d:"M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z"})})},C))}),r.jsxs("div",{className:"nut-water-popup-count",children:[Y.water," / ",x?.waterGoal||8," glasses"]}),r.jsxs("div",{className:"nut-water-btns",children:[r.jsx("button",{onClick:bt,disabled:Y.water<=0,children:"-"}),r.jsx("button",{onClick:dt,children:"+"})]})]})]})}),W&&r.jsx("div",{className:"nut-modal-overlay",onClick:()=>{pt(),L(null),ue(null),Nt(null)},children:r.jsxs("div",{className:"nut-modal",onClick:j=>j.stopPropagation(),children:[r.jsxs("div",{className:"nut-modal-header",children:[r.jsx("h3",{children:W==="scan"?"Scan Barcode":W==="search"?"Search Food":W==="favourites"?"Favourites":"Manual Entry"}),r.jsx("button",{className:"nut-modal-close",onClick:()=>{pt(),L(null),ue(null),Nt(null)},children:r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),W==="scan"&&!re&&r.jsxs("div",{className:"nut-scan-area",children:[r.jsxs("div",{className:"nut-scanner-wrapper",children:[r.jsx("div",{id:"barcode-reader",className:"nut-scanner-view"}),Re&&!Z&&r.jsx("div",{className:"nut-scan-line"}),Z&&r.jsxs("div",{className:"nut-scan-detected-overlay",children:[r.jsx("svg",{className:"nut-scan-detected-tick",viewBox:"0 0 24 24",fill:"none",stroke:"#4caf50",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M20 6L9 17l-5-5"})}),r.jsx("p",{className:"nut-scan-detected-label",children:"Barcode found!"}),r.jsx("p",{className:"nut-scan-detected-code",children:Z})]})]}),!Re&&r.jsxs("button",{className:"nut-scan-start-btn",onClick:_t,children:[r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M3 7V5a2 2 0 0 1 2-2h2"}),r.jsx("path",{d:"M17 3h2a2 2 0 0 1 2 2v2"}),r.jsx("path",{d:"M21 17v2a2 2 0 0 1-2 2h-2"}),r.jsx("path",{d:"M7 21H5a2 2 0 0 1-2-2v-2"}),r.jsx("line",{x1:"7",y1:"12",x2:"17",y2:"12"})]}),"Open Camera"]}),Re&&!Z&&r.jsx("p",{className:"nut-scan-hint",children:"Align barcode within the frame"}),r.jsx("div",{className:"nut-barcode-divider",children:r.jsx("span",{children:"or enter barcode manually"})}),r.jsxs("div",{className:"nut-barcode-manual",children:[r.jsx("input",{type:"text",inputMode:"numeric",value:ne,onChange:j=>Ie(j.target.value),onKeyDown:j=>j.key==="Enter"&&ne.trim()&&Se(ne.trim()),placeholder:"Enter barcode number"}),r.jsx("button",{onClick:()=>ne.trim()&&Se(ne.trim()),disabled:!ne.trim()||de,children:de?"...":"Look Up"})]})]}),W==="scan"&&re&&(()=>{const j=re.servingUnit||"g",C=re.portion,P=Ye==="portion"&&C?Et*C.weight:parseFloat(vt)||0,U=P/100,ye=j==="ml"?[100,200,250,500]:[50,100,150,200],Ve=Ye==="portion"&&C?`${Et} ${C.label}${Et!==1?"s":""} (${Math.round(P)}${j})`:`${Math.round(P)}${j}`;return r.jsxs("div",{className:"nut-product-result",children:[re.image&&r.jsx("img",{src:re.image,alt:re.name||"Product",className:"nut-product-img",loading:"lazy"}),r.jsxs("div",{className:"nut-product-name-row",children:[r.jsx("h4",{children:re.name}),r.jsx("button",{className:`nut-fav-star confirm${se(re.name)?" active":""}`,onClick:()=>Ge({name:re.name,protein:re.protein,carbs:re.carbs,fats:re.fats,calories:re.calories,serving:re.servingSize,per100g:{protein:re.protein,carbs:re.carbs,fats:re.fats,calories:re.calories},servingUnit:re.servingUnit||"g",portion:re.portion||null}),children:r.jsx("svg",{viewBox:"0 0 24 24",width:"22",height:"22",fill:se(re.name)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})})]}),re.brand&&r.jsx("p",{className:"nut-product-brand",children:re.brand}),r.jsxs("p",{className:"nut-product-per",children:["Per 100",j,":"]}),r.jsxs("div",{className:"nut-product-macros",children:[r.jsxs("span",{className:"nut-macro-p",children:[re.protein,"g P"]}),r.jsxs("span",{className:"nut-macro-c",children:[re.carbs,"g C"]}),r.jsxs("span",{className:"nut-macro-f",children:[re.fats,"g F"]}),r.jsxs("span",{className:"nut-macro-cal",children:[re.calories," cal"]})]}),C&&r.jsxs("div",{className:"nut-mode-toggle",children:[r.jsx("button",{className:Ye==="portion"?"active":"",onClick:()=>{It("portion"),Et<1&&ut(1)},children:"Portions"}),r.jsxs("button",{className:Ye==="weight"?"active":"",onClick:()=>{It("weight"),Pt(String(Math.round(P)||100))},children:["Custom (",j,")"]})]}),Ye==="portion"&&C?r.jsxs("div",{className:"nut-portion-stepper",children:[r.jsx("button",{className:"nut-stepper-btn",onClick:()=>ut(Math.max(1,Et-1)),children:"-"}),r.jsxs("div",{className:"nut-stepper-display",children:[r.jsx("span",{className:"nut-stepper-count",children:Et}),r.jsxs("span",{className:"nut-stepper-label",children:[C.label,Et!==1?"s":""]}),r.jsxs("span",{className:"nut-stepper-weight",children:[Math.round(P),j]})]}),r.jsx("button",{className:"nut-stepper-btn",onClick:()=>ut(Et+1),children:"+"})]}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"nut-serving-adjust",children:[r.jsxs("label",{children:["Serving (",j,")"]}),r.jsx("input",{type:"number",inputMode:"numeric",value:vt,onChange:Oe=>Pt(Oe.target.value),onFocus:Oe=>Oe.target.select(),min:"0"})]}),r.jsx("div",{className:"nut-quick-amounts",children:ye.map(Oe=>r.jsxs("button",{className:`nut-quick-btn${vt===String(Oe)?" active":""}`,onClick:()=>Pt(String(Oe)),children:[Oe,j]},Oe))})]}),r.jsx("div",{className:"nut-product-total",children:r.jsxs("span",{children:["Total: ",Math.round(re.protein*U),"p / ",Math.round(re.carbs*U),"c / ",Math.round(re.fats*U),"f / ",Math.round(re.calories*U)," cal"]})}),r.jsxs("div",{className:"nut-product-actions",children:[r.jsx("button",{className:"nut-btn-secondary",onClick:()=>{Nt(null),ue("scan")},children:"Scan Again"}),r.jsx("button",{className:"nut-btn-primary",onClick:()=>He({name:re.name,protein:Math.round(re.protein*U),carbs:Math.round(re.carbs*U),fats:Math.round(re.fats*U),calories:Math.round(re.calories*U),serving:Ve}),children:"Add"})]})]})})(),W==="search"&&!re&&r.jsxs("div",{className:"nut-search-area",children:[r.jsxs("div",{className:"nut-search-bar",children:[r.jsx("input",{type:"text",ref:on,value:Me,onChange:j=>ot(j.target.value),onKeyDown:j=>{j.key==="Enter"&&(clearTimeout(Kt.current),ke())},onFocus:()=>setTimeout(()=>on.current?.scrollIntoView({behavior:"smooth",block:"center"}),350),placeholder:"Search food or product...",autoFocus:!0}),r.jsx("button",{onClick:ke,disabled:Vt,children:Vt?"...":"Search"})]}),r.jsxs("div",{className:"nut-search-results",children:[ft.map((j,C)=>r.jsxs("button",{className:"nut-search-item",onClick:()=>{Nt(j),j.portion?(ut(1),Pt(String(j.portion.weight)),It("portion")):(ut(0),Pt(String(j.servingValue||100)),It("weight"))},children:[j.image&&r.jsx("img",{src:j.image,alt:j.name||"Product",loading:"lazy"}),r.jsxs("div",{className:"nut-search-item-info",children:[r.jsx("span",{className:"nut-search-item-name",children:j.name}),j.brand&&r.jsx("span",{className:"nut-search-item-brand",children:j.brand}),r.jsxs("span",{className:"nut-search-item-macros",children:[j.calories," cal  ",j.protein,"p  ",j.carbs,"c  ",j.fats,"f per 100",j.servingUnit||"g"]})]})]},C)),ft.length===0&&Me&&!Vt&&r.jsx("p",{className:"nut-search-empty",children:"No results found. Try a different search or use manual entry."})]})]}),W==="search"&&re&&(()=>{const j=re.servingUnit||"g",C=re.portion,P=Ye==="portion"&&C?Et*C.weight:parseFloat(vt)||0,U=P/100,ye=j==="ml"?[100,200,250,500]:[50,100,150,200],Ve=Ye==="portion"&&C?`${Et} ${C.label}${Et!==1?"s":""} (${Math.round(P)}${j})`:`${Math.round(P)}${j}`;return r.jsxs("div",{className:"nut-product-result",children:[re.image&&r.jsx("img",{src:re.image,alt:re.name||"Product",className:"nut-product-img",loading:"lazy"}),r.jsxs("div",{className:"nut-product-name-row",children:[r.jsx("h4",{children:re.name}),r.jsx("button",{className:`nut-fav-star confirm${se(re.name)?" active":""}`,onClick:()=>Ge({name:re.name,protein:re.protein,carbs:re.carbs,fats:re.fats,calories:re.calories,serving:re.servingSize,per100g:{protein:re.protein,carbs:re.carbs,fats:re.fats,calories:re.calories},servingUnit:re.servingUnit||"g",portion:re.portion||null}),children:r.jsx("svg",{viewBox:"0 0 24 24",width:"22",height:"22",fill:se(re.name)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})})]}),re.brand&&r.jsx("p",{className:"nut-product-brand",children:re.brand}),r.jsxs("p",{className:"nut-product-per",children:["Per 100",j,":"]}),r.jsxs("div",{className:"nut-product-macros",children:[r.jsxs("span",{className:"nut-macro-p",children:[re.protein,"g P"]}),r.jsxs("span",{className:"nut-macro-c",children:[re.carbs,"g C"]}),r.jsxs("span",{className:"nut-macro-f",children:[re.fats,"g F"]}),r.jsxs("span",{className:"nut-macro-cal",children:[re.calories," cal"]})]}),C&&r.jsxs("div",{className:"nut-mode-toggle",children:[r.jsx("button",{className:Ye==="portion"?"active":"",onClick:()=>{It("portion"),Et<1&&ut(1)},children:"Portions"}),r.jsxs("button",{className:Ye==="weight"?"active":"",onClick:()=>{It("weight"),Pt(String(Math.round(P)||100))},children:["Custom (",j,")"]})]}),Ye==="portion"&&C?r.jsxs("div",{className:"nut-portion-stepper",children:[r.jsx("button",{className:"nut-stepper-btn",onClick:()=>ut(Math.max(1,Et-1)),children:"-"}),r.jsxs("div",{className:"nut-stepper-display",children:[r.jsx("span",{className:"nut-stepper-count",children:Et}),r.jsxs("span",{className:"nut-stepper-label",children:[C.label,Et!==1?"s":""]}),r.jsxs("span",{className:"nut-stepper-weight",children:[Math.round(P),j]})]}),r.jsx("button",{className:"nut-stepper-btn",onClick:()=>ut(Et+1),children:"+"})]}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"nut-serving-adjust",children:[r.jsxs("label",{children:["Serving (",j,")"]}),r.jsx("input",{type:"number",inputMode:"numeric",value:vt,onChange:Oe=>Pt(Oe.target.value),onFocus:Oe=>Oe.target.select(),min:"0"})]}),r.jsx("div",{className:"nut-quick-amounts",children:ye.map(Oe=>r.jsxs("button",{className:`nut-quick-btn${vt===String(Oe)?" active":""}`,onClick:()=>Pt(String(Oe)),children:[Oe,j]},Oe))})]}),r.jsx("div",{className:"nut-product-total",children:r.jsxs("span",{children:["Total: ",Math.round(re.protein*U),"p / ",Math.round(re.carbs*U),"c / ",Math.round(re.fats*U),"f / ",Math.round(re.calories*U)," cal"]})}),r.jsxs("div",{className:"nut-product-actions",children:[r.jsx("button",{className:"nut-btn-secondary",onClick:()=>Nt(null),children:"Back to Search"}),r.jsx("button",{className:"nut-btn-primary",onClick:()=>He({name:re.name,protein:Math.round(re.protein*U),carbs:Math.round(re.carbs*U),fats:Math.round(re.fats*U),calories:Math.round(re.calories*U),serving:Ve}),children:"Add"})]})]})})(),W==="manual"&&r.jsxs("div",{className:"nut-manual-form",children:[r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Food Name"}),r.jsx("input",{type:"text",value:jt.name,onChange:j=>yt(C=>({...C,name:j.target.value})),placeholder:"e.g. Chicken Breast",autoFocus:!0})]}),r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Serving Size (optional)"}),r.jsx("input",{type:"text",value:jt.serving,onChange:j=>yt(C=>({...C,serving:j.target.value})),placeholder:"e.g. 150g, 1 cup"})]}),r.jsxs("div",{className:"nut-manual-macros",children:[r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Protein (g)"}),r.jsx("input",{type:"number",value:jt.protein,onChange:j=>yt(C=>({...C,protein:j.target.value})),min:"0"})]}),r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Carbs (g)"}),r.jsx("input",{type:"number",value:jt.carbs,onChange:j=>yt(C=>({...C,carbs:j.target.value})),min:"0"})]}),r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Fats (g)"}),r.jsx("input",{type:"number",value:jt.fats,onChange:j=>yt(C=>({...C,fats:j.target.value})),min:"0"})]}),r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Calories"}),r.jsx("input",{type:"number",value:jt.calories,onChange:j=>yt(C=>({...C,calories:j.target.value})),min:"0"})]})]}),r.jsx("button",{className:"nut-btn-primary",disabled:!jt.name.trim(),onClick:()=>He({name:jt.name,protein:parseFloat(jt.protein)||0,carbs:parseFloat(jt.carbs)||0,fats:parseFloat(jt.fats)||0,calories:parseFloat(jt.calories)||0,serving:jt.serving||""}),children:"Add Food"})]}),W==="favourites"&&!re&&(()=>{const j=z(),C=P=>{if(P.per100g){const U=P.per100g;Nt({name:P.name,brand:"",image:null,servingSize:P.serving||"100g",servingValue:100,servingUnit:P.servingUnit||"g",portion:P.portion||null,protein:U.protein,carbs:U.carbs,fats:U.fats,calories:U.calories,per100g:!0}),P.portion?(ut(1),Pt(String(P.portion.weight)),It("portion")):(ut(0),Pt("100"),It("weight"))}else He({name:P.name,protein:P.protein,carbs:P.carbs,fats:P.fats,calories:P.calories,serving:P.serving||""})};return r.jsx("div",{className:"nut-recent-area",children:j.length===0?r.jsx("p",{className:"nut-search-empty",children:"No favourites yet. Tap the star on any food to save it here."}):r.jsx("div",{className:"nut-recent-list",children:j.map((P,U)=>r.jsxs("div",{className:"nut-recent-item-row",children:[r.jsx("button",{className:"nut-fav-star active",onClick:ye=>{ye.stopPropagation(),Ge(P)},children:r.jsx("svg",{viewBox:"0 0 24 24",width:"18",height:"18",fill:"currentColor",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),r.jsxs("button",{className:"nut-recent-item",onClick:()=>C(P),children:[r.jsxs("div",{className:"nut-recent-item-info",children:[r.jsx("span",{className:"nut-recent-item-name",children:P.name}),r.jsx("span",{className:"nut-recent-item-serving",children:P.serving||""})]}),r.jsxs("span",{className:"nut-recent-item-macros",children:[P.calories," cal"]})]})]},U))})})})(),W==="favourites"&&re&&(()=>{const j=re.servingUnit||"g",C=re.portion,P=Ye==="portion"&&C?Et*C.weight:parseFloat(vt)||0,U=P/100,ye=j==="ml"?[100,200,250,500]:[50,100,150,200],Ve=Ye==="portion"&&C?`${Et} ${C.label}${Et!==1?"s":""} (${Math.round(P)}${j})`:`${Math.round(P)}${j}`;return r.jsxs("div",{className:"nut-product-result",children:[r.jsxs("div",{className:"nut-product-name-row",children:[r.jsx("h4",{children:re.name}),r.jsx("button",{className:`nut-fav-star confirm${se(re.name)?" active":""}`,onClick:()=>Ge({name:re.name,protein:re.protein,carbs:re.carbs,fats:re.fats,calories:re.calories,serving:re.servingSize,per100g:{protein:re.protein,carbs:re.carbs,fats:re.fats,calories:re.calories},servingUnit:re.servingUnit||"g",portion:re.portion||null}),children:r.jsx("svg",{viewBox:"0 0 24 24",width:"22",height:"22",fill:se(re.name)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})})]}),r.jsxs("p",{className:"nut-product-per",children:["Per 100",j,":"]}),r.jsxs("div",{className:"nut-product-macros",children:[r.jsxs("span",{className:"nut-macro-p",children:[re.protein,"g P"]}),r.jsxs("span",{className:"nut-macro-c",children:[re.carbs,"g C"]}),r.jsxs("span",{className:"nut-macro-f",children:[re.fats,"g F"]}),r.jsxs("span",{className:"nut-macro-cal",children:[re.calories," cal"]})]}),C&&r.jsxs("div",{className:"nut-mode-toggle",children:[r.jsx("button",{className:Ye==="portion"?"active":"",onClick:()=>{It("portion"),Et<1&&ut(1)},children:"Portions"}),r.jsxs("button",{className:Ye==="weight"?"active":"",onClick:()=>{It("weight"),Pt(String(Math.round(P)||100))},children:["Custom (",j,")"]})]}),Ye==="portion"&&C?r.jsxs("div",{className:"nut-portion-stepper",children:[r.jsx("button",{className:"nut-stepper-btn",onClick:()=>ut(Math.max(1,Et-1)),children:"-"}),r.jsxs("div",{className:"nut-stepper-display",children:[r.jsx("span",{className:"nut-stepper-count",children:Et}),r.jsxs("span",{className:"nut-stepper-label",children:[C.label,Et!==1?"s":""]}),r.jsxs("span",{className:"nut-stepper-weight",children:[Math.round(P),j]})]}),r.jsx("button",{className:"nut-stepper-btn",onClick:()=>ut(Et+1),children:"+"})]}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"nut-serving-adjust",children:[r.jsxs("label",{children:["Serving (",j,")"]}),r.jsx("input",{type:"number",inputMode:"numeric",value:vt,onChange:Oe=>Pt(Oe.target.value),onFocus:Oe=>Oe.target.select(),min:"0"})]}),r.jsx("div",{className:"nut-quick-amounts",children:ye.map(Oe=>r.jsxs("button",{className:`nut-quick-btn${vt===String(Oe)?" active":""}`,onClick:()=>Pt(String(Oe)),children:[Oe,j]},Oe))})]}),r.jsx("div",{className:"nut-product-total",children:r.jsxs("span",{children:["Total: ",Math.round(re.protein*U),"p / ",Math.round(re.carbs*U),"c / ",Math.round(re.fats*U),"f / ",Math.round(re.calories*U)," cal"]})}),r.jsxs("div",{className:"nut-product-actions",children:[r.jsx("button",{className:"nut-btn-secondary",onClick:()=>Nt(null),children:"Back to Favourites"}),r.jsx("button",{className:"nut-btn-primary",onClick:()=>He({name:re.name,protein:Math.round(re.protein*U),carbs:Math.round(re.carbs*U),fats:Math.round(re.fats*U),calories:Math.round(re.calories*U),serving:Ve}),children:"Add"})]})]})})()]})}),r.jsx(ha,{active:"nutrition"}),Ut&&r.jsx("div",{className:`toast-notification ${Ut.type}`,children:Ut.message})]})})}async function tb(n){const{type:e="workout",title:t="Workout Complete!",stats:i=[],badges:l=[],badgeImage:u,badgeDesc:d}=n,p=1080,g=1920,y=document.createElement("canvas");y.width=p,y.height=g;const x=y.getContext("2d"),k="#2a2a28",T="#ffffff",O="#A12F3A",G="#1a1a1a",F="#555555";x.fillStyle=k,x.fillRect(0,0,p,g);const V=Math.round(p*.82),te=Math.round(g*.75),Y=Math.round((p-V)/2),ie=Math.round((g-te)/2),he=28,Ne=5;x.save(),x.shadowColor="rgba(0, 0, 0, 0.45)",x.shadowBlur=40,x.shadowOffsetY=10,E2(x,Y,ie,V,te,he),x.fillStyle=T,x.fill(),x.restore(),x.save(),E2(x,Y,ie,V,te,he),x.strokeStyle=O,x.lineWidth=Ne,x.stroke(),x.restore();const fe=220,R=50,E=52,M=68,B=10,D=36,H=48,I=30,ze=34,mt=46,W=30,ue=28;x.font=`bold ${E}px 'Orbitron', sans-serif`;const Re=tu(x,t.toUpperCase(),V-100);x.font=`500 ${D}px 'Montserrat', sans-serif`;let Le=[];e==="badge"&&d?Le=tu(x,d,V-120):e==="badge"&&l.length>0?Le=tu(x,l.join("    "),V-120):i.length>0&&(Le=tu(x,i.map(Nt=>`${Nt.value} ${Nt.label}`).join("    "),V-120));const Z=e==="badge"?"I just earned a badge on Core Buddy ":e==="habits"?"I just completed my daily habits with Core Buddy ":"I just completed a workout using Core Buddy ";x.font=`bold ${ze}px 'Montserrat', sans-serif`;const L=tu(x,Z,V-80);let ne=Re.length*M;Le.length>0&&(ne+=B+Le.length*H),ne+=I+L.length*mt,ne+=W+ue;const de=ie+te-60-ne,Me=ie+40,ot=de-R,ft=p/2,Qe=(Me+ot)/2,Vt=e==="badge"&&u?u:"/Logo.webp";x.save();const Ls=e==="badge"?"rgba(255, 193, 7, 0.15)":"rgba(161, 47, 58, 0.12)",jt=x.createRadialGradient(ft,Qe,fe*.6,ft,Qe,fe*1.5);jt.addColorStop(0,Ls),jt.addColorStop(1,"rgba(0, 0, 0, 0)"),x.fillStyle=jt,x.fillRect(ft-fe*1.5,Qe-fe*1.5,fe*3,fe*3),x.restore(),x.beginPath(),x.arc(ft,Qe,fe+6,0,Math.PI*2),x.fillStyle=T,x.fill();const yt=e==="badge"?"#ffc107":O;x.beginPath(),x.arc(ft,Qe,fe,0,Math.PI*2),x.strokeStyle=yt,x.lineWidth=5,x.stroke();try{const Nt=await RD(Vt);x.save(),x.beginPath(),x.arc(ft,Qe,fe-6,0,Math.PI*2),x.clip();const vt=(fe-6)*2;x.drawImage(Nt,ft-fe+6,Qe-fe+6,vt,vt),x.restore()}catch{x.textAlign="center",x.textBaseline="middle",x.fillStyle=O,x.font="bold 80px 'Orbitron', sans-serif",x.fillText(e==="badge"?"":"MCF",ft,Qe)}let re=de;x.textAlign="center",x.textBaseline="alphabetic",x.fillStyle=G,x.font=`bold ${E}px 'Orbitron', sans-serif`;for(const Nt of Re)x.fillText(Nt,p/2,re),re+=M;if(Le.length>0){re+=B,x.fillStyle=F,x.font=`500 ${D}px 'Montserrat', sans-serif`;for(const Nt of Le)x.fillText(Nt,p/2,re),re+=H}re+=I,x.fillStyle=G,x.font=`bold ${ze}px 'Montserrat', sans-serif`;for(const Nt of L)x.fillText(Nt,p/2,re),re+=mt;return re+=W,x.fillStyle=O,x.font=`600 ${ue}px 'Montserrat', sans-serif`,x.fillText("Make It Count with Core Buddy",p/2,re),new Promise(Nt=>{y.toBlob(vt=>Nt(vt),"image/png")})}function E2(n,e,t,i,l,u){n.beginPath(),n.moveTo(e+u,t),n.lineTo(e+i-u,t),n.quadraticCurveTo(e+i,t,e+i,t+u),n.lineTo(e+i,t+l-u),n.quadraticCurveTo(e+i,t+l,e+i-u,t+l),n.lineTo(e+u,t+l),n.quadraticCurveTo(e,t+l,e,t+l-u),n.lineTo(e,t+u),n.quadraticCurveTo(e,t,e+u,t),n.closePath()}function RD(n){return new Promise((e,t)=>{const i=new Image;i.crossOrigin="anonymous",i.onload=()=>e(i),i.onerror=t,i.src=n})}function tu(n,e,t){if(n.measureText(e).width<=t)return[e];const i=e.split(" "),l=[];let u="";for(const d of i){const p=u?`${u} ${d}`:d;n.measureText(p).width>t&&u?(l.push(u),u=d):u=p}return u&&l.push(u),l}function AD(){const n=v.useRef(null),e=v.useCallback(()=>{if(!n.current)try{n.current=new(window.AudioContext||window.webkitAudioContext)}catch{}const u=n.current;return u?.state==="suspended"&&u.resume(),u},[]),t=v.useCallback(()=>{navigator.vibrate&&navigator.vibrate([40,60,30]);const u=e();if(!u)return;const d=u.currentTime,p=u.createBiquadFilter();p.type="lowpass",p.frequency.value=500,p.Q.value=.7,p.connect(u.destination);const g=u.createOscillator(),y=u.createGain();g.type="sine",g.frequency.value=50,y.gain.value=.3,y.gain.setTargetAtTime(0,d+.08,.04),g.connect(y).connect(p),g.start(d),g.stop(d+.2);const x=u.createOscillator(),k=u.createGain();x.type="sine",x.frequency.value=70,k.gain.value=.2,k.gain.setTargetAtTime(0,d+.22,.04),x.connect(k).connect(p),x.start(d+.15),x.stop(d+.35)},[e]),i=v.useCallback(()=>{navigator.vibrate&&navigator.vibrate(30);const u=e();if(!u)return;const d=u.currentTime,p=u.createBiquadFilter();p.type="lowpass",p.frequency.value=500,p.Q.value=.7,p.connect(u.destination);const g=u.createOscillator(),y=u.createGain();g.type="sine",g.frequency.value=55,y.gain.value=.35,y.gain.setTargetAtTime(0,d+.08,.04),g.connect(y).connect(p),g.start(d),g.stop(d+.2)},[e]),l=v.useCallback(()=>{navigator.vibrate&&navigator.vibrate([50,80,100]);const u=e();u&&[0,.12].forEach((d,p)=>{const g=u.createOscillator(),y=u.createGain();g.type="sine",g.frequency.value=p===0?523:784,y.gain.value=.12,y.gain.setTargetAtTime(0,u.currentTime+d+.15,.02),g.connect(y).connect(u.destination),g.start(u.currentTime+d),g.stop(u.currentTime+d+.2)})},[e]);return v.useEffect(()=>()=>{n.current?.close()},[]),{tap:i,tick:t,complete:l}}const MD=2e3,Ig=42,Ll=2*Math.PI*Ig,ID=1200,S2=["Another one in the bank!","Consistency beats everything.","You showed up  that's what counts.","Stronger every session."];function Qh({title:n,subtitle:e,stats:t,onDone:i,onDismissStart:l,onShareJourney:u,userName:d,buttonLabel:p="Done",holdLabel:g="Hold To Complete Session",shareType:y="workout"}){const[x,k]=v.useState("hold"),[T,O]=v.useState(!1),[G,F]=v.useState(0),[V,te]=v.useState(!1),[Y,ie]=v.useState(!1),[he,Ne]=v.useState(null),fe=AD(),R=v.useRef(null),E=v.useRef(null),M=v.useRef(null),B=v.useRef(null),D=v.useRef(!1),H=v.useRef(!1),I=v.useRef(0),ze=v.useRef(S2[Math.floor(Math.random()*S2.length)]),mt=v.useRef([...Array(80)].map((de,qe)=>({x:5+Math.random()*90,delay:Math.random()*3.5,color:["#A12F3A","#ffffff","#000000"][qe%3],drift:(Math.random()-.5)*120,spin:Math.random()*720-360,duration:1.8+Math.random()*2,width:4+Math.random()*6,height:4+Math.random()*8,shape:qe%3}))),W=v.useCallback(()=>{if(D.current)return;D.current=!0,H.current=!1,I.current=0,O(!0),F(0),B.current=performance.now(),fe.tap(),R.current&&(R.current.style.strokeDashoffset=Ll);const de=qe=>{const Me=qe-B.current,ot=Math.min(Me/MD,1);if(R.current&&(R.current.style.strokeDashoffset=Ll-ot*Ll),E.current){const ft=8*(1-ot),Qe=1-ot,Vt=1+ot*.15;E.current.style.filter=`blur(${ft}px) grayscale(${Qe})`,E.current.style.transform=`scale(${Vt})`}F(ot),Me-I.current>=ID&&(I.current=Me,fe.tick()),ot<1?M.current=requestAnimationFrame(de):(D.current=!1,H.current=!0,M.current=null,O(!1),F(1),fe.complete(),k("celebrate"))};M.current=requestAnimationFrame(de)},[fe]),ue=v.useCallback(()=>{D.current&&(D.current=!1,M.current&&(cancelAnimationFrame(M.current),M.current=null),R.current&&(R.current.style.strokeDashoffset=Ll),E.current&&(E.current.style.filter="",E.current.style.transform=""),O(!1),F(0))},[]),Re=v.useCallback(()=>{te(!0),l?.(),setTimeout(()=>{i?.()},300)},[i,l]),Le=v.useCallback(()=>{const de=[n||"Workout Complete!"];return e&&de.push(e),t?.length&&de.push(t.map(qe=>`${qe.value} ${qe.label}`).join(" | ")),de.push("#MindCoreFitness"),de.join(`
`)},[n,e,t]),Z=v.useCallback(async()=>{if(!(Y||!u))try{await u({type:y==="habits"?"habits_summary":"workout_summary",title:n||"Workout Complete!",subtitle:e,stats:t||[],quote:ze.current}),ie(!0),Ne("Posted to Journey!"),setTimeout(()=>Ne(null),2500)}catch(de){console.error("Journey post failed:",de),Ne(de?.message||"Failed to post"),setTimeout(()=>Ne(null),3500)}},[Y,u,n,e,t]),[L,ne]=v.useState(!1),Ie=v.useCallback(async()=>{ne(!0);try{const de=await tb({type:y||"workout",title:n||"Workout Complete!",subtitle:e,stats:t||[],quote:ze.current,userName:d}),qe=Le();if(navigator.share&&navigator.canShare?.({files:[new File([de],"workout.png",{type:"image/png"})]})){const Me=new File([de],"workout.png",{type:"image/png"});await navigator.share({title:"Mind Core Fitness",text:qe,files:[Me]})}else navigator.share?await navigator.share({title:"Mind Core Fitness",text:qe}):(await navigator.clipboard.writeText(qe),Ne("Copied to clipboard!"),setTimeout(()=>Ne(null),2500))}catch{try{await navigator.clipboard.writeText(Le()),Ne("Copied to clipboard!"),setTimeout(()=>Ne(null),2500)}catch{}}finally{ne(!1)}},[n,e,t,d,Le]);return x==="hold"?r.jsxs("div",{className:"wc-hold-page",children:[r.jsx("div",{className:"wc-hold-glow","aria-hidden":"true"}),r.jsx("p",{className:"wc-hold-label",children:g}),r.jsxs("div",{className:`wc-hold-ring-touch ${T?"wc-holding":""}`,onPointerDown:de=>{de.preventDefault(),W()},onPointerUp:ue,onPointerLeave:ue,onPointerCancel:ue,onClick:de=>{de.stopPropagation(),H.current&&(H.current=!1)},role:"button",tabIndex:0,"aria-label":"Press and hold to finish workout",onKeyDown:de=>{(de.key==="Enter"||de.key===" ")&&(de.preventDefault(),fe.complete(),k("celebrate"))},children:[r.jsx("div",{className:"wc-hold-ring-glow","aria-hidden":"true"}),r.jsxs("svg",{className:"wc-hold-ring-svg",viewBox:"0 0 100 100",children:[r.jsx("circle",{className:"wc-hold-ring-track",cx:"50",cy:"50",r:Ig}),r.jsx("circle",{className:"wc-hold-ring-fill",ref:R,cx:"50",cy:"50",r:Ig,style:{strokeDasharray:Ll,strokeDashoffset:Ll}})]}),r.jsx("img",{ref:E,src:"/Logo.webp",alt:"Mind Core Fitness",className:"wc-hold-logo",draggable:!1})]})]}):r.jsxs("div",{className:`wc-celeb-overlay ${V?"wc-celeb-dismissing":""}`,children:[r.jsx("div",{className:"wc-celeb-confetti","aria-hidden":"true",children:mt.current.map((de,qe)=>r.jsx("span",{className:`wc-celeb-confetti-piece wc-confetti-shape-${de.shape}`,style:{"--x":`${de.x}%`,"--delay":`${de.delay}s`,"--color":de.color,"--drift":`${de.drift}px`,"--spin":`${de.spin}deg`,"--duration":`${de.duration}s`,width:`${de.width}px`,height:`${de.height}px`}},qe))}),r.jsxs("div",{className:"wc-celeb-content",children:[r.jsx("div",{className:"wc-celeb-logo-frame",children:r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"wc-celeb-logo-img"})}),r.jsx("h2",{className:"wc-celeb-heading",children:n||"Congratulations!"}),e&&r.jsx("p",{className:"wc-celeb-subtext",children:e}),r.jsx("p",{className:"wc-celeb-quote",children:ze.current}),t&&t.length>0&&r.jsx("div",{className:"wc-celeb-stats-row",children:t.map((de,qe)=>r.jsxs("div",{className:"wc-celeb-stat",children:[r.jsx("span",{className:"wc-celeb-stat-val",children:de.value}),r.jsx("span",{className:"wc-celeb-stat-label",children:de.label})]},qe))}),r.jsxs("div",{className:"wc-share-row",children:[u&&r.jsxs("button",{className:`wc-share-btn wc-share-journey ${Y?"wc-share-done":""}`,onClick:Z,disabled:Y,children:[r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M12 20h9"}),r.jsx("path",{d:"M16.5 3.5a2.121 2.121 0 1 1 3 3L7 19l-4 1 1-4Z"})]}),Y?"Posted!":"Post to Journey"]}),r.jsxs("button",{className:"wc-share-btn wc-share-external",onClick:Ie,disabled:L,children:[r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("circle",{cx:"18",cy:"5",r:"3"}),r.jsx("circle",{cx:"6",cy:"12",r:"3"}),r.jsx("circle",{cx:"18",cy:"19",r:"3"}),r.jsx("line",{x1:"8.59",y1:"13.51",x2:"15.42",y2:"17.49"}),r.jsx("line",{x1:"15.41",y1:"6.51",x2:"8.59",y2:"10.49"})]}),L?"Generating...":"Share"]})]}),r.jsx("button",{className:"wc-celeb-btn",onClick:Re,children:p}),he&&r.jsx("div",{className:"wc-share-toast",children:he})]})]})}const N2="/login/assets/randomiser-glq9YJkL.jpg",DD="/login/assets/programme-card-workout-CnNzTYkz.webp",PD="/login/assets/prog-fullbody-4wk-r6m9HJys.jpg",LD="/login/assets/mg-arms-BeOQU3wx.jpg",OD=60,Wp=5,BD=[{threshold:1e3,label:"1 Tonne"},{threshold:5e3,label:"5 Tonne"},{threshold:1e4,label:"10 Tonne"},{threshold:25e3,label:"25 Tonne"},{threshold:5e4,label:"50 Tonne"},{threshold:1e5,label:"100 Tonne"},{threshold:25e4,label:"250 Tonne"},{threshold:5e5,label:"500 Tonne"},{threshold:1e6,label:"1 Million kg"}],VD={"Dumbbell Floor Press":"push","Seated Dumbbell Shoulder Press":"push","Seated Dumbbell Arnold Press":"push","Dumbbell Overhead Tricep Extension":"push",Skullcrushers:"push","Dumbbell Lateral Raise":"push","Dumbbell Front Raise":"push","Dumbbell Squeeze Press":"push","Incline Dumbbell Press":"push","Dumbbell Fly":"push","Dumbbell Pullover":"push","Tricep Kickback":"push","Dumbbell Shrug":"push","Dumbbell Y-Raise":"push","Dumbbell Bent Over Row":"pull","Single Arm Bent Over Row":"pull","Bicep Curl":"pull","Hammer Curl":"pull","Dumbbell Bent Over Rear Delt Fly":"pull","Renegade Row":"pull","Wide Dumbbell Bent Over Row":"pull","Reverse Fly":"pull","Concentration Curl":"pull","Wide Grip Bicep Curl":"pull","Wrist Curl":"pull","Dumbbell Goblet Squats":"lower","Romanian Deadlifts":"lower","Forward Dumbbell Lunges":"lower","Dumbbell Sumo Squats":"lower","Weighted Calf Raises":"lower","1 Legged RDL":"lower","Dumbbell Box Step Ups":"lower","Dumbbell Squat Pulses":"lower","Dumbbell Reverse Lunges":"lower","Kettlebell Romanian Deadlift":"lower","Russian Twists Dumbbell":"core","Kettlebell Russian Twist":"core","Kettlebell Side Bends":"core","Kneeling Kettlebell Halo":"core","Kettlebell Bird Dog Drag":"core"},UD={fullbody_4wk:{duration:4,daysPerWeek:3},fullbody_8wk:{duration:8,daysPerWeek:3},fullbody_12wk:{duration:12,daysPerWeek:3},core_4wk:{duration:4,daysPerWeek:3},core_8wk:{duration:8,daysPerWeek:3},core_12wk:{duration:12,daysPerWeek:3},upper_4wk:{duration:4,daysPerWeek:3},lower_4wk:{duration:4,daysPerWeek:3}},FD={fullbody:"linear-gradient(160deg, rgba(153,49,60,0.15) 0%, rgba(153,49,60,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)",core:"linear-gradient(160deg, rgba(30,80,120,0.2) 0%, rgba(30,80,120,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)",upper:"linear-gradient(160deg, rgba(100,60,140,0.2) 0%, rgba(100,60,140,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)",lower:"linear-gradient(160deg, rgba(40,120,80,0.2) 0%, rgba(40,120,80,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)"},Gp={arms:"linear-gradient(160deg, rgba(180,60,60,0.2) 0%, rgba(180,60,60,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",chest:"linear-gradient(160deg, rgba(50,100,160,0.2) 0%, rgba(50,100,160,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",back:"linear-gradient(160deg, rgba(80,130,60,0.2) 0%, rgba(80,130,60,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",shoulders:"linear-gradient(160deg, rgba(160,100,40,0.2) 0%, rgba(160,100,40,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",legs:"linear-gradient(160deg, rgba(100,50,140,0.2) 0%, rgba(100,50,140,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",core:"linear-gradient(160deg, rgba(30,80,120,0.2) 0%, rgba(30,80,120,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)"},Kp=[{id:"fullbody_4wk",name:"4-Week Full Body",focus:"fullbody",duration:4,level:"All Levels",daysPerWeek:3,image:PD},{id:"fullbody_8wk",name:"8-Week Full Body",focus:"fullbody",duration:8,level:"Intermediate",daysPerWeek:3},{id:"fullbody_12wk",name:"12-Week Full Body",focus:"fullbody",duration:12,level:"Advanced",daysPerWeek:3},{id:"core_4wk",name:"4-Week Core",focus:"core",duration:4,level:"Beginner",daysPerWeek:3},{id:"core_8wk",name:"8-Week Core",focus:"core",duration:8,level:"Intermediate",daysPerWeek:3},{id:"core_12wk",name:"12-Week Core",focus:"core",duration:12,level:"Advanced",daysPerWeek:3},{id:"upper_4wk",name:"4-Week Upper Body",focus:"upper",duration:4,level:"Intermediate",daysPerWeek:3},{id:"lower_4wk",name:"4-Week Lower Body",focus:"lower",duration:4,level:"Intermediate",daysPerWeek:3}],su=[{key:"arms",label:"Arms",icon:"M7 5h2v14H7V5zm8 0h2v14h-2V5zm-5 4h4v6h-4V9z",image:LD},{key:"chest",label:"Chest",icon:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 15H9v-2h2v2zm4 0h-2v-2h2v2zm3-6c0 1.1-.36 2.12-.97 2.95l-.87-.87C16.7 12.53 17 11.8 17 11c0-2.76-2.24-5-5-5S7 8.24 7 11c0 .8.3 1.53.84 2.08l-.87.87A4.977 4.977 0 0 1 6 11c0-3.31 2.69-6 6-6s6 2.69 6 6z"},{key:"back",label:"Back",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm4 18H8v-6l-4-4 1.41-1.41L8 11.17V8h8v3.17l2.59-2.58L20 10l-4 4v6z"},{key:"shoulders",label:"Shoulders",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm8 10l-3-1.5c-.5-.25-1-.5-1.5-.5h-7c-.5 0-1 .25-1.5.5L4 12l-2 6h4l1.5 4h9L18 18h4l-2-6z"},{key:"legs",label:"Legs",icon:"M16.5 3A2.5 2.5 0 0 0 14 5.5 2.5 2.5 0 0 0 16.5 8 2.5 2.5 0 0 0 19 5.5 2.5 2.5 0 0 0 16.5 3zM14 9l-3 7h2l1 6h2l1-6h2l-3-7h-2z"},{key:"core",label:"Core",icon:"M12 2a4 4 0 0 1 4 4v1h-2V6a2 2 0 1 0-4 0v1H8V6a4 4 0 0 1 4-4zM8 9h8v2H8V9zm-1 4h10l-1 9H8l-1-9z"}],C2={chest:[{id:"chest_strength",name:"Chest Strength",desc:"Heavy pressing for max strength",level:"Intermediate",overview:"A heavy pressing session designed to build raw chest strength. Focus on controlled negatives and powerful pressing movements.",tips:["Go heavy  pick a weight where the last 2 reps are a real challenge","Control the negative (lowering phase) for 2-3 seconds","Keep your shoulder blades squeezed together throughout all pressing movements","Rest 90-120 seconds between sets to allow full recovery"],exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:4,reps:8,storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Dumbbell Squeeze Press",type:"weighted",sets:3,reps:10,storagePath:null},{name:"Incline Dumbbell Press",type:"weighted",sets:3,reps:10,storagePath:null},{name:"Dumbbell Pullover",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Dumbbell Fly",type:"weighted",sets:3,reps:12,storagePath:null}]},{id:"chest_hypertrophy",name:"Chest Hypertrophy",desc:"Volume training for muscle growth",level:"Intermediate",overview:"A high-volume chest session focused on time under tension and muscle growth. Lighter weights, more reps, and slow controlled movements.",tips:["Use moderate weight  you should feel the burn by rep 10","Squeeze your chest at the top of every rep for 1 second","Keep rest periods short at 60-90 seconds to keep the pump going","On press ups, go to failure on the final set"],exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Wide Press Up",type:"reps",sets:3,reps:15,storagePath:null},{name:"Dumbbell Fly",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Incline Dumbbell Press",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Press Up",type:"reps",sets:3,reps:20,storagePath:"exercises/bodyweight/upper/press up.mp4"}]},{id:"chest_endurance",name:"Chest Endurance",desc:"Bodyweight pushing to failure",level:"All Levels",overview:"No weights needed. This bodyweight-only session builds chest endurance and muscular stamina through high-rep push up variations.",tips:["Focus on full range of motion  chest to floor on every rep","Keep your core tight and body in a straight line throughout","Scale down to knee press ups if you can't maintain form","Push through the burn  the last 5 reps are where the growth happens"],exercises:[{name:"Press Up",type:"reps",sets:4,reps:20,storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Wide Press Up",type:"reps",sets:3,reps:15,storagePath:null},{name:"Diamond Press Up",type:"reps",sets:3,reps:12,storagePath:null},{name:"Decline Press Up",type:"reps",sets:3,reps:15,storagePath:null},{name:"Press Up Hold",type:"timed",sets:3,time:30,storagePath:null}]}],back:[{id:"back_strength",name:"Back Strength",desc:"Heavy rows for a thick back",level:"Intermediate",overview:"Build a thick, powerful back with heavy rowing movements. This session targets your lats, rhomboids, and traps for overall back development.",tips:["Go heavy on rows  use a weight that challenges you by rep 6-8","Drive your elbows back and squeeze your shoulder blades together at the top","Keep a slight bend in your knees and hinge at the hips for bent over movements","Rest 90-120 seconds between sets for full recovery"],exercises:[{name:"Dumbbell Bent Over Row",type:"weighted",sets:4,reps:8,storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Single Arm Bent Over Row",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Dumbbell Pullover",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Dumbbell Shrug",type:"weighted",sets:3,reps:15,storagePath:null}]},{id:"back_hypertrophy",name:"Back Hypertrophy",desc:"Width and thickness volume work",level:"Intermediate",overview:"A volume-focused back session combining rows and isolation moves to build width and thickness. Focus on the mind-muscle connection.",tips:["Use moderate weight  feel the stretch and squeeze on every rep","On renegade rows, keep your hips square to the floor and avoid rotating","For reverse flys, use lighter weight and focus on squeezing your rear delts","Keep rest to 60-90 seconds to maintain intensity"],exercises:[{name:"Renegade Row",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/upper/renegade row.mp4"},{name:"Wide Dumbbell Bent Over Row",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Single Arm Bent Over Row",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Reverse Fly",type:"weighted",sets:3,reps:15,storagePath:null},{name:"Prone Y-T-W Raises",type:"reps",sets:3,reps:10,storagePath:null}]},{id:"back_endurance",name:"Back Endurance",desc:"Bodyweight back conditioning",level:"All Levels",overview:"A bodyweight session to strengthen your posterior chain and improve posture. Great for back health, mobility, and muscular endurance.",tips:["On superman holds, lift your arms and legs simultaneously and hold tight","Focus on slow, controlled movements  quality over speed","Breathe steadily throughout timed holds  don't hold your breath","Engage your glutes and lower back together on every movement"],exercises:[{name:"Superman Hold",type:"timed",sets:4,time:30,storagePath:"exercises/bodyweight/upper/Superman Hold.mp4"},{name:"Prone Y-T-W Raises",type:"reps",sets:3,reps:12,storagePath:null},{name:"Reverse Snow Angel",type:"reps",sets:3,reps:12,storagePath:null},{name:"Bird Dog",type:"reps",sets:3,reps:12,storagePath:"exercises/bodyweight/core/Bird Dog.mp4"},{name:"Back Extension Hold",type:"timed",sets:3,time:30,storagePath:null}]}],shoulders:[{id:"shoulders_strength",name:"Shoulder Strength",desc:"Heavy pressing for boulder shoulders",level:"Intermediate",overview:"A heavy overhead pressing session to build strong, powerful shoulders. Compound movements first, followed by isolation work for all three delt heads.",tips:["Go heavy on presses  pick a weight where you struggle on the last 2 reps","Brace your core and avoid arching your back during overhead movements","Press straight up and control the weight down slowly","Rest 90-120 seconds between pressing sets, 60 seconds for isolation moves"],exercises:[{name:"Seated Dumbbell Shoulder Press",type:"weighted",sets:4,reps:8,storagePath:"exercises/dumbbells/upper/seated dumbbell shoulder press.mp4"},{name:"Seated Dumbbell Arnold Press",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/upper/seated dumbbell arnold press.mp4"},{name:"Dumbbell Front Raise",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell front raise.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Dumbbell Shrug",type:"weighted",sets:3,reps:15,storagePath:null}]},{id:"shoulders_hypertrophy",name:"Shoulder Hypertrophy",desc:"Volume and isolation for 3D delts",level:"Intermediate",overview:"A high-volume session targeting all three heads of the deltoid for that 3D capped shoulder look. Moderate weight, high reps, constant tension.",tips:["Use lighter weight than you think  shoulders respond best to high reps","On lateral raises, lead with your elbows and don't swing the weight","Pause at the top of each raise for a 1-second squeeze","Keep rest periods at 60 seconds to maximise the pump"],exercises:[{name:"Seated Dumbbell Arnold Press",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/seated dumbbell arnold press.mp4"},{name:"Dumbbell Lateral Raise",type:"weighted",sets:4,reps:15,storagePath:"exercises/dumbbells/upper/dumbbell lateral raise.mp4"},{name:"Dumbbell Front Raise",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell front raise.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,reps:15,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Dumbbell Y-Raise",type:"weighted",sets:3,reps:12,storagePath:null}]},{id:"shoulders_endurance",name:"Shoulder Endurance",desc:"Bodyweight and high-rep work",level:"All Levels",overview:"A shoulder endurance session combining bodyweight movements with high-rep dumbbell work. Builds stamina, stability, and shoulder resilience.",tips:["On pike push ups, walk your feet close to your hands to increase the angle","For high-rep lateral raises, use a very light weight and focus on form","Wall walks are advanced  scale to pike push ups if needed","Keep your core braced throughout to protect your lower back"],exercises:[{name:"Pike Push Ups",type:"reps",sets:4,reps:12,storagePath:"exercises/bodyweight/upper/pike push ups.mp4"},{name:"Dumbbell Lateral Raise",type:"weighted",sets:3,reps:20,storagePath:"exercises/dumbbells/upper/dumbbell lateral raise.mp4"},{name:"Wall Walks",type:"reps",sets:3,reps:6,storagePath:null},{name:"Prone Y-T-W Raises",type:"reps",sets:3,reps:10,storagePath:null},{name:"Shoulder Tap Hold",type:"timed",sets:3,time:30,storagePath:null}]}],arms:[{id:"arms_bicep",name:"Bicep Focus",desc:"Curl variations for peak biceps",level:"All Levels",overview:"An arm session dedicated entirely to biceps. Multiple curl variations target different parts of the bicep for maximum peak and thickness.",tips:["Keep your elbows pinned to your sides  no swinging","Control the negative (lowering) for 2-3 seconds on every rep","Start with your heaviest weight and decrease as you fatigue","Squeeze hard at the top of each curl for a full contraction"],exercises:[{name:"Bicep Curl",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Hammer Curl",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/hammer curl.mp4"},{name:"Concentration Curl",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Wide Grip Bicep Curl",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Isometric Bicep Hold",type:"timed",sets:3,time:20,storagePath:null}]},{id:"arms_tricep",name:"Tricep Focus",desc:"Extensions and dips for horseshoe triceps",level:"All Levels",overview:"All-out tricep training with extensions, dips, and pressing movements. The triceps make up two-thirds of your arm  this session builds serious size.",tips:["On overhead extensions, keep your elbows close to your head","For skullcrushers, lower the weight slowly to just above your forehead","On dips, lean slightly forward to reduce shoulder strain","Full lockout at the top of every extension for maximum tricep contraction"],exercises:[{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Skullcrushers",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/skullcrushers.mp4"},{name:"Tricep Dips",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/upper/tricep dips.mp4"},{name:"Tricep Kickback",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Diamond Press Up",type:"reps",sets:3,reps:12,storagePath:null}]},{id:"arms_full",name:"Full Arms",desc:"Superset biceps and triceps",level:"All Levels",overview:"A balanced arm session alternating between biceps and triceps. Superset style keeps the intensity high and maximises the pump.",tips:["Superset each pair  do biceps then immediately hit triceps","Use moderate weight that lets you maintain strict form for all reps","Rest 60 seconds after each superset pair","Focus on the squeeze at the peak contraction of every rep"],exercises:[{name:"Bicep Curl",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Tricep Kickback",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Hammer Curl",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/hammer curl.mp4"},{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Wrist Curl",type:"weighted",sets:3,reps:15,storagePath:null}]}],legs:[{id:"legs_quad",name:"Quad Dominant",desc:"Squats and lunges for quad power",level:"All Levels",overview:"A quad-focused leg session built around squats and lunges. Heavy compound movements to build strong, powerful quads and overall leg strength.",tips:["On goblet squats, hold the dumbbell close to your chest and sit deep","Keep your knees tracking over your toes  don't let them cave inward","Drive through your heels on all squatting movements","Rest 90-120 seconds between heavy sets, 60 seconds on bodyweight moves"],exercises:[{name:"Dumbbell Goblet Squats",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Forward Dumbbell Lunges",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.mp4"},{name:"Dumbbell Squat Pulses",type:"weighted",sets:3,reps:15,storagePath:"exercises/dumbbells/lower/dumbbell squat pulses.mp4"},{name:"Bulgarian Split Squats",type:"reps",sets:3,reps:12,storagePath:"exercises/bodyweight/lower/bulgarian split squats.mp4"},{name:"Squat And Hold",type:"timed",sets:3,time:30,storagePath:"exercises/bodyweight/lower/squat and hold.mp4"}]},{id:"legs_ham_glute",name:"Hamstring & Glute",desc:"Posterior chain focus",level:"Intermediate",overview:"Target the back of your legs with deadlift and hip hinge variations. This session builds a strong posterior chain  hamstrings, glutes, and lower back.",tips:["On RDLs, push your hips back and feel the stretch in your hamstrings","Keep a slight bend in your knees throughout hip hinge movements","Squeeze your glutes hard at the top of every rep","For single leg work, start with your weaker side first"],exercises:[{name:"Romanian Deadlifts",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/lower/romanian deadlifts.mp4"},{name:"1 Legged RDL",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/lower/1 legged rdl.mp4"},{name:"Hip Thrusts",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/lower/hip thrusts.mp4"},{name:"Dumbbell Sumo Squats",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/dumbbell sumo squats.mp4"},{name:"Donkey Kicks",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/lower/donkey kicks.mp4"}]},{id:"legs_power",name:"Power & Plyo",desc:"Explosive leg training",level:"Intermediate",overview:"An explosive leg session combining plyometrics with weighted movements. Build power, speed, and athletic performance.",tips:["On jump squats, land softly with bent knees to absorb the impact","Explode up on every rep  power comes from speed, not just weight","Keep rest periods at 60-90 seconds to maintain intensity","Focus on landing mechanics  knees out, chest up, soft landing"],exercises:[{name:"Jump Squats",type:"reps",sets:4,reps:12,storagePath:"exercises/bodyweight/lower/jump squats.mp4"},{name:"Dumbbell Box Step Ups",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/dumbbell box step ups.mp4"},{name:"Skater Jumps",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/lower/skater jumps.mp4"},{name:"Dumbbell Reverse Lunges",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/dumbbell reverse lunges.mp4"},{name:"Weighted Calf Raises",type:"weighted",sets:4,reps:15,storagePath:"exercises/dumbbells/lower/weighted calf raises.mp4"}]}],core:[{id:"core_lower_abs",name:"Lower Abs Blast",desc:"40s work / 20s rest  3 rounds",level:"Intermediate",overview:"An interval-based core burner targeting the lower abdominals. 40 seconds of work followed by 20 seconds of rest  keep the intensity high and your lower back pressed into the floor throughout.",tips:["Press your lower back firmly into the floor on every rep","Exhale hard as you contract your abs  don't hold your breath","If your lower back lifts off the ground, reduce the range of motion","Focus on slow, controlled movements rather than speed"],interval:!0,rounds:3,work:40,rest:20,exercises:[{name:"Leg Raises",storagePath:"exercises/bodyweight/core/Leg Raises.mp4"},{name:"Reverse Crunch To Leg Raise",storagePath:"exercises/bodyweight/core/Reverse Crunch To Leg Raise.mp4"},{name:"Flutter Kicks",storagePath:"exercises/bodyweight/core/Flutter Kicks.mp4"},{name:"Dead Bug Single Leg Drop",storagePath:"exercises/bodyweight/core/Dead Bug Single Leg Drop.mp4"},{name:"Hollow Body Hold",storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"},{name:"Hollow Hold Flutter Kicks",storagePath:"exercises/bodyweight/core/Hollow Hold Flutter Kicks.mp4"}]},{id:"core_obliques",name:"Obliques & Rotation",desc:"35s work / 25s rest  3 rounds",level:"Intermediate",overview:"Target the obliques and rotational core muscles with this interval session. 35 seconds of work with 25 seconds rest  every exercise involves twisting, rotating, or side-bracing movements.",tips:["Rotate from your ribcage, not just your arms","Keep your hips as still as possible during twisting exercises","Brace your core before each movement  think about squeezing a belt","On side planks, stack your hips and push the floor away"],interval:!0,rounds:3,work:35,rest:25,exercises:[{name:"Russian Twist",storagePath:"exercises/bodyweight/core/Russian Twist.mp4"},{name:"Side Plank Rotation",storagePath:"exercises/bodyweight/core/Side Plank Rotation.mp4"},{name:"Cross Body Mountain Climbers",storagePath:"exercises/bodyweight/core/Cross Body Mountain Climbers.mp4"},{name:"Hip Dips Plank",storagePath:"exercises/bodyweight/core/Hip Dips Plank.mp4"},{name:"Bicycle Crunch",storagePath:"exercises/bodyweight/core/Bicycle Crunch.mp4"},{name:"Side Plank",storagePath:"exercises/bodyweight/core/Side Plank.mp4"}]},{id:"core_weighted",name:"Weighted Core",desc:"40s work / 20s rest  3 rounds",level:"Advanced",overview:"Add resistance to your core training with dumbbells and kettlebells. 40 seconds of weighted work followed by 20 seconds rest  this session builds serious core strength and stability.",tips:["Start with a moderate weight  form is more important than load","Brace your entire core before picking up the weight each round","Keep movements controlled  no swinging or using momentum","If grip fails before core does, go slightly lighter next time"],interval:!0,rounds:3,work:40,rest:20,exercises:[{name:"Russian Twists Dumbbell",storagePath:"exercises/dumbbells/core/russian twists dumbbell.mp4"},{name:"Kettlebell Russian Twist",storagePath:"exercises/kettlebells/core/kettlebell russian twist.mp4"},{name:"Kettlebell Side Bends",storagePath:"exercises/kettlebells/core/kettlebell side bends.mp4"},{name:"Kneeling Kettlebell Halo",storagePath:"exercises/kettlebells/core/kneeling kettlebell halo.mp4"},{name:"Kettlebell Bird Dog Drag",storagePath:"exercises/kettlebells/core/kettlebell bird dog drag.mp4"},{name:"Dumbbell Plank Pull Through",storagePath:null}]}]},R2=[{key:"bodyweight",label:"Bodyweight",icon:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 3c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm0 14.2c-2.5 0-4.71-1.28-6-3.22.03-1.99 4-3.08 6-3.08 1.99 0 5.97 1.09 6 3.08-1.29 1.94-3.5 3.22-6 3.22z"},{key:"dumbbells",label:"Dumbbells",icon:"M1 9h2v6H1V9zm3-2h2v10H4V7zm3 4h10v2H7v-2zm10-4h2v10h-2V7zm3 2h2v6h-2V9z"},{key:"kettlebells",label:"Kettlebells",icon:"M12 2C9.24 2 7 4.24 7 7c0 1.1.36 2.12.97 2.95C6.76 11.08 6 12.96 6 15c0 3.87 2.69 7 6 7s6-3.13 6-7c0-2.04-.76-3.92-1.97-5.05.61-.83.97-1.85.97-2.95 0-2.76-2.24-5-5-5zm0 2c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3z"}],Yp=[{key:"core",label:"Core",icon:"M12 2a4 4 0 0 1 4 4v1h-2V6a2 2 0 1 0-4 0v1H8V6a4 4 0 0 1 4-4zM8 9h8v2H8V9zm-1 4h10l-1 9H8l-1-9z"},{key:"upper",label:"Upper",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm8 10l-3-1.5c-.5-.25-1-.5-1.5-.5h-7c-.5 0-1 .25-1.5.5L4 12l-2 6h4l1.5 4h9L18 18h4l-2-6z"},{key:"lower",label:"Lower",icon:"M16.5 3A2.5 2.5 0 0 0 14 5.5 2.5 2.5 0 0 0 16.5 8 2.5 2.5 0 0 0 19 5.5 2.5 2.5 0 0 0 16.5 3zM14 9l-3 7h2l1 6h2l1-6h2l-3-7h-2z"},{key:"fullbody",label:"Full Body",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm-2 8h4l1 4h2l-1 4h-2l-1 4h-2l-1-4H8l-1-4h2l1-4z"},{key:"mix",label:"Mix It Up",icon:"M10.59 9.17L5.41 4 4 5.41l5.17 5.17 1.42-1.41zM14.5 4l2.04 2.04L4 18.59 5.41 20 17.96 7.46 20 9.5V4h-5.5zm-.83 9.41l-1.42 1.42L17.96 20.54l1.42-1.42-5.71-5.71z"}],Ol=[{key:"beginner",label:"Beginner",work:30,rest:30,desc:"30s work / 30s rest"},{key:"intermediate",label:"Intermediate",work:40,rest:20,desc:"40s work / 20s rest"},{key:"advanced",label:"Advanced",work:40,rest:15,desc:"40s work / 15s rest"}],Qp=[5,10,15,20,30];function zD(n){return n.replace(/\b\w/g,e=>e.toUpperCase())}function qD(n){const e=[...n];for(let t=e.length-1;t>0;t--){const i=Math.floor(Math.random()*(t+1));[e[t],e[i]]=[e[i],e[t]]}return e}function HD(){const{currentUser:n,isClient:e,clientData:t,loading:i}=Vr(),{isDark:l,toggleTheme:u,accent:d}=Ra(),{isPremium:p,FREE_RANDOMISER_DURATIONS:g,FREE_RANDOMISER_WEEKLY_LIMIT:y}=Gu(),x=lr(),[k,T]=v.useState("menu"),[O,G]=v.useState(["bodyweight"]),[F,V]=v.useState("core"),[te,Y]=v.useState("intermediate"),[ie,he]=v.useState(p?15:5),[Ne,fe]=v.useState([]),[R,E]=v.useState(!1),M=v.useRef(!1),B=v.useRef([]),[D,H]=v.useState([]),[I,ze]=v.useState(2),[mt,W]=v.useState(Ol[1]),[ue,Re]=v.useState(1),[Le,Z]=v.useState(0),[L,ne]=v.useState("work"),[Ie,de]=v.useState(0),[qe,Me]=v.useState(!1),[ot,ft]=v.useState(0),[Qe,Vt]=v.useState(!1),[Ls,jt]=v.useState(!1),[yt,re]=v.useState(null),Nt=v.useRef(null);v.useRef(null),v.useRef(null);const[vt,Pt]=v.useState(null),Et=v.useCallback((Q,ve="info")=>{Pt({message:Q,type:ve}),setTimeout(()=>Pt(null),3e3)},[]),ut=v.useCallback(async Q=>{if(!t)throw new Error("Not signed in");const ve=Q&&typeof Q=="object"&&Q.type;await ua(Ft(me,"posts"),{authorId:t.id,authorName:t.name||"Unknown",authorPhotoURL:t.photoURL||null,content:ve?"":Q,type:ve?Q.type:"text",imageURL:null,createdAt:yr(),likeCount:0,commentCount:0,...ve?{metadata:{title:Q.title||"",subtitle:Q.subtitle||"",stats:Q.stats||[],quote:Q.quote||"",badges:Q.badges||[]}}:{}})},[t]),[Ye,It]=v.useState(null),[Xt,Ks]=v.useState(null),[Ut,Mt]=v.useState(0),[is,Ms]=v.useState(0),[Kt,on]=v.useState([]),[ds,_s]=v.useState(""),[Ct,be]=v.useState(""),[Te,Be]=v.useState(!1),[Ue,J]=v.useState(0),[ge,We]=v.useState(!1),[Ke,z]=v.useState({}),se=v.useRef(null),Ge=v.useRef(null),[He,Xe]=v.useState([]),[lt,_t]=v.useState(null),[pt,Wt]=v.useState(0),[en,ts]=v.useState(0),[ks,zs]=v.useState(0),[$,we]=v.useState(0),[Se,Ee]=v.useState(0),[ke,dt]=v.useState(0),[bt,st]=v.useState({beginner:0,intermediate:0,advanced:0}),St=p?Qp:Qp.filter(Q=>g.includes(Q)),xt=!p&&pt>=y,[hs,Tn]=v.useState(null),[yn,Rn]=v.useState(""),[bn,rn]=v.useState(!1);v.useEffect(()=>{!i&&(!n||!e)&&x("/")},[n,e,i,x]),v.useEffect(()=>{if(!n||!t)return;(async()=>{try{const ve=Ft(me,"workoutLogs"),_e=Ps(ve,ps("clientId","==",t.id)),Je=(await Ss(_e)).docs.map(Jt=>Jt.data()),ct=Je.filter(Jt=>Jt.type!=="programme");we(ct.length);const Ht=ct.reduce((Jt,ln)=>Jt+(ln.duration||0),0);Ee(Ht);const $t={beginner:0,intermediate:0,advanced:0};ct.forEach(Jt=>{Jt.level&&$t[Jt.level]!==void 0&&$t[Jt.level]++}),st($t);const Yt=new Date,Mn=Yt.getDay(),Gt=Mn===0?-6:1-Mn,Vs=new Date(Yt);Vs.setDate(Yt.getDate()+Gt),Vs.setHours(0,0,0,0);const Us=Vs.getTime(),In=Je.filter(Jt=>{const ln=Jt.completedAt;return ln?(ln.toDate?ln.toDate().getTime():new Date(ln).getTime())>=Us:!1});Wt(In.filter(Jt=>Jt.type!=="programme").length);let Rs=0;if(t)try{const Jt=await As($e(me,"clientProgrammes",t.id));if(Jt.exists()){const ln=Jt.data(),pn=ln.templateId;Rs=In.filter(vn=>vn.type==="programme"&&vn.programmeId===pn).length,Tn(pn);const zn=Kp.find(vn=>vn.id===pn);zn&&Rn(zn.name);const Gn=UD[pn];if(Gn){const vn=Object.keys(ln.completedSessions||{}).length,Kn=Gn.duration*Gn.daysPerWeek;zs(Kn>0?Math.round(vn/Kn*100):0)}}else Tn(null),Rn(""),zs(0)}catch{}ts(Rs);const Ys=ct.map(Jt=>Jt.completedAt).filter(Boolean).map(Jt=>Jt.toDate?Jt.toDate().getTime():new Date(Jt).getTime()).sort((Jt,ln)=>ln-Jt);if(Ys.length===0)dt(0);else{const Jt=new Set;Ys.forEach(Kn=>{const cr=new Date(Kn),ur=cr.getDay(),dr=ur===0?-6:1-ur,Fr=new Date(cr);Fr.setDate(cr.getDate()+dr),Fr.setHours(0,0,0,0),Jt.add(Fr.getTime())});const ln=[...Jt].sort((Kn,cr)=>cr-Kn);let pn=0;const zn=new Date(Yt),Gn=Yt.getDay()===0?-6:1-Yt.getDay();zn.setDate(Yt.getDate()+Gn),zn.setHours(0,0,0,0);let vn=zn.getTime();ln.includes(vn)||(vn-=10080*60*1e3);for(let Kn=0;Kn<200&&ln.includes(vn);Kn++)pn++,vn-=10080*60*1e3;dt(pn)}}catch(ve){console.error("Error loading workout stats:",ve)}finally{rn(!0)}})()},[n,t,k]);const qs=()=>{const Q=[];let ve;F==="mix"?ve=["core","upper","lower"]:F==="fullbody"?ve=["upper","lower"]:ve=[F];for(const _e of O)for(const tt of ve)Q.push(`exercises/${_e}/${tt}`);return Q},j=async()=>{if(M.current){for(;M.current;)await new Promise(Q=>setTimeout(Q,200));return B.current}M.current=!0,E(!0);try{const Q=qs(),ve=[];for(const ct of Q)try{const Ht=so(no,ct),$t=await k2(Ht);ve.push(...$t.items)}catch{console.warn(`Folder ${ct} not found, skipping.`)}if(ve.length===0&&O.includes("bodyweight")&&F==="core")try{const ct=so(no,"core"),Ht=await k2(ct);ve.push(...Ht.items)}catch{console.warn("Legacy core/ folder not found either.")}if(ve.length===0){const ct=O.map($t=>R2.find(Yt=>Yt.key===$t)?.label).join(" + "),Ht=Yp.find($t=>$t.key===F)?.label;return Et(`No exercises found for ${ct} / ${Ht}. Upload videos to Firebase Storage.`,"error"),M.current=!1,E(!1),[]}const _e=new Set,tt=ve.filter(ct=>{const Ht=ct.name.replace(/\.(mp4|gif)$/i,"");return _e.has(Ht)?!1:(_e.add(Ht),!0)}),Je=await Promise.all(tt.map(async ct=>{const Ht=await Wo(ct),$t=zD(ct.name.replace(/\.(mp4|gif)$/i,"")),Yt=/\.gif$/i.test(ct.name);return{name:$t,videoUrl:Ht,isGif:Yt}}));return B.current=Je,fe(Je),M.current=!1,E(!1),Je}catch(Q){console.error("Error loading exercises:",Q);const ve=Q.code==="storage/unauthorized"?"Storage access denied. Check Firebase Storage rules allow read access.":`Failed to load exercises: ${Q.message||Q.code||"Unknown error"}`;return Et(ve,"error"),M.current=!1,E(!1),[]}},C=async()=>{if(xt)return;T("spinning"),B.current=[];const Q=await j();if(Q.length===0){T("setup");return}const ve=Ol.find(Mn=>Mn.key===te);W(ve);const _e=ve.work+ve.rest,tt=ie*60,Je=Math.floor(tt/_e);let ct,Ht;Je<=6?(ct=Math.max(3,Math.floor(Je/2)),Ht=Math.floor(Je/ct)):Je<=12?(ct=Math.min(6,Math.floor(Je/2)),Ht=Math.floor(Je/ct)):(ct=Math.min(10,Math.floor(Je/2)),Ht=Math.floor(Je/ct)),Ht=Math.max(2,Ht);const $t=qD(Q),Yt=$t.slice(0,Math.min(ct,$t.length));H(Yt),ze(Ht),setTimeout(()=>T("preview"),2e3)},P=()=>{T("countdown"),ft(3)};v.useEffect(()=>{if(k!=="countdown")return;if(ot<=0){T("workout"),Re(1),Z(0),ne("work"),de(mt.work),Me(!1),Ur();return}fn();const Q=setTimeout(()=>ft(ve=>ve-1),1e3);return()=>clearTimeout(Q)},[ot,k]),v.useEffect(()=>{if(k!=="workout"||qe)return;if(Ie<=0){U();return}Ie<=3&&fn();const Q=setTimeout(()=>de(ve=>ve-1),1e3);return()=>clearTimeout(Q)},[Ie,k,qe]);const U=()=>{if(L==="work")ne("rest"),de(mt.rest);else{const Q=Le+1;if(Q>=D.length){const ve=ue+1;if(ve>I){Vt(!0),ye();return}Re(ve),Z(0)}else Z(Q);ne("work"),de(mt.work),Ur()}},ye=async()=>{if(n)try{await ua(Ft(me,"workoutLogs"),{clientId:t.id,level:te,duration:ie,equipment:O,focus:F,exerciseCount:D.length,rounds:I,exercises:D.map(Q=>Q.name),completedAt:kt.now()}),Wt(Q=>Q+1),we(Q=>Q+1),Ee(Q=>Q+ie),st(Q=>({...Q,[te]:(Q[te]||0)+1}))}catch(Q){console.error("Error saving workout log:",Q)}},Ve=async(Q,ve,_e)=>{if(!(!t||!ve))try{const tt=t.id,Je=await As($e(me,"coreBuddyPBs",tt)),Ht=(Je.exists()?Je.data():null)?.exercises||{},$t=Ht[Q];let Yt=!1;if($t?(ve>($t.weight||0)||ve===($t.weight||0)&&_e>($t.reps||0))&&(Yt=!0):Yt=!0,Yt){const Mn={...Ht,[Q]:{weight:ve,reps:_e,achievedAt:kt.now()}};await Ns($e(me,"coreBuddyPBs",tt),{clientId:t.id,exercises:Mn,updatedAt:kt.now()}),Et(`New PB! ${ve}kg  ${_e} reps`,"success"),fn(),await Oe(Q,ve)}}catch(tt){console.error("Error checking PB:",tt)}},Oe=async(Q,ve)=>{if(t)try{const _e=await As($e(me,"coreBuddyTargets",t.id));if(!_e.exists())return;const Je=(_e.data().targets||{})[Q];if(!Je||ve<Je.targetWeight)return;const ct=await As($e(me,"coreBuddyAchievements",t.id)),Ht=ct.exists()?ct.data():{clientId:t.id,badges:[],totalVolume:0};if(Ht.badges.some(Gt=>Gt.type==="pb_target"&&Gt.exercise===Q&&Gt.targetWeight===Je.targetWeight))return;const Yt={type:"pb_target",exercise:Q,group:VD[Q]||"push",targetWeight:Je.targetWeight,achievedAt:kt.now()},Mn=[...Ht.badges,Yt];await Ns($e(me,"coreBuddyAchievements",t.id),{...Ht,badges:Mn,updatedAt:kt.now()}),Xe(Gt=>[...Gt,Yt])}catch(_e){console.error("Error checking target badge:",_e)}},et=async Q=>{if(!(!t||Q<=0))try{const ve=await As($e(me,"coreBuddyAchievements",t.id)),_e=ve.exists()?ve.data():{clientId:t.id,badges:[],totalVolume:0},tt=_e.totalVolume||0,Je=tt+Q,ct=[];BD.forEach($t=>{Je>=$t.threshold&&tt<$t.threshold&&(_e.badges.some(Mn=>Mn.type==="volume_milestone"&&Mn.milestone===$t.threshold)||ct.push({type:"volume_milestone",milestone:$t.threshold,label:$t.label,achievedAt:kt.now()}))});const Ht=[..._e.badges,...ct];await Ns($e(me,"coreBuddyAchievements",t.id),{clientId:t.id,badges:Ht,totalVolume:Math.round(Je),updatedAt:kt.now()}),ct.length>0&&Xe($t=>[...$t,...ct])}catch(ve){console.error("Error updating volume:",ve)}},nt=async Q=>{if(Ks(Q),Q.interval){const tt=[];for(const Je of Q.exercises){let ct=null,Ht=!1;if(Je.storagePath)try{const $t=so(no,Je.storagePath);ct=await Wo($t),Ht=/\.gif$/i.test(Je.storagePath)}catch{}tt.push({name:Je.name,videoUrl:ct,isGif:Ht})}H(tt),ze(Q.rounds),W({work:Q.work,rest:Q.rest}),T("preview");return}const ve={};for(const tt of Q.exercises)if(tt.storagePath)try{const Je=so(no,tt.storagePath);ve[tt.name]={url:await Wo(Je),isGif:/\.gif$/i.test(tt.storagePath)}}catch{}z(ve);const _e=Q.exercises.map(tt=>({name:tt.name,type:tt.type,targetSets:tt.sets,targetReps:tt.reps||0,targetTime:tt.time||0,sets:[]}));on(_e),Mt(0),Ms(0),_s(""),be(""),We(!1),Be(!1),J(0),Xe([]),_t(null),T("muscle_workout")},as=()=>{const Q=se.current;Q&&(Q.paused?(Q.play(),We(!0)):(Q.pause(),We(!1)))};v.useEffect(()=>{if(k!=="muscle_workout"||!Te||Ue<=0){k==="muscle_workout"&&Te&&Ue<=0&&(Be(!1),fn());return}return Ge.current=setTimeout(()=>J(Q=>Q-1),1e3),()=>clearTimeout(Ge.current)},[k,Te,Ue]);const Cs=async()=>{const Q=Kt[Ut];let ve={};if(Q.type==="weighted"){const Je=parseFloat(ds)||0,ct=parseInt(Ct)||0;if(ct===0){Et("Enter your reps","error");return}ve={weight:Je,reps:ct}}else if(Q.type==="reps"){const Je=parseInt(Ct)||0;if(Je===0){Et("Enter your reps","error");return}ve={reps:Je}}else if(Q.type==="timed"){const Je=Q.targetTime-Ue;ve={time:Math.max(Je,1)}}const _e=[...Kt];_e[Ut]={...Q,sets:[...Q.sets,ve]},on(_e),Q.type==="weighted"&&ve.weight>0&&await Ve(Q.name,ve.weight,ve.reps);const tt=Q.sets.length+1;if(tt<Q.targetSets)Ms(tt),be(""),Be(!1),J(0);else if(Ut+1<Kt.length){const Je=Ut+1;Mt(Je),Ms(0),_s(""),be(""),We(!1),Be(!1),J(0)}else await ls(_e),jt(!0)},ls=async Q=>{if(!(!n||!t))try{const ve=Q.reduce((tt,Je)=>tt+Je.sets.reduce((ct,Ht)=>ct+(Ht.weight||0)*(Ht.reps||0),0),0),_e=Q.reduce((tt,Je)=>tt+Je.sets.length,0);await ua(Ft(me,"workoutLogs"),{clientId:t.id,type:"muscle_group",muscleGroup:Ye,sessionId:Xt?.id,sessionName:Xt?.name,exerciseCount:Q.length,totalSets:_e,duration:Math.round(_e*1.5),volume:Math.round(ve),exercises:Q.map(tt=>({name:tt.name,type:tt.type,sets:tt.sets})),completedAt:kt.now()}),ve>0&&await et(ve),He.length>0&&_t({badges:[...He]})}catch(ve){console.error("Error saving muscle group workout log:",ve)}},cs=v.useRef(null),Hs=()=>(cs.current||(cs.current=new(window.AudioContext||window.webkitAudioContext)),cs.current),fn=()=>{try{const Q=Hs(),ve=Q.createOscillator(),_e=Q.createGain();ve.connect(_e),_e.connect(Q.destination),ve.frequency.value=880,_e.gain.value=.3,ve.start(Q.currentTime),ve.stop(Q.currentTime+.15)}catch{}},Ur=()=>{try{const Q=Hs(),ve=Q.createOscillator(),_e=Q.createGain();ve.connect(_e),_e.connect(Q.destination),ve.frequency.value=1200,_e.gain.value=.4,ve.start(Q.currentTime),ve.stop(Q.currentTime+.3)}catch{}};v.useEffect(()=>{if(k!=="workout"||L!=="work"||!D[Le]?.isGif)return;const ve=setInterval(()=>{const _e=Nt.current;if(!_e)return;const tt=_e.getAttribute("src");_e.removeAttribute("src"),setTimeout(()=>{Nt.current&&Nt.current.setAttribute("src",tt)},0)},4e3);return()=>clearInterval(ve)},[k,L,Le,ue,D]);const gs=(Q,ve,_e)=>{const tt=Math.round(Q/ve*OD);return r.jsx("svg",{className:"wk-ring-svg",viewBox:"0 0 200 200",children:rD.map((Je,ct)=>r.jsx("line",{x1:Je.x1,y1:Je.y1,x2:Je.x2,y2:Je.y2,className:ct<tt?`wk-tick-filled ${_e}`:"wk-tick-empty",strokeWidth:Je.thick?"3":"2"},ct))})},Cr=()=>{const Q=D.length*I;return((ue-1)*D.length+Le+(L==="rest"?.5:0))/Q},An=vt&&r.jsx("div",{className:`toast-notification ${vt.type}`,children:vt.message});if(i)return r.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>x("/client/core-buddy"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})]})}),r.jsx("div",{className:"wk-loading-inline",children:r.jsx("div",{className:"wk-loading-spinner"})})]});if(k==="menu")return r.jsx(Sa,{children:r.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>x("/client/core-buddy"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),r.jsxs("main",{className:"wk-main",children:[r.jsxs("div",{className:"wk-menu-heading",children:[r.jsx("h2",{children:"Choose Your Workout"}),r.jsx("p",{children:"No excuses. Just results."})]}),r.jsx("button",{className:"wk-hero-card",onClick:()=>T("setup"),children:r.jsx("img",{src:N2,alt:"Randomise Workout",className:"wk-hero-bg"})}),r.jsxs("div",{className:"wk-section-header",children:[r.jsxs("h2",{children:["Programmes ",!p&&r.jsx("span",{className:"cb-premium-badge",children:"PREMIUM"})]}),r.jsxs("span",{className:"wk-section-count",children:[Kp.length," available"]})]}),p?r.jsx("div",{className:"wk-prog-scroll-wrap",children:r.jsx("div",{className:"wk-prog-scroll",children:Kp.map((Q,ve)=>Q.image?r.jsxs("button",{className:"wk-prog-img-card",onClick:()=>x("/client/core-buddy/programmes",{state:{templateId:Q.id}}),style:{animationDelay:`${ve*.06}s`},children:[r.jsx("img",{src:Q.image,alt:Q.name,className:"wk-prog-img"}),ve===0&&r.jsx("div",{className:"wk-swipe-arrow",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})})]},Q.id):r.jsxs("button",{className:"wk-prog-hero-card",onClick:()=>x("/client/core-buddy/programmes",{state:{templateId:Q.id}}),style:{animationDelay:`${ve*.06}s`},children:[r.jsx("img",{src:DD,alt:"Programme",className:"wk-prog-hero-bg",loading:"lazy"}),r.jsx("div",{className:"wk-prog-hero-overlay",style:{background:FD[Q.focus]}}),r.jsxs("div",{className:"wk-prog-hero-content",children:[r.jsxs("div",{className:"wk-prog-hero-top",children:[r.jsxs("span",{className:"wk-prog-hero-badge",children:[Q.duration," WEEKS"]}),r.jsx("span",{className:"wk-prog-hero-level",children:Q.level})]}),r.jsxs("div",{className:"wk-prog-hero-bottom",children:[r.jsx("h3",{children:Q.name.toUpperCase()}),r.jsxs("p",{children:[Q.daysPerWeek,"x per week  ",Q.focus==="fullbody"?"Full Body":Q.focus.charAt(0).toUpperCase()+Q.focus.slice(1)," Focus"]}),r.jsx("span",{className:"wk-prog-hero-go",children:"VIEW PROGRAMME "})]})]}),ve===0&&r.jsx("div",{className:"wk-swipe-arrow",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})})]},Q.id))})}):r.jsxs("button",{className:"cb-upgrade-teaser",onClick:()=>x("/upgrade"),children:[r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),r.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}),r.jsx("span",{children:"Upgrade to unlock programmes"})]}),r.jsxs("div",{className:"wk-section-header",children:[r.jsxs("h2",{children:["Muscle Groups ",!p&&r.jsx("span",{className:"cb-premium-badge",children:"PREMIUM"})]}),r.jsxs("span",{className:"wk-section-count",children:[su.length," groups"]})]}),p?r.jsx("div",{className:"wk-muscle-grid",children:su.map((Q,ve)=>r.jsx("button",{className:`wk-muscle-hero-card${Q.image?" wk-muscle-thumb":""}`,onClick:()=>{It(Q.key),T("muscle_sessions")},style:{animationDelay:`${ve*.05}s`},children:Q.image?r.jsx("img",{src:Q.image,alt:Q.label,className:"wk-muscle-thumb-img"}):r.jsxs(r.Fragment,{children:[r.jsx("img",{src:N2,alt:"Muscle group",className:"wk-muscle-hero-bg",loading:"lazy"}),r.jsx("div",{className:"wk-muscle-hero-overlay",style:{background:Gp[Q.key]}}),r.jsxs("div",{className:"wk-muscle-hero-content",children:[r.jsx("div",{className:"wk-muscle-hero-icon",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:Q.icon})})}),r.jsxs("div",{className:"wk-muscle-hero-text",children:[r.jsx("span",{className:"wk-muscle-hero-name",children:Q.label}),r.jsxs("span",{className:"wk-muscle-hero-count",children:[C2[Q.key]?.length||0," sessions"]})]})]})]})},Q.key))}):r.jsxs("button",{className:"cb-upgrade-teaser",onClick:()=>x("/upgrade"),children:[r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),r.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}),r.jsx("span",{children:"Upgrade to unlock muscle group workouts"})]})]}),r.jsx(ha,{active:"workouts"}),An]})});if(k==="setup"){const Q=Yp.find(_e=>_e.key===F)?.label||F,ve=Ol.find(_e=>_e.key===te)?.label||te;return r.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>T("menu"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),r.jsxs("main",{className:"wk-main wk-setup-main",children:[r.jsx("div",{className:"wk-stats-row",children:[{label:"Total",value:`${$}`,pct:$>0?Math.min(Math.round($/100*100),100):0,color:"#14b8a6",size:"normal"},{label:"This Week",value:`${pt}/${Wp}`,pct:Math.round(Math.min(pt,Wp)/Wp*100),color:"var(--color-primary)",size:"large"},{label:"Wk Streak",value:`${ke}`,pct:ke>0?Math.min(Math.round(ke/12*100),100):0,color:"#38B6FF",size:"normal"}].map(_e=>{const Je=2*Math.PI*38,ct=Je-_e.pct/100*Je;return r.jsxs("div",{className:`wk-stat-item${_e.size==="large"?" wk-stat-large":""}`,children:[r.jsxs("div",{className:"wk-stat-ring",children:[r.jsxs("svg",{viewBox:"0 0 100 100",children:[r.jsx("circle",{className:"wk-stat-track",cx:"50",cy:"50",r:38}),r.jsx("circle",{className:"wk-stat-fill",cx:"50",cy:"50",r:38,style:{stroke:_e.color},strokeDasharray:Je,strokeDashoffset:ct})]}),r.jsx("span",{className:"wk-stat-value",style:{color:_e.color},children:_e.value})]}),r.jsx("span",{className:"wk-stat-label",children:_e.label})]},_e.label)})}),r.jsxs("div",{className:"wk-setup-flow",children:[r.jsxs("div",{className:"wk-setup-section",children:[r.jsx("h2",{children:"Focus Area"}),r.jsx("div",{className:"wk-focus-grid",children:Yp.map(_e=>r.jsxs("button",{className:`wk-equip-btn${F===_e.key?" active":""}${_e.key==="mix"?" wk-mix-btn":""}`,onClick:()=>V(_e.key),children:[r.jsx("svg",{className:"wk-equip-icon",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:_e.icon})}),r.jsx("span",{children:_e.label})]},_e.key))})]}),r.jsxs("div",{className:"wk-setup-section",children:[r.jsx("h2",{children:"Level"}),r.jsx("div",{className:"wk-level-cards",children:Ol.map(_e=>r.jsxs("button",{className:`wk-level-card wk-level-${_e.key}${te===_e.key?" active":""}`,onClick:()=>Y(_e.key),children:[r.jsx("span",{className:"wk-level-name",children:_e.label}),r.jsx("span",{className:"wk-level-desc",children:_e.desc})]},_e.key))})]}),r.jsxs("div",{className:"wk-setup-section",children:[r.jsx("h2",{children:"Time"}),r.jsx("div",{className:"wk-time-options",children:Qp.map(_e=>{const tt=!St.includes(_e);return r.jsxs("button",{className:`wk-time-btn${ie===_e?" active":""}${tt?" locked":""}`,onClick:()=>!tt&&he(_e),disabled:tt,children:[r.jsx("span",{className:"wk-time-num",children:_e}),r.jsx("span",{className:"wk-time-unit",children:tt?r.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),r.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}):"min"})]},_e)})})]}),r.jsxs("div",{className:"wk-setup-section",children:[r.jsx("h2",{children:"Equipment"}),r.jsx("div",{className:"wk-equip-options",children:R2.map(_e=>{const tt=O.includes(_e.key);return r.jsxs("button",{className:`wk-equip-btn${tt?" active":""}`,onClick:()=>{G(Je=>tt&&Je.length===1?Je:tt?Je.filter(ct=>ct!==_e.key):[...Je,_e.key])},children:[r.jsx("svg",{className:"wk-equip-icon",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:_e.icon})}),r.jsx("span",{children:_e.label})]},_e.key)})})]}),r.jsx("div",{className:"wk-setup-summary",children:r.jsxs("span",{children:[Q,"  ",ve,"  ",ie," min"]})})]})]}),r.jsxs("div",{className:"wk-go-sticky",children:[xt&&r.jsx("p",{className:"wk-free-limit-msg",children:"You've used your free workout this week. Upgrade for unlimited access."}),r.jsx("button",{className:"wk-randomise-btn",onClick:C,disabled:R||xt,children:R?"Loading exercises...":xt?"Limit Reached":"Randomise Workout"})]}),An]})}if(k==="spinning")return r.jsxs("div",{className:"wk-page wk-page-center","data-theme":l?"dark":"light","data-accent":d,children:[r.jsxs("div",{className:"wk-spin-container",children:[r.jsxs("div",{className:"wk-spin-ring",children:[r.jsx("svg",{className:"wk-spin-svg",viewBox:"0 0 200 200",children:Hk.map((Q,ve)=>r.jsx("line",{x1:Q.x1,y1:Q.y1,x2:Q.x2,y2:Q.y2,className:"wk-spin-tick",strokeWidth:Q.thick?"3.5":"2",style:{animationDelay:`${ve*.03}s`}},ve))}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"wk-spin-logo",width:"50",height:"50"})]}),r.jsx("p",{className:"wk-spin-text",children:"Generating workout..."})]}),An]});if(k==="preview"){const Q=Xt?.interval?{work:Xt.work,rest:Xt.rest}:Ol.find(_e=>_e.key===te),ve=D.length*I*(Q.work+Q.rest);return r.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>T(Xt?.interval?"muscle_sessions":"setup"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),r.jsxs("main",{className:"wk-main",children:[Xt?.interval&&r.jsx("h2",{className:"mg-preview-title",children:Xt.name}),r.jsxs("div",{className:"wk-preview-stats",children:[r.jsxs("div",{className:"wk-stat",children:[r.jsx("span",{className:"wk-stat-val",children:D.length}),r.jsx("span",{className:"wk-stat-label",children:"Exercises"})]}),r.jsxs("div",{className:"wk-stat",children:[r.jsx("span",{className:"wk-stat-val",children:I}),r.jsx("span",{className:"wk-stat-label",children:"Rounds"})]}),r.jsxs("div",{className:"wk-stat",children:[r.jsx("span",{className:"wk-stat-val",children:Math.ceil(ve/60)}),r.jsx("span",{className:"wk-stat-label",children:"Minutes"})]}),r.jsxs("div",{className:"wk-stat",children:[r.jsxs("span",{className:"wk-stat-val",children:[Q.work,"/",Q.rest]}),r.jsx("span",{className:"wk-stat-label",children:"Work/Rest"})]})]}),r.jsx("div",{className:"wk-preview-list",children:D.map((_e,tt)=>r.jsxs("div",{className:"wk-preview-item",style:{animationDelay:`${tt*.06}s`},onClick:()=>re(_e),children:[r.jsx("span",{className:"wk-preview-num",children:tt+1}),r.jsx("div",{className:"wk-preview-thumb",children:_e.isGif?r.jsx("img",{src:_e.videoUrl,alt:_e.name,loading:"lazy"}):r.jsx("video",{src:`${_e.videoUrl}#t=0.1`,muted:!0,playsInline:!0,preload:"auto"})}),r.jsx("span",{className:"wk-preview-name",children:_e.name}),r.jsx("svg",{className:"wk-preview-play",width:"22",height:"22",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})})]},tt))}),yt&&r.jsx("div",{className:"wk-preview-modal-backdrop",onClick:()=>re(null),children:r.jsxs("div",{className:"wk-preview-modal",onClick:_e=>_e.stopPropagation(),children:[r.jsx("button",{className:"wk-preview-modal-close",onClick:()=>re(null),"aria-label":"Close preview",children:r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})}),r.jsx("div",{className:"wk-preview-modal-video",children:yt.isGif?r.jsx("img",{src:yt.videoUrl,alt:yt.name}):r.jsx("video",{src:yt.videoUrl,autoPlay:!0,loop:!0,muted:!0,playsInline:!0})}),r.jsx("h3",{className:"wk-preview-modal-title",children:yt.name})]})}),r.jsxs("div",{className:"wk-preview-actions",children:[!Xt?.interval&&r.jsxs("button",{className:"wk-btn-secondary",onClick:()=>C(),children:[r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("polyline",{points:"1 4 1 10 7 10"}),r.jsx("path",{d:"M3.51 15a9 9 0 1 0 2.13-9.36L1 10"})]}),"Reshuffle"]}),r.jsx("button",{className:"wk-btn-primary",onClick:P,children:"Start Workout"})]})]})]})}if(k==="countdown")return r.jsx("div",{className:"wk-page wk-page-center wk-page-dark","data-theme":l?"dark":"light","data-accent":d,children:r.jsxs("div",{className:"wk-countdown-big",children:[r.jsx("span",{className:"wk-countdown-num",children:ot}),r.jsx("span",{className:"wk-countdown-label",children:"GET READY"})]})});if(k==="workout"){const Q=D[Le],ve=L==="work"?mt.work:mt.rest,_e=L==="rest"?Le+1<D.length?D[Le+1]:ue<I?D[0]:null:null;return r.jsxs("div",{className:"wk-page wk-page-workout","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("div",{className:"wk-video-container",children:L==="work"?Q.isGif?r.jsx("img",{ref:Nt,className:"wk-video",src:Q.videoUrl,alt:Q.name},Q.videoUrl):r.jsx("video",{className:"wk-video",src:Q.videoUrl,autoPlay:!0,loop:!0,muted:!0,playsInline:!0},Q.videoUrl):r.jsxs("div",{className:"wk-rest-screen",children:[r.jsx("span",{className:"wk-rest-label",children:"REST"}),_e&&r.jsxs("span",{className:"wk-next-label",children:["Next: ",_e.name]})]})}),r.jsx("div",{className:"wk-back-row",children:r.jsxs("button",{className:"wk-back-btn",onClick:()=>{confirm("Leave workout?")&&T("menu")},children:[r.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})}),"Back"]})}),r.jsx("div",{className:"wk-spotify",children:r.jsx("iframe",{src:"https://open.spotify.com/embed/playlist/37i9dQZF1DZ06evO3FJyYF?utm_source=generator&theme=0",width:"100%",height:"80",frameBorder:"0",allow:"autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture",loading:"lazy",title:"Spotify Playlist"})}),r.jsxs("div",{className:"wk-exercise-info",children:[r.jsxs("span",{className:"wk-exercise-counter",children:[Le+1," / ",D.length]}),r.jsx("h2",{className:"wk-exercise-name",children:Q.name}),r.jsxs("span",{className:"wk-round-label",children:["Round ",ue," of ",I]})]}),r.jsx("div",{className:"wk-timer-section",children:r.jsxs("div",{className:"wk-timer-ring-wrap",children:[gs(Ie,ve,L==="work"?"wk-tick-work":"wk-tick-rest"),r.jsxs("div",{className:"wk-timer-center",children:[r.jsx("span",{className:"wk-timer-time",children:Ie}),r.jsx("span",{className:`wk-timer-phase ${L}`,children:L==="work"?"WORK":"REST"})]})]})}),r.jsxs("div",{className:"wk-controls",children:[r.jsx("button",{className:"wk-ctrl-btn wk-ctrl-stop",onClick:()=>{confirm("End workout early?")&&T("menu")},children:r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("rect",{x:"4",y:"4",width:"16",height:"16",rx:"2"})})}),r.jsx("button",{className:"wk-ctrl-btn wk-ctrl-pause",onClick:()=>Me(!qe),children:qe?r.jsx("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})}):r.jsxs("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"currentColor",children:[r.jsx("rect",{x:"6",y:"4",width:"4",height:"16"}),r.jsx("rect",{x:"14",y:"4",width:"4",height:"16"})]})}),r.jsx("button",{className:"wk-ctrl-btn wk-ctrl-skip",onClick:()=>{de(0)},children:r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:[r.jsx("polygon",{points:"5 4 15 12 5 20 5 4"}),r.jsx("rect",{x:"15",y:"4",width:"4",height:"16"})]})})]}),r.jsx("div",{className:"wk-progress-bar",children:r.jsx("div",{className:"wk-progress-fill",style:{width:`${Cr()*100}%`}})}),Qe&&(()=>{const tt=Ol.find(ct=>ct.key===te),Je=D.length*I*(tt.work+tt.rest);return r.jsx(Qh,{title:"Workout Complete!",stats:[{value:Math.ceil(Je/60),label:"Minutes"},{value:D.length*I,label:"Intervals"},{value:I,label:"Rounds"}],onShareJourney:t?ut:null,userName:t?.name,onDismissStart:()=>T("menu"),onDone:()=>{Vt(!1),Ks(null),It(null)}})})()]})}if(k==="muscle_sessions"){const Q=su.find(_e=>_e.key===Ye),ve=C2[Ye]||[];return r.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>T("menu"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),r.jsxs("main",{className:"wk-main",children:[r.jsxs("div",{className:"mg-sessions-header",children:[r.jsx("div",{className:"mg-sessions-icon",style:{background:Gp[Ye]},children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:Q?.icon})})}),r.jsxs("h2",{children:[Q?.label," Workouts"]}),r.jsxs("p",{children:[ve.length," sessions available"]})]}),r.jsx("div",{className:"mg-sessions-list",children:ve.map((_e,tt)=>r.jsxs("button",{className:"mg-session-card",onClick:()=>{Ks(_e),T("muscle_overview")},style:{animationDelay:`${tt*.08}s`},children:[r.jsxs("div",{className:"mg-session-info",children:[r.jsx("h3",{children:_e.name}),r.jsx("p",{children:_e.desc}),r.jsx("div",{className:"mg-session-meta",children:_e.interval?r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"mg-session-tag mg-tag-interval",children:"Interval"}),r.jsxs("span",{className:"mg-session-tag",children:[_e.exercises.length," exercises"]}),r.jsxs("span",{className:"mg-session-tag",children:[_e.rounds," rounds"]})]}):r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"mg-session-tag mg-tag-strength",children:"Strength"}),r.jsxs("span",{className:"mg-session-tag",children:[_e.exercises.length," exercises"]}),r.jsx("span",{className:"mg-session-tag",children:(()=>{const Je=_e.exercises.map($t=>$t.sets||0),ct=Math.min(...Je),Ht=Math.max(...Je);return ct===Ht?`${ct} sets each`:`${ct}-${Ht} sets each`})()})]})})]}),r.jsx("div",{className:"mg-session-arrow",children:r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})})]},_e.id))})]}),An]})}if(k==="muscle_overview"){const Q=Xt;if(!Q)return null;const ve=su.find(_e=>_e.key===Ye);return r.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>T("muscle_sessions"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),r.jsxs("main",{className:"wk-main mg-overview-main",children:[r.jsx("div",{className:"mg-overview-hero",style:{background:Gp[Ye]},children:r.jsx("div",{className:"mg-overview-hero-content",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",className:"mg-overview-hero-icon",children:r.jsx("path",{d:ve?.icon})})})}),r.jsxs("div",{className:"mg-overview-header",children:[r.jsxs("div",{className:"mg-overview-title-row",children:[r.jsx("h2",{children:Q.name}),Q.level&&r.jsx("span",{className:"mg-overview-level",children:Q.level})]}),r.jsx("p",{className:"mg-overview-desc",children:Q.desc})]}),Q.overview&&r.jsxs("div",{className:"mg-overview-section",children:[r.jsxs("h3",{children:[r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("path",{d:"M12 16v-4M12 8h.01"})]}),"About This Workout"]}),r.jsx("p",{children:Q.overview})]}),Q.tips&&Q.tips.length>0&&r.jsxs("div",{className:"mg-overview-section",children:[r.jsxs("h3",{children:[r.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 1 1 7.072 0l-.548.547A3.374 3.374 0 0 0 14 18.469V19a2 2 0 1 1-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),"Tips & Form"]}),r.jsx("ul",{className:"mg-overview-tips",children:Q.tips.map((_e,tt)=>r.jsx("li",{children:_e},tt))})]}),r.jsxs("div",{className:"mg-overview-section",children:[r.jsxs("h3",{children:[r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M9 5H7a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-2"}),r.jsx("rect",{x:"9",y:"3",width:"6",height:"4",rx:"1"}),r.jsx("path",{d:"M9 14l2 2 4-4"})]}),"Exercises (",Q.exercises.length,")"]}),r.jsx("div",{className:"mg-overview-exercises",children:Q.exercises.map((_e,tt)=>r.jsxs("div",{className:"mg-overview-exercise",children:[r.jsx("span",{className:"mg-overview-ex-num",children:tt+1}),r.jsxs("div",{className:"mg-overview-ex-info",children:[r.jsx("span",{className:"mg-overview-ex-name",children:_e.name}),Q.interval?r.jsxs("span",{className:"mg-overview-ex-detail",children:[Q.work,"s work / ",Q.rest,"s rest"]}):r.jsxs("span",{className:"mg-overview-ex-detail",children:[_e.sets," sets  ",_e.reps?`${_e.reps} reps`:`${_e.time}s`,_e.type==="weighted"&&"  weighted"]})]})]},tt))})]}),r.jsxs("button",{className:"mg-overview-start-btn",onClick:()=>nt(Q),children:[r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M8 5v14l11-7z"})}),"Start Workout"]})]}),An]})}if(k==="muscle_workout"){const Q=Xt;if(!Q)return null;const ve=Q.exercises[Ut],_e=Kt[Ut];if(!ve||!_e)return null;const tt=_e.sets.length,Je=Q.exercises.length,ct=Q.exercises.reduce((Gt,Vs)=>Gt+(Vs.sets||0),0),$t=Kt.reduce((Gt,Vs)=>Gt+Vs.sets.length,0)/ct*100,Yt=Ke[ve.name];ve.type==="timed"&&Ue===0&&!Te&&tt===is&&setTimeout(()=>J(ve.time),0);const Mn=tt+1<ve.sets?"Log Set":Ut+1<Je?"Log Set  Next Exercise":"Log Set  Complete";return r.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("div",{className:"mg-session-progress",children:r.jsx("div",{className:"mg-session-progress-fill",style:{width:`${$t}%`}})}),r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>{confirm("End workout early?")&&T("muscle_overview")},"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsxs("span",{className:"mg-header-info",children:["Exercise ",Ut+1,"/",Je]}),r.jsx("div",{style:{width:22}})]})}),r.jsxs("main",{className:"wk-main",children:[Yt?r.jsxs("div",{className:"mg-video-container",onClick:as,children:[Yt.isGif?r.jsx("img",{className:"mg-video",src:Yt.url,alt:ve.name}):r.jsx("video",{ref:se,className:"mg-video",src:Yt.url,loop:!0,muted:!0,playsInline:!0},ve.name),!ge&&!Yt.isGif&&r.jsxs("div",{className:"mg-video-overlay",children:[r.jsx("svg",{className:"mg-play-icon",width:"48",height:"48",viewBox:"0 0 24 24",fill:"rgba(255,255,255,0.9)",children:r.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})}),r.jsx("span",{className:"mg-video-hint",children:"Tap for demo"})]})]}):r.jsxs("div",{className:"mg-video-placeholder",children:[r.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",opacity:"0.4",children:[r.jsx("rect",{x:"2",y:"2",width:"20",height:"20",rx:"2.18",ry:"2.18"}),r.jsx("line",{x1:"7",y1:"2",x2:"7",y2:"22"}),r.jsx("line",{x1:"17",y1:"2",x2:"17",y2:"22"}),r.jsx("line",{x1:"2",y1:"12",x2:"22",y2:"12"}),r.jsx("line",{x1:"2",y1:"7",x2:"7",y2:"7"}),r.jsx("line",{x1:"2",y1:"17",x2:"7",y2:"17"}),r.jsx("line",{x1:"17",y1:"7",x2:"22",y2:"7"}),r.jsx("line",{x1:"17",y1:"17",x2:"22",y2:"17"})]}),r.jsx("span",{children:"Video coming soon"})]}),r.jsx("div",{className:"wk-spotify",children:r.jsx("iframe",{src:"https://open.spotify.com/embed/playlist/37i9dQZF1DZ06evO3FJyYF?utm_source=generator&theme=0",width:"100%",height:"80",frameBorder:"0",allow:"autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture",loading:"lazy",title:"Spotify Playlist"})}),r.jsxs("div",{className:"mg-exercise-card",children:[r.jsx("h2",{className:"mg-ex-name",children:ve.name}),r.jsx("span",{className:`mg-ex-type-badge ${ve.type}`,children:ve.type==="weighted"?"Weight + Reps":ve.type==="reps"?"Reps Only":"Timed"}),r.jsxs("div",{className:"mg-ex-set-info",children:[r.jsxs("span",{className:"mg-ex-set-num",children:["Set ",tt+1," of ",ve.sets]}),ve.type!=="timed"&&r.jsxs("span",{className:"mg-ex-target",children:["Target: ",ve.reps," reps"]}),ve.type==="timed"&&r.jsxs("span",{className:"mg-ex-target",children:["Target: ",ve.time,"s"]})]}),ve.type==="weighted"&&r.jsxs("div",{className:"mg-input-area",children:[r.jsxs("div",{className:"mg-input-group",children:[r.jsx("label",{children:"Weight (kg)"}),r.jsx("input",{type:"number",inputMode:"decimal",className:"mg-input",value:ds,onChange:Gt=>_s(Gt.target.value),placeholder:"0"})]}),r.jsxs("div",{className:"mg-input-group",children:[r.jsx("label",{children:"Reps"}),r.jsx("input",{type:"number",inputMode:"numeric",className:"mg-input",value:Ct,onChange:Gt=>be(Gt.target.value),placeholder:"0"})]})]}),ve.type==="reps"&&r.jsx("div",{className:"mg-input-area",children:r.jsxs("div",{className:"mg-input-group mg-input-single",children:[r.jsx("label",{children:"Reps"}),r.jsx("input",{type:"number",inputMode:"numeric",className:"mg-input",value:Ct,onChange:Gt=>be(Gt.target.value),placeholder:"0"})]})}),ve.type==="timed"&&r.jsxs("div",{className:"mg-timer-area",children:[r.jsx("div",{className:"mg-timer-display",children:r.jsxs("span",{className:"mg-timer-value",children:[Ue,"s"]})}),Te?r.jsx("button",{className:"mg-timer-btn mg-timer-stop",onClick:()=>Be(!1),children:"Stop"}):r.jsx("button",{className:"mg-timer-btn",onClick:()=>{Ue===0&&J(ve.time),Be(!0)},children:Ue<ve.time&&Ue>0?"Resume":"Start Timer"})]}),r.jsx("button",{className:"mg-log-set-btn",onClick:Cs,children:Mn}),_e.sets.length>0&&r.jsx("div",{className:"mg-completed-sets",children:_e.sets.map((Gt,Vs)=>r.jsxs("div",{className:"mg-completed-set",children:[r.jsx("span",{className:"mg-completed-set-check",children:""}),r.jsxs("span",{children:["Set ",Vs+1,": ",Gt.weight!=null?`${Gt.weight}kg  ${Gt.reps}`:Gt.reps!=null?`${Gt.reps} reps`:`${Gt.time}s`]})]},Vs))})]})]}),An,Ls&&(()=>{const Gt=Kt.reduce((Rs,Ys)=>Rs+Ys.sets.length,0),Vs=Kt.reduce((Rs,Ys)=>Rs+Ys.sets.reduce((Jt,ln)=>Jt+(ln.weight||0)*(ln.reps||0),0),0),Us=su.find(Rs=>Rs.key===Ye)?.label||"",In=[{value:Kt.length,label:"Exercises"},{value:Gt,label:"Sets"}];return Vs>0&&In.push({value:Math.round(Vs).toLocaleString(),label:"Volume (kg)"}),r.jsx(Qh,{title:`${Us} Complete!`,subtitle:Xt?.name,stats:In,onShareJourney:t?ut:null,userName:t?.name,onDismissStart:()=>T("menu"),onDone:()=>{jt(!1),Ks(null),It(null),_t(null)}})})(),lt&&r.jsx("div",{className:"mg-badge-celebration",onClick:()=>_t(null),children:r.jsxs("div",{className:"mg-badge-celebration-card",children:[r.jsx("div",{className:"mg-badge-celebration-icon",children:r.jsx("svg",{viewBox:"0 0 24 24",width:"48",height:"48",fill:"#ffc107",children:r.jsx("polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"})})}),r.jsx("h3",{className:"mg-badge-celebration-title",children:lt.badges.length===1?"Badge Earned!":`${lt.badges.length} Badges Earned!`}),r.jsx("div",{className:"mg-badge-celebration-list",children:lt.badges.map((Gt,Vs)=>r.jsx("div",{className:"mg-badge-celebration-item",children:Gt.type==="pb_target"?`${Gt.exercise}  ${Gt.targetWeight}kg`:Gt.label},Vs))}),r.jsxs("div",{className:"mg-badge-share-row",children:[r.jsxs("button",{className:"mg-badge-share-btn",onClick:async Gt=>{Gt.stopPropagation();const Vs=lt.badges[0],Us=lt.badges.map(Rs=>Rs.type==="pb_target"?`PB Target Hit: ${Rs.exercise}  ${Rs.targetWeight}kg`:Rs.label),In=$n.find(Rs=>Rs.id===Vs?.id)||$n.find(Rs=>Rs.name===Vs?.label);await ut({type:"badge_earned",title:Us.length===1?Us[0]:`${Us.length} Badges Earned!`,badges:Us,badgeDesc:In?.desc}),Et("Posted to Journey!","success")},children:[r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M12 20h9"}),r.jsx("path",{d:"M16.5 3.5a2.121 2.121 0 1 1 3 3L7 19l-4 1 1-4Z"})]}),"Journey"]}),r.jsxs("button",{className:"mg-badge-share-btn",onClick:async Gt=>{Gt.stopPropagation();const Vs=lt.badges[0],Us=lt.badges.map(Ys=>Ys.type==="pb_target"?`PB Target Hit: ${Ys.exercise}  ${Ys.targetWeight}kg`:Ys.label),In=$n.find(Ys=>Ys.id===Vs?.id)||$n.find(Ys=>Ys.name===Vs?.label),Rs=`Badge Earned! ${Us.join(", ")}
#MindCoreFitness`;try{const Ys=await tb({type:"badge",title:Us.length===1?Us[0]:"Badges Earned!",badges:Us,badgeImage:In?.img,badgeDesc:In?.desc});navigator.share&&navigator.canShare?.({files:[new File([Ys],"badge.png",{type:"image/png"})]})?await navigator.share({title:"Mind Core Fitness",text:Rs,files:[new File([Ys],"badge.png",{type:"image/png"})]}):navigator.share?await navigator.share({title:"Mind Core Fitness",text:Rs}):(await navigator.clipboard.writeText(Rs),Et("Copied!","success"))}catch{try{await navigator.clipboard.writeText(Rs),Et("Copied!","success")}catch{}}},children:[r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("circle",{cx:"18",cy:"5",r:"3"}),r.jsx("circle",{cx:"6",cy:"12",r:"3"}),r.jsx("circle",{cx:"18",cy:"19",r:"3"}),r.jsx("line",{x1:"8.59",y1:"13.51",x2:"15.42",y2:"17.49"}),r.jsx("line",{x1:"15.41",y1:"6.51",x2:"8.59",y2:"10.49"})]}),"Share"]})]}),r.jsx("button",{className:"mg-badge-celebration-dismiss",children:"Tap to dismiss"})]})})]})}return null}const $D=60,WD={"Dumbbell Floor Press":"push","Seated Dumbbell Shoulder Press":"push","Seated Dumbbell Arnold Press":"push","Dumbbell Overhead Tricep Extension":"push",Skullcrushers:"push","Dumbbell Lateral Raise":"push","Dumbbell Front Raise":"push","Dumbbell Bent Over Row":"pull","Single Arm Bent Over Row":"pull","Bicep Curl":"pull","Hammer Curl":"pull","Dumbbell Bent Over Rear Delt Fly":"pull","Renegade Row":"pull","Dumbbell Goblet Squats":"lower","Romanian Deadlifts":"lower","Forward Dumbbell Lunges":"lower","Dumbbell Sumo Squats":"lower","Weighted Calf Raises":"lower","1 Legged RDL":"lower","Dumbbell Box Step Ups":"lower","Dumbbell Squat Pulses":"lower","Dumbbell Reverse Lunges":"lower","Kettlebell Romanian Deadlift":"lower","Russian Twists Dumbbell":"core","Kettlebell Russian Twist":"core","Kettlebell Side Bends":"core","Kneeling Kettlebell Halo":"core"},GD=[{threshold:1e3,label:"1 Tonne"},{threshold:5e3,label:"5 Tonne"},{threshold:1e4,label:"10 Tonne"},{threshold:25e3,label:"25 Tonne"},{threshold:5e4,label:"50 Tonne"},{threshold:1e5,label:"100 Tonne"},{threshold:25e4,label:"250 Tonne"},{threshold:5e5,label:"500 Tonne"},{threshold:1e6,label:"1 Million kg"}],A2=[{id:"fullbody_4wk",name:"4-Week Full Body",focus:"fullbody",duration:4,daysPerWeek:3,level:"All Levels",description:"Build total body strength with compound dumbbell movements and bodyweight finishers",repProg:2,timeProg:5,days:[{name:"Day 1",label:"Push Focus",exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:3,baseReps:10,pbKey:"chestPress",storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Seated Dumbbell Shoulder Press",type:"weighted",sets:3,baseReps:10,pbKey:"shoulderPress",storagePath:"exercises/dumbbells/upper/seated dumbbell shoulder press.mp4"},{name:"Dumbbell Goblet Squats",type:"weighted",sets:3,baseReps:10,pbKey:"squat",storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Press Up",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Mountain Climbers",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Mountain Climbers.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]},{name:"Day 2",label:"Pull Focus",exercises:[{name:"Dumbbell Bent Over Row",type:"weighted",sets:3,baseReps:10,pbKey:"seatedRow",storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Bicep Curl",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Romanian Deadlifts",type:"weighted",sets:3,baseReps:10,pbKey:"deadlift",storagePath:"exercises/dumbbells/lower/romanian deadlifts.GIF"},{name:"Reverse Lunge",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/lower/reverse lunge.GIF"},{name:"Russian Twist",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Russian Twist.mp4"},{name:"Side Plank",type:"timed",sets:2,baseTime:25,storagePath:"exercises/bodyweight/core/Side Plank.mp4"}]},{name:"Day 3",label:"Legs & Core",exercises:[{name:"Forward Dumbbell Lunges",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.GIF"},{name:"Dumbbell Sumo Squats",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/lower/dumbbell sumo squats.GIF"},{name:"Weighted Calf Raises",type:"weighted",sets:3,baseReps:15,storagePath:"exercises/dumbbells/lower/weighted calf raises.GIF"},{name:"Box Step Ups",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/lower/box step ups.GIF"},{name:"Burpee",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]}]},{id:"fullbody_8wk",name:"8-Week Full Body",focus:"fullbody",duration:8,daysPerWeek:3,level:"Intermediate",description:"Two-phase programme building strength and endurance across your full body",repProg:1,timeProg:3,days:[{name:"Day 1",label:"Strength",exercises:[{name:"Dumbbell Goblet Squats",type:"weighted",sets:4,baseReps:8,pbKey:"squat",storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Dumbbell Floor Press",type:"weighted",sets:4,baseReps:8,pbKey:"chestPress",storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Dumbbell Bent Over Row",type:"weighted",sets:4,baseReps:8,pbKey:"seatedRow",storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Seated Dumbbell Shoulder Press",type:"weighted",sets:3,baseReps:10,pbKey:"shoulderPress",storagePath:"exercises/dumbbells/upper/seated dumbbell shoulder press.mp4"},{name:"Mountain Climbers",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Mountain Climbers.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:35,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]},{name:"Day 2",label:"Power",exercises:[{name:"Romanian Deadlifts",type:"weighted",sets:4,baseReps:8,pbKey:"deadlift",storagePath:"exercises/dumbbells/lower/romanian deadlifts.GIF"},{name:"Forward Dumbbell Lunges",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.GIF"},{name:"Single Arm Bent Over Row",type:"weighted",sets:4,baseReps:8,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Hammer Curl",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/hammer curl.mp4"},{name:"Bulgarian Split Squats",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/lower/bulgarian split squats.GIF"},{name:"Russian Twist",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Russian Twist.mp4"}]},{name:"Day 3",label:"Endurance",exercises:[{name:"Dumbbell Sumo Squats",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/lower/dumbbell sumo squats.GIF"},{name:"Weighted Calf Raises",type:"weighted",sets:3,baseReps:15,storagePath:"exercises/dumbbells/lower/weighted calf raises.GIF"},{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Press Up",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Burpee",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:40,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]}]},{id:"fullbody_12wk",name:"12-Week Full Body",focus:"fullbody",duration:12,daysPerWeek:3,level:"Advanced",description:"Complete transformation programme: push, pull, and legs over three phases",repProg:1,timeProg:2,days:[{name:"Day 1",label:"Upper Push",exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:4,baseReps:8,pbKey:"chestPress",storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Seated Dumbbell Arnold Press",type:"weighted",sets:4,baseReps:8,storagePath:"exercises/dumbbells/upper/seated dumbbell arnold press.mp4"},{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Skullcrushers",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/skullcrushers.mp4"},{name:"Press Up",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]},{name:"Day 2",label:"Lower Body",exercises:[{name:"Dumbbell Goblet Squats",type:"weighted",sets:4,baseReps:8,pbKey:"squat",storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Romanian Deadlifts",type:"weighted",sets:4,baseReps:8,pbKey:"deadlift",storagePath:"exercises/dumbbells/lower/romanian deadlifts.GIF"},{name:"Forward Dumbbell Lunges",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.GIF"},{name:"Weighted Calf Raises",type:"weighted",sets:3,baseReps:15,storagePath:"exercises/dumbbells/lower/weighted calf raises.GIF"},{name:"Jump Squats",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/lower/jump squats.GIF"},{name:"Hollow Body Hold",type:"timed",sets:3,baseTime:30,storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"}]},{name:"Day 3",label:"Upper Pull",exercises:[{name:"Dumbbell Bent Over Row",type:"weighted",sets:4,baseReps:8,pbKey:"seatedRow",storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Single Arm Bent Over Row",type:"weighted",sets:4,baseReps:8,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Bicep Curl",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Burpee",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Side Plank",type:"timed",sets:2,baseTime:25,storagePath:"exercises/bodyweight/core/Side Plank.mp4"}]}]},{id:"core_4wk",name:"4-Week Core",focus:"core",duration:4,daysPerWeek:3,level:"Beginner",description:"Build a solid core foundation with targeted ab and stability work",repProg:2,timeProg:5,days:[{name:"Day 1",label:"Abs",exercises:[{name:"Crunch",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/core/Crunch.mp4"},{name:"Leg Raises",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Leg Raises.mp4"},{name:"Russian Twist",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Russian Twist.mp4"},{name:"Bicycle Crunch",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Bicycle Crunch.mp4"},{name:"Mountain Climbers",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Mountain Climbers.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]},{name:"Day 2",label:"Stability",exercises:[{name:"Dead Bug",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Dead Bug.mp4"},{name:"Bird Dog",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Bird Dog.mp4"},{name:"Side Plank",type:"timed",sets:2,baseTime:20,storagePath:"exercises/bodyweight/core/Side Plank.mp4"},{name:"Flutter Kicks",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Flutter Kicks.mp4"},{name:"Hollow Body Hold",type:"timed",sets:3,baseTime:20,storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"},{name:"High Plank Shoulder Taps",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/High Plank Shoulder Taps.mp4"}]},{name:"Day 3",label:"Power Core",exercises:[{name:"Single Leg V-Up",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Single Leg V-Up.mp4"},{name:"Toe Reaches",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/core/toe reaches.GIF"},{name:"Russian Twists Dumbbell",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/core/russian twists dumbbell.GIF"},{name:"Burpee",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Fast Mountain Climbers",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Fast Mountain Climbers.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]}]},{id:"core_8wk",name:"8-Week Core",focus:"core",duration:8,daysPerWeek:3,level:"Intermediate",description:"Develop deep core strength and rotational power over two phases",repProg:1,timeProg:3,days:[{name:"Day 1",label:"Anti-Extension",exercises:[{name:"Forearm Plank",type:"timed",sets:3,baseTime:35,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"},{name:"Dead Bug",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Dead Bug.mp4"},{name:"Plank Walkout",type:"reps",sets:3,baseReps:8,storagePath:"exercises/bodyweight/core/Plank Walkout.mp4"},{name:"Hollow Body Hold",type:"timed",sets:3,baseTime:25,storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"},{name:"Leg Raises",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Leg Raises.mp4"},{name:"Mountain Climbers",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Mountain Climbers.mp4"}]},{name:"Day 2",label:"Rotation",exercises:[{name:"Russian Twist",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Russian Twist.mp4"},{name:"Kettlebell Russian Twist",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/kettlebells/core/kettlebell russian twist.mp4"},{name:"Bicycle Crunch",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Bicycle Crunch.mp4"},{name:"Side Plank Rotation",type:"reps",sets:2,baseReps:10,storagePath:"exercises/bodyweight/core/Side Plank Rotation.mp4"},{name:"High Plank Shoulder Taps",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/core/High Plank Shoulder Taps.mp4"},{name:"Hollow Hold To V-Sit",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Hollow Hold To V-sit.mp4"}]},{name:"Day 3",label:"Power",exercises:[{name:"Crunch",type:"reps",sets:4,baseReps:15,storagePath:"exercises/bodyweight/core/Crunch.mp4"},{name:"Flutter Kicks",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Flutter Kicks.mp4"},{name:"Reverse Crunch To Leg Raise",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Reverse Crunch To Leg Raise.mp4"},{name:"Burpee",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Kettlebell Bird Dog Drag",type:"reps",sets:3,baseReps:10,storagePath:"exercises/kettlebells/core/kettlebell bird dog drag.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:40,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]}]},{id:"core_12wk",name:"12-Week Core",focus:"core",duration:12,daysPerWeek:3,level:"Advanced",description:"Ultimate core transformation: stability, strength, and power across three phases",repProg:1,timeProg:2,days:[{name:"Day 1",label:"Strength",exercises:[{name:"Forearm Plank",type:"timed",sets:4,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"},{name:"Plank Walkout",type:"reps",sets:4,baseReps:8,storagePath:"exercises/bodyweight/core/Plank Walkout.mp4"},{name:"Leg Raises",type:"reps",sets:4,baseReps:12,storagePath:"exercises/bodyweight/core/Leg Raises.mp4"},{name:"Kettlebell Side Bends",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/kettlebells/core/kettlebell side bends.mp4"},{name:"Dead Bug Single Leg Drop",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Dead Bug Single Leg Drop.mp4"},{name:"Hollow Body Hold",type:"timed",sets:3,baseTime:25,storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"}]},{name:"Day 2",label:"Endurance",exercises:[{name:"Crunch",type:"reps",sets:4,baseReps:15,storagePath:"exercises/bodyweight/core/Crunch.mp4"},{name:"Kettlebell Russian Twist",type:"weighted",sets:4,baseReps:15,storagePath:"exercises/kettlebells/core/kettlebell russian twist.mp4"},{name:"Bicycle Crunch",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Bicycle Crunch.mp4"},{name:"Hollow Hold Flutter Kicks",type:"reps",sets:3,baseReps:25,storagePath:"exercises/bodyweight/core/Hollow Hold Flutter Kicks.mp4"},{name:"Cross Body Mountain Climbers",type:"reps",sets:3,baseReps:25,storagePath:"exercises/bodyweight/core/Cross Body Mountain Climbers.mp4"},{name:"Side Plank",type:"timed",sets:2,baseTime:25,storagePath:"exercises/bodyweight/core/Side Plank.mp4"}]},{name:"Day 3",label:"Power",exercises:[{name:"Hollow Hold To V-Sit",type:"reps",sets:4,baseReps:10,storagePath:"exercises/bodyweight/core/Hollow Hold To V-sit.mp4"},{name:"Reverse Crunch To Leg Raise",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Reverse Crunch To Leg Raise.mp4"},{name:"Burpee",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Hip Dips Plank",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/core/Hip Dips Plank.mp4"},{name:"Kneeling Kettlebell Halo",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/kettlebells/core/kneeling kettlebell halo.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:35,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]}]},{id:"upper_4wk",name:"4-Week Upper Body",focus:"upper",duration:4,daysPerWeek:3,level:"Intermediate",description:"Sculpt and strengthen your chest, back, shoulders, and arms",repProg:2,timeProg:5,days:[{name:"Day 1",label:"Push",exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:4,baseReps:10,pbKey:"chestPress",storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Seated Dumbbell Shoulder Press",type:"weighted",sets:3,baseReps:10,pbKey:"shoulderPress",storagePath:"exercises/dumbbells/upper/seated dumbbell shoulder press.mp4"},{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Tricep Dips",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/upper/tricep dips.mp4"},{name:"Pike Push Ups",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/upper/pike push ups.GIF"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]},{name:"Day 2",label:"Pull",exercises:[{name:"Dumbbell Bent Over Row",type:"weighted",sets:4,baseReps:10,pbKey:"seatedRow",storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Single Arm Bent Over Row",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Bicep Curl",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Hammer Curl",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/hammer curl.mp4"},{name:"Reverse Plank",type:"timed",sets:3,baseTime:20,storagePath:"exercises/bodyweight/upper/reverse plank.GIF"}]},{name:"Day 3",label:"Mixed",exercises:[{name:"Seated Dumbbell Arnold Press",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/seated dumbbell arnold press.mp4"},{name:"Dumbbell Lateral Raise",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/dumbbell lateral raise.mp4"},{name:"Dumbbell Front Raise",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/dumbbell front raise.mp4"},{name:"Press Up",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Renegade Row",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/renegade row.mp4"},{name:"Superman Hold",type:"timed",sets:3,baseTime:30,storagePath:"exercises/bodyweight/core/Superman Hold.mp4"}]}]},{id:"lower_4wk",name:"4-Week Lower Body",focus:"lower",duration:4,daysPerWeek:3,level:"Intermediate",description:"Build powerful legs and glutes with squats, deadlifts, and plyometrics",repProg:2,timeProg:5,days:[{name:"Day 1",label:"Quad Dominant",exercises:[{name:"Dumbbell Goblet Squats",type:"weighted",sets:4,baseReps:10,pbKey:"squat",storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Forward Dumbbell Lunges",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.GIF"},{name:"Dumbbell Box Step Ups",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/lower/dumbbell box step ups.mp4"},{name:"Dumbbell Squat Pulses",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/lower/dumbbell squat pulses.GIF"},{name:"Jump Squats",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/lower/jump squats.GIF"},{name:"Squat And Hold",type:"timed",sets:3,baseTime:30,storagePath:"exercises/bodyweight/lower/squat and hold.GIF"}]},{name:"Day 2",label:"Hamstring & Glute",exercises:[{name:"Romanian Deadlifts",type:"weighted",sets:4,baseReps:8,pbKey:"deadlift",storagePath:"exercises/dumbbells/lower/romanian deadlifts.GIF"},{name:"1 Legged RDL",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/lower/1 legged rdl.GIF"},{name:"Hip Thrusts",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/lower/hip thrusts.GIF"},{name:"Dumbbell Reverse Lunges",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/lower/dumbbell reverse lunges.GIF"},{name:"Donkey Kicks",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/lower/donkey kicks.GIF"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]},{name:"Day 3",label:"Power & Stability",exercises:[{name:"Dumbbell Sumo Squats",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/lower/dumbbell sumo squats.GIF"},{name:"Kettlebell Romanian Deadlift",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/kettlebells/lower/kettlebell romanian deadlift.mp4"},{name:"Weighted Calf Raises",type:"weighted",sets:3,baseReps:15,storagePath:"exercises/dumbbells/lower/weighted calf raises.GIF"},{name:"Bulgarian Split Squats",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/lower/bulgarian split squats.GIF"},{name:"Skater Jumps",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/lower/skater jumps.GIF"},{name:"Side Plank",type:"timed",sets:2,baseTime:25,storagePath:"exercises/bodyweight/core/Side Plank.mp4"}]}]}];function ch(n,e,t){const i=n.baseReps?n.baseReps+(e-1)*(t.repProg||0):void 0,l=n.baseTime?n.baseTime+(e-1)*(t.timeProg||0):void 0;return{sets:n.sets,reps:i,time:l}}const KD={fullbody:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm-2 8h4l1 4h2l-1 4h-2l-1 4h-2l-1-4H8l-1-4h2l1-4z",core:"M12 2a4 4 0 0 1 4 4v1h-2V6a2 2 0 1 0-4 0v1H8V6a4 4 0 0 1 4-4zM8 9h8v2H8V9zm-1 4h10l-1 9H8l-1-9z",upper:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm8 10l-3-1.5c-.5-.25-1-.5-1.5-.5h-7c-.5 0-1 .25-1.5.5L4 12l-2 6h4l1.5 4h9L18 18h4l-2-6z",lower:"M16.5 3A2.5 2.5 0 0 0 14 5.5 2.5 2.5 0 0 0 16.5 8 2.5 2.5 0 0 0 19 5.5 2.5 2.5 0 0 0 16.5 3zM14 9l-3 7h2l1 6h2l1-6h2l-3-7h-2z"};function YD(){const{currentUser:n,isClient:e,clientData:t,loading:i}=Vr(),{isDark:l,toggleTheme:u,accent:d}=Ra(),p=lr(),g=Ca(),[y,x]=v.useState("loading"),[k,T]=v.useState(null),O=v.useRef(!1),[G,F]=v.useState(null),[V,te]=v.useState(!1),[Y,ie]=v.useState(1),[he,Ne]=v.useState(0),[fe,R]=v.useState(0),[E,M]=v.useState(0),[B,D]=v.useState([]),[H,I]=v.useState(""),[ze,mt]=v.useState(""),[W,ue]=v.useState(!1),[Re,Le]=v.useState(0),Z=v.useRef(null),[L,ne]=v.useState({}),[Ie,de]=v.useState(!1),qe=v.useRef(null),[Me,ot]=v.useState(null),[ft,Qe]=v.useState([]);v.useEffect(()=>{window.scrollTo(0,0)},[y]);const[Vt,Ls]=v.useState(null),jt=v.useCallback((be,Te="info")=>{Ls({message:be,type:Te}),setTimeout(()=>Ls(null),4e3)},[]),yt=v.useCallback(async be=>{if(!t)throw new Error("Not signed in");const Te=be&&typeof be=="object"&&be.type;await ua(Ft(me,"posts"),{authorId:t.id,authorName:t.name||"Unknown",authorPhotoURL:t.photoURL||null,content:Te?"":be,type:Te?be.type:"text",imageURL:null,createdAt:yr(),likeCount:0,commentCount:0,...Te?{metadata:{title:be.title||"",subtitle:be.subtitle||"",stats:be.stats||[],quote:be.quote||"",badges:be.badges||[]}}:{}})},[t]),re=v.useRef(null),Nt=()=>(re.current||(re.current=new(window.AudioContext||window.webkitAudioContext)),re.current),vt=()=>{try{const be=Nt(),Te=be.createOscillator(),Be=be.createGain();Te.connect(Be),Be.connect(be.destination),Te.frequency.value=1200,Be.gain.value=.4,Te.start(be.currentTime),Te.stop(be.currentTime+.3)}catch{}};v.useEffect(()=>{!i&&(!n||!e)&&p("/")},[n,e,i,p]),v.useEffect(()=>{if(!t)return;(async()=>{try{const Te=$e(me,"clientProgrammes",t.id),Be=await As(Te);Be.exists()&&F(Be.data());const Ue=g.state?.templateId;if(Ue&&!O.current){const J=A2.find(ge=>ge.id===Ue);if(J){O.current=!0,T(J),x("overview");return}}Be.exists()?x("dashboard"):p("/client/core-buddy/workouts",{replace:!0})}catch(Te){console.error("Error loading programme:",Te),p("/client/core-buddy/workouts",{replace:!0})}})()},[t]),v.useEffect(()=>{if(!W||Re<=0){W&&Re<=0&&(ue(!1),vt());return}return Z.current=setTimeout(()=>Le(be=>be-1),1e3),()=>clearTimeout(Z.current)},[W,Re]);const Pt=async be=>{if(t)try{await Ns($e(me,"clientProgrammes",t.id),be),F(be)}catch(Te){console.error("Error saving programme:",Te),jt("Failed to save. Check Firestore rules for clientProgrammes.","error")}},Et=async be=>{const Te={templateId:be.id,startDate:kt.now(),completedSessions:{}};await Pt(Te),x("dashboard")},ut=async()=>{if(t)try{await jr($e(me,"clientProgrammes",t.id)),F(null),x("browse")}catch(be){console.error("Error quitting programme:",be)}},Ye=()=>G?A2.find(be=>be.id===G.templateId):null,It=()=>{if(!G?.startDate)return 1;const be=G.startDate.toDate?G.startDate.toDate():new Date(G.startDate),Be=new Date-be,Ue=Math.floor(Be/(1e3*60*60*24));return Math.floor(Ue/7)+1},Xt=()=>{if(!G)return{currentWeek:1,completedThisWeek:0,nextDay:0,totalCompleted:0};const be=G.completedSessions||{},Te=Object.keys(be).length,Be=Ye();if(!Be)return{currentWeek:1,completedThisWeek:0,nextDay:0,totalCompleted:0};const Ue=Be.duration*Be.daysPerWeek,J=It(),ge=Math.min(J,Be.duration);let We=0;for(let z=0;z<Be.daysPerWeek;z++)be[`w${ge}d${z}`]&&We++;if(Te>=Ue)return{currentWeek:Be.duration,completedThisWeek:Be.daysPerWeek,nextDay:-1,totalCompleted:Te,totalSessions:Ue,complete:!0};if(J>Be.duration)return{currentWeek:Be.duration,completedThisWeek:We,nextDay:-1,totalCompleted:Te,totalSessions:Ue,complete:!0};let Ke=-1;for(let z=0;z<Be.daysPerWeek;z++)if(!be[`w${ge}d${z}`]){Ke=z;break}return{currentWeek:ge,completedThisWeek:We,nextDay:Ke,nextWeek:ge,totalCompleted:Te,totalSessions:Ue}},Ks=be=>{const Te=It();return be<Te},Ut=(be,Te,Be)=>{if(!G||be<=1)return null;const Ue=`w${be-1}d${Te}`,J=G.completedSessions?.[Ue];if(!J)return null;const ge=J.exercises?.find(We=>We.name===Be);return ge?.sets?.length?ge.sets[ge.sets.length-1]:null},Mt=(be,Te)=>{const Be=Ye();if(!Be)return;ie(be),Ne(Te),R(0),M(0),D([]),mt(""),ue(!1),Le(0),de(!1),ne({});const Ue=Be.days[Te],J=Ue.exercises.map(z=>{const se=ch(z,be,Be);return{name:z.name,type:z.type,pbKey:z.pbKey,targetSets:se.sets,targetReps:se.reps,targetTime:se.time,sets:[]}});D(J);const ge=Ue.exercises[0],We=Ut(be,Te,ge.name);We?.weight&&ge.type==="weighted"?I(String(We.weight)):I(""),(async()=>{const z={};for(const se of Ue.exercises)if(se.storagePath)try{const Ge=so(no,se.storagePath),He=await Wo(Ge);z[se.name]={url:He,isGif:/\.gif$/i.test(se.storagePath)}}catch(Ge){console.warn(`Video not found for ${se.name}:`,Ge)}ne(z)})(),x("session")},is=async()=>{Ye();const be=B[fe];if(!be)return;let Te={};if(be.type==="weighted"){const J=parseFloat(H)||0,ge=parseInt(ze)||0;if(ge===0){jt("Enter your reps","error");return}Te={weight:J,reps:ge}}else if(be.type==="reps"){const J=parseInt(ze)||0;if(J===0){jt("Enter your reps","error");return}Te={reps:J}}else if(be.type==="timed"){const J=be.targetTime-Re;Te={time:Math.max(J,1)}}const Be=[...B];Be[fe]={...be,sets:[...be.sets,Te]},D(Be),be.type==="weighted"&&Te.weight>0&&await on(be.name,Te.weight,Te.reps);const Ue=be.sets.length+1;if(Ue<be.targetSets)M(Ue),I(Te.weight?String(Te.weight):""),mt(""),ue(!1),Le(0);else if(fe+1<B.length){const J=fe+1;R(J),M(0),de(!1);const We=Ye()?.days[he]?.exercises[J],Ke=Ut(Y,he,We?.name);Ke?.weight&&We?.type==="weighted"?I(String(Ke.weight)):I(""),mt(""),ue(!1),Le(0)}else await Ms(Be)},Ms=async be=>{if(!G||!t)return;const Te=`w${Y}d${he}`,Be={...G.completedSessions,[Te]:{completedAt:new Date().toISOString(),exercises:be.map(ge=>({name:ge.name,type:ge.type,sets:ge.sets}))}},Ue={...G,completedSessions:Be};await Pt(Ue);const J=be.reduce((ge,We)=>ge+We.sets.reduce((Ke,z)=>Ke+(z.weight||0)*(z.reps||0),0),0);J>0&&await Kt(J);try{const ge=Ye();await ua(Ft(me,"workoutLogs"),{clientId:t.id,type:"programme",programmeId:ge?.id,programmeName:ge?.name,week:Y,day:he+1,exerciseCount:be.length,duration:Math.round(be.reduce((We,Ke)=>We+Ke.sets.length*1.5,0)),volume:Math.round(J),completedAt:kt.now()})}catch(ge){console.error("Error saving workout log:",ge)}ft.length>0&&(ot({badges:[...ft]}),Qe([])),te(!0)},Kt=async be=>{if(t)try{const Te=await As($e(me,"coreBuddyAchievements",t.id)),Be=Te.exists()?Te.data():{clientId:t.id,badges:[],totalVolume:0},Ue=Be.totalVolume||0,J=Ue+be,ge=[];GD.forEach(Ke=>{J>=Ke.threshold&&Ue<Ke.threshold&&(Be.badges.some(se=>se.type==="volume_milestone"&&se.milestone===Ke.threshold)||ge.push({type:"volume_milestone",milestone:Ke.threshold,label:Ke.label,achievedAt:kt.now()}))});const We=[...Be.badges,...ge];await Ns($e(me,"coreBuddyAchievements",t.id),{clientId:t.id,badges:We,totalVolume:Math.round(J),updatedAt:kt.now()}),ge.length>0&&Qe(Ke=>[...Ke,...ge])}catch(Te){console.error("Error updating volume:",Te)}},on=async(be,Te,Be)=>{if(t)try{const Ue=t.id,J=await As($e(me,"coreBuddyPBs",Ue)),We=(J.exists()?J.data():null)?.exercises||{},Ke=We[be];let z=!1;if(Ke?(Te>(Ke.weight||0)||Te===(Ke.weight||0)&&Be>(Ke.reps||0))&&(z=!0):z=!0,z){const se={...We,[be]:{weight:Te,reps:Be,achievedAt:kt.now()}};await Ns($e(me,"coreBuddyPBs",Ue),{clientId:t.id,exercises:se,updatedAt:kt.now()}),jt(`New PB! ${Te}kg  ${Be} reps`,"success"),vt(),await ds(be,Te)}}catch(Ue){console.error("Error checking PB:",Ue)}},ds=async(be,Te)=>{if(t)try{const Be=await As($e(me,"coreBuddyTargets",t.id));if(!Be.exists())return;const J=(Be.data().targets||{})[be];if(!J||Te<J.targetWeight)return;const ge=await As($e(me,"coreBuddyAchievements",t.id)),We=ge.exists()?ge.data():{clientId:t.id,badges:[],totalVolume:0};if(We.badges.some(Ge=>Ge.type==="pb_target"&&Ge.exercise===be&&Ge.targetWeight===J.targetWeight))return;const z={type:"pb_target",exercise:be,group:WD[be]||"push",targetWeight:J.targetWeight,achievedAt:kt.now()},se=[...We.badges,z];await Ns($e(me,"coreBuddyAchievements",t.id),{...We,badges:se,updatedAt:kt.now()}),Qe(Ge=>[...Ge,z])}catch(Be){console.error("Error checking target badge:",Be)}},_s=Vt&&r.jsxs("div",{className:`toast-notification ${Vt.type}`,children:[Vt.type==="success"&&r.jsx("span",{children:" "}),Vt.message]}),Ct=(be,Te)=>r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:Te,"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})});if(i||y==="loading")return r.jsx("div",{className:"cb-loading",children:r.jsx("div",{className:"cb-loading-spinner"})});if(y==="browse")return p("/client/core-buddy/workouts",{replace:!0}),null;if(y==="overview"&&k){const be=k;return r.jsx(Sa,{children:r.jsxs("div",{className:"pg-page","data-theme":l?"dark":"light","data-accent":d,children:[Ct(be.name,()=>p("/client/core-buddy/workouts")),r.jsxs("main",{className:"pg-main",children:[r.jsxs("div",{className:"pg-overview-hero",children:[r.jsx("svg",{className:"pg-overview-icon",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:KD[be.focus]})}),r.jsx("h2",{className:"pg-overview-name",children:be.name}),r.jsx("p",{className:"pg-overview-desc",children:be.description}),r.jsxs("div",{className:"pg-overview-stats",children:[r.jsxs("div",{className:"pg-ov-stat",children:[r.jsx("span",{className:"pg-ov-stat-num",children:be.duration}),r.jsx("span",{className:"pg-ov-stat-label",children:"Weeks"})]}),r.jsxs("div",{className:"pg-ov-stat",children:[r.jsx("span",{className:"pg-ov-stat-num",children:be.daysPerWeek}),r.jsx("span",{className:"pg-ov-stat-label",children:"Days/Week"})]}),r.jsxs("div",{className:"pg-ov-stat",children:[r.jsx("span",{className:"pg-ov-stat-num",children:be.duration*be.daysPerWeek}),r.jsx("span",{className:"pg-ov-stat-label",children:"Sessions"})]})]})]}),r.jsx("div",{className:"pg-overview-days",children:be.days.map((Te,Be)=>r.jsxs("div",{className:"pg-day-card",children:[r.jsxs("div",{className:"pg-day-header",children:[r.jsx("span",{className:"pg-day-name",children:Te.name}),r.jsx("span",{className:"pg-day-label",children:Te.label})]}),r.jsx("div",{className:"pg-day-exercises",children:Te.exercises.map((Ue,J)=>{const ge=ch(Ue,1,be);return r.jsxs("div",{className:"pg-day-ex",children:[r.jsx("span",{className:"pg-day-ex-name",children:Ue.name}),r.jsx("span",{className:"pg-day-ex-target",children:Ue.type==="timed"?`${ge.sets}${ge.time}s`:`${ge.sets}${ge.reps}`}),r.jsx("span",{className:`pg-day-ex-badge pg-badge-${Ue.type}`,children:Ue.type==="weighted"?"WT":Ue.type==="timed"?"TMR":"BW"})]},J)})})]},Be))}),r.jsxs("div",{className:"pg-overview-note",children:[r.jsx("strong",{children:"Progressive Overload:"})," +",be.repProg," reps/week",be.timeProg?`, +${be.timeProg}s/week for timed`:""]}),r.jsx("button",{className:"pg-start-btn",onClick:()=>Et(be),children:"Start Programme"})]}),_s]})})}if(y==="dashboard"){const be=Ye();if(!be)return x("browse"),null;const Te=Xt(),Be=G?.completedSessions||{},Ue=Te.totalSessions?Math.round(Te.totalCompleted/Te.totalSessions*100):0;return Math.round(Te.totalCompleted/(Te.totalSessions||1)*$D),r.jsx(Sa,{children:r.jsxs("div",{className:"pg-page","data-theme":l?"dark":"light","data-accent":d,children:[Ct("Programme",()=>p("/client/core-buddy/workouts")),r.jsxs("main",{className:"pg-main",children:[r.jsxs("div",{className:"pg-dash-hero",children:[r.jsxs("div",{className:"pg-dash-ring-wrap",children:[r.jsxs("svg",{viewBox:"0 0 200 200",children:[r.jsx("circle",{className:"pg-arc-track",cx:"100",cy:"100",r:"80"}),r.jsx("circle",{className:"pg-arc-fill",cx:"100",cy:"100",r:"80",strokeDasharray:2*Math.PI*80,strokeDashoffset:2*Math.PI*80-Ue/100*2*Math.PI*80})]}),r.jsxs("div",{className:"pg-ring-center",children:[r.jsxs("span",{className:"pg-ring-pct",children:[Ue,"%"]}),r.jsx("span",{className:"pg-ring-label",children:"complete"})]})]}),r.jsx("h2",{className:"pg-dash-name",children:be.name}),r.jsxs("div",{className:"pg-dash-progress-text",children:[r.jsxs("span",{className:"pg-dash-pct",children:[Ue,"%"]}),r.jsxs("span",{className:"pg-dash-week",children:["Week ",Te.currentWeek," of ",be.duration]})]})]}),r.jsx("div",{className:"pg-weeks",children:Array.from({length:be.duration},(J,ge)=>{const We=ge+1,Ke=Ks(We);return r.jsxs("div",{className:`pg-week-row${We===Te.currentWeek?" pg-week-current":""}`,children:[r.jsxs("span",{className:"pg-week-label",children:["W",We]}),r.jsx("div",{className:"pg-week-days",children:be.days.map((z,se)=>{const Ge=`w${We}d${se}`,He=!!Be[Ge],Xe=!He&&Ke,lt=!He&&!Xe&&We===Te.currentWeek&&!Te.complete;return r.jsx("button",{className:`pg-day-dot${He?" done":""}${Xe?" missed":""}${lt?" next":""}`,disabled:!lt,onClick:()=>{lt&&Mt(We,se)},children:He?r.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:r.jsx("path",{d:"M20 6L9 17l-5-5"})}):Xe?r.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]}):r.jsx("span",{children:z.name.replace("Day ","")})},se)})})]},ge)})}),!Te.complete&&(()=>{const J=be.days.map((ge,We)=>({day:ge,d:We})).filter(({d:ge})=>!Be[`w${Te.currentWeek}d${ge}`]);return J.length===0?null:r.jsxs("div",{className:"pg-next-session",children:[r.jsx("h3",{children:J.length===be.daysPerWeek?"Choose a Session":"Remaining Sessions"}),r.jsxs("p",{className:"pg-next-info",children:["Week ",Te.currentWeek,"  ",J.length," session",J.length!==1?"s":""," left this week"]}),J.map(({day:ge,d:We})=>r.jsxs("div",{className:"pg-available-session",children:[r.jsxs("div",{className:"pg-next-exercises",children:[r.jsxs("span",{className:"pg-avail-day-label",children:[ge.name,": ",ge.label]}),ge.exercises.map((Ke,z)=>{const se=ch(Ke,Te.currentWeek,be);return r.jsxs("div",{className:"pg-next-ex",children:[r.jsx("span",{className:"pg-next-ex-name",children:Ke.name}),r.jsx("span",{className:"pg-next-ex-target",children:Ke.type==="timed"?`${se.sets}${se.time}s`:`${se.sets}${se.reps}`})]},z)})]}),r.jsxs("button",{className:"pg-start-btn",onClick:()=>Mt(Te.currentWeek,We),children:["Start ",ge.name]})]},We))]})})(),Te.complete&&r.jsxs("div",{className:"pg-complete-msg",children:[r.jsx("h3",{children:"Programme Complete! "}),r.jsxs("p",{children:["You finished all ",Te.totalSessions," sessions."]}),r.jsx("button",{className:"pg-start-btn",onClick:ut,children:"Choose New Programme"})]}),r.jsx("button",{className:"pg-quit-btn",onClick:()=>{confirm("Quit this programme? Progress will be lost.")&&ut()},children:"Quit Programme"})]}),r.jsx(ha,{active:"workouts"}),_s]})})}if(y==="session"){const be=Ye();if(!be)return null;const Te=be.days[he],Be=Te.exercises[fe],Ue=ch(Be,Y,be),J=B[fe],ge=J?.sets?.length||0,We=Te.exercises.length,Ke=(fe+ge/Ue.sets)/We,z=L[Be.name],se=Ut(Y,he,Be.name);Be.type==="timed"&&Re===0&&!W&&ge===E&&setTimeout(()=>Le(Ue.time),0);const Ge=()=>{z?.isGif?de(!Ie):qe.current&&(Ie?qe.current.pause():qe.current.play(),de(!Ie))};return r.jsxs("div",{className:"pg-page pg-page-session","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("div",{className:"pg-session-progress",children:r.jsx("div",{className:"pg-session-progress-fill",style:{width:`${Ke*100}%`}})}),r.jsxs("div",{className:"pg-session-header",children:[r.jsx("button",{className:"pg-session-back",onClick:()=>{confirm("Leave session? Progress will be lost.")&&x("dashboard")},children:r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M19 12H5M12 5l-7 7 7 7"})})}),r.jsxs("div",{className:"pg-session-title",children:[r.jsxs("span",{className:"pg-session-counter",children:[fe+1," / ",We]}),r.jsxs("span",{className:"pg-session-week",children:["Week ",Y,"  ",Te.name]})]})]}),z&&r.jsxs("div",{className:"pg-video-container",onClick:Ge,children:[z.isGif?r.jsx("img",{className:"pg-video",src:z.url,alt:Be.name}):r.jsx("video",{ref:qe,className:"pg-video",src:z.url,loop:!0,muted:!0,playsInline:!0},Be.name),!Ie&&r.jsxs("div",{className:"pg-video-overlay",children:[r.jsx("svg",{className:"pg-play-icon",viewBox:"0 0 24 24",fill:"white",children:r.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})}),r.jsx("span",{className:"pg-video-hint",children:"Tap for demo"})]})]}),r.jsx("div",{className:"pg-spotify",children:r.jsx("iframe",{src:"https://open.spotify.com/embed/playlist/37i9dQZF1DZ06evO3FJyYF?utm_source=generator&theme=0",width:"100%",height:"80",frameBorder:"0",allow:"autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture",loading:"lazy",title:"Spotify Playlist"})}),r.jsxs("div",{className:"pg-exercise-card",children:[r.jsx("h2",{className:"pg-ex-name",children:Be.name}),r.jsx("span",{className:`pg-ex-type-badge pg-badge-${Be.type}`,children:Be.type==="weighted"?"Weight + Reps":Be.type==="timed"?"Timed":"Reps Only"}),Be.type==="weighted"&&se&&r.jsxs("div",{className:"pg-last-week",children:[r.jsx("span",{className:"pg-last-week-label",children:"Last week:"}),r.jsxs("span",{className:"pg-last-week-value",children:[se.weight,"kg x ",se.reps," reps"]})]}),r.jsxs("div",{className:"pg-ex-set-info",children:[r.jsxs("span",{className:"pg-ex-set-num",children:["Set ",ge+1," of ",Ue.sets]}),r.jsxs("span",{className:"pg-ex-target",children:["Target: ",Be.type==="timed"?`${Ue.time}s hold`:`${Ue.reps} reps`]})]}),Be.type==="weighted"&&r.jsxs("div",{className:"pg-input-area",children:[r.jsxs("div",{className:"pg-input-group",children:[r.jsx("label",{children:"Weight (kg)"}),r.jsx("input",{type:"number",inputMode:"decimal",value:H,onChange:He=>I(He.target.value),placeholder:"0",className:"pg-input"})]}),r.jsxs("div",{className:"pg-input-group",children:[r.jsx("label",{children:"Reps"}),r.jsx("input",{type:"number",inputMode:"numeric",value:ze,onChange:He=>mt(He.target.value),placeholder:String(Ue.reps),className:"pg-input"})]})]}),Be.type==="reps"&&r.jsx("div",{className:"pg-input-area",children:r.jsxs("div",{className:"pg-input-group pg-input-single",children:[r.jsx("label",{children:"Reps"}),r.jsx("input",{type:"number",inputMode:"numeric",value:ze,onChange:He=>mt(He.target.value),placeholder:String(Ue.reps),className:"pg-input"})]})}),Be.type==="timed"&&r.jsxs("div",{className:"pg-timer-area",children:[r.jsx("div",{className:"pg-timer-display",children:r.jsxs("span",{className:"pg-timer-value",children:[Re,"s"]})}),W?r.jsx("button",{className:"pg-timer-btn pg-timer-stop",onClick:()=>ue(!1),children:"Stop"}):r.jsx("button",{className:"pg-timer-btn",onClick:()=>{Re===0&&Le(Ue.time),ue(!0)},children:Re<Ue.time&&Re>0?"Resume":"Start Timer"})]}),r.jsx("button",{className:"pg-log-set-btn",onClick:is,disabled:Be.type==="timed"&&W,children:ge+1<Ue.sets?"Log Set":fe+1<We?"Log Set  Next Exercise":"Log Set  Complete"}),J?.sets?.length>0&&r.jsx("div",{className:"pg-completed-sets",children:J.sets.map((He,Xe)=>r.jsxs("div",{className:"pg-completed-set",children:[r.jsx("span",{className:"pg-completed-set-check",children:""}),r.jsxs("span",{children:["Set ",Xe+1,": ",He.weight!==void 0?`${He.weight}kg  ${He.reps}`:He.time!==void 0?`${He.time}s`:`${He.reps} reps`]})]},Xe))})]}),V&&(()=>{const Xe=Ye()?.days[he],lt=B.reduce((Wt,en)=>Wt+en.sets.length,0),_t=B.reduce((Wt,en)=>Wt+en.sets.reduce((ts,ks)=>ts+(ks.weight||0)*(ks.reps||0),0),0),pt=[{value:B.length,label:"Exercises"},{value:lt,label:"Sets"}];return _t>0&&pt.push({value:Math.round(_t).toLocaleString(),label:"Volume (kg)"}),r.jsx(Qh,{title:"Session Complete!",subtitle:`Week ${Y}  ${Xe?.name}: ${Xe?.label}`,stats:pt,buttonLabel:"Back to Programme",onShareJourney:t?yt:null,userName:t?.name,onDismissStart:()=>x("dashboard"),onDone:()=>{te(!1)}})})(),Me&&r.jsx("div",{className:"pg-badge-celebration",onClick:()=>ot(null),children:r.jsxs("div",{className:"pg-badge-celebration-card",onClick:He=>He.stopPropagation(),children:[r.jsx("div",{className:"pg-badge-celebration-icon",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),r.jsx("h3",{className:"pg-badge-celebration-title",children:Me.badges.length===1?"Badge Earned!":`${Me.badges.length} Badges Earned!`}),r.jsx("div",{className:"pg-badge-celebration-list",children:Me.badges.map((He,Xe)=>r.jsx("div",{className:"pg-badge-celebration-item",children:He.type==="pb_target"?`${He.exercise}  ${He.targetWeight}kg`:He.label},Xe))}),r.jsxs("div",{className:"pg-badge-share-row",children:[r.jsxs("button",{className:"pg-badge-share-btn",onClick:async He=>{He.stopPropagation();const Xe=Me.badges[0],lt=Me.badges.map(pt=>pt.type==="pb_target"?`PB Target Hit: ${pt.exercise}  ${pt.targetWeight}kg`:pt.label),_t=$n.find(pt=>pt.id===Xe?.id)||$n.find(pt=>pt.name===Xe?.label);await yt({type:"badge_earned",title:lt.length===1?lt[0]:`${lt.length} Badges Earned!`,badges:lt,badgeDesc:_t?.desc}),jt("Posted to Journey!","success")},children:[r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M12 20h9"}),r.jsx("path",{d:"M16.5 3.5a2.121 2.121 0 1 1 3 3L7 19l-4 1 1-4Z"})]}),"Journey"]}),r.jsxs("button",{className:"pg-badge-share-btn",onClick:async He=>{He.stopPropagation();const Xe=Me.badges[0],lt=Me.badges.map(Wt=>Wt.type==="pb_target"?`PB Target Hit: ${Wt.exercise}  ${Wt.targetWeight}kg`:Wt.label),_t=$n.find(Wt=>Wt.id===Xe?.id)||$n.find(Wt=>Wt.name===Xe?.label),pt=`Badge Earned! ${lt.join(", ")}
#MindCoreFitness`;try{const Wt=await tb({type:"badge",title:lt.length===1?lt[0]:"Badges Earned!",badges:lt,badgeImage:_t?.img,badgeDesc:_t?.desc});navigator.share&&navigator.canShare?.({files:[new File([Wt],"badge.png",{type:"image/png"})]})?await navigator.share({title:"Mind Core Fitness",text:pt,files:[new File([Wt],"badge.png",{type:"image/png"})]}):navigator.share?await navigator.share({title:"Mind Core Fitness",text:pt}):(await navigator.clipboard.writeText(pt),jt("Copied!","success"))}catch{try{await navigator.clipboard.writeText(pt),jt("Copied!","success")}catch{}}},children:[r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("circle",{cx:"18",cy:"5",r:"3"}),r.jsx("circle",{cx:"6",cy:"12",r:"3"}),r.jsx("circle",{cx:"18",cy:"19",r:"3"}),r.jsx("line",{x1:"8.59",y1:"13.51",x2:"15.42",y2:"17.49"}),r.jsx("line",{x1:"15.41",y1:"6.51",x2:"8.59",y2:"10.49"})]}),"Share"]})]}),r.jsx("button",{className:"pg-badge-celebration-dismiss",onClick:()=>ot(null),children:"Tap to dismiss"})]})}),_s]})}return null}const QD={"Dumbbell Floor Press":"push","Seated Dumbbell Shoulder Press":"push","Seated Dumbbell Arnold Press":"push","Dumbbell Overhead Tricep Extension":"push",Skullcrushers:"push","Dumbbell Lateral Raise":"push","Dumbbell Front Raise":"push","Dumbbell Bent Over Row":"pull","Single Arm Bent Over Row":"pull","Bicep Curl":"pull","Hammer Curl":"pull","Dumbbell Bent Over Rear Delt Fly":"pull","Renegade Row":"pull","Dumbbell Goblet Squats":"lower","Romanian Deadlifts":"lower","Forward Dumbbell Lunges":"lower","Dumbbell Sumo Squats":"lower","Weighted Calf Raises":"lower","1 Legged RDL":"lower","Dumbbell Box Step Ups":"lower","Dumbbell Squat Pulses":"lower","Dumbbell Reverse Lunges":"lower","Kettlebell Romanian Deadlift":"lower","Russian Twists Dumbbell":"core","Kettlebell Russian Twist":"core","Kettlebell Side Bends":"core","Kneeling Kettlebell Halo":"core"},XD={push:{label:"Push",color:"#c75f6b",icon:"M4 12h3l3-9 4 18 3-9h3"},pull:{label:"Pull",color:"#5f8ac7",icon:"M12 2v10m0 0l-4-4m4 4l4-4M4 20h16"},lower:{label:"Lower",color:"#5fc77a",icon:"M12 2v8m-4 4l4 8 4-8m-8 0h8"},core:{label:"Core",color:"#c7a45f",icon:"M12 2a4 4 0 014 4v1h-2V6a2 2 0 10-4 0v1H8V6a4 4 0 014-4zM8 9h8v2H8V9zm-1 4h10l-1 9H8l-1-9z"}},Xp=[{threshold:1e3,label:"1 Tonne",icon:"1T"},{threshold:5e3,label:"5 Tonne",icon:"5T"},{threshold:1e4,label:"10 Tonne",icon:"10T"},{threshold:25e3,label:"25 Tonne",icon:"25T"},{threshold:5e4,label:"50 Tonne",icon:"50T"},{threshold:1e5,label:"100 Tonne",icon:"100T"},{threshold:25e4,label:"250 Tonne",icon:"250T"},{threshold:5e5,label:"500 Tonne",icon:"500T"},{threshold:1e6,label:"1 Million kg",icon:"1M"}];function JD(n){return QD[n]||"push"}function ZD(n){return n>=1e6?`${(n/1e6).toFixed(1)}M`:n>=1e3?`${(n/1e3).toFixed(1)}T`:`${Math.round(n)}`}function eP(n){return n>=1e6?"million kg":n>=1e3?"tonnes":"kg"}function tP(){const{currentUser:n,isClient:e,clientData:t,loading:i}=Vr(),{isDark:l,toggleTheme:u,accent:d}=Ra(),p=lr(),[g,y]=v.useState(!0),[x,k]=v.useState(null),[T,O]=v.useState({}),[G,F]=v.useState([]),[V,te]=v.useState(null),[Y,ie]=v.useState(0),[he,Ne]=v.useState({});v.useRef(null),v.useEffect(()=>{!i&&(!n||!e)&&p("/")},[n,e,i,p]),v.useEffect(()=>{if(!t)return;(async()=>{try{const[ue,Re,Le,Z]=await Promise.all([As($e(me,"coreBuddyAchievements",t.id)),As($e(me,"coreBuddyPBs",t.id)),As($e(me,"achievements",t.id)),Ss(Ps(Ft(me,"workoutLogs"),ps("clientId","==",t.id)))]);ue.exists()&&k(ue.data()),Re.exists()&&O(Re.data().exercises||{}),Le.exists()&&(F(Object.keys(Le.data().badges||{})),Ne(Le.data().progress||{})),ie(Z.docs.length)}catch(ue){console.error("Error loading achievements:",ue)}y(!1)})()},[t]);const fe=x?.badges||[],R=x?.totalVolume||0,E=fe.filter(W=>W.type==="pb_target"),M=fe.filter(W=>W.type==="volume_milestone"),B={push:[],pull:[],lower:[],core:[]};E.forEach(W=>{const ue=W.group||JD(W.exercise);B[ue]&&B[ue].push(W)});const D=Xp.find(W=>R<W.threshold),H=Xp.filter(W=>R>=W.threshold).pop()?.threshold||0,I=D?(R-H)/(D.threshold-H):1;if(i||g)return r.jsxs("div",{className:"ach-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsx("div",{className:"header-content",children:r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})})}),r.jsx("div",{className:"ach-loading-inline",children:r.jsx("div",{className:"cb-loading-spinner"})})]});const ze=fe.length+G.length,mt=ze>0||R>0||Y>0;return r.jsx(Sa,{children:r.jsxs("div",{className:"ach-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),r.jsxs("main",{className:"ach-main",children:[r.jsx("button",{className:"nut-back-btn",onClick:()=>p("/client/personal-bests?mode=corebuddy"),children:" Back"}),r.jsxs("div",{className:"ach-stats-banner",children:[r.jsxs("div",{className:"ach-stat-item",children:[r.jsx("span",{className:"ach-stat-num",children:ze}),r.jsx("span",{className:"ach-stat-label",children:ze===1?"Badge":"Badges"})]}),r.jsx("div",{className:"ach-stat-divider"}),r.jsxs("div",{className:"ach-stat-item",children:[r.jsx("span",{className:"ach-stat-num",children:ZD(R)}),r.jsxs("span",{className:"ach-stat-label",children:[eP(R)," lifted"]})]}),r.jsx("div",{className:"ach-stat-divider"}),r.jsxs("div",{className:"ach-stat-item",children:[r.jsx("span",{className:"ach-stat-num",children:Object.keys(T).length}),r.jsx("span",{className:"ach-stat-label",children:"PBs"})]})]}),!mt&&r.jsxs("div",{className:"ach-empty",children:[r.jsx("div",{className:"ach-empty-icon",children:r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[r.jsx("path",{d:"M12 15l-3-3h6l-3 3z"}),r.jsx("path",{d:"M5 7h14l-1.5 9h-11L5 7z"}),r.jsx("path",{d:"M8.5 7V5a3.5 3.5 0 017 0v2"})]})}),r.jsx("h4",{children:"No achievements yet"}),r.jsx("p",{children:"Complete workouts to track volume and set PB targets to start earning badges."})]}),[{key:"workouts",title:"Workout Badges",iconPath:"M20.57 14.86L22 13.43 20.57 12 17 15.57 8.43 7 12 3.43 10.57 2 9.14 3.43 7.71 2 5.57 4.14 4.14 2.71 2.71 4.14l1.43 1.43L2 7.71l1.43 1.43L2 10.57 3.43 12 7 8.43 15.57 17 12 20.57 13.43 22l1.43-1.43L16.29 22l2.14-2.14 1.43 1.43 1.43-1.43-1.43-1.43L22 16.29z"},{key:"streaks",title:"Streak Badges",iconPath:"M13.5.67s.74 2.65.74 4.8c0 2.06-1.35 3.73-3.41 3.73-2.07 0-3.63-1.67-3.63-3.73l.03-.36C5.21 7.51 4 10.62 4 14c0 4.42 3.58 8 8 8s8-3.58 8-8C20 8.61 17.41 3.8 13.5.67z"},{key:"pbs",title:"Personal Best Badges",iconPath:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"},{key:"nutrition",title:"Nutrition Badges",iconPath:"M18.06 23h1.66c.84 0 1.53-.65 1.63-1.47L23 5.05h-5V1h-2v4.05h-5l.3 2.34c1.71.47 3.31 1.32 4.27 2.26 1.44 1.42 2.43 2.89 2.43 5.29V23zM1 22v-1h15.03v1c0 .55-.45 1-1.01 1H2.01c-.56 0-1.01-.45-1.01-1zm15.03-7c0-4.87-4.66-5.84-8.03-5.97l.72 5.52L1 15.05v5.95h15.03V15z"},{key:"habits",title:"Habit Badges",iconPath:"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z"},{key:"leaderboard",title:"Leaderboard Badges",iconPath:"M7.5 21H2V9h5.5v12zm7.25-18h-5.5v18h5.5V3zM22 11h-5.5v10H22V11z"}].map(W=>{const ue=$n.filter(Z=>Z.category===W.key);if(ue.length===0)return null;const Re=(()=>{switch(W.key){case"workouts":return Y;case"streaks":return he.streakWeeks||0;case"pbs":return Object.keys(T).length;case"nutrition":return he.nutritionStreak||0;case"leaderboard":return t?.leaderboardOptIn?1:0;case"habits":return he.habitStreak||0;default:return 0}})(),Le=ue.filter(Z=>G.includes(Z.id)).length;return r.jsxs("div",{className:"ach-section",children:[r.jsxs("h3",{className:"ach-section-title",children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20",children:r.jsx("path",{d:W.iconPath})}),W.title]}),r.jsx("div",{className:"ach-workout-carousel",children:ue.map(Z=>{const L=G.includes(Z.id);return r.jsxs("button",{className:`ach-workout-badge${L?" unlocked":" locked"}`,onClick:()=>te(Z),children:[r.jsx("img",{src:Z.img,alt:Z.name,className:"ach-workout-badge-img"}),!L&&Z.threshold&&r.jsx("div",{className:"ach-workout-badge-progress",children:r.jsx("div",{className:"ach-workout-badge-progress-fill",style:{width:`${Math.min(Re/Z.threshold*100,100)}%`}})})]},Z.id)})}),r.jsxs("p",{className:"ach-workout-badges-count",children:[Le,"/",ue.length," unlocked"]})]},W.key)}),V&&r.jsx("div",{className:"ach-badge-overlay",onClick:()=>te(null),children:r.jsxs("div",{className:"ach-badge-overlay-content",onClick:W=>W.stopPropagation(),children:[r.jsx("img",{src:V.img,alt:V.name,className:`ach-badge-overlay-img${G.includes(V.id)?"":" ach-badge-overlay-img-locked"}`}),r.jsx("p",{className:"ach-badge-overlay-desc",children:V.desc}),G.includes(V.id)?r.jsx("span",{className:"ach-badge-overlay-status unlocked",children:"Unlocked"}):r.jsx("span",{className:"ach-badge-overlay-status locked",children:"Locked"}),r.jsx("button",{className:"ach-badge-overlay-close",onClick:()=>te(null),children:"Tap to close"})]})}),r.jsxs("div",{className:"ach-section",children:[r.jsxs("h3",{className:"ach-section-title",children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20",children:r.jsx("path",{d:"M20.57 14.86L22 13.43 20.57 12 17 15.57 8.43 7 12 3.43 10.57 2 9.14 3.43 7.71 2 5.57 4.14 4.14 2.71 2.71 4.14l1.43 1.43L2 7.71l1.43 1.43L2 10.57 3.43 12 7 8.43 15.57 17 12 20.57 13.43 22l1.43-1.43L16.29 22l2.14-2.14 1.43 1.43 1.43-1.43-1.43-1.43L22 16.29z"})}),"Volume Milestones"]}),r.jsxs("div",{className:"ach-volume-hero",children:[r.jsxs("div",{className:"ach-volume-ring",children:[r.jsx("svg",{className:"ach-volume-ring-svg",viewBox:"0 0 200 200",children:Hk.map((W,ue)=>{const Re=ue<Math.round(I*60);return r.jsx("line",{x1:W.x1,y1:W.y1,x2:W.x2,y2:W.y2,className:Re?"ach-tick-filled":"ach-tick-empty",strokeWidth:W.thick?"3":"2"},ue)})}),r.jsxs("div",{className:"ach-volume-center",children:[r.jsx("span",{className:"ach-volume-number",children:Math.round(R).toLocaleString()}),r.jsx("span",{className:"ach-volume-unit",children:"kg lifted"})]})]}),D&&r.jsxs("div",{className:"ach-volume-next",children:["Next: ",r.jsx("strong",{children:D.label})," (",(D.threshold-R).toLocaleString(),"kg to go)"]})]}),r.jsx("div",{className:"ach-milestone-shelf",children:Xp.map((W,ue)=>{const Re=R>=W.threshold,Le=M.find(Z=>Z.milestone===W.threshold);return r.jsxs("div",{className:`ach-milestone ${Re?"unlocked":"locked"}`,children:[r.jsx("div",{className:"ach-milestone-hex",children:r.jsx("span",{className:"ach-milestone-icon",children:W.icon})}),r.jsx("span",{className:"ach-milestone-label",children:W.label}),Le?.achievedAt&&r.jsx("span",{className:"ach-milestone-date",children:(Le.achievedAt.toDate?Le.achievedAt.toDate():new Date(Le.achievedAt)).toLocaleDateString("en-GB",{day:"numeric",month:"short"})})]},ue)})})]}),r.jsxs("div",{className:"ach-section",children:[r.jsxs("h3",{className:"ach-section-title",children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),"PB Target Badges"]}),E.length===0?r.jsx("div",{className:"ach-pb-empty",children:r.jsxs("p",{children:["Set targets on your personal bests to start earning badges. Go to ",r.jsx("strong",{children:"My Progress"}),' and tap "Set Target" on any PB.']})}):Object.entries(B).map(([W,ue])=>{if(ue.length===0)return null;const Re=XD[W];return r.jsxs("div",{className:"ach-group",children:[r.jsxs("div",{className:"ach-group-header",style:{borderLeftColor:Re.color},children:[r.jsx("span",{className:"ach-group-label",style:{color:Re.color},children:Re.label}),r.jsx("span",{className:"ach-group-count",children:ue.length})]}),r.jsx("div",{className:"ach-badge-grid",children:ue.map((Le,Z)=>r.jsxs("div",{className:"ach-badge-card",style:{animationDelay:`${Z*.06}s`,"--group-color":Re.color},children:[r.jsx("div",{className:"ach-badge-hex",style:{borderColor:Re.color,boxShadow:`0 0 12px ${Re.color}33`},children:r.jsx("svg",{className:"ach-badge-hex-icon",viewBox:"0 0 24 24",fill:"none",stroke:Re.color,strokeWidth:"2",strokeLinecap:"round",children:r.jsx("path",{d:Re.icon})})}),r.jsxs("div",{className:"ach-badge-info",children:[r.jsx("span",{className:"ach-badge-exercise",children:Le.exercise}),r.jsxs("span",{className:"ach-badge-value",style:{color:Re.color},children:[Le.targetWeight,"kg"]}),Le.achievedAt&&r.jsx("span",{className:"ach-badge-date",children:(Le.achievedAt.toDate?Le.achievedAt.toDate():new Date(Le.achievedAt)).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"})})]})]},Z))})]},W)})]})]}),r.jsx(ha,{active:"home"})]})})}const sP=[{key:"trained",label:"Trained",icon:"M4 10v4M8 7v10M8 12h8M16 7v10M20 10v4",color:"#A12F3A"},{key:"protein",label:"Hit Protein",icon:"M12 22c5.52 0 10-4.48 10-10S17.52 2 12 2 2 6.48 2 12s4.48 10 10 10zM12 18c3.31 0 6-2.69 6-6s-2.69-6-6-6-6 2.69-6 6 2.69 6 6 6zM12 14a2 2 0 1 0 0-4 2 2 0 0 0 0 4z",color:"#4caf50"},{key:"steps",label:"10k Steps",icon:"M4 19.5A2.5 2.5 0 0 1 6.5 17H20M4 12.5A2.5 2.5 0 0 1 6.5 10H20M4 5.5A2.5 2.5 0 0 1 6.5 3H20",color:"#ff9800"},{key:"sleep",label:"8hrs Sleep",icon:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z",color:"#7c3aed"},{key:"water",label:"2L Water",icon:"M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z",color:"#2196f3"}],nP="M12 2l2.4 7.2L22 12l-7.6 2.8L12 22l-2.4-7.2L2 12l7.6-2.8z",rP="#e91e63",aP=700,Dg=42,Bl=2*Math.PI*Dg,uh=["Every day counts. See you tomorrow!","Consistency is your superpower.","Perfect day  keep the streak alive!","You showed up for yourself today."];function iP(n){const e=new Date(n),t=e.getDay(),i=t===0?-6:1-t;return e.setDate(e.getDate()+i),e.setHours(0,0,0,0),e}function Jp(n){return n.toISOString().split("T")[0]}function oP(n){return Array.from({length:7},(e,t)=>{const i=new Date(n);return i.setDate(n.getDate()+t),i})}function lP(){const{currentUser:n,isClient:e,clientData:t,loading:i}=Vr(),{isDark:l,toggleTheme:u,accent:d}=Ra(),{isPremium:p,FREE_HABIT_LIMIT:g}=Gu(),y=lr(),[x,k]=v.useState({}),[T,O]=v.useState([]),[G,F]=v.useState(!0),[V,te]=v.useState(!1),[Y,ie]=v.useState(0),[he,Ne]=v.useState(null),[fe,R]=v.useState(null),[E,M]=v.useState(!1),[B,D]=v.useState(!1),[H,I]=v.useState(!1),[ze,mt]=v.useState(!1),[W,ue]=v.useState(""),[Re,Le]=v.useState(null),[Z,L]=v.useState([]),[ne,Ie]=v.useState(null),de=v.useRef(null),qe=v.useRef(null),Me=v.useRef(null),ot=v.useRef(null),ft=v.useRef(!1),Qe=v.useRef({}),Vt=v.useRef([]),Ls=v.useRef([]),jt=v.useRef(null),yt=v.useRef(uh[Math.floor(Math.random()*uh.length)]),re=v.useCallback((J,ge="info")=>{Ne({message:J,type:ge}),setTimeout(()=>Ne(null),3e3)},[]),Nt=new Date,vt=Jp(Nt),Pt=iP(Nt),Et=oP(Pt),ut=["M","T","W","T","F","S","S"],Ye=[...sP.filter(J=>!Z.includes(J.key)),...T.map(J=>({key:`custom_${J.id}`,label:J.label,icon:nP,color:rP,isCustom:!0,id:J.id}))],It=p?Ye:Ye.slice(0,g);v.useEffect(()=>{!i&&(!n||!e)&&y("/")},[n,e,i,y]),v.useEffect(()=>{if(!n||!t)return;(async()=>{try{const ge=Ft(me,"habitLogs"),We=Ps(ge,ps("clientId","==",t.id)),Ke=await Ss(We),z={};Ke.docs.forEach(Xe=>{const lt=Xe.data();z[lt.date]={...lt,_id:Xe.id}}),k(z);const se=await As($e(me,"customHabits",t.id));if(se.exists()){const Xe=se.data();O(Xe.habits||[]),L(Xe.hiddenDefaults||[])}let Ge=0;const He=new Date(Nt);for(;;){const Xe=Jp(He),lt=z[Xe];if(lt)if(Object.values(lt.habits||{}).filter(Boolean).length>=3)Ge++,He.setDate(He.getDate()-1);else break;else if(Xe===vt)He.setDate(He.getDate()-1);else break}ie(Ge)}catch(ge){console.error("Error loading habit logs:",ge)}finally{F(!1)}})()},[n,t]);const Xt=x[vt]||{habits:{}};v.useEffect(()=>{Object.values(Xt.habits||{}).filter(Boolean).length<It.length&&H&&I(!1)},[It.length,Xt.habits]);const Ks=async J=>{if(!(!n||V||Xt.habits?.[J])){Vt.current=[...Array(10)].map((We,Ke)=>{const z=Ke/10*2*Math.PI,se=18+Math.random()*20;return{tx:Math.cos(z)*se,ty:Math.sin(z)*se,size:3+Math.random()*4,duration:.4+Math.random()*.3}}),R(J),setTimeout(()=>R(null),700),navigator.vibrate&&navigator.vibrate(50),te(!0);try{const Ke={...Xt.habits||{},[J]:!0},z=Xt._id||`${t.id}_${vt}`;k(Ge=>({...Ge,[vt]:{clientId:t.id,date:vt,habits:Ke,_id:z}})),await Ns($e(me,"habitLogs",z),{clientId:t.id,date:vt,habits:Ke}),Object.values(Ke).filter(Boolean).length===It.length&&!H&&(yt.current=uh[Math.floor(Math.random()*uh.length)],Ls.current=[...Array(80)].map((Ge,He)=>({x:5+Math.random()*90,delay:Math.random()*3.5,color:["#A12F3A","#4caf50","#ff9800","#2196f3","#e91e63","#ffeb3b","#FFD700","#ffffff","#9c27b0"][He%9],drift:(Math.random()-.5)*120,spin:Math.random()*720-360,duration:1.8+Math.random()*2,width:4+Math.random()*6,height:4+Math.random()*8,shape:He%3})),setTimeout(()=>{M(!0),I(!0),setTimeout(()=>jt.current?.focus(),1100)},400))}catch(We){console.error("Error saving habit:",We),re("Failed to save. Try again.","error"),k(Ke=>({...Ke,[vt]:{...Ke[vt],habits:{...Ke[vt]?.habits||{},[J]:!1}}}))}finally{te(!1)}}},Ut=async J=>{if(!(!n||V)){te(!0);try{const We={...Xt.habits||{},[J]:!1},Ke=Xt._id||`${t.id}_${vt}`;await Ns($e(me,"habitLogs",Ke),{clientId:t.id,date:vt,habits:We}),k(z=>({...z,[vt]:{clientId:t.id,date:vt,habits:We,_id:Ke}}))}catch(ge){console.error("Error undoing habit:",ge),re("Failed to undo. Try again.","error")}finally{te(!1)}}},Mt=J=>{if(Xt.habits?.[J]||!1||V||ot.current)return;ot.current=J,Ie(J),qe.current=performance.now();const We=Qe.current[J];We&&(We.style.strokeDashoffset=Bl);const Ke=z=>{const se=z-qe.current,Ge=Math.min(se/aP,1),He=Qe.current[J];He&&(He.style.strokeDashoffset=Bl-Ge*Bl),Ge<1?Me.current=requestAnimationFrame(Ke):(ot.current=null,ft.current=!0,Me.current=null,Ie(null),Ks(J))};Me.current=requestAnimationFrame(Ke)},is=()=>{if(!ot.current)return;const J=ot.current;ot.current=null,Me.current&&(cancelAnimationFrame(Me.current),Me.current=null),de.current&&(clearTimeout(de.current),de.current=null),Qe.current[J]&&(Qe.current[J].style.strokeDashoffset=Bl),Ie(null),qe.current=null};v.useEffect(()=>()=>{Me.current&&cancelAnimationFrame(Me.current),de.current&&clearTimeout(de.current)},[]);const Ms=v.useCallback(async J=>{if(!t)throw new Error("Not signed in");const ge=J&&typeof J=="object"&&J.type;await ua(Ft(me,"posts"),{authorId:t.id,authorName:t.name||"Unknown",authorPhotoURL:t.photoURL||null,content:ge?"":J,type:ge?J.type:"text",imageURL:null,createdAt:yr(),likeCount:0,commentCount:0,...ge?{metadata:{title:J.title||"",subtitle:J.subtitle||"",stats:J.stats||[],quote:J.quote||"",badges:J.badges||[]}}:{}})},[t]),Kt=async()=>{const J=W.trim();if(!J)return;if(!t?.id){re("Still loading, try again","error");return}const ge=Date.now().toString(36),We=[...T,{id:ge,label:J}];try{await Ns($e(me,"customHabits",t.id),{clientId:t.id,habits:We,hiddenDefaults:Z},{merge:!0}),O(We),ue(""),mt(!1),re(`Added "${J}"`,"success")}catch(Ke){console.error("Error adding custom habit:",Ke),re(Ke?.code==="permission-denied"?"Permission denied  check Firestore rules for customHabits":`Failed to add habit: ${Ke?.message||"Unknown error"}`,"error")}},on=async J=>{if(!t?.id)return;const ge=T.filter(We=>We.id!==J);try{await Ns($e(me,"customHabits",t.id),{clientId:t.id,habits:ge,hiddenDefaults:Z},{merge:!0}),O(ge),Le(null),re("Habit removed","success")}catch(We){console.error("Error deleting habit:",We),re("Failed to remove","error")}},ds=async J=>{if(!t?.id)return;const ge=[...Z,J];try{await Ns($e(me,"customHabits",t.id),{clientId:t.id,habits:T,hiddenDefaults:ge},{merge:!0}),L(ge),Le(null),re("Habit removed","success")}catch(We){console.error("Error hiding default habit:",We),re("Failed to remove","error")}},_s=Et.map(J=>{const ge=Jp(J),We=x[ge],Ke=We?Object.values(We.habits||{}).filter(Boolean).length:0;return{date:J,dateStr:ge,completed:Ke,total:It.length}}),Ct=_s.reduce((J,ge)=>J+ge.completed,0),be=_s.reduce((J,ge)=>J+ge.total,0),Te=be>0?Math.round(Ct/be*100):0,Be=Object.values(Xt.habits||{}).filter(Boolean).length,Ue=It.length>0?Math.round(Be/It.length*100):0;return r.jsx(Sa,{children:r.jsxs("div",{className:"cbc-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>y("/client/core-buddy"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),i||G?r.jsx("div",{className:"cbc-loading-inline",children:r.jsx("div",{className:"cbc-loading-spinner"})}):r.jsxs("main",{className:"cbc-main",children:[r.jsxs("div",{className:"cbc-ring-section anim-fade-up",children:[r.jsxs("div",{className:"cbc-progress-ring",children:[r.jsxs("svg",{viewBox:"0 0 200 200",children:[r.jsx("circle",{className:"cbc-arc-track",cx:"100",cy:"100",r:"80"}),r.jsx("circle",{className:"cbc-arc-fill",cx:"100",cy:"100",r:"80",strokeDasharray:2*Math.PI*80,strokeDashoffset:2*Math.PI*80-Ue/100*2*Math.PI*80})]}),r.jsxs("div",{className:"cbc-ring-center",children:[r.jsxs("span",{className:"cbc-ring-pct",children:[Ue,"%"]}),r.jsx("span",{className:"cbc-ring-label",children:"today"})]})]}),r.jsxs("div",{className:"cbc-streak",children:[r.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"var(--color-primary)",strokeWidth:"2",children:r.jsx("path",{d:"M13 2L3 14h9l-1 8 10-12h-9l1-8z"})}),r.jsx("span",{className:"cbc-streak-count",children:Y}),r.jsx("span",{className:"cbc-streak-label",children:"day streak"})]})]}),r.jsxs("div",{className:"cbc-section anim-fade-up-d2",children:[r.jsx("h2",{className:"cbc-section-title",children:"Today's Habits"}),r.jsxs("div",{className:"cbc-habits-grid",children:[It.map(J=>{const ge=Xt.habits?.[J.key]||!1,We=fe===J.key,Ke=ne===J.key;return r.jsxs("div",{className:`cbc-habit-tile ${ge?"cbc-habit-done":""} ${We?"cbc-habit-just-checked":""}`,style:{"--habit-color":J.color},children:[p&&r.jsx("button",{className:"cbc-habit-delete",onClick:z=>{z.stopPropagation(),Le(J.isCustom?{type:"custom",id:J.id,label:J.label}:{type:"default",key:J.key,label:J.label})},"aria-label":`Remove ${J.label}`,children:r.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:[r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})}),r.jsxs("div",{className:`cbc-habit-ring-touch ${Ke?"cbc-holding":""} ${ge?"cbc-ring-completed":""}`,onPointerDown:z=>{ge||(z.preventDefault(),Mt(J.key))},onPointerUp:is,onPointerLeave:is,onPointerCancel:is,onClick:z=>{if(z.stopPropagation(),ft.current){ft.current=!1;return}ge&&Ut(J.key)},role:"button",tabIndex:0,"aria-label":ge?`Undo ${J.label}`:`Press and hold to complete ${J.label}`,onKeyDown:z=>{(z.key==="Enter"||z.key===" ")&&(z.preventDefault(),ge?Ut(J.key):Ks(J.key))},children:[r.jsxs("svg",{className:"cbc-habit-ring-svg",viewBox:"0 0 100 100",children:[r.jsx("circle",{className:"cbc-habit-ring-track",cx:"50",cy:"50",r:Dg}),r.jsx("circle",{className:"cbc-habit-ring-fill",ref:z=>{z&&(Qe.current[J.key]=z)},cx:"50",cy:"50",r:Dg,style:{stroke:J.color,strokeDasharray:Bl,strokeDashoffset:ge?0:Bl}})]}),ge&&r.jsx("div",{className:"cbc-habit-glow-orb",style:{"--habit-color":J.color}}),r.jsx("div",{className:"cbc-habit-ring-icon",style:{color:J.color},children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:r.jsx("path",{d:J.icon})})}),We&&r.jsx("div",{className:"cbc-particles",children:Vt.current.map((z,se)=>r.jsx("span",{className:"cbc-particle",style:{"--tx":`${z.tx}px`,"--ty":`${z.ty}px`,"--size":`${z.size}px`,"--particle-color":J.color,animationDuration:`${z.duration}s`}},se))})]}),r.jsx("span",{className:"cbc-habit-label",children:J.label}),ge?r.jsx("span",{className:"cbc-habit-done-tag",children:"Done"}):r.jsx("span",{className:"cbc-habit-hold-hint",children:"Hold to complete"})]},J.key)}),p&&r.jsxs("div",{className:"cbc-habit-tile cbc-add-tile",onClick:()=>mt(!0),role:"button",tabIndex:0,children:[r.jsx("div",{className:"cbc-add-ring",children:r.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),r.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})}),r.jsx("span",{className:"cbc-habit-label",children:"Add Habit"}),r.jsx("span",{className:"cbc-habit-hold-hint",children:"Your own"})]})]}),!p&&r.jsxs("button",{className:"cbc-premium-card",onClick:()=>y("/upgrade"),children:[r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M12 2v20M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"})}),r.jsxs("div",{className:"cbc-premium-card-text",children:[r.jsx("span",{className:"cbc-premium-card-title",children:"Unlock More Habits"}),r.jsx("span",{className:"cbc-premium-card-desc",children:"Track all 5 daily habits, add custom habits, and build streaks"})]}),r.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})]})]}),r.jsxs("div",{className:"cbc-section anim-fade-up-d4",children:[r.jsx("h2",{className:"cbc-section-title",children:"This Week"}),r.jsx("div",{className:"cbc-week-grid",children:_s.map((J,ge)=>{const We=J.dateStr===vt,Ke=J.total>0?J.completed/J.total:0,z=38,se=2*Math.PI*z,Ge=se-Ke*se;return r.jsxs("div",{className:`cbc-day-ring ${We?"cbc-day-today":""} ${J.completed>0?"cbc-day-active":""}`,children:[r.jsxs("svg",{viewBox:"0 0 100 100",children:[r.jsx("circle",{className:"cbc-day-track",cx:"50",cy:"50",r:z}),r.jsx("circle",{className:"cbc-day-fill",cx:"50",cy:"50",r:z,strokeDasharray:se,strokeDashoffset:Ge})]}),r.jsx("span",{className:"cbc-day-label",children:ut[ge]}),r.jsxs("span",{className:"cbc-day-count",children:[J.completed,"/",J.total]})]},ge)})}),r.jsxs("div",{className:"cbc-week-summary",children:[r.jsx("div",{className:"cbc-week-summary-bar",children:r.jsx("div",{className:"cbc-week-summary-fill",style:{width:`${Te}%`}})}),r.jsxs("span",{className:"cbc-week-summary-text",children:[Ct," / ",be," habits this week (",Te,"%)"]})]})]})]}),r.jsx(ha,{active:"home"}),ze&&r.jsx("div",{className:"cbc-modal-overlay",onClick:()=>mt(!1),children:r.jsxs("div",{className:"cbc-modal",onClick:J=>J.stopPropagation(),children:[r.jsx("h3",{className:"cbc-modal-title",children:"Add Habit"}),r.jsx("p",{className:"cbc-modal-desc",children:"Track something personal to your routine."}),r.jsx("input",{className:"cbc-modal-input",type:"text",placeholder:"e.g. Meditate, Stretch, Read...",value:W,onChange:J=>ue(J.target.value),maxLength:30,autoFocus:!0,onKeyDown:J=>J.key==="Enter"&&Kt()}),r.jsxs("div",{className:"cbc-modal-actions",children:[r.jsx("button",{className:"cbc-modal-cancel",onClick:()=>{mt(!1),ue("")},children:"Cancel"}),r.jsx("button",{className:"cbc-modal-save",onClick:Kt,disabled:!W.trim(),children:"Add"})]})]})}),Re&&r.jsx("div",{className:"cbc-modal-overlay",onClick:()=>Le(null),children:r.jsxs("div",{className:"cbc-modal",onClick:J=>J.stopPropagation(),children:[r.jsxs("h3",{className:"cbc-modal-title",children:['Remove "',Re.label,'"?']}),r.jsx("p",{className:"cbc-modal-desc",children:"This will remove the habit from your daily tracker. Past logs won't be affected."}),r.jsxs("div",{className:"cbc-modal-actions",children:[r.jsx("button",{className:"cbc-modal-cancel",onClick:()=>Le(null),children:"Keep"}),r.jsx("button",{className:"cbc-modal-delete",onClick:()=>Re.type==="custom"?on(Re.id):ds(Re.key),children:"Remove"})]})]})}),E&&r.jsx(Qh,{title:"All Habits Complete!",subtitle:yt.current,stats:[{value:`${Be}/${It.length}`,label:"Habits"},{value:Y||1,label:"Day Streak"}],buttonLabel:"Keep Going",holdLabel:"Hold To Complete Today's Habits",shareType:"habits",onShareJourney:t?Ms:null,userName:t?.name,onDone:()=>{M(!1),D(!1)}}),he&&r.jsx("div",{className:`toast-notification ${he.type}`,children:he.message})]})})}function dh(n){if(!n)return"?";const e=n.trim().split(/\s+/);return e.length===1?e[0][0].toUpperCase():(e[0][0]+e[e.length-1][0]).toUpperCase()}function M2(n,e){return[n,e].sort().join("_")}function cP(){const{currentUser:n,isClient:e,clientData:t,loading:i}=Vr(),{isDark:l,toggleTheme:u}=Ra(),d=lr(),[p,g]=v.useState("buddies"),[y,x]=v.useState([]),[k,T]=v.useState([]),[O,G]=v.useState([]),[F,V]=v.useState(""),[te,Y]=v.useState([]),[ie,he]=v.useState([]),[Ne,fe]=v.useState(!0),[R,E]=v.useState(null),[M,B]=v.useState(null),D=v.useCallback((Z,L="info")=>{B({message:Z,type:L}),setTimeout(()=>B(null),3500)},[]);v.useEffect(()=>{!i&&(!n||!e)&&d("/")},[n,e,i,d]);const H=v.useCallback(async()=>{if(t){fe(!0);try{const Z=t.id,ne=(await Ss(Ft(me,"clients"))).docs.map(Qe=>({id:Qe.id,...Qe.data()}));he(ne);const Ie=Object.fromEntries(ne.map(Qe=>[Qe.id,Qe])),de=await Ss(Ps(Ft(me,"buddies"),ps("user1","==",Z))),qe=await Ss(Ps(Ft(me,"buddies"),ps("user2","==",Z))),Me=new Set;[...de.docs,...qe.docs].forEach(Qe=>{const Vt=Qe.data(),Ls=Vt.user1===Z?Vt.user2:Vt.user1;Me.add(Ls)}),x(Array.from(Me).map(Qe=>Ie[Qe]).filter(Boolean));const ot=await Ss(Ps(Ft(me,"buddyRequests"),ps("toId","==",Z),ps("status","==","pending")));T(ot.docs.map(Qe=>({reqId:Qe.id,...Qe.data(),fromClient:Ie[Qe.data().fromId]})).filter(Qe=>Qe.fromClient));const ft=await Ss(Ps(Ft(me,"buddyRequests"),ps("fromId","==",Z),ps("status","==","pending")));G(ft.docs.map(Qe=>({reqId:Qe.id,...Qe.data(),toClient:Ie[Qe.data().toId]})).filter(Qe=>Qe.toClient))}catch(Z){console.error("Error fetching buddy data:",Z),D("Failed to load buddies","error")}finally{fe(!1)}}},[t,D]);v.useEffect(()=>{H()},[H]),v.useEffect(()=>{if(!F.trim()||!t){Y([]);return}const Z=F.toLowerCase(),L=t.id,ne=new Set(y.map(Me=>Me.id)),Ie=new Set(O.map(Me=>Me.toId)),de=new Set(k.map(Me=>Me.fromId)),qe=ie.filter(Me=>Me.id===L||!Me.name||!Me.coreBuddyAccess&&Me.clientType!=="core_buddy"?!1:Me.name.toLowerCase().includes(Z)).map(Me=>({...Me,isBuddy:ne.has(Me.id),isPendingOut:Ie.has(Me.id),isPendingIn:de.has(Me.id)})).slice(0,20);Y(qe)},[F,ie,y,O,k,t]);const I=async(Z,L)=>{if(!(!t||Z===t.id))try{await ua(Ft(me,"notifications"),{toId:Z,fromId:t.id,fromName:t.name||"Someone",fromPhotoURL:t.photoURL||null,type:L,read:!1,createdAt:yr()})}catch(ne){console.error("Notification error:",ne),ne.code==="permission-denied"&&D("Notifications blocked  check Firestore rules","error")}},ze=async Z=>{E(Z);try{const L=`${t.id}_${Z}`;await Ns($e(me,"buddyRequests",L),{fromId:t.id,toId:Z,status:"pending",createdAt:yr()}),await I(Z,"buddy_request"),D("Buddy request sent!","success"),await H()}catch(L){console.error("Error sending request:",L),D("Failed to send request","error")}finally{E(null)}},mt=async Z=>{E(Z.reqId);try{const L=M2(Z.fromId,t.id);await Ns($e(me,"buddies",L),{user1:[Z.fromId,t.id].sort()[0],user2:[Z.fromId,t.id].sort()[1],connectedAt:yr()}),await jr($e(me,"buddyRequests",Z.reqId)),await I(Z.fromId,"buddy_accept"),D("Buddy added!","success"),await H()}catch(L){console.error("Error accepting request:",L),D("Failed to accept","error")}finally{E(null)}},W=async Z=>{E(Z.reqId);try{await jr($e(me,"buddyRequests",Z.reqId)),D("Request declined","info"),await H()}catch(L){console.error("Error declining:",L),D("Failed to decline","error")}finally{E(null)}},ue=async Z=>{E(Z.reqId);try{await jr($e(me,"buddyRequests",Z.reqId)),D("Request cancelled","info"),await H()}catch(L){console.error("Error cancelling:",L),D("Failed to cancel","error")}finally{E(null)}},Re=async Z=>{E(Z);try{const L=M2(t.id,Z);await jr($e(me,"buddies",L)),D("Buddy removed","info"),await H()}catch(L){console.error("Error removing buddy:",L),D("Failed to remove buddy","error")}finally{E(null)}},Le=k.length;return i?r.jsx("div",{className:"bdy-loading",children:r.jsx("div",{className:"bdy-spinner"})}):!n||!e||!t?null:r.jsx(Sa,{children:r.jsxs("div",{className:"bdy-page","data-theme":l?"dark":"light",children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>d("/client/core-buddy"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),r.jsxs("main",{className:"bdy-main",children:[r.jsx("h1",{className:"bdy-title",children:"Buddies"}),r.jsxs("button",{className:"bdy-leaderboard-link",onClick:()=>d("/client/leaderboard"),children:[r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5C7 4 7 7 7 7"}),r.jsx("path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5C17 4 17 7 17 7"}),r.jsx("rect",{x:"6",y:"9",width:"12",height:"13",rx:"2"}),r.jsx("path",{d:"M12 9v13"}),r.jsx("path",{d:"M2 22h20"})]}),r.jsx("span",{children:"Leaderboard"}),r.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})]}),r.jsxs("div",{className:"bdy-tabs",children:[r.jsxs("button",{className:`bdy-tab${p==="buddies"?" active":""}`,onClick:()=>g("buddies"),children:[r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),r.jsx("circle",{cx:"9",cy:"7",r:"4"}),r.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),r.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),r.jsx("span",{children:"My Buddies"})]}),r.jsxs("button",{className:`bdy-tab${p==="requests"?" active":""}`,onClick:()=>g("requests"),children:[r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),r.jsx("circle",{cx:"9",cy:"7",r:"4"}),r.jsx("line",{x1:"19",y1:"8",x2:"19",y2:"14"}),r.jsx("line",{x1:"22",y1:"11",x2:"16",y2:"11"})]}),r.jsx("span",{children:"Requests"}),Le>0&&r.jsx("span",{className:"bdy-tab-badge",children:Le})]}),r.jsxs("button",{className:`bdy-tab${p==="search"?" active":""}`,onClick:()=>g("search"),children:[r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("circle",{cx:"11",cy:"11",r:"8"}),r.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),r.jsx("span",{children:"Find"})]})]}),Ne?r.jsx("div",{className:"bdy-content-loading",children:r.jsx("div",{className:"bdy-spinner"})}):r.jsxs(r.Fragment,{children:[p==="buddies"&&r.jsx("div",{className:"bdy-section",children:y.length===0?r.jsxs("div",{className:"bdy-empty",children:[r.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),r.jsx("circle",{cx:"9",cy:"7",r:"4"}),r.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),r.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),r.jsx("h3",{children:"No buddies yet"}),r.jsx("p",{children:"Find members and send buddy requests to connect!"}),r.jsx("button",{className:"bdy-empty-btn",onClick:()=>g("search"),children:"Find Buddies"})]}):r.jsx("div",{className:"bdy-list",children:y.map(Z=>r.jsxs("div",{className:"bdy-card",onClick:()=>d(`/client/core-buddy/profile/${Z.id}`),children:[r.jsx("div",{className:"bdy-avatar",children:Z.photoURL?r.jsx("img",{src:Z.photoURL,alt:Z.name}):r.jsx("span",{children:dh(Z.name)})}),r.jsx("div",{className:"bdy-card-info",children:r.jsx("span",{className:"bdy-card-name",children:Z.name})}),r.jsx("button",{className:"bdy-remove-btn",onClick:L=>{L.stopPropagation(),Re(Z.id)},disabled:R===Z.id,"aria-label":"Remove buddy",children:R===Z.id?r.jsx("div",{className:"bdy-btn-spinner"}):r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]},Z.id))})}),p==="requests"&&r.jsxs("div",{className:"bdy-section",children:[k.length>0&&r.jsxs(r.Fragment,{children:[r.jsx("h3",{className:"bdy-section-title",children:"Incoming"}),r.jsx("div",{className:"bdy-list",children:k.map(Z=>r.jsxs("div",{className:"bdy-card",children:[r.jsx("div",{className:"bdy-avatar",children:Z.fromClient.photoURL?r.jsx("img",{src:Z.fromClient.photoURL,alt:Z.fromClient.name}):r.jsx("span",{children:dh(Z.fromClient.name)})}),r.jsxs("div",{className:"bdy-card-info",children:[r.jsx("span",{className:"bdy-card-name",children:Z.fromClient.name}),r.jsx("span",{className:"bdy-card-sub",children:"wants to be your buddy"})]}),r.jsxs("div",{className:"bdy-action-pair",children:[r.jsx("button",{className:"bdy-accept-btn",onClick:()=>mt(Z),disabled:R===Z.reqId,children:R===Z.reqId?r.jsx("div",{className:"bdy-btn-spinner"}):r.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:r.jsx("path",{d:"M5 13l4 4L19 7"})})}),r.jsx("button",{className:"bdy-decline-btn",onClick:()=>W(Z),disabled:R===Z.reqId,children:r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]})]},Z.reqId))})]}),O.length>0&&r.jsxs(r.Fragment,{children:[r.jsx("h3",{className:"bdy-section-title",children:"Sent"}),r.jsx("div",{className:"bdy-list",children:O.map(Z=>r.jsxs("div",{className:"bdy-card",children:[r.jsx("div",{className:"bdy-avatar",children:Z.toClient?.photoURL?r.jsx("img",{src:Z.toClient.photoURL,alt:Z.toClient.name}):r.jsx("span",{children:dh(Z.toClient?.name)})}),r.jsxs("div",{className:"bdy-card-info",children:[r.jsx("span",{className:"bdy-card-name",children:Z.toClient?.name}),r.jsx("span",{className:"bdy-card-sub",children:"pending"})]}),r.jsx("button",{className:"bdy-cancel-btn",onClick:()=>ue(Z),disabled:R===Z.reqId,children:R===Z.reqId?r.jsx("div",{className:"bdy-btn-spinner"}):"Cancel"})]},Z.reqId))})]}),k.length===0&&O.length===0&&r.jsxs("div",{className:"bdy-empty",children:[r.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[r.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),r.jsx("path",{d:"M22 4L12 14.01l-3-3"})]}),r.jsx("h3",{children:"No pending requests"}),r.jsx("p",{children:"All caught up!"})]})]}),p==="search"&&r.jsxs("div",{className:"bdy-section",children:[r.jsxs("div",{className:"bdy-search-bar",children:[r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("circle",{cx:"11",cy:"11",r:"8"}),r.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),r.jsx("input",{type:"text",placeholder:"Search by name...",value:F,onChange:Z=>V(Z.target.value),autoFocus:!0}),F&&r.jsx("button",{className:"bdy-search-clear",onClick:()=>V(""),children:r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),F.trim()&&te.length===0&&r.jsx("div",{className:"bdy-empty bdy-empty-sm",children:r.jsxs("p",{children:['No members found for "',F,'"']})}),te.length>0&&r.jsx("div",{className:"bdy-list",children:te.map(Z=>r.jsxs("div",{className:"bdy-card",onClick:()=>d(`/client/core-buddy/profile/${Z.id}`),children:[r.jsx("div",{className:"bdy-avatar",children:Z.photoURL?r.jsx("img",{src:Z.photoURL,alt:Z.name}):r.jsx("span",{children:dh(Z.name)})}),r.jsxs("div",{className:"bdy-card-info",children:[r.jsx("span",{className:"bdy-card-name",children:Z.name}),Z.isBuddy&&r.jsx("span",{className:"bdy-card-badge",children:"Buddy"})]}),Z.isBuddy?r.jsx("span",{className:"bdy-status-icon",children:r.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"var(--color-success)",strokeWidth:"2.5",children:r.jsx("path",{d:"M5 13l4 4L19 7"})})}):Z.isPendingOut?r.jsx("span",{className:"bdy-pending-label",children:"Pending"}):Z.isPendingIn?r.jsx("button",{className:"bdy-accept-btn",onClick:L=>{L.stopPropagation();const ne=k.find(Ie=>Ie.fromId===Z.id);ne&&mt(ne)},disabled:!!R,children:r.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:r.jsx("path",{d:"M5 13l4 4L19 7"})})}):r.jsx("button",{className:"bdy-add-btn",onClick:L=>{L.stopPropagation(),ze(Z.id)},disabled:R===Z.id,children:R===Z.id?r.jsx("div",{className:"bdy-btn-spinner"}):r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),r.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})})]},Z.id))})]})]})]}),r.jsx(ha,{}),M&&r.jsxs("div",{className:`toast-notification ${M.type}`,children:[r.jsx("span",{className:"toast-icon",children:M.type==="success"?r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M5 13 L9 17 L19 7"})}):M.type==="error"?r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]}):r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),r.jsx("circle",{cx:"12",cy:"16",r:"1",fill:"currentColor"})]})}),r.jsx("span",{className:"toast-message",children:M.message})]})]})})}function hh(n){if(!n)return"?";const e=n.trim().split(/\s+/);return e.length===1?e[0][0].toUpperCase():(e[0][0]+e[e.length-1][0]).toUpperCase()}function Zp(n,e){return[n,e].sort().join("_")}const uP=5;function eg(n){return n.toISOString().split("T")[0]}function dP(n){return n>=1e6?`${(n/1e6).toFixed(1)}M`:n>=1e3?`${(n/1e3).toFixed(1)}T`:`${Math.round(n)}`}const hP={fullbody_4wk:{duration:4,daysPerWeek:3},fullbody_8wk:{duration:8,daysPerWeek:3},fullbody_12wk:{duration:12,daysPerWeek:3},core_4wk:{duration:4,daysPerWeek:3},core_8wk:{duration:8,daysPerWeek:3},core_12wk:{duration:12,daysPerWeek:3},upper_4wk:{duration:4,daysPerWeek:3},lower_4wk:{duration:4,daysPerWeek:3}};function I2(n){if(!n)return"";const e=n instanceof Date?n:n.toDate?n.toDate():new Date(n),t=Math.floor((new Date-e)/1e3);return t<60?"just now":t<3600?`${Math.floor(t/60)}m ago`:t<86400?`${Math.floor(t/3600)}h ago`:t<604800?`${Math.floor(t/86400)}d ago`:e.toLocaleDateString("en-GB",{day:"numeric",month:"short"})}function mP(){const{userId:n}=yE(),{currentUser:e,isClient:t,clientData:i,loading:l}=Vr(),{isDark:u,toggleTheme:d}=Ra(),p=lr(),[g,y]=v.useState(null),[x,k]=v.useState("none"),[T,O]=v.useState(null),[G,F]=v.useState(!0),[V,te]=v.useState(!1),[Y,ie]=v.useState(null),[he,Ne]=v.useState([]),[fe,R]=v.useState(!1),[E,M]=v.useState(new Set),[B,D]=v.useState(new Set),[H,I]=v.useState({}),[ze,mt]=v.useState({}),[W,ue]=v.useState({}),[Re,Le]=v.useState(!0),[Z,L]=v.useState(0),[ne,Ie]=v.useState(0),[de,qe]=v.useState(0),[Me,ot]=v.useState(0),[ft,Qe]=v.useState([]),[Vt,Ls]=v.useState([]),[jt,yt]=v.useState(null),[re,Nt]=v.useState(null),[vt,Pt]=v.useState(0),[Et,ut]=v.useState([]),[Ye,It]=v.useState(!1),[Xt,Ks]=v.useState(null),[Ut,Mt]=v.useState([]),is=v.useCallback((z,se="info")=>{ie({message:z,type:se}),setTimeout(()=>ie(null),3500)},[]);v.useEffect(()=>{!l&&(!e||!t)&&p("/")},[e,t,l,p]),v.useEffect(()=>{i&&n&&i.id===n&&p("/client/core-buddy",{replace:!0})},[i,n,p]),v.useEffect(()=>{if(!i||!n||i.id===n)return;let z=!1;return(async()=>{F(!0);try{const He=(await Ss(Ft(me,"clients"))).docs.map(pt=>({id:pt.id,...pt.data()})).find(pt=>pt.id===n);if(!He){z||F(!1);return}z||y(He);const Xe=i.id,lt=Zp(Xe,n);if((await As($e(me,"buddies",lt))).exists())z||k("buddy");else{const pt=`${Xe}_${n}`,Wt=await As($e(me,"buddyRequests",pt));if(Wt.exists()&&Wt.data().status==="pending")z||(k("pending_out"),O(pt));else{const en=`${n}_${Xe}`,ts=await As($e(me,"buddyRequests",en));ts.exists()&&ts.data().status==="pending"?z||(k("pending_in"),O(en)):z||k("none")}}}catch(se){console.error("Error loading profile:",se)}finally{z||F(!1)}})(),()=>{z=!0}},[i,n]),v.useEffect(()=>{if(!n||!g)return;let z=!1;return(async()=>{Le(!0);try{const[se,Ge,He,Xe]=await Promise.all([Ss(Ps(Ft(me,"workoutLogs"),ps("clientId","==",n))),As($e(me,"coreBuddyAchievements",n)),As($e(me,"coreBuddyPBs",n)),As($e(me,"clientProgrammes",n))]);if(z)return;const lt=se.docs.length;L(lt),Ge.exists()&&Ie(Ge.data().totalVolume||0);let _t=0;const pt=se.docs.map(ts=>ts.data().date).filter(Boolean).sort().reverse();if(pt.length>0){const ts=new Date;let ks=new Date(ts);for(let zs=0;zs<52;zs++){const $=new Date(ks),we=$.getDay(),Se=we===0?6:we-1;$.setDate($.getDate()-Se),$.setHours(0,0,0,0);const Ee=new Date($);Ee.setDate(Ee.getDate()+7);const ke=eg($),dt=eg(Ee);if(pt.some(st=>st>=ke&&st<dt))_t++;else{if(zs>0)break;break}ks.setDate(ks.getDate()-7)}}if(z||qe(_t),He.exists()){const ts=He.data().exercises||{},ks=Object.entries(ts).sort(([,zs],[,$])=>($.weight||0)-(zs.weight||0)).slice(0,3).map(([zs,$])=>({name:zs,weight:$.weight,reps:$.reps}));z||Qe(ks)}if(Xe.exists()){const ts=Xe.data(),ks=hP[ts.templateId];if(ks){const zs=Object.keys(ts.completedSessions||{}).length,$=ks.duration*ks.daysPerWeek;z||(Nt(ts.templateId.replace(/_/g," ").replace(/\b\w/g,we=>we.toUpperCase())),Pt($>0?Math.round(zs/$*100):0))}}const Wt=await As($e(me,"achievements",n));if(!z&&Wt.exists()){const ts=Wt.data().badges||{};Ls(Object.keys(ts))}let en=0;for(let ts=0;ts<30;ts++){const ks=new Date;ks.setDate(ks.getDate()-ts);const zs=eg(ks);try{const $=await Ss(Ps(Ft(me,"habitLogs"),ps("clientId","==",n),ps("date","==",zs)));if($.empty)break;{const we=$.docs[0].data().habits||{};if(Object.values(we).filter(Boolean).length>=uP)en++;else break}}catch{break}}z||ot(en)}catch(se){console.error("Error loading buddy stats:",se)}finally{z||Le(!1)}})(),()=>{z=!0}},[n,g]),v.useEffect(()=>{if(!i)return;const z=i.id;(async()=>{try{const[se,Ge,He]=await Promise.all([Ss(Ps(Ft(me,"buddies"),ps("user1","==",z))),Ss(Ps(Ft(me,"buddies"),ps("user2","==",z))),Ss(Ft(me,"clients"))]),Xe=new Set;[...se.docs,...Ge.docs].forEach(_t=>{const pt=_t.data();Xe.add(pt.user1===z?pt.user2:pt.user1)});const lt={};He.docs.forEach(_t=>{lt[_t.id]=_t.data()}),ut(Array.from(Xe).filter(_t=>lt[_t]).map(_t=>({id:_t,name:lt[_t].name,photoURL:lt[_t].photoURL||null})))}catch(se){console.error("Error loading buddies for mentions:",se)}})()},[i]);const Ms=async(z,se,Ge={})=>{if(!(!i||z===i.id))try{await ua(Ft(me,"notifications"),{toId:z,fromId:i.id,fromName:i.name||"Someone",fromPhotoURL:i.photoURL||null,type:se,read:!1,createdAt:yr(),...Ge})}catch(He){console.error("Notification error:",He),He.code==="permission-denied"&&is("Notifications blocked  check Firestore rules","error")}},Kt=async()=>{te(!0);try{const z=`${i.id}_${n}`;await Ns($e(me,"buddyRequests",z),{fromId:i.id,toId:n,status:"pending",createdAt:yr()}),await Ms(n,"buddy_request"),k("pending_out"),O(z),is("Buddy request sent!","success")}catch(z){console.error(z),is("Failed to send request","error")}finally{te(!1)}},on=async()=>{if(T){te(!0);try{const z=Zp(i.id,n);await Ns($e(me,"buddies",z),{user1:[i.id,n].sort()[0],user2:[i.id,n].sort()[1],connectedAt:yr()}),await jr($e(me,"buddyRequests",T)),await Ms(n,"buddy_accept"),k("buddy"),is("Buddy added!","success")}catch(z){console.error(z),is("Failed to accept","error")}finally{te(!1)}}},ds=async()=>{if(T){te(!0);try{await jr($e(me,"buddyRequests",T)),k("none"),is(x==="pending_out"?"Request cancelled":"Request declined","info")}catch(z){console.error(z),is("Failed","error")}finally{te(!1)}}},_s=async()=>{te(!0);try{const z=Zp(i.id,n);await jr($e(me,"buddies",z)),k("none"),is("Buddy removed","info")}catch(z){console.error(z),is("Failed to remove","error")}finally{te(!1)}},Ct=v.useCallback(async()=>{if(n){R(!0);try{const z=await Ss(Ps(Ft(me,"posts"),ps("authorId","==",n),Kh("createdAt","desc"),Yh(30)));if(Ne(z.docs.map(se=>({id:se.id,...se.data()}))),i){const se=await Ss(Ps(Ft(me,"postLikes"),ps("userId","==",i.id)));M(new Set(se.docs.map(Ge=>Ge.data().postId)))}}catch(z){console.error("Error loading journey:",z)}finally{R(!1)}}},[n,i]);v.useEffect(()=>{!G&&g&&Ct()},[G,g,Ct]);const be=async z=>{if(window.confirm("Delete this post?"))try{await jr($e(me,"posts",z)),Ne(se=>se.filter(Ge=>Ge.id!==z)),is("Post deleted","info")}catch(se){console.error("Delete error:",se),is("Failed to delete","error")}},Te=async z=>{if(!i)return;const se=i.id,Ge=`${z}_${se}`,He=E.has(z),Xe=new Set(E);He?Xe.delete(z):Xe.add(z),M(Xe),Ne(lt=>lt.map(_t=>_t.id===z?{..._t,likeCount:Math.max(0,(_t.likeCount||0)+(He?-1:1))}:_t));try{if(He)await jr($e(me,"postLikes",Ge)),await Ba($e(me,"posts",z),{likeCount:zo(-1)});else{await Ns($e(me,"postLikes",Ge),{postId:z,userId:se,createdAt:yr()}),await Ba($e(me,"posts",z),{likeCount:zo(1)});const lt=he.find(_t=>_t.id===z);lt&&Ms(lt.authorId,"like",{postId:z})}}catch(lt){console.error("Like error:",lt),Ct()}},Be=async z=>{try{const se=await Ss(Ps(Ft(me,"postComments"),ps("postId","==",z),Kh("createdAt","asc"),Yh(50)));I(Ge=>({...Ge,[z]:se.docs.map(He=>({id:He.id,...He.data()}))}))}catch(se){console.error("Error loading comments:",se)}},Ue=z=>{const se=new Set(B);se.has(z)?se.delete(z):(se.add(z),H[z]||Be(z)),D(se)},J=(z,se)=>{const Ge=z.match(/@(\w*)$/);if(Ge){It(!0),Ks(se);const He=Et.filter(Xe=>Xe.name&&Xe.name.toLowerCase().includes(Ge[1].toLowerCase())).slice(0,5);Mt(He)}else It(!1),Mt([])},ge=(z,se)=>{const He=(ze[se]||"").replace(/@\w*$/,`@${z.name} `);mt(Xe=>({...Xe,[se]:He})),It(!1),Mt([])},We=(z,se)=>{mt(Ge=>({...Ge,[z]:se})),J(se,z)},Ke=async z=>{const se=(ze[z]||"").trim();if(!(!se||!i)){ue(Ge=>({...Ge,[z]:!0}));try{await ua(Ft(me,"postComments"),{postId:z,authorId:i.id,authorName:i.name||"Unknown",authorPhotoURL:i.photoURL||null,content:se,createdAt:yr()}),await Ba($e(me,"posts",z),{commentCount:zo(1)});const Ge=he.find(Xe=>Xe.id===z);Ge&&Ms(Ge.authorId,"comment",{postId:z});const He=se.match(/@[\w\s]+?(?=\s@|\s*$|[.,!?])/g);if(He){const Xe=new Set;He.forEach(lt=>{const _t=lt.slice(1).trim(),pt=Et.find(Wt=>Wt.name&&Wt.name.toLowerCase()===_t.toLowerCase());pt&&!Xe.has(pt.id)&&(Xe.add(pt.id),Ms(pt.id,"mention",{postId:z}))})}mt(Xe=>({...Xe,[z]:""})),Ne(Xe=>Xe.map(lt=>lt.id===z?{...lt,commentCount:(lt.commentCount||0)+1}:lt)),await Be(z)}catch(Ge){console.error("Comment error:",Ge),is("Failed to comment","error")}finally{ue(Ge=>({...Ge,[z]:!1}))}}};return l||G||!i?r.jsx("div",{className:"prf-loading","data-theme":u?"dark":"light",children:r.jsx("div",{className:"prf-spinner"})}):!e||!t?null:g?r.jsx(Sa,{children:r.jsxs("div",{className:"prf-page","data-theme":u?"dark":"light",children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>p(-1),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:d,"aria-label":"Toggle theme",children:u?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),r.jsxs("main",{className:"prf-main",children:[r.jsxs("div",{className:"prf-hero",children:[r.jsx("div",{className:"prf-avatar-lg",children:g.photoURL?r.jsx("img",{src:g.photoURL,alt:g.name}):r.jsx("span",{children:hh(g.name)})}),r.jsx("h1",{className:"prf-name",children:g.name}),r.jsxs("div",{className:"prf-buddy-action",children:[x==="none"&&r.jsx("button",{className:"prf-btn prf-btn-primary",onClick:Kt,disabled:V,children:V?r.jsx("div",{className:"prf-btn-spinner"}):r.jsxs(r.Fragment,{children:[r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),r.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),"Add Buddy"]})}),x==="pending_out"&&r.jsx("button",{className:"prf-btn prf-btn-secondary",onClick:ds,disabled:V,children:V?r.jsx("div",{className:"prf-btn-spinner dark"}):"Cancel Request"}),x==="pending_in"&&r.jsxs("div",{className:"prf-btn-pair",children:[r.jsx("button",{className:"prf-btn prf-btn-success",onClick:on,disabled:V,children:V?r.jsx("div",{className:"prf-btn-spinner"}):"Accept"}),r.jsx("button",{className:"prf-btn prf-btn-secondary",onClick:ds,disabled:V,children:"Decline"})]}),x==="buddy"&&r.jsx("button",{className:"prf-btn prf-btn-danger",onClick:_s,disabled:V,children:V?r.jsx("div",{className:"prf-btn-spinner"}):"Remove Buddy"})]})]}),Re?r.jsx("div",{className:"prf-stats-loading",children:r.jsx("div",{className:"prf-spinner"})}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"prf-stats",children:[r.jsxs("div",{className:"prf-stat",children:[r.jsx("span",{className:"prf-stat-value",children:Z}),r.jsx("span",{className:"prf-stat-label",children:"Workouts"})]}),r.jsxs("div",{className:"prf-stat",children:[r.jsxs("span",{className:"prf-stat-value",children:[dP(ne),r.jsx("span",{className:"prf-stat-unit",children:ne>=1e3?"":"kg"})]}),r.jsxs("span",{className:"prf-stat-label",children:[ne>=1e6?"Million kg":ne>=1e3?"Tonnes":"Volume"," Lifted"]})]}),r.jsxs("div",{className:"prf-stat",children:[r.jsxs("span",{className:"prf-stat-value",children:[de,r.jsx("span",{className:"prf-stat-unit",children:"wk"})]}),r.jsx("span",{className:"prf-stat-label",children:"Streak"})]})]}),(re||Me>0)&&r.jsxs("div",{className:"prf-info-row",children:[re&&r.jsxs("div",{className:"prf-info-card info-programme",children:[r.jsx("div",{className:"prf-info-icon",children:r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M4 19.5A2.5 2.5 0 0 1 6.5 17H20"}),r.jsx("path",{d:"M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"})]})}),r.jsxs("div",{className:"prf-info-text",children:[r.jsx("span",{className:"prf-info-label",children:re}),r.jsx("div",{className:"prf-info-progress-bar",children:r.jsx("div",{className:"prf-info-progress-fill",style:{width:`${Math.min(vt,100)}%`}})}),r.jsxs("span",{className:"prf-info-sub",children:[vt,"% complete"]})]})]}),Me>0&&r.jsxs("div",{className:"prf-info-card info-habit",children:[r.jsx("div",{className:"prf-info-icon",children:r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),r.jsx("path",{d:"M22 4L12 14.01l-3-3"})]})}),r.jsxs("div",{className:"prf-info-text",children:[r.jsxs("span",{className:"prf-info-value",children:[Me," day",Me!==1?"s":""]}),r.jsx("span",{className:"prf-info-sub",children:"Habit Streak"})]})]})]}),ft.length>0&&r.jsxs("div",{className:"prf-section",children:[r.jsx("h2",{className:"prf-section-title",children:"Top Lifts"}),r.jsx("div",{className:"prf-pb-list",children:ft.map((z,se)=>r.jsxs("div",{className:"prf-pb-item",children:[r.jsx("div",{className:"prf-pb-rank",children:se===0?r.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",stroke:"none",children:r.jsx("path",{d:"M12 2l2.4 7.4H22l-6 4.4 2.3 7.2L12 16.6 5.7 21l2.3-7.2-6-4.4h7.6z"})}):`#${se+1}`}),r.jsx("span",{className:"prf-pb-name",children:z.name}),r.jsxs("span",{className:"prf-pb-weight",children:[z.weight,r.jsx("span",{className:"prf-pb-unit",children:"kg"})," x",z.reps]})]},se))})]}),Vt.length>0&&r.jsxs("div",{className:"prf-section",children:[r.jsxs("h2",{className:"prf-section-title",children:["Badges Earned (",Vt.length,")"]}),r.jsx("div",{className:"prf-badge-row",children:Vt.map(z=>{const se=$n.find(Ge=>Ge.id===z);return se?r.jsx("button",{className:"prf-badge-chip",onClick:()=>yt(se),children:r.jsx("img",{src:se.img,alt:se.name,className:"prf-badge-chip-img"})},z):null})})]}),jt&&r.jsx("div",{className:"prf-badge-overlay",onClick:()=>yt(null),children:r.jsxs("div",{className:"prf-badge-overlay-content",onClick:z=>z.stopPropagation(),children:[r.jsx("img",{src:jt.img,alt:jt.name,className:"prf-badge-overlay-img"}),r.jsx("p",{className:"prf-badge-overlay-desc",children:jt.desc}),r.jsx("button",{className:"prf-badge-overlay-close",onClick:()=>yt(null),children:"Tap to close"})]})})]}),r.jsxs("div",{className:"prf-section",children:[r.jsx("h2",{className:"prf-section-title",children:`${g.name?.split(" ")[0]}'s Journey`}),fe?r.jsx("div",{className:"journey-loading",children:r.jsx("div",{className:"prf-spinner"})}):he.length===0?r.jsxs("div",{className:"journey-empty",children:[r.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),r.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),r.jsx("path",{d:"M21 15l-5-5L5 21"})]}),r.jsx("p",{children:"No posts yet"})]}):r.jsx("div",{className:"journey-list",children:he.map(z=>r.jsxs("div",{className:"journey-post",children:[r.jsxs("div",{className:"journey-post-header",children:[r.jsx("div",{className:"journey-post-avatar",children:z.authorPhotoURL?r.jsx("img",{src:z.authorPhotoURL,alt:""}):r.jsx("span",{children:hh(z.authorName)})}),r.jsxs("div",{className:"journey-post-meta",children:[r.jsx("span",{className:"journey-post-name",children:z.authorName}),r.jsx("span",{className:"journey-post-time",children:I2(z.createdAt)})]}),z.authorId===i.id&&r.jsx("button",{className:"journey-delete-btn",onClick:()=>be(z.id),"aria-label":"Delete post",children:r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M3 6h18"}),r.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),r.jsx("path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]}),z.content&&r.jsx("p",{className:"journey-post-content",children:z.content}),z.imageURL&&r.jsx("div",{className:"journey-post-image",children:r.jsx("img",{src:z.imageURL,alt:"Post",loading:"lazy"})}),r.jsxs("div",{className:"journey-post-actions",children:[r.jsxs("button",{className:`journey-action-btn${E.has(z.id)?" liked":""}`,onClick:()=>Te(z.id),children:[r.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:E.has(z.id)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})}),r.jsx("span",{children:z.likeCount||0})]}),r.jsxs("button",{className:`journey-action-btn${B.has(z.id)?" active":""}`,onClick:()=>Ue(z.id),children:[r.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})}),r.jsx("span",{children:z.commentCount||0})]})]}),B.has(z.id)&&r.jsxs("div",{className:"journey-comments",children:[H[z.id]?.length>0?H[z.id].map(se=>r.jsxs("div",{className:"journey-comment",children:[r.jsx("div",{className:"journey-comment-avatar",onClick:()=>p(`/client/core-buddy/profile/${se.authorId}`),children:se.authorPhotoURL?r.jsx("img",{src:se.authorPhotoURL,alt:""}):r.jsx("span",{children:hh(se.authorName)})}),r.jsxs("div",{className:"journey-comment-body",children:[r.jsxs("div",{className:"journey-comment-bubble",children:[r.jsx("span",{className:"journey-comment-name",children:se.authorName}),r.jsx("span",{className:"journey-comment-text",children:se.content})]}),r.jsx("span",{className:"journey-comment-time",children:I2(se.createdAt)})]})]},se.id)):r.jsx("p",{className:"journey-no-comments",children:"No comments yet"}),r.jsxs("div",{className:"journey-comment-input",style:{position:"relative"},children:[r.jsx("input",{type:"text",placeholder:"Comment... (@ to mention)",value:ze[z.id]||"",onChange:se=>We(z.id,se.target.value),onKeyDown:se=>{se.key==="Enter"&&Ke(z.id)},maxLength:300}),Ye&&Xt===z.id&&Ut.length>0&&r.jsx("div",{className:"mention-dropdown mention-dropdown-up",children:Ut.map(se=>r.jsxs("button",{className:"mention-option",onClick:()=>ge(se,z.id),children:[r.jsx("div",{className:"mention-option-avatar",children:se.photoURL?r.jsx("img",{src:se.photoURL,alt:""}):r.jsx("span",{children:hh(se.name)})}),r.jsx("span",{children:se.name})]},se.id))}),r.jsx("button",{onClick:()=>Ke(z.id),disabled:!(ze[z.id]||"").trim()||W[z.id],children:W[z.id]?r.jsx("div",{className:"journey-btn-spinner-sm"}):r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"22",y1:"2",x2:"11",y2:"13"}),r.jsx("polygon",{points:"22 2 15 22 11 13 2 9 22 2"})]})})]})]})]},z.id))})]})]}),r.jsx(ha,{}),Y&&r.jsxs("div",{className:`toast-notification ${Y.type}`,children:[r.jsx("span",{className:"toast-icon",children:Y.type==="success"?r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M5 13 L9 17 L19 7"})}):Y.type==="error"?r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]}):r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),r.jsx("circle",{cx:"12",cy:"16",r:"1",fill:"currentColor"})]})}),r.jsx("span",{className:"toast-message",children:Y.message})]})]})}):r.jsxs("div",{className:"prf-page","data-theme":u?"dark":"light",children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>p(-1),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions"})]})}),r.jsx("main",{className:"prf-main",children:r.jsx("p",{style:{textAlign:"center",color:"var(--text-tertiary)",padding:"40px 0"},children:"User not found"})}),r.jsx(ha,{})]})}function fP(){const n=lr(),{clientData:e,currentUser:t,resolveClient:i,updateClientData:l}=Vr(),[u,d]=v.useState([]),[p,g]=v.useState(""),[y,x]=v.useState(!1),[k,T]=v.useState(null),[O,G]=v.useState(!1),[F,V]=v.useState(null),te=v.useRef(null),Y=v.useRef(null);if(!e?.buddyEnabled)return r.jsxs("div",{className:"buddy-page",children:[r.jsxs("div",{className:"buddy-container",children:[r.jsx("p",{children:"Buddy is not enabled on your account."}),r.jsx("button",{onClick:()=>n("/client/core-buddy"),children:"Back to Dashboard"})]}),r.jsx(ha,{active:"home"})]});v.useEffect(()=>{te.current&&te.current.scrollIntoView({behavior:"smooth"})},[u,y]),v.useEffect(()=>{u.length===0&&!y&&ie([])},[]);const ie=async E=>{x(!0),T(null);try{const B=await(await fetch("/api/buddy-onboarding",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({messages:E,clientName:e?.name||t?.displayName||"there"})})).json();if(B.error){T(B.error);return}const D={role:"assistant",content:B.reply};d(H=>[...H,D]),B.profileData&&(await R(B.profileData),V(B.profileData),G(!0))}catch(M){console.error("Buddy chat error:",M),T("Something went wrong  try sending again.")}finally{x(!1)}},he=()=>{const E=p.trim();if(!E||y)return;const M={role:"user",content:E},B=[...u,M];d(B),g(""),Y.current&&Y.current.focus(),ie(B)},Ne=E=>{E.key==="Enter"&&!E.shiftKey&&(E.preventDefault(),he())},fe=E=>{const M=E?.experience||"beginner";return M==="advanced"?{id:"fullbody_12wk",name:"12-Week Full Body",duration:12,level:"Advanced",daysPerWeek:3,description:"Complete transformation programme  push, pull, and legs over three phases."}:M==="intermediate"?{id:"fullbody_8wk",name:"8-Week Full Body",duration:8,level:"Intermediate",daysPerWeek:3,description:"Two-phase programme building strength and endurance across your full body."}:{id:"fullbody_4wk",name:"4-Week Full Body",duration:4,level:"All Levels",daysPerWeek:3,description:"Build total body strength with compound dumbbell movements and bodyweight finishers."}},R=async E=>{try{const M=await i();if(!M)return;await Ns($e(me,"onboardingSubmissions",M.id),{clientId:M.id,clientName:M.name,email:M.email,source:"buddy_chat",welcome:{dob:E.dob||null,gender:E.gender||null,goals:E.goals||[],experience:E.experience||null,injuries:E.injuries||null,activityLevel:E.activityLevel||null,exerciseHistory:E.exerciseHistory||null,sleepHours:E.sleepHours||null,stressLevel:E.stressLevel||null,dietaryInfo:E.dietaryInfo||null,availability:E.availability||null,additionalInfo:E.additionalInfo||null},submittedAt:yr()});const B=E.goals||[];await Ba($e(me,"clients",M.id),{fitnessGoal:B[0]||null,fitnessGoals:B,experienceLevel:E.experience||null,dob:E.dob||null,injuries:E.injuries||null}),l({fitnessGoal:B[0]||null,fitnessGoals:B,experienceLevel:E.experience,dob:E.dob})}catch(M){console.error("Save profile error:",M)}};return r.jsx(Sa,{children:r.jsxs("div",{className:"buddy-page buddy-page--chat",children:[r.jsxs("div",{className:"buddy-chat-container",children:[r.jsxs("div",{className:"buddy-chat-top",children:[r.jsx("button",{className:"buddy-back",onClick:()=>n("/client/core-buddy"),children:r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsxs("div",{className:"buddy-chat-header",children:[r.jsx("div",{className:"buddy-chat-avatar",children:r.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M12 2a4 4 0 0 1 4 4v2a4 4 0 0 1-8 0V6a4 4 0 0 1 4-4z"}),r.jsx("path",{d:"M18 14c2 1 3 3 3 5v2H3v-2c0-2 1-4 3-5"}),r.jsx("circle",{cx:"9",cy:"7",r:"0.5",fill:"currentColor"}),r.jsx("circle",{cx:"15",cy:"7",r:"0.5",fill:"currentColor"}),r.jsx("path",{d:"M9.5 10a2.5 2.5 0 0 0 5 0"})]})}),r.jsxs("div",{children:[r.jsx("h2",{className:"buddy-chat-name",children:"Buddy"}),r.jsx("span",{className:"buddy-chat-status",children:y?"typing...":"Your AI Coach"})]})]})]}),r.jsxs("div",{className:"buddy-chat-messages",children:[u.map((E,M)=>r.jsxs("div",{className:`buddy-chat-bubble buddy-chat-${E.role}`,children:[E.role==="assistant"&&r.jsx("div",{className:"buddy-chat-bubble-avatar",children:"B"}),r.jsx("div",{className:"buddy-chat-bubble-content",children:E.content})]},M)),y&&r.jsxs("div",{className:"buddy-chat-bubble buddy-chat-assistant",children:[r.jsx("div",{className:"buddy-chat-bubble-avatar",children:"B"}),r.jsxs("div",{className:"buddy-chat-bubble-content buddy-chat-typing",children:[r.jsx("span",{}),r.jsx("span",{}),r.jsx("span",{})]})]}),k&&r.jsxs("div",{className:"buddy-chat-error",children:[k,r.jsx("button",{onClick:()=>ie(u),children:"Retry"})]}),r.jsx("div",{ref:te})]}),O?r.jsx("div",{className:"buddy-chat-done",children:F?(()=>{const E=fe(F);return r.jsxs(r.Fragment,{children:[r.jsx("p",{className:"buddy-chat-done-text",children:"Profile saved! Here's my pick for you:"}),r.jsxs("div",{className:"buddy-rec-card",onClick:()=>n("/client/core-buddy/programmes",{state:{templateId:E.id}}),children:[r.jsx("div",{className:"buddy-rec-name",children:E.name}),r.jsxs("div",{className:"buddy-rec-meta",children:[E.duration," weeks  ",E.daysPerWeek," days/week  ",E.level]}),r.jsx("div",{className:"buddy-rec-desc",children:E.description}),r.jsx("div",{className:"buddy-rec-cta",children:"View Programme"})]}),r.jsx("button",{className:"buddy-chat-skip-btn",onClick:()=>n("/client/core-buddy"),children:"Maybe later"})]})})():r.jsxs(r.Fragment,{children:[r.jsx("p",{className:"buddy-chat-done-text",children:"Profile saved  you're all set."}),r.jsx("button",{className:"buddy-chat-done-btn",onClick:()=>n("/client/core-buddy"),children:"Back to Dashboard"})]})}):r.jsxs("div",{className:"buddy-chat-input-wrap",children:[r.jsx("textarea",{ref:Y,className:"buddy-chat-input",placeholder:"Type your message...",value:p,onChange:E=>g(E.target.value),onKeyDown:Ne,rows:1,disabled:y}),r.jsx("button",{className:"buddy-chat-send",onClick:he,disabled:!p.trim()||y,"aria-label":"Send message",children:r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("line",{x1:"22",y1:"2",x2:"11",y2:"13"}),r.jsx("polygon",{points:"22 2 15 22 11 13 2 9 22 2"})]})})]})]}),r.jsx(ha,{active:"home"})]})})}const xa=[{key:"pressUps",name:"Press-Ups",category:"Upper Body",unit:"reps"},{key:"squats",name:"Squats",category:"Lower Body",unit:"reps"},{key:"longJump",name:"Standing Long Jump",category:"Power",unit:"distance"},{key:"deadHang",name:"Dead Hang",category:"Upper Body",unit:"time"},{key:"plank",name:"Plank",category:"Core",unit:"time"},{key:"wallSit",name:"Wall Sit",category:"Lower Body",unit:"time"},{key:"chestPress",name:"Chest Press",category:"Upper Body",unit:"weight"}],Bo=[{key:"weight",name:"Weight",suffix:"kg"},{key:"chest",name:"Chest",suffix:"cm"},{key:"waist",name:"Waist",suffix:"cm"},{key:"hips",name:"Hips",suffix:"cm"},{key:"leftArm",name:"Left Arm",suffix:"cm"},{key:"rightArm",name:"Right Arm",suffix:"cm"},{key:"leftThigh",name:"Left Thigh",suffix:"cm"},{key:"rightThigh",name:"Right Thigh",suffix:"cm"}];function pP(){const n=new Date;return`${n.getFullYear()}-${String(n.getMonth()+1).padStart(2,"0")}`}function wa(n){const[e,t]=n.split("-");return new Date(parseInt(e),parseInt(t)-1).toLocaleDateString("en-GB",{month:"long",year:"numeric"})}function gP(n){if(!n&&n!==0)return"-";const e=Math.floor(n/60),t=(n%60).toFixed(2);return e>0?`${e}m ${parseFloat(t).toFixed(0)}s`:`${parseFloat(t).toFixed(2)}s`}function yP(n,e){return!n&&n!==0?"-":!e&&e!==0?`${n}kg`:`${n}kg x ${e}`}function mh(n,e){if(!e)return"-";switch(n.unit){case"weight":return yP(e.weight,e.reps);case"time":return gP(e.time);case"reps":return e.reps?`${e.reps} reps`:"-";case"distance":return e.distance?`${e.distance} cm`:"-";default:return"-"}}function Vl(n,e){if(!e)return 0;switch(n.unit){case"weight":return(e.weight||0)*(e.reps||0);case"time":return e.time||0;case"reps":return e.reps||0;case"distance":return e.distance||0;default:return 0}}function tg(n,e){return!e||e===0?null:(n-e)/e*100}function bP({data:n,exerciseKey:e,unit:t}){if(!n||n.length<2)return r.jsx("div",{className:"pb-trend-empty",children:r.jsx("p",{children:"Not enough data for trend line yet"})});const i=n.map(F=>{const V=F.benchmarks?.[e];if(!V)return 0;switch(t){case"weight":return(V.weight||0)*(V.reps||0);case"time":return V.time||0;case"reps":return V.reps||0;case"distance":return V.distance||0;default:return 0}}),l=Math.max(...i),u=Math.min(...i),d=l-u||1,p=300,g=100,y=20,x=p-y*2,k=g-y*2,T=i.map((F,V)=>{const te=y+V/(i.length-1)*x,Y=y+k-(F-u)/d*k;return{x:te,y:Y,value:F}}),O=T.map((F,V)=>`${V===0?"M":"L"} ${F.x} ${F.y}`).join(" "),G=O+` L ${T[T.length-1].x} ${y+k} L ${T[0].x} ${y+k} Z`;return r.jsxs("div",{className:"pb-trend-chart",children:[r.jsxs("svg",{viewBox:`0 0 ${p} ${g}`,preserveAspectRatio:"xMidYMid meet",children:[r.jsx("defs",{children:r.jsxs("linearGradient",{id:"trendGradientJr",x1:"0",y1:"0",x2:"0",y2:"1",children:[r.jsx("stop",{offset:"0%",stopColor:"var(--color-primary)",stopOpacity:"0.3"}),r.jsx("stop",{offset:"100%",stopColor:"var(--color-primary)",stopOpacity:"0.02"})]})}),r.jsx("path",{d:G,fill:"url(#trendGradientJr)"}),r.jsx("path",{d:O,fill:"none",stroke:"var(--color-primary)",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round"}),T.map((F,V)=>r.jsx("circle",{cx:F.x,cy:F.y,r:"4",fill:"var(--bg-card)",stroke:"var(--color-primary)",strokeWidth:"2"},V))]}),r.jsx("div",{className:"pb-trend-labels",children:n.map((F,V)=>r.jsxs("span",{className:"pb-trend-label",children:[F.month.split("-")[1],"/",F.month.split("-")[0].slice(2)]},V))})]})}function vP(){const[n,e]=v.useState("bests"),[t,i]=v.useState([]),[l,u]=v.useState(!0),[d,p]=v.useState(!1),[g,y]=v.useState(0),[x,k]=v.useState(!1),[T,O]=v.useState(!1),[G,F]=v.useState(!1),[V,te]=v.useState({}),[Y,ie]=v.useState({}),[he,Ne]=v.useState({}),[fe,R]=v.useState({}),[E,M]=v.useState({}),[B,D]=v.useState(!1),[H,I]=v.useState({}),[ze,mt]=v.useState([]),[W,ue]=v.useState(null),[Re,Le]=v.useState(null),[Z,L]=v.useState(!1),[ne,Ie]=v.useState(""),[de,qe]=v.useState(""),Me=v.useRef(null),ot=v.useRef(0),ft=v.useRef(0),Qe=v.useRef("right"),Vt=v.useCallback($=>{y(we=>{const Se=Math.max(0,Math.min(xa.length-1,$));return Se===we?we:(Qe.current=Se>we?"right":"left",Se)})},[]),{currentUser:Ls,isClient:jt,clientData:yt,loading:re}=Vr(),{isDark:Nt}=Ra(),vt=lr(),Pt=v.useCallback(($,we="info")=>{Le({message:$,type:we}),setTimeout(()=>Le(null),4e3)},[]);v.useEffect(()=>{!re&&(!Ls||!jt)&&vt("/")},[Ls,jt,re,vt]),v.useEffect(()=>{yt&&Et()},[yt]);const Et=async()=>{try{const $=Ps(Ft(me,"juniorPBs"),ps("clientId","==",yt.id)),Se=(await Ss($)).docs.map(st=>({id:st.id,...st.data()}));Se.sort((st,St)=>st.month.localeCompare(St.month)),i(Se);const Ee=Ps(Ft(me,"juniorPBTargets"),ps("clientId","==",yt.id)),ke=await Ss(Ee);if(!ke.empty){const st=ke.docs[0].data();Ne(st.targets||{}),R(st.metricTargets||{}),M(st.targets||{}),I(st.metricTargets||{})}const dt=Ps(Ft(me,"juniorAchievements"),ps("clientId","==",yt.id)),bt=await Ss(dt);bt.empty||mt(bt.docs[0].data().badges||[])}catch($){console.error("Error fetching junior personal bests:",$)}u(!1)},ut=pP(),Ye=t.find($=>$.month===ut),It=t.filter($=>$.month<ut),Xt=It.length>0?It[It.length-1]:null;v.useEffect(()=>{Ye?(te(Ye.benchmarks||{}),ie(Ye.bodyMetrics||{})):(te({}),ie({}))},[Ye?.id]);const Ks=async($,we)=>{const Se=[];if($==="strength"?xa.forEach(Ee=>{const ke=he[Ee.key];if(!ke)return;const dt=we[Ee.key];if(!dt)return;let bt;if(ke.targetType==="time"){if(!ke.targetValue)return;const st=ke.startValue||0,St=dt.time||0,xt=ke.targetValue-st;bt=xt===0?St>=ke.targetValue?1:0:Math.max(0,(St-st)/xt)}else if(ke.targetType==="reps"){if(!ke.targetReps)return;const st=ke.startReps||0,St=dt.reps||0,xt=ke.targetReps-st;bt=xt===0?St>=ke.targetReps?1:0:Math.max(0,(St-st)/xt)}else if(ke.targetType==="distance"){if(!ke.targetDistance)return;const st=ke.startDistance||0,St=dt.distance||0,xt=ke.targetDistance-st;bt=xt===0?St>=ke.targetDistance?1:0:Math.max(0,(St-st)/xt)}else{if(!ke.targetWeight&&!ke.targetReps)return;const st=(ke.startWeight||0)*(ke.startReps||0),St=(ke.targetWeight||0)*(ke.targetReps||0),xt=(dt.weight||0)*(dt.reps||0),hs=St-st;bt=hs===0?xt>=St?1:0:Math.max(0,(xt-st)/hs)}if(bt>=1){let st,St;ke.targetType==="time"?(st=ze.some(xt=>xt.type==="strength"&&xt.key===Ee.key&&xt.targetValue===ke.targetValue),St=`${Ee.name} ${ke.targetValue}s`):ke.targetType==="reps"?(st=ze.some(xt=>xt.type==="strength"&&xt.key===Ee.key&&xt.targetReps===ke.targetReps),St=`${Ee.name} ${ke.targetReps} reps`):ke.targetType==="distance"?(st=ze.some(xt=>xt.type==="strength"&&xt.key===Ee.key&&xt.targetDistance===ke.targetDistance),St=`${Ee.name} ${ke.targetDistance}cm`):(st=ze.some(xt=>xt.type==="strength"&&xt.key===Ee.key&&xt.targetWeight===ke.targetWeight&&xt.targetReps===ke.targetReps),St=`${Ee.name} ${ke.targetWeight}kg  ${ke.targetReps}`),st||Se.push({type:"strength",key:Ee.key,...ke.targetType==="time"?{targetType:"time",targetValue:ke.targetValue}:ke.targetType==="reps"?{targetType:"reps",targetReps:ke.targetReps}:ke.targetType==="distance"?{targetType:"distance",targetDistance:ke.targetDistance}:{targetWeight:ke.targetWeight,targetReps:ke.targetReps},achievedMonth:ut,label:St})}}):Bo.forEach(Ee=>{const ke=fe[Ee.key];if(!ke||!ke.targetValue)return;const dt=we[Ee.key];if(dt==null)return;const bt=ke.startValue||0,st=ke.targetValue,St=st-bt;(St===0?dt===st?1:0:Math.max(0,(dt-bt)/St))>=1&&(ze.some(Tn=>Tn.type==="metric"&&Tn.key===Ee.key&&Tn.targetValue===st)||Se.push({type:"metric",key:Ee.key,targetValue:st,achievedMonth:ut,label:`${Ee.name} ${st}${Ee.suffix}`}))}),Se.length>0){const Ee=[...ze,...Se];await Ns($e(me,"juniorAchievements",yt.id),{clientId:yt.id,badges:Ee,updatedAt:kt.now()}),mt(Ee),ue(Se),setTimeout(()=>ue(null),5e3)}},Ut=($,we)=>{if($==="strength"){const Se=he[we];if(!Se)return!1;switch(xa.find(ke=>ke.key===we)?.unit){case"time":return ze.some(ke=>ke.type==="strength"&&ke.key===we&&ke.targetValue===Se.targetValue);case"reps":return ze.some(ke=>ke.type==="strength"&&ke.key===we&&ke.targetReps===Se.targetReps);case"distance":return ze.some(ke=>ke.type==="strength"&&ke.key===we&&ke.targetDistance===Se.targetDistance);default:return!Se.targetWeight&&!Se.targetReps?!1:ze.some(ke=>ke.type==="strength"&&ke.key===we&&ke.targetWeight===Se.targetWeight&&ke.targetReps===Se.targetReps)}}else{const Se=fe[we];return!Se||!Se.targetValue?!1:ze.some(Ee=>Ee.type==="metric"&&Ee.key===we&&Ee.targetValue===Se.targetValue)}},Mt=async()=>{p(!0);try{const $=`${yt.id}_${ut}`,we=Ye||{};await Ns($e(me,"juniorPBs",$),{clientId:yt.id,month:ut,benchmarks:V,bodyMetrics:we.bodyMetrics||Y||{},createdAt:we.createdAt||kt.now(),updatedAt:kt.now()}),await Ks("strength",V),Pt("Benchmarks saved!","success"),k(!1),await Et()}catch($){console.error("Error saving benchmarks:",$),Pt("Failed to save. Please try again.","error")}p(!1)},is=async()=>{p(!0);try{const $=`${yt.id}_${ut}`,we=Ye||{};await Ns($e(me,"juniorPBs",$),{clientId:yt.id,month:ut,benchmarks:we.benchmarks||V||{},bodyMetrics:Y,createdAt:we.createdAt||kt.now(),updatedAt:kt.now()}),await Ks("metric",Y),Pt("Body metrics saved!","success"),O(!1),await Et()}catch($){console.error("Error saving metrics:",$),Pt("Failed to save. Please try again.","error")}p(!1)},Ms=($,we,Se)=>{te(Ee=>({...Ee,[$]:{...Ee[$],[we]:Se===""?"":parseFloat(Se)}}))},Kt=($,we)=>{ie(Se=>({...Se,[$]:we===""?"":parseFloat(we)}))},on=($,we,Se)=>{M(Ee=>({...Ee,[$]:{...Ee[$],[we]:Se===""?"":parseFloat(Se)}}))},ds=async()=>{p(!0);try{const $=`targets_${yt.id}`,we=Ye?.benchmarks||{},Se={};xa.forEach(Ee=>{const ke=we[Ee.key];switch(Ee.unit){case"time":E[Ee.key]?.targetValue&&(Se[Ee.key]={targetType:"time",targetValue:E[Ee.key].targetValue,startValue:ke?.time||0});break;case"reps":E[Ee.key]?.targetReps&&(Se[Ee.key]={targetType:"reps",targetReps:E[Ee.key].targetReps,startReps:ke?.reps||0});break;case"distance":E[Ee.key]?.targetDistance&&(Se[Ee.key]={targetType:"distance",targetDistance:E[Ee.key].targetDistance,startDistance:ke?.distance||0});break;default:(E[Ee.key]?.targetWeight||E[Ee.key]?.targetReps)&&(Se[Ee.key]={targetWeight:E[Ee.key].targetWeight||0,targetReps:E[Ee.key].targetReps||0,startWeight:ke?.weight||0,startReps:ke?.reps||0})}}),await Ns($e(me,"juniorPBTargets",$),{clientId:yt.id,targets:Se,metricTargets:fe,updatedAt:kt.now()}),Ne(Se),M(Se),Pt("Targets saved!","success"),F(!1)}catch($){console.error("Error saving targets:",$),Pt("Failed to save targets.","error")}p(!1)},_s=($,we)=>{I(Se=>({...Se,[$]:{...Se[$],targetValue:we===""?"":parseFloat(we)}}))},Ct=async()=>{p(!0);try{const $=`targets_${yt.id}`,we={};Bo.forEach(Se=>{if(H[Se.key]?.targetValue){const Ee=Ye?.bodyMetrics?.[Se.key]||0;we[Se.key]={targetValue:H[Se.key].targetValue,startValue:Ee}}}),await Ns($e(me,"juniorPBTargets",$),{clientId:yt.id,targets:he,metricTargets:we,updatedAt:kt.now()}),R(we),I(we),Pt("Metric targets saved!","success"),D(!1)}catch($){console.error("Error saving metric targets:",$),Pt("Failed to save targets.","error")}p(!1)},be=async()=>{if(window.confirm("Reset all goals? This will clear all strength and body metric targets. Your recorded benchmarks and measurements will NOT be affected.")){p(!0);try{const $=$e(me,"juniorPBTargets",`targets_${yt.id}`);await jr($),Ne({}),R({}),M({}),I({}),Pt("All goals have been reset","success")}catch($){console.error("Error resetting targets:",$),Pt("Failed to reset goals","error")}p(!1)}},Te=($,we)=>{const Se=he[$];if(!Se||!we)return null;if(Se.targetType==="time"){if(!Se.targetValue)return null;const st=Se.startValue||0,St=Se.targetValue,xt=we.time||0,hs=St-st;return hs<=0?xt>=St?1:0:Math.max(0,Math.min((xt-st)/hs,1))}if(Se.targetType==="reps"){if(!Se.targetReps)return null;const st=Se.startReps||0,St=Se.targetReps,xt=we.reps||0,hs=St-st;return hs<=0?xt>=St?1:0:Math.max(0,Math.min((xt-st)/hs,1))}if(Se.targetType==="distance"){if(!Se.targetDistance)return null;const st=Se.startDistance||0,St=Se.targetDistance,xt=we.distance||0,hs=St-st;return hs<=0?xt>=St?1:0:Math.max(0,Math.min((xt-st)/hs,1))}if(!Se.targetWeight&&!Se.targetReps)return null;const Ee=(Se.startWeight||0)*(Se.startReps||0),ke=(Se.targetWeight||0)*(Se.targetReps||0),dt=(we.weight||0)*(we.reps||0),bt=ke-Ee;return bt<=0?dt>=ke?1:0:Math.max(0,Math.min((dt-Ee)/bt,1))},Be=$=>{const we=fe[$];if(!we||!we.targetValue)return null;const Se=Ye?.bodyMetrics?.[$];if(Se==null)return null;const Ee=we.startValue||0,ke=we.targetValue,dt=ke-Ee;return dt===0?Se===ke?1:0:Math.max(0,Math.min((Se-Ee)/dt,1))},Ue=$=>{ot.current=$.touches[0].clientX,ft.current=0},J=$=>{ft.current=$.touches[0].clientX-ot.current},ge=()=>{ft.current<-50?Vt(g+1):ft.current>50&&Vt(g-1),ft.current=0},We=$=>{const we=Ye?.bodyMetrics?.[$],Se=Xt?.bodyMetrics?.[$];return we==null||Se==null?null:parseFloat((we-Se).toFixed(2))},Ke=t.find($=>$.month===ne),z=t.find($=>$.month===de);if(re||l)return r.jsxs("div",{className:"pb-page",children:[r.jsx("header",{className:"client-header",children:r.jsx("div",{className:"header-content",children:r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})})}),r.jsxs("main",{className:"pb-main",children:[r.jsx("div",{className:"skeleton skeleton-title",style:{width:180,height:28,marginBottom:20}}),r.jsx("div",{className:"skeleton skeleton-card-large",style:{height:320,borderRadius:16}})]})]});if(!Ls||!jt||!yt)return null;const se=xa[g],Ge=Ye?.benchmarks?.[se.key],He=Xt?.benchmarks?.[se.key],Xe=Vl(se,Ge),lt=Vl(se,He),_t=tg(Xe,lt),pt=Te(se.key,Ge),Wt=pt!==null,en=pt!==null&&pt>=1,ts=Wt?Math.round(pt*60):Xe>0?15:0,ks=he[se.key],zs=$=>$?$.targetType==="time"?`${$.startValue||0}s  ${$.targetValue}s`:$.targetType==="reps"?`${$.startReps||0}  ${$.targetReps} reps`:$.targetType==="distance"?`${$.startDistance||0}  ${$.targetDistance}cm`:`${$.startWeight||0}kg${$.startReps||0}  ${$.targetWeight}kg${$.targetReps}`:null;return r.jsxs("div",{className:"pb-page",children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>vt("/client"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})]})}),r.jsxs("main",{className:"pb-main page-transition-enter",children:[r.jsxs("div",{className:"pb-intro",children:[r.jsx("h2",{children:"Junior Strength Tests"}),r.jsx("p",{children:"Track your strength test results and body measurements each month."})]}),r.jsxs("div",{className:"pb-tabs",children:[r.jsx("button",{className:`pb-tab ${n==="bests"?"active":""}`,onClick:()=>e("bests"),children:"Strength"}),r.jsx("button",{className:`pb-tab ${n==="metrics"?"active":""}`,onClick:()=>e("metrics"),children:"Body Metrics"}),r.jsx("button",{className:`pb-tab ${n==="history"?"active":""}`,onClick:()=>e("history"),children:"History"})]}),n==="bests"&&r.jsxs("div",{className:"pb-strength-section",children:[!x&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"pb-carousel",ref:Me,onTouchStart:Ue,onTouchMove:J,onTouchEnd:ge,children:[r.jsx("div",{className:`pb-ring-container slide-from-${Qe.current}`,children:r.jsxs("div",{className:"pb-ring",children:[r.jsx("svg",{className:"pb-ring-svg",viewBox:"0 0 200 200",children:eb.map(($,we)=>{const Se=we<Math.round(ts);return r.jsx("line",{x1:$.x1,y1:$.y1,x2:$.x2,y2:$.y2,className:`pb-ring-tick ${Se?en?"hit":"filled":"empty"}`,strokeWidth:$.thick?"3":"2"},we)})}),r.jsxs("div",{className:"pb-ring-center",children:[r.jsx("div",{className:"pb-ring-category",children:se.category}),r.jsxs("div",{className:"pb-ring-exercise",children:[se.name,Ut("strength",se.key)&&r.jsx("svg",{className:"pb-badge-icon",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})]}),r.jsx("div",{className:"pb-ring-value",children:Ge?mh(se,Ge):"-"}),_t!==null&&r.jsxs("div",{className:`pb-ring-change ${_t>=0?"positive":"negative"}`,children:[_t>=0?"+":"",_t.toFixed(1),"%"]}),_t===null&&Ge&&r.jsx("div",{className:"pb-ring-change neutral",children:"New entry"}),ks&&r.jsx("div",{className:`pb-ring-target ${en?"hit":""}`,children:en?"Target hit!":zs(ks)}),!ks&&r.jsx("div",{className:"pb-ring-target none",children:"No target set"})]})]})},g),r.jsx("div",{className:"pb-carousel-dots",children:xa.map(($,we)=>r.jsx("button",{className:`pb-dot ${we===g?"active":""}`,onClick:()=>Vt(we)},we))}),r.jsx("button",{className:"pb-carousel-arrow left",onClick:()=>Vt(g-1),disabled:g===0,children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"})})}),r.jsx("button",{className:"pb-carousel-arrow right",onClick:()=>Vt(g+1),disabled:g===xa.length-1,children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M8.59 16.59L10 18l6-6-6-6-1.41 1.41L13.17 12z"})})})]}),r.jsxs("div",{className:"pb-trend-section",children:[r.jsx("h4",{children:"Trend"}),r.jsx(bP,{data:t,exerciseKey:se.key,unit:se.unit})]})]}),!x&&!G&&r.jsxs("div",{className:"pb-action-buttons",children:[r.jsx("button",{className:"pb-edit-btn",onClick:()=>k(!0),children:Ye?.benchmarks?"Edit This Month's Benchmarks":"Add This Month's Benchmarks"}),r.jsx("button",{className:"pb-edit-btn pb-target-btn",onClick:()=>F(!0),children:Object.keys(he).length>0?"Edit Targets":"Set Targets"}),(Object.keys(he).length>0||Object.keys(fe).length>0)&&r.jsx("button",{className:"pb-edit-btn pb-reset-btn",onClick:be,disabled:d,children:"Reset All Goals"})]}),x&&r.jsxs("div",{className:"pb-edit-card",children:[r.jsxs("div",{className:"pb-edit-header",children:[r.jsxs("h3",{children:["Benchmarks - ",wa(ut)]}),r.jsx("button",{className:"pb-edit-close",onClick:()=>{k(!1),te(Ye?.benchmarks||{})},children:""})]}),r.jsx("div",{className:"pb-edit-body",children:xa.map($=>r.jsxs("div",{className:"pb-edit-exercise",children:[r.jsx("div",{className:"pb-edit-exercise-name",children:$.name}),$.unit==="weight"?r.jsxs("div",{className:"pb-edit-row",children:[r.jsxs("div",{className:"pb-edit-field",children:[r.jsx("label",{children:"Weight (kg)"}),r.jsx("input",{type:"number",step:"0.5",value:V[$.key]?.weight??"",onChange:we=>Ms($.key,"weight",we.target.value),placeholder:"0"})]}),r.jsxs("div",{className:"pb-edit-field",children:[r.jsx("label",{children:"Reps"}),r.jsx("input",{type:"number",value:V[$.key]?.reps??"",onChange:we=>Ms($.key,"reps",we.target.value),placeholder:"0"})]})]}):$.unit==="reps"?r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsx("label",{children:"Reps (max in 1 min)"}),r.jsx("input",{type:"number",value:V[$.key]?.reps??"",onChange:we=>Ms($.key,"reps",we.target.value),placeholder:"0"})]})}):$.unit==="distance"?r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsx("label",{children:"Distance (cm)"}),r.jsx("input",{type:"number",step:"0.5",value:V[$.key]?.distance??"",onChange:we=>Ms($.key,"distance",we.target.value),placeholder:"0"})]})}):r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsx("label",{children:"Time (seconds)"}),r.jsx("input",{type:"number",step:"0.01",value:V[$.key]?.time??"",onChange:we=>Ms($.key,"time",we.target.value),placeholder:"0"})]})})]},$.key))}),r.jsxs("div",{className:"pb-edit-actions",children:[r.jsx("button",{className:"pb-cancel-btn",onClick:()=>{k(!1),te(Ye?.benchmarks||{})},children:"Cancel"}),r.jsx("button",{className:"pb-save-btn",onClick:Mt,disabled:d,children:d?"Saving...":"Save"})]})]}),G&&r.jsxs("div",{className:"pb-edit-card",children:[r.jsxs("div",{className:"pb-edit-header",children:[r.jsx("h3",{children:"Set Your Targets"}),r.jsx("button",{className:"pb-edit-close",onClick:()=>{F(!1),M(he)},children:""})]}),r.jsxs("div",{className:"pb-edit-body",children:[r.jsx("p",{className:"pb-target-hint",children:"Set a target for each exercise. Your current best is captured automatically from your latest benchmarks."}),xa.map($=>{const we=Ye?.benchmarks?.[$.key];let Se="-";if(we)switch($.unit){case"weight":(we.weight||we.reps)&&(Se=`${we.weight||0}kg  ${we.reps||0}`);break;case"time":we.time&&(Se=`${we.time}s`);break;case"reps":we.reps&&(Se=`${we.reps} reps`);break;case"distance":we.distance&&(Se=`${we.distance} cm`);break}return r.jsxs("div",{className:"pb-edit-exercise",children:[r.jsxs("div",{className:"pb-edit-exercise-header",children:[r.jsx("div",{className:"pb-edit-exercise-name",children:$.name}),r.jsxs("div",{className:"pb-edit-current-best",children:["Current: ",Se]})]}),$.unit==="weight"?r.jsxs("div",{className:"pb-edit-row",children:[r.jsxs("div",{className:"pb-edit-field",children:[r.jsx("label",{children:"Target Weight (kg)"}),r.jsx("input",{type:"number",step:"0.5",value:E[$.key]?.targetWeight??"",onChange:Ee=>on($.key,"targetWeight",Ee.target.value),placeholder:"0"})]}),r.jsxs("div",{className:"pb-edit-field",children:[r.jsx("label",{children:"Target Reps"}),r.jsx("input",{type:"number",value:E[$.key]?.targetReps??"",onChange:Ee=>on($.key,"targetReps",Ee.target.value),placeholder:"0"})]})]}):$.unit==="reps"?r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsx("label",{children:"Target Reps (in 1 min)"}),r.jsx("input",{type:"number",value:E[$.key]?.targetReps??"",onChange:Ee=>on($.key,"targetReps",Ee.target.value),placeholder:"0"})]})}):$.unit==="distance"?r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsx("label",{children:"Target Distance (cm)"}),r.jsx("input",{type:"number",step:"0.5",value:E[$.key]?.targetDistance??"",onChange:Ee=>on($.key,"targetDistance",Ee.target.value),placeholder:"0"})]})}):r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsx("label",{children:"Target (seconds)"}),r.jsx("input",{type:"number",step:"1",value:E[$.key]?.targetValue??"",onChange:Ee=>on($.key,"targetValue",Ee.target.value),placeholder:"0"})]})})]},$.key)})]}),r.jsxs("div",{className:"pb-edit-actions",children:[r.jsx("button",{className:"pb-cancel-btn",onClick:()=>{F(!1),M(he)},children:"Cancel"}),r.jsx("button",{className:"pb-save-btn",onClick:ds,disabled:d,children:d?"Saving...":"Save Targets"})]})]})]}),n==="metrics"&&r.jsxs("div",{className:"pb-metrics-section",children:[!T&&!B&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"pb-metrics-card",children:[r.jsx("h3",{children:"Body Measurements"}),r.jsx("p",{className:"pb-metrics-month",children:wa(ut)}),r.jsx("div",{className:"pb-metrics-list",children:Bo.map($=>{const we=Ye?.bodyMetrics?.[$.key],Se=We($.key),Ee=fe[$.key],ke=Be($.key),dt=ke!==null&&ke>=1;return r.jsxs("div",{className:"pb-metric-row",children:[r.jsxs("div",{className:"pb-metric-top",children:[r.jsxs("div",{className:"pb-metric-left",children:[r.jsxs("span",{className:"pb-metric-name",children:[$.name,Ut("metric",$.key)&&r.jsx("svg",{className:"pb-badge-icon-sm",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})]}),Ee&&r.jsxs("span",{className:"pb-metric-target-label",children:["Target: ",Ee.targetValue," ",$.suffix]})]}),r.jsxs("div",{className:"pb-metric-values",children:[r.jsx("span",{className:"pb-metric-current",children:we!=null?`${we} ${$.suffix}`:"-"}),Se!==null&&r.jsxs("span",{className:`pb-metric-change ${Se>0?"up":Se<0?"down":"same"}`,children:[Se>0?"+":"",Se," ",$.suffix]})]})]}),ke!==null&&r.jsxs("div",{className:"pb-metric-progress",children:[r.jsx("div",{className:"pb-metric-bar",children:r.jsx("div",{className:`pb-metric-bar-fill ${dt?"hit":""}`,style:{width:`${Math.round(ke*100)}%`}})}),r.jsx("span",{className:`pb-metric-percent ${dt?"hit":""}`,children:dt?"Hit!":`${Math.round(ke*100)}%`})]})]},$.key)})})]}),r.jsxs("div",{className:"pb-action-buttons",children:[r.jsx("button",{className:"pb-edit-btn",onClick:()=>O(!0),children:Ye?.bodyMetrics?"Edit This Month's Measurements":"Add This Month's Measurements"}),r.jsx("button",{className:"pb-edit-btn pb-target-btn",onClick:()=>D(!0),children:Object.keys(fe).length>0?"Edit Targets":"Set Targets"}),(Object.keys(he).length>0||Object.keys(fe).length>0)&&r.jsx("button",{className:"pb-edit-btn pb-reset-btn",onClick:be,disabled:d,children:"Reset All Goals"})]})]}),T&&r.jsxs("div",{className:"pb-edit-card",children:[r.jsxs("div",{className:"pb-edit-header",children:[r.jsxs("h3",{children:["Measurements - ",wa(ut)]}),r.jsx("button",{className:"pb-edit-close",onClick:()=>{O(!1),ie(Ye?.bodyMetrics||{})},children:""})]}),r.jsx("div",{className:"pb-edit-body",children:Bo.map($=>r.jsx("div",{className:"pb-edit-metric",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsxs("label",{children:[$.name," (",$.suffix,")"]}),r.jsx("input",{type:"number",step:"0.1",value:Y[$.key]??"",onChange:we=>Kt($.key,we.target.value),placeholder:"0"})]})},$.key))}),r.jsxs("div",{className:"pb-edit-actions",children:[r.jsx("button",{className:"pb-cancel-btn",onClick:()=>{O(!1),ie(Ye?.bodyMetrics||{})},children:"Cancel"}),r.jsx("button",{className:"pb-save-btn",onClick:is,disabled:d,children:d?"Saving...":"Save"})]})]}),B&&r.jsxs("div",{className:"pb-edit-card",children:[r.jsxs("div",{className:"pb-edit-header",children:[r.jsx("h3",{children:"Body Metric Targets"}),r.jsx("button",{className:"pb-edit-close",onClick:()=>{D(!1),I(fe)},children:""})]}),r.jsxs("div",{className:"pb-edit-body",children:[r.jsx("p",{className:"pb-target-hint",children:"Set targets for your body measurements. Your current measurement is captured automatically."}),Bo.map($=>{const we=Ye?.bodyMetrics?.[$.key];return r.jsxs("div",{className:"pb-edit-exercise",children:[r.jsxs("div",{className:"pb-edit-exercise-header",children:[r.jsx("div",{className:"pb-edit-exercise-name",children:$.name}),r.jsxs("div",{className:"pb-edit-current-best",children:["Current: ",we!=null?`${we} ${$.suffix}`:"-"]})]}),r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsxs("label",{children:["Target (",$.suffix,")"]}),r.jsx("input",{type:"number",step:"0.1",value:H[$.key]?.targetValue??"",onChange:Se=>_s($.key,Se.target.value),placeholder:"0"})]})})]},$.key)})]}),r.jsxs("div",{className:"pb-edit-actions",children:[r.jsx("button",{className:"pb-cancel-btn",onClick:()=>{D(!1),I(fe)},children:"Cancel"}),r.jsx("button",{className:"pb-save-btn",onClick:Ct,disabled:d,children:d?"Saving...":"Save Targets"})]})]})]}),n==="history"&&r.jsx("div",{className:"pb-history-section",children:t.length===0?r.jsxs("div",{className:"pb-empty",children:[r.jsx("h4",{children:"No records yet"}),r.jsx("p",{children:"Start adding your monthly benchmarks and measurements to track your progress over time."})]}):r.jsxs(r.Fragment,{children:[ze.length>0&&r.jsxs("div",{className:"pb-achievements-wall",children:[r.jsxs("h4",{className:"pb-achievements-wall-title",children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"18",height:"18",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),"Targets Achieved"]}),r.jsx("div",{className:"pb-achievements-list",children:[...ze].reverse().map(($,we)=>r.jsxs("div",{className:"pb-achievement-item",style:{animationDelay:`${we*.05}s`},children:[r.jsx("div",{className:"pb-achievement-star",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),r.jsxs("div",{className:"pb-achievement-info",children:[r.jsx("span",{className:"pb-achievement-label",children:$.label}),r.jsx("span",{className:"pb-achievement-date",children:wa($.achievedMonth)})]})]},we))})]}),r.jsx("div",{className:"pb-history-controls",children:r.jsx("button",{className:`pb-compare-toggle ${Z?"active":""}`,onClick:()=>{L(!Z),!Z&&t.length>=2&&(Ie(t[0].month),qe(t[t.length-1].month))},children:Z?"Back to Timeline":"Compare Months"})}),Z?r.jsxs("div",{className:"pb-compare",children:[r.jsxs("div",{className:"pb-compare-selectors",children:[r.jsxs("div",{className:"pb-compare-select",children:[r.jsx("label",{children:"From"}),r.jsx("select",{value:ne,onChange:$=>Ie($.target.value),children:t.map($=>r.jsx("option",{value:$.month,children:wa($.month)},$.month))})]}),r.jsx("div",{className:"pb-compare-vs",children:"vs"}),r.jsxs("div",{className:"pb-compare-select",children:[r.jsx("label",{children:"To"}),r.jsx("select",{value:de,onChange:$=>qe($.target.value),children:t.map($=>r.jsx("option",{value:$.month,children:wa($.month)},$.month))})]})]}),Ke&&z&&r.jsxs("div",{className:"pb-compare-results",children:[r.jsxs("div",{className:"pb-compare-group",children:[r.jsx("h4",{children:"Strength Tests"}),r.jsxs("div",{className:"pb-compare-table",children:[r.jsxs("div",{className:"pb-compare-header-row",children:[r.jsx("span",{children:"Exercise"}),r.jsx("span",{children:wa(ne).split(" ")[0]}),r.jsx("span",{children:wa(de).split(" ")[0]}),r.jsx("span",{children:"Change"})]}),xa.map($=>{const we=Ke.benchmarks?.[$.key],Se=z.benchmarks?.[$.key],Ee=Vl($,we),ke=Vl($,Se),dt=tg(ke,Ee);return r.jsxs("div",{className:"pb-compare-row",children:[r.jsx("span",{className:"pb-compare-name",children:$.name}),r.jsx("span",{className:"pb-compare-val",children:we?mh($,we):"-"}),r.jsx("span",{className:"pb-compare-val",children:Se?mh($,Se):"-"}),r.jsx("span",{className:`pb-compare-change ${dt!==null?dt>=0?"positive":"negative":""}`,children:dt!==null?`${dt>=0?"+":""}${dt.toFixed(1)}%`:"-"})]},$.key)})]})]}),r.jsxs("div",{className:"pb-compare-group",children:[r.jsx("h4",{children:"Body Measurements"}),r.jsxs("div",{className:"pb-compare-table",children:[r.jsxs("div",{className:"pb-compare-header-row",children:[r.jsx("span",{children:"Measurement"}),r.jsx("span",{children:wa(ne).split(" ")[0]}),r.jsx("span",{children:wa(de).split(" ")[0]}),r.jsx("span",{children:"Change"})]}),Bo.map($=>{const we=Ke.bodyMetrics?.[$.key],Se=z.bodyMetrics?.[$.key],Ee=we!=null&&Se!=null?parseFloat((Se-we).toFixed(2)):null;return r.jsxs("div",{className:"pb-compare-row",children:[r.jsx("span",{className:"pb-compare-name",children:$.name}),r.jsx("span",{className:"pb-compare-val",children:we!=null?`${we}`:"-"}),r.jsx("span",{className:"pb-compare-val",children:Se!=null?`${Se}`:"-"}),r.jsx("span",{className:`pb-compare-change ${Ee!==null?Ee>0?"positive":Ee<0?"negative":"neutral":""}`,children:Ee!==null?`${Ee>0?"+":""}${Ee} ${$.suffix}`:"-"})]},$.key)})]})]})]})]}):r.jsx("div",{className:"pb-timeline",children:[...t].reverse().map(($,we)=>{const Se=t.filter(Ee=>Ee.month<$.month).pop();return r.jsxs("div",{className:"pb-timeline-item",style:{animationDelay:`${we*.05}s`},children:[r.jsx("div",{className:"pb-timeline-dot"}),r.jsxs("div",{className:"pb-timeline-card",children:[r.jsx("h4",{children:wa($.month)}),$.benchmarks&&Object.keys($.benchmarks).length>0&&r.jsxs("div",{className:"pb-timeline-group",children:[r.jsx("h5",{children:"Strength Tests"}),xa.map(Ee=>{const ke=$.benchmarks[Ee.key];if(!ke)return null;const dt=Se?.benchmarks?.[Ee.key],bt=Vl(Ee,ke),st=Vl(Ee,dt),St=tg(bt,st);return r.jsxs("div",{className:"pb-timeline-row",children:[r.jsx("span",{className:"pb-timeline-label",children:Ee.name}),r.jsxs("div",{className:"pb-timeline-values",children:[r.jsx("span",{className:"pb-timeline-value",children:mh(Ee,ke)}),St!==null&&r.jsxs("span",{className:`pb-timeline-change ${St>=0?"positive":"negative"}`,children:[St>=0?"+":"",St.toFixed(1),"%"]})]})]},Ee.key)})]}),$.bodyMetrics&&Object.keys($.bodyMetrics).length>0&&r.jsxs("div",{className:"pb-timeline-group",children:[r.jsx("h5",{children:"Body Measurements"}),Bo.map(Ee=>{const ke=$.bodyMetrics[Ee.key];if(ke==null)return null;const dt=Se?.bodyMetrics?.[Ee.key],bt=dt!=null?parseFloat((ke-dt).toFixed(2)):null;return r.jsxs("div",{className:"pb-timeline-row",children:[r.jsx("span",{className:"pb-timeline-label",children:Ee.name}),r.jsxs("div",{className:"pb-timeline-values",children:[r.jsxs("span",{className:"pb-timeline-value",children:[ke," ",Ee.suffix]}),bt!==null&&r.jsxs("span",{className:`pb-timeline-change ${bt>0?"positive":bt<0?"negative":"neutral"}`,children:[bt>0?"+":"",bt," ",Ee.suffix]})]})]},Ee.key)})]})]})]},$.id)})})]})})]}),W&&r.jsx("div",{className:"pb-celebration-overlay",onClick:()=>ue(null),children:r.jsxs("div",{className:"pb-celebration-card",children:[r.jsx("div",{className:"pb-celebration-icon",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),r.jsx("h3",{className:"pb-celebration-title",children:W.length===1?"Target Achieved!":`${W.length} Targets Achieved!`}),r.jsx("div",{className:"pb-celebration-badges",children:W.map(($,we)=>r.jsx("div",{className:"pb-celebration-badge",children:$.label},we))}),r.jsx("p",{className:"pb-celebration-sub",children:"Tap to dismiss"})]})}),Re&&r.jsxs("div",{className:`toast-notification ${Re.type}`,children:[r.jsx("span",{className:"toast-icon",children:Re.type==="success"?r.jsx("svg",{className:"success-check-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{className:"check-path",d:"M5 13 L9 17 L19 7"})}):r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})}),r.jsx("span",{className:"toast-message",children:Re.message}),r.jsx("button",{className:"toast-close",onClick:()=>Le(null),children:""})]}),r.jsxs("nav",{className:"block-bottom-nav",children:[r.jsxs("button",{className:"block-nav-tab",onClick:()=>vt("/client"),children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}),r.jsx("polyline",{points:"9 22 9 12 15 12 15 22"})]}),r.jsx("span",{children:"Home"})]}),r.jsxs("button",{className:"block-nav-tab",onClick:()=>vt("/client/forms"),children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),r.jsx("polyline",{points:"14 2 14 8 20 8"}),r.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),r.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"})]}),r.jsx("span",{children:"Forms"})]}),r.jsxs("button",{className:"block-nav-tab",onClick:()=>vt("/client/tools"),children:[r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"})}),r.jsx("span",{children:"Tools"})]}),r.jsxs("button",{className:"block-nav-tab active",children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M12 20V10"}),r.jsx("path",{d:"M18 20V4"}),r.jsx("path",{d:"M6 20v-4"})]}),r.jsx("span",{children:"PBs"})]}),yt?.circuitAccess&&r.jsxs("button",{className:"block-nav-tab",onClick:()=>vt("/client/circuit"),children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("path",{d:"M12 6v6l4 2"})]}),r.jsx("span",{children:"Circuit"})]})]})]})}const $k=[{name:"Dumbbell Floor Press",type:"weighted",equipment:"dumbbells",group:"push",pbKey:"chestPress",storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Seated Dumbbell Shoulder Press",type:"weighted",equipment:"dumbbells",group:"push",pbKey:"shoulderPress",storagePath:"exercises/dumbbells/upper/seated dumbbell shoulder press.mp4"},{name:"Seated Dumbbell Arnold Press",type:"weighted",equipment:"dumbbells",group:"push",storagePath:"exercises/dumbbells/upper/seated dumbbell arnold press.mp4"},{name:"Dumbbell Overhead Tricep Extension",type:"weighted",equipment:"dumbbells",group:"push",storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Skullcrushers",type:"weighted",equipment:"dumbbells",group:"push",storagePath:"exercises/dumbbells/upper/skullcrushers.mp4"},{name:"Dumbbell Lateral Raise",type:"weighted",equipment:"dumbbells",group:"push",storagePath:"exercises/dumbbells/upper/dumbbell lateral raise.mp4"},{name:"Dumbbell Front Raise",type:"weighted",equipment:"dumbbells",group:"push",storagePath:"exercises/dumbbells/upper/dumbbell front raise.mp4"},{name:"Press Up",type:"reps",equipment:"bodyweight",group:"push",storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Tricep Dips",type:"reps",equipment:"bodyweight",group:"push",storagePath:"exercises/bodyweight/upper/tricep dips.mp4"},{name:"Pike Push Ups",type:"reps",equipment:"bodyweight",group:"push",storagePath:"exercises/bodyweight/upper/pike push ups.GIF"},{name:"Reverse Plank",type:"timed",equipment:"bodyweight",group:"push",storagePath:"exercises/bodyweight/upper/reverse plank.GIF"},{name:"Dumbbell Squeeze Press",type:"weighted",equipment:"dumbbells",group:"push",storagePath:null},{name:"Incline Dumbbell Press",type:"weighted",equipment:"dumbbells",group:"push",storagePath:null},{name:"Dumbbell Pullover",type:"weighted",equipment:"dumbbells",group:"push",storagePath:null},{name:"Dumbbell Fly",type:"weighted",equipment:"dumbbells",group:"push",storagePath:null},{name:"Tricep Kickback",type:"weighted",equipment:"dumbbells",group:"push",storagePath:null},{name:"Dumbbell Shrug",type:"weighted",equipment:"dumbbells",group:"push",storagePath:null},{name:"Dumbbell Y-Raise",type:"weighted",equipment:"dumbbells",group:"push",storagePath:null},{name:"Wide Press Up",type:"reps",equipment:"bodyweight",group:"push",storagePath:null},{name:"Diamond Press Up",type:"reps",equipment:"bodyweight",group:"push",storagePath:null},{name:"Decline Press Up",type:"reps",equipment:"bodyweight",group:"push",storagePath:null},{name:"Wall Walks",type:"reps",equipment:"bodyweight",group:"push",storagePath:null},{name:"Press Up Hold",type:"timed",equipment:"bodyweight",group:"push",storagePath:null},{name:"Shoulder Tap Hold",type:"timed",equipment:"bodyweight",group:"push",storagePath:null},{name:"Dumbbell Bent Over Row",type:"weighted",equipment:"dumbbells",group:"pull",pbKey:"seatedRow",storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Single Arm Bent Over Row",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Bicep Curl",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Hammer Curl",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:"exercises/dumbbells/upper/hammer curl.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Renegade Row",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:"exercises/dumbbells/upper/renegade row.mp4"},{name:"Wide Dumbbell Bent Over Row",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:null},{name:"Reverse Fly",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:null},{name:"Concentration Curl",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:null},{name:"Wide Grip Bicep Curl",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:null},{name:"Wrist Curl",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:null},{name:"Prone Y-T-W Raises",type:"reps",equipment:"bodyweight",group:"pull",storagePath:null},{name:"Reverse Snow Angel",type:"reps",equipment:"bodyweight",group:"pull",storagePath:null},{name:"Isometric Bicep Hold",type:"timed",equipment:"bodyweight",group:"pull",storagePath:null},{name:"Dumbbell Goblet Squats",type:"weighted",equipment:"dumbbells",group:"lower",pbKey:"squat",storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Romanian Deadlifts",type:"weighted",equipment:"dumbbells",group:"lower",pbKey:"deadlift",storagePath:"exercises/dumbbells/lower/romanian deadlifts.GIF"},{name:"Forward Dumbbell Lunges",type:"weighted",equipment:"dumbbells",group:"lower",storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.GIF"},{name:"Dumbbell Sumo Squats",type:"weighted",equipment:"dumbbells",group:"lower",storagePath:"exercises/dumbbells/lower/dumbbell sumo squats.GIF"},{name:"Weighted Calf Raises",type:"weighted",equipment:"dumbbells",group:"lower",storagePath:"exercises/dumbbells/lower/weighted calf raises.GIF"},{name:"1 Legged RDL",type:"weighted",equipment:"dumbbells",group:"lower",storagePath:"exercises/dumbbells/lower/1 legged rdl.GIF"},{name:"Dumbbell Box Step Ups",type:"weighted",equipment:"dumbbells",group:"lower",storagePath:"exercises/dumbbells/lower/dumbbell box step ups.mp4"},{name:"Dumbbell Squat Pulses",type:"weighted",equipment:"dumbbells",group:"lower",storagePath:"exercises/dumbbells/lower/dumbbell squat pulses.GIF"},{name:"Dumbbell Reverse Lunges",type:"weighted",equipment:"dumbbells",group:"lower",storagePath:"exercises/dumbbells/lower/dumbbell reverse lunges.GIF"},{name:"Kettlebell Romanian Deadlift",type:"weighted",equipment:"kettlebell",group:"lower",storagePath:"exercises/kettlebells/lower/kettlebell romanian deadlift.mp4"},{name:"Reverse Lunge",type:"reps",equipment:"bodyweight",group:"lower",storagePath:"exercises/bodyweight/lower/reverse lunge.GIF"},{name:"Box Step Ups",type:"reps",equipment:"bodyweight",group:"lower",storagePath:"exercises/bodyweight/lower/box step ups.GIF"},{name:"Bulgarian Split Squats",type:"reps",equipment:"bodyweight",group:"lower",storagePath:"exercises/bodyweight/lower/bulgarian split squats.GIF"},{name:"Jump Squats",type:"reps",equipment:"bodyweight",group:"lower",storagePath:"exercises/bodyweight/lower/jump squats.GIF"},{name:"Hip Thrusts",type:"reps",equipment:"bodyweight",group:"lower",storagePath:"exercises/bodyweight/lower/hip thrusts.GIF"},{name:"Donkey Kicks",type:"reps",equipment:"bodyweight",group:"lower",storagePath:"exercises/bodyweight/lower/donkey kicks.GIF"},{name:"Skater Jumps",type:"reps",equipment:"bodyweight",group:"lower",storagePath:"exercises/bodyweight/lower/skater jumps.GIF"},{name:"Squat And Hold",type:"timed",equipment:"bodyweight",group:"lower",storagePath:"exercises/bodyweight/lower/squat and hold.GIF"},{name:"Forearm Plank",type:"timed",equipment:"bodyweight",group:"core",pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"},{name:"Side Plank",type:"timed",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Side Plank.mp4"},{name:"Hollow Body Hold",type:"timed",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"},{name:"Superman Hold",type:"timed",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Superman Hold.mp4"},{name:"Mountain Climbers",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Mountain Climbers.mp4"},{name:"Fast Mountain Climbers",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Fast Mountain Climbers.mp4"},{name:"Cross Body Mountain Climbers",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Cross Body Mountain Climbers.mp4"},{name:"Russian Twist",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Russian Twist.mp4"},{name:"Crunch",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Crunch.mp4"},{name:"Bicycle Crunch",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Bicycle Crunch.mp4"},{name:"Leg Raises",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Leg Raises.mp4"},{name:"Dead Bug",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Dead Bug.mp4"},{name:"Dead Bug Single Leg Drop",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Dead Bug Single Leg Drop.mp4"},{name:"Bird Dog",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Bird Dog.mp4"},{name:"Flutter Kicks",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Flutter Kicks.mp4"},{name:"Hollow Hold Flutter Kicks",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Hollow Hold Flutter Kicks.mp4"},{name:"High Plank Shoulder Taps",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/High Plank Shoulder Taps.mp4"},{name:"Hip Dips Plank",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Hip Dips Plank.mp4"},{name:"Single Leg V-Up",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Single Leg V-Up.mp4"},{name:"Hollow Hold To V-Sit",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Hollow Hold To V-sit.mp4"},{name:"Toe Reaches",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/toe reaches.GIF"},{name:"Side Plank Rotation",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Side Plank Rotation.mp4"},{name:"Plank Walkout",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Plank Walkout.mp4"},{name:"Reverse Crunch To Leg Raise",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Reverse Crunch To Leg Raise.mp4"},{name:"Burpee",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Russian Twists Dumbbell",type:"weighted",equipment:"dumbbells",group:"core",storagePath:"exercises/dumbbells/core/russian twists dumbbell.GIF"},{name:"Kettlebell Russian Twist",type:"weighted",equipment:"kettlebell",group:"core",storagePath:"exercises/kettlebells/core/kettlebell russian twist.mp4"},{name:"Kettlebell Side Bends",type:"weighted",equipment:"kettlebell",group:"core",storagePath:"exercises/kettlebells/core/kettlebell side bends.mp4"},{name:"Kneeling Kettlebell Halo",type:"weighted",equipment:"kettlebell",group:"core",storagePath:"exercises/kettlebells/core/kneeling kettlebell halo.mp4"},{name:"Kettlebell Bird Dog Drag",type:"reps",equipment:"kettlebell",group:"core",storagePath:"exercises/kettlebells/core/kettlebell bird dog drag.mp4"},{name:"Back Extension Hold",type:"timed",equipment:"bodyweight",group:"core",storagePath:null},{name:"Dumbbell Plank Pull Through",type:"weighted",equipment:"dumbbells",group:"core",storagePath:null}];$k.filter(n=>n.storagePath!==null);const xP=[{key:"push",label:"Push",subtitle:"Chest / Shoulders / Triceps",color:"#A12F3A",icon:"M4 10v4M8 7v10M8 12h8M16 7v10M20 10v4"},{key:"pull",label:"Pull",subtitle:"Back / Biceps",color:"#2196f3",icon:"M4 12h16M12 4v16M7 7l10 10M17 7L7 17"},{key:"lower",label:"Lower",subtitle:"Legs / Glutes",color:"#ff9800",icon:"M13 2L3 14h9l-1 8 10-12h-9l1-8z"},{key:"core",label:"Core",subtitle:"Abs / Stability",color:"#7c3aed",icon:"M12 22c5.52 0 10-4.48 10-10S17.52 2 12 2 2 6.48 2 12s4.48 10 10 10zM12 18c3.31 0 6-2.69 6-6s-2.69-6-6-6-6 2.69-6 6 2.69 6 6 6zM12 14a2 2 0 1 0 0-4 2 2 0 0 0 0 4z"}],Wk={};$k.forEach(n=>{Wk[n.name]=n.group});function wP(n){return Wk[n]||null}const La=[{key:"chestPress",name:"Chest Press",category:"Upper Body - Push",unit:"weight"},{key:"shoulderPress",name:"Shoulder Press",category:"Upper Body - Push",unit:"weight"},{key:"seatedRow",name:"Seated Row",category:"Upper Body - Pull",unit:"weight"},{key:"latPulldown",name:"Lat Pulldown",category:"Upper Body - Pull",unit:"weight"},{key:"squat",name:"Squat",category:"Lower Body",unit:"weight"},{key:"deadlift",name:"Deadlift",category:"Lower Body",unit:"weight"},{key:"plank",name:"Plank",category:"Core",unit:"time"}],Vo=[{key:"weight",name:"Weight",suffix:"kg"},{key:"chest",name:"Chest",suffix:"cm"},{key:"waist",name:"Waist",suffix:"cm"},{key:"hips",name:"Hips",suffix:"cm"},{key:"leftArm",name:"Left Arm",suffix:"cm"},{key:"rightArm",name:"Right Arm",suffix:"cm"},{key:"leftThigh",name:"Left Thigh",suffix:"cm"},{key:"rightThigh",name:"Right Thigh",suffix:"cm"}];function _P(){const n=new Date;return`${n.getFullYear()}-${String(n.getMonth()+1).padStart(2,"0")}`}function _a(n){const[e,t]=n.split("-");return new Date(parseInt(e),parseInt(t)-1).toLocaleDateString("en-GB",{month:"long",year:"numeric"})}function fh(n){if(!n&&n!==0)return"-";const e=Math.floor(n/60),t=(n%60).toFixed(2);return e>0?`${e}m ${parseFloat(t).toFixed(0)}s`:`${parseFloat(t).toFixed(2)}s`}function D2(n,e){return!n&&n!==0?"-":!e&&e!==0?`${n}kg`:`${n}kg x ${e}`}function Ul(n,e){return e?n.unit==="time"?e.time||0:(e.weight||0)*(e.reps||0):0}function sg(n,e){return!e||e===0?null:(n-e)/e*100}function kP({data:n,exerciseKey:e,unit:t}){if(!n||n.length<2)return r.jsx("div",{className:"pb-trend-empty",children:r.jsx("p",{children:"Not enough data for trend line yet"})});const i=n.map(F=>{const V=F.benchmarks?.[e];return V?t==="time"?V.time||0:(V.weight||0)*(V.reps||0):0}),l=Math.max(...i),u=Math.min(...i),d=l-u||1,p=300,g=100,y=20,x=p-y*2,k=g-y*2,T=i.map((F,V)=>{const te=y+V/(i.length-1)*x,Y=y+k-(F-u)/d*k;return{x:te,y:Y,value:F}}),O=T.map((F,V)=>`${V===0?"M":"L"} ${F.x} ${F.y}`).join(" "),G=O+` L ${T[T.length-1].x} ${y+k} L ${T[0].x} ${y+k} Z`;return r.jsxs("div",{className:"pb-trend-chart",children:[r.jsxs("svg",{viewBox:`0 0 ${p} ${g}`,preserveAspectRatio:"xMidYMid meet",children:[r.jsx("defs",{children:r.jsxs("linearGradient",{id:"trendGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[r.jsx("stop",{offset:"0%",stopColor:"var(--color-primary)",stopOpacity:"0.3"}),r.jsx("stop",{offset:"100%",stopColor:"var(--color-primary)",stopOpacity:"0.02"})]})}),r.jsx("path",{d:G,fill:"url(#trendGradient)"}),r.jsx("path",{d:O,fill:"none",stroke:"var(--color-primary)",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round"}),T.map((F,V)=>r.jsx("circle",{cx:F.x,cy:F.y,r:"4",fill:"var(--bg-card)",stroke:"var(--color-primary)",strokeWidth:"2"},V))]}),r.jsx("div",{className:"pb-trend-labels",children:n.map((F,V)=>r.jsxs("span",{className:"pb-trend-label",children:[F.month.split("-")[1],"/",F.month.split("-")[0].slice(2)]},V))})]})}function jP(){const[n,e]=v.useState("bests"),[t,i]=v.useState([]),[l,u]=v.useState(!0),[d,p]=v.useState(!1),[g,y]=v.useState(0),[x,k]=v.useState(!1),[T,O]=v.useState(!1),[G,F]=v.useState(!1),[V,te]=v.useState({}),[Y,ie]=v.useState({}),[he,Ne]=v.useState({}),[fe,R]=v.useState({}),[E,M]=v.useState({}),[B,D]=v.useState(!1),[H,I]=v.useState({}),[ze,mt]=v.useState([]),[W,ue]=v.useState(null),[Re,Le]=v.useState(null),[Z,L]=v.useState(!1),[ne,Ie]=v.useState(""),[de,qe]=v.useState(""),[Me,ot]=v.useState({}),[ft,Qe]=v.useState({}),[Vt,Ls]=v.useState(null),[jt,yt]=v.useState(null),[re,Nt]=v.useState(""),[vt,Pt]=v.useState({}),Et=v.useRef(null),ut=v.useRef(0),Ye=v.useRef(0),It=v.useRef("right"),Xt=v.useCallback(j=>{y(C=>{const P=Math.max(0,Math.min(La.length-1,j));return P===C?C:(It.current=P>C?"right":"left",P)})},[]),{currentUser:Ks,isClient:Ut,clientData:Mt,loading:is}=Vr(),{isDark:Ms}=Ra(),Kt=lr(),[on]=lS(),ds=on.get("mode")==="corebuddy",_s=!ds&&(!Mt?.clientType||Mt.clientType==="block"),Ct=v.useCallback((j,C="info")=>{Le({message:j,type:C}),setTimeout(()=>Le(null),4e3)},[]);v.useEffect(()=>{!is&&(!Ks||!Ut)&&Kt("/")},[Ks,Ut,is,Kt]),v.useEffect(()=>{Mt&&(_s?be():(async()=>{try{const[C,P,U]=await Promise.all([As($e(me,"coreBuddyPBs",Mt.id)),As($e(me,"coreBuddyTargets",Mt.id)),As($e(me,"coreBuddyAchievements",Mt.id))]);C.exists()&&ot(C.data().exercises||{}),P.exists()&&Qe(P.data().targets||{}),U.exists()&&Ls(U.data())}catch(C){console.error("Error loading Core Buddy PBs:",C)}u(!1)})())},[Mt]);const be=async()=>{try{const j=Ps(Ft(me,"personalBests"),ps("clientId","==",Mt.id)),P=(await Ss(j)).docs.map(et=>({id:et.id,...et.data()}));P.sort((et,nt)=>et.month.localeCompare(nt.month)),i(P);const U=Ps(Ft(me,"personalBestTargets"),ps("clientId","==",Mt.id)),ye=await Ss(U);if(!ye.empty){const et=ye.docs[0].data();Ne(et.targets||{}),R(et.metricTargets||{}),M(et.targets||{}),I(et.metricTargets||{})}const Ve=Ps(Ft(me,"achievements"),ps("clientId","==",Mt.id)),Oe=await Ss(Ve);Oe.empty||mt(Oe.docs[0].data().badges||[])}catch(j){console.error("Error fetching personal bests:",j)}u(!1)},Te=async()=>{if(!jt||!re||!Mt)return;const j=parseFloat(re),C=Me[jt];if(!C||j<=C.weight){Ct("Target must be higher than current PB","error");return}p(!0);try{const P={...ft,[jt]:{targetWeight:j,setAt:kt.now(),currentPBWhenSet:C.weight}};await Ns($e(me,"coreBuddyTargets",Mt.id),{clientId:Mt.id,targets:P,updatedAt:kt.now()}),Qe(P),yt(null),Nt(""),Ct("Target set!","success")}catch(P){console.error("Error saving target:",P),Ct("Failed to save target","error")}p(!1)},Be=j=>{if(!Vt?.badges)return!1;const C=ft[j];return C?Vt.badges.some(P=>P.type==="pb_target"&&P.exercise===j&&P.targetWeight===C.targetWeight):!1},Ue=j=>{const C=ft[j];if(!C)return null;const P=Me[j];if(!P)return 0;const U=C.currentPBWhenSet||0,ye=C.targetWeight,Ve=ye-U;return Ve<=0?P.weight>=ye?1:0:Math.max(0,Math.min((P.weight-U)/Ve,1))},J=_P(),ge=t.find(j=>j.month===J),We=t.filter(j=>j.month<J),Ke=We.length>0?We[We.length-1]:null;v.useEffect(()=>{ge?(te(ge.benchmarks||{}),ie(ge.bodyMetrics||{})):(te({}),ie({}))},[ge?.id]);const z=async(j,C)=>{const P=[];if(j==="strength"?La.forEach(U=>{const ye=he[U.key];if(!ye)return;const Ve=C[U.key];if(!Ve)return;let Oe;if(ye.targetType==="time"){if(!ye.targetValue)return;const et=ye.startValue||0,nt=Ve.time||0,as=ye.targetValue-et;Oe=as===0?nt>=ye.targetValue?1:0:Math.max(0,(nt-et)/as)}else{if(!ye.targetWeight&&!ye.targetReps)return;const et=(ye.startWeight||0)*(ye.startReps||0),nt=(ye.targetWeight||0)*(ye.targetReps||0),as=(Ve.weight||0)*(Ve.reps||0),Cs=nt-et;Oe=Cs===0?as>=nt?1:0:Math.max(0,(as-et)/Cs)}if(Oe>=1&&!(ye.targetType==="time"?ze.some(nt=>nt.type==="strength"&&nt.key===U.key&&nt.targetValue===ye.targetValue):ze.some(nt=>nt.type==="strength"&&nt.key===U.key&&nt.targetWeight===ye.targetWeight&&nt.targetReps===ye.targetReps))){const nt=ye.targetType==="time"?`${U.name} ${ye.targetValue}s`:`${U.name} ${ye.targetWeight}kg  ${ye.targetReps}`;P.push({type:"strength",key:U.key,...ye.targetType==="time"?{targetType:"time",targetValue:ye.targetValue}:{targetWeight:ye.targetWeight,targetReps:ye.targetReps},achievedMonth:J,label:nt})}}):Vo.forEach(U=>{const ye=fe[U.key];if(!ye||!ye.targetValue)return;const Ve=C[U.key];if(Ve==null)return;const Oe=ye.startValue||0,et=ye.targetValue,nt=et-Oe;(nt===0?Ve===et?1:0:Math.max(0,(Ve-Oe)/nt))>=1&&(ze.some(ls=>ls.type==="metric"&&ls.key===U.key&&ls.targetValue===et)||P.push({type:"metric",key:U.key,targetValue:et,achievedMonth:J,label:`${U.name} ${et}${U.suffix}`}))}),P.length>0){const U=[...ze,...P];await Ns($e(me,"achievements",Mt.id),{clientId:Mt.id,badges:U,updatedAt:kt.now()}),mt(U),ue(P),setTimeout(()=>ue(null),5e3)}},se=(j,C)=>{if(j==="strength"){const P=he[C];return P?P.targetType==="time"?ze.some(U=>U.type==="strength"&&U.key===C&&U.targetValue===P.targetValue):!P.targetWeight&&!P.targetReps?!1:ze.some(U=>U.type==="strength"&&U.key===C&&U.targetWeight===P.targetWeight&&U.targetReps===P.targetReps):!1}else{const P=fe[C];return!P||!P.targetValue?!1:ze.some(U=>U.type==="metric"&&U.key===C&&U.targetValue===P.targetValue)}},Ge=async()=>{p(!0);try{const j=`${Mt.id}_${J}`,C=ge||{};await Ns($e(me,"personalBests",j),{clientId:Mt.id,month:J,benchmarks:V,bodyMetrics:C.bodyMetrics||Y||{},createdAt:C.createdAt||kt.now(),updatedAt:kt.now()}),await z("strength",V),Ct("Benchmarks saved!","success"),k(!1),await be()}catch(j){console.error("Error saving benchmarks:",j),Ct("Failed to save. Please try again.","error")}p(!1)},He=async()=>{p(!0);try{const j=`${Mt.id}_${J}`,C=ge||{};await Ns($e(me,"personalBests",j),{clientId:Mt.id,month:J,benchmarks:C.benchmarks||V||{},bodyMetrics:Y,createdAt:C.createdAt||kt.now(),updatedAt:kt.now()}),await z("metric",Y),Ct("Body metrics saved!","success"),O(!1),await be()}catch(j){console.error("Error saving metrics:",j),Ct("Failed to save. Please try again.","error")}p(!1)},Xe=(j,C,P)=>{te(U=>({...U,[j]:{...U[j],[C]:P===""?"":parseFloat(P)}}))},lt=(j,C)=>{ie(P=>({...P,[j]:C===""?"":parseFloat(C)}))},_t=(j,C,P)=>{M(U=>({...U,[j]:{...U[j],[C]:P===""?"":parseFloat(P)}}))},pt=async()=>{p(!0);try{const j=`targets_${Mt.id}`,C=ge?.benchmarks||{},P={};La.forEach(U=>{const ye=C[U.key];U.unit==="time"?E[U.key]?.targetValue&&(P[U.key]={targetType:"time",targetValue:E[U.key].targetValue,startValue:ye?.time||0}):(E[U.key]?.targetWeight||E[U.key]?.targetReps)&&(P[U.key]={targetWeight:E[U.key].targetWeight||0,targetReps:E[U.key].targetReps||0,startWeight:ye?.weight||0,startReps:ye?.reps||0})}),await Ns($e(me,"personalBestTargets",j),{clientId:Mt.id,targets:P,metricTargets:fe,updatedAt:kt.now()}),Ne(P),M(P),Ct("Targets saved!","success"),F(!1)}catch(j){console.error("Error saving targets:",j),Ct("Failed to save targets.","error")}p(!1)},Wt=(j,C)=>{I(P=>({...P,[j]:{...P[j],targetValue:C===""?"":parseFloat(C)}}))},en=async()=>{p(!0);try{const j=`targets_${Mt.id}`,C={};Vo.forEach(P=>{if(H[P.key]?.targetValue){const U=ge?.bodyMetrics?.[P.key]||0;C[P.key]={targetValue:H[P.key].targetValue,startValue:U}}}),await Ns($e(me,"personalBestTargets",j),{clientId:Mt.id,targets:he,metricTargets:C,updatedAt:kt.now()}),R(C),I(C),Ct("Metric targets saved!","success"),D(!1)}catch(j){console.error("Error saving metric targets:",j),Ct("Failed to save targets.","error")}p(!1)},ts=async()=>{if(window.confirm("Reset all goals? This will clear all strength and body metric targets. Your recorded benchmarks and measurements will NOT be affected.")){p(!0);try{const j=$e(me,"personalBestTargets",`targets_${Mt.id}`);await jr(j),Ne({}),R({}),M({}),I({}),Ct("All goals have been reset","success")}catch(j){console.error("Error resetting targets:",j),Ct("Failed to reset goals","error")}p(!1)}},ks=(j,C)=>{const P=he[j];if(!P||!C)return null;if(P.targetType==="time"){if(!P.targetValue)return null;const et=P.startValue||0,nt=P.targetValue,as=C.time||0,Cs=nt-et;return Cs<=0?as>=nt?1:0:Math.max(0,Math.min((as-et)/Cs,1))}if(!P.targetWeight&&!P.targetReps)return null;const U=(P.startWeight||0)*(P.startReps||0),ye=(P.targetWeight||0)*(P.targetReps||0),Ve=(C.weight||0)*(C.reps||0),Oe=ye-U;return Oe<=0?Ve>=ye?1:0:Math.max(0,Math.min((Ve-U)/Oe,1))},zs=j=>{const C=fe[j];if(!C||!C.targetValue)return null;const P=ge?.bodyMetrics?.[j];if(P==null)return null;const U=C.startValue||0,ye=C.targetValue,Ve=ye-U;return Ve===0?P===ye?1:0:Math.max(0,Math.min((P-U)/Ve,1))},$=j=>{ut.current=j.touches[0].clientX,Ye.current=0},we=j=>{Ye.current=j.touches[0].clientX-ut.current},Se=()=>{Ye.current<-50?Xt(g+1):Ye.current>50&&Xt(g-1),Ye.current=0},Ee=j=>{const C=ge?.bodyMetrics?.[j],P=Ke?.bodyMetrics?.[j];return C==null||P==null?null:parseFloat((C-P).toFixed(2))},ke=t.find(j=>j.month===ne),dt=t.find(j=>j.month===de);if(is||l)return r.jsxs("div",{className:"pb-page",children:[r.jsx("header",{className:"client-header",children:r.jsx("div",{className:"header-content",children:r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})})}),r.jsxs("main",{className:"pb-main",children:[r.jsx("div",{className:"skeleton skeleton-title",style:{width:180,height:28,marginBottom:20}}),r.jsx("div",{className:"skeleton skeleton-card-large",style:{height:320,borderRadius:16}})]})]});if(!Ks||!Ut||!Mt)return null;if(_s&&Mt?.isJunior)return r.jsx(vP,{});const bt=La[g],st=ge?.benchmarks?.[bt.key],St=Ke?.benchmarks?.[bt.key],xt=Ul(bt,st),hs=Ul(bt,St),Tn=sg(xt,hs),yn=ks(bt.key,st),Rn=yn!==null,bn=yn!==null&&yn>=1,rn=Rn?Math.round(yn*60):xt>0?15:0,qs=he[bt.key];return r.jsx(Sa,{children:r.jsxs("div",{className:"pb-page",children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>Kt(ds?"/client/core-buddy":"/client"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})]})}),r.jsxs("main",{className:"pb-main page-transition-enter",children:[r.jsxs("div",{className:"pb-intro anim-fade-up",children:[r.jsx("h2",{children:"Personal Bests"}),r.jsx("p",{children:_s?"Track your strength benchmarks and body measurements each month.":"Your all-time best lifts from programme workouts."})]}),!_s&&r.jsxs("div",{className:"pb-cb-section anim-fade-up-d2",children:[Object.keys(Me).length===0?r.jsxs("div",{className:"pb-empty",children:[r.jsx("div",{className:"pb-cb-empty-icon",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M20.57 14.86L22 13.43 20.57 12 17 15.57 8.43 7 12 3.43 10.57 2 9.14 3.43 7.71 2 5.57 4.14 4.14 2.71 2.71 4.14l1.43 1.43L2 7.71l1.43 1.43L2 10.57 3.43 12 7 8.43 15.57 17 12 20.57 13.43 22l1.43-1.43L16.29 22l2.14-2.14 1.43 1.43 1.43-1.43-1.43-1.43L22 16.29z"})})}),r.jsx("h4",{children:"No personal bests yet"}),r.jsx("p",{children:"Complete weight-based workouts to start tracking your personal bests."})]}):r.jsx("div",{className:"pb-cb-grouped",children:(()=>{const j={},C=[];return Object.entries(Me).forEach(([P,U])=>{const ye=wP(P);ye?(j[ye]||(j[ye]=[]),j[ye].push([P,U])):C.push([P,U])}),Object.values(j).forEach(P=>P.sort(([U],[ye])=>U.localeCompare(ye))),C.sort(([P],[U])=>P.localeCompare(U)),r.jsxs(r.Fragment,{children:[xP.map(P=>{const U=j[P.key];if(!U||U.length===0)return null;const ye=!!vt[P.key],Ve=U.reduce((Oe,[,et])=>!Oe||et.weight>Oe.weight?et:Oe,null);return r.jsxs("div",{className:`pb-cb-group ${ye?"open":""}`,style:{"--group-color":P.color},children:[r.jsxs("button",{className:"pb-cb-group-header",onClick:()=>Pt(Oe=>({...Oe,[P.key]:!Oe[P.key]})),children:[r.jsx("div",{className:"pb-cb-group-accent"}),r.jsx("div",{className:"pb-cb-group-icon",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:r.jsx("path",{d:P.icon})})}),r.jsxs("div",{className:"pb-cb-group-text",children:[r.jsx("h3",{className:"pb-cb-group-label",children:P.label}),r.jsx("span",{className:"pb-cb-group-subtitle",children:P.subtitle})]}),r.jsxs("div",{className:"pb-cb-group-meta",children:[r.jsxs("span",{className:"pb-cb-group-count",children:[U.length," PB",U.length!==1?"s":""]}),Ve&&r.jsxs("span",{className:"pb-cb-group-best",children:["Best: ",Ve.weight,"kg"]})]}),r.jsx("svg",{className:`pb-cb-group-chevron ${ye?"open":""}`,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M6 9l6 6 6-6"})})]}),r.jsx("div",{className:"pb-cb-group-body",style:{display:ye?"block":"none"},children:r.jsx("div",{className:"pb-cb-grid",children:U.map(([Oe,et],nt)=>{const as=ft[Oe],Cs=Ue(Oe),ls=Cs!==null&&Cs>=1,cs=Be(Oe),Hs=Cs!==null?Math.round(Cs*60):60;return r.jsxs("div",{className:"pb-cb-card",style:{"--group-color":P.color,animationDelay:`${nt*.05}s`},children:[r.jsxs("div",{className:"pb-cb-card-top",children:[r.jsxs("div",{className:"pb-cb-card-ring",children:[r.jsx("svg",{className:"pb-cb-ring-svg",viewBox:"0 0 80 80",children:j2.map((fn,Ur)=>{const gs=Ur<Hs;return r.jsx("line",{x1:fn.x1,y1:fn.y1,x2:fn.x2,y2:fn.y2,className:`pb-ring-tick ${gs?ls?"hit":"filled":"empty"}`,style:gs&&!ls?{stroke:P.color}:void 0,strokeWidth:fn.thick?"2":"1.5"},Ur)})}),r.jsx("div",{className:"pb-cb-ring-icon",style:{color:P.color},children:cs?r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",className:"pb-cb-badge-earned",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}):r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:r.jsx("path",{d:P.icon})})})]}),r.jsxs("div",{className:"pb-cb-card-info",children:[r.jsx("h4",{className:"pb-cb-card-name",children:Oe}),r.jsxs("div",{className:"pb-cb-card-value",style:{color:P.color},children:[et.weight,"kg  ",et.reps]}),et.achievedAt&&r.jsx("div",{className:"pb-cb-card-date",children:(et.achievedAt.toDate?et.achievedAt.toDate():new Date(et.achievedAt)).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"})}),as&&ls&&!cs&&r.jsx("div",{className:"pb-cb-target-info hit",children:"Target hit!"}),cs&&r.jsx("div",{className:"pb-cb-target-info earned",children:"Badge earned!"})]}),r.jsx("div",{className:"pb-cb-card-action",children:r.jsx("button",{className:"pb-cb-target-btn",style:{borderColor:P.color,background:`color-mix(in srgb, ${P.color} 10%, transparent)`,color:P.color},onClick:()=>{yt(Oe),Nt("")},children:as?ls&&cs?r.jsx("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M12 5v14M5 12h14"})}):r.jsxs("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),r.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]}):r.jsxs("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("circle",{cx:"12",cy:"12",r:"6"}),r.jsx("circle",{cx:"12",cy:"12",r:"2"})]})})})]}),as&&!ls&&r.jsxs("div",{className:"pb-cb-card-progress",children:[r.jsxs("div",{className:"pb-cb-progress-labels",children:[r.jsxs("span",{className:"pb-cb-progress-current",children:[et.weight,"kg"]}),r.jsxs("span",{className:"pb-cb-progress-target",style:{color:P.color},children:["Target: ",as.targetWeight,"kg"]})]}),r.jsx("div",{className:"pb-cb-progress-bar",children:r.jsx("div",{className:"pb-cb-progress-bar-fill",style:{width:`${Math.round((Cs||0)*100)}%`,background:P.color}})}),r.jsxs("div",{className:"pb-cb-progress-pct",style:{color:P.color},children:[Math.round((Cs||0)*100),"%"]})]}),as&&ls&&r.jsx("div",{className:"pb-cb-card-progress",children:r.jsx("div",{className:"pb-cb-progress-bar",children:r.jsx("div",{className:"pb-cb-progress-bar-fill hit",style:{width:"100%"}})})})]},Oe)})})})]},P.key)}),C.length>0&&(()=>{const P=!!vt.other;return r.jsxs("div",{className:`pb-cb-group ${P?"open":""}`,style:{"--group-color":"var(--text-tertiary)"},children:[r.jsxs("button",{className:"pb-cb-group-header",onClick:()=>Pt(U=>({...U,other:!U.other})),children:[r.jsx("div",{className:"pb-cb-group-accent"}),r.jsx("div",{className:"pb-cb-group-icon",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:r.jsx("path",{d:"M20.57 14.86L22 13.43 20.57 12 17 15.57 8.43 7 12 3.43 10.57 2 9.14 3.43 7.71 2 5.57 4.14 4.14 2.71 2.71 4.14l1.43 1.43L2 7.71l1.43 1.43L2 10.57 3.43 12 7 8.43 15.57 17 12 20.57 13.43 22l1.43-1.43L16.29 22l2.14-2.14 1.43 1.43 1.43-1.43-1.43-1.43L22 16.29z"})})}),r.jsx("div",{className:"pb-cb-group-text",children:r.jsx("h3",{className:"pb-cb-group-label",children:"Other"})}),r.jsx("div",{className:"pb-cb-group-meta",children:r.jsxs("span",{className:"pb-cb-group-count",children:[C.length," PB",C.length!==1?"s":""]})}),r.jsx("svg",{className:`pb-cb-group-chevron ${P?"open":""}`,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M6 9l6 6 6-6"})})]}),r.jsx("div",{className:"pb-cb-group-body",style:{display:P?"block":"none"},children:r.jsx("div",{className:"pb-cb-grid",children:C.map(([U,ye],Ve)=>{const Oe=ft[U],et=Ue(U),nt=et!==null&&et>=1,as=Be(U),Cs=et!==null?Math.round(et*60):60;return r.jsxs("div",{className:"pb-cb-card",style:{animationDelay:`${Ve*.05}s`},children:[r.jsxs("div",{className:"pb-cb-card-top",children:[r.jsxs("div",{className:"pb-cb-card-ring",children:[r.jsx("svg",{className:"pb-cb-ring-svg",viewBox:"0 0 80 80",children:j2.map((ls,cs)=>{const Hs=cs<Cs;return r.jsx("line",{x1:ls.x1,y1:ls.y1,x2:ls.x2,y2:ls.y2,className:`pb-ring-tick ${Hs?nt?"hit":"filled":"empty"}`,strokeWidth:ls.thick?"2":"1.5"},cs)})}),r.jsx("div",{className:"pb-cb-ring-icon",children:as?r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",className:"pb-cb-badge-earned",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}):r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M20.57 14.86L22 13.43 20.57 12 17 15.57 8.43 7 12 3.43 10.57 2 9.14 3.43 7.71 2 5.57 4.14 4.14 2.71 2.71 4.14l1.43 1.43L2 7.71l1.43 1.43L2 10.57 3.43 12 7 8.43 15.57 17 12 20.57 13.43 22l1.43-1.43L16.29 22l2.14-2.14 1.43 1.43 1.43-1.43-1.43-1.43L22 16.29z"})})})]}),r.jsxs("div",{className:"pb-cb-card-info",children:[r.jsx("h4",{className:"pb-cb-card-name",children:U}),r.jsxs("div",{className:"pb-cb-card-value",children:[ye.weight,"kg  ",ye.reps]}),ye.achievedAt&&r.jsx("div",{className:"pb-cb-card-date",children:(ye.achievedAt.toDate?ye.achievedAt.toDate():new Date(ye.achievedAt)).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"})}),Oe&&nt&&!as&&r.jsx("div",{className:"pb-cb-target-info hit",children:"Target hit!"}),as&&r.jsx("div",{className:"pb-cb-target-info earned",children:"Badge earned!"})]}),r.jsx("div",{className:"pb-cb-card-action",children:r.jsx("button",{className:"pb-cb-target-btn",onClick:()=>{yt(U),Nt("")},children:Oe?nt&&as?r.jsx("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M12 5v14M5 12h14"})}):r.jsxs("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),r.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]}):r.jsxs("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("circle",{cx:"12",cy:"12",r:"6"}),r.jsx("circle",{cx:"12",cy:"12",r:"2"})]})})})]}),Oe&&!nt&&r.jsxs("div",{className:"pb-cb-card-progress",children:[r.jsxs("div",{className:"pb-cb-progress-labels",children:[r.jsxs("span",{className:"pb-cb-progress-current",children:[ye.weight,"kg"]}),r.jsxs("span",{className:"pb-cb-progress-target",children:["Target: ",Oe.targetWeight,"kg"]})]}),r.jsx("div",{className:"pb-cb-progress-bar",children:r.jsx("div",{className:"pb-cb-progress-bar-fill",style:{width:`${Math.round((et||0)*100)}%`}})}),r.jsxs("div",{className:"pb-cb-progress-pct",children:[Math.round((et||0)*100),"%"]})]}),Oe&&nt&&r.jsx("div",{className:"pb-cb-card-progress",children:r.jsx("div",{className:"pb-cb-progress-bar",children:r.jsx("div",{className:"pb-cb-progress-bar-fill hit",style:{width:"100%"}})})})]},U)})})})]})})()]})})()}),Object.keys(Me).length>0&&r.jsxs("button",{className:"pb-cb-achievements-link anim-fade-up-d4",onClick:()=>Kt("/client/core-buddy/achievements"),children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"18",height:"18",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),"View Achievements",r.jsx("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})]}),jt&&r.jsx("div",{className:"pb-cb-target-modal-overlay",onClick:()=>yt(null),children:r.jsxs("div",{className:"pb-cb-target-modal",onClick:j=>j.stopPropagation(),children:[r.jsx("h3",{children:"Set Target"}),r.jsx("p",{className:"pb-cb-target-exercise-name",children:jt}),r.jsxs("div",{className:"pb-cb-target-current",children:["Current PB: ",r.jsxs("strong",{children:[Me[jt]?.weight,"kg"]})]}),r.jsxs("div",{className:"pb-cb-target-input-wrap",children:[r.jsx("label",{children:"Your target (kg)"}),r.jsx("input",{type:"number",inputMode:"decimal",step:"0.5",value:re,onChange:j=>Nt(j.target.value),placeholder:String((Me[jt]?.weight||0)+5),className:"pb-cb-target-input",autoFocus:!0})]}),r.jsxs("div",{className:"pb-cb-target-actions",children:[r.jsx("button",{className:"pb-cancel-btn",onClick:()=>yt(null),children:"Cancel"}),r.jsx("button",{className:"pb-save-btn",onClick:Te,disabled:d,children:d?"Saving...":"Set Target"})]})]})})]}),_s&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"pb-tabs",children:[r.jsx("button",{className:`pb-tab ${n==="bests"?"active":""}`,onClick:()=>e("bests"),children:"Strength"}),r.jsx("button",{className:`pb-tab ${n==="metrics"?"active":""}`,onClick:()=>e("metrics"),children:"Body Metrics"}),r.jsx("button",{className:`pb-tab ${n==="history"?"active":""}`,onClick:()=>e("history"),children:"History"})]}),n==="bests"&&r.jsxs("div",{className:"pb-strength-section",children:[!x&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"pb-carousel",ref:Et,onTouchStart:$,onTouchMove:we,onTouchEnd:Se,children:[r.jsx("div",{className:`pb-ring-container slide-from-${It.current}`,children:r.jsxs("div",{className:"pb-ring",children:[r.jsx("svg",{className:"pb-ring-svg",viewBox:"0 0 200 200",children:eb.map((j,C)=>{const P=C<Math.round(rn);return r.jsx("line",{x1:j.x1,y1:j.y1,x2:j.x2,y2:j.y2,className:`pb-ring-tick ${P?bn?"hit":"filled":"empty"}`,strokeWidth:j.thick?"3":"2"},C)})}),r.jsxs("div",{className:"pb-ring-center",children:[r.jsx("div",{className:"pb-ring-category",children:bt.category}),r.jsxs("div",{className:"pb-ring-exercise",children:[bt.name,se("strength",bt.key)&&r.jsx("svg",{className:"pb-badge-icon",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})]}),r.jsx("div",{className:"pb-ring-value",children:st?bt.unit==="time"?fh(st.time):D2(st.weight,st.reps):"-"}),Tn!==null&&r.jsxs("div",{className:`pb-ring-change ${Tn>=0?"positive":"negative"}`,children:[Tn>=0?"+":"",Tn.toFixed(1),"%"]}),Tn===null&&st&&r.jsx("div",{className:"pb-ring-change neutral",children:"New entry"}),qs&&r.jsx("div",{className:`pb-ring-target ${bn?"hit":""}`,children:bn?"Target hit!":qs.targetType==="time"?`${qs.startValue||0}s  ${qs.targetValue}s`:`${qs.startWeight||0}kg${qs.startReps||0}  ${qs.targetWeight}kg${qs.targetReps}`}),!qs&&r.jsx("div",{className:"pb-ring-target none",children:"No target set"})]})]})},g),r.jsx("div",{className:"pb-carousel-dots",children:La.map((j,C)=>r.jsx("button",{className:`pb-dot ${C===g?"active":""}`,onClick:()=>Xt(C)},C))}),r.jsx("button",{className:"pb-carousel-arrow left",onClick:()=>Xt(g-1),disabled:g===0,children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"})})}),r.jsx("button",{className:"pb-carousel-arrow right",onClick:()=>Xt(g+1),disabled:g===La.length-1,children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M8.59 16.59L10 18l6-6-6-6-1.41 1.41L13.17 12z"})})})]}),r.jsxs("div",{className:"pb-trend-section",children:[r.jsx("h4",{children:"Trend"}),r.jsx(kP,{data:t,exerciseKey:bt.key,unit:bt.unit})]})]}),!x&&!G&&r.jsxs("div",{className:"pb-action-buttons",children:[r.jsx("button",{className:"pb-edit-btn",onClick:()=>k(!0),children:ge?.benchmarks?"Edit This Month's Benchmarks":"Add This Month's Benchmarks"}),r.jsx("button",{className:"pb-edit-btn pb-target-btn",onClick:()=>F(!0),children:Object.keys(he).length>0?"Edit Targets":"Set Targets"}),(Object.keys(he).length>0||Object.keys(fe).length>0)&&r.jsx("button",{className:"pb-edit-btn pb-reset-btn",onClick:ts,disabled:d,children:"Reset All Goals"})]}),x&&r.jsxs("div",{className:"pb-edit-card",children:[r.jsxs("div",{className:"pb-edit-header",children:[r.jsxs("h3",{children:["Benchmarks - ",_a(J)]}),r.jsx("button",{className:"pb-edit-close",onClick:()=>{k(!1),te(ge?.benchmarks||{})},children:""})]}),r.jsx("div",{className:"pb-edit-body",children:La.map(j=>r.jsxs("div",{className:"pb-edit-exercise",children:[r.jsx("div",{className:"pb-edit-exercise-name",children:j.name}),j.unit==="weight"?r.jsxs("div",{className:"pb-edit-row",children:[r.jsxs("div",{className:"pb-edit-field",children:[r.jsx("label",{children:"Weight (kg)"}),r.jsx("input",{type:"number",step:"0.5",value:V[j.key]?.weight??"",onChange:C=>Xe(j.key,"weight",C.target.value),placeholder:"0"})]}),r.jsxs("div",{className:"pb-edit-field",children:[r.jsx("label",{children:"Reps"}),r.jsx("input",{type:"number",value:V[j.key]?.reps??"",onChange:C=>Xe(j.key,"reps",C.target.value),placeholder:"0"})]})]}):r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsx("label",{children:"Time (seconds)"}),r.jsx("input",{type:"number",step:"0.01",value:V[j.key]?.time??"",onChange:C=>Xe(j.key,"time",C.target.value),placeholder:"0"})]})})]},j.key))}),r.jsxs("div",{className:"pb-edit-actions",children:[r.jsx("button",{className:"pb-cancel-btn",onClick:()=>{k(!1),te(ge?.benchmarks||{})},children:"Cancel"}),r.jsx("button",{className:"pb-save-btn",onClick:Ge,disabled:d,children:d?"Saving...":"Save"})]})]}),G&&r.jsxs("div",{className:"pb-edit-card",children:[r.jsxs("div",{className:"pb-edit-header",children:[r.jsx("h3",{children:"Set Your Targets"}),r.jsx("button",{className:"pb-edit-close",onClick:()=>{F(!1),M(he)},children:""})]}),r.jsxs("div",{className:"pb-edit-body",children:[r.jsx("p",{className:"pb-target-hint",children:"Set a target for each exercise. Your current best is captured automatically from your latest benchmarks."}),La.map(j=>{const C=ge?.benchmarks?.[j.key];let P="-";return C&&(j.unit==="time"&&C.time?P=`${C.time}s`:(C.weight||C.reps)&&(P=`${C.weight||0}kg  ${C.reps||0}`)),r.jsxs("div",{className:"pb-edit-exercise",children:[r.jsxs("div",{className:"pb-edit-exercise-header",children:[r.jsx("div",{className:"pb-edit-exercise-name",children:j.name}),r.jsxs("div",{className:"pb-edit-current-best",children:["Current: ",P]})]}),j.unit==="weight"?r.jsxs("div",{className:"pb-edit-row",children:[r.jsxs("div",{className:"pb-edit-field",children:[r.jsx("label",{children:"Target Weight (kg)"}),r.jsx("input",{type:"number",step:"0.5",value:E[j.key]?.targetWeight??"",onChange:U=>_t(j.key,"targetWeight",U.target.value),placeholder:"0"})]}),r.jsxs("div",{className:"pb-edit-field",children:[r.jsx("label",{children:"Target Reps"}),r.jsx("input",{type:"number",value:E[j.key]?.targetReps??"",onChange:U=>_t(j.key,"targetReps",U.target.value),placeholder:"0"})]})]}):r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsx("label",{children:"Target (seconds)"}),r.jsx("input",{type:"number",step:"1",value:E[j.key]?.targetValue??"",onChange:U=>_t(j.key,"targetValue",U.target.value),placeholder:"0"})]})})]},j.key)})]}),r.jsxs("div",{className:"pb-edit-actions",children:[r.jsx("button",{className:"pb-cancel-btn",onClick:()=>{F(!1),M(he)},children:"Cancel"}),r.jsx("button",{className:"pb-save-btn",onClick:pt,disabled:d,children:d?"Saving...":"Save Targets"})]})]})]}),n==="metrics"&&r.jsxs("div",{className:"pb-metrics-section",children:[!T&&!B&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"pb-metrics-card",children:[r.jsx("h3",{children:"Body Measurements"}),r.jsx("p",{className:"pb-metrics-month",children:_a(J)}),r.jsx("div",{className:"pb-metrics-list",children:Vo.map(j=>{const C=ge?.bodyMetrics?.[j.key],P=Ee(j.key),U=fe[j.key],ye=zs(j.key),Ve=ye!==null&&ye>=1;return r.jsxs("div",{className:"pb-metric-row",children:[r.jsxs("div",{className:"pb-metric-top",children:[r.jsxs("div",{className:"pb-metric-left",children:[r.jsxs("span",{className:"pb-metric-name",children:[j.name,se("metric",j.key)&&r.jsx("svg",{className:"pb-badge-icon-sm",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})]}),U&&r.jsxs("span",{className:"pb-metric-target-label",children:["Target: ",U.targetValue," ",j.suffix]})]}),r.jsxs("div",{className:"pb-metric-values",children:[r.jsx("span",{className:"pb-metric-current",children:C!=null?`${C} ${j.suffix}`:"-"}),P!==null&&r.jsxs("span",{className:`pb-metric-change ${P>0?"up":P<0?"down":"same"}`,children:[P>0?"+":"",P," ",j.suffix]})]})]}),ye!==null&&r.jsxs("div",{className:"pb-metric-progress",children:[r.jsx("div",{className:"pb-metric-bar",children:r.jsx("div",{className:`pb-metric-bar-fill ${Ve?"hit":""}`,style:{width:`${Math.round(ye*100)}%`}})}),r.jsx("span",{className:`pb-metric-percent ${Ve?"hit":""}`,children:Ve?"Hit!":`${Math.round(ye*100)}%`})]})]},j.key)})})]}),r.jsxs("div",{className:"pb-action-buttons",children:[r.jsx("button",{className:"pb-edit-btn",onClick:()=>O(!0),children:ge?.bodyMetrics?"Edit This Month's Measurements":"Add This Month's Measurements"}),r.jsx("button",{className:"pb-edit-btn pb-target-btn",onClick:()=>D(!0),children:Object.keys(fe).length>0?"Edit Targets":"Set Targets"}),(Object.keys(he).length>0||Object.keys(fe).length>0)&&r.jsx("button",{className:"pb-edit-btn pb-reset-btn",onClick:ts,disabled:d,children:"Reset All Goals"})]})]}),T&&r.jsxs("div",{className:"pb-edit-card",children:[r.jsxs("div",{className:"pb-edit-header",children:[r.jsxs("h3",{children:["Measurements - ",_a(J)]}),r.jsx("button",{className:"pb-edit-close",onClick:()=>{O(!1),ie(ge?.bodyMetrics||{})},children:""})]}),r.jsx("div",{className:"pb-edit-body",children:Vo.map(j=>r.jsx("div",{className:"pb-edit-metric",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsxs("label",{children:[j.name," (",j.suffix,")"]}),r.jsx("input",{type:"number",step:"0.1",value:Y[j.key]??"",onChange:C=>lt(j.key,C.target.value),placeholder:"0"})]})},j.key))}),r.jsxs("div",{className:"pb-edit-actions",children:[r.jsx("button",{className:"pb-cancel-btn",onClick:()=>{O(!1),ie(ge?.bodyMetrics||{})},children:"Cancel"}),r.jsx("button",{className:"pb-save-btn",onClick:He,disabled:d,children:d?"Saving...":"Save"})]})]}),B&&r.jsxs("div",{className:"pb-edit-card",children:[r.jsxs("div",{className:"pb-edit-header",children:[r.jsx("h3",{children:"Body Metric Targets"}),r.jsx("button",{className:"pb-edit-close",onClick:()=>{D(!1),I(fe)},children:""})]}),r.jsxs("div",{className:"pb-edit-body",children:[r.jsx("p",{className:"pb-target-hint",children:"Set targets for your body measurements. Your current measurement is captured automatically."}),Vo.map(j=>{const C=ge?.bodyMetrics?.[j.key];return r.jsxs("div",{className:"pb-edit-exercise",children:[r.jsxs("div",{className:"pb-edit-exercise-header",children:[r.jsx("div",{className:"pb-edit-exercise-name",children:j.name}),r.jsxs("div",{className:"pb-edit-current-best",children:["Current: ",C!=null?`${C} ${j.suffix}`:"-"]})]}),r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsxs("label",{children:["Target (",j.suffix,")"]}),r.jsx("input",{type:"number",step:"0.1",value:H[j.key]?.targetValue??"",onChange:P=>Wt(j.key,P.target.value),placeholder:"0"})]})})]},j.key)})]}),r.jsxs("div",{className:"pb-edit-actions",children:[r.jsx("button",{className:"pb-cancel-btn",onClick:()=>{D(!1),I(fe)},children:"Cancel"}),r.jsx("button",{className:"pb-save-btn",onClick:en,disabled:d,children:d?"Saving...":"Save Targets"})]})]})]}),n==="history"&&r.jsx("div",{className:"pb-history-section",children:t.length===0?r.jsxs("div",{className:"pb-empty",children:[r.jsx("h4",{children:"No records yet"}),r.jsx("p",{children:"Start adding your monthly benchmarks and measurements to track your progress over time."})]}):r.jsxs(r.Fragment,{children:[ze.length>0&&r.jsxs("div",{className:"pb-achievements-wall",children:[r.jsxs("h4",{className:"pb-achievements-wall-title",children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"18",height:"18",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),"Targets Achieved"]}),r.jsx("div",{className:"pb-achievements-list",children:[...ze].reverse().map((j,C)=>r.jsxs("div",{className:"pb-achievement-item",style:{animationDelay:`${C*.05}s`},children:[r.jsx("div",{className:"pb-achievement-star",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),r.jsxs("div",{className:"pb-achievement-info",children:[r.jsx("span",{className:"pb-achievement-label",children:j.label}),r.jsx("span",{className:"pb-achievement-date",children:_a(j.achievedMonth)})]})]},C))})]}),r.jsx("div",{className:"pb-history-controls",children:r.jsx("button",{className:`pb-compare-toggle ${Z?"active":""}`,onClick:()=>{L(!Z),!Z&&t.length>=2&&(Ie(t[0].month),qe(t[t.length-1].month))},children:Z?"Back to Timeline":"Compare Months"})}),Z?r.jsxs("div",{className:"pb-compare",children:[r.jsxs("div",{className:"pb-compare-selectors",children:[r.jsxs("div",{className:"pb-compare-select",children:[r.jsx("label",{children:"From"}),r.jsx("select",{value:ne,onChange:j=>Ie(j.target.value),children:t.map(j=>r.jsx("option",{value:j.month,children:_a(j.month)},j.month))})]}),r.jsx("div",{className:"pb-compare-vs",children:"vs"}),r.jsxs("div",{className:"pb-compare-select",children:[r.jsx("label",{children:"To"}),r.jsx("select",{value:de,onChange:j=>qe(j.target.value),children:t.map(j=>r.jsx("option",{value:j.month,children:_a(j.month)},j.month))})]})]}),ke&&dt&&r.jsxs("div",{className:"pb-compare-results",children:[r.jsxs("div",{className:"pb-compare-group",children:[r.jsx("h4",{children:"Strength Benchmarks"}),r.jsxs("div",{className:"pb-compare-table",children:[r.jsxs("div",{className:"pb-compare-header-row",children:[r.jsx("span",{children:"Exercise"}),r.jsx("span",{children:_a(ne).split(" ")[0]}),r.jsx("span",{children:_a(de).split(" ")[0]}),r.jsx("span",{children:"Change"})]}),La.map(j=>{const C=ke.benchmarks?.[j.key],P=dt.benchmarks?.[j.key],U=Ul(j,C),ye=Ul(j,P),Ve=sg(ye,U);return r.jsxs("div",{className:"pb-compare-row",children:[r.jsx("span",{className:"pb-compare-name",children:j.name}),r.jsx("span",{className:"pb-compare-val",children:C?j.unit==="time"?fh(C.time):`${C.weight}x${C.reps}`:"-"}),r.jsx("span",{className:"pb-compare-val",children:P?j.unit==="time"?fh(P.time):`${P.weight}x${P.reps}`:"-"}),r.jsx("span",{className:`pb-compare-change ${Ve!==null?Ve>=0?"positive":"negative":""}`,children:Ve!==null?`${Ve>=0?"+":""}${Ve.toFixed(1)}%`:"-"})]},j.key)})]})]}),r.jsxs("div",{className:"pb-compare-group",children:[r.jsx("h4",{children:"Body Measurements"}),r.jsxs("div",{className:"pb-compare-table",children:[r.jsxs("div",{className:"pb-compare-header-row",children:[r.jsx("span",{children:"Measurement"}),r.jsx("span",{children:_a(ne).split(" ")[0]}),r.jsx("span",{children:_a(de).split(" ")[0]}),r.jsx("span",{children:"Change"})]}),Vo.map(j=>{const C=ke.bodyMetrics?.[j.key],P=dt.bodyMetrics?.[j.key],U=C!=null&&P!=null?parseFloat((P-C).toFixed(2)):null;return r.jsxs("div",{className:"pb-compare-row",children:[r.jsx("span",{className:"pb-compare-name",children:j.name}),r.jsx("span",{className:"pb-compare-val",children:C!=null?`${C}`:"-"}),r.jsx("span",{className:"pb-compare-val",children:P!=null?`${P}`:"-"}),r.jsx("span",{className:`pb-compare-change ${U!==null?U>0?"positive":U<0?"negative":"neutral":""}`,children:U!==null?`${U>0?"+":""}${U} ${j.suffix}`:"-"})]},j.key)})]})]})]})]}):r.jsx("div",{className:"pb-timeline",children:[...t].reverse().map((j,C)=>{const P=t.find(U=>U.month<j.month&&t.indexOf(U)===t.indexOf(j)-1)||t.filter(U=>U.month<j.month).pop();return r.jsxs("div",{className:"pb-timeline-item",style:{animationDelay:`${C*.05}s`},children:[r.jsx("div",{className:"pb-timeline-dot"}),r.jsxs("div",{className:"pb-timeline-card",children:[r.jsx("h4",{children:_a(j.month)}),j.benchmarks&&Object.keys(j.benchmarks).length>0&&r.jsxs("div",{className:"pb-timeline-group",children:[r.jsx("h5",{children:"Strength Benchmarks"}),La.map(U=>{const ye=j.benchmarks[U.key];if(!ye)return null;const Ve=P?.benchmarks?.[U.key],Oe=Ul(U,ye),et=Ul(U,Ve),nt=sg(Oe,et);return r.jsxs("div",{className:"pb-timeline-row",children:[r.jsx("span",{className:"pb-timeline-label",children:U.name}),r.jsxs("div",{className:"pb-timeline-values",children:[r.jsx("span",{className:"pb-timeline-value",children:U.unit==="time"?fh(ye.time):D2(ye.weight,ye.reps)}),nt!==null&&r.jsxs("span",{className:`pb-timeline-change ${nt>=0?"positive":"negative"}`,children:[nt>=0?"+":"",nt.toFixed(1),"%"]})]})]},U.key)})]}),j.bodyMetrics&&Object.keys(j.bodyMetrics).length>0&&r.jsxs("div",{className:"pb-timeline-group",children:[r.jsx("h5",{children:"Body Measurements"}),Vo.map(U=>{const ye=j.bodyMetrics[U.key];if(ye==null)return null;const Ve=P?.bodyMetrics?.[U.key],Oe=Ve!=null?parseFloat((ye-Ve).toFixed(2)):null;return r.jsxs("div",{className:"pb-timeline-row",children:[r.jsx("span",{className:"pb-timeline-label",children:U.name}),r.jsxs("div",{className:"pb-timeline-values",children:[r.jsxs("span",{className:"pb-timeline-value",children:[ye," ",U.suffix]}),Oe!==null&&r.jsxs("span",{className:`pb-timeline-change ${Oe>0?"positive":Oe<0?"negative":"neutral"}`,children:[Oe>0?"+":"",Oe," ",U.suffix]})]})]},U.key)})]})]})]},j.id)})})]})})]})]}),W&&r.jsx("div",{className:"pb-celebration-overlay",onClick:()=>ue(null),children:r.jsxs("div",{className:"pb-celebration-card",children:[r.jsx("div",{className:"pb-celebration-icon",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),r.jsx("h3",{className:"pb-celebration-title",children:W.length===1?"Target Achieved!":`${W.length} Targets Achieved!`}),r.jsx("div",{className:"pb-celebration-badges",children:W.map((j,C)=>r.jsx("div",{className:"pb-celebration-badge",children:j.label},C))}),r.jsx("p",{className:"pb-celebration-sub",children:"Tap to dismiss"})]})}),Re&&r.jsxs("div",{className:`toast-notification ${Re.type}`,children:[r.jsx("span",{className:"toast-icon",children:Re.type==="success"?r.jsx("svg",{className:"success-check-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{className:"check-path",d:"M5 13 L9 17 L19 7"})}):r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})}),r.jsx("span",{className:"toast-message",children:Re.message}),r.jsx("button",{className:"toast-close",onClick:()=>Le(null),children:""})]}),_s&&r.jsxs("nav",{className:"block-bottom-nav",children:[r.jsxs("button",{className:"block-nav-tab",onClick:()=>Kt("/client"),children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}),r.jsx("polyline",{points:"9 22 9 12 15 12 15 22"})]}),r.jsx("span",{children:"Home"})]}),r.jsxs("button",{className:"block-nav-tab",onClick:()=>Kt("/client/forms"),children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),r.jsx("polyline",{points:"14 2 14 8 20 8"}),r.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),r.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"})]}),r.jsx("span",{children:"Forms"})]}),r.jsxs("button",{className:"block-nav-tab",onClick:()=>Kt("/client/tools"),children:[r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"})}),r.jsx("span",{children:"Tools"})]}),r.jsxs("button",{className:"block-nav-tab active",children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M12 20V10"}),r.jsx("path",{d:"M18 20V4"}),r.jsx("path",{d:"M6 20v-4"})]}),r.jsx("span",{children:"PBs"})]}),Mt?.circuitAccess&&r.jsxs("button",{className:"block-nav-tab",onClick:()=>Kt("/client/circuit"),children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("path",{d:"M12 6v6l4 2"})]}),r.jsx("span",{children:"Circuit"})]})]}),ds&&r.jsx(ha,{active:"progress"})]})})}const TP=v.lazy(()=>Nr(()=>import("./Dashboard-CynWfaRo.js"),__vite__mapDeps([0,1,2]))),EP=v.lazy(()=>Nr(()=>import("./AddClient-Duzc89tF.js"),__vite__mapDeps([3,4]))),SP=v.lazy(()=>Nr(()=>import("./ClientDashboard-B7Bs4uRW.js"),__vite__mapDeps([5,1]))),NP=v.lazy(()=>Nr(()=>import("./ClientForms-T3q7URiU.js"),__vite__mapDeps([6,7]))),CP=v.lazy(()=>Nr(()=>import("./ClientTools-aO1NLFV6.js"),__vite__mapDeps([8,9]))),RP=v.lazy(()=>Nr(()=>import("./MacroCalculator-CwmqqbUc.js"),__vite__mapDeps([10,9]))),AP=v.lazy(()=>Nr(()=>import("./ProteinSnacks-DQIF4oP_.js"),__vite__mapDeps([11,9]))),MP=v.lazy(()=>Nr(()=>import("./DailyMotivation-CTIDI4qE.js"),__vite__mapDeps([12,9]))),IP=v.lazy(()=>Nr(()=>import("./CircuitDashboard-oQvFUlAQ.js"),__vite__mapDeps([13,14]))),DP=v.lazy(()=>Nr(()=>import("./CircuitBooking-BJEsggik.js"),__vite__mapDeps([15,16,14]))),PP=v.lazy(()=>Nr(()=>import("./Leaderboard-Dccg1RGT.js"),__vite__mapDeps([17,18]))),LP=v.lazy(()=>Nr(()=>import("./UpgradePage-CLcaE5Q9.js"),__vite__mapDeps([19,20]))),OP=v.lazy(()=>Nr(()=>import("./SignUp-D3RXmLnQ.js"),[])),BP=v.lazy(()=>Nr(()=>import("./Onboarding-HsVeyEQm.js"),__vite__mapDeps([21,22])));function VP({children:n}){const{pathname:e}=Ca();return v.useEffect(()=>{"scrollRestoration"in window.history&&(window.history.scrollRestoration="manual")},[]),v.useEffect(()=>{window.scrollTo({top:0,left:0,behavior:"instant"})},[e]),n}function UP(){const n=lr();return v.useEffect(()=>{const e=sessionStorage.getItem("redirect");if(e){sessionStorage.removeItem("redirect");const t=e.replace("/login","")||"/";n(t,{replace:!0})}},[n]),null}function FP(){return r.jsx(Y3,{children:r.jsx(K3,{children:r.jsx(eD,{children:r.jsxs(nS,{basename:"/login",children:[r.jsx(UP,{}),r.jsx(VP,{children:r.jsx(v.Suspense,{fallback:null,children:r.jsxs(ME,{children:[r.jsx(nn,{path:"/",element:r.jsx(nD,{})}),r.jsx(nn,{path:"/dashboard",element:r.jsx(TP,{})}),r.jsx(nn,{path:"/add-client",element:r.jsx(EP,{})}),r.jsx(nn,{path:"/client",element:r.jsx(SP,{})}),r.jsx(nn,{path:"/client/forms",element:r.jsx(NP,{})}),r.jsx(nn,{path:"/client/tools",element:r.jsx(CP,{})}),r.jsx(nn,{path:"/client/tools/macros",element:r.jsx(RP,{})}),r.jsx(nn,{path:"/client/tools/snacks",element:r.jsx(AP,{})}),r.jsx(nn,{path:"/client/tools/motivation",element:r.jsx(MP,{})}),r.jsx(nn,{path:"/client/personal-bests",element:r.jsx(jP,{})}),r.jsx(nn,{path:"/client/circuit",element:r.jsx(IP,{})}),r.jsx(nn,{path:"/client/circuit/booking",element:r.jsx(DP,{})}),r.jsx(nn,{path:"/client/core-buddy",element:r.jsx(ED,{})}),r.jsx(nn,{path:"/client/core-buddy/nutrition",element:r.jsx(Pl,{feature:"nutrition",children:r.jsx(CD,{})})}),r.jsx(nn,{path:"/client/core-buddy/workouts",element:r.jsx(HD,{})}),r.jsx(nn,{path:"/client/core-buddy/programmes",element:r.jsx(Pl,{feature:"programmes",children:r.jsx(YD,{})})}),r.jsx(nn,{path:"/client/core-buddy/achievements",element:r.jsx(Pl,{feature:"achievements",children:r.jsx(tP,{})})}),r.jsx(nn,{path:"/client/core-buddy/consistency",element:r.jsx(Pl,{feature:"consistency",children:r.jsx(lP,{})})}),r.jsx(nn,{path:"/client/core-buddy/buddies",element:r.jsx(Pl,{feature:"buddies",children:r.jsx(cP,{})})}),r.jsx(nn,{path:"/client/core-buddy/buddy",element:r.jsx(fP,{})}),r.jsx(nn,{path:"/client/core-buddy/profile/:userId",element:r.jsx(mP,{})}),r.jsx(nn,{path:"/client/leaderboard",element:r.jsx(Pl,{feature:"leaderboard",children:r.jsx(PP,{})})}),r.jsx(nn,{path:"/signup",element:r.jsx(OP,{})}),r.jsx(nn,{path:"/onboarding",element:r.jsx(BP,{})}),r.jsx(nn,{path:"/upgrade",element:r.jsx(LP,{})}),r.jsx(nn,{path:"*",element:r.jsx(K2,{to:"/",replace:!0})})]})})})]})})})})}MT.createRoot(document.getElementById("root")).render(r.jsx(v.StrictMode,{children:r.jsx(FP,{})}));"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/login/sw.js").catch(()=>{})});export{yr as A,ha as C,Sa as P,kt as T,ua as a,jr as b,Ft as c,me as d,$e as e,YC as f,Ss as g,e4 as h,Ns as i,r as j,As as k,Vr as l,Ra as m,lr as n,Kh as o,eb as p,Ps as q,v as r,HP as s,Gu as t,Ba as u,sD as v,ps as w,tD as x,zP as y,lS as z};
