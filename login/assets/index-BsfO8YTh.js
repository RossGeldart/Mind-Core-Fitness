const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Dashboard-CFcXPmHh.js","assets/scheduleUtils-a2tn0x12.js","assets/Dashboard-BvdLF0uv.css","assets/AddClient-BOj1YMZn.js","assets/AddClient-DH1OFzHo.css","assets/ClientDashboard-Bif9jTRK.js","assets/ClientDashboard-BI8UXFpK.css","assets/ClientForms-U7ApZT1U.js","assets/ClientForms-GDNtnrAx.css","assets/ClientTools-PXGF2zki.js","assets/ClientTools-DQRPoST3.css","assets/MacroCalculator-D94AKXAX.js","assets/ProteinSnacks-wQ8Aar5y.js","assets/DailyMotivation-CyAgXyBL.js","assets/CircuitDashboard-BSkwLmLb.js","assets/CircuitDashboard-C8T0uect.css","assets/CircuitBooking-BkkN7TXm.js","assets/CircuitBooking-ruk9Q4Wj.css","assets/PersonalBests-CUTeVzk4.js","assets/PersonalBests-BkG3fixu.css","assets/Leaderboard-BvMypeOp.js","assets/Leaderboard-Dq-r5svP.css","assets/UpgradePage-BYzWQtD2.js","assets/stripe-Da7IPrZW.js","assets/UpgradePage-Chom0F_j.css","assets/Onboarding-BonzD85R.js","assets/Onboarding-DvZF-mkH.css"])))=>i.map(i=>d[i]);
(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))i(l);new MutationObserver(l=>{for(const u of l)if(u.type==="childList")for(const d of u.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&i(d)}).observe(document,{childList:!0,subtree:!0});function t(l){const u={};return l.integrity&&(u.integrity=l.integrity),l.referrerPolicy&&(u.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?u.credentials="include":l.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function i(l){if(l.ep)return;l.ep=!0;const u=t(l);fetch(l.href,u)}})();var Tp={exports:{}},Hc={};var Fb;function jj(){if(Fb)return Hc;Fb=1;var s=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(i,l,u){var d=null;if(u!==void 0&&(d=""+u),l.key!==void 0&&(d=""+l.key),"key"in l){u={};for(var p in l)p!=="key"&&(u[p]=l[p])}else u=l;return l=u.ref,{$$typeof:s,type:i,key:d,ref:l!==void 0?l:null,props:u}}return Hc.Fragment=e,Hc.jsx=t,Hc.jsxs=t,Hc}var qb;function Sj(){return qb||(qb=1,Tp.exports=jj()),Tp.exports}var a=Sj(),jp={exports:{}},kt={};var Hb;function Cj(){if(Hb)return kt;Hb=1;var s=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),l=Symbol.for("react.profiler"),u=Symbol.for("react.consumer"),d=Symbol.for("react.context"),p=Symbol.for("react.forward_ref"),g=Symbol.for("react.suspense"),y=Symbol.for("react.memo"),b=Symbol.for("react.lazy"),E=Symbol.for("react.activity"),T=Symbol.iterator;function L(P){return P===null||typeof P!="object"?null:(P=T&&P[T]||P["@@iterator"],typeof P=="function"?P:null)}var W={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},H=Object.assign,B={};function K(P,re,we){this.props=P,this.context=re,this.refs=B,this.updater=we||W}K.prototype.isReactComponent={},K.prototype.setState=function(P,re){if(typeof P!="object"&&typeof P!="function"&&P!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,P,re,"setState")},K.prototype.forceUpdate=function(P){this.updater.enqueueForceUpdate(this,P,"forceUpdate")};function G(){}G.prototype=K.prototype;function Q(P,re,we){this.props=P,this.context=re,this.refs=B,this.updater=we||W}var he=Q.prototype=new G;he.constructor=Q,H(he,K.prototype),he.isPureReactComponent=!0;var Ee=Array.isArray;function ge(){}var C={H:null,A:null,T:null,S:null},j=Object.prototype.hasOwnProperty;function R(P,re,we){var _e=we.ref;return{$$typeof:s,type:P,key:re,ref:_e!==void 0?_e:null,props:we}}function V(P,re){return R(P.type,re,P.props)}function O(P){return typeof P=="object"&&P!==null&&P.$$typeof===s}function D(P){var re={"=":"=0",":":"=2"};return"$"+P.replace(/[=:]/g,function(we){return re[we]})}var A=/\/+/g;function Le(P,re){return typeof P=="object"&&P!==null&&P.key!=null?D(""+P.key):re.toString(36)}function Je(P){switch(P.status){case"fulfilled":return P.value;case"rejected":throw P.reason;default:switch(typeof P.status=="string"?P.then(ge,ge):(P.status="pending",P.then(function(re){P.status==="pending"&&(P.status="fulfilled",P.value=re)},function(re){P.status==="pending"&&(P.status="rejected",P.reason=re)})),P.status){case"fulfilled":return P.value;case"rejected":throw P.reason}}throw P}function X(P,re,we,_e,xe){var Se=typeof P;(Se==="undefined"||Se==="boolean")&&(P=null);var Fe=!1;if(P===null)Fe=!0;else switch(Se){case"bigint":case"string":case"number":Fe=!0;break;case"object":switch(P.$$typeof){case s:case e:Fe=!0;break;case b:return Fe=P._init,X(Fe(P._payload),re,we,_e,xe)}}if(Fe)return xe=xe(P),Fe=_e===""?"."+Le(P,0):_e,Ee(xe)?(we="",Fe!=null&&(we=Fe.replace(A,"$&/")+"/"),X(xe,re,we,"",function(Mt){return Mt})):xe!=null&&(O(xe)&&(xe=V(xe,we+(xe.key==null||P&&P.key===xe.key?"":(""+xe.key).replace(A,"$&/")+"/")+Fe)),re.push(xe)),1;Fe=0;var Ze=_e===""?".":_e+":";if(Ee(P))for(var Oe=0;Oe<P.length;Oe++)_e=P[Oe],Se=Ze+Le(_e,Oe),Fe+=X(_e,re,we,Se,xe);else if(Oe=L(P),typeof Oe=="function")for(P=Oe.call(P),Oe=0;!(_e=P.next()).done;)_e=_e.value,Se=Ze+Le(_e,Oe++),Fe+=X(_e,re,we,Se,xe);else if(Se==="object"){if(typeof P.then=="function")return X(Je(P),re,we,_e,xe);throw re=String(P),Error("Objects are not valid as a React child (found: "+(re==="[object Object]"?"object with keys {"+Object.keys(P).join(", ")+"}":re)+"). If you meant to render a collection of children, use an array instead.")}return Fe}function je(P,re,we){if(P==null)return P;var _e=[],xe=0;return X(P,_e,"","",function(Se){return re.call(we,Se,xe++)}),_e}function De(P){if(P._status===-1){var re=P._result;re=re(),re.then(function(we){(P._status===0||P._status===-1)&&(P._status=1,P._result=we)},function(we){(P._status===0||P._status===-1)&&(P._status=2,P._result=we)}),P._status===-1&&(P._status=0,P._result=re)}if(P._status===1)return P._result.default;throw P._result}var Ce=typeof reportError=="function"?reportError:function(P){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var re=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof P=="object"&&P!==null&&typeof P.message=="string"?String(P.message):String(P),error:P});if(!window.dispatchEvent(re))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",P);return}console.error(P)},J={map:je,forEach:function(P,re,we){je(P,function(){re.apply(this,arguments)},we)},count:function(P){var re=0;return je(P,function(){re++}),re},toArray:function(P){return je(P,function(re){return re})||[]},only:function(P){if(!O(P))throw Error("React.Children.only expected to receive a single React element child.");return P}};return kt.Activity=E,kt.Children=J,kt.Component=K,kt.Fragment=t,kt.Profiler=l,kt.PureComponent=Q,kt.StrictMode=i,kt.Suspense=g,kt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=C,kt.__COMPILER_RUNTIME={__proto__:null,c:function(P){return C.H.useMemoCache(P)}},kt.cache=function(P){return function(){return P.apply(null,arguments)}},kt.cacheSignal=function(){return null},kt.cloneElement=function(P,re,we){if(P==null)throw Error("The argument must be a React element, but you passed "+P+".");var _e=H({},P.props),xe=P.key;if(re!=null)for(Se in re.key!==void 0&&(xe=""+re.key),re)!j.call(re,Se)||Se==="key"||Se==="__self"||Se==="__source"||Se==="ref"&&re.ref===void 0||(_e[Se]=re[Se]);var Se=arguments.length-2;if(Se===1)_e.children=we;else if(1<Se){for(var Fe=Array(Se),Ze=0;Ze<Se;Ze++)Fe[Ze]=arguments[Ze+2];_e.children=Fe}return R(P.type,xe,_e)},kt.createContext=function(P){return P={$$typeof:d,_currentValue:P,_currentValue2:P,_threadCount:0,Provider:null,Consumer:null},P.Provider=P,P.Consumer={$$typeof:u,_context:P},P},kt.createElement=function(P,re,we){var _e,xe={},Se=null;if(re!=null)for(_e in re.key!==void 0&&(Se=""+re.key),re)j.call(re,_e)&&_e!=="key"&&_e!=="__self"&&_e!=="__source"&&(xe[_e]=re[_e]);var Fe=arguments.length-2;if(Fe===1)xe.children=we;else if(1<Fe){for(var Ze=Array(Fe),Oe=0;Oe<Fe;Oe++)Ze[Oe]=arguments[Oe+2];xe.children=Ze}if(P&&P.defaultProps)for(_e in Fe=P.defaultProps,Fe)xe[_e]===void 0&&(xe[_e]=Fe[_e]);return R(P,Se,xe)},kt.createRef=function(){return{current:null}},kt.forwardRef=function(P){return{$$typeof:p,render:P}},kt.isValidElement=O,kt.lazy=function(P){return{$$typeof:b,_payload:{_status:-1,_result:P},_init:De}},kt.memo=function(P,re){return{$$typeof:y,type:P,compare:re===void 0?null:re}},kt.startTransition=function(P){var re=C.T,we={};C.T=we;try{var _e=P(),xe=C.S;xe!==null&&xe(we,_e),typeof _e=="object"&&_e!==null&&typeof _e.then=="function"&&_e.then(ge,Ce)}catch(Se){Ce(Se)}finally{re!==null&&we.types!==null&&(re.types=we.types),C.T=re}},kt.unstable_useCacheRefresh=function(){return C.H.useCacheRefresh()},kt.use=function(P){return C.H.use(P)},kt.useActionState=function(P,re,we){return C.H.useActionState(P,re,we)},kt.useCallback=function(P,re){return C.H.useCallback(P,re)},kt.useContext=function(P){return C.H.useContext(P)},kt.useDebugValue=function(){},kt.useDeferredValue=function(P,re){return C.H.useDeferredValue(P,re)},kt.useEffect=function(P,re){return C.H.useEffect(P,re)},kt.useEffectEvent=function(P){return C.H.useEffectEvent(P)},kt.useId=function(){return C.H.useId()},kt.useImperativeHandle=function(P,re,we){return C.H.useImperativeHandle(P,re,we)},kt.useInsertionEffect=function(P,re){return C.H.useInsertionEffect(P,re)},kt.useLayoutEffect=function(P,re){return C.H.useLayoutEffect(P,re)},kt.useMemo=function(P,re){return C.H.useMemo(P,re)},kt.useOptimistic=function(P,re){return C.H.useOptimistic(P,re)},kt.useReducer=function(P,re,we){return C.H.useReducer(P,re,we)},kt.useRef=function(P){return C.H.useRef(P)},kt.useState=function(P){return C.H.useState(P)},kt.useSyncExternalStore=function(P,re,we){return C.H.useSyncExternalStore(P,re,we)},kt.useTransition=function(){return C.H.useTransition()},kt.version="19.2.4",kt}var $b;function Qg(){return $b||($b=1,jp.exports=Cj()),jp.exports}var w=Qg(),Sp={exports:{}},$c={},Cp={exports:{}},Np={};var Wb;function Nj(){return Wb||(Wb=1,(function(s){function e(X,je){var De=X.length;X.push(je);e:for(;0<De;){var Ce=De-1>>>1,J=X[Ce];if(0<l(J,je))X[Ce]=je,X[De]=J,De=Ce;else break e}}function t(X){return X.length===0?null:X[0]}function i(X){if(X.length===0)return null;var je=X[0],De=X.pop();if(De!==je){X[0]=De;e:for(var Ce=0,J=X.length,P=J>>>1;Ce<P;){var re=2*(Ce+1)-1,we=X[re],_e=re+1,xe=X[_e];if(0>l(we,De))_e<J&&0>l(xe,we)?(X[Ce]=xe,X[_e]=De,Ce=_e):(X[Ce]=we,X[re]=De,Ce=re);else if(_e<J&&0>l(xe,De))X[Ce]=xe,X[_e]=De,Ce=_e;else break e}}return je}function l(X,je){var De=X.sortIndex-je.sortIndex;return De!==0?De:X.id-je.id}if(s.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var u=performance;s.unstable_now=function(){return u.now()}}else{var d=Date,p=d.now();s.unstable_now=function(){return d.now()-p}}var g=[],y=[],b=1,E=null,T=3,L=!1,W=!1,H=!1,B=!1,K=typeof setTimeout=="function"?setTimeout:null,G=typeof clearTimeout=="function"?clearTimeout:null,Q=typeof setImmediate<"u"?setImmediate:null;function he(X){for(var je=t(y);je!==null;){if(je.callback===null)i(y);else if(je.startTime<=X)i(y),je.sortIndex=je.expirationTime,e(g,je);else break;je=t(y)}}function Ee(X){if(H=!1,he(X),!W)if(t(g)!==null)W=!0,ge||(ge=!0,D());else{var je=t(y);je!==null&&Je(Ee,je.startTime-X)}}var ge=!1,C=-1,j=5,R=-1;function V(){return B?!0:!(s.unstable_now()-R<j)}function O(){if(B=!1,ge){var X=s.unstable_now();R=X;var je=!0;try{e:{W=!1,H&&(H=!1,G(C),C=-1),L=!0;var De=T;try{t:{for(he(X),E=t(g);E!==null&&!(E.expirationTime>X&&V());){var Ce=E.callback;if(typeof Ce=="function"){E.callback=null,T=E.priorityLevel;var J=Ce(E.expirationTime<=X);if(X=s.unstable_now(),typeof J=="function"){E.callback=J,he(X),je=!0;break t}E===t(g)&&i(g),he(X)}else i(g);E=t(g)}if(E!==null)je=!0;else{var P=t(y);P!==null&&Je(Ee,P.startTime-X),je=!1}}break e}finally{E=null,T=De,L=!1}je=void 0}}finally{je?D():ge=!1}}}var D;if(typeof Q=="function")D=function(){Q(O)};else if(typeof MessageChannel<"u"){var A=new MessageChannel,Le=A.port2;A.port1.onmessage=O,D=function(){Le.postMessage(null)}}else D=function(){K(O,0)};function Je(X,je){C=K(function(){X(s.unstable_now())},je)}s.unstable_IdlePriority=5,s.unstable_ImmediatePriority=1,s.unstable_LowPriority=4,s.unstable_NormalPriority=3,s.unstable_Profiling=null,s.unstable_UserBlockingPriority=2,s.unstable_cancelCallback=function(X){X.callback=null},s.unstable_forceFrameRate=function(X){0>X||125<X?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):j=0<X?Math.floor(1e3/X):5},s.unstable_getCurrentPriorityLevel=function(){return T},s.unstable_next=function(X){switch(T){case 1:case 2:case 3:var je=3;break;default:je=T}var De=T;T=je;try{return X()}finally{T=De}},s.unstable_requestPaint=function(){B=!0},s.unstable_runWithPriority=function(X,je){switch(X){case 1:case 2:case 3:case 4:case 5:break;default:X=3}var De=T;T=X;try{return je()}finally{T=De}},s.unstable_scheduleCallback=function(X,je,De){var Ce=s.unstable_now();switch(typeof De=="object"&&De!==null?(De=De.delay,De=typeof De=="number"&&0<De?Ce+De:Ce):De=Ce,X){case 1:var J=-1;break;case 2:J=250;break;case 5:J=1073741823;break;case 4:J=1e4;break;default:J=5e3}return J=De+J,X={id:b++,callback:je,priorityLevel:X,startTime:De,expirationTime:J,sortIndex:-1},De>Ce?(X.sortIndex=De,e(y,X),t(g)===null&&X===t(y)&&(H?(G(C),C=-1):H=!0,Je(Ee,De-Ce))):(X.sortIndex=J,e(g,X),W||L||(W=!0,ge||(ge=!0,D()))),X},s.unstable_shouldYield=V,s.unstable_wrapCallback=function(X){var je=T;return function(){var De=T;T=je;try{return X.apply(this,arguments)}finally{T=De}}}})(Np)),Np}var Gb;function Aj(){return Gb||(Gb=1,Cp.exports=Nj()),Cp.exports}var Ap={exports:{}},qs={};var Kb;function Rj(){if(Kb)return qs;Kb=1;var s=Qg();function e(g){var y="https://react.dev/errors/"+g;if(1<arguments.length){y+="?args[]="+encodeURIComponent(arguments[1]);for(var b=2;b<arguments.length;b++)y+="&args[]="+encodeURIComponent(arguments[b])}return"Minified React error #"+g+"; visit "+y+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var i={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},l=Symbol.for("react.portal");function u(g,y,b){var E=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:l,key:E==null?null:""+E,children:g,containerInfo:y,implementation:b}}var d=s.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function p(g,y){if(g==="font")return"";if(typeof y=="string")return y==="use-credentials"?y:""}return qs.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,qs.createPortal=function(g,y){var b=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!y||y.nodeType!==1&&y.nodeType!==9&&y.nodeType!==11)throw Error(e(299));return u(g,y,null,b)},qs.flushSync=function(g){var y=d.T,b=i.p;try{if(d.T=null,i.p=2,g)return g()}finally{d.T=y,i.p=b,i.d.f()}},qs.preconnect=function(g,y){typeof g=="string"&&(y?(y=y.crossOrigin,y=typeof y=="string"?y==="use-credentials"?y:"":void 0):y=null,i.d.C(g,y))},qs.prefetchDNS=function(g){typeof g=="string"&&i.d.D(g)},qs.preinit=function(g,y){if(typeof g=="string"&&y&&typeof y.as=="string"){var b=y.as,E=p(b,y.crossOrigin),T=typeof y.integrity=="string"?y.integrity:void 0,L=typeof y.fetchPriority=="string"?y.fetchPriority:void 0;b==="style"?i.d.S(g,typeof y.precedence=="string"?y.precedence:void 0,{crossOrigin:E,integrity:T,fetchPriority:L}):b==="script"&&i.d.X(g,{crossOrigin:E,integrity:T,fetchPriority:L,nonce:typeof y.nonce=="string"?y.nonce:void 0})}},qs.preinitModule=function(g,y){if(typeof g=="string")if(typeof y=="object"&&y!==null){if(y.as==null||y.as==="script"){var b=p(y.as,y.crossOrigin);i.d.M(g,{crossOrigin:b,integrity:typeof y.integrity=="string"?y.integrity:void 0,nonce:typeof y.nonce=="string"?y.nonce:void 0})}}else y==null&&i.d.M(g)},qs.preload=function(g,y){if(typeof g=="string"&&typeof y=="object"&&y!==null&&typeof y.as=="string"){var b=y.as,E=p(b,y.crossOrigin);i.d.L(g,b,{crossOrigin:E,integrity:typeof y.integrity=="string"?y.integrity:void 0,nonce:typeof y.nonce=="string"?y.nonce:void 0,type:typeof y.type=="string"?y.type:void 0,fetchPriority:typeof y.fetchPriority=="string"?y.fetchPriority:void 0,referrerPolicy:typeof y.referrerPolicy=="string"?y.referrerPolicy:void 0,imageSrcSet:typeof y.imageSrcSet=="string"?y.imageSrcSet:void 0,imageSizes:typeof y.imageSizes=="string"?y.imageSizes:void 0,media:typeof y.media=="string"?y.media:void 0})}},qs.preloadModule=function(g,y){if(typeof g=="string")if(y){var b=p(y.as,y.crossOrigin);i.d.m(g,{as:typeof y.as=="string"&&y.as!=="script"?y.as:void 0,crossOrigin:b,integrity:typeof y.integrity=="string"?y.integrity:void 0})}else i.d.m(g)},qs.requestFormReset=function(g){i.d.r(g)},qs.unstable_batchedUpdates=function(g,y){return g(y)},qs.useFormState=function(g,y,b){return d.H.useFormState(g,y,b)},qs.useFormStatus=function(){return d.H.useHostTransitionStatus()},qs.version="19.2.4",qs}var Yb;function Ij(){if(Yb)return Ap.exports;Yb=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(e){console.error(e)}}return s(),Ap.exports=Rj(),Ap.exports}var Qb;function Mj(){if(Qb)return $c;Qb=1;var s=Aj(),e=Qg(),t=Ij();function i(n){var r="https://react.dev/errors/"+n;if(1<arguments.length){r+="?args[]="+encodeURIComponent(arguments[1]);for(var o=2;o<arguments.length;o++)r+="&args[]="+encodeURIComponent(arguments[o])}return"Minified React error #"+n+"; visit "+r+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function l(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function u(n){var r=n,o=n;if(n.alternate)for(;r.return;)r=r.return;else{n=r;do r=n,(r.flags&4098)!==0&&(o=r.return),n=r.return;while(n)}return r.tag===3?o:null}function d(n){if(n.tag===13){var r=n.memoizedState;if(r===null&&(n=n.alternate,n!==null&&(r=n.memoizedState)),r!==null)return r.dehydrated}return null}function p(n){if(n.tag===31){var r=n.memoizedState;if(r===null&&(n=n.alternate,n!==null&&(r=n.memoizedState)),r!==null)return r.dehydrated}return null}function g(n){if(u(n)!==n)throw Error(i(188))}function y(n){var r=n.alternate;if(!r){if(r=u(n),r===null)throw Error(i(188));return r!==n?null:n}for(var o=n,c=r;;){var f=o.return;if(f===null)break;var m=f.alternate;if(m===null){if(c=f.return,c!==null){o=c;continue}break}if(f.child===m.child){for(m=f.child;m;){if(m===o)return g(f),n;if(m===c)return g(f),r;m=m.sibling}throw Error(i(188))}if(o.return!==c.return)o=f,c=m;else{for(var x=!1,S=f.child;S;){if(S===o){x=!0,o=f,c=m;break}if(S===c){x=!0,c=f,o=m;break}S=S.sibling}if(!x){for(S=m.child;S;){if(S===o){x=!0,o=m,c=f;break}if(S===c){x=!0,c=m,o=f;break}S=S.sibling}if(!x)throw Error(i(189))}}if(o.alternate!==c)throw Error(i(190))}if(o.tag!==3)throw Error(i(188));return o.stateNode.current===o?n:r}function b(n){var r=n.tag;if(r===5||r===26||r===27||r===6)return n;for(n=n.child;n!==null;){if(r=b(n),r!==null)return r;n=n.sibling}return null}var E=Object.assign,T=Symbol.for("react.element"),L=Symbol.for("react.transitional.element"),W=Symbol.for("react.portal"),H=Symbol.for("react.fragment"),B=Symbol.for("react.strict_mode"),K=Symbol.for("react.profiler"),G=Symbol.for("react.consumer"),Q=Symbol.for("react.context"),he=Symbol.for("react.forward_ref"),Ee=Symbol.for("react.suspense"),ge=Symbol.for("react.suspense_list"),C=Symbol.for("react.memo"),j=Symbol.for("react.lazy"),R=Symbol.for("react.activity"),V=Symbol.for("react.memo_cache_sentinel"),O=Symbol.iterator;function D(n){return n===null||typeof n!="object"?null:(n=O&&n[O]||n["@@iterator"],typeof n=="function"?n:null)}var A=Symbol.for("react.client.reference");function Le(n){if(n==null)return null;if(typeof n=="function")return n.$$typeof===A?null:n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case H:return"Fragment";case K:return"Profiler";case B:return"StrictMode";case Ee:return"Suspense";case ge:return"SuspenseList";case R:return"Activity"}if(typeof n=="object")switch(n.$$typeof){case W:return"Portal";case Q:return n.displayName||"Context";case G:return(n._context.displayName||"Context")+".Consumer";case he:var r=n.render;return n=n.displayName,n||(n=r.displayName||r.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case C:return r=n.displayName||null,r!==null?r:Le(n.type)||"Memo";case j:r=n._payload,n=n._init;try{return Le(n(r))}catch{}}return null}var Je=Array.isArray,X=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,je=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,De={pending:!1,data:null,method:null,action:null},Ce=[],J=-1;function P(n){return{current:n}}function re(n){0>J||(n.current=Ce[J],Ce[J]=null,J--)}function we(n,r){J++,Ce[J]=n.current,n.current=r}var _e=P(null),xe=P(null),Se=P(null),Fe=P(null);function Ze(n,r){switch(we(Se,r),we(xe,n),we(_e,null),r.nodeType){case 9:case 11:n=(n=r.documentElement)&&(n=n.namespaceURI)?db(n):0;break;default:if(n=r.tagName,r=r.namespaceURI)r=db(r),n=hb(r,n);else switch(n){case"svg":n=1;break;case"math":n=2;break;default:n=0}}re(_e),we(_e,n)}function Oe(){re(_e),re(xe),re(Se)}function Mt(n){n.memoizedState!==null&&we(Fe,n);var r=_e.current,o=hb(r,n.type);r!==o&&(we(xe,n),we(_e,o))}function cn(n){xe.current===n&&(re(_e),re(xe)),Fe.current===n&&(re(Fe),Bc._currentValue=De)}var qn,Qt;function rt(n){if(qn===void 0)try{throw Error()}catch(o){var r=o.stack.trim().match(/\n( *(at )?)/);qn=r&&r[1]||"",Qt=-1<o.stack.indexOf(`
    at`)?" (<anonymous>)":-1<o.stack.indexOf("@")?"@unknown:0:0":""}return`
`+qn+n+Qt}var st=!1;function ct(n,r){if(!n||st)return"";st=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var c={DetermineComponentFrameRoot:function(){try{if(r){var ke=function(){throw Error()};if(Object.defineProperty(ke.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ke,[])}catch(de){var ae=de}Reflect.construct(n,[],ke)}else{try{ke.call()}catch(de){ae=de}n.call(ke.prototype)}}else{try{throw Error()}catch(de){ae=de}(ke=n())&&typeof ke.catch=="function"&&ke.catch(function(){})}}catch(de){if(de&&ae&&typeof de.stack=="string")return[de.stack,ae.stack]}return[null,null]}};c.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var f=Object.getOwnPropertyDescriptor(c.DetermineComponentFrameRoot,"name");f&&f.configurable&&Object.defineProperty(c.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var m=c.DetermineComponentFrameRoot(),x=m[0],S=m[1];if(x&&S){var U=x.split(`
`),ne=S.split(`
`);for(f=c=0;c<U.length&&!U[c].includes("DetermineComponentFrameRoot");)c++;for(;f<ne.length&&!ne[f].includes("DetermineComponentFrameRoot");)f++;if(c===U.length||f===ne.length)for(c=U.length-1,f=ne.length-1;1<=c&&0<=f&&U[c]!==ne[f];)f--;for(;1<=c&&0<=f;c--,f--)if(U[c]!==ne[f]){if(c!==1||f!==1)do if(c--,f--,0>f||U[c]!==ne[f]){var pe=`
`+U[c].replace(" at new "," at ");return n.displayName&&pe.includes("<anonymous>")&&(pe=pe.replace("<anonymous>",n.displayName)),pe}while(1<=c&&0<=f);break}}}finally{st=!1,Error.prepareStackTrace=o}return(o=n?n.displayName||n.name:"")?rt(o):""}function En(n,r){switch(n.tag){case 26:case 27:case 5:return rt(n.type);case 16:return rt("Lazy");case 13:return n.child!==r&&r!==null?rt("Suspense Fallback"):rt("Suspense");case 19:return rt("SuspenseList");case 0:case 15:return ct(n.type,!1);case 11:return ct(n.type.render,!1);case 1:return ct(n.type,!0);case 31:return rt("Activity");default:return""}}function fe(n){try{var r="",o=null;do r+=En(n,o),o=n,n=n.return;while(n);return r}catch(c){return`
Error generating stack: `+c.message+`
`+c.stack}}var Ct=Object.prototype.hasOwnProperty,ft=s.unstable_scheduleCallback,Rt=s.unstable_cancelCallback,Qe=s.unstable_shouldYield,Tt=s.unstable_requestPaint,pt=s.unstable_now,Xt=s.unstable_getCurrentPriorityLevel,zs=s.unstable_ImmediatePriority,es=s.unstable_UserBlockingPriority,Wt=s.unstable_NormalPriority,se=s.unstable_LowPriority,Ae=s.unstable_IdlePriority,gt=s.log,vt=s.unstable_setDisableYieldValue,ut=null,He=null;function nt(n){if(typeof gt=="function"&&vt(n),He&&typeof He.setStrictMode=="function")try{He.setStrictMode(ut,n)}catch{}}var $e=Math.clz32?Math.clz32:Rn,rn=Math.log,Jt=Math.LN2;function Rn(n){return n>>>=0,n===0?32:31-(rn(n)/Jt|0)|0}var On=256,Kn=262144,Zt=4194304;function Hn(n){var r=n&42;if(r!==0)return r;switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return n&261888;case 262144:case 524288:case 1048576:case 2097152:return n&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return n&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return n}}function Cn(n,r,o){var c=n.pendingLanes;if(c===0)return 0;var f=0,m=n.suspendedLanes,x=n.pingedLanes;n=n.warmLanes;var S=c&134217727;return S!==0?(c=S&~m,c!==0?f=Hn(c):(x&=S,x!==0?f=Hn(x):o||(o=S&~n,o!==0&&(f=Hn(o))))):(S=c&~m,S!==0?f=Hn(S):x!==0?f=Hn(x):o||(o=c&~n,o!==0&&(f=Hn(o)))),f===0?0:r!==0&&r!==f&&(r&m)===0&&(m=f&-f,o=r&-r,m>=o||m===32&&(o&4194048)!==0)?r:f}function yn(n,r){return(n.pendingLanes&~(n.suspendedLanes&~n.pingedLanes)&r)===0}function Ss(n,r){switch(n){case 1:case 2:case 4:case 8:case 64:return r+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function le(){var n=Zt;return Zt<<=1,(Zt&62914560)===0&&(Zt=4194304),n}function Me(n){for(var r=[],o=0;31>o;o++)r.push(n);return r}function Ye(n,r){n.pendingLanes|=r,r!==268435456&&(n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0)}function yt(n,r,o,c,f,m){var x=n.pendingLanes;n.pendingLanes=o,n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0,n.expiredLanes&=o,n.entangledLanes&=o,n.errorRecoveryDisabledLanes&=o,n.shellSuspendCounter=0;var S=n.entanglements,U=n.expirationTimes,ne=n.hiddenUpdates;for(o=x&~o;0<o;){var pe=31-$e(o),ke=1<<pe;S[pe]=0,U[pe]=-1;var ae=ne[pe];if(ae!==null)for(ne[pe]=null,pe=0;pe<ae.length;pe++){var de=ae[pe];de!==null&&(de.lane&=-536870913)}o&=~ke}c!==0&&it(n,c,0),m!==0&&f===0&&n.tag!==0&&(n.suspendedLanes|=m&~(x&~r))}function it(n,r,o){n.pendingLanes|=r,n.suspendedLanes&=~r;var c=31-$e(r);n.entangledLanes|=r,n.entanglements[c]=n.entanglements[c]|1073741824|o&261930}function Gt(n,r){var o=n.entangledLanes|=r;for(n=n.entanglements;o;){var c=31-$e(o),f=1<<c;f&r|n[c]&r&&(n[c]|=r),o&=~f}}function vn(n,r){var o=r&-r;return o=(o&42)!==0?1:an(o),(o&(n.suspendedLanes|r))!==0?0:o}function an(n){switch(n){case 2:n=1;break;case 8:n=4;break;case 32:n=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:n=128;break;case 268435456:n=134217728;break;default:n=0}return n}function Kt(n){return n&=-n,2<n?8<n?(n&134217727)!==0?32:268435456:8:2}function vs(){var n=je.p;return n!==0?n:(n=window.event,n===void 0?32:Lb(n.type))}function Nn(n,r){var o=je.p;try{return je.p=n,r()}finally{je.p=o}}var bs=Math.random().toString(36).slice(2),en="__reactFiber$"+bs,un="__reactProps$"+bs,cs="__reactContainer$"+bs,Qr="__reactEvents$"+bs,fa="__reactListeners$"+bs,Xr="__reactHandles$"+bs,gr="__reactResources$"+bs,$n="__reactMarker$"+bs;function Fs(n){delete n[en],delete n[un],delete n[Qr],delete n[fa],delete n[Xr]}function ws(n){var r=n[en];if(r)return r;for(var o=n.parentNode;o;){if(r=o[cs]||o[en]){if(o=r.alternate,r.child!==null||o!==null&&o.child!==null)for(n=bb(n);n!==null;){if(o=n[en])return o;n=bb(n)}return r}n=o,o=n.parentNode}return null}function Pn(n){if(n=n[en]||n[cs]){var r=n.tag;if(r===5||r===6||r===13||r===31||r===26||r===27||r===3)return n}return null}function In(n){var r=n.tag;if(r===5||r===26||r===27||r===6)return n.stateNode;throw Error(i(33))}function ts(n){var r=n[gr];return r||(r=n[gr]={hoistableStyles:new Map,hoistableScripts:new Map}),r}function Ft(n){n[$n]=!0}var yr=new Set,Rr={};function xs(n,r){Tn(n,r),Tn(n+"Capture",r)}function Tn(n,r){for(Rr[n]=r,n=0;n<r.length;n++)yr.add(r[n])}var Qs=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Jr={},I={};function z(n){return Ct.call(I,n)?!0:Ct.call(Jr,n)?!1:Qs.test(n)?I[n]=!0:(Jr[n]=!0,!1)}function ie(n,r,o){if(z(r))if(o===null)n.removeAttribute(r);else{switch(typeof o){case"undefined":case"function":case"symbol":n.removeAttribute(r);return;case"boolean":var c=r.toLowerCase().slice(0,5);if(c!=="data-"&&c!=="aria-"){n.removeAttribute(r);return}}n.setAttribute(r,""+o)}}function ce(n,r,o){if(o===null)n.removeAttribute(r);else{switch(typeof o){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(r);return}n.setAttribute(r,""+o)}}function Pe(n,r,o,c){if(c===null)n.removeAttribute(o);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(o);return}n.setAttributeNS(r,o,""+c)}}function Ue(n){switch(typeof n){case"bigint":case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function qe(n){var r=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(r==="checkbox"||r==="radio")}function Ot(n,r,o){var c=Object.getOwnPropertyDescriptor(n.constructor.prototype,r);if(!n.hasOwnProperty(r)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var f=c.get,m=c.set;return Object.defineProperty(n,r,{configurable:!0,get:function(){return f.call(this)},set:function(x){o=""+x,m.call(this,x)}}),Object.defineProperty(n,r,{enumerable:c.enumerable}),{getValue:function(){return o},setValue:function(x){o=""+x},stopTracking:function(){n._valueTracker=null,delete n[r]}}}}function Ge(n){if(!n._valueTracker){var r=qe(n)?"checked":"value";n._valueTracker=Ot(n,r,""+n[r])}}function Mn(n){if(!n)return!1;var r=n._valueTracker;if(!r)return!0;var o=r.getValue(),c="";return n&&(c=qe(n)?n.checked?"true":"false":n.value),n=c,n!==o?(r.setValue(n),!0):!1}function ns(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}var ar=/[\n"\\]/g;function Vn(n){return n.replace(ar,function(r){return"\\"+r.charCodeAt(0).toString(16)+" "})}function Xs(n,r,o,c,f,m,x,S){n.name="",x!=null&&typeof x!="function"&&typeof x!="symbol"&&typeof x!="boolean"?n.type=x:n.removeAttribute("type"),r!=null?x==="number"?(r===0&&n.value===""||n.value!=r)&&(n.value=""+Ue(r)):n.value!==""+Ue(r)&&(n.value=""+Ue(r)):x!=="submit"&&x!=="reset"||n.removeAttribute("value"),r!=null?Is(n,x,Ue(r)):o!=null?Is(n,x,Ue(o)):c!=null&&n.removeAttribute("value"),f==null&&m!=null&&(n.defaultChecked=!!m),f!=null&&(n.checked=f&&typeof f!="function"&&typeof f!="symbol"),S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"?n.name=""+Ue(S):n.removeAttribute("name")}function Di(n,r,o,c,f,m,x,S){if(m!=null&&typeof m!="function"&&typeof m!="symbol"&&typeof m!="boolean"&&(n.type=m),r!=null||o!=null){if(!(m!=="submit"&&m!=="reset"||r!=null)){Ge(n);return}o=o!=null?""+Ue(o):"",r=r!=null?""+Ue(r):o,S||r===n.value||(n.value=r),n.defaultValue=r}c=c??f,c=typeof c!="function"&&typeof c!="symbol"&&!!c,n.checked=S?n.checked:!!c,n.defaultChecked=!!c,x!=null&&typeof x!="function"&&typeof x!="symbol"&&typeof x!="boolean"&&(n.name=x),Ge(n)}function Is(n,r,o){r==="number"&&ns(n.ownerDocument)===n||n.defaultValue===""+o||(n.defaultValue=""+o)}function Js(n,r,o,c){if(n=n.options,r){r={};for(var f=0;f<o.length;f++)r["$"+o[f]]=!0;for(o=0;o<n.length;o++)f=r.hasOwnProperty("$"+n[o].value),n[o].selected!==f&&(n[o].selected=f),f&&c&&(n[o].defaultSelected=!0)}else{for(o=""+Ue(o),r=null,f=0;f<n.length;f++){if(n[f].value===o){n[f].selected=!0,c&&(n[f].defaultSelected=!0);return}r!==null||n[f].disabled||(r=n[f])}r!==null&&(r.selected=!0)}}function ma(n,r,o){if(r!=null&&(r=""+Ue(r),r!==n.value&&(n.value=r),o==null)){n.defaultValue!==r&&(n.defaultValue=r);return}n.defaultValue=o!=null?""+Ue(o):""}function vr(n,r,o,c){if(r==null){if(c!=null){if(o!=null)throw Error(i(92));if(Je(c)){if(1<c.length)throw Error(i(93));c=c[0]}o=c}o==null&&(o=""),r=o}o=Ue(r),n.defaultValue=o,c=n.textContent,c===o&&c!==""&&c!==null&&(n.value=c),Ge(n)}function Cs(n,r){if(r){var o=n.firstChild;if(o&&o===n.lastChild&&o.nodeType===3){o.nodeValue=r;return}}n.textContent=r}var pa=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Zr(n,r,o){var c=r.indexOf("--")===0;o==null||typeof o=="boolean"||o===""?c?n.setProperty(r,""):r==="float"?n.cssFloat="":n[r]="":c?n.setProperty(r,o):typeof o!="number"||o===0||pa.has(r)?r==="float"?n.cssFloat=o:n[r]=(""+o).trim():n[r]=o+"px"}function Ir(n,r,o){if(r!=null&&typeof r!="object")throw Error(i(62));if(n=n.style,o!=null){for(var c in o)!o.hasOwnProperty(c)||r!=null&&r.hasOwnProperty(c)||(c.indexOf("--")===0?n.setProperty(c,""):c==="float"?n.cssFloat="":n[c]="");for(var f in r)c=r[f],r.hasOwnProperty(f)&&o[f]!==c&&Zr(n,f,c)}else for(var m in r)r.hasOwnProperty(m)&&Zr(n,m,r[m])}function Ms(n){if(n.indexOf("-")===-1)return!1;switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var fi=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Mr=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function mi(n){return Mr.test(""+n)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":n}function ss(){}var F=null;function oe(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var k=null,M=null;function q(n){var r=Pn(n);if(r&&(n=r.stateNode)){var o=n[un]||null;e:switch(n=r.stateNode,r.type){case"input":if(Xs(n,o.value,o.defaultValue,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name),r=o.name,o.type==="radio"&&r!=null){for(o=n;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll('input[name="'+Vn(""+r)+'"][type="radio"]'),r=0;r<o.length;r++){var c=o[r];if(c!==n&&c.form===n.form){var f=c[un]||null;if(!f)throw Error(i(90));Xs(c,f.value,f.defaultValue,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name)}}for(r=0;r<o.length;r++)c=o[r],c.form===n.form&&Mn(c)}break e;case"textarea":ma(n,o.value,o.defaultValue);break e;case"select":r=o.value,r!=null&&Js(n,!!o.multiple,r,!1)}}}var te=!1;function me(n,r,o){if(te)return n(r,o);te=!0;try{var c=n(r);return c}finally{if(te=!1,(k!==null||M!==null)&&(Od(),k&&(r=k,n=M,M=k=null,q(r),n)))for(r=0;r<n.length;r++)q(n[r])}}function Ie(n,r){var o=n.stateNode;if(o===null)return null;var c=o[un]||null;if(c===null)return null;o=c[r];e:switch(r){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(c=!c.disabled)||(n=n.type,c=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!c;break e;default:n=!1}if(n)return null;if(o&&typeof o!="function")throw Error(i(231,r,typeof o));return o}var Ne=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Be=!1;if(Ne)try{var Re={};Object.defineProperty(Re,"passive",{get:function(){Be=!0}}),window.addEventListener("test",Re,Re),window.removeEventListener("test",Re,Re)}catch{Be=!1}var at=null,bn=null,et=null;function tn(){if(et)return et;var n,r=bn,o=r.length,c,f="value"in at?at.value:at.textContent,m=f.length;for(n=0;n<o&&r[n]===f[n];n++);var x=o-n;for(c=1;c<=x&&r[o-c]===f[m-c];c++);return et=f.slice(n,1<c?1-c:void 0)}function jn(n){var r=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&r===13&&(n=13)):n=r,n===10&&(n=13),32<=n||n===13?n:0}function dt(){return!0}function It(){return!1}function dn(n){function r(o,c,f,m,x){this._reactName=o,this._targetInst=f,this.type=c,this.nativeEvent=m,this.target=x,this.currentTarget=null;for(var S in n)n.hasOwnProperty(S)&&(o=n[S],this[S]=o?o(m):m[S]);return this.isDefaultPrevented=(m.defaultPrevented!=null?m.defaultPrevented:m.returnValue===!1)?dt:It,this.isPropagationStopped=It,this}return E(r.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=dt)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=dt)},persist:function(){},isPersistent:dt}),r}var _s={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Un=dn(_s),mn=E({},_s,{view:0,detail:0}),Wn=dn(mn),us,ei,Dr,pi=E({},mn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ga,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==Dr&&(Dr&&n.type==="mousemove"?(us=n.screenX-Dr.screenX,ei=n.screenY-Dr.screenY):ei=us=0,Dr=n),us)},movementY:function(n){return"movementY"in n?n.movementY:ei}}),ac=dn(pi),co=E({},pi,{dataTransfer:0}),Hu=dn(co),$u=E({},mn,{relatedTarget:0}),uo=dn($u),oc=E({},_s,{animationName:0,elapsedTime:0,pseudoElement:0}),Wu=dn(oc),Zo=E({},_s,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),Gu=dn(Zo),Ku=E({},_s,{data:0}),gi=dn(Ku),Yu={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Qu={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Xu={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ju(n){var r=this.nativeEvent;return r.getModifierState?r.getModifierState(n):(n=Xu[n])?!!r[n]:!1}function ga(){return Ju}var Zs=E({},mn,{key:function(n){if(n.key){var r=Yu[n.key]||n.key;if(r!=="Unidentified")return r}return n.type==="keypress"?(n=jn(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?Qu[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ga,charCode:function(n){return n.type==="keypress"?jn(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?jn(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),Zu=dn(Zs),ed=E({},pi,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Li=dn(ed),h=E({},mn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ga}),v=dn(h),_=E({},_s,{propertyName:0,elapsedTime:0,pseudoElement:0}),N=dn(_),Z=E({},pi,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),ue=dn(Z),Ve=E({},_s,{newState:0,oldState:0}),jt=dn(Ve),rs=[9,13,27,32],on=Ne&&"CompositionEvent"in window,Bn=null;Ne&&"documentMode"in document&&(Bn=document.documentMode);var Lr=Ne&&"TextEvent"in window&&!Bn,yi=Ne&&(!on||Bn&&8<Bn&&11>=Bn),ti=" ",ni=!1;function ho(n,r){switch(n){case"keyup":return rs.indexOf(r.keyCode)!==-1;case"keydown":return r.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function el(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var tl=!1;function QE(n,r){switch(n){case"compositionend":return el(r);case"keypress":return r.which!==32?null:(ni=!0,ti);case"textInput":return n=r.data,n===ti&&ni?null:n;default:return null}}function XE(n,r){if(tl)return n==="compositionend"||!on&&ho(n,r)?(n=tn(),et=bn=at=null,tl=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(r.ctrlKey||r.altKey||r.metaKey)||r.ctrlKey&&r.altKey){if(r.char&&1<r.char.length)return r.char;if(r.which)return String.fromCharCode(r.which)}return null;case"compositionend":return yi&&r.locale!=="ko"?null:r.data;default:return null}}var JE={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function _0(n){var r=n&&n.nodeName&&n.nodeName.toLowerCase();return r==="input"?!!JE[n.type]:r==="textarea"}function k0(n,r,o,c){k?M?M.push(c):M=[c]:k=c,r=qd(r,"onChange"),0<r.length&&(o=new Un("onChange","change",null,o,c),n.push({event:o,listeners:r}))}var lc=null,cc=null;function ZE(n){ib(n,0)}function td(n){var r=In(n);if(Mn(r))return n}function E0(n,r){if(n==="change")return r}var T0=!1;if(Ne){var If;if(Ne){var Mf="oninput"in document;if(!Mf){var j0=document.createElement("div");j0.setAttribute("oninput","return;"),Mf=typeof j0.oninput=="function"}If=Mf}else If=!1;T0=If&&(!document.documentMode||9<document.documentMode)}function S0(){lc&&(lc.detachEvent("onpropertychange",C0),cc=lc=null)}function C0(n){if(n.propertyName==="value"&&td(cc)){var r=[];k0(r,cc,n,oe(n)),me(ZE,r)}}function eT(n,r,o){n==="focusin"?(S0(),lc=r,cc=o,lc.attachEvent("onpropertychange",C0)):n==="focusout"&&S0()}function tT(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return td(cc)}function nT(n,r){if(n==="click")return td(r)}function sT(n,r){if(n==="input"||n==="change")return td(r)}function rT(n,r){return n===r&&(n!==0||1/n===1/r)||n!==n&&r!==r}var br=typeof Object.is=="function"?Object.is:rT;function uc(n,r){if(br(n,r))return!0;if(typeof n!="object"||n===null||typeof r!="object"||r===null)return!1;var o=Object.keys(n),c=Object.keys(r);if(o.length!==c.length)return!1;for(c=0;c<o.length;c++){var f=o[c];if(!Ct.call(r,f)||!br(n[f],r[f]))return!1}return!0}function N0(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function A0(n,r){var o=N0(n);n=0;for(var c;o;){if(o.nodeType===3){if(c=n+o.textContent.length,n<=r&&c>=r)return{node:o,offset:r-n};n=c}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=N0(o)}}function R0(n,r){return n&&r?n===r?!0:n&&n.nodeType===3?!1:r&&r.nodeType===3?R0(n,r.parentNode):"contains"in n?n.contains(r):n.compareDocumentPosition?!!(n.compareDocumentPosition(r)&16):!1:!1}function I0(n){n=n!=null&&n.ownerDocument!=null&&n.ownerDocument.defaultView!=null?n.ownerDocument.defaultView:window;for(var r=ns(n.document);r instanceof n.HTMLIFrameElement;){try{var o=typeof r.contentWindow.location.href=="string"}catch{o=!1}if(o)n=r.contentWindow;else break;r=ns(n.document)}return r}function Df(n){var r=n&&n.nodeName&&n.nodeName.toLowerCase();return r&&(r==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||r==="textarea"||n.contentEditable==="true")}var iT=Ne&&"documentMode"in document&&11>=document.documentMode,nl=null,Lf=null,dc=null,Of=!1;function M0(n,r,o){var c=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;Of||nl==null||nl!==ns(c)||(c=nl,"selectionStart"in c&&Df(c)?c={start:c.selectionStart,end:c.selectionEnd}:(c=(c.ownerDocument&&c.ownerDocument.defaultView||window).getSelection(),c={anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset}),dc&&uc(dc,c)||(dc=c,c=qd(Lf,"onSelect"),0<c.length&&(r=new Un("onSelect","select",null,r,o),n.push({event:r,listeners:c}),r.target=nl)))}function fo(n,r){var o={};return o[n.toLowerCase()]=r.toLowerCase(),o["Webkit"+n]="webkit"+r,o["Moz"+n]="moz"+r,o}var sl={animationend:fo("Animation","AnimationEnd"),animationiteration:fo("Animation","AnimationIteration"),animationstart:fo("Animation","AnimationStart"),transitionrun:fo("Transition","TransitionRun"),transitionstart:fo("Transition","TransitionStart"),transitioncancel:fo("Transition","TransitionCancel"),transitionend:fo("Transition","TransitionEnd")},Pf={},D0={};Ne&&(D0=document.createElement("div").style,"AnimationEvent"in window||(delete sl.animationend.animation,delete sl.animationiteration.animation,delete sl.animationstart.animation),"TransitionEvent"in window||delete sl.transitionend.transition);function mo(n){if(Pf[n])return Pf[n];if(!sl[n])return n;var r=sl[n],o;for(o in r)if(r.hasOwnProperty(o)&&o in D0)return Pf[n]=r[o];return n}var L0=mo("animationend"),O0=mo("animationiteration"),P0=mo("animationstart"),aT=mo("transitionrun"),oT=mo("transitionstart"),lT=mo("transitioncancel"),V0=mo("transitionend"),U0=new Map,Vf="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Vf.push("scrollEnd");function si(n,r){U0.set(n,r),xs(r,[n])}var nd=typeof reportError=="function"?reportError:function(n){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var r=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof n=="object"&&n!==null&&typeof n.message=="string"?String(n.message):String(n),error:n});if(!window.dispatchEvent(r))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",n);return}console.error(n)},Or=[],rl=0,Uf=0;function sd(){for(var n=rl,r=Uf=rl=0;r<n;){var o=Or[r];Or[r++]=null;var c=Or[r];Or[r++]=null;var f=Or[r];Or[r++]=null;var m=Or[r];if(Or[r++]=null,c!==null&&f!==null){var x=c.pending;x===null?f.next=f:(f.next=x.next,x.next=f),c.pending=f}m!==0&&B0(o,f,m)}}function rd(n,r,o,c){Or[rl++]=n,Or[rl++]=r,Or[rl++]=o,Or[rl++]=c,Uf|=c,n.lanes|=c,n=n.alternate,n!==null&&(n.lanes|=c)}function Bf(n,r,o,c){return rd(n,r,o,c),id(n)}function po(n,r){return rd(n,null,null,r),id(n)}function B0(n,r,o){n.lanes|=o;var c=n.alternate;c!==null&&(c.lanes|=o);for(var f=!1,m=n.return;m!==null;)m.childLanes|=o,c=m.alternate,c!==null&&(c.childLanes|=o),m.tag===22&&(n=m.stateNode,n===null||n._visibility&1||(f=!0)),n=m,m=m.return;return n.tag===3?(m=n.stateNode,f&&r!==null&&(f=31-$e(o),n=m.hiddenUpdates,c=n[f],c===null?n[f]=[r]:c.push(r),r.lane=o|536870912),m):null}function id(n){if(50<Mc)throw Mc=0,Ym=null,Error(i(185));for(var r=n.return;r!==null;)n=r,r=n.return;return n.tag===3?n.stateNode:null}var il={};function cT(n,r,o,c){this.tag=n,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=r,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=c,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function wr(n,r,o,c){return new cT(n,r,o,c)}function zf(n){return n=n.prototype,!(!n||!n.isReactComponent)}function Oi(n,r){var o=n.alternate;return o===null?(o=wr(n.tag,r,n.key,n.mode),o.elementType=n.elementType,o.type=n.type,o.stateNode=n.stateNode,o.alternate=n,n.alternate=o):(o.pendingProps=r,o.type=n.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=n.flags&65011712,o.childLanes=n.childLanes,o.lanes=n.lanes,o.child=n.child,o.memoizedProps=n.memoizedProps,o.memoizedState=n.memoizedState,o.updateQueue=n.updateQueue,r=n.dependencies,o.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext},o.sibling=n.sibling,o.index=n.index,o.ref=n.ref,o.refCleanup=n.refCleanup,o}function z0(n,r){n.flags&=65011714;var o=n.alternate;return o===null?(n.childLanes=0,n.lanes=r,n.child=null,n.subtreeFlags=0,n.memoizedProps=null,n.memoizedState=null,n.updateQueue=null,n.dependencies=null,n.stateNode=null):(n.childLanes=o.childLanes,n.lanes=o.lanes,n.child=o.child,n.subtreeFlags=0,n.deletions=null,n.memoizedProps=o.memoizedProps,n.memoizedState=o.memoizedState,n.updateQueue=o.updateQueue,n.type=o.type,r=o.dependencies,n.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext}),n}function ad(n,r,o,c,f,m){var x=0;if(c=n,typeof n=="function")zf(n)&&(x=1);else if(typeof n=="string")x=mj(n,o,_e.current)?26:n==="html"||n==="head"||n==="body"?27:5;else e:switch(n){case R:return n=wr(31,o,r,f),n.elementType=R,n.lanes=m,n;case H:return go(o.children,f,m,r);case B:x=8,f|=24;break;case K:return n=wr(12,o,r,f|2),n.elementType=K,n.lanes=m,n;case Ee:return n=wr(13,o,r,f),n.elementType=Ee,n.lanes=m,n;case ge:return n=wr(19,o,r,f),n.elementType=ge,n.lanes=m,n;default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case Q:x=10;break e;case G:x=9;break e;case he:x=11;break e;case C:x=14;break e;case j:x=16,c=null;break e}x=29,o=Error(i(130,n===null?"null":typeof n,"")),c=null}return r=wr(x,o,r,f),r.elementType=n,r.type=c,r.lanes=m,r}function go(n,r,o,c){return n=wr(7,n,c,r),n.lanes=o,n}function Ff(n,r,o){return n=wr(6,n,null,r),n.lanes=o,n}function F0(n){var r=wr(18,null,null,0);return r.stateNode=n,r}function qf(n,r,o){return r=wr(4,n.children!==null?n.children:[],n.key,r),r.lanes=o,r.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},r}var q0=new WeakMap;function Pr(n,r){if(typeof n=="object"&&n!==null){var o=q0.get(n);return o!==void 0?o:(r={value:n,source:r,stack:fe(r)},q0.set(n,r),r)}return{value:n,source:r,stack:fe(r)}}var al=[],ol=0,od=null,hc=0,Vr=[],Ur=0,ya=null,vi=1,bi="";function Pi(n,r){al[ol++]=hc,al[ol++]=od,od=n,hc=r}function H0(n,r,o){Vr[Ur++]=vi,Vr[Ur++]=bi,Vr[Ur++]=ya,ya=n;var c=vi;n=bi;var f=32-$e(c)-1;c&=~(1<<f),o+=1;var m=32-$e(r)+f;if(30<m){var x=f-f%5;m=(c&(1<<x)-1).toString(32),c>>=x,f-=x,vi=1<<32-$e(r)+f|o<<f|c,bi=m+n}else vi=1<<m|o<<f|c,bi=n}function Hf(n){n.return!==null&&(Pi(n,1),H0(n,1,0))}function $f(n){for(;n===od;)od=al[--ol],al[ol]=null,hc=al[--ol],al[ol]=null;for(;n===ya;)ya=Vr[--Ur],Vr[Ur]=null,bi=Vr[--Ur],Vr[Ur]=null,vi=Vr[--Ur],Vr[Ur]=null}function $0(n,r){Vr[Ur++]=vi,Vr[Ur++]=bi,Vr[Ur++]=ya,vi=r.id,bi=r.overflow,ya=n}var Ds=null,Dn=null,qt=!1,va=null,Br=!1,Wf=Error(i(519));function ba(n){var r=Error(i(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw fc(Pr(r,n)),Wf}function W0(n){var r=n.stateNode,o=n.type,c=n.memoizedProps;switch(r[en]=n,r[un]=c,o){case"dialog":Lt("cancel",r),Lt("close",r);break;case"iframe":case"object":case"embed":Lt("load",r);break;case"video":case"audio":for(o=0;o<Lc.length;o++)Lt(Lc[o],r);break;case"source":Lt("error",r);break;case"img":case"image":case"link":Lt("error",r),Lt("load",r);break;case"details":Lt("toggle",r);break;case"input":Lt("invalid",r),Di(r,c.value,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name,!0);break;case"select":Lt("invalid",r);break;case"textarea":Lt("invalid",r),vr(r,c.value,c.defaultValue,c.children)}o=c.children,typeof o!="string"&&typeof o!="number"&&typeof o!="bigint"||r.textContent===""+o||c.suppressHydrationWarning===!0||cb(r.textContent,o)?(c.popover!=null&&(Lt("beforetoggle",r),Lt("toggle",r)),c.onScroll!=null&&Lt("scroll",r),c.onScrollEnd!=null&&Lt("scrollend",r),c.onClick!=null&&(r.onclick=ss),r=!0):r=!1,r||ba(n,!0)}function G0(n){for(Ds=n.return;Ds;)switch(Ds.tag){case 5:case 31:case 13:Br=!1;return;case 27:case 3:Br=!0;return;default:Ds=Ds.return}}function ll(n){if(n!==Ds)return!1;if(!qt)return G0(n),qt=!0,!1;var r=n.tag,o;if((o=r!==3&&r!==27)&&((o=r===5)&&(o=n.type,o=!(o!=="form"&&o!=="button")||up(n.type,n.memoizedProps)),o=!o),o&&Dn&&ba(n),G0(n),r===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(i(317));Dn=vb(n)}else if(r===31){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(i(317));Dn=vb(n)}else r===27?(r=Dn,Ma(n.type)?(n=pp,pp=null,Dn=n):Dn=r):Dn=Ds?Fr(n.stateNode.nextSibling):null;return!0}function yo(){Dn=Ds=null,qt=!1}function Gf(){var n=va;return n!==null&&(ur===null?ur=n:ur.push.apply(ur,n),va=null),n}function fc(n){va===null?va=[n]:va.push(n)}var Kf=P(null),vo=null,Vi=null;function wa(n,r,o){we(Kf,r._currentValue),r._currentValue=o}function Ui(n){n._currentValue=Kf.current,re(Kf)}function Yf(n,r,o){for(;n!==null;){var c=n.alternate;if((n.childLanes&r)!==r?(n.childLanes|=r,c!==null&&(c.childLanes|=r)):c!==null&&(c.childLanes&r)!==r&&(c.childLanes|=r),n===o)break;n=n.return}}function Qf(n,r,o,c){var f=n.child;for(f!==null&&(f.return=n);f!==null;){var m=f.dependencies;if(m!==null){var x=f.child;m=m.firstContext;e:for(;m!==null;){var S=m;m=f;for(var U=0;U<r.length;U++)if(S.context===r[U]){m.lanes|=o,S=m.alternate,S!==null&&(S.lanes|=o),Yf(m.return,o,n),c||(x=null);break e}m=S.next}}else if(f.tag===18){if(x=f.return,x===null)throw Error(i(341));x.lanes|=o,m=x.alternate,m!==null&&(m.lanes|=o),Yf(x,o,n),x=null}else x=f.child;if(x!==null)x.return=f;else for(x=f;x!==null;){if(x===n){x=null;break}if(f=x.sibling,f!==null){f.return=x.return,x=f;break}x=x.return}f=x}}function cl(n,r,o,c){n=null;for(var f=r,m=!1;f!==null;){if(!m){if((f.flags&524288)!==0)m=!0;else if((f.flags&262144)!==0)break}if(f.tag===10){var x=f.alternate;if(x===null)throw Error(i(387));if(x=x.memoizedProps,x!==null){var S=f.type;br(f.pendingProps.value,x.value)||(n!==null?n.push(S):n=[S])}}else if(f===Fe.current){if(x=f.alternate,x===null)throw Error(i(387));x.memoizedState.memoizedState!==f.memoizedState.memoizedState&&(n!==null?n.push(Bc):n=[Bc])}f=f.return}n!==null&&Qf(r,n,o,c),r.flags|=262144}function ld(n){for(n=n.firstContext;n!==null;){if(!br(n.context._currentValue,n.memoizedValue))return!0;n=n.next}return!1}function bo(n){vo=n,Vi=null,n=n.dependencies,n!==null&&(n.firstContext=null)}function Ls(n){return K0(vo,n)}function cd(n,r){return vo===null&&bo(n),K0(n,r)}function K0(n,r){var o=r._currentValue;if(r={context:r,memoizedValue:o,next:null},Vi===null){if(n===null)throw Error(i(308));Vi=r,n.dependencies={lanes:0,firstContext:r},n.flags|=524288}else Vi=Vi.next=r;return o}var uT=typeof AbortController<"u"?AbortController:function(){var n=[],r=this.signal={aborted:!1,addEventListener:function(o,c){n.push(c)}};this.abort=function(){r.aborted=!0,n.forEach(function(o){return o()})}},dT=s.unstable_scheduleCallback,hT=s.unstable_NormalPriority,ds={$$typeof:Q,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Xf(){return{controller:new uT,data:new Map,refCount:0}}function mc(n){n.refCount--,n.refCount===0&&dT(hT,function(){n.controller.abort()})}var pc=null,Jf=0,ul=0,dl=null;function fT(n,r){if(pc===null){var o=pc=[];Jf=0,ul=tp(),dl={status:"pending",value:void 0,then:function(c){o.push(c)}}}return Jf++,r.then(Y0,Y0),r}function Y0(){if(--Jf===0&&pc!==null){dl!==null&&(dl.status="fulfilled");var n=pc;pc=null,ul=0,dl=null;for(var r=0;r<n.length;r++)(0,n[r])()}}function mT(n,r){var o=[],c={status:"pending",value:null,reason:null,then:function(f){o.push(f)}};return n.then(function(){c.status="fulfilled",c.value=r;for(var f=0;f<o.length;f++)(0,o[f])(r)},function(f){for(c.status="rejected",c.reason=f,f=0;f<o.length;f++)(0,o[f])(void 0)}),c}var Q0=X.S;X.S=function(n,r){M1=pt(),typeof r=="object"&&r!==null&&typeof r.then=="function"&&fT(n,r),Q0!==null&&Q0(n,r)};var wo=P(null);function Zf(){var n=wo.current;return n!==null?n:Sn.pooledCache}function ud(n,r){r===null?we(wo,wo.current):we(wo,r.pool)}function X0(){var n=Zf();return n===null?null:{parent:ds._currentValue,pool:n}}var hl=Error(i(460)),em=Error(i(474)),dd=Error(i(542)),hd={then:function(){}};function J0(n){return n=n.status,n==="fulfilled"||n==="rejected"}function Z0(n,r,o){switch(o=n[o],o===void 0?n.push(r):o!==r&&(r.then(ss,ss),r=o),r.status){case"fulfilled":return r.value;case"rejected":throw n=r.reason,tv(n),n;default:if(typeof r.status=="string")r.then(ss,ss);else{if(n=Sn,n!==null&&100<n.shellSuspendCounter)throw Error(i(482));n=r,n.status="pending",n.then(function(c){if(r.status==="pending"){var f=r;f.status="fulfilled",f.value=c}},function(c){if(r.status==="pending"){var f=r;f.status="rejected",f.reason=c}})}switch(r.status){case"fulfilled":return r.value;case"rejected":throw n=r.reason,tv(n),n}throw _o=r,hl}}function xo(n){try{var r=n._init;return r(n._payload)}catch(o){throw o!==null&&typeof o=="object"&&typeof o.then=="function"?(_o=o,hl):o}}var _o=null;function ev(){if(_o===null)throw Error(i(459));var n=_o;return _o=null,n}function tv(n){if(n===hl||n===dd)throw Error(i(483))}var fl=null,gc=0;function fd(n){var r=gc;return gc+=1,fl===null&&(fl=[]),Z0(fl,n,r)}function yc(n,r){r=r.props.ref,n.ref=r!==void 0?r:null}function md(n,r){throw r.$$typeof===T?Error(i(525)):(n=Object.prototype.toString.call(r),Error(i(31,n==="[object Object]"?"object with keys {"+Object.keys(r).join(", ")+"}":n)))}function nv(n){function r(Y,$){if(n){var ee=Y.deletions;ee===null?(Y.deletions=[$],Y.flags|=16):ee.push($)}}function o(Y,$){if(!n)return null;for(;$!==null;)r(Y,$),$=$.sibling;return null}function c(Y){for(var $=new Map;Y!==null;)Y.key!==null?$.set(Y.key,Y):$.set(Y.index,Y),Y=Y.sibling;return $}function f(Y,$){return Y=Oi(Y,$),Y.index=0,Y.sibling=null,Y}function m(Y,$,ee){return Y.index=ee,n?(ee=Y.alternate,ee!==null?(ee=ee.index,ee<$?(Y.flags|=67108866,$):ee):(Y.flags|=67108866,$)):(Y.flags|=1048576,$)}function x(Y){return n&&Y.alternate===null&&(Y.flags|=67108866),Y}function S(Y,$,ee,be){return $===null||$.tag!==6?($=Ff(ee,Y.mode,be),$.return=Y,$):($=f($,ee),$.return=Y,$)}function U(Y,$,ee,be){var ot=ee.type;return ot===H?pe(Y,$,ee.props.children,be,ee.key):$!==null&&($.elementType===ot||typeof ot=="object"&&ot!==null&&ot.$$typeof===j&&xo(ot)===$.type)?($=f($,ee.props),yc($,ee),$.return=Y,$):($=ad(ee.type,ee.key,ee.props,null,Y.mode,be),yc($,ee),$.return=Y,$)}function ne(Y,$,ee,be){return $===null||$.tag!==4||$.stateNode.containerInfo!==ee.containerInfo||$.stateNode.implementation!==ee.implementation?($=qf(ee,Y.mode,be),$.return=Y,$):($=f($,ee.children||[]),$.return=Y,$)}function pe(Y,$,ee,be,ot){return $===null||$.tag!==7?($=go(ee,Y.mode,be,ot),$.return=Y,$):($=f($,ee),$.return=Y,$)}function ke(Y,$,ee){if(typeof $=="string"&&$!==""||typeof $=="number"||typeof $=="bigint")return $=Ff(""+$,Y.mode,ee),$.return=Y,$;if(typeof $=="object"&&$!==null){switch($.$$typeof){case L:return ee=ad($.type,$.key,$.props,null,Y.mode,ee),yc(ee,$),ee.return=Y,ee;case W:return $=qf($,Y.mode,ee),$.return=Y,$;case j:return $=xo($),ke(Y,$,ee)}if(Je($)||D($))return $=go($,Y.mode,ee,null),$.return=Y,$;if(typeof $.then=="function")return ke(Y,fd($),ee);if($.$$typeof===Q)return ke(Y,cd(Y,$),ee);md(Y,$)}return null}function ae(Y,$,ee,be){var ot=$!==null?$.key:null;if(typeof ee=="string"&&ee!==""||typeof ee=="number"||typeof ee=="bigint")return ot!==null?null:S(Y,$,""+ee,be);if(typeof ee=="object"&&ee!==null){switch(ee.$$typeof){case L:return ee.key===ot?U(Y,$,ee,be):null;case W:return ee.key===ot?ne(Y,$,ee,be):null;case j:return ee=xo(ee),ae(Y,$,ee,be)}if(Je(ee)||D(ee))return ot!==null?null:pe(Y,$,ee,be,null);if(typeof ee.then=="function")return ae(Y,$,fd(ee),be);if(ee.$$typeof===Q)return ae(Y,$,cd(Y,ee),be);md(Y,ee)}return null}function de(Y,$,ee,be,ot){if(typeof be=="string"&&be!==""||typeof be=="number"||typeof be=="bigint")return Y=Y.get(ee)||null,S($,Y,""+be,ot);if(typeof be=="object"&&be!==null){switch(be.$$typeof){case L:return Y=Y.get(be.key===null?ee:be.key)||null,U($,Y,be,ot);case W:return Y=Y.get(be.key===null?ee:be.key)||null,ne($,Y,be,ot);case j:return be=xo(be),de(Y,$,ee,be,ot)}if(Je(be)||D(be))return Y=Y.get(ee)||null,pe($,Y,be,ot,null);if(typeof be.then=="function")return de(Y,$,ee,fd(be),ot);if(be.$$typeof===Q)return de(Y,$,ee,cd($,be),ot);md($,be)}return null}function Xe(Y,$,ee,be){for(var ot=null,nn=null,tt=$,Nt=$=0,Vt=null;tt!==null&&Nt<ee.length;Nt++){tt.index>Nt?(Vt=tt,tt=null):Vt=tt.sibling;var sn=ae(Y,tt,ee[Nt],be);if(sn===null){tt===null&&(tt=Vt);break}n&&tt&&sn.alternate===null&&r(Y,tt),$=m(sn,$,Nt),nn===null?ot=sn:nn.sibling=sn,nn=sn,tt=Vt}if(Nt===ee.length)return o(Y,tt),qt&&Pi(Y,Nt),ot;if(tt===null){for(;Nt<ee.length;Nt++)tt=ke(Y,ee[Nt],be),tt!==null&&($=m(tt,$,Nt),nn===null?ot=tt:nn.sibling=tt,nn=tt);return qt&&Pi(Y,Nt),ot}for(tt=c(tt);Nt<ee.length;Nt++)Vt=de(tt,Y,Nt,ee[Nt],be),Vt!==null&&(n&&Vt.alternate!==null&&tt.delete(Vt.key===null?Nt:Vt.key),$=m(Vt,$,Nt),nn===null?ot=Vt:nn.sibling=Vt,nn=Vt);return n&&tt.forEach(function(Va){return r(Y,Va)}),qt&&Pi(Y,Nt),ot}function mt(Y,$,ee,be){if(ee==null)throw Error(i(151));for(var ot=null,nn=null,tt=$,Nt=$=0,Vt=null,sn=ee.next();tt!==null&&!sn.done;Nt++,sn=ee.next()){tt.index>Nt?(Vt=tt,tt=null):Vt=tt.sibling;var Va=ae(Y,tt,sn.value,be);if(Va===null){tt===null&&(tt=Vt);break}n&&tt&&Va.alternate===null&&r(Y,tt),$=m(Va,$,Nt),nn===null?ot=Va:nn.sibling=Va,nn=Va,tt=Vt}if(sn.done)return o(Y,tt),qt&&Pi(Y,Nt),ot;if(tt===null){for(;!sn.done;Nt++,sn=ee.next())sn=ke(Y,sn.value,be),sn!==null&&($=m(sn,$,Nt),nn===null?ot=sn:nn.sibling=sn,nn=sn);return qt&&Pi(Y,Nt),ot}for(tt=c(tt);!sn.done;Nt++,sn=ee.next())sn=de(tt,Y,Nt,sn.value,be),sn!==null&&(n&&sn.alternate!==null&&tt.delete(sn.key===null?Nt:sn.key),$=m(sn,$,Nt),nn===null?ot=sn:nn.sibling=sn,nn=sn);return n&&tt.forEach(function(Tj){return r(Y,Tj)}),qt&&Pi(Y,Nt),ot}function _n(Y,$,ee,be){if(typeof ee=="object"&&ee!==null&&ee.type===H&&ee.key===null&&(ee=ee.props.children),typeof ee=="object"&&ee!==null){switch(ee.$$typeof){case L:e:{for(var ot=ee.key;$!==null;){if($.key===ot){if(ot=ee.type,ot===H){if($.tag===7){o(Y,$.sibling),be=f($,ee.props.children),be.return=Y,Y=be;break e}}else if($.elementType===ot||typeof ot=="object"&&ot!==null&&ot.$$typeof===j&&xo(ot)===$.type){o(Y,$.sibling),be=f($,ee.props),yc(be,ee),be.return=Y,Y=be;break e}o(Y,$);break}else r(Y,$);$=$.sibling}ee.type===H?(be=go(ee.props.children,Y.mode,be,ee.key),be.return=Y,Y=be):(be=ad(ee.type,ee.key,ee.props,null,Y.mode,be),yc(be,ee),be.return=Y,Y=be)}return x(Y);case W:e:{for(ot=ee.key;$!==null;){if($.key===ot)if($.tag===4&&$.stateNode.containerInfo===ee.containerInfo&&$.stateNode.implementation===ee.implementation){o(Y,$.sibling),be=f($,ee.children||[]),be.return=Y,Y=be;break e}else{o(Y,$);break}else r(Y,$);$=$.sibling}be=qf(ee,Y.mode,be),be.return=Y,Y=be}return x(Y);case j:return ee=xo(ee),_n(Y,$,ee,be)}if(Je(ee))return Xe(Y,$,ee,be);if(D(ee)){if(ot=D(ee),typeof ot!="function")throw Error(i(150));return ee=ot.call(ee),mt(Y,$,ee,be)}if(typeof ee.then=="function")return _n(Y,$,fd(ee),be);if(ee.$$typeof===Q)return _n(Y,$,cd(Y,ee),be);md(Y,ee)}return typeof ee=="string"&&ee!==""||typeof ee=="number"||typeof ee=="bigint"?(ee=""+ee,$!==null&&$.tag===6?(o(Y,$.sibling),be=f($,ee),be.return=Y,Y=be):(o(Y,$),be=Ff(ee,Y.mode,be),be.return=Y,Y=be),x(Y)):o(Y,$)}return function(Y,$,ee,be){try{gc=0;var ot=_n(Y,$,ee,be);return fl=null,ot}catch(tt){if(tt===hl||tt===dd)throw tt;var nn=wr(29,tt,null,Y.mode);return nn.lanes=be,nn.return=Y,nn}}}var ko=nv(!0),sv=nv(!1),xa=!1;function tm(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function nm(n,r){n=n.updateQueue,r.updateQueue===n&&(r.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,callbacks:null})}function _a(n){return{lane:n,tag:0,payload:null,callback:null,next:null}}function ka(n,r,o){var c=n.updateQueue;if(c===null)return null;if(c=c.shared,(ln&2)!==0){var f=c.pending;return f===null?r.next=r:(r.next=f.next,f.next=r),c.pending=r,r=id(n),B0(n,null,o),r}return rd(n,c,r,o),id(n)}function vc(n,r,o){if(r=r.updateQueue,r!==null&&(r=r.shared,(o&4194048)!==0)){var c=r.lanes;c&=n.pendingLanes,o|=c,r.lanes=o,Gt(n,o)}}function sm(n,r){var o=n.updateQueue,c=n.alternate;if(c!==null&&(c=c.updateQueue,o===c)){var f=null,m=null;if(o=o.firstBaseUpdate,o!==null){do{var x={lane:o.lane,tag:o.tag,payload:o.payload,callback:null,next:null};m===null?f=m=x:m=m.next=x,o=o.next}while(o!==null);m===null?f=m=r:m=m.next=r}else f=m=r;o={baseState:c.baseState,firstBaseUpdate:f,lastBaseUpdate:m,shared:c.shared,callbacks:c.callbacks},n.updateQueue=o;return}n=o.lastBaseUpdate,n===null?o.firstBaseUpdate=r:n.next=r,o.lastBaseUpdate=r}var rm=!1;function bc(){if(rm){var n=dl;if(n!==null)throw n}}function wc(n,r,o,c){rm=!1;var f=n.updateQueue;xa=!1;var m=f.firstBaseUpdate,x=f.lastBaseUpdate,S=f.shared.pending;if(S!==null){f.shared.pending=null;var U=S,ne=U.next;U.next=null,x===null?m=ne:x.next=ne,x=U;var pe=n.alternate;pe!==null&&(pe=pe.updateQueue,S=pe.lastBaseUpdate,S!==x&&(S===null?pe.firstBaseUpdate=ne:S.next=ne,pe.lastBaseUpdate=U))}if(m!==null){var ke=f.baseState;x=0,pe=ne=U=null,S=m;do{var ae=S.lane&-536870913,de=ae!==S.lane;if(de?(Pt&ae)===ae:(c&ae)===ae){ae!==0&&ae===ul&&(rm=!0),pe!==null&&(pe=pe.next={lane:0,tag:S.tag,payload:S.payload,callback:null,next:null});e:{var Xe=n,mt=S;ae=r;var _n=o;switch(mt.tag){case 1:if(Xe=mt.payload,typeof Xe=="function"){ke=Xe.call(_n,ke,ae);break e}ke=Xe;break e;case 3:Xe.flags=Xe.flags&-65537|128;case 0:if(Xe=mt.payload,ae=typeof Xe=="function"?Xe.call(_n,ke,ae):Xe,ae==null)break e;ke=E({},ke,ae);break e;case 2:xa=!0}}ae=S.callback,ae!==null&&(n.flags|=64,de&&(n.flags|=8192),de=f.callbacks,de===null?f.callbacks=[ae]:de.push(ae))}else de={lane:ae,tag:S.tag,payload:S.payload,callback:S.callback,next:null},pe===null?(ne=pe=de,U=ke):pe=pe.next=de,x|=ae;if(S=S.next,S===null){if(S=f.shared.pending,S===null)break;de=S,S=de.next,de.next=null,f.lastBaseUpdate=de,f.shared.pending=null}}while(!0);pe===null&&(U=ke),f.baseState=U,f.firstBaseUpdate=ne,f.lastBaseUpdate=pe,m===null&&(f.shared.lanes=0),Ca|=x,n.lanes=x,n.memoizedState=ke}}function rv(n,r){if(typeof n!="function")throw Error(i(191,n));n.call(r)}function iv(n,r){var o=n.callbacks;if(o!==null)for(n.callbacks=null,n=0;n<o.length;n++)rv(o[n],r)}var ml=P(null),pd=P(0);function av(n,r){n=Ki,we(pd,n),we(ml,r),Ki=n|r.baseLanes}function im(){we(pd,Ki),we(ml,ml.current)}function am(){Ki=pd.current,re(ml),re(pd)}var xr=P(null),zr=null;function Ea(n){var r=n.alternate;we(is,is.current&1),we(xr,n),zr===null&&(r===null||ml.current!==null||r.memoizedState!==null)&&(zr=n)}function om(n){we(is,is.current),we(xr,n),zr===null&&(zr=n)}function ov(n){n.tag===22?(we(is,is.current),we(xr,n),zr===null&&(zr=n)):Ta()}function Ta(){we(is,is.current),we(xr,xr.current)}function _r(n){re(xr),zr===n&&(zr=null),re(is)}var is=P(0);function gd(n){for(var r=n;r!==null;){if(r.tag===13){var o=r.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||fp(o)||mp(o)))return r}else if(r.tag===19&&(r.memoizedProps.revealOrder==="forwards"||r.memoizedProps.revealOrder==="backwards"||r.memoizedProps.revealOrder==="unstable_legacy-backwards"||r.memoizedProps.revealOrder==="together")){if((r.flags&128)!==0)return r}else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===n)break;for(;r.sibling===null;){if(r.return===null||r.return===n)return null;r=r.return}r.sibling.return=r.return,r=r.sibling}return null}var Bi=0,St=null,wn=null,hs=null,yd=!1,pl=!1,Eo=!1,vd=0,xc=0,gl=null,pT=0;function Yn(){throw Error(i(321))}function lm(n,r){if(r===null)return!1;for(var o=0;o<r.length&&o<n.length;o++)if(!br(n[o],r[o]))return!1;return!0}function cm(n,r,o,c,f,m){return Bi=m,St=r,r.memoizedState=null,r.updateQueue=null,r.lanes=0,X.H=n===null||n.memoizedState===null?Hv:Em,Eo=!1,m=o(c,f),Eo=!1,pl&&(m=cv(r,o,c,f)),lv(n),m}function lv(n){X.H=Ec;var r=wn!==null&&wn.next!==null;if(Bi=0,hs=wn=St=null,yd=!1,xc=0,gl=null,r)throw Error(i(300));n===null||fs||(n=n.dependencies,n!==null&&ld(n)&&(fs=!0))}function cv(n,r,o,c){St=n;var f=0;do{if(pl&&(gl=null),xc=0,pl=!1,25<=f)throw Error(i(301));if(f+=1,hs=wn=null,n.updateQueue!=null){var m=n.updateQueue;m.lastEffect=null,m.events=null,m.stores=null,m.memoCache!=null&&(m.memoCache.index=0)}X.H=$v,m=r(o,c)}while(pl);return m}function gT(){var n=X.H,r=n.useState()[0];return r=typeof r.then=="function"?_c(r):r,n=n.useState()[0],(wn!==null?wn.memoizedState:null)!==n&&(St.flags|=1024),r}function um(){var n=vd!==0;return vd=0,n}function dm(n,r,o){r.updateQueue=n.updateQueue,r.flags&=-2053,n.lanes&=~o}function hm(n){if(yd){for(n=n.memoizedState;n!==null;){var r=n.queue;r!==null&&(r.pending=null),n=n.next}yd=!1}Bi=0,hs=wn=St=null,pl=!1,xc=vd=0,gl=null}function er(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return hs===null?St.memoizedState=hs=n:hs=hs.next=n,hs}function as(){if(wn===null){var n=St.alternate;n=n!==null?n.memoizedState:null}else n=wn.next;var r=hs===null?St.memoizedState:hs.next;if(r!==null)hs=r,wn=n;else{if(n===null)throw St.alternate===null?Error(i(467)):Error(i(310));wn=n,n={memoizedState:wn.memoizedState,baseState:wn.baseState,baseQueue:wn.baseQueue,queue:wn.queue,next:null},hs===null?St.memoizedState=hs=n:hs=hs.next=n}return hs}function bd(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function _c(n){var r=xc;return xc+=1,gl===null&&(gl=[]),n=Z0(gl,n,r),r=St,(hs===null?r.memoizedState:hs.next)===null&&(r=r.alternate,X.H=r===null||r.memoizedState===null?Hv:Em),n}function wd(n){if(n!==null&&typeof n=="object"){if(typeof n.then=="function")return _c(n);if(n.$$typeof===Q)return Ls(n)}throw Error(i(438,String(n)))}function fm(n){var r=null,o=St.updateQueue;if(o!==null&&(r=o.memoCache),r==null){var c=St.alternate;c!==null&&(c=c.updateQueue,c!==null&&(c=c.memoCache,c!=null&&(r={data:c.data.map(function(f){return f.slice()}),index:0})))}if(r==null&&(r={data:[],index:0}),o===null&&(o=bd(),St.updateQueue=o),o.memoCache=r,o=r.data[r.index],o===void 0)for(o=r.data[r.index]=Array(n),c=0;c<n;c++)o[c]=V;return r.index++,o}function zi(n,r){return typeof r=="function"?r(n):r}function xd(n){var r=as();return mm(r,wn,n)}function mm(n,r,o){var c=n.queue;if(c===null)throw Error(i(311));c.lastRenderedReducer=o;var f=n.baseQueue,m=c.pending;if(m!==null){if(f!==null){var x=f.next;f.next=m.next,m.next=x}r.baseQueue=f=m,c.pending=null}if(m=n.baseState,f===null)n.memoizedState=m;else{r=f.next;var S=x=null,U=null,ne=r,pe=!1;do{var ke=ne.lane&-536870913;if(ke!==ne.lane?(Pt&ke)===ke:(Bi&ke)===ke){var ae=ne.revertLane;if(ae===0)U!==null&&(U=U.next={lane:0,revertLane:0,gesture:null,action:ne.action,hasEagerState:ne.hasEagerState,eagerState:ne.eagerState,next:null}),ke===ul&&(pe=!0);else if((Bi&ae)===ae){ne=ne.next,ae===ul&&(pe=!0);continue}else ke={lane:0,revertLane:ne.revertLane,gesture:null,action:ne.action,hasEagerState:ne.hasEagerState,eagerState:ne.eagerState,next:null},U===null?(S=U=ke,x=m):U=U.next=ke,St.lanes|=ae,Ca|=ae;ke=ne.action,Eo&&o(m,ke),m=ne.hasEagerState?ne.eagerState:o(m,ke)}else ae={lane:ke,revertLane:ne.revertLane,gesture:ne.gesture,action:ne.action,hasEagerState:ne.hasEagerState,eagerState:ne.eagerState,next:null},U===null?(S=U=ae,x=m):U=U.next=ae,St.lanes|=ke,Ca|=ke;ne=ne.next}while(ne!==null&&ne!==r);if(U===null?x=m:U.next=S,!br(m,n.memoizedState)&&(fs=!0,pe&&(o=dl,o!==null)))throw o;n.memoizedState=m,n.baseState=x,n.baseQueue=U,c.lastRenderedState=m}return f===null&&(c.lanes=0),[n.memoizedState,c.dispatch]}function pm(n){var r=as(),o=r.queue;if(o===null)throw Error(i(311));o.lastRenderedReducer=n;var c=o.dispatch,f=o.pending,m=r.memoizedState;if(f!==null){o.pending=null;var x=f=f.next;do m=n(m,x.action),x=x.next;while(x!==f);br(m,r.memoizedState)||(fs=!0),r.memoizedState=m,r.baseQueue===null&&(r.baseState=m),o.lastRenderedState=m}return[m,c]}function uv(n,r,o){var c=St,f=as(),m=qt;if(m){if(o===void 0)throw Error(i(407));o=o()}else o=r();var x=!br((wn||f).memoizedState,o);if(x&&(f.memoizedState=o,fs=!0),f=f.queue,vm(fv.bind(null,c,f,n),[n]),f.getSnapshot!==r||x||hs!==null&&hs.memoizedState.tag&1){if(c.flags|=2048,yl(9,{destroy:void 0},hv.bind(null,c,f,o,r),null),Sn===null)throw Error(i(349));m||(Bi&127)!==0||dv(c,r,o)}return o}function dv(n,r,o){n.flags|=16384,n={getSnapshot:r,value:o},r=St.updateQueue,r===null?(r=bd(),St.updateQueue=r,r.stores=[n]):(o=r.stores,o===null?r.stores=[n]:o.push(n))}function hv(n,r,o,c){r.value=o,r.getSnapshot=c,mv(r)&&pv(n)}function fv(n,r,o){return o(function(){mv(r)&&pv(n)})}function mv(n){var r=n.getSnapshot;n=n.value;try{var o=r();return!br(n,o)}catch{return!0}}function pv(n){var r=po(n,2);r!==null&&dr(r,n,2)}function gm(n){var r=er();if(typeof n=="function"){var o=n;if(n=o(),Eo){nt(!0);try{o()}finally{nt(!1)}}}return r.memoizedState=r.baseState=n,r.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:zi,lastRenderedState:n},r}function gv(n,r,o,c){return n.baseState=o,mm(n,wn,typeof c=="function"?c:zi)}function yT(n,r,o,c,f){if(Ed(n))throw Error(i(485));if(n=r.action,n!==null){var m={payload:f,action:n,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(x){m.listeners.push(x)}};X.T!==null?o(!0):m.isTransition=!1,c(m),o=r.pending,o===null?(m.next=r.pending=m,yv(r,m)):(m.next=o.next,r.pending=o.next=m)}}function yv(n,r){var o=r.action,c=r.payload,f=n.state;if(r.isTransition){var m=X.T,x={};X.T=x;try{var S=o(f,c),U=X.S;U!==null&&U(x,S),vv(n,r,S)}catch(ne){ym(n,r,ne)}finally{m!==null&&x.types!==null&&(m.types=x.types),X.T=m}}else try{m=o(f,c),vv(n,r,m)}catch(ne){ym(n,r,ne)}}function vv(n,r,o){o!==null&&typeof o=="object"&&typeof o.then=="function"?o.then(function(c){bv(n,r,c)},function(c){return ym(n,r,c)}):bv(n,r,o)}function bv(n,r,o){r.status="fulfilled",r.value=o,wv(r),n.state=o,r=n.pending,r!==null&&(o=r.next,o===r?n.pending=null:(o=o.next,r.next=o,yv(n,o)))}function ym(n,r,o){var c=n.pending;if(n.pending=null,c!==null){c=c.next;do r.status="rejected",r.reason=o,wv(r),r=r.next;while(r!==c)}n.action=null}function wv(n){n=n.listeners;for(var r=0;r<n.length;r++)(0,n[r])()}function xv(n,r){return r}function _v(n,r){if(qt){var o=Sn.formState;if(o!==null){e:{var c=St;if(qt){if(Dn){t:{for(var f=Dn,m=Br;f.nodeType!==8;){if(!m){f=null;break t}if(f=Fr(f.nextSibling),f===null){f=null;break t}}m=f.data,f=m==="F!"||m==="F"?f:null}if(f){Dn=Fr(f.nextSibling),c=f.data==="F!";break e}}ba(c)}c=!1}c&&(r=o[0])}}return o=er(),o.memoizedState=o.baseState=r,c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:xv,lastRenderedState:r},o.queue=c,o=zv.bind(null,St,c),c.dispatch=o,c=gm(!1),m=km.bind(null,St,!1,c.queue),c=er(),f={state:r,dispatch:null,action:n,pending:null},c.queue=f,o=yT.bind(null,St,f,m,o),f.dispatch=o,c.memoizedState=n,[r,o,!1]}function kv(n){var r=as();return Ev(r,wn,n)}function Ev(n,r,o){if(r=mm(n,r,xv)[0],n=xd(zi)[0],typeof r=="object"&&r!==null&&typeof r.then=="function")try{var c=_c(r)}catch(x){throw x===hl?dd:x}else c=r;r=as();var f=r.queue,m=f.dispatch;return o!==r.memoizedState&&(St.flags|=2048,yl(9,{destroy:void 0},vT.bind(null,f,o),null)),[c,m,n]}function vT(n,r){n.action=r}function Tv(n){var r=as(),o=wn;if(o!==null)return Ev(r,o,n);as(),r=r.memoizedState,o=as();var c=o.queue.dispatch;return o.memoizedState=n,[r,c,!1]}function yl(n,r,o,c){return n={tag:n,create:o,deps:c,inst:r,next:null},r=St.updateQueue,r===null&&(r=bd(),St.updateQueue=r),o=r.lastEffect,o===null?r.lastEffect=n.next=n:(c=o.next,o.next=n,n.next=c,r.lastEffect=n),n}function jv(){return as().memoizedState}function _d(n,r,o,c){var f=er();St.flags|=n,f.memoizedState=yl(1|r,{destroy:void 0},o,c===void 0?null:c)}function kd(n,r,o,c){var f=as();c=c===void 0?null:c;var m=f.memoizedState.inst;wn!==null&&c!==null&&lm(c,wn.memoizedState.deps)?f.memoizedState=yl(r,m,o,c):(St.flags|=n,f.memoizedState=yl(1|r,m,o,c))}function Sv(n,r){_d(8390656,8,n,r)}function vm(n,r){kd(2048,8,n,r)}function bT(n){St.flags|=4;var r=St.updateQueue;if(r===null)r=bd(),St.updateQueue=r,r.events=[n];else{var o=r.events;o===null?r.events=[n]:o.push(n)}}function Cv(n){var r=as().memoizedState;return bT({ref:r,nextImpl:n}),function(){if((ln&2)!==0)throw Error(i(440));return r.impl.apply(void 0,arguments)}}function Nv(n,r){return kd(4,2,n,r)}function Av(n,r){return kd(4,4,n,r)}function Rv(n,r){if(typeof r=="function"){n=n();var o=r(n);return function(){typeof o=="function"?o():r(null)}}if(r!=null)return n=n(),r.current=n,function(){r.current=null}}function Iv(n,r,o){o=o!=null?o.concat([n]):null,kd(4,4,Rv.bind(null,r,n),o)}function bm(){}function Mv(n,r){var o=as();r=r===void 0?null:r;var c=o.memoizedState;return r!==null&&lm(r,c[1])?c[0]:(o.memoizedState=[n,r],n)}function Dv(n,r){var o=as();r=r===void 0?null:r;var c=o.memoizedState;if(r!==null&&lm(r,c[1]))return c[0];if(c=n(),Eo){nt(!0);try{n()}finally{nt(!1)}}return o.memoizedState=[c,r],c}function wm(n,r,o){return o===void 0||(Bi&1073741824)!==0&&(Pt&261930)===0?n.memoizedState=r:(n.memoizedState=o,n=L1(),St.lanes|=n,Ca|=n,o)}function Lv(n,r,o,c){return br(o,r)?o:ml.current!==null?(n=wm(n,o,c),br(n,r)||(fs=!0),n):(Bi&42)===0||(Bi&1073741824)!==0&&(Pt&261930)===0?(fs=!0,n.memoizedState=o):(n=L1(),St.lanes|=n,Ca|=n,r)}function Ov(n,r,o,c,f){var m=je.p;je.p=m!==0&&8>m?m:8;var x=X.T,S={};X.T=S,km(n,!1,r,o);try{var U=f(),ne=X.S;if(ne!==null&&ne(S,U),U!==null&&typeof U=="object"&&typeof U.then=="function"){var pe=mT(U,c);kc(n,r,pe,Tr(n))}else kc(n,r,c,Tr(n))}catch(ke){kc(n,r,{then:function(){},status:"rejected",reason:ke},Tr())}finally{je.p=m,x!==null&&S.types!==null&&(x.types=S.types),X.T=x}}function wT(){}function xm(n,r,o,c){if(n.tag!==5)throw Error(i(476));var f=Pv(n).queue;Ov(n,f,r,De,o===null?wT:function(){return Vv(n),o(c)})}function Pv(n){var r=n.memoizedState;if(r!==null)return r;r={memoizedState:De,baseState:De,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:zi,lastRenderedState:De},next:null};var o={};return r.next={memoizedState:o,baseState:o,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:zi,lastRenderedState:o},next:null},n.memoizedState=r,n=n.alternate,n!==null&&(n.memoizedState=r),r}function Vv(n){var r=Pv(n);r.next===null&&(r=n.alternate.memoizedState),kc(n,r.next.queue,{},Tr())}function _m(){return Ls(Bc)}function Uv(){return as().memoizedState}function Bv(){return as().memoizedState}function xT(n){for(var r=n.return;r!==null;){switch(r.tag){case 24:case 3:var o=Tr();n=_a(o);var c=ka(r,n,o);c!==null&&(dr(c,r,o),vc(c,r,o)),r={cache:Xf()},n.payload=r;return}r=r.return}}function _T(n,r,o){var c=Tr();o={lane:c,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null},Ed(n)?Fv(r,o):(o=Bf(n,r,o,c),o!==null&&(dr(o,n,c),qv(o,r,c)))}function zv(n,r,o){var c=Tr();kc(n,r,o,c)}function kc(n,r,o,c){var f={lane:c,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null};if(Ed(n))Fv(r,f);else{var m=n.alternate;if(n.lanes===0&&(m===null||m.lanes===0)&&(m=r.lastRenderedReducer,m!==null))try{var x=r.lastRenderedState,S=m(x,o);if(f.hasEagerState=!0,f.eagerState=S,br(S,x))return rd(n,r,f,0),Sn===null&&sd(),!1}catch{}if(o=Bf(n,r,f,c),o!==null)return dr(o,n,c),qv(o,r,c),!0}return!1}function km(n,r,o,c){if(c={lane:2,revertLane:tp(),gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},Ed(n)){if(r)throw Error(i(479))}else r=Bf(n,o,c,2),r!==null&&dr(r,n,2)}function Ed(n){var r=n.alternate;return n===St||r!==null&&r===St}function Fv(n,r){pl=yd=!0;var o=n.pending;o===null?r.next=r:(r.next=o.next,o.next=r),n.pending=r}function qv(n,r,o){if((o&4194048)!==0){var c=r.lanes;c&=n.pendingLanes,o|=c,r.lanes=o,Gt(n,o)}}var Ec={readContext:Ls,use:wd,useCallback:Yn,useContext:Yn,useEffect:Yn,useImperativeHandle:Yn,useLayoutEffect:Yn,useInsertionEffect:Yn,useMemo:Yn,useReducer:Yn,useRef:Yn,useState:Yn,useDebugValue:Yn,useDeferredValue:Yn,useTransition:Yn,useSyncExternalStore:Yn,useId:Yn,useHostTransitionStatus:Yn,useFormState:Yn,useActionState:Yn,useOptimistic:Yn,useMemoCache:Yn,useCacheRefresh:Yn};Ec.useEffectEvent=Yn;var Hv={readContext:Ls,use:wd,useCallback:function(n,r){return er().memoizedState=[n,r===void 0?null:r],n},useContext:Ls,useEffect:Sv,useImperativeHandle:function(n,r,o){o=o!=null?o.concat([n]):null,_d(4194308,4,Rv.bind(null,r,n),o)},useLayoutEffect:function(n,r){return _d(4194308,4,n,r)},useInsertionEffect:function(n,r){_d(4,2,n,r)},useMemo:function(n,r){var o=er();r=r===void 0?null:r;var c=n();if(Eo){nt(!0);try{n()}finally{nt(!1)}}return o.memoizedState=[c,r],c},useReducer:function(n,r,o){var c=er();if(o!==void 0){var f=o(r);if(Eo){nt(!0);try{o(r)}finally{nt(!1)}}}else f=r;return c.memoizedState=c.baseState=f,n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:f},c.queue=n,n=n.dispatch=_T.bind(null,St,n),[c.memoizedState,n]},useRef:function(n){var r=er();return n={current:n},r.memoizedState=n},useState:function(n){n=gm(n);var r=n.queue,o=zv.bind(null,St,r);return r.dispatch=o,[n.memoizedState,o]},useDebugValue:bm,useDeferredValue:function(n,r){var o=er();return wm(o,n,r)},useTransition:function(){var n=gm(!1);return n=Ov.bind(null,St,n.queue,!0,!1),er().memoizedState=n,[!1,n]},useSyncExternalStore:function(n,r,o){var c=St,f=er();if(qt){if(o===void 0)throw Error(i(407));o=o()}else{if(o=r(),Sn===null)throw Error(i(349));(Pt&127)!==0||dv(c,r,o)}f.memoizedState=o;var m={value:o,getSnapshot:r};return f.queue=m,Sv(fv.bind(null,c,m,n),[n]),c.flags|=2048,yl(9,{destroy:void 0},hv.bind(null,c,m,o,r),null),o},useId:function(){var n=er(),r=Sn.identifierPrefix;if(qt){var o=bi,c=vi;o=(c&~(1<<32-$e(c)-1)).toString(32)+o,r="_"+r+"R_"+o,o=vd++,0<o&&(r+="H"+o.toString(32)),r+="_"}else o=pT++,r="_"+r+"r_"+o.toString(32)+"_";return n.memoizedState=r},useHostTransitionStatus:_m,useFormState:_v,useActionState:_v,useOptimistic:function(n){var r=er();r.memoizedState=r.baseState=n;var o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return r.queue=o,r=km.bind(null,St,!0,o),o.dispatch=r,[n,r]},useMemoCache:fm,useCacheRefresh:function(){return er().memoizedState=xT.bind(null,St)},useEffectEvent:function(n){var r=er(),o={impl:n};return r.memoizedState=o,function(){if((ln&2)!==0)throw Error(i(440));return o.impl.apply(void 0,arguments)}}},Em={readContext:Ls,use:wd,useCallback:Mv,useContext:Ls,useEffect:vm,useImperativeHandle:Iv,useInsertionEffect:Nv,useLayoutEffect:Av,useMemo:Dv,useReducer:xd,useRef:jv,useState:function(){return xd(zi)},useDebugValue:bm,useDeferredValue:function(n,r){var o=as();return Lv(o,wn.memoizedState,n,r)},useTransition:function(){var n=xd(zi)[0],r=as().memoizedState;return[typeof n=="boolean"?n:_c(n),r]},useSyncExternalStore:uv,useId:Uv,useHostTransitionStatus:_m,useFormState:kv,useActionState:kv,useOptimistic:function(n,r){var o=as();return gv(o,wn,n,r)},useMemoCache:fm,useCacheRefresh:Bv};Em.useEffectEvent=Cv;var $v={readContext:Ls,use:wd,useCallback:Mv,useContext:Ls,useEffect:vm,useImperativeHandle:Iv,useInsertionEffect:Nv,useLayoutEffect:Av,useMemo:Dv,useReducer:pm,useRef:jv,useState:function(){return pm(zi)},useDebugValue:bm,useDeferredValue:function(n,r){var o=as();return wn===null?wm(o,n,r):Lv(o,wn.memoizedState,n,r)},useTransition:function(){var n=pm(zi)[0],r=as().memoizedState;return[typeof n=="boolean"?n:_c(n),r]},useSyncExternalStore:uv,useId:Uv,useHostTransitionStatus:_m,useFormState:Tv,useActionState:Tv,useOptimistic:function(n,r){var o=as();return wn!==null?gv(o,wn,n,r):(o.baseState=n,[n,o.queue.dispatch])},useMemoCache:fm,useCacheRefresh:Bv};$v.useEffectEvent=Cv;function Tm(n,r,o,c){r=n.memoizedState,o=o(c,r),o=o==null?r:E({},r,o),n.memoizedState=o,n.lanes===0&&(n.updateQueue.baseState=o)}var jm={enqueueSetState:function(n,r,o){n=n._reactInternals;var c=Tr(),f=_a(c);f.payload=r,o!=null&&(f.callback=o),r=ka(n,f,c),r!==null&&(dr(r,n,c),vc(r,n,c))},enqueueReplaceState:function(n,r,o){n=n._reactInternals;var c=Tr(),f=_a(c);f.tag=1,f.payload=r,o!=null&&(f.callback=o),r=ka(n,f,c),r!==null&&(dr(r,n,c),vc(r,n,c))},enqueueForceUpdate:function(n,r){n=n._reactInternals;var o=Tr(),c=_a(o);c.tag=2,r!=null&&(c.callback=r),r=ka(n,c,o),r!==null&&(dr(r,n,o),vc(r,n,o))}};function Wv(n,r,o,c,f,m,x){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(c,m,x):r.prototype&&r.prototype.isPureReactComponent?!uc(o,c)||!uc(f,m):!0}function Gv(n,r,o,c){n=r.state,typeof r.componentWillReceiveProps=="function"&&r.componentWillReceiveProps(o,c),typeof r.UNSAFE_componentWillReceiveProps=="function"&&r.UNSAFE_componentWillReceiveProps(o,c),r.state!==n&&jm.enqueueReplaceState(r,r.state,null)}function To(n,r){var o=r;if("ref"in r){o={};for(var c in r)c!=="ref"&&(o[c]=r[c])}if(n=n.defaultProps){o===r&&(o=E({},o));for(var f in n)o[f]===void 0&&(o[f]=n[f])}return o}function Kv(n){nd(n)}function Yv(n){console.error(n)}function Qv(n){nd(n)}function Td(n,r){try{var o=n.onUncaughtError;o(r.value,{componentStack:r.stack})}catch(c){setTimeout(function(){throw c})}}function Xv(n,r,o){try{var c=n.onCaughtError;c(o.value,{componentStack:o.stack,errorBoundary:r.tag===1?r.stateNode:null})}catch(f){setTimeout(function(){throw f})}}function Sm(n,r,o){return o=_a(o),o.tag=3,o.payload={element:null},o.callback=function(){Td(n,r)},o}function Jv(n){return n=_a(n),n.tag=3,n}function Zv(n,r,o,c){var f=o.type.getDerivedStateFromError;if(typeof f=="function"){var m=c.value;n.payload=function(){return f(m)},n.callback=function(){Xv(r,o,c)}}var x=o.stateNode;x!==null&&typeof x.componentDidCatch=="function"&&(n.callback=function(){Xv(r,o,c),typeof f!="function"&&(Na===null?Na=new Set([this]):Na.add(this));var S=c.stack;this.componentDidCatch(c.value,{componentStack:S!==null?S:""})})}function kT(n,r,o,c,f){if(o.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){if(r=o.alternate,r!==null&&cl(r,o,f,!0),o=xr.current,o!==null){switch(o.tag){case 31:case 13:return zr===null?Pd():o.alternate===null&&Qn===0&&(Qn=3),o.flags&=-257,o.flags|=65536,o.lanes=f,c===hd?o.flags|=16384:(r=o.updateQueue,r===null?o.updateQueue=new Set([c]):r.add(c),Jm(n,c,f)),!1;case 22:return o.flags|=65536,c===hd?o.flags|=16384:(r=o.updateQueue,r===null?(r={transitions:null,markerInstances:null,retryQueue:new Set([c])},o.updateQueue=r):(o=r.retryQueue,o===null?r.retryQueue=new Set([c]):o.add(c)),Jm(n,c,f)),!1}throw Error(i(435,o.tag))}return Jm(n,c,f),Pd(),!1}if(qt)return r=xr.current,r!==null?((r.flags&65536)===0&&(r.flags|=256),r.flags|=65536,r.lanes=f,c!==Wf&&(n=Error(i(422),{cause:c}),fc(Pr(n,o)))):(c!==Wf&&(r=Error(i(423),{cause:c}),fc(Pr(r,o))),n=n.current.alternate,n.flags|=65536,f&=-f,n.lanes|=f,c=Pr(c,o),f=Sm(n.stateNode,c,f),sm(n,f),Qn!==4&&(Qn=2)),!1;var m=Error(i(520),{cause:c});if(m=Pr(m,o),Ic===null?Ic=[m]:Ic.push(m),Qn!==4&&(Qn=2),r===null)return!0;c=Pr(c,o),o=r;do{switch(o.tag){case 3:return o.flags|=65536,n=f&-f,o.lanes|=n,n=Sm(o.stateNode,c,n),sm(o,n),!1;case 1:if(r=o.type,m=o.stateNode,(o.flags&128)===0&&(typeof r.getDerivedStateFromError=="function"||m!==null&&typeof m.componentDidCatch=="function"&&(Na===null||!Na.has(m))))return o.flags|=65536,f&=-f,o.lanes|=f,f=Jv(f),Zv(f,n,o,c),sm(o,f),!1}o=o.return}while(o!==null);return!1}var Cm=Error(i(461)),fs=!1;function Os(n,r,o,c){r.child=n===null?sv(r,null,o,c):ko(r,n.child,o,c)}function e1(n,r,o,c,f){o=o.render;var m=r.ref;if("ref"in c){var x={};for(var S in c)S!=="ref"&&(x[S]=c[S])}else x=c;return bo(r),c=cm(n,r,o,x,m,f),S=um(),n!==null&&!fs?(dm(n,r,f),Fi(n,r,f)):(qt&&S&&Hf(r),r.flags|=1,Os(n,r,c,f),r.child)}function t1(n,r,o,c,f){if(n===null){var m=o.type;return typeof m=="function"&&!zf(m)&&m.defaultProps===void 0&&o.compare===null?(r.tag=15,r.type=m,n1(n,r,m,c,f)):(n=ad(o.type,null,c,r,r.mode,f),n.ref=r.ref,n.return=r,r.child=n)}if(m=n.child,!Om(n,f)){var x=m.memoizedProps;if(o=o.compare,o=o!==null?o:uc,o(x,c)&&n.ref===r.ref)return Fi(n,r,f)}return r.flags|=1,n=Oi(m,c),n.ref=r.ref,n.return=r,r.child=n}function n1(n,r,o,c,f){if(n!==null){var m=n.memoizedProps;if(uc(m,c)&&n.ref===r.ref)if(fs=!1,r.pendingProps=c=m,Om(n,f))(n.flags&131072)!==0&&(fs=!0);else return r.lanes=n.lanes,Fi(n,r,f)}return Nm(n,r,o,c,f)}function s1(n,r,o,c){var f=c.children,m=n!==null?n.memoizedState:null;if(n===null&&r.stateNode===null&&(r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),c.mode==="hidden"){if((r.flags&128)!==0){if(m=m!==null?m.baseLanes|o:o,n!==null){for(c=r.child=n.child,f=0;c!==null;)f=f|c.lanes|c.childLanes,c=c.sibling;c=f&~m}else c=0,r.child=null;return r1(n,r,m,o,c)}if((o&536870912)!==0)r.memoizedState={baseLanes:0,cachePool:null},n!==null&&ud(r,m!==null?m.cachePool:null),m!==null?av(r,m):im(),ov(r);else return c=r.lanes=536870912,r1(n,r,m!==null?m.baseLanes|o:o,o,c)}else m!==null?(ud(r,m.cachePool),av(r,m),Ta(),r.memoizedState=null):(n!==null&&ud(r,null),im(),Ta());return Os(n,r,f,o),r.child}function Tc(n,r){return n!==null&&n.tag===22||r.stateNode!==null||(r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),r.sibling}function r1(n,r,o,c,f){var m=Zf();return m=m===null?null:{parent:ds._currentValue,pool:m},r.memoizedState={baseLanes:o,cachePool:m},n!==null&&ud(r,null),im(),ov(r),n!==null&&cl(n,r,c,!0),r.childLanes=f,null}function jd(n,r){return r=Cd({mode:r.mode,children:r.children},n.mode),r.ref=n.ref,n.child=r,r.return=n,r}function i1(n,r,o){return ko(r,n.child,null,o),n=jd(r,r.pendingProps),n.flags|=2,_r(r),r.memoizedState=null,n}function ET(n,r,o){var c=r.pendingProps,f=(r.flags&128)!==0;if(r.flags&=-129,n===null){if(qt){if(c.mode==="hidden")return n=jd(r,c),r.lanes=536870912,Tc(null,n);if(om(r),(n=Dn)?(n=yb(n,Br),n=n!==null&&n.data==="&"?n:null,n!==null&&(r.memoizedState={dehydrated:n,treeContext:ya!==null?{id:vi,overflow:bi}:null,retryLane:536870912,hydrationErrors:null},o=F0(n),o.return=r,r.child=o,Ds=r,Dn=null)):n=null,n===null)throw ba(r);return r.lanes=536870912,null}return jd(r,c)}var m=n.memoizedState;if(m!==null){var x=m.dehydrated;if(om(r),f)if(r.flags&256)r.flags&=-257,r=i1(n,r,o);else if(r.memoizedState!==null)r.child=n.child,r.flags|=128,r=null;else throw Error(i(558));else if(fs||cl(n,r,o,!1),f=(o&n.childLanes)!==0,fs||f){if(c=Sn,c!==null&&(x=vn(c,o),x!==0&&x!==m.retryLane))throw m.retryLane=x,po(n,x),dr(c,n,x),Cm;Pd(),r=i1(n,r,o)}else n=m.treeContext,Dn=Fr(x.nextSibling),Ds=r,qt=!0,va=null,Br=!1,n!==null&&$0(r,n),r=jd(r,c),r.flags|=4096;return r}return n=Oi(n.child,{mode:c.mode,children:c.children}),n.ref=r.ref,r.child=n,n.return=r,n}function Sd(n,r){var o=r.ref;if(o===null)n!==null&&n.ref!==null&&(r.flags|=4194816);else{if(typeof o!="function"&&typeof o!="object")throw Error(i(284));(n===null||n.ref!==o)&&(r.flags|=4194816)}}function Nm(n,r,o,c,f){return bo(r),o=cm(n,r,o,c,void 0,f),c=um(),n!==null&&!fs?(dm(n,r,f),Fi(n,r,f)):(qt&&c&&Hf(r),r.flags|=1,Os(n,r,o,f),r.child)}function a1(n,r,o,c,f,m){return bo(r),r.updateQueue=null,o=cv(r,c,o,f),lv(n),c=um(),n!==null&&!fs?(dm(n,r,m),Fi(n,r,m)):(qt&&c&&Hf(r),r.flags|=1,Os(n,r,o,m),r.child)}function o1(n,r,o,c,f){if(bo(r),r.stateNode===null){var m=il,x=o.contextType;typeof x=="object"&&x!==null&&(m=Ls(x)),m=new o(c,m),r.memoizedState=m.state!==null&&m.state!==void 0?m.state:null,m.updater=jm,r.stateNode=m,m._reactInternals=r,m=r.stateNode,m.props=c,m.state=r.memoizedState,m.refs={},tm(r),x=o.contextType,m.context=typeof x=="object"&&x!==null?Ls(x):il,m.state=r.memoizedState,x=o.getDerivedStateFromProps,typeof x=="function"&&(Tm(r,o,x,c),m.state=r.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof m.getSnapshotBeforeUpdate=="function"||typeof m.UNSAFE_componentWillMount!="function"&&typeof m.componentWillMount!="function"||(x=m.state,typeof m.componentWillMount=="function"&&m.componentWillMount(),typeof m.UNSAFE_componentWillMount=="function"&&m.UNSAFE_componentWillMount(),x!==m.state&&jm.enqueueReplaceState(m,m.state,null),wc(r,c,m,f),bc(),m.state=r.memoizedState),typeof m.componentDidMount=="function"&&(r.flags|=4194308),c=!0}else if(n===null){m=r.stateNode;var S=r.memoizedProps,U=To(o,S);m.props=U;var ne=m.context,pe=o.contextType;x=il,typeof pe=="object"&&pe!==null&&(x=Ls(pe));var ke=o.getDerivedStateFromProps;pe=typeof ke=="function"||typeof m.getSnapshotBeforeUpdate=="function",S=r.pendingProps!==S,pe||typeof m.UNSAFE_componentWillReceiveProps!="function"&&typeof m.componentWillReceiveProps!="function"||(S||ne!==x)&&Gv(r,m,c,x),xa=!1;var ae=r.memoizedState;m.state=ae,wc(r,c,m,f),bc(),ne=r.memoizedState,S||ae!==ne||xa?(typeof ke=="function"&&(Tm(r,o,ke,c),ne=r.memoizedState),(U=xa||Wv(r,o,U,c,ae,ne,x))?(pe||typeof m.UNSAFE_componentWillMount!="function"&&typeof m.componentWillMount!="function"||(typeof m.componentWillMount=="function"&&m.componentWillMount(),typeof m.UNSAFE_componentWillMount=="function"&&m.UNSAFE_componentWillMount()),typeof m.componentDidMount=="function"&&(r.flags|=4194308)):(typeof m.componentDidMount=="function"&&(r.flags|=4194308),r.memoizedProps=c,r.memoizedState=ne),m.props=c,m.state=ne,m.context=x,c=U):(typeof m.componentDidMount=="function"&&(r.flags|=4194308),c=!1)}else{m=r.stateNode,nm(n,r),x=r.memoizedProps,pe=To(o,x),m.props=pe,ke=r.pendingProps,ae=m.context,ne=o.contextType,U=il,typeof ne=="object"&&ne!==null&&(U=Ls(ne)),S=o.getDerivedStateFromProps,(ne=typeof S=="function"||typeof m.getSnapshotBeforeUpdate=="function")||typeof m.UNSAFE_componentWillReceiveProps!="function"&&typeof m.componentWillReceiveProps!="function"||(x!==ke||ae!==U)&&Gv(r,m,c,U),xa=!1,ae=r.memoizedState,m.state=ae,wc(r,c,m,f),bc();var de=r.memoizedState;x!==ke||ae!==de||xa||n!==null&&n.dependencies!==null&&ld(n.dependencies)?(typeof S=="function"&&(Tm(r,o,S,c),de=r.memoizedState),(pe=xa||Wv(r,o,pe,c,ae,de,U)||n!==null&&n.dependencies!==null&&ld(n.dependencies))?(ne||typeof m.UNSAFE_componentWillUpdate!="function"&&typeof m.componentWillUpdate!="function"||(typeof m.componentWillUpdate=="function"&&m.componentWillUpdate(c,de,U),typeof m.UNSAFE_componentWillUpdate=="function"&&m.UNSAFE_componentWillUpdate(c,de,U)),typeof m.componentDidUpdate=="function"&&(r.flags|=4),typeof m.getSnapshotBeforeUpdate=="function"&&(r.flags|=1024)):(typeof m.componentDidUpdate!="function"||x===n.memoizedProps&&ae===n.memoizedState||(r.flags|=4),typeof m.getSnapshotBeforeUpdate!="function"||x===n.memoizedProps&&ae===n.memoizedState||(r.flags|=1024),r.memoizedProps=c,r.memoizedState=de),m.props=c,m.state=de,m.context=U,c=pe):(typeof m.componentDidUpdate!="function"||x===n.memoizedProps&&ae===n.memoizedState||(r.flags|=4),typeof m.getSnapshotBeforeUpdate!="function"||x===n.memoizedProps&&ae===n.memoizedState||(r.flags|=1024),c=!1)}return m=c,Sd(n,r),c=(r.flags&128)!==0,m||c?(m=r.stateNode,o=c&&typeof o.getDerivedStateFromError!="function"?null:m.render(),r.flags|=1,n!==null&&c?(r.child=ko(r,n.child,null,f),r.child=ko(r,null,o,f)):Os(n,r,o,f),r.memoizedState=m.state,n=r.child):n=Fi(n,r,f),n}function l1(n,r,o,c){return yo(),r.flags|=256,Os(n,r,o,c),r.child}var Am={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Rm(n){return{baseLanes:n,cachePool:X0()}}function Im(n,r,o){return n=n!==null?n.childLanes&~o:0,r&&(n|=Er),n}function c1(n,r,o){var c=r.pendingProps,f=!1,m=(r.flags&128)!==0,x;if((x=m)||(x=n!==null&&n.memoizedState===null?!1:(is.current&2)!==0),x&&(f=!0,r.flags&=-129),x=(r.flags&32)!==0,r.flags&=-33,n===null){if(qt){if(f?Ea(r):Ta(),(n=Dn)?(n=yb(n,Br),n=n!==null&&n.data!=="&"?n:null,n!==null&&(r.memoizedState={dehydrated:n,treeContext:ya!==null?{id:vi,overflow:bi}:null,retryLane:536870912,hydrationErrors:null},o=F0(n),o.return=r,r.child=o,Ds=r,Dn=null)):n=null,n===null)throw ba(r);return mp(n)?r.lanes=32:r.lanes=536870912,null}var S=c.children;return c=c.fallback,f?(Ta(),f=r.mode,S=Cd({mode:"hidden",children:S},f),c=go(c,f,o,null),S.return=r,c.return=r,S.sibling=c,r.child=S,c=r.child,c.memoizedState=Rm(o),c.childLanes=Im(n,x,o),r.memoizedState=Am,Tc(null,c)):(Ea(r),Mm(r,S))}var U=n.memoizedState;if(U!==null&&(S=U.dehydrated,S!==null)){if(m)r.flags&256?(Ea(r),r.flags&=-257,r=Dm(n,r,o)):r.memoizedState!==null?(Ta(),r.child=n.child,r.flags|=128,r=null):(Ta(),S=c.fallback,f=r.mode,c=Cd({mode:"visible",children:c.children},f),S=go(S,f,o,null),S.flags|=2,c.return=r,S.return=r,c.sibling=S,r.child=c,ko(r,n.child,null,o),c=r.child,c.memoizedState=Rm(o),c.childLanes=Im(n,x,o),r.memoizedState=Am,r=Tc(null,c));else if(Ea(r),mp(S)){if(x=S.nextSibling&&S.nextSibling.dataset,x)var ne=x.dgst;x=ne,c=Error(i(419)),c.stack="",c.digest=x,fc({value:c,source:null,stack:null}),r=Dm(n,r,o)}else if(fs||cl(n,r,o,!1),x=(o&n.childLanes)!==0,fs||x){if(x=Sn,x!==null&&(c=vn(x,o),c!==0&&c!==U.retryLane))throw U.retryLane=c,po(n,c),dr(x,n,c),Cm;fp(S)||Pd(),r=Dm(n,r,o)}else fp(S)?(r.flags|=192,r.child=n.child,r=null):(n=U.treeContext,Dn=Fr(S.nextSibling),Ds=r,qt=!0,va=null,Br=!1,n!==null&&$0(r,n),r=Mm(r,c.children),r.flags|=4096);return r}return f?(Ta(),S=c.fallback,f=r.mode,U=n.child,ne=U.sibling,c=Oi(U,{mode:"hidden",children:c.children}),c.subtreeFlags=U.subtreeFlags&65011712,ne!==null?S=Oi(ne,S):(S=go(S,f,o,null),S.flags|=2),S.return=r,c.return=r,c.sibling=S,r.child=c,Tc(null,c),c=r.child,S=n.child.memoizedState,S===null?S=Rm(o):(f=S.cachePool,f!==null?(U=ds._currentValue,f=f.parent!==U?{parent:U,pool:U}:f):f=X0(),S={baseLanes:S.baseLanes|o,cachePool:f}),c.memoizedState=S,c.childLanes=Im(n,x,o),r.memoizedState=Am,Tc(n.child,c)):(Ea(r),o=n.child,n=o.sibling,o=Oi(o,{mode:"visible",children:c.children}),o.return=r,o.sibling=null,n!==null&&(x=r.deletions,x===null?(r.deletions=[n],r.flags|=16):x.push(n)),r.child=o,r.memoizedState=null,o)}function Mm(n,r){return r=Cd({mode:"visible",children:r},n.mode),r.return=n,n.child=r}function Cd(n,r){return n=wr(22,n,null,r),n.lanes=0,n}function Dm(n,r,o){return ko(r,n.child,null,o),n=Mm(r,r.pendingProps.children),n.flags|=2,r.memoizedState=null,n}function u1(n,r,o){n.lanes|=r;var c=n.alternate;c!==null&&(c.lanes|=r),Yf(n.return,r,o)}function Lm(n,r,o,c,f,m){var x=n.memoizedState;x===null?n.memoizedState={isBackwards:r,rendering:null,renderingStartTime:0,last:c,tail:o,tailMode:f,treeForkCount:m}:(x.isBackwards=r,x.rendering=null,x.renderingStartTime=0,x.last=c,x.tail=o,x.tailMode=f,x.treeForkCount=m)}function d1(n,r,o){var c=r.pendingProps,f=c.revealOrder,m=c.tail;c=c.children;var x=is.current,S=(x&2)!==0;if(S?(x=x&1|2,r.flags|=128):x&=1,we(is,x),Os(n,r,c,o),c=qt?hc:0,!S&&n!==null&&(n.flags&128)!==0)e:for(n=r.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&u1(n,o,r);else if(n.tag===19)u1(n,o,r);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===r)break e;for(;n.sibling===null;){if(n.return===null||n.return===r)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}switch(f){case"forwards":for(o=r.child,f=null;o!==null;)n=o.alternate,n!==null&&gd(n)===null&&(f=o),o=o.sibling;o=f,o===null?(f=r.child,r.child=null):(f=o.sibling,o.sibling=null),Lm(r,!1,f,o,m,c);break;case"backwards":case"unstable_legacy-backwards":for(o=null,f=r.child,r.child=null;f!==null;){if(n=f.alternate,n!==null&&gd(n)===null){r.child=f;break}n=f.sibling,f.sibling=o,o=f,f=n}Lm(r,!0,o,null,m,c);break;case"together":Lm(r,!1,null,null,void 0,c);break;default:r.memoizedState=null}return r.child}function Fi(n,r,o){if(n!==null&&(r.dependencies=n.dependencies),Ca|=r.lanes,(o&r.childLanes)===0)if(n!==null){if(cl(n,r,o,!1),(o&r.childLanes)===0)return null}else return null;if(n!==null&&r.child!==n.child)throw Error(i(153));if(r.child!==null){for(n=r.child,o=Oi(n,n.pendingProps),r.child=o,o.return=r;n.sibling!==null;)n=n.sibling,o=o.sibling=Oi(n,n.pendingProps),o.return=r;o.sibling=null}return r.child}function Om(n,r){return(n.lanes&r)!==0?!0:(n=n.dependencies,!!(n!==null&&ld(n)))}function TT(n,r,o){switch(r.tag){case 3:Ze(r,r.stateNode.containerInfo),wa(r,ds,n.memoizedState.cache),yo();break;case 27:case 5:Mt(r);break;case 4:Ze(r,r.stateNode.containerInfo);break;case 10:wa(r,r.type,r.memoizedProps.value);break;case 31:if(r.memoizedState!==null)return r.flags|=128,om(r),null;break;case 13:var c=r.memoizedState;if(c!==null)return c.dehydrated!==null?(Ea(r),r.flags|=128,null):(o&r.child.childLanes)!==0?c1(n,r,o):(Ea(r),n=Fi(n,r,o),n!==null?n.sibling:null);Ea(r);break;case 19:var f=(n.flags&128)!==0;if(c=(o&r.childLanes)!==0,c||(cl(n,r,o,!1),c=(o&r.childLanes)!==0),f){if(c)return d1(n,r,o);r.flags|=128}if(f=r.memoizedState,f!==null&&(f.rendering=null,f.tail=null,f.lastEffect=null),we(is,is.current),c)break;return null;case 22:return r.lanes=0,s1(n,r,o,r.pendingProps);case 24:wa(r,ds,n.memoizedState.cache)}return Fi(n,r,o)}function h1(n,r,o){if(n!==null)if(n.memoizedProps!==r.pendingProps)fs=!0;else{if(!Om(n,o)&&(r.flags&128)===0)return fs=!1,TT(n,r,o);fs=(n.flags&131072)!==0}else fs=!1,qt&&(r.flags&1048576)!==0&&H0(r,hc,r.index);switch(r.lanes=0,r.tag){case 16:e:{var c=r.pendingProps;if(n=xo(r.elementType),r.type=n,typeof n=="function")zf(n)?(c=To(n,c),r.tag=1,r=o1(null,r,n,c,o)):(r.tag=0,r=Nm(null,r,n,c,o));else{if(n!=null){var f=n.$$typeof;if(f===he){r.tag=11,r=e1(null,r,n,c,o);break e}else if(f===C){r.tag=14,r=t1(null,r,n,c,o);break e}}throw r=Le(n)||n,Error(i(306,r,""))}}return r;case 0:return Nm(n,r,r.type,r.pendingProps,o);case 1:return c=r.type,f=To(c,r.pendingProps),o1(n,r,c,f,o);case 3:e:{if(Ze(r,r.stateNode.containerInfo),n===null)throw Error(i(387));c=r.pendingProps;var m=r.memoizedState;f=m.element,nm(n,r),wc(r,c,null,o);var x=r.memoizedState;if(c=x.cache,wa(r,ds,c),c!==m.cache&&Qf(r,[ds],o,!0),bc(),c=x.element,m.isDehydrated)if(m={element:c,isDehydrated:!1,cache:x.cache},r.updateQueue.baseState=m,r.memoizedState=m,r.flags&256){r=l1(n,r,c,o);break e}else if(c!==f){f=Pr(Error(i(424)),r),fc(f),r=l1(n,r,c,o);break e}else for(n=r.stateNode.containerInfo,n.nodeType===9?n=n.body:n=n.nodeName==="HTML"?n.ownerDocument.body:n,Dn=Fr(n.firstChild),Ds=r,qt=!0,va=null,Br=!0,o=sv(r,null,c,o),r.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling;else{if(yo(),c===f){r=Fi(n,r,o);break e}Os(n,r,c,o)}r=r.child}return r;case 26:return Sd(n,r),n===null?(o=kb(r.type,null,r.pendingProps,null))?r.memoizedState=o:qt||(o=r.type,n=r.pendingProps,c=Hd(Se.current).createElement(o),c[en]=r,c[un]=n,Ps(c,o,n),Ft(c),r.stateNode=c):r.memoizedState=kb(r.type,n.memoizedProps,r.pendingProps,n.memoizedState),null;case 27:return Mt(r),n===null&&qt&&(c=r.stateNode=wb(r.type,r.pendingProps,Se.current),Ds=r,Br=!0,f=Dn,Ma(r.type)?(pp=f,Dn=Fr(c.firstChild)):Dn=f),Os(n,r,r.pendingProps.children,o),Sd(n,r),n===null&&(r.flags|=4194304),r.child;case 5:return n===null&&qt&&((f=c=Dn)&&(c=tj(c,r.type,r.pendingProps,Br),c!==null?(r.stateNode=c,Ds=r,Dn=Fr(c.firstChild),Br=!1,f=!0):f=!1),f||ba(r)),Mt(r),f=r.type,m=r.pendingProps,x=n!==null?n.memoizedProps:null,c=m.children,up(f,m)?c=null:x!==null&&up(f,x)&&(r.flags|=32),r.memoizedState!==null&&(f=cm(n,r,gT,null,null,o),Bc._currentValue=f),Sd(n,r),Os(n,r,c,o),r.child;case 6:return n===null&&qt&&((n=o=Dn)&&(o=nj(o,r.pendingProps,Br),o!==null?(r.stateNode=o,Ds=r,Dn=null,n=!0):n=!1),n||ba(r)),null;case 13:return c1(n,r,o);case 4:return Ze(r,r.stateNode.containerInfo),c=r.pendingProps,n===null?r.child=ko(r,null,c,o):Os(n,r,c,o),r.child;case 11:return e1(n,r,r.type,r.pendingProps,o);case 7:return Os(n,r,r.pendingProps,o),r.child;case 8:return Os(n,r,r.pendingProps.children,o),r.child;case 12:return Os(n,r,r.pendingProps.children,o),r.child;case 10:return c=r.pendingProps,wa(r,r.type,c.value),Os(n,r,c.children,o),r.child;case 9:return f=r.type._context,c=r.pendingProps.children,bo(r),f=Ls(f),c=c(f),r.flags|=1,Os(n,r,c,o),r.child;case 14:return t1(n,r,r.type,r.pendingProps,o);case 15:return n1(n,r,r.type,r.pendingProps,o);case 19:return d1(n,r,o);case 31:return ET(n,r,o);case 22:return s1(n,r,o,r.pendingProps);case 24:return bo(r),c=Ls(ds),n===null?(f=Zf(),f===null&&(f=Sn,m=Xf(),f.pooledCache=m,m.refCount++,m!==null&&(f.pooledCacheLanes|=o),f=m),r.memoizedState={parent:c,cache:f},tm(r),wa(r,ds,f)):((n.lanes&o)!==0&&(nm(n,r),wc(r,null,null,o),bc()),f=n.memoizedState,m=r.memoizedState,f.parent!==c?(f={parent:c,cache:c},r.memoizedState=f,r.lanes===0&&(r.memoizedState=r.updateQueue.baseState=f),wa(r,ds,c)):(c=m.cache,wa(r,ds,c),c!==f.cache&&Qf(r,[ds],o,!0))),Os(n,r,r.pendingProps.children,o),r.child;case 29:throw r.pendingProps}throw Error(i(156,r.tag))}function qi(n){n.flags|=4}function Pm(n,r,o,c,f){if((r=(n.mode&32)!==0)&&(r=!1),r){if(n.flags|=16777216,(f&335544128)===f)if(n.stateNode.complete)n.flags|=8192;else if(U1())n.flags|=8192;else throw _o=hd,em}else n.flags&=-16777217}function f1(n,r){if(r.type!=="stylesheet"||(r.state.loading&4)!==0)n.flags&=-16777217;else if(n.flags|=16777216,!Cb(r))if(U1())n.flags|=8192;else throw _o=hd,em}function Nd(n,r){r!==null&&(n.flags|=4),n.flags&16384&&(r=n.tag!==22?le():536870912,n.lanes|=r,xl|=r)}function jc(n,r){if(!qt)switch(n.tailMode){case"hidden":r=n.tail;for(var o=null;r!==null;)r.alternate!==null&&(o=r),r=r.sibling;o===null?n.tail=null:o.sibling=null;break;case"collapsed":o=n.tail;for(var c=null;o!==null;)o.alternate!==null&&(c=o),o=o.sibling;c===null?r||n.tail===null?n.tail=null:n.tail.sibling=null:c.sibling=null}}function Ln(n){var r=n.alternate!==null&&n.alternate.child===n.child,o=0,c=0;if(r)for(var f=n.child;f!==null;)o|=f.lanes|f.childLanes,c|=f.subtreeFlags&65011712,c|=f.flags&65011712,f.return=n,f=f.sibling;else for(f=n.child;f!==null;)o|=f.lanes|f.childLanes,c|=f.subtreeFlags,c|=f.flags,f.return=n,f=f.sibling;return n.subtreeFlags|=c,n.childLanes=o,r}function jT(n,r,o){var c=r.pendingProps;switch($f(r),r.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ln(r),null;case 1:return Ln(r),null;case 3:return o=r.stateNode,c=null,n!==null&&(c=n.memoizedState.cache),r.memoizedState.cache!==c&&(r.flags|=2048),Ui(ds),Oe(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(n===null||n.child===null)&&(ll(r)?qi(r):n===null||n.memoizedState.isDehydrated&&(r.flags&256)===0||(r.flags|=1024,Gf())),Ln(r),null;case 26:var f=r.type,m=r.memoizedState;return n===null?(qi(r),m!==null?(Ln(r),f1(r,m)):(Ln(r),Pm(r,f,null,c,o))):m?m!==n.memoizedState?(qi(r),Ln(r),f1(r,m)):(Ln(r),r.flags&=-16777217):(n=n.memoizedProps,n!==c&&qi(r),Ln(r),Pm(r,f,n,c,o)),null;case 27:if(cn(r),o=Se.current,f=r.type,n!==null&&r.stateNode!=null)n.memoizedProps!==c&&qi(r);else{if(!c){if(r.stateNode===null)throw Error(i(166));return Ln(r),null}n=_e.current,ll(r)?W0(r):(n=wb(f,c,o),r.stateNode=n,qi(r))}return Ln(r),null;case 5:if(cn(r),f=r.type,n!==null&&r.stateNode!=null)n.memoizedProps!==c&&qi(r);else{if(!c){if(r.stateNode===null)throw Error(i(166));return Ln(r),null}if(m=_e.current,ll(r))W0(r);else{var x=Hd(Se.current);switch(m){case 1:m=x.createElementNS("http://www.w3.org/2000/svg",f);break;case 2:m=x.createElementNS("http://www.w3.org/1998/Math/MathML",f);break;default:switch(f){case"svg":m=x.createElementNS("http://www.w3.org/2000/svg",f);break;case"math":m=x.createElementNS("http://www.w3.org/1998/Math/MathML",f);break;case"script":m=x.createElement("div"),m.innerHTML="<script><\/script>",m=m.removeChild(m.firstChild);break;case"select":m=typeof c.is=="string"?x.createElement("select",{is:c.is}):x.createElement("select"),c.multiple?m.multiple=!0:c.size&&(m.size=c.size);break;default:m=typeof c.is=="string"?x.createElement(f,{is:c.is}):x.createElement(f)}}m[en]=r,m[un]=c;e:for(x=r.child;x!==null;){if(x.tag===5||x.tag===6)m.appendChild(x.stateNode);else if(x.tag!==4&&x.tag!==27&&x.child!==null){x.child.return=x,x=x.child;continue}if(x===r)break e;for(;x.sibling===null;){if(x.return===null||x.return===r)break e;x=x.return}x.sibling.return=x.return,x=x.sibling}r.stateNode=m;e:switch(Ps(m,f,c),f){case"button":case"input":case"select":case"textarea":c=!!c.autoFocus;break e;case"img":c=!0;break e;default:c=!1}c&&qi(r)}}return Ln(r),Pm(r,r.type,n===null?null:n.memoizedProps,r.pendingProps,o),null;case 6:if(n&&r.stateNode!=null)n.memoizedProps!==c&&qi(r);else{if(typeof c!="string"&&r.stateNode===null)throw Error(i(166));if(n=Se.current,ll(r)){if(n=r.stateNode,o=r.memoizedProps,c=null,f=Ds,f!==null)switch(f.tag){case 27:case 5:c=f.memoizedProps}n[en]=r,n=!!(n.nodeValue===o||c!==null&&c.suppressHydrationWarning===!0||cb(n.nodeValue,o)),n||ba(r,!0)}else n=Hd(n).createTextNode(c),n[en]=r,r.stateNode=n}return Ln(r),null;case 31:if(o=r.memoizedState,n===null||n.memoizedState!==null){if(c=ll(r),o!==null){if(n===null){if(!c)throw Error(i(318));if(n=r.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(i(557));n[en]=r}else yo(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;Ln(r),n=!1}else o=Gf(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=o),n=!0;if(!n)return r.flags&256?(_r(r),r):(_r(r),null);if((r.flags&128)!==0)throw Error(i(558))}return Ln(r),null;case 13:if(c=r.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(f=ll(r),c!==null&&c.dehydrated!==null){if(n===null){if(!f)throw Error(i(318));if(f=r.memoizedState,f=f!==null?f.dehydrated:null,!f)throw Error(i(317));f[en]=r}else yo(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;Ln(r),f=!1}else f=Gf(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=f),f=!0;if(!f)return r.flags&256?(_r(r),r):(_r(r),null)}return _r(r),(r.flags&128)!==0?(r.lanes=o,r):(o=c!==null,n=n!==null&&n.memoizedState!==null,o&&(c=r.child,f=null,c.alternate!==null&&c.alternate.memoizedState!==null&&c.alternate.memoizedState.cachePool!==null&&(f=c.alternate.memoizedState.cachePool.pool),m=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(m=c.memoizedState.cachePool.pool),m!==f&&(c.flags|=2048)),o!==n&&o&&(r.child.flags|=8192),Nd(r,r.updateQueue),Ln(r),null);case 4:return Oe(),n===null&&ip(r.stateNode.containerInfo),Ln(r),null;case 10:return Ui(r.type),Ln(r),null;case 19:if(re(is),c=r.memoizedState,c===null)return Ln(r),null;if(f=(r.flags&128)!==0,m=c.rendering,m===null)if(f)jc(c,!1);else{if(Qn!==0||n!==null&&(n.flags&128)!==0)for(n=r.child;n!==null;){if(m=gd(n),m!==null){for(r.flags|=128,jc(c,!1),n=m.updateQueue,r.updateQueue=n,Nd(r,n),r.subtreeFlags=0,n=o,o=r.child;o!==null;)z0(o,n),o=o.sibling;return we(is,is.current&1|2),qt&&Pi(r,c.treeForkCount),r.child}n=n.sibling}c.tail!==null&&pt()>Dd&&(r.flags|=128,f=!0,jc(c,!1),r.lanes=4194304)}else{if(!f)if(n=gd(m),n!==null){if(r.flags|=128,f=!0,n=n.updateQueue,r.updateQueue=n,Nd(r,n),jc(c,!0),c.tail===null&&c.tailMode==="hidden"&&!m.alternate&&!qt)return Ln(r),null}else 2*pt()-c.renderingStartTime>Dd&&o!==536870912&&(r.flags|=128,f=!0,jc(c,!1),r.lanes=4194304);c.isBackwards?(m.sibling=r.child,r.child=m):(n=c.last,n!==null?n.sibling=m:r.child=m,c.last=m)}return c.tail!==null?(n=c.tail,c.rendering=n,c.tail=n.sibling,c.renderingStartTime=pt(),n.sibling=null,o=is.current,we(is,f?o&1|2:o&1),qt&&Pi(r,c.treeForkCount),n):(Ln(r),null);case 22:case 23:return _r(r),am(),c=r.memoizedState!==null,n!==null?n.memoizedState!==null!==c&&(r.flags|=8192):c&&(r.flags|=8192),c?(o&536870912)!==0&&(r.flags&128)===0&&(Ln(r),r.subtreeFlags&6&&(r.flags|=8192)):Ln(r),o=r.updateQueue,o!==null&&Nd(r,o.retryQueue),o=null,n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(o=n.memoizedState.cachePool.pool),c=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(c=r.memoizedState.cachePool.pool),c!==o&&(r.flags|=2048),n!==null&&re(wo),null;case 24:return o=null,n!==null&&(o=n.memoizedState.cache),r.memoizedState.cache!==o&&(r.flags|=2048),Ui(ds),Ln(r),null;case 25:return null;case 30:return null}throw Error(i(156,r.tag))}function ST(n,r){switch($f(r),r.tag){case 1:return n=r.flags,n&65536?(r.flags=n&-65537|128,r):null;case 3:return Ui(ds),Oe(),n=r.flags,(n&65536)!==0&&(n&128)===0?(r.flags=n&-65537|128,r):null;case 26:case 27:case 5:return cn(r),null;case 31:if(r.memoizedState!==null){if(_r(r),r.alternate===null)throw Error(i(340));yo()}return n=r.flags,n&65536?(r.flags=n&-65537|128,r):null;case 13:if(_r(r),n=r.memoizedState,n!==null&&n.dehydrated!==null){if(r.alternate===null)throw Error(i(340));yo()}return n=r.flags,n&65536?(r.flags=n&-65537|128,r):null;case 19:return re(is),null;case 4:return Oe(),null;case 10:return Ui(r.type),null;case 22:case 23:return _r(r),am(),n!==null&&re(wo),n=r.flags,n&65536?(r.flags=n&-65537|128,r):null;case 24:return Ui(ds),null;case 25:return null;default:return null}}function m1(n,r){switch($f(r),r.tag){case 3:Ui(ds),Oe();break;case 26:case 27:case 5:cn(r);break;case 4:Oe();break;case 31:r.memoizedState!==null&&_r(r);break;case 13:_r(r);break;case 19:re(is);break;case 10:Ui(r.type);break;case 22:case 23:_r(r),am(),n!==null&&re(wo);break;case 24:Ui(ds)}}function Sc(n,r){try{var o=r.updateQueue,c=o!==null?o.lastEffect:null;if(c!==null){var f=c.next;o=f;do{if((o.tag&n)===n){c=void 0;var m=o.create,x=o.inst;c=m(),x.destroy=c}o=o.next}while(o!==f)}}catch(S){gn(r,r.return,S)}}function ja(n,r,o){try{var c=r.updateQueue,f=c!==null?c.lastEffect:null;if(f!==null){var m=f.next;c=m;do{if((c.tag&n)===n){var x=c.inst,S=x.destroy;if(S!==void 0){x.destroy=void 0,f=r;var U=o,ne=S;try{ne()}catch(pe){gn(f,U,pe)}}}c=c.next}while(c!==m)}}catch(pe){gn(r,r.return,pe)}}function p1(n){var r=n.updateQueue;if(r!==null){var o=n.stateNode;try{iv(r,o)}catch(c){gn(n,n.return,c)}}}function g1(n,r,o){o.props=To(n.type,n.memoizedProps),o.state=n.memoizedState;try{o.componentWillUnmount()}catch(c){gn(n,r,c)}}function Cc(n,r){try{var o=n.ref;if(o!==null){switch(n.tag){case 26:case 27:case 5:var c=n.stateNode;break;case 30:c=n.stateNode;break;default:c=n.stateNode}typeof o=="function"?n.refCleanup=o(c):o.current=c}}catch(f){gn(n,r,f)}}function wi(n,r){var o=n.ref,c=n.refCleanup;if(o!==null)if(typeof c=="function")try{c()}catch(f){gn(n,r,f)}finally{n.refCleanup=null,n=n.alternate,n!=null&&(n.refCleanup=null)}else if(typeof o=="function")try{o(null)}catch(f){gn(n,r,f)}else o.current=null}function y1(n){var r=n.type,o=n.memoizedProps,c=n.stateNode;try{e:switch(r){case"button":case"input":case"select":case"textarea":o.autoFocus&&c.focus();break e;case"img":o.src?c.src=o.src:o.srcSet&&(c.srcset=o.srcSet)}}catch(f){gn(n,n.return,f)}}function Vm(n,r,o){try{var c=n.stateNode;YT(c,n.type,o,r),c[un]=r}catch(f){gn(n,n.return,f)}}function v1(n){return n.tag===5||n.tag===3||n.tag===26||n.tag===27&&Ma(n.type)||n.tag===4}function Um(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||v1(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.tag===27&&Ma(n.type)||n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function Bm(n,r,o){var c=n.tag;if(c===5||c===6)n=n.stateNode,r?(o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o).insertBefore(n,r):(r=o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o,r.appendChild(n),o=o._reactRootContainer,o!=null||r.onclick!==null||(r.onclick=ss));else if(c!==4&&(c===27&&Ma(n.type)&&(o=n.stateNode,r=null),n=n.child,n!==null))for(Bm(n,r,o),n=n.sibling;n!==null;)Bm(n,r,o),n=n.sibling}function Ad(n,r,o){var c=n.tag;if(c===5||c===6)n=n.stateNode,r?o.insertBefore(n,r):o.appendChild(n);else if(c!==4&&(c===27&&Ma(n.type)&&(o=n.stateNode),n=n.child,n!==null))for(Ad(n,r,o),n=n.sibling;n!==null;)Ad(n,r,o),n=n.sibling}function b1(n){var r=n.stateNode,o=n.memoizedProps;try{for(var c=n.type,f=r.attributes;f.length;)r.removeAttributeNode(f[0]);Ps(r,c,o),r[en]=n,r[un]=o}catch(m){gn(n,n.return,m)}}var Hi=!1,ms=!1,zm=!1,w1=typeof WeakSet=="function"?WeakSet:Set,Ns=null;function CT(n,r){if(n=n.containerInfo,lp=Xd,n=I0(n),Df(n)){if("selectionStart"in n)var o={start:n.selectionStart,end:n.selectionEnd};else e:{o=(o=n.ownerDocument)&&o.defaultView||window;var c=o.getSelection&&o.getSelection();if(c&&c.rangeCount!==0){o=c.anchorNode;var f=c.anchorOffset,m=c.focusNode;c=c.focusOffset;try{o.nodeType,m.nodeType}catch{o=null;break e}var x=0,S=-1,U=-1,ne=0,pe=0,ke=n,ae=null;t:for(;;){for(var de;ke!==o||f!==0&&ke.nodeType!==3||(S=x+f),ke!==m||c!==0&&ke.nodeType!==3||(U=x+c),ke.nodeType===3&&(x+=ke.nodeValue.length),(de=ke.firstChild)!==null;)ae=ke,ke=de;for(;;){if(ke===n)break t;if(ae===o&&++ne===f&&(S=x),ae===m&&++pe===c&&(U=x),(de=ke.nextSibling)!==null)break;ke=ae,ae=ke.parentNode}ke=de}o=S===-1||U===-1?null:{start:S,end:U}}else o=null}o=o||{start:0,end:0}}else o=null;for(cp={focusedElem:n,selectionRange:o},Xd=!1,Ns=r;Ns!==null;)if(r=Ns,n=r.child,(r.subtreeFlags&1028)!==0&&n!==null)n.return=r,Ns=n;else for(;Ns!==null;){switch(r=Ns,m=r.alternate,n=r.flags,r.tag){case 0:if((n&4)!==0&&(n=r.updateQueue,n=n!==null?n.events:null,n!==null))for(o=0;o<n.length;o++)f=n[o],f.ref.impl=f.nextImpl;break;case 11:case 15:break;case 1:if((n&1024)!==0&&m!==null){n=void 0,o=r,f=m.memoizedProps,m=m.memoizedState,c=o.stateNode;try{var Xe=To(o.type,f);n=c.getSnapshotBeforeUpdate(Xe,m),c.__reactInternalSnapshotBeforeUpdate=n}catch(mt){gn(o,o.return,mt)}}break;case 3:if((n&1024)!==0){if(n=r.stateNode.containerInfo,o=n.nodeType,o===9)hp(n);else if(o===1)switch(n.nodeName){case"HEAD":case"HTML":case"BODY":hp(n);break;default:n.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((n&1024)!==0)throw Error(i(163))}if(n=r.sibling,n!==null){n.return=r.return,Ns=n;break}Ns=r.return}}function x1(n,r,o){var c=o.flags;switch(o.tag){case 0:case 11:case 15:Wi(n,o),c&4&&Sc(5,o);break;case 1:if(Wi(n,o),c&4)if(n=o.stateNode,r===null)try{n.componentDidMount()}catch(x){gn(o,o.return,x)}else{var f=To(o.type,r.memoizedProps);r=r.memoizedState;try{n.componentDidUpdate(f,r,n.__reactInternalSnapshotBeforeUpdate)}catch(x){gn(o,o.return,x)}}c&64&&p1(o),c&512&&Cc(o,o.return);break;case 3:if(Wi(n,o),c&64&&(n=o.updateQueue,n!==null)){if(r=null,o.child!==null)switch(o.child.tag){case 27:case 5:r=o.child.stateNode;break;case 1:r=o.child.stateNode}try{iv(n,r)}catch(x){gn(o,o.return,x)}}break;case 27:r===null&&c&4&&b1(o);case 26:case 5:Wi(n,o),r===null&&c&4&&y1(o),c&512&&Cc(o,o.return);break;case 12:Wi(n,o);break;case 31:Wi(n,o),c&4&&E1(n,o);break;case 13:Wi(n,o),c&4&&T1(n,o),c&64&&(n=o.memoizedState,n!==null&&(n=n.dehydrated,n!==null&&(o=PT.bind(null,o),sj(n,o))));break;case 22:if(c=o.memoizedState!==null||Hi,!c){r=r!==null&&r.memoizedState!==null||ms,f=Hi;var m=ms;Hi=c,(ms=r)&&!m?Gi(n,o,(o.subtreeFlags&8772)!==0):Wi(n,o),Hi=f,ms=m}break;case 30:break;default:Wi(n,o)}}function _1(n){var r=n.alternate;r!==null&&(n.alternate=null,_1(r)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(r=n.stateNode,r!==null&&Fs(r)),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}var zn=null,or=!1;function $i(n,r,o){for(o=o.child;o!==null;)k1(n,r,o),o=o.sibling}function k1(n,r,o){if(He&&typeof He.onCommitFiberUnmount=="function")try{He.onCommitFiberUnmount(ut,o)}catch{}switch(o.tag){case 26:ms||wi(o,r),$i(n,r,o),o.memoizedState?o.memoizedState.count--:o.stateNode&&(o=o.stateNode,o.parentNode.removeChild(o));break;case 27:ms||wi(o,r);var c=zn,f=or;Ma(o.type)&&(zn=o.stateNode,or=!1),$i(n,r,o),Pc(o.stateNode),zn=c,or=f;break;case 5:ms||wi(o,r);case 6:if(c=zn,f=or,zn=null,$i(n,r,o),zn=c,or=f,zn!==null)if(or)try{(zn.nodeType===9?zn.body:zn.nodeName==="HTML"?zn.ownerDocument.body:zn).removeChild(o.stateNode)}catch(m){gn(o,r,m)}else try{zn.removeChild(o.stateNode)}catch(m){gn(o,r,m)}break;case 18:zn!==null&&(or?(n=zn,pb(n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n,o.stateNode),Nl(n)):pb(zn,o.stateNode));break;case 4:c=zn,f=or,zn=o.stateNode.containerInfo,or=!0,$i(n,r,o),zn=c,or=f;break;case 0:case 11:case 14:case 15:ja(2,o,r),ms||ja(4,o,r),$i(n,r,o);break;case 1:ms||(wi(o,r),c=o.stateNode,typeof c.componentWillUnmount=="function"&&g1(o,r,c)),$i(n,r,o);break;case 21:$i(n,r,o);break;case 22:ms=(c=ms)||o.memoizedState!==null,$i(n,r,o),ms=c;break;default:$i(n,r,o)}}function E1(n,r){if(r.memoizedState===null&&(n=r.alternate,n!==null&&(n=n.memoizedState,n!==null))){n=n.dehydrated;try{Nl(n)}catch(o){gn(r,r.return,o)}}}function T1(n,r){if(r.memoizedState===null&&(n=r.alternate,n!==null&&(n=n.memoizedState,n!==null&&(n=n.dehydrated,n!==null))))try{Nl(n)}catch(o){gn(r,r.return,o)}}function NT(n){switch(n.tag){case 31:case 13:case 19:var r=n.stateNode;return r===null&&(r=n.stateNode=new w1),r;case 22:return n=n.stateNode,r=n._retryCache,r===null&&(r=n._retryCache=new w1),r;default:throw Error(i(435,n.tag))}}function Rd(n,r){var o=NT(n);r.forEach(function(c){if(!o.has(c)){o.add(c);var f=VT.bind(null,n,c);c.then(f,f)}})}function lr(n,r){var o=r.deletions;if(o!==null)for(var c=0;c<o.length;c++){var f=o[c],m=n,x=r,S=x;e:for(;S!==null;){switch(S.tag){case 27:if(Ma(S.type)){zn=S.stateNode,or=!1;break e}break;case 5:zn=S.stateNode,or=!1;break e;case 3:case 4:zn=S.stateNode.containerInfo,or=!0;break e}S=S.return}if(zn===null)throw Error(i(160));k1(m,x,f),zn=null,or=!1,m=f.alternate,m!==null&&(m.return=null),f.return=null}if(r.subtreeFlags&13886)for(r=r.child;r!==null;)j1(r,n),r=r.sibling}var ri=null;function j1(n,r){var o=n.alternate,c=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:lr(r,n),cr(n),c&4&&(ja(3,n,n.return),Sc(3,n),ja(5,n,n.return));break;case 1:lr(r,n),cr(n),c&512&&(ms||o===null||wi(o,o.return)),c&64&&Hi&&(n=n.updateQueue,n!==null&&(c=n.callbacks,c!==null&&(o=n.shared.hiddenCallbacks,n.shared.hiddenCallbacks=o===null?c:o.concat(c))));break;case 26:var f=ri;if(lr(r,n),cr(n),c&512&&(ms||o===null||wi(o,o.return)),c&4){var m=o!==null?o.memoizedState:null;if(c=n.memoizedState,o===null)if(c===null)if(n.stateNode===null){e:{c=n.type,o=n.memoizedProps,f=f.ownerDocument||f;t:switch(c){case"title":m=f.getElementsByTagName("title")[0],(!m||m[$n]||m[en]||m.namespaceURI==="http://www.w3.org/2000/svg"||m.hasAttribute("itemprop"))&&(m=f.createElement(c),f.head.insertBefore(m,f.querySelector("head > title"))),Ps(m,c,o),m[en]=n,Ft(m),c=m;break e;case"link":var x=jb("link","href",f).get(c+(o.href||""));if(x){for(var S=0;S<x.length;S++)if(m=x[S],m.getAttribute("href")===(o.href==null||o.href===""?null:o.href)&&m.getAttribute("rel")===(o.rel==null?null:o.rel)&&m.getAttribute("title")===(o.title==null?null:o.title)&&m.getAttribute("crossorigin")===(o.crossOrigin==null?null:o.crossOrigin)){x.splice(S,1);break t}}m=f.createElement(c),Ps(m,c,o),f.head.appendChild(m);break;case"meta":if(x=jb("meta","content",f).get(c+(o.content||""))){for(S=0;S<x.length;S++)if(m=x[S],m.getAttribute("content")===(o.content==null?null:""+o.content)&&m.getAttribute("name")===(o.name==null?null:o.name)&&m.getAttribute("property")===(o.property==null?null:o.property)&&m.getAttribute("http-equiv")===(o.httpEquiv==null?null:o.httpEquiv)&&m.getAttribute("charset")===(o.charSet==null?null:o.charSet)){x.splice(S,1);break t}}m=f.createElement(c),Ps(m,c,o),f.head.appendChild(m);break;default:throw Error(i(468,c))}m[en]=n,Ft(m),c=m}n.stateNode=c}else Sb(f,n.type,n.stateNode);else n.stateNode=Tb(f,c,n.memoizedProps);else m!==c?(m===null?o.stateNode!==null&&(o=o.stateNode,o.parentNode.removeChild(o)):m.count--,c===null?Sb(f,n.type,n.stateNode):Tb(f,c,n.memoizedProps)):c===null&&n.stateNode!==null&&Vm(n,n.memoizedProps,o.memoizedProps)}break;case 27:lr(r,n),cr(n),c&512&&(ms||o===null||wi(o,o.return)),o!==null&&c&4&&Vm(n,n.memoizedProps,o.memoizedProps);break;case 5:if(lr(r,n),cr(n),c&512&&(ms||o===null||wi(o,o.return)),n.flags&32){f=n.stateNode;try{Cs(f,"")}catch(Xe){gn(n,n.return,Xe)}}c&4&&n.stateNode!=null&&(f=n.memoizedProps,Vm(n,f,o!==null?o.memoizedProps:f)),c&1024&&(zm=!0);break;case 6:if(lr(r,n),cr(n),c&4){if(n.stateNode===null)throw Error(i(162));c=n.memoizedProps,o=n.stateNode;try{o.nodeValue=c}catch(Xe){gn(n,n.return,Xe)}}break;case 3:if(Gd=null,f=ri,ri=$d(r.containerInfo),lr(r,n),ri=f,cr(n),c&4&&o!==null&&o.memoizedState.isDehydrated)try{Nl(r.containerInfo)}catch(Xe){gn(n,n.return,Xe)}zm&&(zm=!1,S1(n));break;case 4:c=ri,ri=$d(n.stateNode.containerInfo),lr(r,n),cr(n),ri=c;break;case 12:lr(r,n),cr(n);break;case 31:lr(r,n),cr(n),c&4&&(c=n.updateQueue,c!==null&&(n.updateQueue=null,Rd(n,c)));break;case 13:lr(r,n),cr(n),n.child.flags&8192&&n.memoizedState!==null!=(o!==null&&o.memoizedState!==null)&&(Md=pt()),c&4&&(c=n.updateQueue,c!==null&&(n.updateQueue=null,Rd(n,c)));break;case 22:f=n.memoizedState!==null;var U=o!==null&&o.memoizedState!==null,ne=Hi,pe=ms;if(Hi=ne||f,ms=pe||U,lr(r,n),ms=pe,Hi=ne,cr(n),c&8192)e:for(r=n.stateNode,r._visibility=f?r._visibility&-2:r._visibility|1,f&&(o===null||U||Hi||ms||jo(n)),o=null,r=n;;){if(r.tag===5||r.tag===26){if(o===null){U=o=r;try{if(m=U.stateNode,f)x=m.style,typeof x.setProperty=="function"?x.setProperty("display","none","important"):x.display="none";else{S=U.stateNode;var ke=U.memoizedProps.style,ae=ke!=null&&ke.hasOwnProperty("display")?ke.display:null;S.style.display=ae==null||typeof ae=="boolean"?"":(""+ae).trim()}}catch(Xe){gn(U,U.return,Xe)}}}else if(r.tag===6){if(o===null){U=r;try{U.stateNode.nodeValue=f?"":U.memoizedProps}catch(Xe){gn(U,U.return,Xe)}}}else if(r.tag===18){if(o===null){U=r;try{var de=U.stateNode;f?gb(de,!0):gb(U.stateNode,!1)}catch(Xe){gn(U,U.return,Xe)}}}else if((r.tag!==22&&r.tag!==23||r.memoizedState===null||r===n)&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===n)break e;for(;r.sibling===null;){if(r.return===null||r.return===n)break e;o===r&&(o=null),r=r.return}o===r&&(o=null),r.sibling.return=r.return,r=r.sibling}c&4&&(c=n.updateQueue,c!==null&&(o=c.retryQueue,o!==null&&(c.retryQueue=null,Rd(n,o))));break;case 19:lr(r,n),cr(n),c&4&&(c=n.updateQueue,c!==null&&(n.updateQueue=null,Rd(n,c)));break;case 30:break;case 21:break;default:lr(r,n),cr(n)}}function cr(n){var r=n.flags;if(r&2){try{for(var o,c=n.return;c!==null;){if(v1(c)){o=c;break}c=c.return}if(o==null)throw Error(i(160));switch(o.tag){case 27:var f=o.stateNode,m=Um(n);Ad(n,m,f);break;case 5:var x=o.stateNode;o.flags&32&&(Cs(x,""),o.flags&=-33);var S=Um(n);Ad(n,S,x);break;case 3:case 4:var U=o.stateNode.containerInfo,ne=Um(n);Bm(n,ne,U);break;default:throw Error(i(161))}}catch(pe){gn(n,n.return,pe)}n.flags&=-3}r&4096&&(n.flags&=-4097)}function S1(n){if(n.subtreeFlags&1024)for(n=n.child;n!==null;){var r=n;S1(r),r.tag===5&&r.flags&1024&&r.stateNode.reset(),n=n.sibling}}function Wi(n,r){if(r.subtreeFlags&8772)for(r=r.child;r!==null;)x1(n,r.alternate,r),r=r.sibling}function jo(n){for(n=n.child;n!==null;){var r=n;switch(r.tag){case 0:case 11:case 14:case 15:ja(4,r,r.return),jo(r);break;case 1:wi(r,r.return);var o=r.stateNode;typeof o.componentWillUnmount=="function"&&g1(r,r.return,o),jo(r);break;case 27:Pc(r.stateNode);case 26:case 5:wi(r,r.return),jo(r);break;case 22:r.memoizedState===null&&jo(r);break;case 30:jo(r);break;default:jo(r)}n=n.sibling}}function Gi(n,r,o){for(o=o&&(r.subtreeFlags&8772)!==0,r=r.child;r!==null;){var c=r.alternate,f=n,m=r,x=m.flags;switch(m.tag){case 0:case 11:case 15:Gi(f,m,o),Sc(4,m);break;case 1:if(Gi(f,m,o),c=m,f=c.stateNode,typeof f.componentDidMount=="function")try{f.componentDidMount()}catch(ne){gn(c,c.return,ne)}if(c=m,f=c.updateQueue,f!==null){var S=c.stateNode;try{var U=f.shared.hiddenCallbacks;if(U!==null)for(f.shared.hiddenCallbacks=null,f=0;f<U.length;f++)rv(U[f],S)}catch(ne){gn(c,c.return,ne)}}o&&x&64&&p1(m),Cc(m,m.return);break;case 27:b1(m);case 26:case 5:Gi(f,m,o),o&&c===null&&x&4&&y1(m),Cc(m,m.return);break;case 12:Gi(f,m,o);break;case 31:Gi(f,m,o),o&&x&4&&E1(f,m);break;case 13:Gi(f,m,o),o&&x&4&&T1(f,m);break;case 22:m.memoizedState===null&&Gi(f,m,o),Cc(m,m.return);break;case 30:break;default:Gi(f,m,o)}r=r.sibling}}function Fm(n,r){var o=null;n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(o=n.memoizedState.cachePool.pool),n=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(n=r.memoizedState.cachePool.pool),n!==o&&(n!=null&&n.refCount++,o!=null&&mc(o))}function qm(n,r){n=null,r.alternate!==null&&(n=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==n&&(r.refCount++,n!=null&&mc(n))}function ii(n,r,o,c){if(r.subtreeFlags&10256)for(r=r.child;r!==null;)C1(n,r,o,c),r=r.sibling}function C1(n,r,o,c){var f=r.flags;switch(r.tag){case 0:case 11:case 15:ii(n,r,o,c),f&2048&&Sc(9,r);break;case 1:ii(n,r,o,c);break;case 3:ii(n,r,o,c),f&2048&&(n=null,r.alternate!==null&&(n=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==n&&(r.refCount++,n!=null&&mc(n)));break;case 12:if(f&2048){ii(n,r,o,c),n=r.stateNode;try{var m=r.memoizedProps,x=m.id,S=m.onPostCommit;typeof S=="function"&&S(x,r.alternate===null?"mount":"update",n.passiveEffectDuration,-0)}catch(U){gn(r,r.return,U)}}else ii(n,r,o,c);break;case 31:ii(n,r,o,c);break;case 13:ii(n,r,o,c);break;case 23:break;case 22:m=r.stateNode,x=r.alternate,r.memoizedState!==null?m._visibility&2?ii(n,r,o,c):Nc(n,r):m._visibility&2?ii(n,r,o,c):(m._visibility|=2,vl(n,r,o,c,(r.subtreeFlags&10256)!==0||!1)),f&2048&&Fm(x,r);break;case 24:ii(n,r,o,c),f&2048&&qm(r.alternate,r);break;default:ii(n,r,o,c)}}function vl(n,r,o,c,f){for(f=f&&((r.subtreeFlags&10256)!==0||!1),r=r.child;r!==null;){var m=n,x=r,S=o,U=c,ne=x.flags;switch(x.tag){case 0:case 11:case 15:vl(m,x,S,U,f),Sc(8,x);break;case 23:break;case 22:var pe=x.stateNode;x.memoizedState!==null?pe._visibility&2?vl(m,x,S,U,f):Nc(m,x):(pe._visibility|=2,vl(m,x,S,U,f)),f&&ne&2048&&Fm(x.alternate,x);break;case 24:vl(m,x,S,U,f),f&&ne&2048&&qm(x.alternate,x);break;default:vl(m,x,S,U,f)}r=r.sibling}}function Nc(n,r){if(r.subtreeFlags&10256)for(r=r.child;r!==null;){var o=n,c=r,f=c.flags;switch(c.tag){case 22:Nc(o,c),f&2048&&Fm(c.alternate,c);break;case 24:Nc(o,c),f&2048&&qm(c.alternate,c);break;default:Nc(o,c)}r=r.sibling}}var Ac=8192;function bl(n,r,o){if(n.subtreeFlags&Ac)for(n=n.child;n!==null;)N1(n,r,o),n=n.sibling}function N1(n,r,o){switch(n.tag){case 26:bl(n,r,o),n.flags&Ac&&n.memoizedState!==null&&pj(o,ri,n.memoizedState,n.memoizedProps);break;case 5:bl(n,r,o);break;case 3:case 4:var c=ri;ri=$d(n.stateNode.containerInfo),bl(n,r,o),ri=c;break;case 22:n.memoizedState===null&&(c=n.alternate,c!==null&&c.memoizedState!==null?(c=Ac,Ac=16777216,bl(n,r,o),Ac=c):bl(n,r,o));break;default:bl(n,r,o)}}function A1(n){var r=n.alternate;if(r!==null&&(n=r.child,n!==null)){r.child=null;do r=n.sibling,n.sibling=null,n=r;while(n!==null)}}function Rc(n){var r=n.deletions;if((n.flags&16)!==0){if(r!==null)for(var o=0;o<r.length;o++){var c=r[o];Ns=c,I1(c,n)}A1(n)}if(n.subtreeFlags&10256)for(n=n.child;n!==null;)R1(n),n=n.sibling}function R1(n){switch(n.tag){case 0:case 11:case 15:Rc(n),n.flags&2048&&ja(9,n,n.return);break;case 3:Rc(n);break;case 12:Rc(n);break;case 22:var r=n.stateNode;n.memoizedState!==null&&r._visibility&2&&(n.return===null||n.return.tag!==13)?(r._visibility&=-3,Id(n)):Rc(n);break;default:Rc(n)}}function Id(n){var r=n.deletions;if((n.flags&16)!==0){if(r!==null)for(var o=0;o<r.length;o++){var c=r[o];Ns=c,I1(c,n)}A1(n)}for(n=n.child;n!==null;){switch(r=n,r.tag){case 0:case 11:case 15:ja(8,r,r.return),Id(r);break;case 22:o=r.stateNode,o._visibility&2&&(o._visibility&=-3,Id(r));break;default:Id(r)}n=n.sibling}}function I1(n,r){for(;Ns!==null;){var o=Ns;switch(o.tag){case 0:case 11:case 15:ja(8,o,r);break;case 23:case 22:if(o.memoizedState!==null&&o.memoizedState.cachePool!==null){var c=o.memoizedState.cachePool.pool;c!=null&&c.refCount++}break;case 24:mc(o.memoizedState.cache)}if(c=o.child,c!==null)c.return=o,Ns=c;else e:for(o=n;Ns!==null;){c=Ns;var f=c.sibling,m=c.return;if(_1(c),c===o){Ns=null;break e}if(f!==null){f.return=m,Ns=f;break e}Ns=m}}}var AT={getCacheForType:function(n){var r=Ls(ds),o=r.data.get(n);return o===void 0&&(o=n(),r.data.set(n,o)),o},cacheSignal:function(){return Ls(ds).controller.signal}},RT=typeof WeakMap=="function"?WeakMap:Map,ln=0,Sn=null,Dt=null,Pt=0,pn=0,kr=null,Sa=!1,wl=!1,Hm=!1,Ki=0,Qn=0,Ca=0,So=0,$m=0,Er=0,xl=0,Ic=null,ur=null,Wm=!1,Md=0,M1=0,Dd=1/0,Ld=null,Na=null,ks=0,Aa=null,_l=null,Yi=0,Gm=0,Km=null,D1=null,Mc=0,Ym=null;function Tr(){return(ln&2)!==0&&Pt!==0?Pt&-Pt:X.T!==null?tp():vs()}function L1(){if(Er===0)if((Pt&536870912)===0||qt){var n=Kn;Kn<<=1,(Kn&3932160)===0&&(Kn=262144),Er=n}else Er=536870912;return n=xr.current,n!==null&&(n.flags|=32),Er}function dr(n,r,o){(n===Sn&&(pn===2||pn===9)||n.cancelPendingCommit!==null)&&(kl(n,0),Ra(n,Pt,Er,!1)),Ye(n,o),((ln&2)===0||n!==Sn)&&(n===Sn&&((ln&2)===0&&(So|=o),Qn===4&&Ra(n,Pt,Er,!1)),xi(n))}function O1(n,r,o){if((ln&6)!==0)throw Error(i(327));var c=!o&&(r&127)===0&&(r&n.expiredLanes)===0||yn(n,r),f=c?DT(n,r):Xm(n,r,!0),m=c;do{if(f===0){wl&&!c&&Ra(n,r,0,!1);break}else{if(o=n.current.alternate,m&&!IT(o)){f=Xm(n,r,!1),m=!1;continue}if(f===2){if(m=r,n.errorRecoveryDisabledLanes&m)var x=0;else x=n.pendingLanes&-536870913,x=x!==0?x:x&536870912?536870912:0;if(x!==0){r=x;e:{var S=n;f=Ic;var U=S.current.memoizedState.isDehydrated;if(U&&(kl(S,x).flags|=256),x=Xm(S,x,!1),x!==2){if(Hm&&!U){S.errorRecoveryDisabledLanes|=m,So|=m,f=4;break e}m=ur,ur=f,m!==null&&(ur===null?ur=m:ur.push.apply(ur,m))}f=x}if(m=!1,f!==2)continue}}if(f===1){kl(n,0),Ra(n,r,0,!0);break}e:{switch(c=n,m=f,m){case 0:case 1:throw Error(i(345));case 4:if((r&4194048)!==r)break;case 6:Ra(c,r,Er,!Sa);break e;case 2:ur=null;break;case 3:case 5:break;default:throw Error(i(329))}if((r&62914560)===r&&(f=Md+300-pt(),10<f)){if(Ra(c,r,Er,!Sa),Cn(c,0,!0)!==0)break e;Yi=r,c.timeoutHandle=fb(P1.bind(null,c,o,ur,Ld,Wm,r,Er,So,xl,Sa,m,"Throttled",-0,0),f);break e}P1(c,o,ur,Ld,Wm,r,Er,So,xl,Sa,m,null,-0,0)}}break}while(!0);xi(n)}function P1(n,r,o,c,f,m,x,S,U,ne,pe,ke,ae,de){if(n.timeoutHandle=-1,ke=r.subtreeFlags,ke&8192||(ke&16785408)===16785408){ke={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:ss},N1(r,m,ke);var Xe=(m&62914560)===m?Md-pt():(m&4194048)===m?M1-pt():0;if(Xe=gj(ke,Xe),Xe!==null){Yi=m,n.cancelPendingCommit=Xe($1.bind(null,n,r,m,o,c,f,x,S,U,pe,ke,null,ae,de)),Ra(n,m,x,!ne);return}}$1(n,r,m,o,c,f,x,S,U)}function IT(n){for(var r=n;;){var o=r.tag;if((o===0||o===11||o===15)&&r.flags&16384&&(o=r.updateQueue,o!==null&&(o=o.stores,o!==null)))for(var c=0;c<o.length;c++){var f=o[c],m=f.getSnapshot;f=f.value;try{if(!br(m(),f))return!1}catch{return!1}}if(o=r.child,r.subtreeFlags&16384&&o!==null)o.return=r,r=o;else{if(r===n)break;for(;r.sibling===null;){if(r.return===null||r.return===n)return!0;r=r.return}r.sibling.return=r.return,r=r.sibling}}return!0}function Ra(n,r,o,c){r&=~$m,r&=~So,n.suspendedLanes|=r,n.pingedLanes&=~r,c&&(n.warmLanes|=r),c=n.expirationTimes;for(var f=r;0<f;){var m=31-$e(f),x=1<<m;c[m]=-1,f&=~x}o!==0&&it(n,o,r)}function Od(){return(ln&6)===0?(Dc(0),!1):!0}function Qm(){if(Dt!==null){if(pn===0)var n=Dt.return;else n=Dt,Vi=vo=null,hm(n),fl=null,gc=0,n=Dt;for(;n!==null;)m1(n.alternate,n),n=n.return;Dt=null}}function kl(n,r){var o=n.timeoutHandle;o!==-1&&(n.timeoutHandle=-1,JT(o)),o=n.cancelPendingCommit,o!==null&&(n.cancelPendingCommit=null,o()),Yi=0,Qm(),Sn=n,Dt=o=Oi(n.current,null),Pt=r,pn=0,kr=null,Sa=!1,wl=yn(n,r),Hm=!1,xl=Er=$m=So=Ca=Qn=0,ur=Ic=null,Wm=!1,(r&8)!==0&&(r|=r&32);var c=n.entangledLanes;if(c!==0)for(n=n.entanglements,c&=r;0<c;){var f=31-$e(c),m=1<<f;r|=n[f],c&=~m}return Ki=r,sd(),o}function V1(n,r){St=null,X.H=Ec,r===hl||r===dd?(r=ev(),pn=3):r===em?(r=ev(),pn=4):pn=r===Cm?8:r!==null&&typeof r=="object"&&typeof r.then=="function"?6:1,kr=r,Dt===null&&(Qn=1,Td(n,Pr(r,n.current)))}function U1(){var n=xr.current;return n===null?!0:(Pt&4194048)===Pt?zr===null:(Pt&62914560)===Pt||(Pt&536870912)!==0?n===zr:!1}function B1(){var n=X.H;return X.H=Ec,n===null?Ec:n}function z1(){var n=X.A;return X.A=AT,n}function Pd(){Qn=4,Sa||(Pt&4194048)!==Pt&&xr.current!==null||(wl=!0),(Ca&134217727)===0&&(So&134217727)===0||Sn===null||Ra(Sn,Pt,Er,!1)}function Xm(n,r,o){var c=ln;ln|=2;var f=B1(),m=z1();(Sn!==n||Pt!==r)&&(Ld=null,kl(n,r)),r=!1;var x=Qn;e:do try{if(pn!==0&&Dt!==null){var S=Dt,U=kr;switch(pn){case 8:Qm(),x=6;break e;case 3:case 2:case 9:case 6:xr.current===null&&(r=!0);var ne=pn;if(pn=0,kr=null,El(n,S,U,ne),o&&wl){x=0;break e}break;default:ne=pn,pn=0,kr=null,El(n,S,U,ne)}}MT(),x=Qn;break}catch(pe){V1(n,pe)}while(!0);return r&&n.shellSuspendCounter++,Vi=vo=null,ln=c,X.H=f,X.A=m,Dt===null&&(Sn=null,Pt=0,sd()),x}function MT(){for(;Dt!==null;)F1(Dt)}function DT(n,r){var o=ln;ln|=2;var c=B1(),f=z1();Sn!==n||Pt!==r?(Ld=null,Dd=pt()+500,kl(n,r)):wl=yn(n,r);e:do try{if(pn!==0&&Dt!==null){r=Dt;var m=kr;t:switch(pn){case 1:pn=0,kr=null,El(n,r,m,1);break;case 2:case 9:if(J0(m)){pn=0,kr=null,q1(r);break}r=function(){pn!==2&&pn!==9||Sn!==n||(pn=7),xi(n)},m.then(r,r);break e;case 3:pn=7;break e;case 4:pn=5;break e;case 7:J0(m)?(pn=0,kr=null,q1(r)):(pn=0,kr=null,El(n,r,m,7));break;case 5:var x=null;switch(Dt.tag){case 26:x=Dt.memoizedState;case 5:case 27:var S=Dt;if(x?Cb(x):S.stateNode.complete){pn=0,kr=null;var U=S.sibling;if(U!==null)Dt=U;else{var ne=S.return;ne!==null?(Dt=ne,Vd(ne)):Dt=null}break t}}pn=0,kr=null,El(n,r,m,5);break;case 6:pn=0,kr=null,El(n,r,m,6);break;case 8:Qm(),Qn=6;break e;default:throw Error(i(462))}}LT();break}catch(pe){V1(n,pe)}while(!0);return Vi=vo=null,X.H=c,X.A=f,ln=o,Dt!==null?0:(Sn=null,Pt=0,sd(),Qn)}function LT(){for(;Dt!==null&&!Qe();)F1(Dt)}function F1(n){var r=h1(n.alternate,n,Ki);n.memoizedProps=n.pendingProps,r===null?Vd(n):Dt=r}function q1(n){var r=n,o=r.alternate;switch(r.tag){case 15:case 0:r=a1(o,r,r.pendingProps,r.type,void 0,Pt);break;case 11:r=a1(o,r,r.pendingProps,r.type.render,r.ref,Pt);break;case 5:hm(r);default:m1(o,r),r=Dt=z0(r,Ki),r=h1(o,r,Ki)}n.memoizedProps=n.pendingProps,r===null?Vd(n):Dt=r}function El(n,r,o,c){Vi=vo=null,hm(r),fl=null,gc=0;var f=r.return;try{if(kT(n,f,r,o,Pt)){Qn=1,Td(n,Pr(o,n.current)),Dt=null;return}}catch(m){if(f!==null)throw Dt=f,m;Qn=1,Td(n,Pr(o,n.current)),Dt=null;return}r.flags&32768?(qt||c===1?n=!0:wl||(Pt&536870912)!==0?n=!1:(Sa=n=!0,(c===2||c===9||c===3||c===6)&&(c=xr.current,c!==null&&c.tag===13&&(c.flags|=16384))),H1(r,n)):Vd(r)}function Vd(n){var r=n;do{if((r.flags&32768)!==0){H1(r,Sa);return}n=r.return;var o=jT(r.alternate,r,Ki);if(o!==null){Dt=o;return}if(r=r.sibling,r!==null){Dt=r;return}Dt=r=n}while(r!==null);Qn===0&&(Qn=5)}function H1(n,r){do{var o=ST(n.alternate,n);if(o!==null){o.flags&=32767,Dt=o;return}if(o=n.return,o!==null&&(o.flags|=32768,o.subtreeFlags=0,o.deletions=null),!r&&(n=n.sibling,n!==null)){Dt=n;return}Dt=n=o}while(n!==null);Qn=6,Dt=null}function $1(n,r,o,c,f,m,x,S,U){n.cancelPendingCommit=null;do Ud();while(ks!==0);if((ln&6)!==0)throw Error(i(327));if(r!==null){if(r===n.current)throw Error(i(177));if(m=r.lanes|r.childLanes,m|=Uf,yt(n,o,m,x,S,U),n===Sn&&(Dt=Sn=null,Pt=0),_l=r,Aa=n,Yi=o,Gm=m,Km=f,D1=c,(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?(n.callbackNode=null,n.callbackPriority=0,UT(Wt,function(){return Q1(),null})):(n.callbackNode=null,n.callbackPriority=0),c=(r.flags&13878)!==0,(r.subtreeFlags&13878)!==0||c){c=X.T,X.T=null,f=je.p,je.p=2,x=ln,ln|=4;try{CT(n,r,o)}finally{ln=x,je.p=f,X.T=c}}ks=1,W1(),G1(),K1()}}function W1(){if(ks===1){ks=0;var n=Aa,r=_l,o=(r.flags&13878)!==0;if((r.subtreeFlags&13878)!==0||o){o=X.T,X.T=null;var c=je.p;je.p=2;var f=ln;ln|=4;try{j1(r,n);var m=cp,x=I0(n.containerInfo),S=m.focusedElem,U=m.selectionRange;if(x!==S&&S&&S.ownerDocument&&R0(S.ownerDocument.documentElement,S)){if(U!==null&&Df(S)){var ne=U.start,pe=U.end;if(pe===void 0&&(pe=ne),"selectionStart"in S)S.selectionStart=ne,S.selectionEnd=Math.min(pe,S.value.length);else{var ke=S.ownerDocument||document,ae=ke&&ke.defaultView||window;if(ae.getSelection){var de=ae.getSelection(),Xe=S.textContent.length,mt=Math.min(U.start,Xe),_n=U.end===void 0?mt:Math.min(U.end,Xe);!de.extend&&mt>_n&&(x=_n,_n=mt,mt=x);var Y=A0(S,mt),$=A0(S,_n);if(Y&&$&&(de.rangeCount!==1||de.anchorNode!==Y.node||de.anchorOffset!==Y.offset||de.focusNode!==$.node||de.focusOffset!==$.offset)){var ee=ke.createRange();ee.setStart(Y.node,Y.offset),de.removeAllRanges(),mt>_n?(de.addRange(ee),de.extend($.node,$.offset)):(ee.setEnd($.node,$.offset),de.addRange(ee))}}}}for(ke=[],de=S;de=de.parentNode;)de.nodeType===1&&ke.push({element:de,left:de.scrollLeft,top:de.scrollTop});for(typeof S.focus=="function"&&S.focus(),S=0;S<ke.length;S++){var be=ke[S];be.element.scrollLeft=be.left,be.element.scrollTop=be.top}}Xd=!!lp,cp=lp=null}finally{ln=f,je.p=c,X.T=o}}n.current=r,ks=2}}function G1(){if(ks===2){ks=0;var n=Aa,r=_l,o=(r.flags&8772)!==0;if((r.subtreeFlags&8772)!==0||o){o=X.T,X.T=null;var c=je.p;je.p=2;var f=ln;ln|=4;try{x1(n,r.alternate,r)}finally{ln=f,je.p=c,X.T=o}}ks=3}}function K1(){if(ks===4||ks===3){ks=0,Tt();var n=Aa,r=_l,o=Yi,c=D1;(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?ks=5:(ks=0,_l=Aa=null,Y1(n,n.pendingLanes));var f=n.pendingLanes;if(f===0&&(Na=null),Kt(o),r=r.stateNode,He&&typeof He.onCommitFiberRoot=="function")try{He.onCommitFiberRoot(ut,r,void 0,(r.current.flags&128)===128)}catch{}if(c!==null){r=X.T,f=je.p,je.p=2,X.T=null;try{for(var m=n.onRecoverableError,x=0;x<c.length;x++){var S=c[x];m(S.value,{componentStack:S.stack})}}finally{X.T=r,je.p=f}}(Yi&3)!==0&&Ud(),xi(n),f=n.pendingLanes,(o&261930)!==0&&(f&42)!==0?n===Ym?Mc++:(Mc=0,Ym=n):Mc=0,Dc(0)}}function Y1(n,r){(n.pooledCacheLanes&=r)===0&&(r=n.pooledCache,r!=null&&(n.pooledCache=null,mc(r)))}function Ud(){return W1(),G1(),K1(),Q1()}function Q1(){if(ks!==5)return!1;var n=Aa,r=Gm;Gm=0;var o=Kt(Yi),c=X.T,f=je.p;try{je.p=32>o?32:o,X.T=null,o=Km,Km=null;var m=Aa,x=Yi;if(ks=0,_l=Aa=null,Yi=0,(ln&6)!==0)throw Error(i(331));var S=ln;if(ln|=4,R1(m.current),C1(m,m.current,x,o),ln=S,Dc(0,!1),He&&typeof He.onPostCommitFiberRoot=="function")try{He.onPostCommitFiberRoot(ut,m)}catch{}return!0}finally{je.p=f,X.T=c,Y1(n,r)}}function X1(n,r,o){r=Pr(o,r),r=Sm(n.stateNode,r,2),n=ka(n,r,2),n!==null&&(Ye(n,2),xi(n))}function gn(n,r,o){if(n.tag===3)X1(n,n,o);else for(;r!==null;){if(r.tag===3){X1(r,n,o);break}else if(r.tag===1){var c=r.stateNode;if(typeof r.type.getDerivedStateFromError=="function"||typeof c.componentDidCatch=="function"&&(Na===null||!Na.has(c))){n=Pr(o,n),o=Jv(2),c=ka(r,o,2),c!==null&&(Zv(o,c,r,n),Ye(c,2),xi(c));break}}r=r.return}}function Jm(n,r,o){var c=n.pingCache;if(c===null){c=n.pingCache=new RT;var f=new Set;c.set(r,f)}else f=c.get(r),f===void 0&&(f=new Set,c.set(r,f));f.has(o)||(Hm=!0,f.add(o),n=OT.bind(null,n,r,o),r.then(n,n))}function OT(n,r,o){var c=n.pingCache;c!==null&&c.delete(r),n.pingedLanes|=n.suspendedLanes&o,n.warmLanes&=~o,Sn===n&&(Pt&o)===o&&(Qn===4||Qn===3&&(Pt&62914560)===Pt&&300>pt()-Md?(ln&2)===0&&kl(n,0):$m|=o,xl===Pt&&(xl=0)),xi(n)}function J1(n,r){r===0&&(r=le()),n=po(n,r),n!==null&&(Ye(n,r),xi(n))}function PT(n){var r=n.memoizedState,o=0;r!==null&&(o=r.retryLane),J1(n,o)}function VT(n,r){var o=0;switch(n.tag){case 31:case 13:var c=n.stateNode,f=n.memoizedState;f!==null&&(o=f.retryLane);break;case 19:c=n.stateNode;break;case 22:c=n.stateNode._retryCache;break;default:throw Error(i(314))}c!==null&&c.delete(r),J1(n,o)}function UT(n,r){return ft(n,r)}var Bd=null,Tl=null,Zm=!1,zd=!1,ep=!1,Ia=0;function xi(n){n!==Tl&&n.next===null&&(Tl===null?Bd=Tl=n:Tl=Tl.next=n),zd=!0,Zm||(Zm=!0,zT())}function Dc(n,r){if(!ep&&zd){ep=!0;do for(var o=!1,c=Bd;c!==null;){if(n!==0){var f=c.pendingLanes;if(f===0)var m=0;else{var x=c.suspendedLanes,S=c.pingedLanes;m=(1<<31-$e(42|n)+1)-1,m&=f&~(x&~S),m=m&201326741?m&201326741|1:m?m|2:0}m!==0&&(o=!0,nb(c,m))}else m=Pt,m=Cn(c,c===Sn?m:0,c.cancelPendingCommit!==null||c.timeoutHandle!==-1),(m&3)===0||yn(c,m)||(o=!0,nb(c,m));c=c.next}while(o);ep=!1}}function BT(){Z1()}function Z1(){zd=Zm=!1;var n=0;Ia!==0&&XT()&&(n=Ia);for(var r=pt(),o=null,c=Bd;c!==null;){var f=c.next,m=eb(c,r);m===0?(c.next=null,o===null?Bd=f:o.next=f,f===null&&(Tl=o)):(o=c,(n!==0||(m&3)!==0)&&(zd=!0)),c=f}ks!==0&&ks!==5||Dc(n),Ia!==0&&(Ia=0)}function eb(n,r){for(var o=n.suspendedLanes,c=n.pingedLanes,f=n.expirationTimes,m=n.pendingLanes&-62914561;0<m;){var x=31-$e(m),S=1<<x,U=f[x];U===-1?((S&o)===0||(S&c)!==0)&&(f[x]=Ss(S,r)):U<=r&&(n.expiredLanes|=S),m&=~S}if(r=Sn,o=Pt,o=Cn(n,n===r?o:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),c=n.callbackNode,o===0||n===r&&(pn===2||pn===9)||n.cancelPendingCommit!==null)return c!==null&&c!==null&&Rt(c),n.callbackNode=null,n.callbackPriority=0;if((o&3)===0||yn(n,o)){if(r=o&-o,r===n.callbackPriority)return r;switch(c!==null&&Rt(c),Kt(o)){case 2:case 8:o=es;break;case 32:o=Wt;break;case 268435456:o=Ae;break;default:o=Wt}return c=tb.bind(null,n),o=ft(o,c),n.callbackPriority=r,n.callbackNode=o,r}return c!==null&&c!==null&&Rt(c),n.callbackPriority=2,n.callbackNode=null,2}function tb(n,r){if(ks!==0&&ks!==5)return n.callbackNode=null,n.callbackPriority=0,null;var o=n.callbackNode;if(Ud()&&n.callbackNode!==o)return null;var c=Pt;return c=Cn(n,n===Sn?c:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),c===0?null:(O1(n,c,r),eb(n,pt()),n.callbackNode!=null&&n.callbackNode===o?tb.bind(null,n):null)}function nb(n,r){if(Ud())return null;O1(n,r,!0)}function zT(){ZT(function(){(ln&6)!==0?ft(zs,BT):Z1()})}function tp(){if(Ia===0){var n=ul;n===0&&(n=On,On<<=1,(On&261888)===0&&(On=256)),Ia=n}return Ia}function sb(n){return n==null||typeof n=="symbol"||typeof n=="boolean"?null:typeof n=="function"?n:mi(""+n)}function rb(n,r){var o=r.ownerDocument.createElement("input");return o.name=r.name,o.value=r.value,n.id&&o.setAttribute("form",n.id),r.parentNode.insertBefore(o,r),n=new FormData(n),o.parentNode.removeChild(o),n}function FT(n,r,o,c,f){if(r==="submit"&&o&&o.stateNode===f){var m=sb((f[un]||null).action),x=c.submitter;x&&(r=(r=x[un]||null)?sb(r.formAction):x.getAttribute("formAction"),r!==null&&(m=r,x=null));var S=new Un("action","action",null,c,f);n.push({event:S,listeners:[{instance:null,listener:function(){if(c.defaultPrevented){if(Ia!==0){var U=x?rb(f,x):new FormData(f);xm(o,{pending:!0,data:U,method:f.method,action:m},null,U)}}else typeof m=="function"&&(S.preventDefault(),U=x?rb(f,x):new FormData(f),xm(o,{pending:!0,data:U,method:f.method,action:m},m,U))},currentTarget:f}]})}}for(var np=0;np<Vf.length;np++){var sp=Vf[np],qT=sp.toLowerCase(),HT=sp[0].toUpperCase()+sp.slice(1);si(qT,"on"+HT)}si(L0,"onAnimationEnd"),si(O0,"onAnimationIteration"),si(P0,"onAnimationStart"),si("dblclick","onDoubleClick"),si("focusin","onFocus"),si("focusout","onBlur"),si(aT,"onTransitionRun"),si(oT,"onTransitionStart"),si(lT,"onTransitionCancel"),si(V0,"onTransitionEnd"),Tn("onMouseEnter",["mouseout","mouseover"]),Tn("onMouseLeave",["mouseout","mouseover"]),Tn("onPointerEnter",["pointerout","pointerover"]),Tn("onPointerLeave",["pointerout","pointerover"]),xs("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),xs("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),xs("onBeforeInput",["compositionend","keypress","textInput","paste"]),xs("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),xs("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),xs("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Lc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),$T=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Lc));function ib(n,r){r=(r&4)!==0;for(var o=0;o<n.length;o++){var c=n[o],f=c.event;c=c.listeners;e:{var m=void 0;if(r)for(var x=c.length-1;0<=x;x--){var S=c[x],U=S.instance,ne=S.currentTarget;if(S=S.listener,U!==m&&f.isPropagationStopped())break e;m=S,f.currentTarget=ne;try{m(f)}catch(pe){nd(pe)}f.currentTarget=null,m=U}else for(x=0;x<c.length;x++){if(S=c[x],U=S.instance,ne=S.currentTarget,S=S.listener,U!==m&&f.isPropagationStopped())break e;m=S,f.currentTarget=ne;try{m(f)}catch(pe){nd(pe)}f.currentTarget=null,m=U}}}}function Lt(n,r){var o=r[Qr];o===void 0&&(o=r[Qr]=new Set);var c=n+"__bubble";o.has(c)||(ab(r,n,2,!1),o.add(c))}function rp(n,r,o){var c=0;r&&(c|=4),ab(o,n,c,r)}var Fd="_reactListening"+Math.random().toString(36).slice(2);function ip(n){if(!n[Fd]){n[Fd]=!0,yr.forEach(function(o){o!=="selectionchange"&&($T.has(o)||rp(o,!1,n),rp(o,!0,n))});var r=n.nodeType===9?n:n.ownerDocument;r===null||r[Fd]||(r[Fd]=!0,rp("selectionchange",!1,r))}}function ab(n,r,o,c){switch(Lb(r)){case 2:var f=bj;break;case 8:f=wj;break;default:f=wp}o=f.bind(null,r,o,n),f=void 0,!Be||r!=="touchstart"&&r!=="touchmove"&&r!=="wheel"||(f=!0),c?f!==void 0?n.addEventListener(r,o,{capture:!0,passive:f}):n.addEventListener(r,o,!0):f!==void 0?n.addEventListener(r,o,{passive:f}):n.addEventListener(r,o,!1)}function ap(n,r,o,c,f){var m=c;if((r&1)===0&&(r&2)===0&&c!==null)e:for(;;){if(c===null)return;var x=c.tag;if(x===3||x===4){var S=c.stateNode.containerInfo;if(S===f)break;if(x===4)for(x=c.return;x!==null;){var U=x.tag;if((U===3||U===4)&&x.stateNode.containerInfo===f)return;x=x.return}for(;S!==null;){if(x=ws(S),x===null)return;if(U=x.tag,U===5||U===6||U===26||U===27){c=m=x;continue e}S=S.parentNode}}c=c.return}me(function(){var ne=m,pe=oe(o),ke=[];e:{var ae=U0.get(n);if(ae!==void 0){var de=Un,Xe=n;switch(n){case"keypress":if(jn(o)===0)break e;case"keydown":case"keyup":de=Zu;break;case"focusin":Xe="focus",de=uo;break;case"focusout":Xe="blur",de=uo;break;case"beforeblur":case"afterblur":de=uo;break;case"click":if(o.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":de=ac;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":de=Hu;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":de=v;break;case L0:case O0:case P0:de=Wu;break;case V0:de=N;break;case"scroll":case"scrollend":de=Wn;break;case"wheel":de=ue;break;case"copy":case"cut":case"paste":de=Gu;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":de=Li;break;case"toggle":case"beforetoggle":de=jt}var mt=(r&4)!==0,_n=!mt&&(n==="scroll"||n==="scrollend"),Y=mt?ae!==null?ae+"Capture":null:ae;mt=[];for(var $=ne,ee;$!==null;){var be=$;if(ee=be.stateNode,be=be.tag,be!==5&&be!==26&&be!==27||ee===null||Y===null||(be=Ie($,Y),be!=null&&mt.push(Oc($,be,ee))),_n)break;$=$.return}0<mt.length&&(ae=new de(ae,Xe,null,o,pe),ke.push({event:ae,listeners:mt}))}}if((r&7)===0){e:{if(ae=n==="mouseover"||n==="pointerover",de=n==="mouseout"||n==="pointerout",ae&&o!==F&&(Xe=o.relatedTarget||o.fromElement)&&(ws(Xe)||Xe[cs]))break e;if((de||ae)&&(ae=pe.window===pe?pe:(ae=pe.ownerDocument)?ae.defaultView||ae.parentWindow:window,de?(Xe=o.relatedTarget||o.toElement,de=ne,Xe=Xe?ws(Xe):null,Xe!==null&&(_n=u(Xe),mt=Xe.tag,Xe!==_n||mt!==5&&mt!==27&&mt!==6)&&(Xe=null)):(de=null,Xe=ne),de!==Xe)){if(mt=ac,be="onMouseLeave",Y="onMouseEnter",$="mouse",(n==="pointerout"||n==="pointerover")&&(mt=Li,be="onPointerLeave",Y="onPointerEnter",$="pointer"),_n=de==null?ae:In(de),ee=Xe==null?ae:In(Xe),ae=new mt(be,$+"leave",de,o,pe),ae.target=_n,ae.relatedTarget=ee,be=null,ws(pe)===ne&&(mt=new mt(Y,$+"enter",Xe,o,pe),mt.target=ee,mt.relatedTarget=_n,be=mt),_n=be,de&&Xe)t:{for(mt=WT,Y=de,$=Xe,ee=0,be=Y;be;be=mt(be))ee++;be=0;for(var ot=$;ot;ot=mt(ot))be++;for(;0<ee-be;)Y=mt(Y),ee--;for(;0<be-ee;)$=mt($),be--;for(;ee--;){if(Y===$||$!==null&&Y===$.alternate){mt=Y;break t}Y=mt(Y),$=mt($)}mt=null}else mt=null;de!==null&&ob(ke,ae,de,mt,!1),Xe!==null&&_n!==null&&ob(ke,_n,Xe,mt,!0)}}e:{if(ae=ne?In(ne):window,de=ae.nodeName&&ae.nodeName.toLowerCase(),de==="select"||de==="input"&&ae.type==="file")var nn=E0;else if(_0(ae))if(T0)nn=sT;else{nn=tT;var tt=eT}else de=ae.nodeName,!de||de.toLowerCase()!=="input"||ae.type!=="checkbox"&&ae.type!=="radio"?ne&&Ms(ne.elementType)&&(nn=E0):nn=nT;if(nn&&(nn=nn(n,ne))){k0(ke,nn,o,pe);break e}tt&&tt(n,ae,ne),n==="focusout"&&ne&&ae.type==="number"&&ne.memoizedProps.value!=null&&Is(ae,"number",ae.value)}switch(tt=ne?In(ne):window,n){case"focusin":(_0(tt)||tt.contentEditable==="true")&&(nl=tt,Lf=ne,dc=null);break;case"focusout":dc=Lf=nl=null;break;case"mousedown":Of=!0;break;case"contextmenu":case"mouseup":case"dragend":Of=!1,M0(ke,o,pe);break;case"selectionchange":if(iT)break;case"keydown":case"keyup":M0(ke,o,pe)}var Nt;if(on)e:{switch(n){case"compositionstart":var Vt="onCompositionStart";break e;case"compositionend":Vt="onCompositionEnd";break e;case"compositionupdate":Vt="onCompositionUpdate";break e}Vt=void 0}else tl?ho(n,o)&&(Vt="onCompositionEnd"):n==="keydown"&&o.keyCode===229&&(Vt="onCompositionStart");Vt&&(yi&&o.locale!=="ko"&&(tl||Vt!=="onCompositionStart"?Vt==="onCompositionEnd"&&tl&&(Nt=tn()):(at=pe,bn="value"in at?at.value:at.textContent,tl=!0)),tt=qd(ne,Vt),0<tt.length&&(Vt=new gi(Vt,n,null,o,pe),ke.push({event:Vt,listeners:tt}),Nt?Vt.data=Nt:(Nt=el(o),Nt!==null&&(Vt.data=Nt)))),(Nt=Lr?QE(n,o):XE(n,o))&&(Vt=qd(ne,"onBeforeInput"),0<Vt.length&&(tt=new gi("onBeforeInput","beforeinput",null,o,pe),ke.push({event:tt,listeners:Vt}),tt.data=Nt)),FT(ke,n,ne,o,pe)}ib(ke,r)})}function Oc(n,r,o){return{instance:n,listener:r,currentTarget:o}}function qd(n,r){for(var o=r+"Capture",c=[];n!==null;){var f=n,m=f.stateNode;if(f=f.tag,f!==5&&f!==26&&f!==27||m===null||(f=Ie(n,o),f!=null&&c.unshift(Oc(n,f,m)),f=Ie(n,r),f!=null&&c.push(Oc(n,f,m))),n.tag===3)return c;n=n.return}return[]}function WT(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5&&n.tag!==27);return n||null}function ob(n,r,o,c,f){for(var m=r._reactName,x=[];o!==null&&o!==c;){var S=o,U=S.alternate,ne=S.stateNode;if(S=S.tag,U!==null&&U===c)break;S!==5&&S!==26&&S!==27||ne===null||(U=ne,f?(ne=Ie(o,m),ne!=null&&x.unshift(Oc(o,ne,U))):f||(ne=Ie(o,m),ne!=null&&x.push(Oc(o,ne,U)))),o=o.return}x.length!==0&&n.push({event:r,listeners:x})}var GT=/\r\n?/g,KT=/\u0000|\uFFFD/g;function lb(n){return(typeof n=="string"?n:""+n).replace(GT,`
`).replace(KT,"")}function cb(n,r){return r=lb(r),lb(n)===r}function xn(n,r,o,c,f,m){switch(o){case"children":typeof c=="string"?r==="body"||r==="textarea"&&c===""||Cs(n,c):(typeof c=="number"||typeof c=="bigint")&&r!=="body"&&Cs(n,""+c);break;case"className":ce(n,"class",c);break;case"tabIndex":ce(n,"tabindex",c);break;case"dir":case"role":case"viewBox":case"width":case"height":ce(n,o,c);break;case"style":Ir(n,c,m);break;case"data":if(r!=="object"){ce(n,"data",c);break}case"src":case"href":if(c===""&&(r!=="a"||o!=="href")){n.removeAttribute(o);break}if(c==null||typeof c=="function"||typeof c=="symbol"||typeof c=="boolean"){n.removeAttribute(o);break}c=mi(""+c),n.setAttribute(o,c);break;case"action":case"formAction":if(typeof c=="function"){n.setAttribute(o,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof m=="function"&&(o==="formAction"?(r!=="input"&&xn(n,r,"name",f.name,f,null),xn(n,r,"formEncType",f.formEncType,f,null),xn(n,r,"formMethod",f.formMethod,f,null),xn(n,r,"formTarget",f.formTarget,f,null)):(xn(n,r,"encType",f.encType,f,null),xn(n,r,"method",f.method,f,null),xn(n,r,"target",f.target,f,null)));if(c==null||typeof c=="symbol"||typeof c=="boolean"){n.removeAttribute(o);break}c=mi(""+c),n.setAttribute(o,c);break;case"onClick":c!=null&&(n.onclick=ss);break;case"onScroll":c!=null&&Lt("scroll",n);break;case"onScrollEnd":c!=null&&Lt("scrollend",n);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(i(61));if(o=c.__html,o!=null){if(f.children!=null)throw Error(i(60));n.innerHTML=o}}break;case"multiple":n.multiple=c&&typeof c!="function"&&typeof c!="symbol";break;case"muted":n.muted=c&&typeof c!="function"&&typeof c!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(c==null||typeof c=="function"||typeof c=="boolean"||typeof c=="symbol"){n.removeAttribute("xlink:href");break}o=mi(""+c),n.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",o);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":c!=null&&typeof c!="function"&&typeof c!="symbol"?n.setAttribute(o,""+c):n.removeAttribute(o);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":c&&typeof c!="function"&&typeof c!="symbol"?n.setAttribute(o,""):n.removeAttribute(o);break;case"capture":case"download":c===!0?n.setAttribute(o,""):c!==!1&&c!=null&&typeof c!="function"&&typeof c!="symbol"?n.setAttribute(o,c):n.removeAttribute(o);break;case"cols":case"rows":case"size":case"span":c!=null&&typeof c!="function"&&typeof c!="symbol"&&!isNaN(c)&&1<=c?n.setAttribute(o,c):n.removeAttribute(o);break;case"rowSpan":case"start":c==null||typeof c=="function"||typeof c=="symbol"||isNaN(c)?n.removeAttribute(o):n.setAttribute(o,c);break;case"popover":Lt("beforetoggle",n),Lt("toggle",n),ie(n,"popover",c);break;case"xlinkActuate":Pe(n,"http://www.w3.org/1999/xlink","xlink:actuate",c);break;case"xlinkArcrole":Pe(n,"http://www.w3.org/1999/xlink","xlink:arcrole",c);break;case"xlinkRole":Pe(n,"http://www.w3.org/1999/xlink","xlink:role",c);break;case"xlinkShow":Pe(n,"http://www.w3.org/1999/xlink","xlink:show",c);break;case"xlinkTitle":Pe(n,"http://www.w3.org/1999/xlink","xlink:title",c);break;case"xlinkType":Pe(n,"http://www.w3.org/1999/xlink","xlink:type",c);break;case"xmlBase":Pe(n,"http://www.w3.org/XML/1998/namespace","xml:base",c);break;case"xmlLang":Pe(n,"http://www.w3.org/XML/1998/namespace","xml:lang",c);break;case"xmlSpace":Pe(n,"http://www.w3.org/XML/1998/namespace","xml:space",c);break;case"is":ie(n,"is",c);break;case"innerText":case"textContent":break;default:(!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(o=fi.get(o)||o,ie(n,o,c))}}function op(n,r,o,c,f,m){switch(o){case"style":Ir(n,c,m);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(i(61));if(o=c.__html,o!=null){if(f.children!=null)throw Error(i(60));n.innerHTML=o}}break;case"children":typeof c=="string"?Cs(n,c):(typeof c=="number"||typeof c=="bigint")&&Cs(n,""+c);break;case"onScroll":c!=null&&Lt("scroll",n);break;case"onScrollEnd":c!=null&&Lt("scrollend",n);break;case"onClick":c!=null&&(n.onclick=ss);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Rr.hasOwnProperty(o))e:{if(o[0]==="o"&&o[1]==="n"&&(f=o.endsWith("Capture"),r=o.slice(2,f?o.length-7:void 0),m=n[un]||null,m=m!=null?m[o]:null,typeof m=="function"&&n.removeEventListener(r,m,f),typeof c=="function")){typeof m!="function"&&m!==null&&(o in n?n[o]=null:n.hasAttribute(o)&&n.removeAttribute(o)),n.addEventListener(r,c,f);break e}o in n?n[o]=c:c===!0?n.setAttribute(o,""):ie(n,o,c)}}}function Ps(n,r,o){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Lt("error",n),Lt("load",n);var c=!1,f=!1,m;for(m in o)if(o.hasOwnProperty(m)){var x=o[m];if(x!=null)switch(m){case"src":c=!0;break;case"srcSet":f=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,r));default:xn(n,r,m,x,o,null)}}f&&xn(n,r,"srcSet",o.srcSet,o,null),c&&xn(n,r,"src",o.src,o,null);return;case"input":Lt("invalid",n);var S=m=x=f=null,U=null,ne=null;for(c in o)if(o.hasOwnProperty(c)){var pe=o[c];if(pe!=null)switch(c){case"name":f=pe;break;case"type":x=pe;break;case"checked":U=pe;break;case"defaultChecked":ne=pe;break;case"value":m=pe;break;case"defaultValue":S=pe;break;case"children":case"dangerouslySetInnerHTML":if(pe!=null)throw Error(i(137,r));break;default:xn(n,r,c,pe,o,null)}}Di(n,m,S,U,ne,x,f,!1);return;case"select":Lt("invalid",n),c=x=m=null;for(f in o)if(o.hasOwnProperty(f)&&(S=o[f],S!=null))switch(f){case"value":m=S;break;case"defaultValue":x=S;break;case"multiple":c=S;default:xn(n,r,f,S,o,null)}r=m,o=x,n.multiple=!!c,r!=null?Js(n,!!c,r,!1):o!=null&&Js(n,!!c,o,!0);return;case"textarea":Lt("invalid",n),m=f=c=null;for(x in o)if(o.hasOwnProperty(x)&&(S=o[x],S!=null))switch(x){case"value":c=S;break;case"defaultValue":f=S;break;case"children":m=S;break;case"dangerouslySetInnerHTML":if(S!=null)throw Error(i(91));break;default:xn(n,r,x,S,o,null)}vr(n,c,f,m);return;case"option":for(U in o)o.hasOwnProperty(U)&&(c=o[U],c!=null)&&(U==="selected"?n.selected=c&&typeof c!="function"&&typeof c!="symbol":xn(n,r,U,c,o,null));return;case"dialog":Lt("beforetoggle",n),Lt("toggle",n),Lt("cancel",n),Lt("close",n);break;case"iframe":case"object":Lt("load",n);break;case"video":case"audio":for(c=0;c<Lc.length;c++)Lt(Lc[c],n);break;case"image":Lt("error",n),Lt("load",n);break;case"details":Lt("toggle",n);break;case"embed":case"source":case"link":Lt("error",n),Lt("load",n);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ne in o)if(o.hasOwnProperty(ne)&&(c=o[ne],c!=null))switch(ne){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,r));default:xn(n,r,ne,c,o,null)}return;default:if(Ms(r)){for(pe in o)o.hasOwnProperty(pe)&&(c=o[pe],c!==void 0&&op(n,r,pe,c,o,void 0));return}}for(S in o)o.hasOwnProperty(S)&&(c=o[S],c!=null&&xn(n,r,S,c,o,null))}function YT(n,r,o,c){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var f=null,m=null,x=null,S=null,U=null,ne=null,pe=null;for(de in o){var ke=o[de];if(o.hasOwnProperty(de)&&ke!=null)switch(de){case"checked":break;case"value":break;case"defaultValue":U=ke;default:c.hasOwnProperty(de)||xn(n,r,de,null,c,ke)}}for(var ae in c){var de=c[ae];if(ke=o[ae],c.hasOwnProperty(ae)&&(de!=null||ke!=null))switch(ae){case"type":m=de;break;case"name":f=de;break;case"checked":ne=de;break;case"defaultChecked":pe=de;break;case"value":x=de;break;case"defaultValue":S=de;break;case"children":case"dangerouslySetInnerHTML":if(de!=null)throw Error(i(137,r));break;default:de!==ke&&xn(n,r,ae,de,c,ke)}}Xs(n,x,S,U,ne,pe,m,f);return;case"select":de=x=S=ae=null;for(m in o)if(U=o[m],o.hasOwnProperty(m)&&U!=null)switch(m){case"value":break;case"multiple":de=U;default:c.hasOwnProperty(m)||xn(n,r,m,null,c,U)}for(f in c)if(m=c[f],U=o[f],c.hasOwnProperty(f)&&(m!=null||U!=null))switch(f){case"value":ae=m;break;case"defaultValue":S=m;break;case"multiple":x=m;default:m!==U&&xn(n,r,f,m,c,U)}r=S,o=x,c=de,ae!=null?Js(n,!!o,ae,!1):!!c!=!!o&&(r!=null?Js(n,!!o,r,!0):Js(n,!!o,o?[]:"",!1));return;case"textarea":de=ae=null;for(S in o)if(f=o[S],o.hasOwnProperty(S)&&f!=null&&!c.hasOwnProperty(S))switch(S){case"value":break;case"children":break;default:xn(n,r,S,null,c,f)}for(x in c)if(f=c[x],m=o[x],c.hasOwnProperty(x)&&(f!=null||m!=null))switch(x){case"value":ae=f;break;case"defaultValue":de=f;break;case"children":break;case"dangerouslySetInnerHTML":if(f!=null)throw Error(i(91));break;default:f!==m&&xn(n,r,x,f,c,m)}ma(n,ae,de);return;case"option":for(var Xe in o)ae=o[Xe],o.hasOwnProperty(Xe)&&ae!=null&&!c.hasOwnProperty(Xe)&&(Xe==="selected"?n.selected=!1:xn(n,r,Xe,null,c,ae));for(U in c)ae=c[U],de=o[U],c.hasOwnProperty(U)&&ae!==de&&(ae!=null||de!=null)&&(U==="selected"?n.selected=ae&&typeof ae!="function"&&typeof ae!="symbol":xn(n,r,U,ae,c,de));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var mt in o)ae=o[mt],o.hasOwnProperty(mt)&&ae!=null&&!c.hasOwnProperty(mt)&&xn(n,r,mt,null,c,ae);for(ne in c)if(ae=c[ne],de=o[ne],c.hasOwnProperty(ne)&&ae!==de&&(ae!=null||de!=null))switch(ne){case"children":case"dangerouslySetInnerHTML":if(ae!=null)throw Error(i(137,r));break;default:xn(n,r,ne,ae,c,de)}return;default:if(Ms(r)){for(var _n in o)ae=o[_n],o.hasOwnProperty(_n)&&ae!==void 0&&!c.hasOwnProperty(_n)&&op(n,r,_n,void 0,c,ae);for(pe in c)ae=c[pe],de=o[pe],!c.hasOwnProperty(pe)||ae===de||ae===void 0&&de===void 0||op(n,r,pe,ae,c,de);return}}for(var Y in o)ae=o[Y],o.hasOwnProperty(Y)&&ae!=null&&!c.hasOwnProperty(Y)&&xn(n,r,Y,null,c,ae);for(ke in c)ae=c[ke],de=o[ke],!c.hasOwnProperty(ke)||ae===de||ae==null&&de==null||xn(n,r,ke,ae,c,de)}function ub(n){switch(n){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function QT(){if(typeof performance.getEntriesByType=="function"){for(var n=0,r=0,o=performance.getEntriesByType("resource"),c=0;c<o.length;c++){var f=o[c],m=f.transferSize,x=f.initiatorType,S=f.duration;if(m&&S&&ub(x)){for(x=0,S=f.responseEnd,c+=1;c<o.length;c++){var U=o[c],ne=U.startTime;if(ne>S)break;var pe=U.transferSize,ke=U.initiatorType;pe&&ub(ke)&&(U=U.responseEnd,x+=pe*(U<S?1:(S-ne)/(U-ne)))}if(--c,r+=8*(m+x)/(f.duration/1e3),n++,10<n)break}}if(0<n)return r/n/1e6}return navigator.connection&&(n=navigator.connection.downlink,typeof n=="number")?n:5}var lp=null,cp=null;function Hd(n){return n.nodeType===9?n:n.ownerDocument}function db(n){switch(n){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function hb(n,r){if(n===0)switch(r){case"svg":return 1;case"math":return 2;default:return 0}return n===1&&r==="foreignObject"?0:n}function up(n,r){return n==="textarea"||n==="noscript"||typeof r.children=="string"||typeof r.children=="number"||typeof r.children=="bigint"||typeof r.dangerouslySetInnerHTML=="object"&&r.dangerouslySetInnerHTML!==null&&r.dangerouslySetInnerHTML.__html!=null}var dp=null;function XT(){var n=window.event;return n&&n.type==="popstate"?n===dp?!1:(dp=n,!0):(dp=null,!1)}var fb=typeof setTimeout=="function"?setTimeout:void 0,JT=typeof clearTimeout=="function"?clearTimeout:void 0,mb=typeof Promise=="function"?Promise:void 0,ZT=typeof queueMicrotask=="function"?queueMicrotask:typeof mb<"u"?function(n){return mb.resolve(null).then(n).catch(ej)}:fb;function ej(n){setTimeout(function(){throw n})}function Ma(n){return n==="head"}function pb(n,r){var o=r,c=0;do{var f=o.nextSibling;if(n.removeChild(o),f&&f.nodeType===8)if(o=f.data,o==="/$"||o==="/&"){if(c===0){n.removeChild(f),Nl(r);return}c--}else if(o==="$"||o==="$?"||o==="$~"||o==="$!"||o==="&")c++;else if(o==="html")Pc(n.ownerDocument.documentElement);else if(o==="head"){o=n.ownerDocument.head,Pc(o);for(var m=o.firstChild;m;){var x=m.nextSibling,S=m.nodeName;m[$n]||S==="SCRIPT"||S==="STYLE"||S==="LINK"&&m.rel.toLowerCase()==="stylesheet"||o.removeChild(m),m=x}}else o==="body"&&Pc(n.ownerDocument.body);o=f}while(o);Nl(r)}function gb(n,r){var o=n;n=0;do{var c=o.nextSibling;if(o.nodeType===1?r?(o._stashedDisplay=o.style.display,o.style.display="none"):(o.style.display=o._stashedDisplay||"",o.getAttribute("style")===""&&o.removeAttribute("style")):o.nodeType===3&&(r?(o._stashedText=o.nodeValue,o.nodeValue=""):o.nodeValue=o._stashedText||""),c&&c.nodeType===8)if(o=c.data,o==="/$"){if(n===0)break;n--}else o!=="$"&&o!=="$?"&&o!=="$~"&&o!=="$!"||n++;o=c}while(o)}function hp(n){var r=n.firstChild;for(r&&r.nodeType===10&&(r=r.nextSibling);r;){var o=r;switch(r=r.nextSibling,o.nodeName){case"HTML":case"HEAD":case"BODY":hp(o),Fs(o);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(o.rel.toLowerCase()==="stylesheet")continue}n.removeChild(o)}}function tj(n,r,o,c){for(;n.nodeType===1;){var f=o;if(n.nodeName.toLowerCase()!==r.toLowerCase()){if(!c&&(n.nodeName!=="INPUT"||n.type!=="hidden"))break}else if(c){if(!n[$n])switch(r){case"meta":if(!n.hasAttribute("itemprop"))break;return n;case"link":if(m=n.getAttribute("rel"),m==="stylesheet"&&n.hasAttribute("data-precedence"))break;if(m!==f.rel||n.getAttribute("href")!==(f.href==null||f.href===""?null:f.href)||n.getAttribute("crossorigin")!==(f.crossOrigin==null?null:f.crossOrigin)||n.getAttribute("title")!==(f.title==null?null:f.title))break;return n;case"style":if(n.hasAttribute("data-precedence"))break;return n;case"script":if(m=n.getAttribute("src"),(m!==(f.src==null?null:f.src)||n.getAttribute("type")!==(f.type==null?null:f.type)||n.getAttribute("crossorigin")!==(f.crossOrigin==null?null:f.crossOrigin))&&m&&n.hasAttribute("async")&&!n.hasAttribute("itemprop"))break;return n;default:return n}}else if(r==="input"&&n.type==="hidden"){var m=f.name==null?null:""+f.name;if(f.type==="hidden"&&n.getAttribute("name")===m)return n}else return n;if(n=Fr(n.nextSibling),n===null)break}return null}function nj(n,r,o){if(r==="")return null;for(;n.nodeType!==3;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!o||(n=Fr(n.nextSibling),n===null))return null;return n}function yb(n,r){for(;n.nodeType!==8;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!r||(n=Fr(n.nextSibling),n===null))return null;return n}function fp(n){return n.data==="$?"||n.data==="$~"}function mp(n){return n.data==="$!"||n.data==="$?"&&n.ownerDocument.readyState!=="loading"}function sj(n,r){var o=n.ownerDocument;if(n.data==="$~")n._reactRetry=r;else if(n.data!=="$?"||o.readyState!=="loading")r();else{var c=function(){r(),o.removeEventListener("DOMContentLoaded",c)};o.addEventListener("DOMContentLoaded",c),n._reactRetry=c}}function Fr(n){for(;n!=null;n=n.nextSibling){var r=n.nodeType;if(r===1||r===3)break;if(r===8){if(r=n.data,r==="$"||r==="$!"||r==="$?"||r==="$~"||r==="&"||r==="F!"||r==="F")break;if(r==="/$"||r==="/&")return null}}return n}var pp=null;function vb(n){n=n.nextSibling;for(var r=0;n;){if(n.nodeType===8){var o=n.data;if(o==="/$"||o==="/&"){if(r===0)return Fr(n.nextSibling);r--}else o!=="$"&&o!=="$!"&&o!=="$?"&&o!=="$~"&&o!=="&"||r++}n=n.nextSibling}return null}function bb(n){n=n.previousSibling;for(var r=0;n;){if(n.nodeType===8){var o=n.data;if(o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"){if(r===0)return n;r--}else o!=="/$"&&o!=="/&"||r++}n=n.previousSibling}return null}function wb(n,r,o){switch(r=Hd(o),n){case"html":if(n=r.documentElement,!n)throw Error(i(452));return n;case"head":if(n=r.head,!n)throw Error(i(453));return n;case"body":if(n=r.body,!n)throw Error(i(454));return n;default:throw Error(i(451))}}function Pc(n){for(var r=n.attributes;r.length;)n.removeAttributeNode(r[0]);Fs(n)}var qr=new Map,xb=new Set;function $d(n){return typeof n.getRootNode=="function"?n.getRootNode():n.nodeType===9?n:n.ownerDocument}var Qi=je.d;je.d={f:rj,r:ij,D:aj,C:oj,L:lj,m:cj,X:dj,S:uj,M:hj};function rj(){var n=Qi.f(),r=Od();return n||r}function ij(n){var r=Pn(n);r!==null&&r.tag===5&&r.type==="form"?Vv(r):Qi.r(n)}var jl=typeof document>"u"?null:document;function _b(n,r,o){var c=jl;if(c&&typeof r=="string"&&r){var f=Vn(r);f='link[rel="'+n+'"][href="'+f+'"]',typeof o=="string"&&(f+='[crossorigin="'+o+'"]'),xb.has(f)||(xb.add(f),n={rel:n,crossOrigin:o,href:r},c.querySelector(f)===null&&(r=c.createElement("link"),Ps(r,"link",n),Ft(r),c.head.appendChild(r)))}}function aj(n){Qi.D(n),_b("dns-prefetch",n,null)}function oj(n,r){Qi.C(n,r),_b("preconnect",n,r)}function lj(n,r,o){Qi.L(n,r,o);var c=jl;if(c&&n&&r){var f='link[rel="preload"][as="'+Vn(r)+'"]';r==="image"&&o&&o.imageSrcSet?(f+='[imagesrcset="'+Vn(o.imageSrcSet)+'"]',typeof o.imageSizes=="string"&&(f+='[imagesizes="'+Vn(o.imageSizes)+'"]')):f+='[href="'+Vn(n)+'"]';var m=f;switch(r){case"style":m=Sl(n);break;case"script":m=Cl(n)}qr.has(m)||(n=E({rel:"preload",href:r==="image"&&o&&o.imageSrcSet?void 0:n,as:r},o),qr.set(m,n),c.querySelector(f)!==null||r==="style"&&c.querySelector(Vc(m))||r==="script"&&c.querySelector(Uc(m))||(r=c.createElement("link"),Ps(r,"link",n),Ft(r),c.head.appendChild(r)))}}function cj(n,r){Qi.m(n,r);var o=jl;if(o&&n){var c=r&&typeof r.as=="string"?r.as:"script",f='link[rel="modulepreload"][as="'+Vn(c)+'"][href="'+Vn(n)+'"]',m=f;switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":m=Cl(n)}if(!qr.has(m)&&(n=E({rel:"modulepreload",href:n},r),qr.set(m,n),o.querySelector(f)===null)){switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(o.querySelector(Uc(m)))return}c=o.createElement("link"),Ps(c,"link",n),Ft(c),o.head.appendChild(c)}}}function uj(n,r,o){Qi.S(n,r,o);var c=jl;if(c&&n){var f=ts(c).hoistableStyles,m=Sl(n);r=r||"default";var x=f.get(m);if(!x){var S={loading:0,preload:null};if(x=c.querySelector(Vc(m)))S.loading=5;else{n=E({rel:"stylesheet",href:n,"data-precedence":r},o),(o=qr.get(m))&&gp(n,o);var U=x=c.createElement("link");Ft(U),Ps(U,"link",n),U._p=new Promise(function(ne,pe){U.onload=ne,U.onerror=pe}),U.addEventListener("load",function(){S.loading|=1}),U.addEventListener("error",function(){S.loading|=2}),S.loading|=4,Wd(x,r,c)}x={type:"stylesheet",instance:x,count:1,state:S},f.set(m,x)}}}function dj(n,r){Qi.X(n,r);var o=jl;if(o&&n){var c=ts(o).hoistableScripts,f=Cl(n),m=c.get(f);m||(m=o.querySelector(Uc(f)),m||(n=E({src:n,async:!0},r),(r=qr.get(f))&&yp(n,r),m=o.createElement("script"),Ft(m),Ps(m,"link",n),o.head.appendChild(m)),m={type:"script",instance:m,count:1,state:null},c.set(f,m))}}function hj(n,r){Qi.M(n,r);var o=jl;if(o&&n){var c=ts(o).hoistableScripts,f=Cl(n),m=c.get(f);m||(m=o.querySelector(Uc(f)),m||(n=E({src:n,async:!0,type:"module"},r),(r=qr.get(f))&&yp(n,r),m=o.createElement("script"),Ft(m),Ps(m,"link",n),o.head.appendChild(m)),m={type:"script",instance:m,count:1,state:null},c.set(f,m))}}function kb(n,r,o,c){var f=(f=Se.current)?$d(f):null;if(!f)throw Error(i(446));switch(n){case"meta":case"title":return null;case"style":return typeof o.precedence=="string"&&typeof o.href=="string"?(r=Sl(o.href),o=ts(f).hoistableStyles,c=o.get(r),c||(c={type:"style",instance:null,count:0,state:null},o.set(r,c)),c):{type:"void",instance:null,count:0,state:null};case"link":if(o.rel==="stylesheet"&&typeof o.href=="string"&&typeof o.precedence=="string"){n=Sl(o.href);var m=ts(f).hoistableStyles,x=m.get(n);if(x||(f=f.ownerDocument||f,x={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},m.set(n,x),(m=f.querySelector(Vc(n)))&&!m._p&&(x.instance=m,x.state.loading=5),qr.has(n)||(o={rel:"preload",as:"style",href:o.href,crossOrigin:o.crossOrigin,integrity:o.integrity,media:o.media,hrefLang:o.hrefLang,referrerPolicy:o.referrerPolicy},qr.set(n,o),m||fj(f,n,o,x.state))),r&&c===null)throw Error(i(528,""));return x}if(r&&c!==null)throw Error(i(529,""));return null;case"script":return r=o.async,o=o.src,typeof o=="string"&&r&&typeof r!="function"&&typeof r!="symbol"?(r=Cl(o),o=ts(f).hoistableScripts,c=o.get(r),c||(c={type:"script",instance:null,count:0,state:null},o.set(r,c)),c):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,n))}}function Sl(n){return'href="'+Vn(n)+'"'}function Vc(n){return'link[rel="stylesheet"]['+n+"]"}function Eb(n){return E({},n,{"data-precedence":n.precedence,precedence:null})}function fj(n,r,o,c){n.querySelector('link[rel="preload"][as="style"]['+r+"]")?c.loading=1:(r=n.createElement("link"),c.preload=r,r.addEventListener("load",function(){return c.loading|=1}),r.addEventListener("error",function(){return c.loading|=2}),Ps(r,"link",o),Ft(r),n.head.appendChild(r))}function Cl(n){return'[src="'+Vn(n)+'"]'}function Uc(n){return"script[async]"+n}function Tb(n,r,o){if(r.count++,r.instance===null)switch(r.type){case"style":var c=n.querySelector('style[data-href~="'+Vn(o.href)+'"]');if(c)return r.instance=c,Ft(c),c;var f=E({},o,{"data-href":o.href,"data-precedence":o.precedence,href:null,precedence:null});return c=(n.ownerDocument||n).createElement("style"),Ft(c),Ps(c,"style",f),Wd(c,o.precedence,n),r.instance=c;case"stylesheet":f=Sl(o.href);var m=n.querySelector(Vc(f));if(m)return r.state.loading|=4,r.instance=m,Ft(m),m;c=Eb(o),(f=qr.get(f))&&gp(c,f),m=(n.ownerDocument||n).createElement("link"),Ft(m);var x=m;return x._p=new Promise(function(S,U){x.onload=S,x.onerror=U}),Ps(m,"link",c),r.state.loading|=4,Wd(m,o.precedence,n),r.instance=m;case"script":return m=Cl(o.src),(f=n.querySelector(Uc(m)))?(r.instance=f,Ft(f),f):(c=o,(f=qr.get(m))&&(c=E({},o),yp(c,f)),n=n.ownerDocument||n,f=n.createElement("script"),Ft(f),Ps(f,"link",c),n.head.appendChild(f),r.instance=f);case"void":return null;default:throw Error(i(443,r.type))}else r.type==="stylesheet"&&(r.state.loading&4)===0&&(c=r.instance,r.state.loading|=4,Wd(c,o.precedence,n));return r.instance}function Wd(n,r,o){for(var c=o.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),f=c.length?c[c.length-1]:null,m=f,x=0;x<c.length;x++){var S=c[x];if(S.dataset.precedence===r)m=S;else if(m!==f)break}m?m.parentNode.insertBefore(n,m.nextSibling):(r=o.nodeType===9?o.head:o,r.insertBefore(n,r.firstChild))}function gp(n,r){n.crossOrigin==null&&(n.crossOrigin=r.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=r.referrerPolicy),n.title==null&&(n.title=r.title)}function yp(n,r){n.crossOrigin==null&&(n.crossOrigin=r.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=r.referrerPolicy),n.integrity==null&&(n.integrity=r.integrity)}var Gd=null;function jb(n,r,o){if(Gd===null){var c=new Map,f=Gd=new Map;f.set(o,c)}else f=Gd,c=f.get(o),c||(c=new Map,f.set(o,c));if(c.has(n))return c;for(c.set(n,null),o=o.getElementsByTagName(n),f=0;f<o.length;f++){var m=o[f];if(!(m[$n]||m[en]||n==="link"&&m.getAttribute("rel")==="stylesheet")&&m.namespaceURI!=="http://www.w3.org/2000/svg"){var x=m.getAttribute(r)||"";x=n+x;var S=c.get(x);S?S.push(m):c.set(x,[m])}}return c}function Sb(n,r,o){n=n.ownerDocument||n,n.head.insertBefore(o,r==="title"?n.querySelector("head > title"):null)}function mj(n,r,o){if(o===1||r.itemProp!=null)return!1;switch(n){case"meta":case"title":return!0;case"style":if(typeof r.precedence!="string"||typeof r.href!="string"||r.href==="")break;return!0;case"link":if(typeof r.rel!="string"||typeof r.href!="string"||r.href===""||r.onLoad||r.onError)break;return r.rel==="stylesheet"?(n=r.disabled,typeof r.precedence=="string"&&n==null):!0;case"script":if(r.async&&typeof r.async!="function"&&typeof r.async!="symbol"&&!r.onLoad&&!r.onError&&r.src&&typeof r.src=="string")return!0}return!1}function Cb(n){return!(n.type==="stylesheet"&&(n.state.loading&3)===0)}function pj(n,r,o,c){if(o.type==="stylesheet"&&(typeof c.media!="string"||matchMedia(c.media).matches!==!1)&&(o.state.loading&4)===0){if(o.instance===null){var f=Sl(c.href),m=r.querySelector(Vc(f));if(m){r=m._p,r!==null&&typeof r=="object"&&typeof r.then=="function"&&(n.count++,n=Kd.bind(n),r.then(n,n)),o.state.loading|=4,o.instance=m,Ft(m);return}m=r.ownerDocument||r,c=Eb(c),(f=qr.get(f))&&gp(c,f),m=m.createElement("link"),Ft(m);var x=m;x._p=new Promise(function(S,U){x.onload=S,x.onerror=U}),Ps(m,"link",c),o.instance=m}n.stylesheets===null&&(n.stylesheets=new Map),n.stylesheets.set(o,r),(r=o.state.preload)&&(o.state.loading&3)===0&&(n.count++,o=Kd.bind(n),r.addEventListener("load",o),r.addEventListener("error",o))}}var vp=0;function gj(n,r){return n.stylesheets&&n.count===0&&Qd(n,n.stylesheets),0<n.count||0<n.imgCount?function(o){var c=setTimeout(function(){if(n.stylesheets&&Qd(n,n.stylesheets),n.unsuspend){var m=n.unsuspend;n.unsuspend=null,m()}},6e4+r);0<n.imgBytes&&vp===0&&(vp=62500*QT());var f=setTimeout(function(){if(n.waitingForImages=!1,n.count===0&&(n.stylesheets&&Qd(n,n.stylesheets),n.unsuspend)){var m=n.unsuspend;n.unsuspend=null,m()}},(n.imgBytes>vp?50:800)+r);return n.unsuspend=o,function(){n.unsuspend=null,clearTimeout(c),clearTimeout(f)}}:null}function Kd(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Qd(this,this.stylesheets);else if(this.unsuspend){var n=this.unsuspend;this.unsuspend=null,n()}}}var Yd=null;function Qd(n,r){n.stylesheets=null,n.unsuspend!==null&&(n.count++,Yd=new Map,r.forEach(yj,n),Yd=null,Kd.call(n))}function yj(n,r){if(!(r.state.loading&4)){var o=Yd.get(n);if(o)var c=o.get(null);else{o=new Map,Yd.set(n,o);for(var f=n.querySelectorAll("link[data-precedence],style[data-precedence]"),m=0;m<f.length;m++){var x=f[m];(x.nodeName==="LINK"||x.getAttribute("media")!=="not all")&&(o.set(x.dataset.precedence,x),c=x)}c&&o.set(null,c)}f=r.instance,x=f.getAttribute("data-precedence"),m=o.get(x)||c,m===c&&o.set(null,f),o.set(x,f),this.count++,c=Kd.bind(this),f.addEventListener("load",c),f.addEventListener("error",c),m?m.parentNode.insertBefore(f,m.nextSibling):(n=n.nodeType===9?n.head:n,n.insertBefore(f,n.firstChild)),r.state.loading|=4}}var Bc={$$typeof:Q,Provider:null,Consumer:null,_currentValue:De,_currentValue2:De,_threadCount:0};function vj(n,r,o,c,f,m,x,S,U){this.tag=1,this.containerInfo=n,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Me(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Me(0),this.hiddenUpdates=Me(null),this.identifierPrefix=c,this.onUncaughtError=f,this.onCaughtError=m,this.onRecoverableError=x,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=U,this.incompleteTransitions=new Map}function Nb(n,r,o,c,f,m,x,S,U,ne,pe,ke){return n=new vj(n,r,o,x,U,ne,pe,ke,S),r=1,m===!0&&(r|=24),m=wr(3,null,null,r),n.current=m,m.stateNode=n,r=Xf(),r.refCount++,n.pooledCache=r,r.refCount++,m.memoizedState={element:c,isDehydrated:o,cache:r},tm(m),n}function Ab(n){return n?(n=il,n):il}function Rb(n,r,o,c,f,m){f=Ab(f),c.context===null?c.context=f:c.pendingContext=f,c=_a(r),c.payload={element:o},m=m===void 0?null:m,m!==null&&(c.callback=m),o=ka(n,c,r),o!==null&&(dr(o,n,r),vc(o,n,r))}function Ib(n,r){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var o=n.retryLane;n.retryLane=o!==0&&o<r?o:r}}function bp(n,r){Ib(n,r),(n=n.alternate)&&Ib(n,r)}function Mb(n){if(n.tag===13||n.tag===31){var r=po(n,67108864);r!==null&&dr(r,n,67108864),bp(n,67108864)}}function Db(n){if(n.tag===13||n.tag===31){var r=Tr();r=an(r);var o=po(n,r);o!==null&&dr(o,n,r),bp(n,r)}}var Xd=!0;function bj(n,r,o,c){var f=X.T;X.T=null;var m=je.p;try{je.p=2,wp(n,r,o,c)}finally{je.p=m,X.T=f}}function wj(n,r,o,c){var f=X.T;X.T=null;var m=je.p;try{je.p=8,wp(n,r,o,c)}finally{je.p=m,X.T=f}}function wp(n,r,o,c){if(Xd){var f=xp(c);if(f===null)ap(n,r,c,Jd,o),Ob(n,c);else if(_j(f,n,r,o,c))c.stopPropagation();else if(Ob(n,c),r&4&&-1<xj.indexOf(n)){for(;f!==null;){var m=Pn(f);if(m!==null)switch(m.tag){case 3:if(m=m.stateNode,m.current.memoizedState.isDehydrated){var x=Hn(m.pendingLanes);if(x!==0){var S=m;for(S.pendingLanes|=2,S.entangledLanes|=2;x;){var U=1<<31-$e(x);S.entanglements[1]|=U,x&=~U}xi(m),(ln&6)===0&&(Dd=pt()+500,Dc(0))}}break;case 31:case 13:S=po(m,2),S!==null&&dr(S,m,2),Od(),bp(m,2)}if(m=xp(c),m===null&&ap(n,r,c,Jd,o),m===f)break;f=m}f!==null&&c.stopPropagation()}else ap(n,r,c,null,o)}}function xp(n){return n=oe(n),_p(n)}var Jd=null;function _p(n){if(Jd=null,n=ws(n),n!==null){var r=u(n);if(r===null)n=null;else{var o=r.tag;if(o===13){if(n=d(r),n!==null)return n;n=null}else if(o===31){if(n=p(r),n!==null)return n;n=null}else if(o===3){if(r.stateNode.current.memoizedState.isDehydrated)return r.tag===3?r.stateNode.containerInfo:null;n=null}else r!==n&&(n=null)}}return Jd=n,null}function Lb(n){switch(n){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Xt()){case zs:return 2;case es:return 8;case Wt:case se:return 32;case Ae:return 268435456;default:return 32}default:return 32}}var kp=!1,Da=null,La=null,Oa=null,zc=new Map,Fc=new Map,Pa=[],xj="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Ob(n,r){switch(n){case"focusin":case"focusout":Da=null;break;case"dragenter":case"dragleave":La=null;break;case"mouseover":case"mouseout":Oa=null;break;case"pointerover":case"pointerout":zc.delete(r.pointerId);break;case"gotpointercapture":case"lostpointercapture":Fc.delete(r.pointerId)}}function qc(n,r,o,c,f,m){return n===null||n.nativeEvent!==m?(n={blockedOn:r,domEventName:o,eventSystemFlags:c,nativeEvent:m,targetContainers:[f]},r!==null&&(r=Pn(r),r!==null&&Mb(r)),n):(n.eventSystemFlags|=c,r=n.targetContainers,f!==null&&r.indexOf(f)===-1&&r.push(f),n)}function _j(n,r,o,c,f){switch(r){case"focusin":return Da=qc(Da,n,r,o,c,f),!0;case"dragenter":return La=qc(La,n,r,o,c,f),!0;case"mouseover":return Oa=qc(Oa,n,r,o,c,f),!0;case"pointerover":var m=f.pointerId;return zc.set(m,qc(zc.get(m)||null,n,r,o,c,f)),!0;case"gotpointercapture":return m=f.pointerId,Fc.set(m,qc(Fc.get(m)||null,n,r,o,c,f)),!0}return!1}function Pb(n){var r=ws(n.target);if(r!==null){var o=u(r);if(o!==null){if(r=o.tag,r===13){if(r=d(o),r!==null){n.blockedOn=r,Nn(n.priority,function(){Db(o)});return}}else if(r===31){if(r=p(o),r!==null){n.blockedOn=r,Nn(n.priority,function(){Db(o)});return}}else if(r===3&&o.stateNode.current.memoizedState.isDehydrated){n.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}n.blockedOn=null}function Zd(n){if(n.blockedOn!==null)return!1;for(var r=n.targetContainers;0<r.length;){var o=xp(n.nativeEvent);if(o===null){o=n.nativeEvent;var c=new o.constructor(o.type,o);F=c,o.target.dispatchEvent(c),F=null}else return r=Pn(o),r!==null&&Mb(r),n.blockedOn=o,!1;r.shift()}return!0}function Vb(n,r,o){Zd(n)&&o.delete(r)}function kj(){kp=!1,Da!==null&&Zd(Da)&&(Da=null),La!==null&&Zd(La)&&(La=null),Oa!==null&&Zd(Oa)&&(Oa=null),zc.forEach(Vb),Fc.forEach(Vb)}function eh(n,r){n.blockedOn===r&&(n.blockedOn=null,kp||(kp=!0,s.unstable_scheduleCallback(s.unstable_NormalPriority,kj)))}var th=null;function Ub(n){th!==n&&(th=n,s.unstable_scheduleCallback(s.unstable_NormalPriority,function(){th===n&&(th=null);for(var r=0;r<n.length;r+=3){var o=n[r],c=n[r+1],f=n[r+2];if(typeof c!="function"){if(_p(c||o)===null)continue;break}var m=Pn(o);m!==null&&(n.splice(r,3),r-=3,xm(m,{pending:!0,data:f,method:o.method,action:c},c,f))}}))}function Nl(n){function r(U){return eh(U,n)}Da!==null&&eh(Da,n),La!==null&&eh(La,n),Oa!==null&&eh(Oa,n),zc.forEach(r),Fc.forEach(r);for(var o=0;o<Pa.length;o++){var c=Pa[o];c.blockedOn===n&&(c.blockedOn=null)}for(;0<Pa.length&&(o=Pa[0],o.blockedOn===null);)Pb(o),o.blockedOn===null&&Pa.shift();if(o=(n.ownerDocument||n).$$reactFormReplay,o!=null)for(c=0;c<o.length;c+=3){var f=o[c],m=o[c+1],x=f[un]||null;if(typeof m=="function")x||Ub(o);else if(x){var S=null;if(m&&m.hasAttribute("formAction")){if(f=m,x=m[un]||null)S=x.formAction;else if(_p(f)!==null)continue}else S=x.action;typeof S=="function"?o[c+1]=S:(o.splice(c,3),c-=3),Ub(o)}}}function Bb(){function n(m){m.canIntercept&&m.info==="react-transition"&&m.intercept({handler:function(){return new Promise(function(x){return f=x})},focusReset:"manual",scroll:"manual"})}function r(){f!==null&&(f(),f=null),c||setTimeout(o,20)}function o(){if(!c&&!navigation.transition){var m=navigation.currentEntry;m&&m.url!=null&&navigation.navigate(m.url,{state:m.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var c=!1,f=null;return navigation.addEventListener("navigate",n),navigation.addEventListener("navigatesuccess",r),navigation.addEventListener("navigateerror",r),setTimeout(o,100),function(){c=!0,navigation.removeEventListener("navigate",n),navigation.removeEventListener("navigatesuccess",r),navigation.removeEventListener("navigateerror",r),f!==null&&(f(),f=null)}}}function Ep(n){this._internalRoot=n}nh.prototype.render=Ep.prototype.render=function(n){var r=this._internalRoot;if(r===null)throw Error(i(409));var o=r.current,c=Tr();Rb(o,c,n,r,null,null)},nh.prototype.unmount=Ep.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var r=n.containerInfo;Rb(n.current,2,null,n,null,null),Od(),r[cs]=null}};function nh(n){this._internalRoot=n}nh.prototype.unstable_scheduleHydration=function(n){if(n){var r=vs();n={blockedOn:null,target:n,priority:r};for(var o=0;o<Pa.length&&r!==0&&r<Pa[o].priority;o++);Pa.splice(o,0,n),o===0&&Pb(n)}};var zb=e.version;if(zb!=="19.2.4")throw Error(i(527,zb,"19.2.4"));je.findDOMNode=function(n){var r=n._reactInternals;if(r===void 0)throw typeof n.render=="function"?Error(i(188)):(n=Object.keys(n).join(","),Error(i(268,n)));return n=y(r),n=n!==null?b(n):null,n=n===null?null:n.stateNode,n};var Ej={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:X,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var sh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!sh.isDisabled&&sh.supportsFiber)try{ut=sh.inject(Ej),He=sh}catch{}}return $c.createRoot=function(n,r){if(!l(n))throw Error(i(299));var o=!1,c="",f=Kv,m=Yv,x=Qv;return r!=null&&(r.unstable_strictMode===!0&&(o=!0),r.identifierPrefix!==void 0&&(c=r.identifierPrefix),r.onUncaughtError!==void 0&&(f=r.onUncaughtError),r.onCaughtError!==void 0&&(m=r.onCaughtError),r.onRecoverableError!==void 0&&(x=r.onRecoverableError)),r=Nb(n,1,!1,null,null,o,c,null,f,m,x,Bb),n[cs]=r.current,ip(n),new Ep(r)},$c.hydrateRoot=function(n,r,o){if(!l(n))throw Error(i(299));var c=!1,f="",m=Kv,x=Yv,S=Qv,U=null;return o!=null&&(o.unstable_strictMode===!0&&(c=!0),o.identifierPrefix!==void 0&&(f=o.identifierPrefix),o.onUncaughtError!==void 0&&(m=o.onUncaughtError),o.onCaughtError!==void 0&&(x=o.onCaughtError),o.onRecoverableError!==void 0&&(S=o.onRecoverableError),o.formState!==void 0&&(U=o.formState)),r=Nb(n,1,!0,r,o??null,c,f,U,m,x,S,Bb),r.context=Ab(null),o=r.current,c=Tr(),c=an(c),f=_a(c),f.callback=null,ka(o,f,c),o=c,r.current.lanes=o,Ye(r,o),xi(r),n[cs]=r.current,ip(n),new nh(r)},$c.version="19.2.4",$c}var Xb;function Dj(){if(Xb)return Sp.exports;Xb=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(e){console.error(e)}}return s(),Sp.exports=Mj(),Sp.exports}var Lj=Dj();const Oj="modulepreload",Pj=function(s){return"/login/"+s},Jb={},Ks=function(e,t,i){let l=Promise.resolve();if(t&&t.length>0){let g=function(y){return Promise.all(y.map(b=>Promise.resolve(b).then(E=>({status:"fulfilled",value:E}),E=>({status:"rejected",reason:E}))))};document.getElementsByTagName("link");const d=document.querySelector("meta[property=csp-nonce]"),p=d?.nonce||d?.getAttribute("nonce");l=g(t.map(y=>{if(y=Pj(y),y in Jb)return;Jb[y]=!0;const b=y.endsWith(".css"),E=b?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${y}"]${E}`))return;const T=document.createElement("link");if(T.rel=b?"stylesheet":Oj,b||(T.as="script"),T.crossOrigin="",T.href=y,p&&T.setAttribute("nonce",p),document.head.appendChild(T),b)return new Promise((L,W)=>{T.addEventListener("load",L),T.addEventListener("error",()=>W(new Error(`Unable to preload CSS for ${y}`)))})}))}function u(d){const p=new Event("vite:preloadError",{cancelable:!0});if(p.payload=d,window.dispatchEvent(p),!p.defaultPrevented)throw d}return l.then(d=>{for(const p of d||[])p.status==="rejected"&&u(p.reason);return e().catch(u)})};var Zb="popstate";function Vj(s={}){function e(i,l){let{pathname:u,search:d,hash:p}=i.location;return pg("",{pathname:u,search:d,hash:p},l.state&&l.state.usr||null,l.state&&l.state.key||"default")}function t(i,l){return typeof l=="string"?l:hu(l)}return Bj(e,t,null,s)}function Fn(s,e){if(s===!1||s===null||typeof s>"u")throw new Error(e)}function Gr(s,e){if(!s){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function Uj(){return Math.random().toString(36).substring(2,10)}function e2(s,e){return{usr:s.state,key:s.key,idx:e}}function pg(s,e,t=null,i){return{pathname:typeof s=="string"?s:s.pathname,search:"",hash:"",...typeof e=="string"?Ql(e):e,state:t,key:e&&e.key||i||Uj()}}function hu({pathname:s="/",search:e="",hash:t=""}){return e&&e!=="?"&&(s+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(s+=t.charAt(0)==="#"?t:"#"+t),s}function Ql(s){let e={};if(s){let t=s.indexOf("#");t>=0&&(e.hash=s.substring(t),s=s.substring(0,t));let i=s.indexOf("?");i>=0&&(e.search=s.substring(i),s=s.substring(0,i)),s&&(e.pathname=s)}return e}function Bj(s,e,t,i={}){let{window:l=document.defaultView,v5Compat:u=!1}=i,d=l.history,p="POP",g=null,y=b();y==null&&(y=0,d.replaceState({...d.state,idx:y},""));function b(){return(d.state||{idx:null}).idx}function E(){p="POP";let B=b(),K=B==null?null:B-y;y=B,g&&g({action:p,location:H.location,delta:K})}function T(B,K){p="PUSH";let G=pg(H.location,B,K);y=b()+1;let Q=e2(G,y),he=H.createHref(G);try{d.pushState(Q,"",he)}catch(Ee){if(Ee instanceof DOMException&&Ee.name==="DataCloneError")throw Ee;l.location.assign(he)}u&&g&&g({action:p,location:H.location,delta:1})}function L(B,K){p="REPLACE";let G=pg(H.location,B,K);y=b();let Q=e2(G,y),he=H.createHref(G);d.replaceState(Q,"",he),u&&g&&g({action:p,location:H.location,delta:0})}function W(B){return zj(B)}let H={get action(){return p},get location(){return s(l,d)},listen(B){if(g)throw new Error("A history only accepts one active listener");return l.addEventListener(Zb,E),g=B,()=>{l.removeEventListener(Zb,E),g=null}},createHref(B){return e(l,B)},createURL:W,encodeLocation(B){let K=W(B);return{pathname:K.pathname,search:K.search,hash:K.hash}},push:T,replace:L,go(B){return d.go(B)}};return H}function zj(s,e=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),Fn(t,"No window.location.(origin|href) available to create URL");let i=typeof s=="string"?s:hu(s);return i=i.replace(/ $/,"%20"),!e&&i.startsWith("//")&&(i=t+i),new URL(i,t)}function mx(s,e,t="/"){return Fj(s,e,t,!1)}function Fj(s,e,t,i){let l=typeof e=="string"?Ql(e):e,u=ra(l.pathname||"/",t);if(u==null)return null;let d=px(s);qj(d);let p=null;for(let g=0;p==null&&g<d.length;++g){let y=eS(u);p=Jj(d[g],y,i)}return p}function px(s,e=[],t=[],i="",l=!1){let u=(d,p,g=l,y)=>{let b={relativePath:y===void 0?d.path||"":y,caseSensitive:d.caseSensitive===!0,childrenIndex:p,route:d};if(b.relativePath.startsWith("/")){if(!b.relativePath.startsWith(i)&&g)return;Fn(b.relativePath.startsWith(i),`Absolute route path "${b.relativePath}" nested under path "${i}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),b.relativePath=b.relativePath.slice(i.length)}let E=ea([i,b.relativePath]),T=t.concat(b);d.children&&d.children.length>0&&(Fn(d.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${E}".`),px(d.children,e,T,E,g)),!(d.path==null&&!d.index)&&e.push({path:E,score:Qj(E,d.index),routesMeta:T})};return s.forEach((d,p)=>{if(d.path===""||!d.path?.includes("?"))u(d,p);else for(let g of gx(d.path))u(d,p,!0,g)}),e}function gx(s){let e=s.split("/");if(e.length===0)return[];let[t,...i]=e,l=t.endsWith("?"),u=t.replace(/\?$/,"");if(i.length===0)return l?[u,""]:[u];let d=gx(i.join("/")),p=[];return p.push(...d.map(g=>g===""?u:[u,g].join("/"))),l&&p.push(...d),p.map(g=>s.startsWith("/")&&g===""?"/":g)}function qj(s){s.sort((e,t)=>e.score!==t.score?t.score-e.score:Xj(e.routesMeta.map(i=>i.childrenIndex),t.routesMeta.map(i=>i.childrenIndex)))}var Hj=/^:[\w-]+$/,$j=3,Wj=2,Gj=1,Kj=10,Yj=-2,t2=s=>s==="*";function Qj(s,e){let t=s.split("/"),i=t.length;return t.some(t2)&&(i+=Yj),e&&(i+=Wj),t.filter(l=>!t2(l)).reduce((l,u)=>l+(Hj.test(u)?$j:u===""?Gj:Kj),i)}function Xj(s,e){return s.length===e.length&&s.slice(0,-1).every((i,l)=>i===e[l])?s[s.length-1]-e[e.length-1]:0}function Jj(s,e,t=!1){let{routesMeta:i}=s,l={},u="/",d=[];for(let p=0;p<i.length;++p){let g=i[p],y=p===i.length-1,b=u==="/"?e:e.slice(u.length)||"/",E=Ih({path:g.relativePath,caseSensitive:g.caseSensitive,end:y},b),T=g.route;if(!E&&y&&t&&!i[i.length-1].route.index&&(E=Ih({path:g.relativePath,caseSensitive:g.caseSensitive,end:!1},b)),!E)return null;Object.assign(l,E.params),d.push({params:l,pathname:ea([u,E.pathname]),pathnameBase:rS(ea([u,E.pathnameBase])),route:T}),E.pathnameBase!=="/"&&(u=ea([u,E.pathnameBase]))}return d}function Ih(s,e){typeof s=="string"&&(s={path:s,caseSensitive:!1,end:!0});let[t,i]=Zj(s.path,s.caseSensitive,s.end),l=e.match(t);if(!l)return null;let u=l[0],d=u.replace(/(.)\/+$/,"$1"),p=l.slice(1);return{params:i.reduce((y,{paramName:b,isOptional:E},T)=>{if(b==="*"){let W=p[T]||"";d=u.slice(0,u.length-W.length).replace(/(.)\/+$/,"$1")}const L=p[T];return E&&!L?y[b]=void 0:y[b]=(L||"").replace(/%2F/g,"/"),y},{}),pathname:u,pathnameBase:d,pattern:s}}function Zj(s,e=!1,t=!0){Gr(s==="*"||!s.endsWith("*")||s.endsWith("/*"),`Route path "${s}" will be treated as if it were "${s.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${s.replace(/\*$/,"/*")}".`);let i=[],l="^"+s.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(d,p,g)=>(i.push({paramName:p,isOptional:g!=null}),g?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return s.endsWith("*")?(i.push({paramName:"*"}),l+=s==="*"||s==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?l+="\\/*$":s!==""&&s!=="/"&&(l+="(?:(?=\\/|$))"),[new RegExp(l,e?void 0:"i"),i]}function eS(s){try{return s.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Gr(!1,`The URL path "${s}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),s}}function ra(s,e){if(e==="/")return s;if(!s.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,i=s.charAt(t);return i&&i!=="/"?null:s.slice(t)||"/"}var tS=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i;function nS(s,e="/"){let{pathname:t,search:i="",hash:l=""}=typeof s=="string"?Ql(s):s,u;return t?(t=t.replace(/\/\/+/g,"/"),t.startsWith("/")?u=n2(t.substring(1),"/"):u=n2(t,e)):u=e,{pathname:u,search:iS(i),hash:aS(l)}}function n2(s,e){let t=e.replace(/\/+$/,"").split("/");return s.split("/").forEach(l=>{l===".."?t.length>1&&t.pop():l!=="."&&t.push(l)}),t.length>1?t.join("/"):"/"}function Rp(s,e,t,i){return`Cannot include a '${s}' character in a manually specified \`to.${e}\` field [${JSON.stringify(i)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function sS(s){return s.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function Xg(s){let e=sS(s);return e.map((t,i)=>i===e.length-1?t.pathname:t.pathnameBase)}function Jg(s,e,t,i=!1){let l;typeof s=="string"?l=Ql(s):(l={...s},Fn(!l.pathname||!l.pathname.includes("?"),Rp("?","pathname","search",l)),Fn(!l.pathname||!l.pathname.includes("#"),Rp("#","pathname","hash",l)),Fn(!l.search||!l.search.includes("#"),Rp("#","search","hash",l)));let u=s===""||l.pathname==="",d=u?"/":l.pathname,p;if(d==null)p=t;else{let E=e.length-1;if(!i&&d.startsWith("..")){let T=d.split("/");for(;T[0]==="..";)T.shift(),E-=1;l.pathname=T.join("/")}p=E>=0?e[E]:"/"}let g=nS(l,p),y=d&&d!=="/"&&d.endsWith("/"),b=(u||d===".")&&t.endsWith("/");return!g.pathname.endsWith("/")&&(y||b)&&(g.pathname+="/"),g}var ea=s=>s.join("/").replace(/\/\/+/g,"/"),rS=s=>s.replace(/\/+$/,"").replace(/^\/*/,"/"),iS=s=>!s||s==="?"?"":s.startsWith("?")?s:"?"+s,aS=s=>!s||s==="#"?"":s.startsWith("#")?s:"#"+s,oS=class{constructor(s,e,t,i=!1){this.status=s,this.statusText=e||"",this.internal=i,t instanceof Error?(this.data=t.toString(),this.error=t):this.data=t}};function lS(s){return s!=null&&typeof s.status=="number"&&typeof s.statusText=="string"&&typeof s.internal=="boolean"&&"data"in s}function cS(s){return s.map(e=>e.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var yx=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function vx(s,e){let t=s;if(typeof t!="string"||!tS.test(t))return{absoluteURL:void 0,isExternal:!1,to:t};let i=t,l=!1;if(yx)try{let u=new URL(window.location.href),d=t.startsWith("//")?new URL(u.protocol+t):new URL(t),p=ra(d.pathname,e);d.origin===u.origin&&p!=null?t=p+d.search+d.hash:l=!0}catch{Gr(!1,`<Link to="${t}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:i,isExternal:l,to:t}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var bx=["POST","PUT","PATCH","DELETE"];new Set(bx);var uS=["GET",...bx];new Set(uS);var Xl=w.createContext(null);Xl.displayName="DataRouter";var tf=w.createContext(null);tf.displayName="DataRouterState";var dS=w.createContext(!1),wx=w.createContext({isTransitioning:!1});wx.displayName="ViewTransition";var hS=w.createContext(new Map);hS.displayName="Fetchers";var fS=w.createContext(null);fS.displayName="Await";var Nr=w.createContext(null);Nr.displayName="Navigation";var Su=w.createContext(null);Su.displayName="Location";var di=w.createContext({outlet:null,matches:[],isDataRoute:!1});di.displayName="Route";var Zg=w.createContext(null);Zg.displayName="RouteError";var xx="REACT_ROUTER_ERROR",mS="REDIRECT",pS="ROUTE_ERROR_RESPONSE";function gS(s){if(s.startsWith(`${xx}:${mS}:{`))try{let e=JSON.parse(s.slice(28));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.location=="string"&&typeof e.reloadDocument=="boolean"&&typeof e.replace=="boolean")return e}catch{}}function yS(s){if(s.startsWith(`${xx}:${pS}:{`))try{let e=JSON.parse(s.slice(40));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string")return new oS(e.status,e.statusText,e.data)}catch{}}function vS(s,{relative:e}={}){Fn(Jl(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:i}=w.useContext(Nr),{hash:l,pathname:u,search:d}=Cu(s,{relative:e}),p=u;return t!=="/"&&(p=u==="/"?t:ea([t,u])),i.createHref({pathname:p,search:d,hash:l})}function Jl(){return w.useContext(Su)!=null}function Ii(){return Fn(Jl(),"useLocation() may be used only in the context of a <Router> component."),w.useContext(Su).location}var _x="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function kx(s){w.useContext(Nr).static||w.useLayoutEffect(s)}function Ys(){let{isDataRoute:s}=w.useContext(di);return s?IS():bS()}function bS(){Fn(Jl(),"useNavigate() may be used only in the context of a <Router> component.");let s=w.useContext(Xl),{basename:e,navigator:t}=w.useContext(Nr),{matches:i}=w.useContext(di),{pathname:l}=Ii(),u=JSON.stringify(Xg(i)),d=w.useRef(!1);return kx(()=>{d.current=!0}),w.useCallback((g,y={})=>{if(Gr(d.current,_x),!d.current)return;if(typeof g=="number"){t.go(g);return}let b=Jg(g,JSON.parse(u),l,y.relative==="path");s==null&&e!=="/"&&(b.pathname=b.pathname==="/"?e:ea([e,b.pathname])),(y.replace?t.replace:t.push)(b,y.state,y)},[e,t,u,l,s])}w.createContext(null);function wS(){let{matches:s}=w.useContext(di),e=s[s.length-1];return e?e.params:{}}function Cu(s,{relative:e}={}){let{matches:t}=w.useContext(di),{pathname:i}=Ii(),l=JSON.stringify(Xg(t));return w.useMemo(()=>Jg(s,JSON.parse(l),i,e==="path"),[s,l,i,e])}function xS(s,e){return Ex(s,e)}function Ex(s,e,t,i,l){Fn(Jl(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:u}=w.useContext(Nr),{matches:d}=w.useContext(di),p=d[d.length-1],g=p?p.params:{},y=p?p.pathname:"/",b=p?p.pathnameBase:"/",E=p&&p.route;{let G=E&&E.path||"";jx(y,!E||G.endsWith("*")||G.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${y}" (under <Route path="${G}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${G}"> to <Route path="${G==="/"?"*":`${G}/*`}">.`)}let T=Ii(),L;if(e){let G=typeof e=="string"?Ql(e):e;Fn(b==="/"||G.pathname?.startsWith(b),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${b}" but pathname "${G.pathname}" was given in the \`location\` prop.`),L=G}else L=T;let W=L.pathname||"/",H=W;if(b!=="/"){let G=b.replace(/^\//,"").split("/");H="/"+W.replace(/^\//,"").split("/").slice(G.length).join("/")}let B=mx(s,{pathname:H});Gr(E||B!=null,`No routes matched location "${L.pathname}${L.search}${L.hash}" `),Gr(B==null||B[B.length-1].route.element!==void 0||B[B.length-1].route.Component!==void 0||B[B.length-1].route.lazy!==void 0,`Matched leaf route at location "${L.pathname}${L.search}${L.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let K=jS(B&&B.map(G=>Object.assign({},G,{params:Object.assign({},g,G.params),pathname:ea([b,u.encodeLocation?u.encodeLocation(G.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:G.pathname]),pathnameBase:G.pathnameBase==="/"?b:ea([b,u.encodeLocation?u.encodeLocation(G.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:G.pathnameBase])})),d,t,i,l);return e&&K?w.createElement(Su.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...L},navigationType:"POP"}},K):K}function _S(){let s=RS(),e=lS(s)?`${s.status} ${s.statusText}`:s instanceof Error?s.message:JSON.stringify(s),t=s instanceof Error?s.stack:null,i="rgba(200,200,200, 0.5)",l={padding:"0.5rem",backgroundColor:i},u={padding:"2px 4px",backgroundColor:i},d=null;return console.error("Error handled by React Router default ErrorBoundary:",s),d=w.createElement(w.Fragment,null,w.createElement("p",null," Hey developer "),w.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",w.createElement("code",{style:u},"ErrorBoundary")," or"," ",w.createElement("code",{style:u},"errorElement")," prop on your route.")),w.createElement(w.Fragment,null,w.createElement("h2",null,"Unexpected Application Error!"),w.createElement("h3",{style:{fontStyle:"italic"}},e),t?w.createElement("pre",{style:l},t):null,d)}var kS=w.createElement(_S,null),Tx=class extends w.Component{constructor(s){super(s),this.state={location:s.location,revalidation:s.revalidation,error:s.error}}static getDerivedStateFromError(s){return{error:s}}static getDerivedStateFromProps(s,e){return e.location!==s.location||e.revalidation!=="idle"&&s.revalidation==="idle"?{error:s.error,location:s.location,revalidation:s.revalidation}:{error:s.error!==void 0?s.error:e.error,location:e.location,revalidation:s.revalidation||e.revalidation}}componentDidCatch(s,e){this.props.onError?this.props.onError(s,e):console.error("React Router caught the following error during render",s)}render(){let s=this.state.error;if(this.context&&typeof s=="object"&&s&&"digest"in s&&typeof s.digest=="string"){const t=yS(s.digest);t&&(s=t)}let e=s!==void 0?w.createElement(di.Provider,{value:this.props.routeContext},w.createElement(Zg.Provider,{value:s,children:this.props.component})):this.props.children;return this.context?w.createElement(ES,{error:s},e):e}};Tx.contextType=dS;var Ip=new WeakMap;function ES({children:s,error:e}){let{basename:t}=w.useContext(Nr);if(typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){let i=gS(e.digest);if(i){let l=Ip.get(e);if(l)throw l;let u=vx(i.location,t);if(yx&&!Ip.get(e))if(u.isExternal||i.reloadDocument)window.location.href=u.absoluteURL||u.to;else{const d=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(u.to,{replace:i.replace}));throw Ip.set(e,d),d}return w.createElement("meta",{httpEquiv:"refresh",content:`0;url=${u.absoluteURL||u.to}`})}}return s}function TS({routeContext:s,match:e,children:t}){let i=w.useContext(Xl);return i&&i.static&&i.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=e.route.id),w.createElement(di.Provider,{value:s},t)}function jS(s,e=[],t=null,i=null,l=null){if(s==null){if(!t)return null;if(t.errors)s=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)s=t.matches;else return null}let u=s,d=t?.errors;if(d!=null){let b=u.findIndex(E=>E.route.id&&d?.[E.route.id]!==void 0);Fn(b>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(d).join(",")}`),u=u.slice(0,Math.min(u.length,b+1))}let p=!1,g=-1;if(t)for(let b=0;b<u.length;b++){let E=u[b];if((E.route.HydrateFallback||E.route.hydrateFallbackElement)&&(g=b),E.route.id){let{loaderData:T,errors:L}=t,W=E.route.loader&&!T.hasOwnProperty(E.route.id)&&(!L||L[E.route.id]===void 0);if(E.route.lazy||W){p=!0,g>=0?u=u.slice(0,g+1):u=[u[0]];break}}}let y=t&&i?(b,E)=>{i(b,{location:t.location,params:t.matches?.[0]?.params??{},unstable_pattern:cS(t.matches),errorInfo:E})}:void 0;return u.reduceRight((b,E,T)=>{let L,W=!1,H=null,B=null;t&&(L=d&&E.route.id?d[E.route.id]:void 0,H=E.route.errorElement||kS,p&&(g<0&&T===0?(jx("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),W=!0,B=null):g===T&&(W=!0,B=E.route.hydrateFallbackElement||null)));let K=e.concat(u.slice(0,T+1)),G=()=>{let Q;return L?Q=H:W?Q=B:E.route.Component?Q=w.createElement(E.route.Component,null):E.route.element?Q=E.route.element:Q=b,w.createElement(TS,{match:E,routeContext:{outlet:b,matches:K,isDataRoute:t!=null},children:Q})};return t&&(E.route.ErrorBoundary||E.route.errorElement||T===0)?w.createElement(Tx,{location:t.location,revalidation:t.revalidation,component:H,error:L,children:G(),routeContext:{outlet:null,matches:K,isDataRoute:!0},onError:y}):G()},null)}function ey(s){return`${s} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function SS(s){let e=w.useContext(Xl);return Fn(e,ey(s)),e}function CS(s){let e=w.useContext(tf);return Fn(e,ey(s)),e}function NS(s){let e=w.useContext(di);return Fn(e,ey(s)),e}function ty(s){let e=NS(s),t=e.matches[e.matches.length-1];return Fn(t.route.id,`${s} can only be used on routes that contain a unique "id"`),t.route.id}function AS(){return ty("useRouteId")}function RS(){let s=w.useContext(Zg),e=CS("useRouteError"),t=ty("useRouteError");return s!==void 0?s:e.errors?.[t]}function IS(){let{router:s}=SS("useNavigate"),e=ty("useNavigate"),t=w.useRef(!1);return kx(()=>{t.current=!0}),w.useCallback(async(l,u={})=>{Gr(t.current,_x),t.current&&(typeof l=="number"?await s.navigate(l):await s.navigate(l,{fromRouteId:e,...u}))},[s,e])}var s2={};function jx(s,e,t){!e&&!s2[s]&&(s2[s]=!0,Gr(!1,t))}w.memo(MS);function MS({routes:s,future:e,state:t,onError:i}){return Ex(s,void 0,t,i,e)}function Sx({to:s,replace:e,state:t,relative:i}){Fn(Jl(),"<Navigate> may be used only in the context of a <Router> component.");let{static:l}=w.useContext(Nr);Gr(!l,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:u}=w.useContext(di),{pathname:d}=Ii(),p=Ys(),g=Jg(s,Xg(u),d,i==="path"),y=JSON.stringify(g);return w.useEffect(()=>{p(JSON.parse(y),{replace:e,state:t,relative:i})},[p,y,i,e,t]),null}function kn(s){Fn(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function DS({basename:s="/",children:e=null,location:t,navigationType:i="POP",navigator:l,static:u=!1,unstable_useTransitions:d}){Fn(!Jl(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let p=s.replace(/^\/*/,"/"),g=w.useMemo(()=>({basename:p,navigator:l,static:u,unstable_useTransitions:d,future:{}}),[p,l,u,d]);typeof t=="string"&&(t=Ql(t));let{pathname:y="/",search:b="",hash:E="",state:T=null,key:L="default"}=t,W=w.useMemo(()=>{let H=ra(y,p);return H==null?null:{location:{pathname:H,search:b,hash:E,state:T,key:L},navigationType:i}},[p,y,b,E,T,L,i]);return Gr(W!=null,`<Router basename="${p}"> is not able to match the URL "${y}${b}${E}" because it does not start with the basename, so the <Router> won't render anything.`),W==null?null:w.createElement(Nr.Provider,{value:g},w.createElement(Su.Provider,{children:e,value:W}))}function LS({children:s,location:e}){return xS(gg(s),e)}function gg(s,e=[]){let t=[];return w.Children.forEach(s,(i,l)=>{if(!w.isValidElement(i))return;let u=[...e,l];if(i.type===w.Fragment){t.push.apply(t,gg(i.props.children,u));return}Fn(i.type===kn,`[${typeof i.type=="string"?i.type:i.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Fn(!i.props.index||!i.props.children,"An index route cannot have child routes.");let d={id:i.props.id||u.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,middleware:i.props.middleware,loader:i.props.loader,action:i.props.action,hydrateFallbackElement:i.props.hydrateFallbackElement,HydrateFallback:i.props.HydrateFallback,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.hasErrorBoundary===!0||i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(d.children=gg(i.props.children,u)),t.push(d)}),t}var bh="get",wh="application/x-www-form-urlencoded";function nf(s){return typeof HTMLElement<"u"&&s instanceof HTMLElement}function OS(s){return nf(s)&&s.tagName.toLowerCase()==="button"}function PS(s){return nf(s)&&s.tagName.toLowerCase()==="form"}function VS(s){return nf(s)&&s.tagName.toLowerCase()==="input"}function US(s){return!!(s.metaKey||s.altKey||s.ctrlKey||s.shiftKey)}function BS(s,e){return s.button===0&&(!e||e==="_self")&&!US(s)}function yg(s=""){return new URLSearchParams(typeof s=="string"||Array.isArray(s)||s instanceof URLSearchParams?s:Object.keys(s).reduce((e,t)=>{let i=s[t];return e.concat(Array.isArray(i)?i.map(l=>[t,l]):[[t,i]])},[]))}function zS(s,e){let t=yg(s);return e&&e.forEach((i,l)=>{t.has(l)||e.getAll(l).forEach(u=>{t.append(l,u)})}),t}var rh=null;function FS(){if(rh===null)try{new FormData(document.createElement("form"),0),rh=!1}catch{rh=!0}return rh}var qS=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Mp(s){return s!=null&&!qS.has(s)?(Gr(!1,`"${s}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${wh}"`),null):s}function HS(s,e){let t,i,l,u,d;if(PS(s)){let p=s.getAttribute("action");i=p?ra(p,e):null,t=s.getAttribute("method")||bh,l=Mp(s.getAttribute("enctype"))||wh,u=new FormData(s)}else if(OS(s)||VS(s)&&(s.type==="submit"||s.type==="image")){let p=s.form;if(p==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let g=s.getAttribute("formaction")||p.getAttribute("action");if(i=g?ra(g,e):null,t=s.getAttribute("formmethod")||p.getAttribute("method")||bh,l=Mp(s.getAttribute("formenctype"))||Mp(p.getAttribute("enctype"))||wh,u=new FormData(p,s),!FS()){let{name:y,type:b,value:E}=s;if(b==="image"){let T=y?`${y}.`:"";u.append(`${T}x`,"0"),u.append(`${T}y`,"0")}else y&&u.append(y,E)}}else{if(nf(s))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=bh,i=null,l=wh,d=s}return u&&l==="text/plain"&&(d=u,u=void 0),{action:i,method:t.toLowerCase(),encType:l,formData:u,body:d}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function ny(s,e){if(s===!1||s===null||typeof s>"u")throw new Error(e)}function $S(s,e,t,i){let l=typeof s=="string"?new URL(s,typeof window>"u"?"server://singlefetch/":window.location.origin):s;return t?l.pathname.endsWith("/")?l.pathname=`${l.pathname}_.${i}`:l.pathname=`${l.pathname}.${i}`:l.pathname==="/"?l.pathname=`_root.${i}`:e&&ra(l.pathname,e)==="/"?l.pathname=`${e.replace(/\/$/,"")}/_root.${i}`:l.pathname=`${l.pathname.replace(/\/$/,"")}.${i}`,l}async function WS(s,e){if(s.id in e)return e[s.id];try{let t=await import(s.module);return e[s.id]=t,t}catch(t){return console.error(`Error loading route module \`${s.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function GS(s){return s==null?!1:s.href==null?s.rel==="preload"&&typeof s.imageSrcSet=="string"&&typeof s.imageSizes=="string":typeof s.rel=="string"&&typeof s.href=="string"}async function KS(s,e,t){let i=await Promise.all(s.map(async l=>{let u=e.routes[l.route.id];if(u){let d=await WS(u,t);return d.links?d.links():[]}return[]}));return JS(i.flat(1).filter(GS).filter(l=>l.rel==="stylesheet"||l.rel==="preload").map(l=>l.rel==="stylesheet"?{...l,rel:"prefetch",as:"style"}:{...l,rel:"prefetch"}))}function r2(s,e,t,i,l,u){let d=(g,y)=>t[y]?g.route.id!==t[y].route.id:!0,p=(g,y)=>t[y].pathname!==g.pathname||t[y].route.path?.endsWith("*")&&t[y].params["*"]!==g.params["*"];return u==="assets"?e.filter((g,y)=>d(g,y)||p(g,y)):u==="data"?e.filter((g,y)=>{let b=i.routes[g.route.id];if(!b||!b.hasLoader)return!1;if(d(g,y)||p(g,y))return!0;if(g.route.shouldRevalidate){let E=g.route.shouldRevalidate({currentUrl:new URL(l.pathname+l.search+l.hash,window.origin),currentParams:t[0]?.params||{},nextUrl:new URL(s,window.origin),nextParams:g.params,defaultShouldRevalidate:!0});if(typeof E=="boolean")return E}return!0}):[]}function YS(s,e,{includeHydrateFallback:t}={}){return QS(s.map(i=>{let l=e.routes[i.route.id];if(!l)return[];let u=[l.module];return l.clientActionModule&&(u=u.concat(l.clientActionModule)),l.clientLoaderModule&&(u=u.concat(l.clientLoaderModule)),t&&l.hydrateFallbackModule&&(u=u.concat(l.hydrateFallbackModule)),l.imports&&(u=u.concat(l.imports)),u}).flat(1))}function QS(s){return[...new Set(s)]}function XS(s){let e={},t=Object.keys(s).sort();for(let i of t)e[i]=s[i];return e}function JS(s,e){let t=new Set;return new Set(e),s.reduce((i,l)=>{let u=JSON.stringify(XS(l));return t.has(u)||(t.add(u),i.push({key:u,link:l})),i},[])}function Cx(){let s=w.useContext(Xl);return ny(s,"You must render this element inside a <DataRouterContext.Provider> element"),s}function ZS(){let s=w.useContext(tf);return ny(s,"You must render this element inside a <DataRouterStateContext.Provider> element"),s}var sy=w.createContext(void 0);sy.displayName="FrameworkContext";function Nx(){let s=w.useContext(sy);return ny(s,"You must render this element inside a <HydratedRouter> element"),s}function eC(s,e){let t=w.useContext(sy),[i,l]=w.useState(!1),[u,d]=w.useState(!1),{onFocus:p,onBlur:g,onMouseEnter:y,onMouseLeave:b,onTouchStart:E}=e,T=w.useRef(null);w.useEffect(()=>{if(s==="render"&&d(!0),s==="viewport"){let H=K=>{K.forEach(G=>{d(G.isIntersecting)})},B=new IntersectionObserver(H,{threshold:.5});return T.current&&B.observe(T.current),()=>{B.disconnect()}}},[s]),w.useEffect(()=>{if(i){let H=setTimeout(()=>{d(!0)},100);return()=>{clearTimeout(H)}}},[i]);let L=()=>{l(!0)},W=()=>{l(!1),d(!1)};return t?s!=="intent"?[u,T,{}]:[u,T,{onFocus:Wc(p,L),onBlur:Wc(g,W),onMouseEnter:Wc(y,L),onMouseLeave:Wc(b,W),onTouchStart:Wc(E,L)}]:[!1,T,{}]}function Wc(s,e){return t=>{s&&s(t),t.defaultPrevented||e(t)}}function tC({page:s,...e}){let{router:t}=Cx(),i=w.useMemo(()=>mx(t.routes,s,t.basename),[t.routes,s,t.basename]);return i?w.createElement(sC,{page:s,matches:i,...e}):null}function nC(s){let{manifest:e,routeModules:t}=Nx(),[i,l]=w.useState([]);return w.useEffect(()=>{let u=!1;return KS(s,e,t).then(d=>{u||l(d)}),()=>{u=!0}},[s,e,t]),i}function sC({page:s,matches:e,...t}){let i=Ii(),{future:l,manifest:u,routeModules:d}=Nx(),{basename:p}=Cx(),{loaderData:g,matches:y}=ZS(),b=w.useMemo(()=>r2(s,e,y,u,i,"data"),[s,e,y,u,i]),E=w.useMemo(()=>r2(s,e,y,u,i,"assets"),[s,e,y,u,i]),T=w.useMemo(()=>{if(s===i.pathname+i.search+i.hash)return[];let H=new Set,B=!1;if(e.forEach(G=>{let Q=u.routes[G.route.id];!Q||!Q.hasLoader||(!b.some(he=>he.route.id===G.route.id)&&G.route.id in g&&d[G.route.id]?.shouldRevalidate||Q.hasClientLoader?B=!0:H.add(G.route.id))}),H.size===0)return[];let K=$S(s,p,l.unstable_trailingSlashAwareDataRequests,"data");return B&&H.size>0&&K.searchParams.set("_routes",e.filter(G=>H.has(G.route.id)).map(G=>G.route.id).join(",")),[K.pathname+K.search]},[p,l.unstable_trailingSlashAwareDataRequests,g,i,u,b,e,s,d]),L=w.useMemo(()=>YS(E,u),[E,u]),W=nC(E);return w.createElement(w.Fragment,null,T.map(H=>w.createElement("link",{key:H,rel:"prefetch",as:"fetch",href:H,...t})),L.map(H=>w.createElement("link",{key:H,rel:"modulepreload",href:H,...t})),W.map(({key:H,link:B})=>w.createElement("link",{key:H,nonce:t.nonce,...B,crossOrigin:B.crossOrigin??t.crossOrigin})))}function rC(...s){return e=>{s.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var iC=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{iC&&(window.__reactRouterVersion="7.13.0")}catch{}function aC({basename:s,children:e,unstable_useTransitions:t,window:i}){let l=w.useRef();l.current==null&&(l.current=Vj({window:i,v5Compat:!0}));let u=l.current,[d,p]=w.useState({action:u.action,location:u.location}),g=w.useCallback(y=>{t===!1?p(y):w.startTransition(()=>p(y))},[t]);return w.useLayoutEffect(()=>u.listen(g),[u,g]),w.createElement(DS,{basename:s,children:e,location:d.location,navigationType:d.action,navigator:u,unstable_useTransitions:t})}var Ax=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Rx=w.forwardRef(function({onClick:e,discover:t="render",prefetch:i="none",relative:l,reloadDocument:u,replace:d,state:p,target:g,to:y,preventScrollReset:b,viewTransition:E,unstable_defaultShouldRevalidate:T,...L},W){let{basename:H,unstable_useTransitions:B}=w.useContext(Nr),K=typeof y=="string"&&Ax.test(y),G=vx(y,H);y=G.to;let Q=vS(y,{relative:l}),[he,Ee,ge]=eC(i,L),C=uC(y,{replace:d,state:p,target:g,preventScrollReset:b,relative:l,viewTransition:E,unstable_defaultShouldRevalidate:T,unstable_useTransitions:B});function j(V){e&&e(V),V.defaultPrevented||C(V)}let R=w.createElement("a",{...L,...ge,href:G.absoluteURL||Q,onClick:G.isExternal||u?e:j,ref:rC(W,Ee),target:g,"data-discover":!K&&t==="render"?"true":void 0});return he&&!K?w.createElement(w.Fragment,null,R,w.createElement(tC,{page:Q})):R});Rx.displayName="Link";var oC=w.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:i="",end:l=!1,style:u,to:d,viewTransition:p,children:g,...y},b){let E=Cu(d,{relative:y.relative}),T=Ii(),L=w.useContext(tf),{navigator:W,basename:H}=w.useContext(Nr),B=L!=null&&pC(E)&&p===!0,K=W.encodeLocation?W.encodeLocation(E).pathname:E.pathname,G=T.pathname,Q=L&&L.navigation&&L.navigation.location?L.navigation.location.pathname:null;t||(G=G.toLowerCase(),Q=Q?Q.toLowerCase():null,K=K.toLowerCase()),Q&&H&&(Q=ra(Q,H)||Q);const he=K!=="/"&&K.endsWith("/")?K.length-1:K.length;let Ee=G===K||!l&&G.startsWith(K)&&G.charAt(he)==="/",ge=Q!=null&&(Q===K||!l&&Q.startsWith(K)&&Q.charAt(K.length)==="/"),C={isActive:Ee,isPending:ge,isTransitioning:B},j=Ee?e:void 0,R;typeof i=="function"?R=i(C):R=[i,Ee?"active":null,ge?"pending":null,B?"transitioning":null].filter(Boolean).join(" ");let V=typeof u=="function"?u(C):u;return w.createElement(Rx,{...y,"aria-current":j,className:R,ref:b,style:V,to:d,viewTransition:p},typeof g=="function"?g(C):g)});oC.displayName="NavLink";var lC=w.forwardRef(({discover:s="render",fetcherKey:e,navigate:t,reloadDocument:i,replace:l,state:u,method:d=bh,action:p,onSubmit:g,relative:y,preventScrollReset:b,viewTransition:E,unstable_defaultShouldRevalidate:T,...L},W)=>{let{unstable_useTransitions:H}=w.useContext(Nr),B=fC(),K=mC(p,{relative:y}),G=d.toLowerCase()==="get"?"get":"post",Q=typeof p=="string"&&Ax.test(p),he=Ee=>{if(g&&g(Ee),Ee.defaultPrevented)return;Ee.preventDefault();let ge=Ee.nativeEvent.submitter,C=ge?.getAttribute("formmethod")||d,j=()=>B(ge||Ee.currentTarget,{fetcherKey:e,method:C,navigate:t,replace:l,state:u,relative:y,preventScrollReset:b,viewTransition:E,unstable_defaultShouldRevalidate:T});H&&t!==!1?w.startTransition(()=>j()):j()};return w.createElement("form",{ref:W,method:G,action:K,onSubmit:i?g:he,...L,"data-discover":!Q&&s==="render"?"true":void 0})});lC.displayName="Form";function cC(s){return`${s} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Ix(s){let e=w.useContext(Xl);return Fn(e,cC(s)),e}function uC(s,{target:e,replace:t,state:i,preventScrollReset:l,relative:u,viewTransition:d,unstable_defaultShouldRevalidate:p,unstable_useTransitions:g}={}){let y=Ys(),b=Ii(),E=Cu(s,{relative:u});return w.useCallback(T=>{if(BS(T,e)){T.preventDefault();let L=t!==void 0?t:hu(b)===hu(E),W=()=>y(s,{replace:L,state:i,preventScrollReset:l,relative:u,viewTransition:d,unstable_defaultShouldRevalidate:p});g?w.startTransition(()=>W()):W()}},[b,y,E,t,i,e,s,l,u,d,p,g])}function NO(s){Gr(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let e=w.useRef(yg(s)),t=w.useRef(!1),i=Ii(),l=w.useMemo(()=>zS(i.search,t.current?null:e.current),[i.search]),u=Ys(),d=w.useCallback((p,g)=>{const y=yg(typeof p=="function"?p(new URLSearchParams(l)):p);t.current=!0,u("?"+y,g)},[u,l]);return[l,d]}var dC=0,hC=()=>`__${String(++dC)}__`;function fC(){let{router:s}=Ix("useSubmit"),{basename:e}=w.useContext(Nr),t=AS(),i=s.fetch,l=s.navigate;return w.useCallback(async(u,d={})=>{let{action:p,method:g,encType:y,formData:b,body:E}=HS(u,e);if(d.navigate===!1){let T=d.fetcherKey||hC();await i(T,t,d.action||p,{unstable_defaultShouldRevalidate:d.unstable_defaultShouldRevalidate,preventScrollReset:d.preventScrollReset,formData:b,body:E,formMethod:d.method||g,formEncType:d.encType||y,flushSync:d.flushSync})}else await l(d.action||p,{unstable_defaultShouldRevalidate:d.unstable_defaultShouldRevalidate,preventScrollReset:d.preventScrollReset,formData:b,body:E,formMethod:d.method||g,formEncType:d.encType||y,replace:d.replace,state:d.state,fromRouteId:t,flushSync:d.flushSync,viewTransition:d.viewTransition})},[i,l,e,t])}function mC(s,{relative:e}={}){let{basename:t}=w.useContext(Nr),i=w.useContext(di);Fn(i,"useFormAction must be used inside a RouteContext");let[l]=i.matches.slice(-1),u={...Cu(s||".",{relative:e})},d=Ii();if(s==null){u.search=d.search;let p=new URLSearchParams(u.search),g=p.getAll("index");if(g.some(b=>b==="")){p.delete("index"),g.filter(E=>E).forEach(E=>p.append("index",E));let b=p.toString();u.search=b?`?${b}`:""}}return(!s||s===".")&&l.route.index&&(u.search=u.search?u.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(u.pathname=u.pathname==="/"?t:ea([t,u.pathname])),hu(u)}function pC(s,{relative:e}={}){let t=w.useContext(wx);Fn(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:i}=Ix("useViewTransitionState"),l=Cu(s,{relative:e});if(!t.isTransitioning)return!1;let u=ra(t.currentLocation.pathname,i)||t.currentLocation.pathname,d=ra(t.nextLocation.pathname,i)||t.nextLocation.pathname;return Ih(l.pathname,d)!=null||Ih(l.pathname,u)!=null}const gC=()=>{};var i2={};const Mx=function(s){const e=[];let t=0;for(let i=0;i<s.length;i++){let l=s.charCodeAt(i);l<128?e[t++]=l:l<2048?(e[t++]=l>>6|192,e[t++]=l&63|128):(l&64512)===55296&&i+1<s.length&&(s.charCodeAt(i+1)&64512)===56320?(l=65536+((l&1023)<<10)+(s.charCodeAt(++i)&1023),e[t++]=l>>18|240,e[t++]=l>>12&63|128,e[t++]=l>>6&63|128,e[t++]=l&63|128):(e[t++]=l>>12|224,e[t++]=l>>6&63|128,e[t++]=l&63|128)}return e},yC=function(s){const e=[];let t=0,i=0;for(;t<s.length;){const l=s[t++];if(l<128)e[i++]=String.fromCharCode(l);else if(l>191&&l<224){const u=s[t++];e[i++]=String.fromCharCode((l&31)<<6|u&63)}else if(l>239&&l<365){const u=s[t++],d=s[t++],p=s[t++],g=((l&7)<<18|(u&63)<<12|(d&63)<<6|p&63)-65536;e[i++]=String.fromCharCode(55296+(g>>10)),e[i++]=String.fromCharCode(56320+(g&1023))}else{const u=s[t++],d=s[t++];e[i++]=String.fromCharCode((l&15)<<12|(u&63)<<6|d&63)}}return e.join("")},Dx={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(s,e){if(!Array.isArray(s))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let l=0;l<s.length;l+=3){const u=s[l],d=l+1<s.length,p=d?s[l+1]:0,g=l+2<s.length,y=g?s[l+2]:0,b=u>>2,E=(u&3)<<4|p>>4;let T=(p&15)<<2|y>>6,L=y&63;g||(L=64,d||(T=64)),i.push(t[b],t[E],t[T],t[L])}return i.join("")},encodeString(s,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(s):this.encodeByteArray(Mx(s),e)},decodeString(s,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(s):yC(this.decodeStringToByteArray(s,e))},decodeStringToByteArray(s,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let l=0;l<s.length;){const u=t[s.charAt(l++)],p=l<s.length?t[s.charAt(l)]:0;++l;const y=l<s.length?t[s.charAt(l)]:64;++l;const E=l<s.length?t[s.charAt(l)]:64;if(++l,u==null||p==null||y==null||E==null)throw new vC;const T=u<<2|p>>4;if(i.push(T),y!==64){const L=p<<4&240|y>>2;if(i.push(L),E!==64){const W=y<<6&192|E;i.push(W)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let s=0;s<this.ENCODED_VALS.length;s++)this.byteToCharMap_[s]=this.ENCODED_VALS.charAt(s),this.charToByteMap_[this.byteToCharMap_[s]]=s,this.byteToCharMapWebSafe_[s]=this.ENCODED_VALS_WEBSAFE.charAt(s),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[s]]=s,s>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(s)]=s,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(s)]=s)}}};class vC extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const bC=function(s){const e=Mx(s);return Dx.encodeByteArray(e,!0)},Mh=function(s){return bC(s).replace(/\./g,"")},Lx=function(s){try{return Dx.decodeString(s,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function wC(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const xC=()=>wC().__FIREBASE_DEFAULTS__,_C=()=>{if(typeof process>"u"||typeof i2>"u")return;const s=i2.__FIREBASE_DEFAULTS__;if(s)return JSON.parse(s)},kC=()=>{if(typeof document>"u")return;let s;try{s=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=s&&Lx(s[1]);return e&&JSON.parse(e)},sf=()=>{try{return gC()||xC()||_C()||kC()}catch(s){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${s}`);return}},Ox=s=>sf()?.emulatorHosts?.[s],Px=s=>{const e=Ox(s);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),i]:[e.substring(0,t),i]},Vx=()=>sf()?.config,Ux=s=>sf()?.[`_${s}`];class EC{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}}function io(s){try{return(s.startsWith("http://")||s.startsWith("https://")?new URL(s).hostname:s).endsWith(".cloudworkstations.dev")}catch{return!1}}async function ry(s){return(await fetch(s,{credentials:"include"})).ok}function Bx(s,e){if(s.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},i=e||"demo-project",l=s.iat||0,u=s.sub||s.user_id;if(!u)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const d={iss:`https://securetoken.google.com/${i}`,aud:i,iat:l,exp:l+3600,auth_time:l,sub:u,user_id:u,firebase:{sign_in_provider:"custom",identities:{}},...s};return[Mh(JSON.stringify(t)),Mh(JSON.stringify(d)),""].join(".")}const iu={};function TC(){const s={prod:[],emulator:[]};for(const e of Object.keys(iu))iu[e]?s.emulator.push(e):s.prod.push(e);return s}function jC(s){let e=document.getElementById(s),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",s),t=!0),{created:t,element:e}}let a2=!1;function iy(s,e){if(typeof window>"u"||typeof document>"u"||!io(window.location.host)||iu[s]===e||iu[s]||a2)return;iu[s]=e;function t(T){return`__firebase__banner__${T}`}const i="__firebase__banner",u=TC().prod.length>0;function d(){const T=document.getElementById(i);T&&T.remove()}function p(T){T.style.display="flex",T.style.background="#7faaf0",T.style.position="fixed",T.style.bottom="5px",T.style.left="5px",T.style.padding=".5em",T.style.borderRadius="5px",T.style.alignItems="center"}function g(T,L){T.setAttribute("width","24"),T.setAttribute("id",L),T.setAttribute("height","24"),T.setAttribute("viewBox","0 0 24 24"),T.setAttribute("fill","none"),T.style.marginLeft="-6px"}function y(){const T=document.createElement("span");return T.style.cursor="pointer",T.style.marginLeft="16px",T.style.fontSize="24px",T.innerHTML=" &times;",T.onclick=()=>{a2=!0,d()},T}function b(T,L){T.setAttribute("id",L),T.innerText="Learn more",T.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",T.setAttribute("target","__blank"),T.style.paddingLeft="5px",T.style.textDecoration="underline"}function E(){const T=jC(i),L=t("text"),W=document.getElementById(L)||document.createElement("span"),H=t("learnmore"),B=document.getElementById(H)||document.createElement("a"),K=t("preprendIcon"),G=document.getElementById(K)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(T.created){const Q=T.element;p(Q),b(B,H);const he=y();g(G,K),Q.append(G,W,B,he),document.body.appendChild(Q)}u?(W.innerText="Preview backend disconnected.",G.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(G.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,W.innerText="Preview backend running in this workspace."),W.setAttribute("id",L)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",E):E()}function Gs(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function SC(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Gs())}function CC(){const s=sf()?.forceEnvironment;if(s==="node")return!0;if(s==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function NC(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function AC(){const s=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof s=="object"&&s.id!==void 0}function RC(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function IC(){const s=Gs();return s.indexOf("MSIE ")>=0||s.indexOf("Trident/")>=0}function MC(){return!CC()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function zx(){try{return typeof indexedDB=="object"}catch{return!1}}function Fx(){return new Promise((s,e)=>{try{let t=!0;const i="validate-browser-context-for-indexeddb-analytics-module",l=self.indexedDB.open(i);l.onsuccess=()=>{l.result.close(),t||self.indexedDB.deleteDatabase(i),s(!0)},l.onupgradeneeded=()=>{t=!1},l.onerror=()=>{e(l.error?.message||"")}}catch(t){e(t)}})}function DC(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}const LC="FirebaseError";class hi extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=LC,Object.setPrototypeOf(this,hi.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,$o.prototype.create)}}class $o{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){const i=t[0]||{},l=`${this.service}/${e}`,u=this.errors[e],d=u?OC(u,i):"Error",p=`${this.serviceName}: ${d} (${l}).`;return new hi(l,p,i)}}function OC(s,e){return s.replace(PC,(t,i)=>{const l=e[i];return l!=null?String(l):`<${i}?>`})}const PC=/\{\$([^}]+)}/g;function VC(s){for(const e in s)if(Object.prototype.hasOwnProperty.call(s,e))return!1;return!0}function ia(s,e){if(s===e)return!0;const t=Object.keys(s),i=Object.keys(e);for(const l of t){if(!i.includes(l))return!1;const u=s[l],d=e[l];if(o2(u)&&o2(d)){if(!ia(u,d))return!1}else if(u!==d)return!1}for(const l of i)if(!t.includes(l))return!1;return!0}function o2(s){return s!==null&&typeof s=="object"}function Nu(s){const e=[];for(const[t,i]of Object.entries(s))Array.isArray(i)?i.forEach(l=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(l))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function Zc(s){const e={};return s.replace(/^\?/,"").split("&").forEach(i=>{if(i){const[l,u]=i.split("=");e[decodeURIComponent(l)]=decodeURIComponent(u)}}),e}function eu(s){const e=s.indexOf("?");if(!e)return"";const t=s.indexOf("#",e);return s.substring(e,t>0?t:void 0)}function UC(s,e){const t=new BC(s,e);return t.subscribe.bind(t)}class BC{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,i){let l;if(e===void 0&&t===void 0&&i===void 0)throw new Error("Missing Observer.");zC(e,["next","error","complete"])?l=e:l={next:e,error:t,complete:i},l.next===void 0&&(l.next=Dp),l.error===void 0&&(l.error=Dp),l.complete===void 0&&(l.complete=Dp);const u=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?l.error(this.finalError):l.complete()}catch{}}),this.observers.push(l),u}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function zC(s,e){if(typeof s!="object"||s===null)return!1;for(const t of e)if(t in s&&typeof s[t]=="function")return!0;return!1}function Dp(){}function fn(s){return s&&s._delegate?s._delegate:s}class Kr{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const No="[DEFAULT]";class FC{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const i=new EC;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{const l=this.getOrInitializeService({instanceIdentifier:t});l&&i.resolve(l)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),i=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(l){if(i)return null;throw l}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(HC(e))try{this.getOrInitializeService({instanceIdentifier:No})}catch{}for(const[t,i]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(t);try{const u=this.getOrInitializeService({instanceIdentifier:l});i.resolve(u)}catch{}}}}clearInstance(e=No){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=No){return this.instances.has(e)}getOptions(e=No){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const l=this.getOrInitializeService({instanceIdentifier:i,options:t});for(const[u,d]of this.instancesDeferred.entries()){const p=this.normalizeInstanceIdentifier(u);i===p&&d.resolve(l)}return l}onInit(e,t){const i=this.normalizeInstanceIdentifier(t),l=this.onInitCallbacks.get(i)??new Set;l.add(e),this.onInitCallbacks.set(i,l);const u=this.instances.get(i);return u&&e(u,i),()=>{l.delete(e)}}invokeOnInitCallbacks(e,t){const i=this.onInitCallbacks.get(t);if(i)for(const l of i)try{l(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:qC(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=No){return this.component?this.component.multipleInstances?e:No:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function qC(s){return s===No?void 0:s}function HC(s){return s.instantiationMode==="EAGER"}class $C{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new FC(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}var Ut;(function(s){s[s.DEBUG=0]="DEBUG",s[s.VERBOSE=1]="VERBOSE",s[s.INFO=2]="INFO",s[s.WARN=3]="WARN",s[s.ERROR=4]="ERROR",s[s.SILENT=5]="SILENT"})(Ut||(Ut={}));const WC={debug:Ut.DEBUG,verbose:Ut.VERBOSE,info:Ut.INFO,warn:Ut.WARN,error:Ut.ERROR,silent:Ut.SILENT},GC=Ut.INFO,KC={[Ut.DEBUG]:"log",[Ut.VERBOSE]:"log",[Ut.INFO]:"info",[Ut.WARN]:"warn",[Ut.ERROR]:"error"},YC=(s,e,...t)=>{if(e<s.logLevel)return;const i=new Date().toISOString(),l=KC[e];if(l)console[l](`[${i}]  ${s.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class ay{constructor(e){this.name=e,this._logLevel=GC,this._logHandler=YC,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ut))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?WC[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ut.DEBUG,...e),this._logHandler(this,Ut.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ut.VERBOSE,...e),this._logHandler(this,Ut.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ut.INFO,...e),this._logHandler(this,Ut.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ut.WARN,...e),this._logHandler(this,Ut.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ut.ERROR,...e),this._logHandler(this,Ut.ERROR,...e)}}const QC=(s,e)=>e.some(t=>s instanceof t);let l2,c2;function XC(){return l2||(l2=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function JC(){return c2||(c2=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const qx=new WeakMap,vg=new WeakMap,Hx=new WeakMap,Lp=new WeakMap,oy=new WeakMap;function ZC(s){const e=new Promise((t,i)=>{const l=()=>{s.removeEventListener("success",u),s.removeEventListener("error",d)},u=()=>{t(ta(s.result)),l()},d=()=>{i(s.error),l()};s.addEventListener("success",u),s.addEventListener("error",d)});return e.then(t=>{t instanceof IDBCursor&&qx.set(t,s)}).catch(()=>{}),oy.set(e,s),e}function eN(s){if(vg.has(s))return;const e=new Promise((t,i)=>{const l=()=>{s.removeEventListener("complete",u),s.removeEventListener("error",d),s.removeEventListener("abort",d)},u=()=>{t(),l()},d=()=>{i(s.error||new DOMException("AbortError","AbortError")),l()};s.addEventListener("complete",u),s.addEventListener("error",d),s.addEventListener("abort",d)});vg.set(s,e)}let bg={get(s,e,t){if(s instanceof IDBTransaction){if(e==="done")return vg.get(s);if(e==="objectStoreNames")return s.objectStoreNames||Hx.get(s);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return ta(s[e])},set(s,e,t){return s[e]=t,!0},has(s,e){return s instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in s}};function tN(s){bg=s(bg)}function nN(s){return s===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const i=s.call(Op(this),e,...t);return Hx.set(i,e.sort?e.sort():[e]),ta(i)}:JC().includes(s)?function(...e){return s.apply(Op(this),e),ta(qx.get(this))}:function(...e){return ta(s.apply(Op(this),e))}}function sN(s){return typeof s=="function"?nN(s):(s instanceof IDBTransaction&&eN(s),QC(s,XC())?new Proxy(s,bg):s)}function ta(s){if(s instanceof IDBRequest)return ZC(s);if(Lp.has(s))return Lp.get(s);const e=sN(s);return e!==s&&(Lp.set(s,e),oy.set(e,s)),e}const Op=s=>oy.get(s);function rf(s,e,{blocked:t,upgrade:i,blocking:l,terminated:u}={}){const d=indexedDB.open(s,e),p=ta(d);return i&&d.addEventListener("upgradeneeded",g=>{i(ta(d.result),g.oldVersion,g.newVersion,ta(d.transaction),g)}),t&&d.addEventListener("blocked",g=>t(g.oldVersion,g.newVersion,g)),p.then(g=>{u&&g.addEventListener("close",()=>u()),l&&g.addEventListener("versionchange",y=>l(y.oldVersion,y.newVersion,y))}).catch(()=>{}),p}function Pp(s,{blocked:e}={}){const t=indexedDB.deleteDatabase(s);return e&&t.addEventListener("blocked",i=>e(i.oldVersion,i)),ta(t).then(()=>{})}const rN=["get","getKey","getAll","getAllKeys","count"],iN=["put","add","delete","clear"],Vp=new Map;function u2(s,e){if(!(s instanceof IDBDatabase&&!(e in s)&&typeof e=="string"))return;if(Vp.get(e))return Vp.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,l=iN.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(l||rN.includes(t)))return;const u=async function(d,...p){const g=this.transaction(d,l?"readwrite":"readonly");let y=g.store;return i&&(y=y.index(p.shift())),(await Promise.all([y[t](...p),l&&g.done]))[0]};return Vp.set(e,u),u}tN(s=>({...s,get:(e,t,i)=>u2(e,t)||s.get(e,t,i),has:(e,t)=>!!u2(e,t)||s.has(e,t)}));class aN{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(oN(t)){const i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}}function oN(s){return s.getComponent()?.type==="VERSION"}const wg="@firebase/app",d2="0.14.7";const aa=new ay("@firebase/app"),lN="@firebase/app-compat",cN="@firebase/analytics-compat",uN="@firebase/analytics",dN="@firebase/app-check-compat",hN="@firebase/app-check",fN="@firebase/auth",mN="@firebase/auth-compat",pN="@firebase/database",gN="@firebase/data-connect",yN="@firebase/database-compat",vN="@firebase/functions",bN="@firebase/functions-compat",wN="@firebase/installations",xN="@firebase/installations-compat",_N="@firebase/messaging",kN="@firebase/messaging-compat",EN="@firebase/performance",TN="@firebase/performance-compat",jN="@firebase/remote-config",SN="@firebase/remote-config-compat",CN="@firebase/storage",NN="@firebase/storage-compat",AN="@firebase/firestore",RN="@firebase/ai",IN="@firebase/firestore-compat",MN="firebase",DN="12.8.0";const xg="[DEFAULT]",LN={[wg]:"fire-core",[lN]:"fire-core-compat",[uN]:"fire-analytics",[cN]:"fire-analytics-compat",[hN]:"fire-app-check",[dN]:"fire-app-check-compat",[fN]:"fire-auth",[mN]:"fire-auth-compat",[pN]:"fire-rtdb",[gN]:"fire-data-connect",[yN]:"fire-rtdb-compat",[vN]:"fire-fn",[bN]:"fire-fn-compat",[wN]:"fire-iid",[xN]:"fire-iid-compat",[_N]:"fire-fcm",[kN]:"fire-fcm-compat",[EN]:"fire-perf",[TN]:"fire-perf-compat",[jN]:"fire-rc",[SN]:"fire-rc-compat",[CN]:"fire-gcs",[NN]:"fire-gcs-compat",[AN]:"fire-fst",[IN]:"fire-fst-compat",[RN]:"fire-vertex","fire-js":"fire-js",[MN]:"fire-js-all"};const Dh=new Map,ON=new Map,_g=new Map;function h2(s,e){try{s.container.addComponent(e)}catch(t){aa.debug(`Component ${e.name} failed to register with FirebaseApp ${s.name}`,t)}}function li(s){const e=s.name;if(_g.has(e))return aa.debug(`There were multiple attempts to register component ${e}.`),!1;_g.set(e,s);for(const t of Dh.values())h2(t,s);for(const t of ON.values())h2(t,s);return!0}function Wo(s,e){const t=s.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),s.container.getProvider(e)}function jr(s){return s==null?!1:s.settings!==void 0}const PN={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Ya=new $o("app","Firebase",PN);class VN{constructor(e,t,i){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new Kr("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Ya.create("app-deleted",{appName:this._name})}}const Go=DN;function ly(s,e={}){let t=s;typeof e!="object"&&(e={name:e});const i={name:xg,automaticDataCollectionEnabled:!0,...e},l=i.name;if(typeof l!="string"||!l)throw Ya.create("bad-app-name",{appName:String(l)});if(t||(t=Vx()),!t)throw Ya.create("no-options");const u=Dh.get(l);if(u){if(ia(t,u.options)&&ia(i,u.config))return u;throw Ya.create("duplicate-app",{appName:l})}const d=new $C(l);for(const g of _g.values())d.addComponent(g);const p=new VN(t,i,d);return Dh.set(l,p),p}function Au(s=xg){const e=Dh.get(s);if(!e&&s===xg&&Vx())return ly();if(!e)throw Ya.create("no-app",{appName:s});return e}function pr(s,e,t){let i=LN[s]??s;t&&(i+=`-${t}`);const l=i.match(/\s|\//),u=e.match(/\s|\//);if(l||u){const d=[`Unable to register library "${i}" with version "${e}":`];l&&d.push(`library name "${i}" contains illegal characters (whitespace or "/")`),l&&u&&d.push("and"),u&&d.push(`version name "${e}" contains illegal characters (whitespace or "/")`),aa.warn(d.join(" "));return}li(new Kr(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}const UN="firebase-heartbeat-database",BN=1,fu="firebase-heartbeat-store";let Up=null;function $x(){return Up||(Up=rf(UN,BN,{upgrade:(s,e)=>{switch(e){case 0:try{s.createObjectStore(fu)}catch(t){console.warn(t)}}}}).catch(s=>{throw Ya.create("idb-open",{originalErrorMessage:s.message})})),Up}async function zN(s){try{const t=(await $x()).transaction(fu),i=await t.objectStore(fu).get(Wx(s));return await t.done,i}catch(e){if(e instanceof hi)aa.warn(e.message);else{const t=Ya.create("idb-get",{originalErrorMessage:e?.message});aa.warn(t.message)}}}async function f2(s,e){try{const i=(await $x()).transaction(fu,"readwrite");await i.objectStore(fu).put(e,Wx(s)),await i.done}catch(t){if(t instanceof hi)aa.warn(t.message);else{const i=Ya.create("idb-set",{originalErrorMessage:t?.message});aa.warn(i.message)}}}function Wx(s){return`${s.name}!${s.options.appId}`}const FN=1024,qN=30;class HN{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new WN(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=m2();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(l=>l.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:t}),this._heartbeatsCache.heartbeats.length>qN){const l=GN(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(l,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){aa.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=m2(),{heartbeatsToSend:t,unsentEntries:i}=$N(this._heartbeatsCache.heartbeats),l=Mh(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),l}catch(e){return aa.warn(e),""}}}function m2(){return new Date().toISOString().substring(0,10)}function $N(s,e=FN){const t=[];let i=s.slice();for(const l of s){const u=t.find(d=>d.agent===l.agent);if(u){if(u.dates.push(l.date),p2(t)>e){u.dates.pop();break}}else if(t.push({agent:l.agent,dates:[l.date]}),p2(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}class WN{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return zx()?Fx().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await zN(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return f2(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return f2(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function p2(s){return Mh(JSON.stringify({version:2,heartbeats:s})).length}function GN(s){if(s.length===0)return-1;let e=0,t=s[0].date;for(let i=1;i<s.length;i++)s[i].date<t&&(t=s[i].date,e=i);return e}function KN(s){li(new Kr("platform-logger",e=>new aN(e),"PRIVATE")),li(new Kr("heartbeat",e=>new HN(e),"PRIVATE")),pr(wg,d2,s),pr(wg,d2,"esm2020"),pr("fire-js","")}KN("");function Gx(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const YN=Gx,Kx=new $o("auth","Firebase",Gx());const Lh=new ay("@firebase/auth");function QN(s,...e){Lh.logLevel<=Ut.WARN&&Lh.warn(`Auth (${Go}): ${s}`,...e)}function xh(s,...e){Lh.logLevel<=Ut.ERROR&&Lh.error(`Auth (${Go}): ${s}`,...e)}function ci(s,...e){throw cy(s,...e)}function Ti(s,...e){return cy(s,...e)}function Yx(s,e,t){const i={...YN(),[e]:t};return new $o("auth","Firebase",i).create(e,{appName:s.name})}function na(s){return Yx(s,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function cy(s,...e){if(typeof s!="string"){const t=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=s.name),s._errorFactory.create(t,...i)}return Kx.create(s,...e)}function bt(s,e,...t){if(!s)throw cy(e,...t)}function Ji(s){const e="INTERNAL ASSERTION FAILED: "+s;throw xh(e),new Error(e)}function oa(s,e){s||Ji(e)}function kg(){return typeof self<"u"&&self.location?.href||""}function XN(){return g2()==="http:"||g2()==="https:"}function g2(){return typeof self<"u"&&self.location?.protocol||null}function JN(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(XN()||AC()||"connection"in navigator)?navigator.onLine:!0}function ZN(){if(typeof navigator>"u")return null;const s=navigator;return s.languages&&s.languages[0]||s.language||null}class Ru{constructor(e,t){this.shortDelay=e,this.longDelay=t,oa(t>e,"Short delay should be less than long delay!"),this.isMobile=SC()||RC()}get(){return JN()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function uy(s,e){oa(s.emulator,"Emulator should always be set here");const{url:t}=s.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class Qx{static initialize(e,t,i){this.fetchImpl=e,t&&(this.headersImpl=t),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Ji("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Ji("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Ji("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const eA={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const tA=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],nA=new Ru(3e4,6e4);function ua(s,e){return s.tenantId&&!e.tenantId?{...e,tenantId:s.tenantId}:e}async function da(s,e,t,i,l={}){return Xx(s,l,async()=>{let u={},d={};i&&(e==="GET"?d=i:u={body:JSON.stringify(i)});const p=Nu({key:s.config.apiKey,...d}).slice(1),g=await s._getAdditionalHeaders();g["Content-Type"]="application/json",s.languageCode&&(g["X-Firebase-Locale"]=s.languageCode);const y={method:e,headers:g,...u};return NC()||(y.referrerPolicy="no-referrer"),s.emulatorConfig&&io(s.emulatorConfig.host)&&(y.credentials="include"),Qx.fetch()(await Jx(s,s.config.apiHost,t,p),y)})}async function Xx(s,e,t){s._canInitEmulator=!1;const i={...eA,...e};try{const l=new rA(s),u=await Promise.race([t(),l.promise]);l.clearNetworkTimeout();const d=await u.json();if("needConfirmation"in d)throw ih(s,"account-exists-with-different-credential",d);if(u.ok&&!("errorMessage"in d))return d;{const p=u.ok?d.errorMessage:d.error.message,[g,y]=p.split(" : ");if(g==="FEDERATED_USER_ID_ALREADY_LINKED")throw ih(s,"credential-already-in-use",d);if(g==="EMAIL_EXISTS")throw ih(s,"email-already-in-use",d);if(g==="USER_DISABLED")throw ih(s,"user-disabled",d);const b=i[g]||g.toLowerCase().replace(/[_\s]+/g,"-");if(y)throw Yx(s,b,y);ci(s,b)}}catch(l){if(l instanceof hi)throw l;ci(s,"network-request-failed",{message:String(l)})}}async function Iu(s,e,t,i,l={}){const u=await da(s,e,t,i,l);return"mfaPendingCredential"in u&&ci(s,"multi-factor-auth-required",{_serverResponse:u}),u}async function Jx(s,e,t,i){const l=`${e}${t}?${i}`,u=s,d=u.config.emulator?uy(s.config,l):`${s.config.apiScheme}://${l}`;return tA.includes(t)&&(await u._persistenceManagerAvailable,u._getPersistenceType()==="COOKIE")?u._getPersistence()._getFinalTarget(d).toString():d}function sA(s){switch(s){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class rA{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,i)=>{this.timer=setTimeout(()=>i(Ti(this.auth,"network-request-failed")),nA.get())})}}function ih(s,e,t){const i={appName:s.name};t.email&&(i.email=t.email),t.phoneNumber&&(i.phoneNumber=t.phoneNumber);const l=Ti(s,e,i);return l.customData._tokenResponse=t,l}function y2(s){return s!==void 0&&s.enterprise!==void 0}class iA{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return sA(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function aA(s,e){return da(s,"GET","/v2/recaptchaConfig",ua(s,e))}async function oA(s,e){return da(s,"POST","/v1/accounts:delete",e)}async function Oh(s,e){return da(s,"POST","/v1/accounts:lookup",e)}function au(s){if(s)try{const e=new Date(Number(s));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function lA(s,e=!1){const t=fn(s),i=await t.getIdToken(e),l=dy(i);bt(l&&l.exp&&l.auth_time&&l.iat,t.auth,"internal-error");const u=typeof l.firebase=="object"?l.firebase:void 0,d=u?.sign_in_provider;return{claims:l,token:i,authTime:au(Bp(l.auth_time)),issuedAtTime:au(Bp(l.iat)),expirationTime:au(Bp(l.exp)),signInProvider:d||null,signInSecondFactor:u?.sign_in_second_factor||null}}function Bp(s){return Number(s)*1e3}function dy(s){const[e,t,i]=s.split(".");if(e===void 0||t===void 0||i===void 0)return xh("JWT malformed, contained fewer than 3 sections"),null;try{const l=Lx(t);return l?JSON.parse(l):(xh("Failed to decode base64 JWT payload"),null)}catch(l){return xh("Caught error parsing JWT payload as JSON",l?.toString()),null}}function v2(s){const e=dy(s);return bt(e,"internal-error"),bt(typeof e.exp<"u","internal-error"),bt(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function mu(s,e,t=!1){if(t)return e;try{return await e}catch(i){throw i instanceof hi&&cA(i)&&s.auth.currentUser===s&&await s.auth.signOut(),i}}function cA({code:s}){return s==="auth/user-disabled"||s==="auth/user-token-expired"}class uA{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const i=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class Eg{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=au(this.lastLoginAt),this.creationTime=au(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Ph(s){const e=s.auth,t=await s.getIdToken(),i=await mu(s,Oh(e,{idToken:t}));bt(i?.users.length,e,"internal-error");const l=i.users[0];s._notifyReloadListener(l);const u=l.providerUserInfo?.length?Zx(l.providerUserInfo):[],d=hA(s.providerData,u),p=s.isAnonymous,g=!(s.email&&l.passwordHash)&&!d?.length,y=p?g:!1,b={uid:l.localId,displayName:l.displayName||null,photoURL:l.photoUrl||null,email:l.email||null,emailVerified:l.emailVerified||!1,phoneNumber:l.phoneNumber||null,tenantId:l.tenantId||null,providerData:d,metadata:new Eg(l.createdAt,l.lastLoginAt),isAnonymous:y};Object.assign(s,b)}async function dA(s){const e=fn(s);await Ph(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function hA(s,e){return[...s.filter(i=>!e.some(l=>l.providerId===i.providerId)),...e]}function Zx(s){return s.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}async function fA(s,e){const t=await Xx(s,{},async()=>{const i=Nu({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:l,apiKey:u}=s.config,d=await Jx(s,l,"/v1/token",`key=${u}`),p=await s._getAdditionalHeaders();p["Content-Type"]="application/x-www-form-urlencoded";const g={method:"POST",headers:p,body:i};return s.emulatorConfig&&io(s.emulatorConfig.host)&&(g.credentials="include"),Qx.fetch()(d,g)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function mA(s,e){return da(s,"POST","/v2/accounts:revokeToken",ua(s,e))}class Pl{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){bt(e.idToken,"internal-error"),bt(typeof e.idToken<"u","internal-error"),bt(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):v2(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){bt(e.length!==0,"internal-error");const t=v2(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(bt(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:i,refreshToken:l,expiresIn:u}=await fA(e,t);this.updateTokensAndExpiration(i,l,Number(u))}updateTokensAndExpiration(e,t,i){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,t){const{refreshToken:i,accessToken:l,expirationTime:u}=t,d=new Pl;return i&&(bt(typeof i=="string","internal-error",{appName:e}),d.refreshToken=i),l&&(bt(typeof l=="string","internal-error",{appName:e}),d.accessToken=l),u&&(bt(typeof u=="number","internal-error",{appName:e}),d.expirationTime=u),d}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Pl,this.toJSON())}_performRefresh(){return Ji("not implemented")}}function Ua(s,e){bt(typeof s=="string"||typeof s>"u","internal-error",{appName:e})}class ai{constructor({uid:e,auth:t,stsTokenManager:i,...l}){this.providerId="firebase",this.proactiveRefresh=new uA(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=l.displayName||null,this.email=l.email||null,this.emailVerified=l.emailVerified||!1,this.phoneNumber=l.phoneNumber||null,this.photoURL=l.photoURL||null,this.isAnonymous=l.isAnonymous||!1,this.tenantId=l.tenantId||null,this.providerData=l.providerData?[...l.providerData]:[],this.metadata=new Eg(l.createdAt||void 0,l.lastLoginAt||void 0)}async getIdToken(e){const t=await mu(this,this.stsTokenManager.getToken(this.auth,e));return bt(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return lA(this,e)}reload(){return dA(this)}_assign(e){this!==e&&(bt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new ai({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){bt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),t&&await Ph(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(jr(this.auth.app))return Promise.reject(na(this.auth));const e=await this.getIdToken();return await mu(this,oA(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const i=t.displayName??void 0,l=t.email??void 0,u=t.phoneNumber??void 0,d=t.photoURL??void 0,p=t.tenantId??void 0,g=t._redirectEventId??void 0,y=t.createdAt??void 0,b=t.lastLoginAt??void 0,{uid:E,emailVerified:T,isAnonymous:L,providerData:W,stsTokenManager:H}=t;bt(E&&H,e,"internal-error");const B=Pl.fromJSON(this.name,H);bt(typeof E=="string",e,"internal-error"),Ua(i,e.name),Ua(l,e.name),bt(typeof T=="boolean",e,"internal-error"),bt(typeof L=="boolean",e,"internal-error"),Ua(u,e.name),Ua(d,e.name),Ua(p,e.name),Ua(g,e.name),Ua(y,e.name),Ua(b,e.name);const K=new ai({uid:E,auth:e,email:l,emailVerified:T,displayName:i,isAnonymous:L,photoURL:d,phoneNumber:u,tenantId:p,stsTokenManager:B,createdAt:y,lastLoginAt:b});return W&&Array.isArray(W)&&(K.providerData=W.map(G=>({...G}))),g&&(K._redirectEventId=g),K}static async _fromIdTokenResponse(e,t,i=!1){const l=new Pl;l.updateFromServerResponse(t);const u=new ai({uid:t.localId,auth:e,stsTokenManager:l,isAnonymous:i});return await Ph(u),u}static async _fromGetAccountInfoResponse(e,t,i){const l=t.users[0];bt(l.localId!==void 0,"internal-error");const u=l.providerUserInfo!==void 0?Zx(l.providerUserInfo):[],d=!(l.email&&l.passwordHash)&&!u?.length,p=new Pl;p.updateFromIdToken(i);const g=new ai({uid:l.localId,auth:e,stsTokenManager:p,isAnonymous:d}),y={uid:l.localId,displayName:l.displayName||null,photoURL:l.photoUrl||null,email:l.email||null,emailVerified:l.emailVerified||!1,phoneNumber:l.phoneNumber||null,tenantId:l.tenantId||null,providerData:u,metadata:new Eg(l.createdAt,l.lastLoginAt),isAnonymous:!(l.email&&l.passwordHash)&&!u?.length};return Object.assign(g,y),g}}const b2=new Map;function Zi(s){oa(s instanceof Function,"Expected a class definition");let e=b2.get(s);return e?(oa(e instanceof s,"Instance stored in cache mismatched with class"),e):(e=new s,b2.set(s,e),e)}class e_{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}e_.type="NONE";const w2=e_;function _h(s,e,t){return`firebase:${s}:${e}:${t}`}class Vl{constructor(e,t,i){this.persistence=e,this.auth=t,this.userKey=i;const{config:l,name:u}=this.auth;this.fullUserKey=_h(this.userKey,l.apiKey,u),this.fullPersistenceKey=_h("persistence",l.apiKey,u),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await Oh(this.auth,{idToken:e}).catch(()=>{});return t?ai._fromGetAccountInfoResponse(this.auth,t,e):null}return ai._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,i="authUser"){if(!t.length)return new Vl(Zi(w2),e,i);const l=(await Promise.all(t.map(async y=>{if(await y._isAvailable())return y}))).filter(y=>y);let u=l[0]||Zi(w2);const d=_h(i,e.config.apiKey,e.name);let p=null;for(const y of t)try{const b=await y._get(d);if(b){let E;if(typeof b=="string"){const T=await Oh(e,{idToken:b}).catch(()=>{});if(!T)break;E=await ai._fromGetAccountInfoResponse(e,T,b)}else E=ai._fromJSON(e,b);y!==u&&(p=E),u=y;break}}catch{}const g=l.filter(y=>y._shouldAllowMigration);return!u._shouldAllowMigration||!g.length?new Vl(u,e,i):(u=g[0],p&&await u._set(d,p.toJSON()),await Promise.all(t.map(async y=>{if(y!==u)try{await y._remove(d)}catch{}})),new Vl(u,e,i))}}function x2(s){const e=s.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(r_(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(t_(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(a_(e))return"Blackberry";if(o_(e))return"Webos";if(n_(e))return"Safari";if((e.includes("chrome/")||s_(e))&&!e.includes("edge/"))return"Chrome";if(i_(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=s.match(t);if(i?.length===2)return i[1]}return"Other"}function t_(s=Gs()){return/firefox\//i.test(s)}function n_(s=Gs()){const e=s.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function s_(s=Gs()){return/crios\//i.test(s)}function r_(s=Gs()){return/iemobile/i.test(s)}function i_(s=Gs()){return/android/i.test(s)}function a_(s=Gs()){return/blackberry/i.test(s)}function o_(s=Gs()){return/webos/i.test(s)}function hy(s=Gs()){return/iphone|ipad|ipod/i.test(s)||/macintosh/i.test(s)&&/mobile/i.test(s)}function pA(s=Gs()){return hy(s)&&!!window.navigator?.standalone}function gA(){return IC()&&document.documentMode===10}function l_(s=Gs()){return hy(s)||i_(s)||o_(s)||a_(s)||/windows phone/i.test(s)||r_(s)}function c_(s,e=[]){let t;switch(s){case"Browser":t=x2(Gs());break;case"Worker":t=`${x2(Gs())}-${s}`;break;default:t=s}const i=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Go}/${i}`}class yA{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const i=u=>new Promise((d,p)=>{try{const g=e(u);d(g)}catch(g){p(g)}});i.onAbort=t,this.queue.push(i);const l=this.queue.length-1;return()=>{this.queue[l]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const i of this.queue)await i(e),i.onAbort&&t.push(i.onAbort)}catch(i){t.reverse();for(const l of t)try{l()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i?.message})}}}async function vA(s,e={}){return da(s,"GET","/v2/passwordPolicy",ua(s,e))}const bA=6;class wA{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??bA,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const i=this.customStrengthOptions.minPasswordLength,l=this.customStrengthOptions.maxPasswordLength;i&&(t.meetsMinPasswordLength=e.length>=i),l&&(t.meetsMaxPasswordLength=e.length<=l)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let i;for(let l=0;l<e.length;l++)i=e.charAt(l),this.updatePasswordCharacterOptionsStatuses(t,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,t,i,l,u){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=l)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=u))}}class xA{constructor(e,t,i,l){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=i,this.config=l,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new _2(this),this.idTokenSubscription=new _2(this),this.beforeStateQueue=new yA(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Kx,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=l.sdkClientVersion,this._persistenceManagerAvailable=new Promise(u=>this._resolvePersistenceManagerAvailable=u)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Zi(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await Vl.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await Oh(this,{idToken:e}),i=await ai._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(i)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(jr(this.app)){const u=this.app.settings.authIdToken;return u?new Promise(d=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(u).then(d,d))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let i=t,l=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const u=this.redirectUser?._redirectEventId,d=i?._redirectEventId,p=await this.tryRedirectSignIn(e);(!u||u===d)&&p?.user&&(i=p.user,l=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(l)try{await this.beforeStateQueue.runMiddleware(i)}catch(u){i=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(u))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return bt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Ph(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=ZN()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(jr(this.app))return Promise.reject(na(this));const t=e?fn(e):null;return t&&bt(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&bt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return jr(this.app)?Promise.reject(na(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return jr(this.app)?Promise.reject(na(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Zi(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await vA(this),t=new wA(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new $o("auth","Firebase",e())}onAuthStateChanged(e,t,i){return this.registerStateListener(this.authStateSubscription,e,t,i)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,i){return this.registerStateListener(this.idTokenSubscription,e,t,i)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const i=this.onAuthStateChanged(()=>{i(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(i.tenantId=this.tenantId),await mA(this,i)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const i=await this.getOrInitRedirectPersistenceManager(t);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Zi(e)||this._popupRedirectResolver;bt(t,this,"argument-error"),this.redirectPersistenceManager=await Vl.create(this,[Zi(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,i,l){if(this._deleted)return()=>{};const u=typeof t=="function"?t:t.next.bind(t);let d=!1;const p=this._isInitialized?Promise.resolve():this._initializationPromise;if(bt(p,this,"internal-error"),p.then(()=>{d||u(this.currentUser)}),typeof t=="function"){const g=e.addObserver(t,i,l);return()=>{d=!0,g()}}else{const g=e.addObserver(t);return()=>{d=!0,g()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return bt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=c_(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const i=await this._getAppCheckToken();return i&&(e["X-Firebase-AppCheck"]=i),e}async _getAppCheckToken(){if(jr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&QN(`Error while retrieving App Check token: ${e.error}`),e?.token}}function ao(s){return fn(s)}class _2{constructor(e){this.auth=e,this.observer=null,this.addObserver=UC(t=>this.observer=t)}get next(){return bt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let af={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function _A(s){af=s}function u_(s){return af.loadJS(s)}function kA(){return af.recaptchaEnterpriseScript}function EA(){return af.gapiScript}function TA(s){return`__${s}${Math.floor(Math.random()*1e6)}`}class jA{constructor(){this.enterprise=new SA}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class SA{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const CA="recaptcha-enterprise",d_="NO_RECAPTCHA";class NA{constructor(e){this.type=CA,this.auth=ao(e)}async verify(e="verify",t=!1){async function i(u){if(!t){if(u.tenantId==null&&u._agentRecaptchaConfig!=null)return u._agentRecaptchaConfig.siteKey;if(u.tenantId!=null&&u._tenantRecaptchaConfigs[u.tenantId]!==void 0)return u._tenantRecaptchaConfigs[u.tenantId].siteKey}return new Promise(async(d,p)=>{aA(u,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(g=>{if(g.recaptchaKey===void 0)p(new Error("recaptcha Enterprise site key undefined"));else{const y=new iA(g);return u.tenantId==null?u._agentRecaptchaConfig=y:u._tenantRecaptchaConfigs[u.tenantId]=y,d(y.siteKey)}}).catch(g=>{p(g)})})}function l(u,d,p){const g=window.grecaptcha;y2(g)?g.enterprise.ready(()=>{g.enterprise.execute(u,{action:e}).then(y=>{d(y)}).catch(()=>{d(d_)})}):p(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new jA().execute("siteKey",{action:"verify"}):new Promise((u,d)=>{i(this.auth).then(p=>{if(!t&&y2(window.grecaptcha))l(p,u,d);else{if(typeof window>"u"){d(new Error("RecaptchaVerifier is only supported in browser"));return}let g=kA();g.length!==0&&(g+=p),u_(g).then(()=>{l(p,u,d)}).catch(y=>{d(y)})}}).catch(p=>{d(p)})})}}async function k2(s,e,t,i=!1,l=!1){const u=new NA(s);let d;if(l)d=d_;else try{d=await u.verify(t)}catch{d=await u.verify(t,!0)}const p={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in p){const g=p.phoneEnrollmentInfo.phoneNumber,y=p.phoneEnrollmentInfo.recaptchaToken;Object.assign(p,{phoneEnrollmentInfo:{phoneNumber:g,recaptchaToken:y,captchaResponse:d,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in p){const g=p.phoneSignInInfo.recaptchaToken;Object.assign(p,{phoneSignInInfo:{recaptchaToken:g,captchaResponse:d,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return p}return i?Object.assign(p,{captchaResp:d}):Object.assign(p,{captchaResponse:d}),Object.assign(p,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(p,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),p}async function Vh(s,e,t,i,l){if(s._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const u=await k2(s,e,t,t==="getOobCode");return i(s,u)}else return i(s,e).catch(async u=>{if(u.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const d=await k2(s,e,t,t==="getOobCode");return i(s,d)}else return Promise.reject(u)})}function AA(s,e){const t=Wo(s,"auth");if(t.isInitialized()){const l=t.getImmediate(),u=t.getOptions();if(ia(u,e??{}))return l;ci(l,"already-initialized")}return t.initialize({options:e})}function RA(s,e){const t=e?.persistence||[],i=(Array.isArray(t)?t:[t]).map(Zi);e?.errorMap&&s._updateErrorMap(e.errorMap),s._initializeWithPersistence(i,e?.popupRedirectResolver)}function IA(s,e,t){const i=ao(s);bt(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const l=!1,u=h_(e),{host:d,port:p}=MA(e),g=p===null?"":`:${p}`,y={url:`${u}//${d}${g}/`},b=Object.freeze({host:d,port:p,protocol:u.replace(":",""),options:Object.freeze({disableWarnings:l})});if(!i._canInitEmulator){bt(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),bt(ia(y,i.config.emulator)&&ia(b,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=y,i.emulatorConfig=b,i.settings.appVerificationDisabledForTesting=!0,io(d)?(ry(`${u}//${d}${g}`),iy("Auth",!0)):DA()}function h_(s){const e=s.indexOf(":");return e<0?"":s.substr(0,e+1)}function MA(s){const e=h_(s),t=/(\/\/)?([^?#/]+)/.exec(s.substr(e.length));if(!t)return{host:"",port:null};const i=t[2].split("@").pop()||"",l=/^(\[[^\]]+\])(:|$)/.exec(i);if(l){const u=l[1];return{host:u,port:E2(i.substr(u.length+1))}}else{const[u,d]=i.split(":");return{host:u,port:E2(d)}}}function E2(s){if(!s)return null;const e=Number(s);return isNaN(e)?null:e}function DA(){function s(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",s):s())}class fy{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Ji("not implemented")}_getIdTokenResponse(e){return Ji("not implemented")}_linkToIdToken(e,t){return Ji("not implemented")}_getReauthenticationResolver(e){return Ji("not implemented")}}async function LA(s,e){return da(s,"POST","/v1/accounts:signUp",e)}async function OA(s,e){return Iu(s,"POST","/v1/accounts:signInWithPassword",ua(s,e))}async function f_(s,e){return da(s,"POST","/v1/accounts:sendOobCode",ua(s,e))}async function PA(s,e){return f_(s,e)}async function VA(s,e){return f_(s,e)}async function UA(s,e){return Iu(s,"POST","/v1/accounts:signInWithEmailLink",ua(s,e))}async function BA(s,e){return Iu(s,"POST","/v1/accounts:signInWithEmailLink",ua(s,e))}class pu extends fy{constructor(e,t,i,l=null){super("password",i),this._email=e,this._password=t,this._tenantId=l}static _fromEmailAndPassword(e,t){return new pu(e,t,"password")}static _fromEmailAndCode(e,t,i=null){return new pu(e,t,"emailLink",i)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Vh(e,t,"signInWithPassword",OA);case"emailLink":return UA(e,{email:this._email,oobCode:this._password});default:ci(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const i={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Vh(e,i,"signUpPassword",LA);case"emailLink":return BA(e,{idToken:t,email:this._email,oobCode:this._password});default:ci(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function Ul(s,e){return Iu(s,"POST","/v1/accounts:signInWithIdp",ua(s,e))}const zA="http://localhost";class Po extends fy{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Po(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):ci("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:l,...u}=t;if(!i||!l)return null;const d=new Po(i,l);return d.idToken=u.idToken||void 0,d.accessToken=u.accessToken||void 0,d.secret=u.secret,d.nonce=u.nonce,d.pendingToken=u.pendingToken||null,d}_getIdTokenResponse(e){const t=this.buildRequest();return Ul(e,t)}_linkToIdToken(e,t){const i=this.buildRequest();return i.idToken=t,Ul(e,i)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Ul(e,t)}buildRequest(){const e={requestUri:zA,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Nu(t)}return e}}function FA(s){switch(s){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function qA(s){const e=Zc(eu(s)).link,t=e?Zc(eu(e)).deep_link_id:null,i=Zc(eu(s)).deep_link_id;return(i?Zc(eu(i)).link:null)||i||t||e||s}class my{constructor(e){const t=Zc(eu(e)),i=t.apiKey??null,l=t.oobCode??null,u=FA(t.mode??null);bt(i&&l&&u,"argument-error"),this.apiKey=i,this.operation=u,this.code=l,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=qA(e);try{return new my(t)}catch{return null}}}class Zl{constructor(){this.providerId=Zl.PROVIDER_ID}static credential(e,t){return pu._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const i=my.parseLink(t);return bt(i,"argument-error"),pu._fromEmailAndCode(e,i.code,i.tenantId)}}Zl.PROVIDER_ID="password";Zl.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Zl.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class m_{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class Mu extends m_{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class za extends Mu{constructor(){super("facebook.com")}static credential(e){return Po._fromParams({providerId:za.PROVIDER_ID,signInMethod:za.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return za.credentialFromTaggedObject(e)}static credentialFromError(e){return za.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return za.credential(e.oauthAccessToken)}catch{return null}}}za.FACEBOOK_SIGN_IN_METHOD="facebook.com";za.PROVIDER_ID="facebook.com";class Fa extends Mu{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Po._fromParams({providerId:Fa.PROVIDER_ID,signInMethod:Fa.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Fa.credentialFromTaggedObject(e)}static credentialFromError(e){return Fa.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:i}=e;if(!t&&!i)return null;try{return Fa.credential(t,i)}catch{return null}}}Fa.GOOGLE_SIGN_IN_METHOD="google.com";Fa.PROVIDER_ID="google.com";class qa extends Mu{constructor(){super("github.com")}static credential(e){return Po._fromParams({providerId:qa.PROVIDER_ID,signInMethod:qa.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return qa.credentialFromTaggedObject(e)}static credentialFromError(e){return qa.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return qa.credential(e.oauthAccessToken)}catch{return null}}}qa.GITHUB_SIGN_IN_METHOD="github.com";qa.PROVIDER_ID="github.com";class Ha extends Mu{constructor(){super("twitter.com")}static credential(e,t){return Po._fromParams({providerId:Ha.PROVIDER_ID,signInMethod:Ha.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Ha.credentialFromTaggedObject(e)}static credentialFromError(e){return Ha.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:i}=e;if(!t||!i)return null;try{return Ha.credential(t,i)}catch{return null}}}Ha.TWITTER_SIGN_IN_METHOD="twitter.com";Ha.PROVIDER_ID="twitter.com";async function HA(s,e){return Iu(s,"POST","/v1/accounts:signUp",ua(s,e))}class Vo{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,i,l=!1){const u=await ai._fromIdTokenResponse(e,i,l),d=T2(i);return new Vo({user:u,providerId:d,_tokenResponse:i,operationType:t})}static async _forOperation(e,t,i){await e._updateTokensIfNecessary(i,!0);const l=T2(i);return new Vo({user:e,providerId:l,_tokenResponse:i,operationType:t})}}function T2(s){return s.providerId?s.providerId:"phoneNumber"in s?"phone":null}class Uh extends hi{constructor(e,t,i,l){super(t.code,t.message),this.operationType=i,this.user=l,Object.setPrototypeOf(this,Uh.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,t,i,l){return new Uh(e,t,i,l)}}function p_(s,e,t,i){return(e==="reauthenticate"?t._getReauthenticationResolver(s):t._getIdTokenResponse(s)).catch(u=>{throw u.code==="auth/multi-factor-auth-required"?Uh._fromErrorAndOperation(s,u,e,i):u})}async function $A(s,e,t=!1){const i=await mu(s,e._linkToIdToken(s.auth,await s.getIdToken()),t);return Vo._forOperation(s,"link",i)}async function WA(s,e,t=!1){const{auth:i}=s;if(jr(i.app))return Promise.reject(na(i));const l="reauthenticate";try{const u=await mu(s,p_(i,l,e,s),t);bt(u.idToken,i,"internal-error");const d=dy(u.idToken);bt(d,i,"internal-error");const{sub:p}=d;return bt(s.uid===p,i,"user-mismatch"),Vo._forOperation(s,l,u)}catch(u){throw u?.code==="auth/user-not-found"&&ci(i,"user-mismatch"),u}}async function g_(s,e,t=!1){if(jr(s.app))return Promise.reject(na(s));const i="signIn",l=await p_(s,i,e),u=await Vo._fromIdTokenResponse(s,i,l);return t||await s._updateCurrentUser(u.user),u}async function GA(s,e){return g_(ao(s),e)}async function y_(s){const e=ao(s);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function KA(s,e,t){const i=ao(s);await Vh(i,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",VA)}async function YA(s,e,t){if(jr(s.app))return Promise.reject(na(s));const i=ao(s),d=await Vh(i,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",HA).catch(g=>{throw g.code==="auth/password-does-not-meet-requirements"&&y_(s),g}),p=await Vo._fromIdTokenResponse(i,"signIn",d);return await i._updateCurrentUser(p.user),p}function QA(s,e,t){return jr(s.app)?Promise.reject(na(s)):GA(fn(s),Zl.credential(e,t)).catch(async i=>{throw i.code==="auth/password-does-not-meet-requirements"&&y_(s),i})}async function AO(s,e){const t=fn(s),l={requestType:"VERIFY_EMAIL",idToken:await s.getIdToken()},{email:u}=await PA(t.auth,l);u!==s.email&&await s.reload()}function j2(s,e){return fn(s).setPersistence(e)}function XA(s,e,t,i){return fn(s).onIdTokenChanged(e,t,i)}function JA(s,e,t){return fn(s).beforeAuthStateChanged(e,t)}function ZA(s,e,t,i){return fn(s).onAuthStateChanged(e,t,i)}function e4(s){return fn(s).signOut()}const Bh="__sak";class v_{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Bh,"1"),this.storage.removeItem(Bh),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const t4=1e3,n4=10;class b_ extends v_{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=l_(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const i=this.storage.getItem(t),l=this.localCache[t];i!==l&&e(t,l,i)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((d,p,g)=>{this.notifyListeners(d,g)});return}const i=e.key;t?this.detachListener():this.stopPolling();const l=()=>{const d=this.storage.getItem(i);!t&&this.localCache[i]===d||this.notifyListeners(i,d)},u=this.storage.getItem(i);gA()&&u!==e.newValue&&e.newValue!==e.oldValue?setTimeout(l,n4):l()}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const l of Array.from(i))l(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:i}),!0)})},t4)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}b_.type="LOCAL";const Tg=b_;class w_ extends v_{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}w_.type="SESSION";const py=w_;function s4(s){return Promise.all(s.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class of{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(l=>l.isListeningto(e));if(t)return t;const i=new of(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:i,eventType:l,data:u}=t.data,d=this.handlersMap[l];if(!d?.size)return;t.ports[0].postMessage({status:"ack",eventId:i,eventType:l});const p=Array.from(d).map(async y=>y(t.origin,u)),g=await s4(p);t.ports[0].postMessage({status:"done",eventId:i,eventType:l,response:g})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}of.receivers=[];function gy(s="",e=10){let t="";for(let i=0;i<e;i++)t+=Math.floor(Math.random()*10);return s+t}class r4{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,i=50){const l=typeof MessageChannel<"u"?new MessageChannel:null;if(!l)throw new Error("connection_unavailable");let u,d;return new Promise((p,g)=>{const y=gy("",20);l.port1.start();const b=setTimeout(()=>{g(new Error("unsupported_event"))},i);d={messageChannel:l,onMessage(E){const T=E;if(T.data.eventId===y)switch(T.data.status){case"ack":clearTimeout(b),u=setTimeout(()=>{g(new Error("timeout"))},3e3);break;case"done":clearTimeout(u),p(T.data.response);break;default:clearTimeout(b),clearTimeout(u),g(new Error("invalid_response"));break}}},this.handlers.add(d),l.port1.addEventListener("message",d.onMessage),this.target.postMessage({eventType:e,eventId:y,data:t},[l.port2])}).finally(()=>{d&&this.removeMessageHandler(d)})}}function ji(){return window}function i4(s){ji().location.href=s}function x_(){return typeof ji().WorkerGlobalScope<"u"&&typeof ji().importScripts=="function"}async function a4(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function o4(){return navigator?.serviceWorker?.controller||null}function l4(){return x_()?self:null}const __="firebaseLocalStorageDb",c4=1,zh="firebaseLocalStorage",k_="fbase_key";class Du{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function lf(s,e){return s.transaction([zh],e?"readwrite":"readonly").objectStore(zh)}function u4(){const s=indexedDB.deleteDatabase(__);return new Du(s).toPromise()}function jg(){const s=indexedDB.open(__,c4);return new Promise((e,t)=>{s.addEventListener("error",()=>{t(s.error)}),s.addEventListener("upgradeneeded",()=>{const i=s.result;try{i.createObjectStore(zh,{keyPath:k_})}catch(l){t(l)}}),s.addEventListener("success",async()=>{const i=s.result;i.objectStoreNames.contains(zh)?e(i):(i.close(),await u4(),e(await jg()))})})}async function S2(s,e,t){const i=lf(s,!0).put({[k_]:e,value:t});return new Du(i).toPromise()}async function d4(s,e){const t=lf(s,!1).get(e),i=await new Du(t).toPromise();return i===void 0?null:i.value}function C2(s,e){const t=lf(s,!0).delete(e);return new Du(t).toPromise()}const h4=800,f4=3;class E_{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await jg(),this.db)}async _withRetries(e){let t=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(i){if(t++>f4)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return x_()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=of._getInstance(l4()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await a4(),!this.activeServiceWorker)return;this.sender=new r4(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||o4()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await jg();return await S2(e,Bh,"1"),await C2(e,Bh),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(i=>S2(i,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(i=>d4(i,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>C2(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(l=>{const u=lf(l,!1).getAll();return new Du(u).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],i=new Set;if(e.length!==0)for(const{fbase_key:l,value:u}of e)i.add(l),JSON.stringify(this.localCache[l])!==JSON.stringify(u)&&(this.notifyListeners(l,u),t.push(l));for(const l of Object.keys(this.localCache))this.localCache[l]&&!i.has(l)&&(this.notifyListeners(l,null),t.push(l));return t}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const l of Array.from(i))l(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),h4)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}E_.type="LOCAL";const m4=E_;new Ru(3e4,6e4);function p4(s,e){return e?Zi(e):(bt(s._popupRedirectResolver,s,"argument-error"),s._popupRedirectResolver)}class yy extends fy{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Ul(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Ul(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Ul(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function g4(s){return g_(s.auth,new yy(s),s.bypassAuthState)}function y4(s){const{auth:e,user:t}=s;return bt(t,e,"internal-error"),WA(t,new yy(s),s.bypassAuthState)}async function v4(s){const{auth:e,user:t}=s;return bt(t,e,"internal-error"),$A(t,new yy(s),s.bypassAuthState)}class T_{constructor(e,t,i,l,u=!1){this.auth=e,this.resolver=i,this.user=l,this.bypassAuthState=u,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:i,postBody:l,tenantId:u,error:d,type:p}=e;if(d){this.reject(d);return}const g={auth:this.auth,requestUri:t,sessionId:i,tenantId:u||void 0,postBody:l||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(p)(g))}catch(y){this.reject(y)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return g4;case"linkViaPopup":case"linkViaRedirect":return v4;case"reauthViaPopup":case"reauthViaRedirect":return y4;default:ci(this.auth,"internal-error")}}resolve(e){oa(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){oa(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const b4=new Ru(2e3,1e4);class Ol extends T_{constructor(e,t,i,l,u){super(e,t,l,u),this.provider=i,this.authWindow=null,this.pollId=null,Ol.currentPopupAction&&Ol.currentPopupAction.cancel(),Ol.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return bt(e,this.auth,"internal-error"),e}async onExecution(){oa(this.filter.length===1,"Popup operations only handle one event");const e=gy();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Ti(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(Ti(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Ol.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Ti(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,b4.get())};e()}}Ol.currentPopupAction=null;const w4="pendingRedirect",kh=new Map;class x4 extends T_{constructor(e,t,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,i),this.eventId=null}async execute(){let e=kh.get(this.auth._key());if(!e){try{const i=await _4(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(t){e=()=>Promise.reject(t)}kh.set(this.auth._key(),e)}return this.bypassAuthState||kh.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function _4(s,e){const t=T4(e),i=E4(s);if(!await i._isAvailable())return!1;const l=await i._get(t)==="true";return await i._remove(t),l}function k4(s,e){kh.set(s._key(),e)}function E4(s){return Zi(s._redirectPersistence)}function T4(s){return _h(w4,s.config.apiKey,s.name)}async function j4(s,e,t=!1){if(jr(s.app))return Promise.reject(na(s));const i=ao(s),l=p4(i,e),d=await new x4(i,l,t).execute();return d&&!t&&(delete d.user._redirectEventId,await i._persistUserIfCurrent(d.user),await i._setRedirectUser(null,e)),d}const S4=600*1e3;class C4{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(t=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!N4(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!j_(e)){const i=e.error.code?.split("auth/")[1]||"internal-error";t.onError(Ti(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const i=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=S4&&this.cachedEventUids.clear(),this.cachedEventUids.has(N2(e))}saveEventToCache(e){this.cachedEventUids.add(N2(e)),this.lastProcessedEventTime=Date.now()}}function N2(s){return[s.type,s.eventId,s.sessionId,s.tenantId].filter(e=>e).join("-")}function j_({type:s,error:e}){return s==="unknown"&&e?.code==="auth/no-auth-event"}function N4(s){switch(s.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return j_(s);default:return!1}}async function A4(s,e={}){return da(s,"GET","/v1/projects",e)}const R4=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,I4=/^https?/;async function M4(s){if(s.config.emulator)return;const{authorizedDomains:e}=await A4(s);for(const t of e)try{if(D4(t))return}catch{}ci(s,"unauthorized-domain")}function D4(s){const e=kg(),{protocol:t,hostname:i}=new URL(e);if(s.startsWith("chrome-extension://")){const d=new URL(s);return d.hostname===""&&i===""?t==="chrome-extension:"&&s.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&d.hostname===i}if(!I4.test(t))return!1;if(R4.test(s))return i===s;const l=s.replace(/\./g,"\\.");return new RegExp("^(.+\\."+l+"|"+l+")$","i").test(i)}const L4=new Ru(3e4,6e4);function A2(){const s=ji().___jsl;if(s?.H){for(const e of Object.keys(s.H))if(s.H[e].r=s.H[e].r||[],s.H[e].L=s.H[e].L||[],s.H[e].r=[...s.H[e].L],s.CP)for(let t=0;t<s.CP.length;t++)s.CP[t]=null}}function O4(s){return new Promise((e,t)=>{function i(){A2(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{A2(),t(Ti(s,"network-request-failed"))},timeout:L4.get()})}if(ji().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(ji().gapi?.load)i();else{const l=TA("iframefcb");return ji()[l]=()=>{gapi.load?i():t(Ti(s,"network-request-failed"))},u_(`${EA()}?onload=${l}`).catch(u=>t(u))}}).catch(e=>{throw Eh=null,e})}let Eh=null;function P4(s){return Eh=Eh||O4(s),Eh}const V4=new Ru(5e3,15e3),U4="__/auth/iframe",B4="emulator/auth/iframe",z4={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},F4=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function q4(s){const e=s.config;bt(e.authDomain,s,"auth-domain-config-required");const t=e.emulator?uy(e,B4):`https://${s.config.authDomain}/${U4}`,i={apiKey:e.apiKey,appName:s.name,v:Go},l=F4.get(s.config.apiHost);l&&(i.eid=l);const u=s._getFrameworks();return u.length&&(i.fw=u.join(",")),`${t}?${Nu(i).slice(1)}`}async function H4(s){const e=await P4(s),t=ji().gapi;return bt(t,s,"internal-error"),e.open({where:document.body,url:q4(s),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:z4,dontclear:!0},i=>new Promise(async(l,u)=>{await i.restyle({setHideOnLeave:!1});const d=Ti(s,"network-request-failed"),p=ji().setTimeout(()=>{u(d)},V4.get());function g(){ji().clearTimeout(p),l(i)}i.ping(g).then(g,()=>{u(d)})}))}const $4={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},W4=500,G4=600,K4="_blank",Y4="http://localhost";class R2{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function Q4(s,e,t,i=W4,l=G4){const u=Math.max((window.screen.availHeight-l)/2,0).toString(),d=Math.max((window.screen.availWidth-i)/2,0).toString();let p="";const g={...$4,width:i.toString(),height:l.toString(),top:u,left:d},y=Gs().toLowerCase();t&&(p=s_(y)?K4:t),t_(y)&&(e=e||Y4,g.scrollbars="yes");const b=Object.entries(g).reduce((T,[L,W])=>`${T}${L}=${W},`,"");if(pA(y)&&p!=="_self")return X4(e||"",p),new R2(null);const E=window.open(e||"",p,b);bt(E,s,"popup-blocked");try{E.focus()}catch{}return new R2(E)}function X4(s,e){const t=document.createElement("a");t.href=s,t.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(i)}const J4="__/auth/handler",Z4="emulator/auth/handler",eR=encodeURIComponent("fac");async function I2(s,e,t,i,l,u){bt(s.config.authDomain,s,"auth-domain-config-required"),bt(s.config.apiKey,s,"invalid-api-key");const d={apiKey:s.config.apiKey,appName:s.name,authType:t,redirectUrl:i,v:Go,eventId:l};if(e instanceof m_){e.setDefaultLanguage(s.languageCode),d.providerId=e.providerId||"",VC(e.getCustomParameters())||(d.customParameters=JSON.stringify(e.getCustomParameters()));for(const[b,E]of Object.entries({}))d[b]=E}if(e instanceof Mu){const b=e.getScopes().filter(E=>E!=="");b.length>0&&(d.scopes=b.join(","))}s.tenantId&&(d.tid=s.tenantId);const p=d;for(const b of Object.keys(p))p[b]===void 0&&delete p[b];const g=await s._getAppCheckToken(),y=g?`#${eR}=${encodeURIComponent(g)}`:"";return`${tR(s)}?${Nu(p).slice(1)}${y}`}function tR({config:s}){return s.emulator?uy(s,Z4):`https://${s.authDomain}/${J4}`}const zp="webStorageSupport";class nR{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=py,this._completeRedirectFn=j4,this._overrideRedirectResult=k4}async _openPopup(e,t,i,l){oa(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const u=await I2(e,t,i,kg(),l);return Q4(e,u,gy())}async _openRedirect(e,t,i,l){await this._originValidation(e);const u=await I2(e,t,i,kg(),l);return i4(u),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:l,promise:u}=this.eventManagers[t];return l?Promise.resolve(l):(oa(u,"If manager is not set, promise should be"),u)}const i=this.initAndGetManager(e);return this.eventManagers[t]={promise:i},i.catch(()=>{delete this.eventManagers[t]}),i}async initAndGetManager(e){const t=await H4(e),i=new C4(e);return t.register("authEvent",l=>(bt(l?.authEvent,e,"invalid-auth-event"),{status:i.onEvent(l.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=t,i}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(zp,{type:zp},l=>{const u=l?.[0]?.[zp];u!==void 0&&t(!!u),ci(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=M4(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return l_()||n_()||hy()}}const sR=nR;var M2="@firebase/auth",D2="1.12.0";class rR{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(i=>{e(i?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){bt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function iR(s){switch(s){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function aR(s){li(new Kr("auth",(e,{options:t})=>{const i=e.getProvider("app").getImmediate(),l=e.getProvider("heartbeat"),u=e.getProvider("app-check-internal"),{apiKey:d,authDomain:p}=i.options;bt(d&&!d.includes(":"),"invalid-api-key",{appName:i.name});const g={apiKey:d,authDomain:p,clientPlatform:s,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:c_(s)},y=new xA(i,l,u,g);return RA(y,t),y},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,i)=>{e.getProvider("auth-internal").initialize()})),li(new Kr("auth-internal",e=>{const t=ao(e.getProvider("auth").getImmediate());return(i=>new rR(i))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),pr(M2,D2,iR(s)),pr(M2,D2,"esm2020")}const oR=300,lR=Ux("authIdTokenMaxAge")||oR;let L2=null;const cR=s=>async e=>{const t=e&&await e.getIdTokenResult(),i=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(i&&i>lR)return;const l=t?.token;L2!==l&&(L2=l,await fetch(s,{method:l?"POST":"DELETE",headers:l?{Authorization:`Bearer ${l}`}:{}}))};function S_(s=Au()){const e=Wo(s,"auth");if(e.isInitialized())return e.getImmediate();const t=AA(s,{popupRedirectResolver:sR,persistence:[m4,Tg,py]}),i=Ux("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const u=new URL(i,location.origin);if(location.origin===u.origin){const d=cR(u.toString());JA(t,d,()=>d(t.currentUser)),XA(t,p=>d(p))}}const l=Ox("auth");return l&&IA(t,`http://${l}`),t}function uR(){return document.getElementsByTagName("head")?.[0]??document}_A({loadJS(s){return new Promise((e,t)=>{const i=document.createElement("script");i.setAttribute("src",s),i.onload=e,i.onerror=l=>{const u=Ti("internal-error");u.customData=l,t(u)},i.type="text/javascript",i.charset="UTF-8",uR().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});aR("Browser");var O2=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var Qa,C_;(function(){var s;function e(C,j){function R(){}R.prototype=j.prototype,C.F=j.prototype,C.prototype=new R,C.prototype.constructor=C,C.D=function(V,O,D){for(var A=Array(arguments.length-2),Le=2;Le<arguments.length;Le++)A[Le-2]=arguments[Le];return j.prototype[O].apply(V,A)}}function t(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(i,t),i.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function l(C,j,R){R||(R=0);const V=Array(16);if(typeof j=="string")for(var O=0;O<16;++O)V[O]=j.charCodeAt(R++)|j.charCodeAt(R++)<<8|j.charCodeAt(R++)<<16|j.charCodeAt(R++)<<24;else for(O=0;O<16;++O)V[O]=j[R++]|j[R++]<<8|j[R++]<<16|j[R++]<<24;j=C.g[0],R=C.g[1],O=C.g[2];let D=C.g[3],A;A=j+(D^R&(O^D))+V[0]+3614090360&4294967295,j=R+(A<<7&4294967295|A>>>25),A=D+(O^j&(R^O))+V[1]+3905402710&4294967295,D=j+(A<<12&4294967295|A>>>20),A=O+(R^D&(j^R))+V[2]+606105819&4294967295,O=D+(A<<17&4294967295|A>>>15),A=R+(j^O&(D^j))+V[3]+3250441966&4294967295,R=O+(A<<22&4294967295|A>>>10),A=j+(D^R&(O^D))+V[4]+4118548399&4294967295,j=R+(A<<7&4294967295|A>>>25),A=D+(O^j&(R^O))+V[5]+1200080426&4294967295,D=j+(A<<12&4294967295|A>>>20),A=O+(R^D&(j^R))+V[6]+2821735955&4294967295,O=D+(A<<17&4294967295|A>>>15),A=R+(j^O&(D^j))+V[7]+4249261313&4294967295,R=O+(A<<22&4294967295|A>>>10),A=j+(D^R&(O^D))+V[8]+1770035416&4294967295,j=R+(A<<7&4294967295|A>>>25),A=D+(O^j&(R^O))+V[9]+2336552879&4294967295,D=j+(A<<12&4294967295|A>>>20),A=O+(R^D&(j^R))+V[10]+4294925233&4294967295,O=D+(A<<17&4294967295|A>>>15),A=R+(j^O&(D^j))+V[11]+2304563134&4294967295,R=O+(A<<22&4294967295|A>>>10),A=j+(D^R&(O^D))+V[12]+1804603682&4294967295,j=R+(A<<7&4294967295|A>>>25),A=D+(O^j&(R^O))+V[13]+4254626195&4294967295,D=j+(A<<12&4294967295|A>>>20),A=O+(R^D&(j^R))+V[14]+2792965006&4294967295,O=D+(A<<17&4294967295|A>>>15),A=R+(j^O&(D^j))+V[15]+1236535329&4294967295,R=O+(A<<22&4294967295|A>>>10),A=j+(O^D&(R^O))+V[1]+4129170786&4294967295,j=R+(A<<5&4294967295|A>>>27),A=D+(R^O&(j^R))+V[6]+3225465664&4294967295,D=j+(A<<9&4294967295|A>>>23),A=O+(j^R&(D^j))+V[11]+643717713&4294967295,O=D+(A<<14&4294967295|A>>>18),A=R+(D^j&(O^D))+V[0]+3921069994&4294967295,R=O+(A<<20&4294967295|A>>>12),A=j+(O^D&(R^O))+V[5]+3593408605&4294967295,j=R+(A<<5&4294967295|A>>>27),A=D+(R^O&(j^R))+V[10]+38016083&4294967295,D=j+(A<<9&4294967295|A>>>23),A=O+(j^R&(D^j))+V[15]+3634488961&4294967295,O=D+(A<<14&4294967295|A>>>18),A=R+(D^j&(O^D))+V[4]+3889429448&4294967295,R=O+(A<<20&4294967295|A>>>12),A=j+(O^D&(R^O))+V[9]+568446438&4294967295,j=R+(A<<5&4294967295|A>>>27),A=D+(R^O&(j^R))+V[14]+3275163606&4294967295,D=j+(A<<9&4294967295|A>>>23),A=O+(j^R&(D^j))+V[3]+4107603335&4294967295,O=D+(A<<14&4294967295|A>>>18),A=R+(D^j&(O^D))+V[8]+1163531501&4294967295,R=O+(A<<20&4294967295|A>>>12),A=j+(O^D&(R^O))+V[13]+2850285829&4294967295,j=R+(A<<5&4294967295|A>>>27),A=D+(R^O&(j^R))+V[2]+4243563512&4294967295,D=j+(A<<9&4294967295|A>>>23),A=O+(j^R&(D^j))+V[7]+1735328473&4294967295,O=D+(A<<14&4294967295|A>>>18),A=R+(D^j&(O^D))+V[12]+2368359562&4294967295,R=O+(A<<20&4294967295|A>>>12),A=j+(R^O^D)+V[5]+4294588738&4294967295,j=R+(A<<4&4294967295|A>>>28),A=D+(j^R^O)+V[8]+2272392833&4294967295,D=j+(A<<11&4294967295|A>>>21),A=O+(D^j^R)+V[11]+1839030562&4294967295,O=D+(A<<16&4294967295|A>>>16),A=R+(O^D^j)+V[14]+4259657740&4294967295,R=O+(A<<23&4294967295|A>>>9),A=j+(R^O^D)+V[1]+2763975236&4294967295,j=R+(A<<4&4294967295|A>>>28),A=D+(j^R^O)+V[4]+1272893353&4294967295,D=j+(A<<11&4294967295|A>>>21),A=O+(D^j^R)+V[7]+4139469664&4294967295,O=D+(A<<16&4294967295|A>>>16),A=R+(O^D^j)+V[10]+3200236656&4294967295,R=O+(A<<23&4294967295|A>>>9),A=j+(R^O^D)+V[13]+681279174&4294967295,j=R+(A<<4&4294967295|A>>>28),A=D+(j^R^O)+V[0]+3936430074&4294967295,D=j+(A<<11&4294967295|A>>>21),A=O+(D^j^R)+V[3]+3572445317&4294967295,O=D+(A<<16&4294967295|A>>>16),A=R+(O^D^j)+V[6]+76029189&4294967295,R=O+(A<<23&4294967295|A>>>9),A=j+(R^O^D)+V[9]+3654602809&4294967295,j=R+(A<<4&4294967295|A>>>28),A=D+(j^R^O)+V[12]+3873151461&4294967295,D=j+(A<<11&4294967295|A>>>21),A=O+(D^j^R)+V[15]+530742520&4294967295,O=D+(A<<16&4294967295|A>>>16),A=R+(O^D^j)+V[2]+3299628645&4294967295,R=O+(A<<23&4294967295|A>>>9),A=j+(O^(R|~D))+V[0]+4096336452&4294967295,j=R+(A<<6&4294967295|A>>>26),A=D+(R^(j|~O))+V[7]+1126891415&4294967295,D=j+(A<<10&4294967295|A>>>22),A=O+(j^(D|~R))+V[14]+2878612391&4294967295,O=D+(A<<15&4294967295|A>>>17),A=R+(D^(O|~j))+V[5]+4237533241&4294967295,R=O+(A<<21&4294967295|A>>>11),A=j+(O^(R|~D))+V[12]+1700485571&4294967295,j=R+(A<<6&4294967295|A>>>26),A=D+(R^(j|~O))+V[3]+2399980690&4294967295,D=j+(A<<10&4294967295|A>>>22),A=O+(j^(D|~R))+V[10]+4293915773&4294967295,O=D+(A<<15&4294967295|A>>>17),A=R+(D^(O|~j))+V[1]+2240044497&4294967295,R=O+(A<<21&4294967295|A>>>11),A=j+(O^(R|~D))+V[8]+1873313359&4294967295,j=R+(A<<6&4294967295|A>>>26),A=D+(R^(j|~O))+V[15]+4264355552&4294967295,D=j+(A<<10&4294967295|A>>>22),A=O+(j^(D|~R))+V[6]+2734768916&4294967295,O=D+(A<<15&4294967295|A>>>17),A=R+(D^(O|~j))+V[13]+1309151649&4294967295,R=O+(A<<21&4294967295|A>>>11),A=j+(O^(R|~D))+V[4]+4149444226&4294967295,j=R+(A<<6&4294967295|A>>>26),A=D+(R^(j|~O))+V[11]+3174756917&4294967295,D=j+(A<<10&4294967295|A>>>22),A=O+(j^(D|~R))+V[2]+718787259&4294967295,O=D+(A<<15&4294967295|A>>>17),A=R+(D^(O|~j))+V[9]+3951481745&4294967295,C.g[0]=C.g[0]+j&4294967295,C.g[1]=C.g[1]+(O+(A<<21&4294967295|A>>>11))&4294967295,C.g[2]=C.g[2]+O&4294967295,C.g[3]=C.g[3]+D&4294967295}i.prototype.v=function(C,j){j===void 0&&(j=C.length);const R=j-this.blockSize,V=this.C;let O=this.h,D=0;for(;D<j;){if(O==0)for(;D<=R;)l(this,C,D),D+=this.blockSize;if(typeof C=="string"){for(;D<j;)if(V[O++]=C.charCodeAt(D++),O==this.blockSize){l(this,V),O=0;break}}else for(;D<j;)if(V[O++]=C[D++],O==this.blockSize){l(this,V),O=0;break}}this.h=O,this.o+=j},i.prototype.A=function(){var C=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);C[0]=128;for(var j=1;j<C.length-8;++j)C[j]=0;j=this.o*8;for(var R=C.length-8;R<C.length;++R)C[R]=j&255,j/=256;for(this.v(C),C=Array(16),j=0,R=0;R<4;++R)for(let V=0;V<32;V+=8)C[j++]=this.g[R]>>>V&255;return C};function u(C,j){var R=p;return Object.prototype.hasOwnProperty.call(R,C)?R[C]:R[C]=j(C)}function d(C,j){this.h=j;const R=[];let V=!0;for(let O=C.length-1;O>=0;O--){const D=C[O]|0;V&&D==j||(R[O]=D,V=!1)}this.g=R}var p={};function g(C){return-128<=C&&C<128?u(C,function(j){return new d([j|0],j<0?-1:0)}):new d([C|0],C<0?-1:0)}function y(C){if(isNaN(C)||!isFinite(C))return E;if(C<0)return B(y(-C));const j=[];let R=1;for(let V=0;C>=R;V++)j[V]=C/R|0,R*=4294967296;return new d(j,0)}function b(C,j){if(C.length==0)throw Error("number format error: empty string");if(j=j||10,j<2||36<j)throw Error("radix out of range: "+j);if(C.charAt(0)=="-")return B(b(C.substring(1),j));if(C.indexOf("-")>=0)throw Error('number format error: interior "-" character');const R=y(Math.pow(j,8));let V=E;for(let D=0;D<C.length;D+=8){var O=Math.min(8,C.length-D);const A=parseInt(C.substring(D,D+O),j);O<8?(O=y(Math.pow(j,O)),V=V.j(O).add(y(A))):(V=V.j(R),V=V.add(y(A)))}return V}var E=g(0),T=g(1),L=g(16777216);s=d.prototype,s.m=function(){if(H(this))return-B(this).m();let C=0,j=1;for(let R=0;R<this.g.length;R++){const V=this.i(R);C+=(V>=0?V:4294967296+V)*j,j*=4294967296}return C},s.toString=function(C){if(C=C||10,C<2||36<C)throw Error("radix out of range: "+C);if(W(this))return"0";if(H(this))return"-"+B(this).toString(C);const j=y(Math.pow(C,6));var R=this;let V="";for(;;){const O=he(R,j).g;R=K(R,O.j(j));let D=((R.g.length>0?R.g[0]:R.h)>>>0).toString(C);if(R=O,W(R))return D+V;for(;D.length<6;)D="0"+D;V=D+V}},s.i=function(C){return C<0?0:C<this.g.length?this.g[C]:this.h};function W(C){if(C.h!=0)return!1;for(let j=0;j<C.g.length;j++)if(C.g[j]!=0)return!1;return!0}function H(C){return C.h==-1}s.l=function(C){return C=K(this,C),H(C)?-1:W(C)?0:1};function B(C){const j=C.g.length,R=[];for(let V=0;V<j;V++)R[V]=~C.g[V];return new d(R,~C.h).add(T)}s.abs=function(){return H(this)?B(this):this},s.add=function(C){const j=Math.max(this.g.length,C.g.length),R=[];let V=0;for(let O=0;O<=j;O++){let D=V+(this.i(O)&65535)+(C.i(O)&65535),A=(D>>>16)+(this.i(O)>>>16)+(C.i(O)>>>16);V=A>>>16,D&=65535,A&=65535,R[O]=A<<16|D}return new d(R,R[R.length-1]&-2147483648?-1:0)};function K(C,j){return C.add(B(j))}s.j=function(C){if(W(this)||W(C))return E;if(H(this))return H(C)?B(this).j(B(C)):B(B(this).j(C));if(H(C))return B(this.j(B(C)));if(this.l(L)<0&&C.l(L)<0)return y(this.m()*C.m());const j=this.g.length+C.g.length,R=[];for(var V=0;V<2*j;V++)R[V]=0;for(V=0;V<this.g.length;V++)for(let O=0;O<C.g.length;O++){const D=this.i(V)>>>16,A=this.i(V)&65535,Le=C.i(O)>>>16,Je=C.i(O)&65535;R[2*V+2*O]+=A*Je,G(R,2*V+2*O),R[2*V+2*O+1]+=D*Je,G(R,2*V+2*O+1),R[2*V+2*O+1]+=A*Le,G(R,2*V+2*O+1),R[2*V+2*O+2]+=D*Le,G(R,2*V+2*O+2)}for(C=0;C<j;C++)R[C]=R[2*C+1]<<16|R[2*C];for(C=j;C<2*j;C++)R[C]=0;return new d(R,0)};function G(C,j){for(;(C[j]&65535)!=C[j];)C[j+1]+=C[j]>>>16,C[j]&=65535,j++}function Q(C,j){this.g=C,this.h=j}function he(C,j){if(W(j))throw Error("division by zero");if(W(C))return new Q(E,E);if(H(C))return j=he(B(C),j),new Q(B(j.g),B(j.h));if(H(j))return j=he(C,B(j)),new Q(B(j.g),j.h);if(C.g.length>30){if(H(C)||H(j))throw Error("slowDivide_ only works with positive integers.");for(var R=T,V=j;V.l(C)<=0;)R=Ee(R),V=Ee(V);var O=ge(R,1),D=ge(V,1);for(V=ge(V,2),R=ge(R,2);!W(V);){var A=D.add(V);A.l(C)<=0&&(O=O.add(R),D=A),V=ge(V,1),R=ge(R,1)}return j=K(C,O.j(j)),new Q(O,j)}for(O=E;C.l(j)>=0;){for(R=Math.max(1,Math.floor(C.m()/j.m())),V=Math.ceil(Math.log(R)/Math.LN2),V=V<=48?1:Math.pow(2,V-48),D=y(R),A=D.j(j);H(A)||A.l(C)>0;)R-=V,D=y(R),A=D.j(j);W(D)&&(D=T),O=O.add(D),C=K(C,A)}return new Q(O,C)}s.B=function(C){return he(this,C).h},s.and=function(C){const j=Math.max(this.g.length,C.g.length),R=[];for(let V=0;V<j;V++)R[V]=this.i(V)&C.i(V);return new d(R,this.h&C.h)},s.or=function(C){const j=Math.max(this.g.length,C.g.length),R=[];for(let V=0;V<j;V++)R[V]=this.i(V)|C.i(V);return new d(R,this.h|C.h)},s.xor=function(C){const j=Math.max(this.g.length,C.g.length),R=[];for(let V=0;V<j;V++)R[V]=this.i(V)^C.i(V);return new d(R,this.h^C.h)};function Ee(C){const j=C.g.length+1,R=[];for(let V=0;V<j;V++)R[V]=C.i(V)<<1|C.i(V-1)>>>31;return new d(R,C.h)}function ge(C,j){const R=j>>5;j%=32;const V=C.g.length-R,O=[];for(let D=0;D<V;D++)O[D]=j>0?C.i(D+R)>>>j|C.i(D+R+1)<<32-j:C.i(D+R);return new d(O,C.h)}i.prototype.digest=i.prototype.A,i.prototype.reset=i.prototype.u,i.prototype.update=i.prototype.v,C_=i,d.prototype.add=d.prototype.add,d.prototype.multiply=d.prototype.j,d.prototype.modulo=d.prototype.B,d.prototype.compare=d.prototype.l,d.prototype.toNumber=d.prototype.m,d.prototype.toString=d.prototype.toString,d.prototype.getBits=d.prototype.i,d.fromNumber=y,d.fromString=b,Qa=d}).apply(typeof O2<"u"?O2:typeof self<"u"?self:typeof window<"u"?window:{});var ah=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var N_,tu,A_,Th,Sg,R_,I_,M_;(function(){var s,e=Object.defineProperty;function t(h){h=[typeof globalThis=="object"&&globalThis,h,typeof window=="object"&&window,typeof self=="object"&&self,typeof ah=="object"&&ah];for(var v=0;v<h.length;++v){var _=h[v];if(_&&_.Math==Math)return _}throw Error("Cannot find global object")}var i=t(this);function l(h,v){if(v)e:{var _=i;h=h.split(".");for(var N=0;N<h.length-1;N++){var Z=h[N];if(!(Z in _))break e;_=_[Z]}h=h[h.length-1],N=_[h],v=v(N),v!=N&&v!=null&&e(_,h,{configurable:!0,writable:!0,value:v})}}l("Symbol.dispose",function(h){return h||Symbol("Symbol.dispose")}),l("Array.prototype.values",function(h){return h||function(){return this[Symbol.iterator]()}}),l("Object.entries",function(h){return h||function(v){var _=[],N;for(N in v)Object.prototype.hasOwnProperty.call(v,N)&&_.push([N,v[N]]);return _}});var u=u||{},d=this||self;function p(h){var v=typeof h;return v=="object"&&h!=null||v=="function"}function g(h,v,_){return h.call.apply(h.bind,arguments)}function y(h,v,_){return y=g,y.apply(null,arguments)}function b(h,v){var _=Array.prototype.slice.call(arguments,1);return function(){var N=_.slice();return N.push.apply(N,arguments),h.apply(this,N)}}function E(h,v){function _(){}_.prototype=v.prototype,h.Z=v.prototype,h.prototype=new _,h.prototype.constructor=h,h.Ob=function(N,Z,ue){for(var Ve=Array(arguments.length-2),jt=2;jt<arguments.length;jt++)Ve[jt-2]=arguments[jt];return v.prototype[Z].apply(N,Ve)}}var T=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?h=>h&&AsyncContext.Snapshot.wrap(h):h=>h;function L(h){const v=h.length;if(v>0){const _=Array(v);for(let N=0;N<v;N++)_[N]=h[N];return _}return[]}function W(h,v){for(let N=1;N<arguments.length;N++){const Z=arguments[N];var _=typeof Z;if(_=_!="object"?_:Z?Array.isArray(Z)?"array":_:"null",_=="array"||_=="object"&&typeof Z.length=="number"){_=h.length||0;const ue=Z.length||0;h.length=_+ue;for(let Ve=0;Ve<ue;Ve++)h[_+Ve]=Z[Ve]}else h.push(Z)}}class H{constructor(v,_){this.i=v,this.j=_,this.h=0,this.g=null}get(){let v;return this.h>0?(this.h--,v=this.g,this.g=v.next,v.next=null):v=this.i(),v}}function B(h){d.setTimeout(()=>{throw h},0)}function K(){var h=C;let v=null;return h.g&&(v=h.g,h.g=h.g.next,h.g||(h.h=null),v.next=null),v}class G{constructor(){this.h=this.g=null}add(v,_){const N=Q.get();N.set(v,_),this.h?this.h.next=N:this.g=N,this.h=N}}var Q=new H(()=>new he,h=>h.reset());class he{constructor(){this.next=this.g=this.h=null}set(v,_){this.h=v,this.g=_,this.next=null}reset(){this.next=this.g=this.h=null}}let Ee,ge=!1,C=new G,j=()=>{const h=Promise.resolve(void 0);Ee=()=>{h.then(R)}};function R(){for(var h;h=K();){try{h.h.call(h.g)}catch(_){B(_)}var v=Q;v.j(h),v.h<100&&(v.h++,h.next=v.g,v.g=h)}ge=!1}function V(){this.u=this.u,this.C=this.C}V.prototype.u=!1,V.prototype.dispose=function(){this.u||(this.u=!0,this.N())},V.prototype[Symbol.dispose]=function(){this.dispose()},V.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function O(h,v){this.type=h,this.g=this.target=v,this.defaultPrevented=!1}O.prototype.h=function(){this.defaultPrevented=!0};var D=(function(){if(!d.addEventListener||!Object.defineProperty)return!1;var h=!1,v=Object.defineProperty({},"passive",{get:function(){h=!0}});try{const _=()=>{};d.addEventListener("test",_,v),d.removeEventListener("test",_,v)}catch{}return h})();function A(h){return/^[\s\xa0]*$/.test(h)}function Le(h,v){O.call(this,h?h.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,h&&this.init(h,v)}E(Le,O),Le.prototype.init=function(h,v){const _=this.type=h.type,N=h.changedTouches&&h.changedTouches.length?h.changedTouches[0]:null;this.target=h.target||h.srcElement,this.g=v,v=h.relatedTarget,v||(_=="mouseover"?v=h.fromElement:_=="mouseout"&&(v=h.toElement)),this.relatedTarget=v,N?(this.clientX=N.clientX!==void 0?N.clientX:N.pageX,this.clientY=N.clientY!==void 0?N.clientY:N.pageY,this.screenX=N.screenX||0,this.screenY=N.screenY||0):(this.clientX=h.clientX!==void 0?h.clientX:h.pageX,this.clientY=h.clientY!==void 0?h.clientY:h.pageY,this.screenX=h.screenX||0,this.screenY=h.screenY||0),this.button=h.button,this.key=h.key||"",this.ctrlKey=h.ctrlKey,this.altKey=h.altKey,this.shiftKey=h.shiftKey,this.metaKey=h.metaKey,this.pointerId=h.pointerId||0,this.pointerType=h.pointerType,this.state=h.state,this.i=h,h.defaultPrevented&&Le.Z.h.call(this)},Le.prototype.h=function(){Le.Z.h.call(this);const h=this.i;h.preventDefault?h.preventDefault():h.returnValue=!1};var Je="closure_listenable_"+(Math.random()*1e6|0),X=0;function je(h,v,_,N,Z){this.listener=h,this.proxy=null,this.src=v,this.type=_,this.capture=!!N,this.ha=Z,this.key=++X,this.da=this.fa=!1}function De(h){h.da=!0,h.listener=null,h.proxy=null,h.src=null,h.ha=null}function Ce(h,v,_){for(const N in h)v.call(_,h[N],N,h)}function J(h,v){for(const _ in h)v.call(void 0,h[_],_,h)}function P(h){const v={};for(const _ in h)v[_]=h[_];return v}const re="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function we(h,v){let _,N;for(let Z=1;Z<arguments.length;Z++){N=arguments[Z];for(_ in N)h[_]=N[_];for(let ue=0;ue<re.length;ue++)_=re[ue],Object.prototype.hasOwnProperty.call(N,_)&&(h[_]=N[_])}}function _e(h){this.src=h,this.g={},this.h=0}_e.prototype.add=function(h,v,_,N,Z){const ue=h.toString();h=this.g[ue],h||(h=this.g[ue]=[],this.h++);const Ve=Se(h,v,N,Z);return Ve>-1?(v=h[Ve],_||(v.fa=!1)):(v=new je(v,this.src,ue,!!N,Z),v.fa=_,h.push(v)),v};function xe(h,v){const _=v.type;if(_ in h.g){var N=h.g[_],Z=Array.prototype.indexOf.call(N,v,void 0),ue;(ue=Z>=0)&&Array.prototype.splice.call(N,Z,1),ue&&(De(v),h.g[_].length==0&&(delete h.g[_],h.h--))}}function Se(h,v,_,N){for(let Z=0;Z<h.length;++Z){const ue=h[Z];if(!ue.da&&ue.listener==v&&ue.capture==!!_&&ue.ha==N)return Z}return-1}var Fe="closure_lm_"+(Math.random()*1e6|0),Ze={};function Oe(h,v,_,N,Z){if(Array.isArray(v)){for(let ue=0;ue<v.length;ue++)Oe(h,v[ue],_,N,Z);return null}return _=fe(_),h&&h[Je]?h.J(v,_,p(N)?!!N.capture:!1,Z):Mt(h,v,_,!1,N,Z)}function Mt(h,v,_,N,Z,ue){if(!v)throw Error("Invalid event type");const Ve=p(Z)?!!Z.capture:!!Z;let jt=ct(h);if(jt||(h[Fe]=jt=new _e(h)),_=jt.add(v,_,N,Ve,ue),_.proxy)return _;if(N=cn(),_.proxy=N,N.src=h,N.listener=_,h.addEventListener)D||(Z=Ve),Z===void 0&&(Z=!1),h.addEventListener(v.toString(),N,Z);else if(h.attachEvent)h.attachEvent(rt(v.toString()),N);else if(h.addListener&&h.removeListener)h.addListener(N);else throw Error("addEventListener and attachEvent are unavailable.");return _}function cn(){function h(_){return v.call(h.src,h.listener,_)}const v=st;return h}function qn(h,v,_,N,Z){if(Array.isArray(v))for(var ue=0;ue<v.length;ue++)qn(h,v[ue],_,N,Z);else N=p(N)?!!N.capture:!!N,_=fe(_),h&&h[Je]?(h=h.i,ue=String(v).toString(),ue in h.g&&(v=h.g[ue],_=Se(v,_,N,Z),_>-1&&(De(v[_]),Array.prototype.splice.call(v,_,1),v.length==0&&(delete h.g[ue],h.h--)))):h&&(h=ct(h))&&(v=h.g[v.toString()],h=-1,v&&(h=Se(v,_,N,Z)),(_=h>-1?v[h]:null)&&Qt(_))}function Qt(h){if(typeof h!="number"&&h&&!h.da){var v=h.src;if(v&&v[Je])xe(v.i,h);else{var _=h.type,N=h.proxy;v.removeEventListener?v.removeEventListener(_,N,h.capture):v.detachEvent?v.detachEvent(rt(_),N):v.addListener&&v.removeListener&&v.removeListener(N),(_=ct(v))?(xe(_,h),_.h==0&&(_.src=null,v[Fe]=null)):De(h)}}}function rt(h){return h in Ze?Ze[h]:Ze[h]="on"+h}function st(h,v){if(h.da)h=!0;else{v=new Le(v,this);const _=h.listener,N=h.ha||h.src;h.fa&&Qt(h),h=_.call(N,v)}return h}function ct(h){return h=h[Fe],h instanceof _e?h:null}var En="__closure_events_fn_"+(Math.random()*1e9>>>0);function fe(h){return typeof h=="function"?h:(h[En]||(h[En]=function(v){return h.handleEvent(v)}),h[En])}function Ct(){V.call(this),this.i=new _e(this),this.M=this,this.G=null}E(Ct,V),Ct.prototype[Je]=!0,Ct.prototype.removeEventListener=function(h,v,_,N){qn(this,h,v,_,N)};function ft(h,v){var _,N=h.G;if(N)for(_=[];N;N=N.G)_.push(N);if(h=h.M,N=v.type||v,typeof v=="string")v=new O(v,h);else if(v instanceof O)v.target=v.target||h;else{var Z=v;v=new O(N,h),we(v,Z)}Z=!0;let ue,Ve;if(_)for(Ve=_.length-1;Ve>=0;Ve--)ue=v.g=_[Ve],Z=Rt(ue,N,!0,v)&&Z;if(ue=v.g=h,Z=Rt(ue,N,!0,v)&&Z,Z=Rt(ue,N,!1,v)&&Z,_)for(Ve=0;Ve<_.length;Ve++)ue=v.g=_[Ve],Z=Rt(ue,N,!1,v)&&Z}Ct.prototype.N=function(){if(Ct.Z.N.call(this),this.i){var h=this.i;for(const v in h.g){const _=h.g[v];for(let N=0;N<_.length;N++)De(_[N]);delete h.g[v],h.h--}}this.G=null},Ct.prototype.J=function(h,v,_,N){return this.i.add(String(h),v,!1,_,N)},Ct.prototype.K=function(h,v,_,N){return this.i.add(String(h),v,!0,_,N)};function Rt(h,v,_,N){if(v=h.i.g[String(v)],!v)return!0;v=v.concat();let Z=!0;for(let ue=0;ue<v.length;++ue){const Ve=v[ue];if(Ve&&!Ve.da&&Ve.capture==_){const jt=Ve.listener,rs=Ve.ha||Ve.src;Ve.fa&&xe(h.i,Ve),Z=jt.call(rs,N)!==!1&&Z}}return Z&&!N.defaultPrevented}function Qe(h,v){if(typeof h!="function")if(h&&typeof h.handleEvent=="function")h=y(h.handleEvent,h);else throw Error("Invalid listener argument");return Number(v)>2147483647?-1:d.setTimeout(h,v||0)}function Tt(h){h.g=Qe(()=>{h.g=null,h.i&&(h.i=!1,Tt(h))},h.l);const v=h.h;h.h=null,h.m.apply(null,v)}class pt extends V{constructor(v,_){super(),this.m=v,this.l=_,this.h=null,this.i=!1,this.g=null}j(v){this.h=arguments,this.g?this.i=!0:Tt(this)}N(){super.N(),this.g&&(d.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Xt(h){V.call(this),this.h=h,this.g={}}E(Xt,V);var zs=[];function es(h){Ce(h.g,function(v,_){this.g.hasOwnProperty(_)&&Qt(v)},h),h.g={}}Xt.prototype.N=function(){Xt.Z.N.call(this),es(this)},Xt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Wt=d.JSON.stringify,se=d.JSON.parse,Ae=class{stringify(h){return d.JSON.stringify(h,void 0)}parse(h){return d.JSON.parse(h,void 0)}};function gt(){}function vt(){}var ut={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function He(){O.call(this,"d")}E(He,O);function nt(){O.call(this,"c")}E(nt,O);var $e={},rn=null;function Jt(){return rn=rn||new Ct}$e.Ia="serverreachability";function Rn(h){O.call(this,$e.Ia,h)}E(Rn,O);function On(h){const v=Jt();ft(v,new Rn(v))}$e.STAT_EVENT="statevent";function Kn(h,v){O.call(this,$e.STAT_EVENT,h),this.stat=v}E(Kn,O);function Zt(h){const v=Jt();ft(v,new Kn(v,h))}$e.Ja="timingevent";function Hn(h,v){O.call(this,$e.Ja,h),this.size=v}E(Hn,O);function Cn(h,v){if(typeof h!="function")throw Error("Fn must not be null and must be a function");return d.setTimeout(function(){h()},v)}function yn(){this.g=!0}yn.prototype.ua=function(){this.g=!1};function Ss(h,v,_,N,Z,ue){h.info(function(){if(h.g)if(ue){var Ve="",jt=ue.split("&");for(let on=0;on<jt.length;on++){var rs=jt[on].split("=");if(rs.length>1){const Bn=rs[0];rs=rs[1];const Lr=Bn.split("_");Ve=Lr.length>=2&&Lr[1]=="type"?Ve+(Bn+"="+rs+"&"):Ve+(Bn+"=redacted&")}}}else Ve=null;else Ve=ue;return"XMLHTTP REQ ("+N+") [attempt "+Z+"]: "+v+`
`+_+`
`+Ve})}function le(h,v,_,N,Z,ue,Ve){h.info(function(){return"XMLHTTP RESP ("+N+") [ attempt "+Z+"]: "+v+`
`+_+`
`+ue+" "+Ve})}function Me(h,v,_,N){h.info(function(){return"XMLHTTP TEXT ("+v+"): "+yt(h,_)+(N?" "+N:"")})}function Ye(h,v){h.info(function(){return"TIMEOUT: "+v})}yn.prototype.info=function(){};function yt(h,v){if(!h.g)return v;if(!v)return null;try{const ue=JSON.parse(v);if(ue){for(h=0;h<ue.length;h++)if(Array.isArray(ue[h])){var _=ue[h];if(!(_.length<2)){var N=_[1];if(Array.isArray(N)&&!(N.length<1)){var Z=N[0];if(Z!="noop"&&Z!="stop"&&Z!="close")for(let Ve=1;Ve<N.length;Ve++)N[Ve]=""}}}}return Wt(ue)}catch{return v}}var it={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Gt={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},vn;function an(){}E(an,gt),an.prototype.g=function(){return new XMLHttpRequest},vn=new an;function Kt(h){return encodeURIComponent(String(h))}function vs(h){var v=1;h=h.split(":");const _=[];for(;v>0&&h.length;)_.push(h.shift()),v--;return h.length&&_.push(h.join(":")),_}function Nn(h,v,_,N){this.j=h,this.i=v,this.l=_,this.S=N||1,this.V=new Xt(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new bs}function bs(){this.i=null,this.g="",this.h=!1}var en={},un={};function cs(h,v,_){h.M=1,h.A=Mn(Pe(v)),h.u=_,h.R=!0,Qr(h,null)}function Qr(h,v){h.F=Date.now(),$n(h),h.B=Pe(h.A);var _=h.B,N=h.S;Array.isArray(N)||(N=[String(N)]),Ms(_.i,"t",N),h.C=0,_=h.j.L,h.h=new bs,h.g=Xu(h.j,_?v:null,!h.u),h.P>0&&(h.O=new pt(y(h.Y,h,h.g),h.P)),v=h.V,_=h.g,N=h.ba;var Z="readystatechange";Array.isArray(Z)||(Z&&(zs[0]=Z.toString()),Z=zs);for(let ue=0;ue<Z.length;ue++){const Ve=Oe(_,Z[ue],N||v.handleEvent,!1,v.h||v);if(!Ve)break;v.g[Ve.key]=Ve}v=h.J?P(h.J):{},h.u?(h.v||(h.v="POST"),v["Content-Type"]="application/x-www-form-urlencoded",h.g.ea(h.B,h.v,h.u,v)):(h.v="GET",h.g.ea(h.B,h.v,null,v)),On(),Ss(h.i,h.v,h.B,h.l,h.S,h.u)}Nn.prototype.ba=function(h){h=h.target;const v=this.O;v&&It(h)==3?v.j():this.Y(h)},Nn.prototype.Y=function(h){try{if(h==this.g)e:{const jt=It(this.g),rs=this.g.ya(),on=this.g.ca();if(!(jt<3)&&(jt!=3||this.g&&(this.h.h||this.g.la()||dn(this.g)))){this.K||jt!=4||rs==7||(rs==8||on<=0?On(3):On(2)),ws(this);var v=this.g.ca();this.X=v;var _=fa(this);if(this.o=v==200,le(this.i,this.v,this.B,this.l,this.S,jt,v),this.o){if(this.U&&!this.L){t:{if(this.g){var N,Z=this.g;if((N=Z.g?Z.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!A(N)){var ue=N;break t}}ue=null}if(h=ue)Me(this.i,this.l,h,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,ts(this,h);else{this.o=!1,this.m=3,Zt(12),In(this),Pn(this);break e}}if(this.R){h=!0;let Bn;for(;!this.K&&this.C<_.length;)if(Bn=gr(this,_),Bn==un){jt==4&&(this.m=4,Zt(14),h=!1),Me(this.i,this.l,null,"[Incomplete Response]");break}else if(Bn==en){this.m=4,Zt(15),Me(this.i,this.l,_,"[Invalid Chunk]"),h=!1;break}else Me(this.i,this.l,Bn,null),ts(this,Bn);if(Xr(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),jt!=4||_.length!=0||this.h.h||(this.m=1,Zt(16),h=!1),this.o=this.o&&h,!h)Me(this.i,this.l,_,"[Invalid Chunked Response]"),In(this),Pn(this);else if(_.length>0&&!this.W){this.W=!0;var Ve=this.j;Ve.g==this&&Ve.aa&&!Ve.P&&(Ve.j.info("Great, no buffering proxy detected. Bytes received: "+_.length),oc(Ve),Ve.P=!0,Zt(11))}}else Me(this.i,this.l,_,null),ts(this,_);jt==4&&In(this),this.o&&!this.K&&(jt==4?Gu(this.j,this):(this.o=!1,$n(this)))}else _s(this.g),v==400&&_.indexOf("Unknown SID")>0?(this.m=3,Zt(12)):(this.m=0,Zt(13)),In(this),Pn(this)}}}catch{}};function fa(h){if(!Xr(h))return h.g.la();const v=dn(h.g);if(v==="")return"";let _="";const N=v.length,Z=It(h.g)==4;if(!h.h.i){if(typeof TextDecoder>"u")return In(h),Pn(h),"";h.h.i=new d.TextDecoder}for(let ue=0;ue<N;ue++)h.h.h=!0,_+=h.h.i.decode(v[ue],{stream:!(Z&&ue==N-1)});return v.length=0,h.h.g+=_,h.C=0,h.h.g}function Xr(h){return h.g?h.v=="GET"&&h.M!=2&&h.j.Aa:!1}function gr(h,v){var _=h.C,N=v.indexOf(`
`,_);return N==-1?un:(_=Number(v.substring(_,N)),isNaN(_)?en:(N+=1,N+_>v.length?un:(v=v.slice(N,N+_),h.C=N+_,v)))}Nn.prototype.cancel=function(){this.K=!0,In(this)};function $n(h){h.T=Date.now()+h.H,Fs(h,h.H)}function Fs(h,v){if(h.D!=null)throw Error("WatchDog timer not null");h.D=Cn(y(h.aa,h),v)}function ws(h){h.D&&(d.clearTimeout(h.D),h.D=null)}Nn.prototype.aa=function(){this.D=null;const h=Date.now();h-this.T>=0?(Ye(this.i,this.B),this.M!=2&&(On(),Zt(17)),In(this),this.m=2,Pn(this)):Fs(this,this.T-h)};function Pn(h){h.j.I==0||h.K||Gu(h.j,h)}function In(h){ws(h);var v=h.O;v&&typeof v.dispose=="function"&&v.dispose(),h.O=null,es(h.V),h.g&&(v=h.g,h.g=null,v.abort(),v.dispose())}function ts(h,v){try{var _=h.j;if(_.I!=0&&(_.g==h||Tn(_.h,h))){if(!h.L&&Tn(_.h,h)&&_.I==3){try{var N=_.Ba.g.parse(v)}catch{N=null}if(Array.isArray(N)&&N.length==3){var Z=N;if(Z[0]==0){e:if(!_.v){if(_.g)if(_.g.F+3e3<h.F)Zo(_),us(_);else break e;uo(_),Zt(18)}}else _.xa=Z[1],0<_.xa-_.K&&Z[2]<37500&&_.F&&_.A==0&&!_.C&&(_.C=Cn(y(_.Va,_),6e3));xs(_.h)<=1&&_.ta&&(_.ta=void 0)}else gi(_,11)}else if((h.L||_.g==h)&&Zo(_),!A(v))for(Z=_.Ba.g.parse(v),v=0;v<Z.length;v++){let on=Z[v];const Bn=on[0];if(!(Bn<=_.K))if(_.K=Bn,on=on[1],_.I==2)if(on[0]=="c"){_.M=on[1],_.ba=on[2];const Lr=on[3];Lr!=null&&(_.ka=Lr,_.j.info("VER="+_.ka));const yi=on[4];yi!=null&&(_.za=yi,_.j.info("SVER="+_.za));const ti=on[5];ti!=null&&typeof ti=="number"&&ti>0&&(N=1.5*ti,_.O=N,_.j.info("backChannelRequestTimeoutMs_="+N)),N=_;const ni=h.g;if(ni){const ho=ni.g?ni.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(ho){var ue=N.h;ue.g||ho.indexOf("spdy")==-1&&ho.indexOf("quic")==-1&&ho.indexOf("h2")==-1||(ue.j=ue.l,ue.g=new Set,ue.h&&(Qs(ue,ue.h),ue.h=null))}if(N.G){const el=ni.g?ni.g.getResponseHeader("X-HTTP-Session-Id"):null;el&&(N.wa=el,Ge(N.J,N.G,el))}}_.I=3,_.l&&_.l.ra(),_.aa&&(_.T=Date.now()-h.F,_.j.info("Handshake RTT: "+_.T+"ms")),N=_;var Ve=h;if(N.na=Qu(N,N.L?N.ba:null,N.W),Ve.L){Jr(N.h,Ve);var jt=Ve,rs=N.O;rs&&(jt.H=rs),jt.D&&(ws(jt),$n(jt)),N.g=Ve}else $u(N);_.i.length>0&&Dr(_)}else on[0]!="stop"&&on[0]!="close"||gi(_,7);else _.I==3&&(on[0]=="stop"||on[0]=="close"?on[0]=="stop"?gi(_,7):Wn(_):on[0]!="noop"&&_.l&&_.l.qa(on),_.A=0)}}On(4)}catch{}}var Ft=class{constructor(h,v){this.g=h,this.map=v}};function yr(h){this.l=h||10,d.PerformanceNavigationTiming?(h=d.performance.getEntriesByType("navigation"),h=h.length>0&&(h[0].nextHopProtocol=="hq"||h[0].nextHopProtocol=="h2")):h=!!(d.chrome&&d.chrome.loadTimes&&d.chrome.loadTimes()&&d.chrome.loadTimes().wasFetchedViaSpdy),this.j=h?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Rr(h){return h.h?!0:h.g?h.g.size>=h.j:!1}function xs(h){return h.h?1:h.g?h.g.size:0}function Tn(h,v){return h.h?h.h==v:h.g?h.g.has(v):!1}function Qs(h,v){h.g?h.g.add(v):h.h=v}function Jr(h,v){h.h&&h.h==v?h.h=null:h.g&&h.g.has(v)&&h.g.delete(v)}yr.prototype.cancel=function(){if(this.i=I(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const h of this.g.values())h.cancel();this.g.clear()}};function I(h){if(h.h!=null)return h.i.concat(h.h.G);if(h.g!=null&&h.g.size!==0){let v=h.i;for(const _ of h.g.values())v=v.concat(_.G);return v}return L(h.i)}var z=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function ie(h,v){if(h){h=h.split("&");for(let _=0;_<h.length;_++){const N=h[_].indexOf("=");let Z,ue=null;N>=0?(Z=h[_].substring(0,N),ue=h[_].substring(N+1)):Z=h[_],v(Z,ue?decodeURIComponent(ue.replace(/\+/g," ")):"")}}}function ce(h){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let v;h instanceof ce?(this.l=h.l,Ue(this,h.j),this.o=h.o,this.g=h.g,qe(this,h.u),this.h=h.h,Ot(this,fi(h.i)),this.m=h.m):h&&(v=String(h).match(z))?(this.l=!1,Ue(this,v[1]||"",!0),this.o=ns(v[2]||""),this.g=ns(v[3]||"",!0),qe(this,v[4]),this.h=ns(v[5]||"",!0),Ot(this,v[6]||"",!0),this.m=ns(v[7]||"")):(this.l=!1,this.i=new vr(null,this.l))}ce.prototype.toString=function(){const h=[];var v=this.j;v&&h.push(ar(v,Xs,!0),":");var _=this.g;return(_||v=="file")&&(h.push("//"),(v=this.o)&&h.push(ar(v,Xs,!0),"@"),h.push(Kt(_).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),_=this.u,_!=null&&h.push(":",String(_))),(_=this.h)&&(this.g&&_.charAt(0)!="/"&&h.push("/"),h.push(ar(_,_.charAt(0)=="/"?Is:Di,!0))),(_=this.i.toString())&&h.push("?",_),(_=this.m)&&h.push("#",ar(_,ma)),h.join("")},ce.prototype.resolve=function(h){const v=Pe(this);let _=!!h.j;_?Ue(v,h.j):_=!!h.o,_?v.o=h.o:_=!!h.g,_?v.g=h.g:_=h.u!=null;var N=h.h;if(_)qe(v,h.u);else if(_=!!h.h){if(N.charAt(0)!="/")if(this.g&&!this.h)N="/"+N;else{var Z=v.h.lastIndexOf("/");Z!=-1&&(N=v.h.slice(0,Z+1)+N)}if(Z=N,Z==".."||Z==".")N="";else if(Z.indexOf("./")!=-1||Z.indexOf("/.")!=-1){N=Z.lastIndexOf("/",0)==0,Z=Z.split("/");const ue=[];for(let Ve=0;Ve<Z.length;){const jt=Z[Ve++];jt=="."?N&&Ve==Z.length&&ue.push(""):jt==".."?((ue.length>1||ue.length==1&&ue[0]!="")&&ue.pop(),N&&Ve==Z.length&&ue.push("")):(ue.push(jt),N=!0)}N=ue.join("/")}else N=Z}return _?v.h=N:_=h.i.toString()!=="",_?Ot(v,fi(h.i)):_=!!h.m,_&&(v.m=h.m),v};function Pe(h){return new ce(h)}function Ue(h,v,_){h.j=_?ns(v,!0):v,h.j&&(h.j=h.j.replace(/:$/,""))}function qe(h,v){if(v){if(v=Number(v),isNaN(v)||v<0)throw Error("Bad port number "+v);h.u=v}else h.u=null}function Ot(h,v,_){v instanceof vr?(h.i=v,mi(h.i,h.l)):(_||(v=ar(v,Js)),h.i=new vr(v,h.l))}function Ge(h,v,_){h.i.set(v,_)}function Mn(h){return Ge(h,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),h}function ns(h,v){return h?v?decodeURI(h.replace(/%25/g,"%2525")):decodeURIComponent(h):""}function ar(h,v,_){return typeof h=="string"?(h=encodeURI(h).replace(v,Vn),_&&(h=h.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),h):null}function Vn(h){return h=h.charCodeAt(0),"%"+(h>>4&15).toString(16)+(h&15).toString(16)}var Xs=/[#\/\?@]/g,Di=/[#\?:]/g,Is=/[#\?]/g,Js=/[#\?@]/g,ma=/#/g;function vr(h,v){this.h=this.g=null,this.i=h||null,this.j=!!v}function Cs(h){h.g||(h.g=new Map,h.h=0,h.i&&ie(h.i,function(v,_){h.add(decodeURIComponent(v.replace(/\+/g," ")),_)}))}s=vr.prototype,s.add=function(h,v){Cs(this),this.i=null,h=Mr(this,h);let _=this.g.get(h);return _||this.g.set(h,_=[]),_.push(v),this.h+=1,this};function pa(h,v){Cs(h),v=Mr(h,v),h.g.has(v)&&(h.i=null,h.h-=h.g.get(v).length,h.g.delete(v))}function Zr(h,v){return Cs(h),v=Mr(h,v),h.g.has(v)}s.forEach=function(h,v){Cs(this),this.g.forEach(function(_,N){_.forEach(function(Z){h.call(v,Z,N,this)},this)},this)};function Ir(h,v){Cs(h);let _=[];if(typeof v=="string")Zr(h,v)&&(_=_.concat(h.g.get(Mr(h,v))));else for(h=Array.from(h.g.values()),v=0;v<h.length;v++)_=_.concat(h[v]);return _}s.set=function(h,v){return Cs(this),this.i=null,h=Mr(this,h),Zr(this,h)&&(this.h-=this.g.get(h).length),this.g.set(h,[v]),this.h+=1,this},s.get=function(h,v){return h?(h=Ir(this,h),h.length>0?String(h[0]):v):v};function Ms(h,v,_){pa(h,v),_.length>0&&(h.i=null,h.g.set(Mr(h,v),L(_)),h.h+=_.length)}s.toString=function(){if(this.i)return this.i;if(!this.g)return"";const h=[],v=Array.from(this.g.keys());for(let N=0;N<v.length;N++){var _=v[N];const Z=Kt(_);_=Ir(this,_);for(let ue=0;ue<_.length;ue++){let Ve=Z;_[ue]!==""&&(Ve+="="+Kt(_[ue])),h.push(Ve)}}return this.i=h.join("&")};function fi(h){const v=new vr;return v.i=h.i,h.g&&(v.g=new Map(h.g),v.h=h.h),v}function Mr(h,v){return v=String(v),h.j&&(v=v.toLowerCase()),v}function mi(h,v){v&&!h.j&&(Cs(h),h.i=null,h.g.forEach(function(_,N){const Z=N.toLowerCase();N!=Z&&(pa(this,N),Ms(this,Z,_))},h)),h.j=v}function ss(h,v){const _=new yn;if(d.Image){const N=new Image;N.onload=b(oe,_,"TestLoadImage: loaded",!0,v,N),N.onerror=b(oe,_,"TestLoadImage: error",!1,v,N),N.onabort=b(oe,_,"TestLoadImage: abort",!1,v,N),N.ontimeout=b(oe,_,"TestLoadImage: timeout",!1,v,N),d.setTimeout(function(){N.ontimeout&&N.ontimeout()},1e4),N.src=h}else v(!1)}function F(h,v){const _=new yn,N=new AbortController,Z=setTimeout(()=>{N.abort(),oe(_,"TestPingServer: timeout",!1,v)},1e4);fetch(h,{signal:N.signal}).then(ue=>{clearTimeout(Z),ue.ok?oe(_,"TestPingServer: ok",!0,v):oe(_,"TestPingServer: server error",!1,v)}).catch(()=>{clearTimeout(Z),oe(_,"TestPingServer: error",!1,v)})}function oe(h,v,_,N,Z){try{Z&&(Z.onload=null,Z.onerror=null,Z.onabort=null,Z.ontimeout=null),N(_)}catch{}}function k(){this.g=new Ae}function M(h){this.i=h.Sb||null,this.h=h.ab||!1}E(M,gt),M.prototype.g=function(){return new q(this.i,this.h)};function q(h,v){Ct.call(this),this.H=h,this.o=v,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}E(q,Ct),s=q.prototype,s.open=function(h,v){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=h,this.D=v,this.readyState=1,Ie(this)},s.send=function(h){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const v={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};h&&(v.body=h),(this.H||d).fetch(new Request(this.D,v)).then(this.Pa.bind(this),this.ga.bind(this))},s.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,me(this)),this.readyState=0},s.Pa=function(h){if(this.g&&(this.l=h,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=h.headers,this.readyState=2,Ie(this)),this.g&&(this.readyState=3,Ie(this),this.g)))if(this.responseType==="arraybuffer")h.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof d.ReadableStream<"u"&&"body"in h){if(this.j=h.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;te(this)}else h.text().then(this.Oa.bind(this),this.ga.bind(this))};function te(h){h.j.read().then(h.Ma.bind(h)).catch(h.ga.bind(h))}s.Ma=function(h){if(this.g){if(this.o&&h.value)this.response.push(h.value);else if(!this.o){var v=h.value?h.value:new Uint8Array(0);(v=this.B.decode(v,{stream:!h.done}))&&(this.response=this.responseText+=v)}h.done?me(this):Ie(this),this.readyState==3&&te(this)}},s.Oa=function(h){this.g&&(this.response=this.responseText=h,me(this))},s.Na=function(h){this.g&&(this.response=h,me(this))},s.ga=function(){this.g&&me(this)};function me(h){h.readyState=4,h.l=null,h.j=null,h.B=null,Ie(h)}s.setRequestHeader=function(h,v){this.A.append(h,v)},s.getResponseHeader=function(h){return this.h&&this.h.get(h.toLowerCase())||""},s.getAllResponseHeaders=function(){if(!this.h)return"";const h=[],v=this.h.entries();for(var _=v.next();!_.done;)_=_.value,h.push(_[0]+": "+_[1]),_=v.next();return h.join(`\r
`)};function Ie(h){h.onreadystatechange&&h.onreadystatechange.call(h)}Object.defineProperty(q.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(h){this.m=h?"include":"same-origin"}});function Ne(h){let v="";return Ce(h,function(_,N){v+=N,v+=":",v+=_,v+=`\r
`}),v}function Be(h,v,_){e:{for(N in _){var N=!1;break e}N=!0}N||(_=Ne(_),typeof h=="string"?_!=null&&Kt(_):Ge(h,v,_))}function Re(h){Ct.call(this),this.headers=new Map,this.L=h||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}E(Re,Ct);var at=/^https?$/i,bn=["POST","PUT"];s=Re.prototype,s.Fa=function(h){this.H=h},s.ea=function(h,v,_,N){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+h);v=v?v.toUpperCase():"GET",this.D=h,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():vn.g(),this.g.onreadystatechange=T(y(this.Ca,this));try{this.B=!0,this.g.open(v,String(h),!0),this.B=!1}catch(ue){et(this,ue);return}if(h=_||"",_=new Map(this.headers),N)if(Object.getPrototypeOf(N)===Object.prototype)for(var Z in N)_.set(Z,N[Z]);else if(typeof N.keys=="function"&&typeof N.get=="function")for(const ue of N.keys())_.set(ue,N.get(ue));else throw Error("Unknown input type for opt_headers: "+String(N));N=Array.from(_.keys()).find(ue=>ue.toLowerCase()=="content-type"),Z=d.FormData&&h instanceof d.FormData,!(Array.prototype.indexOf.call(bn,v,void 0)>=0)||N||Z||_.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[ue,Ve]of _)this.g.setRequestHeader(ue,Ve);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(h),this.v=!1}catch(ue){et(this,ue)}};function et(h,v){h.h=!1,h.g&&(h.j=!0,h.g.abort(),h.j=!1),h.l=v,h.o=5,tn(h),dt(h)}function tn(h){h.A||(h.A=!0,ft(h,"complete"),ft(h,"error"))}s.abort=function(h){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=h||7,ft(this,"complete"),ft(this,"abort"),dt(this))},s.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),dt(this,!0)),Re.Z.N.call(this)},s.Ca=function(){this.u||(this.B||this.v||this.j?jn(this):this.Xa())},s.Xa=function(){jn(this)};function jn(h){if(h.h&&typeof u<"u"){if(h.v&&It(h)==4)setTimeout(h.Ca.bind(h),0);else if(ft(h,"readystatechange"),It(h)==4){h.h=!1;try{const ue=h.ca();e:switch(ue){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var v=!0;break e;default:v=!1}var _;if(!(_=v)){var N;if(N=ue===0){let Ve=String(h.D).match(z)[1]||null;!Ve&&d.self&&d.self.location&&(Ve=d.self.location.protocol.slice(0,-1)),N=!at.test(Ve?Ve.toLowerCase():"")}_=N}if(_)ft(h,"complete"),ft(h,"success");else{h.o=6;try{var Z=It(h)>2?h.g.statusText:""}catch{Z=""}h.l=Z+" ["+h.ca()+"]",tn(h)}}finally{dt(h)}}}}function dt(h,v){if(h.g){h.m&&(clearTimeout(h.m),h.m=null);const _=h.g;h.g=null,v||ft(h,"ready");try{_.onreadystatechange=null}catch{}}}s.isActive=function(){return!!this.g};function It(h){return h.g?h.g.readyState:0}s.ca=function(){try{return It(this)>2?this.g.status:-1}catch{return-1}},s.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},s.La=function(h){if(this.g){var v=this.g.responseText;return h&&v.indexOf(h)==0&&(v=v.substring(h.length)),se(v)}};function dn(h){try{if(!h.g)return null;if("response"in h.g)return h.g.response;switch(h.F){case"":case"text":return h.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in h.g)return h.g.mozResponseArrayBuffer}return null}catch{return null}}function _s(h){const v={};h=(h.g&&It(h)>=2&&h.g.getAllResponseHeaders()||"").split(`\r
`);for(let N=0;N<h.length;N++){if(A(h[N]))continue;var _=vs(h[N]);const Z=_[0];if(_=_[1],typeof _!="string")continue;_=_.trim();const ue=v[Z]||[];v[Z]=ue,ue.push(_)}J(v,function(N){return N.join(", ")})}s.ya=function(){return this.o},s.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Un(h,v,_){return _&&_.internalChannelParams&&_.internalChannelParams[h]||v}function mn(h){this.za=0,this.i=[],this.j=new yn,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Un("failFast",!1,h),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Un("baseRetryDelayMs",5e3,h),this.Za=Un("retryDelaySeedMs",1e4,h),this.Ta=Un("forwardChannelMaxRetries",2,h),this.va=Un("forwardChannelRequestTimeoutMs",2e4,h),this.ma=h&&h.xmlHttpFactory||void 0,this.Ua=h&&h.Rb||void 0,this.Aa=h&&h.useFetchStreams||!1,this.O=void 0,this.L=h&&h.supportsCrossDomainXhr||!1,this.M="",this.h=new yr(h&&h.concurrentRequestLimit),this.Ba=new k,this.S=h&&h.fastHandshake||!1,this.R=h&&h.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=h&&h.Pb||!1,h&&h.ua&&this.j.ua(),h&&h.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&h&&h.detectBufferingProxy||!1,this.ia=void 0,h&&h.longPollingTimeout&&h.longPollingTimeout>0&&(this.ia=h.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}s=mn.prototype,s.ka=8,s.I=1,s.connect=function(h,v,_,N){Zt(0),this.W=h,this.H=v||{},_&&N!==void 0&&(this.H.OSID=_,this.H.OAID=N),this.F=this.X,this.J=Qu(this,null,this.W),Dr(this)};function Wn(h){if(ei(h),h.I==3){var v=h.V++,_=Pe(h.J);if(Ge(_,"SID",h.M),Ge(_,"RID",v),Ge(_,"TYPE","terminate"),co(h,_),v=new Nn(h,h.j,v),v.M=2,v.A=Mn(Pe(_)),_=!1,d.navigator&&d.navigator.sendBeacon)try{_=d.navigator.sendBeacon(v.A.toString(),"")}catch{}!_&&d.Image&&(new Image().src=v.A,_=!0),_||(v.g=Xu(v.j,null),v.g.ea(v.A)),v.F=Date.now(),$n(v)}Yu(h)}function us(h){h.g&&(oc(h),h.g.cancel(),h.g=null)}function ei(h){us(h),h.v&&(d.clearTimeout(h.v),h.v=null),Zo(h),h.h.cancel(),h.m&&(typeof h.m=="number"&&d.clearTimeout(h.m),h.m=null)}function Dr(h){if(!Rr(h.h)&&!h.m){h.m=!0;var v=h.Ea;Ee||j(),ge||(Ee(),ge=!0),C.add(v,h),h.D=0}}function pi(h,v){return xs(h.h)>=h.h.j-(h.m?1:0)?!1:h.m?(h.i=v.G.concat(h.i),!0):h.I==1||h.I==2||h.D>=(h.Sa?0:h.Ta)?!1:(h.m=Cn(y(h.Ea,h,v),Ku(h,h.D)),h.D++,!0)}s.Ea=function(h){if(this.m)if(this.m=null,this.I==1){if(!h){this.V=Math.floor(Math.random()*1e5),h=this.V++;const Z=new Nn(this,this.j,h);let ue=this.o;if(this.U&&(ue?(ue=P(ue),we(ue,this.U)):ue=this.U),this.u!==null||this.R||(Z.J=ue,ue=null),this.S)e:{for(var v=0,_=0;_<this.i.length;_++){t:{var N=this.i[_];if("__data__"in N.map&&(N=N.map.__data__,typeof N=="string")){N=N.length;break t}N=void 0}if(N===void 0)break;if(v+=N,v>4096){v=_;break e}if(v===4096||_===this.i.length-1){v=_+1;break e}}v=1e3}else v=1e3;v=Hu(this,Z,v),_=Pe(this.J),Ge(_,"RID",h),Ge(_,"CVER",22),this.G&&Ge(_,"X-HTTP-Session-Id",this.G),co(this,_),ue&&(this.R?v="headers="+Kt(Ne(ue))+"&"+v:this.u&&Be(_,this.u,ue)),Qs(this.h,Z),this.Ra&&Ge(_,"TYPE","init"),this.S?(Ge(_,"$req",v),Ge(_,"SID","null"),Z.U=!0,cs(Z,_,null)):cs(Z,_,v),this.I=2}}else this.I==3&&(h?ac(this,h):this.i.length==0||Rr(this.h)||ac(this))};function ac(h,v){var _;v?_=v.l:_=h.V++;const N=Pe(h.J);Ge(N,"SID",h.M),Ge(N,"RID",_),Ge(N,"AID",h.K),co(h,N),h.u&&h.o&&Be(N,h.u,h.o),_=new Nn(h,h.j,_,h.D+1),h.u===null&&(_.J=h.o),v&&(h.i=v.G.concat(h.i)),v=Hu(h,_,1e3),_.H=Math.round(h.va*.5)+Math.round(h.va*.5*Math.random()),Qs(h.h,_),cs(_,N,v)}function co(h,v){h.H&&Ce(h.H,function(_,N){Ge(v,N,_)}),h.l&&Ce({},function(_,N){Ge(v,N,_)})}function Hu(h,v,_){_=Math.min(h.i.length,_);const N=h.l?y(h.l.Ka,h.l,h):null;e:{var Z=h.i;let jt=-1;for(;;){const rs=["count="+_];jt==-1?_>0?(jt=Z[0].g,rs.push("ofs="+jt)):jt=0:rs.push("ofs="+jt);let on=!0;for(let Bn=0;Bn<_;Bn++){var ue=Z[Bn].g;const Lr=Z[Bn].map;if(ue-=jt,ue<0)jt=Math.max(0,Z[Bn].g-100),on=!1;else try{ue="req"+ue+"_"||"";try{var Ve=Lr instanceof Map?Lr:Object.entries(Lr);for(const[yi,ti]of Ve){let ni=ti;p(ti)&&(ni=Wt(ti)),rs.push(ue+yi+"="+encodeURIComponent(ni))}}catch(yi){throw rs.push(ue+"type="+encodeURIComponent("_badmap")),yi}}catch{N&&N(Lr)}}if(on){Ve=rs.join("&");break e}}Ve=void 0}return h=h.i.splice(0,_),v.G=h,Ve}function $u(h){if(!h.g&&!h.v){h.Y=1;var v=h.Da;Ee||j(),ge||(Ee(),ge=!0),C.add(v,h),h.A=0}}function uo(h){return h.g||h.v||h.A>=3?!1:(h.Y++,h.v=Cn(y(h.Da,h),Ku(h,h.A)),h.A++,!0)}s.Da=function(){if(this.v=null,Wu(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var h=4*this.T;this.j.info("BP detection timer enabled: "+h),this.B=Cn(y(this.Wa,this),h)}},s.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Zt(10),us(this),Wu(this))};function oc(h){h.B!=null&&(d.clearTimeout(h.B),h.B=null)}function Wu(h){h.g=new Nn(h,h.j,"rpc",h.Y),h.u===null&&(h.g.J=h.o),h.g.P=0;var v=Pe(h.na);Ge(v,"RID","rpc"),Ge(v,"SID",h.M),Ge(v,"AID",h.K),Ge(v,"CI",h.F?"0":"1"),!h.F&&h.ia&&Ge(v,"TO",h.ia),Ge(v,"TYPE","xmlhttp"),co(h,v),h.u&&h.o&&Be(v,h.u,h.o),h.O&&(h.g.H=h.O);var _=h.g;h=h.ba,_.M=1,_.A=Mn(Pe(v)),_.u=null,_.R=!0,Qr(_,h)}s.Va=function(){this.C!=null&&(this.C=null,us(this),uo(this),Zt(19))};function Zo(h){h.C!=null&&(d.clearTimeout(h.C),h.C=null)}function Gu(h,v){var _=null;if(h.g==v){Zo(h),oc(h),h.g=null;var N=2}else if(Tn(h.h,v))_=v.G,Jr(h.h,v),N=1;else return;if(h.I!=0){if(v.o)if(N==1){_=v.u?v.u.length:0,v=Date.now()-v.F;var Z=h.D;N=Jt(),ft(N,new Hn(N,_)),Dr(h)}else $u(h);else if(Z=v.m,Z==3||Z==0&&v.X>0||!(N==1&&pi(h,v)||N==2&&uo(h)))switch(_&&_.length>0&&(v=h.h,v.i=v.i.concat(_)),Z){case 1:gi(h,5);break;case 4:gi(h,10);break;case 3:gi(h,6);break;default:gi(h,2)}}}function Ku(h,v){let _=h.Qa+Math.floor(Math.random()*h.Za);return h.isActive()||(_*=2),_*v}function gi(h,v){if(h.j.info("Error code "+v),v==2){var _=y(h.bb,h),N=h.Ua;const Z=!N;N=new ce(N||"//www.google.com/images/cleardot.gif"),d.location&&d.location.protocol=="http"||Ue(N,"https"),Mn(N),Z?ss(N.toString(),_):F(N.toString(),_)}else Zt(2);h.I=0,h.l&&h.l.pa(v),Yu(h),ei(h)}s.bb=function(h){h?(this.j.info("Successfully pinged google.com"),Zt(2)):(this.j.info("Failed to ping google.com"),Zt(1))};function Yu(h){if(h.I=0,h.ja=[],h.l){const v=I(h.h);(v.length!=0||h.i.length!=0)&&(W(h.ja,v),W(h.ja,h.i),h.h.i.length=0,L(h.i),h.i.length=0),h.l.oa()}}function Qu(h,v,_){var N=_ instanceof ce?Pe(_):new ce(_);if(N.g!="")v&&(N.g=v+"."+N.g),qe(N,N.u);else{var Z=d.location;N=Z.protocol,v=v?v+"."+Z.hostname:Z.hostname,Z=+Z.port;const ue=new ce(null);N&&Ue(ue,N),v&&(ue.g=v),Z&&qe(ue,Z),_&&(ue.h=_),N=ue}return _=h.G,v=h.wa,_&&v&&Ge(N,_,v),Ge(N,"VER",h.ka),co(h,N),N}function Xu(h,v,_){if(v&&!h.L)throw Error("Can't create secondary domain capable XhrIo object.");return v=h.Aa&&!h.ma?new Re(new M({ab:_})):new Re(h.ma),v.Fa(h.L),v}s.isActive=function(){return!!this.l&&this.l.isActive(this)};function Ju(){}s=Ju.prototype,s.ra=function(){},s.qa=function(){},s.pa=function(){},s.oa=function(){},s.isActive=function(){return!0},s.Ka=function(){};function ga(){}ga.prototype.g=function(h,v){return new Zs(h,v)};function Zs(h,v){Ct.call(this),this.g=new mn(v),this.l=h,this.h=v&&v.messageUrlParams||null,h=v&&v.messageHeaders||null,v&&v.clientProtocolHeaderRequired&&(h?h["X-Client-Protocol"]="webchannel":h={"X-Client-Protocol":"webchannel"}),this.g.o=h,h=v&&v.initMessageHeaders||null,v&&v.messageContentType&&(h?h["X-WebChannel-Content-Type"]=v.messageContentType:h={"X-WebChannel-Content-Type":v.messageContentType}),v&&v.sa&&(h?h["X-WebChannel-Client-Profile"]=v.sa:h={"X-WebChannel-Client-Profile":v.sa}),this.g.U=h,(h=v&&v.Qb)&&!A(h)&&(this.g.u=h),this.A=v&&v.supportsCrossDomainXhr||!1,this.v=v&&v.sendRawJson||!1,(v=v&&v.httpSessionIdParam)&&!A(v)&&(this.g.G=v,h=this.h,h!==null&&v in h&&(h=this.h,v in h&&delete h[v])),this.j=new Li(this)}E(Zs,Ct),Zs.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Zs.prototype.close=function(){Wn(this.g)},Zs.prototype.o=function(h){var v=this.g;if(typeof h=="string"){var _={};_.__data__=h,h=_}else this.v&&(_={},_.__data__=Wt(h),h=_);v.i.push(new Ft(v.Ya++,h)),v.I==3&&Dr(v)},Zs.prototype.N=function(){this.g.l=null,delete this.j,Wn(this.g),delete this.g,Zs.Z.N.call(this)};function Zu(h){He.call(this),h.__headers__&&(this.headers=h.__headers__,this.statusCode=h.__status__,delete h.__headers__,delete h.__status__);var v=h.__sm__;if(v){e:{for(const _ in v){h=_;break e}h=void 0}(this.i=h)&&(h=this.i,v=v!==null&&h in v?v[h]:void 0),this.data=v}else this.data=h}E(Zu,He);function ed(){nt.call(this),this.status=1}E(ed,nt);function Li(h){this.g=h}E(Li,Ju),Li.prototype.ra=function(){ft(this.g,"a")},Li.prototype.qa=function(h){ft(this.g,new Zu(h))},Li.prototype.pa=function(h){ft(this.g,new ed)},Li.prototype.oa=function(){ft(this.g,"b")},ga.prototype.createWebChannel=ga.prototype.g,Zs.prototype.send=Zs.prototype.o,Zs.prototype.open=Zs.prototype.m,Zs.prototype.close=Zs.prototype.close,M_=function(){return new ga},I_=function(){return Jt()},R_=$e,Sg={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},it.NO_ERROR=0,it.TIMEOUT=8,it.HTTP_ERROR=6,Th=it,Gt.COMPLETE="complete",A_=Gt,vt.EventType=ut,ut.OPEN="a",ut.CLOSE="b",ut.ERROR="c",ut.MESSAGE="d",Ct.prototype.listen=Ct.prototype.J,tu=vt,Re.prototype.listenOnce=Re.prototype.K,Re.prototype.getLastError=Re.prototype.Ha,Re.prototype.getLastErrorCode=Re.prototype.ya,Re.prototype.getStatus=Re.prototype.ca,Re.prototype.getResponseJson=Re.prototype.La,Re.prototype.getResponseText=Re.prototype.la,Re.prototype.send=Re.prototype.ea,Re.prototype.setWithCredentials=Re.prototype.Fa,N_=Re}).apply(typeof ah<"u"?ah:typeof self<"u"?self:typeof window<"u"?window:{});class $s{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}$s.UNAUTHENTICATED=new $s(null),$s.GOOGLE_CREDENTIALS=new $s("google-credentials-uid"),$s.FIRST_PARTY=new $s("first-party-uid"),$s.MOCK_USER=new $s("mock-user");let ec="12.8.0";function dR(s){ec=s}const Uo=new ay("@firebase/firestore");function Il(){return Uo.logLevel}function Ke(s,...e){if(Uo.logLevel<=Ut.DEBUG){const t=e.map(vy);Uo.debug(`Firestore (${ec}): ${s}`,...t)}}function la(s,...e){if(Uo.logLevel<=Ut.ERROR){const t=e.map(vy);Uo.error(`Firestore (${ec}): ${s}`,...t)}}function Fl(s,...e){if(Uo.logLevel<=Ut.WARN){const t=e.map(vy);Uo.warn(`Firestore (${ec}): ${s}`,...t)}}function vy(s){if(typeof s=="string")return s;try{return(function(t){return JSON.stringify(t)})(s)}catch{return s}}function wt(s,e,t){let i="Unexpected state";typeof e=="string"?i=e:t=e,D_(s,i,t)}function D_(s,e,t){let i=`FIRESTORE (${ec}) INTERNAL ASSERTION FAILED: ${e} (ID: ${s.toString(16)})`;if(t!==void 0)try{i+=" CONTEXT: "+JSON.stringify(t)}catch{i+=" CONTEXT: "+t}throw la(i),new Error(i)}function hn(s,e,t,i){let l="Unexpected state";typeof t=="string"?l=t:i=t,s||D_(e,l,i)}function Et(s,e){return s}const ve={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ze extends hi{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class sa{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class L_{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class hR{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t($s.UNAUTHENTICATED)))}shutdown(){}}class fR{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class mR{constructor(e){this.t=e,this.currentUser=$s.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){hn(this.o===void 0,42304);let i=this.i;const l=g=>this.i!==i?(i=this.i,t(g)):Promise.resolve();let u=new sa;this.o=()=>{this.i++,this.currentUser=this.u(),u.resolve(),u=new sa,e.enqueueRetryable((()=>l(this.currentUser)))};const d=()=>{const g=u;e.enqueueRetryable((async()=>{await g.promise,await l(this.currentUser)}))},p=g=>{Ke("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=g,this.o&&(this.auth.addAuthTokenListener(this.o),d())};this.t.onInit((g=>p(g))),setTimeout((()=>{if(!this.auth){const g=this.t.getImmediate({optional:!0});g?p(g):(Ke("FirebaseAuthCredentialsProvider","Auth not yet detected"),u.resolve(),u=new sa)}}),0),d()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((i=>this.i!==e?(Ke("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(hn(typeof i.accessToken=="string",31837,{l:i}),new L_(i.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return hn(e===null||typeof e=="string",2055,{h:e}),new $s(e)}}class pR{constructor(e,t,i){this.P=e,this.T=t,this.I=i,this.type="FirstParty",this.user=$s.FIRST_PARTY,this.R=new Map}A(){return this.I?this.I():null}get headers(){this.R.set("X-Goog-AuthUser",this.P);const e=this.A();return e&&this.R.set("Authorization",e),this.T&&this.R.set("X-Goog-Iam-Authorization-Token",this.T),this.R}}class gR{constructor(e,t,i){this.P=e,this.T=t,this.I=i}getToken(){return Promise.resolve(new pR(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t($s.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class P2{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class yR{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,jr(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){hn(this.o===void 0,3512);const i=u=>{u.error!=null&&Ke("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${u.error.message}`);const d=u.token!==this.m;return this.m=u.token,Ke("FirebaseAppCheckTokenProvider",`Received ${d?"new":"existing"} token.`),d?t(u.token):Promise.resolve()};this.o=u=>{e.enqueueRetryable((()=>i(u)))};const l=u=>{Ke("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=u,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((u=>l(u))),setTimeout((()=>{if(!this.appCheck){const u=this.V.getImmediate({optional:!0});u?l(u):Ke("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new P2(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(hn(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new P2(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function vR(s){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(s);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let i=0;i<s;i++)t[i]=Math.floor(256*Math.random());return t}class by{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const l=vR(40);for(let u=0;u<l.length;++u)i.length<20&&l[u]<t&&(i+=e.charAt(l[u]%62))}return i}}function Bt(s,e){return s<e?-1:s>e?1:0}function Cg(s,e){const t=Math.min(s.length,e.length);for(let i=0;i<t;i++){const l=s.charAt(i),u=e.charAt(i);if(l!==u)return Fp(l)===Fp(u)?Bt(l,u):Fp(l)?1:-1}return Bt(s.length,e.length)}const bR=55296,wR=57343;function Fp(s){const e=s.charCodeAt(0);return e>=bR&&e<=wR}function ql(s,e,t){return s.length===e.length&&s.every(((i,l)=>t(i,e[l])))}const V2="__name__";class ki{constructor(e,t,i){t===void 0?t=0:t>e.length&&wt(637,{offset:t,range:e.length}),i===void 0?i=e.length-t:i>e.length-t&&wt(1746,{length:i,range:e.length-t}),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return ki.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof ki?e.forEach((i=>{t.push(i)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const i=Math.min(e.length,t.length);for(let l=0;l<i;l++){const u=ki.compareSegments(e.get(l),t.get(l));if(u!==0)return u}return Bt(e.length,t.length)}static compareSegments(e,t){const i=ki.isNumericId(e),l=ki.isNumericId(t);return i&&!l?-1:!i&&l?1:i&&l?ki.extractNumericId(e).compare(ki.extractNumericId(t)):Cg(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Qa.fromString(e.substring(4,e.length-2))}}class An extends ki{construct(e,t,i){return new An(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const i of e){if(i.indexOf("//")>=0)throw new ze(ve.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter((l=>l.length>0)))}return new An(t)}static emptyPath(){return new An([])}}const xR=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Us extends ki{construct(e,t,i){return new Us(e,t,i)}static isValidIdentifier(e){return xR.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Us.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===V2}static keyField(){return new Us([V2])}static fromServerFormat(e){const t=[];let i="",l=0;const u=()=>{if(i.length===0)throw new ze(ve.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""};let d=!1;for(;l<e.length;){const p=e[l];if(p==="\\"){if(l+1===e.length)throw new ze(ve.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const g=e[l+1];if(g!=="\\"&&g!=="."&&g!=="`")throw new ze(ve.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=g,l+=2}else p==="`"?(d=!d,l++):p!=="."||d?(i+=p,l++):(u(),l++)}if(u(),d)throw new ze(ve.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Us(t)}static emptyPath(){return new Us([])}}class lt{constructor(e){this.path=e}static fromPath(e){return new lt(An.fromString(e))}static fromName(e){return new lt(An.fromString(e).popFirst(5))}static empty(){return new lt(An.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&An.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return An.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new lt(new An(e.slice()))}}function O_(s,e,t){if(!t)throw new ze(ve.INVALID_ARGUMENT,`Function ${s}() cannot be called with an empty ${e}.`)}function _R(s,e,t,i){if(e===!0&&i===!0)throw new ze(ve.INVALID_ARGUMENT,`${s} and ${t} cannot be used together.`)}function U2(s){if(!lt.isDocumentKey(s))throw new ze(ve.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${s} has ${s.length}.`)}function B2(s){if(lt.isDocumentKey(s))throw new ze(ve.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${s} has ${s.length}.`)}function P_(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}function cf(s){if(s===void 0)return"undefined";if(s===null)return"null";if(typeof s=="string")return s.length>20&&(s=`${s.substring(0,20)}...`),JSON.stringify(s);if(typeof s=="number"||typeof s=="boolean")return""+s;if(typeof s=="object"){if(s instanceof Array)return"an array";{const e=(function(i){return i.constructor?i.constructor.name:null})(s);return e?`a custom ${e} object`:"an object"}}return typeof s=="function"?"a function":wt(12329,{type:typeof s})}function sr(s,e){if("_delegate"in s&&(s=s._delegate),!(s instanceof e)){if(e.name===s.constructor.name)throw new ze(ve.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=cf(s);throw new ze(ve.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return s}function kR(s,e){if(e<=0)throw new ze(ve.INVALID_ARGUMENT,`Function ${s}() requires a positive number, but it was: ${e}.`)}function ys(s,e){const t={typeString:s};return e&&(t.value=e),t}function Lu(s,e){if(!P_(s))throw new ze(ve.INVALID_ARGUMENT,"JSON must be an object");let t;for(const i in e)if(e[i]){const l=e[i].typeString,u="value"in e[i]?{value:e[i].value}:void 0;if(!(i in s)){t=`JSON missing required field: '${i}'`;break}const d=s[i];if(l&&typeof d!==l){t=`JSON field '${i}' must be a ${l}.`;break}if(u!==void 0&&d!==u.value){t=`Expected '${i}' field to equal '${u.value}'`;break}}if(t)throw new ze(ve.INVALID_ARGUMENT,t);return!0}const z2=-62135596800,F2=1e6;class At{static now(){return At.fromMillis(Date.now())}static fromDate(e){return At.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),i=Math.floor((e-1e3*t)*F2);return new At(t,i)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new ze(ve.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new ze(ve.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<z2)throw new ze(ve.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new ze(ve.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/F2}_compareTo(e){return this.seconds===e.seconds?Bt(this.nanoseconds,e.nanoseconds):Bt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:At._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Lu(e,At._jsonSchema))return new At(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-z2;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}At._jsonSchemaVersion="firestore/timestamp/1.0",At._jsonSchema={type:ys("string",At._jsonSchemaVersion),seconds:ys("number"),nanoseconds:ys("number")};class _t{static fromTimestamp(e){return new _t(e)}static min(){return new _t(new At(0,0))}static max(){return new _t(new At(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const gu=-1;function ER(s,e){const t=s.toTimestamp().seconds,i=s.toTimestamp().nanoseconds+1,l=_t.fromTimestamp(i===1e9?new At(t+1,0):new At(t,i));return new Za(l,lt.empty(),e)}function TR(s){return new Za(s.readTime,s.key,gu)}class Za{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new Za(_t.min(),lt.empty(),gu)}static max(){return new Za(_t.max(),lt.empty(),gu)}}function jR(s,e){let t=s.readTime.compareTo(e.readTime);return t!==0?t:(t=lt.comparator(s.documentKey,e.documentKey),t!==0?t:Bt(s.largestBatchId,e.largestBatchId))}const SR="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class CR{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function tc(s){if(s.code!==ve.FAILED_PRECONDITION||s.message!==SR)throw s;Ke("LocalStore","Unexpectedly lost primary lease")}class Te{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&wt(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new Te(((i,l)=>{this.nextCallback=u=>{this.wrapSuccess(e,u).next(i,l)},this.catchCallback=u=>{this.wrapFailure(t,u).next(i,l)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof Te?t:Te.resolve(t)}catch(t){return Te.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):Te.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):Te.reject(t)}static resolve(e){return new Te(((t,i)=>{t(e)}))}static reject(e){return new Te(((t,i)=>{i(e)}))}static waitFor(e){return new Te(((t,i)=>{let l=0,u=0,d=!1;e.forEach((p=>{++l,p.next((()=>{++u,d&&u===l&&t()}),(g=>i(g)))})),d=!0,u===l&&t()}))}static or(e){let t=Te.resolve(!1);for(const i of e)t=t.next((l=>l?Te.resolve(l):i()));return t}static forEach(e,t){const i=[];return e.forEach(((l,u)=>{i.push(t.call(this,l,u))})),this.waitFor(i)}static mapArray(e,t){return new Te(((i,l)=>{const u=e.length,d=new Array(u);let p=0;for(let g=0;g<u;g++){const y=g;t(e[y]).next((b=>{d[y]=b,++p,p===u&&i(d)}),(b=>l(b)))}}))}static doWhile(e,t){return new Te(((i,l)=>{const u=()=>{e()===!0?t().next((()=>{u()}),l):i()};u()}))}}function NR(s){const e=s.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function nc(s){return s.name==="IndexedDbTransactionError"}class uf{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=i=>this.ae(i),this.ue=i=>t.writeSequenceNumber(i))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}uf.ce=-1;const wy=-1;function df(s){return s==null}function Fh(s){return s===0&&1/s==-1/0}function AR(s){return typeof s=="number"&&Number.isInteger(s)&&!Fh(s)&&s<=Number.MAX_SAFE_INTEGER&&s>=Number.MIN_SAFE_INTEGER}const V_="";function RR(s){let e="";for(let t=0;t<s.length;t++)e.length>0&&(e=q2(e)),e=IR(s.get(t),e);return q2(e)}function IR(s,e){let t=e;const i=s.length;for(let l=0;l<i;l++){const u=s.charAt(l);switch(u){case"\0":t+="";break;case V_:t+="";break;default:t+=u}}return t}function q2(s){return s+V_+""}function H2(s){let e=0;for(const t in s)Object.prototype.hasOwnProperty.call(s,t)&&e++;return e}function oo(s,e){for(const t in s)Object.prototype.hasOwnProperty.call(s,t)&&e(t,s[t])}function U_(s){for(const e in s)if(Object.prototype.hasOwnProperty.call(s,e))return!1;return!0}class Gn{constructor(e,t){this.comparator=e,this.root=t||Vs.EMPTY}insert(e,t){return new Gn(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Vs.BLACK,null,null))}remove(e){return new Gn(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Vs.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const i=this.comparator(e,t.key);if(i===0)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){const l=this.comparator(e,i.key);if(l===0)return t+i.left.size;l<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,i)=>(e(t,i),!1)))}toString(){const e=[];return this.inorderTraversal(((t,i)=>(e.push(`${t}:${i}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new oh(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new oh(this.root,e,this.comparator,!1)}getReverseIterator(){return new oh(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new oh(this.root,e,this.comparator,!0)}}class oh{constructor(e,t,i,l){this.isReverse=l,this.nodeStack=[];let u=1;for(;!e.isEmpty();)if(u=t?i(e.key,t):1,t&&l&&(u*=-1),u<0)e=this.isReverse?e.left:e.right;else{if(u===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Vs{constructor(e,t,i,l,u){this.key=e,this.value=t,this.color=i??Vs.RED,this.left=l??Vs.EMPTY,this.right=u??Vs.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,l,u){return new Vs(e??this.key,t??this.value,i??this.color,l??this.left,u??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let l=this;const u=i(e,l.key);return l=u<0?l.copy(null,null,null,l.left.insert(e,t,i),null):u===0?l.copy(null,t,null,null,null):l.copy(null,null,null,null,l.right.insert(e,t,i)),l.fixUp()}removeMin(){if(this.left.isEmpty())return Vs.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,l=this;if(t(e,l.key)<0)l.left.isEmpty()||l.left.isRed()||l.left.left.isRed()||(l=l.moveRedLeft()),l=l.copy(null,null,null,l.left.remove(e,t),null);else{if(l.left.isRed()&&(l=l.rotateRight()),l.right.isEmpty()||l.right.isRed()||l.right.left.isRed()||(l=l.moveRedRight()),t(e,l.key)===0){if(l.right.isEmpty())return Vs.EMPTY;i=l.right.min(),l=l.copy(i.key,i.value,null,null,l.right.removeMin())}l=l.copy(null,null,null,null,l.right.remove(e,t))}return l.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Vs.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Vs.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw wt(43730,{key:this.key,value:this.value});if(this.right.isRed())throw wt(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw wt(27949);return e+(this.isRed()?0:1)}}Vs.EMPTY=null,Vs.RED=!0,Vs.BLACK=!1;Vs.EMPTY=new class{constructor(){this.size=0}get key(){throw wt(57766)}get value(){throw wt(16141)}get color(){throw wt(16727)}get left(){throw wt(29726)}get right(){throw wt(36894)}copy(e,t,i,l,u){return this}insert(e,t,i){return new Vs(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class js{constructor(e){this.comparator=e,this.data=new Gn(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,i)=>(e(t),!1)))}forEachInRange(e,t){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const l=i.getNext();if(this.comparator(l.key,e[1])>=0)return;t(l.key)}}forEachWhile(e,t){let i;for(i=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new $2(this.data.getIterator())}getIteratorFrom(e){return new $2(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((i=>{t=t.add(i)})),t}isEqual(e){if(!(e instanceof js)||this.size!==e.size)return!1;const t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){const l=t.getNext().key,u=i.getNext().key;if(this.comparator(l,u)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new js(this.comparator);return t.data=e,t}}class $2{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class Cr{constructor(e){this.fields=e,e.sort(Us.comparator)}static empty(){return new Cr([])}unionWith(e){let t=new js(Us.comparator);for(const i of this.fields)t=t.add(i);for(const i of e)t=t.add(i);return new Cr(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return ql(this.fields,e.fields,((t,i)=>t.isEqual(i)))}}class B_ extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Bs{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(l){try{return atob(l)}catch(u){throw typeof DOMException<"u"&&u instanceof DOMException?new B_("Invalid base64 string: "+u):u}})(e);return new Bs(t)}static fromUint8Array(e){const t=(function(l){let u="";for(let d=0;d<l.length;++d)u+=String.fromCharCode(l[d]);return u})(e);return new Bs(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const i=new Uint8Array(t.length);for(let l=0;l<t.length;l++)i[l]=t.charCodeAt(l);return i})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Bt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Bs.EMPTY_BYTE_STRING=new Bs("");const MR=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function eo(s){if(hn(!!s,39018),typeof s=="string"){let e=0;const t=MR.exec(s);if(hn(!!t,46558,{timestamp:s}),t[1]){let l=t[1];l=(l+"000000000").substr(0,9),e=Number(l)}const i=new Date(s);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:os(s.seconds),nanos:os(s.nanos)}}function os(s){return typeof s=="number"?s:typeof s=="string"?Number(s):0}function to(s){return typeof s=="string"?Bs.fromBase64String(s):Bs.fromUint8Array(s)}const z_="server_timestamp",F_="__type__",q_="__previous_value__",H_="__local_write_time__";function xy(s){return(s?.mapValue?.fields||{})[F_]?.stringValue===z_}function hf(s){const e=s.mapValue.fields[q_];return xy(e)?hf(e):e}function yu(s){const e=eo(s.mapValue.fields[H_].timestampValue);return new At(e.seconds,e.nanos)}class DR{constructor(e,t,i,l,u,d,p,g,y,b,E){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=l,this.ssl=u,this.forceLongPolling=d,this.autoDetectLongPolling=p,this.longPollingOptions=g,this.useFetchStreams=y,this.isUsingEmulator=b,this.apiKey=E}}const qh="(default)";class vu{constructor(e,t){this.projectId=e,this.database=t||qh}static empty(){return new vu("","")}get isDefaultDatabase(){return this.database===qh}isEqual(e){return e instanceof vu&&e.projectId===this.projectId&&e.database===this.database}}function LR(s,e){if(!Object.prototype.hasOwnProperty.apply(s.options,["projectId"]))throw new ze(ve.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new vu(s.options.projectId,e)}const $_="__type__",OR="__max__",lh={mapValue:{}},W_="__vector__",Hh="value";function no(s){return"nullValue"in s?0:"booleanValue"in s?1:"integerValue"in s||"doubleValue"in s?2:"timestampValue"in s?3:"stringValue"in s?5:"bytesValue"in s?6:"referenceValue"in s?7:"geoPointValue"in s?8:"arrayValue"in s?9:"mapValue"in s?xy(s)?4:VR(s)?9007199254740991:PR(s)?10:11:wt(28295,{value:s})}function Ai(s,e){if(s===e)return!0;const t=no(s);if(t!==no(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return s.booleanValue===e.booleanValue;case 4:return yu(s).isEqual(yu(e));case 3:return(function(l,u){if(typeof l.timestampValue=="string"&&typeof u.timestampValue=="string"&&l.timestampValue.length===u.timestampValue.length)return l.timestampValue===u.timestampValue;const d=eo(l.timestampValue),p=eo(u.timestampValue);return d.seconds===p.seconds&&d.nanos===p.nanos})(s,e);case 5:return s.stringValue===e.stringValue;case 6:return(function(l,u){return to(l.bytesValue).isEqual(to(u.bytesValue))})(s,e);case 7:return s.referenceValue===e.referenceValue;case 8:return(function(l,u){return os(l.geoPointValue.latitude)===os(u.geoPointValue.latitude)&&os(l.geoPointValue.longitude)===os(u.geoPointValue.longitude)})(s,e);case 2:return(function(l,u){if("integerValue"in l&&"integerValue"in u)return os(l.integerValue)===os(u.integerValue);if("doubleValue"in l&&"doubleValue"in u){const d=os(l.doubleValue),p=os(u.doubleValue);return d===p?Fh(d)===Fh(p):isNaN(d)&&isNaN(p)}return!1})(s,e);case 9:return ql(s.arrayValue.values||[],e.arrayValue.values||[],Ai);case 10:case 11:return(function(l,u){const d=l.mapValue.fields||{},p=u.mapValue.fields||{};if(H2(d)!==H2(p))return!1;for(const g in d)if(d.hasOwnProperty(g)&&(p[g]===void 0||!Ai(d[g],p[g])))return!1;return!0})(s,e);default:return wt(52216,{left:s})}}function bu(s,e){return(s.values||[]).find((t=>Ai(t,e)))!==void 0}function Hl(s,e){if(s===e)return 0;const t=no(s),i=no(e);if(t!==i)return Bt(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return Bt(s.booleanValue,e.booleanValue);case 2:return(function(u,d){const p=os(u.integerValue||u.doubleValue),g=os(d.integerValue||d.doubleValue);return p<g?-1:p>g?1:p===g?0:isNaN(p)?isNaN(g)?0:-1:1})(s,e);case 3:return W2(s.timestampValue,e.timestampValue);case 4:return W2(yu(s),yu(e));case 5:return Cg(s.stringValue,e.stringValue);case 6:return(function(u,d){const p=to(u),g=to(d);return p.compareTo(g)})(s.bytesValue,e.bytesValue);case 7:return(function(u,d){const p=u.split("/"),g=d.split("/");for(let y=0;y<p.length&&y<g.length;y++){const b=Bt(p[y],g[y]);if(b!==0)return b}return Bt(p.length,g.length)})(s.referenceValue,e.referenceValue);case 8:return(function(u,d){const p=Bt(os(u.latitude),os(d.latitude));return p!==0?p:Bt(os(u.longitude),os(d.longitude))})(s.geoPointValue,e.geoPointValue);case 9:return G2(s.arrayValue,e.arrayValue);case 10:return(function(u,d){const p=u.fields||{},g=d.fields||{},y=p[Hh]?.arrayValue,b=g[Hh]?.arrayValue,E=Bt(y?.values?.length||0,b?.values?.length||0);return E!==0?E:G2(y,b)})(s.mapValue,e.mapValue);case 11:return(function(u,d){if(u===lh.mapValue&&d===lh.mapValue)return 0;if(u===lh.mapValue)return 1;if(d===lh.mapValue)return-1;const p=u.fields||{},g=Object.keys(p),y=d.fields||{},b=Object.keys(y);g.sort(),b.sort();for(let E=0;E<g.length&&E<b.length;++E){const T=Cg(g[E],b[E]);if(T!==0)return T;const L=Hl(p[g[E]],y[b[E]]);if(L!==0)return L}return Bt(g.length,b.length)})(s.mapValue,e.mapValue);default:throw wt(23264,{he:t})}}function W2(s,e){if(typeof s=="string"&&typeof e=="string"&&s.length===e.length)return Bt(s,e);const t=eo(s),i=eo(e),l=Bt(t.seconds,i.seconds);return l!==0?l:Bt(t.nanos,i.nanos)}function G2(s,e){const t=s.values||[],i=e.values||[];for(let l=0;l<t.length&&l<i.length;++l){const u=Hl(t[l],i[l]);if(u)return u}return Bt(t.length,i.length)}function $l(s){return Ng(s)}function Ng(s){return"nullValue"in s?"null":"booleanValue"in s?""+s.booleanValue:"integerValue"in s?""+s.integerValue:"doubleValue"in s?""+s.doubleValue:"timestampValue"in s?(function(t){const i=eo(t);return`time(${i.seconds},${i.nanos})`})(s.timestampValue):"stringValue"in s?s.stringValue:"bytesValue"in s?(function(t){return to(t).toBase64()})(s.bytesValue):"referenceValue"in s?(function(t){return lt.fromName(t).toString()})(s.referenceValue):"geoPointValue"in s?(function(t){return`geo(${t.latitude},${t.longitude})`})(s.geoPointValue):"arrayValue"in s?(function(t){let i="[",l=!0;for(const u of t.values||[])l?l=!1:i+=",",i+=Ng(u);return i+"]"})(s.arrayValue):"mapValue"in s?(function(t){const i=Object.keys(t.fields||{}).sort();let l="{",u=!0;for(const d of i)u?u=!1:l+=",",l+=`${d}:${Ng(t.fields[d])}`;return l+"}"})(s.mapValue):wt(61005,{value:s})}function jh(s){switch(no(s)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=hf(s);return e?16+jh(e):16;case 5:return 2*s.stringValue.length;case 6:return to(s.bytesValue).approximateByteSize();case 7:return s.referenceValue.length;case 9:return(function(i){return(i.values||[]).reduce(((l,u)=>l+jh(u)),0)})(s.arrayValue);case 10:case 11:return(function(i){let l=0;return oo(i.fields,((u,d)=>{l+=u.length+jh(d)})),l})(s.mapValue);default:throw wt(13486,{value:s})}}function K2(s,e){return{referenceValue:`projects/${s.projectId}/databases/${s.database}/documents/${e.path.canonicalString()}`}}function Ag(s){return!!s&&"integerValue"in s}function _y(s){return!!s&&"arrayValue"in s}function Y2(s){return!!s&&"nullValue"in s}function Q2(s){return!!s&&"doubleValue"in s&&isNaN(Number(s.doubleValue))}function Sh(s){return!!s&&"mapValue"in s}function PR(s){return(s?.mapValue?.fields||{})[$_]?.stringValue===W_}function ou(s){if(s.geoPointValue)return{geoPointValue:{...s.geoPointValue}};if(s.timestampValue&&typeof s.timestampValue=="object")return{timestampValue:{...s.timestampValue}};if(s.mapValue){const e={mapValue:{fields:{}}};return oo(s.mapValue.fields,((t,i)=>e.mapValue.fields[t]=ou(i))),e}if(s.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(s.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=ou(s.arrayValue.values[t]);return e}return{...s}}function VR(s){return(((s.mapValue||{}).fields||{}).__type__||{}).stringValue===OR}class fr{constructor(e){this.value=e}static empty(){return new fr({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!Sh(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=ou(t)}setAll(e){let t=Us.emptyPath(),i={},l=[];e.forEach(((d,p)=>{if(!t.isImmediateParentOf(p)){const g=this.getFieldsMap(t);this.applyChanges(g,i,l),i={},l=[],t=p.popLast()}d?i[p.lastSegment()]=ou(d):l.push(p.lastSegment())}));const u=this.getFieldsMap(t);this.applyChanges(u,i,l)}delete(e){const t=this.field(e.popLast());Sh(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Ai(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let l=t.mapValue.fields[e.get(i)];Sh(l)&&l.mapValue.fields||(l={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=l),t=l}return t.mapValue.fields}applyChanges(e,t,i){oo(t,((l,u)=>e[l]=u));for(const l of i)delete e[l]}clone(){return new fr(ou(this.value))}}function G_(s){const e=[];return oo(s.fields,((t,i)=>{const l=new Us([t]);if(Sh(i)){const u=G_(i.mapValue).fields;if(u.length===0)e.push(l);else for(const d of u)e.push(l.child(d))}else e.push(l)})),new Cr(e)}class Ws{constructor(e,t,i,l,u,d,p){this.key=e,this.documentType=t,this.version=i,this.readTime=l,this.createTime=u,this.data=d,this.documentState=p}static newInvalidDocument(e){return new Ws(e,0,_t.min(),_t.min(),_t.min(),fr.empty(),0)}static newFoundDocument(e,t,i,l){return new Ws(e,1,t,_t.min(),i,l,0)}static newNoDocument(e,t){return new Ws(e,2,t,_t.min(),_t.min(),fr.empty(),0)}static newUnknownDocument(e,t){return new Ws(e,3,t,_t.min(),_t.min(),fr.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(_t.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=fr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=fr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=_t.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Ws&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Ws(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class $h{constructor(e,t){this.position=e,this.inclusive=t}}function X2(s,e,t){let i=0;for(let l=0;l<s.position.length;l++){const u=e[l],d=s.position[l];if(u.field.isKeyField()?i=lt.comparator(lt.fromName(d.referenceValue),t.key):i=Hl(d,t.data.field(u.field)),u.dir==="desc"&&(i*=-1),i!==0)break}return i}function J2(s,e){if(s===null)return e===null;if(e===null||s.inclusive!==e.inclusive||s.position.length!==e.position.length)return!1;for(let t=0;t<s.position.length;t++)if(!Ai(s.position[t],e.position[t]))return!1;return!0}class wu{constructor(e,t="asc"){this.field=e,this.dir=t}}function UR(s,e){return s.dir===e.dir&&s.field.isEqual(e.field)}class K_{}class gs extends K_{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,i):new zR(e,t,i):t==="array-contains"?new HR(e,i):t==="in"?new $R(e,i):t==="not-in"?new WR(e,i):t==="array-contains-any"?new GR(e,i):new gs(e,t,i)}static createKeyFieldInFilter(e,t,i){return t==="in"?new FR(e,i):new qR(e,i)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Hl(t,this.value)):t!==null&&no(this.value)===no(t)&&this.matchesComparison(Hl(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return wt(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class ui extends K_{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new ui(e,t)}matches(e){return Y_(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function Y_(s){return s.op==="and"}function Q_(s){return BR(s)&&Y_(s)}function BR(s){for(const e of s.filters)if(e instanceof ui)return!1;return!0}function Rg(s){if(s instanceof gs)return s.field.canonicalString()+s.op.toString()+$l(s.value);if(Q_(s))return s.filters.map((e=>Rg(e))).join(",");{const e=s.filters.map((t=>Rg(t))).join(",");return`${s.op}(${e})`}}function X_(s,e){return s instanceof gs?(function(i,l){return l instanceof gs&&i.op===l.op&&i.field.isEqual(l.field)&&Ai(i.value,l.value)})(s,e):s instanceof ui?(function(i,l){return l instanceof ui&&i.op===l.op&&i.filters.length===l.filters.length?i.filters.reduce(((u,d,p)=>u&&X_(d,l.filters[p])),!0):!1})(s,e):void wt(19439)}function J_(s){return s instanceof gs?(function(t){return`${t.field.canonicalString()} ${t.op} ${$l(t.value)}`})(s):s instanceof ui?(function(t){return t.op.toString()+" {"+t.getFilters().map(J_).join(" ,")+"}"})(s):"Filter"}class zR extends gs{constructor(e,t,i){super(e,t,i),this.key=lt.fromName(i.referenceValue)}matches(e){const t=lt.comparator(e.key,this.key);return this.matchesComparison(t)}}class FR extends gs{constructor(e,t){super(e,"in",t),this.keys=Z_("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class qR extends gs{constructor(e,t){super(e,"not-in",t),this.keys=Z_("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function Z_(s,e){return(e.arrayValue?.values||[]).map((t=>lt.fromName(t.referenceValue)))}class HR extends gs{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return _y(t)&&bu(t.arrayValue,this.value)}}class $R extends gs{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&bu(this.value.arrayValue,t)}}class WR extends gs{constructor(e,t){super(e,"not-in",t)}matches(e){if(bu(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!bu(this.value.arrayValue,t)}}class GR extends gs{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!_y(t)||!t.arrayValue.values)&&t.arrayValue.values.some((i=>bu(this.value.arrayValue,i)))}}class KR{constructor(e,t=null,i=[],l=[],u=null,d=null,p=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=l,this.limit=u,this.startAt=d,this.endAt=p,this.Te=null}}function Z2(s,e=null,t=[],i=[],l=null,u=null,d=null){return new KR(s,e,t,i,l,u,d)}function ky(s){const e=Et(s);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((i=>Rg(i))).join(","),t+="|ob:",t+=e.orderBy.map((i=>(function(u){return u.field.canonicalString()+u.dir})(i))).join(","),df(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((i=>$l(i))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((i=>$l(i))).join(",")),e.Te=t}return e.Te}function Ey(s,e){if(s.limit!==e.limit||s.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<s.orderBy.length;t++)if(!UR(s.orderBy[t],e.orderBy[t]))return!1;if(s.filters.length!==e.filters.length)return!1;for(let t=0;t<s.filters.length;t++)if(!X_(s.filters[t],e.filters[t]))return!1;return s.collectionGroup===e.collectionGroup&&!!s.path.isEqual(e.path)&&!!J2(s.startAt,e.startAt)&&J2(s.endAt,e.endAt)}function Ig(s){return lt.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}class sc{constructor(e,t=null,i=[],l=[],u=null,d="F",p=null,g=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=l,this.limit=u,this.limitType=d,this.startAt=p,this.endAt=g,this.Ie=null,this.Ee=null,this.Re=null,this.startAt,this.endAt}}function YR(s,e,t,i,l,u,d,p){return new sc(s,e,t,i,l,u,d,p)}function ff(s){return new sc(s)}function ew(s){return s.filters.length===0&&s.limit===null&&s.startAt==null&&s.endAt==null&&(s.explicitOrderBy.length===0||s.explicitOrderBy.length===1&&s.explicitOrderBy[0].field.isKeyField())}function QR(s){return lt.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}function ek(s){return s.collectionGroup!==null}function lu(s){const e=Et(s);if(e.Ie===null){e.Ie=[];const t=new Set;for(const u of e.explicitOrderBy)e.Ie.push(u),t.add(u.field.canonicalString());const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(d){let p=new js(Us.comparator);return d.filters.forEach((g=>{g.getFlattenedFilters().forEach((y=>{y.isInequality()&&(p=p.add(y.field))}))})),p})(e).forEach((u=>{t.has(u.canonicalString())||u.isKeyField()||e.Ie.push(new wu(u,i))})),t.has(Us.keyField().canonicalString())||e.Ie.push(new wu(Us.keyField(),i))}return e.Ie}function Si(s){const e=Et(s);return e.Ee||(e.Ee=XR(e,lu(s))),e.Ee}function XR(s,e){if(s.limitType==="F")return Z2(s.path,s.collectionGroup,e,s.filters,s.limit,s.startAt,s.endAt);{e=e.map((l=>{const u=l.dir==="desc"?"asc":"desc";return new wu(l.field,u)}));const t=s.endAt?new $h(s.endAt.position,s.endAt.inclusive):null,i=s.startAt?new $h(s.startAt.position,s.startAt.inclusive):null;return Z2(s.path,s.collectionGroup,e,s.filters,s.limit,t,i)}}function Mg(s,e){const t=s.filters.concat([e]);return new sc(s.path,s.collectionGroup,s.explicitOrderBy.slice(),t,s.limit,s.limitType,s.startAt,s.endAt)}function JR(s,e){const t=s.explicitOrderBy.concat([e]);return new sc(s.path,s.collectionGroup,t,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}function Wh(s,e,t){return new sc(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),e,t,s.startAt,s.endAt)}function mf(s,e){return Ey(Si(s),Si(e))&&s.limitType===e.limitType}function tk(s){return`${ky(Si(s))}|lt:${s.limitType}`}function Ml(s){return`Query(target=${(function(t){let i=t.path.canonicalString();return t.collectionGroup!==null&&(i+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(i+=`, filters: [${t.filters.map((l=>J_(l))).join(", ")}]`),df(t.limit)||(i+=", limit: "+t.limit),t.orderBy.length>0&&(i+=`, orderBy: [${t.orderBy.map((l=>(function(d){return`${d.field.canonicalString()} (${d.dir})`})(l))).join(", ")}]`),t.startAt&&(i+=", startAt: ",i+=t.startAt.inclusive?"b:":"a:",i+=t.startAt.position.map((l=>$l(l))).join(",")),t.endAt&&(i+=", endAt: ",i+=t.endAt.inclusive?"a:":"b:",i+=t.endAt.position.map((l=>$l(l))).join(",")),`Target(${i})`})(Si(s))}; limitType=${s.limitType})`}function pf(s,e){return e.isFoundDocument()&&(function(i,l){const u=l.key.path;return i.collectionGroup!==null?l.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(u):lt.isDocumentKey(i.path)?i.path.isEqual(u):i.path.isImmediateParentOf(u)})(s,e)&&(function(i,l){for(const u of lu(i))if(!u.field.isKeyField()&&l.data.field(u.field)===null)return!1;return!0})(s,e)&&(function(i,l){for(const u of i.filters)if(!u.matches(l))return!1;return!0})(s,e)&&(function(i,l){return!(i.startAt&&!(function(d,p,g){const y=X2(d,p,g);return d.inclusive?y<=0:y<0})(i.startAt,lu(i),l)||i.endAt&&!(function(d,p,g){const y=X2(d,p,g);return d.inclusive?y>=0:y>0})(i.endAt,lu(i),l))})(s,e)}function ZR(s){return s.collectionGroup||(s.path.length%2==1?s.path.lastSegment():s.path.get(s.path.length-2))}function nk(s){return(e,t)=>{let i=!1;for(const l of lu(s)){const u=eI(l,e,t);if(u!==0)return u;i=i||l.field.isKeyField()}return 0}}function eI(s,e,t){const i=s.field.isKeyField()?lt.comparator(e.key,t.key):(function(u,d,p){const g=d.data.field(u),y=p.data.field(u);return g!==null&&y!==null?Hl(g,y):wt(42886)})(s.field,e,t);switch(s.dir){case"asc":return i;case"desc":return-1*i;default:return wt(19790,{direction:s.dir})}}class Ko{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i!==void 0){for(const[l,u]of i)if(this.equalsFn(l,e))return u}}has(e){return this.get(e)!==void 0}set(e,t){const i=this.mapKeyFn(e),l=this.inner[i];if(l===void 0)return this.inner[i]=[[e,t]],void this.innerSize++;for(let u=0;u<l.length;u++)if(this.equalsFn(l[u][0],e))return void(l[u]=[e,t]);l.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i===void 0)return!1;for(let l=0;l<i.length;l++)if(this.equalsFn(i[l][0],e))return i.length===1?delete this.inner[t]:i.splice(l,1),this.innerSize--,!0;return!1}forEach(e){oo(this.inner,((t,i)=>{for(const[l,u]of i)e(l,u)}))}isEmpty(){return U_(this.inner)}size(){return this.innerSize}}const tI=new Gn(lt.comparator);function ca(){return tI}const sk=new Gn(lt.comparator);function nu(...s){let e=sk;for(const t of s)e=e.insert(t.key,t);return e}function rk(s){let e=sk;return s.forEach(((t,i)=>e=e.insert(t,i.overlayedDocument))),e}function Ao(){return cu()}function ik(){return cu()}function cu(){return new Ko((s=>s.toString()),((s,e)=>s.isEqual(e)))}const nI=new Gn(lt.comparator),sI=new js(lt.comparator);function zt(...s){let e=sI;for(const t of s)e=e.add(t);return e}const rI=new js(Bt);function iI(){return rI}function Ty(s,e){if(s.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Fh(e)?"-0":e}}function ak(s){return{integerValue:""+s}}function ok(s,e){return AR(e)?ak(e):Ty(s,e)}class gf{constructor(){this._=void 0}}function aI(s,e,t){return s instanceof xu?(function(l,u){const d={fields:{[F_]:{stringValue:z_},[H_]:{timestampValue:{seconds:l.seconds,nanos:l.nanoseconds}}}};return u&&xy(u)&&(u=hf(u)),u&&(d.fields[q_]=u),{mapValue:d}})(t,e):s instanceof Wl?ck(s,e):s instanceof Gl?uk(s,e):(function(l,u){const d=lk(l,u),p=tw(d)+tw(l.Ae);return Ag(d)&&Ag(l.Ae)?ak(p):Ty(l.serializer,p)})(s,e)}function oI(s,e,t){return s instanceof Wl?ck(s,e):s instanceof Gl?uk(s,e):t}function lk(s,e){return s instanceof _u?(function(i){return Ag(i)||(function(u){return!!u&&"doubleValue"in u})(i)})(e)?e:{integerValue:0}:null}class xu extends gf{}class Wl extends gf{constructor(e){super(),this.elements=e}}function ck(s,e){const t=dk(e);for(const i of s.elements)t.some((l=>Ai(l,i)))||t.push(i);return{arrayValue:{values:t}}}class Gl extends gf{constructor(e){super(),this.elements=e}}function uk(s,e){let t=dk(e);for(const i of s.elements)t=t.filter((l=>!Ai(l,i)));return{arrayValue:{values:t}}}class _u extends gf{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function tw(s){return os(s.integerValue||s.doubleValue)}function dk(s){return _y(s)&&s.arrayValue.values?s.arrayValue.values.slice():[]}class yf{constructor(e,t){this.field=e,this.transform=t}}function lI(s,e){return s.field.isEqual(e.field)&&(function(i,l){return i instanceof Wl&&l instanceof Wl||i instanceof Gl&&l instanceof Gl?ql(i.elements,l.elements,Ai):i instanceof _u&&l instanceof _u?Ai(i.Ae,l.Ae):i instanceof xu&&l instanceof xu})(s.transform,e.transform)}class cI{constructor(e,t){this.version=e,this.transformResults=t}}class rr{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new rr}static exists(e){return new rr(void 0,e)}static updateTime(e){return new rr(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Ch(s,e){return s.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(s.updateTime):s.exists===void 0||s.exists===e.isFoundDocument()}class vf{}function hk(s,e){if(!s.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return s.isNoDocument()?new bf(s.key,rr.none()):new Ou(s.key,s.data,rr.none());{const t=s.data,i=fr.empty();let l=new js(Us.comparator);for(let u of e.fields)if(!l.has(u)){let d=t.field(u);d===null&&u.length>1&&(u=u.popLast(),d=t.field(u)),d===null?i.delete(u):i.set(u,d),l=l.add(u)}return new lo(s.key,i,new Cr(l.toArray()),rr.none())}}function uI(s,e,t){s instanceof Ou?(function(l,u,d){const p=l.value.clone(),g=sw(l.fieldTransforms,u,d.transformResults);p.setAll(g),u.convertToFoundDocument(d.version,p).setHasCommittedMutations()})(s,e,t):s instanceof lo?(function(l,u,d){if(!Ch(l.precondition,u))return void u.convertToUnknownDocument(d.version);const p=sw(l.fieldTransforms,u,d.transformResults),g=u.data;g.setAll(fk(l)),g.setAll(p),u.convertToFoundDocument(d.version,g).setHasCommittedMutations()})(s,e,t):(function(l,u,d){u.convertToNoDocument(d.version).setHasCommittedMutations()})(0,e,t)}function uu(s,e,t,i){return s instanceof Ou?(function(u,d,p,g){if(!Ch(u.precondition,d))return p;const y=u.value.clone(),b=rw(u.fieldTransforms,g,d);return y.setAll(b),d.convertToFoundDocument(d.version,y).setHasLocalMutations(),null})(s,e,t,i):s instanceof lo?(function(u,d,p,g){if(!Ch(u.precondition,d))return p;const y=rw(u.fieldTransforms,g,d),b=d.data;return b.setAll(fk(u)),b.setAll(y),d.convertToFoundDocument(d.version,b).setHasLocalMutations(),p===null?null:p.unionWith(u.fieldMask.fields).unionWith(u.fieldTransforms.map((E=>E.field)))})(s,e,t,i):(function(u,d,p){return Ch(u.precondition,d)?(d.convertToNoDocument(d.version).setHasLocalMutations(),null):p})(s,e,t)}function dI(s,e){let t=null;for(const i of s.fieldTransforms){const l=e.data.field(i.field),u=lk(i.transform,l||null);u!=null&&(t===null&&(t=fr.empty()),t.set(i.field,u))}return t||null}function nw(s,e){return s.type===e.type&&!!s.key.isEqual(e.key)&&!!s.precondition.isEqual(e.precondition)&&!!(function(i,l){return i===void 0&&l===void 0||!(!i||!l)&&ql(i,l,((u,d)=>lI(u,d)))})(s.fieldTransforms,e.fieldTransforms)&&(s.type===0?s.value.isEqual(e.value):s.type!==1||s.data.isEqual(e.data)&&s.fieldMask.isEqual(e.fieldMask))}class Ou extends vf{constructor(e,t,i,l=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=l,this.type=0}getFieldMask(){return null}}class lo extends vf{constructor(e,t,i,l,u=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=l,this.fieldTransforms=u,this.type=1}getFieldMask(){return this.fieldMask}}function fk(s){const e=new Map;return s.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const i=s.data.field(t);e.set(t,i)}})),e}function sw(s,e,t){const i=new Map;hn(s.length===t.length,32656,{Ve:t.length,de:s.length});for(let l=0;l<t.length;l++){const u=s[l],d=u.transform,p=e.data.field(u.field);i.set(u.field,oI(d,p,t[l]))}return i}function rw(s,e,t){const i=new Map;for(const l of s){const u=l.transform,d=t.data.field(l.field);i.set(l.field,aI(u,d,e))}return i}class bf extends vf{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class hI extends vf{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class fI{constructor(e,t,i,l){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=l}applyToRemoteDocument(e,t){const i=t.mutationResults;for(let l=0;l<this.mutations.length;l++){const u=this.mutations[l];u.key.isEqual(e.key)&&uI(u,e,i[l])}}applyToLocalView(e,t){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(t=uu(i,e,t,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(t=uu(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const i=ik();return this.mutations.forEach((l=>{const u=e.get(l.key),d=u.overlayedDocument;let p=this.applyToLocalView(d,u.mutatedFields);p=t.has(l.key)?null:p;const g=hk(d,p);g!==null&&i.set(l.key,g),d.isValidDocument()||d.convertToNoDocument(_t.min())})),i}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),zt())}isEqual(e){return this.batchId===e.batchId&&ql(this.mutations,e.mutations,((t,i)=>nw(t,i)))&&ql(this.baseMutations,e.baseMutations,((t,i)=>nw(t,i)))}}class jy{constructor(e,t,i,l){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=l}static from(e,t,i){hn(e.mutations.length===i.length,58842,{me:e.mutations.length,fe:i.length});let l=(function(){return nI})();const u=e.mutations;for(let d=0;d<u.length;d++)l=l.insert(u[d].key,i[d].version);return new jy(e,t,i,l)}}class mI{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class pI{constructor(e,t){this.count=e,this.unchangedNames=t}}var ps,$t;function gI(s){switch(s){case ve.OK:return wt(64938);case ve.CANCELLED:case ve.UNKNOWN:case ve.DEADLINE_EXCEEDED:case ve.RESOURCE_EXHAUSTED:case ve.INTERNAL:case ve.UNAVAILABLE:case ve.UNAUTHENTICATED:return!1;case ve.INVALID_ARGUMENT:case ve.NOT_FOUND:case ve.ALREADY_EXISTS:case ve.PERMISSION_DENIED:case ve.FAILED_PRECONDITION:case ve.ABORTED:case ve.OUT_OF_RANGE:case ve.UNIMPLEMENTED:case ve.DATA_LOSS:return!0;default:return wt(15467,{code:s})}}function mk(s){if(s===void 0)return la("GRPC error has no .code"),ve.UNKNOWN;switch(s){case ps.OK:return ve.OK;case ps.CANCELLED:return ve.CANCELLED;case ps.UNKNOWN:return ve.UNKNOWN;case ps.DEADLINE_EXCEEDED:return ve.DEADLINE_EXCEEDED;case ps.RESOURCE_EXHAUSTED:return ve.RESOURCE_EXHAUSTED;case ps.INTERNAL:return ve.INTERNAL;case ps.UNAVAILABLE:return ve.UNAVAILABLE;case ps.UNAUTHENTICATED:return ve.UNAUTHENTICATED;case ps.INVALID_ARGUMENT:return ve.INVALID_ARGUMENT;case ps.NOT_FOUND:return ve.NOT_FOUND;case ps.ALREADY_EXISTS:return ve.ALREADY_EXISTS;case ps.PERMISSION_DENIED:return ve.PERMISSION_DENIED;case ps.FAILED_PRECONDITION:return ve.FAILED_PRECONDITION;case ps.ABORTED:return ve.ABORTED;case ps.OUT_OF_RANGE:return ve.OUT_OF_RANGE;case ps.UNIMPLEMENTED:return ve.UNIMPLEMENTED;case ps.DATA_LOSS:return ve.DATA_LOSS;default:return wt(39323,{code:s})}}($t=ps||(ps={}))[$t.OK=0]="OK",$t[$t.CANCELLED=1]="CANCELLED",$t[$t.UNKNOWN=2]="UNKNOWN",$t[$t.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",$t[$t.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",$t[$t.NOT_FOUND=5]="NOT_FOUND",$t[$t.ALREADY_EXISTS=6]="ALREADY_EXISTS",$t[$t.PERMISSION_DENIED=7]="PERMISSION_DENIED",$t[$t.UNAUTHENTICATED=16]="UNAUTHENTICATED",$t[$t.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",$t[$t.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",$t[$t.ABORTED=10]="ABORTED",$t[$t.OUT_OF_RANGE=11]="OUT_OF_RANGE",$t[$t.UNIMPLEMENTED=12]="UNIMPLEMENTED",$t[$t.INTERNAL=13]="INTERNAL",$t[$t.UNAVAILABLE=14]="UNAVAILABLE",$t[$t.DATA_LOSS=15]="DATA_LOSS";function yI(){return new TextEncoder}const vI=new Qa([4294967295,4294967295],0);function iw(s){const e=yI().encode(s),t=new C_;return t.update(e),new Uint8Array(t.digest())}function aw(s){const e=new DataView(s.buffer),t=e.getUint32(0,!0),i=e.getUint32(4,!0),l=e.getUint32(8,!0),u=e.getUint32(12,!0);return[new Qa([t,i],0),new Qa([l,u],0)]}class Sy{constructor(e,t,i){if(this.bitmap=e,this.padding=t,this.hashCount=i,t<0||t>=8)throw new su(`Invalid padding: ${t}`);if(i<0)throw new su(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new su(`Invalid hash count: ${i}`);if(e.length===0&&t!==0)throw new su(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=Qa.fromNumber(this.ge)}ye(e,t,i){let l=e.add(t.multiply(Qa.fromNumber(i)));return l.compare(vI)===1&&(l=new Qa([l.getBits(0),l.getBits(1)],0)),l.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=iw(e),[i,l]=aw(t);for(let u=0;u<this.hashCount;u++){const d=this.ye(i,l,u);if(!this.we(d))return!1}return!0}static create(e,t,i){const l=e%8==0?0:8-e%8,u=new Uint8Array(Math.ceil(e/8)),d=new Sy(u,l,t);return i.forEach((p=>d.insert(p))),d}insert(e){if(this.ge===0)return;const t=iw(e),[i,l]=aw(t);for(let u=0;u<this.hashCount;u++){const d=this.ye(i,l,u);this.be(d)}}be(e){const t=Math.floor(e/8),i=e%8;this.bitmap[t]|=1<<i}}class su extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class wf{constructor(e,t,i,l,u){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=i,this.documentUpdates=l,this.resolvedLimboDocuments=u}static createSynthesizedRemoteEventForCurrentChange(e,t,i){const l=new Map;return l.set(e,Pu.createSynthesizedTargetChangeForCurrentChange(e,t,i)),new wf(_t.min(),l,new Gn(Bt),ca(),zt())}}class Pu{constructor(e,t,i,l,u){this.resumeToken=e,this.current=t,this.addedDocuments=i,this.modifiedDocuments=l,this.removedDocuments=u}static createSynthesizedTargetChangeForCurrentChange(e,t,i){return new Pu(i,t,zt(),zt(),zt())}}class Nh{constructor(e,t,i,l){this.Se=e,this.removedTargetIds=t,this.key=i,this.De=l}}class pk{constructor(e,t){this.targetId=e,this.Ce=t}}class gk{constructor(e,t,i=Bs.EMPTY_BYTE_STRING,l=null){this.state=e,this.targetIds=t,this.resumeToken=i,this.cause=l}}class ow{constructor(){this.ve=0,this.Fe=lw(),this.Me=Bs.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=zt(),t=zt(),i=zt();return this.Fe.forEach(((l,u)=>{switch(u){case 0:e=e.add(l);break;case 2:t=t.add(l);break;case 1:i=i.add(l);break;default:wt(38017,{changeType:u})}})),new Pu(this.Me,this.xe,e,t,i)}Ke(){this.Oe=!1,this.Fe=lw()}qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}Ue(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}$e(){this.ve+=1}We(){this.ve-=1,hn(this.ve>=0,3241,{ve:this.ve})}Qe(){this.Oe=!0,this.xe=!0}}class bI{constructor(e){this.Ge=e,this.ze=new Map,this.je=ca(),this.He=ch(),this.Je=ch(),this.Ze=new Gn(Bt)}Xe(e){for(const t of e.Se)e.De&&e.De.isFoundDocument()?this.Ye(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const i=this.nt(t);switch(e.state){case 0:this.rt(t)&&i.Le(e.resumeToken);break;case 1:i.We(),i.Ne||i.Ke(),i.Le(e.resumeToken);break;case 2:i.We(),i.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(i.Qe(),i.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),i.Le(e.resumeToken));break;default:wt(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((i,l)=>{this.rt(l)&&t(l)}))}st(e){const t=e.targetId,i=e.Ce.count,l=this.ot(t);if(l){const u=l.target;if(Ig(u))if(i===0){const d=new lt(u.path);this.et(t,d,Ws.newNoDocument(d,_t.min()))}else hn(i===1,20013,{expectedCount:i});else{const d=this._t(t);if(d!==i){const p=this.ut(e),g=p?this.ct(p,e,d):1;if(g!==0){this.it(t);const y=g===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(t,y)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:i="",padding:l=0},hashCount:u=0}=t;let d,p;try{d=to(i).toUint8Array()}catch(g){if(g instanceof B_)return Fl("Decoding the base64 bloom filter in existence filter failed ("+g.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw g}try{p=new Sy(d,l,u)}catch(g){return Fl(g instanceof su?"BloomFilter error: ":"Applying bloom filter failed: ",g),null}return p.ge===0?null:p}ct(e,t,i){return t.Ce.count===i-this.Pt(e,t.targetId)?0:2}Pt(e,t){const i=this.Ge.getRemoteKeysForTarget(t);let l=0;return i.forEach((u=>{const d=this.Ge.ht(),p=`projects/${d.projectId}/databases/${d.database}/documents/${u.path.canonicalString()}`;e.mightContain(p)||(this.et(t,u,null),l++)})),l}Tt(e){const t=new Map;this.ze.forEach(((u,d)=>{const p=this.ot(d);if(p){if(u.current&&Ig(p.target)){const g=new lt(p.target.path);this.It(g).has(d)||this.Et(d,g)||this.et(d,g,Ws.newNoDocument(g,e))}u.Be&&(t.set(d,u.ke()),u.Ke())}}));let i=zt();this.Je.forEach(((u,d)=>{let p=!0;d.forEachWhile((g=>{const y=this.ot(g);return!y||y.purpose==="TargetPurposeLimboResolution"||(p=!1,!1)})),p&&(i=i.add(u))})),this.je.forEach(((u,d)=>d.setReadTime(e)));const l=new wf(e,t,this.Ze,this.je,i);return this.je=ca(),this.He=ch(),this.Je=ch(),this.Ze=new Gn(Bt),l}Ye(e,t){if(!this.rt(e))return;const i=this.Et(e,t.key)?2:0;this.nt(e).qe(t.key,i),this.je=this.je.insert(t.key,t),this.He=this.He.insert(t.key,this.It(t.key).add(e)),this.Je=this.Je.insert(t.key,this.Rt(t.key).add(e))}et(e,t,i){if(!this.rt(e))return;const l=this.nt(e);this.Et(e,t)?l.qe(t,1):l.Ue(t),this.Je=this.Je.insert(t,this.Rt(t).delete(e)),this.Je=this.Je.insert(t,this.Rt(t).add(e)),i&&(this.je=this.je.insert(t,i))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.nt(e).$e()}nt(e){let t=this.ze.get(e);return t||(t=new ow,this.ze.set(e,t)),t}Rt(e){let t=this.Je.get(e);return t||(t=new js(Bt),this.Je=this.Je.insert(e,t)),t}It(e){let t=this.He.get(e);return t||(t=new js(Bt),this.He=this.He.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||Ke("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new ow),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function ch(){return new Gn(lt.comparator)}function lw(){return new Gn(lt.comparator)}const wI={asc:"ASCENDING",desc:"DESCENDING"},xI={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},_I={and:"AND",or:"OR"};class kI{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Dg(s,e){return s.useProto3Json||df(e)?e:{value:e}}function Gh(s,e){return s.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function yk(s,e){return s.useProto3Json?e.toBase64():e.toUint8Array()}function EI(s,e){return Gh(s,e.toTimestamp())}function Ci(s){return hn(!!s,49232),_t.fromTimestamp((function(t){const i=eo(t);return new At(i.seconds,i.nanos)})(s))}function Cy(s,e){return Lg(s,e).canonicalString()}function Lg(s,e){const t=(function(l){return new An(["projects",l.projectId,"databases",l.database])})(s).child("documents");return e===void 0?t:t.child(e)}function vk(s){const e=An.fromString(s);return hn(kk(e),10190,{key:e.toString()}),e}function Og(s,e){return Cy(s.databaseId,e.path)}function qp(s,e){const t=vk(e);if(t.get(1)!==s.databaseId.projectId)throw new ze(ve.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+s.databaseId.projectId);if(t.get(3)!==s.databaseId.database)throw new ze(ve.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+s.databaseId.database);return new lt(wk(t))}function bk(s,e){return Cy(s.databaseId,e)}function TI(s){const e=vk(s);return e.length===4?An.emptyPath():wk(e)}function Pg(s){return new An(["projects",s.databaseId.projectId,"databases",s.databaseId.database]).canonicalString()}function wk(s){return hn(s.length>4&&s.get(4)==="documents",29091,{key:s.toString()}),s.popFirst(5)}function cw(s,e,t){return{name:Og(s,e),fields:t.value.mapValue.fields}}function jI(s,e){let t;if("targetChange"in e){e.targetChange;const i=(function(y){return y==="NO_CHANGE"?0:y==="ADD"?1:y==="REMOVE"?2:y==="CURRENT"?3:y==="RESET"?4:wt(39313,{state:y})})(e.targetChange.targetChangeType||"NO_CHANGE"),l=e.targetChange.targetIds||[],u=(function(y,b){return y.useProto3Json?(hn(b===void 0||typeof b=="string",58123),Bs.fromBase64String(b||"")):(hn(b===void 0||b instanceof Buffer||b instanceof Uint8Array,16193),Bs.fromUint8Array(b||new Uint8Array))})(s,e.targetChange.resumeToken),d=e.targetChange.cause,p=d&&(function(y){const b=y.code===void 0?ve.UNKNOWN:mk(y.code);return new ze(b,y.message||"")})(d);t=new gk(i,l,u,p||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const l=qp(s,i.document.name),u=Ci(i.document.updateTime),d=i.document.createTime?Ci(i.document.createTime):_t.min(),p=new fr({mapValue:{fields:i.document.fields}}),g=Ws.newFoundDocument(l,u,d,p),y=i.targetIds||[],b=i.removedTargetIds||[];t=new Nh(y,b,g.key,g)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const l=qp(s,i.document),u=i.readTime?Ci(i.readTime):_t.min(),d=Ws.newNoDocument(l,u),p=i.removedTargetIds||[];t=new Nh([],p,d.key,d)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const l=qp(s,i.document),u=i.removedTargetIds||[];t=new Nh([],u,l,null)}else{if(!("filter"in e))return wt(11601,{Vt:e});{e.filter;const i=e.filter;i.targetId;const{count:l=0,unchangedNames:u}=i,d=new pI(l,u),p=i.targetId;t=new pk(p,d)}}return t}function SI(s,e){let t;if(e instanceof Ou)t={update:cw(s,e.key,e.value)};else if(e instanceof bf)t={delete:Og(s,e.key)};else if(e instanceof lo)t={update:cw(s,e.key,e.data),updateMask:OI(e.fieldMask)};else{if(!(e instanceof hI))return wt(16599,{dt:e.type});t={verify:Og(s,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((i=>(function(u,d){const p=d.transform;if(p instanceof xu)return{fieldPath:d.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(p instanceof Wl)return{fieldPath:d.field.canonicalString(),appendMissingElements:{values:p.elements}};if(p instanceof Gl)return{fieldPath:d.field.canonicalString(),removeAllFromArray:{values:p.elements}};if(p instanceof _u)return{fieldPath:d.field.canonicalString(),increment:p.Ae};throw wt(20930,{transform:d.transform})})(0,i)))),e.precondition.isNone||(t.currentDocument=(function(l,u){return u.updateTime!==void 0?{updateTime:EI(l,u.updateTime)}:u.exists!==void 0?{exists:u.exists}:wt(27497)})(s,e.precondition)),t}function CI(s,e){return s&&s.length>0?(hn(e!==void 0,14353),s.map((t=>(function(l,u){let d=l.updateTime?Ci(l.updateTime):Ci(u);return d.isEqual(_t.min())&&(d=Ci(u)),new cI(d,l.transformResults||[])})(t,e)))):[]}function NI(s,e){return{documents:[bk(s,e.path)]}}function AI(s,e){const t={structuredQuery:{}},i=e.path;let l;e.collectionGroup!==null?(l=i,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(l=i.popLast(),t.structuredQuery.from=[{collectionId:i.lastSegment()}]),t.parent=bk(s,l);const u=(function(y){if(y.length!==0)return _k(ui.create(y,"and"))})(e.filters);u&&(t.structuredQuery.where=u);const d=(function(y){if(y.length!==0)return y.map((b=>(function(T){return{field:Dl(T.field),direction:MI(T.dir)}})(b)))})(e.orderBy);d&&(t.structuredQuery.orderBy=d);const p=Dg(s,e.limit);return p!==null&&(t.structuredQuery.limit=p),e.startAt&&(t.structuredQuery.startAt=(function(y){return{before:y.inclusive,values:y.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(y){return{before:!y.inclusive,values:y.position}})(e.endAt)),{ft:t,parent:l}}function RI(s){let e=TI(s.parent);const t=s.structuredQuery,i=t.from?t.from.length:0;let l=null;if(i>0){hn(i===1,65062);const b=t.from[0];b.allDescendants?l=b.collectionId:e=e.child(b.collectionId)}let u=[];t.where&&(u=(function(E){const T=xk(E);return T instanceof ui&&Q_(T)?T.getFilters():[T]})(t.where));let d=[];t.orderBy&&(d=(function(E){return E.map((T=>(function(W){return new wu(Ll(W.field),(function(B){switch(B){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(W.direction))})(T)))})(t.orderBy));let p=null;t.limit&&(p=(function(E){let T;return T=typeof E=="object"?E.value:E,df(T)?null:T})(t.limit));let g=null;t.startAt&&(g=(function(E){const T=!!E.before,L=E.values||[];return new $h(L,T)})(t.startAt));let y=null;return t.endAt&&(y=(function(E){const T=!E.before,L=E.values||[];return new $h(L,T)})(t.endAt)),YR(e,l,d,u,p,"F",g,y)}function II(s,e){const t=(function(l){switch(l){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return wt(28987,{purpose:l})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function xk(s){return s.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const i=Ll(t.unaryFilter.field);return gs.create(i,"==",{doubleValue:NaN});case"IS_NULL":const l=Ll(t.unaryFilter.field);return gs.create(l,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const u=Ll(t.unaryFilter.field);return gs.create(u,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const d=Ll(t.unaryFilter.field);return gs.create(d,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return wt(61313);default:return wt(60726)}})(s):s.fieldFilter!==void 0?(function(t){return gs.create(Ll(t.fieldFilter.field),(function(l){switch(l){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return wt(58110);default:return wt(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(s):s.compositeFilter!==void 0?(function(t){return ui.create(t.compositeFilter.filters.map((i=>xk(i))),(function(l){switch(l){case"AND":return"and";case"OR":return"or";default:return wt(1026)}})(t.compositeFilter.op))})(s):wt(30097,{filter:s})}function MI(s){return wI[s]}function DI(s){return xI[s]}function LI(s){return _I[s]}function Dl(s){return{fieldPath:s.canonicalString()}}function Ll(s){return Us.fromServerFormat(s.fieldPath)}function _k(s){return s instanceof gs?(function(t){if(t.op==="=="){if(Q2(t.value))return{unaryFilter:{field:Dl(t.field),op:"IS_NAN"}};if(Y2(t.value))return{unaryFilter:{field:Dl(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(Q2(t.value))return{unaryFilter:{field:Dl(t.field),op:"IS_NOT_NAN"}};if(Y2(t.value))return{unaryFilter:{field:Dl(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Dl(t.field),op:DI(t.op),value:t.value}}})(s):s instanceof ui?(function(t){const i=t.getFilters().map((l=>_k(l)));return i.length===1?i[0]:{compositeFilter:{op:LI(t.op),filters:i}}})(s):wt(54877,{filter:s})}function OI(s){const e=[];return s.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function kk(s){return s.length>=4&&s.get(0)==="projects"&&s.get(2)==="databases"}function Ek(s){return!!s&&typeof s._toProto=="function"&&s._protoValueType==="ProtoValue"}class Wa{constructor(e,t,i,l,u=_t.min(),d=_t.min(),p=Bs.EMPTY_BYTE_STRING,g=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=l,this.snapshotVersion=u,this.lastLimboFreeSnapshotVersion=d,this.resumeToken=p,this.expectedCount=g}withSequenceNumber(e){return new Wa(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Wa(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Wa(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Wa(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class PI{constructor(e){this.yt=e}}function VI(s){const e=RI({parent:s.parent,structuredQuery:s.structuredQuery});return s.limitType==="LAST"?Wh(e,e.limit,"L"):e}class UI{constructor(){this.Sn=new BI}addToCollectionParentIndex(e,t){return this.Sn.add(t),Te.resolve()}getCollectionParents(e,t){return Te.resolve(this.Sn.getEntries(t))}addFieldIndex(e,t){return Te.resolve()}deleteFieldIndex(e,t){return Te.resolve()}deleteAllFieldIndexes(e){return Te.resolve()}createTargetIndexes(e,t){return Te.resolve()}getDocumentsMatchingTarget(e,t){return Te.resolve(null)}getIndexType(e,t){return Te.resolve(0)}getFieldIndexes(e,t){return Te.resolve([])}getNextCollectionGroupToUpdate(e){return Te.resolve(null)}getMinOffset(e,t){return Te.resolve(Za.min())}getMinOffsetFromCollectionGroup(e,t){return Te.resolve(Za.min())}updateCollectionGroup(e,t,i){return Te.resolve()}updateIndexEntries(e,t){return Te.resolve()}}class BI{constructor(){this.index={}}add(e){const t=e.lastSegment(),i=e.popLast(),l=this.index[t]||new js(An.comparator),u=!l.has(i);return this.index[t]=l.add(i),u}has(e){const t=e.lastSegment(),i=e.popLast(),l=this.index[t];return l&&l.has(i)}getEntries(e){return(this.index[e]||new js(An.comparator)).toArray()}}const uw={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Tk=41943040;class hr{static withCacheSize(e){return new hr(e,hr.DEFAULT_COLLECTION_PERCENTILE,hr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}}hr.DEFAULT_COLLECTION_PERCENTILE=10,hr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,hr.DEFAULT=new hr(Tk,hr.DEFAULT_COLLECTION_PERCENTILE,hr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),hr.DISABLED=new hr(-1,0,0);class Kl{constructor(e){this.sr=e}next(){return this.sr+=2,this.sr}static _r(){return new Kl(0)}static ar(){return new Kl(-1)}}const dw="LruGarbageCollector",zI=1048576;function hw([s,e],[t,i]){const l=Bt(s,t);return l===0?Bt(e,i):l}class FI{constructor(e){this.Pr=e,this.buffer=new js(hw),this.Tr=0}Ir(){return++this.Tr}Er(e){const t=[e,this.Ir()];if(this.buffer.size<this.Pr)this.buffer=this.buffer.add(t);else{const i=this.buffer.last();hw(t,i)<0&&(this.buffer=this.buffer.delete(i).add(t))}}get maxValue(){return this.buffer.last()[0]}}class qI{constructor(e,t,i){this.garbageCollector=e,this.asyncQueue=t,this.localStore=i,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Ar(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Ar(e){Ke(dw,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){nc(t)?Ke(dw,"Ignoring IndexedDB error during garbage collection: ",t):await tc(t)}await this.Ar(3e5)}))}}class HI{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.dr(e).next((i=>Math.floor(t/100*i)))}nthSequenceNumber(e,t){if(t===0)return Te.resolve(uf.ce);const i=new FI(t);return this.Vr.forEachTarget(e,(l=>i.Er(l.sequenceNumber))).next((()=>this.Vr.mr(e,(l=>i.Er(l))))).next((()=>i.maxValue))}removeTargets(e,t,i){return this.Vr.removeTargets(e,t,i)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(Ke("LruGarbageCollector","Garbage collection skipped; disabled"),Te.resolve(uw)):this.getCacheSize(e).next((i=>i<this.params.cacheSizeCollectionThreshold?(Ke("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),uw):this.gr(e,t)))}getCacheSize(e){return this.Vr.getCacheSize(e)}gr(e,t){let i,l,u,d,p,g,y;const b=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((E=>(E>this.params.maximumSequenceNumbersToCollect?(Ke("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${E}`),l=this.params.maximumSequenceNumbersToCollect):l=E,d=Date.now(),this.nthSequenceNumber(e,l)))).next((E=>(i=E,p=Date.now(),this.removeTargets(e,i,t)))).next((E=>(u=E,g=Date.now(),this.removeOrphanedDocuments(e,i)))).next((E=>(y=Date.now(),Il()<=Ut.DEBUG&&Ke("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${d-b}ms
	Determined least recently used ${l} in `+(p-d)+`ms
	Removed ${u} targets in `+(g-p)+`ms
	Removed ${E} documents in `+(y-g)+`ms
Total Duration: ${y-b}ms`),Te.resolve({didRun:!0,sequenceNumbersCollected:l,targetsRemoved:u,documentsRemoved:E}))))}}function $I(s,e){return new HI(s,e)}class WI{constructor(){this.changes=new Ko((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Ws.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const i=this.changes.get(t);return i!==void 0?Te.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class GI{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class KI{constructor(e,t,i,l){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=l}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next((l=>(i=l,this.remoteDocumentCache.getEntry(e,t)))).next((l=>(i!==null&&uu(i.mutation,l,Cr.empty(),At.now()),l)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.getLocalViewOfDocuments(e,i,zt()).next((()=>i))))}getLocalViewOfDocuments(e,t,i=zt()){const l=Ao();return this.populateOverlays(e,l,t).next((()=>this.computeViews(e,t,l,i).next((u=>{let d=nu();return u.forEach(((p,g)=>{d=d.insert(p,g.overlayedDocument)})),d}))))}getOverlayedDocuments(e,t){const i=Ao();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,zt())))}populateOverlays(e,t,i){const l=[];return i.forEach((u=>{t.has(u)||l.push(u)})),this.documentOverlayCache.getOverlays(e,l).next((u=>{u.forEach(((d,p)=>{t.set(d,p)}))}))}computeViews(e,t,i,l){let u=ca();const d=cu(),p=(function(){return cu()})();return t.forEach(((g,y)=>{const b=i.get(y.key);l.has(y.key)&&(b===void 0||b.mutation instanceof lo)?u=u.insert(y.key,y):b!==void 0?(d.set(y.key,b.mutation.getFieldMask()),uu(b.mutation,y,b.mutation.getFieldMask(),At.now())):d.set(y.key,Cr.empty())})),this.recalculateAndSaveOverlays(e,u).next((g=>(g.forEach(((y,b)=>d.set(y,b))),t.forEach(((y,b)=>p.set(y,new GI(b,d.get(y)??null)))),p)))}recalculateAndSaveOverlays(e,t){const i=cu();let l=new Gn(((d,p)=>d-p)),u=zt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((d=>{for(const p of d)p.keys().forEach((g=>{const y=t.get(g);if(y===null)return;let b=i.get(g)||Cr.empty();b=p.applyToLocalView(y,b),i.set(g,b);const E=(l.get(p.batchId)||zt()).add(g);l=l.insert(p.batchId,E)}))})).next((()=>{const d=[],p=l.getReverseIterator();for(;p.hasNext();){const g=p.getNext(),y=g.key,b=g.value,E=ik();b.forEach((T=>{if(!u.has(T)){const L=hk(t.get(T),i.get(T));L!==null&&E.set(T,L),u=u.add(T)}})),d.push(this.documentOverlayCache.saveOverlays(e,y,E))}return Te.waitFor(d)})).next((()=>i))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.recalculateAndSaveOverlays(e,i)))}getDocumentsMatchingQuery(e,t,i,l){return QR(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):ek(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i,l):this.getDocumentsMatchingCollectionQuery(e,t,i,l)}getNextDocuments(e,t,i,l){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,l).next((u=>{const d=l-u.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,l-u.size):Te.resolve(Ao());let p=gu,g=u;return d.next((y=>Te.forEach(y,((b,E)=>(p<E.largestBatchId&&(p=E.largestBatchId),u.get(b)?Te.resolve():this.remoteDocumentCache.getEntry(e,b).next((T=>{g=g.insert(b,T)}))))).next((()=>this.populateOverlays(e,y,u))).next((()=>this.computeViews(e,g,y,zt()))).next((b=>({batchId:p,changes:rk(b)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new lt(t)).next((i=>{let l=nu();return i.isFoundDocument()&&(l=l.insert(i.key,i)),l}))}getDocumentsMatchingCollectionGroupQuery(e,t,i,l){const u=t.collectionGroup;let d=nu();return this.indexManager.getCollectionParents(e,u).next((p=>Te.forEach(p,(g=>{const y=(function(E,T){return new sc(T,null,E.explicitOrderBy.slice(),E.filters.slice(),E.limit,E.limitType,E.startAt,E.endAt)})(t,g.child(u));return this.getDocumentsMatchingCollectionQuery(e,y,i,l).next((b=>{b.forEach(((E,T)=>{d=d.insert(E,T)}))}))})).next((()=>d))))}getDocumentsMatchingCollectionQuery(e,t,i,l){let u;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next((d=>(u=d,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,u,l)))).next((d=>{u.forEach(((g,y)=>{const b=y.getKey();d.get(b)===null&&(d=d.insert(b,Ws.newInvalidDocument(b)))}));let p=nu();return d.forEach(((g,y)=>{const b=u.get(g);b!==void 0&&uu(b.mutation,y,Cr.empty(),At.now()),pf(t,y)&&(p=p.insert(g,y))})),p}))}}class YI{constructor(e){this.serializer=e,this.Nr=new Map,this.Br=new Map}getBundleMetadata(e,t){return Te.resolve(this.Nr.get(t))}saveBundleMetadata(e,t){return this.Nr.set(t.id,(function(l){return{id:l.id,version:l.version,createTime:Ci(l.createTime)}})(t)),Te.resolve()}getNamedQuery(e,t){return Te.resolve(this.Br.get(t))}saveNamedQuery(e,t){return this.Br.set(t.name,(function(l){return{name:l.name,query:VI(l.bundledQuery),readTime:Ci(l.readTime)}})(t)),Te.resolve()}}class QI{constructor(){this.overlays=new Gn(lt.comparator),this.Lr=new Map}getOverlay(e,t){return Te.resolve(this.overlays.get(t))}getOverlays(e,t){const i=Ao();return Te.forEach(t,(l=>this.getOverlay(e,l).next((u=>{u!==null&&i.set(l,u)})))).next((()=>i))}saveOverlays(e,t,i){return i.forEach(((l,u)=>{this.bt(e,t,u)})),Te.resolve()}removeOverlaysForBatchId(e,t,i){const l=this.Lr.get(i);return l!==void 0&&(l.forEach((u=>this.overlays=this.overlays.remove(u))),this.Lr.delete(i)),Te.resolve()}getOverlaysForCollection(e,t,i){const l=Ao(),u=t.length+1,d=new lt(t.child("")),p=this.overlays.getIteratorFrom(d);for(;p.hasNext();){const g=p.getNext().value,y=g.getKey();if(!t.isPrefixOf(y.path))break;y.path.length===u&&g.largestBatchId>i&&l.set(g.getKey(),g)}return Te.resolve(l)}getOverlaysForCollectionGroup(e,t,i,l){let u=new Gn(((y,b)=>y-b));const d=this.overlays.getIterator();for(;d.hasNext();){const y=d.getNext().value;if(y.getKey().getCollectionGroup()===t&&y.largestBatchId>i){let b=u.get(y.largestBatchId);b===null&&(b=Ao(),u=u.insert(y.largestBatchId,b)),b.set(y.getKey(),y)}}const p=Ao(),g=u.getIterator();for(;g.hasNext()&&(g.getNext().value.forEach(((y,b)=>p.set(y,b))),!(p.size()>=l)););return Te.resolve(p)}bt(e,t,i){const l=this.overlays.get(i.key);if(l!==null){const d=this.Lr.get(l.largestBatchId).delete(i.key);this.Lr.set(l.largestBatchId,d)}this.overlays=this.overlays.insert(i.key,new mI(t,i));let u=this.Lr.get(t);u===void 0&&(u=zt(),this.Lr.set(t,u)),this.Lr.set(t,u.add(i.key))}}class XI{constructor(){this.sessionToken=Bs.EMPTY_BYTE_STRING}getSessionToken(e){return Te.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,Te.resolve()}}class Ny{constructor(){this.kr=new js(As.Kr),this.qr=new js(As.Ur)}isEmpty(){return this.kr.isEmpty()}addReference(e,t){const i=new As(e,t);this.kr=this.kr.add(i),this.qr=this.qr.add(i)}$r(e,t){e.forEach((i=>this.addReference(i,t)))}removeReference(e,t){this.Wr(new As(e,t))}Qr(e,t){e.forEach((i=>this.removeReference(i,t)))}Gr(e){const t=new lt(new An([])),i=new As(t,e),l=new As(t,e+1),u=[];return this.qr.forEachInRange([i,l],(d=>{this.Wr(d),u.push(d.key)})),u}zr(){this.kr.forEach((e=>this.Wr(e)))}Wr(e){this.kr=this.kr.delete(e),this.qr=this.qr.delete(e)}jr(e){const t=new lt(new An([])),i=new As(t,e),l=new As(t,e+1);let u=zt();return this.qr.forEachInRange([i,l],(d=>{u=u.add(d.key)})),u}containsKey(e){const t=new As(e,0),i=this.kr.firstAfterOrEqual(t);return i!==null&&e.isEqual(i.key)}}class As{constructor(e,t){this.key=e,this.Hr=t}static Kr(e,t){return lt.comparator(e.key,t.key)||Bt(e.Hr,t.Hr)}static Ur(e,t){return Bt(e.Hr,t.Hr)||lt.comparator(e.key,t.key)}}class JI{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Yn=1,this.Jr=new js(As.Kr)}checkEmpty(e){return Te.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,i,l){const u=this.Yn;this.Yn++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const d=new fI(u,t,i,l);this.mutationQueue.push(d);for(const p of l)this.Jr=this.Jr.add(new As(p.key,u)),this.indexManager.addToCollectionParentIndex(e,p.key.path.popLast());return Te.resolve(d)}lookupMutationBatch(e,t){return Te.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,l=this.Xr(i),u=l<0?0:l;return Te.resolve(this.mutationQueue.length>u?this.mutationQueue[u]:null)}getHighestUnacknowledgedBatchId(){return Te.resolve(this.mutationQueue.length===0?wy:this.Yn-1)}getAllMutationBatches(e){return Te.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const i=new As(t,0),l=new As(t,Number.POSITIVE_INFINITY),u=[];return this.Jr.forEachInRange([i,l],(d=>{const p=this.Zr(d.Hr);u.push(p)})),Te.resolve(u)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new js(Bt);return t.forEach((l=>{const u=new As(l,0),d=new As(l,Number.POSITIVE_INFINITY);this.Jr.forEachInRange([u,d],(p=>{i=i.add(p.Hr)}))})),Te.resolve(this.Yr(i))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,l=i.length+1;let u=i;lt.isDocumentKey(u)||(u=u.child(""));const d=new As(new lt(u),0);let p=new js(Bt);return this.Jr.forEachWhile((g=>{const y=g.key.path;return!!i.isPrefixOf(y)&&(y.length===l&&(p=p.add(g.Hr)),!0)}),d),Te.resolve(this.Yr(p))}Yr(e){const t=[];return e.forEach((i=>{const l=this.Zr(i);l!==null&&t.push(l)})),t}removeMutationBatch(e,t){hn(this.ei(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.Jr;return Te.forEach(t.mutations,(l=>{const u=new As(l.key,t.batchId);return i=i.delete(u),this.referenceDelegate.markPotentiallyOrphaned(e,l.key)})).next((()=>{this.Jr=i}))}nr(e){}containsKey(e,t){const i=new As(t,0),l=this.Jr.firstAfterOrEqual(i);return Te.resolve(t.isEqual(l&&l.key))}performConsistencyCheck(e){return this.mutationQueue.length,Te.resolve()}ei(e,t){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class ZI{constructor(e){this.ti=e,this.docs=(function(){return new Gn(lt.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const i=t.key,l=this.docs.get(i),u=l?l.size:0,d=this.ti(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:d}),this.size+=d-u,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const i=this.docs.get(t);return Te.resolve(i?i.document.mutableCopy():Ws.newInvalidDocument(t))}getEntries(e,t){let i=ca();return t.forEach((l=>{const u=this.docs.get(l);i=i.insert(l,u?u.document.mutableCopy():Ws.newInvalidDocument(l))})),Te.resolve(i)}getDocumentsMatchingQuery(e,t,i,l){let u=ca();const d=t.path,p=new lt(d.child("__id-9223372036854775808__")),g=this.docs.getIteratorFrom(p);for(;g.hasNext();){const{key:y,value:{document:b}}=g.getNext();if(!d.isPrefixOf(y.path))break;y.path.length>d.length+1||jR(TR(b),i)<=0||(l.has(b.key)||pf(t,b))&&(u=u.insert(b.key,b.mutableCopy()))}return Te.resolve(u)}getAllFromCollectionGroup(e,t,i,l){wt(9500)}ni(e,t){return Te.forEach(this.docs,(i=>t(i)))}newChangeBuffer(e){return new eM(this)}getSize(e){return Te.resolve(this.size)}}class eM extends WI{constructor(e){super(),this.Mr=e}applyChanges(e){const t=[];return this.changes.forEach(((i,l)=>{l.isValidDocument()?t.push(this.Mr.addEntry(e,l)):this.Mr.removeEntry(i)})),Te.waitFor(t)}getFromCache(e,t){return this.Mr.getEntry(e,t)}getAllFromCache(e,t){return this.Mr.getEntries(e,t)}}class tM{constructor(e){this.persistence=e,this.ri=new Ko((t=>ky(t)),Ey),this.lastRemoteSnapshotVersion=_t.min(),this.highestTargetId=0,this.ii=0,this.si=new Ny,this.targetCount=0,this.oi=Kl._r()}forEachTarget(e,t){return this.ri.forEach(((i,l)=>t(l))),Te.resolve()}getLastRemoteSnapshotVersion(e){return Te.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Te.resolve(this.ii)}allocateTargetId(e){return this.highestTargetId=this.oi.next(),Te.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.ii&&(this.ii=t),Te.resolve()}lr(e){this.ri.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.oi=new Kl(t),this.highestTargetId=t),e.sequenceNumber>this.ii&&(this.ii=e.sequenceNumber)}addTargetData(e,t){return this.lr(t),this.targetCount+=1,Te.resolve()}updateTargetData(e,t){return this.lr(t),Te.resolve()}removeTargetData(e,t){return this.ri.delete(t.target),this.si.Gr(t.targetId),this.targetCount-=1,Te.resolve()}removeTargets(e,t,i){let l=0;const u=[];return this.ri.forEach(((d,p)=>{p.sequenceNumber<=t&&i.get(p.targetId)===null&&(this.ri.delete(d),u.push(this.removeMatchingKeysForTargetId(e,p.targetId)),l++)})),Te.waitFor(u).next((()=>l))}getTargetCount(e){return Te.resolve(this.targetCount)}getTargetData(e,t){const i=this.ri.get(t)||null;return Te.resolve(i)}addMatchingKeys(e,t,i){return this.si.$r(t,i),Te.resolve()}removeMatchingKeys(e,t,i){this.si.Qr(t,i);const l=this.persistence.referenceDelegate,u=[];return l&&t.forEach((d=>{u.push(l.markPotentiallyOrphaned(e,d))})),Te.waitFor(u)}removeMatchingKeysForTargetId(e,t){return this.si.Gr(t),Te.resolve()}getMatchingKeysForTargetId(e,t){const i=this.si.jr(t);return Te.resolve(i)}containsKey(e,t){return Te.resolve(this.si.containsKey(t))}}class jk{constructor(e,t){this._i={},this.overlays={},this.ai=new uf(0),this.ui=!1,this.ui=!0,this.ci=new XI,this.referenceDelegate=e(this),this.li=new tM(this),this.indexManager=new UI,this.remoteDocumentCache=(function(l){return new ZI(l)})((i=>this.referenceDelegate.hi(i))),this.serializer=new PI(t),this.Pi=new YI(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ui=!1,Promise.resolve()}get started(){return this.ui}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new QI,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this._i[e.toKey()];return i||(i=new JI(t,this.referenceDelegate),this._i[e.toKey()]=i),i}getGlobalsCache(){return this.ci}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Pi}runTransaction(e,t,i){Ke("MemoryPersistence","Starting transaction:",e);const l=new nM(this.ai.next());return this.referenceDelegate.Ti(),i(l).next((u=>this.referenceDelegate.Ii(l).next((()=>u)))).toPromise().then((u=>(l.raiseOnCommittedEvent(),u)))}Ei(e,t){return Te.or(Object.values(this._i).map((i=>()=>i.containsKey(e,t))))}}class nM extends CR{constructor(e){super(),this.currentSequenceNumber=e}}class Ay{constructor(e){this.persistence=e,this.Ri=new Ny,this.Ai=null}static Vi(e){return new Ay(e)}get di(){if(this.Ai)return this.Ai;throw wt(60996)}addReference(e,t,i){return this.Ri.addReference(i,t),this.di.delete(i.toString()),Te.resolve()}removeReference(e,t,i){return this.Ri.removeReference(i,t),this.di.add(i.toString()),Te.resolve()}markPotentiallyOrphaned(e,t){return this.di.add(t.toString()),Te.resolve()}removeTarget(e,t){this.Ri.Gr(t.targetId).forEach((l=>this.di.add(l.toString())));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next((l=>{l.forEach((u=>this.di.add(u.toString())))})).next((()=>i.removeTargetData(e,t)))}Ti(){this.Ai=new Set}Ii(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Te.forEach(this.di,(i=>{const l=lt.fromPath(i);return this.mi(e,l).next((u=>{u||t.removeEntry(l,_t.min())}))})).next((()=>(this.Ai=null,t.apply(e))))}updateLimboDocument(e,t){return this.mi(e,t).next((i=>{i?this.di.delete(t.toString()):this.di.add(t.toString())}))}hi(e){return 0}mi(e,t){return Te.or([()=>Te.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}}class Kh{constructor(e,t){this.persistence=e,this.fi=new Ko((i=>RR(i.path)),((i,l)=>i.isEqual(l))),this.garbageCollector=$I(this,t)}static Vi(e,t){return new Kh(e,t)}Ti(){}Ii(e){return Te.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}dr(e){const t=this.pr(e);return this.persistence.getTargetCache().getTargetCount(e).next((i=>t.next((l=>i+l))))}pr(e){let t=0;return this.mr(e,(i=>{t++})).next((()=>t))}mr(e,t){return Te.forEach(this.fi,((i,l)=>this.wr(e,i,l).next((u=>u?Te.resolve():t(l)))))}removeTargets(e,t,i){return this.persistence.getTargetCache().removeTargets(e,t,i)}removeOrphanedDocuments(e,t){let i=0;const l=this.persistence.getRemoteDocumentCache(),u=l.newChangeBuffer();return l.ni(e,(d=>this.wr(e,d,t).next((p=>{p||(i++,u.removeEntry(d,_t.min()))})))).next((()=>u.apply(e))).next((()=>i))}markPotentiallyOrphaned(e,t){return this.fi.set(t,e.currentSequenceNumber),Te.resolve()}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,i)}addReference(e,t,i){return this.fi.set(i,e.currentSequenceNumber),Te.resolve()}removeReference(e,t,i){return this.fi.set(i,e.currentSequenceNumber),Te.resolve()}updateLimboDocument(e,t){return this.fi.set(t,e.currentSequenceNumber),Te.resolve()}hi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=jh(e.data.value)),t}wr(e,t,i){return Te.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const l=this.fi.get(t);return Te.resolve(l!==void 0&&l>i)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class Ry{constructor(e,t,i,l){this.targetId=e,this.fromCache=t,this.Ts=i,this.Is=l}static Es(e,t){let i=zt(),l=zt();for(const u of t.docChanges)switch(u.type){case 0:i=i.add(u.doc.key);break;case 1:l=l.add(u.doc.key)}return new Ry(e,t.fromCache,i,l)}}class sM{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class rM{constructor(){this.Rs=!1,this.As=!1,this.Vs=100,this.ds=(function(){return MC()?8:NR(Gs())>0?6:4})()}initialize(e,t){this.fs=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,i,l){const u={result:null};return this.gs(e,t).next((d=>{u.result=d})).next((()=>{if(!u.result)return this.ps(e,t,l,i).next((d=>{u.result=d}))})).next((()=>{if(u.result)return;const d=new sM;return this.ys(e,t,d).next((p=>{if(u.result=p,this.As)return this.ws(e,t,d,p.size)}))})).next((()=>u.result))}ws(e,t,i,l){return i.documentReadCount<this.Vs?(Il()<=Ut.DEBUG&&Ke("QueryEngine","SDK will not create cache indexes for query:",Ml(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),Te.resolve()):(Il()<=Ut.DEBUG&&Ke("QueryEngine","Query:",Ml(t),"scans",i.documentReadCount,"local documents and returns",l,"documents as results."),i.documentReadCount>this.ds*l?(Il()<=Ut.DEBUG&&Ke("QueryEngine","The SDK decides to create cache indexes for query:",Ml(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Si(t))):Te.resolve())}gs(e,t){if(ew(t))return Te.resolve(null);let i=Si(t);return this.indexManager.getIndexType(e,i).next((l=>l===0?null:(t.limit!==null&&l===1&&(t=Wh(t,null,"F"),i=Si(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next((u=>{const d=zt(...u);return this.fs.getDocuments(e,d).next((p=>this.indexManager.getMinOffset(e,i).next((g=>{const y=this.bs(t,p);return this.Ss(t,y,d,g.readTime)?this.gs(e,Wh(t,null,"F")):this.Ds(e,y,t,g)}))))})))))}ps(e,t,i,l){return ew(t)||l.isEqual(_t.min())?Te.resolve(null):this.fs.getDocuments(e,i).next((u=>{const d=this.bs(t,u);return this.Ss(t,d,i,l)?Te.resolve(null):(Il()<=Ut.DEBUG&&Ke("QueryEngine","Re-using previous result from %s to execute query: %s",l.toString(),Ml(t)),this.Ds(e,d,t,ER(l,gu)).next((p=>p)))}))}bs(e,t){let i=new js(nk(e));return t.forEach(((l,u)=>{pf(e,u)&&(i=i.add(u))})),i}Ss(e,t,i,l){if(e.limit===null)return!1;if(i.size!==t.size)return!0;const u=e.limitType==="F"?t.last():t.first();return!!u&&(u.hasPendingWrites||u.version.compareTo(l)>0)}ys(e,t,i){return Il()<=Ut.DEBUG&&Ke("QueryEngine","Using full collection scan to execute query:",Ml(t)),this.fs.getDocumentsMatchingQuery(e,t,Za.min(),i)}Ds(e,t,i,l){return this.fs.getDocumentsMatchingQuery(e,i,l).next((u=>(t.forEach((d=>{u=u.insert(d.key,d)})),u)))}}const Iy="LocalStore",iM=3e8;class aM{constructor(e,t,i,l){this.persistence=e,this.Cs=t,this.serializer=l,this.vs=new Gn(Bt),this.Fs=new Ko((u=>ky(u)),Ey),this.Ms=new Map,this.xs=e.getRemoteDocumentCache(),this.li=e.getTargetCache(),this.Pi=e.getBundleCache(),this.Os(i)}Os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new KI(this.xs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.xs.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.vs)))}}function oM(s,e,t,i){return new aM(s,e,t,i)}async function Sk(s,e){const t=Et(s);return await t.persistence.runTransaction("Handle user change","readonly",(i=>{let l;return t.mutationQueue.getAllMutationBatches(i).next((u=>(l=u,t.Os(e),t.mutationQueue.getAllMutationBatches(i)))).next((u=>{const d=[],p=[];let g=zt();for(const y of l){d.push(y.batchId);for(const b of y.mutations)g=g.add(b.key)}for(const y of u){p.push(y.batchId);for(const b of y.mutations)g=g.add(b.key)}return t.localDocuments.getDocuments(i,g).next((y=>({Ns:y,removedBatchIds:d,addedBatchIds:p})))}))}))}function lM(s,e){const t=Et(s);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(i=>{const l=e.batch.keys(),u=t.xs.newChangeBuffer({trackRemovals:!0});return(function(p,g,y,b){const E=y.batch,T=E.keys();let L=Te.resolve();return T.forEach((W=>{L=L.next((()=>b.getEntry(g,W))).next((H=>{const B=y.docVersions.get(W);hn(B!==null,48541),H.version.compareTo(B)<0&&(E.applyToRemoteDocument(H,y),H.isValidDocument()&&(H.setReadTime(y.commitVersion),b.addEntry(H)))}))})),L.next((()=>p.mutationQueue.removeMutationBatch(g,E)))})(t,i,e,u).next((()=>u.apply(i))).next((()=>t.mutationQueue.performConsistencyCheck(i))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(i,l,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,(function(p){let g=zt();for(let y=0;y<p.mutationResults.length;++y)p.mutationResults[y].transformResults.length>0&&(g=g.add(p.batch.mutations[y].key));return g})(e)))).next((()=>t.localDocuments.getDocuments(i,l)))}))}function Ck(s){const e=Et(s);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.li.getLastRemoteSnapshotVersion(t)))}function cM(s,e){const t=Et(s),i=e.snapshotVersion;let l=t.vs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(u=>{const d=t.xs.newChangeBuffer({trackRemovals:!0});l=t.vs;const p=[];e.targetChanges.forEach(((b,E)=>{const T=l.get(E);if(!T)return;p.push(t.li.removeMatchingKeys(u,b.removedDocuments,E).next((()=>t.li.addMatchingKeys(u,b.addedDocuments,E))));let L=T.withSequenceNumber(u.currentSequenceNumber);e.targetMismatches.get(E)!==null?L=L.withResumeToken(Bs.EMPTY_BYTE_STRING,_t.min()).withLastLimboFreeSnapshotVersion(_t.min()):b.resumeToken.approximateByteSize()>0&&(L=L.withResumeToken(b.resumeToken,i)),l=l.insert(E,L),(function(H,B,K){return H.resumeToken.approximateByteSize()===0||B.snapshotVersion.toMicroseconds()-H.snapshotVersion.toMicroseconds()>=iM?!0:K.addedDocuments.size+K.modifiedDocuments.size+K.removedDocuments.size>0})(T,L,b)&&p.push(t.li.updateTargetData(u,L))}));let g=ca(),y=zt();if(e.documentUpdates.forEach((b=>{e.resolvedLimboDocuments.has(b)&&p.push(t.persistence.referenceDelegate.updateLimboDocument(u,b))})),p.push(uM(u,d,e.documentUpdates).next((b=>{g=b.Bs,y=b.Ls}))),!i.isEqual(_t.min())){const b=t.li.getLastRemoteSnapshotVersion(u).next((E=>t.li.setTargetsMetadata(u,u.currentSequenceNumber,i)));p.push(b)}return Te.waitFor(p).next((()=>d.apply(u))).next((()=>t.localDocuments.getLocalViewOfDocuments(u,g,y))).next((()=>g))})).then((u=>(t.vs=l,u)))}function uM(s,e,t){let i=zt(),l=zt();return t.forEach((u=>i=i.add(u))),e.getEntries(s,i).next((u=>{let d=ca();return t.forEach(((p,g)=>{const y=u.get(p);g.isFoundDocument()!==y.isFoundDocument()&&(l=l.add(p)),g.isNoDocument()&&g.version.isEqual(_t.min())?(e.removeEntry(p,g.readTime),d=d.insert(p,g)):!y.isValidDocument()||g.version.compareTo(y.version)>0||g.version.compareTo(y.version)===0&&y.hasPendingWrites?(e.addEntry(g),d=d.insert(p,g)):Ke(Iy,"Ignoring outdated watch update for ",p,". Current version:",y.version," Watch version:",g.version)})),{Bs:d,Ls:l}}))}function dM(s,e){const t=Et(s);return t.persistence.runTransaction("Get next mutation batch","readonly",(i=>(e===void 0&&(e=wy),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e))))}function hM(s,e){const t=Et(s);return t.persistence.runTransaction("Allocate target","readwrite",(i=>{let l;return t.li.getTargetData(i,e).next((u=>u?(l=u,Te.resolve(l)):t.li.allocateTargetId(i).next((d=>(l=new Wa(e,d,"TargetPurposeListen",i.currentSequenceNumber),t.li.addTargetData(i,l).next((()=>l)))))))})).then((i=>{const l=t.vs.get(i.targetId);return(l===null||i.snapshotVersion.compareTo(l.snapshotVersion)>0)&&(t.vs=t.vs.insert(i.targetId,i),t.Fs.set(e,i.targetId)),i}))}async function Vg(s,e,t){const i=Et(s),l=i.vs.get(e),u=t?"readwrite":"readwrite-primary";try{t||await i.persistence.runTransaction("Release target",u,(d=>i.persistence.referenceDelegate.removeTarget(d,l)))}catch(d){if(!nc(d))throw d;Ke(Iy,`Failed to update sequence numbers for target ${e}: ${d}`)}i.vs=i.vs.remove(e),i.Fs.delete(l.target)}function fw(s,e,t){const i=Et(s);let l=_t.min(),u=zt();return i.persistence.runTransaction("Execute query","readwrite",(d=>(function(g,y,b){const E=Et(g),T=E.Fs.get(b);return T!==void 0?Te.resolve(E.vs.get(T)):E.li.getTargetData(y,b)})(i,d,Si(e)).next((p=>{if(p)return l=p.lastLimboFreeSnapshotVersion,i.li.getMatchingKeysForTargetId(d,p.targetId).next((g=>{u=g}))})).next((()=>i.Cs.getDocumentsMatchingQuery(d,e,t?l:_t.min(),t?u:zt()))).next((p=>(fM(i,ZR(e),p),{documents:p,ks:u})))))}function fM(s,e,t){let i=s.Ms.get(e)||_t.min();t.forEach(((l,u)=>{u.readTime.compareTo(i)>0&&(i=u.readTime)})),s.Ms.set(e,i)}class mw{constructor(){this.activeTargetIds=iI()}Qs(e){this.activeTargetIds=this.activeTargetIds.add(e)}Gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class mM{constructor(){this.vo=new mw,this.Fo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e,t=!0){return t&&this.vo.Qs(e),this.Fo[e]||"not-current"}updateQueryState(e,t,i){this.Fo[e]=t}removeLocalQueryTarget(e){this.vo.Gs(e)}isLocalQueryTarget(e){return this.vo.activeTargetIds.has(e)}clearQueryState(e){delete this.Fo[e]}getAllActiveQueryTargets(){return this.vo.activeTargetIds}isActiveQueryTarget(e){return this.vo.activeTargetIds.has(e)}start(){return this.vo=new mw,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class pM{Mo(e){}shutdown(){}}const pw="ConnectivityMonitor";class gw{constructor(){this.xo=()=>this.Oo(),this.No=()=>this.Bo(),this.Lo=[],this.ko()}Mo(e){this.Lo.push(e)}shutdown(){window.removeEventListener("online",this.xo),window.removeEventListener("offline",this.No)}ko(){window.addEventListener("online",this.xo),window.addEventListener("offline",this.No)}Oo(){Ke(pw,"Network connectivity changed: AVAILABLE");for(const e of this.Lo)e(0)}Bo(){Ke(pw,"Network connectivity changed: UNAVAILABLE");for(const e of this.Lo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let uh=null;function Ug(){return uh===null?uh=(function(){return 268435456+Math.round(2147483648*Math.random())})():uh++,"0x"+uh.toString(16)}const Hp="RestConnection",gM={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery",ExecutePipeline:"executePipeline"};class yM{get Ko(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),l=encodeURIComponent(this.databaseId.database);this.qo=t+"://"+e.host,this.Uo=`projects/${i}/databases/${l}`,this.$o=this.databaseId.database===qh?`project_id=${i}`:`project_id=${i}&database_id=${l}`}Wo(e,t,i,l,u){const d=Ug(),p=this.Qo(e,t.toUriEncodedString());Ke(Hp,`Sending RPC '${e}' ${d}:`,p,i);const g={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.$o};this.Go(g,l,u);const{host:y}=new URL(p),b=io(y);return this.zo(e,p,g,i,b).then((E=>(Ke(Hp,`Received RPC '${e}' ${d}: `,E),E)),(E=>{throw Fl(Hp,`RPC '${e}' ${d} failed with error: `,E,"url: ",p,"request:",i),E}))}jo(e,t,i,l,u,d){return this.Wo(e,t,i,l,u)}Go(e,t,i){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+ec})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((l,u)=>e[u]=l)),i&&i.headers.forEach(((l,u)=>e[u]=l))}Qo(e,t){const i=gM[e];let l=`${this.qo}/v1/${t}:${i}`;return this.databaseInfo.apiKey&&(l=`${l}?key=${encodeURIComponent(this.databaseInfo.apiKey)}`),l}terminate(){}}class vM{constructor(e){this.Ho=e.Ho,this.Jo=e.Jo}Zo(e){this.Xo=e}Yo(e){this.e_=e}t_(e){this.n_=e}onMessage(e){this.r_=e}close(){this.Jo()}send(e){this.Ho(e)}i_(){this.Xo()}s_(){this.e_()}o_(e){this.n_(e)}__(e){this.r_(e)}}const Hs="WebChannelConnection",Gc=(s,e,t)=>{s.listen(e,(i=>{try{t(i)}catch(l){setTimeout((()=>{throw l}),0)}}))};class Bl extends yM{constructor(e){super(e),this.a_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}static u_(){if(!Bl.c_){const e=I_();Gc(e,R_.STAT_EVENT,(t=>{t.stat===Sg.PROXY?Ke(Hs,"STAT_EVENT: detected buffering proxy"):t.stat===Sg.NOPROXY&&Ke(Hs,"STAT_EVENT: detected no buffering proxy")})),Bl.c_=!0}}zo(e,t,i,l,u){const d=Ug();return new Promise(((p,g)=>{const y=new N_;y.setWithCredentials(!0),y.listenOnce(A_.COMPLETE,(()=>{try{switch(y.getLastErrorCode()){case Th.NO_ERROR:const E=y.getResponseJson();Ke(Hs,`XHR for RPC '${e}' ${d} received:`,JSON.stringify(E)),p(E);break;case Th.TIMEOUT:Ke(Hs,`RPC '${e}' ${d} timed out`),g(new ze(ve.DEADLINE_EXCEEDED,"Request time out"));break;case Th.HTTP_ERROR:const T=y.getStatus();if(Ke(Hs,`RPC '${e}' ${d} failed with status:`,T,"response text:",y.getResponseText()),T>0){let L=y.getResponseJson();Array.isArray(L)&&(L=L[0]);const W=L?.error;if(W&&W.status&&W.message){const H=(function(K){const G=K.toLowerCase().replace(/_/g,"-");return Object.values(ve).indexOf(G)>=0?G:ve.UNKNOWN})(W.status);g(new ze(H,W.message))}else g(new ze(ve.UNKNOWN,"Server responded with status "+y.getStatus()))}else g(new ze(ve.UNAVAILABLE,"Connection failed."));break;default:wt(9055,{l_:e,streamId:d,h_:y.getLastErrorCode(),P_:y.getLastError()})}}finally{Ke(Hs,`RPC '${e}' ${d} completed.`)}}));const b=JSON.stringify(l);Ke(Hs,`RPC '${e}' ${d} sending request:`,l),y.send(t,"POST",b,i,15)}))}T_(e,t,i){const l=Ug(),u=[this.qo,"/","google.firestore.v1.Firestore","/",e,"/channel"],d=this.createWebChannelTransport(),p={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},g=this.longPollingOptions.timeoutSeconds;g!==void 0&&(p.longPollingTimeout=Math.round(1e3*g)),this.useFetchStreams&&(p.useFetchStreams=!0),this.Go(p.initMessageHeaders,t,i),p.encodeInitMessageHeaders=!0;const y=u.join("");Ke(Hs,`Creating RPC '${e}' stream ${l}: ${y}`,p);const b=d.createWebChannel(y,p);this.I_(b);let E=!1,T=!1;const L=new vM({Ho:W=>{T?Ke(Hs,`Not sending because RPC '${e}' stream ${l} is closed:`,W):(E||(Ke(Hs,`Opening RPC '${e}' stream ${l} transport.`),b.open(),E=!0),Ke(Hs,`RPC '${e}' stream ${l} sending:`,W),b.send(W))},Jo:()=>b.close()});return Gc(b,tu.EventType.OPEN,(()=>{T||(Ke(Hs,`RPC '${e}' stream ${l} transport opened.`),L.i_())})),Gc(b,tu.EventType.CLOSE,(()=>{T||(T=!0,Ke(Hs,`RPC '${e}' stream ${l} transport closed`),L.o_(),this.E_(b))})),Gc(b,tu.EventType.ERROR,(W=>{T||(T=!0,Fl(Hs,`RPC '${e}' stream ${l} transport errored. Name:`,W.name,"Message:",W.message),L.o_(new ze(ve.UNAVAILABLE,"The operation could not be completed")))})),Gc(b,tu.EventType.MESSAGE,(W=>{if(!T){const H=W.data[0];hn(!!H,16349);const B=H,K=B?.error||B[0]?.error;if(K){Ke(Hs,`RPC '${e}' stream ${l} received error:`,K);const G=K.status;let Q=(function(ge){const C=ps[ge];if(C!==void 0)return mk(C)})(G),he=K.message;Q===void 0&&(Q=ve.INTERNAL,he="Unknown error status: "+G+" with message "+K.message),T=!0,L.o_(new ze(Q,he)),b.close()}else Ke(Hs,`RPC '${e}' stream ${l} received:`,H),L.__(H)}})),Bl.u_(),setTimeout((()=>{L.s_()}),0),L}terminate(){this.a_.forEach((e=>e.close())),this.a_=[]}I_(e){this.a_.push(e)}E_(e){this.a_=this.a_.filter((t=>t===e))}Go(e,t,i){super.Go(e,t,i),this.databaseInfo.apiKey&&(e["x-goog-api-key"]=this.databaseInfo.apiKey)}createWebChannelTransport(){return M_()}}function bM(s){return new Bl(s)}function $p(){return typeof document<"u"?document:null}function xf(s){return new kI(s,!0)}Bl.c_=!1;class Nk{constructor(e,t,i=1e3,l=1.5,u=6e4){this.Ci=e,this.timerId=t,this.R_=i,this.A_=l,this.V_=u,this.d_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.d_=0}g_(){this.d_=this.V_}p_(e){this.cancel();const t=Math.floor(this.d_+this.y_()),i=Math.max(0,Date.now()-this.f_),l=Math.max(0,t-i);l>0&&Ke("ExponentialBackoff",`Backing off for ${l} ms (base delay: ${this.d_} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.m_=this.Ci.enqueueAfterDelay(this.timerId,l,(()=>(this.f_=Date.now(),e()))),this.d_*=this.A_,this.d_<this.R_&&(this.d_=this.R_),this.d_>this.V_&&(this.d_=this.V_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.d_}}const yw="PersistentStream";class Ak{constructor(e,t,i,l,u,d,p,g){this.Ci=e,this.b_=i,this.S_=l,this.connection=u,this.authCredentialsProvider=d,this.appCheckCredentialsProvider=p,this.listener=g,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new Nk(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Ci.enqueueAfterDelay(this.b_,6e4,(()=>this.k_())))}K_(e){this.q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===ve.RESOURCE_EXHAUSTED?(la(t.toString()),la("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===ve.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.t_(t)}W_(){}auth(){this.state=1;const e=this.Q_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([i,l])=>{this.D_===t&&this.G_(i,l)}),(i=>{e((()=>{const l=new ze(ve.UNKNOWN,"Fetching auth token failed: "+i.message);return this.z_(l)}))}))}G_(e,t){const i=this.Q_(this.D_);this.stream=this.j_(e,t),this.stream.Zo((()=>{i((()=>this.listener.Zo()))})),this.stream.Yo((()=>{i((()=>(this.state=2,this.v_=this.Ci.enqueueAfterDelay(this.S_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.Yo())))})),this.stream.t_((l=>{i((()=>this.z_(l)))})),this.stream.onMessage((l=>{i((()=>++this.F_==1?this.H_(l):this.onNext(l)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return Ke(yw,`close with error: ${e}`),this.stream=null,this.close(4,e)}Q_(e){return t=>{this.Ci.enqueueAndForget((()=>this.D_===e?t():(Ke(yw,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class wM extends Ak{constructor(e,t,i,l,u,d){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,i,l,d),this.serializer=u}j_(e,t){return this.connection.T_("Listen",e,t)}H_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=jI(this.serializer,e),i=(function(u){if(!("targetChange"in u))return _t.min();const d=u.targetChange;return d.targetIds&&d.targetIds.length?_t.min():d.readTime?Ci(d.readTime):_t.min()})(e);return this.listener.J_(t,i)}Z_(e){const t={};t.database=Pg(this.serializer),t.addTarget=(function(u,d){let p;const g=d.target;if(p=Ig(g)?{documents:NI(u,g)}:{query:AI(u,g).ft},p.targetId=d.targetId,d.resumeToken.approximateByteSize()>0){p.resumeToken=yk(u,d.resumeToken);const y=Dg(u,d.expectedCount);y!==null&&(p.expectedCount=y)}else if(d.snapshotVersion.compareTo(_t.min())>0){p.readTime=Gh(u,d.snapshotVersion.toTimestamp());const y=Dg(u,d.expectedCount);y!==null&&(p.expectedCount=y)}return p})(this.serializer,e);const i=II(this.serializer,e);i&&(t.labels=i),this.K_(t)}X_(e){const t={};t.database=Pg(this.serializer),t.removeTarget=e,this.K_(t)}}class xM extends Ak{constructor(e,t,i,l,u,d){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,l,d),this.serializer=u}get Y_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.Y_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}H_(e){return hn(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,hn(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){hn(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=CI(e.writeResults,e.commitTime),i=Ci(e.commitTime);return this.listener.na(i,t)}ra(){const e={};e.database=Pg(this.serializer),this.K_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((i=>SI(this.serializer,i)))};this.K_(t)}}class _M{}class kM extends _M{constructor(e,t,i,l){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=l,this.ia=!1}sa(){if(this.ia)throw new ze(ve.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,i,l){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([u,d])=>this.connection.Wo(e,Lg(t,i),l,u,d))).catch((u=>{throw u.name==="FirebaseError"?(u.code===ve.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),u):new ze(ve.UNKNOWN,u.toString())}))}jo(e,t,i,l,u){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([d,p])=>this.connection.jo(e,Lg(t,i),l,d,p,u))).catch((d=>{throw d.name==="FirebaseError"?(d.code===ve.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),d):new ze(ve.UNKNOWN,d.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}function EM(s,e,t,i){return new kM(s,e,t,i)}class TM{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(la(t),this.aa=!1):Ke("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const Bo="RemoteStore";class jM{constructor(e,t,i,l,u){this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.Ra=[],this.Aa=u,this.Aa.Mo((d=>{i.enqueueAndForget((async()=>{Yo(this)&&(Ke(Bo,"Restarting streams for network reachability change."),await(async function(g){const y=Et(g);y.Ea.add(4),await Vu(y),y.Va.set("Unknown"),y.Ea.delete(4),await _f(y)})(this))}))})),this.Va=new TM(i,l)}}async function _f(s){if(Yo(s))for(const e of s.Ra)await e(!0)}async function Vu(s){for(const e of s.Ra)await e(!1)}function Rk(s,e){const t=Et(s);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),Oy(t)?Ly(t):rc(t).O_()&&Dy(t,e))}function My(s,e){const t=Et(s),i=rc(t);t.Ia.delete(e),i.O_()&&Ik(t,e),t.Ia.size===0&&(i.O_()?i.L_():Yo(t)&&t.Va.set("Unknown"))}function Dy(s,e){if(s.da.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(_t.min())>0){const t=s.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}rc(s).Z_(e)}function Ik(s,e){s.da.$e(e),rc(s).X_(e)}function Ly(s){s.da=new bI({getRemoteKeysForTarget:e=>s.remoteSyncer.getRemoteKeysForTarget(e),At:e=>s.Ia.get(e)||null,ht:()=>s.datastore.serializer.databaseId}),rc(s).start(),s.Va.ua()}function Oy(s){return Yo(s)&&!rc(s).x_()&&s.Ia.size>0}function Yo(s){return Et(s).Ea.size===0}function Mk(s){s.da=void 0}async function SM(s){s.Va.set("Online")}async function CM(s){s.Ia.forEach(((e,t)=>{Dy(s,e)}))}async function NM(s,e){Mk(s),Oy(s)?(s.Va.ha(e),Ly(s)):s.Va.set("Unknown")}async function AM(s,e,t){if(s.Va.set("Online"),e instanceof gk&&e.state===2&&e.cause)try{await(async function(l,u){const d=u.cause;for(const p of u.targetIds)l.Ia.has(p)&&(await l.remoteSyncer.rejectListen(p,d),l.Ia.delete(p),l.da.removeTarget(p))})(s,e)}catch(i){Ke(Bo,"Failed to remove targets %s: %s ",e.targetIds.join(","),i),await Yh(s,i)}else if(e instanceof Nh?s.da.Xe(e):e instanceof pk?s.da.st(e):s.da.tt(e),!t.isEqual(_t.min()))try{const i=await Ck(s.localStore);t.compareTo(i)>=0&&await(function(u,d){const p=u.da.Tt(d);return p.targetChanges.forEach(((g,y)=>{if(g.resumeToken.approximateByteSize()>0){const b=u.Ia.get(y);b&&u.Ia.set(y,b.withResumeToken(g.resumeToken,d))}})),p.targetMismatches.forEach(((g,y)=>{const b=u.Ia.get(g);if(!b)return;u.Ia.set(g,b.withResumeToken(Bs.EMPTY_BYTE_STRING,b.snapshotVersion)),Ik(u,g);const E=new Wa(b.target,g,y,b.sequenceNumber);Dy(u,E)})),u.remoteSyncer.applyRemoteEvent(p)})(s,t)}catch(i){Ke(Bo,"Failed to raise snapshot:",i),await Yh(s,i)}}async function Yh(s,e,t){if(!nc(e))throw e;s.Ea.add(1),await Vu(s),s.Va.set("Offline"),t||(t=()=>Ck(s.localStore)),s.asyncQueue.enqueueRetryable((async()=>{Ke(Bo,"Retrying IndexedDB access"),await t(),s.Ea.delete(1),await _f(s)}))}function Dk(s,e){return e().catch((t=>Yh(s,t,e)))}async function kf(s){const e=Et(s),t=so(e);let i=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:wy;for(;RM(e);)try{const l=await dM(e.localStore,i);if(l===null){e.Ta.length===0&&t.L_();break}i=l.batchId,IM(e,l)}catch(l){await Yh(e,l)}Lk(e)&&Ok(e)}function RM(s){return Yo(s)&&s.Ta.length<10}function IM(s,e){s.Ta.push(e);const t=so(s);t.O_()&&t.Y_&&t.ea(e.mutations)}function Lk(s){return Yo(s)&&!so(s).x_()&&s.Ta.length>0}function Ok(s){so(s).start()}async function MM(s){so(s).ra()}async function DM(s){const e=so(s);for(const t of s.Ta)e.ea(t.mutations)}async function LM(s,e,t){const i=s.Ta.shift(),l=jy.from(i,e,t);await Dk(s,(()=>s.remoteSyncer.applySuccessfulWrite(l))),await kf(s)}async function OM(s,e){e&&so(s).Y_&&await(async function(i,l){if((function(d){return gI(d)&&d!==ve.ABORTED})(l.code)){const u=i.Ta.shift();so(i).B_(),await Dk(i,(()=>i.remoteSyncer.rejectFailedWrite(u.batchId,l))),await kf(i)}})(s,e),Lk(s)&&Ok(s)}async function vw(s,e){const t=Et(s);t.asyncQueue.verifyOperationInProgress(),Ke(Bo,"RemoteStore received new credentials");const i=Yo(t);t.Ea.add(3),await Vu(t),i&&t.Va.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await _f(t)}async function PM(s,e){const t=Et(s);e?(t.Ea.delete(2),await _f(t)):e||(t.Ea.add(2),await Vu(t),t.Va.set("Unknown"))}function rc(s){return s.ma||(s.ma=(function(t,i,l){const u=Et(t);return u.sa(),new wM(i,u.connection,u.authCredentials,u.appCheckCredentials,u.serializer,l)})(s.datastore,s.asyncQueue,{Zo:SM.bind(null,s),Yo:CM.bind(null,s),t_:NM.bind(null,s),J_:AM.bind(null,s)}),s.Ra.push((async e=>{e?(s.ma.B_(),Oy(s)?Ly(s):s.Va.set("Unknown")):(await s.ma.stop(),Mk(s))}))),s.ma}function so(s){return s.fa||(s.fa=(function(t,i,l){const u=Et(t);return u.sa(),new xM(i,u.connection,u.authCredentials,u.appCheckCredentials,u.serializer,l)})(s.datastore,s.asyncQueue,{Zo:()=>Promise.resolve(),Yo:MM.bind(null,s),t_:OM.bind(null,s),ta:DM.bind(null,s),na:LM.bind(null,s)}),s.Ra.push((async e=>{e?(s.fa.B_(),await kf(s)):(await s.fa.stop(),s.Ta.length>0&&(Ke(Bo,`Stopping write stream with ${s.Ta.length} pending writes`),s.Ta=[]))}))),s.fa}class Py{constructor(e,t,i,l,u){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=l,this.removalCallback=u,this.deferred=new sa,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((d=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,l,u){const d=Date.now()+i,p=new Py(e,t,d,l,u);return p.start(i),p}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new ze(ve.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Vy(s,e){if(la("AsyncQueue",`${e}: ${s}`),nc(s))return new ze(ve.UNAVAILABLE,`${e}: ${s}`);throw s}class zl{static emptySet(e){return new zl(e.comparator)}constructor(e){this.comparator=e?(t,i)=>e(t,i)||lt.comparator(t.key,i.key):(t,i)=>lt.comparator(t.key,i.key),this.keyedMap=nu(),this.sortedSet=new Gn(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,i)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof zl)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;t.hasNext();){const l=t.getNext().key,u=i.getNext().key;if(!l.isEqual(u))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const i=new zl;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=t,i}}class bw{constructor(){this.ga=new Gn(lt.comparator)}track(e){const t=e.doc.key,i=this.ga.get(t);i?e.type!==0&&i.type===3?this.ga=this.ga.insert(t,e):e.type===3&&i.type!==1?this.ga=this.ga.insert(t,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.ga=this.ga.remove(t):e.type===1&&i.type===2?this.ga=this.ga.insert(t,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):wt(63341,{Vt:e,pa:i}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,i)=>{e.push(i)})),e}}class Yl{constructor(e,t,i,l,u,d,p,g,y){this.query=e,this.docs=t,this.oldDocs=i,this.docChanges=l,this.mutatedKeys=u,this.fromCache=d,this.syncStateChanged=p,this.excludesMetadataChanges=g,this.hasCachedResults=y}static fromInitialDocuments(e,t,i,l,u){const d=[];return t.forEach((p=>{d.push({type:0,doc:p})})),new Yl(e,t,zl.emptySet(t),d,i,l,!0,!1,u)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&mf(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,i=e.docChanges;if(t.length!==i.length)return!1;for(let l=0;l<t.length;l++)if(t[l].type!==i[l].type||!t[l].doc.isEqual(i[l].doc))return!1;return!0}}class VM{constructor(){this.wa=void 0,this.ba=[]}Sa(){return this.ba.some((e=>e.Da()))}}class UM{constructor(){this.queries=ww(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,i){const l=Et(t),u=l.queries;l.queries=ww(),u.forEach(((d,p)=>{for(const g of p.ba)g.onError(i)}))})(this,new ze(ve.ABORTED,"Firestore shutting down"))}}function ww(){return new Ko((s=>tk(s)),mf)}async function Uy(s,e){const t=Et(s);let i=3;const l=e.query;let u=t.queries.get(l);u?!u.Sa()&&e.Da()&&(i=2):(u=new VM,i=e.Da()?0:1);try{switch(i){case 0:u.wa=await t.onListen(l,!0);break;case 1:u.wa=await t.onListen(l,!1);break;case 2:await t.onFirstRemoteStoreListen(l)}}catch(d){const p=Vy(d,`Initialization of query '${Ml(e.query)}' failed`);return void e.onError(p)}t.queries.set(l,u),u.ba.push(e),e.va(t.onlineState),u.wa&&e.Fa(u.wa)&&zy(t)}async function By(s,e){const t=Et(s),i=e.query;let l=3;const u=t.queries.get(i);if(u){const d=u.ba.indexOf(e);d>=0&&(u.ba.splice(d,1),u.ba.length===0?l=e.Da()?0:1:!u.Sa()&&e.Da()&&(l=2))}switch(l){case 0:return t.queries.delete(i),t.onUnlisten(i,!0);case 1:return t.queries.delete(i),t.onUnlisten(i,!1);case 2:return t.onLastRemoteStoreUnlisten(i);default:return}}function BM(s,e){const t=Et(s);let i=!1;for(const l of e){const u=l.query,d=t.queries.get(u);if(d){for(const p of d.ba)p.Fa(l)&&(i=!0);d.wa=l}}i&&zy(t)}function zM(s,e,t){const i=Et(s),l=i.queries.get(e);if(l)for(const u of l.ba)u.onError(t);i.queries.delete(e)}function zy(s){s.Ca.forEach((e=>{e.next()}))}var Bg,xw;(xw=Bg||(Bg={})).Ma="default",xw.Cache="cache";class Fy{constructor(e,t,i){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=i||{}}Fa(e){if(!this.options.includeMetadataChanges){const i=[];for(const l of e.docChanges)l.type!==3&&i.push(l);e=new Yl(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const i=t!=="Offline";return(!this.options.Ka||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=Yl.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Bg.Cache}}class Pk{constructor(e){this.key=e}}class Vk{constructor(e){this.key=e}}class FM{constructor(e,t){this.query=e,this.Za=t,this.Xa=null,this.hasCachedResults=!1,this.current=!1,this.Ya=zt(),this.mutatedKeys=zt(),this.eu=nk(e),this.tu=new zl(this.eu)}get nu(){return this.Za}ru(e,t){const i=t?t.iu:new bw,l=t?t.tu:this.tu;let u=t?t.mutatedKeys:this.mutatedKeys,d=l,p=!1;const g=this.query.limitType==="F"&&l.size===this.query.limit?l.last():null,y=this.query.limitType==="L"&&l.size===this.query.limit?l.first():null;if(e.inorderTraversal(((b,E)=>{const T=l.get(b),L=pf(this.query,E)?E:null,W=!!T&&this.mutatedKeys.has(T.key),H=!!L&&(L.hasLocalMutations||this.mutatedKeys.has(L.key)&&L.hasCommittedMutations);let B=!1;T&&L?T.data.isEqual(L.data)?W!==H&&(i.track({type:3,doc:L}),B=!0):this.su(T,L)||(i.track({type:2,doc:L}),B=!0,(g&&this.eu(L,g)>0||y&&this.eu(L,y)<0)&&(p=!0)):!T&&L?(i.track({type:0,doc:L}),B=!0):T&&!L&&(i.track({type:1,doc:T}),B=!0,(g||y)&&(p=!0)),B&&(L?(d=d.add(L),u=H?u.add(b):u.delete(b)):(d=d.delete(b),u=u.delete(b)))})),this.query.limit!==null)for(;d.size>this.query.limit;){const b=this.query.limitType==="F"?d.last():d.first();d=d.delete(b.key),u=u.delete(b.key),i.track({type:1,doc:b})}return{tu:d,iu:i,Ss:p,mutatedKeys:u}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,i,l){const u=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const d=e.iu.ya();d.sort(((b,E)=>(function(L,W){const H=B=>{switch(B){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return wt(20277,{Vt:B})}};return H(L)-H(W)})(b.type,E.type)||this.eu(b.doc,E.doc))),this.ou(i),l=l??!1;const p=t&&!l?this._u():[],g=this.Ya.size===0&&this.current&&!l?1:0,y=g!==this.Xa;return this.Xa=g,d.length!==0||y?{snapshot:new Yl(this.query,e.tu,u,d,e.mutatedKeys,g===0,y,!1,!!i&&i.resumeToken.approximateByteSize()>0),au:p}:{au:p}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new bw,mutatedKeys:this.mutatedKeys,Ss:!1},!1)):{au:[]}}uu(e){return!this.Za.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Za=this.Za.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Za=this.Za.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Ya;this.Ya=zt(),this.tu.forEach((i=>{this.uu(i.key)&&(this.Ya=this.Ya.add(i.key))}));const t=[];return e.forEach((i=>{this.Ya.has(i)||t.push(new Vk(i))})),this.Ya.forEach((i=>{e.has(i)||t.push(new Pk(i))})),t}cu(e){this.Za=e.ks,this.Ya=zt();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return Yl.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Xa===0,this.hasCachedResults)}}const qy="SyncEngine";class qM{constructor(e,t,i){this.query=e,this.targetId=t,this.view=i}}class HM{constructor(e){this.key=e,this.hu=!1}}class $M{constructor(e,t,i,l,u,d){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=l,this.currentUser=u,this.maxConcurrentLimboResolutions=d,this.Pu={},this.Tu=new Ko((p=>tk(p)),mf),this.Iu=new Map,this.Eu=new Set,this.Ru=new Gn(lt.comparator),this.Au=new Map,this.Vu=new Ny,this.du={},this.mu=new Map,this.fu=Kl.ar(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function WM(s,e,t=!0){const i=Hk(s);let l;const u=i.Tu.get(e);return u?(i.sharedClientState.addLocalQueryTarget(u.targetId),l=u.view.lu()):l=await Uk(i,e,t,!0),l}async function GM(s,e){const t=Hk(s);await Uk(t,e,!0,!1)}async function Uk(s,e,t,i){const l=await hM(s.localStore,Si(e)),u=l.targetId,d=s.sharedClientState.addLocalQueryTarget(u,t);let p;return i&&(p=await KM(s,e,u,d==="current",l.resumeToken)),s.isPrimaryClient&&t&&Rk(s.remoteStore,l),p}async function KM(s,e,t,i,l){s.pu=(E,T,L)=>(async function(H,B,K,G){let Q=B.view.ru(K);Q.Ss&&(Q=await fw(H.localStore,B.query,!1).then((({documents:C})=>B.view.ru(C,Q))));const he=G&&G.targetChanges.get(B.targetId),Ee=G&&G.targetMismatches.get(B.targetId)!=null,ge=B.view.applyChanges(Q,H.isPrimaryClient,he,Ee);return kw(H,B.targetId,ge.au),ge.snapshot})(s,E,T,L);const u=await fw(s.localStore,e,!0),d=new FM(e,u.ks),p=d.ru(u.documents),g=Pu.createSynthesizedTargetChangeForCurrentChange(t,i&&s.onlineState!=="Offline",l),y=d.applyChanges(p,s.isPrimaryClient,g);kw(s,t,y.au);const b=new qM(e,t,d);return s.Tu.set(e,b),s.Iu.has(t)?s.Iu.get(t).push(e):s.Iu.set(t,[e]),y.snapshot}async function YM(s,e,t){const i=Et(s),l=i.Tu.get(e),u=i.Iu.get(l.targetId);if(u.length>1)return i.Iu.set(l.targetId,u.filter((d=>!mf(d,e)))),void i.Tu.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(l.targetId),i.sharedClientState.isActiveQueryTarget(l.targetId)||await Vg(i.localStore,l.targetId,!1).then((()=>{i.sharedClientState.clearQueryState(l.targetId),t&&My(i.remoteStore,l.targetId),zg(i,l.targetId)})).catch(tc)):(zg(i,l.targetId),await Vg(i.localStore,l.targetId,!0))}async function QM(s,e){const t=Et(s),i=t.Tu.get(e),l=t.Iu.get(i.targetId);t.isPrimaryClient&&l.length===1&&(t.sharedClientState.removeLocalQueryTarget(i.targetId),My(t.remoteStore,i.targetId))}async function XM(s,e,t){const i=r6(s);try{const l=await(function(d,p){const g=Et(d),y=At.now(),b=p.reduce(((L,W)=>L.add(W.key)),zt());let E,T;return g.persistence.runTransaction("Locally write mutations","readwrite",(L=>{let W=ca(),H=zt();return g.xs.getEntries(L,b).next((B=>{W=B,W.forEach(((K,G)=>{G.isValidDocument()||(H=H.add(K))}))})).next((()=>g.localDocuments.getOverlayedDocuments(L,W))).next((B=>{E=B;const K=[];for(const G of p){const Q=dI(G,E.get(G.key).overlayedDocument);Q!=null&&K.push(new lo(G.key,Q,G_(Q.value.mapValue),rr.exists(!0)))}return g.mutationQueue.addMutationBatch(L,y,K,p)})).next((B=>{T=B;const K=B.applyToLocalDocumentSet(E,H);return g.documentOverlayCache.saveOverlays(L,B.batchId,K)}))})).then((()=>({batchId:T.batchId,changes:rk(E)})))})(i.localStore,e);i.sharedClientState.addPendingMutation(l.batchId),(function(d,p,g){let y=d.du[d.currentUser.toKey()];y||(y=new Gn(Bt)),y=y.insert(p,g),d.du[d.currentUser.toKey()]=y})(i,l.batchId,t),await Uu(i,l.changes),await kf(i.remoteStore)}catch(l){const u=Vy(l,"Failed to persist write");t.reject(u)}}async function Bk(s,e){const t=Et(s);try{const i=await cM(t.localStore,e);e.targetChanges.forEach(((l,u)=>{const d=t.Au.get(u);d&&(hn(l.addedDocuments.size+l.modifiedDocuments.size+l.removedDocuments.size<=1,22616),l.addedDocuments.size>0?d.hu=!0:l.modifiedDocuments.size>0?hn(d.hu,14607):l.removedDocuments.size>0&&(hn(d.hu,42227),d.hu=!1))})),await Uu(t,i,e)}catch(i){await tc(i)}}function _w(s,e,t){const i=Et(s);if(i.isPrimaryClient&&t===0||!i.isPrimaryClient&&t===1){const l=[];i.Tu.forEach(((u,d)=>{const p=d.view.va(e);p.snapshot&&l.push(p.snapshot)})),(function(d,p){const g=Et(d);g.onlineState=p;let y=!1;g.queries.forEach(((b,E)=>{for(const T of E.ba)T.va(p)&&(y=!0)})),y&&zy(g)})(i.eventManager,e),l.length&&i.Pu.J_(l),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function JM(s,e,t){const i=Et(s);i.sharedClientState.updateQueryState(e,"rejected",t);const l=i.Au.get(e),u=l&&l.key;if(u){let d=new Gn(lt.comparator);d=d.insert(u,Ws.newNoDocument(u,_t.min()));const p=zt().add(u),g=new wf(_t.min(),new Map,new Gn(Bt),d,p);await Bk(i,g),i.Ru=i.Ru.remove(u),i.Au.delete(e),Hy(i)}else await Vg(i.localStore,e,!1).then((()=>zg(i,e,t))).catch(tc)}async function ZM(s,e){const t=Et(s),i=e.batch.batchId;try{const l=await lM(t.localStore,e);Fk(t,i,null),zk(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),await Uu(t,l)}catch(l){await tc(l)}}async function e6(s,e,t){const i=Et(s);try{const l=await(function(d,p){const g=Et(d);return g.persistence.runTransaction("Reject batch","readwrite-primary",(y=>{let b;return g.mutationQueue.lookupMutationBatch(y,p).next((E=>(hn(E!==null,37113),b=E.keys(),g.mutationQueue.removeMutationBatch(y,E)))).next((()=>g.mutationQueue.performConsistencyCheck(y))).next((()=>g.documentOverlayCache.removeOverlaysForBatchId(y,b,p))).next((()=>g.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(y,b))).next((()=>g.localDocuments.getDocuments(y,b)))}))})(i.localStore,e);Fk(i,e,t),zk(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),await Uu(i,l)}catch(l){await tc(l)}}function zk(s,e){(s.mu.get(e)||[]).forEach((t=>{t.resolve()})),s.mu.delete(e)}function Fk(s,e,t){const i=Et(s);let l=i.du[i.currentUser.toKey()];if(l){const u=l.get(e);u&&(t?u.reject(t):u.resolve(),l=l.remove(e)),i.du[i.currentUser.toKey()]=l}}function zg(s,e,t=null){s.sharedClientState.removeLocalQueryTarget(e);for(const i of s.Iu.get(e))s.Tu.delete(i),t&&s.Pu.yu(i,t);s.Iu.delete(e),s.isPrimaryClient&&s.Vu.Gr(e).forEach((i=>{s.Vu.containsKey(i)||qk(s,i)}))}function qk(s,e){s.Eu.delete(e.path.canonicalString());const t=s.Ru.get(e);t!==null&&(My(s.remoteStore,t),s.Ru=s.Ru.remove(e),s.Au.delete(t),Hy(s))}function kw(s,e,t){for(const i of t)i instanceof Pk?(s.Vu.addReference(i.key,e),t6(s,i)):i instanceof Vk?(Ke(qy,"Document no longer in limbo: "+i.key),s.Vu.removeReference(i.key,e),s.Vu.containsKey(i.key)||qk(s,i.key)):wt(19791,{wu:i})}function t6(s,e){const t=e.key,i=t.path.canonicalString();s.Ru.get(t)||s.Eu.has(i)||(Ke(qy,"New document in limbo: "+t),s.Eu.add(i),Hy(s))}function Hy(s){for(;s.Eu.size>0&&s.Ru.size<s.maxConcurrentLimboResolutions;){const e=s.Eu.values().next().value;s.Eu.delete(e);const t=new lt(An.fromString(e)),i=s.fu.next();s.Au.set(i,new HM(t)),s.Ru=s.Ru.insert(t,i),Rk(s.remoteStore,new Wa(Si(ff(t.path)),i,"TargetPurposeLimboResolution",uf.ce))}}async function Uu(s,e,t){const i=Et(s),l=[],u=[],d=[];i.Tu.isEmpty()||(i.Tu.forEach(((p,g)=>{d.push(i.pu(g,e,t).then((y=>{if((y||t)&&i.isPrimaryClient){const b=y?!y.fromCache:t?.targetChanges.get(g.targetId)?.current;i.sharedClientState.updateQueryState(g.targetId,b?"current":"not-current")}if(y){l.push(y);const b=Ry.Es(g.targetId,y);u.push(b)}})))})),await Promise.all(d),i.Pu.J_(l),await(async function(g,y){const b=Et(g);try{await b.persistence.runTransaction("notifyLocalViewChanges","readwrite",(E=>Te.forEach(y,(T=>Te.forEach(T.Ts,(L=>b.persistence.referenceDelegate.addReference(E,T.targetId,L))).next((()=>Te.forEach(T.Is,(L=>b.persistence.referenceDelegate.removeReference(E,T.targetId,L)))))))))}catch(E){if(!nc(E))throw E;Ke(Iy,"Failed to update sequence numbers: "+E)}for(const E of y){const T=E.targetId;if(!E.fromCache){const L=b.vs.get(T),W=L.snapshotVersion,H=L.withLastLimboFreeSnapshotVersion(W);b.vs=b.vs.insert(T,H)}}})(i.localStore,u))}async function n6(s,e){const t=Et(s);if(!t.currentUser.isEqual(e)){Ke(qy,"User change. New user:",e.toKey());const i=await Sk(t.localStore,e);t.currentUser=e,(function(u,d){u.mu.forEach((p=>{p.forEach((g=>{g.reject(new ze(ve.CANCELLED,d))}))})),u.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await Uu(t,i.Ns)}}function s6(s,e){const t=Et(s),i=t.Au.get(e);if(i&&i.hu)return zt().add(i.key);{let l=zt();const u=t.Iu.get(e);if(!u)return l;for(const d of u){const p=t.Tu.get(d);l=l.unionWith(p.view.nu)}return l}}function Hk(s){const e=Et(s);return e.remoteStore.remoteSyncer.applyRemoteEvent=Bk.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=s6.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=JM.bind(null,e),e.Pu.J_=BM.bind(null,e.eventManager),e.Pu.yu=zM.bind(null,e.eventManager),e}function r6(s){const e=Et(s);return e.remoteStore.remoteSyncer.applySuccessfulWrite=ZM.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=e6.bind(null,e),e}class Qh{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=xf(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return oM(this.persistence,new rM,e.initialUser,this.serializer)}Cu(e){return new jk(Ay.Vi,this.serializer)}Du(e){return new mM}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Qh.provider={build:()=>new Qh};class i6 extends Qh{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){hn(this.persistence.referenceDelegate instanceof Kh,46915);const i=this.persistence.referenceDelegate.garbageCollector;return new qI(i,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?hr.withCacheSize(this.cacheSizeBytes):hr.DEFAULT;return new jk((i=>Kh.Vi(i,t)),this.serializer)}}class Fg{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>_w(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=n6.bind(null,this.syncEngine),await PM(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new UM})()}createDatastore(e){const t=xf(e.databaseInfo.databaseId),i=bM(e.databaseInfo);return EM(e.authCredentials,e.appCheckCredentials,i,t)}createRemoteStore(e){return(function(i,l,u,d,p){return new jM(i,l,u,d,p)})(this.localStore,this.datastore,e.asyncQueue,(t=>_w(this.syncEngine,t,0)),(function(){return gw.v()?new gw:new pM})())}createSyncEngine(e,t){return(function(l,u,d,p,g,y,b){const E=new $M(l,u,d,p,g,y);return b&&(E.gu=!0),E})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const i=Et(t);Ke(Bo,"RemoteStore shutting down."),i.Ea.add(5),await Vu(i),i.Aa.shutdown(),i.Va.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}Fg.provider={build:()=>new Fg};class $y{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):la("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}const ro="FirestoreClient";class a6{constructor(e,t,i,l,u){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this._databaseInfo=l,this.user=$s.UNAUTHENTICATED,this.clientId=by.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=u,this.authCredentials.start(i,(async d=>{Ke(ro,"Received user=",d.uid),await this.authCredentialListener(d),this.user=d})),this.appCheckCredentials.start(i,(d=>(Ke(ro,"Received new app check token=",d),this.appCheckCredentialListener(d,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this._databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new sa;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const i=Vy(t,"Failed to shutdown persistence");e.reject(i)}})),e.promise}}async function Wp(s,e){s.asyncQueue.verifyOperationInProgress(),Ke(ro,"Initializing OfflineComponentProvider");const t=s.configuration;await e.initialize(t);let i=t.initialUser;s.setCredentialChangeListener((async l=>{i.isEqual(l)||(await Sk(e.localStore,l),i=l)})),e.persistence.setDatabaseDeletedListener((()=>s.terminate())),s._offlineComponents=e}async function Ew(s,e){s.asyncQueue.verifyOperationInProgress();const t=await o6(s);Ke(ro,"Initializing OnlineComponentProvider"),await e.initialize(t,s.configuration),s.setCredentialChangeListener((i=>vw(e.remoteStore,i))),s.setAppCheckTokenChangeListener(((i,l)=>vw(e.remoteStore,l))),s._onlineComponents=e}async function o6(s){if(!s._offlineComponents)if(s._uninitializedComponentsProvider){Ke(ro,"Using user provided OfflineComponentProvider");try{await Wp(s,s._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(l){return l.name==="FirebaseError"?l.code===ve.FAILED_PRECONDITION||l.code===ve.UNIMPLEMENTED:!(typeof DOMException<"u"&&l instanceof DOMException)||l.code===22||l.code===20||l.code===11})(t))throw t;Fl("Error using user provided cache. Falling back to memory cache: "+t),await Wp(s,new Qh)}}else Ke(ro,"Using default OfflineComponentProvider"),await Wp(s,new i6(void 0));return s._offlineComponents}async function $k(s){return s._onlineComponents||(s._uninitializedComponentsProvider?(Ke(ro,"Using user provided OnlineComponentProvider"),await Ew(s,s._uninitializedComponentsProvider._online)):(Ke(ro,"Using default OnlineComponentProvider"),await Ew(s,new Fg))),s._onlineComponents}function l6(s){return $k(s).then((e=>e.syncEngine))}async function Xh(s){const e=await $k(s),t=e.eventManager;return t.onListen=WM.bind(null,e.syncEngine),t.onUnlisten=YM.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=GM.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=QM.bind(null,e.syncEngine),t}function c6(s,e,t,i){const l=new $y(i),u=new Fy(e,l,t);return s.asyncQueue.enqueueAndForget((async()=>Uy(await Xh(s),u))),()=>{l.Nu(),s.asyncQueue.enqueueAndForget((async()=>By(await Xh(s),u)))}}function u6(s,e,t={}){const i=new sa;return s.asyncQueue.enqueueAndForget((async()=>(function(u,d,p,g,y){const b=new $y({next:T=>{b.Nu(),d.enqueueAndForget((()=>By(u,E)));const L=T.docs.has(p);!L&&T.fromCache?y.reject(new ze(ve.UNAVAILABLE,"Failed to get document because the client is offline.")):L&&T.fromCache&&g&&g.source==="server"?y.reject(new ze(ve.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):y.resolve(T)},error:T=>y.reject(T)}),E=new Fy(ff(p.path),b,{includeMetadataChanges:!0,Ka:!0});return Uy(u,E)})(await Xh(s),s.asyncQueue,e,t,i))),i.promise}function d6(s,e,t={}){const i=new sa;return s.asyncQueue.enqueueAndForget((async()=>(function(u,d,p,g,y){const b=new $y({next:T=>{b.Nu(),d.enqueueAndForget((()=>By(u,E))),T.fromCache&&g.source==="server"?y.reject(new ze(ve.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):y.resolve(T)},error:T=>y.reject(T)}),E=new Fy(p,b,{includeMetadataChanges:!0,Ka:!0});return Uy(u,E)})(await Xh(s),s.asyncQueue,e,t,i))),i.promise}function h6(s,e){const t=new sa;return s.asyncQueue.enqueueAndForget((async()=>XM(await l6(s),e,t))),t.promise}function Wk(s){const e={};return s.timeoutSeconds!==void 0&&(e.timeoutSeconds=s.timeoutSeconds),e}const f6="ComponentProvider",Tw=new Map;function m6(s,e,t,i,l){return new DR(s,e,t,l.host,l.ssl,l.experimentalForceLongPolling,l.experimentalAutoDetectLongPolling,Wk(l.experimentalLongPollingOptions),l.useFetchStreams,l.isUsingEmulator,i)}const Gk="firestore.googleapis.com",jw=!0;class Sw{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new ze(ve.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Gk,this.ssl=jw}else this.host=e.host,this.ssl=e.ssl??jw;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=Tk;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<zI)throw new ze(ve.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}_R("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Wk(e.experimentalLongPollingOptions??{}),(function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new ze(ve.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new ze(ve.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new ze(ve.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(i,l){return i.timeoutSeconds===l.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Ef{constructor(e,t,i,l){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=l,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Sw({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new ze(ve.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new ze(ve.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Sw(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(i){if(!i)return new hR;switch(i.type){case"firstParty":return new gR(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new ze(ve.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const i=Tw.get(t);i&&(Ke(f6,"Removing Datastore"),Tw.delete(t),i.terminate())})(this),Promise.resolve()}}function p6(s,e,t,i={}){s=sr(s,Ef);const l=io(e),u=s._getSettings(),d={...u,emulatorOptions:s._getEmulatorOptions()},p=`${e}:${t}`;l&&(ry(`https://${p}`),iy("Firestore",!0)),u.host!==Gk&&u.host!==p&&Fl("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const g={...u,host:p,ssl:l,emulatorOptions:i};if(!ia(g,d)&&(s._setSettings(g),i.mockUserToken)){let y,b;if(typeof i.mockUserToken=="string")y=i.mockUserToken,b=$s.MOCK_USER;else{y=Bx(i.mockUserToken,s._app?.options.projectId);const E=i.mockUserToken.sub||i.mockUserToken.user_id;if(!E)throw new ze(ve.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");b=new $s(E)}s._authCredentials=new fR(new L_(y,b))}}class ha{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new ha(this.firestore,e,this._query)}}class Xn{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Xa(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Xn(this.firestore,e,this._key)}toJSON(){return{type:Xn._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,i){if(Lu(t,Xn._jsonSchema))return new Xn(e,i||null,new lt(An.fromString(t.referencePath)))}}Xn._jsonSchemaVersion="firestore/documentReference/1.0",Xn._jsonSchema={type:ys("string",Xn._jsonSchemaVersion),referencePath:ys("string")};class Xa extends ha{constructor(e,t,i){super(e,t,ff(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Xn(this.firestore,null,new lt(e))}withConverter(e){return new Xa(this.firestore,e,this._path)}}function ht(s,e,...t){if(s=fn(s),O_("collection","path",e),s instanceof Ef){const i=An.fromString(e,...t);return B2(i),new Xa(s,null,i)}{if(!(s instanceof Xn||s instanceof Xa))throw new ze(ve.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=s._path.child(An.fromString(e,...t));return B2(i),new Xa(s.firestore,null,i)}}function We(s,e,...t){if(s=fn(s),arguments.length===1&&(e=by.newId()),O_("doc","path",e),s instanceof Ef){const i=An.fromString(e,...t);return U2(i),new Xn(s,null,new lt(i))}{if(!(s instanceof Xn||s instanceof Xa))throw new ze(ve.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=s._path.child(An.fromString(e,...t));return U2(i),new Xn(s.firestore,s instanceof Xa?s.converter:null,new lt(i))}}const Cw="AsyncQueue";class Nw{constructor(e=Promise.resolve()){this.Yu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new Nk(this,"async_queue_retry"),this._c=()=>{const i=$p();i&&Ke(Cw,"Visibility state changed to "+i.visibilityState),this.M_.w_()},this.ac=e;const t=$p();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=$p();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new sa;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Yu.push(e),this.lc())))}async lc(){if(this.Yu.length!==0){try{await this.Yu[0](),this.Yu.shift(),this.M_.reset()}catch(e){if(!nc(e))throw e;Ke(Cw,"Operation failed with retryable error: "+e)}this.Yu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((i=>{throw this.nc=i,this.rc=!1,la("INTERNAL UNHANDLED ERROR: ",Aw(i)),i})).then((i=>(this.rc=!1,i))))));return this.ac=t,t}enqueueAfterDelay(e,t,i){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const l=Py.createAndSchedule(this,e,t,i,(u=>this.hc(u)));return this.tc.push(l),l}uc(){this.nc&&wt(47125,{Pc:Aw(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,i)=>t.targetTimeMs-i.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}Rc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function Aw(s){let e=s.message||"";return s.stack&&(e=s.stack.includes(s.message)?s.stack:s.message+`
`+s.stack),e}class Ri extends Ef{constructor(e,t,i,l){super(e,t,i,l),this.type="firestore",this._queue=new Nw,this._persistenceKey=l?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Nw(e),this._firestoreClient=void 0,await e}}}function g6(s,e){const t=typeof s=="object"?s:Au(),i=typeof s=="string"?s:qh,l=Wo(t,"firestore").getImmediate({identifier:i});if(!l._initialized){const u=Px("firestore");u&&p6(l,...u)}return l}function Bu(s){if(s._terminated)throw new ze(ve.FAILED_PRECONDITION,"The client has already been terminated.");return s._firestoreClient||y6(s),s._firestoreClient}function y6(s){const e=s._freezeSettings(),t=m6(s._databaseId,s._app?.options.appId||"",s._persistenceKey,s._app?.options.apiKey,e);s._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(s._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),s._firestoreClient=new a6(s._authCredentials,s._appCheckCredentials,s._queue,t,s._componentsProvider&&(function(l){const u=l?._online.build();return{_offline:l?._offline.build(u),_online:u}})(s._componentsProvider))}class Wr{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Wr(Bs.fromBase64String(e))}catch(t){throw new ze(ve.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Wr(Bs.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Wr._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Lu(e,Wr._jsonSchema))return Wr.fromBase64String(e.bytes)}}Wr._jsonSchemaVersion="firestore/bytes/1.0",Wr._jsonSchema={type:ys("string",Wr._jsonSchemaVersion),bytes:ys("string")};class Tf{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new ze(ve.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Us(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Qo{constructor(e){this._methodName=e}}class Ni{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new ze(ve.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new ze(ve.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Bt(this._lat,e._lat)||Bt(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Ni._jsonSchemaVersion}}static fromJSON(e){if(Lu(e,Ni._jsonSchema))return new Ni(e.latitude,e.longitude)}}Ni._jsonSchemaVersion="firestore/geoPoint/1.0",Ni._jsonSchema={type:ys("string",Ni._jsonSchemaVersion),latitude:ys("number"),longitude:ys("number")};class oi{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(i,l){if(i.length!==l.length)return!1;for(let u=0;u<i.length;++u)if(i[u]!==l[u])return!1;return!0})(this._values,e._values)}toJSON(){return{type:oi._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Lu(e,oi._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new oi(e.vectorValues);throw new ze(ve.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}oi._jsonSchemaVersion="firestore/vectorValue/1.0",oi._jsonSchema={type:ys("string",oi._jsonSchemaVersion),vectorValues:ys("object")};const v6=/^__.*__$/;class b6{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return this.fieldMask!==null?new lo(e,this.data,this.fieldMask,t,this.fieldTransforms):new Ou(e,this.data,t,this.fieldTransforms)}}class Kk{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return new lo(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function Yk(s){switch(s){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw wt(40011,{dataSource:s})}}class jf{constructor(e,t,i,l,u,d){this.settings=e,this.databaseId=t,this.serializer=i,this.ignoreUndefinedProperties=l,u===void 0&&this.validatePath(),this.fieldTransforms=u||[],this.fieldMask=d||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(e){return new jf({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(e){const t=this.path?.child(e),i=this.contextWith({path:t,arrayElement:!1});return i.validatePathSegment(e),i}childContextForFieldPath(e){const t=this.path?.child(e),i=this.contextWith({path:t,arrayElement:!1});return i.validatePath(),i}childContextForArray(e){return this.contextWith({path:void 0,arrayElement:!0})}createError(e){return Jh(e,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}validatePath(){if(this.path)for(let e=0;e<this.path.length;e++)this.validatePathSegment(this.path.get(e))}validatePathSegment(e){if(e.length===0)throw this.createError("Document fields must not be empty");if(Yk(this.dataSource)&&v6.test(e))throw this.createError('Document fields cannot begin and end with "__"')}}class w6{constructor(e,t,i){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=i||xf(e)}createContext(e,t,i,l=!1){return new jf({dataSource:e,methodName:t,targetDoc:i,path:Us.emptyPath(),arrayElement:!1,hasConverter:l},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function zu(s){const e=s._freezeSettings(),t=xf(s._databaseId);return new w6(s._databaseId,!!e.ignoreUndefinedProperties,t)}function Wy(s,e,t,i,l,u={}){const d=s.createContext(u.merge||u.mergeFields?2:0,e,t,l);Xy("Data must be an object, but it was:",d,i);const p=Zk(i,d);let g,y;if(u.merge)g=new Cr(d.fieldMask),y=d.fieldTransforms;else if(u.mergeFields){const b=[];for(const E of u.mergeFields){const T=zo(e,E,t);if(!d.contains(T))throw new ze(ve.INVALID_ARGUMENT,`Field '${T}' is specified in your field mask but missing from your input data.`);nE(b,T)||b.push(T)}g=new Cr(b),y=d.fieldTransforms.filter((E=>g.covers(E.field)))}else g=null,y=d.fieldTransforms;return new b6(new fr(p),g,y)}class Sf extends Qo{_toFieldTransform(e){if(e.dataSource!==2)throw e.dataSource===1?e.createError(`${this._methodName}() can only appear at the top level of your update data`):e.createError(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Sf}}function Qk(s,e,t){return new jf({dataSource:3,targetDoc:e.settings.targetDoc,methodName:s._methodName,arrayElement:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class Gy extends Qo{_toFieldTransform(e){return new yf(e.path,new xu)}isEqual(e){return e instanceof Gy}}class Ky extends Qo{constructor(e,t){super(e),this.Ac=t}_toFieldTransform(e){const t=Qk(this,e,!0),i=this.Ac.map((u=>Xo(u,t))),l=new Wl(i);return new yf(e.path,l)}isEqual(e){return e instanceof Ky&&ia(this.Ac,e.Ac)}}class Yy extends Qo{constructor(e,t){super(e),this.Ac=t}_toFieldTransform(e){const t=Qk(this,e,!0),i=this.Ac.map((u=>Xo(u,t))),l=new Gl(i);return new yf(e.path,l)}isEqual(e){return e instanceof Yy&&ia(this.Ac,e.Ac)}}class Qy extends Qo{constructor(e,t){super(e),this.Vc=t}_toFieldTransform(e){const t=new _u(e.serializer,ok(e.serializer,this.Vc));return new yf(e.path,t)}isEqual(e){return e instanceof Qy&&this.Vc===e.Vc}}function Xk(s,e,t,i){const l=s.createContext(1,e,t);Xy("Data must be an object, but it was:",l,i);const u=[],d=fr.empty();oo(i,((g,y)=>{const b=tE(e,g,t);y=fn(y);const E=l.childContextForFieldPath(b);if(y instanceof Sf)u.push(b);else{const T=Xo(y,E);T!=null&&(u.push(b),d.set(b,T))}}));const p=new Cr(u);return new Kk(d,p,l.fieldTransforms)}function Jk(s,e,t,i,l,u){const d=s.createContext(1,e,t),p=[zo(e,i,t)],g=[l];if(u.length%2!=0)throw new ze(ve.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let T=0;T<u.length;T+=2)p.push(zo(e,u[T])),g.push(u[T+1]);const y=[],b=fr.empty();for(let T=p.length-1;T>=0;--T)if(!nE(y,p[T])){const L=p[T];let W=g[T];W=fn(W);const H=d.childContextForFieldPath(L);if(W instanceof Sf)y.push(L);else{const B=Xo(W,H);B!=null&&(y.push(L),b.set(L,B))}}const E=new Cr(y);return new Kk(b,E,d.fieldTransforms)}function x6(s,e,t,i=!1){return Xo(t,s.createContext(i?4:3,e))}function Xo(s,e){if(eE(s=fn(s)))return Xy("Unsupported field value:",e,s),Zk(s,e);if(s instanceof Qo)return(function(i,l){if(!Yk(l.dataSource))throw l.createError(`${i._methodName}() can only be used with update() and set()`);if(!l.path)throw l.createError(`${i._methodName}() is not currently supported inside arrays`);const u=i._toFieldTransform(l);u&&l.fieldTransforms.push(u)})(s,e),null;if(s===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),s instanceof Array){if(e.settings.arrayElement&&e.dataSource!==4)throw e.createError("Nested arrays are not supported");return(function(i,l){const u=[];let d=0;for(const p of i){let g=Xo(p,l.childContextForArray(d));g==null&&(g={nullValue:"NULL_VALUE"}),u.push(g),d++}return{arrayValue:{values:u}}})(s,e)}return(function(i,l){if((i=fn(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return ok(l.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const u=At.fromDate(i);return{timestampValue:Gh(l.serializer,u)}}if(i instanceof At){const u=new At(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:Gh(l.serializer,u)}}if(i instanceof Ni)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof Wr)return{bytesValue:yk(l.serializer,i._byteString)};if(i instanceof Xn){const u=l.databaseId,d=i.firestore._databaseId;if(!d.isEqual(u))throw l.createError(`Document reference is for database ${d.projectId}/${d.database} but should be for database ${u.projectId}/${u.database}`);return{referenceValue:Cy(i.firestore._databaseId||l.databaseId,i._key.path)}}if(i instanceof oi)return(function(d,p){const g=d instanceof oi?d.toArray():d;return{mapValue:{fields:{[$_]:{stringValue:W_},[Hh]:{arrayValue:{values:g.map((b=>{if(typeof b!="number")throw p.createError("VectorValues must only contain numeric values.");return Ty(p.serializer,b)}))}}}}}})(i,l);if(Ek(i))return i._toProto(l.serializer);throw l.createError(`Unsupported field value: ${cf(i)}`)})(s,e)}function Zk(s,e){const t={};return U_(s)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):oo(s,((i,l)=>{const u=Xo(l,e.childContextForField(i));u!=null&&(t[i]=u)})),{mapValue:{fields:t}}}function eE(s){return!(typeof s!="object"||s===null||s instanceof Array||s instanceof Date||s instanceof At||s instanceof Ni||s instanceof Wr||s instanceof Xn||s instanceof Qo||s instanceof oi||Ek(s))}function Xy(s,e,t){if(!eE(t)||!P_(t)){const i=cf(t);throw i==="an object"?e.createError(s+" a custom object"):e.createError(s+" "+i)}}function zo(s,e,t){if((e=fn(e))instanceof Tf)return e._internalPath;if(typeof e=="string")return tE(s,e);throw Jh("Field path arguments must be of type string or ",s,!1,void 0,t)}const _6=new RegExp("[~\\*/\\[\\]]");function tE(s,e,t){if(e.search(_6)>=0)throw Jh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,s,!1,void 0,t);try{return new Tf(...e.split("."))._internalPath}catch{throw Jh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,s,!1,void 0,t)}}function Jh(s,e,t,i,l){const u=i&&!i.isEmpty(),d=l!==void 0;let p=`Function ${e}() called with invalid data`;t&&(p+=" (via `toFirestore()`)"),p+=". ";let g="";return(u||d)&&(g+=" (found",u&&(g+=` in field ${i}`),d&&(g+=` in document ${l}`),g+=")"),new ze(ve.INVALID_ARGUMENT,p+s+g)}function nE(s,e){return s.some((t=>t.isEqual(e)))}class k6{convertValue(e,t="none"){switch(no(e)){case 0:return null;case 1:return e.booleanValue;case 2:return os(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(to(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw wt(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const i={};return oo(e,((l,u)=>{i[l]=this.convertValue(u,t)})),i}convertVectorValue(e){const t=e.fields?.[Hh].arrayValue?.values?.map((i=>os(i.doubleValue)));return new oi(t)}convertGeoPoint(e){return new Ni(os(e.latitude),os(e.longitude))}convertArray(e,t){return(e.values||[]).map((i=>this.convertValue(i,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const i=hf(e);return i==null?null:this.convertValue(i,t);case"estimate":return this.convertTimestamp(yu(e));default:return null}}convertTimestamp(e){const t=eo(e);return new At(t.seconds,t.nanos)}convertDocumentKey(e,t){const i=An.fromString(e);hn(kk(i),9688,{name:e});const l=new vu(i.get(1),i.get(3)),u=new lt(i.popFirst(5));return l.isEqual(t)||la(`Document ${u} contains a document reference within a different database (${l.projectId}/${l.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),u}}class Jy extends k6{constructor(e){super(),this.firestore=e}convertBytes(e){return new Wr(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Xn(this.firestore,null,t)}}function Rs(){return new Gy("serverTimestamp")}function E6(...s){return new Ky("arrayUnion",s)}function T6(...s){return new Yy("arrayRemove",s)}function Ro(s){return new Qy("increment",s)}const Rw="@firebase/firestore",Iw="4.10.0";function Mw(s){return(function(t,i){if(typeof t!="object"||t===null)return!1;const l=t;for(const u of i)if(u in l&&typeof l[u]=="function")return!0;return!1})(s,["next","error","complete"])}class sE{constructor(e,t,i,l,u){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=l,this._converter=u}get id(){return this._key.path.lastSegment()}get ref(){return new Xn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new j6(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}_fieldsProto(){return this._document?.data.clone().value.mapValue.fields??void 0}get(e){if(this._document){const t=this._document.data.field(zo("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class j6 extends sE{data(){return super.data()}}function rE(s){if(s.limitType==="L"&&s.explicitOrderBy.length===0)throw new ze(ve.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Zy{}class e0 extends Zy{}function Yt(s,e,...t){let i=[];e instanceof Zy&&i.push(e),i=i.concat(t),(function(u){const d=u.filter((g=>g instanceof t0)).length,p=u.filter((g=>g instanceof Cf)).length;if(d>1||d>0&&p>0)throw new ze(ve.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(i);for(const l of i)s=l._apply(s);return s}class Cf extends e0{constructor(e,t,i){super(),this._field=e,this._op=t,this._value=i,this.type="where"}static _create(e,t,i){return new Cf(e,t,i)}_apply(e){const t=this._parse(e);return iE(e._query,t),new ha(e.firestore,e.converter,Mg(e._query,t))}_parse(e){const t=zu(e.firestore);return(function(u,d,p,g,y,b,E){let T;if(y.isKeyField()){if(b==="array-contains"||b==="array-contains-any")throw new ze(ve.INVALID_ARGUMENT,`Invalid Query. You can't perform '${b}' queries on documentId().`);if(b==="in"||b==="not-in"){Lw(E,b);const W=[];for(const H of E)W.push(Dw(g,u,H));T={arrayValue:{values:W}}}else T=Dw(g,u,E)}else b!=="in"&&b!=="not-in"&&b!=="array-contains-any"||Lw(E,b),T=x6(p,d,E,b==="in"||b==="not-in");return gs.create(y,b,T)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function xt(s,e,t){const i=e,l=zo("where",s);return Cf._create(l,i,t)}class t0 extends Zy{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new t0(e,t)}_parse(e){const t=this._queryConstraints.map((i=>i._parse(e))).filter((i=>i.getFilters().length>0));return t.length===1?t[0]:ui.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(l,u){let d=l;const p=u.getFlattenedFilters();for(const g of p)iE(d,g),d=Mg(d,g)})(e._query,t),new ha(e.firestore,e.converter,Mg(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class n0 extends e0{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new n0(e,t)}_apply(e){const t=(function(l,u,d){if(l.startAt!==null)throw new ze(ve.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(l.endAt!==null)throw new ze(ve.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new wu(u,d)})(e._query,this._field,this._direction);return new ha(e.firestore,e.converter,JR(e._query,t))}}function ku(s,e="asc"){const t=e,i=zo("orderBy",s);return n0._create(i,t)}class s0 extends e0{constructor(e,t,i){super(),this.type=e,this._limit=t,this._limitType=i}static _create(e,t,i){return new s0(e,t,i)}_apply(e){return new ha(e.firestore,e.converter,Wh(e._query,this._limit,this._limitType))}}function Eu(s){return kR("limit",s),s0._create("limit",s,"F")}function Dw(s,e,t){if(typeof(t=fn(t))=="string"){if(t==="")throw new ze(ve.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!ek(e)&&t.indexOf("/")!==-1)throw new ze(ve.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const i=e.path.child(An.fromString(t));if(!lt.isDocumentKey(i))throw new ze(ve.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return K2(s,new lt(i))}if(t instanceof Xn)return K2(s,t._key);throw new ze(ve.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${cf(t)}.`)}function Lw(s,e){if(!Array.isArray(s)||s.length===0)throw new ze(ve.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function iE(s,e){const t=(function(l,u){for(const d of l)for(const p of d.getFlattenedFilters())if(u.indexOf(p.op)>=0)return p.op;return null})(s.filters,(function(l){switch(l){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new ze(ve.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new ze(ve.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}function r0(s,e,t){let i;return i=s?t&&(t.merge||t.mergeFields)?s.toFirestore(e,t):s.toFirestore(e):e,i}class ru{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Mo extends sE{constructor(e,t,i,l,u,d){super(e,t,i,l,d),this._firestore=e,this._firestoreImpl=e,this.metadata=u}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Ah(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const i=this._document.data.field(zo("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new ze(ve.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=Mo._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}Mo._jsonSchemaVersion="firestore/documentSnapshot/1.0",Mo._jsonSchema={type:ys("string",Mo._jsonSchemaVersion),bundleSource:ys("string","DocumentSnapshot"),bundleName:ys("string"),bundle:ys("string")};class Ah extends Mo{data(e={}){return super.data(e)}}class Do{constructor(e,t,i,l){this._firestore=e,this._userDataWriter=t,this._snapshot=l,this.metadata=new ru(l.hasPendingWrites,l.fromCache),this.query=i}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((i=>{e.call(t,new Ah(this._firestore,this._userDataWriter,i.key,i,new ru(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new ze(ve.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(l,u){if(l._snapshot.oldDocs.isEmpty()){let d=0;return l._snapshot.docChanges.map((p=>{const g=new Ah(l._firestore,l._userDataWriter,p.doc.key,p.doc,new ru(l._snapshot.mutatedKeys.has(p.doc.key),l._snapshot.fromCache),l.query.converter);return p.doc,{type:"added",doc:g,oldIndex:-1,newIndex:d++}}))}{let d=l._snapshot.oldDocs;return l._snapshot.docChanges.filter((p=>u||p.type!==3)).map((p=>{const g=new Ah(l._firestore,l._userDataWriter,p.doc.key,p.doc,new ru(l._snapshot.mutatedKeys.has(p.doc.key),l._snapshot.fromCache),l.query.converter);let y=-1,b=-1;return p.type!==0&&(y=d.indexOf(p.doc.key),d=d.delete(p.doc.key)),p.type!==1&&(d=d.add(p.doc),b=d.indexOf(p.doc.key)),{type:S6(p.type),doc:g,oldIndex:y,newIndex:b}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new ze(ve.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Do._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=by.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],i=[],l=[];return this.docs.forEach((u=>{u._document!==null&&(t.push(u._document),i.push(this._userDataWriter.convertObjectMap(u._document.data.value.mapValue.fields,"previous")),l.push(u.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function S6(s){switch(s){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return wt(61501,{type:s})}}Do._jsonSchemaVersion="firestore/querySnapshot/1.0",Do._jsonSchema={type:ys("string",Do._jsonSchemaVersion),bundleSource:ys("string","QuerySnapshot"),bundleName:ys("string"),bundle:ys("string")};class C6{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=zu(e)}set(e,t,i){this._verifyNotCommitted();const l=Gp(e,this._firestore),u=r0(l.converter,t,i),d=Wy(this._dataReader,"WriteBatch.set",l._key,u,l.converter!==null,i);return this._mutations.push(d.toMutation(l._key,rr.none())),this}update(e,t,i,...l){this._verifyNotCommitted();const u=Gp(e,this._firestore);let d;return d=typeof(t=fn(t))=="string"||t instanceof Tf?Jk(this._dataReader,"WriteBatch.update",u._key,t,i,l):Xk(this._dataReader,"WriteBatch.update",u._key,t),this._mutations.push(d.toMutation(u._key,rr.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=Gp(e,this._firestore);return this._mutations=this._mutations.concat(new bf(t._key,rr.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new ze(ve.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Gp(s,e){if((s=fn(s)).firestore!==e)throw new ze(ve.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return s}function Es(s){s=sr(s,Xn);const e=sr(s.firestore,Ri),t=Bu(e);return u6(t,s._key).then((i=>oE(e,s,i)))}function Ht(s){s=sr(s,ha);const e=sr(s.firestore,Ri),t=Bu(e),i=new Jy(e);return rE(s._query),d6(t,s._query).then((l=>new Do(e,i,s,l)))}function Ts(s,e,t){s=sr(s,Xn);const i=sr(s.firestore,Ri),l=r0(s.converter,e,t),u=zu(i);return Fu(i,[Wy(u,"setDoc",s._key,l,s.converter!==null,t).toMutation(s._key,rr.none())])}function ls(s,e,t,...i){s=sr(s,Xn);const l=sr(s.firestore,Ri),u=zu(l);let d;return d=typeof(e=fn(e))=="string"||e instanceof Tf?Jk(u,"updateDoc",s._key,e,t,i):Xk(u,"updateDoc",s._key,e),Fu(l,[d.toMutation(s._key,rr.exists(!0))])}function Sr(s){return Fu(sr(s.firestore,Ri),[new bf(s._key,rr.none())])}function mr(s,e){const t=sr(s.firestore,Ri),i=We(s),l=r0(s.converter,e),u=zu(s.firestore);return Fu(t,[Wy(u,"addDoc",i._key,l,s.converter!==null,{}).toMutation(i._key,rr.exists(!1))]).then((()=>i))}function aE(s,...e){s=fn(s);let t={includeMetadataChanges:!1,source:"default"},i=0;typeof e[i]!="object"||Mw(e[i])||(t=e[i++]);const l={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(Mw(e[i])){const y=e[i];e[i]=y.next?.bind(y),e[i+1]=y.error?.bind(y),e[i+2]=y.complete?.bind(y)}let u,d,p;if(s instanceof Xn)d=sr(s.firestore,Ri),p=ff(s._key.path),u={next:y=>{e[i]&&e[i](oE(d,s,y))},error:e[i+1],complete:e[i+2]};else{const y=sr(s,ha);d=sr(y.firestore,Ri),p=y._query;const b=new Jy(d);u={next:E=>{e[i]&&e[i](new Do(d,b,y,E))},error:e[i+1],complete:e[i+2]},rE(s._query)}const g=Bu(d);return c6(g,p,l,u)}function Fu(s,e){const t=Bu(s);return h6(t,e)}function oE(s,e,t){const i=t.docs.get(e._key),l=new Jy(s);return new Mo(s,l,e._key,i,new ru(t.hasPendingWrites,t.fromCache),e.converter)}function Ow(s){return s=sr(s,Ri),Bu(s),new C6(s,(e=>Fu(s,e)))}(function(e,t=!0){dR(Go),li(new Kr("firestore",((i,{instanceIdentifier:l,options:u})=>{const d=i.getProvider("app").getImmediate(),p=new Ri(new mR(i.getProvider("auth-internal")),new yR(d,i.getProvider("app-check-internal")),LR(d,l),d);return u={useFetchStreams:t,...u},p._setSettings(u),p}),"PUBLIC").setMultipleInstances(!0)),pr(Rw,Iw,e),pr(Rw,Iw,"esm2020")})();var N6="firebase",A6="12.8.0";pr(N6,A6,"app");const lE="firebasestorage.googleapis.com",cE="storageBucket",R6=120*1e3,I6=600*1e3;class Zn extends hi{constructor(e,t,i=0){super(Kp(e),`Firebase Storage: ${t} (${Kp(e)})`),this.status_=i,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Zn.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Kp(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Jn;(function(s){s.UNKNOWN="unknown",s.OBJECT_NOT_FOUND="object-not-found",s.BUCKET_NOT_FOUND="bucket-not-found",s.PROJECT_NOT_FOUND="project-not-found",s.QUOTA_EXCEEDED="quota-exceeded",s.UNAUTHENTICATED="unauthenticated",s.UNAUTHORIZED="unauthorized",s.UNAUTHORIZED_APP="unauthorized-app",s.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",s.INVALID_CHECKSUM="invalid-checksum",s.CANCELED="canceled",s.INVALID_EVENT_NAME="invalid-event-name",s.INVALID_URL="invalid-url",s.INVALID_DEFAULT_BUCKET="invalid-default-bucket",s.NO_DEFAULT_BUCKET="no-default-bucket",s.CANNOT_SLICE_BLOB="cannot-slice-blob",s.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",s.NO_DOWNLOAD_URL="no-download-url",s.INVALID_ARGUMENT="invalid-argument",s.INVALID_ARGUMENT_COUNT="invalid-argument-count",s.APP_DELETED="app-deleted",s.INVALID_ROOT_OPERATION="invalid-root-operation",s.INVALID_FORMAT="invalid-format",s.INTERNAL_ERROR="internal-error",s.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Jn||(Jn={}));function Kp(s){return"storage/"+s}function i0(){const s="An unknown error occurred, please check the error payload for server response.";return new Zn(Jn.UNKNOWN,s)}function M6(s){return new Zn(Jn.OBJECT_NOT_FOUND,"Object '"+s+"' does not exist.")}function D6(s){return new Zn(Jn.QUOTA_EXCEEDED,"Quota for bucket '"+s+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function L6(){const s="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new Zn(Jn.UNAUTHENTICATED,s)}function O6(){return new Zn(Jn.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function P6(s){return new Zn(Jn.UNAUTHORIZED,"User does not have permission to access '"+s+"'.")}function V6(){return new Zn(Jn.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function U6(){return new Zn(Jn.CANCELED,"User canceled the upload/download.")}function B6(s){return new Zn(Jn.INVALID_URL,"Invalid URL '"+s+"'.")}function z6(s){return new Zn(Jn.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+s+"'.")}function F6(){return new Zn(Jn.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+cE+"' property when initializing the app?")}function q6(){return new Zn(Jn.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function H6(){return new Zn(Jn.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function $6(s){return new Zn(Jn.UNSUPPORTED_ENVIRONMENT,`${s} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function qg(s){return new Zn(Jn.INVALID_ARGUMENT,s)}function uE(){return new Zn(Jn.APP_DELETED,"The Firebase app was deleted.")}function W6(s){return new Zn(Jn.INVALID_ROOT_OPERATION,"The operation '"+s+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function du(s,e){return new Zn(Jn.INVALID_FORMAT,"String does not match format '"+s+"': "+e)}function Kc(s){throw new Zn(Jn.INTERNAL_ERROR,"Internal error: "+s)}class nr{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let i;try{i=nr.makeFromUrl(e,t)}catch{return new nr(e,"")}if(i.path==="")return i;throw z6(e)}static makeFromUrl(e,t){let i=null;const l="([A-Za-z0-9.\\-_]+)";function u(he){he.path.charAt(he.path.length-1)==="/"&&(he.path_=he.path_.slice(0,-1))}const d="(/(.*))?$",p=new RegExp("^gs://"+l+d,"i"),g={bucket:1,path:3};function y(he){he.path_=decodeURIComponent(he.path)}const b="v[A-Za-z0-9_]+",E=t.replace(/[.]/g,"\\."),T="(/([^?#]*).*)?$",L=new RegExp(`^https?://${E}/${b}/b/${l}/o${T}`,"i"),W={bucket:1,path:3},H=t===lE?"(?:storage.googleapis.com|storage.cloud.google.com)":t,B="([^?#]*)",K=new RegExp(`^https?://${H}/${l}/${B}`,"i"),Q=[{regex:p,indices:g,postModify:u},{regex:L,indices:W,postModify:y},{regex:K,indices:{bucket:1,path:2},postModify:y}];for(let he=0;he<Q.length;he++){const Ee=Q[he],ge=Ee.regex.exec(e);if(ge){const C=ge[Ee.indices.bucket];let j=ge[Ee.indices.path];j||(j=""),i=new nr(C,j),Ee.postModify(i);break}}if(i==null)throw B6(e);return i}}class G6{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function K6(s,e,t){let i=1,l=null,u=null,d=!1,p=0;function g(){return p===2}let y=!1;function b(...B){y||(y=!0,e.apply(null,B))}function E(B){l=setTimeout(()=>{l=null,s(L,g())},B)}function T(){u&&clearTimeout(u)}function L(B,...K){if(y){T();return}if(B){T(),b.call(null,B,...K);return}if(g()||d){T(),b.call(null,B,...K);return}i<64&&(i*=2);let Q;p===1?(p=2,Q=0):Q=(i+Math.random())*1e3,E(Q)}let W=!1;function H(B){W||(W=!0,T(),!y&&(l!==null?(B||(p=2),clearTimeout(l),E(0)):B||(p=1)))}return E(0),u=setTimeout(()=>{d=!0,H(!0)},t),H}function Y6(s){s(!1)}function Q6(s){return s!==void 0}function X6(s){return typeof s=="object"&&!Array.isArray(s)}function a0(s){return typeof s=="string"||s instanceof String}function Pw(s){return o0()&&s instanceof Blob}function o0(){return typeof Blob<"u"}function Hg(s,e,t,i){if(i<e)throw qg(`Invalid value for '${s}'. Expected ${e} or greater.`);if(i>t)throw qg(`Invalid value for '${s}'. Expected ${t} or less.`)}function Nf(s,e,t){let i=e;return t==null&&(i=`https://${e}`),`${t}://${i}/v0${s}`}function dE(s){const e=encodeURIComponent;let t="?";for(const i in s)if(s.hasOwnProperty(i)){const l=e(i)+"="+e(s[i]);t=t+l+"&"}return t=t.slice(0,-1),t}var Lo;(function(s){s[s.NO_ERROR=0]="NO_ERROR",s[s.NETWORK_ERROR=1]="NETWORK_ERROR",s[s.ABORT=2]="ABORT"})(Lo||(Lo={}));function J6(s,e){const t=s>=500&&s<600,l=[408,429].indexOf(s)!==-1,u=e.indexOf(s)!==-1;return t||l||u}class Z6{constructor(e,t,i,l,u,d,p,g,y,b,E,T=!0,L=!1){this.url_=e,this.method_=t,this.headers_=i,this.body_=l,this.successCodes_=u,this.additionalRetryCodes_=d,this.callback_=p,this.errorCallback_=g,this.timeout_=y,this.progressCallback_=b,this.connectionFactory_=E,this.retry=T,this.isUsingEmulator=L,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((W,H)=>{this.resolve_=W,this.reject_=H,this.start_()})}start_(){const e=(i,l)=>{if(l){i(!1,new dh(!1,null,!0));return}const u=this.connectionFactory_();this.pendingConnection_=u;const d=p=>{const g=p.loaded,y=p.lengthComputable?p.total:-1;this.progressCallback_!==null&&this.progressCallback_(g,y)};this.progressCallback_!==null&&u.addUploadProgressListener(d),u.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&u.removeUploadProgressListener(d),this.pendingConnection_=null;const p=u.getErrorCode()===Lo.NO_ERROR,g=u.getStatus();if(!p||J6(g,this.additionalRetryCodes_)&&this.retry){const b=u.getErrorCode()===Lo.ABORT;i(!1,new dh(!1,null,b));return}const y=this.successCodes_.indexOf(g)!==-1;i(!0,new dh(y,u))})},t=(i,l)=>{const u=this.resolve_,d=this.reject_,p=l.connection;if(l.wasSuccessCode)try{const g=this.callback_(p,p.getResponse());Q6(g)?u(g):u()}catch(g){d(g)}else if(p!==null){const g=i0();g.serverResponse=p.getErrorText(),this.errorCallback_?d(this.errorCallback_(p,g)):d(g)}else if(l.canceled){const g=this.appDelete_?uE():U6();d(g)}else{const g=V6();d(g)}};this.canceled_?t(!1,new dh(!1,null,!0)):this.backoffId_=K6(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&Y6(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class dh{constructor(e,t,i){this.wasSuccessCode=e,this.connection=t,this.canceled=!!i}}function eD(s,e){e!==null&&e.length>0&&(s.Authorization="Firebase "+e)}function tD(s,e){s["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function nD(s,e){e&&(s["X-Firebase-GMPID"]=e)}function sD(s,e){e!==null&&(s["X-Firebase-AppCheck"]=e)}function rD(s,e,t,i,l,u,d=!0,p=!1){const g=dE(s.urlParams),y=s.url+g,b=Object.assign({},s.headers);return nD(b,e),eD(b,t),tD(b,u),sD(b,i),new Z6(y,s.method,b,s.body,s.successCodes,s.additionalRetryCodes,s.handler,s.errorHandler,s.timeout,s.progressCallback,l,d,p)}function iD(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function aD(...s){const e=iD();if(e!==void 0){const t=new e;for(let i=0;i<s.length;i++)t.append(s[i]);return t.getBlob()}else{if(o0())return new Blob(s);throw new Zn(Jn.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function oD(s,e,t){return s.webkitSlice?s.webkitSlice(e,t):s.mozSlice?s.mozSlice(e,t):s.slice?s.slice(e,t):null}function lD(s){if(typeof atob>"u")throw $6("base-64");return atob(s)}const Ei={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class Yp{constructor(e,t){this.data=e,this.contentType=t||null}}function cD(s,e){switch(s){case Ei.RAW:return new Yp(hE(e));case Ei.BASE64:case Ei.BASE64URL:return new Yp(fE(s,e));case Ei.DATA_URL:return new Yp(dD(e),hD(e))}throw i0()}function hE(s){const e=[];for(let t=0;t<s.length;t++){let i=s.charCodeAt(t);if(i<=127)e.push(i);else if(i<=2047)e.push(192|i>>6,128|i&63);else if((i&64512)===55296)if(!(t<s.length-1&&(s.charCodeAt(t+1)&64512)===56320))e.push(239,191,189);else{const u=i,d=s.charCodeAt(++t);i=65536|(u&1023)<<10|d&1023,e.push(240|i>>18,128|i>>12&63,128|i>>6&63,128|i&63)}else(i&64512)===56320?e.push(239,191,189):e.push(224|i>>12,128|i>>6&63,128|i&63)}return new Uint8Array(e)}function uD(s){let e;try{e=decodeURIComponent(s)}catch{throw du(Ei.DATA_URL,"Malformed data URL.")}return hE(e)}function fE(s,e){switch(s){case Ei.BASE64:{const l=e.indexOf("-")!==-1,u=e.indexOf("_")!==-1;if(l||u)throw du(s,"Invalid character '"+(l?"-":"_")+"' found: is it base64url encoded?");break}case Ei.BASE64URL:{const l=e.indexOf("+")!==-1,u=e.indexOf("/")!==-1;if(l||u)throw du(s,"Invalid character '"+(l?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let t;try{t=lD(e)}catch(l){throw l.message.includes("polyfill")?l:du(s,"Invalid character found")}const i=new Uint8Array(t.length);for(let l=0;l<t.length;l++)i[l]=t.charCodeAt(l);return i}class mE{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(t===null)throw du(Ei.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const i=t[1]||null;i!=null&&(this.base64=fD(i,";base64"),this.contentType=this.base64?i.substring(0,i.length-7):i),this.rest=e.substring(e.indexOf(",")+1)}}function dD(s){const e=new mE(s);return e.base64?fE(Ei.BASE64,e.rest):uD(e.rest)}function hD(s){return new mE(s).contentType}function fD(s,e){return s.length>=e.length?s.substring(s.length-e.length)===e:!1}class $a{constructor(e,t){let i=0,l="";Pw(e)?(this.data_=e,i=e.size,l=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),i=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),i=e.length),this.size_=i,this.type_=l}size(){return this.size_}type(){return this.type_}slice(e,t){if(Pw(this.data_)){const i=this.data_,l=oD(i,e,t);return l===null?null:new $a(l)}else{const i=new Uint8Array(this.data_.buffer,e,t-e);return new $a(i,!0)}}static getBlob(...e){if(o0()){const t=e.map(i=>i instanceof $a?i.data_:i);return new $a(aD.apply(null,t))}else{const t=e.map(d=>a0(d)?cD(Ei.RAW,d).data:d.data_);let i=0;t.forEach(d=>{i+=d.byteLength});const l=new Uint8Array(i);let u=0;return t.forEach(d=>{for(let p=0;p<d.length;p++)l[u++]=d[p]}),new $a(l,!0)}}uploadData(){return this.data_}}function l0(s){let e;try{e=JSON.parse(s)}catch{return null}return X6(e)?e:null}function mD(s){if(s.length===0)return null;const e=s.lastIndexOf("/");return e===-1?"":s.slice(0,e)}function pD(s,e){const t=e.split("/").filter(i=>i.length>0).join("/");return s.length===0?t:s+"/"+t}function pE(s){const e=s.lastIndexOf("/",s.length-2);return e===-1?s:s.slice(e+1)}function gD(s,e){return e}class tr{constructor(e,t,i,l){this.server=e,this.local=t||e,this.writable=!!i,this.xform=l||gD}}let hh=null;function yD(s){return!a0(s)||s.length<2?s:pE(s)}function gE(){if(hh)return hh;const s=[];s.push(new tr("bucket")),s.push(new tr("generation")),s.push(new tr("metageneration")),s.push(new tr("name","fullPath",!0));function e(u,d){return yD(d)}const t=new tr("name");t.xform=e,s.push(t);function i(u,d){return d!==void 0?Number(d):d}const l=new tr("size");return l.xform=i,s.push(l),s.push(new tr("timeCreated")),s.push(new tr("updated")),s.push(new tr("md5Hash",null,!0)),s.push(new tr("cacheControl",null,!0)),s.push(new tr("contentDisposition",null,!0)),s.push(new tr("contentEncoding",null,!0)),s.push(new tr("contentLanguage",null,!0)),s.push(new tr("contentType",null,!0)),s.push(new tr("metadata","customMetadata",!0)),hh=s,hh}function vD(s,e){function t(){const i=s.bucket,l=s.fullPath,u=new nr(i,l);return e._makeStorageReference(u)}Object.defineProperty(s,"ref",{get:t})}function bD(s,e,t){const i={};i.type="file";const l=t.length;for(let u=0;u<l;u++){const d=t[u];i[d.local]=d.xform(i,e[d.server])}return vD(i,s),i}function yE(s,e,t){const i=l0(e);return i===null?null:bD(s,i,t)}function wD(s,e,t,i){const l=l0(e);if(l===null||!a0(l.downloadTokens))return null;const u=l.downloadTokens;if(u.length===0)return null;const d=encodeURIComponent;return u.split(",").map(y=>{const b=s.bucket,E=s.fullPath,T="/b/"+d(b)+"/o/"+d(E),L=Nf(T,t,i),W=dE({alt:"media",token:y});return L+W})[0]}function xD(s,e){const t={},i=e.length;for(let l=0;l<i;l++){const u=e[l];u.writable&&(t[u.server]=s[u.local])}return JSON.stringify(t)}const Vw="prefixes",Uw="items";function _D(s,e,t){const i={prefixes:[],items:[],nextPageToken:t.nextPageToken};if(t[Vw])for(const l of t[Vw]){const u=l.replace(/\/$/,""),d=s._makeStorageReference(new nr(e,u));i.prefixes.push(d)}if(t[Uw])for(const l of t[Uw]){const u=s._makeStorageReference(new nr(e,l.name));i.items.push(u)}return i}function kD(s,e,t){const i=l0(t);return i===null?null:_D(s,e,i)}class c0{constructor(e,t,i,l){this.url=e,this.method=t,this.handler=i,this.timeout=l,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function u0(s){if(!s)throw i0()}function ED(s,e){function t(i,l){const u=yE(s,l,e);return u0(u!==null),u}return t}function TD(s,e){function t(i,l){const u=kD(s,e,l);return u0(u!==null),u}return t}function jD(s,e){function t(i,l){const u=yE(s,l,e);return u0(u!==null),wD(u,l,s.host,s._protocol)}return t}function d0(s){function e(t,i){let l;return t.getStatus()===401?t.getErrorText().includes("Firebase App Check token is invalid")?l=O6():l=L6():t.getStatus()===402?l=D6(s.bucket):t.getStatus()===403?l=P6(s.path):l=i,l.status=t.getStatus(),l.serverResponse=i.serverResponse,l}return e}function SD(s){const e=d0(s);function t(i,l){let u=e(i,l);return i.getStatus()===404&&(u=M6(s.path)),u.serverResponse=l.serverResponse,u}return t}function CD(s,e,t,i,l){const u={};e.isRoot?u.prefix="":u.prefix=e.path+"/",t.length>0&&(u.delimiter=t),i&&(u.pageToken=i),l&&(u.maxResults=l);const d=e.bucketOnlyServerUrl(),p=Nf(d,s.host,s._protocol),g="GET",y=s.maxOperationRetryTime,b=new c0(p,g,TD(s,e.bucket),y);return b.urlParams=u,b.errorHandler=d0(e),b}function ND(s,e,t){const i=e.fullServerUrl(),l=Nf(i,s.host,s._protocol),u="GET",d=s.maxOperationRetryTime,p=new c0(l,u,jD(s,t),d);return p.errorHandler=SD(e),p}function AD(s,e){return s&&s.contentType||e&&e.type()||"application/octet-stream"}function RD(s,e,t){const i=Object.assign({},t);return i.fullPath=s.path,i.size=e.size(),i.contentType||(i.contentType=AD(null,e)),i}function ID(s,e,t,i,l){const u=e.bucketOnlyServerUrl(),d={"X-Goog-Upload-Protocol":"multipart"};function p(){let Q="";for(let he=0;he<2;he++)Q=Q+Math.random().toString().slice(2);return Q}const g=p();d["Content-Type"]="multipart/related; boundary="+g;const y=RD(e,i,l),b=xD(y,t),E="--"+g+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+b+`\r
--`+g+`\r
Content-Type: `+y.contentType+`\r
\r
`,T=`\r
--`+g+"--",L=$a.getBlob(E,i,T);if(L===null)throw q6();const W={name:y.fullPath},H=Nf(u,s.host,s._protocol),B="POST",K=s.maxUploadRetryTime,G=new c0(H,B,ED(s,t),K);return G.urlParams=W,G.headers=d,G.body=L.uploadData(),G.errorHandler=d0(e),G}class MD{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Lo.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Lo.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Lo.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,i,l,u){if(this.sent_)throw Kc("cannot .send() more than once");if(io(e)&&i&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(t,e,!0),u!==void 0)for(const d in u)u.hasOwnProperty(d)&&this.xhr_.setRequestHeader(d,u[d].toString());return l!==void 0?this.xhr_.send(l):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Kc("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Kc("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw Kc("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Kc("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class DD extends MD{initXhr(){this.xhr_.responseType="text"}}function h0(){return new DD}class Fo{constructor(e,t){this._service=e,t instanceof nr?this._location=t:this._location=nr.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new Fo(e,t)}get root(){const e=new nr(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return pE(this._location.path)}get storage(){return this._service}get parent(){const e=mD(this._location.path);if(e===null)return null;const t=new nr(this._location.bucket,e);return new Fo(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw W6(e)}}function LD(s,e,t){s._throwIfRoot("uploadBytes");const i=ID(s.storage,s._location,gE(),new $a(e,!0),t);return s.storage.makeRequestWithTokens(i,h0).then(l=>({metadata:l,ref:s}))}function OD(s){const e={prefixes:[],items:[]};return vE(s,e).then(()=>e)}async function vE(s,e,t){const l=await PD(s,{pageToken:t});e.prefixes.push(...l.prefixes),e.items.push(...l.items),l.nextPageToken!=null&&await vE(s,e,l.nextPageToken)}function PD(s,e){e!=null&&typeof e.maxResults=="number"&&Hg("options.maxResults",1,1e3,e.maxResults);const t=e||{},i=CD(s.storage,s._location,"/",t.pageToken,t.maxResults);return s.storage.makeRequestWithTokens(i,h0)}function VD(s){s._throwIfRoot("getDownloadURL");const e=ND(s.storage,s._location,gE());return s.storage.makeRequestWithTokens(e,h0).then(t=>{if(t===null)throw H6();return t})}function UD(s,e){const t=pD(s._location.path,e),i=new nr(s._location.bucket,t);return new Fo(s.storage,i)}function BD(s){return/^[A-Za-z]+:\/\//.test(s)}function zD(s,e){return new Fo(s,e)}function bE(s,e){if(s instanceof f0){const t=s;if(t._bucket==null)throw F6();const i=new Fo(t,t._bucket);return e!=null?bE(i,e):i}else return e!==void 0?UD(s,e):s}function FD(s,e){if(e&&BD(e)){if(s instanceof f0)return zD(s,e);throw qg("To use ref(service, url), the first argument must be a Storage instance.")}else return bE(s,e)}function Bw(s,e){const t=e?.[cE];return t==null?null:nr.makeFromBucketSpec(t,s)}function qD(s,e,t,i={}){s.host=`${e}:${t}`;const l=io(e);l&&(ry(`https://${s.host}/b`),iy("Storage",!0)),s._isUsingEmulator=!0,s._protocol=l?"https":"http";const{mockUserToken:u}=i;u&&(s._overrideAuthToken=typeof u=="string"?u:Bx(u,s.app.options.projectId))}class f0{constructor(e,t,i,l,u,d=!1){this.app=e,this._authProvider=t,this._appCheckProvider=i,this._url=l,this._firebaseVersion=u,this._isUsingEmulator=d,this._bucket=null,this._host=lE,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=R6,this._maxUploadRetryTime=I6,this._requests=new Set,l!=null?this._bucket=nr.makeFromBucketSpec(l,this._host):this._bucket=Bw(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=nr.makeFromBucketSpec(this._url,e):this._bucket=Bw(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){Hg("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){Hg("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(jr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Fo(this,e)}_makeRequest(e,t,i,l,u=!0){if(this._deleted)return new G6(uE());{const d=rD(e,this._appId,i,l,t,this._firebaseVersion,u,this._isUsingEmulator);return this._requests.add(d),d.getPromise().then(()=>this._requests.delete(d),()=>this._requests.delete(d)),d}}async makeRequestWithTokens(e,t){const[i,l]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,i,l).getPromise()}}const zw="@firebase/storage",Fw="0.14.0";const wE="storage";function Rh(s,e,t){return s=fn(s),LD(s,e,t)}function qw(s){return s=fn(s),OD(s)}function Oo(s){return s=fn(s),VD(s)}function Ga(s,e){return s=fn(s),FD(s,e)}function HD(s=Au(),e){s=fn(s);const i=Wo(s,wE).getImmediate({identifier:e}),l=Px("storage");return l&&$D(i,...l),i}function $D(s,e,t,i={}){qD(s,e,t,i)}function WD(s,{instanceIdentifier:e}){const t=s.getProvider("app").getImmediate(),i=s.getProvider("auth-internal"),l=s.getProvider("app-check-internal");return new f0(t,i,l,e,Go)}function GD(){li(new Kr(wE,WD,"PUBLIC").setMultipleInstances(!0)),pr(zw,Fw,""),pr(zw,Fw,"esm2020")}GD();const xE={apiKey:"AIzaSyBCIgMJd3By7qkWH27YiW9VooIBGE3bFLs",authDomain:"mind-core-fitness-client.firebaseapp.com",projectId:"mind-core-fitness-client",storageBucket:"mind-core-fitness-client.firebasestorage.app",messagingSenderId:"669343392406",appId:"1:669343392406:web:f5a35ee062387e7d6f58b7"},m0=ly(xE),Co=S_(m0),ye=g6(m0),Ka=HD(m0),KD=ly(xE,"secondary"),IO=S_(KD),YD="EYdciKDOi3UYBLk1u8hHams5tmO2",_E=w.createContext();function Ar(){return w.useContext(_E)}function QD({children:s}){const[e,t]=w.useState(null),[i,l]=w.useState(!1),[u,d]=w.useState(!1),[p,g]=w.useState(null),[y,b]=w.useState(!0);w.useEffect(()=>{let G=null;const Q=ZA(Co,he=>{if(t(he),G&&(G(),G=null),he)if(he.uid===YD)l(!0),d(!1),g(null),b(!1);else{l(!1);const Ee=Yt(ht(ye,"clients"),xt("uid","==",he.uid)),ge=async()=>{const C=localStorage.getItem("mcf_clientId");if(C)try{const j=await Es(We(ye,"clients",C));j.exists()&&(d(!0),g({id:j.id,...j.data()}))}catch(j){console.error("Direct client read failed:",j)}};G=aE(Ee,async C=>{if(C.empty)await ge();else{const j=C.docs[0];d(!0),g({id:j.id,...j.data()});try{localStorage.setItem("mcf_clientId",j.id)}catch{}}b(!1)},async C=>{console.error("Error listening to client data:",C),await ge(),b(!1)})}else l(!1),d(!1),g(null),b(!1)});return()=>{Q(),G&&G()}},[]);const K={currentUser:e,isAdmin:i,isClient:u,clientData:p,updateClientData:G=>{g(Q=>Q?{...Q,...G}:G)},resolveClient:async()=>{if(p)return p;const G=localStorage.getItem("mcf_clientId");if(G)try{const Q=await Es(We(ye,"clients",G));if(Q.exists()){const he={id:Q.id,...Q.data()};return d(!0),g(he),he}}catch(Q){console.error("resolveClient direct read failed:",Q)}if(e){const Q=Yt(ht(ye,"clients"),xt("uid","==",e.uid)),he=await Ht(Q);if(!he.empty){const Ee={id:he.docs[0].id,...he.docs[0].data()};return d(!0),g(Ee),Ee}}return null},login:async(G,Q,he=!0)=>(await j2(Co,he?Tg:py),await QA(Co,G,Q)),signup:async(G,Q,he)=>{await j2(Co,Tg);const Ee=await YA(Co,Q.trim().toLowerCase(),he),ge=Ee.user,C=We(ht(ye,"clients")),j={uid:ge.uid,name:G.trim(),email:Q.trim().toLowerCase(),clientType:"core_buddy",coreBuddyAccess:!0,status:"active",tier:"free",subscriptionStatus:null,signupSource:"self_signup",createdAt:At.now()};await Ts(C,j),d(!0),g({id:C.id,...j});try{localStorage.setItem("mcf_clientId",C.id)}catch{}return Ee},logout:()=>{try{localStorage.removeItem("mcf_clientId")}catch{}return e4(Co)},resetPassword:G=>KA(Co,G),loading:y};return a.jsx(_E.Provider,{value:K,children:s})}const kE=w.createContext();function Mi(){return w.useContext(kE)}function XD({children:s}){const[e,t]=w.useState(()=>{const g=localStorage.getItem("theme");return g?g==="dark":window.matchMedia("(prefers-color-scheme: dark)").matches}),[i,l]=w.useState(()=>localStorage.getItem("accent")||"red");w.useEffect(()=>{document.documentElement.setAttribute("data-theme",e?"dark":"light"),localStorage.setItem("theme",e?"dark":"light")},[e]),w.useEffect(()=>{localStorage.setItem("accent",i)},[i]);const p={isDark:e,toggleTheme:()=>{document.documentElement.setAttribute("data-theme-transitioning",""),t(!e),setTimeout(()=>{document.documentElement.removeAttribute("data-theme-transitioning")},350)},accent:i,setAccent:g=>l(g)};return a.jsx(kE.Provider,{value:p,children:s})}const EE=w.createContext();function ic(){return w.useContext(EE)}const JD=["nutrition","buddies"],ZD=[5,10],e3=2,t3=1;function n3({children:s}){const{clientData:e,loading:t}=Ar(),i=w.useMemo(()=>{const l=e?.tier||"free",u=e?.subscriptionStatus||null,d=e&&e.signupSource!=="self_signup",p=l==="premium"||!!d;function g(y){return p?!0:!JD.includes(y)}return{tier:l,subscriptionStatus:u,isPremium:p,canAccess:g,loading:t,FREE_RANDOMISER_DURATIONS:ZD,FREE_RANDOMISER_WEEKLY_LIMIT:e3,FREE_HABIT_LIMIT:t3}},[e?.tier,e?.subscriptionStatus,e?.signupSource,t]);return a.jsx(EE.Provider,{value:i,children:s})}function s3(s){if(s?.signupSource==="self_signup"&&!s?.onboardingComplete)return"/onboarding";const e=s?.clientType;return e==="core_buddy"?"/client/core-buddy":e==="circuit_vip"||e==="circuit_dropin"?"/client/circuit":"/client"}function r3({className:s=""}){const{isDark:e,toggleTheme:t}=Mi();return a.jsx("button",{className:s||"theme-toggle",onClick:t,"aria-label":e?"Switch to light mode":"Switch to dark mode",children:e?a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20",children:a.jsx("path",{d:"M12 3a9 9 0 109 9c0-.46-.04-.92-.1-1.36a5.389 5.389 0 01-4.4 2.26 5.403 5.403 0 01-3.14-9.8c-.44-.06-.9-.1-1.36-.1z"})}):a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20",children:a.jsx("path",{d:"M12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zM2 13h2c.55 0 1-.45 1-1s-.45-1-1-1H2c-.55 0-1 .45-1 1s.45 1 1 1zm18 0h2c.55 0 1-.45 1-1s-.45-1-1-1h-2c-.55 0-1 .45-1 1s.45 1 1 1zM11 2v2c0 .55.45 1 1 1s1-.45 1-1V2c0-.55-.45-1-1-1s-1 .45-1 1zm0 18v2c0 .55.45 1 1 1s1-.45 1-1v-2c0-.55-.45-1-1-1s-1 .45-1 1zM5.99 4.58a.996.996 0 00-1.41 0 .996.996 0 000 1.41l1.06 1.06c.39.39 1.03.39 1.41 0s.39-1.03 0-1.41L5.99 4.58zm12.37 12.37a.996.996 0 00-1.41 0 .996.996 0 000 1.41l1.06 1.06c.39.39 1.03.39 1.41 0a.996.996 0 000-1.41l-1.06-1.06zm1.06-10.96a.996.996 0 000-1.41.996.996 0 00-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06zM7.05 18.36a.996.996 0 000-1.41.996.996 0 00-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06z"})})})}function i3(){const[s,e]=w.useState(""),[t,i]=w.useState(""),[l,u]=w.useState(!0),[d,p]=w.useState(""),[g,y]=w.useState(!1),[b,E]=w.useState(!1),[T,L]=w.useState(!1),{login:W,resetPassword:H,currentUser:B,isAdmin:K,isClient:G,clientData:Q,loading:he}=Ar(),Ee=Ys();if(w.useEffect(()=>{if(!he&&B){if(!B.emailVerified&&Q?.signupSource==="self_signup"){Ee("/signup");return}K?Ee("/dashboard"):G?Ee(s3(Q)):(y(!1),p("No account found. Please sign up or contact your trainer."))}},[he,B,K,G,Q,Ee]),he||B)return a.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",minHeight:"100vh",background:"var(--bg-body)"},children:a.jsx("div",{style:{width:36,height:36,border:"3px solid var(--color-primary-light)",borderTopColor:"var(--color-primary)",borderRadius:"50%",animation:"app-spin .7s linear infinite"}})});const ge=async j=>{j.preventDefault(),p(""),y(!0);try{await W(s,t,l)}catch(R){p(R.message||"Failed to log in"),y(!1)}},C=async j=>{if(j.preventDefault(),p(""),!s.trim()){p("Please enter your email address");return}y(!0);try{await H(s.trim()),L(!0)}catch(R){R.code==="auth/user-not-found"?p("No account found with this email"):p(R.message||"Failed to send reset email")}y(!1)};return a.jsxs("div",{className:"login-container",children:[a.jsx(r3,{className:"login-theme-toggle"}),a.jsxs("div",{className:"login-card",children:[a.jsxs("div",{className:"login-header",children:[a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"login-logo"}),a.jsx("p",{children:a.jsx("strong",{children:b?"Reset Password":"Sign in as 1-2-1 or a Core Buddy"})})]}),d&&a.jsx("div",{className:"error-message",children:d}),T?a.jsxs("div",{className:"reset-sent",children:[a.jsx("div",{className:"reset-sent-icon",children:a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M22 2L11 13",strokeLinecap:"round",strokeLinejoin:"round"}),a.jsx("path",{d:"M22 2L15 22L11 13L2 9L22 2Z",strokeLinecap:"round",strokeLinejoin:"round"})]})}),a.jsx("p",{children:"Reset email sent!"}),a.jsx("span",{children:"Check your inbox for a password reset link"}),a.jsx("button",{className:"login-btn",style:{marginTop:"20px"},onClick:()=>{E(!1),L(!1),p("")},children:"Back to Log In"})]}):b?a.jsxs("form",{onSubmit:C,children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"email",children:"Email"}),a.jsx("input",{type:"email",id:"email",value:s,onChange:j=>e(j.target.value),placeholder:"Enter your email",required:!0})]}),a.jsx("button",{type:"submit",className:"login-btn",disabled:g,children:g?"Sending...":"Send Reset Link"}),a.jsx("button",{type:"button",className:"forgot-link",onClick:()=>{E(!1),p("")},children:"Back to Log In"})]}):a.jsxs(a.Fragment,{children:[a.jsxs("form",{onSubmit:ge,children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"email",children:"Email"}),a.jsx("input",{type:"email",id:"email",value:s,onChange:j=>e(j.target.value),required:!0})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"password",children:"Password"}),a.jsx("input",{type:"password",id:"password",value:t,onChange:j=>i(j.target.value),required:!0})]}),a.jsx("div",{className:"remember-me",children:a.jsxs("label",{children:[a.jsx("input",{type:"checkbox",checked:l,onChange:j=>u(j.target.checked)}),a.jsx("span",{children:"Remember me"})]})}),a.jsx("button",{type:"submit",className:"login-btn",disabled:g,children:g?"Logging in...":"Log In"})]}),a.jsx("button",{type:"button",className:"forgot-link",onClick:()=>{E(!0),p("")},children:"Forgot password?"}),a.jsx("button",{type:"button",className:"login-btn login-btn-outline",onClick:()=>Ee("/signup"),children:"Don't have an account? Create one free"})]}),a.jsx("a",{href:"/",className:"back-link",children:"Back to website"})]})]})}function fh({feature:s,children:e}){const{canAccess:t,loading:i}=ic();return i||t(s)?e:a.jsx(Sx,{to:"/upgrade",replace:!0})}function Yr({active:s}){const e=Ys(),{clientData:t}=Ar(),{isPremium:i}=ic(),l=t?.clientType==="block"&&t?.coreBuddyAccess;return a.jsxs("nav",{className:"block-bottom-nav",children:[a.jsxs("button",{className:`block-nav-tab${s==="home"?" active":""}`,onClick:()=>e("/client/core-buddy"),children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"12",cy:"7",r:"4"})]}),a.jsx("span",{children:"Profile"})]}),a.jsxs("button",{className:`block-nav-tab${s==="workouts"?" active":""}`,onClick:()=>e("/client/core-buddy/workouts"),children:[a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"currentColor",stroke:"none",children:a.jsx("path",{d:"M1 9h2v6H1V9zm3-2h2v10H4V7zm3 4h10v2H7v-2zm10-4h2v10h-2V7zm3 2h2v6h-2V9z"})}),a.jsx("span",{children:"Workout"})]}),i&&a.jsxs("button",{className:`block-nav-tab${s==="nutrition"?" active":""}`,onClick:()=>e("/client/core-buddy/nutrition"),children:[a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M18 8h1a4 4 0 0 1 0 8h-1M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z"})}),a.jsx("span",{children:"Nutrition"})]}),i&&a.jsxs("button",{className:`block-nav-tab${s==="buddies"?" active":""}`,onClick:()=>e("/client/core-buddy/buddies"),children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"9",cy:"7",r:"4"}),a.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),a.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),a.jsx("span",{children:"Buddies"})]}),a.jsxs("button",{className:`block-nav-tab${s==="badges"?" active":""}`,onClick:()=>e("/client/core-buddy/badges"),children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"12",cy:"8",r:"6"}),a.jsx("path",{d:"M9 14l-4 8h14l-4-8"})]}),a.jsx("span",{children:"Badges"})]}),l&&a.jsxs("button",{className:"block-nav-tab",onClick:()=>e("/client"),children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"3",width:"7",height:"7"}),a.jsx("rect",{x:"14",y:"3",width:"7",height:"7"}),a.jsx("rect",{x:"14",y:"14",width:"7",height:"7"}),a.jsx("rect",{x:"3",y:"14",width:"7",height:"7"})]}),a.jsx("span",{children:"Block"})]})]})}function Jo({children:s,onRefresh:e}){const[t,i]=w.useState(0),[l,u]=w.useState(!1),d=w.useRef(null),p=w.useRef(0),g=w.useRef(!1),y=w.useCallback(T=>{window.scrollY<=0&&(p.current=T.touches[0].clientY,g.current=!0)},[]),b=w.useCallback(T=>{if(!g.current||l)return;const L=T.touches[0].clientY-p.current;L>20&&window.scrollY<=0&&(T.preventDefault(),i(Math.min((L-20)*.35,80)))},[l]),E=w.useCallback(async()=>{t>55&&!l&&(u(!0),e?await e():window.location.reload(),u(!1)),i(0),g.current=!1},[t,l,e]);return a.jsxs("div",{ref:d,onTouchStart:y,onTouchMove:b,onTouchEnd:E,children:[a.jsxs("div",{className:`pull-refresh-indicator ${t>0?"visible":""} ${l?"refreshing":""}`,style:{height:t},children:[a.jsx("div",{className:`refresh-spinner ${l?"spinning":""}`,children:a.jsx("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:a.jsx("path",{fill:"currentColor",d:"M17.65 6.35A7.958 7.958 0 0012 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08A5.99 5.99 0 0112 18c-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"})})}),a.jsx("span",{className:"refresh-text",children:l?"Refreshing...":"Pull to refresh"})]}),s]})}function qu(s,e,t,i,l){const u=[];for(let d=0;d<s;d++){const p=(d*(360/s)-90)*(Math.PI/180);u.push({x1:e+i*Math.cos(p),y1:t+i*Math.sin(p),x2:e+l*Math.cos(p),y2:t+l*Math.sin(p),thick:d%5===0})}return u}const TE=qu(60,100,100,85,96),a3=qu(60,100,100,78,94),o3=qu(60,100,100,82,94);qu(60,50,50,38,46);const MO=qu(60,40,40,30,37);function l3({steps:s,onFinish:e,active:t}){const[i,l]=w.useState(0),[u,d]=w.useState(null),[p,g]=w.useState("below"),[y,b]=w.useState(!1),E=w.useRef(null),T=w.useRef(t);T.current=t,w.useEffect(()=>{t||l(0)},[t]),w.useEffect(()=>{if(!t)return;const Ee=ge=>ge.preventDefault();return document.addEventListener("touchmove",Ee,{passive:!1}),document.addEventListener("wheel",Ee,{passive:!1}),document.body.style.overflow="hidden",()=>{document.removeEventListener("touchmove",Ee),document.removeEventListener("wheel",Ee),document.body.style.overflow=""}},[t]);const L=w.useMemo(()=>t?s.filter(Ee=>document.querySelector(Ee.selector)):[],[t]),W=L[i],H=i===L.length-1,B=W?.selector,K=w.useCallback(()=>{if(!B)return;const Ee=document.querySelector(B);if(!Ee){d(null);return}const ge=Ee.getBoundingClientRect(),C=8;d({top:ge.top-C,left:ge.left-C,width:ge.width+C*2,height:ge.height+C*2});const j=window.innerHeight-ge.bottom;g(j<260?"above":"below")},[B]);if(w.useEffect(()=>{if(!t||!B)return;b(!0);const Ee=document.querySelector(B);if(Ee){document.body.style.overflow="",Ee.scrollIntoView({behavior:"smooth",block:"center"});let ge=null,C=0,j=0;const R=60,V=()=>{j++;const A=Ee.getBoundingClientRect(),Le=Math.round(A.top);if(ge!==null&&Le===ge?C++:C=0,ge=Le,C>=3||j>=R){T.current&&(document.body.style.overflow="hidden"),K(),b(!1);return}O=requestAnimationFrame(V)};let O;const D=setTimeout(()=>{O=requestAnimationFrame(V)},120);return()=>{clearTimeout(D),O&&cancelAnimationFrame(O),T.current&&(document.body.style.overflow="hidden")}}},[t,i,B,K]),w.useEffect(()=>{if(!t)return;const Ee=()=>{E.current&&cancelAnimationFrame(E.current),E.current=requestAnimationFrame(K)};return window.addEventListener("scroll",Ee,!0),window.addEventListener("resize",Ee),()=>{window.removeEventListener("scroll",Ee,!0),window.removeEventListener("resize",Ee),E.current&&cancelAnimationFrame(E.current)}},[t,K]),!t||!W||L.length===0)return null;const G=()=>{H?e():l(i+1)},Q=()=>{i>0&&l(i-1)},he=()=>e();return a.jsxs("div",{className:"st-overlay",onClick:Ee=>{Ee.stopPropagation()},children:[a.jsx("div",{className:"st-backdrop",onClick:G}),u&&a.jsx("div",{className:`st-spotlight${y?" st-transitioning":""}`,style:{top:u.top,left:u.left,width:u.width,height:u.height}}),u&&a.jsxs("div",{className:`st-tooltip st-tooltip-${p}${y?" st-transitioning":""}`,style:{top:p==="below"?Math.min(Math.max(u.top+u.height+16,16),window.innerHeight-200):void 0,bottom:p==="above"?Math.min(Math.max(window.innerHeight-u.top+16,16),window.innerHeight-60):void 0,left:Math.max(16,Math.min(u.left,window.innerWidth-320))},children:[a.jsx("div",{className:"st-dots",children:L.map((Ee,ge)=>a.jsx("span",{className:`st-dot${ge===i?" active":""}${ge<i?" done":""}`},ge))}),a.jsx("h3",{className:"st-title",children:W.title}),a.jsx("p",{className:"st-body",children:W.body}),a.jsxs("div",{className:"st-actions",children:[i>0&&a.jsx("button",{className:"st-btn st-btn-back",onClick:Q,children:"Back"}),a.jsx("button",{className:"st-btn st-btn-next",onClick:G,children:W.cta||(H?"Let's Go!":"Next")})]}),a.jsx("button",{className:"st-skip",onClick:he,children:"Skip tour"})]})]})}const c3="/login/assets/first_workout-B8SFkzJX.PNG",u3="/login/assets/workouts_10-Z5R3u0xH.PNG",d3="/login/assets/workouts_25-CzxSlcAj.PNG",h3="/login/assets/workouts_50-BpzWup3V.PNG",f3="/login/assets/workouts_100-D7_r6tn1.PNG",m3="/login/assets/streak_2-CsRr-XA9.PNG",p3="/login/assets/streak_4-BHO09tbw.PNG",g3="/login/assets/streak_8-DX2UWMko.PNG",y3="/login/assets/nutrition_7-CHVV11fj.PNG",v3="/login/assets/leaderboard_join-BLoId4Hz.PNG",b3="/login/assets/habits_7-Dvki70KO.PNG",w3="/login/assets/starter_streak-CCltAfrC.PNG",x3="/login/assets/consistency_king-Cho2jxBt.PNG",_3="/login/assets/thirty_in_thirty-B0BVHafW.PNG",k3="/login/assets/minute_master-hA2RLkIL.PNG",E3="/login/assets/habit_machine--nFXaIUW.PNG",T3="/login/assets/iron_will-Dh2dTaie.PNG",Ja=[{id:"first_workout",img:c3,name:"First Rep",desc:"Complete your first workout",category:"workouts",threshold:1},{id:"workouts_10",img:u3,name:"On Fire",desc:"Complete 10 workouts",category:"workouts",threshold:10},{id:"workouts_25",img:d3,name:"Dedicated",desc:"Complete 25 workouts",category:"workouts",threshold:25},{id:"workouts_50",img:h3,name:"Unstoppable",desc:"Complete 50 workouts",category:"workouts",threshold:50},{id:"workouts_100",img:f3,name:"Century",desc:"Complete 100 workouts",category:"workouts",threshold:100},{id:"streak_2",img:m3,name:"2 Week Streak",desc:"Work out for 2 weeks in a row",category:"streaks",threshold:2},{id:"streak_4",img:p3,name:"Month Strong",desc:"Work out for 4 weeks in a row",category:"streaks",threshold:4},{id:"streak_8",img:g3,name:"Iron Will",desc:"Work out for 8 weeks in a row",category:"streaks",threshold:8},{id:"nutrition_7",img:y3,name:"Macro Master",desc:"Hit your macro targets 7 days in a row",category:"nutrition",threshold:7},{id:"leaderboard_join",img:v3,name:"Competitor",desc:"Join the leaderboard",category:"leaderboard",threshold:1},{id:"habits_7",img:b3,name:"Habit Streak",desc:"Complete your daily habits 7 days in a row",category:"habits",threshold:7},{id:"starter_streak",img:w3,name:"Starter Streak",desc:"Complete 5 workouts in 7 days",category:"challenges",threshold:1},{id:"consistency_king",img:x3,name:"Consistency King",desc:"Complete 12 workouts in 30 days",category:"challenges",threshold:1},{id:"thirty_in_thirty",img:_3,name:"30 in 30",desc:"Complete 30 workouts in 30 days",category:"challenges",threshold:1},{id:"minute_master",img:k3,name:"Minute Master",desc:"Train for 300 total minutes in 30 days",category:"challenges",threshold:1},{id:"habit_machine",img:E3,name:"Habit Machine",desc:"Hit all daily habits for 7 days straight",category:"challenges",threshold:1},{id:"iron_will",img:T3,name:"Iron Will",desc:"Work out every day for 14 days straight",category:"challenges",threshold:1}],Hw=3,$w=5,j3=["trained","protein","steps","sleep","water"];function Qp(s){return s.toISOString().split("T")[0]}const Xp=[{text:"You have 24 hours a day...",bold:"make it count"},{text:"Discipline beats motivation...",bold:"every single time"},{text:"Rest when you're done,",bold:"not when you're tired"},{text:"Small daily gains...",bold:"create massive results"},{text:"Your body keeps score,",bold:"train it well"},{text:"Consistency over intensity...",bold:"always wins"},{text:"The only bad workout...",bold:"is the one you skipped"}],Yc={morning:[{main:"Rise and grind,",sub:"let's get after it!"},{main:"New day, new gains,",sub:"let's build something!"},{main:"The early bird gets the gains,",sub:"let's go!"},{main:"Winners wake up ready,",sub:"you showed up!"}],afternoon:[{main:"Oye",sub:"crack on and make it count!"},{main:"Halfway through the day,",sub:"don't ease off now!"},{main:"Afternoon push,",sub:"this is where champions are made!"},{main:"Still time to make today count,",sub:"let's go!"}],evening:[{main:"Evening session?",sub:"Let's finish strong!"},{main:"End the day on a high,",sub:"you earned it!"},{main:"Night owls lift heavier,",sub:"prove it!"},{main:"One more session today?",sub:"Close it out!"}],night:[{main:"Burning the midnight oil,",sub:"Respect the hustle!"},{main:"Late night dedication,",sub:"that's what sets you apart!"},{main:"While they sleep,",sub:"you grind!"}],allDone:[{main:"Smashed it today,",sub:"Rest up and go again tomorrow."},{main:"All tasks crushed,",sub:"Absolute machine!"},{main:"Nothing left undone,",sub:"That's elite-level discipline."}]};function Jp(s){if(!s)return"";const e=s instanceof Date?s:s.toDate?s.toDate():new Date(s),t=Math.floor((new Date-e)/1e3);return t<60?"just now":t<3600?`${Math.floor(t/60)}m ago`:t<86400?`${Math.floor(t/3600)}h ago`:t<604800?`${Math.floor(t/86400)}d ago`:e.toLocaleDateString("en-GB",{day:"numeric",month:"short"})}function Qc(s){if(!s)return"?";const e=s.trim().split(/\s+/);return e.length===1?e[0][0].toUpperCase():(e[0][0]+e[e.length-1][0]).toUpperCase()}function S3(s,e=800){return new Promise(t=>{const i=new Image;i.onload=()=>{const l=document.createElement("canvas");let u=i.width,d=i.height;u>d?u>e&&(d=Math.round(d*e/u),u=e):d>e&&(u=Math.round(u*e/d),d=e),l.width=u,l.height=d,l.getContext("2d").drawImage(i,0,0,u,d),l.toBlob(p=>t(p),"image/jpeg",.8)},i.src=URL.createObjectURL(s)})}function C3(){const{currentUser:s,isClient:e,clientData:t,logout:i,updateClientData:l,loading:u}=Ar(),{isDark:d,toggleTheme:p}=Mi(),{isPremium:g,FREE_HABIT_LIMIT:y}=ic(),b=Ys(),[E,T]=w.useState(g?$w:y),L=E,[W,H]=w.useState({hours:0,minutes:0,seconds:0}),[B,K]=w.useState(0),[G,Q]=w.useState(0),[he,Ee]=w.useState(0),[ge,C]=w.useState(!1),[j,R]=w.useState({protein:0,carbs:0,fats:0,calories:0}),[V,O]=w.useState(null),[D,A]=w.useState(0),[Le,Je]=w.useState(0),[X,je]=w.useState(Hw),[De,Ce]=w.useState(!1),[J,P]=w.useState(!1),[re,we]=w.useState([]),[_e,xe]=w.useState(null),[Se,Fe]=w.useState(!1),Ze=w.useRef(null),[Oe,Mt]=w.useState(0),[cn,qn]=w.useState(0),[Qt,rt]=w.useState(null),st=w.useCallback((k,M="info")=>{rt({message:k,type:M}),setTimeout(()=>rt(null),4e3)},[]),[ct,En]=w.useState([]),[fe,Ct]=w.useState(!1),[ft,Rt]=w.useState(""),[Qe,Tt]=w.useState(null),[pt,Xt]=w.useState(null),[zs,es]=w.useState(!1),[Wt,se]=w.useState(new Set),[Ae,gt]=w.useState(new Set),[vt,ut]=w.useState({}),[He,nt]=w.useState({}),[$e,rn]=w.useState({}),[Jt,Rn]=w.useState({}),[On,Kn]=w.useState({}),[Zt,Hn]=w.useState({}),Cn=w.useRef(null),yn=w.useRef(null),Ss=w.useRef({}),[le,Me]=w.useState([]),[Ye,yt]=w.useState(!1),it=w.useRef(null),[Gt,vn]=w.useState([]),[an,Kt]=w.useState(""),[vs,Nn]=w.useState(!1),[bs,en]=w.useState(null),[un,cs]=w.useState([]),[Qr,fa]=w.useState(null),[Xr,gr]=w.useState(!1),$n=w.useRef(!1),[Fs,ws]=w.useState(null),[Pn,In]=w.useState(!1),ts=w.useRef(!1),Ft=(()=>{const k=[{selector:".cb-ring-container",title:"Your 24-Hour Countdown",body:"Every day resets. This ring tracks the time you have left  tap your photo to personalise your profile.",cta:"Next"},{selector:".cb-stats-row",title:"Progress at a Glance",body:"Your workout streak, sessions this week, and daily habits  all in one row. These fill up as you go."},{selector:".cb-nudge-card",title:"Smart Suggestions",body:"We'll highlight what needs your attention  your next session, unfinished habits, or a meal to log."},{selector:".cb-card-workouts-hero",title:"Workout",body:"Randomiser workouts  pick your focus, level and time. Save and replay your favourites.",cta:"Next"}];return g&&k.push({selector:".cb-card-nutrition",title:"Nutrition Tracking",body:"Set your macro targets, scan barcodes, and log meals to hit your daily goals."},{selector:".cb-card-consistency",title:"Daily Habits",body:"5 simple habits each day  train, hit protein, 10k steps, sleep, and hydrate. Build your streak."},{selector:".cb-card-buddies",title:"Buddies & Social",body:"Connect with other members, share your journey, and keep each other accountable."},{selector:".cb-journey-section",title:"Share Your Journey",body:"Post photos, updates, and milestones  your fitness journey in one place. Like and comment on each other's posts."}),k.push({selector:".block-bottom-nav",title:"You're All Set!",body:"Use the nav bar to jump between your profile, workouts, nutrition, and buddies. Time to get after it.",cta:"Let's Go!"}),k})();w.useEffect(()=>{!u&&!s&&b("/")},[u,s,b]),w.useEffect(()=>{!u&&t&&t.signupSource==="self_signup"&&!t.onboardingComplete&&b("/onboarding")},[u,t,b]),w.useEffect(()=>{let k=t?.tourComplete||ts.current;if(!k&&t?.id)try{k=!!localStorage.getItem(`tourDone_${t.id}`)}catch{}if(ge&&t&&!k){const M=setTimeout(()=>In(!0),600);return()=>clearTimeout(M)}},[ge,t]),w.useEffect(()=>{if(!(!ge||!t?.id)){try{if(localStorage.getItem(`targetHint_${t.id}`))return}catch{}if(!t?.weeklyWorkoutTarget){const k=setTimeout(()=>P(!0),1500);return()=>clearTimeout(k)}}},[ge,t]),w.useEffect(()=>{if(t)try{const k=sessionStorage.getItem(`cbDash_${t.id}`);if(k){const M=JSON.parse(k);Q(M.totalWorkouts??0),Ee(M.habitWeekPct??0),R(M.nutritionTotals??{protein:0,carbs:0,fats:0,calories:0}),O(M.nutritionTargetData??null),A(M.todayHabitsCount??0),M.realHabitCount&&T(M.realHabitCount),Je(M.weeklyWorkouts??0),je(M.weeklyWorkoutTarget??Hw),we(M.leaderboardTop3??[]),Mt(M.streakWeeks??0),C(!0)}}catch{}},[t]),w.useEffect(()=>{t?.photoURL&&xe(t.photoURL),t?.weeklyWorkoutTarget&&je(t.weeklyWorkoutTarget)},[t]),w.useEffect(()=>{if(!t)return;const k=Yt(ht(ye,"notifications"),xt("toId","==",t.id)),M=aE(k,q=>{const te=q.docs.map(me=>({id:me.id,...me.data()}));te.sort((me,Ie)=>{const Ne=me.createdAt?.toMillis?.()||0;return(Ie.createdAt?.toMillis?.()||0)-Ne}),Me(te.slice(0,50))},q=>{console.error("Notification listener error:",q),q.code==="permission-denied"&&console.warn("Firestore rules may be missing for the notifications collection. Please update your Firestore rules in the Firebase Console.")});return()=>M()},[t]),w.useEffect(()=>{const k=M=>{it.current&&!it.current.contains(M.target)&&yt(!1)};return document.addEventListener("mousedown",k),()=>document.removeEventListener("mousedown",k)},[]),w.useEffect(()=>{if(!t)return;const k=t.id;(async()=>{try{const[M,q,te]=await Promise.all([Ht(Yt(ht(ye,"buddies"),xt("user1","==",k))),Ht(Yt(ht(ye,"buddies"),xt("user2","==",k))),Ht(ht(ye,"clients"))]),me=new Set;[...M.docs,...q.docs].forEach(Ne=>{const Be=Ne.data();me.add(Be.user1===k?Be.user2:Be.user1)});const Ie={};te.docs.forEach(Ne=>{Ie[Ne.id]=Ne.data()}),vn(Array.from(me).filter(Ne=>Ie[Ne]).map(Ne=>({id:Ne,name:Ie[Ne].name,photoURL:Ie[Ne].photoURL||null})))}catch(M){console.error("Error loading buddies for mentions:",M)}})()},[t]);const yr=le.filter(k=>!k.read).length,Rr=async()=>{const k=le.filter(q=>!q.read);if(!k.length)return;const M=Ow(ye);k.forEach(q=>M.update(We(ye,"notifications",q.id),{read:!0})),await M.commit()},xs=async()=>{if(!le.length)return;const k=Ow(ye);le.forEach(M=>k.delete(We(ye,"notifications",M.id))),await k.commit()},Tn=async(k,M,q={})=>{if(!(!t||k===t.id))try{await mr(ht(ye,"notifications"),{toId:k,fromId:t.id,fromName:t.name||"Someone",fromPhotoURL:t.photoURL||null,type:M,read:!1,createdAt:Rs(),...q})}catch(te){console.error("Notification create error:",te),te.code==="permission-denied"&&st("Notifications blocked  check Firestore rules","error")}},Qs=(k,M)=>{const q=M==="compose"?Cn.current?.selectionStart:null,me=(q!=null?k.slice(0,q):k).match(/@(\w*)$/);if(me){Nn(!0),en(M),Kt(me[1].toLowerCase());const Ie=Gt.filter(Ne=>Ne.name&&Ne.name.toLowerCase().includes(me[1].toLowerCase())).slice(0,5);cs(Ie)}else Nn(!1),cs([])},Jr=(k,M)=>{if(M==="compose"){const q=Cn.current,te=ft,me=q?.selectionStart??te.length,Ie=te.slice(0,me),Ne=te.slice(me),Be=Ie.replace(/@\w*$/,`@${k.name} `);Rt(Be+Ne),setTimeout(()=>{q?.focus(),q.selectionStart=q.selectionEnd=Be.length},0)}else{const te=(He[M]||"").replace(/@\w*$/,`@${k.name} `);nt(me=>({...me,[M]:te}))}Nn(!1),cs([])},I=k=>k&&k.split(/(@\w[\w\s]*?\s)/g).map((q,te)=>q.startsWith("@")&&Gt.some(me=>q.trim()===`@${me.name}`)?a.jsx("span",{className:"mention-highlight",children:q.trim()},te):q),z=async k=>{const M=k.target.files?.[0];if(!(!M||!t)){if(!M.type.startsWith("image/")){st("Please select an image file","error");return}if(M.size>5*1024*1024){st("Image must be under 5MB","error");return}Fe(!0);try{const q=await new Promise(Ie=>{const Ne=new Image;Ne.onload=()=>{const Be=document.createElement("canvas"),Re=400;let at=Ne.width,bn=Ne.height;at>bn?(bn=bn/at*Re,at=Re):(at=at/bn*Re,bn=Re),Be.width=at,Be.height=bn,Be.getContext("2d").drawImage(Ne,0,0,at,bn),Be.toBlob(et=>Ie(et),"image/jpeg",.75)},Ne.src=URL.createObjectURL(M)}),te=Ga(Ka,`profilePhotos/${t.id}`);await Rh(te,q);const me=await Oo(te);await ls(We(ye,"clients",t.id),{photoURL:me}),xe(me),l({photoURL:me}),st("Profile photo updated!","success")}catch(q){console.error("Photo upload error:",q),st("Failed to upload photo","error")}Fe(!1),Ze.current&&(Ze.current.value="")}};w.useEffect(()=>{const k=()=>{const q=new Date,te=new Date(q);te.setHours(23,59,59,999);const me=te-q,Ie=Math.floor(me/(1e3*60*60)),Ne=Math.floor(me%(1e3*60*60)/(1e3*60)),Be=Math.floor(me%(1e3*60)/1e3);H({hours:Ie,minutes:Ne,seconds:Be}),K(60-Be)};k();const M=setInterval(k,1e3);return()=>clearInterval(M)},[]),w.useEffect(()=>{const k=setInterval(()=>{qn(M=>(M+1)%Xp.length)},8e3);return()=>clearInterval(k)},[]),w.useEffect(()=>{if(!s||!t)return;(async()=>{let M=null,q=null;try{const te=Qp(new Date),me=ht(ye,"workoutLogs"),Ie=Yt(me,xt("clientId","==",t.id));M=await Ht(Ie),Q(M.docs.length);const Ne=new Date,Be=Ne.getDay(),Re=Be===0?6:Be-1,at=new Date(Ne);at.setDate(Ne.getDate()-Re),at.setHours(0,0,0,0);const bn=at.getTime(),et=M.docs.filter(Un=>{const mn=Un.data().completedAt;return mn?(mn.toDate?mn.toDate().getTime():new Date(mn).getTime())>=bn:!1}).length;Je(et);const[tn,jn]=await Promise.all([Ht(Yt(ht(ye,"habitLogs"),xt("clientId","==",t.id),xt("date","==",te))),Es(We(ye,"customHabits",t.id))]);let dt=$w;if(jn.exists()){const Un=jn.data(),mn=Un.habits||[],Wn=Un.hiddenDefaults||[];dt=j3.filter(ei=>!Wn.includes(ei)).length+mn.length}g||(dt=Math.min(dt,y)),T(dt);let It=0;if(!tn.empty){const Un=tn.docs[0].data().habits||{};It=Object.values(Un).filter(Boolean).length}Ee(Math.round(It/dt*100)),A(It);const dn=await Es(We(ye,"nutritionTargets",t.id));dn.exists()&&(O(dn.data()),q=dn.data());const _s=await Es(We(ye,"nutritionLogs",`${t.id}_${te}`));if(_s.exists()){const mn=(_s.data().entries||[]).reduce((Wn,us)=>({protein:Wn.protein+(us.protein||0),carbs:Wn.carbs+(us.carbs||0),fats:Wn.fats+(us.fats||0),calories:Wn.calories+(us.calories||0)}),{protein:0,carbs:0,fats:0,calories:0});R(mn)}}catch(te){console.error("Error loading dashboard stats:",te)}try{const te=ht(ye,"clients"),me=Yt(te,xt("leaderboardOptIn","==",!0)),Ne=(await Ht(me)).docs.map(Be=>({id:Be.id,name:Be.data().name,photoURL:Be.data().photoURL||null}));if(we(Ne.slice(0,3)),t?.id){const Be=Ne.findIndex(at=>at.id===t.id),Re=Be>=0?Be+1:null;try{const at=`lbRank_${t.id}`,bn=sessionStorage.getItem(at);bn&&ws(parseInt(bn,10)),Re&&sessionStorage.setItem(at,String(Re))}catch{}}}catch(te){console.error("Leaderboard preview error:",te)}try{let te=0;if(M){const me=M.docs.map(Ie=>Ie.data().date).filter(Boolean).sort().reverse();if(me.length>0){const Ie=new Date;let Ne=new Date(Ie);e:for(let Be=0;Be<52;Be++){const Re=new Date(Ne),at=Re.getDay(),bn=at===0?6:at-1;Re.setDate(Re.getDate()-bn),Re.setHours(0,0,0,0);const et=new Date(Re);et.setDate(et.getDate()+7);const tn=Qp(Re),jn=Qp(et);if(me.some(It=>It>=tn&&It<jn))te++;else{if(Be>0)break e;break}Ne.setDate(Ne.getDate()-7)}}}Mt(te)}catch(te){console.error("Streak computation error:",te)}C(!0)})()},[s,t,L]),w.useEffect(()=>{if(!(!ge||!t))try{sessionStorage.setItem(`cbDash_${t.id}`,JSON.stringify({totalWorkouts:G,habitWeekPct:he,nutritionTotals:j,nutritionTargetData:V,todayHabitsCount:D,realHabitCount:E,weeklyWorkouts:Le,weeklyWorkoutTarget:X,leaderboardTop3:re,streakWeeks:Oe}))}catch{}},[ge,G,he,j,V,D,Le,X,re,Oe,t]),w.useEffect(()=>{if(!(!ge||$n.current)&&Le>=X&&X>0){const k=`weekCeleb_${t?.id}_${new Date().toISOString().slice(0,10).replace(/-\d{2}$/,"")}`;try{if(sessionStorage.getItem(k))return;sessionStorage.setItem(k,"1")}catch{}$n.current=!0,gr(!0),setTimeout(()=>gr(!1),3500)}},[ge,Le,X,t]);const ie=w.useCallback(async()=>{if(ts.current=!0,In(!1),l({tourComplete:!0}),t?.id){try{localStorage.setItem(`tourDone_${t.id}`,"1")}catch{}try{await ls(We(ye,"clients",t.id),{tourComplete:!0})}catch(k){console.error("Failed to save tour completion:",k)}}},[t,l]),ce=w.useCallback(async k=>{if(je(k),Ce(!1),P(!1),t?.id){try{localStorage.setItem(`targetHint_${t.id}`,"1")}catch{}try{await ls(We(ye,"clients",t.id),{weeklyWorkoutTarget:k})}catch(M){console.error("Failed to save weekly target:",M)}}},[t]),Pe=k=>{const M=k.currentTarget,q=M.querySelector(".ripple");q&&q.remove();const te=M.getBoundingClientRect(),me=Math.max(te.width,te.height),Ie=k.clientX-te.left-me/2,Ne=k.clientY-te.top-me/2,Be=document.createElement("span");Be.className="ripple",Be.style.cssText=`width:${me}px;height:${me}px;left:${Ie}px;top:${Ne}px;`,M.appendChild(Be),setTimeout(()=>Be.remove(),600)},Ue=t?.name?.split(" ")[0]||"there",qe=Math.min(Math.round(Le/X*100),100),Ot=Oe>0?Math.min(Math.round(Oe/12*100),100):0,Ge=[{label:"Wk Streak",value:`${Oe}`,pct:Ot,color:"var(--color-primary)",size:"normal"},{label:"Workouts",value:`${Le}/${X}`,pct:qe,color:"var(--color-primary)",size:"large",editable:!0},{label:"Habits Today",value:`${he}%`,pct:he,color:"var(--color-primary)",size:"normal"}],Mn=j.calories>0&&V?.calories&&j.calories>=V.calories*.8,ns=Le>=X&&X>0,ar=D>=L,Vn=(()=>{if(!ge)return null;const k=X-Le;return k===1?"1 more workout to hit your weekly goal":k===2?"2 more workouts to hit your weekly goal":L-D===1?"1 habit left to complete today":null})(),Xs=k=>!V||!V[k]?0:Math.min(Math.round(j[k]/V[k]*100),100),Di=(()=>{const k=new Date().getHours(),M=ge&&D>=L&&j.calories>0,q=te=>te[Math.floor(Date.now()/6e4%te.length)];return M?q(Yc.allDone):k>=5&&k<12?q(Yc.morning):k>=12&&k<17?q(Yc.afternoon):k>=17&&k<21?q(Yc.evening):q(Yc.night)})(),Is=ge?Le===0?{label:"WORKOUT",message:"No workouts this week yet",cta:"Start One",action:()=>b("/client/core-buddy/workouts"),pct:0,ringLabel:"0"}:D<L?{label:"DAILY HABITS",message:`${D}/${L} completed`,cta:"Open Habits",action:()=>b("/client/core-buddy/consistency"),pct:he,ringLabel:`${D}/${L}`}:g&&j.calories===0?{label:"NUTRITION",message:"No meals logged today",cta:"Log Meal",action:()=>b("/client/core-buddy/nutrition"),pct:0,ringLabel:"0"}:{label:"TODAY",message:"You're crushing it!",cta:null,action:null,pct:100,ringLabel:""}:null,Js=w.useCallback(async()=>{if(t){Ct(!0);try{const k=await Ht(Yt(ht(ye,"posts"),xt("authorId","==",t.id),ku("createdAt","desc"),Eu(30)));En(k.docs.map(q=>({id:q.id,...q.data()})));const M=await Ht(Yt(ht(ye,"postLikes"),xt("userId","==",t.id)));se(new Set(M.docs.map(q=>q.data().postId)))}catch(k){console.error("Error loading journey:",k)}finally{Ct(!1)}}},[t]);w.useEffect(()=>{ge&&t&&Js()},[ge,t,Js]);const ma=k=>{const M=k.target.files?.[0];if(M){if(!M.type.startsWith("image/")){st("Please select an image file","error");return}if(M.size>10*1024*1024){st("Image must be under 10MB","error");return}Tt(M),Xt(URL.createObjectURL(M))}},vr=()=>{Tt(null),pt&&URL.revokeObjectURL(pt),Xt(null),yn.current&&(yn.current.value="")},Cs=async()=>{if(!(!ft.trim()&&!Qe||zs||!t)){es(!0);try{let k=null;if(Qe){const me=await S3(Qe),Ie=`${Date.now()}_${Math.random().toString(36).slice(2,8)}`,Ne=Ga(Ka,`postImages/${t.id}/${Ie}`);await Rh(Ne,me),k=await Oo(Ne)}await mr(ht(ye,"posts"),{authorId:t.id,authorName:t.name||"Unknown",authorPhotoURL:t.photoURL||null,content:ft.trim(),type:k?"image":"text",imageURL:k||null,createdAt:Rs(),likeCount:0,commentCount:0});const q=ft.trim().match(/@[\w\s]+?(?=\s@|\s*$|[.,!?])/g);if(q){const me=new Set;q.forEach(Ie=>{const Ne=Ie.slice(1).trim(),Be=Gt.find(Re=>Re.name&&Re.name.toLowerCase()===Ne.toLowerCase());Be&&!me.has(Be.id)&&(me.add(Be.id),Tn(Be.id,"mention",{}))})}Rt(""),vr(),Cn.current&&(Cn.current.style.height="auto"),await Js();const te=Gt.length;st(te>0?`Shared with ${te} ${te===1?"buddy":"buddies"}`:"Posted to your journey!","success")}catch(k){console.error("Error posting:",k),st(k?.message||"Failed to post","error")}finally{es(!1)}}},pa=async k=>{if(window.confirm("Delete this post?"))try{await Sr(We(ye,"posts",k)),En(M=>M.filter(q=>q.id!==k)),st("Post deleted","info")}catch(M){console.error("Delete error:",M),st("Failed to delete","error")}},Zr=async k=>{if(!t)return;const M=t.id,q=`${k}_${M}`,te=Wt.has(k),me=new Set(Wt);te?me.delete(k):me.add(k),se(me),En(Ie=>Ie.map(Ne=>Ne.id===k?{...Ne,likeCount:Math.max(0,(Ne.likeCount||0)+(te?-1:1))}:Ne));try{if(te)await Sr(We(ye,"postLikes",q)),await ls(We(ye,"posts",k),{likeCount:Ro(-1)});else{await Ts(We(ye,"postLikes",q),{postId:k,userId:M,createdAt:Rs()}),await ls(We(ye,"posts",k),{likeCount:Ro(1)});const Ie=ct.find(Ne=>Ne.id===k);Ie&&Tn(Ie.authorId,"like",{postId:k})}}catch(Ie){console.error("Like error:",Ie),Js()}},Ir=async k=>{try{const M=await Ht(Yt(ht(ye,"postComments"),xt("postId","==",k),ku("createdAt","asc"),Eu(50)));ut(q=>({...q,[k]:M.docs.map(te=>({id:te.id,...te.data()}))}))}catch(M){console.error("Error loading comments:",M)}},Ms=k=>{const M=new Set(Ae);M.has(k)?M.delete(k):(M.add(k),vt[k]||Ir(k)),gt(M)},fi=async k=>{const M=(He[k]||"").trim(),q=On[k];if(!(!M&&!q||!t)){rn(te=>({...te,[k]:!0}));try{let te=null;if(q){const Re=Ga(Ka,`comment-images/${Date.now()}_${q.name}`);await Rh(Re,q),te=await Oo(Re)}const me={postId:k,authorId:t.id,authorName:t.name||"Unknown",authorPhotoURL:t.photoURL||null,content:M||"",createdAt:Rs()};te&&(me.imageURL=te);const Ie=Jt[k];Ie&&(me.replyToId=Ie.id,me.replyToName=Ie.authorName),await mr(ht(ye,"postComments"),me),await ls(We(ye,"posts",k),{commentCount:Ro(1)});const Ne=ct.find(Re=>Re.id===k);Ne&&Tn(Ne.authorId,"comment",{postId:k});const Be=M.match(/@[\w\s]+?(?=\s@|\s*$|[.,!?])/g);if(Be){const Re=new Set;Be.forEach(at=>{const bn=at.slice(1).trim(),et=Gt.find(tn=>tn.name&&tn.name.toLowerCase()===bn.toLowerCase());et&&!Re.has(et.id)&&(Re.add(et.id),Tn(et.id,"mention",{postId:k}))})}nt(Re=>({...Re,[k]:""})),Kn(Re=>({...Re,[k]:null})),Hn(Re=>({...Re,[k]:null})),Rn(Re=>({...Re,[k]:null})),Ss.current[k]&&(Ss.current[k].value=""),En(Re=>Re.map(at=>at.id===k?{...at,commentCount:(at.commentCount||0)+1}:at)),await Ir(k)}catch(te){console.error("Comment error:",te),st("Failed to comment","error")}finally{rn(te=>({...te,[k]:!1}))}}},Mr=async(k,M)=>{try{await Sr(We(ye,"postComments",M)),await ls(We(ye,"posts",k),{commentCount:Ro(-1)}),ut(q=>({...q,[k]:(q[k]||[]).filter(te=>te.id!==M)})),En(q=>q.map(te=>te.id===k?{...te,commentCount:Math.max((te.commentCount||1)-1,0)}:te))}catch(q){console.error("Delete comment error:",q),st("Failed to delete comment","error")}},mi=(k,M)=>{const q=M.target.files?.[0];if(!q)return;if(q.size>5*1024*1024){st("Image must be under 5MB","error");return}Kn(me=>({...me,[k]:q}));const te=new FileReader;te.onload=me=>Hn(Ie=>({...Ie,[k]:me.target.result})),te.readAsDataURL(q)},ss=k=>{Kn(M=>({...M,[k]:null})),Hn(M=>({...M,[k]:null})),Ss.current[k]&&(Ss.current[k].value="")},F=k=>{Rt(k.target.value),k.target.style.height="auto",k.target.style.height=Math.min(k.target.scrollHeight,120)+"px",Qs(k.target.value,"compose")},oe=(k,M)=>{nt(q=>({...q,[k]:M})),Qs(M,k)};return a.jsx(Jo,{children:a.jsxs("div",{className:"cb-dashboard","data-theme":d?"dark":"light",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsxs("div",{className:"header-left-group",children:[a.jsxs("div",{className:"header-notif-wrap",ref:it,children:[a.jsxs("button",{className:"header-notif-btn",onClick:()=>{yt(!Ye),Ye||Rr()},"aria-label":"Notifications",children:[a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"}),a.jsx("path",{d:"M13.73 21a2 2 0 0 1-3.46 0"})]}),yr>0&&a.jsx("span",{className:"header-notif-badge",children:yr>9?"9+":yr})]}),Ye&&a.jsxs("div",{className:"notif-panel",children:[a.jsxs("div",{className:"notif-panel-header",children:[a.jsx("span",{className:"notif-panel-title",children:"Notifications"}),le.length>0&&a.jsx("button",{className:"notif-clear-btn",onClick:xs,children:"Clear all"})]}),a.jsx("div",{className:"notif-panel-list",children:le.length===0?a.jsx("div",{className:"notif-empty",children:"No notifications yet"}):le.map(k=>a.jsxs("div",{className:`notif-item${k.read?"":" unread"}`,onClick:()=>{if(yt(!1),k.type==="buddy_request"||k.type==="buddy_accept")b(g?"/client/core-buddy/buddies":"/upgrade");else if((k.type==="like"||k.type==="comment")&&k.postId){if(!Ae.has(k.postId)){const M=new Set(Ae);M.add(k.postId),gt(M),vt[k.postId]||Ir(k.postId)}setTimeout(()=>{const M=document.getElementById(`post-${k.postId}`);M&&M.scrollIntoView({behavior:"smooth",block:"center"})},150)}else k.type==="like"||k.type==="comment"?document.querySelector(".cb-journey-section")?.scrollIntoView({behavior:"smooth"}):k.type==="mention"&&b(`/client/core-buddy/profile/${k.fromId}`)},children:[a.jsx("div",{className:"notif-item-avatar",children:k.fromPhotoURL?a.jsx("img",{src:k.fromPhotoURL,alt:""}):a.jsx("span",{children:(k.fromName||"?")[0]})}),a.jsxs("div",{className:"notif-item-body",children:[a.jsxs("p",{className:"notif-item-text",children:[a.jsx("strong",{children:k.fromName})," ",k.type==="buddy_request"&&"sent you a buddy request",k.type==="buddy_accept"&&"accepted your buddy request",k.type==="like"&&"liked your post",k.type==="comment"&&"commented on your post",k.type==="mention"&&"mentioned you"]}),a.jsx("span",{className:"notif-item-time",children:Jp(k.createdAt)})]})]},k.id))})]})]}),a.jsx("button",{className:"header-icon-btn",onClick:()=>b("/client/core-buddy/settings"),"aria-label":"Settings",children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"12",cy:"12",r:"3"}),a.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83-2.83l.06-.06A1.65 1.65 0 0 0 4.68 15a1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1 0-4h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 2.83-2.83l.06.06A1.65 1.65 0 0 0 9 4.68a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 2.83l-.06.06A1.65 1.65 0 0 0 19.4 9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1z"})]})})]}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsxs("div",{className:"header-actions",children:[a.jsx("button",{className:"header-icon-btn",onClick:p,"aria-label":d?"Switch to light mode":"Switch to dark mode",children:d?a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M12 3a9 9 0 109 9c0-.46-.04-.92-.1-1.36a5.389 5.389 0 01-4.4 2.26 5.403 5.403 0 01-3.14-9.8c-.44-.06-.9-.1-1.36-.1z"})}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zM2 13h2c.55 0 1-.45 1-1s-.45-1-1-1H2c-.55 0-1 .45-1 1s.45 1 1 1zm18 0h2c.55 0 1-.45 1-1s-.45-1-1-1h-2c-.55 0-1 .45-1 1s.45 1 1 1zM11 2v2c0 .55.45 1 1 1s1-.45 1-1V2c0-.55-.45-1-1-1s-1 .45-1 1zm0 18v2c0 .55.45 1 1 1s1-.45 1-1v-2c0-.55-.45-1-1-1s-1 .45-1 1zM5.99 4.58a.996.996 0 00-1.41 0 .996.996 0 000 1.41l1.06 1.06c.39.39 1.03.39 1.41 0s.39-1.03 0-1.41L5.99 4.58zm12.37 12.37a.996.996 0 00-1.41 0 .996.996 0 000 1.41l1.06 1.06c.39.39 1.03.39 1.41 0a.996.996 0 000-1.41l-1.06-1.06zm1.06-10.96a.996.996 0 000-1.41.996.996 0 00-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06zM7.05 18.36a.996.996 0 000-1.41.996.996 0 00-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06z"})})}),a.jsx("button",{className:"header-icon-btn",onClick:i,"aria-label":"Log out",children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),a.jsx("polyline",{points:"16 17 21 12 16 7"}),a.jsx("line",{x1:"21",y1:"12",x2:"9",y2:"12"})]})})]})]})}),a.jsxs("main",{className:"cb-main",children:[a.jsxs("div",{className:"cb-ring-container",children:[a.jsxs("div",{className:"cb-ring",children:[a.jsx("svg",{className:"cb-ring-svg",viewBox:"0 0 200 200",children:TE.map((k,M)=>{const q=M<B;return a.jsx("line",{x1:k.x1,y1:k.y1,x2:k.x2,y2:k.y2,className:`ring-tick ${q?"elapsed":"remaining"}`,strokeWidth:k.thick?"3":"2"},M)})}),a.jsxs("div",{className:"cb-ring-center",children:[a.jsxs("div",{className:"cb-ring-logo",onClick:()=>Ze.current?.click(),role:"button",tabIndex:0,"aria-label":"Change profile photo",children:[a.jsx("img",{src:_e||"/Logo.webp",alt:_e?"Profile":"Mind Core Fitness"}),a.jsx("div",{className:`cb-photo-overlay${Se?" uploading":""}`,children:Se?a.jsx("div",{className:"cb-photo-spinner"}):a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"#fff",strokeWidth:"2",children:[a.jsx("path",{d:"M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"}),a.jsx("circle",{cx:"12",cy:"13",r:"4"})]})}),a.jsx("input",{ref:Ze,type:"file",accept:"image/*",onChange:z,style:{display:"none"}})]}),!_e&&!Se&&a.jsx("div",{className:"cb-photo-badge",onClick:()=>Ze.current?.click(),children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"#fff",strokeWidth:"2.5",children:[a.jsx("path",{d:"M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"}),a.jsx("circle",{cx:"12",cy:"13",r:"4"})]})})]})]}),a.jsxs("div",{className:"cb-ring-countdown",children:[a.jsx("span",{className:"cb-timer-digit",children:String(W.hours).padStart(2,"0")}),a.jsx("span",{className:"cb-timer-colon",children:":"}),a.jsx("span",{className:"cb-timer-digit",children:String(W.minutes).padStart(2,"0")}),a.jsx("span",{className:"cb-timer-colon",children:":"}),a.jsx("span",{className:"cb-timer-digit cb-timer-seconds",children:String(W.seconds).padStart(2,"0")})]}),a.jsx("span",{className:"cb-ring-label",children:"remaining today"}),a.jsxs("p",{className:"cb-ring-tagline",children:[Xp[cn].text," ",a.jsx("strong",{children:Xp[cn].bold})]},cn)]}),a.jsx("div",{className:"cb-stats-row",children:Ge.map(k=>{const M=(k.size==="large",38),q=2*Math.PI*M,te=q-k.pct/100*q,me=k.editable,Ie=k.pct>=75&&k.pct<100,Ne=k.pct>=100;return a.jsxs("div",{className:`cb-stat-item${k.size==="large"?" cb-stat-large":""}`,children:[a.jsxs("div",{className:`cb-stat-ring${me?" cb-stat-tappable":""}${me&&J?" cb-stat-hint":""}${Ie?" cb-stat-near":""}${Ne?" cb-stat-complete":""}`,onClick:me?()=>{Ce(!0),P(!1)}:void 0,children:[a.jsxs("svg",{viewBox:"0 0 100 100",children:[a.jsx("circle",{className:"cb-stat-track",cx:"50",cy:"50",r:M}),a.jsx("circle",{className:`cb-stat-fill${Ie?" cb-fill-near":""}${Ne?" cb-fill-complete":""}`,cx:"50",cy:"50",r:M,strokeDasharray:q,strokeDashoffset:te})]}),a.jsx("span",{className:`cb-stat-value${Ne?" cb-val-complete":""}`,children:k.value})]}),a.jsxs("span",{className:"cb-stat-label",children:[k.label==="Wk Streak"&&Oe>0&&a.jsx("svg",{className:"cb-streak-flame",width:"12",height:"12",viewBox:"0 0 24 24",fill:"var(--color-primary)",stroke:"none",children:a.jsx("path",{d:"M12 12c2-2.96 0-7-1-8 0 3.038-1.773 4.741-3 6-1.226 1.26-2 3.24-2 5a6 6 0 1 0 12 0c0-1.532-1.056-3.94-2-5-1.786 3-2.791 3-4 2z"})}),k.label]})]},k.label)})}),De&&a.jsx("div",{className:"cb-target-overlay",onClick:()=>Ce(!1),children:a.jsxs("div",{className:"cb-target-picker",onClick:k=>k.stopPropagation(),children:[a.jsx("h4",{children:"Weekly workout goal"}),a.jsx("p",{children:"How many sessions per week?"}),a.jsx("div",{className:"cb-target-options",children:[1,2,3,4,5,6,7].map(k=>a.jsx("button",{className:`cb-target-option${k===X?" active":""}`,onClick:()=>ce(k),children:k},k))})]})}),a.jsxs("p",{className:"cb-coach-msg",children:[Di.main," ",a.jsx("strong",{children:Ue}),"  ",Di.sub]}),Vn&&a.jsxs("div",{className:"cb-milestone-hint",children:[a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),a.jsx("span",{children:Vn})]}),Is&&a.jsxs("button",{className:"cb-nudge-card",onClick:Is.action||void 0,style:Is.action?void 0:{cursor:"default"},children:[a.jsxs("div",{className:"cb-nudge-ring",children:[a.jsxs("svg",{viewBox:"0 0 100 100",children:[a.jsx("circle",{className:"cb-nudge-ring-track",cx:"50",cy:"50",r:"38"}),a.jsx("circle",{className:"cb-nudge-ring-fill",cx:"50",cy:"50",r:"38",strokeDasharray:2*Math.PI*38,strokeDashoffset:2*Math.PI*38-Is.pct/100*2*Math.PI*38})]}),a.jsx("span",{className:"cb-nudge-ring-val",children:Is.ringLabel})]}),a.jsxs("div",{className:"cb-nudge-info",children:[a.jsx("span",{className:"cb-nudge-label",children:Is.label}),a.jsx("span",{className:"cb-nudge-title",children:Is.message}),Is.cta&&a.jsxs("span",{className:"cb-nudge-cta",children:[Is.cta," "]})]})]}),a.jsxs("div",{className:"cb-features",children:[g&&a.jsxs("button",{className:`cb-feature-card cb-card-nutrition cb-card-has-preview ripple-btn${Mn?" cb-card-done":""}`,onClick:k=>{Pe(k),b("/client/core-buddy/nutrition")},children:[a.jsxs("div",{className:"cb-card-top-row",children:[a.jsx("div",{className:"cb-card-content",children:a.jsx("h3",{children:"Today's Nutrition"})}),a.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),a.jsx("div",{className:"cb-card-preview-row",children:a.jsx("div",{className:"cb-mini-rings",children:[{label:"P",pct:Xs("protein"),color:"var(--color-primary)"},{label:"C",pct:Xs("carbs"),color:"var(--color-primary)"},{label:"F",pct:Xs("fats"),color:"var(--color-primary)"},{label:"Cal",pct:Xs("calories"),color:"var(--color-primary)"}].map(k=>{const q=2*Math.PI*38,te=q-k.pct/100*q;return a.jsxs("div",{className:"cb-mini-ring",children:[a.jsxs("svg",{viewBox:"0 0 100 100",children:[a.jsx("circle",{className:"cb-mini-track",cx:"50",cy:"50",r:38}),a.jsx("circle",{className:"cb-mini-fill",cx:"50",cy:"50",r:38,style:{stroke:k.color},strokeDasharray:q,strokeDashoffset:te})]}),a.jsx("span",{style:{color:k.color},children:k.label})]},k.label)})})}),a.jsx("p",{className:"cb-card-desc",children:"Track macros, scan barcodes, log water"})]}),a.jsxs("button",{className:`cb-feature-card cb-card-workouts-hero ripple-btn${ns?" cb-card-done":""}`,onClick:k=>{Pe(k),b("/client/core-buddy/workouts")},children:[a.jsx("h3",{className:"cb-hero-title",children:"Workout"}),a.jsxs("div",{className:"cb-hero-stats",children:[a.jsxs("span",{children:[Le," this week"]}),a.jsx("span",{className:"cb-hero-dot",children:""}),a.jsxs("span",{children:[G," total"]})]}),a.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),a.jsxs("button",{className:`cb-feature-card cb-card-consistency ripple-btn${ar?" cb-card-done":""}`,onClick:k=>{Pe(k),b("/client/core-buddy/consistency")},children:[a.jsxs("div",{className:"cb-card-content",children:[a.jsx("h3",{children:"Habits"}),a.jsx("div",{className:`cb-habit-dots${D>=L?" cb-habits-all-done":""}`,children:Array.from({length:L},(k,M)=>a.jsx("span",{className:`cb-habit-dot${M<D?" done":""}${!M&&D>0&&M>=D?" cb-dot-warming":""}`,style:M>=D&&D>0?{"--glow-intensity":Math.min(D/L,.9)}:void 0},M))}),a.jsxs("span",{className:"cb-habit-dots-label",children:[D,"/",L," today"]})]}),a.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),a.jsxs("button",{className:"cb-feature-card cb-card-leaderboard ripple-btn",onClick:k=>{Pe(k),b("/client/leaderboard")},children:[a.jsxs("div",{className:"cb-card-content",children:[a.jsx("h3",{children:"Leaderboard"}),re.length>0?a.jsx("div",{className:"cb-lb-preview",children:re.map((k,M)=>{const q=["#FFD700","#A8B4C0","#CD7F32"][M],te=k.name?k.name.split(" ").map(Be=>Be[0]).join("").slice(0,2).toUpperCase():"?",me=k.id===t?.id,Ie=M+1,Ne=me&&Fs?Fs-Ie:0;return a.jsxs("div",{className:`cb-lb-entry${me?" cb-lb-me":""}`,children:[a.jsx("div",{className:"cb-lb-avatar",style:{borderColor:q},children:k.photoURL?a.jsx("img",{src:k.photoURL,alt:"",className:"cb-lb-avatar-img"}):a.jsx("span",{children:te})}),a.jsxs("span",{className:"cb-lb-rank",style:{color:q},children:["#",Ie,me&&Ne>0&&a.jsxs("span",{className:"cb-lb-movement cb-lb-up",children:["+",Ne]}),me&&Ne<0&&a.jsx("span",{className:"cb-lb-movement cb-lb-down",children:Ne})]})]},k.id)})}):a.jsx("p",{children:"Opt in to compete with your Core Buddies"})]}),a.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),g&&a.jsxs("button",{className:"cb-feature-card cb-card-challenge ripple-btn",onClick:k=>{Pe(k),b("/client/core-buddy/challenges")},children:[a.jsx("div",{className:"cb-card-icon-wrap cb-card-icon-challenge",children:a.jsx("img",{src:Ja.find(k=>k.id==="iron_will")?.img,alt:"",className:"cb-card-badge-img"})}),a.jsxs("div",{className:"cb-card-content",children:[a.jsx("h3",{children:"Challenges"}),a.jsx("p",{children:"Push yourself with timed fitness challenges"})]}),a.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),g&&a.jsxs("button",{className:"cb-feature-card cb-card-buddies ripple-btn",onClick:k=>{Pe(k),b("/client/core-buddy/buddies")},children:[a.jsxs("div",{className:"cb-card-content",children:[a.jsx("h3",{children:"Buddies"}),a.jsx("p",{children:"Connect with other members and track each other's progress"})]}),a.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),g&&a.jsxs("div",{className:"cb-journey-section",children:[a.jsx("h3",{className:"cb-journey-title",children:"My Journey"}),a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"journey-compose",children:[a.jsx("div",{className:"journey-compose-avatar",children:_e?a.jsx("img",{src:_e,alt:""}):a.jsx("span",{children:Qc(t?.name)})}),a.jsxs("div",{className:"journey-compose-body",style:{position:"relative"},children:[a.jsx("textarea",{ref:Cn,placeholder:"Share your progress... (use @ to mention)",value:ft,onChange:F,rows:1,maxLength:500}),vs&&bs==="compose"&&un.length>0&&a.jsx("div",{className:"mention-dropdown",children:un.map(k=>a.jsxs("button",{className:"mention-option",onClick:()=>Jr(k,"compose"),children:[a.jsx("div",{className:"mention-option-avatar",children:k.photoURL?a.jsx("img",{src:k.photoURL,alt:""}):a.jsx("span",{children:Qc(k.name)})}),a.jsx("span",{children:k.name})]},k.id))}),pt&&a.jsxs("div",{className:"journey-image-preview",children:[a.jsx("img",{src:pt,alt:"Preview"}),a.jsx("button",{className:"journey-image-remove",onClick:vr,"aria-label":"Remove image",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",children:[a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})})]}),a.jsxs("div",{className:"journey-compose-actions",children:[a.jsx("button",{className:"journey-image-btn",onClick:()=>yn.current?.click(),"aria-label":"Add image",children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),a.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),a.jsx("path",{d:"M21 15l-5-5L5 21"})]})}),a.jsx("input",{ref:yn,type:"file",accept:"image/*",onChange:ma,hidden:!0}),(ft.trim()||Qe)&&a.jsx("button",{className:"journey-post-btn",onClick:Cs,disabled:zs,children:zs?a.jsx("div",{className:"journey-btn-spinner"}):"Post"})]})]})]}),fe?a.jsx("div",{className:"journey-loading",children:a.jsx("div",{className:"cb-spinner"})}):ct.length===0?a.jsxs("div",{className:"journey-empty",children:[a.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),a.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),a.jsx("path",{d:"M21 15l-5-5L5 21"})]}),a.jsx("p",{children:"Start sharing your fitness journey!"})]}):a.jsx("div",{className:"journey-list",children:ct.map(k=>a.jsxs("div",{id:`post-${k.id}`,className:"journey-post",children:[a.jsxs("div",{className:"journey-post-header",children:[a.jsx("div",{className:"journey-post-avatar",children:k.authorPhotoURL?a.jsx("img",{src:k.authorPhotoURL,alt:""}):a.jsx("span",{children:Qc(k.authorName)})}),a.jsxs("div",{className:"journey-post-meta",children:[a.jsx("span",{className:"journey-post-name",children:k.authorName}),a.jsx("span",{className:"journey-post-time",children:Jp(k.createdAt)})]}),a.jsx("button",{className:"journey-delete-btn",onClick:()=>pa(k.id),"aria-label":"Delete post",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M3 6h18"}),a.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),a.jsx("path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]}),k.type==="workout_summary"&&k.metadata?a.jsxs("div",{className:"journey-card",children:[a.jsx("div",{className:"journey-card-logo-frame",children:a.jsx("img",{src:"/Logo.webp",alt:"MCF",className:"journey-card-logo-img"})}),a.jsx("h3",{className:"journey-card-title",children:k.metadata.title}),k.metadata.stats?.length>0&&a.jsx("p",{className:"journey-card-stats-line",children:k.metadata.stats.map(M=>`${M.value} ${M.label}`).join("    ")}),!k.metadata.stats?.length&&k.metadata.subtitle&&a.jsx("p",{className:"journey-card-stats-line",children:k.metadata.subtitle}),a.jsx("p",{className:"journey-card-cta",children:"I just completed a workout using Core Buddy "}),a.jsx("p",{className:"journey-card-slogan",children:"Make It Count with Core Buddy"})]}):k.type==="badge_earned"&&k.metadata?a.jsxs("div",{className:"journey-card",children:[a.jsx("div",{className:"journey-card-logo-frame journey-card-logo-badge",children:(()=>{const M=Ja.find(q=>q.id===k.metadata.badgeId);return M?.img?a.jsx("img",{src:M.img,alt:k.metadata.title,className:"journey-card-logo-img"}):a.jsx("img",{src:"/Logo.webp",alt:k.metadata.title,className:"journey-card-logo-img"})})()}),a.jsx("h3",{className:"journey-card-title",children:k.metadata.title}),k.metadata.badgeDesc&&a.jsx("p",{className:"journey-card-stats-line",children:k.metadata.badgeDesc}),a.jsx("p",{className:"journey-card-cta",children:"I just earned a badge on Core Buddy"}),a.jsx("p",{className:"journey-card-slogan",children:"Make It Count with Core Buddy"})]}):k.type==="habits_summary"&&k.metadata?a.jsxs("div",{className:"journey-card",children:[a.jsx("div",{className:"journey-card-logo-frame",children:a.jsx("img",{src:"/Logo.webp",alt:"MCF",className:"journey-card-logo-img"})}),a.jsx("h3",{className:"journey-card-title",children:k.metadata.title}),k.metadata.stats?.length>0&&a.jsx("p",{className:"journey-card-stats-line",children:k.metadata.stats.map(M=>`${M.value} ${M.label}`).join("    ")}),k.metadata.subtitle&&a.jsx("p",{className:"journey-card-stats-line",children:k.metadata.subtitle}),a.jsx("p",{className:"journey-card-cta",children:"I just completed my daily habits with Core Buddy "}),a.jsx("p",{className:"journey-card-slogan",children:"Make It Count with Core Buddy"})]}):a.jsxs(a.Fragment,{children:[k.content&&a.jsx("p",{className:"journey-post-content",children:I(k.content)}),k.imageURL&&a.jsx("div",{className:"journey-post-image",children:a.jsx("img",{src:k.imageURL,alt:"Post",loading:"lazy"})})]}),a.jsxs("div",{className:"journey-post-actions",children:[a.jsxs("button",{className:`journey-action-btn${Wt.has(k.id)?" liked":""}`,onClick:()=>Zr(k.id),children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:Wt.has(k.id)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})}),a.jsx("span",{children:k.likeCount||0})]}),a.jsxs("button",{className:`journey-action-btn${Ae.has(k.id)?" active":""}`,onClick:()=>Ms(k.id),children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})}),a.jsx("span",{children:k.commentCount||0})]})]}),Ae.has(k.id)&&a.jsxs("div",{className:"journey-comments",children:[vt[k.id]?.length>0?vt[k.id].map(M=>a.jsxs("div",{className:"journey-comment",children:[a.jsx("div",{className:"journey-comment-avatar",children:M.authorPhotoURL?a.jsx("img",{src:M.authorPhotoURL,alt:""}):a.jsx("span",{children:Qc(M.authorName)})}),a.jsxs("div",{className:"journey-comment-body",children:[a.jsxs("div",{className:"journey-comment-bubble",children:[a.jsx("span",{className:"journey-comment-name",children:M.authorName}),M.replyToName&&a.jsxs("span",{className:"journey-comment-reply-tag",children:[a.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("polyline",{points:"9 14 4 9 9 4"}),a.jsx("path",{d:"M20 20v-7a4 4 0 0 0-4-4H4"})]}),M.replyToName]}),M.content&&a.jsx("span",{className:"journey-comment-text",children:I(M.content)}),M.imageURL&&a.jsx("img",{className:"journey-comment-image",src:M.imageURL,alt:"Comment",loading:"lazy"})]}),a.jsxs("div",{className:"journey-comment-actions-row",children:[a.jsx("span",{className:"journey-comment-time",children:Jp(M.createdAt)}),a.jsx("button",{className:"journey-comment-reply-btn",onClick:()=>Rn(q=>({...q,[k.id]:{id:M.id,authorName:M.authorName}})),children:"Reply"}),a.jsx("button",{className:"journey-comment-delete-btn",onClick:()=>Mr(k.id,M.id),"aria-label":"Delete comment",children:a.jsxs("svg",{width:"13",height:"13",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M3 6h18"}),a.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),a.jsx("path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]})]})]},M.id)):a.jsx("p",{className:"journey-no-comments",children:"No comments yet"}),Jt[k.id]&&a.jsxs("div",{className:"journey-comment-replying",children:[a.jsxs("span",{children:["Replying to ",a.jsx("strong",{children:Jt[k.id].authorName})]}),a.jsx("button",{onClick:()=>Rn(M=>({...M,[k.id]:null})),"aria-label":"Cancel reply",children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",children:[a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})})]}),Zt[k.id]&&a.jsxs("div",{className:"journey-comment-img-preview",children:[a.jsx("img",{src:Zt[k.id],alt:"Preview"}),a.jsx("button",{onClick:()=>ss(k.id),"aria-label":"Remove image",children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",children:[a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})})]}),a.jsxs("div",{className:"journey-comment-input",style:{position:"relative"},children:[a.jsx("button",{className:"journey-comment-img-btn",onClick:()=>Ss.current[k.id]?.click(),"aria-label":"Add image",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),a.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),a.jsx("path",{d:"M21 15l-5-5L5 21"})]})}),a.jsx("input",{ref:M=>{Ss.current[k.id]=M},type:"file",accept:"image/*",onChange:M=>mi(k.id,M),hidden:!0}),a.jsx("input",{type:"text",placeholder:"Comment",value:He[k.id]||"",onChange:M=>oe(k.id,M.target.value),onKeyDown:M=>{M.key==="Enter"&&fi(k.id)},maxLength:300}),vs&&bs===k.id&&un.length>0&&a.jsx("div",{className:"mention-dropdown mention-dropdown-up",children:un.map(M=>a.jsxs("button",{className:"mention-option",onClick:()=>Jr(M,k.id),children:[a.jsx("div",{className:"mention-option-avatar",children:M.photoURL?a.jsx("img",{src:M.photoURL,alt:""}):a.jsx("span",{children:Qc(M.name)})}),a.jsx("span",{children:M.name})]},M.id))}),a.jsx("button",{onClick:()=>fi(k.id),disabled:!(He[k.id]||"").trim()&&!On[k.id]||$e[k.id],children:$e[k.id]?a.jsx("div",{className:"journey-btn-spinner-sm"}):a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"22",y1:"2",x2:"11",y2:"13"}),a.jsx("polygon",{points:"22 2 15 22 11 13 2 9 22 2"})]})})]})]})]},k.id))})]})]}),!g&&a.jsxs("button",{className:"cb-upgrade-cta",onClick:()=>b("/upgrade"),children:[a.jsx("span",{className:"cb-upgrade-cta-text",children:"Unlock the full experience"}),a.jsx("span",{className:"cb-upgrade-cta-sub",children:"Unlimited workout times, nutrition, buddies & more"}),a.jsxs("svg",{className:"cb-upgrade-cta-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M5 12h14"}),a.jsx("path",{d:"M12 5l7 7-7 7"})]})]})]})]}),a.jsx(Yr,{active:"home"}),Xr&&a.jsx("div",{className:"cb-weekly-celebration",children:a.jsxs("div",{className:"cb-weekly-celebration-card",children:[a.jsx("span",{className:"cb-weekly-celebration-icon",children:a.jsx("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",stroke:"var(--color-primary)",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),a.jsx("h4",{children:"Weekly Goal Smashed!"}),a.jsxs("p",{children:[Le,"/",X," sessions complete"]})]})}),Qt&&a.jsxs("div",{className:`toast-notification ${Qt.type}`,children:[Qt.type==="info"&&a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("line",{x1:"12",y1:"16",x2:"12",y2:"12"}),a.jsx("line",{x1:"12",y1:"8",x2:"12.01",y2:"8"})]}),Qt.type==="success"&&a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:a.jsx("path",{d:"M20 6L9 17l-5-5"})}),Qt.message]}),a.jsx(l3,{steps:Ft,active:Pn,onFinish:ie})]})})}async function Zh(s,e){const t=Ja.find(i=>i.id===s);if(!t||!e?.id)return null;try{const i=We(ye,"coreBuddyBadges",e.id),l=await Es(i),u=l.exists()?l.data().earned||[]:[];if(u.some(p=>p.id===t.id))return null;const d={id:t.id,earnedAt:new Date().toISOString()};return l.exists()?await ls(i,{earned:[...u,d]}):await Ts(i,{earned:[d]}),await mr(ht(ye,"posts"),{authorId:e.id,authorName:e.name||"Anonymous",authorPhotoURL:e.photoURL||null,type:"badge_earned",metadata:{title:t.name,badgeDesc:t.desc,badgeId:t.id},createdAt:Rs(),likeCount:0,commentCount:0}),t}catch(i){return console.error("Badge award failed:",i),null}}const Zp=new Map;function Hr(){return new Date().toISOString().split("T")[0]}const Ww=[{key:"breakfast",label:"Breakfast"},{key:"lunch",label:"Lunch"},{key:"dinner",label:"Dinner"},{key:"snacks",label:"Snacks"}],N3={breakfast:a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M18 8h1a4 4 0 0 1 0 8h-1"}),a.jsx("path",{d:"M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z"}),a.jsx("line",{x1:"6",y1:"1",x2:"6",y2:"4"}),a.jsx("line",{x1:"10",y1:"1",x2:"10",y2:"4"}),a.jsx("line",{x1:"14",y1:"1",x2:"14",y2:"4"})]}),lunch:a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}),dinner:a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})}),snacks:a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})})};function A3(){const s=new Date().getHours();return s<11?"breakfast":s<14?"lunch":s<17?"snacks":"dinner"}function R3(){const{currentUser:s,isClient:e,clientData:t,loading:i}=Ar(),{isDark:l,toggleTheme:u,accent:d}=Mi(),p=Ys(),[g,y]=w.useState("loading"),[b,E]=w.useState(null),[T,L]=w.useState({gender:"male",age:"",weight:"",weightUnit:"kg",height:"",heightUnit:"cm",heightFeet:"",heightInches:"",dailyActivity:"sedentary",trainingFrequency:"moderate",goal:"maintain",deficitLevel:"moderate"}),[W,H]=w.useState(null),[B,K]=w.useState(Hr()),[G,Q]=w.useState({entries:[]}),[he,Ee]=w.useState({protein:0,carbs:0,fats:0,calories:0}),[ge,C]=w.useState(!1),[j,R]=w.useState(()=>{const I=new Date;return{year:I.getFullYear(),month:I.getMonth()}}),[V,O]=w.useState(!1),[D,A]=w.useState(()=>{const I=new Date;return{year:I.getFullYear(),month:I.getMonth()}}),[Le,Je]=w.useState(!1),[X,je]=w.useState(A3),[De,Ce]=w.useState(null),[J,P]=w.useState(null),[re,we]=w.useState(!1),[_e,xe]=w.useState(null),[Se,Fe]=w.useState(""),[Ze,Oe]=w.useState(!1),[Mt,cn]=w.useState(""),[qn,Qt]=w.useState([]),[rt,st]=w.useState(!1),[ct,En]=w.useState({name:"",protein:"",carbs:"",fats:"",calories:"",serving:""}),[fe,Ct]=w.useState(null),[ft,Rt]=w.useState("100"),[Qe,Tt]=w.useState(0),[pt,Xt]=w.useState("weight"),[zs,es]=w.useState(0),[Wt,se]=w.useState(null);w.useRef(null);const Ae=w.useRef(!1),gt=w.useRef(null),vt=w.useRef(null),ut=w.useRef(null),He=w.useCallback((I,z="info")=>{se({message:I,type:z}),setTimeout(()=>se(null),3e3)},[]);w.useEffect(()=>{!i&&(!s||!e)&&p("/")},[s,e,i,p]),w.useEffect(()=>{if(!t?.id)return;(async()=>{try{const z=await Es(We(ye,"nutritionTargets",t.id));z.exists()?(E(z.data()),y("dashboard")):y("setup")}catch(z){console.error("Error loading nutrition data:",z),y("setup")}})()},[t?.id]),w.useEffect(()=>{if(!t?.id)return;(async()=>{try{const z=await Es(We(ye,"nutritionLogs",`${t.id}_${B}`));if(z.exists()){const ie=z.data();Q({entries:ie.entries||[]})}else Q({entries:[]})}catch(z){console.error("Error loading log:",z),Q({entries:[]})}})()},[t?.id,B]),w.useEffect(()=>{const I=G.entries.reduce((z,ie)=>({protein:z.protein+(ie.protein||0),carbs:z.carbs+(ie.carbs||0),fats:z.fats+(ie.fats||0),calories:z.calories+(ie.calories||0)}),{protein:0,carbs:0,fats:0,calories:0});Ee(I)},[G.entries]);const nt=async I=>{try{if(await Ts(We(ye,"nutritionLogs",`${t.id}_${B}`),{clientId:t.id,date:B,entries:I.entries,updatedAt:At.now()}),b?.protein&&B===Hr()&&I.entries.reduce((ie,ce)=>ie+(ce.protein||0),0)>=b.protein){let ie=1;for(let ce=1;ce<7;ce++){const Pe=new Date;Pe.setDate(Pe.getDate()-ce);const Ue=Pe.toISOString().split("T")[0];try{const qe=await Es(We(ye,"nutritionLogs",`${t.id}_${Ue}`));if(qe.exists())if((qe.data().entries||[]).reduce((Ge,Mn)=>Ge+(Mn.protein||0),0)>=b.protein)ie++;else break;else break}catch{break}}ie>=7&&Zh("nutrition_7",t)}}catch(z){console.error("Error saving nutrition log:",z)}},$e=B===Hr(),rn=(I,z)=>new Date(I,z+1,0).getDate(),Jt=(I,z)=>new Date(I,z,1).getDay(),Rn=I=>{if(I===Hr())return"Today";const z=new Date(I+"T12:00:00"),ie=new Date;return ie.setDate(ie.getDate()-1),I===ie.toISOString().split("T")[0]?"Yesterday":z.toLocaleDateString("en-GB",{weekday:"short",day:"numeric",month:"short"})},On=["January","February","March","April","May","June","July","August","September","October","November","December"],Kn=["Su","Mo","Tu","We","Th","Fr","Sa"],Zt=()=>{let I=parseFloat(T.weight);T.weightUnit==="lbs"&&(I*=.453592);let z;T.heightUnit==="cm"?z=parseFloat(T.height):z=(parseFloat(T.heightFeet)||0)*30.48+(parseFloat(T.heightInches)||0)*2.54;const ie=parseInt(T.age);let ce=T.gender==="male"?10*I+6.25*z-5*ie+5:10*I+6.25*z-5*ie-161;const Ue=ce*{sedentary:1.2,light:1.3,moderate:1.4,active:1.5}[T.dailyActivity],qe={low:100,moderate:200,high:300,daily:400},Ot=Math.round(Ue+qe[T.trainingFrequency]);let Ge=Ot,Mn,ns;switch(T.goal){case"lose":Ge=Ot*(1-{light:.15,moderate:.2,harsh:.25}[T.deficitLevel]),Mn=2.2,ns=.3;break;case"build":Ge=Ot*1.1,Mn=2,ns=.22;break;default:Mn=1.8,ns=.25}Ge=Math.max(Ge,T.gender==="male"?1400:1100);const ar=Math.round(I*Mn),Vn=Math.round(Ge*ns/9),Xs=Math.max(0,Math.round((Ge-ar*4-Vn*9)/4));H({calories:Math.round(Ge),protein:ar,carbs:Xs,fats:Vn,bmr:Math.round(ce),neat:Math.round(Ue),exerciseAdd:qe[T.trainingFrequency],tdee:Math.round(Ot)})},Hn=async()=>{if(W)try{const I={clientId:t.id,calories:W.calories,protein:W.protein,carbs:W.carbs,fats:W.fats,goal:T.goal,updatedAt:At.now()};await Ts(We(ye,"nutritionTargets",t.id),I),E(I),y("dashboard"),He("Macro targets saved!","success")}catch(I){console.error("Error saving targets:",I),He("Failed to save targets. Please try again.","error")}},Cn=()=>{const I=T.weight&&parseFloat(T.weight)>0,z=T.age&&parseInt(T.age)>0,ie=T.heightUnit==="cm"?T.height&&parseFloat(T.height)>0:T.heightFeet&&parseFloat(T.heightFeet)>0||T.heightInches&&parseFloat(T.heightInches)>0;return I&&z&&ie},yn="nut_favourite_foods",Ss=()=>{try{return JSON.parse(localStorage.getItem(yn)||"[]")}catch{return[]}};w.useEffect(()=>{if(!t?.id)return;(async()=>{try{const z=await Es(We(ye,"favouriteFoods",t.id));if(z.exists()){const ie=z.data().items||[];localStorage.setItem(yn,JSON.stringify(ie)),es(ce=>ce+1)}else{const ie=Ss();ie.length>0&&await Ts(We(ye,"favouriteFoods",t.id),{items:ie,updatedAt:At.now()})}}catch(z){console.error("Error loading favourites:",z)}})()},[t?.id]);const le=I=>Ss().some(z=>z.name.toLowerCase()===(I||"").toLowerCase()),Me=I=>{const z=Ss(),ie=z.findIndex(ce=>ce.name.toLowerCase()===I.name.toLowerCase());ie>=0?z.splice(ie,1):z.unshift({name:I.name,protein:I.protein,carbs:I.carbs,fats:I.fats,calories:I.calories,serving:I.serving,per100g:I.per100g||null,servingUnit:I.servingUnit||"g",portion:I.portion||null}),localStorage.setItem(yn,JSON.stringify(z)),t?.id&&Ts(We(ye,"favouriteFoods",t.id),{items:z,updatedAt:At.now()}).catch(ce=>console.error("Error saving favourites:",ce)),es(ce=>ce+1)},Ye=I=>{const z=[...G.entries,{...I,meal:X,id:Date.now(),addedAt:new Date().toISOString()}],ie={...G,entries:z};Q(ie),nt(ie),P(null),Ct(null),Rt("100"),Tt(0),Xt("weight"),En({name:"",protein:"",carbs:"",fats:"",calories:"",serving:""}),He("Food added!","success")},yt=I=>{const z=G.entries.filter(ce=>ce.id!==I),ie={...G,entries:z};Q(ie),nt(ie)},it=async I=>{if(!(!t?.id||I===B)){Je(!0);try{const z=await Es(We(ye,"nutritionLogs",`${t.id}_${I}`));if(!z.exists()||!z.data().entries?.length){He("No food logged on that day","error");return}const ie=z.data().entries.map(Ue=>({...Ue,id:Date.now()+Math.random(),addedAt:new Date().toISOString()})),ce=[...G.entries,...ie],Pe={...G,entries:ce};Q(Pe),nt(Pe),O(!1),He(`Copied ${ie.length} items from ${Rn(I)}`,"success")}catch(z){console.error("Error copying day:",z),He("Failed to copy day","error")}finally{Je(!1)}}},Gt=w.useRef(null),vn=w.useRef([]),an=3,Kt=5,vs=async()=>{we(!0);const I=document.querySelector("#barcode-reader");if(!I){we(!1),He("Scanner container not found.","error");return}if(!Gt.current)try{const ie=await Ks(()=>import("./quagga.min-BbicSfvA.js").then(ce=>ce.q),[]);Gt.current=ie.default}catch(ie){console.error("Failed to load barcode scanner:",ie),we(!1),He("Could not load scanner.","error");return}const z=Gt.current;z.init({inputStream:{type:"LiveStream",target:I,constraints:{facingMode:"environment",width:{min:640,ideal:1280,max:1920},height:{min:480,ideal:720,max:1080}}},locator:{patchSize:"medium",halfSample:!0},numOfWorkers:navigator.hardwareConcurrency||2,decoder:{readers:["ean_reader","ean_8_reader","upc_reader","upc_e_reader","code_128_reader","code_39_reader"]},locate:!0},ie=>{if(ie){console.error("Quagga init error:",ie),we(!1),He("Could not access camera. Check permissions.","error");return}z.start(),Ae.current=!0}),vn.current=[],z.onDetected(ie=>{const ce=ie.codeResult.decodedCodes?.filter(Ue=>Ue.error!==void 0)?.map(Ue=>Ue.error)||[];if((ce.length>0?ce.reduce((Ue,qe)=>Ue+qe,0)/ce.length:1)<.15){const Ue=ie.codeResult.code,qe=vn.current;qe.push(Ue),qe.length>Kt&&qe.shift(),qe.filter(Ge=>Ge===Ue).length>=an&&(z.offDetected(),vn.current=[],xe(Ue))}})},Nn=()=>{const I=Gt.current;Ae.current&&I&&(I.stop(),I.offDetected(),Ae.current=!1),we(!1)},bs=/\b(milk|semi.skimmed|skimmed|whole milk|oat milk|almond milk|soy milk|juice|smoothie|water|squash|cordial|cola|pepsi|fanta|lemonade|soda|beer|wine|cider|lager|spirit|whisky|vodka|rum|gin|brandy|cream|yoghurt drink|milkshake|coffee|tea|broth|stock|soup|sauce|ketchup|vinegar|oil|syrup|honey|custard|coconut water|kombucha|energy drink|protein shake)\b/i,en=I=>/ml|cl|\dl(?!b)|litre|liter|fl\s?oz/i.test((I||"").replace(/\s/g,"")),un=I=>{if(!I)return{value:100,unit:"g"};const z=I.toLowerCase().replace(/\s/g,""),ie=z.match(/([\d.]+)/),ce=ie?parseFloat(ie[1]):100;return en(I)?/cl/.test(z)?{value:ce*10,unit:"ml"}:/(?:^|\d)l(?!i)/.test(z)&&!/ml/.test(z)?{value:ce*1e3,unit:"ml"}:{value:ce,unit:"ml"}:{value:ce,unit:"g"}},cs=I=>{if(en(I.serving_size)||en(I.quantity))return"ml";const z=I.product_name||I.product_name_en||"";return bs.test(z)?"ml":"g"},Qr=[{pattern:/\b(toast|bread|loaf|brioche|bagel|pitta|wrap|tortilla|crumpet|muffin|waffle|pancake)\b/i,label:"slice",weight:36},{pattern:/\begg\b/i,label:"egg",weight:60},{pattern:/\b(biscuit|cookie|digestive|hobnob|rich tea|oreo)\b/i,label:"biscuit",weight:13},{pattern:/\b(sausage|banger)\b/i,label:"sausage",weight:57},{pattern:/\b(rasher|bacon)\b/i,label:"rasher",weight:25},{pattern:/\b(rice cake)\b/i,label:"cake",weight:9},{pattern:/\b(cracker|ryvita)\b/i,label:"cracker",weight:10}],fa=(I,z)=>{const ie=I||"",ce=ie.match(/\((\d+\.?\d*)\s*g\)/i),Pe=ie.match(/(?:^|per\s+)(\d*\s*[a-z][a-z\s]*?)(?:\s*\(|\s*-\s*|\s*$)/i);if(ce&&Pe){const Ot=parseFloat(ce[1]);let Ge=Pe[1].replace(/^\d+\s*/,"").trim();if(Ge&&Ot>0)return{label:Ge,weight:Ot}}const Ue=ie.match(/(\d+\.?\d*)\s*g\s*[\/=]\s*(\d*\s*[a-z][a-z\s]*)/i);if(Ue){const Ot=parseFloat(Ue[1]);let Ge=Ue[2].replace(/^\d+\s*/,"").trim();if(Ge&&Ot>0)return{label:Ge,weight:Ot}}const qe=z||"";for(const{pattern:Ot,label:Ge,weight:Mn}of Qr)if(Ot.test(qe))return{label:Ge,weight:Mn};return null},Xr=I=>{const z=I.nutriments||{},ie=cs(I),ce=un(I.serving_size),Pe=ie==="ml"?ce.unit==="ml"?ce.value:100:ce.value,Ue=I.product_name||I.product_name_en||"Unknown Product",qe=fa(I.serving_size,Ue);return{name:Ue,brand:I.brands||"",image:I.image_small_url||I.image_url||null,servingSize:I.serving_size||"100g",servingValue:Pe,servingUnit:ie,portion:qe,protein:Math.round(z.proteins_100g||z.proteins||0),carbs:Math.round(z.carbohydrates_100g||z.carbohydrates||0),fats:Math.round(z.fat_100g||z.fat||0),calories:Math.round(z["energy-kcal_100g"]||z["energy-kcal"]||(z.energy_100g?z.energy_100g/4.184:0)),per100g:!0}},gr=async I=>{Oe(!0);try{const z=`https://world.openfoodfacts.org/api/v2/product/${I}?fields=product_name,product_name_en,brands,image_small_url,image_url,serving_size,quantity,nutriments`,ie=await fetch(z);if(!ie.ok)throw new Error(`HTTP ${ie.status}`);const ce=await ie.json();if(ce.status==="success"||ce.status===1||ce.product){const Pe=Xr(ce.product);Pe.calories===0&&Pe.protein===0&&Pe.carbs===0?He("Product found but no nutrition data available.","error"):(Ct(Pe),Pe.portion?(Tt(1),Rt(String(Pe.portion.weight)),Xt("portion")):(Tt(0),Rt(String(Pe.servingValue||100)),Xt("weight")),Fe(""))}else He("Product not found. Try search or manual entry.","error")}catch(z){console.error("Barcode lookup error:",z),He("Failed to look up product. Check your connection.","error")}Oe(!1)},$n=(I,z,ie)=>{const ce=I.toLowerCase().trim(),Pe=z.toLowerCase().trim(),Ue=ie.toLowerCase().trim();let qe=0;return(ce===Ue||ce===Ue+"s"||ce+"s"===Ue)&&(qe+=100),(ce.endsWith(" "+Ue)||ce.endsWith(" "+Ue+"s"))&&(qe+=40),(ce.startsWith(Ue+" ")||ce.startsWith(Ue+"s "))&&(qe+=15),Ue.split(/\s+/).some(Ge=>Pe===Ge||Pe.startsWith(Ge))&&(qe+=30),qe+=Math.max(0,30-ce.length),qe},Fs=async()=>{if(!Mt.trim())return;gt.current&&gt.current.abort();const I=new AbortController;gt.current=I;const z=Mt.trim().toLowerCase(),ie=z.split(/\s+/).filter(Boolean);if(Zp.has(z)){Qt(Zp.get(z));return}st(!0);try{const Pe=`https://world.openfoodfacts.org/cgi/search.pl?search_terms=${encodeURIComponent(Mt.trim())}&search_simple=1&action=process&json=1&page_size=10&lc=en&sort_by=unique_scans_n&fields=product_name,product_name_en,brands,image_small_url,image_url,serving_size,quantity,nutriments`,Ue=await fetch(Pe,{signal:I.signal});if(!Ue.ok)throw new Error(`HTTP ${Ue.status}`);const Ot=((await Ue.json()).products||[]).map(Ge=>Xr(Ge)).filter(Ge=>Ge.name!=="Unknown Product"&&(Ge.calories>0||Ge.protein>0)).filter(Ge=>{const Mn=(Ge.name+" "+Ge.brand).toLowerCase();return ie.every(ns=>Mn.includes(ns))}).sort((Ge,Mn)=>$n(Mn.name,Mn.brand,z)-$n(Ge.name,Ge.brand,z)).slice(0,10);Zp.set(z,Ot),Qt(Ot),Ot.length===0&&He("No results found. Try a different search.","info")}catch(ce){if(ce.name==="AbortError")return;console.error("Search error:",ce),He("Search failed. Check your connection.","error")}st(!1)};w.useEffect(()=>{if(vt.current&&clearTimeout(vt.current),!(!Mt.trim()||J!=="search"||fe))return vt.current=setTimeout(()=>{Fs()},700),()=>clearTimeout(vt.current)},[Mt]);const ws=l,Pn={"ring-protein":ws?"#2dd4bf":"#14b8a6","ring-carbs":ws?"#fbbf24":"#f59e0b","ring-fats":ws?"#a78bfa":"#8b5cf6","ring-cals":"var(--color-primary)"},In=80,ts=2*Math.PI*In,Ft=(I,z,ie,ce,Pe)=>{const Ue=ce>0?Math.min(100,Math.round(ie/ce*100)):0,qe=ts-Ue/100*ts,Ot=Pn[Pe]||"#14b8a6";return a.jsxs("div",{className:"nut-ring-wrap",children:[a.jsxs("svg",{className:"nut-ring-svg",viewBox:"0 0 200 200",children:[a.jsx("circle",{className:"nut-arc-track",cx:"100",cy:"100",r:In}),a.jsx("circle",{className:"nut-arc-fill",cx:"100",cy:"100",r:In,style:{stroke:Ot},strokeDasharray:ts,strokeDashoffset:qe})]}),a.jsxs("div",{className:"nut-ring-center",children:[a.jsx("span",{className:"nut-ring-value",style:{color:Ot},children:Math.round(ie)}),a.jsxs("span",{className:"nut-ring-target",children:["/ ",ce,I==="Calories"?"":"g"]}),a.jsx("span",{className:"nut-ring-label",style:{color:Ot},children:z})]}),a.jsxs("span",{className:"nut-ring-pct",style:{color:Ot},children:[Ue,"%"]})]})};if(w.useEffect(()=>{if(!_e)return;const I=setTimeout(()=>{const z=_e;Nn(),xe(null),gr(z)},1500);return()=>clearTimeout(I)},[_e]),w.useEffect(()=>()=>{const I=Gt.current;if(Ae.current&&I){try{I.stop(),I.offDetected()}catch{}Ae.current=!1}},[]),i||g==="loading")return a.jsxs("div",{className:"nut-page","data-theme":l?"dark":"light","data-accent":d,children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>p("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})]})}),a.jsx("div",{className:"nut-loading-inline",children:a.jsx("div",{className:"cb-loading-spinner"})})]});if(g==="setup")return a.jsxs("div",{className:"nut-page","data-theme":l?"dark":"light","data-accent":d,children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>p("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"nut-main",children:[a.jsxs("div",{className:"nut-setup-intro",children:[a.jsx("h2",{children:"Set Your Daily Targets"}),a.jsx("p",{children:"Calculate your personalised macros based on your body and goals."})]}),a.jsxs("div",{className:"nut-calc-form",children:[a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Gender"}),a.jsxs("div",{className:"nut-toggle-group",children:[a.jsx("button",{className:T.gender==="male"?"active":"",onClick:()=>{L(I=>({...I,gender:"male"})),H(null)},children:"Male"}),a.jsx("button",{className:T.gender==="female"?"active":"",onClick:()=>{L(I=>({...I,gender:"female"})),H(null)},children:"Female"})]})]}),a.jsxs("div",{className:"nut-form-row",children:[a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Age"}),a.jsx("input",{type:"number",value:T.age,onChange:I=>{L(z=>({...z,age:I.target.value})),H(null)},placeholder:"Years",min:"15",max:"100"})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Weight"}),a.jsxs("div",{className:"nut-input-unit",children:[a.jsx("input",{type:"number",value:T.weight,onChange:I=>{L(z=>({...z,weight:I.target.value})),H(null)},placeholder:T.weightUnit,min:"30",max:"300"}),a.jsxs("div",{className:"nut-unit-toggle",children:[a.jsx("button",{className:T.weightUnit==="kg"?"active":"",onClick:()=>{L(I=>({...I,weightUnit:"kg"})),H(null)},children:"kg"}),a.jsx("button",{className:T.weightUnit==="lbs"?"active":"",onClick:()=>{L(I=>({...I,weightUnit:"lbs"})),H(null)},children:"lbs"})]})]})]})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Height"}),a.jsxs("div",{className:"nut-input-unit",children:[T.heightUnit==="cm"?a.jsx("input",{type:"number",value:T.height,onChange:I=>{L(z=>({...z,height:I.target.value})),H(null)},placeholder:"cm",min:"100",max:"250"}):a.jsxs("div",{className:"nut-height-imperial",children:[a.jsx("input",{type:"number",value:T.heightFeet,onChange:I=>{L(z=>({...z,heightFeet:I.target.value})),H(null)},placeholder:"ft",min:"4",max:"7"}),a.jsx("input",{type:"number",value:T.heightInches,onChange:I=>{L(z=>({...z,heightInches:I.target.value})),H(null)},placeholder:"in",min:"0",max:"11"})]}),a.jsxs("div",{className:"nut-unit-toggle",children:[a.jsx("button",{className:T.heightUnit==="cm"?"active":"",onClick:()=>{L(I=>({...I,heightUnit:"cm"})),H(null)},children:"cm"}),a.jsx("button",{className:T.heightUnit==="ft"?"active":"",onClick:()=>{L(I=>({...I,heightUnit:"ft"})),H(null)},children:"ft/in"})]})]})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Daily Activity (outside of training)"}),a.jsxs("select",{value:T.dailyActivity,onChange:I=>{L(z=>({...z,dailyActivity:I.target.value})),H(null)},children:[a.jsx("option",{value:"sedentary",children:"Sedentary  desk job, under 5k steps"}),a.jsx("option",{value:"light",children:"Lightly Active  office + walking, 5-8k steps"}),a.jsx("option",{value:"moderate",children:"Moderately Active  on feet often, 8-12k steps"}),a.jsx("option",{value:"active",children:"Very Active  physical job, 12k+ steps"})]})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Training Sessions per Week"}),a.jsxs("select",{value:T.trainingFrequency,onChange:I=>{L(z=>({...z,trainingFrequency:I.target.value})),H(null)},children:[a.jsx("option",{value:"low",children:"1-2 sessions"}),a.jsx("option",{value:"moderate",children:"3-4 sessions"}),a.jsx("option",{value:"high",children:"5-6 sessions"}),a.jsx("option",{value:"daily",children:"7+ sessions"})]})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Fitness Goal"}),a.jsxs("div",{className:"nut-goal-options",children:[a.jsxs("button",{className:T.goal==="lose"?"active":"",onClick:()=>{L(I=>({...I,goal:"lose"})),H(null)},children:[a.jsx("span",{className:"nut-goal-icon",children:"-"}),a.jsx("span",{children:"Lose Weight"})]}),a.jsxs("button",{className:T.goal==="maintain"?"active":"",onClick:()=>{L(I=>({...I,goal:"maintain"})),H(null)},children:[a.jsx("span",{className:"nut-goal-icon",children:"="}),a.jsx("span",{children:"Maintain"})]}),a.jsxs("button",{className:T.goal==="build"?"active":"",onClick:()=>{L(I=>({...I,goal:"build"})),H(null)},children:[a.jsx("span",{className:"nut-goal-icon",children:"+"}),a.jsx("span",{children:"Build Muscle"})]})]})]}),T.goal==="lose"&&a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Deficit Level"}),a.jsxs("div",{className:"nut-deficit-options",children:[a.jsxs("button",{className:T.deficitLevel==="light"?"active":"",onClick:()=>{L(I=>({...I,deficitLevel:"light"})),H(null)},children:[a.jsx("strong",{children:"Mild"}),a.jsx("span",{children:"15% below TDEE"})]}),a.jsxs("button",{className:T.deficitLevel==="moderate"?"active":"",onClick:()=>{L(I=>({...I,deficitLevel:"moderate"})),H(null)},children:[a.jsx("strong",{children:"Moderate"}),a.jsx("span",{children:"20% below TDEE"})]}),a.jsxs("button",{className:T.deficitLevel==="harsh"?"active":"",onClick:()=>{L(I=>({...I,deficitLevel:"harsh"})),H(null)},children:[a.jsx("strong",{children:"Aggressive"}),a.jsx("span",{children:"25% below TDEE"})]})]})]}),a.jsx("button",{className:"nut-calc-btn",onClick:Zt,disabled:!Cn(),children:"Calculate Macros"})]}),W&&a.jsxs("div",{className:"nut-calc-results",children:[a.jsx("h3",{children:"Your Daily Targets"}),a.jsxs("div",{className:"nut-calc-rings",children:[Ft("Protein","Protein",W.protein,W.protein,"ring-protein"),Ft("Carbs","Carbs",W.carbs,W.carbs,"ring-carbs"),Ft("Fats","Fats",W.fats,W.fats,"ring-fats"),Ft("Calories","Calories",W.calories,W.calories,"ring-cals")]}),a.jsxs("div",{className:"nut-calc-info",children:[a.jsxs("div",{className:"nut-calc-info-row",children:[a.jsx("span",{children:"BMR (body at rest)"}),a.jsxs("span",{children:[W.bmr," cal"]})]}),a.jsxs("div",{className:"nut-calc-info-row",children:[a.jsx("span",{children:"+ Daily activity (NEAT)"}),a.jsxs("span",{children:[W.neat," cal"]})]}),a.jsxs("div",{className:"nut-calc-info-row",children:[a.jsx("span",{children:"+ Training sessions"}),a.jsxs("span",{children:["+",W.exerciseAdd," cal"]})]}),a.jsxs("div",{className:"nut-calc-info-row",style:{fontWeight:600},children:[a.jsx("span",{children:"TDEE (total burn)"}),a.jsxs("span",{children:[W.tdee," cal"]})]})]}),a.jsx("button",{className:"nut-save-targets-btn",onClick:Hn,children:"Set as My Daily Targets"})]})]}),Wt&&a.jsx("div",{className:`toast-notification ${Wt.type}`,children:Wt.message})]});const yr=I=>{const z=new Date(I+"T12:00:00"),ie=z.getDay(),ce=new Date(z);ce.setDate(z.getDate()-(ie+6)%7);const Pe=[];for(let Ue=0;Ue<7;Ue++){const qe=new Date(ce);qe.setDate(ce.getDate()+Ue),Pe.push(qe.toISOString().split("T")[0])}return Pe},Rr=["M","T","W","T","F","S","S"],xs=(I,z="search")=>{je(I),z==="scan"?(P("scan"),Ct(null)):z==="manual"?(P("manual"),En({name:"",protein:"",carbs:"",fats:"",calories:"",serving:""})):z==="favourites"?P("favourites"):(P("search"),Qt([]),cn(""))},Tn=yr(B),Qs=new Date(B+"T12:00:00"),Jr=`${On[Qs.getMonth()]} ${Qs.getFullYear()}`;return a.jsx(Jo,{children:a.jsxs("div",{className:"nut-page","data-theme":l?"dark":"light","data-accent":d,children:[a.jsxs("div",{className:"nut-dark-zone",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>p("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsxs("div",{className:"header-actions",children:[a.jsx("button",{onClick:()=>{y("setup"),H(null)},"aria-label":"Recalculate macros",children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"3"}),a.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 1 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 1 1-2.83-2.83l.06-.06A1.65 1.65 0 0 0 4.68 15a1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1 0-4h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 1 1 2.83-2.83l.06.06A1.65 1.65 0 0 0 9 4.68a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 2.83l-.06.06A1.65 1.65 0 0 0 19.4 9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1z"})]})}),a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})]})]})}),a.jsxs("div",{className:"nut-dark-content",children:[a.jsxs("div",{className:"nut-week-strip anim-fade-up",children:[a.jsxs("div",{className:"nut-week-header",children:[a.jsx("button",{className:"nut-week-arrow",onClick:()=>{const I=new Date(B+"T12:00:00");I.setDate(I.getDate()-7);const z=I.toISOString().split("T")[0];K(z)},"aria-label":"Previous week",children:a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:a.jsx("polyline",{points:"15 18 9 12 15 6"})})}),a.jsx("button",{className:"nut-week-month-label",onClick:()=>{C(!ge),R({year:Qs.getFullYear(),month:Qs.getMonth()})},children:Jr}),a.jsx("button",{className:"nut-week-arrow",onClick:()=>{const I=new Date(B+"T12:00:00");I.setDate(I.getDate()+7);const z=I.toISOString().split("T")[0];z<=Hr()&&K(z)},"aria-label":"Next week",disabled:Tn[6]>=Hr(),children:a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:a.jsx("polyline",{points:"9 18 15 12 9 6"})})})]}),a.jsx("div",{className:"nut-week-days",children:Tn.map((I,z)=>{const ie=new Date(I+"T12:00:00").getDate(),ce=I===B,Pe=I>Hr(),Ue=I===Hr();return a.jsxs("button",{className:`nut-week-day${ce?" selected":""}${Ue?" today":""}${Pe?" future":""}`,disabled:Pe,onClick:()=>K(I),children:[a.jsx("span",{className:"nut-week-day-letter",children:Rr[z]}),a.jsx("span",{className:"nut-week-day-num",children:ie})]},I)})})]}),ge&&a.jsxs("div",{className:"nut-calendar nut-calendar-dark",children:[a.jsxs("div",{className:"nut-cal-header",children:[a.jsx("button",{onClick:()=>R(I=>{let z=I.month-1,ie=I.year;return z<0&&(z=11,ie--),{year:ie,month:z}}),children:a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("polyline",{points:"15 18 9 12 15 6"})})}),a.jsxs("span",{children:[On[j.month]," ",j.year]}),a.jsx("button",{onClick:()=>R(I=>{let z=I.month+1,ie=I.year;return z>11&&(z=0,ie++),{year:ie,month:z}}),disabled:j.year===new Date().getFullYear()&&j.month>=new Date().getMonth(),children:a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("polyline",{points:"9 18 15 12 9 6"})})})]}),a.jsx("div",{className:"nut-cal-days-header",children:Kn.map(I=>a.jsx("span",{children:I},I))}),a.jsxs("div",{className:"nut-cal-grid",children:[[...Array(Jt(j.year,j.month))].map((I,z)=>a.jsx("span",{},`e${z}`)),[...Array(rn(j.year,j.month))].map((I,z)=>{const ie=z+1,ce=`${j.year}-${String(j.month+1).padStart(2,"0")}-${String(ie).padStart(2,"0")}`,Pe=ce>Hr(),Ue=ce===B,qe=ce===Hr();return a.jsx("button",{className:`nut-cal-day${Ue?" selected":""}${qe?" today":""}${Pe?" future":""}`,disabled:Pe,onClick:()=>{K(ce),C(!1)},children:ie},ie)})]})]}),a.jsxs("div",{className:"nut-rings-row anim-fade-up-d2",children:[Ft("Protein","Protein",he.protein,b.protein,"ring-protein"),Ft("Carbs","Carbs",he.carbs,b.carbs,"ring-carbs"),Ft("Fats","Fats",he.fats,b.fats,"ring-fats"),Ft("Calories","kCal",he.calories,b.calories,"ring-cals")]})]})]}),a.jsx("div",{className:"nut-light-zone anim-fade-up-d4",children:a.jsxs("div",{className:"nut-light-content",children:[$e&&a.jsx("div",{className:"nut-quick-row",children:a.jsxs("button",{className:"nut-copy-day-btn",onClick:()=>{O(!0),A({year:new Date().getFullYear(),month:new Date().getMonth()})},children:[a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",width:"18",height:"18",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"}),a.jsx("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"})]}),a.jsx("span",{children:"Copy day"})]})}),a.jsx("div",{className:"nut-log-section",children:a.jsx("div",{className:"nut-meals-list",children:Ww.map(I=>{const z=G.entries.filter(ce=>(ce.meal||"snacks")===I.key),ie=z.reduce((ce,Pe)=>({protein:ce.protein+(Pe.protein||0),carbs:ce.carbs+(Pe.carbs||0),fats:ce.fats+(Pe.fats||0),calories:ce.calories+(Pe.calories||0)}),{protein:0,carbs:0,fats:0,calories:0});return a.jsxs("div",{className:"nut-meal-card",children:[a.jsxs("div",{className:"nut-meal-card-header",children:[a.jsx("span",{className:`nut-meal-card-icon nut-meal-icon-${I.key}`,children:N3[I.key]}),a.jsx("span",{className:"nut-meal-card-title",children:I.label}),z.length>0&&a.jsxs("span",{className:"nut-meal-card-cal",children:[ie.calories," cal"]}),$e&&a.jsx("button",{className:"nut-meal-add-btn",onClick:()=>Ce(De===I.key?null:I.key),"aria-label":`Add to ${I.label}`,children:a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:[a.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),a.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})})]}),z.length>0&&a.jsxs("div",{className:"nut-meal-bars",children:[a.jsxs("div",{className:"nut-meal-bar-row",children:[a.jsx("span",{className:"nut-meal-bar-label nut-macro-p",children:"P"}),a.jsx("div",{className:"nut-meal-bar-track",children:a.jsx("div",{className:"nut-meal-bar-fill bar-protein",style:{width:`${Math.min(100,b.protein>0?ie.protein/b.protein*100:0)}%`}})}),a.jsxs("span",{className:"nut-meal-bar-val",children:[ie.protein,"g"]})]}),a.jsxs("div",{className:"nut-meal-bar-row",children:[a.jsx("span",{className:"nut-meal-bar-label nut-macro-c",children:"C"}),a.jsx("div",{className:"nut-meal-bar-track",children:a.jsx("div",{className:"nut-meal-bar-fill bar-carbs",style:{width:`${Math.min(100,b.carbs>0?ie.carbs/b.carbs*100:0)}%`}})}),a.jsxs("span",{className:"nut-meal-bar-val",children:[ie.carbs,"g"]})]}),a.jsxs("div",{className:"nut-meal-bar-row",children:[a.jsx("span",{className:"nut-meal-bar-label nut-macro-f",children:"F"}),a.jsx("div",{className:"nut-meal-bar-track",children:a.jsx("div",{className:"nut-meal-bar-fill bar-fats",style:{width:`${Math.min(100,b.fats>0?ie.fats/b.fats*100:0)}%`}})}),a.jsxs("span",{className:"nut-meal-bar-val",children:[ie.fats,"g"]})]}),a.jsxs("div",{className:"nut-meal-bar-row",children:[a.jsx("span",{className:"nut-meal-bar-label nut-macro-cal",children:"K"}),a.jsx("div",{className:"nut-meal-bar-track",children:a.jsx("div",{className:"nut-meal-bar-fill bar-cals",style:{width:`${Math.min(100,b.calories>0?ie.calories/b.calories*100:0)}%`}})}),a.jsx("span",{className:"nut-meal-bar-val",children:ie.calories})]})]}),z.length>0&&a.jsx("div",{className:"nut-log-list",children:z.map(ce=>a.jsxs("div",{className:"nut-log-item",children:[a.jsx("button",{className:`nut-fav-star log${le(ce.name)?" active":""}`,onClick:()=>Me(ce),"aria-label":le(ce.name)?"Remove from favourites":"Add to favourites",children:a.jsx("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:le(ce.name)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),a.jsxs("div",{className:"nut-log-item-info",children:[a.jsx("span",{className:"nut-log-item-name",children:ce.name}),ce.serving&&a.jsx("span",{className:"nut-log-item-serving",children:ce.serving})]}),a.jsxs("div",{className:"nut-log-item-macros",children:[a.jsxs("span",{className:"nut-macro-p",children:[ce.protein,"p"]}),a.jsxs("span",{className:"nut-macro-c",children:[ce.carbs,"c"]}),a.jsxs("span",{className:"nut-macro-f",children:[ce.fats,"f"]}),a.jsx("span",{className:"nut-macro-cal",children:ce.calories})]}),$e&&a.jsx("button",{className:"nut-log-delete",onClick:()=>yt(ce.id),"aria-label":"Remove",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]},ce.id))}),z.length===0&&a.jsx("div",{className:"nut-meal-empty",children:a.jsx("p",{children:$e?"Tap + to add food":"No entries"})})]},I.key)})})})]})}),De&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"nut-add-picker-backdrop",onClick:()=>Ce(null)}),a.jsxs("div",{className:"nut-add-picker",children:[a.jsx("div",{className:"nut-add-picker-handle"}),a.jsxs("h3",{className:"nut-add-picker-title",children:["Add to ",Ww.find(I=>I.key===De)?.label]}),a.jsxs("div",{className:"nut-add-picker-options",children:[a.jsxs("button",{onClick:()=>{const I=De;Ce(null),xs(I,"scan")},children:[a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M3 7V5a2 2 0 0 1 2-2h2"}),a.jsx("path",{d:"M17 3h2a2 2 0 0 1 2 2v2"}),a.jsx("path",{d:"M21 17v2a2 2 0 0 1-2 2h-2"}),a.jsx("path",{d:"M7 21H5a2 2 0 0 1-2-2v-2"}),a.jsx("line",{x1:"7",y1:"12",x2:"17",y2:"12"})]}),a.jsx("span",{children:"Scan Barcode"})]}),a.jsxs("button",{onClick:()=>{const I=De;Ce(null),xs(I,"search")},children:[a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"11",cy:"11",r:"8"}),a.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),a.jsx("span",{children:"Search Food"})]}),a.jsxs("button",{onClick:()=>{const I=De;Ce(null),xs(I,"manual")},children:[a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),a.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]}),a.jsx("span",{children:"Manual Entry"})]}),a.jsxs("button",{onClick:()=>{const I=De;Ce(null),xs(I,"favourites")},children:[a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),a.jsx("span",{children:"Favourites"})]})]})]})]}),V&&a.jsx("div",{className:"nut-modal-overlay",onClick:()=>O(!1),children:a.jsxs("div",{className:"nut-copy-from-popup",onClick:I=>I.stopPropagation(),children:[a.jsxs("div",{className:"nut-copy-from-header",children:[a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",width:"20",height:"20",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"}),a.jsx("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"})]}),a.jsx("span",{children:"Copy from..."}),a.jsx("button",{className:"nut-modal-close",onClick:()=>O(!1),children:a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),a.jsx("p",{className:"nut-copy-from-hint",children:"Pick a day to copy its food log into today"}),a.jsxs("div",{className:"nut-cal-header",children:[a.jsx("button",{onClick:()=>A(I=>{let z=I.month-1,ie=I.year;return z<0&&(z=11,ie--),{year:ie,month:z}}),children:a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("polyline",{points:"15 18 9 12 15 6"})})}),a.jsxs("span",{children:[On[D.month]," ",D.year]}),a.jsx("button",{onClick:()=>A(I=>{let z=I.month+1,ie=I.year;return z>11&&(z=0,ie++),{year:ie,month:z}}),disabled:D.year===new Date().getFullYear()&&D.month>=new Date().getMonth(),children:a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("polyline",{points:"9 18 15 12 9 6"})})})]}),a.jsx("div",{className:"nut-cal-days-header",children:Kn.map(I=>a.jsx("span",{children:I},I))}),a.jsxs("div",{className:"nut-cal-grid",children:[[...Array(Jt(D.year,D.month))].map((I,z)=>a.jsx("span",{},`e${z}`)),[...Array(rn(D.year,D.month))].map((I,z)=>{const ie=z+1,ce=`${D.year}-${String(D.month+1).padStart(2,"0")}-${String(ie).padStart(2,"0")}`,Pe=ce>Hr(),Ue=ce===B,qe=ce===Hr(),Ot=Pe||Ue;return a.jsx("button",{className:`nut-cal-day${Ue?" selected":""}${qe?" today":""}${Pe?" future":""}`,disabled:Ot,onClick:()=>it(ce),children:ie},ie)})]}),Le&&a.jsxs("div",{className:"nut-copy-from-loading",children:[a.jsx("div",{className:"wk-loading-spinner"}),a.jsx("span",{children:"Copying..."})]})]})}),J&&a.jsx("div",{className:"nut-modal-overlay",onClick:()=>{Nn(),xe(null),P(null),Ct(null)},children:a.jsxs("div",{className:"nut-modal",onClick:I=>I.stopPropagation(),children:[a.jsxs("div",{className:"nut-modal-header",children:[a.jsx("h3",{children:J==="scan"?"Scan Barcode":J==="search"?"Search Food":J==="favourites"?"Favourites":"Manual Entry"}),a.jsx("button",{className:"nut-modal-close",onClick:()=>{Nn(),xe(null),P(null),Ct(null)},children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),J==="scan"&&!fe&&a.jsxs("div",{className:"nut-scan-area",children:[a.jsxs("div",{className:"nut-scanner-wrapper",children:[a.jsx("div",{id:"barcode-reader",className:"nut-scanner-view"}),re&&!_e&&a.jsx("div",{className:"nut-scan-line"}),_e&&a.jsxs("div",{className:"nut-scan-detected-overlay",children:[a.jsx("svg",{className:"nut-scan-detected-tick",viewBox:"0 0 24 24",fill:"none",stroke:"#4caf50",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M20 6L9 17l-5-5"})}),a.jsx("p",{className:"nut-scan-detected-label",children:"Barcode found!"}),a.jsx("p",{className:"nut-scan-detected-code",children:_e})]})]}),!re&&a.jsxs("button",{className:"nut-scan-start-btn",onClick:vs,children:[a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M3 7V5a2 2 0 0 1 2-2h2"}),a.jsx("path",{d:"M17 3h2a2 2 0 0 1 2 2v2"}),a.jsx("path",{d:"M21 17v2a2 2 0 0 1-2 2h-2"}),a.jsx("path",{d:"M7 21H5a2 2 0 0 1-2-2v-2"}),a.jsx("line",{x1:"7",y1:"12",x2:"17",y2:"12"})]}),"Open Camera"]}),re&&!_e&&a.jsx("p",{className:"nut-scan-hint",children:"Align barcode within the frame"}),a.jsx("div",{className:"nut-barcode-divider",children:a.jsx("span",{children:"or enter barcode manually"})}),a.jsxs("div",{className:"nut-barcode-manual",children:[a.jsx("input",{type:"text",inputMode:"numeric",value:Se,onChange:I=>Fe(I.target.value),onKeyDown:I=>I.key==="Enter"&&Se.trim()&&gr(Se.trim()),placeholder:"Enter barcode number"}),a.jsx("button",{onClick:()=>Se.trim()&&gr(Se.trim()),disabled:!Se.trim()||Ze,children:Ze?"...":"Look Up"})]})]}),J==="scan"&&fe&&(()=>{const I=fe.servingUnit||"g",z=fe.portion,ie=pt==="portion"&&z?Qe*z.weight:parseFloat(ft)||0,ce=ie/100,Pe=I==="ml"?[100,200,250,500]:[50,100,150,200],Ue=pt==="portion"&&z?`${Qe} ${z.label}${Qe!==1?"s":""} (${Math.round(ie)}${I})`:`${Math.round(ie)}${I}`;return a.jsxs("div",{className:"nut-product-result",children:[fe.image&&a.jsx("img",{src:fe.image,alt:fe.name||"Product",className:"nut-product-img",loading:"lazy"}),a.jsxs("div",{className:"nut-product-name-row",children:[a.jsx("h4",{children:fe.name}),a.jsx("button",{className:`nut-fav-star confirm${le(fe.name)?" active":""}`,onClick:()=>Me({name:fe.name,protein:fe.protein,carbs:fe.carbs,fats:fe.fats,calories:fe.calories,serving:fe.servingSize,per100g:{protein:fe.protein,carbs:fe.carbs,fats:fe.fats,calories:fe.calories},servingUnit:fe.servingUnit||"g",portion:fe.portion||null}),children:a.jsx("svg",{viewBox:"0 0 24 24",width:"22",height:"22",fill:le(fe.name)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})})]}),fe.brand&&a.jsx("p",{className:"nut-product-brand",children:fe.brand}),a.jsxs("p",{className:"nut-product-per",children:["Per 100",I,":"]}),a.jsxs("div",{className:"nut-product-macros",children:[a.jsxs("span",{className:"nut-macro-p",children:[fe.protein,"g P"]}),a.jsxs("span",{className:"nut-macro-c",children:[fe.carbs,"g C"]}),a.jsxs("span",{className:"nut-macro-f",children:[fe.fats,"g F"]}),a.jsxs("span",{className:"nut-macro-cal",children:[fe.calories," cal"]})]}),z&&a.jsxs("div",{className:"nut-mode-toggle",children:[a.jsx("button",{className:pt==="portion"?"active":"",onClick:()=>{Xt("portion"),Qe<1&&Tt(1)},children:"Portions"}),a.jsxs("button",{className:pt==="weight"?"active":"",onClick:()=>{Xt("weight"),Rt(String(Math.round(ie)||100))},children:["Custom (",I,")"]})]}),pt==="portion"&&z?a.jsxs("div",{className:"nut-portion-stepper",children:[a.jsx("button",{className:"nut-stepper-btn",onClick:()=>Tt(Math.max(1,Qe-1)),children:"-"}),a.jsxs("div",{className:"nut-stepper-display",children:[a.jsx("span",{className:"nut-stepper-count",children:Qe}),a.jsxs("span",{className:"nut-stepper-label",children:[z.label,Qe!==1?"s":""]}),a.jsxs("span",{className:"nut-stepper-weight",children:[Math.round(ie),I]})]}),a.jsx("button",{className:"nut-stepper-btn",onClick:()=>Tt(Qe+1),children:"+"})]}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"nut-serving-adjust",children:[a.jsxs("label",{children:["Serving (",I,")"]}),a.jsx("input",{type:"number",inputMode:"numeric",value:ft,onChange:qe=>Rt(qe.target.value),onFocus:qe=>qe.target.select(),min:"0"})]}),a.jsx("div",{className:"nut-quick-amounts",children:Pe.map(qe=>a.jsxs("button",{className:`nut-quick-btn${ft===String(qe)?" active":""}`,onClick:()=>Rt(String(qe)),children:[qe,I]},qe))})]}),a.jsx("div",{className:"nut-product-total",children:a.jsxs("span",{children:["Total: ",Math.round(fe.protein*ce),"p / ",Math.round(fe.carbs*ce),"c / ",Math.round(fe.fats*ce),"f / ",Math.round(fe.calories*ce)," cal"]})}),a.jsxs("div",{className:"nut-product-actions",children:[a.jsx("button",{className:"nut-btn-secondary",onClick:()=>{Ct(null),P("scan")},children:"Scan Again"}),a.jsx("button",{className:"nut-btn-primary",onClick:()=>Ye({name:fe.name,protein:Math.round(fe.protein*ce),carbs:Math.round(fe.carbs*ce),fats:Math.round(fe.fats*ce),calories:Math.round(fe.calories*ce),serving:Ue}),children:"Add"})]})]})})(),J==="search"&&!fe&&a.jsxs("div",{className:"nut-search-area",children:[a.jsxs("div",{className:"nut-search-bar",children:[a.jsx("input",{type:"text",ref:ut,value:Mt,onChange:I=>cn(I.target.value),onKeyDown:I=>{I.key==="Enter"&&(clearTimeout(vt.current),Fs())},onFocus:()=>setTimeout(()=>ut.current?.scrollIntoView({behavior:"smooth",block:"center"}),350),placeholder:"Search food or product...",autoFocus:!0}),a.jsx("button",{onClick:Fs,disabled:rt,children:rt?"...":"Search"})]}),a.jsxs("div",{className:"nut-search-results",children:[qn.map((I,z)=>a.jsxs("button",{className:"nut-search-item",onClick:()=>{Ct(I),I.portion?(Tt(1),Rt(String(I.portion.weight)),Xt("portion")):(Tt(0),Rt(String(I.servingValue||100)),Xt("weight"))},children:[I.image&&a.jsx("img",{src:I.image,alt:I.name||"Product",loading:"lazy"}),a.jsxs("div",{className:"nut-search-item-info",children:[a.jsx("span",{className:"nut-search-item-name",children:I.name}),I.brand&&a.jsx("span",{className:"nut-search-item-brand",children:I.brand}),a.jsxs("span",{className:"nut-search-item-macros",children:[I.calories," cal  ",I.protein,"p  ",I.carbs,"c  ",I.fats,"f per 100",I.servingUnit||"g"]})]})]},z)),qn.length===0&&Mt&&!rt&&a.jsx("p",{className:"nut-search-empty",children:"No results found. Try a different search or use manual entry."})]})]}),J==="search"&&fe&&(()=>{const I=fe.servingUnit||"g",z=fe.portion,ie=pt==="portion"&&z?Qe*z.weight:parseFloat(ft)||0,ce=ie/100,Pe=I==="ml"?[100,200,250,500]:[50,100,150,200],Ue=pt==="portion"&&z?`${Qe} ${z.label}${Qe!==1?"s":""} (${Math.round(ie)}${I})`:`${Math.round(ie)}${I}`;return a.jsxs("div",{className:"nut-product-result",children:[fe.image&&a.jsx("img",{src:fe.image,alt:fe.name||"Product",className:"nut-product-img",loading:"lazy"}),a.jsxs("div",{className:"nut-product-name-row",children:[a.jsx("h4",{children:fe.name}),a.jsx("button",{className:`nut-fav-star confirm${le(fe.name)?" active":""}`,onClick:()=>Me({name:fe.name,protein:fe.protein,carbs:fe.carbs,fats:fe.fats,calories:fe.calories,serving:fe.servingSize,per100g:{protein:fe.protein,carbs:fe.carbs,fats:fe.fats,calories:fe.calories},servingUnit:fe.servingUnit||"g",portion:fe.portion||null}),children:a.jsx("svg",{viewBox:"0 0 24 24",width:"22",height:"22",fill:le(fe.name)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})})]}),fe.brand&&a.jsx("p",{className:"nut-product-brand",children:fe.brand}),a.jsxs("p",{className:"nut-product-per",children:["Per 100",I,":"]}),a.jsxs("div",{className:"nut-product-macros",children:[a.jsxs("span",{className:"nut-macro-p",children:[fe.protein,"g P"]}),a.jsxs("span",{className:"nut-macro-c",children:[fe.carbs,"g C"]}),a.jsxs("span",{className:"nut-macro-f",children:[fe.fats,"g F"]}),a.jsxs("span",{className:"nut-macro-cal",children:[fe.calories," cal"]})]}),z&&a.jsxs("div",{className:"nut-mode-toggle",children:[a.jsx("button",{className:pt==="portion"?"active":"",onClick:()=>{Xt("portion"),Qe<1&&Tt(1)},children:"Portions"}),a.jsxs("button",{className:pt==="weight"?"active":"",onClick:()=>{Xt("weight"),Rt(String(Math.round(ie)||100))},children:["Custom (",I,")"]})]}),pt==="portion"&&z?a.jsxs("div",{className:"nut-portion-stepper",children:[a.jsx("button",{className:"nut-stepper-btn",onClick:()=>Tt(Math.max(1,Qe-1)),children:"-"}),a.jsxs("div",{className:"nut-stepper-display",children:[a.jsx("span",{className:"nut-stepper-count",children:Qe}),a.jsxs("span",{className:"nut-stepper-label",children:[z.label,Qe!==1?"s":""]}),a.jsxs("span",{className:"nut-stepper-weight",children:[Math.round(ie),I]})]}),a.jsx("button",{className:"nut-stepper-btn",onClick:()=>Tt(Qe+1),children:"+"})]}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"nut-serving-adjust",children:[a.jsxs("label",{children:["Serving (",I,")"]}),a.jsx("input",{type:"number",inputMode:"numeric",value:ft,onChange:qe=>Rt(qe.target.value),onFocus:qe=>qe.target.select(),min:"0"})]}),a.jsx("div",{className:"nut-quick-amounts",children:Pe.map(qe=>a.jsxs("button",{className:`nut-quick-btn${ft===String(qe)?" active":""}`,onClick:()=>Rt(String(qe)),children:[qe,I]},qe))})]}),a.jsx("div",{className:"nut-product-total",children:a.jsxs("span",{children:["Total: ",Math.round(fe.protein*ce),"p / ",Math.round(fe.carbs*ce),"c / ",Math.round(fe.fats*ce),"f / ",Math.round(fe.calories*ce)," cal"]})}),a.jsxs("div",{className:"nut-product-actions",children:[a.jsx("button",{className:"nut-btn-secondary",onClick:()=>Ct(null),children:"Back to Search"}),a.jsx("button",{className:"nut-btn-primary",onClick:()=>Ye({name:fe.name,protein:Math.round(fe.protein*ce),carbs:Math.round(fe.carbs*ce),fats:Math.round(fe.fats*ce),calories:Math.round(fe.calories*ce),serving:Ue}),children:"Add"})]})]})})(),J==="manual"&&a.jsxs("div",{className:"nut-manual-form",children:[a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Food Name"}),a.jsx("input",{type:"text",value:ct.name,onChange:I=>En(z=>({...z,name:I.target.value})),placeholder:"e.g. Chicken Breast",autoFocus:!0})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Serving Size (optional)"}),a.jsx("input",{type:"text",value:ct.serving,onChange:I=>En(z=>({...z,serving:I.target.value})),placeholder:"e.g. 150g, 1 cup"})]}),a.jsxs("div",{className:"nut-manual-macros",children:[a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Protein (g)"}),a.jsx("input",{type:"number",value:ct.protein,onChange:I=>En(z=>({...z,protein:I.target.value})),min:"0"})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Carbs (g)"}),a.jsx("input",{type:"number",value:ct.carbs,onChange:I=>En(z=>({...z,carbs:I.target.value})),min:"0"})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Fats (g)"}),a.jsx("input",{type:"number",value:ct.fats,onChange:I=>En(z=>({...z,fats:I.target.value})),min:"0"})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Calories"}),a.jsx("input",{type:"number",value:ct.calories,onChange:I=>En(z=>({...z,calories:I.target.value})),min:"0"})]})]}),a.jsx("button",{className:"nut-btn-primary",disabled:!ct.name.trim(),onClick:()=>Ye({name:ct.name,protein:parseFloat(ct.protein)||0,carbs:parseFloat(ct.carbs)||0,fats:parseFloat(ct.fats)||0,calories:parseFloat(ct.calories)||0,serving:ct.serving||""}),children:"Add Food"})]}),J==="favourites"&&!fe&&(()=>{const I=Ss(),z=ie=>{if(ie.per100g){const ce=ie.per100g;Ct({name:ie.name,brand:"",image:null,servingSize:ie.serving||"100g",servingValue:100,servingUnit:ie.servingUnit||"g",portion:ie.portion||null,protein:ce.protein,carbs:ce.carbs,fats:ce.fats,calories:ce.calories,per100g:!0}),ie.portion?(Tt(1),Rt(String(ie.portion.weight)),Xt("portion")):(Tt(0),Rt("100"),Xt("weight"))}else Ye({name:ie.name,protein:ie.protein,carbs:ie.carbs,fats:ie.fats,calories:ie.calories,serving:ie.serving||""})};return a.jsx("div",{className:"nut-recent-area",children:I.length===0?a.jsx("p",{className:"nut-search-empty",children:"No favourites yet. Tap the star on any food to save it here."}):a.jsx("div",{className:"nut-recent-list",children:I.map((ie,ce)=>a.jsxs("div",{className:"nut-recent-item-row",children:[a.jsx("button",{className:"nut-fav-star active",onClick:Pe=>{Pe.stopPropagation(),Me(ie)},children:a.jsx("svg",{viewBox:"0 0 24 24",width:"18",height:"18",fill:"currentColor",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),a.jsxs("button",{className:"nut-recent-item",onClick:()=>z(ie),children:[a.jsxs("div",{className:"nut-recent-item-info",children:[a.jsx("span",{className:"nut-recent-item-name",children:ie.name}),a.jsx("span",{className:"nut-recent-item-serving",children:ie.serving||""})]}),a.jsxs("span",{className:"nut-recent-item-macros",children:[ie.calories," cal"]})]})]},ce))})})})(),J==="favourites"&&fe&&(()=>{const I=fe.servingUnit||"g",z=fe.portion,ie=pt==="portion"&&z?Qe*z.weight:parseFloat(ft)||0,ce=ie/100,Pe=I==="ml"?[100,200,250,500]:[50,100,150,200],Ue=pt==="portion"&&z?`${Qe} ${z.label}${Qe!==1?"s":""} (${Math.round(ie)}${I})`:`${Math.round(ie)}${I}`;return a.jsxs("div",{className:"nut-product-result",children:[a.jsxs("div",{className:"nut-product-name-row",children:[a.jsx("h4",{children:fe.name}),a.jsx("button",{className:`nut-fav-star confirm${le(fe.name)?" active":""}`,onClick:()=>Me({name:fe.name,protein:fe.protein,carbs:fe.carbs,fats:fe.fats,calories:fe.calories,serving:fe.servingSize,per100g:{protein:fe.protein,carbs:fe.carbs,fats:fe.fats,calories:fe.calories},servingUnit:fe.servingUnit||"g",portion:fe.portion||null}),children:a.jsx("svg",{viewBox:"0 0 24 24",width:"22",height:"22",fill:le(fe.name)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})})]}),a.jsxs("p",{className:"nut-product-per",children:["Per 100",I,":"]}),a.jsxs("div",{className:"nut-product-macros",children:[a.jsxs("span",{className:"nut-macro-p",children:[fe.protein,"g P"]}),a.jsxs("span",{className:"nut-macro-c",children:[fe.carbs,"g C"]}),a.jsxs("span",{className:"nut-macro-f",children:[fe.fats,"g F"]}),a.jsxs("span",{className:"nut-macro-cal",children:[fe.calories," cal"]})]}),z&&a.jsxs("div",{className:"nut-mode-toggle",children:[a.jsx("button",{className:pt==="portion"?"active":"",onClick:()=>{Xt("portion"),Qe<1&&Tt(1)},children:"Portions"}),a.jsxs("button",{className:pt==="weight"?"active":"",onClick:()=>{Xt("weight"),Rt(String(Math.round(ie)||100))},children:["Custom (",I,")"]})]}),pt==="portion"&&z?a.jsxs("div",{className:"nut-portion-stepper",children:[a.jsx("button",{className:"nut-stepper-btn",onClick:()=>Tt(Math.max(1,Qe-1)),children:"-"}),a.jsxs("div",{className:"nut-stepper-display",children:[a.jsx("span",{className:"nut-stepper-count",children:Qe}),a.jsxs("span",{className:"nut-stepper-label",children:[z.label,Qe!==1?"s":""]}),a.jsxs("span",{className:"nut-stepper-weight",children:[Math.round(ie),I]})]}),a.jsx("button",{className:"nut-stepper-btn",onClick:()=>Tt(Qe+1),children:"+"})]}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"nut-serving-adjust",children:[a.jsxs("label",{children:["Serving (",I,")"]}),a.jsx("input",{type:"number",inputMode:"numeric",value:ft,onChange:qe=>Rt(qe.target.value),onFocus:qe=>qe.target.select(),min:"0"})]}),a.jsx("div",{className:"nut-quick-amounts",children:Pe.map(qe=>a.jsxs("button",{className:`nut-quick-btn${ft===String(qe)?" active":""}`,onClick:()=>Rt(String(qe)),children:[qe,I]},qe))})]}),a.jsx("div",{className:"nut-product-total",children:a.jsxs("span",{children:["Total: ",Math.round(fe.protein*ce),"p / ",Math.round(fe.carbs*ce),"c / ",Math.round(fe.fats*ce),"f / ",Math.round(fe.calories*ce)," cal"]})}),a.jsxs("div",{className:"nut-product-actions",children:[a.jsx("button",{className:"nut-btn-secondary",onClick:()=>Ct(null),children:"Back to Favourites"}),a.jsx("button",{className:"nut-btn-primary",onClick:()=>Ye({name:fe.name,protein:Math.round(fe.protein*ce),carbs:Math.round(fe.carbs*ce),fats:Math.round(fe.fats*ce),calories:Math.round(fe.calories*ce),serving:Ue}),children:"Add"})]})]})})()]})}),a.jsx(Yr,{active:"nutrition"}),Wt&&a.jsx("div",{className:`toast-notification ${Wt.type}`,children:Wt.message})]})})}async function I3(s){const{type:e="workout",title:t="Workout Complete!",stats:i=[],badges:l=[],badgeImage:u,badgeDesc:d}=s,p=1080,g=1920,y=document.createElement("canvas");y.width=p,y.height=g;const b=y.getContext("2d"),E="#2a2a28",T="#ffffff",L="#A12F3A",W="#1a1a1a",H="#555555";b.fillStyle=E,b.fillRect(0,0,p,g);const B=Math.round(p*.82),K=Math.round(g*.75),G=Math.round((p-B)/2),Q=Math.round((g-K)/2),he=28,Ee=5;b.save(),b.shadowColor="rgba(0, 0, 0, 0.45)",b.shadowBlur=40,b.shadowOffsetY=10,Gw(b,G,Q,B,K,he),b.fillStyle=T,b.fill(),b.restore(),b.save(),Gw(b,G,Q,B,K,he),b.strokeStyle=L,b.lineWidth=Ee,b.stroke(),b.restore();const ge=220,C=50,j=52,R=68,V=10,O=36,D=48,A=30,Le=34,Je=46,X=30,je=28;b.font=`bold ${j}px 'Orbitron', sans-serif`;const De=Xc(b,t.toUpperCase(),B-100);b.font=`500 ${O}px 'Montserrat', sans-serif`;let Ce=[];e==="badge"&&d?Ce=Xc(b,d,B-120):e==="badge"&&l.length>0?Ce=Xc(b,l.join("    "),B-120):i.length>0&&(Ce=Xc(b,i.map(st=>`${st.value} ${st.label}`).join("    "),B-120));const J=e==="badge"?"I just earned a badge on Core Buddy ":e==="habits"?"I just completed my daily habits with Core Buddy ":"I just completed a workout using Core Buddy ";b.font=`bold ${Le}px 'Montserrat', sans-serif`;const P=Xc(b,J,B-80);let re=De.length*R;Ce.length>0&&(re+=V+Ce.length*D),re+=A+P.length*Je,re+=X+je;const _e=Q+K-60-re,Se=Q+40,Fe=_e-C,Ze=p/2,Oe=(Se+Fe)/2,Mt=e==="badge"&&u?u:"/Logo.webp";b.save();const cn=e==="badge"?"rgba(255, 193, 7, 0.15)":"rgba(161, 47, 58, 0.12)",qn=b.createRadialGradient(Ze,Oe,ge*.6,Ze,Oe,ge*1.5);qn.addColorStop(0,cn),qn.addColorStop(1,"rgba(0, 0, 0, 0)"),b.fillStyle=qn,b.fillRect(Ze-ge*1.5,Oe-ge*1.5,ge*3,ge*3),b.restore(),b.beginPath(),b.arc(Ze,Oe,ge+6,0,Math.PI*2),b.fillStyle=T,b.fill();const Qt=e==="badge"?"#ffc107":L;b.beginPath(),b.arc(Ze,Oe,ge,0,Math.PI*2),b.strokeStyle=Qt,b.lineWidth=5,b.stroke();try{const st=await M3(Mt);b.save(),b.beginPath(),b.arc(Ze,Oe,ge-6,0,Math.PI*2),b.clip();const ct=(ge-6)*2;b.drawImage(st,Ze-ge+6,Oe-ge+6,ct,ct),b.restore()}catch{b.textAlign="center",b.textBaseline="middle",b.fillStyle=L,b.font="bold 80px 'Orbitron', sans-serif",b.fillText(e==="badge"?"":"MCF",Ze,Oe)}let rt=_e;b.textAlign="center",b.textBaseline="alphabetic",b.fillStyle=W,b.font=`bold ${j}px 'Orbitron', sans-serif`;for(const st of De)b.fillText(st,p/2,rt),rt+=R;if(Ce.length>0){rt+=V,b.fillStyle=H,b.font=`500 ${O}px 'Montserrat', sans-serif`;for(const st of Ce)b.fillText(st,p/2,rt),rt+=D}rt+=A,b.fillStyle=W,b.font=`bold ${Le}px 'Montserrat', sans-serif`;for(const st of P)b.fillText(st,p/2,rt),rt+=Je;return rt+=X,b.fillStyle=L,b.font=`600 ${je}px 'Montserrat', sans-serif`,b.fillText("Make It Count with Core Buddy",p/2,rt),new Promise(st=>{y.toBlob(ct=>st(ct),"image/png")})}function Gw(s,e,t,i,l,u){s.beginPath(),s.moveTo(e+u,t),s.lineTo(e+i-u,t),s.quadraticCurveTo(e+i,t,e+i,t+u),s.lineTo(e+i,t+l-u),s.quadraticCurveTo(e+i,t+l,e+i-u,t+l),s.lineTo(e+u,t+l),s.quadraticCurveTo(e,t+l,e,t+l-u),s.lineTo(e,t+u),s.quadraticCurveTo(e,t,e+u,t),s.closePath()}function M3(s){return new Promise((e,t)=>{const i=new Image;i.crossOrigin="anonymous",i.onload=()=>e(i),i.onerror=t,i.src=s})}function Xc(s,e,t){if(s.measureText(e).width<=t)return[e];const i=e.split(" "),l=[];let u="";for(const d of i){const p=u?`${u} ${d}`:d;s.measureText(p).width>t&&u?(l.push(u),u=d):u=p}return u&&l.push(u),l}function D3(){const s=w.useRef(null),e=w.useCallback(()=>{if(!s.current)try{s.current=new(window.AudioContext||window.webkitAudioContext)}catch{}const u=s.current;return u?.state==="suspended"&&u.resume(),u},[]),t=w.useCallback(()=>{navigator.vibrate&&navigator.vibrate([40,60,30]);const u=e();if(!u)return;const d=u.currentTime,p=u.createBiquadFilter();p.type="lowpass",p.frequency.value=500,p.Q.value=.7,p.connect(u.destination);const g=u.createOscillator(),y=u.createGain();g.type="sine",g.frequency.value=50,y.gain.value=.3,y.gain.setTargetAtTime(0,d+.08,.04),g.connect(y).connect(p),g.start(d),g.stop(d+.2);const b=u.createOscillator(),E=u.createGain();b.type="sine",b.frequency.value=70,E.gain.value=.2,E.gain.setTargetAtTime(0,d+.22,.04),b.connect(E).connect(p),b.start(d+.15),b.stop(d+.35)},[e]),i=w.useCallback(()=>{navigator.vibrate&&navigator.vibrate(30);const u=e();if(!u)return;const d=u.currentTime,p=u.createBiquadFilter();p.type="lowpass",p.frequency.value=500,p.Q.value=.7,p.connect(u.destination);const g=u.createOscillator(),y=u.createGain();g.type="sine",g.frequency.value=55,y.gain.value=.35,y.gain.setTargetAtTime(0,d+.08,.04),g.connect(y).connect(p),g.start(d),g.stop(d+.2)},[e]),l=w.useCallback(()=>{navigator.vibrate&&navigator.vibrate([50,80,100]);const u=e();u&&[0,.12].forEach((d,p)=>{const g=u.createOscillator(),y=u.createGain();g.type="sine",g.frequency.value=p===0?523:784,y.gain.value=.12,y.gain.setTargetAtTime(0,u.currentTime+d+.15,.02),g.connect(y).connect(u.destination),g.start(u.currentTime+d),g.stop(u.currentTime+d+.2)})},[e]);return w.useEffect(()=>()=>{s.current?.close()},[]),{tap:i,tick:t,complete:l}}const L3=2e3,$g=42,Al=2*Math.PI*$g,O3=1200,Kw=["Another one in the bank!","Consistency beats everything.","You showed up  that's what counts.","Stronger every session."];function Wg({title:s,subtitle:e,stats:t,onDone:i,onDismissStart:l,onShareJourney:u,userName:d,buttonLabel:p="Done",holdLabel:g="Hold To Complete Session",shareType:y="workout",hideShare:b=!1}){const[E,T]=w.useState("hold"),[L,W]=w.useState(!1),[H,B]=w.useState(0),[K,G]=w.useState(!1),[Q,he]=w.useState(!1),[Ee,ge]=w.useState(null),C=D3(),j=w.useRef(null),R=w.useRef(null),V=w.useRef(null),O=w.useRef(null),D=w.useRef(!1),A=w.useRef(!1),Le=w.useRef(0),Je=w.useRef(Kw[Math.floor(Math.random()*Kw.length)]),X=w.useRef([...Array(80)].map((xe,Se)=>({x:5+Math.random()*90,delay:Math.random()*3.5,color:["#A12F3A","#ffffff","#000000"][Se%3],drift:(Math.random()-.5)*120,spin:Math.random()*720-360,duration:1.8+Math.random()*2,width:4+Math.random()*6,height:4+Math.random()*8,shape:Se%3}))),je=w.useCallback(()=>{if(D.current)return;D.current=!0,A.current=!1,Le.current=0,W(!0),B(0),O.current=performance.now(),C.tap(),j.current&&(j.current.style.strokeDashoffset=Al);const xe=Se=>{const Fe=Se-O.current,Ze=Math.min(Fe/L3,1);if(j.current&&(j.current.style.strokeDashoffset=Al-Ze*Al),R.current){const Oe=8*(1-Ze),Mt=1-Ze,cn=1+Ze*.15;R.current.style.filter=`blur(${Oe}px) grayscale(${Mt})`,R.current.style.transform=`scale(${cn})`}B(Ze),Fe-Le.current>=O3&&(Le.current=Fe,C.tick()),Ze<1?V.current=requestAnimationFrame(xe):(D.current=!1,A.current=!0,V.current=null,W(!1),B(1),C.complete(),T("celebrate"))};V.current=requestAnimationFrame(xe)},[C]),De=w.useCallback(()=>{D.current&&(D.current=!1,V.current&&(cancelAnimationFrame(V.current),V.current=null),j.current&&(j.current.style.strokeDashoffset=Al),R.current&&(R.current.style.filter="",R.current.style.transform=""),W(!1),B(0))},[]),Ce=w.useCallback(()=>{G(!0),l?.(),setTimeout(()=>{i?.()},300)},[i,l]),J=w.useCallback(()=>{const xe=[s||"Workout Complete!"];return e&&xe.push(e),t?.length&&xe.push(t.map(Se=>`${Se.value} ${Se.label}`).join(" | ")),xe.push("#MindCoreFitness"),xe.join(`
`)},[s,e,t]),P=w.useCallback(async()=>{if(!(Q||!u))try{await u({type:y==="habits"?"habits_summary":"workout_summary",title:s||"Workout Complete!",subtitle:e,stats:t||[],quote:Je.current}),he(!0),ge("Posted to Journey!"),setTimeout(()=>ge(null),2500)}catch(xe){console.error("Journey post failed:",xe),ge(xe?.message||"Failed to post"),setTimeout(()=>ge(null),3500)}},[Q,u,s,e,t]),[re,we]=w.useState(!1),_e=w.useCallback(async()=>{we(!0);try{const xe=await I3({type:y||"workout",title:s||"Workout Complete!",subtitle:e,stats:t||[],quote:Je.current,userName:d}),Se=J();if(navigator.share&&navigator.canShare?.({files:[new File([xe],"workout.png",{type:"image/png"})]})){const Fe=new File([xe],"workout.png",{type:"image/png"});await navigator.share({title:"Mind Core Fitness",text:Se,files:[Fe]})}else navigator.share?await navigator.share({title:"Mind Core Fitness",text:Se}):(await navigator.clipboard.writeText(Se),ge("Copied to clipboard!"),setTimeout(()=>ge(null),2500))}catch{try{await navigator.clipboard.writeText(J()),ge("Copied to clipboard!"),setTimeout(()=>ge(null),2500)}catch{}}finally{we(!1)}},[s,e,t,d,J]);return E==="hold"?a.jsxs("div",{className:"wc-hold-page",children:[a.jsx("div",{className:"wc-hold-glow","aria-hidden":"true"}),a.jsx("p",{className:"wc-hold-label",children:g}),a.jsxs("div",{className:`wc-hold-ring-touch ${L?"wc-holding":""}`,onPointerDown:xe=>{xe.preventDefault(),je()},onPointerUp:De,onPointerLeave:De,onPointerCancel:De,onClick:xe=>{xe.stopPropagation(),A.current&&(A.current=!1)},role:"button",tabIndex:0,"aria-label":"Press and hold to finish workout",onKeyDown:xe=>{(xe.key==="Enter"||xe.key===" ")&&(xe.preventDefault(),C.complete(),T("celebrate"))},children:[a.jsx("div",{className:"wc-hold-ring-glow","aria-hidden":"true"}),a.jsxs("svg",{className:"wc-hold-ring-svg",viewBox:"0 0 100 100",children:[a.jsx("circle",{className:"wc-hold-ring-track",cx:"50",cy:"50",r:$g}),a.jsx("circle",{className:"wc-hold-ring-fill",ref:j,cx:"50",cy:"50",r:$g,style:{strokeDasharray:Al,strokeDashoffset:Al}})]}),a.jsx("img",{ref:R,src:"/Logo.webp",alt:"Mind Core Fitness",className:"wc-hold-logo",draggable:!1})]})]}):a.jsxs("div",{className:`wc-celeb-overlay ${K?"wc-celeb-dismissing":""}`,children:[a.jsx("div",{className:"wc-celeb-confetti","aria-hidden":"true",children:X.current.map((xe,Se)=>a.jsx("span",{className:`wc-celeb-confetti-piece wc-confetti-shape-${xe.shape}`,style:{"--x":`${xe.x}%`,"--delay":`${xe.delay}s`,"--color":xe.color,"--drift":`${xe.drift}px`,"--spin":`${xe.spin}deg`,"--duration":`${xe.duration}s`,width:`${xe.width}px`,height:`${xe.height}px`}},Se))}),a.jsxs("div",{className:"wc-celeb-content",children:[a.jsx("div",{className:"wc-celeb-logo-frame",children:a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"wc-celeb-logo-img"})}),a.jsx("h2",{className:"wc-celeb-heading",children:s||"Congratulations!"}),e&&a.jsx("p",{className:"wc-celeb-subtext",children:e}),a.jsx("p",{className:"wc-celeb-quote",children:Je.current}),t&&t.length>0&&a.jsx("div",{className:"wc-celeb-stats-row",children:t.map((xe,Se)=>a.jsxs("div",{className:"wc-celeb-stat",children:[a.jsx("span",{className:"wc-celeb-stat-val",children:xe.value}),a.jsx("span",{className:"wc-celeb-stat-label",children:xe.label})]},Se))}),!b&&a.jsxs("div",{className:"wc-share-row",children:[u&&a.jsxs("button",{className:`wc-share-btn wc-share-journey ${Q?"wc-share-done":""}`,onClick:P,disabled:Q,children:[a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M12 20h9"}),a.jsx("path",{d:"M16.5 3.5a2.121 2.121 0 1 1 3 3L7 19l-4 1 1-4Z"})]}),Q?"Posted!":"Post to Journey"]}),a.jsxs("button",{className:"wc-share-btn wc-share-external",onClick:_e,disabled:re,children:[a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"18",cy:"5",r:"3"}),a.jsx("circle",{cx:"6",cy:"12",r:"3"}),a.jsx("circle",{cx:"18",cy:"19",r:"3"}),a.jsx("line",{x1:"8.59",y1:"13.51",x2:"15.42",y2:"17.49"}),a.jsx("line",{x1:"15.41",y1:"6.51",x2:"8.59",y2:"10.49"})]}),re?"Generating...":"Share"]})]}),a.jsx("button",{className:"wc-celeb-btn",onClick:Ce,children:p}),Ee&&a.jsx("div",{className:"wc-share-toast",children:Ee})]})]})}const Yw="/login/assets/randomiser-glq9YJkL.jpg",Qw="/login/assets/programme-card-workout-CnNzTYkz.webp",P3="/login/assets/prog-fullbody-4wk-r6m9HJys.jpg",V3="/login/assets/muscle-group-arms-C9AdZL4-.png",U3="/login/assets/arms-bicep-BUrmT1o-.png",B3="/login/assets/arms-tricep-D9tAnFnS.png",z3="/login/assets/arms-full-arms-BY3TvpJm.png",F3="/login/assets/muscle-group-chest-Cxfuc7XI.png",q3="/login/assets/chest-strength-BR4BAFTH.png",H3="/login/assets/chest-hypertrophy-B8yNrvjB.png",$3="/login/assets/chest-endurance-e-OSWtWO.png",W3="/login/assets/muscle-group-shoulders-DibNtCLF.png",G3="/login/assets/shoulders-strength-CKlZBF5A.png",K3="/login/assets/shoulders-hypertrophy-BUd76jiS.png",Y3="/login/assets/shoulders-endurance-HuqNG5rD.png",Q3="/login/assets/muscle-group-core-CPR-bdRg.png",X3="/login/assets/core-lower-abs-TVcqGMFJ.png",J3="/login/assets/core-obliques-rotation-Djb7Qlbk.png",Z3="/login/assets/core-weighted-core-4Kwh9mTv.png",e5="/login/assets/muscle-group-back-8JPV-YUo.png",t5="/login/assets/back-strength-BmSRxnwo.png",n5="/login/assets/back-hypertrophy-CXHmsnCz.png",s5="/login/assets/back-endurance-C8qJ8l5I.png",r5="/login/assets/muscle-group-legs-B8jcbdov.png",i5="/login/assets/legs-quads-DbnfsebI.png",a5="/login/assets/legs-hamstrings-glutes-BrfsvvzX.png",o5="/login/assets/legs-power-plyo-D2qBXeUR.png",l5=60,eg=5,c5={fullbody_4wk:{duration:4,daysPerWeek:3},fullbody_8wk:{duration:8,daysPerWeek:3},fullbody_12wk:{duration:12,daysPerWeek:3},core_4wk:{duration:4,daysPerWeek:3},core_8wk:{duration:8,daysPerWeek:3},core_12wk:{duration:12,daysPerWeek:3},upper_4wk:{duration:4,daysPerWeek:3},lower_4wk:{duration:4,daysPerWeek:3}},u5={fullbody:"linear-gradient(160deg, rgba(153,49,60,0.15) 0%, rgba(153,49,60,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)",core:"linear-gradient(160deg, rgba(30,80,120,0.2) 0%, rgba(30,80,120,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)",upper:"linear-gradient(160deg, rgba(100,60,140,0.2) 0%, rgba(100,60,140,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)",lower:"linear-gradient(160deg, rgba(40,120,80,0.2) 0%, rgba(40,120,80,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)"},tg={arms:"linear-gradient(160deg, rgba(180,60,60,0.2) 0%, rgba(180,60,60,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",chest:"linear-gradient(160deg, rgba(50,100,160,0.2) 0%, rgba(50,100,160,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",back:"linear-gradient(160deg, rgba(80,130,60,0.2) 0%, rgba(80,130,60,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",shoulders:"linear-gradient(160deg, rgba(160,100,40,0.2) 0%, rgba(160,100,40,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",legs:"linear-gradient(160deg, rgba(100,50,140,0.2) 0%, rgba(100,50,140,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",core:"linear-gradient(160deg, rgba(30,80,120,0.2) 0%, rgba(30,80,120,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)"},ng=[{id:"fullbody_4wk",name:"4-Week Full Body",focus:"fullbody",duration:4,level:"All Levels",daysPerWeek:3,image:P3},{id:"fullbody_8wk",name:"8-Week Full Body",focus:"fullbody",duration:8,level:"Intermediate",daysPerWeek:3},{id:"fullbody_12wk",name:"12-Week Full Body",focus:"fullbody",duration:12,level:"Advanced",daysPerWeek:3},{id:"core_4wk",name:"4-Week Core",focus:"core",duration:4,level:"Beginner",daysPerWeek:3},{id:"core_8wk",name:"8-Week Core",focus:"core",duration:8,level:"Intermediate",daysPerWeek:3},{id:"core_12wk",name:"12-Week Core",focus:"core",duration:12,level:"Advanced",daysPerWeek:3},{id:"upper_4wk",name:"4-Week Upper Body",focus:"upper",duration:4,level:"Intermediate",daysPerWeek:3},{id:"lower_4wk",name:"4-Week Lower Body",focus:"lower",duration:4,level:"Intermediate",daysPerWeek:3}],Jc=[{key:"arms",label:"Arms",icon:"M7 5h2v14H7V5zm8 0h2v14h-2V5zm-5 4h4v6h-4V9z",image:V3},{key:"chest",label:"Chest",icon:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 15H9v-2h2v2zm4 0h-2v-2h2v2zm3-6c0 1.1-.36 2.12-.97 2.95l-.87-.87C16.7 12.53 17 11.8 17 11c0-2.76-2.24-5-5-5S7 8.24 7 11c0 .8.3 1.53.84 2.08l-.87.87A4.977 4.977 0 0 1 6 11c0-3.31 2.69-6 6-6s6 2.69 6 6z",image:F3},{key:"back",label:"Back",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm4 18H8v-6l-4-4 1.41-1.41L8 11.17V8h8v3.17l2.59-2.58L20 10l-4 4v6z",image:e5},{key:"shoulders",label:"Shoulders",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm8 10l-3-1.5c-.5-.25-1-.5-1.5-.5h-7c-.5 0-1 .25-1.5.5L4 12l-2 6h4l1.5 4h9L18 18h4l-2-6z",image:W3},{key:"legs",label:"Legs",icon:"M16.5 3A2.5 2.5 0 0 0 14 5.5 2.5 2.5 0 0 0 16.5 8 2.5 2.5 0 0 0 19 5.5 2.5 2.5 0 0 0 16.5 3zM14 9l-3 7h2l1 6h2l1-6h2l-3-7h-2z",image:r5},{key:"core",label:"Core",icon:"M12 2a4 4 0 0 1 4 4v1h-2V6a2 2 0 1 0-4 0v1H8V6a4 4 0 0 1 4-4zM8 9h8v2H8V9zm-1 4h10l-1 9H8l-1-9z",image:Q3}],Xw={chest:[{id:"chest_strength",name:"Chest Strength",desc:"Heavy pressing for max strength",image:q3,level:"Intermediate",overview:"A heavy pressing session designed to build raw chest strength. Focus on controlled negatives and powerful pressing movements.",tips:["Go heavy  pick a weight where the last 2 reps are a real challenge","Control the negative (lowering phase) for 2-3 seconds","Keep your shoulder blades squeezed together throughout all pressing movements","Rest 90-120 seconds between sets to allow full recovery"],exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:4,reps:8,storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Dumbbell Squeeze Press",type:"weighted",sets:3,reps:10,storagePath:null},{name:"Incline Dumbbell Press",type:"weighted",sets:3,reps:10,storagePath:null},{name:"Dumbbell Pullover",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Dumbbell Fly",type:"weighted",sets:3,reps:12,storagePath:null}]},{id:"chest_hypertrophy",name:"Chest Hypertrophy",desc:"Volume training for muscle growth",image:H3,level:"Intermediate",overview:"A high-volume chest session focused on time under tension and muscle growth. Lighter weights, more reps, and slow controlled movements.",tips:["Use moderate weight  you should feel the burn by rep 10","Squeeze your chest at the top of every rep for 1 second","Keep rest periods short at 60-90 seconds to keep the pump going","On press ups, go to failure on the final set"],exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Wide Press Up",type:"reps",sets:3,reps:15,storagePath:null},{name:"Dumbbell Fly",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Incline Dumbbell Press",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Press Up",type:"reps",sets:3,reps:20,storagePath:"exercises/bodyweight/upper/press up.mp4"}]},{id:"chest_endurance",name:"Chest Endurance",desc:"Bodyweight pushing to failure",image:$3,level:"All Levels",overview:"No weights needed. This bodyweight-only session builds chest endurance and muscular stamina through high-rep push up variations.",tips:["Focus on full range of motion  chest to floor on every rep","Keep your core tight and body in a straight line throughout","Scale down to knee press ups if you can't maintain form","Push through the burn  the last 5 reps are where the growth happens"],exercises:[{name:"Press Up",type:"reps",sets:4,reps:20,storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Wide Press Up",type:"reps",sets:3,reps:15,storagePath:null},{name:"Diamond Press Up",type:"reps",sets:3,reps:12,storagePath:null},{name:"Decline Press Up",type:"reps",sets:3,reps:15,storagePath:null},{name:"Press Up Hold",type:"timed",sets:3,time:30,storagePath:null}]}],back:[{id:"back_strength",name:"Back Strength",desc:"Heavy rows for a thick back",image:t5,level:"Intermediate",overview:"Build a thick, powerful back with heavy rowing movements. This session targets your lats, rhomboids, and traps for overall back development.",tips:["Go heavy on rows  use a weight that challenges you by rep 6-8","Drive your elbows back and squeeze your shoulder blades together at the top","Keep a slight bend in your knees and hinge at the hips for bent over movements","Rest 90-120 seconds between sets for full recovery"],exercises:[{name:"Dumbbell Bent Over Row",type:"weighted",sets:4,reps:8,storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Single Arm Bent Over Row",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Dumbbell Pullover",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Dumbbell Shrug",type:"weighted",sets:3,reps:15,storagePath:null}]},{id:"back_hypertrophy",name:"Back Hypertrophy",desc:"Width and thickness volume work",image:n5,level:"Intermediate",overview:"A volume-focused back session combining rows and isolation moves to build width and thickness. Focus on the mind-muscle connection.",tips:["Use moderate weight  feel the stretch and squeeze on every rep","On renegade rows, keep your hips square to the floor and avoid rotating","For reverse flys, use lighter weight and focus on squeezing your rear delts","Keep rest to 60-90 seconds to maintain intensity"],exercises:[{name:"Renegade Row",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/upper/renegade row.mp4"},{name:"Wide Dumbbell Bent Over Row",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Single Arm Bent Over Row",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Reverse Fly",type:"weighted",sets:3,reps:15,storagePath:null},{name:"Prone Y-T-W Raises",type:"reps",sets:3,reps:10,storagePath:null}]},{id:"back_endurance",name:"Back Endurance",desc:"Bodyweight back conditioning",image:s5,level:"All Levels",overview:"A bodyweight session to strengthen your posterior chain and improve posture. Great for back health, mobility, and muscular endurance.",tips:["On superman holds, lift your arms and legs simultaneously and hold tight","Focus on slow, controlled movements  quality over speed","Breathe steadily throughout timed holds  don't hold your breath","Engage your glutes and lower back together on every movement"],exercises:[{name:"Superman Hold",type:"timed",sets:4,time:30,storagePath:"exercises/bodyweight/upper/Superman Hold.mp4"},{name:"Prone Y-T-W Raises",type:"reps",sets:3,reps:12,storagePath:null},{name:"Reverse Snow Angel",type:"reps",sets:3,reps:12,storagePath:null},{name:"Bird Dog",type:"reps",sets:3,reps:12,storagePath:"exercises/bodyweight/core/Bird Dog.mp4"},{name:"Back Extension Hold",type:"timed",sets:3,time:30,storagePath:null}]}],shoulders:[{id:"shoulders_strength",name:"Shoulder Strength",desc:"Heavy pressing for boulder shoulders",image:G3,level:"Intermediate",overview:"A heavy overhead pressing session to build strong, powerful shoulders. Compound movements first, followed by isolation work for all three delt heads.",tips:["Go heavy on presses  pick a weight where you struggle on the last 2 reps","Brace your core and avoid arching your back during overhead movements","Press straight up and control the weight down slowly","Rest 90-120 seconds between pressing sets, 60 seconds for isolation moves"],exercises:[{name:"Seated Dumbbell Shoulder Press",type:"weighted",sets:4,reps:8,storagePath:"exercises/dumbbells/upper/seated dumbbell shoulder press.mp4"},{name:"Seated Dumbbell Arnold Press",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/upper/seated dumbbell arnold press.mp4"},{name:"Dumbbell Front Raise",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell front raise.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Dumbbell Shrug",type:"weighted",sets:3,reps:15,storagePath:null}]},{id:"shoulders_hypertrophy",name:"Shoulder Hypertrophy",desc:"Volume and isolation for 3D delts",image:K3,level:"Intermediate",overview:"A high-volume session targeting all three heads of the deltoid for that 3D capped shoulder look. Moderate weight, high reps, constant tension.",tips:["Use lighter weight than you think  shoulders respond best to high reps","On lateral raises, lead with your elbows and don't swing the weight","Pause at the top of each raise for a 1-second squeeze","Keep rest periods at 60 seconds to maximise the pump"],exercises:[{name:"Seated Dumbbell Arnold Press",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/seated dumbbell arnold press.mp4"},{name:"Dumbbell Lateral Raise",type:"weighted",sets:4,reps:15,storagePath:"exercises/dumbbells/upper/dumbbell lateral raise.mp4"},{name:"Dumbbell Front Raise",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell front raise.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,reps:15,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Dumbbell Y-Raise",type:"weighted",sets:3,reps:12,storagePath:null}]},{id:"shoulders_endurance",name:"Shoulder Endurance",desc:"Bodyweight and high-rep work",image:Y3,level:"All Levels",overview:"A shoulder endurance session combining bodyweight movements with high-rep dumbbell work. Builds stamina, stability, and shoulder resilience.",tips:["On pike push ups, walk your feet close to your hands to increase the angle","For high-rep lateral raises, use a very light weight and focus on form","Wall walks are advanced  scale to pike push ups if needed","Keep your core braced throughout to protect your lower back"],exercises:[{name:"Pike Push Ups",type:"reps",sets:4,reps:12,storagePath:"exercises/bodyweight/upper/pike push ups.mp4"},{name:"Dumbbell Lateral Raise",type:"weighted",sets:3,reps:20,storagePath:"exercises/dumbbells/upper/dumbbell lateral raise.mp4"},{name:"Wall Walks",type:"reps",sets:3,reps:6,storagePath:null},{name:"Prone Y-T-W Raises",type:"reps",sets:3,reps:10,storagePath:null},{name:"Shoulder Tap Hold",type:"timed",sets:3,time:30,storagePath:null}]}],arms:[{id:"arms_bicep",name:"Bicep Focus",desc:"Curl variations for peak biceps",image:U3,level:"All Levels",overview:"An arm session dedicated entirely to biceps. Multiple curl variations target different parts of the bicep for maximum peak and thickness.",tips:["Keep your elbows pinned to your sides  no swinging","Control the negative (lowering) for 2-3 seconds on every rep","Start with your heaviest weight and decrease as you fatigue","Squeeze hard at the top of each curl for a full contraction"],exercises:[{name:"Bicep Curl",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Hammer Curl",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/hammer curl.mp4"},{name:"Concentration Curl",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Wide Grip Bicep Curl",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Isometric Bicep Hold",type:"timed",sets:3,time:20,storagePath:null}]},{id:"arms_tricep",name:"Tricep Focus",desc:"Extensions and dips for horseshoe triceps",image:B3,level:"All Levels",overview:"All-out tricep training with extensions, dips, and pressing movements. The triceps make up two-thirds of your arm  this session builds serious size.",tips:["On overhead extensions, keep your elbows close to your head","For skullcrushers, lower the weight slowly to just above your forehead","On dips, lean slightly forward to reduce shoulder strain","Full lockout at the top of every extension for maximum tricep contraction"],exercises:[{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Skullcrushers",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/skullcrushers.mp4"},{name:"Tricep Dips",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/upper/tricep dips.mp4"},{name:"Tricep Kickback",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Diamond Press Up",type:"reps",sets:3,reps:12,storagePath:null}]},{id:"arms_full",name:"Full Arms",desc:"Superset biceps and triceps",image:z3,level:"All Levels",overview:"A balanced arm session alternating between biceps and triceps. Superset style keeps the intensity high and maximises the pump.",tips:["Superset each pair  do biceps then immediately hit triceps","Use moderate weight that lets you maintain strict form for all reps","Rest 60 seconds after each superset pair","Focus on the squeeze at the peak contraction of every rep"],exercises:[{name:"Bicep Curl",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Tricep Kickback",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Hammer Curl",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/hammer curl.mp4"},{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Wrist Curl",type:"weighted",sets:3,reps:15,storagePath:null}]}],legs:[{id:"legs_quad",name:"Quad Dominant",desc:"Squats and lunges for quad power",image:i5,level:"All Levels",overview:"A quad-focused leg session built around squats and lunges. Heavy compound movements to build strong, powerful quads and overall leg strength.",tips:["On goblet squats, hold the dumbbell close to your chest and sit deep","Keep your knees tracking over your toes  don't let them cave inward","Drive through your heels on all squatting movements","Rest 90-120 seconds between heavy sets, 60 seconds on bodyweight moves"],exercises:[{name:"Dumbbell Goblet Squats",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Forward Dumbbell Lunges",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.mp4"},{name:"Dumbbell Squat Pulses",type:"weighted",sets:3,reps:15,storagePath:"exercises/dumbbells/lower/dumbbell squat pulses.mp4"},{name:"Bulgarian Split Squats",type:"reps",sets:3,reps:12,storagePath:"exercises/bodyweight/lower/bulgarian split squats.mp4"},{name:"Squat And Hold",type:"timed",sets:3,time:30,storagePath:"exercises/bodyweight/lower/squat and hold.mp4"}]},{id:"legs_ham_glute",name:"Hamstring & Glute",desc:"Posterior chain focus",image:a5,level:"Intermediate",overview:"Target the back of your legs with deadlift and hip hinge variations. This session builds a strong posterior chain  hamstrings, glutes, and lower back.",tips:["On RDLs, push your hips back and feel the stretch in your hamstrings","Keep a slight bend in your knees throughout hip hinge movements","Squeeze your glutes hard at the top of every rep","For single leg work, start with your weaker side first"],exercises:[{name:"Romanian Deadlifts",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/lower/romanian deadlifts.mp4"},{name:"1 Legged RDL",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/lower/1 legged rdl.mp4"},{name:"Hip Thrusts",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/lower/hip thrusts.mp4"},{name:"Dumbbell Sumo Squats",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/dumbbell sumo squats.mp4"},{name:"Donkey Kicks",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/lower/donkey kicks.mp4"}]},{id:"legs_power",name:"Power & Plyo",desc:"Explosive leg training",image:o5,level:"Intermediate",overview:"An explosive leg session combining plyometrics with weighted movements. Build power, speed, and athletic performance.",tips:["On jump squats, land softly with bent knees to absorb the impact","Explode up on every rep  power comes from speed, not just weight","Keep rest periods at 60-90 seconds to maintain intensity","Focus on landing mechanics  knees out, chest up, soft landing"],exercises:[{name:"Jump Squats",type:"reps",sets:4,reps:12,storagePath:"exercises/bodyweight/lower/jump squats.mp4"},{name:"Dumbbell Box Step Ups",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/dumbbell box step ups.mp4"},{name:"Skater Jumps",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/lower/skater jumps.mp4"},{name:"Dumbbell Reverse Lunges",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/dumbbell reverse lunges.mp4"},{name:"Weighted Calf Raises",type:"weighted",sets:4,reps:15,storagePath:"exercises/dumbbells/lower/weighted calf raises.mp4"}]}],core:[{id:"core_lower_abs",name:"Lower Abs Blast",desc:"40s work / 20s rest  3 rounds",image:X3,level:"Intermediate",overview:"An interval-based core burner targeting the lower abdominals. 40 seconds of work followed by 20 seconds of rest  keep the intensity high and your lower back pressed into the floor throughout.",tips:["Press your lower back firmly into the floor on every rep","Exhale hard as you contract your abs  don't hold your breath","If your lower back lifts off the ground, reduce the range of motion","Focus on slow, controlled movements rather than speed"],interval:!0,rounds:3,work:40,rest:20,exercises:[{name:"Leg Raises",storagePath:"exercises/bodyweight/core/Leg Raises.mp4"},{name:"Reverse Crunch To Leg Raise",storagePath:"exercises/bodyweight/core/Reverse Crunch To Leg Raise.mp4"},{name:"Flutter Kicks",storagePath:"exercises/bodyweight/core/Flutter Kicks.mp4"},{name:"Dead Bug Single Leg Drop",storagePath:"exercises/bodyweight/core/Dead Bug Single Leg Drop.mp4"},{name:"Hollow Body Hold",storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"},{name:"Hollow Hold Flutter Kicks",storagePath:"exercises/bodyweight/core/Hollow Hold Flutter Kicks.mp4"}]},{id:"core_obliques",name:"Obliques & Rotation",desc:"35s work / 25s rest  3 rounds",image:J3,level:"Intermediate",overview:"Target the obliques and rotational core muscles with this interval session. 35 seconds of work with 25 seconds rest  every exercise involves twisting, rotating, or side-bracing movements.",tips:["Rotate from your ribcage, not just your arms","Keep your hips as still as possible during twisting exercises","Brace your core before each movement  think about squeezing a belt","On side planks, stack your hips and push the floor away"],interval:!0,rounds:3,work:35,rest:25,exercises:[{name:"Russian Twist",storagePath:"exercises/bodyweight/core/Russian Twist.mp4"},{name:"Side Plank Rotation",storagePath:"exercises/bodyweight/core/Side Plank Rotation.mp4"},{name:"Cross Body Mountain Climbers",storagePath:"exercises/bodyweight/core/Cross Body Mountain Climbers.mp4"},{name:"Hip Dips Plank",storagePath:"exercises/bodyweight/core/Hip Dips Plank.mp4"},{name:"Bicycle Crunch",storagePath:"exercises/bodyweight/core/Bicycle Crunch.mp4"},{name:"Side Plank",storagePath:"exercises/bodyweight/core/Side Plank.mp4"}]},{id:"core_weighted",name:"Weighted Core",desc:"40s work / 20s rest  3 rounds",image:Z3,level:"Advanced",overview:"Add resistance to your core training with dumbbells and kettlebells. 40 seconds of weighted work followed by 20 seconds rest  this session builds serious core strength and stability.",tips:["Start with a moderate weight  form is more important than load","Brace your entire core before picking up the weight each round","Keep movements controlled  no swinging or using momentum","If grip fails before core does, go slightly lighter next time"],interval:!0,rounds:3,work:40,rest:20,exercises:[{name:"Russian Twists Dumbbell",storagePath:"exercises/dumbbells/core/russian twists dumbbell.mp4"},{name:"Kettlebell Russian Twist",storagePath:"exercises/kettlebells/core/kettlebell russian twist.mp4"},{name:"Kettlebell Side Bends",storagePath:"exercises/kettlebells/core/kettlebell side bends.mp4"},{name:"Kneeling Kettlebell Halo",storagePath:"exercises/kettlebells/core/kneeling kettlebell halo.mp4"},{name:"Kettlebell Bird Dog Drag",storagePath:"exercises/kettlebells/core/kettlebell bird dog drag.mp4"},{name:"Dumbbell Plank Pull Through",storagePath:null}]}]},sg=[{key:"bodyweight",label:"Bodyweight",icon:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 3c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm0 14.2c-2.5 0-4.71-1.28-6-3.22.03-1.99 4-3.08 6-3.08 1.99 0 5.97 1.09 6 3.08-1.29 1.94-3.5 3.22-6 3.22z"},{key:"dumbbells",label:"Dumbbells",icon:"M1 9h2v6H1V9zm3-2h2v10H4V7zm3 4h10v2H7v-2zm10-4h2v10h-2V7zm3 2h2v6h-2V9z"},{key:"kettlebells",label:"Kettlebells",icon:"M12 2C9.24 2 7 4.24 7 7c0 1.1.36 2.12.97 2.95C6.76 11.08 6 12.96 6 15c0 3.87 2.69 7 6 7s6-3.13 6-7c0-2.04-.76-3.92-1.97-5.05.61-.83.97-1.85.97-2.95 0-2.76-2.24-5-5-5zm0 2c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3z"}],$r=[{key:"core",label:"Core",icon:"M12 2a4 4 0 0 1 4 4v1h-2V6a2 2 0 1 0-4 0v1H8V6a4 4 0 0 1 4-4zM8 9h8v2H8V9zm-1 4h10l-1 9H8l-1-9z"},{key:"upper",label:"Upper",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm8 10l-3-1.5c-.5-.25-1-.5-1.5-.5h-7c-.5 0-1 .25-1.5.5L4 12l-2 6h4l1.5 4h9L18 18h4l-2-6z"},{key:"lower",label:"Lower",icon:"M16.5 3A2.5 2.5 0 0 0 14 5.5 2.5 2.5 0 0 0 16.5 8 2.5 2.5 0 0 0 19 5.5 2.5 2.5 0 0 0 16.5 3zM14 9l-3 7h2l1 6h2l1-6h2l-3-7h-2z"},{key:"fullbody",label:"Full Body",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm-2 8h4l1 4h2l-1 4h-2l-1 4h-2l-1-4H8l-1-4h2l1-4z"},{key:"mix",label:"Mix It Up",icon:"M10.59 9.17L5.41 4 4 5.41l5.17 5.17 1.42-1.41zM14.5 4l2.04 2.04L4 18.59 5.41 20 17.96 7.46 20 9.5V4h-5.5zm-.83 9.41l-1.42 1.42L17.96 20.54l1.42-1.42-5.71-5.71z"}],_i=[{key:"beginner",label:"Beginner",work:30,rest:30,desc:"30s work / 30s rest"},{key:"intermediate",label:"Intermediate",work:40,rest:20,desc:"40s work / 20s rest"},{key:"advanced",label:"Advanced",work:40,rest:15,desc:"40s work / 15s rest"}],rg=[5,10,15,20,30],mh={core:"#e85d04",upper:"#2196f3",lower:"#4caf50",fullbody:"#9c27b0",mix:"#ff9800"},Jw=["Mix up your focus areas to build balanced strength.","Consistency beats intensity  show up and press play.","Try a new difficulty level to keep your body guessing.","Short on time? A 5-minute blast still counts.","Save your favourite combos so you can replay them anytime.","Your body adapts  switch equipment for fresh stimulus.","Rest days are growth days. Listen to your body.","Challenge yourself: go one level higher this week."];function d5(s){return s.replace(/\b\w/g,e=>e.toUpperCase())}function h5(s){const e=[...s];for(let t=e.length-1;t>0;t--){const i=Math.floor(Math.random()*(t+1));[e[t],e[i]]=[e[i],e[t]]}return e}function f5(){const{currentUser:s,isClient:e,clientData:t,loading:i}=Ar(),{isDark:l,toggleTheme:u,accent:d}=Mi(),{isPremium:p,FREE_RANDOMISER_DURATIONS:g,FREE_RANDOMISER_WEEKLY_LIMIT:y}=ic(),b=Ys(),[E,T]=w.useState("randomiser_hub"),[L,W]=w.useState(["bodyweight"]),[H,B]=w.useState("core"),[K,G]=w.useState("intermediate"),[Q,he]=w.useState(p?15:5),[Ee,ge]=w.useState([]),[C,j]=w.useState(!1),R=w.useRef(!1),V=w.useRef([]),[O,D]=w.useState([]),[A,Le]=w.useState(2),[Je,X]=w.useState(_i[1]),[je,De]=w.useState(1),[Ce,J]=w.useState(0),[P,re]=w.useState("work"),[we,_e]=w.useState(0),[xe,Se]=w.useState(!1),[Fe,Ze]=w.useState(0),[Oe,Mt]=w.useState(!1),[cn,qn]=w.useState(!1),[Qt,rt]=w.useState(null),st=w.useRef(null);w.useRef(null),w.useRef(null);const[ct,En]=w.useState(null),fe=w.useCallback((F,oe="info")=>{En({message:F,type:oe}),setTimeout(()=>En(null),3e3)},[]),Ct=w.useCallback(async F=>{if(!t)throw new Error("Not signed in");const oe=F&&typeof F=="object"&&F.type;await mr(ht(ye,"posts"),{authorId:t.id,authorName:t.name||"Unknown",authorPhotoURL:t.photoURL||null,content:oe?"":F,type:oe?F.type:"text",imageURL:null,createdAt:Rs(),likeCount:0,commentCount:0,...oe?{metadata:{title:F.title||"",subtitle:F.subtitle||"",stats:F.stats||[],quote:F.quote||"",badges:F.badges||[]}}:{}})},[t]),[ft,Rt]=w.useState(null),[Qe,Tt]=w.useState(null),[pt,Xt]=w.useState(0),[zs,es]=w.useState(0),[Wt,se]=w.useState([]),[Ae,gt]=w.useState(""),[vt,ut]=w.useState(""),[He,nt]=w.useState(!1),[$e,rn]=w.useState(0),[Jt,Rn]=w.useState(!1),[On,Kn]=w.useState({}),Zt=w.useRef(null),Hn=w.useRef(null),[Cn,yn]=w.useState(0),[Ss,le]=w.useState(0),[Me,Ye]=w.useState(0),[yt,it]=w.useState(0),[Gt,vn]=w.useState(0),[an,Kt]=w.useState(0),[vs,Nn]=w.useState({beginner:0,intermediate:0,advanced:0}),bs=p?rg:rg.filter(F=>g.includes(F)),en=!p&&Cn>=y,[un,cs]=w.useState([]),[Qr,fa]=w.useState(!1),[Xr,gr]=w.useState({}),[$n,Fs]=w.useState(!1),[ws,Pn]=w.useState(!1),[In,ts]=w.useState(""),[Ft,yr]=w.useState(null),[Rr,xs]=w.useState([]),[Tn,Qs]=w.useState({total:0,favouriteFocus:null,streak:0}),[Jr,I]=w.useState(null),[z,ie]=w.useState(""),[ce,Pe]=w.useState(!1);w.useEffect(()=>{!i&&(!s||!e)&&b("/")},[s,e,i,b]),w.useEffect(()=>{if(!s||!t)return;(async()=>{try{const oe=ht(ye,"workoutLogs"),k=Yt(oe,xt("clientId","==",t.id)),q=(await Ht(k)).docs.map(dt=>dt.data()),te=q.filter(dt=>dt.type!=="programme");it(te.length);const me=te.reduce((dt,It)=>dt+(It.duration||0),0);vn(me);const Ie={beginner:0,intermediate:0,advanced:0};te.forEach(dt=>{dt.level&&Ie[dt.level]!==void 0&&Ie[dt.level]++}),Nn(Ie);const Ne=new Date,Be=Ne.getDay(),Re=Be===0?-6:1-Be,at=new Date(Ne);at.setDate(Ne.getDate()+Re),at.setHours(0,0,0,0);const bn=at.getTime(),et=q.filter(dt=>{const It=dt.completedAt;return It?(It.toDate?It.toDate().getTime():new Date(It).getTime())>=bn:!1});yn(et.filter(dt=>dt.type!=="programme").length);let tn=0;if(t)try{const dt=await Es(We(ye,"clientProgrammes",t.id));if(dt.exists()){const It=dt.data(),dn=It.templateId;tn=et.filter(mn=>mn.type==="programme"&&mn.programmeId===dn).length,I(dn);const _s=ng.find(mn=>mn.id===dn);_s&&ie(_s.name);const Un=c5[dn];if(Un){const mn=Object.keys(It.completedSessions||{}).length,Wn=Un.duration*Un.daysPerWeek;Ye(Wn>0?Math.round(mn/Wn*100):0)}}else I(null),ie(""),Ye(0)}catch{}le(tn);const jn=te.map(dt=>dt.completedAt).filter(Boolean).map(dt=>dt.toDate?dt.toDate().getTime():new Date(dt).getTime()).sort((dt,It)=>It-dt);if(jn.length===0)Kt(0);else{const dt=new Set;jn.forEach(Wn=>{const us=new Date(Wn),ei=us.getDay(),Dr=ei===0?-6:1-ei,pi=new Date(us);pi.setDate(us.getDate()+Dr),pi.setHours(0,0,0,0),dt.add(pi.getTime())});const It=[...dt].sort((Wn,us)=>us-Wn);let dn=0;const _s=new Date(Ne),Un=Ne.getDay()===0?-6:1-Ne.getDay();_s.setDate(Ne.getDate()+Un),_s.setHours(0,0,0,0);let mn=_s.getTime();It.includes(mn)||(mn-=10080*60*1e3);for(let Wn=0;Wn<200&&It.includes(mn);Wn++)dn++,mn-=10080*60*1e3;Kt(dn)}}catch(oe){console.error("Error loading workout stats:",oe)}finally{Pe(!0)}})()},[s,t,E]),w.useEffect(()=>{if(!s||!t)return;(async()=>{try{const oe=Yt(ht(ye,"savedWorkouts"),xt("clientId","==",t.id)),M=(await Ht(oe)).docs.map(q=>({id:q.id,...q.data()}));M.sort((q,te)=>{const me=q.savedAt?.toMillis?.()||q.savedAt?.seconds*1e3||0;return(te.savedAt?.toMillis?.()||te.savedAt?.seconds*1e3||0)-me}),cs(M)}catch(oe){console.error("Error loading saved workouts:",oe)}finally{fa(!0)}})()},[s,t]),w.useEffect(()=>{if(!s||!t)return;(async()=>{try{const oe=Yt(ht(ye,"workoutLogs"),xt("clientId","==",t.id),ku("completedAt","desc"),Eu(20)),q=(await Ht(oe)).docs.map(et=>et.data()).filter(et=>et.type!=="programme"&&et.type!=="muscle_group");xs(q.slice(0,3));const te=q.length,me={};q.forEach(et=>{et.focus&&(me[et.focus]=(me[et.focus]||0)+1)});const Ie=Object.keys(me).sort((et,tn)=>me[tn]-me[et])[0]||null;let Ne=0;if(q.length>0){const et=new Set;q.forEach(dt=>{const It=dt.completedAt?.toDate?dt.completedAt.toDate():dt.completedAt?new Date(dt.completedAt):null;It&&et.add(new Date(It.getFullYear(),It.getMonth(),It.getDate()).toDateString())});const tn=new Date;tn.setHours(0,0,0,0);let jn=new Date(tn);for(et.has(jn.toDateString())||jn.setDate(jn.getDate()-1);et.has(jn.toDateString());)Ne++,jn.setDate(jn.getDate()-1)}Qs({total:te,favouriteFocus:Ie,streak:Ne});const Be={core:null,upper:null,lower:null,fullbody:null};q.forEach(et=>{if(et.focus&&Be[et.focus]===null&&et.completedAt){const tn=et.completedAt.toDate?et.completedAt.toDate():new Date(et.completedAt);Be[et.focus]=tn}});let Re=null,at=new Date;const bn=["core","upper","lower","fullbody"];for(const et of bn){if(Be[et]===null){const tn=$r.find(jn=>jn.key===et)?.label||et;Re={focus:et,label:tn,daysAgo:null,message:`You haven't tried ${tn} yet`};break}if(Be[et]<at){at=Be[et];const tn=Math.floor((Date.now()-Be[et].getTime())/864e5);if(tn>=5){const jn=$r.find(dt=>dt.key===et)?.label||et;Re={focus:et,label:jn,daysAgo:tn,message:`${jn}  ${tn} days ago`}}}}yr(Re)}catch(oe){console.error("Error loading recent workouts:",oe)}})()},[s,t,E]);const Ue=async F=>{if(!(!s||!t||O.length===0)){Fs(!0);try{const oe=$r.find(q=>q.key===H)?.label||H,k=F||`${oe} ${Q}min`,M=await mr(ht(ye,"savedWorkouts"),{clientId:t.id,name:k,equipment:L,focus:H,level:K,duration:Q,exercises:O.map(q=>({name:q.name,videoUrl:q.videoUrl,isGif:q.isGif||!1})),rounds:A,savedAt:At.now()});cs(q=>[{id:M.id,clientId:t.id,name:k,equipment:L,focus:H,level:K,duration:Q,exercises:O.map(te=>({name:te.name,videoUrl:te.videoUrl,isGif:te.isGif||!1})),rounds:A,savedAt:At.now()},...q]),fe("Workout saved!","success")}catch(oe){console.error("Error saving workout:",oe),fe("Failed to save workout","error")}finally{Fs(!1),Pn(!1),ts("")}}},qe=async F=>{try{await Sr(We(ye,"savedWorkouts",F)),cs(oe=>oe.filter(k=>k.id!==F)),fe("Workout removed","info")}catch(oe){console.error("Error deleting saved workout:",oe),fe("Failed to remove workout","error")}},Ot=F=>{W(F.equipment||["bodyweight"]),B(F.focus||"core"),G(F.level||"intermediate"),he(F.duration||15);const oe=_i.find(k=>k.key===(F.level||"intermediate"));X(oe),D(F.exercises||[]),Le(F.rounds||2),T("preview")},Ge=async()=>{const F=JSON.parse(localStorage.getItem("mcf_last_randomiser")||"null");W(F?.equipment||["bodyweight"]),B(F?.focus||"core"),G(F?.level||"intermediate"),he(F?.duration||15),setTimeout(()=>Vn(),50)},Mn=()=>{localStorage.setItem("mcf_last_randomiser",JSON.stringify({equipment:L,focus:H,level:K,duration:Q}))};localStorage.getItem("mcf_last_randomiser");const ns=()=>{const F=[];let oe;H==="mix"?oe=["core","upper","lower"]:H==="fullbody"?oe=["upper","lower"]:oe=[H];for(const k of L)for(const M of oe)F.push(`exercises/${k}/${M}`);return F},ar=async()=>{if(R.current){for(;R.current;)await new Promise(F=>setTimeout(F,200));return V.current}R.current=!0,j(!0);try{const F=ns(),oe=[];for(const te of F)try{const me=Ga(Ka,te),Ie=await qw(me);oe.push(...Ie.items)}catch{console.warn(`Folder ${te} not found, skipping.`)}if(oe.length===0&&L.includes("bodyweight")&&H==="core")try{const te=Ga(Ka,"core"),me=await qw(te);oe.push(...me.items)}catch{console.warn("Legacy core/ folder not found either.")}if(oe.length===0){const te=L.map(Ie=>sg.find(Ne=>Ne.key===Ie)?.label).join(" + "),me=$r.find(Ie=>Ie.key===H)?.label;return fe(`No exercises found for ${te} / ${me}. Upload videos to Firebase Storage.`,"error"),R.current=!1,j(!1),[]}const k=new Set,M=oe.filter(te=>{const me=te.name.replace(/\.(mp4|gif)$/i,"");return k.has(me)?!1:(k.add(me),!0)}),q=await Promise.all(M.map(async te=>{const me=await Oo(te),Ie=d5(te.name.replace(/\.(mp4|gif)$/i,"")),Ne=/\.gif$/i.test(te.name);return{name:Ie,videoUrl:me,isGif:Ne}}));return V.current=q,ge(q),R.current=!1,j(!1),q}catch(F){console.error("Error loading exercises:",F);const oe=F.code==="storage/unauthorized"?"Storage access denied. Check Firebase Storage rules allow read access.":`Failed to load exercises: ${F.message||F.code||"Unknown error"}`;return fe(oe,"error"),R.current=!1,j(!1),[]}},Vn=async()=>{if(en)return;Mn(),T("spinning"),V.current=[];const F=await ar();if(F.length===0){T("setup");return}const oe=_i.find(Be=>Be.key===K);X(oe);const k=oe.work+oe.rest,M=Q*60,q=Math.floor(M/k);let te,me;q<=6?(te=Math.max(3,Math.floor(q/2)),me=Math.floor(q/te)):q<=12?(te=Math.min(6,Math.floor(q/2)),me=Math.floor(q/te)):(te=Math.min(10,Math.floor(q/2)),me=Math.floor(q/te)),me=Math.max(2,me);const Ie=h5(F),Ne=Ie.slice(0,Math.min(te,Ie.length));D(Ne),Le(me),setTimeout(()=>T("preview"),2e3)},Xs=()=>{T("countdown"),Ze(3)};w.useEffect(()=>{if(E!=="countdown")return;if(Fe<=0){T("workout"),De(1),J(0),re("work"),_e(Je.work),Se(!1),fi();return}Ms();const F=setTimeout(()=>Ze(oe=>oe-1),1e3);return()=>clearTimeout(F)},[Fe,E]),w.useEffect(()=>{if(E!=="workout"||xe)return;if(we<=0){Di();return}we<=3&&Ms();const F=setTimeout(()=>_e(oe=>oe-1),1e3);return()=>clearTimeout(F)},[we,E,xe]);const Di=()=>{if(P==="work")re("rest"),_e(Je.rest);else{const F=Ce+1;if(F>=O.length){const oe=je+1;if(oe>A){Mt(!0),Is();return}De(oe),J(0)}else J(F);re("work"),_e(Je.work),fi()}},Is=async()=>{if(s)try{await mr(ht(ye,"workoutLogs"),{clientId:t.id,level:K,duration:Q,equipment:L,focus:H,exerciseCount:O.length,rounds:A,exercises:O.map(q=>q.name),completedAt:At.now()}),typeof fbq=="function"&&fbq("trackCustom","WorkoutCompleted",{duration:Q,level:K,focus_area:H,exercise_count:O.length}),yn(q=>q+1);const F=yt+1;it(F),vn(q=>q+Q),Nn(q=>({...q,[K]:(q[K]||0)+1}));const oe=[{count:1,id:"first_workout"},{count:10,id:"workouts_10"},{count:25,id:"workouts_25"},{count:50,id:"workouts_50"},{count:100,id:"workouts_100"}];for(const q of oe)F>=q.count&&Zh(q.id,t);const k=an+(Cn===0?1:0),M=[{weeks:2,id:"streak_2"},{weeks:4,id:"streak_4"},{weeks:8,id:"streak_8"}];for(const q of M)k>=q.weeks&&Zh(q.id,t)}catch(F){console.error("Error saving workout log:",F)}},Js=async(F,oe,k)=>{if(!(!t||!oe))try{const M=t.id,q=await Es(We(ye,"coreBuddyPBs",M)),me=(q.exists()?q.data():null)?.exercises||{},Ie=me[F];let Ne=!1;if(Ie?(oe>(Ie.weight||0)||oe===(Ie.weight||0)&&k>(Ie.reps||0))&&(Ne=!0):Ne=!0,Ne){const Be={...me,[F]:{weight:oe,reps:k,achievedAt:At.now()}};await Ts(We(ye,"coreBuddyPBs",M),{clientId:t.id,exercises:Be,updatedAt:At.now()}),fe(`New PB! ${oe}kg  ${k} reps`,"success"),Ms()}}catch(M){console.error("Error checking PB:",M)}},ma=async F=>{if(Tt(F),F.interval){const M=[];for(const q of F.exercises){let te=null,me=!1;if(q.storagePath)try{const Ie=Ga(Ka,q.storagePath);te=await Oo(Ie),me=/\.gif$/i.test(q.storagePath)}catch{}M.push({name:q.name,videoUrl:te,isGif:me})}D(M),Le(F.rounds),X({work:F.work,rest:F.rest}),T("preview");return}const oe={};for(const M of F.exercises)if(M.storagePath)try{const q=Ga(Ka,M.storagePath);oe[M.name]={url:await Oo(q),isGif:/\.gif$/i.test(M.storagePath)}}catch{}Kn(oe);const k=F.exercises.map(M=>({name:M.name,type:M.type,targetSets:M.sets,targetReps:M.reps||0,targetTime:M.time||0,sets:[]}));se(k),Xt(0),es(0),gt(""),ut(""),Rn(!1),nt(!1),rn(0),setMgSessionBadges([]),setMgBadgeCelebration(null),T("muscle_workout")},vr=()=>{const F=Zt.current;F&&(F.paused?(F.play(),Rn(!0)):(F.pause(),Rn(!1)))};w.useEffect(()=>{if(E!=="muscle_workout"||!He||$e<=0){E==="muscle_workout"&&He&&$e<=0&&(nt(!1),Ms());return}return Hn.current=setTimeout(()=>rn(F=>F-1),1e3),()=>clearTimeout(Hn.current)},[E,He,$e]);const Cs=async()=>{const F=Wt[pt];let oe={};if(F.type==="weighted"){const q=parseFloat(Ae)||0,te=parseInt(vt)||0;if(te===0){fe("Enter your reps","error");return}oe={weight:q,reps:te}}else if(F.type==="reps"){const q=parseInt(vt)||0;if(q===0){fe("Enter your reps","error");return}oe={reps:q}}else if(F.type==="timed"){const q=F.targetTime-$e;oe={time:Math.max(q,1)}}const k=[...Wt];k[pt]={...F,sets:[...F.sets,oe]},se(k),F.type==="weighted"&&oe.weight>0&&await Js(F.name,oe.weight,oe.reps);const M=F.sets.length+1;if(M<F.targetSets)es(M),ut(""),nt(!1),rn(0);else if(pt+1<Wt.length){const q=pt+1;Xt(q),es(0),gt(""),ut(""),Rn(!1),nt(!1),rn(0)}else await pa(k),qn(!0)},pa=async F=>{if(!(!s||!t))try{const oe=F.reduce((k,M)=>k+M.sets.length,0);await mr(ht(ye,"workoutLogs"),{clientId:t.id,type:"muscle_group",muscleGroup:ft,sessionId:Qe?.id,sessionName:Qe?.name,exerciseCount:F.length,totalSets:oe,duration:Math.round(oe*1.5),exercises:F.map(k=>({name:k.name,type:k.type,sets:k.sets})),completedAt:At.now()})}catch(oe){console.error("Error saving muscle group workout log:",oe)}},Zr=w.useRef(null),Ir=()=>(Zr.current||(Zr.current=new(window.AudioContext||window.webkitAudioContext)),Zr.current),Ms=()=>{try{const F=Ir(),oe=F.createOscillator(),k=F.createGain();oe.connect(k),k.connect(F.destination),oe.frequency.value=880,k.gain.value=.3,oe.start(F.currentTime),oe.stop(F.currentTime+.15)}catch{}},fi=()=>{try{const F=Ir(),oe=F.createOscillator(),k=F.createGain();oe.connect(k),k.connect(F.destination),oe.frequency.value=1200,k.gain.value=.4,oe.start(F.currentTime),oe.stop(F.currentTime+.3)}catch{}};w.useEffect(()=>{if(E!=="workout"||P!=="work"||!O[Ce]?.isGif)return;const oe=setInterval(()=>{const k=st.current;if(!k)return;const M=k.getAttribute("src");k.removeAttribute("src"),setTimeout(()=>{st.current&&st.current.setAttribute("src",M)},0)},4e3);return()=>clearInterval(oe)},[E,P,Ce,je,O]);const Mr=(F,oe,k)=>{const M=Math.round(F/oe*l5);return a.jsx("svg",{className:"wk-ring-svg",viewBox:"0 0 200 200",children:o3.map((q,te)=>a.jsx("line",{x1:q.x1,y1:q.y1,x2:q.x2,y2:q.y2,className:te<M?`wk-tick-filled ${k}`:"wk-tick-empty",strokeWidth:q.thick?"3":"2"},te))})},mi=()=>{const F=O.length*A;return((je-1)*O.length+Ce+(P==="rest"?.5:0))/F},ss=ct&&a.jsx("div",{className:`toast-notification ${ct.type}`,children:ct.message});if(i)return a.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":d,children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>b("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})]})}),a.jsx("div",{className:"wk-loading-inline",children:a.jsx("div",{className:"wk-loading-spinner"})})]});if(E==="menu")return a.jsx(Jo,{children:a.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":d,children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>b("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"wk-main",children:[a.jsxs("div",{className:"wk-menu-heading",children:[a.jsx("h2",{children:"Choose Your Workout"}),a.jsx("p",{children:"No excuses. Just results."})]}),a.jsx("button",{className:"wk-hero-card",onClick:()=>T("randomiser_hub"),children:a.jsx("img",{src:Yw,alt:"Randomise Workout",className:"wk-hero-bg"})}),!p&&a.jsxs("button",{className:"wk-hero-card wk-free-card-premium",onClick:()=>b("/upgrade"),children:[a.jsx("img",{src:Qw,alt:"Programmes",className:"wk-hero-bg"}),a.jsx("div",{className:"wk-free-card-overlay"}),a.jsxs("div",{className:"wk-free-card-content",children:[a.jsxs("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),a.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}),a.jsx("span",{className:"wk-free-card-label",children:"Unlock Full Access"})]})]}),p&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"wk-section-header",children:[a.jsx("h2",{children:"Programmes"}),a.jsxs("span",{className:"wk-section-count",children:[ng.length," available"]})]}),a.jsx("div",{className:"wk-prog-scroll-wrap",children:a.jsx("div",{className:"wk-prog-scroll",children:ng.map((F,oe)=>F.image?a.jsxs("button",{className:"wk-prog-img-card",onClick:()=>b("/client/core-buddy/programmes",{state:{templateId:F.id}}),style:{animationDelay:`${oe*.06}s`},children:[a.jsx("img",{src:F.image,alt:F.name,className:"wk-prog-img"}),oe===0&&a.jsx("div",{className:"wk-swipe-arrow",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})})]},F.id):a.jsxs("button",{className:"wk-prog-hero-card",onClick:()=>b("/client/core-buddy/programmes",{state:{templateId:F.id}}),style:{animationDelay:`${oe*.06}s`},children:[a.jsx("img",{src:Qw,alt:"Programme",className:"wk-prog-hero-bg",loading:"lazy"}),a.jsx("div",{className:"wk-prog-hero-overlay",style:{background:u5[F.focus]}}),a.jsxs("div",{className:"wk-prog-hero-content",children:[a.jsxs("div",{className:"wk-prog-hero-top",children:[a.jsxs("span",{className:"wk-prog-hero-badge",children:[F.duration," WEEKS"]}),a.jsx("span",{className:"wk-prog-hero-level",children:F.level})]}),a.jsxs("div",{className:"wk-prog-hero-bottom",children:[a.jsx("h3",{children:F.name.toUpperCase()}),a.jsxs("p",{children:[F.daysPerWeek,"x per week  ",F.focus==="fullbody"?"Full Body":F.focus.charAt(0).toUpperCase()+F.focus.slice(1)," Focus"]}),a.jsx("span",{className:"wk-prog-hero-go",children:"VIEW PROGRAMME "})]})]}),oe===0&&a.jsx("div",{className:"wk-swipe-arrow",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})})]},F.id))})})]}),p&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"wk-section-header",children:[a.jsx("h2",{children:"Muscle Groups"}),a.jsxs("span",{className:"wk-section-count",children:[Jc.length," groups"]})]}),a.jsx("div",{className:"wk-muscle-grid",children:Jc.map((F,oe)=>a.jsx("button",{className:`wk-muscle-hero-card${F.image?" wk-muscle-thumb":""}`,onClick:()=>{Rt(F.key),T("muscle_sessions")},style:{animationDelay:`${oe*.05}s`},children:F.image?a.jsx("img",{src:F.image,alt:F.label,className:"wk-muscle-thumb-img"}):a.jsxs(a.Fragment,{children:[a.jsx("img",{src:Yw,alt:"Muscle group",className:"wk-muscle-hero-bg",loading:"lazy"}),a.jsx("div",{className:"wk-muscle-hero-overlay",style:{background:tg[F.key]}}),a.jsxs("div",{className:"wk-muscle-hero-content",children:[a.jsx("div",{className:"wk-muscle-hero-icon",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:F.icon})})}),a.jsxs("div",{className:"wk-muscle-hero-text",children:[a.jsx("span",{className:"wk-muscle-hero-name",children:F.label}),a.jsxs("span",{className:"wk-muscle-hero-count",children:[Xw[F.key]?.length||0," sessions"]})]})]})]})},F.key))})]})]}),a.jsx(Yr,{active:"workouts"}),ss]})});if(E==="randomiser_hub"){const F=JSON.parse(localStorage.getItem("mcf_last_randomiser")||"null")||{focus:"core",level:"intermediate",duration:15},oe=$r.find(M=>M.key===F.focus)?.label||F.focus,k=_i.find(M=>M.key===F.level)?.label||F.level;return a.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":d,children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>b("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"wk-main",children:[a.jsxs("div",{className:"wk-hub-heading wk-hub-heading-hero",children:[a.jsx("div",{className:"wk-hub-circle-frame",children:a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"wk-hub-circle-logo"})}),a.jsx("h2",{children:"Randomiser"}),a.jsx("p",{children:"Generate, save & replay workouts"})]}),a.jsxs("div",{className:"wk-hub-launch-zone",children:[Tn.total>0&&a.jsxs("div",{className:"wk-hub-stats",children:[a.jsxs("div",{className:"wk-hub-stat",children:[a.jsx("span",{className:"wk-hub-stat-value",children:Tn.total}),a.jsx("span",{className:"wk-hub-stat-label",children:"Workouts"})]}),Tn.streak>0&&a.jsxs("div",{className:"wk-hub-stat",children:[a.jsxs("span",{className:"wk-hub-stat-value",children:[Tn.streak,a.jsx("small",{children:"d"})]}),a.jsx("span",{className:"wk-hub-stat-label",children:"Streak"})]}),Tn.favouriteFocus&&a.jsxs("div",{className:"wk-hub-stat",children:[a.jsx("span",{className:"wk-hub-stat-value wk-hub-stat-focus",style:{color:mh[Tn.favouriteFocus]||"var(--color-primary)"},children:$r.find(M=>M.key===Tn.favouriteFocus)?.label||Tn.favouriteFocus}),a.jsx("span",{className:"wk-hub-stat-label",children:"Top Focus"})]})]}),a.jsxs("div",{className:"wk-hub-actions",children:[a.jsxs("button",{className:"wk-hub-action-btn wk-hub-new wk-hub-new-glow",onClick:()=>T("setup"),children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),a.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),"New Workout"]}),a.jsxs("button",{className:"wk-hub-action-btn wk-hub-quick",onClick:Ge,disabled:en,children:[a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2"})}),"Quick Start",a.jsxs("span",{className:"wk-hub-quick-meta",children:[oe,"  ",k,"  ",F.duration,"min"]})]})]}),Ft&&a.jsxs("button",{className:"wk-hub-suggestion",onClick:()=>{B(Ft.focus),T("setup")},children:[a.jsx("svg",{className:"wk-hub-suggestion-bulb",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 1 1 7.072 0l-.548.547A3.374 3.374 0 0 0 14 18.469V19a2 2 0 1 1-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),a.jsxs("div",{className:"wk-hub-suggestion-info",children:[a.jsx("span",{className:"wk-hub-suggestion-label",children:Ft.message}),a.jsx("span",{className:"wk-hub-suggestion-cta",children:"Tap to set up "})]}),a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),a.jsxs("div",{className:"wk-hub-tip",children:[a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 1 1 7.072 0l-.548.547A3.374 3.374 0 0 0 14 18.469V19a2 2 0 1 1-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),Jw[Math.floor(Date.now()/864e5)%Jw.length]]})]}),p&&a.jsxs("div",{className:"wk-hub-section wk-hub-section--saved",children:[a.jsxs("h3",{className:"wk-hub-section-title",children:[a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"})}),"Saved Workouts",un.length>0&&a.jsx("span",{className:"wk-hub-count",children:un.length})]}),Qr?un.length===0?a.jsxs("div",{className:"wk-hub-empty wk-hub-empty-enhanced",children:[a.jsx("svg",{className:"wk-hub-empty-icon",width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"})}),a.jsx("p",{children:a.jsx("strong",{children:"No saved workouts yet"})}),a.jsx("p",{className:"wk-hub-empty-sub",children:"Generate a workout and hit save to stash it here for quick replay."})]}):a.jsx("div",{className:"wk-hub-saved-categories",children:$r.map(M=>{const q=un.filter(me=>me.focus===M.key);if(q.length===0)return null;const te=Xr[M.key]||!1;return a.jsxs("div",{className:"wk-hub-saved-cat",children:[a.jsxs("button",{className:`wk-hub-saved-cat-header${te?" wk-hub-saved-cat-open":""}`,style:{"--cat-color":mh[M.key]||"var(--color-primary)"},onClick:()=>gr(me=>({...me,[M.key]:!me[M.key]})),children:[a.jsxs("span",{className:"wk-hub-saved-cat-label",children:[a.jsx("span",{className:"wk-hub-focus-pill",style:{"--pill-color":mh[M.key]||"var(--color-primary)"},children:M.label}),a.jsx("span",{className:"wk-hub-saved-cat-count",children:q.length})]}),a.jsx("svg",{className:`wk-hub-saved-cat-chevron${te?" wk-hub-saved-cat-chevron-open":""}`,width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("polyline",{points:"6 9 12 15 18 9"})})]}),te&&a.jsx("div",{className:"wk-hub-saved-list",children:q.map((me,Ie)=>{const Ne=(me.equipment||[]).map(Re=>sg.find(at=>at.key===Re)?.label||Re).join(", "),Be=_i.find(Re=>Re.key===me.level)?.label||me.level;return a.jsxs("div",{className:"wk-hub-saved-card",style:{animationDelay:`${Ie*.05}s`},children:[a.jsxs("button",{className:"wk-hub-saved-main",onClick:()=>Ot(me),children:[a.jsxs("div",{className:"wk-hub-saved-info",children:[a.jsx("span",{className:"wk-hub-saved-name",children:me.name}),a.jsx("span",{className:"wk-hub-saved-tags",children:a.jsxs("span",{className:"wk-hub-saved-meta",children:[Be,"  ",me.duration,"min  ",(me.exercises||[]).length," ex"]})}),Ne&&a.jsx("span",{className:"wk-hub-saved-equip",children:Ne})]}),a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})})]}),a.jsx("button",{className:"wk-hub-saved-delete",onClick:()=>qe(me.id),"aria-label":"Remove saved workout",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("polyline",{points:"3 6 5 6 21 6"}),a.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]},me.id)})})]},M.key)})}):a.jsx("div",{className:"wk-hub-empty",children:a.jsx("div",{className:"wk-loading-spinner"})})]}),a.jsxs("div",{className:"wk-hub-section wk-hub-section--recent",children:[a.jsxs("h3",{className:"wk-hub-section-title",children:[a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("polyline",{points:"12 6 12 12 16 14"})]}),"Recent"]}),Rr.length===0?a.jsxs("div",{className:"wk-hub-empty wk-hub-empty-enhanced",children:[a.jsxs("svg",{className:"wk-hub-empty-icon",width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("polyline",{points:"12 6 12 12 16 14"})]}),a.jsx("p",{children:a.jsx("strong",{children:"No workouts yet"})}),a.jsx("p",{className:"wk-hub-empty-sub",children:"Complete your first workout to see your history here."})]}):a.jsx("div",{className:"wk-hub-recent-list",children:Rr.map((M,q)=>{const te=$r.find(Be=>Be.key===M.focus)?.label||M.focus||"",me=_i.find(Be=>Be.key===M.level)?.label||M.level||"",Ie=M.completedAt?.toDate?M.completedAt.toDate():M.completedAt?new Date(M.completedAt):null,Ne=Ie?(()=>{const Be=Math.floor((Date.now()-Ie.getTime())/1e3);return Be<3600?`${Math.floor(Be/60)}m ago`:Be<86400?`${Math.floor(Be/3600)}h ago`:`${Math.floor(Be/86400)}d ago`})():"";return a.jsxs("button",{className:"wk-hub-recent-card",style:{animationDelay:`${q*.05}s`},onClick:()=>{B(M.focus||"core"),G(M.level||"intermediate"),he(M.duration||15),M.equipment&&W(M.equipment),T("setup")},children:[a.jsx("div",{className:"wk-hub-recent-info",children:a.jsxs("span",{className:"wk-hub-recent-tags",children:[a.jsx("span",{className:"wk-hub-focus-pill",style:{"--pill-color":mh[M.focus]||"var(--color-primary)"},children:te}),a.jsxs("span",{className:"wk-hub-recent-meta",children:[me,"  ",M.duration||"?","min  ",M.exerciseCount||"?"," ex"]})]})}),a.jsxs("div",{className:"wk-hub-recent-action",children:[a.jsx("span",{className:"wk-hub-recent-time",children:Ne}),a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]})]},q)})})]})]}),a.jsx(Yr,{active:"workouts"}),ss]})}if(E==="setup"){const F=$r.find(k=>k.key===H)?.label||H,oe=_i.find(k=>k.key===K)?.label||K;return a.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":d,children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>T("randomiser_hub"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"wk-main wk-setup-main",children:[a.jsx("div",{className:"wk-stats-row",children:[{label:"Total",value:`${yt}`,pct:yt>0?Math.min(Math.round(yt/100*100),100):0,color:"#14b8a6",size:"normal"},{label:"This Week",value:`${Cn}/${eg}`,pct:Math.round(Math.min(Cn,eg)/eg*100),color:"var(--color-primary)",size:"large"},{label:"Wk Streak",value:`${an}`,pct:an>0?Math.min(Math.round(an/12*100),100):0,color:"#38B6FF",size:"normal"}].map(k=>{const q=2*Math.PI*38,te=q-k.pct/100*q;return a.jsxs("div",{className:`wk-stat-item${k.size==="large"?" wk-stat-large":""}`,children:[a.jsxs("div",{className:"wk-stat-ring",children:[a.jsxs("svg",{viewBox:"0 0 100 100",children:[a.jsx("circle",{className:"wk-stat-track",cx:"50",cy:"50",r:38}),a.jsx("circle",{className:"wk-stat-fill",cx:"50",cy:"50",r:38,style:{stroke:k.color},strokeDasharray:q,strokeDashoffset:te})]}),a.jsx("span",{className:"wk-stat-value",style:{color:k.color},children:k.value})]}),a.jsx("span",{className:"wk-stat-label",children:k.label})]},k.label)})}),a.jsxs("div",{className:"wk-setup-flow",children:[a.jsxs("div",{className:"wk-setup-section",children:[a.jsx("h2",{children:"Focus Area"}),a.jsx("div",{className:"wk-focus-grid",children:$r.map(k=>a.jsxs("button",{className:`wk-equip-btn${H===k.key?" active":""}${k.key==="mix"?" wk-mix-btn":""}`,onClick:()=>{Ms(),B(k.key)},children:[a.jsx("svg",{className:"wk-equip-icon",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:k.icon})}),a.jsx("span",{children:k.label})]},k.key))})]}),a.jsxs("div",{className:"wk-setup-section",children:[a.jsx("h2",{children:"Level"}),a.jsx("div",{className:"wk-level-cards",children:_i.map(k=>a.jsxs("button",{className:`wk-level-card wk-level-${k.key}${K===k.key?" active":""}`,onClick:()=>{Ms(),G(k.key)},children:[a.jsx("span",{className:"wk-level-name",children:k.label}),a.jsx("span",{className:"wk-level-desc",children:k.desc})]},k.key))})]}),a.jsxs("div",{className:"wk-setup-section",children:[a.jsx("h2",{children:"Time"}),a.jsx("div",{className:"wk-time-options",children:rg.map(k=>{const M=!bs.includes(k);return a.jsxs("button",{className:`wk-time-btn${Q===k?" active":""}${M?" locked":""}`,onClick:()=>{M||(Ms(),he(k))},disabled:M,children:[a.jsx("span",{className:"wk-time-num",children:k}),a.jsx("span",{className:"wk-time-unit",children:M?a.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),a.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}):"min"})]},k)})})]}),a.jsxs("div",{className:"wk-setup-section",children:[a.jsx("h2",{children:"Equipment"}),a.jsx("div",{className:"wk-equip-options",children:sg.map(k=>{const M=L.includes(k.key);return a.jsxs("button",{className:`wk-equip-btn${M?" active":""}`,onClick:()=>{M&&L.length===1||(Ms(),W(q=>M&&q.length===1?q:M?q.filter(te=>te!==k.key):[...q,k.key]))},children:[a.jsx("svg",{className:"wk-equip-icon",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:k.icon})}),a.jsx("span",{children:k.label})]},k.key)})})]}),a.jsx("div",{className:"wk-setup-summary",children:a.jsxs("span",{children:[F,"  ",oe,"  ",Q," min"]})})]})]}),a.jsxs("div",{className:"wk-go-sticky",children:[en&&a.jsx("p",{className:"wk-free-limit-msg",children:"You've used your free workout this week. Upgrade for unlimited access."}),a.jsx("button",{className:"wk-randomise-btn",onClick:Vn,disabled:C||en,children:C?"Loading exercises...":en?"Limit Reached":"Randomise Workout"})]}),ss]})}if(E==="spinning")return a.jsxs("div",{className:"wk-page wk-page-center","data-theme":l?"dark":"light","data-accent":d,children:[a.jsxs("div",{className:"wk-spin-container",children:[a.jsxs("div",{className:"wk-spin-ring",children:[a.jsx("svg",{className:"wk-spin-svg",viewBox:"0 0 200 200",children:a3.map((F,oe)=>a.jsx("line",{x1:F.x1,y1:F.y1,x2:F.x2,y2:F.y2,className:"wk-spin-tick",strokeWidth:F.thick?"3.5":"2",style:{animationDelay:`${oe*.03}s`}},oe))}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"wk-spin-logo",width:"50",height:"50"})]}),a.jsx("p",{className:"wk-spin-text",children:"Generating workout..."})]}),ss]});if(E==="preview"){const F=Qe?.interval?{work:Qe.work,rest:Qe.rest}:_i.find(k=>k.key===K),oe=O.length*A*(F.work+F.rest);return a.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":d,children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>T(Qe?.interval?"muscle_sessions":"setup"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"wk-main",children:[Qe?.interval&&a.jsx("h2",{className:"mg-preview-title",children:Qe.name}),a.jsxs("div",{className:"wk-preview-stats",children:[a.jsxs("div",{className:"wk-stat",children:[a.jsx("span",{className:"wk-stat-val",children:O.length}),a.jsx("span",{className:"wk-stat-label",children:"Exercises"})]}),a.jsxs("div",{className:"wk-stat",children:[a.jsx("span",{className:"wk-stat-val",children:A}),a.jsx("span",{className:"wk-stat-label",children:"Rounds"})]}),a.jsxs("div",{className:"wk-stat",children:[a.jsx("span",{className:"wk-stat-val",children:Math.ceil(oe/60)}),a.jsx("span",{className:"wk-stat-label",children:"Minutes"})]}),a.jsxs("div",{className:"wk-stat",children:[a.jsxs("span",{className:"wk-stat-val",children:[F.work,"/",F.rest]}),a.jsx("span",{className:"wk-stat-label",children:"Work/Rest"})]})]}),a.jsx("div",{className:"wk-preview-list",children:O.map((k,M)=>a.jsxs("div",{className:"wk-preview-item",style:{animationDelay:`${M*.06}s`},onClick:()=>rt(k),children:[a.jsx("span",{className:"wk-preview-num",children:M+1}),a.jsx("div",{className:"wk-preview-thumb",children:k.isGif?a.jsx("img",{src:k.videoUrl,alt:k.name,loading:"lazy"}):a.jsx("video",{src:`${k.videoUrl}#t=0.1`,muted:!0,playsInline:!0,preload:"auto"})}),a.jsx("span",{className:"wk-preview-name",children:k.name}),a.jsx("svg",{className:"wk-preview-play",width:"22",height:"22",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})})]},M))}),Qt&&a.jsx("div",{className:"wk-preview-modal-backdrop",onClick:()=>rt(null),children:a.jsxs("div",{className:"wk-preview-modal",onClick:k=>k.stopPropagation(),children:[a.jsx("button",{className:"wk-preview-modal-close",onClick:()=>rt(null),"aria-label":"Close preview",children:a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})}),a.jsx("div",{className:"wk-preview-modal-video",children:Qt.isGif?a.jsx("img",{src:Qt.videoUrl,alt:Qt.name}):a.jsx("video",{src:Qt.videoUrl,autoPlay:!0,loop:!0,muted:!0,playsInline:!0})}),a.jsx("h3",{className:"wk-preview-modal-title",children:Qt.name})]})}),a.jsxs("div",{className:"wk-preview-actions",children:[!Qe?.interval&&a.jsxs("div",{className:"wk-preview-actions-row",children:[a.jsxs("button",{className:"wk-btn-secondary wk-btn-half",onClick:()=>Vn(),children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("polyline",{points:"1 4 1 10 7 10"}),a.jsx("path",{d:"M3.51 15a9 9 0 1 0 2.13-9.36L1 10"})]}),"Reshuffle"]}),p&&a.jsxs("button",{className:"wk-btn-secondary wk-btn-half",onClick:()=>Pn(!0),disabled:$n,children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"})}),"Save"]})]}),a.jsx("button",{className:"wk-btn-primary wk-btn-full",onClick:Xs,children:"Start Workout"})]}),ws&&a.jsx("div",{className:"wk-save-modal-backdrop",onClick:()=>Pn(!1),children:a.jsxs("div",{className:"wk-save-modal",onClick:k=>k.stopPropagation(),children:[a.jsx("h3",{children:"Save Workout"}),a.jsx("p",{children:"Give this workout a name (or leave blank for auto-name)"}),a.jsx("input",{type:"text",className:"wk-save-input",value:In,onChange:k=>ts(k.target.value),placeholder:`${$r.find(k=>k.key===H)?.label||H} ${Q}min`,maxLength:40,autoFocus:!0}),a.jsxs("div",{className:"wk-save-modal-actions",children:[a.jsx("button",{className:"wk-btn-secondary",onClick:()=>Pn(!1),children:"Cancel"}),a.jsx("button",{className:"wk-btn-primary",onClick:()=>Ue(In),disabled:$n,children:$n?"Saving...":"Save"})]})]})})]})]})}if(E==="countdown")return a.jsx("div",{className:"wk-page wk-page-center wk-page-dark","data-theme":l?"dark":"light","data-accent":d,children:a.jsxs("div",{className:"wk-countdown-big",children:[a.jsx("span",{className:"wk-countdown-num",children:Fe}),a.jsx("span",{className:"wk-countdown-label",children:"GET READY"})]})});if(E==="workout"){const F=O[Ce],oe=P==="work"?Je.work:Je.rest,k=P==="rest"?Ce+1<O.length?O[Ce+1]:je<A?O[0]:null:null;return a.jsxs("div",{className:"wk-page wk-page-workout","data-theme":l?"dark":"light","data-accent":d,children:[a.jsx("div",{className:"wk-video-container",children:P==="work"?F.isGif?a.jsx("img",{ref:st,className:"wk-video",src:F.videoUrl,alt:F.name},F.videoUrl):a.jsx("video",{className:"wk-video",src:F.videoUrl,autoPlay:!0,loop:!0,muted:!0,playsInline:!0},F.videoUrl):a.jsxs("div",{className:"wk-rest-screen",children:[a.jsx("span",{className:"wk-rest-label",children:"REST"}),k&&a.jsxs("span",{className:"wk-next-label",children:["Next: ",k.name]})]})}),a.jsx("div",{className:"wk-back-row",children:a.jsxs("button",{className:"wk-back-btn",onClick:()=>{confirm("Leave workout?")&&T("randomiser_hub")},children:[a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})}),"Back"]})}),a.jsx("div",{className:"wk-spotify",children:a.jsx("iframe",{src:"https://open.spotify.com/embed/playlist/37i9dQZF1DZ06evO3FJyYF?utm_source=generator&theme=0",width:"100%",height:"80",frameBorder:"0",allow:"autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture",loading:"lazy",title:"Spotify Playlist"})}),a.jsxs("div",{className:"wk-exercise-info",children:[a.jsxs("span",{className:"wk-exercise-counter",children:[Ce+1," / ",O.length]}),a.jsx("h2",{className:"wk-exercise-name",children:F.name}),a.jsxs("span",{className:"wk-round-label",children:["Round ",je," of ",A]})]}),a.jsx("div",{className:"wk-timer-section",children:a.jsxs("div",{className:"wk-timer-ring-wrap",children:[Mr(we,oe,P==="work"?"wk-tick-work":"wk-tick-rest"),a.jsxs("div",{className:"wk-timer-center",children:[a.jsx("span",{className:"wk-timer-time",children:we}),a.jsx("span",{className:`wk-timer-phase ${P}`,children:P==="work"?"WORK":"REST"})]})]})}),a.jsxs("div",{className:"wk-controls",children:[a.jsx("button",{className:"wk-ctrl-btn wk-ctrl-stop",onClick:()=>{confirm("End workout early?")&&T("randomiser_hub")},children:a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("rect",{x:"4",y:"4",width:"16",height:"16",rx:"2"})})}),a.jsx("button",{className:"wk-ctrl-btn wk-ctrl-pause",onClick:()=>Se(!xe),children:xe?a.jsx("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})}):a.jsxs("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"currentColor",children:[a.jsx("rect",{x:"6",y:"4",width:"4",height:"16"}),a.jsx("rect",{x:"14",y:"4",width:"4",height:"16"})]})}),a.jsx("button",{className:"wk-ctrl-btn wk-ctrl-skip",onClick:()=>{_e(0)},children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:[a.jsx("polygon",{points:"5 4 15 12 5 20 5 4"}),a.jsx("rect",{x:"15",y:"4",width:"4",height:"16"})]})})]}),a.jsx("div",{className:"wk-progress-bar",children:a.jsx("div",{className:"wk-progress-fill",style:{width:`${mi()*100}%`}})}),Oe&&(()=>{const M=_i.find(te=>te.key===K),q=O.length*A*(M.work+M.rest);return a.jsxs(a.Fragment,{children:[a.jsx(Wg,{title:"Workout Complete!",stats:[{value:Math.ceil(q/60),label:"Minutes"},{value:O.length*A,label:"Intervals"},{value:A,label:"Rounds"}],hideShare:!p,onShareJourney:t?Ct:null,userName:t?.name,onDismissStart:()=>T("randomiser_hub"),onDone:()=>{Mt(!1),Tt(null),Rt(null)}}),!Qe?.interval&&a.jsxs("button",{className:"wk-complete-save-btn",onClick:()=>Pn(!0),disabled:$n,children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"})}),"Save This Workout"]}),ws&&a.jsx("div",{className:"wk-save-modal-backdrop",onClick:()=>Pn(!1),style:{zIndex:10001},children:a.jsxs("div",{className:"wk-save-modal",onClick:te=>te.stopPropagation(),children:[a.jsx("h3",{children:"Save Workout"}),a.jsx("p",{children:"Give this workout a name (or leave blank for auto-name)"}),a.jsx("input",{type:"text",className:"wk-save-input",value:In,onChange:te=>ts(te.target.value),placeholder:`${$r.find(te=>te.key===H)?.label||H} ${Q}min`,maxLength:40,autoFocus:!0}),a.jsxs("div",{className:"wk-save-modal-actions",children:[a.jsx("button",{className:"wk-btn-secondary",onClick:()=>Pn(!1),children:"Cancel"}),a.jsx("button",{className:"wk-btn-primary",onClick:()=>Ue(In),disabled:$n,children:$n?"Saving...":"Save"})]})]})})]})})()]})}if(E==="muscle_sessions"){const F=Jc.find(k=>k.key===ft),oe=Xw[ft]||[];return a.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":d,children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>T("randomiser_hub"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"wk-main",children:[a.jsxs("div",{className:"mg-sessions-header",children:[a.jsx("div",{className:"mg-sessions-icon",style:{background:tg[ft]},children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:F?.icon})})}),a.jsxs("h2",{children:[F?.label," Workouts"]}),a.jsxs("p",{children:[oe.length," sessions available"]})]}),a.jsx("div",{className:"mg-sessions-list",children:oe.map((k,M)=>a.jsxs("button",{className:"mg-session-card",onClick:()=>{Tt(k),T("muscle_overview")},style:{animationDelay:`${M*.08}s`},children:[a.jsxs("div",{className:"mg-session-info",children:[a.jsx("h3",{children:k.name}),a.jsx("p",{children:k.desc}),a.jsx("div",{className:"mg-session-meta",children:k.interval?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"mg-session-tag mg-tag-interval",children:"Interval"}),a.jsxs("span",{className:"mg-session-tag",children:[k.exercises.length," exercises"]}),a.jsxs("span",{className:"mg-session-tag",children:[k.rounds," rounds"]})]}):a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"mg-session-tag mg-tag-strength",children:"Strength"}),a.jsxs("span",{className:"mg-session-tag",children:[k.exercises.length," exercises"]}),a.jsx("span",{className:"mg-session-tag",children:(()=>{const q=k.exercises.map(Ie=>Ie.sets||0),te=Math.min(...q),me=Math.max(...q);return te===me?`${te} sets each`:`${te}-${me} sets each`})()})]})})]}),a.jsx("div",{className:"mg-session-arrow",children:a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})})]},k.id))})]}),ss]})}if(E==="muscle_overview"){const F=Qe;if(!F)return null;const oe=Jc.find(k=>k.key===ft);return a.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":d,children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>T("muscle_sessions"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"wk-main mg-overview-main",children:[a.jsx("div",{className:"mg-overview-hero",style:F.image?void 0:{background:tg[ft]},children:F.image?a.jsx("img",{src:F.image,alt:F.name,className:"mg-overview-hero-img"}):a.jsx("div",{className:"mg-overview-hero-content",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",className:"mg-overview-hero-icon",children:a.jsx("path",{d:oe?.icon})})})}),a.jsxs("div",{className:"mg-overview-header",children:[a.jsxs("div",{className:"mg-overview-title-row",children:[a.jsx("h2",{children:F.name}),F.level&&a.jsx("span",{className:"mg-overview-level",children:F.level})]}),a.jsx("p",{className:"mg-overview-desc",children:F.desc})]}),F.overview&&a.jsxs("div",{className:"mg-overview-section",children:[a.jsxs("h3",{children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("path",{d:"M12 16v-4M12 8h.01"})]}),"About This Workout"]}),a.jsx("p",{children:F.overview})]}),F.tips&&F.tips.length>0&&a.jsxs("div",{className:"mg-overview-section",children:[a.jsxs("h3",{children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 1 1 7.072 0l-.548.547A3.374 3.374 0 0 0 14 18.469V19a2 2 0 1 1-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),"Tips & Form"]}),a.jsx("ul",{className:"mg-overview-tips",children:F.tips.map((k,M)=>a.jsx("li",{children:k},M))})]}),a.jsxs("div",{className:"mg-overview-section",children:[a.jsxs("h3",{children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M9 5H7a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-2"}),a.jsx("rect",{x:"9",y:"3",width:"6",height:"4",rx:"1"}),a.jsx("path",{d:"M9 14l2 2 4-4"})]}),"Exercises (",F.exercises.length,")"]}),a.jsx("div",{className:"mg-overview-exercises",children:F.exercises.map((k,M)=>a.jsxs("div",{className:"mg-overview-exercise",children:[a.jsx("span",{className:"mg-overview-ex-num",children:M+1}),a.jsxs("div",{className:"mg-overview-ex-info",children:[a.jsx("span",{className:"mg-overview-ex-name",children:k.name}),F.interval?a.jsxs("span",{className:"mg-overview-ex-detail",children:[F.work,"s work / ",F.rest,"s rest"]}):a.jsxs("span",{className:"mg-overview-ex-detail",children:[k.sets," sets  ",k.reps?`${k.reps} reps`:`${k.time}s`,k.type==="weighted"&&"  weighted"]})]})]},M))})]}),a.jsxs("button",{className:"mg-overview-start-btn",onClick:()=>ma(F),children:[a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M8 5v14l11-7z"})}),"Start Workout"]})]}),ss]})}if(E==="muscle_workout"){const F=Qe;if(!F)return null;const oe=F.exercises[pt],k=Wt[pt];if(!oe||!k)return null;const M=k.sets.length,q=F.exercises.length,te=F.exercises.reduce((Re,at)=>Re+(at.sets||0),0),Ie=Wt.reduce((Re,at)=>Re+at.sets.length,0)/te*100,Ne=On[oe.name];oe.type==="timed"&&$e===0&&!He&&M===zs&&setTimeout(()=>rn(oe.time),0);const Be=M+1<oe.sets?"Log Set":pt+1<q?"Log Set  Next Exercise":"Log Set  Complete";return a.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":d,children:[a.jsx("div",{className:"mg-session-progress",children:a.jsx("div",{className:"mg-session-progress-fill",style:{width:`${Ie}%`}})}),a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>{confirm("End workout early?")&&T("muscle_overview")},"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsxs("span",{className:"mg-header-info",children:["Exercise ",pt+1,"/",q]}),a.jsx("div",{style:{width:22}})]})}),a.jsxs("main",{className:"wk-main",children:[Ne?a.jsxs("div",{className:"mg-video-container",onClick:vr,children:[Ne.isGif?a.jsx("img",{className:"mg-video",src:Ne.url,alt:oe.name}):a.jsx("video",{ref:Zt,className:"mg-video",src:Ne.url,loop:!0,muted:!0,playsInline:!0},oe.name),!Jt&&!Ne.isGif&&a.jsxs("div",{className:"mg-video-overlay",children:[a.jsx("svg",{className:"mg-play-icon",width:"48",height:"48",viewBox:"0 0 24 24",fill:"rgba(255,255,255,0.9)",children:a.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})}),a.jsx("span",{className:"mg-video-hint",children:"Tap for demo"})]})]}):a.jsxs("div",{className:"mg-video-placeholder",children:[a.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",opacity:"0.4",children:[a.jsx("rect",{x:"2",y:"2",width:"20",height:"20",rx:"2.18",ry:"2.18"}),a.jsx("line",{x1:"7",y1:"2",x2:"7",y2:"22"}),a.jsx("line",{x1:"17",y1:"2",x2:"17",y2:"22"}),a.jsx("line",{x1:"2",y1:"12",x2:"22",y2:"12"}),a.jsx("line",{x1:"2",y1:"7",x2:"7",y2:"7"}),a.jsx("line",{x1:"2",y1:"17",x2:"7",y2:"17"}),a.jsx("line",{x1:"17",y1:"7",x2:"22",y2:"7"}),a.jsx("line",{x1:"17",y1:"17",x2:"22",y2:"17"})]}),a.jsx("span",{children:"Video coming soon"})]}),a.jsx("div",{className:"wk-spotify",children:a.jsx("iframe",{src:"https://open.spotify.com/embed/playlist/37i9dQZF1DZ06evO3FJyYF?utm_source=generator&theme=0",width:"100%",height:"80",frameBorder:"0",allow:"autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture",loading:"lazy",title:"Spotify Playlist"})}),a.jsxs("div",{className:"mg-exercise-card",children:[a.jsx("h2",{className:"mg-ex-name",children:oe.name}),a.jsx("span",{className:`mg-ex-type-badge ${oe.type}`,children:oe.type==="weighted"?"Weight + Reps":oe.type==="reps"?"Reps Only":"Timed"}),a.jsxs("div",{className:"mg-ex-set-info",children:[a.jsxs("span",{className:"mg-ex-set-num",children:["Set ",M+1," of ",oe.sets]}),oe.type!=="timed"&&a.jsxs("span",{className:"mg-ex-target",children:["Target: ",oe.reps," reps"]}),oe.type==="timed"&&a.jsxs("span",{className:"mg-ex-target",children:["Target: ",oe.time,"s"]})]}),oe.type==="weighted"&&a.jsxs("div",{className:"mg-input-area",children:[a.jsxs("div",{className:"mg-input-group",children:[a.jsx("label",{children:"Weight (kg)"}),a.jsx("input",{type:"number",inputMode:"decimal",className:"mg-input",value:Ae,onChange:Re=>gt(Re.target.value),placeholder:"0"})]}),a.jsxs("div",{className:"mg-input-group",children:[a.jsx("label",{children:"Reps"}),a.jsx("input",{type:"number",inputMode:"numeric",className:"mg-input",value:vt,onChange:Re=>ut(Re.target.value),placeholder:"0"})]})]}),oe.type==="reps"&&a.jsx("div",{className:"mg-input-area",children:a.jsxs("div",{className:"mg-input-group mg-input-single",children:[a.jsx("label",{children:"Reps"}),a.jsx("input",{type:"number",inputMode:"numeric",className:"mg-input",value:vt,onChange:Re=>ut(Re.target.value),placeholder:"0"})]})}),oe.type==="timed"&&a.jsxs("div",{className:"mg-timer-area",children:[a.jsx("div",{className:"mg-timer-display",children:a.jsxs("span",{className:"mg-timer-value",children:[$e,"s"]})}),He?a.jsx("button",{className:"mg-timer-btn mg-timer-stop",onClick:()=>nt(!1),children:"Stop"}):a.jsx("button",{className:"mg-timer-btn",onClick:()=>{$e===0&&rn(oe.time),nt(!0)},children:$e<oe.time&&$e>0?"Resume":"Start Timer"})]}),a.jsx("button",{className:"mg-log-set-btn",onClick:Cs,children:Be}),k.sets.length>0&&a.jsx("div",{className:"mg-completed-sets",children:k.sets.map((Re,at)=>a.jsxs("div",{className:"mg-completed-set",children:[a.jsx("span",{className:"mg-completed-set-check",children:""}),a.jsxs("span",{children:["Set ",at+1,": ",Re.weight!=null?`${Re.weight}kg  ${Re.reps}`:Re.reps!=null?`${Re.reps} reps`:`${Re.time}s`]})]},at))})]})]}),ss,cn&&(()=>{const Re=Wt.reduce((et,tn)=>et+tn.sets.length,0),at=Jc.find(et=>et.key===ft)?.label||"",bn=[{value:Wt.length,label:"Exercises"},{value:Re,label:"Sets"}];return a.jsx(Wg,{title:`${at} Complete!`,subtitle:Qe?.name,stats:bn,hideShare:!p,onShareJourney:t?Ct:null,userName:t?.name,onDismissStart:()=>T("randomiser_hub"),onDone:()=>{qn(!1),Tt(null),Rt(null)}})})()]})}return null}const m5=[{key:"trained",label:"Trained",icon:"M4 10v4M8 7v10M8 12h8M16 7v10M20 10v4",color:"#A12F3A",darkColor:"#E8475A"},{key:"protein",label:"Hit Protein",icon:"M12 22c5.52 0 10-4.48 10-10S17.52 2 12 2 2 6.48 2 12s4.48 10 10 10zM12 18c3.31 0 6-2.69 6-6s-2.69-6-6-6-6 2.69-6 6 2.69 6 6 6zM12 14a2 2 0 1 0 0-4 2 2 0 0 0 0 4z",color:"#4caf50",darkColor:"#5CDB61"},{key:"steps",label:"10k Steps",icon:"M4 19.5A2.5 2.5 0 0 1 6.5 17H20M4 12.5A2.5 2.5 0 0 1 6.5 10H20M4 5.5A2.5 2.5 0 0 1 6.5 3H20",color:"#ff9800",darkColor:"#FFB020"},{key:"sleep",label:"8hrs Sleep",icon:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z",color:"#7c3aed",darkColor:"#9B5AF2"},{key:"water",label:"2L Water",icon:"M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z",color:"#2196f3",darkColor:"#42A5F5"}],p5="M12 2l2.4 7.2L22 12l-7.6 2.8L12 22l-2.4-7.2L2 12l7.6-2.8z",g5="#e91e63",y5="#FF4D88",v5=700,Gg=42,Rl=2*Math.PI*Gg,ph=["Every day counts. See you tomorrow!","Consistency is your superpower.","Perfect day  keep the streak alive!","You showed up for yourself today."];function b5(s){const e=new Date(s),t=e.getDay(),i=t===0?-6:1-t;return e.setDate(e.getDate()+i),e.setHours(0,0,0,0),e}function Ba(s){return s.toISOString().split("T")[0]}function w5(s){return Array.from({length:7},(e,t)=>{const i=new Date(s);return i.setDate(s.getDate()+t),i})}function x5(){const{currentUser:s,isClient:e,clientData:t,loading:i}=Ar(),{isDark:l,toggleTheme:u,accent:d}=Mi(),{isPremium:p,FREE_HABIT_LIMIT:g}=ic(),y=Ys(),[b,E]=w.useState({}),[T,L]=w.useState([]),[W,H]=w.useState(!0),[B,K]=w.useState(!1),[G,Q]=w.useState(0),[he,Ee]=w.useState(null),[ge,C]=w.useState(null),[j,R]=w.useState(!1),[V,O]=w.useState(!1),[D,A]=w.useState(!1),[Le,Je]=w.useState(!1),[X,je]=w.useState(""),[De,Ce]=w.useState(null),[J,P]=w.useState([]),[re,we]=w.useState(null),_e=w.useRef(null),xe=w.useRef(null),Se=w.useRef(null),Fe=w.useRef(null),Ze=w.useRef(!1),Oe=w.useRef({}),Mt=w.useRef([]),cn=w.useRef([]),qn=w.useRef(null),Qt=w.useRef(ph[Math.floor(Math.random()*ph.length)]),rt=w.useCallback((le,Me="info")=>{Ee({message:le,type:Me}),setTimeout(()=>Ee(null),3e3)},[]),st=new Date,ct=Ba(st),En=b5(st),fe=w5(En),Ct=["M","T","W","T","F","S","S"],ft=(le,Me)=>l&&Me?Me:le,Rt=[...m5.filter(le=>!J.includes(le.key)).map(le=>({...le,color:ft(le.color,le.darkColor)})),...T.map(le=>({key:`custom_${le.id}`,label:le.label,icon:p5,color:ft(g5,y5),isCustom:!0,id:le.id}))],Qe=p?Rt:Rt.slice(0,g);w.useEffect(()=>{!i&&(!s||!e)&&y("/")},[s,e,i,y]),w.useEffect(()=>{if(!s||!t)return;(async()=>{try{const Me=ht(ye,"habitLogs"),Ye=Yt(Me,xt("clientId","==",t.id)),yt=await Ht(Ye),it={};yt.docs.forEach(Kt=>{const vs=Kt.data();it[vs.date]={...vs,_id:Kt.id}}),E(it);const Gt=await Es(We(ye,"customHabits",t.id));if(Gt.exists()){const Kt=Gt.data();L(Kt.habits||[]),P(Kt.hiddenDefaults||[])}let vn=0;const an=new Date(st);for(;;){const Kt=Ba(an),vs=it[Kt];if(vs)if(Object.values(vs.habits||{}).filter(Boolean).length>=3)vn++,an.setDate(an.getDate()-1);else break;else if(Kt===ct)an.setDate(an.getDate()-1);else break}Q(vn)}catch(Me){console.error("Error loading habit logs:",Me)}finally{H(!1)}})()},[s,t]);const Tt=b[ct]||{habits:{}};w.useEffect(()=>{Object.values(Tt.habits||{}).filter(Boolean).length<Qe.length&&D&&A(!1)},[Qe.length,Tt.habits]);const pt=async le=>{if(!(!s||B||Tt.habits?.[le])){Mt.current=[...Array(10)].map((Ye,yt)=>{const it=yt/10*2*Math.PI,Gt=18+Math.random()*20;return{tx:Math.cos(it)*Gt,ty:Math.sin(it)*Gt,size:3+Math.random()*4,duration:.4+Math.random()*.3}}),C(le),setTimeout(()=>C(null),700),navigator.vibrate&&navigator.vibrate(50),K(!0);try{const yt={...Tt.habits||{},[le]:!0},it=Tt._id||`${t.id}_${ct}`;if(E(vn=>({...vn,[ct]:{clientId:t.id,date:ct,habits:yt,_id:it}})),await Ts(We(ye,"habitLogs",it),{clientId:t.id,date:ct,habits:yt}),Object.values(yt).filter(Boolean).length===Qe.length&&!D){Qt.current=ph[Math.floor(Math.random()*ph.length)],cn.current=[...Array(80)].map((an,Kt)=>({x:5+Math.random()*90,delay:Math.random()*3.5,color:["#A12F3A","#4caf50","#ff9800","#2196f3","#e91e63","#ffeb3b","#FFD700","#ffffff","#9c27b0"][Kt%9],drift:(Math.random()-.5)*120,spin:Math.random()*720-360,duration:1.8+Math.random()*2,width:4+Math.random()*6,height:4+Math.random()*8,shape:Kt%3})),setTimeout(()=>{R(!0),A(!0),setTimeout(()=>qn.current?.focus(),1100)},400);let vn=1;for(let an=1;an<7;an++){const Kt=new Date;Kt.setDate(Kt.getDate()-an);const vs=Ba(Kt),Nn=b[vs];if(Nn)if(Object.values(Nn.habits||{}).filter(Boolean).length>=Qe.length)vn++;else break;else break}vn>=7&&Zh("habits_7",t)}}catch(Ye){console.error("Error saving habit:",Ye),rt("Failed to save. Try again.","error"),E(yt=>({...yt,[ct]:{...yt[ct],habits:{...yt[ct]?.habits||{},[le]:!1}}}))}finally{K(!1)}}},Xt=async le=>{if(!(!s||B)){K(!0);try{const Ye={...Tt.habits||{},[le]:!1},yt=Tt._id||`${t.id}_${ct}`;await Ts(We(ye,"habitLogs",yt),{clientId:t.id,date:ct,habits:Ye}),E(it=>({...it,[ct]:{clientId:t.id,date:ct,habits:Ye,_id:yt}}))}catch(Me){console.error("Error undoing habit:",Me),rt("Failed to undo. Try again.","error")}finally{K(!1)}}},zs=le=>{if(Tt.habits?.[le]||!1||B||Fe.current)return;Fe.current=le,we(le),xe.current=performance.now();const Ye=Oe.current[le];Ye&&(Ye.style.strokeDashoffset=Rl);const yt=it=>{const Gt=it-xe.current,vn=Math.min(Gt/v5,1),an=Oe.current[le];an&&(an.style.strokeDashoffset=Rl-vn*Rl),vn<1?Se.current=requestAnimationFrame(yt):(Fe.current=null,Ze.current=!0,Se.current=null,we(null),pt(le))};Se.current=requestAnimationFrame(yt)},es=()=>{if(!Fe.current)return;const le=Fe.current;Fe.current=null,Se.current&&(cancelAnimationFrame(Se.current),Se.current=null),_e.current&&(clearTimeout(_e.current),_e.current=null),Oe.current[le]&&(Oe.current[le].style.strokeDashoffset=Rl),we(null),xe.current=null};w.useEffect(()=>()=>{Se.current&&cancelAnimationFrame(Se.current),_e.current&&clearTimeout(_e.current)},[]);const Wt=w.useCallback(async le=>{if(!t)throw new Error("Not signed in");const Me=le&&typeof le=="object"&&le.type;await mr(ht(ye,"posts"),{authorId:t.id,authorName:t.name||"Unknown",authorPhotoURL:t.photoURL||null,content:Me?"":le,type:Me?le.type:"text",imageURL:null,createdAt:Rs(),likeCount:0,commentCount:0,...Me?{metadata:{title:le.title||"",subtitle:le.subtitle||"",stats:le.stats||[],quote:le.quote||"",badges:le.badges||[]}}:{}})},[t]),se=async()=>{const le=X.trim();if(!le)return;if(!t?.id){rt("Still loading, try again","error");return}const Me=Date.now().toString(36),Ye=[...T,{id:Me,label:le}];try{await Ts(We(ye,"customHabits",t.id),{clientId:t.id,habits:Ye,hiddenDefaults:J},{merge:!0}),L(Ye),je(""),Je(!1),rt(`Added "${le}"`,"success")}catch(yt){console.error("Error adding custom habit:",yt),rt(yt?.code==="permission-denied"?"Permission denied  check Firestore rules for customHabits":`Failed to add habit: ${yt?.message||"Unknown error"}`,"error")}},Ae=async le=>{if(!t?.id)return;const Me=T.filter(Ye=>Ye.id!==le);try{await Ts(We(ye,"customHabits",t.id),{clientId:t.id,habits:Me,hiddenDefaults:J},{merge:!0}),L(Me),Ce(null),rt("Habit removed","success")}catch(Ye){console.error("Error deleting habit:",Ye),rt("Failed to remove","error")}},gt=async le=>{if(!t?.id)return;const Me=[...J,le];try{await Ts(We(ye,"customHabits",t.id),{clientId:t.id,habits:T,hiddenDefaults:Me},{merge:!0}),P(Me),Ce(null),rt("Habit removed","success")}catch(Ye){console.error("Error hiding default habit:",Ye),rt("Failed to remove","error")}},vt=fe.map(le=>{const Me=Ba(le),Ye=b[Me],yt=Ye?Object.values(Ye.habits||{}).filter(Boolean).length:0;return{date:le,dateStr:Me,completed:yt,total:Qe.length}}),ut=vt.reduce((le,Me)=>le+Me.completed,0),He=vt.reduce((le,Me)=>le+Me.total,0),nt=He>0?Math.round(ut/He*100):0,$e=Object.values(Tt.habits||{}).filter(Boolean).length,rn=Qe.length>0?Math.round($e/Qe.length*100):0,Jt=$e===Qe.length&&Qe.length>0,Rn=(()=>{const le=Object.keys(b).sort();let Me=0,Ye=0,yt=null;for(const it of le){const Gt=b[it];if(Object.values(Gt.habits||{}).filter(Boolean).length>=3){if(yt){const an=new Date(yt);Ye=(new Date(it)-an)/(1e3*60*60*24)===1?Ye+1:1}else Ye=1;Ye>Me&&(Me=Ye),yt=it}else Ye=0,yt=null}return Math.max(Me,G)})(),On=new Date(st.getFullYear(),st.getMonth(),1),Kn=On.toLocaleString("default",{month:"long"}),Zt=new Date(st.getFullYear(),st.getMonth()+1,0).getDate(),Hn=(On.getDay()+6)%7,Cn=Array.from({length:Zt},(le,Me)=>{const Ye=new Date(st.getFullYear(),st.getMonth(),Me+1),yt=Ba(Ye),it=b[yt],Gt=it?Object.values(it.habits||{}).filter(Boolean).length:0,vn=Ye>st;return{day:Me+1,dateStr:yt,completed:Gt,total:Qe.length,isFuture:vn,isToday:yt===ct}}),yn=Qe.map(le=>({...le,days:fe.map(Me=>{const Ye=Ba(Me);return b[Ye]?.habits?.[le.key]||!1})})),Ss=vt.filter(le=>le.completed===le.total&&le.total>0).length;return a.jsx(Jo,{children:a.jsxs("div",{className:"cbc-page","data-theme":l?"dark":"light","data-accent":d,children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>y("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),i||W?a.jsx("div",{className:"cbc-loading-inline",children:a.jsx("div",{className:"cbc-loading-spinner"})}):a.jsxs("main",{className:"cbc-main",children:[a.jsxs("div",{className:"cbc-hero anim-fade-up",children:[a.jsxs("div",{className:`cbc-progress-ring${Jt?" cbc-ring-complete":""}`,children:[a.jsxs("svg",{viewBox:"0 0 200 200",children:[a.jsx("circle",{className:"cbc-arc-track",cx:"100",cy:"100",r:"80"}),a.jsx("circle",{className:"cbc-arc-fill",cx:"100",cy:"100",r:"80",strokeDasharray:2*Math.PI*80,strokeDashoffset:2*Math.PI*80-rn/100*2*Math.PI*80})]}),a.jsxs("div",{className:"cbc-ring-center",children:[a.jsxs("span",{className:"cbc-ring-count",children:[$e,a.jsx("span",{className:"cbc-ring-divider",children:"/"}),Qe.length]}),a.jsx("span",{className:"cbc-ring-label",children:Jt?"complete":"today"})]})]}),a.jsx("p",{className:"cbc-hero-tagline",children:Jt?"You showed up for yourself today.":$e===0?"Start your day strong.":`${Qe.length-$e} to go  keep pushing.`})]}),a.jsxs("div",{className:"cbc-streak-card anim-fade-up-d1",children:[a.jsx("div",{className:"cbc-streak-icon",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M13 2L3 14h9l-1 8 10-12h-9l1-8z"})})}),a.jsxs("div",{className:"cbc-streak-info",children:[a.jsx("span",{className:"cbc-streak-count",children:G}),a.jsx("span",{className:"cbc-streak-label",children:"day streak"})]}),a.jsxs("div",{className:"cbc-streak-best",children:[a.jsx("span",{className:"cbc-streak-best-val",children:Rn}),a.jsx("span",{className:"cbc-streak-best-label",children:"best"})]})]}),a.jsxs("div",{className:"cbc-section anim-fade-up-d2",children:[a.jsx("h2",{className:"cbc-section-title",children:"Today's Habits"}),a.jsxs("div",{className:"cbc-habits-grid",children:[Qe.map(le=>{const Me=Tt.habits?.[le.key]||!1,Ye=ge===le.key,yt=re===le.key;return a.jsxs("div",{className:`cbc-habit-tile ${Me?"cbc-habit-done":""} ${Ye?"cbc-habit-just-checked":""}`,style:{"--habit-color":le.color},children:[p&&a.jsx("button",{className:"cbc-habit-delete",onClick:it=>{it.stopPropagation(),Ce(le.isCustom?{type:"custom",id:le.id,label:le.label}:{type:"default",key:le.key,label:le.label})},"aria-label":`Remove ${le.label}`,children:a.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})}),a.jsxs("div",{className:`cbc-habit-ring-touch ${yt?"cbc-holding":""} ${Me?"cbc-ring-completed":""}`,onPointerDown:it=>{Me||(it.preventDefault(),zs(le.key))},onPointerUp:es,onPointerLeave:es,onPointerCancel:es,onClick:it=>{if(it.stopPropagation(),Ze.current){Ze.current=!1;return}Me&&Xt(le.key)},role:"button",tabIndex:0,"aria-label":Me?`Undo ${le.label}`:`Press and hold to complete ${le.label}`,onKeyDown:it=>{(it.key==="Enter"||it.key===" ")&&(it.preventDefault(),Me?Xt(le.key):pt(le.key))},children:[a.jsxs("svg",{className:"cbc-habit-ring-svg",viewBox:"0 0 100 100",children:[a.jsx("circle",{className:"cbc-habit-ring-track",cx:"50",cy:"50",r:Gg}),a.jsx("circle",{className:"cbc-habit-ring-fill",ref:it=>{it&&(Oe.current[le.key]=it)},cx:"50",cy:"50",r:Gg,style:{stroke:le.color,strokeDasharray:Rl,strokeDashoffset:Me?0:Rl}})]}),Me&&a.jsx("div",{className:"cbc-habit-glow-orb",style:{"--habit-color":le.color}}),a.jsx("div",{className:"cbc-habit-ring-icon",style:{color:le.color},children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:le.icon})})}),Ye&&a.jsx("div",{className:"cbc-particles",children:Mt.current.map((it,Gt)=>a.jsx("span",{className:"cbc-particle",style:{"--tx":`${it.tx}px`,"--ty":`${it.ty}px`,"--size":`${it.size}px`,"--particle-color":le.color,animationDuration:`${it.duration}s`}},Gt))})]}),a.jsx("span",{className:"cbc-habit-label",children:le.label}),Me?a.jsx("span",{className:"cbc-habit-done-tag",children:"Done"}):a.jsx("span",{className:"cbc-habit-hold-hint",children:"Hold to complete"})]},le.key)}),p?a.jsxs("div",{className:"cbc-habit-tile cbc-add-tile",onClick:()=>Je(!0),role:"button",tabIndex:0,children:[a.jsx("div",{className:"cbc-add-ring",children:a.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),a.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})}),a.jsx("span",{className:"cbc-habit-label",children:"Add Habit"}),a.jsx("span",{className:"cbc-habit-hold-hint",children:"Your own"})]}):a.jsxs("div",{className:"cbc-habit-tile cbc-unlock-tile",onClick:()=>y("/upgrade"),role:"button",tabIndex:0,children:[a.jsx("div",{className:"cbc-unlock-ring",children:a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),a.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]})}),a.jsx("span",{className:"cbc-habit-label",children:"More Habits"}),a.jsx("span",{className:"cbc-habit-hold-hint",children:"Custom & editable"})]})]})]}),a.jsxs("div",{className:"cbc-section anim-fade-up-d3",children:[a.jsxs("div",{className:"cbc-section-header",children:[a.jsx("h2",{className:"cbc-section-title",children:"This Week"}),a.jsxs("span",{className:"cbc-section-badge",children:[Ss,"/7 perfect"]})]}),a.jsxs("div",{className:"cbc-weekly-card",children:[a.jsxs("div",{className:"cbc-weekly-header",children:[a.jsx("span",{className:"cbc-weekly-habit-name"}),Ct.map((le,Me)=>a.jsx("span",{className:`cbc-weekly-day-label${fe[Me]&&Ba(fe[Me])===ct?" cbc-today-label":""}`,children:le},Me))]}),yn.map(le=>(le.days.filter(Boolean).length,a.jsxs("div",{className:"cbc-weekly-row",children:[a.jsx("span",{className:"cbc-weekly-habit-name",style:{color:le.color},children:le.label}),le.days.map((Me,Ye)=>a.jsx("span",{className:`cbc-weekly-dot${Me?" cbc-dot-done":""}${fe[Ye]&&Ba(fe[Ye])===ct?" cbc-dot-today":""}`,style:Me?{background:le.color,borderColor:le.color,boxShadow:`0 0 6px ${le.color}40`}:void 0},Ye))]},le.key))),a.jsxs("div",{className:"cbc-week-summary",children:[a.jsx("div",{className:"cbc-week-summary-bar",children:a.jsx("div",{className:"cbc-week-summary-fill",style:{width:`${nt}%`}})}),a.jsxs("span",{className:"cbc-week-summary-text",children:[ut,"/",He," completed (",nt,"%)"]})]})]})]}),a.jsxs("div",{className:"cbc-section anim-fade-up-d4",children:[a.jsx("h2",{className:"cbc-section-title",children:Kn}),a.jsxs("div",{className:"cbc-calendar-card",children:[a.jsx("div",{className:"cbc-cal-header",children:["M","T","W","T","F","S","S"].map((le,Me)=>a.jsx("span",{className:"cbc-cal-day-label",children:le},Me))}),a.jsxs("div",{className:"cbc-cal-grid",children:[Array.from({length:Hn},(le,Me)=>a.jsx("span",{className:"cbc-cal-cell cbc-cal-empty"},`e${Me}`)),Cn.map(le=>{const Me=le.total>0?le.completed/le.total:0,Ye=le.isFuture?-1:Me===0?0:Me<.4?1:Me<.75?2:Me<1?3:4;return a.jsx("span",{className:`cbc-cal-cell${le.isToday?" cbc-cal-today":""}${Ye===4?" cbc-cal-perfect":""} cbc-cal-heat-${Ye<0?"future":Ye}`,children:le.day},le.day)})]}),a.jsxs("div",{className:"cbc-cal-legend",children:[a.jsx("span",{className:"cbc-cal-legend-label",children:"Less"}),a.jsx("span",{className:"cbc-cal-legend-swatch cbc-cal-heat-0"}),a.jsx("span",{className:"cbc-cal-legend-swatch cbc-cal-heat-1"}),a.jsx("span",{className:"cbc-cal-legend-swatch cbc-cal-heat-2"}),a.jsx("span",{className:"cbc-cal-legend-swatch cbc-cal-heat-3"}),a.jsx("span",{className:"cbc-cal-legend-swatch cbc-cal-heat-4"}),a.jsx("span",{className:"cbc-cal-legend-label",children:"More"})]})]})]})]}),a.jsx(Yr,{active:"home"}),Le&&a.jsx("div",{className:"cbc-modal-overlay",onClick:()=>Je(!1),children:a.jsxs("div",{className:"cbc-modal",onClick:le=>le.stopPropagation(),children:[a.jsx("h3",{className:"cbc-modal-title",children:"Add Habit"}),a.jsx("p",{className:"cbc-modal-desc",children:"Track something personal to your routine."}),a.jsx("input",{className:"cbc-modal-input",type:"text",placeholder:"e.g. Meditate, Stretch, Read...",value:X,onChange:le=>je(le.target.value),maxLength:30,autoFocus:!0,onKeyDown:le=>le.key==="Enter"&&se()}),a.jsxs("div",{className:"cbc-modal-actions",children:[a.jsx("button",{className:"cbc-modal-cancel",onClick:()=>{Je(!1),je("")},children:"Cancel"}),a.jsx("button",{className:"cbc-modal-save",onClick:se,disabled:!X.trim(),children:"Add"})]})]})}),De&&a.jsx("div",{className:"cbc-modal-overlay",onClick:()=>Ce(null),children:a.jsxs("div",{className:"cbc-modal",onClick:le=>le.stopPropagation(),children:[a.jsxs("h3",{className:"cbc-modal-title",children:['Remove "',De.label,'"?']}),a.jsx("p",{className:"cbc-modal-desc",children:"This will remove the habit from your daily tracker. Past logs won't be affected."}),a.jsxs("div",{className:"cbc-modal-actions",children:[a.jsx("button",{className:"cbc-modal-cancel",onClick:()=>Ce(null),children:"Keep"}),a.jsx("button",{className:"cbc-modal-delete",onClick:()=>De.type==="custom"?Ae(De.id):gt(De.key),children:"Remove"})]})]})}),j&&a.jsx(Wg,{title:"All Habits Complete!",subtitle:Qt.current,stats:[{value:`${$e}/${Qe.length}`,label:"Habits"},{value:G||1,label:"Day Streak"}],buttonLabel:"Keep Going",holdLabel:"Hold To Complete Today's Habits",shareType:"habits",hideShare:!p,onShareJourney:t?Wt:null,userName:t?.name,onDone:()=>{R(!1),O(!1)}}),he&&a.jsx("div",{className:`toast-notification ${he.type}`,children:he.message})]})})}function gh(s){if(!s)return"?";const e=s.trim().split(/\s+/);return e.length===1?e[0][0].toUpperCase():(e[0][0]+e[e.length-1][0]).toUpperCase()}function Zw(s,e){return[s,e].sort().join("_")}function _5(){const{currentUser:s,isClient:e,clientData:t,loading:i}=Ar(),{isDark:l,toggleTheme:u}=Mi(),d=Ys(),[p,g]=w.useState("buddies"),[y,b]=w.useState([]),[E,T]=w.useState([]),[L,W]=w.useState([]),[H,B]=w.useState(""),[K,G]=w.useState([]),[Q,he]=w.useState([]),[Ee,ge]=w.useState(!0),[C,j]=w.useState(null),[R,V]=w.useState(null),O=w.useCallback((J,P="info")=>{V({message:J,type:P}),setTimeout(()=>V(null),3500)},[]);w.useEffect(()=>{!i&&(!s||!e)&&d("/")},[s,e,i,d]);const D=w.useCallback(async()=>{if(t){ge(!0);try{const J=t.id,re=(await Ht(ht(ye,"clients"))).docs.map(Oe=>({id:Oe.id,...Oe.data()}));he(re);const we=Object.fromEntries(re.map(Oe=>[Oe.id,Oe])),_e=await Ht(Yt(ht(ye,"buddies"),xt("user1","==",J))),xe=await Ht(Yt(ht(ye,"buddies"),xt("user2","==",J))),Se=new Set;[..._e.docs,...xe.docs].forEach(Oe=>{const Mt=Oe.data(),cn=Mt.user1===J?Mt.user2:Mt.user1;Se.add(cn)}),b(Array.from(Se).map(Oe=>we[Oe]).filter(Boolean));const Fe=await Ht(Yt(ht(ye,"buddyRequests"),xt("toId","==",J),xt("status","==","pending")));T(Fe.docs.map(Oe=>({reqId:Oe.id,...Oe.data(),fromClient:we[Oe.data().fromId]})).filter(Oe=>Oe.fromClient));const Ze=await Ht(Yt(ht(ye,"buddyRequests"),xt("fromId","==",J),xt("status","==","pending")));W(Ze.docs.map(Oe=>({reqId:Oe.id,...Oe.data(),toClient:we[Oe.data().toId]})).filter(Oe=>Oe.toClient))}catch(J){console.error("Error fetching buddy data:",J),O("Failed to load buddies","error")}finally{ge(!1)}}},[t,O]);w.useEffect(()=>{D()},[D]),w.useEffect(()=>{if(!H.trim()||!t){G([]);return}const J=H.toLowerCase(),P=t.id,re=new Set(y.map(Se=>Se.id)),we=new Set(L.map(Se=>Se.toId)),_e=new Set(E.map(Se=>Se.fromId)),xe=Q.filter(Se=>Se.id===P||!Se.name||!Se.coreBuddyAccess&&Se.clientType!=="core_buddy"?!1:Se.name.toLowerCase().includes(J)).map(Se=>({...Se,isBuddy:re.has(Se.id),isPendingOut:we.has(Se.id),isPendingIn:_e.has(Se.id)})).slice(0,20);G(xe)},[H,Q,y,L,E,t]);const A=async(J,P)=>{if(!(!t||J===t.id))try{await mr(ht(ye,"notifications"),{toId:J,fromId:t.id,fromName:t.name||"Someone",fromPhotoURL:t.photoURL||null,type:P,read:!1,createdAt:Rs()})}catch(re){console.error("Notification error:",re),re.code==="permission-denied"&&O("Notifications blocked  check Firestore rules","error")}},Le=async J=>{j(J);try{const P=`${t.id}_${J}`;await Ts(We(ye,"buddyRequests",P),{fromId:t.id,toId:J,status:"pending",createdAt:Rs()}),await A(J,"buddy_request"),O("Buddy request sent!","success"),await D()}catch(P){console.error("Error sending request:",P),O("Failed to send request","error")}finally{j(null)}},Je=async J=>{j(J.reqId);try{const P=Zw(J.fromId,t.id);await Ts(We(ye,"buddies",P),{user1:[J.fromId,t.id].sort()[0],user2:[J.fromId,t.id].sort()[1],connectedAt:Rs()}),await Sr(We(ye,"buddyRequests",J.reqId)),await A(J.fromId,"buddy_accept"),O("Buddy added!","success"),await D()}catch(P){console.error("Error accepting request:",P),O("Failed to accept","error")}finally{j(null)}},X=async J=>{j(J.reqId);try{await Sr(We(ye,"buddyRequests",J.reqId)),O("Request declined","info"),await D()}catch(P){console.error("Error declining:",P),O("Failed to decline","error")}finally{j(null)}},je=async J=>{j(J.reqId);try{await Sr(We(ye,"buddyRequests",J.reqId)),O("Request cancelled","info"),await D()}catch(P){console.error("Error cancelling:",P),O("Failed to cancel","error")}finally{j(null)}},De=async J=>{j(J);try{const P=Zw(t.id,J);await Sr(We(ye,"buddies",P)),O("Buddy removed","info"),await D()}catch(P){console.error("Error removing buddy:",P),O("Failed to remove buddy","error")}finally{j(null)}},Ce=E.length;return i?a.jsx("div",{className:"bdy-loading",children:a.jsx("div",{className:"bdy-spinner"})}):!s||!e||!t?null:a.jsx(Jo,{children:a.jsxs("div",{className:"bdy-page","data-theme":l?"dark":"light",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>d("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"bdy-main",children:[a.jsx("h1",{className:"bdy-title",children:"Buddies"}),a.jsxs("button",{className:"bdy-leaderboard-link",onClick:()=>d("/client/leaderboard"),children:[a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5C7 4 7 7 7 7"}),a.jsx("path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5C17 4 17 7 17 7"}),a.jsx("rect",{x:"6",y:"9",width:"12",height:"13",rx:"2"}),a.jsx("path",{d:"M12 9v13"}),a.jsx("path",{d:"M2 22h20"})]}),a.jsx("span",{children:"Leaderboard"}),a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),a.jsxs("div",{className:"bdy-tabs",children:[a.jsxs("button",{className:`bdy-tab${p==="buddies"?" active":""}`,onClick:()=>g("buddies"),children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"9",cy:"7",r:"4"}),a.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),a.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),a.jsx("span",{children:"My Buddies"})]}),a.jsxs("button",{className:`bdy-tab${p==="requests"?" active":""}`,onClick:()=>g("requests"),children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"9",cy:"7",r:"4"}),a.jsx("line",{x1:"19",y1:"8",x2:"19",y2:"14"}),a.jsx("line",{x1:"22",y1:"11",x2:"16",y2:"11"})]}),a.jsx("span",{children:"Requests"}),Ce>0&&a.jsx("span",{className:"bdy-tab-badge",children:Ce})]}),a.jsxs("button",{className:`bdy-tab${p==="search"?" active":""}`,onClick:()=>g("search"),children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"11",cy:"11",r:"8"}),a.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),a.jsx("span",{children:"Find"})]})]}),Ee?a.jsx("div",{className:"bdy-content-loading",children:a.jsx("div",{className:"bdy-spinner"})}):a.jsxs(a.Fragment,{children:[p==="buddies"&&a.jsx("div",{className:"bdy-section",children:y.length===0?a.jsxs("div",{className:"bdy-empty",children:[a.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"9",cy:"7",r:"4"}),a.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),a.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),a.jsx("h3",{children:"No buddies yet"}),a.jsx("p",{children:"Find members and send buddy requests to connect!"}),a.jsx("button",{className:"bdy-empty-btn",onClick:()=>g("search"),children:"Find Buddies"})]}):a.jsx("div",{className:"bdy-list",children:y.map(J=>a.jsxs("div",{className:"bdy-card",onClick:()=>d(`/client/core-buddy/profile/${J.id}`),children:[a.jsx("div",{className:"bdy-avatar",children:J.photoURL?a.jsx("img",{src:J.photoURL,alt:J.name}):a.jsx("span",{children:gh(J.name)})}),a.jsx("div",{className:"bdy-card-info",children:a.jsx("span",{className:"bdy-card-name",children:J.name})}),a.jsx("button",{className:"bdy-remove-btn",onClick:P=>{P.stopPropagation(),De(J.id)},disabled:C===J.id,"aria-label":"Remove buddy",children:C===J.id?a.jsx("div",{className:"bdy-btn-spinner"}):a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]},J.id))})}),p==="requests"&&a.jsxs("div",{className:"bdy-section",children:[E.length>0&&a.jsxs(a.Fragment,{children:[a.jsx("h3",{className:"bdy-section-title",children:"Incoming"}),a.jsx("div",{className:"bdy-list",children:E.map(J=>a.jsxs("div",{className:"bdy-card",children:[a.jsx("div",{className:"bdy-avatar",children:J.fromClient.photoURL?a.jsx("img",{src:J.fromClient.photoURL,alt:J.fromClient.name}):a.jsx("span",{children:gh(J.fromClient.name)})}),a.jsxs("div",{className:"bdy-card-info",children:[a.jsx("span",{className:"bdy-card-name",children:J.fromClient.name}),a.jsx("span",{className:"bdy-card-sub",children:"wants to be your buddy"})]}),a.jsxs("div",{className:"bdy-action-pair",children:[a.jsx("button",{className:"bdy-accept-btn",onClick:()=>Je(J),disabled:C===J.reqId,children:C===J.reqId?a.jsx("div",{className:"bdy-btn-spinner"}):a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:a.jsx("path",{d:"M5 13l4 4L19 7"})})}),a.jsx("button",{className:"bdy-decline-btn",onClick:()=>X(J),disabled:C===J.reqId,children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]})]},J.reqId))})]}),L.length>0&&a.jsxs(a.Fragment,{children:[a.jsx("h3",{className:"bdy-section-title",children:"Sent"}),a.jsx("div",{className:"bdy-list",children:L.map(J=>a.jsxs("div",{className:"bdy-card",children:[a.jsx("div",{className:"bdy-avatar",children:J.toClient?.photoURL?a.jsx("img",{src:J.toClient.photoURL,alt:J.toClient.name}):a.jsx("span",{children:gh(J.toClient?.name)})}),a.jsxs("div",{className:"bdy-card-info",children:[a.jsx("span",{className:"bdy-card-name",children:J.toClient?.name}),a.jsx("span",{className:"bdy-card-sub",children:"pending"})]}),a.jsx("button",{className:"bdy-cancel-btn",onClick:()=>je(J),disabled:C===J.reqId,children:C===J.reqId?a.jsx("div",{className:"bdy-btn-spinner"}):"Cancel"})]},J.reqId))})]}),E.length===0&&L.length===0&&a.jsxs("div",{className:"bdy-empty",children:[a.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[a.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),a.jsx("path",{d:"M22 4L12 14.01l-3-3"})]}),a.jsx("h3",{children:"No pending requests"}),a.jsx("p",{children:"All caught up!"})]})]}),p==="search"&&a.jsxs("div",{className:"bdy-section",children:[a.jsxs("div",{className:"bdy-search-bar",children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"11",cy:"11",r:"8"}),a.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),a.jsx("input",{type:"text",placeholder:"Search by name...",value:H,onChange:J=>B(J.target.value),autoFocus:!0}),H&&a.jsx("button",{className:"bdy-search-clear",onClick:()=>B(""),children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),H.trim()&&K.length===0&&a.jsx("div",{className:"bdy-empty bdy-empty-sm",children:a.jsxs("p",{children:['No members found for "',H,'"']})}),K.length>0&&a.jsx("div",{className:"bdy-list",children:K.map(J=>a.jsxs("div",{className:"bdy-card",onClick:()=>d(`/client/core-buddy/profile/${J.id}`),children:[a.jsx("div",{className:"bdy-avatar",children:J.photoURL?a.jsx("img",{src:J.photoURL,alt:J.name}):a.jsx("span",{children:gh(J.name)})}),a.jsxs("div",{className:"bdy-card-info",children:[a.jsx("span",{className:"bdy-card-name",children:J.name}),J.isBuddy&&a.jsx("span",{className:"bdy-card-badge",children:"Buddy"})]}),J.isBuddy?a.jsx("span",{className:"bdy-status-icon",children:a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"var(--color-success)",strokeWidth:"2.5",children:a.jsx("path",{d:"M5 13l4 4L19 7"})})}):J.isPendingOut?a.jsx("span",{className:"bdy-pending-label",children:"Pending"}):J.isPendingIn?a.jsx("button",{className:"bdy-accept-btn",onClick:P=>{P.stopPropagation();const re=E.find(we=>we.fromId===J.id);re&&Je(re)},disabled:!!C,children:a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:a.jsx("path",{d:"M5 13l4 4L19 7"})})}):a.jsx("button",{className:"bdy-add-btn",onClick:P=>{P.stopPropagation(),Le(J.id)},disabled:C===J.id,children:C===J.id?a.jsx("div",{className:"bdy-btn-spinner"}):a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),a.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})})]},J.id))})]})]})]}),a.jsx(Yr,{}),R&&a.jsxs("div",{className:`toast-notification ${R.type}`,children:[a.jsx("span",{className:"toast-icon",children:R.type==="success"?a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M5 13 L9 17 L19 7"})}):R.type==="error"?a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]}):a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),a.jsx("circle",{cx:"12",cy:"16",r:"1",fill:"currentColor"})]})}),a.jsx("span",{className:"toast-message",children:R.message})]})]})})}function yh(s){if(!s)return"?";const e=s.trim().split(/\s+/);return e.length===1?e[0][0].toUpperCase():(e[0][0]+e[e.length-1][0]).toUpperCase()}function ig(s,e){return[s,e].sort().join("_")}const k5=5;function ag(s){return s.toISOString().split("T")[0]}function ex(s){if(!s)return"";const e=s instanceof Date?s:s.toDate?s.toDate():new Date(s),t=Math.floor((new Date-e)/1e3);return t<60?"just now":t<3600?`${Math.floor(t/60)}m ago`:t<86400?`${Math.floor(t/3600)}h ago`:t<604800?`${Math.floor(t/86400)}d ago`:e.toLocaleDateString("en-GB",{day:"numeric",month:"short"})}function E5(){const{userId:s}=wS(),{currentUser:e,isClient:t,clientData:i,loading:l}=Ar(),{isDark:u,toggleTheme:d}=Mi(),p=Ys(),[g,y]=w.useState(null),[b,E]=w.useState("none"),[T,L]=w.useState(null),[W,H]=w.useState(!0),[B,K]=w.useState(!1),[G,Q]=w.useState(null),[he,Ee]=w.useState([]),[ge,C]=w.useState(!1),[j,R]=w.useState(new Set),[V,O]=w.useState(new Set),[D,A]=w.useState({}),[Le,Je]=w.useState({}),[X,je]=w.useState({}),[De,Ce]=w.useState(!0),[J,P]=w.useState(0),[re,we]=w.useState(0),[_e,xe]=w.useState(0),[Se,Fe]=w.useState([]),[Ze,Oe]=w.useState(!1),[Mt,cn]=w.useState(null),[qn,Qt]=w.useState([]),rt=w.useCallback((se,Ae="info")=>{Q({message:se,type:Ae}),setTimeout(()=>Q(null),3500)},[]);w.useEffect(()=>{!l&&(!e||!t)&&p("/")},[e,t,l,p]),w.useEffect(()=>{i&&s&&i.id===s&&p("/client/core-buddy",{replace:!0})},[i,s,p]),w.useEffect(()=>{if(!i||!s||i.id===s)return;let se=!1;return(async()=>{H(!0);try{const vt=(await Ht(ht(ye,"clients"))).docs.map($e=>({id:$e.id,...$e.data()})).find($e=>$e.id===s);if(!vt){se||H(!1);return}se||y(vt);const ut=i.id,He=ig(ut,s);if((await Es(We(ye,"buddies",He))).exists())se||E("buddy");else{const $e=`${ut}_${s}`,rn=await Es(We(ye,"buddyRequests",$e));if(rn.exists()&&rn.data().status==="pending")se||(E("pending_out"),L($e));else{const Jt=`${s}_${ut}`,Rn=await Es(We(ye,"buddyRequests",Jt));Rn.exists()&&Rn.data().status==="pending"?se||(E("pending_in"),L(Jt)):se||E("none")}}}catch(Ae){console.error("Error loading profile:",Ae)}finally{se||H(!1)}})(),()=>{se=!0}},[i,s]),w.useEffect(()=>{if(!s||!g)return;let se=!1;return(async()=>{Ce(!0);try{const Ae=await Ht(Yt(ht(ye,"workoutLogs"),xt("clientId","==",s)));if(se)return;const gt=Ae.docs.length;P(gt);let vt=0;const ut=Ae.docs.map(nt=>nt.data().date).filter(Boolean).sort().reverse();if(ut.length>0){const nt=new Date;let $e=new Date(nt);for(let rn=0;rn<52;rn++){const Jt=new Date($e),Rn=Jt.getDay(),On=Rn===0?6:Rn-1;Jt.setDate(Jt.getDate()-On),Jt.setHours(0,0,0,0);const Kn=new Date(Jt);Kn.setDate(Kn.getDate()+7);const Zt=ag(Jt),Hn=ag(Kn);if(ut.some(yn=>yn>=Zt&&yn<Hn))vt++;else{if(rn>0)break;break}$e.setDate($e.getDate()-7)}}se||we(vt);let He=0;for(let nt=0;nt<30;nt++){const $e=new Date;$e.setDate($e.getDate()-nt);const rn=ag($e);try{const Jt=await Ht(Yt(ht(ye,"habitLogs"),xt("clientId","==",s),xt("date","==",rn)));if(Jt.empty)break;{const Rn=Jt.docs[0].data().habits||{};if(Object.values(Rn).filter(Boolean).length>=k5)He++;else break}}catch{break}}se||xe(He)}catch(Ae){console.error("Error loading buddy stats:",Ae)}finally{se||Ce(!1)}})(),()=>{se=!0}},[s,g]),w.useEffect(()=>{if(!i)return;const se=i.id;(async()=>{try{const[Ae,gt,vt]=await Promise.all([Ht(Yt(ht(ye,"buddies"),xt("user1","==",se))),Ht(Yt(ht(ye,"buddies"),xt("user2","==",se))),Ht(ht(ye,"clients"))]),ut=new Set;[...Ae.docs,...gt.docs].forEach(nt=>{const $e=nt.data();ut.add($e.user1===se?$e.user2:$e.user1)});const He={};vt.docs.forEach(nt=>{He[nt.id]=nt.data()}),Fe(Array.from(ut).filter(nt=>He[nt]).map(nt=>({id:nt,name:He[nt].name,photoURL:He[nt].photoURL||null})))}catch(Ae){console.error("Error loading buddies for mentions:",Ae)}})()},[i]);const st=async(se,Ae,gt={})=>{if(!(!i||se===i.id))try{await mr(ht(ye,"notifications"),{toId:se,fromId:i.id,fromName:i.name||"Someone",fromPhotoURL:i.photoURL||null,type:Ae,read:!1,createdAt:Rs(),...gt})}catch(vt){console.error("Notification error:",vt),vt.code==="permission-denied"&&rt("Notifications blocked  check Firestore rules","error")}},ct=async()=>{K(!0);try{const se=`${i.id}_${s}`;await Ts(We(ye,"buddyRequests",se),{fromId:i.id,toId:s,status:"pending",createdAt:Rs()}),await st(s,"buddy_request"),E("pending_out"),L(se),rt("Buddy request sent!","success")}catch(se){console.error(se),rt("Failed to send request","error")}finally{K(!1)}},En=async()=>{if(T){K(!0);try{const se=ig(i.id,s);await Ts(We(ye,"buddies",se),{user1:[i.id,s].sort()[0],user2:[i.id,s].sort()[1],connectedAt:Rs()}),await Sr(We(ye,"buddyRequests",T)),await st(s,"buddy_accept"),E("buddy"),rt("Buddy added!","success")}catch(se){console.error(se),rt("Failed to accept","error")}finally{K(!1)}}},fe=async()=>{if(T){K(!0);try{await Sr(We(ye,"buddyRequests",T)),E("none"),rt(b==="pending_out"?"Request cancelled":"Request declined","info")}catch(se){console.error(se),rt("Failed","error")}finally{K(!1)}}},Ct=async()=>{K(!0);try{const se=ig(i.id,s);await Sr(We(ye,"buddies",se)),E("none"),rt("Buddy removed","info")}catch(se){console.error(se),rt("Failed to remove","error")}finally{K(!1)}},ft=w.useCallback(async()=>{if(s){C(!0);try{const se=await Ht(Yt(ht(ye,"posts"),xt("authorId","==",s),ku("createdAt","desc"),Eu(30)));if(Ee(se.docs.map(Ae=>({id:Ae.id,...Ae.data()}))),i){const Ae=await Ht(Yt(ht(ye,"postLikes"),xt("userId","==",i.id)));R(new Set(Ae.docs.map(gt=>gt.data().postId)))}}catch(se){console.error("Error loading journey:",se)}finally{C(!1)}}},[s,i]);w.useEffect(()=>{!W&&g&&ft()},[W,g,ft]);const Rt=async se=>{if(window.confirm("Delete this post?"))try{await Sr(We(ye,"posts",se)),Ee(Ae=>Ae.filter(gt=>gt.id!==se)),rt("Post deleted","info")}catch(Ae){console.error("Delete error:",Ae),rt("Failed to delete","error")}},Qe=async se=>{if(!i)return;const Ae=i.id,gt=`${se}_${Ae}`,vt=j.has(se),ut=new Set(j);vt?ut.delete(se):ut.add(se),R(ut),Ee(He=>He.map(nt=>nt.id===se?{...nt,likeCount:Math.max(0,(nt.likeCount||0)+(vt?-1:1))}:nt));try{if(vt)await Sr(We(ye,"postLikes",gt)),await ls(We(ye,"posts",se),{likeCount:Ro(-1)});else{await Ts(We(ye,"postLikes",gt),{postId:se,userId:Ae,createdAt:Rs()}),await ls(We(ye,"posts",se),{likeCount:Ro(1)});const He=he.find(nt=>nt.id===se);He&&st(He.authorId,"like",{postId:se})}}catch(He){console.error("Like error:",He),ft()}},Tt=async se=>{try{const Ae=await Ht(Yt(ht(ye,"postComments"),xt("postId","==",se),ku("createdAt","asc"),Eu(50)));A(gt=>({...gt,[se]:Ae.docs.map(vt=>({id:vt.id,...vt.data()}))}))}catch(Ae){console.error("Error loading comments:",Ae)}},pt=se=>{const Ae=new Set(V);Ae.has(se)?Ae.delete(se):(Ae.add(se),D[se]||Tt(se)),O(Ae)},Xt=(se,Ae)=>{const gt=se.match(/@(\w*)$/);if(gt){Oe(!0),cn(Ae);const vt=Se.filter(ut=>ut.name&&ut.name.toLowerCase().includes(gt[1].toLowerCase())).slice(0,5);Qt(vt)}else Oe(!1),Qt([])},zs=(se,Ae)=>{const vt=(Le[Ae]||"").replace(/@\w*$/,`@${se.name} `);Je(ut=>({...ut,[Ae]:vt})),Oe(!1),Qt([])},es=(se,Ae)=>{Je(gt=>({...gt,[se]:Ae})),Xt(Ae,se)},Wt=async se=>{const Ae=(Le[se]||"").trim();if(!(!Ae||!i)){je(gt=>({...gt,[se]:!0}));try{await mr(ht(ye,"postComments"),{postId:se,authorId:i.id,authorName:i.name||"Unknown",authorPhotoURL:i.photoURL||null,content:Ae,createdAt:Rs()}),await ls(We(ye,"posts",se),{commentCount:Ro(1)});const gt=he.find(ut=>ut.id===se);gt&&st(gt.authorId,"comment",{postId:se});const vt=Ae.match(/@[\w\s]+?(?=\s@|\s*$|[.,!?])/g);if(vt){const ut=new Set;vt.forEach(He=>{const nt=He.slice(1).trim(),$e=Se.find(rn=>rn.name&&rn.name.toLowerCase()===nt.toLowerCase());$e&&!ut.has($e.id)&&(ut.add($e.id),st($e.id,"mention",{postId:se}))})}Je(ut=>({...ut,[se]:""})),Ee(ut=>ut.map(He=>He.id===se?{...He,commentCount:(He.commentCount||0)+1}:He)),await Tt(se)}catch(gt){console.error("Comment error:",gt),rt("Failed to comment","error")}finally{je(gt=>({...gt,[se]:!1}))}}};return l||W||!i?a.jsx("div",{className:"prf-loading","data-theme":u?"dark":"light",children:a.jsx("div",{className:"prf-spinner"})}):!e||!t?null:g?a.jsx(Jo,{children:a.jsxs("div",{className:"prf-page","data-theme":u?"dark":"light",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>p(-1),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:d,"aria-label":"Toggle theme",children:u?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"prf-main",children:[a.jsxs("div",{className:"prf-hero",children:[a.jsx("div",{className:"prf-avatar-lg",children:g.photoURL?a.jsx("img",{src:g.photoURL,alt:g.name}):a.jsx("span",{children:yh(g.name)})}),a.jsx("h1",{className:"prf-name",children:g.name}),a.jsxs("div",{className:"prf-buddy-action",children:[b==="none"&&a.jsx("button",{className:"prf-btn prf-btn-primary",onClick:ct,disabled:B,children:B?a.jsx("div",{className:"prf-btn-spinner"}):a.jsxs(a.Fragment,{children:[a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),a.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),"Add Buddy"]})}),b==="pending_out"&&a.jsx("button",{className:"prf-btn prf-btn-secondary",onClick:fe,disabled:B,children:B?a.jsx("div",{className:"prf-btn-spinner dark"}):"Cancel Request"}),b==="pending_in"&&a.jsxs("div",{className:"prf-btn-pair",children:[a.jsx("button",{className:"prf-btn prf-btn-success",onClick:En,disabled:B,children:B?a.jsx("div",{className:"prf-btn-spinner"}):"Accept"}),a.jsx("button",{className:"prf-btn prf-btn-secondary",onClick:fe,disabled:B,children:"Decline"})]}),b==="buddy"&&a.jsx("button",{className:"prf-btn prf-btn-danger",onClick:Ct,disabled:B,children:B?a.jsx("div",{className:"prf-btn-spinner"}):"Remove Buddy"})]})]}),De?a.jsx("div",{className:"prf-stats-loading",children:a.jsx("div",{className:"prf-spinner"})}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"prf-stats",children:[a.jsxs("div",{className:"prf-stat",children:[a.jsx("span",{className:"prf-stat-value",children:J}),a.jsx("span",{className:"prf-stat-label",children:"Workouts"})]}),a.jsxs("div",{className:"prf-stat",children:[a.jsxs("span",{className:"prf-stat-value",children:[re,a.jsx("span",{className:"prf-stat-unit",children:"wk"})]}),a.jsx("span",{className:"prf-stat-label",children:"Streak"})]})]}),_e>0&&a.jsx("div",{className:"prf-info-row",children:a.jsxs("div",{className:"prf-info-card info-habit",children:[a.jsx("div",{className:"prf-info-icon",children:a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),a.jsx("path",{d:"M22 4L12 14.01l-3-3"})]})}),a.jsxs("div",{className:"prf-info-text",children:[a.jsxs("span",{className:"prf-info-value",children:[_e," day",_e!==1?"s":""]}),a.jsx("span",{className:"prf-info-sub",children:"Habit Streak"})]})]})})]}),a.jsxs("div",{className:"prf-section",children:[a.jsx("h2",{className:"prf-section-title",children:`${g.name?.split(" ")[0]}'s Journey`}),ge?a.jsx("div",{className:"journey-loading",children:a.jsx("div",{className:"prf-spinner"})}):he.length===0?a.jsxs("div",{className:"journey-empty",children:[a.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),a.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),a.jsx("path",{d:"M21 15l-5-5L5 21"})]}),a.jsx("p",{children:"No posts yet"})]}):a.jsx("div",{className:"journey-list",children:he.map(se=>a.jsxs("div",{className:"journey-post",children:[a.jsxs("div",{className:"journey-post-header",children:[a.jsx("div",{className:"journey-post-avatar",children:se.authorPhotoURL?a.jsx("img",{src:se.authorPhotoURL,alt:""}):a.jsx("span",{children:yh(se.authorName)})}),a.jsxs("div",{className:"journey-post-meta",children:[a.jsx("span",{className:"journey-post-name",children:se.authorName}),a.jsx("span",{className:"journey-post-time",children:ex(se.createdAt)})]}),se.authorId===i.id&&a.jsx("button",{className:"journey-delete-btn",onClick:()=>Rt(se.id),"aria-label":"Delete post",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M3 6h18"}),a.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),a.jsx("path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]}),se.type==="workout_summary"&&se.metadata?a.jsxs("div",{className:"journey-card",children:[a.jsx("div",{className:"journey-card-logo-frame",children:a.jsx("img",{src:"/Logo.webp",alt:"MCF",className:"journey-card-logo-img"})}),a.jsx("h3",{className:"journey-card-title",children:se.metadata.title}),se.metadata.stats?.length>0&&a.jsx("p",{className:"journey-card-stats-line",children:se.metadata.stats.map(Ae=>`${Ae.value} ${Ae.label}`).join("    ")}),!se.metadata.stats?.length&&se.metadata.subtitle&&a.jsx("p",{className:"journey-card-stats-line",children:se.metadata.subtitle}),a.jsx("p",{className:"journey-card-cta",children:"I just completed a workout using Core Buddy "}),a.jsx("p",{className:"journey-card-slogan",children:"Make It Count with Core Buddy"})]}):se.type==="badge_earned"&&se.metadata?a.jsxs("div",{className:"journey-card",children:[a.jsx("div",{className:"journey-card-logo-frame journey-card-logo-badge",children:(()=>{const Ae=Ja.find(gt=>gt.id===se.metadata.badgeId);return Ae?.img?a.jsx("img",{src:Ae.img,alt:se.metadata.title,className:"journey-card-logo-img"}):a.jsx("img",{src:"/Logo.webp",alt:se.metadata.title,className:"journey-card-logo-img"})})()}),a.jsx("h3",{className:"journey-card-title",children:se.metadata.title}),se.metadata.badgeDesc&&a.jsx("p",{className:"journey-card-stats-line",children:se.metadata.badgeDesc}),a.jsx("p",{className:"journey-card-cta",children:"I just earned a badge on Core Buddy"}),a.jsx("p",{className:"journey-card-slogan",children:"Make It Count with Core Buddy"})]}):se.type==="habits_summary"&&se.metadata?a.jsxs("div",{className:"journey-card",children:[a.jsx("div",{className:"journey-card-logo-frame",children:a.jsx("img",{src:"/Logo.webp",alt:"MCF",className:"journey-card-logo-img"})}),a.jsx("h3",{className:"journey-card-title",children:se.metadata.title}),se.metadata.stats?.length>0&&a.jsx("p",{className:"journey-card-stats-line",children:se.metadata.stats.map(Ae=>`${Ae.value} ${Ae.label}`).join("    ")}),se.metadata.subtitle&&a.jsx("p",{className:"journey-card-stats-line",children:se.metadata.subtitle}),a.jsx("p",{className:"journey-card-cta",children:"I just completed my daily habits with Core Buddy "}),a.jsx("p",{className:"journey-card-slogan",children:"Make It Count with Core Buddy"})]}):a.jsxs(a.Fragment,{children:[se.content&&a.jsx("p",{className:"journey-post-content",children:se.content}),se.imageURL&&a.jsx("div",{className:"journey-post-image",children:a.jsx("img",{src:se.imageURL,alt:"Post",loading:"lazy"})})]}),a.jsxs("div",{className:"journey-post-actions",children:[a.jsxs("button",{className:`journey-action-btn${j.has(se.id)?" liked":""}`,onClick:()=>Qe(se.id),children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:j.has(se.id)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})}),a.jsx("span",{children:se.likeCount||0})]}),a.jsxs("button",{className:`journey-action-btn${V.has(se.id)?" active":""}`,onClick:()=>pt(se.id),children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})}),a.jsx("span",{children:se.commentCount||0})]})]}),V.has(se.id)&&a.jsxs("div",{className:"journey-comments",children:[D[se.id]?.length>0?D[se.id].map(Ae=>a.jsxs("div",{className:"journey-comment",children:[a.jsx("div",{className:"journey-comment-avatar",onClick:()=>p(`/client/core-buddy/profile/${Ae.authorId}`),children:Ae.authorPhotoURL?a.jsx("img",{src:Ae.authorPhotoURL,alt:""}):a.jsx("span",{children:yh(Ae.authorName)})}),a.jsxs("div",{className:"journey-comment-body",children:[a.jsxs("div",{className:"journey-comment-bubble",children:[a.jsx("span",{className:"journey-comment-name",children:Ae.authorName}),a.jsx("span",{className:"journey-comment-text",children:Ae.content})]}),a.jsx("span",{className:"journey-comment-time",children:ex(Ae.createdAt)})]})]},Ae.id)):a.jsx("p",{className:"journey-no-comments",children:"No comments yet"}),a.jsxs("div",{className:"journey-comment-input",style:{position:"relative"},children:[a.jsx("input",{type:"text",placeholder:"Comment... (@ to mention)",value:Le[se.id]||"",onChange:Ae=>es(se.id,Ae.target.value),onKeyDown:Ae=>{Ae.key==="Enter"&&Wt(se.id)},maxLength:300}),Ze&&Mt===se.id&&qn.length>0&&a.jsx("div",{className:"mention-dropdown mention-dropdown-up",children:qn.map(Ae=>a.jsxs("button",{className:"mention-option",onClick:()=>zs(Ae,se.id),children:[a.jsx("div",{className:"mention-option-avatar",children:Ae.photoURL?a.jsx("img",{src:Ae.photoURL,alt:""}):a.jsx("span",{children:yh(Ae.name)})}),a.jsx("span",{children:Ae.name})]},Ae.id))}),a.jsx("button",{onClick:()=>Wt(se.id),disabled:!(Le[se.id]||"").trim()||X[se.id],children:X[se.id]?a.jsx("div",{className:"journey-btn-spinner-sm"}):a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"22",y1:"2",x2:"11",y2:"13"}),a.jsx("polygon",{points:"22 2 15 22 11 13 2 9 22 2"})]})})]})]})]},se.id))})]})]}),a.jsx(Yr,{}),G&&a.jsxs("div",{className:`toast-notification ${G.type}`,children:[a.jsx("span",{className:"toast-icon",children:G.type==="success"?a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M5 13 L9 17 L19 7"})}):G.type==="error"?a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]}):a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),a.jsx("circle",{cx:"12",cy:"16",r:"1",fill:"currentColor"})]})}),a.jsx("span",{className:"toast-message",children:G.message})]})]})}):a.jsxs("div",{className:"prf-page","data-theme":u?"dark":"light",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>p(-1),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions"})]})}),a.jsx("main",{className:"prf-main",children:a.jsx("p",{style:{textAlign:"center",color:"var(--text-tertiary)",padding:"40px 0"},children:"User not found"})}),a.jsx(Yr,{})]})}const og=[{text:"Build your dashboard...",bold:"your way"},{text:"Pick what matters to you...",bold:"nothing else"},{text:"Your goals, your layout...",bold:"your rules"}],tx=[{id:"stats",label:"Stats Rings",desc:"Programme %, workouts this week, habits today",icon:"rings",defaultOn:!0},{id:"workouts",label:"Workouts",desc:"Sessions this week and total count",icon:"dumbbell",defaultOn:!0},{id:"habits",label:"Habits",desc:"Daily habit tracker dots",icon:"check",defaultOn:!0},{id:"pbs",label:"Personal Bests",desc:"Your top lifts at a glance",icon:"trophy"},{id:"nutrition",label:"Nutrition",desc:"Macro rings  protein, carbs, fats, cals",icon:"apple"},{id:"leaderboard",label:"Leaderboard",desc:"See where you rank among buddies",icon:"podium"},{id:"journey",label:"Journey",desc:"Your posts, likes and comments feed",icon:"feed"},{id:"coach",label:"Coach Message",desc:"Motivational nudge from Buddy",icon:"message",defaultOn:!0},{id:"nudge",label:"Smart Nudge",desc:"Contextual reminder of what to do next",icon:"lightbulb"}];function T5(s){switch(s){case"rings":return a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("circle",{cx:"12",cy:"12",r:"6"}),a.jsx("circle",{cx:"12",cy:"12",r:"2"})]});case"dumbbell":return a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M6.5 6.5h11v11h-11z",strokeLinejoin:"round"}),a.jsx("line",{x1:"2",y1:"12",x2:"6.5",y2:"12"}),a.jsx("line",{x1:"17.5",y1:"12",x2:"22",y2:"12"})]});case"check":return a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("polyline",{points:"20 6 9 17 4 12"})});case"trophy":return a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M6 9H3V6a1 1 0 0 1 1-1h2M18 9h3V6a1 1 0 0 0-1-1h-2"}),a.jsx("path",{d:"M6 5h12v7a6 6 0 0 1-12 0V5z"}),a.jsx("path",{d:"M9 21h6"}),a.jsx("path",{d:"M12 17v4"})]});case"apple":return a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M12 3c-1.5 0-3 1-3 1s-3-.5-4.5 1.5S3 9 3 12s1.5 6 3 8 3 3 6 3 4.5-1 6-3 3-5 3-8-1.5-4-3-6.5S13.5 3 12 3z"}),a.jsx("path",{d:"M12 3c0 0 1-2 3-2"})]});case"podium":return a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("rect",{x:"2",y:"14",width:"6",height:"8",rx:"1"}),a.jsx("rect",{x:"9",y:"8",width:"6",height:"14",rx:"1"}),a.jsx("rect",{x:"16",y:"11",width:"6",height:"11",rx:"1"})]});case"medal":return a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"15",r:"6"}),a.jsx("path",{d:"M8.21 13.89L7 2h10l-1.21 11.89"})]});case"feed":return a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"3"}),a.jsx("line",{x1:"3",y1:"9",x2:"21",y2:"9"}),a.jsx("line",{x1:"3",y1:"15",x2:"21",y2:"15"})]});case"message":return a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})});case"lightbulb":return a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M9 18h6"}),a.jsx("path",{d:"M10 22h4"}),a.jsx("path",{d:"M12 2a7 7 0 0 0-4 12.7V17h8v-2.3A7 7 0 0 0 12 2z"})]});default:return null}}function j5(){const s=Ys(),{clientData:e,currentUser:t,updateClientData:i,resolveClient:l}=Ar(),[u,d]=w.useState({hours:0,minutes:0,seconds:0}),[p,g]=w.useState(0),[y,b]=w.useState(0),[E,T]=w.useState(null),[L,W]=w.useState(!1),H=w.useRef(null),[B,K]=w.useState(()=>{const D=e?.dashboardWidgets;return D&&Array.isArray(D)?D:tx.filter(A=>A.defaultOn).map(A=>A.id)}),[G,Q]=w.useState(!1),[he,Ee]=w.useState(!1),[ge,C]=w.useState(null);w.useEffect(()=>{e?.photoURL&&T(e.photoURL)},[e?.photoURL]),w.useEffect(()=>{const D=()=>{const Le=new Date,Je=new Date(Le);Je.setHours(23,59,59,999);const X=Je-Le;d({hours:Math.floor(X/36e5),minutes:Math.floor(X%36e5/6e4),seconds:Math.floor(X%6e4/1e3)}),g(60-Math.floor(X%6e4/1e3))};D();const A=setInterval(D,1e3);return()=>clearInterval(A)},[]),w.useEffect(()=>{const D=setInterval(()=>b(A=>(A+1)%og.length),8e3);return()=>clearInterval(D)},[]);const j=async D=>{const A=D.target.files?.[0];if(!(!A||!e?.id)){W(!0);try{const Le=Ga(Ka,`profilePhotos/${e.id}`);await Rh(Le,A);const Je=await Oo(Le);await ls(We(ye,"clients",e.id),{photoURL:Je}),T(Je),i({photoURL:Je})}catch(Le){console.error("Photo upload error:",Le)}finally{W(!1)}}},R=D=>{Ee(!1),K(A=>A.includes(D)?A.filter(Le=>Le!==D):[...A,D])},V=(D,A)=>{Ee(!1),K(Le=>{const Je=Le.indexOf(D);if(Je<0)return Le;const X=Je+A;if(X<0||X>=Le.length)return Le;const je=[...Le];return[je[Je],je[X]]=[je[X],je[Je]],je})},O=async()=>{Q(!0),C(null);try{const D=e||await l();if(!D?.id){C("Could not find your profile. Try refreshing."),Q(!1);return}await ls(We(ye,"clients",D.id),{dashboardWidgets:B}),i({dashboardWidgets:B}),Ee(!0)}catch(D){console.error("Save config error:",D),C("Save failed  please try again.")}finally{Q(!1)}};return a.jsx(Jo,{children:a.jsxs("div",{className:"bldr-page",children:[a.jsxs("div",{className:"bldr-container",children:[a.jsxs("div",{className:"bldr-header",children:[a.jsx("button",{className:"bldr-back",onClick:()=>s("/client/core-buddy"),children:a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("h1",{className:"bldr-title",children:"Build Your Dashboard"})]}),a.jsxs("div",{className:"bldr-ring-container",children:[a.jsxs("div",{className:"bldr-ring",children:[a.jsx("svg",{className:"bldr-ring-svg",viewBox:"0 0 200 200",children:TE.map((D,A)=>a.jsx("line",{x1:D.x1,y1:D.y1,x2:D.x2,y2:D.y2,className:`bldr-tick ${A<p?"elapsed":"remaining"}`,strokeWidth:D.thick?"3":"2"},A))}),a.jsxs("div",{className:"bldr-ring-center",children:[a.jsxs("div",{className:"bldr-ring-photo",onClick:()=>H.current?.click(),children:[a.jsx("img",{src:E||"/Logo.webp",alt:E?"Profile":"Mind Core Fitness"}),a.jsx("div",{className:`bldr-photo-overlay${L?" uploading":""}`,children:L?a.jsx("div",{className:"bldr-photo-spinner"}):a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"#fff",strokeWidth:"2",children:[a.jsx("path",{d:"M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"}),a.jsx("circle",{cx:"12",cy:"13",r:"4"})]})}),a.jsx("input",{ref:H,type:"file",accept:"image/*",onChange:j,style:{display:"none"}})]}),!E&&!L&&a.jsx("div",{className:"bldr-photo-badge",onClick:()=>H.current?.click(),children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"#fff",strokeWidth:"2.5",children:[a.jsx("path",{d:"M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"}),a.jsx("circle",{cx:"12",cy:"13",r:"4"})]})})]})]}),a.jsxs("div",{className:"bldr-countdown",children:[a.jsx("span",{className:"bldr-timer-digit",children:String(u.hours).padStart(2,"0")}),a.jsx("span",{className:"bldr-timer-colon",children:":"}),a.jsx("span",{className:"bldr-timer-digit",children:String(u.minutes).padStart(2,"0")}),a.jsx("span",{className:"bldr-timer-colon",children:":"}),a.jsx("span",{className:"bldr-timer-digit bldr-timer-sec",children:String(u.seconds).padStart(2,"0")})]}),a.jsx("span",{className:"bldr-ring-label",children:"remaining today"}),a.jsxs("p",{className:"bldr-tagline",children:[og[y].text," ",a.jsx("strong",{children:og[y].bold})]})]}),a.jsxs("div",{className:"bldr-section",children:[a.jsx("h2",{className:"bldr-section-title",children:"Choose Your Widgets"}),a.jsx("p",{className:"bldr-section-desc",children:"The countdown ring and your profile always stay at the top. Pick what goes below."}),a.jsx("div",{className:"bldr-widgets-list",children:tx.map(D=>{const A=B.includes(D.id),Le=B.indexOf(D.id);return a.jsxs("div",{className:`bldr-widget-card${A?" active":""}`,children:[a.jsx("div",{className:"bldr-widget-icon",children:T5(D.icon)}),a.jsxs("div",{className:"bldr-widget-info",children:[a.jsx("div",{className:"bldr-widget-label",children:D.label}),a.jsx("div",{className:"bldr-widget-desc",children:D.desc})]}),a.jsxs("div",{className:"bldr-widget-actions",children:[A&&a.jsxs("div",{className:"bldr-widget-order",children:[a.jsx("button",{className:"bldr-order-btn",onClick:()=>V(D.id,-1),disabled:Le===0,"aria-label":"Move up",children:a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:a.jsx("path",{d:"M18 15l-6-6-6 6"})})}),a.jsx("span",{className:"bldr-order-num",children:Le+1}),a.jsx("button",{className:"bldr-order-btn",onClick:()=>V(D.id,1),disabled:Le===B.length-1,"aria-label":"Move down",children:a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:a.jsx("path",{d:"M6 9l6 6 6-6"})})})]}),a.jsx("button",{className:`bldr-toggle${A?" on":""}`,onClick:()=>R(D.id),"aria-label":A?`Remove ${D.label}`:`Add ${D.label}`,children:a.jsx("div",{className:"bldr-toggle-thumb"})})]})]},D.id)})})]}),a.jsxs("div",{className:"bldr-save-wrap",children:[a.jsx("button",{className:`bldr-save-btn${he?" saved":""}`,onClick:O,disabled:G||he,children:G?"Saving...":he?"Saved":"Save Dashboard"}),ge&&a.jsx("p",{className:"bldr-save-error",children:ge}),he&&a.jsx("button",{className:"bldr-view-btn",onClick:()=>s("/client/core-buddy"),children:"View Dashboard"})]})]}),a.jsx(Yr,{active:"home"})]})})}const jE="@firebase/installations",p0="0.6.19";const SE=1e4,CE=`w:${p0}`,NE="FIS_v2",S5="https://firebaseinstallations.googleapis.com/v1",C5=3600*1e3,N5="installations",A5="Installations";const R5={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},qo=new $o(N5,A5,R5);function AE(s){return s instanceof hi&&s.code.includes("request-failed")}function RE({projectId:s}){return`${S5}/projects/${s}/installations`}function IE(s){return{token:s.token,requestStatus:2,expiresIn:M5(s.expiresIn),creationTime:Date.now()}}async function ME(s,e){const i=(await e.json()).error;return qo.create("request-failed",{requestName:s,serverCode:i.code,serverMessage:i.message,serverStatus:i.status})}function DE({apiKey:s}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":s})}function I5(s,{refreshToken:e}){const t=DE(s);return t.append("Authorization",D5(e)),t}async function LE(s){const e=await s();return e.status>=500&&e.status<600?s():e}function M5(s){return Number(s.replace("s","000"))}function D5(s){return`${NE} ${s}`}async function L5({appConfig:s,heartbeatServiceProvider:e},{fid:t}){const i=RE(s),l=DE(s),u=e.getImmediate({optional:!0});if(u){const y=await u.getHeartbeatsHeader();y&&l.append("x-firebase-client",y)}const d={fid:t,authVersion:NE,appId:s.appId,sdkVersion:CE},p={method:"POST",headers:l,body:JSON.stringify(d)},g=await LE(()=>fetch(i,p));if(g.ok){const y=await g.json();return{fid:y.fid||t,registrationStatus:2,refreshToken:y.refreshToken,authToken:IE(y.authToken)}}else throw await ME("Create Installation",g)}function OE(s){return new Promise(e=>{setTimeout(e,s)})}function O5(s){return btoa(String.fromCharCode(...s)).replace(/\+/g,"-").replace(/\//g,"_")}const P5=/^[cdef][\w-]{21}$/,Kg="";function V5(){try{const s=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(s),s[0]=112+s[0]%16;const t=U5(s);return P5.test(t)?t:Kg}catch{return Kg}}function U5(s){return O5(s).substr(0,22)}function Af(s){return`${s.appName}!${s.appId}`}const PE=new Map;function VE(s,e){const t=Af(s);UE(t,e),B5(t,e)}function UE(s,e){const t=PE.get(s);if(t)for(const i of t)i(e)}function B5(s,e){const t=z5();t&&t.postMessage({key:s,fid:e}),F5()}let Io=null;function z5(){return!Io&&"BroadcastChannel"in self&&(Io=new BroadcastChannel("[Firebase] FID Change"),Io.onmessage=s=>{UE(s.data.key,s.data.fid)}),Io}function F5(){PE.size===0&&Io&&(Io.close(),Io=null)}const q5="firebase-installations-database",H5=1,Ho="firebase-installations-store";let lg=null;function g0(){return lg||(lg=rf(q5,H5,{upgrade:(s,e)=>{e===0&&s.createObjectStore(Ho)}})),lg}async function ef(s,e){const t=Af(s),l=(await g0()).transaction(Ho,"readwrite"),u=l.objectStore(Ho),d=await u.get(t);return await u.put(e,t),await l.done,(!d||d.fid!==e.fid)&&VE(s,e.fid),e}async function BE(s){const e=Af(s),i=(await g0()).transaction(Ho,"readwrite");await i.objectStore(Ho).delete(e),await i.done}async function Rf(s,e){const t=Af(s),l=(await g0()).transaction(Ho,"readwrite"),u=l.objectStore(Ho),d=await u.get(t),p=e(d);return p===void 0?await u.delete(t):await u.put(p,t),await l.done,p&&(!d||d.fid!==p.fid)&&VE(s,p.fid),p}async function y0(s){let e;const t=await Rf(s.appConfig,i=>{const l=$5(i),u=W5(s,l);return e=u.registrationPromise,u.installationEntry});return t.fid===Kg?{installationEntry:await e}:{installationEntry:t,registrationPromise:e}}function $5(s){const e=s||{fid:V5(),registrationStatus:0};return zE(e)}function W5(s,e){if(e.registrationStatus===0){if(!navigator.onLine){const l=Promise.reject(qo.create("app-offline"));return{installationEntry:e,registrationPromise:l}}const t={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},i=G5(s,t);return{installationEntry:t,registrationPromise:i}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:K5(s)}:{installationEntry:e}}async function G5(s,e){try{const t=await L5(s,e);return ef(s.appConfig,t)}catch(t){throw AE(t)&&t.customData.serverCode===409?await BE(s.appConfig):await ef(s.appConfig,{fid:e.fid,registrationStatus:0}),t}}async function K5(s){let e=await nx(s.appConfig);for(;e.registrationStatus===1;)await OE(100),e=await nx(s.appConfig);if(e.registrationStatus===0){const{installationEntry:t,registrationPromise:i}=await y0(s);return i||t}return e}function nx(s){return Rf(s,e=>{if(!e)throw qo.create("installation-not-found");return zE(e)})}function zE(s){return Y5(s)?{fid:s.fid,registrationStatus:0}:s}function Y5(s){return s.registrationStatus===1&&s.registrationTime+SE<Date.now()}async function Q5({appConfig:s,heartbeatServiceProvider:e},t){const i=X5(s,t),l=I5(s,t),u=e.getImmediate({optional:!0});if(u){const y=await u.getHeartbeatsHeader();y&&l.append("x-firebase-client",y)}const d={installation:{sdkVersion:CE,appId:s.appId}},p={method:"POST",headers:l,body:JSON.stringify(d)},g=await LE(()=>fetch(i,p));if(g.ok){const y=await g.json();return IE(y)}else throw await ME("Generate Auth Token",g)}function X5(s,{fid:e}){return`${RE(s)}/${e}/authTokens:generate`}async function v0(s,e=!1){let t;const i=await Rf(s.appConfig,u=>{if(!FE(u))throw qo.create("not-registered");const d=u.authToken;if(!e&&eL(d))return u;if(d.requestStatus===1)return t=J5(s,e),u;{if(!navigator.onLine)throw qo.create("app-offline");const p=nL(u);return t=Z5(s,p),p}});return t?await t:i.authToken}async function J5(s,e){let t=await sx(s.appConfig);for(;t.authToken.requestStatus===1;)await OE(100),t=await sx(s.appConfig);const i=t.authToken;return i.requestStatus===0?v0(s,e):i}function sx(s){return Rf(s,e=>{if(!FE(e))throw qo.create("not-registered");const t=e.authToken;return sL(t)?{...e,authToken:{requestStatus:0}}:e})}async function Z5(s,e){try{const t=await Q5(s,e),i={...e,authToken:t};return await ef(s.appConfig,i),t}catch(t){if(AE(t)&&(t.customData.serverCode===401||t.customData.serverCode===404))await BE(s.appConfig);else{const i={...e,authToken:{requestStatus:0}};await ef(s.appConfig,i)}throw t}}function FE(s){return s!==void 0&&s.registrationStatus===2}function eL(s){return s.requestStatus===2&&!tL(s)}function tL(s){const e=Date.now();return e<s.creationTime||s.creationTime+s.expiresIn<e+C5}function nL(s){const e={requestStatus:1,requestTime:Date.now()};return{...s,authToken:e}}function sL(s){return s.requestStatus===1&&s.requestTime+SE<Date.now()}async function rL(s){const e=s,{installationEntry:t,registrationPromise:i}=await y0(e);return i?i.catch(console.error):v0(e).catch(console.error),t.fid}async function iL(s,e=!1){const t=s;return await aL(t),(await v0(t,e)).token}async function aL(s){const{registrationPromise:e}=await y0(s);e&&await e}function oL(s){if(!s||!s.options)throw cg("App Configuration");if(!s.name)throw cg("App Name");const e=["projectId","apiKey","appId"];for(const t of e)if(!s.options[t])throw cg(t);return{appName:s.name,projectId:s.options.projectId,apiKey:s.options.apiKey,appId:s.options.appId}}function cg(s){return qo.create("missing-app-config-values",{valueName:s})}const qE="installations",lL="installations-internal",cL=s=>{const e=s.getProvider("app").getImmediate(),t=oL(e),i=Wo(e,"heartbeat");return{app:e,appConfig:t,heartbeatServiceProvider:i,_delete:()=>Promise.resolve()}},uL=s=>{const e=s.getProvider("app").getImmediate(),t=Wo(e,qE).getImmediate();return{getId:()=>rL(t),getToken:l=>iL(t,l)}};function dL(){li(new Kr(qE,cL,"PUBLIC")),li(new Kr(lL,uL,"PRIVATE"))}dL();pr(jE,p0);pr(jE,p0,"esm2020");const hL="/firebase-messaging-sw.js",fL="/firebase-cloud-messaging-push-scope",HE="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",mL="https://fcmregistrations.googleapis.com/v1",$E="google.c.a.c_id",pL="google.c.a.c_l",gL="google.c.a.ts",yL="google.c.a.e",rx=1e4;var ix;(function(s){s[s.DATA_MESSAGE=1]="DATA_MESSAGE",s[s.DISPLAY_NOTIFICATION=3]="DISPLAY_NOTIFICATION"})(ix||(ix={}));var Tu;(function(s){s.PUSH_RECEIVED="push-received",s.NOTIFICATION_CLICKED="notification-clicked"})(Tu||(Tu={}));function Xi(s){const e=new Uint8Array(s);return btoa(String.fromCharCode(...e)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function vL(s){const e="=".repeat((4-s.length%4)%4),t=(s+e).replace(/\-/g,"+").replace(/_/g,"/"),i=atob(t),l=new Uint8Array(i.length);for(let u=0;u<i.length;++u)l[u]=i.charCodeAt(u);return l}const ug="fcm_token_details_db",bL=5,ax="fcm_token_object_Store";async function wL(s){if("databases"in indexedDB&&!(await indexedDB.databases()).map(u=>u.name).includes(ug))return null;let e=null;return(await rf(ug,bL,{upgrade:async(i,l,u,d)=>{if(l<2||!i.objectStoreNames.contains(ax))return;const p=d.objectStore(ax),g=await p.index("fcmSenderId").get(s);if(await p.clear(),!!g){if(l===2){const y=g;if(!y.auth||!y.p256dh||!y.endpoint)return;e={token:y.fcmToken,createTime:y.createTime??Date.now(),subscriptionOptions:{auth:y.auth,p256dh:y.p256dh,endpoint:y.endpoint,swScope:y.swScope,vapidKey:typeof y.vapidKey=="string"?y.vapidKey:Xi(y.vapidKey)}}}else if(l===3){const y=g;e={token:y.fcmToken,createTime:y.createTime,subscriptionOptions:{auth:Xi(y.auth),p256dh:Xi(y.p256dh),endpoint:y.endpoint,swScope:y.swScope,vapidKey:Xi(y.vapidKey)}}}else if(l===4){const y=g;e={token:y.fcmToken,createTime:y.createTime,subscriptionOptions:{auth:Xi(y.auth),p256dh:Xi(y.p256dh),endpoint:y.endpoint,swScope:y.swScope,vapidKey:Xi(y.vapidKey)}}}}}})).close(),await Pp(ug),await Pp("fcm_vapid_details_db"),await Pp("undefined"),xL(e)?e:null}function xL(s){if(!s||!s.subscriptionOptions)return!1;const{subscriptionOptions:e}=s;return typeof s.createTime=="number"&&s.createTime>0&&typeof s.token=="string"&&s.token.length>0&&typeof e.auth=="string"&&e.auth.length>0&&typeof e.p256dh=="string"&&e.p256dh.length>0&&typeof e.endpoint=="string"&&e.endpoint.length>0&&typeof e.swScope=="string"&&e.swScope.length>0&&typeof e.vapidKey=="string"&&e.vapidKey.length>0}const _L="firebase-messaging-database",kL=1,ju="firebase-messaging-store";let dg=null;function WE(){return dg||(dg=rf(_L,kL,{upgrade:(s,e)=>{e===0&&s.createObjectStore(ju)}})),dg}async function EL(s){const e=GE(s),i=await(await WE()).transaction(ju).objectStore(ju).get(e);if(i)return i;{const l=await wL(s.appConfig.senderId);if(l)return await b0(s,l),l}}async function b0(s,e){const t=GE(s),l=(await WE()).transaction(ju,"readwrite");return await l.objectStore(ju).put(e,t),await l.done,e}function GE({appConfig:s}){return s.appId}const TL={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."},ir=new $o("messaging","Messaging",TL);async function jL(s,e){const t=await x0(s),i=KE(e),l={method:"POST",headers:t,body:JSON.stringify(i)};let u;try{u=await(await fetch(w0(s.appConfig),l)).json()}catch(d){throw ir.create("token-subscribe-failed",{errorInfo:d?.toString()})}if(u.error){const d=u.error.message;throw ir.create("token-subscribe-failed",{errorInfo:d})}if(!u.token)throw ir.create("token-subscribe-no-token");return u.token}async function SL(s,e){const t=await x0(s),i=KE(e.subscriptionOptions),l={method:"PATCH",headers:t,body:JSON.stringify(i)};let u;try{u=await(await fetch(`${w0(s.appConfig)}/${e.token}`,l)).json()}catch(d){throw ir.create("token-update-failed",{errorInfo:d?.toString()})}if(u.error){const d=u.error.message;throw ir.create("token-update-failed",{errorInfo:d})}if(!u.token)throw ir.create("token-update-no-token");return u.token}async function CL(s,e){const i={method:"DELETE",headers:await x0(s)};try{const u=await(await fetch(`${w0(s.appConfig)}/${e}`,i)).json();if(u.error){const d=u.error.message;throw ir.create("token-unsubscribe-failed",{errorInfo:d})}}catch(l){throw ir.create("token-unsubscribe-failed",{errorInfo:l?.toString()})}}function w0({projectId:s}){return`${mL}/projects/${s}/registrations`}async function x0({appConfig:s,installations:e}){const t=await e.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":s.apiKey,"x-goog-firebase-installations-auth":`FIS ${t}`})}function KE({p256dh:s,auth:e,endpoint:t,vapidKey:i}){const l={web:{endpoint:t,auth:e,p256dh:s}};return i!==HE&&(l.web.applicationPubKey=i),l}const NL=10080*60*1e3;async function AL(s){const e=await IL(s.swRegistration,s.vapidKey),t={vapidKey:s.vapidKey,swScope:s.swRegistration.scope,endpoint:e.endpoint,auth:Xi(e.getKey("auth")),p256dh:Xi(e.getKey("p256dh"))},i=await EL(s.firebaseDependencies);if(i){if(ML(i.subscriptionOptions,t))return Date.now()>=i.createTime+NL?RL(s,{token:i.token,createTime:Date.now(),subscriptionOptions:t}):i.token;try{await CL(s.firebaseDependencies,i.token)}catch(l){console.warn(l)}return ox(s.firebaseDependencies,t)}else return ox(s.firebaseDependencies,t)}async function RL(s,e){try{const t=await SL(s.firebaseDependencies,e),i={...e,token:t,createTime:Date.now()};return await b0(s.firebaseDependencies,i),t}catch(t){throw t}}async function ox(s,e){const i={token:await jL(s,e),createTime:Date.now(),subscriptionOptions:e};return await b0(s,i),i.token}async function IL(s,e){const t=await s.pushManager.getSubscription();return t||s.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:vL(e)})}function ML(s,e){const t=e.vapidKey===s.vapidKey,i=e.endpoint===s.endpoint,l=e.auth===s.auth,u=e.p256dh===s.p256dh;return t&&i&&l&&u}function lx(s){const e={from:s.from,collapseKey:s.collapse_key,messageId:s.fcmMessageId};return DL(e,s),LL(e,s),OL(e,s),e}function DL(s,e){if(!e.notification)return;s.notification={};const t=e.notification.title;t&&(s.notification.title=t);const i=e.notification.body;i&&(s.notification.body=i);const l=e.notification.image;l&&(s.notification.image=l);const u=e.notification.icon;u&&(s.notification.icon=u)}function LL(s,e){e.data&&(s.data=e.data)}function OL(s,e){if(!e.fcmOptions&&!e.notification?.click_action)return;s.fcmOptions={};const t=e.fcmOptions?.link??e.notification?.click_action;t&&(s.fcmOptions.link=t);const i=e.fcmOptions?.analytics_label;i&&(s.fcmOptions.analyticsLabel=i)}function PL(s){return typeof s=="object"&&!!s&&$E in s}function VL(s){if(!s||!s.options)throw hg("App Configuration Object");if(!s.name)throw hg("App Name");const e=["projectId","apiKey","appId","messagingSenderId"],{options:t}=s;for(const i of e)if(!t[i])throw hg(i);return{appName:s.name,projectId:t.projectId,apiKey:t.apiKey,appId:t.appId,senderId:t.messagingSenderId}}function hg(s){return ir.create("missing-app-config-values",{valueName:s})}class UL{constructor(e,t,i){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const l=VL(e);this.firebaseDependencies={app:e,appConfig:l,installations:t,analyticsProvider:i}}_delete(){return Promise.resolve()}}async function BL(s){try{s.swRegistration=await navigator.serviceWorker.register(hL,{scope:fL}),s.swRegistration.update().catch(()=>{}),await zL(s.swRegistration)}catch(e){throw ir.create("failed-service-worker-registration",{browserErrorMessage:e?.message})}}async function zL(s){return new Promise((e,t)=>{const i=setTimeout(()=>t(new Error(`Service worker not registered after ${rx} ms`)),rx),l=s.installing||s.waiting;s.active?(clearTimeout(i),e()):l?l.onstatechange=u=>{u.target?.state==="activated"&&(l.onstatechange=null,clearTimeout(i),e())}:(clearTimeout(i),t(new Error("No incoming service worker found.")))})}async function FL(s,e){if(!e&&!s.swRegistration&&await BL(s),!(!e&&s.swRegistration)){if(!(e instanceof ServiceWorkerRegistration))throw ir.create("invalid-sw-registration");s.swRegistration=e}}async function qL(s,e){e?s.vapidKey=e:s.vapidKey||(s.vapidKey=HE)}async function YE(s,e){if(!navigator)throw ir.create("only-available-in-window");if(Notification.permission==="default"&&await Notification.requestPermission(),Notification.permission!=="granted")throw ir.create("permission-blocked");return await qL(s,e?.vapidKey),await FL(s,e?.serviceWorkerRegistration),AL(s)}async function HL(s,e,t){const i=$L(e);(await s.firebaseDependencies.analyticsProvider.get()).logEvent(i,{message_id:t[$E],message_name:t[pL],message_time:t[gL],message_device_time:Math.floor(Date.now()/1e3)})}function $L(s){switch(s){case Tu.NOTIFICATION_CLICKED:return"notification_open";case Tu.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}async function WL(s,e){const t=e.data;if(!t.isFirebaseMessaging)return;s.onMessageHandler&&t.messageType===Tu.PUSH_RECEIVED&&(typeof s.onMessageHandler=="function"?s.onMessageHandler(lx(t)):s.onMessageHandler.next(lx(t)));const i=t.data;PL(i)&&i[yL]==="1"&&await HL(s,t.messageType,i)}const cx="@firebase/messaging",ux="0.12.23";const GL=s=>{const e=new UL(s.getProvider("app").getImmediate(),s.getProvider("installations-internal").getImmediate(),s.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",t=>WL(e,t)),e},KL=s=>{const e=s.getProvider("messaging").getImmediate();return{getToken:i=>YE(e,i)}};function YL(){li(new Kr("messaging",GL,"PUBLIC")),li(new Kr("messaging-internal",KL,"PRIVATE")),pr(cx,ux),pr(cx,ux,"esm2020")}async function QL(){try{await Fx()}catch{return!1}return typeof window<"u"&&zx()&&DC()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")}function XL(s=Au()){return QL().then(e=>{if(!e)throw ir.create("unsupported-browser")},e=>{throw ir.create("indexed-db-unsupported")}),Wo(fn(s),"messaging").getImmediate()}async function JL(s,e){return s=fn(s),YE(s,e)}YL();const ZL="BNVNdqAPfJYhKBjF9qd-YPEMYIbecZLWiOGUF5tOBfNuv6P1iXgJS6IoS9dHLM5gp-WMrExfir0pCpkMzOdTWKY";let fg=null;function eO(){if(!fg)try{fg=XL(Au())}catch{return null}return fg}function Yg(){return"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window}function dx(){return"Notification"in window?Notification.permission:"denied"}function tO(s){const e=Object.getOwnPropertyDescriptor(Notification,"permission");Object.defineProperty(Notification,"permission",{get:()=>"granted",configurable:!0});const t=()=>{e?Object.defineProperty(Notification,"permission",e):delete Notification.permission};try{const i=s();return i&&typeof i.then=="function"?i.then(l=>(t(),l),l=>{throw t(),l}):(t(),i)}catch(i){throw t(),i}}async function nO(s){if(!Yg())return null;try{const e=await Notification.requestPermission(),t=eO();if(!t)return console.error("Push: could not initialise Firebase Messaging"),null;const i=await navigator.serviceWorker.ready,l=e!=="granted";let u=null;const d=3;for(let p=1;p<=d;p++){try{const g=()=>JL(t,{vapidKey:ZL,serviceWorkerRegistration:i});if(u=l?await tO(g):await g(),u)break}catch(g){console.warn(`Push getToken attempt ${p}/${d} failed:`,g)}p<d&&await new Promise(g=>setTimeout(g,1500*p))}return u&&s&&await ls(We(ye,"clients",s),{fcmTokens:E6(u)}),u}catch(e){return console.error("Push permission request failed:",e),null}}async function sO(s,e){if(!(!e||!s))try{await ls(We(ye,"clients",s),{fcmTokens:T6(e)})}catch(t){console.error("Token revoke failed:",t)}}const rO=[{key:"buddy_request",label:"Buddy requests",desc:"When someone sends you a buddy request"},{key:"buddy_accept",label:"Buddy accepted",desc:"When your buddy request is accepted"},{key:"like",label:"Likes",desc:"When someone likes your post"},{key:"comment",label:"Comments",desc:"When someone comments on your post"},{key:"mention",label:"Mentions",desc:"When someone @mentions you"}];function iO(){const{currentUser:s,clientData:e,updateClientData:t,logout:i,loading:l}=Ar(),{isDark:u,toggleTheme:d}=Mi(),p=Ys(),[g,y]=w.useState(!1),[b,E]=w.useState(null),[T,L]=w.useState(!1),[W,H]=w.useState("default"),[B,K]=w.useState({buddy_request:!0,buddy_accept:!0,like:!0,comment:!0,mention:!0}),[G,Q]=w.useState(null),he=w.useCallback((C,j="info")=>{Q({message:C,type:j}),setTimeout(()=>Q(null),4e3)},[]);w.useEffect(()=>{!l&&!s&&p("/")},[l,s,p]),w.useEffect(()=>{if(!e)return;const C=e.notificationPrefs;C&&K(R=>({...R,...C}));const j=e.fcmTokens||[];j.length>0&&(y(!0),E(j[j.length-1])),H(dx())},[e]);const Ee=async()=>{if(e){L(!0);try{if(g)b&&await sO(e.id,b),y(!1),E(null),t({fcmTokens:[]}),he("Push notifications disabled","info");else{if(!Yg()){he("Push notifications are not supported on this device","error");return}const C=await nO(e.id),j=dx();H(j),C?(y(!0),E(C),t({fcmTokens:[...e.fcmTokens||[],C]}),he("Push notifications enabled!","success")):he(j==="denied"?"Notifications blocked  enable them in your device settings, remove the app from your home screen and re-add it":j==="granted"?"Permission granted but setup failed  try closing and reopening the app, then toggle again":"Could not enable notifications  please try again","error")}}catch(C){console.error("Push toggle failed:",C),he("Something went wrong  please try again","error")}finally{L(!1)}}},ge=async C=>{if(!e)return;const j={...B,[C]:!B[C]};K(j);try{await ls(We(ye,"clients",e.id),{notificationPrefs:j}),t({notificationPrefs:j})}catch(R){console.error("Failed to save pref:",R),K(V=>({...V,[C]:!V[C]})),he("Failed to save preference","error")}};return l||!e?a.jsx("div",{className:"cb-loading",children:a.jsx("div",{className:"cb-loading-spinner"})}):a.jsxs("div",{className:"cb-settings","data-theme":u?"dark":"light",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>p("/client/core-buddy"),"aria-label":"Back",children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M19 12H5"}),a.jsx("path",{d:"M12 19l-7-7 7-7"})]})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsxs("div",{className:"header-actions",children:[a.jsx("button",{onClick:d,"aria-label":"Toggle theme",children:u?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})}),a.jsx("button",{onClick:i,"aria-label":"Log out",children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),a.jsx("polyline",{points:"16 17 21 12 16 7"}),a.jsx("line",{x1:"21",y1:"12",x2:"9",y2:"12"})]})})]})]})}),a.jsxs("main",{className:"settings-main",children:[a.jsx("h1",{className:"settings-title",children:"Settings"}),a.jsxs("section",{className:"settings-section",children:[a.jsxs("h2",{className:"settings-section-title",children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"}),a.jsx("path",{d:"M13.73 21a2 2 0 0 1-3.46 0"})]}),"Notifications"]}),Yg()?a.jsxs("div",{className:"settings-row",children:[a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Push notifications"}),a.jsx("span",{className:"settings-row-desc",children:"Receive notifications even when the app is closed"})]}),a.jsx("button",{className:`settings-toggle${g?" on":""}${T?" loading":""}`,onClick:Ee,disabled:T,"aria-label":"Toggle push notifications",children:a.jsx("span",{className:"settings-toggle-knob"})})]}):a.jsx("p",{className:"settings-hint",children:"Add the app to your home screen for background push notifications. In-app notifications still work below."}),a.jsxs("div",{className:"settings-sub-section",children:[a.jsx("span",{className:"settings-sub-title",children:"Notify me about"}),rO.map(C=>a.jsxs("div",{className:"settings-row",children:[a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:C.label}),a.jsx("span",{className:"settings-row-desc",children:C.desc})]}),a.jsx("button",{className:`settings-toggle${B[C.key]?" on":""}`,onClick:()=>ge(C.key),"aria-label":`Toggle ${C.label}`,children:a.jsx("span",{className:"settings-toggle-knob"})})]},C.key))]})]}),a.jsxs("section",{className:"settings-section",children:[a.jsxs("h2",{className:"settings-section-title",children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"12",cy:"7",r:"4"})]}),"Account"]}),a.jsxs("div",{className:"settings-row",children:[a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Dark mode"}),a.jsx("span",{className:"settings-row-desc",children:"Switch between light and dark themes"})]}),a.jsx("button",{className:`settings-toggle${u?" on":""}`,onClick:d,"aria-label":"Toggle dark mode",children:a.jsx("span",{className:"settings-toggle-knob"})})]}),a.jsx("div",{className:"settings-row",children:a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Email"}),a.jsx("span",{className:"settings-row-desc",children:e?.email||""})]})}),a.jsx("div",{className:"settings-row",children:a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Plan"}),a.jsx("span",{className:"settings-row-desc",style:{textTransform:"capitalize"},children:e?.tier||"free"})]})})]}),a.jsxs("section",{className:"settings-section",children:[a.jsxs("h2",{className:"settings-section-title",children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})}),"Support & Feedback"]}),a.jsxs("a",{href:"mailto:ross@mindcorefitness.com?subject=Core%20Buddy%20Bug%20Report",className:"settings-link-row",children:[a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Report a Bug"}),a.jsx("span",{className:"settings-row-desc",children:"Found something not working? Let us know"})]}),a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M5 12h14"}),a.jsx("path",{d:"M12 5l7 7-7 7"})]})]}),a.jsxs("a",{href:"mailto:ross@mindcorefitness.com?subject=Core%20Buddy%20Feature%20Request",className:"settings-link-row",children:[a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Request a Feature"}),a.jsx("span",{className:"settings-row-desc",children:"Have an idea to improve Core Buddy?"})]}),a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M5 12h14"}),a.jsx("path",{d:"M12 5l7 7-7 7"})]})]}),a.jsxs("a",{href:"mailto:ross@mindcorefitness.com?subject=Core%20Buddy%20Feedback",className:"settings-link-row",children:[a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"General Feedback"}),a.jsx("span",{className:"settings-row-desc",children:"We'd love to hear from you"})]}),a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M5 12h14"}),a.jsx("path",{d:"M12 5l7 7-7 7"})]})]}),a.jsx("div",{className:"settings-row",children:a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Contact Email"}),a.jsx("span",{className:"settings-row-desc",children:"ross@mindcorefitness.com"})]})})]}),a.jsxs("section",{className:"settings-section",children:[a.jsxs("h2",{className:"settings-section-title",children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),a.jsx("polyline",{points:"14 2 14 8 20 8"}),a.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),a.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"}),a.jsx("polyline",{points:"10 9 9 9 8 9"})]}),"Legal"]}),a.jsxs("a",{href:"/privacy-policy",target:"_blank",rel:"noopener noreferrer",className:"settings-link-row",children:[a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Privacy Policy"}),a.jsx("span",{className:"settings-row-desc",children:"How we collect, use, and protect your data"})]}),a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"}),a.jsx("polyline",{points:"15 3 21 3 21 9"}),a.jsx("line",{x1:"10",y1:"14",x2:"21",y2:"3"})]})]}),a.jsxs("a",{href:"/terms",target:"_blank",rel:"noopener noreferrer",className:"settings-link-row",children:[a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Terms & Conditions"}),a.jsx("span",{className:"settings-row-desc",children:"Terms of use for Core Buddy"})]}),a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"}),a.jsx("polyline",{points:"15 3 21 3 21 9"}),a.jsx("line",{x1:"10",y1:"14",x2:"21",y2:"3"})]})]})]}),a.jsxs("section",{className:"settings-section",children:[a.jsxs("h2",{className:"settings-section-title",children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("line",{x1:"12",y1:"16",x2:"12",y2:"12"}),a.jsx("line",{x1:"12",y1:"8",x2:"12.01",y2:"8"})]}),"About"]}),a.jsx("div",{className:"settings-row",children:a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Core Buddy"}),a.jsx("span",{className:"settings-row-desc",children:"Food. Habits. Move."})]})}),a.jsx("div",{className:"settings-row",children:a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Version"}),a.jsx("span",{className:"settings-row-desc",children:"1.0.0"})]})}),a.jsxs("a",{href:"/core-buddy",target:"_blank",rel:"noopener noreferrer",className:"settings-link-row",children:[a.jsxs("div",{className:"settings-row-text",children:[a.jsx("span",{className:"settings-row-label",children:"Visit Our Website"}),a.jsx("span",{className:"settings-row-desc",children:"mindcorefitness.com"})]}),a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"}),a.jsx("polyline",{points:"15 3 21 3 21 9"}),a.jsx("line",{x1:"10",y1:"14",x2:"21",y2:"3"})]})]})]})]}),G&&a.jsx("div",{className:`settings-toast ${G.type}`,children:G.message}),a.jsx(Yr,{active:"home"})]})}const vh=[{id:"starter_streak",name:"Starter Streak",description:"Complete 5 workouts in 7 days",goal:5,duration:7,type:"workouts",difficulty:"easy",icon:"flame",premium:!0},{id:"consistency_king",name:"Consistency King",description:"Complete 12 workouts in 30 days",goal:12,duration:30,type:"workouts",difficulty:"medium",icon:"crown",premium:!0},{id:"thirty_in_thirty",name:"30 in 30",description:"Complete 30 workouts in 30 days",goal:30,duration:30,type:"workouts",difficulty:"hard",icon:"fire",premium:!0},{id:"minute_master",name:"Minute Master",description:"Train for 300 total minutes in 30 days",goal:300,duration:30,type:"minutes",difficulty:"medium",icon:"clock",premium:!0},{id:"habit_machine",name:"Habit Machine",description:"Hit all daily habits for 7 days straight",goal:7,duration:7,type:"habits_perfect",difficulty:"medium",icon:"check",premium:!0},{id:"iron_will",name:"Iron Will",description:"Work out every day for 14 days straight",goal:14,duration:14,type:"streak",difficulty:"hard",icon:"shield",premium:!0}];function mg({icon:s,size:e=28}){const t={width:e,height:e};switch(s){case"flame":return a.jsx("svg",{style:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M12 12c2-2.96 0-7-1-8 0 3.038-1.773 4.741-3 6-1.226 1.26-2 3.24-2 5a6 6 0 1 0 12 0c0-1.532-1.056-3.94-2-5-1.786 3-2.791 3-4 2z"})});case"crown":return a.jsxs("svg",{style:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M2 4l3 12h14l3-12-6 7-4-7-4 7-6-7z"}),a.jsx("path",{d:"M3 20h18"})]});case"fire":return a.jsx("svg",{style:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M12 12c2-2.96 0-7-1-8 0 3.038-1.773 4.741-3 6-1.226 1.26-2 3.24-2 5a6 6 0 1 0 12 0c0-1.532-1.056-3.94-2-5-1.786 3-2.791 3-4 2z"})});case"clock":return a.jsxs("svg",{style:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("path",{d:"M12 6v6l4 2"})]});case"check":return a.jsxs("svg",{style:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),a.jsx("path",{d:"M22 4L12 14.01l-3-3"})]});case"shield":return a.jsx("svg",{style:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"})});default:return a.jsx("svg",{style:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("circle",{cx:"12",cy:"12",r:"10"})})}}function hx({progress:s,goal:e,size:t=160,stroke:i=10,label:l}){const u=Math.min(s/e,1),d=(t-i)/2,p=2*Math.PI*d,g=p*(1-u);return a.jsxs("div",{className:"ch-ring-wrap",children:[a.jsxs("svg",{width:t,height:t,className:"ch-ring-svg",children:[a.jsx("circle",{cx:t/2,cy:t/2,r:d,fill:"none",stroke:"var(--ch-ring-bg)",strokeWidth:i}),a.jsx("circle",{cx:t/2,cy:t/2,r:d,fill:"none",stroke:"var(--color-primary)",strokeWidth:i,strokeDasharray:p,strokeDashoffset:g,strokeLinecap:"round",style:{transition:"stroke-dashoffset 0.6s ease",transform:"rotate(-90deg)",transformOrigin:"50% 50%"}})]}),a.jsxs("div",{className:"ch-ring-centre",children:[a.jsxs("span",{className:"ch-ring-num",children:[s,a.jsxs("span",{className:"ch-ring-slash",children:[" / ",e]})]}),l&&a.jsx("span",{className:"ch-ring-label",children:l})]})]})}const fx={easy:"#34C759",medium:"#FF9500",hard:"#FF3B30"};async function aO(s,e,t){const i=t instanceof At?t:At.fromDate(new Date(t)),l=At.now();switch(s.type){case"workouts":{const u=Yt(ht(ye,"workoutLogs"),xt("clientId","==",e),xt("completedAt",">=",i),xt("completedAt","<=",l));return(await Ht(u)).size}case"minutes":{const u=Yt(ht(ye,"workoutLogs"),xt("clientId","==",e),xt("completedAt",">=",i),xt("completedAt","<=",l));return(await Ht(u)).docs.reduce((p,g)=>p+(g.data().duration||0),0)}case"habits_perfect":{const u=i.toDate().toISOString().slice(0,10),d=new Date().toISOString().slice(0,10),p=Yt(ht(ye,"habitLogs"),xt("clientId","==",e));return(await Ht(p)).docs.filter(y=>{const b=y.data().date;if(b<u||b>d)return!1;const E=y.data().habits||{};return Object.values(E).length>0&&Object.values(E).every(T=>T===!0)}).length}case"streak":{const u=Yt(ht(ye,"workoutLogs"),xt("clientId","==",e),xt("completedAt",">=",i),xt("completedAt","<=",l)),d=await Ht(u),p=new Set(d.docs.map(E=>E.data().completedAt.toDate().toISOString().slice(0,10)));let g=0;const y=new Date(i.toDate()),b=new Date;for(;p.has(y.toISOString().slice(0,10))&&y<=b;)g++,y.setDate(y.getDate()+1);return g}default:return 0}}function oO(){const{currentUser:s,clientData:e,loading:t}=Ar(),{isDark:i,toggleTheme:l}=Mi(),{isPremium:u}=ic(),d=Ys(),[p,g]=w.useState(null),[y,b]=w.useState(null),[E,T]=w.useState(0),[L,W]=w.useState(0),[H,B]=w.useState(!0),[K,G]=w.useState(!1),[Q,he]=w.useState(null),[Ee,ge]=w.useState(null),[C,j]=w.useState(!1),[R,V]=w.useState(null),O=w.useCallback((Ce,J="info")=>{ge({message:Ce,type:J}),setTimeout(()=>ge(null),4e3)},[]);w.useEffect(()=>{!t&&!s&&d("/")},[t,s,d]);const D=w.useCallback(async()=>{if(e){B(!0);try{const Ce=Yt(ht(ye,"userChallenges"),xt("clientId","==",e.id),xt("status","==","active")),J=await Ht(Ce);if(J.empty)g(null),b(null);else{const we=J.docs[0],_e={id:we.id,...we.data()},xe=vh.find(Se=>Se.id===_e.challengeId);if(_e.endDate.toDate()<new Date)await ls(We(ye,"userChallenges",we.id),{status:"failed"}),g(null),b(null),O("Challenge expired  time ran out","error");else if(g(_e),b(xe),xe){const Se=await aO(xe,e.id,_e.startDate);if(T(Se),Se>=xe.goal&&_e.status==="active"){if(await ls(We(ye,"userChallenges",we.id),{status:"completed",completedAt:Rs()}),j(!0),g(Fe=>Fe?{...Fe,status:"completed"}:null),!_e.badgeAwarded){const Fe=Ja.find(Ze=>Ze.id===xe.id);if(Fe)try{const Ze=We(ye,"coreBuddyBadges",e.id),Oe=await Es(Ze),Mt=Oe.exists()?Oe.data().earned||[]:[];if(!Mt.some(cn=>cn.id===Fe.id)){const cn={id:Fe.id,earnedAt:new Date().toISOString()};Oe.exists()?await ls(Ze,{earned:[...Mt,cn]}):await Ts(Ze,{earned:[cn]})}await ls(We(ye,"userChallenges",we.id),{badgeAwarded:!0}),await mr(ht(ye,"posts"),{authorId:e.id,authorName:e.name||"Anonymous",authorPhotoURL:e.photoURL||null,type:"badge_earned",metadata:{title:Fe.name,badgeDesc:Fe.desc,badgeId:Fe.id},createdAt:Rs(),likeCount:0,commentCount:0}),V(Fe)}catch(Ze){console.error("Badge award failed:",Ze)}}typeof fbq=="function"&&fbq("trackCustom","ChallengeCompleted",{challenge_name:xe.name,challenge_type:xe.type,duration_days:xe.duration})}}}const P=Yt(ht(ye,"userChallenges"),xt("clientId","==",e.id),xt("status","==","completed")),re=await Ht(P);W(re.size)}catch(Ce){console.error("Failed to load challenges:",Ce)}finally{B(!1)}}},[e,O]);w.useEffect(()=>{D()},[D]);const A=async Ce=>{if(!(!e||K)){G(!0);try{const J=vh.find(xe=>xe.id===Ce);if(!J)return;const P=Yt(ht(ye,"userChallenges"),xt("clientId","==",e.id),xt("status","==","active"));if(!(await Ht(P)).empty){he(null),O("You already have an active challenge","info"),await D();return}const we=At.now(),_e=At.fromDate(new Date(Date.now()+J.duration*864e5));await mr(ht(ye,"userChallenges"),{clientId:e.id,challengeId:Ce,startDate:we,endDate:_e,status:"active",completedAt:null,badgeAwarded:!1,createdAt:Rs()}),he(null),O(`${J.name} started  let's go!`,"success"),await D()}catch(J){console.error("Start challenge failed:",J),J?.code==="permission-denied"?O("Permission denied  please re-login and try again","error"):O("Something went wrong  try again","error")}finally{G(!1)}}},Le=async()=>{if(!(!p||K)){G(!0);try{await ls(We(ye,"userChallenges",p.id),{status:"failed"}),g(null),b(null),T(0),he(null),O("Challenge abandoned","info"),await D()}catch(Ce){console.error("Give up failed:",Ce),O("Something went wrong","error")}finally{G(!1)}}},Je=p?.endDate?Math.max(0,Math.ceil((p.endDate.toDate()-new Date)/864e5)):0,X=()=>{if(!y||!p)return"";const Ce=Math.max(1,Math.ceil((Date.now()-p.startDate.toDate())/864e5)),J=y.goal/y.duration*Ce;return E>=J*1.15?"Ahead":E>=J*.85?"On Track":"Behind"};if(t||!e)return a.jsx("div",{className:"ch-loading",children:a.jsx("div",{className:"ch-spinner"})});const je=p&&p.status==="active"&&y,De=C||p&&p.status==="completed";return a.jsxs("div",{className:"ch-page","data-theme":i?"dark":"light",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>d("/client/core-buddy"),"aria-label":"Back",children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M19 12H5"}),a.jsx("path",{d:"M12 19l-7-7 7-7"})]})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:l,"aria-label":"Toggle theme",children:i?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"ch-main",children:[a.jsx("h1",{className:"ch-title",children:"Challenges"}),a.jsx("p",{className:"ch-subtitle",children:"Push yourself with timed fitness challenges"}),H?a.jsx("div",{className:"ch-loading",children:a.jsx("div",{className:"ch-spinner"})}):De?a.jsxs("div",{className:"ch-completed-section",children:[a.jsx(hx,{progress:y?.goal||1,goal:y?.goal||1,label:"Complete"}),a.jsx("div",{className:"ch-completed-pulse"}),a.jsx("h2",{className:"ch-completed-heading",children:"Challenge Complete!"}),a.jsx("p",{className:"ch-completed-name",children:y?.name}),a.jsxs("p",{className:"ch-completed-count",children:[L+(C?1:0)," challenge",L!==0?"s":""," completed"]}),a.jsx("button",{className:"ch-btn ch-btn-primary",onClick:()=>{j(!1),g(null),b(null),D()},children:"Choose Next Challenge"})]}):je?a.jsxs("div",{className:"ch-active-section",children:[a.jsx(hx,{progress:E,goal:y.goal,label:y.type==="minutes"?"minutes":y.type==="streak"?"day streak":y.type==="habits_perfect"?"perfect days":"workouts"}),a.jsxs("div",{className:"ch-active-info",children:[a.jsxs("div",{className:"ch-info-row",children:[a.jsxs("div",{className:"ch-info-item",children:[a.jsx("span",{className:"ch-info-val",children:Je}),a.jsx("span",{className:"ch-info-key",children:"days left"})]}),a.jsx("div",{className:`ch-pace ch-pace-${X().toLowerCase().replace(" ","")}`,children:X()})]}),a.jsx("h2",{className:"ch-active-name",children:y.name}),a.jsx("p",{className:"ch-active-desc",children:y.description})]}),a.jsx("button",{className:"ch-give-up",onClick:()=>he("giveup"),children:"Give Up"}),a.jsxs("div",{className:"ch-browse-locked",children:[a.jsx("p",{className:"ch-browse-locked-note",children:"Complete your current challenge to start a new one"}),a.jsx("div",{className:"ch-grid ch-grid-dimmed",children:vh.filter(Ce=>Ce.id!==y.id).map(Ce=>a.jsxs("div",{className:"ch-card ch-card-locked",children:[a.jsx("div",{className:"ch-card-icon",children:a.jsx(mg,{icon:Ce.icon,size:24})}),a.jsxs("div",{className:"ch-card-body",children:[a.jsx("h3",{children:Ce.name}),a.jsx("p",{children:Ce.description})]})]},Ce.id))})]})]}):a.jsxs("div",{className:"ch-browse-section",children:[!u&&a.jsxs("div",{className:"ch-premium-banner",children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),a.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}),a.jsx("span",{children:"Challenges are a premium feature"}),a.jsx("button",{className:"ch-upgrade-link",onClick:()=>d("/upgrade"),children:"Upgrade"})]}),a.jsx("div",{className:"ch-grid",children:vh.map(Ce=>a.jsxs("button",{className:`ch-card${u?"":" ch-card-gated"}`,onClick:()=>u?he(Ce):d("/upgrade"),children:[!u&&a.jsx("div",{className:"ch-lock-overlay",children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),a.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]})}),a.jsx("div",{className:"ch-card-icon",children:a.jsx(mg,{icon:Ce.icon})}),a.jsxs("div",{className:"ch-card-body",children:[a.jsx("h3",{children:Ce.name}),a.jsx("p",{children:Ce.description}),a.jsxs("div",{className:"ch-card-tags",children:[a.jsxs("span",{className:"ch-tag ch-tag-dur",children:[Ce.duration," days"]}),a.jsx("span",{className:"ch-tag ch-tag-diff",style:{color:fx[Ce.difficulty]},children:Ce.difficulty})]})]}),a.jsx("svg",{className:"ch-card-arrow",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]},Ce.id))})]})]}),Q&&Q!=="giveup"&&a.jsx("div",{className:"ch-modal-backdrop",onClick:()=>!K&&he(null),children:a.jsxs("div",{className:"ch-modal",onClick:Ce=>Ce.stopPropagation(),children:[a.jsx("div",{className:"ch-modal-icon",children:a.jsx(mg,{icon:Q.icon,size:36})}),a.jsx("h2",{children:Q.name}),a.jsx("p",{children:Q.description}),a.jsxs("div",{className:"ch-modal-details",children:[a.jsxs("span",{children:[Q.duration," days"]}),a.jsx("span",{style:{color:fx[Q.difficulty]},children:Q.difficulty})]}),a.jsx("button",{className:"ch-btn ch-btn-primary",onClick:()=>A(Q.id),disabled:K,children:K?"Starting...":"Start Challenge"}),a.jsx("button",{className:"ch-btn ch-btn-secondary",onClick:()=>he(null),disabled:K,children:"Cancel"})]})}),Q==="giveup"&&a.jsx("div",{className:"ch-modal-backdrop",onClick:()=>!K&&he(null),children:a.jsxs("div",{className:"ch-modal",onClick:Ce=>Ce.stopPropagation(),children:[a.jsx("h2",{children:"Give Up?"}),a.jsx("p",{children:"Your progress will be lost and this challenge will be marked as failed."}),a.jsx("button",{className:"ch-btn ch-btn-danger",onClick:Le,disabled:K,children:K?"Abandoning...":"Yes, Give Up"}),a.jsx("button",{className:"ch-btn ch-btn-secondary",onClick:()=>he(null),disabled:K,children:"Keep Going"})]})}),R&&a.jsxs("div",{className:"cb-celebration-overlay",onClick:()=>V(null),children:[a.jsx("div",{className:"cb-confetti-container",children:Array.from({length:24}).map((Ce,J)=>a.jsx("div",{className:"cb-confetti-piece",style:{"--angle":`${J/24*360}deg`,"--distance":`${80+Math.random()*60}px`,"--drift":`${(Math.random()-.5)*40}px`,"--size":`${4+Math.random()*4}px`,"--color":["#FFD700","#FF6B6B","#4ECDC4","#A1C4FD","#F093FB","#FFECD2"][J%6],"--delay":`${Math.random()*.3}s`}},J))}),a.jsxs("div",{className:"cb-celebration-content",children:[a.jsx("div",{className:"cb-celebration-glow"}),R.img&&a.jsx("img",{src:R.img,alt:R.name,className:"cb-celebration-badge-img"}),a.jsx("h2",{className:"cb-celebration-title",children:"Badge Unlocked!"}),a.jsx("p",{className:"cb-celebration-name",children:R.name}),a.jsx("p",{className:"cb-celebration-desc",children:R.desc}),a.jsx("button",{className:"cb-celebration-dismiss",children:"Tap to dismiss"})]})]}),Ee&&a.jsx("div",{className:`ch-toast ch-toast-${Ee.type}`,children:Ee.message}),a.jsx(Yr,{})]})}const lO={workouts:"Workouts",streaks:"Streaks",nutrition:"Nutrition",leaderboard:"Leaderboard",habits:"Habits",challenges:"Challenges"},cO=["workouts","streaks","nutrition","leaderboard","habits","challenges"];function uO(){const{currentUser:s,isClient:e,clientData:t,loading:i}=Ar(),{isDark:l,toggleTheme:u}=Mi(),d=Ys(),[p,g]=w.useState(new Set),[y,b]=w.useState({}),[E,T]=w.useState(!0),[L,W]=w.useState(null);w.useEffect(()=>{!i&&(!s||!e)&&d("/")},[s,e,i,d]),w.useEffect(()=>{t&&(async()=>{T(!0);try{const K=await Es(We(ye,"coreBuddyBadges",t.id));if(K.exists()){const G=K.data().earned||[];g(new Set(G.map(he=>he.id)));const Q={};G.forEach(he=>{Q[he.id]=he}),b(Q)}}catch(K){console.error("Failed to load badges:",K)}finally{T(!1)}})()},[t]);const H=cO.map(K=>({key:K,label:lO[K],badges:Ja.filter(G=>G.category===K)})).filter(K=>K.badges.length>0),B=Ja.filter(K=>p.has(K.id)).length;return i||!t?a.jsx("div",{className:"bdg-loading",children:a.jsx("div",{className:"bdg-spinner"})}):a.jsxs("div",{className:"bdg-page","data-theme":l?"dark":"light",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>d("/client/core-buddy"),"aria-label":"Back",children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M19 12H5"}),a.jsx("path",{d:"M12 19l-7-7 7-7"})]})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"bdg-main",children:[a.jsx("h1",{className:"bdg-title",children:"Badges"}),a.jsxs("p",{className:"bdg-subtitle",children:[B," / ",Ja.length," earned"]}),E?a.jsx("div",{className:"bdg-loading-inline",children:a.jsx("div",{className:"bdg-spinner"})}):H.map(K=>a.jsxs("div",{className:"bdg-category",children:[a.jsx("h2",{className:"bdg-category-title",children:K.label}),a.jsx("div",{className:"bdg-grid",children:K.badges.map(G=>{const Q=p.has(G.id);return a.jsxs("button",{className:`bdg-item${Q?" earned":" locked"}`,onClick:()=>W(G),children:[a.jsxs("div",{className:"bdg-img-wrap",children:[G.img?a.jsx("img",{src:G.img,alt:G.name,className:"bdg-img"}):a.jsx("div",{className:"bdg-img-placeholder",children:a.jsxs("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[a.jsx("circle",{cx:"12",cy:"8",r:"6"}),a.jsx("path",{d:"M9 14l-4 8h14l-4-8"})]})}),!Q&&a.jsx("div",{className:"bdg-lock-overlay",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),a.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]})})]}),a.jsx("span",{className:"bdg-name",children:G.name})]},G.id)})})]},K.key))]}),L&&a.jsx("div",{className:"bdg-modal-backdrop",onClick:()=>W(null),children:a.jsxs("div",{className:"bdg-modal",onClick:K=>K.stopPropagation(),children:[a.jsx("div",{className:`bdg-modal-img-wrap${p.has(L.id)?" earned":" locked"}`,children:L.img?a.jsx("img",{src:L.img,alt:L.name,className:"bdg-modal-img"}):a.jsx("div",{className:"bdg-modal-placeholder",children:a.jsxs("svg",{width:"64",height:"64",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[a.jsx("circle",{cx:"12",cy:"8",r:"6"}),a.jsx("path",{d:"M9 14l-4 8h14l-4-8"})]})})}),a.jsx("h2",{className:"bdg-modal-name",children:L.name}),a.jsx("p",{className:"bdg-modal-desc",children:L.desc}),p.has(L.id)?a.jsxs("span",{className:"bdg-modal-status earned",children:[a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:a.jsx("path",{d:"M5 13l4 4L19 7"})}),"Earned",y[L.id]?.earnedAt?`  ${new Date(y[L.id].earnedAt).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"})}`:""]}):a.jsxs("span",{className:"bdg-modal-status locked",children:[a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),a.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}),"Locked"]}),a.jsx("button",{className:"bdg-modal-close",onClick:()=>W(null),children:"Close"})]})}),a.jsx(Yr,{active:"badges"})]})}const dO=w.lazy(()=>Ks(()=>import("./Dashboard-CFcXPmHh.js"),__vite__mapDeps([0,1,2]))),hO=w.lazy(()=>Ks(()=>import("./AddClient-BOj1YMZn.js"),__vite__mapDeps([3,4]))),fO=w.lazy(()=>Ks(()=>import("./ClientDashboard-Bif9jTRK.js"),__vite__mapDeps([5,1,6]))),mO=w.lazy(()=>Ks(()=>import("./ClientForms-U7ApZT1U.js"),__vite__mapDeps([7,8,6]))),pO=w.lazy(()=>Ks(()=>import("./ClientTools-PXGF2zki.js"),__vite__mapDeps([9,10,6]))),gO=w.lazy(()=>Ks(()=>import("./MacroCalculator-D94AKXAX.js"),__vite__mapDeps([11,10,6]))),yO=w.lazy(()=>Ks(()=>import("./ProteinSnacks-wQ8Aar5y.js"),__vite__mapDeps([12,10,6]))),vO=w.lazy(()=>Ks(()=>import("./DailyMotivation-CyAgXyBL.js"),__vite__mapDeps([13,10,6]))),bO=w.lazy(()=>Ks(()=>import("./CircuitDashboard-BSkwLmLb.js"),__vite__mapDeps([14,15]))),wO=w.lazy(()=>Ks(()=>import("./CircuitBooking-BkkN7TXm.js"),__vite__mapDeps([16,17,15]))),xO=w.lazy(()=>Ks(()=>import("./PersonalBests-CUTeVzk4.js"),__vite__mapDeps([18,19,6]))),_O=w.lazy(()=>Ks(()=>import("./Leaderboard-BvMypeOp.js"),__vite__mapDeps([20,21]))),kO=w.lazy(()=>Ks(()=>import("./UpgradePage-BYzWQtD2.js"),__vite__mapDeps([22,23,24]))),EO=w.lazy(()=>Ks(()=>import("./SignUp-hPowUp8Q.js"),[])),TO=w.lazy(()=>Ks(()=>import("./Onboarding-BonzD85R.js"),__vite__mapDeps([25,23,26])));function jO({children:s}){const{pathname:e}=Ii();return w.useEffect(()=>{"scrollRestoration"in window.history&&(window.history.scrollRestoration="manual")},[]),w.useEffect(()=>{window.scrollTo({top:0,left:0,behavior:"instant"})},[e]),s}function SO(){const s=Ys();return w.useEffect(()=>{const e=sessionStorage.getItem("redirect");if(e){sessionStorage.removeItem("redirect");const t=e.replace("/login","")||"/";s(t,{replace:!0})}},[s]),null}function CO(){return a.jsx(XD,{children:a.jsx(QD,{children:a.jsx(n3,{children:a.jsxs(aC,{basename:"/login",children:[a.jsx(SO,{}),a.jsx(jO,{children:a.jsx(w.Suspense,{fallback:a.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",minHeight:"60vh"},children:a.jsx("div",{style:{width:36,height:36,border:"3px solid var(--color-primary-light)",borderTopColor:"var(--color-primary)",borderRadius:"50%",animation:"app-spin .7s linear infinite"}})}),children:a.jsxs(LS,{children:[a.jsx(kn,{path:"/",element:a.jsx(i3,{})}),a.jsx(kn,{path:"/dashboard",element:a.jsx(dO,{})}),a.jsx(kn,{path:"/add-client",element:a.jsx(hO,{})}),a.jsx(kn,{path:"/client",element:a.jsx(fO,{})}),a.jsx(kn,{path:"/client/forms",element:a.jsx(mO,{})}),a.jsx(kn,{path:"/client/tools",element:a.jsx(pO,{})}),a.jsx(kn,{path:"/client/tools/macros",element:a.jsx(gO,{})}),a.jsx(kn,{path:"/client/tools/snacks",element:a.jsx(yO,{})}),a.jsx(kn,{path:"/client/tools/motivation",element:a.jsx(vO,{})}),a.jsx(kn,{path:"/client/personal-bests",element:a.jsx(xO,{})}),a.jsx(kn,{path:"/client/circuit",element:a.jsx(bO,{})}),a.jsx(kn,{path:"/client/circuit/booking",element:a.jsx(wO,{})}),a.jsx(kn,{path:"/client/core-buddy",element:a.jsx(C3,{})}),a.jsx(kn,{path:"/client/core-buddy/nutrition",element:a.jsx(fh,{feature:"nutrition",children:a.jsx(R3,{})})}),a.jsx(kn,{path:"/client/core-buddy/workouts",element:a.jsx(f5,{})}),a.jsx(kn,{path:"/client/core-buddy/consistency",element:a.jsx(fh,{feature:"consistency",children:a.jsx(x5,{})})}),a.jsx(kn,{path:"/client/core-buddy/buddies",element:a.jsx(fh,{feature:"buddies",children:a.jsx(_5,{})})}),a.jsx(kn,{path:"/client/core-buddy/builder",element:a.jsx(j5,{})}),a.jsx(kn,{path:"/client/core-buddy/profile/:userId",element:a.jsx(E5,{})}),a.jsx(kn,{path:"/client/core-buddy/settings",element:a.jsx(iO,{})}),a.jsx(kn,{path:"/client/core-buddy/challenges",element:a.jsx(oO,{})}),a.jsx(kn,{path:"/client/core-buddy/badges",element:a.jsx(uO,{})}),a.jsx(kn,{path:"/client/leaderboard",element:a.jsx(fh,{feature:"leaderboard",children:a.jsx(_O,{})})}),a.jsx(kn,{path:"/signup",element:a.jsx(EO,{})}),a.jsx(kn,{path:"/onboarding",element:a.jsx(TO,{})}),a.jsx(kn,{path:"/upgrade",element:a.jsx(kO,{})}),a.jsx(kn,{path:"*",element:a.jsx(Sx,{to:"/",replace:!0})})]})})})]})})})})}Lj.createRoot(document.getElementById("root")).render(a.jsx(w.StrictMode,{children:a.jsx(CO,{})}));"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/login/sw.js").then(s=>{setInterval(()=>s.update(),3600*1e3)}).catch(s=>console.warn("SW registration failed:",s))});export{s3 as A,AO as B,Yr as C,Rs as D,Jo as P,At as T,mr as a,Sr as b,ht as c,ye as d,We as e,YA as f,Ht as g,e4 as h,Ts as i,a as j,Es as k,Ar as l,Mi as m,Ys as n,ku as o,TE as p,Yt as q,w as r,IO as s,NO as t,ls as u,MO as v,xt as w,Zh as x,ic as y,r3 as z};
