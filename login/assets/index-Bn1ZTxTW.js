const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Dashboard-C-iAO5D4.js","assets/Dashboard-kTCGLGDk.css","assets/AddClient-DVlgNkkH.js","assets/AddClient-DH1OFzHo.css","assets/ClientForms-DZHz7j9E.js","assets/ClientForms-GDNtnrAx.css","assets/ClientTools-BE8WIL0M.js","assets/ClientTools-DQRPoST3.css","assets/MacroCalculator-CD1XSdCN.js","assets/ProteinSnacks-BeFWgbVC.js","assets/DailyMotivation-eZ5UsAdR.js","assets/CircuitDashboard-DecMNjDl.js","assets/CircuitDashboard-C8T0uect.css","assets/CircuitBooking-Dn8JdKFJ.js","assets/CircuitBooking-ruk9Q4Wj.css","assets/Leaderboard-Ch9GlASG.js","assets/Leaderboard-Dq-r5svP.css","assets/UpgradePage-JWAWVs6P.js","assets/stripe-7qEIN5w7.js","assets/UpgradePage-Blt11CID.css","assets/Onboarding-DEA8QEtf.js","assets/Onboarding-Bku4iVdQ.css"])))=>i.map(i=>d[i]);
(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))i(l);new MutationObserver(l=>{for(const u of l)if(u.type==="childList")for(const d of u.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&i(d)}).observe(document,{childList:!0,subtree:!0});function t(l){const u={};return l.integrity&&(u.integrity=l.integrity),l.referrerPolicy&&(u.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?u.credentials="include":l.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function i(l){if(l.ep)return;l.ep=!0;const u=t(l);fetch(l.href,u)}})();var gp={exports:{}},Wc={};var w1;function xT(){if(w1)return Wc;w1=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(i,l,u){var d=null;if(u!==void 0&&(d=""+u),l.key!==void 0&&(d=""+l.key),"key"in l){u={};for(var p in l)p!=="key"&&(u[p]=l[p])}else u=l;return l=u.ref,{$$typeof:n,type:i,key:d,ref:l!==void 0?l:null,props:u}}return Wc.Fragment=e,Wc.jsx=t,Wc.jsxs=t,Wc}var _1;function wT(){return _1||(_1=1,gp.exports=xT()),gp.exports}var r=wT(),yp={exports:{}},$t={};var k1;function _T(){if(k1)return $t;k1=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),l=Symbol.for("react.profiler"),u=Symbol.for("react.consumer"),d=Symbol.for("react.context"),p=Symbol.for("react.forward_ref"),g=Symbol.for("react.suspense"),y=Symbol.for("react.memo"),w=Symbol.for("react.lazy"),j=Symbol.for("react.activity"),T=Symbol.iterator;function V(L){return L===null||typeof L!="object"?null:(L=T&&L[T]||L["@@iterator"],typeof L=="function"?L:null)}var $={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},F=Object.assign,U={};function te(L,se,Le){this.props=L,this.context=se,this.refs=U,this.updater=Le||$}te.prototype.isReactComponent={},te.prototype.setState=function(L,se){if(typeof L!="object"&&typeof L!="function"&&L!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,L,se,"setState")},te.prototype.forceUpdate=function(L){this.updater.enqueueForceUpdate(this,L,"forceUpdate")};function K(){}K.prototype=te.prototype;function re(L,se,Le){this.props=L,this.context=se,this.refs=U,this.updater=Le||$}var ye=re.prototype=new K;ye.constructor=re,F(ye,te.prototype),ye.isPureReactComponent=!0;var ve=Array.isArray;function ge(){}var R={H:null,A:null,T:null,S:null},E=Object.prototype.hasOwnProperty;function A(L,se,Le){var Oe=Le.ref;return{$$typeof:n,type:L,key:se,ref:Oe!==void 0?Oe:null,props:Le}}function O(L,se){return A(L.type,se,L.props)}function D(L){return typeof L=="object"&&L!==null&&L.$$typeof===n}function H(L){var se={"=":"=0",":":"=2"};return"$"+L.replace(/[=:]/g,function(Le){return se[Le]})}var I=/\/+/g;function $e(L,se){return typeof L=="object"&&L!==null&&L.key!=null?H(""+L.key):se.toString(36)}function xt(L){switch(L.status){case"fulfilled":return L.value;case"rejected":throw L.reason;default:switch(typeof L.status=="string"?L.then(ge,ge):(L.status="pending",L.then(function(se){L.status==="pending"&&(L.status="fulfilled",L.value=se)},function(se){L.status==="pending"&&(L.status="rejected",L.reason=se)})),L.status){case"fulfilled":return L.value;case"rejected":throw L.reason}}throw L}function W(L,se,Le,Oe,Ye){var Ue=typeof L;(Ue==="undefined"||Ue==="boolean")&&(L=null);var pt=!1;if(L===null)pt=!0;else switch(Ue){case"bigint":case"string":case"number":pt=!0;break;case"object":switch(L.$$typeof){case n:case e:pt=!0;break;case w:return pt=L._init,W(pt(L._payload),se,Le,Oe,Ye)}}if(pt)return Ye=Ye(L),pt=Oe===""?"."+$e(L,0):Oe,ve(Ye)?(Le="",pt!=null&&(Le=pt.replace(I,"$&/")+"/"),W(Ye,se,Le,"",function(Gt){return Gt})):Ye!=null&&(D(Ye)&&(Ye=O(Ye,Le+(Ye.key==null||L&&L.key===Ye.key?"":(""+Ye.key).replace(I,"$&/")+"/")+pt)),se.push(Ye)),1;pt=0;var Tt=Oe===""?".":Oe+":";if(ve(L))for(var at=0;at<L.length;at++)Oe=L[at],Ue=Tt+$e(Oe,at),pt+=W(Oe,se,Le,Ue,Ye);else if(at=V(L),typeof at=="function")for(L=at.call(L),at=0;!(Oe=L.next()).done;)Oe=Oe.value,Ue=Tt+$e(Oe,at++),pt+=W(Oe,se,Le,Ue,Ye);else if(Ue==="object"){if(typeof L.then=="function")return W(xt(L),se,Le,Oe,Ye);throw se=String(L),Error("Objects are not valid as a React child (found: "+(se==="[object Object]"?"object with keys {"+Object.keys(L).join(", ")+"}":se)+"). If you meant to render a collection of children, use an array instead.")}return pt}function he(L,se,Le){if(L==null)return L;var Oe=[],Ye=0;return W(L,Oe,"","",function(Ue){return se.call(Le,Ue,Ye++)}),Oe}function Pe(L){if(L._status===-1){var se=L._result;se=se(),se.then(function(Le){(L._status===0||L._status===-1)&&(L._status=1,L._result=Le)},function(Le){(L._status===0||L._status===-1)&&(L._status=2,L._result=Le)}),L._status===-1&&(L._status=0,L._result=se)}if(L._status===1)return L._result.default;throw L._result}var He=typeof reportError=="function"?reportError:function(L){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var se=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof L=="object"&&L!==null&&typeof L.message=="string"?String(L.message):String(L),error:L});if(!window.dispatchEvent(se))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",L);return}console.error(L)},ee={map:he,forEach:function(L,se,Le){he(L,function(){se.apply(this,arguments)},Le)},count:function(L){var se=0;return he(L,function(){se++}),se},toArray:function(L){return he(L,function(se){return se})||[]},only:function(L){if(!D(L))throw Error("React.Children.only expected to receive a single React element child.");return L}};return $t.Activity=j,$t.Children=ee,$t.Component=te,$t.Fragment=t,$t.Profiler=l,$t.PureComponent=re,$t.StrictMode=i,$t.Suspense=g,$t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=R,$t.__COMPILER_RUNTIME={__proto__:null,c:function(L){return R.H.useMemoCache(L)}},$t.cache=function(L){return function(){return L.apply(null,arguments)}},$t.cacheSignal=function(){return null},$t.cloneElement=function(L,se,Le){if(L==null)throw Error("The argument must be a React element, but you passed "+L+".");var Oe=F({},L.props),Ye=L.key;if(se!=null)for(Ue in se.key!==void 0&&(Ye=""+se.key),se)!E.call(se,Ue)||Ue==="key"||Ue==="__self"||Ue==="__source"||Ue==="ref"&&se.ref===void 0||(Oe[Ue]=se[Ue]);var Ue=arguments.length-2;if(Ue===1)Oe.children=Le;else if(1<Ue){for(var pt=Array(Ue),Tt=0;Tt<Ue;Tt++)pt[Tt]=arguments[Tt+2];Oe.children=pt}return A(L.type,Ye,Oe)},$t.createContext=function(L){return L={$$typeof:d,_currentValue:L,_currentValue2:L,_threadCount:0,Provider:null,Consumer:null},L.Provider=L,L.Consumer={$$typeof:u,_context:L},L},$t.createElement=function(L,se,Le){var Oe,Ye={},Ue=null;if(se!=null)for(Oe in se.key!==void 0&&(Ue=""+se.key),se)E.call(se,Oe)&&Oe!=="key"&&Oe!=="__self"&&Oe!=="__source"&&(Ye[Oe]=se[Oe]);var pt=arguments.length-2;if(pt===1)Ye.children=Le;else if(1<pt){for(var Tt=Array(pt),at=0;at<pt;at++)Tt[at]=arguments[at+2];Ye.children=Tt}if(L&&L.defaultProps)for(Oe in pt=L.defaultProps,pt)Ye[Oe]===void 0&&(Ye[Oe]=pt[Oe]);return A(L,Ue,Ye)},$t.createRef=function(){return{current:null}},$t.forwardRef=function(L){return{$$typeof:p,render:L}},$t.isValidElement=D,$t.lazy=function(L){return{$$typeof:w,_payload:{_status:-1,_result:L},_init:Pe}},$t.memo=function(L,se){return{$$typeof:y,type:L,compare:se===void 0?null:se}},$t.startTransition=function(L){var se=R.T,Le={};R.T=Le;try{var Oe=L(),Ye=R.S;Ye!==null&&Ye(Le,Oe),typeof Oe=="object"&&Oe!==null&&typeof Oe.then=="function"&&Oe.then(ge,He)}catch(Ue){He(Ue)}finally{se!==null&&Le.types!==null&&(se.types=Le.types),R.T=se}},$t.unstable_useCacheRefresh=function(){return R.H.useCacheRefresh()},$t.use=function(L){return R.H.use(L)},$t.useActionState=function(L,se,Le){return R.H.useActionState(L,se,Le)},$t.useCallback=function(L,se){return R.H.useCallback(L,se)},$t.useContext=function(L){return R.H.useContext(L)},$t.useDebugValue=function(){},$t.useDeferredValue=function(L,se){return R.H.useDeferredValue(L,se)},$t.useEffect=function(L,se){return R.H.useEffect(L,se)},$t.useEffectEvent=function(L){return R.H.useEffectEvent(L)},$t.useId=function(){return R.H.useId()},$t.useImperativeHandle=function(L,se,Le){return R.H.useImperativeHandle(L,se,Le)},$t.useInsertionEffect=function(L,se){return R.H.useInsertionEffect(L,se)},$t.useLayoutEffect=function(L,se){return R.H.useLayoutEffect(L,se)},$t.useMemo=function(L,se){return R.H.useMemo(L,se)},$t.useOptimistic=function(L,se){return R.H.useOptimistic(L,se)},$t.useReducer=function(L,se,Le){return R.H.useReducer(L,se,Le)},$t.useRef=function(L){return R.H.useRef(L)},$t.useState=function(L){return R.H.useState(L)},$t.useSyncExternalStore=function(L,se,Le){return R.H.useSyncExternalStore(L,se,Le)},$t.useTransition=function(){return R.H.useTransition()},$t.version="19.2.4",$t}var j1;function Pg(){return j1||(j1=1,yp.exports=_T()),yp.exports}var v=Pg(),bp={exports:{}},Gc={},vp={exports:{}},xp={};var T1;function kT(){return T1||(T1=1,(function(n){function e(W,he){var Pe=W.length;W.push(he);e:for(;0<Pe;){var He=Pe-1>>>1,ee=W[He];if(0<l(ee,he))W[He]=he,W[Pe]=ee,Pe=He;else break e}}function t(W){return W.length===0?null:W[0]}function i(W){if(W.length===0)return null;var he=W[0],Pe=W.pop();if(Pe!==he){W[0]=Pe;e:for(var He=0,ee=W.length,L=ee>>>1;He<L;){var se=2*(He+1)-1,Le=W[se],Oe=se+1,Ye=W[Oe];if(0>l(Le,Pe))Oe<ee&&0>l(Ye,Le)?(W[He]=Ye,W[Oe]=Pe,He=Oe):(W[He]=Le,W[se]=Pe,He=se);else if(Oe<ee&&0>l(Ye,Pe))W[He]=Ye,W[Oe]=Pe,He=Oe;else break e}}return he}function l(W,he){var Pe=W.sortIndex-he.sortIndex;return Pe!==0?Pe:W.id-he.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var u=performance;n.unstable_now=function(){return u.now()}}else{var d=Date,p=d.now();n.unstable_now=function(){return d.now()-p}}var g=[],y=[],w=1,j=null,T=3,V=!1,$=!1,F=!1,U=!1,te=typeof setTimeout=="function"?setTimeout:null,K=typeof clearTimeout=="function"?clearTimeout:null,re=typeof setImmediate<"u"?setImmediate:null;function ye(W){for(var he=t(y);he!==null;){if(he.callback===null)i(y);else if(he.startTime<=W)i(y),he.sortIndex=he.expirationTime,e(g,he);else break;he=t(y)}}function ve(W){if(F=!1,ye(W),!$)if(t(g)!==null)$=!0,ge||(ge=!0,H());else{var he=t(y);he!==null&&xt(ve,he.startTime-W)}}var ge=!1,R=-1,E=5,A=-1;function O(){return U?!0:!(n.unstable_now()-A<E)}function D(){if(U=!1,ge){var W=n.unstable_now();A=W;var he=!0;try{e:{$=!1,F&&(F=!1,K(R),R=-1),V=!0;var Pe=T;try{t:{for(ye(W),j=t(g);j!==null&&!(j.expirationTime>W&&O());){var He=j.callback;if(typeof He=="function"){j.callback=null,T=j.priorityLevel;var ee=He(j.expirationTime<=W);if(W=n.unstable_now(),typeof ee=="function"){j.callback=ee,ye(W),he=!0;break t}j===t(g)&&i(g),ye(W)}else i(g);j=t(g)}if(j!==null)he=!0;else{var L=t(y);L!==null&&xt(ve,L.startTime-W),he=!1}}break e}finally{j=null,T=Pe,V=!1}he=void 0}}finally{he?H():ge=!1}}}var H;if(typeof re=="function")H=function(){re(D)};else if(typeof MessageChannel<"u"){var I=new MessageChannel,$e=I.port2;I.port1.onmessage=D,H=function(){$e.postMessage(null)}}else H=function(){te(D,0)};function xt(W,he){R=te(function(){W(n.unstable_now())},he)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(W){W.callback=null},n.unstable_forceFrameRate=function(W){0>W||125<W?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):E=0<W?Math.floor(1e3/W):5},n.unstable_getCurrentPriorityLevel=function(){return T},n.unstable_next=function(W){switch(T){case 1:case 2:case 3:var he=3;break;default:he=T}var Pe=T;T=he;try{return W()}finally{T=Pe}},n.unstable_requestPaint=function(){U=!0},n.unstable_runWithPriority=function(W,he){switch(W){case 1:case 2:case 3:case 4:case 5:break;default:W=3}var Pe=T;T=W;try{return he()}finally{T=Pe}},n.unstable_scheduleCallback=function(W,he,Pe){var He=n.unstable_now();switch(typeof Pe=="object"&&Pe!==null?(Pe=Pe.delay,Pe=typeof Pe=="number"&&0<Pe?He+Pe:He):Pe=He,W){case 1:var ee=-1;break;case 2:ee=250;break;case 5:ee=1073741823;break;case 4:ee=1e4;break;default:ee=5e3}return ee=Pe+ee,W={id:w++,callback:he,priorityLevel:W,startTime:Pe,expirationTime:ee,sortIndex:-1},Pe>He?(W.sortIndex=Pe,e(y,W),t(g)===null&&W===t(y)&&(F?(K(R),R=-1):F=!0,xt(ve,Pe-He))):(W.sortIndex=ee,e(g,W),$||V||($=!0,ge||(ge=!0,H()))),W},n.unstable_shouldYield=O,n.unstable_wrapCallback=function(W){var he=T;return function(){var Pe=T;T=he;try{return W.apply(this,arguments)}finally{T=Pe}}}})(xp)),xp}var E1;function jT(){return E1||(E1=1,vp.exports=kT()),vp.exports}var wp={exports:{}},lr={};var S1;function TT(){if(S1)return lr;S1=1;var n=Pg();function e(g){var y="https://react.dev/errors/"+g;if(1<arguments.length){y+="?args[]="+encodeURIComponent(arguments[1]);for(var w=2;w<arguments.length;w++)y+="&args[]="+encodeURIComponent(arguments[w])}return"Minified React error #"+g+"; visit "+y+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var i={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},l=Symbol.for("react.portal");function u(g,y,w){var j=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:l,key:j==null?null:""+j,children:g,containerInfo:y,implementation:w}}var d=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function p(g,y){if(g==="font")return"";if(typeof y=="string")return y==="use-credentials"?y:""}return lr.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,lr.createPortal=function(g,y){var w=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!y||y.nodeType!==1&&y.nodeType!==9&&y.nodeType!==11)throw Error(e(299));return u(g,y,null,w)},lr.flushSync=function(g){var y=d.T,w=i.p;try{if(d.T=null,i.p=2,g)return g()}finally{d.T=y,i.p=w,i.d.f()}},lr.preconnect=function(g,y){typeof g=="string"&&(y?(y=y.crossOrigin,y=typeof y=="string"?y==="use-credentials"?y:"":void 0):y=null,i.d.C(g,y))},lr.prefetchDNS=function(g){typeof g=="string"&&i.d.D(g)},lr.preinit=function(g,y){if(typeof g=="string"&&y&&typeof y.as=="string"){var w=y.as,j=p(w,y.crossOrigin),T=typeof y.integrity=="string"?y.integrity:void 0,V=typeof y.fetchPriority=="string"?y.fetchPriority:void 0;w==="style"?i.d.S(g,typeof y.precedence=="string"?y.precedence:void 0,{crossOrigin:j,integrity:T,fetchPriority:V}):w==="script"&&i.d.X(g,{crossOrigin:j,integrity:T,fetchPriority:V,nonce:typeof y.nonce=="string"?y.nonce:void 0})}},lr.preinitModule=function(g,y){if(typeof g=="string")if(typeof y=="object"&&y!==null){if(y.as==null||y.as==="script"){var w=p(y.as,y.crossOrigin);i.d.M(g,{crossOrigin:w,integrity:typeof y.integrity=="string"?y.integrity:void 0,nonce:typeof y.nonce=="string"?y.nonce:void 0})}}else y==null&&i.d.M(g)},lr.preload=function(g,y){if(typeof g=="string"&&typeof y=="object"&&y!==null&&typeof y.as=="string"){var w=y.as,j=p(w,y.crossOrigin);i.d.L(g,w,{crossOrigin:j,integrity:typeof y.integrity=="string"?y.integrity:void 0,nonce:typeof y.nonce=="string"?y.nonce:void 0,type:typeof y.type=="string"?y.type:void 0,fetchPriority:typeof y.fetchPriority=="string"?y.fetchPriority:void 0,referrerPolicy:typeof y.referrerPolicy=="string"?y.referrerPolicy:void 0,imageSrcSet:typeof y.imageSrcSet=="string"?y.imageSrcSet:void 0,imageSizes:typeof y.imageSizes=="string"?y.imageSizes:void 0,media:typeof y.media=="string"?y.media:void 0})}},lr.preloadModule=function(g,y){if(typeof g=="string")if(y){var w=p(y.as,y.crossOrigin);i.d.m(g,{as:typeof y.as=="string"&&y.as!=="script"?y.as:void 0,crossOrigin:w,integrity:typeof y.integrity=="string"?y.integrity:void 0})}else i.d.m(g)},lr.requestFormReset=function(g){i.d.r(g)},lr.unstable_batchedUpdates=function(g,y){return g(y)},lr.useFormState=function(g,y,w){return d.H.useFormState(g,y,w)},lr.useFormStatus=function(){return d.H.useHostTransitionStatus()},lr.version="19.2.4",lr}var N1;function ET(){if(N1)return wp.exports;N1=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),wp.exports=TT(),wp.exports}var C1;function ST(){if(C1)return Gc;C1=1;var n=jT(),e=Pg(),t=ET();function i(s){var a="https://react.dev/errors/"+s;if(1<arguments.length){a+="?args[]="+encodeURIComponent(arguments[1]);for(var o=2;o<arguments.length;o++)a+="&args[]="+encodeURIComponent(arguments[o])}return"Minified React error #"+s+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function l(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function u(s){var a=s,o=s;if(s.alternate)for(;a.return;)a=a.return;else{s=a;do a=s,(a.flags&4098)!==0&&(o=a.return),s=a.return;while(s)}return a.tag===3?o:null}function d(s){if(s.tag===13){var a=s.memoizedState;if(a===null&&(s=s.alternate,s!==null&&(a=s.memoizedState)),a!==null)return a.dehydrated}return null}function p(s){if(s.tag===31){var a=s.memoizedState;if(a===null&&(s=s.alternate,s!==null&&(a=s.memoizedState)),a!==null)return a.dehydrated}return null}function g(s){if(u(s)!==s)throw Error(i(188))}function y(s){var a=s.alternate;if(!a){if(a=u(s),a===null)throw Error(i(188));return a!==s?null:s}for(var o=s,c=a;;){var m=o.return;if(m===null)break;var f=m.alternate;if(f===null){if(c=m.return,c!==null){o=c;continue}break}if(m.child===f.child){for(f=m.child;f;){if(f===o)return g(m),s;if(f===c)return g(m),a;f=f.sibling}throw Error(i(188))}if(o.return!==c.return)o=m,c=f;else{for(var x=!1,S=m.child;S;){if(S===o){x=!0,o=m,c=f;break}if(S===c){x=!0,c=m,o=f;break}S=S.sibling}if(!x){for(S=f.child;S;){if(S===o){x=!0,o=f,c=m;break}if(S===c){x=!0,c=f,o=m;break}S=S.sibling}if(!x)throw Error(i(189))}}if(o.alternate!==c)throw Error(i(190))}if(o.tag!==3)throw Error(i(188));return o.stateNode.current===o?s:a}function w(s){var a=s.tag;if(a===5||a===26||a===27||a===6)return s;for(s=s.child;s!==null;){if(a=w(s),a!==null)return a;s=s.sibling}return null}var j=Object.assign,T=Symbol.for("react.element"),V=Symbol.for("react.transitional.element"),$=Symbol.for("react.portal"),F=Symbol.for("react.fragment"),U=Symbol.for("react.strict_mode"),te=Symbol.for("react.profiler"),K=Symbol.for("react.consumer"),re=Symbol.for("react.context"),ye=Symbol.for("react.forward_ref"),ve=Symbol.for("react.suspense"),ge=Symbol.for("react.suspense_list"),R=Symbol.for("react.memo"),E=Symbol.for("react.lazy"),A=Symbol.for("react.activity"),O=Symbol.for("react.memo_cache_sentinel"),D=Symbol.iterator;function H(s){return s===null||typeof s!="object"?null:(s=D&&s[D]||s["@@iterator"],typeof s=="function"?s:null)}var I=Symbol.for("react.client.reference");function $e(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===I?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case F:return"Fragment";case te:return"Profiler";case U:return"StrictMode";case ve:return"Suspense";case ge:return"SuspenseList";case A:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case $:return"Portal";case re:return s.displayName||"Context";case K:return(s._context.displayName||"Context")+".Consumer";case ye:var a=s.render;return s=s.displayName,s||(s=a.displayName||a.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case R:return a=s.displayName||null,a!==null?a:$e(s.type)||"Memo";case E:a=s._payload,s=s._init;try{return $e(s(a))}catch{}}return null}var xt=Array.isArray,W=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,he=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Pe={pending:!1,data:null,method:null,action:null},He=[],ee=-1;function L(s){return{current:s}}function se(s){0>ee||(s.current=He[ee],He[ee]=null,ee--)}function Le(s,a){ee++,He[ee]=s.current,s.current=a}var Oe=L(null),Ye=L(null),Ue=L(null),pt=L(null);function Tt(s,a){switch(Le(Ue,a),Le(Ye,s),Le(Oe,null),a.nodeType){case 9:case 11:s=(s=a.documentElement)&&(s=s.namespaceURI)?H0(s):0;break;default:if(s=a.tagName,a=a.namespaceURI)a=H0(a),s=$0(a,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}se(Oe),Le(Oe,s)}function at(){se(Oe),se(Ye),se(Ue)}function Gt(s){s.memoizedState!==null&&Le(pt,s);var a=Oe.current,o=$0(a,s.type);a!==o&&(Le(Ye,s),Le(Oe,o))}function zs(s){Ye.current===s&&(se(Oe),se(Ye)),pt.current===s&&(se(pt),zc._currentValue=Pe)}var yt,ut;function oe(s){if(yt===void 0)try{throw Error()}catch(o){var a=o.stack.trim().match(/\n( *(at )?)/);yt=a&&a[1]||"",ut=-1<o.stack.indexOf(`
    at`)?" (<anonymous>)":-1<o.stack.indexOf("@")?"@unknown:0:0":""}return`
`+yt+s+ut}var ss=!1;function Ht(s,a){if(!s||ss)return"";ss=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var c={DetermineComponentFrameRoot:function(){try{if(a){var Ie=function(){throw Error()};if(Object.defineProperty(Ie.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Ie,[])}catch(pe){var le=pe}Reflect.construct(s,[],Ie)}else{try{Ie.call()}catch(pe){le=pe}s.call(Ie.prototype)}}else{try{throw Error()}catch(pe){le=pe}(Ie=s())&&typeof Ie.catch=="function"&&Ie.catch(function(){})}}catch(pe){if(pe&&le&&typeof pe.stack=="string")return[pe.stack,le.stack]}return[null,null]}};c.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var m=Object.getOwnPropertyDescriptor(c.DetermineComponentFrameRoot,"name");m&&m.configurable&&Object.defineProperty(c.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var f=c.DetermineComponentFrameRoot(),x=f[0],S=f[1];if(x&&S){var z=x.split(`
`),ie=S.split(`
`);for(m=c=0;c<z.length&&!z[c].includes("DetermineComponentFrameRoot");)c++;for(;m<ie.length&&!ie[m].includes("DetermineComponentFrameRoot");)m++;if(c===z.length||m===ie.length)for(c=z.length-1,m=ie.length-1;1<=c&&0<=m&&z[c]!==ie[m];)m--;for(;1<=c&&0<=m;c--,m--)if(z[c]!==ie[m]){if(c!==1||m!==1)do if(c--,m--,0>m||z[c]!==ie[m]){var Te=`
`+z[c].replace(" at new "," at ");return s.displayName&&Te.includes("<anonymous>")&&(Te=Te.replace("<anonymous>",s.displayName)),Te}while(1<=c&&0<=m);break}}}finally{ss=!1,Error.prepareStackTrace=o}return(o=s?s.displayName||s.name:"")?oe(o):""}function Dt(s,a){switch(s.tag){case 26:case 27:case 5:return oe(s.type);case 16:return oe("Lazy");case 13:return s.child!==a&&a!==null?oe("Suspense Fallback"):oe("Suspense");case 19:return oe("SuspenseList");case 0:case 15:return Ht(s.type,!1);case 11:return Ht(s.type.render,!1);case 1:return Ht(s.type,!0);case 31:return oe("Activity");default:return""}}function bt(s){try{var a="",o=null;do a+=Dt(s,o),o=s,s=s.return;while(s);return a}catch(c){return`
Error generating stack: `+c.message+`
`+c.stack}}var Ge=Object.prototype.hasOwnProperty,Ze=n.unstable_scheduleCallback,Et=n.unstable_cancelCallback,rn=n.unstable_shouldYield,js=n.unstable_requestPaint,Kt=n.unstable_now,St=n.unstable_getCurrentPriorityLevel,Yt=n.unstable_ImmediatePriority,us=n.unstable_UserBlockingPriority,es=n.unstable_NormalPriority,Xs=n.unstable_LowPriority,Nt=n.unstable_IdlePriority,ps=n.log,be=n.unstable_setDisableYieldValue,De=null,Y=null;function we(s){if(typeof ps=="function"&&be(s),Y&&typeof Y.setStrictMode=="function")try{Y.setStrictMode(De,s)}catch{}}var Ce=Math.clz32?Math.clz32:it,Me=Math.log,Ae=Math.LN2;function it(s){return s>>>=0,s===0?32:31-(Me(s)/Ae|0)|0}var Qe=256,Q=262144,ce=4194304;function ze(s){var a=s&42;if(a!==0)return a;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return s&261888;case 262144:case 524288:case 1048576:case 2097152:return s&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function dt(s,a,o){var c=s.pendingLanes;if(c===0)return 0;var m=0,f=s.suspendedLanes,x=s.pingedLanes;s=s.warmLanes;var S=c&134217727;return S!==0?(c=S&~f,c!==0?m=ze(c):(x&=S,x!==0?m=ze(x):o||(o=S&~s,o!==0&&(m=ze(o))))):(S=c&~f,S!==0?m=ze(S):x!==0?m=ze(x):o||(o=c&~s,o!==0&&(m=ze(o)))),m===0?0:a!==0&&a!==m&&(a&f)===0&&(f=m&-m,o=a&-a,f>=o||f===32&&(o&4194048)!==0)?a:m}function ht(s,a){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&a)===0}function Vt(s,a){switch(s){case 1:case 2:case 4:case 8:case 64:return a+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ct(){var s=ce;return ce<<=1,(ce&62914560)===0&&(ce=4194304),s}function At(s){for(var a=[],o=0;31>o;o++)a.push(s);return a}function Ms(s,a){s.pendingLanes|=a,a!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function Js(s,a,o,c,m,f){var x=s.pendingLanes;s.pendingLanes=o,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=o,s.entangledLanes&=o,s.errorRecoveryDisabledLanes&=o,s.shellSuspendCounter=0;var S=s.entanglements,z=s.expirationTimes,ie=s.hiddenUpdates;for(o=x&~o;0<o;){var Te=31-Ce(o),Ie=1<<Te;S[Te]=0,z[Te]=-1;var le=ie[Te];if(le!==null)for(ie[Te]=null,Te=0;Te<le.length;Te++){var pe=le[Te];pe!==null&&(pe.lane&=-536870913)}o&=~Ie}c!==0&&ns(s,c,0),f!==0&&m===0&&s.tag!==0&&(s.suspendedLanes|=f&~(x&~a))}function ns(s,a,o){s.pendingLanes|=a,s.suspendedLanes&=~a;var c=31-Ce(a);s.entangledLanes|=a,s.entanglements[c]=s.entanglements[c]|1073741824|o&261930}function Cs(s,a){var o=s.entangledLanes|=a;for(s=s.entanglements;o;){var c=31-Ce(o),m=1<<c;m&a|s[c]&a&&(s[c]|=a),o&=~m}}function Ls(s,a){var o=a&-a;return o=(o&42)!==0?1:q(o),(o&(s.suspendedLanes|a))!==0?0:o}function q(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function xe(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function Ee(){var s=he.p;return s!==0?s:(s=window.event,s===void 0?32:f1(s.type))}function je(s,a){var o=he.p;try{return he.p=s,a()}finally{he.p=o}}var ke=Math.random().toString(36).slice(2),ot="__reactFiber$"+ke,mt="__reactProps$"+ke,et="__reactContainer$"+ke,gt="__reactEvents$"+ke,Rt="__reactListeners$"+ke,ws="__reactHandles$"+ke,_n="__reactResources$"+ke,ln="__reactMarker$"+ke;function Ln(s){delete s[ot],delete s[mt],delete s[gt],delete s[Rt],delete s[ws]}function kn(s){var a=s[ot];if(a)return a;for(var o=s.parentNode;o;){if(a=o[et]||o[ot]){if(o=a.alternate,a.child!==null||o!==null&&o.child!==null)for(s=J0(s);s!==null;){if(o=s[ot])return o;s=J0(s)}return a}s=o,o=s.parentNode}return null}function pn(s){if(s=s[ot]||s[et]){var a=s.tag;if(a===5||a===6||a===13||a===31||a===26||a===27||a===3)return s}return null}function Hs(s){var a=s.tag;if(a===5||a===26||a===27||a===6)return s.stateNode;throw Error(i(33))}function k(s){var a=s[_n];return a||(a=s[_n]={hoistableStyles:new Map,hoistableScripts:new Map}),a}function N(s){s[ln]=!0}var P=new Set,B={};function ue(s,a){Be(s,a),Be(s+"Capture",a)}function Be(s,a){for(B[s]=a,s=0;s<a.length;s++)P.add(a[s])}var Fe=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),tt={},Xe={};function Qt(s){return Ge.call(Xe,s)?!0:Ge.call(tt,s)?!1:Fe.test(s)?Xe[s]=!0:(tt[s]=!0,!1)}function Ts(s,a,o){if(Qt(a))if(o===null)s.removeAttribute(a);else{switch(typeof o){case"undefined":case"function":case"symbol":s.removeAttribute(a);return;case"boolean":var c=a.toLowerCase().slice(0,5);if(c!=="data-"&&c!=="aria-"){s.removeAttribute(a);return}}s.setAttribute(a,""+o)}}function as(s,a,o){if(o===null)s.removeAttribute(a);else{switch(typeof o){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(a);return}s.setAttribute(a,""+o)}}function cs(s,a,o,c){if(c===null)s.removeAttribute(o);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(o);return}s.setAttributeNS(a,o,""+c)}}function Os(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function On(s){var a=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(a==="checkbox"||a==="radio")}function mr(s,a,o){var c=Object.getOwnPropertyDescriptor(s.constructor.prototype,a);if(!s.hasOwnProperty(a)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var m=c.get,f=c.set;return Object.defineProperty(s,a,{configurable:!0,get:function(){return m.call(this)},set:function(x){o=""+x,f.call(this,x)}}),Object.defineProperty(s,a,{enumerable:c.enumerable}),{getValue:function(){return o},setValue:function(x){o=""+x},stopTracking:function(){s._valueTracker=null,delete s[a]}}}}function ds(s){if(!s._valueTracker){var a=On(s)?"checked":"value";s._valueTracker=mr(s,a,""+s[a])}}function Kn(s){if(!s)return!1;var a=s._valueTracker;if(!a)return!0;var o=a.getValue(),c="";return s&&(c=On(s)?s.checked?"true":"false":s.value),s=c,s!==o?(a.setValue(s),!0):!1}function X(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var _e=/[\n"\\]/g;function me(s){return s.replace(_e,function(a){return"\\"+a.charCodeAt(0).toString(16)+" "})}function We(s,a,o,c,m,f,x,S){s.name="",x!=null&&typeof x!="function"&&typeof x!="symbol"&&typeof x!="boolean"?s.type=x:s.removeAttribute("type"),a!=null?x==="number"?(a===0&&s.value===""||s.value!=a)&&(s.value=""+Os(a)):s.value!==""+Os(a)&&(s.value=""+Os(a)):x!=="submit"&&x!=="reset"||s.removeAttribute("value"),a!=null?lt(s,x,Os(a)):o!=null?lt(s,x,Os(o)):c!=null&&s.removeAttribute("value"),m==null&&f!=null&&(s.defaultChecked=!!f),m!=null&&(s.checked=m&&typeof m!="function"&&typeof m!="symbol"),S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"?s.name=""+Os(S):s.removeAttribute("name")}function st(s,a,o,c,m,f,x,S){if(f!=null&&typeof f!="function"&&typeof f!="symbol"&&typeof f!="boolean"&&(s.type=f),a!=null||o!=null){if(!(f!=="submit"&&f!=="reset"||a!=null)){ds(s);return}o=o!=null?""+Os(o):"",a=a!=null?""+Os(a):o,S||a===s.value||(s.value=a),s.defaultValue=a}c=c??m,c=typeof c!="function"&&typeof c!="symbol"&&!!c,s.checked=S?s.checked:!!c,s.defaultChecked=!!c,x!=null&&typeof x!="function"&&typeof x!="symbol"&&typeof x!="boolean"&&(s.name=x),ds(s)}function lt(s,a,o){a==="number"&&X(s.ownerDocument)===s||s.defaultValue===""+o||(s.defaultValue=""+o)}function Mt(s,a,o,c){if(s=s.options,a){a={};for(var m=0;m<o.length;m++)a["$"+o[m]]=!0;for(o=0;o<s.length;o++)m=a.hasOwnProperty("$"+s[o].value),s[o].selected!==m&&(s[o].selected=m),m&&c&&(s[o].defaultSelected=!0)}else{for(o=""+Os(o),a=null,m=0;m<s.length;m++){if(s[m].value===o){s[m].selected=!0,c&&(s[m].defaultSelected=!0);return}a!==null||s[m].disabled||(a=s[m])}a!==null&&(a.selected=!0)}}function Xt(s,a,o){if(a!=null&&(a=""+Os(a),a!==s.value&&(s.value=a),o==null)){s.defaultValue!==a&&(s.defaultValue=a);return}s.defaultValue=o!=null?""+Os(o):""}function is(s,a,o,c){if(a==null){if(c!=null){if(o!=null)throw Error(i(92));if(xt(c)){if(1<c.length)throw Error(i(93));c=c[0]}o=c}o==null&&(o=""),a=o}o=Os(a),s.defaultValue=o,c=s.textContent,c===o&&c!==""&&c!==null&&(s.value=c),ds(s)}function Rs(s,a){if(a){var o=s.firstChild;if(o&&o===s.lastChild&&o.nodeType===3){o.nodeValue=a;return}}s.textContent=a}var os=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Vs(s,a,o){var c=a.indexOf("--")===0;o==null||typeof o=="boolean"||o===""?c?s.setProperty(a,""):a==="float"?s.cssFloat="":s[a]="":c?s.setProperty(a,o):typeof o!="number"||o===0||os.has(a)?a==="float"?s.cssFloat=o:s[a]=(""+o).trim():s[a]=o+"px"}function Sr(s,a,o){if(a!=null&&typeof a!="object")throw Error(i(62));if(s=s.style,o!=null){for(var c in o)!o.hasOwnProperty(c)||a!=null&&a.hasOwnProperty(c)||(c.indexOf("--")===0?s.setProperty(c,""):c==="float"?s.cssFloat="":s[c]="");for(var m in a)c=a[m],a.hasOwnProperty(m)&&o[m]!==c&&Vs(s,m,c)}else for(var f in a)a.hasOwnProperty(f)&&Vs(s,f,a[f])}function Nr(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ar=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Yn=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function ls(s){return Yn.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}function Bs(){}var zn=null;function jn(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var Qn=null,cn=null;function Vn(s){var a=pn(s);if(a&&(s=a.stateNode)){var o=s[mt]||null;e:switch(s=a.stateNode,a.type){case"input":if(We(s,o.value,o.defaultValue,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name),a=o.name,o.type==="radio"&&a!=null){for(o=s;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll('input[name="'+me(""+a)+'"][type="radio"]'),a=0;a<o.length;a++){var c=o[a];if(c!==s&&c.form===s.form){var m=c[mt]||null;if(!m)throw Error(i(90));We(c,m.value,m.defaultValue,m.defaultValue,m.checked,m.defaultChecked,m.type,m.name)}}for(a=0;a<o.length;a++)c=o[a],c.form===s.form&&Kn(c)}break e;case"textarea":Xt(s,o.value,o.defaultValue);break e;case"select":a=o.value,a!=null&&Mt(s,!!o.multiple,a,!1)}}}var Cr=!1;function Br(s,a,o){if(Cr)return s(a,o);Cr=!0;try{var c=s(a);return c}finally{if(Cr=!1,(Qn!==null||cn!==null)&&(Ad(),Qn&&(a=Qn,s=cn,cn=Qn=null,Vn(a),s)))for(a=0;a<s.length;a++)Vn(s[a])}}function fr(s,a){var o=s.stateNode;if(o===null)return null;var c=o[mt]||null;if(c===null)return null;o=c[a];e:switch(a){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(c=!c.disabled)||(s=s.type,c=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!c;break e;default:s=!1}if(s)return null;if(o&&typeof o!="function")throw Error(i(231,a,typeof o));return o}var M=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Z=!1;if(M)try{var Se={};Object.defineProperty(Se,"passive",{get:function(){Z=!0}}),window.addEventListener("test",Se,Se),window.removeEventListener("test",Se,Se)}catch{Z=!1}var Je=null,_t=null,Pt=null;function rt(){if(Pt)return Pt;var s,a=_t,o=a.length,c,m="value"in Je?Je.value:Je.textContent,f=m.length;for(s=0;s<o&&a[s]===m[s];s++);var x=o-s;for(c=1;c<=x&&a[o-c]===m[f-c];c++);return Pt=m.slice(s,1<c?1-c:void 0)}function Bt(s){var a=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&a===13&&(s=13)):s=a,s===10&&(s=13),32<=s||s===13?s:0}function zt(){return!0}function rs(){return!1}function Ut(s){function a(o,c,m,f,x){this._reactName=o,this._targetInst=m,this.type=c,this.nativeEvent=f,this.target=x,this.currentTarget=null;for(var S in s)s.hasOwnProperty(S)&&(o=s[S],this[S]=o?o(f):f[S]);return this.isDefaultPrevented=(f.defaultPrevented!=null?f.defaultPrevented:f.returnValue===!1)?zt:rs,this.isPropagationStopped=rs,this}return j(a.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=zt)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=zt)},persist:function(){},isPersistent:zt}),a}var _s={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},qn=Ut(_s),pr=j({},_s,{view:0,detail:0}),sn=Ut(pr),Zs,Hn,mn,Bn=j({},pr,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:_i,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==mn&&(mn&&s.type==="mousemove"?(Zs=s.screenX-mn.screenX,Hn=s.screenY-mn.screenY):Hn=Zs=0,mn=s),Zs)},movementY:function(s){return"movementY"in s?s.movementY:Hn}}),ir=Ut(Bn),Xn=j({},Bn,{dataTransfer:0}),gr=Ut(Xn),or=j({},pr,{relatedTarget:0}),gn=Ut(or),yr=j({},_s,{animationName:0,elapsedTime:0,pseudoElement:0}),Rr=Ut(yr),$a=j({},_s,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),tl=Ut($a),sl=j({},_s,{data:0}),br=Ut(sl),ca={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ua={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Wu={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Gu(s){var a=this.nativeEvent;return a.getModifierState?a.getModifierState(s):(s=Wu[s])?!!a[s]:!1}function _i(){return Gu}var vr=j({},pr,{key:function(s){if(s.key){var a=ca[s.key]||s.key;if(a!=="Unidentified")return a}return s.type==="keypress"?(s=Bt(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?ua[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:_i,charCode:function(s){return s.type==="keypress"?Bt(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?Bt(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),Ku=Ut(vr),Yu=j({},Bn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Wa=Ut(Yu),h=j({},pr,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:_i}),b=Ut(h),_=j({},_s,{propertyName:0,elapsedTime:0,pseudoElement:0}),C=Ut(_),ne=j({},Bn,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),de=Ut(ne),Ke=j({},_s,{newState:0,oldState:0}),Jt=Ut(Ke),Tn=[9,13,27,32],Us=M&&"CompositionEvent"in window,un=null;M&&"documentMode"in document&&(un=document.documentMode);var Xr=M&&"TextEvent"in window&&!un,Sa=M&&(!Us||un&&8<un&&11>=un),da=" ",ha=!1;function bo(s,a){switch(s){case"keyup":return Tn.indexOf(a.keyCode)!==-1;case"keydown":return a.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function nl(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var rl=!1;function Hk(s,a){switch(s){case"compositionend":return nl(a);case"keypress":return a.which!==32?null:(ha=!0,da);case"textInput":return s=a.data,s===da&&ha?null:s;default:return null}}function $k(s,a){if(rl)return s==="compositionend"||!Us&&bo(s,a)?(s=rt(),Pt=_t=Je=null,rl=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(a.ctrlKey||a.altKey||a.metaKey)||a.ctrlKey&&a.altKey){if(a.char&&1<a.char.length)return a.char;if(a.which)return String.fromCharCode(a.which)}return null;case"compositionend":return Sa&&a.locale!=="ko"?null:a.data;default:return null}}var Wk={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function tb(s){var a=s&&s.nodeName&&s.nodeName.toLowerCase();return a==="input"?!!Wk[s.type]:a==="textarea"}function sb(s,a,o,c){Qn?cn?cn.push(c):cn=[c]:Qn=c,a=Vd(a,"onChange"),0<a.length&&(o=new qn("onChange","change",null,o,c),s.push({event:o,listeners:a}))}var uc=null,dc=null;function Gk(s){V0(s,0)}function Qu(s){var a=Hs(s);if(Kn(a))return s}function nb(s,a){if(s==="change")return a}var rb=!1;if(M){var _m;if(M){var km="oninput"in document;if(!km){var ab=document.createElement("div");ab.setAttribute("oninput","return;"),km=typeof ab.oninput=="function"}_m=km}else _m=!1;rb=_m&&(!document.documentMode||9<document.documentMode)}function ib(){uc&&(uc.detachEvent("onpropertychange",ob),dc=uc=null)}function ob(s){if(s.propertyName==="value"&&Qu(dc)){var a=[];sb(a,dc,s,jn(s)),Br(Gk,a)}}function Kk(s,a,o){s==="focusin"?(ib(),uc=a,dc=o,uc.attachEvent("onpropertychange",ob)):s==="focusout"&&ib()}function Yk(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return Qu(dc)}function Qk(s,a){if(s==="click")return Qu(a)}function Xk(s,a){if(s==="input"||s==="change")return Qu(a)}function Jk(s,a){return s===a&&(s!==0||1/s===1/a)||s!==s&&a!==a}var Ur=typeof Object.is=="function"?Object.is:Jk;function hc(s,a){if(Ur(s,a))return!0;if(typeof s!="object"||s===null||typeof a!="object"||a===null)return!1;var o=Object.keys(s),c=Object.keys(a);if(o.length!==c.length)return!1;for(c=0;c<o.length;c++){var m=o[c];if(!Ge.call(a,m)||!Ur(s[m],a[m]))return!1}return!0}function lb(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function cb(s,a){var o=lb(s);s=0;for(var c;o;){if(o.nodeType===3){if(c=s+o.textContent.length,s<=a&&c>=a)return{node:o,offset:a-s};s=c}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=lb(o)}}function ub(s,a){return s&&a?s===a?!0:s&&s.nodeType===3?!1:a&&a.nodeType===3?ub(s,a.parentNode):"contains"in s?s.contains(a):s.compareDocumentPosition?!!(s.compareDocumentPosition(a)&16):!1:!1}function db(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var a=X(s.document);a instanceof s.HTMLIFrameElement;){try{var o=typeof a.contentWindow.location.href=="string"}catch{o=!1}if(o)s=a.contentWindow;else break;a=X(s.document)}return a}function jm(s){var a=s&&s.nodeName&&s.nodeName.toLowerCase();return a&&(a==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||a==="textarea"||s.contentEditable==="true")}var Zk=M&&"documentMode"in document&&11>=document.documentMode,al=null,Tm=null,mc=null,Em=!1;function hb(s,a,o){var c=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;Em||al==null||al!==X(c)||(c=al,"selectionStart"in c&&jm(c)?c={start:c.selectionStart,end:c.selectionEnd}:(c=(c.ownerDocument&&c.ownerDocument.defaultView||window).getSelection(),c={anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset}),mc&&hc(mc,c)||(mc=c,c=Vd(Tm,"onSelect"),0<c.length&&(a=new qn("onSelect","select",null,a,o),s.push({event:a,listeners:c}),a.target=al)))}function vo(s,a){var o={};return o[s.toLowerCase()]=a.toLowerCase(),o["Webkit"+s]="webkit"+a,o["Moz"+s]="moz"+a,o}var il={animationend:vo("Animation","AnimationEnd"),animationiteration:vo("Animation","AnimationIteration"),animationstart:vo("Animation","AnimationStart"),transitionrun:vo("Transition","TransitionRun"),transitionstart:vo("Transition","TransitionStart"),transitioncancel:vo("Transition","TransitionCancel"),transitionend:vo("Transition","TransitionEnd")},Sm={},mb={};M&&(mb=document.createElement("div").style,"AnimationEvent"in window||(delete il.animationend.animation,delete il.animationiteration.animation,delete il.animationstart.animation),"TransitionEvent"in window||delete il.transitionend.transition);function xo(s){if(Sm[s])return Sm[s];if(!il[s])return s;var a=il[s],o;for(o in a)if(a.hasOwnProperty(o)&&o in mb)return Sm[s]=a[o];return s}var fb=xo("animationend"),pb=xo("animationiteration"),gb=xo("animationstart"),ej=xo("transitionrun"),tj=xo("transitionstart"),sj=xo("transitioncancel"),yb=xo("transitionend"),bb=new Map,Nm="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Nm.push("scrollEnd");function ma(s,a){bb.set(s,a),ue(a,[s])}var Xu=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var a=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(a))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)},Jr=[],ol=0,Cm=0;function Ju(){for(var s=ol,a=Cm=ol=0;a<s;){var o=Jr[a];Jr[a++]=null;var c=Jr[a];Jr[a++]=null;var m=Jr[a];Jr[a++]=null;var f=Jr[a];if(Jr[a++]=null,c!==null&&m!==null){var x=c.pending;x===null?m.next=m:(m.next=x.next,x.next=m),c.pending=m}f!==0&&vb(o,m,f)}}function Zu(s,a,o,c){Jr[ol++]=s,Jr[ol++]=a,Jr[ol++]=o,Jr[ol++]=c,Cm|=c,s.lanes|=c,s=s.alternate,s!==null&&(s.lanes|=c)}function Rm(s,a,o,c){return Zu(s,a,o,c),ed(s)}function wo(s,a){return Zu(s,null,null,a),ed(s)}function vb(s,a,o){s.lanes|=o;var c=s.alternate;c!==null&&(c.lanes|=o);for(var m=!1,f=s.return;f!==null;)f.childLanes|=o,c=f.alternate,c!==null&&(c.childLanes|=o),f.tag===22&&(s=f.stateNode,s===null||s._visibility&1||(m=!0)),s=f,f=f.return;return s.tag===3?(f=s.stateNode,m&&a!==null&&(m=31-Ce(o),s=f.hiddenUpdates,c=s[m],c===null?s[m]=[a]:c.push(a),a.lane=o|536870912),f):null}function ed(s){if(50<Pc)throw Pc=0,Uf=null,Error(i(185));for(var a=s.return;a!==null;)s=a,a=s.return;return s.tag===3?s.stateNode:null}var ll={};function nj(s,a,o,c){this.tag=s,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=a,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=c,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Fr(s,a,o,c){return new nj(s,a,o,c)}function Am(s){return s=s.prototype,!(!s||!s.isReactComponent)}function Ga(s,a){var o=s.alternate;return o===null?(o=Fr(s.tag,a,s.key,s.mode),o.elementType=s.elementType,o.type=s.type,o.stateNode=s.stateNode,o.alternate=s,s.alternate=o):(o.pendingProps=a,o.type=s.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=s.flags&65011712,o.childLanes=s.childLanes,o.lanes=s.lanes,o.child=s.child,o.memoizedProps=s.memoizedProps,o.memoizedState=s.memoizedState,o.updateQueue=s.updateQueue,a=s.dependencies,o.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext},o.sibling=s.sibling,o.index=s.index,o.ref=s.ref,o.refCleanup=s.refCleanup,o}function xb(s,a){s.flags&=65011714;var o=s.alternate;return o===null?(s.childLanes=0,s.lanes=a,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,a=o.dependencies,s.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),s}function td(s,a,o,c,m,f){var x=0;if(c=s,typeof s=="function")Am(s)&&(x=1);else if(typeof s=="string")x=lT(s,o,Oe.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case A:return s=Fr(31,o,a,m),s.elementType=A,s.lanes=f,s;case F:return _o(o.children,m,f,a);case U:x=8,m|=24;break;case te:return s=Fr(12,o,a,m|2),s.elementType=te,s.lanes=f,s;case ve:return s=Fr(13,o,a,m),s.elementType=ve,s.lanes=f,s;case ge:return s=Fr(19,o,a,m),s.elementType=ge,s.lanes=f,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case re:x=10;break e;case K:x=9;break e;case ye:x=11;break e;case R:x=14;break e;case E:x=16,c=null;break e}x=29,o=Error(i(130,s===null?"null":typeof s,"")),c=null}return a=Fr(x,o,a,m),a.elementType=s,a.type=c,a.lanes=f,a}function _o(s,a,o,c){return s=Fr(7,s,c,a),s.lanes=o,s}function Mm(s,a,o){return s=Fr(6,s,null,a),s.lanes=o,s}function wb(s){var a=Fr(18,null,null,0);return a.stateNode=s,a}function Im(s,a,o){return a=Fr(4,s.children!==null?s.children:[],s.key,a),a.lanes=o,a.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},a}var _b=new WeakMap;function Zr(s,a){if(typeof s=="object"&&s!==null){var o=_b.get(s);return o!==void 0?o:(a={value:s,source:a,stack:bt(a)},_b.set(s,a),a)}return{value:s,source:a,stack:bt(a)}}var cl=[],ul=0,sd=null,fc=0,ea=[],ta=0,ki=null,Na=1,Ca="";function Ka(s,a){cl[ul++]=fc,cl[ul++]=sd,sd=s,fc=a}function kb(s,a,o){ea[ta++]=Na,ea[ta++]=Ca,ea[ta++]=ki,ki=s;var c=Na;s=Ca;var m=32-Ce(c)-1;c&=~(1<<m),o+=1;var f=32-Ce(a)+m;if(30<f){var x=m-m%5;f=(c&(1<<x)-1).toString(32),c>>=x,m-=x,Na=1<<32-Ce(a)+m|o<<m|c,Ca=f+s}else Na=1<<f|o<<m|c,Ca=s}function Dm(s){s.return!==null&&(Ka(s,1),kb(s,1,0))}function Pm(s){for(;s===sd;)sd=cl[--ul],cl[ul]=null,fc=cl[--ul],cl[ul]=null;for(;s===ki;)ki=ea[--ta],ea[ta]=null,Ca=ea[--ta],ea[ta]=null,Na=ea[--ta],ea[ta]=null}function jb(s,a){ea[ta++]=Na,ea[ta++]=Ca,ea[ta++]=ki,Na=a.id,Ca=a.overflow,ki=s}var Jn=null,an=null,ks=!1,ji=null,sa=!1,Lm=Error(i(519));function Ti(s){var a=Error(i(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw pc(Zr(a,s)),Lm}function Tb(s){var a=s.stateNode,o=s.type,c=s.memoizedProps;switch(a[ot]=s,a[mt]=c,o){case"dialog":ms("cancel",a),ms("close",a);break;case"iframe":case"object":case"embed":ms("load",a);break;case"video":case"audio":for(o=0;o<Oc.length;o++)ms(Oc[o],a);break;case"source":ms("error",a);break;case"img":case"image":case"link":ms("error",a),ms("load",a);break;case"details":ms("toggle",a);break;case"input":ms("invalid",a),st(a,c.value,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name,!0);break;case"select":ms("invalid",a);break;case"textarea":ms("invalid",a),is(a,c.value,c.defaultValue,c.children)}o=c.children,typeof o!="string"&&typeof o!="number"&&typeof o!="bigint"||a.textContent===""+o||c.suppressHydrationWarning===!0||z0(a.textContent,o)?(c.popover!=null&&(ms("beforetoggle",a),ms("toggle",a)),c.onScroll!=null&&ms("scroll",a),c.onScrollEnd!=null&&ms("scrollend",a),c.onClick!=null&&(a.onclick=Bs),a=!0):a=!1,a||Ti(s,!0)}function Eb(s){for(Jn=s.return;Jn;)switch(Jn.tag){case 5:case 31:case 13:sa=!1;return;case 27:case 3:sa=!0;return;default:Jn=Jn.return}}function dl(s){if(s!==Jn)return!1;if(!ks)return Eb(s),ks=!0,!1;var a=s.tag,o;if((o=a!==3&&a!==27)&&((o=a===5)&&(o=s.type,o=!(o!=="form"&&o!=="button")||tp(s.type,s.memoizedProps)),o=!o),o&&an&&Ti(s),Eb(s),a===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(317));an=X0(s)}else if(a===31){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(317));an=X0(s)}else a===27?(a=an,Bi(s.type)?(s=ip,ip=null,an=s):an=a):an=Jn?ra(s.stateNode.nextSibling):null;return!0}function ko(){an=Jn=null,ks=!1}function Om(){var s=ji;return s!==null&&(Dr===null?Dr=s:Dr.push.apply(Dr,s),ji=null),s}function pc(s){ji===null?ji=[s]:ji.push(s)}var Vm=L(null),jo=null,Ya=null;function Ei(s,a,o){Le(Vm,a._currentValue),a._currentValue=o}function Qa(s){s._currentValue=Vm.current,se(Vm)}function Bm(s,a,o){for(;s!==null;){var c=s.alternate;if((s.childLanes&a)!==a?(s.childLanes|=a,c!==null&&(c.childLanes|=a)):c!==null&&(c.childLanes&a)!==a&&(c.childLanes|=a),s===o)break;s=s.return}}function Um(s,a,o,c){var m=s.child;for(m!==null&&(m.return=s);m!==null;){var f=m.dependencies;if(f!==null){var x=m.child;f=f.firstContext;e:for(;f!==null;){var S=f;f=m;for(var z=0;z<a.length;z++)if(S.context===a[z]){f.lanes|=o,S=f.alternate,S!==null&&(S.lanes|=o),Bm(f.return,o,s),c||(x=null);break e}f=S.next}}else if(m.tag===18){if(x=m.return,x===null)throw Error(i(341));x.lanes|=o,f=x.alternate,f!==null&&(f.lanes|=o),Bm(x,o,s),x=null}else x=m.child;if(x!==null)x.return=m;else for(x=m;x!==null;){if(x===s){x=null;break}if(m=x.sibling,m!==null){m.return=x.return,x=m;break}x=x.return}m=x}}function hl(s,a,o,c){s=null;for(var m=a,f=!1;m!==null;){if(!f){if((m.flags&524288)!==0)f=!0;else if((m.flags&262144)!==0)break}if(m.tag===10){var x=m.alternate;if(x===null)throw Error(i(387));if(x=x.memoizedProps,x!==null){var S=m.type;Ur(m.pendingProps.value,x.value)||(s!==null?s.push(S):s=[S])}}else if(m===pt.current){if(x=m.alternate,x===null)throw Error(i(387));x.memoizedState.memoizedState!==m.memoizedState.memoizedState&&(s!==null?s.push(zc):s=[zc])}m=m.return}s!==null&&Um(a,s,o,c),a.flags|=262144}function nd(s){for(s=s.firstContext;s!==null;){if(!Ur(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function To(s){jo=s,Ya=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function Zn(s){return Sb(jo,s)}function rd(s,a){return jo===null&&To(s),Sb(s,a)}function Sb(s,a){var o=a._currentValue;if(a={context:a,memoizedValue:o,next:null},Ya===null){if(s===null)throw Error(i(308));Ya=a,s.dependencies={lanes:0,firstContext:a},s.flags|=524288}else Ya=Ya.next=a;return o}var rj=typeof AbortController<"u"?AbortController:function(){var s=[],a=this.signal={aborted:!1,addEventListener:function(o,c){s.push(c)}};this.abort=function(){a.aborted=!0,s.forEach(function(o){return o()})}},aj=n.unstable_scheduleCallback,ij=n.unstable_NormalPriority,Cn={$$typeof:re,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Fm(){return{controller:new rj,data:new Map,refCount:0}}function gc(s){s.refCount--,s.refCount===0&&aj(ij,function(){s.controller.abort()})}var yc=null,zm=0,ml=0,fl=null;function oj(s,a){if(yc===null){var o=yc=[];zm=0,ml=Wf(),fl={status:"pending",value:void 0,then:function(c){o.push(c)}}}return zm++,a.then(Nb,Nb),a}function Nb(){if(--zm===0&&yc!==null){fl!==null&&(fl.status="fulfilled");var s=yc;yc=null,ml=0,fl=null;for(var a=0;a<s.length;a++)(0,s[a])()}}function lj(s,a){var o=[],c={status:"pending",value:null,reason:null,then:function(m){o.push(m)}};return s.then(function(){c.status="fulfilled",c.value=a;for(var m=0;m<o.length;m++)(0,o[m])(a)},function(m){for(c.status="rejected",c.reason=m,m=0;m<o.length;m++)(0,o[m])(void 0)}),c}var Cb=W.S;W.S=function(s,a){h0=Kt(),typeof a=="object"&&a!==null&&typeof a.then=="function"&&oj(s,a),Cb!==null&&Cb(s,a)};var Eo=L(null);function qm(){var s=Eo.current;return s!==null?s:en.pooledCache}function ad(s,a){a===null?Le(Eo,Eo.current):Le(Eo,a.pool)}function Rb(){var s=qm();return s===null?null:{parent:Cn._currentValue,pool:s}}var pl=Error(i(460)),Hm=Error(i(474)),id=Error(i(542)),od={then:function(){}};function Ab(s){return s=s.status,s==="fulfilled"||s==="rejected"}function Mb(s,a,o){switch(o=s[o],o===void 0?s.push(a):o!==a&&(a.then(Bs,Bs),a=o),a.status){case"fulfilled":return a.value;case"rejected":throw s=a.reason,Db(s),s;default:if(typeof a.status=="string")a.then(Bs,Bs);else{if(s=en,s!==null&&100<s.shellSuspendCounter)throw Error(i(482));s=a,s.status="pending",s.then(function(c){if(a.status==="pending"){var m=a;m.status="fulfilled",m.value=c}},function(c){if(a.status==="pending"){var m=a;m.status="rejected",m.reason=c}})}switch(a.status){case"fulfilled":return a.value;case"rejected":throw s=a.reason,Db(s),s}throw No=a,pl}}function So(s){try{var a=s._init;return a(s._payload)}catch(o){throw o!==null&&typeof o=="object"&&typeof o.then=="function"?(No=o,pl):o}}var No=null;function Ib(){if(No===null)throw Error(i(459));var s=No;return No=null,s}function Db(s){if(s===pl||s===id)throw Error(i(483))}var gl=null,bc=0;function ld(s){var a=bc;return bc+=1,gl===null&&(gl=[]),Mb(gl,s,a)}function vc(s,a){a=a.props.ref,s.ref=a!==void 0?a:null}function cd(s,a){throw a.$$typeof===T?Error(i(525)):(s=Object.prototype.toString.call(a),Error(i(31,s==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":s)))}function Pb(s){function a(J,G){if(s){var ae=J.deletions;ae===null?(J.deletions=[G],J.flags|=16):ae.push(G)}}function o(J,G){if(!s)return null;for(;G!==null;)a(J,G),G=G.sibling;return null}function c(J){for(var G=new Map;J!==null;)J.key!==null?G.set(J.key,J):G.set(J.index,J),J=J.sibling;return G}function m(J,G){return J=Ga(J,G),J.index=0,J.sibling=null,J}function f(J,G,ae){return J.index=ae,s?(ae=J.alternate,ae!==null?(ae=ae.index,ae<G?(J.flags|=67108866,G):ae):(J.flags|=67108866,G)):(J.flags|=1048576,G)}function x(J){return s&&J.alternate===null&&(J.flags|=67108866),J}function S(J,G,ae,Re){return G===null||G.tag!==6?(G=Mm(ae,J.mode,Re),G.return=J,G):(G=m(G,ae),G.return=J,G)}function z(J,G,ae,Re){var kt=ae.type;return kt===F?Te(J,G,ae.props.children,Re,ae.key):G!==null&&(G.elementType===kt||typeof kt=="object"&&kt!==null&&kt.$$typeof===E&&So(kt)===G.type)?(G=m(G,ae.props),vc(G,ae),G.return=J,G):(G=td(ae.type,ae.key,ae.props,null,J.mode,Re),vc(G,ae),G.return=J,G)}function ie(J,G,ae,Re){return G===null||G.tag!==4||G.stateNode.containerInfo!==ae.containerInfo||G.stateNode.implementation!==ae.implementation?(G=Im(ae,J.mode,Re),G.return=J,G):(G=m(G,ae.children||[]),G.return=J,G)}function Te(J,G,ae,Re,kt){return G===null||G.tag!==7?(G=_o(ae,J.mode,Re,kt),G.return=J,G):(G=m(G,ae),G.return=J,G)}function Ie(J,G,ae){if(typeof G=="string"&&G!==""||typeof G=="number"||typeof G=="bigint")return G=Mm(""+G,J.mode,ae),G.return=J,G;if(typeof G=="object"&&G!==null){switch(G.$$typeof){case V:return ae=td(G.type,G.key,G.props,null,J.mode,ae),vc(ae,G),ae.return=J,ae;case $:return G=Im(G,J.mode,ae),G.return=J,G;case E:return G=So(G),Ie(J,G,ae)}if(xt(G)||H(G))return G=_o(G,J.mode,ae,null),G.return=J,G;if(typeof G.then=="function")return Ie(J,ld(G),ae);if(G.$$typeof===re)return Ie(J,rd(J,G),ae);cd(J,G)}return null}function le(J,G,ae,Re){var kt=G!==null?G.key:null;if(typeof ae=="string"&&ae!==""||typeof ae=="number"||typeof ae=="bigint")return kt!==null?null:S(J,G,""+ae,Re);if(typeof ae=="object"&&ae!==null){switch(ae.$$typeof){case V:return ae.key===kt?z(J,G,ae,Re):null;case $:return ae.key===kt?ie(J,G,ae,Re):null;case E:return ae=So(ae),le(J,G,ae,Re)}if(xt(ae)||H(ae))return kt!==null?null:Te(J,G,ae,Re,null);if(typeof ae.then=="function")return le(J,G,ld(ae),Re);if(ae.$$typeof===re)return le(J,G,rd(J,ae),Re);cd(J,ae)}return null}function pe(J,G,ae,Re,kt){if(typeof Re=="string"&&Re!==""||typeof Re=="number"||typeof Re=="bigint")return J=J.get(ae)||null,S(G,J,""+Re,kt);if(typeof Re=="object"&&Re!==null){switch(Re.$$typeof){case V:return J=J.get(Re.key===null?ae:Re.key)||null,z(G,J,Re,kt);case $:return J=J.get(Re.key===null?ae:Re.key)||null,ie(G,J,Re,kt);case E:return Re=So(Re),pe(J,G,ae,Re,kt)}if(xt(Re)||H(Re))return J=J.get(ae)||null,Te(G,J,Re,kt,null);if(typeof Re.then=="function")return pe(J,G,ae,ld(Re),kt);if(Re.$$typeof===re)return pe(J,G,ae,rd(G,Re),kt);cd(G,Re)}return null}function ft(J,G,ae,Re){for(var kt=null,Is=null,vt=G,ts=G=0,ys=null;vt!==null&&ts<ae.length;ts++){vt.index>ts?(ys=vt,vt=null):ys=vt.sibling;var Ds=le(J,vt,ae[ts],Re);if(Ds===null){vt===null&&(vt=ys);break}s&&vt&&Ds.alternate===null&&a(J,vt),G=f(Ds,G,ts),Is===null?kt=Ds:Is.sibling=Ds,Is=Ds,vt=ys}if(ts===ae.length)return o(J,vt),ks&&Ka(J,ts),kt;if(vt===null){for(;ts<ae.length;ts++)vt=Ie(J,ae[ts],Re),vt!==null&&(G=f(vt,G,ts),Is===null?kt=vt:Is.sibling=vt,Is=vt);return ks&&Ka(J,ts),kt}for(vt=c(vt);ts<ae.length;ts++)ys=pe(vt,J,ts,ae[ts],Re),ys!==null&&(s&&ys.alternate!==null&&vt.delete(ys.key===null?ts:ys.key),G=f(ys,G,ts),Is===null?kt=ys:Is.sibling=ys,Is=ys);return s&&vt.forEach(function(Hi){return a(J,Hi)}),ks&&Ka(J,ts),kt}function It(J,G,ae,Re){if(ae==null)throw Error(i(151));for(var kt=null,Is=null,vt=G,ts=G=0,ys=null,Ds=ae.next();vt!==null&&!Ds.done;ts++,Ds=ae.next()){vt.index>ts?(ys=vt,vt=null):ys=vt.sibling;var Hi=le(J,vt,Ds.value,Re);if(Hi===null){vt===null&&(vt=ys);break}s&&vt&&Hi.alternate===null&&a(J,vt),G=f(Hi,G,ts),Is===null?kt=Hi:Is.sibling=Hi,Is=Hi,vt=ys}if(Ds.done)return o(J,vt),ks&&Ka(J,ts),kt;if(vt===null){for(;!Ds.done;ts++,Ds=ae.next())Ds=Ie(J,Ds.value,Re),Ds!==null&&(G=f(Ds,G,ts),Is===null?kt=Ds:Is.sibling=Ds,Is=Ds);return ks&&Ka(J,ts),kt}for(vt=c(vt);!Ds.done;ts++,Ds=ae.next())Ds=pe(vt,J,ts,Ds.value,Re),Ds!==null&&(s&&Ds.alternate!==null&&vt.delete(Ds.key===null?ts:Ds.key),G=f(Ds,G,ts),Is===null?kt=Ds:Is.sibling=Ds,Is=Ds);return s&&vt.forEach(function(vT){return a(J,vT)}),ks&&Ka(J,ts),kt}function Ys(J,G,ae,Re){if(typeof ae=="object"&&ae!==null&&ae.type===F&&ae.key===null&&(ae=ae.props.children),typeof ae=="object"&&ae!==null){switch(ae.$$typeof){case V:e:{for(var kt=ae.key;G!==null;){if(G.key===kt){if(kt=ae.type,kt===F){if(G.tag===7){o(J,G.sibling),Re=m(G,ae.props.children),Re.return=J,J=Re;break e}}else if(G.elementType===kt||typeof kt=="object"&&kt!==null&&kt.$$typeof===E&&So(kt)===G.type){o(J,G.sibling),Re=m(G,ae.props),vc(Re,ae),Re.return=J,J=Re;break e}o(J,G);break}else a(J,G);G=G.sibling}ae.type===F?(Re=_o(ae.props.children,J.mode,Re,ae.key),Re.return=J,J=Re):(Re=td(ae.type,ae.key,ae.props,null,J.mode,Re),vc(Re,ae),Re.return=J,J=Re)}return x(J);case $:e:{for(kt=ae.key;G!==null;){if(G.key===kt)if(G.tag===4&&G.stateNode.containerInfo===ae.containerInfo&&G.stateNode.implementation===ae.implementation){o(J,G.sibling),Re=m(G,ae.children||[]),Re.return=J,J=Re;break e}else{o(J,G);break}else a(J,G);G=G.sibling}Re=Im(ae,J.mode,Re),Re.return=J,J=Re}return x(J);case E:return ae=So(ae),Ys(J,G,ae,Re)}if(xt(ae))return ft(J,G,ae,Re);if(H(ae)){if(kt=H(ae),typeof kt!="function")throw Error(i(150));return ae=kt.call(ae),It(J,G,ae,Re)}if(typeof ae.then=="function")return Ys(J,G,ld(ae),Re);if(ae.$$typeof===re)return Ys(J,G,rd(J,ae),Re);cd(J,ae)}return typeof ae=="string"&&ae!==""||typeof ae=="number"||typeof ae=="bigint"?(ae=""+ae,G!==null&&G.tag===6?(o(J,G.sibling),Re=m(G,ae),Re.return=J,J=Re):(o(J,G),Re=Mm(ae,J.mode,Re),Re.return=J,J=Re),x(J)):o(J,G)}return function(J,G,ae,Re){try{bc=0;var kt=Ys(J,G,ae,Re);return gl=null,kt}catch(vt){if(vt===pl||vt===id)throw vt;var Is=Fr(29,vt,null,J.mode);return Is.lanes=Re,Is.return=J,Is}}}var Co=Pb(!0),Lb=Pb(!1),Si=!1;function $m(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Wm(s,a){s=s.updateQueue,a.updateQueue===s&&(a.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function Ni(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function Ci(s,a,o){var c=s.updateQueue;if(c===null)return null;if(c=c.shared,(Fs&2)!==0){var m=c.pending;return m===null?a.next=a:(a.next=m.next,m.next=a),c.pending=a,a=ed(s),vb(s,null,o),a}return Zu(s,c,a,o),ed(s)}function xc(s,a,o){if(a=a.updateQueue,a!==null&&(a=a.shared,(o&4194048)!==0)){var c=a.lanes;c&=s.pendingLanes,o|=c,a.lanes=o,Cs(s,o)}}function Gm(s,a){var o=s.updateQueue,c=s.alternate;if(c!==null&&(c=c.updateQueue,o===c)){var m=null,f=null;if(o=o.firstBaseUpdate,o!==null){do{var x={lane:o.lane,tag:o.tag,payload:o.payload,callback:null,next:null};f===null?m=f=x:f=f.next=x,o=o.next}while(o!==null);f===null?m=f=a:f=f.next=a}else m=f=a;o={baseState:c.baseState,firstBaseUpdate:m,lastBaseUpdate:f,shared:c.shared,callbacks:c.callbacks},s.updateQueue=o;return}s=o.lastBaseUpdate,s===null?o.firstBaseUpdate=a:s.next=a,o.lastBaseUpdate=a}var Km=!1;function wc(){if(Km){var s=fl;if(s!==null)throw s}}function _c(s,a,o,c){Km=!1;var m=s.updateQueue;Si=!1;var f=m.firstBaseUpdate,x=m.lastBaseUpdate,S=m.shared.pending;if(S!==null){m.shared.pending=null;var z=S,ie=z.next;z.next=null,x===null?f=ie:x.next=ie,x=z;var Te=s.alternate;Te!==null&&(Te=Te.updateQueue,S=Te.lastBaseUpdate,S!==x&&(S===null?Te.firstBaseUpdate=ie:S.next=ie,Te.lastBaseUpdate=z))}if(f!==null){var Ie=m.baseState;x=0,Te=ie=z=null,S=f;do{var le=S.lane&-536870913,pe=le!==S.lane;if(pe?(gs&le)===le:(c&le)===le){le!==0&&le===ml&&(Km=!0),Te!==null&&(Te=Te.next={lane:0,tag:S.tag,payload:S.payload,callback:null,next:null});e:{var ft=s,It=S;le=a;var Ys=o;switch(It.tag){case 1:if(ft=It.payload,typeof ft=="function"){Ie=ft.call(Ys,Ie,le);break e}Ie=ft;break e;case 3:ft.flags=ft.flags&-65537|128;case 0:if(ft=It.payload,le=typeof ft=="function"?ft.call(Ys,Ie,le):ft,le==null)break e;Ie=j({},Ie,le);break e;case 2:Si=!0}}le=S.callback,le!==null&&(s.flags|=64,pe&&(s.flags|=8192),pe=m.callbacks,pe===null?m.callbacks=[le]:pe.push(le))}else pe={lane:le,tag:S.tag,payload:S.payload,callback:S.callback,next:null},Te===null?(ie=Te=pe,z=Ie):Te=Te.next=pe,x|=le;if(S=S.next,S===null){if(S=m.shared.pending,S===null)break;pe=S,S=pe.next,pe.next=null,m.lastBaseUpdate=pe,m.shared.pending=null}}while(!0);Te===null&&(z=Ie),m.baseState=z,m.firstBaseUpdate=ie,m.lastBaseUpdate=Te,f===null&&(m.shared.lanes=0),Di|=x,s.lanes=x,s.memoizedState=Ie}}function Ob(s,a){if(typeof s!="function")throw Error(i(191,s));s.call(a)}function Vb(s,a){var o=s.callbacks;if(o!==null)for(s.callbacks=null,s=0;s<o.length;s++)Ob(o[s],a)}var yl=L(null),ud=L(0);function Bb(s,a){s=ai,Le(ud,s),Le(yl,a),ai=s|a.baseLanes}function Ym(){Le(ud,ai),Le(yl,yl.current)}function Qm(){ai=ud.current,se(yl),se(ud)}var zr=L(null),na=null;function Ri(s){var a=s.alternate;Le(En,En.current&1),Le(zr,s),na===null&&(a===null||yl.current!==null||a.memoizedState!==null)&&(na=s)}function Xm(s){Le(En,En.current),Le(zr,s),na===null&&(na=s)}function Ub(s){s.tag===22?(Le(En,En.current),Le(zr,s),na===null&&(na=s)):Ai()}function Ai(){Le(En,En.current),Le(zr,zr.current)}function qr(s){se(zr),na===s&&(na=null),se(En)}var En=L(0);function dd(s){for(var a=s;a!==null;){if(a.tag===13){var o=a.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||rp(o)||ap(o)))return a}else if(a.tag===19&&(a.memoizedProps.revealOrder==="forwards"||a.memoizedProps.revealOrder==="backwards"||a.memoizedProps.revealOrder==="unstable_legacy-backwards"||a.memoizedProps.revealOrder==="together")){if((a.flags&128)!==0)return a}else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===s)break;for(;a.sibling===null;){if(a.return===null||a.return===s)return null;a=a.return}a.sibling.return=a.return,a=a.sibling}return null}var Xa=0,Zt=null,Gs=null,Rn=null,hd=!1,bl=!1,Ro=!1,md=0,kc=0,vl=null,cj=0;function yn(){throw Error(i(321))}function Jm(s,a){if(a===null)return!1;for(var o=0;o<a.length&&o<s.length;o++)if(!Ur(s[o],a[o]))return!1;return!0}function Zm(s,a,o,c,m,f){return Xa=f,Zt=a,a.memoizedState=null,a.updateQueue=null,a.lanes=0,W.H=s===null||s.memoizedState===null?kv:pf,Ro=!1,f=o(c,m),Ro=!1,bl&&(f=zb(a,o,c,m)),Fb(s),f}function Fb(s){W.H=Ec;var a=Gs!==null&&Gs.next!==null;if(Xa=0,Rn=Gs=Zt=null,hd=!1,kc=0,vl=null,a)throw Error(i(300));s===null||An||(s=s.dependencies,s!==null&&nd(s)&&(An=!0))}function zb(s,a,o,c){Zt=s;var m=0;do{if(bl&&(vl=null),kc=0,bl=!1,25<=m)throw Error(i(301));if(m+=1,Rn=Gs=null,s.updateQueue!=null){var f=s.updateQueue;f.lastEffect=null,f.events=null,f.stores=null,f.memoCache!=null&&(f.memoCache.index=0)}W.H=jv,f=a(o,c)}while(bl);return f}function uj(){var s=W.H,a=s.useState()[0];return a=typeof a.then=="function"?jc(a):a,s=s.useState()[0],(Gs!==null?Gs.memoizedState:null)!==s&&(Zt.flags|=1024),a}function ef(){var s=md!==0;return md=0,s}function tf(s,a,o){a.updateQueue=s.updateQueue,a.flags&=-2053,s.lanes&=~o}function sf(s){if(hd){for(s=s.memoizedState;s!==null;){var a=s.queue;a!==null&&(a.pending=null),s=s.next}hd=!1}Xa=0,Rn=Gs=Zt=null,bl=!1,kc=md=0,vl=null}function xr(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Rn===null?Zt.memoizedState=Rn=s:Rn=Rn.next=s,Rn}function Sn(){if(Gs===null){var s=Zt.alternate;s=s!==null?s.memoizedState:null}else s=Gs.next;var a=Rn===null?Zt.memoizedState:Rn.next;if(a!==null)Rn=a,Gs=s;else{if(s===null)throw Zt.alternate===null?Error(i(467)):Error(i(310));Gs=s,s={memoizedState:Gs.memoizedState,baseState:Gs.baseState,baseQueue:Gs.baseQueue,queue:Gs.queue,next:null},Rn===null?Zt.memoizedState=Rn=s:Rn=Rn.next=s}return Rn}function fd(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function jc(s){var a=kc;return kc+=1,vl===null&&(vl=[]),s=Mb(vl,s,a),a=Zt,(Rn===null?a.memoizedState:Rn.next)===null&&(a=a.alternate,W.H=a===null||a.memoizedState===null?kv:pf),s}function pd(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return jc(s);if(s.$$typeof===re)return Zn(s)}throw Error(i(438,String(s)))}function nf(s){var a=null,o=Zt.updateQueue;if(o!==null&&(a=o.memoCache),a==null){var c=Zt.alternate;c!==null&&(c=c.updateQueue,c!==null&&(c=c.memoCache,c!=null&&(a={data:c.data.map(function(m){return m.slice()}),index:0})))}if(a==null&&(a={data:[],index:0}),o===null&&(o=fd(),Zt.updateQueue=o),o.memoCache=a,o=a.data[a.index],o===void 0)for(o=a.data[a.index]=Array(s),c=0;c<s;c++)o[c]=O;return a.index++,o}function Ja(s,a){return typeof a=="function"?a(s):a}function gd(s){var a=Sn();return rf(a,Gs,s)}function rf(s,a,o){var c=s.queue;if(c===null)throw Error(i(311));c.lastRenderedReducer=o;var m=s.baseQueue,f=c.pending;if(f!==null){if(m!==null){var x=m.next;m.next=f.next,f.next=x}a.baseQueue=m=f,c.pending=null}if(f=s.baseState,m===null)s.memoizedState=f;else{a=m.next;var S=x=null,z=null,ie=a,Te=!1;do{var Ie=ie.lane&-536870913;if(Ie!==ie.lane?(gs&Ie)===Ie:(Xa&Ie)===Ie){var le=ie.revertLane;if(le===0)z!==null&&(z=z.next={lane:0,revertLane:0,gesture:null,action:ie.action,hasEagerState:ie.hasEagerState,eagerState:ie.eagerState,next:null}),Ie===ml&&(Te=!0);else if((Xa&le)===le){ie=ie.next,le===ml&&(Te=!0);continue}else Ie={lane:0,revertLane:ie.revertLane,gesture:null,action:ie.action,hasEagerState:ie.hasEagerState,eagerState:ie.eagerState,next:null},z===null?(S=z=Ie,x=f):z=z.next=Ie,Zt.lanes|=le,Di|=le;Ie=ie.action,Ro&&o(f,Ie),f=ie.hasEagerState?ie.eagerState:o(f,Ie)}else le={lane:Ie,revertLane:ie.revertLane,gesture:ie.gesture,action:ie.action,hasEagerState:ie.hasEagerState,eagerState:ie.eagerState,next:null},z===null?(S=z=le,x=f):z=z.next=le,Zt.lanes|=Ie,Di|=Ie;ie=ie.next}while(ie!==null&&ie!==a);if(z===null?x=f:z.next=S,!Ur(f,s.memoizedState)&&(An=!0,Te&&(o=fl,o!==null)))throw o;s.memoizedState=f,s.baseState=x,s.baseQueue=z,c.lastRenderedState=f}return m===null&&(c.lanes=0),[s.memoizedState,c.dispatch]}function af(s){var a=Sn(),o=a.queue;if(o===null)throw Error(i(311));o.lastRenderedReducer=s;var c=o.dispatch,m=o.pending,f=a.memoizedState;if(m!==null){o.pending=null;var x=m=m.next;do f=s(f,x.action),x=x.next;while(x!==m);Ur(f,a.memoizedState)||(An=!0),a.memoizedState=f,a.baseQueue===null&&(a.baseState=f),o.lastRenderedState=f}return[f,c]}function qb(s,a,o){var c=Zt,m=Sn(),f=ks;if(f){if(o===void 0)throw Error(i(407));o=o()}else o=a();var x=!Ur((Gs||m).memoizedState,o);if(x&&(m.memoizedState=o,An=!0),m=m.queue,cf(Wb.bind(null,c,m,s),[s]),m.getSnapshot!==a||x||Rn!==null&&Rn.memoizedState.tag&1){if(c.flags|=2048,xl(9,{destroy:void 0},$b.bind(null,c,m,o,a),null),en===null)throw Error(i(349));f||(Xa&127)!==0||Hb(c,a,o)}return o}function Hb(s,a,o){s.flags|=16384,s={getSnapshot:a,value:o},a=Zt.updateQueue,a===null?(a=fd(),Zt.updateQueue=a,a.stores=[s]):(o=a.stores,o===null?a.stores=[s]:o.push(s))}function $b(s,a,o,c){a.value=o,a.getSnapshot=c,Gb(a)&&Kb(s)}function Wb(s,a,o){return o(function(){Gb(a)&&Kb(s)})}function Gb(s){var a=s.getSnapshot;s=s.value;try{var o=a();return!Ur(s,o)}catch{return!0}}function Kb(s){var a=wo(s,2);a!==null&&Pr(a,s,2)}function of(s){var a=xr();if(typeof s=="function"){var o=s;if(s=o(),Ro){we(!0);try{o()}finally{we(!1)}}}return a.memoizedState=a.baseState=s,a.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ja,lastRenderedState:s},a}function Yb(s,a,o,c){return s.baseState=o,rf(s,Gs,typeof c=="function"?c:Ja)}function dj(s,a,o,c,m){if(vd(s))throw Error(i(485));if(s=a.action,s!==null){var f={payload:m,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(x){f.listeners.push(x)}};W.T!==null?o(!0):f.isTransition=!1,c(f),o=a.pending,o===null?(f.next=a.pending=f,Qb(a,f)):(f.next=o.next,a.pending=o.next=f)}}function Qb(s,a){var o=a.action,c=a.payload,m=s.state;if(a.isTransition){var f=W.T,x={};W.T=x;try{var S=o(m,c),z=W.S;z!==null&&z(x,S),Xb(s,a,S)}catch(ie){lf(s,a,ie)}finally{f!==null&&x.types!==null&&(f.types=x.types),W.T=f}}else try{f=o(m,c),Xb(s,a,f)}catch(ie){lf(s,a,ie)}}function Xb(s,a,o){o!==null&&typeof o=="object"&&typeof o.then=="function"?o.then(function(c){Jb(s,a,c)},function(c){return lf(s,a,c)}):Jb(s,a,o)}function Jb(s,a,o){a.status="fulfilled",a.value=o,Zb(a),s.state=o,a=s.pending,a!==null&&(o=a.next,o===a?s.pending=null:(o=o.next,a.next=o,Qb(s,o)))}function lf(s,a,o){var c=s.pending;if(s.pending=null,c!==null){c=c.next;do a.status="rejected",a.reason=o,Zb(a),a=a.next;while(a!==c)}s.action=null}function Zb(s){s=s.listeners;for(var a=0;a<s.length;a++)(0,s[a])()}function ev(s,a){return a}function tv(s,a){if(ks){var o=en.formState;if(o!==null){e:{var c=Zt;if(ks){if(an){t:{for(var m=an,f=sa;m.nodeType!==8;){if(!f){m=null;break t}if(m=ra(m.nextSibling),m===null){m=null;break t}}f=m.data,m=f==="F!"||f==="F"?m:null}if(m){an=ra(m.nextSibling),c=m.data==="F!";break e}}Ti(c)}c=!1}c&&(a=o[0])}}return o=xr(),o.memoizedState=o.baseState=a,c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ev,lastRenderedState:a},o.queue=c,o=xv.bind(null,Zt,c),c.dispatch=o,c=of(!1),f=ff.bind(null,Zt,!1,c.queue),c=xr(),m={state:a,dispatch:null,action:s,pending:null},c.queue=m,o=dj.bind(null,Zt,m,f,o),m.dispatch=o,c.memoizedState=s,[a,o,!1]}function sv(s){var a=Sn();return nv(a,Gs,s)}function nv(s,a,o){if(a=rf(s,a,ev)[0],s=gd(Ja)[0],typeof a=="object"&&a!==null&&typeof a.then=="function")try{var c=jc(a)}catch(x){throw x===pl?id:x}else c=a;a=Sn();var m=a.queue,f=m.dispatch;return o!==a.memoizedState&&(Zt.flags|=2048,xl(9,{destroy:void 0},hj.bind(null,m,o),null)),[c,f,s]}function hj(s,a){s.action=a}function rv(s){var a=Sn(),o=Gs;if(o!==null)return nv(a,o,s);Sn(),a=a.memoizedState,o=Sn();var c=o.queue.dispatch;return o.memoizedState=s,[a,c,!1]}function xl(s,a,o,c){return s={tag:s,create:o,deps:c,inst:a,next:null},a=Zt.updateQueue,a===null&&(a=fd(),Zt.updateQueue=a),o=a.lastEffect,o===null?a.lastEffect=s.next=s:(c=o.next,o.next=s,s.next=c,a.lastEffect=s),s}function av(){return Sn().memoizedState}function yd(s,a,o,c){var m=xr();Zt.flags|=s,m.memoizedState=xl(1|a,{destroy:void 0},o,c===void 0?null:c)}function bd(s,a,o,c){var m=Sn();c=c===void 0?null:c;var f=m.memoizedState.inst;Gs!==null&&c!==null&&Jm(c,Gs.memoizedState.deps)?m.memoizedState=xl(a,f,o,c):(Zt.flags|=s,m.memoizedState=xl(1|a,f,o,c))}function iv(s,a){yd(8390656,8,s,a)}function cf(s,a){bd(2048,8,s,a)}function mj(s){Zt.flags|=4;var a=Zt.updateQueue;if(a===null)a=fd(),Zt.updateQueue=a,a.events=[s];else{var o=a.events;o===null?a.events=[s]:o.push(s)}}function ov(s){var a=Sn().memoizedState;return mj({ref:a,nextImpl:s}),function(){if((Fs&2)!==0)throw Error(i(440));return a.impl.apply(void 0,arguments)}}function lv(s,a){return bd(4,2,s,a)}function cv(s,a){return bd(4,4,s,a)}function uv(s,a){if(typeof a=="function"){s=s();var o=a(s);return function(){typeof o=="function"?o():a(null)}}if(a!=null)return s=s(),a.current=s,function(){a.current=null}}function dv(s,a,o){o=o!=null?o.concat([s]):null,bd(4,4,uv.bind(null,a,s),o)}function uf(){}function hv(s,a){var o=Sn();a=a===void 0?null:a;var c=o.memoizedState;return a!==null&&Jm(a,c[1])?c[0]:(o.memoizedState=[s,a],s)}function mv(s,a){var o=Sn();a=a===void 0?null:a;var c=o.memoizedState;if(a!==null&&Jm(a,c[1]))return c[0];if(c=s(),Ro){we(!0);try{s()}finally{we(!1)}}return o.memoizedState=[c,a],c}function df(s,a,o){return o===void 0||(Xa&1073741824)!==0&&(gs&261930)===0?s.memoizedState=a:(s.memoizedState=o,s=f0(),Zt.lanes|=s,Di|=s,o)}function fv(s,a,o,c){return Ur(o,a)?o:yl.current!==null?(s=df(s,o,c),Ur(s,a)||(An=!0),s):(Xa&42)===0||(Xa&1073741824)!==0&&(gs&261930)===0?(An=!0,s.memoizedState=o):(s=f0(),Zt.lanes|=s,Di|=s,a)}function pv(s,a,o,c,m){var f=he.p;he.p=f!==0&&8>f?f:8;var x=W.T,S={};W.T=S,ff(s,!1,a,o);try{var z=m(),ie=W.S;if(ie!==null&&ie(S,z),z!==null&&typeof z=="object"&&typeof z.then=="function"){var Te=lj(z,c);Tc(s,a,Te,Wr(s))}else Tc(s,a,c,Wr(s))}catch(Ie){Tc(s,a,{then:function(){},status:"rejected",reason:Ie},Wr())}finally{he.p=f,x!==null&&S.types!==null&&(x.types=S.types),W.T=x}}function fj(){}function hf(s,a,o,c){if(s.tag!==5)throw Error(i(476));var m=gv(s).queue;pv(s,m,a,Pe,o===null?fj:function(){return yv(s),o(c)})}function gv(s){var a=s.memoizedState;if(a!==null)return a;a={memoizedState:Pe,baseState:Pe,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ja,lastRenderedState:Pe},next:null};var o={};return a.next={memoizedState:o,baseState:o,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ja,lastRenderedState:o},next:null},s.memoizedState=a,s=s.alternate,s!==null&&(s.memoizedState=a),a}function yv(s){var a=gv(s);a.next===null&&(a=s.alternate.memoizedState),Tc(s,a.next.queue,{},Wr())}function mf(){return Zn(zc)}function bv(){return Sn().memoizedState}function vv(){return Sn().memoizedState}function pj(s){for(var a=s.return;a!==null;){switch(a.tag){case 24:case 3:var o=Wr();s=Ni(o);var c=Ci(a,s,o);c!==null&&(Pr(c,a,o),xc(c,a,o)),a={cache:Fm()},s.payload=a;return}a=a.return}}function gj(s,a,o){var c=Wr();o={lane:c,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null},vd(s)?wv(a,o):(o=Rm(s,a,o,c),o!==null&&(Pr(o,s,c),_v(o,a,c)))}function xv(s,a,o){var c=Wr();Tc(s,a,o,c)}function Tc(s,a,o,c){var m={lane:c,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null};if(vd(s))wv(a,m);else{var f=s.alternate;if(s.lanes===0&&(f===null||f.lanes===0)&&(f=a.lastRenderedReducer,f!==null))try{var x=a.lastRenderedState,S=f(x,o);if(m.hasEagerState=!0,m.eagerState=S,Ur(S,x))return Zu(s,a,m,0),en===null&&Ju(),!1}catch{}if(o=Rm(s,a,m,c),o!==null)return Pr(o,s,c),_v(o,a,c),!0}return!1}function ff(s,a,o,c){if(c={lane:2,revertLane:Wf(),gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},vd(s)){if(a)throw Error(i(479))}else a=Rm(s,o,c,2),a!==null&&Pr(a,s,2)}function vd(s){var a=s.alternate;return s===Zt||a!==null&&a===Zt}function wv(s,a){bl=hd=!0;var o=s.pending;o===null?a.next=a:(a.next=o.next,o.next=a),s.pending=a}function _v(s,a,o){if((o&4194048)!==0){var c=a.lanes;c&=s.pendingLanes,o|=c,a.lanes=o,Cs(s,o)}}var Ec={readContext:Zn,use:pd,useCallback:yn,useContext:yn,useEffect:yn,useImperativeHandle:yn,useLayoutEffect:yn,useInsertionEffect:yn,useMemo:yn,useReducer:yn,useRef:yn,useState:yn,useDebugValue:yn,useDeferredValue:yn,useTransition:yn,useSyncExternalStore:yn,useId:yn,useHostTransitionStatus:yn,useFormState:yn,useActionState:yn,useOptimistic:yn,useMemoCache:yn,useCacheRefresh:yn};Ec.useEffectEvent=yn;var kv={readContext:Zn,use:pd,useCallback:function(s,a){return xr().memoizedState=[s,a===void 0?null:a],s},useContext:Zn,useEffect:iv,useImperativeHandle:function(s,a,o){o=o!=null?o.concat([s]):null,yd(4194308,4,uv.bind(null,a,s),o)},useLayoutEffect:function(s,a){return yd(4194308,4,s,a)},useInsertionEffect:function(s,a){yd(4,2,s,a)},useMemo:function(s,a){var o=xr();a=a===void 0?null:a;var c=s();if(Ro){we(!0);try{s()}finally{we(!1)}}return o.memoizedState=[c,a],c},useReducer:function(s,a,o){var c=xr();if(o!==void 0){var m=o(a);if(Ro){we(!0);try{o(a)}finally{we(!1)}}}else m=a;return c.memoizedState=c.baseState=m,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:m},c.queue=s,s=s.dispatch=gj.bind(null,Zt,s),[c.memoizedState,s]},useRef:function(s){var a=xr();return s={current:s},a.memoizedState=s},useState:function(s){s=of(s);var a=s.queue,o=xv.bind(null,Zt,a);return a.dispatch=o,[s.memoizedState,o]},useDebugValue:uf,useDeferredValue:function(s,a){var o=xr();return df(o,s,a)},useTransition:function(){var s=of(!1);return s=pv.bind(null,Zt,s.queue,!0,!1),xr().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,a,o){var c=Zt,m=xr();if(ks){if(o===void 0)throw Error(i(407));o=o()}else{if(o=a(),en===null)throw Error(i(349));(gs&127)!==0||Hb(c,a,o)}m.memoizedState=o;var f={value:o,getSnapshot:a};return m.queue=f,iv(Wb.bind(null,c,f,s),[s]),c.flags|=2048,xl(9,{destroy:void 0},$b.bind(null,c,f,o,a),null),o},useId:function(){var s=xr(),a=en.identifierPrefix;if(ks){var o=Ca,c=Na;o=(c&~(1<<32-Ce(c)-1)).toString(32)+o,a="_"+a+"R_"+o,o=md++,0<o&&(a+="H"+o.toString(32)),a+="_"}else o=cj++,a="_"+a+"r_"+o.toString(32)+"_";return s.memoizedState=a},useHostTransitionStatus:mf,useFormState:tv,useActionState:tv,useOptimistic:function(s){var a=xr();a.memoizedState=a.baseState=s;var o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return a.queue=o,a=ff.bind(null,Zt,!0,o),o.dispatch=a,[s,a]},useMemoCache:nf,useCacheRefresh:function(){return xr().memoizedState=pj.bind(null,Zt)},useEffectEvent:function(s){var a=xr(),o={impl:s};return a.memoizedState=o,function(){if((Fs&2)!==0)throw Error(i(440));return o.impl.apply(void 0,arguments)}}},pf={readContext:Zn,use:pd,useCallback:hv,useContext:Zn,useEffect:cf,useImperativeHandle:dv,useInsertionEffect:lv,useLayoutEffect:cv,useMemo:mv,useReducer:gd,useRef:av,useState:function(){return gd(Ja)},useDebugValue:uf,useDeferredValue:function(s,a){var o=Sn();return fv(o,Gs.memoizedState,s,a)},useTransition:function(){var s=gd(Ja)[0],a=Sn().memoizedState;return[typeof s=="boolean"?s:jc(s),a]},useSyncExternalStore:qb,useId:bv,useHostTransitionStatus:mf,useFormState:sv,useActionState:sv,useOptimistic:function(s,a){var o=Sn();return Yb(o,Gs,s,a)},useMemoCache:nf,useCacheRefresh:vv};pf.useEffectEvent=ov;var jv={readContext:Zn,use:pd,useCallback:hv,useContext:Zn,useEffect:cf,useImperativeHandle:dv,useInsertionEffect:lv,useLayoutEffect:cv,useMemo:mv,useReducer:af,useRef:av,useState:function(){return af(Ja)},useDebugValue:uf,useDeferredValue:function(s,a){var o=Sn();return Gs===null?df(o,s,a):fv(o,Gs.memoizedState,s,a)},useTransition:function(){var s=af(Ja)[0],a=Sn().memoizedState;return[typeof s=="boolean"?s:jc(s),a]},useSyncExternalStore:qb,useId:bv,useHostTransitionStatus:mf,useFormState:rv,useActionState:rv,useOptimistic:function(s,a){var o=Sn();return Gs!==null?Yb(o,Gs,s,a):(o.baseState=s,[s,o.queue.dispatch])},useMemoCache:nf,useCacheRefresh:vv};jv.useEffectEvent=ov;function gf(s,a,o,c){a=s.memoizedState,o=o(c,a),o=o==null?a:j({},a,o),s.memoizedState=o,s.lanes===0&&(s.updateQueue.baseState=o)}var yf={enqueueSetState:function(s,a,o){s=s._reactInternals;var c=Wr(),m=Ni(c);m.payload=a,o!=null&&(m.callback=o),a=Ci(s,m,c),a!==null&&(Pr(a,s,c),xc(a,s,c))},enqueueReplaceState:function(s,a,o){s=s._reactInternals;var c=Wr(),m=Ni(c);m.tag=1,m.payload=a,o!=null&&(m.callback=o),a=Ci(s,m,c),a!==null&&(Pr(a,s,c),xc(a,s,c))},enqueueForceUpdate:function(s,a){s=s._reactInternals;var o=Wr(),c=Ni(o);c.tag=2,a!=null&&(c.callback=a),a=Ci(s,c,o),a!==null&&(Pr(a,s,o),xc(a,s,o))}};function Tv(s,a,o,c,m,f,x){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(c,f,x):a.prototype&&a.prototype.isPureReactComponent?!hc(o,c)||!hc(m,f):!0}function Ev(s,a,o,c){s=a.state,typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps(o,c),typeof a.UNSAFE_componentWillReceiveProps=="function"&&a.UNSAFE_componentWillReceiveProps(o,c),a.state!==s&&yf.enqueueReplaceState(a,a.state,null)}function Ao(s,a){var o=a;if("ref"in a){o={};for(var c in a)c!=="ref"&&(o[c]=a[c])}if(s=s.defaultProps){o===a&&(o=j({},o));for(var m in s)o[m]===void 0&&(o[m]=s[m])}return o}function Sv(s){Xu(s)}function Nv(s){console.error(s)}function Cv(s){Xu(s)}function xd(s,a){try{var o=s.onUncaughtError;o(a.value,{componentStack:a.stack})}catch(c){setTimeout(function(){throw c})}}function Rv(s,a,o){try{var c=s.onCaughtError;c(o.value,{componentStack:o.stack,errorBoundary:a.tag===1?a.stateNode:null})}catch(m){setTimeout(function(){throw m})}}function bf(s,a,o){return o=Ni(o),o.tag=3,o.payload={element:null},o.callback=function(){xd(s,a)},o}function Av(s){return s=Ni(s),s.tag=3,s}function Mv(s,a,o,c){var m=o.type.getDerivedStateFromError;if(typeof m=="function"){var f=c.value;s.payload=function(){return m(f)},s.callback=function(){Rv(a,o,c)}}var x=o.stateNode;x!==null&&typeof x.componentDidCatch=="function"&&(s.callback=function(){Rv(a,o,c),typeof m!="function"&&(Pi===null?Pi=new Set([this]):Pi.add(this));var S=c.stack;this.componentDidCatch(c.value,{componentStack:S!==null?S:""})})}function yj(s,a,o,c,m){if(o.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){if(a=o.alternate,a!==null&&hl(a,o,m,!0),o=zr.current,o!==null){switch(o.tag){case 31:case 13:return na===null?Md():o.alternate===null&&bn===0&&(bn=3),o.flags&=-257,o.flags|=65536,o.lanes=m,c===od?o.flags|=16384:(a=o.updateQueue,a===null?o.updateQueue=new Set([c]):a.add(c),qf(s,c,m)),!1;case 22:return o.flags|=65536,c===od?o.flags|=16384:(a=o.updateQueue,a===null?(a={transitions:null,markerInstances:null,retryQueue:new Set([c])},o.updateQueue=a):(o=a.retryQueue,o===null?a.retryQueue=new Set([c]):o.add(c)),qf(s,c,m)),!1}throw Error(i(435,o.tag))}return qf(s,c,m),Md(),!1}if(ks)return a=zr.current,a!==null?((a.flags&65536)===0&&(a.flags|=256),a.flags|=65536,a.lanes=m,c!==Lm&&(s=Error(i(422),{cause:c}),pc(Zr(s,o)))):(c!==Lm&&(a=Error(i(423),{cause:c}),pc(Zr(a,o))),s=s.current.alternate,s.flags|=65536,m&=-m,s.lanes|=m,c=Zr(c,o),m=bf(s.stateNode,c,m),Gm(s,m),bn!==4&&(bn=2)),!1;var f=Error(i(520),{cause:c});if(f=Zr(f,o),Dc===null?Dc=[f]:Dc.push(f),bn!==4&&(bn=2),a===null)return!0;c=Zr(c,o),o=a;do{switch(o.tag){case 3:return o.flags|=65536,s=m&-m,o.lanes|=s,s=bf(o.stateNode,c,s),Gm(o,s),!1;case 1:if(a=o.type,f=o.stateNode,(o.flags&128)===0&&(typeof a.getDerivedStateFromError=="function"||f!==null&&typeof f.componentDidCatch=="function"&&(Pi===null||!Pi.has(f))))return o.flags|=65536,m&=-m,o.lanes|=m,m=Av(m),Mv(m,s,o,c),Gm(o,m),!1}o=o.return}while(o!==null);return!1}var vf=Error(i(461)),An=!1;function er(s,a,o,c){a.child=s===null?Lb(a,null,o,c):Co(a,s.child,o,c)}function Iv(s,a,o,c,m){o=o.render;var f=a.ref;if("ref"in c){var x={};for(var S in c)S!=="ref"&&(x[S]=c[S])}else x=c;return To(a),c=Zm(s,a,o,x,f,m),S=ef(),s!==null&&!An?(tf(s,a,m),Za(s,a,m)):(ks&&S&&Dm(a),a.flags|=1,er(s,a,c,m),a.child)}function Dv(s,a,o,c,m){if(s===null){var f=o.type;return typeof f=="function"&&!Am(f)&&f.defaultProps===void 0&&o.compare===null?(a.tag=15,a.type=f,Pv(s,a,f,c,m)):(s=td(o.type,null,c,a,a.mode,m),s.ref=a.ref,s.return=a,a.child=s)}if(f=s.child,!Sf(s,m)){var x=f.memoizedProps;if(o=o.compare,o=o!==null?o:hc,o(x,c)&&s.ref===a.ref)return Za(s,a,m)}return a.flags|=1,s=Ga(f,c),s.ref=a.ref,s.return=a,a.child=s}function Pv(s,a,o,c,m){if(s!==null){var f=s.memoizedProps;if(hc(f,c)&&s.ref===a.ref)if(An=!1,a.pendingProps=c=f,Sf(s,m))(s.flags&131072)!==0&&(An=!0);else return a.lanes=s.lanes,Za(s,a,m)}return xf(s,a,o,c,m)}function Lv(s,a,o,c){var m=c.children,f=s!==null?s.memoizedState:null;if(s===null&&a.stateNode===null&&(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),c.mode==="hidden"){if((a.flags&128)!==0){if(f=f!==null?f.baseLanes|o:o,s!==null){for(c=a.child=s.child,m=0;c!==null;)m=m|c.lanes|c.childLanes,c=c.sibling;c=m&~f}else c=0,a.child=null;return Ov(s,a,f,o,c)}if((o&536870912)!==0)a.memoizedState={baseLanes:0,cachePool:null},s!==null&&ad(a,f!==null?f.cachePool:null),f!==null?Bb(a,f):Ym(),Ub(a);else return c=a.lanes=536870912,Ov(s,a,f!==null?f.baseLanes|o:o,o,c)}else f!==null?(ad(a,f.cachePool),Bb(a,f),Ai(),a.memoizedState=null):(s!==null&&ad(a,null),Ym(),Ai());return er(s,a,m,o),a.child}function Sc(s,a){return s!==null&&s.tag===22||a.stateNode!==null||(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),a.sibling}function Ov(s,a,o,c,m){var f=qm();return f=f===null?null:{parent:Cn._currentValue,pool:f},a.memoizedState={baseLanes:o,cachePool:f},s!==null&&ad(a,null),Ym(),Ub(a),s!==null&&hl(s,a,c,!0),a.childLanes=m,null}function wd(s,a){return a=kd({mode:a.mode,children:a.children},s.mode),a.ref=s.ref,s.child=a,a.return=s,a}function Vv(s,a,o){return Co(a,s.child,null,o),s=wd(a,a.pendingProps),s.flags|=2,qr(a),a.memoizedState=null,s}function bj(s,a,o){var c=a.pendingProps,m=(a.flags&128)!==0;if(a.flags&=-129,s===null){if(ks){if(c.mode==="hidden")return s=wd(a,c),a.lanes=536870912,Sc(null,s);if(Xm(a),(s=an)?(s=Q0(s,sa),s=s!==null&&s.data==="&"?s:null,s!==null&&(a.memoizedState={dehydrated:s,treeContext:ki!==null?{id:Na,overflow:Ca}:null,retryLane:536870912,hydrationErrors:null},o=wb(s),o.return=a,a.child=o,Jn=a,an=null)):s=null,s===null)throw Ti(a);return a.lanes=536870912,null}return wd(a,c)}var f=s.memoizedState;if(f!==null){var x=f.dehydrated;if(Xm(a),m)if(a.flags&256)a.flags&=-257,a=Vv(s,a,o);else if(a.memoizedState!==null)a.child=s.child,a.flags|=128,a=null;else throw Error(i(558));else if(An||hl(s,a,o,!1),m=(o&s.childLanes)!==0,An||m){if(c=en,c!==null&&(x=Ls(c,o),x!==0&&x!==f.retryLane))throw f.retryLane=x,wo(s,x),Pr(c,s,x),vf;Md(),a=Vv(s,a,o)}else s=f.treeContext,an=ra(x.nextSibling),Jn=a,ks=!0,ji=null,sa=!1,s!==null&&jb(a,s),a=wd(a,c),a.flags|=4096;return a}return s=Ga(s.child,{mode:c.mode,children:c.children}),s.ref=a.ref,a.child=s,s.return=a,s}function _d(s,a){var o=a.ref;if(o===null)s!==null&&s.ref!==null&&(a.flags|=4194816);else{if(typeof o!="function"&&typeof o!="object")throw Error(i(284));(s===null||s.ref!==o)&&(a.flags|=4194816)}}function xf(s,a,o,c,m){return To(a),o=Zm(s,a,o,c,void 0,m),c=ef(),s!==null&&!An?(tf(s,a,m),Za(s,a,m)):(ks&&c&&Dm(a),a.flags|=1,er(s,a,o,m),a.child)}function Bv(s,a,o,c,m,f){return To(a),a.updateQueue=null,o=zb(a,c,o,m),Fb(s),c=ef(),s!==null&&!An?(tf(s,a,f),Za(s,a,f)):(ks&&c&&Dm(a),a.flags|=1,er(s,a,o,f),a.child)}function Uv(s,a,o,c,m){if(To(a),a.stateNode===null){var f=ll,x=o.contextType;typeof x=="object"&&x!==null&&(f=Zn(x)),f=new o(c,f),a.memoizedState=f.state!==null&&f.state!==void 0?f.state:null,f.updater=yf,a.stateNode=f,f._reactInternals=a,f=a.stateNode,f.props=c,f.state=a.memoizedState,f.refs={},$m(a),x=o.contextType,f.context=typeof x=="object"&&x!==null?Zn(x):ll,f.state=a.memoizedState,x=o.getDerivedStateFromProps,typeof x=="function"&&(gf(a,o,x,c),f.state=a.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof f.getSnapshotBeforeUpdate=="function"||typeof f.UNSAFE_componentWillMount!="function"&&typeof f.componentWillMount!="function"||(x=f.state,typeof f.componentWillMount=="function"&&f.componentWillMount(),typeof f.UNSAFE_componentWillMount=="function"&&f.UNSAFE_componentWillMount(),x!==f.state&&yf.enqueueReplaceState(f,f.state,null),_c(a,c,f,m),wc(),f.state=a.memoizedState),typeof f.componentDidMount=="function"&&(a.flags|=4194308),c=!0}else if(s===null){f=a.stateNode;var S=a.memoizedProps,z=Ao(o,S);f.props=z;var ie=f.context,Te=o.contextType;x=ll,typeof Te=="object"&&Te!==null&&(x=Zn(Te));var Ie=o.getDerivedStateFromProps;Te=typeof Ie=="function"||typeof f.getSnapshotBeforeUpdate=="function",S=a.pendingProps!==S,Te||typeof f.UNSAFE_componentWillReceiveProps!="function"&&typeof f.componentWillReceiveProps!="function"||(S||ie!==x)&&Ev(a,f,c,x),Si=!1;var le=a.memoizedState;f.state=le,_c(a,c,f,m),wc(),ie=a.memoizedState,S||le!==ie||Si?(typeof Ie=="function"&&(gf(a,o,Ie,c),ie=a.memoizedState),(z=Si||Tv(a,o,z,c,le,ie,x))?(Te||typeof f.UNSAFE_componentWillMount!="function"&&typeof f.componentWillMount!="function"||(typeof f.componentWillMount=="function"&&f.componentWillMount(),typeof f.UNSAFE_componentWillMount=="function"&&f.UNSAFE_componentWillMount()),typeof f.componentDidMount=="function"&&(a.flags|=4194308)):(typeof f.componentDidMount=="function"&&(a.flags|=4194308),a.memoizedProps=c,a.memoizedState=ie),f.props=c,f.state=ie,f.context=x,c=z):(typeof f.componentDidMount=="function"&&(a.flags|=4194308),c=!1)}else{f=a.stateNode,Wm(s,a),x=a.memoizedProps,Te=Ao(o,x),f.props=Te,Ie=a.pendingProps,le=f.context,ie=o.contextType,z=ll,typeof ie=="object"&&ie!==null&&(z=Zn(ie)),S=o.getDerivedStateFromProps,(ie=typeof S=="function"||typeof f.getSnapshotBeforeUpdate=="function")||typeof f.UNSAFE_componentWillReceiveProps!="function"&&typeof f.componentWillReceiveProps!="function"||(x!==Ie||le!==z)&&Ev(a,f,c,z),Si=!1,le=a.memoizedState,f.state=le,_c(a,c,f,m),wc();var pe=a.memoizedState;x!==Ie||le!==pe||Si||s!==null&&s.dependencies!==null&&nd(s.dependencies)?(typeof S=="function"&&(gf(a,o,S,c),pe=a.memoizedState),(Te=Si||Tv(a,o,Te,c,le,pe,z)||s!==null&&s.dependencies!==null&&nd(s.dependencies))?(ie||typeof f.UNSAFE_componentWillUpdate!="function"&&typeof f.componentWillUpdate!="function"||(typeof f.componentWillUpdate=="function"&&f.componentWillUpdate(c,pe,z),typeof f.UNSAFE_componentWillUpdate=="function"&&f.UNSAFE_componentWillUpdate(c,pe,z)),typeof f.componentDidUpdate=="function"&&(a.flags|=4),typeof f.getSnapshotBeforeUpdate=="function"&&(a.flags|=1024)):(typeof f.componentDidUpdate!="function"||x===s.memoizedProps&&le===s.memoizedState||(a.flags|=4),typeof f.getSnapshotBeforeUpdate!="function"||x===s.memoizedProps&&le===s.memoizedState||(a.flags|=1024),a.memoizedProps=c,a.memoizedState=pe),f.props=c,f.state=pe,f.context=z,c=Te):(typeof f.componentDidUpdate!="function"||x===s.memoizedProps&&le===s.memoizedState||(a.flags|=4),typeof f.getSnapshotBeforeUpdate!="function"||x===s.memoizedProps&&le===s.memoizedState||(a.flags|=1024),c=!1)}return f=c,_d(s,a),c=(a.flags&128)!==0,f||c?(f=a.stateNode,o=c&&typeof o.getDerivedStateFromError!="function"?null:f.render(),a.flags|=1,s!==null&&c?(a.child=Co(a,s.child,null,m),a.child=Co(a,null,o,m)):er(s,a,o,m),a.memoizedState=f.state,s=a.child):s=Za(s,a,m),s}function Fv(s,a,o,c){return ko(),a.flags|=256,er(s,a,o,c),a.child}var wf={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function _f(s){return{baseLanes:s,cachePool:Rb()}}function kf(s,a,o){return s=s!==null?s.childLanes&~o:0,a&&(s|=$r),s}function zv(s,a,o){var c=a.pendingProps,m=!1,f=(a.flags&128)!==0,x;if((x=f)||(x=s!==null&&s.memoizedState===null?!1:(En.current&2)!==0),x&&(m=!0,a.flags&=-129),x=(a.flags&32)!==0,a.flags&=-33,s===null){if(ks){if(m?Ri(a):Ai(),(s=an)?(s=Q0(s,sa),s=s!==null&&s.data!=="&"?s:null,s!==null&&(a.memoizedState={dehydrated:s,treeContext:ki!==null?{id:Na,overflow:Ca}:null,retryLane:536870912,hydrationErrors:null},o=wb(s),o.return=a,a.child=o,Jn=a,an=null)):s=null,s===null)throw Ti(a);return ap(s)?a.lanes=32:a.lanes=536870912,null}var S=c.children;return c=c.fallback,m?(Ai(),m=a.mode,S=kd({mode:"hidden",children:S},m),c=_o(c,m,o,null),S.return=a,c.return=a,S.sibling=c,a.child=S,c=a.child,c.memoizedState=_f(o),c.childLanes=kf(s,x,o),a.memoizedState=wf,Sc(null,c)):(Ri(a),jf(a,S))}var z=s.memoizedState;if(z!==null&&(S=z.dehydrated,S!==null)){if(f)a.flags&256?(Ri(a),a.flags&=-257,a=Tf(s,a,o)):a.memoizedState!==null?(Ai(),a.child=s.child,a.flags|=128,a=null):(Ai(),S=c.fallback,m=a.mode,c=kd({mode:"visible",children:c.children},m),S=_o(S,m,o,null),S.flags|=2,c.return=a,S.return=a,c.sibling=S,a.child=c,Co(a,s.child,null,o),c=a.child,c.memoizedState=_f(o),c.childLanes=kf(s,x,o),a.memoizedState=wf,a=Sc(null,c));else if(Ri(a),ap(S)){if(x=S.nextSibling&&S.nextSibling.dataset,x)var ie=x.dgst;x=ie,c=Error(i(419)),c.stack="",c.digest=x,pc({value:c,source:null,stack:null}),a=Tf(s,a,o)}else if(An||hl(s,a,o,!1),x=(o&s.childLanes)!==0,An||x){if(x=en,x!==null&&(c=Ls(x,o),c!==0&&c!==z.retryLane))throw z.retryLane=c,wo(s,c),Pr(x,s,c),vf;rp(S)||Md(),a=Tf(s,a,o)}else rp(S)?(a.flags|=192,a.child=s.child,a=null):(s=z.treeContext,an=ra(S.nextSibling),Jn=a,ks=!0,ji=null,sa=!1,s!==null&&jb(a,s),a=jf(a,c.children),a.flags|=4096);return a}return m?(Ai(),S=c.fallback,m=a.mode,z=s.child,ie=z.sibling,c=Ga(z,{mode:"hidden",children:c.children}),c.subtreeFlags=z.subtreeFlags&65011712,ie!==null?S=Ga(ie,S):(S=_o(S,m,o,null),S.flags|=2),S.return=a,c.return=a,c.sibling=S,a.child=c,Sc(null,c),c=a.child,S=s.child.memoizedState,S===null?S=_f(o):(m=S.cachePool,m!==null?(z=Cn._currentValue,m=m.parent!==z?{parent:z,pool:z}:m):m=Rb(),S={baseLanes:S.baseLanes|o,cachePool:m}),c.memoizedState=S,c.childLanes=kf(s,x,o),a.memoizedState=wf,Sc(s.child,c)):(Ri(a),o=s.child,s=o.sibling,o=Ga(o,{mode:"visible",children:c.children}),o.return=a,o.sibling=null,s!==null&&(x=a.deletions,x===null?(a.deletions=[s],a.flags|=16):x.push(s)),a.child=o,a.memoizedState=null,o)}function jf(s,a){return a=kd({mode:"visible",children:a},s.mode),a.return=s,s.child=a}function kd(s,a){return s=Fr(22,s,null,a),s.lanes=0,s}function Tf(s,a,o){return Co(a,s.child,null,o),s=jf(a,a.pendingProps.children),s.flags|=2,a.memoizedState=null,s}function qv(s,a,o){s.lanes|=a;var c=s.alternate;c!==null&&(c.lanes|=a),Bm(s.return,a,o)}function Ef(s,a,o,c,m,f){var x=s.memoizedState;x===null?s.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:c,tail:o,tailMode:m,treeForkCount:f}:(x.isBackwards=a,x.rendering=null,x.renderingStartTime=0,x.last=c,x.tail=o,x.tailMode=m,x.treeForkCount=f)}function Hv(s,a,o){var c=a.pendingProps,m=c.revealOrder,f=c.tail;c=c.children;var x=En.current,S=(x&2)!==0;if(S?(x=x&1|2,a.flags|=128):x&=1,Le(En,x),er(s,a,c,o),c=ks?fc:0,!S&&s!==null&&(s.flags&128)!==0)e:for(s=a.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&qv(s,o,a);else if(s.tag===19)qv(s,o,a);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===a)break e;for(;s.sibling===null;){if(s.return===null||s.return===a)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}switch(m){case"forwards":for(o=a.child,m=null;o!==null;)s=o.alternate,s!==null&&dd(s)===null&&(m=o),o=o.sibling;o=m,o===null?(m=a.child,a.child=null):(m=o.sibling,o.sibling=null),Ef(a,!1,m,o,f,c);break;case"backwards":case"unstable_legacy-backwards":for(o=null,m=a.child,a.child=null;m!==null;){if(s=m.alternate,s!==null&&dd(s)===null){a.child=m;break}s=m.sibling,m.sibling=o,o=m,m=s}Ef(a,!0,o,null,f,c);break;case"together":Ef(a,!1,null,null,void 0,c);break;default:a.memoizedState=null}return a.child}function Za(s,a,o){if(s!==null&&(a.dependencies=s.dependencies),Di|=a.lanes,(o&a.childLanes)===0)if(s!==null){if(hl(s,a,o,!1),(o&a.childLanes)===0)return null}else return null;if(s!==null&&a.child!==s.child)throw Error(i(153));if(a.child!==null){for(s=a.child,o=Ga(s,s.pendingProps),a.child=o,o.return=a;s.sibling!==null;)s=s.sibling,o=o.sibling=Ga(s,s.pendingProps),o.return=a;o.sibling=null}return a.child}function Sf(s,a){return(s.lanes&a)!==0?!0:(s=s.dependencies,!!(s!==null&&nd(s)))}function vj(s,a,o){switch(a.tag){case 3:Tt(a,a.stateNode.containerInfo),Ei(a,Cn,s.memoizedState.cache),ko();break;case 27:case 5:Gt(a);break;case 4:Tt(a,a.stateNode.containerInfo);break;case 10:Ei(a,a.type,a.memoizedProps.value);break;case 31:if(a.memoizedState!==null)return a.flags|=128,Xm(a),null;break;case 13:var c=a.memoizedState;if(c!==null)return c.dehydrated!==null?(Ri(a),a.flags|=128,null):(o&a.child.childLanes)!==0?zv(s,a,o):(Ri(a),s=Za(s,a,o),s!==null?s.sibling:null);Ri(a);break;case 19:var m=(s.flags&128)!==0;if(c=(o&a.childLanes)!==0,c||(hl(s,a,o,!1),c=(o&a.childLanes)!==0),m){if(c)return Hv(s,a,o);a.flags|=128}if(m=a.memoizedState,m!==null&&(m.rendering=null,m.tail=null,m.lastEffect=null),Le(En,En.current),c)break;return null;case 22:return a.lanes=0,Lv(s,a,o,a.pendingProps);case 24:Ei(a,Cn,s.memoizedState.cache)}return Za(s,a,o)}function $v(s,a,o){if(s!==null)if(s.memoizedProps!==a.pendingProps)An=!0;else{if(!Sf(s,o)&&(a.flags&128)===0)return An=!1,vj(s,a,o);An=(s.flags&131072)!==0}else An=!1,ks&&(a.flags&1048576)!==0&&kb(a,fc,a.index);switch(a.lanes=0,a.tag){case 16:e:{var c=a.pendingProps;if(s=So(a.elementType),a.type=s,typeof s=="function")Am(s)?(c=Ao(s,c),a.tag=1,a=Uv(null,a,s,c,o)):(a.tag=0,a=xf(null,a,s,c,o));else{if(s!=null){var m=s.$$typeof;if(m===ye){a.tag=11,a=Iv(null,a,s,c,o);break e}else if(m===R){a.tag=14,a=Dv(null,a,s,c,o);break e}}throw a=$e(s)||s,Error(i(306,a,""))}}return a;case 0:return xf(s,a,a.type,a.pendingProps,o);case 1:return c=a.type,m=Ao(c,a.pendingProps),Uv(s,a,c,m,o);case 3:e:{if(Tt(a,a.stateNode.containerInfo),s===null)throw Error(i(387));c=a.pendingProps;var f=a.memoizedState;m=f.element,Wm(s,a),_c(a,c,null,o);var x=a.memoizedState;if(c=x.cache,Ei(a,Cn,c),c!==f.cache&&Um(a,[Cn],o,!0),wc(),c=x.element,f.isDehydrated)if(f={element:c,isDehydrated:!1,cache:x.cache},a.updateQueue.baseState=f,a.memoizedState=f,a.flags&256){a=Fv(s,a,c,o);break e}else if(c!==m){m=Zr(Error(i(424)),a),pc(m),a=Fv(s,a,c,o);break e}else for(s=a.stateNode.containerInfo,s.nodeType===9?s=s.body:s=s.nodeName==="HTML"?s.ownerDocument.body:s,an=ra(s.firstChild),Jn=a,ks=!0,ji=null,sa=!0,o=Lb(a,null,c,o),a.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling;else{if(ko(),c===m){a=Za(s,a,o);break e}er(s,a,c,o)}a=a.child}return a;case 26:return _d(s,a),s===null?(o=s1(a.type,null,a.pendingProps,null))?a.memoizedState=o:ks||(o=a.type,s=a.pendingProps,c=Bd(Ue.current).createElement(o),c[ot]=a,c[mt]=s,tr(c,o,s),N(c),a.stateNode=c):a.memoizedState=s1(a.type,s.memoizedProps,a.pendingProps,s.memoizedState),null;case 27:return Gt(a),s===null&&ks&&(c=a.stateNode=Z0(a.type,a.pendingProps,Ue.current),Jn=a,sa=!0,m=an,Bi(a.type)?(ip=m,an=ra(c.firstChild)):an=m),er(s,a,a.pendingProps.children,o),_d(s,a),s===null&&(a.flags|=4194304),a.child;case 5:return s===null&&ks&&((m=c=an)&&(c=Yj(c,a.type,a.pendingProps,sa),c!==null?(a.stateNode=c,Jn=a,an=ra(c.firstChild),sa=!1,m=!0):m=!1),m||Ti(a)),Gt(a),m=a.type,f=a.pendingProps,x=s!==null?s.memoizedProps:null,c=f.children,tp(m,f)?c=null:x!==null&&tp(m,x)&&(a.flags|=32),a.memoizedState!==null&&(m=Zm(s,a,uj,null,null,o),zc._currentValue=m),_d(s,a),er(s,a,c,o),a.child;case 6:return s===null&&ks&&((s=o=an)&&(o=Qj(o,a.pendingProps,sa),o!==null?(a.stateNode=o,Jn=a,an=null,s=!0):s=!1),s||Ti(a)),null;case 13:return zv(s,a,o);case 4:return Tt(a,a.stateNode.containerInfo),c=a.pendingProps,s===null?a.child=Co(a,null,c,o):er(s,a,c,o),a.child;case 11:return Iv(s,a,a.type,a.pendingProps,o);case 7:return er(s,a,a.pendingProps,o),a.child;case 8:return er(s,a,a.pendingProps.children,o),a.child;case 12:return er(s,a,a.pendingProps.children,o),a.child;case 10:return c=a.pendingProps,Ei(a,a.type,c.value),er(s,a,c.children,o),a.child;case 9:return m=a.type._context,c=a.pendingProps.children,To(a),m=Zn(m),c=c(m),a.flags|=1,er(s,a,c,o),a.child;case 14:return Dv(s,a,a.type,a.pendingProps,o);case 15:return Pv(s,a,a.type,a.pendingProps,o);case 19:return Hv(s,a,o);case 31:return bj(s,a,o);case 22:return Lv(s,a,o,a.pendingProps);case 24:return To(a),c=Zn(Cn),s===null?(m=qm(),m===null&&(m=en,f=Fm(),m.pooledCache=f,f.refCount++,f!==null&&(m.pooledCacheLanes|=o),m=f),a.memoizedState={parent:c,cache:m},$m(a),Ei(a,Cn,m)):((s.lanes&o)!==0&&(Wm(s,a),_c(a,null,null,o),wc()),m=s.memoizedState,f=a.memoizedState,m.parent!==c?(m={parent:c,cache:c},a.memoizedState=m,a.lanes===0&&(a.memoizedState=a.updateQueue.baseState=m),Ei(a,Cn,c)):(c=f.cache,Ei(a,Cn,c),c!==m.cache&&Um(a,[Cn],o,!0))),er(s,a,a.pendingProps.children,o),a.child;case 29:throw a.pendingProps}throw Error(i(156,a.tag))}function ei(s){s.flags|=4}function Nf(s,a,o,c,m){if((a=(s.mode&32)!==0)&&(a=!1),a){if(s.flags|=16777216,(m&335544128)===m)if(s.stateNode.complete)s.flags|=8192;else if(b0())s.flags|=8192;else throw No=od,Hm}else s.flags&=-16777217}function Wv(s,a){if(a.type!=="stylesheet"||(a.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!o1(a))if(b0())s.flags|=8192;else throw No=od,Hm}function jd(s,a){a!==null&&(s.flags|=4),s.flags&16384&&(a=s.tag!==22?Ct():536870912,s.lanes|=a,jl|=a)}function Nc(s,a){if(!ks)switch(s.tailMode){case"hidden":a=s.tail;for(var o=null;a!==null;)a.alternate!==null&&(o=a),a=a.sibling;o===null?s.tail=null:o.sibling=null;break;case"collapsed":o=s.tail;for(var c=null;o!==null;)o.alternate!==null&&(c=o),o=o.sibling;c===null?a||s.tail===null?s.tail=null:s.tail.sibling=null:c.sibling=null}}function on(s){var a=s.alternate!==null&&s.alternate.child===s.child,o=0,c=0;if(a)for(var m=s.child;m!==null;)o|=m.lanes|m.childLanes,c|=m.subtreeFlags&65011712,c|=m.flags&65011712,m.return=s,m=m.sibling;else for(m=s.child;m!==null;)o|=m.lanes|m.childLanes,c|=m.subtreeFlags,c|=m.flags,m.return=s,m=m.sibling;return s.subtreeFlags|=c,s.childLanes=o,a}function xj(s,a,o){var c=a.pendingProps;switch(Pm(a),a.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return on(a),null;case 1:return on(a),null;case 3:return o=a.stateNode,c=null,s!==null&&(c=s.memoizedState.cache),a.memoizedState.cache!==c&&(a.flags|=2048),Qa(Cn),at(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(s===null||s.child===null)&&(dl(a)?ei(a):s===null||s.memoizedState.isDehydrated&&(a.flags&256)===0||(a.flags|=1024,Om())),on(a),null;case 26:var m=a.type,f=a.memoizedState;return s===null?(ei(a),f!==null?(on(a),Wv(a,f)):(on(a),Nf(a,m,null,c,o))):f?f!==s.memoizedState?(ei(a),on(a),Wv(a,f)):(on(a),a.flags&=-16777217):(s=s.memoizedProps,s!==c&&ei(a),on(a),Nf(a,m,s,c,o)),null;case 27:if(zs(a),o=Ue.current,m=a.type,s!==null&&a.stateNode!=null)s.memoizedProps!==c&&ei(a);else{if(!c){if(a.stateNode===null)throw Error(i(166));return on(a),null}s=Oe.current,dl(a)?Tb(a):(s=Z0(m,c,o),a.stateNode=s,ei(a))}return on(a),null;case 5:if(zs(a),m=a.type,s!==null&&a.stateNode!=null)s.memoizedProps!==c&&ei(a);else{if(!c){if(a.stateNode===null)throw Error(i(166));return on(a),null}if(f=Oe.current,dl(a))Tb(a);else{var x=Bd(Ue.current);switch(f){case 1:f=x.createElementNS("http://www.w3.org/2000/svg",m);break;case 2:f=x.createElementNS("http://www.w3.org/1998/Math/MathML",m);break;default:switch(m){case"svg":f=x.createElementNS("http://www.w3.org/2000/svg",m);break;case"math":f=x.createElementNS("http://www.w3.org/1998/Math/MathML",m);break;case"script":f=x.createElement("div"),f.innerHTML="<script><\/script>",f=f.removeChild(f.firstChild);break;case"select":f=typeof c.is=="string"?x.createElement("select",{is:c.is}):x.createElement("select"),c.multiple?f.multiple=!0:c.size&&(f.size=c.size);break;default:f=typeof c.is=="string"?x.createElement(m,{is:c.is}):x.createElement(m)}}f[ot]=a,f[mt]=c;e:for(x=a.child;x!==null;){if(x.tag===5||x.tag===6)f.appendChild(x.stateNode);else if(x.tag!==4&&x.tag!==27&&x.child!==null){x.child.return=x,x=x.child;continue}if(x===a)break e;for(;x.sibling===null;){if(x.return===null||x.return===a)break e;x=x.return}x.sibling.return=x.return,x=x.sibling}a.stateNode=f;e:switch(tr(f,m,c),m){case"button":case"input":case"select":case"textarea":c=!!c.autoFocus;break e;case"img":c=!0;break e;default:c=!1}c&&ei(a)}}return on(a),Nf(a,a.type,s===null?null:s.memoizedProps,a.pendingProps,o),null;case 6:if(s&&a.stateNode!=null)s.memoizedProps!==c&&ei(a);else{if(typeof c!="string"&&a.stateNode===null)throw Error(i(166));if(s=Ue.current,dl(a)){if(s=a.stateNode,o=a.memoizedProps,c=null,m=Jn,m!==null)switch(m.tag){case 27:case 5:c=m.memoizedProps}s[ot]=a,s=!!(s.nodeValue===o||c!==null&&c.suppressHydrationWarning===!0||z0(s.nodeValue,o)),s||Ti(a,!0)}else s=Bd(s).createTextNode(c),s[ot]=a,a.stateNode=s}return on(a),null;case 31:if(o=a.memoizedState,s===null||s.memoizedState!==null){if(c=dl(a),o!==null){if(s===null){if(!c)throw Error(i(318));if(s=a.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(557));s[ot]=a}else ko(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;on(a),s=!1}else o=Om(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=o),s=!0;if(!s)return a.flags&256?(qr(a),a):(qr(a),null);if((a.flags&128)!==0)throw Error(i(558))}return on(a),null;case 13:if(c=a.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(m=dl(a),c!==null&&c.dehydrated!==null){if(s===null){if(!m)throw Error(i(318));if(m=a.memoizedState,m=m!==null?m.dehydrated:null,!m)throw Error(i(317));m[ot]=a}else ko(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;on(a),m=!1}else m=Om(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=m),m=!0;if(!m)return a.flags&256?(qr(a),a):(qr(a),null)}return qr(a),(a.flags&128)!==0?(a.lanes=o,a):(o=c!==null,s=s!==null&&s.memoizedState!==null,o&&(c=a.child,m=null,c.alternate!==null&&c.alternate.memoizedState!==null&&c.alternate.memoizedState.cachePool!==null&&(m=c.alternate.memoizedState.cachePool.pool),f=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(f=c.memoizedState.cachePool.pool),f!==m&&(c.flags|=2048)),o!==s&&o&&(a.child.flags|=8192),jd(a,a.updateQueue),on(a),null);case 4:return at(),s===null&&Qf(a.stateNode.containerInfo),on(a),null;case 10:return Qa(a.type),on(a),null;case 19:if(se(En),c=a.memoizedState,c===null)return on(a),null;if(m=(a.flags&128)!==0,f=c.rendering,f===null)if(m)Nc(c,!1);else{if(bn!==0||s!==null&&(s.flags&128)!==0)for(s=a.child;s!==null;){if(f=dd(s),f!==null){for(a.flags|=128,Nc(c,!1),s=f.updateQueue,a.updateQueue=s,jd(a,s),a.subtreeFlags=0,s=o,o=a.child;o!==null;)xb(o,s),o=o.sibling;return Le(En,En.current&1|2),ks&&Ka(a,c.treeForkCount),a.child}s=s.sibling}c.tail!==null&&Kt()>Cd&&(a.flags|=128,m=!0,Nc(c,!1),a.lanes=4194304)}else{if(!m)if(s=dd(f),s!==null){if(a.flags|=128,m=!0,s=s.updateQueue,a.updateQueue=s,jd(a,s),Nc(c,!0),c.tail===null&&c.tailMode==="hidden"&&!f.alternate&&!ks)return on(a),null}else 2*Kt()-c.renderingStartTime>Cd&&o!==536870912&&(a.flags|=128,m=!0,Nc(c,!1),a.lanes=4194304);c.isBackwards?(f.sibling=a.child,a.child=f):(s=c.last,s!==null?s.sibling=f:a.child=f,c.last=f)}return c.tail!==null?(s=c.tail,c.rendering=s,c.tail=s.sibling,c.renderingStartTime=Kt(),s.sibling=null,o=En.current,Le(En,m?o&1|2:o&1),ks&&Ka(a,c.treeForkCount),s):(on(a),null);case 22:case 23:return qr(a),Qm(),c=a.memoizedState!==null,s!==null?s.memoizedState!==null!==c&&(a.flags|=8192):c&&(a.flags|=8192),c?(o&536870912)!==0&&(a.flags&128)===0&&(on(a),a.subtreeFlags&6&&(a.flags|=8192)):on(a),o=a.updateQueue,o!==null&&jd(a,o.retryQueue),o=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(o=s.memoizedState.cachePool.pool),c=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(c=a.memoizedState.cachePool.pool),c!==o&&(a.flags|=2048),s!==null&&se(Eo),null;case 24:return o=null,s!==null&&(o=s.memoizedState.cache),a.memoizedState.cache!==o&&(a.flags|=2048),Qa(Cn),on(a),null;case 25:return null;case 30:return null}throw Error(i(156,a.tag))}function wj(s,a){switch(Pm(a),a.tag){case 1:return s=a.flags,s&65536?(a.flags=s&-65537|128,a):null;case 3:return Qa(Cn),at(),s=a.flags,(s&65536)!==0&&(s&128)===0?(a.flags=s&-65537|128,a):null;case 26:case 27:case 5:return zs(a),null;case 31:if(a.memoizedState!==null){if(qr(a),a.alternate===null)throw Error(i(340));ko()}return s=a.flags,s&65536?(a.flags=s&-65537|128,a):null;case 13:if(qr(a),s=a.memoizedState,s!==null&&s.dehydrated!==null){if(a.alternate===null)throw Error(i(340));ko()}return s=a.flags,s&65536?(a.flags=s&-65537|128,a):null;case 19:return se(En),null;case 4:return at(),null;case 10:return Qa(a.type),null;case 22:case 23:return qr(a),Qm(),s!==null&&se(Eo),s=a.flags,s&65536?(a.flags=s&-65537|128,a):null;case 24:return Qa(Cn),null;case 25:return null;default:return null}}function Gv(s,a){switch(Pm(a),a.tag){case 3:Qa(Cn),at();break;case 26:case 27:case 5:zs(a);break;case 4:at();break;case 31:a.memoizedState!==null&&qr(a);break;case 13:qr(a);break;case 19:se(En);break;case 10:Qa(a.type);break;case 22:case 23:qr(a),Qm(),s!==null&&se(Eo);break;case 24:Qa(Cn)}}function Cc(s,a){try{var o=a.updateQueue,c=o!==null?o.lastEffect:null;if(c!==null){var m=c.next;o=m;do{if((o.tag&s)===s){c=void 0;var f=o.create,x=o.inst;c=f(),x.destroy=c}o=o.next}while(o!==m)}}catch(S){Ws(a,a.return,S)}}function Mi(s,a,o){try{var c=a.updateQueue,m=c!==null?c.lastEffect:null;if(m!==null){var f=m.next;c=f;do{if((c.tag&s)===s){var x=c.inst,S=x.destroy;if(S!==void 0){x.destroy=void 0,m=a;var z=o,ie=S;try{ie()}catch(Te){Ws(m,z,Te)}}}c=c.next}while(c!==f)}}catch(Te){Ws(a,a.return,Te)}}function Kv(s){var a=s.updateQueue;if(a!==null){var o=s.stateNode;try{Vb(a,o)}catch(c){Ws(s,s.return,c)}}}function Yv(s,a,o){o.props=Ao(s.type,s.memoizedProps),o.state=s.memoizedState;try{o.componentWillUnmount()}catch(c){Ws(s,a,c)}}function Rc(s,a){try{var o=s.ref;if(o!==null){switch(s.tag){case 26:case 27:case 5:var c=s.stateNode;break;case 30:c=s.stateNode;break;default:c=s.stateNode}typeof o=="function"?s.refCleanup=o(c):o.current=c}}catch(m){Ws(s,a,m)}}function Ra(s,a){var o=s.ref,c=s.refCleanup;if(o!==null)if(typeof c=="function")try{c()}catch(m){Ws(s,a,m)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof o=="function")try{o(null)}catch(m){Ws(s,a,m)}else o.current=null}function Qv(s){var a=s.type,o=s.memoizedProps,c=s.stateNode;try{e:switch(a){case"button":case"input":case"select":case"textarea":o.autoFocus&&c.focus();break e;case"img":o.src?c.src=o.src:o.srcSet&&(c.srcset=o.srcSet)}}catch(m){Ws(s,s.return,m)}}function Cf(s,a,o){try{var c=s.stateNode;qj(c,s.type,o,a),c[mt]=a}catch(m){Ws(s,s.return,m)}}function Xv(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&Bi(s.type)||s.tag===4}function Rf(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||Xv(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&Bi(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function Af(s,a,o){var c=s.tag;if(c===5||c===6)s=s.stateNode,a?(o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o).insertBefore(s,a):(a=o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o,a.appendChild(s),o=o._reactRootContainer,o!=null||a.onclick!==null||(a.onclick=Bs));else if(c!==4&&(c===27&&Bi(s.type)&&(o=s.stateNode,a=null),s=s.child,s!==null))for(Af(s,a,o),s=s.sibling;s!==null;)Af(s,a,o),s=s.sibling}function Td(s,a,o){var c=s.tag;if(c===5||c===6)s=s.stateNode,a?o.insertBefore(s,a):o.appendChild(s);else if(c!==4&&(c===27&&Bi(s.type)&&(o=s.stateNode),s=s.child,s!==null))for(Td(s,a,o),s=s.sibling;s!==null;)Td(s,a,o),s=s.sibling}function Jv(s){var a=s.stateNode,o=s.memoizedProps;try{for(var c=s.type,m=a.attributes;m.length;)a.removeAttributeNode(m[0]);tr(a,c,o),a[ot]=s,a[mt]=o}catch(f){Ws(s,s.return,f)}}var ti=!1,Mn=!1,Mf=!1,Zv=typeof WeakSet=="function"?WeakSet:Set,$n=null;function _j(s,a){if(s=s.containerInfo,Zf=Wd,s=db(s),jm(s)){if("selectionStart"in s)var o={start:s.selectionStart,end:s.selectionEnd};else e:{o=(o=s.ownerDocument)&&o.defaultView||window;var c=o.getSelection&&o.getSelection();if(c&&c.rangeCount!==0){o=c.anchorNode;var m=c.anchorOffset,f=c.focusNode;c=c.focusOffset;try{o.nodeType,f.nodeType}catch{o=null;break e}var x=0,S=-1,z=-1,ie=0,Te=0,Ie=s,le=null;t:for(;;){for(var pe;Ie!==o||m!==0&&Ie.nodeType!==3||(S=x+m),Ie!==f||c!==0&&Ie.nodeType!==3||(z=x+c),Ie.nodeType===3&&(x+=Ie.nodeValue.length),(pe=Ie.firstChild)!==null;)le=Ie,Ie=pe;for(;;){if(Ie===s)break t;if(le===o&&++ie===m&&(S=x),le===f&&++Te===c&&(z=x),(pe=Ie.nextSibling)!==null)break;Ie=le,le=Ie.parentNode}Ie=pe}o=S===-1||z===-1?null:{start:S,end:z}}else o=null}o=o||{start:0,end:0}}else o=null;for(ep={focusedElem:s,selectionRange:o},Wd=!1,$n=a;$n!==null;)if(a=$n,s=a.child,(a.subtreeFlags&1028)!==0&&s!==null)s.return=a,$n=s;else for(;$n!==null;){switch(a=$n,f=a.alternate,s=a.flags,a.tag){case 0:if((s&4)!==0&&(s=a.updateQueue,s=s!==null?s.events:null,s!==null))for(o=0;o<s.length;o++)m=s[o],m.ref.impl=m.nextImpl;break;case 11:case 15:break;case 1:if((s&1024)!==0&&f!==null){s=void 0,o=a,m=f.memoizedProps,f=f.memoizedState,c=o.stateNode;try{var ft=Ao(o.type,m);s=c.getSnapshotBeforeUpdate(ft,f),c.__reactInternalSnapshotBeforeUpdate=s}catch(It){Ws(o,o.return,It)}}break;case 3:if((s&1024)!==0){if(s=a.stateNode.containerInfo,o=s.nodeType,o===9)np(s);else if(o===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":np(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(i(163))}if(s=a.sibling,s!==null){s.return=a.return,$n=s;break}$n=a.return}}function e0(s,a,o){var c=o.flags;switch(o.tag){case 0:case 11:case 15:ni(s,o),c&4&&Cc(5,o);break;case 1:if(ni(s,o),c&4)if(s=o.stateNode,a===null)try{s.componentDidMount()}catch(x){Ws(o,o.return,x)}else{var m=Ao(o.type,a.memoizedProps);a=a.memoizedState;try{s.componentDidUpdate(m,a,s.__reactInternalSnapshotBeforeUpdate)}catch(x){Ws(o,o.return,x)}}c&64&&Kv(o),c&512&&Rc(o,o.return);break;case 3:if(ni(s,o),c&64&&(s=o.updateQueue,s!==null)){if(a=null,o.child!==null)switch(o.child.tag){case 27:case 5:a=o.child.stateNode;break;case 1:a=o.child.stateNode}try{Vb(s,a)}catch(x){Ws(o,o.return,x)}}break;case 27:a===null&&c&4&&Jv(o);case 26:case 5:ni(s,o),a===null&&c&4&&Qv(o),c&512&&Rc(o,o.return);break;case 12:ni(s,o);break;case 31:ni(s,o),c&4&&n0(s,o);break;case 13:ni(s,o),c&4&&r0(s,o),c&64&&(s=o.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(o=Aj.bind(null,o),Xj(s,o))));break;case 22:if(c=o.memoizedState!==null||ti,!c){a=a!==null&&a.memoizedState!==null||Mn,m=ti;var f=Mn;ti=c,(Mn=a)&&!f?ri(s,o,(o.subtreeFlags&8772)!==0):ni(s,o),ti=m,Mn=f}break;case 30:break;default:ni(s,o)}}function t0(s){var a=s.alternate;a!==null&&(s.alternate=null,t0(a)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(a=s.stateNode,a!==null&&Ln(a)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var dn=null,Ar=!1;function si(s,a,o){for(o=o.child;o!==null;)s0(s,a,o),o=o.sibling}function s0(s,a,o){if(Y&&typeof Y.onCommitFiberUnmount=="function")try{Y.onCommitFiberUnmount(De,o)}catch{}switch(o.tag){case 26:Mn||Ra(o,a),si(s,a,o),o.memoizedState?o.memoizedState.count--:o.stateNode&&(o=o.stateNode,o.parentNode.removeChild(o));break;case 27:Mn||Ra(o,a);var c=dn,m=Ar;Bi(o.type)&&(dn=o.stateNode,Ar=!1),si(s,a,o),Bc(o.stateNode),dn=c,Ar=m;break;case 5:Mn||Ra(o,a);case 6:if(c=dn,m=Ar,dn=null,si(s,a,o),dn=c,Ar=m,dn!==null)if(Ar)try{(dn.nodeType===9?dn.body:dn.nodeName==="HTML"?dn.ownerDocument.body:dn).removeChild(o.stateNode)}catch(f){Ws(o,a,f)}else try{dn.removeChild(o.stateNode)}catch(f){Ws(o,a,f)}break;case 18:dn!==null&&(Ar?(s=dn,K0(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,o.stateNode),Ml(s)):K0(dn,o.stateNode));break;case 4:c=dn,m=Ar,dn=o.stateNode.containerInfo,Ar=!0,si(s,a,o),dn=c,Ar=m;break;case 0:case 11:case 14:case 15:Mi(2,o,a),Mn||Mi(4,o,a),si(s,a,o);break;case 1:Mn||(Ra(o,a),c=o.stateNode,typeof c.componentWillUnmount=="function"&&Yv(o,a,c)),si(s,a,o);break;case 21:si(s,a,o);break;case 22:Mn=(c=Mn)||o.memoizedState!==null,si(s,a,o),Mn=c;break;default:si(s,a,o)}}function n0(s,a){if(a.memoizedState===null&&(s=a.alternate,s!==null&&(s=s.memoizedState,s!==null))){s=s.dehydrated;try{Ml(s)}catch(o){Ws(a,a.return,o)}}}function r0(s,a){if(a.memoizedState===null&&(s=a.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{Ml(s)}catch(o){Ws(a,a.return,o)}}function kj(s){switch(s.tag){case 31:case 13:case 19:var a=s.stateNode;return a===null&&(a=s.stateNode=new Zv),a;case 22:return s=s.stateNode,a=s._retryCache,a===null&&(a=s._retryCache=new Zv),a;default:throw Error(i(435,s.tag))}}function Ed(s,a){var o=kj(s);a.forEach(function(c){if(!o.has(c)){o.add(c);var m=Mj.bind(null,s,c);c.then(m,m)}})}function Mr(s,a){var o=a.deletions;if(o!==null)for(var c=0;c<o.length;c++){var m=o[c],f=s,x=a,S=x;e:for(;S!==null;){switch(S.tag){case 27:if(Bi(S.type)){dn=S.stateNode,Ar=!1;break e}break;case 5:dn=S.stateNode,Ar=!1;break e;case 3:case 4:dn=S.stateNode.containerInfo,Ar=!0;break e}S=S.return}if(dn===null)throw Error(i(160));s0(f,x,m),dn=null,Ar=!1,f=m.alternate,f!==null&&(f.return=null),m.return=null}if(a.subtreeFlags&13886)for(a=a.child;a!==null;)a0(a,s),a=a.sibling}var fa=null;function a0(s,a){var o=s.alternate,c=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:Mr(a,s),Ir(s),c&4&&(Mi(3,s,s.return),Cc(3,s),Mi(5,s,s.return));break;case 1:Mr(a,s),Ir(s),c&512&&(Mn||o===null||Ra(o,o.return)),c&64&&ti&&(s=s.updateQueue,s!==null&&(c=s.callbacks,c!==null&&(o=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=o===null?c:o.concat(c))));break;case 26:var m=fa;if(Mr(a,s),Ir(s),c&512&&(Mn||o===null||Ra(o,o.return)),c&4){var f=o!==null?o.memoizedState:null;if(c=s.memoizedState,o===null)if(c===null)if(s.stateNode===null){e:{c=s.type,o=s.memoizedProps,m=m.ownerDocument||m;t:switch(c){case"title":f=m.getElementsByTagName("title")[0],(!f||f[ln]||f[ot]||f.namespaceURI==="http://www.w3.org/2000/svg"||f.hasAttribute("itemprop"))&&(f=m.createElement(c),m.head.insertBefore(f,m.querySelector("head > title"))),tr(f,c,o),f[ot]=s,N(f),c=f;break e;case"link":var x=a1("link","href",m).get(c+(o.href||""));if(x){for(var S=0;S<x.length;S++)if(f=x[S],f.getAttribute("href")===(o.href==null||o.href===""?null:o.href)&&f.getAttribute("rel")===(o.rel==null?null:o.rel)&&f.getAttribute("title")===(o.title==null?null:o.title)&&f.getAttribute("crossorigin")===(o.crossOrigin==null?null:o.crossOrigin)){x.splice(S,1);break t}}f=m.createElement(c),tr(f,c,o),m.head.appendChild(f);break;case"meta":if(x=a1("meta","content",m).get(c+(o.content||""))){for(S=0;S<x.length;S++)if(f=x[S],f.getAttribute("content")===(o.content==null?null:""+o.content)&&f.getAttribute("name")===(o.name==null?null:o.name)&&f.getAttribute("property")===(o.property==null?null:o.property)&&f.getAttribute("http-equiv")===(o.httpEquiv==null?null:o.httpEquiv)&&f.getAttribute("charset")===(o.charSet==null?null:o.charSet)){x.splice(S,1);break t}}f=m.createElement(c),tr(f,c,o),m.head.appendChild(f);break;default:throw Error(i(468,c))}f[ot]=s,N(f),c=f}s.stateNode=c}else i1(m,s.type,s.stateNode);else s.stateNode=r1(m,c,s.memoizedProps);else f!==c?(f===null?o.stateNode!==null&&(o=o.stateNode,o.parentNode.removeChild(o)):f.count--,c===null?i1(m,s.type,s.stateNode):r1(m,c,s.memoizedProps)):c===null&&s.stateNode!==null&&Cf(s,s.memoizedProps,o.memoizedProps)}break;case 27:Mr(a,s),Ir(s),c&512&&(Mn||o===null||Ra(o,o.return)),o!==null&&c&4&&Cf(s,s.memoizedProps,o.memoizedProps);break;case 5:if(Mr(a,s),Ir(s),c&512&&(Mn||o===null||Ra(o,o.return)),s.flags&32){m=s.stateNode;try{Rs(m,"")}catch(ft){Ws(s,s.return,ft)}}c&4&&s.stateNode!=null&&(m=s.memoizedProps,Cf(s,m,o!==null?o.memoizedProps:m)),c&1024&&(Mf=!0);break;case 6:if(Mr(a,s),Ir(s),c&4){if(s.stateNode===null)throw Error(i(162));c=s.memoizedProps,o=s.stateNode;try{o.nodeValue=c}catch(ft){Ws(s,s.return,ft)}}break;case 3:if(zd=null,m=fa,fa=Ud(a.containerInfo),Mr(a,s),fa=m,Ir(s),c&4&&o!==null&&o.memoizedState.isDehydrated)try{Ml(a.containerInfo)}catch(ft){Ws(s,s.return,ft)}Mf&&(Mf=!1,i0(s));break;case 4:c=fa,fa=Ud(s.stateNode.containerInfo),Mr(a,s),Ir(s),fa=c;break;case 12:Mr(a,s),Ir(s);break;case 31:Mr(a,s),Ir(s),c&4&&(c=s.updateQueue,c!==null&&(s.updateQueue=null,Ed(s,c)));break;case 13:Mr(a,s),Ir(s),s.child.flags&8192&&s.memoizedState!==null!=(o!==null&&o.memoizedState!==null)&&(Nd=Kt()),c&4&&(c=s.updateQueue,c!==null&&(s.updateQueue=null,Ed(s,c)));break;case 22:m=s.memoizedState!==null;var z=o!==null&&o.memoizedState!==null,ie=ti,Te=Mn;if(ti=ie||m,Mn=Te||z,Mr(a,s),Mn=Te,ti=ie,Ir(s),c&8192)e:for(a=s.stateNode,a._visibility=m?a._visibility&-2:a._visibility|1,m&&(o===null||z||ti||Mn||Mo(s)),o=null,a=s;;){if(a.tag===5||a.tag===26){if(o===null){z=o=a;try{if(f=z.stateNode,m)x=f.style,typeof x.setProperty=="function"?x.setProperty("display","none","important"):x.display="none";else{S=z.stateNode;var Ie=z.memoizedProps.style,le=Ie!=null&&Ie.hasOwnProperty("display")?Ie.display:null;S.style.display=le==null||typeof le=="boolean"?"":(""+le).trim()}}catch(ft){Ws(z,z.return,ft)}}}else if(a.tag===6){if(o===null){z=a;try{z.stateNode.nodeValue=m?"":z.memoizedProps}catch(ft){Ws(z,z.return,ft)}}}else if(a.tag===18){if(o===null){z=a;try{var pe=z.stateNode;m?Y0(pe,!0):Y0(z.stateNode,!1)}catch(ft){Ws(z,z.return,ft)}}}else if((a.tag!==22&&a.tag!==23||a.memoizedState===null||a===s)&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===s)break e;for(;a.sibling===null;){if(a.return===null||a.return===s)break e;o===a&&(o=null),a=a.return}o===a&&(o=null),a.sibling.return=a.return,a=a.sibling}c&4&&(c=s.updateQueue,c!==null&&(o=c.retryQueue,o!==null&&(c.retryQueue=null,Ed(s,o))));break;case 19:Mr(a,s),Ir(s),c&4&&(c=s.updateQueue,c!==null&&(s.updateQueue=null,Ed(s,c)));break;case 30:break;case 21:break;default:Mr(a,s),Ir(s)}}function Ir(s){var a=s.flags;if(a&2){try{for(var o,c=s.return;c!==null;){if(Xv(c)){o=c;break}c=c.return}if(o==null)throw Error(i(160));switch(o.tag){case 27:var m=o.stateNode,f=Rf(s);Td(s,f,m);break;case 5:var x=o.stateNode;o.flags&32&&(Rs(x,""),o.flags&=-33);var S=Rf(s);Td(s,S,x);break;case 3:case 4:var z=o.stateNode.containerInfo,ie=Rf(s);Af(s,ie,z);break;default:throw Error(i(161))}}catch(Te){Ws(s,s.return,Te)}s.flags&=-3}a&4096&&(s.flags&=-4097)}function i0(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var a=s;i0(a),a.tag===5&&a.flags&1024&&a.stateNode.reset(),s=s.sibling}}function ni(s,a){if(a.subtreeFlags&8772)for(a=a.child;a!==null;)e0(s,a.alternate,a),a=a.sibling}function Mo(s){for(s=s.child;s!==null;){var a=s;switch(a.tag){case 0:case 11:case 14:case 15:Mi(4,a,a.return),Mo(a);break;case 1:Ra(a,a.return);var o=a.stateNode;typeof o.componentWillUnmount=="function"&&Yv(a,a.return,o),Mo(a);break;case 27:Bc(a.stateNode);case 26:case 5:Ra(a,a.return),Mo(a);break;case 22:a.memoizedState===null&&Mo(a);break;case 30:Mo(a);break;default:Mo(a)}s=s.sibling}}function ri(s,a,o){for(o=o&&(a.subtreeFlags&8772)!==0,a=a.child;a!==null;){var c=a.alternate,m=s,f=a,x=f.flags;switch(f.tag){case 0:case 11:case 15:ri(m,f,o),Cc(4,f);break;case 1:if(ri(m,f,o),c=f,m=c.stateNode,typeof m.componentDidMount=="function")try{m.componentDidMount()}catch(ie){Ws(c,c.return,ie)}if(c=f,m=c.updateQueue,m!==null){var S=c.stateNode;try{var z=m.shared.hiddenCallbacks;if(z!==null)for(m.shared.hiddenCallbacks=null,m=0;m<z.length;m++)Ob(z[m],S)}catch(ie){Ws(c,c.return,ie)}}o&&x&64&&Kv(f),Rc(f,f.return);break;case 27:Jv(f);case 26:case 5:ri(m,f,o),o&&c===null&&x&4&&Qv(f),Rc(f,f.return);break;case 12:ri(m,f,o);break;case 31:ri(m,f,o),o&&x&4&&n0(m,f);break;case 13:ri(m,f,o),o&&x&4&&r0(m,f);break;case 22:f.memoizedState===null&&ri(m,f,o),Rc(f,f.return);break;case 30:break;default:ri(m,f,o)}a=a.sibling}}function If(s,a){var o=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(o=s.memoizedState.cachePool.pool),s=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(s=a.memoizedState.cachePool.pool),s!==o&&(s!=null&&s.refCount++,o!=null&&gc(o))}function Df(s,a){s=null,a.alternate!==null&&(s=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==s&&(a.refCount++,s!=null&&gc(s))}function pa(s,a,o,c){if(a.subtreeFlags&10256)for(a=a.child;a!==null;)o0(s,a,o,c),a=a.sibling}function o0(s,a,o,c){var m=a.flags;switch(a.tag){case 0:case 11:case 15:pa(s,a,o,c),m&2048&&Cc(9,a);break;case 1:pa(s,a,o,c);break;case 3:pa(s,a,o,c),m&2048&&(s=null,a.alternate!==null&&(s=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==s&&(a.refCount++,s!=null&&gc(s)));break;case 12:if(m&2048){pa(s,a,o,c),s=a.stateNode;try{var f=a.memoizedProps,x=f.id,S=f.onPostCommit;typeof S=="function"&&S(x,a.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(z){Ws(a,a.return,z)}}else pa(s,a,o,c);break;case 31:pa(s,a,o,c);break;case 13:pa(s,a,o,c);break;case 23:break;case 22:f=a.stateNode,x=a.alternate,a.memoizedState!==null?f._visibility&2?pa(s,a,o,c):Ac(s,a):f._visibility&2?pa(s,a,o,c):(f._visibility|=2,wl(s,a,o,c,(a.subtreeFlags&10256)!==0||!1)),m&2048&&If(x,a);break;case 24:pa(s,a,o,c),m&2048&&Df(a.alternate,a);break;default:pa(s,a,o,c)}}function wl(s,a,o,c,m){for(m=m&&((a.subtreeFlags&10256)!==0||!1),a=a.child;a!==null;){var f=s,x=a,S=o,z=c,ie=x.flags;switch(x.tag){case 0:case 11:case 15:wl(f,x,S,z,m),Cc(8,x);break;case 23:break;case 22:var Te=x.stateNode;x.memoizedState!==null?Te._visibility&2?wl(f,x,S,z,m):Ac(f,x):(Te._visibility|=2,wl(f,x,S,z,m)),m&&ie&2048&&If(x.alternate,x);break;case 24:wl(f,x,S,z,m),m&&ie&2048&&Df(x.alternate,x);break;default:wl(f,x,S,z,m)}a=a.sibling}}function Ac(s,a){if(a.subtreeFlags&10256)for(a=a.child;a!==null;){var o=s,c=a,m=c.flags;switch(c.tag){case 22:Ac(o,c),m&2048&&If(c.alternate,c);break;case 24:Ac(o,c),m&2048&&Df(c.alternate,c);break;default:Ac(o,c)}a=a.sibling}}var Mc=8192;function _l(s,a,o){if(s.subtreeFlags&Mc)for(s=s.child;s!==null;)l0(s,a,o),s=s.sibling}function l0(s,a,o){switch(s.tag){case 26:_l(s,a,o),s.flags&Mc&&s.memoizedState!==null&&cT(o,fa,s.memoizedState,s.memoizedProps);break;case 5:_l(s,a,o);break;case 3:case 4:var c=fa;fa=Ud(s.stateNode.containerInfo),_l(s,a,o),fa=c;break;case 22:s.memoizedState===null&&(c=s.alternate,c!==null&&c.memoizedState!==null?(c=Mc,Mc=16777216,_l(s,a,o),Mc=c):_l(s,a,o));break;default:_l(s,a,o)}}function c0(s){var a=s.alternate;if(a!==null&&(s=a.child,s!==null)){a.child=null;do a=s.sibling,s.sibling=null,s=a;while(s!==null)}}function Ic(s){var a=s.deletions;if((s.flags&16)!==0){if(a!==null)for(var o=0;o<a.length;o++){var c=a[o];$n=c,d0(c,s)}c0(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)u0(s),s=s.sibling}function u0(s){switch(s.tag){case 0:case 11:case 15:Ic(s),s.flags&2048&&Mi(9,s,s.return);break;case 3:Ic(s);break;case 12:Ic(s);break;case 22:var a=s.stateNode;s.memoizedState!==null&&a._visibility&2&&(s.return===null||s.return.tag!==13)?(a._visibility&=-3,Sd(s)):Ic(s);break;default:Ic(s)}}function Sd(s){var a=s.deletions;if((s.flags&16)!==0){if(a!==null)for(var o=0;o<a.length;o++){var c=a[o];$n=c,d0(c,s)}c0(s)}for(s=s.child;s!==null;){switch(a=s,a.tag){case 0:case 11:case 15:Mi(8,a,a.return),Sd(a);break;case 22:o=a.stateNode,o._visibility&2&&(o._visibility&=-3,Sd(a));break;default:Sd(a)}s=s.sibling}}function d0(s,a){for(;$n!==null;){var o=$n;switch(o.tag){case 0:case 11:case 15:Mi(8,o,a);break;case 23:case 22:if(o.memoizedState!==null&&o.memoizedState.cachePool!==null){var c=o.memoizedState.cachePool.pool;c!=null&&c.refCount++}break;case 24:gc(o.memoizedState.cache)}if(c=o.child,c!==null)c.return=o,$n=c;else e:for(o=s;$n!==null;){c=$n;var m=c.sibling,f=c.return;if(t0(c),c===o){$n=null;break e}if(m!==null){m.return=f,$n=m;break e}$n=f}}}var jj={getCacheForType:function(s){var a=Zn(Cn),o=a.data.get(s);return o===void 0&&(o=s(),a.data.set(s,o)),o},cacheSignal:function(){return Zn(Cn).controller.signal}},Tj=typeof WeakMap=="function"?WeakMap:Map,Fs=0,en=null,hs=null,gs=0,$s=0,Hr=null,Ii=!1,kl=!1,Pf=!1,ai=0,bn=0,Di=0,Io=0,Lf=0,$r=0,jl=0,Dc=null,Dr=null,Of=!1,Nd=0,h0=0,Cd=1/0,Rd=null,Pi=null,Un=0,Li=null,Tl=null,ii=0,Vf=0,Bf=null,m0=null,Pc=0,Uf=null;function Wr(){return(Fs&2)!==0&&gs!==0?gs&-gs:W.T!==null?Wf():Ee()}function f0(){if($r===0)if((gs&536870912)===0||ks){var s=Q;Q<<=1,(Q&3932160)===0&&(Q=262144),$r=s}else $r=536870912;return s=zr.current,s!==null&&(s.flags|=32),$r}function Pr(s,a,o){(s===en&&($s===2||$s===9)||s.cancelPendingCommit!==null)&&(El(s,0),Oi(s,gs,$r,!1)),Ms(s,o),((Fs&2)===0||s!==en)&&(s===en&&((Fs&2)===0&&(Io|=o),bn===4&&Oi(s,gs,$r,!1)),Aa(s))}function p0(s,a,o){if((Fs&6)!==0)throw Error(i(327));var c=!o&&(a&127)===0&&(a&s.expiredLanes)===0||ht(s,a),m=c?Nj(s,a):zf(s,a,!0),f=c;do{if(m===0){kl&&!c&&Oi(s,a,0,!1);break}else{if(o=s.current.alternate,f&&!Ej(o)){m=zf(s,a,!1),f=!1;continue}if(m===2){if(f=a,s.errorRecoveryDisabledLanes&f)var x=0;else x=s.pendingLanes&-536870913,x=x!==0?x:x&536870912?536870912:0;if(x!==0){a=x;e:{var S=s;m=Dc;var z=S.current.memoizedState.isDehydrated;if(z&&(El(S,x).flags|=256),x=zf(S,x,!1),x!==2){if(Pf&&!z){S.errorRecoveryDisabledLanes|=f,Io|=f,m=4;break e}f=Dr,Dr=m,f!==null&&(Dr===null?Dr=f:Dr.push.apply(Dr,f))}m=x}if(f=!1,m!==2)continue}}if(m===1){El(s,0),Oi(s,a,0,!0);break}e:{switch(c=s,f=m,f){case 0:case 1:throw Error(i(345));case 4:if((a&4194048)!==a)break;case 6:Oi(c,a,$r,!Ii);break e;case 2:Dr=null;break;case 3:case 5:break;default:throw Error(i(329))}if((a&62914560)===a&&(m=Nd+300-Kt(),10<m)){if(Oi(c,a,$r,!Ii),dt(c,0,!0)!==0)break e;ii=a,c.timeoutHandle=W0(g0.bind(null,c,o,Dr,Rd,Of,a,$r,Io,jl,Ii,f,"Throttled",-0,0),m);break e}g0(c,o,Dr,Rd,Of,a,$r,Io,jl,Ii,f,null,-0,0)}}break}while(!0);Aa(s)}function g0(s,a,o,c,m,f,x,S,z,ie,Te,Ie,le,pe){if(s.timeoutHandle=-1,Ie=a.subtreeFlags,Ie&8192||(Ie&16785408)===16785408){Ie={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Bs},l0(a,f,Ie);var ft=(f&62914560)===f?Nd-Kt():(f&4194048)===f?h0-Kt():0;if(ft=uT(Ie,ft),ft!==null){ii=f,s.cancelPendingCommit=ft(j0.bind(null,s,a,f,o,c,m,x,S,z,Te,Ie,null,le,pe)),Oi(s,f,x,!ie);return}}j0(s,a,f,o,c,m,x,S,z)}function Ej(s){for(var a=s;;){var o=a.tag;if((o===0||o===11||o===15)&&a.flags&16384&&(o=a.updateQueue,o!==null&&(o=o.stores,o!==null)))for(var c=0;c<o.length;c++){var m=o[c],f=m.getSnapshot;m=m.value;try{if(!Ur(f(),m))return!1}catch{return!1}}if(o=a.child,a.subtreeFlags&16384&&o!==null)o.return=a,a=o;else{if(a===s)break;for(;a.sibling===null;){if(a.return===null||a.return===s)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}}return!0}function Oi(s,a,o,c){a&=~Lf,a&=~Io,s.suspendedLanes|=a,s.pingedLanes&=~a,c&&(s.warmLanes|=a),c=s.expirationTimes;for(var m=a;0<m;){var f=31-Ce(m),x=1<<f;c[f]=-1,m&=~x}o!==0&&ns(s,o,a)}function Ad(){return(Fs&6)===0?(Lc(0),!1):!0}function Ff(){if(hs!==null){if($s===0)var s=hs.return;else s=hs,Ya=jo=null,sf(s),gl=null,bc=0,s=hs;for(;s!==null;)Gv(s.alternate,s),s=s.return;hs=null}}function El(s,a){var o=s.timeoutHandle;o!==-1&&(s.timeoutHandle=-1,Wj(o)),o=s.cancelPendingCommit,o!==null&&(s.cancelPendingCommit=null,o()),ii=0,Ff(),en=s,hs=o=Ga(s.current,null),gs=a,$s=0,Hr=null,Ii=!1,kl=ht(s,a),Pf=!1,jl=$r=Lf=Io=Di=bn=0,Dr=Dc=null,Of=!1,(a&8)!==0&&(a|=a&32);var c=s.entangledLanes;if(c!==0)for(s=s.entanglements,c&=a;0<c;){var m=31-Ce(c),f=1<<m;a|=s[m],c&=~f}return ai=a,Ju(),o}function y0(s,a){Zt=null,W.H=Ec,a===pl||a===id?(a=Ib(),$s=3):a===Hm?(a=Ib(),$s=4):$s=a===vf?8:a!==null&&typeof a=="object"&&typeof a.then=="function"?6:1,Hr=a,hs===null&&(bn=1,xd(s,Zr(a,s.current)))}function b0(){var s=zr.current;return s===null?!0:(gs&4194048)===gs?na===null:(gs&62914560)===gs||(gs&536870912)!==0?s===na:!1}function v0(){var s=W.H;return W.H=Ec,s===null?Ec:s}function x0(){var s=W.A;return W.A=jj,s}function Md(){bn=4,Ii||(gs&4194048)!==gs&&zr.current!==null||(kl=!0),(Di&134217727)===0&&(Io&134217727)===0||en===null||Oi(en,gs,$r,!1)}function zf(s,a,o){var c=Fs;Fs|=2;var m=v0(),f=x0();(en!==s||gs!==a)&&(Rd=null,El(s,a)),a=!1;var x=bn;e:do try{if($s!==0&&hs!==null){var S=hs,z=Hr;switch($s){case 8:Ff(),x=6;break e;case 3:case 2:case 9:case 6:zr.current===null&&(a=!0);var ie=$s;if($s=0,Hr=null,Sl(s,S,z,ie),o&&kl){x=0;break e}break;default:ie=$s,$s=0,Hr=null,Sl(s,S,z,ie)}}Sj(),x=bn;break}catch(Te){y0(s,Te)}while(!0);return a&&s.shellSuspendCounter++,Ya=jo=null,Fs=c,W.H=m,W.A=f,hs===null&&(en=null,gs=0,Ju()),x}function Sj(){for(;hs!==null;)w0(hs)}function Nj(s,a){var o=Fs;Fs|=2;var c=v0(),m=x0();en!==s||gs!==a?(Rd=null,Cd=Kt()+500,El(s,a)):kl=ht(s,a);e:do try{if($s!==0&&hs!==null){a=hs;var f=Hr;t:switch($s){case 1:$s=0,Hr=null,Sl(s,a,f,1);break;case 2:case 9:if(Ab(f)){$s=0,Hr=null,_0(a);break}a=function(){$s!==2&&$s!==9||en!==s||($s=7),Aa(s)},f.then(a,a);break e;case 3:$s=7;break e;case 4:$s=5;break e;case 7:Ab(f)?($s=0,Hr=null,_0(a)):($s=0,Hr=null,Sl(s,a,f,7));break;case 5:var x=null;switch(hs.tag){case 26:x=hs.memoizedState;case 5:case 27:var S=hs;if(x?o1(x):S.stateNode.complete){$s=0,Hr=null;var z=S.sibling;if(z!==null)hs=z;else{var ie=S.return;ie!==null?(hs=ie,Id(ie)):hs=null}break t}}$s=0,Hr=null,Sl(s,a,f,5);break;case 6:$s=0,Hr=null,Sl(s,a,f,6);break;case 8:Ff(),bn=6;break e;default:throw Error(i(462))}}Cj();break}catch(Te){y0(s,Te)}while(!0);return Ya=jo=null,W.H=c,W.A=m,Fs=o,hs!==null?0:(en=null,gs=0,Ju(),bn)}function Cj(){for(;hs!==null&&!rn();)w0(hs)}function w0(s){var a=$v(s.alternate,s,ai);s.memoizedProps=s.pendingProps,a===null?Id(s):hs=a}function _0(s){var a=s,o=a.alternate;switch(a.tag){case 15:case 0:a=Bv(o,a,a.pendingProps,a.type,void 0,gs);break;case 11:a=Bv(o,a,a.pendingProps,a.type.render,a.ref,gs);break;case 5:sf(a);default:Gv(o,a),a=hs=xb(a,ai),a=$v(o,a,ai)}s.memoizedProps=s.pendingProps,a===null?Id(s):hs=a}function Sl(s,a,o,c){Ya=jo=null,sf(a),gl=null,bc=0;var m=a.return;try{if(yj(s,m,a,o,gs)){bn=1,xd(s,Zr(o,s.current)),hs=null;return}}catch(f){if(m!==null)throw hs=m,f;bn=1,xd(s,Zr(o,s.current)),hs=null;return}a.flags&32768?(ks||c===1?s=!0:kl||(gs&536870912)!==0?s=!1:(Ii=s=!0,(c===2||c===9||c===3||c===6)&&(c=zr.current,c!==null&&c.tag===13&&(c.flags|=16384))),k0(a,s)):Id(a)}function Id(s){var a=s;do{if((a.flags&32768)!==0){k0(a,Ii);return}s=a.return;var o=xj(a.alternate,a,ai);if(o!==null){hs=o;return}if(a=a.sibling,a!==null){hs=a;return}hs=a=s}while(a!==null);bn===0&&(bn=5)}function k0(s,a){do{var o=wj(s.alternate,s);if(o!==null){o.flags&=32767,hs=o;return}if(o=s.return,o!==null&&(o.flags|=32768,o.subtreeFlags=0,o.deletions=null),!a&&(s=s.sibling,s!==null)){hs=s;return}hs=s=o}while(s!==null);bn=6,hs=null}function j0(s,a,o,c,m,f,x,S,z){s.cancelPendingCommit=null;do Dd();while(Un!==0);if((Fs&6)!==0)throw Error(i(327));if(a!==null){if(a===s.current)throw Error(i(177));if(f=a.lanes|a.childLanes,f|=Cm,Js(s,o,f,x,S,z),s===en&&(hs=en=null,gs=0),Tl=a,Li=s,ii=o,Vf=f,Bf=m,m0=c,(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,Ij(es,function(){return C0(),null})):(s.callbackNode=null,s.callbackPriority=0),c=(a.flags&13878)!==0,(a.subtreeFlags&13878)!==0||c){c=W.T,W.T=null,m=he.p,he.p=2,x=Fs,Fs|=4;try{_j(s,a,o)}finally{Fs=x,he.p=m,W.T=c}}Un=1,T0(),E0(),S0()}}function T0(){if(Un===1){Un=0;var s=Li,a=Tl,o=(a.flags&13878)!==0;if((a.subtreeFlags&13878)!==0||o){o=W.T,W.T=null;var c=he.p;he.p=2;var m=Fs;Fs|=4;try{a0(a,s);var f=ep,x=db(s.containerInfo),S=f.focusedElem,z=f.selectionRange;if(x!==S&&S&&S.ownerDocument&&ub(S.ownerDocument.documentElement,S)){if(z!==null&&jm(S)){var ie=z.start,Te=z.end;if(Te===void 0&&(Te=ie),"selectionStart"in S)S.selectionStart=ie,S.selectionEnd=Math.min(Te,S.value.length);else{var Ie=S.ownerDocument||document,le=Ie&&Ie.defaultView||window;if(le.getSelection){var pe=le.getSelection(),ft=S.textContent.length,It=Math.min(z.start,ft),Ys=z.end===void 0?It:Math.min(z.end,ft);!pe.extend&&It>Ys&&(x=Ys,Ys=It,It=x);var J=cb(S,It),G=cb(S,Ys);if(J&&G&&(pe.rangeCount!==1||pe.anchorNode!==J.node||pe.anchorOffset!==J.offset||pe.focusNode!==G.node||pe.focusOffset!==G.offset)){var ae=Ie.createRange();ae.setStart(J.node,J.offset),pe.removeAllRanges(),It>Ys?(pe.addRange(ae),pe.extend(G.node,G.offset)):(ae.setEnd(G.node,G.offset),pe.addRange(ae))}}}}for(Ie=[],pe=S;pe=pe.parentNode;)pe.nodeType===1&&Ie.push({element:pe,left:pe.scrollLeft,top:pe.scrollTop});for(typeof S.focus=="function"&&S.focus(),S=0;S<Ie.length;S++){var Re=Ie[S];Re.element.scrollLeft=Re.left,Re.element.scrollTop=Re.top}}Wd=!!Zf,ep=Zf=null}finally{Fs=m,he.p=c,W.T=o}}s.current=a,Un=2}}function E0(){if(Un===2){Un=0;var s=Li,a=Tl,o=(a.flags&8772)!==0;if((a.subtreeFlags&8772)!==0||o){o=W.T,W.T=null;var c=he.p;he.p=2;var m=Fs;Fs|=4;try{e0(s,a.alternate,a)}finally{Fs=m,he.p=c,W.T=o}}Un=3}}function S0(){if(Un===4||Un===3){Un=0,js();var s=Li,a=Tl,o=ii,c=m0;(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?Un=5:(Un=0,Tl=Li=null,N0(s,s.pendingLanes));var m=s.pendingLanes;if(m===0&&(Pi=null),xe(o),a=a.stateNode,Y&&typeof Y.onCommitFiberRoot=="function")try{Y.onCommitFiberRoot(De,a,void 0,(a.current.flags&128)===128)}catch{}if(c!==null){a=W.T,m=he.p,he.p=2,W.T=null;try{for(var f=s.onRecoverableError,x=0;x<c.length;x++){var S=c[x];f(S.value,{componentStack:S.stack})}}finally{W.T=a,he.p=m}}(ii&3)!==0&&Dd(),Aa(s),m=s.pendingLanes,(o&261930)!==0&&(m&42)!==0?s===Uf?Pc++:(Pc=0,Uf=s):Pc=0,Lc(0)}}function N0(s,a){(s.pooledCacheLanes&=a)===0&&(a=s.pooledCache,a!=null&&(s.pooledCache=null,gc(a)))}function Dd(){return T0(),E0(),S0(),C0()}function C0(){if(Un!==5)return!1;var s=Li,a=Vf;Vf=0;var o=xe(ii),c=W.T,m=he.p;try{he.p=32>o?32:o,W.T=null,o=Bf,Bf=null;var f=Li,x=ii;if(Un=0,Tl=Li=null,ii=0,(Fs&6)!==0)throw Error(i(331));var S=Fs;if(Fs|=4,u0(f.current),o0(f,f.current,x,o),Fs=S,Lc(0,!1),Y&&typeof Y.onPostCommitFiberRoot=="function")try{Y.onPostCommitFiberRoot(De,f)}catch{}return!0}finally{he.p=m,W.T=c,N0(s,a)}}function R0(s,a,o){a=Zr(o,a),a=bf(s.stateNode,a,2),s=Ci(s,a,2),s!==null&&(Ms(s,2),Aa(s))}function Ws(s,a,o){if(s.tag===3)R0(s,s,o);else for(;a!==null;){if(a.tag===3){R0(a,s,o);break}else if(a.tag===1){var c=a.stateNode;if(typeof a.type.getDerivedStateFromError=="function"||typeof c.componentDidCatch=="function"&&(Pi===null||!Pi.has(c))){s=Zr(o,s),o=Av(2),c=Ci(a,o,2),c!==null&&(Mv(o,c,a,s),Ms(c,2),Aa(c));break}}a=a.return}}function qf(s,a,o){var c=s.pingCache;if(c===null){c=s.pingCache=new Tj;var m=new Set;c.set(a,m)}else m=c.get(a),m===void 0&&(m=new Set,c.set(a,m));m.has(o)||(Pf=!0,m.add(o),s=Rj.bind(null,s,a,o),a.then(s,s))}function Rj(s,a,o){var c=s.pingCache;c!==null&&c.delete(a),s.pingedLanes|=s.suspendedLanes&o,s.warmLanes&=~o,en===s&&(gs&o)===o&&(bn===4||bn===3&&(gs&62914560)===gs&&300>Kt()-Nd?(Fs&2)===0&&El(s,0):Lf|=o,jl===gs&&(jl=0)),Aa(s)}function A0(s,a){a===0&&(a=Ct()),s=wo(s,a),s!==null&&(Ms(s,a),Aa(s))}function Aj(s){var a=s.memoizedState,o=0;a!==null&&(o=a.retryLane),A0(s,o)}function Mj(s,a){var o=0;switch(s.tag){case 31:case 13:var c=s.stateNode,m=s.memoizedState;m!==null&&(o=m.retryLane);break;case 19:c=s.stateNode;break;case 22:c=s.stateNode._retryCache;break;default:throw Error(i(314))}c!==null&&c.delete(a),A0(s,o)}function Ij(s,a){return Ze(s,a)}var Pd=null,Nl=null,Hf=!1,Ld=!1,$f=!1,Vi=0;function Aa(s){s!==Nl&&s.next===null&&(Nl===null?Pd=Nl=s:Nl=Nl.next=s),Ld=!0,Hf||(Hf=!0,Pj())}function Lc(s,a){if(!$f&&Ld){$f=!0;do for(var o=!1,c=Pd;c!==null;){if(s!==0){var m=c.pendingLanes;if(m===0)var f=0;else{var x=c.suspendedLanes,S=c.pingedLanes;f=(1<<31-Ce(42|s)+1)-1,f&=m&~(x&~S),f=f&201326741?f&201326741|1:f?f|2:0}f!==0&&(o=!0,P0(c,f))}else f=gs,f=dt(c,c===en?f:0,c.cancelPendingCommit!==null||c.timeoutHandle!==-1),(f&3)===0||ht(c,f)||(o=!0,P0(c,f));c=c.next}while(o);$f=!1}}function Dj(){M0()}function M0(){Ld=Hf=!1;var s=0;Vi!==0&&$j()&&(s=Vi);for(var a=Kt(),o=null,c=Pd;c!==null;){var m=c.next,f=I0(c,a);f===0?(c.next=null,o===null?Pd=m:o.next=m,m===null&&(Nl=o)):(o=c,(s!==0||(f&3)!==0)&&(Ld=!0)),c=m}Un!==0&&Un!==5||Lc(s),Vi!==0&&(Vi=0)}function I0(s,a){for(var o=s.suspendedLanes,c=s.pingedLanes,m=s.expirationTimes,f=s.pendingLanes&-62914561;0<f;){var x=31-Ce(f),S=1<<x,z=m[x];z===-1?((S&o)===0||(S&c)!==0)&&(m[x]=Vt(S,a)):z<=a&&(s.expiredLanes|=S),f&=~S}if(a=en,o=gs,o=dt(s,s===a?o:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),c=s.callbackNode,o===0||s===a&&($s===2||$s===9)||s.cancelPendingCommit!==null)return c!==null&&c!==null&&Et(c),s.callbackNode=null,s.callbackPriority=0;if((o&3)===0||ht(s,o)){if(a=o&-o,a===s.callbackPriority)return a;switch(c!==null&&Et(c),xe(o)){case 2:case 8:o=us;break;case 32:o=es;break;case 268435456:o=Nt;break;default:o=es}return c=D0.bind(null,s),o=Ze(o,c),s.callbackPriority=a,s.callbackNode=o,a}return c!==null&&c!==null&&Et(c),s.callbackPriority=2,s.callbackNode=null,2}function D0(s,a){if(Un!==0&&Un!==5)return s.callbackNode=null,s.callbackPriority=0,null;var o=s.callbackNode;if(Dd()&&s.callbackNode!==o)return null;var c=gs;return c=dt(s,s===en?c:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),c===0?null:(p0(s,c,a),I0(s,Kt()),s.callbackNode!=null&&s.callbackNode===o?D0.bind(null,s):null)}function P0(s,a){if(Dd())return null;p0(s,a,!0)}function Pj(){Gj(function(){(Fs&6)!==0?Ze(Yt,Dj):M0()})}function Wf(){if(Vi===0){var s=ml;s===0&&(s=Qe,Qe<<=1,(Qe&261888)===0&&(Qe=256)),Vi=s}return Vi}function L0(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:ls(""+s)}function O0(s,a){var o=a.ownerDocument.createElement("input");return o.name=a.name,o.value=a.value,s.id&&o.setAttribute("form",s.id),a.parentNode.insertBefore(o,a),s=new FormData(s),o.parentNode.removeChild(o),s}function Lj(s,a,o,c,m){if(a==="submit"&&o&&o.stateNode===m){var f=L0((m[mt]||null).action),x=c.submitter;x&&(a=(a=x[mt]||null)?L0(a.formAction):x.getAttribute("formAction"),a!==null&&(f=a,x=null));var S=new qn("action","action",null,c,m);s.push({event:S,listeners:[{instance:null,listener:function(){if(c.defaultPrevented){if(Vi!==0){var z=x?O0(m,x):new FormData(m);hf(o,{pending:!0,data:z,method:m.method,action:f},null,z)}}else typeof f=="function"&&(S.preventDefault(),z=x?O0(m,x):new FormData(m),hf(o,{pending:!0,data:z,method:m.method,action:f},f,z))},currentTarget:m}]})}}for(var Gf=0;Gf<Nm.length;Gf++){var Kf=Nm[Gf],Oj=Kf.toLowerCase(),Vj=Kf[0].toUpperCase()+Kf.slice(1);ma(Oj,"on"+Vj)}ma(fb,"onAnimationEnd"),ma(pb,"onAnimationIteration"),ma(gb,"onAnimationStart"),ma("dblclick","onDoubleClick"),ma("focusin","onFocus"),ma("focusout","onBlur"),ma(ej,"onTransitionRun"),ma(tj,"onTransitionStart"),ma(sj,"onTransitionCancel"),ma(yb,"onTransitionEnd"),Be("onMouseEnter",["mouseout","mouseover"]),Be("onMouseLeave",["mouseout","mouseover"]),Be("onPointerEnter",["pointerout","pointerover"]),Be("onPointerLeave",["pointerout","pointerover"]),ue("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),ue("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),ue("onBeforeInput",["compositionend","keypress","textInput","paste"]),ue("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),ue("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),ue("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Oc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Bj=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Oc));function V0(s,a){a=(a&4)!==0;for(var o=0;o<s.length;o++){var c=s[o],m=c.event;c=c.listeners;e:{var f=void 0;if(a)for(var x=c.length-1;0<=x;x--){var S=c[x],z=S.instance,ie=S.currentTarget;if(S=S.listener,z!==f&&m.isPropagationStopped())break e;f=S,m.currentTarget=ie;try{f(m)}catch(Te){Xu(Te)}m.currentTarget=null,f=z}else for(x=0;x<c.length;x++){if(S=c[x],z=S.instance,ie=S.currentTarget,S=S.listener,z!==f&&m.isPropagationStopped())break e;f=S,m.currentTarget=ie;try{f(m)}catch(Te){Xu(Te)}m.currentTarget=null,f=z}}}}function ms(s,a){var o=a[gt];o===void 0&&(o=a[gt]=new Set);var c=s+"__bubble";o.has(c)||(B0(a,s,2,!1),o.add(c))}function Yf(s,a,o){var c=0;a&&(c|=4),B0(o,s,c,a)}var Od="_reactListening"+Math.random().toString(36).slice(2);function Qf(s){if(!s[Od]){s[Od]=!0,P.forEach(function(o){o!=="selectionchange"&&(Bj.has(o)||Yf(o,!1,s),Yf(o,!0,s))});var a=s.nodeType===9?s:s.ownerDocument;a===null||a[Od]||(a[Od]=!0,Yf("selectionchange",!1,a))}}function B0(s,a,o,c){switch(f1(a)){case 2:var m=mT;break;case 8:m=fT;break;default:m=dp}o=m.bind(null,a,o,s),m=void 0,!Z||a!=="touchstart"&&a!=="touchmove"&&a!=="wheel"||(m=!0),c?m!==void 0?s.addEventListener(a,o,{capture:!0,passive:m}):s.addEventListener(a,o,!0):m!==void 0?s.addEventListener(a,o,{passive:m}):s.addEventListener(a,o,!1)}function Xf(s,a,o,c,m){var f=c;if((a&1)===0&&(a&2)===0&&c!==null)e:for(;;){if(c===null)return;var x=c.tag;if(x===3||x===4){var S=c.stateNode.containerInfo;if(S===m)break;if(x===4)for(x=c.return;x!==null;){var z=x.tag;if((z===3||z===4)&&x.stateNode.containerInfo===m)return;x=x.return}for(;S!==null;){if(x=kn(S),x===null)return;if(z=x.tag,z===5||z===6||z===26||z===27){c=f=x;continue e}S=S.parentNode}}c=c.return}Br(function(){var ie=f,Te=jn(o),Ie=[];e:{var le=bb.get(s);if(le!==void 0){var pe=qn,ft=s;switch(s){case"keypress":if(Bt(o)===0)break e;case"keydown":case"keyup":pe=Ku;break;case"focusin":ft="focus",pe=gn;break;case"focusout":ft="blur",pe=gn;break;case"beforeblur":case"afterblur":pe=gn;break;case"click":if(o.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":pe=ir;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":pe=gr;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":pe=b;break;case fb:case pb:case gb:pe=Rr;break;case yb:pe=C;break;case"scroll":case"scrollend":pe=sn;break;case"wheel":pe=de;break;case"copy":case"cut":case"paste":pe=tl;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":pe=Wa;break;case"toggle":case"beforetoggle":pe=Jt}var It=(a&4)!==0,Ys=!It&&(s==="scroll"||s==="scrollend"),J=It?le!==null?le+"Capture":null:le;It=[];for(var G=ie,ae;G!==null;){var Re=G;if(ae=Re.stateNode,Re=Re.tag,Re!==5&&Re!==26&&Re!==27||ae===null||J===null||(Re=fr(G,J),Re!=null&&It.push(Vc(G,Re,ae))),Ys)break;G=G.return}0<It.length&&(le=new pe(le,ft,null,o,Te),Ie.push({event:le,listeners:It}))}}if((a&7)===0){e:{if(le=s==="mouseover"||s==="pointerover",pe=s==="mouseout"||s==="pointerout",le&&o!==zn&&(ft=o.relatedTarget||o.fromElement)&&(kn(ft)||ft[et]))break e;if((pe||le)&&(le=Te.window===Te?Te:(le=Te.ownerDocument)?le.defaultView||le.parentWindow:window,pe?(ft=o.relatedTarget||o.toElement,pe=ie,ft=ft?kn(ft):null,ft!==null&&(Ys=u(ft),It=ft.tag,ft!==Ys||It!==5&&It!==27&&It!==6)&&(ft=null)):(pe=null,ft=ie),pe!==ft)){if(It=ir,Re="onMouseLeave",J="onMouseEnter",G="mouse",(s==="pointerout"||s==="pointerover")&&(It=Wa,Re="onPointerLeave",J="onPointerEnter",G="pointer"),Ys=pe==null?le:Hs(pe),ae=ft==null?le:Hs(ft),le=new It(Re,G+"leave",pe,o,Te),le.target=Ys,le.relatedTarget=ae,Re=null,kn(Te)===ie&&(It=new It(J,G+"enter",ft,o,Te),It.target=ae,It.relatedTarget=Ys,Re=It),Ys=Re,pe&&ft)t:{for(It=Uj,J=pe,G=ft,ae=0,Re=J;Re;Re=It(Re))ae++;Re=0;for(var kt=G;kt;kt=It(kt))Re++;for(;0<ae-Re;)J=It(J),ae--;for(;0<Re-ae;)G=It(G),Re--;for(;ae--;){if(J===G||G!==null&&J===G.alternate){It=J;break t}J=It(J),G=It(G)}It=null}else It=null;pe!==null&&U0(Ie,le,pe,It,!1),ft!==null&&Ys!==null&&U0(Ie,Ys,ft,It,!0)}}e:{if(le=ie?Hs(ie):window,pe=le.nodeName&&le.nodeName.toLowerCase(),pe==="select"||pe==="input"&&le.type==="file")var Is=nb;else if(tb(le))if(rb)Is=Xk;else{Is=Yk;var vt=Kk}else pe=le.nodeName,!pe||pe.toLowerCase()!=="input"||le.type!=="checkbox"&&le.type!=="radio"?ie&&Nr(ie.elementType)&&(Is=nb):Is=Qk;if(Is&&(Is=Is(s,ie))){sb(Ie,Is,o,Te);break e}vt&&vt(s,le,ie),s==="focusout"&&ie&&le.type==="number"&&ie.memoizedProps.value!=null&&lt(le,"number",le.value)}switch(vt=ie?Hs(ie):window,s){case"focusin":(tb(vt)||vt.contentEditable==="true")&&(al=vt,Tm=ie,mc=null);break;case"focusout":mc=Tm=al=null;break;case"mousedown":Em=!0;break;case"contextmenu":case"mouseup":case"dragend":Em=!1,hb(Ie,o,Te);break;case"selectionchange":if(Zk)break;case"keydown":case"keyup":hb(Ie,o,Te)}var ts;if(Us)e:{switch(s){case"compositionstart":var ys="onCompositionStart";break e;case"compositionend":ys="onCompositionEnd";break e;case"compositionupdate":ys="onCompositionUpdate";break e}ys=void 0}else rl?bo(s,o)&&(ys="onCompositionEnd"):s==="keydown"&&o.keyCode===229&&(ys="onCompositionStart");ys&&(Sa&&o.locale!=="ko"&&(rl||ys!=="onCompositionStart"?ys==="onCompositionEnd"&&rl&&(ts=rt()):(Je=Te,_t="value"in Je?Je.value:Je.textContent,rl=!0)),vt=Vd(ie,ys),0<vt.length&&(ys=new br(ys,s,null,o,Te),Ie.push({event:ys,listeners:vt}),ts?ys.data=ts:(ts=nl(o),ts!==null&&(ys.data=ts)))),(ts=Xr?Hk(s,o):$k(s,o))&&(ys=Vd(ie,"onBeforeInput"),0<ys.length&&(vt=new br("onBeforeInput","beforeinput",null,o,Te),Ie.push({event:vt,listeners:ys}),vt.data=ts)),Lj(Ie,s,ie,o,Te)}V0(Ie,a)})}function Vc(s,a,o){return{instance:s,listener:a,currentTarget:o}}function Vd(s,a){for(var o=a+"Capture",c=[];s!==null;){var m=s,f=m.stateNode;if(m=m.tag,m!==5&&m!==26&&m!==27||f===null||(m=fr(s,o),m!=null&&c.unshift(Vc(s,m,f)),m=fr(s,a),m!=null&&c.push(Vc(s,m,f))),s.tag===3)return c;s=s.return}return[]}function Uj(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function U0(s,a,o,c,m){for(var f=a._reactName,x=[];o!==null&&o!==c;){var S=o,z=S.alternate,ie=S.stateNode;if(S=S.tag,z!==null&&z===c)break;S!==5&&S!==26&&S!==27||ie===null||(z=ie,m?(ie=fr(o,f),ie!=null&&x.unshift(Vc(o,ie,z))):m||(ie=fr(o,f),ie!=null&&x.push(Vc(o,ie,z)))),o=o.return}x.length!==0&&s.push({event:a,listeners:x})}var Fj=/\r\n?/g,zj=/\u0000|\uFFFD/g;function F0(s){return(typeof s=="string"?s:""+s).replace(Fj,`
`).replace(zj,"")}function z0(s,a){return a=F0(a),F0(s)===a}function Ks(s,a,o,c,m,f){switch(o){case"children":typeof c=="string"?a==="body"||a==="textarea"&&c===""||Rs(s,c):(typeof c=="number"||typeof c=="bigint")&&a!=="body"&&Rs(s,""+c);break;case"className":as(s,"class",c);break;case"tabIndex":as(s,"tabindex",c);break;case"dir":case"role":case"viewBox":case"width":case"height":as(s,o,c);break;case"style":Sr(s,c,f);break;case"data":if(a!=="object"){as(s,"data",c);break}case"src":case"href":if(c===""&&(a!=="a"||o!=="href")){s.removeAttribute(o);break}if(c==null||typeof c=="function"||typeof c=="symbol"||typeof c=="boolean"){s.removeAttribute(o);break}c=ls(""+c),s.setAttribute(o,c);break;case"action":case"formAction":if(typeof c=="function"){s.setAttribute(o,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof f=="function"&&(o==="formAction"?(a!=="input"&&Ks(s,a,"name",m.name,m,null),Ks(s,a,"formEncType",m.formEncType,m,null),Ks(s,a,"formMethod",m.formMethod,m,null),Ks(s,a,"formTarget",m.formTarget,m,null)):(Ks(s,a,"encType",m.encType,m,null),Ks(s,a,"method",m.method,m,null),Ks(s,a,"target",m.target,m,null)));if(c==null||typeof c=="symbol"||typeof c=="boolean"){s.removeAttribute(o);break}c=ls(""+c),s.setAttribute(o,c);break;case"onClick":c!=null&&(s.onclick=Bs);break;case"onScroll":c!=null&&ms("scroll",s);break;case"onScrollEnd":c!=null&&ms("scrollend",s);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(i(61));if(o=c.__html,o!=null){if(m.children!=null)throw Error(i(60));s.innerHTML=o}}break;case"multiple":s.multiple=c&&typeof c!="function"&&typeof c!="symbol";break;case"muted":s.muted=c&&typeof c!="function"&&typeof c!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(c==null||typeof c=="function"||typeof c=="boolean"||typeof c=="symbol"){s.removeAttribute("xlink:href");break}o=ls(""+c),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",o);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":c!=null&&typeof c!="function"&&typeof c!="symbol"?s.setAttribute(o,""+c):s.removeAttribute(o);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":c&&typeof c!="function"&&typeof c!="symbol"?s.setAttribute(o,""):s.removeAttribute(o);break;case"capture":case"download":c===!0?s.setAttribute(o,""):c!==!1&&c!=null&&typeof c!="function"&&typeof c!="symbol"?s.setAttribute(o,c):s.removeAttribute(o);break;case"cols":case"rows":case"size":case"span":c!=null&&typeof c!="function"&&typeof c!="symbol"&&!isNaN(c)&&1<=c?s.setAttribute(o,c):s.removeAttribute(o);break;case"rowSpan":case"start":c==null||typeof c=="function"||typeof c=="symbol"||isNaN(c)?s.removeAttribute(o):s.setAttribute(o,c);break;case"popover":ms("beforetoggle",s),ms("toggle",s),Ts(s,"popover",c);break;case"xlinkActuate":cs(s,"http://www.w3.org/1999/xlink","xlink:actuate",c);break;case"xlinkArcrole":cs(s,"http://www.w3.org/1999/xlink","xlink:arcrole",c);break;case"xlinkRole":cs(s,"http://www.w3.org/1999/xlink","xlink:role",c);break;case"xlinkShow":cs(s,"http://www.w3.org/1999/xlink","xlink:show",c);break;case"xlinkTitle":cs(s,"http://www.w3.org/1999/xlink","xlink:title",c);break;case"xlinkType":cs(s,"http://www.w3.org/1999/xlink","xlink:type",c);break;case"xmlBase":cs(s,"http://www.w3.org/XML/1998/namespace","xml:base",c);break;case"xmlLang":cs(s,"http://www.w3.org/XML/1998/namespace","xml:lang",c);break;case"xmlSpace":cs(s,"http://www.w3.org/XML/1998/namespace","xml:space",c);break;case"is":Ts(s,"is",c);break;case"innerText":case"textContent":break;default:(!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(o=ar.get(o)||o,Ts(s,o,c))}}function Jf(s,a,o,c,m,f){switch(o){case"style":Sr(s,c,f);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(i(61));if(o=c.__html,o!=null){if(m.children!=null)throw Error(i(60));s.innerHTML=o}}break;case"children":typeof c=="string"?Rs(s,c):(typeof c=="number"||typeof c=="bigint")&&Rs(s,""+c);break;case"onScroll":c!=null&&ms("scroll",s);break;case"onScrollEnd":c!=null&&ms("scrollend",s);break;case"onClick":c!=null&&(s.onclick=Bs);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!B.hasOwnProperty(o))e:{if(o[0]==="o"&&o[1]==="n"&&(m=o.endsWith("Capture"),a=o.slice(2,m?o.length-7:void 0),f=s[mt]||null,f=f!=null?f[o]:null,typeof f=="function"&&s.removeEventListener(a,f,m),typeof c=="function")){typeof f!="function"&&f!==null&&(o in s?s[o]=null:s.hasAttribute(o)&&s.removeAttribute(o)),s.addEventListener(a,c,m);break e}o in s?s[o]=c:c===!0?s.setAttribute(o,""):Ts(s,o,c)}}}function tr(s,a,o){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":ms("error",s),ms("load",s);var c=!1,m=!1,f;for(f in o)if(o.hasOwnProperty(f)){var x=o[f];if(x!=null)switch(f){case"src":c=!0;break;case"srcSet":m=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,a));default:Ks(s,a,f,x,o,null)}}m&&Ks(s,a,"srcSet",o.srcSet,o,null),c&&Ks(s,a,"src",o.src,o,null);return;case"input":ms("invalid",s);var S=f=x=m=null,z=null,ie=null;for(c in o)if(o.hasOwnProperty(c)){var Te=o[c];if(Te!=null)switch(c){case"name":m=Te;break;case"type":x=Te;break;case"checked":z=Te;break;case"defaultChecked":ie=Te;break;case"value":f=Te;break;case"defaultValue":S=Te;break;case"children":case"dangerouslySetInnerHTML":if(Te!=null)throw Error(i(137,a));break;default:Ks(s,a,c,Te,o,null)}}st(s,f,S,z,ie,x,m,!1);return;case"select":ms("invalid",s),c=x=f=null;for(m in o)if(o.hasOwnProperty(m)&&(S=o[m],S!=null))switch(m){case"value":f=S;break;case"defaultValue":x=S;break;case"multiple":c=S;default:Ks(s,a,m,S,o,null)}a=f,o=x,s.multiple=!!c,a!=null?Mt(s,!!c,a,!1):o!=null&&Mt(s,!!c,o,!0);return;case"textarea":ms("invalid",s),f=m=c=null;for(x in o)if(o.hasOwnProperty(x)&&(S=o[x],S!=null))switch(x){case"value":c=S;break;case"defaultValue":m=S;break;case"children":f=S;break;case"dangerouslySetInnerHTML":if(S!=null)throw Error(i(91));break;default:Ks(s,a,x,S,o,null)}is(s,c,m,f);return;case"option":for(z in o)o.hasOwnProperty(z)&&(c=o[z],c!=null)&&(z==="selected"?s.selected=c&&typeof c!="function"&&typeof c!="symbol":Ks(s,a,z,c,o,null));return;case"dialog":ms("beforetoggle",s),ms("toggle",s),ms("cancel",s),ms("close",s);break;case"iframe":case"object":ms("load",s);break;case"video":case"audio":for(c=0;c<Oc.length;c++)ms(Oc[c],s);break;case"image":ms("error",s),ms("load",s);break;case"details":ms("toggle",s);break;case"embed":case"source":case"link":ms("error",s),ms("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ie in o)if(o.hasOwnProperty(ie)&&(c=o[ie],c!=null))switch(ie){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,a));default:Ks(s,a,ie,c,o,null)}return;default:if(Nr(a)){for(Te in o)o.hasOwnProperty(Te)&&(c=o[Te],c!==void 0&&Jf(s,a,Te,c,o,void 0));return}}for(S in o)o.hasOwnProperty(S)&&(c=o[S],c!=null&&Ks(s,a,S,c,o,null))}function qj(s,a,o,c){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var m=null,f=null,x=null,S=null,z=null,ie=null,Te=null;for(pe in o){var Ie=o[pe];if(o.hasOwnProperty(pe)&&Ie!=null)switch(pe){case"checked":break;case"value":break;case"defaultValue":z=Ie;default:c.hasOwnProperty(pe)||Ks(s,a,pe,null,c,Ie)}}for(var le in c){var pe=c[le];if(Ie=o[le],c.hasOwnProperty(le)&&(pe!=null||Ie!=null))switch(le){case"type":f=pe;break;case"name":m=pe;break;case"checked":ie=pe;break;case"defaultChecked":Te=pe;break;case"value":x=pe;break;case"defaultValue":S=pe;break;case"children":case"dangerouslySetInnerHTML":if(pe!=null)throw Error(i(137,a));break;default:pe!==Ie&&Ks(s,a,le,pe,c,Ie)}}We(s,x,S,z,ie,Te,f,m);return;case"select":pe=x=S=le=null;for(f in o)if(z=o[f],o.hasOwnProperty(f)&&z!=null)switch(f){case"value":break;case"multiple":pe=z;default:c.hasOwnProperty(f)||Ks(s,a,f,null,c,z)}for(m in c)if(f=c[m],z=o[m],c.hasOwnProperty(m)&&(f!=null||z!=null))switch(m){case"value":le=f;break;case"defaultValue":S=f;break;case"multiple":x=f;default:f!==z&&Ks(s,a,m,f,c,z)}a=S,o=x,c=pe,le!=null?Mt(s,!!o,le,!1):!!c!=!!o&&(a!=null?Mt(s,!!o,a,!0):Mt(s,!!o,o?[]:"",!1));return;case"textarea":pe=le=null;for(S in o)if(m=o[S],o.hasOwnProperty(S)&&m!=null&&!c.hasOwnProperty(S))switch(S){case"value":break;case"children":break;default:Ks(s,a,S,null,c,m)}for(x in c)if(m=c[x],f=o[x],c.hasOwnProperty(x)&&(m!=null||f!=null))switch(x){case"value":le=m;break;case"defaultValue":pe=m;break;case"children":break;case"dangerouslySetInnerHTML":if(m!=null)throw Error(i(91));break;default:m!==f&&Ks(s,a,x,m,c,f)}Xt(s,le,pe);return;case"option":for(var ft in o)le=o[ft],o.hasOwnProperty(ft)&&le!=null&&!c.hasOwnProperty(ft)&&(ft==="selected"?s.selected=!1:Ks(s,a,ft,null,c,le));for(z in c)le=c[z],pe=o[z],c.hasOwnProperty(z)&&le!==pe&&(le!=null||pe!=null)&&(z==="selected"?s.selected=le&&typeof le!="function"&&typeof le!="symbol":Ks(s,a,z,le,c,pe));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var It in o)le=o[It],o.hasOwnProperty(It)&&le!=null&&!c.hasOwnProperty(It)&&Ks(s,a,It,null,c,le);for(ie in c)if(le=c[ie],pe=o[ie],c.hasOwnProperty(ie)&&le!==pe&&(le!=null||pe!=null))switch(ie){case"children":case"dangerouslySetInnerHTML":if(le!=null)throw Error(i(137,a));break;default:Ks(s,a,ie,le,c,pe)}return;default:if(Nr(a)){for(var Ys in o)le=o[Ys],o.hasOwnProperty(Ys)&&le!==void 0&&!c.hasOwnProperty(Ys)&&Jf(s,a,Ys,void 0,c,le);for(Te in c)le=c[Te],pe=o[Te],!c.hasOwnProperty(Te)||le===pe||le===void 0&&pe===void 0||Jf(s,a,Te,le,c,pe);return}}for(var J in o)le=o[J],o.hasOwnProperty(J)&&le!=null&&!c.hasOwnProperty(J)&&Ks(s,a,J,null,c,le);for(Ie in c)le=c[Ie],pe=o[Ie],!c.hasOwnProperty(Ie)||le===pe||le==null&&pe==null||Ks(s,a,Ie,le,c,pe)}function q0(s){switch(s){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function Hj(){if(typeof performance.getEntriesByType=="function"){for(var s=0,a=0,o=performance.getEntriesByType("resource"),c=0;c<o.length;c++){var m=o[c],f=m.transferSize,x=m.initiatorType,S=m.duration;if(f&&S&&q0(x)){for(x=0,S=m.responseEnd,c+=1;c<o.length;c++){var z=o[c],ie=z.startTime;if(ie>S)break;var Te=z.transferSize,Ie=z.initiatorType;Te&&q0(Ie)&&(z=z.responseEnd,x+=Te*(z<S?1:(S-ie)/(z-ie)))}if(--c,a+=8*(f+x)/(m.duration/1e3),s++,10<s)break}}if(0<s)return a/s/1e6}return navigator.connection&&(s=navigator.connection.downlink,typeof s=="number")?s:5}var Zf=null,ep=null;function Bd(s){return s.nodeType===9?s:s.ownerDocument}function H0(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function $0(s,a){if(s===0)switch(a){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&a==="foreignObject"?0:s}function tp(s,a){return s==="textarea"||s==="noscript"||typeof a.children=="string"||typeof a.children=="number"||typeof a.children=="bigint"||typeof a.dangerouslySetInnerHTML=="object"&&a.dangerouslySetInnerHTML!==null&&a.dangerouslySetInnerHTML.__html!=null}var sp=null;function $j(){var s=window.event;return s&&s.type==="popstate"?s===sp?!1:(sp=s,!0):(sp=null,!1)}var W0=typeof setTimeout=="function"?setTimeout:void 0,Wj=typeof clearTimeout=="function"?clearTimeout:void 0,G0=typeof Promise=="function"?Promise:void 0,Gj=typeof queueMicrotask=="function"?queueMicrotask:typeof G0<"u"?function(s){return G0.resolve(null).then(s).catch(Kj)}:W0;function Kj(s){setTimeout(function(){throw s})}function Bi(s){return s==="head"}function K0(s,a){var o=a,c=0;do{var m=o.nextSibling;if(s.removeChild(o),m&&m.nodeType===8)if(o=m.data,o==="/$"||o==="/&"){if(c===0){s.removeChild(m),Ml(a);return}c--}else if(o==="$"||o==="$?"||o==="$~"||o==="$!"||o==="&")c++;else if(o==="html")Bc(s.ownerDocument.documentElement);else if(o==="head"){o=s.ownerDocument.head,Bc(o);for(var f=o.firstChild;f;){var x=f.nextSibling,S=f.nodeName;f[ln]||S==="SCRIPT"||S==="STYLE"||S==="LINK"&&f.rel.toLowerCase()==="stylesheet"||o.removeChild(f),f=x}}else o==="body"&&Bc(s.ownerDocument.body);o=m}while(o);Ml(a)}function Y0(s,a){var o=s;s=0;do{var c=o.nextSibling;if(o.nodeType===1?a?(o._stashedDisplay=o.style.display,o.style.display="none"):(o.style.display=o._stashedDisplay||"",o.getAttribute("style")===""&&o.removeAttribute("style")):o.nodeType===3&&(a?(o._stashedText=o.nodeValue,o.nodeValue=""):o.nodeValue=o._stashedText||""),c&&c.nodeType===8)if(o=c.data,o==="/$"){if(s===0)break;s--}else o!=="$"&&o!=="$?"&&o!=="$~"&&o!=="$!"||s++;o=c}while(o)}function np(s){var a=s.firstChild;for(a&&a.nodeType===10&&(a=a.nextSibling);a;){var o=a;switch(a=a.nextSibling,o.nodeName){case"HTML":case"HEAD":case"BODY":np(o),Ln(o);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(o.rel.toLowerCase()==="stylesheet")continue}s.removeChild(o)}}function Yj(s,a,o,c){for(;s.nodeType===1;){var m=o;if(s.nodeName.toLowerCase()!==a.toLowerCase()){if(!c&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(c){if(!s[ln])switch(a){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(f=s.getAttribute("rel"),f==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(f!==m.rel||s.getAttribute("href")!==(m.href==null||m.href===""?null:m.href)||s.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin)||s.getAttribute("title")!==(m.title==null?null:m.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(f=s.getAttribute("src"),(f!==(m.src==null?null:m.src)||s.getAttribute("type")!==(m.type==null?null:m.type)||s.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin))&&f&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(a==="input"&&s.type==="hidden"){var f=m.name==null?null:""+m.name;if(m.type==="hidden"&&s.getAttribute("name")===f)return s}else return s;if(s=ra(s.nextSibling),s===null)break}return null}function Qj(s,a,o){if(a==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!o||(s=ra(s.nextSibling),s===null))return null;return s}function Q0(s,a){for(;s.nodeType!==8;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!a||(s=ra(s.nextSibling),s===null))return null;return s}function rp(s){return s.data==="$?"||s.data==="$~"}function ap(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState!=="loading"}function Xj(s,a){var o=s.ownerDocument;if(s.data==="$~")s._reactRetry=a;else if(s.data!=="$?"||o.readyState!=="loading")a();else{var c=function(){a(),o.removeEventListener("DOMContentLoaded",c)};o.addEventListener("DOMContentLoaded",c),s._reactRetry=c}}function ra(s){for(;s!=null;s=s.nextSibling){var a=s.nodeType;if(a===1||a===3)break;if(a===8){if(a=s.data,a==="$"||a==="$!"||a==="$?"||a==="$~"||a==="&"||a==="F!"||a==="F")break;if(a==="/$"||a==="/&")return null}}return s}var ip=null;function X0(s){s=s.nextSibling;for(var a=0;s;){if(s.nodeType===8){var o=s.data;if(o==="/$"||o==="/&"){if(a===0)return ra(s.nextSibling);a--}else o!=="$"&&o!=="$!"&&o!=="$?"&&o!=="$~"&&o!=="&"||a++}s=s.nextSibling}return null}function J0(s){s=s.previousSibling;for(var a=0;s;){if(s.nodeType===8){var o=s.data;if(o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"){if(a===0)return s;a--}else o!=="/$"&&o!=="/&"||a++}s=s.previousSibling}return null}function Z0(s,a,o){switch(a=Bd(o),s){case"html":if(s=a.documentElement,!s)throw Error(i(452));return s;case"head":if(s=a.head,!s)throw Error(i(453));return s;case"body":if(s=a.body,!s)throw Error(i(454));return s;default:throw Error(i(451))}}function Bc(s){for(var a=s.attributes;a.length;)s.removeAttributeNode(a[0]);Ln(s)}var aa=new Map,e1=new Set;function Ud(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var oi=he.d;he.d={f:Jj,r:Zj,D:eT,C:tT,L:sT,m:nT,X:aT,S:rT,M:iT};function Jj(){var s=oi.f(),a=Ad();return s||a}function Zj(s){var a=pn(s);a!==null&&a.tag===5&&a.type==="form"?yv(a):oi.r(s)}var Cl=typeof document>"u"?null:document;function t1(s,a,o){var c=Cl;if(c&&typeof a=="string"&&a){var m=me(a);m='link[rel="'+s+'"][href="'+m+'"]',typeof o=="string"&&(m+='[crossorigin="'+o+'"]'),e1.has(m)||(e1.add(m),s={rel:s,crossOrigin:o,href:a},c.querySelector(m)===null&&(a=c.createElement("link"),tr(a,"link",s),N(a),c.head.appendChild(a)))}}function eT(s){oi.D(s),t1("dns-prefetch",s,null)}function tT(s,a){oi.C(s,a),t1("preconnect",s,a)}function sT(s,a,o){oi.L(s,a,o);var c=Cl;if(c&&s&&a){var m='link[rel="preload"][as="'+me(a)+'"]';a==="image"&&o&&o.imageSrcSet?(m+='[imagesrcset="'+me(o.imageSrcSet)+'"]',typeof o.imageSizes=="string"&&(m+='[imagesizes="'+me(o.imageSizes)+'"]')):m+='[href="'+me(s)+'"]';var f=m;switch(a){case"style":f=Rl(s);break;case"script":f=Al(s)}aa.has(f)||(s=j({rel:"preload",href:a==="image"&&o&&o.imageSrcSet?void 0:s,as:a},o),aa.set(f,s),c.querySelector(m)!==null||a==="style"&&c.querySelector(Uc(f))||a==="script"&&c.querySelector(Fc(f))||(a=c.createElement("link"),tr(a,"link",s),N(a),c.head.appendChild(a)))}}function nT(s,a){oi.m(s,a);var o=Cl;if(o&&s){var c=a&&typeof a.as=="string"?a.as:"script",m='link[rel="modulepreload"][as="'+me(c)+'"][href="'+me(s)+'"]',f=m;switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":f=Al(s)}if(!aa.has(f)&&(s=j({rel:"modulepreload",href:s},a),aa.set(f,s),o.querySelector(m)===null)){switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(o.querySelector(Fc(f)))return}c=o.createElement("link"),tr(c,"link",s),N(c),o.head.appendChild(c)}}}function rT(s,a,o){oi.S(s,a,o);var c=Cl;if(c&&s){var m=k(c).hoistableStyles,f=Rl(s);a=a||"default";var x=m.get(f);if(!x){var S={loading:0,preload:null};if(x=c.querySelector(Uc(f)))S.loading=5;else{s=j({rel:"stylesheet",href:s,"data-precedence":a},o),(o=aa.get(f))&&op(s,o);var z=x=c.createElement("link");N(z),tr(z,"link",s),z._p=new Promise(function(ie,Te){z.onload=ie,z.onerror=Te}),z.addEventListener("load",function(){S.loading|=1}),z.addEventListener("error",function(){S.loading|=2}),S.loading|=4,Fd(x,a,c)}x={type:"stylesheet",instance:x,count:1,state:S},m.set(f,x)}}}function aT(s,a){oi.X(s,a);var o=Cl;if(o&&s){var c=k(o).hoistableScripts,m=Al(s),f=c.get(m);f||(f=o.querySelector(Fc(m)),f||(s=j({src:s,async:!0},a),(a=aa.get(m))&&lp(s,a),f=o.createElement("script"),N(f),tr(f,"link",s),o.head.appendChild(f)),f={type:"script",instance:f,count:1,state:null},c.set(m,f))}}function iT(s,a){oi.M(s,a);var o=Cl;if(o&&s){var c=k(o).hoistableScripts,m=Al(s),f=c.get(m);f||(f=o.querySelector(Fc(m)),f||(s=j({src:s,async:!0,type:"module"},a),(a=aa.get(m))&&lp(s,a),f=o.createElement("script"),N(f),tr(f,"link",s),o.head.appendChild(f)),f={type:"script",instance:f,count:1,state:null},c.set(m,f))}}function s1(s,a,o,c){var m=(m=Ue.current)?Ud(m):null;if(!m)throw Error(i(446));switch(s){case"meta":case"title":return null;case"style":return typeof o.precedence=="string"&&typeof o.href=="string"?(a=Rl(o.href),o=k(m).hoistableStyles,c=o.get(a),c||(c={type:"style",instance:null,count:0,state:null},o.set(a,c)),c):{type:"void",instance:null,count:0,state:null};case"link":if(o.rel==="stylesheet"&&typeof o.href=="string"&&typeof o.precedence=="string"){s=Rl(o.href);var f=k(m).hoistableStyles,x=f.get(s);if(x||(m=m.ownerDocument||m,x={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},f.set(s,x),(f=m.querySelector(Uc(s)))&&!f._p&&(x.instance=f,x.state.loading=5),aa.has(s)||(o={rel:"preload",as:"style",href:o.href,crossOrigin:o.crossOrigin,integrity:o.integrity,media:o.media,hrefLang:o.hrefLang,referrerPolicy:o.referrerPolicy},aa.set(s,o),f||oT(m,s,o,x.state))),a&&c===null)throw Error(i(528,""));return x}if(a&&c!==null)throw Error(i(529,""));return null;case"script":return a=o.async,o=o.src,typeof o=="string"&&a&&typeof a!="function"&&typeof a!="symbol"?(a=Al(o),o=k(m).hoistableScripts,c=o.get(a),c||(c={type:"script",instance:null,count:0,state:null},o.set(a,c)),c):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,s))}}function Rl(s){return'href="'+me(s)+'"'}function Uc(s){return'link[rel="stylesheet"]['+s+"]"}function n1(s){return j({},s,{"data-precedence":s.precedence,precedence:null})}function oT(s,a,o,c){s.querySelector('link[rel="preload"][as="style"]['+a+"]")?c.loading=1:(a=s.createElement("link"),c.preload=a,a.addEventListener("load",function(){return c.loading|=1}),a.addEventListener("error",function(){return c.loading|=2}),tr(a,"link",o),N(a),s.head.appendChild(a))}function Al(s){return'[src="'+me(s)+'"]'}function Fc(s){return"script[async]"+s}function r1(s,a,o){if(a.count++,a.instance===null)switch(a.type){case"style":var c=s.querySelector('style[data-href~="'+me(o.href)+'"]');if(c)return a.instance=c,N(c),c;var m=j({},o,{"data-href":o.href,"data-precedence":o.precedence,href:null,precedence:null});return c=(s.ownerDocument||s).createElement("style"),N(c),tr(c,"style",m),Fd(c,o.precedence,s),a.instance=c;case"stylesheet":m=Rl(o.href);var f=s.querySelector(Uc(m));if(f)return a.state.loading|=4,a.instance=f,N(f),f;c=n1(o),(m=aa.get(m))&&op(c,m),f=(s.ownerDocument||s).createElement("link"),N(f);var x=f;return x._p=new Promise(function(S,z){x.onload=S,x.onerror=z}),tr(f,"link",c),a.state.loading|=4,Fd(f,o.precedence,s),a.instance=f;case"script":return f=Al(o.src),(m=s.querySelector(Fc(f)))?(a.instance=m,N(m),m):(c=o,(m=aa.get(f))&&(c=j({},o),lp(c,m)),s=s.ownerDocument||s,m=s.createElement("script"),N(m),tr(m,"link",c),s.head.appendChild(m),a.instance=m);case"void":return null;default:throw Error(i(443,a.type))}else a.type==="stylesheet"&&(a.state.loading&4)===0&&(c=a.instance,a.state.loading|=4,Fd(c,o.precedence,s));return a.instance}function Fd(s,a,o){for(var c=o.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),m=c.length?c[c.length-1]:null,f=m,x=0;x<c.length;x++){var S=c[x];if(S.dataset.precedence===a)f=S;else if(f!==m)break}f?f.parentNode.insertBefore(s,f.nextSibling):(a=o.nodeType===9?o.head:o,a.insertBefore(s,a.firstChild))}function op(s,a){s.crossOrigin==null&&(s.crossOrigin=a.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=a.referrerPolicy),s.title==null&&(s.title=a.title)}function lp(s,a){s.crossOrigin==null&&(s.crossOrigin=a.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=a.referrerPolicy),s.integrity==null&&(s.integrity=a.integrity)}var zd=null;function a1(s,a,o){if(zd===null){var c=new Map,m=zd=new Map;m.set(o,c)}else m=zd,c=m.get(o),c||(c=new Map,m.set(o,c));if(c.has(s))return c;for(c.set(s,null),o=o.getElementsByTagName(s),m=0;m<o.length;m++){var f=o[m];if(!(f[ln]||f[ot]||s==="link"&&f.getAttribute("rel")==="stylesheet")&&f.namespaceURI!=="http://www.w3.org/2000/svg"){var x=f.getAttribute(a)||"";x=s+x;var S=c.get(x);S?S.push(f):c.set(x,[f])}}return c}function i1(s,a,o){s=s.ownerDocument||s,s.head.insertBefore(o,a==="title"?s.querySelector("head > title"):null)}function lT(s,a,o){if(o===1||a.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof a.precedence!="string"||typeof a.href!="string"||a.href==="")break;return!0;case"link":if(typeof a.rel!="string"||typeof a.href!="string"||a.href===""||a.onLoad||a.onError)break;return a.rel==="stylesheet"?(s=a.disabled,typeof a.precedence=="string"&&s==null):!0;case"script":if(a.async&&typeof a.async!="function"&&typeof a.async!="symbol"&&!a.onLoad&&!a.onError&&a.src&&typeof a.src=="string")return!0}return!1}function o1(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}function cT(s,a,o,c){if(o.type==="stylesheet"&&(typeof c.media!="string"||matchMedia(c.media).matches!==!1)&&(o.state.loading&4)===0){if(o.instance===null){var m=Rl(c.href),f=a.querySelector(Uc(m));if(f){a=f._p,a!==null&&typeof a=="object"&&typeof a.then=="function"&&(s.count++,s=qd.bind(s),a.then(s,s)),o.state.loading|=4,o.instance=f,N(f);return}f=a.ownerDocument||a,c=n1(c),(m=aa.get(m))&&op(c,m),f=f.createElement("link"),N(f);var x=f;x._p=new Promise(function(S,z){x.onload=S,x.onerror=z}),tr(f,"link",c),o.instance=f}s.stylesheets===null&&(s.stylesheets=new Map),s.stylesheets.set(o,a),(a=o.state.preload)&&(o.state.loading&3)===0&&(s.count++,o=qd.bind(s),a.addEventListener("load",o),a.addEventListener("error",o))}}var cp=0;function uT(s,a){return s.stylesheets&&s.count===0&&$d(s,s.stylesheets),0<s.count||0<s.imgCount?function(o){var c=setTimeout(function(){if(s.stylesheets&&$d(s,s.stylesheets),s.unsuspend){var f=s.unsuspend;s.unsuspend=null,f()}},6e4+a);0<s.imgBytes&&cp===0&&(cp=62500*Hj());var m=setTimeout(function(){if(s.waitingForImages=!1,s.count===0&&(s.stylesheets&&$d(s,s.stylesheets),s.unsuspend)){var f=s.unsuspend;s.unsuspend=null,f()}},(s.imgBytes>cp?50:800)+a);return s.unsuspend=o,function(){s.unsuspend=null,clearTimeout(c),clearTimeout(m)}}:null}function qd(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)$d(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var Hd=null;function $d(s,a){s.stylesheets=null,s.unsuspend!==null&&(s.count++,Hd=new Map,a.forEach(dT,s),Hd=null,qd.call(s))}function dT(s,a){if(!(a.state.loading&4)){var o=Hd.get(s);if(o)var c=o.get(null);else{o=new Map,Hd.set(s,o);for(var m=s.querySelectorAll("link[data-precedence],style[data-precedence]"),f=0;f<m.length;f++){var x=m[f];(x.nodeName==="LINK"||x.getAttribute("media")!=="not all")&&(o.set(x.dataset.precedence,x),c=x)}c&&o.set(null,c)}m=a.instance,x=m.getAttribute("data-precedence"),f=o.get(x)||c,f===c&&o.set(null,m),o.set(x,m),this.count++,c=qd.bind(this),m.addEventListener("load",c),m.addEventListener("error",c),f?f.parentNode.insertBefore(m,f.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(m,s.firstChild)),a.state.loading|=4}}var zc={$$typeof:re,Provider:null,Consumer:null,_currentValue:Pe,_currentValue2:Pe,_threadCount:0};function hT(s,a,o,c,m,f,x,S,z){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=At(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=At(0),this.hiddenUpdates=At(null),this.identifierPrefix=c,this.onUncaughtError=m,this.onCaughtError=f,this.onRecoverableError=x,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=z,this.incompleteTransitions=new Map}function l1(s,a,o,c,m,f,x,S,z,ie,Te,Ie){return s=new hT(s,a,o,x,z,ie,Te,Ie,S),a=1,f===!0&&(a|=24),f=Fr(3,null,null,a),s.current=f,f.stateNode=s,a=Fm(),a.refCount++,s.pooledCache=a,a.refCount++,f.memoizedState={element:c,isDehydrated:o,cache:a},$m(f),s}function c1(s){return s?(s=ll,s):ll}function u1(s,a,o,c,m,f){m=c1(m),c.context===null?c.context=m:c.pendingContext=m,c=Ni(a),c.payload={element:o},f=f===void 0?null:f,f!==null&&(c.callback=f),o=Ci(s,c,a),o!==null&&(Pr(o,s,a),xc(o,s,a))}function d1(s,a){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var o=s.retryLane;s.retryLane=o!==0&&o<a?o:a}}function up(s,a){d1(s,a),(s=s.alternate)&&d1(s,a)}function h1(s){if(s.tag===13||s.tag===31){var a=wo(s,67108864);a!==null&&Pr(a,s,67108864),up(s,67108864)}}function m1(s){if(s.tag===13||s.tag===31){var a=Wr();a=q(a);var o=wo(s,a);o!==null&&Pr(o,s,a),up(s,a)}}var Wd=!0;function mT(s,a,o,c){var m=W.T;W.T=null;var f=he.p;try{he.p=2,dp(s,a,o,c)}finally{he.p=f,W.T=m}}function fT(s,a,o,c){var m=W.T;W.T=null;var f=he.p;try{he.p=8,dp(s,a,o,c)}finally{he.p=f,W.T=m}}function dp(s,a,o,c){if(Wd){var m=hp(c);if(m===null)Xf(s,a,c,Gd,o),p1(s,c);else if(gT(m,s,a,o,c))c.stopPropagation();else if(p1(s,c),a&4&&-1<pT.indexOf(s)){for(;m!==null;){var f=pn(m);if(f!==null)switch(f.tag){case 3:if(f=f.stateNode,f.current.memoizedState.isDehydrated){var x=ze(f.pendingLanes);if(x!==0){var S=f;for(S.pendingLanes|=2,S.entangledLanes|=2;x;){var z=1<<31-Ce(x);S.entanglements[1]|=z,x&=~z}Aa(f),(Fs&6)===0&&(Cd=Kt()+500,Lc(0))}}break;case 31:case 13:S=wo(f,2),S!==null&&Pr(S,f,2),Ad(),up(f,2)}if(f=hp(c),f===null&&Xf(s,a,c,Gd,o),f===m)break;m=f}m!==null&&c.stopPropagation()}else Xf(s,a,c,null,o)}}function hp(s){return s=jn(s),mp(s)}var Gd=null;function mp(s){if(Gd=null,s=kn(s),s!==null){var a=u(s);if(a===null)s=null;else{var o=a.tag;if(o===13){if(s=d(a),s!==null)return s;s=null}else if(o===31){if(s=p(a),s!==null)return s;s=null}else if(o===3){if(a.stateNode.current.memoizedState.isDehydrated)return a.tag===3?a.stateNode.containerInfo:null;s=null}else a!==s&&(s=null)}}return Gd=s,null}function f1(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(St()){case Yt:return 2;case us:return 8;case es:case Xs:return 32;case Nt:return 268435456;default:return 32}default:return 32}}var fp=!1,Ui=null,Fi=null,zi=null,qc=new Map,Hc=new Map,qi=[],pT="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function p1(s,a){switch(s){case"focusin":case"focusout":Ui=null;break;case"dragenter":case"dragleave":Fi=null;break;case"mouseover":case"mouseout":zi=null;break;case"pointerover":case"pointerout":qc.delete(a.pointerId);break;case"gotpointercapture":case"lostpointercapture":Hc.delete(a.pointerId)}}function $c(s,a,o,c,m,f){return s===null||s.nativeEvent!==f?(s={blockedOn:a,domEventName:o,eventSystemFlags:c,nativeEvent:f,targetContainers:[m]},a!==null&&(a=pn(a),a!==null&&h1(a)),s):(s.eventSystemFlags|=c,a=s.targetContainers,m!==null&&a.indexOf(m)===-1&&a.push(m),s)}function gT(s,a,o,c,m){switch(a){case"focusin":return Ui=$c(Ui,s,a,o,c,m),!0;case"dragenter":return Fi=$c(Fi,s,a,o,c,m),!0;case"mouseover":return zi=$c(zi,s,a,o,c,m),!0;case"pointerover":var f=m.pointerId;return qc.set(f,$c(qc.get(f)||null,s,a,o,c,m)),!0;case"gotpointercapture":return f=m.pointerId,Hc.set(f,$c(Hc.get(f)||null,s,a,o,c,m)),!0}return!1}function g1(s){var a=kn(s.target);if(a!==null){var o=u(a);if(o!==null){if(a=o.tag,a===13){if(a=d(o),a!==null){s.blockedOn=a,je(s.priority,function(){m1(o)});return}}else if(a===31){if(a=p(o),a!==null){s.blockedOn=a,je(s.priority,function(){m1(o)});return}}else if(a===3&&o.stateNode.current.memoizedState.isDehydrated){s.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}s.blockedOn=null}function Kd(s){if(s.blockedOn!==null)return!1;for(var a=s.targetContainers;0<a.length;){var o=hp(s.nativeEvent);if(o===null){o=s.nativeEvent;var c=new o.constructor(o.type,o);zn=c,o.target.dispatchEvent(c),zn=null}else return a=pn(o),a!==null&&h1(a),s.blockedOn=o,!1;a.shift()}return!0}function y1(s,a,o){Kd(s)&&o.delete(a)}function yT(){fp=!1,Ui!==null&&Kd(Ui)&&(Ui=null),Fi!==null&&Kd(Fi)&&(Fi=null),zi!==null&&Kd(zi)&&(zi=null),qc.forEach(y1),Hc.forEach(y1)}function Yd(s,a){s.blockedOn===a&&(s.blockedOn=null,fp||(fp=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,yT)))}var Qd=null;function b1(s){Qd!==s&&(Qd=s,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){Qd===s&&(Qd=null);for(var a=0;a<s.length;a+=3){var o=s[a],c=s[a+1],m=s[a+2];if(typeof c!="function"){if(mp(c||o)===null)continue;break}var f=pn(o);f!==null&&(s.splice(a,3),a-=3,hf(f,{pending:!0,data:m,method:o.method,action:c},c,m))}}))}function Ml(s){function a(z){return Yd(z,s)}Ui!==null&&Yd(Ui,s),Fi!==null&&Yd(Fi,s),zi!==null&&Yd(zi,s),qc.forEach(a),Hc.forEach(a);for(var o=0;o<qi.length;o++){var c=qi[o];c.blockedOn===s&&(c.blockedOn=null)}for(;0<qi.length&&(o=qi[0],o.blockedOn===null);)g1(o),o.blockedOn===null&&qi.shift();if(o=(s.ownerDocument||s).$$reactFormReplay,o!=null)for(c=0;c<o.length;c+=3){var m=o[c],f=o[c+1],x=m[mt]||null;if(typeof f=="function")x||b1(o);else if(x){var S=null;if(f&&f.hasAttribute("formAction")){if(m=f,x=f[mt]||null)S=x.formAction;else if(mp(m)!==null)continue}else S=x.action;typeof S=="function"?o[c+1]=S:(o.splice(c,3),c-=3),b1(o)}}}function v1(){function s(f){f.canIntercept&&f.info==="react-transition"&&f.intercept({handler:function(){return new Promise(function(x){return m=x})},focusReset:"manual",scroll:"manual"})}function a(){m!==null&&(m(),m=null),c||setTimeout(o,20)}function o(){if(!c&&!navigation.transition){var f=navigation.currentEntry;f&&f.url!=null&&navigation.navigate(f.url,{state:f.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var c=!1,m=null;return navigation.addEventListener("navigate",s),navigation.addEventListener("navigatesuccess",a),navigation.addEventListener("navigateerror",a),setTimeout(o,100),function(){c=!0,navigation.removeEventListener("navigate",s),navigation.removeEventListener("navigatesuccess",a),navigation.removeEventListener("navigateerror",a),m!==null&&(m(),m=null)}}}function pp(s){this._internalRoot=s}Xd.prototype.render=pp.prototype.render=function(s){var a=this._internalRoot;if(a===null)throw Error(i(409));var o=a.current,c=Wr();u1(o,c,s,a,null,null)},Xd.prototype.unmount=pp.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var a=s.containerInfo;u1(s.current,2,null,s,null,null),Ad(),a[et]=null}};function Xd(s){this._internalRoot=s}Xd.prototype.unstable_scheduleHydration=function(s){if(s){var a=Ee();s={blockedOn:null,target:s,priority:a};for(var o=0;o<qi.length&&a!==0&&a<qi[o].priority;o++);qi.splice(o,0,s),o===0&&g1(s)}};var x1=e.version;if(x1!=="19.2.4")throw Error(i(527,x1,"19.2.4"));he.findDOMNode=function(s){var a=s._reactInternals;if(a===void 0)throw typeof s.render=="function"?Error(i(188)):(s=Object.keys(s).join(","),Error(i(268,s)));return s=y(a),s=s!==null?w(s):null,s=s===null?null:s.stateNode,s};var bT={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:W,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Jd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Jd.isDisabled&&Jd.supportsFiber)try{De=Jd.inject(bT),Y=Jd}catch{}}return Gc.createRoot=function(s,a){if(!l(s))throw Error(i(299));var o=!1,c="",m=Sv,f=Nv,x=Cv;return a!=null&&(a.unstable_strictMode===!0&&(o=!0),a.identifierPrefix!==void 0&&(c=a.identifierPrefix),a.onUncaughtError!==void 0&&(m=a.onUncaughtError),a.onCaughtError!==void 0&&(f=a.onCaughtError),a.onRecoverableError!==void 0&&(x=a.onRecoverableError)),a=l1(s,1,!1,null,null,o,c,null,m,f,x,v1),s[et]=a.current,Qf(s),new pp(a)},Gc.hydrateRoot=function(s,a,o){if(!l(s))throw Error(i(299));var c=!1,m="",f=Sv,x=Nv,S=Cv,z=null;return o!=null&&(o.unstable_strictMode===!0&&(c=!0),o.identifierPrefix!==void 0&&(m=o.identifierPrefix),o.onUncaughtError!==void 0&&(f=o.onUncaughtError),o.onCaughtError!==void 0&&(x=o.onCaughtError),o.onRecoverableError!==void 0&&(S=o.onRecoverableError),o.formState!==void 0&&(z=o.formState)),a=l1(s,1,!0,a,o??null,c,m,z,f,x,S,v1),a.context=c1(null),o=a.current,c=Wr(),c=q(c),m=Ni(c),m.callback=null,Ci(o,m,c),o=c,a.current.lanes=o,Ms(a,o),Aa(a),s[et]=a.current,Qf(s),new Xd(a)},Gc.version="19.2.4",Gc}var R1;function NT(){if(R1)return bp.exports;R1=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),bp.exports=ST(),bp.exports}var CT=NT();const RT="modulepreload",AT=function(n){return"/login/"+n},A1={},Er=function(e,t,i){let l=Promise.resolve();if(t&&t.length>0){let g=function(y){return Promise.all(y.map(w=>Promise.resolve(w).then(j=>({status:"fulfilled",value:j}),j=>({status:"rejected",reason:j}))))};document.getElementsByTagName("link");const d=document.querySelector("meta[property=csp-nonce]"),p=d?.nonce||d?.getAttribute("nonce");l=g(t.map(y=>{if(y=AT(y),y in A1)return;A1[y]=!0;const w=y.endsWith(".css"),j=w?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${y}"]${j}`))return;const T=document.createElement("link");if(T.rel=w?"stylesheet":RT,w||(T.as="script"),T.crossOrigin="",T.href=y,p&&T.setAttribute("nonce",p),document.head.appendChild(T),w)return new Promise((V,$)=>{T.addEventListener("load",V),T.addEventListener("error",()=>$(new Error(`Unable to preload CSS for ${y}`)))})}))}function u(d){const p=new Event("vite:preloadError",{cancelable:!0});if(p.payload=d,window.dispatchEvent(p),!p.defaultPrevented)throw d}return l.then(d=>{for(const p of d||[])p.status==="rejected"&&u(p.reason);return e().catch(u)})};var M1="popstate";function MT(n={}){function e(i,l){let{pathname:u,search:d,hash:p}=i.location;return sg("",{pathname:u,search:d,hash:p},l.state&&l.state.usr||null,l.state&&l.state.key||"default")}function t(i,l){return typeof l=="string"?l:fu(l)}return DT(e,t,null,n)}function hn(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function oa(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function IT(){return Math.random().toString(36).substring(2,10)}function I1(n,e){return{usr:n.state,key:n.key,idx:e}}function sg(n,e,t=null,i){return{pathname:typeof n=="string"?n:n.pathname,search:"",hash:"",...typeof e=="string"?tc(e):e,state:t,key:e&&e.key||i||IT()}}function fu({pathname:n="/",search:e="",hash:t=""}){return e&&e!=="?"&&(n+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(n+=t.charAt(0)==="#"?t:"#"+t),n}function tc(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substring(t),n=n.substring(0,t));let i=n.indexOf("?");i>=0&&(e.search=n.substring(i),n=n.substring(0,i)),n&&(e.pathname=n)}return e}function DT(n,e,t,i={}){let{window:l=document.defaultView,v5Compat:u=!1}=i,d=l.history,p="POP",g=null,y=w();y==null&&(y=0,d.replaceState({...d.state,idx:y},""));function w(){return(d.state||{idx:null}).idx}function j(){p="POP";let U=w(),te=U==null?null:U-y;y=U,g&&g({action:p,location:F.location,delta:te})}function T(U,te){p="PUSH";let K=sg(F.location,U,te);y=w()+1;let re=I1(K,y),ye=F.createHref(K);try{d.pushState(re,"",ye)}catch(ve){if(ve instanceof DOMException&&ve.name==="DataCloneError")throw ve;l.location.assign(ye)}u&&g&&g({action:p,location:F.location,delta:1})}function V(U,te){p="REPLACE";let K=sg(F.location,U,te);y=w();let re=I1(K,y),ye=F.createHref(K);d.replaceState(re,"",ye),u&&g&&g({action:p,location:F.location,delta:0})}function $(U){return PT(U)}let F={get action(){return p},get location(){return n(l,d)},listen(U){if(g)throw new Error("A history only accepts one active listener");return l.addEventListener(M1,j),g=U,()=>{l.removeEventListener(M1,j),g=null}},createHref(U){return e(l,U)},createURL:$,encodeLocation(U){let te=$(U);return{pathname:te.pathname,search:te.search,hash:te.hash}},push:T,replace:V,go(U){return d.go(U)}};return F}function PT(n,e=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),hn(t,"No window.location.(origin|href) available to create URL");let i=typeof n=="string"?n:fu(n);return i=i.replace(/ $/,"%20"),!e&&i.startsWith("//")&&(i=t+i),new URL(i,t)}function I2(n,e,t="/"){return LT(n,e,t,!1)}function LT(n,e,t,i){let l=typeof e=="string"?tc(e):e,u=fi(l.pathname||"/",t);if(u==null)return null;let d=D2(n);OT(d);let p=null;for(let g=0;p==null&&g<d.length;++g){let y=KT(u);p=WT(d[g],y,i)}return p}function D2(n,e=[],t=[],i="",l=!1){let u=(d,p,g=l,y)=>{let w={relativePath:y===void 0?d.path||"":y,caseSensitive:d.caseSensitive===!0,childrenIndex:p,route:d};if(w.relativePath.startsWith("/")){if(!w.relativePath.startsWith(i)&&g)return;hn(w.relativePath.startsWith(i),`Absolute route path "${w.relativePath}" nested under path "${i}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),w.relativePath=w.relativePath.slice(i.length)}let j=ui([i,w.relativePath]),T=t.concat(w);d.children&&d.children.length>0&&(hn(d.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${j}".`),D2(d.children,e,T,j,g)),!(d.path==null&&!d.index)&&e.push({path:j,score:HT(j,d.index),routesMeta:T})};return n.forEach((d,p)=>{if(d.path===""||!d.path?.includes("?"))u(d,p);else for(let g of P2(d.path))u(d,p,!0,g)}),e}function P2(n){let e=n.split("/");if(e.length===0)return[];let[t,...i]=e,l=t.endsWith("?"),u=t.replace(/\?$/,"");if(i.length===0)return l?[u,""]:[u];let d=P2(i.join("/")),p=[];return p.push(...d.map(g=>g===""?u:[u,g].join("/"))),l&&p.push(...d),p.map(g=>n.startsWith("/")&&g===""?"/":g)}function OT(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:$T(e.routesMeta.map(i=>i.childrenIndex),t.routesMeta.map(i=>i.childrenIndex)))}var VT=/^:[\w-]+$/,BT=3,UT=2,FT=1,zT=10,qT=-2,D1=n=>n==="*";function HT(n,e){let t=n.split("/"),i=t.length;return t.some(D1)&&(i+=qT),e&&(i+=UT),t.filter(l=>!D1(l)).reduce((l,u)=>l+(VT.test(u)?BT:u===""?FT:zT),i)}function $T(n,e){return n.length===e.length&&n.slice(0,-1).every((i,l)=>i===e[l])?n[n.length-1]-e[e.length-1]:0}function WT(n,e,t=!1){let{routesMeta:i}=n,l={},u="/",d=[];for(let p=0;p<i.length;++p){let g=i[p],y=p===i.length-1,w=u==="/"?e:e.slice(u.length)||"/",j=Eh({path:g.relativePath,caseSensitive:g.caseSensitive,end:y},w),T=g.route;if(!j&&y&&t&&!i[i.length-1].route.index&&(j=Eh({path:g.relativePath,caseSensitive:g.caseSensitive,end:!1},w)),!j)return null;Object.assign(l,j.params),d.push({params:l,pathname:ui([u,j.pathname]),pathnameBase:JT(ui([u,j.pathnameBase])),route:T}),j.pathnameBase!=="/"&&(u=ui([u,j.pathnameBase]))}return d}function Eh(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,i]=GT(n.path,n.caseSensitive,n.end),l=e.match(t);if(!l)return null;let u=l[0],d=u.replace(/(.)\/+$/,"$1"),p=l.slice(1);return{params:i.reduce((y,{paramName:w,isOptional:j},T)=>{if(w==="*"){let $=p[T]||"";d=u.slice(0,u.length-$.length).replace(/(.)\/+$/,"$1")}const V=p[T];return j&&!V?y[w]=void 0:y[w]=(V||"").replace(/%2F/g,"/"),y},{}),pathname:u,pathnameBase:d,pattern:n}}function GT(n,e=!1,t=!0){oa(n==="*"||!n.endsWith("*")||n.endsWith("/*"),`Route path "${n}" will be treated as if it were "${n.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${n.replace(/\*$/,"/*")}".`);let i=[],l="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(d,p,g)=>(i.push({paramName:p,isOptional:g!=null}),g?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return n.endsWith("*")?(i.push({paramName:"*"}),l+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?l+="\\/*$":n!==""&&n!=="/"&&(l+="(?:(?=\\/|$))"),[new RegExp(l,e?void 0:"i"),i]}function KT(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return oa(!1,`The URL path "${n}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),n}}function fi(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,i=n.charAt(t);return i&&i!=="/"?null:n.slice(t)||"/"}var YT=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i;function QT(n,e="/"){let{pathname:t,search:i="",hash:l=""}=typeof n=="string"?tc(n):n,u;return t?(t=t.replace(/\/\/+/g,"/"),t.startsWith("/")?u=P1(t.substring(1),"/"):u=P1(t,e)):u=e,{pathname:u,search:ZT(i),hash:eE(l)}}function P1(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(l=>{l===".."?t.length>1&&t.pop():l!=="."&&t.push(l)}),t.length>1?t.join("/"):"/"}function _p(n,e,t,i){return`Cannot include a '${n}' character in a manually specified \`to.${e}\` field [${JSON.stringify(i)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function XT(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function Lg(n){let e=XT(n);return e.map((t,i)=>i===e.length-1?t.pathname:t.pathnameBase)}function Og(n,e,t,i=!1){let l;typeof n=="string"?l=tc(n):(l={...n},hn(!l.pathname||!l.pathname.includes("?"),_p("?","pathname","search",l)),hn(!l.pathname||!l.pathname.includes("#"),_p("#","pathname","hash",l)),hn(!l.search||!l.search.includes("#"),_p("#","search","hash",l)));let u=n===""||l.pathname==="",d=u?"/":l.pathname,p;if(d==null)p=t;else{let j=e.length-1;if(!i&&d.startsWith("..")){let T=d.split("/");for(;T[0]==="..";)T.shift(),j-=1;l.pathname=T.join("/")}p=j>=0?e[j]:"/"}let g=QT(l,p),y=d&&d!=="/"&&d.endsWith("/"),w=(u||d===".")&&t.endsWith("/");return!g.pathname.endsWith("/")&&(y||w)&&(g.pathname+="/"),g}var ui=n=>n.join("/").replace(/\/\/+/g,"/"),JT=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),ZT=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,eE=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n,tE=class{constructor(n,e,t,i=!1){this.status=n,this.statusText=e||"",this.internal=i,t instanceof Error?(this.data=t.toString(),this.error=t):this.data=t}};function sE(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}function nE(n){return n.map(e=>e.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var L2=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function O2(n,e){let t=n;if(typeof t!="string"||!YT.test(t))return{absoluteURL:void 0,isExternal:!1,to:t};let i=t,l=!1;if(L2)try{let u=new URL(window.location.href),d=t.startsWith("//")?new URL(u.protocol+t):new URL(t),p=fi(d.pathname,e);d.origin===u.origin&&p!=null?t=p+d.search+d.hash:l=!0}catch{oa(!1,`<Link to="${t}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:i,isExternal:l,to:t}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var V2=["POST","PUT","PATCH","DELETE"];new Set(V2);var rE=["GET",...V2];new Set(rE);var sc=v.createContext(null);sc.displayName="DataRouter";var Yh=v.createContext(null);Yh.displayName="DataRouterState";var aE=v.createContext(!1),B2=v.createContext({isTransitioning:!1});B2.displayName="ViewTransition";var iE=v.createContext(new Map);iE.displayName="Fetchers";var oE=v.createContext(null);oE.displayName="Await";var Qr=v.createContext(null);Qr.displayName="Navigation";var Su=v.createContext(null);Su.displayName="Location";var ja=v.createContext({outlet:null,matches:[],isDataRoute:!1});ja.displayName="Route";var Vg=v.createContext(null);Vg.displayName="RouteError";var U2="REACT_ROUTER_ERROR",lE="REDIRECT",cE="ROUTE_ERROR_RESPONSE";function uE(n){if(n.startsWith(`${U2}:${lE}:{`))try{let e=JSON.parse(n.slice(28));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.location=="string"&&typeof e.reloadDocument=="boolean"&&typeof e.replace=="boolean")return e}catch{}}function dE(n){if(n.startsWith(`${U2}:${cE}:{`))try{let e=JSON.parse(n.slice(40));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string")return new tE(e.status,e.statusText,e.data)}catch{}}function hE(n,{relative:e}={}){hn(nc(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:i}=v.useContext(Qr),{hash:l,pathname:u,search:d}=Nu(n,{relative:e}),p=u;return t!=="/"&&(p=u==="/"?t:ui([t,u])),i.createHref({pathname:p,search:d,hash:l})}function nc(){return v.useContext(Su)!=null}function Ta(){return hn(nc(),"useLocation() may be used only in the context of a <Router> component."),v.useContext(Su).location}var F2="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function z2(n){v.useContext(Qr).static||v.useLayoutEffect(n)}function Gn(){let{isDataRoute:n}=v.useContext(ja);return n?EE():mE()}function mE(){hn(nc(),"useNavigate() may be used only in the context of a <Router> component.");let n=v.useContext(sc),{basename:e,navigator:t}=v.useContext(Qr),{matches:i}=v.useContext(ja),{pathname:l}=Ta(),u=JSON.stringify(Lg(i)),d=v.useRef(!1);return z2(()=>{d.current=!0}),v.useCallback((g,y={})=>{if(oa(d.current,F2),!d.current)return;if(typeof g=="number"){t.go(g);return}let w=Og(g,JSON.parse(u),l,y.relative==="path");n==null&&e!=="/"&&(w.pathname=w.pathname==="/"?e:ui([e,w.pathname])),(y.replace?t.replace:t.push)(w,y.state,y)},[e,t,u,l,n])}v.createContext(null);function fE(){let{matches:n}=v.useContext(ja),e=n[n.length-1];return e?e.params:{}}function Nu(n,{relative:e}={}){let{matches:t}=v.useContext(ja),{pathname:i}=Ta(),l=JSON.stringify(Lg(t));return v.useMemo(()=>Og(n,JSON.parse(l),i,e==="path"),[n,l,i,e])}function pE(n,e){return q2(n,e)}function q2(n,e,t,i,l){hn(nc(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:u}=v.useContext(Qr),{matches:d}=v.useContext(ja),p=d[d.length-1],g=p?p.params:{},y=p?p.pathname:"/",w=p?p.pathnameBase:"/",j=p&&p.route;{let K=j&&j.path||"";$2(y,!j||K.endsWith("*")||K.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${y}" (under <Route path="${K}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${K}"> to <Route path="${K==="/"?"*":`${K}/*`}">.`)}let T=Ta(),V;if(e){let K=typeof e=="string"?tc(e):e;hn(w==="/"||K.pathname?.startsWith(w),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${w}" but pathname "${K.pathname}" was given in the \`location\` prop.`),V=K}else V=T;let $=V.pathname||"/",F=$;if(w!=="/"){let K=w.replace(/^\//,"").split("/");F="/"+$.replace(/^\//,"").split("/").slice(K.length).join("/")}let U=I2(n,{pathname:F});oa(j||U!=null,`No routes matched location "${V.pathname}${V.search}${V.hash}" `),oa(U==null||U[U.length-1].route.element!==void 0||U[U.length-1].route.Component!==void 0||U[U.length-1].route.lazy!==void 0,`Matched leaf route at location "${V.pathname}${V.search}${V.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let te=xE(U&&U.map(K=>Object.assign({},K,{params:Object.assign({},g,K.params),pathname:ui([w,u.encodeLocation?u.encodeLocation(K.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:K.pathname]),pathnameBase:K.pathnameBase==="/"?w:ui([w,u.encodeLocation?u.encodeLocation(K.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:K.pathnameBase])})),d,t,i,l);return e&&te?v.createElement(Su.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...V},navigationType:"POP"}},te):te}function gE(){let n=TE(),e=sE(n)?`${n.status} ${n.statusText}`:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,i="rgba(200,200,200, 0.5)",l={padding:"0.5rem",backgroundColor:i},u={padding:"2px 4px",backgroundColor:i},d=null;return console.error("Error handled by React Router default ErrorBoundary:",n),d=v.createElement(v.Fragment,null,v.createElement("p",null," Hey developer "),v.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",v.createElement("code",{style:u},"ErrorBoundary")," or"," ",v.createElement("code",{style:u},"errorElement")," prop on your route.")),v.createElement(v.Fragment,null,v.createElement("h2",null,"Unexpected Application Error!"),v.createElement("h3",{style:{fontStyle:"italic"}},e),t?v.createElement("pre",{style:l},t):null,d)}var yE=v.createElement(gE,null),H2=class extends v.Component{constructor(n){super(n),this.state={location:n.location,revalidation:n.revalidation,error:n.error}}static getDerivedStateFromError(n){return{error:n}}static getDerivedStateFromProps(n,e){return e.location!==n.location||e.revalidation!=="idle"&&n.revalidation==="idle"?{error:n.error,location:n.location,revalidation:n.revalidation}:{error:n.error!==void 0?n.error:e.error,location:e.location,revalidation:n.revalidation||e.revalidation}}componentDidCatch(n,e){this.props.onError?this.props.onError(n,e):console.error("React Router caught the following error during render",n)}render(){let n=this.state.error;if(this.context&&typeof n=="object"&&n&&"digest"in n&&typeof n.digest=="string"){const t=dE(n.digest);t&&(n=t)}let e=n!==void 0?v.createElement(ja.Provider,{value:this.props.routeContext},v.createElement(Vg.Provider,{value:n,children:this.props.component})):this.props.children;return this.context?v.createElement(bE,{error:n},e):e}};H2.contextType=aE;var kp=new WeakMap;function bE({children:n,error:e}){let{basename:t}=v.useContext(Qr);if(typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){let i=uE(e.digest);if(i){let l=kp.get(e);if(l)throw l;let u=O2(i.location,t);if(L2&&!kp.get(e))if(u.isExternal||i.reloadDocument)window.location.href=u.absoluteURL||u.to;else{const d=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(u.to,{replace:i.replace}));throw kp.set(e,d),d}return v.createElement("meta",{httpEquiv:"refresh",content:`0;url=${u.absoluteURL||u.to}`})}}return n}function vE({routeContext:n,match:e,children:t}){let i=v.useContext(sc);return i&&i.static&&i.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=e.route.id),v.createElement(ja.Provider,{value:n},t)}function xE(n,e=[],t=null,i=null,l=null){if(n==null){if(!t)return null;if(t.errors)n=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let u=n,d=t?.errors;if(d!=null){let w=u.findIndex(j=>j.route.id&&d?.[j.route.id]!==void 0);hn(w>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(d).join(",")}`),u=u.slice(0,Math.min(u.length,w+1))}let p=!1,g=-1;if(t)for(let w=0;w<u.length;w++){let j=u[w];if((j.route.HydrateFallback||j.route.hydrateFallbackElement)&&(g=w),j.route.id){let{loaderData:T,errors:V}=t,$=j.route.loader&&!T.hasOwnProperty(j.route.id)&&(!V||V[j.route.id]===void 0);if(j.route.lazy||$){p=!0,g>=0?u=u.slice(0,g+1):u=[u[0]];break}}}let y=t&&i?(w,j)=>{i(w,{location:t.location,params:t.matches?.[0]?.params??{},unstable_pattern:nE(t.matches),errorInfo:j})}:void 0;return u.reduceRight((w,j,T)=>{let V,$=!1,F=null,U=null;t&&(V=d&&j.route.id?d[j.route.id]:void 0,F=j.route.errorElement||yE,p&&(g<0&&T===0?($2("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),$=!0,U=null):g===T&&($=!0,U=j.route.hydrateFallbackElement||null)));let te=e.concat(u.slice(0,T+1)),K=()=>{let re;return V?re=F:$?re=U:j.route.Component?re=v.createElement(j.route.Component,null):j.route.element?re=j.route.element:re=w,v.createElement(vE,{match:j,routeContext:{outlet:w,matches:te,isDataRoute:t!=null},children:re})};return t&&(j.route.ErrorBoundary||j.route.errorElement||T===0)?v.createElement(H2,{location:t.location,revalidation:t.revalidation,component:F,error:V,children:K(),routeContext:{outlet:null,matches:te,isDataRoute:!0},onError:y}):K()},null)}function Bg(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function wE(n){let e=v.useContext(sc);return hn(e,Bg(n)),e}function _E(n){let e=v.useContext(Yh);return hn(e,Bg(n)),e}function kE(n){let e=v.useContext(ja);return hn(e,Bg(n)),e}function Ug(n){let e=kE(n),t=e.matches[e.matches.length-1];return hn(t.route.id,`${n} can only be used on routes that contain a unique "id"`),t.route.id}function jE(){return Ug("useRouteId")}function TE(){let n=v.useContext(Vg),e=_E("useRouteError"),t=Ug("useRouteError");return n!==void 0?n:e.errors?.[t]}function EE(){let{router:n}=wE("useNavigate"),e=Ug("useNavigate"),t=v.useRef(!1);return z2(()=>{t.current=!0}),v.useCallback(async(l,u={})=>{oa(t.current,F2),t.current&&(typeof l=="number"?await n.navigate(l):await n.navigate(l,{fromRouteId:e,...u}))},[n,e])}var L1={};function $2(n,e,t){!e&&!L1[n]&&(L1[n]=!0,oa(!1,t))}v.memo(SE);function SE({routes:n,future:e,state:t,onError:i}){return q2(n,void 0,t,i,e)}function NE({to:n,replace:e,state:t,relative:i}){hn(nc(),"<Navigate> may be used only in the context of a <Router> component.");let{static:l}=v.useContext(Qr);oa(!l,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:u}=v.useContext(ja),{pathname:d}=Ta(),p=Gn(),g=Og(n,Lg(u),d,i==="path"),y=JSON.stringify(g);return v.useEffect(()=>{p(JSON.parse(y),{replace:e,state:t,relative:i})},[p,y,i,e,t]),null}function tn(n){hn(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function CE({basename:n="/",children:e=null,location:t,navigationType:i="POP",navigator:l,static:u=!1,unstable_useTransitions:d}){hn(!nc(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let p=n.replace(/^\/*/,"/"),g=v.useMemo(()=>({basename:p,navigator:l,static:u,unstable_useTransitions:d,future:{}}),[p,l,u,d]);typeof t=="string"&&(t=tc(t));let{pathname:y="/",search:w="",hash:j="",state:T=null,key:V="default"}=t,$=v.useMemo(()=>{let F=fi(y,p);return F==null?null:{location:{pathname:F,search:w,hash:j,state:T,key:V},navigationType:i}},[p,y,w,j,T,V,i]);return oa($!=null,`<Router basename="${p}"> is not able to match the URL "${y}${w}${j}" because it does not start with the basename, so the <Router> won't render anything.`),$==null?null:v.createElement(Qr.Provider,{value:g},v.createElement(Su.Provider,{children:e,value:$}))}function RE({children:n,location:e}){return pE(ng(n),e)}function ng(n,e=[]){let t=[];return v.Children.forEach(n,(i,l)=>{if(!v.isValidElement(i))return;let u=[...e,l];if(i.type===v.Fragment){t.push.apply(t,ng(i.props.children,u));return}hn(i.type===tn,`[${typeof i.type=="string"?i.type:i.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),hn(!i.props.index||!i.props.children,"An index route cannot have child routes.");let d={id:i.props.id||u.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,middleware:i.props.middleware,loader:i.props.loader,action:i.props.action,hydrateFallbackElement:i.props.hydrateFallbackElement,HydrateFallback:i.props.HydrateFallback,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.hasErrorBoundary===!0||i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(d.children=ng(i.props.children,u)),t.push(d)}),t}var fh="get",ph="application/x-www-form-urlencoded";function Qh(n){return typeof HTMLElement<"u"&&n instanceof HTMLElement}function AE(n){return Qh(n)&&n.tagName.toLowerCase()==="button"}function ME(n){return Qh(n)&&n.tagName.toLowerCase()==="form"}function IE(n){return Qh(n)&&n.tagName.toLowerCase()==="input"}function DE(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function PE(n,e){return n.button===0&&(!e||e==="_self")&&!DE(n)}function rg(n=""){return new URLSearchParams(typeof n=="string"||Array.isArray(n)||n instanceof URLSearchParams?n:Object.keys(n).reduce((e,t)=>{let i=n[t];return e.concat(Array.isArray(i)?i.map(l=>[t,l]):[[t,i]])},[]))}function LE(n,e){let t=rg(n);return e&&e.forEach((i,l)=>{t.has(l)||e.getAll(l).forEach(u=>{t.append(l,u)})}),t}var Zd=null;function OE(){if(Zd===null)try{new FormData(document.createElement("form"),0),Zd=!1}catch{Zd=!0}return Zd}var VE=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function jp(n){return n!=null&&!VE.has(n)?(oa(!1,`"${n}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${ph}"`),null):n}function BE(n,e){let t,i,l,u,d;if(ME(n)){let p=n.getAttribute("action");i=p?fi(p,e):null,t=n.getAttribute("method")||fh,l=jp(n.getAttribute("enctype"))||ph,u=new FormData(n)}else if(AE(n)||IE(n)&&(n.type==="submit"||n.type==="image")){let p=n.form;if(p==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let g=n.getAttribute("formaction")||p.getAttribute("action");if(i=g?fi(g,e):null,t=n.getAttribute("formmethod")||p.getAttribute("method")||fh,l=jp(n.getAttribute("formenctype"))||jp(p.getAttribute("enctype"))||ph,u=new FormData(p,n),!OE()){let{name:y,type:w,value:j}=n;if(w==="image"){let T=y?`${y}.`:"";u.append(`${T}x`,"0"),u.append(`${T}y`,"0")}else y&&u.append(y,j)}}else{if(Qh(n))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=fh,i=null,l=ph,d=n}return u&&l==="text/plain"&&(d=u,u=void 0),{action:i,method:t.toLowerCase(),encType:l,formData:u,body:d}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function Fg(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function UE(n,e,t,i){let l=typeof n=="string"?new URL(n,typeof window>"u"?"server://singlefetch/":window.location.origin):n;return t?l.pathname.endsWith("/")?l.pathname=`${l.pathname}_.${i}`:l.pathname=`${l.pathname}.${i}`:l.pathname==="/"?l.pathname=`_root.${i}`:e&&fi(l.pathname,e)==="/"?l.pathname=`${e.replace(/\/$/,"")}/_root.${i}`:l.pathname=`${l.pathname.replace(/\/$/,"")}.${i}`,l}async function FE(n,e){if(n.id in e)return e[n.id];try{let t=await import(n.module);return e[n.id]=t,t}catch(t){return console.error(`Error loading route module \`${n.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function zE(n){return n==null?!1:n.href==null?n.rel==="preload"&&typeof n.imageSrcSet=="string"&&typeof n.imageSizes=="string":typeof n.rel=="string"&&typeof n.href=="string"}async function qE(n,e,t){let i=await Promise.all(n.map(async l=>{let u=e.routes[l.route.id];if(u){let d=await FE(u,t);return d.links?d.links():[]}return[]}));return GE(i.flat(1).filter(zE).filter(l=>l.rel==="stylesheet"||l.rel==="preload").map(l=>l.rel==="stylesheet"?{...l,rel:"prefetch",as:"style"}:{...l,rel:"prefetch"}))}function O1(n,e,t,i,l,u){let d=(g,y)=>t[y]?g.route.id!==t[y].route.id:!0,p=(g,y)=>t[y].pathname!==g.pathname||t[y].route.path?.endsWith("*")&&t[y].params["*"]!==g.params["*"];return u==="assets"?e.filter((g,y)=>d(g,y)||p(g,y)):u==="data"?e.filter((g,y)=>{let w=i.routes[g.route.id];if(!w||!w.hasLoader)return!1;if(d(g,y)||p(g,y))return!0;if(g.route.shouldRevalidate){let j=g.route.shouldRevalidate({currentUrl:new URL(l.pathname+l.search+l.hash,window.origin),currentParams:t[0]?.params||{},nextUrl:new URL(n,window.origin),nextParams:g.params,defaultShouldRevalidate:!0});if(typeof j=="boolean")return j}return!0}):[]}function HE(n,e,{includeHydrateFallback:t}={}){return $E(n.map(i=>{let l=e.routes[i.route.id];if(!l)return[];let u=[l.module];return l.clientActionModule&&(u=u.concat(l.clientActionModule)),l.clientLoaderModule&&(u=u.concat(l.clientLoaderModule)),t&&l.hydrateFallbackModule&&(u=u.concat(l.hydrateFallbackModule)),l.imports&&(u=u.concat(l.imports)),u}).flat(1))}function $E(n){return[...new Set(n)]}function WE(n){let e={},t=Object.keys(n).sort();for(let i of t)e[i]=n[i];return e}function GE(n,e){let t=new Set;return new Set(e),n.reduce((i,l)=>{let u=JSON.stringify(WE(l));return t.has(u)||(t.add(u),i.push({key:u,link:l})),i},[])}function W2(){let n=v.useContext(sc);return Fg(n,"You must render this element inside a <DataRouterContext.Provider> element"),n}function KE(){let n=v.useContext(Yh);return Fg(n,"You must render this element inside a <DataRouterStateContext.Provider> element"),n}var zg=v.createContext(void 0);zg.displayName="FrameworkContext";function G2(){let n=v.useContext(zg);return Fg(n,"You must render this element inside a <HydratedRouter> element"),n}function YE(n,e){let t=v.useContext(zg),[i,l]=v.useState(!1),[u,d]=v.useState(!1),{onFocus:p,onBlur:g,onMouseEnter:y,onMouseLeave:w,onTouchStart:j}=e,T=v.useRef(null);v.useEffect(()=>{if(n==="render"&&d(!0),n==="viewport"){let F=te=>{te.forEach(K=>{d(K.isIntersecting)})},U=new IntersectionObserver(F,{threshold:.5});return T.current&&U.observe(T.current),()=>{U.disconnect()}}},[n]),v.useEffect(()=>{if(i){let F=setTimeout(()=>{d(!0)},100);return()=>{clearTimeout(F)}}},[i]);let V=()=>{l(!0)},$=()=>{l(!1),d(!1)};return t?n!=="intent"?[u,T,{}]:[u,T,{onFocus:Kc(p,V),onBlur:Kc(g,$),onMouseEnter:Kc(y,V),onMouseLeave:Kc(w,$),onTouchStart:Kc(j,V)}]:[!1,T,{}]}function Kc(n,e){return t=>{n&&n(t),t.defaultPrevented||e(t)}}function QE({page:n,...e}){let{router:t}=W2(),i=v.useMemo(()=>I2(t.routes,n,t.basename),[t.routes,n,t.basename]);return i?v.createElement(JE,{page:n,matches:i,...e}):null}function XE(n){let{manifest:e,routeModules:t}=G2(),[i,l]=v.useState([]);return v.useEffect(()=>{let u=!1;return qE(n,e,t).then(d=>{u||l(d)}),()=>{u=!0}},[n,e,t]),i}function JE({page:n,matches:e,...t}){let i=Ta(),{future:l,manifest:u,routeModules:d}=G2(),{basename:p}=W2(),{loaderData:g,matches:y}=KE(),w=v.useMemo(()=>O1(n,e,y,u,i,"data"),[n,e,y,u,i]),j=v.useMemo(()=>O1(n,e,y,u,i,"assets"),[n,e,y,u,i]),T=v.useMemo(()=>{if(n===i.pathname+i.search+i.hash)return[];let F=new Set,U=!1;if(e.forEach(K=>{let re=u.routes[K.route.id];!re||!re.hasLoader||(!w.some(ye=>ye.route.id===K.route.id)&&K.route.id in g&&d[K.route.id]?.shouldRevalidate||re.hasClientLoader?U=!0:F.add(K.route.id))}),F.size===0)return[];let te=UE(n,p,l.unstable_trailingSlashAwareDataRequests,"data");return U&&F.size>0&&te.searchParams.set("_routes",e.filter(K=>F.has(K.route.id)).map(K=>K.route.id).join(",")),[te.pathname+te.search]},[p,l.unstable_trailingSlashAwareDataRequests,g,i,u,w,e,n,d]),V=v.useMemo(()=>HE(j,u),[j,u]),$=XE(j);return v.createElement(v.Fragment,null,T.map(F=>v.createElement("link",{key:F,rel:"prefetch",as:"fetch",href:F,...t})),V.map(F=>v.createElement("link",{key:F,rel:"modulepreload",href:F,...t})),$.map(({key:F,link:U})=>v.createElement("link",{key:F,nonce:t.nonce,...U,crossOrigin:U.crossOrigin??t.crossOrigin})))}function ZE(...n){return e=>{n.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var eS=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{eS&&(window.__reactRouterVersion="7.13.0")}catch{}function tS({basename:n,children:e,unstable_useTransitions:t,window:i}){let l=v.useRef();l.current==null&&(l.current=MT({window:i,v5Compat:!0}));let u=l.current,[d,p]=v.useState({action:u.action,location:u.location}),g=v.useCallback(y=>{t===!1?p(y):v.startTransition(()=>p(y))},[t]);return v.useLayoutEffect(()=>u.listen(g),[u,g]),v.createElement(CE,{basename:n,children:e,location:d.location,navigationType:d.action,navigator:u,unstable_useTransitions:t})}var K2=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Y2=v.forwardRef(function({onClick:e,discover:t="render",prefetch:i="none",relative:l,reloadDocument:u,replace:d,state:p,target:g,to:y,preventScrollReset:w,viewTransition:j,unstable_defaultShouldRevalidate:T,...V},$){let{basename:F,unstable_useTransitions:U}=v.useContext(Qr),te=typeof y=="string"&&K2.test(y),K=O2(y,F);y=K.to;let re=hE(y,{relative:l}),[ye,ve,ge]=YE(i,V),R=aS(y,{replace:d,state:p,target:g,preventScrollReset:w,relative:l,viewTransition:j,unstable_defaultShouldRevalidate:T,unstable_useTransitions:U});function E(O){e&&e(O),O.defaultPrevented||R(O)}let A=v.createElement("a",{...V,...ge,href:K.absoluteURL||re,onClick:K.isExternal||u?e:E,ref:ZE($,ve),target:g,"data-discover":!te&&t==="render"?"true":void 0});return ye&&!te?v.createElement(v.Fragment,null,A,v.createElement(QE,{page:re})):A});Y2.displayName="Link";var sS=v.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:i="",end:l=!1,style:u,to:d,viewTransition:p,children:g,...y},w){let j=Nu(d,{relative:y.relative}),T=Ta(),V=v.useContext(Yh),{navigator:$,basename:F}=v.useContext(Qr),U=V!=null&&dS(j)&&p===!0,te=$.encodeLocation?$.encodeLocation(j).pathname:j.pathname,K=T.pathname,re=V&&V.navigation&&V.navigation.location?V.navigation.location.pathname:null;t||(K=K.toLowerCase(),re=re?re.toLowerCase():null,te=te.toLowerCase()),re&&F&&(re=fi(re,F)||re);const ye=te!=="/"&&te.endsWith("/")?te.length-1:te.length;let ve=K===te||!l&&K.startsWith(te)&&K.charAt(ye)==="/",ge=re!=null&&(re===te||!l&&re.startsWith(te)&&re.charAt(te.length)==="/"),R={isActive:ve,isPending:ge,isTransitioning:U},E=ve?e:void 0,A;typeof i=="function"?A=i(R):A=[i,ve?"active":null,ge?"pending":null,U?"transitioning":null].filter(Boolean).join(" ");let O=typeof u=="function"?u(R):u;return v.createElement(Y2,{...y,"aria-current":E,className:A,ref:w,style:O,to:d,viewTransition:p},typeof g=="function"?g(R):g)});sS.displayName="NavLink";var nS=v.forwardRef(({discover:n="render",fetcherKey:e,navigate:t,reloadDocument:i,replace:l,state:u,method:d=fh,action:p,onSubmit:g,relative:y,preventScrollReset:w,viewTransition:j,unstable_defaultShouldRevalidate:T,...V},$)=>{let{unstable_useTransitions:F}=v.useContext(Qr),U=cS(),te=uS(p,{relative:y}),K=d.toLowerCase()==="get"?"get":"post",re=typeof p=="string"&&K2.test(p),ye=ve=>{if(g&&g(ve),ve.defaultPrevented)return;ve.preventDefault();let ge=ve.nativeEvent.submitter,R=ge?.getAttribute("formmethod")||d,E=()=>U(ge||ve.currentTarget,{fetcherKey:e,method:R,navigate:t,replace:l,state:u,relative:y,preventScrollReset:w,viewTransition:j,unstable_defaultShouldRevalidate:T});F&&t!==!1?v.startTransition(()=>E()):E()};return v.createElement("form",{ref:$,method:K,action:te,onSubmit:i?g:ye,...V,"data-discover":!re&&n==="render"?"true":void 0})});nS.displayName="Form";function rS(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Q2(n){let e=v.useContext(sc);return hn(e,rS(n)),e}function aS(n,{target:e,replace:t,state:i,preventScrollReset:l,relative:u,viewTransition:d,unstable_defaultShouldRevalidate:p,unstable_useTransitions:g}={}){let y=Gn(),w=Ta(),j=Nu(n,{relative:u});return v.useCallback(T=>{if(PE(T,e)){T.preventDefault();let V=t!==void 0?t:fu(w)===fu(j),$=()=>y(n,{replace:V,state:i,preventScrollReset:l,relative:u,viewTransition:d,unstable_defaultShouldRevalidate:p});g?v.startTransition(()=>$()):$()}},[w,y,j,t,i,e,n,l,u,d,p,g])}function iS(n){oa(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let e=v.useRef(rg(n)),t=v.useRef(!1),i=Ta(),l=v.useMemo(()=>LE(i.search,t.current?null:e.current),[i.search]),u=Gn(),d=v.useCallback((p,g)=>{const y=rg(typeof p=="function"?p(new URLSearchParams(l)):p);t.current=!0,u("?"+y,g)},[u,l]);return[l,d]}var oS=0,lS=()=>`__${String(++oS)}__`;function cS(){let{router:n}=Q2("useSubmit"),{basename:e}=v.useContext(Qr),t=jE(),i=n.fetch,l=n.navigate;return v.useCallback(async(u,d={})=>{let{action:p,method:g,encType:y,formData:w,body:j}=BE(u,e);if(d.navigate===!1){let T=d.fetcherKey||lS();await i(T,t,d.action||p,{unstable_defaultShouldRevalidate:d.unstable_defaultShouldRevalidate,preventScrollReset:d.preventScrollReset,formData:w,body:j,formMethod:d.method||g,formEncType:d.encType||y,flushSync:d.flushSync})}else await l(d.action||p,{unstable_defaultShouldRevalidate:d.unstable_defaultShouldRevalidate,preventScrollReset:d.preventScrollReset,formData:w,body:j,formMethod:d.method||g,formEncType:d.encType||y,replace:d.replace,state:d.state,fromRouteId:t,flushSync:d.flushSync,viewTransition:d.viewTransition})},[i,l,e,t])}function uS(n,{relative:e}={}){let{basename:t}=v.useContext(Qr),i=v.useContext(ja);hn(i,"useFormAction must be used inside a RouteContext");let[l]=i.matches.slice(-1),u={...Nu(n||".",{relative:e})},d=Ta();if(n==null){u.search=d.search;let p=new URLSearchParams(u.search),g=p.getAll("index");if(g.some(w=>w==="")){p.delete("index"),g.filter(j=>j).forEach(j=>p.append("index",j));let w=p.toString();u.search=w?`?${w}`:""}}return(!n||n===".")&&l.route.index&&(u.search=u.search?u.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(u.pathname=u.pathname==="/"?t:ui([t,u.pathname])),fu(u)}function dS(n,{relative:e}={}){let t=v.useContext(B2);hn(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:i}=Q2("useViewTransitionState"),l=Nu(n,{relative:e});if(!t.isTransitioning)return!1;let u=fi(t.currentLocation.pathname,i)||t.currentLocation.pathname,d=fi(t.nextLocation.pathname,i)||t.nextLocation.pathname;return Eh(l.pathname,d)!=null||Eh(l.pathname,u)!=null}const hS=()=>{};var V1={};const X2=function(n){const e=[];let t=0;for(let i=0;i<n.length;i++){let l=n.charCodeAt(i);l<128?e[t++]=l:l<2048?(e[t++]=l>>6|192,e[t++]=l&63|128):(l&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(l=65536+((l&1023)<<10)+(n.charCodeAt(++i)&1023),e[t++]=l>>18|240,e[t++]=l>>12&63|128,e[t++]=l>>6&63|128,e[t++]=l&63|128):(e[t++]=l>>12|224,e[t++]=l>>6&63|128,e[t++]=l&63|128)}return e},mS=function(n){const e=[];let t=0,i=0;for(;t<n.length;){const l=n[t++];if(l<128)e[i++]=String.fromCharCode(l);else if(l>191&&l<224){const u=n[t++];e[i++]=String.fromCharCode((l&31)<<6|u&63)}else if(l>239&&l<365){const u=n[t++],d=n[t++],p=n[t++],g=((l&7)<<18|(u&63)<<12|(d&63)<<6|p&63)-65536;e[i++]=String.fromCharCode(55296+(g>>10)),e[i++]=String.fromCharCode(56320+(g&1023))}else{const u=n[t++],d=n[t++];e[i++]=String.fromCharCode((l&15)<<12|(u&63)<<6|d&63)}}return e.join("")},J2={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let l=0;l<n.length;l+=3){const u=n[l],d=l+1<n.length,p=d?n[l+1]:0,g=l+2<n.length,y=g?n[l+2]:0,w=u>>2,j=(u&3)<<4|p>>4;let T=(p&15)<<2|y>>6,V=y&63;g||(V=64,d||(T=64)),i.push(t[w],t[j],t[T],t[V])}return i.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(X2(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):mS(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let l=0;l<n.length;){const u=t[n.charAt(l++)],p=l<n.length?t[n.charAt(l)]:0;++l;const y=l<n.length?t[n.charAt(l)]:64;++l;const j=l<n.length?t[n.charAt(l)]:64;if(++l,u==null||p==null||y==null||j==null)throw new fS;const T=u<<2|p>>4;if(i.push(T),y!==64){const V=p<<4&240|y>>2;if(i.push(V),j!==64){const $=y<<6&192|j;i.push($)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class fS extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const pS=function(n){const e=X2(n);return J2.encodeByteArray(e,!0)},Sh=function(n){return pS(n).replace(/\./g,"")},Z2=function(n){try{return J2.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function gS(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const yS=()=>gS().__FIREBASE_DEFAULTS__,bS=()=>{if(typeof process>"u"||typeof V1>"u")return;const n=V1.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},vS=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&Z2(n[1]);return e&&JSON.parse(e)},Xh=()=>{try{return hS()||yS()||bS()||vS()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},ew=n=>Xh()?.emulatorHosts?.[n],tw=n=>{const e=ew(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),i]:[e.substring(0,t),i]},sw=()=>Xh()?.config,nw=n=>Xh()?.[`_${n}`];class xS{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}}function fo(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function qg(n){return(await fetch(n,{credentials:"include"})).ok}function rw(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},i=e||"demo-project",l=n.iat||0,u=n.sub||n.user_id;if(!u)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const d={iss:`https://securetoken.google.com/${i}`,aud:i,iat:l,exp:l+3600,auth_time:l,sub:u,user_id:u,firebase:{sign_in_provider:"custom",identities:{}},...n};return[Sh(JSON.stringify(t)),Sh(JSON.stringify(d)),""].join(".")}const iu={};function wS(){const n={prod:[],emulator:[]};for(const e of Object.keys(iu))iu[e]?n.emulator.push(e):n.prod.push(e);return n}function _S(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let B1=!1;function Hg(n,e){if(typeof window>"u"||typeof document>"u"||!fo(window.location.host)||iu[n]===e||iu[n]||B1)return;iu[n]=e;function t(T){return`__firebase__banner__${T}`}const i="__firebase__banner",u=wS().prod.length>0;function d(){const T=document.getElementById(i);T&&T.remove()}function p(T){T.style.display="flex",T.style.background="#7faaf0",T.style.position="fixed",T.style.bottom="5px",T.style.left="5px",T.style.padding=".5em",T.style.borderRadius="5px",T.style.alignItems="center"}function g(T,V){T.setAttribute("width","24"),T.setAttribute("id",V),T.setAttribute("height","24"),T.setAttribute("viewBox","0 0 24 24"),T.setAttribute("fill","none"),T.style.marginLeft="-6px"}function y(){const T=document.createElement("span");return T.style.cursor="pointer",T.style.marginLeft="16px",T.style.fontSize="24px",T.innerHTML=" &times;",T.onclick=()=>{B1=!0,d()},T}function w(T,V){T.setAttribute("id",V),T.innerText="Learn more",T.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",T.setAttribute("target","__blank"),T.style.paddingLeft="5px",T.style.textDecoration="underline"}function j(){const T=_S(i),V=t("text"),$=document.getElementById(V)||document.createElement("span"),F=t("learnmore"),U=document.getElementById(F)||document.createElement("a"),te=t("preprendIcon"),K=document.getElementById(te)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(T.created){const re=T.element;p(re),w(U,F);const ye=y();g(K,te),re.append(K,$,U,ye),document.body.appendChild(re)}u?($.innerText="Preview backend disconnected.",K.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(K.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,$.innerText="Preview backend running in this workspace."),$.setAttribute("id",V)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",j):j()}function hr(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function kS(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(hr())}function jS(){const n=Xh()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function TS(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function ES(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function SS(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function NS(){const n=hr();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function CS(){return!jS()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function RS(){try{return typeof indexedDB=="object"}catch{return!1}}function AS(){return new Promise((n,e)=>{try{let t=!0;const i="validate-browser-context-for-indexeddb-analytics-module",l=self.indexedDB.open(i);l.onsuccess=()=>{l.result.close(),t||self.indexedDB.deleteDatabase(i),n(!0)},l.onupgradeneeded=()=>{t=!1},l.onerror=()=>{e(l.error?.message||"")}}catch(t){e(t)}})}const MS="FirebaseError";class Ha extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=MS,Object.setPrototypeOf(this,Ha.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Cu.prototype.create)}}class Cu{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){const i=t[0]||{},l=`${this.service}/${e}`,u=this.errors[e],d=u?IS(u,i):"Error",p=`${this.serviceName}: ${d} (${l}).`;return new Ha(l,p,i)}}function IS(n,e){return n.replace(DS,(t,i)=>{const l=e[i];return l!=null?String(l):`<${i}?>`})}const DS=/\{\$([^}]+)}/g;function PS(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Ho(n,e){if(n===e)return!0;const t=Object.keys(n),i=Object.keys(e);for(const l of t){if(!i.includes(l))return!1;const u=n[l],d=e[l];if(U1(u)&&U1(d)){if(!Ho(u,d))return!1}else if(u!==d)return!1}for(const l of i)if(!t.includes(l))return!1;return!0}function U1(n){return n!==null&&typeof n=="object"}function Ru(n){const e=[];for(const[t,i]of Object.entries(n))Array.isArray(i)?i.forEach(l=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(l))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function eu(n){const e={};return n.replace(/^\?/,"").split("&").forEach(i=>{if(i){const[l,u]=i.split("=");e[decodeURIComponent(l)]=decodeURIComponent(u)}}),e}function tu(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function LS(n,e){const t=new OS(n,e);return t.subscribe.bind(t)}class OS{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,i){let l;if(e===void 0&&t===void 0&&i===void 0)throw new Error("Missing Observer.");VS(e,["next","error","complete"])?l=e:l={next:e,error:t,complete:i},l.next===void 0&&(l.next=Tp),l.error===void 0&&(l.error=Tp),l.complete===void 0&&(l.complete=Tp);const u=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?l.error(this.finalError):l.complete()}catch{}}),this.observers.push(l),u}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function VS(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Tp(){}function Qs(n){return n&&n._delegate?n._delegate:n}class io{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const Oo="[DEFAULT]";class BS{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const i=new xS;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{const l=this.getOrInitializeService({instanceIdentifier:t});l&&i.resolve(l)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),i=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(l){if(i)return null;throw l}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(FS(e))try{this.getOrInitializeService({instanceIdentifier:Oo})}catch{}for(const[t,i]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(t);try{const u=this.getOrInitializeService({instanceIdentifier:l});i.resolve(u)}catch{}}}}clearInstance(e=Oo){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Oo){return this.instances.has(e)}getOptions(e=Oo){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const l=this.getOrInitializeService({instanceIdentifier:i,options:t});for(const[u,d]of this.instancesDeferred.entries()){const p=this.normalizeInstanceIdentifier(u);i===p&&d.resolve(l)}return l}onInit(e,t){const i=this.normalizeInstanceIdentifier(t),l=this.onInitCallbacks.get(i)??new Set;l.add(e),this.onInitCallbacks.set(i,l);const u=this.instances.get(i);return u&&e(u,i),()=>{l.delete(e)}}invokeOnInitCallbacks(e,t){const i=this.onInitCallbacks.get(t);if(i)for(const l of i)try{l(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:US(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=Oo){return this.component?this.component.multipleInstances?e:Oo:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function US(n){return n===Oo?void 0:n}function FS(n){return n.instantiationMode==="EAGER"}class zS{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new BS(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}var bs;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(bs||(bs={}));const qS={debug:bs.DEBUG,verbose:bs.VERBOSE,info:bs.INFO,warn:bs.WARN,error:bs.ERROR,silent:bs.SILENT},HS=bs.INFO,$S={[bs.DEBUG]:"log",[bs.VERBOSE]:"log",[bs.INFO]:"info",[bs.WARN]:"warn",[bs.ERROR]:"error"},WS=(n,e,...t)=>{if(e<n.logLevel)return;const i=new Date().toISOString(),l=$S[e];if(l)console[l](`[${i}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class $g{constructor(e){this.name=e,this._logLevel=HS,this._logHandler=WS,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in bs))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?qS[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,bs.DEBUG,...e),this._logHandler(this,bs.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,bs.VERBOSE,...e),this._logHandler(this,bs.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,bs.INFO,...e),this._logHandler(this,bs.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,bs.WARN,...e),this._logHandler(this,bs.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,bs.ERROR,...e),this._logHandler(this,bs.ERROR,...e)}}const GS=(n,e)=>e.some(t=>n instanceof t);let F1,z1;function KS(){return F1||(F1=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function YS(){return z1||(z1=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const aw=new WeakMap,ag=new WeakMap,iw=new WeakMap,Ep=new WeakMap,Wg=new WeakMap;function QS(n){const e=new Promise((t,i)=>{const l=()=>{n.removeEventListener("success",u),n.removeEventListener("error",d)},u=()=>{t(so(n.result)),l()},d=()=>{i(n.error),l()};n.addEventListener("success",u),n.addEventListener("error",d)});return e.then(t=>{t instanceof IDBCursor&&aw.set(t,n)}).catch(()=>{}),Wg.set(e,n),e}function XS(n){if(ag.has(n))return;const e=new Promise((t,i)=>{const l=()=>{n.removeEventListener("complete",u),n.removeEventListener("error",d),n.removeEventListener("abort",d)},u=()=>{t(),l()},d=()=>{i(n.error||new DOMException("AbortError","AbortError")),l()};n.addEventListener("complete",u),n.addEventListener("error",d),n.addEventListener("abort",d)});ag.set(n,e)}let ig={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return ag.get(n);if(e==="objectStoreNames")return n.objectStoreNames||iw.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return so(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function JS(n){ig=n(ig)}function ZS(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const i=n.call(Sp(this),e,...t);return iw.set(i,e.sort?e.sort():[e]),so(i)}:YS().includes(n)?function(...e){return n.apply(Sp(this),e),so(aw.get(this))}:function(...e){return so(n.apply(Sp(this),e))}}function eN(n){return typeof n=="function"?ZS(n):(n instanceof IDBTransaction&&XS(n),GS(n,KS())?new Proxy(n,ig):n)}function so(n){if(n instanceof IDBRequest)return QS(n);if(Ep.has(n))return Ep.get(n);const e=eN(n);return e!==n&&(Ep.set(n,e),Wg.set(e,n)),e}const Sp=n=>Wg.get(n);function tN(n,e,{blocked:t,upgrade:i,blocking:l,terminated:u}={}){const d=indexedDB.open(n,e),p=so(d);return i&&d.addEventListener("upgradeneeded",g=>{i(so(d.result),g.oldVersion,g.newVersion,so(d.transaction),g)}),t&&d.addEventListener("blocked",g=>t(g.oldVersion,g.newVersion,g)),p.then(g=>{u&&g.addEventListener("close",()=>u()),l&&g.addEventListener("versionchange",y=>l(y.oldVersion,y.newVersion,y))}).catch(()=>{}),p}const sN=["get","getKey","getAll","getAllKeys","count"],nN=["put","add","delete","clear"],Np=new Map;function q1(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Np.get(e))return Np.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,l=nN.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(l||sN.includes(t)))return;const u=async function(d,...p){const g=this.transaction(d,l?"readwrite":"readonly");let y=g.store;return i&&(y=y.index(p.shift())),(await Promise.all([y[t](...p),l&&g.done]))[0]};return Np.set(e,u),u}JS(n=>({...n,get:(e,t,i)=>q1(e,t)||n.get(e,t,i),has:(e,t)=>!!q1(e,t)||n.has(e,t)}));class rN{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(aN(t)){const i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}}function aN(n){return n.getComponent()?.type==="VERSION"}const og="@firebase/app",H1="0.14.7";const pi=new $g("@firebase/app"),iN="@firebase/app-compat",oN="@firebase/analytics-compat",lN="@firebase/analytics",cN="@firebase/app-check-compat",uN="@firebase/app-check",dN="@firebase/auth",hN="@firebase/auth-compat",mN="@firebase/database",fN="@firebase/data-connect",pN="@firebase/database-compat",gN="@firebase/functions",yN="@firebase/functions-compat",bN="@firebase/installations",vN="@firebase/installations-compat",xN="@firebase/messaging",wN="@firebase/messaging-compat",_N="@firebase/performance",kN="@firebase/performance-compat",jN="@firebase/remote-config",TN="@firebase/remote-config-compat",EN="@firebase/storage",SN="@firebase/storage-compat",NN="@firebase/firestore",CN="@firebase/ai",RN="@firebase/firestore-compat",AN="firebase",MN="12.8.0";const lg="[DEFAULT]",IN={[og]:"fire-core",[iN]:"fire-core-compat",[lN]:"fire-analytics",[oN]:"fire-analytics-compat",[uN]:"fire-app-check",[cN]:"fire-app-check-compat",[dN]:"fire-auth",[hN]:"fire-auth-compat",[mN]:"fire-rtdb",[fN]:"fire-data-connect",[pN]:"fire-rtdb-compat",[gN]:"fire-fn",[yN]:"fire-fn-compat",[bN]:"fire-iid",[vN]:"fire-iid-compat",[xN]:"fire-fcm",[wN]:"fire-fcm-compat",[_N]:"fire-perf",[kN]:"fire-perf-compat",[jN]:"fire-rc",[TN]:"fire-rc-compat",[EN]:"fire-gcs",[SN]:"fire-gcs-compat",[NN]:"fire-fst",[RN]:"fire-fst-compat",[CN]:"fire-vertex","fire-js":"fire-js",[AN]:"fire-js-all"};const Nh=new Map,DN=new Map,cg=new Map;function $1(n,e){try{n.container.addComponent(e)}catch(t){pi.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function $o(n){const e=n.name;if(cg.has(e))return pi.debug(`There were multiple attempts to register component ${e}.`),!1;cg.set(e,n);for(const t of Nh.values())$1(t,n);for(const t of DN.values())$1(t,n);return!0}function Jh(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Gr(n){return n==null?!1:n.settings!==void 0}const PN={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},no=new Cu("app","Firebase",PN);class LN{constructor(e,t,i){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new io("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw no.create("app-deleted",{appName:this._name})}}const Jo=MN;function Gg(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const i={name:lg,automaticDataCollectionEnabled:!0,...e},l=i.name;if(typeof l!="string"||!l)throw no.create("bad-app-name",{appName:String(l)});if(t||(t=sw()),!t)throw no.create("no-options");const u=Nh.get(l);if(u){if(Ho(t,u.options)&&Ho(i,u.config))return u;throw no.create("duplicate-app",{appName:l})}const d=new zS(l);for(const g of cg.values())d.addComponent(g);const p=new LN(t,i,d);return Nh.set(l,p),p}function Kg(n=lg){const e=Nh.get(n);if(!e&&n===lg&&sw())return Gg();if(!e)throw no.create("no-app",{appName:n});return e}function La(n,e,t){let i=IN[n]??n;t&&(i+=`-${t}`);const l=i.match(/\s|\//),u=e.match(/\s|\//);if(l||u){const d=[`Unable to register library "${i}" with version "${e}":`];l&&d.push(`library name "${i}" contains illegal characters (whitespace or "/")`),l&&u&&d.push("and"),u&&d.push(`version name "${e}" contains illegal characters (whitespace or "/")`),pi.warn(d.join(" "));return}$o(new io(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}const ON="firebase-heartbeat-database",VN=1,pu="firebase-heartbeat-store";let Cp=null;function ow(){return Cp||(Cp=tN(ON,VN,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(pu)}catch(t){console.warn(t)}}}}).catch(n=>{throw no.create("idb-open",{originalErrorMessage:n.message})})),Cp}async function BN(n){try{const t=(await ow()).transaction(pu),i=await t.objectStore(pu).get(lw(n));return await t.done,i}catch(e){if(e instanceof Ha)pi.warn(e.message);else{const t=no.create("idb-get",{originalErrorMessage:e?.message});pi.warn(t.message)}}}async function W1(n,e){try{const i=(await ow()).transaction(pu,"readwrite");await i.objectStore(pu).put(e,lw(n)),await i.done}catch(t){if(t instanceof Ha)pi.warn(t.message);else{const i=no.create("idb-set",{originalErrorMessage:t?.message});pi.warn(i.message)}}}function lw(n){return`${n.name}!${n.options.appId}`}const UN=1024,FN=30;class zN{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new HN(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=G1();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(l=>l.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:t}),this._heartbeatsCache.heartbeats.length>FN){const l=$N(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(l,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){pi.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=G1(),{heartbeatsToSend:t,unsentEntries:i}=qN(this._heartbeatsCache.heartbeats),l=Sh(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),l}catch(e){return pi.warn(e),""}}}function G1(){return new Date().toISOString().substring(0,10)}function qN(n,e=UN){const t=[];let i=n.slice();for(const l of n){const u=t.find(d=>d.agent===l.agent);if(u){if(u.dates.push(l.date),K1(t)>e){u.dates.pop();break}}else if(t.push({agent:l.agent,dates:[l.date]}),K1(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}class HN{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return RS()?AS().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await BN(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return W1(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return W1(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function K1(n){return Sh(JSON.stringify({version:2,heartbeats:n})).length}function $N(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let i=1;i<n.length;i++)n[i].date<t&&(t=n[i].date,e=i);return e}function WN(n){$o(new io("platform-logger",e=>new rN(e),"PRIVATE")),$o(new io("heartbeat",e=>new zN(e),"PRIVATE")),La(og,H1,n),La(og,H1,"esm2020"),La("fire-js","")}WN("");function cw(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const GN=cw,uw=new Cu("auth","Firebase",cw());const Ch=new $g("@firebase/auth");function KN(n,...e){Ch.logLevel<=bs.WARN&&Ch.warn(`Auth (${Jo}): ${n}`,...e)}function gh(n,...e){Ch.logLevel<=bs.ERROR&&Ch.error(`Auth (${Jo}): ${n}`,...e)}function wa(n,...e){throw Yg(n,...e)}function Oa(n,...e){return Yg(n,...e)}function dw(n,e,t){const i={...GN(),[e]:t};return new Cu("auth","Firebase",i).create(e,{appName:n.name})}function di(n){return dw(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Yg(n,...e){if(typeof n!="string"){const t=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=n.name),n._errorFactory.create(t,...i)}return uw.create(n,...e)}function Lt(n,e,...t){if(!n)throw Yg(e,...t)}function li(n){const e="INTERNAL ASSERTION FAILED: "+n;throw gh(e),new Error(e)}function gi(n,e){n||li(e)}function ug(){return typeof self<"u"&&self.location?.href||""}function YN(){return Y1()==="http:"||Y1()==="https:"}function Y1(){return typeof self<"u"&&self.location?.protocol||null}function QN(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(YN()||ES()||"connection"in navigator)?navigator.onLine:!0}function XN(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}class Au{constructor(e,t){this.shortDelay=e,this.longDelay=t,gi(t>e,"Short delay should be less than long delay!"),this.isMobile=kS()||SS()}get(){return QN()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function Qg(n,e){gi(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class hw{static initialize(e,t,i){this.fetchImpl=e,t&&(this.headersImpl=t),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;li("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;li("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;li("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const JN={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const ZN=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],eC=new Au(3e4,6e4);function vi(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function xi(n,e,t,i,l={}){return mw(n,l,async()=>{let u={},d={};i&&(e==="GET"?d=i:u={body:JSON.stringify(i)});const p=Ru({key:n.config.apiKey,...d}).slice(1),g=await n._getAdditionalHeaders();g["Content-Type"]="application/json",n.languageCode&&(g["X-Firebase-Locale"]=n.languageCode);const y={method:e,headers:g,...u};return TS()||(y.referrerPolicy="no-referrer"),n.emulatorConfig&&fo(n.emulatorConfig.host)&&(y.credentials="include"),hw.fetch()(await fw(n,n.config.apiHost,t,p),y)})}async function mw(n,e,t){n._canInitEmulator=!1;const i={...JN,...e};try{const l=new sC(n),u=await Promise.race([t(),l.promise]);l.clearNetworkTimeout();const d=await u.json();if("needConfirmation"in d)throw eh(n,"account-exists-with-different-credential",d);if(u.ok&&!("errorMessage"in d))return d;{const p=u.ok?d.errorMessage:d.error.message,[g,y]=p.split(" : ");if(g==="FEDERATED_USER_ID_ALREADY_LINKED")throw eh(n,"credential-already-in-use",d);if(g==="EMAIL_EXISTS")throw eh(n,"email-already-in-use",d);if(g==="USER_DISABLED")throw eh(n,"user-disabled",d);const w=i[g]||g.toLowerCase().replace(/[_\s]+/g,"-");if(y)throw dw(n,w,y);wa(n,w)}}catch(l){if(l instanceof Ha)throw l;wa(n,"network-request-failed",{message:String(l)})}}async function Mu(n,e,t,i,l={}){const u=await xi(n,e,t,i,l);return"mfaPendingCredential"in u&&wa(n,"multi-factor-auth-required",{_serverResponse:u}),u}async function fw(n,e,t,i){const l=`${e}${t}?${i}`,u=n,d=u.config.emulator?Qg(n.config,l):`${n.config.apiScheme}://${l}`;return ZN.includes(t)&&(await u._persistenceManagerAvailable,u._getPersistenceType()==="COOKIE")?u._getPersistence()._getFinalTarget(d).toString():d}function tC(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class sC{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,i)=>{this.timer=setTimeout(()=>i(Oa(this.auth,"network-request-failed")),eC.get())})}}function eh(n,e,t){const i={appName:n.name};t.email&&(i.email=t.email),t.phoneNumber&&(i.phoneNumber=t.phoneNumber);const l=Oa(n,e,i);return l.customData._tokenResponse=t,l}function Q1(n){return n!==void 0&&n.enterprise!==void 0}class nC{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return tC(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function rC(n,e){return xi(n,"GET","/v2/recaptchaConfig",vi(n,e))}async function aC(n,e){return xi(n,"POST","/v1/accounts:delete",e)}async function Rh(n,e){return xi(n,"POST","/v1/accounts:lookup",e)}function ou(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function iC(n,e=!1){const t=Qs(n),i=await t.getIdToken(e),l=Xg(i);Lt(l&&l.exp&&l.auth_time&&l.iat,t.auth,"internal-error");const u=typeof l.firebase=="object"?l.firebase:void 0,d=u?.sign_in_provider;return{claims:l,token:i,authTime:ou(Rp(l.auth_time)),issuedAtTime:ou(Rp(l.iat)),expirationTime:ou(Rp(l.exp)),signInProvider:d||null,signInSecondFactor:u?.sign_in_second_factor||null}}function Rp(n){return Number(n)*1e3}function Xg(n){const[e,t,i]=n.split(".");if(e===void 0||t===void 0||i===void 0)return gh("JWT malformed, contained fewer than 3 sections"),null;try{const l=Z2(t);return l?JSON.parse(l):(gh("Failed to decode base64 JWT payload"),null)}catch(l){return gh("Caught error parsing JWT payload as JSON",l?.toString()),null}}function X1(n){const e=Xg(n);return Lt(e,"internal-error"),Lt(typeof e.exp<"u","internal-error"),Lt(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function gu(n,e,t=!1){if(t)return e;try{return await e}catch(i){throw i instanceof Ha&&oC(i)&&n.auth.currentUser===n&&await n.auth.signOut(),i}}function oC({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}class lC{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const i=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class dg{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=ou(this.lastLoginAt),this.creationTime=ou(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Ah(n){const e=n.auth,t=await n.getIdToken(),i=await gu(n,Rh(e,{idToken:t}));Lt(i?.users.length,e,"internal-error");const l=i.users[0];n._notifyReloadListener(l);const u=l.providerUserInfo?.length?pw(l.providerUserInfo):[],d=uC(n.providerData,u),p=n.isAnonymous,g=!(n.email&&l.passwordHash)&&!d?.length,y=p?g:!1,w={uid:l.localId,displayName:l.displayName||null,photoURL:l.photoUrl||null,email:l.email||null,emailVerified:l.emailVerified||!1,phoneNumber:l.phoneNumber||null,tenantId:l.tenantId||null,providerData:d,metadata:new dg(l.createdAt,l.lastLoginAt),isAnonymous:y};Object.assign(n,w)}async function cC(n){const e=Qs(n);await Ah(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function uC(n,e){return[...n.filter(i=>!e.some(l=>l.providerId===i.providerId)),...e]}function pw(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}async function dC(n,e){const t=await mw(n,{},async()=>{const i=Ru({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:l,apiKey:u}=n.config,d=await fw(n,l,"/v1/token",`key=${u}`),p=await n._getAdditionalHeaders();p["Content-Type"]="application/x-www-form-urlencoded";const g={method:"POST",headers:p,body:i};return n.emulatorConfig&&fo(n.emulatorConfig.host)&&(g.credentials="include"),hw.fetch()(d,g)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function hC(n,e){return xi(n,"POST","/v2/accounts:revokeToken",vi(n,e))}class Hl{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Lt(e.idToken,"internal-error"),Lt(typeof e.idToken<"u","internal-error"),Lt(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):X1(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Lt(e.length!==0,"internal-error");const t=X1(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Lt(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:i,refreshToken:l,expiresIn:u}=await dC(e,t);this.updateTokensAndExpiration(i,l,Number(u))}updateTokensAndExpiration(e,t,i){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,t){const{refreshToken:i,accessToken:l,expirationTime:u}=t,d=new Hl;return i&&(Lt(typeof i=="string","internal-error",{appName:e}),d.refreshToken=i),l&&(Lt(typeof l=="string","internal-error",{appName:e}),d.accessToken=l),u&&(Lt(typeof u=="number","internal-error",{appName:e}),d.expirationTime=u),d}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Hl,this.toJSON())}_performRefresh(){return li("not implemented")}}function $i(n,e){Lt(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class va{constructor({uid:e,auth:t,stsTokenManager:i,...l}){this.providerId="firebase",this.proactiveRefresh=new lC(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=l.displayName||null,this.email=l.email||null,this.emailVerified=l.emailVerified||!1,this.phoneNumber=l.phoneNumber||null,this.photoURL=l.photoURL||null,this.isAnonymous=l.isAnonymous||!1,this.tenantId=l.tenantId||null,this.providerData=l.providerData?[...l.providerData]:[],this.metadata=new dg(l.createdAt||void 0,l.lastLoginAt||void 0)}async getIdToken(e){const t=await gu(this,this.stsTokenManager.getToken(this.auth,e));return Lt(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return iC(this,e)}reload(){return cC(this)}_assign(e){this!==e&&(Lt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new va({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){Lt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),t&&await Ah(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Gr(this.auth.app))return Promise.reject(di(this.auth));const e=await this.getIdToken();return await gu(this,aC(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const i=t.displayName??void 0,l=t.email??void 0,u=t.phoneNumber??void 0,d=t.photoURL??void 0,p=t.tenantId??void 0,g=t._redirectEventId??void 0,y=t.createdAt??void 0,w=t.lastLoginAt??void 0,{uid:j,emailVerified:T,isAnonymous:V,providerData:$,stsTokenManager:F}=t;Lt(j&&F,e,"internal-error");const U=Hl.fromJSON(this.name,F);Lt(typeof j=="string",e,"internal-error"),$i(i,e.name),$i(l,e.name),Lt(typeof T=="boolean",e,"internal-error"),Lt(typeof V=="boolean",e,"internal-error"),$i(u,e.name),$i(d,e.name),$i(p,e.name),$i(g,e.name),$i(y,e.name),$i(w,e.name);const te=new va({uid:j,auth:e,email:l,emailVerified:T,displayName:i,isAnonymous:V,photoURL:d,phoneNumber:u,tenantId:p,stsTokenManager:U,createdAt:y,lastLoginAt:w});return $&&Array.isArray($)&&(te.providerData=$.map(K=>({...K}))),g&&(te._redirectEventId=g),te}static async _fromIdTokenResponse(e,t,i=!1){const l=new Hl;l.updateFromServerResponse(t);const u=new va({uid:t.localId,auth:e,stsTokenManager:l,isAnonymous:i});return await Ah(u),u}static async _fromGetAccountInfoResponse(e,t,i){const l=t.users[0];Lt(l.localId!==void 0,"internal-error");const u=l.providerUserInfo!==void 0?pw(l.providerUserInfo):[],d=!(l.email&&l.passwordHash)&&!u?.length,p=new Hl;p.updateFromIdToken(i);const g=new va({uid:l.localId,auth:e,stsTokenManager:p,isAnonymous:d}),y={uid:l.localId,displayName:l.displayName||null,photoURL:l.photoUrl||null,email:l.email||null,emailVerified:l.emailVerified||!1,phoneNumber:l.phoneNumber||null,tenantId:l.tenantId||null,providerData:u,metadata:new dg(l.createdAt,l.lastLoginAt),isAnonymous:!(l.email&&l.passwordHash)&&!u?.length};return Object.assign(g,y),g}}const J1=new Map;function ci(n){gi(n instanceof Function,"Expected a class definition");let e=J1.get(n);return e?(gi(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,J1.set(n,e),e)}class gw{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}gw.type="NONE";const Z1=gw;function yh(n,e,t){return`firebase:${n}:${e}:${t}`}class $l{constructor(e,t,i){this.persistence=e,this.auth=t,this.userKey=i;const{config:l,name:u}=this.auth;this.fullUserKey=yh(this.userKey,l.apiKey,u),this.fullPersistenceKey=yh("persistence",l.apiKey,u),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await Rh(this.auth,{idToken:e}).catch(()=>{});return t?va._fromGetAccountInfoResponse(this.auth,t,e):null}return va._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,i="authUser"){if(!t.length)return new $l(ci(Z1),e,i);const l=(await Promise.all(t.map(async y=>{if(await y._isAvailable())return y}))).filter(y=>y);let u=l[0]||ci(Z1);const d=yh(i,e.config.apiKey,e.name);let p=null;for(const y of t)try{const w=await y._get(d);if(w){let j;if(typeof w=="string"){const T=await Rh(e,{idToken:w}).catch(()=>{});if(!T)break;j=await va._fromGetAccountInfoResponse(e,T,w)}else j=va._fromJSON(e,w);y!==u&&(p=j),u=y;break}}catch{}const g=l.filter(y=>y._shouldAllowMigration);return!u._shouldAllowMigration||!g.length?new $l(u,e,i):(u=g[0],p&&await u._set(d,p.toJSON()),await Promise.all(t.map(async y=>{if(y!==u)try{await y._remove(d)}catch{}})),new $l(u,e,i))}}function ex(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(xw(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(yw(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(_w(e))return"Blackberry";if(kw(e))return"Webos";if(bw(e))return"Safari";if((e.includes("chrome/")||vw(e))&&!e.includes("edge/"))return"Chrome";if(ww(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=n.match(t);if(i?.length===2)return i[1]}return"Other"}function yw(n=hr()){return/firefox\//i.test(n)}function bw(n=hr()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function vw(n=hr()){return/crios\//i.test(n)}function xw(n=hr()){return/iemobile/i.test(n)}function ww(n=hr()){return/android/i.test(n)}function _w(n=hr()){return/blackberry/i.test(n)}function kw(n=hr()){return/webos/i.test(n)}function Jg(n=hr()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function mC(n=hr()){return Jg(n)&&!!window.navigator?.standalone}function fC(){return NS()&&document.documentMode===10}function jw(n=hr()){return Jg(n)||ww(n)||kw(n)||_w(n)||/windows phone/i.test(n)||xw(n)}function Tw(n,e=[]){let t;switch(n){case"Browser":t=ex(hr());break;case"Worker":t=`${ex(hr())}-${n}`;break;default:t=n}const i=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Jo}/${i}`}class pC{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const i=u=>new Promise((d,p)=>{try{const g=e(u);d(g)}catch(g){p(g)}});i.onAbort=t,this.queue.push(i);const l=this.queue.length-1;return()=>{this.queue[l]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const i of this.queue)await i(e),i.onAbort&&t.push(i.onAbort)}catch(i){t.reverse();for(const l of t)try{l()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i?.message})}}}async function gC(n,e={}){return xi(n,"GET","/v2/passwordPolicy",vi(n,e))}const yC=6;class bC{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??yC,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const i=this.customStrengthOptions.minPasswordLength,l=this.customStrengthOptions.maxPasswordLength;i&&(t.meetsMinPasswordLength=e.length>=i),l&&(t.meetsMaxPasswordLength=e.length<=l)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let i;for(let l=0;l<e.length;l++)i=e.charAt(l),this.updatePasswordCharacterOptionsStatuses(t,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,t,i,l,u){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=l)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=u))}}class vC{constructor(e,t,i,l){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=i,this.config=l,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new tx(this),this.idTokenSubscription=new tx(this),this.beforeStateQueue=new pC(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=uw,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=l.sdkClientVersion,this._persistenceManagerAvailable=new Promise(u=>this._resolvePersistenceManagerAvailable=u)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=ci(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await $l.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await Rh(this,{idToken:e}),i=await va._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(i)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(Gr(this.app)){const u=this.app.settings.authIdToken;return u?new Promise(d=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(u).then(d,d))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let i=t,l=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const u=this.redirectUser?._redirectEventId,d=i?._redirectEventId,p=await this.tryRedirectSignIn(e);(!u||u===d)&&p?.user&&(i=p.user,l=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(l)try{await this.beforeStateQueue.runMiddleware(i)}catch(u){i=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(u))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return Lt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Ah(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=XN()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Gr(this.app))return Promise.reject(di(this));const t=e?Qs(e):null;return t&&Lt(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Lt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Gr(this.app)?Promise.reject(di(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Gr(this.app)?Promise.reject(di(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(ci(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await gC(this),t=new bC(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Cu("auth","Firebase",e())}onAuthStateChanged(e,t,i){return this.registerStateListener(this.authStateSubscription,e,t,i)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,i){return this.registerStateListener(this.idTokenSubscription,e,t,i)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const i=this.onAuthStateChanged(()=>{i(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(i.tenantId=this.tenantId),await hC(this,i)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const i=await this.getOrInitRedirectPersistenceManager(t);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&ci(e)||this._popupRedirectResolver;Lt(t,this,"argument-error"),this.redirectPersistenceManager=await $l.create(this,[ci(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,i,l){if(this._deleted)return()=>{};const u=typeof t=="function"?t:t.next.bind(t);let d=!1;const p=this._isInitialized?Promise.resolve():this._initializationPromise;if(Lt(p,this,"internal-error"),p.then(()=>{d||u(this.currentUser)}),typeof t=="function"){const g=e.addObserver(t,i,l);return()=>{d=!0,g()}}else{const g=e.addObserver(t);return()=>{d=!0,g()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Lt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Tw(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const i=await this._getAppCheckToken();return i&&(e["X-Firebase-AppCheck"]=i),e}async _getAppCheckToken(){if(Gr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&KN(`Error while retrieving App Check token: ${e.error}`),e?.token}}function po(n){return Qs(n)}class tx{constructor(e){this.auth=e,this.observer=null,this.addObserver=LS(t=>this.observer=t)}get next(){return Lt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let Zh={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function xC(n){Zh=n}function Ew(n){return Zh.loadJS(n)}function wC(){return Zh.recaptchaEnterpriseScript}function _C(){return Zh.gapiScript}function kC(n){return`__${n}${Math.floor(Math.random()*1e6)}`}class jC{constructor(){this.enterprise=new TC}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class TC{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const EC="recaptcha-enterprise",Sw="NO_RECAPTCHA";class SC{constructor(e){this.type=EC,this.auth=po(e)}async verify(e="verify",t=!1){async function i(u){if(!t){if(u.tenantId==null&&u._agentRecaptchaConfig!=null)return u._agentRecaptchaConfig.siteKey;if(u.tenantId!=null&&u._tenantRecaptchaConfigs[u.tenantId]!==void 0)return u._tenantRecaptchaConfigs[u.tenantId].siteKey}return new Promise(async(d,p)=>{rC(u,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(g=>{if(g.recaptchaKey===void 0)p(new Error("recaptcha Enterprise site key undefined"));else{const y=new nC(g);return u.tenantId==null?u._agentRecaptchaConfig=y:u._tenantRecaptchaConfigs[u.tenantId]=y,d(y.siteKey)}}).catch(g=>{p(g)})})}function l(u,d,p){const g=window.grecaptcha;Q1(g)?g.enterprise.ready(()=>{g.enterprise.execute(u,{action:e}).then(y=>{d(y)}).catch(()=>{d(Sw)})}):p(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new jC().execute("siteKey",{action:"verify"}):new Promise((u,d)=>{i(this.auth).then(p=>{if(!t&&Q1(window.grecaptcha))l(p,u,d);else{if(typeof window>"u"){d(new Error("RecaptchaVerifier is only supported in browser"));return}let g=wC();g.length!==0&&(g+=p),Ew(g).then(()=>{l(p,u,d)}).catch(y=>{d(y)})}}).catch(p=>{d(p)})})}}async function sx(n,e,t,i=!1,l=!1){const u=new SC(n);let d;if(l)d=Sw;else try{d=await u.verify(t)}catch{d=await u.verify(t,!0)}const p={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in p){const g=p.phoneEnrollmentInfo.phoneNumber,y=p.phoneEnrollmentInfo.recaptchaToken;Object.assign(p,{phoneEnrollmentInfo:{phoneNumber:g,recaptchaToken:y,captchaResponse:d,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in p){const g=p.phoneSignInInfo.recaptchaToken;Object.assign(p,{phoneSignInInfo:{recaptchaToken:g,captchaResponse:d,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return p}return i?Object.assign(p,{captchaResp:d}):Object.assign(p,{captchaResponse:d}),Object.assign(p,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(p,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),p}async function Mh(n,e,t,i,l){if(n._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const u=await sx(n,e,t,t==="getOobCode");return i(n,u)}else return i(n,e).catch(async u=>{if(u.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const d=await sx(n,e,t,t==="getOobCode");return i(n,d)}else return Promise.reject(u)})}function NC(n,e){const t=Jh(n,"auth");if(t.isInitialized()){const l=t.getImmediate(),u=t.getOptions();if(Ho(u,e??{}))return l;wa(l,"already-initialized")}return t.initialize({options:e})}function CC(n,e){const t=e?.persistence||[],i=(Array.isArray(t)?t:[t]).map(ci);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(i,e?.popupRedirectResolver)}function RC(n,e,t){const i=po(n);Lt(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const l=!1,u=Nw(e),{host:d,port:p}=AC(e),g=p===null?"":`:${p}`,y={url:`${u}//${d}${g}/`},w=Object.freeze({host:d,port:p,protocol:u.replace(":",""),options:Object.freeze({disableWarnings:l})});if(!i._canInitEmulator){Lt(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),Lt(Ho(y,i.config.emulator)&&Ho(w,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=y,i.emulatorConfig=w,i.settings.appVerificationDisabledForTesting=!0,fo(d)?(qg(`${u}//${d}${g}`),Hg("Auth",!0)):MC()}function Nw(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function AC(n){const e=Nw(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const i=t[2].split("@").pop()||"",l=/^(\[[^\]]+\])(:|$)/.exec(i);if(l){const u=l[1];return{host:u,port:nx(i.substr(u.length+1))}}else{const[u,d]=i.split(":");return{host:u,port:nx(d)}}}function nx(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function MC(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}class Zg{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return li("not implemented")}_getIdTokenResponse(e){return li("not implemented")}_linkToIdToken(e,t){return li("not implemented")}_getReauthenticationResolver(e){return li("not implemented")}}async function IC(n,e){return xi(n,"POST","/v1/accounts:signUp",e)}async function DC(n,e){return Mu(n,"POST","/v1/accounts:signInWithPassword",vi(n,e))}async function Cw(n,e){return xi(n,"POST","/v1/accounts:sendOobCode",vi(n,e))}async function PC(n,e){return Cw(n,e)}async function LC(n,e){return Cw(n,e)}async function OC(n,e){return Mu(n,"POST","/v1/accounts:signInWithEmailLink",vi(n,e))}async function VC(n,e){return Mu(n,"POST","/v1/accounts:signInWithEmailLink",vi(n,e))}class yu extends Zg{constructor(e,t,i,l=null){super("password",i),this._email=e,this._password=t,this._tenantId=l}static _fromEmailAndPassword(e,t){return new yu(e,t,"password")}static _fromEmailAndCode(e,t,i=null){return new yu(e,t,"emailLink",i)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Mh(e,t,"signInWithPassword",DC);case"emailLink":return OC(e,{email:this._email,oobCode:this._password});default:wa(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const i={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Mh(e,i,"signUpPassword",IC);case"emailLink":return VC(e,{idToken:t,email:this._email,oobCode:this._password});default:wa(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function Wl(n,e){return Mu(n,"POST","/v1/accounts:signInWithIdp",vi(n,e))}const BC="http://localhost";class Wo extends Zg{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Wo(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):wa("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:l,...u}=t;if(!i||!l)return null;const d=new Wo(i,l);return d.idToken=u.idToken||void 0,d.accessToken=u.accessToken||void 0,d.secret=u.secret,d.nonce=u.nonce,d.pendingToken=u.pendingToken||null,d}_getIdTokenResponse(e){const t=this.buildRequest();return Wl(e,t)}_linkToIdToken(e,t){const i=this.buildRequest();return i.idToken=t,Wl(e,i)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Wl(e,t)}buildRequest(){const e={requestUri:BC,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Ru(t)}return e}}function UC(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function FC(n){const e=eu(tu(n)).link,t=e?eu(tu(e)).deep_link_id:null,i=eu(tu(n)).deep_link_id;return(i?eu(tu(i)).link:null)||i||t||e||n}class ey{constructor(e){const t=eu(tu(e)),i=t.apiKey??null,l=t.oobCode??null,u=UC(t.mode??null);Lt(i&&l&&u,"argument-error"),this.apiKey=i,this.operation=u,this.code=l,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=FC(e);try{return new ey(t)}catch{return null}}}class rc{constructor(){this.providerId=rc.PROVIDER_ID}static credential(e,t){return yu._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const i=ey.parseLink(t);return Lt(i,"argument-error"),yu._fromEmailAndCode(e,i.code,i.tenantId)}}rc.PROVIDER_ID="password";rc.EMAIL_PASSWORD_SIGN_IN_METHOD="password";rc.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class Rw{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class Iu extends Rw{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Ki extends Iu{constructor(){super("facebook.com")}static credential(e){return Wo._fromParams({providerId:Ki.PROVIDER_ID,signInMethod:Ki.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ki.credentialFromTaggedObject(e)}static credentialFromError(e){return Ki.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ki.credential(e.oauthAccessToken)}catch{return null}}}Ki.FACEBOOK_SIGN_IN_METHOD="facebook.com";Ki.PROVIDER_ID="facebook.com";class Yi extends Iu{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Wo._fromParams({providerId:Yi.PROVIDER_ID,signInMethod:Yi.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Yi.credentialFromTaggedObject(e)}static credentialFromError(e){return Yi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:i}=e;if(!t&&!i)return null;try{return Yi.credential(t,i)}catch{return null}}}Yi.GOOGLE_SIGN_IN_METHOD="google.com";Yi.PROVIDER_ID="google.com";class Qi extends Iu{constructor(){super("github.com")}static credential(e){return Wo._fromParams({providerId:Qi.PROVIDER_ID,signInMethod:Qi.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Qi.credentialFromTaggedObject(e)}static credentialFromError(e){return Qi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Qi.credential(e.oauthAccessToken)}catch{return null}}}Qi.GITHUB_SIGN_IN_METHOD="github.com";Qi.PROVIDER_ID="github.com";class Xi extends Iu{constructor(){super("twitter.com")}static credential(e,t){return Wo._fromParams({providerId:Xi.PROVIDER_ID,signInMethod:Xi.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Xi.credentialFromTaggedObject(e)}static credentialFromError(e){return Xi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:i}=e;if(!t||!i)return null;try{return Xi.credential(t,i)}catch{return null}}}Xi.TWITTER_SIGN_IN_METHOD="twitter.com";Xi.PROVIDER_ID="twitter.com";async function zC(n,e){return Mu(n,"POST","/v1/accounts:signUp",vi(n,e))}class Go{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,i,l=!1){const u=await va._fromIdTokenResponse(e,i,l),d=rx(i);return new Go({user:u,providerId:d,_tokenResponse:i,operationType:t})}static async _forOperation(e,t,i){await e._updateTokensIfNecessary(i,!0);const l=rx(i);return new Go({user:e,providerId:l,_tokenResponse:i,operationType:t})}}function rx(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}class Ih extends Ha{constructor(e,t,i,l){super(t.code,t.message),this.operationType=i,this.user=l,Object.setPrototypeOf(this,Ih.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,t,i,l){return new Ih(e,t,i,l)}}function Aw(n,e,t,i){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(u=>{throw u.code==="auth/multi-factor-auth-required"?Ih._fromErrorAndOperation(n,u,e,i):u})}async function qC(n,e,t=!1){const i=await gu(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return Go._forOperation(n,"link",i)}async function HC(n,e,t=!1){const{auth:i}=n;if(Gr(i.app))return Promise.reject(di(i));const l="reauthenticate";try{const u=await gu(n,Aw(i,l,e,n),t);Lt(u.idToken,i,"internal-error");const d=Xg(u.idToken);Lt(d,i,"internal-error");const{sub:p}=d;return Lt(n.uid===p,i,"user-mismatch"),Go._forOperation(n,l,u)}catch(u){throw u?.code==="auth/user-not-found"&&wa(i,"user-mismatch"),u}}async function Mw(n,e,t=!1){if(Gr(n.app))return Promise.reject(di(n));const i="signIn",l=await Aw(n,i,e),u=await Go._fromIdTokenResponse(n,i,l);return t||await n._updateCurrentUser(u.user),u}async function $C(n,e){return Mw(po(n),e)}async function Iw(n){const e=po(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function WC(n,e,t){const i=po(n);await Mh(i,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",LC)}async function GC(n,e,t){if(Gr(n.app))return Promise.reject(di(n));const i=po(n),d=await Mh(i,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",zC).catch(g=>{throw g.code==="auth/password-does-not-meet-requirements"&&Iw(n),g}),p=await Go._fromIdTokenResponse(i,"signIn",d);return await i._updateCurrentUser(p.user),p}function KC(n,e,t){return Gr(n.app)?Promise.reject(di(n)):$C(Qs(n),rc.credential(e,t)).catch(async i=>{throw i.code==="auth/password-does-not-meet-requirements"&&Iw(n),i})}async function PP(n,e){const t=Qs(n),l={requestType:"VERIFY_EMAIL",idToken:await n.getIdToken()},{email:u}=await PC(t.auth,l);u!==n.email&&await n.reload()}function ax(n,e){return Qs(n).setPersistence(e)}function YC(n,e,t,i){return Qs(n).onIdTokenChanged(e,t,i)}function QC(n,e,t){return Qs(n).beforeAuthStateChanged(e,t)}function XC(n,e,t,i){return Qs(n).onAuthStateChanged(e,t,i)}function JC(n){return Qs(n).signOut()}const Dh="__sak";class Dw{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Dh,"1"),this.storage.removeItem(Dh),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const ZC=1e3,e4=10;class Pw extends Dw{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=jw(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const i=this.storage.getItem(t),l=this.localCache[t];i!==l&&e(t,l,i)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((d,p,g)=>{this.notifyListeners(d,g)});return}const i=e.key;t?this.detachListener():this.stopPolling();const l=()=>{const d=this.storage.getItem(i);!t&&this.localCache[i]===d||this.notifyListeners(i,d)},u=this.storage.getItem(i);fC()&&u!==e.newValue&&e.newValue!==e.oldValue?setTimeout(l,e4):l()}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const l of Array.from(i))l(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:i}),!0)})},ZC)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}Pw.type="LOCAL";const hg=Pw;class Lw extends Dw{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}Lw.type="SESSION";const ty=Lw;function t4(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class em{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(l=>l.isListeningto(e));if(t)return t;const i=new em(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:i,eventType:l,data:u}=t.data,d=this.handlersMap[l];if(!d?.size)return;t.ports[0].postMessage({status:"ack",eventId:i,eventType:l});const p=Array.from(d).map(async y=>y(t.origin,u)),g=await t4(p);t.ports[0].postMessage({status:"done",eventId:i,eventType:l,response:g})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}em.receivers=[];function sy(n="",e=10){let t="";for(let i=0;i<e;i++)t+=Math.floor(Math.random()*10);return n+t}class s4{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,i=50){const l=typeof MessageChannel<"u"?new MessageChannel:null;if(!l)throw new Error("connection_unavailable");let u,d;return new Promise((p,g)=>{const y=sy("",20);l.port1.start();const w=setTimeout(()=>{g(new Error("unsupported_event"))},i);d={messageChannel:l,onMessage(j){const T=j;if(T.data.eventId===y)switch(T.data.status){case"ack":clearTimeout(w),u=setTimeout(()=>{g(new Error("timeout"))},3e3);break;case"done":clearTimeout(u),p(T.data.response);break;default:clearTimeout(w),clearTimeout(u),g(new Error("invalid_response"));break}}},this.handlers.add(d),l.port1.addEventListener("message",d.onMessage),this.target.postMessage({eventType:e,eventId:y,data:t},[l.port2])}).finally(()=>{d&&this.removeMessageHandler(d)})}}function Va(){return window}function n4(n){Va().location.href=n}function Ow(){return typeof Va().WorkerGlobalScope<"u"&&typeof Va().importScripts=="function"}async function r4(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function a4(){return navigator?.serviceWorker?.controller||null}function i4(){return Ow()?self:null}const Vw="firebaseLocalStorageDb",o4=1,Ph="firebaseLocalStorage",Bw="fbase_key";class Du{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function tm(n,e){return n.transaction([Ph],e?"readwrite":"readonly").objectStore(Ph)}function l4(){const n=indexedDB.deleteDatabase(Vw);return new Du(n).toPromise()}function mg(){const n=indexedDB.open(Vw,o4);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const i=n.result;try{i.createObjectStore(Ph,{keyPath:Bw})}catch(l){t(l)}}),n.addEventListener("success",async()=>{const i=n.result;i.objectStoreNames.contains(Ph)?e(i):(i.close(),await l4(),e(await mg()))})})}async function ix(n,e,t){const i=tm(n,!0).put({[Bw]:e,value:t});return new Du(i).toPromise()}async function c4(n,e){const t=tm(n,!1).get(e),i=await new Du(t).toPromise();return i===void 0?null:i.value}function ox(n,e){const t=tm(n,!0).delete(e);return new Du(t).toPromise()}const u4=800,d4=3;class Uw{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await mg(),this.db)}async _withRetries(e){let t=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(i){if(t++>d4)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Ow()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=em._getInstance(i4()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await r4(),!this.activeServiceWorker)return;this.sender=new s4(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||a4()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await mg();return await ix(e,Dh,"1"),await ox(e,Dh),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(i=>ix(i,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(i=>c4(i,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>ox(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(l=>{const u=tm(l,!1).getAll();return new Du(u).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],i=new Set;if(e.length!==0)for(const{fbase_key:l,value:u}of e)i.add(l),JSON.stringify(this.localCache[l])!==JSON.stringify(u)&&(this.notifyListeners(l,u),t.push(l));for(const l of Object.keys(this.localCache))this.localCache[l]&&!i.has(l)&&(this.notifyListeners(l,null),t.push(l));return t}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const l of Array.from(i))l(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),u4)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}Uw.type="LOCAL";const h4=Uw;new Au(3e4,6e4);function m4(n,e){return e?ci(e):(Lt(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}class ny extends Zg{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Wl(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Wl(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Wl(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function f4(n){return Mw(n.auth,new ny(n),n.bypassAuthState)}function p4(n){const{auth:e,user:t}=n;return Lt(t,e,"internal-error"),HC(t,new ny(n),n.bypassAuthState)}async function g4(n){const{auth:e,user:t}=n;return Lt(t,e,"internal-error"),qC(t,new ny(n),n.bypassAuthState)}class Fw{constructor(e,t,i,l,u=!1){this.auth=e,this.resolver=i,this.user=l,this.bypassAuthState=u,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:i,postBody:l,tenantId:u,error:d,type:p}=e;if(d){this.reject(d);return}const g={auth:this.auth,requestUri:t,sessionId:i,tenantId:u||void 0,postBody:l||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(p)(g))}catch(y){this.reject(y)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return f4;case"linkViaPopup":case"linkViaRedirect":return g4;case"reauthViaPopup":case"reauthViaRedirect":return p4;default:wa(this.auth,"internal-error")}}resolve(e){gi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){gi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const y4=new Au(2e3,1e4);class ql extends Fw{constructor(e,t,i,l,u){super(e,t,l,u),this.provider=i,this.authWindow=null,this.pollId=null,ql.currentPopupAction&&ql.currentPopupAction.cancel(),ql.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Lt(e,this.auth,"internal-error"),e}async onExecution(){gi(this.filter.length===1,"Popup operations only handle one event");const e=sy();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Oa(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(Oa(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,ql.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Oa(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,y4.get())};e()}}ql.currentPopupAction=null;const b4="pendingRedirect",bh=new Map;class v4 extends Fw{constructor(e,t,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,i),this.eventId=null}async execute(){let e=bh.get(this.auth._key());if(!e){try{const i=await x4(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(t){e=()=>Promise.reject(t)}bh.set(this.auth._key(),e)}return this.bypassAuthState||bh.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function x4(n,e){const t=k4(e),i=_4(n);if(!await i._isAvailable())return!1;const l=await i._get(t)==="true";return await i._remove(t),l}function w4(n,e){bh.set(n._key(),e)}function _4(n){return ci(n._redirectPersistence)}function k4(n){return yh(b4,n.config.apiKey,n.name)}async function j4(n,e,t=!1){if(Gr(n.app))return Promise.reject(di(n));const i=po(n),l=m4(i,e),d=await new v4(i,l,t).execute();return d&&!t&&(delete d.user._redirectEventId,await i._persistUserIfCurrent(d.user),await i._setRedirectUser(null,e)),d}const T4=600*1e3;class E4{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(t=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!S4(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!zw(e)){const i=e.error.code?.split("auth/")[1]||"internal-error";t.onError(Oa(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const i=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=T4&&this.cachedEventUids.clear(),this.cachedEventUids.has(lx(e))}saveEventToCache(e){this.cachedEventUids.add(lx(e)),this.lastProcessedEventTime=Date.now()}}function lx(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function zw({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function S4(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return zw(n);default:return!1}}async function N4(n,e={}){return xi(n,"GET","/v1/projects",e)}const C4=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,R4=/^https?/;async function A4(n){if(n.config.emulator)return;const{authorizedDomains:e}=await N4(n);for(const t of e)try{if(M4(t))return}catch{}wa(n,"unauthorized-domain")}function M4(n){const e=ug(),{protocol:t,hostname:i}=new URL(e);if(n.startsWith("chrome-extension://")){const d=new URL(n);return d.hostname===""&&i===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&d.hostname===i}if(!R4.test(t))return!1;if(C4.test(n))return i===n;const l=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+l+"|"+l+")$","i").test(i)}const I4=new Au(3e4,6e4);function cx(){const n=Va().___jsl;if(n?.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function D4(n){return new Promise((e,t)=>{function i(){cx(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{cx(),t(Oa(n,"network-request-failed"))},timeout:I4.get()})}if(Va().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(Va().gapi?.load)i();else{const l=kC("iframefcb");return Va()[l]=()=>{gapi.load?i():t(Oa(n,"network-request-failed"))},Ew(`${_C()}?onload=${l}`).catch(u=>t(u))}}).catch(e=>{throw vh=null,e})}let vh=null;function P4(n){return vh=vh||D4(n),vh}const L4=new Au(5e3,15e3),O4="__/auth/iframe",V4="emulator/auth/iframe",B4={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},U4=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function F4(n){const e=n.config;Lt(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?Qg(e,V4):`https://${n.config.authDomain}/${O4}`,i={apiKey:e.apiKey,appName:n.name,v:Jo},l=U4.get(n.config.apiHost);l&&(i.eid=l);const u=n._getFrameworks();return u.length&&(i.fw=u.join(",")),`${t}?${Ru(i).slice(1)}`}async function z4(n){const e=await P4(n),t=Va().gapi;return Lt(t,n,"internal-error"),e.open({where:document.body,url:F4(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:B4,dontclear:!0},i=>new Promise(async(l,u)=>{await i.restyle({setHideOnLeave:!1});const d=Oa(n,"network-request-failed"),p=Va().setTimeout(()=>{u(d)},L4.get());function g(){Va().clearTimeout(p),l(i)}i.ping(g).then(g,()=>{u(d)})}))}const q4={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},H4=500,$4=600,W4="_blank",G4="http://localhost";class ux{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function K4(n,e,t,i=H4,l=$4){const u=Math.max((window.screen.availHeight-l)/2,0).toString(),d=Math.max((window.screen.availWidth-i)/2,0).toString();let p="";const g={...q4,width:i.toString(),height:l.toString(),top:u,left:d},y=hr().toLowerCase();t&&(p=vw(y)?W4:t),yw(y)&&(e=e||G4,g.scrollbars="yes");const w=Object.entries(g).reduce((T,[V,$])=>`${T}${V}=${$},`,"");if(mC(y)&&p!=="_self")return Y4(e||"",p),new ux(null);const j=window.open(e||"",p,w);Lt(j,n,"popup-blocked");try{j.focus()}catch{}return new ux(j)}function Y4(n,e){const t=document.createElement("a");t.href=n,t.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(i)}const Q4="__/auth/handler",X4="emulator/auth/handler",J4=encodeURIComponent("fac");async function dx(n,e,t,i,l,u){Lt(n.config.authDomain,n,"auth-domain-config-required"),Lt(n.config.apiKey,n,"invalid-api-key");const d={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:i,v:Jo,eventId:l};if(e instanceof Rw){e.setDefaultLanguage(n.languageCode),d.providerId=e.providerId||"",PS(e.getCustomParameters())||(d.customParameters=JSON.stringify(e.getCustomParameters()));for(const[w,j]of Object.entries({}))d[w]=j}if(e instanceof Iu){const w=e.getScopes().filter(j=>j!=="");w.length>0&&(d.scopes=w.join(","))}n.tenantId&&(d.tid=n.tenantId);const p=d;for(const w of Object.keys(p))p[w]===void 0&&delete p[w];const g=await n._getAppCheckToken(),y=g?`#${J4}=${encodeURIComponent(g)}`:"";return`${Z4(n)}?${Ru(p).slice(1)}${y}`}function Z4({config:n}){return n.emulator?Qg(n,X4):`https://${n.authDomain}/${Q4}`}const Ap="webStorageSupport";class eR{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=ty,this._completeRedirectFn=j4,this._overrideRedirectResult=w4}async _openPopup(e,t,i,l){gi(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const u=await dx(e,t,i,ug(),l);return K4(e,u,sy())}async _openRedirect(e,t,i,l){await this._originValidation(e);const u=await dx(e,t,i,ug(),l);return n4(u),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:l,promise:u}=this.eventManagers[t];return l?Promise.resolve(l):(gi(u,"If manager is not set, promise should be"),u)}const i=this.initAndGetManager(e);return this.eventManagers[t]={promise:i},i.catch(()=>{delete this.eventManagers[t]}),i}async initAndGetManager(e){const t=await z4(e),i=new E4(e);return t.register("authEvent",l=>(Lt(l?.authEvent,e,"invalid-auth-event"),{status:i.onEvent(l.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=t,i}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Ap,{type:Ap},l=>{const u=l?.[0]?.[Ap];u!==void 0&&t(!!u),wa(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=A4(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return jw()||bw()||Jg()}}const tR=eR;var hx="@firebase/auth",mx="1.12.0";class sR{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(i=>{e(i?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Lt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function nR(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function rR(n){$o(new io("auth",(e,{options:t})=>{const i=e.getProvider("app").getImmediate(),l=e.getProvider("heartbeat"),u=e.getProvider("app-check-internal"),{apiKey:d,authDomain:p}=i.options;Lt(d&&!d.includes(":"),"invalid-api-key",{appName:i.name});const g={apiKey:d,authDomain:p,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Tw(n)},y=new vC(i,l,u,g);return CC(y,t),y},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,i)=>{e.getProvider("auth-internal").initialize()})),$o(new io("auth-internal",e=>{const t=po(e.getProvider("auth").getImmediate());return(i=>new sR(i))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),La(hx,mx,nR(n)),La(hx,mx,"esm2020")}const aR=300,iR=nw("authIdTokenMaxAge")||aR;let fx=null;const oR=n=>async e=>{const t=e&&await e.getIdTokenResult(),i=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(i&&i>iR)return;const l=t?.token;fx!==l&&(fx=l,await fetch(n,{method:l?"POST":"DELETE",headers:l?{Authorization:`Bearer ${l}`}:{}}))};function qw(n=Kg()){const e=Jh(n,"auth");if(e.isInitialized())return e.getImmediate();const t=NC(n,{popupRedirectResolver:tR,persistence:[h4,hg,ty]}),i=nw("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const u=new URL(i,location.origin);if(location.origin===u.origin){const d=oR(u.toString());QC(t,d,()=>d(t.currentUser)),YC(t,p=>d(p))}}const l=ew("auth");return l&&RC(t,`http://${l}`),t}function lR(){return document.getElementsByTagName("head")?.[0]??document}xC({loadJS(n){return new Promise((e,t)=>{const i=document.createElement("script");i.setAttribute("src",n),i.onload=e,i.onerror=l=>{const u=Oa("internal-error");u.customData=l,t(u)},i.type="text/javascript",i.charset="UTF-8",lR().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});rR("Browser");var px=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var ro,Hw;(function(){var n;function e(R,E){function A(){}A.prototype=E.prototype,R.F=E.prototype,R.prototype=new A,R.prototype.constructor=R,R.D=function(O,D,H){for(var I=Array(arguments.length-2),$e=2;$e<arguments.length;$e++)I[$e-2]=arguments[$e];return E.prototype[D].apply(O,I)}}function t(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(i,t),i.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function l(R,E,A){A||(A=0);const O=Array(16);if(typeof E=="string")for(var D=0;D<16;++D)O[D]=E.charCodeAt(A++)|E.charCodeAt(A++)<<8|E.charCodeAt(A++)<<16|E.charCodeAt(A++)<<24;else for(D=0;D<16;++D)O[D]=E[A++]|E[A++]<<8|E[A++]<<16|E[A++]<<24;E=R.g[0],A=R.g[1],D=R.g[2];let H=R.g[3],I;I=E+(H^A&(D^H))+O[0]+3614090360&4294967295,E=A+(I<<7&4294967295|I>>>25),I=H+(D^E&(A^D))+O[1]+3905402710&4294967295,H=E+(I<<12&4294967295|I>>>20),I=D+(A^H&(E^A))+O[2]+606105819&4294967295,D=H+(I<<17&4294967295|I>>>15),I=A+(E^D&(H^E))+O[3]+3250441966&4294967295,A=D+(I<<22&4294967295|I>>>10),I=E+(H^A&(D^H))+O[4]+4118548399&4294967295,E=A+(I<<7&4294967295|I>>>25),I=H+(D^E&(A^D))+O[5]+1200080426&4294967295,H=E+(I<<12&4294967295|I>>>20),I=D+(A^H&(E^A))+O[6]+2821735955&4294967295,D=H+(I<<17&4294967295|I>>>15),I=A+(E^D&(H^E))+O[7]+4249261313&4294967295,A=D+(I<<22&4294967295|I>>>10),I=E+(H^A&(D^H))+O[8]+1770035416&4294967295,E=A+(I<<7&4294967295|I>>>25),I=H+(D^E&(A^D))+O[9]+2336552879&4294967295,H=E+(I<<12&4294967295|I>>>20),I=D+(A^H&(E^A))+O[10]+4294925233&4294967295,D=H+(I<<17&4294967295|I>>>15),I=A+(E^D&(H^E))+O[11]+2304563134&4294967295,A=D+(I<<22&4294967295|I>>>10),I=E+(H^A&(D^H))+O[12]+1804603682&4294967295,E=A+(I<<7&4294967295|I>>>25),I=H+(D^E&(A^D))+O[13]+4254626195&4294967295,H=E+(I<<12&4294967295|I>>>20),I=D+(A^H&(E^A))+O[14]+2792965006&4294967295,D=H+(I<<17&4294967295|I>>>15),I=A+(E^D&(H^E))+O[15]+1236535329&4294967295,A=D+(I<<22&4294967295|I>>>10),I=E+(D^H&(A^D))+O[1]+4129170786&4294967295,E=A+(I<<5&4294967295|I>>>27),I=H+(A^D&(E^A))+O[6]+3225465664&4294967295,H=E+(I<<9&4294967295|I>>>23),I=D+(E^A&(H^E))+O[11]+643717713&4294967295,D=H+(I<<14&4294967295|I>>>18),I=A+(H^E&(D^H))+O[0]+3921069994&4294967295,A=D+(I<<20&4294967295|I>>>12),I=E+(D^H&(A^D))+O[5]+3593408605&4294967295,E=A+(I<<5&4294967295|I>>>27),I=H+(A^D&(E^A))+O[10]+38016083&4294967295,H=E+(I<<9&4294967295|I>>>23),I=D+(E^A&(H^E))+O[15]+3634488961&4294967295,D=H+(I<<14&4294967295|I>>>18),I=A+(H^E&(D^H))+O[4]+3889429448&4294967295,A=D+(I<<20&4294967295|I>>>12),I=E+(D^H&(A^D))+O[9]+568446438&4294967295,E=A+(I<<5&4294967295|I>>>27),I=H+(A^D&(E^A))+O[14]+3275163606&4294967295,H=E+(I<<9&4294967295|I>>>23),I=D+(E^A&(H^E))+O[3]+4107603335&4294967295,D=H+(I<<14&4294967295|I>>>18),I=A+(H^E&(D^H))+O[8]+1163531501&4294967295,A=D+(I<<20&4294967295|I>>>12),I=E+(D^H&(A^D))+O[13]+2850285829&4294967295,E=A+(I<<5&4294967295|I>>>27),I=H+(A^D&(E^A))+O[2]+4243563512&4294967295,H=E+(I<<9&4294967295|I>>>23),I=D+(E^A&(H^E))+O[7]+1735328473&4294967295,D=H+(I<<14&4294967295|I>>>18),I=A+(H^E&(D^H))+O[12]+2368359562&4294967295,A=D+(I<<20&4294967295|I>>>12),I=E+(A^D^H)+O[5]+4294588738&4294967295,E=A+(I<<4&4294967295|I>>>28),I=H+(E^A^D)+O[8]+2272392833&4294967295,H=E+(I<<11&4294967295|I>>>21),I=D+(H^E^A)+O[11]+1839030562&4294967295,D=H+(I<<16&4294967295|I>>>16),I=A+(D^H^E)+O[14]+4259657740&4294967295,A=D+(I<<23&4294967295|I>>>9),I=E+(A^D^H)+O[1]+2763975236&4294967295,E=A+(I<<4&4294967295|I>>>28),I=H+(E^A^D)+O[4]+1272893353&4294967295,H=E+(I<<11&4294967295|I>>>21),I=D+(H^E^A)+O[7]+4139469664&4294967295,D=H+(I<<16&4294967295|I>>>16),I=A+(D^H^E)+O[10]+3200236656&4294967295,A=D+(I<<23&4294967295|I>>>9),I=E+(A^D^H)+O[13]+681279174&4294967295,E=A+(I<<4&4294967295|I>>>28),I=H+(E^A^D)+O[0]+3936430074&4294967295,H=E+(I<<11&4294967295|I>>>21),I=D+(H^E^A)+O[3]+3572445317&4294967295,D=H+(I<<16&4294967295|I>>>16),I=A+(D^H^E)+O[6]+76029189&4294967295,A=D+(I<<23&4294967295|I>>>9),I=E+(A^D^H)+O[9]+3654602809&4294967295,E=A+(I<<4&4294967295|I>>>28),I=H+(E^A^D)+O[12]+3873151461&4294967295,H=E+(I<<11&4294967295|I>>>21),I=D+(H^E^A)+O[15]+530742520&4294967295,D=H+(I<<16&4294967295|I>>>16),I=A+(D^H^E)+O[2]+3299628645&4294967295,A=D+(I<<23&4294967295|I>>>9),I=E+(D^(A|~H))+O[0]+4096336452&4294967295,E=A+(I<<6&4294967295|I>>>26),I=H+(A^(E|~D))+O[7]+1126891415&4294967295,H=E+(I<<10&4294967295|I>>>22),I=D+(E^(H|~A))+O[14]+2878612391&4294967295,D=H+(I<<15&4294967295|I>>>17),I=A+(H^(D|~E))+O[5]+4237533241&4294967295,A=D+(I<<21&4294967295|I>>>11),I=E+(D^(A|~H))+O[12]+1700485571&4294967295,E=A+(I<<6&4294967295|I>>>26),I=H+(A^(E|~D))+O[3]+2399980690&4294967295,H=E+(I<<10&4294967295|I>>>22),I=D+(E^(H|~A))+O[10]+4293915773&4294967295,D=H+(I<<15&4294967295|I>>>17),I=A+(H^(D|~E))+O[1]+2240044497&4294967295,A=D+(I<<21&4294967295|I>>>11),I=E+(D^(A|~H))+O[8]+1873313359&4294967295,E=A+(I<<6&4294967295|I>>>26),I=H+(A^(E|~D))+O[15]+4264355552&4294967295,H=E+(I<<10&4294967295|I>>>22),I=D+(E^(H|~A))+O[6]+2734768916&4294967295,D=H+(I<<15&4294967295|I>>>17),I=A+(H^(D|~E))+O[13]+1309151649&4294967295,A=D+(I<<21&4294967295|I>>>11),I=E+(D^(A|~H))+O[4]+4149444226&4294967295,E=A+(I<<6&4294967295|I>>>26),I=H+(A^(E|~D))+O[11]+3174756917&4294967295,H=E+(I<<10&4294967295|I>>>22),I=D+(E^(H|~A))+O[2]+718787259&4294967295,D=H+(I<<15&4294967295|I>>>17),I=A+(H^(D|~E))+O[9]+3951481745&4294967295,R.g[0]=R.g[0]+E&4294967295,R.g[1]=R.g[1]+(D+(I<<21&4294967295|I>>>11))&4294967295,R.g[2]=R.g[2]+D&4294967295,R.g[3]=R.g[3]+H&4294967295}i.prototype.v=function(R,E){E===void 0&&(E=R.length);const A=E-this.blockSize,O=this.C;let D=this.h,H=0;for(;H<E;){if(D==0)for(;H<=A;)l(this,R,H),H+=this.blockSize;if(typeof R=="string"){for(;H<E;)if(O[D++]=R.charCodeAt(H++),D==this.blockSize){l(this,O),D=0;break}}else for(;H<E;)if(O[D++]=R[H++],D==this.blockSize){l(this,O),D=0;break}}this.h=D,this.o+=E},i.prototype.A=function(){var R=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);R[0]=128;for(var E=1;E<R.length-8;++E)R[E]=0;E=this.o*8;for(var A=R.length-8;A<R.length;++A)R[A]=E&255,E/=256;for(this.v(R),R=Array(16),E=0,A=0;A<4;++A)for(let O=0;O<32;O+=8)R[E++]=this.g[A]>>>O&255;return R};function u(R,E){var A=p;return Object.prototype.hasOwnProperty.call(A,R)?A[R]:A[R]=E(R)}function d(R,E){this.h=E;const A=[];let O=!0;for(let D=R.length-1;D>=0;D--){const H=R[D]|0;O&&H==E||(A[D]=H,O=!1)}this.g=A}var p={};function g(R){return-128<=R&&R<128?u(R,function(E){return new d([E|0],E<0?-1:0)}):new d([R|0],R<0?-1:0)}function y(R){if(isNaN(R)||!isFinite(R))return j;if(R<0)return U(y(-R));const E=[];let A=1;for(let O=0;R>=A;O++)E[O]=R/A|0,A*=4294967296;return new d(E,0)}function w(R,E){if(R.length==0)throw Error("number format error: empty string");if(E=E||10,E<2||36<E)throw Error("radix out of range: "+E);if(R.charAt(0)=="-")return U(w(R.substring(1),E));if(R.indexOf("-")>=0)throw Error('number format error: interior "-" character');const A=y(Math.pow(E,8));let O=j;for(let H=0;H<R.length;H+=8){var D=Math.min(8,R.length-H);const I=parseInt(R.substring(H,H+D),E);D<8?(D=y(Math.pow(E,D)),O=O.j(D).add(y(I))):(O=O.j(A),O=O.add(y(I)))}return O}var j=g(0),T=g(1),V=g(16777216);n=d.prototype,n.m=function(){if(F(this))return-U(this).m();let R=0,E=1;for(let A=0;A<this.g.length;A++){const O=this.i(A);R+=(O>=0?O:4294967296+O)*E,E*=4294967296}return R},n.toString=function(R){if(R=R||10,R<2||36<R)throw Error("radix out of range: "+R);if($(this))return"0";if(F(this))return"-"+U(this).toString(R);const E=y(Math.pow(R,6));var A=this;let O="";for(;;){const D=ye(A,E).g;A=te(A,D.j(E));let H=((A.g.length>0?A.g[0]:A.h)>>>0).toString(R);if(A=D,$(A))return H+O;for(;H.length<6;)H="0"+H;O=H+O}},n.i=function(R){return R<0?0:R<this.g.length?this.g[R]:this.h};function $(R){if(R.h!=0)return!1;for(let E=0;E<R.g.length;E++)if(R.g[E]!=0)return!1;return!0}function F(R){return R.h==-1}n.l=function(R){return R=te(this,R),F(R)?-1:$(R)?0:1};function U(R){const E=R.g.length,A=[];for(let O=0;O<E;O++)A[O]=~R.g[O];return new d(A,~R.h).add(T)}n.abs=function(){return F(this)?U(this):this},n.add=function(R){const E=Math.max(this.g.length,R.g.length),A=[];let O=0;for(let D=0;D<=E;D++){let H=O+(this.i(D)&65535)+(R.i(D)&65535),I=(H>>>16)+(this.i(D)>>>16)+(R.i(D)>>>16);O=I>>>16,H&=65535,I&=65535,A[D]=I<<16|H}return new d(A,A[A.length-1]&-2147483648?-1:0)};function te(R,E){return R.add(U(E))}n.j=function(R){if($(this)||$(R))return j;if(F(this))return F(R)?U(this).j(U(R)):U(U(this).j(R));if(F(R))return U(this.j(U(R)));if(this.l(V)<0&&R.l(V)<0)return y(this.m()*R.m());const E=this.g.length+R.g.length,A=[];for(var O=0;O<2*E;O++)A[O]=0;for(O=0;O<this.g.length;O++)for(let D=0;D<R.g.length;D++){const H=this.i(O)>>>16,I=this.i(O)&65535,$e=R.i(D)>>>16,xt=R.i(D)&65535;A[2*O+2*D]+=I*xt,K(A,2*O+2*D),A[2*O+2*D+1]+=H*xt,K(A,2*O+2*D+1),A[2*O+2*D+1]+=I*$e,K(A,2*O+2*D+1),A[2*O+2*D+2]+=H*$e,K(A,2*O+2*D+2)}for(R=0;R<E;R++)A[R]=A[2*R+1]<<16|A[2*R];for(R=E;R<2*E;R++)A[R]=0;return new d(A,0)};function K(R,E){for(;(R[E]&65535)!=R[E];)R[E+1]+=R[E]>>>16,R[E]&=65535,E++}function re(R,E){this.g=R,this.h=E}function ye(R,E){if($(E))throw Error("division by zero");if($(R))return new re(j,j);if(F(R))return E=ye(U(R),E),new re(U(E.g),U(E.h));if(F(E))return E=ye(R,U(E)),new re(U(E.g),E.h);if(R.g.length>30){if(F(R)||F(E))throw Error("slowDivide_ only works with positive integers.");for(var A=T,O=E;O.l(R)<=0;)A=ve(A),O=ve(O);var D=ge(A,1),H=ge(O,1);for(O=ge(O,2),A=ge(A,2);!$(O);){var I=H.add(O);I.l(R)<=0&&(D=D.add(A),H=I),O=ge(O,1),A=ge(A,1)}return E=te(R,D.j(E)),new re(D,E)}for(D=j;R.l(E)>=0;){for(A=Math.max(1,Math.floor(R.m()/E.m())),O=Math.ceil(Math.log(A)/Math.LN2),O=O<=48?1:Math.pow(2,O-48),H=y(A),I=H.j(E);F(I)||I.l(R)>0;)A-=O,H=y(A),I=H.j(E);$(H)&&(H=T),D=D.add(H),R=te(R,I)}return new re(D,R)}n.B=function(R){return ye(this,R).h},n.and=function(R){const E=Math.max(this.g.length,R.g.length),A=[];for(let O=0;O<E;O++)A[O]=this.i(O)&R.i(O);return new d(A,this.h&R.h)},n.or=function(R){const E=Math.max(this.g.length,R.g.length),A=[];for(let O=0;O<E;O++)A[O]=this.i(O)|R.i(O);return new d(A,this.h|R.h)},n.xor=function(R){const E=Math.max(this.g.length,R.g.length),A=[];for(let O=0;O<E;O++)A[O]=this.i(O)^R.i(O);return new d(A,this.h^R.h)};function ve(R){const E=R.g.length+1,A=[];for(let O=0;O<E;O++)A[O]=R.i(O)<<1|R.i(O-1)>>>31;return new d(A,R.h)}function ge(R,E){const A=E>>5;E%=32;const O=R.g.length-A,D=[];for(let H=0;H<O;H++)D[H]=E>0?R.i(H+A)>>>E|R.i(H+A+1)<<32-E:R.i(H+A);return new d(D,R.h)}i.prototype.digest=i.prototype.A,i.prototype.reset=i.prototype.u,i.prototype.update=i.prototype.v,Hw=i,d.prototype.add=d.prototype.add,d.prototype.multiply=d.prototype.j,d.prototype.modulo=d.prototype.B,d.prototype.compare=d.prototype.l,d.prototype.toNumber=d.prototype.m,d.prototype.toString=d.prototype.toString,d.prototype.getBits=d.prototype.i,d.fromNumber=y,d.fromString=w,ro=d}).apply(typeof px<"u"?px:typeof self<"u"?self:typeof window<"u"?window:{});var th=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var $w,su,Ww,xh,fg,Gw,Kw,Yw;(function(){var n,e=Object.defineProperty;function t(h){h=[typeof globalThis=="object"&&globalThis,h,typeof window=="object"&&window,typeof self=="object"&&self,typeof th=="object"&&th];for(var b=0;b<h.length;++b){var _=h[b];if(_&&_.Math==Math)return _}throw Error("Cannot find global object")}var i=t(this);function l(h,b){if(b)e:{var _=i;h=h.split(".");for(var C=0;C<h.length-1;C++){var ne=h[C];if(!(ne in _))break e;_=_[ne]}h=h[h.length-1],C=_[h],b=b(C),b!=C&&b!=null&&e(_,h,{configurable:!0,writable:!0,value:b})}}l("Symbol.dispose",function(h){return h||Symbol("Symbol.dispose")}),l("Array.prototype.values",function(h){return h||function(){return this[Symbol.iterator]()}}),l("Object.entries",function(h){return h||function(b){var _=[],C;for(C in b)Object.prototype.hasOwnProperty.call(b,C)&&_.push([C,b[C]]);return _}});var u=u||{},d=this||self;function p(h){var b=typeof h;return b=="object"&&h!=null||b=="function"}function g(h,b,_){return h.call.apply(h.bind,arguments)}function y(h,b,_){return y=g,y.apply(null,arguments)}function w(h,b){var _=Array.prototype.slice.call(arguments,1);return function(){var C=_.slice();return C.push.apply(C,arguments),h.apply(this,C)}}function j(h,b){function _(){}_.prototype=b.prototype,h.Z=b.prototype,h.prototype=new _,h.prototype.constructor=h,h.Ob=function(C,ne,de){for(var Ke=Array(arguments.length-2),Jt=2;Jt<arguments.length;Jt++)Ke[Jt-2]=arguments[Jt];return b.prototype[ne].apply(C,Ke)}}var T=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?h=>h&&AsyncContext.Snapshot.wrap(h):h=>h;function V(h){const b=h.length;if(b>0){const _=Array(b);for(let C=0;C<b;C++)_[C]=h[C];return _}return[]}function $(h,b){for(let C=1;C<arguments.length;C++){const ne=arguments[C];var _=typeof ne;if(_=_!="object"?_:ne?Array.isArray(ne)?"array":_:"null",_=="array"||_=="object"&&typeof ne.length=="number"){_=h.length||0;const de=ne.length||0;h.length=_+de;for(let Ke=0;Ke<de;Ke++)h[_+Ke]=ne[Ke]}else h.push(ne)}}class F{constructor(b,_){this.i=b,this.j=_,this.h=0,this.g=null}get(){let b;return this.h>0?(this.h--,b=this.g,this.g=b.next,b.next=null):b=this.i(),b}}function U(h){d.setTimeout(()=>{throw h},0)}function te(){var h=R;let b=null;return h.g&&(b=h.g,h.g=h.g.next,h.g||(h.h=null),b.next=null),b}class K{constructor(){this.h=this.g=null}add(b,_){const C=re.get();C.set(b,_),this.h?this.h.next=C:this.g=C,this.h=C}}var re=new F(()=>new ye,h=>h.reset());class ye{constructor(){this.next=this.g=this.h=null}set(b,_){this.h=b,this.g=_,this.next=null}reset(){this.next=this.g=this.h=null}}let ve,ge=!1,R=new K,E=()=>{const h=Promise.resolve(void 0);ve=()=>{h.then(A)}};function A(){for(var h;h=te();){try{h.h.call(h.g)}catch(_){U(_)}var b=re;b.j(h),b.h<100&&(b.h++,h.next=b.g,b.g=h)}ge=!1}function O(){this.u=this.u,this.C=this.C}O.prototype.u=!1,O.prototype.dispose=function(){this.u||(this.u=!0,this.N())},O.prototype[Symbol.dispose]=function(){this.dispose()},O.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function D(h,b){this.type=h,this.g=this.target=b,this.defaultPrevented=!1}D.prototype.h=function(){this.defaultPrevented=!0};var H=(function(){if(!d.addEventListener||!Object.defineProperty)return!1;var h=!1,b=Object.defineProperty({},"passive",{get:function(){h=!0}});try{const _=()=>{};d.addEventListener("test",_,b),d.removeEventListener("test",_,b)}catch{}return h})();function I(h){return/^[\s\xa0]*$/.test(h)}function $e(h,b){D.call(this,h?h.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,h&&this.init(h,b)}j($e,D),$e.prototype.init=function(h,b){const _=this.type=h.type,C=h.changedTouches&&h.changedTouches.length?h.changedTouches[0]:null;this.target=h.target||h.srcElement,this.g=b,b=h.relatedTarget,b||(_=="mouseover"?b=h.fromElement:_=="mouseout"&&(b=h.toElement)),this.relatedTarget=b,C?(this.clientX=C.clientX!==void 0?C.clientX:C.pageX,this.clientY=C.clientY!==void 0?C.clientY:C.pageY,this.screenX=C.screenX||0,this.screenY=C.screenY||0):(this.clientX=h.clientX!==void 0?h.clientX:h.pageX,this.clientY=h.clientY!==void 0?h.clientY:h.pageY,this.screenX=h.screenX||0,this.screenY=h.screenY||0),this.button=h.button,this.key=h.key||"",this.ctrlKey=h.ctrlKey,this.altKey=h.altKey,this.shiftKey=h.shiftKey,this.metaKey=h.metaKey,this.pointerId=h.pointerId||0,this.pointerType=h.pointerType,this.state=h.state,this.i=h,h.defaultPrevented&&$e.Z.h.call(this)},$e.prototype.h=function(){$e.Z.h.call(this);const h=this.i;h.preventDefault?h.preventDefault():h.returnValue=!1};var xt="closure_listenable_"+(Math.random()*1e6|0),W=0;function he(h,b,_,C,ne){this.listener=h,this.proxy=null,this.src=b,this.type=_,this.capture=!!C,this.ha=ne,this.key=++W,this.da=this.fa=!1}function Pe(h){h.da=!0,h.listener=null,h.proxy=null,h.src=null,h.ha=null}function He(h,b,_){for(const C in h)b.call(_,h[C],C,h)}function ee(h,b){for(const _ in h)b.call(void 0,h[_],_,h)}function L(h){const b={};for(const _ in h)b[_]=h[_];return b}const se="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Le(h,b){let _,C;for(let ne=1;ne<arguments.length;ne++){C=arguments[ne];for(_ in C)h[_]=C[_];for(let de=0;de<se.length;de++)_=se[de],Object.prototype.hasOwnProperty.call(C,_)&&(h[_]=C[_])}}function Oe(h){this.src=h,this.g={},this.h=0}Oe.prototype.add=function(h,b,_,C,ne){const de=h.toString();h=this.g[de],h||(h=this.g[de]=[],this.h++);const Ke=Ue(h,b,C,ne);return Ke>-1?(b=h[Ke],_||(b.fa=!1)):(b=new he(b,this.src,de,!!C,ne),b.fa=_,h.push(b)),b};function Ye(h,b){const _=b.type;if(_ in h.g){var C=h.g[_],ne=Array.prototype.indexOf.call(C,b,void 0),de;(de=ne>=0)&&Array.prototype.splice.call(C,ne,1),de&&(Pe(b),h.g[_].length==0&&(delete h.g[_],h.h--))}}function Ue(h,b,_,C){for(let ne=0;ne<h.length;++ne){const de=h[ne];if(!de.da&&de.listener==b&&de.capture==!!_&&de.ha==C)return ne}return-1}var pt="closure_lm_"+(Math.random()*1e6|0),Tt={};function at(h,b,_,C,ne){if(Array.isArray(b)){for(let de=0;de<b.length;de++)at(h,b[de],_,C,ne);return null}return _=bt(_),h&&h[xt]?h.J(b,_,p(C)?!!C.capture:!1,ne):Gt(h,b,_,!1,C,ne)}function Gt(h,b,_,C,ne,de){if(!b)throw Error("Invalid event type");const Ke=p(ne)?!!ne.capture:!!ne;let Jt=Ht(h);if(Jt||(h[pt]=Jt=new Oe(h)),_=Jt.add(b,_,C,Ke,de),_.proxy)return _;if(C=zs(),_.proxy=C,C.src=h,C.listener=_,h.addEventListener)H||(ne=Ke),ne===void 0&&(ne=!1),h.addEventListener(b.toString(),C,ne);else if(h.attachEvent)h.attachEvent(oe(b.toString()),C);else if(h.addListener&&h.removeListener)h.addListener(C);else throw Error("addEventListener and attachEvent are unavailable.");return _}function zs(){function h(_){return b.call(h.src,h.listener,_)}const b=ss;return h}function yt(h,b,_,C,ne){if(Array.isArray(b))for(var de=0;de<b.length;de++)yt(h,b[de],_,C,ne);else C=p(C)?!!C.capture:!!C,_=bt(_),h&&h[xt]?(h=h.i,de=String(b).toString(),de in h.g&&(b=h.g[de],_=Ue(b,_,C,ne),_>-1&&(Pe(b[_]),Array.prototype.splice.call(b,_,1),b.length==0&&(delete h.g[de],h.h--)))):h&&(h=Ht(h))&&(b=h.g[b.toString()],h=-1,b&&(h=Ue(b,_,C,ne)),(_=h>-1?b[h]:null)&&ut(_))}function ut(h){if(typeof h!="number"&&h&&!h.da){var b=h.src;if(b&&b[xt])Ye(b.i,h);else{var _=h.type,C=h.proxy;b.removeEventListener?b.removeEventListener(_,C,h.capture):b.detachEvent?b.detachEvent(oe(_),C):b.addListener&&b.removeListener&&b.removeListener(C),(_=Ht(b))?(Ye(_,h),_.h==0&&(_.src=null,b[pt]=null)):Pe(h)}}}function oe(h){return h in Tt?Tt[h]:Tt[h]="on"+h}function ss(h,b){if(h.da)h=!0;else{b=new $e(b,this);const _=h.listener,C=h.ha||h.src;h.fa&&ut(h),h=_.call(C,b)}return h}function Ht(h){return h=h[pt],h instanceof Oe?h:null}var Dt="__closure_events_fn_"+(Math.random()*1e9>>>0);function bt(h){return typeof h=="function"?h:(h[Dt]||(h[Dt]=function(b){return h.handleEvent(b)}),h[Dt])}function Ge(){O.call(this),this.i=new Oe(this),this.M=this,this.G=null}j(Ge,O),Ge.prototype[xt]=!0,Ge.prototype.removeEventListener=function(h,b,_,C){yt(this,h,b,_,C)};function Ze(h,b){var _,C=h.G;if(C)for(_=[];C;C=C.G)_.push(C);if(h=h.M,C=b.type||b,typeof b=="string")b=new D(b,h);else if(b instanceof D)b.target=b.target||h;else{var ne=b;b=new D(C,h),Le(b,ne)}ne=!0;let de,Ke;if(_)for(Ke=_.length-1;Ke>=0;Ke--)de=b.g=_[Ke],ne=Et(de,C,!0,b)&&ne;if(de=b.g=h,ne=Et(de,C,!0,b)&&ne,ne=Et(de,C,!1,b)&&ne,_)for(Ke=0;Ke<_.length;Ke++)de=b.g=_[Ke],ne=Et(de,C,!1,b)&&ne}Ge.prototype.N=function(){if(Ge.Z.N.call(this),this.i){var h=this.i;for(const b in h.g){const _=h.g[b];for(let C=0;C<_.length;C++)Pe(_[C]);delete h.g[b],h.h--}}this.G=null},Ge.prototype.J=function(h,b,_,C){return this.i.add(String(h),b,!1,_,C)},Ge.prototype.K=function(h,b,_,C){return this.i.add(String(h),b,!0,_,C)};function Et(h,b,_,C){if(b=h.i.g[String(b)],!b)return!0;b=b.concat();let ne=!0;for(let de=0;de<b.length;++de){const Ke=b[de];if(Ke&&!Ke.da&&Ke.capture==_){const Jt=Ke.listener,Tn=Ke.ha||Ke.src;Ke.fa&&Ye(h.i,Ke),ne=Jt.call(Tn,C)!==!1&&ne}}return ne&&!C.defaultPrevented}function rn(h,b){if(typeof h!="function")if(h&&typeof h.handleEvent=="function")h=y(h.handleEvent,h);else throw Error("Invalid listener argument");return Number(b)>2147483647?-1:d.setTimeout(h,b||0)}function js(h){h.g=rn(()=>{h.g=null,h.i&&(h.i=!1,js(h))},h.l);const b=h.h;h.h=null,h.m.apply(null,b)}class Kt extends O{constructor(b,_){super(),this.m=b,this.l=_,this.h=null,this.i=!1,this.g=null}j(b){this.h=arguments,this.g?this.i=!0:js(this)}N(){super.N(),this.g&&(d.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function St(h){O.call(this),this.h=h,this.g={}}j(St,O);var Yt=[];function us(h){He(h.g,function(b,_){this.g.hasOwnProperty(_)&&ut(b)},h),h.g={}}St.prototype.N=function(){St.Z.N.call(this),us(this)},St.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var es=d.JSON.stringify,Xs=d.JSON.parse,Nt=class{stringify(h){return d.JSON.stringify(h,void 0)}parse(h){return d.JSON.parse(h,void 0)}};function ps(){}function be(){}var De={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Y(){D.call(this,"d")}j(Y,D);function we(){D.call(this,"c")}j(we,D);var Ce={},Me=null;function Ae(){return Me=Me||new Ge}Ce.Ia="serverreachability";function it(h){D.call(this,Ce.Ia,h)}j(it,D);function Qe(h){const b=Ae();Ze(b,new it(b))}Ce.STAT_EVENT="statevent";function Q(h,b){D.call(this,Ce.STAT_EVENT,h),this.stat=b}j(Q,D);function ce(h){const b=Ae();Ze(b,new Q(b,h))}Ce.Ja="timingevent";function ze(h,b){D.call(this,Ce.Ja,h),this.size=b}j(ze,D);function dt(h,b){if(typeof h!="function")throw Error("Fn must not be null and must be a function");return d.setTimeout(function(){h()},b)}function ht(){this.g=!0}ht.prototype.ua=function(){this.g=!1};function Vt(h,b,_,C,ne,de){h.info(function(){if(h.g)if(de){var Ke="",Jt=de.split("&");for(let Us=0;Us<Jt.length;Us++){var Tn=Jt[Us].split("=");if(Tn.length>1){const un=Tn[0];Tn=Tn[1];const Xr=un.split("_");Ke=Xr.length>=2&&Xr[1]=="type"?Ke+(un+"="+Tn+"&"):Ke+(un+"=redacted&")}}}else Ke=null;else Ke=de;return"XMLHTTP REQ ("+C+") [attempt "+ne+"]: "+b+`
`+_+`
`+Ke})}function Ct(h,b,_,C,ne,de,Ke){h.info(function(){return"XMLHTTP RESP ("+C+") [ attempt "+ne+"]: "+b+`
`+_+`
`+de+" "+Ke})}function At(h,b,_,C){h.info(function(){return"XMLHTTP TEXT ("+b+"): "+Js(h,_)+(C?" "+C:"")})}function Ms(h,b){h.info(function(){return"TIMEOUT: "+b})}ht.prototype.info=function(){};function Js(h,b){if(!h.g)return b;if(!b)return null;try{const de=JSON.parse(b);if(de){for(h=0;h<de.length;h++)if(Array.isArray(de[h])){var _=de[h];if(!(_.length<2)){var C=_[1];if(Array.isArray(C)&&!(C.length<1)){var ne=C[0];if(ne!="noop"&&ne!="stop"&&ne!="close")for(let Ke=1;Ke<C.length;Ke++)C[Ke]=""}}}}return es(de)}catch{return b}}var ns={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Cs={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Ls;function q(){}j(q,ps),q.prototype.g=function(){return new XMLHttpRequest},Ls=new q;function xe(h){return encodeURIComponent(String(h))}function Ee(h){var b=1;h=h.split(":");const _=[];for(;b>0&&h.length;)_.push(h.shift()),b--;return h.length&&_.push(h.join(":")),_}function je(h,b,_,C){this.j=h,this.i=b,this.l=_,this.S=C||1,this.V=new St(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new ke}function ke(){this.i=null,this.g="",this.h=!1}var ot={},mt={};function et(h,b,_){h.M=1,h.A=Kn(cs(b)),h.u=_,h.R=!0,gt(h,null)}function gt(h,b){h.F=Date.now(),ln(h),h.B=cs(h.A);var _=h.B,C=h.S;Array.isArray(C)||(C=[String(C)]),Nr(_.i,"t",C),h.C=0,_=h.j.L,h.h=new ke,h.g=Wu(h.j,_?b:null,!h.u),h.P>0&&(h.O=new Kt(y(h.Y,h,h.g),h.P)),b=h.V,_=h.g,C=h.ba;var ne="readystatechange";Array.isArray(ne)||(ne&&(Yt[0]=ne.toString()),ne=Yt);for(let de=0;de<ne.length;de++){const Ke=at(_,ne[de],C||b.handleEvent,!1,b.h||b);if(!Ke)break;b.g[Ke.key]=Ke}b=h.J?L(h.J):{},h.u?(h.v||(h.v="POST"),b["Content-Type"]="application/x-www-form-urlencoded",h.g.ea(h.B,h.v,h.u,b)):(h.v="GET",h.g.ea(h.B,h.v,null,b)),Qe(),Vt(h.i,h.v,h.B,h.l,h.S,h.u)}je.prototype.ba=function(h){h=h.target;const b=this.O;b&&rs(h)==3?b.j():this.Y(h)},je.prototype.Y=function(h){try{if(h==this.g)e:{const Jt=rs(this.g),Tn=this.g.ya(),Us=this.g.ca();if(!(Jt<3)&&(Jt!=3||this.g&&(this.h.h||this.g.la()||Ut(this.g)))){this.K||Jt!=4||Tn==7||(Tn==8||Us<=0?Qe(3):Qe(2)),kn(this);var b=this.g.ca();this.X=b;var _=Rt(this);if(this.o=b==200,Ct(this.i,this.v,this.B,this.l,this.S,Jt,b),this.o){if(this.U&&!this.L){t:{if(this.g){var C,ne=this.g;if((C=ne.g?ne.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!I(C)){var de=C;break t}}de=null}if(h=de)At(this.i,this.l,h,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,k(this,h);else{this.o=!1,this.m=3,ce(12),Hs(this),pn(this);break e}}if(this.R){h=!0;let un;for(;!this.K&&this.C<_.length;)if(un=_n(this,_),un==mt){Jt==4&&(this.m=4,ce(14),h=!1),At(this.i,this.l,null,"[Incomplete Response]");break}else if(un==ot){this.m=4,ce(15),At(this.i,this.l,_,"[Invalid Chunk]"),h=!1;break}else At(this.i,this.l,un,null),k(this,un);if(ws(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Jt!=4||_.length!=0||this.h.h||(this.m=1,ce(16),h=!1),this.o=this.o&&h,!h)At(this.i,this.l,_,"[Invalid Chunked Response]"),Hs(this),pn(this);else if(_.length>0&&!this.W){this.W=!0;var Ke=this.j;Ke.g==this&&Ke.aa&&!Ke.P&&(Ke.j.info("Great, no buffering proxy detected. Bytes received: "+_.length),yr(Ke),Ke.P=!0,ce(11))}}else At(this.i,this.l,_,null),k(this,_);Jt==4&&Hs(this),this.o&&!this.K&&(Jt==4?tl(this.j,this):(this.o=!1,ln(this)))}else _s(this.g),b==400&&_.indexOf("Unknown SID")>0?(this.m=3,ce(12)):(this.m=0,ce(13)),Hs(this),pn(this)}}}catch{}};function Rt(h){if(!ws(h))return h.g.la();const b=Ut(h.g);if(b==="")return"";let _="";const C=b.length,ne=rs(h.g)==4;if(!h.h.i){if(typeof TextDecoder>"u")return Hs(h),pn(h),"";h.h.i=new d.TextDecoder}for(let de=0;de<C;de++)h.h.h=!0,_+=h.h.i.decode(b[de],{stream:!(ne&&de==C-1)});return b.length=0,h.h.g+=_,h.C=0,h.h.g}function ws(h){return h.g?h.v=="GET"&&h.M!=2&&h.j.Aa:!1}function _n(h,b){var _=h.C,C=b.indexOf(`
`,_);return C==-1?mt:(_=Number(b.substring(_,C)),isNaN(_)?ot:(C+=1,C+_>b.length?mt:(b=b.slice(C,C+_),h.C=C+_,b)))}je.prototype.cancel=function(){this.K=!0,Hs(this)};function ln(h){h.T=Date.now()+h.H,Ln(h,h.H)}function Ln(h,b){if(h.D!=null)throw Error("WatchDog timer not null");h.D=dt(y(h.aa,h),b)}function kn(h){h.D&&(d.clearTimeout(h.D),h.D=null)}je.prototype.aa=function(){this.D=null;const h=Date.now();h-this.T>=0?(Ms(this.i,this.B),this.M!=2&&(Qe(),ce(17)),Hs(this),this.m=2,pn(this)):Ln(this,this.T-h)};function pn(h){h.j.I==0||h.K||tl(h.j,h)}function Hs(h){kn(h);var b=h.O;b&&typeof b.dispose=="function"&&b.dispose(),h.O=null,us(h.V),h.g&&(b=h.g,h.g=null,b.abort(),b.dispose())}function k(h,b){try{var _=h.j;if(_.I!=0&&(_.g==h||Be(_.h,h))){if(!h.L&&Be(_.h,h)&&_.I==3){try{var C=_.Ba.g.parse(b)}catch{C=null}if(Array.isArray(C)&&C.length==3){var ne=C;if(ne[0]==0){e:if(!_.v){if(_.g)if(_.g.F+3e3<h.F)$a(_),Zs(_);else break e;gn(_),ce(18)}}else _.xa=ne[1],0<_.xa-_.K&&ne[2]<37500&&_.F&&_.A==0&&!_.C&&(_.C=dt(y(_.Va,_),6e3));ue(_.h)<=1&&_.ta&&(_.ta=void 0)}else br(_,11)}else if((h.L||_.g==h)&&$a(_),!I(b))for(ne=_.Ba.g.parse(b),b=0;b<ne.length;b++){let Us=ne[b];const un=Us[0];if(!(un<=_.K))if(_.K=un,Us=Us[1],_.I==2)if(Us[0]=="c"){_.M=Us[1],_.ba=Us[2];const Xr=Us[3];Xr!=null&&(_.ka=Xr,_.j.info("VER="+_.ka));const Sa=Us[4];Sa!=null&&(_.za=Sa,_.j.info("SVER="+_.za));const da=Us[5];da!=null&&typeof da=="number"&&da>0&&(C=1.5*da,_.O=C,_.j.info("backChannelRequestTimeoutMs_="+C)),C=_;const ha=h.g;if(ha){const bo=ha.g?ha.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(bo){var de=C.h;de.g||bo.indexOf("spdy")==-1&&bo.indexOf("quic")==-1&&bo.indexOf("h2")==-1||(de.j=de.l,de.g=new Set,de.h&&(Fe(de,de.h),de.h=null))}if(C.G){const nl=ha.g?ha.g.getResponseHeader("X-HTTP-Session-Id"):null;nl&&(C.wa=nl,ds(C.J,C.G,nl))}}_.I=3,_.l&&_.l.ra(),_.aa&&(_.T=Date.now()-h.F,_.j.info("Handshake RTT: "+_.T+"ms")),C=_;var Ke=h;if(C.na=ua(C,C.L?C.ba:null,C.W),Ke.L){tt(C.h,Ke);var Jt=Ke,Tn=C.O;Tn&&(Jt.H=Tn),Jt.D&&(kn(Jt),ln(Jt)),C.g=Ke}else or(C);_.i.length>0&&mn(_)}else Us[0]!="stop"&&Us[0]!="close"||br(_,7);else _.I==3&&(Us[0]=="stop"||Us[0]=="close"?Us[0]=="stop"?br(_,7):sn(_):Us[0]!="noop"&&_.l&&_.l.qa(Us),_.A=0)}}Qe(4)}catch{}}var N=class{constructor(h,b){this.g=h,this.map=b}};function P(h){this.l=h||10,d.PerformanceNavigationTiming?(h=d.performance.getEntriesByType("navigation"),h=h.length>0&&(h[0].nextHopProtocol=="hq"||h[0].nextHopProtocol=="h2")):h=!!(d.chrome&&d.chrome.loadTimes&&d.chrome.loadTimes()&&d.chrome.loadTimes().wasFetchedViaSpdy),this.j=h?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function B(h){return h.h?!0:h.g?h.g.size>=h.j:!1}function ue(h){return h.h?1:h.g?h.g.size:0}function Be(h,b){return h.h?h.h==b:h.g?h.g.has(b):!1}function Fe(h,b){h.g?h.g.add(b):h.h=b}function tt(h,b){h.h&&h.h==b?h.h=null:h.g&&h.g.has(b)&&h.g.delete(b)}P.prototype.cancel=function(){if(this.i=Xe(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const h of this.g.values())h.cancel();this.g.clear()}};function Xe(h){if(h.h!=null)return h.i.concat(h.h.G);if(h.g!=null&&h.g.size!==0){let b=h.i;for(const _ of h.g.values())b=b.concat(_.G);return b}return V(h.i)}var Qt=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Ts(h,b){if(h){h=h.split("&");for(let _=0;_<h.length;_++){const C=h[_].indexOf("=");let ne,de=null;C>=0?(ne=h[_].substring(0,C),de=h[_].substring(C+1)):ne=h[_],b(ne,de?decodeURIComponent(de.replace(/\+/g," ")):"")}}}function as(h){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let b;h instanceof as?(this.l=h.l,Os(this,h.j),this.o=h.o,this.g=h.g,On(this,h.u),this.h=h.h,mr(this,ar(h.i)),this.m=h.m):h&&(b=String(h).match(Qt))?(this.l=!1,Os(this,b[1]||"",!0),this.o=X(b[2]||""),this.g=X(b[3]||"",!0),On(this,b[4]),this.h=X(b[5]||"",!0),mr(this,b[6]||"",!0),this.m=X(b[7]||"")):(this.l=!1,this.i=new is(null,this.l))}as.prototype.toString=function(){const h=[];var b=this.j;b&&h.push(_e(b,We,!0),":");var _=this.g;return(_||b=="file")&&(h.push("//"),(b=this.o)&&h.push(_e(b,We,!0),"@"),h.push(xe(_).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),_=this.u,_!=null&&h.push(":",String(_))),(_=this.h)&&(this.g&&_.charAt(0)!="/"&&h.push("/"),h.push(_e(_,_.charAt(0)=="/"?lt:st,!0))),(_=this.i.toString())&&h.push("?",_),(_=this.m)&&h.push("#",_e(_,Xt)),h.join("")},as.prototype.resolve=function(h){const b=cs(this);let _=!!h.j;_?Os(b,h.j):_=!!h.o,_?b.o=h.o:_=!!h.g,_?b.g=h.g:_=h.u!=null;var C=h.h;if(_)On(b,h.u);else if(_=!!h.h){if(C.charAt(0)!="/")if(this.g&&!this.h)C="/"+C;else{var ne=b.h.lastIndexOf("/");ne!=-1&&(C=b.h.slice(0,ne+1)+C)}if(ne=C,ne==".."||ne==".")C="";else if(ne.indexOf("./")!=-1||ne.indexOf("/.")!=-1){C=ne.lastIndexOf("/",0)==0,ne=ne.split("/");const de=[];for(let Ke=0;Ke<ne.length;){const Jt=ne[Ke++];Jt=="."?C&&Ke==ne.length&&de.push(""):Jt==".."?((de.length>1||de.length==1&&de[0]!="")&&de.pop(),C&&Ke==ne.length&&de.push("")):(de.push(Jt),C=!0)}C=de.join("/")}else C=ne}return _?b.h=C:_=h.i.toString()!=="",_?mr(b,ar(h.i)):_=!!h.m,_&&(b.m=h.m),b};function cs(h){return new as(h)}function Os(h,b,_){h.j=_?X(b,!0):b,h.j&&(h.j=h.j.replace(/:$/,""))}function On(h,b){if(b){if(b=Number(b),isNaN(b)||b<0)throw Error("Bad port number "+b);h.u=b}else h.u=null}function mr(h,b,_){b instanceof is?(h.i=b,ls(h.i,h.l)):(_||(b=_e(b,Mt)),h.i=new is(b,h.l))}function ds(h,b,_){h.i.set(b,_)}function Kn(h){return ds(h,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),h}function X(h,b){return h?b?decodeURI(h.replace(/%25/g,"%2525")):decodeURIComponent(h):""}function _e(h,b,_){return typeof h=="string"?(h=encodeURI(h).replace(b,me),_&&(h=h.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),h):null}function me(h){return h=h.charCodeAt(0),"%"+(h>>4&15).toString(16)+(h&15).toString(16)}var We=/[#\/\?@]/g,st=/[#\?:]/g,lt=/[#\?]/g,Mt=/[#\?@]/g,Xt=/#/g;function is(h,b){this.h=this.g=null,this.i=h||null,this.j=!!b}function Rs(h){h.g||(h.g=new Map,h.h=0,h.i&&Ts(h.i,function(b,_){h.add(decodeURIComponent(b.replace(/\+/g," ")),_)}))}n=is.prototype,n.add=function(h,b){Rs(this),this.i=null,h=Yn(this,h);let _=this.g.get(h);return _||this.g.set(h,_=[]),_.push(b),this.h+=1,this};function os(h,b){Rs(h),b=Yn(h,b),h.g.has(b)&&(h.i=null,h.h-=h.g.get(b).length,h.g.delete(b))}function Vs(h,b){return Rs(h),b=Yn(h,b),h.g.has(b)}n.forEach=function(h,b){Rs(this),this.g.forEach(function(_,C){_.forEach(function(ne){h.call(b,ne,C,this)},this)},this)};function Sr(h,b){Rs(h);let _=[];if(typeof b=="string")Vs(h,b)&&(_=_.concat(h.g.get(Yn(h,b))));else for(h=Array.from(h.g.values()),b=0;b<h.length;b++)_=_.concat(h[b]);return _}n.set=function(h,b){return Rs(this),this.i=null,h=Yn(this,h),Vs(this,h)&&(this.h-=this.g.get(h).length),this.g.set(h,[b]),this.h+=1,this},n.get=function(h,b){return h?(h=Sr(this,h),h.length>0?String(h[0]):b):b};function Nr(h,b,_){os(h,b),_.length>0&&(h.i=null,h.g.set(Yn(h,b),V(_)),h.h+=_.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const h=[],b=Array.from(this.g.keys());for(let C=0;C<b.length;C++){var _=b[C];const ne=xe(_);_=Sr(this,_);for(let de=0;de<_.length;de++){let Ke=ne;_[de]!==""&&(Ke+="="+xe(_[de])),h.push(Ke)}}return this.i=h.join("&")};function ar(h){const b=new is;return b.i=h.i,h.g&&(b.g=new Map(h.g),b.h=h.h),b}function Yn(h,b){return b=String(b),h.j&&(b=b.toLowerCase()),b}function ls(h,b){b&&!h.j&&(Rs(h),h.i=null,h.g.forEach(function(_,C){const ne=C.toLowerCase();C!=ne&&(os(this,C),Nr(this,ne,_))},h)),h.j=b}function Bs(h,b){const _=new ht;if(d.Image){const C=new Image;C.onload=w(jn,_,"TestLoadImage: loaded",!0,b,C),C.onerror=w(jn,_,"TestLoadImage: error",!1,b,C),C.onabort=w(jn,_,"TestLoadImage: abort",!1,b,C),C.ontimeout=w(jn,_,"TestLoadImage: timeout",!1,b,C),d.setTimeout(function(){C.ontimeout&&C.ontimeout()},1e4),C.src=h}else b(!1)}function zn(h,b){const _=new ht,C=new AbortController,ne=setTimeout(()=>{C.abort(),jn(_,"TestPingServer: timeout",!1,b)},1e4);fetch(h,{signal:C.signal}).then(de=>{clearTimeout(ne),de.ok?jn(_,"TestPingServer: ok",!0,b):jn(_,"TestPingServer: server error",!1,b)}).catch(()=>{clearTimeout(ne),jn(_,"TestPingServer: error",!1,b)})}function jn(h,b,_,C,ne){try{ne&&(ne.onload=null,ne.onerror=null,ne.onabort=null,ne.ontimeout=null),C(_)}catch{}}function Qn(){this.g=new Nt}function cn(h){this.i=h.Sb||null,this.h=h.ab||!1}j(cn,ps),cn.prototype.g=function(){return new Vn(this.i,this.h)};function Vn(h,b){Ge.call(this),this.H=h,this.o=b,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}j(Vn,Ge),n=Vn.prototype,n.open=function(h,b){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=h,this.D=b,this.readyState=1,fr(this)},n.send=function(h){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const b={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};h&&(b.body=h),(this.H||d).fetch(new Request(this.D,b)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Br(this)),this.readyState=0},n.Pa=function(h){if(this.g&&(this.l=h,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=h.headers,this.readyState=2,fr(this)),this.g&&(this.readyState=3,fr(this),this.g)))if(this.responseType==="arraybuffer")h.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof d.ReadableStream<"u"&&"body"in h){if(this.j=h.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Cr(this)}else h.text().then(this.Oa.bind(this),this.ga.bind(this))};function Cr(h){h.j.read().then(h.Ma.bind(h)).catch(h.ga.bind(h))}n.Ma=function(h){if(this.g){if(this.o&&h.value)this.response.push(h.value);else if(!this.o){var b=h.value?h.value:new Uint8Array(0);(b=this.B.decode(b,{stream:!h.done}))&&(this.response=this.responseText+=b)}h.done?Br(this):fr(this),this.readyState==3&&Cr(this)}},n.Oa=function(h){this.g&&(this.response=this.responseText=h,Br(this))},n.Na=function(h){this.g&&(this.response=h,Br(this))},n.ga=function(){this.g&&Br(this)};function Br(h){h.readyState=4,h.l=null,h.j=null,h.B=null,fr(h)}n.setRequestHeader=function(h,b){this.A.append(h,b)},n.getResponseHeader=function(h){return this.h&&this.h.get(h.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const h=[],b=this.h.entries();for(var _=b.next();!_.done;)_=_.value,h.push(_[0]+": "+_[1]),_=b.next();return h.join(`\r
`)};function fr(h){h.onreadystatechange&&h.onreadystatechange.call(h)}Object.defineProperty(Vn.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(h){this.m=h?"include":"same-origin"}});function M(h){let b="";return He(h,function(_,C){b+=C,b+=":",b+=_,b+=`\r
`}),b}function Z(h,b,_){e:{for(C in _){var C=!1;break e}C=!0}C||(_=M(_),typeof h=="string"?_!=null&&xe(_):ds(h,b,_))}function Se(h){Ge.call(this),this.headers=new Map,this.L=h||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}j(Se,Ge);var Je=/^https?$/i,_t=["POST","PUT"];n=Se.prototype,n.Fa=function(h){this.H=h},n.ea=function(h,b,_,C){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+h);b=b?b.toUpperCase():"GET",this.D=h,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Ls.g(),this.g.onreadystatechange=T(y(this.Ca,this));try{this.B=!0,this.g.open(b,String(h),!0),this.B=!1}catch(de){Pt(this,de);return}if(h=_||"",_=new Map(this.headers),C)if(Object.getPrototypeOf(C)===Object.prototype)for(var ne in C)_.set(ne,C[ne]);else if(typeof C.keys=="function"&&typeof C.get=="function")for(const de of C.keys())_.set(de,C.get(de));else throw Error("Unknown input type for opt_headers: "+String(C));C=Array.from(_.keys()).find(de=>de.toLowerCase()=="content-type"),ne=d.FormData&&h instanceof d.FormData,!(Array.prototype.indexOf.call(_t,b,void 0)>=0)||C||ne||_.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[de,Ke]of _)this.g.setRequestHeader(de,Ke);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(h),this.v=!1}catch(de){Pt(this,de)}};function Pt(h,b){h.h=!1,h.g&&(h.j=!0,h.g.abort(),h.j=!1),h.l=b,h.o=5,rt(h),zt(h)}function rt(h){h.A||(h.A=!0,Ze(h,"complete"),Ze(h,"error"))}n.abort=function(h){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=h||7,Ze(this,"complete"),Ze(this,"abort"),zt(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),zt(this,!0)),Se.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?Bt(this):this.Xa())},n.Xa=function(){Bt(this)};function Bt(h){if(h.h&&typeof u<"u"){if(h.v&&rs(h)==4)setTimeout(h.Ca.bind(h),0);else if(Ze(h,"readystatechange"),rs(h)==4){h.h=!1;try{const de=h.ca();e:switch(de){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var b=!0;break e;default:b=!1}var _;if(!(_=b)){var C;if(C=de===0){let Ke=String(h.D).match(Qt)[1]||null;!Ke&&d.self&&d.self.location&&(Ke=d.self.location.protocol.slice(0,-1)),C=!Je.test(Ke?Ke.toLowerCase():"")}_=C}if(_)Ze(h,"complete"),Ze(h,"success");else{h.o=6;try{var ne=rs(h)>2?h.g.statusText:""}catch{ne=""}h.l=ne+" ["+h.ca()+"]",rt(h)}}finally{zt(h)}}}}function zt(h,b){if(h.g){h.m&&(clearTimeout(h.m),h.m=null);const _=h.g;h.g=null,b||Ze(h,"ready");try{_.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function rs(h){return h.g?h.g.readyState:0}n.ca=function(){try{return rs(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(h){if(this.g){var b=this.g.responseText;return h&&b.indexOf(h)==0&&(b=b.substring(h.length)),Xs(b)}};function Ut(h){try{if(!h.g)return null;if("response"in h.g)return h.g.response;switch(h.F){case"":case"text":return h.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in h.g)return h.g.mozResponseArrayBuffer}return null}catch{return null}}function _s(h){const b={};h=(h.g&&rs(h)>=2&&h.g.getAllResponseHeaders()||"").split(`\r
`);for(let C=0;C<h.length;C++){if(I(h[C]))continue;var _=Ee(h[C]);const ne=_[0];if(_=_[1],typeof _!="string")continue;_=_.trim();const de=b[ne]||[];b[ne]=de,de.push(_)}ee(b,function(C){return C.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function qn(h,b,_){return _&&_.internalChannelParams&&_.internalChannelParams[h]||b}function pr(h){this.za=0,this.i=[],this.j=new ht,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=qn("failFast",!1,h),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=qn("baseRetryDelayMs",5e3,h),this.Za=qn("retryDelaySeedMs",1e4,h),this.Ta=qn("forwardChannelMaxRetries",2,h),this.va=qn("forwardChannelRequestTimeoutMs",2e4,h),this.ma=h&&h.xmlHttpFactory||void 0,this.Ua=h&&h.Rb||void 0,this.Aa=h&&h.useFetchStreams||!1,this.O=void 0,this.L=h&&h.supportsCrossDomainXhr||!1,this.M="",this.h=new P(h&&h.concurrentRequestLimit),this.Ba=new Qn,this.S=h&&h.fastHandshake||!1,this.R=h&&h.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=h&&h.Pb||!1,h&&h.ua&&this.j.ua(),h&&h.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&h&&h.detectBufferingProxy||!1,this.ia=void 0,h&&h.longPollingTimeout&&h.longPollingTimeout>0&&(this.ia=h.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=pr.prototype,n.ka=8,n.I=1,n.connect=function(h,b,_,C){ce(0),this.W=h,this.H=b||{},_&&C!==void 0&&(this.H.OSID=_,this.H.OAID=C),this.F=this.X,this.J=ua(this,null,this.W),mn(this)};function sn(h){if(Hn(h),h.I==3){var b=h.V++,_=cs(h.J);if(ds(_,"SID",h.M),ds(_,"RID",b),ds(_,"TYPE","terminate"),Xn(h,_),b=new je(h,h.j,b),b.M=2,b.A=Kn(cs(_)),_=!1,d.navigator&&d.navigator.sendBeacon)try{_=d.navigator.sendBeacon(b.A.toString(),"")}catch{}!_&&d.Image&&(new Image().src=b.A,_=!0),_||(b.g=Wu(b.j,null),b.g.ea(b.A)),b.F=Date.now(),ln(b)}ca(h)}function Zs(h){h.g&&(yr(h),h.g.cancel(),h.g=null)}function Hn(h){Zs(h),h.v&&(d.clearTimeout(h.v),h.v=null),$a(h),h.h.cancel(),h.m&&(typeof h.m=="number"&&d.clearTimeout(h.m),h.m=null)}function mn(h){if(!B(h.h)&&!h.m){h.m=!0;var b=h.Ea;ve||E(),ge||(ve(),ge=!0),R.add(b,h),h.D=0}}function Bn(h,b){return ue(h.h)>=h.h.j-(h.m?1:0)?!1:h.m?(h.i=b.G.concat(h.i),!0):h.I==1||h.I==2||h.D>=(h.Sa?0:h.Ta)?!1:(h.m=dt(y(h.Ea,h,b),sl(h,h.D)),h.D++,!0)}n.Ea=function(h){if(this.m)if(this.m=null,this.I==1){if(!h){this.V=Math.floor(Math.random()*1e5),h=this.V++;const ne=new je(this,this.j,h);let de=this.o;if(this.U&&(de?(de=L(de),Le(de,this.U)):de=this.U),this.u!==null||this.R||(ne.J=de,de=null),this.S)e:{for(var b=0,_=0;_<this.i.length;_++){t:{var C=this.i[_];if("__data__"in C.map&&(C=C.map.__data__,typeof C=="string")){C=C.length;break t}C=void 0}if(C===void 0)break;if(b+=C,b>4096){b=_;break e}if(b===4096||_===this.i.length-1){b=_+1;break e}}b=1e3}else b=1e3;b=gr(this,ne,b),_=cs(this.J),ds(_,"RID",h),ds(_,"CVER",22),this.G&&ds(_,"X-HTTP-Session-Id",this.G),Xn(this,_),de&&(this.R?b="headers="+xe(M(de))+"&"+b:this.u&&Z(_,this.u,de)),Fe(this.h,ne),this.Ra&&ds(_,"TYPE","init"),this.S?(ds(_,"$req",b),ds(_,"SID","null"),ne.U=!0,et(ne,_,null)):et(ne,_,b),this.I=2}}else this.I==3&&(h?ir(this,h):this.i.length==0||B(this.h)||ir(this))};function ir(h,b){var _;b?_=b.l:_=h.V++;const C=cs(h.J);ds(C,"SID",h.M),ds(C,"RID",_),ds(C,"AID",h.K),Xn(h,C),h.u&&h.o&&Z(C,h.u,h.o),_=new je(h,h.j,_,h.D+1),h.u===null&&(_.J=h.o),b&&(h.i=b.G.concat(h.i)),b=gr(h,_,1e3),_.H=Math.round(h.va*.5)+Math.round(h.va*.5*Math.random()),Fe(h.h,_),et(_,C,b)}function Xn(h,b){h.H&&He(h.H,function(_,C){ds(b,C,_)}),h.l&&He({},function(_,C){ds(b,C,_)})}function gr(h,b,_){_=Math.min(h.i.length,_);const C=h.l?y(h.l.Ka,h.l,h):null;e:{var ne=h.i;let Jt=-1;for(;;){const Tn=["count="+_];Jt==-1?_>0?(Jt=ne[0].g,Tn.push("ofs="+Jt)):Jt=0:Tn.push("ofs="+Jt);let Us=!0;for(let un=0;un<_;un++){var de=ne[un].g;const Xr=ne[un].map;if(de-=Jt,de<0)Jt=Math.max(0,ne[un].g-100),Us=!1;else try{de="req"+de+"_"||"";try{var Ke=Xr instanceof Map?Xr:Object.entries(Xr);for(const[Sa,da]of Ke){let ha=da;p(da)&&(ha=es(da)),Tn.push(de+Sa+"="+encodeURIComponent(ha))}}catch(Sa){throw Tn.push(de+"type="+encodeURIComponent("_badmap")),Sa}}catch{C&&C(Xr)}}if(Us){Ke=Tn.join("&");break e}}Ke=void 0}return h=h.i.splice(0,_),b.G=h,Ke}function or(h){if(!h.g&&!h.v){h.Y=1;var b=h.Da;ve||E(),ge||(ve(),ge=!0),R.add(b,h),h.A=0}}function gn(h){return h.g||h.v||h.A>=3?!1:(h.Y++,h.v=dt(y(h.Da,h),sl(h,h.A)),h.A++,!0)}n.Da=function(){if(this.v=null,Rr(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var h=4*this.T;this.j.info("BP detection timer enabled: "+h),this.B=dt(y(this.Wa,this),h)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,ce(10),Zs(this),Rr(this))};function yr(h){h.B!=null&&(d.clearTimeout(h.B),h.B=null)}function Rr(h){h.g=new je(h,h.j,"rpc",h.Y),h.u===null&&(h.g.J=h.o),h.g.P=0;var b=cs(h.na);ds(b,"RID","rpc"),ds(b,"SID",h.M),ds(b,"AID",h.K),ds(b,"CI",h.F?"0":"1"),!h.F&&h.ia&&ds(b,"TO",h.ia),ds(b,"TYPE","xmlhttp"),Xn(h,b),h.u&&h.o&&Z(b,h.u,h.o),h.O&&(h.g.H=h.O);var _=h.g;h=h.ba,_.M=1,_.A=Kn(cs(b)),_.u=null,_.R=!0,gt(_,h)}n.Va=function(){this.C!=null&&(this.C=null,Zs(this),gn(this),ce(19))};function $a(h){h.C!=null&&(d.clearTimeout(h.C),h.C=null)}function tl(h,b){var _=null;if(h.g==b){$a(h),yr(h),h.g=null;var C=2}else if(Be(h.h,b))_=b.G,tt(h.h,b),C=1;else return;if(h.I!=0){if(b.o)if(C==1){_=b.u?b.u.length:0,b=Date.now()-b.F;var ne=h.D;C=Ae(),Ze(C,new ze(C,_)),mn(h)}else or(h);else if(ne=b.m,ne==3||ne==0&&b.X>0||!(C==1&&Bn(h,b)||C==2&&gn(h)))switch(_&&_.length>0&&(b=h.h,b.i=b.i.concat(_)),ne){case 1:br(h,5);break;case 4:br(h,10);break;case 3:br(h,6);break;default:br(h,2)}}}function sl(h,b){let _=h.Qa+Math.floor(Math.random()*h.Za);return h.isActive()||(_*=2),_*b}function br(h,b){if(h.j.info("Error code "+b),b==2){var _=y(h.bb,h),C=h.Ua;const ne=!C;C=new as(C||"//www.google.com/images/cleardot.gif"),d.location&&d.location.protocol=="http"||Os(C,"https"),Kn(C),ne?Bs(C.toString(),_):zn(C.toString(),_)}else ce(2);h.I=0,h.l&&h.l.pa(b),ca(h),Hn(h)}n.bb=function(h){h?(this.j.info("Successfully pinged google.com"),ce(2)):(this.j.info("Failed to ping google.com"),ce(1))};function ca(h){if(h.I=0,h.ja=[],h.l){const b=Xe(h.h);(b.length!=0||h.i.length!=0)&&($(h.ja,b),$(h.ja,h.i),h.h.i.length=0,V(h.i),h.i.length=0),h.l.oa()}}function ua(h,b,_){var C=_ instanceof as?cs(_):new as(_);if(C.g!="")b&&(C.g=b+"."+C.g),On(C,C.u);else{var ne=d.location;C=ne.protocol,b=b?b+"."+ne.hostname:ne.hostname,ne=+ne.port;const de=new as(null);C&&Os(de,C),b&&(de.g=b),ne&&On(de,ne),_&&(de.h=_),C=de}return _=h.G,b=h.wa,_&&b&&ds(C,_,b),ds(C,"VER",h.ka),Xn(h,C),C}function Wu(h,b,_){if(b&&!h.L)throw Error("Can't create secondary domain capable XhrIo object.");return b=h.Aa&&!h.ma?new Se(new cn({ab:_})):new Se(h.ma),b.Fa(h.L),b}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Gu(){}n=Gu.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function _i(){}_i.prototype.g=function(h,b){return new vr(h,b)};function vr(h,b){Ge.call(this),this.g=new pr(b),this.l=h,this.h=b&&b.messageUrlParams||null,h=b&&b.messageHeaders||null,b&&b.clientProtocolHeaderRequired&&(h?h["X-Client-Protocol"]="webchannel":h={"X-Client-Protocol":"webchannel"}),this.g.o=h,h=b&&b.initMessageHeaders||null,b&&b.messageContentType&&(h?h["X-WebChannel-Content-Type"]=b.messageContentType:h={"X-WebChannel-Content-Type":b.messageContentType}),b&&b.sa&&(h?h["X-WebChannel-Client-Profile"]=b.sa:h={"X-WebChannel-Client-Profile":b.sa}),this.g.U=h,(h=b&&b.Qb)&&!I(h)&&(this.g.u=h),this.A=b&&b.supportsCrossDomainXhr||!1,this.v=b&&b.sendRawJson||!1,(b=b&&b.httpSessionIdParam)&&!I(b)&&(this.g.G=b,h=this.h,h!==null&&b in h&&(h=this.h,b in h&&delete h[b])),this.j=new Wa(this)}j(vr,Ge),vr.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},vr.prototype.close=function(){sn(this.g)},vr.prototype.o=function(h){var b=this.g;if(typeof h=="string"){var _={};_.__data__=h,h=_}else this.v&&(_={},_.__data__=es(h),h=_);b.i.push(new N(b.Ya++,h)),b.I==3&&mn(b)},vr.prototype.N=function(){this.g.l=null,delete this.j,sn(this.g),delete this.g,vr.Z.N.call(this)};function Ku(h){Y.call(this),h.__headers__&&(this.headers=h.__headers__,this.statusCode=h.__status__,delete h.__headers__,delete h.__status__);var b=h.__sm__;if(b){e:{for(const _ in b){h=_;break e}h=void 0}(this.i=h)&&(h=this.i,b=b!==null&&h in b?b[h]:void 0),this.data=b}else this.data=h}j(Ku,Y);function Yu(){we.call(this),this.status=1}j(Yu,we);function Wa(h){this.g=h}j(Wa,Gu),Wa.prototype.ra=function(){Ze(this.g,"a")},Wa.prototype.qa=function(h){Ze(this.g,new Ku(h))},Wa.prototype.pa=function(h){Ze(this.g,new Yu)},Wa.prototype.oa=function(){Ze(this.g,"b")},_i.prototype.createWebChannel=_i.prototype.g,vr.prototype.send=vr.prototype.o,vr.prototype.open=vr.prototype.m,vr.prototype.close=vr.prototype.close,Yw=function(){return new _i},Kw=function(){return Ae()},Gw=Ce,fg={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},ns.NO_ERROR=0,ns.TIMEOUT=8,ns.HTTP_ERROR=6,xh=ns,Cs.COMPLETE="complete",Ww=Cs,be.EventType=De,De.OPEN="a",De.CLOSE="b",De.ERROR="c",De.MESSAGE="d",Ge.prototype.listen=Ge.prototype.J,su=be,Se.prototype.listenOnce=Se.prototype.K,Se.prototype.getLastError=Se.prototype.Ha,Se.prototype.getLastErrorCode=Se.prototype.ya,Se.prototype.getStatus=Se.prototype.ca,Se.prototype.getResponseJson=Se.prototype.La,Se.prototype.getResponseText=Se.prototype.la,Se.prototype.send=Se.prototype.ea,Se.prototype.setWithCredentials=Se.prototype.Fa,$w=Se}).apply(typeof th<"u"?th:typeof self<"u"?self:typeof window<"u"?window:{});class ur{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}ur.UNAUTHENTICATED=new ur(null),ur.GOOGLE_CREDENTIALS=new ur("google-credentials-uid"),ur.FIRST_PARTY=new ur("first-party-uid"),ur.MOCK_USER=new ur("mock-user");let ac="12.8.0";function cR(n){ac=n}const Ko=new $g("@firebase/firestore");function Bl(){return Ko.logLevel}function ct(n,...e){if(Ko.logLevel<=bs.DEBUG){const t=e.map(ry);Ko.debug(`Firestore (${ac}): ${n}`,...t)}}function yi(n,...e){if(Ko.logLevel<=bs.ERROR){const t=e.map(ry);Ko.error(`Firestore (${ac}): ${n}`,...t)}}function Yl(n,...e){if(Ko.logLevel<=bs.WARN){const t=e.map(ry);Ko.warn(`Firestore (${ac}): ${n}`,...t)}}function ry(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}function Ot(n,e,t){let i="Unexpected state";typeof e=="string"?i=e:t=e,Qw(n,i,t)}function Qw(n,e,t){let i=`FIRESTORE (${ac}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{i+=" CONTEXT: "+JSON.stringify(t)}catch{i+=" CONTEXT: "+t}throw yi(i),new Error(i)}function qs(n,e,t,i){let l="Unexpected state";typeof t=="string"?l=t:i=t,n||Qw(e,l,i)}function Wt(n,e){return n}const Ne={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class nt extends Ha{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class hi{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class Xw{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class uR{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(ur.UNAUTHENTICATED)))}shutdown(){}}class dR{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class hR{constructor(e){this.t=e,this.currentUser=ur.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){qs(this.o===void 0,42304);let i=this.i;const l=g=>this.i!==i?(i=this.i,t(g)):Promise.resolve();let u=new hi;this.o=()=>{this.i++,this.currentUser=this.u(),u.resolve(),u=new hi,e.enqueueRetryable((()=>l(this.currentUser)))};const d=()=>{const g=u;e.enqueueRetryable((async()=>{await g.promise,await l(this.currentUser)}))},p=g=>{ct("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=g,this.o&&(this.auth.addAuthTokenListener(this.o),d())};this.t.onInit((g=>p(g))),setTimeout((()=>{if(!this.auth){const g=this.t.getImmediate({optional:!0});g?p(g):(ct("FirebaseAuthCredentialsProvider","Auth not yet detected"),u.resolve(),u=new hi)}}),0),d()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((i=>this.i!==e?(ct("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(qs(typeof i.accessToken=="string",31837,{l:i}),new Xw(i.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return qs(e===null||typeof e=="string",2055,{h:e}),new ur(e)}}class mR{constructor(e,t,i){this.P=e,this.T=t,this.I=i,this.type="FirstParty",this.user=ur.FIRST_PARTY,this.R=new Map}A(){return this.I?this.I():null}get headers(){this.R.set("X-Goog-AuthUser",this.P);const e=this.A();return e&&this.R.set("Authorization",e),this.T&&this.R.set("X-Goog-Iam-Authorization-Token",this.T),this.R}}class fR{constructor(e,t,i){this.P=e,this.T=t,this.I=i}getToken(){return Promise.resolve(new mR(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(ur.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class gx{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class pR{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Gr(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){qs(this.o===void 0,3512);const i=u=>{u.error!=null&&ct("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${u.error.message}`);const d=u.token!==this.m;return this.m=u.token,ct("FirebaseAppCheckTokenProvider",`Received ${d?"new":"existing"} token.`),d?t(u.token):Promise.resolve()};this.o=u=>{e.enqueueRetryable((()=>i(u)))};const l=u=>{ct("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=u,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((u=>l(u))),setTimeout((()=>{if(!this.appCheck){const u=this.V.getImmediate({optional:!0});u?l(u):ct("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new gx(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(qs(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new gx(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function gR(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let i=0;i<n;i++)t[i]=Math.floor(256*Math.random());return t}class ay{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const l=gR(40);for(let u=0;u<l.length;++u)i.length<20&&l[u]<t&&(i+=e.charAt(l[u]%62))}return i}}function vs(n,e){return n<e?-1:n>e?1:0}function pg(n,e){const t=Math.min(n.length,e.length);for(let i=0;i<t;i++){const l=n.charAt(i),u=e.charAt(i);if(l!==u)return Mp(l)===Mp(u)?vs(l,u):Mp(l)?1:-1}return vs(n.length,e.length)}const yR=55296,bR=57343;function Mp(n){const e=n.charCodeAt(0);return e>=yR&&e<=bR}function Ql(n,e,t){return n.length===e.length&&n.every(((i,l)=>t(i,e[l])))}const yx="__name__";class Ia{constructor(e,t,i){t===void 0?t=0:t>e.length&&Ot(637,{offset:t,range:e.length}),i===void 0?i=e.length-t:i>e.length-t&&Ot(1746,{length:i,range:e.length-t}),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return Ia.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Ia?e.forEach((i=>{t.push(i)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const i=Math.min(e.length,t.length);for(let l=0;l<i;l++){const u=Ia.compareSegments(e.get(l),t.get(l));if(u!==0)return u}return vs(e.length,t.length)}static compareSegments(e,t){const i=Ia.isNumericId(e),l=Ia.isNumericId(t);return i&&!l?-1:!i&&l?1:i&&l?Ia.extractNumericId(e).compare(Ia.extractNumericId(t)):pg(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return ro.fromString(e.substring(4,e.length-2))}}class nn extends Ia{construct(e,t,i){return new nn(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const i of e){if(i.indexOf("//")>=0)throw new nt(Ne.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter((l=>l.length>0)))}return new nn(t)}static emptyPath(){return new nn([])}}const vR=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class nr extends Ia{construct(e,t,i){return new nr(e,t,i)}static isValidIdentifier(e){return vR.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),nr.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===yx}static keyField(){return new nr([yx])}static fromServerFormat(e){const t=[];let i="",l=0;const u=()=>{if(i.length===0)throw new nt(Ne.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""};let d=!1;for(;l<e.length;){const p=e[l];if(p==="\\"){if(l+1===e.length)throw new nt(Ne.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const g=e[l+1];if(g!=="\\"&&g!=="."&&g!=="`")throw new nt(Ne.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=g,l+=2}else p==="`"?(d=!d,l++):p!=="."||d?(i+=p,l++):(u(),l++)}if(u(),d)throw new nt(Ne.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new nr(t)}static emptyPath(){return new nr([])}}class jt{constructor(e){this.path=e}static fromPath(e){return new jt(nn.fromString(e))}static fromName(e){return new jt(nn.fromString(e).popFirst(5))}static empty(){return new jt(nn.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&nn.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return nn.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new jt(new nn(e.slice()))}}function Jw(n,e,t){if(!t)throw new nt(Ne.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function xR(n,e,t,i){if(e===!0&&i===!0)throw new nt(Ne.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function bx(n){if(!jt.isDocumentKey(n))throw new nt(Ne.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function vx(n){if(jt.isDocumentKey(n))throw new nt(Ne.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function Zw(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function sm(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(i){return i.constructor?i.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Ot(12329,{type:typeof n})}function jr(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new nt(Ne.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=sm(n);throw new nt(Ne.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function wR(n,e){if(e<=0)throw new nt(Ne.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}function Pn(n,e){const t={typeString:n};return e&&(t.value=e),t}function Pu(n,e){if(!Zw(n))throw new nt(Ne.INVALID_ARGUMENT,"JSON must be an object");let t;for(const i in e)if(e[i]){const l=e[i].typeString,u="value"in e[i]?{value:e[i].value}:void 0;if(!(i in n)){t=`JSON missing required field: '${i}'`;break}const d=n[i];if(l&&typeof d!==l){t=`JSON field '${i}' must be a ${l}.`;break}if(u!==void 0&&d!==u.value){t=`Expected '${i}' field to equal '${u.value}'`;break}}if(t)throw new nt(Ne.INVALID_ARGUMENT,t);return!0}const xx=-62135596800,wx=1e6;class wt{static now(){return wt.fromMillis(Date.now())}static fromDate(e){return wt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),i=Math.floor((e-1e3*t)*wx);return new wt(t,i)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new nt(Ne.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new nt(Ne.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<xx)throw new nt(Ne.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new nt(Ne.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/wx}_compareTo(e){return this.seconds===e.seconds?vs(this.nanoseconds,e.nanoseconds):vs(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:wt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Pu(e,wt._jsonSchema))return new wt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-xx;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}wt._jsonSchemaVersion="firestore/timestamp/1.0",wt._jsonSchema={type:Pn("string",wt._jsonSchemaVersion),seconds:Pn("number"),nanoseconds:Pn("number")};class qt{static fromTimestamp(e){return new qt(e)}static min(){return new qt(new wt(0,0))}static max(){return new qt(new wt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const bu=-1;function _R(n,e){const t=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,l=qt.fromTimestamp(i===1e9?new wt(t+1,0):new wt(t,i));return new oo(l,jt.empty(),e)}function kR(n){return new oo(n.readTime,n.key,bu)}class oo{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new oo(qt.min(),jt.empty(),bu)}static max(){return new oo(qt.max(),jt.empty(),bu)}}function jR(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=jt.comparator(n.documentKey,e.documentKey),t!==0?t:vs(n.largestBatchId,e.largestBatchId))}const TR="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class ER{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function ic(n){if(n.code!==Ne.FAILED_PRECONDITION||n.message!==TR)throw n;ct("LocalStore","Unexpectedly lost primary lease")}class Ve{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Ot(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new Ve(((i,l)=>{this.nextCallback=u=>{this.wrapSuccess(e,u).next(i,l)},this.catchCallback=u=>{this.wrapFailure(t,u).next(i,l)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof Ve?t:Ve.resolve(t)}catch(t){return Ve.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):Ve.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):Ve.reject(t)}static resolve(e){return new Ve(((t,i)=>{t(e)}))}static reject(e){return new Ve(((t,i)=>{i(e)}))}static waitFor(e){return new Ve(((t,i)=>{let l=0,u=0,d=!1;e.forEach((p=>{++l,p.next((()=>{++u,d&&u===l&&t()}),(g=>i(g)))})),d=!0,u===l&&t()}))}static or(e){let t=Ve.resolve(!1);for(const i of e)t=t.next((l=>l?Ve.resolve(l):i()));return t}static forEach(e,t){const i=[];return e.forEach(((l,u)=>{i.push(t.call(this,l,u))})),this.waitFor(i)}static mapArray(e,t){return new Ve(((i,l)=>{const u=e.length,d=new Array(u);let p=0;for(let g=0;g<u;g++){const y=g;t(e[y]).next((w=>{d[y]=w,++p,p===u&&i(d)}),(w=>l(w)))}}))}static doWhile(e,t){return new Ve(((i,l)=>{const u=()=>{e()===!0?t().next((()=>{u()}),l):i()};u()}))}}function SR(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function oc(n){return n.name==="IndexedDbTransactionError"}class nm{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=i=>this.ae(i),this.ue=i=>t.writeSequenceNumber(i))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}nm.ce=-1;const iy=-1;function rm(n){return n==null}function Lh(n){return n===0&&1/n==-1/0}function NR(n){return typeof n=="number"&&Number.isInteger(n)&&!Lh(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}const e_="";function CR(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=_x(e)),e=RR(n.get(t),e);return _x(e)}function RR(n,e){let t=e;const i=n.length;for(let l=0;l<i;l++){const u=n.charAt(l);switch(u){case"\0":t+="";break;case e_:t+="";break;default:t+=u}}return t}function _x(n){return n+e_+""}function kx(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function go(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function t_(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}class fn{constructor(e,t){this.comparator=e,this.root=t||sr.EMPTY}insert(e,t){return new fn(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,sr.BLACK,null,null))}remove(e){return new fn(this.comparator,this.root.remove(e,this.comparator).copy(null,null,sr.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const i=this.comparator(e,t.key);if(i===0)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){const l=this.comparator(e,i.key);if(l===0)return t+i.left.size;l<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,i)=>(e(t,i),!1)))}toString(){const e=[];return this.inorderTraversal(((t,i)=>(e.push(`${t}:${i}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new sh(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new sh(this.root,e,this.comparator,!1)}getReverseIterator(){return new sh(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new sh(this.root,e,this.comparator,!0)}}class sh{constructor(e,t,i,l){this.isReverse=l,this.nodeStack=[];let u=1;for(;!e.isEmpty();)if(u=t?i(e.key,t):1,t&&l&&(u*=-1),u<0)e=this.isReverse?e.left:e.right;else{if(u===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class sr{constructor(e,t,i,l,u){this.key=e,this.value=t,this.color=i??sr.RED,this.left=l??sr.EMPTY,this.right=u??sr.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,l,u){return new sr(e??this.key,t??this.value,i??this.color,l??this.left,u??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let l=this;const u=i(e,l.key);return l=u<0?l.copy(null,null,null,l.left.insert(e,t,i),null):u===0?l.copy(null,t,null,null,null):l.copy(null,null,null,null,l.right.insert(e,t,i)),l.fixUp()}removeMin(){if(this.left.isEmpty())return sr.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,l=this;if(t(e,l.key)<0)l.left.isEmpty()||l.left.isRed()||l.left.left.isRed()||(l=l.moveRedLeft()),l=l.copy(null,null,null,l.left.remove(e,t),null);else{if(l.left.isRed()&&(l=l.rotateRight()),l.right.isEmpty()||l.right.isRed()||l.right.left.isRed()||(l=l.moveRedRight()),t(e,l.key)===0){if(l.right.isEmpty())return sr.EMPTY;i=l.right.min(),l=l.copy(i.key,i.value,null,null,l.right.removeMin())}l=l.copy(null,null,null,null,l.right.remove(e,t))}return l.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,sr.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,sr.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Ot(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Ot(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Ot(27949);return e+(this.isRed()?0:1)}}sr.EMPTY=null,sr.RED=!0,sr.BLACK=!1;sr.EMPTY=new class{constructor(){this.size=0}get key(){throw Ot(57766)}get value(){throw Ot(16141)}get color(){throw Ot(16727)}get left(){throw Ot(29726)}get right(){throw Ot(36894)}copy(e,t,i,l,u){return this}insert(e,t,i){return new sr(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Fn{constructor(e){this.comparator=e,this.data=new fn(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,i)=>(e(t),!1)))}forEachInRange(e,t){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const l=i.getNext();if(this.comparator(l.key,e[1])>=0)return;t(l.key)}}forEachWhile(e,t){let i;for(i=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new jx(this.data.getIterator())}getIteratorFrom(e){return new jx(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((i=>{t=t.add(i)})),t}isEqual(e){if(!(e instanceof Fn)||this.size!==e.size)return!1;const t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){const l=t.getNext().key,u=i.getNext().key;if(this.comparator(l,u)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new Fn(this.comparator);return t.data=e,t}}class jx{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class Yr{constructor(e){this.fields=e,e.sort(nr.comparator)}static empty(){return new Yr([])}unionWith(e){let t=new Fn(nr.comparator);for(const i of this.fields)t=t.add(i);for(const i of e)t=t.add(i);return new Yr(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Ql(this.fields,e.fields,((t,i)=>t.isEqual(i)))}}class s_ extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class rr{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(l){try{return atob(l)}catch(u){throw typeof DOMException<"u"&&u instanceof DOMException?new s_("Invalid base64 string: "+u):u}})(e);return new rr(t)}static fromUint8Array(e){const t=(function(l){let u="";for(let d=0;d<l.length;++d)u+=String.fromCharCode(l[d]);return u})(e);return new rr(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const i=new Uint8Array(t.length);for(let l=0;l<t.length;l++)i[l]=t.charCodeAt(l);return i})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return vs(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}rr.EMPTY_BYTE_STRING=new rr("");const AR=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function lo(n){if(qs(!!n,39018),typeof n=="string"){let e=0;const t=AR.exec(n);if(qs(!!t,46558,{timestamp:n}),t[1]){let l=t[1];l=(l+"000000000").substr(0,9),e=Number(l)}const i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:Nn(n.seconds),nanos:Nn(n.nanos)}}function Nn(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function co(n){return typeof n=="string"?rr.fromBase64String(n):rr.fromUint8Array(n)}const n_="server_timestamp",r_="__type__",a_="__previous_value__",i_="__local_write_time__";function oy(n){return(n?.mapValue?.fields||{})[r_]?.stringValue===n_}function am(n){const e=n.mapValue.fields[a_];return oy(e)?am(e):e}function vu(n){const e=lo(n.mapValue.fields[i_].timestampValue);return new wt(e.seconds,e.nanos)}class MR{constructor(e,t,i,l,u,d,p,g,y,w,j){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=l,this.ssl=u,this.forceLongPolling=d,this.autoDetectLongPolling=p,this.longPollingOptions=g,this.useFetchStreams=y,this.isUsingEmulator=w,this.apiKey=j}}const Oh="(default)";class xu{constructor(e,t){this.projectId=e,this.database=t||Oh}static empty(){return new xu("","")}get isDefaultDatabase(){return this.database===Oh}isEqual(e){return e instanceof xu&&e.projectId===this.projectId&&e.database===this.database}}function IR(n,e){if(!Object.prototype.hasOwnProperty.apply(n.options,["projectId"]))throw new nt(Ne.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new xu(n.options.projectId,e)}const o_="__type__",DR="__max__",nh={mapValue:{}},l_="__vector__",Vh="value";function uo(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?oy(n)?4:LR(n)?9007199254740991:PR(n)?10:11:Ot(28295,{value:n})}function za(n,e){if(n===e)return!0;const t=uo(n);if(t!==uo(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return vu(n).isEqual(vu(e));case 3:return(function(l,u){if(typeof l.timestampValue=="string"&&typeof u.timestampValue=="string"&&l.timestampValue.length===u.timestampValue.length)return l.timestampValue===u.timestampValue;const d=lo(l.timestampValue),p=lo(u.timestampValue);return d.seconds===p.seconds&&d.nanos===p.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(l,u){return co(l.bytesValue).isEqual(co(u.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(l,u){return Nn(l.geoPointValue.latitude)===Nn(u.geoPointValue.latitude)&&Nn(l.geoPointValue.longitude)===Nn(u.geoPointValue.longitude)})(n,e);case 2:return(function(l,u){if("integerValue"in l&&"integerValue"in u)return Nn(l.integerValue)===Nn(u.integerValue);if("doubleValue"in l&&"doubleValue"in u){const d=Nn(l.doubleValue),p=Nn(u.doubleValue);return d===p?Lh(d)===Lh(p):isNaN(d)&&isNaN(p)}return!1})(n,e);case 9:return Ql(n.arrayValue.values||[],e.arrayValue.values||[],za);case 10:case 11:return(function(l,u){const d=l.mapValue.fields||{},p=u.mapValue.fields||{};if(kx(d)!==kx(p))return!1;for(const g in d)if(d.hasOwnProperty(g)&&(p[g]===void 0||!za(d[g],p[g])))return!1;return!0})(n,e);default:return Ot(52216,{left:n})}}function wu(n,e){return(n.values||[]).find((t=>za(t,e)))!==void 0}function Xl(n,e){if(n===e)return 0;const t=uo(n),i=uo(e);if(t!==i)return vs(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return vs(n.booleanValue,e.booleanValue);case 2:return(function(u,d){const p=Nn(u.integerValue||u.doubleValue),g=Nn(d.integerValue||d.doubleValue);return p<g?-1:p>g?1:p===g?0:isNaN(p)?isNaN(g)?0:-1:1})(n,e);case 3:return Tx(n.timestampValue,e.timestampValue);case 4:return Tx(vu(n),vu(e));case 5:return pg(n.stringValue,e.stringValue);case 6:return(function(u,d){const p=co(u),g=co(d);return p.compareTo(g)})(n.bytesValue,e.bytesValue);case 7:return(function(u,d){const p=u.split("/"),g=d.split("/");for(let y=0;y<p.length&&y<g.length;y++){const w=vs(p[y],g[y]);if(w!==0)return w}return vs(p.length,g.length)})(n.referenceValue,e.referenceValue);case 8:return(function(u,d){const p=vs(Nn(u.latitude),Nn(d.latitude));return p!==0?p:vs(Nn(u.longitude),Nn(d.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return Ex(n.arrayValue,e.arrayValue);case 10:return(function(u,d){const p=u.fields||{},g=d.fields||{},y=p[Vh]?.arrayValue,w=g[Vh]?.arrayValue,j=vs(y?.values?.length||0,w?.values?.length||0);return j!==0?j:Ex(y,w)})(n.mapValue,e.mapValue);case 11:return(function(u,d){if(u===nh.mapValue&&d===nh.mapValue)return 0;if(u===nh.mapValue)return 1;if(d===nh.mapValue)return-1;const p=u.fields||{},g=Object.keys(p),y=d.fields||{},w=Object.keys(y);g.sort(),w.sort();for(let j=0;j<g.length&&j<w.length;++j){const T=pg(g[j],w[j]);if(T!==0)return T;const V=Xl(p[g[j]],y[w[j]]);if(V!==0)return V}return vs(g.length,w.length)})(n.mapValue,e.mapValue);default:throw Ot(23264,{he:t})}}function Tx(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return vs(n,e);const t=lo(n),i=lo(e),l=vs(t.seconds,i.seconds);return l!==0?l:vs(t.nanos,i.nanos)}function Ex(n,e){const t=n.values||[],i=e.values||[];for(let l=0;l<t.length&&l<i.length;++l){const u=Xl(t[l],i[l]);if(u)return u}return vs(t.length,i.length)}function Jl(n){return gg(n)}function gg(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const i=lo(t);return`time(${i.seconds},${i.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return co(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return jt.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let i="[",l=!0;for(const u of t.values||[])l?l=!1:i+=",",i+=gg(u);return i+"]"})(n.arrayValue):"mapValue"in n?(function(t){const i=Object.keys(t.fields||{}).sort();let l="{",u=!0;for(const d of i)u?u=!1:l+=",",l+=`${d}:${gg(t.fields[d])}`;return l+"}"})(n.mapValue):Ot(61005,{value:n})}function wh(n){switch(uo(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=am(n);return e?16+wh(e):16;case 5:return 2*n.stringValue.length;case 6:return co(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(i){return(i.values||[]).reduce(((l,u)=>l+wh(u)),0)})(n.arrayValue);case 10:case 11:return(function(i){let l=0;return go(i.fields,((u,d)=>{l+=u.length+wh(d)})),l})(n.mapValue);default:throw Ot(13486,{value:n})}}function Sx(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function yg(n){return!!n&&"integerValue"in n}function ly(n){return!!n&&"arrayValue"in n}function Nx(n){return!!n&&"nullValue"in n}function Cx(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function _h(n){return!!n&&"mapValue"in n}function PR(n){return(n?.mapValue?.fields||{})[o_]?.stringValue===l_}function lu(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return go(n.mapValue.fields,((t,i)=>e.mapValue.fields[t]=lu(i))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=lu(n.arrayValue.values[t]);return e}return{...n}}function LR(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===DR}class Or{constructor(e){this.value=e}static empty(){return new Or({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!_h(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=lu(t)}setAll(e){let t=nr.emptyPath(),i={},l=[];e.forEach(((d,p)=>{if(!t.isImmediateParentOf(p)){const g=this.getFieldsMap(t);this.applyChanges(g,i,l),i={},l=[],t=p.popLast()}d?i[p.lastSegment()]=lu(d):l.push(p.lastSegment())}));const u=this.getFieldsMap(t);this.applyChanges(u,i,l)}delete(e){const t=this.field(e.popLast());_h(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return za(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let l=t.mapValue.fields[e.get(i)];_h(l)&&l.mapValue.fields||(l={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=l),t=l}return t.mapValue.fields}applyChanges(e,t,i){go(t,((l,u)=>e[l]=u));for(const l of i)delete e[l]}clone(){return new Or(lu(this.value))}}function c_(n){const e=[];return go(n.fields,((t,i)=>{const l=new nr([t]);if(_h(i)){const u=c_(i.mapValue).fields;if(u.length===0)e.push(l);else for(const d of u)e.push(l.child(d))}else e.push(l)})),new Yr(e)}class dr{constructor(e,t,i,l,u,d,p){this.key=e,this.documentType=t,this.version=i,this.readTime=l,this.createTime=u,this.data=d,this.documentState=p}static newInvalidDocument(e){return new dr(e,0,qt.min(),qt.min(),qt.min(),Or.empty(),0)}static newFoundDocument(e,t,i,l){return new dr(e,1,t,qt.min(),i,l,0)}static newNoDocument(e,t){return new dr(e,2,t,qt.min(),qt.min(),Or.empty(),0)}static newUnknownDocument(e,t){return new dr(e,3,t,qt.min(),qt.min(),Or.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(qt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Or.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Or.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=qt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof dr&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new dr(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Bh{constructor(e,t){this.position=e,this.inclusive=t}}function Rx(n,e,t){let i=0;for(let l=0;l<n.position.length;l++){const u=e[l],d=n.position[l];if(u.field.isKeyField()?i=jt.comparator(jt.fromName(d.referenceValue),t.key):i=Xl(d,t.data.field(u.field)),u.dir==="desc"&&(i*=-1),i!==0)break}return i}function Ax(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!za(n.position[t],e.position[t]))return!1;return!0}class _u{constructor(e,t="asc"){this.field=e,this.dir=t}}function OR(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}class u_{}class Dn extends u_{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,i):new BR(e,t,i):t==="array-contains"?new zR(e,i):t==="in"?new qR(e,i):t==="not-in"?new HR(e,i):t==="array-contains-any"?new $R(e,i):new Dn(e,t,i)}static createKeyFieldInFilter(e,t,i){return t==="in"?new UR(e,i):new FR(e,i)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Xl(t,this.value)):t!==null&&uo(this.value)===uo(t)&&this.matchesComparison(Xl(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Ot(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class _a extends u_{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new _a(e,t)}matches(e){return d_(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function d_(n){return n.op==="and"}function h_(n){return VR(n)&&d_(n)}function VR(n){for(const e of n.filters)if(e instanceof _a)return!1;return!0}function bg(n){if(n instanceof Dn)return n.field.canonicalString()+n.op.toString()+Jl(n.value);if(h_(n))return n.filters.map((e=>bg(e))).join(",");{const e=n.filters.map((t=>bg(t))).join(",");return`${n.op}(${e})`}}function m_(n,e){return n instanceof Dn?(function(i,l){return l instanceof Dn&&i.op===l.op&&i.field.isEqual(l.field)&&za(i.value,l.value)})(n,e):n instanceof _a?(function(i,l){return l instanceof _a&&i.op===l.op&&i.filters.length===l.filters.length?i.filters.reduce(((u,d,p)=>u&&m_(d,l.filters[p])),!0):!1})(n,e):void Ot(19439)}function f_(n){return n instanceof Dn?(function(t){return`${t.field.canonicalString()} ${t.op} ${Jl(t.value)}`})(n):n instanceof _a?(function(t){return t.op.toString()+" {"+t.getFilters().map(f_).join(" ,")+"}"})(n):"Filter"}class BR extends Dn{constructor(e,t,i){super(e,t,i),this.key=jt.fromName(i.referenceValue)}matches(e){const t=jt.comparator(e.key,this.key);return this.matchesComparison(t)}}class UR extends Dn{constructor(e,t){super(e,"in",t),this.keys=p_("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class FR extends Dn{constructor(e,t){super(e,"not-in",t),this.keys=p_("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function p_(n,e){return(e.arrayValue?.values||[]).map((t=>jt.fromName(t.referenceValue)))}class zR extends Dn{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return ly(t)&&wu(t.arrayValue,this.value)}}class qR extends Dn{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&wu(this.value.arrayValue,t)}}class HR extends Dn{constructor(e,t){super(e,"not-in",t)}matches(e){if(wu(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!wu(this.value.arrayValue,t)}}class $R extends Dn{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!ly(t)||!t.arrayValue.values)&&t.arrayValue.values.some((i=>wu(this.value.arrayValue,i)))}}class WR{constructor(e,t=null,i=[],l=[],u=null,d=null,p=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=l,this.limit=u,this.startAt=d,this.endAt=p,this.Te=null}}function Mx(n,e=null,t=[],i=[],l=null,u=null,d=null){return new WR(n,e,t,i,l,u,d)}function cy(n){const e=Wt(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((i=>bg(i))).join(","),t+="|ob:",t+=e.orderBy.map((i=>(function(u){return u.field.canonicalString()+u.dir})(i))).join(","),rm(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((i=>Jl(i))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((i=>Jl(i))).join(",")),e.Te=t}return e.Te}function uy(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!OR(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!m_(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!Ax(n.startAt,e.startAt)&&Ax(n.endAt,e.endAt)}function vg(n){return jt.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}class lc{constructor(e,t=null,i=[],l=[],u=null,d="F",p=null,g=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=l,this.limit=u,this.limitType=d,this.startAt=p,this.endAt=g,this.Ie=null,this.Ee=null,this.Re=null,this.startAt,this.endAt}}function GR(n,e,t,i,l,u,d,p){return new lc(n,e,t,i,l,u,d,p)}function im(n){return new lc(n)}function Ix(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function KR(n){return jt.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function g_(n){return n.collectionGroup!==null}function cu(n){const e=Wt(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const u of e.explicitOrderBy)e.Ie.push(u),t.add(u.field.canonicalString());const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(d){let p=new Fn(nr.comparator);return d.filters.forEach((g=>{g.getFlattenedFilters().forEach((y=>{y.isInequality()&&(p=p.add(y.field))}))})),p})(e).forEach((u=>{t.has(u.canonicalString())||u.isKeyField()||e.Ie.push(new _u(u,i))})),t.has(nr.keyField().canonicalString())||e.Ie.push(new _u(nr.keyField(),i))}return e.Ie}function Ba(n){const e=Wt(n);return e.Ee||(e.Ee=YR(e,cu(n))),e.Ee}function YR(n,e){if(n.limitType==="F")return Mx(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((l=>{const u=l.dir==="desc"?"asc":"desc";return new _u(l.field,u)}));const t=n.endAt?new Bh(n.endAt.position,n.endAt.inclusive):null,i=n.startAt?new Bh(n.startAt.position,n.startAt.inclusive):null;return Mx(n.path,n.collectionGroup,e,n.filters,n.limit,t,i)}}function xg(n,e){const t=n.filters.concat([e]);return new lc(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function QR(n,e){const t=n.explicitOrderBy.concat([e]);return new lc(n.path,n.collectionGroup,t,n.filters.slice(),n.limit,n.limitType,n.startAt,n.endAt)}function Uh(n,e,t){return new lc(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function om(n,e){return uy(Ba(n),Ba(e))&&n.limitType===e.limitType}function y_(n){return`${cy(Ba(n))}|lt:${n.limitType}`}function Ul(n){return`Query(target=${(function(t){let i=t.path.canonicalString();return t.collectionGroup!==null&&(i+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(i+=`, filters: [${t.filters.map((l=>f_(l))).join(", ")}]`),rm(t.limit)||(i+=", limit: "+t.limit),t.orderBy.length>0&&(i+=`, orderBy: [${t.orderBy.map((l=>(function(d){return`${d.field.canonicalString()} (${d.dir})`})(l))).join(", ")}]`),t.startAt&&(i+=", startAt: ",i+=t.startAt.inclusive?"b:":"a:",i+=t.startAt.position.map((l=>Jl(l))).join(",")),t.endAt&&(i+=", endAt: ",i+=t.endAt.inclusive?"a:":"b:",i+=t.endAt.position.map((l=>Jl(l))).join(",")),`Target(${i})`})(Ba(n))}; limitType=${n.limitType})`}function lm(n,e){return e.isFoundDocument()&&(function(i,l){const u=l.key.path;return i.collectionGroup!==null?l.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(u):jt.isDocumentKey(i.path)?i.path.isEqual(u):i.path.isImmediateParentOf(u)})(n,e)&&(function(i,l){for(const u of cu(i))if(!u.field.isKeyField()&&l.data.field(u.field)===null)return!1;return!0})(n,e)&&(function(i,l){for(const u of i.filters)if(!u.matches(l))return!1;return!0})(n,e)&&(function(i,l){return!(i.startAt&&!(function(d,p,g){const y=Rx(d,p,g);return d.inclusive?y<=0:y<0})(i.startAt,cu(i),l)||i.endAt&&!(function(d,p,g){const y=Rx(d,p,g);return d.inclusive?y>=0:y>0})(i.endAt,cu(i),l))})(n,e)}function XR(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function b_(n){return(e,t)=>{let i=!1;for(const l of cu(n)){const u=JR(l,e,t);if(u!==0)return u;i=i||l.field.isKeyField()}return 0}}function JR(n,e,t){const i=n.field.isKeyField()?jt.comparator(e.key,t.key):(function(u,d,p){const g=d.data.field(u),y=p.data.field(u);return g!==null&&y!==null?Xl(g,y):Ot(42886)})(n.field,e,t);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return Ot(19790,{direction:n.dir})}}class Zo{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i!==void 0){for(const[l,u]of i)if(this.equalsFn(l,e))return u}}has(e){return this.get(e)!==void 0}set(e,t){const i=this.mapKeyFn(e),l=this.inner[i];if(l===void 0)return this.inner[i]=[[e,t]],void this.innerSize++;for(let u=0;u<l.length;u++)if(this.equalsFn(l[u][0],e))return void(l[u]=[e,t]);l.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i===void 0)return!1;for(let l=0;l<i.length;l++)if(this.equalsFn(i[l][0],e))return i.length===1?delete this.inner[t]:i.splice(l,1),this.innerSize--,!0;return!1}forEach(e){go(this.inner,((t,i)=>{for(const[l,u]of i)e(l,u)}))}isEmpty(){return t_(this.inner)}size(){return this.innerSize}}const ZR=new fn(jt.comparator);function bi(){return ZR}const v_=new fn(jt.comparator);function nu(...n){let e=v_;for(const t of n)e=e.insert(t.key,t);return e}function x_(n){let e=v_;return n.forEach(((t,i)=>e=e.insert(t,i.overlayedDocument))),e}function Vo(){return uu()}function w_(){return uu()}function uu(){return new Zo((n=>n.toString()),((n,e)=>n.isEqual(e)))}const eA=new fn(jt.comparator),tA=new Fn(jt.comparator);function xs(...n){let e=tA;for(const t of n)e=e.add(t);return e}const sA=new Fn(vs);function nA(){return sA}function dy(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Lh(e)?"-0":e}}function __(n){return{integerValue:""+n}}function k_(n,e){return NR(e)?__(e):dy(n,e)}class cm{constructor(){this._=void 0}}function rA(n,e,t){return n instanceof ku?(function(l,u){const d={fields:{[r_]:{stringValue:n_},[i_]:{timestampValue:{seconds:l.seconds,nanos:l.nanoseconds}}}};return u&&oy(u)&&(u=am(u)),u&&(d.fields[a_]=u),{mapValue:d}})(t,e):n instanceof ju?T_(n,e):n instanceof Tu?E_(n,e):(function(l,u){const d=j_(l,u),p=Dx(d)+Dx(l.Ae);return yg(d)&&yg(l.Ae)?__(p):dy(l.serializer,p)})(n,e)}function aA(n,e,t){return n instanceof ju?T_(n,e):n instanceof Tu?E_(n,e):t}function j_(n,e){return n instanceof Eu?(function(i){return yg(i)||(function(u){return!!u&&"doubleValue"in u})(i)})(e)?e:{integerValue:0}:null}class ku extends cm{}class ju extends cm{constructor(e){super(),this.elements=e}}function T_(n,e){const t=S_(e);for(const i of n.elements)t.some((l=>za(l,i)))||t.push(i);return{arrayValue:{values:t}}}class Tu extends cm{constructor(e){super(),this.elements=e}}function E_(n,e){let t=S_(e);for(const i of n.elements)t=t.filter((l=>!za(l,i)));return{arrayValue:{values:t}}}class Eu extends cm{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function Dx(n){return Nn(n.integerValue||n.doubleValue)}function S_(n){return ly(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class N_{constructor(e,t){this.field=e,this.transform=t}}function iA(n,e){return n.field.isEqual(e.field)&&(function(i,l){return i instanceof ju&&l instanceof ju||i instanceof Tu&&l instanceof Tu?Ql(i.elements,l.elements,za):i instanceof Eu&&l instanceof Eu?za(i.Ae,l.Ae):i instanceof ku&&l instanceof ku})(n.transform,e.transform)}class oA{constructor(e,t){this.version=e,this.transformResults=t}}class Tr{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Tr}static exists(e){return new Tr(void 0,e)}static updateTime(e){return new Tr(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function kh(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class um{}function C_(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new dm(n.key,Tr.none()):new Lu(n.key,n.data,Tr.none());{const t=n.data,i=Or.empty();let l=new Fn(nr.comparator);for(let u of e.fields)if(!l.has(u)){let d=t.field(u);d===null&&u.length>1&&(u=u.popLast(),d=t.field(u)),d===null?i.delete(u):i.set(u,d),l=l.add(u)}return new yo(n.key,i,new Yr(l.toArray()),Tr.none())}}function lA(n,e,t){n instanceof Lu?(function(l,u,d){const p=l.value.clone(),g=Lx(l.fieldTransforms,u,d.transformResults);p.setAll(g),u.convertToFoundDocument(d.version,p).setHasCommittedMutations()})(n,e,t):n instanceof yo?(function(l,u,d){if(!kh(l.precondition,u))return void u.convertToUnknownDocument(d.version);const p=Lx(l.fieldTransforms,u,d.transformResults),g=u.data;g.setAll(R_(l)),g.setAll(p),u.convertToFoundDocument(d.version,g).setHasCommittedMutations()})(n,e,t):(function(l,u,d){u.convertToNoDocument(d.version).setHasCommittedMutations()})(0,e,t)}function du(n,e,t,i){return n instanceof Lu?(function(u,d,p,g){if(!kh(u.precondition,d))return p;const y=u.value.clone(),w=Ox(u.fieldTransforms,g,d);return y.setAll(w),d.convertToFoundDocument(d.version,y).setHasLocalMutations(),null})(n,e,t,i):n instanceof yo?(function(u,d,p,g){if(!kh(u.precondition,d))return p;const y=Ox(u.fieldTransforms,g,d),w=d.data;return w.setAll(R_(u)),w.setAll(y),d.convertToFoundDocument(d.version,w).setHasLocalMutations(),p===null?null:p.unionWith(u.fieldMask.fields).unionWith(u.fieldTransforms.map((j=>j.field)))})(n,e,t,i):(function(u,d,p){return kh(u.precondition,d)?(d.convertToNoDocument(d.version).setHasLocalMutations(),null):p})(n,e,t)}function cA(n,e){let t=null;for(const i of n.fieldTransforms){const l=e.data.field(i.field),u=j_(i.transform,l||null);u!=null&&(t===null&&(t=Or.empty()),t.set(i.field,u))}return t||null}function Px(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(i,l){return i===void 0&&l===void 0||!(!i||!l)&&Ql(i,l,((u,d)=>iA(u,d)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class Lu extends um{constructor(e,t,i,l=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=l,this.type=0}getFieldMask(){return null}}class yo extends um{constructor(e,t,i,l,u=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=l,this.fieldTransforms=u,this.type=1}getFieldMask(){return this.fieldMask}}function R_(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const i=n.data.field(t);e.set(t,i)}})),e}function Lx(n,e,t){const i=new Map;qs(n.length===t.length,32656,{Ve:t.length,de:n.length});for(let l=0;l<t.length;l++){const u=n[l],d=u.transform,p=e.data.field(u.field);i.set(u.field,aA(d,p,t[l]))}return i}function Ox(n,e,t){const i=new Map;for(const l of n){const u=l.transform,d=t.data.field(l.field);i.set(l.field,rA(u,d,e))}return i}class dm extends um{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class uA extends um{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class dA{constructor(e,t,i,l){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=l}applyToRemoteDocument(e,t){const i=t.mutationResults;for(let l=0;l<this.mutations.length;l++){const u=this.mutations[l];u.key.isEqual(e.key)&&lA(u,e,i[l])}}applyToLocalView(e,t){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(t=du(i,e,t,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(t=du(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const i=w_();return this.mutations.forEach((l=>{const u=e.get(l.key),d=u.overlayedDocument;let p=this.applyToLocalView(d,u.mutatedFields);p=t.has(l.key)?null:p;const g=C_(d,p);g!==null&&i.set(l.key,g),d.isValidDocument()||d.convertToNoDocument(qt.min())})),i}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),xs())}isEqual(e){return this.batchId===e.batchId&&Ql(this.mutations,e.mutations,((t,i)=>Px(t,i)))&&Ql(this.baseMutations,e.baseMutations,((t,i)=>Px(t,i)))}}class hy{constructor(e,t,i,l){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=l}static from(e,t,i){qs(e.mutations.length===i.length,58842,{me:e.mutations.length,fe:i.length});let l=(function(){return eA})();const u=e.mutations;for(let d=0;d<u.length;d++)l=l.insert(u[d].key,i[d].version);return new hy(e,t,i,l)}}class hA{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class mA{constructor(e,t){this.count=e,this.unchangedNames=t}}var In,Es;function fA(n){switch(n){case Ne.OK:return Ot(64938);case Ne.CANCELLED:case Ne.UNKNOWN:case Ne.DEADLINE_EXCEEDED:case Ne.RESOURCE_EXHAUSTED:case Ne.INTERNAL:case Ne.UNAVAILABLE:case Ne.UNAUTHENTICATED:return!1;case Ne.INVALID_ARGUMENT:case Ne.NOT_FOUND:case Ne.ALREADY_EXISTS:case Ne.PERMISSION_DENIED:case Ne.FAILED_PRECONDITION:case Ne.ABORTED:case Ne.OUT_OF_RANGE:case Ne.UNIMPLEMENTED:case Ne.DATA_LOSS:return!0;default:return Ot(15467,{code:n})}}function A_(n){if(n===void 0)return yi("GRPC error has no .code"),Ne.UNKNOWN;switch(n){case In.OK:return Ne.OK;case In.CANCELLED:return Ne.CANCELLED;case In.UNKNOWN:return Ne.UNKNOWN;case In.DEADLINE_EXCEEDED:return Ne.DEADLINE_EXCEEDED;case In.RESOURCE_EXHAUSTED:return Ne.RESOURCE_EXHAUSTED;case In.INTERNAL:return Ne.INTERNAL;case In.UNAVAILABLE:return Ne.UNAVAILABLE;case In.UNAUTHENTICATED:return Ne.UNAUTHENTICATED;case In.INVALID_ARGUMENT:return Ne.INVALID_ARGUMENT;case In.NOT_FOUND:return Ne.NOT_FOUND;case In.ALREADY_EXISTS:return Ne.ALREADY_EXISTS;case In.PERMISSION_DENIED:return Ne.PERMISSION_DENIED;case In.FAILED_PRECONDITION:return Ne.FAILED_PRECONDITION;case In.ABORTED:return Ne.ABORTED;case In.OUT_OF_RANGE:return Ne.OUT_OF_RANGE;case In.UNIMPLEMENTED:return Ne.UNIMPLEMENTED;case In.DATA_LOSS:return Ne.DATA_LOSS;default:return Ot(39323,{code:n})}}(Es=In||(In={}))[Es.OK=0]="OK",Es[Es.CANCELLED=1]="CANCELLED",Es[Es.UNKNOWN=2]="UNKNOWN",Es[Es.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Es[Es.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Es[Es.NOT_FOUND=5]="NOT_FOUND",Es[Es.ALREADY_EXISTS=6]="ALREADY_EXISTS",Es[Es.PERMISSION_DENIED=7]="PERMISSION_DENIED",Es[Es.UNAUTHENTICATED=16]="UNAUTHENTICATED",Es[Es.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Es[Es.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Es[Es.ABORTED=10]="ABORTED",Es[Es.OUT_OF_RANGE=11]="OUT_OF_RANGE",Es[Es.UNIMPLEMENTED=12]="UNIMPLEMENTED",Es[Es.INTERNAL=13]="INTERNAL",Es[Es.UNAVAILABLE=14]="UNAVAILABLE",Es[Es.DATA_LOSS=15]="DATA_LOSS";function pA(){return new TextEncoder}const gA=new ro([4294967295,4294967295],0);function Vx(n){const e=pA().encode(n),t=new Hw;return t.update(e),new Uint8Array(t.digest())}function Bx(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),i=e.getUint32(4,!0),l=e.getUint32(8,!0),u=e.getUint32(12,!0);return[new ro([t,i],0),new ro([l,u],0)]}class my{constructor(e,t,i){if(this.bitmap=e,this.padding=t,this.hashCount=i,t<0||t>=8)throw new ru(`Invalid padding: ${t}`);if(i<0)throw new ru(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new ru(`Invalid hash count: ${i}`);if(e.length===0&&t!==0)throw new ru(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=ro.fromNumber(this.ge)}ye(e,t,i){let l=e.add(t.multiply(ro.fromNumber(i)));return l.compare(gA)===1&&(l=new ro([l.getBits(0),l.getBits(1)],0)),l.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=Vx(e),[i,l]=Bx(t);for(let u=0;u<this.hashCount;u++){const d=this.ye(i,l,u);if(!this.we(d))return!1}return!0}static create(e,t,i){const l=e%8==0?0:8-e%8,u=new Uint8Array(Math.ceil(e/8)),d=new my(u,l,t);return i.forEach((p=>d.insert(p))),d}insert(e){if(this.ge===0)return;const t=Vx(e),[i,l]=Bx(t);for(let u=0;u<this.hashCount;u++){const d=this.ye(i,l,u);this.be(d)}}be(e){const t=Math.floor(e/8),i=e%8;this.bitmap[t]|=1<<i}}class ru extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class hm{constructor(e,t,i,l,u){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=i,this.documentUpdates=l,this.resolvedLimboDocuments=u}static createSynthesizedRemoteEventForCurrentChange(e,t,i){const l=new Map;return l.set(e,Ou.createSynthesizedTargetChangeForCurrentChange(e,t,i)),new hm(qt.min(),l,new fn(vs),bi(),xs())}}class Ou{constructor(e,t,i,l,u){this.resumeToken=e,this.current=t,this.addedDocuments=i,this.modifiedDocuments=l,this.removedDocuments=u}static createSynthesizedTargetChangeForCurrentChange(e,t,i){return new Ou(i,t,xs(),xs(),xs())}}class jh{constructor(e,t,i,l){this.Se=e,this.removedTargetIds=t,this.key=i,this.De=l}}class M_{constructor(e,t){this.targetId=e,this.Ce=t}}class I_{constructor(e,t,i=rr.EMPTY_BYTE_STRING,l=null){this.state=e,this.targetIds=t,this.resumeToken=i,this.cause=l}}class Ux{constructor(){this.ve=0,this.Fe=Fx(),this.Me=rr.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=xs(),t=xs(),i=xs();return this.Fe.forEach(((l,u)=>{switch(u){case 0:e=e.add(l);break;case 2:t=t.add(l);break;case 1:i=i.add(l);break;default:Ot(38017,{changeType:u})}})),new Ou(this.Me,this.xe,e,t,i)}Ke(){this.Oe=!1,this.Fe=Fx()}qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}Ue(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}$e(){this.ve+=1}We(){this.ve-=1,qs(this.ve>=0,3241,{ve:this.ve})}Qe(){this.Oe=!0,this.xe=!0}}class yA{constructor(e){this.Ge=e,this.ze=new Map,this.je=bi(),this.He=rh(),this.Je=rh(),this.Ze=new fn(vs)}Xe(e){for(const t of e.Se)e.De&&e.De.isFoundDocument()?this.Ye(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const i=this.nt(t);switch(e.state){case 0:this.rt(t)&&i.Le(e.resumeToken);break;case 1:i.We(),i.Ne||i.Ke(),i.Le(e.resumeToken);break;case 2:i.We(),i.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(i.Qe(),i.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),i.Le(e.resumeToken));break;default:Ot(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((i,l)=>{this.rt(l)&&t(l)}))}st(e){const t=e.targetId,i=e.Ce.count,l=this.ot(t);if(l){const u=l.target;if(vg(u))if(i===0){const d=new jt(u.path);this.et(t,d,dr.newNoDocument(d,qt.min()))}else qs(i===1,20013,{expectedCount:i});else{const d=this._t(t);if(d!==i){const p=this.ut(e),g=p?this.ct(p,e,d):1;if(g!==0){this.it(t);const y=g===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(t,y)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:i="",padding:l=0},hashCount:u=0}=t;let d,p;try{d=co(i).toUint8Array()}catch(g){if(g instanceof s_)return Yl("Decoding the base64 bloom filter in existence filter failed ("+g.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw g}try{p=new my(d,l,u)}catch(g){return Yl(g instanceof ru?"BloomFilter error: ":"Applying bloom filter failed: ",g),null}return p.ge===0?null:p}ct(e,t,i){return t.Ce.count===i-this.Pt(e,t.targetId)?0:2}Pt(e,t){const i=this.Ge.getRemoteKeysForTarget(t);let l=0;return i.forEach((u=>{const d=this.Ge.ht(),p=`projects/${d.projectId}/databases/${d.database}/documents/${u.path.canonicalString()}`;e.mightContain(p)||(this.et(t,u,null),l++)})),l}Tt(e){const t=new Map;this.ze.forEach(((u,d)=>{const p=this.ot(d);if(p){if(u.current&&vg(p.target)){const g=new jt(p.target.path);this.It(g).has(d)||this.Et(d,g)||this.et(d,g,dr.newNoDocument(g,e))}u.Be&&(t.set(d,u.ke()),u.Ke())}}));let i=xs();this.Je.forEach(((u,d)=>{let p=!0;d.forEachWhile((g=>{const y=this.ot(g);return!y||y.purpose==="TargetPurposeLimboResolution"||(p=!1,!1)})),p&&(i=i.add(u))})),this.je.forEach(((u,d)=>d.setReadTime(e)));const l=new hm(e,t,this.Ze,this.je,i);return this.je=bi(),this.He=rh(),this.Je=rh(),this.Ze=new fn(vs),l}Ye(e,t){if(!this.rt(e))return;const i=this.Et(e,t.key)?2:0;this.nt(e).qe(t.key,i),this.je=this.je.insert(t.key,t),this.He=this.He.insert(t.key,this.It(t.key).add(e)),this.Je=this.Je.insert(t.key,this.Rt(t.key).add(e))}et(e,t,i){if(!this.rt(e))return;const l=this.nt(e);this.Et(e,t)?l.qe(t,1):l.Ue(t),this.Je=this.Je.insert(t,this.Rt(t).delete(e)),this.Je=this.Je.insert(t,this.Rt(t).add(e)),i&&(this.je=this.je.insert(t,i))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.nt(e).$e()}nt(e){let t=this.ze.get(e);return t||(t=new Ux,this.ze.set(e,t)),t}Rt(e){let t=this.Je.get(e);return t||(t=new Fn(vs),this.Je=this.Je.insert(e,t)),t}It(e){let t=this.He.get(e);return t||(t=new Fn(vs),this.He=this.He.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||ct("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new Ux),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function rh(){return new fn(jt.comparator)}function Fx(){return new fn(jt.comparator)}const bA={asc:"ASCENDING",desc:"DESCENDING"},vA={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},xA={and:"AND",or:"OR"};class wA{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function wg(n,e){return n.useProto3Json||rm(e)?e:{value:e}}function Fh(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function D_(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function _A(n,e){return Fh(n,e.toTimestamp())}function Ua(n){return qs(!!n,49232),qt.fromTimestamp((function(t){const i=lo(t);return new wt(i.seconds,i.nanos)})(n))}function fy(n,e){return _g(n,e).canonicalString()}function _g(n,e){const t=(function(l){return new nn(["projects",l.projectId,"databases",l.database])})(n).child("documents");return e===void 0?t:t.child(e)}function P_(n){const e=nn.fromString(n);return qs(U_(e),10190,{key:e.toString()}),e}function kg(n,e){return fy(n.databaseId,e.path)}function Ip(n,e){const t=P_(e);if(t.get(1)!==n.databaseId.projectId)throw new nt(Ne.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new nt(Ne.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new jt(O_(t))}function L_(n,e){return fy(n.databaseId,e)}function kA(n){const e=P_(n);return e.length===4?nn.emptyPath():O_(e)}function jg(n){return new nn(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function O_(n){return qs(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function zx(n,e,t){return{name:kg(n,e),fields:t.value.mapValue.fields}}function jA(n,e){let t;if("targetChange"in e){e.targetChange;const i=(function(y){return y==="NO_CHANGE"?0:y==="ADD"?1:y==="REMOVE"?2:y==="CURRENT"?3:y==="RESET"?4:Ot(39313,{state:y})})(e.targetChange.targetChangeType||"NO_CHANGE"),l=e.targetChange.targetIds||[],u=(function(y,w){return y.useProto3Json?(qs(w===void 0||typeof w=="string",58123),rr.fromBase64String(w||"")):(qs(w===void 0||w instanceof Buffer||w instanceof Uint8Array,16193),rr.fromUint8Array(w||new Uint8Array))})(n,e.targetChange.resumeToken),d=e.targetChange.cause,p=d&&(function(y){const w=y.code===void 0?Ne.UNKNOWN:A_(y.code);return new nt(w,y.message||"")})(d);t=new I_(i,l,u,p||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const l=Ip(n,i.document.name),u=Ua(i.document.updateTime),d=i.document.createTime?Ua(i.document.createTime):qt.min(),p=new Or({mapValue:{fields:i.document.fields}}),g=dr.newFoundDocument(l,u,d,p),y=i.targetIds||[],w=i.removedTargetIds||[];t=new jh(y,w,g.key,g)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const l=Ip(n,i.document),u=i.readTime?Ua(i.readTime):qt.min(),d=dr.newNoDocument(l,u),p=i.removedTargetIds||[];t=new jh([],p,d.key,d)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const l=Ip(n,i.document),u=i.removedTargetIds||[];t=new jh([],u,l,null)}else{if(!("filter"in e))return Ot(11601,{Vt:e});{e.filter;const i=e.filter;i.targetId;const{count:l=0,unchangedNames:u}=i,d=new mA(l,u),p=i.targetId;t=new M_(p,d)}}return t}function TA(n,e){let t;if(e instanceof Lu)t={update:zx(n,e.key,e.value)};else if(e instanceof dm)t={delete:kg(n,e.key)};else if(e instanceof yo)t={update:zx(n,e.key,e.data),updateMask:DA(e.fieldMask)};else{if(!(e instanceof uA))return Ot(16599,{dt:e.type});t={verify:kg(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((i=>(function(u,d){const p=d.transform;if(p instanceof ku)return{fieldPath:d.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(p instanceof ju)return{fieldPath:d.field.canonicalString(),appendMissingElements:{values:p.elements}};if(p instanceof Tu)return{fieldPath:d.field.canonicalString(),removeAllFromArray:{values:p.elements}};if(p instanceof Eu)return{fieldPath:d.field.canonicalString(),increment:p.Ae};throw Ot(20930,{transform:d.transform})})(0,i)))),e.precondition.isNone||(t.currentDocument=(function(l,u){return u.updateTime!==void 0?{updateTime:_A(l,u.updateTime)}:u.exists!==void 0?{exists:u.exists}:Ot(27497)})(n,e.precondition)),t}function EA(n,e){return n&&n.length>0?(qs(e!==void 0,14353),n.map((t=>(function(l,u){let d=l.updateTime?Ua(l.updateTime):Ua(u);return d.isEqual(qt.min())&&(d=Ua(u)),new oA(d,l.transformResults||[])})(t,e)))):[]}function SA(n,e){return{documents:[L_(n,e.path)]}}function NA(n,e){const t={structuredQuery:{}},i=e.path;let l;e.collectionGroup!==null?(l=i,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(l=i.popLast(),t.structuredQuery.from=[{collectionId:i.lastSegment()}]),t.parent=L_(n,l);const u=(function(y){if(y.length!==0)return B_(_a.create(y,"and"))})(e.filters);u&&(t.structuredQuery.where=u);const d=(function(y){if(y.length!==0)return y.map((w=>(function(T){return{field:Fl(T.field),direction:AA(T.dir)}})(w)))})(e.orderBy);d&&(t.structuredQuery.orderBy=d);const p=wg(n,e.limit);return p!==null&&(t.structuredQuery.limit=p),e.startAt&&(t.structuredQuery.startAt=(function(y){return{before:y.inclusive,values:y.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(y){return{before:!y.inclusive,values:y.position}})(e.endAt)),{ft:t,parent:l}}function CA(n){let e=kA(n.parent);const t=n.structuredQuery,i=t.from?t.from.length:0;let l=null;if(i>0){qs(i===1,65062);const w=t.from[0];w.allDescendants?l=w.collectionId:e=e.child(w.collectionId)}let u=[];t.where&&(u=(function(j){const T=V_(j);return T instanceof _a&&h_(T)?T.getFilters():[T]})(t.where));let d=[];t.orderBy&&(d=(function(j){return j.map((T=>(function($){return new _u(zl($.field),(function(U){switch(U){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})($.direction))})(T)))})(t.orderBy));let p=null;t.limit&&(p=(function(j){let T;return T=typeof j=="object"?j.value:j,rm(T)?null:T})(t.limit));let g=null;t.startAt&&(g=(function(j){const T=!!j.before,V=j.values||[];return new Bh(V,T)})(t.startAt));let y=null;return t.endAt&&(y=(function(j){const T=!j.before,V=j.values||[];return new Bh(V,T)})(t.endAt)),GR(e,l,d,u,p,"F",g,y)}function RA(n,e){const t=(function(l){switch(l){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Ot(28987,{purpose:l})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function V_(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const i=zl(t.unaryFilter.field);return Dn.create(i,"==",{doubleValue:NaN});case"IS_NULL":const l=zl(t.unaryFilter.field);return Dn.create(l,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const u=zl(t.unaryFilter.field);return Dn.create(u,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const d=zl(t.unaryFilter.field);return Dn.create(d,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Ot(61313);default:return Ot(60726)}})(n):n.fieldFilter!==void 0?(function(t){return Dn.create(zl(t.fieldFilter.field),(function(l){switch(l){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Ot(58110);default:return Ot(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return _a.create(t.compositeFilter.filters.map((i=>V_(i))),(function(l){switch(l){case"AND":return"and";case"OR":return"or";default:return Ot(1026)}})(t.compositeFilter.op))})(n):Ot(30097,{filter:n})}function AA(n){return bA[n]}function MA(n){return vA[n]}function IA(n){return xA[n]}function Fl(n){return{fieldPath:n.canonicalString()}}function zl(n){return nr.fromServerFormat(n.fieldPath)}function B_(n){return n instanceof Dn?(function(t){if(t.op==="=="){if(Cx(t.value))return{unaryFilter:{field:Fl(t.field),op:"IS_NAN"}};if(Nx(t.value))return{unaryFilter:{field:Fl(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(Cx(t.value))return{unaryFilter:{field:Fl(t.field),op:"IS_NOT_NAN"}};if(Nx(t.value))return{unaryFilter:{field:Fl(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Fl(t.field),op:MA(t.op),value:t.value}}})(n):n instanceof _a?(function(t){const i=t.getFilters().map((l=>B_(l)));return i.length===1?i[0]:{compositeFilter:{op:IA(t.op),filters:i}}})(n):Ot(54877,{filter:n})}function DA(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function U_(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}function F_(n){return!!n&&typeof n._toProto=="function"&&n._protoValueType==="ProtoValue"}class Zi{constructor(e,t,i,l,u=qt.min(),d=qt.min(),p=rr.EMPTY_BYTE_STRING,g=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=l,this.snapshotVersion=u,this.lastLimboFreeSnapshotVersion=d,this.resumeToken=p,this.expectedCount=g}withSequenceNumber(e){return new Zi(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Zi(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Zi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Zi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class PA{constructor(e){this.yt=e}}function LA(n){const e=CA({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Uh(e,e.limit,"L"):e}class OA{constructor(){this.Sn=new VA}addToCollectionParentIndex(e,t){return this.Sn.add(t),Ve.resolve()}getCollectionParents(e,t){return Ve.resolve(this.Sn.getEntries(t))}addFieldIndex(e,t){return Ve.resolve()}deleteFieldIndex(e,t){return Ve.resolve()}deleteAllFieldIndexes(e){return Ve.resolve()}createTargetIndexes(e,t){return Ve.resolve()}getDocumentsMatchingTarget(e,t){return Ve.resolve(null)}getIndexType(e,t){return Ve.resolve(0)}getFieldIndexes(e,t){return Ve.resolve([])}getNextCollectionGroupToUpdate(e){return Ve.resolve(null)}getMinOffset(e,t){return Ve.resolve(oo.min())}getMinOffsetFromCollectionGroup(e,t){return Ve.resolve(oo.min())}updateCollectionGroup(e,t,i){return Ve.resolve()}updateIndexEntries(e,t){return Ve.resolve()}}class VA{constructor(){this.index={}}add(e){const t=e.lastSegment(),i=e.popLast(),l=this.index[t]||new Fn(nn.comparator),u=!l.has(i);return this.index[t]=l.add(i),u}has(e){const t=e.lastSegment(),i=e.popLast(),l=this.index[t];return l&&l.has(i)}getEntries(e){return(this.index[e]||new Fn(nn.comparator)).toArray()}}const qx={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},z_=41943040;class Lr{static withCacheSize(e){return new Lr(e,Lr.DEFAULT_COLLECTION_PERCENTILE,Lr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}}Lr.DEFAULT_COLLECTION_PERCENTILE=10,Lr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Lr.DEFAULT=new Lr(z_,Lr.DEFAULT_COLLECTION_PERCENTILE,Lr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Lr.DISABLED=new Lr(-1,0,0);class Zl{constructor(e){this.sr=e}next(){return this.sr+=2,this.sr}static _r(){return new Zl(0)}static ar(){return new Zl(-1)}}const Hx="LruGarbageCollector",BA=1048576;function $x([n,e],[t,i]){const l=vs(n,t);return l===0?vs(e,i):l}class UA{constructor(e){this.Pr=e,this.buffer=new Fn($x),this.Tr=0}Ir(){return++this.Tr}Er(e){const t=[e,this.Ir()];if(this.buffer.size<this.Pr)this.buffer=this.buffer.add(t);else{const i=this.buffer.last();$x(t,i)<0&&(this.buffer=this.buffer.delete(i).add(t))}}get maxValue(){return this.buffer.last()[0]}}class FA{constructor(e,t,i){this.garbageCollector=e,this.asyncQueue=t,this.localStore=i,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Ar(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Ar(e){ct(Hx,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){oc(t)?ct(Hx,"Ignoring IndexedDB error during garbage collection: ",t):await ic(t)}await this.Ar(3e5)}))}}class zA{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.dr(e).next((i=>Math.floor(t/100*i)))}nthSequenceNumber(e,t){if(t===0)return Ve.resolve(nm.ce);const i=new UA(t);return this.Vr.forEachTarget(e,(l=>i.Er(l.sequenceNumber))).next((()=>this.Vr.mr(e,(l=>i.Er(l))))).next((()=>i.maxValue))}removeTargets(e,t,i){return this.Vr.removeTargets(e,t,i)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(ct("LruGarbageCollector","Garbage collection skipped; disabled"),Ve.resolve(qx)):this.getCacheSize(e).next((i=>i<this.params.cacheSizeCollectionThreshold?(ct("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),qx):this.gr(e,t)))}getCacheSize(e){return this.Vr.getCacheSize(e)}gr(e,t){let i,l,u,d,p,g,y;const w=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((j=>(j>this.params.maximumSequenceNumbersToCollect?(ct("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${j}`),l=this.params.maximumSequenceNumbersToCollect):l=j,d=Date.now(),this.nthSequenceNumber(e,l)))).next((j=>(i=j,p=Date.now(),this.removeTargets(e,i,t)))).next((j=>(u=j,g=Date.now(),this.removeOrphanedDocuments(e,i)))).next((j=>(y=Date.now(),Bl()<=bs.DEBUG&&ct("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${d-w}ms
	Determined least recently used ${l} in `+(p-d)+`ms
	Removed ${u} targets in `+(g-p)+`ms
	Removed ${j} documents in `+(y-g)+`ms
Total Duration: ${y-w}ms`),Ve.resolve({didRun:!0,sequenceNumbersCollected:l,targetsRemoved:u,documentsRemoved:j}))))}}function qA(n,e){return new zA(n,e)}class HA{constructor(){this.changes=new Zo((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,dr.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const i=this.changes.get(t);return i!==void 0?Ve.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class $A{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class WA{constructor(e,t,i,l){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=l}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next((l=>(i=l,this.remoteDocumentCache.getEntry(e,t)))).next((l=>(i!==null&&du(i.mutation,l,Yr.empty(),wt.now()),l)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.getLocalViewOfDocuments(e,i,xs()).next((()=>i))))}getLocalViewOfDocuments(e,t,i=xs()){const l=Vo();return this.populateOverlays(e,l,t).next((()=>this.computeViews(e,t,l,i).next((u=>{let d=nu();return u.forEach(((p,g)=>{d=d.insert(p,g.overlayedDocument)})),d}))))}getOverlayedDocuments(e,t){const i=Vo();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,xs())))}populateOverlays(e,t,i){const l=[];return i.forEach((u=>{t.has(u)||l.push(u)})),this.documentOverlayCache.getOverlays(e,l).next((u=>{u.forEach(((d,p)=>{t.set(d,p)}))}))}computeViews(e,t,i,l){let u=bi();const d=uu(),p=(function(){return uu()})();return t.forEach(((g,y)=>{const w=i.get(y.key);l.has(y.key)&&(w===void 0||w.mutation instanceof yo)?u=u.insert(y.key,y):w!==void 0?(d.set(y.key,w.mutation.getFieldMask()),du(w.mutation,y,w.mutation.getFieldMask(),wt.now())):d.set(y.key,Yr.empty())})),this.recalculateAndSaveOverlays(e,u).next((g=>(g.forEach(((y,w)=>d.set(y,w))),t.forEach(((y,w)=>p.set(y,new $A(w,d.get(y)??null)))),p)))}recalculateAndSaveOverlays(e,t){const i=uu();let l=new fn(((d,p)=>d-p)),u=xs();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((d=>{for(const p of d)p.keys().forEach((g=>{const y=t.get(g);if(y===null)return;let w=i.get(g)||Yr.empty();w=p.applyToLocalView(y,w),i.set(g,w);const j=(l.get(p.batchId)||xs()).add(g);l=l.insert(p.batchId,j)}))})).next((()=>{const d=[],p=l.getReverseIterator();for(;p.hasNext();){const g=p.getNext(),y=g.key,w=g.value,j=w_();w.forEach((T=>{if(!u.has(T)){const V=C_(t.get(T),i.get(T));V!==null&&j.set(T,V),u=u.add(T)}})),d.push(this.documentOverlayCache.saveOverlays(e,y,j))}return Ve.waitFor(d)})).next((()=>i))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.recalculateAndSaveOverlays(e,i)))}getDocumentsMatchingQuery(e,t,i,l){return KR(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):g_(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i,l):this.getDocumentsMatchingCollectionQuery(e,t,i,l)}getNextDocuments(e,t,i,l){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,l).next((u=>{const d=l-u.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,l-u.size):Ve.resolve(Vo());let p=bu,g=u;return d.next((y=>Ve.forEach(y,((w,j)=>(p<j.largestBatchId&&(p=j.largestBatchId),u.get(w)?Ve.resolve():this.remoteDocumentCache.getEntry(e,w).next((T=>{g=g.insert(w,T)}))))).next((()=>this.populateOverlays(e,y,u))).next((()=>this.computeViews(e,g,y,xs()))).next((w=>({batchId:p,changes:x_(w)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new jt(t)).next((i=>{let l=nu();return i.isFoundDocument()&&(l=l.insert(i.key,i)),l}))}getDocumentsMatchingCollectionGroupQuery(e,t,i,l){const u=t.collectionGroup;let d=nu();return this.indexManager.getCollectionParents(e,u).next((p=>Ve.forEach(p,(g=>{const y=(function(j,T){return new lc(T,null,j.explicitOrderBy.slice(),j.filters.slice(),j.limit,j.limitType,j.startAt,j.endAt)})(t,g.child(u));return this.getDocumentsMatchingCollectionQuery(e,y,i,l).next((w=>{w.forEach(((j,T)=>{d=d.insert(j,T)}))}))})).next((()=>d))))}getDocumentsMatchingCollectionQuery(e,t,i,l){let u;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next((d=>(u=d,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,u,l)))).next((d=>{u.forEach(((g,y)=>{const w=y.getKey();d.get(w)===null&&(d=d.insert(w,dr.newInvalidDocument(w)))}));let p=nu();return d.forEach(((g,y)=>{const w=u.get(g);w!==void 0&&du(w.mutation,y,Yr.empty(),wt.now()),lm(t,y)&&(p=p.insert(g,y))})),p}))}}class GA{constructor(e){this.serializer=e,this.Nr=new Map,this.Br=new Map}getBundleMetadata(e,t){return Ve.resolve(this.Nr.get(t))}saveBundleMetadata(e,t){return this.Nr.set(t.id,(function(l){return{id:l.id,version:l.version,createTime:Ua(l.createTime)}})(t)),Ve.resolve()}getNamedQuery(e,t){return Ve.resolve(this.Br.get(t))}saveNamedQuery(e,t){return this.Br.set(t.name,(function(l){return{name:l.name,query:LA(l.bundledQuery),readTime:Ua(l.readTime)}})(t)),Ve.resolve()}}class KA{constructor(){this.overlays=new fn(jt.comparator),this.Lr=new Map}getOverlay(e,t){return Ve.resolve(this.overlays.get(t))}getOverlays(e,t){const i=Vo();return Ve.forEach(t,(l=>this.getOverlay(e,l).next((u=>{u!==null&&i.set(l,u)})))).next((()=>i))}saveOverlays(e,t,i){return i.forEach(((l,u)=>{this.bt(e,t,u)})),Ve.resolve()}removeOverlaysForBatchId(e,t,i){const l=this.Lr.get(i);return l!==void 0&&(l.forEach((u=>this.overlays=this.overlays.remove(u))),this.Lr.delete(i)),Ve.resolve()}getOverlaysForCollection(e,t,i){const l=Vo(),u=t.length+1,d=new jt(t.child("")),p=this.overlays.getIteratorFrom(d);for(;p.hasNext();){const g=p.getNext().value,y=g.getKey();if(!t.isPrefixOf(y.path))break;y.path.length===u&&g.largestBatchId>i&&l.set(g.getKey(),g)}return Ve.resolve(l)}getOverlaysForCollectionGroup(e,t,i,l){let u=new fn(((y,w)=>y-w));const d=this.overlays.getIterator();for(;d.hasNext();){const y=d.getNext().value;if(y.getKey().getCollectionGroup()===t&&y.largestBatchId>i){let w=u.get(y.largestBatchId);w===null&&(w=Vo(),u=u.insert(y.largestBatchId,w)),w.set(y.getKey(),y)}}const p=Vo(),g=u.getIterator();for(;g.hasNext()&&(g.getNext().value.forEach(((y,w)=>p.set(y,w))),!(p.size()>=l)););return Ve.resolve(p)}bt(e,t,i){const l=this.overlays.get(i.key);if(l!==null){const d=this.Lr.get(l.largestBatchId).delete(i.key);this.Lr.set(l.largestBatchId,d)}this.overlays=this.overlays.insert(i.key,new hA(t,i));let u=this.Lr.get(t);u===void 0&&(u=xs(),this.Lr.set(t,u)),this.Lr.set(t,u.add(i.key))}}class YA{constructor(){this.sessionToken=rr.EMPTY_BYTE_STRING}getSessionToken(e){return Ve.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,Ve.resolve()}}class py{constructor(){this.kr=new Fn(Wn.Kr),this.qr=new Fn(Wn.Ur)}isEmpty(){return this.kr.isEmpty()}addReference(e,t){const i=new Wn(e,t);this.kr=this.kr.add(i),this.qr=this.qr.add(i)}$r(e,t){e.forEach((i=>this.addReference(i,t)))}removeReference(e,t){this.Wr(new Wn(e,t))}Qr(e,t){e.forEach((i=>this.removeReference(i,t)))}Gr(e){const t=new jt(new nn([])),i=new Wn(t,e),l=new Wn(t,e+1),u=[];return this.qr.forEachInRange([i,l],(d=>{this.Wr(d),u.push(d.key)})),u}zr(){this.kr.forEach((e=>this.Wr(e)))}Wr(e){this.kr=this.kr.delete(e),this.qr=this.qr.delete(e)}jr(e){const t=new jt(new nn([])),i=new Wn(t,e),l=new Wn(t,e+1);let u=xs();return this.qr.forEachInRange([i,l],(d=>{u=u.add(d.key)})),u}containsKey(e){const t=new Wn(e,0),i=this.kr.firstAfterOrEqual(t);return i!==null&&e.isEqual(i.key)}}class Wn{constructor(e,t){this.key=e,this.Hr=t}static Kr(e,t){return jt.comparator(e.key,t.key)||vs(e.Hr,t.Hr)}static Ur(e,t){return vs(e.Hr,t.Hr)||jt.comparator(e.key,t.key)}}class QA{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Yn=1,this.Jr=new Fn(Wn.Kr)}checkEmpty(e){return Ve.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,i,l){const u=this.Yn;this.Yn++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const d=new dA(u,t,i,l);this.mutationQueue.push(d);for(const p of l)this.Jr=this.Jr.add(new Wn(p.key,u)),this.indexManager.addToCollectionParentIndex(e,p.key.path.popLast());return Ve.resolve(d)}lookupMutationBatch(e,t){return Ve.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,l=this.Xr(i),u=l<0?0:l;return Ve.resolve(this.mutationQueue.length>u?this.mutationQueue[u]:null)}getHighestUnacknowledgedBatchId(){return Ve.resolve(this.mutationQueue.length===0?iy:this.Yn-1)}getAllMutationBatches(e){return Ve.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const i=new Wn(t,0),l=new Wn(t,Number.POSITIVE_INFINITY),u=[];return this.Jr.forEachInRange([i,l],(d=>{const p=this.Zr(d.Hr);u.push(p)})),Ve.resolve(u)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new Fn(vs);return t.forEach((l=>{const u=new Wn(l,0),d=new Wn(l,Number.POSITIVE_INFINITY);this.Jr.forEachInRange([u,d],(p=>{i=i.add(p.Hr)}))})),Ve.resolve(this.Yr(i))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,l=i.length+1;let u=i;jt.isDocumentKey(u)||(u=u.child(""));const d=new Wn(new jt(u),0);let p=new Fn(vs);return this.Jr.forEachWhile((g=>{const y=g.key.path;return!!i.isPrefixOf(y)&&(y.length===l&&(p=p.add(g.Hr)),!0)}),d),Ve.resolve(this.Yr(p))}Yr(e){const t=[];return e.forEach((i=>{const l=this.Zr(i);l!==null&&t.push(l)})),t}removeMutationBatch(e,t){qs(this.ei(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.Jr;return Ve.forEach(t.mutations,(l=>{const u=new Wn(l.key,t.batchId);return i=i.delete(u),this.referenceDelegate.markPotentiallyOrphaned(e,l.key)})).next((()=>{this.Jr=i}))}nr(e){}containsKey(e,t){const i=new Wn(t,0),l=this.Jr.firstAfterOrEqual(i);return Ve.resolve(t.isEqual(l&&l.key))}performConsistencyCheck(e){return this.mutationQueue.length,Ve.resolve()}ei(e,t){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class XA{constructor(e){this.ti=e,this.docs=(function(){return new fn(jt.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const i=t.key,l=this.docs.get(i),u=l?l.size:0,d=this.ti(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:d}),this.size+=d-u,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const i=this.docs.get(t);return Ve.resolve(i?i.document.mutableCopy():dr.newInvalidDocument(t))}getEntries(e,t){let i=bi();return t.forEach((l=>{const u=this.docs.get(l);i=i.insert(l,u?u.document.mutableCopy():dr.newInvalidDocument(l))})),Ve.resolve(i)}getDocumentsMatchingQuery(e,t,i,l){let u=bi();const d=t.path,p=new jt(d.child("__id-9223372036854775808__")),g=this.docs.getIteratorFrom(p);for(;g.hasNext();){const{key:y,value:{document:w}}=g.getNext();if(!d.isPrefixOf(y.path))break;y.path.length>d.length+1||jR(kR(w),i)<=0||(l.has(w.key)||lm(t,w))&&(u=u.insert(w.key,w.mutableCopy()))}return Ve.resolve(u)}getAllFromCollectionGroup(e,t,i,l){Ot(9500)}ni(e,t){return Ve.forEach(this.docs,(i=>t(i)))}newChangeBuffer(e){return new JA(this)}getSize(e){return Ve.resolve(this.size)}}class JA extends HA{constructor(e){super(),this.Mr=e}applyChanges(e){const t=[];return this.changes.forEach(((i,l)=>{l.isValidDocument()?t.push(this.Mr.addEntry(e,l)):this.Mr.removeEntry(i)})),Ve.waitFor(t)}getFromCache(e,t){return this.Mr.getEntry(e,t)}getAllFromCache(e,t){return this.Mr.getEntries(e,t)}}class ZA{constructor(e){this.persistence=e,this.ri=new Zo((t=>cy(t)),uy),this.lastRemoteSnapshotVersion=qt.min(),this.highestTargetId=0,this.ii=0,this.si=new py,this.targetCount=0,this.oi=Zl._r()}forEachTarget(e,t){return this.ri.forEach(((i,l)=>t(l))),Ve.resolve()}getLastRemoteSnapshotVersion(e){return Ve.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Ve.resolve(this.ii)}allocateTargetId(e){return this.highestTargetId=this.oi.next(),Ve.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.ii&&(this.ii=t),Ve.resolve()}lr(e){this.ri.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.oi=new Zl(t),this.highestTargetId=t),e.sequenceNumber>this.ii&&(this.ii=e.sequenceNumber)}addTargetData(e,t){return this.lr(t),this.targetCount+=1,Ve.resolve()}updateTargetData(e,t){return this.lr(t),Ve.resolve()}removeTargetData(e,t){return this.ri.delete(t.target),this.si.Gr(t.targetId),this.targetCount-=1,Ve.resolve()}removeTargets(e,t,i){let l=0;const u=[];return this.ri.forEach(((d,p)=>{p.sequenceNumber<=t&&i.get(p.targetId)===null&&(this.ri.delete(d),u.push(this.removeMatchingKeysForTargetId(e,p.targetId)),l++)})),Ve.waitFor(u).next((()=>l))}getTargetCount(e){return Ve.resolve(this.targetCount)}getTargetData(e,t){const i=this.ri.get(t)||null;return Ve.resolve(i)}addMatchingKeys(e,t,i){return this.si.$r(t,i),Ve.resolve()}removeMatchingKeys(e,t,i){this.si.Qr(t,i);const l=this.persistence.referenceDelegate,u=[];return l&&t.forEach((d=>{u.push(l.markPotentiallyOrphaned(e,d))})),Ve.waitFor(u)}removeMatchingKeysForTargetId(e,t){return this.si.Gr(t),Ve.resolve()}getMatchingKeysForTargetId(e,t){const i=this.si.jr(t);return Ve.resolve(i)}containsKey(e,t){return Ve.resolve(this.si.containsKey(t))}}class q_{constructor(e,t){this._i={},this.overlays={},this.ai=new nm(0),this.ui=!1,this.ui=!0,this.ci=new YA,this.referenceDelegate=e(this),this.li=new ZA(this),this.indexManager=new OA,this.remoteDocumentCache=(function(l){return new XA(l)})((i=>this.referenceDelegate.hi(i))),this.serializer=new PA(t),this.Pi=new GA(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ui=!1,Promise.resolve()}get started(){return this.ui}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new KA,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this._i[e.toKey()];return i||(i=new QA(t,this.referenceDelegate),this._i[e.toKey()]=i),i}getGlobalsCache(){return this.ci}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Pi}runTransaction(e,t,i){ct("MemoryPersistence","Starting transaction:",e);const l=new eM(this.ai.next());return this.referenceDelegate.Ti(),i(l).next((u=>this.referenceDelegate.Ii(l).next((()=>u)))).toPromise().then((u=>(l.raiseOnCommittedEvent(),u)))}Ei(e,t){return Ve.or(Object.values(this._i).map((i=>()=>i.containsKey(e,t))))}}class eM extends ER{constructor(e){super(),this.currentSequenceNumber=e}}class gy{constructor(e){this.persistence=e,this.Ri=new py,this.Ai=null}static Vi(e){return new gy(e)}get di(){if(this.Ai)return this.Ai;throw Ot(60996)}addReference(e,t,i){return this.Ri.addReference(i,t),this.di.delete(i.toString()),Ve.resolve()}removeReference(e,t,i){return this.Ri.removeReference(i,t),this.di.add(i.toString()),Ve.resolve()}markPotentiallyOrphaned(e,t){return this.di.add(t.toString()),Ve.resolve()}removeTarget(e,t){this.Ri.Gr(t.targetId).forEach((l=>this.di.add(l.toString())));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next((l=>{l.forEach((u=>this.di.add(u.toString())))})).next((()=>i.removeTargetData(e,t)))}Ti(){this.Ai=new Set}Ii(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Ve.forEach(this.di,(i=>{const l=jt.fromPath(i);return this.mi(e,l).next((u=>{u||t.removeEntry(l,qt.min())}))})).next((()=>(this.Ai=null,t.apply(e))))}updateLimboDocument(e,t){return this.mi(e,t).next((i=>{i?this.di.delete(t.toString()):this.di.add(t.toString())}))}hi(e){return 0}mi(e,t){return Ve.or([()=>Ve.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}}class zh{constructor(e,t){this.persistence=e,this.fi=new Zo((i=>CR(i.path)),((i,l)=>i.isEqual(l))),this.garbageCollector=qA(this,t)}static Vi(e,t){return new zh(e,t)}Ti(){}Ii(e){return Ve.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}dr(e){const t=this.pr(e);return this.persistence.getTargetCache().getTargetCount(e).next((i=>t.next((l=>i+l))))}pr(e){let t=0;return this.mr(e,(i=>{t++})).next((()=>t))}mr(e,t){return Ve.forEach(this.fi,((i,l)=>this.wr(e,i,l).next((u=>u?Ve.resolve():t(l)))))}removeTargets(e,t,i){return this.persistence.getTargetCache().removeTargets(e,t,i)}removeOrphanedDocuments(e,t){let i=0;const l=this.persistence.getRemoteDocumentCache(),u=l.newChangeBuffer();return l.ni(e,(d=>this.wr(e,d,t).next((p=>{p||(i++,u.removeEntry(d,qt.min()))})))).next((()=>u.apply(e))).next((()=>i))}markPotentiallyOrphaned(e,t){return this.fi.set(t,e.currentSequenceNumber),Ve.resolve()}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,i)}addReference(e,t,i){return this.fi.set(i,e.currentSequenceNumber),Ve.resolve()}removeReference(e,t,i){return this.fi.set(i,e.currentSequenceNumber),Ve.resolve()}updateLimboDocument(e,t){return this.fi.set(t,e.currentSequenceNumber),Ve.resolve()}hi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=wh(e.data.value)),t}wr(e,t,i){return Ve.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const l=this.fi.get(t);return Ve.resolve(l!==void 0&&l>i)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class yy{constructor(e,t,i,l){this.targetId=e,this.fromCache=t,this.Ts=i,this.Is=l}static Es(e,t){let i=xs(),l=xs();for(const u of t.docChanges)switch(u.type){case 0:i=i.add(u.doc.key);break;case 1:l=l.add(u.doc.key)}return new yy(e,t.fromCache,i,l)}}class tM{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class sM{constructor(){this.Rs=!1,this.As=!1,this.Vs=100,this.ds=(function(){return CS()?8:SR(hr())>0?6:4})()}initialize(e,t){this.fs=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,i,l){const u={result:null};return this.gs(e,t).next((d=>{u.result=d})).next((()=>{if(!u.result)return this.ps(e,t,l,i).next((d=>{u.result=d}))})).next((()=>{if(u.result)return;const d=new tM;return this.ys(e,t,d).next((p=>{if(u.result=p,this.As)return this.ws(e,t,d,p.size)}))})).next((()=>u.result))}ws(e,t,i,l){return i.documentReadCount<this.Vs?(Bl()<=bs.DEBUG&&ct("QueryEngine","SDK will not create cache indexes for query:",Ul(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),Ve.resolve()):(Bl()<=bs.DEBUG&&ct("QueryEngine","Query:",Ul(t),"scans",i.documentReadCount,"local documents and returns",l,"documents as results."),i.documentReadCount>this.ds*l?(Bl()<=bs.DEBUG&&ct("QueryEngine","The SDK decides to create cache indexes for query:",Ul(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Ba(t))):Ve.resolve())}gs(e,t){if(Ix(t))return Ve.resolve(null);let i=Ba(t);return this.indexManager.getIndexType(e,i).next((l=>l===0?null:(t.limit!==null&&l===1&&(t=Uh(t,null,"F"),i=Ba(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next((u=>{const d=xs(...u);return this.fs.getDocuments(e,d).next((p=>this.indexManager.getMinOffset(e,i).next((g=>{const y=this.bs(t,p);return this.Ss(t,y,d,g.readTime)?this.gs(e,Uh(t,null,"F")):this.Ds(e,y,t,g)}))))})))))}ps(e,t,i,l){return Ix(t)||l.isEqual(qt.min())?Ve.resolve(null):this.fs.getDocuments(e,i).next((u=>{const d=this.bs(t,u);return this.Ss(t,d,i,l)?Ve.resolve(null):(Bl()<=bs.DEBUG&&ct("QueryEngine","Re-using previous result from %s to execute query: %s",l.toString(),Ul(t)),this.Ds(e,d,t,_R(l,bu)).next((p=>p)))}))}bs(e,t){let i=new Fn(b_(e));return t.forEach(((l,u)=>{lm(e,u)&&(i=i.add(u))})),i}Ss(e,t,i,l){if(e.limit===null)return!1;if(i.size!==t.size)return!0;const u=e.limitType==="F"?t.last():t.first();return!!u&&(u.hasPendingWrites||u.version.compareTo(l)>0)}ys(e,t,i){return Bl()<=bs.DEBUG&&ct("QueryEngine","Using full collection scan to execute query:",Ul(t)),this.fs.getDocumentsMatchingQuery(e,t,oo.min(),i)}Ds(e,t,i,l){return this.fs.getDocumentsMatchingQuery(e,i,l).next((u=>(t.forEach((d=>{u=u.insert(d.key,d)})),u)))}}const by="LocalStore",nM=3e8;class rM{constructor(e,t,i,l){this.persistence=e,this.Cs=t,this.serializer=l,this.vs=new fn(vs),this.Fs=new Zo((u=>cy(u)),uy),this.Ms=new Map,this.xs=e.getRemoteDocumentCache(),this.li=e.getTargetCache(),this.Pi=e.getBundleCache(),this.Os(i)}Os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new WA(this.xs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.xs.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.vs)))}}function aM(n,e,t,i){return new rM(n,e,t,i)}async function H_(n,e){const t=Wt(n);return await t.persistence.runTransaction("Handle user change","readonly",(i=>{let l;return t.mutationQueue.getAllMutationBatches(i).next((u=>(l=u,t.Os(e),t.mutationQueue.getAllMutationBatches(i)))).next((u=>{const d=[],p=[];let g=xs();for(const y of l){d.push(y.batchId);for(const w of y.mutations)g=g.add(w.key)}for(const y of u){p.push(y.batchId);for(const w of y.mutations)g=g.add(w.key)}return t.localDocuments.getDocuments(i,g).next((y=>({Ns:y,removedBatchIds:d,addedBatchIds:p})))}))}))}function iM(n,e){const t=Wt(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(i=>{const l=e.batch.keys(),u=t.xs.newChangeBuffer({trackRemovals:!0});return(function(p,g,y,w){const j=y.batch,T=j.keys();let V=Ve.resolve();return T.forEach(($=>{V=V.next((()=>w.getEntry(g,$))).next((F=>{const U=y.docVersions.get($);qs(U!==null,48541),F.version.compareTo(U)<0&&(j.applyToRemoteDocument(F,y),F.isValidDocument()&&(F.setReadTime(y.commitVersion),w.addEntry(F)))}))})),V.next((()=>p.mutationQueue.removeMutationBatch(g,j)))})(t,i,e,u).next((()=>u.apply(i))).next((()=>t.mutationQueue.performConsistencyCheck(i))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(i,l,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,(function(p){let g=xs();for(let y=0;y<p.mutationResults.length;++y)p.mutationResults[y].transformResults.length>0&&(g=g.add(p.batch.mutations[y].key));return g})(e)))).next((()=>t.localDocuments.getDocuments(i,l)))}))}function $_(n){const e=Wt(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.li.getLastRemoteSnapshotVersion(t)))}function oM(n,e){const t=Wt(n),i=e.snapshotVersion;let l=t.vs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(u=>{const d=t.xs.newChangeBuffer({trackRemovals:!0});l=t.vs;const p=[];e.targetChanges.forEach(((w,j)=>{const T=l.get(j);if(!T)return;p.push(t.li.removeMatchingKeys(u,w.removedDocuments,j).next((()=>t.li.addMatchingKeys(u,w.addedDocuments,j))));let V=T.withSequenceNumber(u.currentSequenceNumber);e.targetMismatches.get(j)!==null?V=V.withResumeToken(rr.EMPTY_BYTE_STRING,qt.min()).withLastLimboFreeSnapshotVersion(qt.min()):w.resumeToken.approximateByteSize()>0&&(V=V.withResumeToken(w.resumeToken,i)),l=l.insert(j,V),(function(F,U,te){return F.resumeToken.approximateByteSize()===0||U.snapshotVersion.toMicroseconds()-F.snapshotVersion.toMicroseconds()>=nM?!0:te.addedDocuments.size+te.modifiedDocuments.size+te.removedDocuments.size>0})(T,V,w)&&p.push(t.li.updateTargetData(u,V))}));let g=bi(),y=xs();if(e.documentUpdates.forEach((w=>{e.resolvedLimboDocuments.has(w)&&p.push(t.persistence.referenceDelegate.updateLimboDocument(u,w))})),p.push(lM(u,d,e.documentUpdates).next((w=>{g=w.Bs,y=w.Ls}))),!i.isEqual(qt.min())){const w=t.li.getLastRemoteSnapshotVersion(u).next((j=>t.li.setTargetsMetadata(u,u.currentSequenceNumber,i)));p.push(w)}return Ve.waitFor(p).next((()=>d.apply(u))).next((()=>t.localDocuments.getLocalViewOfDocuments(u,g,y))).next((()=>g))})).then((u=>(t.vs=l,u)))}function lM(n,e,t){let i=xs(),l=xs();return t.forEach((u=>i=i.add(u))),e.getEntries(n,i).next((u=>{let d=bi();return t.forEach(((p,g)=>{const y=u.get(p);g.isFoundDocument()!==y.isFoundDocument()&&(l=l.add(p)),g.isNoDocument()&&g.version.isEqual(qt.min())?(e.removeEntry(p,g.readTime),d=d.insert(p,g)):!y.isValidDocument()||g.version.compareTo(y.version)>0||g.version.compareTo(y.version)===0&&y.hasPendingWrites?(e.addEntry(g),d=d.insert(p,g)):ct(by,"Ignoring outdated watch update for ",p,". Current version:",y.version," Watch version:",g.version)})),{Bs:d,Ls:l}}))}function cM(n,e){const t=Wt(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(i=>(e===void 0&&(e=iy),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e))))}function uM(n,e){const t=Wt(n);return t.persistence.runTransaction("Allocate target","readwrite",(i=>{let l;return t.li.getTargetData(i,e).next((u=>u?(l=u,Ve.resolve(l)):t.li.allocateTargetId(i).next((d=>(l=new Zi(e,d,"TargetPurposeListen",i.currentSequenceNumber),t.li.addTargetData(i,l).next((()=>l)))))))})).then((i=>{const l=t.vs.get(i.targetId);return(l===null||i.snapshotVersion.compareTo(l.snapshotVersion)>0)&&(t.vs=t.vs.insert(i.targetId,i),t.Fs.set(e,i.targetId)),i}))}async function Tg(n,e,t){const i=Wt(n),l=i.vs.get(e),u=t?"readwrite":"readwrite-primary";try{t||await i.persistence.runTransaction("Release target",u,(d=>i.persistence.referenceDelegate.removeTarget(d,l)))}catch(d){if(!oc(d))throw d;ct(by,`Failed to update sequence numbers for target ${e}: ${d}`)}i.vs=i.vs.remove(e),i.Fs.delete(l.target)}function Wx(n,e,t){const i=Wt(n);let l=qt.min(),u=xs();return i.persistence.runTransaction("Execute query","readwrite",(d=>(function(g,y,w){const j=Wt(g),T=j.Fs.get(w);return T!==void 0?Ve.resolve(j.vs.get(T)):j.li.getTargetData(y,w)})(i,d,Ba(e)).next((p=>{if(p)return l=p.lastLimboFreeSnapshotVersion,i.li.getMatchingKeysForTargetId(d,p.targetId).next((g=>{u=g}))})).next((()=>i.Cs.getDocumentsMatchingQuery(d,e,t?l:qt.min(),t?u:xs()))).next((p=>(dM(i,XR(e),p),{documents:p,ks:u})))))}function dM(n,e,t){let i=n.Ms.get(e)||qt.min();t.forEach(((l,u)=>{u.readTime.compareTo(i)>0&&(i=u.readTime)})),n.Ms.set(e,i)}class Gx{constructor(){this.activeTargetIds=nA()}Qs(e){this.activeTargetIds=this.activeTargetIds.add(e)}Gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class hM{constructor(){this.vo=new Gx,this.Fo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e,t=!0){return t&&this.vo.Qs(e),this.Fo[e]||"not-current"}updateQueryState(e,t,i){this.Fo[e]=t}removeLocalQueryTarget(e){this.vo.Gs(e)}isLocalQueryTarget(e){return this.vo.activeTargetIds.has(e)}clearQueryState(e){delete this.Fo[e]}getAllActiveQueryTargets(){return this.vo.activeTargetIds}isActiveQueryTarget(e){return this.vo.activeTargetIds.has(e)}start(){return this.vo=new Gx,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class mM{Mo(e){}shutdown(){}}const Kx="ConnectivityMonitor";class Yx{constructor(){this.xo=()=>this.Oo(),this.No=()=>this.Bo(),this.Lo=[],this.ko()}Mo(e){this.Lo.push(e)}shutdown(){window.removeEventListener("online",this.xo),window.removeEventListener("offline",this.No)}ko(){window.addEventListener("online",this.xo),window.addEventListener("offline",this.No)}Oo(){ct(Kx,"Network connectivity changed: AVAILABLE");for(const e of this.Lo)e(0)}Bo(){ct(Kx,"Network connectivity changed: UNAVAILABLE");for(const e of this.Lo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let ah=null;function Eg(){return ah===null?ah=(function(){return 268435456+Math.round(2147483648*Math.random())})():ah++,"0x"+ah.toString(16)}const Dp="RestConnection",fM={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery",ExecutePipeline:"executePipeline"};class pM{get Ko(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),l=encodeURIComponent(this.databaseId.database);this.qo=t+"://"+e.host,this.Uo=`projects/${i}/databases/${l}`,this.$o=this.databaseId.database===Oh?`project_id=${i}`:`project_id=${i}&database_id=${l}`}Wo(e,t,i,l,u){const d=Eg(),p=this.Qo(e,t.toUriEncodedString());ct(Dp,`Sending RPC '${e}' ${d}:`,p,i);const g={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.$o};this.Go(g,l,u);const{host:y}=new URL(p),w=fo(y);return this.zo(e,p,g,i,w).then((j=>(ct(Dp,`Received RPC '${e}' ${d}: `,j),j)),(j=>{throw Yl(Dp,`RPC '${e}' ${d} failed with error: `,j,"url: ",p,"request:",i),j}))}jo(e,t,i,l,u,d){return this.Wo(e,t,i,l,u)}Go(e,t,i){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+ac})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((l,u)=>e[u]=l)),i&&i.headers.forEach(((l,u)=>e[u]=l))}Qo(e,t){const i=fM[e];let l=`${this.qo}/v1/${t}:${i}`;return this.databaseInfo.apiKey&&(l=`${l}?key=${encodeURIComponent(this.databaseInfo.apiKey)}`),l}terminate(){}}class gM{constructor(e){this.Ho=e.Ho,this.Jo=e.Jo}Zo(e){this.Xo=e}Yo(e){this.e_=e}t_(e){this.n_=e}onMessage(e){this.r_=e}close(){this.Jo()}send(e){this.Ho(e)}i_(){this.Xo()}s_(){this.e_()}o_(e){this.n_(e)}__(e){this.r_(e)}}const cr="WebChannelConnection",Yc=(n,e,t)=>{n.listen(e,(i=>{try{t(i)}catch(l){setTimeout((()=>{throw l}),0)}}))};class Gl extends pM{constructor(e){super(e),this.a_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}static u_(){if(!Gl.c_){const e=Kw();Yc(e,Gw.STAT_EVENT,(t=>{t.stat===fg.PROXY?ct(cr,"STAT_EVENT: detected buffering proxy"):t.stat===fg.NOPROXY&&ct(cr,"STAT_EVENT: detected no buffering proxy")})),Gl.c_=!0}}zo(e,t,i,l,u){const d=Eg();return new Promise(((p,g)=>{const y=new $w;y.setWithCredentials(!0),y.listenOnce(Ww.COMPLETE,(()=>{try{switch(y.getLastErrorCode()){case xh.NO_ERROR:const j=y.getResponseJson();ct(cr,`XHR for RPC '${e}' ${d} received:`,JSON.stringify(j)),p(j);break;case xh.TIMEOUT:ct(cr,`RPC '${e}' ${d} timed out`),g(new nt(Ne.DEADLINE_EXCEEDED,"Request time out"));break;case xh.HTTP_ERROR:const T=y.getStatus();if(ct(cr,`RPC '${e}' ${d} failed with status:`,T,"response text:",y.getResponseText()),T>0){let V=y.getResponseJson();Array.isArray(V)&&(V=V[0]);const $=V?.error;if($&&$.status&&$.message){const F=(function(te){const K=te.toLowerCase().replace(/_/g,"-");return Object.values(Ne).indexOf(K)>=0?K:Ne.UNKNOWN})($.status);g(new nt(F,$.message))}else g(new nt(Ne.UNKNOWN,"Server responded with status "+y.getStatus()))}else g(new nt(Ne.UNAVAILABLE,"Connection failed."));break;default:Ot(9055,{l_:e,streamId:d,h_:y.getLastErrorCode(),P_:y.getLastError()})}}finally{ct(cr,`RPC '${e}' ${d} completed.`)}}));const w=JSON.stringify(l);ct(cr,`RPC '${e}' ${d} sending request:`,l),y.send(t,"POST",w,i,15)}))}T_(e,t,i){const l=Eg(),u=[this.qo,"/","google.firestore.v1.Firestore","/",e,"/channel"],d=this.createWebChannelTransport(),p={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},g=this.longPollingOptions.timeoutSeconds;g!==void 0&&(p.longPollingTimeout=Math.round(1e3*g)),this.useFetchStreams&&(p.useFetchStreams=!0),this.Go(p.initMessageHeaders,t,i),p.encodeInitMessageHeaders=!0;const y=u.join("");ct(cr,`Creating RPC '${e}' stream ${l}: ${y}`,p);const w=d.createWebChannel(y,p);this.I_(w);let j=!1,T=!1;const V=new gM({Ho:$=>{T?ct(cr,`Not sending because RPC '${e}' stream ${l} is closed:`,$):(j||(ct(cr,`Opening RPC '${e}' stream ${l} transport.`),w.open(),j=!0),ct(cr,`RPC '${e}' stream ${l} sending:`,$),w.send($))},Jo:()=>w.close()});return Yc(w,su.EventType.OPEN,(()=>{T||(ct(cr,`RPC '${e}' stream ${l} transport opened.`),V.i_())})),Yc(w,su.EventType.CLOSE,(()=>{T||(T=!0,ct(cr,`RPC '${e}' stream ${l} transport closed`),V.o_(),this.E_(w))})),Yc(w,su.EventType.ERROR,($=>{T||(T=!0,Yl(cr,`RPC '${e}' stream ${l} transport errored. Name:`,$.name,"Message:",$.message),V.o_(new nt(Ne.UNAVAILABLE,"The operation could not be completed")))})),Yc(w,su.EventType.MESSAGE,($=>{if(!T){const F=$.data[0];qs(!!F,16349);const U=F,te=U?.error||U[0]?.error;if(te){ct(cr,`RPC '${e}' stream ${l} received error:`,te);const K=te.status;let re=(function(ge){const R=In[ge];if(R!==void 0)return A_(R)})(K),ye=te.message;re===void 0&&(re=Ne.INTERNAL,ye="Unknown error status: "+K+" with message "+te.message),T=!0,V.o_(new nt(re,ye)),w.close()}else ct(cr,`RPC '${e}' stream ${l} received:`,F),V.__(F)}})),Gl.u_(),setTimeout((()=>{V.s_()}),0),V}terminate(){this.a_.forEach((e=>e.close())),this.a_=[]}I_(e){this.a_.push(e)}E_(e){this.a_=this.a_.filter((t=>t===e))}Go(e,t,i){super.Go(e,t,i),this.databaseInfo.apiKey&&(e["x-goog-api-key"]=this.databaseInfo.apiKey)}createWebChannelTransport(){return Yw()}}function yM(n){return new Gl(n)}function Pp(){return typeof document<"u"?document:null}function mm(n){return new wA(n,!0)}Gl.c_=!1;class W_{constructor(e,t,i=1e3,l=1.5,u=6e4){this.Ci=e,this.timerId=t,this.R_=i,this.A_=l,this.V_=u,this.d_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.d_=0}g_(){this.d_=this.V_}p_(e){this.cancel();const t=Math.floor(this.d_+this.y_()),i=Math.max(0,Date.now()-this.f_),l=Math.max(0,t-i);l>0&&ct("ExponentialBackoff",`Backing off for ${l} ms (base delay: ${this.d_} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.m_=this.Ci.enqueueAfterDelay(this.timerId,l,(()=>(this.f_=Date.now(),e()))),this.d_*=this.A_,this.d_<this.R_&&(this.d_=this.R_),this.d_>this.V_&&(this.d_=this.V_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.d_}}const Qx="PersistentStream";class G_{constructor(e,t,i,l,u,d,p,g){this.Ci=e,this.b_=i,this.S_=l,this.connection=u,this.authCredentialsProvider=d,this.appCheckCredentialsProvider=p,this.listener=g,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new W_(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Ci.enqueueAfterDelay(this.b_,6e4,(()=>this.k_())))}K_(e){this.q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===Ne.RESOURCE_EXHAUSTED?(yi(t.toString()),yi("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===Ne.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.t_(t)}W_(){}auth(){this.state=1;const e=this.Q_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([i,l])=>{this.D_===t&&this.G_(i,l)}),(i=>{e((()=>{const l=new nt(Ne.UNKNOWN,"Fetching auth token failed: "+i.message);return this.z_(l)}))}))}G_(e,t){const i=this.Q_(this.D_);this.stream=this.j_(e,t),this.stream.Zo((()=>{i((()=>this.listener.Zo()))})),this.stream.Yo((()=>{i((()=>(this.state=2,this.v_=this.Ci.enqueueAfterDelay(this.S_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.Yo())))})),this.stream.t_((l=>{i((()=>this.z_(l)))})),this.stream.onMessage((l=>{i((()=>++this.F_==1?this.H_(l):this.onNext(l)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return ct(Qx,`close with error: ${e}`),this.stream=null,this.close(4,e)}Q_(e){return t=>{this.Ci.enqueueAndForget((()=>this.D_===e?t():(ct(Qx,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class bM extends G_{constructor(e,t,i,l,u,d){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,i,l,d),this.serializer=u}j_(e,t){return this.connection.T_("Listen",e,t)}H_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=jA(this.serializer,e),i=(function(u){if(!("targetChange"in u))return qt.min();const d=u.targetChange;return d.targetIds&&d.targetIds.length?qt.min():d.readTime?Ua(d.readTime):qt.min()})(e);return this.listener.J_(t,i)}Z_(e){const t={};t.database=jg(this.serializer),t.addTarget=(function(u,d){let p;const g=d.target;if(p=vg(g)?{documents:SA(u,g)}:{query:NA(u,g).ft},p.targetId=d.targetId,d.resumeToken.approximateByteSize()>0){p.resumeToken=D_(u,d.resumeToken);const y=wg(u,d.expectedCount);y!==null&&(p.expectedCount=y)}else if(d.snapshotVersion.compareTo(qt.min())>0){p.readTime=Fh(u,d.snapshotVersion.toTimestamp());const y=wg(u,d.expectedCount);y!==null&&(p.expectedCount=y)}return p})(this.serializer,e);const i=RA(this.serializer,e);i&&(t.labels=i),this.K_(t)}X_(e){const t={};t.database=jg(this.serializer),t.removeTarget=e,this.K_(t)}}class vM extends G_{constructor(e,t,i,l,u,d){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,l,d),this.serializer=u}get Y_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.Y_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}H_(e){return qs(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,qs(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){qs(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=EA(e.writeResults,e.commitTime),i=Ua(e.commitTime);return this.listener.na(i,t)}ra(){const e={};e.database=jg(this.serializer),this.K_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((i=>TA(this.serializer,i)))};this.K_(t)}}class xM{}class wM extends xM{constructor(e,t,i,l){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=l,this.ia=!1}sa(){if(this.ia)throw new nt(Ne.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,i,l){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([u,d])=>this.connection.Wo(e,_g(t,i),l,u,d))).catch((u=>{throw u.name==="FirebaseError"?(u.code===Ne.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),u):new nt(Ne.UNKNOWN,u.toString())}))}jo(e,t,i,l,u){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([d,p])=>this.connection.jo(e,_g(t,i),l,d,p,u))).catch((d=>{throw d.name==="FirebaseError"?(d.code===Ne.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),d):new nt(Ne.UNKNOWN,d.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}function _M(n,e,t,i){return new wM(n,e,t,i)}class kM{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(yi(t),this.aa=!1):ct("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const Yo="RemoteStore";class jM{constructor(e,t,i,l,u){this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.Ra=[],this.Aa=u,this.Aa.Mo((d=>{i.enqueueAndForget((async()=>{el(this)&&(ct(Yo,"Restarting streams for network reachability change."),await(async function(g){const y=Wt(g);y.Ea.add(4),await Vu(y),y.Va.set("Unknown"),y.Ea.delete(4),await fm(y)})(this))}))})),this.Va=new kM(i,l)}}async function fm(n){if(el(n))for(const e of n.Ra)await e(!0)}async function Vu(n){for(const e of n.Ra)await e(!1)}function K_(n,e){const t=Wt(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),_y(t)?wy(t):cc(t).O_()&&xy(t,e))}function vy(n,e){const t=Wt(n),i=cc(t);t.Ia.delete(e),i.O_()&&Y_(t,e),t.Ia.size===0&&(i.O_()?i.L_():el(t)&&t.Va.set("Unknown"))}function xy(n,e){if(n.da.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(qt.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}cc(n).Z_(e)}function Y_(n,e){n.da.$e(e),cc(n).X_(e)}function wy(n){n.da=new yA({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),cc(n).start(),n.Va.ua()}function _y(n){return el(n)&&!cc(n).x_()&&n.Ia.size>0}function el(n){return Wt(n).Ea.size===0}function Q_(n){n.da=void 0}async function TM(n){n.Va.set("Online")}async function EM(n){n.Ia.forEach(((e,t)=>{xy(n,e)}))}async function SM(n,e){Q_(n),_y(n)?(n.Va.ha(e),wy(n)):n.Va.set("Unknown")}async function NM(n,e,t){if(n.Va.set("Online"),e instanceof I_&&e.state===2&&e.cause)try{await(async function(l,u){const d=u.cause;for(const p of u.targetIds)l.Ia.has(p)&&(await l.remoteSyncer.rejectListen(p,d),l.Ia.delete(p),l.da.removeTarget(p))})(n,e)}catch(i){ct(Yo,"Failed to remove targets %s: %s ",e.targetIds.join(","),i),await qh(n,i)}else if(e instanceof jh?n.da.Xe(e):e instanceof M_?n.da.st(e):n.da.tt(e),!t.isEqual(qt.min()))try{const i=await $_(n.localStore);t.compareTo(i)>=0&&await(function(u,d){const p=u.da.Tt(d);return p.targetChanges.forEach(((g,y)=>{if(g.resumeToken.approximateByteSize()>0){const w=u.Ia.get(y);w&&u.Ia.set(y,w.withResumeToken(g.resumeToken,d))}})),p.targetMismatches.forEach(((g,y)=>{const w=u.Ia.get(g);if(!w)return;u.Ia.set(g,w.withResumeToken(rr.EMPTY_BYTE_STRING,w.snapshotVersion)),Y_(u,g);const j=new Zi(w.target,g,y,w.sequenceNumber);xy(u,j)})),u.remoteSyncer.applyRemoteEvent(p)})(n,t)}catch(i){ct(Yo,"Failed to raise snapshot:",i),await qh(n,i)}}async function qh(n,e,t){if(!oc(e))throw e;n.Ea.add(1),await Vu(n),n.Va.set("Offline"),t||(t=()=>$_(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{ct(Yo,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await fm(n)}))}function X_(n,e){return e().catch((t=>qh(n,t,e)))}async function pm(n){const e=Wt(n),t=ho(e);let i=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:iy;for(;CM(e);)try{const l=await cM(e.localStore,i);if(l===null){e.Ta.length===0&&t.L_();break}i=l.batchId,RM(e,l)}catch(l){await qh(e,l)}J_(e)&&Z_(e)}function CM(n){return el(n)&&n.Ta.length<10}function RM(n,e){n.Ta.push(e);const t=ho(n);t.O_()&&t.Y_&&t.ea(e.mutations)}function J_(n){return el(n)&&!ho(n).x_()&&n.Ta.length>0}function Z_(n){ho(n).start()}async function AM(n){ho(n).ra()}async function MM(n){const e=ho(n);for(const t of n.Ta)e.ea(t.mutations)}async function IM(n,e,t){const i=n.Ta.shift(),l=hy.from(i,e,t);await X_(n,(()=>n.remoteSyncer.applySuccessfulWrite(l))),await pm(n)}async function DM(n,e){e&&ho(n).Y_&&await(async function(i,l){if((function(d){return fA(d)&&d!==Ne.ABORTED})(l.code)){const u=i.Ta.shift();ho(i).B_(),await X_(i,(()=>i.remoteSyncer.rejectFailedWrite(u.batchId,l))),await pm(i)}})(n,e),J_(n)&&Z_(n)}async function Xx(n,e){const t=Wt(n);t.asyncQueue.verifyOperationInProgress(),ct(Yo,"RemoteStore received new credentials");const i=el(t);t.Ea.add(3),await Vu(t),i&&t.Va.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await fm(t)}async function PM(n,e){const t=Wt(n);e?(t.Ea.delete(2),await fm(t)):e||(t.Ea.add(2),await Vu(t),t.Va.set("Unknown"))}function cc(n){return n.ma||(n.ma=(function(t,i,l){const u=Wt(t);return u.sa(),new bM(i,u.connection,u.authCredentials,u.appCheckCredentials,u.serializer,l)})(n.datastore,n.asyncQueue,{Zo:TM.bind(null,n),Yo:EM.bind(null,n),t_:SM.bind(null,n),J_:NM.bind(null,n)}),n.Ra.push((async e=>{e?(n.ma.B_(),_y(n)?wy(n):n.Va.set("Unknown")):(await n.ma.stop(),Q_(n))}))),n.ma}function ho(n){return n.fa||(n.fa=(function(t,i,l){const u=Wt(t);return u.sa(),new vM(i,u.connection,u.authCredentials,u.appCheckCredentials,u.serializer,l)})(n.datastore,n.asyncQueue,{Zo:()=>Promise.resolve(),Yo:AM.bind(null,n),t_:DM.bind(null,n),ta:MM.bind(null,n),na:IM.bind(null,n)}),n.Ra.push((async e=>{e?(n.fa.B_(),await pm(n)):(await n.fa.stop(),n.Ta.length>0&&(ct(Yo,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}class ky{constructor(e,t,i,l,u){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=l,this.removalCallback=u,this.deferred=new hi,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((d=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,l,u){const d=Date.now()+i,p=new ky(e,t,d,l,u);return p.start(i),p}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new nt(Ne.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function jy(n,e){if(yi("AsyncQueue",`${e}: ${n}`),oc(n))return new nt(Ne.UNAVAILABLE,`${e}: ${n}`);throw n}class Kl{static emptySet(e){return new Kl(e.comparator)}constructor(e){this.comparator=e?(t,i)=>e(t,i)||jt.comparator(t.key,i.key):(t,i)=>jt.comparator(t.key,i.key),this.keyedMap=nu(),this.sortedSet=new fn(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,i)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Kl)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;t.hasNext();){const l=t.getNext().key,u=i.getNext().key;if(!l.isEqual(u))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const i=new Kl;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=t,i}}class Jx{constructor(){this.ga=new fn(jt.comparator)}track(e){const t=e.doc.key,i=this.ga.get(t);i?e.type!==0&&i.type===3?this.ga=this.ga.insert(t,e):e.type===3&&i.type!==1?this.ga=this.ga.insert(t,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.ga=this.ga.remove(t):e.type===1&&i.type===2?this.ga=this.ga.insert(t,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):Ot(63341,{Vt:e,pa:i}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,i)=>{e.push(i)})),e}}class ec{constructor(e,t,i,l,u,d,p,g,y){this.query=e,this.docs=t,this.oldDocs=i,this.docChanges=l,this.mutatedKeys=u,this.fromCache=d,this.syncStateChanged=p,this.excludesMetadataChanges=g,this.hasCachedResults=y}static fromInitialDocuments(e,t,i,l,u){const d=[];return t.forEach((p=>{d.push({type:0,doc:p})})),new ec(e,t,Kl.emptySet(t),d,i,l,!0,!1,u)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&om(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,i=e.docChanges;if(t.length!==i.length)return!1;for(let l=0;l<t.length;l++)if(t[l].type!==i[l].type||!t[l].doc.isEqual(i[l].doc))return!1;return!0}}class LM{constructor(){this.wa=void 0,this.ba=[]}Sa(){return this.ba.some((e=>e.Da()))}}class OM{constructor(){this.queries=Zx(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,i){const l=Wt(t),u=l.queries;l.queries=Zx(),u.forEach(((d,p)=>{for(const g of p.ba)g.onError(i)}))})(this,new nt(Ne.ABORTED,"Firestore shutting down"))}}function Zx(){return new Zo((n=>y_(n)),om)}async function Ty(n,e){const t=Wt(n);let i=3;const l=e.query;let u=t.queries.get(l);u?!u.Sa()&&e.Da()&&(i=2):(u=new LM,i=e.Da()?0:1);try{switch(i){case 0:u.wa=await t.onListen(l,!0);break;case 1:u.wa=await t.onListen(l,!1);break;case 2:await t.onFirstRemoteStoreListen(l)}}catch(d){const p=jy(d,`Initialization of query '${Ul(e.query)}' failed`);return void e.onError(p)}t.queries.set(l,u),u.ba.push(e),e.va(t.onlineState),u.wa&&e.Fa(u.wa)&&Sy(t)}async function Ey(n,e){const t=Wt(n),i=e.query;let l=3;const u=t.queries.get(i);if(u){const d=u.ba.indexOf(e);d>=0&&(u.ba.splice(d,1),u.ba.length===0?l=e.Da()?0:1:!u.Sa()&&e.Da()&&(l=2))}switch(l){case 0:return t.queries.delete(i),t.onUnlisten(i,!0);case 1:return t.queries.delete(i),t.onUnlisten(i,!1);case 2:return t.onLastRemoteStoreUnlisten(i);default:return}}function VM(n,e){const t=Wt(n);let i=!1;for(const l of e){const u=l.query,d=t.queries.get(u);if(d){for(const p of d.ba)p.Fa(l)&&(i=!0);d.wa=l}}i&&Sy(t)}function BM(n,e,t){const i=Wt(n),l=i.queries.get(e);if(l)for(const u of l.ba)u.onError(t);i.queries.delete(e)}function Sy(n){n.Ca.forEach((e=>{e.next()}))}var Sg,e2;(e2=Sg||(Sg={})).Ma="default",e2.Cache="cache";class Ny{constructor(e,t,i){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=i||{}}Fa(e){if(!this.options.includeMetadataChanges){const i=[];for(const l of e.docChanges)l.type!==3&&i.push(l);e=new ec(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const i=t!=="Offline";return(!this.options.Ka||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=ec.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Sg.Cache}}class ek{constructor(e){this.key=e}}class tk{constructor(e){this.key=e}}class UM{constructor(e,t){this.query=e,this.Za=t,this.Xa=null,this.hasCachedResults=!1,this.current=!1,this.Ya=xs(),this.mutatedKeys=xs(),this.eu=b_(e),this.tu=new Kl(this.eu)}get nu(){return this.Za}ru(e,t){const i=t?t.iu:new Jx,l=t?t.tu:this.tu;let u=t?t.mutatedKeys:this.mutatedKeys,d=l,p=!1;const g=this.query.limitType==="F"&&l.size===this.query.limit?l.last():null,y=this.query.limitType==="L"&&l.size===this.query.limit?l.first():null;if(e.inorderTraversal(((w,j)=>{const T=l.get(w),V=lm(this.query,j)?j:null,$=!!T&&this.mutatedKeys.has(T.key),F=!!V&&(V.hasLocalMutations||this.mutatedKeys.has(V.key)&&V.hasCommittedMutations);let U=!1;T&&V?T.data.isEqual(V.data)?$!==F&&(i.track({type:3,doc:V}),U=!0):this.su(T,V)||(i.track({type:2,doc:V}),U=!0,(g&&this.eu(V,g)>0||y&&this.eu(V,y)<0)&&(p=!0)):!T&&V?(i.track({type:0,doc:V}),U=!0):T&&!V&&(i.track({type:1,doc:T}),U=!0,(g||y)&&(p=!0)),U&&(V?(d=d.add(V),u=F?u.add(w):u.delete(w)):(d=d.delete(w),u=u.delete(w)))})),this.query.limit!==null)for(;d.size>this.query.limit;){const w=this.query.limitType==="F"?d.last():d.first();d=d.delete(w.key),u=u.delete(w.key),i.track({type:1,doc:w})}return{tu:d,iu:i,Ss:p,mutatedKeys:u}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,i,l){const u=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const d=e.iu.ya();d.sort(((w,j)=>(function(V,$){const F=U=>{switch(U){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ot(20277,{Vt:U})}};return F(V)-F($)})(w.type,j.type)||this.eu(w.doc,j.doc))),this.ou(i),l=l??!1;const p=t&&!l?this._u():[],g=this.Ya.size===0&&this.current&&!l?1:0,y=g!==this.Xa;return this.Xa=g,d.length!==0||y?{snapshot:new ec(this.query,e.tu,u,d,e.mutatedKeys,g===0,y,!1,!!i&&i.resumeToken.approximateByteSize()>0),au:p}:{au:p}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Jx,mutatedKeys:this.mutatedKeys,Ss:!1},!1)):{au:[]}}uu(e){return!this.Za.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Za=this.Za.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Za=this.Za.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Ya;this.Ya=xs(),this.tu.forEach((i=>{this.uu(i.key)&&(this.Ya=this.Ya.add(i.key))}));const t=[];return e.forEach((i=>{this.Ya.has(i)||t.push(new tk(i))})),this.Ya.forEach((i=>{e.has(i)||t.push(new ek(i))})),t}cu(e){this.Za=e.ks,this.Ya=xs();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return ec.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Xa===0,this.hasCachedResults)}}const Cy="SyncEngine";class FM{constructor(e,t,i){this.query=e,this.targetId=t,this.view=i}}class zM{constructor(e){this.key=e,this.hu=!1}}class qM{constructor(e,t,i,l,u,d){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=l,this.currentUser=u,this.maxConcurrentLimboResolutions=d,this.Pu={},this.Tu=new Zo((p=>y_(p)),om),this.Iu=new Map,this.Eu=new Set,this.Ru=new fn(jt.comparator),this.Au=new Map,this.Vu=new py,this.du={},this.mu=new Map,this.fu=Zl.ar(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function HM(n,e,t=!0){const i=ok(n);let l;const u=i.Tu.get(e);return u?(i.sharedClientState.addLocalQueryTarget(u.targetId),l=u.view.lu()):l=await sk(i,e,t,!0),l}async function $M(n,e){const t=ok(n);await sk(t,e,!0,!1)}async function sk(n,e,t,i){const l=await uM(n.localStore,Ba(e)),u=l.targetId,d=n.sharedClientState.addLocalQueryTarget(u,t);let p;return i&&(p=await WM(n,e,u,d==="current",l.resumeToken)),n.isPrimaryClient&&t&&K_(n.remoteStore,l),p}async function WM(n,e,t,i,l){n.pu=(j,T,V)=>(async function(F,U,te,K){let re=U.view.ru(te);re.Ss&&(re=await Wx(F.localStore,U.query,!1).then((({documents:R})=>U.view.ru(R,re))));const ye=K&&K.targetChanges.get(U.targetId),ve=K&&K.targetMismatches.get(U.targetId)!=null,ge=U.view.applyChanges(re,F.isPrimaryClient,ye,ve);return s2(F,U.targetId,ge.au),ge.snapshot})(n,j,T,V);const u=await Wx(n.localStore,e,!0),d=new UM(e,u.ks),p=d.ru(u.documents),g=Ou.createSynthesizedTargetChangeForCurrentChange(t,i&&n.onlineState!=="Offline",l),y=d.applyChanges(p,n.isPrimaryClient,g);s2(n,t,y.au);const w=new FM(e,t,d);return n.Tu.set(e,w),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),y.snapshot}async function GM(n,e,t){const i=Wt(n),l=i.Tu.get(e),u=i.Iu.get(l.targetId);if(u.length>1)return i.Iu.set(l.targetId,u.filter((d=>!om(d,e)))),void i.Tu.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(l.targetId),i.sharedClientState.isActiveQueryTarget(l.targetId)||await Tg(i.localStore,l.targetId,!1).then((()=>{i.sharedClientState.clearQueryState(l.targetId),t&&vy(i.remoteStore,l.targetId),Ng(i,l.targetId)})).catch(ic)):(Ng(i,l.targetId),await Tg(i.localStore,l.targetId,!0))}async function KM(n,e){const t=Wt(n),i=t.Tu.get(e),l=t.Iu.get(i.targetId);t.isPrimaryClient&&l.length===1&&(t.sharedClientState.removeLocalQueryTarget(i.targetId),vy(t.remoteStore,i.targetId))}async function YM(n,e,t){const i=sI(n);try{const l=await(function(d,p){const g=Wt(d),y=wt.now(),w=p.reduce(((V,$)=>V.add($.key)),xs());let j,T;return g.persistence.runTransaction("Locally write mutations","readwrite",(V=>{let $=bi(),F=xs();return g.xs.getEntries(V,w).next((U=>{$=U,$.forEach(((te,K)=>{K.isValidDocument()||(F=F.add(te))}))})).next((()=>g.localDocuments.getOverlayedDocuments(V,$))).next((U=>{j=U;const te=[];for(const K of p){const re=cA(K,j.get(K.key).overlayedDocument);re!=null&&te.push(new yo(K.key,re,c_(re.value.mapValue),Tr.exists(!0)))}return g.mutationQueue.addMutationBatch(V,y,te,p)})).next((U=>{T=U;const te=U.applyToLocalDocumentSet(j,F);return g.documentOverlayCache.saveOverlays(V,U.batchId,te)}))})).then((()=>({batchId:T.batchId,changes:x_(j)})))})(i.localStore,e);i.sharedClientState.addPendingMutation(l.batchId),(function(d,p,g){let y=d.du[d.currentUser.toKey()];y||(y=new fn(vs)),y=y.insert(p,g),d.du[d.currentUser.toKey()]=y})(i,l.batchId,t),await Bu(i,l.changes),await pm(i.remoteStore)}catch(l){const u=jy(l,"Failed to persist write");t.reject(u)}}async function nk(n,e){const t=Wt(n);try{const i=await oM(t.localStore,e);e.targetChanges.forEach(((l,u)=>{const d=t.Au.get(u);d&&(qs(l.addedDocuments.size+l.modifiedDocuments.size+l.removedDocuments.size<=1,22616),l.addedDocuments.size>0?d.hu=!0:l.modifiedDocuments.size>0?qs(d.hu,14607):l.removedDocuments.size>0&&(qs(d.hu,42227),d.hu=!1))})),await Bu(t,i,e)}catch(i){await ic(i)}}function t2(n,e,t){const i=Wt(n);if(i.isPrimaryClient&&t===0||!i.isPrimaryClient&&t===1){const l=[];i.Tu.forEach(((u,d)=>{const p=d.view.va(e);p.snapshot&&l.push(p.snapshot)})),(function(d,p){const g=Wt(d);g.onlineState=p;let y=!1;g.queries.forEach(((w,j)=>{for(const T of j.ba)T.va(p)&&(y=!0)})),y&&Sy(g)})(i.eventManager,e),l.length&&i.Pu.J_(l),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function QM(n,e,t){const i=Wt(n);i.sharedClientState.updateQueryState(e,"rejected",t);const l=i.Au.get(e),u=l&&l.key;if(u){let d=new fn(jt.comparator);d=d.insert(u,dr.newNoDocument(u,qt.min()));const p=xs().add(u),g=new hm(qt.min(),new Map,new fn(vs),d,p);await nk(i,g),i.Ru=i.Ru.remove(u),i.Au.delete(e),Ry(i)}else await Tg(i.localStore,e,!1).then((()=>Ng(i,e,t))).catch(ic)}async function XM(n,e){const t=Wt(n),i=e.batch.batchId;try{const l=await iM(t.localStore,e);ak(t,i,null),rk(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),await Bu(t,l)}catch(l){await ic(l)}}async function JM(n,e,t){const i=Wt(n);try{const l=await(function(d,p){const g=Wt(d);return g.persistence.runTransaction("Reject batch","readwrite-primary",(y=>{let w;return g.mutationQueue.lookupMutationBatch(y,p).next((j=>(qs(j!==null,37113),w=j.keys(),g.mutationQueue.removeMutationBatch(y,j)))).next((()=>g.mutationQueue.performConsistencyCheck(y))).next((()=>g.documentOverlayCache.removeOverlaysForBatchId(y,w,p))).next((()=>g.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(y,w))).next((()=>g.localDocuments.getDocuments(y,w)))}))})(i.localStore,e);ak(i,e,t),rk(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),await Bu(i,l)}catch(l){await ic(l)}}function rk(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function ak(n,e,t){const i=Wt(n);let l=i.du[i.currentUser.toKey()];if(l){const u=l.get(e);u&&(t?u.reject(t):u.resolve(),l=l.remove(e)),i.du[i.currentUser.toKey()]=l}}function Ng(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const i of n.Iu.get(e))n.Tu.delete(i),t&&n.Pu.yu(i,t);n.Iu.delete(e),n.isPrimaryClient&&n.Vu.Gr(e).forEach((i=>{n.Vu.containsKey(i)||ik(n,i)}))}function ik(n,e){n.Eu.delete(e.path.canonicalString());const t=n.Ru.get(e);t!==null&&(vy(n.remoteStore,t),n.Ru=n.Ru.remove(e),n.Au.delete(t),Ry(n))}function s2(n,e,t){for(const i of t)i instanceof ek?(n.Vu.addReference(i.key,e),ZM(n,i)):i instanceof tk?(ct(Cy,"Document no longer in limbo: "+i.key),n.Vu.removeReference(i.key,e),n.Vu.containsKey(i.key)||ik(n,i.key)):Ot(19791,{wu:i})}function ZM(n,e){const t=e.key,i=t.path.canonicalString();n.Ru.get(t)||n.Eu.has(i)||(ct(Cy,"New document in limbo: "+t),n.Eu.add(i),Ry(n))}function Ry(n){for(;n.Eu.size>0&&n.Ru.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new jt(nn.fromString(e)),i=n.fu.next();n.Au.set(i,new zM(t)),n.Ru=n.Ru.insert(t,i),K_(n.remoteStore,new Zi(Ba(im(t.path)),i,"TargetPurposeLimboResolution",nm.ce))}}async function Bu(n,e,t){const i=Wt(n),l=[],u=[],d=[];i.Tu.isEmpty()||(i.Tu.forEach(((p,g)=>{d.push(i.pu(g,e,t).then((y=>{if((y||t)&&i.isPrimaryClient){const w=y?!y.fromCache:t?.targetChanges.get(g.targetId)?.current;i.sharedClientState.updateQueryState(g.targetId,w?"current":"not-current")}if(y){l.push(y);const w=yy.Es(g.targetId,y);u.push(w)}})))})),await Promise.all(d),i.Pu.J_(l),await(async function(g,y){const w=Wt(g);try{await w.persistence.runTransaction("notifyLocalViewChanges","readwrite",(j=>Ve.forEach(y,(T=>Ve.forEach(T.Ts,(V=>w.persistence.referenceDelegate.addReference(j,T.targetId,V))).next((()=>Ve.forEach(T.Is,(V=>w.persistence.referenceDelegate.removeReference(j,T.targetId,V)))))))))}catch(j){if(!oc(j))throw j;ct(by,"Failed to update sequence numbers: "+j)}for(const j of y){const T=j.targetId;if(!j.fromCache){const V=w.vs.get(T),$=V.snapshotVersion,F=V.withLastLimboFreeSnapshotVersion($);w.vs=w.vs.insert(T,F)}}})(i.localStore,u))}async function eI(n,e){const t=Wt(n);if(!t.currentUser.isEqual(e)){ct(Cy,"User change. New user:",e.toKey());const i=await H_(t.localStore,e);t.currentUser=e,(function(u,d){u.mu.forEach((p=>{p.forEach((g=>{g.reject(new nt(Ne.CANCELLED,d))}))})),u.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await Bu(t,i.Ns)}}function tI(n,e){const t=Wt(n),i=t.Au.get(e);if(i&&i.hu)return xs().add(i.key);{let l=xs();const u=t.Iu.get(e);if(!u)return l;for(const d of u){const p=t.Tu.get(d);l=l.unionWith(p.view.nu)}return l}}function ok(n){const e=Wt(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=nk.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=tI.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=QM.bind(null,e),e.Pu.J_=VM.bind(null,e.eventManager),e.Pu.yu=BM.bind(null,e.eventManager),e}function sI(n){const e=Wt(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=XM.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=JM.bind(null,e),e}class Hh{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=mm(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return aM(this.persistence,new sM,e.initialUser,this.serializer)}Cu(e){return new q_(gy.Vi,this.serializer)}Du(e){return new hM}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Hh.provider={build:()=>new Hh};class nI extends Hh{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){qs(this.persistence.referenceDelegate instanceof zh,46915);const i=this.persistence.referenceDelegate.garbageCollector;return new FA(i,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?Lr.withCacheSize(this.cacheSizeBytes):Lr.DEFAULT;return new q_((i=>zh.Vi(i,t)),this.serializer)}}class Cg{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>t2(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=eI.bind(null,this.syncEngine),await PM(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new OM})()}createDatastore(e){const t=mm(e.databaseInfo.databaseId),i=yM(e.databaseInfo);return _M(e.authCredentials,e.appCheckCredentials,i,t)}createRemoteStore(e){return(function(i,l,u,d,p){return new jM(i,l,u,d,p)})(this.localStore,this.datastore,e.asyncQueue,(t=>t2(this.syncEngine,t,0)),(function(){return Yx.v()?new Yx:new mM})())}createSyncEngine(e,t){return(function(l,u,d,p,g,y,w){const j=new qM(l,u,d,p,g,y);return w&&(j.gu=!0),j})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const i=Wt(t);ct(Yo,"RemoteStore shutting down."),i.Ea.add(5),await Vu(i),i.Aa.shutdown(),i.Va.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}Cg.provider={build:()=>new Cg};class Ay{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):yi("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}const mo="FirestoreClient";class rI{constructor(e,t,i,l,u){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this._databaseInfo=l,this.user=ur.UNAUTHENTICATED,this.clientId=ay.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=u,this.authCredentials.start(i,(async d=>{ct(mo,"Received user=",d.uid),await this.authCredentialListener(d),this.user=d})),this.appCheckCredentials.start(i,(d=>(ct(mo,"Received new app check token=",d),this.appCheckCredentialListener(d,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this._databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new hi;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const i=jy(t,"Failed to shutdown persistence");e.reject(i)}})),e.promise}}async function Lp(n,e){n.asyncQueue.verifyOperationInProgress(),ct(mo,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let i=t.initialUser;n.setCredentialChangeListener((async l=>{i.isEqual(l)||(await H_(e.localStore,l),i=l)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function n2(n,e){n.asyncQueue.verifyOperationInProgress();const t=await aI(n);ct(mo,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((i=>Xx(e.remoteStore,i))),n.setAppCheckTokenChangeListener(((i,l)=>Xx(e.remoteStore,l))),n._onlineComponents=e}async function aI(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){ct(mo,"Using user provided OfflineComponentProvider");try{await Lp(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(l){return l.name==="FirebaseError"?l.code===Ne.FAILED_PRECONDITION||l.code===Ne.UNIMPLEMENTED:!(typeof DOMException<"u"&&l instanceof DOMException)||l.code===22||l.code===20||l.code===11})(t))throw t;Yl("Error using user provided cache. Falling back to memory cache: "+t),await Lp(n,new Hh)}}else ct(mo,"Using default OfflineComponentProvider"),await Lp(n,new nI(void 0));return n._offlineComponents}async function lk(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(ct(mo,"Using user provided OnlineComponentProvider"),await n2(n,n._uninitializedComponentsProvider._online)):(ct(mo,"Using default OnlineComponentProvider"),await n2(n,new Cg))),n._onlineComponents}function iI(n){return lk(n).then((e=>e.syncEngine))}async function $h(n){const e=await lk(n),t=e.eventManager;return t.onListen=HM.bind(null,e.syncEngine),t.onUnlisten=GM.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=$M.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=KM.bind(null,e.syncEngine),t}function oI(n,e,t,i){const l=new Ay(i),u=new Ny(e,l,t);return n.asyncQueue.enqueueAndForget((async()=>Ty(await $h(n),u))),()=>{l.Nu(),n.asyncQueue.enqueueAndForget((async()=>Ey(await $h(n),u)))}}function lI(n,e,t={}){const i=new hi;return n.asyncQueue.enqueueAndForget((async()=>(function(u,d,p,g,y){const w=new Ay({next:T=>{w.Nu(),d.enqueueAndForget((()=>Ey(u,j)));const V=T.docs.has(p);!V&&T.fromCache?y.reject(new nt(Ne.UNAVAILABLE,"Failed to get document because the client is offline.")):V&&T.fromCache&&g&&g.source==="server"?y.reject(new nt(Ne.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):y.resolve(T)},error:T=>y.reject(T)}),j=new Ny(im(p.path),w,{includeMetadataChanges:!0,Ka:!0});return Ty(u,j)})(await $h(n),n.asyncQueue,e,t,i))),i.promise}function cI(n,e,t={}){const i=new hi;return n.asyncQueue.enqueueAndForget((async()=>(function(u,d,p,g,y){const w=new Ay({next:T=>{w.Nu(),d.enqueueAndForget((()=>Ey(u,j))),T.fromCache&&g.source==="server"?y.reject(new nt(Ne.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):y.resolve(T)},error:T=>y.reject(T)}),j=new Ny(p,w,{includeMetadataChanges:!0,Ka:!0});return Ty(u,j)})(await $h(n),n.asyncQueue,e,t,i))),i.promise}function uI(n,e){const t=new hi;return n.asyncQueue.enqueueAndForget((async()=>YM(await iI(n),e,t))),t.promise}function ck(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}const dI="ComponentProvider",r2=new Map;function hI(n,e,t,i,l){return new MR(n,e,t,l.host,l.ssl,l.experimentalForceLongPolling,l.experimentalAutoDetectLongPolling,ck(l.experimentalLongPollingOptions),l.useFetchStreams,l.isUsingEmulator,i)}const uk="firestore.googleapis.com",a2=!0;class i2{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new nt(Ne.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=uk,this.ssl=a2}else this.host=e.host,this.ssl=e.ssl??a2;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=z_;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<BA)throw new nt(Ne.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}xR("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=ck(e.experimentalLongPollingOptions??{}),(function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new nt(Ne.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new nt(Ne.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new nt(Ne.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(i,l){return i.timeoutSeconds===l.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class gm{constructor(e,t,i,l){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=l,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new i2({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new nt(Ne.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new nt(Ne.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new i2(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(i){if(!i)return new uR;switch(i.type){case"firstParty":return new fR(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new nt(Ne.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const i=r2.get(t);i&&(ct(dI,"Removing Datastore"),r2.delete(t),i.terminate())})(this),Promise.resolve()}}function mI(n,e,t,i={}){n=jr(n,gm);const l=fo(e),u=n._getSettings(),d={...u,emulatorOptions:n._getEmulatorOptions()},p=`${e}:${t}`;l&&(qg(`https://${p}`),Hg("Firestore",!0)),u.host!==uk&&u.host!==p&&Yl("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const g={...u,host:p,ssl:l,emulatorOptions:i};if(!Ho(g,d)&&(n._setSettings(g),i.mockUserToken)){let y,w;if(typeof i.mockUserToken=="string")y=i.mockUserToken,w=ur.MOCK_USER;else{y=rw(i.mockUserToken,n._app?.options.projectId);const j=i.mockUserToken.sub||i.mockUserToken.user_id;if(!j)throw new nt(Ne.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");w=new ur(j)}n._authCredentials=new dR(new Xw(y,w))}}class wi{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new wi(this.firestore,e,this._query)}}class vn{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new ao(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new vn(this.firestore,e,this._key)}toJSON(){return{type:vn._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,i){if(Pu(t,vn._jsonSchema))return new vn(e,i||null,new jt(nn.fromString(t.referencePath)))}}vn._jsonSchemaVersion="firestore/documentReference/1.0",vn._jsonSchema={type:Pn("string",vn._jsonSchemaVersion),referencePath:Pn("string")};class ao extends wi{constructor(e,t,i){super(e,t,im(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new vn(this.firestore,null,new jt(e))}withConverter(e){return new ao(this.firestore,e,this._path)}}function Ft(n,e,...t){if(n=Qs(n),Jw("collection","path",e),n instanceof gm){const i=nn.fromString(e,...t);return vx(i),new ao(n,null,i)}{if(!(n instanceof vn||n instanceof ao))throw new nt(Ne.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(nn.fromString(e,...t));return vx(i),new ao(n.firestore,null,i)}}function qe(n,e,...t){if(n=Qs(n),arguments.length===1&&(e=ay.newId()),Jw("doc","path",e),n instanceof gm){const i=nn.fromString(e,...t);return bx(i),new vn(n,null,new jt(i))}{if(!(n instanceof vn||n instanceof ao))throw new nt(Ne.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(nn.fromString(e,...t));return bx(i),new vn(n.firestore,n instanceof ao?n.converter:null,new jt(i))}}const o2="AsyncQueue";class l2{constructor(e=Promise.resolve()){this.Yu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new W_(this,"async_queue_retry"),this._c=()=>{const i=Pp();i&&ct(o2,"Visibility state changed to "+i.visibilityState),this.M_.w_()},this.ac=e;const t=Pp();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=Pp();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new hi;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Yu.push(e),this.lc())))}async lc(){if(this.Yu.length!==0){try{await this.Yu[0](),this.Yu.shift(),this.M_.reset()}catch(e){if(!oc(e))throw e;ct(o2,"Operation failed with retryable error: "+e)}this.Yu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((i=>{throw this.nc=i,this.rc=!1,yi("INTERNAL UNHANDLED ERROR: ",c2(i)),i})).then((i=>(this.rc=!1,i))))));return this.ac=t,t}enqueueAfterDelay(e,t,i){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const l=ky.createAndSchedule(this,e,t,i,(u=>this.hc(u)));return this.tc.push(l),l}uc(){this.nc&&Ot(47125,{Pc:c2(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,i)=>t.targetTimeMs-i.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}Rc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function c2(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}class qa extends gm{constructor(e,t,i,l){super(e,t,i,l),this.type="firestore",this._queue=new l2,this._persistenceKey=l?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new l2(e),this._firestoreClient=void 0,await e}}}function fI(n,e){const t=typeof n=="object"?n:Kg(),i=typeof n=="string"?n:Oh,l=Jh(t,"firestore").getImmediate({identifier:i});if(!l._initialized){const u=tw("firestore");u&&mI(l,...u)}return l}function Uu(n){if(n._terminated)throw new nt(Ne.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||pI(n),n._firestoreClient}function pI(n){const e=n._freezeSettings(),t=hI(n._databaseId,n._app?.options.appId||"",n._persistenceKey,n._app?.options.apiKey,e);n._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new rI(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(l){const u=l?._online.build();return{_offline:l?._offline.build(u),_online:u}})(n._componentsProvider))}class ia{constructor(e){this._byteString=e}static fromBase64String(e){try{return new ia(rr.fromBase64String(e))}catch(t){throw new nt(Ne.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new ia(rr.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:ia._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Pu(e,ia._jsonSchema))return ia.fromBase64String(e.bytes)}}ia._jsonSchemaVersion="firestore/bytes/1.0",ia._jsonSchema={type:Pn("string",ia._jsonSchemaVersion),bytes:Pn("string")};class ym{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new nt(Ne.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new nr(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Fu{constructor(e){this._methodName=e}}class Fa{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new nt(Ne.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new nt(Ne.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return vs(this._lat,e._lat)||vs(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Fa._jsonSchemaVersion}}static fromJSON(e){if(Pu(e,Fa._jsonSchema))return new Fa(e.latitude,e.longitude)}}Fa._jsonSchemaVersion="firestore/geoPoint/1.0",Fa._jsonSchema={type:Pn("string",Fa._jsonSchemaVersion),latitude:Pn("number"),longitude:Pn("number")};class xa{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(i,l){if(i.length!==l.length)return!1;for(let u=0;u<i.length;++u)if(i[u]!==l[u])return!1;return!0})(this._values,e._values)}toJSON(){return{type:xa._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Pu(e,xa._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new xa(e.vectorValues);throw new nt(Ne.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}xa._jsonSchemaVersion="firestore/vectorValue/1.0",xa._jsonSchema={type:Pn("string",xa._jsonSchemaVersion),vectorValues:Pn("object")};const gI=/^__.*__$/;class yI{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return this.fieldMask!==null?new yo(e,this.data,this.fieldMask,t,this.fieldTransforms):new Lu(e,this.data,t,this.fieldTransforms)}}class dk{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return new yo(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function hk(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ot(40011,{dataSource:n})}}class My{constructor(e,t,i,l,u,d){this.settings=e,this.databaseId=t,this.serializer=i,this.ignoreUndefinedProperties=l,u===void 0&&this.validatePath(),this.fieldTransforms=u||[],this.fieldMask=d||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(e){return new My({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(e){const t=this.path?.child(e),i=this.contextWith({path:t,arrayElement:!1});return i.validatePathSegment(e),i}childContextForFieldPath(e){const t=this.path?.child(e),i=this.contextWith({path:t,arrayElement:!1});return i.validatePath(),i}childContextForArray(e){return this.contextWith({path:void 0,arrayElement:!0})}createError(e){return Wh(e,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}validatePath(){if(this.path)for(let e=0;e<this.path.length;e++)this.validatePathSegment(this.path.get(e))}validatePathSegment(e){if(e.length===0)throw this.createError("Document fields must not be empty");if(hk(this.dataSource)&&gI.test(e))throw this.createError('Document fields cannot begin and end with "__"')}}class bI{constructor(e,t,i){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=i||mm(e)}createContext(e,t,i,l=!1){return new My({dataSource:e,methodName:t,targetDoc:i,path:nr.emptyPath(),arrayElement:!1,hasConverter:l},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function zu(n){const e=n._freezeSettings(),t=mm(n._databaseId);return new bI(n._databaseId,!!e.ignoreUndefinedProperties,t)}function Iy(n,e,t,i,l,u={}){const d=n.createContext(u.merge||u.mergeFields?2:0,e,t,l);Ly("Data must be an object, but it was:",d,i);const p=pk(i,d);let g,y;if(u.merge)g=new Yr(d.fieldMask),y=d.fieldTransforms;else if(u.mergeFields){const w=[];for(const j of u.mergeFields){const T=Qo(e,j,t);if(!d.contains(T))throw new nt(Ne.INVALID_ARGUMENT,`Field '${T}' is specified in your field mask but missing from your input data.`);bk(w,T)||w.push(T)}g=new Yr(w),y=d.fieldTransforms.filter((j=>g.covers(j.field)))}else g=null,y=d.fieldTransforms;return new yI(new Or(p),g,y)}class bm extends Fu{_toFieldTransform(e){if(e.dataSource!==2)throw e.dataSource===1?e.createError(`${this._methodName}() can only appear at the top level of your update data`):e.createError(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof bm}}class Dy extends Fu{_toFieldTransform(e){return new N_(e.path,new ku)}isEqual(e){return e instanceof Dy}}class Py extends Fu{constructor(e,t){super(e),this.Vc=t}_toFieldTransform(e){const t=new Eu(e.serializer,k_(e.serializer,this.Vc));return new N_(e.path,t)}isEqual(e){return e instanceof Py&&this.Vc===e.Vc}}function mk(n,e,t,i){const l=n.createContext(1,e,t);Ly("Data must be an object, but it was:",l,i);const u=[],d=Or.empty();go(i,((g,y)=>{const w=yk(e,g,t);y=Qs(y);const j=l.childContextForFieldPath(w);if(y instanceof bm)u.push(w);else{const T=qu(y,j);T!=null&&(u.push(w),d.set(w,T))}}));const p=new Yr(u);return new dk(d,p,l.fieldTransforms)}function fk(n,e,t,i,l,u){const d=n.createContext(1,e,t),p=[Qo(e,i,t)],g=[l];if(u.length%2!=0)throw new nt(Ne.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let T=0;T<u.length;T+=2)p.push(Qo(e,u[T])),g.push(u[T+1]);const y=[],w=Or.empty();for(let T=p.length-1;T>=0;--T)if(!bk(y,p[T])){const V=p[T];let $=g[T];$=Qs($);const F=d.childContextForFieldPath(V);if($ instanceof bm)y.push(V);else{const U=qu($,F);U!=null&&(y.push(V),w.set(V,U))}}const j=new Yr(y);return new dk(w,j,d.fieldTransforms)}function vI(n,e,t,i=!1){return qu(t,n.createContext(i?4:3,e))}function qu(n,e){if(gk(n=Qs(n)))return Ly("Unsupported field value:",e,n),pk(n,e);if(n instanceof Fu)return(function(i,l){if(!hk(l.dataSource))throw l.createError(`${i._methodName}() can only be used with update() and set()`);if(!l.path)throw l.createError(`${i._methodName}() is not currently supported inside arrays`);const u=i._toFieldTransform(l);u&&l.fieldTransforms.push(u)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.arrayElement&&e.dataSource!==4)throw e.createError("Nested arrays are not supported");return(function(i,l){const u=[];let d=0;for(const p of i){let g=qu(p,l.childContextForArray(d));g==null&&(g={nullValue:"NULL_VALUE"}),u.push(g),d++}return{arrayValue:{values:u}}})(n,e)}return(function(i,l){if((i=Qs(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return k_(l.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const u=wt.fromDate(i);return{timestampValue:Fh(l.serializer,u)}}if(i instanceof wt){const u=new wt(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:Fh(l.serializer,u)}}if(i instanceof Fa)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof ia)return{bytesValue:D_(l.serializer,i._byteString)};if(i instanceof vn){const u=l.databaseId,d=i.firestore._databaseId;if(!d.isEqual(u))throw l.createError(`Document reference is for database ${d.projectId}/${d.database} but should be for database ${u.projectId}/${u.database}`);return{referenceValue:fy(i.firestore._databaseId||l.databaseId,i._key.path)}}if(i instanceof xa)return(function(d,p){const g=d instanceof xa?d.toArray():d;return{mapValue:{fields:{[o_]:{stringValue:l_},[Vh]:{arrayValue:{values:g.map((w=>{if(typeof w!="number")throw p.createError("VectorValues must only contain numeric values.");return dy(p.serializer,w)}))}}}}}})(i,l);if(F_(i))return i._toProto(l.serializer);throw l.createError(`Unsupported field value: ${sm(i)}`)})(n,e)}function pk(n,e){const t={};return t_(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):go(n,((i,l)=>{const u=qu(l,e.childContextForField(i));u!=null&&(t[i]=u)})),{mapValue:{fields:t}}}function gk(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof wt||n instanceof Fa||n instanceof ia||n instanceof vn||n instanceof Fu||n instanceof xa||F_(n))}function Ly(n,e,t){if(!gk(t)||!Zw(t)){const i=sm(t);throw i==="an object"?e.createError(n+" a custom object"):e.createError(n+" "+i)}}function Qo(n,e,t){if((e=Qs(e))instanceof ym)return e._internalPath;if(typeof e=="string")return yk(n,e);throw Wh("Field path arguments must be of type string or ",n,!1,void 0,t)}const xI=new RegExp("[~\\*/\\[\\]]");function yk(n,e,t){if(e.search(xI)>=0)throw Wh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new ym(...e.split("."))._internalPath}catch{throw Wh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Wh(n,e,t,i,l){const u=i&&!i.isEmpty(),d=l!==void 0;let p=`Function ${e}() called with invalid data`;t&&(p+=" (via `toFirestore()`)"),p+=". ";let g="";return(u||d)&&(g+=" (found",u&&(g+=` in field ${i}`),d&&(g+=` in document ${l}`),g+=")"),new nt(Ne.INVALID_ARGUMENT,p+n+g)}function bk(n,e){return n.some((t=>t.isEqual(e)))}class wI{convertValue(e,t="none"){switch(uo(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Nn(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(co(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Ot(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const i={};return go(e,((l,u)=>{i[l]=this.convertValue(u,t)})),i}convertVectorValue(e){const t=e.fields?.[Vh].arrayValue?.values?.map((i=>Nn(i.doubleValue)));return new xa(t)}convertGeoPoint(e){return new Fa(Nn(e.latitude),Nn(e.longitude))}convertArray(e,t){return(e.values||[]).map((i=>this.convertValue(i,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const i=am(e);return i==null?null:this.convertValue(i,t);case"estimate":return this.convertTimestamp(vu(e));default:return null}}convertTimestamp(e){const t=lo(e);return new wt(t.seconds,t.nanos)}convertDocumentKey(e,t){const i=nn.fromString(e);qs(U_(i),9688,{name:e});const l=new xu(i.get(1),i.get(3)),u=new jt(i.popFirst(5));return l.isEqual(t)||yi(`Document ${u} contains a document reference within a different database (${l.projectId}/${l.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),u}}class Oy extends wI{constructor(e){super(),this.firestore=e}convertBytes(e){return new ia(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new vn(this.firestore,null,t)}}function Kr(){return new Dy("serverTimestamp")}function Bo(n){return new Py("increment",n)}const u2="@firebase/firestore",d2="4.10.0";function h2(n){return(function(t,i){if(typeof t!="object"||t===null)return!1;const l=t;for(const u of i)if(u in l&&typeof l[u]=="function")return!0;return!1})(n,["next","error","complete"])}class vk{constructor(e,t,i,l,u){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=l,this._converter=u}get id(){return this._key.path.lastSegment()}get ref(){return new vn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new _I(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}_fieldsProto(){return this._document?.data.clone().value.mapValue.fields??void 0}get(e){if(this._document){const t=this._document.data.field(Qo("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class _I extends vk{data(){return super.data()}}function xk(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new nt(Ne.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Vy{}class By extends Vy{}function Ps(n,e,...t){let i=[];e instanceof Vy&&i.push(e),i=i.concat(t),(function(u){const d=u.filter((g=>g instanceof Uy)).length,p=u.filter((g=>g instanceof vm)).length;if(d>1||d>0&&p>0)throw new nt(Ne.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(i);for(const l of i)n=l._apply(n);return n}class vm extends By{constructor(e,t,i){super(),this._field=e,this._op=t,this._value=i,this.type="where"}static _create(e,t,i){return new vm(e,t,i)}_apply(e){const t=this._parse(e);return wk(e._query,t),new wi(e.firestore,e.converter,xg(e._query,t))}_parse(e){const t=zu(e.firestore);return(function(u,d,p,g,y,w,j){let T;if(y.isKeyField()){if(w==="array-contains"||w==="array-contains-any")throw new nt(Ne.INVALID_ARGUMENT,`Invalid Query. You can't perform '${w}' queries on documentId().`);if(w==="in"||w==="not-in"){f2(j,w);const $=[];for(const F of j)$.push(m2(g,u,F));T={arrayValue:{values:$}}}else T=m2(g,u,j)}else w!=="in"&&w!=="not-in"&&w!=="array-contains-any"||f2(j,w),T=vI(p,d,j,w==="in"||w==="not-in");return Dn.create(y,w,T)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function fs(n,e,t){const i=e,l=Qo("where",n);return vm._create(l,i,t)}class Uy extends Vy{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Uy(e,t)}_parse(e){const t=this._queryConstraints.map((i=>i._parse(e))).filter((i=>i.getFilters().length>0));return t.length===1?t[0]:_a.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(l,u){let d=l;const p=u.getFlattenedFilters();for(const g of p)wk(d,g),d=xg(d,g)})(e._query,t),new wi(e.firestore,e.converter,xg(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Fy extends By{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new Fy(e,t)}_apply(e){const t=(function(l,u,d){if(l.startAt!==null)throw new nt(Ne.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(l.endAt!==null)throw new nt(Ne.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new _u(u,d)})(e._query,this._field,this._direction);return new wi(e.firestore,e.converter,QR(e._query,t))}}function Gh(n,e="asc"){const t=e,i=Qo("orderBy",n);return Fy._create(i,t)}class zy extends By{constructor(e,t,i){super(),this.type=e,this._limit=t,this._limitType=i}static _create(e,t,i){return new zy(e,t,i)}_apply(e){return new wi(e.firestore,e.converter,Uh(e._query,this._limit,this._limitType))}}function Kh(n){return wR("limit",n),zy._create("limit",n,"F")}function m2(n,e,t){if(typeof(t=Qs(t))=="string"){if(t==="")throw new nt(Ne.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!g_(e)&&t.indexOf("/")!==-1)throw new nt(Ne.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const i=e.path.child(nn.fromString(t));if(!jt.isDocumentKey(i))throw new nt(Ne.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return Sx(n,new jt(i))}if(t instanceof vn)return Sx(n,t._key);throw new nt(Ne.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${sm(t)}.`)}function f2(n,e){if(!Array.isArray(n)||n.length===0)throw new nt(Ne.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function wk(n,e){const t=(function(l,u){for(const d of l)for(const p of d.getFlattenedFilters())if(u.indexOf(p.op)>=0)return p.op;return null})(n.filters,(function(l){switch(l){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new nt(Ne.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new nt(Ne.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}function qy(n,e,t){let i;return i=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,i}class au{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Uo extends vk{constructor(e,t,i,l,u,d){super(e,t,i,l,d),this._firestore=e,this._firestoreImpl=e,this.metadata=u}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Th(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const i=this._document.data.field(Qo("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new nt(Ne.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=Uo._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}Uo._jsonSchemaVersion="firestore/documentSnapshot/1.0",Uo._jsonSchema={type:Pn("string",Uo._jsonSchemaVersion),bundleSource:Pn("string","DocumentSnapshot"),bundleName:Pn("string"),bundle:Pn("string")};class Th extends Uo{data(e={}){return super.data(e)}}class Fo{constructor(e,t,i,l){this._firestore=e,this._userDataWriter=t,this._snapshot=l,this.metadata=new au(l.hasPendingWrites,l.fromCache),this.query=i}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((i=>{e.call(t,new Th(this._firestore,this._userDataWriter,i.key,i,new au(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new nt(Ne.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(l,u){if(l._snapshot.oldDocs.isEmpty()){let d=0;return l._snapshot.docChanges.map((p=>{const g=new Th(l._firestore,l._userDataWriter,p.doc.key,p.doc,new au(l._snapshot.mutatedKeys.has(p.doc.key),l._snapshot.fromCache),l.query.converter);return p.doc,{type:"added",doc:g,oldIndex:-1,newIndex:d++}}))}{let d=l._snapshot.oldDocs;return l._snapshot.docChanges.filter((p=>u||p.type!==3)).map((p=>{const g=new Th(l._firestore,l._userDataWriter,p.doc.key,p.doc,new au(l._snapshot.mutatedKeys.has(p.doc.key),l._snapshot.fromCache),l.query.converter);let y=-1,w=-1;return p.type!==0&&(y=d.indexOf(p.doc.key),d=d.delete(p.doc.key)),p.type!==1&&(d=d.add(p.doc),w=d.indexOf(p.doc.key)),{type:kI(p.type),doc:g,oldIndex:y,newIndex:w}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new nt(Ne.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Fo._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=ay.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],i=[],l=[];return this.docs.forEach((u=>{u._document!==null&&(t.push(u._document),i.push(this._userDataWriter.convertObjectMap(u._document.data.value.mapValue.fields,"previous")),l.push(u.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function kI(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ot(61501,{type:n})}}Fo._jsonSchemaVersion="firestore/querySnapshot/1.0",Fo._jsonSchema={type:Pn("string",Fo._jsonSchemaVersion),bundleSource:Pn("string","QuerySnapshot"),bundleName:Pn("string"),bundle:Pn("string")};class jI{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=zu(e)}set(e,t,i){this._verifyNotCommitted();const l=Op(e,this._firestore),u=qy(l.converter,t,i),d=Iy(this._dataReader,"WriteBatch.set",l._key,u,l.converter!==null,i);return this._mutations.push(d.toMutation(l._key,Tr.none())),this}update(e,t,i,...l){this._verifyNotCommitted();const u=Op(e,this._firestore);let d;return d=typeof(t=Qs(t))=="string"||t instanceof ym?fk(this._dataReader,"WriteBatch.update",u._key,t,i,l):mk(this._dataReader,"WriteBatch.update",u._key,t),this._mutations.push(d.toMutation(u._key,Tr.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=Op(e,this._firestore);return this._mutations=this._mutations.concat(new dm(t._key,Tr.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new nt(Ne.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Op(n,e){if((n=Qs(n)).firestore!==e)throw new nt(Ne.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}function As(n){n=jr(n,vn);const e=jr(n.firestore,qa),t=Uu(e);return lI(t,n._key).then((i=>kk(e,n,i)))}function Ss(n){n=jr(n,wi);const e=jr(n.firestore,qa),t=Uu(e),i=new Oy(e);return xk(n._query),cI(t,n._query).then((l=>new Fo(e,i,n,l)))}function Ns(n,e,t){n=jr(n,vn);const i=jr(n.firestore,qa),l=qy(n.converter,e,t),u=zu(i);return Hu(i,[Iy(u,"setDoc",n._key,l,n.converter!==null,t).toMutation(n._key,Tr.none())])}function Da(n,e,t,...i){n=jr(n,vn);const l=jr(n.firestore,qa),u=zu(l);let d;return d=typeof(e=Qs(e))=="string"||e instanceof ym?fk(u,"updateDoc",n._key,e,t,i):mk(u,"updateDoc",n._key,e),Hu(l,[d.toMutation(n._key,Tr.exists(!0))])}function _r(n){return Hu(jr(n.firestore,qa),[new dm(n._key,Tr.none())])}function mi(n,e){const t=jr(n.firestore,qa),i=qe(n),l=qy(n.converter,e),u=zu(n.firestore);return Hu(t,[Iy(u,"addDoc",i._key,l,n.converter!==null,{}).toMutation(i._key,Tr.exists(!1))]).then((()=>i))}function _k(n,...e){n=Qs(n);let t={includeMetadataChanges:!1,source:"default"},i=0;typeof e[i]!="object"||h2(e[i])||(t=e[i++]);const l={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(h2(e[i])){const y=e[i];e[i]=y.next?.bind(y),e[i+1]=y.error?.bind(y),e[i+2]=y.complete?.bind(y)}let u,d,p;if(n instanceof vn)d=jr(n.firestore,qa),p=im(n._key.path),u={next:y=>{e[i]&&e[i](kk(d,n,y))},error:e[i+1],complete:e[i+2]};else{const y=jr(n,wi);d=jr(y.firestore,qa),p=y._query;const w=new Oy(d);u={next:j=>{e[i]&&e[i](new Fo(d,w,y,j))},error:e[i+1],complete:e[i+2]},xk(n._query)}const g=Uu(d);return oI(g,p,l,u)}function Hu(n,e){const t=Uu(n);return uI(t,e)}function kk(n,e,t){const i=t.docs.get(e._key),l=new Oy(n);return new Uo(n,l,e._key,i,new au(t.hasPendingWrites,t.fromCache),e.converter)}function p2(n){return n=jr(n,qa),Uu(n),new jI(n,(e=>Hu(n,e)))}(function(e,t=!0){cR(Jo),$o(new io("firestore",((i,{instanceIdentifier:l,options:u})=>{const d=i.getProvider("app").getImmediate(),p=new qa(new hR(i.getProvider("auth-internal")),new pR(d,i.getProvider("app-check-internal")),IR(d,l),d);return u={useFetchStreams:t,...u},p._setSettings(u),p}),"PUBLIC").setMultipleInstances(!0)),La(u2,d2,e),La(u2,d2,"esm2020")})();var TI="firebase",EI="12.8.0";La(TI,EI,"app");const jk="firebasestorage.googleapis.com",Tk="storageBucket",SI=120*1e3,NI=600*1e3;class wn extends Ha{constructor(e,t,i=0){super(Vp(e),`Firebase Storage: ${t} (${Vp(e)})`),this.status_=i,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,wn.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Vp(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var xn;(function(n){n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(xn||(xn={}));function Vp(n){return"storage/"+n}function Hy(){const n="An unknown error occurred, please check the error payload for server response.";return new wn(xn.UNKNOWN,n)}function CI(n){return new wn(xn.OBJECT_NOT_FOUND,"Object '"+n+"' does not exist.")}function RI(n){return new wn(xn.QUOTA_EXCEEDED,"Quota for bucket '"+n+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function AI(){const n="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new wn(xn.UNAUTHENTICATED,n)}function MI(){return new wn(xn.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function II(n){return new wn(xn.UNAUTHORIZED,"User does not have permission to access '"+n+"'.")}function DI(){return new wn(xn.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function PI(){return new wn(xn.CANCELED,"User canceled the upload/download.")}function LI(n){return new wn(xn.INVALID_URL,"Invalid URL '"+n+"'.")}function OI(n){return new wn(xn.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function VI(){return new wn(xn.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+Tk+"' property when initializing the app?")}function BI(){return new wn(xn.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function UI(){return new wn(xn.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function FI(n){return new wn(xn.UNSUPPORTED_ENVIRONMENT,`${n} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function Rg(n){return new wn(xn.INVALID_ARGUMENT,n)}function Ek(){return new wn(xn.APP_DELETED,"The Firebase app was deleted.")}function zI(n){return new wn(xn.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function hu(n,e){return new wn(xn.INVALID_FORMAT,"String does not match format '"+n+"': "+e)}function Qc(n){throw new wn(xn.INTERNAL_ERROR,"Internal error: "+n)}class kr{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let i;try{i=kr.makeFromUrl(e,t)}catch{return new kr(e,"")}if(i.path==="")return i;throw OI(e)}static makeFromUrl(e,t){let i=null;const l="([A-Za-z0-9.\\-_]+)";function u(ye){ye.path.charAt(ye.path.length-1)==="/"&&(ye.path_=ye.path_.slice(0,-1))}const d="(/(.*))?$",p=new RegExp("^gs://"+l+d,"i"),g={bucket:1,path:3};function y(ye){ye.path_=decodeURIComponent(ye.path)}const w="v[A-Za-z0-9_]+",j=t.replace(/[.]/g,"\\."),T="(/([^?#]*).*)?$",V=new RegExp(`^https?://${j}/${w}/b/${l}/o${T}`,"i"),$={bucket:1,path:3},F=t===jk?"(?:storage.googleapis.com|storage.cloud.google.com)":t,U="([^?#]*)",te=new RegExp(`^https?://${F}/${l}/${U}`,"i"),re=[{regex:p,indices:g,postModify:u},{regex:V,indices:$,postModify:y},{regex:te,indices:{bucket:1,path:2},postModify:y}];for(let ye=0;ye<re.length;ye++){const ve=re[ye],ge=ve.regex.exec(e);if(ge){const R=ge[ve.indices.bucket];let E=ge[ve.indices.path];E||(E=""),i=new kr(R,E),ve.postModify(i);break}}if(i==null)throw LI(e);return i}}class qI{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function HI(n,e,t){let i=1,l=null,u=null,d=!1,p=0;function g(){return p===2}let y=!1;function w(...U){y||(y=!0,e.apply(null,U))}function j(U){l=setTimeout(()=>{l=null,n(V,g())},U)}function T(){u&&clearTimeout(u)}function V(U,...te){if(y){T();return}if(U){T(),w.call(null,U,...te);return}if(g()||d){T(),w.call(null,U,...te);return}i<64&&(i*=2);let re;p===1?(p=2,re=0):re=(i+Math.random())*1e3,j(re)}let $=!1;function F(U){$||($=!0,T(),!y&&(l!==null?(U||(p=2),clearTimeout(l),j(0)):U||(p=1)))}return j(0),u=setTimeout(()=>{d=!0,F(!0)},t),F}function $I(n){n(!1)}function WI(n){return n!==void 0}function GI(n){return typeof n=="object"&&!Array.isArray(n)}function $y(n){return typeof n=="string"||n instanceof String}function g2(n){return Wy()&&n instanceof Blob}function Wy(){return typeof Blob<"u"}function Ag(n,e,t,i){if(i<e)throw Rg(`Invalid value for '${n}'. Expected ${e} or greater.`);if(i>t)throw Rg(`Invalid value for '${n}'. Expected ${t} or less.`)}function xm(n,e,t){let i=e;return t==null&&(i=`https://${e}`),`${t}://${i}/v0${n}`}function Sk(n){const e=encodeURIComponent;let t="?";for(const i in n)if(n.hasOwnProperty(i)){const l=e(i)+"="+e(n[i]);t=t+l+"&"}return t=t.slice(0,-1),t}var zo;(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"})(zo||(zo={}));function KI(n,e){const t=n>=500&&n<600,l=[408,429].indexOf(n)!==-1,u=e.indexOf(n)!==-1;return t||l||u}class YI{constructor(e,t,i,l,u,d,p,g,y,w,j,T=!0,V=!1){this.url_=e,this.method_=t,this.headers_=i,this.body_=l,this.successCodes_=u,this.additionalRetryCodes_=d,this.callback_=p,this.errorCallback_=g,this.timeout_=y,this.progressCallback_=w,this.connectionFactory_=j,this.retry=T,this.isUsingEmulator=V,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise(($,F)=>{this.resolve_=$,this.reject_=F,this.start_()})}start_(){const e=(i,l)=>{if(l){i(!1,new ih(!1,null,!0));return}const u=this.connectionFactory_();this.pendingConnection_=u;const d=p=>{const g=p.loaded,y=p.lengthComputable?p.total:-1;this.progressCallback_!==null&&this.progressCallback_(g,y)};this.progressCallback_!==null&&u.addUploadProgressListener(d),u.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&u.removeUploadProgressListener(d),this.pendingConnection_=null;const p=u.getErrorCode()===zo.NO_ERROR,g=u.getStatus();if(!p||KI(g,this.additionalRetryCodes_)&&this.retry){const w=u.getErrorCode()===zo.ABORT;i(!1,new ih(!1,null,w));return}const y=this.successCodes_.indexOf(g)!==-1;i(!0,new ih(y,u))})},t=(i,l)=>{const u=this.resolve_,d=this.reject_,p=l.connection;if(l.wasSuccessCode)try{const g=this.callback_(p,p.getResponse());WI(g)?u(g):u()}catch(g){d(g)}else if(p!==null){const g=Hy();g.serverResponse=p.getErrorText(),this.errorCallback_?d(this.errorCallback_(p,g)):d(g)}else if(l.canceled){const g=this.appDelete_?Ek():PI();d(g)}else{const g=DI();d(g)}};this.canceled_?t(!1,new ih(!1,null,!0)):this.backoffId_=HI(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&$I(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class ih{constructor(e,t,i){this.wasSuccessCode=e,this.connection=t,this.canceled=!!i}}function QI(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function XI(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function JI(n,e){e&&(n["X-Firebase-GMPID"]=e)}function ZI(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function e3(n,e,t,i,l,u,d=!0,p=!1){const g=Sk(n.urlParams),y=n.url+g,w=Object.assign({},n.headers);return JI(w,e),QI(w,t),XI(w,u),ZI(w,i),new YI(y,n.method,w,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,l,d,p)}function t3(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function s3(...n){const e=t3();if(e!==void 0){const t=new e;for(let i=0;i<n.length;i++)t.append(n[i]);return t.getBlob()}else{if(Wy())return new Blob(n);throw new wn(xn.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function n3(n,e,t){return n.webkitSlice?n.webkitSlice(e,t):n.mozSlice?n.mozSlice(e,t):n.slice?n.slice(e,t):null}function r3(n){if(typeof atob>"u")throw FI("base-64");return atob(n)}const Pa={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class Bp{constructor(e,t){this.data=e,this.contentType=t||null}}function a3(n,e){switch(n){case Pa.RAW:return new Bp(Nk(e));case Pa.BASE64:case Pa.BASE64URL:return new Bp(Ck(n,e));case Pa.DATA_URL:return new Bp(o3(e),l3(e))}throw Hy()}function Nk(n){const e=[];for(let t=0;t<n.length;t++){let i=n.charCodeAt(t);if(i<=127)e.push(i);else if(i<=2047)e.push(192|i>>6,128|i&63);else if((i&64512)===55296)if(!(t<n.length-1&&(n.charCodeAt(t+1)&64512)===56320))e.push(239,191,189);else{const u=i,d=n.charCodeAt(++t);i=65536|(u&1023)<<10|d&1023,e.push(240|i>>18,128|i>>12&63,128|i>>6&63,128|i&63)}else(i&64512)===56320?e.push(239,191,189):e.push(224|i>>12,128|i>>6&63,128|i&63)}return new Uint8Array(e)}function i3(n){let e;try{e=decodeURIComponent(n)}catch{throw hu(Pa.DATA_URL,"Malformed data URL.")}return Nk(e)}function Ck(n,e){switch(n){case Pa.BASE64:{const l=e.indexOf("-")!==-1,u=e.indexOf("_")!==-1;if(l||u)throw hu(n,"Invalid character '"+(l?"-":"_")+"' found: is it base64url encoded?");break}case Pa.BASE64URL:{const l=e.indexOf("+")!==-1,u=e.indexOf("/")!==-1;if(l||u)throw hu(n,"Invalid character '"+(l?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let t;try{t=r3(e)}catch(l){throw l.message.includes("polyfill")?l:hu(n,"Invalid character found")}const i=new Uint8Array(t.length);for(let l=0;l<t.length;l++)i[l]=t.charCodeAt(l);return i}class Rk{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(t===null)throw hu(Pa.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const i=t[1]||null;i!=null&&(this.base64=c3(i,";base64"),this.contentType=this.base64?i.substring(0,i.length-7):i),this.rest=e.substring(e.indexOf(",")+1)}}function o3(n){const e=new Rk(n);return e.base64?Ck(Pa.BASE64,e.rest):i3(e.rest)}function l3(n){return new Rk(n).contentType}function c3(n,e){return n.length>=e.length?n.substring(n.length-e.length)===e:!1}class Ji{constructor(e,t){let i=0,l="";g2(e)?(this.data_=e,i=e.size,l=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),i=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),i=e.length),this.size_=i,this.type_=l}size(){return this.size_}type(){return this.type_}slice(e,t){if(g2(this.data_)){const i=this.data_,l=n3(i,e,t);return l===null?null:new Ji(l)}else{const i=new Uint8Array(this.data_.buffer,e,t-e);return new Ji(i,!0)}}static getBlob(...e){if(Wy()){const t=e.map(i=>i instanceof Ji?i.data_:i);return new Ji(s3.apply(null,t))}else{const t=e.map(d=>$y(d)?a3(Pa.RAW,d).data:d.data_);let i=0;t.forEach(d=>{i+=d.byteLength});const l=new Uint8Array(i);let u=0;return t.forEach(d=>{for(let p=0;p<d.length;p++)l[u++]=d[p]}),new Ji(l,!0)}}uploadData(){return this.data_}}function Gy(n){let e;try{e=JSON.parse(n)}catch{return null}return GI(e)?e:null}function u3(n){if(n.length===0)return null;const e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function d3(n,e){const t=e.split("/").filter(i=>i.length>0).join("/");return n.length===0?t:n+"/"+t}function Ak(n){const e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}function h3(n,e){return e}class wr{constructor(e,t,i,l){this.server=e,this.local=t||e,this.writable=!!i,this.xform=l||h3}}let oh=null;function m3(n){return!$y(n)||n.length<2?n:Ak(n)}function Mk(){if(oh)return oh;const n=[];n.push(new wr("bucket")),n.push(new wr("generation")),n.push(new wr("metageneration")),n.push(new wr("name","fullPath",!0));function e(u,d){return m3(d)}const t=new wr("name");t.xform=e,n.push(t);function i(u,d){return d!==void 0?Number(d):d}const l=new wr("size");return l.xform=i,n.push(l),n.push(new wr("timeCreated")),n.push(new wr("updated")),n.push(new wr("md5Hash",null,!0)),n.push(new wr("cacheControl",null,!0)),n.push(new wr("contentDisposition",null,!0)),n.push(new wr("contentEncoding",null,!0)),n.push(new wr("contentLanguage",null,!0)),n.push(new wr("contentType",null,!0)),n.push(new wr("metadata","customMetadata",!0)),oh=n,oh}function f3(n,e){function t(){const i=n.bucket,l=n.fullPath,u=new kr(i,l);return e._makeStorageReference(u)}Object.defineProperty(n,"ref",{get:t})}function p3(n,e,t){const i={};i.type="file";const l=t.length;for(let u=0;u<l;u++){const d=t[u];i[d.local]=d.xform(i,e[d.server])}return f3(i,n),i}function Ik(n,e,t){const i=Gy(e);return i===null?null:p3(n,i,t)}function g3(n,e,t,i){const l=Gy(e);if(l===null||!$y(l.downloadTokens))return null;const u=l.downloadTokens;if(u.length===0)return null;const d=encodeURIComponent;return u.split(",").map(y=>{const w=n.bucket,j=n.fullPath,T="/b/"+d(w)+"/o/"+d(j),V=xm(T,t,i),$=Sk({alt:"media",token:y});return V+$})[0]}function y3(n,e){const t={},i=e.length;for(let l=0;l<i;l++){const u=e[l];u.writable&&(t[u.server]=n[u.local])}return JSON.stringify(t)}const y2="prefixes",b2="items";function b3(n,e,t){const i={prefixes:[],items:[],nextPageToken:t.nextPageToken};if(t[y2])for(const l of t[y2]){const u=l.replace(/\/$/,""),d=n._makeStorageReference(new kr(e,u));i.prefixes.push(d)}if(t[b2])for(const l of t[b2]){const u=n._makeStorageReference(new kr(e,l.name));i.items.push(u)}return i}function v3(n,e,t){const i=Gy(t);return i===null?null:b3(n,e,i)}class Ky{constructor(e,t,i,l){this.url=e,this.method=t,this.handler=i,this.timeout=l,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function Yy(n){if(!n)throw Hy()}function x3(n,e){function t(i,l){const u=Ik(n,l,e);return Yy(u!==null),u}return t}function w3(n,e){function t(i,l){const u=v3(n,e,l);return Yy(u!==null),u}return t}function _3(n,e){function t(i,l){const u=Ik(n,l,e);return Yy(u!==null),g3(u,l,n.host,n._protocol)}return t}function Qy(n){function e(t,i){let l;return t.getStatus()===401?t.getErrorText().includes("Firebase App Check token is invalid")?l=MI():l=AI():t.getStatus()===402?l=RI(n.bucket):t.getStatus()===403?l=II(n.path):l=i,l.status=t.getStatus(),l.serverResponse=i.serverResponse,l}return e}function k3(n){const e=Qy(n);function t(i,l){let u=e(i,l);return i.getStatus()===404&&(u=CI(n.path)),u.serverResponse=l.serverResponse,u}return t}function j3(n,e,t,i,l){const u={};e.isRoot?u.prefix="":u.prefix=e.path+"/",t.length>0&&(u.delimiter=t),i&&(u.pageToken=i),l&&(u.maxResults=l);const d=e.bucketOnlyServerUrl(),p=xm(d,n.host,n._protocol),g="GET",y=n.maxOperationRetryTime,w=new Ky(p,g,w3(n,e.bucket),y);return w.urlParams=u,w.errorHandler=Qy(e),w}function T3(n,e,t){const i=e.fullServerUrl(),l=xm(i,n.host,n._protocol),u="GET",d=n.maxOperationRetryTime,p=new Ky(l,u,_3(n,t),d);return p.errorHandler=k3(e),p}function E3(n,e){return n&&n.contentType||e&&e.type()||"application/octet-stream"}function S3(n,e,t){const i=Object.assign({},t);return i.fullPath=n.path,i.size=e.size(),i.contentType||(i.contentType=E3(null,e)),i}function N3(n,e,t,i,l){const u=e.bucketOnlyServerUrl(),d={"X-Goog-Upload-Protocol":"multipart"};function p(){let re="";for(let ye=0;ye<2;ye++)re=re+Math.random().toString().slice(2);return re}const g=p();d["Content-Type"]="multipart/related; boundary="+g;const y=S3(e,i,l),w=y3(y,t),j="--"+g+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+w+`\r
--`+g+`\r
Content-Type: `+y.contentType+`\r
\r
`,T=`\r
--`+g+"--",V=Ji.getBlob(j,i,T);if(V===null)throw BI();const $={name:y.fullPath},F=xm(u,n.host,n._protocol),U="POST",te=n.maxUploadRetryTime,K=new Ky(F,U,x3(n,t),te);return K.urlParams=$,K.headers=d,K.body=V.uploadData(),K.errorHandler=Qy(e),K}class C3{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=zo.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=zo.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=zo.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,i,l,u){if(this.sent_)throw Qc("cannot .send() more than once");if(fo(e)&&i&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(t,e,!0),u!==void 0)for(const d in u)u.hasOwnProperty(d)&&this.xhr_.setRequestHeader(d,u[d].toString());return l!==void 0?this.xhr_.send(l):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Qc("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Qc("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw Qc("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Qc("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class R3 extends C3{initXhr(){this.xhr_.responseType="text"}}function Xy(){return new R3}class Xo{constructor(e,t){this._service=e,t instanceof kr?this._location=t:this._location=kr.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new Xo(e,t)}get root(){const e=new kr(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return Ak(this._location.path)}get storage(){return this._service}get parent(){const e=u3(this._location.path);if(e===null)return null;const t=new kr(this._location.bucket,e);return new Xo(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw zI(e)}}function A3(n,e,t){n._throwIfRoot("uploadBytes");const i=N3(n.storage,n._location,Mk(),new Ji(e,!0),t);return n.storage.makeRequestWithTokens(i,Xy).then(l=>({metadata:l,ref:n}))}function M3(n){const e={prefixes:[],items:[]};return Dk(n,e).then(()=>e)}async function Dk(n,e,t){const l=await I3(n,{pageToken:t});e.prefixes.push(...l.prefixes),e.items.push(...l.items),l.nextPageToken!=null&&await Dk(n,e,l.nextPageToken)}function I3(n,e){e!=null&&typeof e.maxResults=="number"&&Ag("options.maxResults",1,1e3,e.maxResults);const t=e||{},i=j3(n.storage,n._location,"/",t.pageToken,t.maxResults);return n.storage.makeRequestWithTokens(i,Xy)}function D3(n){n._throwIfRoot("getDownloadURL");const e=T3(n.storage,n._location,Mk());return n.storage.makeRequestWithTokens(e,Xy).then(t=>{if(t===null)throw UI();return t})}function P3(n,e){const t=d3(n._location.path,e),i=new kr(n._location.bucket,t);return new Xo(n.storage,i)}function L3(n){return/^[A-Za-z]+:\/\//.test(n)}function O3(n,e){return new Xo(n,e)}function Pk(n,e){if(n instanceof Jy){const t=n;if(t._bucket==null)throw VI();const i=new Xo(t,t._bucket);return e!=null?Pk(i,e):i}else return e!==void 0?P3(n,e):n}function V3(n,e){if(e&&L3(e)){if(n instanceof Jy)return O3(n,e);throw Rg("To use ref(service, url), the first argument must be a Storage instance.")}else return Pk(n,e)}function v2(n,e){const t=e?.[Tk];return t==null?null:kr.makeFromBucketSpec(t,n)}function B3(n,e,t,i={}){n.host=`${e}:${t}`;const l=fo(e);l&&(qg(`https://${n.host}/b`),Hg("Storage",!0)),n._isUsingEmulator=!0,n._protocol=l?"https":"http";const{mockUserToken:u}=i;u&&(n._overrideAuthToken=typeof u=="string"?u:rw(u,n.app.options.projectId))}class Jy{constructor(e,t,i,l,u,d=!1){this.app=e,this._authProvider=t,this._appCheckProvider=i,this._url=l,this._firebaseVersion=u,this._isUsingEmulator=d,this._bucket=null,this._host=jk,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=SI,this._maxUploadRetryTime=NI,this._requests=new Set,l!=null?this._bucket=kr.makeFromBucketSpec(l,this._host):this._bucket=v2(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=kr.makeFromBucketSpec(this._url,e):this._bucket=v2(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){Ag("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){Ag("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(Gr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Xo(this,e)}_makeRequest(e,t,i,l,u=!0){if(this._deleted)return new qI(Ek());{const d=e3(e,this._appId,i,l,t,this._firebaseVersion,u,this._isUsingEmulator);return this._requests.add(d),d.getPromise().then(()=>this._requests.delete(d),()=>this._requests.delete(d)),d}}async makeRequestWithTokens(e,t){const[i,l]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,i,l).getPromise()}}const x2="@firebase/storage",w2="0.14.0";const Lk="storage";function Up(n,e,t){return n=Qs(n),A3(n,e,t)}function _2(n){return n=Qs(n),M3(n)}function qo(n){return n=Qs(n),D3(n)}function eo(n,e){return n=Qs(n),V3(n,e)}function U3(n=Kg(),e){n=Qs(n);const i=Jh(n,Lk).getImmediate({identifier:e}),l=tw("storage");return l&&F3(i,...l),i}function F3(n,e,t,i={}){B3(n,e,t,i)}function z3(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),i=n.getProvider("auth-internal"),l=n.getProvider("app-check-internal");return new Jy(t,i,l,e,Jo)}function q3(){$o(new io(Lk,z3,"PUBLIC").setMultipleInstances(!0)),La(x2,w2,""),La(x2,w2,"esm2020")}q3();const Ok={apiKey:"AIzaSyBCIgMJd3By7qkWH27YiW9VooIBGE3bFLs",authDomain:"mind-core-fitness-client.firebaseapp.com",projectId:"mind-core-fitness-client",storageBucket:"mind-core-fitness-client.firebasestorage.app",messagingSenderId:"669343392406",appId:"1:669343392406:web:f5a35ee062387e7d6f58b7"},Zy=Gg(Ok),Do=qw(Zy),fe=fI(Zy),to=U3(Zy),H3=Gg(Ok,"secondary"),OP=qw(H3),$3="EYdciKDOi3UYBLk1u8hHams5tmO2",Vk=v.createContext();function Vr(){return v.useContext(Vk)}function W3({children:n}){const[e,t]=v.useState(null),[i,l]=v.useState(!1),[u,d]=v.useState(!1),[p,g]=v.useState(null),[y,w]=v.useState(!0);v.useEffect(()=>{let K=null;const re=XC(Do,ye=>{if(t(ye),K&&(K(),K=null),ye)if(ye.uid===$3)l(!0),d(!1),g(null),w(!1);else{l(!1);const ve=Ps(Ft(fe,"clients"),fs("uid","==",ye.uid)),ge=async()=>{const R=localStorage.getItem("mcf_clientId");if(R)try{const E=await As(qe(fe,"clients",R));E.exists()&&(d(!0),g({id:E.id,...E.data()}))}catch(E){console.error("Direct client read failed:",E)}};K=_k(ve,async R=>{if(R.empty)await ge();else{const E=R.docs[0];d(!0),g({id:E.id,...E.data()});try{localStorage.setItem("mcf_clientId",E.id)}catch{}}w(!1)},async R=>{console.error("Error listening to client data:",R),await ge(),w(!1)})}else l(!1),d(!1),g(null),w(!1)});return()=>{re(),K&&K()}},[]);const te={currentUser:e,isAdmin:i,isClient:u,clientData:p,updateClientData:K=>{g(re=>re?{...re,...K}:K)},resolveClient:async()=>{if(p)return p;const K=localStorage.getItem("mcf_clientId");if(K)try{const re=await As(qe(fe,"clients",K));if(re.exists()){const ye={id:re.id,...re.data()};return d(!0),g(ye),ye}}catch(re){console.error("resolveClient direct read failed:",re)}if(e){const re=Ps(Ft(fe,"clients"),fs("uid","==",e.uid)),ye=await Ss(re);if(!ye.empty){const ve={id:ye.docs[0].id,...ye.docs[0].data()};return d(!0),g(ve),ve}}return null},login:async(K,re,ye=!0)=>(await ax(Do,ye?hg:ty),await KC(Do,K,re)),signup:async(K,re,ye)=>{await ax(Do,hg);const ve=await GC(Do,re.trim().toLowerCase(),ye),ge=ve.user,R=qe(Ft(fe,"clients")),E={uid:ge.uid,name:K.trim(),email:re.trim().toLowerCase(),clientType:"core_buddy",coreBuddyAccess:!0,status:"active",tier:"free",subscriptionStatus:null,signupSource:"self_signup",createdAt:wt.now()};await Ns(R,E),d(!0),g({id:R.id,...E});try{localStorage.setItem("mcf_clientId",R.id)}catch{}return ve},logout:()=>{try{localStorage.removeItem("mcf_clientId")}catch{}return JC(Do)},resetPassword:K=>WC(Do,K),loading:y};return r.jsx(Vk.Provider,{value:te,children:n})}const Bk=v.createContext();function Ea(){return v.useContext(Bk)}function G3({children:n}){const[e,t]=v.useState(()=>{const g=localStorage.getItem("theme");return g?g==="dark":window.matchMedia("(prefers-color-scheme: dark)").matches}),[i,l]=v.useState(()=>localStorage.getItem("accent")||"red");v.useEffect(()=>{document.documentElement.setAttribute("data-theme",e?"dark":"light"),localStorage.setItem("theme",e?"dark":"light")},[e]),v.useEffect(()=>{localStorage.setItem("accent",i)},[i]);const p={isDark:e,toggleTheme:()=>{document.documentElement.setAttribute("data-theme-transitioning",""),t(!e),setTimeout(()=>{document.documentElement.removeAttribute("data-theme-transitioning")},350)},accent:i,setAccent:g=>l(g)};return r.jsx(Bk.Provider,{value:p,children:n})}const Uk=v.createContext();function wm(){return v.useContext(Uk)}const K3=["nutrition","consistency","personalBests","achievements","buddies","programmes","leaderboard"],Y3=[5,10],Q3=1;function X3({children:n}){const{clientData:e,loading:t}=Vr(),i=v.useMemo(()=>{const l=e?.tier||"free",u=e?.subscriptionStatus||null,d=e&&e.signupSource!=="self_signup",p=l==="premium"||!!d;function g(y){return p?!0:!K3.includes(y)}return{tier:l,subscriptionStatus:u,isPremium:p,canAccess:g,loading:t,FREE_RANDOMISER_DURATIONS:Y3,FREE_RANDOMISER_WEEKLY_LIMIT:Q3}},[e?.tier,e?.subscriptionStatus,e?.signupSource,t]);return r.jsx(Uk.Provider,{value:i,children:n})}function J3(n){if(n?.signupSource==="self_signup"&&!n?.onboardingComplete)return"/onboarding";const e=n?.clientType;return e==="core_buddy"?"/client/core-buddy":e==="circuit_vip"||e==="circuit_dropin"?"/client/circuit":"/client"}function Z3({className:n=""}){const{isDark:e,toggleTheme:t}=Ea();return r.jsx("button",{className:n||"theme-toggle",onClick:t,"aria-label":e?"Switch to light mode":"Switch to dark mode",children:e?r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20",children:r.jsx("path",{d:"M12 3a9 9 0 109 9c0-.46-.04-.92-.1-1.36a5.389 5.389 0 01-4.4 2.26 5.403 5.403 0 01-3.14-9.8c-.44-.06-.9-.1-1.36-.1z"})}):r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20",children:r.jsx("path",{d:"M12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zM2 13h2c.55 0 1-.45 1-1s-.45-1-1-1H2c-.55 0-1 .45-1 1s.45 1 1 1zm18 0h2c.55 0 1-.45 1-1s-.45-1-1-1h-2c-.55 0-1 .45-1 1s.45 1 1 1zM11 2v2c0 .55.45 1 1 1s1-.45 1-1V2c0-.55-.45-1-1-1s-1 .45-1 1zm0 18v2c0 .55.45 1 1 1s1-.45 1-1v-2c0-.55-.45-1-1-1s-1 .45-1 1zM5.99 4.58a.996.996 0 00-1.41 0 .996.996 0 000 1.41l1.06 1.06c.39.39 1.03.39 1.41 0s.39-1.03 0-1.41L5.99 4.58zm12.37 12.37a.996.996 0 00-1.41 0 .996.996 0 000 1.41l1.06 1.06c.39.39 1.03.39 1.41 0a.996.996 0 000-1.41l-1.06-1.06zm1.06-10.96a.996.996 0 000-1.41.996.996 0 00-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06zM7.05 18.36a.996.996 0 000-1.41.996.996 0 00-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06z"})})})}function eD(){const[n,e]=v.useState(""),[t,i]=v.useState(""),[l,u]=v.useState(!0),[d,p]=v.useState(""),[g,y]=v.useState(!1),[w,j]=v.useState(!1),[T,V]=v.useState(!1),{login:$,resetPassword:F,currentUser:U,isAdmin:te,isClient:K,clientData:re,loading:ye}=Vr(),ve=Gn();if(v.useEffect(()=>{!ye&&U&&(te?ve("/dashboard"):K?ve(J3(re)):(y(!1),p("No account found. Please sign up or contact your trainer.")))},[ye,U,te,K,re,ve]),ye||U)return null;const ge=async E=>{E.preventDefault(),p(""),y(!0);try{await $(n,t,l)}catch(A){p(A.message||"Failed to log in"),y(!1)}},R=async E=>{if(E.preventDefault(),p(""),!n.trim()){p("Please enter your email address");return}y(!0);try{await F(n.trim()),V(!0)}catch(A){A.code==="auth/user-not-found"?p("No account found with this email"):p(A.message||"Failed to send reset email")}y(!1)};return r.jsxs("div",{className:"login-container",children:[r.jsx(Z3,{className:"login-theme-toggle"}),r.jsxs("div",{className:"login-card",children:[r.jsxs("div",{className:"login-header",children:[r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"login-logo"}),r.jsx("p",{children:r.jsx("strong",{children:w?"Reset Password":"Sign in as 1-2-1 or a Core Buddy"})})]}),d&&r.jsx("div",{className:"error-message",children:d}),T?r.jsxs("div",{className:"reset-sent",children:[r.jsx("div",{className:"reset-sent-icon",children:r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M22 2L11 13",strokeLinecap:"round",strokeLinejoin:"round"}),r.jsx("path",{d:"M22 2L15 22L11 13L2 9L22 2Z",strokeLinecap:"round",strokeLinejoin:"round"})]})}),r.jsx("p",{children:"Reset email sent!"}),r.jsx("span",{children:"Check your inbox for a password reset link"}),r.jsx("button",{className:"login-btn",style:{marginTop:"20px"},onClick:()=>{j(!1),V(!1),p("")},children:"Back to Log In"})]}):w?r.jsxs("form",{onSubmit:R,children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"email",children:"Email"}),r.jsx("input",{type:"email",id:"email",value:n,onChange:E=>e(E.target.value),placeholder:"Enter your email",required:!0})]}),r.jsx("button",{type:"submit",className:"login-btn",disabled:g,children:g?"Sending...":"Send Reset Link"}),r.jsx("button",{type:"button",className:"forgot-link",onClick:()=>{j(!1),p("")},children:"Back to Log In"})]}):r.jsxs(r.Fragment,{children:[r.jsxs("form",{onSubmit:ge,children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"email",children:"Email"}),r.jsx("input",{type:"email",id:"email",value:n,onChange:E=>e(E.target.value),required:!0})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"password",children:"Password"}),r.jsx("input",{type:"password",id:"password",value:t,onChange:E=>i(E.target.value),required:!0})]}),r.jsx("div",{className:"remember-me",children:r.jsxs("label",{children:[r.jsx("input",{type:"checkbox",checked:l,onChange:E=>u(E.target.checked)}),r.jsx("span",{children:"Remember me"})]})}),r.jsx("button",{type:"submit",className:"login-btn",disabled:g,children:g?"Logging in...":"Log In"})]}),r.jsx("button",{type:"button",className:"forgot-link",onClick:()=>{j(!0),p("")},children:"Forgot password?"})]}),r.jsx("a",{href:"/",className:"back-link",children:"Back to website"})]})]})}function Il({feature:n,children:e}){const{canAccess:t,loading:i}=wm(),l=Gn();return i||t(n)?e:r.jsxs("div",{className:"locked-feature-wrap",children:[r.jsx("div",{className:"locked-feature-bg","aria-hidden":"true",children:e}),r.jsx("div",{className:"locked-feature-overlay",children:r.jsxs("div",{className:"locked-feature-card",children:[r.jsx("div",{className:"locked-icon",children:r.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),r.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]})}),r.jsx("h2",{children:"Premium Feature"}),r.jsx("p",{children:"Upgrade to Core Buddy Premium to unlock this feature and get full access to everything."}),r.jsx("button",{className:"locked-upgrade-btn",onClick:()=>l("/upgrade"),children:"Upgrade Now"})]})})]})}function la({active:n}){const e=Gn(),{clientData:t}=Vr(),{isPremium:i}=wm(),l=t?.clientType==="block"&&t?.coreBuddyAccess;return r.jsxs("nav",{className:"block-bottom-nav",children:[r.jsxs("button",{className:`block-nav-tab${n==="home"?" active":""}`,onClick:()=>e("/client/core-buddy"),children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),r.jsx("circle",{cx:"12",cy:"7",r:"4"})]}),r.jsx("span",{children:"Profile"})]}),r.jsxs("button",{className:`block-nav-tab${n==="workouts"?" active":""}`,onClick:()=>e("/client/core-buddy/workouts"),children:[r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"currentColor",stroke:"none",children:r.jsx("path",{d:"M1 9h2v6H1V9zm3-2h2v10H4V7zm3 4h10v2H7v-2zm10-4h2v10h-2V7zm3 2h2v6h-2V9z"})}),r.jsx("span",{children:"Workouts"})]}),r.jsxs("button",{className:`block-nav-tab${n==="nutrition"?" active":""}`,onClick:()=>e(i?"/client/core-buddy/nutrition":"/upgrade"),children:[r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M18 8h1a4 4 0 0 1 0 8h-1M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z"})}),r.jsx("span",{children:"Nutrition"})]}),r.jsxs("button",{className:`block-nav-tab${n==="buddies"?" active":""}`,onClick:()=>e(i?"/client/core-buddy/buddies":"/upgrade"),children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),r.jsx("circle",{cx:"9",cy:"7",r:"4"}),r.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),r.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),r.jsx("span",{children:"Buddies"})]}),l&&r.jsxs("button",{className:"block-nav-tab",onClick:()=>e("/client"),children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"3",width:"7",height:"7"}),r.jsx("rect",{x:"14",y:"3",width:"7",height:"7"}),r.jsx("rect",{x:"14",y:"14",width:"7",height:"7"}),r.jsx("rect",{x:"3",y:"14",width:"7",height:"7"})]}),r.jsx("span",{children:"Block"})]})]})}function ka({children:n,onRefresh:e}){const[t,i]=v.useState(0),[l,u]=v.useState(!1),d=v.useRef(null),p=v.useRef(0),g=v.useRef(!1),y=v.useCallback(T=>{window.scrollY<=0&&(p.current=T.touches[0].clientY,g.current=!0)},[]),w=v.useCallback(T=>{if(!g.current||l)return;const V=T.touches[0].clientY-p.current;V>20&&window.scrollY<=0&&(T.preventDefault(),i(Math.min((V-20)*.35,80)))},[l]),j=v.useCallback(async()=>{t>55&&!l&&(u(!0),e?await e():window.location.reload(),u(!1)),i(0),g.current=!1},[t,l,e]);return r.jsxs("div",{ref:d,onTouchStart:y,onTouchMove:w,onTouchEnd:j,children:[r.jsxs("div",{className:`pull-refresh-indicator ${t>0?"visible":""} ${l?"refreshing":""}`,style:{height:t},children:[r.jsx("div",{className:`refresh-spinner ${l?"spinning":""}`,children:r.jsx("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:r.jsx("path",{fill:"currentColor",d:"M17.65 6.35A7.958 7.958 0 0012 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08A5.99 5.99 0 0112 18c-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"})})}),r.jsx("span",{className:"refresh-text",children:l?"Refreshing...":"Pull to refresh"})]}),n]})}function $u(n,e,t,i,l){const u=[];for(let d=0;d<n;d++){const p=(d*(360/n)-90)*(Math.PI/180);u.push({x1:e+i*Math.cos(p),y1:t+i*Math.sin(p),x2:e+l*Math.cos(p),y2:t+l*Math.sin(p),thick:d%5===0})}return u}const eb=$u(60,100,100,85,96),Fk=$u(60,100,100,78,94),tD=$u(60,100,100,82,94);$u(60,50,50,38,46);const k2=$u(60,40,40,30,37),sD="/login/assets/first_workout-B8SFkzJX.PNG",nD="/login/assets/workouts_10-Z5R3u0xH.PNG",rD="/login/assets/workouts_25-CzxSlcAj.PNG",aD="/login/assets/workouts_50-BpzWup3V.PNG",iD="/login/assets/workouts_100-D7_r6tn1.PNG",oD="/login/assets/streak_2-CsRr-XA9.PNG",lD="/login/assets/streak_4-BHO09tbw.PNG",cD="/login/assets/streak_8-DX2UWMko.PNG",uD="/login/assets/first_pb-aVf_CNWy.PNG",dD="/login/assets/pbs_5-Cippawgg.PNG",hD="/login/assets/pbs_10-CZgGh9Kv.PNG",mD="/login/assets/pbs_100-C67b1wfS.PNG",fD="/login/assets/nutrition_7-CHVV11fj.PNG",pD="/login/assets/leaderboard_join-BLoId4Hz.PNG",gD="/login/assets/habits_7-Dvki70KO.PNG",mu=[{id:"first_workout",img:sD,name:"First Rep",desc:"Complete your first workout",category:"workouts",threshold:1},{id:"workouts_10",img:nD,name:"On Fire",desc:"Complete 10 workouts",category:"workouts",threshold:10},{id:"workouts_25",img:rD,name:"Dedicated",desc:"Complete 25 workouts",category:"workouts",threshold:25},{id:"workouts_50",img:aD,name:"Unstoppable",desc:"Complete 50 workouts",category:"workouts",threshold:50},{id:"workouts_100",img:iD,name:"Century",desc:"Complete 100 workouts",category:"workouts",threshold:100},{id:"streak_2",img:oD,name:"2 Week Streak",desc:"Work out for 2 weeks in a row",category:"streaks",threshold:2},{id:"streak_4",img:lD,name:"Month Strong",desc:"Work out for 4 weeks in a row",category:"streaks",threshold:4},{id:"streak_8",img:cD,name:"Iron Will",desc:"Work out for 8 weeks in a row",category:"streaks",threshold:8},{id:"first_pb",img:uD,name:"First PB",desc:"Set your first personal best",category:"pbs",threshold:1},{id:"pbs_5",img:dD,name:"PB Hunter",desc:"Set 5 personal bests",category:"pbs",threshold:5},{id:"pbs_10",img:hD,name:"PB Machine",desc:"Set 10 personal bests",category:"pbs",threshold:10},{id:"pbs_100",img:mD,name:"PB Legend",desc:"Set 100 personal bests",category:"pbs",threshold:100},{id:"nutrition_7",img:fD,name:"Macro Master",desc:"Hit your macro targets 7 days in a row",category:"nutrition",threshold:7},{id:"leaderboard_join",img:pD,name:"Competitor",desc:"Join the leaderboard",category:"leaderboard",threshold:1},{id:"habits_7",img:gD,name:"Habit Streak",desc:"Complete your daily habits 7 days in a row",category:"habits",threshold:7}];function yD({steps:n,onFinish:e,active:t}){const[i,l]=v.useState(0),[u,d]=v.useState(null),[p,g]=v.useState("below"),[y,w]=v.useState(!1),j=v.useRef(null),T=v.useRef(t);T.current=t,v.useEffect(()=>{t||l(0)},[t]),v.useEffect(()=>{if(!t)return;const ve=ge=>ge.preventDefault();return document.addEventListener("touchmove",ve,{passive:!1}),document.addEventListener("wheel",ve,{passive:!1}),document.body.style.overflow="hidden",()=>{document.removeEventListener("touchmove",ve),document.removeEventListener("wheel",ve),document.body.style.overflow=""}},[t]);const V=v.useMemo(()=>t?n.filter(ve=>document.querySelector(ve.selector)):[],[t]),$=V[i],F=i===V.length-1,U=$?.selector,te=v.useCallback(()=>{if(!U)return;const ve=document.querySelector(U);if(!ve){d(null);return}const ge=ve.getBoundingClientRect(),R=8;d({top:ge.top-R,left:ge.left-R,width:ge.width+R*2,height:ge.height+R*2});const E=window.innerHeight-ge.bottom;g(E<260?"above":"below")},[U]);if(v.useEffect(()=>{if(!t||!U)return;w(!0);const ve=document.querySelector(U);if(ve){document.body.style.overflow="",ve.scrollIntoView({behavior:"smooth",block:"center"});let ge=null,R=0,E=0;const A=60,O=()=>{E++;const I=ve.getBoundingClientRect(),$e=Math.round(I.top);if(ge!==null&&$e===ge?R++:R=0,ge=$e,R>=3||E>=A){T.current&&(document.body.style.overflow="hidden"),te(),w(!1);return}D=requestAnimationFrame(O)};let D;const H=setTimeout(()=>{D=requestAnimationFrame(O)},120);return()=>{clearTimeout(H),D&&cancelAnimationFrame(D),T.current&&(document.body.style.overflow="hidden")}}},[t,i,U,te]),v.useEffect(()=>{if(!t)return;const ve=()=>{j.current&&cancelAnimationFrame(j.current),j.current=requestAnimationFrame(te)};return window.addEventListener("scroll",ve,!0),window.addEventListener("resize",ve),()=>{window.removeEventListener("scroll",ve,!0),window.removeEventListener("resize",ve),j.current&&cancelAnimationFrame(j.current)}},[t,te]),!t||!$||V.length===0)return null;const K=()=>{F?e():l(i+1)},re=()=>{i>0&&l(i-1)},ye=()=>e();return r.jsxs("div",{className:"st-overlay",onClick:ve=>{ve.stopPropagation()},children:[r.jsx("div",{className:"st-backdrop",onClick:K}),u&&r.jsx("div",{className:`st-spotlight${y?" st-transitioning":""}`,style:{top:u.top,left:u.left,width:u.width,height:u.height}}),u&&r.jsxs("div",{className:`st-tooltip st-tooltip-${p}${y?" st-transitioning":""}`,style:{top:p==="below"?Math.min(Math.max(u.top+u.height+16,16),window.innerHeight-200):void 0,bottom:p==="above"?Math.min(Math.max(window.innerHeight-u.top+16,16),window.innerHeight-60):void 0,left:Math.max(16,Math.min(u.left,window.innerWidth-320))},children:[r.jsx("div",{className:"st-dots",children:V.map((ve,ge)=>r.jsx("span",{className:`st-dot${ge===i?" active":""}${ge<i?" done":""}`},ge))}),r.jsx("h3",{className:"st-title",children:$.title}),r.jsx("p",{className:"st-body",children:$.body}),r.jsxs("div",{className:"st-actions",children:[i>0&&r.jsx("button",{className:"st-btn st-btn-back",onClick:re,children:"Back"}),r.jsx("button",{className:"st-btn st-btn-next",onClick:K,children:$.cta||(F?"Let's Go!":"Next")})]}),r.jsx("button",{className:"st-skip",onClick:ye,children:"Skip tour"})]})]})}const Fp=[10,25,50,100,200,500,1e3],Wi=5;function Xc(n){return n.toISOString().split("T")[0]}function bD(n){let e=0;for(const t of Fp){if(n<t)return{prev:e,next:t};e=t}return{prev:Fp[Fp.length-1],next:n+100}}const vD={fullbody_4wk:{duration:4,daysPerWeek:3},fullbody_8wk:{duration:8,daysPerWeek:3},fullbody_12wk:{duration:12,daysPerWeek:3},core_4wk:{duration:4,daysPerWeek:3},core_8wk:{duration:8,daysPerWeek:3},core_12wk:{duration:12,daysPerWeek:3},upper_4wk:{duration:4,daysPerWeek:3},lower_4wk:{duration:4,daysPerWeek:3}},xD={fullbody_4wk:["Push Focus","Pull Focus","Legs & Core"],fullbody_8wk:["Strength","Power","Endurance"],fullbody_12wk:["Upper Push","Lower Body","Upper Pull"],core_4wk:["Abs","Stability","Power Core"],core_8wk:["Anti-Extension","Rotation","Power"],core_12wk:["Strength","Endurance","Power"],upper_4wk:["Push","Pull","Mixed"],lower_4wk:["Quad Dominant","Hamstring & Glute","Power & Stability"]},zp=[{text:"You have 24 hours a day...",bold:"make it count"},{text:"Discipline beats motivation...",bold:"every single time"},{text:"Rest when you're done,",bold:"not when you're tired"},{text:"Small daily gains...",bold:"create massive results"},{text:"Your body keeps score,",bold:"train it well"},{text:"Consistency over intensity...",bold:"always wins"},{text:"The only bad workout...",bold:"is the one you skipped"}];function qp(n){if(!n)return"";const e=n instanceof Date?n:n.toDate?n.toDate():new Date(n),t=Math.floor((new Date-e)/1e3);return t<60?"just now":t<3600?`${Math.floor(t/60)}m ago`:t<86400?`${Math.floor(t/3600)}h ago`:t<604800?`${Math.floor(t/86400)}d ago`:e.toLocaleDateString("en-GB",{day:"numeric",month:"short"})}function Jc(n){if(!n)return"?";const e=n.trim().split(/\s+/);return e.length===1?e[0][0].toUpperCase():(e[0][0]+e[e.length-1][0]).toUpperCase()}function wD(n,e=800){return new Promise(t=>{const i=new Image;i.onload=()=>{const l=document.createElement("canvas");let u=i.width,d=i.height;u>d?u>e&&(d=Math.round(d*e/u),u=e):d>e&&(u=Math.round(u*e/d),d=e),l.width=u,l.height=d,l.getContext("2d").drawImage(i,0,0,u,d),l.toBlob(p=>t(p),"image/jpeg",.8)},i.src=URL.createObjectURL(n)})}function _D(){const{currentUser:n,isClient:e,clientData:t,logout:i,updateClientData:l,loading:u}=Vr(),{isDark:d,toggleTheme:p}=Ea(),{isPremium:g}=wm(),y=Gn(),[w,j]=v.useState({hours:0,minutes:0,seconds:0}),[T,V]=v.useState(0),[$,F]=v.useState(0),[U,te]=v.useState(""),[K,re]=v.useState(0),[ye,ve]=v.useState(0),[ge,R]=v.useState(!1),[E,A]=v.useState({protein:0,carbs:0,fats:0,calories:0}),[O,D]=v.useState(null),[H,I]=v.useState(0),[$e,xt]=v.useState(null),[W,he]=v.useState(!1),[Pe,He]=v.useState(!1),[ee,L]=v.useState(0),[se,Le]=v.useState(0),[Oe,Ye]=v.useState([]),[Ue,pt]=v.useState([]),[Tt,at]=v.useState(null),[Gt,zs]=v.useState(!1),yt=v.useRef(null),[ut,oe]=v.useState([]),[ss,Ht]=v.useState(null),[Dt,bt]=v.useState(null),Ge=v.useRef(null),[Ze,Et]=v.useState(0),[rn,js]=v.useState(0),[Kt,St]=v.useState(0),[Yt,us]=v.useState(0),[es,Xs]=v.useState(null),Nt=v.useCallback((M,Z="info")=>{Xs({message:M,type:Z}),setTimeout(()=>Xs(null),4e3)},[]),[ps,be]=v.useState([]),[De,Y]=v.useState(!1),[we,Ce]=v.useState(""),[Me,Ae]=v.useState(null),[it,Qe]=v.useState(null),[Q,ce]=v.useState(!1),[ze,dt]=v.useState(new Set),[ht,Vt]=v.useState(new Set),[Ct,At]=v.useState({}),[Ms,Js]=v.useState({}),[ns,Cs]=v.useState({}),[Ls,q]=v.useState({}),[xe,Ee]=v.useState({}),[je,ke]=v.useState({}),ot=v.useRef(null),mt=v.useRef(null),et=v.useRef({}),[gt,Rt]=v.useState([]),[ws,_n]=v.useState(!1),ln=v.useRef(null),[Ln,kn]=v.useState([]),[pn,Hs]=v.useState(""),[k,N]=v.useState(!1),[P,B]=v.useState(null),[ue,Be]=v.useState([]),[Fe,tt]=v.useState(null),[Xe,Qt]=v.useState(!1),Ts=v.useRef(!1),as=(()=>{const M=[{selector:".cb-ring-container",title:"Your 24-Hour Countdown",body:"Every day resets. This ring tracks the time you have left  tap your photo to personalise your profile.",cta:"Next"},{selector:".cb-stats-row",title:"Progress at a Glance",body:"Programme completion, workouts this week, and daily habits  all in one row. These fill up as you go."},{selector:".cb-nudge-card",title:"Smart Suggestions",body:"We'll highlight what needs your attention  your next session, unfinished habits, or a meal to log."},{selector:".cb-card-workouts-hero",title:"Workouts",body:"Quick randomiser sessions or structured programmes  pick your focus, level and time.",cta:"Next"}];return g&&M.push({selector:".cb-card-nutrition",title:"Nutrition Tracking",body:"Set your macro targets, scan barcodes, and log meals to hit your daily goals."},{selector:".cb-card-consistency",title:"Daily Habits",body:"5 simple habits each day  train, hit protein, 10k steps, sleep, and hydrate. Build your streak."},{selector:".cb-card-buddies",title:"Buddies & Social",body:"Connect with other members, share your journey, and keep each other accountable."},{selector:".cb-journey-section",title:"Share Your Journey",body:"Post photos, updates, and milestones  your fitness journey in one place. Like and comment on each other's posts."},{selector:".cb-achievements-section",title:"Achievements",body:"Every rep counts towards badges  volume milestones, workout streaks, and more to unlock."}),M.push({selector:".block-bottom-nav",title:"You're All Set!",body:"Use the nav bar to jump between your profile, workouts, nutrition, and buddies. Time to get after it.",cta:"Let's Go!"}),M})();v.useEffect(()=>{!u&&!n&&y("/")},[u,n,y]),v.useEffect(()=>{!u&&t&&t.signupSource==="self_signup"&&!t.onboardingComplete&&y("/onboarding")},[u,t,y]),v.useEffect(()=>{let M=t?.tourComplete||Ts.current;if(!M&&t?.id)try{M=!!localStorage.getItem(`tourDone_${t.id}`)}catch{}if(ge&&t&&!M){const Z=setTimeout(()=>Qt(!0),600);return()=>clearTimeout(Z)}},[ge,t]),v.useEffect(()=>{if(t)try{const M=sessionStorage.getItem(`cbDash_${t.id}`);if(M){const Z=JSON.parse(M);F(Z.programmePct??0),te(Z.programmeName??""),re(Z.totalWorkouts??0),ve(Z.habitWeekPct??0),A(Z.nutritionTotals??{protein:0,carbs:0,fats:0,calories:0}),D(Z.nutritionTargetData??null),I(Z.todayHabitsCount??0),xt(Z.nextSession??null),he(Z.hasProgramme??!1),He(Z.programmeComplete??!1),L(Z.weeklyWorkouts??0),Le(Z.pbCount??0),Ye(Z.topPBs??[]),pt(Z.leaderboardTop3??[]),oe(Z.unlockedBadges??[]),Ge.current=Z.unlockedBadges??[],Et(Z.streakWeeks??0),R(!0)}}catch{}},[t]),v.useEffect(()=>{t?.photoURL&&at(t.photoURL)},[t]),v.useEffect(()=>{if(!t)return;const M=Ps(Ft(fe,"notifications"),fs("toId","==",t.id)),Z=_k(M,Se=>{const Je=Se.docs.map(_t=>({id:_t.id,..._t.data()}));Je.sort((_t,Pt)=>{const rt=_t.createdAt?.toMillis?.()||0;return(Pt.createdAt?.toMillis?.()||0)-rt}),Rt(Je.slice(0,50))},Se=>{console.error("Notification listener error:",Se),Se.code==="permission-denied"&&console.warn("Firestore rules may be missing for the notifications collection. Please update your Firestore rules in the Firebase Console.")});return()=>Z()},[t]),v.useEffect(()=>{const M=Z=>{ln.current&&!ln.current.contains(Z.target)&&_n(!1)};return document.addEventListener("mousedown",M),()=>document.removeEventListener("mousedown",M)},[]),v.useEffect(()=>{if(!t)return;const M=t.id;(async()=>{try{const[Z,Se,Je]=await Promise.all([Ss(Ps(Ft(fe,"buddies"),fs("user1","==",M))),Ss(Ps(Ft(fe,"buddies"),fs("user2","==",M))),Ss(Ft(fe,"clients"))]),_t=new Set;[...Z.docs,...Se.docs].forEach(rt=>{const Bt=rt.data();_t.add(Bt.user1===M?Bt.user2:Bt.user1)});const Pt={};Je.docs.forEach(rt=>{Pt[rt.id]=rt.data()}),kn(Array.from(_t).filter(rt=>Pt[rt]).map(rt=>({id:rt,name:Pt[rt].name,photoURL:Pt[rt].photoURL||null})))}catch(Z){console.error("Error loading buddies for mentions:",Z)}})()},[t]);const cs=gt.filter(M=>!M.read).length,Os=async()=>{const M=gt.filter(Se=>!Se.read);if(!M.length)return;const Z=p2(fe);M.forEach(Se=>Z.update(qe(fe,"notifications",Se.id),{read:!0})),await Z.commit()},On=async()=>{if(!gt.length)return;const M=p2(fe);gt.forEach(Z=>M.delete(qe(fe,"notifications",Z.id))),await M.commit()},mr=async(M,Z,Se={})=>{if(!(!t||M===t.id))try{await mi(Ft(fe,"notifications"),{toId:M,fromId:t.id,fromName:t.name||"Someone",fromPhotoURL:t.photoURL||null,type:Z,read:!1,createdAt:Kr(),...Se})}catch(Je){console.error("Notification create error:",Je),Je.code==="permission-denied"&&Nt("Notifications blocked  check Firestore rules","error")}},ds=(M,Z)=>{const Se=Z==="compose"?ot.current?.selectionStart:null,_t=(Se!=null?M.slice(0,Se):M).match(/@(\w*)$/);if(_t){N(!0),B(Z),Hs(_t[1].toLowerCase());const Pt=Ln.filter(rt=>rt.name&&rt.name.toLowerCase().includes(_t[1].toLowerCase())).slice(0,5);Be(Pt)}else N(!1),Be([])},Kn=(M,Z)=>{if(Z==="compose"){const Se=ot.current,Je=we,_t=Se?.selectionStart??Je.length,Pt=Je.slice(0,_t),rt=Je.slice(_t),Bt=Pt.replace(/@\w*$/,`@${M.name} `);Ce(Bt+rt),setTimeout(()=>{Se?.focus(),Se.selectionStart=Se.selectionEnd=Bt.length},0)}else{const Je=(Ms[Z]||"").replace(/@\w*$/,`@${M.name} `);Js(_t=>({..._t,[Z]:Je}))}N(!1),Be([])},X=M=>M&&M.split(/(@\w[\w\s]*?\s)/g).map((Se,Je)=>Se.startsWith("@")&&Ln.some(_t=>Se.trim()===`@${_t.name}`)?r.jsx("span",{className:"mention-highlight",children:Se.trim()},Je):Se),_e=async M=>{const Z=M.target.files?.[0];if(!(!Z||!t)){if(!Z.type.startsWith("image/")){Nt("Please select an image file","error");return}if(Z.size>5*1024*1024){Nt("Image must be under 5MB","error");return}zs(!0);try{const Se=await new Promise(Pt=>{const rt=new Image;rt.onload=()=>{const Bt=document.createElement("canvas"),zt=400;let rs=rt.width,Ut=rt.height;rs>Ut?(Ut=Ut/rs*zt,rs=zt):(rs=rs/Ut*zt,Ut=zt),Bt.width=rs,Bt.height=Ut,Bt.getContext("2d").drawImage(rt,0,0,rs,Ut),Bt.toBlob(_s=>Pt(_s),"image/jpeg",.75)},rt.src=URL.createObjectURL(Z)}),Je=eo(to,`profilePhotos/${t.id}`);await Up(Je,Se);const _t=await qo(Je);await Da(qe(fe,"clients",t.id),{photoURL:_t}),at(_t),l({photoURL:_t}),Nt("Profile photo updated!","success")}catch(Se){console.error("Photo upload error:",Se),Nt("Failed to upload photo","error")}zs(!1),yt.current&&(yt.current.value="")}};v.useEffect(()=>{const M=()=>{const Se=new Date,Je=new Date(Se);Je.setHours(23,59,59,999);const _t=Je-Se,Pt=Math.floor(_t/(1e3*60*60)),rt=Math.floor(_t%(1e3*60*60)/(1e3*60)),Bt=Math.floor(_t%(1e3*60)/1e3);j({hours:Pt,minutes:rt,seconds:Bt}),V(60-Bt)};M();const Z=setInterval(M,1e3);return()=>clearInterval(Z)},[]),v.useEffect(()=>{const M=setInterval(()=>{us(Z=>(Z+1)%zp.length)},8e3);return()=>clearInterval(M)},[]),v.useEffect(()=>{if(!n||!t)return;(async()=>{let Z=null,Se=0,Je=[],_t=!1,Pt=null;try{const rt=Xc(new Date),Bt=await As(qe(fe,"clientProgrammes",t.id));if(Bt.exists()){const or=Bt.data(),gn=vD[or.templateId];if(he(!0),gn){const yr=or.completedSessions||{},Rr=Object.keys(yr).length,$a=gn.duration*gn.daysPerWeek;F($a>0?Math.round(Rr/$a*100):0);const tl=or.templateId.replace(/_/g," ").replace(/\b\w/g,ca=>ca.toUpperCase());te(tl);const sl=xD[or.templateId];let br=!1;for(let ca=1;ca<=gn.duration&&!br;ca++)for(let ua=0;ua<gn.daysPerWeek&&!br;ua++)yr[`w${ca}d${ua}`]||(xt({week:ca,dayIdx:ua,label:sl?.[ua]||`Day ${ua+1}`}),br=!0);br||(He(!0),_t=!0)}}const zt=Ft(fe,"workoutLogs"),rs=Ps(zt,fs("clientId","==",t.id));Z=await Ss(rs),re(Z.docs.length);const Ut=new Date,_s=Ut.getDay(),qn=_s===0?6:_s-1,pr=new Date(Ut);pr.setDate(Ut.getDate()-qn),pr.setHours(0,0,0,0);const sn=pr.getTime(),Zs=Z.docs.filter(or=>{const gn=or.data().completedAt;return gn?(gn.toDate?gn.toDate().getTime():new Date(gn).getTime())>=sn:!1}).length;L(Zs);const Hn=Ft(fe,"habitLogs"),mn=Ps(Hn,fs("clientId","==",t.id),fs("date","==",rt)),Bn=await Ss(mn);let ir=0;if(!Bn.empty){const or=Bn.docs[0].data().habits||{};ir=Object.values(or).filter(Boolean).length}ve(Math.round(ir/Wi*100)),I(ir);const Xn=await As(qe(fe,"nutritionTargets",t.id));Xn.exists()&&(D(Xn.data()),Pt=Xn.data());const gr=await As(qe(fe,"nutritionLogs",`${t.id}_${rt}`));if(gr.exists()){const gn=(gr.data().entries||[]).reduce((yr,Rr)=>({protein:yr.protein+(Rr.protein||0),carbs:yr.carbs+(Rr.carbs||0),fats:yr.fats+(Rr.fats||0),calories:yr.calories+(Rr.calories||0)}),{protein:0,carbs:0,fats:0,calories:0});A(gn)}}catch(rt){console.error("Error loading dashboard stats:",rt)}try{let rt=[];const Bt=await As(qe(fe,"coreBuddyPBs",t.id));if(Bt.exists()){const zt=Bt.data().exercises||{};Le(Object.keys(zt).length),Se=Object.keys(zt).length,rt=Object.entries(zt).sort(([,rs],[,Ut])=>(Ut.weight||0)-(rs.weight||0)).slice(0,3).map(([rs,Ut])=>({name:rs,weight:Ut.weight,reps:Ut.reps}))}Je=rt,Ye(rt)}catch(rt){console.error("PB fetch error:",rt)}try{const rt=Ft(fe,"clients"),Bt=Ps(rt,fs("leaderboardOptIn","==",!0)),rs=(await Ss(Bt)).docs.map(Ut=>({id:Ut.id,name:Ut.data().name,photoURL:Ut.data().photoURL||null}));pt(rs.slice(0,3))}catch(rt){console.error("Leaderboard preview error:",rt)}try{let rt=0;if(Z){const sn=Z.docs.map(Zs=>Zs.data().date).filter(Boolean).sort().reverse();if(sn.length>0){const Zs=new Date;let Hn=new Date(Zs);e:for(let mn=0;mn<52;mn++){const Bn=new Date(Hn),ir=Bn.getDay(),Xn=ir===0?6:ir-1;Bn.setDate(Bn.getDate()-Xn),Bn.setHours(0,0,0,0);const gr=new Date(Bn);gr.setDate(gr.getDate()+7);const or=Xc(Bn),gn=Xc(gr);if(sn.some(Rr=>Rr>=or&&Rr<gn))rt++;else{if(mn>0)break e;break}Hn.setDate(Hn.getDate()-7)}}}Et(rt);let Bt=0;for(let sn=0;sn<30;sn++){const Zs=new Date;Zs.setDate(Zs.getDate()-sn);const Hn=Xc(Zs);try{const mn=await Ss(Ps(Ft(fe,"habitLogs"),fs("clientId","==",t.id),fs("date","==",Hn)));if(mn.empty)break;{const Bn=mn.docs[0].data().habits||{};if(Object.values(Bn).filter(Boolean).length>=Wi)Bt++;else break}}catch{break}}js(Bt);let zt=0;for(let sn=0;sn<30;sn++){const Zs=new Date;Zs.setDate(Zs.getDate()-sn);const Hn=Xc(Zs);try{const mn=await As(qe(fe,"nutritionLogs",`${t.id}_${Hn}`));if(mn.exists()&&(mn.data().entries||[]).length>0)if(Pt){const ir=(mn.data().entries||[]).reduce((Xn,gr)=>({protein:Xn.protein+(gr.protein||0),carbs:Xn.carbs+(gr.carbs||0),fats:Xn.fats+(gr.fats||0)}),{protein:0,carbs:0,fats:0});if(ir.protein>=(Pt.protein||0)&&ir.carbs>=(Pt.carbs||0)&&ir.fats>=(Pt.fats||0))zt++;else break}else zt++;else break}catch{break}}St(zt);const rs=Z?Z.docs.length:0,Ut=[],_s=sn=>Ut.push(sn);rs>=1&&_s("first_workout"),rs>=10&&_s("workouts_10"),rs>=25&&_s("workouts_25"),rs>=50&&_s("workouts_50"),rs>=100&&_s("workouts_100"),rt>=2&&_s("streak_2"),rt>=4&&_s("streak_4"),rt>=8&&_s("streak_8"),Se>=1&&_s("first_pb"),Se>=5&&_s("pbs_5"),Se>=10&&_s("pbs_10"),Se>=100&&_s("pbs_100"),zt>=7&&_s("nutrition_7"),t.leaderboardOptIn&&_s("leaderboard_join"),Bt>=7&&_s("habits_7"),oe(Ut);const qn=Ge.current;if(qn!==null){const sn=Ut.filter(Zs=>!qn.includes(Zs));if(sn.length>0){const Zs=mu.find(Hn=>Hn.id===sn[sn.length-1]);Zs&&setTimeout(()=>bt(Zs),600)}}Ge.current=Ut;const pr={};Ut.forEach(sn=>{pr[sn]={unlockedAt:new Date().toISOString()}}),Ns(qe(fe,"achievements",t.id),{badges:pr,progress:{streakWeeks:rt,pbCount:Se,nutritionStreak:zt,habitStreak:Bt},updatedAt:new Date().toISOString()},{merge:!0}).catch(()=>{})}catch(rt){console.error("Achievement computation error:",rt)}R(!0)})()},[n,t]),v.useEffect(()=>{if(!(!ge||!t))try{sessionStorage.setItem(`cbDash_${t.id}`,JSON.stringify({programmePct:$,programmeName:U,totalWorkouts:K,habitWeekPct:ye,nutritionTotals:E,nutritionTargetData:O,todayHabitsCount:H,nextSession:$e,hasProgramme:W,programmeComplete:Pe,weeklyWorkouts:ee,pbCount:se,topPBs:Oe,leaderboardTop3:Ue,unlockedBadges:ut,streakWeeks:Ze}))}catch{}},[ge,$,U,K,ye,E,O,H,$e,W,Pe,ee,se,Oe,Ue,ut,Ze,t]);const me=v.useCallback(async()=>{if(Ts.current=!0,Qt(!1),l({tourComplete:!0}),t?.id){try{localStorage.setItem(`tourDone_${t.id}`,"1")}catch{}try{await Da(qe(fe,"clients",t.id),{tourComplete:!0})}catch(M){console.error("Failed to save tour completion:",M)}}},[t,l]),We=M=>{const Z=M.currentTarget,Se=Z.querySelector(".ripple");Se&&Se.remove();const Je=Z.getBoundingClientRect(),_t=Math.max(Je.width,Je.height),Pt=M.clientX-Je.left-_t/2,rt=M.clientY-Je.top-_t/2,Bt=document.createElement("span");Bt.className="ripple",Bt.style.cssText=`width:${_t}px;height:${_t}px;left:${Pt}px;top:${rt}px;`,Z.appendChild(Bt),setTimeout(()=>Bt.remove(),600)},st=t?.name?.split(" ")[0]||"there",{prev:lt,next:Mt}=bD(K),Xt=Mt>lt?Math.round((K-lt)/(Mt-lt)*100):100,is=[{label:"Programme",value:`${$}%`,pct:$,color:"#14b8a6",size:"normal"},{label:"Workouts",value:`${K}`,pct:Xt,color:"var(--color-primary)",size:"large"},{label:"Habits Today",value:`${ye}%`,pct:ye,color:"#38B6FF",size:"normal"}],Rs=M=>!O||!O[M]?0:Math.min(Math.round(E[M]/O[M]*100),100),os=(()=>{const M=new Date().getHours();return ge&&H>=Wi&&E.calories>0?{main:"Smashed it today,",sub:"Rest up and go again tomorrow."}:M>=5&&M<12?{main:"Rise and grind,",sub:"let's get after it!"}:M>=12&&M<17?{main:"Oye",sub:"crack on and make it count!"}:M>=17&&M<21?{main:"Evening session?",sub:"Let's finish strong!"}:{main:"Burning the midnight oil,",sub:"Respect the hustle!"}})(),Vs=ge?W&&$e&&!Pe?{label:"NEXT SESSION",message:`Week ${$e.week}, Day ${$e.dayIdx+1}  ${$e.label}`,cta:"Continue",action:()=>y("/client/core-buddy/programmes"),pct:$,ringLabel:`${$}%`}:H<Wi?{label:"DAILY HABITS",message:`${H}/${Wi} completed`,cta:"Open Habits",action:()=>y("/client/core-buddy/consistency"),pct:ye,ringLabel:`${H}/${Wi}`}:E.calories===0?{label:"NUTRITION",message:"No meals logged today",cta:"Log Meal",action:()=>y("/client/core-buddy/nutrition"),pct:0,ringLabel:"0"}:W?Pe?{label:"COMPLETE",message:"Programme finished!",cta:"New Programme",action:()=>y("/client/core-buddy/workouts"),pct:100,ringLabel:"100%"}:{label:"TODAY",message:"You're crushing it!",cta:null,action:null,pct:100,ringLabel:""}:{label:"PROGRAMMES",message:"Start a programme to level up",cta:"Browse",action:()=>y("/client/core-buddy/workouts"),pct:0,ringLabel:""}:null,Sr=v.useCallback(async()=>{if(t){Y(!0);try{const M=await Ss(Ps(Ft(fe,"posts"),fs("authorId","==",t.id),Gh("createdAt","desc"),Kh(30)));be(M.docs.map(Se=>({id:Se.id,...Se.data()})));const Z=await Ss(Ps(Ft(fe,"postLikes"),fs("userId","==",t.id)));dt(new Set(Z.docs.map(Se=>Se.data().postId)))}catch(M){console.error("Error loading journey:",M)}finally{Y(!1)}}},[t]);v.useEffect(()=>{ge&&t&&Sr()},[ge,t,Sr]);const Nr=M=>{const Z=M.target.files?.[0];if(Z){if(!Z.type.startsWith("image/")){Nt("Please select an image file","error");return}if(Z.size>10*1024*1024){Nt("Image must be under 10MB","error");return}Ae(Z),Qe(URL.createObjectURL(Z))}},ar=()=>{Ae(null),it&&URL.revokeObjectURL(it),Qe(null),mt.current&&(mt.current.value="")},Yn=async()=>{if(!(!we.trim()&&!Me||Q||!t)){ce(!0);try{let M=null;if(Me){const Je=await wD(Me),_t=`${Date.now()}_${Math.random().toString(36).slice(2,8)}`,Pt=eo(to,`postImages/${t.id}/${_t}`);await Up(Pt,Je),M=await qo(Pt)}await mi(Ft(fe,"posts"),{authorId:t.id,authorName:t.name||"Unknown",authorPhotoURL:t.photoURL||null,content:we.trim(),type:M?"image":"text",imageURL:M||null,createdAt:Kr(),likeCount:0,commentCount:0});const Se=we.trim().match(/@[\w\s]+?(?=\s@|\s*$|[.,!?])/g);if(Se){const Je=new Set;Se.forEach(_t=>{const Pt=_t.slice(1).trim(),rt=Ln.find(Bt=>Bt.name&&Bt.name.toLowerCase()===Pt.toLowerCase());rt&&!Je.has(rt.id)&&(Je.add(rt.id),mr(rt.id,"mention",{}))})}Ce(""),ar(),ot.current&&(ot.current.style.height="auto"),await Sr(),Nt("Posted!","success")}catch(M){console.error("Error posting:",M),Nt(M?.message||"Failed to post","error")}finally{ce(!1)}}},ls=async M=>{if(window.confirm("Delete this post?"))try{await _r(qe(fe,"posts",M)),be(Z=>Z.filter(Se=>Se.id!==M)),Nt("Post deleted","info")}catch(Z){console.error("Delete error:",Z),Nt("Failed to delete","error")}},Bs=async M=>{if(!t)return;const Z=t.id,Se=`${M}_${Z}`,Je=ze.has(M),_t=new Set(ze);Je?_t.delete(M):_t.add(M),dt(_t),be(Pt=>Pt.map(rt=>rt.id===M?{...rt,likeCount:Math.max(0,(rt.likeCount||0)+(Je?-1:1))}:rt));try{if(Je)await _r(qe(fe,"postLikes",Se)),await Da(qe(fe,"posts",M),{likeCount:Bo(-1)});else{await Ns(qe(fe,"postLikes",Se),{postId:M,userId:Z,createdAt:Kr()}),await Da(qe(fe,"posts",M),{likeCount:Bo(1)});const Pt=ps.find(rt=>rt.id===M);Pt&&mr(Pt.authorId,"like",{postId:M})}}catch(Pt){console.error("Like error:",Pt),Sr()}},zn=async M=>{try{const Z=await Ss(Ps(Ft(fe,"postComments"),fs("postId","==",M),Gh("createdAt","asc"),Kh(50)));At(Se=>({...Se,[M]:Z.docs.map(Je=>({id:Je.id,...Je.data()}))}))}catch(Z){console.error("Error loading comments:",Z)}},jn=M=>{const Z=new Set(ht);Z.has(M)?Z.delete(M):(Z.add(M),Ct[M]||zn(M)),Vt(Z)},Qn=async M=>{const Z=(Ms[M]||"").trim(),Se=xe[M];if(!(!Z&&!Se||!t)){Cs(Je=>({...Je,[M]:!0}));try{let Je=null;if(Se){const zt=eo(to,`comment-images/${Date.now()}_${Se.name}`);await Up(zt,Se),Je=await qo(zt)}const _t={postId:M,authorId:t.id,authorName:t.name||"Unknown",authorPhotoURL:t.photoURL||null,content:Z||"",createdAt:Kr()};Je&&(_t.imageURL=Je);const Pt=Ls[M];Pt&&(_t.replyToId=Pt.id,_t.replyToName=Pt.authorName),await mi(Ft(fe,"postComments"),_t),await Da(qe(fe,"posts",M),{commentCount:Bo(1)});const rt=ps.find(zt=>zt.id===M);rt&&mr(rt.authorId,"comment",{postId:M});const Bt=Z.match(/@[\w\s]+?(?=\s@|\s*$|[.,!?])/g);if(Bt){const zt=new Set;Bt.forEach(rs=>{const Ut=rs.slice(1).trim(),_s=Ln.find(qn=>qn.name&&qn.name.toLowerCase()===Ut.toLowerCase());_s&&!zt.has(_s.id)&&(zt.add(_s.id),mr(_s.id,"mention",{postId:M}))})}Js(zt=>({...zt,[M]:""})),Ee(zt=>({...zt,[M]:null})),ke(zt=>({...zt,[M]:null})),q(zt=>({...zt,[M]:null})),et.current[M]&&(et.current[M].value=""),be(zt=>zt.map(rs=>rs.id===M?{...rs,commentCount:(rs.commentCount||0)+1}:rs)),await zn(M)}catch(Je){console.error("Comment error:",Je),Nt("Failed to comment","error")}finally{Cs(Je=>({...Je,[M]:!1}))}}},cn=async(M,Z)=>{try{await _r(qe(fe,"postComments",Z)),await Da(qe(fe,"posts",M),{commentCount:Bo(-1)}),At(Se=>({...Se,[M]:(Se[M]||[]).filter(Je=>Je.id!==Z)})),be(Se=>Se.map(Je=>Je.id===M?{...Je,commentCount:Math.max((Je.commentCount||1)-1,0)}:Je))}catch(Se){console.error("Delete comment error:",Se),Nt("Failed to delete comment","error")}},Vn=(M,Z)=>{const Se=Z.target.files?.[0];if(!Se)return;if(Se.size>5*1024*1024){Nt("Image must be under 5MB","error");return}Ee(_t=>({..._t,[M]:Se}));const Je=new FileReader;Je.onload=_t=>ke(Pt=>({...Pt,[M]:_t.target.result})),Je.readAsDataURL(Se)},Cr=M=>{Ee(Z=>({...Z,[M]:null})),ke(Z=>({...Z,[M]:null})),et.current[M]&&(et.current[M].value="")},Br=M=>{Ce(M.target.value),M.target.style.height="auto",M.target.style.height=Math.min(M.target.scrollHeight,120)+"px",ds(M.target.value,"compose")},fr=(M,Z)=>{Js(Se=>({...Se,[M]:Z})),ds(Z,M)};return r.jsx(ka,{children:r.jsxs("div",{className:"cb-dashboard","data-theme":d?"dark":"light",children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsxs("div",{className:"header-notif-wrap",ref:ln,children:[r.jsxs("button",{className:"header-notif-btn",onClick:()=>{_n(!ws),ws||Os()},"aria-label":"Notifications",children:[r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"}),r.jsx("path",{d:"M13.73 21a2 2 0 0 1-3.46 0"})]}),cs>0&&r.jsx("span",{className:"header-notif-badge",children:cs>9?"9+":cs})]}),ws&&r.jsxs("div",{className:"notif-panel",children:[r.jsxs("div",{className:"notif-panel-header",children:[r.jsx("span",{className:"notif-panel-title",children:"Notifications"}),gt.length>0&&r.jsx("button",{className:"notif-clear-btn",onClick:On,children:"Clear all"})]}),r.jsx("div",{className:"notif-panel-list",children:gt.length===0?r.jsx("div",{className:"notif-empty",children:"No notifications yet"}):gt.map(M=>r.jsxs("div",{className:`notif-item${M.read?"":" unread"}`,onClick:()=>{if(_n(!1),M.type==="buddy_request"||M.type==="buddy_accept")y("/client/core-buddy/buddies");else if((M.type==="like"||M.type==="comment")&&M.postId){if(!ht.has(M.postId)){const Z=new Set(ht);Z.add(M.postId),Vt(Z),Ct[M.postId]||zn(M.postId)}setTimeout(()=>{const Z=document.getElementById(`post-${M.postId}`);Z&&Z.scrollIntoView({behavior:"smooth",block:"center"})},150)}else M.type==="like"||M.type==="comment"?document.querySelector(".cb-journey-section")?.scrollIntoView({behavior:"smooth"}):M.type==="mention"&&y(`/client/core-buddy/profile/${M.fromId}`)},children:[r.jsx("div",{className:"notif-item-avatar",children:M.fromPhotoURL?r.jsx("img",{src:M.fromPhotoURL,alt:""}):r.jsx("span",{children:(M.fromName||"?")[0]})}),r.jsxs("div",{className:"notif-item-body",children:[r.jsxs("p",{className:"notif-item-text",children:[r.jsx("strong",{children:M.fromName})," ",M.type==="buddy_request"&&"sent you a buddy request",M.type==="buddy_accept"&&"accepted your buddy request",M.type==="like"&&"liked your post",M.type==="comment"&&"commented on your post",M.type==="mention"&&"mentioned you"]}),r.jsx("span",{className:"notif-item-time",children:qp(M.createdAt)})]})]},M.id))})]})]}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsxs("div",{className:"header-actions",children:[r.jsx("button",{onClick:p,"aria-label":"Toggle theme",children:d?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})}),r.jsx("button",{onClick:i,"aria-label":"Log out",children:r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),r.jsx("polyline",{points:"16 17 21 12 16 7"}),r.jsx("line",{x1:"21",y1:"12",x2:"9",y2:"12"})]})})]})]})}),r.jsxs("main",{className:"cb-main",children:[r.jsxs("div",{className:"cb-ring-container",children:[r.jsxs("div",{className:"cb-ring",children:[r.jsx("svg",{className:"cb-ring-svg",viewBox:"0 0 200 200",children:eb.map((M,Z)=>{const Se=Z<T;return r.jsx("line",{x1:M.x1,y1:M.y1,x2:M.x2,y2:M.y2,className:`ring-tick ${Se?"elapsed":"remaining"}`,strokeWidth:M.thick?"3":"2"},Z)})}),r.jsxs("div",{className:"cb-ring-center",children:[r.jsxs("div",{className:"cb-ring-logo",onClick:()=>yt.current?.click(),role:"button",tabIndex:0,"aria-label":"Change profile photo",children:[r.jsx("img",{src:Tt||"/Logo.webp",alt:Tt?"Profile":"Mind Core Fitness"}),r.jsx("div",{className:`cb-photo-overlay${Gt?" uploading":""}`,children:Gt?r.jsx("div",{className:"cb-photo-spinner"}):r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"#fff",strokeWidth:"2",children:[r.jsx("path",{d:"M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"}),r.jsx("circle",{cx:"12",cy:"13",r:"4"})]})}),r.jsx("input",{ref:yt,type:"file",accept:"image/*",onChange:_e,style:{display:"none"}})]}),!Tt&&!Gt&&r.jsx("div",{className:"cb-photo-badge",onClick:()=>yt.current?.click(),children:r.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"#fff",strokeWidth:"2.5",children:[r.jsx("path",{d:"M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"}),r.jsx("circle",{cx:"12",cy:"13",r:"4"})]})})]})]}),r.jsxs("div",{className:"cb-ring-countdown",children:[r.jsx("span",{className:"cb-timer-digit",children:String(w.hours).padStart(2,"0")}),r.jsx("span",{className:"cb-timer-colon",children:":"}),r.jsx("span",{className:"cb-timer-digit",children:String(w.minutes).padStart(2,"0")}),r.jsx("span",{className:"cb-timer-colon",children:":"}),r.jsx("span",{className:"cb-timer-digit cb-timer-seconds",children:String(w.seconds).padStart(2,"0")})]}),r.jsx("span",{className:"cb-ring-label",children:"remaining today"}),r.jsxs("p",{className:"cb-ring-tagline",children:[zp[Yt].text," ",r.jsx("strong",{children:zp[Yt].bold})]},Yt)]}),r.jsx("div",{className:"cb-stats-row",children:is.map(M=>{const Z=(M.size==="large",38),Se=2*Math.PI*Z,Je=Se-M.pct/100*Se;return r.jsxs("div",{className:`cb-stat-item${M.size==="large"?" cb-stat-large":""}`,children:[r.jsxs("div",{className:"cb-stat-ring",children:[r.jsxs("svg",{viewBox:"0 0 100 100",children:[r.jsx("circle",{className:"cb-stat-track",cx:"50",cy:"50",r:Z}),r.jsx("circle",{className:"cb-stat-fill",cx:"50",cy:"50",r:Z,style:{stroke:M.color},strokeDasharray:Se,strokeDashoffset:Je})]}),r.jsx("span",{className:"cb-stat-value",style:{color:M.color},children:M.value})]}),r.jsx("span",{className:"cb-stat-label",children:M.label})]},M.label)})}),r.jsxs("p",{className:"cb-coach-msg",children:[os.main," ",r.jsx("strong",{children:st}),"  ",os.sub]}),Vs&&r.jsxs("button",{className:"cb-nudge-card",onClick:Vs.action||void 0,style:Vs.action?void 0:{cursor:"default"},children:[r.jsxs("div",{className:"cb-nudge-ring",children:[r.jsxs("svg",{viewBox:"0 0 100 100",children:[r.jsx("circle",{className:"cb-nudge-ring-track",cx:"50",cy:"50",r:"38"}),r.jsx("circle",{className:"cb-nudge-ring-fill",cx:"50",cy:"50",r:"38",strokeDasharray:2*Math.PI*38,strokeDashoffset:2*Math.PI*38-Vs.pct/100*2*Math.PI*38})]}),r.jsx("span",{className:"cb-nudge-ring-val",children:Vs.ringLabel})]}),r.jsxs("div",{className:"cb-nudge-info",children:[r.jsx("span",{className:"cb-nudge-label",children:Vs.label}),r.jsx("span",{className:"cb-nudge-title",children:Vs.message}),Vs.cta&&r.jsxs("span",{className:"cb-nudge-cta",children:[Vs.cta," "]})]})]}),r.jsxs("div",{className:"cb-features",children:[t?.buddyEnabled&&r.jsxs("button",{className:"cb-feature-card cb-card-buddy ripple-btn",onClick:M=>{We(M),y("/client/core-buddy/buddy")},children:[r.jsx("div",{className:"cb-buddy-icon",children:r.jsxs("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M12 2a4 4 0 0 1 4 4v2a4 4 0 0 1-8 0V6a4 4 0 0 1 4-4z"}),r.jsx("path",{d:"M18 14c2 1 3 3 3 5v2H3v-2c0-2 1-4 3-5"}),r.jsx("circle",{cx:"9",cy:"7",r:"0.5",fill:"currentColor"}),r.jsx("circle",{cx:"15",cy:"7",r:"0.5",fill:"currentColor"}),r.jsx("path",{d:"M9.5 10a2.5 2.5 0 0 0 5 0"}),r.jsx("path",{d:"M7 13c1.5 1 3.5 1.5 5 1.5s3.5-.5 5-1.5"})]})}),r.jsxs("div",{className:"cb-card-content",children:[r.jsxs("h3",{children:["Buddy ",r.jsx("span",{className:"cb-buddy-badge",children:"AI"})]}),r.jsx("p",{className:"cb-card-desc",children:"Your AI training partner"})]}),r.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})]}),r.jsxs("button",{className:`cb-feature-card cb-card-nutrition cb-card-has-preview ripple-btn${g?"":" cb-card-locked"}`,onClick:M=>{We(M),y(g?"/client/core-buddy/nutrition":"/upgrade")},children:[r.jsxs("div",{className:"cb-card-top-row",children:[r.jsx("div",{className:"cb-card-content",children:r.jsxs("h3",{children:["Today's Nutrition ",!g&&r.jsx("span",{className:"cb-premium-badge",children:"PREMIUM"})]})}),r.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})]}),r.jsx("div",{className:"cb-card-preview-row",children:r.jsx("div",{className:"cb-mini-rings",children:[{label:"P",pct:Rs("protein"),color:"#14b8a6"},{label:"C",pct:Rs("carbs"),color:"var(--color-primary)"},{label:"F",pct:Rs("fats"),color:"#eab308"},{label:"Cal",pct:Rs("calories"),color:"#38B6FF"}].map(M=>{const Se=2*Math.PI*38,Je=Se-M.pct/100*Se;return r.jsxs("div",{className:"cb-mini-ring",children:[r.jsxs("svg",{viewBox:"0 0 100 100",children:[r.jsx("circle",{className:"cb-mini-track",cx:"50",cy:"50",r:38}),r.jsx("circle",{className:"cb-mini-fill",cx:"50",cy:"50",r:38,style:{stroke:M.color},strokeDasharray:Se,strokeDashoffset:Je})]}),r.jsx("span",{style:{color:M.color},children:M.label})]},M.label)})})}),r.jsx("p",{className:"cb-card-desc",children:"Track macros, scan barcodes, log water"})]}),r.jsxs("button",{className:"cb-feature-card cb-card-workouts-hero ripple-btn",onClick:M=>{We(M),y("/client/core-buddy/workouts")},children:[r.jsx("h3",{className:"cb-hero-title",children:"Workouts"}),r.jsxs("div",{className:"cb-hero-stats",children:[r.jsxs("span",{children:[ee," this week"]}),r.jsx("span",{className:"cb-hero-dot",children:""}),r.jsxs("span",{children:[K," total"]})]}),r.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})]}),r.jsxs("div",{className:"cb-grid-row",children:[r.jsxs("button",{className:`cb-feature-card cb-grid-card cb-card-consistency ripple-btn${g?"":" cb-card-locked"}`,onClick:M=>{We(M),y(g?"/client/core-buddy/consistency":"/upgrade")},children:[r.jsxs("div",{className:"cb-card-content",children:[r.jsxs("h3",{children:["Habits ",!g&&r.jsx("span",{className:"cb-premium-badge",children:"PREMIUM"})]}),r.jsx("div",{className:"cb-habit-dots",children:Array.from({length:Wi},(M,Z)=>r.jsx("span",{className:`cb-habit-dot${Z<H?" done":""}`},Z))}),r.jsxs("span",{className:"cb-habit-dots-label",children:[H,"/",Wi," today"]})]}),r.jsx("svg",{className:"cb-card-arrow cb-grid-arrow",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})]}),r.jsxs("button",{className:`cb-feature-card cb-grid-card cb-card-progress ripple-btn${g?"":" cb-card-locked"}`,onClick:M=>{We(M),y(g?"/client/personal-bests?mode=corebuddy":"/upgrade")},children:[r.jsxs("div",{className:"cb-card-content",children:[r.jsxs("h3",{children:["PBs ",!g&&r.jsx("span",{className:"cb-premium-badge",children:"PREMIUM"})]}),Oe.length>0?r.jsx("div",{className:"cb-pb-preview",children:Oe.slice(0,2).map(M=>r.jsxs("div",{className:"cb-pb-entry",children:[r.jsx("span",{className:"cb-pb-name",children:M.name}),r.jsxs("span",{className:"cb-pb-value",children:[M.weight,"kg"]})]},M.name))}):r.jsxs("div",{className:"cb-progress-preview",children:[r.jsx("svg",{className:"cb-progress-icon",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M13 2L3 14h9l-1 8 10-12h-9l1-8z"})}),r.jsx("span",{children:"Start lifting!"})]})]}),r.jsx("svg",{className:"cb-card-arrow cb-grid-arrow",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})]})]}),r.jsxs("button",{className:`cb-feature-card cb-card-leaderboard ripple-btn${g?"":" cb-card-locked"}`,onClick:M=>{We(M),y(g?"/client/leaderboard":"/upgrade")},children:[r.jsxs("div",{className:"cb-card-content",children:[r.jsxs("h3",{children:["Leaderboard ",!g&&r.jsx("span",{className:"cb-premium-badge",children:"PREMIUM"})]}),Ue.length>0?r.jsx("div",{className:"cb-lb-preview",children:Ue.map((M,Z)=>{const Se=["#FFD700","#A8B4C0","#CD7F32"][Z],Je=M.name?M.name.split(" ").map(Pt=>Pt[0]).join("").slice(0,2).toUpperCase():"?",_t=M.id===t?.id;return r.jsxs("div",{className:`cb-lb-entry${_t?" cb-lb-me":""}`,children:[r.jsx("div",{className:"cb-lb-avatar",style:{borderColor:Se},children:M.photoURL?r.jsx("img",{src:M.photoURL,alt:"",className:"cb-lb-avatar-img"}):r.jsx("span",{children:Je})}),r.jsxs("span",{className:"cb-lb-rank",style:{color:Se},children:["#",Z+1]})]},M.id)})}):r.jsx("p",{children:"Opt in to compete with your Core Buddies"})]}),r.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})]}),r.jsxs("button",{className:`cb-feature-card cb-card-buddies ripple-btn${g?"":" cb-card-locked"}`,onClick:M=>{We(M),y(g?"/client/core-buddy/buddies":"/upgrade")},children:[r.jsxs("div",{className:"cb-card-content",children:[r.jsxs("h3",{children:["Buddies ",!g&&r.jsx("span",{className:"cb-premium-badge",children:"PREMIUM"})]}),r.jsx("p",{children:"Connect with other members and track each other's progress"})]}),r.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})]}),r.jsxs("div",{className:`cb-achievements-section${g?"":" cb-card-locked"}`,children:[r.jsxs("h3",{className:"cb-achievements-title",children:["Achievements ",!g&&r.jsx("span",{className:"cb-premium-badge",children:"PREMIUM"})]}),g?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"cb-badges-scroll",children:mu.map(M=>{const Z=ut.includes(M.id);return r.jsx("button",{className:`cb-badge${Z?" unlocked":" locked"}`,onClick:()=>Ht(M),children:r.jsx("img",{src:M.img,alt:M.name,className:"cb-badge-img"})},M.id)})}),r.jsxs("p",{className:"cb-badges-count",children:[ut.length,"/",mu.length," unlocked"]})]}):r.jsxs("button",{className:"cb-upgrade-teaser",onClick:()=>y("/upgrade"),children:[r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),r.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}),r.jsx("span",{children:"Upgrade to unlock achievements"})]})]}),r.jsxs("div",{className:"cb-journey-section",children:[r.jsxs("h3",{className:"cb-journey-title",children:["My Journey ",!g&&r.jsx("span",{className:"cb-premium-badge",children:"PREMIUM"})]}),g?r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"journey-compose",children:[r.jsx("div",{className:"journey-compose-avatar",children:Tt?r.jsx("img",{src:Tt,alt:""}):r.jsx("span",{children:Jc(t?.name)})}),r.jsxs("div",{className:"journey-compose-body",style:{position:"relative"},children:[r.jsx("textarea",{ref:ot,placeholder:"Share your progress... (use @ to mention)",value:we,onChange:Br,rows:1,maxLength:500}),k&&P==="compose"&&ue.length>0&&r.jsx("div",{className:"mention-dropdown",children:ue.map(M=>r.jsxs("button",{className:"mention-option",onClick:()=>Kn(M,"compose"),children:[r.jsx("div",{className:"mention-option-avatar",children:M.photoURL?r.jsx("img",{src:M.photoURL,alt:""}):r.jsx("span",{children:Jc(M.name)})}),r.jsx("span",{children:M.name})]},M.id))}),it&&r.jsxs("div",{className:"journey-image-preview",children:[r.jsx("img",{src:it,alt:"Preview"}),r.jsx("button",{className:"journey-image-remove",onClick:ar,"aria-label":"Remove image",children:r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",children:[r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})})]}),r.jsxs("div",{className:"journey-compose-actions",children:[r.jsx("button",{className:"journey-image-btn",onClick:()=>mt.current?.click(),"aria-label":"Add image",children:r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),r.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),r.jsx("path",{d:"M21 15l-5-5L5 21"})]})}),r.jsx("input",{ref:mt,type:"file",accept:"image/*",onChange:Nr,hidden:!0}),(we.trim()||Me)&&r.jsx("button",{className:"journey-post-btn",onClick:Yn,disabled:Q,children:Q?r.jsx("div",{className:"journey-btn-spinner"}):"Post"})]})]})]}),De?r.jsx("div",{className:"journey-loading",children:r.jsx("div",{className:"cb-spinner"})}):ps.length===0?r.jsxs("div",{className:"journey-empty",children:[r.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),r.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),r.jsx("path",{d:"M21 15l-5-5L5 21"})]}),r.jsx("p",{children:"Start sharing your fitness journey!"})]}):r.jsx("div",{className:"journey-list",children:ps.map(M=>r.jsxs("div",{id:`post-${M.id}`,className:"journey-post",children:[r.jsxs("div",{className:"journey-post-header",children:[r.jsx("div",{className:"journey-post-avatar",children:M.authorPhotoURL?r.jsx("img",{src:M.authorPhotoURL,alt:""}):r.jsx("span",{children:Jc(M.authorName)})}),r.jsxs("div",{className:"journey-post-meta",children:[r.jsx("span",{className:"journey-post-name",children:M.authorName}),r.jsx("span",{className:"journey-post-time",children:qp(M.createdAt)})]}),r.jsx("button",{className:"journey-delete-btn",onClick:()=>ls(M.id),"aria-label":"Delete post",children:r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M3 6h18"}),r.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),r.jsx("path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]}),M.content&&r.jsx("p",{className:"journey-post-content",children:X(M.content)}),M.imageURL&&r.jsx("div",{className:"journey-post-image",children:r.jsx("img",{src:M.imageURL,alt:"Post",loading:"lazy"})}),r.jsxs("div",{className:"journey-post-actions",children:[r.jsxs("button",{className:`journey-action-btn${ze.has(M.id)?" liked":""}`,onClick:()=>Bs(M.id),children:[r.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:ze.has(M.id)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})}),r.jsx("span",{children:M.likeCount||0})]}),r.jsxs("button",{className:`journey-action-btn${ht.has(M.id)?" active":""}`,onClick:()=>jn(M.id),children:[r.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})}),r.jsx("span",{children:M.commentCount||0})]})]}),ht.has(M.id)&&r.jsxs("div",{className:"journey-comments",children:[Ct[M.id]?.length>0?Ct[M.id].map(Z=>r.jsxs("div",{className:"journey-comment",children:[r.jsx("div",{className:"journey-comment-avatar",children:Z.authorPhotoURL?r.jsx("img",{src:Z.authorPhotoURL,alt:""}):r.jsx("span",{children:Jc(Z.authorName)})}),r.jsxs("div",{className:"journey-comment-body",children:[r.jsxs("div",{className:"journey-comment-bubble",children:[r.jsx("span",{className:"journey-comment-name",children:Z.authorName}),Z.replyToName&&r.jsxs("span",{className:"journey-comment-reply-tag",children:[r.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("polyline",{points:"9 14 4 9 9 4"}),r.jsx("path",{d:"M20 20v-7a4 4 0 0 0-4-4H4"})]}),Z.replyToName]}),Z.content&&r.jsx("span",{className:"journey-comment-text",children:X(Z.content)}),Z.imageURL&&r.jsx("img",{className:"journey-comment-image",src:Z.imageURL,alt:"Comment",loading:"lazy"})]}),r.jsxs("div",{className:"journey-comment-actions-row",children:[r.jsx("span",{className:"journey-comment-time",children:qp(Z.createdAt)}),r.jsx("button",{className:"journey-comment-reply-btn",onClick:()=>q(Se=>({...Se,[M.id]:{id:Z.id,authorName:Z.authorName}})),children:"Reply"}),r.jsx("button",{className:"journey-comment-delete-btn",onClick:()=>cn(M.id,Z.id),"aria-label":"Delete comment",children:r.jsxs("svg",{width:"13",height:"13",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M3 6h18"}),r.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),r.jsx("path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]})]})]},Z.id)):r.jsx("p",{className:"journey-no-comments",children:"No comments yet"}),Ls[M.id]&&r.jsxs("div",{className:"journey-comment-replying",children:[r.jsxs("span",{children:["Replying to ",r.jsx("strong",{children:Ls[M.id].authorName})]}),r.jsx("button",{onClick:()=>q(Z=>({...Z,[M.id]:null})),"aria-label":"Cancel reply",children:r.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",children:[r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})})]}),je[M.id]&&r.jsxs("div",{className:"journey-comment-img-preview",children:[r.jsx("img",{src:je[M.id],alt:"Preview"}),r.jsx("button",{onClick:()=>Cr(M.id),"aria-label":"Remove image",children:r.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",children:[r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})})]}),r.jsxs("div",{className:"journey-comment-input",style:{position:"relative"},children:[r.jsx("button",{className:"journey-comment-img-btn",onClick:()=>et.current[M.id]?.click(),"aria-label":"Add image",children:r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),r.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),r.jsx("path",{d:"M21 15l-5-5L5 21"})]})}),r.jsx("input",{ref:Z=>{et.current[M.id]=Z},type:"file",accept:"image/*",onChange:Z=>Vn(M.id,Z),hidden:!0}),r.jsx("input",{type:"text",placeholder:"Comment",value:Ms[M.id]||"",onChange:Z=>fr(M.id,Z.target.value),onKeyDown:Z=>{Z.key==="Enter"&&Qn(M.id)},maxLength:300}),k&&P===M.id&&ue.length>0&&r.jsx("div",{className:"mention-dropdown mention-dropdown-up",children:ue.map(Z=>r.jsxs("button",{className:"mention-option",onClick:()=>Kn(Z,M.id),children:[r.jsx("div",{className:"mention-option-avatar",children:Z.photoURL?r.jsx("img",{src:Z.photoURL,alt:""}):r.jsx("span",{children:Jc(Z.name)})}),r.jsx("span",{children:Z.name})]},Z.id))}),r.jsx("button",{onClick:()=>Qn(M.id),disabled:!(Ms[M.id]||"").trim()&&!xe[M.id]||ns[M.id],children:ns[M.id]?r.jsx("div",{className:"journey-btn-spinner-sm"}):r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"22",y1:"2",x2:"11",y2:"13"}),r.jsx("polygon",{points:"22 2 15 22 11 13 2 9 22 2"})]})})]})]})]},M.id))})]}):r.jsxs("button",{className:"cb-upgrade-teaser",onClick:()=>y("/upgrade"),children:[r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),r.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}),r.jsx("span",{children:"Upgrade to share your journey"})]})]})]})]}),ss&&r.jsx("div",{className:"cb-badge-overlay",onClick:()=>Ht(null),children:r.jsxs("div",{className:"cb-badge-overlay-content",onClick:M=>M.stopPropagation(),children:[r.jsx("img",{src:ss.img,alt:ss.name,className:`cb-badge-overlay-img${ut.includes(ss.id)?"":" cb-badge-overlay-img-locked"}`}),ut.includes(ss.id)?r.jsx("span",{className:"cb-badge-status unlocked",children:"Unlocked"}):r.jsx("span",{className:"cb-badge-status locked",children:"Locked"}),r.jsx("button",{className:"cb-badge-overlay-close",onClick:()=>Ht(null),children:"Tap to close"})]})}),r.jsx(la,{active:"home"}),es&&r.jsxs("div",{className:`toast-notification ${es.type}`,children:[es.type==="info"&&r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("line",{x1:"12",y1:"16",x2:"12",y2:"12"}),r.jsx("line",{x1:"12",y1:"8",x2:"12.01",y2:"8"})]}),es.message]}),r.jsx(yD,{steps:as,active:Xe,onFinish:me}),Dt&&r.jsxs("div",{className:"cb-celebration-overlay",onClick:()=>bt(null),children:[r.jsx("div",{className:"cb-confetti-container",children:Array.from({length:30},(M,Z)=>r.jsx("span",{className:"cb-confetti-piece",style:{"--angle":`${Math.random()*360}deg`,"--distance":`${80+Math.random()*120}px`,"--delay":`${Math.random()*.3}s`,"--color":["#FFD700","#FF6B6B","#4ECDC4","#45B7D1","#F7DC6F","#BB8FCE","#FF8C42","#38B6FF"][Z%8],"--size":`${6+Math.random()*6}px`,"--drift":`${(Math.random()-.5)*60}px`}},Z))}),r.jsxs("div",{className:"cb-celebration-content",onClick:M=>M.stopPropagation(),children:[r.jsx("div",{className:"cb-celebration-glow"}),r.jsx("img",{src:Dt.img,alt:Dt.name,className:"cb-celebration-badge-img"}),r.jsx("h2",{className:"cb-celebration-title",children:"Badge Unlocked!"}),r.jsx("p",{className:"cb-celebration-name",children:Dt.name}),r.jsx("button",{className:"cb-celebration-dismiss",onClick:()=>bt(null),children:"Tap to continue"})]})]})]})})}const Hp=new Map;function Gi(){return new Date().toISOString().split("T")[0]}const j2=[{key:"breakfast",label:"Breakfast"},{key:"lunch",label:"Lunch"},{key:"dinner",label:"Dinner"},{key:"snacks",label:"Snacks"}],kD={breakfast:r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M18 8h1a4 4 0 0 1 0 8h-1"}),r.jsx("path",{d:"M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z"}),r.jsx("line",{x1:"6",y1:"1",x2:"6",y2:"4"}),r.jsx("line",{x1:"10",y1:"1",x2:"10",y2:"4"}),r.jsx("line",{x1:"14",y1:"1",x2:"14",y2:"4"})]}),lunch:r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}),dinner:r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})}),snacks:r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})})};function jD(){const n=new Date().getHours();return n<11?"breakfast":n<14?"lunch":n<17?"snacks":"dinner"}function TD(){const{currentUser:n,isClient:e,clientData:t,loading:i}=Vr(),{isDark:l,toggleTheme:u,accent:d}=Ea(),p=Gn(),[g,y]=v.useState("loading"),[w,j]=v.useState(null),[T,V]=v.useState({gender:"male",age:"",weight:"",weightUnit:"kg",height:"",heightUnit:"cm",heightFeet:"",heightInches:"",dailyActivity:"sedentary",trainingFrequency:"moderate",goal:"maintain",deficitLevel:"moderate"}),[$,F]=v.useState(null),[U,te]=v.useState(Gi()),[K,re]=v.useState({entries:[],water:0}),[ye,ve]=v.useState({protein:0,carbs:0,fats:0,calories:0}),[ge,R]=v.useState(!1),[E,A]=v.useState(!1),[O,D]=v.useState(()=>{const k=new Date;return{year:k.getFullYear(),month:k.getMonth()}}),[H,I]=v.useState(jD),[$e,xt]=v.useState(null),[W,he]=v.useState(null),[Pe,He]=v.useState(!1),[ee,L]=v.useState(null),[se,Le]=v.useState(""),[Oe,Ye]=v.useState(!1),[Ue,pt]=v.useState(""),[Tt,at]=v.useState([]),[Gt,zs]=v.useState(!1),[yt,ut]=v.useState({name:"",protein:"",carbs:"",fats:"",calories:"",serving:""}),[oe,ss]=v.useState(null),[Ht,Dt]=v.useState("100"),[bt,Ge]=v.useState(0),[Ze,Et]=v.useState("weight"),[rn,js]=v.useState(0),[Kt,St]=v.useState(null);v.useRef(null);const Yt=v.useRef(!1),us=v.useRef(null),es=v.useRef(null),Xs=v.useRef(null),Nt=v.useCallback((k,N="info")=>{St({message:k,type:N}),setTimeout(()=>St(null),3e3)},[]);v.useEffect(()=>{!i&&(!n||!e)&&p("/")},[n,e,i,p]),v.useEffect(()=>{if(!t?.id)return;(async()=>{try{const N=await As(qe(fe,"nutritionTargets",t.id));N.exists()?(j(N.data()),y("dashboard")):y("setup")}catch(N){console.error("Error loading nutrition data:",N),y("setup")}})()},[t?.id]),v.useEffect(()=>{if(!t?.id)return;(async()=>{try{const N=await As(qe(fe,"nutritionLogs",`${t.id}_${U}`));if(N.exists()){const P=N.data();re({entries:P.entries||[],water:P.water||0})}else re({entries:[],water:0})}catch(N){console.error("Error loading log:",N),re({entries:[],water:0})}})()},[t?.id,U]),v.useEffect(()=>{const k=K.entries.reduce((N,P)=>({protein:N.protein+(P.protein||0),carbs:N.carbs+(P.carbs||0),fats:N.fats+(P.fats||0),calories:N.calories+(P.calories||0)}),{protein:0,carbs:0,fats:0,calories:0});ve(k)},[K.entries]);const ps=async k=>{try{await Ns(qe(fe,"nutritionLogs",`${t.id}_${U}`),{clientId:t.id,date:U,entries:k.entries,water:k.water,updatedAt:wt.now()})}catch(N){console.error("Error saving nutrition log:",N)}},be=U===Gi(),De=(k,N)=>new Date(k,N+1,0).getDate(),Y=(k,N)=>new Date(k,N,1).getDay(),we=["January","February","March","April","May","June","July","August","September","October","November","December"],Ce=["Su","Mo","Tu","We","Th","Fr","Sa"],Me=()=>{let k=parseFloat(T.weight);T.weightUnit==="lbs"&&(k*=.453592);let N;T.heightUnit==="cm"?N=parseFloat(T.height):N=(parseFloat(T.heightFeet)||0)*30.48+(parseFloat(T.heightInches)||0)*2.54;const P=parseInt(T.age);let B=T.gender==="male"?10*k+6.25*N-5*P+5:10*k+6.25*N-5*P-161;const Be=B*{sedentary:1.2,light:1.3,moderate:1.4,active:1.5}[T.dailyActivity],Fe={low:100,moderate:200,high:300,daily:400},tt=Math.round(Be+Fe[T.trainingFrequency]);let Xe=tt,Qt,Ts;switch(T.goal){case"lose":Xe=tt*(1-{light:.15,moderate:.2,harsh:.25}[T.deficitLevel]),Qt=2.2,Ts=.3;break;case"build":Xe=tt*1.1,Qt=2,Ts=.22;break;default:Qt=1.8,Ts=.25}Xe=Math.max(Xe,T.gender==="male"?1400:1100);const as=Math.round(k*Qt),cs=Math.round(Xe*Ts/9),Os=Math.max(0,Math.round((Xe-as*4-cs*9)/4));F({calories:Math.round(Xe),protein:as,carbs:Os,fats:cs,bmr:Math.round(B),neat:Math.round(Be),exerciseAdd:Fe[T.trainingFrequency],tdee:Math.round(tt)})},Ae=async()=>{if($)try{const k={clientId:t.id,calories:$.calories,protein:$.protein,carbs:$.carbs,fats:$.fats,waterGoal:8,goal:T.goal,updatedAt:wt.now()};await Ns(qe(fe,"nutritionTargets",t.id),k),j(k),y("dashboard"),Nt("Macro targets saved!","success")}catch(k){console.error("Error saving targets:",k),Nt("Failed to save targets. Please try again.","error")}},it=()=>{const k=T.weight&&parseFloat(T.weight)>0,N=T.age&&parseInt(T.age)>0,P=T.heightUnit==="cm"?T.height&&parseFloat(T.height)>0:T.heightFeet&&parseFloat(T.heightFeet)>0||T.heightInches&&parseFloat(T.heightInches)>0;return k&&N&&P},Qe="nut_favourite_foods",Q=()=>{try{return JSON.parse(localStorage.getItem(Qe)||"[]")}catch{return[]}},ce=k=>Q().some(N=>N.name.toLowerCase()===(k||"").toLowerCase()),ze=k=>{const N=Q(),P=N.findIndex(B=>B.name.toLowerCase()===k.name.toLowerCase());P>=0?N.splice(P,1):N.unshift({name:k.name,protein:k.protein,carbs:k.carbs,fats:k.fats,calories:k.calories,serving:k.serving,per100g:k.per100g||null,servingUnit:k.servingUnit||"g",portion:k.portion||null}),localStorage.setItem(Qe,JSON.stringify(N)),js(B=>B+1)},dt=k=>{const N=[...K.entries,{...k,meal:H,id:Date.now(),addedAt:new Date().toISOString()}],P={...K,entries:N};re(P),ps(P),he(null),ss(null),Dt("100"),Ge(0),Et("weight"),ut({name:"",protein:"",carbs:"",fats:"",calories:"",serving:""}),Nt("Food added!","success")},ht=k=>{const N=K.entries.filter(B=>B.id!==k),P={...K,entries:N};re(P),ps(P)},Vt=v.useRef(null),Ct=async()=>{He(!0);const k=document.querySelector("#barcode-reader");if(!k){He(!1),Nt("Scanner container not found.","error");return}if(!Vt.current)try{const P=await Er(()=>import("./quagga.min-BbicSfvA.js").then(B=>B.q),[]);Vt.current=P.default}catch(P){console.error("Failed to load barcode scanner:",P),He(!1),Nt("Could not load scanner.","error");return}const N=Vt.current;N.init({inputStream:{type:"LiveStream",target:k,constraints:{facingMode:"environment",width:{min:640,ideal:1280,max:1920},height:{min:480,ideal:720,max:1080}}},locator:{patchSize:"medium",halfSample:!0},numOfWorkers:navigator.hardwareConcurrency||2,decoder:{readers:["ean_reader","ean_8_reader","upc_reader","upc_e_reader","code_128_reader","code_39_reader"]},locate:!0},P=>{if(P){console.error("Quagga init error:",P),He(!1),Nt("Could not access camera. Check permissions.","error");return}N.start(),Yt.current=!0}),N.onDetected(P=>{const B=P.codeResult.decodedCodes?.filter(Be=>Be.error!==void 0)?.map(Be=>Be.error)||[];if((B.length>0?B.reduce((Be,Fe)=>Be+Fe,0)/B.length:1)<.15){const Be=P.codeResult.code;N.offDetected(),L(Be)}})},At=()=>{const k=Vt.current;Yt.current&&k&&(k.stop(),k.offDetected(),Yt.current=!1),He(!1)},Ms=/\b(milk|semi.skimmed|skimmed|whole milk|oat milk|almond milk|soy milk|juice|smoothie|water|squash|cordial|cola|pepsi|fanta|lemonade|soda|beer|wine|cider|lager|spirit|whisky|vodka|rum|gin|brandy|cream|yoghurt drink|milkshake|coffee|tea|broth|stock|soup|sauce|ketchup|vinegar|oil|syrup|honey|custard|coconut water|kombucha|energy drink|protein shake)\b/i,Js=k=>/ml|cl|\dl(?!b)|litre|liter|fl\s?oz/i.test((k||"").replace(/\s/g,"")),ns=k=>{if(!k)return{value:100,unit:"g"};const N=k.toLowerCase().replace(/\s/g,""),P=N.match(/([\d.]+)/),B=P?parseFloat(P[1]):100;return Js(k)?/cl/.test(N)?{value:B*10,unit:"ml"}:/(?:^|\d)l(?!i)/.test(N)&&!/ml/.test(N)?{value:B*1e3,unit:"ml"}:{value:B,unit:"ml"}:{value:B,unit:"g"}},Cs=k=>{if(Js(k.serving_size)||Js(k.quantity))return"ml";const N=k.product_name||k.product_name_en||"";return Ms.test(N)?"ml":"g"},Ls=[{pattern:/\b(toast|bread|loaf|brioche|bagel|pitta|wrap|tortilla|crumpet|muffin|waffle|pancake)\b/i,label:"slice",weight:36},{pattern:/\begg\b/i,label:"egg",weight:60},{pattern:/\b(biscuit|cookie|digestive|hobnob|rich tea|oreo)\b/i,label:"biscuit",weight:13},{pattern:/\b(sausage|banger)\b/i,label:"sausage",weight:57},{pattern:/\b(rasher|bacon)\b/i,label:"rasher",weight:25},{pattern:/\b(rice cake)\b/i,label:"cake",weight:9},{pattern:/\b(cracker|ryvita)\b/i,label:"cracker",weight:10}],q=(k,N)=>{const P=k||"",B=P.match(/\((\d+\.?\d*)\s*g\)/i),ue=P.match(/(?:^|per\s+)(\d*\s*[a-z][a-z\s]*?)(?:\s*\(|\s*-\s*|\s*$)/i);if(B&&ue){const tt=parseFloat(B[1]);let Xe=ue[1].replace(/^\d+\s*/,"").trim();if(Xe&&tt>0)return{label:Xe,weight:tt}}const Be=P.match(/(\d+\.?\d*)\s*g\s*[\/=]\s*(\d*\s*[a-z][a-z\s]*)/i);if(Be){const tt=parseFloat(Be[1]);let Xe=Be[2].replace(/^\d+\s*/,"").trim();if(Xe&&tt>0)return{label:Xe,weight:tt}}const Fe=N||"";for(const{pattern:tt,label:Xe,weight:Qt}of Ls)if(tt.test(Fe))return{label:Xe,weight:Qt};return null},xe=k=>{const N=k.nutriments||{},P=Cs(k),B=ns(k.serving_size),ue=P==="ml"?B.unit==="ml"?B.value:100:B.value,Be=k.product_name||k.product_name_en||"Unknown Product",Fe=q(k.serving_size,Be);return{name:Be,brand:k.brands||"",image:k.image_small_url||k.image_url||null,servingSize:k.serving_size||"100g",servingValue:ue,servingUnit:P,portion:Fe,protein:Math.round(N.proteins_100g||N.proteins||0),carbs:Math.round(N.carbohydrates_100g||N.carbohydrates||0),fats:Math.round(N.fat_100g||N.fat||0),calories:Math.round(N["energy-kcal_100g"]||N["energy-kcal"]||(N.energy_100g?N.energy_100g/4.184:0)),per100g:!0}},Ee=async k=>{Ye(!0);try{const N=`https://world.openfoodfacts.org/api/v2/product/${k}?fields=product_name,product_name_en,brands,image_small_url,image_url,serving_size,quantity,nutriments`,P=await fetch(N);if(!P.ok)throw new Error(`HTTP ${P.status}`);const B=await P.json();if(B.status==="success"||B.status===1||B.product){const ue=xe(B.product);ue.calories===0&&ue.protein===0&&ue.carbs===0?Nt("Product found but no nutrition data available.","error"):(ss(ue),ue.portion?(Ge(1),Dt(String(ue.portion.weight)),Et("portion")):(Ge(0),Dt(String(ue.servingValue||100)),Et("weight")),Le(""))}else Nt("Product not found. Try search or manual entry.","error")}catch(N){console.error("Barcode lookup error:",N),Nt("Failed to look up product. Check your connection.","error")}Ye(!1)},je=(k,N,P)=>{const B=k.toLowerCase().trim(),ue=N.toLowerCase().trim(),Be=P.toLowerCase().trim();let Fe=0;return(B===Be||B===Be+"s"||B+"s"===Be)&&(Fe+=100),(B.endsWith(" "+Be)||B.endsWith(" "+Be+"s"))&&(Fe+=40),(B.startsWith(Be+" ")||B.startsWith(Be+"s "))&&(Fe+=15),Be.split(/\s+/).some(Xe=>ue===Xe||ue.startsWith(Xe))&&(Fe+=30),Fe+=Math.max(0,30-B.length),Fe},ke=async()=>{if(!Ue.trim())return;us.current&&us.current.abort();const k=new AbortController;us.current=k;const N=Ue.trim().toLowerCase(),P=N.split(/\s+/).filter(Boolean);if(Hp.has(N)){at(Hp.get(N));return}zs(!0);try{const ue=`https://world.openfoodfacts.org/cgi/search.pl?search_terms=${encodeURIComponent(Ue.trim())}&search_simple=1&action=process&json=1&page_size=10&lc=en&sort_by=unique_scans_n&fields=product_name,product_name_en,brands,image_small_url,image_url,serving_size,quantity,nutriments`,Be=await fetch(ue,{signal:k.signal});if(!Be.ok)throw new Error(`HTTP ${Be.status}`);const tt=((await Be.json()).products||[]).map(Xe=>xe(Xe)).filter(Xe=>Xe.name!=="Unknown Product"&&(Xe.calories>0||Xe.protein>0)).filter(Xe=>{const Qt=(Xe.name+" "+Xe.brand).toLowerCase();return P.every(Ts=>Qt.includes(Ts))}).sort((Xe,Qt)=>je(Qt.name,Qt.brand,N)-je(Xe.name,Xe.brand,N)).slice(0,10);Hp.set(N,tt),at(tt),tt.length===0&&Nt("No results found. Try a different search.","info")}catch(B){if(B.name==="AbortError")return;console.error("Search error:",B),Nt("Search failed. Check your connection.","error")}zs(!1)};v.useEffect(()=>{if(es.current&&clearTimeout(es.current),!(!Ue.trim()||W!=="search"||oe))return es.current=setTimeout(()=>{ke()},700),()=>clearTimeout(es.current)},[Ue]);const ot=()=>{const k={...K,water:K.water+1};re(k),ps(k)},mt=()=>{if(K.water<=0)return;const k={...K,water:K.water-1};re(k),ps(k)},et={"ring-protein":"#14b8a6","ring-carbs":"var(--color-primary)","ring-fats":"#eab308","ring-cals":"rgba(150,150,150,0.55)"},gt=80,Rt=2*Math.PI*gt,ws=(k,N,P,B,ue)=>{const Be=B>0?Math.min(100,Math.round(P/B*100)):0,Fe=Rt-Be/100*Rt,tt=et[ue]||"#14b8a6";return r.jsxs("div",{className:"nut-ring-wrap",children:[r.jsxs("svg",{className:"nut-ring-svg",viewBox:"0 0 200 200",children:[r.jsx("circle",{className:"nut-arc-track",cx:"100",cy:"100",r:gt}),r.jsx("circle",{className:"nut-arc-fill",cx:"100",cy:"100",r:gt,style:{stroke:tt},strokeDasharray:Rt,strokeDashoffset:Fe})]}),r.jsxs("div",{className:"nut-ring-center",children:[r.jsx("span",{className:"nut-ring-value",style:{color:tt},children:Math.round(P)}),r.jsxs("span",{className:"nut-ring-target",children:["/ ",B,k==="Calories"?"":"g"]}),r.jsx("span",{className:"nut-ring-label",style:{color:tt},children:N})]}),r.jsxs("span",{className:"nut-ring-pct",style:{color:tt},children:[Be,"%"]})]})};if(v.useEffect(()=>{if(!ee)return;const k=setTimeout(()=>{const N=ee;At(),L(null),Ee(N)},1500);return()=>clearTimeout(k)},[ee]),v.useEffect(()=>()=>{const k=Vt.current;if(Yt.current&&k){try{k.stop(),k.offDetected()}catch{}Yt.current=!1}},[]),i||g==="loading")return r.jsxs("div",{className:"nut-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>p("/client/core-buddy"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})]})}),r.jsx("div",{className:"nut-loading-inline",children:r.jsx("div",{className:"cb-loading-spinner"})})]});if(g==="setup")return r.jsxs("div",{className:"nut-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>p("/client/core-buddy"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),r.jsxs("main",{className:"nut-main",children:[r.jsxs("div",{className:"nut-setup-intro",children:[r.jsx("h2",{children:"Set Your Daily Targets"}),r.jsx("p",{children:"Calculate your personalised macros based on your body and goals."})]}),r.jsxs("div",{className:"nut-calc-form",children:[r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Gender"}),r.jsxs("div",{className:"nut-toggle-group",children:[r.jsx("button",{className:T.gender==="male"?"active":"",onClick:()=>{V(k=>({...k,gender:"male"})),F(null)},children:"Male"}),r.jsx("button",{className:T.gender==="female"?"active":"",onClick:()=>{V(k=>({...k,gender:"female"})),F(null)},children:"Female"})]})]}),r.jsxs("div",{className:"nut-form-row",children:[r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Age"}),r.jsx("input",{type:"number",value:T.age,onChange:k=>{V(N=>({...N,age:k.target.value})),F(null)},placeholder:"Years",min:"15",max:"100"})]}),r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Weight"}),r.jsxs("div",{className:"nut-input-unit",children:[r.jsx("input",{type:"number",value:T.weight,onChange:k=>{V(N=>({...N,weight:k.target.value})),F(null)},placeholder:T.weightUnit,min:"30",max:"300"}),r.jsxs("div",{className:"nut-unit-toggle",children:[r.jsx("button",{className:T.weightUnit==="kg"?"active":"",onClick:()=>{V(k=>({...k,weightUnit:"kg"})),F(null)},children:"kg"}),r.jsx("button",{className:T.weightUnit==="lbs"?"active":"",onClick:()=>{V(k=>({...k,weightUnit:"lbs"})),F(null)},children:"lbs"})]})]})]})]}),r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Height"}),r.jsxs("div",{className:"nut-input-unit",children:[T.heightUnit==="cm"?r.jsx("input",{type:"number",value:T.height,onChange:k=>{V(N=>({...N,height:k.target.value})),F(null)},placeholder:"cm",min:"100",max:"250"}):r.jsxs("div",{className:"nut-height-imperial",children:[r.jsx("input",{type:"number",value:T.heightFeet,onChange:k=>{V(N=>({...N,heightFeet:k.target.value})),F(null)},placeholder:"ft",min:"4",max:"7"}),r.jsx("input",{type:"number",value:T.heightInches,onChange:k=>{V(N=>({...N,heightInches:k.target.value})),F(null)},placeholder:"in",min:"0",max:"11"})]}),r.jsxs("div",{className:"nut-unit-toggle",children:[r.jsx("button",{className:T.heightUnit==="cm"?"active":"",onClick:()=>{V(k=>({...k,heightUnit:"cm"})),F(null)},children:"cm"}),r.jsx("button",{className:T.heightUnit==="ft"?"active":"",onClick:()=>{V(k=>({...k,heightUnit:"ft"})),F(null)},children:"ft/in"})]})]})]}),r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Daily Activity (outside of training)"}),r.jsxs("select",{value:T.dailyActivity,onChange:k=>{V(N=>({...N,dailyActivity:k.target.value})),F(null)},children:[r.jsx("option",{value:"sedentary",children:"Sedentary  desk job, under 5k steps"}),r.jsx("option",{value:"light",children:"Lightly Active  office + walking, 5-8k steps"}),r.jsx("option",{value:"moderate",children:"Moderately Active  on feet often, 8-12k steps"}),r.jsx("option",{value:"active",children:"Very Active  physical job, 12k+ steps"})]})]}),r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Training Sessions per Week"}),r.jsxs("select",{value:T.trainingFrequency,onChange:k=>{V(N=>({...N,trainingFrequency:k.target.value})),F(null)},children:[r.jsx("option",{value:"low",children:"1-2 sessions"}),r.jsx("option",{value:"moderate",children:"3-4 sessions"}),r.jsx("option",{value:"high",children:"5-6 sessions"}),r.jsx("option",{value:"daily",children:"7+ sessions"})]})]}),r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Fitness Goal"}),r.jsxs("div",{className:"nut-goal-options",children:[r.jsxs("button",{className:T.goal==="lose"?"active":"",onClick:()=>{V(k=>({...k,goal:"lose"})),F(null)},children:[r.jsx("span",{className:"nut-goal-icon",children:"-"}),r.jsx("span",{children:"Lose Weight"})]}),r.jsxs("button",{className:T.goal==="maintain"?"active":"",onClick:()=>{V(k=>({...k,goal:"maintain"})),F(null)},children:[r.jsx("span",{className:"nut-goal-icon",children:"="}),r.jsx("span",{children:"Maintain"})]}),r.jsxs("button",{className:T.goal==="build"?"active":"",onClick:()=>{V(k=>({...k,goal:"build"})),F(null)},children:[r.jsx("span",{className:"nut-goal-icon",children:"+"}),r.jsx("span",{children:"Build Muscle"})]})]})]}),T.goal==="lose"&&r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Deficit Level"}),r.jsxs("div",{className:"nut-deficit-options",children:[r.jsxs("button",{className:T.deficitLevel==="light"?"active":"",onClick:()=>{V(k=>({...k,deficitLevel:"light"})),F(null)},children:[r.jsx("strong",{children:"Mild"}),r.jsx("span",{children:"15% below TDEE"})]}),r.jsxs("button",{className:T.deficitLevel==="moderate"?"active":"",onClick:()=>{V(k=>({...k,deficitLevel:"moderate"})),F(null)},children:[r.jsx("strong",{children:"Moderate"}),r.jsx("span",{children:"20% below TDEE"})]}),r.jsxs("button",{className:T.deficitLevel==="harsh"?"active":"",onClick:()=>{V(k=>({...k,deficitLevel:"harsh"})),F(null)},children:[r.jsx("strong",{children:"Aggressive"}),r.jsx("span",{children:"25% below TDEE"})]})]})]}),r.jsx("button",{className:"nut-calc-btn",onClick:Me,disabled:!it(),children:"Calculate Macros"})]}),$&&r.jsxs("div",{className:"nut-calc-results",children:[r.jsx("h3",{children:"Your Daily Targets"}),r.jsxs("div",{className:"nut-calc-rings",children:[ws("Protein","Protein",$.protein,$.protein,"ring-protein"),ws("Carbs","Carbs",$.carbs,$.carbs,"ring-carbs"),ws("Fats","Fats",$.fats,$.fats,"ring-fats"),ws("Calories","Calories",$.calories,$.calories,"ring-cals")]}),r.jsxs("div",{className:"nut-calc-info",children:[r.jsxs("div",{className:"nut-calc-info-row",children:[r.jsx("span",{children:"BMR (body at rest)"}),r.jsxs("span",{children:[$.bmr," cal"]})]}),r.jsxs("div",{className:"nut-calc-info-row",children:[r.jsx("span",{children:"+ Daily activity (NEAT)"}),r.jsxs("span",{children:[$.neat," cal"]})]}),r.jsxs("div",{className:"nut-calc-info-row",children:[r.jsx("span",{children:"+ Training sessions"}),r.jsxs("span",{children:["+",$.exerciseAdd," cal"]})]}),r.jsxs("div",{className:"nut-calc-info-row",style:{fontWeight:600},children:[r.jsx("span",{children:"TDEE (total burn)"}),r.jsxs("span",{children:[$.tdee," cal"]})]})]}),r.jsx("button",{className:"nut-save-targets-btn",onClick:Ae,children:"Set as My Daily Targets"})]})]}),Kt&&r.jsx("div",{className:`toast-notification ${Kt.type}`,children:Kt.message})]});const _n=k=>{const N=new Date(k+"T12:00:00"),P=N.getDay(),B=new Date(N);B.setDate(N.getDate()-(P+6)%7);const ue=[];for(let Be=0;Be<7;Be++){const Fe=new Date(B);Fe.setDate(B.getDate()+Be),ue.push(Fe.toISOString().split("T")[0])}return ue},ln=["M","T","W","T","F","S","S"],Ln=(k,N="search")=>{I(k),N==="scan"?(he("scan"),ss(null)):N==="manual"?(he("manual"),ut({name:"",protein:"",carbs:"",fats:"",calories:"",serving:""})):N==="favourites"?he("favourites"):(he("search"),at([]),pt(""))},kn=_n(U),pn=new Date(U+"T12:00:00"),Hs=`${we[pn.getMonth()]} ${pn.getFullYear()}`;return r.jsx(ka,{children:r.jsxs("div",{className:"nut-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsxs("div",{className:"nut-dark-zone",children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>p("/client/core-buddy"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsxs("div",{className:"header-actions",children:[r.jsx("button",{onClick:()=>{y("setup"),F(null)},"aria-label":"Recalculate macros",children:r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"3"}),r.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 1 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 1 1-2.83-2.83l.06-.06A1.65 1.65 0 0 0 4.68 15a1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1 0-4h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 1 1 2.83-2.83l.06.06A1.65 1.65 0 0 0 9 4.68a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 2.83l-.06.06A1.65 1.65 0 0 0 19.4 9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1z"})]})}),r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})]})]})}),r.jsxs("div",{className:"nut-dark-content",children:[r.jsxs("div",{className:"nut-week-strip anim-fade-up",children:[r.jsxs("div",{className:"nut-week-header",children:[r.jsx("button",{className:"nut-week-arrow",onClick:()=>{const k=new Date(U+"T12:00:00");k.setDate(k.getDate()-7);const N=k.toISOString().split("T")[0];te(N)},"aria-label":"Previous week",children:r.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:r.jsx("polyline",{points:"15 18 9 12 15 6"})})}),r.jsx("button",{className:"nut-week-month-label",onClick:()=>{R(!ge),D({year:pn.getFullYear(),month:pn.getMonth()})},children:Hs}),r.jsx("button",{className:"nut-week-arrow",onClick:()=>{const k=new Date(U+"T12:00:00");k.setDate(k.getDate()+7);const N=k.toISOString().split("T")[0];N<=Gi()&&te(N)},"aria-label":"Next week",disabled:kn[6]>=Gi(),children:r.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:r.jsx("polyline",{points:"9 18 15 12 9 6"})})})]}),r.jsx("div",{className:"nut-week-days",children:kn.map((k,N)=>{const P=new Date(k+"T12:00:00").getDate(),B=k===U,ue=k>Gi(),Be=k===Gi();return r.jsxs("button",{className:`nut-week-day${B?" selected":""}${Be?" today":""}${ue?" future":""}`,disabled:ue,onClick:()=>te(k),children:[r.jsx("span",{className:"nut-week-day-letter",children:ln[N]}),r.jsx("span",{className:"nut-week-day-num",children:P})]},k)})})]}),ge&&r.jsxs("div",{className:"nut-calendar nut-calendar-dark",children:[r.jsxs("div",{className:"nut-cal-header",children:[r.jsx("button",{onClick:()=>D(k=>{let N=k.month-1,P=k.year;return N<0&&(N=11,P--),{year:P,month:N}}),children:r.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("polyline",{points:"15 18 9 12 15 6"})})}),r.jsxs("span",{children:[we[O.month]," ",O.year]}),r.jsx("button",{onClick:()=>D(k=>{let N=k.month+1,P=k.year;return N>11&&(N=0,P++),{year:P,month:N}}),disabled:O.year===new Date().getFullYear()&&O.month>=new Date().getMonth(),children:r.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("polyline",{points:"9 18 15 12 9 6"})})})]}),r.jsx("div",{className:"nut-cal-days-header",children:Ce.map(k=>r.jsx("span",{children:k},k))}),r.jsxs("div",{className:"nut-cal-grid",children:[[...Array(Y(O.year,O.month))].map((k,N)=>r.jsx("span",{},`e${N}`)),[...Array(De(O.year,O.month))].map((k,N)=>{const P=N+1,B=`${O.year}-${String(O.month+1).padStart(2,"0")}-${String(P).padStart(2,"0")}`,ue=B>Gi(),Be=B===U,Fe=B===Gi();return r.jsx("button",{className:`nut-cal-day${Be?" selected":""}${Fe?" today":""}${ue?" future":""}`,disabled:ue,onClick:()=>{te(B),R(!1)},children:P},P)})]})]}),r.jsxs("div",{className:"nut-rings-row anim-fade-up-d2",children:[ws("Protein","Protein",ye.protein,w.protein,"ring-protein"),ws("Carbs","Carbs",ye.carbs,w.carbs,"ring-carbs"),ws("Fats","Fats",ye.fats,w.fats,"ring-fats"),ws("Calories","kCal",ye.calories,w.calories,"ring-cals")]})]})]}),r.jsx("div",{className:"nut-light-zone anim-fade-up-d4",children:r.jsxs("div",{className:"nut-light-content",children:[be&&r.jsxs("button",{className:"nut-water-quick",onClick:()=>A(!0),children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",stroke:"none",width:"18",height:"18",children:r.jsx("path",{d:"M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z"})}),r.jsxs("span",{className:"nut-water-quick-count",children:[K.water," / ",w?.waterGoal||8]}),r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",width:"14",height:"14",children:[r.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),r.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})]}),r.jsx("div",{className:"nut-log-section",children:r.jsx("div",{className:"nut-meals-list",children:j2.map(k=>{const N=K.entries.filter(B=>(B.meal||"snacks")===k.key),P=N.reduce((B,ue)=>({protein:B.protein+(ue.protein||0),carbs:B.carbs+(ue.carbs||0),fats:B.fats+(ue.fats||0),calories:B.calories+(ue.calories||0)}),{protein:0,carbs:0,fats:0,calories:0});return r.jsxs("div",{className:"nut-meal-card",children:[r.jsxs("div",{className:"nut-meal-card-header",children:[r.jsx("span",{className:`nut-meal-card-icon nut-meal-icon-${k.key}`,children:kD[k.key]}),r.jsx("span",{className:"nut-meal-card-title",children:k.label}),N.length>0&&r.jsxs("span",{className:"nut-meal-card-cal",children:[P.calories," cal"]}),be&&r.jsx("button",{className:"nut-meal-add-btn",onClick:()=>xt($e===k.key?null:k.key),"aria-label":`Add to ${k.label}`,children:r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:[r.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),r.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})})]}),N.length>0&&r.jsxs("div",{className:"nut-meal-bars",children:[r.jsxs("div",{className:"nut-meal-bar-row",children:[r.jsx("span",{className:"nut-meal-bar-label nut-macro-p",children:"P"}),r.jsx("div",{className:"nut-meal-bar-track",children:r.jsx("div",{className:"nut-meal-bar-fill bar-protein",style:{width:`${Math.min(100,w.protein>0?P.protein/w.protein*100:0)}%`}})}),r.jsxs("span",{className:"nut-meal-bar-val",children:[P.protein,"g"]})]}),r.jsxs("div",{className:"nut-meal-bar-row",children:[r.jsx("span",{className:"nut-meal-bar-label nut-macro-c",children:"C"}),r.jsx("div",{className:"nut-meal-bar-track",children:r.jsx("div",{className:"nut-meal-bar-fill bar-carbs",style:{width:`${Math.min(100,w.carbs>0?P.carbs/w.carbs*100:0)}%`}})}),r.jsxs("span",{className:"nut-meal-bar-val",children:[P.carbs,"g"]})]}),r.jsxs("div",{className:"nut-meal-bar-row",children:[r.jsx("span",{className:"nut-meal-bar-label nut-macro-f",children:"F"}),r.jsx("div",{className:"nut-meal-bar-track",children:r.jsx("div",{className:"nut-meal-bar-fill bar-fats",style:{width:`${Math.min(100,w.fats>0?P.fats/w.fats*100:0)}%`}})}),r.jsxs("span",{className:"nut-meal-bar-val",children:[P.fats,"g"]})]}),r.jsxs("div",{className:"nut-meal-bar-row",children:[r.jsx("span",{className:"nut-meal-bar-label nut-macro-cal",children:"K"}),r.jsx("div",{className:"nut-meal-bar-track",children:r.jsx("div",{className:"nut-meal-bar-fill bar-cals",style:{width:`${Math.min(100,w.calories>0?P.calories/w.calories*100:0)}%`}})}),r.jsx("span",{className:"nut-meal-bar-val",children:P.calories})]})]}),N.length>0&&r.jsx("div",{className:"nut-log-list",children:N.map(B=>r.jsxs("div",{className:"nut-log-item",children:[r.jsxs("div",{className:"nut-log-item-info",children:[r.jsx("span",{className:"nut-log-item-name",children:B.name}),B.serving&&r.jsx("span",{className:"nut-log-item-serving",children:B.serving})]}),r.jsxs("div",{className:"nut-log-item-macros",children:[r.jsxs("span",{className:"nut-macro-p",children:[B.protein,"p"]}),r.jsxs("span",{className:"nut-macro-c",children:[B.carbs,"c"]}),r.jsxs("span",{className:"nut-macro-f",children:[B.fats,"f"]}),r.jsx("span",{className:"nut-macro-cal",children:B.calories})]}),be&&r.jsx("button",{className:"nut-log-delete",onClick:()=>ht(B.id),"aria-label":"Remove",children:r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]},B.id))}),N.length===0&&r.jsx("div",{className:"nut-meal-empty",children:r.jsx("p",{children:be?"Tap + to add food":"No entries"})})]},k.key)})})})]})}),$e&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"nut-add-picker-backdrop",onClick:()=>xt(null)}),r.jsxs("div",{className:"nut-add-picker",children:[r.jsx("div",{className:"nut-add-picker-handle"}),r.jsxs("h3",{className:"nut-add-picker-title",children:["Add to ",j2.find(k=>k.key===$e)?.label]}),r.jsxs("div",{className:"nut-add-picker-options",children:[r.jsxs("button",{onClick:()=>{const k=$e;xt(null),Ln(k,"scan")},children:[r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M3 7V5a2 2 0 0 1 2-2h2"}),r.jsx("path",{d:"M17 3h2a2 2 0 0 1 2 2v2"}),r.jsx("path",{d:"M21 17v2a2 2 0 0 1-2 2h-2"}),r.jsx("path",{d:"M7 21H5a2 2 0 0 1-2-2v-2"}),r.jsx("line",{x1:"7",y1:"12",x2:"17",y2:"12"})]}),r.jsx("span",{children:"Scan Barcode"})]}),r.jsxs("button",{onClick:()=>{const k=$e;xt(null),Ln(k,"search")},children:[r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"11",cy:"11",r:"8"}),r.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),r.jsx("span",{children:"Search Food"})]}),r.jsxs("button",{onClick:()=>{const k=$e;xt(null),Ln(k,"manual")},children:[r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),r.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]}),r.jsx("span",{children:"Manual Entry"})]}),r.jsxs("button",{onClick:()=>{const k=$e;xt(null),Ln(k,"favourites")},children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),r.jsx("span",{children:"Favourites"})]})]})]})]}),E&&r.jsx("div",{className:"nut-modal-overlay",onClick:()=>A(!1),children:r.jsxs("div",{className:"nut-water-popup",onClick:k=>k.stopPropagation(),children:[r.jsxs("div",{className:"nut-water-popup-header",children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",stroke:"none",width:"20",height:"20",style:{color:"#2196f3"},children:r.jsx("path",{d:"M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z"})}),r.jsx("span",{children:"Water Intake"}),r.jsx("button",{className:"nut-modal-close",onClick:()=>A(!1),children:r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),r.jsxs("div",{className:"nut-water-popup-body",children:[r.jsx("div",{className:"nut-water-glasses",children:[...Array(w?.waterGoal||8)].map((k,N)=>r.jsx("div",{className:`nut-water-glass ${N<K.water?"filled":""}`,children:r.jsx("svg",{viewBox:"0 0 24 24",fill:N<K.water?"currentColor":"none",stroke:"currentColor",strokeWidth:"1.5",children:r.jsx("path",{d:"M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z"})})},N))}),r.jsxs("div",{className:"nut-water-popup-count",children:[K.water," / ",w?.waterGoal||8," glasses"]}),r.jsxs("div",{className:"nut-water-btns",children:[r.jsx("button",{onClick:mt,disabled:K.water<=0,children:"-"}),r.jsx("button",{onClick:ot,children:"+"})]})]})]})}),W&&r.jsx("div",{className:"nut-modal-overlay",onClick:()=>{At(),L(null),he(null),ss(null)},children:r.jsxs("div",{className:"nut-modal",onClick:k=>k.stopPropagation(),children:[r.jsxs("div",{className:"nut-modal-header",children:[r.jsx("h3",{children:W==="scan"?"Scan Barcode":W==="search"?"Search Food":W==="favourites"?"Favourites":"Manual Entry"}),r.jsx("button",{className:"nut-modal-close",onClick:()=>{At(),L(null),he(null),ss(null)},children:r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),W==="scan"&&!oe&&r.jsxs("div",{className:"nut-scan-area",children:[r.jsxs("div",{className:"nut-scanner-wrapper",children:[r.jsx("div",{id:"barcode-reader",className:"nut-scanner-view"}),Pe&&!ee&&r.jsx("div",{className:"nut-scan-line"}),ee&&r.jsxs("div",{className:"nut-scan-detected-overlay",children:[r.jsx("svg",{className:"nut-scan-detected-tick",viewBox:"0 0 24 24",fill:"none",stroke:"#4caf50",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M20 6L9 17l-5-5"})}),r.jsx("p",{className:"nut-scan-detected-label",children:"Barcode found!"}),r.jsx("p",{className:"nut-scan-detected-code",children:ee})]})]}),!Pe&&r.jsxs("button",{className:"nut-scan-start-btn",onClick:Ct,children:[r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M3 7V5a2 2 0 0 1 2-2h2"}),r.jsx("path",{d:"M17 3h2a2 2 0 0 1 2 2v2"}),r.jsx("path",{d:"M21 17v2a2 2 0 0 1-2 2h-2"}),r.jsx("path",{d:"M7 21H5a2 2 0 0 1-2-2v-2"}),r.jsx("line",{x1:"7",y1:"12",x2:"17",y2:"12"})]}),"Open Camera"]}),Pe&&!ee&&r.jsx("p",{className:"nut-scan-hint",children:"Align barcode within the frame"}),r.jsx("div",{className:"nut-barcode-divider",children:r.jsx("span",{children:"or enter barcode manually"})}),r.jsxs("div",{className:"nut-barcode-manual",children:[r.jsx("input",{type:"text",inputMode:"numeric",value:se,onChange:k=>Le(k.target.value),onKeyDown:k=>k.key==="Enter"&&se.trim()&&Ee(se.trim()),placeholder:"Enter barcode number"}),r.jsx("button",{onClick:()=>se.trim()&&Ee(se.trim()),disabled:!se.trim()||Oe,children:Oe?"...":"Look Up"})]})]}),W==="scan"&&oe&&(()=>{const k=oe.servingUnit||"g",N=oe.portion,P=Ze==="portion"&&N?bt*N.weight:parseFloat(Ht)||0,B=P/100,ue=k==="ml"?[100,200,250,500]:[50,100,150,200],Be=Ze==="portion"&&N?`${bt} ${N.label}${bt!==1?"s":""} (${Math.round(P)}${k})`:`${Math.round(P)}${k}`;return r.jsxs("div",{className:"nut-product-result",children:[oe.image&&r.jsx("img",{src:oe.image,alt:oe.name||"Product",className:"nut-product-img",loading:"lazy"}),r.jsxs("div",{className:"nut-product-name-row",children:[r.jsx("h4",{children:oe.name}),r.jsx("button",{className:`nut-fav-star confirm${ce(oe.name)?" active":""}`,onClick:()=>ze({name:oe.name,protein:oe.protein,carbs:oe.carbs,fats:oe.fats,calories:oe.calories,serving:oe.servingSize,per100g:{protein:oe.protein,carbs:oe.carbs,fats:oe.fats,calories:oe.calories},servingUnit:oe.servingUnit||"g",portion:oe.portion||null}),children:r.jsx("svg",{viewBox:"0 0 24 24",width:"22",height:"22",fill:ce(oe.name)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})})]}),oe.brand&&r.jsx("p",{className:"nut-product-brand",children:oe.brand}),r.jsxs("p",{className:"nut-product-per",children:["Per 100",k,":"]}),r.jsxs("div",{className:"nut-product-macros",children:[r.jsxs("span",{className:"nut-macro-p",children:[oe.protein,"g P"]}),r.jsxs("span",{className:"nut-macro-c",children:[oe.carbs,"g C"]}),r.jsxs("span",{className:"nut-macro-f",children:[oe.fats,"g F"]}),r.jsxs("span",{className:"nut-macro-cal",children:[oe.calories," cal"]})]}),N&&r.jsxs("div",{className:"nut-mode-toggle",children:[r.jsx("button",{className:Ze==="portion"?"active":"",onClick:()=>{Et("portion"),bt<1&&Ge(1)},children:"Portions"}),r.jsxs("button",{className:Ze==="weight"?"active":"",onClick:()=>{Et("weight"),Dt(String(Math.round(P)||100))},children:["Custom (",k,")"]})]}),Ze==="portion"&&N?r.jsxs("div",{className:"nut-portion-stepper",children:[r.jsx("button",{className:"nut-stepper-btn",onClick:()=>Ge(Math.max(1,bt-1)),children:"-"}),r.jsxs("div",{className:"nut-stepper-display",children:[r.jsx("span",{className:"nut-stepper-count",children:bt}),r.jsxs("span",{className:"nut-stepper-label",children:[N.label,bt!==1?"s":""]}),r.jsxs("span",{className:"nut-stepper-weight",children:[Math.round(P),k]})]}),r.jsx("button",{className:"nut-stepper-btn",onClick:()=>Ge(bt+1),children:"+"})]}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"nut-serving-adjust",children:[r.jsxs("label",{children:["Serving (",k,")"]}),r.jsx("input",{type:"number",inputMode:"numeric",value:Ht,onChange:Fe=>Dt(Fe.target.value),onFocus:Fe=>Fe.target.select(),min:"0"})]}),r.jsx("div",{className:"nut-quick-amounts",children:ue.map(Fe=>r.jsxs("button",{className:`nut-quick-btn${Ht===String(Fe)?" active":""}`,onClick:()=>Dt(String(Fe)),children:[Fe,k]},Fe))})]}),r.jsx("div",{className:"nut-product-total",children:r.jsxs("span",{children:["Total: ",Math.round(oe.protein*B),"p / ",Math.round(oe.carbs*B),"c / ",Math.round(oe.fats*B),"f / ",Math.round(oe.calories*B)," cal"]})}),r.jsxs("div",{className:"nut-product-actions",children:[r.jsx("button",{className:"nut-btn-secondary",onClick:()=>{ss(null),he("scan")},children:"Scan Again"}),r.jsx("button",{className:"nut-btn-primary",onClick:()=>dt({name:oe.name,protein:Math.round(oe.protein*B),carbs:Math.round(oe.carbs*B),fats:Math.round(oe.fats*B),calories:Math.round(oe.calories*B),serving:Be}),children:"Add"})]})]})})(),W==="search"&&!oe&&r.jsxs("div",{className:"nut-search-area",children:[r.jsxs("div",{className:"nut-search-bar",children:[r.jsx("input",{type:"text",ref:Xs,value:Ue,onChange:k=>pt(k.target.value),onKeyDown:k=>{k.key==="Enter"&&(clearTimeout(es.current),ke())},onFocus:()=>setTimeout(()=>Xs.current?.scrollIntoView({behavior:"smooth",block:"center"}),350),placeholder:"Search food or product...",autoFocus:!0}),r.jsx("button",{onClick:ke,disabled:Gt,children:Gt?"...":"Search"})]}),r.jsxs("div",{className:"nut-search-results",children:[Tt.map((k,N)=>r.jsxs("button",{className:"nut-search-item",onClick:()=>{ss(k),k.portion?(Ge(1),Dt(String(k.portion.weight)),Et("portion")):(Ge(0),Dt(String(k.servingValue||100)),Et("weight"))},children:[k.image&&r.jsx("img",{src:k.image,alt:k.name||"Product",loading:"lazy"}),r.jsxs("div",{className:"nut-search-item-info",children:[r.jsx("span",{className:"nut-search-item-name",children:k.name}),k.brand&&r.jsx("span",{className:"nut-search-item-brand",children:k.brand}),r.jsxs("span",{className:"nut-search-item-macros",children:[k.calories," cal  ",k.protein,"p  ",k.carbs,"c  ",k.fats,"f per 100",k.servingUnit||"g"]})]})]},N)),Tt.length===0&&Ue&&!Gt&&r.jsx("p",{className:"nut-search-empty",children:"No results found. Try a different search or use manual entry."})]})]}),W==="search"&&oe&&(()=>{const k=oe.servingUnit||"g",N=oe.portion,P=Ze==="portion"&&N?bt*N.weight:parseFloat(Ht)||0,B=P/100,ue=k==="ml"?[100,200,250,500]:[50,100,150,200],Be=Ze==="portion"&&N?`${bt} ${N.label}${bt!==1?"s":""} (${Math.round(P)}${k})`:`${Math.round(P)}${k}`;return r.jsxs("div",{className:"nut-product-result",children:[oe.image&&r.jsx("img",{src:oe.image,alt:oe.name||"Product",className:"nut-product-img",loading:"lazy"}),r.jsxs("div",{className:"nut-product-name-row",children:[r.jsx("h4",{children:oe.name}),r.jsx("button",{className:`nut-fav-star confirm${ce(oe.name)?" active":""}`,onClick:()=>ze({name:oe.name,protein:oe.protein,carbs:oe.carbs,fats:oe.fats,calories:oe.calories,serving:oe.servingSize,per100g:{protein:oe.protein,carbs:oe.carbs,fats:oe.fats,calories:oe.calories},servingUnit:oe.servingUnit||"g",portion:oe.portion||null}),children:r.jsx("svg",{viewBox:"0 0 24 24",width:"22",height:"22",fill:ce(oe.name)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})})]}),oe.brand&&r.jsx("p",{className:"nut-product-brand",children:oe.brand}),r.jsxs("p",{className:"nut-product-per",children:["Per 100",k,":"]}),r.jsxs("div",{className:"nut-product-macros",children:[r.jsxs("span",{className:"nut-macro-p",children:[oe.protein,"g P"]}),r.jsxs("span",{className:"nut-macro-c",children:[oe.carbs,"g C"]}),r.jsxs("span",{className:"nut-macro-f",children:[oe.fats,"g F"]}),r.jsxs("span",{className:"nut-macro-cal",children:[oe.calories," cal"]})]}),N&&r.jsxs("div",{className:"nut-mode-toggle",children:[r.jsx("button",{className:Ze==="portion"?"active":"",onClick:()=>{Et("portion"),bt<1&&Ge(1)},children:"Portions"}),r.jsxs("button",{className:Ze==="weight"?"active":"",onClick:()=>{Et("weight"),Dt(String(Math.round(P)||100))},children:["Custom (",k,")"]})]}),Ze==="portion"&&N?r.jsxs("div",{className:"nut-portion-stepper",children:[r.jsx("button",{className:"nut-stepper-btn",onClick:()=>Ge(Math.max(1,bt-1)),children:"-"}),r.jsxs("div",{className:"nut-stepper-display",children:[r.jsx("span",{className:"nut-stepper-count",children:bt}),r.jsxs("span",{className:"nut-stepper-label",children:[N.label,bt!==1?"s":""]}),r.jsxs("span",{className:"nut-stepper-weight",children:[Math.round(P),k]})]}),r.jsx("button",{className:"nut-stepper-btn",onClick:()=>Ge(bt+1),children:"+"})]}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"nut-serving-adjust",children:[r.jsxs("label",{children:["Serving (",k,")"]}),r.jsx("input",{type:"number",inputMode:"numeric",value:Ht,onChange:Fe=>Dt(Fe.target.value),onFocus:Fe=>Fe.target.select(),min:"0"})]}),r.jsx("div",{className:"nut-quick-amounts",children:ue.map(Fe=>r.jsxs("button",{className:`nut-quick-btn${Ht===String(Fe)?" active":""}`,onClick:()=>Dt(String(Fe)),children:[Fe,k]},Fe))})]}),r.jsx("div",{className:"nut-product-total",children:r.jsxs("span",{children:["Total: ",Math.round(oe.protein*B),"p / ",Math.round(oe.carbs*B),"c / ",Math.round(oe.fats*B),"f / ",Math.round(oe.calories*B)," cal"]})}),r.jsxs("div",{className:"nut-product-actions",children:[r.jsx("button",{className:"nut-btn-secondary",onClick:()=>ss(null),children:"Back to Search"}),r.jsx("button",{className:"nut-btn-primary",onClick:()=>dt({name:oe.name,protein:Math.round(oe.protein*B),carbs:Math.round(oe.carbs*B),fats:Math.round(oe.fats*B),calories:Math.round(oe.calories*B),serving:Be}),children:"Add"})]})]})})(),W==="manual"&&r.jsxs("div",{className:"nut-manual-form",children:[r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Food Name"}),r.jsx("input",{type:"text",value:yt.name,onChange:k=>ut(N=>({...N,name:k.target.value})),placeholder:"e.g. Chicken Breast",autoFocus:!0})]}),r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Serving Size (optional)"}),r.jsx("input",{type:"text",value:yt.serving,onChange:k=>ut(N=>({...N,serving:k.target.value})),placeholder:"e.g. 150g, 1 cup"})]}),r.jsxs("div",{className:"nut-manual-macros",children:[r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Protein (g)"}),r.jsx("input",{type:"number",value:yt.protein,onChange:k=>ut(N=>({...N,protein:k.target.value})),min:"0"})]}),r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Carbs (g)"}),r.jsx("input",{type:"number",value:yt.carbs,onChange:k=>ut(N=>({...N,carbs:k.target.value})),min:"0"})]}),r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Fats (g)"}),r.jsx("input",{type:"number",value:yt.fats,onChange:k=>ut(N=>({...N,fats:k.target.value})),min:"0"})]}),r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Calories"}),r.jsx("input",{type:"number",value:yt.calories,onChange:k=>ut(N=>({...N,calories:k.target.value})),min:"0"})]})]}),r.jsx("button",{className:"nut-btn-primary",disabled:!yt.name.trim(),onClick:()=>dt({name:yt.name,protein:parseFloat(yt.protein)||0,carbs:parseFloat(yt.carbs)||0,fats:parseFloat(yt.fats)||0,calories:parseFloat(yt.calories)||0,serving:yt.serving||""}),children:"Add Food"})]}),W==="favourites"&&!oe&&(()=>{const k=Q(),N=P=>{if(P.per100g){const B=P.per100g;ss({name:P.name,brand:"",image:null,servingSize:P.serving||"100g",servingValue:100,servingUnit:P.servingUnit||"g",portion:P.portion||null,protein:B.protein,carbs:B.carbs,fats:B.fats,calories:B.calories,per100g:!0}),P.portion?(Ge(1),Dt(String(P.portion.weight)),Et("portion")):(Ge(0),Dt("100"),Et("weight"))}else dt({name:P.name,protein:P.protein,carbs:P.carbs,fats:P.fats,calories:P.calories,serving:P.serving||""})};return r.jsx("div",{className:"nut-recent-area",children:k.length===0?r.jsx("p",{className:"nut-search-empty",children:"No favourites yet. Tap the star on any food to save it here."}):r.jsx("div",{className:"nut-recent-list",children:k.map((P,B)=>r.jsxs("div",{className:"nut-recent-item-row",children:[r.jsx("button",{className:"nut-fav-star active",onClick:ue=>{ue.stopPropagation(),ze(P)},children:r.jsx("svg",{viewBox:"0 0 24 24",width:"18",height:"18",fill:"currentColor",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),r.jsxs("button",{className:"nut-recent-item",onClick:()=>N(P),children:[r.jsxs("div",{className:"nut-recent-item-info",children:[r.jsx("span",{className:"nut-recent-item-name",children:P.name}),r.jsx("span",{className:"nut-recent-item-serving",children:P.serving||""})]}),r.jsxs("span",{className:"nut-recent-item-macros",children:[P.calories," cal"]})]})]},B))})})})(),W==="favourites"&&oe&&(()=>{const k=oe.servingUnit||"g",N=oe.portion,P=Ze==="portion"&&N?bt*N.weight:parseFloat(Ht)||0,B=P/100,ue=k==="ml"?[100,200,250,500]:[50,100,150,200],Be=Ze==="portion"&&N?`${bt} ${N.label}${bt!==1?"s":""} (${Math.round(P)}${k})`:`${Math.round(P)}${k}`;return r.jsxs("div",{className:"nut-product-result",children:[r.jsxs("div",{className:"nut-product-name-row",children:[r.jsx("h4",{children:oe.name}),r.jsx("button",{className:`nut-fav-star confirm${ce(oe.name)?" active":""}`,onClick:()=>ze({name:oe.name,protein:oe.protein,carbs:oe.carbs,fats:oe.fats,calories:oe.calories,serving:oe.servingSize,per100g:{protein:oe.protein,carbs:oe.carbs,fats:oe.fats,calories:oe.calories},servingUnit:oe.servingUnit||"g",portion:oe.portion||null}),children:r.jsx("svg",{viewBox:"0 0 24 24",width:"22",height:"22",fill:ce(oe.name)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})})]}),r.jsxs("p",{className:"nut-product-per",children:["Per 100",k,":"]}),r.jsxs("div",{className:"nut-product-macros",children:[r.jsxs("span",{className:"nut-macro-p",children:[oe.protein,"g P"]}),r.jsxs("span",{className:"nut-macro-c",children:[oe.carbs,"g C"]}),r.jsxs("span",{className:"nut-macro-f",children:[oe.fats,"g F"]}),r.jsxs("span",{className:"nut-macro-cal",children:[oe.calories," cal"]})]}),N&&r.jsxs("div",{className:"nut-mode-toggle",children:[r.jsx("button",{className:Ze==="portion"?"active":"",onClick:()=>{Et("portion"),bt<1&&Ge(1)},children:"Portions"}),r.jsxs("button",{className:Ze==="weight"?"active":"",onClick:()=>{Et("weight"),Dt(String(Math.round(P)||100))},children:["Custom (",k,")"]})]}),Ze==="portion"&&N?r.jsxs("div",{className:"nut-portion-stepper",children:[r.jsx("button",{className:"nut-stepper-btn",onClick:()=>Ge(Math.max(1,bt-1)),children:"-"}),r.jsxs("div",{className:"nut-stepper-display",children:[r.jsx("span",{className:"nut-stepper-count",children:bt}),r.jsxs("span",{className:"nut-stepper-label",children:[N.label,bt!==1?"s":""]}),r.jsxs("span",{className:"nut-stepper-weight",children:[Math.round(P),k]})]}),r.jsx("button",{className:"nut-stepper-btn",onClick:()=>Ge(bt+1),children:"+"})]}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"nut-serving-adjust",children:[r.jsxs("label",{children:["Serving (",k,")"]}),r.jsx("input",{type:"number",inputMode:"numeric",value:Ht,onChange:Fe=>Dt(Fe.target.value),onFocus:Fe=>Fe.target.select(),min:"0"})]}),r.jsx("div",{className:"nut-quick-amounts",children:ue.map(Fe=>r.jsxs("button",{className:`nut-quick-btn${Ht===String(Fe)?" active":""}`,onClick:()=>Dt(String(Fe)),children:[Fe,k]},Fe))})]}),r.jsx("div",{className:"nut-product-total",children:r.jsxs("span",{children:["Total: ",Math.round(oe.protein*B),"p / ",Math.round(oe.carbs*B),"c / ",Math.round(oe.fats*B),"f / ",Math.round(oe.calories*B)," cal"]})}),r.jsxs("div",{className:"nut-product-actions",children:[r.jsx("button",{className:"nut-btn-secondary",onClick:()=>ss(null),children:"Back to Favourites"}),r.jsx("button",{className:"nut-btn-primary",onClick:()=>dt({name:oe.name,protein:Math.round(oe.protein*B),carbs:Math.round(oe.carbs*B),fats:Math.round(oe.fats*B),calories:Math.round(oe.calories*B),serving:Be}),children:"Add"})]})]})})()]})}),r.jsx(la,{active:"nutrition"}),Kt&&r.jsx("div",{className:`toast-notification ${Kt.type}`,children:Kt.message})]})})}const ED=700,Mg=42,Dl=2*Math.PI*Mg,T2=["Another one in the bank!","Consistency beats everything.","You showed up  that's what counts.","Stronger every session."];function Ig({title:n,subtitle:e,stats:t,onDone:i,buttonLabel:l="Done"}){const[u,d]=v.useState("hold"),[p,g]=v.useState(!1),[y,w]=v.useState(!1),j=v.useRef(null),T=v.useRef(null),V=v.useRef(null),$=v.useRef(!1),F=v.useRef(!1),U=v.useRef(T2[Math.floor(Math.random()*T2.length)]),te=v.useRef([...Array(80)].map((ve,ge)=>({x:5+Math.random()*90,delay:Math.random()*3.5,color:["#A12F3A","#4caf50","#ff9800","#2196f3","#e91e63","#ffeb3b","#FFD700","#ffffff","#9c27b0"][ge%9],drift:(Math.random()-.5)*120,spin:Math.random()*720-360,duration:1.8+Math.random()*2,width:4+Math.random()*6,height:4+Math.random()*8,shape:ge%3}))),K=v.useCallback(()=>{if($.current)return;$.current=!0,F.current=!1,g(!0),V.current=performance.now(),j.current&&(j.current.style.strokeDashoffset=Dl);const ve=ge=>{const R=ge-V.current,E=Math.min(R/ED,1);j.current&&(j.current.style.strokeDashoffset=Dl-E*Dl),E<1?T.current=requestAnimationFrame(ve):($.current=!1,F.current=!0,T.current=null,g(!1),navigator.vibrate&&navigator.vibrate(50),d("celebrate"))};T.current=requestAnimationFrame(ve)},[]),re=v.useCallback(()=>{$.current&&($.current=!1,T.current&&(cancelAnimationFrame(T.current),T.current=null),j.current&&(j.current.style.strokeDashoffset=Dl),g(!1))},[]),ye=v.useCallback(()=>{w(!0),setTimeout(()=>{i?.()},300)},[i]);return u==="hold"?r.jsxs("div",{className:"wc-hold-page",children:[r.jsx("div",{className:"wc-hold-glow","aria-hidden":"true"}),r.jsx("h2",{className:"wc-hold-title",children:"You Crushed It!"}),e&&r.jsx("p",{className:"wc-hold-subtitle",children:e}),t&&t.length>0&&r.jsx("div",{className:"wc-hold-stats",children:t.map((ve,ge)=>r.jsxs("div",{className:"wc-hold-stat",children:[r.jsx("span",{className:"wc-hold-stat-val",children:ve.value}),r.jsx("span",{className:"wc-hold-stat-label",children:ve.label})]},ge))}),r.jsx("p",{className:"wc-hold-hint",children:"Hold to finish"}),r.jsxs("div",{className:`wc-hold-ring-touch ${p?"wc-holding":""}`,onPointerDown:ve=>{ve.preventDefault(),K()},onPointerUp:re,onPointerLeave:re,onPointerCancel:re,onClick:ve=>{ve.stopPropagation(),F.current&&(F.current=!1)},role:"button",tabIndex:0,"aria-label":"Press and hold to finish workout",onKeyDown:ve=>{(ve.key==="Enter"||ve.key===" ")&&(ve.preventDefault(),d("celebrate"))},children:[r.jsx("div",{className:"wc-hold-ring-glow","aria-hidden":"true"}),r.jsxs("svg",{className:"wc-hold-ring-svg",viewBox:"0 0 100 100",children:[r.jsx("circle",{className:"wc-hold-ring-track",cx:"50",cy:"50",r:Mg}),r.jsx("circle",{className:"wc-hold-ring-fill",ref:j,cx:"50",cy:"50",r:Mg,style:{strokeDasharray:Dl,strokeDashoffset:Dl}})]}),r.jsx("div",{className:"wc-hold-icon",children:r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M6 9H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h2"}),r.jsx("path",{d:"M18 9h2a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2h-2"}),r.jsx("path",{d:"M6 3h12v7a6 6 0 0 1-12 0V3z"}),r.jsx("path",{d:"M9 21h6"}),r.jsx("path",{d:"M12 16v5"})]})})]})]}):r.jsxs("div",{className:`wc-celeb-overlay ${y?"wc-celeb-dismissing":""}`,children:[r.jsx("div",{className:"wc-celeb-confetti","aria-hidden":"true",children:te.current.map((ve,ge)=>r.jsx("span",{className:`wc-celeb-confetti-piece wc-confetti-shape-${ve.shape}`,style:{"--x":`${ve.x}%`,"--delay":`${ve.delay}s`,"--color":ve.color,"--drift":`${ve.drift}px`,"--spin":`${ve.spin}deg`,"--duration":`${ve.duration}s`,width:`${ve.width}px`,height:`${ve.height}px`}},ge))}),r.jsxs("div",{className:"wc-celeb-content",children:[r.jsx("div",{className:"wc-celeb-logo-frame",children:r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"wc-celeb-logo-img"})}),r.jsx("h2",{className:"wc-celeb-heading",children:n||"Congratulations!"}),e&&r.jsx("p",{className:"wc-celeb-subtext",children:e}),r.jsx("p",{className:"wc-celeb-quote",children:U.current}),t&&t.length>0&&r.jsx("div",{className:"wc-celeb-stats-row",children:t.map((ve,ge)=>r.jsxs("div",{className:"wc-celeb-stat",children:[r.jsx("span",{className:"wc-celeb-stat-val",children:ve.value}),r.jsx("span",{className:"wc-celeb-stat-label",children:ve.label})]},ge))}),r.jsx("button",{className:"wc-celeb-btn",onClick:ye,children:l})]})]})}const E2="/login/assets/randomiser-glq9YJkL.jpg",SD="/login/assets/programme-card-workout-CnNzTYkz.webp",ND="/login/assets/prog-fullbody-4wk-r6m9HJys.jpg",CD="/login/assets/mg-arms-BeOQU3wx.jpg",RD=60,$p=5,AD=[{threshold:1e3,label:"1 Tonne"},{threshold:5e3,label:"5 Tonne"},{threshold:1e4,label:"10 Tonne"},{threshold:25e3,label:"25 Tonne"},{threshold:5e4,label:"50 Tonne"},{threshold:1e5,label:"100 Tonne"},{threshold:25e4,label:"250 Tonne"},{threshold:5e5,label:"500 Tonne"},{threshold:1e6,label:"1 Million kg"}],MD={"Dumbbell Floor Press":"push","Seated Dumbbell Shoulder Press":"push","Seated Dumbbell Arnold Press":"push","Dumbbell Overhead Tricep Extension":"push",Skullcrushers:"push","Dumbbell Lateral Raise":"push","Dumbbell Front Raise":"push","Dumbbell Squeeze Press":"push","Incline Dumbbell Press":"push","Dumbbell Fly":"push","Dumbbell Pullover":"push","Tricep Kickback":"push","Dumbbell Shrug":"push","Dumbbell Y-Raise":"push","Dumbbell Bent Over Row":"pull","Single Arm Bent Over Row":"pull","Bicep Curl":"pull","Hammer Curl":"pull","Dumbbell Bent Over Rear Delt Fly":"pull","Renegade Row":"pull","Wide Dumbbell Bent Over Row":"pull","Reverse Fly":"pull","Concentration Curl":"pull","Wide Grip Bicep Curl":"pull","Wrist Curl":"pull","Dumbbell Goblet Squats":"lower","Romanian Deadlifts":"lower","Forward Dumbbell Lunges":"lower","Dumbbell Sumo Squats":"lower","Weighted Calf Raises":"lower","1 Legged RDL":"lower","Dumbbell Box Step Ups":"lower","Dumbbell Squat Pulses":"lower","Dumbbell Reverse Lunges":"lower","Kettlebell Romanian Deadlift":"lower","Russian Twists Dumbbell":"core","Kettlebell Russian Twist":"core","Kettlebell Side Bends":"core","Kneeling Kettlebell Halo":"core","Kettlebell Bird Dog Drag":"core"},ID={fullbody_4wk:{duration:4,daysPerWeek:3},fullbody_8wk:{duration:8,daysPerWeek:3},fullbody_12wk:{duration:12,daysPerWeek:3},core_4wk:{duration:4,daysPerWeek:3},core_8wk:{duration:8,daysPerWeek:3},core_12wk:{duration:12,daysPerWeek:3},upper_4wk:{duration:4,daysPerWeek:3},lower_4wk:{duration:4,daysPerWeek:3}},DD={fullbody:"linear-gradient(160deg, rgba(153,49,60,0.15) 0%, rgba(153,49,60,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)",core:"linear-gradient(160deg, rgba(30,80,120,0.2) 0%, rgba(30,80,120,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)",upper:"linear-gradient(160deg, rgba(100,60,140,0.2) 0%, rgba(100,60,140,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)",lower:"linear-gradient(160deg, rgba(40,120,80,0.2) 0%, rgba(40,120,80,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)"},Wp={arms:"linear-gradient(160deg, rgba(180,60,60,0.2) 0%, rgba(180,60,60,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",chest:"linear-gradient(160deg, rgba(50,100,160,0.2) 0%, rgba(50,100,160,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",back:"linear-gradient(160deg, rgba(80,130,60,0.2) 0%, rgba(80,130,60,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",shoulders:"linear-gradient(160deg, rgba(160,100,40,0.2) 0%, rgba(160,100,40,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",legs:"linear-gradient(160deg, rgba(100,50,140,0.2) 0%, rgba(100,50,140,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",core:"linear-gradient(160deg, rgba(30,80,120,0.2) 0%, rgba(30,80,120,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)"},Gp=[{id:"fullbody_4wk",name:"4-Week Full Body",focus:"fullbody",duration:4,level:"All Levels",daysPerWeek:3,image:ND},{id:"fullbody_8wk",name:"8-Week Full Body",focus:"fullbody",duration:8,level:"Intermediate",daysPerWeek:3},{id:"fullbody_12wk",name:"12-Week Full Body",focus:"fullbody",duration:12,level:"Advanced",daysPerWeek:3},{id:"core_4wk",name:"4-Week Core",focus:"core",duration:4,level:"Beginner",daysPerWeek:3},{id:"core_8wk",name:"8-Week Core",focus:"core",duration:8,level:"Intermediate",daysPerWeek:3},{id:"core_12wk",name:"12-Week Core",focus:"core",duration:12,level:"Advanced",daysPerWeek:3},{id:"upper_4wk",name:"4-Week Upper Body",focus:"upper",duration:4,level:"Intermediate",daysPerWeek:3},{id:"lower_4wk",name:"4-Week Lower Body",focus:"lower",duration:4,level:"Intermediate",daysPerWeek:3}],Zc=[{key:"arms",label:"Arms",icon:"M7 5h2v14H7V5zm8 0h2v14h-2V5zm-5 4h4v6h-4V9z",image:CD},{key:"chest",label:"Chest",icon:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 15H9v-2h2v2zm4 0h-2v-2h2v2zm3-6c0 1.1-.36 2.12-.97 2.95l-.87-.87C16.7 12.53 17 11.8 17 11c0-2.76-2.24-5-5-5S7 8.24 7 11c0 .8.3 1.53.84 2.08l-.87.87A4.977 4.977 0 0 1 6 11c0-3.31 2.69-6 6-6s6 2.69 6 6z"},{key:"back",label:"Back",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm4 18H8v-6l-4-4 1.41-1.41L8 11.17V8h8v3.17l2.59-2.58L20 10l-4 4v6z"},{key:"shoulders",label:"Shoulders",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm8 10l-3-1.5c-.5-.25-1-.5-1.5-.5h-7c-.5 0-1 .25-1.5.5L4 12l-2 6h4l1.5 4h9L18 18h4l-2-6z"},{key:"legs",label:"Legs",icon:"M16.5 3A2.5 2.5 0 0 0 14 5.5 2.5 2.5 0 0 0 16.5 8 2.5 2.5 0 0 0 19 5.5 2.5 2.5 0 0 0 16.5 3zM14 9l-3 7h2l1 6h2l1-6h2l-3-7h-2z"},{key:"core",label:"Core",icon:"M12 2a4 4 0 0 1 4 4v1h-2V6a2 2 0 1 0-4 0v1H8V6a4 4 0 0 1 4-4zM8 9h8v2H8V9zm-1 4h10l-1 9H8l-1-9z"}],S2={chest:[{id:"chest_strength",name:"Chest Strength",desc:"Heavy pressing for max strength",level:"Intermediate",overview:"A heavy pressing session designed to build raw chest strength. Focus on controlled negatives and powerful pressing movements.",tips:["Go heavy  pick a weight where the last 2 reps are a real challenge","Control the negative (lowering phase) for 2-3 seconds","Keep your shoulder blades squeezed together throughout all pressing movements","Rest 90-120 seconds between sets to allow full recovery"],exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:4,reps:8,storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Dumbbell Squeeze Press",type:"weighted",sets:3,reps:10,storagePath:null},{name:"Incline Dumbbell Press",type:"weighted",sets:3,reps:10,storagePath:null},{name:"Dumbbell Pullover",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Dumbbell Fly",type:"weighted",sets:3,reps:12,storagePath:null}]},{id:"chest_hypertrophy",name:"Chest Hypertrophy",desc:"Volume training for muscle growth",level:"Intermediate",overview:"A high-volume chest session focused on time under tension and muscle growth. Lighter weights, more reps, and slow controlled movements.",tips:["Use moderate weight  you should feel the burn by rep 10","Squeeze your chest at the top of every rep for 1 second","Keep rest periods short at 60-90 seconds to keep the pump going","On press ups, go to failure on the final set"],exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Wide Press Up",type:"reps",sets:3,reps:15,storagePath:null},{name:"Dumbbell Fly",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Incline Dumbbell Press",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Press Up",type:"reps",sets:3,reps:20,storagePath:"exercises/bodyweight/upper/press up.mp4"}]},{id:"chest_endurance",name:"Chest Endurance",desc:"Bodyweight pushing to failure",level:"All Levels",overview:"No weights needed. This bodyweight-only session builds chest endurance and muscular stamina through high-rep push up variations.",tips:["Focus on full range of motion  chest to floor on every rep","Keep your core tight and body in a straight line throughout","Scale down to knee press ups if you can't maintain form","Push through the burn  the last 5 reps are where the growth happens"],exercises:[{name:"Press Up",type:"reps",sets:4,reps:20,storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Wide Press Up",type:"reps",sets:3,reps:15,storagePath:null},{name:"Diamond Press Up",type:"reps",sets:3,reps:12,storagePath:null},{name:"Decline Press Up",type:"reps",sets:3,reps:15,storagePath:null},{name:"Press Up Hold",type:"timed",sets:3,time:30,storagePath:null}]}],back:[{id:"back_strength",name:"Back Strength",desc:"Heavy rows for a thick back",level:"Intermediate",overview:"Build a thick, powerful back with heavy rowing movements. This session targets your lats, rhomboids, and traps for overall back development.",tips:["Go heavy on rows  use a weight that challenges you by rep 6-8","Drive your elbows back and squeeze your shoulder blades together at the top","Keep a slight bend in your knees and hinge at the hips for bent over movements","Rest 90-120 seconds between sets for full recovery"],exercises:[{name:"Dumbbell Bent Over Row",type:"weighted",sets:4,reps:8,storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Single Arm Bent Over Row",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Dumbbell Pullover",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Dumbbell Shrug",type:"weighted",sets:3,reps:15,storagePath:null}]},{id:"back_hypertrophy",name:"Back Hypertrophy",desc:"Width and thickness volume work",level:"Intermediate",overview:"A volume-focused back session combining rows and isolation moves to build width and thickness. Focus on the mind-muscle connection.",tips:["Use moderate weight  feel the stretch and squeeze on every rep","On renegade rows, keep your hips square to the floor and avoid rotating","For reverse flys, use lighter weight and focus on squeezing your rear delts","Keep rest to 60-90 seconds to maintain intensity"],exercises:[{name:"Renegade Row",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/upper/renegade row.mp4"},{name:"Wide Dumbbell Bent Over Row",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Single Arm Bent Over Row",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Reverse Fly",type:"weighted",sets:3,reps:15,storagePath:null},{name:"Prone Y-T-W Raises",type:"reps",sets:3,reps:10,storagePath:null}]},{id:"back_endurance",name:"Back Endurance",desc:"Bodyweight back conditioning",level:"All Levels",overview:"A bodyweight session to strengthen your posterior chain and improve posture. Great for back health, mobility, and muscular endurance.",tips:["On superman holds, lift your arms and legs simultaneously and hold tight","Focus on slow, controlled movements  quality over speed","Breathe steadily throughout timed holds  don't hold your breath","Engage your glutes and lower back together on every movement"],exercises:[{name:"Superman Hold",type:"timed",sets:4,time:30,storagePath:"exercises/bodyweight/upper/Superman Hold.mp4"},{name:"Prone Y-T-W Raises",type:"reps",sets:3,reps:12,storagePath:null},{name:"Reverse Snow Angel",type:"reps",sets:3,reps:12,storagePath:null},{name:"Bird Dog",type:"reps",sets:3,reps:12,storagePath:"exercises/bodyweight/core/Bird Dog.mp4"},{name:"Back Extension Hold",type:"timed",sets:3,time:30,storagePath:null}]}],shoulders:[{id:"shoulders_strength",name:"Shoulder Strength",desc:"Heavy pressing for boulder shoulders",level:"Intermediate",overview:"A heavy overhead pressing session to build strong, powerful shoulders. Compound movements first, followed by isolation work for all three delt heads.",tips:["Go heavy on presses  pick a weight where you struggle on the last 2 reps","Brace your core and avoid arching your back during overhead movements","Press straight up and control the weight down slowly","Rest 90-120 seconds between pressing sets, 60 seconds for isolation moves"],exercises:[{name:"Seated Dumbbell Shoulder Press",type:"weighted",sets:4,reps:8,storagePath:"exercises/dumbbells/upper/seated dumbbell shoulder press.mp4"},{name:"Seated Dumbbell Arnold Press",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/upper/seated dumbbell arnold press.mp4"},{name:"Dumbbell Front Raise",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell front raise.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Dumbbell Shrug",type:"weighted",sets:3,reps:15,storagePath:null}]},{id:"shoulders_hypertrophy",name:"Shoulder Hypertrophy",desc:"Volume and isolation for 3D delts",level:"Intermediate",overview:"A high-volume session targeting all three heads of the deltoid for that 3D capped shoulder look. Moderate weight, high reps, constant tension.",tips:["Use lighter weight than you think  shoulders respond best to high reps","On lateral raises, lead with your elbows and don't swing the weight","Pause at the top of each raise for a 1-second squeeze","Keep rest periods at 60 seconds to maximise the pump"],exercises:[{name:"Seated Dumbbell Arnold Press",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/seated dumbbell arnold press.mp4"},{name:"Dumbbell Lateral Raise",type:"weighted",sets:4,reps:15,storagePath:"exercises/dumbbells/upper/dumbbell lateral raise.mp4"},{name:"Dumbbell Front Raise",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell front raise.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,reps:15,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Dumbbell Y-Raise",type:"weighted",sets:3,reps:12,storagePath:null}]},{id:"shoulders_endurance",name:"Shoulder Endurance",desc:"Bodyweight and high-rep work",level:"All Levels",overview:"A shoulder endurance session combining bodyweight movements with high-rep dumbbell work. Builds stamina, stability, and shoulder resilience.",tips:["On pike push ups, walk your feet close to your hands to increase the angle","For high-rep lateral raises, use a very light weight and focus on form","Wall walks are advanced  scale to pike push ups if needed","Keep your core braced throughout to protect your lower back"],exercises:[{name:"Pike Push Ups",type:"reps",sets:4,reps:12,storagePath:"exercises/bodyweight/upper/pike push ups.mp4"},{name:"Dumbbell Lateral Raise",type:"weighted",sets:3,reps:20,storagePath:"exercises/dumbbells/upper/dumbbell lateral raise.mp4"},{name:"Wall Walks",type:"reps",sets:3,reps:6,storagePath:null},{name:"Prone Y-T-W Raises",type:"reps",sets:3,reps:10,storagePath:null},{name:"Shoulder Tap Hold",type:"timed",sets:3,time:30,storagePath:null}]}],arms:[{id:"arms_bicep",name:"Bicep Focus",desc:"Curl variations for peak biceps",level:"All Levels",overview:"An arm session dedicated entirely to biceps. Multiple curl variations target different parts of the bicep for maximum peak and thickness.",tips:["Keep your elbows pinned to your sides  no swinging","Control the negative (lowering) for 2-3 seconds on every rep","Start with your heaviest weight and decrease as you fatigue","Squeeze hard at the top of each curl for a full contraction"],exercises:[{name:"Bicep Curl",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Hammer Curl",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/hammer curl.mp4"},{name:"Concentration Curl",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Wide Grip Bicep Curl",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Isometric Bicep Hold",type:"timed",sets:3,time:20,storagePath:null}]},{id:"arms_tricep",name:"Tricep Focus",desc:"Extensions and dips for horseshoe triceps",level:"All Levels",overview:"All-out tricep training with extensions, dips, and pressing movements. The triceps make up two-thirds of your arm  this session builds serious size.",tips:["On overhead extensions, keep your elbows close to your head","For skullcrushers, lower the weight slowly to just above your forehead","On dips, lean slightly forward to reduce shoulder strain","Full lockout at the top of every extension for maximum tricep contraction"],exercises:[{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Skullcrushers",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/skullcrushers.mp4"},{name:"Tricep Dips",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/upper/tricep dips.mp4"},{name:"Tricep Kickback",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Diamond Press Up",type:"reps",sets:3,reps:12,storagePath:null}]},{id:"arms_full",name:"Full Arms",desc:"Superset biceps and triceps",level:"All Levels",overview:"A balanced arm session alternating between biceps and triceps. Superset style keeps the intensity high and maximises the pump.",tips:["Superset each pair  do biceps then immediately hit triceps","Use moderate weight that lets you maintain strict form for all reps","Rest 60 seconds after each superset pair","Focus on the squeeze at the peak contraction of every rep"],exercises:[{name:"Bicep Curl",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Tricep Kickback",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Hammer Curl",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/hammer curl.mp4"},{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Wrist Curl",type:"weighted",sets:3,reps:15,storagePath:null}]}],legs:[{id:"legs_quad",name:"Quad Dominant",desc:"Squats and lunges for quad power",level:"All Levels",overview:"A quad-focused leg session built around squats and lunges. Heavy compound movements to build strong, powerful quads and overall leg strength.",tips:["On goblet squats, hold the dumbbell close to your chest and sit deep","Keep your knees tracking over your toes  don't let them cave inward","Drive through your heels on all squatting movements","Rest 90-120 seconds between heavy sets, 60 seconds on bodyweight moves"],exercises:[{name:"Dumbbell Goblet Squats",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Forward Dumbbell Lunges",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.mp4"},{name:"Dumbbell Squat Pulses",type:"weighted",sets:3,reps:15,storagePath:"exercises/dumbbells/lower/dumbbell squat pulses.mp4"},{name:"Bulgarian Split Squats",type:"reps",sets:3,reps:12,storagePath:"exercises/bodyweight/lower/bulgarian split squats.mp4"},{name:"Squat And Hold",type:"timed",sets:3,time:30,storagePath:"exercises/bodyweight/lower/squat and hold.mp4"}]},{id:"legs_ham_glute",name:"Hamstring & Glute",desc:"Posterior chain focus",level:"Intermediate",overview:"Target the back of your legs with deadlift and hip hinge variations. This session builds a strong posterior chain  hamstrings, glutes, and lower back.",tips:["On RDLs, push your hips back and feel the stretch in your hamstrings","Keep a slight bend in your knees throughout hip hinge movements","Squeeze your glutes hard at the top of every rep","For single leg work, start with your weaker side first"],exercises:[{name:"Romanian Deadlifts",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/lower/romanian deadlifts.mp4"},{name:"1 Legged RDL",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/lower/1 legged rdl.mp4"},{name:"Hip Thrusts",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/lower/hip thrusts.mp4"},{name:"Dumbbell Sumo Squats",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/dumbbell sumo squats.mp4"},{name:"Donkey Kicks",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/lower/donkey kicks.mp4"}]},{id:"legs_power",name:"Power & Plyo",desc:"Explosive leg training",level:"Intermediate",overview:"An explosive leg session combining plyometrics with weighted movements. Build power, speed, and athletic performance.",tips:["On jump squats, land softly with bent knees to absorb the impact","Explode up on every rep  power comes from speed, not just weight","Keep rest periods at 60-90 seconds to maintain intensity","Focus on landing mechanics  knees out, chest up, soft landing"],exercises:[{name:"Jump Squats",type:"reps",sets:4,reps:12,storagePath:"exercises/bodyweight/lower/jump squats.mp4"},{name:"Dumbbell Box Step Ups",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/dumbbell box step ups.mp4"},{name:"Skater Jumps",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/lower/skater jumps.mp4"},{name:"Dumbbell Reverse Lunges",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/dumbbell reverse lunges.mp4"},{name:"Weighted Calf Raises",type:"weighted",sets:4,reps:15,storagePath:"exercises/dumbbells/lower/weighted calf raises.mp4"}]}],core:[{id:"core_lower_abs",name:"Lower Abs Blast",desc:"40s work / 20s rest  3 rounds",level:"Intermediate",overview:"An interval-based core burner targeting the lower abdominals. 40 seconds of work followed by 20 seconds of rest  keep the intensity high and your lower back pressed into the floor throughout.",tips:["Press your lower back firmly into the floor on every rep","Exhale hard as you contract your abs  don't hold your breath","If your lower back lifts off the ground, reduce the range of motion","Focus on slow, controlled movements rather than speed"],interval:!0,rounds:3,work:40,rest:20,exercises:[{name:"Leg Raises",storagePath:"exercises/bodyweight/core/Leg Raises.mp4"},{name:"Reverse Crunch To Leg Raise",storagePath:"exercises/bodyweight/core/Reverse Crunch To Leg Raise.mp4"},{name:"Flutter Kicks",storagePath:"exercises/bodyweight/core/Flutter Kicks.mp4"},{name:"Dead Bug Single Leg Drop",storagePath:"exercises/bodyweight/core/Dead Bug Single Leg Drop.mp4"},{name:"Hollow Body Hold",storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"},{name:"Hollow Hold Flutter Kicks",storagePath:"exercises/bodyweight/core/Hollow Hold Flutter Kicks.mp4"}]},{id:"core_obliques",name:"Obliques & Rotation",desc:"35s work / 25s rest  3 rounds",level:"Intermediate",overview:"Target the obliques and rotational core muscles with this interval session. 35 seconds of work with 25 seconds rest  every exercise involves twisting, rotating, or side-bracing movements.",tips:["Rotate from your ribcage, not just your arms","Keep your hips as still as possible during twisting exercises","Brace your core before each movement  think about squeezing a belt","On side planks, stack your hips and push the floor away"],interval:!0,rounds:3,work:35,rest:25,exercises:[{name:"Russian Twist",storagePath:"exercises/bodyweight/core/Russian Twist.mp4"},{name:"Side Plank Rotation",storagePath:"exercises/bodyweight/core/Side Plank Rotation.mp4"},{name:"Cross Body Mountain Climbers",storagePath:"exercises/bodyweight/core/Cross Body Mountain Climbers.mp4"},{name:"Hip Dips Plank",storagePath:"exercises/bodyweight/core/Hip Dips Plank.mp4"},{name:"Bicycle Crunch",storagePath:"exercises/bodyweight/core/Bicycle Crunch.mp4"},{name:"Side Plank",storagePath:"exercises/bodyweight/core/Side Plank.mp4"}]},{id:"core_weighted",name:"Weighted Core",desc:"40s work / 20s rest  3 rounds",level:"Advanced",overview:"Add resistance to your core training with dumbbells and kettlebells. 40 seconds of weighted work followed by 20 seconds rest  this session builds serious core strength and stability.",tips:["Start with a moderate weight  form is more important than load","Brace your entire core before picking up the weight each round","Keep movements controlled  no swinging or using momentum","If grip fails before core does, go slightly lighter next time"],interval:!0,rounds:3,work:40,rest:20,exercises:[{name:"Russian Twists Dumbbell",storagePath:"exercises/dumbbells/core/russian twists dumbbell.mp4"},{name:"Kettlebell Russian Twist",storagePath:"exercises/kettlebells/core/kettlebell russian twist.mp4"},{name:"Kettlebell Side Bends",storagePath:"exercises/kettlebells/core/kettlebell side bends.mp4"},{name:"Kneeling Kettlebell Halo",storagePath:"exercises/kettlebells/core/kneeling kettlebell halo.mp4"},{name:"Kettlebell Bird Dog Drag",storagePath:"exercises/kettlebells/core/kettlebell bird dog drag.mp4"},{name:"Dumbbell Plank Pull Through",storagePath:null}]}]},N2=[{key:"bodyweight",label:"Bodyweight",icon:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 3c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm0 14.2c-2.5 0-4.71-1.28-6-3.22.03-1.99 4-3.08 6-3.08 1.99 0 5.97 1.09 6 3.08-1.29 1.94-3.5 3.22-6 3.22z"},{key:"dumbbells",label:"Dumbbells",icon:"M1 9h2v6H1V9zm3-2h2v10H4V7zm3 4h10v2H7v-2zm10-4h2v10h-2V7zm3 2h2v6h-2V9z"},{key:"kettlebells",label:"Kettlebells",icon:"M12 2C9.24 2 7 4.24 7 7c0 1.1.36 2.12.97 2.95C6.76 11.08 6 12.96 6 15c0 3.87 2.69 7 6 7s6-3.13 6-7c0-2.04-.76-3.92-1.97-5.05.61-.83.97-1.85.97-2.95 0-2.76-2.24-5-5-5zm0 2c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3z"}],Kp=[{key:"core",label:"Core",icon:"M12 2a4 4 0 0 1 4 4v1h-2V6a2 2 0 1 0-4 0v1H8V6a4 4 0 0 1 4-4zM8 9h8v2H8V9zm-1 4h10l-1 9H8l-1-9z"},{key:"upper",label:"Upper",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm8 10l-3-1.5c-.5-.25-1-.5-1.5-.5h-7c-.5 0-1 .25-1.5.5L4 12l-2 6h4l1.5 4h9L18 18h4l-2-6z"},{key:"lower",label:"Lower",icon:"M16.5 3A2.5 2.5 0 0 0 14 5.5 2.5 2.5 0 0 0 16.5 8 2.5 2.5 0 0 0 19 5.5 2.5 2.5 0 0 0 16.5 3zM14 9l-3 7h2l1 6h2l1-6h2l-3-7h-2z"},{key:"fullbody",label:"Full Body",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm-2 8h4l1 4h2l-1 4h-2l-1 4h-2l-1-4H8l-1-4h2l1-4z"},{key:"mix",label:"Mix It Up",icon:"M10.59 9.17L5.41 4 4 5.41l5.17 5.17 1.42-1.41zM14.5 4l2.04 2.04L4 18.59 5.41 20 17.96 7.46 20 9.5V4h-5.5zm-.83 9.41l-1.42 1.42L17.96 20.54l1.42-1.42-5.71-5.71z"}],Pl=[{key:"beginner",label:"Beginner",work:30,rest:30,desc:"30s work / 30s rest"},{key:"intermediate",label:"Intermediate",work:40,rest:20,desc:"40s work / 20s rest"},{key:"advanced",label:"Advanced",work:40,rest:15,desc:"40s work / 15s rest"}],Yp=[5,10,15,20,30];function PD(n){return n.replace(/\b\w/g,e=>e.toUpperCase())}function LD(n){const e=[...n];for(let t=e.length-1;t>0;t--){const i=Math.floor(Math.random()*(t+1));[e[t],e[i]]=[e[i],e[t]]}return e}function OD(){const{currentUser:n,isClient:e,clientData:t,loading:i}=Vr(),{isDark:l,toggleTheme:u,accent:d}=Ea(),{isPremium:p,FREE_RANDOMISER_DURATIONS:g,FREE_RANDOMISER_WEEKLY_LIMIT:y}=wm(),w=Gn(),[j,T]=v.useState("menu"),[V,$]=v.useState(["bodyweight"]),[F,U]=v.useState("core"),[te,K]=v.useState("intermediate"),[re,ye]=v.useState(p?15:5),[ve,ge]=v.useState([]),[R,E]=v.useState(!1),A=v.useRef(!1),O=v.useRef([]),[D,H]=v.useState([]),[I,$e]=v.useState(2),[xt,W]=v.useState(Pl[1]),[he,Pe]=v.useState(1),[He,ee]=v.useState(0),[L,se]=v.useState("work"),[Le,Oe]=v.useState(0),[Ye,Ue]=v.useState(!1),[pt,Tt]=v.useState(0),[at,Gt]=v.useState(!1),[zs,yt]=v.useState(!1),[ut,oe]=v.useState(null),ss=v.useRef(null);v.useRef(null),v.useRef(null);const[Ht,Dt]=v.useState(null),bt=v.useCallback((X,_e="info")=>{Dt({message:X,type:_e}),setTimeout(()=>Dt(null),3e3)},[]),[Ge,Ze]=v.useState(null),[Et,rn]=v.useState(null),[js,Kt]=v.useState(0),[St,Yt]=v.useState(0),[us,es]=v.useState([]),[Xs,Nt]=v.useState(""),[ps,be]=v.useState(""),[De,Y]=v.useState(!1),[we,Ce]=v.useState(0),[Me,Ae]=v.useState(!1),[it,Qe]=v.useState({}),Q=v.useRef(null),ce=v.useRef(null),[ze,dt]=v.useState([]),[ht,Vt]=v.useState(null),[Ct,At]=v.useState(0),[Ms,Js]=v.useState(0),[ns,Cs]=v.useState(0),[Ls,q]=v.useState(0),[xe,Ee]=v.useState(0),[je,ke]=v.useState(0),[ot,mt]=v.useState({beginner:0,intermediate:0,advanced:0}),et=p?Yp:Yp.filter(X=>g.includes(X)),gt=!p&&Ct>=y,[Rt,ws]=v.useState(null),[_n,ln]=v.useState(""),[Ln,kn]=v.useState(!1);v.useEffect(()=>{!i&&(!n||!e)&&w("/")},[n,e,i,w]),v.useEffect(()=>{if(!n||!t)return;(async()=>{try{const _e=Ft(fe,"workoutLogs"),me=Ps(_e,fs("clientId","==",t.id)),st=(await Ss(me)).docs.map(ls=>ls.data()),lt=st.filter(ls=>ls.type!=="programme");q(lt.length);const Mt=lt.reduce((ls,Bs)=>ls+(Bs.duration||0),0);Ee(Mt);const Xt={beginner:0,intermediate:0,advanced:0};lt.forEach(ls=>{ls.level&&Xt[ls.level]!==void 0&&Xt[ls.level]++}),mt(Xt);const is=new Date,Rs=is.getDay(),os=Rs===0?-6:1-Rs,Vs=new Date(is);Vs.setDate(is.getDate()+os),Vs.setHours(0,0,0,0);const Sr=Vs.getTime(),Nr=st.filter(ls=>{const Bs=ls.completedAt;return Bs?(Bs.toDate?Bs.toDate().getTime():new Date(Bs).getTime())>=Sr:!1});At(Nr.filter(ls=>ls.type!=="programme").length);let ar=0;if(t)try{const ls=await As(qe(fe,"clientProgrammes",t.id));if(ls.exists()){const Bs=ls.data(),zn=Bs.templateId;ar=Nr.filter(cn=>cn.type==="programme"&&cn.programmeId===zn).length,ws(zn);const jn=Gp.find(cn=>cn.id===zn);jn&&ln(jn.name);const Qn=ID[zn];if(Qn){const cn=Object.keys(Bs.completedSessions||{}).length,Vn=Qn.duration*Qn.daysPerWeek;Cs(Vn>0?Math.round(cn/Vn*100):0)}}else ws(null),ln(""),Cs(0)}catch{}Js(ar);const Yn=lt.map(ls=>ls.completedAt).filter(Boolean).map(ls=>ls.toDate?ls.toDate().getTime():new Date(ls).getTime()).sort((ls,Bs)=>Bs-ls);if(Yn.length===0)ke(0);else{const ls=new Set;Yn.forEach(Vn=>{const Cr=new Date(Vn),Br=Cr.getDay(),fr=Br===0?-6:1-Br,M=new Date(Cr);M.setDate(Cr.getDate()+fr),M.setHours(0,0,0,0),ls.add(M.getTime())});const Bs=[...ls].sort((Vn,Cr)=>Cr-Vn);let zn=0;const jn=new Date(is),Qn=is.getDay()===0?-6:1-is.getDay();jn.setDate(is.getDate()+Qn),jn.setHours(0,0,0,0);let cn=jn.getTime();Bs.includes(cn)||(cn-=10080*60*1e3);for(let Vn=0;Vn<200&&Bs.includes(cn);Vn++)zn++,cn-=10080*60*1e3;ke(zn)}}catch(_e){console.error("Error loading workout stats:",_e)}finally{kn(!0)}})()},[n,t,j]);const pn=()=>{const X=[];let _e;F==="mix"?_e=["core","upper","lower"]:F==="fullbody"?_e=["upper","lower"]:_e=[F];for(const me of V)for(const We of _e)X.push(`exercises/${me}/${We}`);return X},Hs=async()=>{if(A.current){for(;A.current;)await new Promise(X=>setTimeout(X,200));return O.current}A.current=!0,E(!0);try{const X=pn(),_e=[];for(const lt of X)try{const Mt=eo(to,lt),Xt=await _2(Mt);_e.push(...Xt.items)}catch{console.warn(`Folder ${lt} not found, skipping.`)}if(_e.length===0&&V.includes("bodyweight")&&F==="core")try{const lt=eo(to,"core"),Mt=await _2(lt);_e.push(...Mt.items)}catch{console.warn("Legacy core/ folder not found either.")}if(_e.length===0){const lt=V.map(Xt=>N2.find(is=>is.key===Xt)?.label).join(" + "),Mt=Kp.find(Xt=>Xt.key===F)?.label;return bt(`No exercises found for ${lt} / ${Mt}. Upload videos to Firebase Storage.`,"error"),A.current=!1,E(!1),[]}const me=new Set,We=_e.filter(lt=>{const Mt=lt.name.replace(/\.(mp4|gif)$/i,"");return me.has(Mt)?!1:(me.add(Mt),!0)}),st=await Promise.all(We.map(async lt=>{const Mt=await qo(lt),Xt=PD(lt.name.replace(/\.(mp4|gif)$/i,"")),is=/\.gif$/i.test(lt.name);return{name:Xt,videoUrl:Mt,isGif:is}}));return O.current=st,ge(st),A.current=!1,E(!1),st}catch(X){console.error("Error loading exercises:",X);const _e=X.code==="storage/unauthorized"?"Storage access denied. Check Firebase Storage rules allow read access.":`Failed to load exercises: ${X.message||X.code||"Unknown error"}`;return bt(_e,"error"),A.current=!1,E(!1),[]}},k=async()=>{if(gt)return;T("spinning"),O.current=[];const X=await Hs();if(X.length===0){T("setup");return}const _e=Pl.find(Rs=>Rs.key===te);W(_e);const me=_e.work+_e.rest,We=re*60,st=Math.floor(We/me);let lt,Mt;st<=6?(lt=Math.max(3,Math.floor(st/2)),Mt=Math.floor(st/lt)):st<=12?(lt=Math.min(6,Math.floor(st/2)),Mt=Math.floor(st/lt)):(lt=Math.min(10,Math.floor(st/2)),Mt=Math.floor(st/lt)),Mt=Math.max(2,Mt);const Xt=LD(X),is=Xt.slice(0,Math.min(lt,Xt.length));H(is),$e(Mt),setTimeout(()=>T("preview"),2e3)},N=()=>{T("countdown"),Tt(3)};v.useEffect(()=>{if(j!=="countdown")return;if(pt<=0){T("workout"),Pe(1),ee(0),se("work"),Oe(xt.work),Ue(!1),On();return}Os();const X=setTimeout(()=>Tt(_e=>_e-1),1e3);return()=>clearTimeout(X)},[pt,j]),v.useEffect(()=>{if(j!=="workout"||Ye)return;if(Le<=0){P();return}Le<=3&&Os();const X=setTimeout(()=>Oe(_e=>_e-1),1e3);return()=>clearTimeout(X)},[Le,j,Ye]);const P=()=>{if(L==="work")se("rest"),Oe(xt.rest);else{const X=He+1;if(X>=D.length){const _e=he+1;if(_e>I){Gt(!0),B();return}Pe(_e),ee(0)}else ee(X);se("work"),Oe(xt.work),On()}},B=async()=>{if(n)try{await mi(Ft(fe,"workoutLogs"),{clientId:t.id,level:te,duration:re,equipment:V,focus:F,exerciseCount:D.length,rounds:I,exercises:D.map(X=>X.name),completedAt:wt.now()}),At(X=>X+1),q(X=>X+1),Ee(X=>X+re),mt(X=>({...X,[te]:(X[te]||0)+1}))}catch(X){console.error("Error saving workout log:",X)}},ue=async(X,_e,me)=>{if(!(!t||!_e))try{const We=t.id,st=await As(qe(fe,"coreBuddyPBs",We)),Mt=(st.exists()?st.data():null)?.exercises||{},Xt=Mt[X];let is=!1;if(Xt?(_e>(Xt.weight||0)||_e===(Xt.weight||0)&&me>(Xt.reps||0))&&(is=!0):is=!0,is){const Rs={...Mt,[X]:{weight:_e,reps:me,achievedAt:wt.now()}};await Ns(qe(fe,"coreBuddyPBs",We),{clientId:t.id,exercises:Rs,updatedAt:wt.now()}),bt(`New PB! ${_e}kg  ${me} reps`,"success"),Os(),await Be(X,_e)}}catch(We){console.error("Error checking PB:",We)}},Be=async(X,_e)=>{if(t)try{const me=await As(qe(fe,"coreBuddyTargets",t.id));if(!me.exists())return;const st=(me.data().targets||{})[X];if(!st||_e<st.targetWeight)return;const lt=await As(qe(fe,"coreBuddyAchievements",t.id)),Mt=lt.exists()?lt.data():{clientId:t.id,badges:[],totalVolume:0};if(Mt.badges.some(os=>os.type==="pb_target"&&os.exercise===X&&os.targetWeight===st.targetWeight))return;const is={type:"pb_target",exercise:X,group:MD[X]||"push",targetWeight:st.targetWeight,achievedAt:wt.now()},Rs=[...Mt.badges,is];await Ns(qe(fe,"coreBuddyAchievements",t.id),{...Mt,badges:Rs,updatedAt:wt.now()}),dt(os=>[...os,is])}catch(me){console.error("Error checking target badge:",me)}},Fe=async X=>{if(!(!t||X<=0))try{const _e=await As(qe(fe,"coreBuddyAchievements",t.id)),me=_e.exists()?_e.data():{clientId:t.id,badges:[],totalVolume:0},We=me.totalVolume||0,st=We+X,lt=[];AD.forEach(Xt=>{st>=Xt.threshold&&We<Xt.threshold&&(me.badges.some(Rs=>Rs.type==="volume_milestone"&&Rs.milestone===Xt.threshold)||lt.push({type:"volume_milestone",milestone:Xt.threshold,label:Xt.label,achievedAt:wt.now()}))});const Mt=[...me.badges,...lt];await Ns(qe(fe,"coreBuddyAchievements",t.id),{clientId:t.id,badges:Mt,totalVolume:Math.round(st),updatedAt:wt.now()}),lt.length>0&&dt(Xt=>[...Xt,...lt])}catch(_e){console.error("Error updating volume:",_e)}},tt=async X=>{if(rn(X),X.interval){const We=[];for(const st of X.exercises){let lt=null,Mt=!1;if(st.storagePath)try{const Xt=eo(to,st.storagePath);lt=await qo(Xt),Mt=/\.gif$/i.test(st.storagePath)}catch{}We.push({name:st.name,videoUrl:lt,isGif:Mt})}H(We),$e(X.rounds),W({work:X.work,rest:X.rest}),T("preview");return}const _e={};for(const We of X.exercises)if(We.storagePath)try{const st=eo(to,We.storagePath);_e[We.name]={url:await qo(st),isGif:/\.gif$/i.test(We.storagePath)}}catch{}Qe(_e);const me=X.exercises.map(We=>({name:We.name,type:We.type,targetSets:We.sets,targetReps:We.reps||0,targetTime:We.time||0,sets:[]}));es(me),Kt(0),Yt(0),Nt(""),be(""),Ae(!1),Y(!1),Ce(0),dt([]),Vt(null),T("muscle_workout")},Xe=()=>{const X=Q.current;X&&(X.paused?(X.play(),Ae(!0)):(X.pause(),Ae(!1)))};v.useEffect(()=>{if(j!=="muscle_workout"||!De||we<=0){j==="muscle_workout"&&De&&we<=0&&(Y(!1),Os());return}return ce.current=setTimeout(()=>Ce(X=>X-1),1e3),()=>clearTimeout(ce.current)},[j,De,we]);const Qt=async()=>{const X=us[js];let _e={};if(X.type==="weighted"){const st=parseFloat(Xs)||0,lt=parseInt(ps)||0;if(lt===0){bt("Enter your reps","error");return}_e={weight:st,reps:lt}}else if(X.type==="reps"){const st=parseInt(ps)||0;if(st===0){bt("Enter your reps","error");return}_e={reps:st}}else if(X.type==="timed"){const st=X.targetTime-we;_e={time:Math.max(st,1)}}const me=[...us];me[js]={...X,sets:[...X.sets,_e]},es(me),X.type==="weighted"&&_e.weight>0&&await ue(X.name,_e.weight,_e.reps);const We=X.sets.length+1;if(We<X.targetSets)Yt(We),be(""),Y(!1),Ce(0);else if(js+1<us.length){const st=js+1;Kt(st),Yt(0),Nt(""),be(""),Ae(!1),Y(!1),Ce(0)}else await Ts(me),yt(!0)},Ts=async X=>{if(!(!n||!t))try{const _e=X.reduce((We,st)=>We+st.sets.reduce((lt,Mt)=>lt+(Mt.weight||0)*(Mt.reps||0),0),0),me=X.reduce((We,st)=>We+st.sets.length,0);await mi(Ft(fe,"workoutLogs"),{clientId:t.id,type:"muscle_group",muscleGroup:Ge,sessionId:Et?.id,sessionName:Et?.name,exerciseCount:X.length,totalSets:me,duration:Math.round(me*1.5),volume:Math.round(_e),exercises:X.map(We=>({name:We.name,type:We.type,sets:We.sets})),completedAt:wt.now()}),_e>0&&await Fe(_e),ze.length>0&&Vt({badges:[...ze]})}catch(_e){console.error("Error saving muscle group workout log:",_e)}},as=v.useRef(null),cs=()=>(as.current||(as.current=new(window.AudioContext||window.webkitAudioContext)),as.current),Os=()=>{try{const X=cs(),_e=X.createOscillator(),me=X.createGain();_e.connect(me),me.connect(X.destination),_e.frequency.value=880,me.gain.value=.3,_e.start(X.currentTime),_e.stop(X.currentTime+.15)}catch{}},On=()=>{try{const X=cs(),_e=X.createOscillator(),me=X.createGain();_e.connect(me),me.connect(X.destination),_e.frequency.value=1200,me.gain.value=.4,_e.start(X.currentTime),_e.stop(X.currentTime+.3)}catch{}};v.useEffect(()=>{if(j!=="workout"||L!=="work"||!D[He]?.isGif)return;const _e=setInterval(()=>{const me=ss.current;if(!me)return;const We=me.getAttribute("src");me.removeAttribute("src"),setTimeout(()=>{ss.current&&ss.current.setAttribute("src",We)},0)},4e3);return()=>clearInterval(_e)},[j,L,He,he,D]);const mr=(X,_e,me)=>{const We=Math.round(X/_e*RD);return r.jsx("svg",{className:"wk-ring-svg",viewBox:"0 0 200 200",children:tD.map((st,lt)=>r.jsx("line",{x1:st.x1,y1:st.y1,x2:st.x2,y2:st.y2,className:lt<We?`wk-tick-filled ${me}`:"wk-tick-empty",strokeWidth:st.thick?"3":"2"},lt))})},ds=()=>{const X=D.length*I;return((he-1)*D.length+He+(L==="rest"?.5:0))/X},Kn=Ht&&r.jsx("div",{className:`toast-notification ${Ht.type}`,children:Ht.message});if(i)return r.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>w("/client/core-buddy"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})]})}),r.jsx("div",{className:"wk-loading-inline",children:r.jsx("div",{className:"wk-loading-spinner"})})]});if(j==="menu")return r.jsx(ka,{children:r.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>w("/client/core-buddy"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),r.jsxs("main",{className:"wk-main",children:[r.jsxs("div",{className:"wk-menu-heading",children:[r.jsx("h2",{children:"Choose Your Workout"}),r.jsx("p",{children:"No excuses. Just results."})]}),r.jsx("button",{className:"wk-hero-card",onClick:()=>T("setup"),children:r.jsx("img",{src:E2,alt:"Randomise Workout",className:"wk-hero-bg"})}),r.jsxs("div",{className:"wk-section-header",children:[r.jsxs("h2",{children:["Programmes ",!p&&r.jsx("span",{className:"cb-premium-badge",children:"PREMIUM"})]}),r.jsxs("span",{className:"wk-section-count",children:[Gp.length," available"]})]}),p?r.jsx("div",{className:"wk-prog-scroll-wrap",children:r.jsx("div",{className:"wk-prog-scroll",children:Gp.map((X,_e)=>X.image?r.jsxs("button",{className:"wk-prog-img-card",onClick:()=>w("/client/core-buddy/programmes",{state:{templateId:X.id}}),style:{animationDelay:`${_e*.06}s`},children:[r.jsx("img",{src:X.image,alt:X.name,className:"wk-prog-img"}),_e===0&&r.jsx("div",{className:"wk-swipe-arrow",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})})]},X.id):r.jsxs("button",{className:"wk-prog-hero-card",onClick:()=>w("/client/core-buddy/programmes",{state:{templateId:X.id}}),style:{animationDelay:`${_e*.06}s`},children:[r.jsx("img",{src:SD,alt:"Programme",className:"wk-prog-hero-bg",loading:"lazy"}),r.jsx("div",{className:"wk-prog-hero-overlay",style:{background:DD[X.focus]}}),r.jsxs("div",{className:"wk-prog-hero-content",children:[r.jsxs("div",{className:"wk-prog-hero-top",children:[r.jsxs("span",{className:"wk-prog-hero-badge",children:[X.duration," WEEKS"]}),r.jsx("span",{className:"wk-prog-hero-level",children:X.level})]}),r.jsxs("div",{className:"wk-prog-hero-bottom",children:[r.jsx("h3",{children:X.name.toUpperCase()}),r.jsxs("p",{children:[X.daysPerWeek,"x per week  ",X.focus==="fullbody"?"Full Body":X.focus.charAt(0).toUpperCase()+X.focus.slice(1)," Focus"]}),r.jsx("span",{className:"wk-prog-hero-go",children:"VIEW PROGRAMME "})]})]}),_e===0&&r.jsx("div",{className:"wk-swipe-arrow",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})})]},X.id))})}):r.jsxs("button",{className:"cb-upgrade-teaser",onClick:()=>w("/upgrade"),children:[r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),r.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}),r.jsx("span",{children:"Upgrade to unlock programmes"})]}),r.jsxs("div",{className:"wk-section-header",children:[r.jsxs("h2",{children:["Muscle Groups ",!p&&r.jsx("span",{className:"cb-premium-badge",children:"PREMIUM"})]}),r.jsxs("span",{className:"wk-section-count",children:[Zc.length," groups"]})]}),p?r.jsx("div",{className:"wk-muscle-grid",children:Zc.map((X,_e)=>r.jsx("button",{className:`wk-muscle-hero-card${X.image?" wk-muscle-thumb":""}`,onClick:()=>{Ze(X.key),T("muscle_sessions")},style:{animationDelay:`${_e*.05}s`},children:X.image?r.jsx("img",{src:X.image,alt:X.label,className:"wk-muscle-thumb-img"}):r.jsxs(r.Fragment,{children:[r.jsx("img",{src:E2,alt:"Muscle group",className:"wk-muscle-hero-bg",loading:"lazy"}),r.jsx("div",{className:"wk-muscle-hero-overlay",style:{background:Wp[X.key]}}),r.jsxs("div",{className:"wk-muscle-hero-content",children:[r.jsx("div",{className:"wk-muscle-hero-icon",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:X.icon})})}),r.jsxs("div",{className:"wk-muscle-hero-text",children:[r.jsx("span",{className:"wk-muscle-hero-name",children:X.label}),r.jsxs("span",{className:"wk-muscle-hero-count",children:[S2[X.key]?.length||0," sessions"]})]})]})]})},X.key))}):r.jsxs("button",{className:"cb-upgrade-teaser",onClick:()=>w("/upgrade"),children:[r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),r.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}),r.jsx("span",{children:"Upgrade to unlock muscle group workouts"})]})]}),r.jsx(la,{active:"workouts"}),Kn]})});if(j==="setup"){const X=Kp.find(me=>me.key===F)?.label||F,_e=Pl.find(me=>me.key===te)?.label||te;return r.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>T("menu"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),r.jsxs("main",{className:"wk-main wk-setup-main",children:[r.jsx("div",{className:"wk-stats-row",children:[{label:"Total",value:`${Ls}`,pct:Ls>0?Math.min(Math.round(Ls/100*100),100):0,color:"#14b8a6",size:"normal"},{label:"This Week",value:`${Ct}/${$p}`,pct:Math.round(Math.min(Ct,$p)/$p*100),color:"var(--color-primary)",size:"large"},{label:"Wk Streak",value:`${je}`,pct:je>0?Math.min(Math.round(je/12*100),100):0,color:"#38B6FF",size:"normal"}].map(me=>{const st=2*Math.PI*38,lt=st-me.pct/100*st;return r.jsxs("div",{className:`wk-stat-item${me.size==="large"?" wk-stat-large":""}`,children:[r.jsxs("div",{className:"wk-stat-ring",children:[r.jsxs("svg",{viewBox:"0 0 100 100",children:[r.jsx("circle",{className:"wk-stat-track",cx:"50",cy:"50",r:38}),r.jsx("circle",{className:"wk-stat-fill",cx:"50",cy:"50",r:38,style:{stroke:me.color},strokeDasharray:st,strokeDashoffset:lt})]}),r.jsx("span",{className:"wk-stat-value",style:{color:me.color},children:me.value})]}),r.jsx("span",{className:"wk-stat-label",children:me.label})]},me.label)})}),r.jsxs("div",{className:"wk-setup-flow",children:[r.jsxs("div",{className:"wk-setup-section",children:[r.jsx("h2",{children:"Focus Area"}),r.jsx("div",{className:"wk-focus-grid",children:Kp.map(me=>r.jsxs("button",{className:`wk-equip-btn${F===me.key?" active":""}${me.key==="mix"?" wk-mix-btn":""}`,onClick:()=>U(me.key),children:[r.jsx("svg",{className:"wk-equip-icon",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:me.icon})}),r.jsx("span",{children:me.label})]},me.key))})]}),r.jsxs("div",{className:"wk-setup-section",children:[r.jsx("h2",{children:"Level"}),r.jsx("div",{className:"wk-level-cards",children:Pl.map(me=>r.jsxs("button",{className:`wk-level-card wk-level-${me.key}${te===me.key?" active":""}`,onClick:()=>K(me.key),children:[r.jsx("span",{className:"wk-level-name",children:me.label}),r.jsx("span",{className:"wk-level-desc",children:me.desc})]},me.key))})]}),r.jsxs("div",{className:"wk-setup-section",children:[r.jsx("h2",{children:"Time"}),r.jsx("div",{className:"wk-time-options",children:Yp.map(me=>{const We=!et.includes(me);return r.jsxs("button",{className:`wk-time-btn${re===me?" active":""}${We?" locked":""}`,onClick:()=>!We&&ye(me),disabled:We,children:[r.jsx("span",{className:"wk-time-num",children:me}),r.jsx("span",{className:"wk-time-unit",children:We?r.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),r.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}):"min"})]},me)})})]}),r.jsxs("div",{className:"wk-setup-section",children:[r.jsx("h2",{children:"Equipment"}),r.jsx("div",{className:"wk-equip-options",children:N2.map(me=>{const We=V.includes(me.key);return r.jsxs("button",{className:`wk-equip-btn${We?" active":""}`,onClick:()=>{$(st=>We&&st.length===1?st:We?st.filter(lt=>lt!==me.key):[...st,me.key])},children:[r.jsx("svg",{className:"wk-equip-icon",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:me.icon})}),r.jsx("span",{children:me.label})]},me.key)})})]}),r.jsx("div",{className:"wk-setup-summary",children:r.jsxs("span",{children:[X,"  ",_e,"  ",re," min"]})})]})]}),r.jsxs("div",{className:"wk-go-sticky",children:[gt&&r.jsx("p",{className:"wk-free-limit-msg",children:"You've used your free workout this week. Upgrade for unlimited access."}),r.jsx("button",{className:"wk-randomise-btn",onClick:k,disabled:R||gt,children:R?"Loading exercises...":gt?"Limit Reached":"Randomise Workout"})]}),Kn]})}if(j==="spinning")return r.jsxs("div",{className:"wk-page wk-page-center","data-theme":l?"dark":"light","data-accent":d,children:[r.jsxs("div",{className:"wk-spin-container",children:[r.jsxs("div",{className:"wk-spin-ring",children:[r.jsx("svg",{className:"wk-spin-svg",viewBox:"0 0 200 200",children:Fk.map((X,_e)=>r.jsx("line",{x1:X.x1,y1:X.y1,x2:X.x2,y2:X.y2,className:"wk-spin-tick",strokeWidth:X.thick?"3.5":"2",style:{animationDelay:`${_e*.03}s`}},_e))}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"wk-spin-logo",width:"50",height:"50"})]}),r.jsx("p",{className:"wk-spin-text",children:"Generating workout..."})]}),Kn]});if(j==="preview"){const X=Et?.interval?{work:Et.work,rest:Et.rest}:Pl.find(me=>me.key===te),_e=D.length*I*(X.work+X.rest);return r.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>T(Et?.interval?"muscle_sessions":"setup"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),r.jsxs("main",{className:"wk-main",children:[Et?.interval&&r.jsx("h2",{className:"mg-preview-title",children:Et.name}),r.jsxs("div",{className:"wk-preview-stats",children:[r.jsxs("div",{className:"wk-stat",children:[r.jsx("span",{className:"wk-stat-val",children:D.length}),r.jsx("span",{className:"wk-stat-label",children:"Exercises"})]}),r.jsxs("div",{className:"wk-stat",children:[r.jsx("span",{className:"wk-stat-val",children:I}),r.jsx("span",{className:"wk-stat-label",children:"Rounds"})]}),r.jsxs("div",{className:"wk-stat",children:[r.jsx("span",{className:"wk-stat-val",children:Math.ceil(_e/60)}),r.jsx("span",{className:"wk-stat-label",children:"Minutes"})]}),r.jsxs("div",{className:"wk-stat",children:[r.jsxs("span",{className:"wk-stat-val",children:[X.work,"/",X.rest]}),r.jsx("span",{className:"wk-stat-label",children:"Work/Rest"})]})]}),r.jsx("div",{className:"wk-preview-list",children:D.map((me,We)=>r.jsxs("div",{className:"wk-preview-item",style:{animationDelay:`${We*.06}s`},onClick:()=>oe(me),children:[r.jsx("span",{className:"wk-preview-num",children:We+1}),r.jsx("div",{className:"wk-preview-thumb",children:me.isGif?r.jsx("img",{src:me.videoUrl,alt:me.name,loading:"lazy"}):r.jsx("video",{src:`${me.videoUrl}#t=0.1`,muted:!0,playsInline:!0,preload:"auto"})}),r.jsx("span",{className:"wk-preview-name",children:me.name}),r.jsx("svg",{className:"wk-preview-play",width:"22",height:"22",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})})]},We))}),ut&&r.jsx("div",{className:"wk-preview-modal-backdrop",onClick:()=>oe(null),children:r.jsxs("div",{className:"wk-preview-modal",onClick:me=>me.stopPropagation(),children:[r.jsx("button",{className:"wk-preview-modal-close",onClick:()=>oe(null),"aria-label":"Close preview",children:r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})}),r.jsx("div",{className:"wk-preview-modal-video",children:ut.isGif?r.jsx("img",{src:ut.videoUrl,alt:ut.name}):r.jsx("video",{src:ut.videoUrl,autoPlay:!0,loop:!0,muted:!0,playsInline:!0})}),r.jsx("h3",{className:"wk-preview-modal-title",children:ut.name})]})}),r.jsxs("div",{className:"wk-preview-actions",children:[!Et?.interval&&r.jsxs("button",{className:"wk-btn-secondary",onClick:()=>k(),children:[r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("polyline",{points:"1 4 1 10 7 10"}),r.jsx("path",{d:"M3.51 15a9 9 0 1 0 2.13-9.36L1 10"})]}),"Reshuffle"]}),r.jsx("button",{className:"wk-btn-primary",onClick:N,children:"Start Workout"})]})]})]})}if(j==="countdown")return r.jsx("div",{className:"wk-page wk-page-center wk-page-dark","data-theme":l?"dark":"light","data-accent":d,children:r.jsxs("div",{className:"wk-countdown-big",children:[r.jsx("span",{className:"wk-countdown-num",children:pt}),r.jsx("span",{className:"wk-countdown-label",children:"GET READY"})]})});if(j==="workout"){const X=D[He],_e=L==="work"?xt.work:xt.rest,me=L==="rest"?He+1<D.length?D[He+1]:he<I?D[0]:null:null;return r.jsxs("div",{className:"wk-page wk-page-workout","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("div",{className:"wk-video-container",children:L==="work"?X.isGif?r.jsx("img",{ref:ss,className:"wk-video",src:X.videoUrl,alt:X.name},X.videoUrl):r.jsx("video",{className:"wk-video",src:X.videoUrl,autoPlay:!0,loop:!0,muted:!0,playsInline:!0},X.videoUrl):r.jsxs("div",{className:"wk-rest-screen",children:[r.jsx("span",{className:"wk-rest-label",children:"REST"}),me&&r.jsxs("span",{className:"wk-next-label",children:["Next: ",me.name]})]})}),r.jsx("div",{className:"wk-back-row",children:r.jsxs("button",{className:"wk-back-btn",onClick:()=>{confirm("Leave workout?")&&T("menu")},children:[r.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})}),"Back"]})}),r.jsx("div",{className:"wk-spotify",children:r.jsx("iframe",{src:"https://open.spotify.com/embed/playlist/37i9dQZF1DZ06evO3FJyYF?utm_source=generator&theme=0",width:"100%",height:"80",frameBorder:"0",allow:"autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture",loading:"lazy",title:"Spotify Playlist"})}),r.jsxs("div",{className:"wk-exercise-info",children:[r.jsxs("span",{className:"wk-exercise-counter",children:[He+1," / ",D.length]}),r.jsx("h2",{className:"wk-exercise-name",children:X.name}),r.jsxs("span",{className:"wk-round-label",children:["Round ",he," of ",I]})]}),r.jsx("div",{className:"wk-timer-section",children:r.jsxs("div",{className:"wk-timer-ring-wrap",children:[mr(Le,_e,L==="work"?"wk-tick-work":"wk-tick-rest"),r.jsxs("div",{className:"wk-timer-center",children:[r.jsx("span",{className:"wk-timer-time",children:Le}),r.jsx("span",{className:`wk-timer-phase ${L}`,children:L==="work"?"WORK":"REST"})]})]})}),r.jsxs("div",{className:"wk-controls",children:[r.jsx("button",{className:"wk-ctrl-btn wk-ctrl-stop",onClick:()=>{confirm("End workout early?")&&T("menu")},children:r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("rect",{x:"4",y:"4",width:"16",height:"16",rx:"2"})})}),r.jsx("button",{className:"wk-ctrl-btn wk-ctrl-pause",onClick:()=>Ue(!Ye),children:Ye?r.jsx("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})}):r.jsxs("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"currentColor",children:[r.jsx("rect",{x:"6",y:"4",width:"4",height:"16"}),r.jsx("rect",{x:"14",y:"4",width:"4",height:"16"})]})}),r.jsx("button",{className:"wk-ctrl-btn wk-ctrl-skip",onClick:()=>{Oe(0)},children:r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:[r.jsx("polygon",{points:"5 4 15 12 5 20 5 4"}),r.jsx("rect",{x:"15",y:"4",width:"4",height:"16"})]})})]}),r.jsx("div",{className:"wk-progress-bar",children:r.jsx("div",{className:"wk-progress-fill",style:{width:`${ds()*100}%`}})}),at&&(()=>{const We=Pl.find(lt=>lt.key===te),st=D.length*I*(We.work+We.rest);return r.jsx(Ig,{title:"Workout Complete!",stats:[{value:Math.ceil(st/60),label:"Minutes"},{value:D.length*I,label:"Intervals"},{value:I,label:"Rounds"}],onDone:()=>{Gt(!1),rn(null),Ze(null),T("menu")}})})()]})}if(j==="muscle_sessions"){const X=Zc.find(me=>me.key===Ge),_e=S2[Ge]||[];return r.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>T("menu"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),r.jsxs("main",{className:"wk-main",children:[r.jsxs("div",{className:"mg-sessions-header",children:[r.jsx("div",{className:"mg-sessions-icon",style:{background:Wp[Ge]},children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:X?.icon})})}),r.jsxs("h2",{children:[X?.label," Workouts"]}),r.jsxs("p",{children:[_e.length," sessions available"]})]}),r.jsx("div",{className:"mg-sessions-list",children:_e.map((me,We)=>r.jsxs("button",{className:"mg-session-card",onClick:()=>{rn(me),T("muscle_overview")},style:{animationDelay:`${We*.08}s`},children:[r.jsxs("div",{className:"mg-session-info",children:[r.jsx("h3",{children:me.name}),r.jsx("p",{children:me.desc}),r.jsx("div",{className:"mg-session-meta",children:me.interval?r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"mg-session-tag mg-tag-interval",children:"Interval"}),r.jsxs("span",{className:"mg-session-tag",children:[me.exercises.length," exercises"]}),r.jsxs("span",{className:"mg-session-tag",children:[me.rounds," rounds"]})]}):r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"mg-session-tag mg-tag-strength",children:"Strength"}),r.jsxs("span",{className:"mg-session-tag",children:[me.exercises.length," exercises"]}),r.jsx("span",{className:"mg-session-tag",children:(()=>{const st=me.exercises.map(Xt=>Xt.sets||0),lt=Math.min(...st),Mt=Math.max(...st);return lt===Mt?`${lt} sets each`:`${lt}-${Mt} sets each`})()})]})})]}),r.jsx("div",{className:"mg-session-arrow",children:r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})})]},me.id))})]}),Kn]})}if(j==="muscle_overview"){const X=Et;if(!X)return null;const _e=Zc.find(me=>me.key===Ge);return r.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>T("muscle_sessions"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),r.jsxs("main",{className:"wk-main mg-overview-main",children:[r.jsx("div",{className:"mg-overview-hero",style:{background:Wp[Ge]},children:r.jsx("div",{className:"mg-overview-hero-content",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",className:"mg-overview-hero-icon",children:r.jsx("path",{d:_e?.icon})})})}),r.jsxs("div",{className:"mg-overview-header",children:[r.jsxs("div",{className:"mg-overview-title-row",children:[r.jsx("h2",{children:X.name}),X.level&&r.jsx("span",{className:"mg-overview-level",children:X.level})]}),r.jsx("p",{className:"mg-overview-desc",children:X.desc})]}),X.overview&&r.jsxs("div",{className:"mg-overview-section",children:[r.jsxs("h3",{children:[r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("path",{d:"M12 16v-4M12 8h.01"})]}),"About This Workout"]}),r.jsx("p",{children:X.overview})]}),X.tips&&X.tips.length>0&&r.jsxs("div",{className:"mg-overview-section",children:[r.jsxs("h3",{children:[r.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 1 1 7.072 0l-.548.547A3.374 3.374 0 0 0 14 18.469V19a2 2 0 1 1-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),"Tips & Form"]}),r.jsx("ul",{className:"mg-overview-tips",children:X.tips.map((me,We)=>r.jsx("li",{children:me},We))})]}),r.jsxs("div",{className:"mg-overview-section",children:[r.jsxs("h3",{children:[r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M9 5H7a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-2"}),r.jsx("rect",{x:"9",y:"3",width:"6",height:"4",rx:"1"}),r.jsx("path",{d:"M9 14l2 2 4-4"})]}),"Exercises (",X.exercises.length,")"]}),r.jsx("div",{className:"mg-overview-exercises",children:X.exercises.map((me,We)=>r.jsxs("div",{className:"mg-overview-exercise",children:[r.jsx("span",{className:"mg-overview-ex-num",children:We+1}),r.jsxs("div",{className:"mg-overview-ex-info",children:[r.jsx("span",{className:"mg-overview-ex-name",children:me.name}),X.interval?r.jsxs("span",{className:"mg-overview-ex-detail",children:[X.work,"s work / ",X.rest,"s rest"]}):r.jsxs("span",{className:"mg-overview-ex-detail",children:[me.sets," sets  ",me.reps?`${me.reps} reps`:`${me.time}s`,me.type==="weighted"&&"  weighted"]})]})]},We))})]}),r.jsxs("button",{className:"mg-overview-start-btn",onClick:()=>tt(X),children:[r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M8 5v14l11-7z"})}),"Start Workout"]})]}),Kn]})}if(j==="muscle_workout"){const X=Et;if(!X)return null;const _e=X.exercises[js],me=us[js];if(!_e||!me)return null;const We=me.sets.length,st=X.exercises.length,lt=X.exercises.reduce((os,Vs)=>os+(Vs.sets||0),0),Xt=us.reduce((os,Vs)=>os+Vs.sets.length,0)/lt*100,is=it[_e.name];_e.type==="timed"&&we===0&&!De&&We===St&&setTimeout(()=>Ce(_e.time),0);const Rs=We+1<_e.sets?"Log Set":js+1<st?"Log Set  Next Exercise":"Log Set  Complete";return r.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("div",{className:"mg-session-progress",children:r.jsx("div",{className:"mg-session-progress-fill",style:{width:`${Xt}%`}})}),r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>{confirm("End workout early?")&&T("muscle_overview")},"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsxs("span",{className:"mg-header-info",children:["Exercise ",js+1,"/",st]}),r.jsx("div",{style:{width:22}})]})}),r.jsxs("main",{className:"wk-main",children:[is?r.jsxs("div",{className:"mg-video-container",onClick:Xe,children:[is.isGif?r.jsx("img",{className:"mg-video",src:is.url,alt:_e.name}):r.jsx("video",{ref:Q,className:"mg-video",src:is.url,loop:!0,muted:!0,playsInline:!0},_e.name),!Me&&!is.isGif&&r.jsxs("div",{className:"mg-video-overlay",children:[r.jsx("svg",{className:"mg-play-icon",width:"48",height:"48",viewBox:"0 0 24 24",fill:"rgba(255,255,255,0.9)",children:r.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})}),r.jsx("span",{className:"mg-video-hint",children:"Tap for demo"})]})]}):r.jsxs("div",{className:"mg-video-placeholder",children:[r.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",opacity:"0.4",children:[r.jsx("rect",{x:"2",y:"2",width:"20",height:"20",rx:"2.18",ry:"2.18"}),r.jsx("line",{x1:"7",y1:"2",x2:"7",y2:"22"}),r.jsx("line",{x1:"17",y1:"2",x2:"17",y2:"22"}),r.jsx("line",{x1:"2",y1:"12",x2:"22",y2:"12"}),r.jsx("line",{x1:"2",y1:"7",x2:"7",y2:"7"}),r.jsx("line",{x1:"2",y1:"17",x2:"7",y2:"17"}),r.jsx("line",{x1:"17",y1:"7",x2:"22",y2:"7"}),r.jsx("line",{x1:"17",y1:"17",x2:"22",y2:"17"})]}),r.jsx("span",{children:"Video coming soon"})]}),r.jsx("div",{className:"wk-spotify",children:r.jsx("iframe",{src:"https://open.spotify.com/embed/playlist/37i9dQZF1DZ06evO3FJyYF?utm_source=generator&theme=0",width:"100%",height:"80",frameBorder:"0",allow:"autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture",loading:"lazy",title:"Spotify Playlist"})}),r.jsxs("div",{className:"mg-exercise-card",children:[r.jsx("h2",{className:"mg-ex-name",children:_e.name}),r.jsx("span",{className:`mg-ex-type-badge ${_e.type}`,children:_e.type==="weighted"?"Weight + Reps":_e.type==="reps"?"Reps Only":"Timed"}),r.jsxs("div",{className:"mg-ex-set-info",children:[r.jsxs("span",{className:"mg-ex-set-num",children:["Set ",We+1," of ",_e.sets]}),_e.type!=="timed"&&r.jsxs("span",{className:"mg-ex-target",children:["Target: ",_e.reps," reps"]}),_e.type==="timed"&&r.jsxs("span",{className:"mg-ex-target",children:["Target: ",_e.time,"s"]})]}),_e.type==="weighted"&&r.jsxs("div",{className:"mg-input-area",children:[r.jsxs("div",{className:"mg-input-group",children:[r.jsx("label",{children:"Weight (kg)"}),r.jsx("input",{type:"number",inputMode:"decimal",className:"mg-input",value:Xs,onChange:os=>Nt(os.target.value),placeholder:"0"})]}),r.jsxs("div",{className:"mg-input-group",children:[r.jsx("label",{children:"Reps"}),r.jsx("input",{type:"number",inputMode:"numeric",className:"mg-input",value:ps,onChange:os=>be(os.target.value),placeholder:"0"})]})]}),_e.type==="reps"&&r.jsx("div",{className:"mg-input-area",children:r.jsxs("div",{className:"mg-input-group mg-input-single",children:[r.jsx("label",{children:"Reps"}),r.jsx("input",{type:"number",inputMode:"numeric",className:"mg-input",value:ps,onChange:os=>be(os.target.value),placeholder:"0"})]})}),_e.type==="timed"&&r.jsxs("div",{className:"mg-timer-area",children:[r.jsx("div",{className:"mg-timer-display",children:r.jsxs("span",{className:"mg-timer-value",children:[we,"s"]})}),De?r.jsx("button",{className:"mg-timer-btn mg-timer-stop",onClick:()=>Y(!1),children:"Stop"}):r.jsx("button",{className:"mg-timer-btn",onClick:()=>{we===0&&Ce(_e.time),Y(!0)},children:we<_e.time&&we>0?"Resume":"Start Timer"})]}),r.jsx("button",{className:"mg-log-set-btn",onClick:Qt,children:Rs}),me.sets.length>0&&r.jsx("div",{className:"mg-completed-sets",children:me.sets.map((os,Vs)=>r.jsxs("div",{className:"mg-completed-set",children:[r.jsx("span",{className:"mg-completed-set-check",children:""}),r.jsxs("span",{children:["Set ",Vs+1,": ",os.weight!=null?`${os.weight}kg  ${os.reps}`:os.reps!=null?`${os.reps} reps`:`${os.time}s`]})]},Vs))})]})]}),Kn,zs&&(()=>{const os=us.reduce((ar,Yn)=>ar+Yn.sets.length,0),Vs=us.reduce((ar,Yn)=>ar+Yn.sets.reduce((ls,Bs)=>ls+(Bs.weight||0)*(Bs.reps||0),0),0),Sr=Zc.find(ar=>ar.key===Ge)?.label||"",Nr=[{value:us.length,label:"Exercises"},{value:os,label:"Sets"}];return Vs>0&&Nr.push({value:Math.round(Vs).toLocaleString(),label:"Volume (kg)"}),r.jsx(Ig,{title:`${Sr} Complete!`,subtitle:Et?.name,stats:Nr,onDone:()=>{yt(!1),rn(null),Ze(null),Vt(null),T("menu")}})})(),ht&&r.jsx("div",{className:"mg-badge-celebration",onClick:()=>Vt(null),children:r.jsxs("div",{className:"mg-badge-celebration-card",children:[r.jsx("div",{className:"mg-badge-celebration-icon",children:r.jsx("svg",{viewBox:"0 0 24 24",width:"48",height:"48",fill:"#ffc107",children:r.jsx("polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"})})}),r.jsx("h3",{className:"mg-badge-celebration-title",children:ht.badges.length===1?"Badge Earned!":`${ht.badges.length} Badges Earned!`}),r.jsx("div",{className:"mg-badge-celebration-list",children:ht.badges.map((os,Vs)=>r.jsx("div",{className:"mg-badge-celebration-item",children:os.type==="pb_target"?`${os.exercise}  ${os.targetWeight}kg`:os.label},Vs))}),r.jsx("button",{className:"mg-badge-celebration-dismiss",children:"Tap to dismiss"})]})})]})}return null}const VD=60,BD={"Dumbbell Floor Press":"push","Seated Dumbbell Shoulder Press":"push","Seated Dumbbell Arnold Press":"push","Dumbbell Overhead Tricep Extension":"push",Skullcrushers:"push","Dumbbell Lateral Raise":"push","Dumbbell Front Raise":"push","Dumbbell Bent Over Row":"pull","Single Arm Bent Over Row":"pull","Bicep Curl":"pull","Hammer Curl":"pull","Dumbbell Bent Over Rear Delt Fly":"pull","Renegade Row":"pull","Dumbbell Goblet Squats":"lower","Romanian Deadlifts":"lower","Forward Dumbbell Lunges":"lower","Dumbbell Sumo Squats":"lower","Weighted Calf Raises":"lower","1 Legged RDL":"lower","Dumbbell Box Step Ups":"lower","Dumbbell Squat Pulses":"lower","Dumbbell Reverse Lunges":"lower","Kettlebell Romanian Deadlift":"lower","Russian Twists Dumbbell":"core","Kettlebell Russian Twist":"core","Kettlebell Side Bends":"core","Kneeling Kettlebell Halo":"core"},UD=[{threshold:1e3,label:"1 Tonne"},{threshold:5e3,label:"5 Tonne"},{threshold:1e4,label:"10 Tonne"},{threshold:25e3,label:"25 Tonne"},{threshold:5e4,label:"50 Tonne"},{threshold:1e5,label:"100 Tonne"},{threshold:25e4,label:"250 Tonne"},{threshold:5e5,label:"500 Tonne"},{threshold:1e6,label:"1 Million kg"}],C2=[{id:"fullbody_4wk",name:"4-Week Full Body",focus:"fullbody",duration:4,daysPerWeek:3,level:"All Levels",description:"Build total body strength with compound dumbbell movements and bodyweight finishers",repProg:2,timeProg:5,days:[{name:"Day 1",label:"Push Focus",exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:3,baseReps:10,pbKey:"chestPress",storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Seated Dumbbell Shoulder Press",type:"weighted",sets:3,baseReps:10,pbKey:"shoulderPress",storagePath:"exercises/dumbbells/upper/seated dumbbell shoulder press.mp4"},{name:"Dumbbell Goblet Squats",type:"weighted",sets:3,baseReps:10,pbKey:"squat",storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Press Up",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Mountain Climbers",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Mountain Climbers.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]},{name:"Day 2",label:"Pull Focus",exercises:[{name:"Dumbbell Bent Over Row",type:"weighted",sets:3,baseReps:10,pbKey:"seatedRow",storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Bicep Curl",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Romanian Deadlifts",type:"weighted",sets:3,baseReps:10,pbKey:"deadlift",storagePath:"exercises/dumbbells/lower/romanian deadlifts.GIF"},{name:"Reverse Lunge",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/lower/reverse lunge.GIF"},{name:"Russian Twist",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Russian Twist.mp4"},{name:"Side Plank",type:"timed",sets:2,baseTime:25,storagePath:"exercises/bodyweight/core/Side Plank.mp4"}]},{name:"Day 3",label:"Legs & Core",exercises:[{name:"Forward Dumbbell Lunges",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.GIF"},{name:"Dumbbell Sumo Squats",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/lower/dumbbell sumo squats.GIF"},{name:"Weighted Calf Raises",type:"weighted",sets:3,baseReps:15,storagePath:"exercises/dumbbells/lower/weighted calf raises.GIF"},{name:"Box Step Ups",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/lower/box step ups.GIF"},{name:"Burpee",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]}]},{id:"fullbody_8wk",name:"8-Week Full Body",focus:"fullbody",duration:8,daysPerWeek:3,level:"Intermediate",description:"Two-phase programme building strength and endurance across your full body",repProg:1,timeProg:3,days:[{name:"Day 1",label:"Strength",exercises:[{name:"Dumbbell Goblet Squats",type:"weighted",sets:4,baseReps:8,pbKey:"squat",storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Dumbbell Floor Press",type:"weighted",sets:4,baseReps:8,pbKey:"chestPress",storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Dumbbell Bent Over Row",type:"weighted",sets:4,baseReps:8,pbKey:"seatedRow",storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Seated Dumbbell Shoulder Press",type:"weighted",sets:3,baseReps:10,pbKey:"shoulderPress",storagePath:"exercises/dumbbells/upper/seated dumbbell shoulder press.mp4"},{name:"Mountain Climbers",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Mountain Climbers.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:35,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]},{name:"Day 2",label:"Power",exercises:[{name:"Romanian Deadlifts",type:"weighted",sets:4,baseReps:8,pbKey:"deadlift",storagePath:"exercises/dumbbells/lower/romanian deadlifts.GIF"},{name:"Forward Dumbbell Lunges",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.GIF"},{name:"Single Arm Bent Over Row",type:"weighted",sets:4,baseReps:8,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Hammer Curl",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/hammer curl.mp4"},{name:"Bulgarian Split Squats",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/lower/bulgarian split squats.GIF"},{name:"Russian Twist",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Russian Twist.mp4"}]},{name:"Day 3",label:"Endurance",exercises:[{name:"Dumbbell Sumo Squats",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/lower/dumbbell sumo squats.GIF"},{name:"Weighted Calf Raises",type:"weighted",sets:3,baseReps:15,storagePath:"exercises/dumbbells/lower/weighted calf raises.GIF"},{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Press Up",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Burpee",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:40,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]}]},{id:"fullbody_12wk",name:"12-Week Full Body",focus:"fullbody",duration:12,daysPerWeek:3,level:"Advanced",description:"Complete transformation programme: push, pull, and legs over three phases",repProg:1,timeProg:2,days:[{name:"Day 1",label:"Upper Push",exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:4,baseReps:8,pbKey:"chestPress",storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Seated Dumbbell Arnold Press",type:"weighted",sets:4,baseReps:8,storagePath:"exercises/dumbbells/upper/seated dumbbell arnold press.mp4"},{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Skullcrushers",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/skullcrushers.mp4"},{name:"Press Up",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]},{name:"Day 2",label:"Lower Body",exercises:[{name:"Dumbbell Goblet Squats",type:"weighted",sets:4,baseReps:8,pbKey:"squat",storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Romanian Deadlifts",type:"weighted",sets:4,baseReps:8,pbKey:"deadlift",storagePath:"exercises/dumbbells/lower/romanian deadlifts.GIF"},{name:"Forward Dumbbell Lunges",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.GIF"},{name:"Weighted Calf Raises",type:"weighted",sets:3,baseReps:15,storagePath:"exercises/dumbbells/lower/weighted calf raises.GIF"},{name:"Jump Squats",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/lower/jump squats.GIF"},{name:"Hollow Body Hold",type:"timed",sets:3,baseTime:30,storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"}]},{name:"Day 3",label:"Upper Pull",exercises:[{name:"Dumbbell Bent Over Row",type:"weighted",sets:4,baseReps:8,pbKey:"seatedRow",storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Single Arm Bent Over Row",type:"weighted",sets:4,baseReps:8,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Bicep Curl",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Burpee",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Side Plank",type:"timed",sets:2,baseTime:25,storagePath:"exercises/bodyweight/core/Side Plank.mp4"}]}]},{id:"core_4wk",name:"4-Week Core",focus:"core",duration:4,daysPerWeek:3,level:"Beginner",description:"Build a solid core foundation with targeted ab and stability work",repProg:2,timeProg:5,days:[{name:"Day 1",label:"Abs",exercises:[{name:"Crunch",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/core/Crunch.mp4"},{name:"Leg Raises",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Leg Raises.mp4"},{name:"Russian Twist",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Russian Twist.mp4"},{name:"Bicycle Crunch",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Bicycle Crunch.mp4"},{name:"Mountain Climbers",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Mountain Climbers.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]},{name:"Day 2",label:"Stability",exercises:[{name:"Dead Bug",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Dead Bug.mp4"},{name:"Bird Dog",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Bird Dog.mp4"},{name:"Side Plank",type:"timed",sets:2,baseTime:20,storagePath:"exercises/bodyweight/core/Side Plank.mp4"},{name:"Flutter Kicks",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Flutter Kicks.mp4"},{name:"Hollow Body Hold",type:"timed",sets:3,baseTime:20,storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"},{name:"High Plank Shoulder Taps",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/High Plank Shoulder Taps.mp4"}]},{name:"Day 3",label:"Power Core",exercises:[{name:"Single Leg V-Up",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Single Leg V-Up.mp4"},{name:"Toe Reaches",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/core/toe reaches.GIF"},{name:"Russian Twists Dumbbell",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/core/russian twists dumbbell.GIF"},{name:"Burpee",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Fast Mountain Climbers",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Fast Mountain Climbers.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]}]},{id:"core_8wk",name:"8-Week Core",focus:"core",duration:8,daysPerWeek:3,level:"Intermediate",description:"Develop deep core strength and rotational power over two phases",repProg:1,timeProg:3,days:[{name:"Day 1",label:"Anti-Extension",exercises:[{name:"Forearm Plank",type:"timed",sets:3,baseTime:35,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"},{name:"Dead Bug",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Dead Bug.mp4"},{name:"Plank Walkout",type:"reps",sets:3,baseReps:8,storagePath:"exercises/bodyweight/core/Plank Walkout.mp4"},{name:"Hollow Body Hold",type:"timed",sets:3,baseTime:25,storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"},{name:"Leg Raises",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Leg Raises.mp4"},{name:"Mountain Climbers",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Mountain Climbers.mp4"}]},{name:"Day 2",label:"Rotation",exercises:[{name:"Russian Twist",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Russian Twist.mp4"},{name:"Kettlebell Russian Twist",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/kettlebells/core/kettlebell russian twist.mp4"},{name:"Bicycle Crunch",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Bicycle Crunch.mp4"},{name:"Side Plank Rotation",type:"reps",sets:2,baseReps:10,storagePath:"exercises/bodyweight/core/Side Plank Rotation.mp4"},{name:"High Plank Shoulder Taps",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/core/High Plank Shoulder Taps.mp4"},{name:"Hollow Hold To V-Sit",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Hollow Hold To V-sit.mp4"}]},{name:"Day 3",label:"Power",exercises:[{name:"Crunch",type:"reps",sets:4,baseReps:15,storagePath:"exercises/bodyweight/core/Crunch.mp4"},{name:"Flutter Kicks",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Flutter Kicks.mp4"},{name:"Reverse Crunch To Leg Raise",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Reverse Crunch To Leg Raise.mp4"},{name:"Burpee",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Kettlebell Bird Dog Drag",type:"reps",sets:3,baseReps:10,storagePath:"exercises/kettlebells/core/kettlebell bird dog drag.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:40,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]}]},{id:"core_12wk",name:"12-Week Core",focus:"core",duration:12,daysPerWeek:3,level:"Advanced",description:"Ultimate core transformation: stability, strength, and power across three phases",repProg:1,timeProg:2,days:[{name:"Day 1",label:"Strength",exercises:[{name:"Forearm Plank",type:"timed",sets:4,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"},{name:"Plank Walkout",type:"reps",sets:4,baseReps:8,storagePath:"exercises/bodyweight/core/Plank Walkout.mp4"},{name:"Leg Raises",type:"reps",sets:4,baseReps:12,storagePath:"exercises/bodyweight/core/Leg Raises.mp4"},{name:"Kettlebell Side Bends",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/kettlebells/core/kettlebell side bends.mp4"},{name:"Dead Bug Single Leg Drop",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Dead Bug Single Leg Drop.mp4"},{name:"Hollow Body Hold",type:"timed",sets:3,baseTime:25,storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"}]},{name:"Day 2",label:"Endurance",exercises:[{name:"Crunch",type:"reps",sets:4,baseReps:15,storagePath:"exercises/bodyweight/core/Crunch.mp4"},{name:"Kettlebell Russian Twist",type:"weighted",sets:4,baseReps:15,storagePath:"exercises/kettlebells/core/kettlebell russian twist.mp4"},{name:"Bicycle Crunch",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Bicycle Crunch.mp4"},{name:"Hollow Hold Flutter Kicks",type:"reps",sets:3,baseReps:25,storagePath:"exercises/bodyweight/core/Hollow Hold Flutter Kicks.mp4"},{name:"Cross Body Mountain Climbers",type:"reps",sets:3,baseReps:25,storagePath:"exercises/bodyweight/core/Cross Body Mountain Climbers.mp4"},{name:"Side Plank",type:"timed",sets:2,baseTime:25,storagePath:"exercises/bodyweight/core/Side Plank.mp4"}]},{name:"Day 3",label:"Power",exercises:[{name:"Hollow Hold To V-Sit",type:"reps",sets:4,baseReps:10,storagePath:"exercises/bodyweight/core/Hollow Hold To V-sit.mp4"},{name:"Reverse Crunch To Leg Raise",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Reverse Crunch To Leg Raise.mp4"},{name:"Burpee",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Hip Dips Plank",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/core/Hip Dips Plank.mp4"},{name:"Kneeling Kettlebell Halo",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/kettlebells/core/kneeling kettlebell halo.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:35,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]}]},{id:"upper_4wk",name:"4-Week Upper Body",focus:"upper",duration:4,daysPerWeek:3,level:"Intermediate",description:"Sculpt and strengthen your chest, back, shoulders, and arms",repProg:2,timeProg:5,days:[{name:"Day 1",label:"Push",exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:4,baseReps:10,pbKey:"chestPress",storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Seated Dumbbell Shoulder Press",type:"weighted",sets:3,baseReps:10,pbKey:"shoulderPress",storagePath:"exercises/dumbbells/upper/seated dumbbell shoulder press.mp4"},{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Tricep Dips",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/upper/tricep dips.mp4"},{name:"Pike Push Ups",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/upper/pike push ups.GIF"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]},{name:"Day 2",label:"Pull",exercises:[{name:"Dumbbell Bent Over Row",type:"weighted",sets:4,baseReps:10,pbKey:"seatedRow",storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Single Arm Bent Over Row",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Bicep Curl",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Hammer Curl",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/hammer curl.mp4"},{name:"Reverse Plank",type:"timed",sets:3,baseTime:20,storagePath:"exercises/bodyweight/upper/reverse plank.GIF"}]},{name:"Day 3",label:"Mixed",exercises:[{name:"Seated Dumbbell Arnold Press",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/seated dumbbell arnold press.mp4"},{name:"Dumbbell Lateral Raise",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/dumbbell lateral raise.mp4"},{name:"Dumbbell Front Raise",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/dumbbell front raise.mp4"},{name:"Press Up",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Renegade Row",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/renegade row.mp4"},{name:"Superman Hold",type:"timed",sets:3,baseTime:30,storagePath:"exercises/bodyweight/core/Superman Hold.mp4"}]}]},{id:"lower_4wk",name:"4-Week Lower Body",focus:"lower",duration:4,daysPerWeek:3,level:"Intermediate",description:"Build powerful legs and glutes with squats, deadlifts, and plyometrics",repProg:2,timeProg:5,days:[{name:"Day 1",label:"Quad Dominant",exercises:[{name:"Dumbbell Goblet Squats",type:"weighted",sets:4,baseReps:10,pbKey:"squat",storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Forward Dumbbell Lunges",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.GIF"},{name:"Dumbbell Box Step Ups",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/lower/dumbbell box step ups.mp4"},{name:"Dumbbell Squat Pulses",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/lower/dumbbell squat pulses.GIF"},{name:"Jump Squats",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/lower/jump squats.GIF"},{name:"Squat And Hold",type:"timed",sets:3,baseTime:30,storagePath:"exercises/bodyweight/lower/squat and hold.GIF"}]},{name:"Day 2",label:"Hamstring & Glute",exercises:[{name:"Romanian Deadlifts",type:"weighted",sets:4,baseReps:8,pbKey:"deadlift",storagePath:"exercises/dumbbells/lower/romanian deadlifts.GIF"},{name:"1 Legged RDL",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/lower/1 legged rdl.GIF"},{name:"Hip Thrusts",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/lower/hip thrusts.GIF"},{name:"Dumbbell Reverse Lunges",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/lower/dumbbell reverse lunges.GIF"},{name:"Donkey Kicks",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/lower/donkey kicks.GIF"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]},{name:"Day 3",label:"Power & Stability",exercises:[{name:"Dumbbell Sumo Squats",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/lower/dumbbell sumo squats.GIF"},{name:"Kettlebell Romanian Deadlift",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/kettlebells/lower/kettlebell romanian deadlift.mp4"},{name:"Weighted Calf Raises",type:"weighted",sets:3,baseReps:15,storagePath:"exercises/dumbbells/lower/weighted calf raises.GIF"},{name:"Bulgarian Split Squats",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/lower/bulgarian split squats.GIF"},{name:"Skater Jumps",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/lower/skater jumps.GIF"},{name:"Side Plank",type:"timed",sets:2,baseTime:25,storagePath:"exercises/bodyweight/core/Side Plank.mp4"}]}]}];function lh(n,e,t){const i=n.baseReps?n.baseReps+(e-1)*(t.repProg||0):void 0,l=n.baseTime?n.baseTime+(e-1)*(t.timeProg||0):void 0;return{sets:n.sets,reps:i,time:l}}const FD={fullbody:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm-2 8h4l1 4h2l-1 4h-2l-1 4h-2l-1-4H8l-1-4h2l1-4z",core:"M12 2a4 4 0 0 1 4 4v1h-2V6a2 2 0 1 0-4 0v1H8V6a4 4 0 0 1 4-4zM8 9h8v2H8V9zm-1 4h10l-1 9H8l-1-9z",upper:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm8 10l-3-1.5c-.5-.25-1-.5-1.5-.5h-7c-.5 0-1 .25-1.5.5L4 12l-2 6h4l1.5 4h9L18 18h4l-2-6z",lower:"M16.5 3A2.5 2.5 0 0 0 14 5.5 2.5 2.5 0 0 0 16.5 8 2.5 2.5 0 0 0 19 5.5 2.5 2.5 0 0 0 16.5 3zM14 9l-3 7h2l1 6h2l1-6h2l-3-7h-2z"};function zD(){const{currentUser:n,isClient:e,clientData:t,loading:i}=Vr(),{isDark:l,toggleTheme:u,accent:d}=Ea(),p=Gn(),g=Ta(),[y,w]=v.useState("loading"),[j,T]=v.useState(null),V=v.useRef(!1),[$,F]=v.useState(null),[U,te]=v.useState(!1),[K,re]=v.useState(1),[ye,ve]=v.useState(0),[ge,R]=v.useState(0),[E,A]=v.useState(0),[O,D]=v.useState([]),[H,I]=v.useState(""),[$e,xt]=v.useState(""),[W,he]=v.useState(!1),[Pe,He]=v.useState(0),ee=v.useRef(null),[L,se]=v.useState({}),[Le,Oe]=v.useState(!1),Ye=v.useRef(null),[Ue,pt]=v.useState(null),[Tt,at]=v.useState([]);v.useEffect(()=>{window.scrollTo(0,0)},[y]);const[Gt,zs]=v.useState(null),yt=v.useCallback((be,De="info")=>{zs({message:be,type:De}),setTimeout(()=>zs(null),4e3)},[]),ut=v.useRef(null),oe=()=>(ut.current||(ut.current=new(window.AudioContext||window.webkitAudioContext)),ut.current),ss=()=>{try{const be=oe(),De=be.createOscillator(),Y=be.createGain();De.connect(Y),Y.connect(be.destination),De.frequency.value=1200,Y.gain.value=.4,De.start(be.currentTime),De.stop(be.currentTime+.3)}catch{}};v.useEffect(()=>{!i&&(!n||!e)&&p("/")},[n,e,i,p]),v.useEffect(()=>{if(!t)return;(async()=>{try{const De=qe(fe,"clientProgrammes",t.id),Y=await As(De);Y.exists()&&F(Y.data());const we=g.state?.templateId;if(we&&!V.current){const Ce=C2.find(Me=>Me.id===we);if(Ce){V.current=!0,T(Ce),w("overview");return}}Y.exists()?w("dashboard"):p("/client/core-buddy/workouts",{replace:!0})}catch(De){console.error("Error loading programme:",De),p("/client/core-buddy/workouts",{replace:!0})}})()},[t]),v.useEffect(()=>{if(!W||Pe<=0){W&&Pe<=0&&(he(!1),ss());return}return ee.current=setTimeout(()=>He(be=>be-1),1e3),()=>clearTimeout(ee.current)},[W,Pe]);const Ht=async be=>{if(t)try{await Ns(qe(fe,"clientProgrammes",t.id),be),F(be)}catch(De){console.error("Error saving programme:",De),yt("Failed to save. Check Firestore rules for clientProgrammes.","error")}},Dt=async be=>{const De={templateId:be.id,startDate:wt.now(),completedSessions:{}};await Ht(De),w("dashboard")},bt=async()=>{if(t)try{await _r(qe(fe,"clientProgrammes",t.id)),F(null),w("browse")}catch(be){console.error("Error quitting programme:",be)}},Ge=()=>$?C2.find(be=>be.id===$.templateId):null,Ze=()=>{if(!$?.startDate)return 1;const be=$.startDate.toDate?$.startDate.toDate():new Date($.startDate),Y=new Date-be,we=Math.floor(Y/(1e3*60*60*24));return Math.floor(we/7)+1},Et=()=>{if(!$)return{currentWeek:1,completedThisWeek:0,nextDay:0,totalCompleted:0};const be=$.completedSessions||{},De=Object.keys(be).length,Y=Ge();if(!Y)return{currentWeek:1,completedThisWeek:0,nextDay:0,totalCompleted:0};const we=Y.duration*Y.daysPerWeek,Ce=Ze(),Me=Math.min(Ce,Y.duration);let Ae=0;for(let Qe=0;Qe<Y.daysPerWeek;Qe++)be[`w${Me}d${Qe}`]&&Ae++;if(De>=we)return{currentWeek:Y.duration,completedThisWeek:Y.daysPerWeek,nextDay:-1,totalCompleted:De,totalSessions:we,complete:!0};if(Ce>Y.duration)return{currentWeek:Y.duration,completedThisWeek:Ae,nextDay:-1,totalCompleted:De,totalSessions:we,complete:!0};let it=-1;for(let Qe=0;Qe<Y.daysPerWeek;Qe++)if(!be[`w${Me}d${Qe}`]){it=Qe;break}return{currentWeek:Me,completedThisWeek:Ae,nextDay:it,nextWeek:Me,totalCompleted:De,totalSessions:we}},rn=be=>{const De=Ze();return be<De},js=(be,De,Y)=>{if(!$||be<=1)return null;const we=`w${be-1}d${De}`,Ce=$.completedSessions?.[we];if(!Ce)return null;const Me=Ce.exercises?.find(Ae=>Ae.name===Y);return Me?.sets?.length?Me.sets[Me.sets.length-1]:null},Kt=(be,De)=>{const Y=Ge();if(!Y)return;re(be),ve(De),R(0),A(0),D([]),xt(""),he(!1),He(0),Oe(!1),se({});const we=Y.days[De],Ce=we.exercises.map(Qe=>{const Q=lh(Qe,be,Y);return{name:Qe.name,type:Qe.type,pbKey:Qe.pbKey,targetSets:Q.sets,targetReps:Q.reps,targetTime:Q.time,sets:[]}});D(Ce);const Me=we.exercises[0],Ae=js(be,De,Me.name);Ae?.weight&&Me.type==="weighted"?I(String(Ae.weight)):I(""),(async()=>{const Qe={};for(const Q of we.exercises)if(Q.storagePath)try{const ce=eo(to,Q.storagePath),ze=await qo(ce);Qe[Q.name]={url:ze,isGif:/\.gif$/i.test(Q.storagePath)}}catch(ce){console.warn(`Video not found for ${Q.name}:`,ce)}se(Qe)})(),w("session")},St=async()=>{Ge();const be=O[ge];if(!be)return;let De={};if(be.type==="weighted"){const Ce=parseFloat(H)||0,Me=parseInt($e)||0;if(Me===0){yt("Enter your reps","error");return}De={weight:Ce,reps:Me}}else if(be.type==="reps"){const Ce=parseInt($e)||0;if(Ce===0){yt("Enter your reps","error");return}De={reps:Ce}}else if(be.type==="timed"){const Ce=be.targetTime-Pe;De={time:Math.max(Ce,1)}}const Y=[...O];Y[ge]={...be,sets:[...be.sets,De]},D(Y),be.type==="weighted"&&De.weight>0&&await es(be.name,De.weight,De.reps);const we=be.sets.length+1;if(we<be.targetSets)A(we),I(De.weight?String(De.weight):""),xt(""),he(!1),He(0);else if(ge+1<O.length){const Ce=ge+1;R(Ce),A(0),Oe(!1);const Ae=Ge()?.days[ye]?.exercises[Ce],it=js(K,ye,Ae?.name);it?.weight&&Ae?.type==="weighted"?I(String(it.weight)):I(""),xt(""),he(!1),He(0)}else await Yt(Y)},Yt=async be=>{if(!$||!t)return;const De=`w${K}d${ye}`,Y={...$.completedSessions,[De]:{completedAt:new Date().toISOString(),exercises:be.map(Me=>({name:Me.name,type:Me.type,sets:Me.sets}))}},we={...$,completedSessions:Y};await Ht(we);const Ce=be.reduce((Me,Ae)=>Me+Ae.sets.reduce((it,Qe)=>it+(Qe.weight||0)*(Qe.reps||0),0),0);Ce>0&&await us(Ce);try{const Me=Ge();await mi(Ft(fe,"workoutLogs"),{clientId:t.id,type:"programme",programmeId:Me?.id,programmeName:Me?.name,week:K,day:ye+1,exerciseCount:be.length,duration:Math.round(be.reduce((Ae,it)=>Ae+it.sets.length*1.5,0)),volume:Math.round(Ce),completedAt:wt.now()})}catch(Me){console.error("Error saving workout log:",Me)}Tt.length>0&&(pt({badges:[...Tt]}),at([])),te(!0)},us=async be=>{if(t)try{const De=await As(qe(fe,"coreBuddyAchievements",t.id)),Y=De.exists()?De.data():{clientId:t.id,badges:[],totalVolume:0},we=Y.totalVolume||0,Ce=we+be,Me=[];UD.forEach(it=>{Ce>=it.threshold&&we<it.threshold&&(Y.badges.some(Q=>Q.type==="volume_milestone"&&Q.milestone===it.threshold)||Me.push({type:"volume_milestone",milestone:it.threshold,label:it.label,achievedAt:wt.now()}))});const Ae=[...Y.badges,...Me];await Ns(qe(fe,"coreBuddyAchievements",t.id),{clientId:t.id,badges:Ae,totalVolume:Math.round(Ce),updatedAt:wt.now()}),Me.length>0&&at(it=>[...it,...Me])}catch(De){console.error("Error updating volume:",De)}},es=async(be,De,Y)=>{if(t)try{const we=t.id,Ce=await As(qe(fe,"coreBuddyPBs",we)),Ae=(Ce.exists()?Ce.data():null)?.exercises||{},it=Ae[be];let Qe=!1;if(it?(De>(it.weight||0)||De===(it.weight||0)&&Y>(it.reps||0))&&(Qe=!0):Qe=!0,Qe){const Q={...Ae,[be]:{weight:De,reps:Y,achievedAt:wt.now()}};await Ns(qe(fe,"coreBuddyPBs",we),{clientId:t.id,exercises:Q,updatedAt:wt.now()}),yt(`New PB! ${De}kg  ${Y} reps`,"success"),ss(),await Xs(be,De)}}catch(we){console.error("Error checking PB:",we)}},Xs=async(be,De)=>{if(t)try{const Y=await As(qe(fe,"coreBuddyTargets",t.id));if(!Y.exists())return;const Ce=(Y.data().targets||{})[be];if(!Ce||De<Ce.targetWeight)return;const Me=await As(qe(fe,"coreBuddyAchievements",t.id)),Ae=Me.exists()?Me.data():{clientId:t.id,badges:[],totalVolume:0};if(Ae.badges.some(ce=>ce.type==="pb_target"&&ce.exercise===be&&ce.targetWeight===Ce.targetWeight))return;const Qe={type:"pb_target",exercise:be,group:BD[be]||"push",targetWeight:Ce.targetWeight,achievedAt:wt.now()},Q=[...Ae.badges,Qe];await Ns(qe(fe,"coreBuddyAchievements",t.id),{...Ae,badges:Q,updatedAt:wt.now()}),at(ce=>[...ce,Qe])}catch(Y){console.error("Error checking target badge:",Y)}},Nt=Gt&&r.jsxs("div",{className:`toast-notification ${Gt.type}`,children:[Gt.type==="success"&&r.jsx("span",{children:" "}),Gt.message]}),ps=(be,De)=>r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:De,"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})});if(i||y==="loading")return r.jsx("div",{className:"cb-loading",children:r.jsx("div",{className:"cb-loading-spinner"})});if(y==="browse")return p("/client/core-buddy/workouts",{replace:!0}),null;if(y==="overview"&&j){const be=j;return r.jsx(ka,{children:r.jsxs("div",{className:"pg-page","data-theme":l?"dark":"light","data-accent":d,children:[ps(be.name,()=>p("/client/core-buddy/workouts")),r.jsxs("main",{className:"pg-main",children:[r.jsxs("div",{className:"pg-overview-hero",children:[r.jsx("svg",{className:"pg-overview-icon",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:FD[be.focus]})}),r.jsx("h2",{className:"pg-overview-name",children:be.name}),r.jsx("p",{className:"pg-overview-desc",children:be.description}),r.jsxs("div",{className:"pg-overview-stats",children:[r.jsxs("div",{className:"pg-ov-stat",children:[r.jsx("span",{className:"pg-ov-stat-num",children:be.duration}),r.jsx("span",{className:"pg-ov-stat-label",children:"Weeks"})]}),r.jsxs("div",{className:"pg-ov-stat",children:[r.jsx("span",{className:"pg-ov-stat-num",children:be.daysPerWeek}),r.jsx("span",{className:"pg-ov-stat-label",children:"Days/Week"})]}),r.jsxs("div",{className:"pg-ov-stat",children:[r.jsx("span",{className:"pg-ov-stat-num",children:be.duration*be.daysPerWeek}),r.jsx("span",{className:"pg-ov-stat-label",children:"Sessions"})]})]})]}),r.jsx("div",{className:"pg-overview-days",children:be.days.map((De,Y)=>r.jsxs("div",{className:"pg-day-card",children:[r.jsxs("div",{className:"pg-day-header",children:[r.jsx("span",{className:"pg-day-name",children:De.name}),r.jsx("span",{className:"pg-day-label",children:De.label})]}),r.jsx("div",{className:"pg-day-exercises",children:De.exercises.map((we,Ce)=>{const Me=lh(we,1,be);return r.jsxs("div",{className:"pg-day-ex",children:[r.jsx("span",{className:"pg-day-ex-name",children:we.name}),r.jsx("span",{className:"pg-day-ex-target",children:we.type==="timed"?`${Me.sets}${Me.time}s`:`${Me.sets}${Me.reps}`}),r.jsx("span",{className:`pg-day-ex-badge pg-badge-${we.type}`,children:we.type==="weighted"?"WT":we.type==="timed"?"TMR":"BW"})]},Ce)})})]},Y))}),r.jsxs("div",{className:"pg-overview-note",children:[r.jsx("strong",{children:"Progressive Overload:"})," +",be.repProg," reps/week",be.timeProg?`, +${be.timeProg}s/week for timed`:""]}),r.jsx("button",{className:"pg-start-btn",onClick:()=>Dt(be),children:"Start Programme"})]}),Nt]})})}if(y==="dashboard"){const be=Ge();if(!be)return w("browse"),null;const De=Et(),Y=$?.completedSessions||{},we=De.totalSessions?Math.round(De.totalCompleted/De.totalSessions*100):0;return Math.round(De.totalCompleted/(De.totalSessions||1)*VD),r.jsx(ka,{children:r.jsxs("div",{className:"pg-page","data-theme":l?"dark":"light","data-accent":d,children:[ps("Programme",()=>p("/client/core-buddy/workouts")),r.jsxs("main",{className:"pg-main",children:[r.jsxs("div",{className:"pg-dash-hero",children:[r.jsxs("div",{className:"pg-dash-ring-wrap",children:[r.jsxs("svg",{viewBox:"0 0 200 200",children:[r.jsx("circle",{className:"pg-arc-track",cx:"100",cy:"100",r:"80"}),r.jsx("circle",{className:"pg-arc-fill",cx:"100",cy:"100",r:"80",strokeDasharray:2*Math.PI*80,strokeDashoffset:2*Math.PI*80-we/100*2*Math.PI*80})]}),r.jsxs("div",{className:"pg-ring-center",children:[r.jsxs("span",{className:"pg-ring-pct",children:[we,"%"]}),r.jsx("span",{className:"pg-ring-label",children:"complete"})]})]}),r.jsx("h2",{className:"pg-dash-name",children:be.name}),r.jsxs("div",{className:"pg-dash-progress-text",children:[r.jsxs("span",{className:"pg-dash-pct",children:[we,"%"]}),r.jsxs("span",{className:"pg-dash-week",children:["Week ",De.currentWeek," of ",be.duration]})]})]}),r.jsx("div",{className:"pg-weeks",children:Array.from({length:be.duration},(Ce,Me)=>{const Ae=Me+1,it=rn(Ae);return r.jsxs("div",{className:`pg-week-row${Ae===De.currentWeek?" pg-week-current":""}`,children:[r.jsxs("span",{className:"pg-week-label",children:["W",Ae]}),r.jsx("div",{className:"pg-week-days",children:be.days.map((Qe,Q)=>{const ce=`w${Ae}d${Q}`,ze=!!Y[ce],dt=!ze&&it,ht=!ze&&!dt&&Ae===De.currentWeek&&!De.complete;return r.jsx("button",{className:`pg-day-dot${ze?" done":""}${dt?" missed":""}${ht?" next":""}`,disabled:!ht,onClick:()=>{ht&&Kt(Ae,Q)},children:ze?r.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:r.jsx("path",{d:"M20 6L9 17l-5-5"})}):dt?r.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]}):r.jsx("span",{children:Qe.name.replace("Day ","")})},Q)})})]},Me)})}),!De.complete&&(()=>{const Ce=be.days.map((Me,Ae)=>({day:Me,d:Ae})).filter(({d:Me})=>!Y[`w${De.currentWeek}d${Me}`]);return Ce.length===0?null:r.jsxs("div",{className:"pg-next-session",children:[r.jsx("h3",{children:Ce.length===be.daysPerWeek?"Choose a Session":"Remaining Sessions"}),r.jsxs("p",{className:"pg-next-info",children:["Week ",De.currentWeek,"  ",Ce.length," session",Ce.length!==1?"s":""," left this week"]}),Ce.map(({day:Me,d:Ae})=>r.jsxs("div",{className:"pg-available-session",children:[r.jsxs("div",{className:"pg-next-exercises",children:[r.jsxs("span",{className:"pg-avail-day-label",children:[Me.name,": ",Me.label]}),Me.exercises.map((it,Qe)=>{const Q=lh(it,De.currentWeek,be);return r.jsxs("div",{className:"pg-next-ex",children:[r.jsx("span",{className:"pg-next-ex-name",children:it.name}),r.jsx("span",{className:"pg-next-ex-target",children:it.type==="timed"?`${Q.sets}${Q.time}s`:`${Q.sets}${Q.reps}`})]},Qe)})]}),r.jsxs("button",{className:"pg-start-btn",onClick:()=>Kt(De.currentWeek,Ae),children:["Start ",Me.name]})]},Ae))]})})(),De.complete&&r.jsxs("div",{className:"pg-complete-msg",children:[r.jsx("h3",{children:"Programme Complete! "}),r.jsxs("p",{children:["You finished all ",De.totalSessions," sessions."]}),r.jsx("button",{className:"pg-start-btn",onClick:bt,children:"Choose New Programme"})]}),r.jsx("button",{className:"pg-quit-btn",onClick:()=>{confirm("Quit this programme? Progress will be lost.")&&bt()},children:"Quit Programme"})]}),r.jsx(la,{active:"workouts"}),Nt]})})}if(y==="session"){const be=Ge();if(!be)return null;const De=be.days[ye],Y=De.exercises[ge],we=lh(Y,K,be),Ce=O[ge],Me=Ce?.sets?.length||0,Ae=De.exercises.length,it=(ge+Me/we.sets)/Ae,Qe=L[Y.name],Q=js(K,ye,Y.name);Y.type==="timed"&&Pe===0&&!W&&Me===E&&setTimeout(()=>He(we.time),0);const ce=()=>{Qe?.isGif?Oe(!Le):Ye.current&&(Le?Ye.current.pause():Ye.current.play(),Oe(!Le))};return r.jsxs("div",{className:"pg-page pg-page-session","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("div",{className:"pg-session-progress",children:r.jsx("div",{className:"pg-session-progress-fill",style:{width:`${it*100}%`}})}),r.jsxs("div",{className:"pg-session-header",children:[r.jsx("button",{className:"pg-session-back",onClick:()=>{confirm("Leave session? Progress will be lost.")&&w("dashboard")},children:r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M19 12H5M12 5l-7 7 7 7"})})}),r.jsxs("div",{className:"pg-session-title",children:[r.jsxs("span",{className:"pg-session-counter",children:[ge+1," / ",Ae]}),r.jsxs("span",{className:"pg-session-week",children:["Week ",K,"  ",De.name]})]})]}),Qe&&r.jsxs("div",{className:"pg-video-container",onClick:ce,children:[Qe.isGif?r.jsx("img",{className:"pg-video",src:Qe.url,alt:Y.name}):r.jsx("video",{ref:Ye,className:"pg-video",src:Qe.url,loop:!0,muted:!0,playsInline:!0},Y.name),!Le&&r.jsxs("div",{className:"pg-video-overlay",children:[r.jsx("svg",{className:"pg-play-icon",viewBox:"0 0 24 24",fill:"white",children:r.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})}),r.jsx("span",{className:"pg-video-hint",children:"Tap for demo"})]})]}),r.jsx("div",{className:"pg-spotify",children:r.jsx("iframe",{src:"https://open.spotify.com/embed/playlist/37i9dQZF1DZ06evO3FJyYF?utm_source=generator&theme=0",width:"100%",height:"80",frameBorder:"0",allow:"autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture",loading:"lazy",title:"Spotify Playlist"})}),r.jsxs("div",{className:"pg-exercise-card",children:[r.jsx("h2",{className:"pg-ex-name",children:Y.name}),r.jsx("span",{className:`pg-ex-type-badge pg-badge-${Y.type}`,children:Y.type==="weighted"?"Weight + Reps":Y.type==="timed"?"Timed":"Reps Only"}),Y.type==="weighted"&&Q&&r.jsxs("div",{className:"pg-last-week",children:[r.jsx("span",{className:"pg-last-week-label",children:"Last week:"}),r.jsxs("span",{className:"pg-last-week-value",children:[Q.weight,"kg x ",Q.reps," reps"]})]}),r.jsxs("div",{className:"pg-ex-set-info",children:[r.jsxs("span",{className:"pg-ex-set-num",children:["Set ",Me+1," of ",we.sets]}),r.jsxs("span",{className:"pg-ex-target",children:["Target: ",Y.type==="timed"?`${we.time}s hold`:`${we.reps} reps`]})]}),Y.type==="weighted"&&r.jsxs("div",{className:"pg-input-area",children:[r.jsxs("div",{className:"pg-input-group",children:[r.jsx("label",{children:"Weight (kg)"}),r.jsx("input",{type:"number",inputMode:"decimal",value:H,onChange:ze=>I(ze.target.value),placeholder:"0",className:"pg-input"})]}),r.jsxs("div",{className:"pg-input-group",children:[r.jsx("label",{children:"Reps"}),r.jsx("input",{type:"number",inputMode:"numeric",value:$e,onChange:ze=>xt(ze.target.value),placeholder:String(we.reps),className:"pg-input"})]})]}),Y.type==="reps"&&r.jsx("div",{className:"pg-input-area",children:r.jsxs("div",{className:"pg-input-group pg-input-single",children:[r.jsx("label",{children:"Reps"}),r.jsx("input",{type:"number",inputMode:"numeric",value:$e,onChange:ze=>xt(ze.target.value),placeholder:String(we.reps),className:"pg-input"})]})}),Y.type==="timed"&&r.jsxs("div",{className:"pg-timer-area",children:[r.jsx("div",{className:"pg-timer-display",children:r.jsxs("span",{className:"pg-timer-value",children:[Pe,"s"]})}),W?r.jsx("button",{className:"pg-timer-btn pg-timer-stop",onClick:()=>he(!1),children:"Stop"}):r.jsx("button",{className:"pg-timer-btn",onClick:()=>{Pe===0&&He(we.time),he(!0)},children:Pe<we.time&&Pe>0?"Resume":"Start Timer"})]}),r.jsx("button",{className:"pg-log-set-btn",onClick:St,disabled:Y.type==="timed"&&W,children:Me+1<we.sets?"Log Set":ge+1<Ae?"Log Set  Next Exercise":"Log Set  Complete"}),Ce?.sets?.length>0&&r.jsx("div",{className:"pg-completed-sets",children:Ce.sets.map((ze,dt)=>r.jsxs("div",{className:"pg-completed-set",children:[r.jsx("span",{className:"pg-completed-set-check",children:""}),r.jsxs("span",{children:["Set ",dt+1,": ",ze.weight!==void 0?`${ze.weight}kg  ${ze.reps}`:ze.time!==void 0?`${ze.time}s`:`${ze.reps} reps`]})]},dt))})]}),U&&(()=>{const dt=Ge()?.days[ye],ht=O.reduce((At,Ms)=>At+Ms.sets.length,0),Vt=O.reduce((At,Ms)=>At+Ms.sets.reduce((Js,ns)=>Js+(ns.weight||0)*(ns.reps||0),0),0),Ct=[{value:O.length,label:"Exercises"},{value:ht,label:"Sets"}];return Vt>0&&Ct.push({value:Math.round(Vt).toLocaleString(),label:"Volume (kg)"}),r.jsx(Ig,{title:"Session Complete!",subtitle:`Week ${K}  ${dt?.name}: ${dt?.label}`,stats:Ct,buttonLabel:"Back to Programme",onDone:()=>{te(!1),w("dashboard")}})})(),Ue&&r.jsx("div",{className:"pg-badge-celebration",onClick:()=>pt(null),children:r.jsxs("div",{className:"pg-badge-celebration-card",onClick:ze=>ze.stopPropagation(),children:[r.jsx("div",{className:"pg-badge-celebration-icon",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),r.jsx("h3",{className:"pg-badge-celebration-title",children:Ue.badges.length===1?"Badge Earned!":`${Ue.badges.length} Badges Earned!`}),r.jsx("div",{className:"pg-badge-celebration-list",children:Ue.badges.map((ze,dt)=>r.jsx("div",{className:"pg-badge-celebration-item",children:ze.type==="pb_target"?`${ze.exercise}  ${ze.targetWeight}kg`:ze.label},dt))}),r.jsx("button",{className:"pg-badge-celebration-dismiss",onClick:()=>pt(null),children:"Tap to dismiss"})]})}),Nt]})}return null}const qD={"Dumbbell Floor Press":"push","Seated Dumbbell Shoulder Press":"push","Seated Dumbbell Arnold Press":"push","Dumbbell Overhead Tricep Extension":"push",Skullcrushers:"push","Dumbbell Lateral Raise":"push","Dumbbell Front Raise":"push","Dumbbell Bent Over Row":"pull","Single Arm Bent Over Row":"pull","Bicep Curl":"pull","Hammer Curl":"pull","Dumbbell Bent Over Rear Delt Fly":"pull","Renegade Row":"pull","Dumbbell Goblet Squats":"lower","Romanian Deadlifts":"lower","Forward Dumbbell Lunges":"lower","Dumbbell Sumo Squats":"lower","Weighted Calf Raises":"lower","1 Legged RDL":"lower","Dumbbell Box Step Ups":"lower","Dumbbell Squat Pulses":"lower","Dumbbell Reverse Lunges":"lower","Kettlebell Romanian Deadlift":"lower","Russian Twists Dumbbell":"core","Kettlebell Russian Twist":"core","Kettlebell Side Bends":"core","Kneeling Kettlebell Halo":"core"},HD={push:{label:"Push",color:"#c75f6b",icon:"M4 12h3l3-9 4 18 3-9h3"},pull:{label:"Pull",color:"#5f8ac7",icon:"M12 2v10m0 0l-4-4m4 4l4-4M4 20h16"},lower:{label:"Lower",color:"#5fc77a",icon:"M12 2v8m-4 4l4 8 4-8m-8 0h8"},core:{label:"Core",color:"#c7a45f",icon:"M12 2a4 4 0 014 4v1h-2V6a2 2 0 10-4 0v1H8V6a4 4 0 014-4zM8 9h8v2H8V9zm-1 4h10l-1 9H8l-1-9z"}},Qp=[{threshold:1e3,label:"1 Tonne",icon:"1T"},{threshold:5e3,label:"5 Tonne",icon:"5T"},{threshold:1e4,label:"10 Tonne",icon:"10T"},{threshold:25e3,label:"25 Tonne",icon:"25T"},{threshold:5e4,label:"50 Tonne",icon:"50T"},{threshold:1e5,label:"100 Tonne",icon:"100T"},{threshold:25e4,label:"250 Tonne",icon:"250T"},{threshold:5e5,label:"500 Tonne",icon:"500T"},{threshold:1e6,label:"1 Million kg",icon:"1M"}];function $D(n){return qD[n]||"push"}function WD(n){return n>=1e6?`${(n/1e6).toFixed(1)}M`:n>=1e3?`${(n/1e3).toFixed(1)}T`:`${Math.round(n)}`}function GD(n){return n>=1e6?"million kg":n>=1e3?"tonnes":"kg"}function KD(){const{currentUser:n,isClient:e,clientData:t,loading:i}=Vr(),{isDark:l,toggleTheme:u,accent:d}=Ea(),p=Gn(),[g,y]=v.useState(!0),[w,j]=v.useState(null),[T,V]=v.useState({}),[$,F]=v.useState([]),[U,te]=v.useState(null),[K,re]=v.useState(0),[ye,ve]=v.useState({});v.useRef(null),v.useEffect(()=>{!i&&(!n||!e)&&p("/")},[n,e,i,p]),v.useEffect(()=>{if(!t)return;(async()=>{try{const[he,Pe,He,ee]=await Promise.all([As(qe(fe,"coreBuddyAchievements",t.id)),As(qe(fe,"coreBuddyPBs",t.id)),As(qe(fe,"achievements",t.id)),Ss(Ps(Ft(fe,"workoutLogs"),fs("clientId","==",t.id)))]);he.exists()&&j(he.data()),Pe.exists()&&V(Pe.data().exercises||{}),He.exists()&&(F(Object.keys(He.data().badges||{})),ve(He.data().progress||{})),re(ee.docs.length)}catch(he){console.error("Error loading achievements:",he)}y(!1)})()},[t]);const ge=w?.badges||[],R=w?.totalVolume||0,E=ge.filter(W=>W.type==="pb_target"),A=ge.filter(W=>W.type==="volume_milestone"),O={push:[],pull:[],lower:[],core:[]};E.forEach(W=>{const he=W.group||$D(W.exercise);O[he]&&O[he].push(W)});const D=Qp.find(W=>R<W.threshold),H=Qp.filter(W=>R>=W.threshold).pop()?.threshold||0,I=D?(R-H)/(D.threshold-H):1;if(i||g)return r.jsxs("div",{className:"ach-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsx("div",{className:"header-content",children:r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})})}),r.jsx("div",{className:"ach-loading-inline",children:r.jsx("div",{className:"cb-loading-spinner"})})]});const $e=ge.length+$.length,xt=$e>0||R>0||K>0;return r.jsx(ka,{children:r.jsxs("div",{className:"ach-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),r.jsxs("main",{className:"ach-main",children:[r.jsx("button",{className:"nut-back-btn",onClick:()=>p("/client/personal-bests?mode=corebuddy"),children:" Back"}),r.jsxs("div",{className:"ach-stats-banner",children:[r.jsxs("div",{className:"ach-stat-item",children:[r.jsx("span",{className:"ach-stat-num",children:$e}),r.jsx("span",{className:"ach-stat-label",children:$e===1?"Badge":"Badges"})]}),r.jsx("div",{className:"ach-stat-divider"}),r.jsxs("div",{className:"ach-stat-item",children:[r.jsx("span",{className:"ach-stat-num",children:WD(R)}),r.jsxs("span",{className:"ach-stat-label",children:[GD(R)," lifted"]})]}),r.jsx("div",{className:"ach-stat-divider"}),r.jsxs("div",{className:"ach-stat-item",children:[r.jsx("span",{className:"ach-stat-num",children:Object.keys(T).length}),r.jsx("span",{className:"ach-stat-label",children:"PBs"})]})]}),!xt&&r.jsxs("div",{className:"ach-empty",children:[r.jsx("div",{className:"ach-empty-icon",children:r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[r.jsx("path",{d:"M12 15l-3-3h6l-3 3z"}),r.jsx("path",{d:"M5 7h14l-1.5 9h-11L5 7z"}),r.jsx("path",{d:"M8.5 7V5a3.5 3.5 0 017 0v2"})]})}),r.jsx("h4",{children:"No achievements yet"}),r.jsx("p",{children:"Complete workouts to track volume and set PB targets to start earning badges."})]}),[{key:"workouts",title:"Workout Badges",iconPath:"M20.57 14.86L22 13.43 20.57 12 17 15.57 8.43 7 12 3.43 10.57 2 9.14 3.43 7.71 2 5.57 4.14 4.14 2.71 2.71 4.14l1.43 1.43L2 7.71l1.43 1.43L2 10.57 3.43 12 7 8.43 15.57 17 12 20.57 13.43 22l1.43-1.43L16.29 22l2.14-2.14 1.43 1.43 1.43-1.43-1.43-1.43L22 16.29z"},{key:"streaks",title:"Streak Badges",iconPath:"M13.5.67s.74 2.65.74 4.8c0 2.06-1.35 3.73-3.41 3.73-2.07 0-3.63-1.67-3.63-3.73l.03-.36C5.21 7.51 4 10.62 4 14c0 4.42 3.58 8 8 8s8-3.58 8-8C20 8.61 17.41 3.8 13.5.67z"},{key:"pbs",title:"Personal Best Badges",iconPath:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"},{key:"nutrition",title:"Nutrition Badges",iconPath:"M18.06 23h1.66c.84 0 1.53-.65 1.63-1.47L23 5.05h-5V1h-2v4.05h-5l.3 2.34c1.71.47 3.31 1.32 4.27 2.26 1.44 1.42 2.43 2.89 2.43 5.29V23zM1 22v-1h15.03v1c0 .55-.45 1-1.01 1H2.01c-.56 0-1.01-.45-1.01-1zm15.03-7c0-4.87-4.66-5.84-8.03-5.97l.72 5.52L1 15.05v5.95h15.03V15z"},{key:"habits",title:"Habit Badges",iconPath:"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z"},{key:"leaderboard",title:"Leaderboard Badges",iconPath:"M7.5 21H2V9h5.5v12zm7.25-18h-5.5v18h5.5V3zM22 11h-5.5v10H22V11z"}].map(W=>{const he=mu.filter(ee=>ee.category===W.key);if(he.length===0)return null;const Pe=(()=>{switch(W.key){case"workouts":return K;case"streaks":return ye.streakWeeks||0;case"pbs":return Object.keys(T).length;case"nutrition":return ye.nutritionStreak||0;case"leaderboard":return t?.leaderboardOptIn?1:0;case"habits":return ye.habitStreak||0;default:return 0}})(),He=he.filter(ee=>$.includes(ee.id)).length;return r.jsxs("div",{className:"ach-section",children:[r.jsxs("h3",{className:"ach-section-title",children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20",children:r.jsx("path",{d:W.iconPath})}),W.title]}),r.jsx("div",{className:"ach-workout-carousel",children:he.map(ee=>{const L=$.includes(ee.id);return r.jsxs("button",{className:`ach-workout-badge${L?" unlocked":" locked"}`,onClick:()=>te(ee),children:[r.jsx("img",{src:ee.img,alt:ee.name,className:"ach-workout-badge-img"}),!L&&ee.threshold&&r.jsx("div",{className:"ach-workout-badge-progress",children:r.jsx("div",{className:"ach-workout-badge-progress-fill",style:{width:`${Math.min(Pe/ee.threshold*100,100)}%`}})})]},ee.id)})}),r.jsxs("p",{className:"ach-workout-badges-count",children:[He,"/",he.length," unlocked"]})]},W.key)}),U&&r.jsx("div",{className:"ach-badge-overlay",onClick:()=>te(null),children:r.jsxs("div",{className:"ach-badge-overlay-content",onClick:W=>W.stopPropagation(),children:[r.jsx("img",{src:U.img,alt:U.name,className:`ach-badge-overlay-img${$.includes(U.id)?"":" ach-badge-overlay-img-locked"}`}),r.jsx("p",{className:"ach-badge-overlay-desc",children:U.desc}),$.includes(U.id)?r.jsx("span",{className:"ach-badge-overlay-status unlocked",children:"Unlocked"}):r.jsx("span",{className:"ach-badge-overlay-status locked",children:"Locked"}),r.jsx("button",{className:"ach-badge-overlay-close",onClick:()=>te(null),children:"Tap to close"})]})}),r.jsxs("div",{className:"ach-section",children:[r.jsxs("h3",{className:"ach-section-title",children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20",children:r.jsx("path",{d:"M20.57 14.86L22 13.43 20.57 12 17 15.57 8.43 7 12 3.43 10.57 2 9.14 3.43 7.71 2 5.57 4.14 4.14 2.71 2.71 4.14l1.43 1.43L2 7.71l1.43 1.43L2 10.57 3.43 12 7 8.43 15.57 17 12 20.57 13.43 22l1.43-1.43L16.29 22l2.14-2.14 1.43 1.43 1.43-1.43-1.43-1.43L22 16.29z"})}),"Volume Milestones"]}),r.jsxs("div",{className:"ach-volume-hero",children:[r.jsxs("div",{className:"ach-volume-ring",children:[r.jsx("svg",{className:"ach-volume-ring-svg",viewBox:"0 0 200 200",children:Fk.map((W,he)=>{const Pe=he<Math.round(I*60);return r.jsx("line",{x1:W.x1,y1:W.y1,x2:W.x2,y2:W.y2,className:Pe?"ach-tick-filled":"ach-tick-empty",strokeWidth:W.thick?"3":"2"},he)})}),r.jsxs("div",{className:"ach-volume-center",children:[r.jsx("span",{className:"ach-volume-number",children:Math.round(R).toLocaleString()}),r.jsx("span",{className:"ach-volume-unit",children:"kg lifted"})]})]}),D&&r.jsxs("div",{className:"ach-volume-next",children:["Next: ",r.jsx("strong",{children:D.label})," (",(D.threshold-R).toLocaleString(),"kg to go)"]})]}),r.jsx("div",{className:"ach-milestone-shelf",children:Qp.map((W,he)=>{const Pe=R>=W.threshold,He=A.find(ee=>ee.milestone===W.threshold);return r.jsxs("div",{className:`ach-milestone ${Pe?"unlocked":"locked"}`,children:[r.jsx("div",{className:"ach-milestone-hex",children:r.jsx("span",{className:"ach-milestone-icon",children:W.icon})}),r.jsx("span",{className:"ach-milestone-label",children:W.label}),He?.achievedAt&&r.jsx("span",{className:"ach-milestone-date",children:(He.achievedAt.toDate?He.achievedAt.toDate():new Date(He.achievedAt)).toLocaleDateString("en-GB",{day:"numeric",month:"short"})})]},he)})})]}),r.jsxs("div",{className:"ach-section",children:[r.jsxs("h3",{className:"ach-section-title",children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),"PB Target Badges"]}),E.length===0?r.jsx("div",{className:"ach-pb-empty",children:r.jsxs("p",{children:["Set targets on your personal bests to start earning badges. Go to ",r.jsx("strong",{children:"My Progress"}),' and tap "Set Target" on any PB.']})}):Object.entries(O).map(([W,he])=>{if(he.length===0)return null;const Pe=HD[W];return r.jsxs("div",{className:"ach-group",children:[r.jsxs("div",{className:"ach-group-header",style:{borderLeftColor:Pe.color},children:[r.jsx("span",{className:"ach-group-label",style:{color:Pe.color},children:Pe.label}),r.jsx("span",{className:"ach-group-count",children:he.length})]}),r.jsx("div",{className:"ach-badge-grid",children:he.map((He,ee)=>r.jsxs("div",{className:"ach-badge-card",style:{animationDelay:`${ee*.06}s`,"--group-color":Pe.color},children:[r.jsx("div",{className:"ach-badge-hex",style:{borderColor:Pe.color,boxShadow:`0 0 12px ${Pe.color}33`},children:r.jsx("svg",{className:"ach-badge-hex-icon",viewBox:"0 0 24 24",fill:"none",stroke:Pe.color,strokeWidth:"2",strokeLinecap:"round",children:r.jsx("path",{d:Pe.icon})})}),r.jsxs("div",{className:"ach-badge-info",children:[r.jsx("span",{className:"ach-badge-exercise",children:He.exercise}),r.jsxs("span",{className:"ach-badge-value",style:{color:Pe.color},children:[He.targetWeight,"kg"]}),He.achievedAt&&r.jsx("span",{className:"ach-badge-date",children:(He.achievedAt.toDate?He.achievedAt.toDate():new Date(He.achievedAt)).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"})})]})]},ee))})]},W)})]})]}),r.jsx(la,{active:"home"})]})})}const YD=[{key:"trained",label:"Trained",icon:"M4 10v4M8 7v10M8 12h8M16 7v10M20 10v4",color:"#A12F3A"},{key:"protein",label:"Hit Protein",icon:"M12 22c5.52 0 10-4.48 10-10S17.52 2 12 2 2 6.48 2 12s4.48 10 10 10zM12 18c3.31 0 6-2.69 6-6s-2.69-6-6-6-6 2.69-6 6 2.69 6 6 6zM12 14a2 2 0 1 0 0-4 2 2 0 0 0 0 4z",color:"#4caf50"},{key:"steps",label:"10k Steps",icon:"M4 19.5A2.5 2.5 0 0 1 6.5 17H20M4 12.5A2.5 2.5 0 0 1 6.5 10H20M4 5.5A2.5 2.5 0 0 1 6.5 3H20",color:"#ff9800"},{key:"sleep",label:"8hrs Sleep",icon:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z",color:"#7c3aed"},{key:"water",label:"2L Water",icon:"M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z",color:"#2196f3"}],QD="M12 2l2.4 7.2L22 12l-7.6 2.8L12 22l-2.4-7.2L2 12l7.6-2.8z",XD="#e91e63",JD=700,Dg=42,Ll=2*Math.PI*Dg,ch=["Every day counts. See you tomorrow!","Consistency is your superpower.","Perfect day  keep the streak alive!","You showed up for yourself today."];function ZD(n){const e=new Date(n),t=e.getDay(),i=t===0?-6:1-t;return e.setDate(e.getDate()+i),e.setHours(0,0,0,0),e}function Xp(n){return n.toISOString().split("T")[0]}function eP(n){return Array.from({length:7},(e,t)=>{const i=new Date(n);return i.setDate(n.getDate()+t),i})}function tP(){const{currentUser:n,isClient:e,clientData:t,loading:i}=Vr(),{isDark:l,toggleTheme:u,accent:d}=Ea(),p=Gn(),[g,y]=v.useState({}),[w,j]=v.useState([]),[T,V]=v.useState(!0),[$,F]=v.useState(!1),[U,te]=v.useState(0),[K,re]=v.useState(null),[ye,ve]=v.useState(null),[ge,R]=v.useState(!1),[E,A]=v.useState(!1),[O,D]=v.useState(!1),[H,I]=v.useState(!1),[$e,xt]=v.useState(""),[W,he]=v.useState(null),[Pe,He]=v.useState([]),[ee,L]=v.useState(null),se=v.useRef(null),Le=v.useRef(null),Oe=v.useRef(null),Ye=v.useRef(null),Ue=v.useRef(!1),pt=v.useRef({}),Tt=v.useRef([]),at=v.useRef([]),Gt=v.useRef(null),zs=v.useRef(ch[Math.floor(Math.random()*ch.length)]),yt=v.useCallback((Y,we="info")=>{re({message:Y,type:we}),setTimeout(()=>re(null),3e3)},[]),ut=new Date,oe=Xp(ut),ss=ZD(ut),Ht=eP(ss),Dt=["M","T","W","T","F","S","S"],bt=[...YD.filter(Y=>!Pe.includes(Y.key)),...w.map(Y=>({key:`custom_${Y.id}`,label:Y.label,icon:QD,color:XD,isCustom:!0,id:Y.id}))];v.useEffect(()=>{!i&&(!n||!e)&&p("/")},[n,e,i,p]),v.useEffect(()=>{if(!n||!t)return;(async()=>{try{const we=Ft(fe,"habitLogs"),Ce=Ps(we,fs("clientId","==",t.id)),Me=await Ss(Ce),Ae={};Me.docs.forEach(ce=>{const ze=ce.data();Ae[ze.date]={...ze,_id:ce.id}}),y(Ae);const it=await As(qe(fe,"customHabits",t.id));if(it.exists()){const ce=it.data();j(ce.habits||[]),He(ce.hiddenDefaults||[])}let Qe=0;const Q=new Date(ut);for(;;){const ce=Xp(Q),ze=Ae[ce];if(ze)if(Object.values(ze.habits||{}).filter(Boolean).length>=3)Qe++,Q.setDate(Q.getDate()-1);else break;else if(ce===oe)Q.setDate(Q.getDate()-1);else break}te(Qe)}catch(we){console.error("Error loading habit logs:",we)}finally{V(!1)}})()},[n,t]);const Ge=g[oe]||{habits:{}};v.useEffect(()=>{Object.values(Ge.habits||{}).filter(Boolean).length<bt.length&&O&&D(!1)},[bt.length,Ge.habits]);const Ze=async Y=>{if(!(!n||$||Ge.habits?.[Y])){Tt.current=[...Array(10)].map((Ce,Me)=>{const Ae=Me/10*2*Math.PI,it=18+Math.random()*20;return{tx:Math.cos(Ae)*it,ty:Math.sin(Ae)*it,size:3+Math.random()*4,duration:.4+Math.random()*.3}}),ve(Y),setTimeout(()=>ve(null),700),navigator.vibrate&&navigator.vibrate(50),F(!0);try{const Me={...Ge.habits||{},[Y]:!0},Ae=Ge._id||`${t.id}_${oe}`;y(Qe=>({...Qe,[oe]:{clientId:t.id,date:oe,habits:Me,_id:Ae}})),await Ns(qe(fe,"habitLogs",Ae),{clientId:t.id,date:oe,habits:Me}),Object.values(Me).filter(Boolean).length===bt.length&&!O&&(zs.current=ch[Math.floor(Math.random()*ch.length)],at.current=[...Array(80)].map((Qe,Q)=>({x:5+Math.random()*90,delay:Math.random()*3.5,color:["#A12F3A","#4caf50","#ff9800","#2196f3","#e91e63","#ffeb3b","#FFD700","#ffffff","#9c27b0"][Q%9],drift:(Math.random()-.5)*120,spin:Math.random()*720-360,duration:1.8+Math.random()*2,width:4+Math.random()*6,height:4+Math.random()*8,shape:Q%3})),setTimeout(()=>{R(!0),D(!0),setTimeout(()=>Gt.current?.focus(),1100)},400))}catch(Ce){console.error("Error saving habit:",Ce),yt("Failed to save. Try again.","error"),y(Me=>({...Me,[oe]:{...Me[oe],habits:{...Me[oe]?.habits||{},[Y]:!1}}}))}finally{F(!1)}}},Et=async Y=>{if(!(!n||$)){F(!0);try{const Ce={...Ge.habits||{},[Y]:!1},Me=Ge._id||`${t.id}_${oe}`;await Ns(qe(fe,"habitLogs",Me),{clientId:t.id,date:oe,habits:Ce}),y(Ae=>({...Ae,[oe]:{clientId:t.id,date:oe,habits:Ce,_id:Me}}))}catch(we){console.error("Error undoing habit:",we),yt("Failed to undo. Try again.","error")}finally{F(!1)}}},rn=Y=>{if(Ge.habits?.[Y]||!1||$||Ye.current)return;Ye.current=Y,L(Y),Le.current=performance.now();const Ce=pt.current[Y];Ce&&(Ce.style.strokeDashoffset=Ll);const Me=Ae=>{const it=Ae-Le.current,Qe=Math.min(it/JD,1),Q=pt.current[Y];Q&&(Q.style.strokeDashoffset=Ll-Qe*Ll),Qe<1?Oe.current=requestAnimationFrame(Me):(Ye.current=null,Ue.current=!0,Oe.current=null,L(null),Ze(Y))};Oe.current=requestAnimationFrame(Me)},js=()=>{if(!Ye.current)return;const Y=Ye.current;Ye.current=null,Oe.current&&(cancelAnimationFrame(Oe.current),Oe.current=null),se.current&&(clearTimeout(se.current),se.current=null),pt.current[Y]&&(pt.current[Y].style.strokeDashoffset=Ll),L(null),Le.current=null};v.useEffect(()=>()=>{Oe.current&&cancelAnimationFrame(Oe.current),se.current&&clearTimeout(se.current)},[]);const Kt=()=>{A(!0),setTimeout(()=>{R(!1),A(!1)},300)},St=async()=>{const Y=$e.trim();if(!Y)return;if(!t?.id){yt("Still loading, try again","error");return}const we=Date.now().toString(36),Ce=[...w,{id:we,label:Y}];try{await Ns(qe(fe,"customHabits",t.id),{clientId:t.id,habits:Ce,hiddenDefaults:Pe},{merge:!0}),j(Ce),xt(""),I(!1),yt(`Added "${Y}"`,"success")}catch(Me){console.error("Error adding custom habit:",Me),yt(Me?.code==="permission-denied"?"Permission denied  check Firestore rules for customHabits":`Failed to add habit: ${Me?.message||"Unknown error"}`,"error")}},Yt=async Y=>{if(!t?.id)return;const we=w.filter(Ce=>Ce.id!==Y);try{await Ns(qe(fe,"customHabits",t.id),{clientId:t.id,habits:we,hiddenDefaults:Pe},{merge:!0}),j(we),he(null),yt("Habit removed","success")}catch(Ce){console.error("Error deleting habit:",Ce),yt("Failed to remove","error")}},us=async Y=>{if(!t?.id)return;const we=[...Pe,Y];try{await Ns(qe(fe,"customHabits",t.id),{clientId:t.id,habits:w,hiddenDefaults:we},{merge:!0}),He(we),he(null),yt("Habit removed","success")}catch(Ce){console.error("Error hiding default habit:",Ce),yt("Failed to remove","error")}},es=Ht.map(Y=>{const we=Xp(Y),Ce=g[we],Me=Ce?Object.values(Ce.habits||{}).filter(Boolean).length:0;return{date:Y,dateStr:we,completed:Me,total:bt.length}}),Xs=es.reduce((Y,we)=>Y+we.completed,0),Nt=es.reduce((Y,we)=>Y+we.total,0),ps=Nt>0?Math.round(Xs/Nt*100):0,be=Object.values(Ge.habits||{}).filter(Boolean).length,De=bt.length>0?Math.round(be/bt.length*100):0;return r.jsx(ka,{children:r.jsxs("div",{className:"cbc-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>p("/client/core-buddy"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),i||T?r.jsx("div",{className:"cbc-loading-inline",children:r.jsx("div",{className:"cbc-loading-spinner"})}):r.jsxs("main",{className:"cbc-main",children:[r.jsxs("div",{className:"cbc-ring-section anim-fade-up",children:[r.jsxs("div",{className:"cbc-progress-ring",children:[r.jsxs("svg",{viewBox:"0 0 200 200",children:[r.jsx("circle",{className:"cbc-arc-track",cx:"100",cy:"100",r:"80"}),r.jsx("circle",{className:"cbc-arc-fill",cx:"100",cy:"100",r:"80",strokeDasharray:2*Math.PI*80,strokeDashoffset:2*Math.PI*80-De/100*2*Math.PI*80})]}),r.jsxs("div",{className:"cbc-ring-center",children:[r.jsxs("span",{className:"cbc-ring-pct",children:[De,"%"]}),r.jsx("span",{className:"cbc-ring-label",children:"today"})]})]}),r.jsxs("div",{className:"cbc-streak",children:[r.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"var(--color-primary)",strokeWidth:"2",children:r.jsx("path",{d:"M13 2L3 14h9l-1 8 10-12h-9l1-8z"})}),r.jsx("span",{className:"cbc-streak-count",children:U}),r.jsx("span",{className:"cbc-streak-label",children:"day streak"})]})]}),r.jsxs("div",{className:"cbc-section anim-fade-up-d2",children:[r.jsx("h2",{className:"cbc-section-title",children:"Today's Habits"}),r.jsxs("div",{className:"cbc-habits-grid",children:[bt.map(Y=>{const we=Ge.habits?.[Y.key]||!1,Ce=ye===Y.key,Me=ee===Y.key;return r.jsxs("div",{className:`cbc-habit-tile ${we?"cbc-habit-done":""} ${Ce?"cbc-habit-just-checked":""}`,style:{"--habit-color":Y.color},children:[r.jsx("button",{className:"cbc-habit-delete",onClick:Ae=>{Ae.stopPropagation(),he(Y.isCustom?{type:"custom",id:Y.id,label:Y.label}:{type:"default",key:Y.key,label:Y.label})},"aria-label":`Remove ${Y.label}`,children:r.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:[r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})}),r.jsxs("div",{className:`cbc-habit-ring-touch ${Me?"cbc-holding":""} ${we?"cbc-ring-completed":""}`,onPointerDown:Ae=>{we||(Ae.preventDefault(),rn(Y.key))},onPointerUp:js,onPointerLeave:js,onPointerCancel:js,onClick:Ae=>{if(Ae.stopPropagation(),Ue.current){Ue.current=!1;return}we&&Et(Y.key)},role:"button",tabIndex:0,"aria-label":we?`Undo ${Y.label}`:`Press and hold to complete ${Y.label}`,onKeyDown:Ae=>{(Ae.key==="Enter"||Ae.key===" ")&&(Ae.preventDefault(),we?Et(Y.key):Ze(Y.key))},children:[r.jsxs("svg",{className:"cbc-habit-ring-svg",viewBox:"0 0 100 100",children:[r.jsx("circle",{className:"cbc-habit-ring-track",cx:"50",cy:"50",r:Dg}),r.jsx("circle",{className:"cbc-habit-ring-fill",ref:Ae=>{Ae&&(pt.current[Y.key]=Ae)},cx:"50",cy:"50",r:Dg,style:{stroke:Y.color,strokeDasharray:Ll,strokeDashoffset:we?0:Ll}})]}),we&&r.jsx("div",{className:"cbc-habit-glow-orb",style:{"--habit-color":Y.color}}),r.jsx("div",{className:"cbc-habit-ring-icon",style:{color:Y.color},children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:r.jsx("path",{d:Y.icon})})}),Ce&&r.jsx("div",{className:"cbc-particles",children:Tt.current.map((Ae,it)=>r.jsx("span",{className:"cbc-particle",style:{"--tx":`${Ae.tx}px`,"--ty":`${Ae.ty}px`,"--size":`${Ae.size}px`,"--particle-color":Y.color,animationDuration:`${Ae.duration}s`}},it))})]}),r.jsx("span",{className:"cbc-habit-label",children:Y.label}),we?r.jsx("span",{className:"cbc-habit-done-tag",children:"Done"}):r.jsx("span",{className:"cbc-habit-hold-hint",children:"Hold to complete"})]},Y.key)}),r.jsxs("div",{className:"cbc-habit-tile cbc-add-tile",onClick:()=>I(!0),role:"button",tabIndex:0,children:[r.jsx("div",{className:"cbc-add-ring",children:r.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),r.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})}),r.jsx("span",{className:"cbc-habit-label",children:"Add Habit"}),r.jsx("span",{className:"cbc-habit-hold-hint",children:"Your own"})]})]})]}),r.jsxs("div",{className:"cbc-section anim-fade-up-d4",children:[r.jsx("h2",{className:"cbc-section-title",children:"This Week"}),r.jsx("div",{className:"cbc-week-grid",children:es.map((Y,we)=>{const Ce=Y.dateStr===oe,Me=Y.total>0?Y.completed/Y.total:0,Ae=38,it=2*Math.PI*Ae,Qe=it-Me*it;return r.jsxs("div",{className:`cbc-day-ring ${Ce?"cbc-day-today":""} ${Y.completed>0?"cbc-day-active":""}`,children:[r.jsxs("svg",{viewBox:"0 0 100 100",children:[r.jsx("circle",{className:"cbc-day-track",cx:"50",cy:"50",r:Ae}),r.jsx("circle",{className:"cbc-day-fill",cx:"50",cy:"50",r:Ae,strokeDasharray:it,strokeDashoffset:Qe})]}),r.jsx("span",{className:"cbc-day-label",children:Dt[we]}),r.jsxs("span",{className:"cbc-day-count",children:[Y.completed,"/",Y.total]})]},we)})}),r.jsxs("div",{className:"cbc-week-summary",children:[r.jsx("div",{className:"cbc-week-summary-bar",children:r.jsx("div",{className:"cbc-week-summary-fill",style:{width:`${ps}%`}})}),r.jsxs("span",{className:"cbc-week-summary-text",children:[Xs," / ",Nt," habits this week (",ps,"%)"]})]})]})]}),r.jsx(la,{active:"home"}),H&&r.jsx("div",{className:"cbc-modal-overlay",onClick:()=>I(!1),children:r.jsxs("div",{className:"cbc-modal",onClick:Y=>Y.stopPropagation(),children:[r.jsx("h3",{className:"cbc-modal-title",children:"Add Habit"}),r.jsx("p",{className:"cbc-modal-desc",children:"Track something personal to your routine."}),r.jsx("input",{className:"cbc-modal-input",type:"text",placeholder:"e.g. Meditate, Stretch, Read...",value:$e,onChange:Y=>xt(Y.target.value),maxLength:30,autoFocus:!0,onKeyDown:Y=>Y.key==="Enter"&&St()}),r.jsxs("div",{className:"cbc-modal-actions",children:[r.jsx("button",{className:"cbc-modal-cancel",onClick:()=>{I(!1),xt("")},children:"Cancel"}),r.jsx("button",{className:"cbc-modal-save",onClick:St,disabled:!$e.trim(),children:"Add"})]})]})}),W&&r.jsx("div",{className:"cbc-modal-overlay",onClick:()=>he(null),children:r.jsxs("div",{className:"cbc-modal",onClick:Y=>Y.stopPropagation(),children:[r.jsxs("h3",{className:"cbc-modal-title",children:['Remove "',W.label,'"?']}),r.jsx("p",{className:"cbc-modal-desc",children:"This will remove the habit from your daily tracker. Past logs won't be affected."}),r.jsxs("div",{className:"cbc-modal-actions",children:[r.jsx("button",{className:"cbc-modal-cancel",onClick:()=>he(null),children:"Keep"}),r.jsx("button",{className:"cbc-modal-delete",onClick:()=>W.type==="custom"?Yt(W.id):us(W.key),children:"Remove"})]})]})}),ge&&r.jsxs("div",{className:`cbc-celeb-overlay ${E?"cbc-celeb-dismissing":""}`,onClick:Kt,role:"dialog","aria-modal":"true","aria-label":"All habits complete celebration",children:[r.jsx("div",{className:"cbc-celeb-confetti","aria-hidden":"true",children:at.current.map((Y,we)=>r.jsx("span",{className:`cbc-celeb-confetti-piece cbc-confetti-shape-${Y.shape}`,style:{"--x":`${Y.x}%`,"--delay":`${Y.delay}s`,"--color":Y.color,"--drift":`${Y.drift}px`,"--spin":`${Y.spin}deg`,"--duration":`${Y.duration}s`,width:`${Y.width}px`,height:`${Y.height}px`}},we))}),r.jsxs("div",{className:"cbc-celeb-content",onClick:Y=>Y.stopPropagation(),children:[r.jsx("div",{className:"cbc-celeb-logo-frame",children:r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"cbc-celeb-logo-img"})}),r.jsx("h2",{className:"cbc-celeb-heading",children:"All Habits Complete!"}),r.jsx("p",{className:"cbc-celeb-subtext",children:zs.current}),r.jsxs("p",{className:"cbc-celeb-stats",children:[be,"/",bt.length," habits  Day ",U||1]}),r.jsx("button",{ref:Gt,className:"cbc-celeb-btn",onClick:Kt,children:"Keep Going"})]})]}),K&&r.jsx("div",{className:`toast-notification ${K.type}`,children:K.message})]})})}function uh(n){if(!n)return"?";const e=n.trim().split(/\s+/);return e.length===1?e[0][0].toUpperCase():(e[0][0]+e[e.length-1][0]).toUpperCase()}function R2(n,e){return[n,e].sort().join("_")}function sP(){const{currentUser:n,isClient:e,clientData:t,loading:i}=Vr(),{isDark:l,toggleTheme:u}=Ea(),d=Gn(),[p,g]=v.useState("buddies"),[y,w]=v.useState([]),[j,T]=v.useState([]),[V,$]=v.useState([]),[F,U]=v.useState(""),[te,K]=v.useState([]),[re,ye]=v.useState([]),[ve,ge]=v.useState(!0),[R,E]=v.useState(null),[A,O]=v.useState(null),D=v.useCallback((ee,L="info")=>{O({message:ee,type:L}),setTimeout(()=>O(null),3500)},[]);v.useEffect(()=>{!i&&(!n||!e)&&d("/")},[n,e,i,d]);const H=v.useCallback(async()=>{if(t){ge(!0);try{const ee=t.id,se=(await Ss(Ft(fe,"clients"))).docs.map(at=>({id:at.id,...at.data()}));ye(se);const Le=Object.fromEntries(se.map(at=>[at.id,at])),Oe=await Ss(Ps(Ft(fe,"buddies"),fs("user1","==",ee))),Ye=await Ss(Ps(Ft(fe,"buddies"),fs("user2","==",ee))),Ue=new Set;[...Oe.docs,...Ye.docs].forEach(at=>{const Gt=at.data(),zs=Gt.user1===ee?Gt.user2:Gt.user1;Ue.add(zs)}),w(Array.from(Ue).map(at=>Le[at]).filter(Boolean));const pt=await Ss(Ps(Ft(fe,"buddyRequests"),fs("toId","==",ee),fs("status","==","pending")));T(pt.docs.map(at=>({reqId:at.id,...at.data(),fromClient:Le[at.data().fromId]})).filter(at=>at.fromClient));const Tt=await Ss(Ps(Ft(fe,"buddyRequests"),fs("fromId","==",ee),fs("status","==","pending")));$(Tt.docs.map(at=>({reqId:at.id,...at.data(),toClient:Le[at.data().toId]})).filter(at=>at.toClient))}catch(ee){console.error("Error fetching buddy data:",ee),D("Failed to load buddies","error")}finally{ge(!1)}}},[t,D]);v.useEffect(()=>{H()},[H]),v.useEffect(()=>{if(!F.trim()||!t){K([]);return}const ee=F.toLowerCase(),L=t.id,se=new Set(y.map(Ue=>Ue.id)),Le=new Set(V.map(Ue=>Ue.toId)),Oe=new Set(j.map(Ue=>Ue.fromId)),Ye=re.filter(Ue=>Ue.id===L||!Ue.name||!Ue.coreBuddyAccess&&Ue.clientType!=="core_buddy"?!1:Ue.name.toLowerCase().includes(ee)).map(Ue=>({...Ue,isBuddy:se.has(Ue.id),isPendingOut:Le.has(Ue.id),isPendingIn:Oe.has(Ue.id)})).slice(0,20);K(Ye)},[F,re,y,V,j,t]);const I=async(ee,L)=>{if(!(!t||ee===t.id))try{await mi(Ft(fe,"notifications"),{toId:ee,fromId:t.id,fromName:t.name||"Someone",fromPhotoURL:t.photoURL||null,type:L,read:!1,createdAt:Kr()})}catch(se){console.error("Notification error:",se),se.code==="permission-denied"&&D("Notifications blocked  check Firestore rules","error")}},$e=async ee=>{E(ee);try{const L=`${t.id}_${ee}`;await Ns(qe(fe,"buddyRequests",L),{fromId:t.id,toId:ee,status:"pending",createdAt:Kr()}),await I(ee,"buddy_request"),D("Buddy request sent!","success"),await H()}catch(L){console.error("Error sending request:",L),D("Failed to send request","error")}finally{E(null)}},xt=async ee=>{E(ee.reqId);try{const L=R2(ee.fromId,t.id);await Ns(qe(fe,"buddies",L),{user1:[ee.fromId,t.id].sort()[0],user2:[ee.fromId,t.id].sort()[1],connectedAt:Kr()}),await _r(qe(fe,"buddyRequests",ee.reqId)),await I(ee.fromId,"buddy_accept"),D("Buddy added!","success"),await H()}catch(L){console.error("Error accepting request:",L),D("Failed to accept","error")}finally{E(null)}},W=async ee=>{E(ee.reqId);try{await _r(qe(fe,"buddyRequests",ee.reqId)),D("Request declined","info"),await H()}catch(L){console.error("Error declining:",L),D("Failed to decline","error")}finally{E(null)}},he=async ee=>{E(ee.reqId);try{await _r(qe(fe,"buddyRequests",ee.reqId)),D("Request cancelled","info"),await H()}catch(L){console.error("Error cancelling:",L),D("Failed to cancel","error")}finally{E(null)}},Pe=async ee=>{E(ee);try{const L=R2(t.id,ee);await _r(qe(fe,"buddies",L)),D("Buddy removed","info"),await H()}catch(L){console.error("Error removing buddy:",L),D("Failed to remove buddy","error")}finally{E(null)}},He=j.length;return i?r.jsx("div",{className:"bdy-loading",children:r.jsx("div",{className:"bdy-spinner"})}):!n||!e||!t?null:r.jsx(ka,{children:r.jsxs("div",{className:"bdy-page","data-theme":l?"dark":"light",children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>d("/client/core-buddy"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),r.jsxs("main",{className:"bdy-main",children:[r.jsx("h1",{className:"bdy-title",children:"Buddies"}),r.jsxs("button",{className:"bdy-leaderboard-link",onClick:()=>d("/client/leaderboard"),children:[r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5C7 4 7 7 7 7"}),r.jsx("path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5C17 4 17 7 17 7"}),r.jsx("rect",{x:"6",y:"9",width:"12",height:"13",rx:"2"}),r.jsx("path",{d:"M12 9v13"}),r.jsx("path",{d:"M2 22h20"})]}),r.jsx("span",{children:"Leaderboard"}),r.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})]}),r.jsxs("div",{className:"bdy-tabs",children:[r.jsxs("button",{className:`bdy-tab${p==="buddies"?" active":""}`,onClick:()=>g("buddies"),children:[r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),r.jsx("circle",{cx:"9",cy:"7",r:"4"}),r.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),r.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),r.jsx("span",{children:"My Buddies"})]}),r.jsxs("button",{className:`bdy-tab${p==="requests"?" active":""}`,onClick:()=>g("requests"),children:[r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),r.jsx("circle",{cx:"9",cy:"7",r:"4"}),r.jsx("line",{x1:"19",y1:"8",x2:"19",y2:"14"}),r.jsx("line",{x1:"22",y1:"11",x2:"16",y2:"11"})]}),r.jsx("span",{children:"Requests"}),He>0&&r.jsx("span",{className:"bdy-tab-badge",children:He})]}),r.jsxs("button",{className:`bdy-tab${p==="search"?" active":""}`,onClick:()=>g("search"),children:[r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("circle",{cx:"11",cy:"11",r:"8"}),r.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),r.jsx("span",{children:"Find"})]})]}),ve?r.jsx("div",{className:"bdy-content-loading",children:r.jsx("div",{className:"bdy-spinner"})}):r.jsxs(r.Fragment,{children:[p==="buddies"&&r.jsx("div",{className:"bdy-section",children:y.length===0?r.jsxs("div",{className:"bdy-empty",children:[r.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),r.jsx("circle",{cx:"9",cy:"7",r:"4"}),r.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),r.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),r.jsx("h3",{children:"No buddies yet"}),r.jsx("p",{children:"Find members and send buddy requests to connect!"}),r.jsx("button",{className:"bdy-empty-btn",onClick:()=>g("search"),children:"Find Buddies"})]}):r.jsx("div",{className:"bdy-list",children:y.map(ee=>r.jsxs("div",{className:"bdy-card",onClick:()=>d(`/client/core-buddy/profile/${ee.id}`),children:[r.jsx("div",{className:"bdy-avatar",children:ee.photoURL?r.jsx("img",{src:ee.photoURL,alt:ee.name}):r.jsx("span",{children:uh(ee.name)})}),r.jsx("div",{className:"bdy-card-info",children:r.jsx("span",{className:"bdy-card-name",children:ee.name})}),r.jsx("button",{className:"bdy-remove-btn",onClick:L=>{L.stopPropagation(),Pe(ee.id)},disabled:R===ee.id,"aria-label":"Remove buddy",children:R===ee.id?r.jsx("div",{className:"bdy-btn-spinner"}):r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]},ee.id))})}),p==="requests"&&r.jsxs("div",{className:"bdy-section",children:[j.length>0&&r.jsxs(r.Fragment,{children:[r.jsx("h3",{className:"bdy-section-title",children:"Incoming"}),r.jsx("div",{className:"bdy-list",children:j.map(ee=>r.jsxs("div",{className:"bdy-card",children:[r.jsx("div",{className:"bdy-avatar",children:ee.fromClient.photoURL?r.jsx("img",{src:ee.fromClient.photoURL,alt:ee.fromClient.name}):r.jsx("span",{children:uh(ee.fromClient.name)})}),r.jsxs("div",{className:"bdy-card-info",children:[r.jsx("span",{className:"bdy-card-name",children:ee.fromClient.name}),r.jsx("span",{className:"bdy-card-sub",children:"wants to be your buddy"})]}),r.jsxs("div",{className:"bdy-action-pair",children:[r.jsx("button",{className:"bdy-accept-btn",onClick:()=>xt(ee),disabled:R===ee.reqId,children:R===ee.reqId?r.jsx("div",{className:"bdy-btn-spinner"}):r.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:r.jsx("path",{d:"M5 13l4 4L19 7"})})}),r.jsx("button",{className:"bdy-decline-btn",onClick:()=>W(ee),disabled:R===ee.reqId,children:r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]})]},ee.reqId))})]}),V.length>0&&r.jsxs(r.Fragment,{children:[r.jsx("h3",{className:"bdy-section-title",children:"Sent"}),r.jsx("div",{className:"bdy-list",children:V.map(ee=>r.jsxs("div",{className:"bdy-card",children:[r.jsx("div",{className:"bdy-avatar",children:ee.toClient?.photoURL?r.jsx("img",{src:ee.toClient.photoURL,alt:ee.toClient.name}):r.jsx("span",{children:uh(ee.toClient?.name)})}),r.jsxs("div",{className:"bdy-card-info",children:[r.jsx("span",{className:"bdy-card-name",children:ee.toClient?.name}),r.jsx("span",{className:"bdy-card-sub",children:"pending"})]}),r.jsx("button",{className:"bdy-cancel-btn",onClick:()=>he(ee),disabled:R===ee.reqId,children:R===ee.reqId?r.jsx("div",{className:"bdy-btn-spinner"}):"Cancel"})]},ee.reqId))})]}),j.length===0&&V.length===0&&r.jsxs("div",{className:"bdy-empty",children:[r.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[r.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),r.jsx("path",{d:"M22 4L12 14.01l-3-3"})]}),r.jsx("h3",{children:"No pending requests"}),r.jsx("p",{children:"All caught up!"})]})]}),p==="search"&&r.jsxs("div",{className:"bdy-section",children:[r.jsxs("div",{className:"bdy-search-bar",children:[r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("circle",{cx:"11",cy:"11",r:"8"}),r.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),r.jsx("input",{type:"text",placeholder:"Search by name...",value:F,onChange:ee=>U(ee.target.value),autoFocus:!0}),F&&r.jsx("button",{className:"bdy-search-clear",onClick:()=>U(""),children:r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),F.trim()&&te.length===0&&r.jsx("div",{className:"bdy-empty bdy-empty-sm",children:r.jsxs("p",{children:['No members found for "',F,'"']})}),te.length>0&&r.jsx("div",{className:"bdy-list",children:te.map(ee=>r.jsxs("div",{className:"bdy-card",onClick:()=>d(`/client/core-buddy/profile/${ee.id}`),children:[r.jsx("div",{className:"bdy-avatar",children:ee.photoURL?r.jsx("img",{src:ee.photoURL,alt:ee.name}):r.jsx("span",{children:uh(ee.name)})}),r.jsxs("div",{className:"bdy-card-info",children:[r.jsx("span",{className:"bdy-card-name",children:ee.name}),ee.isBuddy&&r.jsx("span",{className:"bdy-card-badge",children:"Buddy"})]}),ee.isBuddy?r.jsx("span",{className:"bdy-status-icon",children:r.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"var(--color-success)",strokeWidth:"2.5",children:r.jsx("path",{d:"M5 13l4 4L19 7"})})}):ee.isPendingOut?r.jsx("span",{className:"bdy-pending-label",children:"Pending"}):ee.isPendingIn?r.jsx("button",{className:"bdy-accept-btn",onClick:L=>{L.stopPropagation();const se=j.find(Le=>Le.fromId===ee.id);se&&xt(se)},disabled:!!R,children:r.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:r.jsx("path",{d:"M5 13l4 4L19 7"})})}):r.jsx("button",{className:"bdy-add-btn",onClick:L=>{L.stopPropagation(),$e(ee.id)},disabled:R===ee.id,children:R===ee.id?r.jsx("div",{className:"bdy-btn-spinner"}):r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),r.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})})]},ee.id))})]})]})]}),r.jsx(la,{}),A&&r.jsxs("div",{className:`toast-notification ${A.type}`,children:[r.jsx("span",{className:"toast-icon",children:A.type==="success"?r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M5 13 L9 17 L19 7"})}):A.type==="error"?r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]}):r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),r.jsx("circle",{cx:"12",cy:"16",r:"1",fill:"currentColor"})]})}),r.jsx("span",{className:"toast-message",children:A.message})]})]})})}function dh(n){if(!n)return"?";const e=n.trim().split(/\s+/);return e.length===1?e[0][0].toUpperCase():(e[0][0]+e[e.length-1][0]).toUpperCase()}function Jp(n,e){return[n,e].sort().join("_")}const nP=5;function Zp(n){return n.toISOString().split("T")[0]}function rP(n){return n>=1e6?`${(n/1e6).toFixed(1)}M`:n>=1e3?`${(n/1e3).toFixed(1)}T`:`${Math.round(n)}`}const aP={fullbody_4wk:{duration:4,daysPerWeek:3},fullbody_8wk:{duration:8,daysPerWeek:3},fullbody_12wk:{duration:12,daysPerWeek:3},core_4wk:{duration:4,daysPerWeek:3},core_8wk:{duration:8,daysPerWeek:3},core_12wk:{duration:12,daysPerWeek:3},upper_4wk:{duration:4,daysPerWeek:3},lower_4wk:{duration:4,daysPerWeek:3}};function A2(n){if(!n)return"";const e=n instanceof Date?n:n.toDate?n.toDate():new Date(n),t=Math.floor((new Date-e)/1e3);return t<60?"just now":t<3600?`${Math.floor(t/60)}m ago`:t<86400?`${Math.floor(t/3600)}h ago`:t<604800?`${Math.floor(t/86400)}d ago`:e.toLocaleDateString("en-GB",{day:"numeric",month:"short"})}function iP(){const{userId:n}=fE(),{currentUser:e,isClient:t,clientData:i,loading:l}=Vr(),{isDark:u,toggleTheme:d}=Ea(),p=Gn(),[g,y]=v.useState(null),[w,j]=v.useState("none"),[T,V]=v.useState(null),[$,F]=v.useState(!0),[U,te]=v.useState(!1),[K,re]=v.useState(null),[ye,ve]=v.useState([]),[ge,R]=v.useState(!1),[E,A]=v.useState(new Set),[O,D]=v.useState(new Set),[H,I]=v.useState({}),[$e,xt]=v.useState({}),[W,he]=v.useState({}),[Pe,He]=v.useState(!0),[ee,L]=v.useState(0),[se,Le]=v.useState(0),[Oe,Ye]=v.useState(0),[Ue,pt]=v.useState(0),[Tt,at]=v.useState([]),[Gt,zs]=v.useState([]),[yt,ut]=v.useState(null),[oe,ss]=v.useState(null),[Ht,Dt]=v.useState(0),[bt,Ge]=v.useState([]),[Ze,Et]=v.useState(!1),[rn,js]=v.useState(null),[Kt,St]=v.useState([]),Yt=v.useCallback((Q,ce="info")=>{re({message:Q,type:ce}),setTimeout(()=>re(null),3500)},[]);v.useEffect(()=>{!l&&(!e||!t)&&p("/")},[e,t,l,p]),v.useEffect(()=>{i&&n&&i.id===n&&p("/client/core-buddy",{replace:!0})},[i,n,p]),v.useEffect(()=>{if(!i||!n||i.id===n)return;let Q=!1;return(async()=>{F(!0);try{const dt=(await Ss(Ft(fe,"clients"))).docs.map(At=>({id:At.id,...At.data()})).find(At=>At.id===n);if(!dt){Q||F(!1);return}Q||y(dt);const ht=i.id,Vt=Jp(ht,n);if((await As(qe(fe,"buddies",Vt))).exists())Q||j("buddy");else{const At=`${ht}_${n}`,Ms=await As(qe(fe,"buddyRequests",At));if(Ms.exists()&&Ms.data().status==="pending")Q||(j("pending_out"),V(At));else{const Js=`${n}_${ht}`,ns=await As(qe(fe,"buddyRequests",Js));ns.exists()&&ns.data().status==="pending"?Q||(j("pending_in"),V(Js)):Q||j("none")}}}catch(ce){console.error("Error loading profile:",ce)}finally{Q||F(!1)}})(),()=>{Q=!0}},[i,n]),v.useEffect(()=>{if(!n||!g)return;let Q=!1;return(async()=>{He(!0);try{const[ce,ze,dt,ht]=await Promise.all([Ss(Ps(Ft(fe,"workoutLogs"),fs("clientId","==",n))),As(qe(fe,"coreBuddyAchievements",n)),As(qe(fe,"coreBuddyPBs",n)),As(qe(fe,"clientProgrammes",n))]);if(Q)return;const Vt=ce.docs.length;L(Vt),ze.exists()&&Le(ze.data().totalVolume||0);let Ct=0;const At=ce.docs.map(ns=>ns.data().date).filter(Boolean).sort().reverse();if(At.length>0){const ns=new Date;let Cs=new Date(ns);for(let Ls=0;Ls<52;Ls++){const q=new Date(Cs),xe=q.getDay(),Ee=xe===0?6:xe-1;q.setDate(q.getDate()-Ee),q.setHours(0,0,0,0);const je=new Date(q);je.setDate(je.getDate()+7);const ke=Zp(q),ot=Zp(je);if(At.some(et=>et>=ke&&et<ot))Ct++;else{if(Ls>0)break;break}Cs.setDate(Cs.getDate()-7)}}if(Q||Ye(Ct),dt.exists()){const ns=dt.data().exercises||{},Cs=Object.entries(ns).sort(([,Ls],[,q])=>(q.weight||0)-(Ls.weight||0)).slice(0,3).map(([Ls,q])=>({name:Ls,weight:q.weight,reps:q.reps}));Q||at(Cs)}if(ht.exists()){const ns=ht.data(),Cs=aP[ns.templateId];if(Cs){const Ls=Object.keys(ns.completedSessions||{}).length,q=Cs.duration*Cs.daysPerWeek;Q||(ss(ns.templateId.replace(/_/g," ").replace(/\b\w/g,xe=>xe.toUpperCase())),Dt(q>0?Math.round(Ls/q*100):0))}}const Ms=await As(qe(fe,"achievements",n));if(!Q&&Ms.exists()){const ns=Ms.data().badges||{};zs(Object.keys(ns))}let Js=0;for(let ns=0;ns<30;ns++){const Cs=new Date;Cs.setDate(Cs.getDate()-ns);const Ls=Zp(Cs);try{const q=await Ss(Ps(Ft(fe,"habitLogs"),fs("clientId","==",n),fs("date","==",Ls)));if(q.empty)break;{const xe=q.docs[0].data().habits||{};if(Object.values(xe).filter(Boolean).length>=nP)Js++;else break}}catch{break}}Q||pt(Js)}catch(ce){console.error("Error loading buddy stats:",ce)}finally{Q||He(!1)}})(),()=>{Q=!0}},[n,g]),v.useEffect(()=>{if(!i)return;const Q=i.id;(async()=>{try{const[ce,ze,dt]=await Promise.all([Ss(Ps(Ft(fe,"buddies"),fs("user1","==",Q))),Ss(Ps(Ft(fe,"buddies"),fs("user2","==",Q))),Ss(Ft(fe,"clients"))]),ht=new Set;[...ce.docs,...ze.docs].forEach(Ct=>{const At=Ct.data();ht.add(At.user1===Q?At.user2:At.user1)});const Vt={};dt.docs.forEach(Ct=>{Vt[Ct.id]=Ct.data()}),Ge(Array.from(ht).filter(Ct=>Vt[Ct]).map(Ct=>({id:Ct,name:Vt[Ct].name,photoURL:Vt[Ct].photoURL||null})))}catch(ce){console.error("Error loading buddies for mentions:",ce)}})()},[i]);const us=async(Q,ce,ze={})=>{if(!(!i||Q===i.id))try{await mi(Ft(fe,"notifications"),{toId:Q,fromId:i.id,fromName:i.name||"Someone",fromPhotoURL:i.photoURL||null,type:ce,read:!1,createdAt:Kr(),...ze})}catch(dt){console.error("Notification error:",dt),dt.code==="permission-denied"&&Yt("Notifications blocked  check Firestore rules","error")}},es=async()=>{te(!0);try{const Q=`${i.id}_${n}`;await Ns(qe(fe,"buddyRequests",Q),{fromId:i.id,toId:n,status:"pending",createdAt:Kr()}),await us(n,"buddy_request"),j("pending_out"),V(Q),Yt("Buddy request sent!","success")}catch(Q){console.error(Q),Yt("Failed to send request","error")}finally{te(!1)}},Xs=async()=>{if(T){te(!0);try{const Q=Jp(i.id,n);await Ns(qe(fe,"buddies",Q),{user1:[i.id,n].sort()[0],user2:[i.id,n].sort()[1],connectedAt:Kr()}),await _r(qe(fe,"buddyRequests",T)),await us(n,"buddy_accept"),j("buddy"),Yt("Buddy added!","success")}catch(Q){console.error(Q),Yt("Failed to accept","error")}finally{te(!1)}}},Nt=async()=>{if(T){te(!0);try{await _r(qe(fe,"buddyRequests",T)),j("none"),Yt(w==="pending_out"?"Request cancelled":"Request declined","info")}catch(Q){console.error(Q),Yt("Failed","error")}finally{te(!1)}}},ps=async()=>{te(!0);try{const Q=Jp(i.id,n);await _r(qe(fe,"buddies",Q)),j("none"),Yt("Buddy removed","info")}catch(Q){console.error(Q),Yt("Failed to remove","error")}finally{te(!1)}},be=v.useCallback(async()=>{if(n){R(!0);try{const Q=await Ss(Ps(Ft(fe,"posts"),fs("authorId","==",n),Gh("createdAt","desc"),Kh(30)));if(ve(Q.docs.map(ce=>({id:ce.id,...ce.data()}))),i){const ce=await Ss(Ps(Ft(fe,"postLikes"),fs("userId","==",i.id)));A(new Set(ce.docs.map(ze=>ze.data().postId)))}}catch(Q){console.error("Error loading journey:",Q)}finally{R(!1)}}},[n,i]);v.useEffect(()=>{!$&&g&&be()},[$,g,be]);const De=async Q=>{if(window.confirm("Delete this post?"))try{await _r(qe(fe,"posts",Q)),ve(ce=>ce.filter(ze=>ze.id!==Q)),Yt("Post deleted","info")}catch(ce){console.error("Delete error:",ce),Yt("Failed to delete","error")}},Y=async Q=>{if(!i)return;const ce=i.id,ze=`${Q}_${ce}`,dt=E.has(Q),ht=new Set(E);dt?ht.delete(Q):ht.add(Q),A(ht),ve(Vt=>Vt.map(Ct=>Ct.id===Q?{...Ct,likeCount:Math.max(0,(Ct.likeCount||0)+(dt?-1:1))}:Ct));try{if(dt)await _r(qe(fe,"postLikes",ze)),await Da(qe(fe,"posts",Q),{likeCount:Bo(-1)});else{await Ns(qe(fe,"postLikes",ze),{postId:Q,userId:ce,createdAt:Kr()}),await Da(qe(fe,"posts",Q),{likeCount:Bo(1)});const Vt=ye.find(Ct=>Ct.id===Q);Vt&&us(Vt.authorId,"like",{postId:Q})}}catch(Vt){console.error("Like error:",Vt),be()}},we=async Q=>{try{const ce=await Ss(Ps(Ft(fe,"postComments"),fs("postId","==",Q),Gh("createdAt","asc"),Kh(50)));I(ze=>({...ze,[Q]:ce.docs.map(dt=>({id:dt.id,...dt.data()}))}))}catch(ce){console.error("Error loading comments:",ce)}},Ce=Q=>{const ce=new Set(O);ce.has(Q)?ce.delete(Q):(ce.add(Q),H[Q]||we(Q)),D(ce)},Me=(Q,ce)=>{const ze=Q.match(/@(\w*)$/);if(ze){Et(!0),js(ce);const dt=bt.filter(ht=>ht.name&&ht.name.toLowerCase().includes(ze[1].toLowerCase())).slice(0,5);St(dt)}else Et(!1),St([])},Ae=(Q,ce)=>{const dt=($e[ce]||"").replace(/@\w*$/,`@${Q.name} `);xt(ht=>({...ht,[ce]:dt})),Et(!1),St([])},it=(Q,ce)=>{xt(ze=>({...ze,[Q]:ce})),Me(ce,Q)},Qe=async Q=>{const ce=($e[Q]||"").trim();if(!(!ce||!i)){he(ze=>({...ze,[Q]:!0}));try{await mi(Ft(fe,"postComments"),{postId:Q,authorId:i.id,authorName:i.name||"Unknown",authorPhotoURL:i.photoURL||null,content:ce,createdAt:Kr()}),await Da(qe(fe,"posts",Q),{commentCount:Bo(1)});const ze=ye.find(ht=>ht.id===Q);ze&&us(ze.authorId,"comment",{postId:Q});const dt=ce.match(/@[\w\s]+?(?=\s@|\s*$|[.,!?])/g);if(dt){const ht=new Set;dt.forEach(Vt=>{const Ct=Vt.slice(1).trim(),At=bt.find(Ms=>Ms.name&&Ms.name.toLowerCase()===Ct.toLowerCase());At&&!ht.has(At.id)&&(ht.add(At.id),us(At.id,"mention",{postId:Q}))})}xt(ht=>({...ht,[Q]:""})),ve(ht=>ht.map(Vt=>Vt.id===Q?{...Vt,commentCount:(Vt.commentCount||0)+1}:Vt)),await we(Q)}catch(ze){console.error("Comment error:",ze),Yt("Failed to comment","error")}finally{he(ze=>({...ze,[Q]:!1}))}}};return l||$||!i?r.jsx("div",{className:"prf-loading","data-theme":u?"dark":"light",children:r.jsx("div",{className:"prf-spinner"})}):!e||!t?null:g?r.jsx(ka,{children:r.jsxs("div",{className:"prf-page","data-theme":u?"dark":"light",children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>p(-1),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:d,"aria-label":"Toggle theme",children:u?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),r.jsxs("main",{className:"prf-main",children:[r.jsxs("div",{className:"prf-hero",children:[r.jsx("div",{className:"prf-avatar-lg",children:g.photoURL?r.jsx("img",{src:g.photoURL,alt:g.name}):r.jsx("span",{children:dh(g.name)})}),r.jsx("h1",{className:"prf-name",children:g.name}),r.jsxs("div",{className:"prf-buddy-action",children:[w==="none"&&r.jsx("button",{className:"prf-btn prf-btn-primary",onClick:es,disabled:U,children:U?r.jsx("div",{className:"prf-btn-spinner"}):r.jsxs(r.Fragment,{children:[r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),r.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),"Add Buddy"]})}),w==="pending_out"&&r.jsx("button",{className:"prf-btn prf-btn-secondary",onClick:Nt,disabled:U,children:U?r.jsx("div",{className:"prf-btn-spinner dark"}):"Cancel Request"}),w==="pending_in"&&r.jsxs("div",{className:"prf-btn-pair",children:[r.jsx("button",{className:"prf-btn prf-btn-success",onClick:Xs,disabled:U,children:U?r.jsx("div",{className:"prf-btn-spinner"}):"Accept"}),r.jsx("button",{className:"prf-btn prf-btn-secondary",onClick:Nt,disabled:U,children:"Decline"})]}),w==="buddy"&&r.jsx("button",{className:"prf-btn prf-btn-danger",onClick:ps,disabled:U,children:U?r.jsx("div",{className:"prf-btn-spinner"}):"Remove Buddy"})]})]}),Pe?r.jsx("div",{className:"prf-stats-loading",children:r.jsx("div",{className:"prf-spinner"})}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"prf-stats",children:[r.jsxs("div",{className:"prf-stat",children:[r.jsx("span",{className:"prf-stat-value",children:ee}),r.jsx("span",{className:"prf-stat-label",children:"Workouts"})]}),r.jsxs("div",{className:"prf-stat",children:[r.jsxs("span",{className:"prf-stat-value",children:[rP(se),r.jsx("span",{className:"prf-stat-unit",children:se>=1e3?"":"kg"})]}),r.jsxs("span",{className:"prf-stat-label",children:[se>=1e6?"Million kg":se>=1e3?"Tonnes":"Volume"," Lifted"]})]}),r.jsxs("div",{className:"prf-stat",children:[r.jsxs("span",{className:"prf-stat-value",children:[Oe,r.jsx("span",{className:"prf-stat-unit",children:"wk"})]}),r.jsx("span",{className:"prf-stat-label",children:"Streak"})]})]}),(oe||Ue>0)&&r.jsxs("div",{className:"prf-info-row",children:[oe&&r.jsxs("div",{className:"prf-info-card info-programme",children:[r.jsx("div",{className:"prf-info-icon",children:r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M4 19.5A2.5 2.5 0 0 1 6.5 17H20"}),r.jsx("path",{d:"M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"})]})}),r.jsxs("div",{className:"prf-info-text",children:[r.jsx("span",{className:"prf-info-label",children:oe}),r.jsx("div",{className:"prf-info-progress-bar",children:r.jsx("div",{className:"prf-info-progress-fill",style:{width:`${Math.min(Ht,100)}%`}})}),r.jsxs("span",{className:"prf-info-sub",children:[Ht,"% complete"]})]})]}),Ue>0&&r.jsxs("div",{className:"prf-info-card info-habit",children:[r.jsx("div",{className:"prf-info-icon",children:r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),r.jsx("path",{d:"M22 4L12 14.01l-3-3"})]})}),r.jsxs("div",{className:"prf-info-text",children:[r.jsxs("span",{className:"prf-info-value",children:[Ue," day",Ue!==1?"s":""]}),r.jsx("span",{className:"prf-info-sub",children:"Habit Streak"})]})]})]}),Tt.length>0&&r.jsxs("div",{className:"prf-section",children:[r.jsx("h2",{className:"prf-section-title",children:"Top Lifts"}),r.jsx("div",{className:"prf-pb-list",children:Tt.map((Q,ce)=>r.jsxs("div",{className:"prf-pb-item",children:[r.jsx("div",{className:"prf-pb-rank",children:ce===0?r.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",stroke:"none",children:r.jsx("path",{d:"M12 2l2.4 7.4H22l-6 4.4 2.3 7.2L12 16.6 5.7 21l2.3-7.2-6-4.4h7.6z"})}):`#${ce+1}`}),r.jsx("span",{className:"prf-pb-name",children:Q.name}),r.jsxs("span",{className:"prf-pb-weight",children:[Q.weight,r.jsx("span",{className:"prf-pb-unit",children:"kg"})," x",Q.reps]})]},ce))})]}),Gt.length>0&&r.jsxs("div",{className:"prf-section",children:[r.jsxs("h2",{className:"prf-section-title",children:["Badges Earned (",Gt.length,")"]}),r.jsx("div",{className:"prf-badge-row",children:Gt.map(Q=>{const ce=mu.find(ze=>ze.id===Q);return ce?r.jsx("button",{className:"prf-badge-chip",onClick:()=>ut(ce),children:r.jsx("img",{src:ce.img,alt:ce.name,className:"prf-badge-chip-img"})},Q):null})})]}),yt&&r.jsx("div",{className:"prf-badge-overlay",onClick:()=>ut(null),children:r.jsxs("div",{className:"prf-badge-overlay-content",onClick:Q=>Q.stopPropagation(),children:[r.jsx("img",{src:yt.img,alt:yt.name,className:"prf-badge-overlay-img"}),r.jsx("p",{className:"prf-badge-overlay-desc",children:yt.desc}),r.jsx("button",{className:"prf-badge-overlay-close",onClick:()=>ut(null),children:"Tap to close"})]})})]}),r.jsxs("div",{className:"prf-section",children:[r.jsx("h2",{className:"prf-section-title",children:`${g.name?.split(" ")[0]}'s Journey`}),ge?r.jsx("div",{className:"journey-loading",children:r.jsx("div",{className:"prf-spinner"})}):ye.length===0?r.jsxs("div",{className:"journey-empty",children:[r.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),r.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),r.jsx("path",{d:"M21 15l-5-5L5 21"})]}),r.jsx("p",{children:"No posts yet"})]}):r.jsx("div",{className:"journey-list",children:ye.map(Q=>r.jsxs("div",{className:"journey-post",children:[r.jsxs("div",{className:"journey-post-header",children:[r.jsx("div",{className:"journey-post-avatar",children:Q.authorPhotoURL?r.jsx("img",{src:Q.authorPhotoURL,alt:""}):r.jsx("span",{children:dh(Q.authorName)})}),r.jsxs("div",{className:"journey-post-meta",children:[r.jsx("span",{className:"journey-post-name",children:Q.authorName}),r.jsx("span",{className:"journey-post-time",children:A2(Q.createdAt)})]}),Q.authorId===i.id&&r.jsx("button",{className:"journey-delete-btn",onClick:()=>De(Q.id),"aria-label":"Delete post",children:r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M3 6h18"}),r.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),r.jsx("path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]}),Q.content&&r.jsx("p",{className:"journey-post-content",children:Q.content}),Q.imageURL&&r.jsx("div",{className:"journey-post-image",children:r.jsx("img",{src:Q.imageURL,alt:"Post",loading:"lazy"})}),r.jsxs("div",{className:"journey-post-actions",children:[r.jsxs("button",{className:`journey-action-btn${E.has(Q.id)?" liked":""}`,onClick:()=>Y(Q.id),children:[r.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:E.has(Q.id)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})}),r.jsx("span",{children:Q.likeCount||0})]}),r.jsxs("button",{className:`journey-action-btn${O.has(Q.id)?" active":""}`,onClick:()=>Ce(Q.id),children:[r.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})}),r.jsx("span",{children:Q.commentCount||0})]})]}),O.has(Q.id)&&r.jsxs("div",{className:"journey-comments",children:[H[Q.id]?.length>0?H[Q.id].map(ce=>r.jsxs("div",{className:"journey-comment",children:[r.jsx("div",{className:"journey-comment-avatar",onClick:()=>p(`/client/core-buddy/profile/${ce.authorId}`),children:ce.authorPhotoURL?r.jsx("img",{src:ce.authorPhotoURL,alt:""}):r.jsx("span",{children:dh(ce.authorName)})}),r.jsxs("div",{className:"journey-comment-body",children:[r.jsxs("div",{className:"journey-comment-bubble",children:[r.jsx("span",{className:"journey-comment-name",children:ce.authorName}),r.jsx("span",{className:"journey-comment-text",children:ce.content})]}),r.jsx("span",{className:"journey-comment-time",children:A2(ce.createdAt)})]})]},ce.id)):r.jsx("p",{className:"journey-no-comments",children:"No comments yet"}),r.jsxs("div",{className:"journey-comment-input",style:{position:"relative"},children:[r.jsx("input",{type:"text",placeholder:"Comment... (@ to mention)",value:$e[Q.id]||"",onChange:ce=>it(Q.id,ce.target.value),onKeyDown:ce=>{ce.key==="Enter"&&Qe(Q.id)},maxLength:300}),Ze&&rn===Q.id&&Kt.length>0&&r.jsx("div",{className:"mention-dropdown mention-dropdown-up",children:Kt.map(ce=>r.jsxs("button",{className:"mention-option",onClick:()=>Ae(ce,Q.id),children:[r.jsx("div",{className:"mention-option-avatar",children:ce.photoURL?r.jsx("img",{src:ce.photoURL,alt:""}):r.jsx("span",{children:dh(ce.name)})}),r.jsx("span",{children:ce.name})]},ce.id))}),r.jsx("button",{onClick:()=>Qe(Q.id),disabled:!($e[Q.id]||"").trim()||W[Q.id],children:W[Q.id]?r.jsx("div",{className:"journey-btn-spinner-sm"}):r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"22",y1:"2",x2:"11",y2:"13"}),r.jsx("polygon",{points:"22 2 15 22 11 13 2 9 22 2"})]})})]})]})]},Q.id))})]})]}),r.jsx(la,{}),K&&r.jsxs("div",{className:`toast-notification ${K.type}`,children:[r.jsx("span",{className:"toast-icon",children:K.type==="success"?r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M5 13 L9 17 L19 7"})}):K.type==="error"?r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]}):r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),r.jsx("circle",{cx:"12",cy:"16",r:"1",fill:"currentColor"})]})}),r.jsx("span",{className:"toast-message",children:K.message})]})]})}):r.jsxs("div",{className:"prf-page","data-theme":u?"dark":"light",children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>p(-1),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions"})]})}),r.jsx("main",{className:"prf-main",children:r.jsx("p",{style:{textAlign:"center",color:"var(--text-tertiary)",padding:"40px 0"},children:"User not found"})}),r.jsx(la,{})]})}function oP(){const n=Gn(),{clientData:e,currentUser:t,resolveClient:i,updateClientData:l}=Vr(),[u,d]=v.useState([]),[p,g]=v.useState(""),[y,w]=v.useState(!1),[j,T]=v.useState(null),[V,$]=v.useState(!1),[F,U]=v.useState(null),te=v.useRef(null),K=v.useRef(null);if(!e?.buddyEnabled)return r.jsxs("div",{className:"buddy-page",children:[r.jsxs("div",{className:"buddy-container",children:[r.jsx("p",{children:"Buddy is not enabled on your account."}),r.jsx("button",{onClick:()=>n("/client/core-buddy"),children:"Back to Dashboard"})]}),r.jsx(la,{active:"home"})]});v.useEffect(()=>{te.current&&te.current.scrollIntoView({behavior:"smooth"})},[u,y]),v.useEffect(()=>{u.length===0&&!y&&re([])},[]);const re=async E=>{w(!0),T(null);try{const O=await(await fetch("/api/buddy-onboarding",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({messages:E,clientName:e?.name||t?.displayName||"there"})})).json();if(O.error){T(O.error);return}const D={role:"assistant",content:O.reply};d(H=>[...H,D]),O.profileData&&(await R(O.profileData),U(O.profileData),$(!0))}catch(A){console.error("Buddy chat error:",A),T("Something went wrong  try sending again.")}finally{w(!1)}},ye=()=>{const E=p.trim();if(!E||y)return;const A={role:"user",content:E},O=[...u,A];d(O),g(""),K.current&&K.current.focus(),re(O)},ve=E=>{E.key==="Enter"&&!E.shiftKey&&(E.preventDefault(),ye())},ge=E=>{const A=E?.experience||"beginner";return A==="advanced"?{id:"fullbody_12wk",name:"12-Week Full Body",duration:12,level:"Advanced",daysPerWeek:3,description:"Complete transformation programme  push, pull, and legs over three phases."}:A==="intermediate"?{id:"fullbody_8wk",name:"8-Week Full Body",duration:8,level:"Intermediate",daysPerWeek:3,description:"Two-phase programme building strength and endurance across your full body."}:{id:"fullbody_4wk",name:"4-Week Full Body",duration:4,level:"All Levels",daysPerWeek:3,description:"Build total body strength with compound dumbbell movements and bodyweight finishers."}},R=async E=>{try{const A=await i();if(!A)return;await Ns(qe(fe,"onboardingSubmissions",A.id),{clientId:A.id,clientName:A.name,email:A.email,source:"buddy_chat",welcome:{dob:E.dob||null,gender:E.gender||null,goals:E.goals||[],experience:E.experience||null,injuries:E.injuries||null,activityLevel:E.activityLevel||null,exerciseHistory:E.exerciseHistory||null,sleepHours:E.sleepHours||null,stressLevel:E.stressLevel||null,dietaryInfo:E.dietaryInfo||null,availability:E.availability||null,additionalInfo:E.additionalInfo||null},submittedAt:Kr()});const O=E.goals||[];await Da(qe(fe,"clients",A.id),{fitnessGoal:O[0]||null,fitnessGoals:O,experienceLevel:E.experience||null,dob:E.dob||null,injuries:E.injuries||null}),l({fitnessGoal:O[0]||null,fitnessGoals:O,experienceLevel:E.experience,dob:E.dob})}catch(A){console.error("Save profile error:",A)}};return r.jsx(ka,{children:r.jsxs("div",{className:"buddy-page buddy-page--chat",children:[r.jsxs("div",{className:"buddy-chat-container",children:[r.jsxs("div",{className:"buddy-chat-top",children:[r.jsx("button",{className:"buddy-back",onClick:()=>n("/client/core-buddy"),children:r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsxs("div",{className:"buddy-chat-header",children:[r.jsx("div",{className:"buddy-chat-avatar",children:r.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M12 2a4 4 0 0 1 4 4v2a4 4 0 0 1-8 0V6a4 4 0 0 1 4-4z"}),r.jsx("path",{d:"M18 14c2 1 3 3 3 5v2H3v-2c0-2 1-4 3-5"}),r.jsx("circle",{cx:"9",cy:"7",r:"0.5",fill:"currentColor"}),r.jsx("circle",{cx:"15",cy:"7",r:"0.5",fill:"currentColor"}),r.jsx("path",{d:"M9.5 10a2.5 2.5 0 0 0 5 0"})]})}),r.jsxs("div",{children:[r.jsx("h2",{className:"buddy-chat-name",children:"Buddy"}),r.jsx("span",{className:"buddy-chat-status",children:y?"typing...":"Your AI Coach"})]})]})]}),r.jsxs("div",{className:"buddy-chat-messages",children:[u.map((E,A)=>r.jsxs("div",{className:`buddy-chat-bubble buddy-chat-${E.role}`,children:[E.role==="assistant"&&r.jsx("div",{className:"buddy-chat-bubble-avatar",children:"B"}),r.jsx("div",{className:"buddy-chat-bubble-content",children:E.content})]},A)),y&&r.jsxs("div",{className:"buddy-chat-bubble buddy-chat-assistant",children:[r.jsx("div",{className:"buddy-chat-bubble-avatar",children:"B"}),r.jsxs("div",{className:"buddy-chat-bubble-content buddy-chat-typing",children:[r.jsx("span",{}),r.jsx("span",{}),r.jsx("span",{})]})]}),j&&r.jsxs("div",{className:"buddy-chat-error",children:[j,r.jsx("button",{onClick:()=>re(u),children:"Retry"})]}),r.jsx("div",{ref:te})]}),V?r.jsx("div",{className:"buddy-chat-done",children:F?(()=>{const E=ge(F);return r.jsxs(r.Fragment,{children:[r.jsx("p",{className:"buddy-chat-done-text",children:"Profile saved! Here's my pick for you:"}),r.jsxs("div",{className:"buddy-rec-card",onClick:()=>n("/client/core-buddy/programmes",{state:{templateId:E.id}}),children:[r.jsx("div",{className:"buddy-rec-name",children:E.name}),r.jsxs("div",{className:"buddy-rec-meta",children:[E.duration," weeks  ",E.daysPerWeek," days/week  ",E.level]}),r.jsx("div",{className:"buddy-rec-desc",children:E.description}),r.jsx("div",{className:"buddy-rec-cta",children:"View Programme"})]}),r.jsx("button",{className:"buddy-chat-skip-btn",onClick:()=>n("/client/core-buddy"),children:"Maybe later"})]})})():r.jsxs(r.Fragment,{children:[r.jsx("p",{className:"buddy-chat-done-text",children:"Profile saved  you're all set."}),r.jsx("button",{className:"buddy-chat-done-btn",onClick:()=>n("/client/core-buddy"),children:"Back to Dashboard"})]})}):r.jsxs("div",{className:"buddy-chat-input-wrap",children:[r.jsx("textarea",{ref:K,className:"buddy-chat-input",placeholder:"Type your message...",value:p,onChange:E=>g(E.target.value),onKeyDown:ve,rows:1,disabled:y}),r.jsx("button",{className:"buddy-chat-send",onClick:ye,disabled:!p.trim()||y,"aria-label":"Send message",children:r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("line",{x1:"22",y1:"2",x2:"11",y2:"13"}),r.jsx("polygon",{points:"22 2 15 22 11 13 2 9 22 2"})]})})]})]}),r.jsx(la,{active:"home"})]})})}const ga=[{key:"pressUps",name:"Press-Ups",category:"Upper Body",unit:"reps"},{key:"squats",name:"Squats",category:"Lower Body",unit:"reps"},{key:"longJump",name:"Standing Long Jump",category:"Power",unit:"distance"},{key:"deadHang",name:"Dead Hang",category:"Upper Body",unit:"time"},{key:"plank",name:"Plank",category:"Core",unit:"time"},{key:"wallSit",name:"Wall Sit",category:"Lower Body",unit:"time"},{key:"chestPress",name:"Chest Press",category:"Upper Body",unit:"weight"}],Po=[{key:"weight",name:"Weight",suffix:"kg"},{key:"chest",name:"Chest",suffix:"cm"},{key:"waist",name:"Waist",suffix:"cm"},{key:"hips",name:"Hips",suffix:"cm"},{key:"leftArm",name:"Left Arm",suffix:"cm"},{key:"rightArm",name:"Right Arm",suffix:"cm"},{key:"leftThigh",name:"Left Thigh",suffix:"cm"},{key:"rightThigh",name:"Right Thigh",suffix:"cm"}];function lP(){const n=new Date;return`${n.getFullYear()}-${String(n.getMonth()+1).padStart(2,"0")}`}function ya(n){const[e,t]=n.split("-");return new Date(parseInt(e),parseInt(t)-1).toLocaleDateString("en-GB",{month:"long",year:"numeric"})}function cP(n){if(!n&&n!==0)return"-";const e=Math.floor(n/60),t=(n%60).toFixed(2);return e>0?`${e}m ${parseFloat(t).toFixed(0)}s`:`${parseFloat(t).toFixed(2)}s`}function uP(n,e){return!n&&n!==0?"-":!e&&e!==0?`${n}kg`:`${n}kg x ${e}`}function hh(n,e){if(!e)return"-";switch(n.unit){case"weight":return uP(e.weight,e.reps);case"time":return cP(e.time);case"reps":return e.reps?`${e.reps} reps`:"-";case"distance":return e.distance?`${e.distance} cm`:"-";default:return"-"}}function Ol(n,e){if(!e)return 0;switch(n.unit){case"weight":return(e.weight||0)*(e.reps||0);case"time":return e.time||0;case"reps":return e.reps||0;case"distance":return e.distance||0;default:return 0}}function eg(n,e){return!e||e===0?null:(n-e)/e*100}function dP({data:n,exerciseKey:e,unit:t}){if(!n||n.length<2)return r.jsx("div",{className:"pb-trend-empty",children:r.jsx("p",{children:"Not enough data for trend line yet"})});const i=n.map(F=>{const U=F.benchmarks?.[e];if(!U)return 0;switch(t){case"weight":return(U.weight||0)*(U.reps||0);case"time":return U.time||0;case"reps":return U.reps||0;case"distance":return U.distance||0;default:return 0}}),l=Math.max(...i),u=Math.min(...i),d=l-u||1,p=300,g=100,y=20,w=p-y*2,j=g-y*2,T=i.map((F,U)=>{const te=y+U/(i.length-1)*w,K=y+j-(F-u)/d*j;return{x:te,y:K,value:F}}),V=T.map((F,U)=>`${U===0?"M":"L"} ${F.x} ${F.y}`).join(" "),$=V+` L ${T[T.length-1].x} ${y+j} L ${T[0].x} ${y+j} Z`;return r.jsxs("div",{className:"pb-trend-chart",children:[r.jsxs("svg",{viewBox:`0 0 ${p} ${g}`,preserveAspectRatio:"xMidYMid meet",children:[r.jsx("defs",{children:r.jsxs("linearGradient",{id:"trendGradientJr",x1:"0",y1:"0",x2:"0",y2:"1",children:[r.jsx("stop",{offset:"0%",stopColor:"var(--color-primary)",stopOpacity:"0.3"}),r.jsx("stop",{offset:"100%",stopColor:"var(--color-primary)",stopOpacity:"0.02"})]})}),r.jsx("path",{d:$,fill:"url(#trendGradientJr)"}),r.jsx("path",{d:V,fill:"none",stroke:"var(--color-primary)",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round"}),T.map((F,U)=>r.jsx("circle",{cx:F.x,cy:F.y,r:"4",fill:"var(--bg-card)",stroke:"var(--color-primary)",strokeWidth:"2"},U))]}),r.jsx("div",{className:"pb-trend-labels",children:n.map((F,U)=>r.jsxs("span",{className:"pb-trend-label",children:[F.month.split("-")[1],"/",F.month.split("-")[0].slice(2)]},U))})]})}function hP(){const[n,e]=v.useState("bests"),[t,i]=v.useState([]),[l,u]=v.useState(!0),[d,p]=v.useState(!1),[g,y]=v.useState(0),[w,j]=v.useState(!1),[T,V]=v.useState(!1),[$,F]=v.useState(!1),[U,te]=v.useState({}),[K,re]=v.useState({}),[ye,ve]=v.useState({}),[ge,R]=v.useState({}),[E,A]=v.useState({}),[O,D]=v.useState(!1),[H,I]=v.useState({}),[$e,xt]=v.useState([]),[W,he]=v.useState(null),[Pe,He]=v.useState(null),[ee,L]=v.useState(!1),[se,Le]=v.useState(""),[Oe,Ye]=v.useState(""),Ue=v.useRef(null),pt=v.useRef(0),Tt=v.useRef(0),at=v.useRef("right"),Gt=v.useCallback(q=>{y(xe=>{const Ee=Math.max(0,Math.min(ga.length-1,q));return Ee===xe?xe:(at.current=Ee>xe?"right":"left",Ee)})},[]),{currentUser:zs,isClient:yt,clientData:ut,loading:oe}=Vr(),{isDark:ss}=Ea(),Ht=Gn(),Dt=v.useCallback((q,xe="info")=>{He({message:q,type:xe}),setTimeout(()=>He(null),4e3)},[]);v.useEffect(()=>{!oe&&(!zs||!yt)&&Ht("/")},[zs,yt,oe,Ht]),v.useEffect(()=>{ut&&bt()},[ut]);const bt=async()=>{try{const q=Ps(Ft(fe,"juniorPBs"),fs("clientId","==",ut.id)),Ee=(await Ss(q)).docs.map(et=>({id:et.id,...et.data()}));Ee.sort((et,gt)=>et.month.localeCompare(gt.month)),i(Ee);const je=Ps(Ft(fe,"juniorPBTargets"),fs("clientId","==",ut.id)),ke=await Ss(je);if(!ke.empty){const et=ke.docs[0].data();ve(et.targets||{}),R(et.metricTargets||{}),A(et.targets||{}),I(et.metricTargets||{})}const ot=Ps(Ft(fe,"juniorAchievements"),fs("clientId","==",ut.id)),mt=await Ss(ot);mt.empty||xt(mt.docs[0].data().badges||[])}catch(q){console.error("Error fetching junior personal bests:",q)}u(!1)},Ge=lP(),Ze=t.find(q=>q.month===Ge),Et=t.filter(q=>q.month<Ge),rn=Et.length>0?Et[Et.length-1]:null;v.useEffect(()=>{Ze?(te(Ze.benchmarks||{}),re(Ze.bodyMetrics||{})):(te({}),re({}))},[Ze?.id]);const js=async(q,xe)=>{const Ee=[];if(q==="strength"?ga.forEach(je=>{const ke=ye[je.key];if(!ke)return;const ot=xe[je.key];if(!ot)return;let mt;if(ke.targetType==="time"){if(!ke.targetValue)return;const et=ke.startValue||0,gt=ot.time||0,Rt=ke.targetValue-et;mt=Rt===0?gt>=ke.targetValue?1:0:Math.max(0,(gt-et)/Rt)}else if(ke.targetType==="reps"){if(!ke.targetReps)return;const et=ke.startReps||0,gt=ot.reps||0,Rt=ke.targetReps-et;mt=Rt===0?gt>=ke.targetReps?1:0:Math.max(0,(gt-et)/Rt)}else if(ke.targetType==="distance"){if(!ke.targetDistance)return;const et=ke.startDistance||0,gt=ot.distance||0,Rt=ke.targetDistance-et;mt=Rt===0?gt>=ke.targetDistance?1:0:Math.max(0,(gt-et)/Rt)}else{if(!ke.targetWeight&&!ke.targetReps)return;const et=(ke.startWeight||0)*(ke.startReps||0),gt=(ke.targetWeight||0)*(ke.targetReps||0),Rt=(ot.weight||0)*(ot.reps||0),ws=gt-et;mt=ws===0?Rt>=gt?1:0:Math.max(0,(Rt-et)/ws)}if(mt>=1){let et,gt;ke.targetType==="time"?(et=$e.some(Rt=>Rt.type==="strength"&&Rt.key===je.key&&Rt.targetValue===ke.targetValue),gt=`${je.name} ${ke.targetValue}s`):ke.targetType==="reps"?(et=$e.some(Rt=>Rt.type==="strength"&&Rt.key===je.key&&Rt.targetReps===ke.targetReps),gt=`${je.name} ${ke.targetReps} reps`):ke.targetType==="distance"?(et=$e.some(Rt=>Rt.type==="strength"&&Rt.key===je.key&&Rt.targetDistance===ke.targetDistance),gt=`${je.name} ${ke.targetDistance}cm`):(et=$e.some(Rt=>Rt.type==="strength"&&Rt.key===je.key&&Rt.targetWeight===ke.targetWeight&&Rt.targetReps===ke.targetReps),gt=`${je.name} ${ke.targetWeight}kg  ${ke.targetReps}`),et||Ee.push({type:"strength",key:je.key,...ke.targetType==="time"?{targetType:"time",targetValue:ke.targetValue}:ke.targetType==="reps"?{targetType:"reps",targetReps:ke.targetReps}:ke.targetType==="distance"?{targetType:"distance",targetDistance:ke.targetDistance}:{targetWeight:ke.targetWeight,targetReps:ke.targetReps},achievedMonth:Ge,label:gt})}}):Po.forEach(je=>{const ke=ge[je.key];if(!ke||!ke.targetValue)return;const ot=xe[je.key];if(ot==null)return;const mt=ke.startValue||0,et=ke.targetValue,gt=et-mt;(gt===0?ot===et?1:0:Math.max(0,(ot-mt)/gt))>=1&&($e.some(_n=>_n.type==="metric"&&_n.key===je.key&&_n.targetValue===et)||Ee.push({type:"metric",key:je.key,targetValue:et,achievedMonth:Ge,label:`${je.name} ${et}${je.suffix}`}))}),Ee.length>0){const je=[...$e,...Ee];await Ns(qe(fe,"juniorAchievements",ut.id),{clientId:ut.id,badges:je,updatedAt:wt.now()}),xt(je),he(Ee),setTimeout(()=>he(null),5e3)}},Kt=(q,xe)=>{if(q==="strength"){const Ee=ye[xe];if(!Ee)return!1;switch(ga.find(ke=>ke.key===xe)?.unit){case"time":return $e.some(ke=>ke.type==="strength"&&ke.key===xe&&ke.targetValue===Ee.targetValue);case"reps":return $e.some(ke=>ke.type==="strength"&&ke.key===xe&&ke.targetReps===Ee.targetReps);case"distance":return $e.some(ke=>ke.type==="strength"&&ke.key===xe&&ke.targetDistance===Ee.targetDistance);default:return!Ee.targetWeight&&!Ee.targetReps?!1:$e.some(ke=>ke.type==="strength"&&ke.key===xe&&ke.targetWeight===Ee.targetWeight&&ke.targetReps===Ee.targetReps)}}else{const Ee=ge[xe];return!Ee||!Ee.targetValue?!1:$e.some(je=>je.type==="metric"&&je.key===xe&&je.targetValue===Ee.targetValue)}},St=async()=>{p(!0);try{const q=`${ut.id}_${Ge}`,xe=Ze||{};await Ns(qe(fe,"juniorPBs",q),{clientId:ut.id,month:Ge,benchmarks:U,bodyMetrics:xe.bodyMetrics||K||{},createdAt:xe.createdAt||wt.now(),updatedAt:wt.now()}),await js("strength",U),Dt("Benchmarks saved!","success"),j(!1),await bt()}catch(q){console.error("Error saving benchmarks:",q),Dt("Failed to save. Please try again.","error")}p(!1)},Yt=async()=>{p(!0);try{const q=`${ut.id}_${Ge}`,xe=Ze||{};await Ns(qe(fe,"juniorPBs",q),{clientId:ut.id,month:Ge,benchmarks:xe.benchmarks||U||{},bodyMetrics:K,createdAt:xe.createdAt||wt.now(),updatedAt:wt.now()}),await js("metric",K),Dt("Body metrics saved!","success"),V(!1),await bt()}catch(q){console.error("Error saving metrics:",q),Dt("Failed to save. Please try again.","error")}p(!1)},us=(q,xe,Ee)=>{te(je=>({...je,[q]:{...je[q],[xe]:Ee===""?"":parseFloat(Ee)}}))},es=(q,xe)=>{re(Ee=>({...Ee,[q]:xe===""?"":parseFloat(xe)}))},Xs=(q,xe,Ee)=>{A(je=>({...je,[q]:{...je[q],[xe]:Ee===""?"":parseFloat(Ee)}}))},Nt=async()=>{p(!0);try{const q=`targets_${ut.id}`,xe=Ze?.benchmarks||{},Ee={};ga.forEach(je=>{const ke=xe[je.key];switch(je.unit){case"time":E[je.key]?.targetValue&&(Ee[je.key]={targetType:"time",targetValue:E[je.key].targetValue,startValue:ke?.time||0});break;case"reps":E[je.key]?.targetReps&&(Ee[je.key]={targetType:"reps",targetReps:E[je.key].targetReps,startReps:ke?.reps||0});break;case"distance":E[je.key]?.targetDistance&&(Ee[je.key]={targetType:"distance",targetDistance:E[je.key].targetDistance,startDistance:ke?.distance||0});break;default:(E[je.key]?.targetWeight||E[je.key]?.targetReps)&&(Ee[je.key]={targetWeight:E[je.key].targetWeight||0,targetReps:E[je.key].targetReps||0,startWeight:ke?.weight||0,startReps:ke?.reps||0})}}),await Ns(qe(fe,"juniorPBTargets",q),{clientId:ut.id,targets:Ee,metricTargets:ge,updatedAt:wt.now()}),ve(Ee),A(Ee),Dt("Targets saved!","success"),F(!1)}catch(q){console.error("Error saving targets:",q),Dt("Failed to save targets.","error")}p(!1)},ps=(q,xe)=>{I(Ee=>({...Ee,[q]:{...Ee[q],targetValue:xe===""?"":parseFloat(xe)}}))},be=async()=>{p(!0);try{const q=`targets_${ut.id}`,xe={};Po.forEach(Ee=>{if(H[Ee.key]?.targetValue){const je=Ze?.bodyMetrics?.[Ee.key]||0;xe[Ee.key]={targetValue:H[Ee.key].targetValue,startValue:je}}}),await Ns(qe(fe,"juniorPBTargets",q),{clientId:ut.id,targets:ye,metricTargets:xe,updatedAt:wt.now()}),R(xe),I(xe),Dt("Metric targets saved!","success"),D(!1)}catch(q){console.error("Error saving metric targets:",q),Dt("Failed to save targets.","error")}p(!1)},De=async()=>{if(window.confirm("Reset all goals? This will clear all strength and body metric targets. Your recorded benchmarks and measurements will NOT be affected.")){p(!0);try{const q=qe(fe,"juniorPBTargets",`targets_${ut.id}`);await _r(q),ve({}),R({}),A({}),I({}),Dt("All goals have been reset","success")}catch(q){console.error("Error resetting targets:",q),Dt("Failed to reset goals","error")}p(!1)}},Y=(q,xe)=>{const Ee=ye[q];if(!Ee||!xe)return null;if(Ee.targetType==="time"){if(!Ee.targetValue)return null;const et=Ee.startValue||0,gt=Ee.targetValue,Rt=xe.time||0,ws=gt-et;return ws<=0?Rt>=gt?1:0:Math.max(0,Math.min((Rt-et)/ws,1))}if(Ee.targetType==="reps"){if(!Ee.targetReps)return null;const et=Ee.startReps||0,gt=Ee.targetReps,Rt=xe.reps||0,ws=gt-et;return ws<=0?Rt>=gt?1:0:Math.max(0,Math.min((Rt-et)/ws,1))}if(Ee.targetType==="distance"){if(!Ee.targetDistance)return null;const et=Ee.startDistance||0,gt=Ee.targetDistance,Rt=xe.distance||0,ws=gt-et;return ws<=0?Rt>=gt?1:0:Math.max(0,Math.min((Rt-et)/ws,1))}if(!Ee.targetWeight&&!Ee.targetReps)return null;const je=(Ee.startWeight||0)*(Ee.startReps||0),ke=(Ee.targetWeight||0)*(Ee.targetReps||0),ot=(xe.weight||0)*(xe.reps||0),mt=ke-je;return mt<=0?ot>=ke?1:0:Math.max(0,Math.min((ot-je)/mt,1))},we=q=>{const xe=ge[q];if(!xe||!xe.targetValue)return null;const Ee=Ze?.bodyMetrics?.[q];if(Ee==null)return null;const je=xe.startValue||0,ke=xe.targetValue,ot=ke-je;return ot===0?Ee===ke?1:0:Math.max(0,Math.min((Ee-je)/ot,1))},Ce=q=>{pt.current=q.touches[0].clientX,Tt.current=0},Me=q=>{Tt.current=q.touches[0].clientX-pt.current},Ae=()=>{Tt.current<-50?Gt(g+1):Tt.current>50&&Gt(g-1),Tt.current=0},it=q=>{const xe=Ze?.bodyMetrics?.[q],Ee=rn?.bodyMetrics?.[q];return xe==null||Ee==null?null:parseFloat((xe-Ee).toFixed(2))},Qe=t.find(q=>q.month===se),Q=t.find(q=>q.month===Oe);if(oe||l)return r.jsxs("div",{className:"pb-page",children:[r.jsx("header",{className:"client-header",children:r.jsx("div",{className:"header-content",children:r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})})}),r.jsxs("main",{className:"pb-main",children:[r.jsx("div",{className:"skeleton skeleton-title",style:{width:180,height:28,marginBottom:20}}),r.jsx("div",{className:"skeleton skeleton-card-large",style:{height:320,borderRadius:16}})]})]});if(!zs||!yt||!ut)return null;const ce=ga[g],ze=Ze?.benchmarks?.[ce.key],dt=rn?.benchmarks?.[ce.key],ht=Ol(ce,ze),Vt=Ol(ce,dt),Ct=eg(ht,Vt),At=Y(ce.key,ze),Ms=At!==null,Js=At!==null&&At>=1,ns=Ms?Math.round(At*60):ht>0?15:0,Cs=ye[ce.key],Ls=q=>q?q.targetType==="time"?`${q.startValue||0}s  ${q.targetValue}s`:q.targetType==="reps"?`${q.startReps||0}  ${q.targetReps} reps`:q.targetType==="distance"?`${q.startDistance||0}  ${q.targetDistance}cm`:`${q.startWeight||0}kg${q.startReps||0}  ${q.targetWeight}kg${q.targetReps}`:null;return r.jsxs("div",{className:"pb-page",children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>Ht("/client"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})]})}),r.jsxs("main",{className:"pb-main page-transition-enter",children:[r.jsxs("div",{className:"pb-intro",children:[r.jsx("h2",{children:"Junior Strength Tests"}),r.jsx("p",{children:"Track your strength test results and body measurements each month."})]}),r.jsxs("div",{className:"pb-tabs",children:[r.jsx("button",{className:`pb-tab ${n==="bests"?"active":""}`,onClick:()=>e("bests"),children:"Strength"}),r.jsx("button",{className:`pb-tab ${n==="metrics"?"active":""}`,onClick:()=>e("metrics"),children:"Body Metrics"}),r.jsx("button",{className:`pb-tab ${n==="history"?"active":""}`,onClick:()=>e("history"),children:"History"})]}),n==="bests"&&r.jsxs("div",{className:"pb-strength-section",children:[!w&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"pb-carousel",ref:Ue,onTouchStart:Ce,onTouchMove:Me,onTouchEnd:Ae,children:[r.jsx("div",{className:`pb-ring-container slide-from-${at.current}`,children:r.jsxs("div",{className:"pb-ring",children:[r.jsx("svg",{className:"pb-ring-svg",viewBox:"0 0 200 200",children:eb.map((q,xe)=>{const Ee=xe<Math.round(ns);return r.jsx("line",{x1:q.x1,y1:q.y1,x2:q.x2,y2:q.y2,className:`pb-ring-tick ${Ee?Js?"hit":"filled":"empty"}`,strokeWidth:q.thick?"3":"2"},xe)})}),r.jsxs("div",{className:"pb-ring-center",children:[r.jsx("div",{className:"pb-ring-category",children:ce.category}),r.jsxs("div",{className:"pb-ring-exercise",children:[ce.name,Kt("strength",ce.key)&&r.jsx("svg",{className:"pb-badge-icon",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})]}),r.jsx("div",{className:"pb-ring-value",children:ze?hh(ce,ze):"-"}),Ct!==null&&r.jsxs("div",{className:`pb-ring-change ${Ct>=0?"positive":"negative"}`,children:[Ct>=0?"+":"",Ct.toFixed(1),"%"]}),Ct===null&&ze&&r.jsx("div",{className:"pb-ring-change neutral",children:"New entry"}),Cs&&r.jsx("div",{className:`pb-ring-target ${Js?"hit":""}`,children:Js?"Target hit!":Ls(Cs)}),!Cs&&r.jsx("div",{className:"pb-ring-target none",children:"No target set"})]})]})},g),r.jsx("div",{className:"pb-carousel-dots",children:ga.map((q,xe)=>r.jsx("button",{className:`pb-dot ${xe===g?"active":""}`,onClick:()=>Gt(xe)},xe))}),r.jsx("button",{className:"pb-carousel-arrow left",onClick:()=>Gt(g-1),disabled:g===0,children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"})})}),r.jsx("button",{className:"pb-carousel-arrow right",onClick:()=>Gt(g+1),disabled:g===ga.length-1,children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M8.59 16.59L10 18l6-6-6-6-1.41 1.41L13.17 12z"})})})]}),r.jsxs("div",{className:"pb-trend-section",children:[r.jsx("h4",{children:"Trend"}),r.jsx(dP,{data:t,exerciseKey:ce.key,unit:ce.unit})]})]}),!w&&!$&&r.jsxs("div",{className:"pb-action-buttons",children:[r.jsx("button",{className:"pb-edit-btn",onClick:()=>j(!0),children:Ze?.benchmarks?"Edit This Month's Benchmarks":"Add This Month's Benchmarks"}),r.jsx("button",{className:"pb-edit-btn pb-target-btn",onClick:()=>F(!0),children:Object.keys(ye).length>0?"Edit Targets":"Set Targets"}),(Object.keys(ye).length>0||Object.keys(ge).length>0)&&r.jsx("button",{className:"pb-edit-btn pb-reset-btn",onClick:De,disabled:d,children:"Reset All Goals"})]}),w&&r.jsxs("div",{className:"pb-edit-card",children:[r.jsxs("div",{className:"pb-edit-header",children:[r.jsxs("h3",{children:["Benchmarks - ",ya(Ge)]}),r.jsx("button",{className:"pb-edit-close",onClick:()=>{j(!1),te(Ze?.benchmarks||{})},children:""})]}),r.jsx("div",{className:"pb-edit-body",children:ga.map(q=>r.jsxs("div",{className:"pb-edit-exercise",children:[r.jsx("div",{className:"pb-edit-exercise-name",children:q.name}),q.unit==="weight"?r.jsxs("div",{className:"pb-edit-row",children:[r.jsxs("div",{className:"pb-edit-field",children:[r.jsx("label",{children:"Weight (kg)"}),r.jsx("input",{type:"number",step:"0.5",value:U[q.key]?.weight??"",onChange:xe=>us(q.key,"weight",xe.target.value),placeholder:"0"})]}),r.jsxs("div",{className:"pb-edit-field",children:[r.jsx("label",{children:"Reps"}),r.jsx("input",{type:"number",value:U[q.key]?.reps??"",onChange:xe=>us(q.key,"reps",xe.target.value),placeholder:"0"})]})]}):q.unit==="reps"?r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsx("label",{children:"Reps (max in 1 min)"}),r.jsx("input",{type:"number",value:U[q.key]?.reps??"",onChange:xe=>us(q.key,"reps",xe.target.value),placeholder:"0"})]})}):q.unit==="distance"?r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsx("label",{children:"Distance (cm)"}),r.jsx("input",{type:"number",step:"0.5",value:U[q.key]?.distance??"",onChange:xe=>us(q.key,"distance",xe.target.value),placeholder:"0"})]})}):r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsx("label",{children:"Time (seconds)"}),r.jsx("input",{type:"number",step:"0.01",value:U[q.key]?.time??"",onChange:xe=>us(q.key,"time",xe.target.value),placeholder:"0"})]})})]},q.key))}),r.jsxs("div",{className:"pb-edit-actions",children:[r.jsx("button",{className:"pb-cancel-btn",onClick:()=>{j(!1),te(Ze?.benchmarks||{})},children:"Cancel"}),r.jsx("button",{className:"pb-save-btn",onClick:St,disabled:d,children:d?"Saving...":"Save"})]})]}),$&&r.jsxs("div",{className:"pb-edit-card",children:[r.jsxs("div",{className:"pb-edit-header",children:[r.jsx("h3",{children:"Set Your Targets"}),r.jsx("button",{className:"pb-edit-close",onClick:()=>{F(!1),A(ye)},children:""})]}),r.jsxs("div",{className:"pb-edit-body",children:[r.jsx("p",{className:"pb-target-hint",children:"Set a target for each exercise. Your current best is captured automatically from your latest benchmarks."}),ga.map(q=>{const xe=Ze?.benchmarks?.[q.key];let Ee="-";if(xe)switch(q.unit){case"weight":(xe.weight||xe.reps)&&(Ee=`${xe.weight||0}kg  ${xe.reps||0}`);break;case"time":xe.time&&(Ee=`${xe.time}s`);break;case"reps":xe.reps&&(Ee=`${xe.reps} reps`);break;case"distance":xe.distance&&(Ee=`${xe.distance} cm`);break}return r.jsxs("div",{className:"pb-edit-exercise",children:[r.jsxs("div",{className:"pb-edit-exercise-header",children:[r.jsx("div",{className:"pb-edit-exercise-name",children:q.name}),r.jsxs("div",{className:"pb-edit-current-best",children:["Current: ",Ee]})]}),q.unit==="weight"?r.jsxs("div",{className:"pb-edit-row",children:[r.jsxs("div",{className:"pb-edit-field",children:[r.jsx("label",{children:"Target Weight (kg)"}),r.jsx("input",{type:"number",step:"0.5",value:E[q.key]?.targetWeight??"",onChange:je=>Xs(q.key,"targetWeight",je.target.value),placeholder:"0"})]}),r.jsxs("div",{className:"pb-edit-field",children:[r.jsx("label",{children:"Target Reps"}),r.jsx("input",{type:"number",value:E[q.key]?.targetReps??"",onChange:je=>Xs(q.key,"targetReps",je.target.value),placeholder:"0"})]})]}):q.unit==="reps"?r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsx("label",{children:"Target Reps (in 1 min)"}),r.jsx("input",{type:"number",value:E[q.key]?.targetReps??"",onChange:je=>Xs(q.key,"targetReps",je.target.value),placeholder:"0"})]})}):q.unit==="distance"?r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsx("label",{children:"Target Distance (cm)"}),r.jsx("input",{type:"number",step:"0.5",value:E[q.key]?.targetDistance??"",onChange:je=>Xs(q.key,"targetDistance",je.target.value),placeholder:"0"})]})}):r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsx("label",{children:"Target (seconds)"}),r.jsx("input",{type:"number",step:"1",value:E[q.key]?.targetValue??"",onChange:je=>Xs(q.key,"targetValue",je.target.value),placeholder:"0"})]})})]},q.key)})]}),r.jsxs("div",{className:"pb-edit-actions",children:[r.jsx("button",{className:"pb-cancel-btn",onClick:()=>{F(!1),A(ye)},children:"Cancel"}),r.jsx("button",{className:"pb-save-btn",onClick:Nt,disabled:d,children:d?"Saving...":"Save Targets"})]})]})]}),n==="metrics"&&r.jsxs("div",{className:"pb-metrics-section",children:[!T&&!O&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"pb-metrics-card",children:[r.jsx("h3",{children:"Body Measurements"}),r.jsx("p",{className:"pb-metrics-month",children:ya(Ge)}),r.jsx("div",{className:"pb-metrics-list",children:Po.map(q=>{const xe=Ze?.bodyMetrics?.[q.key],Ee=it(q.key),je=ge[q.key],ke=we(q.key),ot=ke!==null&&ke>=1;return r.jsxs("div",{className:"pb-metric-row",children:[r.jsxs("div",{className:"pb-metric-top",children:[r.jsxs("div",{className:"pb-metric-left",children:[r.jsxs("span",{className:"pb-metric-name",children:[q.name,Kt("metric",q.key)&&r.jsx("svg",{className:"pb-badge-icon-sm",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})]}),je&&r.jsxs("span",{className:"pb-metric-target-label",children:["Target: ",je.targetValue," ",q.suffix]})]}),r.jsxs("div",{className:"pb-metric-values",children:[r.jsx("span",{className:"pb-metric-current",children:xe!=null?`${xe} ${q.suffix}`:"-"}),Ee!==null&&r.jsxs("span",{className:`pb-metric-change ${Ee>0?"up":Ee<0?"down":"same"}`,children:[Ee>0?"+":"",Ee," ",q.suffix]})]})]}),ke!==null&&r.jsxs("div",{className:"pb-metric-progress",children:[r.jsx("div",{className:"pb-metric-bar",children:r.jsx("div",{className:`pb-metric-bar-fill ${ot?"hit":""}`,style:{width:`${Math.round(ke*100)}%`}})}),r.jsx("span",{className:`pb-metric-percent ${ot?"hit":""}`,children:ot?"Hit!":`${Math.round(ke*100)}%`})]})]},q.key)})})]}),r.jsxs("div",{className:"pb-action-buttons",children:[r.jsx("button",{className:"pb-edit-btn",onClick:()=>V(!0),children:Ze?.bodyMetrics?"Edit This Month's Measurements":"Add This Month's Measurements"}),r.jsx("button",{className:"pb-edit-btn pb-target-btn",onClick:()=>D(!0),children:Object.keys(ge).length>0?"Edit Targets":"Set Targets"}),(Object.keys(ye).length>0||Object.keys(ge).length>0)&&r.jsx("button",{className:"pb-edit-btn pb-reset-btn",onClick:De,disabled:d,children:"Reset All Goals"})]})]}),T&&r.jsxs("div",{className:"pb-edit-card",children:[r.jsxs("div",{className:"pb-edit-header",children:[r.jsxs("h3",{children:["Measurements - ",ya(Ge)]}),r.jsx("button",{className:"pb-edit-close",onClick:()=>{V(!1),re(Ze?.bodyMetrics||{})},children:""})]}),r.jsx("div",{className:"pb-edit-body",children:Po.map(q=>r.jsx("div",{className:"pb-edit-metric",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsxs("label",{children:[q.name," (",q.suffix,")"]}),r.jsx("input",{type:"number",step:"0.1",value:K[q.key]??"",onChange:xe=>es(q.key,xe.target.value),placeholder:"0"})]})},q.key))}),r.jsxs("div",{className:"pb-edit-actions",children:[r.jsx("button",{className:"pb-cancel-btn",onClick:()=>{V(!1),re(Ze?.bodyMetrics||{})},children:"Cancel"}),r.jsx("button",{className:"pb-save-btn",onClick:Yt,disabled:d,children:d?"Saving...":"Save"})]})]}),O&&r.jsxs("div",{className:"pb-edit-card",children:[r.jsxs("div",{className:"pb-edit-header",children:[r.jsx("h3",{children:"Body Metric Targets"}),r.jsx("button",{className:"pb-edit-close",onClick:()=>{D(!1),I(ge)},children:""})]}),r.jsxs("div",{className:"pb-edit-body",children:[r.jsx("p",{className:"pb-target-hint",children:"Set targets for your body measurements. Your current measurement is captured automatically."}),Po.map(q=>{const xe=Ze?.bodyMetrics?.[q.key];return r.jsxs("div",{className:"pb-edit-exercise",children:[r.jsxs("div",{className:"pb-edit-exercise-header",children:[r.jsx("div",{className:"pb-edit-exercise-name",children:q.name}),r.jsxs("div",{className:"pb-edit-current-best",children:["Current: ",xe!=null?`${xe} ${q.suffix}`:"-"]})]}),r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsxs("label",{children:["Target (",q.suffix,")"]}),r.jsx("input",{type:"number",step:"0.1",value:H[q.key]?.targetValue??"",onChange:Ee=>ps(q.key,Ee.target.value),placeholder:"0"})]})})]},q.key)})]}),r.jsxs("div",{className:"pb-edit-actions",children:[r.jsx("button",{className:"pb-cancel-btn",onClick:()=>{D(!1),I(ge)},children:"Cancel"}),r.jsx("button",{className:"pb-save-btn",onClick:be,disabled:d,children:d?"Saving...":"Save Targets"})]})]})]}),n==="history"&&r.jsx("div",{className:"pb-history-section",children:t.length===0?r.jsxs("div",{className:"pb-empty",children:[r.jsx("h4",{children:"No records yet"}),r.jsx("p",{children:"Start adding your monthly benchmarks and measurements to track your progress over time."})]}):r.jsxs(r.Fragment,{children:[$e.length>0&&r.jsxs("div",{className:"pb-achievements-wall",children:[r.jsxs("h4",{className:"pb-achievements-wall-title",children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"18",height:"18",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),"Targets Achieved"]}),r.jsx("div",{className:"pb-achievements-list",children:[...$e].reverse().map((q,xe)=>r.jsxs("div",{className:"pb-achievement-item",style:{animationDelay:`${xe*.05}s`},children:[r.jsx("div",{className:"pb-achievement-star",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),r.jsxs("div",{className:"pb-achievement-info",children:[r.jsx("span",{className:"pb-achievement-label",children:q.label}),r.jsx("span",{className:"pb-achievement-date",children:ya(q.achievedMonth)})]})]},xe))})]}),r.jsx("div",{className:"pb-history-controls",children:r.jsx("button",{className:`pb-compare-toggle ${ee?"active":""}`,onClick:()=>{L(!ee),!ee&&t.length>=2&&(Le(t[0].month),Ye(t[t.length-1].month))},children:ee?"Back to Timeline":"Compare Months"})}),ee?r.jsxs("div",{className:"pb-compare",children:[r.jsxs("div",{className:"pb-compare-selectors",children:[r.jsxs("div",{className:"pb-compare-select",children:[r.jsx("label",{children:"From"}),r.jsx("select",{value:se,onChange:q=>Le(q.target.value),children:t.map(q=>r.jsx("option",{value:q.month,children:ya(q.month)},q.month))})]}),r.jsx("div",{className:"pb-compare-vs",children:"vs"}),r.jsxs("div",{className:"pb-compare-select",children:[r.jsx("label",{children:"To"}),r.jsx("select",{value:Oe,onChange:q=>Ye(q.target.value),children:t.map(q=>r.jsx("option",{value:q.month,children:ya(q.month)},q.month))})]})]}),Qe&&Q&&r.jsxs("div",{className:"pb-compare-results",children:[r.jsxs("div",{className:"pb-compare-group",children:[r.jsx("h4",{children:"Strength Tests"}),r.jsxs("div",{className:"pb-compare-table",children:[r.jsxs("div",{className:"pb-compare-header-row",children:[r.jsx("span",{children:"Exercise"}),r.jsx("span",{children:ya(se).split(" ")[0]}),r.jsx("span",{children:ya(Oe).split(" ")[0]}),r.jsx("span",{children:"Change"})]}),ga.map(q=>{const xe=Qe.benchmarks?.[q.key],Ee=Q.benchmarks?.[q.key],je=Ol(q,xe),ke=Ol(q,Ee),ot=eg(ke,je);return r.jsxs("div",{className:"pb-compare-row",children:[r.jsx("span",{className:"pb-compare-name",children:q.name}),r.jsx("span",{className:"pb-compare-val",children:xe?hh(q,xe):"-"}),r.jsx("span",{className:"pb-compare-val",children:Ee?hh(q,Ee):"-"}),r.jsx("span",{className:`pb-compare-change ${ot!==null?ot>=0?"positive":"negative":""}`,children:ot!==null?`${ot>=0?"+":""}${ot.toFixed(1)}%`:"-"})]},q.key)})]})]}),r.jsxs("div",{className:"pb-compare-group",children:[r.jsx("h4",{children:"Body Measurements"}),r.jsxs("div",{className:"pb-compare-table",children:[r.jsxs("div",{className:"pb-compare-header-row",children:[r.jsx("span",{children:"Measurement"}),r.jsx("span",{children:ya(se).split(" ")[0]}),r.jsx("span",{children:ya(Oe).split(" ")[0]}),r.jsx("span",{children:"Change"})]}),Po.map(q=>{const xe=Qe.bodyMetrics?.[q.key],Ee=Q.bodyMetrics?.[q.key],je=xe!=null&&Ee!=null?parseFloat((Ee-xe).toFixed(2)):null;return r.jsxs("div",{className:"pb-compare-row",children:[r.jsx("span",{className:"pb-compare-name",children:q.name}),r.jsx("span",{className:"pb-compare-val",children:xe!=null?`${xe}`:"-"}),r.jsx("span",{className:"pb-compare-val",children:Ee!=null?`${Ee}`:"-"}),r.jsx("span",{className:`pb-compare-change ${je!==null?je>0?"positive":je<0?"negative":"neutral":""}`,children:je!==null?`${je>0?"+":""}${je} ${q.suffix}`:"-"})]},q.key)})]})]})]})]}):r.jsx("div",{className:"pb-timeline",children:[...t].reverse().map((q,xe)=>{const Ee=t.filter(je=>je.month<q.month).pop();return r.jsxs("div",{className:"pb-timeline-item",style:{animationDelay:`${xe*.05}s`},children:[r.jsx("div",{className:"pb-timeline-dot"}),r.jsxs("div",{className:"pb-timeline-card",children:[r.jsx("h4",{children:ya(q.month)}),q.benchmarks&&Object.keys(q.benchmarks).length>0&&r.jsxs("div",{className:"pb-timeline-group",children:[r.jsx("h5",{children:"Strength Tests"}),ga.map(je=>{const ke=q.benchmarks[je.key];if(!ke)return null;const ot=Ee?.benchmarks?.[je.key],mt=Ol(je,ke),et=Ol(je,ot),gt=eg(mt,et);return r.jsxs("div",{className:"pb-timeline-row",children:[r.jsx("span",{className:"pb-timeline-label",children:je.name}),r.jsxs("div",{className:"pb-timeline-values",children:[r.jsx("span",{className:"pb-timeline-value",children:hh(je,ke)}),gt!==null&&r.jsxs("span",{className:`pb-timeline-change ${gt>=0?"positive":"negative"}`,children:[gt>=0?"+":"",gt.toFixed(1),"%"]})]})]},je.key)})]}),q.bodyMetrics&&Object.keys(q.bodyMetrics).length>0&&r.jsxs("div",{className:"pb-timeline-group",children:[r.jsx("h5",{children:"Body Measurements"}),Po.map(je=>{const ke=q.bodyMetrics[je.key];if(ke==null)return null;const ot=Ee?.bodyMetrics?.[je.key],mt=ot!=null?parseFloat((ke-ot).toFixed(2)):null;return r.jsxs("div",{className:"pb-timeline-row",children:[r.jsx("span",{className:"pb-timeline-label",children:je.name}),r.jsxs("div",{className:"pb-timeline-values",children:[r.jsxs("span",{className:"pb-timeline-value",children:[ke," ",je.suffix]}),mt!==null&&r.jsxs("span",{className:`pb-timeline-change ${mt>0?"positive":mt<0?"negative":"neutral"}`,children:[mt>0?"+":"",mt," ",je.suffix]})]})]},je.key)})]})]})]},q.id)})})]})})]}),W&&r.jsx("div",{className:"pb-celebration-overlay",onClick:()=>he(null),children:r.jsxs("div",{className:"pb-celebration-card",children:[r.jsx("div",{className:"pb-celebration-icon",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),r.jsx("h3",{className:"pb-celebration-title",children:W.length===1?"Target Achieved!":`${W.length} Targets Achieved!`}),r.jsx("div",{className:"pb-celebration-badges",children:W.map((q,xe)=>r.jsx("div",{className:"pb-celebration-badge",children:q.label},xe))}),r.jsx("p",{className:"pb-celebration-sub",children:"Tap to dismiss"})]})}),Pe&&r.jsxs("div",{className:`toast-notification ${Pe.type}`,children:[r.jsx("span",{className:"toast-icon",children:Pe.type==="success"?r.jsx("svg",{className:"success-check-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{className:"check-path",d:"M5 13 L9 17 L19 7"})}):r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})}),r.jsx("span",{className:"toast-message",children:Pe.message}),r.jsx("button",{className:"toast-close",onClick:()=>He(null),children:""})]}),r.jsxs("nav",{className:"block-bottom-nav",children:[r.jsxs("button",{className:"block-nav-tab",onClick:()=>Ht("/client"),children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}),r.jsx("polyline",{points:"9 22 9 12 15 12 15 22"})]}),r.jsx("span",{children:"Home"})]}),r.jsxs("button",{className:"block-nav-tab",onClick:()=>Ht("/client/forms"),children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),r.jsx("polyline",{points:"14 2 14 8 20 8"}),r.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),r.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"})]}),r.jsx("span",{children:"Forms"})]}),r.jsxs("button",{className:"block-nav-tab",onClick:()=>Ht("/client/tools"),children:[r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"})}),r.jsx("span",{children:"Tools"})]}),r.jsxs("button",{className:"block-nav-tab active",children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M12 20V10"}),r.jsx("path",{d:"M18 20V4"}),r.jsx("path",{d:"M6 20v-4"})]}),r.jsx("span",{children:"PBs"})]}),ut?.circuitAccess&&r.jsxs("button",{className:"block-nav-tab",onClick:()=>Ht("/client/circuit"),children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("path",{d:"M12 6v6l4 2"})]}),r.jsx("span",{children:"Circuit"})]})]})]})}const zk=[{name:"Dumbbell Floor Press",type:"weighted",equipment:"dumbbells",group:"push",pbKey:"chestPress",storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Seated Dumbbell Shoulder Press",type:"weighted",equipment:"dumbbells",group:"push",pbKey:"shoulderPress",storagePath:"exercises/dumbbells/upper/seated dumbbell shoulder press.mp4"},{name:"Seated Dumbbell Arnold Press",type:"weighted",equipment:"dumbbells",group:"push",storagePath:"exercises/dumbbells/upper/seated dumbbell arnold press.mp4"},{name:"Dumbbell Overhead Tricep Extension",type:"weighted",equipment:"dumbbells",group:"push",storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Skullcrushers",type:"weighted",equipment:"dumbbells",group:"push",storagePath:"exercises/dumbbells/upper/skullcrushers.mp4"},{name:"Dumbbell Lateral Raise",type:"weighted",equipment:"dumbbells",group:"push",storagePath:"exercises/dumbbells/upper/dumbbell lateral raise.mp4"},{name:"Dumbbell Front Raise",type:"weighted",equipment:"dumbbells",group:"push",storagePath:"exercises/dumbbells/upper/dumbbell front raise.mp4"},{name:"Press Up",type:"reps",equipment:"bodyweight",group:"push",storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Tricep Dips",type:"reps",equipment:"bodyweight",group:"push",storagePath:"exercises/bodyweight/upper/tricep dips.mp4"},{name:"Pike Push Ups",type:"reps",equipment:"bodyweight",group:"push",storagePath:"exercises/bodyweight/upper/pike push ups.GIF"},{name:"Reverse Plank",type:"timed",equipment:"bodyweight",group:"push",storagePath:"exercises/bodyweight/upper/reverse plank.GIF"},{name:"Dumbbell Squeeze Press",type:"weighted",equipment:"dumbbells",group:"push",storagePath:null},{name:"Incline Dumbbell Press",type:"weighted",equipment:"dumbbells",group:"push",storagePath:null},{name:"Dumbbell Pullover",type:"weighted",equipment:"dumbbells",group:"push",storagePath:null},{name:"Dumbbell Fly",type:"weighted",equipment:"dumbbells",group:"push",storagePath:null},{name:"Tricep Kickback",type:"weighted",equipment:"dumbbells",group:"push",storagePath:null},{name:"Dumbbell Shrug",type:"weighted",equipment:"dumbbells",group:"push",storagePath:null},{name:"Dumbbell Y-Raise",type:"weighted",equipment:"dumbbells",group:"push",storagePath:null},{name:"Wide Press Up",type:"reps",equipment:"bodyweight",group:"push",storagePath:null},{name:"Diamond Press Up",type:"reps",equipment:"bodyweight",group:"push",storagePath:null},{name:"Decline Press Up",type:"reps",equipment:"bodyweight",group:"push",storagePath:null},{name:"Wall Walks",type:"reps",equipment:"bodyweight",group:"push",storagePath:null},{name:"Press Up Hold",type:"timed",equipment:"bodyweight",group:"push",storagePath:null},{name:"Shoulder Tap Hold",type:"timed",equipment:"bodyweight",group:"push",storagePath:null},{name:"Dumbbell Bent Over Row",type:"weighted",equipment:"dumbbells",group:"pull",pbKey:"seatedRow",storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Single Arm Bent Over Row",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Bicep Curl",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Hammer Curl",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:"exercises/dumbbells/upper/hammer curl.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Renegade Row",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:"exercises/dumbbells/upper/renegade row.mp4"},{name:"Wide Dumbbell Bent Over Row",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:null},{name:"Reverse Fly",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:null},{name:"Concentration Curl",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:null},{name:"Wide Grip Bicep Curl",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:null},{name:"Wrist Curl",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:null},{name:"Prone Y-T-W Raises",type:"reps",equipment:"bodyweight",group:"pull",storagePath:null},{name:"Reverse Snow Angel",type:"reps",equipment:"bodyweight",group:"pull",storagePath:null},{name:"Isometric Bicep Hold",type:"timed",equipment:"bodyweight",group:"pull",storagePath:null},{name:"Dumbbell Goblet Squats",type:"weighted",equipment:"dumbbells",group:"lower",pbKey:"squat",storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Romanian Deadlifts",type:"weighted",equipment:"dumbbells",group:"lower",pbKey:"deadlift",storagePath:"exercises/dumbbells/lower/romanian deadlifts.GIF"},{name:"Forward Dumbbell Lunges",type:"weighted",equipment:"dumbbells",group:"lower",storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.GIF"},{name:"Dumbbell Sumo Squats",type:"weighted",equipment:"dumbbells",group:"lower",storagePath:"exercises/dumbbells/lower/dumbbell sumo squats.GIF"},{name:"Weighted Calf Raises",type:"weighted",equipment:"dumbbells",group:"lower",storagePath:"exercises/dumbbells/lower/weighted calf raises.GIF"},{name:"1 Legged RDL",type:"weighted",equipment:"dumbbells",group:"lower",storagePath:"exercises/dumbbells/lower/1 legged rdl.GIF"},{name:"Dumbbell Box Step Ups",type:"weighted",equipment:"dumbbells",group:"lower",storagePath:"exercises/dumbbells/lower/dumbbell box step ups.mp4"},{name:"Dumbbell Squat Pulses",type:"weighted",equipment:"dumbbells",group:"lower",storagePath:"exercises/dumbbells/lower/dumbbell squat pulses.GIF"},{name:"Dumbbell Reverse Lunges",type:"weighted",equipment:"dumbbells",group:"lower",storagePath:"exercises/dumbbells/lower/dumbbell reverse lunges.GIF"},{name:"Kettlebell Romanian Deadlift",type:"weighted",equipment:"kettlebell",group:"lower",storagePath:"exercises/kettlebells/lower/kettlebell romanian deadlift.mp4"},{name:"Reverse Lunge",type:"reps",equipment:"bodyweight",group:"lower",storagePath:"exercises/bodyweight/lower/reverse lunge.GIF"},{name:"Box Step Ups",type:"reps",equipment:"bodyweight",group:"lower",storagePath:"exercises/bodyweight/lower/box step ups.GIF"},{name:"Bulgarian Split Squats",type:"reps",equipment:"bodyweight",group:"lower",storagePath:"exercises/bodyweight/lower/bulgarian split squats.GIF"},{name:"Jump Squats",type:"reps",equipment:"bodyweight",group:"lower",storagePath:"exercises/bodyweight/lower/jump squats.GIF"},{name:"Hip Thrusts",type:"reps",equipment:"bodyweight",group:"lower",storagePath:"exercises/bodyweight/lower/hip thrusts.GIF"},{name:"Donkey Kicks",type:"reps",equipment:"bodyweight",group:"lower",storagePath:"exercises/bodyweight/lower/donkey kicks.GIF"},{name:"Skater Jumps",type:"reps",equipment:"bodyweight",group:"lower",storagePath:"exercises/bodyweight/lower/skater jumps.GIF"},{name:"Squat And Hold",type:"timed",equipment:"bodyweight",group:"lower",storagePath:"exercises/bodyweight/lower/squat and hold.GIF"},{name:"Forearm Plank",type:"timed",equipment:"bodyweight",group:"core",pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"},{name:"Side Plank",type:"timed",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Side Plank.mp4"},{name:"Hollow Body Hold",type:"timed",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"},{name:"Superman Hold",type:"timed",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Superman Hold.mp4"},{name:"Mountain Climbers",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Mountain Climbers.mp4"},{name:"Fast Mountain Climbers",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Fast Mountain Climbers.mp4"},{name:"Cross Body Mountain Climbers",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Cross Body Mountain Climbers.mp4"},{name:"Russian Twist",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Russian Twist.mp4"},{name:"Crunch",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Crunch.mp4"},{name:"Bicycle Crunch",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Bicycle Crunch.mp4"},{name:"Leg Raises",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Leg Raises.mp4"},{name:"Dead Bug",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Dead Bug.mp4"},{name:"Dead Bug Single Leg Drop",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Dead Bug Single Leg Drop.mp4"},{name:"Bird Dog",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Bird Dog.mp4"},{name:"Flutter Kicks",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Flutter Kicks.mp4"},{name:"Hollow Hold Flutter Kicks",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Hollow Hold Flutter Kicks.mp4"},{name:"High Plank Shoulder Taps",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/High Plank Shoulder Taps.mp4"},{name:"Hip Dips Plank",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Hip Dips Plank.mp4"},{name:"Single Leg V-Up",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Single Leg V-Up.mp4"},{name:"Hollow Hold To V-Sit",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Hollow Hold To V-sit.mp4"},{name:"Toe Reaches",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/toe reaches.GIF"},{name:"Side Plank Rotation",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Side Plank Rotation.mp4"},{name:"Plank Walkout",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Plank Walkout.mp4"},{name:"Reverse Crunch To Leg Raise",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Reverse Crunch To Leg Raise.mp4"},{name:"Burpee",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Russian Twists Dumbbell",type:"weighted",equipment:"dumbbells",group:"core",storagePath:"exercises/dumbbells/core/russian twists dumbbell.GIF"},{name:"Kettlebell Russian Twist",type:"weighted",equipment:"kettlebell",group:"core",storagePath:"exercises/kettlebells/core/kettlebell russian twist.mp4"},{name:"Kettlebell Side Bends",type:"weighted",equipment:"kettlebell",group:"core",storagePath:"exercises/kettlebells/core/kettlebell side bends.mp4"},{name:"Kneeling Kettlebell Halo",type:"weighted",equipment:"kettlebell",group:"core",storagePath:"exercises/kettlebells/core/kneeling kettlebell halo.mp4"},{name:"Kettlebell Bird Dog Drag",type:"reps",equipment:"kettlebell",group:"core",storagePath:"exercises/kettlebells/core/kettlebell bird dog drag.mp4"},{name:"Back Extension Hold",type:"timed",equipment:"bodyweight",group:"core",storagePath:null},{name:"Dumbbell Plank Pull Through",type:"weighted",equipment:"dumbbells",group:"core",storagePath:null}];zk.filter(n=>n.storagePath!==null);const mP=[{key:"push",label:"Push",subtitle:"Chest / Shoulders / Triceps",color:"#A12F3A",icon:"M4 10v4M8 7v10M8 12h8M16 7v10M20 10v4"},{key:"pull",label:"Pull",subtitle:"Back / Biceps",color:"#2196f3",icon:"M4 12h16M12 4v16M7 7l10 10M17 7L7 17"},{key:"lower",label:"Lower",subtitle:"Legs / Glutes",color:"#ff9800",icon:"M13 2L3 14h9l-1 8 10-12h-9l1-8z"},{key:"core",label:"Core",subtitle:"Abs / Stability",color:"#7c3aed",icon:"M12 22c5.52 0 10-4.48 10-10S17.52 2 12 2 2 6.48 2 12s4.48 10 10 10zM12 18c3.31 0 6-2.69 6-6s-2.69-6-6-6-6 2.69-6 6 2.69 6 6 6zM12 14a2 2 0 1 0 0-4 2 2 0 0 0 0 4z"}],qk={};zk.forEach(n=>{qk[n.name]=n.group});function fP(n){return qk[n]||null}const Ma=[{key:"chestPress",name:"Chest Press",category:"Upper Body - Push",unit:"weight"},{key:"shoulderPress",name:"Shoulder Press",category:"Upper Body - Push",unit:"weight"},{key:"seatedRow",name:"Seated Row",category:"Upper Body - Pull",unit:"weight"},{key:"latPulldown",name:"Lat Pulldown",category:"Upper Body - Pull",unit:"weight"},{key:"squat",name:"Squat",category:"Lower Body",unit:"weight"},{key:"deadlift",name:"Deadlift",category:"Lower Body",unit:"weight"},{key:"plank",name:"Plank",category:"Core",unit:"time"}],Lo=[{key:"weight",name:"Weight",suffix:"kg"},{key:"chest",name:"Chest",suffix:"cm"},{key:"waist",name:"Waist",suffix:"cm"},{key:"hips",name:"Hips",suffix:"cm"},{key:"leftArm",name:"Left Arm",suffix:"cm"},{key:"rightArm",name:"Right Arm",suffix:"cm"},{key:"leftThigh",name:"Left Thigh",suffix:"cm"},{key:"rightThigh",name:"Right Thigh",suffix:"cm"}];function pP(){const n=new Date;return`${n.getFullYear()}-${String(n.getMonth()+1).padStart(2,"0")}`}function ba(n){const[e,t]=n.split("-");return new Date(parseInt(e),parseInt(t)-1).toLocaleDateString("en-GB",{month:"long",year:"numeric"})}function mh(n){if(!n&&n!==0)return"-";const e=Math.floor(n/60),t=(n%60).toFixed(2);return e>0?`${e}m ${parseFloat(t).toFixed(0)}s`:`${parseFloat(t).toFixed(2)}s`}function M2(n,e){return!n&&n!==0?"-":!e&&e!==0?`${n}kg`:`${n}kg x ${e}`}function Vl(n,e){return e?n.unit==="time"?e.time||0:(e.weight||0)*(e.reps||0):0}function tg(n,e){return!e||e===0?null:(n-e)/e*100}function gP({data:n,exerciseKey:e,unit:t}){if(!n||n.length<2)return r.jsx("div",{className:"pb-trend-empty",children:r.jsx("p",{children:"Not enough data for trend line yet"})});const i=n.map(F=>{const U=F.benchmarks?.[e];return U?t==="time"?U.time||0:(U.weight||0)*(U.reps||0):0}),l=Math.max(...i),u=Math.min(...i),d=l-u||1,p=300,g=100,y=20,w=p-y*2,j=g-y*2,T=i.map((F,U)=>{const te=y+U/(i.length-1)*w,K=y+j-(F-u)/d*j;return{x:te,y:K,value:F}}),V=T.map((F,U)=>`${U===0?"M":"L"} ${F.x} ${F.y}`).join(" "),$=V+` L ${T[T.length-1].x} ${y+j} L ${T[0].x} ${y+j} Z`;return r.jsxs("div",{className:"pb-trend-chart",children:[r.jsxs("svg",{viewBox:`0 0 ${p} ${g}`,preserveAspectRatio:"xMidYMid meet",children:[r.jsx("defs",{children:r.jsxs("linearGradient",{id:"trendGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[r.jsx("stop",{offset:"0%",stopColor:"var(--color-primary)",stopOpacity:"0.3"}),r.jsx("stop",{offset:"100%",stopColor:"var(--color-primary)",stopOpacity:"0.02"})]})}),r.jsx("path",{d:$,fill:"url(#trendGradient)"}),r.jsx("path",{d:V,fill:"none",stroke:"var(--color-primary)",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round"}),T.map((F,U)=>r.jsx("circle",{cx:F.x,cy:F.y,r:"4",fill:"var(--bg-card)",stroke:"var(--color-primary)",strokeWidth:"2"},U))]}),r.jsx("div",{className:"pb-trend-labels",children:n.map((F,U)=>r.jsxs("span",{className:"pb-trend-label",children:[F.month.split("-")[1],"/",F.month.split("-")[0].slice(2)]},U))})]})}function yP(){const[n,e]=v.useState("bests"),[t,i]=v.useState([]),[l,u]=v.useState(!0),[d,p]=v.useState(!1),[g,y]=v.useState(0),[w,j]=v.useState(!1),[T,V]=v.useState(!1),[$,F]=v.useState(!1),[U,te]=v.useState({}),[K,re]=v.useState({}),[ye,ve]=v.useState({}),[ge,R]=v.useState({}),[E,A]=v.useState({}),[O,D]=v.useState(!1),[H,I]=v.useState({}),[$e,xt]=v.useState([]),[W,he]=v.useState(null),[Pe,He]=v.useState(null),[ee,L]=v.useState(!1),[se,Le]=v.useState(""),[Oe,Ye]=v.useState(""),[Ue,pt]=v.useState({}),[Tt,at]=v.useState({}),[Gt,zs]=v.useState(null),[yt,ut]=v.useState(null),[oe,ss]=v.useState(""),[Ht,Dt]=v.useState({}),bt=v.useRef(null),Ge=v.useRef(0),Ze=v.useRef(0),Et=v.useRef("right"),rn=v.useCallback(k=>{y(N=>{const P=Math.max(0,Math.min(Ma.length-1,k));return P===N?N:(Et.current=P>N?"right":"left",P)})},[]),{currentUser:js,isClient:Kt,clientData:St,loading:Yt}=Vr(),{isDark:us}=Ea(),es=Gn(),[Xs]=iS(),Nt=Xs.get("mode")==="corebuddy",ps=!Nt&&(!St?.clientType||St.clientType==="block"),be=v.useCallback((k,N="info")=>{He({message:k,type:N}),setTimeout(()=>He(null),4e3)},[]);v.useEffect(()=>{!Yt&&(!js||!Kt)&&es("/")},[js,Kt,Yt,es]),v.useEffect(()=>{St&&(ps?De():(async()=>{try{const[N,P,B]=await Promise.all([As(qe(fe,"coreBuddyPBs",St.id)),As(qe(fe,"coreBuddyTargets",St.id)),As(qe(fe,"coreBuddyAchievements",St.id))]);N.exists()&&pt(N.data().exercises||{}),P.exists()&&at(P.data().targets||{}),B.exists()&&zs(B.data())}catch(N){console.error("Error loading Core Buddy PBs:",N)}u(!1)})())},[St]);const De=async()=>{try{const k=Ps(Ft(fe,"personalBests"),fs("clientId","==",St.id)),P=(await Ss(k)).docs.map(tt=>({id:tt.id,...tt.data()}));P.sort((tt,Xe)=>tt.month.localeCompare(Xe.month)),i(P);const B=Ps(Ft(fe,"personalBestTargets"),fs("clientId","==",St.id)),ue=await Ss(B);if(!ue.empty){const tt=ue.docs[0].data();ve(tt.targets||{}),R(tt.metricTargets||{}),A(tt.targets||{}),I(tt.metricTargets||{})}const Be=Ps(Ft(fe,"achievements"),fs("clientId","==",St.id)),Fe=await Ss(Be);Fe.empty||xt(Fe.docs[0].data().badges||[])}catch(k){console.error("Error fetching personal bests:",k)}u(!1)},Y=async()=>{if(!yt||!oe||!St)return;const k=parseFloat(oe),N=Ue[yt];if(!N||k<=N.weight){be("Target must be higher than current PB","error");return}p(!0);try{const P={...Tt,[yt]:{targetWeight:k,setAt:wt.now(),currentPBWhenSet:N.weight}};await Ns(qe(fe,"coreBuddyTargets",St.id),{clientId:St.id,targets:P,updatedAt:wt.now()}),at(P),ut(null),ss(""),be("Target set!","success")}catch(P){console.error("Error saving target:",P),be("Failed to save target","error")}p(!1)},we=k=>{if(!Gt?.badges)return!1;const N=Tt[k];return N?Gt.badges.some(P=>P.type==="pb_target"&&P.exercise===k&&P.targetWeight===N.targetWeight):!1},Ce=k=>{const N=Tt[k];if(!N)return null;const P=Ue[k];if(!P)return 0;const B=N.currentPBWhenSet||0,ue=N.targetWeight,Be=ue-B;return Be<=0?P.weight>=ue?1:0:Math.max(0,Math.min((P.weight-B)/Be,1))},Me=pP(),Ae=t.find(k=>k.month===Me),it=t.filter(k=>k.month<Me),Qe=it.length>0?it[it.length-1]:null;v.useEffect(()=>{Ae?(te(Ae.benchmarks||{}),re(Ae.bodyMetrics||{})):(te({}),re({}))},[Ae?.id]);const Q=async(k,N)=>{const P=[];if(k==="strength"?Ma.forEach(B=>{const ue=ye[B.key];if(!ue)return;const Be=N[B.key];if(!Be)return;let Fe;if(ue.targetType==="time"){if(!ue.targetValue)return;const tt=ue.startValue||0,Xe=Be.time||0,Qt=ue.targetValue-tt;Fe=Qt===0?Xe>=ue.targetValue?1:0:Math.max(0,(Xe-tt)/Qt)}else{if(!ue.targetWeight&&!ue.targetReps)return;const tt=(ue.startWeight||0)*(ue.startReps||0),Xe=(ue.targetWeight||0)*(ue.targetReps||0),Qt=(Be.weight||0)*(Be.reps||0),Ts=Xe-tt;Fe=Ts===0?Qt>=Xe?1:0:Math.max(0,(Qt-tt)/Ts)}if(Fe>=1&&!(ue.targetType==="time"?$e.some(Xe=>Xe.type==="strength"&&Xe.key===B.key&&Xe.targetValue===ue.targetValue):$e.some(Xe=>Xe.type==="strength"&&Xe.key===B.key&&Xe.targetWeight===ue.targetWeight&&Xe.targetReps===ue.targetReps))){const Xe=ue.targetType==="time"?`${B.name} ${ue.targetValue}s`:`${B.name} ${ue.targetWeight}kg  ${ue.targetReps}`;P.push({type:"strength",key:B.key,...ue.targetType==="time"?{targetType:"time",targetValue:ue.targetValue}:{targetWeight:ue.targetWeight,targetReps:ue.targetReps},achievedMonth:Me,label:Xe})}}):Lo.forEach(B=>{const ue=ge[B.key];if(!ue||!ue.targetValue)return;const Be=N[B.key];if(Be==null)return;const Fe=ue.startValue||0,tt=ue.targetValue,Xe=tt-Fe;(Xe===0?Be===tt?1:0:Math.max(0,(Be-Fe)/Xe))>=1&&($e.some(as=>as.type==="metric"&&as.key===B.key&&as.targetValue===tt)||P.push({type:"metric",key:B.key,targetValue:tt,achievedMonth:Me,label:`${B.name} ${tt}${B.suffix}`}))}),P.length>0){const B=[...$e,...P];await Ns(qe(fe,"achievements",St.id),{clientId:St.id,badges:B,updatedAt:wt.now()}),xt(B),he(P),setTimeout(()=>he(null),5e3)}},ce=(k,N)=>{if(k==="strength"){const P=ye[N];return P?P.targetType==="time"?$e.some(B=>B.type==="strength"&&B.key===N&&B.targetValue===P.targetValue):!P.targetWeight&&!P.targetReps?!1:$e.some(B=>B.type==="strength"&&B.key===N&&B.targetWeight===P.targetWeight&&B.targetReps===P.targetReps):!1}else{const P=ge[N];return!P||!P.targetValue?!1:$e.some(B=>B.type==="metric"&&B.key===N&&B.targetValue===P.targetValue)}},ze=async()=>{p(!0);try{const k=`${St.id}_${Me}`,N=Ae||{};await Ns(qe(fe,"personalBests",k),{clientId:St.id,month:Me,benchmarks:U,bodyMetrics:N.bodyMetrics||K||{},createdAt:N.createdAt||wt.now(),updatedAt:wt.now()}),await Q("strength",U),be("Benchmarks saved!","success"),j(!1),await De()}catch(k){console.error("Error saving benchmarks:",k),be("Failed to save. Please try again.","error")}p(!1)},dt=async()=>{p(!0);try{const k=`${St.id}_${Me}`,N=Ae||{};await Ns(qe(fe,"personalBests",k),{clientId:St.id,month:Me,benchmarks:N.benchmarks||U||{},bodyMetrics:K,createdAt:N.createdAt||wt.now(),updatedAt:wt.now()}),await Q("metric",K),be("Body metrics saved!","success"),V(!1),await De()}catch(k){console.error("Error saving metrics:",k),be("Failed to save. Please try again.","error")}p(!1)},ht=(k,N,P)=>{te(B=>({...B,[k]:{...B[k],[N]:P===""?"":parseFloat(P)}}))},Vt=(k,N)=>{re(P=>({...P,[k]:N===""?"":parseFloat(N)}))},Ct=(k,N,P)=>{A(B=>({...B,[k]:{...B[k],[N]:P===""?"":parseFloat(P)}}))},At=async()=>{p(!0);try{const k=`targets_${St.id}`,N=Ae?.benchmarks||{},P={};Ma.forEach(B=>{const ue=N[B.key];B.unit==="time"?E[B.key]?.targetValue&&(P[B.key]={targetType:"time",targetValue:E[B.key].targetValue,startValue:ue?.time||0}):(E[B.key]?.targetWeight||E[B.key]?.targetReps)&&(P[B.key]={targetWeight:E[B.key].targetWeight||0,targetReps:E[B.key].targetReps||0,startWeight:ue?.weight||0,startReps:ue?.reps||0})}),await Ns(qe(fe,"personalBestTargets",k),{clientId:St.id,targets:P,metricTargets:ge,updatedAt:wt.now()}),ve(P),A(P),be("Targets saved!","success"),F(!1)}catch(k){console.error("Error saving targets:",k),be("Failed to save targets.","error")}p(!1)},Ms=(k,N)=>{I(P=>({...P,[k]:{...P[k],targetValue:N===""?"":parseFloat(N)}}))},Js=async()=>{p(!0);try{const k=`targets_${St.id}`,N={};Lo.forEach(P=>{if(H[P.key]?.targetValue){const B=Ae?.bodyMetrics?.[P.key]||0;N[P.key]={targetValue:H[P.key].targetValue,startValue:B}}}),await Ns(qe(fe,"personalBestTargets",k),{clientId:St.id,targets:ye,metricTargets:N,updatedAt:wt.now()}),R(N),I(N),be("Metric targets saved!","success"),D(!1)}catch(k){console.error("Error saving metric targets:",k),be("Failed to save targets.","error")}p(!1)},ns=async()=>{if(window.confirm("Reset all goals? This will clear all strength and body metric targets. Your recorded benchmarks and measurements will NOT be affected.")){p(!0);try{const k=qe(fe,"personalBestTargets",`targets_${St.id}`);await _r(k),ve({}),R({}),A({}),I({}),be("All goals have been reset","success")}catch(k){console.error("Error resetting targets:",k),be("Failed to reset goals","error")}p(!1)}},Cs=(k,N)=>{const P=ye[k];if(!P||!N)return null;if(P.targetType==="time"){if(!P.targetValue)return null;const tt=P.startValue||0,Xe=P.targetValue,Qt=N.time||0,Ts=Xe-tt;return Ts<=0?Qt>=Xe?1:0:Math.max(0,Math.min((Qt-tt)/Ts,1))}if(!P.targetWeight&&!P.targetReps)return null;const B=(P.startWeight||0)*(P.startReps||0),ue=(P.targetWeight||0)*(P.targetReps||0),Be=(N.weight||0)*(N.reps||0),Fe=ue-B;return Fe<=0?Be>=ue?1:0:Math.max(0,Math.min((Be-B)/Fe,1))},Ls=k=>{const N=ge[k];if(!N||!N.targetValue)return null;const P=Ae?.bodyMetrics?.[k];if(P==null)return null;const B=N.startValue||0,ue=N.targetValue,Be=ue-B;return Be===0?P===ue?1:0:Math.max(0,Math.min((P-B)/Be,1))},q=k=>{Ge.current=k.touches[0].clientX,Ze.current=0},xe=k=>{Ze.current=k.touches[0].clientX-Ge.current},Ee=()=>{Ze.current<-50?rn(g+1):Ze.current>50&&rn(g-1),Ze.current=0},je=k=>{const N=Ae?.bodyMetrics?.[k],P=Qe?.bodyMetrics?.[k];return N==null||P==null?null:parseFloat((N-P).toFixed(2))},ke=t.find(k=>k.month===se),ot=t.find(k=>k.month===Oe);if(Yt||l)return r.jsxs("div",{className:"pb-page",children:[r.jsx("header",{className:"client-header",children:r.jsx("div",{className:"header-content",children:r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})})}),r.jsxs("main",{className:"pb-main",children:[r.jsx("div",{className:"skeleton skeleton-title",style:{width:180,height:28,marginBottom:20}}),r.jsx("div",{className:"skeleton skeleton-card-large",style:{height:320,borderRadius:16}})]})]});if(!js||!Kt||!St)return null;if(ps&&St?.isJunior)return r.jsx(hP,{});const mt=Ma[g],et=Ae?.benchmarks?.[mt.key],gt=Qe?.benchmarks?.[mt.key],Rt=Vl(mt,et),ws=Vl(mt,gt),_n=tg(Rt,ws),ln=Cs(mt.key,et),Ln=ln!==null,kn=ln!==null&&ln>=1,pn=Ln?Math.round(ln*60):Rt>0?15:0,Hs=ye[mt.key];return r.jsx(ka,{children:r.jsxs("div",{className:"pb-page",children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>es(Nt?"/client/core-buddy":"/client"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})]})}),r.jsxs("main",{className:"pb-main page-transition-enter",children:[r.jsxs("div",{className:"pb-intro anim-fade-up",children:[r.jsx("h2",{children:"Personal Bests"}),r.jsx("p",{children:ps?"Track your strength benchmarks and body measurements each month.":"Your all-time best lifts from programme workouts."})]}),!ps&&r.jsxs("div",{className:"pb-cb-section anim-fade-up-d2",children:[Object.keys(Ue).length===0?r.jsxs("div",{className:"pb-empty",children:[r.jsx("div",{className:"pb-cb-empty-icon",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M20.57 14.86L22 13.43 20.57 12 17 15.57 8.43 7 12 3.43 10.57 2 9.14 3.43 7.71 2 5.57 4.14 4.14 2.71 2.71 4.14l1.43 1.43L2 7.71l1.43 1.43L2 10.57 3.43 12 7 8.43 15.57 17 12 20.57 13.43 22l1.43-1.43L16.29 22l2.14-2.14 1.43 1.43 1.43-1.43-1.43-1.43L22 16.29z"})})}),r.jsx("h4",{children:"No personal bests yet"}),r.jsx("p",{children:"Complete weight-based workouts to start tracking your personal bests."})]}):r.jsx("div",{className:"pb-cb-grouped",children:(()=>{const k={},N=[];return Object.entries(Ue).forEach(([P,B])=>{const ue=fP(P);ue?(k[ue]||(k[ue]=[]),k[ue].push([P,B])):N.push([P,B])}),Object.values(k).forEach(P=>P.sort(([B],[ue])=>B.localeCompare(ue))),N.sort(([P],[B])=>P.localeCompare(B)),r.jsxs(r.Fragment,{children:[mP.map(P=>{const B=k[P.key];if(!B||B.length===0)return null;const ue=!!Ht[P.key],Be=B.reduce((Fe,[,tt])=>!Fe||tt.weight>Fe.weight?tt:Fe,null);return r.jsxs("div",{className:`pb-cb-group ${ue?"open":""}`,style:{"--group-color":P.color},children:[r.jsxs("button",{className:"pb-cb-group-header",onClick:()=>Dt(Fe=>({...Fe,[P.key]:!Fe[P.key]})),children:[r.jsx("div",{className:"pb-cb-group-accent"}),r.jsx("div",{className:"pb-cb-group-icon",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:r.jsx("path",{d:P.icon})})}),r.jsxs("div",{className:"pb-cb-group-text",children:[r.jsx("h3",{className:"pb-cb-group-label",children:P.label}),r.jsx("span",{className:"pb-cb-group-subtitle",children:P.subtitle})]}),r.jsxs("div",{className:"pb-cb-group-meta",children:[r.jsxs("span",{className:"pb-cb-group-count",children:[B.length," PB",B.length!==1?"s":""]}),Be&&r.jsxs("span",{className:"pb-cb-group-best",children:["Best: ",Be.weight,"kg"]})]}),r.jsx("svg",{className:`pb-cb-group-chevron ${ue?"open":""}`,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M6 9l6 6 6-6"})})]}),r.jsx("div",{className:"pb-cb-group-body",style:{display:ue?"block":"none"},children:r.jsx("div",{className:"pb-cb-grid",children:B.map(([Fe,tt],Xe)=>{const Qt=Tt[Fe],Ts=Ce(Fe),as=Ts!==null&&Ts>=1,cs=we(Fe),Os=Ts!==null?Math.round(Ts*60):60;return r.jsxs("div",{className:"pb-cb-card",style:{"--group-color":P.color,animationDelay:`${Xe*.05}s`},children:[r.jsxs("div",{className:"pb-cb-card-top",children:[r.jsxs("div",{className:"pb-cb-card-ring",children:[r.jsx("svg",{className:"pb-cb-ring-svg",viewBox:"0 0 80 80",children:k2.map((On,mr)=>{const ds=mr<Os;return r.jsx("line",{x1:On.x1,y1:On.y1,x2:On.x2,y2:On.y2,className:`pb-ring-tick ${ds?as?"hit":"filled":"empty"}`,style:ds&&!as?{stroke:P.color}:void 0,strokeWidth:On.thick?"2":"1.5"},mr)})}),r.jsx("div",{className:"pb-cb-ring-icon",style:{color:P.color},children:cs?r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",className:"pb-cb-badge-earned",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}):r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:r.jsx("path",{d:P.icon})})})]}),r.jsxs("div",{className:"pb-cb-card-info",children:[r.jsx("h4",{className:"pb-cb-card-name",children:Fe}),r.jsxs("div",{className:"pb-cb-card-value",style:{color:P.color},children:[tt.weight,"kg  ",tt.reps]}),tt.achievedAt&&r.jsx("div",{className:"pb-cb-card-date",children:(tt.achievedAt.toDate?tt.achievedAt.toDate():new Date(tt.achievedAt)).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"})}),Qt&&as&&!cs&&r.jsx("div",{className:"pb-cb-target-info hit",children:"Target hit!"}),cs&&r.jsx("div",{className:"pb-cb-target-info earned",children:"Badge earned!"})]}),r.jsx("div",{className:"pb-cb-card-action",children:r.jsx("button",{className:"pb-cb-target-btn",style:{borderColor:P.color,background:`color-mix(in srgb, ${P.color} 10%, transparent)`,color:P.color},onClick:()=>{ut(Fe),ss("")},children:Qt?as&&cs?r.jsx("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M12 5v14M5 12h14"})}):r.jsxs("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),r.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]}):r.jsxs("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("circle",{cx:"12",cy:"12",r:"6"}),r.jsx("circle",{cx:"12",cy:"12",r:"2"})]})})})]}),Qt&&!as&&r.jsxs("div",{className:"pb-cb-card-progress",children:[r.jsxs("div",{className:"pb-cb-progress-labels",children:[r.jsxs("span",{className:"pb-cb-progress-current",children:[tt.weight,"kg"]}),r.jsxs("span",{className:"pb-cb-progress-target",style:{color:P.color},children:["Target: ",Qt.targetWeight,"kg"]})]}),r.jsx("div",{className:"pb-cb-progress-bar",children:r.jsx("div",{className:"pb-cb-progress-bar-fill",style:{width:`${Math.round((Ts||0)*100)}%`,background:P.color}})}),r.jsxs("div",{className:"pb-cb-progress-pct",style:{color:P.color},children:[Math.round((Ts||0)*100),"%"]})]}),Qt&&as&&r.jsx("div",{className:"pb-cb-card-progress",children:r.jsx("div",{className:"pb-cb-progress-bar",children:r.jsx("div",{className:"pb-cb-progress-bar-fill hit",style:{width:"100%"}})})})]},Fe)})})})]},P.key)}),N.length>0&&(()=>{const P=!!Ht.other;return r.jsxs("div",{className:`pb-cb-group ${P?"open":""}`,style:{"--group-color":"var(--text-tertiary)"},children:[r.jsxs("button",{className:"pb-cb-group-header",onClick:()=>Dt(B=>({...B,other:!B.other})),children:[r.jsx("div",{className:"pb-cb-group-accent"}),r.jsx("div",{className:"pb-cb-group-icon",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:r.jsx("path",{d:"M20.57 14.86L22 13.43 20.57 12 17 15.57 8.43 7 12 3.43 10.57 2 9.14 3.43 7.71 2 5.57 4.14 4.14 2.71 2.71 4.14l1.43 1.43L2 7.71l1.43 1.43L2 10.57 3.43 12 7 8.43 15.57 17 12 20.57 13.43 22l1.43-1.43L16.29 22l2.14-2.14 1.43 1.43 1.43-1.43-1.43-1.43L22 16.29z"})})}),r.jsx("div",{className:"pb-cb-group-text",children:r.jsx("h3",{className:"pb-cb-group-label",children:"Other"})}),r.jsx("div",{className:"pb-cb-group-meta",children:r.jsxs("span",{className:"pb-cb-group-count",children:[N.length," PB",N.length!==1?"s":""]})}),r.jsx("svg",{className:`pb-cb-group-chevron ${P?"open":""}`,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M6 9l6 6 6-6"})})]}),r.jsx("div",{className:"pb-cb-group-body",style:{display:P?"block":"none"},children:r.jsx("div",{className:"pb-cb-grid",children:N.map(([B,ue],Be)=>{const Fe=Tt[B],tt=Ce(B),Xe=tt!==null&&tt>=1,Qt=we(B),Ts=tt!==null?Math.round(tt*60):60;return r.jsxs("div",{className:"pb-cb-card",style:{animationDelay:`${Be*.05}s`},children:[r.jsxs("div",{className:"pb-cb-card-top",children:[r.jsxs("div",{className:"pb-cb-card-ring",children:[r.jsx("svg",{className:"pb-cb-ring-svg",viewBox:"0 0 80 80",children:k2.map((as,cs)=>{const Os=cs<Ts;return r.jsx("line",{x1:as.x1,y1:as.y1,x2:as.x2,y2:as.y2,className:`pb-ring-tick ${Os?Xe?"hit":"filled":"empty"}`,strokeWidth:as.thick?"2":"1.5"},cs)})}),r.jsx("div",{className:"pb-cb-ring-icon",children:Qt?r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",className:"pb-cb-badge-earned",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}):r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M20.57 14.86L22 13.43 20.57 12 17 15.57 8.43 7 12 3.43 10.57 2 9.14 3.43 7.71 2 5.57 4.14 4.14 2.71 2.71 4.14l1.43 1.43L2 7.71l1.43 1.43L2 10.57 3.43 12 7 8.43 15.57 17 12 20.57 13.43 22l1.43-1.43L16.29 22l2.14-2.14 1.43 1.43 1.43-1.43-1.43-1.43L22 16.29z"})})})]}),r.jsxs("div",{className:"pb-cb-card-info",children:[r.jsx("h4",{className:"pb-cb-card-name",children:B}),r.jsxs("div",{className:"pb-cb-card-value",children:[ue.weight,"kg  ",ue.reps]}),ue.achievedAt&&r.jsx("div",{className:"pb-cb-card-date",children:(ue.achievedAt.toDate?ue.achievedAt.toDate():new Date(ue.achievedAt)).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"})}),Fe&&Xe&&!Qt&&r.jsx("div",{className:"pb-cb-target-info hit",children:"Target hit!"}),Qt&&r.jsx("div",{className:"pb-cb-target-info earned",children:"Badge earned!"})]}),r.jsx("div",{className:"pb-cb-card-action",children:r.jsx("button",{className:"pb-cb-target-btn",onClick:()=>{ut(B),ss("")},children:Fe?Xe&&Qt?r.jsx("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M12 5v14M5 12h14"})}):r.jsxs("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),r.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]}):r.jsxs("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("circle",{cx:"12",cy:"12",r:"6"}),r.jsx("circle",{cx:"12",cy:"12",r:"2"})]})})})]}),Fe&&!Xe&&r.jsxs("div",{className:"pb-cb-card-progress",children:[r.jsxs("div",{className:"pb-cb-progress-labels",children:[r.jsxs("span",{className:"pb-cb-progress-current",children:[ue.weight,"kg"]}),r.jsxs("span",{className:"pb-cb-progress-target",children:["Target: ",Fe.targetWeight,"kg"]})]}),r.jsx("div",{className:"pb-cb-progress-bar",children:r.jsx("div",{className:"pb-cb-progress-bar-fill",style:{width:`${Math.round((tt||0)*100)}%`}})}),r.jsxs("div",{className:"pb-cb-progress-pct",children:[Math.round((tt||0)*100),"%"]})]}),Fe&&Xe&&r.jsx("div",{className:"pb-cb-card-progress",children:r.jsx("div",{className:"pb-cb-progress-bar",children:r.jsx("div",{className:"pb-cb-progress-bar-fill hit",style:{width:"100%"}})})})]},B)})})})]})})()]})})()}),Object.keys(Ue).length>0&&r.jsxs("button",{className:"pb-cb-achievements-link anim-fade-up-d4",onClick:()=>es("/client/core-buddy/achievements"),children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"18",height:"18",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),"View Achievements",r.jsx("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})]}),yt&&r.jsx("div",{className:"pb-cb-target-modal-overlay",onClick:()=>ut(null),children:r.jsxs("div",{className:"pb-cb-target-modal",onClick:k=>k.stopPropagation(),children:[r.jsx("h3",{children:"Set Target"}),r.jsx("p",{className:"pb-cb-target-exercise-name",children:yt}),r.jsxs("div",{className:"pb-cb-target-current",children:["Current PB: ",r.jsxs("strong",{children:[Ue[yt]?.weight,"kg"]})]}),r.jsxs("div",{className:"pb-cb-target-input-wrap",children:[r.jsx("label",{children:"Your target (kg)"}),r.jsx("input",{type:"number",inputMode:"decimal",step:"0.5",value:oe,onChange:k=>ss(k.target.value),placeholder:String((Ue[yt]?.weight||0)+5),className:"pb-cb-target-input",autoFocus:!0})]}),r.jsxs("div",{className:"pb-cb-target-actions",children:[r.jsx("button",{className:"pb-cancel-btn",onClick:()=>ut(null),children:"Cancel"}),r.jsx("button",{className:"pb-save-btn",onClick:Y,disabled:d,children:d?"Saving...":"Set Target"})]})]})})]}),ps&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"pb-tabs",children:[r.jsx("button",{className:`pb-tab ${n==="bests"?"active":""}`,onClick:()=>e("bests"),children:"Strength"}),r.jsx("button",{className:`pb-tab ${n==="metrics"?"active":""}`,onClick:()=>e("metrics"),children:"Body Metrics"}),r.jsx("button",{className:`pb-tab ${n==="history"?"active":""}`,onClick:()=>e("history"),children:"History"})]}),n==="bests"&&r.jsxs("div",{className:"pb-strength-section",children:[!w&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"pb-carousel",ref:bt,onTouchStart:q,onTouchMove:xe,onTouchEnd:Ee,children:[r.jsx("div",{className:`pb-ring-container slide-from-${Et.current}`,children:r.jsxs("div",{className:"pb-ring",children:[r.jsx("svg",{className:"pb-ring-svg",viewBox:"0 0 200 200",children:eb.map((k,N)=>{const P=N<Math.round(pn);return r.jsx("line",{x1:k.x1,y1:k.y1,x2:k.x2,y2:k.y2,className:`pb-ring-tick ${P?kn?"hit":"filled":"empty"}`,strokeWidth:k.thick?"3":"2"},N)})}),r.jsxs("div",{className:"pb-ring-center",children:[r.jsx("div",{className:"pb-ring-category",children:mt.category}),r.jsxs("div",{className:"pb-ring-exercise",children:[mt.name,ce("strength",mt.key)&&r.jsx("svg",{className:"pb-badge-icon",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})]}),r.jsx("div",{className:"pb-ring-value",children:et?mt.unit==="time"?mh(et.time):M2(et.weight,et.reps):"-"}),_n!==null&&r.jsxs("div",{className:`pb-ring-change ${_n>=0?"positive":"negative"}`,children:[_n>=0?"+":"",_n.toFixed(1),"%"]}),_n===null&&et&&r.jsx("div",{className:"pb-ring-change neutral",children:"New entry"}),Hs&&r.jsx("div",{className:`pb-ring-target ${kn?"hit":""}`,children:kn?"Target hit!":Hs.targetType==="time"?`${Hs.startValue||0}s  ${Hs.targetValue}s`:`${Hs.startWeight||0}kg${Hs.startReps||0}  ${Hs.targetWeight}kg${Hs.targetReps}`}),!Hs&&r.jsx("div",{className:"pb-ring-target none",children:"No target set"})]})]})},g),r.jsx("div",{className:"pb-carousel-dots",children:Ma.map((k,N)=>r.jsx("button",{className:`pb-dot ${N===g?"active":""}`,onClick:()=>rn(N)},N))}),r.jsx("button",{className:"pb-carousel-arrow left",onClick:()=>rn(g-1),disabled:g===0,children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"})})}),r.jsx("button",{className:"pb-carousel-arrow right",onClick:()=>rn(g+1),disabled:g===Ma.length-1,children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M8.59 16.59L10 18l6-6-6-6-1.41 1.41L13.17 12z"})})})]}),r.jsxs("div",{className:"pb-trend-section",children:[r.jsx("h4",{children:"Trend"}),r.jsx(gP,{data:t,exerciseKey:mt.key,unit:mt.unit})]})]}),!w&&!$&&r.jsxs("div",{className:"pb-action-buttons",children:[r.jsx("button",{className:"pb-edit-btn",onClick:()=>j(!0),children:Ae?.benchmarks?"Edit This Month's Benchmarks":"Add This Month's Benchmarks"}),r.jsx("button",{className:"pb-edit-btn pb-target-btn",onClick:()=>F(!0),children:Object.keys(ye).length>0?"Edit Targets":"Set Targets"}),(Object.keys(ye).length>0||Object.keys(ge).length>0)&&r.jsx("button",{className:"pb-edit-btn pb-reset-btn",onClick:ns,disabled:d,children:"Reset All Goals"})]}),w&&r.jsxs("div",{className:"pb-edit-card",children:[r.jsxs("div",{className:"pb-edit-header",children:[r.jsxs("h3",{children:["Benchmarks - ",ba(Me)]}),r.jsx("button",{className:"pb-edit-close",onClick:()=>{j(!1),te(Ae?.benchmarks||{})},children:""})]}),r.jsx("div",{className:"pb-edit-body",children:Ma.map(k=>r.jsxs("div",{className:"pb-edit-exercise",children:[r.jsx("div",{className:"pb-edit-exercise-name",children:k.name}),k.unit==="weight"?r.jsxs("div",{className:"pb-edit-row",children:[r.jsxs("div",{className:"pb-edit-field",children:[r.jsx("label",{children:"Weight (kg)"}),r.jsx("input",{type:"number",step:"0.5",value:U[k.key]?.weight??"",onChange:N=>ht(k.key,"weight",N.target.value),placeholder:"0"})]}),r.jsxs("div",{className:"pb-edit-field",children:[r.jsx("label",{children:"Reps"}),r.jsx("input",{type:"number",value:U[k.key]?.reps??"",onChange:N=>ht(k.key,"reps",N.target.value),placeholder:"0"})]})]}):r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsx("label",{children:"Time (seconds)"}),r.jsx("input",{type:"number",step:"0.01",value:U[k.key]?.time??"",onChange:N=>ht(k.key,"time",N.target.value),placeholder:"0"})]})})]},k.key))}),r.jsxs("div",{className:"pb-edit-actions",children:[r.jsx("button",{className:"pb-cancel-btn",onClick:()=>{j(!1),te(Ae?.benchmarks||{})},children:"Cancel"}),r.jsx("button",{className:"pb-save-btn",onClick:ze,disabled:d,children:d?"Saving...":"Save"})]})]}),$&&r.jsxs("div",{className:"pb-edit-card",children:[r.jsxs("div",{className:"pb-edit-header",children:[r.jsx("h3",{children:"Set Your Targets"}),r.jsx("button",{className:"pb-edit-close",onClick:()=>{F(!1),A(ye)},children:""})]}),r.jsxs("div",{className:"pb-edit-body",children:[r.jsx("p",{className:"pb-target-hint",children:"Set a target for each exercise. Your current best is captured automatically from your latest benchmarks."}),Ma.map(k=>{const N=Ae?.benchmarks?.[k.key];let P="-";return N&&(k.unit==="time"&&N.time?P=`${N.time}s`:(N.weight||N.reps)&&(P=`${N.weight||0}kg  ${N.reps||0}`)),r.jsxs("div",{className:"pb-edit-exercise",children:[r.jsxs("div",{className:"pb-edit-exercise-header",children:[r.jsx("div",{className:"pb-edit-exercise-name",children:k.name}),r.jsxs("div",{className:"pb-edit-current-best",children:["Current: ",P]})]}),k.unit==="weight"?r.jsxs("div",{className:"pb-edit-row",children:[r.jsxs("div",{className:"pb-edit-field",children:[r.jsx("label",{children:"Target Weight (kg)"}),r.jsx("input",{type:"number",step:"0.5",value:E[k.key]?.targetWeight??"",onChange:B=>Ct(k.key,"targetWeight",B.target.value),placeholder:"0"})]}),r.jsxs("div",{className:"pb-edit-field",children:[r.jsx("label",{children:"Target Reps"}),r.jsx("input",{type:"number",value:E[k.key]?.targetReps??"",onChange:B=>Ct(k.key,"targetReps",B.target.value),placeholder:"0"})]})]}):r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsx("label",{children:"Target (seconds)"}),r.jsx("input",{type:"number",step:"1",value:E[k.key]?.targetValue??"",onChange:B=>Ct(k.key,"targetValue",B.target.value),placeholder:"0"})]})})]},k.key)})]}),r.jsxs("div",{className:"pb-edit-actions",children:[r.jsx("button",{className:"pb-cancel-btn",onClick:()=>{F(!1),A(ye)},children:"Cancel"}),r.jsx("button",{className:"pb-save-btn",onClick:At,disabled:d,children:d?"Saving...":"Save Targets"})]})]})]}),n==="metrics"&&r.jsxs("div",{className:"pb-metrics-section",children:[!T&&!O&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"pb-metrics-card",children:[r.jsx("h3",{children:"Body Measurements"}),r.jsx("p",{className:"pb-metrics-month",children:ba(Me)}),r.jsx("div",{className:"pb-metrics-list",children:Lo.map(k=>{const N=Ae?.bodyMetrics?.[k.key],P=je(k.key),B=ge[k.key],ue=Ls(k.key),Be=ue!==null&&ue>=1;return r.jsxs("div",{className:"pb-metric-row",children:[r.jsxs("div",{className:"pb-metric-top",children:[r.jsxs("div",{className:"pb-metric-left",children:[r.jsxs("span",{className:"pb-metric-name",children:[k.name,ce("metric",k.key)&&r.jsx("svg",{className:"pb-badge-icon-sm",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})]}),B&&r.jsxs("span",{className:"pb-metric-target-label",children:["Target: ",B.targetValue," ",k.suffix]})]}),r.jsxs("div",{className:"pb-metric-values",children:[r.jsx("span",{className:"pb-metric-current",children:N!=null?`${N} ${k.suffix}`:"-"}),P!==null&&r.jsxs("span",{className:`pb-metric-change ${P>0?"up":P<0?"down":"same"}`,children:[P>0?"+":"",P," ",k.suffix]})]})]}),ue!==null&&r.jsxs("div",{className:"pb-metric-progress",children:[r.jsx("div",{className:"pb-metric-bar",children:r.jsx("div",{className:`pb-metric-bar-fill ${Be?"hit":""}`,style:{width:`${Math.round(ue*100)}%`}})}),r.jsx("span",{className:`pb-metric-percent ${Be?"hit":""}`,children:Be?"Hit!":`${Math.round(ue*100)}%`})]})]},k.key)})})]}),r.jsxs("div",{className:"pb-action-buttons",children:[r.jsx("button",{className:"pb-edit-btn",onClick:()=>V(!0),children:Ae?.bodyMetrics?"Edit This Month's Measurements":"Add This Month's Measurements"}),r.jsx("button",{className:"pb-edit-btn pb-target-btn",onClick:()=>D(!0),children:Object.keys(ge).length>0?"Edit Targets":"Set Targets"}),(Object.keys(ye).length>0||Object.keys(ge).length>0)&&r.jsx("button",{className:"pb-edit-btn pb-reset-btn",onClick:ns,disabled:d,children:"Reset All Goals"})]})]}),T&&r.jsxs("div",{className:"pb-edit-card",children:[r.jsxs("div",{className:"pb-edit-header",children:[r.jsxs("h3",{children:["Measurements - ",ba(Me)]}),r.jsx("button",{className:"pb-edit-close",onClick:()=>{V(!1),re(Ae?.bodyMetrics||{})},children:""})]}),r.jsx("div",{className:"pb-edit-body",children:Lo.map(k=>r.jsx("div",{className:"pb-edit-metric",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsxs("label",{children:[k.name," (",k.suffix,")"]}),r.jsx("input",{type:"number",step:"0.1",value:K[k.key]??"",onChange:N=>Vt(k.key,N.target.value),placeholder:"0"})]})},k.key))}),r.jsxs("div",{className:"pb-edit-actions",children:[r.jsx("button",{className:"pb-cancel-btn",onClick:()=>{V(!1),re(Ae?.bodyMetrics||{})},children:"Cancel"}),r.jsx("button",{className:"pb-save-btn",onClick:dt,disabled:d,children:d?"Saving...":"Save"})]})]}),O&&r.jsxs("div",{className:"pb-edit-card",children:[r.jsxs("div",{className:"pb-edit-header",children:[r.jsx("h3",{children:"Body Metric Targets"}),r.jsx("button",{className:"pb-edit-close",onClick:()=>{D(!1),I(ge)},children:""})]}),r.jsxs("div",{className:"pb-edit-body",children:[r.jsx("p",{className:"pb-target-hint",children:"Set targets for your body measurements. Your current measurement is captured automatically."}),Lo.map(k=>{const N=Ae?.bodyMetrics?.[k.key];return r.jsxs("div",{className:"pb-edit-exercise",children:[r.jsxs("div",{className:"pb-edit-exercise-header",children:[r.jsx("div",{className:"pb-edit-exercise-name",children:k.name}),r.jsxs("div",{className:"pb-edit-current-best",children:["Current: ",N!=null?`${N} ${k.suffix}`:"-"]})]}),r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsxs("label",{children:["Target (",k.suffix,")"]}),r.jsx("input",{type:"number",step:"0.1",value:H[k.key]?.targetValue??"",onChange:P=>Ms(k.key,P.target.value),placeholder:"0"})]})})]},k.key)})]}),r.jsxs("div",{className:"pb-edit-actions",children:[r.jsx("button",{className:"pb-cancel-btn",onClick:()=>{D(!1),I(ge)},children:"Cancel"}),r.jsx("button",{className:"pb-save-btn",onClick:Js,disabled:d,children:d?"Saving...":"Save Targets"})]})]})]}),n==="history"&&r.jsx("div",{className:"pb-history-section",children:t.length===0?r.jsxs("div",{className:"pb-empty",children:[r.jsx("h4",{children:"No records yet"}),r.jsx("p",{children:"Start adding your monthly benchmarks and measurements to track your progress over time."})]}):r.jsxs(r.Fragment,{children:[$e.length>0&&r.jsxs("div",{className:"pb-achievements-wall",children:[r.jsxs("h4",{className:"pb-achievements-wall-title",children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"18",height:"18",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),"Targets Achieved"]}),r.jsx("div",{className:"pb-achievements-list",children:[...$e].reverse().map((k,N)=>r.jsxs("div",{className:"pb-achievement-item",style:{animationDelay:`${N*.05}s`},children:[r.jsx("div",{className:"pb-achievement-star",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),r.jsxs("div",{className:"pb-achievement-info",children:[r.jsx("span",{className:"pb-achievement-label",children:k.label}),r.jsx("span",{className:"pb-achievement-date",children:ba(k.achievedMonth)})]})]},N))})]}),r.jsx("div",{className:"pb-history-controls",children:r.jsx("button",{className:`pb-compare-toggle ${ee?"active":""}`,onClick:()=>{L(!ee),!ee&&t.length>=2&&(Le(t[0].month),Ye(t[t.length-1].month))},children:ee?"Back to Timeline":"Compare Months"})}),ee?r.jsxs("div",{className:"pb-compare",children:[r.jsxs("div",{className:"pb-compare-selectors",children:[r.jsxs("div",{className:"pb-compare-select",children:[r.jsx("label",{children:"From"}),r.jsx("select",{value:se,onChange:k=>Le(k.target.value),children:t.map(k=>r.jsx("option",{value:k.month,children:ba(k.month)},k.month))})]}),r.jsx("div",{className:"pb-compare-vs",children:"vs"}),r.jsxs("div",{className:"pb-compare-select",children:[r.jsx("label",{children:"To"}),r.jsx("select",{value:Oe,onChange:k=>Ye(k.target.value),children:t.map(k=>r.jsx("option",{value:k.month,children:ba(k.month)},k.month))})]})]}),ke&&ot&&r.jsxs("div",{className:"pb-compare-results",children:[r.jsxs("div",{className:"pb-compare-group",children:[r.jsx("h4",{children:"Strength Benchmarks"}),r.jsxs("div",{className:"pb-compare-table",children:[r.jsxs("div",{className:"pb-compare-header-row",children:[r.jsx("span",{children:"Exercise"}),r.jsx("span",{children:ba(se).split(" ")[0]}),r.jsx("span",{children:ba(Oe).split(" ")[0]}),r.jsx("span",{children:"Change"})]}),Ma.map(k=>{const N=ke.benchmarks?.[k.key],P=ot.benchmarks?.[k.key],B=Vl(k,N),ue=Vl(k,P),Be=tg(ue,B);return r.jsxs("div",{className:"pb-compare-row",children:[r.jsx("span",{className:"pb-compare-name",children:k.name}),r.jsx("span",{className:"pb-compare-val",children:N?k.unit==="time"?mh(N.time):`${N.weight}x${N.reps}`:"-"}),r.jsx("span",{className:"pb-compare-val",children:P?k.unit==="time"?mh(P.time):`${P.weight}x${P.reps}`:"-"}),r.jsx("span",{className:`pb-compare-change ${Be!==null?Be>=0?"positive":"negative":""}`,children:Be!==null?`${Be>=0?"+":""}${Be.toFixed(1)}%`:"-"})]},k.key)})]})]}),r.jsxs("div",{className:"pb-compare-group",children:[r.jsx("h4",{children:"Body Measurements"}),r.jsxs("div",{className:"pb-compare-table",children:[r.jsxs("div",{className:"pb-compare-header-row",children:[r.jsx("span",{children:"Measurement"}),r.jsx("span",{children:ba(se).split(" ")[0]}),r.jsx("span",{children:ba(Oe).split(" ")[0]}),r.jsx("span",{children:"Change"})]}),Lo.map(k=>{const N=ke.bodyMetrics?.[k.key],P=ot.bodyMetrics?.[k.key],B=N!=null&&P!=null?parseFloat((P-N).toFixed(2)):null;return r.jsxs("div",{className:"pb-compare-row",children:[r.jsx("span",{className:"pb-compare-name",children:k.name}),r.jsx("span",{className:"pb-compare-val",children:N!=null?`${N}`:"-"}),r.jsx("span",{className:"pb-compare-val",children:P!=null?`${P}`:"-"}),r.jsx("span",{className:`pb-compare-change ${B!==null?B>0?"positive":B<0?"negative":"neutral":""}`,children:B!==null?`${B>0?"+":""}${B} ${k.suffix}`:"-"})]},k.key)})]})]})]})]}):r.jsx("div",{className:"pb-timeline",children:[...t].reverse().map((k,N)=>{const P=t.find(B=>B.month<k.month&&t.indexOf(B)===t.indexOf(k)-1)||t.filter(B=>B.month<k.month).pop();return r.jsxs("div",{className:"pb-timeline-item",style:{animationDelay:`${N*.05}s`},children:[r.jsx("div",{className:"pb-timeline-dot"}),r.jsxs("div",{className:"pb-timeline-card",children:[r.jsx("h4",{children:ba(k.month)}),k.benchmarks&&Object.keys(k.benchmarks).length>0&&r.jsxs("div",{className:"pb-timeline-group",children:[r.jsx("h5",{children:"Strength Benchmarks"}),Ma.map(B=>{const ue=k.benchmarks[B.key];if(!ue)return null;const Be=P?.benchmarks?.[B.key],Fe=Vl(B,ue),tt=Vl(B,Be),Xe=tg(Fe,tt);return r.jsxs("div",{className:"pb-timeline-row",children:[r.jsx("span",{className:"pb-timeline-label",children:B.name}),r.jsxs("div",{className:"pb-timeline-values",children:[r.jsx("span",{className:"pb-timeline-value",children:B.unit==="time"?mh(ue.time):M2(ue.weight,ue.reps)}),Xe!==null&&r.jsxs("span",{className:`pb-timeline-change ${Xe>=0?"positive":"negative"}`,children:[Xe>=0?"+":"",Xe.toFixed(1),"%"]})]})]},B.key)})]}),k.bodyMetrics&&Object.keys(k.bodyMetrics).length>0&&r.jsxs("div",{className:"pb-timeline-group",children:[r.jsx("h5",{children:"Body Measurements"}),Lo.map(B=>{const ue=k.bodyMetrics[B.key];if(ue==null)return null;const Be=P?.bodyMetrics?.[B.key],Fe=Be!=null?parseFloat((ue-Be).toFixed(2)):null;return r.jsxs("div",{className:"pb-timeline-row",children:[r.jsx("span",{className:"pb-timeline-label",children:B.name}),r.jsxs("div",{className:"pb-timeline-values",children:[r.jsxs("span",{className:"pb-timeline-value",children:[ue," ",B.suffix]}),Fe!==null&&r.jsxs("span",{className:`pb-timeline-change ${Fe>0?"positive":Fe<0?"negative":"neutral"}`,children:[Fe>0?"+":"",Fe," ",B.suffix]})]})]},B.key)})]})]})]},k.id)})})]})})]})]}),W&&r.jsx("div",{className:"pb-celebration-overlay",onClick:()=>he(null),children:r.jsxs("div",{className:"pb-celebration-card",children:[r.jsx("div",{className:"pb-celebration-icon",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),r.jsx("h3",{className:"pb-celebration-title",children:W.length===1?"Target Achieved!":`${W.length} Targets Achieved!`}),r.jsx("div",{className:"pb-celebration-badges",children:W.map((k,N)=>r.jsx("div",{className:"pb-celebration-badge",children:k.label},N))}),r.jsx("p",{className:"pb-celebration-sub",children:"Tap to dismiss"})]})}),Pe&&r.jsxs("div",{className:`toast-notification ${Pe.type}`,children:[r.jsx("span",{className:"toast-icon",children:Pe.type==="success"?r.jsx("svg",{className:"success-check-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{className:"check-path",d:"M5 13 L9 17 L19 7"})}):r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})}),r.jsx("span",{className:"toast-message",children:Pe.message}),r.jsx("button",{className:"toast-close",onClick:()=>He(null),children:""})]}),ps&&r.jsxs("nav",{className:"block-bottom-nav",children:[r.jsxs("button",{className:"block-nav-tab",onClick:()=>es("/client"),children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}),r.jsx("polyline",{points:"9 22 9 12 15 12 15 22"})]}),r.jsx("span",{children:"Home"})]}),r.jsxs("button",{className:"block-nav-tab",onClick:()=>es("/client/forms"),children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),r.jsx("polyline",{points:"14 2 14 8 20 8"}),r.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),r.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"})]}),r.jsx("span",{children:"Forms"})]}),r.jsxs("button",{className:"block-nav-tab",onClick:()=>es("/client/tools"),children:[r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"})}),r.jsx("span",{children:"Tools"})]}),r.jsxs("button",{className:"block-nav-tab active",children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M12 20V10"}),r.jsx("path",{d:"M18 20V4"}),r.jsx("path",{d:"M6 20v-4"})]}),r.jsx("span",{children:"PBs"})]}),St?.circuitAccess&&r.jsxs("button",{className:"block-nav-tab",onClick:()=>es("/client/circuit"),children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("path",{d:"M12 6v6l4 2"})]}),r.jsx("span",{children:"Circuit"})]})]}),Nt&&r.jsx(la,{active:"progress"})]})})}const bP=v.lazy(()=>Er(()=>import("./Dashboard-C-iAO5D4.js"),__vite__mapDeps([0,1]))),vP=v.lazy(()=>Er(()=>import("./AddClient-DVlgNkkH.js"),__vite__mapDeps([2,3]))),xP=v.lazy(()=>Er(()=>import("./ClientDashboard-DRGTYscd.js"),[])),wP=v.lazy(()=>Er(()=>import("./ClientForms-DZHz7j9E.js"),__vite__mapDeps([4,5]))),_P=v.lazy(()=>Er(()=>import("./ClientTools-BE8WIL0M.js"),__vite__mapDeps([6,7]))),kP=v.lazy(()=>Er(()=>import("./MacroCalculator-CD1XSdCN.js"),__vite__mapDeps([8,7]))),jP=v.lazy(()=>Er(()=>import("./ProteinSnacks-BeFWgbVC.js"),__vite__mapDeps([9,7]))),TP=v.lazy(()=>Er(()=>import("./DailyMotivation-eZ5UsAdR.js"),__vite__mapDeps([10,7]))),EP=v.lazy(()=>Er(()=>import("./CircuitDashboard-DecMNjDl.js"),__vite__mapDeps([11,12]))),SP=v.lazy(()=>Er(()=>import("./CircuitBooking-Dn8JdKFJ.js"),__vite__mapDeps([13,14,12]))),NP=v.lazy(()=>Er(()=>import("./Leaderboard-Ch9GlASG.js"),__vite__mapDeps([15,16]))),CP=v.lazy(()=>Er(()=>import("./UpgradePage-JWAWVs6P.js"),__vite__mapDeps([17,18,19]))),RP=v.lazy(()=>Er(()=>import("./SignUp-tJNSH-dI.js"),[])),AP=v.lazy(()=>Er(()=>import("./Onboarding-DEA8QEtf.js"),__vite__mapDeps([20,18,21])));function MP({children:n}){const{pathname:e}=Ta();return v.useEffect(()=>{"scrollRestoration"in window.history&&(window.history.scrollRestoration="manual")},[]),v.useEffect(()=>{window.scrollTo({top:0,left:0,behavior:"instant"})},[e]),n}function IP(){const n=Gn();return v.useEffect(()=>{const e=sessionStorage.getItem("redirect");if(e){sessionStorage.removeItem("redirect");const t=e.replace("/login","")||"/";n(t,{replace:!0})}},[n]),null}function DP(){return r.jsx(G3,{children:r.jsx(W3,{children:r.jsx(X3,{children:r.jsxs(tS,{basename:"/login",children:[r.jsx(IP,{}),r.jsx(MP,{children:r.jsx(v.Suspense,{fallback:null,children:r.jsxs(RE,{children:[r.jsx(tn,{path:"/",element:r.jsx(eD,{})}),r.jsx(tn,{path:"/dashboard",element:r.jsx(bP,{})}),r.jsx(tn,{path:"/add-client",element:r.jsx(vP,{})}),r.jsx(tn,{path:"/client",element:r.jsx(xP,{})}),r.jsx(tn,{path:"/client/forms",element:r.jsx(wP,{})}),r.jsx(tn,{path:"/client/tools",element:r.jsx(_P,{})}),r.jsx(tn,{path:"/client/tools/macros",element:r.jsx(kP,{})}),r.jsx(tn,{path:"/client/tools/snacks",element:r.jsx(jP,{})}),r.jsx(tn,{path:"/client/tools/motivation",element:r.jsx(TP,{})}),r.jsx(tn,{path:"/client/personal-bests",element:r.jsx(yP,{})}),r.jsx(tn,{path:"/client/circuit",element:r.jsx(EP,{})}),r.jsx(tn,{path:"/client/circuit/booking",element:r.jsx(SP,{})}),r.jsx(tn,{path:"/client/core-buddy",element:r.jsx(_D,{})}),r.jsx(tn,{path:"/client/core-buddy/nutrition",element:r.jsx(Il,{feature:"nutrition",children:r.jsx(TD,{})})}),r.jsx(tn,{path:"/client/core-buddy/workouts",element:r.jsx(OD,{})}),r.jsx(tn,{path:"/client/core-buddy/programmes",element:r.jsx(Il,{feature:"programmes",children:r.jsx(zD,{})})}),r.jsx(tn,{path:"/client/core-buddy/achievements",element:r.jsx(Il,{feature:"achievements",children:r.jsx(KD,{})})}),r.jsx(tn,{path:"/client/core-buddy/consistency",element:r.jsx(Il,{feature:"consistency",children:r.jsx(tP,{})})}),r.jsx(tn,{path:"/client/core-buddy/buddies",element:r.jsx(Il,{feature:"buddies",children:r.jsx(sP,{})})}),r.jsx(tn,{path:"/client/core-buddy/buddy",element:r.jsx(oP,{})}),r.jsx(tn,{path:"/client/core-buddy/profile/:userId",element:r.jsx(iP,{})}),r.jsx(tn,{path:"/client/leaderboard",element:r.jsx(Il,{feature:"leaderboard",children:r.jsx(NP,{})})}),r.jsx(tn,{path:"/signup",element:r.jsx(RP,{})}),r.jsx(tn,{path:"/onboarding",element:r.jsx(AP,{})}),r.jsx(tn,{path:"/upgrade",element:r.jsx(CP,{})}),r.jsx(tn,{path:"*",element:r.jsx(NE,{to:"/",replace:!0})})]})})})]})})})})}CT.createRoot(document.getElementById("root")).render(r.jsx(v.StrictMode,{children:r.jsx(DP,{})}));"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/login/sw.js").catch(()=>{})});export{Kr as A,la as C,ka as P,wt as T,mi as a,_r as b,Ft as c,fe as d,qe as e,GC as f,Ss as g,JC as h,Ns as i,r as j,As as k,Vr as l,Ea as m,Gn as n,Gh as o,eb as p,Ps as q,v as r,OP as s,wm as t,Da as u,Z3 as v,fs as w,J3 as x,PP as y,iS as z};
