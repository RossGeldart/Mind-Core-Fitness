const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Dashboard-CQZ95aDU.js","assets/Dashboard-BI21Q1GR.css","assets/AddClient-BRjhaAM4.js","assets/AddClient-DH1OFzHo.css","assets/ClientForms-cGB90KrN.js","assets/ClientForms-GDNtnrAx.css","assets/ClientTools-qUSyw2DB.js","assets/ClientTools-DQRPoST3.css","assets/MacroCalculator-DX-q8i3z.js","assets/ProteinSnacks-CJG9rDpF.js","assets/DailyMotivation-j8rAWtVx.js","assets/CircuitDashboard-nVV-wS6e.js","assets/CircuitDashboard-MPNVarsJ.css","assets/CircuitBooking-BZghLO4W.js","assets/CircuitBooking-ruk9Q4Wj.css","assets/Leaderboard-DOitdWMe.js","assets/Leaderboard-Dq-r5svP.css"])))=>i.map(i=>d[i]);
(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))i(l);new MutationObserver(l=>{for(const u of l)if(u.type==="childList")for(const h of u.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&i(h)}).observe(document,{childList:!0,subtree:!0});function t(l){const u={};return l.integrity&&(u.integrity=l.integrity),l.referrerPolicy&&(u.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?u.credentials="include":l.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function i(l){if(l.ep)return;l.ep=!0;const u=t(l);fetch(l.href,u)}})();var dp={exports:{}},Oc={};var d1;function sj(){if(d1)return Oc;d1=1;var s=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(i,l,u){var h=null;if(u!==void 0&&(h=""+u),l.key!==void 0&&(h=""+l.key),"key"in l){u={};for(var p in l)p!=="key"&&(u[p]=l[p])}else u=l;return l=u.ref,{$$typeof:s,type:i,key:h,ref:l!==void 0?l:null,props:u}}return Oc.Fragment=e,Oc.jsx=t,Oc.jsxs=t,Oc}var f1;function rj(){return f1||(f1=1,dp.exports=sj()),dp.exports}var a=rj(),fp={exports:{}},Yt={};var m1;function aj(){if(m1)return Yt;m1=1;var s=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),l=Symbol.for("react.profiler"),u=Symbol.for("react.consumer"),h=Symbol.for("react.context"),p=Symbol.for("react.forward_ref"),g=Symbol.for("react.suspense"),y=Symbol.for("react.memo"),w=Symbol.for("react.lazy"),k=Symbol.for("react.activity"),j=Symbol.iterator;function O(D){return D===null||typeof D!="object"?null:(D=j&&D[j]||D["@@iterator"],typeof D=="function"?D:null)}var $={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},U=Object.assign,L={};function ne(D,W,be){this.props=D,this.context=W,this.refs=L,this.updater=be||$}ne.prototype.isReactComponent={},ne.prototype.setState=function(D,W){if(typeof D!="object"&&typeof D!="function"&&D!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,D,W,"setState")},ne.prototype.forceUpdate=function(D){this.updater.enqueueForceUpdate(this,D,"forceUpdate")};function Z(){}Z.prototype=ne.prototype;function ye(D,W,be){this.props=D,this.context=W,this.refs=L,this.updater=be||$}var je=ye.prototype=new Z;je.constructor=ye,U(je,ne.prototype),je.isPureReactComponent=!0;var We=Array.isArray;function Be(){}var R={H:null,A:null,T:null,S:null},S=Object.prototype.hasOwnProperty;function I(D,W,be){var Ne=be.ref;return{$$typeof:s,type:D,key:W,ref:Ne!==void 0?Ne:null,props:be}}function V(D,W){return I(D.type,W,D.props)}function P(D){return typeof D=="object"&&D!==null&&D.$$typeof===s}function F(D){var W={"=":"=0",":":"=2"};return"$"+D.replace(/[=:]/g,function(be){return W[be]})}var M=/\/+/g;function He(D,W){return typeof D=="object"&&D!==null&&D.key!=null?F(""+D.key):W.toString(36)}function xt(D){switch(D.status){case"fulfilled":return D.value;case"rejected":throw D.reason;default:switch(typeof D.status=="string"?D.then(Be,Be):(D.status="pending",D.then(function(W){D.status==="pending"&&(D.status="fulfilled",D.value=W)},function(W){D.status==="pending"&&(D.status="rejected",D.reason=W)})),D.status){case"fulfilled":return D.value;case"rejected":throw D.reason}}throw D}function z(D,W,be,Ne,qe){var Ae=typeof D;(Ae==="undefined"||Ae==="boolean")&&(D=null);var rt=!1;if(D===null)rt=!0;else switch(Ae){case"bigint":case"string":case"number":rt=!0;break;case"object":switch(D.$$typeof){case s:case e:rt=!0;break;case w:return rt=D._init,z(rt(D._payload),W,be,Ne,qe)}}if(rt)return qe=qe(D),rt=Ne===""?"."+He(D,0):Ne,We(qe)?(be="",rt!=null&&(be=rt.replace(M,"$&/")+"/"),z(qe,W,be,"",function(Ht){return Ht})):qe!=null&&(P(qe)&&(qe=V(qe,be+(qe.key==null||D&&D.key===qe.key?"":(""+qe.key).replace(M,"$&/")+"/")+rt)),W.push(qe)),1;rt=0;var pt=Ne===""?".":Ne+":";if(We(D))for(var Ze=0;Ze<D.length;Ze++)Ne=D[Ze],Ae=pt+He(Ne,Ze),rt+=z(Ne,W,be,Ae,qe);else if(Ze=O(D),typeof Ze=="function")for(D=Ze.call(D),Ze=0;!(Ne=D.next()).done;)Ne=Ne.value,Ae=pt+He(Ne,Ze++),rt+=z(Ne,W,be,Ae,qe);else if(Ae==="object"){if(typeof D.then=="function")return z(xt(D),W,be,Ne,qe);throw W=String(D),Error("Objects are not valid as a React child (found: "+(W==="[object Object]"?"object with keys {"+Object.keys(D).join(", ")+"}":W)+"). If you meant to render a collection of children, use an array instead.")}return rt}function fe(D,W,be){if(D==null)return D;var Ne=[],qe=0;return z(D,Ne,"","",function(Ae){return W.call(be,Ae,qe++)}),Ne}function Ie(D){if(D._status===-1){var W=D._result;W=W(),W.then(function(be){(D._status===0||D._status===-1)&&(D._status=1,D._result=be)},function(be){(D._status===0||D._status===-1)&&(D._status=2,D._result=be)}),D._status===-1&&(D._status=0,D._result=W)}if(D._status===1)return D._result.default;throw D._result}var Ge=typeof reportError=="function"?reportError:function(D){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var W=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof D=="object"&&D!==null&&typeof D.message=="string"?String(D.message):String(D),error:D});if(!window.dispatchEvent(W))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",D);return}console.error(D)},J={map:fe,forEach:function(D,W,be){fe(D,function(){W.apply(this,arguments)},be)},count:function(D){var W=0;return fe(D,function(){W++}),W},toArray:function(D){return fe(D,function(W){return W})||[]},only:function(D){if(!P(D))throw Error("React.Children.only expected to receive a single React element child.");return D}};return Yt.Activity=k,Yt.Children=J,Yt.Component=ne,Yt.Fragment=t,Yt.Profiler=l,Yt.PureComponent=ye,Yt.StrictMode=i,Yt.Suspense=g,Yt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=R,Yt.__COMPILER_RUNTIME={__proto__:null,c:function(D){return R.H.useMemoCache(D)}},Yt.cache=function(D){return function(){return D.apply(null,arguments)}},Yt.cacheSignal=function(){return null},Yt.cloneElement=function(D,W,be){if(D==null)throw Error("The argument must be a React element, but you passed "+D+".");var Ne=U({},D.props),qe=D.key;if(W!=null)for(Ae in W.key!==void 0&&(qe=""+W.key),W)!S.call(W,Ae)||Ae==="key"||Ae==="__self"||Ae==="__source"||Ae==="ref"&&W.ref===void 0||(Ne[Ae]=W[Ae]);var Ae=arguments.length-2;if(Ae===1)Ne.children=be;else if(1<Ae){for(var rt=Array(Ae),pt=0;pt<Ae;pt++)rt[pt]=arguments[pt+2];Ne.children=rt}return I(D.type,qe,Ne)},Yt.createContext=function(D){return D={$$typeof:h,_currentValue:D,_currentValue2:D,_threadCount:0,Provider:null,Consumer:null},D.Provider=D,D.Consumer={$$typeof:u,_context:D},D},Yt.createElement=function(D,W,be){var Ne,qe={},Ae=null;if(W!=null)for(Ne in W.key!==void 0&&(Ae=""+W.key),W)S.call(W,Ne)&&Ne!=="key"&&Ne!=="__self"&&Ne!=="__source"&&(qe[Ne]=W[Ne]);var rt=arguments.length-2;if(rt===1)qe.children=be;else if(1<rt){for(var pt=Array(rt),Ze=0;Ze<rt;Ze++)pt[Ze]=arguments[Ze+2];qe.children=pt}if(D&&D.defaultProps)for(Ne in rt=D.defaultProps,rt)qe[Ne]===void 0&&(qe[Ne]=rt[Ne]);return I(D,Ae,qe)},Yt.createRef=function(){return{current:null}},Yt.forwardRef=function(D){return{$$typeof:p,render:D}},Yt.isValidElement=P,Yt.lazy=function(D){return{$$typeof:w,_payload:{_status:-1,_result:D},_init:Ie}},Yt.memo=function(D,W){return{$$typeof:y,type:D,compare:W===void 0?null:W}},Yt.startTransition=function(D){var W=R.T,be={};R.T=be;try{var Ne=D(),qe=R.S;qe!==null&&qe(be,Ne),typeof Ne=="object"&&Ne!==null&&typeof Ne.then=="function"&&Ne.then(Be,Ge)}catch(Ae){Ge(Ae)}finally{W!==null&&be.types!==null&&(W.types=be.types),R.T=W}},Yt.unstable_useCacheRefresh=function(){return R.H.useCacheRefresh()},Yt.use=function(D){return R.H.use(D)},Yt.useActionState=function(D,W,be){return R.H.useActionState(D,W,be)},Yt.useCallback=function(D,W){return R.H.useCallback(D,W)},Yt.useContext=function(D){return R.H.useContext(D)},Yt.useDebugValue=function(){},Yt.useDeferredValue=function(D,W){return R.H.useDeferredValue(D,W)},Yt.useEffect=function(D,W){return R.H.useEffect(D,W)},Yt.useEffectEvent=function(D){return R.H.useEffectEvent(D)},Yt.useId=function(){return R.H.useId()},Yt.useImperativeHandle=function(D,W,be){return R.H.useImperativeHandle(D,W,be)},Yt.useInsertionEffect=function(D,W){return R.H.useInsertionEffect(D,W)},Yt.useLayoutEffect=function(D,W){return R.H.useLayoutEffect(D,W)},Yt.useMemo=function(D,W){return R.H.useMemo(D,W)},Yt.useOptimistic=function(D,W){return R.H.useOptimistic(D,W)},Yt.useReducer=function(D,W,be){return R.H.useReducer(D,W,be)},Yt.useRef=function(D){return R.H.useRef(D)},Yt.useState=function(D){return R.H.useState(D)},Yt.useSyncExternalStore=function(D,W,be){return R.H.useSyncExternalStore(D,W,be)},Yt.useTransition=function(){return R.H.useTransition()},Yt.version="19.2.4",Yt}var p1;function Eg(){return p1||(p1=1,fp.exports=aj()),fp.exports}var x=Eg(),mp={exports:{}},Vc={},pp={exports:{}},gp={};var g1;function ij(){return g1||(g1=1,(function(s){function e(z,fe){var Ie=z.length;z.push(fe);e:for(;0<Ie;){var Ge=Ie-1>>>1,J=z[Ge];if(0<l(J,fe))z[Ge]=fe,z[Ie]=J,Ie=Ge;else break e}}function t(z){return z.length===0?null:z[0]}function i(z){if(z.length===0)return null;var fe=z[0],Ie=z.pop();if(Ie!==fe){z[0]=Ie;e:for(var Ge=0,J=z.length,D=J>>>1;Ge<D;){var W=2*(Ge+1)-1,be=z[W],Ne=W+1,qe=z[Ne];if(0>l(be,Ie))Ne<J&&0>l(qe,be)?(z[Ge]=qe,z[Ne]=Ie,Ge=Ne):(z[Ge]=be,z[W]=Ie,Ge=W);else if(Ne<J&&0>l(qe,Ie))z[Ge]=qe,z[Ne]=Ie,Ge=Ne;else break e}}return fe}function l(z,fe){var Ie=z.sortIndex-fe.sortIndex;return Ie!==0?Ie:z.id-fe.id}if(s.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var u=performance;s.unstable_now=function(){return u.now()}}else{var h=Date,p=h.now();s.unstable_now=function(){return h.now()-p}}var g=[],y=[],w=1,k=null,j=3,O=!1,$=!1,U=!1,L=!1,ne=typeof setTimeout=="function"?setTimeout:null,Z=typeof clearTimeout=="function"?clearTimeout:null,ye=typeof setImmediate<"u"?setImmediate:null;function je(z){for(var fe=t(y);fe!==null;){if(fe.callback===null)i(y);else if(fe.startTime<=z)i(y),fe.sortIndex=fe.expirationTime,e(g,fe);else break;fe=t(y)}}function We(z){if(U=!1,je(z),!$)if(t(g)!==null)$=!0,Be||(Be=!0,F());else{var fe=t(y);fe!==null&&xt(We,fe.startTime-z)}}var Be=!1,R=-1,S=5,I=-1;function V(){return L?!0:!(s.unstable_now()-I<S)}function P(){if(L=!1,Be){var z=s.unstable_now();I=z;var fe=!0;try{e:{$=!1,U&&(U=!1,Z(R),R=-1),O=!0;var Ie=j;try{t:{for(je(z),k=t(g);k!==null&&!(k.expirationTime>z&&V());){var Ge=k.callback;if(typeof Ge=="function"){k.callback=null,j=k.priorityLevel;var J=Ge(k.expirationTime<=z);if(z=s.unstable_now(),typeof J=="function"){k.callback=J,je(z),fe=!0;break t}k===t(g)&&i(g),je(z)}else i(g);k=t(g)}if(k!==null)fe=!0;else{var D=t(y);D!==null&&xt(We,D.startTime-z),fe=!1}}break e}finally{k=null,j=Ie,O=!1}fe=void 0}}finally{fe?F():Be=!1}}}var F;if(typeof ye=="function")F=function(){ye(P)};else if(typeof MessageChannel<"u"){var M=new MessageChannel,He=M.port2;M.port1.onmessage=P,F=function(){He.postMessage(null)}}else F=function(){ne(P,0)};function xt(z,fe){R=ne(function(){z(s.unstable_now())},fe)}s.unstable_IdlePriority=5,s.unstable_ImmediatePriority=1,s.unstable_LowPriority=4,s.unstable_NormalPriority=3,s.unstable_Profiling=null,s.unstable_UserBlockingPriority=2,s.unstable_cancelCallback=function(z){z.callback=null},s.unstable_forceFrameRate=function(z){0>z||125<z?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):S=0<z?Math.floor(1e3/z):5},s.unstable_getCurrentPriorityLevel=function(){return j},s.unstable_next=function(z){switch(j){case 1:case 2:case 3:var fe=3;break;default:fe=j}var Ie=j;j=fe;try{return z()}finally{j=Ie}},s.unstable_requestPaint=function(){L=!0},s.unstable_runWithPriority=function(z,fe){switch(z){case 1:case 2:case 3:case 4:case 5:break;default:z=3}var Ie=j;j=z;try{return fe()}finally{j=Ie}},s.unstable_scheduleCallback=function(z,fe,Ie){var Ge=s.unstable_now();switch(typeof Ie=="object"&&Ie!==null?(Ie=Ie.delay,Ie=typeof Ie=="number"&&0<Ie?Ge+Ie:Ge):Ie=Ge,z){case 1:var J=-1;break;case 2:J=250;break;case 5:J=1073741823;break;case 4:J=1e4;break;default:J=5e3}return J=Ie+J,z={id:w++,callback:fe,priorityLevel:z,startTime:Ie,expirationTime:J,sortIndex:-1},Ie>Ge?(z.sortIndex=Ie,e(y,z),t(g)===null&&z===t(y)&&(U?(Z(R),R=-1):U=!0,xt(We,Ie-Ge))):(z.sortIndex=J,e(g,z),$||O||($=!0,Be||(Be=!0,F()))),z},s.unstable_shouldYield=V,s.unstable_wrapCallback=function(z){var fe=j;return function(){var Ie=j;j=fe;try{return z.apply(this,arguments)}finally{j=Ie}}}})(gp)),gp}var y1;function oj(){return y1||(y1=1,pp.exports=ij()),pp.exports}var yp={exports:{}},Xs={};var b1;function lj(){if(b1)return Xs;b1=1;var s=Eg();function e(g){var y="https://react.dev/errors/"+g;if(1<arguments.length){y+="?args[]="+encodeURIComponent(arguments[1]);for(var w=2;w<arguments.length;w++)y+="&args[]="+encodeURIComponent(arguments[w])}return"Minified React error #"+g+"; visit "+y+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var i={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},l=Symbol.for("react.portal");function u(g,y,w){var k=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:l,key:k==null?null:""+k,children:g,containerInfo:y,implementation:w}}var h=s.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function p(g,y){if(g==="font")return"";if(typeof y=="string")return y==="use-credentials"?y:""}return Xs.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,Xs.createPortal=function(g,y){var w=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!y||y.nodeType!==1&&y.nodeType!==9&&y.nodeType!==11)throw Error(e(299));return u(g,y,null,w)},Xs.flushSync=function(g){var y=h.T,w=i.p;try{if(h.T=null,i.p=2,g)return g()}finally{h.T=y,i.p=w,i.d.f()}},Xs.preconnect=function(g,y){typeof g=="string"&&(y?(y=y.crossOrigin,y=typeof y=="string"?y==="use-credentials"?y:"":void 0):y=null,i.d.C(g,y))},Xs.prefetchDNS=function(g){typeof g=="string"&&i.d.D(g)},Xs.preinit=function(g,y){if(typeof g=="string"&&y&&typeof y.as=="string"){var w=y.as,k=p(w,y.crossOrigin),j=typeof y.integrity=="string"?y.integrity:void 0,O=typeof y.fetchPriority=="string"?y.fetchPriority:void 0;w==="style"?i.d.S(g,typeof y.precedence=="string"?y.precedence:void 0,{crossOrigin:k,integrity:j,fetchPriority:O}):w==="script"&&i.d.X(g,{crossOrigin:k,integrity:j,fetchPriority:O,nonce:typeof y.nonce=="string"?y.nonce:void 0})}},Xs.preinitModule=function(g,y){if(typeof g=="string")if(typeof y=="object"&&y!==null){if(y.as==null||y.as==="script"){var w=p(y.as,y.crossOrigin);i.d.M(g,{crossOrigin:w,integrity:typeof y.integrity=="string"?y.integrity:void 0,nonce:typeof y.nonce=="string"?y.nonce:void 0})}}else y==null&&i.d.M(g)},Xs.preload=function(g,y){if(typeof g=="string"&&typeof y=="object"&&y!==null&&typeof y.as=="string"){var w=y.as,k=p(w,y.crossOrigin);i.d.L(g,w,{crossOrigin:k,integrity:typeof y.integrity=="string"?y.integrity:void 0,nonce:typeof y.nonce=="string"?y.nonce:void 0,type:typeof y.type=="string"?y.type:void 0,fetchPriority:typeof y.fetchPriority=="string"?y.fetchPriority:void 0,referrerPolicy:typeof y.referrerPolicy=="string"?y.referrerPolicy:void 0,imageSrcSet:typeof y.imageSrcSet=="string"?y.imageSrcSet:void 0,imageSizes:typeof y.imageSizes=="string"?y.imageSizes:void 0,media:typeof y.media=="string"?y.media:void 0})}},Xs.preloadModule=function(g,y){if(typeof g=="string")if(y){var w=p(y.as,y.crossOrigin);i.d.m(g,{as:typeof y.as=="string"&&y.as!=="script"?y.as:void 0,crossOrigin:w,integrity:typeof y.integrity=="string"?y.integrity:void 0})}else i.d.m(g)},Xs.requestFormReset=function(g){i.d.r(g)},Xs.unstable_batchedUpdates=function(g,y){return g(y)},Xs.useFormState=function(g,y,w){return h.H.useFormState(g,y,w)},Xs.useFormStatus=function(){return h.H.useHostTransitionStatus()},Xs.version="19.2.4",Xs}var v1;function cj(){if(v1)return yp.exports;v1=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(e){console.error(e)}}return s(),yp.exports=lj(),yp.exports}var x1;function uj(){if(x1)return Vc;x1=1;var s=oj(),e=Eg(),t=cj();function i(n){var r="https://react.dev/errors/"+n;if(1<arguments.length){r+="?args[]="+encodeURIComponent(arguments[1]);for(var o=2;o<arguments.length;o++)r+="&args[]="+encodeURIComponent(arguments[o])}return"Minified React error #"+n+"; visit "+r+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function l(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function u(n){var r=n,o=n;if(n.alternate)for(;r.return;)r=r.return;else{n=r;do r=n,(r.flags&4098)!==0&&(o=r.return),n=r.return;while(n)}return r.tag===3?o:null}function h(n){if(n.tag===13){var r=n.memoizedState;if(r===null&&(n=n.alternate,n!==null&&(r=n.memoizedState)),r!==null)return r.dehydrated}return null}function p(n){if(n.tag===31){var r=n.memoizedState;if(r===null&&(n=n.alternate,n!==null&&(r=n.memoizedState)),r!==null)return r.dehydrated}return null}function g(n){if(u(n)!==n)throw Error(i(188))}function y(n){var r=n.alternate;if(!r){if(r=u(n),r===null)throw Error(i(188));return r!==n?null:n}for(var o=n,c=r;;){var f=o.return;if(f===null)break;var m=f.alternate;if(m===null){if(c=f.return,c!==null){o=c;continue}break}if(f.child===m.child){for(m=f.child;m;){if(m===o)return g(f),n;if(m===c)return g(f),r;m=m.sibling}throw Error(i(188))}if(o.return!==c.return)o=f,c=m;else{for(var v=!1,E=f.child;E;){if(E===o){v=!0,o=f,c=m;break}if(E===c){v=!0,c=f,o=m;break}E=E.sibling}if(!v){for(E=m.child;E;){if(E===o){v=!0,o=m,c=f;break}if(E===c){v=!0,c=m,o=f;break}E=E.sibling}if(!v)throw Error(i(189))}}if(o.alternate!==c)throw Error(i(190))}if(o.tag!==3)throw Error(i(188));return o.stateNode.current===o?n:r}function w(n){var r=n.tag;if(r===5||r===26||r===27||r===6)return n;for(n=n.child;n!==null;){if(r=w(n),r!==null)return r;n=n.sibling}return null}var k=Object.assign,j=Symbol.for("react.element"),O=Symbol.for("react.transitional.element"),$=Symbol.for("react.portal"),U=Symbol.for("react.fragment"),L=Symbol.for("react.strict_mode"),ne=Symbol.for("react.profiler"),Z=Symbol.for("react.consumer"),ye=Symbol.for("react.context"),je=Symbol.for("react.forward_ref"),We=Symbol.for("react.suspense"),Be=Symbol.for("react.suspense_list"),R=Symbol.for("react.memo"),S=Symbol.for("react.lazy"),I=Symbol.for("react.activity"),V=Symbol.for("react.memo_cache_sentinel"),P=Symbol.iterator;function F(n){return n===null||typeof n!="object"?null:(n=P&&n[P]||n["@@iterator"],typeof n=="function"?n:null)}var M=Symbol.for("react.client.reference");function He(n){if(n==null)return null;if(typeof n=="function")return n.$$typeof===M?null:n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case U:return"Fragment";case ne:return"Profiler";case L:return"StrictMode";case We:return"Suspense";case Be:return"SuspenseList";case I:return"Activity"}if(typeof n=="object")switch(n.$$typeof){case $:return"Portal";case ye:return n.displayName||"Context";case Z:return(n._context.displayName||"Context")+".Consumer";case je:var r=n.render;return n=n.displayName,n||(n=r.displayName||r.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case R:return r=n.displayName||null,r!==null?r:He(n.type)||"Memo";case S:r=n._payload,n=n._init;try{return He(n(r))}catch{}}return null}var xt=Array.isArray,z=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,fe=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Ie={pending:!1,data:null,method:null,action:null},Ge=[],J=-1;function D(n){return{current:n}}function W(n){0>J||(n.current=Ge[J],Ge[J]=null,J--)}function be(n,r){J++,Ge[J]=n.current,n.current=r}var Ne=D(null),qe=D(null),Ae=D(null),rt=D(null);function pt(n,r){switch(be(Ae,r),be(qe,n),be(Ne,null),r.nodeType){case 9:case 11:n=(n=r.documentElement)&&(n=n.namespaceURI)?P0(n):0;break;default:if(n=r.tagName,r=r.namespaceURI)r=P0(r),n=L0(r,n);else switch(n){case"svg":n=1;break;case"math":n=2;break;default:n=0}}W(Ne),be(Ne,n)}function Ze(){W(Ne),W(qe),W(Ae)}function Ht(n){n.memoizedState!==null&&be(rt,n);var r=Ne.current,o=L0(r,n.type);r!==o&&(be(qe,n),be(Ne,o))}function cn(n){qe.current===n&&(W(Ne),W(qe)),rt.current===n&&(W(rt),Mc._currentValue=Ie)}var Nt,Ct;function le(n){if(Nt===void 0)try{throw Error()}catch(o){var r=o.stack.trim().match(/\n( *(at )?)/);Nt=r&&r[1]||"",Ct=-1<o.stack.indexOf(`
    at`)?" (<anonymous>)":-1<o.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Nt+n+Ct}var gn=!1;function $t(n,r){if(!n||gn)return"";gn=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var c={DetermineComponentFrameRoot:function(){try{if(r){var Re=function(){throw Error()};if(Object.defineProperty(Re.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Re,[])}catch(de){var oe=de}Reflect.construct(n,[],Re)}else{try{Re.call()}catch(de){oe=de}n.call(Re.prototype)}}else{try{throw Error()}catch(de){oe=de}(Re=n())&&typeof Re.catch=="function"&&Re.catch(function(){})}}catch(de){if(de&&oe&&typeof de.stack=="string")return[de.stack,oe.stack]}return[null,null]}};c.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var f=Object.getOwnPropertyDescriptor(c.DetermineComponentFrameRoot,"name");f&&f.configurable&&Object.defineProperty(c.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var m=c.DetermineComponentFrameRoot(),v=m[0],E=m[1];if(v&&E){var B=v.split(`
`),ae=E.split(`
`);for(f=c=0;c<B.length&&!B[c].includes("DetermineComponentFrameRoot");)c++;for(;f<ae.length&&!ae[f].includes("DetermineComponentFrameRoot");)f++;if(c===B.length||f===ae.length)for(c=B.length-1,f=ae.length-1;1<=c&&0<=f&&B[c]!==ae[f];)f--;for(;1<=c&&0<=f;c--,f--)if(B[c]!==ae[f]){if(c!==1||f!==1)do if(c--,f--,0>f||B[c]!==ae[f]){var we=`
`+B[c].replace(" at new "," at ");return n.displayName&&we.includes("<anonymous>")&&(we=we.replace("<anonymous>",n.displayName)),we}while(1<=c&&0<=f);break}}}finally{gn=!1,Error.prepareStackTrace=o}return(o=n?n.displayName||n.name:"")?le(o):""}function St(n,r){switch(n.tag){case 26:case 27:case 5:return le(n.type);case 16:return le("Lazy");case 13:return n.child!==r&&r!==null?le("Suspense Fallback"):le("Suspense");case 19:return le("SuspenseList");case 0:case 15:return $t(n.type,!1);case 11:return $t(n.type.render,!1);case 1:return $t(n.type,!0);case 31:return le("Activity");default:return""}}function Bt(n){try{var r="",o=null;do r+=St(n,o),o=n,n=n.return;while(n);return r}catch(c){return`
Error generating stack: `+c.message+`
`+c.stack}}var ht=Object.prototype.hasOwnProperty,et=s.unstable_scheduleCallback,en=s.unstable_cancelCallback,rs=s.unstable_shouldYield,Lt=s.unstable_requestPaint,Et=s.unstable_now,Pn=s.unstable_getCurrentPriorityLevel,Ft=s.unstable_ImmediatePriority,En=s.unstable_UserBlockingPriority,Kt=s.unstable_NormalPriority,Sn=s.unstable_LowPriority,me=s.unstable_IdlePriority,Se=s.log,Fe=s.unstable_setDisableYieldValue,Qe=null,Ue=null;function De(n){if(typeof Se=="function"&&Fe(n),Ue&&typeof Ue.setStrictMode=="function")try{Ue.setStrictMode(Qe,n)}catch{}}var Oe=Math.clz32?Math.clz32:Q,wt=Math.log,ft=Math.LN2;function Q(n){return n>>>=0,n===0?32:31-(wt(n)/ft|0)|0}var Ee=256,Xe=262144,Je=4194304;function dt(n){var r=n&42;if(r!==0)return r;switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return n&261888;case 262144:case 524288:case 1048576:case 2097152:return n&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return n&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return n}}function qt(n,r,o){var c=n.pendingLanes;if(c===0)return 0;var f=0,m=n.suspendedLanes,v=n.pingedLanes;n=n.warmLanes;var E=c&134217727;return E!==0?(c=E&~m,c!==0?f=dt(c):(v&=E,v!==0?f=dt(v):o||(o=E&~n,o!==0&&(f=dt(o))))):(E=c&~m,E!==0?f=dt(E):v!==0?f=dt(v):o||(o=c&~n,o!==0&&(f=dt(o)))),f===0?0:r!==0&&r!==f&&(r&m)===0&&(m=f&-f,o=r&-r,m>=o||m===32&&(o&4194048)!==0)?r:f}function Rt(n,r){return(n.pendingLanes&~(n.suspendedLanes&~n.pingedLanes)&r)===0}function tn(n,r){switch(n){case 1:case 2:case 4:case 8:case 64:return r+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Vn(){var n=Je;return Je<<=1,(Je&62914560)===0&&(Je=4194304),n}function An(n){for(var r=[],o=0;31>o;o++)r.push(n);return r}function sn(n,r){n.pendingLanes|=r,r!==268435456&&(n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0)}function yn(n,r,o,c,f,m){var v=n.pendingLanes;n.pendingLanes=o,n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0,n.expiredLanes&=o,n.entangledLanes&=o,n.errorRecoveryDisabledLanes&=o,n.shellSuspendCounter=0;var E=n.entanglements,B=n.expirationTimes,ae=n.hiddenUpdates;for(o=v&~o;0<o;){var we=31-Oe(o),Re=1<<we;E[we]=0,B[we]=-1;var oe=ae[we];if(oe!==null)for(ae[we]=null,we=0;we<oe.length;we++){var de=oe[we];de!==null&&(de.lane&=-536870913)}o&=~Re}c!==0&&In(n,c,0),m!==0&&f===0&&n.tag!==0&&(n.suspendedLanes|=m&~(v&~r))}function In(n,r,o){n.pendingLanes|=r,n.suspendedLanes&=~r;var c=31-Oe(r);n.entangledLanes|=r,n.entanglements[c]=n.entanglements[c]|1073741824|o&261930}function un(n,r){var o=n.entangledLanes|=r;for(n=n.entanglements;o;){var c=31-Oe(o),f=1<<c;f&r|n[c]&r&&(n[c]|=r),o&=~f}}function as(n,r){var o=r&-r;return o=(o&42)!==0?1:H(o),(o&(n.suspendedLanes|r))!==0?0:o}function H(n){switch(n){case 2:n=1;break;case 8:n=4;break;case 32:n=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:n=128;break;case 268435456:n=134217728;break;default:n=0}return n}function pe(n){return n&=-n,2<n?8<n?(n&134217727)!==0?32:268435456:8:2}function _e(){var n=fe.p;return n!==0?n:(n=window.event,n===void 0?32:a1(n.type))}function xe(n,r){var o=fe.p;try{return fe.p=n,r()}finally{fe.p=o}}var ge=Math.random().toString(36).slice(2),at="__reactFiber$"+ge,At="__reactProps$"+ge,ct="__reactContainer$"+ge,_t="__reactEvents$"+ge,bt="__reactListeners$"+ge,bn="__reactHandles$"+ge,sr="__reactResources$"+ge,Ts="__reactMarker$"+ge;function Os(n){delete n[at],delete n[At],delete n[_t],delete n[bt],delete n[bn]}function Bn(n){var r=n[at];if(r)return r;for(var o=n.parentNode;o;){if(r=o[ct]||o[at]){if(o=r.alternate,r.child!==null||o!==null&&o.child!==null)for(n=q0(n);n!==null;){if(o=n[at])return o;n=q0(n)}return r}n=o,o=n.parentNode}return null}function q(n){if(n=n[at]||n[ct]){var r=n.tag;if(r===5||r===6||r===13||r===31||r===26||r===27||r===3)return n}return null}function ce(n){var r=n.tag;if(r===5||r===26||r===27||r===6)return n.stateNode;throw Error(i(33))}function T(n){var r=n[sr];return r||(r=n[sr]={hoistableStyles:new Map,hoistableScripts:new Map}),r}function C(n){n[Ts]=!0}var Y=new Set,se={};function $e(n,r){ze(n,r),ze(n+"Capture",r)}function ze(n,r){for(se[n]=r,n=0;n<r.length;n++)Y.add(r[n])}var Ve=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Ut={},kt={};function G(n){return ht.call(kt,n)?!0:ht.call(Ut,n)?!1:Ve.test(n)?kt[n]=!0:(Ut[n]=!0,!1)}function he(n,r,o){if(G(r))if(o===null)n.removeAttribute(r);else{switch(typeof o){case"undefined":case"function":case"symbol":n.removeAttribute(r);return;case"boolean":var c=r.toLowerCase().slice(0,5);if(c!=="data-"&&c!=="aria-"){n.removeAttribute(r);return}}n.setAttribute(r,""+o)}}function ie(n,r,o){if(o===null)n.removeAttribute(r);else{switch(typeof o){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(r);return}n.setAttribute(r,""+o)}}function Ce(n,r,o,c){if(c===null)n.removeAttribute(o);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(o);return}n.setAttributeNS(r,o,""+c)}}function Le(n){switch(typeof n){case"bigint":case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function it(n){var r=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(r==="checkbox"||r==="radio")}function It(n,r,o){var c=Object.getOwnPropertyDescriptor(n.constructor.prototype,r);if(!n.hasOwnProperty(r)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var f=c.get,m=c.set;return Object.defineProperty(n,r,{configurable:!0,get:function(){return f.call(this)},set:function(v){o=""+v,m.call(this,v)}}),Object.defineProperty(n,r,{enumerable:c.enumerable}),{getValue:function(){return o},setValue:function(v){o=""+v},stopTracking:function(){n._valueTracker=null,delete n[r]}}}}function lt(n){if(!n._valueTracker){var r=it(n)?"checked":"value";n._valueTracker=It(n,r,""+n[r])}}function rn(n){if(!n)return!1;var r=n._valueTracker;if(!r)return!0;var o=r.getValue(),c="";return n&&(c=it(n)?n.checked?"true":"false":n.value),n=c,n!==o?(r.setValue(n),!0):!1}function Un(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}var vn=/[\n"\\]/g;function xn(n){return n.replace(vn,function(r){return"\\"+r.charCodeAt(0).toString(16)+" "})}function wr(n,r,o,c,f,m,v,E){n.name="",v!=null&&typeof v!="function"&&typeof v!="symbol"&&typeof v!="boolean"?n.type=v:n.removeAttribute("type"),r!=null?v==="number"?(r===0&&n.value===""||n.value!=r)&&(n.value=""+Le(r)):n.value!==""+Le(r)&&(n.value=""+Le(r)):v!=="submit"&&v!=="reset"||n.removeAttribute("value"),r!=null?Xr(n,v,Le(r)):o!=null?Xr(n,v,Le(o)):c!=null&&n.removeAttribute("value"),f==null&&m!=null&&(n.defaultChecked=!!m),f!=null&&(n.checked=f&&typeof f!="function"&&typeof f!="symbol"),E!=null&&typeof E!="function"&&typeof E!="symbol"&&typeof E!="boolean"?n.name=""+Le(E):n.removeAttribute("name")}function Da(n,r,o,c,f,m,v,E){if(m!=null&&typeof m!="function"&&typeof m!="symbol"&&typeof m!="boolean"&&(n.type=m),r!=null||o!=null){if(!(m!=="submit"&&m!=="reset"||r!=null)){lt(n);return}o=o!=null?""+Le(o):"",r=r!=null?""+Le(r):o,E||r===n.value||(n.value=r),n.defaultValue=r}c=c??f,c=typeof c!="function"&&typeof c!="symbol"&&!!c,n.checked=E?n.checked:!!c,n.defaultChecked=!!c,v!=null&&typeof v!="function"&&typeof v!="symbol"&&typeof v!="boolean"&&(n.name=v),lt(n)}function Xr(n,r,o){r==="number"&&Un(n.ownerDocument)===n||n.defaultValue===""+o||(n.defaultValue=""+o)}function _r(n,r,o,c){if(n=n.options,r){r={};for(var f=0;f<o.length;f++)r["$"+o[f]]=!0;for(o=0;o<n.length;o++)f=r.hasOwnProperty("$"+n[o].value),n[o].selected!==f&&(n[o].selected=f),f&&c&&(n[o].defaultSelected=!0)}else{for(o=""+Le(o),r=null,f=0;f<n.length;f++){if(n[f].value===o){n[f].selected=!0,c&&(n[f].defaultSelected=!0);return}r!==null||n[f].disabled||(r=n[f])}r!==null&&(r.selected=!0)}}function wn(n,r,o){if(r!=null&&(r=""+Le(r),r!==n.value&&(n.value=r),o==null)){n.defaultValue!==r&&(n.defaultValue=r);return}n.defaultValue=o!=null?""+Le(o):""}function ts(n,r,o,c){if(r==null){if(c!=null){if(o!=null)throw Error(i(92));if(xt(c)){if(1<c.length)throw Error(i(93));c=c[0]}o=c}o==null&&(o=""),r=o}o=Le(r),n.defaultValue=o,c=n.textContent,c===o&&c!==""&&c!==null&&(n.value=c),lt(n)}function Gn(n,r){if(r){var o=n.firstChild;if(o&&o===n.lastChild&&o.nodeType===3){o.nodeValue=r;return}}n.textContent=r}var kr=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function hr(n,r,o){var c=r.indexOf("--")===0;o==null||typeof o=="boolean"||o===""?c?n.setProperty(r,""):r==="float"?n.cssFloat="":n[r]="":c?n.setProperty(r,o):typeof o!="number"||o===0||kr.has(r)?r==="float"?n.cssFloat=o:n[r]=(""+o).trim():n[r]=o+"px"}function Ms(n,r,o){if(r!=null&&typeof r!="object")throw Error(i(62));if(n=n.style,o!=null){for(var c in o)!o.hasOwnProperty(c)||r!=null&&r.hasOwnProperty(c)||(c.indexOf("--")===0?n.setProperty(c,""):c==="float"?n.cssFloat="":n[c]="");for(var f in r)c=r[f],r.hasOwnProperty(f)&&o[f]!==c&&hr(n,f,c)}else for(var m in r)r.hasOwnProperty(m)&&hr(n,m,r[m])}function Vs(n){if(n.indexOf("-")===-1)return!1;switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Lr=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Tr=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function fa(n){return Tr.test(""+n)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":n}function A(){}var ee=null;function Pe(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var tt=null,mt=null;function Dt(n){var r=q(n);if(r&&(n=r.stateNode)){var o=n[At]||null;e:switch(n=r.stateNode,r.type){case"input":if(wr(n,o.value,o.defaultValue,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name),r=o.name,o.type==="radio"&&r!=null){for(o=n;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll('input[name="'+xn(""+r)+'"][type="radio"]'),r=0;r<o.length;r++){var c=o[r];if(c!==n&&c.form===n.form){var f=c[At]||null;if(!f)throw Error(i(90));wr(c,f.value,f.defaultValue,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name)}}for(r=0;r<o.length;r++)c=o[r],c.form===n.form&&rn(c)}break e;case"textarea":wn(n,o.value,o.defaultValue);break e;case"select":r=o.value,r!=null&&_r(n,!!o.multiple,r,!1)}}}var st=!1;function zt(n,r,o){if(st)return n(r,o);st=!0;try{var c=n(r);return c}finally{if(st=!1,(tt!==null||mt!==null)&&(Sh(),tt&&(r=tt,n=mt,mt=tt=null,Dt(r),n)))for(r=0;r<n.length;r++)Dt(n[r])}}function Pt(n,r){var o=n.stateNode;if(o===null)return null;var c=o[At]||null;if(c===null)return null;o=c[r];e:switch(r){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(c=!c.disabled)||(n=n.type,c=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!c;break e;default:n=!1}if(n)return null;if(o&&typeof o!="function")throw Error(i(231,r,typeof o));return o}var Xt=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),_n=!1;if(Xt)try{var gt={};Object.defineProperty(gt,"passive",{get:function(){_n=!0}}),window.addEventListener("test",gt,gt),window.removeEventListener("test",gt,gt)}catch{_n=!1}var cs=null,Xn=null,Kn=null;function fs(){if(Kn)return Kn;var n,r=Xn,o=r.length,c,f="value"in cs?cs.value:cs.textContent,m=f.length;for(n=0;n<o&&r[n]===f[n];n++);var v=o-n;for(c=1;c<=v&&r[o-c]===f[m-c];c++);return Kn=f.slice(n,1<c?1-c:void 0)}function Jn(n){var r=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&r===13&&(n=13)):n=r,n===10&&(n=13),32<=n||n===13?n:0}function us(){return!0}function js(){return!1}function Zn(n){function r(o,c,f,m,v){this._reactName=o,this._targetInst=f,this.type=c,this.nativeEvent=m,this.target=v,this.currentTarget=null;for(var E in n)n.hasOwnProperty(E)&&(o=n[E],this[E]=o?o(m):m[E]);return this.isDefaultPrevented=(m.defaultPrevented!=null?m.defaultPrevented:m.returnValue===!1)?us:js,this.isPropagationStopped=js,this}return k(r.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=us)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=us)},persist:function(){},isPersistent:us}),r}var vs={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Qs=Zn(vs),jr=k({},vs,{view:0,detail:0}),Bs=Zn(jr),Ds,dr,Fs,Pa=k({},jr,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:mi,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==Fs&&(Fs&&n.type==="mousemove"?(Ds=n.screenX-Fs.screenX,dr=n.screenY-Fs.screenY):dr=Ds=0,Fs=n),Ds)},movementY:function(n){return"movementY"in n?n.movementY:dr}}),uo=Zn(Pa),La=k({},Pa,{dataTransfer:0}),Oa=Zn(La),Jr=k({},jr,{relatedTarget:0}),fr=Zn(Jr),ec=k({},vs,{animationName:0,elapsedTime:0,pseudoElement:0}),Ou=Zn(ec),Ko=k({},vs,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),Vu=Zn(Ko),Bu=k({},vs,{data:0}),ma=Zn(Bu),Uu={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},zu={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Fu={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function qu(n){var r=this.nativeEvent;return r.getModifierState?r.getModifierState(n):(n=Fu[n])?!!r[n]:!1}function mi(){return qu}var rr=k({},jr,{key:function(n){if(n.key){var r=Uu[n.key]||n.key;if(r!=="Unidentified")return r}return n.type==="keypress"?(n=Jn(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?zu[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:mi,charCode:function(n){return n.type==="keypress"?Jn(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?Jn(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),Hu=Zn(rr),$u=k({},Pa,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Va=Zn($u),d=k({},jr,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:mi}),b=Zn(d),_=k({},vs,{propertyName:0,elapsedTime:0,pseudoElement:0}),N=Zn(_),te=k({},Pa,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),ue=Zn(te),Ye=k({},vs,{newState:0,oldState:0}),Jt=Zn(Ye),xs=[9,13,27,32],Mn=Xt&&"CompositionEvent"in window,is=null;Xt&&"documentMode"in document&&(is=document.documentMode);var Or=Xt&&"TextEvent"in window&&!is,pa=Xt&&(!Mn||is&&8<is&&11>=is),Zr=" ",ea=!1;function ho(n,r){switch(n){case"keyup":return xs.indexOf(r.keyCode)!==-1;case"keydown":return r.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Yo(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var Qo=!1;function Sk(n,r){switch(n){case"compositionend":return Yo(r);case"keypress":return r.which!==32?null:(ea=!0,Zr);case"textInput":return n=r.data,n===Zr&&ea?null:n;default:return null}}function Nk(n,r){if(Qo)return n==="compositionend"||!Mn&&ho(n,r)?(n=fs(),Kn=Xn=cs=null,Qo=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(r.ctrlKey||r.altKey||r.metaKey)||r.ctrlKey&&r.altKey){if(r.char&&1<r.char.length)return r.char;if(r.which)return String.fromCharCode(r.which)}return null;case"compositionend":return pa&&r.locale!=="ko"?null:r.data;default:return null}}var Ck={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Wy(n){var r=n&&n.nodeName&&n.nodeName.toLowerCase();return r==="input"?!!Ck[n.type]:r==="textarea"}function Gy(n,r,o,c){tt?mt?mt.push(c):mt=[c]:tt=c,r=Dh(r,"onChange"),0<r.length&&(o=new Qs("onChange","change",null,o,c),n.push({event:o,listeners:r}))}var tc=null,nc=null;function Rk(n){C0(n,0)}function Wu(n){var r=ce(n);if(rn(r))return n}function Ky(n,r){if(n==="change")return r}var Yy=!1;if(Xt){var vf;if(Xt){var xf="oninput"in document;if(!xf){var Qy=document.createElement("div");Qy.setAttribute("oninput","return;"),xf=typeof Qy.oninput=="function"}vf=xf}else vf=!1;Yy=vf&&(!document.documentMode||9<document.documentMode)}function Xy(){tc&&(tc.detachEvent("onpropertychange",Jy),nc=tc=null)}function Jy(n){if(n.propertyName==="value"&&Wu(nc)){var r=[];Gy(r,nc,n,Pe(n)),zt(Rk,r)}}function Ak(n,r,o){n==="focusin"?(Xy(),tc=r,nc=o,tc.attachEvent("onpropertychange",Jy)):n==="focusout"&&Xy()}function Ik(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return Wu(nc)}function Mk(n,r){if(n==="click")return Wu(r)}function Dk(n,r){if(n==="input"||n==="change")return Wu(r)}function Pk(n,r){return n===r&&(n!==0||1/n===1/r)||n!==n&&r!==r}var Er=typeof Object.is=="function"?Object.is:Pk;function sc(n,r){if(Er(n,r))return!0;if(typeof n!="object"||n===null||typeof r!="object"||r===null)return!1;var o=Object.keys(n),c=Object.keys(r);if(o.length!==c.length)return!1;for(c=0;c<o.length;c++){var f=o[c];if(!ht.call(r,f)||!Er(n[f],r[f]))return!1}return!0}function Zy(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function eb(n,r){var o=Zy(n);n=0;for(var c;o;){if(o.nodeType===3){if(c=n+o.textContent.length,n<=r&&c>=r)return{node:o,offset:r-n};n=c}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=Zy(o)}}function tb(n,r){return n&&r?n===r?!0:n&&n.nodeType===3?!1:r&&r.nodeType===3?tb(n,r.parentNode):"contains"in n?n.contains(r):n.compareDocumentPosition?!!(n.compareDocumentPosition(r)&16):!1:!1}function nb(n){n=n!=null&&n.ownerDocument!=null&&n.ownerDocument.defaultView!=null?n.ownerDocument.defaultView:window;for(var r=Un(n.document);r instanceof n.HTMLIFrameElement;){try{var o=typeof r.contentWindow.location.href=="string"}catch{o=!1}if(o)n=r.contentWindow;else break;r=Un(n.document)}return r}function wf(n){var r=n&&n.nodeName&&n.nodeName.toLowerCase();return r&&(r==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||r==="textarea"||n.contentEditable==="true")}var Lk=Xt&&"documentMode"in document&&11>=document.documentMode,Xo=null,_f=null,rc=null,kf=!1;function sb(n,r,o){var c=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;kf||Xo==null||Xo!==Un(c)||(c=Xo,"selectionStart"in c&&wf(c)?c={start:c.selectionStart,end:c.selectionEnd}:(c=(c.ownerDocument&&c.ownerDocument.defaultView||window).getSelection(),c={anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset}),rc&&sc(rc,c)||(rc=c,c=Dh(_f,"onSelect"),0<c.length&&(r=new Qs("onSelect","select",null,r,o),n.push({event:r,listeners:c}),r.target=Xo)))}function fo(n,r){var o={};return o[n.toLowerCase()]=r.toLowerCase(),o["Webkit"+n]="webkit"+r,o["Moz"+n]="moz"+r,o}var Jo={animationend:fo("Animation","AnimationEnd"),animationiteration:fo("Animation","AnimationIteration"),animationstart:fo("Animation","AnimationStart"),transitionrun:fo("Transition","TransitionRun"),transitionstart:fo("Transition","TransitionStart"),transitioncancel:fo("Transition","TransitionCancel"),transitionend:fo("Transition","TransitionEnd")},Tf={},rb={};Xt&&(rb=document.createElement("div").style,"AnimationEvent"in window||(delete Jo.animationend.animation,delete Jo.animationiteration.animation,delete Jo.animationstart.animation),"TransitionEvent"in window||delete Jo.transitionend.transition);function mo(n){if(Tf[n])return Tf[n];if(!Jo[n])return n;var r=Jo[n],o;for(o in r)if(r.hasOwnProperty(o)&&o in rb)return Tf[n]=r[o];return n}var ab=mo("animationend"),ib=mo("animationiteration"),ob=mo("animationstart"),Ok=mo("transitionrun"),Vk=mo("transitionstart"),Bk=mo("transitioncancel"),lb=mo("transitionend"),cb=new Map,jf="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");jf.push("scrollEnd");function ta(n,r){cb.set(n,r),$e(r,[n])}var Gu=typeof reportError=="function"?reportError:function(n){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var r=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof n=="object"&&n!==null&&typeof n.message=="string"?String(n.message):String(n),error:n});if(!window.dispatchEvent(r))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",n);return}console.error(n)},Vr=[],Zo=0,Ef=0;function Ku(){for(var n=Zo,r=Ef=Zo=0;r<n;){var o=Vr[r];Vr[r++]=null;var c=Vr[r];Vr[r++]=null;var f=Vr[r];Vr[r++]=null;var m=Vr[r];if(Vr[r++]=null,c!==null&&f!==null){var v=c.pending;v===null?f.next=f:(f.next=v.next,v.next=f),c.pending=f}m!==0&&ub(o,f,m)}}function Yu(n,r,o,c){Vr[Zo++]=n,Vr[Zo++]=r,Vr[Zo++]=o,Vr[Zo++]=c,Ef|=c,n.lanes|=c,n=n.alternate,n!==null&&(n.lanes|=c)}function Sf(n,r,o,c){return Yu(n,r,o,c),Qu(n)}function po(n,r){return Yu(n,null,null,r),Qu(n)}function ub(n,r,o){n.lanes|=o;var c=n.alternate;c!==null&&(c.lanes|=o);for(var f=!1,m=n.return;m!==null;)m.childLanes|=o,c=m.alternate,c!==null&&(c.childLanes|=o),m.tag===22&&(n=m.stateNode,n===null||n._visibility&1||(f=!0)),n=m,m=m.return;return n.tag===3?(m=n.stateNode,f&&r!==null&&(f=31-Oe(o),n=m.hiddenUpdates,c=n[f],c===null?n[f]=[r]:c.push(r),r.lane=o|536870912),m):null}function Qu(n){if(50<Ec)throw Ec=0,Lm=null,Error(i(185));for(var r=n.return;r!==null;)n=r,r=n.return;return n.tag===3?n.stateNode:null}var el={};function Uk(n,r,o,c){this.tag=n,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=r,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=c,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Sr(n,r,o,c){return new Uk(n,r,o,c)}function Nf(n){return n=n.prototype,!(!n||!n.isReactComponent)}function Ba(n,r){var o=n.alternate;return o===null?(o=Sr(n.tag,r,n.key,n.mode),o.elementType=n.elementType,o.type=n.type,o.stateNode=n.stateNode,o.alternate=n,n.alternate=o):(o.pendingProps=r,o.type=n.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=n.flags&65011712,o.childLanes=n.childLanes,o.lanes=n.lanes,o.child=n.child,o.memoizedProps=n.memoizedProps,o.memoizedState=n.memoizedState,o.updateQueue=n.updateQueue,r=n.dependencies,o.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext},o.sibling=n.sibling,o.index=n.index,o.ref=n.ref,o.refCleanup=n.refCleanup,o}function hb(n,r){n.flags&=65011714;var o=n.alternate;return o===null?(n.childLanes=0,n.lanes=r,n.child=null,n.subtreeFlags=0,n.memoizedProps=null,n.memoizedState=null,n.updateQueue=null,n.dependencies=null,n.stateNode=null):(n.childLanes=o.childLanes,n.lanes=o.lanes,n.child=o.child,n.subtreeFlags=0,n.deletions=null,n.memoizedProps=o.memoizedProps,n.memoizedState=o.memoizedState,n.updateQueue=o.updateQueue,n.type=o.type,r=o.dependencies,n.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext}),n}function Xu(n,r,o,c,f,m){var v=0;if(c=n,typeof n=="function")Nf(n)&&(v=1);else if(typeof n=="string")v=$T(n,o,Ne.current)?26:n==="html"||n==="head"||n==="body"?27:5;else e:switch(n){case I:return n=Sr(31,o,r,f),n.elementType=I,n.lanes=m,n;case U:return go(o.children,f,m,r);case L:v=8,f|=24;break;case ne:return n=Sr(12,o,r,f|2),n.elementType=ne,n.lanes=m,n;case We:return n=Sr(13,o,r,f),n.elementType=We,n.lanes=m,n;case Be:return n=Sr(19,o,r,f),n.elementType=Be,n.lanes=m,n;default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case ye:v=10;break e;case Z:v=9;break e;case je:v=11;break e;case R:v=14;break e;case S:v=16,c=null;break e}v=29,o=Error(i(130,n===null?"null":typeof n,"")),c=null}return r=Sr(v,o,r,f),r.elementType=n,r.type=c,r.lanes=m,r}function go(n,r,o,c){return n=Sr(7,n,c,r),n.lanes=o,n}function Cf(n,r,o){return n=Sr(6,n,null,r),n.lanes=o,n}function db(n){var r=Sr(18,null,null,0);return r.stateNode=n,r}function Rf(n,r,o){return r=Sr(4,n.children!==null?n.children:[],n.key,r),r.lanes=o,r.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},r}var fb=new WeakMap;function Br(n,r){if(typeof n=="object"&&n!==null){var o=fb.get(n);return o!==void 0?o:(r={value:n,source:r,stack:Bt(r)},fb.set(n,r),r)}return{value:n,source:r,stack:Bt(r)}}var tl=[],nl=0,Ju=null,ac=0,Ur=[],zr=0,pi=null,ga=1,ya="";function Ua(n,r){tl[nl++]=ac,tl[nl++]=Ju,Ju=n,ac=r}function mb(n,r,o){Ur[zr++]=ga,Ur[zr++]=ya,Ur[zr++]=pi,pi=n;var c=ga;n=ya;var f=32-Oe(c)-1;c&=~(1<<f),o+=1;var m=32-Oe(r)+f;if(30<m){var v=f-f%5;m=(c&(1<<v)-1).toString(32),c>>=v,f-=v,ga=1<<32-Oe(r)+f|o<<f|c,ya=m+n}else ga=1<<m|o<<f|c,ya=n}function Af(n){n.return!==null&&(Ua(n,1),mb(n,1,0))}function If(n){for(;n===Ju;)Ju=tl[--nl],tl[nl]=null,ac=tl[--nl],tl[nl]=null;for(;n===pi;)pi=Ur[--zr],Ur[zr]=null,ya=Ur[--zr],Ur[zr]=null,ga=Ur[--zr],Ur[zr]=null}function pb(n,r){Ur[zr++]=ga,Ur[zr++]=ya,Ur[zr++]=pi,ga=r.id,ya=r.overflow,pi=n}var qs=null,ns=null,kn=!1,gi=null,Fr=!1,Mf=Error(i(519));function yi(n){var r=Error(i(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw ic(Br(r,n)),Mf}function gb(n){var r=n.stateNode,o=n.type,c=n.memoizedProps;switch(r[at]=n,r[At]=c,o){case"dialog":on("cancel",r),on("close",r);break;case"iframe":case"object":case"embed":on("load",r);break;case"video":case"audio":for(o=0;o<Nc.length;o++)on(Nc[o],r);break;case"source":on("error",r);break;case"img":case"image":case"link":on("error",r),on("load",r);break;case"details":on("toggle",r);break;case"input":on("invalid",r),Da(r,c.value,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name,!0);break;case"select":on("invalid",r);break;case"textarea":on("invalid",r),ts(r,c.value,c.defaultValue,c.children)}o=c.children,typeof o!="string"&&typeof o!="number"&&typeof o!="bigint"||r.textContent===""+o||c.suppressHydrationWarning===!0||M0(r.textContent,o)?(c.popover!=null&&(on("beforetoggle",r),on("toggle",r)),c.onScroll!=null&&on("scroll",r),c.onScrollEnd!=null&&on("scrollend",r),c.onClick!=null&&(r.onclick=A),r=!0):r=!1,r||yi(n,!0)}function yb(n){for(qs=n.return;qs;)switch(qs.tag){case 5:case 31:case 13:Fr=!1;return;case 27:case 3:Fr=!0;return;default:qs=qs.return}}function sl(n){if(n!==qs)return!1;if(!kn)return yb(n),kn=!0,!1;var r=n.tag,o;if((o=r!==3&&r!==27)&&((o=r===5)&&(o=n.type,o=!(o!=="form"&&o!=="button")||Xm(n.type,n.memoizedProps)),o=!o),o&&ns&&yi(n),yb(n),r===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(i(317));ns=F0(n)}else if(r===31){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(i(317));ns=F0(n)}else r===27?(r=ns,Ai(n.type)?(n=np,np=null,ns=n):ns=r):ns=qs?Hr(n.stateNode.nextSibling):null;return!0}function yo(){ns=qs=null,kn=!1}function Df(){var n=gi;return n!==null&&(yr===null?yr=n:yr.push.apply(yr,n),gi=null),n}function ic(n){gi===null?gi=[n]:gi.push(n)}var Pf=D(null),bo=null,za=null;function bi(n,r,o){be(Pf,r._currentValue),r._currentValue=o}function Fa(n){n._currentValue=Pf.current,W(Pf)}function Lf(n,r,o){for(;n!==null;){var c=n.alternate;if((n.childLanes&r)!==r?(n.childLanes|=r,c!==null&&(c.childLanes|=r)):c!==null&&(c.childLanes&r)!==r&&(c.childLanes|=r),n===o)break;n=n.return}}function Of(n,r,o,c){var f=n.child;for(f!==null&&(f.return=n);f!==null;){var m=f.dependencies;if(m!==null){var v=f.child;m=m.firstContext;e:for(;m!==null;){var E=m;m=f;for(var B=0;B<r.length;B++)if(E.context===r[B]){m.lanes|=o,E=m.alternate,E!==null&&(E.lanes|=o),Lf(m.return,o,n),c||(v=null);break e}m=E.next}}else if(f.tag===18){if(v=f.return,v===null)throw Error(i(341));v.lanes|=o,m=v.alternate,m!==null&&(m.lanes|=o),Lf(v,o,n),v=null}else v=f.child;if(v!==null)v.return=f;else for(v=f;v!==null;){if(v===n){v=null;break}if(f=v.sibling,f!==null){f.return=v.return,v=f;break}v=v.return}f=v}}function rl(n,r,o,c){n=null;for(var f=r,m=!1;f!==null;){if(!m){if((f.flags&524288)!==0)m=!0;else if((f.flags&262144)!==0)break}if(f.tag===10){var v=f.alternate;if(v===null)throw Error(i(387));if(v=v.memoizedProps,v!==null){var E=f.type;Er(f.pendingProps.value,v.value)||(n!==null?n.push(E):n=[E])}}else if(f===rt.current){if(v=f.alternate,v===null)throw Error(i(387));v.memoizedState.memoizedState!==f.memoizedState.memoizedState&&(n!==null?n.push(Mc):n=[Mc])}f=f.return}n!==null&&Of(r,n,o,c),r.flags|=262144}function Zu(n){for(n=n.firstContext;n!==null;){if(!Er(n.context._currentValue,n.memoizedValue))return!0;n=n.next}return!1}function vo(n){bo=n,za=null,n=n.dependencies,n!==null&&(n.firstContext=null)}function Hs(n){return bb(bo,n)}function eh(n,r){return bo===null&&vo(n),bb(n,r)}function bb(n,r){var o=r._currentValue;if(r={context:r,memoizedValue:o,next:null},za===null){if(n===null)throw Error(i(308));za=r,n.dependencies={lanes:0,firstContext:r},n.flags|=524288}else za=za.next=r;return o}var zk=typeof AbortController<"u"?AbortController:function(){var n=[],r=this.signal={aborted:!1,addEventListener:function(o,c){n.push(c)}};this.abort=function(){r.aborted=!0,n.forEach(function(o){return o()})}},Fk=s.unstable_scheduleCallback,qk=s.unstable_NormalPriority,Es={$$typeof:ye,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Vf(){return{controller:new zk,data:new Map,refCount:0}}function oc(n){n.refCount--,n.refCount===0&&Fk(qk,function(){n.controller.abort()})}var lc=null,Bf=0,al=0,il=null;function Hk(n,r){if(lc===null){var o=lc=[];Bf=0,al=Fm(),il={status:"pending",value:void 0,then:function(c){o.push(c)}}}return Bf++,r.then(vb,vb),r}function vb(){if(--Bf===0&&lc!==null){il!==null&&(il.status="fulfilled");var n=lc;lc=null,al=0,il=null;for(var r=0;r<n.length;r++)(0,n[r])()}}function $k(n,r){var o=[],c={status:"pending",value:null,reason:null,then:function(f){o.push(f)}};return n.then(function(){c.status="fulfilled",c.value=r;for(var f=0;f<o.length;f++)(0,o[f])(r)},function(f){for(c.status="rejected",c.reason=f,f=0;f<o.length;f++)(0,o[f])(void 0)}),c}var xb=z.S;z.S=function(n,r){s0=Et(),typeof r=="object"&&r!==null&&typeof r.then=="function"&&Hk(n,r),xb!==null&&xb(n,r)};var xo=D(null);function Uf(){var n=xo.current;return n!==null?n:Yn.pooledCache}function th(n,r){r===null?be(xo,xo.current):be(xo,r.pool)}function wb(){var n=Uf();return n===null?null:{parent:Es._currentValue,pool:n}}var ol=Error(i(460)),zf=Error(i(474)),nh=Error(i(542)),sh={then:function(){}};function _b(n){return n=n.status,n==="fulfilled"||n==="rejected"}function kb(n,r,o){switch(o=n[o],o===void 0?n.push(r):o!==r&&(r.then(A,A),r=o),r.status){case"fulfilled":return r.value;case"rejected":throw n=r.reason,jb(n),n;default:if(typeof r.status=="string")r.then(A,A);else{if(n=Yn,n!==null&&100<n.shellSuspendCounter)throw Error(i(482));n=r,n.status="pending",n.then(function(c){if(r.status==="pending"){var f=r;f.status="fulfilled",f.value=c}},function(c){if(r.status==="pending"){var f=r;f.status="rejected",f.reason=c}})}switch(r.status){case"fulfilled":return r.value;case"rejected":throw n=r.reason,jb(n),n}throw _o=r,ol}}function wo(n){try{var r=n._init;return r(n._payload)}catch(o){throw o!==null&&typeof o=="object"&&typeof o.then=="function"?(_o=o,ol):o}}var _o=null;function Tb(){if(_o===null)throw Error(i(459));var n=_o;return _o=null,n}function jb(n){if(n===ol||n===nh)throw Error(i(483))}var ll=null,cc=0;function rh(n){var r=cc;return cc+=1,ll===null&&(ll=[]),kb(ll,n,r)}function uc(n,r){r=r.props.ref,n.ref=r!==void 0?r:null}function ah(n,r){throw r.$$typeof===j?Error(i(525)):(n=Object.prototype.toString.call(r),Error(i(31,n==="[object Object]"?"object with keys {"+Object.keys(r).join(", ")+"}":n)))}function Eb(n){function r(X,K){if(n){var re=X.deletions;re===null?(X.deletions=[K],X.flags|=16):re.push(K)}}function o(X,K){if(!n)return null;for(;K!==null;)r(X,K),K=K.sibling;return null}function c(X){for(var K=new Map;X!==null;)X.key!==null?K.set(X.key,X):K.set(X.index,X),X=X.sibling;return K}function f(X,K){return X=Ba(X,K),X.index=0,X.sibling=null,X}function m(X,K,re){return X.index=re,n?(re=X.alternate,re!==null?(re=re.index,re<K?(X.flags|=67108866,K):re):(X.flags|=67108866,K)):(X.flags|=1048576,K)}function v(X){return n&&X.alternate===null&&(X.flags|=67108866),X}function E(X,K,re,Te){return K===null||K.tag!==6?(K=Cf(re,X.mode,Te),K.return=X,K):(K=f(K,re),K.return=X,K)}function B(X,K,re,Te){var Tt=re.type;return Tt===U?we(X,K,re.props.children,Te,re.key):K!==null&&(K.elementType===Tt||typeof Tt=="object"&&Tt!==null&&Tt.$$typeof===S&&wo(Tt)===K.type)?(K=f(K,re.props),uc(K,re),K.return=X,K):(K=Xu(re.type,re.key,re.props,null,X.mode,Te),uc(K,re),K.return=X,K)}function ae(X,K,re,Te){return K===null||K.tag!==4||K.stateNode.containerInfo!==re.containerInfo||K.stateNode.implementation!==re.implementation?(K=Rf(re,X.mode,Te),K.return=X,K):(K=f(K,re.children||[]),K.return=X,K)}function we(X,K,re,Te,Tt){return K===null||K.tag!==7?(K=go(re,X.mode,Te,Tt),K.return=X,K):(K=f(K,re),K.return=X,K)}function Re(X,K,re){if(typeof K=="string"&&K!==""||typeof K=="number"||typeof K=="bigint")return K=Cf(""+K,X.mode,re),K.return=X,K;if(typeof K=="object"&&K!==null){switch(K.$$typeof){case O:return re=Xu(K.type,K.key,K.props,null,X.mode,re),uc(re,K),re.return=X,re;case $:return K=Rf(K,X.mode,re),K.return=X,K;case S:return K=wo(K),Re(X,K,re)}if(xt(K)||F(K))return K=go(K,X.mode,re,null),K.return=X,K;if(typeof K.then=="function")return Re(X,rh(K),re);if(K.$$typeof===ye)return Re(X,eh(X,K),re);ah(X,K)}return null}function oe(X,K,re,Te){var Tt=K!==null?K.key:null;if(typeof re=="string"&&re!==""||typeof re=="number"||typeof re=="bigint")return Tt!==null?null:E(X,K,""+re,Te);if(typeof re=="object"&&re!==null){switch(re.$$typeof){case O:return re.key===Tt?B(X,K,re,Te):null;case $:return re.key===Tt?ae(X,K,re,Te):null;case S:return re=wo(re),oe(X,K,re,Te)}if(xt(re)||F(re))return Tt!==null?null:we(X,K,re,Te,null);if(typeof re.then=="function")return oe(X,K,rh(re),Te);if(re.$$typeof===ye)return oe(X,K,eh(X,re),Te);ah(X,re)}return null}function de(X,K,re,Te,Tt){if(typeof Te=="string"&&Te!==""||typeof Te=="number"||typeof Te=="bigint")return X=X.get(re)||null,E(K,X,""+Te,Tt);if(typeof Te=="object"&&Te!==null){switch(Te.$$typeof){case O:return X=X.get(Te.key===null?re:Te.key)||null,B(K,X,Te,Tt);case $:return X=X.get(Te.key===null?re:Te.key)||null,ae(K,X,Te,Tt);case S:return Te=wo(Te),de(X,K,re,Te,Tt)}if(xt(Te)||F(Te))return X=X.get(re)||null,we(K,X,Te,Tt,null);if(typeof Te.then=="function")return de(X,K,re,rh(Te),Tt);if(Te.$$typeof===ye)return de(X,K,re,eh(K,Te),Tt);ah(K,Te)}return null}function ut(X,K,re,Te){for(var Tt=null,Nn=null,yt=K,nn=K=0,dn=null;yt!==null&&nn<re.length;nn++){yt.index>nn?(dn=yt,yt=null):dn=yt.sibling;var Cn=oe(X,yt,re[nn],Te);if(Cn===null){yt===null&&(yt=dn);break}n&&yt&&Cn.alternate===null&&r(X,yt),K=m(Cn,K,nn),Nn===null?Tt=Cn:Nn.sibling=Cn,Nn=Cn,yt=dn}if(nn===re.length)return o(X,yt),kn&&Ua(X,nn),Tt;if(yt===null){for(;nn<re.length;nn++)yt=Re(X,re[nn],Te),yt!==null&&(K=m(yt,K,nn),Nn===null?Tt=yt:Nn.sibling=yt,Nn=yt);return kn&&Ua(X,nn),Tt}for(yt=c(yt);nn<re.length;nn++)dn=de(yt,X,nn,re[nn],Te),dn!==null&&(n&&dn.alternate!==null&&yt.delete(dn.key===null?nn:dn.key),K=m(dn,K,nn),Nn===null?Tt=dn:Nn.sibling=dn,Nn=dn);return n&&yt.forEach(function(Li){return r(X,Li)}),kn&&Ua(X,nn),Tt}function Mt(X,K,re,Te){if(re==null)throw Error(i(151));for(var Tt=null,Nn=null,yt=K,nn=K=0,dn=null,Cn=re.next();yt!==null&&!Cn.done;nn++,Cn=re.next()){yt.index>nn?(dn=yt,yt=null):dn=yt.sibling;var Li=oe(X,yt,Cn.value,Te);if(Li===null){yt===null&&(yt=dn);break}n&&yt&&Li.alternate===null&&r(X,yt),K=m(Li,K,nn),Nn===null?Tt=Li:Nn.sibling=Li,Nn=Li,yt=dn}if(Cn.done)return o(X,yt),kn&&Ua(X,nn),Tt;if(yt===null){for(;!Cn.done;nn++,Cn=re.next())Cn=Re(X,Cn.value,Te),Cn!==null&&(K=m(Cn,K,nn),Nn===null?Tt=Cn:Nn.sibling=Cn,Nn=Cn);return kn&&Ua(X,nn),Tt}for(yt=c(yt);!Cn.done;nn++,Cn=re.next())Cn=de(yt,X,nn,Cn.value,Te),Cn!==null&&(n&&Cn.alternate!==null&&yt.delete(Cn.key===null?nn:Cn.key),K=m(Cn,K,nn),Nn===null?Tt=Cn:Nn.sibling=Cn,Nn=Cn);return n&&yt.forEach(function(nj){return r(X,nj)}),kn&&Ua(X,nn),Tt}function $n(X,K,re,Te){if(typeof re=="object"&&re!==null&&re.type===U&&re.key===null&&(re=re.props.children),typeof re=="object"&&re!==null){switch(re.$$typeof){case O:e:{for(var Tt=re.key;K!==null;){if(K.key===Tt){if(Tt=re.type,Tt===U){if(K.tag===7){o(X,K.sibling),Te=f(K,re.props.children),Te.return=X,X=Te;break e}}else if(K.elementType===Tt||typeof Tt=="object"&&Tt!==null&&Tt.$$typeof===S&&wo(Tt)===K.type){o(X,K.sibling),Te=f(K,re.props),uc(Te,re),Te.return=X,X=Te;break e}o(X,K);break}else r(X,K);K=K.sibling}re.type===U?(Te=go(re.props.children,X.mode,Te,re.key),Te.return=X,X=Te):(Te=Xu(re.type,re.key,re.props,null,X.mode,Te),uc(Te,re),Te.return=X,X=Te)}return v(X);case $:e:{for(Tt=re.key;K!==null;){if(K.key===Tt)if(K.tag===4&&K.stateNode.containerInfo===re.containerInfo&&K.stateNode.implementation===re.implementation){o(X,K.sibling),Te=f(K,re.children||[]),Te.return=X,X=Te;break e}else{o(X,K);break}else r(X,K);K=K.sibling}Te=Rf(re,X.mode,Te),Te.return=X,X=Te}return v(X);case S:return re=wo(re),$n(X,K,re,Te)}if(xt(re))return ut(X,K,re,Te);if(F(re)){if(Tt=F(re),typeof Tt!="function")throw Error(i(150));return re=Tt.call(re),Mt(X,K,re,Te)}if(typeof re.then=="function")return $n(X,K,rh(re),Te);if(re.$$typeof===ye)return $n(X,K,eh(X,re),Te);ah(X,re)}return typeof re=="string"&&re!==""||typeof re=="number"||typeof re=="bigint"?(re=""+re,K!==null&&K.tag===6?(o(X,K.sibling),Te=f(K,re),Te.return=X,X=Te):(o(X,K),Te=Cf(re,X.mode,Te),Te.return=X,X=Te),v(X)):o(X,K)}return function(X,K,re,Te){try{cc=0;var Tt=$n(X,K,re,Te);return ll=null,Tt}catch(yt){if(yt===ol||yt===nh)throw yt;var Nn=Sr(29,yt,null,X.mode);return Nn.lanes=Te,Nn.return=X,Nn}}}var ko=Eb(!0),Sb=Eb(!1),vi=!1;function Ff(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function qf(n,r){n=n.updateQueue,r.updateQueue===n&&(r.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,callbacks:null})}function xi(n){return{lane:n,tag:0,payload:null,callback:null,next:null}}function wi(n,r,o){var c=n.updateQueue;if(c===null)return null;if(c=c.shared,(Dn&2)!==0){var f=c.pending;return f===null?r.next=r:(r.next=f.next,f.next=r),c.pending=r,r=Qu(n),ub(n,null,o),r}return Yu(n,c,r,o),Qu(n)}function hc(n,r,o){if(r=r.updateQueue,r!==null&&(r=r.shared,(o&4194048)!==0)){var c=r.lanes;c&=n.pendingLanes,o|=c,r.lanes=o,un(n,o)}}function Hf(n,r){var o=n.updateQueue,c=n.alternate;if(c!==null&&(c=c.updateQueue,o===c)){var f=null,m=null;if(o=o.firstBaseUpdate,o!==null){do{var v={lane:o.lane,tag:o.tag,payload:o.payload,callback:null,next:null};m===null?f=m=v:m=m.next=v,o=o.next}while(o!==null);m===null?f=m=r:m=m.next=r}else f=m=r;o={baseState:c.baseState,firstBaseUpdate:f,lastBaseUpdate:m,shared:c.shared,callbacks:c.callbacks},n.updateQueue=o;return}n=o.lastBaseUpdate,n===null?o.firstBaseUpdate=r:n.next=r,o.lastBaseUpdate=r}var $f=!1;function dc(){if($f){var n=il;if(n!==null)throw n}}function fc(n,r,o,c){$f=!1;var f=n.updateQueue;vi=!1;var m=f.firstBaseUpdate,v=f.lastBaseUpdate,E=f.shared.pending;if(E!==null){f.shared.pending=null;var B=E,ae=B.next;B.next=null,v===null?m=ae:v.next=ae,v=B;var we=n.alternate;we!==null&&(we=we.updateQueue,E=we.lastBaseUpdate,E!==v&&(E===null?we.firstBaseUpdate=ae:E.next=ae,we.lastBaseUpdate=B))}if(m!==null){var Re=f.baseState;v=0,we=ae=B=null,E=m;do{var oe=E.lane&-536870913,de=oe!==E.lane;if(de?(hn&oe)===oe:(c&oe)===oe){oe!==0&&oe===al&&($f=!0),we!==null&&(we=we.next={lane:0,tag:E.tag,payload:E.payload,callback:null,next:null});e:{var ut=n,Mt=E;oe=r;var $n=o;switch(Mt.tag){case 1:if(ut=Mt.payload,typeof ut=="function"){Re=ut.call($n,Re,oe);break e}Re=ut;break e;case 3:ut.flags=ut.flags&-65537|128;case 0:if(ut=Mt.payload,oe=typeof ut=="function"?ut.call($n,Re,oe):ut,oe==null)break e;Re=k({},Re,oe);break e;case 2:vi=!0}}oe=E.callback,oe!==null&&(n.flags|=64,de&&(n.flags|=8192),de=f.callbacks,de===null?f.callbacks=[oe]:de.push(oe))}else de={lane:oe,tag:E.tag,payload:E.payload,callback:E.callback,next:null},we===null?(ae=we=de,B=Re):we=we.next=de,v|=oe;if(E=E.next,E===null){if(E=f.shared.pending,E===null)break;de=E,E=de.next,de.next=null,f.lastBaseUpdate=de,f.shared.pending=null}}while(!0);we===null&&(B=Re),f.baseState=B,f.firstBaseUpdate=ae,f.lastBaseUpdate=we,m===null&&(f.shared.lanes=0),Ei|=v,n.lanes=v,n.memoizedState=Re}}function Nb(n,r){if(typeof n!="function")throw Error(i(191,n));n.call(r)}function Cb(n,r){var o=n.callbacks;if(o!==null)for(n.callbacks=null,n=0;n<o.length;n++)Nb(o[n],r)}var cl=D(null),ih=D(0);function Rb(n,r){n=Xa,be(ih,n),be(cl,r),Xa=n|r.baseLanes}function Wf(){be(ih,Xa),be(cl,cl.current)}function Gf(){Xa=ih.current,W(cl),W(ih)}var Nr=D(null),qr=null;function _i(n){var r=n.alternate;be(ws,ws.current&1),be(Nr,n),qr===null&&(r===null||cl.current!==null||r.memoizedState!==null)&&(qr=n)}function Kf(n){be(ws,ws.current),be(Nr,n),qr===null&&(qr=n)}function Ab(n){n.tag===22?(be(ws,ws.current),be(Nr,n),qr===null&&(qr=n)):ki()}function ki(){be(ws,ws.current),be(Nr,Nr.current)}function Cr(n){W(Nr),qr===n&&(qr=null),W(ws)}var ws=D(0);function oh(n){for(var r=n;r!==null;){if(r.tag===13){var o=r.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||ep(o)||tp(o)))return r}else if(r.tag===19&&(r.memoizedProps.revealOrder==="forwards"||r.memoizedProps.revealOrder==="backwards"||r.memoizedProps.revealOrder==="unstable_legacy-backwards"||r.memoizedProps.revealOrder==="together")){if((r.flags&128)!==0)return r}else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===n)break;for(;r.sibling===null;){if(r.return===null||r.return===n)return null;r=r.return}r.sibling.return=r.return,r=r.sibling}return null}var qa=0,Zt=null,qn=null,Ss=null,lh=!1,ul=!1,To=!1,ch=0,mc=0,hl=null,Wk=0;function ms(){throw Error(i(321))}function Yf(n,r){if(r===null)return!1;for(var o=0;o<r.length&&o<n.length;o++)if(!Er(n[o],r[o]))return!1;return!0}function Qf(n,r,o,c,f,m){return qa=m,Zt=r,r.memoizedState=null,r.updateQueue=null,r.lanes=0,z.H=n===null||n.memoizedState===null?mv:hm,To=!1,m=o(c,f),To=!1,ul&&(m=Mb(r,o,c,f)),Ib(n),m}function Ib(n){z.H=yc;var r=qn!==null&&qn.next!==null;if(qa=0,Ss=qn=Zt=null,lh=!1,mc=0,hl=null,r)throw Error(i(300));n===null||Ns||(n=n.dependencies,n!==null&&Zu(n)&&(Ns=!0))}function Mb(n,r,o,c){Zt=n;var f=0;do{if(ul&&(hl=null),mc=0,ul=!1,25<=f)throw Error(i(301));if(f+=1,Ss=qn=null,n.updateQueue!=null){var m=n.updateQueue;m.lastEffect=null,m.events=null,m.stores=null,m.memoCache!=null&&(m.memoCache.index=0)}z.H=pv,m=r(o,c)}while(ul);return m}function Gk(){var n=z.H,r=n.useState()[0];return r=typeof r.then=="function"?pc(r):r,n=n.useState()[0],(qn!==null?qn.memoizedState:null)!==n&&(Zt.flags|=1024),r}function Xf(){var n=ch!==0;return ch=0,n}function Jf(n,r,o){r.updateQueue=n.updateQueue,r.flags&=-2053,n.lanes&=~o}function Zf(n){if(lh){for(n=n.memoizedState;n!==null;){var r=n.queue;r!==null&&(r.pending=null),n=n.next}lh=!1}qa=0,Ss=qn=Zt=null,ul=!1,mc=ch=0,hl=null}function ar(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ss===null?Zt.memoizedState=Ss=n:Ss=Ss.next=n,Ss}function _s(){if(qn===null){var n=Zt.alternate;n=n!==null?n.memoizedState:null}else n=qn.next;var r=Ss===null?Zt.memoizedState:Ss.next;if(r!==null)Ss=r,qn=n;else{if(n===null)throw Zt.alternate===null?Error(i(467)):Error(i(310));qn=n,n={memoizedState:qn.memoizedState,baseState:qn.baseState,baseQueue:qn.baseQueue,queue:qn.queue,next:null},Ss===null?Zt.memoizedState=Ss=n:Ss=Ss.next=n}return Ss}function uh(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function pc(n){var r=mc;return mc+=1,hl===null&&(hl=[]),n=kb(hl,n,r),r=Zt,(Ss===null?r.memoizedState:Ss.next)===null&&(r=r.alternate,z.H=r===null||r.memoizedState===null?mv:hm),n}function hh(n){if(n!==null&&typeof n=="object"){if(typeof n.then=="function")return pc(n);if(n.$$typeof===ye)return Hs(n)}throw Error(i(438,String(n)))}function em(n){var r=null,o=Zt.updateQueue;if(o!==null&&(r=o.memoCache),r==null){var c=Zt.alternate;c!==null&&(c=c.updateQueue,c!==null&&(c=c.memoCache,c!=null&&(r={data:c.data.map(function(f){return f.slice()}),index:0})))}if(r==null&&(r={data:[],index:0}),o===null&&(o=uh(),Zt.updateQueue=o),o.memoCache=r,o=r.data[r.index],o===void 0)for(o=r.data[r.index]=Array(n),c=0;c<n;c++)o[c]=V;return r.index++,o}function Ha(n,r){return typeof r=="function"?r(n):r}function dh(n){var r=_s();return tm(r,qn,n)}function tm(n,r,o){var c=n.queue;if(c===null)throw Error(i(311));c.lastRenderedReducer=o;var f=n.baseQueue,m=c.pending;if(m!==null){if(f!==null){var v=f.next;f.next=m.next,m.next=v}r.baseQueue=f=m,c.pending=null}if(m=n.baseState,f===null)n.memoizedState=m;else{r=f.next;var E=v=null,B=null,ae=r,we=!1;do{var Re=ae.lane&-536870913;if(Re!==ae.lane?(hn&Re)===Re:(qa&Re)===Re){var oe=ae.revertLane;if(oe===0)B!==null&&(B=B.next={lane:0,revertLane:0,gesture:null,action:ae.action,hasEagerState:ae.hasEagerState,eagerState:ae.eagerState,next:null}),Re===al&&(we=!0);else if((qa&oe)===oe){ae=ae.next,oe===al&&(we=!0);continue}else Re={lane:0,revertLane:ae.revertLane,gesture:null,action:ae.action,hasEagerState:ae.hasEagerState,eagerState:ae.eagerState,next:null},B===null?(E=B=Re,v=m):B=B.next=Re,Zt.lanes|=oe,Ei|=oe;Re=ae.action,To&&o(m,Re),m=ae.hasEagerState?ae.eagerState:o(m,Re)}else oe={lane:Re,revertLane:ae.revertLane,gesture:ae.gesture,action:ae.action,hasEagerState:ae.hasEagerState,eagerState:ae.eagerState,next:null},B===null?(E=B=oe,v=m):B=B.next=oe,Zt.lanes|=Re,Ei|=Re;ae=ae.next}while(ae!==null&&ae!==r);if(B===null?v=m:B.next=E,!Er(m,n.memoizedState)&&(Ns=!0,we&&(o=il,o!==null)))throw o;n.memoizedState=m,n.baseState=v,n.baseQueue=B,c.lastRenderedState=m}return f===null&&(c.lanes=0),[n.memoizedState,c.dispatch]}function nm(n){var r=_s(),o=r.queue;if(o===null)throw Error(i(311));o.lastRenderedReducer=n;var c=o.dispatch,f=o.pending,m=r.memoizedState;if(f!==null){o.pending=null;var v=f=f.next;do m=n(m,v.action),v=v.next;while(v!==f);Er(m,r.memoizedState)||(Ns=!0),r.memoizedState=m,r.baseQueue===null&&(r.baseState=m),o.lastRenderedState=m}return[m,c]}function Db(n,r,o){var c=Zt,f=_s(),m=kn;if(m){if(o===void 0)throw Error(i(407));o=o()}else o=r();var v=!Er((qn||f).memoizedState,o);if(v&&(f.memoizedState=o,Ns=!0),f=f.queue,am(Ob.bind(null,c,f,n),[n]),f.getSnapshot!==r||v||Ss!==null&&Ss.memoizedState.tag&1){if(c.flags|=2048,dl(9,{destroy:void 0},Lb.bind(null,c,f,o,r),null),Yn===null)throw Error(i(349));m||(qa&127)!==0||Pb(c,r,o)}return o}function Pb(n,r,o){n.flags|=16384,n={getSnapshot:r,value:o},r=Zt.updateQueue,r===null?(r=uh(),Zt.updateQueue=r,r.stores=[n]):(o=r.stores,o===null?r.stores=[n]:o.push(n))}function Lb(n,r,o,c){r.value=o,r.getSnapshot=c,Vb(r)&&Bb(n)}function Ob(n,r,o){return o(function(){Vb(r)&&Bb(n)})}function Vb(n){var r=n.getSnapshot;n=n.value;try{var o=r();return!Er(n,o)}catch{return!0}}function Bb(n){var r=po(n,2);r!==null&&br(r,n,2)}function sm(n){var r=ar();if(typeof n=="function"){var o=n;if(n=o(),To){De(!0);try{o()}finally{De(!1)}}}return r.memoizedState=r.baseState=n,r.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ha,lastRenderedState:n},r}function Ub(n,r,o,c){return n.baseState=o,tm(n,qn,typeof c=="function"?c:Ha)}function Kk(n,r,o,c,f){if(ph(n))throw Error(i(485));if(n=r.action,n!==null){var m={payload:f,action:n,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(v){m.listeners.push(v)}};z.T!==null?o(!0):m.isTransition=!1,c(m),o=r.pending,o===null?(m.next=r.pending=m,zb(r,m)):(m.next=o.next,r.pending=o.next=m)}}function zb(n,r){var o=r.action,c=r.payload,f=n.state;if(r.isTransition){var m=z.T,v={};z.T=v;try{var E=o(f,c),B=z.S;B!==null&&B(v,E),Fb(n,r,E)}catch(ae){rm(n,r,ae)}finally{m!==null&&v.types!==null&&(m.types=v.types),z.T=m}}else try{m=o(f,c),Fb(n,r,m)}catch(ae){rm(n,r,ae)}}function Fb(n,r,o){o!==null&&typeof o=="object"&&typeof o.then=="function"?o.then(function(c){qb(n,r,c)},function(c){return rm(n,r,c)}):qb(n,r,o)}function qb(n,r,o){r.status="fulfilled",r.value=o,Hb(r),n.state=o,r=n.pending,r!==null&&(o=r.next,o===r?n.pending=null:(o=o.next,r.next=o,zb(n,o)))}function rm(n,r,o){var c=n.pending;if(n.pending=null,c!==null){c=c.next;do r.status="rejected",r.reason=o,Hb(r),r=r.next;while(r!==c)}n.action=null}function Hb(n){n=n.listeners;for(var r=0;r<n.length;r++)(0,n[r])()}function $b(n,r){return r}function Wb(n,r){if(kn){var o=Yn.formState;if(o!==null){e:{var c=Zt;if(kn){if(ns){t:{for(var f=ns,m=Fr;f.nodeType!==8;){if(!m){f=null;break t}if(f=Hr(f.nextSibling),f===null){f=null;break t}}m=f.data,f=m==="F!"||m==="F"?f:null}if(f){ns=Hr(f.nextSibling),c=f.data==="F!";break e}}yi(c)}c=!1}c&&(r=o[0])}}return o=ar(),o.memoizedState=o.baseState=r,c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:$b,lastRenderedState:r},o.queue=c,o=hv.bind(null,Zt,c),c.dispatch=o,c=sm(!1),m=um.bind(null,Zt,!1,c.queue),c=ar(),f={state:r,dispatch:null,action:n,pending:null},c.queue=f,o=Kk.bind(null,Zt,f,m,o),f.dispatch=o,c.memoizedState=n,[r,o,!1]}function Gb(n){var r=_s();return Kb(r,qn,n)}function Kb(n,r,o){if(r=tm(n,r,$b)[0],n=dh(Ha)[0],typeof r=="object"&&r!==null&&typeof r.then=="function")try{var c=pc(r)}catch(v){throw v===ol?nh:v}else c=r;r=_s();var f=r.queue,m=f.dispatch;return o!==r.memoizedState&&(Zt.flags|=2048,dl(9,{destroy:void 0},Yk.bind(null,f,o),null)),[c,m,n]}function Yk(n,r){n.action=r}function Yb(n){var r=_s(),o=qn;if(o!==null)return Kb(r,o,n);_s(),r=r.memoizedState,o=_s();var c=o.queue.dispatch;return o.memoizedState=n,[r,c,!1]}function dl(n,r,o,c){return n={tag:n,create:o,deps:c,inst:r,next:null},r=Zt.updateQueue,r===null&&(r=uh(),Zt.updateQueue=r),o=r.lastEffect,o===null?r.lastEffect=n.next=n:(c=o.next,o.next=n,n.next=c,r.lastEffect=n),n}function Qb(){return _s().memoizedState}function fh(n,r,o,c){var f=ar();Zt.flags|=n,f.memoizedState=dl(1|r,{destroy:void 0},o,c===void 0?null:c)}function mh(n,r,o,c){var f=_s();c=c===void 0?null:c;var m=f.memoizedState.inst;qn!==null&&c!==null&&Yf(c,qn.memoizedState.deps)?f.memoizedState=dl(r,m,o,c):(Zt.flags|=n,f.memoizedState=dl(1|r,m,o,c))}function Xb(n,r){fh(8390656,8,n,r)}function am(n,r){mh(2048,8,n,r)}function Qk(n){Zt.flags|=4;var r=Zt.updateQueue;if(r===null)r=uh(),Zt.updateQueue=r,r.events=[n];else{var o=r.events;o===null?r.events=[n]:o.push(n)}}function Jb(n){var r=_s().memoizedState;return Qk({ref:r,nextImpl:n}),function(){if((Dn&2)!==0)throw Error(i(440));return r.impl.apply(void 0,arguments)}}function Zb(n,r){return mh(4,2,n,r)}function ev(n,r){return mh(4,4,n,r)}function tv(n,r){if(typeof r=="function"){n=n();var o=r(n);return function(){typeof o=="function"?o():r(null)}}if(r!=null)return n=n(),r.current=n,function(){r.current=null}}function nv(n,r,o){o=o!=null?o.concat([n]):null,mh(4,4,tv.bind(null,r,n),o)}function im(){}function sv(n,r){var o=_s();r=r===void 0?null:r;var c=o.memoizedState;return r!==null&&Yf(r,c[1])?c[0]:(o.memoizedState=[n,r],n)}function rv(n,r){var o=_s();r=r===void 0?null:r;var c=o.memoizedState;if(r!==null&&Yf(r,c[1]))return c[0];if(c=n(),To){De(!0);try{n()}finally{De(!1)}}return o.memoizedState=[c,r],c}function om(n,r,o){return o===void 0||(qa&1073741824)!==0&&(hn&261930)===0?n.memoizedState=r:(n.memoizedState=o,n=a0(),Zt.lanes|=n,Ei|=n,o)}function av(n,r,o,c){return Er(o,r)?o:cl.current!==null?(n=om(n,o,c),Er(n,r)||(Ns=!0),n):(qa&42)===0||(qa&1073741824)!==0&&(hn&261930)===0?(Ns=!0,n.memoizedState=o):(n=a0(),Zt.lanes|=n,Ei|=n,r)}function iv(n,r,o,c,f){var m=fe.p;fe.p=m!==0&&8>m?m:8;var v=z.T,E={};z.T=E,um(n,!1,r,o);try{var B=f(),ae=z.S;if(ae!==null&&ae(E,B),B!==null&&typeof B=="object"&&typeof B.then=="function"){var we=$k(B,c);gc(n,r,we,Ir(n))}else gc(n,r,c,Ir(n))}catch(Re){gc(n,r,{then:function(){},status:"rejected",reason:Re},Ir())}finally{fe.p=m,v!==null&&E.types!==null&&(v.types=E.types),z.T=v}}function Xk(){}function lm(n,r,o,c){if(n.tag!==5)throw Error(i(476));var f=ov(n).queue;iv(n,f,r,Ie,o===null?Xk:function(){return lv(n),o(c)})}function ov(n){var r=n.memoizedState;if(r!==null)return r;r={memoizedState:Ie,baseState:Ie,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ha,lastRenderedState:Ie},next:null};var o={};return r.next={memoizedState:o,baseState:o,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ha,lastRenderedState:o},next:null},n.memoizedState=r,n=n.alternate,n!==null&&(n.memoizedState=r),r}function lv(n){var r=ov(n);r.next===null&&(r=n.alternate.memoizedState),gc(n,r.next.queue,{},Ir())}function cm(){return Hs(Mc)}function cv(){return _s().memoizedState}function uv(){return _s().memoizedState}function Jk(n){for(var r=n.return;r!==null;){switch(r.tag){case 24:case 3:var o=Ir();n=xi(o);var c=wi(r,n,o);c!==null&&(br(c,r,o),hc(c,r,o)),r={cache:Vf()},n.payload=r;return}r=r.return}}function Zk(n,r,o){var c=Ir();o={lane:c,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null},ph(n)?dv(r,o):(o=Sf(n,r,o,c),o!==null&&(br(o,n,c),fv(o,r,c)))}function hv(n,r,o){var c=Ir();gc(n,r,o,c)}function gc(n,r,o,c){var f={lane:c,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null};if(ph(n))dv(r,f);else{var m=n.alternate;if(n.lanes===0&&(m===null||m.lanes===0)&&(m=r.lastRenderedReducer,m!==null))try{var v=r.lastRenderedState,E=m(v,o);if(f.hasEagerState=!0,f.eagerState=E,Er(E,v))return Yu(n,r,f,0),Yn===null&&Ku(),!1}catch{}if(o=Sf(n,r,f,c),o!==null)return br(o,n,c),fv(o,r,c),!0}return!1}function um(n,r,o,c){if(c={lane:2,revertLane:Fm(),gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},ph(n)){if(r)throw Error(i(479))}else r=Sf(n,o,c,2),r!==null&&br(r,n,2)}function ph(n){var r=n.alternate;return n===Zt||r!==null&&r===Zt}function dv(n,r){ul=lh=!0;var o=n.pending;o===null?r.next=r:(r.next=o.next,o.next=r),n.pending=r}function fv(n,r,o){if((o&4194048)!==0){var c=r.lanes;c&=n.pendingLanes,o|=c,r.lanes=o,un(n,o)}}var yc={readContext:Hs,use:hh,useCallback:ms,useContext:ms,useEffect:ms,useImperativeHandle:ms,useLayoutEffect:ms,useInsertionEffect:ms,useMemo:ms,useReducer:ms,useRef:ms,useState:ms,useDebugValue:ms,useDeferredValue:ms,useTransition:ms,useSyncExternalStore:ms,useId:ms,useHostTransitionStatus:ms,useFormState:ms,useActionState:ms,useOptimistic:ms,useMemoCache:ms,useCacheRefresh:ms};yc.useEffectEvent=ms;var mv={readContext:Hs,use:hh,useCallback:function(n,r){return ar().memoizedState=[n,r===void 0?null:r],n},useContext:Hs,useEffect:Xb,useImperativeHandle:function(n,r,o){o=o!=null?o.concat([n]):null,fh(4194308,4,tv.bind(null,r,n),o)},useLayoutEffect:function(n,r){return fh(4194308,4,n,r)},useInsertionEffect:function(n,r){fh(4,2,n,r)},useMemo:function(n,r){var o=ar();r=r===void 0?null:r;var c=n();if(To){De(!0);try{n()}finally{De(!1)}}return o.memoizedState=[c,r],c},useReducer:function(n,r,o){var c=ar();if(o!==void 0){var f=o(r);if(To){De(!0);try{o(r)}finally{De(!1)}}}else f=r;return c.memoizedState=c.baseState=f,n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:f},c.queue=n,n=n.dispatch=Zk.bind(null,Zt,n),[c.memoizedState,n]},useRef:function(n){var r=ar();return n={current:n},r.memoizedState=n},useState:function(n){n=sm(n);var r=n.queue,o=hv.bind(null,Zt,r);return r.dispatch=o,[n.memoizedState,o]},useDebugValue:im,useDeferredValue:function(n,r){var o=ar();return om(o,n,r)},useTransition:function(){var n=sm(!1);return n=iv.bind(null,Zt,n.queue,!0,!1),ar().memoizedState=n,[!1,n]},useSyncExternalStore:function(n,r,o){var c=Zt,f=ar();if(kn){if(o===void 0)throw Error(i(407));o=o()}else{if(o=r(),Yn===null)throw Error(i(349));(hn&127)!==0||Pb(c,r,o)}f.memoizedState=o;var m={value:o,getSnapshot:r};return f.queue=m,Xb(Ob.bind(null,c,m,n),[n]),c.flags|=2048,dl(9,{destroy:void 0},Lb.bind(null,c,m,o,r),null),o},useId:function(){var n=ar(),r=Yn.identifierPrefix;if(kn){var o=ya,c=ga;o=(c&~(1<<32-Oe(c)-1)).toString(32)+o,r="_"+r+"R_"+o,o=ch++,0<o&&(r+="H"+o.toString(32)),r+="_"}else o=Wk++,r="_"+r+"r_"+o.toString(32)+"_";return n.memoizedState=r},useHostTransitionStatus:cm,useFormState:Wb,useActionState:Wb,useOptimistic:function(n){var r=ar();r.memoizedState=r.baseState=n;var o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return r.queue=o,r=um.bind(null,Zt,!0,o),o.dispatch=r,[n,r]},useMemoCache:em,useCacheRefresh:function(){return ar().memoizedState=Jk.bind(null,Zt)},useEffectEvent:function(n){var r=ar(),o={impl:n};return r.memoizedState=o,function(){if((Dn&2)!==0)throw Error(i(440));return o.impl.apply(void 0,arguments)}}},hm={readContext:Hs,use:hh,useCallback:sv,useContext:Hs,useEffect:am,useImperativeHandle:nv,useInsertionEffect:Zb,useLayoutEffect:ev,useMemo:rv,useReducer:dh,useRef:Qb,useState:function(){return dh(Ha)},useDebugValue:im,useDeferredValue:function(n,r){var o=_s();return av(o,qn.memoizedState,n,r)},useTransition:function(){var n=dh(Ha)[0],r=_s().memoizedState;return[typeof n=="boolean"?n:pc(n),r]},useSyncExternalStore:Db,useId:cv,useHostTransitionStatus:cm,useFormState:Gb,useActionState:Gb,useOptimistic:function(n,r){var o=_s();return Ub(o,qn,n,r)},useMemoCache:em,useCacheRefresh:uv};hm.useEffectEvent=Jb;var pv={readContext:Hs,use:hh,useCallback:sv,useContext:Hs,useEffect:am,useImperativeHandle:nv,useInsertionEffect:Zb,useLayoutEffect:ev,useMemo:rv,useReducer:nm,useRef:Qb,useState:function(){return nm(Ha)},useDebugValue:im,useDeferredValue:function(n,r){var o=_s();return qn===null?om(o,n,r):av(o,qn.memoizedState,n,r)},useTransition:function(){var n=nm(Ha)[0],r=_s().memoizedState;return[typeof n=="boolean"?n:pc(n),r]},useSyncExternalStore:Db,useId:cv,useHostTransitionStatus:cm,useFormState:Yb,useActionState:Yb,useOptimistic:function(n,r){var o=_s();return qn!==null?Ub(o,qn,n,r):(o.baseState=n,[n,o.queue.dispatch])},useMemoCache:em,useCacheRefresh:uv};pv.useEffectEvent=Jb;function dm(n,r,o,c){r=n.memoizedState,o=o(c,r),o=o==null?r:k({},r,o),n.memoizedState=o,n.lanes===0&&(n.updateQueue.baseState=o)}var fm={enqueueSetState:function(n,r,o){n=n._reactInternals;var c=Ir(),f=xi(c);f.payload=r,o!=null&&(f.callback=o),r=wi(n,f,c),r!==null&&(br(r,n,c),hc(r,n,c))},enqueueReplaceState:function(n,r,o){n=n._reactInternals;var c=Ir(),f=xi(c);f.tag=1,f.payload=r,o!=null&&(f.callback=o),r=wi(n,f,c),r!==null&&(br(r,n,c),hc(r,n,c))},enqueueForceUpdate:function(n,r){n=n._reactInternals;var o=Ir(),c=xi(o);c.tag=2,r!=null&&(c.callback=r),r=wi(n,c,o),r!==null&&(br(r,n,o),hc(r,n,o))}};function gv(n,r,o,c,f,m,v){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(c,m,v):r.prototype&&r.prototype.isPureReactComponent?!sc(o,c)||!sc(f,m):!0}function yv(n,r,o,c){n=r.state,typeof r.componentWillReceiveProps=="function"&&r.componentWillReceiveProps(o,c),typeof r.UNSAFE_componentWillReceiveProps=="function"&&r.UNSAFE_componentWillReceiveProps(o,c),r.state!==n&&fm.enqueueReplaceState(r,r.state,null)}function jo(n,r){var o=r;if("ref"in r){o={};for(var c in r)c!=="ref"&&(o[c]=r[c])}if(n=n.defaultProps){o===r&&(o=k({},o));for(var f in n)o[f]===void 0&&(o[f]=n[f])}return o}function bv(n){Gu(n)}function vv(n){console.error(n)}function xv(n){Gu(n)}function gh(n,r){try{var o=n.onUncaughtError;o(r.value,{componentStack:r.stack})}catch(c){setTimeout(function(){throw c})}}function wv(n,r,o){try{var c=n.onCaughtError;c(o.value,{componentStack:o.stack,errorBoundary:r.tag===1?r.stateNode:null})}catch(f){setTimeout(function(){throw f})}}function mm(n,r,o){return o=xi(o),o.tag=3,o.payload={element:null},o.callback=function(){gh(n,r)},o}function _v(n){return n=xi(n),n.tag=3,n}function kv(n,r,o,c){var f=o.type.getDerivedStateFromError;if(typeof f=="function"){var m=c.value;n.payload=function(){return f(m)},n.callback=function(){wv(r,o,c)}}var v=o.stateNode;v!==null&&typeof v.componentDidCatch=="function"&&(n.callback=function(){wv(r,o,c),typeof f!="function"&&(Si===null?Si=new Set([this]):Si.add(this));var E=c.stack;this.componentDidCatch(c.value,{componentStack:E!==null?E:""})})}function eT(n,r,o,c,f){if(o.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){if(r=o.alternate,r!==null&&rl(r,o,f,!0),o=Nr.current,o!==null){switch(o.tag){case 31:case 13:return qr===null?Nh():o.alternate===null&&ps===0&&(ps=3),o.flags&=-257,o.flags|=65536,o.lanes=f,c===sh?o.flags|=16384:(r=o.updateQueue,r===null?o.updateQueue=new Set([c]):r.add(c),Bm(n,c,f)),!1;case 22:return o.flags|=65536,c===sh?o.flags|=16384:(r=o.updateQueue,r===null?(r={transitions:null,markerInstances:null,retryQueue:new Set([c])},o.updateQueue=r):(o=r.retryQueue,o===null?r.retryQueue=new Set([c]):o.add(c)),Bm(n,c,f)),!1}throw Error(i(435,o.tag))}return Bm(n,c,f),Nh(),!1}if(kn)return r=Nr.current,r!==null?((r.flags&65536)===0&&(r.flags|=256),r.flags|=65536,r.lanes=f,c!==Mf&&(n=Error(i(422),{cause:c}),ic(Br(n,o)))):(c!==Mf&&(r=Error(i(423),{cause:c}),ic(Br(r,o))),n=n.current.alternate,n.flags|=65536,f&=-f,n.lanes|=f,c=Br(c,o),f=mm(n.stateNode,c,f),Hf(n,f),ps!==4&&(ps=2)),!1;var m=Error(i(520),{cause:c});if(m=Br(m,o),jc===null?jc=[m]:jc.push(m),ps!==4&&(ps=2),r===null)return!0;c=Br(c,o),o=r;do{switch(o.tag){case 3:return o.flags|=65536,n=f&-f,o.lanes|=n,n=mm(o.stateNode,c,n),Hf(o,n),!1;case 1:if(r=o.type,m=o.stateNode,(o.flags&128)===0&&(typeof r.getDerivedStateFromError=="function"||m!==null&&typeof m.componentDidCatch=="function"&&(Si===null||!Si.has(m))))return o.flags|=65536,f&=-f,o.lanes|=f,f=_v(f),kv(f,n,o,c),Hf(o,f),!1}o=o.return}while(o!==null);return!1}var pm=Error(i(461)),Ns=!1;function $s(n,r,o,c){r.child=n===null?Sb(r,null,o,c):ko(r,n.child,o,c)}function Tv(n,r,o,c,f){o=o.render;var m=r.ref;if("ref"in c){var v={};for(var E in c)E!=="ref"&&(v[E]=c[E])}else v=c;return vo(r),c=Qf(n,r,o,v,m,f),E=Xf(),n!==null&&!Ns?(Jf(n,r,f),$a(n,r,f)):(kn&&E&&Af(r),r.flags|=1,$s(n,r,c,f),r.child)}function jv(n,r,o,c,f){if(n===null){var m=o.type;return typeof m=="function"&&!Nf(m)&&m.defaultProps===void 0&&o.compare===null?(r.tag=15,r.type=m,Ev(n,r,m,c,f)):(n=Xu(o.type,null,c,r,r.mode,f),n.ref=r.ref,n.return=r,r.child=n)}if(m=n.child,!km(n,f)){var v=m.memoizedProps;if(o=o.compare,o=o!==null?o:sc,o(v,c)&&n.ref===r.ref)return $a(n,r,f)}return r.flags|=1,n=Ba(m,c),n.ref=r.ref,n.return=r,r.child=n}function Ev(n,r,o,c,f){if(n!==null){var m=n.memoizedProps;if(sc(m,c)&&n.ref===r.ref)if(Ns=!1,r.pendingProps=c=m,km(n,f))(n.flags&131072)!==0&&(Ns=!0);else return r.lanes=n.lanes,$a(n,r,f)}return gm(n,r,o,c,f)}function Sv(n,r,o,c){var f=c.children,m=n!==null?n.memoizedState:null;if(n===null&&r.stateNode===null&&(r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),c.mode==="hidden"){if((r.flags&128)!==0){if(m=m!==null?m.baseLanes|o:o,n!==null){for(c=r.child=n.child,f=0;c!==null;)f=f|c.lanes|c.childLanes,c=c.sibling;c=f&~m}else c=0,r.child=null;return Nv(n,r,m,o,c)}if((o&536870912)!==0)r.memoizedState={baseLanes:0,cachePool:null},n!==null&&th(r,m!==null?m.cachePool:null),m!==null?Rb(r,m):Wf(),Ab(r);else return c=r.lanes=536870912,Nv(n,r,m!==null?m.baseLanes|o:o,o,c)}else m!==null?(th(r,m.cachePool),Rb(r,m),ki(),r.memoizedState=null):(n!==null&&th(r,null),Wf(),ki());return $s(n,r,f,o),r.child}function bc(n,r){return n!==null&&n.tag===22||r.stateNode!==null||(r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),r.sibling}function Nv(n,r,o,c,f){var m=Uf();return m=m===null?null:{parent:Es._currentValue,pool:m},r.memoizedState={baseLanes:o,cachePool:m},n!==null&&th(r,null),Wf(),Ab(r),n!==null&&rl(n,r,c,!0),r.childLanes=f,null}function yh(n,r){return r=vh({mode:r.mode,children:r.children},n.mode),r.ref=n.ref,n.child=r,r.return=n,r}function Cv(n,r,o){return ko(r,n.child,null,o),n=yh(r,r.pendingProps),n.flags|=2,Cr(r),r.memoizedState=null,n}function tT(n,r,o){var c=r.pendingProps,f=(r.flags&128)!==0;if(r.flags&=-129,n===null){if(kn){if(c.mode==="hidden")return n=yh(r,c),r.lanes=536870912,bc(null,n);if(Kf(r),(n=ns)?(n=z0(n,Fr),n=n!==null&&n.data==="&"?n:null,n!==null&&(r.memoizedState={dehydrated:n,treeContext:pi!==null?{id:ga,overflow:ya}:null,retryLane:536870912,hydrationErrors:null},o=db(n),o.return=r,r.child=o,qs=r,ns=null)):n=null,n===null)throw yi(r);return r.lanes=536870912,null}return yh(r,c)}var m=n.memoizedState;if(m!==null){var v=m.dehydrated;if(Kf(r),f)if(r.flags&256)r.flags&=-257,r=Cv(n,r,o);else if(r.memoizedState!==null)r.child=n.child,r.flags|=128,r=null;else throw Error(i(558));else if(Ns||rl(n,r,o,!1),f=(o&n.childLanes)!==0,Ns||f){if(c=Yn,c!==null&&(v=as(c,o),v!==0&&v!==m.retryLane))throw m.retryLane=v,po(n,v),br(c,n,v),pm;Nh(),r=Cv(n,r,o)}else n=m.treeContext,ns=Hr(v.nextSibling),qs=r,kn=!0,gi=null,Fr=!1,n!==null&&pb(r,n),r=yh(r,c),r.flags|=4096;return r}return n=Ba(n.child,{mode:c.mode,children:c.children}),n.ref=r.ref,r.child=n,n.return=r,n}function bh(n,r){var o=r.ref;if(o===null)n!==null&&n.ref!==null&&(r.flags|=4194816);else{if(typeof o!="function"&&typeof o!="object")throw Error(i(284));(n===null||n.ref!==o)&&(r.flags|=4194816)}}function gm(n,r,o,c,f){return vo(r),o=Qf(n,r,o,c,void 0,f),c=Xf(),n!==null&&!Ns?(Jf(n,r,f),$a(n,r,f)):(kn&&c&&Af(r),r.flags|=1,$s(n,r,o,f),r.child)}function Rv(n,r,o,c,f,m){return vo(r),r.updateQueue=null,o=Mb(r,c,o,f),Ib(n),c=Xf(),n!==null&&!Ns?(Jf(n,r,m),$a(n,r,m)):(kn&&c&&Af(r),r.flags|=1,$s(n,r,o,m),r.child)}function Av(n,r,o,c,f){if(vo(r),r.stateNode===null){var m=el,v=o.contextType;typeof v=="object"&&v!==null&&(m=Hs(v)),m=new o(c,m),r.memoizedState=m.state!==null&&m.state!==void 0?m.state:null,m.updater=fm,r.stateNode=m,m._reactInternals=r,m=r.stateNode,m.props=c,m.state=r.memoizedState,m.refs={},Ff(r),v=o.contextType,m.context=typeof v=="object"&&v!==null?Hs(v):el,m.state=r.memoizedState,v=o.getDerivedStateFromProps,typeof v=="function"&&(dm(r,o,v,c),m.state=r.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof m.getSnapshotBeforeUpdate=="function"||typeof m.UNSAFE_componentWillMount!="function"&&typeof m.componentWillMount!="function"||(v=m.state,typeof m.componentWillMount=="function"&&m.componentWillMount(),typeof m.UNSAFE_componentWillMount=="function"&&m.UNSAFE_componentWillMount(),v!==m.state&&fm.enqueueReplaceState(m,m.state,null),fc(r,c,m,f),dc(),m.state=r.memoizedState),typeof m.componentDidMount=="function"&&(r.flags|=4194308),c=!0}else if(n===null){m=r.stateNode;var E=r.memoizedProps,B=jo(o,E);m.props=B;var ae=m.context,we=o.contextType;v=el,typeof we=="object"&&we!==null&&(v=Hs(we));var Re=o.getDerivedStateFromProps;we=typeof Re=="function"||typeof m.getSnapshotBeforeUpdate=="function",E=r.pendingProps!==E,we||typeof m.UNSAFE_componentWillReceiveProps!="function"&&typeof m.componentWillReceiveProps!="function"||(E||ae!==v)&&yv(r,m,c,v),vi=!1;var oe=r.memoizedState;m.state=oe,fc(r,c,m,f),dc(),ae=r.memoizedState,E||oe!==ae||vi?(typeof Re=="function"&&(dm(r,o,Re,c),ae=r.memoizedState),(B=vi||gv(r,o,B,c,oe,ae,v))?(we||typeof m.UNSAFE_componentWillMount!="function"&&typeof m.componentWillMount!="function"||(typeof m.componentWillMount=="function"&&m.componentWillMount(),typeof m.UNSAFE_componentWillMount=="function"&&m.UNSAFE_componentWillMount()),typeof m.componentDidMount=="function"&&(r.flags|=4194308)):(typeof m.componentDidMount=="function"&&(r.flags|=4194308),r.memoizedProps=c,r.memoizedState=ae),m.props=c,m.state=ae,m.context=v,c=B):(typeof m.componentDidMount=="function"&&(r.flags|=4194308),c=!1)}else{m=r.stateNode,qf(n,r),v=r.memoizedProps,we=jo(o,v),m.props=we,Re=r.pendingProps,oe=m.context,ae=o.contextType,B=el,typeof ae=="object"&&ae!==null&&(B=Hs(ae)),E=o.getDerivedStateFromProps,(ae=typeof E=="function"||typeof m.getSnapshotBeforeUpdate=="function")||typeof m.UNSAFE_componentWillReceiveProps!="function"&&typeof m.componentWillReceiveProps!="function"||(v!==Re||oe!==B)&&yv(r,m,c,B),vi=!1,oe=r.memoizedState,m.state=oe,fc(r,c,m,f),dc();var de=r.memoizedState;v!==Re||oe!==de||vi||n!==null&&n.dependencies!==null&&Zu(n.dependencies)?(typeof E=="function"&&(dm(r,o,E,c),de=r.memoizedState),(we=vi||gv(r,o,we,c,oe,de,B)||n!==null&&n.dependencies!==null&&Zu(n.dependencies))?(ae||typeof m.UNSAFE_componentWillUpdate!="function"&&typeof m.componentWillUpdate!="function"||(typeof m.componentWillUpdate=="function"&&m.componentWillUpdate(c,de,B),typeof m.UNSAFE_componentWillUpdate=="function"&&m.UNSAFE_componentWillUpdate(c,de,B)),typeof m.componentDidUpdate=="function"&&(r.flags|=4),typeof m.getSnapshotBeforeUpdate=="function"&&(r.flags|=1024)):(typeof m.componentDidUpdate!="function"||v===n.memoizedProps&&oe===n.memoizedState||(r.flags|=4),typeof m.getSnapshotBeforeUpdate!="function"||v===n.memoizedProps&&oe===n.memoizedState||(r.flags|=1024),r.memoizedProps=c,r.memoizedState=de),m.props=c,m.state=de,m.context=B,c=we):(typeof m.componentDidUpdate!="function"||v===n.memoizedProps&&oe===n.memoizedState||(r.flags|=4),typeof m.getSnapshotBeforeUpdate!="function"||v===n.memoizedProps&&oe===n.memoizedState||(r.flags|=1024),c=!1)}return m=c,bh(n,r),c=(r.flags&128)!==0,m||c?(m=r.stateNode,o=c&&typeof o.getDerivedStateFromError!="function"?null:m.render(),r.flags|=1,n!==null&&c?(r.child=ko(r,n.child,null,f),r.child=ko(r,null,o,f)):$s(n,r,o,f),r.memoizedState=m.state,n=r.child):n=$a(n,r,f),n}function Iv(n,r,o,c){return yo(),r.flags|=256,$s(n,r,o,c),r.child}var ym={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function bm(n){return{baseLanes:n,cachePool:wb()}}function vm(n,r,o){return n=n!==null?n.childLanes&~o:0,r&&(n|=Ar),n}function Mv(n,r,o){var c=r.pendingProps,f=!1,m=(r.flags&128)!==0,v;if((v=m)||(v=n!==null&&n.memoizedState===null?!1:(ws.current&2)!==0),v&&(f=!0,r.flags&=-129),v=(r.flags&32)!==0,r.flags&=-33,n===null){if(kn){if(f?_i(r):ki(),(n=ns)?(n=z0(n,Fr),n=n!==null&&n.data!=="&"?n:null,n!==null&&(r.memoizedState={dehydrated:n,treeContext:pi!==null?{id:ga,overflow:ya}:null,retryLane:536870912,hydrationErrors:null},o=db(n),o.return=r,r.child=o,qs=r,ns=null)):n=null,n===null)throw yi(r);return tp(n)?r.lanes=32:r.lanes=536870912,null}var E=c.children;return c=c.fallback,f?(ki(),f=r.mode,E=vh({mode:"hidden",children:E},f),c=go(c,f,o,null),E.return=r,c.return=r,E.sibling=c,r.child=E,c=r.child,c.memoizedState=bm(o),c.childLanes=vm(n,v,o),r.memoizedState=ym,bc(null,c)):(_i(r),xm(r,E))}var B=n.memoizedState;if(B!==null&&(E=B.dehydrated,E!==null)){if(m)r.flags&256?(_i(r),r.flags&=-257,r=wm(n,r,o)):r.memoizedState!==null?(ki(),r.child=n.child,r.flags|=128,r=null):(ki(),E=c.fallback,f=r.mode,c=vh({mode:"visible",children:c.children},f),E=go(E,f,o,null),E.flags|=2,c.return=r,E.return=r,c.sibling=E,r.child=c,ko(r,n.child,null,o),c=r.child,c.memoizedState=bm(o),c.childLanes=vm(n,v,o),r.memoizedState=ym,r=bc(null,c));else if(_i(r),tp(E)){if(v=E.nextSibling&&E.nextSibling.dataset,v)var ae=v.dgst;v=ae,c=Error(i(419)),c.stack="",c.digest=v,ic({value:c,source:null,stack:null}),r=wm(n,r,o)}else if(Ns||rl(n,r,o,!1),v=(o&n.childLanes)!==0,Ns||v){if(v=Yn,v!==null&&(c=as(v,o),c!==0&&c!==B.retryLane))throw B.retryLane=c,po(n,c),br(v,n,c),pm;ep(E)||Nh(),r=wm(n,r,o)}else ep(E)?(r.flags|=192,r.child=n.child,r=null):(n=B.treeContext,ns=Hr(E.nextSibling),qs=r,kn=!0,gi=null,Fr=!1,n!==null&&pb(r,n),r=xm(r,c.children),r.flags|=4096);return r}return f?(ki(),E=c.fallback,f=r.mode,B=n.child,ae=B.sibling,c=Ba(B,{mode:"hidden",children:c.children}),c.subtreeFlags=B.subtreeFlags&65011712,ae!==null?E=Ba(ae,E):(E=go(E,f,o,null),E.flags|=2),E.return=r,c.return=r,c.sibling=E,r.child=c,bc(null,c),c=r.child,E=n.child.memoizedState,E===null?E=bm(o):(f=E.cachePool,f!==null?(B=Es._currentValue,f=f.parent!==B?{parent:B,pool:B}:f):f=wb(),E={baseLanes:E.baseLanes|o,cachePool:f}),c.memoizedState=E,c.childLanes=vm(n,v,o),r.memoizedState=ym,bc(n.child,c)):(_i(r),o=n.child,n=o.sibling,o=Ba(o,{mode:"visible",children:c.children}),o.return=r,o.sibling=null,n!==null&&(v=r.deletions,v===null?(r.deletions=[n],r.flags|=16):v.push(n)),r.child=o,r.memoizedState=null,o)}function xm(n,r){return r=vh({mode:"visible",children:r},n.mode),r.return=n,n.child=r}function vh(n,r){return n=Sr(22,n,null,r),n.lanes=0,n}function wm(n,r,o){return ko(r,n.child,null,o),n=xm(r,r.pendingProps.children),n.flags|=2,r.memoizedState=null,n}function Dv(n,r,o){n.lanes|=r;var c=n.alternate;c!==null&&(c.lanes|=r),Lf(n.return,r,o)}function _m(n,r,o,c,f,m){var v=n.memoizedState;v===null?n.memoizedState={isBackwards:r,rendering:null,renderingStartTime:0,last:c,tail:o,tailMode:f,treeForkCount:m}:(v.isBackwards=r,v.rendering=null,v.renderingStartTime=0,v.last=c,v.tail=o,v.tailMode=f,v.treeForkCount=m)}function Pv(n,r,o){var c=r.pendingProps,f=c.revealOrder,m=c.tail;c=c.children;var v=ws.current,E=(v&2)!==0;if(E?(v=v&1|2,r.flags|=128):v&=1,be(ws,v),$s(n,r,c,o),c=kn?ac:0,!E&&n!==null&&(n.flags&128)!==0)e:for(n=r.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&Dv(n,o,r);else if(n.tag===19)Dv(n,o,r);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===r)break e;for(;n.sibling===null;){if(n.return===null||n.return===r)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}switch(f){case"forwards":for(o=r.child,f=null;o!==null;)n=o.alternate,n!==null&&oh(n)===null&&(f=o),o=o.sibling;o=f,o===null?(f=r.child,r.child=null):(f=o.sibling,o.sibling=null),_m(r,!1,f,o,m,c);break;case"backwards":case"unstable_legacy-backwards":for(o=null,f=r.child,r.child=null;f!==null;){if(n=f.alternate,n!==null&&oh(n)===null){r.child=f;break}n=f.sibling,f.sibling=o,o=f,f=n}_m(r,!0,o,null,m,c);break;case"together":_m(r,!1,null,null,void 0,c);break;default:r.memoizedState=null}return r.child}function $a(n,r,o){if(n!==null&&(r.dependencies=n.dependencies),Ei|=r.lanes,(o&r.childLanes)===0)if(n!==null){if(rl(n,r,o,!1),(o&r.childLanes)===0)return null}else return null;if(n!==null&&r.child!==n.child)throw Error(i(153));if(r.child!==null){for(n=r.child,o=Ba(n,n.pendingProps),r.child=o,o.return=r;n.sibling!==null;)n=n.sibling,o=o.sibling=Ba(n,n.pendingProps),o.return=r;o.sibling=null}return r.child}function km(n,r){return(n.lanes&r)!==0?!0:(n=n.dependencies,!!(n!==null&&Zu(n)))}function nT(n,r,o){switch(r.tag){case 3:pt(r,r.stateNode.containerInfo),bi(r,Es,n.memoizedState.cache),yo();break;case 27:case 5:Ht(r);break;case 4:pt(r,r.stateNode.containerInfo);break;case 10:bi(r,r.type,r.memoizedProps.value);break;case 31:if(r.memoizedState!==null)return r.flags|=128,Kf(r),null;break;case 13:var c=r.memoizedState;if(c!==null)return c.dehydrated!==null?(_i(r),r.flags|=128,null):(o&r.child.childLanes)!==0?Mv(n,r,o):(_i(r),n=$a(n,r,o),n!==null?n.sibling:null);_i(r);break;case 19:var f=(n.flags&128)!==0;if(c=(o&r.childLanes)!==0,c||(rl(n,r,o,!1),c=(o&r.childLanes)!==0),f){if(c)return Pv(n,r,o);r.flags|=128}if(f=r.memoizedState,f!==null&&(f.rendering=null,f.tail=null,f.lastEffect=null),be(ws,ws.current),c)break;return null;case 22:return r.lanes=0,Sv(n,r,o,r.pendingProps);case 24:bi(r,Es,n.memoizedState.cache)}return $a(n,r,o)}function Lv(n,r,o){if(n!==null)if(n.memoizedProps!==r.pendingProps)Ns=!0;else{if(!km(n,o)&&(r.flags&128)===0)return Ns=!1,nT(n,r,o);Ns=(n.flags&131072)!==0}else Ns=!1,kn&&(r.flags&1048576)!==0&&mb(r,ac,r.index);switch(r.lanes=0,r.tag){case 16:e:{var c=r.pendingProps;if(n=wo(r.elementType),r.type=n,typeof n=="function")Nf(n)?(c=jo(n,c),r.tag=1,r=Av(null,r,n,c,o)):(r.tag=0,r=gm(null,r,n,c,o));else{if(n!=null){var f=n.$$typeof;if(f===je){r.tag=11,r=Tv(null,r,n,c,o);break e}else if(f===R){r.tag=14,r=jv(null,r,n,c,o);break e}}throw r=He(n)||n,Error(i(306,r,""))}}return r;case 0:return gm(n,r,r.type,r.pendingProps,o);case 1:return c=r.type,f=jo(c,r.pendingProps),Av(n,r,c,f,o);case 3:e:{if(pt(r,r.stateNode.containerInfo),n===null)throw Error(i(387));c=r.pendingProps;var m=r.memoizedState;f=m.element,qf(n,r),fc(r,c,null,o);var v=r.memoizedState;if(c=v.cache,bi(r,Es,c),c!==m.cache&&Of(r,[Es],o,!0),dc(),c=v.element,m.isDehydrated)if(m={element:c,isDehydrated:!1,cache:v.cache},r.updateQueue.baseState=m,r.memoizedState=m,r.flags&256){r=Iv(n,r,c,o);break e}else if(c!==f){f=Br(Error(i(424)),r),ic(f),r=Iv(n,r,c,o);break e}else for(n=r.stateNode.containerInfo,n.nodeType===9?n=n.body:n=n.nodeName==="HTML"?n.ownerDocument.body:n,ns=Hr(n.firstChild),qs=r,kn=!0,gi=null,Fr=!0,o=Sb(r,null,c,o),r.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling;else{if(yo(),c===f){r=$a(n,r,o);break e}$s(n,r,c,o)}r=r.child}return r;case 26:return bh(n,r),n===null?(o=G0(r.type,null,r.pendingProps,null))?r.memoizedState=o:kn||(o=r.type,n=r.pendingProps,c=Ph(Ae.current).createElement(o),c[at]=r,c[At]=n,Ws(c,o,n),C(c),r.stateNode=c):r.memoizedState=G0(r.type,n.memoizedProps,r.pendingProps,n.memoizedState),null;case 27:return Ht(r),n===null&&kn&&(c=r.stateNode=H0(r.type,r.pendingProps,Ae.current),qs=r,Fr=!0,f=ns,Ai(r.type)?(np=f,ns=Hr(c.firstChild)):ns=f),$s(n,r,r.pendingProps.children,o),bh(n,r),n===null&&(r.flags|=4194304),r.child;case 5:return n===null&&kn&&((f=c=ns)&&(c=IT(c,r.type,r.pendingProps,Fr),c!==null?(r.stateNode=c,qs=r,ns=Hr(c.firstChild),Fr=!1,f=!0):f=!1),f||yi(r)),Ht(r),f=r.type,m=r.pendingProps,v=n!==null?n.memoizedProps:null,c=m.children,Xm(f,m)?c=null:v!==null&&Xm(f,v)&&(r.flags|=32),r.memoizedState!==null&&(f=Qf(n,r,Gk,null,null,o),Mc._currentValue=f),bh(n,r),$s(n,r,c,o),r.child;case 6:return n===null&&kn&&((n=o=ns)&&(o=MT(o,r.pendingProps,Fr),o!==null?(r.stateNode=o,qs=r,ns=null,n=!0):n=!1),n||yi(r)),null;case 13:return Mv(n,r,o);case 4:return pt(r,r.stateNode.containerInfo),c=r.pendingProps,n===null?r.child=ko(r,null,c,o):$s(n,r,c,o),r.child;case 11:return Tv(n,r,r.type,r.pendingProps,o);case 7:return $s(n,r,r.pendingProps,o),r.child;case 8:return $s(n,r,r.pendingProps.children,o),r.child;case 12:return $s(n,r,r.pendingProps.children,o),r.child;case 10:return c=r.pendingProps,bi(r,r.type,c.value),$s(n,r,c.children,o),r.child;case 9:return f=r.type._context,c=r.pendingProps.children,vo(r),f=Hs(f),c=c(f),r.flags|=1,$s(n,r,c,o),r.child;case 14:return jv(n,r,r.type,r.pendingProps,o);case 15:return Ev(n,r,r.type,r.pendingProps,o);case 19:return Pv(n,r,o);case 31:return tT(n,r,o);case 22:return Sv(n,r,o,r.pendingProps);case 24:return vo(r),c=Hs(Es),n===null?(f=Uf(),f===null&&(f=Yn,m=Vf(),f.pooledCache=m,m.refCount++,m!==null&&(f.pooledCacheLanes|=o),f=m),r.memoizedState={parent:c,cache:f},Ff(r),bi(r,Es,f)):((n.lanes&o)!==0&&(qf(n,r),fc(r,null,null,o),dc()),f=n.memoizedState,m=r.memoizedState,f.parent!==c?(f={parent:c,cache:c},r.memoizedState=f,r.lanes===0&&(r.memoizedState=r.updateQueue.baseState=f),bi(r,Es,c)):(c=m.cache,bi(r,Es,c),c!==f.cache&&Of(r,[Es],o,!0))),$s(n,r,r.pendingProps.children,o),r.child;case 29:throw r.pendingProps}throw Error(i(156,r.tag))}function Wa(n){n.flags|=4}function Tm(n,r,o,c,f){if((r=(n.mode&32)!==0)&&(r=!1),r){if(n.flags|=16777216,(f&335544128)===f)if(n.stateNode.complete)n.flags|=8192;else if(c0())n.flags|=8192;else throw _o=sh,zf}else n.flags&=-16777217}function Ov(n,r){if(r.type!=="stylesheet"||(r.state.loading&4)!==0)n.flags&=-16777217;else if(n.flags|=16777216,!J0(r))if(c0())n.flags|=8192;else throw _o=sh,zf}function xh(n,r){r!==null&&(n.flags|=4),n.flags&16384&&(r=n.tag!==22?Vn():536870912,n.lanes|=r,gl|=r)}function vc(n,r){if(!kn)switch(n.tailMode){case"hidden":r=n.tail;for(var o=null;r!==null;)r.alternate!==null&&(o=r),r=r.sibling;o===null?n.tail=null:o.sibling=null;break;case"collapsed":o=n.tail;for(var c=null;o!==null;)o.alternate!==null&&(c=o),o=o.sibling;c===null?r||n.tail===null?n.tail=null:n.tail.sibling=null:c.sibling=null}}function ss(n){var r=n.alternate!==null&&n.alternate.child===n.child,o=0,c=0;if(r)for(var f=n.child;f!==null;)o|=f.lanes|f.childLanes,c|=f.subtreeFlags&65011712,c|=f.flags&65011712,f.return=n,f=f.sibling;else for(f=n.child;f!==null;)o|=f.lanes|f.childLanes,c|=f.subtreeFlags,c|=f.flags,f.return=n,f=f.sibling;return n.subtreeFlags|=c,n.childLanes=o,r}function sT(n,r,o){var c=r.pendingProps;switch(If(r),r.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ss(r),null;case 1:return ss(r),null;case 3:return o=r.stateNode,c=null,n!==null&&(c=n.memoizedState.cache),r.memoizedState.cache!==c&&(r.flags|=2048),Fa(Es),Ze(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(n===null||n.child===null)&&(sl(r)?Wa(r):n===null||n.memoizedState.isDehydrated&&(r.flags&256)===0||(r.flags|=1024,Df())),ss(r),null;case 26:var f=r.type,m=r.memoizedState;return n===null?(Wa(r),m!==null?(ss(r),Ov(r,m)):(ss(r),Tm(r,f,null,c,o))):m?m!==n.memoizedState?(Wa(r),ss(r),Ov(r,m)):(ss(r),r.flags&=-16777217):(n=n.memoizedProps,n!==c&&Wa(r),ss(r),Tm(r,f,n,c,o)),null;case 27:if(cn(r),o=Ae.current,f=r.type,n!==null&&r.stateNode!=null)n.memoizedProps!==c&&Wa(r);else{if(!c){if(r.stateNode===null)throw Error(i(166));return ss(r),null}n=Ne.current,sl(r)?gb(r):(n=H0(f,c,o),r.stateNode=n,Wa(r))}return ss(r),null;case 5:if(cn(r),f=r.type,n!==null&&r.stateNode!=null)n.memoizedProps!==c&&Wa(r);else{if(!c){if(r.stateNode===null)throw Error(i(166));return ss(r),null}if(m=Ne.current,sl(r))gb(r);else{var v=Ph(Ae.current);switch(m){case 1:m=v.createElementNS("http://www.w3.org/2000/svg",f);break;case 2:m=v.createElementNS("http://www.w3.org/1998/Math/MathML",f);break;default:switch(f){case"svg":m=v.createElementNS("http://www.w3.org/2000/svg",f);break;case"math":m=v.createElementNS("http://www.w3.org/1998/Math/MathML",f);break;case"script":m=v.createElement("div"),m.innerHTML="<script><\/script>",m=m.removeChild(m.firstChild);break;case"select":m=typeof c.is=="string"?v.createElement("select",{is:c.is}):v.createElement("select"),c.multiple?m.multiple=!0:c.size&&(m.size=c.size);break;default:m=typeof c.is=="string"?v.createElement(f,{is:c.is}):v.createElement(f)}}m[at]=r,m[At]=c;e:for(v=r.child;v!==null;){if(v.tag===5||v.tag===6)m.appendChild(v.stateNode);else if(v.tag!==4&&v.tag!==27&&v.child!==null){v.child.return=v,v=v.child;continue}if(v===r)break e;for(;v.sibling===null;){if(v.return===null||v.return===r)break e;v=v.return}v.sibling.return=v.return,v=v.sibling}r.stateNode=m;e:switch(Ws(m,f,c),f){case"button":case"input":case"select":case"textarea":c=!!c.autoFocus;break e;case"img":c=!0;break e;default:c=!1}c&&Wa(r)}}return ss(r),Tm(r,r.type,n===null?null:n.memoizedProps,r.pendingProps,o),null;case 6:if(n&&r.stateNode!=null)n.memoizedProps!==c&&Wa(r);else{if(typeof c!="string"&&r.stateNode===null)throw Error(i(166));if(n=Ae.current,sl(r)){if(n=r.stateNode,o=r.memoizedProps,c=null,f=qs,f!==null)switch(f.tag){case 27:case 5:c=f.memoizedProps}n[at]=r,n=!!(n.nodeValue===o||c!==null&&c.suppressHydrationWarning===!0||M0(n.nodeValue,o)),n||yi(r,!0)}else n=Ph(n).createTextNode(c),n[at]=r,r.stateNode=n}return ss(r),null;case 31:if(o=r.memoizedState,n===null||n.memoizedState!==null){if(c=sl(r),o!==null){if(n===null){if(!c)throw Error(i(318));if(n=r.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(i(557));n[at]=r}else yo(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;ss(r),n=!1}else o=Df(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=o),n=!0;if(!n)return r.flags&256?(Cr(r),r):(Cr(r),null);if((r.flags&128)!==0)throw Error(i(558))}return ss(r),null;case 13:if(c=r.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(f=sl(r),c!==null&&c.dehydrated!==null){if(n===null){if(!f)throw Error(i(318));if(f=r.memoizedState,f=f!==null?f.dehydrated:null,!f)throw Error(i(317));f[at]=r}else yo(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;ss(r),f=!1}else f=Df(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=f),f=!0;if(!f)return r.flags&256?(Cr(r),r):(Cr(r),null)}return Cr(r),(r.flags&128)!==0?(r.lanes=o,r):(o=c!==null,n=n!==null&&n.memoizedState!==null,o&&(c=r.child,f=null,c.alternate!==null&&c.alternate.memoizedState!==null&&c.alternate.memoizedState.cachePool!==null&&(f=c.alternate.memoizedState.cachePool.pool),m=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(m=c.memoizedState.cachePool.pool),m!==f&&(c.flags|=2048)),o!==n&&o&&(r.child.flags|=8192),xh(r,r.updateQueue),ss(r),null);case 4:return Ze(),n===null&&Wm(r.stateNode.containerInfo),ss(r),null;case 10:return Fa(r.type),ss(r),null;case 19:if(W(ws),c=r.memoizedState,c===null)return ss(r),null;if(f=(r.flags&128)!==0,m=c.rendering,m===null)if(f)vc(c,!1);else{if(ps!==0||n!==null&&(n.flags&128)!==0)for(n=r.child;n!==null;){if(m=oh(n),m!==null){for(r.flags|=128,vc(c,!1),n=m.updateQueue,r.updateQueue=n,xh(r,n),r.subtreeFlags=0,n=o,o=r.child;o!==null;)hb(o,n),o=o.sibling;return be(ws,ws.current&1|2),kn&&Ua(r,c.treeForkCount),r.child}n=n.sibling}c.tail!==null&&Et()>jh&&(r.flags|=128,f=!0,vc(c,!1),r.lanes=4194304)}else{if(!f)if(n=oh(m),n!==null){if(r.flags|=128,f=!0,n=n.updateQueue,r.updateQueue=n,xh(r,n),vc(c,!0),c.tail===null&&c.tailMode==="hidden"&&!m.alternate&&!kn)return ss(r),null}else 2*Et()-c.renderingStartTime>jh&&o!==536870912&&(r.flags|=128,f=!0,vc(c,!1),r.lanes=4194304);c.isBackwards?(m.sibling=r.child,r.child=m):(n=c.last,n!==null?n.sibling=m:r.child=m,c.last=m)}return c.tail!==null?(n=c.tail,c.rendering=n,c.tail=n.sibling,c.renderingStartTime=Et(),n.sibling=null,o=ws.current,be(ws,f?o&1|2:o&1),kn&&Ua(r,c.treeForkCount),n):(ss(r),null);case 22:case 23:return Cr(r),Gf(),c=r.memoizedState!==null,n!==null?n.memoizedState!==null!==c&&(r.flags|=8192):c&&(r.flags|=8192),c?(o&536870912)!==0&&(r.flags&128)===0&&(ss(r),r.subtreeFlags&6&&(r.flags|=8192)):ss(r),o=r.updateQueue,o!==null&&xh(r,o.retryQueue),o=null,n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(o=n.memoizedState.cachePool.pool),c=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(c=r.memoizedState.cachePool.pool),c!==o&&(r.flags|=2048),n!==null&&W(xo),null;case 24:return o=null,n!==null&&(o=n.memoizedState.cache),r.memoizedState.cache!==o&&(r.flags|=2048),Fa(Es),ss(r),null;case 25:return null;case 30:return null}throw Error(i(156,r.tag))}function rT(n,r){switch(If(r),r.tag){case 1:return n=r.flags,n&65536?(r.flags=n&-65537|128,r):null;case 3:return Fa(Es),Ze(),n=r.flags,(n&65536)!==0&&(n&128)===0?(r.flags=n&-65537|128,r):null;case 26:case 27:case 5:return cn(r),null;case 31:if(r.memoizedState!==null){if(Cr(r),r.alternate===null)throw Error(i(340));yo()}return n=r.flags,n&65536?(r.flags=n&-65537|128,r):null;case 13:if(Cr(r),n=r.memoizedState,n!==null&&n.dehydrated!==null){if(r.alternate===null)throw Error(i(340));yo()}return n=r.flags,n&65536?(r.flags=n&-65537|128,r):null;case 19:return W(ws),null;case 4:return Ze(),null;case 10:return Fa(r.type),null;case 22:case 23:return Cr(r),Gf(),n!==null&&W(xo),n=r.flags,n&65536?(r.flags=n&-65537|128,r):null;case 24:return Fa(Es),null;case 25:return null;default:return null}}function Vv(n,r){switch(If(r),r.tag){case 3:Fa(Es),Ze();break;case 26:case 27:case 5:cn(r);break;case 4:Ze();break;case 31:r.memoizedState!==null&&Cr(r);break;case 13:Cr(r);break;case 19:W(ws);break;case 10:Fa(r.type);break;case 22:case 23:Cr(r),Gf(),n!==null&&W(xo);break;case 24:Fa(Es)}}function xc(n,r){try{var o=r.updateQueue,c=o!==null?o.lastEffect:null;if(c!==null){var f=c.next;o=f;do{if((o.tag&n)===n){c=void 0;var m=o.create,v=o.inst;c=m(),v.destroy=c}o=o.next}while(o!==f)}}catch(E){Fn(r,r.return,E)}}function Ti(n,r,o){try{var c=r.updateQueue,f=c!==null?c.lastEffect:null;if(f!==null){var m=f.next;c=m;do{if((c.tag&n)===n){var v=c.inst,E=v.destroy;if(E!==void 0){v.destroy=void 0,f=r;var B=o,ae=E;try{ae()}catch(we){Fn(f,B,we)}}}c=c.next}while(c!==m)}}catch(we){Fn(r,r.return,we)}}function Bv(n){var r=n.updateQueue;if(r!==null){var o=n.stateNode;try{Cb(r,o)}catch(c){Fn(n,n.return,c)}}}function Uv(n,r,o){o.props=jo(n.type,n.memoizedProps),o.state=n.memoizedState;try{o.componentWillUnmount()}catch(c){Fn(n,r,c)}}function wc(n,r){try{var o=n.ref;if(o!==null){switch(n.tag){case 26:case 27:case 5:var c=n.stateNode;break;case 30:c=n.stateNode;break;default:c=n.stateNode}typeof o=="function"?n.refCleanup=o(c):o.current=c}}catch(f){Fn(n,r,f)}}function ba(n,r){var o=n.ref,c=n.refCleanup;if(o!==null)if(typeof c=="function")try{c()}catch(f){Fn(n,r,f)}finally{n.refCleanup=null,n=n.alternate,n!=null&&(n.refCleanup=null)}else if(typeof o=="function")try{o(null)}catch(f){Fn(n,r,f)}else o.current=null}function zv(n){var r=n.type,o=n.memoizedProps,c=n.stateNode;try{e:switch(r){case"button":case"input":case"select":case"textarea":o.autoFocus&&c.focus();break e;case"img":o.src?c.src=o.src:o.srcSet&&(c.srcset=o.srcSet)}}catch(f){Fn(n,n.return,f)}}function jm(n,r,o){try{var c=n.stateNode;ET(c,n.type,o,r),c[At]=r}catch(f){Fn(n,n.return,f)}}function Fv(n){return n.tag===5||n.tag===3||n.tag===26||n.tag===27&&Ai(n.type)||n.tag===4}function Em(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||Fv(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.tag===27&&Ai(n.type)||n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function Sm(n,r,o){var c=n.tag;if(c===5||c===6)n=n.stateNode,r?(o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o).insertBefore(n,r):(r=o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o,r.appendChild(n),o=o._reactRootContainer,o!=null||r.onclick!==null||(r.onclick=A));else if(c!==4&&(c===27&&Ai(n.type)&&(o=n.stateNode,r=null),n=n.child,n!==null))for(Sm(n,r,o),n=n.sibling;n!==null;)Sm(n,r,o),n=n.sibling}function wh(n,r,o){var c=n.tag;if(c===5||c===6)n=n.stateNode,r?o.insertBefore(n,r):o.appendChild(n);else if(c!==4&&(c===27&&Ai(n.type)&&(o=n.stateNode),n=n.child,n!==null))for(wh(n,r,o),n=n.sibling;n!==null;)wh(n,r,o),n=n.sibling}function qv(n){var r=n.stateNode,o=n.memoizedProps;try{for(var c=n.type,f=r.attributes;f.length;)r.removeAttributeNode(f[0]);Ws(r,c,o),r[at]=n,r[At]=o}catch(m){Fn(n,n.return,m)}}var Ga=!1,Cs=!1,Nm=!1,Hv=typeof WeakSet=="function"?WeakSet:Set,Us=null;function aT(n,r){if(n=n.containerInfo,Ym=Fh,n=nb(n),wf(n)){if("selectionStart"in n)var o={start:n.selectionStart,end:n.selectionEnd};else e:{o=(o=n.ownerDocument)&&o.defaultView||window;var c=o.getSelection&&o.getSelection();if(c&&c.rangeCount!==0){o=c.anchorNode;var f=c.anchorOffset,m=c.focusNode;c=c.focusOffset;try{o.nodeType,m.nodeType}catch{o=null;break e}var v=0,E=-1,B=-1,ae=0,we=0,Re=n,oe=null;t:for(;;){for(var de;Re!==o||f!==0&&Re.nodeType!==3||(E=v+f),Re!==m||c!==0&&Re.nodeType!==3||(B=v+c),Re.nodeType===3&&(v+=Re.nodeValue.length),(de=Re.firstChild)!==null;)oe=Re,Re=de;for(;;){if(Re===n)break t;if(oe===o&&++ae===f&&(E=v),oe===m&&++we===c&&(B=v),(de=Re.nextSibling)!==null)break;Re=oe,oe=Re.parentNode}Re=de}o=E===-1||B===-1?null:{start:E,end:B}}else o=null}o=o||{start:0,end:0}}else o=null;for(Qm={focusedElem:n,selectionRange:o},Fh=!1,Us=r;Us!==null;)if(r=Us,n=r.child,(r.subtreeFlags&1028)!==0&&n!==null)n.return=r,Us=n;else for(;Us!==null;){switch(r=Us,m=r.alternate,n=r.flags,r.tag){case 0:if((n&4)!==0&&(n=r.updateQueue,n=n!==null?n.events:null,n!==null))for(o=0;o<n.length;o++)f=n[o],f.ref.impl=f.nextImpl;break;case 11:case 15:break;case 1:if((n&1024)!==0&&m!==null){n=void 0,o=r,f=m.memoizedProps,m=m.memoizedState,c=o.stateNode;try{var ut=jo(o.type,f);n=c.getSnapshotBeforeUpdate(ut,m),c.__reactInternalSnapshotBeforeUpdate=n}catch(Mt){Fn(o,o.return,Mt)}}break;case 3:if((n&1024)!==0){if(n=r.stateNode.containerInfo,o=n.nodeType,o===9)Zm(n);else if(o===1)switch(n.nodeName){case"HEAD":case"HTML":case"BODY":Zm(n);break;default:n.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((n&1024)!==0)throw Error(i(163))}if(n=r.sibling,n!==null){n.return=r.return,Us=n;break}Us=r.return}}function $v(n,r,o){var c=o.flags;switch(o.tag){case 0:case 11:case 15:Ya(n,o),c&4&&xc(5,o);break;case 1:if(Ya(n,o),c&4)if(n=o.stateNode,r===null)try{n.componentDidMount()}catch(v){Fn(o,o.return,v)}else{var f=jo(o.type,r.memoizedProps);r=r.memoizedState;try{n.componentDidUpdate(f,r,n.__reactInternalSnapshotBeforeUpdate)}catch(v){Fn(o,o.return,v)}}c&64&&Bv(o),c&512&&wc(o,o.return);break;case 3:if(Ya(n,o),c&64&&(n=o.updateQueue,n!==null)){if(r=null,o.child!==null)switch(o.child.tag){case 27:case 5:r=o.child.stateNode;break;case 1:r=o.child.stateNode}try{Cb(n,r)}catch(v){Fn(o,o.return,v)}}break;case 27:r===null&&c&4&&qv(o);case 26:case 5:Ya(n,o),r===null&&c&4&&zv(o),c&512&&wc(o,o.return);break;case 12:Ya(n,o);break;case 31:Ya(n,o),c&4&&Kv(n,o);break;case 13:Ya(n,o),c&4&&Yv(n,o),c&64&&(n=o.memoizedState,n!==null&&(n=n.dehydrated,n!==null&&(o=mT.bind(null,o),DT(n,o))));break;case 22:if(c=o.memoizedState!==null||Ga,!c){r=r!==null&&r.memoizedState!==null||Cs,f=Ga;var m=Cs;Ga=c,(Cs=r)&&!m?Qa(n,o,(o.subtreeFlags&8772)!==0):Ya(n,o),Ga=f,Cs=m}break;case 30:break;default:Ya(n,o)}}function Wv(n){var r=n.alternate;r!==null&&(n.alternate=null,Wv(r)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(r=n.stateNode,r!==null&&Os(r)),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}var os=null,mr=!1;function Ka(n,r,o){for(o=o.child;o!==null;)Gv(n,r,o),o=o.sibling}function Gv(n,r,o){if(Ue&&typeof Ue.onCommitFiberUnmount=="function")try{Ue.onCommitFiberUnmount(Qe,o)}catch{}switch(o.tag){case 26:Cs||ba(o,r),Ka(n,r,o),o.memoizedState?o.memoizedState.count--:o.stateNode&&(o=o.stateNode,o.parentNode.removeChild(o));break;case 27:Cs||ba(o,r);var c=os,f=mr;Ai(o.type)&&(os=o.stateNode,mr=!1),Ka(n,r,o),Rc(o.stateNode),os=c,mr=f;break;case 5:Cs||ba(o,r);case 6:if(c=os,f=mr,os=null,Ka(n,r,o),os=c,mr=f,os!==null)if(mr)try{(os.nodeType===9?os.body:os.nodeName==="HTML"?os.ownerDocument.body:os).removeChild(o.stateNode)}catch(m){Fn(o,r,m)}else try{os.removeChild(o.stateNode)}catch(m){Fn(o,r,m)}break;case 18:os!==null&&(mr?(n=os,B0(n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n,o.stateNode),Tl(n)):B0(os,o.stateNode));break;case 4:c=os,f=mr,os=o.stateNode.containerInfo,mr=!0,Ka(n,r,o),os=c,mr=f;break;case 0:case 11:case 14:case 15:Ti(2,o,r),Cs||Ti(4,o,r),Ka(n,r,o);break;case 1:Cs||(ba(o,r),c=o.stateNode,typeof c.componentWillUnmount=="function"&&Uv(o,r,c)),Ka(n,r,o);break;case 21:Ka(n,r,o);break;case 22:Cs=(c=Cs)||o.memoizedState!==null,Ka(n,r,o),Cs=c;break;default:Ka(n,r,o)}}function Kv(n,r){if(r.memoizedState===null&&(n=r.alternate,n!==null&&(n=n.memoizedState,n!==null))){n=n.dehydrated;try{Tl(n)}catch(o){Fn(r,r.return,o)}}}function Yv(n,r){if(r.memoizedState===null&&(n=r.alternate,n!==null&&(n=n.memoizedState,n!==null&&(n=n.dehydrated,n!==null))))try{Tl(n)}catch(o){Fn(r,r.return,o)}}function iT(n){switch(n.tag){case 31:case 13:case 19:var r=n.stateNode;return r===null&&(r=n.stateNode=new Hv),r;case 22:return n=n.stateNode,r=n._retryCache,r===null&&(r=n._retryCache=new Hv),r;default:throw Error(i(435,n.tag))}}function _h(n,r){var o=iT(n);r.forEach(function(c){if(!o.has(c)){o.add(c);var f=pT.bind(null,n,c);c.then(f,f)}})}function pr(n,r){var o=r.deletions;if(o!==null)for(var c=0;c<o.length;c++){var f=o[c],m=n,v=r,E=v;e:for(;E!==null;){switch(E.tag){case 27:if(Ai(E.type)){os=E.stateNode,mr=!1;break e}break;case 5:os=E.stateNode,mr=!1;break e;case 3:case 4:os=E.stateNode.containerInfo,mr=!0;break e}E=E.return}if(os===null)throw Error(i(160));Gv(m,v,f),os=null,mr=!1,m=f.alternate,m!==null&&(m.return=null),f.return=null}if(r.subtreeFlags&13886)for(r=r.child;r!==null;)Qv(r,n),r=r.sibling}var na=null;function Qv(n,r){var o=n.alternate,c=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:pr(r,n),gr(n),c&4&&(Ti(3,n,n.return),xc(3,n),Ti(5,n,n.return));break;case 1:pr(r,n),gr(n),c&512&&(Cs||o===null||ba(o,o.return)),c&64&&Ga&&(n=n.updateQueue,n!==null&&(c=n.callbacks,c!==null&&(o=n.shared.hiddenCallbacks,n.shared.hiddenCallbacks=o===null?c:o.concat(c))));break;case 26:var f=na;if(pr(r,n),gr(n),c&512&&(Cs||o===null||ba(o,o.return)),c&4){var m=o!==null?o.memoizedState:null;if(c=n.memoizedState,o===null)if(c===null)if(n.stateNode===null){e:{c=n.type,o=n.memoizedProps,f=f.ownerDocument||f;t:switch(c){case"title":m=f.getElementsByTagName("title")[0],(!m||m[Ts]||m[at]||m.namespaceURI==="http://www.w3.org/2000/svg"||m.hasAttribute("itemprop"))&&(m=f.createElement(c),f.head.insertBefore(m,f.querySelector("head > title"))),Ws(m,c,o),m[at]=n,C(m),c=m;break e;case"link":var v=Q0("link","href",f).get(c+(o.href||""));if(v){for(var E=0;E<v.length;E++)if(m=v[E],m.getAttribute("href")===(o.href==null||o.href===""?null:o.href)&&m.getAttribute("rel")===(o.rel==null?null:o.rel)&&m.getAttribute("title")===(o.title==null?null:o.title)&&m.getAttribute("crossorigin")===(o.crossOrigin==null?null:o.crossOrigin)){v.splice(E,1);break t}}m=f.createElement(c),Ws(m,c,o),f.head.appendChild(m);break;case"meta":if(v=Q0("meta","content",f).get(c+(o.content||""))){for(E=0;E<v.length;E++)if(m=v[E],m.getAttribute("content")===(o.content==null?null:""+o.content)&&m.getAttribute("name")===(o.name==null?null:o.name)&&m.getAttribute("property")===(o.property==null?null:o.property)&&m.getAttribute("http-equiv")===(o.httpEquiv==null?null:o.httpEquiv)&&m.getAttribute("charset")===(o.charSet==null?null:o.charSet)){v.splice(E,1);break t}}m=f.createElement(c),Ws(m,c,o),f.head.appendChild(m);break;default:throw Error(i(468,c))}m[at]=n,C(m),c=m}n.stateNode=c}else X0(f,n.type,n.stateNode);else n.stateNode=Y0(f,c,n.memoizedProps);else m!==c?(m===null?o.stateNode!==null&&(o=o.stateNode,o.parentNode.removeChild(o)):m.count--,c===null?X0(f,n.type,n.stateNode):Y0(f,c,n.memoizedProps)):c===null&&n.stateNode!==null&&jm(n,n.memoizedProps,o.memoizedProps)}break;case 27:pr(r,n),gr(n),c&512&&(Cs||o===null||ba(o,o.return)),o!==null&&c&4&&jm(n,n.memoizedProps,o.memoizedProps);break;case 5:if(pr(r,n),gr(n),c&512&&(Cs||o===null||ba(o,o.return)),n.flags&32){f=n.stateNode;try{Gn(f,"")}catch(ut){Fn(n,n.return,ut)}}c&4&&n.stateNode!=null&&(f=n.memoizedProps,jm(n,f,o!==null?o.memoizedProps:f)),c&1024&&(Nm=!0);break;case 6:if(pr(r,n),gr(n),c&4){if(n.stateNode===null)throw Error(i(162));c=n.memoizedProps,o=n.stateNode;try{o.nodeValue=c}catch(ut){Fn(n,n.return,ut)}}break;case 3:if(Vh=null,f=na,na=Lh(r.containerInfo),pr(r,n),na=f,gr(n),c&4&&o!==null&&o.memoizedState.isDehydrated)try{Tl(r.containerInfo)}catch(ut){Fn(n,n.return,ut)}Nm&&(Nm=!1,Xv(n));break;case 4:c=na,na=Lh(n.stateNode.containerInfo),pr(r,n),gr(n),na=c;break;case 12:pr(r,n),gr(n);break;case 31:pr(r,n),gr(n),c&4&&(c=n.updateQueue,c!==null&&(n.updateQueue=null,_h(n,c)));break;case 13:pr(r,n),gr(n),n.child.flags&8192&&n.memoizedState!==null!=(o!==null&&o.memoizedState!==null)&&(Th=Et()),c&4&&(c=n.updateQueue,c!==null&&(n.updateQueue=null,_h(n,c)));break;case 22:f=n.memoizedState!==null;var B=o!==null&&o.memoizedState!==null,ae=Ga,we=Cs;if(Ga=ae||f,Cs=we||B,pr(r,n),Cs=we,Ga=ae,gr(n),c&8192)e:for(r=n.stateNode,r._visibility=f?r._visibility&-2:r._visibility|1,f&&(o===null||B||Ga||Cs||Eo(n)),o=null,r=n;;){if(r.tag===5||r.tag===26){if(o===null){B=o=r;try{if(m=B.stateNode,f)v=m.style,typeof v.setProperty=="function"?v.setProperty("display","none","important"):v.display="none";else{E=B.stateNode;var Re=B.memoizedProps.style,oe=Re!=null&&Re.hasOwnProperty("display")?Re.display:null;E.style.display=oe==null||typeof oe=="boolean"?"":(""+oe).trim()}}catch(ut){Fn(B,B.return,ut)}}}else if(r.tag===6){if(o===null){B=r;try{B.stateNode.nodeValue=f?"":B.memoizedProps}catch(ut){Fn(B,B.return,ut)}}}else if(r.tag===18){if(o===null){B=r;try{var de=B.stateNode;f?U0(de,!0):U0(B.stateNode,!1)}catch(ut){Fn(B,B.return,ut)}}}else if((r.tag!==22&&r.tag!==23||r.memoizedState===null||r===n)&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===n)break e;for(;r.sibling===null;){if(r.return===null||r.return===n)break e;o===r&&(o=null),r=r.return}o===r&&(o=null),r.sibling.return=r.return,r=r.sibling}c&4&&(c=n.updateQueue,c!==null&&(o=c.retryQueue,o!==null&&(c.retryQueue=null,_h(n,o))));break;case 19:pr(r,n),gr(n),c&4&&(c=n.updateQueue,c!==null&&(n.updateQueue=null,_h(n,c)));break;case 30:break;case 21:break;default:pr(r,n),gr(n)}}function gr(n){var r=n.flags;if(r&2){try{for(var o,c=n.return;c!==null;){if(Fv(c)){o=c;break}c=c.return}if(o==null)throw Error(i(160));switch(o.tag){case 27:var f=o.stateNode,m=Em(n);wh(n,m,f);break;case 5:var v=o.stateNode;o.flags&32&&(Gn(v,""),o.flags&=-33);var E=Em(n);wh(n,E,v);break;case 3:case 4:var B=o.stateNode.containerInfo,ae=Em(n);Sm(n,ae,B);break;default:throw Error(i(161))}}catch(we){Fn(n,n.return,we)}n.flags&=-3}r&4096&&(n.flags&=-4097)}function Xv(n){if(n.subtreeFlags&1024)for(n=n.child;n!==null;){var r=n;Xv(r),r.tag===5&&r.flags&1024&&r.stateNode.reset(),n=n.sibling}}function Ya(n,r){if(r.subtreeFlags&8772)for(r=r.child;r!==null;)$v(n,r.alternate,r),r=r.sibling}function Eo(n){for(n=n.child;n!==null;){var r=n;switch(r.tag){case 0:case 11:case 14:case 15:Ti(4,r,r.return),Eo(r);break;case 1:ba(r,r.return);var o=r.stateNode;typeof o.componentWillUnmount=="function"&&Uv(r,r.return,o),Eo(r);break;case 27:Rc(r.stateNode);case 26:case 5:ba(r,r.return),Eo(r);break;case 22:r.memoizedState===null&&Eo(r);break;case 30:Eo(r);break;default:Eo(r)}n=n.sibling}}function Qa(n,r,o){for(o=o&&(r.subtreeFlags&8772)!==0,r=r.child;r!==null;){var c=r.alternate,f=n,m=r,v=m.flags;switch(m.tag){case 0:case 11:case 15:Qa(f,m,o),xc(4,m);break;case 1:if(Qa(f,m,o),c=m,f=c.stateNode,typeof f.componentDidMount=="function")try{f.componentDidMount()}catch(ae){Fn(c,c.return,ae)}if(c=m,f=c.updateQueue,f!==null){var E=c.stateNode;try{var B=f.shared.hiddenCallbacks;if(B!==null)for(f.shared.hiddenCallbacks=null,f=0;f<B.length;f++)Nb(B[f],E)}catch(ae){Fn(c,c.return,ae)}}o&&v&64&&Bv(m),wc(m,m.return);break;case 27:qv(m);case 26:case 5:Qa(f,m,o),o&&c===null&&v&4&&zv(m),wc(m,m.return);break;case 12:Qa(f,m,o);break;case 31:Qa(f,m,o),o&&v&4&&Kv(f,m);break;case 13:Qa(f,m,o),o&&v&4&&Yv(f,m);break;case 22:m.memoizedState===null&&Qa(f,m,o),wc(m,m.return);break;case 30:break;default:Qa(f,m,o)}r=r.sibling}}function Cm(n,r){var o=null;n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(o=n.memoizedState.cachePool.pool),n=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(n=r.memoizedState.cachePool.pool),n!==o&&(n!=null&&n.refCount++,o!=null&&oc(o))}function Rm(n,r){n=null,r.alternate!==null&&(n=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==n&&(r.refCount++,n!=null&&oc(n))}function sa(n,r,o,c){if(r.subtreeFlags&10256)for(r=r.child;r!==null;)Jv(n,r,o,c),r=r.sibling}function Jv(n,r,o,c){var f=r.flags;switch(r.tag){case 0:case 11:case 15:sa(n,r,o,c),f&2048&&xc(9,r);break;case 1:sa(n,r,o,c);break;case 3:sa(n,r,o,c),f&2048&&(n=null,r.alternate!==null&&(n=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==n&&(r.refCount++,n!=null&&oc(n)));break;case 12:if(f&2048){sa(n,r,o,c),n=r.stateNode;try{var m=r.memoizedProps,v=m.id,E=m.onPostCommit;typeof E=="function"&&E(v,r.alternate===null?"mount":"update",n.passiveEffectDuration,-0)}catch(B){Fn(r,r.return,B)}}else sa(n,r,o,c);break;case 31:sa(n,r,o,c);break;case 13:sa(n,r,o,c);break;case 23:break;case 22:m=r.stateNode,v=r.alternate,r.memoizedState!==null?m._visibility&2?sa(n,r,o,c):_c(n,r):m._visibility&2?sa(n,r,o,c):(m._visibility|=2,fl(n,r,o,c,(r.subtreeFlags&10256)!==0||!1)),f&2048&&Cm(v,r);break;case 24:sa(n,r,o,c),f&2048&&Rm(r.alternate,r);break;default:sa(n,r,o,c)}}function fl(n,r,o,c,f){for(f=f&&((r.subtreeFlags&10256)!==0||!1),r=r.child;r!==null;){var m=n,v=r,E=o,B=c,ae=v.flags;switch(v.tag){case 0:case 11:case 15:fl(m,v,E,B,f),xc(8,v);break;case 23:break;case 22:var we=v.stateNode;v.memoizedState!==null?we._visibility&2?fl(m,v,E,B,f):_c(m,v):(we._visibility|=2,fl(m,v,E,B,f)),f&&ae&2048&&Cm(v.alternate,v);break;case 24:fl(m,v,E,B,f),f&&ae&2048&&Rm(v.alternate,v);break;default:fl(m,v,E,B,f)}r=r.sibling}}function _c(n,r){if(r.subtreeFlags&10256)for(r=r.child;r!==null;){var o=n,c=r,f=c.flags;switch(c.tag){case 22:_c(o,c),f&2048&&Cm(c.alternate,c);break;case 24:_c(o,c),f&2048&&Rm(c.alternate,c);break;default:_c(o,c)}r=r.sibling}}var kc=8192;function ml(n,r,o){if(n.subtreeFlags&kc)for(n=n.child;n!==null;)Zv(n,r,o),n=n.sibling}function Zv(n,r,o){switch(n.tag){case 26:ml(n,r,o),n.flags&kc&&n.memoizedState!==null&&WT(o,na,n.memoizedState,n.memoizedProps);break;case 5:ml(n,r,o);break;case 3:case 4:var c=na;na=Lh(n.stateNode.containerInfo),ml(n,r,o),na=c;break;case 22:n.memoizedState===null&&(c=n.alternate,c!==null&&c.memoizedState!==null?(c=kc,kc=16777216,ml(n,r,o),kc=c):ml(n,r,o));break;default:ml(n,r,o)}}function e0(n){var r=n.alternate;if(r!==null&&(n=r.child,n!==null)){r.child=null;do r=n.sibling,n.sibling=null,n=r;while(n!==null)}}function Tc(n){var r=n.deletions;if((n.flags&16)!==0){if(r!==null)for(var o=0;o<r.length;o++){var c=r[o];Us=c,n0(c,n)}e0(n)}if(n.subtreeFlags&10256)for(n=n.child;n!==null;)t0(n),n=n.sibling}function t0(n){switch(n.tag){case 0:case 11:case 15:Tc(n),n.flags&2048&&Ti(9,n,n.return);break;case 3:Tc(n);break;case 12:Tc(n);break;case 22:var r=n.stateNode;n.memoizedState!==null&&r._visibility&2&&(n.return===null||n.return.tag!==13)?(r._visibility&=-3,kh(n)):Tc(n);break;default:Tc(n)}}function kh(n){var r=n.deletions;if((n.flags&16)!==0){if(r!==null)for(var o=0;o<r.length;o++){var c=r[o];Us=c,n0(c,n)}e0(n)}for(n=n.child;n!==null;){switch(r=n,r.tag){case 0:case 11:case 15:Ti(8,r,r.return),kh(r);break;case 22:o=r.stateNode,o._visibility&2&&(o._visibility&=-3,kh(r));break;default:kh(r)}n=n.sibling}}function n0(n,r){for(;Us!==null;){var o=Us;switch(o.tag){case 0:case 11:case 15:Ti(8,o,r);break;case 23:case 22:if(o.memoizedState!==null&&o.memoizedState.cachePool!==null){var c=o.memoizedState.cachePool.pool;c!=null&&c.refCount++}break;case 24:oc(o.memoizedState.cache)}if(c=o.child,c!==null)c.return=o,Us=c;else e:for(o=n;Us!==null;){c=Us;var f=c.sibling,m=c.return;if(Wv(c),c===o){Us=null;break e}if(f!==null){f.return=m,Us=f;break e}Us=m}}}var oT={getCacheForType:function(n){var r=Hs(Es),o=r.data.get(n);return o===void 0&&(o=n(),r.data.set(n,o)),o},cacheSignal:function(){return Hs(Es).controller.signal}},lT=typeof WeakMap=="function"?WeakMap:Map,Dn=0,Yn=null,an=null,hn=0,zn=0,Rr=null,ji=!1,pl=!1,Am=!1,Xa=0,ps=0,Ei=0,So=0,Im=0,Ar=0,gl=0,jc=null,yr=null,Mm=!1,Th=0,s0=0,jh=1/0,Eh=null,Si=null,Ps=0,Ni=null,yl=null,Ja=0,Dm=0,Pm=null,r0=null,Ec=0,Lm=null;function Ir(){return(Dn&2)!==0&&hn!==0?hn&-hn:z.T!==null?Fm():_e()}function a0(){if(Ar===0)if((hn&536870912)===0||kn){var n=Xe;Xe<<=1,(Xe&3932160)===0&&(Xe=262144),Ar=n}else Ar=536870912;return n=Nr.current,n!==null&&(n.flags|=32),Ar}function br(n,r,o){(n===Yn&&(zn===2||zn===9)||n.cancelPendingCommit!==null)&&(bl(n,0),Ci(n,hn,Ar,!1)),sn(n,o),((Dn&2)===0||n!==Yn)&&(n===Yn&&((Dn&2)===0&&(So|=o),ps===4&&Ci(n,hn,Ar,!1)),va(n))}function i0(n,r,o){if((Dn&6)!==0)throw Error(i(327));var c=!o&&(r&127)===0&&(r&n.expiredLanes)===0||Rt(n,r),f=c?hT(n,r):Vm(n,r,!0),m=c;do{if(f===0){pl&&!c&&Ci(n,r,0,!1);break}else{if(o=n.current.alternate,m&&!cT(o)){f=Vm(n,r,!1),m=!1;continue}if(f===2){if(m=r,n.errorRecoveryDisabledLanes&m)var v=0;else v=n.pendingLanes&-536870913,v=v!==0?v:v&536870912?536870912:0;if(v!==0){r=v;e:{var E=n;f=jc;var B=E.current.memoizedState.isDehydrated;if(B&&(bl(E,v).flags|=256),v=Vm(E,v,!1),v!==2){if(Am&&!B){E.errorRecoveryDisabledLanes|=m,So|=m,f=4;break e}m=yr,yr=f,m!==null&&(yr===null?yr=m:yr.push.apply(yr,m))}f=v}if(m=!1,f!==2)continue}}if(f===1){bl(n,0),Ci(n,r,0,!0);break}e:{switch(c=n,m=f,m){case 0:case 1:throw Error(i(345));case 4:if((r&4194048)!==r)break;case 6:Ci(c,r,Ar,!ji);break e;case 2:yr=null;break;case 3:case 5:break;default:throw Error(i(329))}if((r&62914560)===r&&(f=Th+300-Et(),10<f)){if(Ci(c,r,Ar,!ji),qt(c,0,!0)!==0)break e;Ja=r,c.timeoutHandle=O0(o0.bind(null,c,o,yr,Eh,Mm,r,Ar,So,gl,ji,m,"Throttled",-0,0),f);break e}o0(c,o,yr,Eh,Mm,r,Ar,So,gl,ji,m,null,-0,0)}}break}while(!0);va(n)}function o0(n,r,o,c,f,m,v,E,B,ae,we,Re,oe,de){if(n.timeoutHandle=-1,Re=r.subtreeFlags,Re&8192||(Re&16785408)===16785408){Re={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:A},Zv(r,m,Re);var ut=(m&62914560)===m?Th-Et():(m&4194048)===m?s0-Et():0;if(ut=GT(Re,ut),ut!==null){Ja=m,n.cancelPendingCommit=ut(p0.bind(null,n,r,m,o,c,f,v,E,B,we,Re,null,oe,de)),Ci(n,m,v,!ae);return}}p0(n,r,m,o,c,f,v,E,B)}function cT(n){for(var r=n;;){var o=r.tag;if((o===0||o===11||o===15)&&r.flags&16384&&(o=r.updateQueue,o!==null&&(o=o.stores,o!==null)))for(var c=0;c<o.length;c++){var f=o[c],m=f.getSnapshot;f=f.value;try{if(!Er(m(),f))return!1}catch{return!1}}if(o=r.child,r.subtreeFlags&16384&&o!==null)o.return=r,r=o;else{if(r===n)break;for(;r.sibling===null;){if(r.return===null||r.return===n)return!0;r=r.return}r.sibling.return=r.return,r=r.sibling}}return!0}function Ci(n,r,o,c){r&=~Im,r&=~So,n.suspendedLanes|=r,n.pingedLanes&=~r,c&&(n.warmLanes|=r),c=n.expirationTimes;for(var f=r;0<f;){var m=31-Oe(f),v=1<<m;c[m]=-1,f&=~v}o!==0&&In(n,o,r)}function Sh(){return(Dn&6)===0?(Sc(0),!1):!0}function Om(){if(an!==null){if(zn===0)var n=an.return;else n=an,za=bo=null,Zf(n),ll=null,cc=0,n=an;for(;n!==null;)Vv(n.alternate,n),n=n.return;an=null}}function bl(n,r){var o=n.timeoutHandle;o!==-1&&(n.timeoutHandle=-1,CT(o)),o=n.cancelPendingCommit,o!==null&&(n.cancelPendingCommit=null,o()),Ja=0,Om(),Yn=n,an=o=Ba(n.current,null),hn=r,zn=0,Rr=null,ji=!1,pl=Rt(n,r),Am=!1,gl=Ar=Im=So=Ei=ps=0,yr=jc=null,Mm=!1,(r&8)!==0&&(r|=r&32);var c=n.entangledLanes;if(c!==0)for(n=n.entanglements,c&=r;0<c;){var f=31-Oe(c),m=1<<f;r|=n[f],c&=~m}return Xa=r,Ku(),o}function l0(n,r){Zt=null,z.H=yc,r===ol||r===nh?(r=Tb(),zn=3):r===zf?(r=Tb(),zn=4):zn=r===pm?8:r!==null&&typeof r=="object"&&typeof r.then=="function"?6:1,Rr=r,an===null&&(ps=1,gh(n,Br(r,n.current)))}function c0(){var n=Nr.current;return n===null?!0:(hn&4194048)===hn?qr===null:(hn&62914560)===hn||(hn&536870912)!==0?n===qr:!1}function u0(){var n=z.H;return z.H=yc,n===null?yc:n}function h0(){var n=z.A;return z.A=oT,n}function Nh(){ps=4,ji||(hn&4194048)!==hn&&Nr.current!==null||(pl=!0),(Ei&134217727)===0&&(So&134217727)===0||Yn===null||Ci(Yn,hn,Ar,!1)}function Vm(n,r,o){var c=Dn;Dn|=2;var f=u0(),m=h0();(Yn!==n||hn!==r)&&(Eh=null,bl(n,r)),r=!1;var v=ps;e:do try{if(zn!==0&&an!==null){var E=an,B=Rr;switch(zn){case 8:Om(),v=6;break e;case 3:case 2:case 9:case 6:Nr.current===null&&(r=!0);var ae=zn;if(zn=0,Rr=null,vl(n,E,B,ae),o&&pl){v=0;break e}break;default:ae=zn,zn=0,Rr=null,vl(n,E,B,ae)}}uT(),v=ps;break}catch(we){l0(n,we)}while(!0);return r&&n.shellSuspendCounter++,za=bo=null,Dn=c,z.H=f,z.A=m,an===null&&(Yn=null,hn=0,Ku()),v}function uT(){for(;an!==null;)d0(an)}function hT(n,r){var o=Dn;Dn|=2;var c=u0(),f=h0();Yn!==n||hn!==r?(Eh=null,jh=Et()+500,bl(n,r)):pl=Rt(n,r);e:do try{if(zn!==0&&an!==null){r=an;var m=Rr;t:switch(zn){case 1:zn=0,Rr=null,vl(n,r,m,1);break;case 2:case 9:if(_b(m)){zn=0,Rr=null,f0(r);break}r=function(){zn!==2&&zn!==9||Yn!==n||(zn=7),va(n)},m.then(r,r);break e;case 3:zn=7;break e;case 4:zn=5;break e;case 7:_b(m)?(zn=0,Rr=null,f0(r)):(zn=0,Rr=null,vl(n,r,m,7));break;case 5:var v=null;switch(an.tag){case 26:v=an.memoizedState;case 5:case 27:var E=an;if(v?J0(v):E.stateNode.complete){zn=0,Rr=null;var B=E.sibling;if(B!==null)an=B;else{var ae=E.return;ae!==null?(an=ae,Ch(ae)):an=null}break t}}zn=0,Rr=null,vl(n,r,m,5);break;case 6:zn=0,Rr=null,vl(n,r,m,6);break;case 8:Om(),ps=6;break e;default:throw Error(i(462))}}dT();break}catch(we){l0(n,we)}while(!0);return za=bo=null,z.H=c,z.A=f,Dn=o,an!==null?0:(Yn=null,hn=0,Ku(),ps)}function dT(){for(;an!==null&&!rs();)d0(an)}function d0(n){var r=Lv(n.alternate,n,Xa);n.memoizedProps=n.pendingProps,r===null?Ch(n):an=r}function f0(n){var r=n,o=r.alternate;switch(r.tag){case 15:case 0:r=Rv(o,r,r.pendingProps,r.type,void 0,hn);break;case 11:r=Rv(o,r,r.pendingProps,r.type.render,r.ref,hn);break;case 5:Zf(r);default:Vv(o,r),r=an=hb(r,Xa),r=Lv(o,r,Xa)}n.memoizedProps=n.pendingProps,r===null?Ch(n):an=r}function vl(n,r,o,c){za=bo=null,Zf(r),ll=null,cc=0;var f=r.return;try{if(eT(n,f,r,o,hn)){ps=1,gh(n,Br(o,n.current)),an=null;return}}catch(m){if(f!==null)throw an=f,m;ps=1,gh(n,Br(o,n.current)),an=null;return}r.flags&32768?(kn||c===1?n=!0:pl||(hn&536870912)!==0?n=!1:(ji=n=!0,(c===2||c===9||c===3||c===6)&&(c=Nr.current,c!==null&&c.tag===13&&(c.flags|=16384))),m0(r,n)):Ch(r)}function Ch(n){var r=n;do{if((r.flags&32768)!==0){m0(r,ji);return}n=r.return;var o=sT(r.alternate,r,Xa);if(o!==null){an=o;return}if(r=r.sibling,r!==null){an=r;return}an=r=n}while(r!==null);ps===0&&(ps=5)}function m0(n,r){do{var o=rT(n.alternate,n);if(o!==null){o.flags&=32767,an=o;return}if(o=n.return,o!==null&&(o.flags|=32768,o.subtreeFlags=0,o.deletions=null),!r&&(n=n.sibling,n!==null)){an=n;return}an=n=o}while(n!==null);ps=6,an=null}function p0(n,r,o,c,f,m,v,E,B){n.cancelPendingCommit=null;do Rh();while(Ps!==0);if((Dn&6)!==0)throw Error(i(327));if(r!==null){if(r===n.current)throw Error(i(177));if(m=r.lanes|r.childLanes,m|=Ef,yn(n,o,m,v,E,B),n===Yn&&(an=Yn=null,hn=0),yl=r,Ni=n,Ja=o,Dm=m,Pm=f,r0=c,(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?(n.callbackNode=null,n.callbackPriority=0,gT(Kt,function(){return x0(),null})):(n.callbackNode=null,n.callbackPriority=0),c=(r.flags&13878)!==0,(r.subtreeFlags&13878)!==0||c){c=z.T,z.T=null,f=fe.p,fe.p=2,v=Dn,Dn|=4;try{aT(n,r,o)}finally{Dn=v,fe.p=f,z.T=c}}Ps=1,g0(),y0(),b0()}}function g0(){if(Ps===1){Ps=0;var n=Ni,r=yl,o=(r.flags&13878)!==0;if((r.subtreeFlags&13878)!==0||o){o=z.T,z.T=null;var c=fe.p;fe.p=2;var f=Dn;Dn|=4;try{Qv(r,n);var m=Qm,v=nb(n.containerInfo),E=m.focusedElem,B=m.selectionRange;if(v!==E&&E&&E.ownerDocument&&tb(E.ownerDocument.documentElement,E)){if(B!==null&&wf(E)){var ae=B.start,we=B.end;if(we===void 0&&(we=ae),"selectionStart"in E)E.selectionStart=ae,E.selectionEnd=Math.min(we,E.value.length);else{var Re=E.ownerDocument||document,oe=Re&&Re.defaultView||window;if(oe.getSelection){var de=oe.getSelection(),ut=E.textContent.length,Mt=Math.min(B.start,ut),$n=B.end===void 0?Mt:Math.min(B.end,ut);!de.extend&&Mt>$n&&(v=$n,$n=Mt,Mt=v);var X=eb(E,Mt),K=eb(E,$n);if(X&&K&&(de.rangeCount!==1||de.anchorNode!==X.node||de.anchorOffset!==X.offset||de.focusNode!==K.node||de.focusOffset!==K.offset)){var re=Re.createRange();re.setStart(X.node,X.offset),de.removeAllRanges(),Mt>$n?(de.addRange(re),de.extend(K.node,K.offset)):(re.setEnd(K.node,K.offset),de.addRange(re))}}}}for(Re=[],de=E;de=de.parentNode;)de.nodeType===1&&Re.push({element:de,left:de.scrollLeft,top:de.scrollTop});for(typeof E.focus=="function"&&E.focus(),E=0;E<Re.length;E++){var Te=Re[E];Te.element.scrollLeft=Te.left,Te.element.scrollTop=Te.top}}Fh=!!Ym,Qm=Ym=null}finally{Dn=f,fe.p=c,z.T=o}}n.current=r,Ps=2}}function y0(){if(Ps===2){Ps=0;var n=Ni,r=yl,o=(r.flags&8772)!==0;if((r.subtreeFlags&8772)!==0||o){o=z.T,z.T=null;var c=fe.p;fe.p=2;var f=Dn;Dn|=4;try{$v(n,r.alternate,r)}finally{Dn=f,fe.p=c,z.T=o}}Ps=3}}function b0(){if(Ps===4||Ps===3){Ps=0,Lt();var n=Ni,r=yl,o=Ja,c=r0;(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?Ps=5:(Ps=0,yl=Ni=null,v0(n,n.pendingLanes));var f=n.pendingLanes;if(f===0&&(Si=null),pe(o),r=r.stateNode,Ue&&typeof Ue.onCommitFiberRoot=="function")try{Ue.onCommitFiberRoot(Qe,r,void 0,(r.current.flags&128)===128)}catch{}if(c!==null){r=z.T,f=fe.p,fe.p=2,z.T=null;try{for(var m=n.onRecoverableError,v=0;v<c.length;v++){var E=c[v];m(E.value,{componentStack:E.stack})}}finally{z.T=r,fe.p=f}}(Ja&3)!==0&&Rh(),va(n),f=n.pendingLanes,(o&261930)!==0&&(f&42)!==0?n===Lm?Ec++:(Ec=0,Lm=n):Ec=0,Sc(0)}}function v0(n,r){(n.pooledCacheLanes&=r)===0&&(r=n.pooledCache,r!=null&&(n.pooledCache=null,oc(r)))}function Rh(){return g0(),y0(),b0(),x0()}function x0(){if(Ps!==5)return!1;var n=Ni,r=Dm;Dm=0;var o=pe(Ja),c=z.T,f=fe.p;try{fe.p=32>o?32:o,z.T=null,o=Pm,Pm=null;var m=Ni,v=Ja;if(Ps=0,yl=Ni=null,Ja=0,(Dn&6)!==0)throw Error(i(331));var E=Dn;if(Dn|=4,t0(m.current),Jv(m,m.current,v,o),Dn=E,Sc(0,!1),Ue&&typeof Ue.onPostCommitFiberRoot=="function")try{Ue.onPostCommitFiberRoot(Qe,m)}catch{}return!0}finally{fe.p=f,z.T=c,v0(n,r)}}function w0(n,r,o){r=Br(o,r),r=mm(n.stateNode,r,2),n=wi(n,r,2),n!==null&&(sn(n,2),va(n))}function Fn(n,r,o){if(n.tag===3)w0(n,n,o);else for(;r!==null;){if(r.tag===3){w0(r,n,o);break}else if(r.tag===1){var c=r.stateNode;if(typeof r.type.getDerivedStateFromError=="function"||typeof c.componentDidCatch=="function"&&(Si===null||!Si.has(c))){n=Br(o,n),o=_v(2),c=wi(r,o,2),c!==null&&(kv(o,c,r,n),sn(c,2),va(c));break}}r=r.return}}function Bm(n,r,o){var c=n.pingCache;if(c===null){c=n.pingCache=new lT;var f=new Set;c.set(r,f)}else f=c.get(r),f===void 0&&(f=new Set,c.set(r,f));f.has(o)||(Am=!0,f.add(o),n=fT.bind(null,n,r,o),r.then(n,n))}function fT(n,r,o){var c=n.pingCache;c!==null&&c.delete(r),n.pingedLanes|=n.suspendedLanes&o,n.warmLanes&=~o,Yn===n&&(hn&o)===o&&(ps===4||ps===3&&(hn&62914560)===hn&&300>Et()-Th?(Dn&2)===0&&bl(n,0):Im|=o,gl===hn&&(gl=0)),va(n)}function _0(n,r){r===0&&(r=Vn()),n=po(n,r),n!==null&&(sn(n,r),va(n))}function mT(n){var r=n.memoizedState,o=0;r!==null&&(o=r.retryLane),_0(n,o)}function pT(n,r){var o=0;switch(n.tag){case 31:case 13:var c=n.stateNode,f=n.memoizedState;f!==null&&(o=f.retryLane);break;case 19:c=n.stateNode;break;case 22:c=n.stateNode._retryCache;break;default:throw Error(i(314))}c!==null&&c.delete(r),_0(n,o)}function gT(n,r){return et(n,r)}var Ah=null,xl=null,Um=!1,Ih=!1,zm=!1,Ri=0;function va(n){n!==xl&&n.next===null&&(xl===null?Ah=xl=n:xl=xl.next=n),Ih=!0,Um||(Um=!0,bT())}function Sc(n,r){if(!zm&&Ih){zm=!0;do for(var o=!1,c=Ah;c!==null;){if(n!==0){var f=c.pendingLanes;if(f===0)var m=0;else{var v=c.suspendedLanes,E=c.pingedLanes;m=(1<<31-Oe(42|n)+1)-1,m&=f&~(v&~E),m=m&201326741?m&201326741|1:m?m|2:0}m!==0&&(o=!0,E0(c,m))}else m=hn,m=qt(c,c===Yn?m:0,c.cancelPendingCommit!==null||c.timeoutHandle!==-1),(m&3)===0||Rt(c,m)||(o=!0,E0(c,m));c=c.next}while(o);zm=!1}}function yT(){k0()}function k0(){Ih=Um=!1;var n=0;Ri!==0&&NT()&&(n=Ri);for(var r=Et(),o=null,c=Ah;c!==null;){var f=c.next,m=T0(c,r);m===0?(c.next=null,o===null?Ah=f:o.next=f,f===null&&(xl=o)):(o=c,(n!==0||(m&3)!==0)&&(Ih=!0)),c=f}Ps!==0&&Ps!==5||Sc(n),Ri!==0&&(Ri=0)}function T0(n,r){for(var o=n.suspendedLanes,c=n.pingedLanes,f=n.expirationTimes,m=n.pendingLanes&-62914561;0<m;){var v=31-Oe(m),E=1<<v,B=f[v];B===-1?((E&o)===0||(E&c)!==0)&&(f[v]=tn(E,r)):B<=r&&(n.expiredLanes|=E),m&=~E}if(r=Yn,o=hn,o=qt(n,n===r?o:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),c=n.callbackNode,o===0||n===r&&(zn===2||zn===9)||n.cancelPendingCommit!==null)return c!==null&&c!==null&&en(c),n.callbackNode=null,n.callbackPriority=0;if((o&3)===0||Rt(n,o)){if(r=o&-o,r===n.callbackPriority)return r;switch(c!==null&&en(c),pe(o)){case 2:case 8:o=En;break;case 32:o=Kt;break;case 268435456:o=me;break;default:o=Kt}return c=j0.bind(null,n),o=et(o,c),n.callbackPriority=r,n.callbackNode=o,r}return c!==null&&c!==null&&en(c),n.callbackPriority=2,n.callbackNode=null,2}function j0(n,r){if(Ps!==0&&Ps!==5)return n.callbackNode=null,n.callbackPriority=0,null;var o=n.callbackNode;if(Rh()&&n.callbackNode!==o)return null;var c=hn;return c=qt(n,n===Yn?c:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),c===0?null:(i0(n,c,r),T0(n,Et()),n.callbackNode!=null&&n.callbackNode===o?j0.bind(null,n):null)}function E0(n,r){if(Rh())return null;i0(n,r,!0)}function bT(){RT(function(){(Dn&6)!==0?et(Ft,yT):k0()})}function Fm(){if(Ri===0){var n=al;n===0&&(n=Ee,Ee<<=1,(Ee&261888)===0&&(Ee=256)),Ri=n}return Ri}function S0(n){return n==null||typeof n=="symbol"||typeof n=="boolean"?null:typeof n=="function"?n:fa(""+n)}function N0(n,r){var o=r.ownerDocument.createElement("input");return o.name=r.name,o.value=r.value,n.id&&o.setAttribute("form",n.id),r.parentNode.insertBefore(o,r),n=new FormData(n),o.parentNode.removeChild(o),n}function vT(n,r,o,c,f){if(r==="submit"&&o&&o.stateNode===f){var m=S0((f[At]||null).action),v=c.submitter;v&&(r=(r=v[At]||null)?S0(r.formAction):v.getAttribute("formAction"),r!==null&&(m=r,v=null));var E=new Qs("action","action",null,c,f);n.push({event:E,listeners:[{instance:null,listener:function(){if(c.defaultPrevented){if(Ri!==0){var B=v?N0(f,v):new FormData(f);lm(o,{pending:!0,data:B,method:f.method,action:m},null,B)}}else typeof m=="function"&&(E.preventDefault(),B=v?N0(f,v):new FormData(f),lm(o,{pending:!0,data:B,method:f.method,action:m},m,B))},currentTarget:f}]})}}for(var qm=0;qm<jf.length;qm++){var Hm=jf[qm],xT=Hm.toLowerCase(),wT=Hm[0].toUpperCase()+Hm.slice(1);ta(xT,"on"+wT)}ta(ab,"onAnimationEnd"),ta(ib,"onAnimationIteration"),ta(ob,"onAnimationStart"),ta("dblclick","onDoubleClick"),ta("focusin","onFocus"),ta("focusout","onBlur"),ta(Ok,"onTransitionRun"),ta(Vk,"onTransitionStart"),ta(Bk,"onTransitionCancel"),ta(lb,"onTransitionEnd"),ze("onMouseEnter",["mouseout","mouseover"]),ze("onMouseLeave",["mouseout","mouseover"]),ze("onPointerEnter",["pointerout","pointerover"]),ze("onPointerLeave",["pointerout","pointerover"]),$e("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),$e("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),$e("onBeforeInput",["compositionend","keypress","textInput","paste"]),$e("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),$e("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),$e("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Nc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),_T=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Nc));function C0(n,r){r=(r&4)!==0;for(var o=0;o<n.length;o++){var c=n[o],f=c.event;c=c.listeners;e:{var m=void 0;if(r)for(var v=c.length-1;0<=v;v--){var E=c[v],B=E.instance,ae=E.currentTarget;if(E=E.listener,B!==m&&f.isPropagationStopped())break e;m=E,f.currentTarget=ae;try{m(f)}catch(we){Gu(we)}f.currentTarget=null,m=B}else for(v=0;v<c.length;v++){if(E=c[v],B=E.instance,ae=E.currentTarget,E=E.listener,B!==m&&f.isPropagationStopped())break e;m=E,f.currentTarget=ae;try{m(f)}catch(we){Gu(we)}f.currentTarget=null,m=B}}}}function on(n,r){var o=r[_t];o===void 0&&(o=r[_t]=new Set);var c=n+"__bubble";o.has(c)||(R0(r,n,2,!1),o.add(c))}function $m(n,r,o){var c=0;r&&(c|=4),R0(o,n,c,r)}var Mh="_reactListening"+Math.random().toString(36).slice(2);function Wm(n){if(!n[Mh]){n[Mh]=!0,Y.forEach(function(o){o!=="selectionchange"&&(_T.has(o)||$m(o,!1,n),$m(o,!0,n))});var r=n.nodeType===9?n:n.ownerDocument;r===null||r[Mh]||(r[Mh]=!0,$m("selectionchange",!1,r))}}function R0(n,r,o,c){switch(a1(r)){case 2:var f=QT;break;case 8:f=XT;break;default:f=op}o=f.bind(null,r,o,n),f=void 0,!_n||r!=="touchstart"&&r!=="touchmove"&&r!=="wheel"||(f=!0),c?f!==void 0?n.addEventListener(r,o,{capture:!0,passive:f}):n.addEventListener(r,o,!0):f!==void 0?n.addEventListener(r,o,{passive:f}):n.addEventListener(r,o,!1)}function Gm(n,r,o,c,f){var m=c;if((r&1)===0&&(r&2)===0&&c!==null)e:for(;;){if(c===null)return;var v=c.tag;if(v===3||v===4){var E=c.stateNode.containerInfo;if(E===f)break;if(v===4)for(v=c.return;v!==null;){var B=v.tag;if((B===3||B===4)&&v.stateNode.containerInfo===f)return;v=v.return}for(;E!==null;){if(v=Bn(E),v===null)return;if(B=v.tag,B===5||B===6||B===26||B===27){c=m=v;continue e}E=E.parentNode}}c=c.return}zt(function(){var ae=m,we=Pe(o),Re=[];e:{var oe=cb.get(n);if(oe!==void 0){var de=Qs,ut=n;switch(n){case"keypress":if(Jn(o)===0)break e;case"keydown":case"keyup":de=Hu;break;case"focusin":ut="focus",de=fr;break;case"focusout":ut="blur",de=fr;break;case"beforeblur":case"afterblur":de=fr;break;case"click":if(o.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":de=uo;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":de=Oa;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":de=b;break;case ab:case ib:case ob:de=Ou;break;case lb:de=N;break;case"scroll":case"scrollend":de=Bs;break;case"wheel":de=ue;break;case"copy":case"cut":case"paste":de=Vu;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":de=Va;break;case"toggle":case"beforetoggle":de=Jt}var Mt=(r&4)!==0,$n=!Mt&&(n==="scroll"||n==="scrollend"),X=Mt?oe!==null?oe+"Capture":null:oe;Mt=[];for(var K=ae,re;K!==null;){var Te=K;if(re=Te.stateNode,Te=Te.tag,Te!==5&&Te!==26&&Te!==27||re===null||X===null||(Te=Pt(K,X),Te!=null&&Mt.push(Cc(K,Te,re))),$n)break;K=K.return}0<Mt.length&&(oe=new de(oe,ut,null,o,we),Re.push({event:oe,listeners:Mt}))}}if((r&7)===0){e:{if(oe=n==="mouseover"||n==="pointerover",de=n==="mouseout"||n==="pointerout",oe&&o!==ee&&(ut=o.relatedTarget||o.fromElement)&&(Bn(ut)||ut[ct]))break e;if((de||oe)&&(oe=we.window===we?we:(oe=we.ownerDocument)?oe.defaultView||oe.parentWindow:window,de?(ut=o.relatedTarget||o.toElement,de=ae,ut=ut?Bn(ut):null,ut!==null&&($n=u(ut),Mt=ut.tag,ut!==$n||Mt!==5&&Mt!==27&&Mt!==6)&&(ut=null)):(de=null,ut=ae),de!==ut)){if(Mt=uo,Te="onMouseLeave",X="onMouseEnter",K="mouse",(n==="pointerout"||n==="pointerover")&&(Mt=Va,Te="onPointerLeave",X="onPointerEnter",K="pointer"),$n=de==null?oe:ce(de),re=ut==null?oe:ce(ut),oe=new Mt(Te,K+"leave",de,o,we),oe.target=$n,oe.relatedTarget=re,Te=null,Bn(we)===ae&&(Mt=new Mt(X,K+"enter",ut,o,we),Mt.target=re,Mt.relatedTarget=$n,Te=Mt),$n=Te,de&&ut)t:{for(Mt=kT,X=de,K=ut,re=0,Te=X;Te;Te=Mt(Te))re++;Te=0;for(var Tt=K;Tt;Tt=Mt(Tt))Te++;for(;0<re-Te;)X=Mt(X),re--;for(;0<Te-re;)K=Mt(K),Te--;for(;re--;){if(X===K||K!==null&&X===K.alternate){Mt=X;break t}X=Mt(X),K=Mt(K)}Mt=null}else Mt=null;de!==null&&A0(Re,oe,de,Mt,!1),ut!==null&&$n!==null&&A0(Re,$n,ut,Mt,!0)}}e:{if(oe=ae?ce(ae):window,de=oe.nodeName&&oe.nodeName.toLowerCase(),de==="select"||de==="input"&&oe.type==="file")var Nn=Ky;else if(Wy(oe))if(Yy)Nn=Dk;else{Nn=Ik;var yt=Ak}else de=oe.nodeName,!de||de.toLowerCase()!=="input"||oe.type!=="checkbox"&&oe.type!=="radio"?ae&&Vs(ae.elementType)&&(Nn=Ky):Nn=Mk;if(Nn&&(Nn=Nn(n,ae))){Gy(Re,Nn,o,we);break e}yt&&yt(n,oe,ae),n==="focusout"&&ae&&oe.type==="number"&&ae.memoizedProps.value!=null&&Xr(oe,"number",oe.value)}switch(yt=ae?ce(ae):window,n){case"focusin":(Wy(yt)||yt.contentEditable==="true")&&(Xo=yt,_f=ae,rc=null);break;case"focusout":rc=_f=Xo=null;break;case"mousedown":kf=!0;break;case"contextmenu":case"mouseup":case"dragend":kf=!1,sb(Re,o,we);break;case"selectionchange":if(Lk)break;case"keydown":case"keyup":sb(Re,o,we)}var nn;if(Mn)e:{switch(n){case"compositionstart":var dn="onCompositionStart";break e;case"compositionend":dn="onCompositionEnd";break e;case"compositionupdate":dn="onCompositionUpdate";break e}dn=void 0}else Qo?ho(n,o)&&(dn="onCompositionEnd"):n==="keydown"&&o.keyCode===229&&(dn="onCompositionStart");dn&&(pa&&o.locale!=="ko"&&(Qo||dn!=="onCompositionStart"?dn==="onCompositionEnd"&&Qo&&(nn=fs()):(cs=we,Xn="value"in cs?cs.value:cs.textContent,Qo=!0)),yt=Dh(ae,dn),0<yt.length&&(dn=new ma(dn,n,null,o,we),Re.push({event:dn,listeners:yt}),nn?dn.data=nn:(nn=Yo(o),nn!==null&&(dn.data=nn)))),(nn=Or?Sk(n,o):Nk(n,o))&&(dn=Dh(ae,"onBeforeInput"),0<dn.length&&(yt=new ma("onBeforeInput","beforeinput",null,o,we),Re.push({event:yt,listeners:dn}),yt.data=nn)),vT(Re,n,ae,o,we)}C0(Re,r)})}function Cc(n,r,o){return{instance:n,listener:r,currentTarget:o}}function Dh(n,r){for(var o=r+"Capture",c=[];n!==null;){var f=n,m=f.stateNode;if(f=f.tag,f!==5&&f!==26&&f!==27||m===null||(f=Pt(n,o),f!=null&&c.unshift(Cc(n,f,m)),f=Pt(n,r),f!=null&&c.push(Cc(n,f,m))),n.tag===3)return c;n=n.return}return[]}function kT(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5&&n.tag!==27);return n||null}function A0(n,r,o,c,f){for(var m=r._reactName,v=[];o!==null&&o!==c;){var E=o,B=E.alternate,ae=E.stateNode;if(E=E.tag,B!==null&&B===c)break;E!==5&&E!==26&&E!==27||ae===null||(B=ae,f?(ae=Pt(o,m),ae!=null&&v.unshift(Cc(o,ae,B))):f||(ae=Pt(o,m),ae!=null&&v.push(Cc(o,ae,B)))),o=o.return}v.length!==0&&n.push({event:r,listeners:v})}var TT=/\r\n?/g,jT=/\u0000|\uFFFD/g;function I0(n){return(typeof n=="string"?n:""+n).replace(TT,`
`).replace(jT,"")}function M0(n,r){return r=I0(r),I0(n)===r}function Hn(n,r,o,c,f,m){switch(o){case"children":typeof c=="string"?r==="body"||r==="textarea"&&c===""||Gn(n,c):(typeof c=="number"||typeof c=="bigint")&&r!=="body"&&Gn(n,""+c);break;case"className":ie(n,"class",c);break;case"tabIndex":ie(n,"tabindex",c);break;case"dir":case"role":case"viewBox":case"width":case"height":ie(n,o,c);break;case"style":Ms(n,c,m);break;case"data":if(r!=="object"){ie(n,"data",c);break}case"src":case"href":if(c===""&&(r!=="a"||o!=="href")){n.removeAttribute(o);break}if(c==null||typeof c=="function"||typeof c=="symbol"||typeof c=="boolean"){n.removeAttribute(o);break}c=fa(""+c),n.setAttribute(o,c);break;case"action":case"formAction":if(typeof c=="function"){n.setAttribute(o,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof m=="function"&&(o==="formAction"?(r!=="input"&&Hn(n,r,"name",f.name,f,null),Hn(n,r,"formEncType",f.formEncType,f,null),Hn(n,r,"formMethod",f.formMethod,f,null),Hn(n,r,"formTarget",f.formTarget,f,null)):(Hn(n,r,"encType",f.encType,f,null),Hn(n,r,"method",f.method,f,null),Hn(n,r,"target",f.target,f,null)));if(c==null||typeof c=="symbol"||typeof c=="boolean"){n.removeAttribute(o);break}c=fa(""+c),n.setAttribute(o,c);break;case"onClick":c!=null&&(n.onclick=A);break;case"onScroll":c!=null&&on("scroll",n);break;case"onScrollEnd":c!=null&&on("scrollend",n);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(i(61));if(o=c.__html,o!=null){if(f.children!=null)throw Error(i(60));n.innerHTML=o}}break;case"multiple":n.multiple=c&&typeof c!="function"&&typeof c!="symbol";break;case"muted":n.muted=c&&typeof c!="function"&&typeof c!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(c==null||typeof c=="function"||typeof c=="boolean"||typeof c=="symbol"){n.removeAttribute("xlink:href");break}o=fa(""+c),n.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",o);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":c!=null&&typeof c!="function"&&typeof c!="symbol"?n.setAttribute(o,""+c):n.removeAttribute(o);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":c&&typeof c!="function"&&typeof c!="symbol"?n.setAttribute(o,""):n.removeAttribute(o);break;case"capture":case"download":c===!0?n.setAttribute(o,""):c!==!1&&c!=null&&typeof c!="function"&&typeof c!="symbol"?n.setAttribute(o,c):n.removeAttribute(o);break;case"cols":case"rows":case"size":case"span":c!=null&&typeof c!="function"&&typeof c!="symbol"&&!isNaN(c)&&1<=c?n.setAttribute(o,c):n.removeAttribute(o);break;case"rowSpan":case"start":c==null||typeof c=="function"||typeof c=="symbol"||isNaN(c)?n.removeAttribute(o):n.setAttribute(o,c);break;case"popover":on("beforetoggle",n),on("toggle",n),he(n,"popover",c);break;case"xlinkActuate":Ce(n,"http://www.w3.org/1999/xlink","xlink:actuate",c);break;case"xlinkArcrole":Ce(n,"http://www.w3.org/1999/xlink","xlink:arcrole",c);break;case"xlinkRole":Ce(n,"http://www.w3.org/1999/xlink","xlink:role",c);break;case"xlinkShow":Ce(n,"http://www.w3.org/1999/xlink","xlink:show",c);break;case"xlinkTitle":Ce(n,"http://www.w3.org/1999/xlink","xlink:title",c);break;case"xlinkType":Ce(n,"http://www.w3.org/1999/xlink","xlink:type",c);break;case"xmlBase":Ce(n,"http://www.w3.org/XML/1998/namespace","xml:base",c);break;case"xmlLang":Ce(n,"http://www.w3.org/XML/1998/namespace","xml:lang",c);break;case"xmlSpace":Ce(n,"http://www.w3.org/XML/1998/namespace","xml:space",c);break;case"is":he(n,"is",c);break;case"innerText":case"textContent":break;default:(!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(o=Lr.get(o)||o,he(n,o,c))}}function Km(n,r,o,c,f,m){switch(o){case"style":Ms(n,c,m);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(i(61));if(o=c.__html,o!=null){if(f.children!=null)throw Error(i(60));n.innerHTML=o}}break;case"children":typeof c=="string"?Gn(n,c):(typeof c=="number"||typeof c=="bigint")&&Gn(n,""+c);break;case"onScroll":c!=null&&on("scroll",n);break;case"onScrollEnd":c!=null&&on("scrollend",n);break;case"onClick":c!=null&&(n.onclick=A);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!se.hasOwnProperty(o))e:{if(o[0]==="o"&&o[1]==="n"&&(f=o.endsWith("Capture"),r=o.slice(2,f?o.length-7:void 0),m=n[At]||null,m=m!=null?m[o]:null,typeof m=="function"&&n.removeEventListener(r,m,f),typeof c=="function")){typeof m!="function"&&m!==null&&(o in n?n[o]=null:n.hasAttribute(o)&&n.removeAttribute(o)),n.addEventListener(r,c,f);break e}o in n?n[o]=c:c===!0?n.setAttribute(o,""):he(n,o,c)}}}function Ws(n,r,o){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":on("error",n),on("load",n);var c=!1,f=!1,m;for(m in o)if(o.hasOwnProperty(m)){var v=o[m];if(v!=null)switch(m){case"src":c=!0;break;case"srcSet":f=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,r));default:Hn(n,r,m,v,o,null)}}f&&Hn(n,r,"srcSet",o.srcSet,o,null),c&&Hn(n,r,"src",o.src,o,null);return;case"input":on("invalid",n);var E=m=v=f=null,B=null,ae=null;for(c in o)if(o.hasOwnProperty(c)){var we=o[c];if(we!=null)switch(c){case"name":f=we;break;case"type":v=we;break;case"checked":B=we;break;case"defaultChecked":ae=we;break;case"value":m=we;break;case"defaultValue":E=we;break;case"children":case"dangerouslySetInnerHTML":if(we!=null)throw Error(i(137,r));break;default:Hn(n,r,c,we,o,null)}}Da(n,m,E,B,ae,v,f,!1);return;case"select":on("invalid",n),c=v=m=null;for(f in o)if(o.hasOwnProperty(f)&&(E=o[f],E!=null))switch(f){case"value":m=E;break;case"defaultValue":v=E;break;case"multiple":c=E;default:Hn(n,r,f,E,o,null)}r=m,o=v,n.multiple=!!c,r!=null?_r(n,!!c,r,!1):o!=null&&_r(n,!!c,o,!0);return;case"textarea":on("invalid",n),m=f=c=null;for(v in o)if(o.hasOwnProperty(v)&&(E=o[v],E!=null))switch(v){case"value":c=E;break;case"defaultValue":f=E;break;case"children":m=E;break;case"dangerouslySetInnerHTML":if(E!=null)throw Error(i(91));break;default:Hn(n,r,v,E,o,null)}ts(n,c,f,m);return;case"option":for(B in o)o.hasOwnProperty(B)&&(c=o[B],c!=null)&&(B==="selected"?n.selected=c&&typeof c!="function"&&typeof c!="symbol":Hn(n,r,B,c,o,null));return;case"dialog":on("beforetoggle",n),on("toggle",n),on("cancel",n),on("close",n);break;case"iframe":case"object":on("load",n);break;case"video":case"audio":for(c=0;c<Nc.length;c++)on(Nc[c],n);break;case"image":on("error",n),on("load",n);break;case"details":on("toggle",n);break;case"embed":case"source":case"link":on("error",n),on("load",n);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ae in o)if(o.hasOwnProperty(ae)&&(c=o[ae],c!=null))switch(ae){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,r));default:Hn(n,r,ae,c,o,null)}return;default:if(Vs(r)){for(we in o)o.hasOwnProperty(we)&&(c=o[we],c!==void 0&&Km(n,r,we,c,o,void 0));return}}for(E in o)o.hasOwnProperty(E)&&(c=o[E],c!=null&&Hn(n,r,E,c,o,null))}function ET(n,r,o,c){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var f=null,m=null,v=null,E=null,B=null,ae=null,we=null;for(de in o){var Re=o[de];if(o.hasOwnProperty(de)&&Re!=null)switch(de){case"checked":break;case"value":break;case"defaultValue":B=Re;default:c.hasOwnProperty(de)||Hn(n,r,de,null,c,Re)}}for(var oe in c){var de=c[oe];if(Re=o[oe],c.hasOwnProperty(oe)&&(de!=null||Re!=null))switch(oe){case"type":m=de;break;case"name":f=de;break;case"checked":ae=de;break;case"defaultChecked":we=de;break;case"value":v=de;break;case"defaultValue":E=de;break;case"children":case"dangerouslySetInnerHTML":if(de!=null)throw Error(i(137,r));break;default:de!==Re&&Hn(n,r,oe,de,c,Re)}}wr(n,v,E,B,ae,we,m,f);return;case"select":de=v=E=oe=null;for(m in o)if(B=o[m],o.hasOwnProperty(m)&&B!=null)switch(m){case"value":break;case"multiple":de=B;default:c.hasOwnProperty(m)||Hn(n,r,m,null,c,B)}for(f in c)if(m=c[f],B=o[f],c.hasOwnProperty(f)&&(m!=null||B!=null))switch(f){case"value":oe=m;break;case"defaultValue":E=m;break;case"multiple":v=m;default:m!==B&&Hn(n,r,f,m,c,B)}r=E,o=v,c=de,oe!=null?_r(n,!!o,oe,!1):!!c!=!!o&&(r!=null?_r(n,!!o,r,!0):_r(n,!!o,o?[]:"",!1));return;case"textarea":de=oe=null;for(E in o)if(f=o[E],o.hasOwnProperty(E)&&f!=null&&!c.hasOwnProperty(E))switch(E){case"value":break;case"children":break;default:Hn(n,r,E,null,c,f)}for(v in c)if(f=c[v],m=o[v],c.hasOwnProperty(v)&&(f!=null||m!=null))switch(v){case"value":oe=f;break;case"defaultValue":de=f;break;case"children":break;case"dangerouslySetInnerHTML":if(f!=null)throw Error(i(91));break;default:f!==m&&Hn(n,r,v,f,c,m)}wn(n,oe,de);return;case"option":for(var ut in o)oe=o[ut],o.hasOwnProperty(ut)&&oe!=null&&!c.hasOwnProperty(ut)&&(ut==="selected"?n.selected=!1:Hn(n,r,ut,null,c,oe));for(B in c)oe=c[B],de=o[B],c.hasOwnProperty(B)&&oe!==de&&(oe!=null||de!=null)&&(B==="selected"?n.selected=oe&&typeof oe!="function"&&typeof oe!="symbol":Hn(n,r,B,oe,c,de));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Mt in o)oe=o[Mt],o.hasOwnProperty(Mt)&&oe!=null&&!c.hasOwnProperty(Mt)&&Hn(n,r,Mt,null,c,oe);for(ae in c)if(oe=c[ae],de=o[ae],c.hasOwnProperty(ae)&&oe!==de&&(oe!=null||de!=null))switch(ae){case"children":case"dangerouslySetInnerHTML":if(oe!=null)throw Error(i(137,r));break;default:Hn(n,r,ae,oe,c,de)}return;default:if(Vs(r)){for(var $n in o)oe=o[$n],o.hasOwnProperty($n)&&oe!==void 0&&!c.hasOwnProperty($n)&&Km(n,r,$n,void 0,c,oe);for(we in c)oe=c[we],de=o[we],!c.hasOwnProperty(we)||oe===de||oe===void 0&&de===void 0||Km(n,r,we,oe,c,de);return}}for(var X in o)oe=o[X],o.hasOwnProperty(X)&&oe!=null&&!c.hasOwnProperty(X)&&Hn(n,r,X,null,c,oe);for(Re in c)oe=c[Re],de=o[Re],!c.hasOwnProperty(Re)||oe===de||oe==null&&de==null||Hn(n,r,Re,oe,c,de)}function D0(n){switch(n){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function ST(){if(typeof performance.getEntriesByType=="function"){for(var n=0,r=0,o=performance.getEntriesByType("resource"),c=0;c<o.length;c++){var f=o[c],m=f.transferSize,v=f.initiatorType,E=f.duration;if(m&&E&&D0(v)){for(v=0,E=f.responseEnd,c+=1;c<o.length;c++){var B=o[c],ae=B.startTime;if(ae>E)break;var we=B.transferSize,Re=B.initiatorType;we&&D0(Re)&&(B=B.responseEnd,v+=we*(B<E?1:(E-ae)/(B-ae)))}if(--c,r+=8*(m+v)/(f.duration/1e3),n++,10<n)break}}if(0<n)return r/n/1e6}return navigator.connection&&(n=navigator.connection.downlink,typeof n=="number")?n:5}var Ym=null,Qm=null;function Ph(n){return n.nodeType===9?n:n.ownerDocument}function P0(n){switch(n){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function L0(n,r){if(n===0)switch(r){case"svg":return 1;case"math":return 2;default:return 0}return n===1&&r==="foreignObject"?0:n}function Xm(n,r){return n==="textarea"||n==="noscript"||typeof r.children=="string"||typeof r.children=="number"||typeof r.children=="bigint"||typeof r.dangerouslySetInnerHTML=="object"&&r.dangerouslySetInnerHTML!==null&&r.dangerouslySetInnerHTML.__html!=null}var Jm=null;function NT(){var n=window.event;return n&&n.type==="popstate"?n===Jm?!1:(Jm=n,!0):(Jm=null,!1)}var O0=typeof setTimeout=="function"?setTimeout:void 0,CT=typeof clearTimeout=="function"?clearTimeout:void 0,V0=typeof Promise=="function"?Promise:void 0,RT=typeof queueMicrotask=="function"?queueMicrotask:typeof V0<"u"?function(n){return V0.resolve(null).then(n).catch(AT)}:O0;function AT(n){setTimeout(function(){throw n})}function Ai(n){return n==="head"}function B0(n,r){var o=r,c=0;do{var f=o.nextSibling;if(n.removeChild(o),f&&f.nodeType===8)if(o=f.data,o==="/$"||o==="/&"){if(c===0){n.removeChild(f),Tl(r);return}c--}else if(o==="$"||o==="$?"||o==="$~"||o==="$!"||o==="&")c++;else if(o==="html")Rc(n.ownerDocument.documentElement);else if(o==="head"){o=n.ownerDocument.head,Rc(o);for(var m=o.firstChild;m;){var v=m.nextSibling,E=m.nodeName;m[Ts]||E==="SCRIPT"||E==="STYLE"||E==="LINK"&&m.rel.toLowerCase()==="stylesheet"||o.removeChild(m),m=v}}else o==="body"&&Rc(n.ownerDocument.body);o=f}while(o);Tl(r)}function U0(n,r){var o=n;n=0;do{var c=o.nextSibling;if(o.nodeType===1?r?(o._stashedDisplay=o.style.display,o.style.display="none"):(o.style.display=o._stashedDisplay||"",o.getAttribute("style")===""&&o.removeAttribute("style")):o.nodeType===3&&(r?(o._stashedText=o.nodeValue,o.nodeValue=""):o.nodeValue=o._stashedText||""),c&&c.nodeType===8)if(o=c.data,o==="/$"){if(n===0)break;n--}else o!=="$"&&o!=="$?"&&o!=="$~"&&o!=="$!"||n++;o=c}while(o)}function Zm(n){var r=n.firstChild;for(r&&r.nodeType===10&&(r=r.nextSibling);r;){var o=r;switch(r=r.nextSibling,o.nodeName){case"HTML":case"HEAD":case"BODY":Zm(o),Os(o);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(o.rel.toLowerCase()==="stylesheet")continue}n.removeChild(o)}}function IT(n,r,o,c){for(;n.nodeType===1;){var f=o;if(n.nodeName.toLowerCase()!==r.toLowerCase()){if(!c&&(n.nodeName!=="INPUT"||n.type!=="hidden"))break}else if(c){if(!n[Ts])switch(r){case"meta":if(!n.hasAttribute("itemprop"))break;return n;case"link":if(m=n.getAttribute("rel"),m==="stylesheet"&&n.hasAttribute("data-precedence"))break;if(m!==f.rel||n.getAttribute("href")!==(f.href==null||f.href===""?null:f.href)||n.getAttribute("crossorigin")!==(f.crossOrigin==null?null:f.crossOrigin)||n.getAttribute("title")!==(f.title==null?null:f.title))break;return n;case"style":if(n.hasAttribute("data-precedence"))break;return n;case"script":if(m=n.getAttribute("src"),(m!==(f.src==null?null:f.src)||n.getAttribute("type")!==(f.type==null?null:f.type)||n.getAttribute("crossorigin")!==(f.crossOrigin==null?null:f.crossOrigin))&&m&&n.hasAttribute("async")&&!n.hasAttribute("itemprop"))break;return n;default:return n}}else if(r==="input"&&n.type==="hidden"){var m=f.name==null?null:""+f.name;if(f.type==="hidden"&&n.getAttribute("name")===m)return n}else return n;if(n=Hr(n.nextSibling),n===null)break}return null}function MT(n,r,o){if(r==="")return null;for(;n.nodeType!==3;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!o||(n=Hr(n.nextSibling),n===null))return null;return n}function z0(n,r){for(;n.nodeType!==8;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!r||(n=Hr(n.nextSibling),n===null))return null;return n}function ep(n){return n.data==="$?"||n.data==="$~"}function tp(n){return n.data==="$!"||n.data==="$?"&&n.ownerDocument.readyState!=="loading"}function DT(n,r){var o=n.ownerDocument;if(n.data==="$~")n._reactRetry=r;else if(n.data!=="$?"||o.readyState!=="loading")r();else{var c=function(){r(),o.removeEventListener("DOMContentLoaded",c)};o.addEventListener("DOMContentLoaded",c),n._reactRetry=c}}function Hr(n){for(;n!=null;n=n.nextSibling){var r=n.nodeType;if(r===1||r===3)break;if(r===8){if(r=n.data,r==="$"||r==="$!"||r==="$?"||r==="$~"||r==="&"||r==="F!"||r==="F")break;if(r==="/$"||r==="/&")return null}}return n}var np=null;function F0(n){n=n.nextSibling;for(var r=0;n;){if(n.nodeType===8){var o=n.data;if(o==="/$"||o==="/&"){if(r===0)return Hr(n.nextSibling);r--}else o!=="$"&&o!=="$!"&&o!=="$?"&&o!=="$~"&&o!=="&"||r++}n=n.nextSibling}return null}function q0(n){n=n.previousSibling;for(var r=0;n;){if(n.nodeType===8){var o=n.data;if(o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"){if(r===0)return n;r--}else o!=="/$"&&o!=="/&"||r++}n=n.previousSibling}return null}function H0(n,r,o){switch(r=Ph(o),n){case"html":if(n=r.documentElement,!n)throw Error(i(452));return n;case"head":if(n=r.head,!n)throw Error(i(453));return n;case"body":if(n=r.body,!n)throw Error(i(454));return n;default:throw Error(i(451))}}function Rc(n){for(var r=n.attributes;r.length;)n.removeAttributeNode(r[0]);Os(n)}var $r=new Map,$0=new Set;function Lh(n){return typeof n.getRootNode=="function"?n.getRootNode():n.nodeType===9?n:n.ownerDocument}var Za=fe.d;fe.d={f:PT,r:LT,D:OT,C:VT,L:BT,m:UT,X:FT,S:zT,M:qT};function PT(){var n=Za.f(),r=Sh();return n||r}function LT(n){var r=q(n);r!==null&&r.tag===5&&r.type==="form"?lv(r):Za.r(n)}var wl=typeof document>"u"?null:document;function W0(n,r,o){var c=wl;if(c&&typeof r=="string"&&r){var f=xn(r);f='link[rel="'+n+'"][href="'+f+'"]',typeof o=="string"&&(f+='[crossorigin="'+o+'"]'),$0.has(f)||($0.add(f),n={rel:n,crossOrigin:o,href:r},c.querySelector(f)===null&&(r=c.createElement("link"),Ws(r,"link",n),C(r),c.head.appendChild(r)))}}function OT(n){Za.D(n),W0("dns-prefetch",n,null)}function VT(n,r){Za.C(n,r),W0("preconnect",n,r)}function BT(n,r,o){Za.L(n,r,o);var c=wl;if(c&&n&&r){var f='link[rel="preload"][as="'+xn(r)+'"]';r==="image"&&o&&o.imageSrcSet?(f+='[imagesrcset="'+xn(o.imageSrcSet)+'"]',typeof o.imageSizes=="string"&&(f+='[imagesizes="'+xn(o.imageSizes)+'"]')):f+='[href="'+xn(n)+'"]';var m=f;switch(r){case"style":m=_l(n);break;case"script":m=kl(n)}$r.has(m)||(n=k({rel:"preload",href:r==="image"&&o&&o.imageSrcSet?void 0:n,as:r},o),$r.set(m,n),c.querySelector(f)!==null||r==="style"&&c.querySelector(Ac(m))||r==="script"&&c.querySelector(Ic(m))||(r=c.createElement("link"),Ws(r,"link",n),C(r),c.head.appendChild(r)))}}function UT(n,r){Za.m(n,r);var o=wl;if(o&&n){var c=r&&typeof r.as=="string"?r.as:"script",f='link[rel="modulepreload"][as="'+xn(c)+'"][href="'+xn(n)+'"]',m=f;switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":m=kl(n)}if(!$r.has(m)&&(n=k({rel:"modulepreload",href:n},r),$r.set(m,n),o.querySelector(f)===null)){switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(o.querySelector(Ic(m)))return}c=o.createElement("link"),Ws(c,"link",n),C(c),o.head.appendChild(c)}}}function zT(n,r,o){Za.S(n,r,o);var c=wl;if(c&&n){var f=T(c).hoistableStyles,m=_l(n);r=r||"default";var v=f.get(m);if(!v){var E={loading:0,preload:null};if(v=c.querySelector(Ac(m)))E.loading=5;else{n=k({rel:"stylesheet",href:n,"data-precedence":r},o),(o=$r.get(m))&&sp(n,o);var B=v=c.createElement("link");C(B),Ws(B,"link",n),B._p=new Promise(function(ae,we){B.onload=ae,B.onerror=we}),B.addEventListener("load",function(){E.loading|=1}),B.addEventListener("error",function(){E.loading|=2}),E.loading|=4,Oh(v,r,c)}v={type:"stylesheet",instance:v,count:1,state:E},f.set(m,v)}}}function FT(n,r){Za.X(n,r);var o=wl;if(o&&n){var c=T(o).hoistableScripts,f=kl(n),m=c.get(f);m||(m=o.querySelector(Ic(f)),m||(n=k({src:n,async:!0},r),(r=$r.get(f))&&rp(n,r),m=o.createElement("script"),C(m),Ws(m,"link",n),o.head.appendChild(m)),m={type:"script",instance:m,count:1,state:null},c.set(f,m))}}function qT(n,r){Za.M(n,r);var o=wl;if(o&&n){var c=T(o).hoistableScripts,f=kl(n),m=c.get(f);m||(m=o.querySelector(Ic(f)),m||(n=k({src:n,async:!0,type:"module"},r),(r=$r.get(f))&&rp(n,r),m=o.createElement("script"),C(m),Ws(m,"link",n),o.head.appendChild(m)),m={type:"script",instance:m,count:1,state:null},c.set(f,m))}}function G0(n,r,o,c){var f=(f=Ae.current)?Lh(f):null;if(!f)throw Error(i(446));switch(n){case"meta":case"title":return null;case"style":return typeof o.precedence=="string"&&typeof o.href=="string"?(r=_l(o.href),o=T(f).hoistableStyles,c=o.get(r),c||(c={type:"style",instance:null,count:0,state:null},o.set(r,c)),c):{type:"void",instance:null,count:0,state:null};case"link":if(o.rel==="stylesheet"&&typeof o.href=="string"&&typeof o.precedence=="string"){n=_l(o.href);var m=T(f).hoistableStyles,v=m.get(n);if(v||(f=f.ownerDocument||f,v={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},m.set(n,v),(m=f.querySelector(Ac(n)))&&!m._p&&(v.instance=m,v.state.loading=5),$r.has(n)||(o={rel:"preload",as:"style",href:o.href,crossOrigin:o.crossOrigin,integrity:o.integrity,media:o.media,hrefLang:o.hrefLang,referrerPolicy:o.referrerPolicy},$r.set(n,o),m||HT(f,n,o,v.state))),r&&c===null)throw Error(i(528,""));return v}if(r&&c!==null)throw Error(i(529,""));return null;case"script":return r=o.async,o=o.src,typeof o=="string"&&r&&typeof r!="function"&&typeof r!="symbol"?(r=kl(o),o=T(f).hoistableScripts,c=o.get(r),c||(c={type:"script",instance:null,count:0,state:null},o.set(r,c)),c):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,n))}}function _l(n){return'href="'+xn(n)+'"'}function Ac(n){return'link[rel="stylesheet"]['+n+"]"}function K0(n){return k({},n,{"data-precedence":n.precedence,precedence:null})}function HT(n,r,o,c){n.querySelector('link[rel="preload"][as="style"]['+r+"]")?c.loading=1:(r=n.createElement("link"),c.preload=r,r.addEventListener("load",function(){return c.loading|=1}),r.addEventListener("error",function(){return c.loading|=2}),Ws(r,"link",o),C(r),n.head.appendChild(r))}function kl(n){return'[src="'+xn(n)+'"]'}function Ic(n){return"script[async]"+n}function Y0(n,r,o){if(r.count++,r.instance===null)switch(r.type){case"style":var c=n.querySelector('style[data-href~="'+xn(o.href)+'"]');if(c)return r.instance=c,C(c),c;var f=k({},o,{"data-href":o.href,"data-precedence":o.precedence,href:null,precedence:null});return c=(n.ownerDocument||n).createElement("style"),C(c),Ws(c,"style",f),Oh(c,o.precedence,n),r.instance=c;case"stylesheet":f=_l(o.href);var m=n.querySelector(Ac(f));if(m)return r.state.loading|=4,r.instance=m,C(m),m;c=K0(o),(f=$r.get(f))&&sp(c,f),m=(n.ownerDocument||n).createElement("link"),C(m);var v=m;return v._p=new Promise(function(E,B){v.onload=E,v.onerror=B}),Ws(m,"link",c),r.state.loading|=4,Oh(m,o.precedence,n),r.instance=m;case"script":return m=kl(o.src),(f=n.querySelector(Ic(m)))?(r.instance=f,C(f),f):(c=o,(f=$r.get(m))&&(c=k({},o),rp(c,f)),n=n.ownerDocument||n,f=n.createElement("script"),C(f),Ws(f,"link",c),n.head.appendChild(f),r.instance=f);case"void":return null;default:throw Error(i(443,r.type))}else r.type==="stylesheet"&&(r.state.loading&4)===0&&(c=r.instance,r.state.loading|=4,Oh(c,o.precedence,n));return r.instance}function Oh(n,r,o){for(var c=o.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),f=c.length?c[c.length-1]:null,m=f,v=0;v<c.length;v++){var E=c[v];if(E.dataset.precedence===r)m=E;else if(m!==f)break}m?m.parentNode.insertBefore(n,m.nextSibling):(r=o.nodeType===9?o.head:o,r.insertBefore(n,r.firstChild))}function sp(n,r){n.crossOrigin==null&&(n.crossOrigin=r.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=r.referrerPolicy),n.title==null&&(n.title=r.title)}function rp(n,r){n.crossOrigin==null&&(n.crossOrigin=r.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=r.referrerPolicy),n.integrity==null&&(n.integrity=r.integrity)}var Vh=null;function Q0(n,r,o){if(Vh===null){var c=new Map,f=Vh=new Map;f.set(o,c)}else f=Vh,c=f.get(o),c||(c=new Map,f.set(o,c));if(c.has(n))return c;for(c.set(n,null),o=o.getElementsByTagName(n),f=0;f<o.length;f++){var m=o[f];if(!(m[Ts]||m[at]||n==="link"&&m.getAttribute("rel")==="stylesheet")&&m.namespaceURI!=="http://www.w3.org/2000/svg"){var v=m.getAttribute(r)||"";v=n+v;var E=c.get(v);E?E.push(m):c.set(v,[m])}}return c}function X0(n,r,o){n=n.ownerDocument||n,n.head.insertBefore(o,r==="title"?n.querySelector("head > title"):null)}function $T(n,r,o){if(o===1||r.itemProp!=null)return!1;switch(n){case"meta":case"title":return!0;case"style":if(typeof r.precedence!="string"||typeof r.href!="string"||r.href==="")break;return!0;case"link":if(typeof r.rel!="string"||typeof r.href!="string"||r.href===""||r.onLoad||r.onError)break;return r.rel==="stylesheet"?(n=r.disabled,typeof r.precedence=="string"&&n==null):!0;case"script":if(r.async&&typeof r.async!="function"&&typeof r.async!="symbol"&&!r.onLoad&&!r.onError&&r.src&&typeof r.src=="string")return!0}return!1}function J0(n){return!(n.type==="stylesheet"&&(n.state.loading&3)===0)}function WT(n,r,o,c){if(o.type==="stylesheet"&&(typeof c.media!="string"||matchMedia(c.media).matches!==!1)&&(o.state.loading&4)===0){if(o.instance===null){var f=_l(c.href),m=r.querySelector(Ac(f));if(m){r=m._p,r!==null&&typeof r=="object"&&typeof r.then=="function"&&(n.count++,n=Bh.bind(n),r.then(n,n)),o.state.loading|=4,o.instance=m,C(m);return}m=r.ownerDocument||r,c=K0(c),(f=$r.get(f))&&sp(c,f),m=m.createElement("link"),C(m);var v=m;v._p=new Promise(function(E,B){v.onload=E,v.onerror=B}),Ws(m,"link",c),o.instance=m}n.stylesheets===null&&(n.stylesheets=new Map),n.stylesheets.set(o,r),(r=o.state.preload)&&(o.state.loading&3)===0&&(n.count++,o=Bh.bind(n),r.addEventListener("load",o),r.addEventListener("error",o))}}var ap=0;function GT(n,r){return n.stylesheets&&n.count===0&&zh(n,n.stylesheets),0<n.count||0<n.imgCount?function(o){var c=setTimeout(function(){if(n.stylesheets&&zh(n,n.stylesheets),n.unsuspend){var m=n.unsuspend;n.unsuspend=null,m()}},6e4+r);0<n.imgBytes&&ap===0&&(ap=62500*ST());var f=setTimeout(function(){if(n.waitingForImages=!1,n.count===0&&(n.stylesheets&&zh(n,n.stylesheets),n.unsuspend)){var m=n.unsuspend;n.unsuspend=null,m()}},(n.imgBytes>ap?50:800)+r);return n.unsuspend=o,function(){n.unsuspend=null,clearTimeout(c),clearTimeout(f)}}:null}function Bh(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)zh(this,this.stylesheets);else if(this.unsuspend){var n=this.unsuspend;this.unsuspend=null,n()}}}var Uh=null;function zh(n,r){n.stylesheets=null,n.unsuspend!==null&&(n.count++,Uh=new Map,r.forEach(KT,n),Uh=null,Bh.call(n))}function KT(n,r){if(!(r.state.loading&4)){var o=Uh.get(n);if(o)var c=o.get(null);else{o=new Map,Uh.set(n,o);for(var f=n.querySelectorAll("link[data-precedence],style[data-precedence]"),m=0;m<f.length;m++){var v=f[m];(v.nodeName==="LINK"||v.getAttribute("media")!=="not all")&&(o.set(v.dataset.precedence,v),c=v)}c&&o.set(null,c)}f=r.instance,v=f.getAttribute("data-precedence"),m=o.get(v)||c,m===c&&o.set(null,f),o.set(v,f),this.count++,c=Bh.bind(this),f.addEventListener("load",c),f.addEventListener("error",c),m?m.parentNode.insertBefore(f,m.nextSibling):(n=n.nodeType===9?n.head:n,n.insertBefore(f,n.firstChild)),r.state.loading|=4}}var Mc={$$typeof:ye,Provider:null,Consumer:null,_currentValue:Ie,_currentValue2:Ie,_threadCount:0};function YT(n,r,o,c,f,m,v,E,B){this.tag=1,this.containerInfo=n,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=An(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=An(0),this.hiddenUpdates=An(null),this.identifierPrefix=c,this.onUncaughtError=f,this.onCaughtError=m,this.onRecoverableError=v,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=B,this.incompleteTransitions=new Map}function Z0(n,r,o,c,f,m,v,E,B,ae,we,Re){return n=new YT(n,r,o,v,B,ae,we,Re,E),r=1,m===!0&&(r|=24),m=Sr(3,null,null,r),n.current=m,m.stateNode=n,r=Vf(),r.refCount++,n.pooledCache=r,r.refCount++,m.memoizedState={element:c,isDehydrated:o,cache:r},Ff(m),n}function e1(n){return n?(n=el,n):el}function t1(n,r,o,c,f,m){f=e1(f),c.context===null?c.context=f:c.pendingContext=f,c=xi(r),c.payload={element:o},m=m===void 0?null:m,m!==null&&(c.callback=m),o=wi(n,c,r),o!==null&&(br(o,n,r),hc(o,n,r))}function n1(n,r){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var o=n.retryLane;n.retryLane=o!==0&&o<r?o:r}}function ip(n,r){n1(n,r),(n=n.alternate)&&n1(n,r)}function s1(n){if(n.tag===13||n.tag===31){var r=po(n,67108864);r!==null&&br(r,n,67108864),ip(n,67108864)}}function r1(n){if(n.tag===13||n.tag===31){var r=Ir();r=H(r);var o=po(n,r);o!==null&&br(o,n,r),ip(n,r)}}var Fh=!0;function QT(n,r,o,c){var f=z.T;z.T=null;var m=fe.p;try{fe.p=2,op(n,r,o,c)}finally{fe.p=m,z.T=f}}function XT(n,r,o,c){var f=z.T;z.T=null;var m=fe.p;try{fe.p=8,op(n,r,o,c)}finally{fe.p=m,z.T=f}}function op(n,r,o,c){if(Fh){var f=lp(c);if(f===null)Gm(n,r,c,qh,o),i1(n,c);else if(ZT(f,n,r,o,c))c.stopPropagation();else if(i1(n,c),r&4&&-1<JT.indexOf(n)){for(;f!==null;){var m=q(f);if(m!==null)switch(m.tag){case 3:if(m=m.stateNode,m.current.memoizedState.isDehydrated){var v=dt(m.pendingLanes);if(v!==0){var E=m;for(E.pendingLanes|=2,E.entangledLanes|=2;v;){var B=1<<31-Oe(v);E.entanglements[1]|=B,v&=~B}va(m),(Dn&6)===0&&(jh=Et()+500,Sc(0))}}break;case 31:case 13:E=po(m,2),E!==null&&br(E,m,2),Sh(),ip(m,2)}if(m=lp(c),m===null&&Gm(n,r,c,qh,o),m===f)break;f=m}f!==null&&c.stopPropagation()}else Gm(n,r,c,null,o)}}function lp(n){return n=Pe(n),cp(n)}var qh=null;function cp(n){if(qh=null,n=Bn(n),n!==null){var r=u(n);if(r===null)n=null;else{var o=r.tag;if(o===13){if(n=h(r),n!==null)return n;n=null}else if(o===31){if(n=p(r),n!==null)return n;n=null}else if(o===3){if(r.stateNode.current.memoizedState.isDehydrated)return r.tag===3?r.stateNode.containerInfo:null;n=null}else r!==n&&(n=null)}}return qh=n,null}function a1(n){switch(n){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Pn()){case Ft:return 2;case En:return 8;case Kt:case Sn:return 32;case me:return 268435456;default:return 32}default:return 32}}var up=!1,Ii=null,Mi=null,Di=null,Dc=new Map,Pc=new Map,Pi=[],JT="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function i1(n,r){switch(n){case"focusin":case"focusout":Ii=null;break;case"dragenter":case"dragleave":Mi=null;break;case"mouseover":case"mouseout":Di=null;break;case"pointerover":case"pointerout":Dc.delete(r.pointerId);break;case"gotpointercapture":case"lostpointercapture":Pc.delete(r.pointerId)}}function Lc(n,r,o,c,f,m){return n===null||n.nativeEvent!==m?(n={blockedOn:r,domEventName:o,eventSystemFlags:c,nativeEvent:m,targetContainers:[f]},r!==null&&(r=q(r),r!==null&&s1(r)),n):(n.eventSystemFlags|=c,r=n.targetContainers,f!==null&&r.indexOf(f)===-1&&r.push(f),n)}function ZT(n,r,o,c,f){switch(r){case"focusin":return Ii=Lc(Ii,n,r,o,c,f),!0;case"dragenter":return Mi=Lc(Mi,n,r,o,c,f),!0;case"mouseover":return Di=Lc(Di,n,r,o,c,f),!0;case"pointerover":var m=f.pointerId;return Dc.set(m,Lc(Dc.get(m)||null,n,r,o,c,f)),!0;case"gotpointercapture":return m=f.pointerId,Pc.set(m,Lc(Pc.get(m)||null,n,r,o,c,f)),!0}return!1}function o1(n){var r=Bn(n.target);if(r!==null){var o=u(r);if(o!==null){if(r=o.tag,r===13){if(r=h(o),r!==null){n.blockedOn=r,xe(n.priority,function(){r1(o)});return}}else if(r===31){if(r=p(o),r!==null){n.blockedOn=r,xe(n.priority,function(){r1(o)});return}}else if(r===3&&o.stateNode.current.memoizedState.isDehydrated){n.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}n.blockedOn=null}function Hh(n){if(n.blockedOn!==null)return!1;for(var r=n.targetContainers;0<r.length;){var o=lp(n.nativeEvent);if(o===null){o=n.nativeEvent;var c=new o.constructor(o.type,o);ee=c,o.target.dispatchEvent(c),ee=null}else return r=q(o),r!==null&&s1(r),n.blockedOn=o,!1;r.shift()}return!0}function l1(n,r,o){Hh(n)&&o.delete(r)}function ej(){up=!1,Ii!==null&&Hh(Ii)&&(Ii=null),Mi!==null&&Hh(Mi)&&(Mi=null),Di!==null&&Hh(Di)&&(Di=null),Dc.forEach(l1),Pc.forEach(l1)}function $h(n,r){n.blockedOn===r&&(n.blockedOn=null,up||(up=!0,s.unstable_scheduleCallback(s.unstable_NormalPriority,ej)))}var Wh=null;function c1(n){Wh!==n&&(Wh=n,s.unstable_scheduleCallback(s.unstable_NormalPriority,function(){Wh===n&&(Wh=null);for(var r=0;r<n.length;r+=3){var o=n[r],c=n[r+1],f=n[r+2];if(typeof c!="function"){if(cp(c||o)===null)continue;break}var m=q(o);m!==null&&(n.splice(r,3),r-=3,lm(m,{pending:!0,data:f,method:o.method,action:c},c,f))}}))}function Tl(n){function r(B){return $h(B,n)}Ii!==null&&$h(Ii,n),Mi!==null&&$h(Mi,n),Di!==null&&$h(Di,n),Dc.forEach(r),Pc.forEach(r);for(var o=0;o<Pi.length;o++){var c=Pi[o];c.blockedOn===n&&(c.blockedOn=null)}for(;0<Pi.length&&(o=Pi[0],o.blockedOn===null);)o1(o),o.blockedOn===null&&Pi.shift();if(o=(n.ownerDocument||n).$$reactFormReplay,o!=null)for(c=0;c<o.length;c+=3){var f=o[c],m=o[c+1],v=f[At]||null;if(typeof m=="function")v||c1(o);else if(v){var E=null;if(m&&m.hasAttribute("formAction")){if(f=m,v=m[At]||null)E=v.formAction;else if(cp(f)!==null)continue}else E=v.action;typeof E=="function"?o[c+1]=E:(o.splice(c,3),c-=3),c1(o)}}}function u1(){function n(m){m.canIntercept&&m.info==="react-transition"&&m.intercept({handler:function(){return new Promise(function(v){return f=v})},focusReset:"manual",scroll:"manual"})}function r(){f!==null&&(f(),f=null),c||setTimeout(o,20)}function o(){if(!c&&!navigation.transition){var m=navigation.currentEntry;m&&m.url!=null&&navigation.navigate(m.url,{state:m.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var c=!1,f=null;return navigation.addEventListener("navigate",n),navigation.addEventListener("navigatesuccess",r),navigation.addEventListener("navigateerror",r),setTimeout(o,100),function(){c=!0,navigation.removeEventListener("navigate",n),navigation.removeEventListener("navigatesuccess",r),navigation.removeEventListener("navigateerror",r),f!==null&&(f(),f=null)}}}function hp(n){this._internalRoot=n}Gh.prototype.render=hp.prototype.render=function(n){var r=this._internalRoot;if(r===null)throw Error(i(409));var o=r.current,c=Ir();t1(o,c,n,r,null,null)},Gh.prototype.unmount=hp.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var r=n.containerInfo;t1(n.current,2,null,n,null,null),Sh(),r[ct]=null}};function Gh(n){this._internalRoot=n}Gh.prototype.unstable_scheduleHydration=function(n){if(n){var r=_e();n={blockedOn:null,target:n,priority:r};for(var o=0;o<Pi.length&&r!==0&&r<Pi[o].priority;o++);Pi.splice(o,0,n),o===0&&o1(n)}};var h1=e.version;if(h1!=="19.2.4")throw Error(i(527,h1,"19.2.4"));fe.findDOMNode=function(n){var r=n._reactInternals;if(r===void 0)throw typeof n.render=="function"?Error(i(188)):(n=Object.keys(n).join(","),Error(i(268,n)));return n=y(r),n=n!==null?w(n):null,n=n===null?null:n.stateNode,n};var tj={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:z,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Kh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Kh.isDisabled&&Kh.supportsFiber)try{Qe=Kh.inject(tj),Ue=Kh}catch{}}return Vc.createRoot=function(n,r){if(!l(n))throw Error(i(299));var o=!1,c="",f=bv,m=vv,v=xv;return r!=null&&(r.unstable_strictMode===!0&&(o=!0),r.identifierPrefix!==void 0&&(c=r.identifierPrefix),r.onUncaughtError!==void 0&&(f=r.onUncaughtError),r.onCaughtError!==void 0&&(m=r.onCaughtError),r.onRecoverableError!==void 0&&(v=r.onRecoverableError)),r=Z0(n,1,!1,null,null,o,c,null,f,m,v,u1),n[ct]=r.current,Wm(n),new hp(r)},Vc.hydrateRoot=function(n,r,o){if(!l(n))throw Error(i(299));var c=!1,f="",m=bv,v=vv,E=xv,B=null;return o!=null&&(o.unstable_strictMode===!0&&(c=!0),o.identifierPrefix!==void 0&&(f=o.identifierPrefix),o.onUncaughtError!==void 0&&(m=o.onUncaughtError),o.onCaughtError!==void 0&&(v=o.onCaughtError),o.onRecoverableError!==void 0&&(E=o.onRecoverableError),o.formState!==void 0&&(B=o.formState)),r=Z0(n,1,!0,r,o??null,c,f,B,m,v,E,u1),r.context=e1(null),o=r.current,c=Ir(),c=H(c),f=xi(c),f.callback=null,wi(o,f,c),o=c,r.current.lanes=o,sn(r,o),va(r),n[ct]=r.current,Wm(n),new Gh(r)},Vc.version="19.2.4",Vc}var w1;function hj(){if(w1)return mp.exports;w1=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(e){console.error(e)}}return s(),mp.exports=uj(),mp.exports}var dj=hj();const fj="modulepreload",mj=function(s){return"/login/"+s},_1={},Yr=function(e,t,i){let l=Promise.resolve();if(t&&t.length>0){let g=function(y){return Promise.all(y.map(w=>Promise.resolve(w).then(k=>({status:"fulfilled",value:k}),k=>({status:"rejected",reason:k}))))};document.getElementsByTagName("link");const h=document.querySelector("meta[property=csp-nonce]"),p=h?.nonce||h?.getAttribute("nonce");l=g(t.map(y=>{if(y=mj(y),y in _1)return;_1[y]=!0;const w=y.endsWith(".css"),k=w?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${y}"]${k}`))return;const j=document.createElement("link");if(j.rel=w?"stylesheet":fj,w||(j.as="script"),j.crossOrigin="",j.href=y,p&&j.setAttribute("nonce",p),document.head.appendChild(j),w)return new Promise((O,$)=>{j.addEventListener("load",O),j.addEventListener("error",()=>$(new Error(`Unable to preload CSS for ${y}`)))})}))}function u(h){const p=new Event("vite:preloadError",{cancelable:!0});if(p.payload=h,window.dispatchEvent(p),!p.defaultPrevented)throw h}return l.then(h=>{for(const p of h||[])p.status==="rejected"&&u(p.reason);return e().catch(u)})};var k1="popstate";function pj(s={}){function e(i,l){let{pathname:u,search:h,hash:p}=i.location;return Xp("",{pathname:u,search:h,hash:p},l.state&&l.state.usr||null,l.state&&l.state.key||"default")}function t(i,l){return typeof l=="string"?l:au(l)}return yj(e,t,null,s)}function ls(s,e){if(s===!1||s===null||typeof s>"u")throw new Error(e)}function Kr(s,e){if(!s){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function gj(){return Math.random().toString(36).substring(2,10)}function T1(s,e){return{usr:s.state,key:s.key,idx:e}}function Xp(s,e,t=null,i){return{pathname:typeof s=="string"?s:s.pathname,search:"",hash:"",...typeof e=="string"?$l(e):e,state:t,key:e&&e.key||i||gj()}}function au({pathname:s="/",search:e="",hash:t=""}){return e&&e!=="?"&&(s+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(s+=t.charAt(0)==="#"?t:"#"+t),s}function $l(s){let e={};if(s){let t=s.indexOf("#");t>=0&&(e.hash=s.substring(t),s=s.substring(0,t));let i=s.indexOf("?");i>=0&&(e.search=s.substring(i),s=s.substring(0,i)),s&&(e.pathname=s)}return e}function yj(s,e,t,i={}){let{window:l=document.defaultView,v5Compat:u=!1}=i,h=l.history,p="POP",g=null,y=w();y==null&&(y=0,h.replaceState({...h.state,idx:y},""));function w(){return(h.state||{idx:null}).idx}function k(){p="POP";let L=w(),ne=L==null?null:L-y;y=L,g&&g({action:p,location:U.location,delta:ne})}function j(L,ne){p="PUSH";let Z=Xp(U.location,L,ne);y=w()+1;let ye=T1(Z,y),je=U.createHref(Z);try{h.pushState(ye,"",je)}catch(We){if(We instanceof DOMException&&We.name==="DataCloneError")throw We;l.location.assign(je)}u&&g&&g({action:p,location:U.location,delta:1})}function O(L,ne){p="REPLACE";let Z=Xp(U.location,L,ne);y=w();let ye=T1(Z,y),je=U.createHref(Z);h.replaceState(ye,"",je),u&&g&&g({action:p,location:U.location,delta:0})}function $(L){return bj(L)}let U={get action(){return p},get location(){return s(l,h)},listen(L){if(g)throw new Error("A history only accepts one active listener");return l.addEventListener(k1,k),g=L,()=>{l.removeEventListener(k1,k),g=null}},createHref(L){return e(l,L)},createURL:$,encodeLocation(L){let ne=$(L);return{pathname:ne.pathname,search:ne.search,hash:ne.hash}},push:j,replace:O,go(L){return h.go(L)}};return U}function bj(s,e=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),ls(t,"No window.location.(origin|href) available to create URL");let i=typeof s=="string"?s:au(s);return i=i.replace(/ $/,"%20"),!e&&i.startsWith("//")&&(i=t+i),new URL(i,t)}function w2(s,e,t="/"){return vj(s,e,t,!1)}function vj(s,e,t,i){let l=typeof e=="string"?$l(e):e,u=ii(l.pathname||"/",t);if(u==null)return null;let h=_2(s);xj(h);let p=null;for(let g=0;p==null&&g<h.length;++g){let y=Aj(u);p=Cj(h[g],y,i)}return p}function _2(s,e=[],t=[],i="",l=!1){let u=(h,p,g=l,y)=>{let w={relativePath:y===void 0?h.path||"":y,caseSensitive:h.caseSensitive===!0,childrenIndex:p,route:h};if(w.relativePath.startsWith("/")){if(!w.relativePath.startsWith(i)&&g)return;ls(w.relativePath.startsWith(i),`Absolute route path "${w.relativePath}" nested under path "${i}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),w.relativePath=w.relativePath.slice(i.length)}let k=ni([i,w.relativePath]),j=t.concat(w);h.children&&h.children.length>0&&(ls(h.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${k}".`),_2(h.children,e,j,k,g)),!(h.path==null&&!h.index)&&e.push({path:k,score:Sj(k,h.index),routesMeta:j})};return s.forEach((h,p)=>{if(h.path===""||!h.path?.includes("?"))u(h,p);else for(let g of k2(h.path))u(h,p,!0,g)}),e}function k2(s){let e=s.split("/");if(e.length===0)return[];let[t,...i]=e,l=t.endsWith("?"),u=t.replace(/\?$/,"");if(i.length===0)return l?[u,""]:[u];let h=k2(i.join("/")),p=[];return p.push(...h.map(g=>g===""?u:[u,g].join("/"))),l&&p.push(...h),p.map(g=>s.startsWith("/")&&g===""?"/":g)}function xj(s){s.sort((e,t)=>e.score!==t.score?t.score-e.score:Nj(e.routesMeta.map(i=>i.childrenIndex),t.routesMeta.map(i=>i.childrenIndex)))}var wj=/^:[\w-]+$/,_j=3,kj=2,Tj=1,jj=10,Ej=-2,j1=s=>s==="*";function Sj(s,e){let t=s.split("/"),i=t.length;return t.some(j1)&&(i+=Ej),e&&(i+=kj),t.filter(l=>!j1(l)).reduce((l,u)=>l+(wj.test(u)?_j:u===""?Tj:jj),i)}function Nj(s,e){return s.length===e.length&&s.slice(0,-1).every((i,l)=>i===e[l])?s[s.length-1]-e[e.length-1]:0}function Cj(s,e,t=!1){let{routesMeta:i}=s,l={},u="/",h=[];for(let p=0;p<i.length;++p){let g=i[p],y=p===i.length-1,w=u==="/"?e:e.slice(u.length)||"/",k=_d({path:g.relativePath,caseSensitive:g.caseSensitive,end:y},w),j=g.route;if(!k&&y&&t&&!i[i.length-1].route.index&&(k=_d({path:g.relativePath,caseSensitive:g.caseSensitive,end:!1},w)),!k)return null;Object.assign(l,k.params),h.push({params:l,pathname:ni([u,k.pathname]),pathnameBase:Pj(ni([u,k.pathnameBase])),route:j}),k.pathnameBase!=="/"&&(u=ni([u,k.pathnameBase]))}return h}function _d(s,e){typeof s=="string"&&(s={path:s,caseSensitive:!1,end:!0});let[t,i]=Rj(s.path,s.caseSensitive,s.end),l=e.match(t);if(!l)return null;let u=l[0],h=u.replace(/(.)\/+$/,"$1"),p=l.slice(1);return{params:i.reduce((y,{paramName:w,isOptional:k},j)=>{if(w==="*"){let $=p[j]||"";h=u.slice(0,u.length-$.length).replace(/(.)\/+$/,"$1")}const O=p[j];return k&&!O?y[w]=void 0:y[w]=(O||"").replace(/%2F/g,"/"),y},{}),pathname:u,pathnameBase:h,pattern:s}}function Rj(s,e=!1,t=!0){Kr(s==="*"||!s.endsWith("*")||s.endsWith("/*"),`Route path "${s}" will be treated as if it were "${s.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${s.replace(/\*$/,"/*")}".`);let i=[],l="^"+s.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(h,p,g)=>(i.push({paramName:p,isOptional:g!=null}),g?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return s.endsWith("*")?(i.push({paramName:"*"}),l+=s==="*"||s==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?l+="\\/*$":s!==""&&s!=="/"&&(l+="(?:(?=\\/|$))"),[new RegExp(l,e?void 0:"i"),i]}function Aj(s){try{return s.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Kr(!1,`The URL path "${s}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),s}}function ii(s,e){if(e==="/")return s;if(!s.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,i=s.charAt(t);return i&&i!=="/"?null:s.slice(t)||"/"}var Ij=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i;function Mj(s,e="/"){let{pathname:t,search:i="",hash:l=""}=typeof s=="string"?$l(s):s,u;return t?(t=t.replace(/\/\/+/g,"/"),t.startsWith("/")?u=E1(t.substring(1),"/"):u=E1(t,e)):u=e,{pathname:u,search:Lj(i),hash:Oj(l)}}function E1(s,e){let t=e.replace(/\/+$/,"").split("/");return s.split("/").forEach(l=>{l===".."?t.length>1&&t.pop():l!=="."&&t.push(l)}),t.length>1?t.join("/"):"/"}function bp(s,e,t,i){return`Cannot include a '${s}' character in a manually specified \`to.${e}\` field [${JSON.stringify(i)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function Dj(s){return s.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function Sg(s){let e=Dj(s);return e.map((t,i)=>i===e.length-1?t.pathname:t.pathnameBase)}function Ng(s,e,t,i=!1){let l;typeof s=="string"?l=$l(s):(l={...s},ls(!l.pathname||!l.pathname.includes("?"),bp("?","pathname","search",l)),ls(!l.pathname||!l.pathname.includes("#"),bp("#","pathname","hash",l)),ls(!l.search||!l.search.includes("#"),bp("#","search","hash",l)));let u=s===""||l.pathname==="",h=u?"/":l.pathname,p;if(h==null)p=t;else{let k=e.length-1;if(!i&&h.startsWith("..")){let j=h.split("/");for(;j[0]==="..";)j.shift(),k-=1;l.pathname=j.join("/")}p=k>=0?e[k]:"/"}let g=Mj(l,p),y=h&&h!=="/"&&h.endsWith("/"),w=(u||h===".")&&t.endsWith("/");return!g.pathname.endsWith("/")&&(y||w)&&(g.pathname+="/"),g}var ni=s=>s.join("/").replace(/\/\/+/g,"/"),Pj=s=>s.replace(/\/+$/,"").replace(/^\/*/,"/"),Lj=s=>!s||s==="?"?"":s.startsWith("?")?s:"?"+s,Oj=s=>!s||s==="#"?"":s.startsWith("#")?s:"#"+s,Vj=class{constructor(s,e,t,i=!1){this.status=s,this.statusText=e||"",this.internal=i,t instanceof Error?(this.data=t.toString(),this.error=t):this.data=t}};function Bj(s){return s!=null&&typeof s.status=="number"&&typeof s.statusText=="string"&&typeof s.internal=="boolean"&&"data"in s}function Uj(s){return s.map(e=>e.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var T2=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function j2(s,e){let t=s;if(typeof t!="string"||!Ij.test(t))return{absoluteURL:void 0,isExternal:!1,to:t};let i=t,l=!1;if(T2)try{let u=new URL(window.location.href),h=t.startsWith("//")?new URL(u.protocol+t):new URL(t),p=ii(h.pathname,e);h.origin===u.origin&&p!=null?t=p+h.search+h.hash:l=!0}catch{Kr(!1,`<Link to="${t}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:i,isExternal:l,to:t}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var E2=["POST","PUT","PATCH","DELETE"];new Set(E2);var zj=["GET",...E2];new Set(zj);var Wl=x.createContext(null);Wl.displayName="DataRouter";var Wd=x.createContext(null);Wd.displayName="DataRouterState";var Fj=x.createContext(!1),S2=x.createContext({isTransitioning:!1});S2.displayName="ViewTransition";var qj=x.createContext(new Map);qj.displayName="Fetchers";var Hj=x.createContext(null);Hj.displayName="Await";var Pr=x.createContext(null);Pr.displayName="Navigation";var bu=x.createContext(null);bu.displayName="Location";var ha=x.createContext({outlet:null,matches:[],isDataRoute:!1});ha.displayName="Route";var Cg=x.createContext(null);Cg.displayName="RouteError";var N2="REACT_ROUTER_ERROR",$j="REDIRECT",Wj="ROUTE_ERROR_RESPONSE";function Gj(s){if(s.startsWith(`${N2}:${$j}:{`))try{let e=JSON.parse(s.slice(28));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.location=="string"&&typeof e.reloadDocument=="boolean"&&typeof e.replace=="boolean")return e}catch{}}function Kj(s){if(s.startsWith(`${N2}:${Wj}:{`))try{let e=JSON.parse(s.slice(40));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string")return new Vj(e.status,e.statusText,e.data)}catch{}}function Yj(s,{relative:e}={}){ls(Gl(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:i}=x.useContext(Pr),{hash:l,pathname:u,search:h}=vu(s,{relative:e}),p=u;return t!=="/"&&(p=u==="/"?t:ni([t,u])),i.createHref({pathname:p,search:h,hash:l})}function Gl(){return x.useContext(bu)!=null}function da(){return ls(Gl(),"useLocation() may be used only in the context of a <Router> component."),x.useContext(bu).location}var C2="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function R2(s){x.useContext(Pr).static||x.useLayoutEffect(s)}function nr(){let{isDataRoute:s}=x.useContext(ha);return s?cE():Qj()}function Qj(){ls(Gl(),"useNavigate() may be used only in the context of a <Router> component.");let s=x.useContext(Wl),{basename:e,navigator:t}=x.useContext(Pr),{matches:i}=x.useContext(ha),{pathname:l}=da(),u=JSON.stringify(Sg(i)),h=x.useRef(!1);return R2(()=>{h.current=!0}),x.useCallback((g,y={})=>{if(Kr(h.current,C2),!h.current)return;if(typeof g=="number"){t.go(g);return}let w=Ng(g,JSON.parse(u),l,y.relative==="path");s==null&&e!=="/"&&(w.pathname=w.pathname==="/"?e:ni([e,w.pathname])),(y.replace?t.replace:t.push)(w,y.state,y)},[e,t,u,l,s])}x.createContext(null);function Xj(){let{matches:s}=x.useContext(ha),e=s[s.length-1];return e?e.params:{}}function vu(s,{relative:e}={}){let{matches:t}=x.useContext(ha),{pathname:i}=da(),l=JSON.stringify(Sg(t));return x.useMemo(()=>Ng(s,JSON.parse(l),i,e==="path"),[s,l,i,e])}function Jj(s,e){return A2(s,e)}function A2(s,e,t,i,l){ls(Gl(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:u}=x.useContext(Pr),{matches:h}=x.useContext(ha),p=h[h.length-1],g=p?p.params:{},y=p?p.pathname:"/",w=p?p.pathnameBase:"/",k=p&&p.route;{let Z=k&&k.path||"";M2(y,!k||Z.endsWith("*")||Z.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${y}" (under <Route path="${Z}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${Z}"> to <Route path="${Z==="/"?"*":`${Z}/*`}">.`)}let j=da(),O;if(e){let Z=typeof e=="string"?$l(e):e;ls(w==="/"||Z.pathname?.startsWith(w),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${w}" but pathname "${Z.pathname}" was given in the \`location\` prop.`),O=Z}else O=j;let $=O.pathname||"/",U=$;if(w!=="/"){let Z=w.replace(/^\//,"").split("/");U="/"+$.replace(/^\//,"").split("/").slice(Z.length).join("/")}let L=w2(s,{pathname:U});Kr(k||L!=null,`No routes matched location "${O.pathname}${O.search}${O.hash}" `),Kr(L==null||L[L.length-1].route.element!==void 0||L[L.length-1].route.Component!==void 0||L[L.length-1].route.lazy!==void 0,`Matched leaf route at location "${O.pathname}${O.search}${O.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let ne=sE(L&&L.map(Z=>Object.assign({},Z,{params:Object.assign({},g,Z.params),pathname:ni([w,u.encodeLocation?u.encodeLocation(Z.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:Z.pathname]),pathnameBase:Z.pathnameBase==="/"?w:ni([w,u.encodeLocation?u.encodeLocation(Z.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:Z.pathnameBase])})),h,t,i,l);return e&&ne?x.createElement(bu.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...O},navigationType:"POP"}},ne):ne}function Zj(){let s=lE(),e=Bj(s)?`${s.status} ${s.statusText}`:s instanceof Error?s.message:JSON.stringify(s),t=s instanceof Error?s.stack:null,i="rgba(200,200,200, 0.5)",l={padding:"0.5rem",backgroundColor:i},u={padding:"2px 4px",backgroundColor:i},h=null;return console.error("Error handled by React Router default ErrorBoundary:",s),h=x.createElement(x.Fragment,null,x.createElement("p",null," Hey developer "),x.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",x.createElement("code",{style:u},"ErrorBoundary")," or"," ",x.createElement("code",{style:u},"errorElement")," prop on your route.")),x.createElement(x.Fragment,null,x.createElement("h2",null,"Unexpected Application Error!"),x.createElement("h3",{style:{fontStyle:"italic"}},e),t?x.createElement("pre",{style:l},t):null,h)}var eE=x.createElement(Zj,null),I2=class extends x.Component{constructor(s){super(s),this.state={location:s.location,revalidation:s.revalidation,error:s.error}}static getDerivedStateFromError(s){return{error:s}}static getDerivedStateFromProps(s,e){return e.location!==s.location||e.revalidation!=="idle"&&s.revalidation==="idle"?{error:s.error,location:s.location,revalidation:s.revalidation}:{error:s.error!==void 0?s.error:e.error,location:e.location,revalidation:s.revalidation||e.revalidation}}componentDidCatch(s,e){this.props.onError?this.props.onError(s,e):console.error("React Router caught the following error during render",s)}render(){let s=this.state.error;if(this.context&&typeof s=="object"&&s&&"digest"in s&&typeof s.digest=="string"){const t=Kj(s.digest);t&&(s=t)}let e=s!==void 0?x.createElement(ha.Provider,{value:this.props.routeContext},x.createElement(Cg.Provider,{value:s,children:this.props.component})):this.props.children;return this.context?x.createElement(tE,{error:s},e):e}};I2.contextType=Fj;var vp=new WeakMap;function tE({children:s,error:e}){let{basename:t}=x.useContext(Pr);if(typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){let i=Gj(e.digest);if(i){let l=vp.get(e);if(l)throw l;let u=j2(i.location,t);if(T2&&!vp.get(e))if(u.isExternal||i.reloadDocument)window.location.href=u.absoluteURL||u.to;else{const h=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(u.to,{replace:i.replace}));throw vp.set(e,h),h}return x.createElement("meta",{httpEquiv:"refresh",content:`0;url=${u.absoluteURL||u.to}`})}}return s}function nE({routeContext:s,match:e,children:t}){let i=x.useContext(Wl);return i&&i.static&&i.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=e.route.id),x.createElement(ha.Provider,{value:s},t)}function sE(s,e=[],t=null,i=null,l=null){if(s==null){if(!t)return null;if(t.errors)s=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)s=t.matches;else return null}let u=s,h=t?.errors;if(h!=null){let w=u.findIndex(k=>k.route.id&&h?.[k.route.id]!==void 0);ls(w>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(h).join(",")}`),u=u.slice(0,Math.min(u.length,w+1))}let p=!1,g=-1;if(t)for(let w=0;w<u.length;w++){let k=u[w];if((k.route.HydrateFallback||k.route.hydrateFallbackElement)&&(g=w),k.route.id){let{loaderData:j,errors:O}=t,$=k.route.loader&&!j.hasOwnProperty(k.route.id)&&(!O||O[k.route.id]===void 0);if(k.route.lazy||$){p=!0,g>=0?u=u.slice(0,g+1):u=[u[0]];break}}}let y=t&&i?(w,k)=>{i(w,{location:t.location,params:t.matches?.[0]?.params??{},unstable_pattern:Uj(t.matches),errorInfo:k})}:void 0;return u.reduceRight((w,k,j)=>{let O,$=!1,U=null,L=null;t&&(O=h&&k.route.id?h[k.route.id]:void 0,U=k.route.errorElement||eE,p&&(g<0&&j===0?(M2("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),$=!0,L=null):g===j&&($=!0,L=k.route.hydrateFallbackElement||null)));let ne=e.concat(u.slice(0,j+1)),Z=()=>{let ye;return O?ye=U:$?ye=L:k.route.Component?ye=x.createElement(k.route.Component,null):k.route.element?ye=k.route.element:ye=w,x.createElement(nE,{match:k,routeContext:{outlet:w,matches:ne,isDataRoute:t!=null},children:ye})};return t&&(k.route.ErrorBoundary||k.route.errorElement||j===0)?x.createElement(I2,{location:t.location,revalidation:t.revalidation,component:U,error:O,children:Z(),routeContext:{outlet:null,matches:ne,isDataRoute:!0},onError:y}):Z()},null)}function Rg(s){return`${s} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function rE(s){let e=x.useContext(Wl);return ls(e,Rg(s)),e}function aE(s){let e=x.useContext(Wd);return ls(e,Rg(s)),e}function iE(s){let e=x.useContext(ha);return ls(e,Rg(s)),e}function Ag(s){let e=iE(s),t=e.matches[e.matches.length-1];return ls(t.route.id,`${s} can only be used on routes that contain a unique "id"`),t.route.id}function oE(){return Ag("useRouteId")}function lE(){let s=x.useContext(Cg),e=aE("useRouteError"),t=Ag("useRouteError");return s!==void 0?s:e.errors?.[t]}function cE(){let{router:s}=rE("useNavigate"),e=Ag("useNavigate"),t=x.useRef(!1);return R2(()=>{t.current=!0}),x.useCallback(async(l,u={})=>{Kr(t.current,C2),t.current&&(typeof l=="number"?await s.navigate(l):await s.navigate(l,{fromRouteId:e,...u}))},[s,e])}var S1={};function M2(s,e,t){!e&&!S1[s]&&(S1[s]=!0,Kr(!1,t))}x.memo(uE);function uE({routes:s,future:e,state:t,onError:i}){return A2(s,void 0,t,i,e)}function hE({to:s,replace:e,state:t,relative:i}){ls(Gl(),"<Navigate> may be used only in the context of a <Router> component.");let{static:l}=x.useContext(Pr);Kr(!l,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:u}=x.useContext(ha),{pathname:h}=da(),p=nr(),g=Ng(s,Sg(u),h,i==="path"),y=JSON.stringify(g);return x.useEffect(()=>{p(JSON.parse(y),{replace:e,state:t,relative:i})},[p,y,i,e,t]),null}function hs(s){ls(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function dE({basename:s="/",children:e=null,location:t,navigationType:i="POP",navigator:l,static:u=!1,unstable_useTransitions:h}){ls(!Gl(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let p=s.replace(/^\/*/,"/"),g=x.useMemo(()=>({basename:p,navigator:l,static:u,unstable_useTransitions:h,future:{}}),[p,l,u,h]);typeof t=="string"&&(t=$l(t));let{pathname:y="/",search:w="",hash:k="",state:j=null,key:O="default"}=t,$=x.useMemo(()=>{let U=ii(y,p);return U==null?null:{location:{pathname:U,search:w,hash:k,state:j,key:O},navigationType:i}},[p,y,w,k,j,O,i]);return Kr($!=null,`<Router basename="${p}"> is not able to match the URL "${y}${w}${k}" because it does not start with the basename, so the <Router> won't render anything.`),$==null?null:x.createElement(Pr.Provider,{value:g},x.createElement(bu.Provider,{children:e,value:$}))}function fE({children:s,location:e}){return Jj(Jp(s),e)}function Jp(s,e=[]){let t=[];return x.Children.forEach(s,(i,l)=>{if(!x.isValidElement(i))return;let u=[...e,l];if(i.type===x.Fragment){t.push.apply(t,Jp(i.props.children,u));return}ls(i.type===hs,`[${typeof i.type=="string"?i.type:i.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),ls(!i.props.index||!i.props.children,"An index route cannot have child routes.");let h={id:i.props.id||u.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,middleware:i.props.middleware,loader:i.props.loader,action:i.props.action,hydrateFallbackElement:i.props.hydrateFallbackElement,HydrateFallback:i.props.HydrateFallback,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.hasErrorBoundary===!0||i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(h.children=Jp(i.props.children,u)),t.push(h)}),t}var ud="get",hd="application/x-www-form-urlencoded";function Gd(s){return typeof HTMLElement<"u"&&s instanceof HTMLElement}function mE(s){return Gd(s)&&s.tagName.toLowerCase()==="button"}function pE(s){return Gd(s)&&s.tagName.toLowerCase()==="form"}function gE(s){return Gd(s)&&s.tagName.toLowerCase()==="input"}function yE(s){return!!(s.metaKey||s.altKey||s.ctrlKey||s.shiftKey)}function bE(s,e){return s.button===0&&(!e||e==="_self")&&!yE(s)}function Zp(s=""){return new URLSearchParams(typeof s=="string"||Array.isArray(s)||s instanceof URLSearchParams?s:Object.keys(s).reduce((e,t)=>{let i=s[t];return e.concat(Array.isArray(i)?i.map(l=>[t,l]):[[t,i]])},[]))}function vE(s,e){let t=Zp(s);return e&&e.forEach((i,l)=>{t.has(l)||e.getAll(l).forEach(u=>{t.append(l,u)})}),t}var Yh=null;function xE(){if(Yh===null)try{new FormData(document.createElement("form"),0),Yh=!1}catch{Yh=!0}return Yh}var wE=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function xp(s){return s!=null&&!wE.has(s)?(Kr(!1,`"${s}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${hd}"`),null):s}function _E(s,e){let t,i,l,u,h;if(pE(s)){let p=s.getAttribute("action");i=p?ii(p,e):null,t=s.getAttribute("method")||ud,l=xp(s.getAttribute("enctype"))||hd,u=new FormData(s)}else if(mE(s)||gE(s)&&(s.type==="submit"||s.type==="image")){let p=s.form;if(p==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let g=s.getAttribute("formaction")||p.getAttribute("action");if(i=g?ii(g,e):null,t=s.getAttribute("formmethod")||p.getAttribute("method")||ud,l=xp(s.getAttribute("formenctype"))||xp(p.getAttribute("enctype"))||hd,u=new FormData(p,s),!xE()){let{name:y,type:w,value:k}=s;if(w==="image"){let j=y?`${y}.`:"";u.append(`${j}x`,"0"),u.append(`${j}y`,"0")}else y&&u.append(y,k)}}else{if(Gd(s))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=ud,i=null,l=hd,h=s}return u&&l==="text/plain"&&(h=u,u=void 0),{action:i,method:t.toLowerCase(),encType:l,formData:u,body:h}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function Ig(s,e){if(s===!1||s===null||typeof s>"u")throw new Error(e)}function kE(s,e,t,i){let l=typeof s=="string"?new URL(s,typeof window>"u"?"server://singlefetch/":window.location.origin):s;return t?l.pathname.endsWith("/")?l.pathname=`${l.pathname}_.${i}`:l.pathname=`${l.pathname}.${i}`:l.pathname==="/"?l.pathname=`_root.${i}`:e&&ii(l.pathname,e)==="/"?l.pathname=`${e.replace(/\/$/,"")}/_root.${i}`:l.pathname=`${l.pathname.replace(/\/$/,"")}.${i}`,l}async function TE(s,e){if(s.id in e)return e[s.id];try{let t=await import(s.module);return e[s.id]=t,t}catch(t){return console.error(`Error loading route module \`${s.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function jE(s){return s==null?!1:s.href==null?s.rel==="preload"&&typeof s.imageSrcSet=="string"&&typeof s.imageSizes=="string":typeof s.rel=="string"&&typeof s.href=="string"}async function EE(s,e,t){let i=await Promise.all(s.map(async l=>{let u=e.routes[l.route.id];if(u){let h=await TE(u,t);return h.links?h.links():[]}return[]}));return RE(i.flat(1).filter(jE).filter(l=>l.rel==="stylesheet"||l.rel==="preload").map(l=>l.rel==="stylesheet"?{...l,rel:"prefetch",as:"style"}:{...l,rel:"prefetch"}))}function N1(s,e,t,i,l,u){let h=(g,y)=>t[y]?g.route.id!==t[y].route.id:!0,p=(g,y)=>t[y].pathname!==g.pathname||t[y].route.path?.endsWith("*")&&t[y].params["*"]!==g.params["*"];return u==="assets"?e.filter((g,y)=>h(g,y)||p(g,y)):u==="data"?e.filter((g,y)=>{let w=i.routes[g.route.id];if(!w||!w.hasLoader)return!1;if(h(g,y)||p(g,y))return!0;if(g.route.shouldRevalidate){let k=g.route.shouldRevalidate({currentUrl:new URL(l.pathname+l.search+l.hash,window.origin),currentParams:t[0]?.params||{},nextUrl:new URL(s,window.origin),nextParams:g.params,defaultShouldRevalidate:!0});if(typeof k=="boolean")return k}return!0}):[]}function SE(s,e,{includeHydrateFallback:t}={}){return NE(s.map(i=>{let l=e.routes[i.route.id];if(!l)return[];let u=[l.module];return l.clientActionModule&&(u=u.concat(l.clientActionModule)),l.clientLoaderModule&&(u=u.concat(l.clientLoaderModule)),t&&l.hydrateFallbackModule&&(u=u.concat(l.hydrateFallbackModule)),l.imports&&(u=u.concat(l.imports)),u}).flat(1))}function NE(s){return[...new Set(s)]}function CE(s){let e={},t=Object.keys(s).sort();for(let i of t)e[i]=s[i];return e}function RE(s,e){let t=new Set;return new Set(e),s.reduce((i,l)=>{let u=JSON.stringify(CE(l));return t.has(u)||(t.add(u),i.push({key:u,link:l})),i},[])}function D2(){let s=x.useContext(Wl);return Ig(s,"You must render this element inside a <DataRouterContext.Provider> element"),s}function AE(){let s=x.useContext(Wd);return Ig(s,"You must render this element inside a <DataRouterStateContext.Provider> element"),s}var Mg=x.createContext(void 0);Mg.displayName="FrameworkContext";function P2(){let s=x.useContext(Mg);return Ig(s,"You must render this element inside a <HydratedRouter> element"),s}function IE(s,e){let t=x.useContext(Mg),[i,l]=x.useState(!1),[u,h]=x.useState(!1),{onFocus:p,onBlur:g,onMouseEnter:y,onMouseLeave:w,onTouchStart:k}=e,j=x.useRef(null);x.useEffect(()=>{if(s==="render"&&h(!0),s==="viewport"){let U=ne=>{ne.forEach(Z=>{h(Z.isIntersecting)})},L=new IntersectionObserver(U,{threshold:.5});return j.current&&L.observe(j.current),()=>{L.disconnect()}}},[s]),x.useEffect(()=>{if(i){let U=setTimeout(()=>{h(!0)},100);return()=>{clearTimeout(U)}}},[i]);let O=()=>{l(!0)},$=()=>{l(!1),h(!1)};return t?s!=="intent"?[u,j,{}]:[u,j,{onFocus:Bc(p,O),onBlur:Bc(g,$),onMouseEnter:Bc(y,O),onMouseLeave:Bc(w,$),onTouchStart:Bc(k,O)}]:[!1,j,{}]}function Bc(s,e){return t=>{s&&s(t),t.defaultPrevented||e(t)}}function ME({page:s,...e}){let{router:t}=D2(),i=x.useMemo(()=>w2(t.routes,s,t.basename),[t.routes,s,t.basename]);return i?x.createElement(PE,{page:s,matches:i,...e}):null}function DE(s){let{manifest:e,routeModules:t}=P2(),[i,l]=x.useState([]);return x.useEffect(()=>{let u=!1;return EE(s,e,t).then(h=>{u||l(h)}),()=>{u=!0}},[s,e,t]),i}function PE({page:s,matches:e,...t}){let i=da(),{future:l,manifest:u,routeModules:h}=P2(),{basename:p}=D2(),{loaderData:g,matches:y}=AE(),w=x.useMemo(()=>N1(s,e,y,u,i,"data"),[s,e,y,u,i]),k=x.useMemo(()=>N1(s,e,y,u,i,"assets"),[s,e,y,u,i]),j=x.useMemo(()=>{if(s===i.pathname+i.search+i.hash)return[];let U=new Set,L=!1;if(e.forEach(Z=>{let ye=u.routes[Z.route.id];!ye||!ye.hasLoader||(!w.some(je=>je.route.id===Z.route.id)&&Z.route.id in g&&h[Z.route.id]?.shouldRevalidate||ye.hasClientLoader?L=!0:U.add(Z.route.id))}),U.size===0)return[];let ne=kE(s,p,l.unstable_trailingSlashAwareDataRequests,"data");return L&&U.size>0&&ne.searchParams.set("_routes",e.filter(Z=>U.has(Z.route.id)).map(Z=>Z.route.id).join(",")),[ne.pathname+ne.search]},[p,l.unstable_trailingSlashAwareDataRequests,g,i,u,w,e,s,h]),O=x.useMemo(()=>SE(k,u),[k,u]),$=DE(k);return x.createElement(x.Fragment,null,j.map(U=>x.createElement("link",{key:U,rel:"prefetch",as:"fetch",href:U,...t})),O.map(U=>x.createElement("link",{key:U,rel:"modulepreload",href:U,...t})),$.map(({key:U,link:L})=>x.createElement("link",{key:U,nonce:t.nonce,...L,crossOrigin:L.crossOrigin??t.crossOrigin})))}function LE(...s){return e=>{s.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var OE=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{OE&&(window.__reactRouterVersion="7.13.0")}catch{}function VE({basename:s,children:e,unstable_useTransitions:t,window:i}){let l=x.useRef();l.current==null&&(l.current=pj({window:i,v5Compat:!0}));let u=l.current,[h,p]=x.useState({action:u.action,location:u.location}),g=x.useCallback(y=>{t===!1?p(y):x.startTransition(()=>p(y))},[t]);return x.useLayoutEffect(()=>u.listen(g),[u,g]),x.createElement(dE,{basename:s,children:e,location:h.location,navigationType:h.action,navigator:u,unstable_useTransitions:t})}var L2=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,O2=x.forwardRef(function({onClick:e,discover:t="render",prefetch:i="none",relative:l,reloadDocument:u,replace:h,state:p,target:g,to:y,preventScrollReset:w,viewTransition:k,unstable_defaultShouldRevalidate:j,...O},$){let{basename:U,unstable_useTransitions:L}=x.useContext(Pr),ne=typeof y=="string"&&L2.test(y),Z=j2(y,U);y=Z.to;let ye=Yj(y,{relative:l}),[je,We,Be]=IE(i,O),R=FE(y,{replace:h,state:p,target:g,preventScrollReset:w,relative:l,viewTransition:k,unstable_defaultShouldRevalidate:j,unstable_useTransitions:L});function S(V){e&&e(V),V.defaultPrevented||R(V)}let I=x.createElement("a",{...O,...Be,href:Z.absoluteURL||ye,onClick:Z.isExternal||u?e:S,ref:LE($,We),target:g,"data-discover":!ne&&t==="render"?"true":void 0});return je&&!ne?x.createElement(x.Fragment,null,I,x.createElement(ME,{page:ye})):I});O2.displayName="Link";var BE=x.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:i="",end:l=!1,style:u,to:h,viewTransition:p,children:g,...y},w){let k=vu(h,{relative:y.relative}),j=da(),O=x.useContext(Wd),{navigator:$,basename:U}=x.useContext(Pr),L=O!=null&&KE(k)&&p===!0,ne=$.encodeLocation?$.encodeLocation(k).pathname:k.pathname,Z=j.pathname,ye=O&&O.navigation&&O.navigation.location?O.navigation.location.pathname:null;t||(Z=Z.toLowerCase(),ye=ye?ye.toLowerCase():null,ne=ne.toLowerCase()),ye&&U&&(ye=ii(ye,U)||ye);const je=ne!=="/"&&ne.endsWith("/")?ne.length-1:ne.length;let We=Z===ne||!l&&Z.startsWith(ne)&&Z.charAt(je)==="/",Be=ye!=null&&(ye===ne||!l&&ye.startsWith(ne)&&ye.charAt(ne.length)==="/"),R={isActive:We,isPending:Be,isTransitioning:L},S=We?e:void 0,I;typeof i=="function"?I=i(R):I=[i,We?"active":null,Be?"pending":null,L?"transitioning":null].filter(Boolean).join(" ");let V=typeof u=="function"?u(R):u;return x.createElement(O2,{...y,"aria-current":S,className:I,ref:w,style:V,to:h,viewTransition:p},typeof g=="function"?g(R):g)});BE.displayName="NavLink";var UE=x.forwardRef(({discover:s="render",fetcherKey:e,navigate:t,reloadDocument:i,replace:l,state:u,method:h=ud,action:p,onSubmit:g,relative:y,preventScrollReset:w,viewTransition:k,unstable_defaultShouldRevalidate:j,...O},$)=>{let{unstable_useTransitions:U}=x.useContext(Pr),L=WE(),ne=GE(p,{relative:y}),Z=h.toLowerCase()==="get"?"get":"post",ye=typeof p=="string"&&L2.test(p),je=We=>{if(g&&g(We),We.defaultPrevented)return;We.preventDefault();let Be=We.nativeEvent.submitter,R=Be?.getAttribute("formmethod")||h,S=()=>L(Be||We.currentTarget,{fetcherKey:e,method:R,navigate:t,replace:l,state:u,relative:y,preventScrollReset:w,viewTransition:k,unstable_defaultShouldRevalidate:j});U&&t!==!1?x.startTransition(()=>S()):S()};return x.createElement("form",{ref:$,method:Z,action:ne,onSubmit:i?g:je,...O,"data-discover":!ye&&s==="render"?"true":void 0})});UE.displayName="Form";function zE(s){return`${s} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function V2(s){let e=x.useContext(Wl);return ls(e,zE(s)),e}function FE(s,{target:e,replace:t,state:i,preventScrollReset:l,relative:u,viewTransition:h,unstable_defaultShouldRevalidate:p,unstable_useTransitions:g}={}){let y=nr(),w=da(),k=vu(s,{relative:u});return x.useCallback(j=>{if(bE(j,e)){j.preventDefault();let O=t!==void 0?t:au(w)===au(k),$=()=>y(s,{replace:O,state:i,preventScrollReset:l,relative:u,viewTransition:h,unstable_defaultShouldRevalidate:p});g?x.startTransition(()=>$()):$()}},[w,y,k,t,i,e,s,l,u,h,p,g])}function qE(s){Kr(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let e=x.useRef(Zp(s)),t=x.useRef(!1),i=da(),l=x.useMemo(()=>vE(i.search,t.current?null:e.current),[i.search]),u=nr(),h=x.useCallback((p,g)=>{const y=Zp(typeof p=="function"?p(new URLSearchParams(l)):p);t.current=!0,u("?"+y,g)},[u,l]);return[l,h]}var HE=0,$E=()=>`__${String(++HE)}__`;function WE(){let{router:s}=V2("useSubmit"),{basename:e}=x.useContext(Pr),t=oE(),i=s.fetch,l=s.navigate;return x.useCallback(async(u,h={})=>{let{action:p,method:g,encType:y,formData:w,body:k}=_E(u,e);if(h.navigate===!1){let j=h.fetcherKey||$E();await i(j,t,h.action||p,{unstable_defaultShouldRevalidate:h.unstable_defaultShouldRevalidate,preventScrollReset:h.preventScrollReset,formData:w,body:k,formMethod:h.method||g,formEncType:h.encType||y,flushSync:h.flushSync})}else await l(h.action||p,{unstable_defaultShouldRevalidate:h.unstable_defaultShouldRevalidate,preventScrollReset:h.preventScrollReset,formData:w,body:k,formMethod:h.method||g,formEncType:h.encType||y,replace:h.replace,state:h.state,fromRouteId:t,flushSync:h.flushSync,viewTransition:h.viewTransition})},[i,l,e,t])}function GE(s,{relative:e}={}){let{basename:t}=x.useContext(Pr),i=x.useContext(ha);ls(i,"useFormAction must be used inside a RouteContext");let[l]=i.matches.slice(-1),u={...vu(s||".",{relative:e})},h=da();if(s==null){u.search=h.search;let p=new URLSearchParams(u.search),g=p.getAll("index");if(g.some(w=>w==="")){p.delete("index"),g.filter(k=>k).forEach(k=>p.append("index",k));let w=p.toString();u.search=w?`?${w}`:""}}return(!s||s===".")&&l.route.index&&(u.search=u.search?u.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(u.pathname=u.pathname==="/"?t:ni([t,u.pathname])),au(u)}function KE(s,{relative:e}={}){let t=x.useContext(S2);ls(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:i}=V2("useViewTransitionState"),l=vu(s,{relative:e});if(!t.isTransitioning)return!1;let u=ii(t.currentLocation.pathname,i)||t.currentLocation.pathname,h=ii(t.nextLocation.pathname,i)||t.nextLocation.pathname;return _d(l.pathname,h)!=null||_d(l.pathname,u)!=null}const YE=()=>{};var C1={};const B2=function(s){const e=[];let t=0;for(let i=0;i<s.length;i++){let l=s.charCodeAt(i);l<128?e[t++]=l:l<2048?(e[t++]=l>>6|192,e[t++]=l&63|128):(l&64512)===55296&&i+1<s.length&&(s.charCodeAt(i+1)&64512)===56320?(l=65536+((l&1023)<<10)+(s.charCodeAt(++i)&1023),e[t++]=l>>18|240,e[t++]=l>>12&63|128,e[t++]=l>>6&63|128,e[t++]=l&63|128):(e[t++]=l>>12|224,e[t++]=l>>6&63|128,e[t++]=l&63|128)}return e},QE=function(s){const e=[];let t=0,i=0;for(;t<s.length;){const l=s[t++];if(l<128)e[i++]=String.fromCharCode(l);else if(l>191&&l<224){const u=s[t++];e[i++]=String.fromCharCode((l&31)<<6|u&63)}else if(l>239&&l<365){const u=s[t++],h=s[t++],p=s[t++],g=((l&7)<<18|(u&63)<<12|(h&63)<<6|p&63)-65536;e[i++]=String.fromCharCode(55296+(g>>10)),e[i++]=String.fromCharCode(56320+(g&1023))}else{const u=s[t++],h=s[t++];e[i++]=String.fromCharCode((l&15)<<12|(u&63)<<6|h&63)}}return e.join("")},U2={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(s,e){if(!Array.isArray(s))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let l=0;l<s.length;l+=3){const u=s[l],h=l+1<s.length,p=h?s[l+1]:0,g=l+2<s.length,y=g?s[l+2]:0,w=u>>2,k=(u&3)<<4|p>>4;let j=(p&15)<<2|y>>6,O=y&63;g||(O=64,h||(j=64)),i.push(t[w],t[k],t[j],t[O])}return i.join("")},encodeString(s,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(s):this.encodeByteArray(B2(s),e)},decodeString(s,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(s):QE(this.decodeStringToByteArray(s,e))},decodeStringToByteArray(s,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let l=0;l<s.length;){const u=t[s.charAt(l++)],p=l<s.length?t[s.charAt(l)]:0;++l;const y=l<s.length?t[s.charAt(l)]:64;++l;const k=l<s.length?t[s.charAt(l)]:64;if(++l,u==null||p==null||y==null||k==null)throw new XE;const j=u<<2|p>>4;if(i.push(j),y!==64){const O=p<<4&240|y>>2;if(i.push(O),k!==64){const $=y<<6&192|k;i.push($)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let s=0;s<this.ENCODED_VALS.length;s++)this.byteToCharMap_[s]=this.ENCODED_VALS.charAt(s),this.charToByteMap_[this.byteToCharMap_[s]]=s,this.byteToCharMapWebSafe_[s]=this.ENCODED_VALS_WEBSAFE.charAt(s),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[s]]=s,s>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(s)]=s,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(s)]=s)}}};class XE extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const JE=function(s){const e=B2(s);return U2.encodeByteArray(e,!0)},kd=function(s){return JE(s).replace(/\./g,"")},z2=function(s){try{return U2.decodeString(s,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function ZE(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const eS=()=>ZE().__FIREBASE_DEFAULTS__,tS=()=>{if(typeof process>"u"||typeof C1>"u")return;const s=C1.__FIREBASE_DEFAULTS__;if(s)return JSON.parse(s)},nS=()=>{if(typeof document>"u")return;let s;try{s=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=s&&z2(s[1]);return e&&JSON.parse(e)},Kd=()=>{try{return YE()||eS()||tS()||nS()}catch(s){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${s}`);return}},F2=s=>Kd()?.emulatorHosts?.[s],q2=s=>{const e=F2(s);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),i]:[e.substring(0,t),i]},H2=()=>Kd()?.config,$2=s=>Kd()?.[`_${s}`];class sS{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}}function io(s){try{return(s.startsWith("http://")||s.startsWith("https://")?new URL(s).hostname:s).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Dg(s){return(await fetch(s,{credentials:"include"})).ok}function W2(s,e){if(s.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},i=e||"demo-project",l=s.iat||0,u=s.sub||s.user_id;if(!u)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const h={iss:`https://securetoken.google.com/${i}`,aud:i,iat:l,exp:l+3600,auth_time:l,sub:u,user_id:u,firebase:{sign_in_provider:"custom",identities:{}},...s};return[kd(JSON.stringify(t)),kd(JSON.stringify(h)),""].join(".")}const Xc={};function rS(){const s={prod:[],emulator:[]};for(const e of Object.keys(Xc))Xc[e]?s.emulator.push(e):s.prod.push(e);return s}function aS(s){let e=document.getElementById(s),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",s),t=!0),{created:t,element:e}}let R1=!1;function Pg(s,e){if(typeof window>"u"||typeof document>"u"||!io(window.location.host)||Xc[s]===e||Xc[s]||R1)return;Xc[s]=e;function t(j){return`__firebase__banner__${j}`}const i="__firebase__banner",u=rS().prod.length>0;function h(){const j=document.getElementById(i);j&&j.remove()}function p(j){j.style.display="flex",j.style.background="#7faaf0",j.style.position="fixed",j.style.bottom="5px",j.style.left="5px",j.style.padding=".5em",j.style.borderRadius="5px",j.style.alignItems="center"}function g(j,O){j.setAttribute("width","24"),j.setAttribute("id",O),j.setAttribute("height","24"),j.setAttribute("viewBox","0 0 24 24"),j.setAttribute("fill","none"),j.style.marginLeft="-6px"}function y(){const j=document.createElement("span");return j.style.cursor="pointer",j.style.marginLeft="16px",j.style.fontSize="24px",j.innerHTML=" &times;",j.onclick=()=>{R1=!0,h()},j}function w(j,O){j.setAttribute("id",O),j.innerText="Learn more",j.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",j.setAttribute("target","__blank"),j.style.paddingLeft="5px",j.style.textDecoration="underline"}function k(){const j=aS(i),O=t("text"),$=document.getElementById(O)||document.createElement("span"),U=t("learnmore"),L=document.getElementById(U)||document.createElement("a"),ne=t("preprendIcon"),Z=document.getElementById(ne)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(j.created){const ye=j.element;p(ye),w(L,U);const je=y();g(Z,ne),ye.append(Z,$,L,je),document.body.appendChild(ye)}u?($.innerText="Preview backend disconnected.",Z.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(Z.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,$.innerText="Preview backend running in this workspace."),$.setAttribute("id",O)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",k):k()}function tr(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function iS(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(tr())}function oS(){const s=Kd()?.forceEnvironment;if(s==="node")return!0;if(s==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function lS(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function cS(){const s=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof s=="object"&&s.id!==void 0}function uS(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function hS(){const s=tr();return s.indexOf("MSIE ")>=0||s.indexOf("Trident/")>=0}function dS(){return!oS()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function fS(){try{return typeof indexedDB=="object"}catch{return!1}}function mS(){return new Promise((s,e)=>{try{let t=!0;const i="validate-browser-context-for-indexeddb-analytics-module",l=self.indexedDB.open(i);l.onsuccess=()=>{l.result.close(),t||self.indexedDB.deleteDatabase(i),s(!0)},l.onupgradeneeded=()=>{t=!1},l.onerror=()=>{e(l.error?.message||"")}}catch(t){e(t)}})}const pS="FirebaseError";class Ia extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=pS,Object.setPrototypeOf(this,Ia.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,xu.prototype.create)}}class xu{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){const i=t[0]||{},l=`${this.service}/${e}`,u=this.errors[e],h=u?gS(u,i):"Error",p=`${this.serviceName}: ${h} (${l}).`;return new Ia(l,p,i)}}function gS(s,e){return s.replace(yS,(t,i)=>{const l=e[i];return l!=null?String(l):`<${i}?>`})}const yS=/\{\$([^}]+)}/g;function bS(s){for(const e in s)if(Object.prototype.hasOwnProperty.call(s,e))return!1;return!0}function Oo(s,e){if(s===e)return!0;const t=Object.keys(s),i=Object.keys(e);for(const l of t){if(!i.includes(l))return!1;const u=s[l],h=e[l];if(A1(u)&&A1(h)){if(!Oo(u,h))return!1}else if(u!==h)return!1}for(const l of i)if(!t.includes(l))return!1;return!0}function A1(s){return s!==null&&typeof s=="object"}function wu(s){const e=[];for(const[t,i]of Object.entries(s))Array.isArray(i)?i.forEach(l=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(l))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function $c(s){const e={};return s.replace(/^\?/,"").split("&").forEach(i=>{if(i){const[l,u]=i.split("=");e[decodeURIComponent(l)]=decodeURIComponent(u)}}),e}function Wc(s){const e=s.indexOf("?");if(!e)return"";const t=s.indexOf("#",e);return s.substring(e,t>0?t:void 0)}function vS(s,e){const t=new xS(s,e);return t.subscribe.bind(t)}class xS{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,i){let l;if(e===void 0&&t===void 0&&i===void 0)throw new Error("Missing Observer.");wS(e,["next","error","complete"])?l=e:l={next:e,error:t,complete:i},l.next===void 0&&(l.next=wp),l.error===void 0&&(l.error=wp),l.complete===void 0&&(l.complete=wp);const u=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?l.error(this.finalError):l.complete()}catch{}}),this.observers.push(l),u}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function wS(s,e){if(typeof s!="object"||s===null)return!1;for(const t of e)if(t in s&&typeof s[t]=="function")return!0;return!1}function wp(){}function Qn(s){return s&&s._delegate?s._delegate:s}class Zi{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const Ro="[DEFAULT]";class _S{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const i=new sS;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{const l=this.getOrInitializeService({instanceIdentifier:t});l&&i.resolve(l)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),i=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(l){if(i)return null;throw l}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(TS(e))try{this.getOrInitializeService({instanceIdentifier:Ro})}catch{}for(const[t,i]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(t);try{const u=this.getOrInitializeService({instanceIdentifier:l});i.resolve(u)}catch{}}}}clearInstance(e=Ro){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Ro){return this.instances.has(e)}getOptions(e=Ro){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const l=this.getOrInitializeService({instanceIdentifier:i,options:t});for(const[u,h]of this.instancesDeferred.entries()){const p=this.normalizeInstanceIdentifier(u);i===p&&h.resolve(l)}return l}onInit(e,t){const i=this.normalizeInstanceIdentifier(t),l=this.onInitCallbacks.get(i)??new Set;l.add(e),this.onInitCallbacks.set(i,l);const u=this.instances.get(i);return u&&e(u,i),()=>{l.delete(e)}}invokeOnInitCallbacks(e,t){const i=this.onInitCallbacks.get(t);if(i)for(const l of i)try{l(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:kS(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=Ro){return this.component?this.component.multipleInstances?e:Ro:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function kS(s){return s===Ro?void 0:s}function TS(s){return s.instantiationMode==="EAGER"}class jS{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new _S(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}var fn;(function(s){s[s.DEBUG=0]="DEBUG",s[s.VERBOSE=1]="VERBOSE",s[s.INFO=2]="INFO",s[s.WARN=3]="WARN",s[s.ERROR=4]="ERROR",s[s.SILENT=5]="SILENT"})(fn||(fn={}));const ES={debug:fn.DEBUG,verbose:fn.VERBOSE,info:fn.INFO,warn:fn.WARN,error:fn.ERROR,silent:fn.SILENT},SS=fn.INFO,NS={[fn.DEBUG]:"log",[fn.VERBOSE]:"log",[fn.INFO]:"info",[fn.WARN]:"warn",[fn.ERROR]:"error"},CS=(s,e,...t)=>{if(e<s.logLevel)return;const i=new Date().toISOString(),l=NS[e];if(l)console[l](`[${i}]  ${s.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Lg{constructor(e){this.name=e,this._logLevel=SS,this._logHandler=CS,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in fn))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?ES[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,fn.DEBUG,...e),this._logHandler(this,fn.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,fn.VERBOSE,...e),this._logHandler(this,fn.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,fn.INFO,...e),this._logHandler(this,fn.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,fn.WARN,...e),this._logHandler(this,fn.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,fn.ERROR,...e),this._logHandler(this,fn.ERROR,...e)}}const RS=(s,e)=>e.some(t=>s instanceof t);let I1,M1;function AS(){return I1||(I1=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function IS(){return M1||(M1=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const G2=new WeakMap,eg=new WeakMap,K2=new WeakMap,_p=new WeakMap,Og=new WeakMap;function MS(s){const e=new Promise((t,i)=>{const l=()=>{s.removeEventListener("success",u),s.removeEventListener("error",h)},u=()=>{t(Yi(s.result)),l()},h=()=>{i(s.error),l()};s.addEventListener("success",u),s.addEventListener("error",h)});return e.then(t=>{t instanceof IDBCursor&&G2.set(t,s)}).catch(()=>{}),Og.set(e,s),e}function DS(s){if(eg.has(s))return;const e=new Promise((t,i)=>{const l=()=>{s.removeEventListener("complete",u),s.removeEventListener("error",h),s.removeEventListener("abort",h)},u=()=>{t(),l()},h=()=>{i(s.error||new DOMException("AbortError","AbortError")),l()};s.addEventListener("complete",u),s.addEventListener("error",h),s.addEventListener("abort",h)});eg.set(s,e)}let tg={get(s,e,t){if(s instanceof IDBTransaction){if(e==="done")return eg.get(s);if(e==="objectStoreNames")return s.objectStoreNames||K2.get(s);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Yi(s[e])},set(s,e,t){return s[e]=t,!0},has(s,e){return s instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in s}};function PS(s){tg=s(tg)}function LS(s){return s===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const i=s.call(kp(this),e,...t);return K2.set(i,e.sort?e.sort():[e]),Yi(i)}:IS().includes(s)?function(...e){return s.apply(kp(this),e),Yi(G2.get(this))}:function(...e){return Yi(s.apply(kp(this),e))}}function OS(s){return typeof s=="function"?LS(s):(s instanceof IDBTransaction&&DS(s),RS(s,AS())?new Proxy(s,tg):s)}function Yi(s){if(s instanceof IDBRequest)return MS(s);if(_p.has(s))return _p.get(s);const e=OS(s);return e!==s&&(_p.set(s,e),Og.set(e,s)),e}const kp=s=>Og.get(s);function VS(s,e,{blocked:t,upgrade:i,blocking:l,terminated:u}={}){const h=indexedDB.open(s,e),p=Yi(h);return i&&h.addEventListener("upgradeneeded",g=>{i(Yi(h.result),g.oldVersion,g.newVersion,Yi(h.transaction),g)}),t&&h.addEventListener("blocked",g=>t(g.oldVersion,g.newVersion,g)),p.then(g=>{u&&g.addEventListener("close",()=>u()),l&&g.addEventListener("versionchange",y=>l(y.oldVersion,y.newVersion,y))}).catch(()=>{}),p}const BS=["get","getKey","getAll","getAllKeys","count"],US=["put","add","delete","clear"],Tp=new Map;function D1(s,e){if(!(s instanceof IDBDatabase&&!(e in s)&&typeof e=="string"))return;if(Tp.get(e))return Tp.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,l=US.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(l||BS.includes(t)))return;const u=async function(h,...p){const g=this.transaction(h,l?"readwrite":"readonly");let y=g.store;return i&&(y=y.index(p.shift())),(await Promise.all([y[t](...p),l&&g.done]))[0]};return Tp.set(e,u),u}PS(s=>({...s,get:(e,t,i)=>D1(e,t)||s.get(e,t,i),has:(e,t)=>!!D1(e,t)||s.has(e,t)}));class zS{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(FS(t)){const i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}}function FS(s){return s.getComponent()?.type==="VERSION"}const ng="@firebase/app",P1="0.14.7";const oi=new Lg("@firebase/app"),qS="@firebase/app-compat",HS="@firebase/analytics-compat",$S="@firebase/analytics",WS="@firebase/app-check-compat",GS="@firebase/app-check",KS="@firebase/auth",YS="@firebase/auth-compat",QS="@firebase/database",XS="@firebase/data-connect",JS="@firebase/database-compat",ZS="@firebase/functions",eN="@firebase/functions-compat",tN="@firebase/installations",nN="@firebase/installations-compat",sN="@firebase/messaging",rN="@firebase/messaging-compat",aN="@firebase/performance",iN="@firebase/performance-compat",oN="@firebase/remote-config",lN="@firebase/remote-config-compat",cN="@firebase/storage",uN="@firebase/storage-compat",hN="@firebase/firestore",dN="@firebase/ai",fN="@firebase/firestore-compat",mN="firebase",pN="12.8.0";const sg="[DEFAULT]",gN={[ng]:"fire-core",[qS]:"fire-core-compat",[$S]:"fire-analytics",[HS]:"fire-analytics-compat",[GS]:"fire-app-check",[WS]:"fire-app-check-compat",[KS]:"fire-auth",[YS]:"fire-auth-compat",[QS]:"fire-rtdb",[XS]:"fire-data-connect",[JS]:"fire-rtdb-compat",[ZS]:"fire-fn",[eN]:"fire-fn-compat",[tN]:"fire-iid",[nN]:"fire-iid-compat",[sN]:"fire-fcm",[rN]:"fire-fcm-compat",[aN]:"fire-perf",[iN]:"fire-perf-compat",[oN]:"fire-rc",[lN]:"fire-rc-compat",[cN]:"fire-gcs",[uN]:"fire-gcs-compat",[hN]:"fire-fst",[fN]:"fire-fst-compat",[dN]:"fire-vertex","fire-js":"fire-js",[mN]:"fire-js-all"};const Td=new Map,yN=new Map,rg=new Map;function L1(s,e){try{s.container.addComponent(e)}catch(t){oi.debug(`Component ${e.name} failed to register with FirebaseApp ${s.name}`,t)}}function Vo(s){const e=s.name;if(rg.has(e))return oi.debug(`There were multiple attempts to register component ${e}.`),!1;rg.set(e,s);for(const t of Td.values())L1(t,s);for(const t of yN.values())L1(t,s);return!0}function Yd(s,e){const t=s.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),s.container.getProvider(e)}function Mr(s){return s==null?!1:s.settings!==void 0}const bN={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Qi=new xu("app","Firebase",bN);class vN{constructor(e,t,i){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new Zi("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Qi.create("app-deleted",{appName:this._name})}}const $o=pN;function Vg(s,e={}){let t=s;typeof e!="object"&&(e={name:e});const i={name:sg,automaticDataCollectionEnabled:!0,...e},l=i.name;if(typeof l!="string"||!l)throw Qi.create("bad-app-name",{appName:String(l)});if(t||(t=H2()),!t)throw Qi.create("no-options");const u=Td.get(l);if(u){if(Oo(t,u.options)&&Oo(i,u.config))return u;throw Qi.create("duplicate-app",{appName:l})}const h=new jS(l);for(const g of rg.values())h.addComponent(g);const p=new vN(t,i,h);return Td.set(l,p),p}function Bg(s=sg){const e=Td.get(s);if(!e&&s===sg&&H2())return Vg();if(!e)throw Qi.create("no-app",{appName:s});return e}function ka(s,e,t){let i=gN[s]??s;t&&(i+=`-${t}`);const l=i.match(/\s|\//),u=e.match(/\s|\//);if(l||u){const h=[`Unable to register library "${i}" with version "${e}":`];l&&h.push(`library name "${i}" contains illegal characters (whitespace or "/")`),l&&u&&h.push("and"),u&&h.push(`version name "${e}" contains illegal characters (whitespace or "/")`),oi.warn(h.join(" "));return}Vo(new Zi(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}const xN="firebase-heartbeat-database",wN=1,iu="firebase-heartbeat-store";let jp=null;function Y2(){return jp||(jp=VS(xN,wN,{upgrade:(s,e)=>{switch(e){case 0:try{s.createObjectStore(iu)}catch(t){console.warn(t)}}}}).catch(s=>{throw Qi.create("idb-open",{originalErrorMessage:s.message})})),jp}async function _N(s){try{const t=(await Y2()).transaction(iu),i=await t.objectStore(iu).get(Q2(s));return await t.done,i}catch(e){if(e instanceof Ia)oi.warn(e.message);else{const t=Qi.create("idb-get",{originalErrorMessage:e?.message});oi.warn(t.message)}}}async function O1(s,e){try{const i=(await Y2()).transaction(iu,"readwrite");await i.objectStore(iu).put(e,Q2(s)),await i.done}catch(t){if(t instanceof Ia)oi.warn(t.message);else{const i=Qi.create("idb-set",{originalErrorMessage:t?.message});oi.warn(i.message)}}}function Q2(s){return`${s.name}!${s.options.appId}`}const kN=1024,TN=30;class jN{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new SN(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=V1();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(l=>l.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:t}),this._heartbeatsCache.heartbeats.length>TN){const l=NN(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(l,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){oi.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=V1(),{heartbeatsToSend:t,unsentEntries:i}=EN(this._heartbeatsCache.heartbeats),l=kd(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),l}catch(e){return oi.warn(e),""}}}function V1(){return new Date().toISOString().substring(0,10)}function EN(s,e=kN){const t=[];let i=s.slice();for(const l of s){const u=t.find(h=>h.agent===l.agent);if(u){if(u.dates.push(l.date),B1(t)>e){u.dates.pop();break}}else if(t.push({agent:l.agent,dates:[l.date]}),B1(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}class SN{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return fS()?mS().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await _N(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return O1(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return O1(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function B1(s){return kd(JSON.stringify({version:2,heartbeats:s})).length}function NN(s){if(s.length===0)return-1;let e=0,t=s[0].date;for(let i=1;i<s.length;i++)s[i].date<t&&(t=s[i].date,e=i);return e}function CN(s){Vo(new Zi("platform-logger",e=>new zS(e),"PRIVATE")),Vo(new Zi("heartbeat",e=>new jN(e),"PRIVATE")),ka(ng,P1,s),ka(ng,P1,"esm2020"),ka("fire-js","")}CN("");function X2(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const RN=X2,J2=new xu("auth","Firebase",X2());const jd=new Lg("@firebase/auth");function AN(s,...e){jd.logLevel<=fn.WARN&&jd.warn(`Auth (${$o}): ${s}`,...e)}function dd(s,...e){jd.logLevel<=fn.ERROR&&jd.error(`Auth (${$o}): ${s}`,...e)}function ca(s,...e){throw Ug(s,...e)}function Ta(s,...e){return Ug(s,...e)}function Z2(s,e,t){const i={...RN(),[e]:t};return new xu("auth","Firebase",i).create(e,{appName:s.name})}function si(s){return Z2(s,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Ug(s,...e){if(typeof s!="string"){const t=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=s.name),s._errorFactory.create(t,...i)}return J2.create(s,...e)}function Ot(s,e,...t){if(!s)throw Ug(e,...t)}function ei(s){const e="INTERNAL ASSERTION FAILED: "+s;throw dd(e),new Error(e)}function li(s,e){s||ei(e)}function ag(){return typeof self<"u"&&self.location?.href||""}function IN(){return U1()==="http:"||U1()==="https:"}function U1(){return typeof self<"u"&&self.location?.protocol||null}function MN(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(IN()||cS()||"connection"in navigator)?navigator.onLine:!0}function DN(){if(typeof navigator>"u")return null;const s=navigator;return s.languages&&s.languages[0]||s.language||null}class _u{constructor(e,t){this.shortDelay=e,this.longDelay=t,li(t>e,"Short delay should be less than long delay!"),this.isMobile=iS()||uS()}get(){return MN()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function zg(s,e){li(s.emulator,"Emulator should always be set here");const{url:t}=s.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class ew{static initialize(e,t,i){this.fetchImpl=e,t&&(this.headersImpl=t),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;ei("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;ei("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;ei("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const PN={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const LN=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],ON=new _u(3e4,6e4);function hi(s,e){return s.tenantId&&!e.tenantId?{...e,tenantId:s.tenantId}:e}async function di(s,e,t,i,l={}){return tw(s,l,async()=>{let u={},h={};i&&(e==="GET"?h=i:u={body:JSON.stringify(i)});const p=wu({key:s.config.apiKey,...h}).slice(1),g=await s._getAdditionalHeaders();g["Content-Type"]="application/json",s.languageCode&&(g["X-Firebase-Locale"]=s.languageCode);const y={method:e,headers:g,...u};return lS()||(y.referrerPolicy="no-referrer"),s.emulatorConfig&&io(s.emulatorConfig.host)&&(y.credentials="include"),ew.fetch()(await nw(s,s.config.apiHost,t,p),y)})}async function tw(s,e,t){s._canInitEmulator=!1;const i={...PN,...e};try{const l=new BN(s),u=await Promise.race([t(),l.promise]);l.clearNetworkTimeout();const h=await u.json();if("needConfirmation"in h)throw Qh(s,"account-exists-with-different-credential",h);if(u.ok&&!("errorMessage"in h))return h;{const p=u.ok?h.errorMessage:h.error.message,[g,y]=p.split(" : ");if(g==="FEDERATED_USER_ID_ALREADY_LINKED")throw Qh(s,"credential-already-in-use",h);if(g==="EMAIL_EXISTS")throw Qh(s,"email-already-in-use",h);if(g==="USER_DISABLED")throw Qh(s,"user-disabled",h);const w=i[g]||g.toLowerCase().replace(/[_\s]+/g,"-");if(y)throw Z2(s,w,y);ca(s,w)}}catch(l){if(l instanceof Ia)throw l;ca(s,"network-request-failed",{message:String(l)})}}async function ku(s,e,t,i,l={}){const u=await di(s,e,t,i,l);return"mfaPendingCredential"in u&&ca(s,"multi-factor-auth-required",{_serverResponse:u}),u}async function nw(s,e,t,i){const l=`${e}${t}?${i}`,u=s,h=u.config.emulator?zg(s.config,l):`${s.config.apiScheme}://${l}`;return LN.includes(t)&&(await u._persistenceManagerAvailable,u._getPersistenceType()==="COOKIE")?u._getPersistence()._getFinalTarget(h).toString():h}function VN(s){switch(s){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class BN{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,i)=>{this.timer=setTimeout(()=>i(Ta(this.auth,"network-request-failed")),ON.get())})}}function Qh(s,e,t){const i={appName:s.name};t.email&&(i.email=t.email),t.phoneNumber&&(i.phoneNumber=t.phoneNumber);const l=Ta(s,e,i);return l.customData._tokenResponse=t,l}function z1(s){return s!==void 0&&s.enterprise!==void 0}class UN{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return VN(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function zN(s,e){return di(s,"GET","/v2/recaptchaConfig",hi(s,e))}async function FN(s,e){return di(s,"POST","/v1/accounts:delete",e)}async function Ed(s,e){return di(s,"POST","/v1/accounts:lookup",e)}function Jc(s){if(s)try{const e=new Date(Number(s));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function qN(s,e=!1){const t=Qn(s),i=await t.getIdToken(e),l=Fg(i);Ot(l&&l.exp&&l.auth_time&&l.iat,t.auth,"internal-error");const u=typeof l.firebase=="object"?l.firebase:void 0,h=u?.sign_in_provider;return{claims:l,token:i,authTime:Jc(Ep(l.auth_time)),issuedAtTime:Jc(Ep(l.iat)),expirationTime:Jc(Ep(l.exp)),signInProvider:h||null,signInSecondFactor:u?.sign_in_second_factor||null}}function Ep(s){return Number(s)*1e3}function Fg(s){const[e,t,i]=s.split(".");if(e===void 0||t===void 0||i===void 0)return dd("JWT malformed, contained fewer than 3 sections"),null;try{const l=z2(t);return l?JSON.parse(l):(dd("Failed to decode base64 JWT payload"),null)}catch(l){return dd("Caught error parsing JWT payload as JSON",l?.toString()),null}}function F1(s){const e=Fg(s);return Ot(e,"internal-error"),Ot(typeof e.exp<"u","internal-error"),Ot(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function ou(s,e,t=!1){if(t)return e;try{return await e}catch(i){throw i instanceof Ia&&HN(i)&&s.auth.currentUser===s&&await s.auth.signOut(),i}}function HN({code:s}){return s==="auth/user-disabled"||s==="auth/user-token-expired"}class $N{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const i=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class ig{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Jc(this.lastLoginAt),this.creationTime=Jc(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Sd(s){const e=s.auth,t=await s.getIdToken(),i=await ou(s,Ed(e,{idToken:t}));Ot(i?.users.length,e,"internal-error");const l=i.users[0];s._notifyReloadListener(l);const u=l.providerUserInfo?.length?sw(l.providerUserInfo):[],h=GN(s.providerData,u),p=s.isAnonymous,g=!(s.email&&l.passwordHash)&&!h?.length,y=p?g:!1,w={uid:l.localId,displayName:l.displayName||null,photoURL:l.photoUrl||null,email:l.email||null,emailVerified:l.emailVerified||!1,phoneNumber:l.phoneNumber||null,tenantId:l.tenantId||null,providerData:h,metadata:new ig(l.createdAt,l.lastLoginAt),isAnonymous:y};Object.assign(s,w)}async function WN(s){const e=Qn(s);await Sd(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function GN(s,e){return[...s.filter(i=>!e.some(l=>l.providerId===i.providerId)),...e]}function sw(s){return s.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}async function KN(s,e){const t=await tw(s,{},async()=>{const i=wu({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:l,apiKey:u}=s.config,h=await nw(s,l,"/v1/token",`key=${u}`),p=await s._getAdditionalHeaders();p["Content-Type"]="application/x-www-form-urlencoded";const g={method:"POST",headers:p,body:i};return s.emulatorConfig&&io(s.emulatorConfig.host)&&(g.credentials="include"),ew.fetch()(h,g)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function YN(s,e){return di(s,"POST","/v2/accounts:revokeToken",hi(s,e))}class Dl{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Ot(e.idToken,"internal-error"),Ot(typeof e.idToken<"u","internal-error"),Ot(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):F1(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Ot(e.length!==0,"internal-error");const t=F1(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Ot(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:i,refreshToken:l,expiresIn:u}=await KN(e,t);this.updateTokensAndExpiration(i,l,Number(u))}updateTokensAndExpiration(e,t,i){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,t){const{refreshToken:i,accessToken:l,expirationTime:u}=t,h=new Dl;return i&&(Ot(typeof i=="string","internal-error",{appName:e}),h.refreshToken=i),l&&(Ot(typeof l=="string","internal-error",{appName:e}),h.accessToken=l),u&&(Ot(typeof u=="number","internal-error",{appName:e}),h.expirationTime=u),h}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Dl,this.toJSON())}_performRefresh(){return ei("not implemented")}}function Oi(s,e){Ot(typeof s=="string"||typeof s>"u","internal-error",{appName:e})}class oa{constructor({uid:e,auth:t,stsTokenManager:i,...l}){this.providerId="firebase",this.proactiveRefresh=new $N(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=l.displayName||null,this.email=l.email||null,this.emailVerified=l.emailVerified||!1,this.phoneNumber=l.phoneNumber||null,this.photoURL=l.photoURL||null,this.isAnonymous=l.isAnonymous||!1,this.tenantId=l.tenantId||null,this.providerData=l.providerData?[...l.providerData]:[],this.metadata=new ig(l.createdAt||void 0,l.lastLoginAt||void 0)}async getIdToken(e){const t=await ou(this,this.stsTokenManager.getToken(this.auth,e));return Ot(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return qN(this,e)}reload(){return WN(this)}_assign(e){this!==e&&(Ot(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new oa({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){Ot(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),t&&await Sd(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Mr(this.auth.app))return Promise.reject(si(this.auth));const e=await this.getIdToken();return await ou(this,FN(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const i=t.displayName??void 0,l=t.email??void 0,u=t.phoneNumber??void 0,h=t.photoURL??void 0,p=t.tenantId??void 0,g=t._redirectEventId??void 0,y=t.createdAt??void 0,w=t.lastLoginAt??void 0,{uid:k,emailVerified:j,isAnonymous:O,providerData:$,stsTokenManager:U}=t;Ot(k&&U,e,"internal-error");const L=Dl.fromJSON(this.name,U);Ot(typeof k=="string",e,"internal-error"),Oi(i,e.name),Oi(l,e.name),Ot(typeof j=="boolean",e,"internal-error"),Ot(typeof O=="boolean",e,"internal-error"),Oi(u,e.name),Oi(h,e.name),Oi(p,e.name),Oi(g,e.name),Oi(y,e.name),Oi(w,e.name);const ne=new oa({uid:k,auth:e,email:l,emailVerified:j,displayName:i,isAnonymous:O,photoURL:h,phoneNumber:u,tenantId:p,stsTokenManager:L,createdAt:y,lastLoginAt:w});return $&&Array.isArray($)&&(ne.providerData=$.map(Z=>({...Z}))),g&&(ne._redirectEventId=g),ne}static async _fromIdTokenResponse(e,t,i=!1){const l=new Dl;l.updateFromServerResponse(t);const u=new oa({uid:t.localId,auth:e,stsTokenManager:l,isAnonymous:i});return await Sd(u),u}static async _fromGetAccountInfoResponse(e,t,i){const l=t.users[0];Ot(l.localId!==void 0,"internal-error");const u=l.providerUserInfo!==void 0?sw(l.providerUserInfo):[],h=!(l.email&&l.passwordHash)&&!u?.length,p=new Dl;p.updateFromIdToken(i);const g=new oa({uid:l.localId,auth:e,stsTokenManager:p,isAnonymous:h}),y={uid:l.localId,displayName:l.displayName||null,photoURL:l.photoUrl||null,email:l.email||null,emailVerified:l.emailVerified||!1,phoneNumber:l.phoneNumber||null,tenantId:l.tenantId||null,providerData:u,metadata:new ig(l.createdAt,l.lastLoginAt),isAnonymous:!(l.email&&l.passwordHash)&&!u?.length};return Object.assign(g,y),g}}const q1=new Map;function ti(s){li(s instanceof Function,"Expected a class definition");let e=q1.get(s);return e?(li(e instanceof s,"Instance stored in cache mismatched with class"),e):(e=new s,q1.set(s,e),e)}class rw{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}rw.type="NONE";const H1=rw;function fd(s,e,t){return`firebase:${s}:${e}:${t}`}class Pl{constructor(e,t,i){this.persistence=e,this.auth=t,this.userKey=i;const{config:l,name:u}=this.auth;this.fullUserKey=fd(this.userKey,l.apiKey,u),this.fullPersistenceKey=fd("persistence",l.apiKey,u),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await Ed(this.auth,{idToken:e}).catch(()=>{});return t?oa._fromGetAccountInfoResponse(this.auth,t,e):null}return oa._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,i="authUser"){if(!t.length)return new Pl(ti(H1),e,i);const l=(await Promise.all(t.map(async y=>{if(await y._isAvailable())return y}))).filter(y=>y);let u=l[0]||ti(H1);const h=fd(i,e.config.apiKey,e.name);let p=null;for(const y of t)try{const w=await y._get(h);if(w){let k;if(typeof w=="string"){const j=await Ed(e,{idToken:w}).catch(()=>{});if(!j)break;k=await oa._fromGetAccountInfoResponse(e,j,w)}else k=oa._fromJSON(e,w);y!==u&&(p=k),u=y;break}}catch{}const g=l.filter(y=>y._shouldAllowMigration);return!u._shouldAllowMigration||!g.length?new Pl(u,e,i):(u=g[0],p&&await u._set(h,p.toJSON()),await Promise.all(t.map(async y=>{if(y!==u)try{await y._remove(h)}catch{}})),new Pl(u,e,i))}}function $1(s){const e=s.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(lw(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(aw(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(uw(e))return"Blackberry";if(hw(e))return"Webos";if(iw(e))return"Safari";if((e.includes("chrome/")||ow(e))&&!e.includes("edge/"))return"Chrome";if(cw(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=s.match(t);if(i?.length===2)return i[1]}return"Other"}function aw(s=tr()){return/firefox\//i.test(s)}function iw(s=tr()){const e=s.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function ow(s=tr()){return/crios\//i.test(s)}function lw(s=tr()){return/iemobile/i.test(s)}function cw(s=tr()){return/android/i.test(s)}function uw(s=tr()){return/blackberry/i.test(s)}function hw(s=tr()){return/webos/i.test(s)}function qg(s=tr()){return/iphone|ipad|ipod/i.test(s)||/macintosh/i.test(s)&&/mobile/i.test(s)}function QN(s=tr()){return qg(s)&&!!window.navigator?.standalone}function XN(){return hS()&&document.documentMode===10}function dw(s=tr()){return qg(s)||cw(s)||hw(s)||uw(s)||/windows phone/i.test(s)||lw(s)}function fw(s,e=[]){let t;switch(s){case"Browser":t=$1(tr());break;case"Worker":t=`${$1(tr())}-${s}`;break;default:t=s}const i=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${$o}/${i}`}class JN{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const i=u=>new Promise((h,p)=>{try{const g=e(u);h(g)}catch(g){p(g)}});i.onAbort=t,this.queue.push(i);const l=this.queue.length-1;return()=>{this.queue[l]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const i of this.queue)await i(e),i.onAbort&&t.push(i.onAbort)}catch(i){t.reverse();for(const l of t)try{l()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i?.message})}}}async function ZN(s,e={}){return di(s,"GET","/v2/passwordPolicy",hi(s,e))}const eC=6;class tC{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??eC,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const i=this.customStrengthOptions.minPasswordLength,l=this.customStrengthOptions.maxPasswordLength;i&&(t.meetsMinPasswordLength=e.length>=i),l&&(t.meetsMaxPasswordLength=e.length<=l)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let i;for(let l=0;l<e.length;l++)i=e.charAt(l),this.updatePasswordCharacterOptionsStatuses(t,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,t,i,l,u){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=l)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=u))}}class nC{constructor(e,t,i,l){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=i,this.config=l,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new W1(this),this.idTokenSubscription=new W1(this),this.beforeStateQueue=new JN(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=J2,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=l.sdkClientVersion,this._persistenceManagerAvailable=new Promise(u=>this._resolvePersistenceManagerAvailable=u)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=ti(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await Pl.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await Ed(this,{idToken:e}),i=await oa._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(i)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(Mr(this.app)){const u=this.app.settings.authIdToken;return u?new Promise(h=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(u).then(h,h))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let i=t,l=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const u=this.redirectUser?._redirectEventId,h=i?._redirectEventId,p=await this.tryRedirectSignIn(e);(!u||u===h)&&p?.user&&(i=p.user,l=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(l)try{await this.beforeStateQueue.runMiddleware(i)}catch(u){i=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(u))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return Ot(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Sd(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=DN()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Mr(this.app))return Promise.reject(si(this));const t=e?Qn(e):null;return t&&Ot(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Ot(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Mr(this.app)?Promise.reject(si(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Mr(this.app)?Promise.reject(si(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(ti(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await ZN(this),t=new tC(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new xu("auth","Firebase",e())}onAuthStateChanged(e,t,i){return this.registerStateListener(this.authStateSubscription,e,t,i)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,i){return this.registerStateListener(this.idTokenSubscription,e,t,i)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const i=this.onAuthStateChanged(()=>{i(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(i.tenantId=this.tenantId),await YN(this,i)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const i=await this.getOrInitRedirectPersistenceManager(t);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&ti(e)||this._popupRedirectResolver;Ot(t,this,"argument-error"),this.redirectPersistenceManager=await Pl.create(this,[ti(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,i,l){if(this._deleted)return()=>{};const u=typeof t=="function"?t:t.next.bind(t);let h=!1;const p=this._isInitialized?Promise.resolve():this._initializationPromise;if(Ot(p,this,"internal-error"),p.then(()=>{h||u(this.currentUser)}),typeof t=="function"){const g=e.addObserver(t,i,l);return()=>{h=!0,g()}}else{const g=e.addObserver(t);return()=>{h=!0,g()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Ot(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=fw(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const i=await this._getAppCheckToken();return i&&(e["X-Firebase-AppCheck"]=i),e}async _getAppCheckToken(){if(Mr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&AN(`Error while retrieving App Check token: ${e.error}`),e?.token}}function oo(s){return Qn(s)}class W1{constructor(e){this.auth=e,this.observer=null,this.addObserver=vS(t=>this.observer=t)}get next(){return Ot(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let Qd={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function sC(s){Qd=s}function mw(s){return Qd.loadJS(s)}function rC(){return Qd.recaptchaEnterpriseScript}function aC(){return Qd.gapiScript}function iC(s){return`__${s}${Math.floor(Math.random()*1e6)}`}class oC{constructor(){this.enterprise=new lC}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class lC{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const cC="recaptcha-enterprise",pw="NO_RECAPTCHA";class uC{constructor(e){this.type=cC,this.auth=oo(e)}async verify(e="verify",t=!1){async function i(u){if(!t){if(u.tenantId==null&&u._agentRecaptchaConfig!=null)return u._agentRecaptchaConfig.siteKey;if(u.tenantId!=null&&u._tenantRecaptchaConfigs[u.tenantId]!==void 0)return u._tenantRecaptchaConfigs[u.tenantId].siteKey}return new Promise(async(h,p)=>{zN(u,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(g=>{if(g.recaptchaKey===void 0)p(new Error("recaptcha Enterprise site key undefined"));else{const y=new UN(g);return u.tenantId==null?u._agentRecaptchaConfig=y:u._tenantRecaptchaConfigs[u.tenantId]=y,h(y.siteKey)}}).catch(g=>{p(g)})})}function l(u,h,p){const g=window.grecaptcha;z1(g)?g.enterprise.ready(()=>{g.enterprise.execute(u,{action:e}).then(y=>{h(y)}).catch(()=>{h(pw)})}):p(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new oC().execute("siteKey",{action:"verify"}):new Promise((u,h)=>{i(this.auth).then(p=>{if(!t&&z1(window.grecaptcha))l(p,u,h);else{if(typeof window>"u"){h(new Error("RecaptchaVerifier is only supported in browser"));return}let g=rC();g.length!==0&&(g+=p),mw(g).then(()=>{l(p,u,h)}).catch(y=>{h(y)})}}).catch(p=>{h(p)})})}}async function G1(s,e,t,i=!1,l=!1){const u=new uC(s);let h;if(l)h=pw;else try{h=await u.verify(t)}catch{h=await u.verify(t,!0)}const p={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in p){const g=p.phoneEnrollmentInfo.phoneNumber,y=p.phoneEnrollmentInfo.recaptchaToken;Object.assign(p,{phoneEnrollmentInfo:{phoneNumber:g,recaptchaToken:y,captchaResponse:h,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in p){const g=p.phoneSignInInfo.recaptchaToken;Object.assign(p,{phoneSignInInfo:{recaptchaToken:g,captchaResponse:h,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return p}return i?Object.assign(p,{captchaResp:h}):Object.assign(p,{captchaResponse:h}),Object.assign(p,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(p,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),p}async function Nd(s,e,t,i,l){if(s._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const u=await G1(s,e,t,t==="getOobCode");return i(s,u)}else return i(s,e).catch(async u=>{if(u.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const h=await G1(s,e,t,t==="getOobCode");return i(s,h)}else return Promise.reject(u)})}function hC(s,e){const t=Yd(s,"auth");if(t.isInitialized()){const l=t.getImmediate(),u=t.getOptions();if(Oo(u,e??{}))return l;ca(l,"already-initialized")}return t.initialize({options:e})}function dC(s,e){const t=e?.persistence||[],i=(Array.isArray(t)?t:[t]).map(ti);e?.errorMap&&s._updateErrorMap(e.errorMap),s._initializeWithPersistence(i,e?.popupRedirectResolver)}function fC(s,e,t){const i=oo(s);Ot(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const l=!1,u=gw(e),{host:h,port:p}=mC(e),g=p===null?"":`:${p}`,y={url:`${u}//${h}${g}/`},w=Object.freeze({host:h,port:p,protocol:u.replace(":",""),options:Object.freeze({disableWarnings:l})});if(!i._canInitEmulator){Ot(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),Ot(Oo(y,i.config.emulator)&&Oo(w,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=y,i.emulatorConfig=w,i.settings.appVerificationDisabledForTesting=!0,io(h)?(Dg(`${u}//${h}${g}`),Pg("Auth",!0)):pC()}function gw(s){const e=s.indexOf(":");return e<0?"":s.substr(0,e+1)}function mC(s){const e=gw(s),t=/(\/\/)?([^?#/]+)/.exec(s.substr(e.length));if(!t)return{host:"",port:null};const i=t[2].split("@").pop()||"",l=/^(\[[^\]]+\])(:|$)/.exec(i);if(l){const u=l[1];return{host:u,port:K1(i.substr(u.length+1))}}else{const[u,h]=i.split(":");return{host:u,port:K1(h)}}}function K1(s){if(!s)return null;const e=Number(s);return isNaN(e)?null:e}function pC(){function s(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",s):s())}class Hg{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return ei("not implemented")}_getIdTokenResponse(e){return ei("not implemented")}_linkToIdToken(e,t){return ei("not implemented")}_getReauthenticationResolver(e){return ei("not implemented")}}async function gC(s,e){return di(s,"POST","/v1/accounts:signUp",e)}async function yC(s,e){return ku(s,"POST","/v1/accounts:signInWithPassword",hi(s,e))}async function bC(s,e){return di(s,"POST","/v1/accounts:sendOobCode",hi(s,e))}async function vC(s,e){return bC(s,e)}async function xC(s,e){return ku(s,"POST","/v1/accounts:signInWithEmailLink",hi(s,e))}async function wC(s,e){return ku(s,"POST","/v1/accounts:signInWithEmailLink",hi(s,e))}class lu extends Hg{constructor(e,t,i,l=null){super("password",i),this._email=e,this._password=t,this._tenantId=l}static _fromEmailAndPassword(e,t){return new lu(e,t,"password")}static _fromEmailAndCode(e,t,i=null){return new lu(e,t,"emailLink",i)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Nd(e,t,"signInWithPassword",yC);case"emailLink":return xC(e,{email:this._email,oobCode:this._password});default:ca(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const i={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Nd(e,i,"signUpPassword",gC);case"emailLink":return wC(e,{idToken:t,email:this._email,oobCode:this._password});default:ca(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function Ll(s,e){return ku(s,"POST","/v1/accounts:signInWithIdp",hi(s,e))}const _C="http://localhost";class Bo extends Hg{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Bo(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):ca("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:l,...u}=t;if(!i||!l)return null;const h=new Bo(i,l);return h.idToken=u.idToken||void 0,h.accessToken=u.accessToken||void 0,h.secret=u.secret,h.nonce=u.nonce,h.pendingToken=u.pendingToken||null,h}_getIdTokenResponse(e){const t=this.buildRequest();return Ll(e,t)}_linkToIdToken(e,t){const i=this.buildRequest();return i.idToken=t,Ll(e,i)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Ll(e,t)}buildRequest(){const e={requestUri:_C,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=wu(t)}return e}}function kC(s){switch(s){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function TC(s){const e=$c(Wc(s)).link,t=e?$c(Wc(e)).deep_link_id:null,i=$c(Wc(s)).deep_link_id;return(i?$c(Wc(i)).link:null)||i||t||e||s}class $g{constructor(e){const t=$c(Wc(e)),i=t.apiKey??null,l=t.oobCode??null,u=kC(t.mode??null);Ot(i&&l&&u,"argument-error"),this.apiKey=i,this.operation=u,this.code=l,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=TC(e);try{return new $g(t)}catch{return null}}}class Kl{constructor(){this.providerId=Kl.PROVIDER_ID}static credential(e,t){return lu._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const i=$g.parseLink(t);return Ot(i,"argument-error"),lu._fromEmailAndCode(e,i.code,i.tenantId)}}Kl.PROVIDER_ID="password";Kl.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Kl.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class yw{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class Tu extends yw{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Ui extends Tu{constructor(){super("facebook.com")}static credential(e){return Bo._fromParams({providerId:Ui.PROVIDER_ID,signInMethod:Ui.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ui.credentialFromTaggedObject(e)}static credentialFromError(e){return Ui.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ui.credential(e.oauthAccessToken)}catch{return null}}}Ui.FACEBOOK_SIGN_IN_METHOD="facebook.com";Ui.PROVIDER_ID="facebook.com";class zi extends Tu{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Bo._fromParams({providerId:zi.PROVIDER_ID,signInMethod:zi.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return zi.credentialFromTaggedObject(e)}static credentialFromError(e){return zi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:i}=e;if(!t&&!i)return null;try{return zi.credential(t,i)}catch{return null}}}zi.GOOGLE_SIGN_IN_METHOD="google.com";zi.PROVIDER_ID="google.com";class Fi extends Tu{constructor(){super("github.com")}static credential(e){return Bo._fromParams({providerId:Fi.PROVIDER_ID,signInMethod:Fi.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Fi.credentialFromTaggedObject(e)}static credentialFromError(e){return Fi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Fi.credential(e.oauthAccessToken)}catch{return null}}}Fi.GITHUB_SIGN_IN_METHOD="github.com";Fi.PROVIDER_ID="github.com";class qi extends Tu{constructor(){super("twitter.com")}static credential(e,t){return Bo._fromParams({providerId:qi.PROVIDER_ID,signInMethod:qi.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return qi.credentialFromTaggedObject(e)}static credentialFromError(e){return qi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:i}=e;if(!t||!i)return null;try{return qi.credential(t,i)}catch{return null}}}qi.TWITTER_SIGN_IN_METHOD="twitter.com";qi.PROVIDER_ID="twitter.com";async function jC(s,e){return ku(s,"POST","/v1/accounts:signUp",hi(s,e))}class Uo{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,i,l=!1){const u=await oa._fromIdTokenResponse(e,i,l),h=Y1(i);return new Uo({user:u,providerId:h,_tokenResponse:i,operationType:t})}static async _forOperation(e,t,i){await e._updateTokensIfNecessary(i,!0);const l=Y1(i);return new Uo({user:e,providerId:l,_tokenResponse:i,operationType:t})}}function Y1(s){return s.providerId?s.providerId:"phoneNumber"in s?"phone":null}class Cd extends Ia{constructor(e,t,i,l){super(t.code,t.message),this.operationType=i,this.user=l,Object.setPrototypeOf(this,Cd.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,t,i,l){return new Cd(e,t,i,l)}}function bw(s,e,t,i){return(e==="reauthenticate"?t._getReauthenticationResolver(s):t._getIdTokenResponse(s)).catch(u=>{throw u.code==="auth/multi-factor-auth-required"?Cd._fromErrorAndOperation(s,u,e,i):u})}async function EC(s,e,t=!1){const i=await ou(s,e._linkToIdToken(s.auth,await s.getIdToken()),t);return Uo._forOperation(s,"link",i)}async function SC(s,e,t=!1){const{auth:i}=s;if(Mr(i.app))return Promise.reject(si(i));const l="reauthenticate";try{const u=await ou(s,bw(i,l,e,s),t);Ot(u.idToken,i,"internal-error");const h=Fg(u.idToken);Ot(h,i,"internal-error");const{sub:p}=h;return Ot(s.uid===p,i,"user-mismatch"),Uo._forOperation(s,l,u)}catch(u){throw u?.code==="auth/user-not-found"&&ca(i,"user-mismatch"),u}}async function vw(s,e,t=!1){if(Mr(s.app))return Promise.reject(si(s));const i="signIn",l=await bw(s,i,e),u=await Uo._fromIdTokenResponse(s,i,l);return t||await s._updateCurrentUser(u.user),u}async function NC(s,e){return vw(oo(s),e)}async function xw(s){const e=oo(s);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function CC(s,e,t){const i=oo(s);await Nd(i,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",vC)}async function s6(s,e,t){if(Mr(s.app))return Promise.reject(si(s));const i=oo(s),h=await Nd(i,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",jC).catch(g=>{throw g.code==="auth/password-does-not-meet-requirements"&&xw(s),g}),p=await Uo._fromIdTokenResponse(i,"signIn",h);return await i._updateCurrentUser(p.user),p}function RC(s,e,t){return Mr(s.app)?Promise.reject(si(s)):NC(Qn(s),Kl.credential(e,t)).catch(async i=>{throw i.code==="auth/password-does-not-meet-requirements"&&xw(s),i})}function AC(s,e){return Qn(s).setPersistence(e)}function IC(s,e,t,i){return Qn(s).onIdTokenChanged(e,t,i)}function MC(s,e,t){return Qn(s).beforeAuthStateChanged(e,t)}function DC(s,e,t,i){return Qn(s).onAuthStateChanged(e,t,i)}function PC(s){return Qn(s).signOut()}const Rd="__sak";class ww{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Rd,"1"),this.storage.removeItem(Rd),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const LC=1e3,OC=10;class _w extends ww{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=dw(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const i=this.storage.getItem(t),l=this.localCache[t];i!==l&&e(t,l,i)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((h,p,g)=>{this.notifyListeners(h,g)});return}const i=e.key;t?this.detachListener():this.stopPolling();const l=()=>{const h=this.storage.getItem(i);!t&&this.localCache[i]===h||this.notifyListeners(i,h)},u=this.storage.getItem(i);XN()&&u!==e.newValue&&e.newValue!==e.oldValue?setTimeout(l,OC):l()}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const l of Array.from(i))l(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:i}),!0)})},LC)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}_w.type="LOCAL";const kw=_w;class Tw extends ww{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}Tw.type="SESSION";const Wg=Tw;function VC(s){return Promise.all(s.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class Xd{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(l=>l.isListeningto(e));if(t)return t;const i=new Xd(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:i,eventType:l,data:u}=t.data,h=this.handlersMap[l];if(!h?.size)return;t.ports[0].postMessage({status:"ack",eventId:i,eventType:l});const p=Array.from(h).map(async y=>y(t.origin,u)),g=await VC(p);t.ports[0].postMessage({status:"done",eventId:i,eventType:l,response:g})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Xd.receivers=[];function Gg(s="",e=10){let t="";for(let i=0;i<e;i++)t+=Math.floor(Math.random()*10);return s+t}class BC{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,i=50){const l=typeof MessageChannel<"u"?new MessageChannel:null;if(!l)throw new Error("connection_unavailable");let u,h;return new Promise((p,g)=>{const y=Gg("",20);l.port1.start();const w=setTimeout(()=>{g(new Error("unsupported_event"))},i);h={messageChannel:l,onMessage(k){const j=k;if(j.data.eventId===y)switch(j.data.status){case"ack":clearTimeout(w),u=setTimeout(()=>{g(new Error("timeout"))},3e3);break;case"done":clearTimeout(u),p(j.data.response);break;default:clearTimeout(w),clearTimeout(u),g(new Error("invalid_response"));break}}},this.handlers.add(h),l.port1.addEventListener("message",h.onMessage),this.target.postMessage({eventType:e,eventId:y,data:t},[l.port2])}).finally(()=>{h&&this.removeMessageHandler(h)})}}function ja(){return window}function UC(s){ja().location.href=s}function jw(){return typeof ja().WorkerGlobalScope<"u"&&typeof ja().importScripts=="function"}async function zC(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function FC(){return navigator?.serviceWorker?.controller||null}function qC(){return jw()?self:null}const Ew="firebaseLocalStorageDb",HC=1,Ad="firebaseLocalStorage",Sw="fbase_key";class ju{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Jd(s,e){return s.transaction([Ad],e?"readwrite":"readonly").objectStore(Ad)}function $C(){const s=indexedDB.deleteDatabase(Ew);return new ju(s).toPromise()}function og(){const s=indexedDB.open(Ew,HC);return new Promise((e,t)=>{s.addEventListener("error",()=>{t(s.error)}),s.addEventListener("upgradeneeded",()=>{const i=s.result;try{i.createObjectStore(Ad,{keyPath:Sw})}catch(l){t(l)}}),s.addEventListener("success",async()=>{const i=s.result;i.objectStoreNames.contains(Ad)?e(i):(i.close(),await $C(),e(await og()))})})}async function Q1(s,e,t){const i=Jd(s,!0).put({[Sw]:e,value:t});return new ju(i).toPromise()}async function WC(s,e){const t=Jd(s,!1).get(e),i=await new ju(t).toPromise();return i===void 0?null:i.value}function X1(s,e){const t=Jd(s,!0).delete(e);return new ju(t).toPromise()}const GC=800,KC=3;class Nw{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await og(),this.db)}async _withRetries(e){let t=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(i){if(t++>KC)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return jw()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Xd._getInstance(qC()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await zC(),!this.activeServiceWorker)return;this.sender=new BC(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||FC()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await og();return await Q1(e,Rd,"1"),await X1(e,Rd),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(i=>Q1(i,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(i=>WC(i,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>X1(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(l=>{const u=Jd(l,!1).getAll();return new ju(u).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],i=new Set;if(e.length!==0)for(const{fbase_key:l,value:u}of e)i.add(l),JSON.stringify(this.localCache[l])!==JSON.stringify(u)&&(this.notifyListeners(l,u),t.push(l));for(const l of Object.keys(this.localCache))this.localCache[l]&&!i.has(l)&&(this.notifyListeners(l,null),t.push(l));return t}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const l of Array.from(i))l(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),GC)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}Nw.type="LOCAL";const YC=Nw;new _u(3e4,6e4);function QC(s,e){return e?ti(e):(Ot(s._popupRedirectResolver,s,"argument-error"),s._popupRedirectResolver)}class Kg extends Hg{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Ll(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Ll(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Ll(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function XC(s){return vw(s.auth,new Kg(s),s.bypassAuthState)}function JC(s){const{auth:e,user:t}=s;return Ot(t,e,"internal-error"),SC(t,new Kg(s),s.bypassAuthState)}async function ZC(s){const{auth:e,user:t}=s;return Ot(t,e,"internal-error"),EC(t,new Kg(s),s.bypassAuthState)}class Cw{constructor(e,t,i,l,u=!1){this.auth=e,this.resolver=i,this.user=l,this.bypassAuthState=u,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:i,postBody:l,tenantId:u,error:h,type:p}=e;if(h){this.reject(h);return}const g={auth:this.auth,requestUri:t,sessionId:i,tenantId:u||void 0,postBody:l||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(p)(g))}catch(y){this.reject(y)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return XC;case"linkViaPopup":case"linkViaRedirect":return ZC;case"reauthViaPopup":case"reauthViaRedirect":return JC;default:ca(this.auth,"internal-error")}}resolve(e){li(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){li(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const e4=new _u(2e3,1e4);class Ml extends Cw{constructor(e,t,i,l,u){super(e,t,l,u),this.provider=i,this.authWindow=null,this.pollId=null,Ml.currentPopupAction&&Ml.currentPopupAction.cancel(),Ml.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Ot(e,this.auth,"internal-error"),e}async onExecution(){li(this.filter.length===1,"Popup operations only handle one event");const e=Gg();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Ta(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(Ta(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Ml.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Ta(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,e4.get())};e()}}Ml.currentPopupAction=null;const t4="pendingRedirect",md=new Map;class n4 extends Cw{constructor(e,t,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,i),this.eventId=null}async execute(){let e=md.get(this.auth._key());if(!e){try{const i=await s4(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(t){e=()=>Promise.reject(t)}md.set(this.auth._key(),e)}return this.bypassAuthState||md.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function s4(s,e){const t=i4(e),i=a4(s);if(!await i._isAvailable())return!1;const l=await i._get(t)==="true";return await i._remove(t),l}function r4(s,e){md.set(s._key(),e)}function a4(s){return ti(s._redirectPersistence)}function i4(s){return fd(t4,s.config.apiKey,s.name)}async function o4(s,e,t=!1){if(Mr(s.app))return Promise.reject(si(s));const i=oo(s),l=QC(i,e),h=await new n4(i,l,t).execute();return h&&!t&&(delete h.user._redirectEventId,await i._persistUserIfCurrent(h.user),await i._setRedirectUser(null,e)),h}const l4=600*1e3;class c4{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(t=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!u4(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!Rw(e)){const i=e.error.code?.split("auth/")[1]||"internal-error";t.onError(Ta(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const i=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=l4&&this.cachedEventUids.clear(),this.cachedEventUids.has(J1(e))}saveEventToCache(e){this.cachedEventUids.add(J1(e)),this.lastProcessedEventTime=Date.now()}}function J1(s){return[s.type,s.eventId,s.sessionId,s.tenantId].filter(e=>e).join("-")}function Rw({type:s,error:e}){return s==="unknown"&&e?.code==="auth/no-auth-event"}function u4(s){switch(s.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Rw(s);default:return!1}}async function h4(s,e={}){return di(s,"GET","/v1/projects",e)}const d4=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,f4=/^https?/;async function m4(s){if(s.config.emulator)return;const{authorizedDomains:e}=await h4(s);for(const t of e)try{if(p4(t))return}catch{}ca(s,"unauthorized-domain")}function p4(s){const e=ag(),{protocol:t,hostname:i}=new URL(e);if(s.startsWith("chrome-extension://")){const h=new URL(s);return h.hostname===""&&i===""?t==="chrome-extension:"&&s.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&h.hostname===i}if(!f4.test(t))return!1;if(d4.test(s))return i===s;const l=s.replace(/\./g,"\\.");return new RegExp("^(.+\\."+l+"|"+l+")$","i").test(i)}const g4=new _u(3e4,6e4);function Z1(){const s=ja().___jsl;if(s?.H){for(const e of Object.keys(s.H))if(s.H[e].r=s.H[e].r||[],s.H[e].L=s.H[e].L||[],s.H[e].r=[...s.H[e].L],s.CP)for(let t=0;t<s.CP.length;t++)s.CP[t]=null}}function y4(s){return new Promise((e,t)=>{function i(){Z1(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Z1(),t(Ta(s,"network-request-failed"))},timeout:g4.get()})}if(ja().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(ja().gapi?.load)i();else{const l=iC("iframefcb");return ja()[l]=()=>{gapi.load?i():t(Ta(s,"network-request-failed"))},mw(`${aC()}?onload=${l}`).catch(u=>t(u))}}).catch(e=>{throw pd=null,e})}let pd=null;function b4(s){return pd=pd||y4(s),pd}const v4=new _u(5e3,15e3),x4="__/auth/iframe",w4="emulator/auth/iframe",_4={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},k4=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function T4(s){const e=s.config;Ot(e.authDomain,s,"auth-domain-config-required");const t=e.emulator?zg(e,w4):`https://${s.config.authDomain}/${x4}`,i={apiKey:e.apiKey,appName:s.name,v:$o},l=k4.get(s.config.apiHost);l&&(i.eid=l);const u=s._getFrameworks();return u.length&&(i.fw=u.join(",")),`${t}?${wu(i).slice(1)}`}async function j4(s){const e=await b4(s),t=ja().gapi;return Ot(t,s,"internal-error"),e.open({where:document.body,url:T4(s),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:_4,dontclear:!0},i=>new Promise(async(l,u)=>{await i.restyle({setHideOnLeave:!1});const h=Ta(s,"network-request-failed"),p=ja().setTimeout(()=>{u(h)},v4.get());function g(){ja().clearTimeout(p),l(i)}i.ping(g).then(g,()=>{u(h)})}))}const E4={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},S4=500,N4=600,C4="_blank",R4="http://localhost";class ex{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function A4(s,e,t,i=S4,l=N4){const u=Math.max((window.screen.availHeight-l)/2,0).toString(),h=Math.max((window.screen.availWidth-i)/2,0).toString();let p="";const g={...E4,width:i.toString(),height:l.toString(),top:u,left:h},y=tr().toLowerCase();t&&(p=ow(y)?C4:t),aw(y)&&(e=e||R4,g.scrollbars="yes");const w=Object.entries(g).reduce((j,[O,$])=>`${j}${O}=${$},`,"");if(QN(y)&&p!=="_self")return I4(e||"",p),new ex(null);const k=window.open(e||"",p,w);Ot(k,s,"popup-blocked");try{k.focus()}catch{}return new ex(k)}function I4(s,e){const t=document.createElement("a");t.href=s,t.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(i)}const M4="__/auth/handler",D4="emulator/auth/handler",P4=encodeURIComponent("fac");async function tx(s,e,t,i,l,u){Ot(s.config.authDomain,s,"auth-domain-config-required"),Ot(s.config.apiKey,s,"invalid-api-key");const h={apiKey:s.config.apiKey,appName:s.name,authType:t,redirectUrl:i,v:$o,eventId:l};if(e instanceof yw){e.setDefaultLanguage(s.languageCode),h.providerId=e.providerId||"",bS(e.getCustomParameters())||(h.customParameters=JSON.stringify(e.getCustomParameters()));for(const[w,k]of Object.entries({}))h[w]=k}if(e instanceof Tu){const w=e.getScopes().filter(k=>k!=="");w.length>0&&(h.scopes=w.join(","))}s.tenantId&&(h.tid=s.tenantId);const p=h;for(const w of Object.keys(p))p[w]===void 0&&delete p[w];const g=await s._getAppCheckToken(),y=g?`#${P4}=${encodeURIComponent(g)}`:"";return`${L4(s)}?${wu(p).slice(1)}${y}`}function L4({config:s}){return s.emulator?zg(s,D4):`https://${s.authDomain}/${M4}`}const Sp="webStorageSupport";class O4{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Wg,this._completeRedirectFn=o4,this._overrideRedirectResult=r4}async _openPopup(e,t,i,l){li(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const u=await tx(e,t,i,ag(),l);return A4(e,u,Gg())}async _openRedirect(e,t,i,l){await this._originValidation(e);const u=await tx(e,t,i,ag(),l);return UC(u),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:l,promise:u}=this.eventManagers[t];return l?Promise.resolve(l):(li(u,"If manager is not set, promise should be"),u)}const i=this.initAndGetManager(e);return this.eventManagers[t]={promise:i},i.catch(()=>{delete this.eventManagers[t]}),i}async initAndGetManager(e){const t=await j4(e),i=new c4(e);return t.register("authEvent",l=>(Ot(l?.authEvent,e,"invalid-auth-event"),{status:i.onEvent(l.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=t,i}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Sp,{type:Sp},l=>{const u=l?.[0]?.[Sp];u!==void 0&&t(!!u),ca(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=m4(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return dw()||iw()||qg()}}const V4=O4;var nx="@firebase/auth",sx="1.12.0";class B4{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(i=>{e(i?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Ot(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function U4(s){switch(s){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function z4(s){Vo(new Zi("auth",(e,{options:t})=>{const i=e.getProvider("app").getImmediate(),l=e.getProvider("heartbeat"),u=e.getProvider("app-check-internal"),{apiKey:h,authDomain:p}=i.options;Ot(h&&!h.includes(":"),"invalid-api-key",{appName:i.name});const g={apiKey:h,authDomain:p,clientPlatform:s,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:fw(s)},y=new nC(i,l,u,g);return dC(y,t),y},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,i)=>{e.getProvider("auth-internal").initialize()})),Vo(new Zi("auth-internal",e=>{const t=oo(e.getProvider("auth").getImmediate());return(i=>new B4(i))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),ka(nx,sx,U4(s)),ka(nx,sx,"esm2020")}const F4=300,q4=$2("authIdTokenMaxAge")||F4;let rx=null;const H4=s=>async e=>{const t=e&&await e.getIdTokenResult(),i=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(i&&i>q4)return;const l=t?.token;rx!==l&&(rx=l,await fetch(s,{method:l?"POST":"DELETE",headers:l?{Authorization:`Bearer ${l}`}:{}}))};function Aw(s=Bg()){const e=Yd(s,"auth");if(e.isInitialized())return e.getImmediate();const t=hC(s,{popupRedirectResolver:V4,persistence:[YC,kw,Wg]}),i=$2("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const u=new URL(i,location.origin);if(location.origin===u.origin){const h=H4(u.toString());MC(t,h,()=>h(t.currentUser)),IC(t,p=>h(p))}}const l=F2("auth");return l&&fC(t,`http://${l}`),t}function $4(){return document.getElementsByTagName("head")?.[0]??document}sC({loadJS(s){return new Promise((e,t)=>{const i=document.createElement("script");i.setAttribute("src",s),i.onload=e,i.onerror=l=>{const u=Ta("internal-error");u.customData=l,t(u)},i.type="text/javascript",i.charset="UTF-8",$4().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});z4("Browser");var ax=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var Xi,Iw;(function(){var s;function e(R,S){function I(){}I.prototype=S.prototype,R.F=S.prototype,R.prototype=new I,R.prototype.constructor=R,R.D=function(V,P,F){for(var M=Array(arguments.length-2),He=2;He<arguments.length;He++)M[He-2]=arguments[He];return S.prototype[P].apply(V,M)}}function t(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(i,t),i.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function l(R,S,I){I||(I=0);const V=Array(16);if(typeof S=="string")for(var P=0;P<16;++P)V[P]=S.charCodeAt(I++)|S.charCodeAt(I++)<<8|S.charCodeAt(I++)<<16|S.charCodeAt(I++)<<24;else for(P=0;P<16;++P)V[P]=S[I++]|S[I++]<<8|S[I++]<<16|S[I++]<<24;S=R.g[0],I=R.g[1],P=R.g[2];let F=R.g[3],M;M=S+(F^I&(P^F))+V[0]+3614090360&4294967295,S=I+(M<<7&4294967295|M>>>25),M=F+(P^S&(I^P))+V[1]+3905402710&4294967295,F=S+(M<<12&4294967295|M>>>20),M=P+(I^F&(S^I))+V[2]+606105819&4294967295,P=F+(M<<17&4294967295|M>>>15),M=I+(S^P&(F^S))+V[3]+3250441966&4294967295,I=P+(M<<22&4294967295|M>>>10),M=S+(F^I&(P^F))+V[4]+4118548399&4294967295,S=I+(M<<7&4294967295|M>>>25),M=F+(P^S&(I^P))+V[5]+1200080426&4294967295,F=S+(M<<12&4294967295|M>>>20),M=P+(I^F&(S^I))+V[6]+2821735955&4294967295,P=F+(M<<17&4294967295|M>>>15),M=I+(S^P&(F^S))+V[7]+4249261313&4294967295,I=P+(M<<22&4294967295|M>>>10),M=S+(F^I&(P^F))+V[8]+1770035416&4294967295,S=I+(M<<7&4294967295|M>>>25),M=F+(P^S&(I^P))+V[9]+2336552879&4294967295,F=S+(M<<12&4294967295|M>>>20),M=P+(I^F&(S^I))+V[10]+4294925233&4294967295,P=F+(M<<17&4294967295|M>>>15),M=I+(S^P&(F^S))+V[11]+2304563134&4294967295,I=P+(M<<22&4294967295|M>>>10),M=S+(F^I&(P^F))+V[12]+1804603682&4294967295,S=I+(M<<7&4294967295|M>>>25),M=F+(P^S&(I^P))+V[13]+4254626195&4294967295,F=S+(M<<12&4294967295|M>>>20),M=P+(I^F&(S^I))+V[14]+2792965006&4294967295,P=F+(M<<17&4294967295|M>>>15),M=I+(S^P&(F^S))+V[15]+1236535329&4294967295,I=P+(M<<22&4294967295|M>>>10),M=S+(P^F&(I^P))+V[1]+4129170786&4294967295,S=I+(M<<5&4294967295|M>>>27),M=F+(I^P&(S^I))+V[6]+3225465664&4294967295,F=S+(M<<9&4294967295|M>>>23),M=P+(S^I&(F^S))+V[11]+643717713&4294967295,P=F+(M<<14&4294967295|M>>>18),M=I+(F^S&(P^F))+V[0]+3921069994&4294967295,I=P+(M<<20&4294967295|M>>>12),M=S+(P^F&(I^P))+V[5]+3593408605&4294967295,S=I+(M<<5&4294967295|M>>>27),M=F+(I^P&(S^I))+V[10]+38016083&4294967295,F=S+(M<<9&4294967295|M>>>23),M=P+(S^I&(F^S))+V[15]+3634488961&4294967295,P=F+(M<<14&4294967295|M>>>18),M=I+(F^S&(P^F))+V[4]+3889429448&4294967295,I=P+(M<<20&4294967295|M>>>12),M=S+(P^F&(I^P))+V[9]+568446438&4294967295,S=I+(M<<5&4294967295|M>>>27),M=F+(I^P&(S^I))+V[14]+3275163606&4294967295,F=S+(M<<9&4294967295|M>>>23),M=P+(S^I&(F^S))+V[3]+4107603335&4294967295,P=F+(M<<14&4294967295|M>>>18),M=I+(F^S&(P^F))+V[8]+1163531501&4294967295,I=P+(M<<20&4294967295|M>>>12),M=S+(P^F&(I^P))+V[13]+2850285829&4294967295,S=I+(M<<5&4294967295|M>>>27),M=F+(I^P&(S^I))+V[2]+4243563512&4294967295,F=S+(M<<9&4294967295|M>>>23),M=P+(S^I&(F^S))+V[7]+1735328473&4294967295,P=F+(M<<14&4294967295|M>>>18),M=I+(F^S&(P^F))+V[12]+2368359562&4294967295,I=P+(M<<20&4294967295|M>>>12),M=S+(I^P^F)+V[5]+4294588738&4294967295,S=I+(M<<4&4294967295|M>>>28),M=F+(S^I^P)+V[8]+2272392833&4294967295,F=S+(M<<11&4294967295|M>>>21),M=P+(F^S^I)+V[11]+1839030562&4294967295,P=F+(M<<16&4294967295|M>>>16),M=I+(P^F^S)+V[14]+4259657740&4294967295,I=P+(M<<23&4294967295|M>>>9),M=S+(I^P^F)+V[1]+2763975236&4294967295,S=I+(M<<4&4294967295|M>>>28),M=F+(S^I^P)+V[4]+1272893353&4294967295,F=S+(M<<11&4294967295|M>>>21),M=P+(F^S^I)+V[7]+4139469664&4294967295,P=F+(M<<16&4294967295|M>>>16),M=I+(P^F^S)+V[10]+3200236656&4294967295,I=P+(M<<23&4294967295|M>>>9),M=S+(I^P^F)+V[13]+681279174&4294967295,S=I+(M<<4&4294967295|M>>>28),M=F+(S^I^P)+V[0]+3936430074&4294967295,F=S+(M<<11&4294967295|M>>>21),M=P+(F^S^I)+V[3]+3572445317&4294967295,P=F+(M<<16&4294967295|M>>>16),M=I+(P^F^S)+V[6]+76029189&4294967295,I=P+(M<<23&4294967295|M>>>9),M=S+(I^P^F)+V[9]+3654602809&4294967295,S=I+(M<<4&4294967295|M>>>28),M=F+(S^I^P)+V[12]+3873151461&4294967295,F=S+(M<<11&4294967295|M>>>21),M=P+(F^S^I)+V[15]+530742520&4294967295,P=F+(M<<16&4294967295|M>>>16),M=I+(P^F^S)+V[2]+3299628645&4294967295,I=P+(M<<23&4294967295|M>>>9),M=S+(P^(I|~F))+V[0]+4096336452&4294967295,S=I+(M<<6&4294967295|M>>>26),M=F+(I^(S|~P))+V[7]+1126891415&4294967295,F=S+(M<<10&4294967295|M>>>22),M=P+(S^(F|~I))+V[14]+2878612391&4294967295,P=F+(M<<15&4294967295|M>>>17),M=I+(F^(P|~S))+V[5]+4237533241&4294967295,I=P+(M<<21&4294967295|M>>>11),M=S+(P^(I|~F))+V[12]+1700485571&4294967295,S=I+(M<<6&4294967295|M>>>26),M=F+(I^(S|~P))+V[3]+2399980690&4294967295,F=S+(M<<10&4294967295|M>>>22),M=P+(S^(F|~I))+V[10]+4293915773&4294967295,P=F+(M<<15&4294967295|M>>>17),M=I+(F^(P|~S))+V[1]+2240044497&4294967295,I=P+(M<<21&4294967295|M>>>11),M=S+(P^(I|~F))+V[8]+1873313359&4294967295,S=I+(M<<6&4294967295|M>>>26),M=F+(I^(S|~P))+V[15]+4264355552&4294967295,F=S+(M<<10&4294967295|M>>>22),M=P+(S^(F|~I))+V[6]+2734768916&4294967295,P=F+(M<<15&4294967295|M>>>17),M=I+(F^(P|~S))+V[13]+1309151649&4294967295,I=P+(M<<21&4294967295|M>>>11),M=S+(P^(I|~F))+V[4]+4149444226&4294967295,S=I+(M<<6&4294967295|M>>>26),M=F+(I^(S|~P))+V[11]+3174756917&4294967295,F=S+(M<<10&4294967295|M>>>22),M=P+(S^(F|~I))+V[2]+718787259&4294967295,P=F+(M<<15&4294967295|M>>>17),M=I+(F^(P|~S))+V[9]+3951481745&4294967295,R.g[0]=R.g[0]+S&4294967295,R.g[1]=R.g[1]+(P+(M<<21&4294967295|M>>>11))&4294967295,R.g[2]=R.g[2]+P&4294967295,R.g[3]=R.g[3]+F&4294967295}i.prototype.v=function(R,S){S===void 0&&(S=R.length);const I=S-this.blockSize,V=this.C;let P=this.h,F=0;for(;F<S;){if(P==0)for(;F<=I;)l(this,R,F),F+=this.blockSize;if(typeof R=="string"){for(;F<S;)if(V[P++]=R.charCodeAt(F++),P==this.blockSize){l(this,V),P=0;break}}else for(;F<S;)if(V[P++]=R[F++],P==this.blockSize){l(this,V),P=0;break}}this.h=P,this.o+=S},i.prototype.A=function(){var R=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);R[0]=128;for(var S=1;S<R.length-8;++S)R[S]=0;S=this.o*8;for(var I=R.length-8;I<R.length;++I)R[I]=S&255,S/=256;for(this.v(R),R=Array(16),S=0,I=0;I<4;++I)for(let V=0;V<32;V+=8)R[S++]=this.g[I]>>>V&255;return R};function u(R,S){var I=p;return Object.prototype.hasOwnProperty.call(I,R)?I[R]:I[R]=S(R)}function h(R,S){this.h=S;const I=[];let V=!0;for(let P=R.length-1;P>=0;P--){const F=R[P]|0;V&&F==S||(I[P]=F,V=!1)}this.g=I}var p={};function g(R){return-128<=R&&R<128?u(R,function(S){return new h([S|0],S<0?-1:0)}):new h([R|0],R<0?-1:0)}function y(R){if(isNaN(R)||!isFinite(R))return k;if(R<0)return L(y(-R));const S=[];let I=1;for(let V=0;R>=I;V++)S[V]=R/I|0,I*=4294967296;return new h(S,0)}function w(R,S){if(R.length==0)throw Error("number format error: empty string");if(S=S||10,S<2||36<S)throw Error("radix out of range: "+S);if(R.charAt(0)=="-")return L(w(R.substring(1),S));if(R.indexOf("-")>=0)throw Error('number format error: interior "-" character');const I=y(Math.pow(S,8));let V=k;for(let F=0;F<R.length;F+=8){var P=Math.min(8,R.length-F);const M=parseInt(R.substring(F,F+P),S);P<8?(P=y(Math.pow(S,P)),V=V.j(P).add(y(M))):(V=V.j(I),V=V.add(y(M)))}return V}var k=g(0),j=g(1),O=g(16777216);s=h.prototype,s.m=function(){if(U(this))return-L(this).m();let R=0,S=1;for(let I=0;I<this.g.length;I++){const V=this.i(I);R+=(V>=0?V:4294967296+V)*S,S*=4294967296}return R},s.toString=function(R){if(R=R||10,R<2||36<R)throw Error("radix out of range: "+R);if($(this))return"0";if(U(this))return"-"+L(this).toString(R);const S=y(Math.pow(R,6));var I=this;let V="";for(;;){const P=je(I,S).g;I=ne(I,P.j(S));let F=((I.g.length>0?I.g[0]:I.h)>>>0).toString(R);if(I=P,$(I))return F+V;for(;F.length<6;)F="0"+F;V=F+V}},s.i=function(R){return R<0?0:R<this.g.length?this.g[R]:this.h};function $(R){if(R.h!=0)return!1;for(let S=0;S<R.g.length;S++)if(R.g[S]!=0)return!1;return!0}function U(R){return R.h==-1}s.l=function(R){return R=ne(this,R),U(R)?-1:$(R)?0:1};function L(R){const S=R.g.length,I=[];for(let V=0;V<S;V++)I[V]=~R.g[V];return new h(I,~R.h).add(j)}s.abs=function(){return U(this)?L(this):this},s.add=function(R){const S=Math.max(this.g.length,R.g.length),I=[];let V=0;for(let P=0;P<=S;P++){let F=V+(this.i(P)&65535)+(R.i(P)&65535),M=(F>>>16)+(this.i(P)>>>16)+(R.i(P)>>>16);V=M>>>16,F&=65535,M&=65535,I[P]=M<<16|F}return new h(I,I[I.length-1]&-2147483648?-1:0)};function ne(R,S){return R.add(L(S))}s.j=function(R){if($(this)||$(R))return k;if(U(this))return U(R)?L(this).j(L(R)):L(L(this).j(R));if(U(R))return L(this.j(L(R)));if(this.l(O)<0&&R.l(O)<0)return y(this.m()*R.m());const S=this.g.length+R.g.length,I=[];for(var V=0;V<2*S;V++)I[V]=0;for(V=0;V<this.g.length;V++)for(let P=0;P<R.g.length;P++){const F=this.i(V)>>>16,M=this.i(V)&65535,He=R.i(P)>>>16,xt=R.i(P)&65535;I[2*V+2*P]+=M*xt,Z(I,2*V+2*P),I[2*V+2*P+1]+=F*xt,Z(I,2*V+2*P+1),I[2*V+2*P+1]+=M*He,Z(I,2*V+2*P+1),I[2*V+2*P+2]+=F*He,Z(I,2*V+2*P+2)}for(R=0;R<S;R++)I[R]=I[2*R+1]<<16|I[2*R];for(R=S;R<2*S;R++)I[R]=0;return new h(I,0)};function Z(R,S){for(;(R[S]&65535)!=R[S];)R[S+1]+=R[S]>>>16,R[S]&=65535,S++}function ye(R,S){this.g=R,this.h=S}function je(R,S){if($(S))throw Error("division by zero");if($(R))return new ye(k,k);if(U(R))return S=je(L(R),S),new ye(L(S.g),L(S.h));if(U(S))return S=je(R,L(S)),new ye(L(S.g),S.h);if(R.g.length>30){if(U(R)||U(S))throw Error("slowDivide_ only works with positive integers.");for(var I=j,V=S;V.l(R)<=0;)I=We(I),V=We(V);var P=Be(I,1),F=Be(V,1);for(V=Be(V,2),I=Be(I,2);!$(V);){var M=F.add(V);M.l(R)<=0&&(P=P.add(I),F=M),V=Be(V,1),I=Be(I,1)}return S=ne(R,P.j(S)),new ye(P,S)}for(P=k;R.l(S)>=0;){for(I=Math.max(1,Math.floor(R.m()/S.m())),V=Math.ceil(Math.log(I)/Math.LN2),V=V<=48?1:Math.pow(2,V-48),F=y(I),M=F.j(S);U(M)||M.l(R)>0;)I-=V,F=y(I),M=F.j(S);$(F)&&(F=j),P=P.add(F),R=ne(R,M)}return new ye(P,R)}s.B=function(R){return je(this,R).h},s.and=function(R){const S=Math.max(this.g.length,R.g.length),I=[];for(let V=0;V<S;V++)I[V]=this.i(V)&R.i(V);return new h(I,this.h&R.h)},s.or=function(R){const S=Math.max(this.g.length,R.g.length),I=[];for(let V=0;V<S;V++)I[V]=this.i(V)|R.i(V);return new h(I,this.h|R.h)},s.xor=function(R){const S=Math.max(this.g.length,R.g.length),I=[];for(let V=0;V<S;V++)I[V]=this.i(V)^R.i(V);return new h(I,this.h^R.h)};function We(R){const S=R.g.length+1,I=[];for(let V=0;V<S;V++)I[V]=R.i(V)<<1|R.i(V-1)>>>31;return new h(I,R.h)}function Be(R,S){const I=S>>5;S%=32;const V=R.g.length-I,P=[];for(let F=0;F<V;F++)P[F]=S>0?R.i(F+I)>>>S|R.i(F+I+1)<<32-S:R.i(F+I);return new h(P,R.h)}i.prototype.digest=i.prototype.A,i.prototype.reset=i.prototype.u,i.prototype.update=i.prototype.v,Iw=i,h.prototype.add=h.prototype.add,h.prototype.multiply=h.prototype.j,h.prototype.modulo=h.prototype.B,h.prototype.compare=h.prototype.l,h.prototype.toNumber=h.prototype.m,h.prototype.toString=h.prototype.toString,h.prototype.getBits=h.prototype.i,h.fromNumber=y,h.fromString=w,Xi=h}).apply(typeof ax<"u"?ax:typeof self<"u"?self:typeof window<"u"?window:{});var Xh=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var Mw,Gc,Dw,gd,lg,Pw,Lw,Ow;(function(){var s,e=Object.defineProperty;function t(d){d=[typeof globalThis=="object"&&globalThis,d,typeof window=="object"&&window,typeof self=="object"&&self,typeof Xh=="object"&&Xh];for(var b=0;b<d.length;++b){var _=d[b];if(_&&_.Math==Math)return _}throw Error("Cannot find global object")}var i=t(this);function l(d,b){if(b)e:{var _=i;d=d.split(".");for(var N=0;N<d.length-1;N++){var te=d[N];if(!(te in _))break e;_=_[te]}d=d[d.length-1],N=_[d],b=b(N),b!=N&&b!=null&&e(_,d,{configurable:!0,writable:!0,value:b})}}l("Symbol.dispose",function(d){return d||Symbol("Symbol.dispose")}),l("Array.prototype.values",function(d){return d||function(){return this[Symbol.iterator]()}}),l("Object.entries",function(d){return d||function(b){var _=[],N;for(N in b)Object.prototype.hasOwnProperty.call(b,N)&&_.push([N,b[N]]);return _}});var u=u||{},h=this||self;function p(d){var b=typeof d;return b=="object"&&d!=null||b=="function"}function g(d,b,_){return d.call.apply(d.bind,arguments)}function y(d,b,_){return y=g,y.apply(null,arguments)}function w(d,b){var _=Array.prototype.slice.call(arguments,1);return function(){var N=_.slice();return N.push.apply(N,arguments),d.apply(this,N)}}function k(d,b){function _(){}_.prototype=b.prototype,d.Z=b.prototype,d.prototype=new _,d.prototype.constructor=d,d.Ob=function(N,te,ue){for(var Ye=Array(arguments.length-2),Jt=2;Jt<arguments.length;Jt++)Ye[Jt-2]=arguments[Jt];return b.prototype[te].apply(N,Ye)}}var j=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?d=>d&&AsyncContext.Snapshot.wrap(d):d=>d;function O(d){const b=d.length;if(b>0){const _=Array(b);for(let N=0;N<b;N++)_[N]=d[N];return _}return[]}function $(d,b){for(let N=1;N<arguments.length;N++){const te=arguments[N];var _=typeof te;if(_=_!="object"?_:te?Array.isArray(te)?"array":_:"null",_=="array"||_=="object"&&typeof te.length=="number"){_=d.length||0;const ue=te.length||0;d.length=_+ue;for(let Ye=0;Ye<ue;Ye++)d[_+Ye]=te[Ye]}else d.push(te)}}class U{constructor(b,_){this.i=b,this.j=_,this.h=0,this.g=null}get(){let b;return this.h>0?(this.h--,b=this.g,this.g=b.next,b.next=null):b=this.i(),b}}function L(d){h.setTimeout(()=>{throw d},0)}function ne(){var d=R;let b=null;return d.g&&(b=d.g,d.g=d.g.next,d.g||(d.h=null),b.next=null),b}class Z{constructor(){this.h=this.g=null}add(b,_){const N=ye.get();N.set(b,_),this.h?this.h.next=N:this.g=N,this.h=N}}var ye=new U(()=>new je,d=>d.reset());class je{constructor(){this.next=this.g=this.h=null}set(b,_){this.h=b,this.g=_,this.next=null}reset(){this.next=this.g=this.h=null}}let We,Be=!1,R=new Z,S=()=>{const d=Promise.resolve(void 0);We=()=>{d.then(I)}};function I(){for(var d;d=ne();){try{d.h.call(d.g)}catch(_){L(_)}var b=ye;b.j(d),b.h<100&&(b.h++,d.next=b.g,b.g=d)}Be=!1}function V(){this.u=this.u,this.C=this.C}V.prototype.u=!1,V.prototype.dispose=function(){this.u||(this.u=!0,this.N())},V.prototype[Symbol.dispose]=function(){this.dispose()},V.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function P(d,b){this.type=d,this.g=this.target=b,this.defaultPrevented=!1}P.prototype.h=function(){this.defaultPrevented=!0};var F=(function(){if(!h.addEventListener||!Object.defineProperty)return!1;var d=!1,b=Object.defineProperty({},"passive",{get:function(){d=!0}});try{const _=()=>{};h.addEventListener("test",_,b),h.removeEventListener("test",_,b)}catch{}return d})();function M(d){return/^[\s\xa0]*$/.test(d)}function He(d,b){P.call(this,d?d.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,d&&this.init(d,b)}k(He,P),He.prototype.init=function(d,b){const _=this.type=d.type,N=d.changedTouches&&d.changedTouches.length?d.changedTouches[0]:null;this.target=d.target||d.srcElement,this.g=b,b=d.relatedTarget,b||(_=="mouseover"?b=d.fromElement:_=="mouseout"&&(b=d.toElement)),this.relatedTarget=b,N?(this.clientX=N.clientX!==void 0?N.clientX:N.pageX,this.clientY=N.clientY!==void 0?N.clientY:N.pageY,this.screenX=N.screenX||0,this.screenY=N.screenY||0):(this.clientX=d.clientX!==void 0?d.clientX:d.pageX,this.clientY=d.clientY!==void 0?d.clientY:d.pageY,this.screenX=d.screenX||0,this.screenY=d.screenY||0),this.button=d.button,this.key=d.key||"",this.ctrlKey=d.ctrlKey,this.altKey=d.altKey,this.shiftKey=d.shiftKey,this.metaKey=d.metaKey,this.pointerId=d.pointerId||0,this.pointerType=d.pointerType,this.state=d.state,this.i=d,d.defaultPrevented&&He.Z.h.call(this)},He.prototype.h=function(){He.Z.h.call(this);const d=this.i;d.preventDefault?d.preventDefault():d.returnValue=!1};var xt="closure_listenable_"+(Math.random()*1e6|0),z=0;function fe(d,b,_,N,te){this.listener=d,this.proxy=null,this.src=b,this.type=_,this.capture=!!N,this.ha=te,this.key=++z,this.da=this.fa=!1}function Ie(d){d.da=!0,d.listener=null,d.proxy=null,d.src=null,d.ha=null}function Ge(d,b,_){for(const N in d)b.call(_,d[N],N,d)}function J(d,b){for(const _ in d)b.call(void 0,d[_],_,d)}function D(d){const b={};for(const _ in d)b[_]=d[_];return b}const W="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function be(d,b){let _,N;for(let te=1;te<arguments.length;te++){N=arguments[te];for(_ in N)d[_]=N[_];for(let ue=0;ue<W.length;ue++)_=W[ue],Object.prototype.hasOwnProperty.call(N,_)&&(d[_]=N[_])}}function Ne(d){this.src=d,this.g={},this.h=0}Ne.prototype.add=function(d,b,_,N,te){const ue=d.toString();d=this.g[ue],d||(d=this.g[ue]=[],this.h++);const Ye=Ae(d,b,N,te);return Ye>-1?(b=d[Ye],_||(b.fa=!1)):(b=new fe(b,this.src,ue,!!N,te),b.fa=_,d.push(b)),b};function qe(d,b){const _=b.type;if(_ in d.g){var N=d.g[_],te=Array.prototype.indexOf.call(N,b,void 0),ue;(ue=te>=0)&&Array.prototype.splice.call(N,te,1),ue&&(Ie(b),d.g[_].length==0&&(delete d.g[_],d.h--))}}function Ae(d,b,_,N){for(let te=0;te<d.length;++te){const ue=d[te];if(!ue.da&&ue.listener==b&&ue.capture==!!_&&ue.ha==N)return te}return-1}var rt="closure_lm_"+(Math.random()*1e6|0),pt={};function Ze(d,b,_,N,te){if(Array.isArray(b)){for(let ue=0;ue<b.length;ue++)Ze(d,b[ue],_,N,te);return null}return _=Bt(_),d&&d[xt]?d.J(b,_,p(N)?!!N.capture:!1,te):Ht(d,b,_,!1,N,te)}function Ht(d,b,_,N,te,ue){if(!b)throw Error("Invalid event type");const Ye=p(te)?!!te.capture:!!te;let Jt=$t(d);if(Jt||(d[rt]=Jt=new Ne(d)),_=Jt.add(b,_,N,Ye,ue),_.proxy)return _;if(N=cn(),_.proxy=N,N.src=d,N.listener=_,d.addEventListener)F||(te=Ye),te===void 0&&(te=!1),d.addEventListener(b.toString(),N,te);else if(d.attachEvent)d.attachEvent(le(b.toString()),N);else if(d.addListener&&d.removeListener)d.addListener(N);else throw Error("addEventListener and attachEvent are unavailable.");return _}function cn(){function d(_){return b.call(d.src,d.listener,_)}const b=gn;return d}function Nt(d,b,_,N,te){if(Array.isArray(b))for(var ue=0;ue<b.length;ue++)Nt(d,b[ue],_,N,te);else N=p(N)?!!N.capture:!!N,_=Bt(_),d&&d[xt]?(d=d.i,ue=String(b).toString(),ue in d.g&&(b=d.g[ue],_=Ae(b,_,N,te),_>-1&&(Ie(b[_]),Array.prototype.splice.call(b,_,1),b.length==0&&(delete d.g[ue],d.h--)))):d&&(d=$t(d))&&(b=d.g[b.toString()],d=-1,b&&(d=Ae(b,_,N,te)),(_=d>-1?b[d]:null)&&Ct(_))}function Ct(d){if(typeof d!="number"&&d&&!d.da){var b=d.src;if(b&&b[xt])qe(b.i,d);else{var _=d.type,N=d.proxy;b.removeEventListener?b.removeEventListener(_,N,d.capture):b.detachEvent?b.detachEvent(le(_),N):b.addListener&&b.removeListener&&b.removeListener(N),(_=$t(b))?(qe(_,d),_.h==0&&(_.src=null,b[rt]=null)):Ie(d)}}}function le(d){return d in pt?pt[d]:pt[d]="on"+d}function gn(d,b){if(d.da)d=!0;else{b=new He(b,this);const _=d.listener,N=d.ha||d.src;d.fa&&Ct(d),d=_.call(N,b)}return d}function $t(d){return d=d[rt],d instanceof Ne?d:null}var St="__closure_events_fn_"+(Math.random()*1e9>>>0);function Bt(d){return typeof d=="function"?d:(d[St]||(d[St]=function(b){return d.handleEvent(b)}),d[St])}function ht(){V.call(this),this.i=new Ne(this),this.M=this,this.G=null}k(ht,V),ht.prototype[xt]=!0,ht.prototype.removeEventListener=function(d,b,_,N){Nt(this,d,b,_,N)};function et(d,b){var _,N=d.G;if(N)for(_=[];N;N=N.G)_.push(N);if(d=d.M,N=b.type||b,typeof b=="string")b=new P(b,d);else if(b instanceof P)b.target=b.target||d;else{var te=b;b=new P(N,d),be(b,te)}te=!0;let ue,Ye;if(_)for(Ye=_.length-1;Ye>=0;Ye--)ue=b.g=_[Ye],te=en(ue,N,!0,b)&&te;if(ue=b.g=d,te=en(ue,N,!0,b)&&te,te=en(ue,N,!1,b)&&te,_)for(Ye=0;Ye<_.length;Ye++)ue=b.g=_[Ye],te=en(ue,N,!1,b)&&te}ht.prototype.N=function(){if(ht.Z.N.call(this),this.i){var d=this.i;for(const b in d.g){const _=d.g[b];for(let N=0;N<_.length;N++)Ie(_[N]);delete d.g[b],d.h--}}this.G=null},ht.prototype.J=function(d,b,_,N){return this.i.add(String(d),b,!1,_,N)},ht.prototype.K=function(d,b,_,N){return this.i.add(String(d),b,!0,_,N)};function en(d,b,_,N){if(b=d.i.g[String(b)],!b)return!0;b=b.concat();let te=!0;for(let ue=0;ue<b.length;++ue){const Ye=b[ue];if(Ye&&!Ye.da&&Ye.capture==_){const Jt=Ye.listener,xs=Ye.ha||Ye.src;Ye.fa&&qe(d.i,Ye),te=Jt.call(xs,N)!==!1&&te}}return te&&!N.defaultPrevented}function rs(d,b){if(typeof d!="function")if(d&&typeof d.handleEvent=="function")d=y(d.handleEvent,d);else throw Error("Invalid listener argument");return Number(b)>2147483647?-1:h.setTimeout(d,b||0)}function Lt(d){d.g=rs(()=>{d.g=null,d.i&&(d.i=!1,Lt(d))},d.l);const b=d.h;d.h=null,d.m.apply(null,b)}class Et extends V{constructor(b,_){super(),this.m=b,this.l=_,this.h=null,this.i=!1,this.g=null}j(b){this.h=arguments,this.g?this.i=!0:Lt(this)}N(){super.N(),this.g&&(h.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Pn(d){V.call(this),this.h=d,this.g={}}k(Pn,V);var Ft=[];function En(d){Ge(d.g,function(b,_){this.g.hasOwnProperty(_)&&Ct(b)},d),d.g={}}Pn.prototype.N=function(){Pn.Z.N.call(this),En(this)},Pn.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Kt=h.JSON.stringify,Sn=h.JSON.parse,me=class{stringify(d){return h.JSON.stringify(d,void 0)}parse(d){return h.JSON.parse(d,void 0)}};function Se(){}function Fe(){}var Qe={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Ue(){P.call(this,"d")}k(Ue,P);function De(){P.call(this,"c")}k(De,P);var Oe={},wt=null;function ft(){return wt=wt||new ht}Oe.Ia="serverreachability";function Q(d){P.call(this,Oe.Ia,d)}k(Q,P);function Ee(d){const b=ft();et(b,new Q(b))}Oe.STAT_EVENT="statevent";function Xe(d,b){P.call(this,Oe.STAT_EVENT,d),this.stat=b}k(Xe,P);function Je(d){const b=ft();et(b,new Xe(b,d))}Oe.Ja="timingevent";function dt(d,b){P.call(this,Oe.Ja,d),this.size=b}k(dt,P);function qt(d,b){if(typeof d!="function")throw Error("Fn must not be null and must be a function");return h.setTimeout(function(){d()},b)}function Rt(){this.g=!0}Rt.prototype.ua=function(){this.g=!1};function tn(d,b,_,N,te,ue){d.info(function(){if(d.g)if(ue){var Ye="",Jt=ue.split("&");for(let Mn=0;Mn<Jt.length;Mn++){var xs=Jt[Mn].split("=");if(xs.length>1){const is=xs[0];xs=xs[1];const Or=is.split("_");Ye=Or.length>=2&&Or[1]=="type"?Ye+(is+"="+xs+"&"):Ye+(is+"=redacted&")}}}else Ye=null;else Ye=ue;return"XMLHTTP REQ ("+N+") [attempt "+te+"]: "+b+`
`+_+`
`+Ye})}function Vn(d,b,_,N,te,ue,Ye){d.info(function(){return"XMLHTTP RESP ("+N+") [ attempt "+te+"]: "+b+`
`+_+`
`+ue+" "+Ye})}function An(d,b,_,N){d.info(function(){return"XMLHTTP TEXT ("+b+"): "+yn(d,_)+(N?" "+N:"")})}function sn(d,b){d.info(function(){return"TIMEOUT: "+b})}Rt.prototype.info=function(){};function yn(d,b){if(!d.g)return b;if(!b)return null;try{const ue=JSON.parse(b);if(ue){for(d=0;d<ue.length;d++)if(Array.isArray(ue[d])){var _=ue[d];if(!(_.length<2)){var N=_[1];if(Array.isArray(N)&&!(N.length<1)){var te=N[0];if(te!="noop"&&te!="stop"&&te!="close")for(let Ye=1;Ye<N.length;Ye++)N[Ye]=""}}}}return Kt(ue)}catch{return b}}var In={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},un={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},as;function H(){}k(H,Se),H.prototype.g=function(){return new XMLHttpRequest},as=new H;function pe(d){return encodeURIComponent(String(d))}function _e(d){var b=1;d=d.split(":");const _=[];for(;b>0&&d.length;)_.push(d.shift()),b--;return d.length&&_.push(d.join(":")),_}function xe(d,b,_,N){this.j=d,this.i=b,this.l=_,this.S=N||1,this.V=new Pn(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new ge}function ge(){this.i=null,this.g="",this.h=!1}var at={},At={};function ct(d,b,_){d.M=1,d.A=rn(Ce(b)),d.u=_,d.R=!0,_t(d,null)}function _t(d,b){d.F=Date.now(),Ts(d),d.B=Ce(d.A);var _=d.B,N=d.S;Array.isArray(N)||(N=[String(N)]),Vs(_.i,"t",N),d.C=0,_=d.j.L,d.h=new ge,d.g=Fu(d.j,_?b:null,!d.u),d.P>0&&(d.O=new Et(y(d.Y,d,d.g),d.P)),b=d.V,_=d.g,N=d.ba;var te="readystatechange";Array.isArray(te)||(te&&(Ft[0]=te.toString()),te=Ft);for(let ue=0;ue<te.length;ue++){const Ye=Ze(_,te[ue],N||b.handleEvent,!1,b.h||b);if(!Ye)break;b.g[Ye.key]=Ye}b=d.J?D(d.J):{},d.u?(d.v||(d.v="POST"),b["Content-Type"]="application/x-www-form-urlencoded",d.g.ea(d.B,d.v,d.u,b)):(d.v="GET",d.g.ea(d.B,d.v,null,b)),Ee(),tn(d.i,d.v,d.B,d.l,d.S,d.u)}xe.prototype.ba=function(d){d=d.target;const b=this.O;b&&js(d)==3?b.j():this.Y(d)},xe.prototype.Y=function(d){try{if(d==this.g)e:{const Jt=js(this.g),xs=this.g.ya(),Mn=this.g.ca();if(!(Jt<3)&&(Jt!=3||this.g&&(this.h.h||this.g.la()||Zn(this.g)))){this.K||Jt!=4||xs==7||(xs==8||Mn<=0?Ee(3):Ee(2)),Bn(this);var b=this.g.ca();this.X=b;var _=bt(this);if(this.o=b==200,Vn(this.i,this.v,this.B,this.l,this.S,Jt,b),this.o){if(this.U&&!this.L){t:{if(this.g){var N,te=this.g;if((N=te.g?te.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!M(N)){var ue=N;break t}}ue=null}if(d=ue)An(this.i,this.l,d,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,T(this,d);else{this.o=!1,this.m=3,Je(12),ce(this),q(this);break e}}if(this.R){d=!0;let is;for(;!this.K&&this.C<_.length;)if(is=sr(this,_),is==At){Jt==4&&(this.m=4,Je(14),d=!1),An(this.i,this.l,null,"[Incomplete Response]");break}else if(is==at){this.m=4,Je(15),An(this.i,this.l,_,"[Invalid Chunk]"),d=!1;break}else An(this.i,this.l,is,null),T(this,is);if(bn(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Jt!=4||_.length!=0||this.h.h||(this.m=1,Je(16),d=!1),this.o=this.o&&d,!d)An(this.i,this.l,_,"[Invalid Chunked Response]"),ce(this),q(this);else if(_.length>0&&!this.W){this.W=!0;var Ye=this.j;Ye.g==this&&Ye.aa&&!Ye.P&&(Ye.j.info("Great, no buffering proxy detected. Bytes received: "+_.length),ec(Ye),Ye.P=!0,Je(11))}}else An(this.i,this.l,_,null),T(this,_);Jt==4&&ce(this),this.o&&!this.K&&(Jt==4?Vu(this.j,this):(this.o=!1,Ts(this)))}else vs(this.g),b==400&&_.indexOf("Unknown SID")>0?(this.m=3,Je(12)):(this.m=0,Je(13)),ce(this),q(this)}}}catch{}};function bt(d){if(!bn(d))return d.g.la();const b=Zn(d.g);if(b==="")return"";let _="";const N=b.length,te=js(d.g)==4;if(!d.h.i){if(typeof TextDecoder>"u")return ce(d),q(d),"";d.h.i=new h.TextDecoder}for(let ue=0;ue<N;ue++)d.h.h=!0,_+=d.h.i.decode(b[ue],{stream:!(te&&ue==N-1)});return b.length=0,d.h.g+=_,d.C=0,d.h.g}function bn(d){return d.g?d.v=="GET"&&d.M!=2&&d.j.Aa:!1}function sr(d,b){var _=d.C,N=b.indexOf(`
`,_);return N==-1?At:(_=Number(b.substring(_,N)),isNaN(_)?at:(N+=1,N+_>b.length?At:(b=b.slice(N,N+_),d.C=N+_,b)))}xe.prototype.cancel=function(){this.K=!0,ce(this)};function Ts(d){d.T=Date.now()+d.H,Os(d,d.H)}function Os(d,b){if(d.D!=null)throw Error("WatchDog timer not null");d.D=qt(y(d.aa,d),b)}function Bn(d){d.D&&(h.clearTimeout(d.D),d.D=null)}xe.prototype.aa=function(){this.D=null;const d=Date.now();d-this.T>=0?(sn(this.i,this.B),this.M!=2&&(Ee(),Je(17)),ce(this),this.m=2,q(this)):Os(this,this.T-d)};function q(d){d.j.I==0||d.K||Vu(d.j,d)}function ce(d){Bn(d);var b=d.O;b&&typeof b.dispose=="function"&&b.dispose(),d.O=null,En(d.V),d.g&&(b=d.g,d.g=null,b.abort(),b.dispose())}function T(d,b){try{var _=d.j;if(_.I!=0&&(_.g==d||ze(_.h,d))){if(!d.L&&ze(_.h,d)&&_.I==3){try{var N=_.Ba.g.parse(b)}catch{N=null}if(Array.isArray(N)&&N.length==3){var te=N;if(te[0]==0){e:if(!_.v){if(_.g)if(_.g.F+3e3<d.F)Ko(_),Ds(_);else break e;fr(_),Je(18)}}else _.xa=te[1],0<_.xa-_.K&&te[2]<37500&&_.F&&_.A==0&&!_.C&&(_.C=qt(y(_.Va,_),6e3));$e(_.h)<=1&&_.ta&&(_.ta=void 0)}else ma(_,11)}else if((d.L||_.g==d)&&Ko(_),!M(b))for(te=_.Ba.g.parse(b),b=0;b<te.length;b++){let Mn=te[b];const is=Mn[0];if(!(is<=_.K))if(_.K=is,Mn=Mn[1],_.I==2)if(Mn[0]=="c"){_.M=Mn[1],_.ba=Mn[2];const Or=Mn[3];Or!=null&&(_.ka=Or,_.j.info("VER="+_.ka));const pa=Mn[4];pa!=null&&(_.za=pa,_.j.info("SVER="+_.za));const Zr=Mn[5];Zr!=null&&typeof Zr=="number"&&Zr>0&&(N=1.5*Zr,_.O=N,_.j.info("backChannelRequestTimeoutMs_="+N)),N=_;const ea=d.g;if(ea){const ho=ea.g?ea.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(ho){var ue=N.h;ue.g||ho.indexOf("spdy")==-1&&ho.indexOf("quic")==-1&&ho.indexOf("h2")==-1||(ue.j=ue.l,ue.g=new Set,ue.h&&(Ve(ue,ue.h),ue.h=null))}if(N.G){const Yo=ea.g?ea.g.getResponseHeader("X-HTTP-Session-Id"):null;Yo&&(N.wa=Yo,lt(N.J,N.G,Yo))}}_.I=3,_.l&&_.l.ra(),_.aa&&(_.T=Date.now()-d.F,_.j.info("Handshake RTT: "+_.T+"ms")),N=_;var Ye=d;if(N.na=zu(N,N.L?N.ba:null,N.W),Ye.L){Ut(N.h,Ye);var Jt=Ye,xs=N.O;xs&&(Jt.H=xs),Jt.D&&(Bn(Jt),Ts(Jt)),N.g=Ye}else Jr(N);_.i.length>0&&Fs(_)}else Mn[0]!="stop"&&Mn[0]!="close"||ma(_,7);else _.I==3&&(Mn[0]=="stop"||Mn[0]=="close"?Mn[0]=="stop"?ma(_,7):Bs(_):Mn[0]!="noop"&&_.l&&_.l.qa(Mn),_.A=0)}}Ee(4)}catch{}}var C=class{constructor(d,b){this.g=d,this.map=b}};function Y(d){this.l=d||10,h.PerformanceNavigationTiming?(d=h.performance.getEntriesByType("navigation"),d=d.length>0&&(d[0].nextHopProtocol=="hq"||d[0].nextHopProtocol=="h2")):d=!!(h.chrome&&h.chrome.loadTimes&&h.chrome.loadTimes()&&h.chrome.loadTimes().wasFetchedViaSpdy),this.j=d?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function se(d){return d.h?!0:d.g?d.g.size>=d.j:!1}function $e(d){return d.h?1:d.g?d.g.size:0}function ze(d,b){return d.h?d.h==b:d.g?d.g.has(b):!1}function Ve(d,b){d.g?d.g.add(b):d.h=b}function Ut(d,b){d.h&&d.h==b?d.h=null:d.g&&d.g.has(b)&&d.g.delete(b)}Y.prototype.cancel=function(){if(this.i=kt(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const d of this.g.values())d.cancel();this.g.clear()}};function kt(d){if(d.h!=null)return d.i.concat(d.h.G);if(d.g!=null&&d.g.size!==0){let b=d.i;for(const _ of d.g.values())b=b.concat(_.G);return b}return O(d.i)}var G=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function he(d,b){if(d){d=d.split("&");for(let _=0;_<d.length;_++){const N=d[_].indexOf("=");let te,ue=null;N>=0?(te=d[_].substring(0,N),ue=d[_].substring(N+1)):te=d[_],b(te,ue?decodeURIComponent(ue.replace(/\+/g," ")):"")}}}function ie(d){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let b;d instanceof ie?(this.l=d.l,Le(this,d.j),this.o=d.o,this.g=d.g,it(this,d.u),this.h=d.h,It(this,Lr(d.i)),this.m=d.m):d&&(b=String(d).match(G))?(this.l=!1,Le(this,b[1]||"",!0),this.o=Un(b[2]||""),this.g=Un(b[3]||"",!0),it(this,b[4]),this.h=Un(b[5]||"",!0),It(this,b[6]||"",!0),this.m=Un(b[7]||"")):(this.l=!1,this.i=new ts(null,this.l))}ie.prototype.toString=function(){const d=[];var b=this.j;b&&d.push(vn(b,wr,!0),":");var _=this.g;return(_||b=="file")&&(d.push("//"),(b=this.o)&&d.push(vn(b,wr,!0),"@"),d.push(pe(_).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),_=this.u,_!=null&&d.push(":",String(_))),(_=this.h)&&(this.g&&_.charAt(0)!="/"&&d.push("/"),d.push(vn(_,_.charAt(0)=="/"?Xr:Da,!0))),(_=this.i.toString())&&d.push("?",_),(_=this.m)&&d.push("#",vn(_,wn)),d.join("")},ie.prototype.resolve=function(d){const b=Ce(this);let _=!!d.j;_?Le(b,d.j):_=!!d.o,_?b.o=d.o:_=!!d.g,_?b.g=d.g:_=d.u!=null;var N=d.h;if(_)it(b,d.u);else if(_=!!d.h){if(N.charAt(0)!="/")if(this.g&&!this.h)N="/"+N;else{var te=b.h.lastIndexOf("/");te!=-1&&(N=b.h.slice(0,te+1)+N)}if(te=N,te==".."||te==".")N="";else if(te.indexOf("./")!=-1||te.indexOf("/.")!=-1){N=te.lastIndexOf("/",0)==0,te=te.split("/");const ue=[];for(let Ye=0;Ye<te.length;){const Jt=te[Ye++];Jt=="."?N&&Ye==te.length&&ue.push(""):Jt==".."?((ue.length>1||ue.length==1&&ue[0]!="")&&ue.pop(),N&&Ye==te.length&&ue.push("")):(ue.push(Jt),N=!0)}N=ue.join("/")}else N=te}return _?b.h=N:_=d.i.toString()!=="",_?It(b,Lr(d.i)):_=!!d.m,_&&(b.m=d.m),b};function Ce(d){return new ie(d)}function Le(d,b,_){d.j=_?Un(b,!0):b,d.j&&(d.j=d.j.replace(/:$/,""))}function it(d,b){if(b){if(b=Number(b),isNaN(b)||b<0)throw Error("Bad port number "+b);d.u=b}else d.u=null}function It(d,b,_){b instanceof ts?(d.i=b,fa(d.i,d.l)):(_||(b=vn(b,_r)),d.i=new ts(b,d.l))}function lt(d,b,_){d.i.set(b,_)}function rn(d){return lt(d,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),d}function Un(d,b){return d?b?decodeURI(d.replace(/%25/g,"%2525")):decodeURIComponent(d):""}function vn(d,b,_){return typeof d=="string"?(d=encodeURI(d).replace(b,xn),_&&(d=d.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),d):null}function xn(d){return d=d.charCodeAt(0),"%"+(d>>4&15).toString(16)+(d&15).toString(16)}var wr=/[#\/\?@]/g,Da=/[#\?:]/g,Xr=/[#\?]/g,_r=/[#\?@]/g,wn=/#/g;function ts(d,b){this.h=this.g=null,this.i=d||null,this.j=!!b}function Gn(d){d.g||(d.g=new Map,d.h=0,d.i&&he(d.i,function(b,_){d.add(decodeURIComponent(b.replace(/\+/g," ")),_)}))}s=ts.prototype,s.add=function(d,b){Gn(this),this.i=null,d=Tr(this,d);let _=this.g.get(d);return _||this.g.set(d,_=[]),_.push(b),this.h+=1,this};function kr(d,b){Gn(d),b=Tr(d,b),d.g.has(b)&&(d.i=null,d.h-=d.g.get(b).length,d.g.delete(b))}function hr(d,b){return Gn(d),b=Tr(d,b),d.g.has(b)}s.forEach=function(d,b){Gn(this),this.g.forEach(function(_,N){_.forEach(function(te){d.call(b,te,N,this)},this)},this)};function Ms(d,b){Gn(d);let _=[];if(typeof b=="string")hr(d,b)&&(_=_.concat(d.g.get(Tr(d,b))));else for(d=Array.from(d.g.values()),b=0;b<d.length;b++)_=_.concat(d[b]);return _}s.set=function(d,b){return Gn(this),this.i=null,d=Tr(this,d),hr(this,d)&&(this.h-=this.g.get(d).length),this.g.set(d,[b]),this.h+=1,this},s.get=function(d,b){return d?(d=Ms(this,d),d.length>0?String(d[0]):b):b};function Vs(d,b,_){kr(d,b),_.length>0&&(d.i=null,d.g.set(Tr(d,b),O(_)),d.h+=_.length)}s.toString=function(){if(this.i)return this.i;if(!this.g)return"";const d=[],b=Array.from(this.g.keys());for(let N=0;N<b.length;N++){var _=b[N];const te=pe(_);_=Ms(this,_);for(let ue=0;ue<_.length;ue++){let Ye=te;_[ue]!==""&&(Ye+="="+pe(_[ue])),d.push(Ye)}}return this.i=d.join("&")};function Lr(d){const b=new ts;return b.i=d.i,d.g&&(b.g=new Map(d.g),b.h=d.h),b}function Tr(d,b){return b=String(b),d.j&&(b=b.toLowerCase()),b}function fa(d,b){b&&!d.j&&(Gn(d),d.i=null,d.g.forEach(function(_,N){const te=N.toLowerCase();N!=te&&(kr(this,N),Vs(this,te,_))},d)),d.j=b}function A(d,b){const _=new Rt;if(h.Image){const N=new Image;N.onload=w(Pe,_,"TestLoadImage: loaded",!0,b,N),N.onerror=w(Pe,_,"TestLoadImage: error",!1,b,N),N.onabort=w(Pe,_,"TestLoadImage: abort",!1,b,N),N.ontimeout=w(Pe,_,"TestLoadImage: timeout",!1,b,N),h.setTimeout(function(){N.ontimeout&&N.ontimeout()},1e4),N.src=d}else b(!1)}function ee(d,b){const _=new Rt,N=new AbortController,te=setTimeout(()=>{N.abort(),Pe(_,"TestPingServer: timeout",!1,b)},1e4);fetch(d,{signal:N.signal}).then(ue=>{clearTimeout(te),ue.ok?Pe(_,"TestPingServer: ok",!0,b):Pe(_,"TestPingServer: server error",!1,b)}).catch(()=>{clearTimeout(te),Pe(_,"TestPingServer: error",!1,b)})}function Pe(d,b,_,N,te){try{te&&(te.onload=null,te.onerror=null,te.onabort=null,te.ontimeout=null),N(_)}catch{}}function tt(){this.g=new me}function mt(d){this.i=d.Sb||null,this.h=d.ab||!1}k(mt,Se),mt.prototype.g=function(){return new Dt(this.i,this.h)};function Dt(d,b){ht.call(this),this.H=d,this.o=b,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}k(Dt,ht),s=Dt.prototype,s.open=function(d,b){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=d,this.D=b,this.readyState=1,Pt(this)},s.send=function(d){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const b={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};d&&(b.body=d),(this.H||h).fetch(new Request(this.D,b)).then(this.Pa.bind(this),this.ga.bind(this))},s.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,zt(this)),this.readyState=0},s.Pa=function(d){if(this.g&&(this.l=d,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=d.headers,this.readyState=2,Pt(this)),this.g&&(this.readyState=3,Pt(this),this.g)))if(this.responseType==="arraybuffer")d.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof h.ReadableStream<"u"&&"body"in d){if(this.j=d.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;st(this)}else d.text().then(this.Oa.bind(this),this.ga.bind(this))};function st(d){d.j.read().then(d.Ma.bind(d)).catch(d.ga.bind(d))}s.Ma=function(d){if(this.g){if(this.o&&d.value)this.response.push(d.value);else if(!this.o){var b=d.value?d.value:new Uint8Array(0);(b=this.B.decode(b,{stream:!d.done}))&&(this.response=this.responseText+=b)}d.done?zt(this):Pt(this),this.readyState==3&&st(this)}},s.Oa=function(d){this.g&&(this.response=this.responseText=d,zt(this))},s.Na=function(d){this.g&&(this.response=d,zt(this))},s.ga=function(){this.g&&zt(this)};function zt(d){d.readyState=4,d.l=null,d.j=null,d.B=null,Pt(d)}s.setRequestHeader=function(d,b){this.A.append(d,b)},s.getResponseHeader=function(d){return this.h&&this.h.get(d.toLowerCase())||""},s.getAllResponseHeaders=function(){if(!this.h)return"";const d=[],b=this.h.entries();for(var _=b.next();!_.done;)_=_.value,d.push(_[0]+": "+_[1]),_=b.next();return d.join(`\r
`)};function Pt(d){d.onreadystatechange&&d.onreadystatechange.call(d)}Object.defineProperty(Dt.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(d){this.m=d?"include":"same-origin"}});function Xt(d){let b="";return Ge(d,function(_,N){b+=N,b+=":",b+=_,b+=`\r
`}),b}function _n(d,b,_){e:{for(N in _){var N=!1;break e}N=!0}N||(_=Xt(_),typeof d=="string"?_!=null&&pe(_):lt(d,b,_))}function gt(d){ht.call(this),this.headers=new Map,this.L=d||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}k(gt,ht);var cs=/^https?$/i,Xn=["POST","PUT"];s=gt.prototype,s.Fa=function(d){this.H=d},s.ea=function(d,b,_,N){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+d);b=b?b.toUpperCase():"GET",this.D=d,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():as.g(),this.g.onreadystatechange=j(y(this.Ca,this));try{this.B=!0,this.g.open(b,String(d),!0),this.B=!1}catch(ue){Kn(this,ue);return}if(d=_||"",_=new Map(this.headers),N)if(Object.getPrototypeOf(N)===Object.prototype)for(var te in N)_.set(te,N[te]);else if(typeof N.keys=="function"&&typeof N.get=="function")for(const ue of N.keys())_.set(ue,N.get(ue));else throw Error("Unknown input type for opt_headers: "+String(N));N=Array.from(_.keys()).find(ue=>ue.toLowerCase()=="content-type"),te=h.FormData&&d instanceof h.FormData,!(Array.prototype.indexOf.call(Xn,b,void 0)>=0)||N||te||_.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[ue,Ye]of _)this.g.setRequestHeader(ue,Ye);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(d),this.v=!1}catch(ue){Kn(this,ue)}};function Kn(d,b){d.h=!1,d.g&&(d.j=!0,d.g.abort(),d.j=!1),d.l=b,d.o=5,fs(d),us(d)}function fs(d){d.A||(d.A=!0,et(d,"complete"),et(d,"error"))}s.abort=function(d){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=d||7,et(this,"complete"),et(this,"abort"),us(this))},s.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),us(this,!0)),gt.Z.N.call(this)},s.Ca=function(){this.u||(this.B||this.v||this.j?Jn(this):this.Xa())},s.Xa=function(){Jn(this)};function Jn(d){if(d.h&&typeof u<"u"){if(d.v&&js(d)==4)setTimeout(d.Ca.bind(d),0);else if(et(d,"readystatechange"),js(d)==4){d.h=!1;try{const ue=d.ca();e:switch(ue){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var b=!0;break e;default:b=!1}var _;if(!(_=b)){var N;if(N=ue===0){let Ye=String(d.D).match(G)[1]||null;!Ye&&h.self&&h.self.location&&(Ye=h.self.location.protocol.slice(0,-1)),N=!cs.test(Ye?Ye.toLowerCase():"")}_=N}if(_)et(d,"complete"),et(d,"success");else{d.o=6;try{var te=js(d)>2?d.g.statusText:""}catch{te=""}d.l=te+" ["+d.ca()+"]",fs(d)}}finally{us(d)}}}}function us(d,b){if(d.g){d.m&&(clearTimeout(d.m),d.m=null);const _=d.g;d.g=null,b||et(d,"ready");try{_.onreadystatechange=null}catch{}}}s.isActive=function(){return!!this.g};function js(d){return d.g?d.g.readyState:0}s.ca=function(){try{return js(this)>2?this.g.status:-1}catch{return-1}},s.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},s.La=function(d){if(this.g){var b=this.g.responseText;return d&&b.indexOf(d)==0&&(b=b.substring(d.length)),Sn(b)}};function Zn(d){try{if(!d.g)return null;if("response"in d.g)return d.g.response;switch(d.F){case"":case"text":return d.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in d.g)return d.g.mozResponseArrayBuffer}return null}catch{return null}}function vs(d){const b={};d=(d.g&&js(d)>=2&&d.g.getAllResponseHeaders()||"").split(`\r
`);for(let N=0;N<d.length;N++){if(M(d[N]))continue;var _=_e(d[N]);const te=_[0];if(_=_[1],typeof _!="string")continue;_=_.trim();const ue=b[te]||[];b[te]=ue,ue.push(_)}J(b,function(N){return N.join(", ")})}s.ya=function(){return this.o},s.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Qs(d,b,_){return _&&_.internalChannelParams&&_.internalChannelParams[d]||b}function jr(d){this.za=0,this.i=[],this.j=new Rt,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Qs("failFast",!1,d),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Qs("baseRetryDelayMs",5e3,d),this.Za=Qs("retryDelaySeedMs",1e4,d),this.Ta=Qs("forwardChannelMaxRetries",2,d),this.va=Qs("forwardChannelRequestTimeoutMs",2e4,d),this.ma=d&&d.xmlHttpFactory||void 0,this.Ua=d&&d.Rb||void 0,this.Aa=d&&d.useFetchStreams||!1,this.O=void 0,this.L=d&&d.supportsCrossDomainXhr||!1,this.M="",this.h=new Y(d&&d.concurrentRequestLimit),this.Ba=new tt,this.S=d&&d.fastHandshake||!1,this.R=d&&d.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=d&&d.Pb||!1,d&&d.ua&&this.j.ua(),d&&d.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&d&&d.detectBufferingProxy||!1,this.ia=void 0,d&&d.longPollingTimeout&&d.longPollingTimeout>0&&(this.ia=d.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}s=jr.prototype,s.ka=8,s.I=1,s.connect=function(d,b,_,N){Je(0),this.W=d,this.H=b||{},_&&N!==void 0&&(this.H.OSID=_,this.H.OAID=N),this.F=this.X,this.J=zu(this,null,this.W),Fs(this)};function Bs(d){if(dr(d),d.I==3){var b=d.V++,_=Ce(d.J);if(lt(_,"SID",d.M),lt(_,"RID",b),lt(_,"TYPE","terminate"),La(d,_),b=new xe(d,d.j,b),b.M=2,b.A=rn(Ce(_)),_=!1,h.navigator&&h.navigator.sendBeacon)try{_=h.navigator.sendBeacon(b.A.toString(),"")}catch{}!_&&h.Image&&(new Image().src=b.A,_=!0),_||(b.g=Fu(b.j,null),b.g.ea(b.A)),b.F=Date.now(),Ts(b)}Uu(d)}function Ds(d){d.g&&(ec(d),d.g.cancel(),d.g=null)}function dr(d){Ds(d),d.v&&(h.clearTimeout(d.v),d.v=null),Ko(d),d.h.cancel(),d.m&&(typeof d.m=="number"&&h.clearTimeout(d.m),d.m=null)}function Fs(d){if(!se(d.h)&&!d.m){d.m=!0;var b=d.Ea;We||S(),Be||(We(),Be=!0),R.add(b,d),d.D=0}}function Pa(d,b){return $e(d.h)>=d.h.j-(d.m?1:0)?!1:d.m?(d.i=b.G.concat(d.i),!0):d.I==1||d.I==2||d.D>=(d.Sa?0:d.Ta)?!1:(d.m=qt(y(d.Ea,d,b),Bu(d,d.D)),d.D++,!0)}s.Ea=function(d){if(this.m)if(this.m=null,this.I==1){if(!d){this.V=Math.floor(Math.random()*1e5),d=this.V++;const te=new xe(this,this.j,d);let ue=this.o;if(this.U&&(ue?(ue=D(ue),be(ue,this.U)):ue=this.U),this.u!==null||this.R||(te.J=ue,ue=null),this.S)e:{for(var b=0,_=0;_<this.i.length;_++){t:{var N=this.i[_];if("__data__"in N.map&&(N=N.map.__data__,typeof N=="string")){N=N.length;break t}N=void 0}if(N===void 0)break;if(b+=N,b>4096){b=_;break e}if(b===4096||_===this.i.length-1){b=_+1;break e}}b=1e3}else b=1e3;b=Oa(this,te,b),_=Ce(this.J),lt(_,"RID",d),lt(_,"CVER",22),this.G&&lt(_,"X-HTTP-Session-Id",this.G),La(this,_),ue&&(this.R?b="headers="+pe(Xt(ue))+"&"+b:this.u&&_n(_,this.u,ue)),Ve(this.h,te),this.Ra&&lt(_,"TYPE","init"),this.S?(lt(_,"$req",b),lt(_,"SID","null"),te.U=!0,ct(te,_,null)):ct(te,_,b),this.I=2}}else this.I==3&&(d?uo(this,d):this.i.length==0||se(this.h)||uo(this))};function uo(d,b){var _;b?_=b.l:_=d.V++;const N=Ce(d.J);lt(N,"SID",d.M),lt(N,"RID",_),lt(N,"AID",d.K),La(d,N),d.u&&d.o&&_n(N,d.u,d.o),_=new xe(d,d.j,_,d.D+1),d.u===null&&(_.J=d.o),b&&(d.i=b.G.concat(d.i)),b=Oa(d,_,1e3),_.H=Math.round(d.va*.5)+Math.round(d.va*.5*Math.random()),Ve(d.h,_),ct(_,N,b)}function La(d,b){d.H&&Ge(d.H,function(_,N){lt(b,N,_)}),d.l&&Ge({},function(_,N){lt(b,N,_)})}function Oa(d,b,_){_=Math.min(d.i.length,_);const N=d.l?y(d.l.Ka,d.l,d):null;e:{var te=d.i;let Jt=-1;for(;;){const xs=["count="+_];Jt==-1?_>0?(Jt=te[0].g,xs.push("ofs="+Jt)):Jt=0:xs.push("ofs="+Jt);let Mn=!0;for(let is=0;is<_;is++){var ue=te[is].g;const Or=te[is].map;if(ue-=Jt,ue<0)Jt=Math.max(0,te[is].g-100),Mn=!1;else try{ue="req"+ue+"_"||"";try{var Ye=Or instanceof Map?Or:Object.entries(Or);for(const[pa,Zr]of Ye){let ea=Zr;p(Zr)&&(ea=Kt(Zr)),xs.push(ue+pa+"="+encodeURIComponent(ea))}}catch(pa){throw xs.push(ue+"type="+encodeURIComponent("_badmap")),pa}}catch{N&&N(Or)}}if(Mn){Ye=xs.join("&");break e}}Ye=void 0}return d=d.i.splice(0,_),b.G=d,Ye}function Jr(d){if(!d.g&&!d.v){d.Y=1;var b=d.Da;We||S(),Be||(We(),Be=!0),R.add(b,d),d.A=0}}function fr(d){return d.g||d.v||d.A>=3?!1:(d.Y++,d.v=qt(y(d.Da,d),Bu(d,d.A)),d.A++,!0)}s.Da=function(){if(this.v=null,Ou(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var d=4*this.T;this.j.info("BP detection timer enabled: "+d),this.B=qt(y(this.Wa,this),d)}},s.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Je(10),Ds(this),Ou(this))};function ec(d){d.B!=null&&(h.clearTimeout(d.B),d.B=null)}function Ou(d){d.g=new xe(d,d.j,"rpc",d.Y),d.u===null&&(d.g.J=d.o),d.g.P=0;var b=Ce(d.na);lt(b,"RID","rpc"),lt(b,"SID",d.M),lt(b,"AID",d.K),lt(b,"CI",d.F?"0":"1"),!d.F&&d.ia&&lt(b,"TO",d.ia),lt(b,"TYPE","xmlhttp"),La(d,b),d.u&&d.o&&_n(b,d.u,d.o),d.O&&(d.g.H=d.O);var _=d.g;d=d.ba,_.M=1,_.A=rn(Ce(b)),_.u=null,_.R=!0,_t(_,d)}s.Va=function(){this.C!=null&&(this.C=null,Ds(this),fr(this),Je(19))};function Ko(d){d.C!=null&&(h.clearTimeout(d.C),d.C=null)}function Vu(d,b){var _=null;if(d.g==b){Ko(d),ec(d),d.g=null;var N=2}else if(ze(d.h,b))_=b.G,Ut(d.h,b),N=1;else return;if(d.I!=0){if(b.o)if(N==1){_=b.u?b.u.length:0,b=Date.now()-b.F;var te=d.D;N=ft(),et(N,new dt(N,_)),Fs(d)}else Jr(d);else if(te=b.m,te==3||te==0&&b.X>0||!(N==1&&Pa(d,b)||N==2&&fr(d)))switch(_&&_.length>0&&(b=d.h,b.i=b.i.concat(_)),te){case 1:ma(d,5);break;case 4:ma(d,10);break;case 3:ma(d,6);break;default:ma(d,2)}}}function Bu(d,b){let _=d.Qa+Math.floor(Math.random()*d.Za);return d.isActive()||(_*=2),_*b}function ma(d,b){if(d.j.info("Error code "+b),b==2){var _=y(d.bb,d),N=d.Ua;const te=!N;N=new ie(N||"//www.google.com/images/cleardot.gif"),h.location&&h.location.protocol=="http"||Le(N,"https"),rn(N),te?A(N.toString(),_):ee(N.toString(),_)}else Je(2);d.I=0,d.l&&d.l.pa(b),Uu(d),dr(d)}s.bb=function(d){d?(this.j.info("Successfully pinged google.com"),Je(2)):(this.j.info("Failed to ping google.com"),Je(1))};function Uu(d){if(d.I=0,d.ja=[],d.l){const b=kt(d.h);(b.length!=0||d.i.length!=0)&&($(d.ja,b),$(d.ja,d.i),d.h.i.length=0,O(d.i),d.i.length=0),d.l.oa()}}function zu(d,b,_){var N=_ instanceof ie?Ce(_):new ie(_);if(N.g!="")b&&(N.g=b+"."+N.g),it(N,N.u);else{var te=h.location;N=te.protocol,b=b?b+"."+te.hostname:te.hostname,te=+te.port;const ue=new ie(null);N&&Le(ue,N),b&&(ue.g=b),te&&it(ue,te),_&&(ue.h=_),N=ue}return _=d.G,b=d.wa,_&&b&&lt(N,_,b),lt(N,"VER",d.ka),La(d,N),N}function Fu(d,b,_){if(b&&!d.L)throw Error("Can't create secondary domain capable XhrIo object.");return b=d.Aa&&!d.ma?new gt(new mt({ab:_})):new gt(d.ma),b.Fa(d.L),b}s.isActive=function(){return!!this.l&&this.l.isActive(this)};function qu(){}s=qu.prototype,s.ra=function(){},s.qa=function(){},s.pa=function(){},s.oa=function(){},s.isActive=function(){return!0},s.Ka=function(){};function mi(){}mi.prototype.g=function(d,b){return new rr(d,b)};function rr(d,b){ht.call(this),this.g=new jr(b),this.l=d,this.h=b&&b.messageUrlParams||null,d=b&&b.messageHeaders||null,b&&b.clientProtocolHeaderRequired&&(d?d["X-Client-Protocol"]="webchannel":d={"X-Client-Protocol":"webchannel"}),this.g.o=d,d=b&&b.initMessageHeaders||null,b&&b.messageContentType&&(d?d["X-WebChannel-Content-Type"]=b.messageContentType:d={"X-WebChannel-Content-Type":b.messageContentType}),b&&b.sa&&(d?d["X-WebChannel-Client-Profile"]=b.sa:d={"X-WebChannel-Client-Profile":b.sa}),this.g.U=d,(d=b&&b.Qb)&&!M(d)&&(this.g.u=d),this.A=b&&b.supportsCrossDomainXhr||!1,this.v=b&&b.sendRawJson||!1,(b=b&&b.httpSessionIdParam)&&!M(b)&&(this.g.G=b,d=this.h,d!==null&&b in d&&(d=this.h,b in d&&delete d[b])),this.j=new Va(this)}k(rr,ht),rr.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},rr.prototype.close=function(){Bs(this.g)},rr.prototype.o=function(d){var b=this.g;if(typeof d=="string"){var _={};_.__data__=d,d=_}else this.v&&(_={},_.__data__=Kt(d),d=_);b.i.push(new C(b.Ya++,d)),b.I==3&&Fs(b)},rr.prototype.N=function(){this.g.l=null,delete this.j,Bs(this.g),delete this.g,rr.Z.N.call(this)};function Hu(d){Ue.call(this),d.__headers__&&(this.headers=d.__headers__,this.statusCode=d.__status__,delete d.__headers__,delete d.__status__);var b=d.__sm__;if(b){e:{for(const _ in b){d=_;break e}d=void 0}(this.i=d)&&(d=this.i,b=b!==null&&d in b?b[d]:void 0),this.data=b}else this.data=d}k(Hu,Ue);function $u(){De.call(this),this.status=1}k($u,De);function Va(d){this.g=d}k(Va,qu),Va.prototype.ra=function(){et(this.g,"a")},Va.prototype.qa=function(d){et(this.g,new Hu(d))},Va.prototype.pa=function(d){et(this.g,new $u)},Va.prototype.oa=function(){et(this.g,"b")},mi.prototype.createWebChannel=mi.prototype.g,rr.prototype.send=rr.prototype.o,rr.prototype.open=rr.prototype.m,rr.prototype.close=rr.prototype.close,Ow=function(){return new mi},Lw=function(){return ft()},Pw=Oe,lg={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},In.NO_ERROR=0,In.TIMEOUT=8,In.HTTP_ERROR=6,gd=In,un.COMPLETE="complete",Dw=un,Fe.EventType=Qe,Qe.OPEN="a",Qe.CLOSE="b",Qe.ERROR="c",Qe.MESSAGE="d",ht.prototype.listen=ht.prototype.J,Gc=Fe,gt.prototype.listenOnce=gt.prototype.K,gt.prototype.getLastError=gt.prototype.Ha,gt.prototype.getLastErrorCode=gt.prototype.ya,gt.prototype.getStatus=gt.prototype.ca,gt.prototype.getResponseJson=gt.prototype.La,gt.prototype.getResponseText=gt.prototype.la,gt.prototype.send=gt.prototype.ea,gt.prototype.setWithCredentials=gt.prototype.Fa,Mw=gt}).apply(typeof Xh<"u"?Xh:typeof self<"u"?self:typeof window<"u"?window:{});class Zs{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Zs.UNAUTHENTICATED=new Zs(null),Zs.GOOGLE_CREDENTIALS=new Zs("google-credentials-uid"),Zs.FIRST_PARTY=new Zs("first-party-uid"),Zs.MOCK_USER=new Zs("mock-user");let Yl="12.8.0";function W4(s){Yl=s}const zo=new Lg("@firebase/firestore");function Cl(){return zo.logLevel}function ot(s,...e){if(zo.logLevel<=fn.DEBUG){const t=e.map(Yg);zo.debug(`Firestore (${Yl}): ${s}`,...t)}}function ci(s,...e){if(zo.logLevel<=fn.ERROR){const t=e.map(Yg);zo.error(`Firestore (${Yl}): ${s}`,...t)}}function Bl(s,...e){if(zo.logLevel<=fn.WARN){const t=e.map(Yg);zo.warn(`Firestore (${Yl}): ${s}`,...t)}}function Yg(s){if(typeof s=="string")return s;try{return(function(t){return JSON.stringify(t)})(s)}catch{return s}}function Vt(s,e,t){let i="Unexpected state";typeof e=="string"?i=e:t=e,Vw(s,i,t)}function Vw(s,e,t){let i=`FIRESTORE (${Yl}) INTERNAL ASSERTION FAILED: ${e} (ID: ${s.toString(16)})`;if(t!==void 0)try{i+=" CONTEXT: "+JSON.stringify(t)}catch{i+=" CONTEXT: "+t}throw ci(i),new Error(i)}function On(s,e,t,i){let l="Unexpected state";typeof t=="string"?l=t:i=t,s||Vw(e,l,i)}function Qt(s,e){return s}const ke={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class nt extends Ia{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class ri{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class Bw{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class G4{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(Zs.UNAUTHENTICATED)))}shutdown(){}}class K4{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class Y4{constructor(e){this.t=e,this.currentUser=Zs.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){On(this.o===void 0,42304);let i=this.i;const l=g=>this.i!==i?(i=this.i,t(g)):Promise.resolve();let u=new ri;this.o=()=>{this.i++,this.currentUser=this.u(),u.resolve(),u=new ri,e.enqueueRetryable((()=>l(this.currentUser)))};const h=()=>{const g=u;e.enqueueRetryable((async()=>{await g.promise,await l(this.currentUser)}))},p=g=>{ot("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=g,this.o&&(this.auth.addAuthTokenListener(this.o),h())};this.t.onInit((g=>p(g))),setTimeout((()=>{if(!this.auth){const g=this.t.getImmediate({optional:!0});g?p(g):(ot("FirebaseAuthCredentialsProvider","Auth not yet detected"),u.resolve(),u=new ri)}}),0),h()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((i=>this.i!==e?(ot("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(On(typeof i.accessToken=="string",31837,{l:i}),new Bw(i.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return On(e===null||typeof e=="string",2055,{h:e}),new Zs(e)}}class Q4{constructor(e,t,i){this.P=e,this.T=t,this.I=i,this.type="FirstParty",this.user=Zs.FIRST_PARTY,this.R=new Map}A(){return this.I?this.I():null}get headers(){this.R.set("X-Goog-AuthUser",this.P);const e=this.A();return e&&this.R.set("Authorization",e),this.T&&this.R.set("X-Goog-Iam-Authorization-Token",this.T),this.R}}class X4{constructor(e,t,i){this.P=e,this.T=t,this.I=i}getToken(){return Promise.resolve(new Q4(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(Zs.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class ix{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class J4{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Mr(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){On(this.o===void 0,3512);const i=u=>{u.error!=null&&ot("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${u.error.message}`);const h=u.token!==this.m;return this.m=u.token,ot("FirebaseAppCheckTokenProvider",`Received ${h?"new":"existing"} token.`),h?t(u.token):Promise.resolve()};this.o=u=>{e.enqueueRetryable((()=>i(u)))};const l=u=>{ot("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=u,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((u=>l(u))),setTimeout((()=>{if(!this.appCheck){const u=this.V.getImmediate({optional:!0});u?l(u):ot("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new ix(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(On(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new ix(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function Z4(s){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(s);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let i=0;i<s;i++)t[i]=Math.floor(256*Math.random());return t}class Qg{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const l=Z4(40);for(let u=0;u<l.length;++u)i.length<20&&l[u]<t&&(i+=e.charAt(l[u]%62))}return i}}function mn(s,e){return s<e?-1:s>e?1:0}function cg(s,e){const t=Math.min(s.length,e.length);for(let i=0;i<t;i++){const l=s.charAt(i),u=e.charAt(i);if(l!==u)return Np(l)===Np(u)?mn(l,u):Np(l)?1:-1}return mn(s.length,e.length)}const eR=55296,tR=57343;function Np(s){const e=s.charCodeAt(0);return e>=eR&&e<=tR}function Ul(s,e,t){return s.length===e.length&&s.every(((i,l)=>t(i,e[l])))}const ox="__name__";class wa{constructor(e,t,i){t===void 0?t=0:t>e.length&&Vt(637,{offset:t,range:e.length}),i===void 0?i=e.length-t:i>e.length-t&&Vt(1746,{length:i,range:e.length-t}),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return wa.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof wa?e.forEach((i=>{t.push(i)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const i=Math.min(e.length,t.length);for(let l=0;l<i;l++){const u=wa.compareSegments(e.get(l),t.get(l));if(u!==0)return u}return mn(e.length,t.length)}static compareSegments(e,t){const i=wa.isNumericId(e),l=wa.isNumericId(t);return i&&!l?-1:!i&&l?1:i&&l?wa.extractNumericId(e).compare(wa.extractNumericId(t)):cg(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Xi.fromString(e.substring(4,e.length-2))}}class es extends wa{construct(e,t,i){return new es(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const i of e){if(i.indexOf("//")>=0)throw new nt(ke.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter((l=>l.length>0)))}return new es(t)}static emptyPath(){return new es([])}}const nR=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Ks extends wa{construct(e,t,i){return new Ks(e,t,i)}static isValidIdentifier(e){return nR.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Ks.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===ox}static keyField(){return new Ks([ox])}static fromServerFormat(e){const t=[];let i="",l=0;const u=()=>{if(i.length===0)throw new nt(ke.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""};let h=!1;for(;l<e.length;){const p=e[l];if(p==="\\"){if(l+1===e.length)throw new nt(ke.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const g=e[l+1];if(g!=="\\"&&g!=="."&&g!=="`")throw new nt(ke.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=g,l+=2}else p==="`"?(h=!h,l++):p!=="."||h?(i+=p,l++):(u(),l++)}if(u(),h)throw new nt(ke.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Ks(t)}static emptyPath(){return new Ks([])}}class jt{constructor(e){this.path=e}static fromPath(e){return new jt(es.fromString(e))}static fromName(e){return new jt(es.fromString(e).popFirst(5))}static empty(){return new jt(es.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&es.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return es.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new jt(new es(e.slice()))}}function Uw(s,e,t){if(!t)throw new nt(ke.INVALID_ARGUMENT,`Function ${s}() cannot be called with an empty ${e}.`)}function sR(s,e,t,i){if(e===!0&&i===!0)throw new nt(ke.INVALID_ARGUMENT,`${s} and ${t} cannot be used together.`)}function lx(s){if(!jt.isDocumentKey(s))throw new nt(ke.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${s} has ${s.length}.`)}function cx(s){if(jt.isDocumentKey(s))throw new nt(ke.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${s} has ${s.length}.`)}function zw(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}function Zd(s){if(s===void 0)return"undefined";if(s===null)return"null";if(typeof s=="string")return s.length>20&&(s=`${s.substring(0,20)}...`),JSON.stringify(s);if(typeof s=="number"||typeof s=="boolean")return""+s;if(typeof s=="object"){if(s instanceof Array)return"an array";{const e=(function(i){return i.constructor?i.constructor.name:null})(s);return e?`a custom ${e} object`:"an object"}}return typeof s=="function"?"a function":Vt(12329,{type:typeof s})}function cr(s,e){if("_delegate"in s&&(s=s._delegate),!(s instanceof e)){if(e.name===s.constructor.name)throw new nt(ke.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=Zd(s);throw new nt(ke.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return s}function rR(s,e){if(e<=0)throw new nt(ke.INVALID_ARGUMENT,`Function ${s}() requires a positive number, but it was: ${e}.`)}function Is(s,e){const t={typeString:s};return e&&(t.value=e),t}function Eu(s,e){if(!zw(s))throw new nt(ke.INVALID_ARGUMENT,"JSON must be an object");let t;for(const i in e)if(e[i]){const l=e[i].typeString,u="value"in e[i]?{value:e[i].value}:void 0;if(!(i in s)){t=`JSON missing required field: '${i}'`;break}const h=s[i];if(l&&typeof h!==l){t=`JSON field '${i}' must be a ${l}.`;break}if(u!==void 0&&h!==u.value){t=`Expected '${i}' field to equal '${u.value}'`;break}}if(t)throw new nt(ke.INVALID_ARGUMENT,t);return!0}const ux=-62135596800,hx=1e6;class vt{static now(){return vt.fromMillis(Date.now())}static fromDate(e){return vt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),i=Math.floor((e-1e3*t)*hx);return new vt(t,i)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new nt(ke.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new nt(ke.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<ux)throw new nt(ke.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new nt(ke.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/hx}_compareTo(e){return this.seconds===e.seconds?mn(this.nanoseconds,e.nanoseconds):mn(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:vt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Eu(e,vt._jsonSchema))return new vt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-ux;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}vt._jsonSchemaVersion="firestore/timestamp/1.0",vt._jsonSchema={type:Is("string",vt._jsonSchemaVersion),seconds:Is("number"),nanoseconds:Is("number")};class Gt{static fromTimestamp(e){return new Gt(e)}static min(){return new Gt(new vt(0,0))}static max(){return new Gt(new vt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const cu=-1;function aR(s,e){const t=s.toTimestamp().seconds,i=s.toTimestamp().nanoseconds+1,l=Gt.fromTimestamp(i===1e9?new vt(t+1,0):new vt(t,i));return new eo(l,jt.empty(),e)}function iR(s){return new eo(s.readTime,s.key,cu)}class eo{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new eo(Gt.min(),jt.empty(),cu)}static max(){return new eo(Gt.max(),jt.empty(),cu)}}function oR(s,e){let t=s.readTime.compareTo(e.readTime);return t!==0?t:(t=jt.comparator(s.documentKey,e.documentKey),t!==0?t:mn(s.largestBatchId,e.largestBatchId))}const lR="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class cR{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function Ql(s){if(s.code!==ke.FAILED_PRECONDITION||s.message!==lR)throw s;ot("LocalStore","Unexpectedly lost primary lease")}class Me{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Vt(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new Me(((i,l)=>{this.nextCallback=u=>{this.wrapSuccess(e,u).next(i,l)},this.catchCallback=u=>{this.wrapFailure(t,u).next(i,l)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof Me?t:Me.resolve(t)}catch(t){return Me.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):Me.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):Me.reject(t)}static resolve(e){return new Me(((t,i)=>{t(e)}))}static reject(e){return new Me(((t,i)=>{i(e)}))}static waitFor(e){return new Me(((t,i)=>{let l=0,u=0,h=!1;e.forEach((p=>{++l,p.next((()=>{++u,h&&u===l&&t()}),(g=>i(g)))})),h=!0,u===l&&t()}))}static or(e){let t=Me.resolve(!1);for(const i of e)t=t.next((l=>l?Me.resolve(l):i()));return t}static forEach(e,t){const i=[];return e.forEach(((l,u)=>{i.push(t.call(this,l,u))})),this.waitFor(i)}static mapArray(e,t){return new Me(((i,l)=>{const u=e.length,h=new Array(u);let p=0;for(let g=0;g<u;g++){const y=g;t(e[y]).next((w=>{h[y]=w,++p,p===u&&i(h)}),(w=>l(w)))}}))}static doWhile(e,t){return new Me(((i,l)=>{const u=()=>{e()===!0?t().next((()=>{u()}),l):i()};u()}))}}function uR(s){const e=s.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function Xl(s){return s.name==="IndexedDbTransactionError"}class ef{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=i=>this.ae(i),this.ue=i=>t.writeSequenceNumber(i))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}ef.ce=-1;const Xg=-1;function tf(s){return s==null}function Id(s){return s===0&&1/s==-1/0}function hR(s){return typeof s=="number"&&Number.isInteger(s)&&!Id(s)&&s<=Number.MAX_SAFE_INTEGER&&s>=Number.MIN_SAFE_INTEGER}const Fw="";function dR(s){let e="";for(let t=0;t<s.length;t++)e.length>0&&(e=dx(e)),e=fR(s.get(t),e);return dx(e)}function fR(s,e){let t=e;const i=s.length;for(let l=0;l<i;l++){const u=s.charAt(l);switch(u){case"\0":t+="";break;case Fw:t+="";break;default:t+=u}}return t}function dx(s){return s+Fw+""}function fx(s){let e=0;for(const t in s)Object.prototype.hasOwnProperty.call(s,t)&&e++;return e}function lo(s,e){for(const t in s)Object.prototype.hasOwnProperty.call(s,t)&&e(t,s[t])}function qw(s){for(const e in s)if(Object.prototype.hasOwnProperty.call(s,e))return!1;return!0}class ds{constructor(e,t){this.comparator=e,this.root=t||Gs.EMPTY}insert(e,t){return new ds(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Gs.BLACK,null,null))}remove(e){return new ds(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Gs.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const i=this.comparator(e,t.key);if(i===0)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){const l=this.comparator(e,i.key);if(l===0)return t+i.left.size;l<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,i)=>(e(t,i),!1)))}toString(){const e=[];return this.inorderTraversal(((t,i)=>(e.push(`${t}:${i}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Jh(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Jh(this.root,e,this.comparator,!1)}getReverseIterator(){return new Jh(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Jh(this.root,e,this.comparator,!0)}}class Jh{constructor(e,t,i,l){this.isReverse=l,this.nodeStack=[];let u=1;for(;!e.isEmpty();)if(u=t?i(e.key,t):1,t&&l&&(u*=-1),u<0)e=this.isReverse?e.left:e.right;else{if(u===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Gs{constructor(e,t,i,l,u){this.key=e,this.value=t,this.color=i??Gs.RED,this.left=l??Gs.EMPTY,this.right=u??Gs.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,l,u){return new Gs(e??this.key,t??this.value,i??this.color,l??this.left,u??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let l=this;const u=i(e,l.key);return l=u<0?l.copy(null,null,null,l.left.insert(e,t,i),null):u===0?l.copy(null,t,null,null,null):l.copy(null,null,null,null,l.right.insert(e,t,i)),l.fixUp()}removeMin(){if(this.left.isEmpty())return Gs.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,l=this;if(t(e,l.key)<0)l.left.isEmpty()||l.left.isRed()||l.left.left.isRed()||(l=l.moveRedLeft()),l=l.copy(null,null,null,l.left.remove(e,t),null);else{if(l.left.isRed()&&(l=l.rotateRight()),l.right.isEmpty()||l.right.isRed()||l.right.left.isRed()||(l=l.moveRedRight()),t(e,l.key)===0){if(l.right.isEmpty())return Gs.EMPTY;i=l.right.min(),l=l.copy(i.key,i.value,null,null,l.right.removeMin())}l=l.copy(null,null,null,null,l.right.remove(e,t))}return l.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Gs.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Gs.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Vt(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Vt(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Vt(27949);return e+(this.isRed()?0:1)}}Gs.EMPTY=null,Gs.RED=!0,Gs.BLACK=!1;Gs.EMPTY=new class{constructor(){this.size=0}get key(){throw Vt(57766)}get value(){throw Vt(16141)}get color(){throw Vt(16727)}get left(){throw Vt(29726)}get right(){throw Vt(36894)}copy(e,t,i,l,u){return this}insert(e,t,i){return new Gs(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Ls{constructor(e){this.comparator=e,this.data=new ds(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,i)=>(e(t),!1)))}forEachInRange(e,t){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const l=i.getNext();if(this.comparator(l.key,e[1])>=0)return;t(l.key)}}forEachWhile(e,t){let i;for(i=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new mx(this.data.getIterator())}getIteratorFrom(e){return new mx(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((i=>{t=t.add(i)})),t}isEqual(e){if(!(e instanceof Ls)||this.size!==e.size)return!1;const t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){const l=t.getNext().key,u=i.getNext().key;if(this.comparator(l,u)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new Ls(this.comparator);return t.data=e,t}}class mx{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class Dr{constructor(e){this.fields=e,e.sort(Ks.comparator)}static empty(){return new Dr([])}unionWith(e){let t=new Ls(Ks.comparator);for(const i of this.fields)t=t.add(i);for(const i of e)t=t.add(i);return new Dr(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Ul(this.fields,e.fields,((t,i)=>t.isEqual(i)))}}class Hw extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Ys{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(l){try{return atob(l)}catch(u){throw typeof DOMException<"u"&&u instanceof DOMException?new Hw("Invalid base64 string: "+u):u}})(e);return new Ys(t)}static fromUint8Array(e){const t=(function(l){let u="";for(let h=0;h<l.length;++h)u+=String.fromCharCode(l[h]);return u})(e);return new Ys(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const i=new Uint8Array(t.length);for(let l=0;l<t.length;l++)i[l]=t.charCodeAt(l);return i})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return mn(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Ys.EMPTY_BYTE_STRING=new Ys("");const mR=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function to(s){if(On(!!s,39018),typeof s=="string"){let e=0;const t=mR.exec(s);if(On(!!t,46558,{timestamp:s}),t[1]){let l=t[1];l=(l+"000000000").substr(0,9),e=Number(l)}const i=new Date(s);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:ks(s.seconds),nanos:ks(s.nanos)}}function ks(s){return typeof s=="number"?s:typeof s=="string"?Number(s):0}function no(s){return typeof s=="string"?Ys.fromBase64String(s):Ys.fromUint8Array(s)}const $w="server_timestamp",Ww="__type__",Gw="__previous_value__",Kw="__local_write_time__";function Jg(s){return(s?.mapValue?.fields||{})[Ww]?.stringValue===$w}function nf(s){const e=s.mapValue.fields[Gw];return Jg(e)?nf(e):e}function uu(s){const e=to(s.mapValue.fields[Kw].timestampValue);return new vt(e.seconds,e.nanos)}class pR{constructor(e,t,i,l,u,h,p,g,y,w,k){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=l,this.ssl=u,this.forceLongPolling=h,this.autoDetectLongPolling=p,this.longPollingOptions=g,this.useFetchStreams=y,this.isUsingEmulator=w,this.apiKey=k}}const Md="(default)";class hu{constructor(e,t){this.projectId=e,this.database=t||Md}static empty(){return new hu("","")}get isDefaultDatabase(){return this.database===Md}isEqual(e){return e instanceof hu&&e.projectId===this.projectId&&e.database===this.database}}function gR(s,e){if(!Object.prototype.hasOwnProperty.apply(s.options,["projectId"]))throw new nt(ke.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new hu(s.options.projectId,e)}const Yw="__type__",yR="__max__",Zh={mapValue:{}},Qw="__vector__",Dd="value";function so(s){return"nullValue"in s?0:"booleanValue"in s?1:"integerValue"in s||"doubleValue"in s?2:"timestampValue"in s?3:"stringValue"in s?5:"bytesValue"in s?6:"referenceValue"in s?7:"geoPointValue"in s?8:"arrayValue"in s?9:"mapValue"in s?Jg(s)?4:vR(s)?9007199254740991:bR(s)?10:11:Vt(28295,{value:s})}function Ca(s,e){if(s===e)return!0;const t=so(s);if(t!==so(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return s.booleanValue===e.booleanValue;case 4:return uu(s).isEqual(uu(e));case 3:return(function(l,u){if(typeof l.timestampValue=="string"&&typeof u.timestampValue=="string"&&l.timestampValue.length===u.timestampValue.length)return l.timestampValue===u.timestampValue;const h=to(l.timestampValue),p=to(u.timestampValue);return h.seconds===p.seconds&&h.nanos===p.nanos})(s,e);case 5:return s.stringValue===e.stringValue;case 6:return(function(l,u){return no(l.bytesValue).isEqual(no(u.bytesValue))})(s,e);case 7:return s.referenceValue===e.referenceValue;case 8:return(function(l,u){return ks(l.geoPointValue.latitude)===ks(u.geoPointValue.latitude)&&ks(l.geoPointValue.longitude)===ks(u.geoPointValue.longitude)})(s,e);case 2:return(function(l,u){if("integerValue"in l&&"integerValue"in u)return ks(l.integerValue)===ks(u.integerValue);if("doubleValue"in l&&"doubleValue"in u){const h=ks(l.doubleValue),p=ks(u.doubleValue);return h===p?Id(h)===Id(p):isNaN(h)&&isNaN(p)}return!1})(s,e);case 9:return Ul(s.arrayValue.values||[],e.arrayValue.values||[],Ca);case 10:case 11:return(function(l,u){const h=l.mapValue.fields||{},p=u.mapValue.fields||{};if(fx(h)!==fx(p))return!1;for(const g in h)if(h.hasOwnProperty(g)&&(p[g]===void 0||!Ca(h[g],p[g])))return!1;return!0})(s,e);default:return Vt(52216,{left:s})}}function du(s,e){return(s.values||[]).find((t=>Ca(t,e)))!==void 0}function zl(s,e){if(s===e)return 0;const t=so(s),i=so(e);if(t!==i)return mn(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return mn(s.booleanValue,e.booleanValue);case 2:return(function(u,h){const p=ks(u.integerValue||u.doubleValue),g=ks(h.integerValue||h.doubleValue);return p<g?-1:p>g?1:p===g?0:isNaN(p)?isNaN(g)?0:-1:1})(s,e);case 3:return px(s.timestampValue,e.timestampValue);case 4:return px(uu(s),uu(e));case 5:return cg(s.stringValue,e.stringValue);case 6:return(function(u,h){const p=no(u),g=no(h);return p.compareTo(g)})(s.bytesValue,e.bytesValue);case 7:return(function(u,h){const p=u.split("/"),g=h.split("/");for(let y=0;y<p.length&&y<g.length;y++){const w=mn(p[y],g[y]);if(w!==0)return w}return mn(p.length,g.length)})(s.referenceValue,e.referenceValue);case 8:return(function(u,h){const p=mn(ks(u.latitude),ks(h.latitude));return p!==0?p:mn(ks(u.longitude),ks(h.longitude))})(s.geoPointValue,e.geoPointValue);case 9:return gx(s.arrayValue,e.arrayValue);case 10:return(function(u,h){const p=u.fields||{},g=h.fields||{},y=p[Dd]?.arrayValue,w=g[Dd]?.arrayValue,k=mn(y?.values?.length||0,w?.values?.length||0);return k!==0?k:gx(y,w)})(s.mapValue,e.mapValue);case 11:return(function(u,h){if(u===Zh.mapValue&&h===Zh.mapValue)return 0;if(u===Zh.mapValue)return 1;if(h===Zh.mapValue)return-1;const p=u.fields||{},g=Object.keys(p),y=h.fields||{},w=Object.keys(y);g.sort(),w.sort();for(let k=0;k<g.length&&k<w.length;++k){const j=cg(g[k],w[k]);if(j!==0)return j;const O=zl(p[g[k]],y[w[k]]);if(O!==0)return O}return mn(g.length,w.length)})(s.mapValue,e.mapValue);default:throw Vt(23264,{he:t})}}function px(s,e){if(typeof s=="string"&&typeof e=="string"&&s.length===e.length)return mn(s,e);const t=to(s),i=to(e),l=mn(t.seconds,i.seconds);return l!==0?l:mn(t.nanos,i.nanos)}function gx(s,e){const t=s.values||[],i=e.values||[];for(let l=0;l<t.length&&l<i.length;++l){const u=zl(t[l],i[l]);if(u)return u}return mn(t.length,i.length)}function Fl(s){return ug(s)}function ug(s){return"nullValue"in s?"null":"booleanValue"in s?""+s.booleanValue:"integerValue"in s?""+s.integerValue:"doubleValue"in s?""+s.doubleValue:"timestampValue"in s?(function(t){const i=to(t);return`time(${i.seconds},${i.nanos})`})(s.timestampValue):"stringValue"in s?s.stringValue:"bytesValue"in s?(function(t){return no(t).toBase64()})(s.bytesValue):"referenceValue"in s?(function(t){return jt.fromName(t).toString()})(s.referenceValue):"geoPointValue"in s?(function(t){return`geo(${t.latitude},${t.longitude})`})(s.geoPointValue):"arrayValue"in s?(function(t){let i="[",l=!0;for(const u of t.values||[])l?l=!1:i+=",",i+=ug(u);return i+"]"})(s.arrayValue):"mapValue"in s?(function(t){const i=Object.keys(t.fields||{}).sort();let l="{",u=!0;for(const h of i)u?u=!1:l+=",",l+=`${h}:${ug(t.fields[h])}`;return l+"}"})(s.mapValue):Vt(61005,{value:s})}function yd(s){switch(so(s)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=nf(s);return e?16+yd(e):16;case 5:return 2*s.stringValue.length;case 6:return no(s.bytesValue).approximateByteSize();case 7:return s.referenceValue.length;case 9:return(function(i){return(i.values||[]).reduce(((l,u)=>l+yd(u)),0)})(s.arrayValue);case 10:case 11:return(function(i){let l=0;return lo(i.fields,((u,h)=>{l+=u.length+yd(h)})),l})(s.mapValue);default:throw Vt(13486,{value:s})}}function yx(s,e){return{referenceValue:`projects/${s.projectId}/databases/${s.database}/documents/${e.path.canonicalString()}`}}function hg(s){return!!s&&"integerValue"in s}function Zg(s){return!!s&&"arrayValue"in s}function bx(s){return!!s&&"nullValue"in s}function vx(s){return!!s&&"doubleValue"in s&&isNaN(Number(s.doubleValue))}function bd(s){return!!s&&"mapValue"in s}function bR(s){return(s?.mapValue?.fields||{})[Yw]?.stringValue===Qw}function Zc(s){if(s.geoPointValue)return{geoPointValue:{...s.geoPointValue}};if(s.timestampValue&&typeof s.timestampValue=="object")return{timestampValue:{...s.timestampValue}};if(s.mapValue){const e={mapValue:{fields:{}}};return lo(s.mapValue.fields,((t,i)=>e.mapValue.fields[t]=Zc(i))),e}if(s.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(s.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Zc(s.arrayValue.values[t]);return e}return{...s}}function vR(s){return(((s.mapValue||{}).fields||{}).__type__||{}).stringValue===yR}class xr{constructor(e){this.value=e}static empty(){return new xr({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!bd(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Zc(t)}setAll(e){let t=Ks.emptyPath(),i={},l=[];e.forEach(((h,p)=>{if(!t.isImmediateParentOf(p)){const g=this.getFieldsMap(t);this.applyChanges(g,i,l),i={},l=[],t=p.popLast()}h?i[p.lastSegment()]=Zc(h):l.push(p.lastSegment())}));const u=this.getFieldsMap(t);this.applyChanges(u,i,l)}delete(e){const t=this.field(e.popLast());bd(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Ca(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let l=t.mapValue.fields[e.get(i)];bd(l)&&l.mapValue.fields||(l={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=l),t=l}return t.mapValue.fields}applyChanges(e,t,i){lo(t,((l,u)=>e[l]=u));for(const l of i)delete e[l]}clone(){return new xr(Zc(this.value))}}function Xw(s){const e=[];return lo(s.fields,((t,i)=>{const l=new Ks([t]);if(bd(i)){const u=Xw(i.mapValue).fields;if(u.length===0)e.push(l);else for(const h of u)e.push(l.child(h))}else e.push(l)})),new Dr(e)}class er{constructor(e,t,i,l,u,h,p){this.key=e,this.documentType=t,this.version=i,this.readTime=l,this.createTime=u,this.data=h,this.documentState=p}static newInvalidDocument(e){return new er(e,0,Gt.min(),Gt.min(),Gt.min(),xr.empty(),0)}static newFoundDocument(e,t,i,l){return new er(e,1,t,Gt.min(),i,l,0)}static newNoDocument(e,t){return new er(e,2,t,Gt.min(),Gt.min(),xr.empty(),0)}static newUnknownDocument(e,t){return new er(e,3,t,Gt.min(),Gt.min(),xr.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Gt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=xr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=xr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Gt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof er&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new er(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Pd{constructor(e,t){this.position=e,this.inclusive=t}}function xx(s,e,t){let i=0;for(let l=0;l<s.position.length;l++){const u=e[l],h=s.position[l];if(u.field.isKeyField()?i=jt.comparator(jt.fromName(h.referenceValue),t.key):i=zl(h,t.data.field(u.field)),u.dir==="desc"&&(i*=-1),i!==0)break}return i}function wx(s,e){if(s===null)return e===null;if(e===null||s.inclusive!==e.inclusive||s.position.length!==e.position.length)return!1;for(let t=0;t<s.position.length;t++)if(!Ca(s.position[t],e.position[t]))return!1;return!0}class fu{constructor(e,t="asc"){this.field=e,this.dir=t}}function xR(s,e){return s.dir===e.dir&&s.field.isEqual(e.field)}class Jw{}class As extends Jw{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,i):new _R(e,t,i):t==="array-contains"?new jR(e,i):t==="in"?new ER(e,i):t==="not-in"?new SR(e,i):t==="array-contains-any"?new NR(e,i):new As(e,t,i)}static createKeyFieldInFilter(e,t,i){return t==="in"?new kR(e,i):new TR(e,i)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(zl(t,this.value)):t!==null&&so(this.value)===so(t)&&this.matchesComparison(zl(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Vt(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class ua extends Jw{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new ua(e,t)}matches(e){return Zw(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function Zw(s){return s.op==="and"}function e_(s){return wR(s)&&Zw(s)}function wR(s){for(const e of s.filters)if(e instanceof ua)return!1;return!0}function dg(s){if(s instanceof As)return s.field.canonicalString()+s.op.toString()+Fl(s.value);if(e_(s))return s.filters.map((e=>dg(e))).join(",");{const e=s.filters.map((t=>dg(t))).join(",");return`${s.op}(${e})`}}function t_(s,e){return s instanceof As?(function(i,l){return l instanceof As&&i.op===l.op&&i.field.isEqual(l.field)&&Ca(i.value,l.value)})(s,e):s instanceof ua?(function(i,l){return l instanceof ua&&i.op===l.op&&i.filters.length===l.filters.length?i.filters.reduce(((u,h,p)=>u&&t_(h,l.filters[p])),!0):!1})(s,e):void Vt(19439)}function n_(s){return s instanceof As?(function(t){return`${t.field.canonicalString()} ${t.op} ${Fl(t.value)}`})(s):s instanceof ua?(function(t){return t.op.toString()+" {"+t.getFilters().map(n_).join(" ,")+"}"})(s):"Filter"}class _R extends As{constructor(e,t,i){super(e,t,i),this.key=jt.fromName(i.referenceValue)}matches(e){const t=jt.comparator(e.key,this.key);return this.matchesComparison(t)}}class kR extends As{constructor(e,t){super(e,"in",t),this.keys=s_("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class TR extends As{constructor(e,t){super(e,"not-in",t),this.keys=s_("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function s_(s,e){return(e.arrayValue?.values||[]).map((t=>jt.fromName(t.referenceValue)))}class jR extends As{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Zg(t)&&du(t.arrayValue,this.value)}}class ER extends As{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&du(this.value.arrayValue,t)}}class SR extends As{constructor(e,t){super(e,"not-in",t)}matches(e){if(du(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!du(this.value.arrayValue,t)}}class NR extends As{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Zg(t)||!t.arrayValue.values)&&t.arrayValue.values.some((i=>du(this.value.arrayValue,i)))}}class CR{constructor(e,t=null,i=[],l=[],u=null,h=null,p=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=l,this.limit=u,this.startAt=h,this.endAt=p,this.Te=null}}function _x(s,e=null,t=[],i=[],l=null,u=null,h=null){return new CR(s,e,t,i,l,u,h)}function ey(s){const e=Qt(s);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((i=>dg(i))).join(","),t+="|ob:",t+=e.orderBy.map((i=>(function(u){return u.field.canonicalString()+u.dir})(i))).join(","),tf(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((i=>Fl(i))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((i=>Fl(i))).join(",")),e.Te=t}return e.Te}function ty(s,e){if(s.limit!==e.limit||s.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<s.orderBy.length;t++)if(!xR(s.orderBy[t],e.orderBy[t]))return!1;if(s.filters.length!==e.filters.length)return!1;for(let t=0;t<s.filters.length;t++)if(!t_(s.filters[t],e.filters[t]))return!1;return s.collectionGroup===e.collectionGroup&&!!s.path.isEqual(e.path)&&!!wx(s.startAt,e.startAt)&&wx(s.endAt,e.endAt)}function fg(s){return jt.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}class Jl{constructor(e,t=null,i=[],l=[],u=null,h="F",p=null,g=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=l,this.limit=u,this.limitType=h,this.startAt=p,this.endAt=g,this.Ie=null,this.Ee=null,this.Re=null,this.startAt,this.endAt}}function RR(s,e,t,i,l,u,h,p){return new Jl(s,e,t,i,l,u,h,p)}function sf(s){return new Jl(s)}function kx(s){return s.filters.length===0&&s.limit===null&&s.startAt==null&&s.endAt==null&&(s.explicitOrderBy.length===0||s.explicitOrderBy.length===1&&s.explicitOrderBy[0].field.isKeyField())}function AR(s){return jt.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}function r_(s){return s.collectionGroup!==null}function eu(s){const e=Qt(s);if(e.Ie===null){e.Ie=[];const t=new Set;for(const u of e.explicitOrderBy)e.Ie.push(u),t.add(u.field.canonicalString());const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(h){let p=new Ls(Ks.comparator);return h.filters.forEach((g=>{g.getFlattenedFilters().forEach((y=>{y.isInequality()&&(p=p.add(y.field))}))})),p})(e).forEach((u=>{t.has(u.canonicalString())||u.isKeyField()||e.Ie.push(new fu(u,i))})),t.has(Ks.keyField().canonicalString())||e.Ie.push(new fu(Ks.keyField(),i))}return e.Ie}function Ea(s){const e=Qt(s);return e.Ee||(e.Ee=IR(e,eu(s))),e.Ee}function IR(s,e){if(s.limitType==="F")return _x(s.path,s.collectionGroup,e,s.filters,s.limit,s.startAt,s.endAt);{e=e.map((l=>{const u=l.dir==="desc"?"asc":"desc";return new fu(l.field,u)}));const t=s.endAt?new Pd(s.endAt.position,s.endAt.inclusive):null,i=s.startAt?new Pd(s.startAt.position,s.startAt.inclusive):null;return _x(s.path,s.collectionGroup,e,s.filters,s.limit,t,i)}}function mg(s,e){const t=s.filters.concat([e]);return new Jl(s.path,s.collectionGroup,s.explicitOrderBy.slice(),t,s.limit,s.limitType,s.startAt,s.endAt)}function MR(s,e){const t=s.explicitOrderBy.concat([e]);return new Jl(s.path,s.collectionGroup,t,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}function Ld(s,e,t){return new Jl(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),e,t,s.startAt,s.endAt)}function rf(s,e){return ty(Ea(s),Ea(e))&&s.limitType===e.limitType}function a_(s){return`${ey(Ea(s))}|lt:${s.limitType}`}function Rl(s){return`Query(target=${(function(t){let i=t.path.canonicalString();return t.collectionGroup!==null&&(i+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(i+=`, filters: [${t.filters.map((l=>n_(l))).join(", ")}]`),tf(t.limit)||(i+=", limit: "+t.limit),t.orderBy.length>0&&(i+=`, orderBy: [${t.orderBy.map((l=>(function(h){return`${h.field.canonicalString()} (${h.dir})`})(l))).join(", ")}]`),t.startAt&&(i+=", startAt: ",i+=t.startAt.inclusive?"b:":"a:",i+=t.startAt.position.map((l=>Fl(l))).join(",")),t.endAt&&(i+=", endAt: ",i+=t.endAt.inclusive?"a:":"b:",i+=t.endAt.position.map((l=>Fl(l))).join(",")),`Target(${i})`})(Ea(s))}; limitType=${s.limitType})`}function af(s,e){return e.isFoundDocument()&&(function(i,l){const u=l.key.path;return i.collectionGroup!==null?l.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(u):jt.isDocumentKey(i.path)?i.path.isEqual(u):i.path.isImmediateParentOf(u)})(s,e)&&(function(i,l){for(const u of eu(i))if(!u.field.isKeyField()&&l.data.field(u.field)===null)return!1;return!0})(s,e)&&(function(i,l){for(const u of i.filters)if(!u.matches(l))return!1;return!0})(s,e)&&(function(i,l){return!(i.startAt&&!(function(h,p,g){const y=xx(h,p,g);return h.inclusive?y<=0:y<0})(i.startAt,eu(i),l)||i.endAt&&!(function(h,p,g){const y=xx(h,p,g);return h.inclusive?y>=0:y>0})(i.endAt,eu(i),l))})(s,e)}function DR(s){return s.collectionGroup||(s.path.length%2==1?s.path.lastSegment():s.path.get(s.path.length-2))}function i_(s){return(e,t)=>{let i=!1;for(const l of eu(s)){const u=PR(l,e,t);if(u!==0)return u;i=i||l.field.isKeyField()}return 0}}function PR(s,e,t){const i=s.field.isKeyField()?jt.comparator(e.key,t.key):(function(u,h,p){const g=h.data.field(u),y=p.data.field(u);return g!==null&&y!==null?zl(g,y):Vt(42886)})(s.field,e,t);switch(s.dir){case"asc":return i;case"desc":return-1*i;default:return Vt(19790,{direction:s.dir})}}class Wo{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i!==void 0){for(const[l,u]of i)if(this.equalsFn(l,e))return u}}has(e){return this.get(e)!==void 0}set(e,t){const i=this.mapKeyFn(e),l=this.inner[i];if(l===void 0)return this.inner[i]=[[e,t]],void this.innerSize++;for(let u=0;u<l.length;u++)if(this.equalsFn(l[u][0],e))return void(l[u]=[e,t]);l.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i===void 0)return!1;for(let l=0;l<i.length;l++)if(this.equalsFn(i[l][0],e))return i.length===1?delete this.inner[t]:i.splice(l,1),this.innerSize--,!0;return!1}forEach(e){lo(this.inner,((t,i)=>{for(const[l,u]of i)e(l,u)}))}isEmpty(){return qw(this.inner)}size(){return this.innerSize}}const LR=new ds(jt.comparator);function ui(){return LR}const o_=new ds(jt.comparator);function Kc(...s){let e=o_;for(const t of s)e=e.insert(t.key,t);return e}function l_(s){let e=o_;return s.forEach(((t,i)=>e=e.insert(t,i.overlayedDocument))),e}function Ao(){return tu()}function c_(){return tu()}function tu(){return new Wo((s=>s.toString()),((s,e)=>s.isEqual(e)))}const OR=new ds(jt.comparator),VR=new Ls(jt.comparator);function pn(...s){let e=VR;for(const t of s)e=e.add(t);return e}const BR=new Ls(mn);function UR(){return BR}function ny(s,e){if(s.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Id(e)?"-0":e}}function u_(s){return{integerValue:""+s}}function h_(s,e){return hR(e)?u_(e):ny(s,e)}class of{constructor(){this._=void 0}}function zR(s,e,t){return s instanceof mu?(function(l,u){const h={fields:{[Ww]:{stringValue:$w},[Kw]:{timestampValue:{seconds:l.seconds,nanos:l.nanoseconds}}}};return u&&Jg(u)&&(u=nf(u)),u&&(h.fields[Gw]=u),{mapValue:h}})(t,e):s instanceof pu?f_(s,e):s instanceof gu?m_(s,e):(function(l,u){const h=d_(l,u),p=Tx(h)+Tx(l.Ae);return hg(h)&&hg(l.Ae)?u_(p):ny(l.serializer,p)})(s,e)}function FR(s,e,t){return s instanceof pu?f_(s,e):s instanceof gu?m_(s,e):t}function d_(s,e){return s instanceof yu?(function(i){return hg(i)||(function(u){return!!u&&"doubleValue"in u})(i)})(e)?e:{integerValue:0}:null}class mu extends of{}class pu extends of{constructor(e){super(),this.elements=e}}function f_(s,e){const t=p_(e);for(const i of s.elements)t.some((l=>Ca(l,i)))||t.push(i);return{arrayValue:{values:t}}}class gu extends of{constructor(e){super(),this.elements=e}}function m_(s,e){let t=p_(e);for(const i of s.elements)t=t.filter((l=>!Ca(l,i)));return{arrayValue:{values:t}}}class yu extends of{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function Tx(s){return ks(s.integerValue||s.doubleValue)}function p_(s){return Zg(s)&&s.arrayValue.values?s.arrayValue.values.slice():[]}class g_{constructor(e,t){this.field=e,this.transform=t}}function qR(s,e){return s.field.isEqual(e.field)&&(function(i,l){return i instanceof pu&&l instanceof pu||i instanceof gu&&l instanceof gu?Ul(i.elements,l.elements,Ca):i instanceof yu&&l instanceof yu?Ca(i.Ae,l.Ae):i instanceof mu&&l instanceof mu})(s.transform,e.transform)}class HR{constructor(e,t){this.version=e,this.transformResults=t}}class ur{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new ur}static exists(e){return new ur(void 0,e)}static updateTime(e){return new ur(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function vd(s,e){return s.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(s.updateTime):s.exists===void 0||s.exists===e.isFoundDocument()}class lf{}function y_(s,e){if(!s.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return s.isNoDocument()?new cf(s.key,ur.none()):new Su(s.key,s.data,ur.none());{const t=s.data,i=xr.empty();let l=new Ls(Ks.comparator);for(let u of e.fields)if(!l.has(u)){let h=t.field(u);h===null&&u.length>1&&(u=u.popLast(),h=t.field(u)),h===null?i.delete(u):i.set(u,h),l=l.add(u)}return new co(s.key,i,new Dr(l.toArray()),ur.none())}}function $R(s,e,t){s instanceof Su?(function(l,u,h){const p=l.value.clone(),g=Ex(l.fieldTransforms,u,h.transformResults);p.setAll(g),u.convertToFoundDocument(h.version,p).setHasCommittedMutations()})(s,e,t):s instanceof co?(function(l,u,h){if(!vd(l.precondition,u))return void u.convertToUnknownDocument(h.version);const p=Ex(l.fieldTransforms,u,h.transformResults),g=u.data;g.setAll(b_(l)),g.setAll(p),u.convertToFoundDocument(h.version,g).setHasCommittedMutations()})(s,e,t):(function(l,u,h){u.convertToNoDocument(h.version).setHasCommittedMutations()})(0,e,t)}function nu(s,e,t,i){return s instanceof Su?(function(u,h,p,g){if(!vd(u.precondition,h))return p;const y=u.value.clone(),w=Sx(u.fieldTransforms,g,h);return y.setAll(w),h.convertToFoundDocument(h.version,y).setHasLocalMutations(),null})(s,e,t,i):s instanceof co?(function(u,h,p,g){if(!vd(u.precondition,h))return p;const y=Sx(u.fieldTransforms,g,h),w=h.data;return w.setAll(b_(u)),w.setAll(y),h.convertToFoundDocument(h.version,w).setHasLocalMutations(),p===null?null:p.unionWith(u.fieldMask.fields).unionWith(u.fieldTransforms.map((k=>k.field)))})(s,e,t,i):(function(u,h,p){return vd(u.precondition,h)?(h.convertToNoDocument(h.version).setHasLocalMutations(),null):p})(s,e,t)}function WR(s,e){let t=null;for(const i of s.fieldTransforms){const l=e.data.field(i.field),u=d_(i.transform,l||null);u!=null&&(t===null&&(t=xr.empty()),t.set(i.field,u))}return t||null}function jx(s,e){return s.type===e.type&&!!s.key.isEqual(e.key)&&!!s.precondition.isEqual(e.precondition)&&!!(function(i,l){return i===void 0&&l===void 0||!(!i||!l)&&Ul(i,l,((u,h)=>qR(u,h)))})(s.fieldTransforms,e.fieldTransforms)&&(s.type===0?s.value.isEqual(e.value):s.type!==1||s.data.isEqual(e.data)&&s.fieldMask.isEqual(e.fieldMask))}class Su extends lf{constructor(e,t,i,l=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=l,this.type=0}getFieldMask(){return null}}class co extends lf{constructor(e,t,i,l,u=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=l,this.fieldTransforms=u,this.type=1}getFieldMask(){return this.fieldMask}}function b_(s){const e=new Map;return s.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const i=s.data.field(t);e.set(t,i)}})),e}function Ex(s,e,t){const i=new Map;On(s.length===t.length,32656,{Ve:t.length,de:s.length});for(let l=0;l<t.length;l++){const u=s[l],h=u.transform,p=e.data.field(u.field);i.set(u.field,FR(h,p,t[l]))}return i}function Sx(s,e,t){const i=new Map;for(const l of s){const u=l.transform,h=t.data.field(l.field);i.set(l.field,zR(u,h,e))}return i}class cf extends lf{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class GR extends lf{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class KR{constructor(e,t,i,l){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=l}applyToRemoteDocument(e,t){const i=t.mutationResults;for(let l=0;l<this.mutations.length;l++){const u=this.mutations[l];u.key.isEqual(e.key)&&$R(u,e,i[l])}}applyToLocalView(e,t){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(t=nu(i,e,t,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(t=nu(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const i=c_();return this.mutations.forEach((l=>{const u=e.get(l.key),h=u.overlayedDocument;let p=this.applyToLocalView(h,u.mutatedFields);p=t.has(l.key)?null:p;const g=y_(h,p);g!==null&&i.set(l.key,g),h.isValidDocument()||h.convertToNoDocument(Gt.min())})),i}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),pn())}isEqual(e){return this.batchId===e.batchId&&Ul(this.mutations,e.mutations,((t,i)=>jx(t,i)))&&Ul(this.baseMutations,e.baseMutations,((t,i)=>jx(t,i)))}}class sy{constructor(e,t,i,l){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=l}static from(e,t,i){On(e.mutations.length===i.length,58842,{me:e.mutations.length,fe:i.length});let l=(function(){return OR})();const u=e.mutations;for(let h=0;h<u.length;h++)l=l.insert(u[h].key,i[h].version);return new sy(e,t,i,l)}}class YR{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class QR{constructor(e,t){this.count=e,this.unchangedNames=t}}var Rs,jn;function XR(s){switch(s){case ke.OK:return Vt(64938);case ke.CANCELLED:case ke.UNKNOWN:case ke.DEADLINE_EXCEEDED:case ke.RESOURCE_EXHAUSTED:case ke.INTERNAL:case ke.UNAVAILABLE:case ke.UNAUTHENTICATED:return!1;case ke.INVALID_ARGUMENT:case ke.NOT_FOUND:case ke.ALREADY_EXISTS:case ke.PERMISSION_DENIED:case ke.FAILED_PRECONDITION:case ke.ABORTED:case ke.OUT_OF_RANGE:case ke.UNIMPLEMENTED:case ke.DATA_LOSS:return!0;default:return Vt(15467,{code:s})}}function v_(s){if(s===void 0)return ci("GRPC error has no .code"),ke.UNKNOWN;switch(s){case Rs.OK:return ke.OK;case Rs.CANCELLED:return ke.CANCELLED;case Rs.UNKNOWN:return ke.UNKNOWN;case Rs.DEADLINE_EXCEEDED:return ke.DEADLINE_EXCEEDED;case Rs.RESOURCE_EXHAUSTED:return ke.RESOURCE_EXHAUSTED;case Rs.INTERNAL:return ke.INTERNAL;case Rs.UNAVAILABLE:return ke.UNAVAILABLE;case Rs.UNAUTHENTICATED:return ke.UNAUTHENTICATED;case Rs.INVALID_ARGUMENT:return ke.INVALID_ARGUMENT;case Rs.NOT_FOUND:return ke.NOT_FOUND;case Rs.ALREADY_EXISTS:return ke.ALREADY_EXISTS;case Rs.PERMISSION_DENIED:return ke.PERMISSION_DENIED;case Rs.FAILED_PRECONDITION:return ke.FAILED_PRECONDITION;case Rs.ABORTED:return ke.ABORTED;case Rs.OUT_OF_RANGE:return ke.OUT_OF_RANGE;case Rs.UNIMPLEMENTED:return ke.UNIMPLEMENTED;case Rs.DATA_LOSS:return ke.DATA_LOSS;default:return Vt(39323,{code:s})}}(jn=Rs||(Rs={}))[jn.OK=0]="OK",jn[jn.CANCELLED=1]="CANCELLED",jn[jn.UNKNOWN=2]="UNKNOWN",jn[jn.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",jn[jn.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",jn[jn.NOT_FOUND=5]="NOT_FOUND",jn[jn.ALREADY_EXISTS=6]="ALREADY_EXISTS",jn[jn.PERMISSION_DENIED=7]="PERMISSION_DENIED",jn[jn.UNAUTHENTICATED=16]="UNAUTHENTICATED",jn[jn.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",jn[jn.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",jn[jn.ABORTED=10]="ABORTED",jn[jn.OUT_OF_RANGE=11]="OUT_OF_RANGE",jn[jn.UNIMPLEMENTED=12]="UNIMPLEMENTED",jn[jn.INTERNAL=13]="INTERNAL",jn[jn.UNAVAILABLE=14]="UNAVAILABLE",jn[jn.DATA_LOSS=15]="DATA_LOSS";function JR(){return new TextEncoder}const ZR=new Xi([4294967295,4294967295],0);function Nx(s){const e=JR().encode(s),t=new Iw;return t.update(e),new Uint8Array(t.digest())}function Cx(s){const e=new DataView(s.buffer),t=e.getUint32(0,!0),i=e.getUint32(4,!0),l=e.getUint32(8,!0),u=e.getUint32(12,!0);return[new Xi([t,i],0),new Xi([l,u],0)]}class ry{constructor(e,t,i){if(this.bitmap=e,this.padding=t,this.hashCount=i,t<0||t>=8)throw new Yc(`Invalid padding: ${t}`);if(i<0)throw new Yc(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new Yc(`Invalid hash count: ${i}`);if(e.length===0&&t!==0)throw new Yc(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=Xi.fromNumber(this.ge)}ye(e,t,i){let l=e.add(t.multiply(Xi.fromNumber(i)));return l.compare(ZR)===1&&(l=new Xi([l.getBits(0),l.getBits(1)],0)),l.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=Nx(e),[i,l]=Cx(t);for(let u=0;u<this.hashCount;u++){const h=this.ye(i,l,u);if(!this.we(h))return!1}return!0}static create(e,t,i){const l=e%8==0?0:8-e%8,u=new Uint8Array(Math.ceil(e/8)),h=new ry(u,l,t);return i.forEach((p=>h.insert(p))),h}insert(e){if(this.ge===0)return;const t=Nx(e),[i,l]=Cx(t);for(let u=0;u<this.hashCount;u++){const h=this.ye(i,l,u);this.be(h)}}be(e){const t=Math.floor(e/8),i=e%8;this.bitmap[t]|=1<<i}}class Yc extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class uf{constructor(e,t,i,l,u){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=i,this.documentUpdates=l,this.resolvedLimboDocuments=u}static createSynthesizedRemoteEventForCurrentChange(e,t,i){const l=new Map;return l.set(e,Nu.createSynthesizedTargetChangeForCurrentChange(e,t,i)),new uf(Gt.min(),l,new ds(mn),ui(),pn())}}class Nu{constructor(e,t,i,l,u){this.resumeToken=e,this.current=t,this.addedDocuments=i,this.modifiedDocuments=l,this.removedDocuments=u}static createSynthesizedTargetChangeForCurrentChange(e,t,i){return new Nu(i,t,pn(),pn(),pn())}}class xd{constructor(e,t,i,l){this.Se=e,this.removedTargetIds=t,this.key=i,this.De=l}}class x_{constructor(e,t){this.targetId=e,this.Ce=t}}class w_{constructor(e,t,i=Ys.EMPTY_BYTE_STRING,l=null){this.state=e,this.targetIds=t,this.resumeToken=i,this.cause=l}}class Rx{constructor(){this.ve=0,this.Fe=Ax(),this.Me=Ys.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=pn(),t=pn(),i=pn();return this.Fe.forEach(((l,u)=>{switch(u){case 0:e=e.add(l);break;case 2:t=t.add(l);break;case 1:i=i.add(l);break;default:Vt(38017,{changeType:u})}})),new Nu(this.Me,this.xe,e,t,i)}Ke(){this.Oe=!1,this.Fe=Ax()}qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}Ue(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}$e(){this.ve+=1}We(){this.ve-=1,On(this.ve>=0,3241,{ve:this.ve})}Qe(){this.Oe=!0,this.xe=!0}}class eA{constructor(e){this.Ge=e,this.ze=new Map,this.je=ui(),this.He=ed(),this.Je=ed(),this.Ze=new ds(mn)}Xe(e){for(const t of e.Se)e.De&&e.De.isFoundDocument()?this.Ye(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const i=this.nt(t);switch(e.state){case 0:this.rt(t)&&i.Le(e.resumeToken);break;case 1:i.We(),i.Ne||i.Ke(),i.Le(e.resumeToken);break;case 2:i.We(),i.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(i.Qe(),i.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),i.Le(e.resumeToken));break;default:Vt(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((i,l)=>{this.rt(l)&&t(l)}))}st(e){const t=e.targetId,i=e.Ce.count,l=this.ot(t);if(l){const u=l.target;if(fg(u))if(i===0){const h=new jt(u.path);this.et(t,h,er.newNoDocument(h,Gt.min()))}else On(i===1,20013,{expectedCount:i});else{const h=this._t(t);if(h!==i){const p=this.ut(e),g=p?this.ct(p,e,h):1;if(g!==0){this.it(t);const y=g===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(t,y)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:i="",padding:l=0},hashCount:u=0}=t;let h,p;try{h=no(i).toUint8Array()}catch(g){if(g instanceof Hw)return Bl("Decoding the base64 bloom filter in existence filter failed ("+g.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw g}try{p=new ry(h,l,u)}catch(g){return Bl(g instanceof Yc?"BloomFilter error: ":"Applying bloom filter failed: ",g),null}return p.ge===0?null:p}ct(e,t,i){return t.Ce.count===i-this.Pt(e,t.targetId)?0:2}Pt(e,t){const i=this.Ge.getRemoteKeysForTarget(t);let l=0;return i.forEach((u=>{const h=this.Ge.ht(),p=`projects/${h.projectId}/databases/${h.database}/documents/${u.path.canonicalString()}`;e.mightContain(p)||(this.et(t,u,null),l++)})),l}Tt(e){const t=new Map;this.ze.forEach(((u,h)=>{const p=this.ot(h);if(p){if(u.current&&fg(p.target)){const g=new jt(p.target.path);this.It(g).has(h)||this.Et(h,g)||this.et(h,g,er.newNoDocument(g,e))}u.Be&&(t.set(h,u.ke()),u.Ke())}}));let i=pn();this.Je.forEach(((u,h)=>{let p=!0;h.forEachWhile((g=>{const y=this.ot(g);return!y||y.purpose==="TargetPurposeLimboResolution"||(p=!1,!1)})),p&&(i=i.add(u))})),this.je.forEach(((u,h)=>h.setReadTime(e)));const l=new uf(e,t,this.Ze,this.je,i);return this.je=ui(),this.He=ed(),this.Je=ed(),this.Ze=new ds(mn),l}Ye(e,t){if(!this.rt(e))return;const i=this.Et(e,t.key)?2:0;this.nt(e).qe(t.key,i),this.je=this.je.insert(t.key,t),this.He=this.He.insert(t.key,this.It(t.key).add(e)),this.Je=this.Je.insert(t.key,this.Rt(t.key).add(e))}et(e,t,i){if(!this.rt(e))return;const l=this.nt(e);this.Et(e,t)?l.qe(t,1):l.Ue(t),this.Je=this.Je.insert(t,this.Rt(t).delete(e)),this.Je=this.Je.insert(t,this.Rt(t).add(e)),i&&(this.je=this.je.insert(t,i))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.nt(e).$e()}nt(e){let t=this.ze.get(e);return t||(t=new Rx,this.ze.set(e,t)),t}Rt(e){let t=this.Je.get(e);return t||(t=new Ls(mn),this.Je=this.Je.insert(e,t)),t}It(e){let t=this.He.get(e);return t||(t=new Ls(mn),this.He=this.He.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||ot("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new Rx),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function ed(){return new ds(jt.comparator)}function Ax(){return new ds(jt.comparator)}const tA={asc:"ASCENDING",desc:"DESCENDING"},nA={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},sA={and:"AND",or:"OR"};class rA{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function pg(s,e){return s.useProto3Json||tf(e)?e:{value:e}}function Od(s,e){return s.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function __(s,e){return s.useProto3Json?e.toBase64():e.toUint8Array()}function aA(s,e){return Od(s,e.toTimestamp())}function Sa(s){return On(!!s,49232),Gt.fromTimestamp((function(t){const i=to(t);return new vt(i.seconds,i.nanos)})(s))}function ay(s,e){return gg(s,e).canonicalString()}function gg(s,e){const t=(function(l){return new es(["projects",l.projectId,"databases",l.database])})(s).child("documents");return e===void 0?t:t.child(e)}function k_(s){const e=es.fromString(s);return On(N_(e),10190,{key:e.toString()}),e}function yg(s,e){return ay(s.databaseId,e.path)}function Cp(s,e){const t=k_(e);if(t.get(1)!==s.databaseId.projectId)throw new nt(ke.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+s.databaseId.projectId);if(t.get(3)!==s.databaseId.database)throw new nt(ke.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+s.databaseId.database);return new jt(j_(t))}function T_(s,e){return ay(s.databaseId,e)}function iA(s){const e=k_(s);return e.length===4?es.emptyPath():j_(e)}function bg(s){return new es(["projects",s.databaseId.projectId,"databases",s.databaseId.database]).canonicalString()}function j_(s){return On(s.length>4&&s.get(4)==="documents",29091,{key:s.toString()}),s.popFirst(5)}function Ix(s,e,t){return{name:yg(s,e),fields:t.value.mapValue.fields}}function oA(s,e){let t;if("targetChange"in e){e.targetChange;const i=(function(y){return y==="NO_CHANGE"?0:y==="ADD"?1:y==="REMOVE"?2:y==="CURRENT"?3:y==="RESET"?4:Vt(39313,{state:y})})(e.targetChange.targetChangeType||"NO_CHANGE"),l=e.targetChange.targetIds||[],u=(function(y,w){return y.useProto3Json?(On(w===void 0||typeof w=="string",58123),Ys.fromBase64String(w||"")):(On(w===void 0||w instanceof Buffer||w instanceof Uint8Array,16193),Ys.fromUint8Array(w||new Uint8Array))})(s,e.targetChange.resumeToken),h=e.targetChange.cause,p=h&&(function(y){const w=y.code===void 0?ke.UNKNOWN:v_(y.code);return new nt(w,y.message||"")})(h);t=new w_(i,l,u,p||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const l=Cp(s,i.document.name),u=Sa(i.document.updateTime),h=i.document.createTime?Sa(i.document.createTime):Gt.min(),p=new xr({mapValue:{fields:i.document.fields}}),g=er.newFoundDocument(l,u,h,p),y=i.targetIds||[],w=i.removedTargetIds||[];t=new xd(y,w,g.key,g)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const l=Cp(s,i.document),u=i.readTime?Sa(i.readTime):Gt.min(),h=er.newNoDocument(l,u),p=i.removedTargetIds||[];t=new xd([],p,h.key,h)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const l=Cp(s,i.document),u=i.removedTargetIds||[];t=new xd([],u,l,null)}else{if(!("filter"in e))return Vt(11601,{Vt:e});{e.filter;const i=e.filter;i.targetId;const{count:l=0,unchangedNames:u}=i,h=new QR(l,u),p=i.targetId;t=new x_(p,h)}}return t}function lA(s,e){let t;if(e instanceof Su)t={update:Ix(s,e.key,e.value)};else if(e instanceof cf)t={delete:yg(s,e.key)};else if(e instanceof co)t={update:Ix(s,e.key,e.data),updateMask:yA(e.fieldMask)};else{if(!(e instanceof GR))return Vt(16599,{dt:e.type});t={verify:yg(s,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((i=>(function(u,h){const p=h.transform;if(p instanceof mu)return{fieldPath:h.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(p instanceof pu)return{fieldPath:h.field.canonicalString(),appendMissingElements:{values:p.elements}};if(p instanceof gu)return{fieldPath:h.field.canonicalString(),removeAllFromArray:{values:p.elements}};if(p instanceof yu)return{fieldPath:h.field.canonicalString(),increment:p.Ae};throw Vt(20930,{transform:h.transform})})(0,i)))),e.precondition.isNone||(t.currentDocument=(function(l,u){return u.updateTime!==void 0?{updateTime:aA(l,u.updateTime)}:u.exists!==void 0?{exists:u.exists}:Vt(27497)})(s,e.precondition)),t}function cA(s,e){return s&&s.length>0?(On(e!==void 0,14353),s.map((t=>(function(l,u){let h=l.updateTime?Sa(l.updateTime):Sa(u);return h.isEqual(Gt.min())&&(h=Sa(u)),new HR(h,l.transformResults||[])})(t,e)))):[]}function uA(s,e){return{documents:[T_(s,e.path)]}}function hA(s,e){const t={structuredQuery:{}},i=e.path;let l;e.collectionGroup!==null?(l=i,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(l=i.popLast(),t.structuredQuery.from=[{collectionId:i.lastSegment()}]),t.parent=T_(s,l);const u=(function(y){if(y.length!==0)return S_(ua.create(y,"and"))})(e.filters);u&&(t.structuredQuery.where=u);const h=(function(y){if(y.length!==0)return y.map((w=>(function(j){return{field:Al(j.field),direction:mA(j.dir)}})(w)))})(e.orderBy);h&&(t.structuredQuery.orderBy=h);const p=pg(s,e.limit);return p!==null&&(t.structuredQuery.limit=p),e.startAt&&(t.structuredQuery.startAt=(function(y){return{before:y.inclusive,values:y.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(y){return{before:!y.inclusive,values:y.position}})(e.endAt)),{ft:t,parent:l}}function dA(s){let e=iA(s.parent);const t=s.structuredQuery,i=t.from?t.from.length:0;let l=null;if(i>0){On(i===1,65062);const w=t.from[0];w.allDescendants?l=w.collectionId:e=e.child(w.collectionId)}let u=[];t.where&&(u=(function(k){const j=E_(k);return j instanceof ua&&e_(j)?j.getFilters():[j]})(t.where));let h=[];t.orderBy&&(h=(function(k){return k.map((j=>(function($){return new fu(Il($.field),(function(L){switch(L){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})($.direction))})(j)))})(t.orderBy));let p=null;t.limit&&(p=(function(k){let j;return j=typeof k=="object"?k.value:k,tf(j)?null:j})(t.limit));let g=null;t.startAt&&(g=(function(k){const j=!!k.before,O=k.values||[];return new Pd(O,j)})(t.startAt));let y=null;return t.endAt&&(y=(function(k){const j=!k.before,O=k.values||[];return new Pd(O,j)})(t.endAt)),RR(e,l,h,u,p,"F",g,y)}function fA(s,e){const t=(function(l){switch(l){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Vt(28987,{purpose:l})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function E_(s){return s.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const i=Il(t.unaryFilter.field);return As.create(i,"==",{doubleValue:NaN});case"IS_NULL":const l=Il(t.unaryFilter.field);return As.create(l,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const u=Il(t.unaryFilter.field);return As.create(u,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const h=Il(t.unaryFilter.field);return As.create(h,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Vt(61313);default:return Vt(60726)}})(s):s.fieldFilter!==void 0?(function(t){return As.create(Il(t.fieldFilter.field),(function(l){switch(l){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Vt(58110);default:return Vt(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(s):s.compositeFilter!==void 0?(function(t){return ua.create(t.compositeFilter.filters.map((i=>E_(i))),(function(l){switch(l){case"AND":return"and";case"OR":return"or";default:return Vt(1026)}})(t.compositeFilter.op))})(s):Vt(30097,{filter:s})}function mA(s){return tA[s]}function pA(s){return nA[s]}function gA(s){return sA[s]}function Al(s){return{fieldPath:s.canonicalString()}}function Il(s){return Ks.fromServerFormat(s.fieldPath)}function S_(s){return s instanceof As?(function(t){if(t.op==="=="){if(vx(t.value))return{unaryFilter:{field:Al(t.field),op:"IS_NAN"}};if(bx(t.value))return{unaryFilter:{field:Al(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(vx(t.value))return{unaryFilter:{field:Al(t.field),op:"IS_NOT_NAN"}};if(bx(t.value))return{unaryFilter:{field:Al(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Al(t.field),op:pA(t.op),value:t.value}}})(s):s instanceof ua?(function(t){const i=t.getFilters().map((l=>S_(l)));return i.length===1?i[0]:{compositeFilter:{op:gA(t.op),filters:i}}})(s):Vt(54877,{filter:s})}function yA(s){const e=[];return s.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function N_(s){return s.length>=4&&s.get(0)==="projects"&&s.get(2)==="databases"}function C_(s){return!!s&&typeof s._toProto=="function"&&s._protoValueType==="ProtoValue"}class Wi{constructor(e,t,i,l,u=Gt.min(),h=Gt.min(),p=Ys.EMPTY_BYTE_STRING,g=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=l,this.snapshotVersion=u,this.lastLimboFreeSnapshotVersion=h,this.resumeToken=p,this.expectedCount=g}withSequenceNumber(e){return new Wi(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Wi(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Wi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Wi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class bA{constructor(e){this.yt=e}}function vA(s){const e=dA({parent:s.parent,structuredQuery:s.structuredQuery});return s.limitType==="LAST"?Ld(e,e.limit,"L"):e}class xA{constructor(){this.Sn=new wA}addToCollectionParentIndex(e,t){return this.Sn.add(t),Me.resolve()}getCollectionParents(e,t){return Me.resolve(this.Sn.getEntries(t))}addFieldIndex(e,t){return Me.resolve()}deleteFieldIndex(e,t){return Me.resolve()}deleteAllFieldIndexes(e){return Me.resolve()}createTargetIndexes(e,t){return Me.resolve()}getDocumentsMatchingTarget(e,t){return Me.resolve(null)}getIndexType(e,t){return Me.resolve(0)}getFieldIndexes(e,t){return Me.resolve([])}getNextCollectionGroupToUpdate(e){return Me.resolve(null)}getMinOffset(e,t){return Me.resolve(eo.min())}getMinOffsetFromCollectionGroup(e,t){return Me.resolve(eo.min())}updateCollectionGroup(e,t,i){return Me.resolve()}updateIndexEntries(e,t){return Me.resolve()}}class wA{constructor(){this.index={}}add(e){const t=e.lastSegment(),i=e.popLast(),l=this.index[t]||new Ls(es.comparator),u=!l.has(i);return this.index[t]=l.add(i),u}has(e){const t=e.lastSegment(),i=e.popLast(),l=this.index[t];return l&&l.has(i)}getEntries(e){return(this.index[e]||new Ls(es.comparator)).toArray()}}const Mx={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},R_=41943040;class vr{static withCacheSize(e){return new vr(e,vr.DEFAULT_COLLECTION_PERCENTILE,vr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}}vr.DEFAULT_COLLECTION_PERCENTILE=10,vr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,vr.DEFAULT=new vr(R_,vr.DEFAULT_COLLECTION_PERCENTILE,vr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),vr.DISABLED=new vr(-1,0,0);class ql{constructor(e){this.sr=e}next(){return this.sr+=2,this.sr}static _r(){return new ql(0)}static ar(){return new ql(-1)}}const Dx="LruGarbageCollector",_A=1048576;function Px([s,e],[t,i]){const l=mn(s,t);return l===0?mn(e,i):l}class kA{constructor(e){this.Pr=e,this.buffer=new Ls(Px),this.Tr=0}Ir(){return++this.Tr}Er(e){const t=[e,this.Ir()];if(this.buffer.size<this.Pr)this.buffer=this.buffer.add(t);else{const i=this.buffer.last();Px(t,i)<0&&(this.buffer=this.buffer.delete(i).add(t))}}get maxValue(){return this.buffer.last()[0]}}class TA{constructor(e,t,i){this.garbageCollector=e,this.asyncQueue=t,this.localStore=i,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Ar(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Ar(e){ot(Dx,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Xl(t)?ot(Dx,"Ignoring IndexedDB error during garbage collection: ",t):await Ql(t)}await this.Ar(3e5)}))}}class jA{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.dr(e).next((i=>Math.floor(t/100*i)))}nthSequenceNumber(e,t){if(t===0)return Me.resolve(ef.ce);const i=new kA(t);return this.Vr.forEachTarget(e,(l=>i.Er(l.sequenceNumber))).next((()=>this.Vr.mr(e,(l=>i.Er(l))))).next((()=>i.maxValue))}removeTargets(e,t,i){return this.Vr.removeTargets(e,t,i)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(ot("LruGarbageCollector","Garbage collection skipped; disabled"),Me.resolve(Mx)):this.getCacheSize(e).next((i=>i<this.params.cacheSizeCollectionThreshold?(ot("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Mx):this.gr(e,t)))}getCacheSize(e){return this.Vr.getCacheSize(e)}gr(e,t){let i,l,u,h,p,g,y;const w=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((k=>(k>this.params.maximumSequenceNumbersToCollect?(ot("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${k}`),l=this.params.maximumSequenceNumbersToCollect):l=k,h=Date.now(),this.nthSequenceNumber(e,l)))).next((k=>(i=k,p=Date.now(),this.removeTargets(e,i,t)))).next((k=>(u=k,g=Date.now(),this.removeOrphanedDocuments(e,i)))).next((k=>(y=Date.now(),Cl()<=fn.DEBUG&&ot("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${h-w}ms
	Determined least recently used ${l} in `+(p-h)+`ms
	Removed ${u} targets in `+(g-p)+`ms
	Removed ${k} documents in `+(y-g)+`ms
Total Duration: ${y-w}ms`),Me.resolve({didRun:!0,sequenceNumbersCollected:l,targetsRemoved:u,documentsRemoved:k}))))}}function EA(s,e){return new jA(s,e)}class SA{constructor(){this.changes=new Wo((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,er.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const i=this.changes.get(t);return i!==void 0?Me.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class NA{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class CA{constructor(e,t,i,l){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=l}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next((l=>(i=l,this.remoteDocumentCache.getEntry(e,t)))).next((l=>(i!==null&&nu(i.mutation,l,Dr.empty(),vt.now()),l)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.getLocalViewOfDocuments(e,i,pn()).next((()=>i))))}getLocalViewOfDocuments(e,t,i=pn()){const l=Ao();return this.populateOverlays(e,l,t).next((()=>this.computeViews(e,t,l,i).next((u=>{let h=Kc();return u.forEach(((p,g)=>{h=h.insert(p,g.overlayedDocument)})),h}))))}getOverlayedDocuments(e,t){const i=Ao();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,pn())))}populateOverlays(e,t,i){const l=[];return i.forEach((u=>{t.has(u)||l.push(u)})),this.documentOverlayCache.getOverlays(e,l).next((u=>{u.forEach(((h,p)=>{t.set(h,p)}))}))}computeViews(e,t,i,l){let u=ui();const h=tu(),p=(function(){return tu()})();return t.forEach(((g,y)=>{const w=i.get(y.key);l.has(y.key)&&(w===void 0||w.mutation instanceof co)?u=u.insert(y.key,y):w!==void 0?(h.set(y.key,w.mutation.getFieldMask()),nu(w.mutation,y,w.mutation.getFieldMask(),vt.now())):h.set(y.key,Dr.empty())})),this.recalculateAndSaveOverlays(e,u).next((g=>(g.forEach(((y,w)=>h.set(y,w))),t.forEach(((y,w)=>p.set(y,new NA(w,h.get(y)??null)))),p)))}recalculateAndSaveOverlays(e,t){const i=tu();let l=new ds(((h,p)=>h-p)),u=pn();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((h=>{for(const p of h)p.keys().forEach((g=>{const y=t.get(g);if(y===null)return;let w=i.get(g)||Dr.empty();w=p.applyToLocalView(y,w),i.set(g,w);const k=(l.get(p.batchId)||pn()).add(g);l=l.insert(p.batchId,k)}))})).next((()=>{const h=[],p=l.getReverseIterator();for(;p.hasNext();){const g=p.getNext(),y=g.key,w=g.value,k=c_();w.forEach((j=>{if(!u.has(j)){const O=y_(t.get(j),i.get(j));O!==null&&k.set(j,O),u=u.add(j)}})),h.push(this.documentOverlayCache.saveOverlays(e,y,k))}return Me.waitFor(h)})).next((()=>i))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.recalculateAndSaveOverlays(e,i)))}getDocumentsMatchingQuery(e,t,i,l){return AR(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):r_(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i,l):this.getDocumentsMatchingCollectionQuery(e,t,i,l)}getNextDocuments(e,t,i,l){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,l).next((u=>{const h=l-u.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,l-u.size):Me.resolve(Ao());let p=cu,g=u;return h.next((y=>Me.forEach(y,((w,k)=>(p<k.largestBatchId&&(p=k.largestBatchId),u.get(w)?Me.resolve():this.remoteDocumentCache.getEntry(e,w).next((j=>{g=g.insert(w,j)}))))).next((()=>this.populateOverlays(e,y,u))).next((()=>this.computeViews(e,g,y,pn()))).next((w=>({batchId:p,changes:l_(w)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new jt(t)).next((i=>{let l=Kc();return i.isFoundDocument()&&(l=l.insert(i.key,i)),l}))}getDocumentsMatchingCollectionGroupQuery(e,t,i,l){const u=t.collectionGroup;let h=Kc();return this.indexManager.getCollectionParents(e,u).next((p=>Me.forEach(p,(g=>{const y=(function(k,j){return new Jl(j,null,k.explicitOrderBy.slice(),k.filters.slice(),k.limit,k.limitType,k.startAt,k.endAt)})(t,g.child(u));return this.getDocumentsMatchingCollectionQuery(e,y,i,l).next((w=>{w.forEach(((k,j)=>{h=h.insert(k,j)}))}))})).next((()=>h))))}getDocumentsMatchingCollectionQuery(e,t,i,l){let u;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next((h=>(u=h,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,u,l)))).next((h=>{u.forEach(((g,y)=>{const w=y.getKey();h.get(w)===null&&(h=h.insert(w,er.newInvalidDocument(w)))}));let p=Kc();return h.forEach(((g,y)=>{const w=u.get(g);w!==void 0&&nu(w.mutation,y,Dr.empty(),vt.now()),af(t,y)&&(p=p.insert(g,y))})),p}))}}class RA{constructor(e){this.serializer=e,this.Nr=new Map,this.Br=new Map}getBundleMetadata(e,t){return Me.resolve(this.Nr.get(t))}saveBundleMetadata(e,t){return this.Nr.set(t.id,(function(l){return{id:l.id,version:l.version,createTime:Sa(l.createTime)}})(t)),Me.resolve()}getNamedQuery(e,t){return Me.resolve(this.Br.get(t))}saveNamedQuery(e,t){return this.Br.set(t.name,(function(l){return{name:l.name,query:vA(l.bundledQuery),readTime:Sa(l.readTime)}})(t)),Me.resolve()}}class AA{constructor(){this.overlays=new ds(jt.comparator),this.Lr=new Map}getOverlay(e,t){return Me.resolve(this.overlays.get(t))}getOverlays(e,t){const i=Ao();return Me.forEach(t,(l=>this.getOverlay(e,l).next((u=>{u!==null&&i.set(l,u)})))).next((()=>i))}saveOverlays(e,t,i){return i.forEach(((l,u)=>{this.bt(e,t,u)})),Me.resolve()}removeOverlaysForBatchId(e,t,i){const l=this.Lr.get(i);return l!==void 0&&(l.forEach((u=>this.overlays=this.overlays.remove(u))),this.Lr.delete(i)),Me.resolve()}getOverlaysForCollection(e,t,i){const l=Ao(),u=t.length+1,h=new jt(t.child("")),p=this.overlays.getIteratorFrom(h);for(;p.hasNext();){const g=p.getNext().value,y=g.getKey();if(!t.isPrefixOf(y.path))break;y.path.length===u&&g.largestBatchId>i&&l.set(g.getKey(),g)}return Me.resolve(l)}getOverlaysForCollectionGroup(e,t,i,l){let u=new ds(((y,w)=>y-w));const h=this.overlays.getIterator();for(;h.hasNext();){const y=h.getNext().value;if(y.getKey().getCollectionGroup()===t&&y.largestBatchId>i){let w=u.get(y.largestBatchId);w===null&&(w=Ao(),u=u.insert(y.largestBatchId,w)),w.set(y.getKey(),y)}}const p=Ao(),g=u.getIterator();for(;g.hasNext()&&(g.getNext().value.forEach(((y,w)=>p.set(y,w))),!(p.size()>=l)););return Me.resolve(p)}bt(e,t,i){const l=this.overlays.get(i.key);if(l!==null){const h=this.Lr.get(l.largestBatchId).delete(i.key);this.Lr.set(l.largestBatchId,h)}this.overlays=this.overlays.insert(i.key,new YR(t,i));let u=this.Lr.get(t);u===void 0&&(u=pn(),this.Lr.set(t,u)),this.Lr.set(t,u.add(i.key))}}class IA{constructor(){this.sessionToken=Ys.EMPTY_BYTE_STRING}getSessionToken(e){return Me.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,Me.resolve()}}class iy{constructor(){this.kr=new Ls(zs.Kr),this.qr=new Ls(zs.Ur)}isEmpty(){return this.kr.isEmpty()}addReference(e,t){const i=new zs(e,t);this.kr=this.kr.add(i),this.qr=this.qr.add(i)}$r(e,t){e.forEach((i=>this.addReference(i,t)))}removeReference(e,t){this.Wr(new zs(e,t))}Qr(e,t){e.forEach((i=>this.removeReference(i,t)))}Gr(e){const t=new jt(new es([])),i=new zs(t,e),l=new zs(t,e+1),u=[];return this.qr.forEachInRange([i,l],(h=>{this.Wr(h),u.push(h.key)})),u}zr(){this.kr.forEach((e=>this.Wr(e)))}Wr(e){this.kr=this.kr.delete(e),this.qr=this.qr.delete(e)}jr(e){const t=new jt(new es([])),i=new zs(t,e),l=new zs(t,e+1);let u=pn();return this.qr.forEachInRange([i,l],(h=>{u=u.add(h.key)})),u}containsKey(e){const t=new zs(e,0),i=this.kr.firstAfterOrEqual(t);return i!==null&&e.isEqual(i.key)}}class zs{constructor(e,t){this.key=e,this.Hr=t}static Kr(e,t){return jt.comparator(e.key,t.key)||mn(e.Hr,t.Hr)}static Ur(e,t){return mn(e.Hr,t.Hr)||jt.comparator(e.key,t.key)}}class MA{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Yn=1,this.Jr=new Ls(zs.Kr)}checkEmpty(e){return Me.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,i,l){const u=this.Yn;this.Yn++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const h=new KR(u,t,i,l);this.mutationQueue.push(h);for(const p of l)this.Jr=this.Jr.add(new zs(p.key,u)),this.indexManager.addToCollectionParentIndex(e,p.key.path.popLast());return Me.resolve(h)}lookupMutationBatch(e,t){return Me.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,l=this.Xr(i),u=l<0?0:l;return Me.resolve(this.mutationQueue.length>u?this.mutationQueue[u]:null)}getHighestUnacknowledgedBatchId(){return Me.resolve(this.mutationQueue.length===0?Xg:this.Yn-1)}getAllMutationBatches(e){return Me.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const i=new zs(t,0),l=new zs(t,Number.POSITIVE_INFINITY),u=[];return this.Jr.forEachInRange([i,l],(h=>{const p=this.Zr(h.Hr);u.push(p)})),Me.resolve(u)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new Ls(mn);return t.forEach((l=>{const u=new zs(l,0),h=new zs(l,Number.POSITIVE_INFINITY);this.Jr.forEachInRange([u,h],(p=>{i=i.add(p.Hr)}))})),Me.resolve(this.Yr(i))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,l=i.length+1;let u=i;jt.isDocumentKey(u)||(u=u.child(""));const h=new zs(new jt(u),0);let p=new Ls(mn);return this.Jr.forEachWhile((g=>{const y=g.key.path;return!!i.isPrefixOf(y)&&(y.length===l&&(p=p.add(g.Hr)),!0)}),h),Me.resolve(this.Yr(p))}Yr(e){const t=[];return e.forEach((i=>{const l=this.Zr(i);l!==null&&t.push(l)})),t}removeMutationBatch(e,t){On(this.ei(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.Jr;return Me.forEach(t.mutations,(l=>{const u=new zs(l.key,t.batchId);return i=i.delete(u),this.referenceDelegate.markPotentiallyOrphaned(e,l.key)})).next((()=>{this.Jr=i}))}nr(e){}containsKey(e,t){const i=new zs(t,0),l=this.Jr.firstAfterOrEqual(i);return Me.resolve(t.isEqual(l&&l.key))}performConsistencyCheck(e){return this.mutationQueue.length,Me.resolve()}ei(e,t){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class DA{constructor(e){this.ti=e,this.docs=(function(){return new ds(jt.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const i=t.key,l=this.docs.get(i),u=l?l.size:0,h=this.ti(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:h}),this.size+=h-u,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const i=this.docs.get(t);return Me.resolve(i?i.document.mutableCopy():er.newInvalidDocument(t))}getEntries(e,t){let i=ui();return t.forEach((l=>{const u=this.docs.get(l);i=i.insert(l,u?u.document.mutableCopy():er.newInvalidDocument(l))})),Me.resolve(i)}getDocumentsMatchingQuery(e,t,i,l){let u=ui();const h=t.path,p=new jt(h.child("__id-9223372036854775808__")),g=this.docs.getIteratorFrom(p);for(;g.hasNext();){const{key:y,value:{document:w}}=g.getNext();if(!h.isPrefixOf(y.path))break;y.path.length>h.length+1||oR(iR(w),i)<=0||(l.has(w.key)||af(t,w))&&(u=u.insert(w.key,w.mutableCopy()))}return Me.resolve(u)}getAllFromCollectionGroup(e,t,i,l){Vt(9500)}ni(e,t){return Me.forEach(this.docs,(i=>t(i)))}newChangeBuffer(e){return new PA(this)}getSize(e){return Me.resolve(this.size)}}class PA extends SA{constructor(e){super(),this.Mr=e}applyChanges(e){const t=[];return this.changes.forEach(((i,l)=>{l.isValidDocument()?t.push(this.Mr.addEntry(e,l)):this.Mr.removeEntry(i)})),Me.waitFor(t)}getFromCache(e,t){return this.Mr.getEntry(e,t)}getAllFromCache(e,t){return this.Mr.getEntries(e,t)}}class LA{constructor(e){this.persistence=e,this.ri=new Wo((t=>ey(t)),ty),this.lastRemoteSnapshotVersion=Gt.min(),this.highestTargetId=0,this.ii=0,this.si=new iy,this.targetCount=0,this.oi=ql._r()}forEachTarget(e,t){return this.ri.forEach(((i,l)=>t(l))),Me.resolve()}getLastRemoteSnapshotVersion(e){return Me.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Me.resolve(this.ii)}allocateTargetId(e){return this.highestTargetId=this.oi.next(),Me.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.ii&&(this.ii=t),Me.resolve()}lr(e){this.ri.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.oi=new ql(t),this.highestTargetId=t),e.sequenceNumber>this.ii&&(this.ii=e.sequenceNumber)}addTargetData(e,t){return this.lr(t),this.targetCount+=1,Me.resolve()}updateTargetData(e,t){return this.lr(t),Me.resolve()}removeTargetData(e,t){return this.ri.delete(t.target),this.si.Gr(t.targetId),this.targetCount-=1,Me.resolve()}removeTargets(e,t,i){let l=0;const u=[];return this.ri.forEach(((h,p)=>{p.sequenceNumber<=t&&i.get(p.targetId)===null&&(this.ri.delete(h),u.push(this.removeMatchingKeysForTargetId(e,p.targetId)),l++)})),Me.waitFor(u).next((()=>l))}getTargetCount(e){return Me.resolve(this.targetCount)}getTargetData(e,t){const i=this.ri.get(t)||null;return Me.resolve(i)}addMatchingKeys(e,t,i){return this.si.$r(t,i),Me.resolve()}removeMatchingKeys(e,t,i){this.si.Qr(t,i);const l=this.persistence.referenceDelegate,u=[];return l&&t.forEach((h=>{u.push(l.markPotentiallyOrphaned(e,h))})),Me.waitFor(u)}removeMatchingKeysForTargetId(e,t){return this.si.Gr(t),Me.resolve()}getMatchingKeysForTargetId(e,t){const i=this.si.jr(t);return Me.resolve(i)}containsKey(e,t){return Me.resolve(this.si.containsKey(t))}}class A_{constructor(e,t){this._i={},this.overlays={},this.ai=new ef(0),this.ui=!1,this.ui=!0,this.ci=new IA,this.referenceDelegate=e(this),this.li=new LA(this),this.indexManager=new xA,this.remoteDocumentCache=(function(l){return new DA(l)})((i=>this.referenceDelegate.hi(i))),this.serializer=new bA(t),this.Pi=new RA(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ui=!1,Promise.resolve()}get started(){return this.ui}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new AA,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this._i[e.toKey()];return i||(i=new MA(t,this.referenceDelegate),this._i[e.toKey()]=i),i}getGlobalsCache(){return this.ci}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Pi}runTransaction(e,t,i){ot("MemoryPersistence","Starting transaction:",e);const l=new OA(this.ai.next());return this.referenceDelegate.Ti(),i(l).next((u=>this.referenceDelegate.Ii(l).next((()=>u)))).toPromise().then((u=>(l.raiseOnCommittedEvent(),u)))}Ei(e,t){return Me.or(Object.values(this._i).map((i=>()=>i.containsKey(e,t))))}}class OA extends cR{constructor(e){super(),this.currentSequenceNumber=e}}class oy{constructor(e){this.persistence=e,this.Ri=new iy,this.Ai=null}static Vi(e){return new oy(e)}get di(){if(this.Ai)return this.Ai;throw Vt(60996)}addReference(e,t,i){return this.Ri.addReference(i,t),this.di.delete(i.toString()),Me.resolve()}removeReference(e,t,i){return this.Ri.removeReference(i,t),this.di.add(i.toString()),Me.resolve()}markPotentiallyOrphaned(e,t){return this.di.add(t.toString()),Me.resolve()}removeTarget(e,t){this.Ri.Gr(t.targetId).forEach((l=>this.di.add(l.toString())));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next((l=>{l.forEach((u=>this.di.add(u.toString())))})).next((()=>i.removeTargetData(e,t)))}Ti(){this.Ai=new Set}Ii(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Me.forEach(this.di,(i=>{const l=jt.fromPath(i);return this.mi(e,l).next((u=>{u||t.removeEntry(l,Gt.min())}))})).next((()=>(this.Ai=null,t.apply(e))))}updateLimboDocument(e,t){return this.mi(e,t).next((i=>{i?this.di.delete(t.toString()):this.di.add(t.toString())}))}hi(e){return 0}mi(e,t){return Me.or([()=>Me.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}}class Vd{constructor(e,t){this.persistence=e,this.fi=new Wo((i=>dR(i.path)),((i,l)=>i.isEqual(l))),this.garbageCollector=EA(this,t)}static Vi(e,t){return new Vd(e,t)}Ti(){}Ii(e){return Me.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}dr(e){const t=this.pr(e);return this.persistence.getTargetCache().getTargetCount(e).next((i=>t.next((l=>i+l))))}pr(e){let t=0;return this.mr(e,(i=>{t++})).next((()=>t))}mr(e,t){return Me.forEach(this.fi,((i,l)=>this.wr(e,i,l).next((u=>u?Me.resolve():t(l)))))}removeTargets(e,t,i){return this.persistence.getTargetCache().removeTargets(e,t,i)}removeOrphanedDocuments(e,t){let i=0;const l=this.persistence.getRemoteDocumentCache(),u=l.newChangeBuffer();return l.ni(e,(h=>this.wr(e,h,t).next((p=>{p||(i++,u.removeEntry(h,Gt.min()))})))).next((()=>u.apply(e))).next((()=>i))}markPotentiallyOrphaned(e,t){return this.fi.set(t,e.currentSequenceNumber),Me.resolve()}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,i)}addReference(e,t,i){return this.fi.set(i,e.currentSequenceNumber),Me.resolve()}removeReference(e,t,i){return this.fi.set(i,e.currentSequenceNumber),Me.resolve()}updateLimboDocument(e,t){return this.fi.set(t,e.currentSequenceNumber),Me.resolve()}hi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=yd(e.data.value)),t}wr(e,t,i){return Me.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const l=this.fi.get(t);return Me.resolve(l!==void 0&&l>i)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class ly{constructor(e,t,i,l){this.targetId=e,this.fromCache=t,this.Ts=i,this.Is=l}static Es(e,t){let i=pn(),l=pn();for(const u of t.docChanges)switch(u.type){case 0:i=i.add(u.doc.key);break;case 1:l=l.add(u.doc.key)}return new ly(e,t.fromCache,i,l)}}class VA{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class BA{constructor(){this.Rs=!1,this.As=!1,this.Vs=100,this.ds=(function(){return dS()?8:uR(tr())>0?6:4})()}initialize(e,t){this.fs=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,i,l){const u={result:null};return this.gs(e,t).next((h=>{u.result=h})).next((()=>{if(!u.result)return this.ps(e,t,l,i).next((h=>{u.result=h}))})).next((()=>{if(u.result)return;const h=new VA;return this.ys(e,t,h).next((p=>{if(u.result=p,this.As)return this.ws(e,t,h,p.size)}))})).next((()=>u.result))}ws(e,t,i,l){return i.documentReadCount<this.Vs?(Cl()<=fn.DEBUG&&ot("QueryEngine","SDK will not create cache indexes for query:",Rl(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),Me.resolve()):(Cl()<=fn.DEBUG&&ot("QueryEngine","Query:",Rl(t),"scans",i.documentReadCount,"local documents and returns",l,"documents as results."),i.documentReadCount>this.ds*l?(Cl()<=fn.DEBUG&&ot("QueryEngine","The SDK decides to create cache indexes for query:",Rl(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Ea(t))):Me.resolve())}gs(e,t){if(kx(t))return Me.resolve(null);let i=Ea(t);return this.indexManager.getIndexType(e,i).next((l=>l===0?null:(t.limit!==null&&l===1&&(t=Ld(t,null,"F"),i=Ea(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next((u=>{const h=pn(...u);return this.fs.getDocuments(e,h).next((p=>this.indexManager.getMinOffset(e,i).next((g=>{const y=this.bs(t,p);return this.Ss(t,y,h,g.readTime)?this.gs(e,Ld(t,null,"F")):this.Ds(e,y,t,g)}))))})))))}ps(e,t,i,l){return kx(t)||l.isEqual(Gt.min())?Me.resolve(null):this.fs.getDocuments(e,i).next((u=>{const h=this.bs(t,u);return this.Ss(t,h,i,l)?Me.resolve(null):(Cl()<=fn.DEBUG&&ot("QueryEngine","Re-using previous result from %s to execute query: %s",l.toString(),Rl(t)),this.Ds(e,h,t,aR(l,cu)).next((p=>p)))}))}bs(e,t){let i=new Ls(i_(e));return t.forEach(((l,u)=>{af(e,u)&&(i=i.add(u))})),i}Ss(e,t,i,l){if(e.limit===null)return!1;if(i.size!==t.size)return!0;const u=e.limitType==="F"?t.last():t.first();return!!u&&(u.hasPendingWrites||u.version.compareTo(l)>0)}ys(e,t,i){return Cl()<=fn.DEBUG&&ot("QueryEngine","Using full collection scan to execute query:",Rl(t)),this.fs.getDocumentsMatchingQuery(e,t,eo.min(),i)}Ds(e,t,i,l){return this.fs.getDocumentsMatchingQuery(e,i,l).next((u=>(t.forEach((h=>{u=u.insert(h.key,h)})),u)))}}const cy="LocalStore",UA=3e8;class zA{constructor(e,t,i,l){this.persistence=e,this.Cs=t,this.serializer=l,this.vs=new ds(mn),this.Fs=new Wo((u=>ey(u)),ty),this.Ms=new Map,this.xs=e.getRemoteDocumentCache(),this.li=e.getTargetCache(),this.Pi=e.getBundleCache(),this.Os(i)}Os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new CA(this.xs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.xs.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.vs)))}}function FA(s,e,t,i){return new zA(s,e,t,i)}async function I_(s,e){const t=Qt(s);return await t.persistence.runTransaction("Handle user change","readonly",(i=>{let l;return t.mutationQueue.getAllMutationBatches(i).next((u=>(l=u,t.Os(e),t.mutationQueue.getAllMutationBatches(i)))).next((u=>{const h=[],p=[];let g=pn();for(const y of l){h.push(y.batchId);for(const w of y.mutations)g=g.add(w.key)}for(const y of u){p.push(y.batchId);for(const w of y.mutations)g=g.add(w.key)}return t.localDocuments.getDocuments(i,g).next((y=>({Ns:y,removedBatchIds:h,addedBatchIds:p})))}))}))}function qA(s,e){const t=Qt(s);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(i=>{const l=e.batch.keys(),u=t.xs.newChangeBuffer({trackRemovals:!0});return(function(p,g,y,w){const k=y.batch,j=k.keys();let O=Me.resolve();return j.forEach(($=>{O=O.next((()=>w.getEntry(g,$))).next((U=>{const L=y.docVersions.get($);On(L!==null,48541),U.version.compareTo(L)<0&&(k.applyToRemoteDocument(U,y),U.isValidDocument()&&(U.setReadTime(y.commitVersion),w.addEntry(U)))}))})),O.next((()=>p.mutationQueue.removeMutationBatch(g,k)))})(t,i,e,u).next((()=>u.apply(i))).next((()=>t.mutationQueue.performConsistencyCheck(i))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(i,l,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,(function(p){let g=pn();for(let y=0;y<p.mutationResults.length;++y)p.mutationResults[y].transformResults.length>0&&(g=g.add(p.batch.mutations[y].key));return g})(e)))).next((()=>t.localDocuments.getDocuments(i,l)))}))}function M_(s){const e=Qt(s);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.li.getLastRemoteSnapshotVersion(t)))}function HA(s,e){const t=Qt(s),i=e.snapshotVersion;let l=t.vs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(u=>{const h=t.xs.newChangeBuffer({trackRemovals:!0});l=t.vs;const p=[];e.targetChanges.forEach(((w,k)=>{const j=l.get(k);if(!j)return;p.push(t.li.removeMatchingKeys(u,w.removedDocuments,k).next((()=>t.li.addMatchingKeys(u,w.addedDocuments,k))));let O=j.withSequenceNumber(u.currentSequenceNumber);e.targetMismatches.get(k)!==null?O=O.withResumeToken(Ys.EMPTY_BYTE_STRING,Gt.min()).withLastLimboFreeSnapshotVersion(Gt.min()):w.resumeToken.approximateByteSize()>0&&(O=O.withResumeToken(w.resumeToken,i)),l=l.insert(k,O),(function(U,L,ne){return U.resumeToken.approximateByteSize()===0||L.snapshotVersion.toMicroseconds()-U.snapshotVersion.toMicroseconds()>=UA?!0:ne.addedDocuments.size+ne.modifiedDocuments.size+ne.removedDocuments.size>0})(j,O,w)&&p.push(t.li.updateTargetData(u,O))}));let g=ui(),y=pn();if(e.documentUpdates.forEach((w=>{e.resolvedLimboDocuments.has(w)&&p.push(t.persistence.referenceDelegate.updateLimboDocument(u,w))})),p.push($A(u,h,e.documentUpdates).next((w=>{g=w.Bs,y=w.Ls}))),!i.isEqual(Gt.min())){const w=t.li.getLastRemoteSnapshotVersion(u).next((k=>t.li.setTargetsMetadata(u,u.currentSequenceNumber,i)));p.push(w)}return Me.waitFor(p).next((()=>h.apply(u))).next((()=>t.localDocuments.getLocalViewOfDocuments(u,g,y))).next((()=>g))})).then((u=>(t.vs=l,u)))}function $A(s,e,t){let i=pn(),l=pn();return t.forEach((u=>i=i.add(u))),e.getEntries(s,i).next((u=>{let h=ui();return t.forEach(((p,g)=>{const y=u.get(p);g.isFoundDocument()!==y.isFoundDocument()&&(l=l.add(p)),g.isNoDocument()&&g.version.isEqual(Gt.min())?(e.removeEntry(p,g.readTime),h=h.insert(p,g)):!y.isValidDocument()||g.version.compareTo(y.version)>0||g.version.compareTo(y.version)===0&&y.hasPendingWrites?(e.addEntry(g),h=h.insert(p,g)):ot(cy,"Ignoring outdated watch update for ",p,". Current version:",y.version," Watch version:",g.version)})),{Bs:h,Ls:l}}))}function WA(s,e){const t=Qt(s);return t.persistence.runTransaction("Get next mutation batch","readonly",(i=>(e===void 0&&(e=Xg),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e))))}function GA(s,e){const t=Qt(s);return t.persistence.runTransaction("Allocate target","readwrite",(i=>{let l;return t.li.getTargetData(i,e).next((u=>u?(l=u,Me.resolve(l)):t.li.allocateTargetId(i).next((h=>(l=new Wi(e,h,"TargetPurposeListen",i.currentSequenceNumber),t.li.addTargetData(i,l).next((()=>l)))))))})).then((i=>{const l=t.vs.get(i.targetId);return(l===null||i.snapshotVersion.compareTo(l.snapshotVersion)>0)&&(t.vs=t.vs.insert(i.targetId,i),t.Fs.set(e,i.targetId)),i}))}async function vg(s,e,t){const i=Qt(s),l=i.vs.get(e),u=t?"readwrite":"readwrite-primary";try{t||await i.persistence.runTransaction("Release target",u,(h=>i.persistence.referenceDelegate.removeTarget(h,l)))}catch(h){if(!Xl(h))throw h;ot(cy,`Failed to update sequence numbers for target ${e}: ${h}`)}i.vs=i.vs.remove(e),i.Fs.delete(l.target)}function Lx(s,e,t){const i=Qt(s);let l=Gt.min(),u=pn();return i.persistence.runTransaction("Execute query","readwrite",(h=>(function(g,y,w){const k=Qt(g),j=k.Fs.get(w);return j!==void 0?Me.resolve(k.vs.get(j)):k.li.getTargetData(y,w)})(i,h,Ea(e)).next((p=>{if(p)return l=p.lastLimboFreeSnapshotVersion,i.li.getMatchingKeysForTargetId(h,p.targetId).next((g=>{u=g}))})).next((()=>i.Cs.getDocumentsMatchingQuery(h,e,t?l:Gt.min(),t?u:pn()))).next((p=>(KA(i,DR(e),p),{documents:p,ks:u})))))}function KA(s,e,t){let i=s.Ms.get(e)||Gt.min();t.forEach(((l,u)=>{u.readTime.compareTo(i)>0&&(i=u.readTime)})),s.Ms.set(e,i)}class Ox{constructor(){this.activeTargetIds=UR()}Qs(e){this.activeTargetIds=this.activeTargetIds.add(e)}Gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class YA{constructor(){this.vo=new Ox,this.Fo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e,t=!0){return t&&this.vo.Qs(e),this.Fo[e]||"not-current"}updateQueryState(e,t,i){this.Fo[e]=t}removeLocalQueryTarget(e){this.vo.Gs(e)}isLocalQueryTarget(e){return this.vo.activeTargetIds.has(e)}clearQueryState(e){delete this.Fo[e]}getAllActiveQueryTargets(){return this.vo.activeTargetIds}isActiveQueryTarget(e){return this.vo.activeTargetIds.has(e)}start(){return this.vo=new Ox,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class QA{Mo(e){}shutdown(){}}const Vx="ConnectivityMonitor";class Bx{constructor(){this.xo=()=>this.Oo(),this.No=()=>this.Bo(),this.Lo=[],this.ko()}Mo(e){this.Lo.push(e)}shutdown(){window.removeEventListener("online",this.xo),window.removeEventListener("offline",this.No)}ko(){window.addEventListener("online",this.xo),window.addEventListener("offline",this.No)}Oo(){ot(Vx,"Network connectivity changed: AVAILABLE");for(const e of this.Lo)e(0)}Bo(){ot(Vx,"Network connectivity changed: UNAVAILABLE");for(const e of this.Lo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let td=null;function xg(){return td===null?td=(function(){return 268435456+Math.round(2147483648*Math.random())})():td++,"0x"+td.toString(16)}const Rp="RestConnection",XA={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery",ExecutePipeline:"executePipeline"};class JA{get Ko(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),l=encodeURIComponent(this.databaseId.database);this.qo=t+"://"+e.host,this.Uo=`projects/${i}/databases/${l}`,this.$o=this.databaseId.database===Md?`project_id=${i}`:`project_id=${i}&database_id=${l}`}Wo(e,t,i,l,u){const h=xg(),p=this.Qo(e,t.toUriEncodedString());ot(Rp,`Sending RPC '${e}' ${h}:`,p,i);const g={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.$o};this.Go(g,l,u);const{host:y}=new URL(p),w=io(y);return this.zo(e,p,g,i,w).then((k=>(ot(Rp,`Received RPC '${e}' ${h}: `,k),k)),(k=>{throw Bl(Rp,`RPC '${e}' ${h} failed with error: `,k,"url: ",p,"request:",i),k}))}jo(e,t,i,l,u,h){return this.Wo(e,t,i,l,u)}Go(e,t,i){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Yl})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((l,u)=>e[u]=l)),i&&i.headers.forEach(((l,u)=>e[u]=l))}Qo(e,t){const i=XA[e];let l=`${this.qo}/v1/${t}:${i}`;return this.databaseInfo.apiKey&&(l=`${l}?key=${encodeURIComponent(this.databaseInfo.apiKey)}`),l}terminate(){}}class ZA{constructor(e){this.Ho=e.Ho,this.Jo=e.Jo}Zo(e){this.Xo=e}Yo(e){this.e_=e}t_(e){this.n_=e}onMessage(e){this.r_=e}close(){this.Jo()}send(e){this.Ho(e)}i_(){this.Xo()}s_(){this.e_()}o_(e){this.n_(e)}__(e){this.r_(e)}}const Js="WebChannelConnection",Uc=(s,e,t)=>{s.listen(e,(i=>{try{t(i)}catch(l){setTimeout((()=>{throw l}),0)}}))};class Ol extends JA{constructor(e){super(e),this.a_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}static u_(){if(!Ol.c_){const e=Lw();Uc(e,Pw.STAT_EVENT,(t=>{t.stat===lg.PROXY?ot(Js,"STAT_EVENT: detected buffering proxy"):t.stat===lg.NOPROXY&&ot(Js,"STAT_EVENT: detected no buffering proxy")})),Ol.c_=!0}}zo(e,t,i,l,u){const h=xg();return new Promise(((p,g)=>{const y=new Mw;y.setWithCredentials(!0),y.listenOnce(Dw.COMPLETE,(()=>{try{switch(y.getLastErrorCode()){case gd.NO_ERROR:const k=y.getResponseJson();ot(Js,`XHR for RPC '${e}' ${h} received:`,JSON.stringify(k)),p(k);break;case gd.TIMEOUT:ot(Js,`RPC '${e}' ${h} timed out`),g(new nt(ke.DEADLINE_EXCEEDED,"Request time out"));break;case gd.HTTP_ERROR:const j=y.getStatus();if(ot(Js,`RPC '${e}' ${h} failed with status:`,j,"response text:",y.getResponseText()),j>0){let O=y.getResponseJson();Array.isArray(O)&&(O=O[0]);const $=O?.error;if($&&$.status&&$.message){const U=(function(ne){const Z=ne.toLowerCase().replace(/_/g,"-");return Object.values(ke).indexOf(Z)>=0?Z:ke.UNKNOWN})($.status);g(new nt(U,$.message))}else g(new nt(ke.UNKNOWN,"Server responded with status "+y.getStatus()))}else g(new nt(ke.UNAVAILABLE,"Connection failed."));break;default:Vt(9055,{l_:e,streamId:h,h_:y.getLastErrorCode(),P_:y.getLastError()})}}finally{ot(Js,`RPC '${e}' ${h} completed.`)}}));const w=JSON.stringify(l);ot(Js,`RPC '${e}' ${h} sending request:`,l),y.send(t,"POST",w,i,15)}))}T_(e,t,i){const l=xg(),u=[this.qo,"/","google.firestore.v1.Firestore","/",e,"/channel"],h=this.createWebChannelTransport(),p={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},g=this.longPollingOptions.timeoutSeconds;g!==void 0&&(p.longPollingTimeout=Math.round(1e3*g)),this.useFetchStreams&&(p.useFetchStreams=!0),this.Go(p.initMessageHeaders,t,i),p.encodeInitMessageHeaders=!0;const y=u.join("");ot(Js,`Creating RPC '${e}' stream ${l}: ${y}`,p);const w=h.createWebChannel(y,p);this.I_(w);let k=!1,j=!1;const O=new ZA({Ho:$=>{j?ot(Js,`Not sending because RPC '${e}' stream ${l} is closed:`,$):(k||(ot(Js,`Opening RPC '${e}' stream ${l} transport.`),w.open(),k=!0),ot(Js,`RPC '${e}' stream ${l} sending:`,$),w.send($))},Jo:()=>w.close()});return Uc(w,Gc.EventType.OPEN,(()=>{j||(ot(Js,`RPC '${e}' stream ${l} transport opened.`),O.i_())})),Uc(w,Gc.EventType.CLOSE,(()=>{j||(j=!0,ot(Js,`RPC '${e}' stream ${l} transport closed`),O.o_(),this.E_(w))})),Uc(w,Gc.EventType.ERROR,($=>{j||(j=!0,Bl(Js,`RPC '${e}' stream ${l} transport errored. Name:`,$.name,"Message:",$.message),O.o_(new nt(ke.UNAVAILABLE,"The operation could not be completed")))})),Uc(w,Gc.EventType.MESSAGE,($=>{if(!j){const U=$.data[0];On(!!U,16349);const L=U,ne=L?.error||L[0]?.error;if(ne){ot(Js,`RPC '${e}' stream ${l} received error:`,ne);const Z=ne.status;let ye=(function(Be){const R=Rs[Be];if(R!==void 0)return v_(R)})(Z),je=ne.message;ye===void 0&&(ye=ke.INTERNAL,je="Unknown error status: "+Z+" with message "+ne.message),j=!0,O.o_(new nt(ye,je)),w.close()}else ot(Js,`RPC '${e}' stream ${l} received:`,U),O.__(U)}})),Ol.u_(),setTimeout((()=>{O.s_()}),0),O}terminate(){this.a_.forEach((e=>e.close())),this.a_=[]}I_(e){this.a_.push(e)}E_(e){this.a_=this.a_.filter((t=>t===e))}Go(e,t,i){super.Go(e,t,i),this.databaseInfo.apiKey&&(e["x-goog-api-key"]=this.databaseInfo.apiKey)}createWebChannelTransport(){return Ow()}}function eI(s){return new Ol(s)}function Ap(){return typeof document<"u"?document:null}function hf(s){return new rA(s,!0)}Ol.c_=!1;class D_{constructor(e,t,i=1e3,l=1.5,u=6e4){this.Ci=e,this.timerId=t,this.R_=i,this.A_=l,this.V_=u,this.d_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.d_=0}g_(){this.d_=this.V_}p_(e){this.cancel();const t=Math.floor(this.d_+this.y_()),i=Math.max(0,Date.now()-this.f_),l=Math.max(0,t-i);l>0&&ot("ExponentialBackoff",`Backing off for ${l} ms (base delay: ${this.d_} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.m_=this.Ci.enqueueAfterDelay(this.timerId,l,(()=>(this.f_=Date.now(),e()))),this.d_*=this.A_,this.d_<this.R_&&(this.d_=this.R_),this.d_>this.V_&&(this.d_=this.V_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.d_}}const Ux="PersistentStream";class P_{constructor(e,t,i,l,u,h,p,g){this.Ci=e,this.b_=i,this.S_=l,this.connection=u,this.authCredentialsProvider=h,this.appCheckCredentialsProvider=p,this.listener=g,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new D_(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Ci.enqueueAfterDelay(this.b_,6e4,(()=>this.k_())))}K_(e){this.q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===ke.RESOURCE_EXHAUSTED?(ci(t.toString()),ci("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===ke.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.t_(t)}W_(){}auth(){this.state=1;const e=this.Q_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([i,l])=>{this.D_===t&&this.G_(i,l)}),(i=>{e((()=>{const l=new nt(ke.UNKNOWN,"Fetching auth token failed: "+i.message);return this.z_(l)}))}))}G_(e,t){const i=this.Q_(this.D_);this.stream=this.j_(e,t),this.stream.Zo((()=>{i((()=>this.listener.Zo()))})),this.stream.Yo((()=>{i((()=>(this.state=2,this.v_=this.Ci.enqueueAfterDelay(this.S_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.Yo())))})),this.stream.t_((l=>{i((()=>this.z_(l)))})),this.stream.onMessage((l=>{i((()=>++this.F_==1?this.H_(l):this.onNext(l)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return ot(Ux,`close with error: ${e}`),this.stream=null,this.close(4,e)}Q_(e){return t=>{this.Ci.enqueueAndForget((()=>this.D_===e?t():(ot(Ux,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class tI extends P_{constructor(e,t,i,l,u,h){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,i,l,h),this.serializer=u}j_(e,t){return this.connection.T_("Listen",e,t)}H_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=oA(this.serializer,e),i=(function(u){if(!("targetChange"in u))return Gt.min();const h=u.targetChange;return h.targetIds&&h.targetIds.length?Gt.min():h.readTime?Sa(h.readTime):Gt.min()})(e);return this.listener.J_(t,i)}Z_(e){const t={};t.database=bg(this.serializer),t.addTarget=(function(u,h){let p;const g=h.target;if(p=fg(g)?{documents:uA(u,g)}:{query:hA(u,g).ft},p.targetId=h.targetId,h.resumeToken.approximateByteSize()>0){p.resumeToken=__(u,h.resumeToken);const y=pg(u,h.expectedCount);y!==null&&(p.expectedCount=y)}else if(h.snapshotVersion.compareTo(Gt.min())>0){p.readTime=Od(u,h.snapshotVersion.toTimestamp());const y=pg(u,h.expectedCount);y!==null&&(p.expectedCount=y)}return p})(this.serializer,e);const i=fA(this.serializer,e);i&&(t.labels=i),this.K_(t)}X_(e){const t={};t.database=bg(this.serializer),t.removeTarget=e,this.K_(t)}}class nI extends P_{constructor(e,t,i,l,u,h){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,l,h),this.serializer=u}get Y_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.Y_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}H_(e){return On(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,On(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){On(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=cA(e.writeResults,e.commitTime),i=Sa(e.commitTime);return this.listener.na(i,t)}ra(){const e={};e.database=bg(this.serializer),this.K_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((i=>lA(this.serializer,i)))};this.K_(t)}}class sI{}class rI extends sI{constructor(e,t,i,l){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=l,this.ia=!1}sa(){if(this.ia)throw new nt(ke.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,i,l){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([u,h])=>this.connection.Wo(e,gg(t,i),l,u,h))).catch((u=>{throw u.name==="FirebaseError"?(u.code===ke.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),u):new nt(ke.UNKNOWN,u.toString())}))}jo(e,t,i,l,u){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([h,p])=>this.connection.jo(e,gg(t,i),l,h,p,u))).catch((h=>{throw h.name==="FirebaseError"?(h.code===ke.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),h):new nt(ke.UNKNOWN,h.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}function aI(s,e,t,i){return new rI(s,e,t,i)}class iI{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(ci(t),this.aa=!1):ot("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const Fo="RemoteStore";class oI{constructor(e,t,i,l,u){this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.Ra=[],this.Aa=u,this.Aa.Mo((h=>{i.enqueueAndForget((async()=>{Go(this)&&(ot(Fo,"Restarting streams for network reachability change."),await(async function(g){const y=Qt(g);y.Ea.add(4),await Cu(y),y.Va.set("Unknown"),y.Ea.delete(4),await df(y)})(this))}))})),this.Va=new iI(i,l)}}async function df(s){if(Go(s))for(const e of s.Ra)await e(!0)}async function Cu(s){for(const e of s.Ra)await e(!1)}function L_(s,e){const t=Qt(s);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),fy(t)?dy(t):Zl(t).O_()&&hy(t,e))}function uy(s,e){const t=Qt(s),i=Zl(t);t.Ia.delete(e),i.O_()&&O_(t,e),t.Ia.size===0&&(i.O_()?i.L_():Go(t)&&t.Va.set("Unknown"))}function hy(s,e){if(s.da.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Gt.min())>0){const t=s.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Zl(s).Z_(e)}function O_(s,e){s.da.$e(e),Zl(s).X_(e)}function dy(s){s.da=new eA({getRemoteKeysForTarget:e=>s.remoteSyncer.getRemoteKeysForTarget(e),At:e=>s.Ia.get(e)||null,ht:()=>s.datastore.serializer.databaseId}),Zl(s).start(),s.Va.ua()}function fy(s){return Go(s)&&!Zl(s).x_()&&s.Ia.size>0}function Go(s){return Qt(s).Ea.size===0}function V_(s){s.da=void 0}async function lI(s){s.Va.set("Online")}async function cI(s){s.Ia.forEach(((e,t)=>{hy(s,e)}))}async function uI(s,e){V_(s),fy(s)?(s.Va.ha(e),dy(s)):s.Va.set("Unknown")}async function hI(s,e,t){if(s.Va.set("Online"),e instanceof w_&&e.state===2&&e.cause)try{await(async function(l,u){const h=u.cause;for(const p of u.targetIds)l.Ia.has(p)&&(await l.remoteSyncer.rejectListen(p,h),l.Ia.delete(p),l.da.removeTarget(p))})(s,e)}catch(i){ot(Fo,"Failed to remove targets %s: %s ",e.targetIds.join(","),i),await Bd(s,i)}else if(e instanceof xd?s.da.Xe(e):e instanceof x_?s.da.st(e):s.da.tt(e),!t.isEqual(Gt.min()))try{const i=await M_(s.localStore);t.compareTo(i)>=0&&await(function(u,h){const p=u.da.Tt(h);return p.targetChanges.forEach(((g,y)=>{if(g.resumeToken.approximateByteSize()>0){const w=u.Ia.get(y);w&&u.Ia.set(y,w.withResumeToken(g.resumeToken,h))}})),p.targetMismatches.forEach(((g,y)=>{const w=u.Ia.get(g);if(!w)return;u.Ia.set(g,w.withResumeToken(Ys.EMPTY_BYTE_STRING,w.snapshotVersion)),O_(u,g);const k=new Wi(w.target,g,y,w.sequenceNumber);hy(u,k)})),u.remoteSyncer.applyRemoteEvent(p)})(s,t)}catch(i){ot(Fo,"Failed to raise snapshot:",i),await Bd(s,i)}}async function Bd(s,e,t){if(!Xl(e))throw e;s.Ea.add(1),await Cu(s),s.Va.set("Offline"),t||(t=()=>M_(s.localStore)),s.asyncQueue.enqueueRetryable((async()=>{ot(Fo,"Retrying IndexedDB access"),await t(),s.Ea.delete(1),await df(s)}))}function B_(s,e){return e().catch((t=>Bd(s,t,e)))}async function ff(s){const e=Qt(s),t=ro(e);let i=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Xg;for(;dI(e);)try{const l=await WA(e.localStore,i);if(l===null){e.Ta.length===0&&t.L_();break}i=l.batchId,fI(e,l)}catch(l){await Bd(e,l)}U_(e)&&z_(e)}function dI(s){return Go(s)&&s.Ta.length<10}function fI(s,e){s.Ta.push(e);const t=ro(s);t.O_()&&t.Y_&&t.ea(e.mutations)}function U_(s){return Go(s)&&!ro(s).x_()&&s.Ta.length>0}function z_(s){ro(s).start()}async function mI(s){ro(s).ra()}async function pI(s){const e=ro(s);for(const t of s.Ta)e.ea(t.mutations)}async function gI(s,e,t){const i=s.Ta.shift(),l=sy.from(i,e,t);await B_(s,(()=>s.remoteSyncer.applySuccessfulWrite(l))),await ff(s)}async function yI(s,e){e&&ro(s).Y_&&await(async function(i,l){if((function(h){return XR(h)&&h!==ke.ABORTED})(l.code)){const u=i.Ta.shift();ro(i).B_(),await B_(i,(()=>i.remoteSyncer.rejectFailedWrite(u.batchId,l))),await ff(i)}})(s,e),U_(s)&&z_(s)}async function zx(s,e){const t=Qt(s);t.asyncQueue.verifyOperationInProgress(),ot(Fo,"RemoteStore received new credentials");const i=Go(t);t.Ea.add(3),await Cu(t),i&&t.Va.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await df(t)}async function bI(s,e){const t=Qt(s);e?(t.Ea.delete(2),await df(t)):e||(t.Ea.add(2),await Cu(t),t.Va.set("Unknown"))}function Zl(s){return s.ma||(s.ma=(function(t,i,l){const u=Qt(t);return u.sa(),new tI(i,u.connection,u.authCredentials,u.appCheckCredentials,u.serializer,l)})(s.datastore,s.asyncQueue,{Zo:lI.bind(null,s),Yo:cI.bind(null,s),t_:uI.bind(null,s),J_:hI.bind(null,s)}),s.Ra.push((async e=>{e?(s.ma.B_(),fy(s)?dy(s):s.Va.set("Unknown")):(await s.ma.stop(),V_(s))}))),s.ma}function ro(s){return s.fa||(s.fa=(function(t,i,l){const u=Qt(t);return u.sa(),new nI(i,u.connection,u.authCredentials,u.appCheckCredentials,u.serializer,l)})(s.datastore,s.asyncQueue,{Zo:()=>Promise.resolve(),Yo:mI.bind(null,s),t_:yI.bind(null,s),ta:pI.bind(null,s),na:gI.bind(null,s)}),s.Ra.push((async e=>{e?(s.fa.B_(),await ff(s)):(await s.fa.stop(),s.Ta.length>0&&(ot(Fo,`Stopping write stream with ${s.Ta.length} pending writes`),s.Ta=[]))}))),s.fa}class my{constructor(e,t,i,l,u){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=l,this.removalCallback=u,this.deferred=new ri,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((h=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,l,u){const h=Date.now()+i,p=new my(e,t,h,l,u);return p.start(i),p}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new nt(ke.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function py(s,e){if(ci("AsyncQueue",`${e}: ${s}`),Xl(s))return new nt(ke.UNAVAILABLE,`${e}: ${s}`);throw s}class Vl{static emptySet(e){return new Vl(e.comparator)}constructor(e){this.comparator=e?(t,i)=>e(t,i)||jt.comparator(t.key,i.key):(t,i)=>jt.comparator(t.key,i.key),this.keyedMap=Kc(),this.sortedSet=new ds(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,i)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Vl)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;t.hasNext();){const l=t.getNext().key,u=i.getNext().key;if(!l.isEqual(u))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const i=new Vl;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=t,i}}class Fx{constructor(){this.ga=new ds(jt.comparator)}track(e){const t=e.doc.key,i=this.ga.get(t);i?e.type!==0&&i.type===3?this.ga=this.ga.insert(t,e):e.type===3&&i.type!==1?this.ga=this.ga.insert(t,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.ga=this.ga.remove(t):e.type===1&&i.type===2?this.ga=this.ga.insert(t,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):Vt(63341,{Vt:e,pa:i}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,i)=>{e.push(i)})),e}}class Hl{constructor(e,t,i,l,u,h,p,g,y){this.query=e,this.docs=t,this.oldDocs=i,this.docChanges=l,this.mutatedKeys=u,this.fromCache=h,this.syncStateChanged=p,this.excludesMetadataChanges=g,this.hasCachedResults=y}static fromInitialDocuments(e,t,i,l,u){const h=[];return t.forEach((p=>{h.push({type:0,doc:p})})),new Hl(e,t,Vl.emptySet(t),h,i,l,!0,!1,u)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&rf(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,i=e.docChanges;if(t.length!==i.length)return!1;for(let l=0;l<t.length;l++)if(t[l].type!==i[l].type||!t[l].doc.isEqual(i[l].doc))return!1;return!0}}class vI{constructor(){this.wa=void 0,this.ba=[]}Sa(){return this.ba.some((e=>e.Da()))}}class xI{constructor(){this.queries=qx(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,i){const l=Qt(t),u=l.queries;l.queries=qx(),u.forEach(((h,p)=>{for(const g of p.ba)g.onError(i)}))})(this,new nt(ke.ABORTED,"Firestore shutting down"))}}function qx(){return new Wo((s=>a_(s)),rf)}async function gy(s,e){const t=Qt(s);let i=3;const l=e.query;let u=t.queries.get(l);u?!u.Sa()&&e.Da()&&(i=2):(u=new vI,i=e.Da()?0:1);try{switch(i){case 0:u.wa=await t.onListen(l,!0);break;case 1:u.wa=await t.onListen(l,!1);break;case 2:await t.onFirstRemoteStoreListen(l)}}catch(h){const p=py(h,`Initialization of query '${Rl(e.query)}' failed`);return void e.onError(p)}t.queries.set(l,u),u.ba.push(e),e.va(t.onlineState),u.wa&&e.Fa(u.wa)&&by(t)}async function yy(s,e){const t=Qt(s),i=e.query;let l=3;const u=t.queries.get(i);if(u){const h=u.ba.indexOf(e);h>=0&&(u.ba.splice(h,1),u.ba.length===0?l=e.Da()?0:1:!u.Sa()&&e.Da()&&(l=2))}switch(l){case 0:return t.queries.delete(i),t.onUnlisten(i,!0);case 1:return t.queries.delete(i),t.onUnlisten(i,!1);case 2:return t.onLastRemoteStoreUnlisten(i);default:return}}function wI(s,e){const t=Qt(s);let i=!1;for(const l of e){const u=l.query,h=t.queries.get(u);if(h){for(const p of h.ba)p.Fa(l)&&(i=!0);h.wa=l}}i&&by(t)}function _I(s,e,t){const i=Qt(s),l=i.queries.get(e);if(l)for(const u of l.ba)u.onError(t);i.queries.delete(e)}function by(s){s.Ca.forEach((e=>{e.next()}))}var wg,Hx;(Hx=wg||(wg={})).Ma="default",Hx.Cache="cache";class vy{constructor(e,t,i){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=i||{}}Fa(e){if(!this.options.includeMetadataChanges){const i=[];for(const l of e.docChanges)l.type!==3&&i.push(l);e=new Hl(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const i=t!=="Offline";return(!this.options.Ka||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=Hl.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==wg.Cache}}class F_{constructor(e){this.key=e}}class q_{constructor(e){this.key=e}}class kI{constructor(e,t){this.query=e,this.Za=t,this.Xa=null,this.hasCachedResults=!1,this.current=!1,this.Ya=pn(),this.mutatedKeys=pn(),this.eu=i_(e),this.tu=new Vl(this.eu)}get nu(){return this.Za}ru(e,t){const i=t?t.iu:new Fx,l=t?t.tu:this.tu;let u=t?t.mutatedKeys:this.mutatedKeys,h=l,p=!1;const g=this.query.limitType==="F"&&l.size===this.query.limit?l.last():null,y=this.query.limitType==="L"&&l.size===this.query.limit?l.first():null;if(e.inorderTraversal(((w,k)=>{const j=l.get(w),O=af(this.query,k)?k:null,$=!!j&&this.mutatedKeys.has(j.key),U=!!O&&(O.hasLocalMutations||this.mutatedKeys.has(O.key)&&O.hasCommittedMutations);let L=!1;j&&O?j.data.isEqual(O.data)?$!==U&&(i.track({type:3,doc:O}),L=!0):this.su(j,O)||(i.track({type:2,doc:O}),L=!0,(g&&this.eu(O,g)>0||y&&this.eu(O,y)<0)&&(p=!0)):!j&&O?(i.track({type:0,doc:O}),L=!0):j&&!O&&(i.track({type:1,doc:j}),L=!0,(g||y)&&(p=!0)),L&&(O?(h=h.add(O),u=U?u.add(w):u.delete(w)):(h=h.delete(w),u=u.delete(w)))})),this.query.limit!==null)for(;h.size>this.query.limit;){const w=this.query.limitType==="F"?h.last():h.first();h=h.delete(w.key),u=u.delete(w.key),i.track({type:1,doc:w})}return{tu:h,iu:i,Ss:p,mutatedKeys:u}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,i,l){const u=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const h=e.iu.ya();h.sort(((w,k)=>(function(O,$){const U=L=>{switch(L){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Vt(20277,{Vt:L})}};return U(O)-U($)})(w.type,k.type)||this.eu(w.doc,k.doc))),this.ou(i),l=l??!1;const p=t&&!l?this._u():[],g=this.Ya.size===0&&this.current&&!l?1:0,y=g!==this.Xa;return this.Xa=g,h.length!==0||y?{snapshot:new Hl(this.query,e.tu,u,h,e.mutatedKeys,g===0,y,!1,!!i&&i.resumeToken.approximateByteSize()>0),au:p}:{au:p}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Fx,mutatedKeys:this.mutatedKeys,Ss:!1},!1)):{au:[]}}uu(e){return!this.Za.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Za=this.Za.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Za=this.Za.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Ya;this.Ya=pn(),this.tu.forEach((i=>{this.uu(i.key)&&(this.Ya=this.Ya.add(i.key))}));const t=[];return e.forEach((i=>{this.Ya.has(i)||t.push(new q_(i))})),this.Ya.forEach((i=>{e.has(i)||t.push(new F_(i))})),t}cu(e){this.Za=e.ks,this.Ya=pn();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return Hl.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Xa===0,this.hasCachedResults)}}const xy="SyncEngine";class TI{constructor(e,t,i){this.query=e,this.targetId=t,this.view=i}}class jI{constructor(e){this.key=e,this.hu=!1}}class EI{constructor(e,t,i,l,u,h){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=l,this.currentUser=u,this.maxConcurrentLimboResolutions=h,this.Pu={},this.Tu=new Wo((p=>a_(p)),rf),this.Iu=new Map,this.Eu=new Set,this.Ru=new ds(jt.comparator),this.Au=new Map,this.Vu=new iy,this.du={},this.mu=new Map,this.fu=ql.ar(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function SI(s,e,t=!0){const i=Y_(s);let l;const u=i.Tu.get(e);return u?(i.sharedClientState.addLocalQueryTarget(u.targetId),l=u.view.lu()):l=await H_(i,e,t,!0),l}async function NI(s,e){const t=Y_(s);await H_(t,e,!0,!1)}async function H_(s,e,t,i){const l=await GA(s.localStore,Ea(e)),u=l.targetId,h=s.sharedClientState.addLocalQueryTarget(u,t);let p;return i&&(p=await CI(s,e,u,h==="current",l.resumeToken)),s.isPrimaryClient&&t&&L_(s.remoteStore,l),p}async function CI(s,e,t,i,l){s.pu=(k,j,O)=>(async function(U,L,ne,Z){let ye=L.view.ru(ne);ye.Ss&&(ye=await Lx(U.localStore,L.query,!1).then((({documents:R})=>L.view.ru(R,ye))));const je=Z&&Z.targetChanges.get(L.targetId),We=Z&&Z.targetMismatches.get(L.targetId)!=null,Be=L.view.applyChanges(ye,U.isPrimaryClient,je,We);return Wx(U,L.targetId,Be.au),Be.snapshot})(s,k,j,O);const u=await Lx(s.localStore,e,!0),h=new kI(e,u.ks),p=h.ru(u.documents),g=Nu.createSynthesizedTargetChangeForCurrentChange(t,i&&s.onlineState!=="Offline",l),y=h.applyChanges(p,s.isPrimaryClient,g);Wx(s,t,y.au);const w=new TI(e,t,h);return s.Tu.set(e,w),s.Iu.has(t)?s.Iu.get(t).push(e):s.Iu.set(t,[e]),y.snapshot}async function RI(s,e,t){const i=Qt(s),l=i.Tu.get(e),u=i.Iu.get(l.targetId);if(u.length>1)return i.Iu.set(l.targetId,u.filter((h=>!rf(h,e)))),void i.Tu.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(l.targetId),i.sharedClientState.isActiveQueryTarget(l.targetId)||await vg(i.localStore,l.targetId,!1).then((()=>{i.sharedClientState.clearQueryState(l.targetId),t&&uy(i.remoteStore,l.targetId),_g(i,l.targetId)})).catch(Ql)):(_g(i,l.targetId),await vg(i.localStore,l.targetId,!0))}async function AI(s,e){const t=Qt(s),i=t.Tu.get(e),l=t.Iu.get(i.targetId);t.isPrimaryClient&&l.length===1&&(t.sharedClientState.removeLocalQueryTarget(i.targetId),uy(t.remoteStore,i.targetId))}async function II(s,e,t){const i=BI(s);try{const l=await(function(h,p){const g=Qt(h),y=vt.now(),w=p.reduce(((O,$)=>O.add($.key)),pn());let k,j;return g.persistence.runTransaction("Locally write mutations","readwrite",(O=>{let $=ui(),U=pn();return g.xs.getEntries(O,w).next((L=>{$=L,$.forEach(((ne,Z)=>{Z.isValidDocument()||(U=U.add(ne))}))})).next((()=>g.localDocuments.getOverlayedDocuments(O,$))).next((L=>{k=L;const ne=[];for(const Z of p){const ye=WR(Z,k.get(Z.key).overlayedDocument);ye!=null&&ne.push(new co(Z.key,ye,Xw(ye.value.mapValue),ur.exists(!0)))}return g.mutationQueue.addMutationBatch(O,y,ne,p)})).next((L=>{j=L;const ne=L.applyToLocalDocumentSet(k,U);return g.documentOverlayCache.saveOverlays(O,L.batchId,ne)}))})).then((()=>({batchId:j.batchId,changes:l_(k)})))})(i.localStore,e);i.sharedClientState.addPendingMutation(l.batchId),(function(h,p,g){let y=h.du[h.currentUser.toKey()];y||(y=new ds(mn)),y=y.insert(p,g),h.du[h.currentUser.toKey()]=y})(i,l.batchId,t),await Ru(i,l.changes),await ff(i.remoteStore)}catch(l){const u=py(l,"Failed to persist write");t.reject(u)}}async function $_(s,e){const t=Qt(s);try{const i=await HA(t.localStore,e);e.targetChanges.forEach(((l,u)=>{const h=t.Au.get(u);h&&(On(l.addedDocuments.size+l.modifiedDocuments.size+l.removedDocuments.size<=1,22616),l.addedDocuments.size>0?h.hu=!0:l.modifiedDocuments.size>0?On(h.hu,14607):l.removedDocuments.size>0&&(On(h.hu,42227),h.hu=!1))})),await Ru(t,i,e)}catch(i){await Ql(i)}}function $x(s,e,t){const i=Qt(s);if(i.isPrimaryClient&&t===0||!i.isPrimaryClient&&t===1){const l=[];i.Tu.forEach(((u,h)=>{const p=h.view.va(e);p.snapshot&&l.push(p.snapshot)})),(function(h,p){const g=Qt(h);g.onlineState=p;let y=!1;g.queries.forEach(((w,k)=>{for(const j of k.ba)j.va(p)&&(y=!0)})),y&&by(g)})(i.eventManager,e),l.length&&i.Pu.J_(l),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function MI(s,e,t){const i=Qt(s);i.sharedClientState.updateQueryState(e,"rejected",t);const l=i.Au.get(e),u=l&&l.key;if(u){let h=new ds(jt.comparator);h=h.insert(u,er.newNoDocument(u,Gt.min()));const p=pn().add(u),g=new uf(Gt.min(),new Map,new ds(mn),h,p);await $_(i,g),i.Ru=i.Ru.remove(u),i.Au.delete(e),wy(i)}else await vg(i.localStore,e,!1).then((()=>_g(i,e,t))).catch(Ql)}async function DI(s,e){const t=Qt(s),i=e.batch.batchId;try{const l=await qA(t.localStore,e);G_(t,i,null),W_(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),await Ru(t,l)}catch(l){await Ql(l)}}async function PI(s,e,t){const i=Qt(s);try{const l=await(function(h,p){const g=Qt(h);return g.persistence.runTransaction("Reject batch","readwrite-primary",(y=>{let w;return g.mutationQueue.lookupMutationBatch(y,p).next((k=>(On(k!==null,37113),w=k.keys(),g.mutationQueue.removeMutationBatch(y,k)))).next((()=>g.mutationQueue.performConsistencyCheck(y))).next((()=>g.documentOverlayCache.removeOverlaysForBatchId(y,w,p))).next((()=>g.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(y,w))).next((()=>g.localDocuments.getDocuments(y,w)))}))})(i.localStore,e);G_(i,e,t),W_(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),await Ru(i,l)}catch(l){await Ql(l)}}function W_(s,e){(s.mu.get(e)||[]).forEach((t=>{t.resolve()})),s.mu.delete(e)}function G_(s,e,t){const i=Qt(s);let l=i.du[i.currentUser.toKey()];if(l){const u=l.get(e);u&&(t?u.reject(t):u.resolve(),l=l.remove(e)),i.du[i.currentUser.toKey()]=l}}function _g(s,e,t=null){s.sharedClientState.removeLocalQueryTarget(e);for(const i of s.Iu.get(e))s.Tu.delete(i),t&&s.Pu.yu(i,t);s.Iu.delete(e),s.isPrimaryClient&&s.Vu.Gr(e).forEach((i=>{s.Vu.containsKey(i)||K_(s,i)}))}function K_(s,e){s.Eu.delete(e.path.canonicalString());const t=s.Ru.get(e);t!==null&&(uy(s.remoteStore,t),s.Ru=s.Ru.remove(e),s.Au.delete(t),wy(s))}function Wx(s,e,t){for(const i of t)i instanceof F_?(s.Vu.addReference(i.key,e),LI(s,i)):i instanceof q_?(ot(xy,"Document no longer in limbo: "+i.key),s.Vu.removeReference(i.key,e),s.Vu.containsKey(i.key)||K_(s,i.key)):Vt(19791,{wu:i})}function LI(s,e){const t=e.key,i=t.path.canonicalString();s.Ru.get(t)||s.Eu.has(i)||(ot(xy,"New document in limbo: "+t),s.Eu.add(i),wy(s))}function wy(s){for(;s.Eu.size>0&&s.Ru.size<s.maxConcurrentLimboResolutions;){const e=s.Eu.values().next().value;s.Eu.delete(e);const t=new jt(es.fromString(e)),i=s.fu.next();s.Au.set(i,new jI(t)),s.Ru=s.Ru.insert(t,i),L_(s.remoteStore,new Wi(Ea(sf(t.path)),i,"TargetPurposeLimboResolution",ef.ce))}}async function Ru(s,e,t){const i=Qt(s),l=[],u=[],h=[];i.Tu.isEmpty()||(i.Tu.forEach(((p,g)=>{h.push(i.pu(g,e,t).then((y=>{if((y||t)&&i.isPrimaryClient){const w=y?!y.fromCache:t?.targetChanges.get(g.targetId)?.current;i.sharedClientState.updateQueryState(g.targetId,w?"current":"not-current")}if(y){l.push(y);const w=ly.Es(g.targetId,y);u.push(w)}})))})),await Promise.all(h),i.Pu.J_(l),await(async function(g,y){const w=Qt(g);try{await w.persistence.runTransaction("notifyLocalViewChanges","readwrite",(k=>Me.forEach(y,(j=>Me.forEach(j.Ts,(O=>w.persistence.referenceDelegate.addReference(k,j.targetId,O))).next((()=>Me.forEach(j.Is,(O=>w.persistence.referenceDelegate.removeReference(k,j.targetId,O)))))))))}catch(k){if(!Xl(k))throw k;ot(cy,"Failed to update sequence numbers: "+k)}for(const k of y){const j=k.targetId;if(!k.fromCache){const O=w.vs.get(j),$=O.snapshotVersion,U=O.withLastLimboFreeSnapshotVersion($);w.vs=w.vs.insert(j,U)}}})(i.localStore,u))}async function OI(s,e){const t=Qt(s);if(!t.currentUser.isEqual(e)){ot(xy,"User change. New user:",e.toKey());const i=await I_(t.localStore,e);t.currentUser=e,(function(u,h){u.mu.forEach((p=>{p.forEach((g=>{g.reject(new nt(ke.CANCELLED,h))}))})),u.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await Ru(t,i.Ns)}}function VI(s,e){const t=Qt(s),i=t.Au.get(e);if(i&&i.hu)return pn().add(i.key);{let l=pn();const u=t.Iu.get(e);if(!u)return l;for(const h of u){const p=t.Tu.get(h);l=l.unionWith(p.view.nu)}return l}}function Y_(s){const e=Qt(s);return e.remoteStore.remoteSyncer.applyRemoteEvent=$_.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=VI.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=MI.bind(null,e),e.Pu.J_=wI.bind(null,e.eventManager),e.Pu.yu=_I.bind(null,e.eventManager),e}function BI(s){const e=Qt(s);return e.remoteStore.remoteSyncer.applySuccessfulWrite=DI.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=PI.bind(null,e),e}class Ud{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=hf(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return FA(this.persistence,new BA,e.initialUser,this.serializer)}Cu(e){return new A_(oy.Vi,this.serializer)}Du(e){return new YA}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Ud.provider={build:()=>new Ud};class UI extends Ud{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){On(this.persistence.referenceDelegate instanceof Vd,46915);const i=this.persistence.referenceDelegate.garbageCollector;return new TA(i,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?vr.withCacheSize(this.cacheSizeBytes):vr.DEFAULT;return new A_((i=>Vd.Vi(i,t)),this.serializer)}}class kg{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>$x(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=OI.bind(null,this.syncEngine),await bI(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new xI})()}createDatastore(e){const t=hf(e.databaseInfo.databaseId),i=eI(e.databaseInfo);return aI(e.authCredentials,e.appCheckCredentials,i,t)}createRemoteStore(e){return(function(i,l,u,h,p){return new oI(i,l,u,h,p)})(this.localStore,this.datastore,e.asyncQueue,(t=>$x(this.syncEngine,t,0)),(function(){return Bx.v()?new Bx:new QA})())}createSyncEngine(e,t){return(function(l,u,h,p,g,y,w){const k=new EI(l,u,h,p,g,y);return w&&(k.gu=!0),k})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const i=Qt(t);ot(Fo,"RemoteStore shutting down."),i.Ea.add(5),await Cu(i),i.Aa.shutdown(),i.Va.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}kg.provider={build:()=>new kg};class _y{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):ci("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}const ao="FirestoreClient";class zI{constructor(e,t,i,l,u){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this._databaseInfo=l,this.user=Zs.UNAUTHENTICATED,this.clientId=Qg.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=u,this.authCredentials.start(i,(async h=>{ot(ao,"Received user=",h.uid),await this.authCredentialListener(h),this.user=h})),this.appCheckCredentials.start(i,(h=>(ot(ao,"Received new app check token=",h),this.appCheckCredentialListener(h,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this._databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new ri;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const i=py(t,"Failed to shutdown persistence");e.reject(i)}})),e.promise}}async function Ip(s,e){s.asyncQueue.verifyOperationInProgress(),ot(ao,"Initializing OfflineComponentProvider");const t=s.configuration;await e.initialize(t);let i=t.initialUser;s.setCredentialChangeListener((async l=>{i.isEqual(l)||(await I_(e.localStore,l),i=l)})),e.persistence.setDatabaseDeletedListener((()=>s.terminate())),s._offlineComponents=e}async function Gx(s,e){s.asyncQueue.verifyOperationInProgress();const t=await FI(s);ot(ao,"Initializing OnlineComponentProvider"),await e.initialize(t,s.configuration),s.setCredentialChangeListener((i=>zx(e.remoteStore,i))),s.setAppCheckTokenChangeListener(((i,l)=>zx(e.remoteStore,l))),s._onlineComponents=e}async function FI(s){if(!s._offlineComponents)if(s._uninitializedComponentsProvider){ot(ao,"Using user provided OfflineComponentProvider");try{await Ip(s,s._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(l){return l.name==="FirebaseError"?l.code===ke.FAILED_PRECONDITION||l.code===ke.UNIMPLEMENTED:!(typeof DOMException<"u"&&l instanceof DOMException)||l.code===22||l.code===20||l.code===11})(t))throw t;Bl("Error using user provided cache. Falling back to memory cache: "+t),await Ip(s,new Ud)}}else ot(ao,"Using default OfflineComponentProvider"),await Ip(s,new UI(void 0));return s._offlineComponents}async function Q_(s){return s._onlineComponents||(s._uninitializedComponentsProvider?(ot(ao,"Using user provided OnlineComponentProvider"),await Gx(s,s._uninitializedComponentsProvider._online)):(ot(ao,"Using default OnlineComponentProvider"),await Gx(s,new kg))),s._onlineComponents}function qI(s){return Q_(s).then((e=>e.syncEngine))}async function zd(s){const e=await Q_(s),t=e.eventManager;return t.onListen=SI.bind(null,e.syncEngine),t.onUnlisten=RI.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=NI.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=AI.bind(null,e.syncEngine),t}function HI(s,e,t,i){const l=new _y(i),u=new vy(e,l,t);return s.asyncQueue.enqueueAndForget((async()=>gy(await zd(s),u))),()=>{l.Nu(),s.asyncQueue.enqueueAndForget((async()=>yy(await zd(s),u)))}}function $I(s,e,t={}){const i=new ri;return s.asyncQueue.enqueueAndForget((async()=>(function(u,h,p,g,y){const w=new _y({next:j=>{w.Nu(),h.enqueueAndForget((()=>yy(u,k)));const O=j.docs.has(p);!O&&j.fromCache?y.reject(new nt(ke.UNAVAILABLE,"Failed to get document because the client is offline.")):O&&j.fromCache&&g&&g.source==="server"?y.reject(new nt(ke.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):y.resolve(j)},error:j=>y.reject(j)}),k=new vy(sf(p.path),w,{includeMetadataChanges:!0,Ka:!0});return gy(u,k)})(await zd(s),s.asyncQueue,e,t,i))),i.promise}function WI(s,e,t={}){const i=new ri;return s.asyncQueue.enqueueAndForget((async()=>(function(u,h,p,g,y){const w=new _y({next:j=>{w.Nu(),h.enqueueAndForget((()=>yy(u,k))),j.fromCache&&g.source==="server"?y.reject(new nt(ke.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):y.resolve(j)},error:j=>y.reject(j)}),k=new vy(p,w,{includeMetadataChanges:!0,Ka:!0});return gy(u,k)})(await zd(s),s.asyncQueue,e,t,i))),i.promise}function GI(s,e){const t=new ri;return s.asyncQueue.enqueueAndForget((async()=>II(await qI(s),e,t))),t.promise}function X_(s){const e={};return s.timeoutSeconds!==void 0&&(e.timeoutSeconds=s.timeoutSeconds),e}const KI="ComponentProvider",Kx=new Map;function YI(s,e,t,i,l){return new pR(s,e,t,l.host,l.ssl,l.experimentalForceLongPolling,l.experimentalAutoDetectLongPolling,X_(l.experimentalLongPollingOptions),l.useFetchStreams,l.isUsingEmulator,i)}const J_="firestore.googleapis.com",Yx=!0;class Qx{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new nt(ke.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=J_,this.ssl=Yx}else this.host=e.host,this.ssl=e.ssl??Yx;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=R_;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<_A)throw new nt(ke.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}sR("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=X_(e.experimentalLongPollingOptions??{}),(function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new nt(ke.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new nt(ke.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new nt(ke.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(i,l){return i.timeoutSeconds===l.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class mf{constructor(e,t,i,l){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=l,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Qx({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new nt(ke.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new nt(ke.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Qx(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(i){if(!i)return new G4;switch(i.type){case"firstParty":return new X4(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new nt(ke.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const i=Kx.get(t);i&&(ot(KI,"Removing Datastore"),Kx.delete(t),i.terminate())})(this),Promise.resolve()}}function QI(s,e,t,i={}){s=cr(s,mf);const l=io(e),u=s._getSettings(),h={...u,emulatorOptions:s._getEmulatorOptions()},p=`${e}:${t}`;l&&(Dg(`https://${p}`),Pg("Firestore",!0)),u.host!==J_&&u.host!==p&&Bl("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const g={...u,host:p,ssl:l,emulatorOptions:i};if(!Oo(g,h)&&(s._setSettings(g),i.mockUserToken)){let y,w;if(typeof i.mockUserToken=="string")y=i.mockUserToken,w=Zs.MOCK_USER;else{y=W2(i.mockUserToken,s._app?.options.projectId);const k=i.mockUserToken.sub||i.mockUserToken.user_id;if(!k)throw new nt(ke.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");w=new Zs(k)}s._authCredentials=new K4(new Bw(y,w))}}class fi{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new fi(this.firestore,e,this._query)}}class gs{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ji(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new gs(this.firestore,e,this._key)}toJSON(){return{type:gs._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,i){if(Eu(t,gs._jsonSchema))return new gs(e,i||null,new jt(es.fromString(t.referencePath)))}}gs._jsonSchemaVersion="firestore/documentReference/1.0",gs._jsonSchema={type:Is("string",gs._jsonSchemaVersion),referencePath:Is("string")};class Ji extends fi{constructor(e,t,i){super(e,t,sf(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new gs(this.firestore,null,new jt(e))}withConverter(e){return new Ji(this.firestore,e,this._path)}}function Wt(s,e,...t){if(s=Qn(s),Uw("collection","path",e),s instanceof mf){const i=es.fromString(e,...t);return cx(i),new Ji(s,null,i)}{if(!(s instanceof gs||s instanceof Ji))throw new nt(ke.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=s._path.child(es.fromString(e,...t));return cx(i),new Ji(s.firestore,null,i)}}function Ke(s,e,...t){if(s=Qn(s),arguments.length===1&&(e=Qg.newId()),Uw("doc","path",e),s instanceof mf){const i=es.fromString(e,...t);return lx(i),new gs(s,null,new jt(i))}{if(!(s instanceof gs||s instanceof Ji))throw new nt(ke.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=s._path.child(es.fromString(e,...t));return lx(i),new gs(s.firestore,s instanceof Ji?s.converter:null,new jt(i))}}const Xx="AsyncQueue";class Jx{constructor(e=Promise.resolve()){this.Yu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new D_(this,"async_queue_retry"),this._c=()=>{const i=Ap();i&&ot(Xx,"Visibility state changed to "+i.visibilityState),this.M_.w_()},this.ac=e;const t=Ap();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=Ap();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new ri;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Yu.push(e),this.lc())))}async lc(){if(this.Yu.length!==0){try{await this.Yu[0](),this.Yu.shift(),this.M_.reset()}catch(e){if(!Xl(e))throw e;ot(Xx,"Operation failed with retryable error: "+e)}this.Yu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((i=>{throw this.nc=i,this.rc=!1,ci("INTERNAL UNHANDLED ERROR: ",Zx(i)),i})).then((i=>(this.rc=!1,i))))));return this.ac=t,t}enqueueAfterDelay(e,t,i){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const l=my.createAndSchedule(this,e,t,i,(u=>this.hc(u)));return this.tc.push(l),l}uc(){this.nc&&Vt(47125,{Pc:Zx(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,i)=>t.targetTimeMs-i.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}Rc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function Zx(s){let e=s.message||"";return s.stack&&(e=s.stack.includes(s.message)?s.stack:s.message+`
`+s.stack),e}class Ra extends mf{constructor(e,t,i,l){super(e,t,i,l),this.type="firestore",this._queue=new Jx,this._persistenceKey=l?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Jx(e),this._firestoreClient=void 0,await e}}}function XI(s,e){const t=typeof s=="object"?s:Bg(),i=typeof s=="string"?s:Md,l=Yd(t,"firestore").getImmediate({identifier:i});if(!l._initialized){const u=q2("firestore");u&&QI(l,...u)}return l}function Au(s){if(s._terminated)throw new nt(ke.FAILED_PRECONDITION,"The client has already been terminated.");return s._firestoreClient||JI(s),s._firestoreClient}function JI(s){const e=s._freezeSettings(),t=YI(s._databaseId,s._app?.options.appId||"",s._persistenceKey,s._app?.options.apiKey,e);s._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(s._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),s._firestoreClient=new zI(s._authCredentials,s._appCheckCredentials,s._queue,t,s._componentsProvider&&(function(l){const u=l?._online.build();return{_offline:l?._offline.build(u),_online:u}})(s._componentsProvider))}class Wr{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Wr(Ys.fromBase64String(e))}catch(t){throw new nt(ke.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Wr(Ys.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Wr._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Eu(e,Wr._jsonSchema))return Wr.fromBase64String(e.bytes)}}Wr._jsonSchemaVersion="firestore/bytes/1.0",Wr._jsonSchema={type:Is("string",Wr._jsonSchemaVersion),bytes:Is("string")};class pf{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new nt(ke.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ks(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Iu{constructor(e){this._methodName=e}}class Na{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new nt(ke.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new nt(ke.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return mn(this._lat,e._lat)||mn(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Na._jsonSchemaVersion}}static fromJSON(e){if(Eu(e,Na._jsonSchema))return new Na(e.latitude,e.longitude)}}Na._jsonSchemaVersion="firestore/geoPoint/1.0",Na._jsonSchema={type:Is("string",Na._jsonSchemaVersion),latitude:Is("number"),longitude:Is("number")};class la{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(i,l){if(i.length!==l.length)return!1;for(let u=0;u<i.length;++u)if(i[u]!==l[u])return!1;return!0})(this._values,e._values)}toJSON(){return{type:la._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Eu(e,la._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new la(e.vectorValues);throw new nt(ke.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}la._jsonSchemaVersion="firestore/vectorValue/1.0",la._jsonSchema={type:Is("string",la._jsonSchemaVersion),vectorValues:Is("object")};const ZI=/^__.*__$/;class e3{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return this.fieldMask!==null?new co(e,this.data,this.fieldMask,t,this.fieldTransforms):new Su(e,this.data,t,this.fieldTransforms)}}class Z_{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return new co(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function ek(s){switch(s){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Vt(40011,{dataSource:s})}}class ky{constructor(e,t,i,l,u,h){this.settings=e,this.databaseId=t,this.serializer=i,this.ignoreUndefinedProperties=l,u===void 0&&this.validatePath(),this.fieldTransforms=u||[],this.fieldMask=h||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(e){return new ky({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(e){const t=this.path?.child(e),i=this.contextWith({path:t,arrayElement:!1});return i.validatePathSegment(e),i}childContextForFieldPath(e){const t=this.path?.child(e),i=this.contextWith({path:t,arrayElement:!1});return i.validatePath(),i}childContextForArray(e){return this.contextWith({path:void 0,arrayElement:!0})}createError(e){return Fd(e,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}validatePath(){if(this.path)for(let e=0;e<this.path.length;e++)this.validatePathSegment(this.path.get(e))}validatePathSegment(e){if(e.length===0)throw this.createError("Document fields must not be empty");if(ek(this.dataSource)&&ZI.test(e))throw this.createError('Document fields cannot begin and end with "__"')}}class t3{constructor(e,t,i){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=i||hf(e)}createContext(e,t,i,l=!1){return new ky({dataSource:e,methodName:t,targetDoc:i,path:Ks.emptyPath(),arrayElement:!1,hasConverter:l},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Mu(s){const e=s._freezeSettings(),t=hf(s._databaseId);return new t3(s._databaseId,!!e.ignoreUndefinedProperties,t)}function Ty(s,e,t,i,l,u={}){const h=s.createContext(u.merge||u.mergeFields?2:0,e,t,l);Sy("Data must be an object, but it was:",h,i);const p=sk(i,h);let g,y;if(u.merge)g=new Dr(h.fieldMask),y=h.fieldTransforms;else if(u.mergeFields){const w=[];for(const k of u.mergeFields){const j=qo(e,k,t);if(!h.contains(j))throw new nt(ke.INVALID_ARGUMENT,`Field '${j}' is specified in your field mask but missing from your input data.`);ik(w,j)||w.push(j)}g=new Dr(w),y=h.fieldTransforms.filter((k=>g.covers(k.field)))}else g=null,y=h.fieldTransforms;return new e3(new xr(p),g,y)}class gf extends Iu{_toFieldTransform(e){if(e.dataSource!==2)throw e.dataSource===1?e.createError(`${this._methodName}() can only appear at the top level of your update data`):e.createError(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof gf}}class jy extends Iu{_toFieldTransform(e){return new g_(e.path,new mu)}isEqual(e){return e instanceof jy}}class Ey extends Iu{constructor(e,t){super(e),this.Vc=t}_toFieldTransform(e){const t=new yu(e.serializer,h_(e.serializer,this.Vc));return new g_(e.path,t)}isEqual(e){return e instanceof Ey&&this.Vc===e.Vc}}function tk(s,e,t,i){const l=s.createContext(1,e,t);Sy("Data must be an object, but it was:",l,i);const u=[],h=xr.empty();lo(i,((g,y)=>{const w=ak(e,g,t);y=Qn(y);const k=l.childContextForFieldPath(w);if(y instanceof gf)u.push(w);else{const j=Du(y,k);j!=null&&(u.push(w),h.set(w,j))}}));const p=new Dr(u);return new Z_(h,p,l.fieldTransforms)}function nk(s,e,t,i,l,u){const h=s.createContext(1,e,t),p=[qo(e,i,t)],g=[l];if(u.length%2!=0)throw new nt(ke.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let j=0;j<u.length;j+=2)p.push(qo(e,u[j])),g.push(u[j+1]);const y=[],w=xr.empty();for(let j=p.length-1;j>=0;--j)if(!ik(y,p[j])){const O=p[j];let $=g[j];$=Qn($);const U=h.childContextForFieldPath(O);if($ instanceof gf)y.push(O);else{const L=Du($,U);L!=null&&(y.push(O),w.set(O,L))}}const k=new Dr(y);return new Z_(w,k,h.fieldTransforms)}function n3(s,e,t,i=!1){return Du(t,s.createContext(i?4:3,e))}function Du(s,e){if(rk(s=Qn(s)))return Sy("Unsupported field value:",e,s),sk(s,e);if(s instanceof Iu)return(function(i,l){if(!ek(l.dataSource))throw l.createError(`${i._methodName}() can only be used with update() and set()`);if(!l.path)throw l.createError(`${i._methodName}() is not currently supported inside arrays`);const u=i._toFieldTransform(l);u&&l.fieldTransforms.push(u)})(s,e),null;if(s===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),s instanceof Array){if(e.settings.arrayElement&&e.dataSource!==4)throw e.createError("Nested arrays are not supported");return(function(i,l){const u=[];let h=0;for(const p of i){let g=Du(p,l.childContextForArray(h));g==null&&(g={nullValue:"NULL_VALUE"}),u.push(g),h++}return{arrayValue:{values:u}}})(s,e)}return(function(i,l){if((i=Qn(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return h_(l.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const u=vt.fromDate(i);return{timestampValue:Od(l.serializer,u)}}if(i instanceof vt){const u=new vt(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:Od(l.serializer,u)}}if(i instanceof Na)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof Wr)return{bytesValue:__(l.serializer,i._byteString)};if(i instanceof gs){const u=l.databaseId,h=i.firestore._databaseId;if(!h.isEqual(u))throw l.createError(`Document reference is for database ${h.projectId}/${h.database} but should be for database ${u.projectId}/${u.database}`);return{referenceValue:ay(i.firestore._databaseId||l.databaseId,i._key.path)}}if(i instanceof la)return(function(h,p){const g=h instanceof la?h.toArray():h;return{mapValue:{fields:{[Yw]:{stringValue:Qw},[Dd]:{arrayValue:{values:g.map((w=>{if(typeof w!="number")throw p.createError("VectorValues must only contain numeric values.");return ny(p.serializer,w)}))}}}}}})(i,l);if(C_(i))return i._toProto(l.serializer);throw l.createError(`Unsupported field value: ${Zd(i)}`)})(s,e)}function sk(s,e){const t={};return qw(s)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):lo(s,((i,l)=>{const u=Du(l,e.childContextForField(i));u!=null&&(t[i]=u)})),{mapValue:{fields:t}}}function rk(s){return!(typeof s!="object"||s===null||s instanceof Array||s instanceof Date||s instanceof vt||s instanceof Na||s instanceof Wr||s instanceof gs||s instanceof Iu||s instanceof la||C_(s))}function Sy(s,e,t){if(!rk(t)||!zw(t)){const i=Zd(t);throw i==="an object"?e.createError(s+" a custom object"):e.createError(s+" "+i)}}function qo(s,e,t){if((e=Qn(e))instanceof pf)return e._internalPath;if(typeof e=="string")return ak(s,e);throw Fd("Field path arguments must be of type string or ",s,!1,void 0,t)}const s3=new RegExp("[~\\*/\\[\\]]");function ak(s,e,t){if(e.search(s3)>=0)throw Fd(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,s,!1,void 0,t);try{return new pf(...e.split("."))._internalPath}catch{throw Fd(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,s,!1,void 0,t)}}function Fd(s,e,t,i,l){const u=i&&!i.isEmpty(),h=l!==void 0;let p=`Function ${e}() called with invalid data`;t&&(p+=" (via `toFirestore()`)"),p+=". ";let g="";return(u||h)&&(g+=" (found",u&&(g+=` in field ${i}`),h&&(g+=` in document ${l}`),g+=")"),new nt(ke.INVALID_ARGUMENT,p+s+g)}function ik(s,e){return s.some((t=>t.isEqual(e)))}class r3{convertValue(e,t="none"){switch(so(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ks(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(no(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Vt(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const i={};return lo(e,((l,u)=>{i[l]=this.convertValue(u,t)})),i}convertVectorValue(e){const t=e.fields?.[Dd].arrayValue?.values?.map((i=>ks(i.doubleValue)));return new la(t)}convertGeoPoint(e){return new Na(ks(e.latitude),ks(e.longitude))}convertArray(e,t){return(e.values||[]).map((i=>this.convertValue(i,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const i=nf(e);return i==null?null:this.convertValue(i,t);case"estimate":return this.convertTimestamp(uu(e));default:return null}}convertTimestamp(e){const t=to(e);return new vt(t.seconds,t.nanos)}convertDocumentKey(e,t){const i=es.fromString(e);On(N_(i),9688,{name:e});const l=new hu(i.get(1),i.get(3)),u=new jt(i.popFirst(5));return l.isEqual(t)||ci(`Document ${u} contains a document reference within a different database (${l.projectId}/${l.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),u}}class Ny extends r3{constructor(e){super(),this.firestore=e}convertBytes(e){return new Wr(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new gs(this.firestore,null,t)}}function Gr(){return new jy("serverTimestamp")}function Io(s){return new Ey("increment",s)}const e2="@firebase/firestore",t2="4.10.0";function n2(s){return(function(t,i){if(typeof t!="object"||t===null)return!1;const l=t;for(const u of i)if(u in l&&typeof l[u]=="function")return!0;return!1})(s,["next","error","complete"])}class ok{constructor(e,t,i,l,u){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=l,this._converter=u}get id(){return this._key.path.lastSegment()}get ref(){return new gs(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new a3(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}_fieldsProto(){return this._document?.data.clone().value.mapValue.fields??void 0}get(e){if(this._document){const t=this._document.data.field(qo("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class a3 extends ok{data(){return super.data()}}function lk(s){if(s.limitType==="L"&&s.explicitOrderBy.length===0)throw new nt(ke.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Cy{}class Ry extends Cy{}function Rn(s,e,...t){let i=[];e instanceof Cy&&i.push(e),i=i.concat(t),(function(u){const h=u.filter((g=>g instanceof Ay)).length,p=u.filter((g=>g instanceof yf)).length;if(h>1||h>0&&p>0)throw new nt(ke.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(i);for(const l of i)s=l._apply(s);return s}class yf extends Ry{constructor(e,t,i){super(),this._field=e,this._op=t,this._value=i,this.type="where"}static _create(e,t,i){return new yf(e,t,i)}_apply(e){const t=this._parse(e);return ck(e._query,t),new fi(e.firestore,e.converter,mg(e._query,t))}_parse(e){const t=Mu(e.firestore);return(function(u,h,p,g,y,w,k){let j;if(y.isKeyField()){if(w==="array-contains"||w==="array-contains-any")throw new nt(ke.INVALID_ARGUMENT,`Invalid Query. You can't perform '${w}' queries on documentId().`);if(w==="in"||w==="not-in"){r2(k,w);const $=[];for(const U of k)$.push(s2(g,u,U));j={arrayValue:{values:$}}}else j=s2(g,u,k)}else w!=="in"&&w!=="not-in"&&w!=="array-contains-any"||r2(k,w),j=n3(p,h,k,w==="in"||w==="not-in");return As.create(y,w,j)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function ln(s,e,t){const i=e,l=qo("where",s);return yf._create(l,i,t)}class Ay extends Cy{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Ay(e,t)}_parse(e){const t=this._queryConstraints.map((i=>i._parse(e))).filter((i=>i.getFilters().length>0));return t.length===1?t[0]:ua.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(l,u){let h=l;const p=u.getFlattenedFilters();for(const g of p)ck(h,g),h=mg(h,g)})(e._query,t),new fi(e.firestore,e.converter,mg(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Iy extends Ry{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new Iy(e,t)}_apply(e){const t=(function(l,u,h){if(l.startAt!==null)throw new nt(ke.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(l.endAt!==null)throw new nt(ke.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new fu(u,h)})(e._query,this._field,this._direction);return new fi(e.firestore,e.converter,MR(e._query,t))}}function qd(s,e="asc"){const t=e,i=qo("orderBy",s);return Iy._create(i,t)}class My extends Ry{constructor(e,t,i){super(),this.type=e,this._limit=t,this._limitType=i}static _create(e,t,i){return new My(e,t,i)}_apply(e){return new fi(e.firestore,e.converter,Ld(e._query,this._limit,this._limitType))}}function Hd(s){return rR("limit",s),My._create("limit",s,"F")}function s2(s,e,t){if(typeof(t=Qn(t))=="string"){if(t==="")throw new nt(ke.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!r_(e)&&t.indexOf("/")!==-1)throw new nt(ke.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const i=e.path.child(es.fromString(t));if(!jt.isDocumentKey(i))throw new nt(ke.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return yx(s,new jt(i))}if(t instanceof gs)return yx(s,t._key);throw new nt(ke.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Zd(t)}.`)}function r2(s,e){if(!Array.isArray(s)||s.length===0)throw new nt(ke.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function ck(s,e){const t=(function(l,u){for(const h of l)for(const p of h.getFlattenedFilters())if(u.indexOf(p.op)>=0)return p.op;return null})(s.filters,(function(l){switch(l){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new nt(ke.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new nt(ke.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}function Dy(s,e,t){let i;return i=s?t&&(t.merge||t.mergeFields)?s.toFirestore(e,t):s.toFirestore(e):e,i}class Qc{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Mo extends ok{constructor(e,t,i,l,u,h){super(e,t,i,l,h),this._firestore=e,this._firestoreImpl=e,this.metadata=u}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new wd(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const i=this._document.data.field(qo("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new nt(ke.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=Mo._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}Mo._jsonSchemaVersion="firestore/documentSnapshot/1.0",Mo._jsonSchema={type:Is("string",Mo._jsonSchemaVersion),bundleSource:Is("string","DocumentSnapshot"),bundleName:Is("string"),bundle:Is("string")};class wd extends Mo{data(e={}){return super.data(e)}}class Do{constructor(e,t,i,l){this._firestore=e,this._userDataWriter=t,this._snapshot=l,this.metadata=new Qc(l.hasPendingWrites,l.fromCache),this.query=i}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((i=>{e.call(t,new wd(this._firestore,this._userDataWriter,i.key,i,new Qc(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new nt(ke.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(l,u){if(l._snapshot.oldDocs.isEmpty()){let h=0;return l._snapshot.docChanges.map((p=>{const g=new wd(l._firestore,l._userDataWriter,p.doc.key,p.doc,new Qc(l._snapshot.mutatedKeys.has(p.doc.key),l._snapshot.fromCache),l.query.converter);return p.doc,{type:"added",doc:g,oldIndex:-1,newIndex:h++}}))}{let h=l._snapshot.oldDocs;return l._snapshot.docChanges.filter((p=>u||p.type!==3)).map((p=>{const g=new wd(l._firestore,l._userDataWriter,p.doc.key,p.doc,new Qc(l._snapshot.mutatedKeys.has(p.doc.key),l._snapshot.fromCache),l.query.converter);let y=-1,w=-1;return p.type!==0&&(y=h.indexOf(p.doc.key),h=h.delete(p.doc.key)),p.type!==1&&(h=h.add(p.doc),w=h.indexOf(p.doc.key)),{type:i3(p.type),doc:g,oldIndex:y,newIndex:w}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new nt(ke.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Do._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Qg.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],i=[],l=[];return this.docs.forEach((u=>{u._document!==null&&(t.push(u._document),i.push(this._userDataWriter.convertObjectMap(u._document.data.value.mapValue.fields,"previous")),l.push(u.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function i3(s){switch(s){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Vt(61501,{type:s})}}Do._jsonSchemaVersion="firestore/querySnapshot/1.0",Do._jsonSchema={type:Is("string",Do._jsonSchemaVersion),bundleSource:Is("string","QuerySnapshot"),bundleName:Is("string"),bundle:Is("string")};class o3{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Mu(e)}set(e,t,i){this._verifyNotCommitted();const l=Mp(e,this._firestore),u=Dy(l.converter,t,i),h=Ty(this._dataReader,"WriteBatch.set",l._key,u,l.converter!==null,i);return this._mutations.push(h.toMutation(l._key,ur.none())),this}update(e,t,i,...l){this._verifyNotCommitted();const u=Mp(e,this._firestore);let h;return h=typeof(t=Qn(t))=="string"||t instanceof pf?nk(this._dataReader,"WriteBatch.update",u._key,t,i,l):tk(this._dataReader,"WriteBatch.update",u._key,t),this._mutations.push(h.toMutation(u._key,ur.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=Mp(e,this._firestore);return this._mutations=this._mutations.concat(new cf(t._key,ur.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new nt(ke.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Mp(s,e){if((s=Qn(s)).firestore!==e)throw new nt(ke.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return s}function Ln(s){s=cr(s,gs);const e=cr(s.firestore,Ra),t=Au(e);return $I(t,s._key).then((i=>uk(e,s,i)))}function Tn(s){s=cr(s,fi);const e=cr(s.firestore,Ra),t=Au(e),i=new Ny(e);return lk(s._query),WI(t,s._query).then((l=>new Do(e,i,s,l)))}function Wn(s,e,t){s=cr(s,gs);const i=cr(s.firestore,Ra),l=Dy(s.converter,e,t),u=Mu(i);return Pu(i,[Ty(u,"setDoc",s._key,l,s.converter!==null,t).toMutation(s._key,ur.none())])}function Hi(s,e,t,...i){s=cr(s,gs);const l=cr(s.firestore,Ra),u=Mu(l);let h;return h=typeof(e=Qn(e))=="string"||e instanceof pf?nk(u,"updateDoc",s._key,e,t,i):tk(u,"updateDoc",s._key,e),Pu(l,[h.toMutation(s._key,ur.exists(!0))])}function or(s){return Pu(cr(s.firestore,Ra),[new cf(s._key,ur.none())])}function ai(s,e){const t=cr(s.firestore,Ra),i=Ke(s),l=Dy(s.converter,e),u=Mu(s.firestore);return Pu(t,[Ty(u,"addDoc",i._key,l,s.converter!==null,{}).toMutation(i._key,ur.exists(!1))]).then((()=>i))}function l3(s,...e){s=Qn(s);let t={includeMetadataChanges:!1,source:"default"},i=0;typeof e[i]!="object"||n2(e[i])||(t=e[i++]);const l={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(n2(e[i])){const y=e[i];e[i]=y.next?.bind(y),e[i+1]=y.error?.bind(y),e[i+2]=y.complete?.bind(y)}let u,h,p;if(s instanceof gs)h=cr(s.firestore,Ra),p=sf(s._key.path),u={next:y=>{e[i]&&e[i](uk(h,s,y))},error:e[i+1],complete:e[i+2]};else{const y=cr(s,fi);h=cr(y.firestore,Ra),p=y._query;const w=new Ny(h);u={next:k=>{e[i]&&e[i](new Do(h,w,y,k))},error:e[i+1],complete:e[i+2]},lk(s._query)}const g=Au(h);return HI(g,p,l,u)}function Pu(s,e){const t=Au(s);return GI(t,e)}function uk(s,e,t){const i=t.docs.get(e._key),l=new Ny(s);return new Mo(s,l,e._key,i,new Qc(t.hasPendingWrites,t.fromCache),e.converter)}function a2(s){return s=cr(s,Ra),Au(s),new o3(s,(e=>Pu(s,e)))}(function(e,t=!0){W4($o),Vo(new Zi("firestore",((i,{instanceIdentifier:l,options:u})=>{const h=i.getProvider("app").getImmediate(),p=new Ra(new Y4(i.getProvider("auth-internal")),new J4(h,i.getProvider("app-check-internal")),gR(h,l),h);return u={useFetchStreams:t,...u},p._setSettings(u),p}),"PUBLIC").setMultipleInstances(!0)),ka(e2,t2,e),ka(e2,t2,"esm2020")})();var c3="firebase",u3="12.8.0";ka(c3,u3,"app");const hk="firebasestorage.googleapis.com",dk="storageBucket",h3=120*1e3,d3=600*1e3;class bs extends Ia{constructor(e,t,i=0){super(Dp(e),`Firebase Storage: ${t} (${Dp(e)})`),this.status_=i,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,bs.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Dp(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var ys;(function(s){s.UNKNOWN="unknown",s.OBJECT_NOT_FOUND="object-not-found",s.BUCKET_NOT_FOUND="bucket-not-found",s.PROJECT_NOT_FOUND="project-not-found",s.QUOTA_EXCEEDED="quota-exceeded",s.UNAUTHENTICATED="unauthenticated",s.UNAUTHORIZED="unauthorized",s.UNAUTHORIZED_APP="unauthorized-app",s.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",s.INVALID_CHECKSUM="invalid-checksum",s.CANCELED="canceled",s.INVALID_EVENT_NAME="invalid-event-name",s.INVALID_URL="invalid-url",s.INVALID_DEFAULT_BUCKET="invalid-default-bucket",s.NO_DEFAULT_BUCKET="no-default-bucket",s.CANNOT_SLICE_BLOB="cannot-slice-blob",s.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",s.NO_DOWNLOAD_URL="no-download-url",s.INVALID_ARGUMENT="invalid-argument",s.INVALID_ARGUMENT_COUNT="invalid-argument-count",s.APP_DELETED="app-deleted",s.INVALID_ROOT_OPERATION="invalid-root-operation",s.INVALID_FORMAT="invalid-format",s.INTERNAL_ERROR="internal-error",s.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(ys||(ys={}));function Dp(s){return"storage/"+s}function Py(){const s="An unknown error occurred, please check the error payload for server response.";return new bs(ys.UNKNOWN,s)}function f3(s){return new bs(ys.OBJECT_NOT_FOUND,"Object '"+s+"' does not exist.")}function m3(s){return new bs(ys.QUOTA_EXCEEDED,"Quota for bucket '"+s+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function p3(){const s="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new bs(ys.UNAUTHENTICATED,s)}function g3(){return new bs(ys.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function y3(s){return new bs(ys.UNAUTHORIZED,"User does not have permission to access '"+s+"'.")}function b3(){return new bs(ys.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function v3(){return new bs(ys.CANCELED,"User canceled the upload/download.")}function x3(s){return new bs(ys.INVALID_URL,"Invalid URL '"+s+"'.")}function w3(s){return new bs(ys.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+s+"'.")}function _3(){return new bs(ys.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+dk+"' property when initializing the app?")}function k3(){return new bs(ys.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function T3(){return new bs(ys.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function j3(s){return new bs(ys.UNSUPPORTED_ENVIRONMENT,`${s} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function Tg(s){return new bs(ys.INVALID_ARGUMENT,s)}function fk(){return new bs(ys.APP_DELETED,"The Firebase app was deleted.")}function E3(s){return new bs(ys.INVALID_ROOT_OPERATION,"The operation '"+s+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function su(s,e){return new bs(ys.INVALID_FORMAT,"String does not match format '"+s+"': "+e)}function zc(s){throw new bs(ys.INTERNAL_ERROR,"Internal error: "+s)}class lr{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let i;try{i=lr.makeFromUrl(e,t)}catch{return new lr(e,"")}if(i.path==="")return i;throw w3(e)}static makeFromUrl(e,t){let i=null;const l="([A-Za-z0-9.\\-_]+)";function u(je){je.path.charAt(je.path.length-1)==="/"&&(je.path_=je.path_.slice(0,-1))}const h="(/(.*))?$",p=new RegExp("^gs://"+l+h,"i"),g={bucket:1,path:3};function y(je){je.path_=decodeURIComponent(je.path)}const w="v[A-Za-z0-9_]+",k=t.replace(/[.]/g,"\\."),j="(/([^?#]*).*)?$",O=new RegExp(`^https?://${k}/${w}/b/${l}/o${j}`,"i"),$={bucket:1,path:3},U=t===hk?"(?:storage.googleapis.com|storage.cloud.google.com)":t,L="([^?#]*)",ne=new RegExp(`^https?://${U}/${l}/${L}`,"i"),ye=[{regex:p,indices:g,postModify:u},{regex:O,indices:$,postModify:y},{regex:ne,indices:{bucket:1,path:2},postModify:y}];for(let je=0;je<ye.length;je++){const We=ye[je],Be=We.regex.exec(e);if(Be){const R=Be[We.indices.bucket];let S=Be[We.indices.path];S||(S=""),i=new lr(R,S),We.postModify(i);break}}if(i==null)throw x3(e);return i}}class S3{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function N3(s,e,t){let i=1,l=null,u=null,h=!1,p=0;function g(){return p===2}let y=!1;function w(...L){y||(y=!0,e.apply(null,L))}function k(L){l=setTimeout(()=>{l=null,s(O,g())},L)}function j(){u&&clearTimeout(u)}function O(L,...ne){if(y){j();return}if(L){j(),w.call(null,L,...ne);return}if(g()||h){j(),w.call(null,L,...ne);return}i<64&&(i*=2);let ye;p===1?(p=2,ye=0):ye=(i+Math.random())*1e3,k(ye)}let $=!1;function U(L){$||($=!0,j(),!y&&(l!==null?(L||(p=2),clearTimeout(l),k(0)):L||(p=1)))}return k(0),u=setTimeout(()=>{h=!0,U(!0)},t),U}function C3(s){s(!1)}function R3(s){return s!==void 0}function A3(s){return typeof s=="object"&&!Array.isArray(s)}function Ly(s){return typeof s=="string"||s instanceof String}function i2(s){return Oy()&&s instanceof Blob}function Oy(){return typeof Blob<"u"}function jg(s,e,t,i){if(i<e)throw Tg(`Invalid value for '${s}'. Expected ${e} or greater.`);if(i>t)throw Tg(`Invalid value for '${s}'. Expected ${t} or less.`)}function bf(s,e,t){let i=e;return t==null&&(i=`https://${e}`),`${t}://${i}/v0${s}`}function mk(s){const e=encodeURIComponent;let t="?";for(const i in s)if(s.hasOwnProperty(i)){const l=e(i)+"="+e(s[i]);t=t+l+"&"}return t=t.slice(0,-1),t}var Po;(function(s){s[s.NO_ERROR=0]="NO_ERROR",s[s.NETWORK_ERROR=1]="NETWORK_ERROR",s[s.ABORT=2]="ABORT"})(Po||(Po={}));function I3(s,e){const t=s>=500&&s<600,l=[408,429].indexOf(s)!==-1,u=e.indexOf(s)!==-1;return t||l||u}class M3{constructor(e,t,i,l,u,h,p,g,y,w,k,j=!0,O=!1){this.url_=e,this.method_=t,this.headers_=i,this.body_=l,this.successCodes_=u,this.additionalRetryCodes_=h,this.callback_=p,this.errorCallback_=g,this.timeout_=y,this.progressCallback_=w,this.connectionFactory_=k,this.retry=j,this.isUsingEmulator=O,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise(($,U)=>{this.resolve_=$,this.reject_=U,this.start_()})}start_(){const e=(i,l)=>{if(l){i(!1,new nd(!1,null,!0));return}const u=this.connectionFactory_();this.pendingConnection_=u;const h=p=>{const g=p.loaded,y=p.lengthComputable?p.total:-1;this.progressCallback_!==null&&this.progressCallback_(g,y)};this.progressCallback_!==null&&u.addUploadProgressListener(h),u.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&u.removeUploadProgressListener(h),this.pendingConnection_=null;const p=u.getErrorCode()===Po.NO_ERROR,g=u.getStatus();if(!p||I3(g,this.additionalRetryCodes_)&&this.retry){const w=u.getErrorCode()===Po.ABORT;i(!1,new nd(!1,null,w));return}const y=this.successCodes_.indexOf(g)!==-1;i(!0,new nd(y,u))})},t=(i,l)=>{const u=this.resolve_,h=this.reject_,p=l.connection;if(l.wasSuccessCode)try{const g=this.callback_(p,p.getResponse());R3(g)?u(g):u()}catch(g){h(g)}else if(p!==null){const g=Py();g.serverResponse=p.getErrorText(),this.errorCallback_?h(this.errorCallback_(p,g)):h(g)}else if(l.canceled){const g=this.appDelete_?fk():v3();h(g)}else{const g=b3();h(g)}};this.canceled_?t(!1,new nd(!1,null,!0)):this.backoffId_=N3(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&C3(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class nd{constructor(e,t,i){this.wasSuccessCode=e,this.connection=t,this.canceled=!!i}}function D3(s,e){e!==null&&e.length>0&&(s.Authorization="Firebase "+e)}function P3(s,e){s["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function L3(s,e){e&&(s["X-Firebase-GMPID"]=e)}function O3(s,e){e!==null&&(s["X-Firebase-AppCheck"]=e)}function V3(s,e,t,i,l,u,h=!0,p=!1){const g=mk(s.urlParams),y=s.url+g,w=Object.assign({},s.headers);return L3(w,e),D3(w,t),P3(w,u),O3(w,i),new M3(y,s.method,w,s.body,s.successCodes,s.additionalRetryCodes,s.handler,s.errorHandler,s.timeout,s.progressCallback,l,h,p)}function B3(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function U3(...s){const e=B3();if(e!==void 0){const t=new e;for(let i=0;i<s.length;i++)t.append(s[i]);return t.getBlob()}else{if(Oy())return new Blob(s);throw new bs(ys.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function z3(s,e,t){return s.webkitSlice?s.webkitSlice(e,t):s.mozSlice?s.mozSlice(e,t):s.slice?s.slice(e,t):null}function F3(s){if(typeof atob>"u")throw j3("base-64");return atob(s)}const _a={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class Pp{constructor(e,t){this.data=e,this.contentType=t||null}}function q3(s,e){switch(s){case _a.RAW:return new Pp(pk(e));case _a.BASE64:case _a.BASE64URL:return new Pp(gk(s,e));case _a.DATA_URL:return new Pp($3(e),W3(e))}throw Py()}function pk(s){const e=[];for(let t=0;t<s.length;t++){let i=s.charCodeAt(t);if(i<=127)e.push(i);else if(i<=2047)e.push(192|i>>6,128|i&63);else if((i&64512)===55296)if(!(t<s.length-1&&(s.charCodeAt(t+1)&64512)===56320))e.push(239,191,189);else{const u=i,h=s.charCodeAt(++t);i=65536|(u&1023)<<10|h&1023,e.push(240|i>>18,128|i>>12&63,128|i>>6&63,128|i&63)}else(i&64512)===56320?e.push(239,191,189):e.push(224|i>>12,128|i>>6&63,128|i&63)}return new Uint8Array(e)}function H3(s){let e;try{e=decodeURIComponent(s)}catch{throw su(_a.DATA_URL,"Malformed data URL.")}return pk(e)}function gk(s,e){switch(s){case _a.BASE64:{const l=e.indexOf("-")!==-1,u=e.indexOf("_")!==-1;if(l||u)throw su(s,"Invalid character '"+(l?"-":"_")+"' found: is it base64url encoded?");break}case _a.BASE64URL:{const l=e.indexOf("+")!==-1,u=e.indexOf("/")!==-1;if(l||u)throw su(s,"Invalid character '"+(l?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let t;try{t=F3(e)}catch(l){throw l.message.includes("polyfill")?l:su(s,"Invalid character found")}const i=new Uint8Array(t.length);for(let l=0;l<t.length;l++)i[l]=t.charCodeAt(l);return i}class yk{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(t===null)throw su(_a.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const i=t[1]||null;i!=null&&(this.base64=G3(i,";base64"),this.contentType=this.base64?i.substring(0,i.length-7):i),this.rest=e.substring(e.indexOf(",")+1)}}function $3(s){const e=new yk(s);return e.base64?gk(_a.BASE64,e.rest):H3(e.rest)}function W3(s){return new yk(s).contentType}function G3(s,e){return s.length>=e.length?s.substring(s.length-e.length)===e:!1}class $i{constructor(e,t){let i=0,l="";i2(e)?(this.data_=e,i=e.size,l=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),i=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),i=e.length),this.size_=i,this.type_=l}size(){return this.size_}type(){return this.type_}slice(e,t){if(i2(this.data_)){const i=this.data_,l=z3(i,e,t);return l===null?null:new $i(l)}else{const i=new Uint8Array(this.data_.buffer,e,t-e);return new $i(i,!0)}}static getBlob(...e){if(Oy()){const t=e.map(i=>i instanceof $i?i.data_:i);return new $i(U3.apply(null,t))}else{const t=e.map(h=>Ly(h)?q3(_a.RAW,h).data:h.data_);let i=0;t.forEach(h=>{i+=h.byteLength});const l=new Uint8Array(i);let u=0;return t.forEach(h=>{for(let p=0;p<h.length;p++)l[u++]=h[p]}),new $i(l,!0)}}uploadData(){return this.data_}}function Vy(s){let e;try{e=JSON.parse(s)}catch{return null}return A3(e)?e:null}function K3(s){if(s.length===0)return null;const e=s.lastIndexOf("/");return e===-1?"":s.slice(0,e)}function Y3(s,e){const t=e.split("/").filter(i=>i.length>0).join("/");return s.length===0?t:s+"/"+t}function bk(s){const e=s.lastIndexOf("/",s.length-2);return e===-1?s:s.slice(e+1)}function Q3(s,e){return e}class ir{constructor(e,t,i,l){this.server=e,this.local=t||e,this.writable=!!i,this.xform=l||Q3}}let sd=null;function X3(s){return!Ly(s)||s.length<2?s:bk(s)}function vk(){if(sd)return sd;const s=[];s.push(new ir("bucket")),s.push(new ir("generation")),s.push(new ir("metageneration")),s.push(new ir("name","fullPath",!0));function e(u,h){return X3(h)}const t=new ir("name");t.xform=e,s.push(t);function i(u,h){return h!==void 0?Number(h):h}const l=new ir("size");return l.xform=i,s.push(l),s.push(new ir("timeCreated")),s.push(new ir("updated")),s.push(new ir("md5Hash",null,!0)),s.push(new ir("cacheControl",null,!0)),s.push(new ir("contentDisposition",null,!0)),s.push(new ir("contentEncoding",null,!0)),s.push(new ir("contentLanguage",null,!0)),s.push(new ir("contentType",null,!0)),s.push(new ir("metadata","customMetadata",!0)),sd=s,sd}function J3(s,e){function t(){const i=s.bucket,l=s.fullPath,u=new lr(i,l);return e._makeStorageReference(u)}Object.defineProperty(s,"ref",{get:t})}function Z3(s,e,t){const i={};i.type="file";const l=t.length;for(let u=0;u<l;u++){const h=t[u];i[h.local]=h.xform(i,e[h.server])}return J3(i,s),i}function xk(s,e,t){const i=Vy(e);return i===null?null:Z3(s,i,t)}function eM(s,e,t,i){const l=Vy(e);if(l===null||!Ly(l.downloadTokens))return null;const u=l.downloadTokens;if(u.length===0)return null;const h=encodeURIComponent;return u.split(",").map(y=>{const w=s.bucket,k=s.fullPath,j="/b/"+h(w)+"/o/"+h(k),O=bf(j,t,i),$=mk({alt:"media",token:y});return O+$})[0]}function tM(s,e){const t={},i=e.length;for(let l=0;l<i;l++){const u=e[l];u.writable&&(t[u.server]=s[u.local])}return JSON.stringify(t)}const o2="prefixes",l2="items";function nM(s,e,t){const i={prefixes:[],items:[],nextPageToken:t.nextPageToken};if(t[o2])for(const l of t[o2]){const u=l.replace(/\/$/,""),h=s._makeStorageReference(new lr(e,u));i.prefixes.push(h)}if(t[l2])for(const l of t[l2]){const u=s._makeStorageReference(new lr(e,l.name));i.items.push(u)}return i}function sM(s,e,t){const i=Vy(t);return i===null?null:nM(s,e,i)}class By{constructor(e,t,i,l){this.url=e,this.method=t,this.handler=i,this.timeout=l,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function Uy(s){if(!s)throw Py()}function rM(s,e){function t(i,l){const u=xk(s,l,e);return Uy(u!==null),u}return t}function aM(s,e){function t(i,l){const u=sM(s,e,l);return Uy(u!==null),u}return t}function iM(s,e){function t(i,l){const u=xk(s,l,e);return Uy(u!==null),eM(u,l,s.host,s._protocol)}return t}function zy(s){function e(t,i){let l;return t.getStatus()===401?t.getErrorText().includes("Firebase App Check token is invalid")?l=g3():l=p3():t.getStatus()===402?l=m3(s.bucket):t.getStatus()===403?l=y3(s.path):l=i,l.status=t.getStatus(),l.serverResponse=i.serverResponse,l}return e}function oM(s){const e=zy(s);function t(i,l){let u=e(i,l);return i.getStatus()===404&&(u=f3(s.path)),u.serverResponse=l.serverResponse,u}return t}function lM(s,e,t,i,l){const u={};e.isRoot?u.prefix="":u.prefix=e.path+"/",t.length>0&&(u.delimiter=t),i&&(u.pageToken=i),l&&(u.maxResults=l);const h=e.bucketOnlyServerUrl(),p=bf(h,s.host,s._protocol),g="GET",y=s.maxOperationRetryTime,w=new By(p,g,aM(s,e.bucket),y);return w.urlParams=u,w.errorHandler=zy(e),w}function cM(s,e,t){const i=e.fullServerUrl(),l=bf(i,s.host,s._protocol),u="GET",h=s.maxOperationRetryTime,p=new By(l,u,iM(s,t),h);return p.errorHandler=oM(e),p}function uM(s,e){return s&&s.contentType||e&&e.type()||"application/octet-stream"}function hM(s,e,t){const i=Object.assign({},t);return i.fullPath=s.path,i.size=e.size(),i.contentType||(i.contentType=uM(null,e)),i}function dM(s,e,t,i,l){const u=e.bucketOnlyServerUrl(),h={"X-Goog-Upload-Protocol":"multipart"};function p(){let ye="";for(let je=0;je<2;je++)ye=ye+Math.random().toString().slice(2);return ye}const g=p();h["Content-Type"]="multipart/related; boundary="+g;const y=hM(e,i,l),w=tM(y,t),k="--"+g+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+w+`\r
--`+g+`\r
Content-Type: `+y.contentType+`\r
\r
`,j=`\r
--`+g+"--",O=$i.getBlob(k,i,j);if(O===null)throw k3();const $={name:y.fullPath},U=bf(u,s.host,s._protocol),L="POST",ne=s.maxUploadRetryTime,Z=new By(U,L,rM(s,t),ne);return Z.urlParams=$,Z.headers=h,Z.body=O.uploadData(),Z.errorHandler=zy(e),Z}class fM{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Po.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Po.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Po.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,i,l,u){if(this.sent_)throw zc("cannot .send() more than once");if(io(e)&&i&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(t,e,!0),u!==void 0)for(const h in u)u.hasOwnProperty(h)&&this.xhr_.setRequestHeader(h,u[h].toString());return l!==void 0?this.xhr_.send(l):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw zc("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw zc("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw zc("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw zc("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class mM extends fM{initXhr(){this.xhr_.responseType="text"}}function Fy(){return new mM}class Ho{constructor(e,t){this._service=e,t instanceof lr?this._location=t:this._location=lr.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new Ho(e,t)}get root(){const e=new lr(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return bk(this._location.path)}get storage(){return this._service}get parent(){const e=K3(this._location.path);if(e===null)return null;const t=new lr(this._location.bucket,e);return new Ho(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw E3(e)}}function pM(s,e,t){s._throwIfRoot("uploadBytes");const i=dM(s.storage,s._location,vk(),new $i(e,!0),t);return s.storage.makeRequestWithTokens(i,Fy).then(l=>({metadata:l,ref:s}))}function gM(s){const e={prefixes:[],items:[]};return wk(s,e).then(()=>e)}async function wk(s,e,t){const l=await yM(s,{pageToken:t});e.prefixes.push(...l.prefixes),e.items.push(...l.items),l.nextPageToken!=null&&await wk(s,e,l.nextPageToken)}function yM(s,e){e!=null&&typeof e.maxResults=="number"&&jg("options.maxResults",1,1e3,e.maxResults);const t=e||{},i=lM(s.storage,s._location,"/",t.pageToken,t.maxResults);return s.storage.makeRequestWithTokens(i,Fy)}function bM(s){s._throwIfRoot("getDownloadURL");const e=cM(s.storage,s._location,vk());return s.storage.makeRequestWithTokens(e,Fy).then(t=>{if(t===null)throw T3();return t})}function vM(s,e){const t=Y3(s._location.path,e),i=new lr(s._location.bucket,t);return new Ho(s.storage,i)}function xM(s){return/^[A-Za-z]+:\/\//.test(s)}function wM(s,e){return new Ho(s,e)}function _k(s,e){if(s instanceof qy){const t=s;if(t._bucket==null)throw _3();const i=new Ho(t,t._bucket);return e!=null?_k(i,e):i}else return e!==void 0?vM(s,e):s}function _M(s,e){if(e&&xM(e)){if(s instanceof qy)return wM(s,e);throw Tg("To use ref(service, url), the first argument must be a Storage instance.")}else return _k(s,e)}function c2(s,e){const t=e?.[dk];return t==null?null:lr.makeFromBucketSpec(t,s)}function kM(s,e,t,i={}){s.host=`${e}:${t}`;const l=io(e);l&&(Dg(`https://${s.host}/b`),Pg("Storage",!0)),s._isUsingEmulator=!0,s._protocol=l?"https":"http";const{mockUserToken:u}=i;u&&(s._overrideAuthToken=typeof u=="string"?u:W2(u,s.app.options.projectId))}class qy{constructor(e,t,i,l,u,h=!1){this.app=e,this._authProvider=t,this._appCheckProvider=i,this._url=l,this._firebaseVersion=u,this._isUsingEmulator=h,this._bucket=null,this._host=hk,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=h3,this._maxUploadRetryTime=d3,this._requests=new Set,l!=null?this._bucket=lr.makeFromBucketSpec(l,this._host):this._bucket=c2(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=lr.makeFromBucketSpec(this._url,e):this._bucket=c2(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){jg("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){jg("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(Mr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Ho(this,e)}_makeRequest(e,t,i,l,u=!0){if(this._deleted)return new S3(fk());{const h=V3(e,this._appId,i,l,t,this._firebaseVersion,u,this._isUsingEmulator);return this._requests.add(h),h.getPromise().then(()=>this._requests.delete(h),()=>this._requests.delete(h)),h}}async makeRequestWithTokens(e,t){const[i,l]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,i,l).getPromise()}}const u2="@firebase/storage",h2="0.14.0";const kk="storage";function Lp(s,e,t){return s=Qn(s),pM(s,e,t)}function d2(s){return s=Qn(s),gM(s)}function Lo(s){return s=Qn(s),bM(s)}function Gi(s,e){return s=Qn(s),_M(s,e)}function TM(s=Bg(),e){s=Qn(s);const i=Yd(s,kk).getImmediate({identifier:e}),l=q2("storage");return l&&jM(i,...l),i}function jM(s,e,t,i={}){kM(s,e,t,i)}function EM(s,{instanceIdentifier:e}){const t=s.getProvider("app").getImmediate(),i=s.getProvider("auth-internal"),l=s.getProvider("app-check-internal");return new qy(t,i,l,e,$o)}function SM(){Vo(new Zi(kk,EM,"PUBLIC").setMultipleInstances(!0)),ka(u2,h2,""),ka(u2,h2,"esm2020")}SM();const Tk={apiKey:"AIzaSyBCIgMJd3By7qkWH27YiW9VooIBGE3bFLs",authDomain:"mind-core-fitness-client.firebaseapp.com",projectId:"mind-core-fitness-client",storageBucket:"mind-core-fitness-client.firebasestorage.app",messagingSenderId:"669343392406",appId:"1:669343392406:web:f5a35ee062387e7d6f58b7"},Hy=Vg(Tk),Fc=Aw(Hy),ve=XI(Hy),Ki=TM(Hy),NM=Vg(Tk,"secondary"),a6=Aw(NM),CM="EYdciKDOi3UYBLk1u8hHams5tmO2",jk=x.createContext();function Qr(){return x.useContext(jk)}function RM({children:s}){const[e,t]=x.useState(null),[i,l]=x.useState(!1),[u,h]=x.useState(!1),[p,g]=x.useState(null),[y,w]=x.useState(!0);x.useEffect(()=>DC(Fc,async ne=>{if(t(ne),ne)if(ne.uid===CM)l(!0),h(!1),g(null);else{l(!1);try{const Z=Rn(Wt(ve,"clients"),ln("uid","==",ne.uid)),ye=await Tn(Z);if(ye.empty)h(!1),g(null);else{const je=ye.docs[0];h(!0),g({id:je.id,...je.data()})}}catch(Z){console.error("Error fetching client data:",Z),h(!1),g(null)}}else l(!1),h(!1),g(null);w(!1)}),[]);const U={currentUser:e,isAdmin:i,isClient:u,clientData:p,updateClientData:L=>{g(ne=>ne&&{...ne,...L})},login:async(L,ne,Z=!0)=>(await AC(Fc,Z?kw:Wg),await RC(Fc,L,ne)),logout:()=>PC(Fc),resetPassword:L=>CC(Fc,L),loading:y};return a.jsx(jk.Provider,{value:U,children:s})}const Ek=x.createContext();function Ma(){return x.useContext(Ek)}function AM({children:s}){const[e,t]=x.useState(()=>{const g=localStorage.getItem("theme");return g?g==="dark":window.matchMedia("(prefers-color-scheme: dark)").matches}),[i,l]=x.useState(()=>localStorage.getItem("accent")||"red");x.useEffect(()=>{document.documentElement.setAttribute("data-theme",e?"dark":"light"),localStorage.setItem("theme",e?"dark":"light")},[e]),x.useEffect(()=>{localStorage.setItem("accent",i)},[i]);const p={isDark:e,toggleTheme:()=>{document.documentElement.setAttribute("data-theme-transitioning",""),t(!e),setTimeout(()=>{document.documentElement.removeAttribute("data-theme-transitioning")},350)},accent:i,setAccent:g=>l(g)};return a.jsx(Ek.Provider,{value:p,children:s})}function IM(){const[s,e]=x.useState(""),[t,i]=x.useState(""),[l,u]=x.useState(!0),[h,p]=x.useState(""),[g,y]=x.useState(!1),[w,k]=x.useState(!1),[j,O]=x.useState(!1),{login:$,resetPassword:U,currentUser:L,isAdmin:ne,isClient:Z,clientData:ye,loading:je}=Qr(),We=nr();if(x.useEffect(()=>{if(!je&&L){if(ne)We("/dashboard");else if(Z){const S=ye?.clientType;We(S==="core_buddy"?"/client/core-buddy":S==="circuit_vip"||S==="circuit_dropin"?"/client/circuit":"/client")}}},[je,L,ne,Z,ye,We]),je)return null;const Be=async S=>{S.preventDefault(),p(""),y(!0);try{await $(s,t,l)}catch(I){p(I.message||"Failed to log in"),y(!1)}},R=async S=>{if(S.preventDefault(),p(""),!s.trim()){p("Please enter your email address");return}y(!0);try{await U(s.trim()),O(!0)}catch(I){I.code==="auth/user-not-found"?p("No account found with this email"):p(I.message||"Failed to send reset email")}y(!1)};return a.jsx("div",{className:"login-container",children:a.jsxs("div",{className:"login-card",children:[a.jsxs("div",{className:"login-header",children:[a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"login-logo"}),a.jsx("p",{children:w?"Reset Password":"Client Portal"})]}),h&&a.jsx("div",{className:"error-message",children:h}),j?a.jsxs("div",{className:"reset-sent",children:[a.jsx("div",{className:"reset-sent-icon",children:a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M22 2L11 13",strokeLinecap:"round",strokeLinejoin:"round"}),a.jsx("path",{d:"M22 2L15 22L11 13L2 9L22 2Z",strokeLinecap:"round",strokeLinejoin:"round"})]})}),a.jsx("p",{children:"Reset email sent!"}),a.jsx("span",{children:"Check your inbox for a password reset link"}),a.jsx("button",{className:"login-btn",style:{marginTop:"20px"},onClick:()=>{k(!1),O(!1),p("")},children:"Back to Log In"})]}):w?a.jsxs("form",{onSubmit:R,children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"email",children:"Email"}),a.jsx("input",{type:"email",id:"email",value:s,onChange:S=>e(S.target.value),placeholder:"Enter your email",required:!0})]}),a.jsx("button",{type:"submit",className:"login-btn",disabled:g,children:g?"Sending...":"Send Reset Link"}),a.jsx("button",{type:"button",className:"forgot-link",onClick:()=>{k(!1),p("")},children:"Back to Log In"})]}):a.jsxs(a.Fragment,{children:[a.jsxs("form",{onSubmit:Be,children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"email",children:"Email"}),a.jsx("input",{type:"email",id:"email",value:s,onChange:S=>e(S.target.value),required:!0})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"password",children:"Password"}),a.jsx("input",{type:"password",id:"password",value:t,onChange:S=>i(S.target.value),required:!0})]}),a.jsx("div",{className:"remember-me",children:a.jsxs("label",{children:[a.jsx("input",{type:"checkbox",checked:l,onChange:S=>u(S.target.checked)}),a.jsx("span",{children:"Remember me"})]})}),a.jsx("button",{type:"submit",className:"login-btn",disabled:g,children:g?"Logging in...":"Log In"})]}),a.jsx("button",{type:"button",className:"forgot-link",onClick:()=>{k(!0),p("")},children:"Forgot password?"})]}),a.jsx("a",{href:"/",className:"back-link",children:"Back to website"})]})})}function Aa({active:s}){const e=nr(),{clientData:t}=Qr(),i=t?.clientType==="block"&&t?.coreBuddyAccess;return a.jsxs("nav",{className:"block-bottom-nav",children:[a.jsxs("button",{className:`block-nav-tab${s==="home"?" active":""}`,onClick:()=>e("/client/core-buddy"),children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"12",cy:"7",r:"4"})]}),a.jsx("span",{children:"Profile"})]}),a.jsxs("button",{className:`block-nav-tab${s==="workouts"?" active":""}`,onClick:()=>e("/client/core-buddy/workouts"),children:[a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"currentColor",stroke:"none",children:a.jsx("path",{d:"M1 9h2v6H1V9zm3-2h2v10H4V7zm3 4h10v2H7v-2zm10-4h2v10h-2V7zm3 2h2v6h-2V9z"})}),a.jsx("span",{children:"Workouts"})]}),a.jsxs("button",{className:`block-nav-tab${s==="nutrition"?" active":""}`,onClick:()=>e("/client/core-buddy/nutrition"),children:[a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M18 8h1a4 4 0 0 1 0 8h-1M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z"})}),a.jsx("span",{children:"Nutrition"})]}),a.jsxs("button",{className:`block-nav-tab${s==="buddies"?" active":""}`,onClick:()=>e("/client/core-buddy/buddies"),children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"9",cy:"7",r:"4"}),a.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),a.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),a.jsx("span",{children:"Buddies"})]}),i&&a.jsxs("button",{className:"block-nav-tab",onClick:()=>e("/client"),children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"3",width:"7",height:"7"}),a.jsx("rect",{x:"14",y:"3",width:"7",height:"7"}),a.jsx("rect",{x:"14",y:"14",width:"7",height:"7"}),a.jsx("rect",{x:"3",y:"14",width:"7",height:"7"})]}),a.jsx("span",{children:"Block"})]})]})}function Lu(s,e,t,i,l){const u=[];for(let h=0;h<s;h++){const p=(h*(360/s)-90)*(Math.PI/180);u.push({x1:e+i*Math.cos(p),y1:t+i*Math.sin(p),x2:e+l*Math.cos(p),y2:t+l*Math.sin(p),thick:h%5===0})}return u}const $y=Lu(60,100,100,85,96),ru=Lu(60,100,100,78,94),MM=Lu(60,100,100,82,94);Lu(60,50,50,38,46);const DM=Lu(60,40,40,30,37),PM="/login/assets/first_workout-B8SFkzJX.PNG",LM="/login/assets/workouts_10-Z5R3u0xH.PNG",OM="/login/assets/workouts_25-CzxSlcAj.PNG",VM="/login/assets/workouts_50-BpzWup3V.PNG",BM="/login/assets/workouts_100-D7_r6tn1.PNG",UM="/login/assets/streak_2-CsRr-XA9.PNG",zM="/login/assets/streak_4-BHO09tbw.PNG",FM="/login/assets/streak_8-DX2UWMko.PNG",qM="/login/assets/first_pb-aVf_CNWy.PNG",HM="/login/assets/pbs_5-Cippawgg.PNG",$M="/login/assets/pbs_10-CZgGh9Kv.PNG",WM="/login/assets/pbs_100-C67b1wfS.PNG",GM="/login/assets/nutrition_7-CHVV11fj.PNG",KM="/login/assets/leaderboard_join-BLoId4Hz.PNG",YM="/login/assets/habits_7-Dvki70KO.PNG",$d=[{id:"first_workout",img:PM,name:"First Rep",desc:"Complete your first workout",category:"workouts",threshold:1},{id:"workouts_10",img:LM,name:"On Fire",desc:"Complete 10 workouts",category:"workouts",threshold:10},{id:"workouts_25",img:OM,name:"Dedicated",desc:"Complete 25 workouts",category:"workouts",threshold:25},{id:"workouts_50",img:VM,name:"Unstoppable",desc:"Complete 50 workouts",category:"workouts",threshold:50},{id:"workouts_100",img:BM,name:"Century",desc:"Complete 100 workouts",category:"workouts",threshold:100},{id:"streak_2",img:UM,name:"2 Week Streak",desc:"Work out for 2 weeks in a row",category:"streaks",threshold:2},{id:"streak_4",img:zM,name:"Month Strong",desc:"Work out for 4 weeks in a row",category:"streaks",threshold:4},{id:"streak_8",img:FM,name:"Iron Will",desc:"Work out for 8 weeks in a row",category:"streaks",threshold:8},{id:"first_pb",img:qM,name:"First PB",desc:"Set your first personal best",category:"pbs",threshold:1},{id:"pbs_5",img:HM,name:"PB Hunter",desc:"Set 5 personal bests",category:"pbs",threshold:5},{id:"pbs_10",img:$M,name:"PB Machine",desc:"Set 10 personal bests",category:"pbs",threshold:10},{id:"pbs_100",img:WM,name:"PB Legend",desc:"Set 100 personal bests",category:"pbs",threshold:100},{id:"nutrition_7",img:GM,name:"Macro Master",desc:"Hit your macro targets 7 days in a row",category:"nutrition",threshold:7},{id:"leaderboard_join",img:KM,name:"Competitor",desc:"Join the leaderboard",category:"leaderboard",threshold:1},{id:"habits_7",img:YM,name:"Habit Streak",desc:"Complete your daily habits 7 days in a row",category:"habits",threshold:7}],Op=[10,25,50,100,200,500,1e3],Vi=5;function jl(s){return s.toISOString().split("T")[0]}function QM(s){let e=0;for(const t of Op){if(s<t)return{prev:e,next:t};e=t}return{prev:Op[Op.length-1],next:s+100}}const XM={fullbody_4wk:{duration:4,daysPerWeek:3},fullbody_8wk:{duration:8,daysPerWeek:3},fullbody_12wk:{duration:12,daysPerWeek:3},core_4wk:{duration:4,daysPerWeek:3},core_8wk:{duration:8,daysPerWeek:3},core_12wk:{duration:12,daysPerWeek:3},upper_4wk:{duration:4,daysPerWeek:3},lower_4wk:{duration:4,daysPerWeek:3}},JM={fullbody_4wk:["Push Focus","Pull Focus","Legs & Core"],fullbody_8wk:["Strength","Power","Endurance"],fullbody_12wk:["Upper Push","Lower Body","Upper Pull"],core_4wk:["Abs","Stability","Power Core"],core_8wk:["Anti-Extension","Rotation","Power"],core_12wk:["Strength","Endurance","Power"],upper_4wk:["Push","Pull","Mixed"],lower_4wk:["Quad Dominant","Hamstring & Glute","Power & Stability"]},Vp=[{text:"You have 24 hours a day...",bold:"make it count"},{text:"Discipline beats motivation...",bold:"every single time"},{text:"Rest when you're done,",bold:"not when you're tired"},{text:"Small daily gains...",bold:"create massive results"},{text:"Your body keeps score,",bold:"train it well"},{text:"Consistency over intensity...",bold:"always wins"},{text:"The only bad workout...",bold:"is the one you skipped"}];function Bp(s){if(!s)return"";const e=s instanceof Date?s:s.toDate?s.toDate():new Date(s),t=Math.floor((new Date-e)/1e3);return t<60?"just now":t<3600?`${Math.floor(t/60)}m ago`:t<86400?`${Math.floor(t/3600)}h ago`:t<604800?`${Math.floor(t/86400)}d ago`:e.toLocaleDateString("en-GB",{day:"numeric",month:"short"})}function qc(s){if(!s)return"?";const e=s.trim().split(/\s+/);return e.length===1?e[0][0].toUpperCase():(e[0][0]+e[e.length-1][0]).toUpperCase()}function ZM(s,e=800){return new Promise(t=>{const i=new Image;i.onload=()=>{const l=document.createElement("canvas");let u=i.width,h=i.height;u>h?u>e&&(h=Math.round(h*e/u),u=e):h>e&&(u=Math.round(u*e/h),h=e),l.width=u,l.height=h,l.getContext("2d").drawImage(i,0,0,u,h),l.toBlob(p=>t(p),"image/jpeg",.8)},i.src=URL.createObjectURL(s)})}function eD(){const{currentUser:s,isClient:e,clientData:t,logout:i,updateClientData:l,loading:u}=Qr(),{isDark:h,toggleTheme:p}=Ma(),g=nr(),[y,w]=x.useState({hours:0,minutes:0,seconds:0}),[k,j]=x.useState(0),[O,$]=x.useState(0),[U,L]=x.useState(""),[ne,Z]=x.useState(0),[ye,je]=x.useState(0),[We,Be]=x.useState(!1),[R,S]=x.useState({protein:0,carbs:0,fats:0,calories:0}),[I,V]=x.useState(null),[P,F]=x.useState(0),[M,He]=x.useState(null),[xt,z]=x.useState(!1),[fe,Ie]=x.useState(!1),[Ge,J]=x.useState(0),[D,W]=x.useState(0),[be,Ne]=x.useState([]),[qe,Ae]=x.useState([]),[rt,pt]=x.useState(null),[Ze,Ht]=x.useState(!1),cn=x.useRef(null),[Nt,Ct]=x.useState([]),[le,gn]=x.useState(null),[$t,St]=x.useState(0),[Bt,ht]=x.useState(0),[et,en]=x.useState(0),[rs,Lt]=x.useState(0),[Et,Pn]=x.useState(null),Ft=x.useCallback((A,ee="info")=>{Pn({message:A,type:ee}),setTimeout(()=>Pn(null),4e3)},[]),[En,Kt]=x.useState([]),[Sn,me]=x.useState(!1),[Se,Fe]=x.useState(""),[Qe,Ue]=x.useState(null),[De,Oe]=x.useState(null),[wt,ft]=x.useState(!1),[Q,Ee]=x.useState(new Set),[Xe,Je]=x.useState(new Set),[dt,qt]=x.useState({}),[Rt,tn]=x.useState({}),[Vn,An]=x.useState({}),[sn,yn]=x.useState({}),[In,un]=x.useState({}),[as,H]=x.useState({}),pe=x.useRef(null),_e=x.useRef(null),xe=x.useRef({}),[ge,at]=x.useState([]),[At,ct]=x.useState(!1),_t=x.useRef(null),[bt,bn]=x.useState([]),[sr,Ts]=x.useState(""),[Os,Bn]=x.useState(!1),[q,ce]=x.useState(null),[T,C]=x.useState([]),[Y,se]=x.useState(null);x.useEffect(()=>{!u&&!s&&g("/")},[u,s,g]),x.useEffect(()=>{if(t)try{const A=sessionStorage.getItem(`cbDash_${t.id}`);if(A){const ee=JSON.parse(A);$(ee.programmePct??0),L(ee.programmeName??""),Z(ee.totalWorkouts??0),je(ee.habitWeekPct??0),S(ee.nutritionTotals??{protein:0,carbs:0,fats:0,calories:0}),V(ee.nutritionTargetData??null),F(ee.todayHabitsCount??0),He(ee.nextSession??null),z(ee.hasProgramme??!1),Ie(ee.programmeComplete??!1),J(ee.weeklyWorkouts??0),W(ee.pbCount??0),Ne(ee.topPBs??[]),Ae(ee.leaderboardTop3??[]),Ct(ee.unlockedBadges??[]),St(ee.streakWeeks??0),Be(!0)}}catch{}},[t]),x.useEffect(()=>{t?.photoURL&&pt(t.photoURL)},[t]),x.useEffect(()=>{if(!t)return;const A=Rn(Wt(ve,"notifications"),ln("toId","==",t.id)),ee=l3(A,Pe=>{const tt=Pe.docs.map(mt=>({id:mt.id,...mt.data()}));tt.sort((mt,Dt)=>{const st=mt.createdAt?.toMillis?.()||0;return(Dt.createdAt?.toMillis?.()||0)-st}),at(tt.slice(0,50))},Pe=>{console.error("Notification listener error:",Pe),Pe.code==="permission-denied"&&console.warn("Firestore rules may be missing for the notifications collection. Please update your Firestore rules in the Firebase Console.")});return()=>ee()},[t]),x.useEffect(()=>{const A=ee=>{_t.current&&!_t.current.contains(ee.target)&&ct(!1)};return document.addEventListener("mousedown",A),()=>document.removeEventListener("mousedown",A)},[]),x.useEffect(()=>{if(!t)return;const A=t.id;(async()=>{try{const[ee,Pe,tt]=await Promise.all([Tn(Rn(Wt(ve,"buddies"),ln("user1","==",A))),Tn(Rn(Wt(ve,"buddies"),ln("user2","==",A))),Tn(Wt(ve,"clients"))]),mt=new Set;[...ee.docs,...Pe.docs].forEach(st=>{const zt=st.data();mt.add(zt.user1===A?zt.user2:zt.user1)});const Dt={};tt.docs.forEach(st=>{Dt[st.id]=st.data()}),bn(Array.from(mt).filter(st=>Dt[st]).map(st=>({id:st,name:Dt[st].name,photoURL:Dt[st].photoURL||null})))}catch(ee){console.error("Error loading buddies for mentions:",ee)}})()},[t]);const $e=ge.filter(A=>!A.read).length,ze=async()=>{const A=ge.filter(Pe=>!Pe.read);if(!A.length)return;const ee=a2(ve);A.forEach(Pe=>ee.update(Ke(ve,"notifications",Pe.id),{read:!0})),await ee.commit()},Ve=async()=>{if(!ge.length)return;const A=a2(ve);ge.forEach(ee=>A.delete(Ke(ve,"notifications",ee.id))),await A.commit()},Ut=async(A,ee,Pe={})=>{if(!(!t||A===t.id))try{await ai(Wt(ve,"notifications"),{toId:A,fromId:t.id,fromName:t.name||"Someone",fromPhotoURL:t.photoURL||null,type:ee,read:!1,createdAt:Gr(),...Pe})}catch(tt){console.error("Notification create error:",tt),tt.code==="permission-denied"&&Ft("Notifications blocked  check Firestore rules","error")}},kt=(A,ee)=>{const Pe=ee==="compose"?pe.current?.selectionStart:null,mt=(Pe!=null?A.slice(0,Pe):A).match(/@(\w*)$/);if(mt){Bn(!0),ce(ee),Ts(mt[1].toLowerCase());const Dt=bt.filter(st=>st.name&&st.name.toLowerCase().includes(mt[1].toLowerCase())).slice(0,5);C(Dt)}else Bn(!1),C([])},G=(A,ee)=>{if(ee==="compose"){const Pe=pe.current,tt=Se,mt=Pe?.selectionStart??tt.length,Dt=tt.slice(0,mt),st=tt.slice(mt),zt=Dt.replace(/@\w*$/,`@${A.name} `);Fe(zt+st),setTimeout(()=>{Pe?.focus(),Pe.selectionStart=Pe.selectionEnd=zt.length},0)}else{const tt=(Rt[ee]||"").replace(/@\w*$/,`@${A.name} `);tn(mt=>({...mt,[ee]:tt}))}Bn(!1),C([])},he=A=>A&&A.split(/(@\w[\w\s]*?\s)/g).map((Pe,tt)=>Pe.startsWith("@")&&bt.some(mt=>Pe.trim()===`@${mt.name}`)?a.jsx("span",{className:"mention-highlight",children:Pe.trim()},tt):Pe),ie=async A=>{const ee=A.target.files?.[0];if(!(!ee||!t)){if(!ee.type.startsWith("image/")){Ft("Please select an image file","error");return}if(ee.size>5*1024*1024){Ft("Image must be under 5MB","error");return}Ht(!0);try{const Pe=await new Promise(Dt=>{const st=new Image;st.onload=()=>{const zt=document.createElement("canvas"),Pt=400;let Xt=st.width,_n=st.height;Xt>_n?(_n=_n/Xt*Pt,Xt=Pt):(Xt=Xt/_n*Pt,_n=Pt),zt.width=Xt,zt.height=_n,zt.getContext("2d").drawImage(st,0,0,Xt,_n),zt.toBlob(gt=>Dt(gt),"image/jpeg",.75)},st.src=URL.createObjectURL(ee)}),tt=Gi(Ki,`profilePhotos/${t.id}`);await Lp(tt,Pe);const mt=await Lo(tt);await Hi(Ke(ve,"clients",t.id),{photoURL:mt}),pt(mt),l({photoURL:mt}),Ft("Profile photo updated!","success")}catch(Pe){console.error("Photo upload error:",Pe),Ft("Failed to upload photo","error")}Ht(!1),cn.current&&(cn.current.value="")}};x.useEffect(()=>{const A=()=>{const Pe=new Date,tt=new Date(Pe);tt.setHours(23,59,59,999);const mt=tt-Pe,Dt=Math.floor(mt/(1e3*60*60)),st=Math.floor(mt%(1e3*60*60)/(1e3*60)),zt=Math.floor(mt%(1e3*60)/1e3);w({hours:Dt,minutes:st,seconds:zt}),j(60-zt)};A();const ee=setInterval(A,1e3);return()=>clearInterval(ee)},[]),x.useEffect(()=>{const A=setInterval(()=>{Lt(ee=>(ee+1)%Vp.length)},8e3);return()=>clearInterval(A)},[]),x.useEffect(()=>{if(!s||!t)return;(async()=>{let ee=null,Pe=0,tt=[],mt=!1,Dt=null;try{const st=jl(new Date),zt=await Ln(Ke(ve,"clientProgrammes",t.id));if(zt.exists()){const Bs=zt.data(),Ds=XM[Bs.templateId];if(z(!0),Ds){const dr=Bs.completedSessions||{},Fs=Object.keys(dr).length,Pa=Ds.duration*Ds.daysPerWeek;$(Pa>0?Math.round(Fs/Pa*100):0);const uo=Bs.templateId.replace(/_/g," ").replace(/\b\w/g,Jr=>Jr.toUpperCase());L(uo);const La=JM[Bs.templateId];let Oa=!1;for(let Jr=1;Jr<=Ds.duration&&!Oa;Jr++)for(let fr=0;fr<Ds.daysPerWeek&&!Oa;fr++)dr[`w${Jr}d${fr}`]||(He({week:Jr,dayIdx:fr,label:La?.[fr]||`Day ${fr+1}`}),Oa=!0);Oa||(Ie(!0),mt=!0)}}const Pt=Wt(ve,"workoutLogs"),Xt=Rn(Pt,ln("clientId","==",t.id));ee=await Tn(Xt);const _n=ee.docs.filter(Bs=>Bs.data().type!=="programme").length;Z(_n);const gt=new Date,cs=gt.getDay(),Xn=cs===0?6:cs-1,Kn=new Date(gt);Kn.setDate(gt.getDate()-Xn),Kn.setHours(0,0,0,0);const fs=jl(Kn),Jn=ee.docs.filter(Bs=>(Bs.data().date||"")>=fs).length;J(Jn);const us=Wt(ve,"habitLogs"),js=Rn(us,ln("clientId","==",t.id),ln("date","==",st)),Zn=await Tn(js);let vs=0;if(!Zn.empty){const Bs=Zn.docs[0].data().habits||{};vs=Object.values(Bs).filter(Boolean).length}je(Math.round(vs/Vi*100)),F(vs);const Qs=await Ln(Ke(ve,"nutritionTargets",t.id));Qs.exists()&&(V(Qs.data()),Dt=Qs.data());const jr=await Ln(Ke(ve,"nutritionLogs",`${t.id}_${st}`));if(jr.exists()){const Ds=(jr.data().entries||[]).reduce((dr,Fs)=>({protein:dr.protein+(Fs.protein||0),carbs:dr.carbs+(Fs.carbs||0),fats:dr.fats+(Fs.fats||0),calories:dr.calories+(Fs.calories||0)}),{protein:0,carbs:0,fats:0,calories:0});S(Ds)}}catch(st){console.error("Error loading dashboard stats:",st)}try{let st=[];const zt=await Ln(Ke(ve,"coreBuddyPBs",t.id));if(zt.exists()){const Pt=zt.data().exercises||{};W(Object.keys(Pt).length),Pe=Object.keys(Pt).length,st=Object.entries(Pt).sort(([,Xt],[,_n])=>(_n.weight||0)-(Xt.weight||0)).slice(0,3).map(([Xt,_n])=>({name:Xt,weight:_n.weight,reps:_n.reps}))}if(st.length===0){const Pt={chestPress:"Chest Press",shoulderPress:"Shoulder Press",seatedRow:"Seated Row",latPulldown:"Lat Pulldown",squat:"Squat",deadlift:"Deadlift"},Xt=Rn(Wt(ve,"personalBests"),ln("clientId","==",t.id)),_n=await Tn(Xt);if(!_n.empty){const gt={};_n.docs.forEach(Xn=>{const Kn=Xn.data().benchmarks||{};Object.entries(Kn).forEach(([fs,Jn])=>{if(!Jn.weight||!Pt[fs])return;const us=(Jn.weight||0)*(Jn.reps||1);(!gt[fs]||us>(gt[fs].weight||0)*(gt[fs].reps||1))&&(gt[fs]={name:Pt[fs],weight:Jn.weight,reps:Jn.reps})})});const cs=Object.values(gt);W(cs.length),Pe=cs.length,st=cs.sort((Xn,Kn)=>(Kn.weight||0)-(Xn.weight||0)).slice(0,3)}}tt=st,Ne(st)}catch(st){console.error("PB fetch error:",st)}try{const st=Wt(ve,"clients"),zt=Rn(st,ln("leaderboardOptIn","==",!0)),Xt=(await Tn(zt)).docs.map(_n=>({id:_n.id,name:_n.data().name,photoURL:_n.data().photoURL||null}));Ae(Xt.slice(0,3))}catch(st){console.error("Leaderboard preview error:",st)}try{let st=0;if(ee){const Xn=ee.docs.map(Kn=>Kn.data().date).filter(Boolean).sort().reverse();if(Xn.length>0){const Kn=new Date;let fs=new Date(Kn);e:for(let Jn=0;Jn<52;Jn++){const us=new Date(fs),js=us.getDay(),Zn=js===0?6:js-1;us.setDate(us.getDate()-Zn),us.setHours(0,0,0,0);const vs=new Date(us);vs.setDate(vs.getDate()+7);const Qs=jl(us),jr=jl(vs);if(Xn.some(Ds=>Ds>=Qs&&Ds<jr))st++;else{if(Jn>0)break e;break}fs.setDate(fs.getDate()-7)}}}St(st);let zt=0;for(let Xn=0;Xn<30;Xn++){const Kn=new Date;Kn.setDate(Kn.getDate()-Xn);const fs=jl(Kn);try{const Jn=await Tn(Rn(Wt(ve,"habitLogs"),ln("clientId","==",t.id),ln("date","==",fs)));if(Jn.empty)break;{const us=Jn.docs[0].data().habits||{};if(Object.values(us).filter(Boolean).length>=Vi)zt++;else break}}catch{break}}ht(zt);let Pt=0;for(let Xn=0;Xn<30;Xn++){const Kn=new Date;Kn.setDate(Kn.getDate()-Xn);const fs=jl(Kn);try{const Jn=await Ln(Ke(ve,"nutritionLogs",`${t.id}_${fs}`));if(Jn.exists()&&(Jn.data().entries||[]).length>0)if(Dt){const js=(Jn.data().entries||[]).reduce((Zn,vs)=>({protein:Zn.protein+(vs.protein||0),carbs:Zn.carbs+(vs.carbs||0),fats:Zn.fats+(vs.fats||0)}),{protein:0,carbs:0,fats:0});if(js.protein>=(Dt.protein||0)&&js.carbs>=(Dt.carbs||0)&&js.fats>=(Dt.fats||0))Pt++;else break}else Pt++;else break}catch{break}}en(Pt);const Xt=ee?ee.docs.length:0,_n=[],gt=Xn=>_n.push(Xn);Xt>=1&&gt("first_workout"),Xt>=10&&gt("workouts_10"),Xt>=25&&gt("workouts_25"),Xt>=50&&gt("workouts_50"),Xt>=100&&gt("workouts_100"),st>=2&&gt("streak_2"),st>=4&&gt("streak_4"),st>=8&&gt("streak_8"),Pe>=1&&gt("first_pb"),Pe>=5&&gt("pbs_5"),Pe>=10&&gt("pbs_10"),Pe>=100&&gt("pbs_100"),Pt>=7&&gt("nutrition_7"),t.leaderboardOptIn&&gt("leaderboard_join"),zt>=7&&gt("habits_7"),Ct(_n);const cs={};_n.forEach(Xn=>{cs[Xn]={unlockedAt:new Date().toISOString()}}),Wn(Ke(ve,"achievements",t.id),{badges:cs,progress:{streakWeeks:st,pbCount:Pe,nutritionStreak:Pt,habitStreak:zt},updatedAt:new Date().toISOString()},{merge:!0}).catch(()=>{})}catch(st){console.error("Achievement computation error:",st)}Be(!0)})()},[s,t]),x.useEffect(()=>{if(!(!We||!t))try{sessionStorage.setItem(`cbDash_${t.id}`,JSON.stringify({programmePct:O,programmeName:U,totalWorkouts:ne,habitWeekPct:ye,nutritionTotals:R,nutritionTargetData:I,todayHabitsCount:P,nextSession:M,hasProgramme:xt,programmeComplete:fe,weeklyWorkouts:Ge,pbCount:D,topPBs:be,leaderboardTop3:qe,unlockedBadges:Nt,streakWeeks:$t}))}catch{}},[We,O,U,ne,ye,R,I,P,M,xt,fe,Ge,D,be,qe,Nt,$t,t]);const Ce=A=>{const ee=A.currentTarget,Pe=ee.querySelector(".ripple");Pe&&Pe.remove();const tt=ee.getBoundingClientRect(),mt=Math.max(tt.width,tt.height),Dt=A.clientX-tt.left-mt/2,st=A.clientY-tt.top-mt/2,zt=document.createElement("span");zt.className="ripple",zt.style.cssText=`width:${mt}px;height:${mt}px;left:${Dt}px;top:${st}px;`,ee.appendChild(zt),setTimeout(()=>zt.remove(),600)},Le=t?.name?.split(" ")[0]||"there",{prev:it,next:It}=QM(ne),lt=It>it?Math.round((ne-it)/(It-it)*100):100,rn=[{label:"Programme",value:`${O}%`,pct:O,color:"#14b8a6",size:"normal"},{label:"Workouts",value:`${ne}`,pct:lt,color:"var(--color-primary)",size:"large"},{label:"Habits Today",value:`${ye}%`,pct:ye,color:"#38B6FF",size:"normal"}],Un=A=>!I||!I[A]?0:Math.min(Math.round(R[A]/I[A]*100),100),vn=(()=>{const A=new Date().getHours();return We&&P>=Vi&&R.calories>0?{main:"Smashed it today,",sub:"Rest up and go again tomorrow."}:A>=5&&A<12?{main:"Rise and grind,",sub:"let's get after it!"}:A>=12&&A<17?{main:"Oye",sub:"crack on and make it count!"}:A>=17&&A<21?{main:"Evening session?",sub:"Let's finish strong!"}:{main:"Burning the midnight oil,",sub:"Respect the hustle!"}})(),xn=We?xt&&M&&!fe?{label:"NEXT SESSION",message:`Week ${M.week}, Day ${M.dayIdx+1}  ${M.label}`,cta:"Continue",action:()=>g("/client/core-buddy/programmes"),pct:O,ringLabel:`${O}%`}:P<Vi?{label:"DAILY HABITS",message:`${P}/${Vi} completed`,cta:"Open Habits",action:()=>g("/client/core-buddy/consistency"),pct:ye,ringLabel:`${P}/${Vi}`}:R.calories===0?{label:"NUTRITION",message:"No meals logged today",cta:"Log Meal",action:()=>g("/client/core-buddy/nutrition"),pct:0,ringLabel:"0"}:xt?fe?{label:"COMPLETE",message:"Programme finished!",cta:"New Programme",action:()=>g("/client/core-buddy/workouts"),pct:100,ringLabel:"100%"}:{label:"TODAY",message:"You're crushing it!",cta:null,action:null,pct:100,ringLabel:""}:{label:"PROGRAMMES",message:"Start a programme to level up",cta:"Browse",action:()=>g("/client/core-buddy/workouts"),pct:0,ringLabel:""}:null,wr=x.useCallback(async()=>{if(t){me(!0);try{const A=await Tn(Rn(Wt(ve,"posts"),ln("authorId","==",t.id),qd("createdAt","desc"),Hd(30)));Kt(A.docs.map(Pe=>({id:Pe.id,...Pe.data()})));const ee=await Tn(Rn(Wt(ve,"postLikes"),ln("userId","==",t.id)));Ee(new Set(ee.docs.map(Pe=>Pe.data().postId)))}catch(A){console.error("Error loading journey:",A)}finally{me(!1)}}},[t]);x.useEffect(()=>{We&&t&&wr()},[We,t,wr]);const Da=A=>{const ee=A.target.files?.[0];if(ee){if(!ee.type.startsWith("image/")){Ft("Please select an image file","error");return}if(ee.size>10*1024*1024){Ft("Image must be under 10MB","error");return}Ue(ee),Oe(URL.createObjectURL(ee))}},Xr=()=>{Ue(null),De&&URL.revokeObjectURL(De),Oe(null),_e.current&&(_e.current.value="")},_r=async()=>{if(!(!Se.trim()&&!Qe||wt||!t)){ft(!0);try{let A=null;if(Qe){const tt=await ZM(Qe),mt=`${Date.now()}_${Math.random().toString(36).slice(2,8)}`,Dt=Gi(Ki,`postImages/${t.id}/${mt}`);await Lp(Dt,tt),A=await Lo(Dt)}await ai(Wt(ve,"posts"),{authorId:t.id,authorName:t.name||"Unknown",authorPhotoURL:t.photoURL||null,content:Se.trim(),type:A?"image":"text",imageURL:A||null,createdAt:Gr(),likeCount:0,commentCount:0});const Pe=Se.trim().match(/@[\w\s]+?(?=\s@|\s*$|[.,!?])/g);if(Pe){const tt=new Set;Pe.forEach(mt=>{const Dt=mt.slice(1).trim(),st=bt.find(zt=>zt.name&&zt.name.toLowerCase()===Dt.toLowerCase());st&&!tt.has(st.id)&&(tt.add(st.id),Ut(st.id,"mention",{}))})}Fe(""),Xr(),pe.current&&(pe.current.style.height="auto"),await wr(),Ft("Posted!","success")}catch(A){console.error("Error posting:",A),Ft(A?.message||"Failed to post","error")}finally{ft(!1)}}},wn=async A=>{if(window.confirm("Delete this post?"))try{await or(Ke(ve,"posts",A)),Kt(ee=>ee.filter(Pe=>Pe.id!==A)),Ft("Post deleted","info")}catch(ee){console.error("Delete error:",ee),Ft("Failed to delete","error")}},ts=async A=>{if(!t)return;const ee=t.id,Pe=`${A}_${ee}`,tt=Q.has(A),mt=new Set(Q);tt?mt.delete(A):mt.add(A),Ee(mt),Kt(Dt=>Dt.map(st=>st.id===A?{...st,likeCount:Math.max(0,(st.likeCount||0)+(tt?-1:1))}:st));try{if(tt)await or(Ke(ve,"postLikes",Pe)),await Hi(Ke(ve,"posts",A),{likeCount:Io(-1)});else{await Wn(Ke(ve,"postLikes",Pe),{postId:A,userId:ee,createdAt:Gr()}),await Hi(Ke(ve,"posts",A),{likeCount:Io(1)});const Dt=En.find(st=>st.id===A);Dt&&Ut(Dt.authorId,"like",{postId:A})}}catch(Dt){console.error("Like error:",Dt),wr()}},Gn=async A=>{try{const ee=await Tn(Rn(Wt(ve,"postComments"),ln("postId","==",A),qd("createdAt","asc"),Hd(50)));qt(Pe=>({...Pe,[A]:ee.docs.map(tt=>({id:tt.id,...tt.data()}))}))}catch(ee){console.error("Error loading comments:",ee)}},kr=A=>{const ee=new Set(Xe);ee.has(A)?ee.delete(A):(ee.add(A),dt[A]||Gn(A)),Je(ee)},hr=async A=>{const ee=(Rt[A]||"").trim(),Pe=In[A];if(!(!ee&&!Pe||!t)){An(tt=>({...tt,[A]:!0}));try{let tt=null;if(Pe){const Pt=Gi(Ki,`comment-images/${Date.now()}_${Pe.name}`);await Lp(Pt,Pe),tt=await Lo(Pt)}const mt={postId:A,authorId:t.id,authorName:t.name||"Unknown",authorPhotoURL:t.photoURL||null,content:ee||"",createdAt:Gr()};tt&&(mt.imageURL=tt);const Dt=sn[A];Dt&&(mt.replyToId=Dt.id,mt.replyToName=Dt.authorName),await ai(Wt(ve,"postComments"),mt),await Hi(Ke(ve,"posts",A),{commentCount:Io(1)});const st=En.find(Pt=>Pt.id===A);st&&Ut(st.authorId,"comment",{postId:A});const zt=ee.match(/@[\w\s]+?(?=\s@|\s*$|[.,!?])/g);if(zt){const Pt=new Set;zt.forEach(Xt=>{const _n=Xt.slice(1).trim(),gt=bt.find(cs=>cs.name&&cs.name.toLowerCase()===_n.toLowerCase());gt&&!Pt.has(gt.id)&&(Pt.add(gt.id),Ut(gt.id,"mention",{postId:A}))})}tn(Pt=>({...Pt,[A]:""})),un(Pt=>({...Pt,[A]:null})),H(Pt=>({...Pt,[A]:null})),yn(Pt=>({...Pt,[A]:null})),xe.current[A]&&(xe.current[A].value=""),Kt(Pt=>Pt.map(Xt=>Xt.id===A?{...Xt,commentCount:(Xt.commentCount||0)+1}:Xt)),await Gn(A)}catch(tt){console.error("Comment error:",tt),Ft("Failed to comment","error")}finally{An(tt=>({...tt,[A]:!1}))}}},Ms=async(A,ee)=>{try{await or(Ke(ve,"postComments",ee)),await Hi(Ke(ve,"posts",A),{commentCount:Io(-1)}),qt(Pe=>({...Pe,[A]:(Pe[A]||[]).filter(tt=>tt.id!==ee)})),Kt(Pe=>Pe.map(tt=>tt.id===A?{...tt,commentCount:Math.max((tt.commentCount||1)-1,0)}:tt))}catch(Pe){console.error("Delete comment error:",Pe),Ft("Failed to delete comment","error")}},Vs=(A,ee)=>{const Pe=ee.target.files?.[0];if(!Pe)return;if(Pe.size>5*1024*1024){Ft("Image must be under 5MB","error");return}un(mt=>({...mt,[A]:Pe}));const tt=new FileReader;tt.onload=mt=>H(Dt=>({...Dt,[A]:mt.target.result})),tt.readAsDataURL(Pe)},Lr=A=>{un(ee=>({...ee,[A]:null})),H(ee=>({...ee,[A]:null})),xe.current[A]&&(xe.current[A].value="")},Tr=A=>{Fe(A.target.value),A.target.style.height="auto",A.target.style.height=Math.min(A.target.scrollHeight,120)+"px",kt(A.target.value,"compose")},fa=(A,ee)=>{tn(Pe=>({...Pe,[A]:ee})),kt(ee,A)};return a.jsxs("div",{className:"cb-dashboard","data-theme":h?"dark":"light",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsxs("div",{className:"header-notif-wrap",ref:_t,children:[a.jsxs("button",{className:"header-notif-btn",onClick:()=>{ct(!At),At||ze()},"aria-label":"Notifications",children:[a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"}),a.jsx("path",{d:"M13.73 21a2 2 0 0 1-3.46 0"})]}),$e>0&&a.jsx("span",{className:"header-notif-badge",children:$e>9?"9+":$e})]}),At&&a.jsxs("div",{className:"notif-panel",children:[a.jsxs("div",{className:"notif-panel-header",children:[a.jsx("span",{className:"notif-panel-title",children:"Notifications"}),ge.length>0&&a.jsx("button",{className:"notif-clear-btn",onClick:Ve,children:"Clear all"})]}),a.jsx("div",{className:"notif-panel-list",children:ge.length===0?a.jsx("div",{className:"notif-empty",children:"No notifications yet"}):ge.map(A=>a.jsxs("div",{className:`notif-item${A.read?"":" unread"}`,onClick:()=>{if(ct(!1),A.type==="buddy_request"||A.type==="buddy_accept")g("/client/core-buddy/buddies");else if((A.type==="like"||A.type==="comment")&&A.postId){if(!Xe.has(A.postId)){const ee=new Set(Xe);ee.add(A.postId),Je(ee),dt[A.postId]||Gn(A.postId)}setTimeout(()=>{const ee=document.getElementById(`post-${A.postId}`);ee&&ee.scrollIntoView({behavior:"smooth",block:"center"})},150)}else A.type==="like"||A.type==="comment"?document.querySelector(".cb-journey-section")?.scrollIntoView({behavior:"smooth"}):A.type==="mention"&&g(`/client/core-buddy/profile/${A.fromId}`)},children:[a.jsx("div",{className:"notif-item-avatar",children:A.fromPhotoURL?a.jsx("img",{src:A.fromPhotoURL,alt:""}):a.jsx("span",{children:(A.fromName||"?")[0]})}),a.jsxs("div",{className:"notif-item-body",children:[a.jsxs("p",{className:"notif-item-text",children:[a.jsx("strong",{children:A.fromName})," ",A.type==="buddy_request"&&"sent you a buddy request",A.type==="buddy_accept"&&"accepted your buddy request",A.type==="like"&&"liked your post",A.type==="comment"&&"commented on your post",A.type==="mention"&&"mentioned you"]}),a.jsx("span",{className:"notif-item-time",children:Bp(A.createdAt)})]})]},A.id))})]})]}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsxs("div",{className:"header-actions",children:[a.jsx("button",{onClick:p,"aria-label":"Toggle theme",children:h?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})}),a.jsx("button",{onClick:i,"aria-label":"Log out",children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),a.jsx("polyline",{points:"16 17 21 12 16 7"}),a.jsx("line",{x1:"21",y1:"12",x2:"9",y2:"12"})]})})]})]})}),a.jsxs("main",{className:"cb-main",children:[a.jsxs("div",{className:"cb-ring-container",children:[a.jsxs("div",{className:"cb-ring",children:[a.jsx("svg",{className:"cb-ring-svg",viewBox:"0 0 200 200",children:$y.map((A,ee)=>{const Pe=ee<k;return a.jsx("line",{x1:A.x1,y1:A.y1,x2:A.x2,y2:A.y2,className:`ring-tick ${Pe?"elapsed":"remaining"}`,strokeWidth:A.thick?"3":"2"},ee)})}),a.jsxs("div",{className:"cb-ring-center",children:[a.jsxs("div",{className:"cb-ring-logo",onClick:()=>cn.current?.click(),role:"button",tabIndex:0,"aria-label":"Change profile photo",children:[a.jsx("img",{src:rt||"/Logo.webp",alt:rt?"Profile":"Mind Core Fitness"}),a.jsx("div",{className:`cb-photo-overlay${Ze?" uploading":""}`,children:Ze?a.jsx("div",{className:"cb-photo-spinner"}):a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"#fff",strokeWidth:"2",children:[a.jsx("path",{d:"M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"}),a.jsx("circle",{cx:"12",cy:"13",r:"4"})]})}),a.jsx("input",{ref:cn,type:"file",accept:"image/*",onChange:ie,style:{display:"none"}})]}),!rt&&!Ze&&a.jsx("div",{className:"cb-photo-badge",onClick:()=>cn.current?.click(),children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"#fff",strokeWidth:"2.5",children:[a.jsx("path",{d:"M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"}),a.jsx("circle",{cx:"12",cy:"13",r:"4"})]})})]})]}),a.jsxs("div",{className:"cb-ring-countdown",children:[a.jsx("span",{className:"cb-timer-digit",children:String(y.hours).padStart(2,"0")}),a.jsx("span",{className:"cb-timer-colon",children:":"}),a.jsx("span",{className:"cb-timer-digit",children:String(y.minutes).padStart(2,"0")}),a.jsx("span",{className:"cb-timer-colon",children:":"}),a.jsx("span",{className:"cb-timer-digit cb-timer-seconds",children:String(y.seconds).padStart(2,"0")})]}),a.jsx("span",{className:"cb-ring-label",children:"remaining today"}),a.jsxs("p",{className:"cb-ring-tagline",children:[Vp[rs].text," ",a.jsx("strong",{children:Vp[rs].bold})]},rs)]}),a.jsx("div",{className:"cb-stats-row",children:rn.map(A=>{const ee=(A.size==="large",38),Pe=2*Math.PI*ee,tt=Pe-A.pct/100*Pe;return a.jsxs("div",{className:`cb-stat-item${A.size==="large"?" cb-stat-large":""}`,children:[a.jsxs("div",{className:"cb-stat-ring",children:[a.jsxs("svg",{viewBox:"0 0 100 100",children:[a.jsx("circle",{className:"cb-stat-track",cx:"50",cy:"50",r:ee}),a.jsx("circle",{className:"cb-stat-fill",cx:"50",cy:"50",r:ee,style:{stroke:A.color},strokeDasharray:Pe,strokeDashoffset:tt})]}),a.jsx("span",{className:"cb-stat-value",style:{color:A.color},children:A.value})]}),a.jsx("span",{className:"cb-stat-label",children:A.label})]},A.label)})}),a.jsxs("p",{className:"cb-coach-msg",children:[vn.main," ",a.jsx("strong",{children:Le}),"  ",vn.sub]}),xn&&a.jsxs("button",{className:"cb-nudge-card",onClick:xn.action||void 0,style:xn.action?void 0:{cursor:"default"},children:[a.jsxs("div",{className:"cb-nudge-ring",children:[a.jsxs("svg",{viewBox:"0 0 100 100",children:[a.jsx("circle",{className:"cb-nudge-ring-track",cx:"50",cy:"50",r:"38"}),a.jsx("circle",{className:"cb-nudge-ring-fill",cx:"50",cy:"50",r:"38",strokeDasharray:2*Math.PI*38,strokeDashoffset:2*Math.PI*38-xn.pct/100*2*Math.PI*38})]}),a.jsx("span",{className:"cb-nudge-ring-val",children:xn.ringLabel})]}),a.jsxs("div",{className:"cb-nudge-info",children:[a.jsx("span",{className:"cb-nudge-label",children:xn.label}),a.jsx("span",{className:"cb-nudge-title",children:xn.message}),xn.cta&&a.jsxs("span",{className:"cb-nudge-cta",children:[xn.cta," "]})]})]}),a.jsxs("div",{className:"cb-features",children:[a.jsxs("button",{className:"cb-feature-card cb-card-nutrition cb-card-has-preview ripple-btn",onClick:A=>{Ce(A),g("/client/core-buddy/nutrition")},children:[a.jsxs("div",{className:"cb-card-top-row",children:[a.jsx("div",{className:"cb-card-content",children:a.jsx("h3",{children:"Today's Nutrition"})}),a.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),a.jsx("div",{className:"cb-card-preview-row",children:a.jsx("div",{className:"cb-mini-rings",children:[{label:"P",pct:Un("protein"),color:"#14b8a6"},{label:"C",pct:Un("carbs"),color:"var(--color-primary)"},{label:"F",pct:Un("fats"),color:"#eab308"},{label:"Cal",pct:Un("calories"),color:"#38B6FF"}].map(A=>{const Pe=2*Math.PI*38,tt=Pe-A.pct/100*Pe;return a.jsxs("div",{className:"cb-mini-ring",children:[a.jsxs("svg",{viewBox:"0 0 100 100",children:[a.jsx("circle",{className:"cb-mini-track",cx:"50",cy:"50",r:38}),a.jsx("circle",{className:"cb-mini-fill",cx:"50",cy:"50",r:38,style:{stroke:A.color},strokeDasharray:Pe,strokeDashoffset:tt})]}),a.jsx("span",{style:{color:A.color},children:A.label})]},A.label)})})}),a.jsx("p",{className:"cb-card-desc",children:"Track macros, scan barcodes, log water"})]}),a.jsxs("button",{className:"cb-feature-card cb-card-workouts-hero ripple-btn",onClick:A=>{Ce(A),g("/client/core-buddy/workouts")},children:[a.jsx("h3",{className:"cb-hero-title",children:"Workouts"}),a.jsxs("div",{className:"cb-hero-stats",children:[a.jsxs("span",{children:[Ge," this week"]}),a.jsx("span",{className:"cb-hero-dot",children:""}),a.jsxs("span",{children:[ne," total"]})]}),a.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),a.jsxs("div",{className:"cb-grid-row",children:[a.jsxs("button",{className:"cb-feature-card cb-grid-card cb-card-consistency ripple-btn",onClick:A=>{Ce(A),g("/client/core-buddy/consistency")},children:[a.jsxs("div",{className:"cb-card-content",children:[a.jsx("h3",{children:"Habits"}),a.jsx("div",{className:"cb-habit-dots",children:Array.from({length:Vi},(A,ee)=>a.jsx("span",{className:`cb-habit-dot${ee<P?" done":""}`},ee))}),a.jsxs("span",{className:"cb-habit-dots-label",children:[P,"/",Vi," today"]})]}),a.jsx("svg",{className:"cb-card-arrow cb-grid-arrow",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),a.jsxs("button",{className:"cb-feature-card cb-grid-card cb-card-progress ripple-btn",onClick:A=>{Ce(A),g("/client/personal-bests?mode=corebuddy")},children:[a.jsxs("div",{className:"cb-card-content",children:[a.jsx("h3",{children:"PBs"}),be.length>0?a.jsx("div",{className:"cb-pb-preview",children:be.slice(0,2).map(A=>a.jsxs("div",{className:"cb-pb-entry",children:[a.jsx("span",{className:"cb-pb-name",children:A.name}),a.jsxs("span",{className:"cb-pb-value",children:[A.weight,"kg"]})]},A.name))}):a.jsxs("div",{className:"cb-progress-preview",children:[a.jsx("svg",{className:"cb-progress-icon",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M13 2L3 14h9l-1 8 10-12h-9l1-8z"})}),a.jsx("span",{children:"Start lifting!"})]})]}),a.jsx("svg",{className:"cb-card-arrow cb-grid-arrow",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]})]}),a.jsxs("button",{className:"cb-feature-card cb-card-leaderboard ripple-btn",onClick:A=>{Ce(A),g("/client/leaderboard")},children:[a.jsxs("div",{className:"cb-card-content",children:[a.jsx("h3",{children:"Leaderboard"}),qe.length>0?a.jsx("div",{className:"cb-lb-preview",children:qe.map((A,ee)=>{const Pe=["#FFD700","#A8B4C0","#CD7F32"][ee],tt=A.name?A.name.split(" ").map(Dt=>Dt[0]).join("").slice(0,2).toUpperCase():"?",mt=A.id===t?.id;return a.jsxs("div",{className:`cb-lb-entry${mt?" cb-lb-me":""}`,children:[a.jsx("div",{className:"cb-lb-avatar",style:{borderColor:Pe},children:A.photoURL?a.jsx("img",{src:A.photoURL,alt:"",className:"cb-lb-avatar-img"}):a.jsx("span",{children:tt})}),a.jsxs("span",{className:"cb-lb-rank",style:{color:Pe},children:["#",ee+1]})]},A.id)})}):a.jsx("p",{children:"Opt in to compete with your Core Buddies"})]}),a.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),a.jsxs("button",{className:"cb-feature-card cb-card-buddies ripple-btn",onClick:A=>{Ce(A),g("/client/core-buddy/buddies")},children:[a.jsxs("div",{className:"cb-card-content",children:[a.jsx("h3",{children:"Buddies"}),a.jsx("p",{children:"Connect with other members and track each other's progress"})]}),a.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),a.jsxs("div",{className:"cb-achievements-section",children:[a.jsx("h3",{className:"cb-achievements-title",children:"Achievements"}),a.jsx("div",{className:"cb-badges-scroll",children:$d.map(A=>{const ee=Nt.includes(A.id);return a.jsx("button",{className:`cb-badge${ee?" unlocked":" locked"}`,onClick:()=>gn(A),children:a.jsx("img",{src:A.img,alt:A.name,className:"cb-badge-img"})},A.id)})}),a.jsxs("p",{className:"cb-badges-count",children:[Nt.length,"/",$d.length," unlocked"]})]}),le&&a.jsx("div",{className:"cb-badge-overlay",onClick:()=>gn(null),children:a.jsxs("div",{className:"cb-badge-overlay-content",onClick:A=>A.stopPropagation(),children:[a.jsx("img",{src:le.img,alt:le.name,className:"cb-badge-overlay-img"}),a.jsx("p",{className:"cb-badge-overlay-desc",children:le.desc}),Nt.includes(le.id)?a.jsx("span",{className:"cb-badge-status unlocked",children:"Unlocked"}):a.jsx("span",{className:"cb-badge-status locked",children:"Locked"}),a.jsx("button",{className:"cb-badge-overlay-close",onClick:()=>gn(null),children:"Tap to close"})]})}),a.jsxs("div",{className:"cb-journey-section",children:[a.jsx("h3",{className:"cb-journey-title",children:"My Journey"}),a.jsxs("div",{className:"journey-compose",children:[a.jsx("div",{className:"journey-compose-avatar",children:rt?a.jsx("img",{src:rt,alt:""}):a.jsx("span",{children:qc(t?.name)})}),a.jsxs("div",{className:"journey-compose-body",style:{position:"relative"},children:[a.jsx("textarea",{ref:pe,placeholder:"Share your progress... (use @ to mention)",value:Se,onChange:Tr,rows:1,maxLength:500}),Os&&q==="compose"&&T.length>0&&a.jsx("div",{className:"mention-dropdown",children:T.map(A=>a.jsxs("button",{className:"mention-option",onClick:()=>G(A,"compose"),children:[a.jsx("div",{className:"mention-option-avatar",children:A.photoURL?a.jsx("img",{src:A.photoURL,alt:""}):a.jsx("span",{children:qc(A.name)})}),a.jsx("span",{children:A.name})]},A.id))}),De&&a.jsxs("div",{className:"journey-image-preview",children:[a.jsx("img",{src:De,alt:"Preview"}),a.jsx("button",{className:"journey-image-remove",onClick:Xr,"aria-label":"Remove image",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",children:[a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})})]}),a.jsxs("div",{className:"journey-compose-actions",children:[a.jsx("button",{className:"journey-image-btn",onClick:()=>_e.current?.click(),"aria-label":"Add image",children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),a.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),a.jsx("path",{d:"M21 15l-5-5L5 21"})]})}),a.jsx("input",{ref:_e,type:"file",accept:"image/*",onChange:Da,hidden:!0}),(Se.trim()||Qe)&&a.jsx("button",{className:"journey-post-btn",onClick:_r,disabled:wt,children:wt?a.jsx("div",{className:"journey-btn-spinner"}):"Post"})]})]})]}),Sn?a.jsx("div",{className:"journey-loading",children:a.jsx("div",{className:"cb-spinner"})}):En.length===0?a.jsxs("div",{className:"journey-empty",children:[a.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),a.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),a.jsx("path",{d:"M21 15l-5-5L5 21"})]}),a.jsx("p",{children:"Start sharing your fitness journey!"})]}):a.jsx("div",{className:"journey-list",children:En.map(A=>a.jsxs("div",{id:`post-${A.id}`,className:"journey-post",children:[a.jsxs("div",{className:"journey-post-header",children:[a.jsx("div",{className:"journey-post-avatar",children:A.authorPhotoURL?a.jsx("img",{src:A.authorPhotoURL,alt:""}):a.jsx("span",{children:qc(A.authorName)})}),a.jsxs("div",{className:"journey-post-meta",children:[a.jsx("span",{className:"journey-post-name",children:A.authorName}),a.jsx("span",{className:"journey-post-time",children:Bp(A.createdAt)})]}),a.jsx("button",{className:"journey-delete-btn",onClick:()=>wn(A.id),"aria-label":"Delete post",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M3 6h18"}),a.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),a.jsx("path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]}),A.content&&a.jsx("p",{className:"journey-post-content",children:he(A.content)}),A.imageURL&&a.jsx("div",{className:"journey-post-image",children:a.jsx("img",{src:A.imageURL,alt:"Post",loading:"lazy"})}),a.jsxs("div",{className:"journey-post-actions",children:[a.jsxs("button",{className:`journey-action-btn${Q.has(A.id)?" liked":""}`,onClick:()=>ts(A.id),children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:Q.has(A.id)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})}),a.jsx("span",{children:A.likeCount||0})]}),a.jsxs("button",{className:`journey-action-btn${Xe.has(A.id)?" active":""}`,onClick:()=>kr(A.id),children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})}),a.jsx("span",{children:A.commentCount||0})]})]}),Xe.has(A.id)&&a.jsxs("div",{className:"journey-comments",children:[dt[A.id]?.length>0?dt[A.id].map(ee=>a.jsxs("div",{className:"journey-comment",children:[a.jsx("div",{className:"journey-comment-avatar",children:ee.authorPhotoURL?a.jsx("img",{src:ee.authorPhotoURL,alt:""}):a.jsx("span",{children:qc(ee.authorName)})}),a.jsxs("div",{className:"journey-comment-body",children:[a.jsxs("div",{className:"journey-comment-bubble",children:[a.jsx("span",{className:"journey-comment-name",children:ee.authorName}),ee.replyToName&&a.jsxs("span",{className:"journey-comment-reply-tag",children:[a.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("polyline",{points:"9 14 4 9 9 4"}),a.jsx("path",{d:"M20 20v-7a4 4 0 0 0-4-4H4"})]}),ee.replyToName]}),ee.content&&a.jsx("span",{className:"journey-comment-text",children:he(ee.content)}),ee.imageURL&&a.jsx("img",{className:"journey-comment-image",src:ee.imageURL,alt:"Comment",loading:"lazy"})]}),a.jsxs("div",{className:"journey-comment-actions-row",children:[a.jsx("span",{className:"journey-comment-time",children:Bp(ee.createdAt)}),a.jsx("button",{className:"journey-comment-reply-btn",onClick:()=>yn(Pe=>({...Pe,[A.id]:{id:ee.id,authorName:ee.authorName}})),children:"Reply"}),a.jsx("button",{className:"journey-comment-delete-btn",onClick:()=>Ms(A.id,ee.id),"aria-label":"Delete comment",children:a.jsxs("svg",{width:"13",height:"13",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M3 6h18"}),a.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),a.jsx("path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]})]})]},ee.id)):a.jsx("p",{className:"journey-no-comments",children:"No comments yet"}),sn[A.id]&&a.jsxs("div",{className:"journey-comment-replying",children:[a.jsxs("span",{children:["Replying to ",a.jsx("strong",{children:sn[A.id].authorName})]}),a.jsx("button",{onClick:()=>yn(ee=>({...ee,[A.id]:null})),"aria-label":"Cancel reply",children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",children:[a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})})]}),as[A.id]&&a.jsxs("div",{className:"journey-comment-img-preview",children:[a.jsx("img",{src:as[A.id],alt:"Preview"}),a.jsx("button",{onClick:()=>Lr(A.id),"aria-label":"Remove image",children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",children:[a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})})]}),a.jsxs("div",{className:"journey-comment-input",style:{position:"relative"},children:[a.jsx("button",{className:"journey-comment-img-btn",onClick:()=>xe.current[A.id]?.click(),"aria-label":"Add image",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),a.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),a.jsx("path",{d:"M21 15l-5-5L5 21"})]})}),a.jsx("input",{ref:ee=>{xe.current[A.id]=ee},type:"file",accept:"image/*",onChange:ee=>Vs(A.id,ee),hidden:!0}),a.jsx("input",{type:"text",placeholder:"Comment",value:Rt[A.id]||"",onChange:ee=>fa(A.id,ee.target.value),onKeyDown:ee=>{ee.key==="Enter"&&hr(A.id)},maxLength:300}),Os&&q===A.id&&T.length>0&&a.jsx("div",{className:"mention-dropdown mention-dropdown-up",children:T.map(ee=>a.jsxs("button",{className:"mention-option",onClick:()=>G(ee,A.id),children:[a.jsx("div",{className:"mention-option-avatar",children:ee.photoURL?a.jsx("img",{src:ee.photoURL,alt:""}):a.jsx("span",{children:qc(ee.name)})}),a.jsx("span",{children:ee.name})]},ee.id))}),a.jsx("button",{onClick:()=>hr(A.id),disabled:!(Rt[A.id]||"").trim()&&!In[A.id]||Vn[A.id],children:Vn[A.id]?a.jsx("div",{className:"journey-btn-spinner-sm"}):a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"22",y1:"2",x2:"11",y2:"13"}),a.jsx("polygon",{points:"22 2 15 22 11 13 2 9 22 2"})]})})]})]})]},A.id))})]})]})]}),a.jsx(Aa,{active:"home"}),Et&&a.jsxs("div",{className:`toast-notification ${Et.type}`,children:[Et.type==="info"&&a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("line",{x1:"12",y1:"16",x2:"12",y2:"12"}),a.jsx("line",{x1:"12",y1:"8",x2:"12.01",y2:"8"})]}),Et.message]})]})}const Up=new Map;function Bi(){return new Date().toISOString().split("T")[0]}const f2=[{key:"breakfast",label:"Breakfast"},{key:"lunch",label:"Lunch"},{key:"dinner",label:"Dinner"},{key:"snacks",label:"Snacks"}],tD={breakfast:a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M18 8h1a4 4 0 0 1 0 8h-1"}),a.jsx("path",{d:"M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z"}),a.jsx("line",{x1:"6",y1:"1",x2:"6",y2:"4"}),a.jsx("line",{x1:"10",y1:"1",x2:"10",y2:"4"}),a.jsx("line",{x1:"14",y1:"1",x2:"14",y2:"4"})]}),lunch:a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}),dinner:a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})}),snacks:a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})})};function nD(){const s=new Date().getHours();return s<11?"breakfast":s<14?"lunch":s<17?"snacks":"dinner"}function sD(){const{currentUser:s,isClient:e,clientData:t,loading:i}=Qr(),{isDark:l,toggleTheme:u,accent:h}=Ma(),p=nr(),[g,y]=x.useState("loading"),[w,k]=x.useState(null),[j,O]=x.useState({gender:"male",age:"",weight:"",weightUnit:"kg",height:"",heightUnit:"cm",heightFeet:"",heightInches:"",dailyActivity:"sedentary",trainingFrequency:"moderate",goal:"maintain",deficitLevel:"moderate"}),[$,U]=x.useState(null),[L,ne]=x.useState(Bi()),[Z,ye]=x.useState({entries:[],water:0}),[je,We]=x.useState({protein:0,carbs:0,fats:0,calories:0}),[Be,R]=x.useState(!1),[S,I]=x.useState(!1),[V,P]=x.useState(()=>{const T=new Date;return{year:T.getFullYear(),month:T.getMonth()}}),[F,M]=x.useState(nD),[He,xt]=x.useState(null),[z,fe]=x.useState(null),[Ie,Ge]=x.useState(!1),[J,D]=x.useState(null),[W,be]=x.useState(""),[Ne,qe]=x.useState(!1),[Ae,rt]=x.useState(""),[pt,Ze]=x.useState([]),[Ht,cn]=x.useState(!1),[Nt,Ct]=x.useState({name:"",protein:"",carbs:"",fats:"",calories:"",serving:""}),[le,gn]=x.useState(null),[$t,St]=x.useState("100"),[Bt,ht]=x.useState(0),[et,en]=x.useState("weight"),[rs,Lt]=x.useState(0),[Et,Pn]=x.useState(null);x.useRef(null);const Ft=x.useRef(!1),En=x.useRef(null),Kt=x.useRef(null),Sn=x.useRef(null),me=x.useCallback((T,C="info")=>{Pn({message:T,type:C}),setTimeout(()=>Pn(null),3e3)},[]);x.useEffect(()=>{!i&&(!s||!e)&&p("/")},[s,e,i,p]),x.useEffect(()=>{if(!t?.id)return;(async()=>{try{const C=await Ln(Ke(ve,"nutritionTargets",t.id));C.exists()?(k(C.data()),y("dashboard")):y("setup")}catch(C){console.error("Error loading nutrition data:",C),y("setup")}})()},[t?.id]),x.useEffect(()=>{if(!t?.id)return;(async()=>{try{const C=await Ln(Ke(ve,"nutritionLogs",`${t.id}_${L}`));if(C.exists()){const Y=C.data();ye({entries:Y.entries||[],water:Y.water||0})}else ye({entries:[],water:0})}catch(C){console.error("Error loading log:",C),ye({entries:[],water:0})}})()},[t?.id,L]),x.useEffect(()=>{const T=Z.entries.reduce((C,Y)=>({protein:C.protein+(Y.protein||0),carbs:C.carbs+(Y.carbs||0),fats:C.fats+(Y.fats||0),calories:C.calories+(Y.calories||0)}),{protein:0,carbs:0,fats:0,calories:0});We(T)},[Z.entries]);const Se=async T=>{try{await Wn(Ke(ve,"nutritionLogs",`${t.id}_${L}`),{clientId:t.id,date:L,entries:T.entries,water:T.water,updatedAt:vt.now()})}catch(C){console.error("Error saving nutrition log:",C)}},Fe=L===Bi(),Qe=(T,C)=>new Date(T,C+1,0).getDate(),Ue=(T,C)=>new Date(T,C,1).getDay(),De=["January","February","March","April","May","June","July","August","September","October","November","December"],Oe=["Su","Mo","Tu","We","Th","Fr","Sa"],wt=()=>{let T=parseFloat(j.weight);j.weightUnit==="lbs"&&(T*=.453592);let C;j.heightUnit==="cm"?C=parseFloat(j.height):C=(parseFloat(j.heightFeet)||0)*30.48+(parseFloat(j.heightInches)||0)*2.54;const Y=parseInt(j.age);let se=j.gender==="male"?10*T+6.25*C-5*Y+5:10*T+6.25*C-5*Y-161;const ze=se*{sedentary:1.2,light:1.3,moderate:1.4,active:1.5}[j.dailyActivity],Ve={low:100,moderate:200,high:300,daily:400},Ut=Math.round(ze+Ve[j.trainingFrequency]);let kt=Ut,G,he;switch(j.goal){case"lose":kt=Ut*(1-{light:.15,moderate:.2,harsh:.25}[j.deficitLevel]),G=2.2,he=.3;break;case"build":kt=Ut*1.1,G=2,he=.22;break;default:G=1.8,he=.25}kt=Math.max(kt,j.gender==="male"?1400:1100);const ie=Math.round(T*G),Ce=Math.round(kt*he/9),Le=Math.max(0,Math.round((kt-ie*4-Ce*9)/4));U({calories:Math.round(kt),protein:ie,carbs:Le,fats:Ce,bmr:Math.round(se),neat:Math.round(ze),exerciseAdd:Ve[j.trainingFrequency],tdee:Math.round(Ut)})},ft=async()=>{if($)try{const T={clientId:t.id,calories:$.calories,protein:$.protein,carbs:$.carbs,fats:$.fats,waterGoal:8,goal:j.goal,updatedAt:vt.now()};await Wn(Ke(ve,"nutritionTargets",t.id),T),k(T),y("dashboard"),me("Macro targets saved!","success")}catch(T){console.error("Error saving targets:",T),me("Failed to save targets. Please try again.","error")}},Q=()=>{const T=j.weight&&parseFloat(j.weight)>0,C=j.age&&parseInt(j.age)>0,Y=j.heightUnit==="cm"?j.height&&parseFloat(j.height)>0:j.heightFeet&&parseFloat(j.heightFeet)>0||j.heightInches&&parseFloat(j.heightInches)>0;return T&&C&&Y},Ee="nut_favourite_foods",Xe=()=>{try{return JSON.parse(localStorage.getItem(Ee)||"[]")}catch{return[]}},Je=T=>Xe().some(C=>C.name.toLowerCase()===(T||"").toLowerCase()),dt=T=>{const C=Xe(),Y=C.findIndex(se=>se.name.toLowerCase()===T.name.toLowerCase());Y>=0?C.splice(Y,1):C.unshift({name:T.name,protein:T.protein,carbs:T.carbs,fats:T.fats,calories:T.calories,serving:T.serving,per100g:T.per100g||null,servingUnit:T.servingUnit||"g",portion:T.portion||null}),localStorage.setItem(Ee,JSON.stringify(C)),Lt(se=>se+1)},qt=T=>{const C=[...Z.entries,{...T,meal:F,id:Date.now(),addedAt:new Date().toISOString()}],Y={...Z,entries:C};ye(Y),Se(Y),fe(null),gn(null),St("100"),ht(0),en("weight"),Ct({name:"",protein:"",carbs:"",fats:"",calories:"",serving:""}),me("Food added!","success")},Rt=T=>{const C=Z.entries.filter(se=>se.id!==T),Y={...Z,entries:C};ye(Y),Se(Y)},tn=x.useRef(null),Vn=async()=>{Ge(!0);const T=document.querySelector("#barcode-reader");if(!T){Ge(!1),me("Scanner container not found.","error");return}if(!tn.current)try{const Y=await Yr(()=>import("./quagga.min-BbicSfvA.js").then(se=>se.q),[]);tn.current=Y.default}catch(Y){console.error("Failed to load barcode scanner:",Y),Ge(!1),me("Could not load scanner.","error");return}const C=tn.current;C.init({inputStream:{type:"LiveStream",target:T,constraints:{facingMode:"environment",width:{min:640,ideal:1280,max:1920},height:{min:480,ideal:720,max:1080}}},locator:{patchSize:"medium",halfSample:!0},numOfWorkers:navigator.hardwareConcurrency||2,decoder:{readers:["ean_reader","ean_8_reader","upc_reader","upc_e_reader","code_128_reader","code_39_reader"]},locate:!0},Y=>{if(Y){console.error("Quagga init error:",Y),Ge(!1),me("Could not access camera. Check permissions.","error");return}C.start(),Ft.current=!0}),C.onDetected(Y=>{const se=Y.codeResult.decodedCodes?.filter(ze=>ze.error!==void 0)?.map(ze=>ze.error)||[];if((se.length>0?se.reduce((ze,Ve)=>ze+Ve,0)/se.length:1)<.15){const ze=Y.codeResult.code;C.offDetected(),D(ze)}})},An=()=>{const T=tn.current;Ft.current&&T&&(T.stop(),T.offDetected(),Ft.current=!1),Ge(!1)},sn=/\b(milk|semi.skimmed|skimmed|whole milk|oat milk|almond milk|soy milk|juice|smoothie|water|squash|cordial|cola|pepsi|fanta|lemonade|soda|beer|wine|cider|lager|spirit|whisky|vodka|rum|gin|brandy|cream|yoghurt drink|milkshake|coffee|tea|broth|stock|soup|sauce|ketchup|vinegar|oil|syrup|honey|custard|coconut water|kombucha|energy drink|protein shake)\b/i,yn=T=>/ml|cl|\dl(?!b)|litre|liter|fl\s?oz/i.test((T||"").replace(/\s/g,"")),In=T=>{if(!T)return{value:100,unit:"g"};const C=T.toLowerCase().replace(/\s/g,""),Y=C.match(/([\d.]+)/),se=Y?parseFloat(Y[1]):100;return yn(T)?/cl/.test(C)?{value:se*10,unit:"ml"}:/(?:^|\d)l(?!i)/.test(C)&&!/ml/.test(C)?{value:se*1e3,unit:"ml"}:{value:se,unit:"ml"}:{value:se,unit:"g"}},un=T=>{if(yn(T.serving_size)||yn(T.quantity))return"ml";const C=T.product_name||T.product_name_en||"";return sn.test(C)?"ml":"g"},as=[{pattern:/\b(toast|bread|loaf|brioche|bagel|pitta|wrap|tortilla|crumpet|muffin|waffle|pancake)\b/i,label:"slice",weight:36},{pattern:/\begg\b/i,label:"egg",weight:60},{pattern:/\b(biscuit|cookie|digestive|hobnob|rich tea|oreo)\b/i,label:"biscuit",weight:13},{pattern:/\b(sausage|banger)\b/i,label:"sausage",weight:57},{pattern:/\b(rasher|bacon)\b/i,label:"rasher",weight:25},{pattern:/\b(rice cake)\b/i,label:"cake",weight:9},{pattern:/\b(cracker|ryvita)\b/i,label:"cracker",weight:10}],H=(T,C)=>{const Y=T||"",se=Y.match(/\((\d+\.?\d*)\s*g\)/i),$e=Y.match(/(?:^|per\s+)(\d*\s*[a-z][a-z\s]*?)(?:\s*\(|\s*-\s*|\s*$)/i);if(se&&$e){const Ut=parseFloat(se[1]);let kt=$e[1].replace(/^\d+\s*/,"").trim();if(kt&&Ut>0)return{label:kt,weight:Ut}}const ze=Y.match(/(\d+\.?\d*)\s*g\s*[\/=]\s*(\d*\s*[a-z][a-z\s]*)/i);if(ze){const Ut=parseFloat(ze[1]);let kt=ze[2].replace(/^\d+\s*/,"").trim();if(kt&&Ut>0)return{label:kt,weight:Ut}}const Ve=C||"";for(const{pattern:Ut,label:kt,weight:G}of as)if(Ut.test(Ve))return{label:kt,weight:G};return null},pe=T=>{const C=T.nutriments||{},Y=un(T),se=In(T.serving_size),$e=Y==="ml"?se.unit==="ml"?se.value:100:se.value,ze=T.product_name||T.product_name_en||"Unknown Product",Ve=H(T.serving_size,ze);return{name:ze,brand:T.brands||"",image:T.image_small_url||T.image_url||null,servingSize:T.serving_size||"100g",servingValue:$e,servingUnit:Y,portion:Ve,protein:Math.round(C.proteins_100g||C.proteins||0),carbs:Math.round(C.carbohydrates_100g||C.carbohydrates||0),fats:Math.round(C.fat_100g||C.fat||0),calories:Math.round(C["energy-kcal_100g"]||C["energy-kcal"]||(C.energy_100g?C.energy_100g/4.184:0)),per100g:!0}},_e=async T=>{qe(!0);try{const C=`https://world.openfoodfacts.org/api/v2/product/${T}?fields=product_name,product_name_en,brands,image_small_url,image_url,serving_size,quantity,nutriments`,Y=await fetch(C);if(!Y.ok)throw new Error(`HTTP ${Y.status}`);const se=await Y.json();if(se.status==="success"||se.status===1||se.product){const $e=pe(se.product);$e.calories===0&&$e.protein===0&&$e.carbs===0?me("Product found but no nutrition data available.","error"):(gn($e),$e.portion?(ht(1),St(String($e.portion.weight)),en("portion")):(ht(0),St(String($e.servingValue||100)),en("weight")),be(""))}else me("Product not found. Try search or manual entry.","error")}catch(C){console.error("Barcode lookup error:",C),me("Failed to look up product. Check your connection.","error")}qe(!1)},xe=(T,C,Y)=>{const se=T.toLowerCase().trim(),$e=C.toLowerCase().trim(),ze=Y.toLowerCase().trim();let Ve=0;return(se===ze||se===ze+"s"||se+"s"===ze)&&(Ve+=100),(se.endsWith(" "+ze)||se.endsWith(" "+ze+"s"))&&(Ve+=40),(se.startsWith(ze+" ")||se.startsWith(ze+"s "))&&(Ve+=15),ze.split(/\s+/).some(kt=>$e===kt||$e.startsWith(kt))&&(Ve+=30),Ve+=Math.max(0,30-se.length),Ve},ge=async()=>{if(!Ae.trim())return;En.current&&En.current.abort();const T=new AbortController;En.current=T;const C=Ae.trim().toLowerCase(),Y=C.split(/\s+/).filter(Boolean);if(Up.has(C)){Ze(Up.get(C));return}cn(!0);try{const $e=`https://world.openfoodfacts.org/cgi/search.pl?search_terms=${encodeURIComponent(Ae.trim())}&search_simple=1&action=process&json=1&page_size=10&lc=en&sort_by=unique_scans_n&fields=product_name,product_name_en,brands,image_small_url,image_url,serving_size,quantity,nutriments`,ze=await fetch($e,{signal:T.signal});if(!ze.ok)throw new Error(`HTTP ${ze.status}`);const Ut=((await ze.json()).products||[]).map(kt=>pe(kt)).filter(kt=>kt.name!=="Unknown Product"&&(kt.calories>0||kt.protein>0)).filter(kt=>{const G=(kt.name+" "+kt.brand).toLowerCase();return Y.every(he=>G.includes(he))}).sort((kt,G)=>xe(G.name,G.brand,C)-xe(kt.name,kt.brand,C)).slice(0,10);Up.set(C,Ut),Ze(Ut),Ut.length===0&&me("No results found. Try a different search.","info")}catch(se){if(se.name==="AbortError")return;console.error("Search error:",se),me("Search failed. Check your connection.","error")}cn(!1)};x.useEffect(()=>{if(Kt.current&&clearTimeout(Kt.current),!(!Ae.trim()||z!=="search"||le))return Kt.current=setTimeout(()=>{ge()},700),()=>clearTimeout(Kt.current)},[Ae]);const at=()=>{const T={...Z,water:Z.water+1};ye(T),Se(T)},At=()=>{if(Z.water<=0)return;const T={...Z,water:Z.water-1};ye(T),Se(T)},ct={"ring-protein":"#14b8a6","ring-carbs":"var(--color-primary)","ring-fats":"#eab308","ring-cals":"rgba(150,150,150,0.55)"},_t=80,bt=2*Math.PI*_t,bn=(T,C,Y,se,$e)=>{const ze=se>0?Math.min(100,Math.round(Y/se*100)):0,Ve=bt-ze/100*bt,Ut=ct[$e]||"#14b8a6";return a.jsxs("div",{className:"nut-ring-wrap",children:[a.jsxs("svg",{className:"nut-ring-svg",viewBox:"0 0 200 200",children:[a.jsx("circle",{className:"nut-arc-track",cx:"100",cy:"100",r:_t}),a.jsx("circle",{className:"nut-arc-fill",cx:"100",cy:"100",r:_t,style:{stroke:Ut},strokeDasharray:bt,strokeDashoffset:Ve})]}),a.jsxs("div",{className:"nut-ring-center",children:[a.jsx("span",{className:"nut-ring-value",style:{color:Ut},children:Math.round(Y)}),a.jsxs("span",{className:"nut-ring-target",children:["/ ",se,T==="Calories"?"":"g"]}),a.jsx("span",{className:"nut-ring-label",style:{color:Ut},children:C})]}),a.jsxs("span",{className:"nut-ring-pct",style:{color:Ut},children:[ze,"%"]})]})};if(x.useEffect(()=>{if(!J)return;const T=setTimeout(()=>{const C=J;An(),D(null),_e(C)},1500);return()=>clearTimeout(T)},[J]),x.useEffect(()=>()=>{const T=tn.current;if(Ft.current&&T){try{T.stop(),T.offDetected()}catch{}Ft.current=!1}},[]),i||g==="loading")return a.jsxs("div",{className:"nut-page","data-theme":l?"dark":"light","data-accent":h,children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>p("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})]})}),a.jsx("div",{className:"nut-loading-inline",children:a.jsx("div",{className:"cb-loading-spinner"})})]});if(g==="setup")return a.jsxs("div",{className:"nut-page","data-theme":l?"dark":"light","data-accent":h,children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>p("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"nut-main",children:[a.jsxs("div",{className:"nut-setup-intro",children:[a.jsx("h2",{children:"Set Your Daily Targets"}),a.jsx("p",{children:"Calculate your personalised macros based on your body and goals."})]}),a.jsxs("div",{className:"nut-calc-form",children:[a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Gender"}),a.jsxs("div",{className:"nut-toggle-group",children:[a.jsx("button",{className:j.gender==="male"?"active":"",onClick:()=>{O(T=>({...T,gender:"male"})),U(null)},children:"Male"}),a.jsx("button",{className:j.gender==="female"?"active":"",onClick:()=>{O(T=>({...T,gender:"female"})),U(null)},children:"Female"})]})]}),a.jsxs("div",{className:"nut-form-row",children:[a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Age"}),a.jsx("input",{type:"number",value:j.age,onChange:T=>{O(C=>({...C,age:T.target.value})),U(null)},placeholder:"Years",min:"15",max:"100"})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Weight"}),a.jsxs("div",{className:"nut-input-unit",children:[a.jsx("input",{type:"number",value:j.weight,onChange:T=>{O(C=>({...C,weight:T.target.value})),U(null)},placeholder:j.weightUnit,min:"30",max:"300"}),a.jsxs("div",{className:"nut-unit-toggle",children:[a.jsx("button",{className:j.weightUnit==="kg"?"active":"",onClick:()=>{O(T=>({...T,weightUnit:"kg"})),U(null)},children:"kg"}),a.jsx("button",{className:j.weightUnit==="lbs"?"active":"",onClick:()=>{O(T=>({...T,weightUnit:"lbs"})),U(null)},children:"lbs"})]})]})]})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Height"}),a.jsxs("div",{className:"nut-input-unit",children:[j.heightUnit==="cm"?a.jsx("input",{type:"number",value:j.height,onChange:T=>{O(C=>({...C,height:T.target.value})),U(null)},placeholder:"cm",min:"100",max:"250"}):a.jsxs("div",{className:"nut-height-imperial",children:[a.jsx("input",{type:"number",value:j.heightFeet,onChange:T=>{O(C=>({...C,heightFeet:T.target.value})),U(null)},placeholder:"ft",min:"4",max:"7"}),a.jsx("input",{type:"number",value:j.heightInches,onChange:T=>{O(C=>({...C,heightInches:T.target.value})),U(null)},placeholder:"in",min:"0",max:"11"})]}),a.jsxs("div",{className:"nut-unit-toggle",children:[a.jsx("button",{className:j.heightUnit==="cm"?"active":"",onClick:()=>{O(T=>({...T,heightUnit:"cm"})),U(null)},children:"cm"}),a.jsx("button",{className:j.heightUnit==="ft"?"active":"",onClick:()=>{O(T=>({...T,heightUnit:"ft"})),U(null)},children:"ft/in"})]})]})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Daily Activity (outside of training)"}),a.jsxs("select",{value:j.dailyActivity,onChange:T=>{O(C=>({...C,dailyActivity:T.target.value})),U(null)},children:[a.jsx("option",{value:"sedentary",children:"Sedentary  desk job, under 5k steps"}),a.jsx("option",{value:"light",children:"Lightly Active  office + walking, 5-8k steps"}),a.jsx("option",{value:"moderate",children:"Moderately Active  on feet often, 8-12k steps"}),a.jsx("option",{value:"active",children:"Very Active  physical job, 12k+ steps"})]})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Training Sessions per Week"}),a.jsxs("select",{value:j.trainingFrequency,onChange:T=>{O(C=>({...C,trainingFrequency:T.target.value})),U(null)},children:[a.jsx("option",{value:"low",children:"1-2 sessions"}),a.jsx("option",{value:"moderate",children:"3-4 sessions"}),a.jsx("option",{value:"high",children:"5-6 sessions"}),a.jsx("option",{value:"daily",children:"7+ sessions"})]})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Fitness Goal"}),a.jsxs("div",{className:"nut-goal-options",children:[a.jsxs("button",{className:j.goal==="lose"?"active":"",onClick:()=>{O(T=>({...T,goal:"lose"})),U(null)},children:[a.jsx("span",{className:"nut-goal-icon",children:"-"}),a.jsx("span",{children:"Lose Weight"})]}),a.jsxs("button",{className:j.goal==="maintain"?"active":"",onClick:()=>{O(T=>({...T,goal:"maintain"})),U(null)},children:[a.jsx("span",{className:"nut-goal-icon",children:"="}),a.jsx("span",{children:"Maintain"})]}),a.jsxs("button",{className:j.goal==="build"?"active":"",onClick:()=>{O(T=>({...T,goal:"build"})),U(null)},children:[a.jsx("span",{className:"nut-goal-icon",children:"+"}),a.jsx("span",{children:"Build Muscle"})]})]})]}),j.goal==="lose"&&a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Deficit Level"}),a.jsxs("div",{className:"nut-deficit-options",children:[a.jsxs("button",{className:j.deficitLevel==="light"?"active":"",onClick:()=>{O(T=>({...T,deficitLevel:"light"})),U(null)},children:[a.jsx("strong",{children:"Mild"}),a.jsx("span",{children:"15% below TDEE"})]}),a.jsxs("button",{className:j.deficitLevel==="moderate"?"active":"",onClick:()=>{O(T=>({...T,deficitLevel:"moderate"})),U(null)},children:[a.jsx("strong",{children:"Moderate"}),a.jsx("span",{children:"20% below TDEE"})]}),a.jsxs("button",{className:j.deficitLevel==="harsh"?"active":"",onClick:()=>{O(T=>({...T,deficitLevel:"harsh"})),U(null)},children:[a.jsx("strong",{children:"Aggressive"}),a.jsx("span",{children:"25% below TDEE"})]})]})]}),a.jsx("button",{className:"nut-calc-btn",onClick:wt,disabled:!Q(),children:"Calculate Macros"})]}),$&&a.jsxs("div",{className:"nut-calc-results",children:[a.jsx("h3",{children:"Your Daily Targets"}),a.jsxs("div",{className:"nut-calc-rings",children:[bn("Protein","Protein",$.protein,$.protein,"ring-protein"),bn("Carbs","Carbs",$.carbs,$.carbs,"ring-carbs"),bn("Fats","Fats",$.fats,$.fats,"ring-fats"),bn("Calories","Calories",$.calories,$.calories,"ring-cals")]}),a.jsxs("div",{className:"nut-calc-info",children:[a.jsxs("div",{className:"nut-calc-info-row",children:[a.jsx("span",{children:"BMR (body at rest)"}),a.jsxs("span",{children:[$.bmr," cal"]})]}),a.jsxs("div",{className:"nut-calc-info-row",children:[a.jsx("span",{children:"+ Daily activity (NEAT)"}),a.jsxs("span",{children:[$.neat," cal"]})]}),a.jsxs("div",{className:"nut-calc-info-row",children:[a.jsx("span",{children:"+ Training sessions"}),a.jsxs("span",{children:["+",$.exerciseAdd," cal"]})]}),a.jsxs("div",{className:"nut-calc-info-row",style:{fontWeight:600},children:[a.jsx("span",{children:"TDEE (total burn)"}),a.jsxs("span",{children:[$.tdee," cal"]})]})]}),a.jsx("button",{className:"nut-save-targets-btn",onClick:ft,children:"Set as My Daily Targets"})]})]}),Et&&a.jsx("div",{className:`toast-notification ${Et.type}`,children:Et.message})]});const sr=T=>{const C=new Date(T+"T12:00:00"),Y=C.getDay(),se=new Date(C);se.setDate(C.getDate()-(Y+6)%7);const $e=[];for(let ze=0;ze<7;ze++){const Ve=new Date(se);Ve.setDate(se.getDate()+ze),$e.push(Ve.toISOString().split("T")[0])}return $e},Ts=["M","T","W","T","F","S","S"],Os=(T,C="search")=>{M(T),C==="scan"?(fe("scan"),gn(null)):C==="manual"?(fe("manual"),Ct({name:"",protein:"",carbs:"",fats:"",calories:"",serving:""})):C==="favourites"?fe("favourites"):(fe("search"),Ze([]),rt(""))},Bn=sr(L),q=new Date(L+"T12:00:00"),ce=`${De[q.getMonth()]} ${q.getFullYear()}`;return a.jsxs("div",{className:"nut-page","data-theme":l?"dark":"light","data-accent":h,children:[a.jsxs("div",{className:"nut-dark-zone",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>p("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsxs("div",{className:"header-actions",children:[a.jsx("button",{onClick:()=>{y("setup"),U(null)},"aria-label":"Recalculate macros",children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"3"}),a.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 1 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 1 1-2.83-2.83l.06-.06A1.65 1.65 0 0 0 4.68 15a1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1 0-4h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 1 1 2.83-2.83l.06.06A1.65 1.65 0 0 0 9 4.68a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 2.83l-.06.06A1.65 1.65 0 0 0 19.4 9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1z"})]})}),a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})]})]})}),a.jsxs("div",{className:"nut-dark-content",children:[a.jsxs("div",{className:"nut-week-strip",children:[a.jsxs("div",{className:"nut-week-header",children:[a.jsx("button",{className:"nut-week-arrow",onClick:()=>{const T=new Date(L+"T12:00:00");T.setDate(T.getDate()-7);const C=T.toISOString().split("T")[0];ne(C)},"aria-label":"Previous week",children:a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:a.jsx("polyline",{points:"15 18 9 12 15 6"})})}),a.jsx("button",{className:"nut-week-month-label",onClick:()=>{R(!Be),P({year:q.getFullYear(),month:q.getMonth()})},children:ce}),a.jsx("button",{className:"nut-week-arrow",onClick:()=>{const T=new Date(L+"T12:00:00");T.setDate(T.getDate()+7);const C=T.toISOString().split("T")[0];C<=Bi()&&ne(C)},"aria-label":"Next week",disabled:Bn[6]>=Bi(),children:a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:a.jsx("polyline",{points:"9 18 15 12 9 6"})})})]}),a.jsx("div",{className:"nut-week-days",children:Bn.map((T,C)=>{const Y=new Date(T+"T12:00:00").getDate(),se=T===L,$e=T>Bi(),ze=T===Bi();return a.jsxs("button",{className:`nut-week-day${se?" selected":""}${ze?" today":""}${$e?" future":""}`,disabled:$e,onClick:()=>ne(T),children:[a.jsx("span",{className:"nut-week-day-letter",children:Ts[C]}),a.jsx("span",{className:"nut-week-day-num",children:Y})]},T)})})]}),Be&&a.jsxs("div",{className:"nut-calendar nut-calendar-dark",children:[a.jsxs("div",{className:"nut-cal-header",children:[a.jsx("button",{onClick:()=>P(T=>{let C=T.month-1,Y=T.year;return C<0&&(C=11,Y--),{year:Y,month:C}}),children:a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("polyline",{points:"15 18 9 12 15 6"})})}),a.jsxs("span",{children:[De[V.month]," ",V.year]}),a.jsx("button",{onClick:()=>P(T=>{let C=T.month+1,Y=T.year;return C>11&&(C=0,Y++),{year:Y,month:C}}),disabled:V.year===new Date().getFullYear()&&V.month>=new Date().getMonth(),children:a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("polyline",{points:"9 18 15 12 9 6"})})})]}),a.jsx("div",{className:"nut-cal-days-header",children:Oe.map(T=>a.jsx("span",{children:T},T))}),a.jsxs("div",{className:"nut-cal-grid",children:[[...Array(Ue(V.year,V.month))].map((T,C)=>a.jsx("span",{},`e${C}`)),[...Array(Qe(V.year,V.month))].map((T,C)=>{const Y=C+1,se=`${V.year}-${String(V.month+1).padStart(2,"0")}-${String(Y).padStart(2,"0")}`,$e=se>Bi(),ze=se===L,Ve=se===Bi();return a.jsx("button",{className:`nut-cal-day${ze?" selected":""}${Ve?" today":""}${$e?" future":""}`,disabled:$e,onClick:()=>{ne(se),R(!1)},children:Y},Y)})]})]}),a.jsxs("div",{className:"nut-rings-row",children:[bn("Protein","Protein",je.protein,w.protein,"ring-protein"),bn("Carbs","Carbs",je.carbs,w.carbs,"ring-carbs"),bn("Fats","Fats",je.fats,w.fats,"ring-fats"),bn("Calories","kCal",je.calories,w.calories,"ring-cals")]})]})]}),a.jsx("div",{className:"nut-light-zone",children:a.jsxs("div",{className:"nut-light-content",children:[Fe&&a.jsxs("button",{className:"nut-water-quick",onClick:()=>I(!0),children:[a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",stroke:"none",width:"18",height:"18",children:a.jsx("path",{d:"M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z"})}),a.jsxs("span",{className:"nut-water-quick-count",children:[Z.water," / ",w?.waterGoal||8]}),a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",width:"14",height:"14",children:[a.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),a.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})]}),a.jsx("div",{className:"nut-log-section",children:a.jsx("div",{className:"nut-meals-list",children:f2.map(T=>{const C=Z.entries.filter(se=>(se.meal||"snacks")===T.key),Y=C.reduce((se,$e)=>({protein:se.protein+($e.protein||0),carbs:se.carbs+($e.carbs||0),fats:se.fats+($e.fats||0),calories:se.calories+($e.calories||0)}),{protein:0,carbs:0,fats:0,calories:0});return a.jsxs("div",{className:"nut-meal-card",children:[a.jsxs("div",{className:"nut-meal-card-header",children:[a.jsx("span",{className:`nut-meal-card-icon nut-meal-icon-${T.key}`,children:tD[T.key]}),a.jsx("span",{className:"nut-meal-card-title",children:T.label}),C.length>0&&a.jsxs("span",{className:"nut-meal-card-cal",children:[Y.calories," cal"]}),Fe&&a.jsx("button",{className:"nut-meal-add-btn",onClick:()=>xt(He===T.key?null:T.key),"aria-label":`Add to ${T.label}`,children:a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:[a.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),a.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})})]}),C.length>0&&a.jsxs("div",{className:"nut-meal-bars",children:[a.jsxs("div",{className:"nut-meal-bar-row",children:[a.jsx("span",{className:"nut-meal-bar-label nut-macro-p",children:"P"}),a.jsx("div",{className:"nut-meal-bar-track",children:a.jsx("div",{className:"nut-meal-bar-fill bar-protein",style:{width:`${Math.min(100,w.protein>0?Y.protein/w.protein*100:0)}%`}})}),a.jsxs("span",{className:"nut-meal-bar-val",children:[Y.protein,"g"]})]}),a.jsxs("div",{className:"nut-meal-bar-row",children:[a.jsx("span",{className:"nut-meal-bar-label nut-macro-c",children:"C"}),a.jsx("div",{className:"nut-meal-bar-track",children:a.jsx("div",{className:"nut-meal-bar-fill bar-carbs",style:{width:`${Math.min(100,w.carbs>0?Y.carbs/w.carbs*100:0)}%`}})}),a.jsxs("span",{className:"nut-meal-bar-val",children:[Y.carbs,"g"]})]}),a.jsxs("div",{className:"nut-meal-bar-row",children:[a.jsx("span",{className:"nut-meal-bar-label nut-macro-f",children:"F"}),a.jsx("div",{className:"nut-meal-bar-track",children:a.jsx("div",{className:"nut-meal-bar-fill bar-fats",style:{width:`${Math.min(100,w.fats>0?Y.fats/w.fats*100:0)}%`}})}),a.jsxs("span",{className:"nut-meal-bar-val",children:[Y.fats,"g"]})]}),a.jsxs("div",{className:"nut-meal-bar-row",children:[a.jsx("span",{className:"nut-meal-bar-label nut-macro-cal",children:"K"}),a.jsx("div",{className:"nut-meal-bar-track",children:a.jsx("div",{className:"nut-meal-bar-fill bar-cals",style:{width:`${Math.min(100,w.calories>0?Y.calories/w.calories*100:0)}%`}})}),a.jsx("span",{className:"nut-meal-bar-val",children:Y.calories})]})]}),C.length>0&&a.jsx("div",{className:"nut-log-list",children:C.map(se=>a.jsxs("div",{className:"nut-log-item",children:[a.jsxs("div",{className:"nut-log-item-info",children:[a.jsx("span",{className:"nut-log-item-name",children:se.name}),se.serving&&a.jsx("span",{className:"nut-log-item-serving",children:se.serving})]}),a.jsxs("div",{className:"nut-log-item-macros",children:[a.jsxs("span",{className:"nut-macro-p",children:[se.protein,"p"]}),a.jsxs("span",{className:"nut-macro-c",children:[se.carbs,"c"]}),a.jsxs("span",{className:"nut-macro-f",children:[se.fats,"f"]}),a.jsx("span",{className:"nut-macro-cal",children:se.calories})]}),Fe&&a.jsx("button",{className:"nut-log-delete",onClick:()=>Rt(se.id),"aria-label":"Remove",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]},se.id))}),C.length===0&&a.jsx("div",{className:"nut-meal-empty",children:a.jsx("p",{children:Fe?"Tap + to add food":"No entries"})})]},T.key)})})})]})}),He&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"nut-add-picker-backdrop",onClick:()=>xt(null)}),a.jsxs("div",{className:"nut-add-picker",children:[a.jsx("div",{className:"nut-add-picker-handle"}),a.jsxs("h3",{className:"nut-add-picker-title",children:["Add to ",f2.find(T=>T.key===He)?.label]}),a.jsxs("div",{className:"nut-add-picker-options",children:[a.jsxs("button",{onClick:()=>{const T=He;xt(null),Os(T,"scan")},children:[a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M3 7V5a2 2 0 0 1 2-2h2"}),a.jsx("path",{d:"M17 3h2a2 2 0 0 1 2 2v2"}),a.jsx("path",{d:"M21 17v2a2 2 0 0 1-2 2h-2"}),a.jsx("path",{d:"M7 21H5a2 2 0 0 1-2-2v-2"}),a.jsx("line",{x1:"7",y1:"12",x2:"17",y2:"12"})]}),a.jsx("span",{children:"Scan Barcode"})]}),a.jsxs("button",{onClick:()=>{const T=He;xt(null),Os(T,"search")},children:[a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"11",cy:"11",r:"8"}),a.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),a.jsx("span",{children:"Search Food"})]}),a.jsxs("button",{onClick:()=>{const T=He;xt(null),Os(T,"manual")},children:[a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),a.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]}),a.jsx("span",{children:"Manual Entry"})]}),a.jsxs("button",{onClick:()=>{const T=He;xt(null),Os(T,"favourites")},children:[a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),a.jsx("span",{children:"Favourites"})]})]})]})]}),S&&a.jsx("div",{className:"nut-modal-overlay",onClick:()=>I(!1),children:a.jsxs("div",{className:"nut-water-popup",onClick:T=>T.stopPropagation(),children:[a.jsxs("div",{className:"nut-water-popup-header",children:[a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",stroke:"none",width:"20",height:"20",style:{color:"#2196f3"},children:a.jsx("path",{d:"M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z"})}),a.jsx("span",{children:"Water Intake"}),a.jsx("button",{className:"nut-modal-close",onClick:()=>I(!1),children:a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),a.jsxs("div",{className:"nut-water-popup-body",children:[a.jsx("div",{className:"nut-water-glasses",children:[...Array(w?.waterGoal||8)].map((T,C)=>a.jsx("div",{className:`nut-water-glass ${C<Z.water?"filled":""}`,children:a.jsx("svg",{viewBox:"0 0 24 24",fill:C<Z.water?"currentColor":"none",stroke:"currentColor",strokeWidth:"1.5",children:a.jsx("path",{d:"M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z"})})},C))}),a.jsxs("div",{className:"nut-water-popup-count",children:[Z.water," / ",w?.waterGoal||8," glasses"]}),a.jsxs("div",{className:"nut-water-btns",children:[a.jsx("button",{onClick:At,disabled:Z.water<=0,children:"-"}),a.jsx("button",{onClick:at,children:"+"})]})]})]})}),z&&a.jsx("div",{className:"nut-modal-overlay",onClick:()=>{An(),D(null),fe(null),gn(null)},children:a.jsxs("div",{className:"nut-modal",onClick:T=>T.stopPropagation(),children:[a.jsxs("div",{className:"nut-modal-header",children:[a.jsx("h3",{children:z==="scan"?"Scan Barcode":z==="search"?"Search Food":z==="favourites"?"Favourites":"Manual Entry"}),a.jsx("button",{className:"nut-modal-close",onClick:()=>{An(),D(null),fe(null),gn(null)},children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),z==="scan"&&!le&&a.jsxs("div",{className:"nut-scan-area",children:[a.jsxs("div",{className:"nut-scanner-wrapper",children:[a.jsx("div",{id:"barcode-reader",className:"nut-scanner-view"}),Ie&&!J&&a.jsx("div",{className:"nut-scan-line"}),J&&a.jsxs("div",{className:"nut-scan-detected-overlay",children:[a.jsx("svg",{className:"nut-scan-detected-tick",viewBox:"0 0 24 24",fill:"none",stroke:"#4caf50",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M20 6L9 17l-5-5"})}),a.jsx("p",{className:"nut-scan-detected-label",children:"Barcode found!"}),a.jsx("p",{className:"nut-scan-detected-code",children:J})]})]}),!Ie&&a.jsxs("button",{className:"nut-scan-start-btn",onClick:Vn,children:[a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M3 7V5a2 2 0 0 1 2-2h2"}),a.jsx("path",{d:"M17 3h2a2 2 0 0 1 2 2v2"}),a.jsx("path",{d:"M21 17v2a2 2 0 0 1-2 2h-2"}),a.jsx("path",{d:"M7 21H5a2 2 0 0 1-2-2v-2"}),a.jsx("line",{x1:"7",y1:"12",x2:"17",y2:"12"})]}),"Open Camera"]}),Ie&&!J&&a.jsx("p",{className:"nut-scan-hint",children:"Align barcode within the frame"}),a.jsx("div",{className:"nut-barcode-divider",children:a.jsx("span",{children:"or enter barcode manually"})}),a.jsxs("div",{className:"nut-barcode-manual",children:[a.jsx("input",{type:"text",inputMode:"numeric",value:W,onChange:T=>be(T.target.value),onKeyDown:T=>T.key==="Enter"&&W.trim()&&_e(W.trim()),placeholder:"Enter barcode number"}),a.jsx("button",{onClick:()=>W.trim()&&_e(W.trim()),disabled:!W.trim()||Ne,children:Ne?"...":"Look Up"})]})]}),z==="scan"&&le&&(()=>{const T=le.servingUnit||"g",C=le.portion,Y=et==="portion"&&C?Bt*C.weight:parseFloat($t)||0,se=Y/100,$e=T==="ml"?[100,200,250,500]:[50,100,150,200],ze=et==="portion"&&C?`${Bt} ${C.label}${Bt!==1?"s":""} (${Math.round(Y)}${T})`:`${Math.round(Y)}${T}`;return a.jsxs("div",{className:"nut-product-result",children:[le.image&&a.jsx("img",{src:le.image,alt:le.name||"Product",className:"nut-product-img",loading:"lazy"}),a.jsxs("div",{className:"nut-product-name-row",children:[a.jsx("h4",{children:le.name}),a.jsx("button",{className:`nut-fav-star confirm${Je(le.name)?" active":""}`,onClick:()=>dt({name:le.name,protein:le.protein,carbs:le.carbs,fats:le.fats,calories:le.calories,serving:le.servingSize,per100g:{protein:le.protein,carbs:le.carbs,fats:le.fats,calories:le.calories},servingUnit:le.servingUnit||"g",portion:le.portion||null}),children:a.jsx("svg",{viewBox:"0 0 24 24",width:"22",height:"22",fill:Je(le.name)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})})]}),le.brand&&a.jsx("p",{className:"nut-product-brand",children:le.brand}),a.jsxs("p",{className:"nut-product-per",children:["Per 100",T,":"]}),a.jsxs("div",{className:"nut-product-macros",children:[a.jsxs("span",{className:"nut-macro-p",children:[le.protein,"g P"]}),a.jsxs("span",{className:"nut-macro-c",children:[le.carbs,"g C"]}),a.jsxs("span",{className:"nut-macro-f",children:[le.fats,"g F"]}),a.jsxs("span",{className:"nut-macro-cal",children:[le.calories," cal"]})]}),C&&a.jsxs("div",{className:"nut-mode-toggle",children:[a.jsx("button",{className:et==="portion"?"active":"",onClick:()=>{en("portion"),Bt<1&&ht(1)},children:"Portions"}),a.jsxs("button",{className:et==="weight"?"active":"",onClick:()=>{en("weight"),St(String(Math.round(Y)||100))},children:["Custom (",T,")"]})]}),et==="portion"&&C?a.jsxs("div",{className:"nut-portion-stepper",children:[a.jsx("button",{className:"nut-stepper-btn",onClick:()=>ht(Math.max(1,Bt-1)),children:"-"}),a.jsxs("div",{className:"nut-stepper-display",children:[a.jsx("span",{className:"nut-stepper-count",children:Bt}),a.jsxs("span",{className:"nut-stepper-label",children:[C.label,Bt!==1?"s":""]}),a.jsxs("span",{className:"nut-stepper-weight",children:[Math.round(Y),T]})]}),a.jsx("button",{className:"nut-stepper-btn",onClick:()=>ht(Bt+1),children:"+"})]}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"nut-serving-adjust",children:[a.jsxs("label",{children:["Serving (",T,")"]}),a.jsx("input",{type:"number",inputMode:"numeric",value:$t,onChange:Ve=>St(Ve.target.value),onFocus:Ve=>Ve.target.select(),min:"0"})]}),a.jsx("div",{className:"nut-quick-amounts",children:$e.map(Ve=>a.jsxs("button",{className:`nut-quick-btn${$t===String(Ve)?" active":""}`,onClick:()=>St(String(Ve)),children:[Ve,T]},Ve))})]}),a.jsx("div",{className:"nut-product-total",children:a.jsxs("span",{children:["Total: ",Math.round(le.protein*se),"p / ",Math.round(le.carbs*se),"c / ",Math.round(le.fats*se),"f / ",Math.round(le.calories*se)," cal"]})}),a.jsxs("div",{className:"nut-product-actions",children:[a.jsx("button",{className:"nut-btn-secondary",onClick:()=>{gn(null),fe("scan")},children:"Scan Again"}),a.jsx("button",{className:"nut-btn-primary",onClick:()=>qt({name:le.name,protein:Math.round(le.protein*se),carbs:Math.round(le.carbs*se),fats:Math.round(le.fats*se),calories:Math.round(le.calories*se),serving:ze}),children:"Add"})]})]})})(),z==="search"&&!le&&a.jsxs("div",{className:"nut-search-area",children:[a.jsxs("div",{className:"nut-search-bar",children:[a.jsx("input",{type:"text",ref:Sn,value:Ae,onChange:T=>rt(T.target.value),onKeyDown:T=>{T.key==="Enter"&&(clearTimeout(Kt.current),ge())},onFocus:()=>setTimeout(()=>Sn.current?.scrollIntoView({behavior:"smooth",block:"center"}),350),placeholder:"Search food or product...",autoFocus:!0}),a.jsx("button",{onClick:ge,disabled:Ht,children:Ht?"...":"Search"})]}),a.jsxs("div",{className:"nut-search-results",children:[pt.map((T,C)=>a.jsxs("button",{className:"nut-search-item",onClick:()=>{gn(T),T.portion?(ht(1),St(String(T.portion.weight)),en("portion")):(ht(0),St(String(T.servingValue||100)),en("weight"))},children:[T.image&&a.jsx("img",{src:T.image,alt:T.name||"Product",loading:"lazy"}),a.jsxs("div",{className:"nut-search-item-info",children:[a.jsx("span",{className:"nut-search-item-name",children:T.name}),T.brand&&a.jsx("span",{className:"nut-search-item-brand",children:T.brand}),a.jsxs("span",{className:"nut-search-item-macros",children:[T.calories," cal  ",T.protein,"p  ",T.carbs,"c  ",T.fats,"f per 100",T.servingUnit||"g"]})]})]},C)),pt.length===0&&Ae&&!Ht&&a.jsx("p",{className:"nut-search-empty",children:"No results found. Try a different search or use manual entry."})]})]}),z==="search"&&le&&(()=>{const T=le.servingUnit||"g",C=le.portion,Y=et==="portion"&&C?Bt*C.weight:parseFloat($t)||0,se=Y/100,$e=T==="ml"?[100,200,250,500]:[50,100,150,200],ze=et==="portion"&&C?`${Bt} ${C.label}${Bt!==1?"s":""} (${Math.round(Y)}${T})`:`${Math.round(Y)}${T}`;return a.jsxs("div",{className:"nut-product-result",children:[le.image&&a.jsx("img",{src:le.image,alt:le.name||"Product",className:"nut-product-img",loading:"lazy"}),a.jsxs("div",{className:"nut-product-name-row",children:[a.jsx("h4",{children:le.name}),a.jsx("button",{className:`nut-fav-star confirm${Je(le.name)?" active":""}`,onClick:()=>dt({name:le.name,protein:le.protein,carbs:le.carbs,fats:le.fats,calories:le.calories,serving:le.servingSize,per100g:{protein:le.protein,carbs:le.carbs,fats:le.fats,calories:le.calories},servingUnit:le.servingUnit||"g",portion:le.portion||null}),children:a.jsx("svg",{viewBox:"0 0 24 24",width:"22",height:"22",fill:Je(le.name)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})})]}),le.brand&&a.jsx("p",{className:"nut-product-brand",children:le.brand}),a.jsxs("p",{className:"nut-product-per",children:["Per 100",T,":"]}),a.jsxs("div",{className:"nut-product-macros",children:[a.jsxs("span",{className:"nut-macro-p",children:[le.protein,"g P"]}),a.jsxs("span",{className:"nut-macro-c",children:[le.carbs,"g C"]}),a.jsxs("span",{className:"nut-macro-f",children:[le.fats,"g F"]}),a.jsxs("span",{className:"nut-macro-cal",children:[le.calories," cal"]})]}),C&&a.jsxs("div",{className:"nut-mode-toggle",children:[a.jsx("button",{className:et==="portion"?"active":"",onClick:()=>{en("portion"),Bt<1&&ht(1)},children:"Portions"}),a.jsxs("button",{className:et==="weight"?"active":"",onClick:()=>{en("weight"),St(String(Math.round(Y)||100))},children:["Custom (",T,")"]})]}),et==="portion"&&C?a.jsxs("div",{className:"nut-portion-stepper",children:[a.jsx("button",{className:"nut-stepper-btn",onClick:()=>ht(Math.max(1,Bt-1)),children:"-"}),a.jsxs("div",{className:"nut-stepper-display",children:[a.jsx("span",{className:"nut-stepper-count",children:Bt}),a.jsxs("span",{className:"nut-stepper-label",children:[C.label,Bt!==1?"s":""]}),a.jsxs("span",{className:"nut-stepper-weight",children:[Math.round(Y),T]})]}),a.jsx("button",{className:"nut-stepper-btn",onClick:()=>ht(Bt+1),children:"+"})]}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"nut-serving-adjust",children:[a.jsxs("label",{children:["Serving (",T,")"]}),a.jsx("input",{type:"number",inputMode:"numeric",value:$t,onChange:Ve=>St(Ve.target.value),onFocus:Ve=>Ve.target.select(),min:"0"})]}),a.jsx("div",{className:"nut-quick-amounts",children:$e.map(Ve=>a.jsxs("button",{className:`nut-quick-btn${$t===String(Ve)?" active":""}`,onClick:()=>St(String(Ve)),children:[Ve,T]},Ve))})]}),a.jsx("div",{className:"nut-product-total",children:a.jsxs("span",{children:["Total: ",Math.round(le.protein*se),"p / ",Math.round(le.carbs*se),"c / ",Math.round(le.fats*se),"f / ",Math.round(le.calories*se)," cal"]})}),a.jsxs("div",{className:"nut-product-actions",children:[a.jsx("button",{className:"nut-btn-secondary",onClick:()=>gn(null),children:"Back to Search"}),a.jsx("button",{className:"nut-btn-primary",onClick:()=>qt({name:le.name,protein:Math.round(le.protein*se),carbs:Math.round(le.carbs*se),fats:Math.round(le.fats*se),calories:Math.round(le.calories*se),serving:ze}),children:"Add"})]})]})})(),z==="manual"&&a.jsxs("div",{className:"nut-manual-form",children:[a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Food Name"}),a.jsx("input",{type:"text",value:Nt.name,onChange:T=>Ct(C=>({...C,name:T.target.value})),placeholder:"e.g. Chicken Breast",autoFocus:!0})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Serving Size (optional)"}),a.jsx("input",{type:"text",value:Nt.serving,onChange:T=>Ct(C=>({...C,serving:T.target.value})),placeholder:"e.g. 150g, 1 cup"})]}),a.jsxs("div",{className:"nut-manual-macros",children:[a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Protein (g)"}),a.jsx("input",{type:"number",value:Nt.protein,onChange:T=>Ct(C=>({...C,protein:T.target.value})),min:"0"})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Carbs (g)"}),a.jsx("input",{type:"number",value:Nt.carbs,onChange:T=>Ct(C=>({...C,carbs:T.target.value})),min:"0"})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Fats (g)"}),a.jsx("input",{type:"number",value:Nt.fats,onChange:T=>Ct(C=>({...C,fats:T.target.value})),min:"0"})]}),a.jsxs("div",{className:"nut-form-group",children:[a.jsx("label",{children:"Calories"}),a.jsx("input",{type:"number",value:Nt.calories,onChange:T=>Ct(C=>({...C,calories:T.target.value})),min:"0"})]})]}),a.jsx("button",{className:"nut-btn-primary",disabled:!Nt.name.trim(),onClick:()=>qt({name:Nt.name,protein:parseFloat(Nt.protein)||0,carbs:parseFloat(Nt.carbs)||0,fats:parseFloat(Nt.fats)||0,calories:parseFloat(Nt.calories)||0,serving:Nt.serving||""}),children:"Add Food"})]}),z==="favourites"&&!le&&(()=>{const T=Xe(),C=Y=>{if(Y.per100g){const se=Y.per100g;gn({name:Y.name,brand:"",image:null,servingSize:Y.serving||"100g",servingValue:100,servingUnit:Y.servingUnit||"g",portion:Y.portion||null,protein:se.protein,carbs:se.carbs,fats:se.fats,calories:se.calories,per100g:!0}),Y.portion?(ht(1),St(String(Y.portion.weight)),en("portion")):(ht(0),St("100"),en("weight"))}else qt({name:Y.name,protein:Y.protein,carbs:Y.carbs,fats:Y.fats,calories:Y.calories,serving:Y.serving||""})};return a.jsx("div",{className:"nut-recent-area",children:T.length===0?a.jsx("p",{className:"nut-search-empty",children:"No favourites yet. Tap the star on any food to save it here."}):a.jsx("div",{className:"nut-recent-list",children:T.map((Y,se)=>a.jsxs("div",{className:"nut-recent-item-row",children:[a.jsx("button",{className:"nut-fav-star active",onClick:$e=>{$e.stopPropagation(),dt(Y)},children:a.jsx("svg",{viewBox:"0 0 24 24",width:"18",height:"18",fill:"currentColor",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),a.jsxs("button",{className:"nut-recent-item",onClick:()=>C(Y),children:[a.jsxs("div",{className:"nut-recent-item-info",children:[a.jsx("span",{className:"nut-recent-item-name",children:Y.name}),a.jsx("span",{className:"nut-recent-item-serving",children:Y.serving||""})]}),a.jsxs("span",{className:"nut-recent-item-macros",children:[Y.calories," cal"]})]})]},se))})})})(),z==="favourites"&&le&&(()=>{const T=le.servingUnit||"g",C=le.portion,Y=et==="portion"&&C?Bt*C.weight:parseFloat($t)||0,se=Y/100,$e=T==="ml"?[100,200,250,500]:[50,100,150,200],ze=et==="portion"&&C?`${Bt} ${C.label}${Bt!==1?"s":""} (${Math.round(Y)}${T})`:`${Math.round(Y)}${T}`;return a.jsxs("div",{className:"nut-product-result",children:[a.jsxs("div",{className:"nut-product-name-row",children:[a.jsx("h4",{children:le.name}),a.jsx("button",{className:`nut-fav-star confirm${Je(le.name)?" active":""}`,onClick:()=>dt({name:le.name,protein:le.protein,carbs:le.carbs,fats:le.fats,calories:le.calories,serving:le.servingSize,per100g:{protein:le.protein,carbs:le.carbs,fats:le.fats,calories:le.calories},servingUnit:le.servingUnit||"g",portion:le.portion||null}),children:a.jsx("svg",{viewBox:"0 0 24 24",width:"22",height:"22",fill:Je(le.name)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})})]}),a.jsxs("p",{className:"nut-product-per",children:["Per 100",T,":"]}),a.jsxs("div",{className:"nut-product-macros",children:[a.jsxs("span",{className:"nut-macro-p",children:[le.protein,"g P"]}),a.jsxs("span",{className:"nut-macro-c",children:[le.carbs,"g C"]}),a.jsxs("span",{className:"nut-macro-f",children:[le.fats,"g F"]}),a.jsxs("span",{className:"nut-macro-cal",children:[le.calories," cal"]})]}),C&&a.jsxs("div",{className:"nut-mode-toggle",children:[a.jsx("button",{className:et==="portion"?"active":"",onClick:()=>{en("portion"),Bt<1&&ht(1)},children:"Portions"}),a.jsxs("button",{className:et==="weight"?"active":"",onClick:()=>{en("weight"),St(String(Math.round(Y)||100))},children:["Custom (",T,")"]})]}),et==="portion"&&C?a.jsxs("div",{className:"nut-portion-stepper",children:[a.jsx("button",{className:"nut-stepper-btn",onClick:()=>ht(Math.max(1,Bt-1)),children:"-"}),a.jsxs("div",{className:"nut-stepper-display",children:[a.jsx("span",{className:"nut-stepper-count",children:Bt}),a.jsxs("span",{className:"nut-stepper-label",children:[C.label,Bt!==1?"s":""]}),a.jsxs("span",{className:"nut-stepper-weight",children:[Math.round(Y),T]})]}),a.jsx("button",{className:"nut-stepper-btn",onClick:()=>ht(Bt+1),children:"+"})]}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"nut-serving-adjust",children:[a.jsxs("label",{children:["Serving (",T,")"]}),a.jsx("input",{type:"number",inputMode:"numeric",value:$t,onChange:Ve=>St(Ve.target.value),onFocus:Ve=>Ve.target.select(),min:"0"})]}),a.jsx("div",{className:"nut-quick-amounts",children:$e.map(Ve=>a.jsxs("button",{className:`nut-quick-btn${$t===String(Ve)?" active":""}`,onClick:()=>St(String(Ve)),children:[Ve,T]},Ve))})]}),a.jsx("div",{className:"nut-product-total",children:a.jsxs("span",{children:["Total: ",Math.round(le.protein*se),"p / ",Math.round(le.carbs*se),"c / ",Math.round(le.fats*se),"f / ",Math.round(le.calories*se)," cal"]})}),a.jsxs("div",{className:"nut-product-actions",children:[a.jsx("button",{className:"nut-btn-secondary",onClick:()=>gn(null),children:"Back to Favourites"}),a.jsx("button",{className:"nut-btn-primary",onClick:()=>qt({name:le.name,protein:Math.round(le.protein*se),carbs:Math.round(le.carbs*se),fats:Math.round(le.fats*se),calories:Math.round(le.calories*se),serving:ze}),children:"Add"})]})]})})()]})}),a.jsx(Aa,{active:"nutrition"}),Et&&a.jsx("div",{className:`toast-notification ${Et.type}`,children:Et.message})]})}const m2="/login/assets/randomiser-glq9YJkL.jpg",rD="/login/assets/programme-card-workout-CnNzTYkz.webp",aD="/login/assets/prog-fullbody-4wk-r6m9HJys.jpg",iD="/login/assets/mg-arms-BeOQU3wx.jpg",oD=60,zp=5,lD=[{threshold:1e3,label:"1 Tonne"},{threshold:5e3,label:"5 Tonne"},{threshold:1e4,label:"10 Tonne"},{threshold:25e3,label:"25 Tonne"},{threshold:5e4,label:"50 Tonne"},{threshold:1e5,label:"100 Tonne"},{threshold:25e4,label:"250 Tonne"},{threshold:5e5,label:"500 Tonne"},{threshold:1e6,label:"1 Million kg"}],cD={"Dumbbell Floor Press":"push","Seated Dumbbell Shoulder Press":"push","Seated Dumbbell Arnold Press":"push","Dumbbell Overhead Tricep Extension":"push",Skullcrushers:"push","Dumbbell Lateral Raise":"push","Dumbbell Front Raise":"push","Dumbbell Squeeze Press":"push","Incline Dumbbell Press":"push","Dumbbell Fly":"push","Dumbbell Pullover":"push","Tricep Kickback":"push","Dumbbell Shrug":"push","Dumbbell Y-Raise":"push","Dumbbell Bent Over Row":"pull","Single Arm Bent Over Row":"pull","Bicep Curl":"pull","Hammer Curl":"pull","Dumbbell Bent Over Rear Delt Fly":"pull","Renegade Row":"pull","Wide Dumbbell Bent Over Row":"pull","Reverse Fly":"pull","Concentration Curl":"pull","Wide Grip Bicep Curl":"pull","Wrist Curl":"pull","Dumbbell Goblet Squats":"lower","Romanian Deadlifts":"lower","Forward Dumbbell Lunges":"lower","Dumbbell Sumo Squats":"lower","Weighted Calf Raises":"lower","1 Legged RDL":"lower","Dumbbell Box Step Ups":"lower","Dumbbell Squat Pulses":"lower","Dumbbell Reverse Lunges":"lower","Kettlebell Romanian Deadlift":"lower","Russian Twists Dumbbell":"core","Kettlebell Russian Twist":"core","Kettlebell Side Bends":"core","Kneeling Kettlebell Halo":"core","Kettlebell Bird Dog Drag":"core"},uD={fullbody_4wk:{duration:4,daysPerWeek:3},fullbody_8wk:{duration:8,daysPerWeek:3},fullbody_12wk:{duration:12,daysPerWeek:3},core_4wk:{duration:4,daysPerWeek:3},core_8wk:{duration:8,daysPerWeek:3},core_12wk:{duration:12,daysPerWeek:3},upper_4wk:{duration:4,daysPerWeek:3},lower_4wk:{duration:4,daysPerWeek:3}},hD={fullbody:"linear-gradient(160deg, rgba(153,49,60,0.15) 0%, rgba(153,49,60,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)",core:"linear-gradient(160deg, rgba(30,80,120,0.2) 0%, rgba(30,80,120,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)",upper:"linear-gradient(160deg, rgba(100,60,140,0.2) 0%, rgba(100,60,140,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)",lower:"linear-gradient(160deg, rgba(40,120,80,0.2) 0%, rgba(40,120,80,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)"},Fp={arms:"linear-gradient(160deg, rgba(180,60,60,0.2) 0%, rgba(180,60,60,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",chest:"linear-gradient(160deg, rgba(50,100,160,0.2) 0%, rgba(50,100,160,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",back:"linear-gradient(160deg, rgba(80,130,60,0.2) 0%, rgba(80,130,60,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",shoulders:"linear-gradient(160deg, rgba(160,100,40,0.2) 0%, rgba(160,100,40,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",legs:"linear-gradient(160deg, rgba(100,50,140,0.2) 0%, rgba(100,50,140,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",core:"linear-gradient(160deg, rgba(30,80,120,0.2) 0%, rgba(30,80,120,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)"},qp=[{id:"fullbody_4wk",name:"4-Week Full Body",focus:"fullbody",duration:4,level:"All Levels",daysPerWeek:3,image:aD},{id:"fullbody_8wk",name:"8-Week Full Body",focus:"fullbody",duration:8,level:"Intermediate",daysPerWeek:3},{id:"fullbody_12wk",name:"12-Week Full Body",focus:"fullbody",duration:12,level:"Advanced",daysPerWeek:3},{id:"core_4wk",name:"4-Week Core",focus:"core",duration:4,level:"Beginner",daysPerWeek:3},{id:"core_8wk",name:"8-Week Core",focus:"core",duration:8,level:"Intermediate",daysPerWeek:3},{id:"core_12wk",name:"12-Week Core",focus:"core",duration:12,level:"Advanced",daysPerWeek:3},{id:"upper_4wk",name:"4-Week Upper Body",focus:"upper",duration:4,level:"Intermediate",daysPerWeek:3},{id:"lower_4wk",name:"4-Week Lower Body",focus:"lower",duration:4,level:"Intermediate",daysPerWeek:3}],Hc=[{key:"arms",label:"Arms",icon:"M7 5h2v14H7V5zm8 0h2v14h-2V5zm-5 4h4v6h-4V9z",image:iD},{key:"chest",label:"Chest",icon:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 15H9v-2h2v2zm4 0h-2v-2h2v2zm3-6c0 1.1-.36 2.12-.97 2.95l-.87-.87C16.7 12.53 17 11.8 17 11c0-2.76-2.24-5-5-5S7 8.24 7 11c0 .8.3 1.53.84 2.08l-.87.87A4.977 4.977 0 0 1 6 11c0-3.31 2.69-6 6-6s6 2.69 6 6z"},{key:"back",label:"Back",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm4 18H8v-6l-4-4 1.41-1.41L8 11.17V8h8v3.17l2.59-2.58L20 10l-4 4v6z"},{key:"shoulders",label:"Shoulders",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm8 10l-3-1.5c-.5-.25-1-.5-1.5-.5h-7c-.5 0-1 .25-1.5.5L4 12l-2 6h4l1.5 4h9L18 18h4l-2-6z"},{key:"legs",label:"Legs",icon:"M16.5 3A2.5 2.5 0 0 0 14 5.5 2.5 2.5 0 0 0 16.5 8 2.5 2.5 0 0 0 19 5.5 2.5 2.5 0 0 0 16.5 3zM14 9l-3 7h2l1 6h2l1-6h2l-3-7h-2z"},{key:"core",label:"Core",icon:"M12 2a4 4 0 0 1 4 4v1h-2V6a2 2 0 1 0-4 0v1H8V6a4 4 0 0 1 4-4zM8 9h8v2H8V9zm-1 4h10l-1 9H8l-1-9z"}],p2={chest:[{id:"chest_strength",name:"Chest Strength",desc:"Heavy pressing for max strength",level:"Intermediate",overview:"A heavy pressing session designed to build raw chest strength. Focus on controlled negatives and powerful pressing movements.",tips:["Go heavy  pick a weight where the last 2 reps are a real challenge","Control the negative (lowering phase) for 2-3 seconds","Keep your shoulder blades squeezed together throughout all pressing movements","Rest 90-120 seconds between sets to allow full recovery"],exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:4,reps:8,storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Dumbbell Squeeze Press",type:"weighted",sets:3,reps:10,storagePath:null},{name:"Incline Dumbbell Press",type:"weighted",sets:3,reps:10,storagePath:null},{name:"Dumbbell Pullover",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Dumbbell Fly",type:"weighted",sets:3,reps:12,storagePath:null}]},{id:"chest_hypertrophy",name:"Chest Hypertrophy",desc:"Volume training for muscle growth",level:"Intermediate",overview:"A high-volume chest session focused on time under tension and muscle growth. Lighter weights, more reps, and slow controlled movements.",tips:["Use moderate weight  you should feel the burn by rep 10","Squeeze your chest at the top of every rep for 1 second","Keep rest periods short at 60-90 seconds to keep the pump going","On press ups, go to failure on the final set"],exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Wide Press Up",type:"reps",sets:3,reps:15,storagePath:null},{name:"Dumbbell Fly",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Incline Dumbbell Press",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Press Up",type:"reps",sets:3,reps:20,storagePath:"exercises/bodyweight/upper/press up.mp4"}]},{id:"chest_endurance",name:"Chest Endurance",desc:"Bodyweight pushing to failure",level:"All Levels",overview:"No weights needed. This bodyweight-only session builds chest endurance and muscular stamina through high-rep push up variations.",tips:["Focus on full range of motion  chest to floor on every rep","Keep your core tight and body in a straight line throughout","Scale down to knee press ups if you can't maintain form","Push through the burn  the last 5 reps are where the growth happens"],exercises:[{name:"Press Up",type:"reps",sets:4,reps:20,storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Wide Press Up",type:"reps",sets:3,reps:15,storagePath:null},{name:"Diamond Press Up",type:"reps",sets:3,reps:12,storagePath:null},{name:"Decline Press Up",type:"reps",sets:3,reps:15,storagePath:null},{name:"Press Up Hold",type:"timed",sets:3,time:30,storagePath:null}]}],back:[{id:"back_strength",name:"Back Strength",desc:"Heavy rows for a thick back",level:"Intermediate",overview:"Build a thick, powerful back with heavy rowing movements. This session targets your lats, rhomboids, and traps for overall back development.",tips:["Go heavy on rows  use a weight that challenges you by rep 6-8","Drive your elbows back and squeeze your shoulder blades together at the top","Keep a slight bend in your knees and hinge at the hips for bent over movements","Rest 90-120 seconds between sets for full recovery"],exercises:[{name:"Dumbbell Bent Over Row",type:"weighted",sets:4,reps:8,storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Single Arm Bent Over Row",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Dumbbell Pullover",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Dumbbell Shrug",type:"weighted",sets:3,reps:15,storagePath:null}]},{id:"back_hypertrophy",name:"Back Hypertrophy",desc:"Width and thickness volume work",level:"Intermediate",overview:"A volume-focused back session combining rows and isolation moves to build width and thickness. Focus on the mind-muscle connection.",tips:["Use moderate weight  feel the stretch and squeeze on every rep","On renegade rows, keep your hips square to the floor and avoid rotating","For reverse flys, use lighter weight and focus on squeezing your rear delts","Keep rest to 60-90 seconds to maintain intensity"],exercises:[{name:"Renegade Row",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/upper/renegade row.mp4"},{name:"Wide Dumbbell Bent Over Row",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Single Arm Bent Over Row",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Reverse Fly",type:"weighted",sets:3,reps:15,storagePath:null},{name:"Prone Y-T-W Raises",type:"reps",sets:3,reps:10,storagePath:null}]},{id:"back_endurance",name:"Back Endurance",desc:"Bodyweight back conditioning",level:"All Levels",overview:"A bodyweight session to strengthen your posterior chain and improve posture. Great for back health, mobility, and muscular endurance.",tips:["On superman holds, lift your arms and legs simultaneously and hold tight","Focus on slow, controlled movements  quality over speed","Breathe steadily throughout timed holds  don't hold your breath","Engage your glutes and lower back together on every movement"],exercises:[{name:"Superman Hold",type:"timed",sets:4,time:30,storagePath:"exercises/bodyweight/upper/Superman Hold.mp4"},{name:"Prone Y-T-W Raises",type:"reps",sets:3,reps:12,storagePath:null},{name:"Reverse Snow Angel",type:"reps",sets:3,reps:12,storagePath:null},{name:"Bird Dog",type:"reps",sets:3,reps:12,storagePath:"exercises/bodyweight/core/Bird Dog.mp4"},{name:"Back Extension Hold",type:"timed",sets:3,time:30,storagePath:null}]}],shoulders:[{id:"shoulders_strength",name:"Shoulder Strength",desc:"Heavy pressing for boulder shoulders",level:"Intermediate",overview:"A heavy overhead pressing session to build strong, powerful shoulders. Compound movements first, followed by isolation work for all three delt heads.",tips:["Go heavy on presses  pick a weight where you struggle on the last 2 reps","Brace your core and avoid arching your back during overhead movements","Press straight up and control the weight down slowly","Rest 90-120 seconds between pressing sets, 60 seconds for isolation moves"],exercises:[{name:"Seated Dumbbell Shoulder Press",type:"weighted",sets:4,reps:8,storagePath:"exercises/dumbbells/upper/seated dumbbell shoulder press.mp4"},{name:"Seated Dumbbell Arnold Press",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/upper/seated dumbbell arnold press.mp4"},{name:"Dumbbell Front Raise",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell front raise.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Dumbbell Shrug",type:"weighted",sets:3,reps:15,storagePath:null}]},{id:"shoulders_hypertrophy",name:"Shoulder Hypertrophy",desc:"Volume and isolation for 3D delts",level:"Intermediate",overview:"A high-volume session targeting all three heads of the deltoid for that 3D capped shoulder look. Moderate weight, high reps, constant tension.",tips:["Use lighter weight than you think  shoulders respond best to high reps","On lateral raises, lead with your elbows and don't swing the weight","Pause at the top of each raise for a 1-second squeeze","Keep rest periods at 60 seconds to maximise the pump"],exercises:[{name:"Seated Dumbbell Arnold Press",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/seated dumbbell arnold press.mp4"},{name:"Dumbbell Lateral Raise",type:"weighted",sets:4,reps:15,storagePath:"exercises/dumbbells/upper/dumbbell lateral raise.mp4"},{name:"Dumbbell Front Raise",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell front raise.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,reps:15,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Dumbbell Y-Raise",type:"weighted",sets:3,reps:12,storagePath:null}]},{id:"shoulders_endurance",name:"Shoulder Endurance",desc:"Bodyweight and high-rep work",level:"All Levels",overview:"A shoulder endurance session combining bodyweight movements with high-rep dumbbell work. Builds stamina, stability, and shoulder resilience.",tips:["On pike push ups, walk your feet close to your hands to increase the angle","For high-rep lateral raises, use a very light weight and focus on form","Wall walks are advanced  scale to pike push ups if needed","Keep your core braced throughout to protect your lower back"],exercises:[{name:"Pike Push Ups",type:"reps",sets:4,reps:12,storagePath:"exercises/bodyweight/upper/pike push ups.mp4"},{name:"Dumbbell Lateral Raise",type:"weighted",sets:3,reps:20,storagePath:"exercises/dumbbells/upper/dumbbell lateral raise.mp4"},{name:"Wall Walks",type:"reps",sets:3,reps:6,storagePath:null},{name:"Prone Y-T-W Raises",type:"reps",sets:3,reps:10,storagePath:null},{name:"Shoulder Tap Hold",type:"timed",sets:3,time:30,storagePath:null}]}],arms:[{id:"arms_bicep",name:"Bicep Focus",desc:"Curl variations for peak biceps",level:"All Levels",overview:"An arm session dedicated entirely to biceps. Multiple curl variations target different parts of the bicep for maximum peak and thickness.",tips:["Keep your elbows pinned to your sides  no swinging","Control the negative (lowering) for 2-3 seconds on every rep","Start with your heaviest weight and decrease as you fatigue","Squeeze hard at the top of each curl for a full contraction"],exercises:[{name:"Bicep Curl",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Hammer Curl",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/hammer curl.mp4"},{name:"Concentration Curl",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Wide Grip Bicep Curl",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Isometric Bicep Hold",type:"timed",sets:3,time:20,storagePath:null}]},{id:"arms_tricep",name:"Tricep Focus",desc:"Extensions and dips for horseshoe triceps",level:"All Levels",overview:"All-out tricep training with extensions, dips, and pressing movements. The triceps make up two-thirds of your arm  this session builds serious size.",tips:["On overhead extensions, keep your elbows close to your head","For skullcrushers, lower the weight slowly to just above your forehead","On dips, lean slightly forward to reduce shoulder strain","Full lockout at the top of every extension for maximum tricep contraction"],exercises:[{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Skullcrushers",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/skullcrushers.mp4"},{name:"Tricep Dips",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/upper/tricep dips.mp4"},{name:"Tricep Kickback",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Diamond Press Up",type:"reps",sets:3,reps:12,storagePath:null}]},{id:"arms_full",name:"Full Arms",desc:"Superset biceps and triceps",level:"All Levels",overview:"A balanced arm session alternating between biceps and triceps. Superset style keeps the intensity high and maximises the pump.",tips:["Superset each pair  do biceps then immediately hit triceps","Use moderate weight that lets you maintain strict form for all reps","Rest 60 seconds after each superset pair","Focus on the squeeze at the peak contraction of every rep"],exercises:[{name:"Bicep Curl",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Tricep Kickback",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Hammer Curl",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/hammer curl.mp4"},{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Wrist Curl",type:"weighted",sets:3,reps:15,storagePath:null}]}],legs:[{id:"legs_quad",name:"Quad Dominant",desc:"Squats and lunges for quad power",level:"All Levels",overview:"A quad-focused leg session built around squats and lunges. Heavy compound movements to build strong, powerful quads and overall leg strength.",tips:["On goblet squats, hold the dumbbell close to your chest and sit deep","Keep your knees tracking over your toes  don't let them cave inward","Drive through your heels on all squatting movements","Rest 90-120 seconds between heavy sets, 60 seconds on bodyweight moves"],exercises:[{name:"Dumbbell Goblet Squats",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Forward Dumbbell Lunges",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.mp4"},{name:"Dumbbell Squat Pulses",type:"weighted",sets:3,reps:15,storagePath:"exercises/dumbbells/lower/dumbbell squat pulses.mp4"},{name:"Bulgarian Split Squats",type:"reps",sets:3,reps:12,storagePath:"exercises/bodyweight/lower/bulgarian split squats.mp4"},{name:"Squat And Hold",type:"timed",sets:3,time:30,storagePath:"exercises/bodyweight/lower/squat and hold.mp4"}]},{id:"legs_ham_glute",name:"Hamstring & Glute",desc:"Posterior chain focus",level:"Intermediate",overview:"Target the back of your legs with deadlift and hip hinge variations. This session builds a strong posterior chain  hamstrings, glutes, and lower back.",tips:["On RDLs, push your hips back and feel the stretch in your hamstrings","Keep a slight bend in your knees throughout hip hinge movements","Squeeze your glutes hard at the top of every rep","For single leg work, start with your weaker side first"],exercises:[{name:"Romanian Deadlifts",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/lower/romanian deadlifts.mp4"},{name:"1 Legged RDL",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/lower/1 legged rdl.mp4"},{name:"Hip Thrusts",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/lower/hip thrusts.mp4"},{name:"Dumbbell Sumo Squats",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/dumbbell sumo squats.mp4"},{name:"Donkey Kicks",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/lower/donkey kicks.mp4"}]},{id:"legs_power",name:"Power & Plyo",desc:"Explosive leg training",level:"Intermediate",overview:"An explosive leg session combining plyometrics with weighted movements. Build power, speed, and athletic performance.",tips:["On jump squats, land softly with bent knees to absorb the impact","Explode up on every rep  power comes from speed, not just weight","Keep rest periods at 60-90 seconds to maintain intensity","Focus on landing mechanics  knees out, chest up, soft landing"],exercises:[{name:"Jump Squats",type:"reps",sets:4,reps:12,storagePath:"exercises/bodyweight/lower/jump squats.mp4"},{name:"Dumbbell Box Step Ups",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/dumbbell box step ups.mp4"},{name:"Skater Jumps",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/lower/skater jumps.mp4"},{name:"Dumbbell Reverse Lunges",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/dumbbell reverse lunges.mp4"},{name:"Weighted Calf Raises",type:"weighted",sets:4,reps:15,storagePath:"exercises/dumbbells/lower/weighted calf raises.mp4"}]}],core:[{id:"core_lower_abs",name:"Lower Abs Blast",desc:"40s work / 20s rest  3 rounds",level:"Intermediate",overview:"An interval-based core burner targeting the lower abdominals. 40 seconds of work followed by 20 seconds of rest  keep the intensity high and your lower back pressed into the floor throughout.",tips:["Press your lower back firmly into the floor on every rep","Exhale hard as you contract your abs  don't hold your breath","If your lower back lifts off the ground, reduce the range of motion","Focus on slow, controlled movements rather than speed"],interval:!0,rounds:3,work:40,rest:20,exercises:[{name:"Leg Raises",storagePath:"exercises/bodyweight/core/Leg Raises.mp4"},{name:"Reverse Crunch To Leg Raise",storagePath:"exercises/bodyweight/core/Reverse Crunch To Leg Raise.mp4"},{name:"Flutter Kicks",storagePath:"exercises/bodyweight/core/Flutter Kicks.mp4"},{name:"Dead Bug Single Leg Drop",storagePath:"exercises/bodyweight/core/Dead Bug Single Leg Drop.mp4"},{name:"Hollow Body Hold",storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"},{name:"Hollow Hold Flutter Kicks",storagePath:"exercises/bodyweight/core/Hollow Hold Flutter Kicks.mp4"}]},{id:"core_obliques",name:"Obliques & Rotation",desc:"35s work / 25s rest  3 rounds",level:"Intermediate",overview:"Target the obliques and rotational core muscles with this interval session. 35 seconds of work with 25 seconds rest  every exercise involves twisting, rotating, or side-bracing movements.",tips:["Rotate from your ribcage, not just your arms","Keep your hips as still as possible during twisting exercises","Brace your core before each movement  think about squeezing a belt","On side planks, stack your hips and push the floor away"],interval:!0,rounds:3,work:35,rest:25,exercises:[{name:"Russian Twist",storagePath:"exercises/bodyweight/core/Russian Twist.mp4"},{name:"Side Plank Rotation",storagePath:"exercises/bodyweight/core/Side Plank Rotation.mp4"},{name:"Cross Body Mountain Climbers",storagePath:"exercises/bodyweight/core/Cross Body Mountain Climbers.mp4"},{name:"Hip Dips Plank",storagePath:"exercises/bodyweight/core/Hip Dips Plank.mp4"},{name:"Bicycle Crunch",storagePath:"exercises/bodyweight/core/Bicycle Crunch.mp4"},{name:"Side Plank",storagePath:"exercises/bodyweight/core/Side Plank.mp4"}]},{id:"core_weighted",name:"Weighted Core",desc:"40s work / 20s rest  3 rounds",level:"Advanced",overview:"Add resistance to your core training with dumbbells and kettlebells. 40 seconds of weighted work followed by 20 seconds rest  this session builds serious core strength and stability.",tips:["Start with a moderate weight  form is more important than load","Brace your entire core before picking up the weight each round","Keep movements controlled  no swinging or using momentum","If grip fails before core does, go slightly lighter next time"],interval:!0,rounds:3,work:40,rest:20,exercises:[{name:"Russian Twists Dumbbell",storagePath:"exercises/dumbbells/core/russian twists dumbbell.mp4"},{name:"Kettlebell Russian Twist",storagePath:"exercises/kettlebells/core/kettlebell russian twist.mp4"},{name:"Kettlebell Side Bends",storagePath:"exercises/kettlebells/core/kettlebell side bends.mp4"},{name:"Kneeling Kettlebell Halo",storagePath:"exercises/kettlebells/core/kneeling kettlebell halo.mp4"},{name:"Kettlebell Bird Dog Drag",storagePath:"exercises/kettlebells/core/kettlebell bird dog drag.mp4"},{name:"Dumbbell Plank Pull Through",storagePath:null}]}]},g2=[{key:"bodyweight",label:"Bodyweight",icon:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 3c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm0 14.2c-2.5 0-4.71-1.28-6-3.22.03-1.99 4-3.08 6-3.08 1.99 0 5.97 1.09 6 3.08-1.29 1.94-3.5 3.22-6 3.22z"},{key:"dumbbells",label:"Dumbbells",icon:"M1 9h2v6H1V9zm3-2h2v10H4V7zm3 4h10v2H7v-2zm10-4h2v10h-2V7zm3 2h2v6h-2V9z"},{key:"kettlebells",label:"Kettlebells",icon:"M12 2C9.24 2 7 4.24 7 7c0 1.1.36 2.12.97 2.95C6.76 11.08 6 12.96 6 15c0 3.87 2.69 7 6 7s6-3.13 6-7c0-2.04-.76-3.92-1.97-5.05.61-.83.97-1.85.97-2.95 0-2.76-2.24-5-5-5zm0 2c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3z"}],Hp=[{key:"core",label:"Core",icon:"M12 2a4 4 0 0 1 4 4v1h-2V6a2 2 0 1 0-4 0v1H8V6a4 4 0 0 1 4-4zM8 9h8v2H8V9zm-1 4h10l-1 9H8l-1-9z"},{key:"upper",label:"Upper",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm8 10l-3-1.5c-.5-.25-1-.5-1.5-.5h-7c-.5 0-1 .25-1.5.5L4 12l-2 6h4l1.5 4h9L18 18h4l-2-6z"},{key:"lower",label:"Lower",icon:"M16.5 3A2.5 2.5 0 0 0 14 5.5 2.5 2.5 0 0 0 16.5 8 2.5 2.5 0 0 0 19 5.5 2.5 2.5 0 0 0 16.5 3zM14 9l-3 7h2l1 6h2l1-6h2l-3-7h-2z"},{key:"fullbody",label:"Full Body",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm-2 8h4l1 4h2l-1 4h-2l-1 4h-2l-1-4H8l-1-4h2l1-4z"},{key:"mix",label:"Mix It Up",icon:"M10.59 9.17L5.41 4 4 5.41l5.17 5.17 1.42-1.41zM14.5 4l2.04 2.04L4 18.59 5.41 20 17.96 7.46 20 9.5V4h-5.5zm-.83 9.41l-1.42 1.42L17.96 20.54l1.42-1.42-5.71-5.71z"}],El=[{key:"beginner",label:"Beginner",work:30,rest:30,desc:"30s work / 30s rest"},{key:"intermediate",label:"Intermediate",work:40,rest:20,desc:"40s work / 20s rest"},{key:"advanced",label:"Advanced",work:40,rest:15,desc:"40s work / 15s rest"}],dD=[5,10,15,20,30];function fD(s){return s.replace(/\b\w/g,e=>e.toUpperCase())}function mD(s){const e=[...s];for(let t=e.length-1;t>0;t--){const i=Math.floor(Math.random()*(t+1));[e[t],e[i]]=[e[i],e[t]]}return e}function pD(){const{currentUser:s,isClient:e,clientData:t,loading:i}=Qr(),{isDark:l,toggleTheme:u,accent:h}=Ma(),p=nr(),[g,y]=x.useState("menu"),[w,k]=x.useState(["bodyweight"]),[j,O]=x.useState("core"),[$,U]=x.useState("intermediate"),[L,ne]=x.useState(15),[Z,ye]=x.useState([]),[je,We]=x.useState(!1),Be=x.useRef(!1),R=x.useRef([]),[S,I]=x.useState([]),[V,P]=x.useState(2),[F,M]=x.useState(El[1]),[He,xt]=x.useState(1),[z,fe]=x.useState(0),[Ie,Ge]=x.useState("work"),[J,D]=x.useState(0),[W,be]=x.useState(!1),[Ne,qe]=x.useState(0),[Ae,rt]=x.useState(null),pt=x.useRef(null);x.useRef(null),x.useRef(null);const[Ze,Ht]=x.useState(null),cn=x.useCallback((G,he="info")=>{Ht({message:G,type:he}),setTimeout(()=>Ht(null),3e3)},[]),[Nt,Ct]=x.useState(null),[le,gn]=x.useState(null),[$t,St]=x.useState(0),[Bt,ht]=x.useState(0),[et,en]=x.useState([]),[rs,Lt]=x.useState(""),[Et,Pn]=x.useState(""),[Ft,En]=x.useState(!1),[Kt,Sn]=x.useState(0),[me,Se]=x.useState(!1),[Fe,Qe]=x.useState({}),Ue=x.useRef(null),De=x.useRef(null),[Oe,wt]=x.useState([]),[ft,Q]=x.useState(null),[Ee,Xe]=x.useState(0),[Je,dt]=x.useState(0),[qt,Rt]=x.useState(0),[tn,Vn]=x.useState(0),[An,sn]=x.useState(0),[yn,In]=x.useState(0),[un,as]=x.useState({beginner:0,intermediate:0,advanced:0}),[H,pe]=x.useState(null),[_e,xe]=x.useState(""),[ge,at]=x.useState(!1);x.useEffect(()=>{!i&&(!s||!e)&&p("/")},[s,e,i,p]),x.useEffect(()=>{if(!s||!t)return;(async()=>{try{const he=Wt(ve,"workoutLogs"),ie=Rn(he,ln("clientId","==",t.id)),Le=(await Tn(ie)).docs.map(wn=>wn.data()),it=Le.filter(wn=>wn.type!=="programme");Vn(it.length);const It=it.reduce((wn,ts)=>wn+(ts.duration||0),0);sn(It);const lt={beginner:0,intermediate:0,advanced:0};it.forEach(wn=>{wn.level&&lt[wn.level]!==void 0&&lt[wn.level]++}),as(lt);const rn=new Date,Un=rn.getDay(),vn=Un===0?-6:1-Un,xn=new Date(rn);xn.setDate(rn.getDate()+vn),xn.setHours(0,0,0,0);const wr=xn.getTime(),Da=Le.filter(wn=>{const ts=wn.completedAt;return ts?(ts.toDate?ts.toDate().getTime():new Date(ts).getTime())>=wr:!1});Xe(Da.filter(wn=>wn.type!=="programme").length);let Xr=0;if(t)try{const wn=await Ln(Ke(ve,"clientProgrammes",t.id));if(wn.exists()){const ts=wn.data(),Gn=ts.templateId;Xr=Da.filter(Ms=>Ms.type==="programme"&&Ms.programmeId===Gn).length,pe(Gn);const kr=qp.find(Ms=>Ms.id===Gn);kr&&xe(kr.name);const hr=uD[Gn];if(hr){const Ms=Object.keys(ts.completedSessions||{}).length,Vs=hr.duration*hr.daysPerWeek;Rt(Vs>0?Math.round(Ms/Vs*100):0)}}else pe(null),xe(""),Rt(0)}catch{}dt(Xr);const _r=it.map(wn=>wn.completedAt).filter(Boolean).map(wn=>wn.toDate?wn.toDate().getTime():new Date(wn).getTime()).sort((wn,ts)=>ts-wn);if(_r.length===0)In(0);else{const wn=new Set;_r.forEach(Vs=>{const Lr=new Date(Vs),Tr=Lr.getDay(),fa=Tr===0?-6:1-Tr,A=new Date(Lr);A.setDate(Lr.getDate()+fa),A.setHours(0,0,0,0),wn.add(A.getTime())});const ts=[...wn].sort((Vs,Lr)=>Lr-Vs);let Gn=0;const kr=new Date(rn),hr=rn.getDay()===0?-6:1-rn.getDay();kr.setDate(rn.getDate()+hr),kr.setHours(0,0,0,0);let Ms=kr.getTime();ts.includes(Ms)||(Ms-=10080*60*1e3);for(let Vs=0;Vs<200&&ts.includes(Ms);Vs++)Gn++,Ms-=10080*60*1e3;In(Gn)}}catch(he){console.error("Error loading workout stats:",he)}finally{at(!0)}})()},[s,t,g]);const At=()=>{const G=[];let he;j==="mix"?he=["core","upper","lower"]:j==="fullbody"?he=["upper","lower"]:he=[j];for(const ie of w)for(const Ce of he)G.push(`exercises/${ie}/${Ce}`);return G},ct=async()=>{if(Be.current){for(;Be.current;)await new Promise(G=>setTimeout(G,200));return R.current}Be.current=!0,We(!0);try{const G=At(),he=[];for(const it of G)try{const It=Gi(Ki,it),lt=await d2(It);he.push(...lt.items)}catch{console.warn(`Folder ${it} not found, skipping.`)}if(he.length===0&&w.includes("bodyweight")&&j==="core")try{const it=Gi(Ki,"core"),It=await d2(it);he.push(...It.items)}catch{console.warn("Legacy core/ folder not found either.")}if(he.length===0){const it=w.map(lt=>g2.find(rn=>rn.key===lt)?.label).join(" + "),It=Hp.find(lt=>lt.key===j)?.label;return cn(`No exercises found for ${it} / ${It}. Upload videos to Firebase Storage.`,"error"),Be.current=!1,We(!1),[]}const ie=new Set,Ce=he.filter(it=>{const It=it.name.replace(/\.(mp4|gif)$/i,"");return ie.has(It)?!1:(ie.add(It),!0)}),Le=await Promise.all(Ce.map(async it=>{const It=await Lo(it),lt=fD(it.name.replace(/\.(mp4|gif)$/i,"")),rn=/\.gif$/i.test(it.name);return{name:lt,videoUrl:It,isGif:rn}}));return R.current=Le,ye(Le),Be.current=!1,We(!1),Le}catch(G){console.error("Error loading exercises:",G);const he=G.code==="storage/unauthorized"?"Storage access denied. Check Firebase Storage rules allow read access.":`Failed to load exercises: ${G.message||G.code||"Unknown error"}`;return cn(he,"error"),Be.current=!1,We(!1),[]}},_t=async()=>{y("spinning"),R.current=[];const G=await ct();if(G.length===0){y("setup");return}const he=El.find(Un=>Un.key===$);M(he);const ie=he.work+he.rest,Ce=L*60,Le=Math.floor(Ce/ie);let it,It;Le<=6?(it=Math.max(3,Math.floor(Le/2)),It=Math.floor(Le/it)):Le<=12?(it=Math.min(6,Math.floor(Le/2)),It=Math.floor(Le/it)):(it=Math.min(10,Math.floor(Le/2)),It=Math.floor(Le/it)),It=Math.max(2,It);const lt=mD(G),rn=lt.slice(0,Math.min(it,lt.length));I(rn),P(It),setTimeout(()=>y("preview"),2e3)},bt=()=>{y("countdown"),qe(3)};x.useEffect(()=>{if(g!=="countdown")return;if(Ne<=0){y("workout"),xt(1),fe(0),Ge("work"),D(F.work),be(!1),ze();return}$e();const G=setTimeout(()=>qe(he=>he-1),1e3);return()=>clearTimeout(G)},[Ne,g]),x.useEffect(()=>{if(g!=="workout"||W)return;if(J<=0){bn();return}J<=3&&$e();const G=setTimeout(()=>D(he=>he-1),1e3);return()=>clearTimeout(G)},[J,g,W]);const bn=()=>{if(Ie==="work")Ge("rest"),D(F.rest);else{const G=z+1;if(G>=S.length){const he=He+1;if(he>V){y("complete"),sr();return}xt(he),fe(0)}else fe(G);Ge("work"),D(F.work),ze()}},sr=async()=>{if(s)try{await ai(Wt(ve,"workoutLogs"),{clientId:t.id,level:$,duration:L,equipment:w,focus:j,exerciseCount:S.length,rounds:V,exercises:S.map(G=>G.name),completedAt:vt.now()}),Xe(G=>G+1),Vn(G=>G+1),sn(G=>G+L),as(G=>({...G,[$]:(G[$]||0)+1}))}catch(G){console.error("Error saving workout log:",G)}},Ts=async(G,he,ie)=>{if(!(!t||!he))try{const Ce=t.id,Le=await Ln(Ke(ve,"coreBuddyPBs",Ce)),It=(Le.exists()?Le.data():null)?.exercises||{},lt=It[G];let rn=!1;if(lt?(he>(lt.weight||0)||he===(lt.weight||0)&&ie>(lt.reps||0))&&(rn=!0):rn=!0,rn){const Un={...It,[G]:{weight:he,reps:ie,achievedAt:vt.now()}};await Wn(Ke(ve,"coreBuddyPBs",Ce),{clientId:t.id,exercises:Un,updatedAt:vt.now()}),cn(`New PB! ${he}kg  ${ie} reps`,"success"),$e(),await Os(G,he)}}catch(Ce){console.error("Error checking PB:",Ce)}},Os=async(G,he)=>{if(t)try{const ie=await Ln(Ke(ve,"coreBuddyTargets",t.id));if(!ie.exists())return;const Le=(ie.data().targets||{})[G];if(!Le||he<Le.targetWeight)return;const it=await Ln(Ke(ve,"coreBuddyAchievements",t.id)),It=it.exists()?it.data():{clientId:t.id,badges:[],totalVolume:0};if(It.badges.some(vn=>vn.type==="pb_target"&&vn.exercise===G&&vn.targetWeight===Le.targetWeight))return;const rn={type:"pb_target",exercise:G,group:cD[G]||"push",targetWeight:Le.targetWeight,achievedAt:vt.now()},Un=[...It.badges,rn];await Wn(Ke(ve,"coreBuddyAchievements",t.id),{...It,badges:Un,updatedAt:vt.now()}),wt(vn=>[...vn,rn])}catch(ie){console.error("Error checking target badge:",ie)}},Bn=async G=>{if(!(!t||G<=0))try{const he=await Ln(Ke(ve,"coreBuddyAchievements",t.id)),ie=he.exists()?he.data():{clientId:t.id,badges:[],totalVolume:0},Ce=ie.totalVolume||0,Le=Ce+G,it=[];lD.forEach(lt=>{Le>=lt.threshold&&Ce<lt.threshold&&(ie.badges.some(Un=>Un.type==="volume_milestone"&&Un.milestone===lt.threshold)||it.push({type:"volume_milestone",milestone:lt.threshold,label:lt.label,achievedAt:vt.now()}))});const It=[...ie.badges,...it];await Wn(Ke(ve,"coreBuddyAchievements",t.id),{clientId:t.id,badges:It,totalVolume:Math.round(Le),updatedAt:vt.now()}),it.length>0&&wt(lt=>[...lt,...it])}catch(he){console.error("Error updating volume:",he)}},q=async G=>{if(gn(G),G.interval){const Ce=[];for(const Le of G.exercises){let it=null,It=!1;if(Le.storagePath)try{const lt=Gi(Ki,Le.storagePath);it=await Lo(lt),It=/\.gif$/i.test(Le.storagePath)}catch{}Ce.push({name:Le.name,videoUrl:it,isGif:It})}I(Ce),P(G.rounds),M({work:G.work,rest:G.rest}),y("preview");return}const he={};for(const Ce of G.exercises)if(Ce.storagePath)try{const Le=Gi(Ki,Ce.storagePath);he[Ce.name]={url:await Lo(Le),isGif:/\.gif$/i.test(Ce.storagePath)}}catch{}Qe(he);const ie=G.exercises.map(Ce=>({name:Ce.name,type:Ce.type,targetSets:Ce.sets,targetReps:Ce.reps||0,targetTime:Ce.time||0,sets:[]}));en(ie),St(0),ht(0),Lt(""),Pn(""),Se(!1),En(!1),Sn(0),wt([]),Q(null),y("muscle_workout")},ce=()=>{const G=Ue.current;G&&(G.paused?(G.play(),Se(!0)):(G.pause(),Se(!1)))};x.useEffect(()=>{if(g!=="muscle_workout"||!Ft||Kt<=0){g==="muscle_workout"&&Ft&&Kt<=0&&(En(!1),$e());return}return De.current=setTimeout(()=>Sn(G=>G-1),1e3),()=>clearTimeout(De.current)},[g,Ft,Kt]);const T=async()=>{const G=et[$t];let he={};if(G.type==="weighted"){const Le=parseFloat(rs)||0,it=parseInt(Et)||0;if(it===0){cn("Enter your reps","error");return}he={weight:Le,reps:it}}else if(G.type==="reps"){const Le=parseInt(Et)||0;if(Le===0){cn("Enter your reps","error");return}he={reps:Le}}else if(G.type==="timed"){const Le=G.targetTime-Kt;he={time:Math.max(Le,1)}}const ie=[...et];ie[$t]={...G,sets:[...G.sets,he]},en(ie),G.type==="weighted"&&he.weight>0&&await Ts(G.name,he.weight,he.reps);const Ce=G.sets.length+1;if(Ce<G.targetSets)ht(Ce),Pn(""),En(!1),Sn(0);else if($t+1<et.length){const Le=$t+1;St(Le),ht(0),Lt(""),Pn(""),Se(!1),En(!1),Sn(0)}else await C(ie),y("muscle_complete")},C=async G=>{if(!(!s||!t))try{const he=G.reduce((Ce,Le)=>Ce+Le.sets.reduce((it,It)=>it+(It.weight||0)*(It.reps||0),0),0),ie=G.reduce((Ce,Le)=>Ce+Le.sets.length,0);await ai(Wt(ve,"workoutLogs"),{clientId:t.id,type:"muscle_group",muscleGroup:Nt,sessionId:le?.id,sessionName:le?.name,exerciseCount:G.length,totalSets:ie,duration:Math.round(ie*1.5),volume:Math.round(he),exercises:G.map(Ce=>({name:Ce.name,type:Ce.type,sets:Ce.sets})),completedAt:vt.now()}),he>0&&await Bn(he),Oe.length>0&&Q({badges:[...Oe]})}catch(he){console.error("Error saving muscle group workout log:",he)}},Y=x.useRef(null),se=()=>(Y.current||(Y.current=new(window.AudioContext||window.webkitAudioContext)),Y.current),$e=()=>{try{const G=se(),he=G.createOscillator(),ie=G.createGain();he.connect(ie),ie.connect(G.destination),he.frequency.value=880,ie.gain.value=.3,he.start(G.currentTime),he.stop(G.currentTime+.15)}catch{}},ze=()=>{try{const G=se(),he=G.createOscillator(),ie=G.createGain();he.connect(ie),ie.connect(G.destination),he.frequency.value=1200,ie.gain.value=.4,he.start(G.currentTime),he.stop(G.currentTime+.3)}catch{}};x.useEffect(()=>{if(g!=="workout"||Ie!=="work"||!S[z]?.isGif)return;const he=setInterval(()=>{const ie=pt.current;if(!ie)return;const Ce=ie.getAttribute("src");ie.removeAttribute("src"),setTimeout(()=>{pt.current&&pt.current.setAttribute("src",Ce)},0)},4e3);return()=>clearInterval(he)},[g,Ie,z,He,S]);const Ve=(G,he,ie)=>{const Ce=Math.round(G/he*oD);return a.jsx("svg",{className:"wk-ring-svg",viewBox:"0 0 200 200",children:MM.map((Le,it)=>a.jsx("line",{x1:Le.x1,y1:Le.y1,x2:Le.x2,y2:Le.y2,className:it<Ce?`wk-tick-filled ${ie}`:"wk-tick-empty",strokeWidth:Le.thick?"3":"2"},it))})},Ut=()=>{const G=S.length*V;return((He-1)*S.length+z+(Ie==="rest"?.5:0))/G},kt=Ze&&a.jsx("div",{className:`toast-notification ${Ze.type}`,children:Ze.message});if(i)return a.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":h,children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>p("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})]})}),a.jsx("div",{className:"wk-loading-inline",children:a.jsx("div",{className:"wk-loading-spinner"})})]});if(g==="menu")return a.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":h,children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>p("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"wk-main",children:[a.jsxs("div",{className:"wk-menu-heading",children:[a.jsx("h2",{children:"Choose Your Workout"}),a.jsx("p",{children:"No excuses. Just results."})]}),a.jsx("button",{className:"wk-hero-card",onClick:()=>y("setup"),children:a.jsx("img",{src:m2,alt:"Randomise Workout",className:"wk-hero-bg"})}),a.jsxs("div",{className:"wk-section-header",children:[a.jsx("h2",{children:"Programmes"}),a.jsxs("span",{className:"wk-section-count",children:[qp.length," available"]})]}),a.jsx("div",{className:"wk-prog-scroll-wrap",children:a.jsx("div",{className:"wk-prog-scroll",children:qp.map((G,he)=>G.image?a.jsxs("button",{className:"wk-prog-img-card",onClick:()=>p("/client/core-buddy/programmes",{state:{templateId:G.id}}),style:{animationDelay:`${he*.06}s`},children:[a.jsx("img",{src:G.image,alt:G.name,className:"wk-prog-img"}),he===0&&a.jsx("div",{className:"wk-swipe-arrow",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})})]},G.id):a.jsxs("button",{className:"wk-prog-hero-card",onClick:()=>p("/client/core-buddy/programmes",{state:{templateId:G.id}}),style:{animationDelay:`${he*.06}s`},children:[a.jsx("img",{src:rD,alt:"Programme",className:"wk-prog-hero-bg",loading:"lazy"}),a.jsx("div",{className:"wk-prog-hero-overlay",style:{background:hD[G.focus]}}),a.jsxs("div",{className:"wk-prog-hero-content",children:[a.jsxs("div",{className:"wk-prog-hero-top",children:[a.jsxs("span",{className:"wk-prog-hero-badge",children:[G.duration," WEEKS"]}),a.jsx("span",{className:"wk-prog-hero-level",children:G.level})]}),a.jsxs("div",{className:"wk-prog-hero-bottom",children:[a.jsx("h3",{children:G.name.toUpperCase()}),a.jsxs("p",{children:[G.daysPerWeek,"x per week  ",G.focus==="fullbody"?"Full Body":G.focus.charAt(0).toUpperCase()+G.focus.slice(1)," Focus"]}),a.jsx("span",{className:"wk-prog-hero-go",children:"VIEW PROGRAMME "})]})]}),he===0&&a.jsx("div",{className:"wk-swipe-arrow",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})})]},G.id))})}),a.jsxs("div",{className:"wk-section-header",children:[a.jsx("h2",{children:"Muscle Groups"}),a.jsxs("span",{className:"wk-section-count",children:[Hc.length," groups"]})]}),a.jsx("div",{className:"wk-muscle-grid",children:Hc.map((G,he)=>a.jsx("button",{className:`wk-muscle-hero-card${G.image?" wk-muscle-thumb":""}`,onClick:()=>{Ct(G.key),y("muscle_sessions")},style:{animationDelay:`${he*.05}s`},children:G.image?a.jsx("img",{src:G.image,alt:G.label,className:"wk-muscle-thumb-img"}):a.jsxs(a.Fragment,{children:[a.jsx("img",{src:m2,alt:"Muscle group",className:"wk-muscle-hero-bg",loading:"lazy"}),a.jsx("div",{className:"wk-muscle-hero-overlay",style:{background:Fp[G.key]}}),a.jsxs("div",{className:"wk-muscle-hero-content",children:[a.jsx("div",{className:"wk-muscle-hero-icon",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:G.icon})})}),a.jsxs("div",{className:"wk-muscle-hero-text",children:[a.jsx("span",{className:"wk-muscle-hero-name",children:G.label}),a.jsxs("span",{className:"wk-muscle-hero-count",children:[p2[G.key]?.length||0," sessions"]})]})]})]})},G.key))})]}),a.jsx(Aa,{active:"workouts"}),kt]});if(g==="setup"){const G=Hp.find(ie=>ie.key===j)?.label||j,he=El.find(ie=>ie.key===$)?.label||$;return a.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":h,children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>y("menu"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"wk-main wk-setup-main",children:[a.jsx("div",{className:"wk-stats-row",children:[{label:"Total",value:`${tn}`,pct:tn>0?Math.min(Math.round(tn/100*100),100):0,color:"#14b8a6",size:"normal"},{label:"This Week",value:`${Ee}/${zp}`,pct:Math.round(Math.min(Ee,zp)/zp*100),color:"var(--color-primary)",size:"large"},{label:"Wk Streak",value:`${yn}`,pct:yn>0?Math.min(Math.round(yn/12*100),100):0,color:"#38B6FF",size:"normal"}].map(ie=>{const Le=2*Math.PI*38,it=Le-ie.pct/100*Le;return a.jsxs("div",{className:`wk-stat-item${ie.size==="large"?" wk-stat-large":""}`,children:[a.jsxs("div",{className:"wk-stat-ring",children:[a.jsxs("svg",{viewBox:"0 0 100 100",children:[a.jsx("circle",{className:"wk-stat-track",cx:"50",cy:"50",r:38}),a.jsx("circle",{className:"wk-stat-fill",cx:"50",cy:"50",r:38,style:{stroke:ie.color},strokeDasharray:Le,strokeDashoffset:it})]}),a.jsx("span",{className:"wk-stat-value",style:{color:ie.color},children:ie.value})]}),a.jsx("span",{className:"wk-stat-label",children:ie.label})]},ie.label)})}),a.jsxs("div",{className:"wk-setup-flow",children:[a.jsxs("div",{className:"wk-setup-section",children:[a.jsx("h2",{children:"Focus Area"}),a.jsx("div",{className:"wk-focus-grid",children:Hp.map(ie=>a.jsxs("button",{className:`wk-equip-btn${j===ie.key?" active":""}${ie.key==="mix"?" wk-mix-btn":""}`,onClick:()=>O(ie.key),children:[a.jsx("svg",{className:"wk-equip-icon",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:ie.icon})}),a.jsx("span",{children:ie.label})]},ie.key))})]}),a.jsxs("div",{className:"wk-setup-section",children:[a.jsx("h2",{children:"Level"}),a.jsx("div",{className:"wk-level-cards",children:El.map(ie=>a.jsxs("button",{className:`wk-level-card wk-level-${ie.key}${$===ie.key?" active":""}`,onClick:()=>U(ie.key),children:[a.jsx("span",{className:"wk-level-name",children:ie.label}),a.jsx("span",{className:"wk-level-desc",children:ie.desc})]},ie.key))})]}),a.jsxs("div",{className:"wk-setup-section",children:[a.jsx("h2",{children:"Time"}),a.jsx("div",{className:"wk-time-options",children:dD.map(ie=>a.jsxs("button",{className:`wk-time-btn${L===ie?" active":""}`,onClick:()=>ne(ie),children:[a.jsx("span",{className:"wk-time-num",children:ie}),a.jsx("span",{className:"wk-time-unit",children:"min"})]},ie))})]}),a.jsxs("div",{className:"wk-setup-section",children:[a.jsx("h2",{children:"Equipment"}),a.jsx("div",{className:"wk-equip-options",children:g2.map(ie=>{const Ce=w.includes(ie.key);return a.jsxs("button",{className:`wk-equip-btn${Ce?" active":""}`,onClick:()=>{k(Le=>Ce&&Le.length===1?Le:Ce?Le.filter(it=>it!==ie.key):[...Le,ie.key])},children:[a.jsx("svg",{className:"wk-equip-icon",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:ie.icon})}),a.jsx("span",{children:ie.label})]},ie.key)})})]}),a.jsx("div",{className:"wk-setup-summary",children:a.jsxs("span",{children:[G,"  ",he,"  ",L," min"]})})]})]}),a.jsx("div",{className:"wk-go-sticky",children:a.jsx("button",{className:"wk-randomise-btn",onClick:_t,disabled:je,children:je?"Loading exercises...":"Randomise Workout"})}),kt]})}if(g==="spinning")return a.jsxs("div",{className:"wk-page wk-page-center","data-theme":l?"dark":"light","data-accent":h,children:[a.jsxs("div",{className:"wk-spin-container",children:[a.jsxs("div",{className:"wk-spin-ring",children:[a.jsx("svg",{className:"wk-spin-svg",viewBox:"0 0 200 200",children:ru.map((G,he)=>a.jsx("line",{x1:G.x1,y1:G.y1,x2:G.x2,y2:G.y2,className:"wk-spin-tick",strokeWidth:G.thick?"3.5":"2",style:{animationDelay:`${he*.03}s`}},he))}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"wk-spin-logo",width:"50",height:"50"})]}),a.jsx("p",{className:"wk-spin-text",children:"Generating workout..."})]}),kt]});if(g==="preview"){const G=le?.interval?{work:le.work,rest:le.rest}:El.find(ie=>ie.key===$),he=S.length*V*(G.work+G.rest);return a.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":h,children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>y(le?.interval?"muscle_sessions":"setup"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"wk-main",children:[le?.interval&&a.jsx("h2",{className:"mg-preview-title",children:le.name}),a.jsxs("div",{className:"wk-preview-stats",children:[a.jsxs("div",{className:"wk-stat",children:[a.jsx("span",{className:"wk-stat-val",children:S.length}),a.jsx("span",{className:"wk-stat-label",children:"Exercises"})]}),a.jsxs("div",{className:"wk-stat",children:[a.jsx("span",{className:"wk-stat-val",children:V}),a.jsx("span",{className:"wk-stat-label",children:"Rounds"})]}),a.jsxs("div",{className:"wk-stat",children:[a.jsx("span",{className:"wk-stat-val",children:Math.ceil(he/60)}),a.jsx("span",{className:"wk-stat-label",children:"Minutes"})]}),a.jsxs("div",{className:"wk-stat",children:[a.jsxs("span",{className:"wk-stat-val",children:[G.work,"/",G.rest]}),a.jsx("span",{className:"wk-stat-label",children:"Work/Rest"})]})]}),a.jsx("div",{className:"wk-preview-list",children:S.map((ie,Ce)=>a.jsxs("div",{className:"wk-preview-item",style:{animationDelay:`${Ce*.06}s`},onClick:()=>rt(ie),children:[a.jsx("span",{className:"wk-preview-num",children:Ce+1}),a.jsx("div",{className:"wk-preview-thumb",children:ie.isGif?a.jsx("img",{src:ie.videoUrl,alt:ie.name,loading:"lazy"}):a.jsx("video",{src:`${ie.videoUrl}#t=0.1`,muted:!0,playsInline:!0,preload:"auto"})}),a.jsx("span",{className:"wk-preview-name",children:ie.name}),a.jsx("svg",{className:"wk-preview-play",width:"22",height:"22",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})})]},Ce))}),Ae&&a.jsx("div",{className:"wk-preview-modal-backdrop",onClick:()=>rt(null),children:a.jsxs("div",{className:"wk-preview-modal",onClick:ie=>ie.stopPropagation(),children:[a.jsx("button",{className:"wk-preview-modal-close",onClick:()=>rt(null),"aria-label":"Close preview",children:a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})}),a.jsx("div",{className:"wk-preview-modal-video",children:Ae.isGif?a.jsx("img",{src:Ae.videoUrl,alt:Ae.name}):a.jsx("video",{src:Ae.videoUrl,autoPlay:!0,loop:!0,muted:!0,playsInline:!0})}),a.jsx("h3",{className:"wk-preview-modal-title",children:Ae.name})]})}),a.jsxs("div",{className:"wk-preview-actions",children:[!le?.interval&&a.jsxs("button",{className:"wk-btn-secondary",onClick:()=>_t(),children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("polyline",{points:"1 4 1 10 7 10"}),a.jsx("path",{d:"M3.51 15a9 9 0 1 0 2.13-9.36L1 10"})]}),"Reshuffle"]}),a.jsx("button",{className:"wk-btn-primary",onClick:bt,children:"Start Workout"})]})]})]})}if(g==="countdown")return a.jsx("div",{className:"wk-page wk-page-center wk-page-dark","data-theme":l?"dark":"light","data-accent":h,children:a.jsxs("div",{className:"wk-countdown-big",children:[a.jsx("span",{className:"wk-countdown-num",children:Ne}),a.jsx("span",{className:"wk-countdown-label",children:"GET READY"})]})});if(g==="workout"){const G=S[z],he=Ie==="work"?F.work:F.rest,ie=Ie==="rest"?z+1<S.length?S[z+1]:He<V?S[0]:null:null;return a.jsxs("div",{className:"wk-page wk-page-workout","data-theme":l?"dark":"light","data-accent":h,children:[a.jsx("div",{className:"wk-video-container",children:Ie==="work"?G.isGif?a.jsx("img",{ref:pt,className:"wk-video",src:G.videoUrl,alt:G.name},G.videoUrl):a.jsx("video",{className:"wk-video",src:G.videoUrl,autoPlay:!0,loop:!0,muted:!0,playsInline:!0},G.videoUrl):a.jsxs("div",{className:"wk-rest-screen",children:[a.jsx("span",{className:"wk-rest-label",children:"REST"}),ie&&a.jsxs("span",{className:"wk-next-label",children:["Next: ",ie.name]})]})}),a.jsx("div",{className:"wk-back-row",children:a.jsxs("button",{className:"wk-back-btn",onClick:()=>{confirm("Leave workout?")&&y("menu")},children:[a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})}),"Back"]})}),a.jsx("div",{className:"wk-spotify",children:a.jsx("iframe",{src:"https://open.spotify.com/embed/playlist/37i9dQZF1DZ06evO3FJyYF?utm_source=generator&theme=0",width:"100%",height:"80",frameBorder:"0",allow:"autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture",loading:"lazy",title:"Spotify Playlist"})}),a.jsxs("div",{className:"wk-exercise-info",children:[a.jsxs("span",{className:"wk-exercise-counter",children:[z+1," / ",S.length]}),a.jsx("h2",{className:"wk-exercise-name",children:G.name}),a.jsxs("span",{className:"wk-round-label",children:["Round ",He," of ",V]})]}),a.jsx("div",{className:"wk-timer-section",children:a.jsxs("div",{className:"wk-timer-ring-wrap",children:[Ve(J,he,Ie==="work"?"wk-tick-work":"wk-tick-rest"),a.jsxs("div",{className:"wk-timer-center",children:[a.jsx("span",{className:"wk-timer-time",children:J}),a.jsx("span",{className:`wk-timer-phase ${Ie}`,children:Ie==="work"?"WORK":"REST"})]})]})}),a.jsxs("div",{className:"wk-controls",children:[a.jsx("button",{className:"wk-ctrl-btn wk-ctrl-stop",onClick:()=>{confirm("End workout early?")&&y("menu")},children:a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("rect",{x:"4",y:"4",width:"16",height:"16",rx:"2"})})}),a.jsx("button",{className:"wk-ctrl-btn wk-ctrl-pause",onClick:()=>be(!W),children:W?a.jsx("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})}):a.jsxs("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"currentColor",children:[a.jsx("rect",{x:"6",y:"4",width:"4",height:"16"}),a.jsx("rect",{x:"14",y:"4",width:"4",height:"16"})]})}),a.jsx("button",{className:"wk-ctrl-btn wk-ctrl-skip",onClick:()=>{D(0)},children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:[a.jsx("polygon",{points:"5 4 15 12 5 20 5 4"}),a.jsx("rect",{x:"15",y:"4",width:"4",height:"16"})]})})]}),a.jsx("div",{className:"wk-progress-bar",children:a.jsx("div",{className:"wk-progress-fill",style:{width:`${Ut()*100}%`}})})]})}if(g==="complete"){const G=El.find(ie=>ie.key===$),he=S.length*V*(G.work+G.rest);return a.jsx("div",{className:"wk-page wk-page-center","data-theme":l?"dark":"light","data-accent":h,children:a.jsxs("div",{className:"wk-complete",children:[a.jsxs("div",{className:"wk-complete-ring",children:[a.jsx("svg",{className:"wk-complete-svg",viewBox:"0 0 200 200",children:ru.map((ie,Ce)=>a.jsx("line",{x1:ie.x1,y1:ie.y1,x2:ie.x2,y2:ie.y2,className:"wk-tick-complete",strokeWidth:ie.thick?"3.5":"2",style:{animationDelay:`${Ce*.02}s`}},Ce))}),a.jsx("div",{className:"wk-complete-center",children:a.jsx("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"#4caf50",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M20 6L9 17l-5-5"})})})]}),a.jsx("h2",{className:"wk-complete-title",children:"Workout Complete!"}),a.jsxs("div",{className:"wk-complete-stats",children:[a.jsxs("div",{className:"wk-stat",children:[a.jsx("span",{className:"wk-stat-val",children:Math.ceil(he/60)}),a.jsx("span",{className:"wk-stat-label",children:"Minutes"})]}),a.jsxs("div",{className:"wk-stat",children:[a.jsx("span",{className:"wk-stat-val",children:S.length*V}),a.jsx("span",{className:"wk-stat-label",children:"Intervals"})]}),a.jsxs("div",{className:"wk-stat",children:[a.jsx("span",{className:"wk-stat-val",children:V}),a.jsx("span",{className:"wk-stat-label",children:"Rounds"})]})]}),a.jsx("div",{className:"wk-complete-actions",children:a.jsx("button",{className:"wk-btn-primary",onClick:()=>{gn(null),Ct(null),y("menu")},children:"Done"})})]})})}if(g==="muscle_sessions"){const G=Hc.find(ie=>ie.key===Nt),he=p2[Nt]||[];return a.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":h,children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>y("menu"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"wk-main",children:[a.jsxs("div",{className:"mg-sessions-header",children:[a.jsx("div",{className:"mg-sessions-icon",style:{background:Fp[Nt]},children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:G?.icon})})}),a.jsxs("h2",{children:[G?.label," Workouts"]}),a.jsxs("p",{children:[he.length," sessions available"]})]}),a.jsx("div",{className:"mg-sessions-list",children:he.map((ie,Ce)=>a.jsxs("button",{className:"mg-session-card",onClick:()=>{gn(ie),y("muscle_overview")},style:{animationDelay:`${Ce*.08}s`},children:[a.jsxs("div",{className:"mg-session-info",children:[a.jsx("h3",{children:ie.name}),a.jsx("p",{children:ie.desc}),a.jsx("div",{className:"mg-session-meta",children:ie.interval?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"mg-session-tag mg-tag-interval",children:"Interval"}),a.jsxs("span",{className:"mg-session-tag",children:[ie.exercises.length," exercises"]}),a.jsxs("span",{className:"mg-session-tag",children:[ie.rounds," rounds"]})]}):a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"mg-session-tag mg-tag-strength",children:"Strength"}),a.jsxs("span",{className:"mg-session-tag",children:[ie.exercises.length," exercises"]}),a.jsx("span",{className:"mg-session-tag",children:(()=>{const Le=ie.exercises.map(lt=>lt.sets||0),it=Math.min(...Le),It=Math.max(...Le);return it===It?`${it} sets each`:`${it}-${It} sets each`})()})]})})]}),a.jsx("div",{className:"mg-session-arrow",children:a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})})]},ie.id))})]}),kt]})}if(g==="muscle_overview"){const G=le;if(!G)return null;const he=Hc.find(ie=>ie.key===Nt);return a.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":h,children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>y("muscle_sessions"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"wk-main mg-overview-main",children:[a.jsx("div",{className:"mg-overview-hero",style:{background:Fp[Nt]},children:a.jsx("div",{className:"mg-overview-hero-content",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",className:"mg-overview-hero-icon",children:a.jsx("path",{d:he?.icon})})})}),a.jsxs("div",{className:"mg-overview-header",children:[a.jsxs("div",{className:"mg-overview-title-row",children:[a.jsx("h2",{children:G.name}),G.level&&a.jsx("span",{className:"mg-overview-level",children:G.level})]}),a.jsx("p",{className:"mg-overview-desc",children:G.desc})]}),G.overview&&a.jsxs("div",{className:"mg-overview-section",children:[a.jsxs("h3",{children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("path",{d:"M12 16v-4M12 8h.01"})]}),"About This Workout"]}),a.jsx("p",{children:G.overview})]}),G.tips&&G.tips.length>0&&a.jsxs("div",{className:"mg-overview-section",children:[a.jsxs("h3",{children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 1 1 7.072 0l-.548.547A3.374 3.374 0 0 0 14 18.469V19a2 2 0 1 1-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),"Tips & Form"]}),a.jsx("ul",{className:"mg-overview-tips",children:G.tips.map((ie,Ce)=>a.jsx("li",{children:ie},Ce))})]}),a.jsxs("div",{className:"mg-overview-section",children:[a.jsxs("h3",{children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M9 5H7a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-2"}),a.jsx("rect",{x:"9",y:"3",width:"6",height:"4",rx:"1"}),a.jsx("path",{d:"M9 14l2 2 4-4"})]}),"Exercises (",G.exercises.length,")"]}),a.jsx("div",{className:"mg-overview-exercises",children:G.exercises.map((ie,Ce)=>a.jsxs("div",{className:"mg-overview-exercise",children:[a.jsx("span",{className:"mg-overview-ex-num",children:Ce+1}),a.jsxs("div",{className:"mg-overview-ex-info",children:[a.jsx("span",{className:"mg-overview-ex-name",children:ie.name}),G.interval?a.jsxs("span",{className:"mg-overview-ex-detail",children:[G.work,"s work / ",G.rest,"s rest"]}):a.jsxs("span",{className:"mg-overview-ex-detail",children:[ie.sets," sets  ",ie.reps?`${ie.reps} reps`:`${ie.time}s`,ie.type==="weighted"&&"  weighted"]})]})]},Ce))})]}),a.jsxs("button",{className:"mg-overview-start-btn",onClick:()=>q(G),children:[a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M8 5v14l11-7z"})}),"Start Workout"]})]}),kt]})}if(g==="muscle_workout"){const G=le;if(!G)return null;const he=G.exercises[$t],ie=et[$t];if(!he||!ie)return null;const Ce=ie.sets.length,Le=G.exercises.length,it=G.exercises.reduce((vn,xn)=>vn+(xn.sets||0),0),lt=et.reduce((vn,xn)=>vn+xn.sets.length,0)/it*100,rn=Fe[he.name];he.type==="timed"&&Kt===0&&!Ft&&Ce===Bt&&setTimeout(()=>Sn(he.time),0);const Un=Ce+1<he.sets?"Log Set":$t+1<Le?"Log Set  Next Exercise":"Log Set  Complete";return a.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":h,children:[a.jsx("div",{className:"mg-session-progress",children:a.jsx("div",{className:"mg-session-progress-fill",style:{width:`${lt}%`}})}),a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>{confirm("End workout early?")&&y("muscle_overview")},"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsxs("span",{className:"mg-header-info",children:["Exercise ",$t+1,"/",Le]}),a.jsx("div",{style:{width:22}})]})}),a.jsxs("main",{className:"wk-main",children:[rn?a.jsxs("div",{className:"mg-video-container",onClick:ce,children:[rn.isGif?a.jsx("img",{className:"mg-video",src:rn.url,alt:he.name}):a.jsx("video",{ref:Ue,className:"mg-video",src:rn.url,loop:!0,muted:!0,playsInline:!0},he.name),!me&&!rn.isGif&&a.jsxs("div",{className:"mg-video-overlay",children:[a.jsx("svg",{className:"mg-play-icon",width:"48",height:"48",viewBox:"0 0 24 24",fill:"rgba(255,255,255,0.9)",children:a.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})}),a.jsx("span",{className:"mg-video-hint",children:"Tap for demo"})]})]}):a.jsxs("div",{className:"mg-video-placeholder",children:[a.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",opacity:"0.4",children:[a.jsx("rect",{x:"2",y:"2",width:"20",height:"20",rx:"2.18",ry:"2.18"}),a.jsx("line",{x1:"7",y1:"2",x2:"7",y2:"22"}),a.jsx("line",{x1:"17",y1:"2",x2:"17",y2:"22"}),a.jsx("line",{x1:"2",y1:"12",x2:"22",y2:"12"}),a.jsx("line",{x1:"2",y1:"7",x2:"7",y2:"7"}),a.jsx("line",{x1:"2",y1:"17",x2:"7",y2:"17"}),a.jsx("line",{x1:"17",y1:"7",x2:"22",y2:"7"}),a.jsx("line",{x1:"17",y1:"17",x2:"22",y2:"17"})]}),a.jsx("span",{children:"Video coming soon"})]}),a.jsx("div",{className:"wk-spotify",children:a.jsx("iframe",{src:"https://open.spotify.com/embed/playlist/37i9dQZF1DZ06evO3FJyYF?utm_source=generator&theme=0",width:"100%",height:"80",frameBorder:"0",allow:"autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture",loading:"lazy",title:"Spotify Playlist"})}),a.jsxs("div",{className:"mg-exercise-card",children:[a.jsx("h2",{className:"mg-ex-name",children:he.name}),a.jsx("span",{className:`mg-ex-type-badge ${he.type}`,children:he.type==="weighted"?"Weight + Reps":he.type==="reps"?"Reps Only":"Timed"}),a.jsxs("div",{className:"mg-ex-set-info",children:[a.jsxs("span",{className:"mg-ex-set-num",children:["Set ",Ce+1," of ",he.sets]}),he.type!=="timed"&&a.jsxs("span",{className:"mg-ex-target",children:["Target: ",he.reps," reps"]}),he.type==="timed"&&a.jsxs("span",{className:"mg-ex-target",children:["Target: ",he.time,"s"]})]}),he.type==="weighted"&&a.jsxs("div",{className:"mg-input-area",children:[a.jsxs("div",{className:"mg-input-group",children:[a.jsx("label",{children:"Weight (kg)"}),a.jsx("input",{type:"number",inputMode:"decimal",className:"mg-input",value:rs,onChange:vn=>Lt(vn.target.value),placeholder:"0"})]}),a.jsxs("div",{className:"mg-input-group",children:[a.jsx("label",{children:"Reps"}),a.jsx("input",{type:"number",inputMode:"numeric",className:"mg-input",value:Et,onChange:vn=>Pn(vn.target.value),placeholder:"0"})]})]}),he.type==="reps"&&a.jsx("div",{className:"mg-input-area",children:a.jsxs("div",{className:"mg-input-group mg-input-single",children:[a.jsx("label",{children:"Reps"}),a.jsx("input",{type:"number",inputMode:"numeric",className:"mg-input",value:Et,onChange:vn=>Pn(vn.target.value),placeholder:"0"})]})}),he.type==="timed"&&a.jsxs("div",{className:"mg-timer-area",children:[a.jsx("div",{className:"mg-timer-display",children:a.jsxs("span",{className:"mg-timer-value",children:[Kt,"s"]})}),Ft?a.jsx("button",{className:"mg-timer-btn mg-timer-stop",onClick:()=>En(!1),children:"Stop"}):a.jsx("button",{className:"mg-timer-btn",onClick:()=>{Kt===0&&Sn(he.time),En(!0)},children:Kt<he.time&&Kt>0?"Resume":"Start Timer"})]}),a.jsx("button",{className:"mg-log-set-btn",onClick:T,children:Un}),ie.sets.length>0&&a.jsx("div",{className:"mg-completed-sets",children:ie.sets.map((vn,xn)=>a.jsxs("div",{className:"mg-completed-set",children:[a.jsx("span",{className:"mg-completed-set-check",children:""}),a.jsxs("span",{children:["Set ",xn+1,": ",vn.weight!=null?`${vn.weight}kg  ${vn.reps}`:vn.reps!=null?`${vn.reps} reps`:`${vn.time}s`]})]},xn))})]})]}),kt]})}if(g==="muscle_complete"){const G=et.reduce((Ce,Le)=>Ce+Le.sets.length,0),he=et.reduce((Ce,Le)=>Ce+Le.sets.reduce((it,It)=>it+(It.weight||0)*(It.reps||0),0),0),ie=Hc.find(Ce=>Ce.key===Nt)?.label||"";return a.jsxs("div",{className:"wk-page wk-page-center","data-theme":l?"dark":"light","data-accent":h,children:[a.jsxs("div",{className:"wk-complete",children:[a.jsxs("div",{className:"wk-complete-ring",children:[a.jsx("svg",{className:"wk-complete-svg",viewBox:"0 0 200 200",children:ru.map((Ce,Le)=>a.jsx("line",{x1:Ce.x1,y1:Ce.y1,x2:Ce.x2,y2:Ce.y2,className:"wk-tick-complete",strokeWidth:Ce.thick?"3.5":"2",style:{animationDelay:`${Le*.02}s`}},Le))}),a.jsx("div",{className:"wk-complete-center",children:a.jsx("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"#4caf50",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M20 6L9 17l-5-5"})})})]}),a.jsxs("h2",{className:"wk-complete-title",children:[ie," Complete!"]}),a.jsx("p",{className:"mg-complete-session-name",children:le?.name}),a.jsxs("div",{className:"wk-complete-stats",children:[a.jsxs("div",{className:"wk-stat",children:[a.jsx("span",{className:"wk-stat-val",children:et.length}),a.jsx("span",{className:"wk-stat-label",children:"Exercises"})]}),a.jsxs("div",{className:"wk-stat",children:[a.jsx("span",{className:"wk-stat-val",children:G}),a.jsx("span",{className:"wk-stat-label",children:"Sets"})]}),he>0&&a.jsxs("div",{className:"wk-stat",children:[a.jsx("span",{className:"wk-stat-val",children:Math.round(he).toLocaleString()}),a.jsx("span",{className:"wk-stat-label",children:"Volume (kg)"})]})]}),a.jsx("div",{className:"wk-complete-actions",children:a.jsx("button",{className:"wk-btn-primary",onClick:()=>{gn(null),Ct(null),Q(null),y("menu")},children:"Done"})})]}),ft&&a.jsx("div",{className:"mg-badge-celebration",onClick:()=>Q(null),children:a.jsxs("div",{className:"mg-badge-celebration-card",children:[a.jsx("div",{className:"mg-badge-celebration-icon",children:a.jsx("svg",{viewBox:"0 0 24 24",width:"48",height:"48",fill:"#ffc107",children:a.jsx("polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"})})}),a.jsx("h3",{className:"mg-badge-celebration-title",children:ft.badges.length===1?"Badge Earned!":`${ft.badges.length} Badges Earned!`}),a.jsx("div",{className:"mg-badge-celebration-list",children:ft.badges.map((Ce,Le)=>a.jsx("div",{className:"mg-badge-celebration-item",children:Ce.type==="pb_target"?`${Ce.exercise}  ${Ce.targetWeight}kg`:Ce.label},Le))}),a.jsx("button",{className:"mg-badge-celebration-dismiss",children:"Tap to dismiss"})]})})]})}return null}const gD=60,yD={"Dumbbell Floor Press":"push","Seated Dumbbell Shoulder Press":"push","Seated Dumbbell Arnold Press":"push","Dumbbell Overhead Tricep Extension":"push",Skullcrushers:"push","Dumbbell Lateral Raise":"push","Dumbbell Front Raise":"push","Dumbbell Bent Over Row":"pull","Single Arm Bent Over Row":"pull","Bicep Curl":"pull","Hammer Curl":"pull","Dumbbell Bent Over Rear Delt Fly":"pull","Renegade Row":"pull","Dumbbell Goblet Squats":"lower","Romanian Deadlifts":"lower","Forward Dumbbell Lunges":"lower","Dumbbell Sumo Squats":"lower","Weighted Calf Raises":"lower","1 Legged RDL":"lower","Dumbbell Box Step Ups":"lower","Dumbbell Squat Pulses":"lower","Dumbbell Reverse Lunges":"lower","Kettlebell Romanian Deadlift":"lower","Russian Twists Dumbbell":"core","Kettlebell Russian Twist":"core","Kettlebell Side Bends":"core","Kneeling Kettlebell Halo":"core"},bD=[{threshold:1e3,label:"1 Tonne"},{threshold:5e3,label:"5 Tonne"},{threshold:1e4,label:"10 Tonne"},{threshold:25e3,label:"25 Tonne"},{threshold:5e4,label:"50 Tonne"},{threshold:1e5,label:"100 Tonne"},{threshold:25e4,label:"250 Tonne"},{threshold:5e5,label:"500 Tonne"},{threshold:1e6,label:"1 Million kg"}],y2=[{id:"fullbody_4wk",name:"4-Week Full Body",focus:"fullbody",duration:4,daysPerWeek:3,level:"All Levels",description:"Build total body strength with compound dumbbell movements and bodyweight finishers",repProg:2,timeProg:5,days:[{name:"Day 1",label:"Push Focus",exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:3,baseReps:10,pbKey:"chestPress",storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Seated Dumbbell Shoulder Press",type:"weighted",sets:3,baseReps:10,pbKey:"shoulderPress",storagePath:"exercises/dumbbells/upper/seated dumbbell shoulder press.mp4"},{name:"Dumbbell Goblet Squats",type:"weighted",sets:3,baseReps:10,pbKey:"squat",storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Press Up",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Mountain Climbers",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Mountain Climbers.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]},{name:"Day 2",label:"Pull Focus",exercises:[{name:"Dumbbell Bent Over Row",type:"weighted",sets:3,baseReps:10,pbKey:"seatedRow",storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Bicep Curl",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Romanian Deadlifts",type:"weighted",sets:3,baseReps:10,pbKey:"deadlift",storagePath:"exercises/dumbbells/lower/romanian deadlifts.GIF"},{name:"Reverse Lunge",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/lower/reverse lunge.GIF"},{name:"Russian Twist",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Russian Twist.mp4"},{name:"Side Plank",type:"timed",sets:2,baseTime:25,storagePath:"exercises/bodyweight/core/Side Plank.mp4"}]},{name:"Day 3",label:"Legs & Core",exercises:[{name:"Forward Dumbbell Lunges",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.GIF"},{name:"Dumbbell Sumo Squats",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/lower/dumbbell sumo squats.GIF"},{name:"Weighted Calf Raises",type:"weighted",sets:3,baseReps:15,storagePath:"exercises/dumbbells/lower/weighted calf raises.GIF"},{name:"Box Step Ups",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/lower/box step ups.GIF"},{name:"Burpee",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]}]},{id:"fullbody_8wk",name:"8-Week Full Body",focus:"fullbody",duration:8,daysPerWeek:3,level:"Intermediate",description:"Two-phase programme building strength and endurance across your full body",repProg:1,timeProg:3,days:[{name:"Day 1",label:"Strength",exercises:[{name:"Dumbbell Goblet Squats",type:"weighted",sets:4,baseReps:8,pbKey:"squat",storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Dumbbell Floor Press",type:"weighted",sets:4,baseReps:8,pbKey:"chestPress",storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Dumbbell Bent Over Row",type:"weighted",sets:4,baseReps:8,pbKey:"seatedRow",storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Seated Dumbbell Shoulder Press",type:"weighted",sets:3,baseReps:10,pbKey:"shoulderPress",storagePath:"exercises/dumbbells/upper/seated dumbbell shoulder press.mp4"},{name:"Mountain Climbers",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Mountain Climbers.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:35,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]},{name:"Day 2",label:"Power",exercises:[{name:"Romanian Deadlifts",type:"weighted",sets:4,baseReps:8,pbKey:"deadlift",storagePath:"exercises/dumbbells/lower/romanian deadlifts.GIF"},{name:"Forward Dumbbell Lunges",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.GIF"},{name:"Single Arm Bent Over Row",type:"weighted",sets:4,baseReps:8,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Hammer Curl",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/hammer curl.mp4"},{name:"Bulgarian Split Squats",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/lower/bulgarian split squats.GIF"},{name:"Russian Twist",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Russian Twist.mp4"}]},{name:"Day 3",label:"Endurance",exercises:[{name:"Dumbbell Sumo Squats",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/lower/dumbbell sumo squats.GIF"},{name:"Weighted Calf Raises",type:"weighted",sets:3,baseReps:15,storagePath:"exercises/dumbbells/lower/weighted calf raises.GIF"},{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Press Up",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Burpee",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:40,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]}]},{id:"fullbody_12wk",name:"12-Week Full Body",focus:"fullbody",duration:12,daysPerWeek:3,level:"Advanced",description:"Complete transformation programme: push, pull, and legs over three phases",repProg:1,timeProg:2,days:[{name:"Day 1",label:"Upper Push",exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:4,baseReps:8,pbKey:"chestPress",storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Seated Dumbbell Arnold Press",type:"weighted",sets:4,baseReps:8,storagePath:"exercises/dumbbells/upper/seated dumbbell arnold press.mp4"},{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Skullcrushers",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/skullcrushers.mp4"},{name:"Press Up",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]},{name:"Day 2",label:"Lower Body",exercises:[{name:"Dumbbell Goblet Squats",type:"weighted",sets:4,baseReps:8,pbKey:"squat",storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Romanian Deadlifts",type:"weighted",sets:4,baseReps:8,pbKey:"deadlift",storagePath:"exercises/dumbbells/lower/romanian deadlifts.GIF"},{name:"Forward Dumbbell Lunges",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.GIF"},{name:"Weighted Calf Raises",type:"weighted",sets:3,baseReps:15,storagePath:"exercises/dumbbells/lower/weighted calf raises.GIF"},{name:"Jump Squats",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/lower/jump squats.GIF"},{name:"Hollow Body Hold",type:"timed",sets:3,baseTime:30,storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"}]},{name:"Day 3",label:"Upper Pull",exercises:[{name:"Dumbbell Bent Over Row",type:"weighted",sets:4,baseReps:8,pbKey:"seatedRow",storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Single Arm Bent Over Row",type:"weighted",sets:4,baseReps:8,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Bicep Curl",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Burpee",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Side Plank",type:"timed",sets:2,baseTime:25,storagePath:"exercises/bodyweight/core/Side Plank.mp4"}]}]},{id:"core_4wk",name:"4-Week Core",focus:"core",duration:4,daysPerWeek:3,level:"Beginner",description:"Build a solid core foundation with targeted ab and stability work",repProg:2,timeProg:5,days:[{name:"Day 1",label:"Abs",exercises:[{name:"Crunch",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/core/Crunch.mp4"},{name:"Leg Raises",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Leg Raises.mp4"},{name:"Russian Twist",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Russian Twist.mp4"},{name:"Bicycle Crunch",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Bicycle Crunch.mp4"},{name:"Mountain Climbers",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Mountain Climbers.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]},{name:"Day 2",label:"Stability",exercises:[{name:"Dead Bug",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Dead Bug.mp4"},{name:"Bird Dog",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Bird Dog.mp4"},{name:"Side Plank",type:"timed",sets:2,baseTime:20,storagePath:"exercises/bodyweight/core/Side Plank.mp4"},{name:"Flutter Kicks",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Flutter Kicks.mp4"},{name:"Hollow Body Hold",type:"timed",sets:3,baseTime:20,storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"},{name:"High Plank Shoulder Taps",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/High Plank Shoulder Taps.mp4"}]},{name:"Day 3",label:"Power Core",exercises:[{name:"Single Leg V-Up",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Single Leg V-Up.mp4"},{name:"Toe Reaches",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/core/toe reaches.GIF"},{name:"Russian Twists Dumbbell",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/core/russian twists dumbbell.GIF"},{name:"Burpee",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Fast Mountain Climbers",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Fast Mountain Climbers.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]}]},{id:"core_8wk",name:"8-Week Core",focus:"core",duration:8,daysPerWeek:3,level:"Intermediate",description:"Develop deep core strength and rotational power over two phases",repProg:1,timeProg:3,days:[{name:"Day 1",label:"Anti-Extension",exercises:[{name:"Forearm Plank",type:"timed",sets:3,baseTime:35,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"},{name:"Dead Bug",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Dead Bug.mp4"},{name:"Plank Walkout",type:"reps",sets:3,baseReps:8,storagePath:"exercises/bodyweight/core/Plank Walkout.mp4"},{name:"Hollow Body Hold",type:"timed",sets:3,baseTime:25,storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"},{name:"Leg Raises",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Leg Raises.mp4"},{name:"Mountain Climbers",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Mountain Climbers.mp4"}]},{name:"Day 2",label:"Rotation",exercises:[{name:"Russian Twist",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Russian Twist.mp4"},{name:"Kettlebell Russian Twist",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/kettlebells/core/kettlebell russian twist.mp4"},{name:"Bicycle Crunch",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Bicycle Crunch.mp4"},{name:"Side Plank Rotation",type:"reps",sets:2,baseReps:10,storagePath:"exercises/bodyweight/core/Side Plank Rotation.mp4"},{name:"High Plank Shoulder Taps",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/core/High Plank Shoulder Taps.mp4"},{name:"Hollow Hold To V-Sit",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Hollow Hold To V-sit.mp4"}]},{name:"Day 3",label:"Power",exercises:[{name:"Crunch",type:"reps",sets:4,baseReps:15,storagePath:"exercises/bodyweight/core/Crunch.mp4"},{name:"Flutter Kicks",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Flutter Kicks.mp4"},{name:"Reverse Crunch To Leg Raise",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Reverse Crunch To Leg Raise.mp4"},{name:"Burpee",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Kettlebell Bird Dog Drag",type:"reps",sets:3,baseReps:10,storagePath:"exercises/kettlebells/core/kettlebell bird dog drag.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:40,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]}]},{id:"core_12wk",name:"12-Week Core",focus:"core",duration:12,daysPerWeek:3,level:"Advanced",description:"Ultimate core transformation: stability, strength, and power across three phases",repProg:1,timeProg:2,days:[{name:"Day 1",label:"Strength",exercises:[{name:"Forearm Plank",type:"timed",sets:4,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"},{name:"Plank Walkout",type:"reps",sets:4,baseReps:8,storagePath:"exercises/bodyweight/core/Plank Walkout.mp4"},{name:"Leg Raises",type:"reps",sets:4,baseReps:12,storagePath:"exercises/bodyweight/core/Leg Raises.mp4"},{name:"Kettlebell Side Bends",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/kettlebells/core/kettlebell side bends.mp4"},{name:"Dead Bug Single Leg Drop",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Dead Bug Single Leg Drop.mp4"},{name:"Hollow Body Hold",type:"timed",sets:3,baseTime:25,storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"}]},{name:"Day 2",label:"Endurance",exercises:[{name:"Crunch",type:"reps",sets:4,baseReps:15,storagePath:"exercises/bodyweight/core/Crunch.mp4"},{name:"Kettlebell Russian Twist",type:"weighted",sets:4,baseReps:15,storagePath:"exercises/kettlebells/core/kettlebell russian twist.mp4"},{name:"Bicycle Crunch",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Bicycle Crunch.mp4"},{name:"Hollow Hold Flutter Kicks",type:"reps",sets:3,baseReps:25,storagePath:"exercises/bodyweight/core/Hollow Hold Flutter Kicks.mp4"},{name:"Cross Body Mountain Climbers",type:"reps",sets:3,baseReps:25,storagePath:"exercises/bodyweight/core/Cross Body Mountain Climbers.mp4"},{name:"Side Plank",type:"timed",sets:2,baseTime:25,storagePath:"exercises/bodyweight/core/Side Plank.mp4"}]},{name:"Day 3",label:"Power",exercises:[{name:"Hollow Hold To V-Sit",type:"reps",sets:4,baseReps:10,storagePath:"exercises/bodyweight/core/Hollow Hold To V-sit.mp4"},{name:"Reverse Crunch To Leg Raise",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Reverse Crunch To Leg Raise.mp4"},{name:"Burpee",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Hip Dips Plank",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/core/Hip Dips Plank.mp4"},{name:"Kneeling Kettlebell Halo",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/kettlebells/core/kneeling kettlebell halo.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:35,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]}]},{id:"upper_4wk",name:"4-Week Upper Body",focus:"upper",duration:4,daysPerWeek:3,level:"Intermediate",description:"Sculpt and strengthen your chest, back, shoulders, and arms",repProg:2,timeProg:5,days:[{name:"Day 1",label:"Push",exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:4,baseReps:10,pbKey:"chestPress",storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Seated Dumbbell Shoulder Press",type:"weighted",sets:3,baseReps:10,pbKey:"shoulderPress",storagePath:"exercises/dumbbells/upper/seated dumbbell shoulder press.mp4"},{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Tricep Dips",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/upper/tricep dips.mp4"},{name:"Pike Push Ups",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/upper/pike push ups.GIF"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]},{name:"Day 2",label:"Pull",exercises:[{name:"Dumbbell Bent Over Row",type:"weighted",sets:4,baseReps:10,pbKey:"seatedRow",storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Single Arm Bent Over Row",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Bicep Curl",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Hammer Curl",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/hammer curl.mp4"},{name:"Reverse Plank",type:"timed",sets:3,baseTime:20,storagePath:"exercises/bodyweight/upper/reverse plank.GIF"}]},{name:"Day 3",label:"Mixed",exercises:[{name:"Seated Dumbbell Arnold Press",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/seated dumbbell arnold press.mp4"},{name:"Dumbbell Lateral Raise",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/dumbbell lateral raise.mp4"},{name:"Dumbbell Front Raise",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/dumbbell front raise.mp4"},{name:"Press Up",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Renegade Row",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/renegade row.mp4"},{name:"Superman Hold",type:"timed",sets:3,baseTime:30,storagePath:"exercises/bodyweight/core/Superman Hold.mp4"}]}]},{id:"lower_4wk",name:"4-Week Lower Body",focus:"lower",duration:4,daysPerWeek:3,level:"Intermediate",description:"Build powerful legs and glutes with squats, deadlifts, and plyometrics",repProg:2,timeProg:5,days:[{name:"Day 1",label:"Quad Dominant",exercises:[{name:"Dumbbell Goblet Squats",type:"weighted",sets:4,baseReps:10,pbKey:"squat",storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Forward Dumbbell Lunges",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.GIF"},{name:"Dumbbell Box Step Ups",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/lower/dumbbell box step ups.mp4"},{name:"Dumbbell Squat Pulses",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/lower/dumbbell squat pulses.GIF"},{name:"Jump Squats",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/lower/jump squats.GIF"},{name:"Squat And Hold",type:"timed",sets:3,baseTime:30,storagePath:"exercises/bodyweight/lower/squat and hold.GIF"}]},{name:"Day 2",label:"Hamstring & Glute",exercises:[{name:"Romanian Deadlifts",type:"weighted",sets:4,baseReps:8,pbKey:"deadlift",storagePath:"exercises/dumbbells/lower/romanian deadlifts.GIF"},{name:"1 Legged RDL",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/lower/1 legged rdl.GIF"},{name:"Hip Thrusts",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/lower/hip thrusts.GIF"},{name:"Dumbbell Reverse Lunges",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/lower/dumbbell reverse lunges.GIF"},{name:"Donkey Kicks",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/lower/donkey kicks.GIF"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]},{name:"Day 3",label:"Power & Stability",exercises:[{name:"Dumbbell Sumo Squats",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/lower/dumbbell sumo squats.GIF"},{name:"Kettlebell Romanian Deadlift",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/kettlebells/lower/kettlebell romanian deadlift.mp4"},{name:"Weighted Calf Raises",type:"weighted",sets:3,baseReps:15,storagePath:"exercises/dumbbells/lower/weighted calf raises.GIF"},{name:"Bulgarian Split Squats",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/lower/bulgarian split squats.GIF"},{name:"Skater Jumps",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/lower/skater jumps.GIF"},{name:"Side Plank",type:"timed",sets:2,baseTime:25,storagePath:"exercises/bodyweight/core/Side Plank.mp4"}]}]}];function rd(s,e,t){const i=s.baseReps?s.baseReps+(e-1)*(t.repProg||0):void 0,l=s.baseTime?s.baseTime+(e-1)*(t.timeProg||0):void 0;return{sets:s.sets,reps:i,time:l}}const vD={fullbody:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm-2 8h4l1 4h2l-1 4h-2l-1 4h-2l-1-4H8l-1-4h2l1-4z",core:"M12 2a4 4 0 0 1 4 4v1h-2V6a2 2 0 1 0-4 0v1H8V6a4 4 0 0 1 4-4zM8 9h8v2H8V9zm-1 4h10l-1 9H8l-1-9z",upper:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm8 10l-3-1.5c-.5-.25-1-.5-1.5-.5h-7c-.5 0-1 .25-1.5.5L4 12l-2 6h4l1.5 4h9L18 18h4l-2-6z",lower:"M16.5 3A2.5 2.5 0 0 0 14 5.5 2.5 2.5 0 0 0 16.5 8 2.5 2.5 0 0 0 19 5.5 2.5 2.5 0 0 0 16.5 3zM14 9l-3 7h2l1 6h2l1-6h2l-3-7h-2z"};function xD(){const{currentUser:s,isClient:e,clientData:t,loading:i}=Qr(),{isDark:l,toggleTheme:u,accent:h}=Ma(),p=nr(),g=da(),[y,w]=x.useState("loading"),[k,j]=x.useState(null),O=x.useRef(!1),[$,U]=x.useState(null),[L,ne]=x.useState(1),[Z,ye]=x.useState(0),[je,We]=x.useState(0),[Be,R]=x.useState(0),[S,I]=x.useState([]),[V,P]=x.useState(""),[F,M]=x.useState(""),[He,xt]=x.useState(!1),[z,fe]=x.useState(0),Ie=x.useRef(null),[Ge,J]=x.useState({}),[D,W]=x.useState(!1),be=x.useRef(null),[Ne,qe]=x.useState(null),[Ae,rt]=x.useState([]);x.useEffect(()=>{window.scrollTo(0,0)},[y]);const[pt,Ze]=x.useState(null),Ht=x.useCallback((me,Se="info")=>{Ze({message:me,type:Se}),setTimeout(()=>Ze(null),4e3)},[]),cn=x.useRef(null),Nt=()=>(cn.current||(cn.current=new(window.AudioContext||window.webkitAudioContext)),cn.current),Ct=()=>{try{const me=Nt(),Se=me.createOscillator(),Fe=me.createGain();Se.connect(Fe),Fe.connect(me.destination),Se.frequency.value=1200,Fe.gain.value=.4,Se.start(me.currentTime),Se.stop(me.currentTime+.3)}catch{}};x.useEffect(()=>{!i&&(!s||!e)&&p("/")},[s,e,i,p]),x.useEffect(()=>{if(!t)return;(async()=>{try{const Se=Ke(ve,"clientProgrammes",t.id),Fe=await Ln(Se);Fe.exists()?(U(Fe.data()),w("dashboard")):g.state?.templateId?w("browse"):p("/client/core-buddy/workouts",{replace:!0})}catch(Se){console.error("Error loading programme:",Se),p("/client/core-buddy/workouts",{replace:!0})}})()},[t]),x.useEffect(()=>{if(O.current||y==="loading")return;const me=g.state?.templateId;if(!me)return;const Se=y2.find(Fe=>Fe.id===me);Se&&(O.current=!0,j(Se),w("overview"))},[y,g.state]),x.useEffect(()=>{if(!He||z<=0){He&&z<=0&&(xt(!1),Ct());return}return Ie.current=setTimeout(()=>fe(me=>me-1),1e3),()=>clearTimeout(Ie.current)},[He,z]);const le=async me=>{if(t)try{await Wn(Ke(ve,"clientProgrammes",t.id),me),U(me)}catch(Se){console.error("Error saving programme:",Se),Ht("Failed to save. Check Firestore rules for clientProgrammes.","error")}},gn=async me=>{const Se={templateId:me.id,startDate:vt.now(),completedSessions:{}};await le(Se),w("dashboard")},$t=async()=>{if(t)try{await or(Ke(ve,"clientProgrammes",t.id)),U(null),w("browse")}catch(me){console.error("Error quitting programme:",me)}},St=()=>$?y2.find(me=>me.id===$.templateId):null,Bt=()=>{if(!$?.startDate)return 1;const me=$.startDate.toDate?$.startDate.toDate():new Date($.startDate),Fe=new Date-me,Qe=Math.floor(Fe/(1e3*60*60*24));return Math.floor(Qe/7)+1},ht=()=>{if(!$)return{currentWeek:1,completedThisWeek:0,nextDay:0,totalCompleted:0};const me=$.completedSessions||{},Se=Object.keys(me).length,Fe=St();if(!Fe)return{currentWeek:1,completedThisWeek:0,nextDay:0,totalCompleted:0};const Qe=Fe.duration*Fe.daysPerWeek,Ue=Bt(),De=Math.min(Ue,Fe.duration);let Oe=0;for(let ft=0;ft<Fe.daysPerWeek;ft++)me[`w${De}d${ft}`]&&Oe++;if(Se>=Qe)return{currentWeek:Fe.duration,completedThisWeek:Fe.daysPerWeek,nextDay:-1,totalCompleted:Se,totalSessions:Qe,complete:!0};if(Ue>Fe.duration)return{currentWeek:Fe.duration,completedThisWeek:Oe,nextDay:-1,totalCompleted:Se,totalSessions:Qe,complete:!0};let wt=-1;for(let ft=0;ft<Fe.daysPerWeek;ft++)if(!me[`w${De}d${ft}`]){wt=ft;break}return{currentWeek:De,completedThisWeek:Oe,nextDay:wt,nextWeek:De,totalCompleted:Se,totalSessions:Qe}},et=me=>{const Se=Bt();return me<Se},en=(me,Se,Fe)=>{if(!$||me<=1)return null;const Qe=`w${me-1}d${Se}`,Ue=$.completedSessions?.[Qe];if(!Ue)return null;const De=Ue.exercises?.find(Oe=>Oe.name===Fe);return De?.sets?.length?De.sets[De.sets.length-1]:null},rs=(me,Se)=>{const Fe=St();if(!Fe)return;ne(me),ye(Se),We(0),R(0),I([]),M(""),xt(!1),fe(0),W(!1),J({});const Qe=Fe.days[Se],Ue=Qe.exercises.map(ft=>{const Q=rd(ft,me,Fe);return{name:ft.name,type:ft.type,pbKey:ft.pbKey,targetSets:Q.sets,targetReps:Q.reps,targetTime:Q.time,sets:[]}});I(Ue);const De=Qe.exercises[0],Oe=en(me,Se,De.name);Oe?.weight&&De.type==="weighted"?P(String(Oe.weight)):P(""),(async()=>{const ft={};for(const Q of Qe.exercises)if(Q.storagePath)try{const Ee=Gi(Ki,Q.storagePath),Xe=await Lo(Ee);ft[Q.name]={url:Xe,isGif:/\.gif$/i.test(Q.storagePath)}}catch(Ee){console.warn(`Video not found for ${Q.name}:`,Ee)}J(ft)})(),w("session")},Lt=async()=>{St();const me=S[je];if(!me)return;let Se={};if(me.type==="weighted"){const Ue=parseFloat(V)||0,De=parseInt(F)||0;if(De===0){Ht("Enter your reps","error");return}Se={weight:Ue,reps:De}}else if(me.type==="reps"){const Ue=parseInt(F)||0;if(Ue===0){Ht("Enter your reps","error");return}Se={reps:Ue}}else if(me.type==="timed"){const Ue=me.targetTime-z;Se={time:Math.max(Ue,1)}}const Fe=[...S];Fe[je]={...me,sets:[...me.sets,Se]},I(Fe),me.type==="weighted"&&Se.weight>0&&await Ft(me.name,Se.weight,Se.reps);const Qe=me.sets.length+1;if(Qe<me.targetSets)R(Qe),P(Se.weight?String(Se.weight):""),M(""),xt(!1),fe(0);else if(je+1<S.length){const Ue=je+1;We(Ue),R(0),W(!1);const Oe=St()?.days[Z]?.exercises[Ue],wt=en(L,Z,Oe?.name);wt?.weight&&Oe?.type==="weighted"?P(String(wt.weight)):P(""),M(""),xt(!1),fe(0)}else await Et(Fe)},Et=async me=>{if(!$||!t)return;const Se=`w${L}d${Z}`,Fe={...$.completedSessions,[Se]:{completedAt:new Date().toISOString(),exercises:me.map(De=>({name:De.name,type:De.type,sets:De.sets}))}},Qe={...$,completedSessions:Fe};await le(Qe);const Ue=me.reduce((De,Oe)=>De+Oe.sets.reduce((wt,ft)=>wt+(ft.weight||0)*(ft.reps||0),0),0);Ue>0&&await Pn(Ue);try{const De=St();await ai(Wt(ve,"workoutLogs"),{clientId:t.id,type:"programme",programmeId:De?.id,programmeName:De?.name,week:L,day:Z+1,exerciseCount:me.length,duration:Math.round(me.reduce((Oe,wt)=>Oe+wt.sets.length*1.5,0)),volume:Math.round(Ue),completedAt:vt.now()})}catch(De){console.error("Error saving workout log:",De)}Ae.length>0&&(qe({badges:[...Ae]}),rt([])),w("sessionComplete")},Pn=async me=>{if(t)try{const Se=await Ln(Ke(ve,"coreBuddyAchievements",t.id)),Fe=Se.exists()?Se.data():{clientId:t.id,badges:[],totalVolume:0},Qe=Fe.totalVolume||0,Ue=Qe+me,De=[];bD.forEach(wt=>{Ue>=wt.threshold&&Qe<wt.threshold&&(Fe.badges.some(Q=>Q.type==="volume_milestone"&&Q.milestone===wt.threshold)||De.push({type:"volume_milestone",milestone:wt.threshold,label:wt.label,achievedAt:vt.now()}))});const Oe=[...Fe.badges,...De];await Wn(Ke(ve,"coreBuddyAchievements",t.id),{clientId:t.id,badges:Oe,totalVolume:Math.round(Ue),updatedAt:vt.now()}),De.length>0&&rt(wt=>[...wt,...De])}catch(Se){console.error("Error updating volume:",Se)}},Ft=async(me,Se,Fe)=>{if(t)try{const Qe=t.id,Ue=await Ln(Ke(ve,"coreBuddyPBs",Qe)),Oe=(Ue.exists()?Ue.data():null)?.exercises||{},wt=Oe[me];let ft=!1;if(wt?(Se>(wt.weight||0)||Se===(wt.weight||0)&&Fe>(wt.reps||0))&&(ft=!0):ft=!0,ft){const Q={...Oe,[me]:{weight:Se,reps:Fe,achievedAt:vt.now()}};await Wn(Ke(ve,"coreBuddyPBs",Qe),{clientId:t.id,exercises:Q,updatedAt:vt.now()}),Ht(`New PB! ${Se}kg  ${Fe} reps`,"success"),Ct(),await En(me,Se)}}catch(Qe){console.error("Error checking PB:",Qe)}},En=async(me,Se)=>{if(t)try{const Fe=await Ln(Ke(ve,"coreBuddyTargets",t.id));if(!Fe.exists())return;const Ue=(Fe.data().targets||{})[me];if(!Ue||Se<Ue.targetWeight)return;const De=await Ln(Ke(ve,"coreBuddyAchievements",t.id)),Oe=De.exists()?De.data():{clientId:t.id,badges:[],totalVolume:0};if(Oe.badges.some(Ee=>Ee.type==="pb_target"&&Ee.exercise===me&&Ee.targetWeight===Ue.targetWeight))return;const ft={type:"pb_target",exercise:me,group:yD[me]||"push",targetWeight:Ue.targetWeight,achievedAt:vt.now()},Q=[...Oe.badges,ft];await Wn(Ke(ve,"coreBuddyAchievements",t.id),{...Oe,badges:Q,updatedAt:vt.now()}),rt(Ee=>[...Ee,ft])}catch(Fe){console.error("Error checking target badge:",Fe)}},Kt=pt&&a.jsxs("div",{className:`toast-notification ${pt.type}`,children:[pt.type==="success"&&a.jsx("span",{children:" "}),pt.message]}),Sn=(me,Se)=>a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:Se,"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})});if(i||y==="loading")return a.jsx("div",{className:"cb-loading",children:a.jsx("div",{className:"cb-loading-spinner"})});if(y==="browse")return p("/client/core-buddy/workouts",{replace:!0}),null;if(y==="overview"&&k){const me=k;return a.jsxs("div",{className:"pg-page","data-theme":l?"dark":"light","data-accent":h,children:[Sn(me.name,()=>p("/client/core-buddy/workouts")),a.jsxs("main",{className:"pg-main",children:[a.jsxs("div",{className:"pg-overview-hero",children:[a.jsx("svg",{className:"pg-overview-icon",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:vD[me.focus]})}),a.jsx("h2",{className:"pg-overview-name",children:me.name}),a.jsx("p",{className:"pg-overview-desc",children:me.description}),a.jsxs("div",{className:"pg-overview-stats",children:[a.jsxs("div",{className:"pg-ov-stat",children:[a.jsx("span",{className:"pg-ov-stat-num",children:me.duration}),a.jsx("span",{className:"pg-ov-stat-label",children:"Weeks"})]}),a.jsxs("div",{className:"pg-ov-stat",children:[a.jsx("span",{className:"pg-ov-stat-num",children:me.daysPerWeek}),a.jsx("span",{className:"pg-ov-stat-label",children:"Days/Week"})]}),a.jsxs("div",{className:"pg-ov-stat",children:[a.jsx("span",{className:"pg-ov-stat-num",children:me.duration*me.daysPerWeek}),a.jsx("span",{className:"pg-ov-stat-label",children:"Sessions"})]})]})]}),a.jsx("div",{className:"pg-overview-days",children:me.days.map((Se,Fe)=>a.jsxs("div",{className:"pg-day-card",children:[a.jsxs("div",{className:"pg-day-header",children:[a.jsx("span",{className:"pg-day-name",children:Se.name}),a.jsx("span",{className:"pg-day-label",children:Se.label})]}),a.jsx("div",{className:"pg-day-exercises",children:Se.exercises.map((Qe,Ue)=>{const De=rd(Qe,1,me);return a.jsxs("div",{className:"pg-day-ex",children:[a.jsx("span",{className:"pg-day-ex-name",children:Qe.name}),a.jsx("span",{className:"pg-day-ex-target",children:Qe.type==="timed"?`${De.sets}${De.time}s`:`${De.sets}${De.reps}`}),a.jsx("span",{className:`pg-day-ex-badge pg-badge-${Qe.type}`,children:Qe.type==="weighted"?"WT":Qe.type==="timed"?"TMR":"BW"})]},Ue)})})]},Fe))}),a.jsxs("div",{className:"pg-overview-note",children:[a.jsx("strong",{children:"Progressive Overload:"})," +",me.repProg," reps/week",me.timeProg?`, +${me.timeProg}s/week for timed`:""]}),a.jsx("button",{className:"pg-start-btn",onClick:()=>gn(me),children:"Start Programme"})]}),Kt]})}if(y==="dashboard"){const me=St();if(!me)return w("browse"),null;const Se=ht(),Fe=$?.completedSessions||{},Qe=Se.totalSessions?Math.round(Se.totalCompleted/Se.totalSessions*100):0;return Math.round(Se.totalCompleted/(Se.totalSessions||1)*gD),a.jsxs("div",{className:"pg-page","data-theme":l?"dark":"light","data-accent":h,children:[Sn("Programme",()=>p("/client/core-buddy/workouts")),a.jsxs("main",{className:"pg-main",children:[a.jsxs("div",{className:"pg-dash-hero",children:[a.jsxs("div",{className:"pg-dash-ring-wrap",children:[a.jsxs("svg",{viewBox:"0 0 200 200",children:[a.jsx("circle",{className:"pg-arc-track",cx:"100",cy:"100",r:"80"}),a.jsx("circle",{className:"pg-arc-fill",cx:"100",cy:"100",r:"80",strokeDasharray:2*Math.PI*80,strokeDashoffset:2*Math.PI*80-Qe/100*2*Math.PI*80})]}),a.jsxs("div",{className:"pg-ring-center",children:[a.jsxs("span",{className:"pg-ring-pct",children:[Qe,"%"]}),a.jsx("span",{className:"pg-ring-label",children:"complete"})]})]}),a.jsx("h2",{className:"pg-dash-name",children:me.name}),a.jsxs("div",{className:"pg-dash-progress-text",children:[a.jsxs("span",{className:"pg-dash-pct",children:[Qe,"%"]}),a.jsxs("span",{className:"pg-dash-week",children:["Week ",Se.currentWeek," of ",me.duration]})]})]}),a.jsx("div",{className:"pg-weeks",children:Array.from({length:me.duration},(Ue,De)=>{const Oe=De+1,wt=et(Oe);return a.jsxs("div",{className:`pg-week-row${Oe===Se.currentWeek?" pg-week-current":""}`,children:[a.jsxs("span",{className:"pg-week-label",children:["W",Oe]}),a.jsx("div",{className:"pg-week-days",children:me.days.map((ft,Q)=>{const Ee=`w${Oe}d${Q}`,Xe=!!Fe[Ee],Je=!Xe&&wt,dt=!Xe&&!Je&&Oe===Se.currentWeek&&!Se.complete;return a.jsx("button",{className:`pg-day-dot${Xe?" done":""}${Je?" missed":""}${dt?" next":""}`,disabled:!dt,onClick:()=>{dt&&rs(Oe,Q)},children:Xe?a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:a.jsx("path",{d:"M20 6L9 17l-5-5"})}):Je?a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]}):a.jsx("span",{children:ft.name.replace("Day ","")})},Q)})})]},De)})}),!Se.complete&&(()=>{const Ue=me.days.map((De,Oe)=>({day:De,d:Oe})).filter(({d:De})=>!Fe[`w${Se.currentWeek}d${De}`]);return Ue.length===0?null:a.jsxs("div",{className:"pg-next-session",children:[a.jsx("h3",{children:Ue.length===me.daysPerWeek?"Choose a Session":"Remaining Sessions"}),a.jsxs("p",{className:"pg-next-info",children:["Week ",Se.currentWeek,"  ",Ue.length," session",Ue.length!==1?"s":""," left this week"]}),Ue.map(({day:De,d:Oe})=>a.jsxs("div",{className:"pg-available-session",children:[a.jsxs("div",{className:"pg-next-exercises",children:[a.jsxs("span",{className:"pg-avail-day-label",children:[De.name,": ",De.label]}),De.exercises.map((wt,ft)=>{const Q=rd(wt,Se.currentWeek,me);return a.jsxs("div",{className:"pg-next-ex",children:[a.jsx("span",{className:"pg-next-ex-name",children:wt.name}),a.jsx("span",{className:"pg-next-ex-target",children:wt.type==="timed"?`${Q.sets}${Q.time}s`:`${Q.sets}${Q.reps}`})]},ft)})]}),a.jsxs("button",{className:"pg-start-btn",onClick:()=>rs(Se.currentWeek,Oe),children:["Start ",De.name]})]},Oe))]})})(),Se.complete&&a.jsxs("div",{className:"pg-complete-msg",children:[a.jsx("h3",{children:"Programme Complete! "}),a.jsxs("p",{children:["You finished all ",Se.totalSessions," sessions."]}),a.jsx("button",{className:"pg-start-btn",onClick:$t,children:"Choose New Programme"})]}),a.jsx("button",{className:"pg-quit-btn",onClick:()=>{confirm("Quit this programme? Progress will be lost.")&&$t()},children:"Quit Programme"})]}),a.jsx(Aa,{active:"workouts"}),Kt]})}if(y==="session"){const me=St();if(!me)return null;const Se=me.days[Z],Fe=Se.exercises[je],Qe=rd(Fe,L,me),Ue=S[je],De=Ue?.sets?.length||0,Oe=Se.exercises.length,wt=(je+De/Qe.sets)/Oe,ft=Ge[Fe.name],Q=en(L,Z,Fe.name);Fe.type==="timed"&&z===0&&!He&&De===Be&&setTimeout(()=>fe(Qe.time),0);const Ee=()=>{ft?.isGif?W(!D):be.current&&(D?be.current.pause():be.current.play(),W(!D))};return a.jsxs("div",{className:"pg-page pg-page-session","data-theme":l?"dark":"light","data-accent":h,children:[a.jsx("div",{className:"pg-session-progress",children:a.jsx("div",{className:"pg-session-progress-fill",style:{width:`${wt*100}%`}})}),a.jsxs("div",{className:"pg-session-header",children:[a.jsx("button",{className:"pg-session-back",onClick:()=>{confirm("Leave session? Progress will be lost.")&&w("dashboard")},children:a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M19 12H5M12 5l-7 7 7 7"})})}),a.jsxs("div",{className:"pg-session-title",children:[a.jsxs("span",{className:"pg-session-counter",children:[je+1," / ",Oe]}),a.jsxs("span",{className:"pg-session-week",children:["Week ",L,"  ",Se.name]})]})]}),ft&&a.jsxs("div",{className:"pg-video-container",onClick:Ee,children:[ft.isGif?a.jsx("img",{className:"pg-video",src:ft.url,alt:Fe.name}):a.jsx("video",{ref:be,className:"pg-video",src:ft.url,loop:!0,muted:!0,playsInline:!0},Fe.name),!D&&a.jsxs("div",{className:"pg-video-overlay",children:[a.jsx("svg",{className:"pg-play-icon",viewBox:"0 0 24 24",fill:"white",children:a.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})}),a.jsx("span",{className:"pg-video-hint",children:"Tap for demo"})]})]}),a.jsx("div",{className:"pg-spotify",children:a.jsx("iframe",{src:"https://open.spotify.com/embed/playlist/37i9dQZF1DZ06evO3FJyYF?utm_source=generator&theme=0",width:"100%",height:"80",frameBorder:"0",allow:"autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture",loading:"lazy",title:"Spotify Playlist"})}),a.jsxs("div",{className:"pg-exercise-card",children:[a.jsx("h2",{className:"pg-ex-name",children:Fe.name}),a.jsx("span",{className:`pg-ex-type-badge pg-badge-${Fe.type}`,children:Fe.type==="weighted"?"Weight + Reps":Fe.type==="timed"?"Timed":"Reps Only"}),Fe.type==="weighted"&&Q&&a.jsxs("div",{className:"pg-last-week",children:[a.jsx("span",{className:"pg-last-week-label",children:"Last week:"}),a.jsxs("span",{className:"pg-last-week-value",children:[Q.weight,"kg x ",Q.reps," reps"]})]}),a.jsxs("div",{className:"pg-ex-set-info",children:[a.jsxs("span",{className:"pg-ex-set-num",children:["Set ",De+1," of ",Qe.sets]}),a.jsxs("span",{className:"pg-ex-target",children:["Target: ",Fe.type==="timed"?`${Qe.time}s hold`:`${Qe.reps} reps`]})]}),Fe.type==="weighted"&&a.jsxs("div",{className:"pg-input-area",children:[a.jsxs("div",{className:"pg-input-group",children:[a.jsx("label",{children:"Weight (kg)"}),a.jsx("input",{type:"number",inputMode:"decimal",value:V,onChange:Xe=>P(Xe.target.value),placeholder:"0",className:"pg-input"})]}),a.jsxs("div",{className:"pg-input-group",children:[a.jsx("label",{children:"Reps"}),a.jsx("input",{type:"number",inputMode:"numeric",value:F,onChange:Xe=>M(Xe.target.value),placeholder:String(Qe.reps),className:"pg-input"})]})]}),Fe.type==="reps"&&a.jsx("div",{className:"pg-input-area",children:a.jsxs("div",{className:"pg-input-group pg-input-single",children:[a.jsx("label",{children:"Reps"}),a.jsx("input",{type:"number",inputMode:"numeric",value:F,onChange:Xe=>M(Xe.target.value),placeholder:String(Qe.reps),className:"pg-input"})]})}),Fe.type==="timed"&&a.jsxs("div",{className:"pg-timer-area",children:[a.jsx("div",{className:"pg-timer-display",children:a.jsxs("span",{className:"pg-timer-value",children:[z,"s"]})}),He?a.jsx("button",{className:"pg-timer-btn pg-timer-stop",onClick:()=>xt(!1),children:"Stop"}):a.jsx("button",{className:"pg-timer-btn",onClick:()=>{z===0&&fe(Qe.time),xt(!0)},children:z<Qe.time&&z>0?"Resume":"Start Timer"})]}),a.jsx("button",{className:"pg-log-set-btn",onClick:Lt,disabled:Fe.type==="timed"&&He,children:De+1<Qe.sets?"Log Set":je+1<Oe?"Log Set  Next Exercise":"Log Set  Complete"}),Ue?.sets?.length>0&&a.jsx("div",{className:"pg-completed-sets",children:Ue.sets.map((Xe,Je)=>a.jsxs("div",{className:"pg-completed-set",children:[a.jsx("span",{className:"pg-completed-set-check",children:""}),a.jsxs("span",{children:["Set ",Je+1,": ",Xe.weight!==void 0?`${Xe.weight}kg  ${Xe.reps}`:Xe.time!==void 0?`${Xe.time}s`:`${Xe.reps} reps`]})]},Je))})]}),Kt]})}if(y==="sessionComplete"){const Se=St()?.days[Z],Fe=S.reduce((Ue,De)=>Ue+De.sets.length,0),Qe=S.reduce((Ue,De)=>Ue+De.sets.reduce((Oe,wt)=>Oe+(wt.weight||0)*(wt.reps||0),0),0);return a.jsxs("div",{className:"pg-page pg-page-center","data-theme":l?"dark":"light","data-accent":h,children:[a.jsxs("div",{className:"pg-session-done",children:[a.jsxs("div",{className:"pg-done-ring",children:[a.jsx("svg",{className:"pg-done-ring-svg",viewBox:"0 0 200 200",children:ru.map((Ue,De)=>a.jsx("line",{x1:Ue.x1,y1:Ue.y1,x2:Ue.x2,y2:Ue.y2,className:"pg-tick-complete",strokeWidth:Ue.thick?"3.5":"2",style:{animationDelay:`${De*.02}s`}},De))}),a.jsx("div",{className:"pg-done-center",children:a.jsx("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"#4caf50",strokeWidth:"2.5",strokeLinecap:"round",children:a.jsx("path",{d:"M20 6L9 17l-5-5"})})})]}),a.jsx("h2",{className:"pg-done-title",children:"Session Complete!"}),a.jsxs("p",{className:"pg-done-subtitle",children:["Week ",L,"  ",Se?.name,": ",Se?.label]}),a.jsxs("div",{className:"pg-done-stats",children:[a.jsxs("div",{className:"pg-done-stat",children:[a.jsx("span",{className:"pg-done-stat-num",children:S.length}),a.jsx("span",{className:"pg-done-stat-label",children:"Exercises"})]}),a.jsxs("div",{className:"pg-done-stat",children:[a.jsx("span",{className:"pg-done-stat-num",children:Fe}),a.jsx("span",{className:"pg-done-stat-label",children:"Sets"})]}),Qe>0&&a.jsxs("div",{className:"pg-done-stat",children:[a.jsx("span",{className:"pg-done-stat-num",children:Math.round(Qe).toLocaleString()}),a.jsx("span",{className:"pg-done-stat-label",children:"Volume (kg)"})]})]}),a.jsx("button",{className:"pg-start-btn",onClick:()=>w("dashboard"),children:"Back to Programme"})]}),Ne&&a.jsx("div",{className:"pg-badge-celebration",onClick:()=>qe(null),children:a.jsxs("div",{className:"pg-badge-celebration-card",onClick:Ue=>Ue.stopPropagation(),children:[a.jsx("div",{className:"pg-badge-celebration-icon",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),a.jsx("h3",{className:"pg-badge-celebration-title",children:Ne.badges.length===1?"Badge Earned!":`${Ne.badges.length} Badges Earned!`}),a.jsx("div",{className:"pg-badge-celebration-list",children:Ne.badges.map((Ue,De)=>a.jsx("div",{className:"pg-badge-celebration-item",children:Ue.type==="pb_target"?`${Ue.exercise}  ${Ue.targetWeight}kg`:Ue.label},De))}),a.jsx("button",{className:"pg-badge-celebration-dismiss",onClick:()=>qe(null),children:"Tap to dismiss"})]})}),Kt]})}return null}const wD={"Dumbbell Floor Press":"push","Seated Dumbbell Shoulder Press":"push","Seated Dumbbell Arnold Press":"push","Dumbbell Overhead Tricep Extension":"push",Skullcrushers:"push","Dumbbell Lateral Raise":"push","Dumbbell Front Raise":"push","Dumbbell Bent Over Row":"pull","Single Arm Bent Over Row":"pull","Bicep Curl":"pull","Hammer Curl":"pull","Dumbbell Bent Over Rear Delt Fly":"pull","Renegade Row":"pull","Dumbbell Goblet Squats":"lower","Romanian Deadlifts":"lower","Forward Dumbbell Lunges":"lower","Dumbbell Sumo Squats":"lower","Weighted Calf Raises":"lower","1 Legged RDL":"lower","Dumbbell Box Step Ups":"lower","Dumbbell Squat Pulses":"lower","Dumbbell Reverse Lunges":"lower","Kettlebell Romanian Deadlift":"lower","Russian Twists Dumbbell":"core","Kettlebell Russian Twist":"core","Kettlebell Side Bends":"core","Kneeling Kettlebell Halo":"core"},_D={push:{label:"Push",color:"#c75f6b",icon:"M4 12h3l3-9 4 18 3-9h3"},pull:{label:"Pull",color:"#5f8ac7",icon:"M12 2v10m0 0l-4-4m4 4l4-4M4 20h16"},lower:{label:"Lower",color:"#5fc77a",icon:"M12 2v8m-4 4l4 8 4-8m-8 0h8"},core:{label:"Core",color:"#c7a45f",icon:"M12 2a4 4 0 014 4v1h-2V6a2 2 0 10-4 0v1H8V6a4 4 0 014-4zM8 9h8v2H8V9zm-1 4h10l-1 9H8l-1-9z"}},$p=[{threshold:1e3,label:"1 Tonne",icon:"1T"},{threshold:5e3,label:"5 Tonne",icon:"5T"},{threshold:1e4,label:"10 Tonne",icon:"10T"},{threshold:25e3,label:"25 Tonne",icon:"25T"},{threshold:5e4,label:"50 Tonne",icon:"50T"},{threshold:1e5,label:"100 Tonne",icon:"100T"},{threshold:25e4,label:"250 Tonne",icon:"250T"},{threshold:5e5,label:"500 Tonne",icon:"500T"},{threshold:1e6,label:"1 Million kg",icon:"1M"}];function kD(s){return wD[s]||"push"}function TD(s){return s>=1e6?`${(s/1e6).toFixed(1)}M`:s>=1e3?`${(s/1e3).toFixed(1)}T`:`${Math.round(s)}`}function jD(s){return s>=1e6?"million kg":s>=1e3?"tonnes":"kg"}function ED(){const{currentUser:s,isClient:e,clientData:t,loading:i}=Qr(),{isDark:l,toggleTheme:u,accent:h}=Ma(),p=nr(),[g,y]=x.useState(!0),[w,k]=x.useState(null),[j,O]=x.useState({}),[$,U]=x.useState([]),[L,ne]=x.useState(null),[Z,ye]=x.useState(0),[je,We]=x.useState({});x.useRef(null),x.useEffect(()=>{!i&&(!s||!e)&&p("/")},[s,e,i,p]),x.useEffect(()=>{if(!t)return;(async()=>{try{const[fe,Ie,Ge,J]=await Promise.all([Ln(Ke(ve,"coreBuddyAchievements",t.id)),Ln(Ke(ve,"coreBuddyPBs",t.id)),Ln(Ke(ve,"achievements",t.id)),Tn(Rn(Wt(ve,"workoutLogs"),ln("clientId","==",t.id)))]);fe.exists()&&k(fe.data()),Ie.exists()&&O(Ie.data().exercises||{}),Ge.exists()&&(U(Object.keys(Ge.data().badges||{})),We(Ge.data().progress||{})),ye(J.docs.length)}catch(fe){console.error("Error loading achievements:",fe)}y(!1)})()},[t]);const Be=w?.badges||[],R=w?.totalVolume||0,S=Be.filter(z=>z.type==="pb_target"),I=Be.filter(z=>z.type==="volume_milestone"),V={push:[],pull:[],lower:[],core:[]};S.forEach(z=>{const fe=z.group||kD(z.exercise);V[fe]&&V[fe].push(z)});const P=$p.find(z=>R<z.threshold),F=$p.filter(z=>R>=z.threshold).pop()?.threshold||0,M=P?(R-F)/(P.threshold-F):1;if(i||g)return a.jsxs("div",{className:"ach-page","data-theme":l?"dark":"light","data-accent":h,children:[a.jsx("header",{className:"client-header",children:a.jsx("div",{className:"header-content",children:a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})})}),a.jsx("div",{className:"ach-loading-inline",children:a.jsx("div",{className:"cb-loading-spinner"})})]});const He=Be.length+$.length,xt=He>0||R>0||Z>0;return a.jsxs("div",{className:"ach-page","data-theme":l?"dark":"light","data-accent":h,children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"ach-main",children:[a.jsx("button",{className:"nut-back-btn",onClick:()=>p("/client/personal-bests?mode=corebuddy"),children:" Back"}),a.jsxs("div",{className:"ach-stats-banner",children:[a.jsxs("div",{className:"ach-stat-item",children:[a.jsx("span",{className:"ach-stat-num",children:He}),a.jsx("span",{className:"ach-stat-label",children:He===1?"Badge":"Badges"})]}),a.jsx("div",{className:"ach-stat-divider"}),a.jsxs("div",{className:"ach-stat-item",children:[a.jsx("span",{className:"ach-stat-num",children:TD(R)}),a.jsxs("span",{className:"ach-stat-label",children:[jD(R)," lifted"]})]}),a.jsx("div",{className:"ach-stat-divider"}),a.jsxs("div",{className:"ach-stat-item",children:[a.jsx("span",{className:"ach-stat-num",children:Object.keys(j).length}),a.jsx("span",{className:"ach-stat-label",children:"PBs"})]})]}),!xt&&a.jsxs("div",{className:"ach-empty",children:[a.jsx("div",{className:"ach-empty-icon",children:a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[a.jsx("path",{d:"M12 15l-3-3h6l-3 3z"}),a.jsx("path",{d:"M5 7h14l-1.5 9h-11L5 7z"}),a.jsx("path",{d:"M8.5 7V5a3.5 3.5 0 017 0v2"})]})}),a.jsx("h4",{children:"No achievements yet"}),a.jsx("p",{children:"Complete workouts to track volume and set PB targets to start earning badges."})]}),[{key:"workouts",title:"Workout Badges",iconPath:"M20.57 14.86L22 13.43 20.57 12 17 15.57 8.43 7 12 3.43 10.57 2 9.14 3.43 7.71 2 5.57 4.14 4.14 2.71 2.71 4.14l1.43 1.43L2 7.71l1.43 1.43L2 10.57 3.43 12 7 8.43 15.57 17 12 20.57 13.43 22l1.43-1.43L16.29 22l2.14-2.14 1.43 1.43 1.43-1.43-1.43-1.43L22 16.29z"},{key:"streaks",title:"Streak Badges",iconPath:"M13.5.67s.74 2.65.74 4.8c0 2.06-1.35 3.73-3.41 3.73-2.07 0-3.63-1.67-3.63-3.73l.03-.36C5.21 7.51 4 10.62 4 14c0 4.42 3.58 8 8 8s8-3.58 8-8C20 8.61 17.41 3.8 13.5.67z"},{key:"pbs",title:"Personal Best Badges",iconPath:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"},{key:"nutrition",title:"Nutrition Badges",iconPath:"M18.06 23h1.66c.84 0 1.53-.65 1.63-1.47L23 5.05h-5V1h-2v4.05h-5l.3 2.34c1.71.47 3.31 1.32 4.27 2.26 1.44 1.42 2.43 2.89 2.43 5.29V23zM1 22v-1h15.03v1c0 .55-.45 1-1.01 1H2.01c-.56 0-1.01-.45-1.01-1zm15.03-7c0-4.87-4.66-5.84-8.03-5.97l.72 5.52L1 15.05v5.95h15.03V15z"},{key:"habits",title:"Habit Badges",iconPath:"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z"},{key:"leaderboard",title:"Leaderboard Badges",iconPath:"M7.5 21H2V9h5.5v12zm7.25-18h-5.5v18h5.5V3zM22 11h-5.5v10H22V11z"}].map(z=>{const fe=$d.filter(J=>J.category===z.key);if(fe.length===0)return null;const Ie=(()=>{switch(z.key){case"workouts":return Z;case"streaks":return je.streakWeeks||0;case"pbs":return Object.keys(j).length;case"nutrition":return je.nutritionStreak||0;case"leaderboard":return t?.leaderboardOptIn?1:0;case"habits":return je.habitStreak||0;default:return 0}})(),Ge=fe.filter(J=>$.includes(J.id)).length;return a.jsxs("div",{className:"ach-section",children:[a.jsxs("h3",{className:"ach-section-title",children:[a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20",children:a.jsx("path",{d:z.iconPath})}),z.title]}),a.jsx("div",{className:"ach-workout-carousel",children:fe.map(J=>{const D=$.includes(J.id);return a.jsxs("button",{className:`ach-workout-badge${D?" unlocked":" locked"}`,onClick:()=>ne(J),children:[a.jsx("img",{src:J.img,alt:J.name,className:"ach-workout-badge-img"}),!D&&J.threshold&&a.jsx("div",{className:"ach-workout-badge-progress",children:a.jsx("div",{className:"ach-workout-badge-progress-fill",style:{width:`${Math.min(Ie/J.threshold*100,100)}%`}})})]},J.id)})}),a.jsxs("p",{className:"ach-workout-badges-count",children:[Ge,"/",fe.length," unlocked"]})]},z.key)}),L&&a.jsx("div",{className:"ach-badge-overlay",onClick:()=>ne(null),children:a.jsxs("div",{className:"ach-badge-overlay-content",onClick:z=>z.stopPropagation(),children:[a.jsx("img",{src:L.img,alt:L.name,className:"ach-badge-overlay-img"}),a.jsx("p",{className:"ach-badge-overlay-desc",children:L.desc}),$.includes(L.id)?a.jsx("span",{className:"ach-badge-overlay-status unlocked",children:"Unlocked"}):a.jsx("span",{className:"ach-badge-overlay-status locked",children:"Locked"}),a.jsx("button",{className:"ach-badge-overlay-close",onClick:()=>ne(null),children:"Tap to close"})]})}),a.jsxs("div",{className:"ach-section",children:[a.jsxs("h3",{className:"ach-section-title",children:[a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20",children:a.jsx("path",{d:"M20.57 14.86L22 13.43 20.57 12 17 15.57 8.43 7 12 3.43 10.57 2 9.14 3.43 7.71 2 5.57 4.14 4.14 2.71 2.71 4.14l1.43 1.43L2 7.71l1.43 1.43L2 10.57 3.43 12 7 8.43 15.57 17 12 20.57 13.43 22l1.43-1.43L16.29 22l2.14-2.14 1.43 1.43 1.43-1.43-1.43-1.43L22 16.29z"})}),"Volume Milestones"]}),a.jsxs("div",{className:"ach-volume-hero",children:[a.jsxs("div",{className:"ach-volume-ring",children:[a.jsx("svg",{className:"ach-volume-ring-svg",viewBox:"0 0 200 200",children:ru.map((z,fe)=>{const Ie=fe<Math.round(M*60);return a.jsx("line",{x1:z.x1,y1:z.y1,x2:z.x2,y2:z.y2,className:Ie?"ach-tick-filled":"ach-tick-empty",strokeWidth:z.thick?"3":"2"},fe)})}),a.jsxs("div",{className:"ach-volume-center",children:[a.jsx("span",{className:"ach-volume-number",children:Math.round(R).toLocaleString()}),a.jsx("span",{className:"ach-volume-unit",children:"kg lifted"})]})]}),P&&a.jsxs("div",{className:"ach-volume-next",children:["Next: ",a.jsx("strong",{children:P.label})," (",(P.threshold-R).toLocaleString(),"kg to go)"]})]}),a.jsx("div",{className:"ach-milestone-shelf",children:$p.map((z,fe)=>{const Ie=R>=z.threshold,Ge=I.find(J=>J.milestone===z.threshold);return a.jsxs("div",{className:`ach-milestone ${Ie?"unlocked":"locked"}`,children:[a.jsx("div",{className:"ach-milestone-hex",children:a.jsx("span",{className:"ach-milestone-icon",children:z.icon})}),a.jsx("span",{className:"ach-milestone-label",children:z.label}),Ge?.achievedAt&&a.jsx("span",{className:"ach-milestone-date",children:(Ge.achievedAt.toDate?Ge.achievedAt.toDate():new Date(Ge.achievedAt)).toLocaleDateString("en-GB",{day:"numeric",month:"short"})})]},fe)})})]}),a.jsxs("div",{className:"ach-section",children:[a.jsxs("h3",{className:"ach-section-title",children:[a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),"PB Target Badges"]}),S.length===0?a.jsx("div",{className:"ach-pb-empty",children:a.jsxs("p",{children:["Set targets on your personal bests to start earning badges. Go to ",a.jsx("strong",{children:"My Progress"}),' and tap "Set Target" on any PB.']})}):Object.entries(V).map(([z,fe])=>{if(fe.length===0)return null;const Ie=_D[z];return a.jsxs("div",{className:"ach-group",children:[a.jsxs("div",{className:"ach-group-header",style:{borderLeftColor:Ie.color},children:[a.jsx("span",{className:"ach-group-label",style:{color:Ie.color},children:Ie.label}),a.jsx("span",{className:"ach-group-count",children:fe.length})]}),a.jsx("div",{className:"ach-badge-grid",children:fe.map((Ge,J)=>a.jsxs("div",{className:"ach-badge-card",style:{animationDelay:`${J*.06}s`,"--group-color":Ie.color},children:[a.jsx("div",{className:"ach-badge-hex",style:{borderColor:Ie.color,boxShadow:`0 0 12px ${Ie.color}33`},children:a.jsx("svg",{className:"ach-badge-hex-icon",viewBox:"0 0 24 24",fill:"none",stroke:Ie.color,strokeWidth:"2",strokeLinecap:"round",children:a.jsx("path",{d:Ie.icon})})}),a.jsxs("div",{className:"ach-badge-info",children:[a.jsx("span",{className:"ach-badge-exercise",children:Ge.exercise}),a.jsxs("span",{className:"ach-badge-value",style:{color:Ie.color},children:[Ge.targetWeight,"kg"]}),Ge.achievedAt&&a.jsx("span",{className:"ach-badge-date",children:(Ge.achievedAt.toDate?Ge.achievedAt.toDate():new Date(Ge.achievedAt)).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"})})]})]},J))})]},z)})]})]}),a.jsx(Aa,{active:"home"})]})}const ad=[{key:"trained",label:"Trained",icon:"M20.57 14.86L22 13.43 20.57 12 17 15.57 8.43 7 12 3.43 10.57 2 9.14 3.43 7.71 2 5.57 4.14 4.14 2.71 2.71 4.14l1.43 1.43L2.71 7 4.14 8.43 7.71 4.86 16.29 13.43 12.71 17 14.14 18.43 15.57 17 17 18.43 14.14 21.29l1.43 1.43 1.43-1.43 1.43 1.43 2.14-2.14 1.43 1.43L22 20.57z"},{key:"protein",label:"Hit Protein",icon:"M18 8h1a4 4 0 0 1 0 8h-1M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z"},{key:"steps",label:"10k Steps",icon:"M13.5 5.5c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zM9.8 8.9L7 23h2.1l1.8-8 2.1 2v6h2v-7.5l-2.1-2 .6-3C14.8 12 16.8 13 19 13v-2c-1.9 0-3.5-1-4.3-2.4l-1-1.6c-.4-.6-1-1-1.7-1-.3 0-.5.1-.8.1L6 8.3V13h2V9.6l1.8-.7"},{key:"sleep",label:"8hrs Sleep",icon:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"},{key:"water",label:"2L Water",icon:"M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z"}];function SD(s){const e=new Date(s),t=e.getDay(),i=t===0?-6:1-t;return e.setDate(e.getDate()+i),e.setHours(0,0,0,0),e}function Wp(s){return s.toISOString().split("T")[0]}function ND(s){return Array.from({length:7},(e,t)=>{const i=new Date(s);return i.setDate(s.getDate()+t),i})}function CD(){const{currentUser:s,isClient:e,clientData:t,loading:i}=Qr(),{isDark:l,toggleTheme:u,accent:h}=Ma(),p=nr(),[g,y]=x.useState({}),[w,k]=x.useState(!0),[j,O]=x.useState(!1),[$,U]=x.useState(0),[L,ne]=x.useState(null),[Z,ye]=x.useState(null),[je,We]=x.useState(!1),Be=x.useRef([]),R=x.useRef([]),S=x.useCallback((W,be="info")=>{ne({message:W,type:be}),setTimeout(()=>ne(null),3e3)},[]),I=new Date,V=Wp(I),P=SD(I),F=ND(P),M=["M","T","W","T","F","S","S"];x.useEffect(()=>{!i&&(!s||!e)&&p("/")},[s,e,i,p]),x.useEffect(()=>{if(!s||!t)return;(async()=>{try{const be=Wt(ve,"habitLogs"),Ne=Rn(be,ln("clientId","==",t.id)),qe=await Tn(Ne),Ae={};qe.docs.forEach(Ze=>{const Ht=Ze.data();Ae[Ht.date]={...Ht,_id:Ze.id}}),y(Ae);let rt=0;const pt=new Date(I);for(;;){const Ze=Wp(pt),Ht=Ae[Ze];if(Ht)if(Object.values(Ht.habits||{}).filter(Boolean).length>=3)rt++,pt.setDate(pt.getDate()-1);else break;else if(Ze===V)pt.setDate(pt.getDate()-1);else break}U(rt)}catch(be){console.error("Error loading habit logs:",be)}finally{k(!1)}})()},[s,t]);const He=g[V]||{habits:{}},xt=async W=>{if(!s||j)return;const be=He.habits?.[W]||!1;be||(Be.current=[...Array(10)].map((Ne,qe)=>{const Ae=qe/10*2*Math.PI,rt=18+Math.random()*20;return{tx:Math.cos(Ae)*rt,ty:Math.sin(Ae)*rt,size:3+Math.random()*4,duration:.4+Math.random()*.3}}),ye(W),setTimeout(()=>ye(null),700)),O(!0);try{const Ne=He.habits||{},qe={...Ne,[W]:!Ne[W]},Ae=He._id||`${t.id}_${V}`;await Wn(Ke(ve,"habitLogs",Ae),{clientId:t.id,date:V,habits:qe}),y(pt=>({...pt,[V]:{clientId:t.id,date:V,habits:qe,_id:Ae}})),Object.values(qe).filter(Boolean).length===ad.length&&!be&&(R.current=[...Array(50)].map((pt,Ze)=>({x:5+Math.random()*90,delay:Math.random()*.6,color:["#4caf50","#ff9800","#2196f3","#e91e63","#ffeb3b","#9c27b0"][Ze%6],drift:(Math.random()-.5)*120,spin:Math.random()*720-360,duration:1.5+Math.random()*1.5,width:4+Math.random()*8,height:4+Math.random()*10})),setTimeout(()=>{We(!0),setTimeout(()=>We(!1),3500)},500))}catch(Ne){console.error("Error saving habit:",Ne),S("Failed to save. Try again.","error")}finally{O(!1)}},z=F.map(W=>{const be=Wp(W),Ne=g[be],qe=Ne?Object.values(Ne.habits||{}).filter(Boolean).length:0;return{date:W,dateStr:be,completed:qe,total:ad.length}}),fe=z.reduce((W,be)=>W+be.completed,0),Ie=z.reduce((W,be)=>W+be.total,0),Ge=Ie>0?Math.round(fe/Ie*100):0,J=Object.values(He.habits||{}).filter(Boolean).length,D=Math.round(J/ad.length*100);return a.jsxs("div",{className:"cbc-page","data-theme":l?"dark":"light","data-accent":h,children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>p("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),i||w?a.jsx("div",{className:"cbc-loading-inline",children:a.jsx("div",{className:"cbc-loading-spinner"})}):a.jsxs("main",{className:"cbc-main",children:[a.jsxs("div",{className:"cbc-ring-section",children:[a.jsxs("div",{className:"cbc-progress-ring",children:[a.jsxs("svg",{viewBox:"0 0 200 200",children:[a.jsx("circle",{className:"cbc-arc-track",cx:"100",cy:"100",r:"80"}),a.jsx("circle",{className:"cbc-arc-fill",cx:"100",cy:"100",r:"80",strokeDasharray:2*Math.PI*80,strokeDashoffset:2*Math.PI*80-D/100*2*Math.PI*80})]}),a.jsxs("div",{className:"cbc-ring-center",children:[a.jsxs("span",{className:"cbc-ring-pct",children:[D,"%"]}),a.jsx("span",{className:"cbc-ring-label",children:"today"})]})]}),a.jsxs("div",{className:"cbc-streak",children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"var(--color-primary)",strokeWidth:"2",children:a.jsx("path",{d:"M13 2L3 14h9l-1 8 10-12h-9l1-8z"})}),a.jsx("span",{className:"cbc-streak-count",children:$}),a.jsx("span",{className:"cbc-streak-label",children:"day streak"})]})]}),a.jsxs("div",{className:"cbc-section",children:[a.jsx("h2",{className:"cbc-section-title",children:"Today's Habits"}),a.jsx("div",{className:"cbc-habits",children:ad.map(W=>{const be=He.habits?.[W.key]||!1,Ne=Z===W.key;return a.jsxs("button",{className:`cbc-habit-btn cbc-habit-${W.key} ${be?"cbc-habit-done":""} ${Ne?"cbc-habit-just-checked":""}`,onClick:()=>xt(W.key),disabled:j,children:[a.jsx("div",{className:"cbc-habit-check",children:be?a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:a.jsx("polyline",{points:"20 6 9 17 4 12",className:`cbc-check-path ${Ne?"cbc-check-animate":""}`})}):a.jsx("div",{className:"cbc-habit-circle"})}),Ne&&a.jsx("div",{className:"cbc-particles",children:Be.current.map((qe,Ae)=>a.jsx("span",{className:"cbc-particle",style:{"--tx":`${qe.tx}px`,"--ty":`${qe.ty}px`,"--size":`${qe.size}px`,animationDuration:`${qe.duration}s`}},Ae))}),a.jsx("div",{className:`cbc-habit-icon cbc-icon-${W.key}`,children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:a.jsx("path",{d:W.icon})})}),a.jsx("span",{className:"cbc-habit-label",children:W.label})]},W.key)})})]}),a.jsxs("div",{className:"cbc-section",children:[a.jsx("h2",{className:"cbc-section-title",children:"This Week"}),a.jsx("div",{className:"cbc-week-grid",children:z.map((W,be)=>{const Ne=W.dateStr===V,qe=W.total>0?W.completed/W.total:0,Ae=38,rt=2*Math.PI*Ae,pt=rt-qe*rt;return a.jsxs("div",{className:`cbc-day-ring ${Ne?"cbc-day-today":""} ${W.completed>0?"cbc-day-active":""}`,children:[a.jsxs("svg",{viewBox:"0 0 100 100",children:[a.jsx("circle",{className:"cbc-day-track",cx:"50",cy:"50",r:Ae}),a.jsx("circle",{className:"cbc-day-fill",cx:"50",cy:"50",r:Ae,strokeDasharray:rt,strokeDashoffset:pt})]}),a.jsx("span",{className:"cbc-day-label",children:M[be]}),a.jsxs("span",{className:"cbc-day-count",children:[W.completed,"/",W.total]})]},be)})}),a.jsxs("div",{className:"cbc-week-summary",children:[a.jsx("div",{className:"cbc-week-summary-bar",children:a.jsx("div",{className:"cbc-week-summary-fill",style:{width:`${Ge}%`}})}),a.jsxs("span",{className:"cbc-week-summary-text",children:[fe," / ",Ie," habits this week (",Ge,"%)"]})]})]})]}),a.jsx(Aa,{active:"home"}),je&&a.jsxs("div",{className:"cbc-celebration",onClick:()=>We(!1),children:[a.jsx("div",{className:"cbc-confetti-container",children:R.current.map((W,be)=>a.jsx("span",{className:"cbc-confetti-piece",style:{"--x":`${W.x}%`,"--delay":`${W.delay}s`,"--color":W.color,"--drift":`${W.drift}px`,"--spin":`${W.spin}deg`,"--duration":`${W.duration}s`,width:`${W.width}px`,height:`${W.height}px`}},be))}),a.jsxs("div",{className:"cbc-celebration-card",children:[a.jsxs("svg",{className:"cbc-celebration-icon",viewBox:"0 0 24 24",fill:"none",stroke:"var(--color-primary)",strokeWidth:"2",children:[a.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),a.jsx("polyline",{points:"22 4 12 14.01 9 11.01"})]}),a.jsx("h2",{className:"cbc-celebration-title",children:"Crushed it!"}),a.jsx("p",{className:"cbc-celebration-sub",children:"All habits complete today"})]})]}),L&&a.jsx("div",{className:`toast-notification ${L.type}`,children:L.message})]})}function id(s){if(!s)return"?";const e=s.trim().split(/\s+/);return e.length===1?e[0][0].toUpperCase():(e[0][0]+e[e.length-1][0]).toUpperCase()}function b2(s,e){return[s,e].sort().join("_")}function RD(){const{currentUser:s,isClient:e,clientData:t,loading:i}=Qr(),{isDark:l,toggleTheme:u}=Ma(),h=nr(),[p,g]=x.useState("buddies"),[y,w]=x.useState([]),[k,j]=x.useState([]),[O,$]=x.useState([]),[U,L]=x.useState(""),[ne,Z]=x.useState([]),[ye,je]=x.useState([]),[We,Be]=x.useState(!0),[R,S]=x.useState(null),[I,V]=x.useState(null),P=x.useCallback((J,D="info")=>{V({message:J,type:D}),setTimeout(()=>V(null),3500)},[]);x.useEffect(()=>{!i&&(!s||!e)&&h("/")},[s,e,i,h]);const F=x.useCallback(async()=>{if(t){Be(!0);try{const J=t.id,W=(await Tn(Wt(ve,"clients"))).docs.map(Ze=>({id:Ze.id,...Ze.data()}));je(W);const be=Object.fromEntries(W.map(Ze=>[Ze.id,Ze])),Ne=await Tn(Rn(Wt(ve,"buddies"),ln("user1","==",J))),qe=await Tn(Rn(Wt(ve,"buddies"),ln("user2","==",J))),Ae=new Set;[...Ne.docs,...qe.docs].forEach(Ze=>{const Ht=Ze.data(),cn=Ht.user1===J?Ht.user2:Ht.user1;Ae.add(cn)}),w(Array.from(Ae).map(Ze=>be[Ze]).filter(Boolean));const rt=await Tn(Rn(Wt(ve,"buddyRequests"),ln("toId","==",J),ln("status","==","pending")));j(rt.docs.map(Ze=>({reqId:Ze.id,...Ze.data(),fromClient:be[Ze.data().fromId]})).filter(Ze=>Ze.fromClient));const pt=await Tn(Rn(Wt(ve,"buddyRequests"),ln("fromId","==",J),ln("status","==","pending")));$(pt.docs.map(Ze=>({reqId:Ze.id,...Ze.data(),toClient:be[Ze.data().toId]})).filter(Ze=>Ze.toClient))}catch(J){console.error("Error fetching buddy data:",J),P("Failed to load buddies","error")}finally{Be(!1)}}},[t,P]);x.useEffect(()=>{F()},[F]),x.useEffect(()=>{if(!U.trim()||!t){Z([]);return}const J=U.toLowerCase(),D=t.id,W=new Set(y.map(Ae=>Ae.id)),be=new Set(O.map(Ae=>Ae.toId)),Ne=new Set(k.map(Ae=>Ae.fromId)),qe=ye.filter(Ae=>Ae.id===D||!Ae.name||!Ae.coreBuddyAccess&&Ae.clientType!=="core_buddy"?!1:Ae.name.toLowerCase().includes(J)).map(Ae=>({...Ae,isBuddy:W.has(Ae.id),isPendingOut:be.has(Ae.id),isPendingIn:Ne.has(Ae.id)})).slice(0,20);Z(qe)},[U,ye,y,O,k,t]);const M=async(J,D)=>{if(!(!t||J===t.id))try{await ai(Wt(ve,"notifications"),{toId:J,fromId:t.id,fromName:t.name||"Someone",fromPhotoURL:t.photoURL||null,type:D,read:!1,createdAt:Gr()})}catch(W){console.error("Notification error:",W),W.code==="permission-denied"&&P("Notifications blocked  check Firestore rules","error")}},He=async J=>{S(J);try{const D=`${t.id}_${J}`;await Wn(Ke(ve,"buddyRequests",D),{fromId:t.id,toId:J,status:"pending",createdAt:Gr()}),await M(J,"buddy_request"),P("Buddy request sent!","success"),await F()}catch(D){console.error("Error sending request:",D),P("Failed to send request","error")}finally{S(null)}},xt=async J=>{S(J.reqId);try{const D=b2(J.fromId,t.id);await Wn(Ke(ve,"buddies",D),{user1:[J.fromId,t.id].sort()[0],user2:[J.fromId,t.id].sort()[1],connectedAt:Gr()}),await or(Ke(ve,"buddyRequests",J.reqId)),await M(J.fromId,"buddy_accept"),P("Buddy added!","success"),await F()}catch(D){console.error("Error accepting request:",D),P("Failed to accept","error")}finally{S(null)}},z=async J=>{S(J.reqId);try{await or(Ke(ve,"buddyRequests",J.reqId)),P("Request declined","info"),await F()}catch(D){console.error("Error declining:",D),P("Failed to decline","error")}finally{S(null)}},fe=async J=>{S(J.reqId);try{await or(Ke(ve,"buddyRequests",J.reqId)),P("Request cancelled","info"),await F()}catch(D){console.error("Error cancelling:",D),P("Failed to cancel","error")}finally{S(null)}},Ie=async J=>{S(J);try{const D=b2(t.id,J);await or(Ke(ve,"buddies",D)),P("Buddy removed","info"),await F()}catch(D){console.error("Error removing buddy:",D),P("Failed to remove buddy","error")}finally{S(null)}},Ge=k.length;return i?a.jsx("div",{className:"bdy-loading",children:a.jsx("div",{className:"bdy-spinner"})}):!s||!e||!t?null:a.jsxs("div",{className:"bdy-page","data-theme":l?"dark":"light",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>h("/client/core-buddy"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"bdy-main",children:[a.jsx("h1",{className:"bdy-title",children:"Buddies"}),a.jsxs("button",{className:"bdy-leaderboard-link",onClick:()=>h("/client/leaderboard"),children:[a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5C7 4 7 7 7 7"}),a.jsx("path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5C17 4 17 7 17 7"}),a.jsx("rect",{x:"6",y:"9",width:"12",height:"13",rx:"2"}),a.jsx("path",{d:"M12 9v13"}),a.jsx("path",{d:"M2 22h20"})]}),a.jsx("span",{children:"Leaderboard"}),a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),a.jsxs("div",{className:"bdy-tabs",children:[a.jsxs("button",{className:`bdy-tab${p==="buddies"?" active":""}`,onClick:()=>g("buddies"),children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"9",cy:"7",r:"4"}),a.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),a.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),a.jsx("span",{children:"My Buddies"})]}),a.jsxs("button",{className:`bdy-tab${p==="requests"?" active":""}`,onClick:()=>g("requests"),children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"9",cy:"7",r:"4"}),a.jsx("line",{x1:"19",y1:"8",x2:"19",y2:"14"}),a.jsx("line",{x1:"22",y1:"11",x2:"16",y2:"11"})]}),a.jsx("span",{children:"Requests"}),Ge>0&&a.jsx("span",{className:"bdy-tab-badge",children:Ge})]}),a.jsxs("button",{className:`bdy-tab${p==="search"?" active":""}`,onClick:()=>g("search"),children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"11",cy:"11",r:"8"}),a.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),a.jsx("span",{children:"Find"})]})]}),We?a.jsx("div",{className:"bdy-content-loading",children:a.jsx("div",{className:"bdy-spinner"})}):a.jsxs(a.Fragment,{children:[p==="buddies"&&a.jsx("div",{className:"bdy-section",children:y.length===0?a.jsxs("div",{className:"bdy-empty",children:[a.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"9",cy:"7",r:"4"}),a.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),a.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),a.jsx("h3",{children:"No buddies yet"}),a.jsx("p",{children:"Find members and send buddy requests to connect!"}),a.jsx("button",{className:"bdy-empty-btn",onClick:()=>g("search"),children:"Find Buddies"})]}):a.jsx("div",{className:"bdy-list",children:y.map(J=>a.jsxs("div",{className:"bdy-card",onClick:()=>h(`/client/core-buddy/profile/${J.id}`),children:[a.jsx("div",{className:"bdy-avatar",children:J.photoURL?a.jsx("img",{src:J.photoURL,alt:J.name}):a.jsx("span",{children:id(J.name)})}),a.jsx("div",{className:"bdy-card-info",children:a.jsx("span",{className:"bdy-card-name",children:J.name})}),a.jsx("button",{className:"bdy-remove-btn",onClick:D=>{D.stopPropagation(),Ie(J.id)},disabled:R===J.id,"aria-label":"Remove buddy",children:R===J.id?a.jsx("div",{className:"bdy-btn-spinner"}):a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]},J.id))})}),p==="requests"&&a.jsxs("div",{className:"bdy-section",children:[k.length>0&&a.jsxs(a.Fragment,{children:[a.jsx("h3",{className:"bdy-section-title",children:"Incoming"}),a.jsx("div",{className:"bdy-list",children:k.map(J=>a.jsxs("div",{className:"bdy-card",children:[a.jsx("div",{className:"bdy-avatar",children:J.fromClient.photoURL?a.jsx("img",{src:J.fromClient.photoURL,alt:J.fromClient.name}):a.jsx("span",{children:id(J.fromClient.name)})}),a.jsxs("div",{className:"bdy-card-info",children:[a.jsx("span",{className:"bdy-card-name",children:J.fromClient.name}),a.jsx("span",{className:"bdy-card-sub",children:"wants to be your buddy"})]}),a.jsxs("div",{className:"bdy-action-pair",children:[a.jsx("button",{className:"bdy-accept-btn",onClick:()=>xt(J),disabled:R===J.reqId,children:R===J.reqId?a.jsx("div",{className:"bdy-btn-spinner"}):a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:a.jsx("path",{d:"M5 13l4 4L19 7"})})}),a.jsx("button",{className:"bdy-decline-btn",onClick:()=>z(J),disabled:R===J.reqId,children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]})]},J.reqId))})]}),O.length>0&&a.jsxs(a.Fragment,{children:[a.jsx("h3",{className:"bdy-section-title",children:"Sent"}),a.jsx("div",{className:"bdy-list",children:O.map(J=>a.jsxs("div",{className:"bdy-card",children:[a.jsx("div",{className:"bdy-avatar",children:J.toClient?.photoURL?a.jsx("img",{src:J.toClient.photoURL,alt:J.toClient.name}):a.jsx("span",{children:id(J.toClient?.name)})}),a.jsxs("div",{className:"bdy-card-info",children:[a.jsx("span",{className:"bdy-card-name",children:J.toClient?.name}),a.jsx("span",{className:"bdy-card-sub",children:"pending"})]}),a.jsx("button",{className:"bdy-cancel-btn",onClick:()=>fe(J),disabled:R===J.reqId,children:R===J.reqId?a.jsx("div",{className:"bdy-btn-spinner"}):"Cancel"})]},J.reqId))})]}),k.length===0&&O.length===0&&a.jsxs("div",{className:"bdy-empty",children:[a.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[a.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),a.jsx("path",{d:"M22 4L12 14.01l-3-3"})]}),a.jsx("h3",{children:"No pending requests"}),a.jsx("p",{children:"All caught up!"})]})]}),p==="search"&&a.jsxs("div",{className:"bdy-section",children:[a.jsxs("div",{className:"bdy-search-bar",children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"11",cy:"11",r:"8"}),a.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),a.jsx("input",{type:"text",placeholder:"Search by name...",value:U,onChange:J=>L(J.target.value),autoFocus:!0}),U&&a.jsx("button",{className:"bdy-search-clear",onClick:()=>L(""),children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),U.trim()&&ne.length===0&&a.jsx("div",{className:"bdy-empty bdy-empty-sm",children:a.jsxs("p",{children:['No members found for "',U,'"']})}),ne.length>0&&a.jsx("div",{className:"bdy-list",children:ne.map(J=>a.jsxs("div",{className:"bdy-card",onClick:()=>h(`/client/core-buddy/profile/${J.id}`),children:[a.jsx("div",{className:"bdy-avatar",children:J.photoURL?a.jsx("img",{src:J.photoURL,alt:J.name}):a.jsx("span",{children:id(J.name)})}),a.jsxs("div",{className:"bdy-card-info",children:[a.jsx("span",{className:"bdy-card-name",children:J.name}),J.isBuddy&&a.jsx("span",{className:"bdy-card-badge",children:"Buddy"})]}),J.isBuddy?a.jsx("span",{className:"bdy-status-icon",children:a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"var(--color-success)",strokeWidth:"2.5",children:a.jsx("path",{d:"M5 13l4 4L19 7"})})}):J.isPendingOut?a.jsx("span",{className:"bdy-pending-label",children:"Pending"}):J.isPendingIn?a.jsx("button",{className:"bdy-accept-btn",onClick:D=>{D.stopPropagation();const W=k.find(be=>be.fromId===J.id);W&&xt(W)},disabled:!!R,children:a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:a.jsx("path",{d:"M5 13l4 4L19 7"})})}):a.jsx("button",{className:"bdy-add-btn",onClick:D=>{D.stopPropagation(),He(J.id)},disabled:R===J.id,children:R===J.id?a.jsx("div",{className:"bdy-btn-spinner"}):a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),a.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})})]},J.id))})]})]})]}),a.jsx(Aa,{}),I&&a.jsxs("div",{className:`toast-notification ${I.type}`,children:[a.jsx("span",{className:"toast-icon",children:I.type==="success"?a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M5 13 L9 17 L19 7"})}):I.type==="error"?a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]}):a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),a.jsx("circle",{cx:"12",cy:"16",r:"1",fill:"currentColor"})]})}),a.jsx("span",{className:"toast-message",children:I.message})]})]})}function od(s){if(!s)return"?";const e=s.trim().split(/\s+/);return e.length===1?e[0][0].toUpperCase():(e[0][0]+e[e.length-1][0]).toUpperCase()}function Gp(s,e){return[s,e].sort().join("_")}const AD=5;function Kp(s){return s.toISOString().split("T")[0]}function ID(s){return s>=1e6?`${(s/1e6).toFixed(1)}M`:s>=1e3?`${(s/1e3).toFixed(1)}T`:`${Math.round(s)}`}const MD={fullbody_4wk:{duration:4,daysPerWeek:3},fullbody_8wk:{duration:8,daysPerWeek:3},fullbody_12wk:{duration:12,daysPerWeek:3},core_4wk:{duration:4,daysPerWeek:3},core_8wk:{duration:8,daysPerWeek:3},core_12wk:{duration:12,daysPerWeek:3},upper_4wk:{duration:4,daysPerWeek:3},lower_4wk:{duration:4,daysPerWeek:3}};function v2(s){if(!s)return"";const e=s instanceof Date?s:s.toDate?s.toDate():new Date(s),t=Math.floor((new Date-e)/1e3);return t<60?"just now":t<3600?`${Math.floor(t/60)}m ago`:t<86400?`${Math.floor(t/3600)}h ago`:t<604800?`${Math.floor(t/86400)}d ago`:e.toLocaleDateString("en-GB",{day:"numeric",month:"short"})}function DD(){const{userId:s}=Xj(),{currentUser:e,isClient:t,clientData:i,loading:l}=Qr(),{isDark:u,toggleTheme:h}=Ma(),p=nr(),[g,y]=x.useState(null),[w,k]=x.useState("none"),[j,O]=x.useState(null),[$,U]=x.useState(!0),[L,ne]=x.useState(!1),[Z,ye]=x.useState(null),[je,We]=x.useState([]),[Be,R]=x.useState(!1),[S,I]=x.useState(new Set),[V,P]=x.useState(new Set),[F,M]=x.useState({}),[He,xt]=x.useState({}),[z,fe]=x.useState({}),[Ie,Ge]=x.useState(!0),[J,D]=x.useState(0),[W,be]=x.useState(0),[Ne,qe]=x.useState(0),[Ae,rt]=x.useState(0),[pt,Ze]=x.useState([]),[Ht,cn]=x.useState([]),[Nt,Ct]=x.useState(null),[le,gn]=x.useState(0),[$t,St]=x.useState([]),[Bt,ht]=x.useState(!1),[et,en]=x.useState(null),[rs,Lt]=x.useState([]),Et=x.useCallback((Q,Ee="info")=>{ye({message:Q,type:Ee}),setTimeout(()=>ye(null),3500)},[]);x.useEffect(()=>{!l&&(!e||!t)&&p("/")},[e,t,l,p]),x.useEffect(()=>{i&&s&&i.id===s&&p("/client/core-buddy",{replace:!0})},[i,s,p]),x.useEffect(()=>{if(!i||!s||i.id===s)return;let Q=!1;return(async()=>{U(!0);try{const Je=(await Tn(Wt(ve,"clients"))).docs.map(tn=>({id:tn.id,...tn.data()})).find(tn=>tn.id===s);if(!Je){Q||U(!1);return}Q||y(Je);const dt=i.id,qt=Gp(dt,s);if((await Ln(Ke(ve,"buddies",qt))).exists())Q||k("buddy");else{const tn=`${dt}_${s}`,Vn=await Ln(Ke(ve,"buddyRequests",tn));if(Vn.exists()&&Vn.data().status==="pending")Q||(k("pending_out"),O(tn));else{const An=`${s}_${dt}`,sn=await Ln(Ke(ve,"buddyRequests",An));sn.exists()&&sn.data().status==="pending"?Q||(k("pending_in"),O(An)):Q||k("none")}}}catch(Ee){console.error("Error loading profile:",Ee)}finally{Q||U(!1)}})(),()=>{Q=!0}},[i,s]),x.useEffect(()=>{if(!s||!g)return;let Q=!1;return(async()=>{Ge(!0);try{const[Ee,Xe,Je,dt]=await Promise.all([Tn(Rn(Wt(ve,"workoutLogs"),ln("clientId","==",s))),Ln(Ke(ve,"coreBuddyAchievements",s)),Ln(Ke(ve,"coreBuddyPBs",s)),Ln(Ke(ve,"clientProgrammes",s))]);if(Q)return;const qt=Ee.docs.length;D(qt),Xe.exists()&&be(Xe.data().totalVolume||0);let Rt=0;const tn=Ee.docs.map(sn=>sn.data().date).filter(Boolean).sort().reverse();if(tn.length>0){const sn=new Date;let yn=new Date(sn);for(let In=0;In<52;In++){const un=new Date(yn),as=un.getDay(),H=as===0?6:as-1;un.setDate(un.getDate()-H),un.setHours(0,0,0,0);const pe=new Date(un);pe.setDate(pe.getDate()+7);const _e=Kp(un),xe=Kp(pe);if(tn.some(at=>at>=_e&&at<xe))Rt++;else{if(In>0)break;break}yn.setDate(yn.getDate()-7)}}if(Q||qe(Rt),Je.exists()){const sn=Je.data().exercises||{},yn=Object.entries(sn).sort(([,In],[,un])=>(un.weight||0)-(In.weight||0)).slice(0,3).map(([In,un])=>({name:In,weight:un.weight,reps:un.reps}));Q||Ze(yn)}if(dt.exists()){const sn=dt.data(),yn=MD[sn.templateId];if(yn){const In=Object.keys(sn.completedSessions||{}).length,un=yn.duration*yn.daysPerWeek;Q||(Ct(sn.templateId.replace(/_/g," ").replace(/\b\w/g,as=>as.toUpperCase())),gn(un>0?Math.round(In/un*100):0))}}const Vn=await Ln(Ke(ve,"achievements",s));if(!Q&&Vn.exists()){const sn=Vn.data().badges||{};cn(Object.keys(sn))}let An=0;for(let sn=0;sn<30;sn++){const yn=new Date;yn.setDate(yn.getDate()-sn);const In=Kp(yn);try{const un=await Tn(Rn(Wt(ve,"habitLogs"),ln("clientId","==",s),ln("date","==",In)));if(un.empty)break;{const as=un.docs[0].data().habits||{};if(Object.values(as).filter(Boolean).length>=AD)An++;else break}}catch{break}}Q||rt(An)}catch(Ee){console.error("Error loading buddy stats:",Ee)}finally{Q||Ge(!1)}})(),()=>{Q=!0}},[s,g]),x.useEffect(()=>{if(!i)return;const Q=i.id;(async()=>{try{const[Ee,Xe,Je]=await Promise.all([Tn(Rn(Wt(ve,"buddies"),ln("user1","==",Q))),Tn(Rn(Wt(ve,"buddies"),ln("user2","==",Q))),Tn(Wt(ve,"clients"))]),dt=new Set;[...Ee.docs,...Xe.docs].forEach(Rt=>{const tn=Rt.data();dt.add(tn.user1===Q?tn.user2:tn.user1)});const qt={};Je.docs.forEach(Rt=>{qt[Rt.id]=Rt.data()}),St(Array.from(dt).filter(Rt=>qt[Rt]).map(Rt=>({id:Rt,name:qt[Rt].name,photoURL:qt[Rt].photoURL||null})))}catch(Ee){console.error("Error loading buddies for mentions:",Ee)}})()},[i]);const Pn=async(Q,Ee,Xe={})=>{if(!(!i||Q===i.id))try{await ai(Wt(ve,"notifications"),{toId:Q,fromId:i.id,fromName:i.name||"Someone",fromPhotoURL:i.photoURL||null,type:Ee,read:!1,createdAt:Gr(),...Xe})}catch(Je){console.error("Notification error:",Je),Je.code==="permission-denied"&&Et("Notifications blocked  check Firestore rules","error")}},Ft=async()=>{ne(!0);try{const Q=`${i.id}_${s}`;await Wn(Ke(ve,"buddyRequests",Q),{fromId:i.id,toId:s,status:"pending",createdAt:Gr()}),await Pn(s,"buddy_request"),k("pending_out"),O(Q),Et("Buddy request sent!","success")}catch(Q){console.error(Q),Et("Failed to send request","error")}finally{ne(!1)}},En=async()=>{if(j){ne(!0);try{const Q=Gp(i.id,s);await Wn(Ke(ve,"buddies",Q),{user1:[i.id,s].sort()[0],user2:[i.id,s].sort()[1],connectedAt:Gr()}),await or(Ke(ve,"buddyRequests",j)),await Pn(s,"buddy_accept"),k("buddy"),Et("Buddy added!","success")}catch(Q){console.error(Q),Et("Failed to accept","error")}finally{ne(!1)}}},Kt=async()=>{if(j){ne(!0);try{await or(Ke(ve,"buddyRequests",j)),k("none"),Et(w==="pending_out"?"Request cancelled":"Request declined","info")}catch(Q){console.error(Q),Et("Failed","error")}finally{ne(!1)}}},Sn=async()=>{ne(!0);try{const Q=Gp(i.id,s);await or(Ke(ve,"buddies",Q)),k("none"),Et("Buddy removed","info")}catch(Q){console.error(Q),Et("Failed to remove","error")}finally{ne(!1)}},me=x.useCallback(async()=>{if(s){R(!0);try{const Q=await Tn(Rn(Wt(ve,"posts"),ln("authorId","==",s),qd("createdAt","desc"),Hd(30)));if(We(Q.docs.map(Ee=>({id:Ee.id,...Ee.data()}))),i){const Ee=await Tn(Rn(Wt(ve,"postLikes"),ln("userId","==",i.id)));I(new Set(Ee.docs.map(Xe=>Xe.data().postId)))}}catch(Q){console.error("Error loading journey:",Q)}finally{R(!1)}}},[s,i]);x.useEffect(()=>{!$&&g&&me()},[$,g,me]);const Se=async Q=>{if(window.confirm("Delete this post?"))try{await or(Ke(ve,"posts",Q)),We(Ee=>Ee.filter(Xe=>Xe.id!==Q)),Et("Post deleted","info")}catch(Ee){console.error("Delete error:",Ee),Et("Failed to delete","error")}},Fe=async Q=>{if(!i)return;const Ee=i.id,Xe=`${Q}_${Ee}`,Je=S.has(Q),dt=new Set(S);Je?dt.delete(Q):dt.add(Q),I(dt),We(qt=>qt.map(Rt=>Rt.id===Q?{...Rt,likeCount:Math.max(0,(Rt.likeCount||0)+(Je?-1:1))}:Rt));try{if(Je)await or(Ke(ve,"postLikes",Xe)),await Hi(Ke(ve,"posts",Q),{likeCount:Io(-1)});else{await Wn(Ke(ve,"postLikes",Xe),{postId:Q,userId:Ee,createdAt:Gr()}),await Hi(Ke(ve,"posts",Q),{likeCount:Io(1)});const qt=je.find(Rt=>Rt.id===Q);qt&&Pn(qt.authorId,"like",{postId:Q})}}catch(qt){console.error("Like error:",qt),me()}},Qe=async Q=>{try{const Ee=await Tn(Rn(Wt(ve,"postComments"),ln("postId","==",Q),qd("createdAt","asc"),Hd(50)));M(Xe=>({...Xe,[Q]:Ee.docs.map(Je=>({id:Je.id,...Je.data()}))}))}catch(Ee){console.error("Error loading comments:",Ee)}},Ue=Q=>{const Ee=new Set(V);Ee.has(Q)?Ee.delete(Q):(Ee.add(Q),F[Q]||Qe(Q)),P(Ee)},De=(Q,Ee)=>{const Xe=Q.match(/@(\w*)$/);if(Xe){ht(!0),en(Ee);const Je=$t.filter(dt=>dt.name&&dt.name.toLowerCase().includes(Xe[1].toLowerCase())).slice(0,5);Lt(Je)}else ht(!1),Lt([])},Oe=(Q,Ee)=>{const Je=(He[Ee]||"").replace(/@\w*$/,`@${Q.name} `);xt(dt=>({...dt,[Ee]:Je})),ht(!1),Lt([])},wt=(Q,Ee)=>{xt(Xe=>({...Xe,[Q]:Ee})),De(Ee,Q)},ft=async Q=>{const Ee=(He[Q]||"").trim();if(!(!Ee||!i)){fe(Xe=>({...Xe,[Q]:!0}));try{await ai(Wt(ve,"postComments"),{postId:Q,authorId:i.id,authorName:i.name||"Unknown",authorPhotoURL:i.photoURL||null,content:Ee,createdAt:Gr()}),await Hi(Ke(ve,"posts",Q),{commentCount:Io(1)});const Xe=je.find(dt=>dt.id===Q);Xe&&Pn(Xe.authorId,"comment",{postId:Q});const Je=Ee.match(/@[\w\s]+?(?=\s@|\s*$|[.,!?])/g);if(Je){const dt=new Set;Je.forEach(qt=>{const Rt=qt.slice(1).trim(),tn=$t.find(Vn=>Vn.name&&Vn.name.toLowerCase()===Rt.toLowerCase());tn&&!dt.has(tn.id)&&(dt.add(tn.id),Pn(tn.id,"mention",{postId:Q}))})}xt(dt=>({...dt,[Q]:""})),We(dt=>dt.map(qt=>qt.id===Q?{...qt,commentCount:(qt.commentCount||0)+1}:qt)),await Qe(Q)}catch(Xe){console.error("Comment error:",Xe),Et("Failed to comment","error")}finally{fe(Xe=>({...Xe,[Q]:!1}))}}};return l||$||!i?a.jsx("div",{className:"prf-loading","data-theme":u?"dark":"light",children:a.jsx("div",{className:"prf-spinner"})}):!e||!t?null:g?a.jsxs("div",{className:"prf-page","data-theme":u?"dark":"light",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>p(-1),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions",children:a.jsx("button",{onClick:h,"aria-label":"Toggle theme",children:u?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),a.jsxs("main",{className:"prf-main",children:[a.jsxs("div",{className:"prf-hero",children:[a.jsx("div",{className:"prf-avatar-lg",children:g.photoURL?a.jsx("img",{src:g.photoURL,alt:g.name}):a.jsx("span",{children:od(g.name)})}),a.jsx("h1",{className:"prf-name",children:g.name}),a.jsxs("div",{className:"prf-buddy-action",children:[w==="none"&&a.jsx("button",{className:"prf-btn prf-btn-primary",onClick:Ft,disabled:L,children:L?a.jsx("div",{className:"prf-btn-spinner"}):a.jsxs(a.Fragment,{children:[a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),a.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),"Add Buddy"]})}),w==="pending_out"&&a.jsx("button",{className:"prf-btn prf-btn-secondary",onClick:Kt,disabled:L,children:L?a.jsx("div",{className:"prf-btn-spinner dark"}):"Cancel Request"}),w==="pending_in"&&a.jsxs("div",{className:"prf-btn-pair",children:[a.jsx("button",{className:"prf-btn prf-btn-success",onClick:En,disabled:L,children:L?a.jsx("div",{className:"prf-btn-spinner"}):"Accept"}),a.jsx("button",{className:"prf-btn prf-btn-secondary",onClick:Kt,disabled:L,children:"Decline"})]}),w==="buddy"&&a.jsx("button",{className:"prf-btn prf-btn-danger",onClick:Sn,disabled:L,children:L?a.jsx("div",{className:"prf-btn-spinner"}):"Remove Buddy"})]})]}),Ie?a.jsx("div",{className:"prf-stats-loading",children:a.jsx("div",{className:"prf-spinner"})}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"prf-stats",children:[a.jsxs("div",{className:"prf-stat",children:[a.jsx("span",{className:"prf-stat-value",children:J}),a.jsx("span",{className:"prf-stat-label",children:"Workouts"})]}),a.jsxs("div",{className:"prf-stat",children:[a.jsxs("span",{className:"prf-stat-value",children:[ID(W),a.jsx("span",{className:"prf-stat-unit",children:W>=1e3?"":"kg"})]}),a.jsxs("span",{className:"prf-stat-label",children:[W>=1e6?"Million kg":W>=1e3?"Tonnes":"Volume"," Lifted"]})]}),a.jsxs("div",{className:"prf-stat",children:[a.jsxs("span",{className:"prf-stat-value",children:[Ne,a.jsx("span",{className:"prf-stat-unit",children:"wk"})]}),a.jsx("span",{className:"prf-stat-label",children:"Streak"})]})]}),(Nt||Ae>0)&&a.jsxs("div",{className:"prf-info-row",children:[Nt&&a.jsxs("div",{className:"prf-info-card info-programme",children:[a.jsx("div",{className:"prf-info-icon",children:a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M4 19.5A2.5 2.5 0 0 1 6.5 17H20"}),a.jsx("path",{d:"M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"})]})}),a.jsxs("div",{className:"prf-info-text",children:[a.jsx("span",{className:"prf-info-label",children:Nt}),a.jsx("div",{className:"prf-info-progress-bar",children:a.jsx("div",{className:"prf-info-progress-fill",style:{width:`${Math.min(le,100)}%`}})}),a.jsxs("span",{className:"prf-info-sub",children:[le,"% complete"]})]})]}),Ae>0&&a.jsxs("div",{className:"prf-info-card info-habit",children:[a.jsx("div",{className:"prf-info-icon",children:a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),a.jsx("path",{d:"M22 4L12 14.01l-3-3"})]})}),a.jsxs("div",{className:"prf-info-text",children:[a.jsxs("span",{className:"prf-info-value",children:[Ae," day",Ae!==1?"s":""]}),a.jsx("span",{className:"prf-info-sub",children:"Habit Streak"})]})]})]}),pt.length>0&&a.jsxs("div",{className:"prf-section",children:[a.jsx("h2",{className:"prf-section-title",children:"Top Lifts"}),a.jsx("div",{className:"prf-pb-list",children:pt.map((Q,Ee)=>a.jsxs("div",{className:"prf-pb-item",children:[a.jsx("div",{className:"prf-pb-rank",children:Ee===0?a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",stroke:"none",children:a.jsx("path",{d:"M12 2l2.4 7.4H22l-6 4.4 2.3 7.2L12 16.6 5.7 21l2.3-7.2-6-4.4h7.6z"})}):`#${Ee+1}`}),a.jsx("span",{className:"prf-pb-name",children:Q.name}),a.jsxs("span",{className:"prf-pb-weight",children:[Q.weight,a.jsx("span",{className:"prf-pb-unit",children:"kg"})," x",Q.reps]})]},Ee))})]}),Ht.length>0&&a.jsxs("div",{className:"prf-section",children:[a.jsxs("h2",{className:"prf-section-title",children:["Badges Earned (",Ht.length,")"]}),a.jsx("div",{className:"prf-badge-row",children:Ht.map(Q=>{const Ee=$d.find(Xe=>Xe.id===Q);return Ee?a.jsx("div",{className:"prf-badge-chip",children:a.jsx("img",{src:Ee.img,alt:Ee.name,className:"prf-badge-chip-img"})},Q):null})})]})]}),a.jsxs("div",{className:"prf-section",children:[a.jsx("h2",{className:"prf-section-title",children:`${g.name?.split(" ")[0]}'s Journey`}),Be?a.jsx("div",{className:"journey-loading",children:a.jsx("div",{className:"prf-spinner"})}):je.length===0?a.jsxs("div",{className:"journey-empty",children:[a.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),a.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),a.jsx("path",{d:"M21 15l-5-5L5 21"})]}),a.jsx("p",{children:"No posts yet"})]}):a.jsx("div",{className:"journey-list",children:je.map(Q=>a.jsxs("div",{className:"journey-post",children:[a.jsxs("div",{className:"journey-post-header",children:[a.jsx("div",{className:"journey-post-avatar",children:Q.authorPhotoURL?a.jsx("img",{src:Q.authorPhotoURL,alt:""}):a.jsx("span",{children:od(Q.authorName)})}),a.jsxs("div",{className:"journey-post-meta",children:[a.jsx("span",{className:"journey-post-name",children:Q.authorName}),a.jsx("span",{className:"journey-post-time",children:v2(Q.createdAt)})]}),Q.authorId===i.id&&a.jsx("button",{className:"journey-delete-btn",onClick:()=>Se(Q.id),"aria-label":"Delete post",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M3 6h18"}),a.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),a.jsx("path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]}),Q.content&&a.jsx("p",{className:"journey-post-content",children:Q.content}),Q.imageURL&&a.jsx("div",{className:"journey-post-image",children:a.jsx("img",{src:Q.imageURL,alt:"Post",loading:"lazy"})}),a.jsxs("div",{className:"journey-post-actions",children:[a.jsxs("button",{className:`journey-action-btn${S.has(Q.id)?" liked":""}`,onClick:()=>Fe(Q.id),children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:S.has(Q.id)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})}),a.jsx("span",{children:Q.likeCount||0})]}),a.jsxs("button",{className:`journey-action-btn${V.has(Q.id)?" active":""}`,onClick:()=>Ue(Q.id),children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})}),a.jsx("span",{children:Q.commentCount||0})]})]}),V.has(Q.id)&&a.jsxs("div",{className:"journey-comments",children:[F[Q.id]?.length>0?F[Q.id].map(Ee=>a.jsxs("div",{className:"journey-comment",children:[a.jsx("div",{className:"journey-comment-avatar",onClick:()=>p(`/client/core-buddy/profile/${Ee.authorId}`),children:Ee.authorPhotoURL?a.jsx("img",{src:Ee.authorPhotoURL,alt:""}):a.jsx("span",{children:od(Ee.authorName)})}),a.jsxs("div",{className:"journey-comment-body",children:[a.jsxs("div",{className:"journey-comment-bubble",children:[a.jsx("span",{className:"journey-comment-name",children:Ee.authorName}),a.jsx("span",{className:"journey-comment-text",children:Ee.content})]}),a.jsx("span",{className:"journey-comment-time",children:v2(Ee.createdAt)})]})]},Ee.id)):a.jsx("p",{className:"journey-no-comments",children:"No comments yet"}),a.jsxs("div",{className:"journey-comment-input",style:{position:"relative"},children:[a.jsx("input",{type:"text",placeholder:"Comment... (@ to mention)",value:He[Q.id]||"",onChange:Ee=>wt(Q.id,Ee.target.value),onKeyDown:Ee=>{Ee.key==="Enter"&&ft(Q.id)},maxLength:300}),Bt&&et===Q.id&&rs.length>0&&a.jsx("div",{className:"mention-dropdown mention-dropdown-up",children:rs.map(Ee=>a.jsxs("button",{className:"mention-option",onClick:()=>Oe(Ee,Q.id),children:[a.jsx("div",{className:"mention-option-avatar",children:Ee.photoURL?a.jsx("img",{src:Ee.photoURL,alt:""}):a.jsx("span",{children:od(Ee.name)})}),a.jsx("span",{children:Ee.name})]},Ee.id))}),a.jsx("button",{onClick:()=>ft(Q.id),disabled:!(He[Q.id]||"").trim()||z[Q.id],children:z[Q.id]?a.jsx("div",{className:"journey-btn-spinner-sm"}):a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"22",y1:"2",x2:"11",y2:"13"}),a.jsx("polygon",{points:"22 2 15 22 11 13 2 9 22 2"})]})})]})]})]},Q.id))})]})]}),a.jsx(Aa,{}),Z&&a.jsxs("div",{className:`toast-notification ${Z.type}`,children:[a.jsx("span",{className:"toast-icon",children:Z.type==="success"?a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M5 13 L9 17 L19 7"})}):Z.type==="error"?a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]}):a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),a.jsx("circle",{cx:"12",cy:"16",r:"1",fill:"currentColor"})]})}),a.jsx("span",{className:"toast-message",children:Z.message})]})]}):a.jsxs("div",{className:"prf-page","data-theme":u?"dark":"light",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>p(-1),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),a.jsx("div",{className:"header-actions"})]})}),a.jsx("main",{className:"prf-main",children:a.jsx("p",{style:{textAlign:"center",color:"var(--text-tertiary)",padding:"40px 0"},children:"User not found"})}),a.jsx(Aa,{})]})}const ra=[{key:"pressUps",name:"Press-Ups",category:"Upper Body",unit:"reps"},{key:"squats",name:"Squats",category:"Lower Body",unit:"reps"},{key:"longJump",name:"Standing Long Jump",category:"Power",unit:"distance"},{key:"deadHang",name:"Dead Hang",category:"Upper Body",unit:"time"},{key:"plank",name:"Plank",category:"Core",unit:"time"},{key:"wallSit",name:"Wall Sit",category:"Lower Body",unit:"time"},{key:"chestPress",name:"Chest Press",category:"Upper Body",unit:"weight"}],No=[{key:"weight",name:"Weight",suffix:"kg"},{key:"chest",name:"Chest",suffix:"cm"},{key:"waist",name:"Waist",suffix:"cm"},{key:"hips",name:"Hips",suffix:"cm"},{key:"leftArm",name:"Left Arm",suffix:"cm"},{key:"rightArm",name:"Right Arm",suffix:"cm"},{key:"leftThigh",name:"Left Thigh",suffix:"cm"},{key:"rightThigh",name:"Right Thigh",suffix:"cm"}];function PD(){const s=new Date;return`${s.getFullYear()}-${String(s.getMonth()+1).padStart(2,"0")}`}function aa(s){const[e,t]=s.split("-");return new Date(parseInt(e),parseInt(t)-1).toLocaleDateString("en-GB",{month:"long",year:"numeric"})}function LD(s){if(!s&&s!==0)return"-";const e=Math.floor(s/60),t=(s%60).toFixed(2);return e>0?`${e}m ${parseFloat(t).toFixed(0)}s`:`${parseFloat(t).toFixed(2)}s`}function OD(s,e){return!s&&s!==0?"-":!e&&e!==0?`${s}kg`:`${s}kg x ${e}`}function ld(s,e){if(!e)return"-";switch(s.unit){case"weight":return OD(e.weight,e.reps);case"time":return LD(e.time);case"reps":return e.reps?`${e.reps} reps`:"-";case"distance":return e.distance?`${e.distance} cm`:"-";default:return"-"}}function Sl(s,e){if(!e)return 0;switch(s.unit){case"weight":return(e.weight||0)*(e.reps||0);case"time":return e.time||0;case"reps":return e.reps||0;case"distance":return e.distance||0;default:return 0}}function Yp(s,e){return!e||e===0?null:(s-e)/e*100}function VD({data:s,exerciseKey:e,unit:t}){if(!s||s.length<2)return a.jsx("div",{className:"pb-trend-empty",children:a.jsx("p",{children:"Not enough data for trend line yet"})});const i=s.map(U=>{const L=U.benchmarks?.[e];if(!L)return 0;switch(t){case"weight":return(L.weight||0)*(L.reps||0);case"time":return L.time||0;case"reps":return L.reps||0;case"distance":return L.distance||0;default:return 0}}),l=Math.max(...i),u=Math.min(...i),h=l-u||1,p=300,g=100,y=20,w=p-y*2,k=g-y*2,j=i.map((U,L)=>{const ne=y+L/(i.length-1)*w,Z=y+k-(U-u)/h*k;return{x:ne,y:Z,value:U}}),O=j.map((U,L)=>`${L===0?"M":"L"} ${U.x} ${U.y}`).join(" "),$=O+` L ${j[j.length-1].x} ${y+k} L ${j[0].x} ${y+k} Z`;return a.jsxs("div",{className:"pb-trend-chart",children:[a.jsxs("svg",{viewBox:`0 0 ${p} ${g}`,preserveAspectRatio:"xMidYMid meet",children:[a.jsx("defs",{children:a.jsxs("linearGradient",{id:"trendGradientJr",x1:"0",y1:"0",x2:"0",y2:"1",children:[a.jsx("stop",{offset:"0%",stopColor:"var(--color-primary)",stopOpacity:"0.3"}),a.jsx("stop",{offset:"100%",stopColor:"var(--color-primary)",stopOpacity:"0.02"})]})}),a.jsx("path",{d:$,fill:"url(#trendGradientJr)"}),a.jsx("path",{d:O,fill:"none",stroke:"var(--color-primary)",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round"}),j.map((U,L)=>a.jsx("circle",{cx:U.x,cy:U.y,r:"4",fill:"var(--bg-card)",stroke:"var(--color-primary)",strokeWidth:"2"},L))]}),a.jsx("div",{className:"pb-trend-labels",children:s.map((U,L)=>a.jsxs("span",{className:"pb-trend-label",children:[U.month.split("-")[1],"/",U.month.split("-")[0].slice(2)]},L))})]})}function BD(){const[s,e]=x.useState("bests"),[t,i]=x.useState([]),[l,u]=x.useState(!0),[h,p]=x.useState(!1),[g,y]=x.useState(0),[w,k]=x.useState(!1),[j,O]=x.useState(!1),[$,U]=x.useState(!1),[L,ne]=x.useState({}),[Z,ye]=x.useState({}),[je,We]=x.useState({}),[Be,R]=x.useState({}),[S,I]=x.useState({}),[V,P]=x.useState(!1),[F,M]=x.useState({}),[He,xt]=x.useState([]),[z,fe]=x.useState(null),[Ie,Ge]=x.useState(null),[J,D]=x.useState(!1),[W,be]=x.useState(""),[Ne,qe]=x.useState(""),Ae=x.useRef(null),rt=x.useRef(0),pt=x.useRef(0),Ze=x.useRef("right"),Ht=x.useCallback(H=>{y(pe=>{const _e=Math.max(0,Math.min(ra.length-1,H));return _e===pe?pe:(Ze.current=_e>pe?"right":"left",_e)})},[]),{currentUser:cn,isClient:Nt,clientData:Ct,loading:le}=Qr(),{isDark:gn}=Ma(),$t=nr(),St=x.useCallback((H,pe="info")=>{Ge({message:H,type:pe}),setTimeout(()=>Ge(null),4e3)},[]);x.useEffect(()=>{!le&&(!cn||!Nt)&&$t("/")},[cn,Nt,le,$t]),x.useEffect(()=>{Ct&&Bt()},[Ct]);const Bt=async()=>{try{const H=Rn(Wt(ve,"juniorPBs"),ln("clientId","==",Ct.id)),_e=(await Tn(H)).docs.map(ct=>({id:ct.id,...ct.data()}));_e.sort((ct,_t)=>ct.month.localeCompare(_t.month)),i(_e);const xe=Rn(Wt(ve,"juniorPBTargets"),ln("clientId","==",Ct.id)),ge=await Tn(xe);if(!ge.empty){const ct=ge.docs[0].data();We(ct.targets||{}),R(ct.metricTargets||{}),I(ct.targets||{}),M(ct.metricTargets||{})}const at=Rn(Wt(ve,"juniorAchievements"),ln("clientId","==",Ct.id)),At=await Tn(at);At.empty||xt(At.docs[0].data().badges||[])}catch(H){console.error("Error fetching junior personal bests:",H)}u(!1)},ht=PD(),et=t.find(H=>H.month===ht),en=t.filter(H=>H.month<ht),rs=en.length>0?en[en.length-1]:null;x.useEffect(()=>{et?(ne(et.benchmarks||{}),ye(et.bodyMetrics||{})):(ne({}),ye({}))},[et?.id]);const Lt=async(H,pe)=>{const _e=[];if(H==="strength"?ra.forEach(xe=>{const ge=je[xe.key];if(!ge)return;const at=pe[xe.key];if(!at)return;let At;if(ge.targetType==="time"){if(!ge.targetValue)return;const ct=ge.startValue||0,_t=at.time||0,bt=ge.targetValue-ct;At=bt===0?_t>=ge.targetValue?1:0:Math.max(0,(_t-ct)/bt)}else if(ge.targetType==="reps"){if(!ge.targetReps)return;const ct=ge.startReps||0,_t=at.reps||0,bt=ge.targetReps-ct;At=bt===0?_t>=ge.targetReps?1:0:Math.max(0,(_t-ct)/bt)}else if(ge.targetType==="distance"){if(!ge.targetDistance)return;const ct=ge.startDistance||0,_t=at.distance||0,bt=ge.targetDistance-ct;At=bt===0?_t>=ge.targetDistance?1:0:Math.max(0,(_t-ct)/bt)}else{if(!ge.targetWeight&&!ge.targetReps)return;const ct=(ge.startWeight||0)*(ge.startReps||0),_t=(ge.targetWeight||0)*(ge.targetReps||0),bt=(at.weight||0)*(at.reps||0),bn=_t-ct;At=bn===0?bt>=_t?1:0:Math.max(0,(bt-ct)/bn)}if(At>=1){let ct,_t;ge.targetType==="time"?(ct=He.some(bt=>bt.type==="strength"&&bt.key===xe.key&&bt.targetValue===ge.targetValue),_t=`${xe.name} ${ge.targetValue}s`):ge.targetType==="reps"?(ct=He.some(bt=>bt.type==="strength"&&bt.key===xe.key&&bt.targetReps===ge.targetReps),_t=`${xe.name} ${ge.targetReps} reps`):ge.targetType==="distance"?(ct=He.some(bt=>bt.type==="strength"&&bt.key===xe.key&&bt.targetDistance===ge.targetDistance),_t=`${xe.name} ${ge.targetDistance}cm`):(ct=He.some(bt=>bt.type==="strength"&&bt.key===xe.key&&bt.targetWeight===ge.targetWeight&&bt.targetReps===ge.targetReps),_t=`${xe.name} ${ge.targetWeight}kg  ${ge.targetReps}`),ct||_e.push({type:"strength",key:xe.key,...ge.targetType==="time"?{targetType:"time",targetValue:ge.targetValue}:ge.targetType==="reps"?{targetType:"reps",targetReps:ge.targetReps}:ge.targetType==="distance"?{targetType:"distance",targetDistance:ge.targetDistance}:{targetWeight:ge.targetWeight,targetReps:ge.targetReps},achievedMonth:ht,label:_t})}}):No.forEach(xe=>{const ge=Be[xe.key];if(!ge||!ge.targetValue)return;const at=pe[xe.key];if(at==null)return;const At=ge.startValue||0,ct=ge.targetValue,_t=ct-At;(_t===0?at===ct?1:0:Math.max(0,(at-At)/_t))>=1&&(He.some(sr=>sr.type==="metric"&&sr.key===xe.key&&sr.targetValue===ct)||_e.push({type:"metric",key:xe.key,targetValue:ct,achievedMonth:ht,label:`${xe.name} ${ct}${xe.suffix}`}))}),_e.length>0){const xe=[...He,..._e];await Wn(Ke(ve,"juniorAchievements",Ct.id),{clientId:Ct.id,badges:xe,updatedAt:vt.now()}),xt(xe),fe(_e),setTimeout(()=>fe(null),5e3)}},Et=(H,pe)=>{if(H==="strength"){const _e=je[pe];if(!_e)return!1;switch(ra.find(ge=>ge.key===pe)?.unit){case"time":return He.some(ge=>ge.type==="strength"&&ge.key===pe&&ge.targetValue===_e.targetValue);case"reps":return He.some(ge=>ge.type==="strength"&&ge.key===pe&&ge.targetReps===_e.targetReps);case"distance":return He.some(ge=>ge.type==="strength"&&ge.key===pe&&ge.targetDistance===_e.targetDistance);default:return!_e.targetWeight&&!_e.targetReps?!1:He.some(ge=>ge.type==="strength"&&ge.key===pe&&ge.targetWeight===_e.targetWeight&&ge.targetReps===_e.targetReps)}}else{const _e=Be[pe];return!_e||!_e.targetValue?!1:He.some(xe=>xe.type==="metric"&&xe.key===pe&&xe.targetValue===_e.targetValue)}},Pn=async()=>{p(!0);try{const H=`${Ct.id}_${ht}`,pe=et||{};await Wn(Ke(ve,"juniorPBs",H),{clientId:Ct.id,month:ht,benchmarks:L,bodyMetrics:pe.bodyMetrics||Z||{},createdAt:pe.createdAt||vt.now(),updatedAt:vt.now()}),await Lt("strength",L),St("Benchmarks saved!","success"),k(!1),await Bt()}catch(H){console.error("Error saving benchmarks:",H),St("Failed to save. Please try again.","error")}p(!1)},Ft=async()=>{p(!0);try{const H=`${Ct.id}_${ht}`,pe=et||{};await Wn(Ke(ve,"juniorPBs",H),{clientId:Ct.id,month:ht,benchmarks:pe.benchmarks||L||{},bodyMetrics:Z,createdAt:pe.createdAt||vt.now(),updatedAt:vt.now()}),await Lt("metric",Z),St("Body metrics saved!","success"),O(!1),await Bt()}catch(H){console.error("Error saving metrics:",H),St("Failed to save. Please try again.","error")}p(!1)},En=(H,pe,_e)=>{ne(xe=>({...xe,[H]:{...xe[H],[pe]:_e===""?"":parseFloat(_e)}}))},Kt=(H,pe)=>{ye(_e=>({..._e,[H]:pe===""?"":parseFloat(pe)}))},Sn=(H,pe,_e)=>{I(xe=>({...xe,[H]:{...xe[H],[pe]:_e===""?"":parseFloat(_e)}}))},me=async()=>{p(!0);try{const H=`targets_${Ct.id}`,pe=et?.benchmarks||{},_e={};ra.forEach(xe=>{const ge=pe[xe.key];switch(xe.unit){case"time":S[xe.key]?.targetValue&&(_e[xe.key]={targetType:"time",targetValue:S[xe.key].targetValue,startValue:ge?.time||0});break;case"reps":S[xe.key]?.targetReps&&(_e[xe.key]={targetType:"reps",targetReps:S[xe.key].targetReps,startReps:ge?.reps||0});break;case"distance":S[xe.key]?.targetDistance&&(_e[xe.key]={targetType:"distance",targetDistance:S[xe.key].targetDistance,startDistance:ge?.distance||0});break;default:(S[xe.key]?.targetWeight||S[xe.key]?.targetReps)&&(_e[xe.key]={targetWeight:S[xe.key].targetWeight||0,targetReps:S[xe.key].targetReps||0,startWeight:ge?.weight||0,startReps:ge?.reps||0})}}),await Wn(Ke(ve,"juniorPBTargets",H),{clientId:Ct.id,targets:_e,metricTargets:Be,updatedAt:vt.now()}),We(_e),I(_e),St("Targets saved!","success"),U(!1)}catch(H){console.error("Error saving targets:",H),St("Failed to save targets.","error")}p(!1)},Se=(H,pe)=>{M(_e=>({..._e,[H]:{..._e[H],targetValue:pe===""?"":parseFloat(pe)}}))},Fe=async()=>{p(!0);try{const H=`targets_${Ct.id}`,pe={};No.forEach(_e=>{if(F[_e.key]?.targetValue){const xe=et?.bodyMetrics?.[_e.key]||0;pe[_e.key]={targetValue:F[_e.key].targetValue,startValue:xe}}}),await Wn(Ke(ve,"juniorPBTargets",H),{clientId:Ct.id,targets:je,metricTargets:pe,updatedAt:vt.now()}),R(pe),M(pe),St("Metric targets saved!","success"),P(!1)}catch(H){console.error("Error saving metric targets:",H),St("Failed to save targets.","error")}p(!1)},Qe=async()=>{if(window.confirm("Reset all goals? This will clear all strength and body metric targets. Your recorded benchmarks and measurements will NOT be affected.")){p(!0);try{const H=Ke(ve,"juniorPBTargets",`targets_${Ct.id}`);await or(H),We({}),R({}),I({}),M({}),St("All goals have been reset","success")}catch(H){console.error("Error resetting targets:",H),St("Failed to reset goals","error")}p(!1)}},Ue=(H,pe)=>{const _e=je[H];if(!_e||!pe)return null;if(_e.targetType==="time"){if(!_e.targetValue)return null;const ct=_e.startValue||0,_t=_e.targetValue,bt=pe.time||0,bn=_t-ct;return bn<=0?bt>=_t?1:0:Math.max(0,Math.min((bt-ct)/bn,1))}if(_e.targetType==="reps"){if(!_e.targetReps)return null;const ct=_e.startReps||0,_t=_e.targetReps,bt=pe.reps||0,bn=_t-ct;return bn<=0?bt>=_t?1:0:Math.max(0,Math.min((bt-ct)/bn,1))}if(_e.targetType==="distance"){if(!_e.targetDistance)return null;const ct=_e.startDistance||0,_t=_e.targetDistance,bt=pe.distance||0,bn=_t-ct;return bn<=0?bt>=_t?1:0:Math.max(0,Math.min((bt-ct)/bn,1))}if(!_e.targetWeight&&!_e.targetReps)return null;const xe=(_e.startWeight||0)*(_e.startReps||0),ge=(_e.targetWeight||0)*(_e.targetReps||0),at=(pe.weight||0)*(pe.reps||0),At=ge-xe;return At<=0?at>=ge?1:0:Math.max(0,Math.min((at-xe)/At,1))},De=H=>{const pe=Be[H];if(!pe||!pe.targetValue)return null;const _e=et?.bodyMetrics?.[H];if(_e==null)return null;const xe=pe.startValue||0,ge=pe.targetValue,at=ge-xe;return at===0?_e===ge?1:0:Math.max(0,Math.min((_e-xe)/at,1))},Oe=H=>{rt.current=H.touches[0].clientX,pt.current=0},wt=H=>{pt.current=H.touches[0].clientX-rt.current},ft=()=>{pt.current<-50?Ht(g+1):pt.current>50&&Ht(g-1),pt.current=0},Q=H=>{const pe=et?.bodyMetrics?.[H],_e=rs?.bodyMetrics?.[H];return pe==null||_e==null?null:parseFloat((pe-_e).toFixed(2))},Ee=t.find(H=>H.month===W),Xe=t.find(H=>H.month===Ne);if(le||l)return a.jsxs("div",{className:"pb-page",children:[a.jsx("header",{className:"client-header",children:a.jsx("div",{className:"header-content",children:a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})})}),a.jsxs("main",{className:"pb-main",children:[a.jsx("div",{className:"skeleton skeleton-title",style:{width:180,height:28,marginBottom:20}}),a.jsx("div",{className:"skeleton skeleton-card-large",style:{height:320,borderRadius:16}})]})]});if(!cn||!Nt||!Ct)return null;const Je=ra[g],dt=et?.benchmarks?.[Je.key],qt=rs?.benchmarks?.[Je.key],Rt=Sl(Je,dt),tn=Sl(Je,qt),Vn=Yp(Rt,tn),An=Ue(Je.key,dt),sn=An!==null,yn=An!==null&&An>=1,In=sn?Math.round(An*60):Rt>0?15:0,un=je[Je.key],as=H=>H?H.targetType==="time"?`${H.startValue||0}s  ${H.targetValue}s`:H.targetType==="reps"?`${H.startReps||0}  ${H.targetReps} reps`:H.targetType==="distance"?`${H.startDistance||0}  ${H.targetDistance}cm`:`${H.startWeight||0}kg${H.startReps||0}  ${H.targetWeight}kg${H.targetReps}`:null;return a.jsxs("div",{className:"pb-page",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>$t("/client"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})]})}),a.jsxs("main",{className:"pb-main page-transition-enter",children:[a.jsxs("div",{className:"pb-intro",children:[a.jsx("h2",{children:"Junior Strength Tests"}),a.jsx("p",{children:"Track your strength test results and body measurements each month."})]}),a.jsxs("div",{className:"pb-tabs",children:[a.jsx("button",{className:`pb-tab ${s==="bests"?"active":""}`,onClick:()=>e("bests"),children:"Strength"}),a.jsx("button",{className:`pb-tab ${s==="metrics"?"active":""}`,onClick:()=>e("metrics"),children:"Body Metrics"}),a.jsx("button",{className:`pb-tab ${s==="history"?"active":""}`,onClick:()=>e("history"),children:"History"})]}),s==="bests"&&a.jsxs("div",{className:"pb-strength-section",children:[!w&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"pb-carousel",ref:Ae,onTouchStart:Oe,onTouchMove:wt,onTouchEnd:ft,children:[a.jsx("div",{className:`pb-ring-container slide-from-${Ze.current}`,children:a.jsxs("div",{className:"pb-ring",children:[a.jsx("svg",{className:"pb-ring-svg",viewBox:"0 0 200 200",children:$y.map((H,pe)=>{const _e=pe<Math.round(In);return a.jsx("line",{x1:H.x1,y1:H.y1,x2:H.x2,y2:H.y2,className:`pb-ring-tick ${_e?yn?"hit":"filled":"empty"}`,strokeWidth:H.thick?"3":"2"},pe)})}),a.jsxs("div",{className:"pb-ring-center",children:[a.jsx("div",{className:"pb-ring-category",children:Je.category}),a.jsxs("div",{className:"pb-ring-exercise",children:[Je.name,Et("strength",Je.key)&&a.jsx("svg",{className:"pb-badge-icon",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})]}),a.jsx("div",{className:"pb-ring-value",children:dt?ld(Je,dt):"-"}),Vn!==null&&a.jsxs("div",{className:`pb-ring-change ${Vn>=0?"positive":"negative"}`,children:[Vn>=0?"+":"",Vn.toFixed(1),"%"]}),Vn===null&&dt&&a.jsx("div",{className:"pb-ring-change neutral",children:"New entry"}),un&&a.jsx("div",{className:`pb-ring-target ${yn?"hit":""}`,children:yn?"Target hit!":as(un)}),!un&&a.jsx("div",{className:"pb-ring-target none",children:"No target set"})]})]})},g),a.jsx("div",{className:"pb-carousel-dots",children:ra.map((H,pe)=>a.jsx("button",{className:`pb-dot ${pe===g?"active":""}`,onClick:()=>Ht(pe)},pe))}),a.jsx("button",{className:"pb-carousel-arrow left",onClick:()=>Ht(g-1),disabled:g===0,children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"})})}),a.jsx("button",{className:"pb-carousel-arrow right",onClick:()=>Ht(g+1),disabled:g===ra.length-1,children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M8.59 16.59L10 18l6-6-6-6-1.41 1.41L13.17 12z"})})})]}),a.jsxs("div",{className:"pb-trend-section",children:[a.jsx("h4",{children:"Trend"}),a.jsx(VD,{data:t,exerciseKey:Je.key,unit:Je.unit})]})]}),!w&&!$&&a.jsxs("div",{className:"pb-action-buttons",children:[a.jsx("button",{className:"pb-edit-btn",onClick:()=>k(!0),children:et?.benchmarks?"Edit This Month's Benchmarks":"Add This Month's Benchmarks"}),a.jsx("button",{className:"pb-edit-btn pb-target-btn",onClick:()=>U(!0),children:Object.keys(je).length>0?"Edit Targets":"Set Targets"}),(Object.keys(je).length>0||Object.keys(Be).length>0)&&a.jsx("button",{className:"pb-edit-btn pb-reset-btn",onClick:Qe,disabled:h,children:"Reset All Goals"})]}),w&&a.jsxs("div",{className:"pb-edit-card",children:[a.jsxs("div",{className:"pb-edit-header",children:[a.jsxs("h3",{children:["Benchmarks - ",aa(ht)]}),a.jsx("button",{className:"pb-edit-close",onClick:()=>{k(!1),ne(et?.benchmarks||{})},children:""})]}),a.jsx("div",{className:"pb-edit-body",children:ra.map(H=>a.jsxs("div",{className:"pb-edit-exercise",children:[a.jsx("div",{className:"pb-edit-exercise-name",children:H.name}),H.unit==="weight"?a.jsxs("div",{className:"pb-edit-row",children:[a.jsxs("div",{className:"pb-edit-field",children:[a.jsx("label",{children:"Weight (kg)"}),a.jsx("input",{type:"number",step:"0.5",value:L[H.key]?.weight??"",onChange:pe=>En(H.key,"weight",pe.target.value),placeholder:"0"})]}),a.jsxs("div",{className:"pb-edit-field",children:[a.jsx("label",{children:"Reps"}),a.jsx("input",{type:"number",value:L[H.key]?.reps??"",onChange:pe=>En(H.key,"reps",pe.target.value),placeholder:"0"})]})]}):H.unit==="reps"?a.jsx("div",{className:"pb-edit-row",children:a.jsxs("div",{className:"pb-edit-field full",children:[a.jsx("label",{children:"Reps (max in 1 min)"}),a.jsx("input",{type:"number",value:L[H.key]?.reps??"",onChange:pe=>En(H.key,"reps",pe.target.value),placeholder:"0"})]})}):H.unit==="distance"?a.jsx("div",{className:"pb-edit-row",children:a.jsxs("div",{className:"pb-edit-field full",children:[a.jsx("label",{children:"Distance (cm)"}),a.jsx("input",{type:"number",step:"0.5",value:L[H.key]?.distance??"",onChange:pe=>En(H.key,"distance",pe.target.value),placeholder:"0"})]})}):a.jsx("div",{className:"pb-edit-row",children:a.jsxs("div",{className:"pb-edit-field full",children:[a.jsx("label",{children:"Time (seconds)"}),a.jsx("input",{type:"number",step:"0.01",value:L[H.key]?.time??"",onChange:pe=>En(H.key,"time",pe.target.value),placeholder:"0"})]})})]},H.key))}),a.jsxs("div",{className:"pb-edit-actions",children:[a.jsx("button",{className:"pb-cancel-btn",onClick:()=>{k(!1),ne(et?.benchmarks||{})},children:"Cancel"}),a.jsx("button",{className:"pb-save-btn",onClick:Pn,disabled:h,children:h?"Saving...":"Save"})]})]}),$&&a.jsxs("div",{className:"pb-edit-card",children:[a.jsxs("div",{className:"pb-edit-header",children:[a.jsx("h3",{children:"Set Your Targets"}),a.jsx("button",{className:"pb-edit-close",onClick:()=>{U(!1),I(je)},children:""})]}),a.jsxs("div",{className:"pb-edit-body",children:[a.jsx("p",{className:"pb-target-hint",children:"Set a target for each exercise. Your current best is captured automatically from your latest benchmarks."}),ra.map(H=>{const pe=et?.benchmarks?.[H.key];let _e="-";if(pe)switch(H.unit){case"weight":(pe.weight||pe.reps)&&(_e=`${pe.weight||0}kg  ${pe.reps||0}`);break;case"time":pe.time&&(_e=`${pe.time}s`);break;case"reps":pe.reps&&(_e=`${pe.reps} reps`);break;case"distance":pe.distance&&(_e=`${pe.distance} cm`);break}return a.jsxs("div",{className:"pb-edit-exercise",children:[a.jsxs("div",{className:"pb-edit-exercise-header",children:[a.jsx("div",{className:"pb-edit-exercise-name",children:H.name}),a.jsxs("div",{className:"pb-edit-current-best",children:["Current: ",_e]})]}),H.unit==="weight"?a.jsxs("div",{className:"pb-edit-row",children:[a.jsxs("div",{className:"pb-edit-field",children:[a.jsx("label",{children:"Target Weight (kg)"}),a.jsx("input",{type:"number",step:"0.5",value:S[H.key]?.targetWeight??"",onChange:xe=>Sn(H.key,"targetWeight",xe.target.value),placeholder:"0"})]}),a.jsxs("div",{className:"pb-edit-field",children:[a.jsx("label",{children:"Target Reps"}),a.jsx("input",{type:"number",value:S[H.key]?.targetReps??"",onChange:xe=>Sn(H.key,"targetReps",xe.target.value),placeholder:"0"})]})]}):H.unit==="reps"?a.jsx("div",{className:"pb-edit-row",children:a.jsxs("div",{className:"pb-edit-field full",children:[a.jsx("label",{children:"Target Reps (in 1 min)"}),a.jsx("input",{type:"number",value:S[H.key]?.targetReps??"",onChange:xe=>Sn(H.key,"targetReps",xe.target.value),placeholder:"0"})]})}):H.unit==="distance"?a.jsx("div",{className:"pb-edit-row",children:a.jsxs("div",{className:"pb-edit-field full",children:[a.jsx("label",{children:"Target Distance (cm)"}),a.jsx("input",{type:"number",step:"0.5",value:S[H.key]?.targetDistance??"",onChange:xe=>Sn(H.key,"targetDistance",xe.target.value),placeholder:"0"})]})}):a.jsx("div",{className:"pb-edit-row",children:a.jsxs("div",{className:"pb-edit-field full",children:[a.jsx("label",{children:"Target (seconds)"}),a.jsx("input",{type:"number",step:"1",value:S[H.key]?.targetValue??"",onChange:xe=>Sn(H.key,"targetValue",xe.target.value),placeholder:"0"})]})})]},H.key)})]}),a.jsxs("div",{className:"pb-edit-actions",children:[a.jsx("button",{className:"pb-cancel-btn",onClick:()=>{U(!1),I(je)},children:"Cancel"}),a.jsx("button",{className:"pb-save-btn",onClick:me,disabled:h,children:h?"Saving...":"Save Targets"})]})]})]}),s==="metrics"&&a.jsxs("div",{className:"pb-metrics-section",children:[!j&&!V&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"pb-metrics-card",children:[a.jsx("h3",{children:"Body Measurements"}),a.jsx("p",{className:"pb-metrics-month",children:aa(ht)}),a.jsx("div",{className:"pb-metrics-list",children:No.map(H=>{const pe=et?.bodyMetrics?.[H.key],_e=Q(H.key),xe=Be[H.key],ge=De(H.key),at=ge!==null&&ge>=1;return a.jsxs("div",{className:"pb-metric-row",children:[a.jsxs("div",{className:"pb-metric-top",children:[a.jsxs("div",{className:"pb-metric-left",children:[a.jsxs("span",{className:"pb-metric-name",children:[H.name,Et("metric",H.key)&&a.jsx("svg",{className:"pb-badge-icon-sm",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})]}),xe&&a.jsxs("span",{className:"pb-metric-target-label",children:["Target: ",xe.targetValue," ",H.suffix]})]}),a.jsxs("div",{className:"pb-metric-values",children:[a.jsx("span",{className:"pb-metric-current",children:pe!=null?`${pe} ${H.suffix}`:"-"}),_e!==null&&a.jsxs("span",{className:`pb-metric-change ${_e>0?"up":_e<0?"down":"same"}`,children:[_e>0?"+":"",_e," ",H.suffix]})]})]}),ge!==null&&a.jsxs("div",{className:"pb-metric-progress",children:[a.jsx("div",{className:"pb-metric-bar",children:a.jsx("div",{className:`pb-metric-bar-fill ${at?"hit":""}`,style:{width:`${Math.round(ge*100)}%`}})}),a.jsx("span",{className:`pb-metric-percent ${at?"hit":""}`,children:at?"Hit!":`${Math.round(ge*100)}%`})]})]},H.key)})})]}),a.jsxs("div",{className:"pb-action-buttons",children:[a.jsx("button",{className:"pb-edit-btn",onClick:()=>O(!0),children:et?.bodyMetrics?"Edit This Month's Measurements":"Add This Month's Measurements"}),a.jsx("button",{className:"pb-edit-btn pb-target-btn",onClick:()=>P(!0),children:Object.keys(Be).length>0?"Edit Targets":"Set Targets"}),(Object.keys(je).length>0||Object.keys(Be).length>0)&&a.jsx("button",{className:"pb-edit-btn pb-reset-btn",onClick:Qe,disabled:h,children:"Reset All Goals"})]})]}),j&&a.jsxs("div",{className:"pb-edit-card",children:[a.jsxs("div",{className:"pb-edit-header",children:[a.jsxs("h3",{children:["Measurements - ",aa(ht)]}),a.jsx("button",{className:"pb-edit-close",onClick:()=>{O(!1),ye(et?.bodyMetrics||{})},children:""})]}),a.jsx("div",{className:"pb-edit-body",children:No.map(H=>a.jsx("div",{className:"pb-edit-metric",children:a.jsxs("div",{className:"pb-edit-field full",children:[a.jsxs("label",{children:[H.name," (",H.suffix,")"]}),a.jsx("input",{type:"number",step:"0.1",value:Z[H.key]??"",onChange:pe=>Kt(H.key,pe.target.value),placeholder:"0"})]})},H.key))}),a.jsxs("div",{className:"pb-edit-actions",children:[a.jsx("button",{className:"pb-cancel-btn",onClick:()=>{O(!1),ye(et?.bodyMetrics||{})},children:"Cancel"}),a.jsx("button",{className:"pb-save-btn",onClick:Ft,disabled:h,children:h?"Saving...":"Save"})]})]}),V&&a.jsxs("div",{className:"pb-edit-card",children:[a.jsxs("div",{className:"pb-edit-header",children:[a.jsx("h3",{children:"Body Metric Targets"}),a.jsx("button",{className:"pb-edit-close",onClick:()=>{P(!1),M(Be)},children:""})]}),a.jsxs("div",{className:"pb-edit-body",children:[a.jsx("p",{className:"pb-target-hint",children:"Set targets for your body measurements. Your current measurement is captured automatically."}),No.map(H=>{const pe=et?.bodyMetrics?.[H.key];return a.jsxs("div",{className:"pb-edit-exercise",children:[a.jsxs("div",{className:"pb-edit-exercise-header",children:[a.jsx("div",{className:"pb-edit-exercise-name",children:H.name}),a.jsxs("div",{className:"pb-edit-current-best",children:["Current: ",pe!=null?`${pe} ${H.suffix}`:"-"]})]}),a.jsx("div",{className:"pb-edit-row",children:a.jsxs("div",{className:"pb-edit-field full",children:[a.jsxs("label",{children:["Target (",H.suffix,")"]}),a.jsx("input",{type:"number",step:"0.1",value:F[H.key]?.targetValue??"",onChange:_e=>Se(H.key,_e.target.value),placeholder:"0"})]})})]},H.key)})]}),a.jsxs("div",{className:"pb-edit-actions",children:[a.jsx("button",{className:"pb-cancel-btn",onClick:()=>{P(!1),M(Be)},children:"Cancel"}),a.jsx("button",{className:"pb-save-btn",onClick:Fe,disabled:h,children:h?"Saving...":"Save Targets"})]})]})]}),s==="history"&&a.jsx("div",{className:"pb-history-section",children:t.length===0?a.jsxs("div",{className:"pb-empty",children:[a.jsx("h4",{children:"No records yet"}),a.jsx("p",{children:"Start adding your monthly benchmarks and measurements to track your progress over time."})]}):a.jsxs(a.Fragment,{children:[He.length>0&&a.jsxs("div",{className:"pb-achievements-wall",children:[a.jsxs("h4",{className:"pb-achievements-wall-title",children:[a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"18",height:"18",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),"Targets Achieved"]}),a.jsx("div",{className:"pb-achievements-list",children:[...He].reverse().map((H,pe)=>a.jsxs("div",{className:"pb-achievement-item",style:{animationDelay:`${pe*.05}s`},children:[a.jsx("div",{className:"pb-achievement-star",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),a.jsxs("div",{className:"pb-achievement-info",children:[a.jsx("span",{className:"pb-achievement-label",children:H.label}),a.jsx("span",{className:"pb-achievement-date",children:aa(H.achievedMonth)})]})]},pe))})]}),a.jsx("div",{className:"pb-history-controls",children:a.jsx("button",{className:`pb-compare-toggle ${J?"active":""}`,onClick:()=>{D(!J),!J&&t.length>=2&&(be(t[0].month),qe(t[t.length-1].month))},children:J?"Back to Timeline":"Compare Months"})}),J?a.jsxs("div",{className:"pb-compare",children:[a.jsxs("div",{className:"pb-compare-selectors",children:[a.jsxs("div",{className:"pb-compare-select",children:[a.jsx("label",{children:"From"}),a.jsx("select",{value:W,onChange:H=>be(H.target.value),children:t.map(H=>a.jsx("option",{value:H.month,children:aa(H.month)},H.month))})]}),a.jsx("div",{className:"pb-compare-vs",children:"vs"}),a.jsxs("div",{className:"pb-compare-select",children:[a.jsx("label",{children:"To"}),a.jsx("select",{value:Ne,onChange:H=>qe(H.target.value),children:t.map(H=>a.jsx("option",{value:H.month,children:aa(H.month)},H.month))})]})]}),Ee&&Xe&&a.jsxs("div",{className:"pb-compare-results",children:[a.jsxs("div",{className:"pb-compare-group",children:[a.jsx("h4",{children:"Strength Tests"}),a.jsxs("div",{className:"pb-compare-table",children:[a.jsxs("div",{className:"pb-compare-header-row",children:[a.jsx("span",{children:"Exercise"}),a.jsx("span",{children:aa(W).split(" ")[0]}),a.jsx("span",{children:aa(Ne).split(" ")[0]}),a.jsx("span",{children:"Change"})]}),ra.map(H=>{const pe=Ee.benchmarks?.[H.key],_e=Xe.benchmarks?.[H.key],xe=Sl(H,pe),ge=Sl(H,_e),at=Yp(ge,xe);return a.jsxs("div",{className:"pb-compare-row",children:[a.jsx("span",{className:"pb-compare-name",children:H.name}),a.jsx("span",{className:"pb-compare-val",children:pe?ld(H,pe):"-"}),a.jsx("span",{className:"pb-compare-val",children:_e?ld(H,_e):"-"}),a.jsx("span",{className:`pb-compare-change ${at!==null?at>=0?"positive":"negative":""}`,children:at!==null?`${at>=0?"+":""}${at.toFixed(1)}%`:"-"})]},H.key)})]})]}),a.jsxs("div",{className:"pb-compare-group",children:[a.jsx("h4",{children:"Body Measurements"}),a.jsxs("div",{className:"pb-compare-table",children:[a.jsxs("div",{className:"pb-compare-header-row",children:[a.jsx("span",{children:"Measurement"}),a.jsx("span",{children:aa(W).split(" ")[0]}),a.jsx("span",{children:aa(Ne).split(" ")[0]}),a.jsx("span",{children:"Change"})]}),No.map(H=>{const pe=Ee.bodyMetrics?.[H.key],_e=Xe.bodyMetrics?.[H.key],xe=pe!=null&&_e!=null?parseFloat((_e-pe).toFixed(2)):null;return a.jsxs("div",{className:"pb-compare-row",children:[a.jsx("span",{className:"pb-compare-name",children:H.name}),a.jsx("span",{className:"pb-compare-val",children:pe!=null?`${pe}`:"-"}),a.jsx("span",{className:"pb-compare-val",children:_e!=null?`${_e}`:"-"}),a.jsx("span",{className:`pb-compare-change ${xe!==null?xe>0?"positive":xe<0?"negative":"neutral":""}`,children:xe!==null?`${xe>0?"+":""}${xe} ${H.suffix}`:"-"})]},H.key)})]})]})]})]}):a.jsx("div",{className:"pb-timeline",children:[...t].reverse().map((H,pe)=>{const _e=t.filter(xe=>xe.month<H.month).pop();return a.jsxs("div",{className:"pb-timeline-item",style:{animationDelay:`${pe*.05}s`},children:[a.jsx("div",{className:"pb-timeline-dot"}),a.jsxs("div",{className:"pb-timeline-card",children:[a.jsx("h4",{children:aa(H.month)}),H.benchmarks&&Object.keys(H.benchmarks).length>0&&a.jsxs("div",{className:"pb-timeline-group",children:[a.jsx("h5",{children:"Strength Tests"}),ra.map(xe=>{const ge=H.benchmarks[xe.key];if(!ge)return null;const at=_e?.benchmarks?.[xe.key],At=Sl(xe,ge),ct=Sl(xe,at),_t=Yp(At,ct);return a.jsxs("div",{className:"pb-timeline-row",children:[a.jsx("span",{className:"pb-timeline-label",children:xe.name}),a.jsxs("div",{className:"pb-timeline-values",children:[a.jsx("span",{className:"pb-timeline-value",children:ld(xe,ge)}),_t!==null&&a.jsxs("span",{className:`pb-timeline-change ${_t>=0?"positive":"negative"}`,children:[_t>=0?"+":"",_t.toFixed(1),"%"]})]})]},xe.key)})]}),H.bodyMetrics&&Object.keys(H.bodyMetrics).length>0&&a.jsxs("div",{className:"pb-timeline-group",children:[a.jsx("h5",{children:"Body Measurements"}),No.map(xe=>{const ge=H.bodyMetrics[xe.key];if(ge==null)return null;const at=_e?.bodyMetrics?.[xe.key],At=at!=null?parseFloat((ge-at).toFixed(2)):null;return a.jsxs("div",{className:"pb-timeline-row",children:[a.jsx("span",{className:"pb-timeline-label",children:xe.name}),a.jsxs("div",{className:"pb-timeline-values",children:[a.jsxs("span",{className:"pb-timeline-value",children:[ge," ",xe.suffix]}),At!==null&&a.jsxs("span",{className:`pb-timeline-change ${At>0?"positive":At<0?"negative":"neutral"}`,children:[At>0?"+":"",At," ",xe.suffix]})]})]},xe.key)})]})]})]},H.id)})})]})})]}),z&&a.jsx("div",{className:"pb-celebration-overlay",onClick:()=>fe(null),children:a.jsxs("div",{className:"pb-celebration-card",children:[a.jsx("div",{className:"pb-celebration-icon",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),a.jsx("h3",{className:"pb-celebration-title",children:z.length===1?"Target Achieved!":`${z.length} Targets Achieved!`}),a.jsx("div",{className:"pb-celebration-badges",children:z.map((H,pe)=>a.jsx("div",{className:"pb-celebration-badge",children:H.label},pe))}),a.jsx("p",{className:"pb-celebration-sub",children:"Tap to dismiss"})]})}),Ie&&a.jsxs("div",{className:`toast-notification ${Ie.type}`,children:[a.jsx("span",{className:"toast-icon",children:Ie.type==="success"?a.jsx("svg",{className:"success-check-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{className:"check-path",d:"M5 13 L9 17 L19 7"})}):a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})}),a.jsx("span",{className:"toast-message",children:Ie.message}),a.jsx("button",{className:"toast-close",onClick:()=>Ge(null),children:""})]}),a.jsxs("nav",{className:"block-bottom-nav",children:[a.jsxs("button",{className:"block-nav-tab",onClick:()=>$t("/client"),children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}),a.jsx("polyline",{points:"9 22 9 12 15 12 15 22"})]}),a.jsx("span",{children:"Home"})]}),a.jsxs("button",{className:"block-nav-tab",onClick:()=>$t("/client/forms"),children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),a.jsx("polyline",{points:"14 2 14 8 20 8"}),a.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),a.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"})]}),a.jsx("span",{children:"Forms"})]}),a.jsxs("button",{className:"block-nav-tab",onClick:()=>$t("/client/tools"),children:[a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"})}),a.jsx("span",{children:"Tools"})]}),a.jsxs("button",{className:"block-nav-tab active",children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M12 20V10"}),a.jsx("path",{d:"M18 20V4"}),a.jsx("path",{d:"M6 20v-4"})]}),a.jsx("span",{children:"PBs"})]}),Ct?.circuitAccess&&a.jsxs("button",{className:"block-nav-tab",onClick:()=>$t("/client/circuit"),children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("path",{d:"M12 6v6l4 2"})]}),a.jsx("span",{children:"Circuit"})]})]})]})}const xa=[{key:"chestPress",name:"Chest Press",category:"Upper Body - Push",unit:"weight"},{key:"shoulderPress",name:"Shoulder Press",category:"Upper Body - Push",unit:"weight"},{key:"seatedRow",name:"Seated Row",category:"Upper Body - Pull",unit:"weight"},{key:"latPulldown",name:"Lat Pulldown",category:"Upper Body - Pull",unit:"weight"},{key:"squat",name:"Squat",category:"Lower Body",unit:"weight"},{key:"deadlift",name:"Deadlift",category:"Lower Body",unit:"weight"},{key:"plank",name:"Plank",category:"Core",unit:"time"}],Co=[{key:"weight",name:"Weight",suffix:"kg"},{key:"chest",name:"Chest",suffix:"cm"},{key:"waist",name:"Waist",suffix:"cm"},{key:"hips",name:"Hips",suffix:"cm"},{key:"leftArm",name:"Left Arm",suffix:"cm"},{key:"rightArm",name:"Right Arm",suffix:"cm"},{key:"leftThigh",name:"Left Thigh",suffix:"cm"},{key:"rightThigh",name:"Right Thigh",suffix:"cm"}];function UD(){const s=new Date;return`${s.getFullYear()}-${String(s.getMonth()+1).padStart(2,"0")}`}function ia(s){const[e,t]=s.split("-");return new Date(parseInt(e),parseInt(t)-1).toLocaleDateString("en-GB",{month:"long",year:"numeric"})}function cd(s){if(!s&&s!==0)return"-";const e=Math.floor(s/60),t=(s%60).toFixed(2);return e>0?`${e}m ${parseFloat(t).toFixed(0)}s`:`${parseFloat(t).toFixed(2)}s`}function x2(s,e){return!s&&s!==0?"-":!e&&e!==0?`${s}kg`:`${s}kg x ${e}`}function Nl(s,e){return e?s.unit==="time"?e.time||0:(e.weight||0)*(e.reps||0):0}function Qp(s,e){return!e||e===0?null:(s-e)/e*100}function zD({data:s,exerciseKey:e,unit:t}){if(!s||s.length<2)return a.jsx("div",{className:"pb-trend-empty",children:a.jsx("p",{children:"Not enough data for trend line yet"})});const i=s.map(U=>{const L=U.benchmarks?.[e];return L?t==="time"?L.time||0:(L.weight||0)*(L.reps||0):0}),l=Math.max(...i),u=Math.min(...i),h=l-u||1,p=300,g=100,y=20,w=p-y*2,k=g-y*2,j=i.map((U,L)=>{const ne=y+L/(i.length-1)*w,Z=y+k-(U-u)/h*k;return{x:ne,y:Z,value:U}}),O=j.map((U,L)=>`${L===0?"M":"L"} ${U.x} ${U.y}`).join(" "),$=O+` L ${j[j.length-1].x} ${y+k} L ${j[0].x} ${y+k} Z`;return a.jsxs("div",{className:"pb-trend-chart",children:[a.jsxs("svg",{viewBox:`0 0 ${p} ${g}`,preserveAspectRatio:"xMidYMid meet",children:[a.jsx("defs",{children:a.jsxs("linearGradient",{id:"trendGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[a.jsx("stop",{offset:"0%",stopColor:"var(--color-primary)",stopOpacity:"0.3"}),a.jsx("stop",{offset:"100%",stopColor:"var(--color-primary)",stopOpacity:"0.02"})]})}),a.jsx("path",{d:$,fill:"url(#trendGradient)"}),a.jsx("path",{d:O,fill:"none",stroke:"var(--color-primary)",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round"}),j.map((U,L)=>a.jsx("circle",{cx:U.x,cy:U.y,r:"4",fill:"var(--bg-card)",stroke:"var(--color-primary)",strokeWidth:"2"},L))]}),a.jsx("div",{className:"pb-trend-labels",children:s.map((U,L)=>a.jsxs("span",{className:"pb-trend-label",children:[U.month.split("-")[1],"/",U.month.split("-")[0].slice(2)]},L))})]})}function FD(){const[s,e]=x.useState("bests"),[t,i]=x.useState([]),[l,u]=x.useState(!0),[h,p]=x.useState(!1),[g,y]=x.useState(0),[w,k]=x.useState(!1),[j,O]=x.useState(!1),[$,U]=x.useState(!1),[L,ne]=x.useState({}),[Z,ye]=x.useState({}),[je,We]=x.useState({}),[Be,R]=x.useState({}),[S,I]=x.useState({}),[V,P]=x.useState(!1),[F,M]=x.useState({}),[He,xt]=x.useState([]),[z,fe]=x.useState(null),[Ie,Ge]=x.useState(null),[J,D]=x.useState(!1),[W,be]=x.useState(""),[Ne,qe]=x.useState(""),[Ae,rt]=x.useState({}),[pt,Ze]=x.useState({}),[Ht,cn]=x.useState(null),[Nt,Ct]=x.useState(null),[le,gn]=x.useState(""),$t=x.useRef(null),St=x.useRef(0),Bt=x.useRef(0),ht=x.useRef("right"),et=x.useCallback(q=>{y(ce=>{const T=Math.max(0,Math.min(xa.length-1,q));return T===ce?ce:(ht.current=T>ce?"right":"left",T)})},[]),{currentUser:en,isClient:rs,clientData:Lt,loading:Et}=Qr(),{isDark:Pn}=Ma(),Ft=nr(),[En]=qE(),Kt=En.get("mode")==="corebuddy",Sn=!Kt&&(!Lt?.clientType||Lt.clientType==="block"),me=x.useCallback((q,ce="info")=>{Ge({message:q,type:ce}),setTimeout(()=>Ge(null),4e3)},[]);x.useEffect(()=>{!Et&&(!en||!rs)&&Ft("/")},[en,rs,Et,Ft]),x.useEffect(()=>{Lt&&(Sn?Se():(async()=>{try{const[ce,T,C]=await Promise.all([Ln(Ke(ve,"coreBuddyPBs",Lt.id)),Ln(Ke(ve,"coreBuddyTargets",Lt.id)),Ln(Ke(ve,"coreBuddyAchievements",Lt.id))]);ce.exists()&&rt(ce.data().exercises||{}),T.exists()&&Ze(T.data().targets||{}),C.exists()&&cn(C.data())}catch(ce){console.error("Error loading Core Buddy PBs:",ce)}u(!1)})())},[Lt]);const Se=async()=>{try{const q=Rn(Wt(ve,"personalBests"),ln("clientId","==",Lt.id)),T=(await Tn(q)).docs.map(ze=>({id:ze.id,...ze.data()}));T.sort((ze,Ve)=>ze.month.localeCompare(Ve.month)),i(T);const C=Rn(Wt(ve,"personalBestTargets"),ln("clientId","==",Lt.id)),Y=await Tn(C);if(!Y.empty){const ze=Y.docs[0].data();We(ze.targets||{}),R(ze.metricTargets||{}),I(ze.targets||{}),M(ze.metricTargets||{})}const se=Rn(Wt(ve,"achievements"),ln("clientId","==",Lt.id)),$e=await Tn(se);$e.empty||xt($e.docs[0].data().badges||[])}catch(q){console.error("Error fetching personal bests:",q)}u(!1)},Fe=async()=>{if(!Nt||!le||!Lt)return;const q=parseFloat(le),ce=Ae[Nt];if(!ce||q<=ce.weight){me("Target must be higher than current PB","error");return}p(!0);try{const T={...pt,[Nt]:{targetWeight:q,setAt:vt.now(),currentPBWhenSet:ce.weight}};await Wn(Ke(ve,"coreBuddyTargets",Lt.id),{clientId:Lt.id,targets:T,updatedAt:vt.now()}),Ze(T),Ct(null),gn(""),me("Target set!","success")}catch(T){console.error("Error saving target:",T),me("Failed to save target","error")}p(!1)},Qe=q=>{if(!Ht?.badges)return!1;const ce=pt[q];return ce?Ht.badges.some(T=>T.type==="pb_target"&&T.exercise===q&&T.targetWeight===ce.targetWeight):!1},Ue=q=>{const ce=pt[q];if(!ce)return null;const T=Ae[q];if(!T)return 0;const C=ce.currentPBWhenSet||0,Y=ce.targetWeight,se=Y-C;return se<=0?T.weight>=Y?1:0:Math.max(0,Math.min((T.weight-C)/se,1))},De=UD(),Oe=t.find(q=>q.month===De),wt=t.filter(q=>q.month<De),ft=wt.length>0?wt[wt.length-1]:null;x.useEffect(()=>{Oe?(ne(Oe.benchmarks||{}),ye(Oe.bodyMetrics||{})):(ne({}),ye({}))},[Oe?.id]);const Q=async(q,ce)=>{const T=[];if(q==="strength"?xa.forEach(C=>{const Y=je[C.key];if(!Y)return;const se=ce[C.key];if(!se)return;let $e;if(Y.targetType==="time"){if(!Y.targetValue)return;const ze=Y.startValue||0,Ve=se.time||0,Ut=Y.targetValue-ze;$e=Ut===0?Ve>=Y.targetValue?1:0:Math.max(0,(Ve-ze)/Ut)}else{if(!Y.targetWeight&&!Y.targetReps)return;const ze=(Y.startWeight||0)*(Y.startReps||0),Ve=(Y.targetWeight||0)*(Y.targetReps||0),Ut=(se.weight||0)*(se.reps||0),kt=Ve-ze;$e=kt===0?Ut>=Ve?1:0:Math.max(0,(Ut-ze)/kt)}if($e>=1&&!(Y.targetType==="time"?He.some(Ve=>Ve.type==="strength"&&Ve.key===C.key&&Ve.targetValue===Y.targetValue):He.some(Ve=>Ve.type==="strength"&&Ve.key===C.key&&Ve.targetWeight===Y.targetWeight&&Ve.targetReps===Y.targetReps))){const Ve=Y.targetType==="time"?`${C.name} ${Y.targetValue}s`:`${C.name} ${Y.targetWeight}kg  ${Y.targetReps}`;T.push({type:"strength",key:C.key,...Y.targetType==="time"?{targetType:"time",targetValue:Y.targetValue}:{targetWeight:Y.targetWeight,targetReps:Y.targetReps},achievedMonth:De,label:Ve})}}):Co.forEach(C=>{const Y=Be[C.key];if(!Y||!Y.targetValue)return;const se=ce[C.key];if(se==null)return;const $e=Y.startValue||0,ze=Y.targetValue,Ve=ze-$e;(Ve===0?se===ze?1:0:Math.max(0,(se-$e)/Ve))>=1&&(He.some(G=>G.type==="metric"&&G.key===C.key&&G.targetValue===ze)||T.push({type:"metric",key:C.key,targetValue:ze,achievedMonth:De,label:`${C.name} ${ze}${C.suffix}`}))}),T.length>0){const C=[...He,...T];await Wn(Ke(ve,"achievements",Lt.id),{clientId:Lt.id,badges:C,updatedAt:vt.now()}),xt(C),fe(T),setTimeout(()=>fe(null),5e3)}},Ee=(q,ce)=>{if(q==="strength"){const T=je[ce];return T?T.targetType==="time"?He.some(C=>C.type==="strength"&&C.key===ce&&C.targetValue===T.targetValue):!T.targetWeight&&!T.targetReps?!1:He.some(C=>C.type==="strength"&&C.key===ce&&C.targetWeight===T.targetWeight&&C.targetReps===T.targetReps):!1}else{const T=Be[ce];return!T||!T.targetValue?!1:He.some(C=>C.type==="metric"&&C.key===ce&&C.targetValue===T.targetValue)}},Xe=async()=>{p(!0);try{const q=`${Lt.id}_${De}`,ce=Oe||{};await Wn(Ke(ve,"personalBests",q),{clientId:Lt.id,month:De,benchmarks:L,bodyMetrics:ce.bodyMetrics||Z||{},createdAt:ce.createdAt||vt.now(),updatedAt:vt.now()}),await Q("strength",L),me("Benchmarks saved!","success"),k(!1),await Se()}catch(q){console.error("Error saving benchmarks:",q),me("Failed to save. Please try again.","error")}p(!1)},Je=async()=>{p(!0);try{const q=`${Lt.id}_${De}`,ce=Oe||{};await Wn(Ke(ve,"personalBests",q),{clientId:Lt.id,month:De,benchmarks:ce.benchmarks||L||{},bodyMetrics:Z,createdAt:ce.createdAt||vt.now(),updatedAt:vt.now()}),await Q("metric",Z),me("Body metrics saved!","success"),O(!1),await Se()}catch(q){console.error("Error saving metrics:",q),me("Failed to save. Please try again.","error")}p(!1)},dt=(q,ce,T)=>{ne(C=>({...C,[q]:{...C[q],[ce]:T===""?"":parseFloat(T)}}))},qt=(q,ce)=>{ye(T=>({...T,[q]:ce===""?"":parseFloat(ce)}))},Rt=(q,ce,T)=>{I(C=>({...C,[q]:{...C[q],[ce]:T===""?"":parseFloat(T)}}))},tn=async()=>{p(!0);try{const q=`targets_${Lt.id}`,ce=Oe?.benchmarks||{},T={};xa.forEach(C=>{const Y=ce[C.key];C.unit==="time"?S[C.key]?.targetValue&&(T[C.key]={targetType:"time",targetValue:S[C.key].targetValue,startValue:Y?.time||0}):(S[C.key]?.targetWeight||S[C.key]?.targetReps)&&(T[C.key]={targetWeight:S[C.key].targetWeight||0,targetReps:S[C.key].targetReps||0,startWeight:Y?.weight||0,startReps:Y?.reps||0})}),await Wn(Ke(ve,"personalBestTargets",q),{clientId:Lt.id,targets:T,metricTargets:Be,updatedAt:vt.now()}),We(T),I(T),me("Targets saved!","success"),U(!1)}catch(q){console.error("Error saving targets:",q),me("Failed to save targets.","error")}p(!1)},Vn=(q,ce)=>{M(T=>({...T,[q]:{...T[q],targetValue:ce===""?"":parseFloat(ce)}}))},An=async()=>{p(!0);try{const q=`targets_${Lt.id}`,ce={};Co.forEach(T=>{if(F[T.key]?.targetValue){const C=Oe?.bodyMetrics?.[T.key]||0;ce[T.key]={targetValue:F[T.key].targetValue,startValue:C}}}),await Wn(Ke(ve,"personalBestTargets",q),{clientId:Lt.id,targets:je,metricTargets:ce,updatedAt:vt.now()}),R(ce),M(ce),me("Metric targets saved!","success"),P(!1)}catch(q){console.error("Error saving metric targets:",q),me("Failed to save targets.","error")}p(!1)},sn=async()=>{if(window.confirm("Reset all goals? This will clear all strength and body metric targets. Your recorded benchmarks and measurements will NOT be affected.")){p(!0);try{const q=Ke(ve,"personalBestTargets",`targets_${Lt.id}`);await or(q),We({}),R({}),I({}),M({}),me("All goals have been reset","success")}catch(q){console.error("Error resetting targets:",q),me("Failed to reset goals","error")}p(!1)}},yn=(q,ce)=>{const T=je[q];if(!T||!ce)return null;if(T.targetType==="time"){if(!T.targetValue)return null;const ze=T.startValue||0,Ve=T.targetValue,Ut=ce.time||0,kt=Ve-ze;return kt<=0?Ut>=Ve?1:0:Math.max(0,Math.min((Ut-ze)/kt,1))}if(!T.targetWeight&&!T.targetReps)return null;const C=(T.startWeight||0)*(T.startReps||0),Y=(T.targetWeight||0)*(T.targetReps||0),se=(ce.weight||0)*(ce.reps||0),$e=Y-C;return $e<=0?se>=Y?1:0:Math.max(0,Math.min((se-C)/$e,1))},In=q=>{const ce=Be[q];if(!ce||!ce.targetValue)return null;const T=Oe?.bodyMetrics?.[q];if(T==null)return null;const C=ce.startValue||0,Y=ce.targetValue,se=Y-C;return se===0?T===Y?1:0:Math.max(0,Math.min((T-C)/se,1))},un=q=>{St.current=q.touches[0].clientX,Bt.current=0},as=q=>{Bt.current=q.touches[0].clientX-St.current},H=()=>{Bt.current<-50?et(g+1):Bt.current>50&&et(g-1),Bt.current=0},pe=q=>{const ce=Oe?.bodyMetrics?.[q],T=ft?.bodyMetrics?.[q];return ce==null||T==null?null:parseFloat((ce-T).toFixed(2))},_e=t.find(q=>q.month===W),xe=t.find(q=>q.month===Ne);if(Et||l)return a.jsxs("div",{className:"pb-page",children:[a.jsx("header",{className:"client-header",children:a.jsx("div",{className:"header-content",children:a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})})}),a.jsxs("main",{className:"pb-main",children:[a.jsx("div",{className:"skeleton skeleton-title",style:{width:180,height:28,marginBottom:20}}),a.jsx("div",{className:"skeleton skeleton-card-large",style:{height:320,borderRadius:16}})]})]});if(!en||!rs||!Lt)return null;if(Sn&&Lt?.isJunior)return a.jsx(BD,{});const ge=xa[g],at=Oe?.benchmarks?.[ge.key],At=ft?.benchmarks?.[ge.key],ct=Nl(ge,at),_t=Nl(ge,At),bt=Qp(ct,_t),bn=yn(ge.key,at),sr=bn!==null,Ts=bn!==null&&bn>=1,Os=sr?Math.round(bn*60):ct>0?15:0,Bn=je[ge.key];return a.jsxs("div",{className:"pb-page",children:[a.jsx("header",{className:"client-header",children:a.jsxs("div",{className:"header-content",children:[a.jsx("button",{className:"header-back-btn",onClick:()=>Ft(Kt?"/client/core-buddy":"/client"),"aria-label":"Go back",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})]})}),a.jsxs("main",{className:"pb-main page-transition-enter",children:[a.jsxs("div",{className:"pb-intro",children:[a.jsx("h2",{children:"Personal Bests"}),a.jsx("p",{children:Sn?"Track your strength benchmarks and body measurements each month.":"Your all-time best lifts from programme workouts."})]}),!Sn&&a.jsxs("div",{className:"pb-cb-section",children:[Object.keys(Ae).length===0?a.jsxs("div",{className:"pb-empty",children:[a.jsx("div",{className:"pb-cb-empty-icon",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M20.57 14.86L22 13.43 20.57 12 17 15.57 8.43 7 12 3.43 10.57 2 9.14 3.43 7.71 2 5.57 4.14 4.14 2.71 2.71 4.14l1.43 1.43L2 7.71l1.43 1.43L2 10.57 3.43 12 7 8.43 15.57 17 12 20.57 13.43 22l1.43-1.43L16.29 22l2.14-2.14 1.43 1.43 1.43-1.43-1.43-1.43L22 16.29z"})})}),a.jsx("h4",{children:"No personal bests yet"}),a.jsx("p",{children:"Complete weight-based workouts to start tracking your personal bests."})]}):a.jsx("div",{className:"pb-cb-grid",children:Object.entries(Ae).sort(([q],[ce])=>q.localeCompare(ce)).map(([q,ce],T)=>{const C=pt[q],Y=Ue(q),se=Y!==null&&Y>=1,$e=Qe(q),ze=Y!==null?Math.round(Y*60):60;return a.jsxs("div",{className:"pb-cb-card",style:{animationDelay:`${T*.05}s`},children:[a.jsxs("div",{className:"pb-cb-card-ring",children:[a.jsx("svg",{className:"pb-cb-ring-svg",viewBox:"0 0 80 80",children:DM.map((Ve,Ut)=>{const kt=Ut<ze;return a.jsx("line",{x1:Ve.x1,y1:Ve.y1,x2:Ve.x2,y2:Ve.y2,className:`pb-ring-tick ${kt?se?"hit":"filled":"empty"}`,strokeWidth:Ve.thick?"2":"1.5"},Ut)})}),a.jsx("div",{className:"pb-cb-ring-icon",children:$e?a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",className:"pb-cb-badge-earned",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}):a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M20.57 14.86L22 13.43 20.57 12 17 15.57 8.43 7 12 3.43 10.57 2 9.14 3.43 7.71 2 5.57 4.14 4.14 2.71 2.71 4.14l1.43 1.43L2 7.71l1.43 1.43L2 10.57 3.43 12 7 8.43 15.57 17 12 20.57 13.43 22l1.43-1.43L16.29 22l2.14-2.14 1.43 1.43 1.43-1.43-1.43-1.43L22 16.29z"})})})]}),a.jsxs("div",{className:"pb-cb-card-info",children:[a.jsx("h4",{className:"pb-cb-card-name",children:q}),a.jsxs("div",{className:"pb-cb-card-value",children:[ce.weight,"kg  ",ce.reps]}),ce.achievedAt&&a.jsx("div",{className:"pb-cb-card-date",children:(ce.achievedAt.toDate?ce.achievedAt.toDate():new Date(ce.achievedAt)).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"})}),C&&!se&&a.jsxs("div",{className:"pb-cb-target-info",children:["Target: ",C.targetWeight,"kg (",Math.round((Y||0)*100),"%)"]}),C&&se&&!$e&&a.jsx("div",{className:"pb-cb-target-info hit",children:"Target hit!"}),$e&&a.jsx("div",{className:"pb-cb-target-info earned",children:"Badge earned!"})]}),a.jsx("div",{className:"pb-cb-card-action",children:C?se&&$e?a.jsx("button",{className:"pb-cb-target-btn",onClick:()=>{Ct(q),gn("")},children:a.jsx("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M12 5v14M5 12h14"})})}):null:a.jsx("button",{className:"pb-cb-target-btn",onClick:()=>{Ct(q),gn("")},children:a.jsxs("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("circle",{cx:"12",cy:"12",r:"6"}),a.jsx("circle",{cx:"12",cy:"12",r:"2"})]})})})]},q)})}),Object.keys(Ae).length>0&&a.jsxs("button",{className:"pb-cb-achievements-link",onClick:()=>Ft("/client/core-buddy/achievements"),children:[a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"18",height:"18",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),"View Achievements",a.jsx("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),Nt&&a.jsx("div",{className:"pb-cb-target-modal-overlay",onClick:()=>Ct(null),children:a.jsxs("div",{className:"pb-cb-target-modal",onClick:q=>q.stopPropagation(),children:[a.jsx("h3",{children:"Set Target"}),a.jsx("p",{className:"pb-cb-target-exercise-name",children:Nt}),a.jsxs("div",{className:"pb-cb-target-current",children:["Current PB: ",a.jsxs("strong",{children:[Ae[Nt]?.weight,"kg"]})]}),a.jsxs("div",{className:"pb-cb-target-input-wrap",children:[a.jsx("label",{children:"Your target (kg)"}),a.jsx("input",{type:"number",inputMode:"decimal",step:"0.5",value:le,onChange:q=>gn(q.target.value),placeholder:String((Ae[Nt]?.weight||0)+5),className:"pb-cb-target-input",autoFocus:!0})]}),a.jsxs("div",{className:"pb-cb-target-actions",children:[a.jsx("button",{className:"pb-cancel-btn",onClick:()=>Ct(null),children:"Cancel"}),a.jsx("button",{className:"pb-save-btn",onClick:Fe,disabled:h,children:h?"Saving...":"Set Target"})]})]})})]}),Sn&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"pb-tabs",children:[a.jsx("button",{className:`pb-tab ${s==="bests"?"active":""}`,onClick:()=>e("bests"),children:"Strength"}),a.jsx("button",{className:`pb-tab ${s==="metrics"?"active":""}`,onClick:()=>e("metrics"),children:"Body Metrics"}),a.jsx("button",{className:`pb-tab ${s==="history"?"active":""}`,onClick:()=>e("history"),children:"History"})]}),s==="bests"&&a.jsxs("div",{className:"pb-strength-section",children:[!w&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"pb-carousel",ref:$t,onTouchStart:un,onTouchMove:as,onTouchEnd:H,children:[a.jsx("div",{className:`pb-ring-container slide-from-${ht.current}`,children:a.jsxs("div",{className:"pb-ring",children:[a.jsx("svg",{className:"pb-ring-svg",viewBox:"0 0 200 200",children:$y.map((q,ce)=>{const T=ce<Math.round(Os);return a.jsx("line",{x1:q.x1,y1:q.y1,x2:q.x2,y2:q.y2,className:`pb-ring-tick ${T?Ts?"hit":"filled":"empty"}`,strokeWidth:q.thick?"3":"2"},ce)})}),a.jsxs("div",{className:"pb-ring-center",children:[a.jsx("div",{className:"pb-ring-category",children:ge.category}),a.jsxs("div",{className:"pb-ring-exercise",children:[ge.name,Ee("strength",ge.key)&&a.jsx("svg",{className:"pb-badge-icon",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})]}),a.jsx("div",{className:"pb-ring-value",children:at?ge.unit==="time"?cd(at.time):x2(at.weight,at.reps):"-"}),bt!==null&&a.jsxs("div",{className:`pb-ring-change ${bt>=0?"positive":"negative"}`,children:[bt>=0?"+":"",bt.toFixed(1),"%"]}),bt===null&&at&&a.jsx("div",{className:"pb-ring-change neutral",children:"New entry"}),Bn&&a.jsx("div",{className:`pb-ring-target ${Ts?"hit":""}`,children:Ts?"Target hit!":Bn.targetType==="time"?`${Bn.startValue||0}s  ${Bn.targetValue}s`:`${Bn.startWeight||0}kg${Bn.startReps||0}  ${Bn.targetWeight}kg${Bn.targetReps}`}),!Bn&&a.jsx("div",{className:"pb-ring-target none",children:"No target set"})]})]})},g),a.jsx("div",{className:"pb-carousel-dots",children:xa.map((q,ce)=>a.jsx("button",{className:`pb-dot ${ce===g?"active":""}`,onClick:()=>et(ce)},ce))}),a.jsx("button",{className:"pb-carousel-arrow left",onClick:()=>et(g-1),disabled:g===0,children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"})})}),a.jsx("button",{className:"pb-carousel-arrow right",onClick:()=>et(g+1),disabled:g===xa.length-1,children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M8.59 16.59L10 18l6-6-6-6-1.41 1.41L13.17 12z"})})})]}),a.jsxs("div",{className:"pb-trend-section",children:[a.jsx("h4",{children:"Trend"}),a.jsx(zD,{data:t,exerciseKey:ge.key,unit:ge.unit})]})]}),!w&&!$&&a.jsxs("div",{className:"pb-action-buttons",children:[a.jsx("button",{className:"pb-edit-btn",onClick:()=>k(!0),children:Oe?.benchmarks?"Edit This Month's Benchmarks":"Add This Month's Benchmarks"}),a.jsx("button",{className:"pb-edit-btn pb-target-btn",onClick:()=>U(!0),children:Object.keys(je).length>0?"Edit Targets":"Set Targets"}),(Object.keys(je).length>0||Object.keys(Be).length>0)&&a.jsx("button",{className:"pb-edit-btn pb-reset-btn",onClick:sn,disabled:h,children:"Reset All Goals"})]}),w&&a.jsxs("div",{className:"pb-edit-card",children:[a.jsxs("div",{className:"pb-edit-header",children:[a.jsxs("h3",{children:["Benchmarks - ",ia(De)]}),a.jsx("button",{className:"pb-edit-close",onClick:()=>{k(!1),ne(Oe?.benchmarks||{})},children:""})]}),a.jsx("div",{className:"pb-edit-body",children:xa.map(q=>a.jsxs("div",{className:"pb-edit-exercise",children:[a.jsx("div",{className:"pb-edit-exercise-name",children:q.name}),q.unit==="weight"?a.jsxs("div",{className:"pb-edit-row",children:[a.jsxs("div",{className:"pb-edit-field",children:[a.jsx("label",{children:"Weight (kg)"}),a.jsx("input",{type:"number",step:"0.5",value:L[q.key]?.weight??"",onChange:ce=>dt(q.key,"weight",ce.target.value),placeholder:"0"})]}),a.jsxs("div",{className:"pb-edit-field",children:[a.jsx("label",{children:"Reps"}),a.jsx("input",{type:"number",value:L[q.key]?.reps??"",onChange:ce=>dt(q.key,"reps",ce.target.value),placeholder:"0"})]})]}):a.jsx("div",{className:"pb-edit-row",children:a.jsxs("div",{className:"pb-edit-field full",children:[a.jsx("label",{children:"Time (seconds)"}),a.jsx("input",{type:"number",step:"0.01",value:L[q.key]?.time??"",onChange:ce=>dt(q.key,"time",ce.target.value),placeholder:"0"})]})})]},q.key))}),a.jsxs("div",{className:"pb-edit-actions",children:[a.jsx("button",{className:"pb-cancel-btn",onClick:()=>{k(!1),ne(Oe?.benchmarks||{})},children:"Cancel"}),a.jsx("button",{className:"pb-save-btn",onClick:Xe,disabled:h,children:h?"Saving...":"Save"})]})]}),$&&a.jsxs("div",{className:"pb-edit-card",children:[a.jsxs("div",{className:"pb-edit-header",children:[a.jsx("h3",{children:"Set Your Targets"}),a.jsx("button",{className:"pb-edit-close",onClick:()=>{U(!1),I(je)},children:""})]}),a.jsxs("div",{className:"pb-edit-body",children:[a.jsx("p",{className:"pb-target-hint",children:"Set a target for each exercise. Your current best is captured automatically from your latest benchmarks."}),xa.map(q=>{const ce=Oe?.benchmarks?.[q.key];let T="-";return ce&&(q.unit==="time"&&ce.time?T=`${ce.time}s`:(ce.weight||ce.reps)&&(T=`${ce.weight||0}kg  ${ce.reps||0}`)),a.jsxs("div",{className:"pb-edit-exercise",children:[a.jsxs("div",{className:"pb-edit-exercise-header",children:[a.jsx("div",{className:"pb-edit-exercise-name",children:q.name}),a.jsxs("div",{className:"pb-edit-current-best",children:["Current: ",T]})]}),q.unit==="weight"?a.jsxs("div",{className:"pb-edit-row",children:[a.jsxs("div",{className:"pb-edit-field",children:[a.jsx("label",{children:"Target Weight (kg)"}),a.jsx("input",{type:"number",step:"0.5",value:S[q.key]?.targetWeight??"",onChange:C=>Rt(q.key,"targetWeight",C.target.value),placeholder:"0"})]}),a.jsxs("div",{className:"pb-edit-field",children:[a.jsx("label",{children:"Target Reps"}),a.jsx("input",{type:"number",value:S[q.key]?.targetReps??"",onChange:C=>Rt(q.key,"targetReps",C.target.value),placeholder:"0"})]})]}):a.jsx("div",{className:"pb-edit-row",children:a.jsxs("div",{className:"pb-edit-field full",children:[a.jsx("label",{children:"Target (seconds)"}),a.jsx("input",{type:"number",step:"1",value:S[q.key]?.targetValue??"",onChange:C=>Rt(q.key,"targetValue",C.target.value),placeholder:"0"})]})})]},q.key)})]}),a.jsxs("div",{className:"pb-edit-actions",children:[a.jsx("button",{className:"pb-cancel-btn",onClick:()=>{U(!1),I(je)},children:"Cancel"}),a.jsx("button",{className:"pb-save-btn",onClick:tn,disabled:h,children:h?"Saving...":"Save Targets"})]})]})]}),s==="metrics"&&a.jsxs("div",{className:"pb-metrics-section",children:[!j&&!V&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"pb-metrics-card",children:[a.jsx("h3",{children:"Body Measurements"}),a.jsx("p",{className:"pb-metrics-month",children:ia(De)}),a.jsx("div",{className:"pb-metrics-list",children:Co.map(q=>{const ce=Oe?.bodyMetrics?.[q.key],T=pe(q.key),C=Be[q.key],Y=In(q.key),se=Y!==null&&Y>=1;return a.jsxs("div",{className:"pb-metric-row",children:[a.jsxs("div",{className:"pb-metric-top",children:[a.jsxs("div",{className:"pb-metric-left",children:[a.jsxs("span",{className:"pb-metric-name",children:[q.name,Ee("metric",q.key)&&a.jsx("svg",{className:"pb-badge-icon-sm",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})]}),C&&a.jsxs("span",{className:"pb-metric-target-label",children:["Target: ",C.targetValue," ",q.suffix]})]}),a.jsxs("div",{className:"pb-metric-values",children:[a.jsx("span",{className:"pb-metric-current",children:ce!=null?`${ce} ${q.suffix}`:"-"}),T!==null&&a.jsxs("span",{className:`pb-metric-change ${T>0?"up":T<0?"down":"same"}`,children:[T>0?"+":"",T," ",q.suffix]})]})]}),Y!==null&&a.jsxs("div",{className:"pb-metric-progress",children:[a.jsx("div",{className:"pb-metric-bar",children:a.jsx("div",{className:`pb-metric-bar-fill ${se?"hit":""}`,style:{width:`${Math.round(Y*100)}%`}})}),a.jsx("span",{className:`pb-metric-percent ${se?"hit":""}`,children:se?"Hit!":`${Math.round(Y*100)}%`})]})]},q.key)})})]}),a.jsxs("div",{className:"pb-action-buttons",children:[a.jsx("button",{className:"pb-edit-btn",onClick:()=>O(!0),children:Oe?.bodyMetrics?"Edit This Month's Measurements":"Add This Month's Measurements"}),a.jsx("button",{className:"pb-edit-btn pb-target-btn",onClick:()=>P(!0),children:Object.keys(Be).length>0?"Edit Targets":"Set Targets"}),(Object.keys(je).length>0||Object.keys(Be).length>0)&&a.jsx("button",{className:"pb-edit-btn pb-reset-btn",onClick:sn,disabled:h,children:"Reset All Goals"})]})]}),j&&a.jsxs("div",{className:"pb-edit-card",children:[a.jsxs("div",{className:"pb-edit-header",children:[a.jsxs("h3",{children:["Measurements - ",ia(De)]}),a.jsx("button",{className:"pb-edit-close",onClick:()=>{O(!1),ye(Oe?.bodyMetrics||{})},children:""})]}),a.jsx("div",{className:"pb-edit-body",children:Co.map(q=>a.jsx("div",{className:"pb-edit-metric",children:a.jsxs("div",{className:"pb-edit-field full",children:[a.jsxs("label",{children:[q.name," (",q.suffix,")"]}),a.jsx("input",{type:"number",step:"0.1",value:Z[q.key]??"",onChange:ce=>qt(q.key,ce.target.value),placeholder:"0"})]})},q.key))}),a.jsxs("div",{className:"pb-edit-actions",children:[a.jsx("button",{className:"pb-cancel-btn",onClick:()=>{O(!1),ye(Oe?.bodyMetrics||{})},children:"Cancel"}),a.jsx("button",{className:"pb-save-btn",onClick:Je,disabled:h,children:h?"Saving...":"Save"})]})]}),V&&a.jsxs("div",{className:"pb-edit-card",children:[a.jsxs("div",{className:"pb-edit-header",children:[a.jsx("h3",{children:"Body Metric Targets"}),a.jsx("button",{className:"pb-edit-close",onClick:()=>{P(!1),M(Be)},children:""})]}),a.jsxs("div",{className:"pb-edit-body",children:[a.jsx("p",{className:"pb-target-hint",children:"Set targets for your body measurements. Your current measurement is captured automatically."}),Co.map(q=>{const ce=Oe?.bodyMetrics?.[q.key];return a.jsxs("div",{className:"pb-edit-exercise",children:[a.jsxs("div",{className:"pb-edit-exercise-header",children:[a.jsx("div",{className:"pb-edit-exercise-name",children:q.name}),a.jsxs("div",{className:"pb-edit-current-best",children:["Current: ",ce!=null?`${ce} ${q.suffix}`:"-"]})]}),a.jsx("div",{className:"pb-edit-row",children:a.jsxs("div",{className:"pb-edit-field full",children:[a.jsxs("label",{children:["Target (",q.suffix,")"]}),a.jsx("input",{type:"number",step:"0.1",value:F[q.key]?.targetValue??"",onChange:T=>Vn(q.key,T.target.value),placeholder:"0"})]})})]},q.key)})]}),a.jsxs("div",{className:"pb-edit-actions",children:[a.jsx("button",{className:"pb-cancel-btn",onClick:()=>{P(!1),M(Be)},children:"Cancel"}),a.jsx("button",{className:"pb-save-btn",onClick:An,disabled:h,children:h?"Saving...":"Save Targets"})]})]})]}),s==="history"&&a.jsx("div",{className:"pb-history-section",children:t.length===0?a.jsxs("div",{className:"pb-empty",children:[a.jsx("h4",{children:"No records yet"}),a.jsx("p",{children:"Start adding your monthly benchmarks and measurements to track your progress over time."})]}):a.jsxs(a.Fragment,{children:[He.length>0&&a.jsxs("div",{className:"pb-achievements-wall",children:[a.jsxs("h4",{className:"pb-achievements-wall-title",children:[a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"18",height:"18",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),"Targets Achieved"]}),a.jsx("div",{className:"pb-achievements-list",children:[...He].reverse().map((q,ce)=>a.jsxs("div",{className:"pb-achievement-item",style:{animationDelay:`${ce*.05}s`},children:[a.jsx("div",{className:"pb-achievement-star",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),a.jsxs("div",{className:"pb-achievement-info",children:[a.jsx("span",{className:"pb-achievement-label",children:q.label}),a.jsx("span",{className:"pb-achievement-date",children:ia(q.achievedMonth)})]})]},ce))})]}),a.jsx("div",{className:"pb-history-controls",children:a.jsx("button",{className:`pb-compare-toggle ${J?"active":""}`,onClick:()=>{D(!J),!J&&t.length>=2&&(be(t[0].month),qe(t[t.length-1].month))},children:J?"Back to Timeline":"Compare Months"})}),J?a.jsxs("div",{className:"pb-compare",children:[a.jsxs("div",{className:"pb-compare-selectors",children:[a.jsxs("div",{className:"pb-compare-select",children:[a.jsx("label",{children:"From"}),a.jsx("select",{value:W,onChange:q=>be(q.target.value),children:t.map(q=>a.jsx("option",{value:q.month,children:ia(q.month)},q.month))})]}),a.jsx("div",{className:"pb-compare-vs",children:"vs"}),a.jsxs("div",{className:"pb-compare-select",children:[a.jsx("label",{children:"To"}),a.jsx("select",{value:Ne,onChange:q=>qe(q.target.value),children:t.map(q=>a.jsx("option",{value:q.month,children:ia(q.month)},q.month))})]})]}),_e&&xe&&a.jsxs("div",{className:"pb-compare-results",children:[a.jsxs("div",{className:"pb-compare-group",children:[a.jsx("h4",{children:"Strength Benchmarks"}),a.jsxs("div",{className:"pb-compare-table",children:[a.jsxs("div",{className:"pb-compare-header-row",children:[a.jsx("span",{children:"Exercise"}),a.jsx("span",{children:ia(W).split(" ")[0]}),a.jsx("span",{children:ia(Ne).split(" ")[0]}),a.jsx("span",{children:"Change"})]}),xa.map(q=>{const ce=_e.benchmarks?.[q.key],T=xe.benchmarks?.[q.key],C=Nl(q,ce),Y=Nl(q,T),se=Qp(Y,C);return a.jsxs("div",{className:"pb-compare-row",children:[a.jsx("span",{className:"pb-compare-name",children:q.name}),a.jsx("span",{className:"pb-compare-val",children:ce?q.unit==="time"?cd(ce.time):`${ce.weight}x${ce.reps}`:"-"}),a.jsx("span",{className:"pb-compare-val",children:T?q.unit==="time"?cd(T.time):`${T.weight}x${T.reps}`:"-"}),a.jsx("span",{className:`pb-compare-change ${se!==null?se>=0?"positive":"negative":""}`,children:se!==null?`${se>=0?"+":""}${se.toFixed(1)}%`:"-"})]},q.key)})]})]}),a.jsxs("div",{className:"pb-compare-group",children:[a.jsx("h4",{children:"Body Measurements"}),a.jsxs("div",{className:"pb-compare-table",children:[a.jsxs("div",{className:"pb-compare-header-row",children:[a.jsx("span",{children:"Measurement"}),a.jsx("span",{children:ia(W).split(" ")[0]}),a.jsx("span",{children:ia(Ne).split(" ")[0]}),a.jsx("span",{children:"Change"})]}),Co.map(q=>{const ce=_e.bodyMetrics?.[q.key],T=xe.bodyMetrics?.[q.key],C=ce!=null&&T!=null?parseFloat((T-ce).toFixed(2)):null;return a.jsxs("div",{className:"pb-compare-row",children:[a.jsx("span",{className:"pb-compare-name",children:q.name}),a.jsx("span",{className:"pb-compare-val",children:ce!=null?`${ce}`:"-"}),a.jsx("span",{className:"pb-compare-val",children:T!=null?`${T}`:"-"}),a.jsx("span",{className:`pb-compare-change ${C!==null?C>0?"positive":C<0?"negative":"neutral":""}`,children:C!==null?`${C>0?"+":""}${C} ${q.suffix}`:"-"})]},q.key)})]})]})]})]}):a.jsx("div",{className:"pb-timeline",children:[...t].reverse().map((q,ce)=>{const T=t.find(C=>C.month<q.month&&t.indexOf(C)===t.indexOf(q)-1)||t.filter(C=>C.month<q.month).pop();return a.jsxs("div",{className:"pb-timeline-item",style:{animationDelay:`${ce*.05}s`},children:[a.jsx("div",{className:"pb-timeline-dot"}),a.jsxs("div",{className:"pb-timeline-card",children:[a.jsx("h4",{children:ia(q.month)}),q.benchmarks&&Object.keys(q.benchmarks).length>0&&a.jsxs("div",{className:"pb-timeline-group",children:[a.jsx("h5",{children:"Strength Benchmarks"}),xa.map(C=>{const Y=q.benchmarks[C.key];if(!Y)return null;const se=T?.benchmarks?.[C.key],$e=Nl(C,Y),ze=Nl(C,se),Ve=Qp($e,ze);return a.jsxs("div",{className:"pb-timeline-row",children:[a.jsx("span",{className:"pb-timeline-label",children:C.name}),a.jsxs("div",{className:"pb-timeline-values",children:[a.jsx("span",{className:"pb-timeline-value",children:C.unit==="time"?cd(Y.time):x2(Y.weight,Y.reps)}),Ve!==null&&a.jsxs("span",{className:`pb-timeline-change ${Ve>=0?"positive":"negative"}`,children:[Ve>=0?"+":"",Ve.toFixed(1),"%"]})]})]},C.key)})]}),q.bodyMetrics&&Object.keys(q.bodyMetrics).length>0&&a.jsxs("div",{className:"pb-timeline-group",children:[a.jsx("h5",{children:"Body Measurements"}),Co.map(C=>{const Y=q.bodyMetrics[C.key];if(Y==null)return null;const se=T?.bodyMetrics?.[C.key],$e=se!=null?parseFloat((Y-se).toFixed(2)):null;return a.jsxs("div",{className:"pb-timeline-row",children:[a.jsx("span",{className:"pb-timeline-label",children:C.name}),a.jsxs("div",{className:"pb-timeline-values",children:[a.jsxs("span",{className:"pb-timeline-value",children:[Y," ",C.suffix]}),$e!==null&&a.jsxs("span",{className:`pb-timeline-change ${$e>0?"positive":$e<0?"negative":"neutral"}`,children:[$e>0?"+":"",$e," ",C.suffix]})]})]},C.key)})]})]})]},q.id)})})]})})]})]}),z&&a.jsx("div",{className:"pb-celebration-overlay",onClick:()=>fe(null),children:a.jsxs("div",{className:"pb-celebration-card",children:[a.jsx("div",{className:"pb-celebration-icon",children:a.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),a.jsx("h3",{className:"pb-celebration-title",children:z.length===1?"Target Achieved!":`${z.length} Targets Achieved!`}),a.jsx("div",{className:"pb-celebration-badges",children:z.map((q,ce)=>a.jsx("div",{className:"pb-celebration-badge",children:q.label},ce))}),a.jsx("p",{className:"pb-celebration-sub",children:"Tap to dismiss"})]})}),Ie&&a.jsxs("div",{className:`toast-notification ${Ie.type}`,children:[a.jsx("span",{className:"toast-icon",children:Ie.type==="success"?a.jsx("svg",{className:"success-check-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{className:"check-path",d:"M5 13 L9 17 L19 7"})}):a.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})}),a.jsx("span",{className:"toast-message",children:Ie.message}),a.jsx("button",{className:"toast-close",onClick:()=>Ge(null),children:""})]}),Sn&&a.jsxs("nav",{className:"block-bottom-nav",children:[a.jsxs("button",{className:"block-nav-tab",onClick:()=>Ft("/client"),children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}),a.jsx("polyline",{points:"9 22 9 12 15 12 15 22"})]}),a.jsx("span",{children:"Home"})]}),a.jsxs("button",{className:"block-nav-tab",onClick:()=>Ft("/client/forms"),children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),a.jsx("polyline",{points:"14 2 14 8 20 8"}),a.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),a.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"})]}),a.jsx("span",{children:"Forms"})]}),a.jsxs("button",{className:"block-nav-tab",onClick:()=>Ft("/client/tools"),children:[a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"})}),a.jsx("span",{children:"Tools"})]}),a.jsxs("button",{className:"block-nav-tab active",children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M12 20V10"}),a.jsx("path",{d:"M18 20V4"}),a.jsx("path",{d:"M6 20v-4"})]}),a.jsx("span",{children:"PBs"})]}),Lt?.circuitAccess&&a.jsxs("button",{className:"block-nav-tab",onClick:()=>Ft("/client/circuit"),children:[a.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("path",{d:"M12 6v6l4 2"})]}),a.jsx("span",{children:"Circuit"})]})]}),Kt&&a.jsx(Aa,{active:"progress"})]})}const qD=x.lazy(()=>Yr(()=>import("./Dashboard-CQZ95aDU.js"),__vite__mapDeps([0,1]))),HD=x.lazy(()=>Yr(()=>import("./AddClient-BRjhaAM4.js"),__vite__mapDeps([2,3]))),$D=x.lazy(()=>Yr(()=>import("./ClientDashboard-DH0fNqc8.js"),[])),WD=x.lazy(()=>Yr(()=>import("./ClientForms-cGB90KrN.js"),__vite__mapDeps([4,5]))),GD=x.lazy(()=>Yr(()=>import("./ClientTools-qUSyw2DB.js"),__vite__mapDeps([6,7]))),KD=x.lazy(()=>Yr(()=>import("./MacroCalculator-DX-q8i3z.js"),__vite__mapDeps([8,7]))),YD=x.lazy(()=>Yr(()=>import("./ProteinSnacks-CJG9rDpF.js"),__vite__mapDeps([9,7]))),QD=x.lazy(()=>Yr(()=>import("./DailyMotivation-j8rAWtVx.js"),__vite__mapDeps([10,7]))),XD=x.lazy(()=>Yr(()=>import("./CircuitDashboard-nVV-wS6e.js"),__vite__mapDeps([11,12]))),JD=x.lazy(()=>Yr(()=>import("./CircuitBooking-BZghLO4W.js"),__vite__mapDeps([13,14,12]))),ZD=x.lazy(()=>Yr(()=>import("./Leaderboard-DOitdWMe.js"),__vite__mapDeps([15,16])));function e6({children:s}){const{pathname:e}=da();return x.useEffect(()=>{"scrollRestoration"in window.history&&(window.history.scrollRestoration="manual")},[]),x.useEffect(()=>{window.scrollTo({top:0,left:0,behavior:"instant"})},[e]),s}function t6(){const s=nr();return x.useEffect(()=>{const e=sessionStorage.getItem("redirect");if(e){sessionStorage.removeItem("redirect");const t=e.replace("/login","")||"/";s(t,{replace:!0})}},[s]),null}function n6(){return a.jsx(AM,{children:a.jsx(RM,{children:a.jsxs(VE,{basename:"/login",children:[a.jsx(t6,{}),a.jsx(e6,{children:a.jsx(x.Suspense,{fallback:null,children:a.jsxs(fE,{children:[a.jsx(hs,{path:"/",element:a.jsx(IM,{})}),a.jsx(hs,{path:"/dashboard",element:a.jsx(qD,{})}),a.jsx(hs,{path:"/add-client",element:a.jsx(HD,{})}),a.jsx(hs,{path:"/client",element:a.jsx($D,{})}),a.jsx(hs,{path:"/client/forms",element:a.jsx(WD,{})}),a.jsx(hs,{path:"/client/tools",element:a.jsx(GD,{})}),a.jsx(hs,{path:"/client/tools/macros",element:a.jsx(KD,{})}),a.jsx(hs,{path:"/client/tools/snacks",element:a.jsx(YD,{})}),a.jsx(hs,{path:"/client/tools/motivation",element:a.jsx(QD,{})}),a.jsx(hs,{path:"/client/personal-bests",element:a.jsx(FD,{})}),a.jsx(hs,{path:"/client/circuit",element:a.jsx(XD,{})}),a.jsx(hs,{path:"/client/circuit/booking",element:a.jsx(JD,{})}),a.jsx(hs,{path:"/client/core-buddy",element:a.jsx(eD,{})}),a.jsx(hs,{path:"/client/core-buddy/nutrition",element:a.jsx(sD,{})}),a.jsx(hs,{path:"/client/core-buddy/workouts",element:a.jsx(pD,{})}),a.jsx(hs,{path:"/client/core-buddy/programmes",element:a.jsx(xD,{})}),a.jsx(hs,{path:"/client/core-buddy/achievements",element:a.jsx(ED,{})}),a.jsx(hs,{path:"/client/core-buddy/consistency",element:a.jsx(CD,{})}),a.jsx(hs,{path:"/client/core-buddy/buddies",element:a.jsx(RD,{})}),a.jsx(hs,{path:"/client/core-buddy/profile/:userId",element:a.jsx(DD,{})}),a.jsx(hs,{path:"/client/leaderboard",element:a.jsx(ZD,{})}),a.jsx(hs,{path:"*",element:a.jsx(hE,{to:"/",replace:!0})})]})})})]})})})}dj.createRoot(document.getElementById("root")).render(a.jsx(x.StrictMode,{children:a.jsx(n6,{})}));"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/login/sw.js").catch(()=>{})});export{Aa as C,vt as T,ai as a,or as b,Wt as c,ve as d,Ke as e,s6 as f,Tn as g,PC as h,Ln as i,a as j,Qr as k,Ma as l,nr as m,$y as n,qd as o,Wn as p,Rn as q,x as r,a6 as s,Hi as u,ln as w};
