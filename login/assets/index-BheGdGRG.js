(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const h of document.querySelectorAll('link[rel="modulepreload"]'))a(h);new MutationObserver(h=>{for(const f of h)if(f.type==="childList")for(const y of f.addedNodes)y.tagName==="LINK"&&y.rel==="modulepreload"&&a(y)}).observe(document,{childList:!0,subtree:!0});function t(h){const f={};return h.integrity&&(f.integrity=h.integrity),h.referrerPolicy&&(f.referrerPolicy=h.referrerPolicy),h.crossOrigin==="use-credentials"?f.credentials="include":h.crossOrigin==="anonymous"?f.credentials="omit":f.credentials="same-origin",f}function a(h){if(h.ep)return;h.ep=!0;const f=t(h);fetch(h.href,f)}})();var ld=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},p0={exports:{}},fu={};var Ny;function dA(){if(Ny)return fu;Ny=1;var i=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(a,h,f){var y=null;if(f!==void 0&&(y=""+f),h.key!==void 0&&(y=""+h.key),"key"in h){f={};for(var A in h)A!=="key"&&(f[A]=h[A])}else f=h;return h=f.ref,{$$typeof:i,type:a,key:y,ref:h!==void 0?h:null,props:f}}return fu.Fragment=e,fu.jsx=t,fu.jsxs=t,fu}var Iy;function fA(){return Iy||(Iy=1,p0.exports=dA()),p0.exports}var u=fA(),y0={exports:{}},Vt={};var Ry;function mA(){if(Ry)return Vt;Ry=1;var i=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),h=Symbol.for("react.profiler"),f=Symbol.for("react.consumer"),y=Symbol.for("react.context"),A=Symbol.for("react.forward_ref"),C=Symbol.for("react.suspense"),E=Symbol.for("react.memo"),S=Symbol.for("react.lazy"),I=Symbol.for("react.activity"),j=Symbol.iterator;function Y(L){return L===null||typeof L!="object"?null:(L=j&&L[j]||L["@@iterator"],typeof L=="function"?L:null)}var X={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},G=Object.assign,J={};function ae(L,oe,ce){this.props=L,this.context=oe,this.refs=J,this.updater=ce||X}ae.prototype.isReactComponent={},ae.prototype.setState=function(L,oe){if(typeof L!="object"&&typeof L!="function"&&L!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,L,oe,"setState")},ae.prototype.forceUpdate=function(L){this.updater.enqueueForceUpdate(this,L,"forceUpdate")};function ne(){}ne.prototype=ae.prototype;function ue(L,oe,ce){this.props=L,this.context=oe,this.refs=J,this.updater=ce||X}var be=ue.prototype=new ne;be.constructor=ue,G(be,ae.prototype),be.isPureReactComponent=!0;var Me=Array.isArray;function Ce(){}var P={H:null,A:null,T:null,S:null},F=Object.prototype.hasOwnProperty;function B(L,oe,ce){var pe=ce.ref;return{$$typeof:i,type:L,key:oe,ref:pe!==void 0?pe:null,props:ce}}function se(L,oe){return B(L.type,oe,L.props)}function Z(L){return typeof L=="object"&&L!==null&&L.$$typeof===i}function Q(L){var oe={"=":"=0",":":"=2"};return"$"+L.replace(/[=:]/g,function(ce){return oe[ce]})}var z=/\/+/g;function Ye(L,oe){return typeof L=="object"&&L!==null&&L.key!=null?Q(""+L.key):oe.toString(36)}function me(L){switch(L.status){case"fulfilled":return L.value;case"rejected":throw L.reason;default:switch(typeof L.status=="string"?L.then(Ce,Ce):(L.status="pending",L.then(function(oe){L.status==="pending"&&(L.status="fulfilled",L.value=oe)},function(oe){L.status==="pending"&&(L.status="rejected",L.reason=oe)})),L.status){case"fulfilled":return L.value;case"rejected":throw L.reason}}throw L}function te(L,oe,ce,pe,ee){var ie=typeof L;(ie==="undefined"||ie==="boolean")&&(L=null);var Te=!1;if(L===null)Te=!0;else switch(ie){case"bigint":case"string":case"number":Te=!0;break;case"object":switch(L.$$typeof){case i:case e:Te=!0;break;case S:return Te=L._init,te(Te(L._payload),oe,ce,pe,ee)}}if(Te)return ee=ee(L),Te=pe===""?"."+Ye(L,0):pe,Me(ee)?(ce="",Te!=null&&(ce=Te.replace(z,"$&/")+"/"),te(ee,oe,ce,"",function(dt){return dt})):ee!=null&&(Z(ee)&&(ee=se(ee,ce+(ee.key==null||L&&L.key===ee.key?"":(""+ee.key).replace(z,"$&/")+"/")+Te)),oe.push(ee)),1;Te=0;var Pe=pe===""?".":pe+":";if(Me(L))for(var it=0;it<L.length;it++)pe=L[it],ie=Pe+Ye(pe,it),Te+=te(pe,oe,ce,ie,ee);else if(it=Y(L),typeof it=="function")for(L=it.call(L),it=0;!(pe=L.next()).done;)pe=pe.value,ie=Pe+Ye(pe,it++),Te+=te(pe,oe,ce,ie,ee);else if(ie==="object"){if(typeof L.then=="function")return te(me(L),oe,ce,pe,ee);throw oe=String(L),Error("Objects are not valid as a React child (found: "+(oe==="[object Object]"?"object with keys {"+Object.keys(L).join(", ")+"}":oe)+"). If you meant to render a collection of children, use an array instead.")}return Te}function ge(L,oe,ce){if(L==null)return L;var pe=[],ee=0;return te(L,pe,"","",function(ie){return oe.call(ce,ie,ee++)}),pe}function He(L){if(L._status===-1){var oe=L._result;oe=oe(),oe.then(function(ce){(L._status===0||L._status===-1)&&(L._status=1,L._result=ce)},function(ce){(L._status===0||L._status===-1)&&(L._status=2,L._result=ce)}),L._status===-1&&(L._status=0,L._result=oe)}if(L._status===1)return L._result.default;throw L._result}var Ne=typeof reportError=="function"?reportError:function(L){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var oe=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof L=="object"&&L!==null&&typeof L.message=="string"?String(L.message):String(L),error:L});if(!window.dispatchEvent(oe))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",L);return}console.error(L)},tt={map:ge,forEach:function(L,oe,ce){ge(L,function(){oe.apply(this,arguments)},ce)},count:function(L){var oe=0;return ge(L,function(){oe++}),oe},toArray:function(L){return ge(L,function(oe){return oe})||[]},only:function(L){if(!Z(L))throw Error("React.Children.only expected to receive a single React element child.");return L}};return Vt.Activity=I,Vt.Children=tt,Vt.Component=ae,Vt.Fragment=t,Vt.Profiler=h,Vt.PureComponent=ue,Vt.StrictMode=a,Vt.Suspense=C,Vt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=P,Vt.__COMPILER_RUNTIME={__proto__:null,c:function(L){return P.H.useMemoCache(L)}},Vt.cache=function(L){return function(){return L.apply(null,arguments)}},Vt.cacheSignal=function(){return null},Vt.cloneElement=function(L,oe,ce){if(L==null)throw Error("The argument must be a React element, but you passed "+L+".");var pe=G({},L.props),ee=L.key;if(oe!=null)for(ie in oe.key!==void 0&&(ee=""+oe.key),oe)!F.call(oe,ie)||ie==="key"||ie==="__self"||ie==="__source"||ie==="ref"&&oe.ref===void 0||(pe[ie]=oe[ie]);var ie=arguments.length-2;if(ie===1)pe.children=ce;else if(1<ie){for(var Te=Array(ie),Pe=0;Pe<ie;Pe++)Te[Pe]=arguments[Pe+2];pe.children=Te}return B(L.type,ee,pe)},Vt.createContext=function(L){return L={$$typeof:y,_currentValue:L,_currentValue2:L,_threadCount:0,Provider:null,Consumer:null},L.Provider=L,L.Consumer={$$typeof:f,_context:L},L},Vt.createElement=function(L,oe,ce){var pe,ee={},ie=null;if(oe!=null)for(pe in oe.key!==void 0&&(ie=""+oe.key),oe)F.call(oe,pe)&&pe!=="key"&&pe!=="__self"&&pe!=="__source"&&(ee[pe]=oe[pe]);var Te=arguments.length-2;if(Te===1)ee.children=ce;else if(1<Te){for(var Pe=Array(Te),it=0;it<Te;it++)Pe[it]=arguments[it+2];ee.children=Pe}if(L&&L.defaultProps)for(pe in Te=L.defaultProps,Te)ee[pe]===void 0&&(ee[pe]=Te[pe]);return B(L,ie,ee)},Vt.createRef=function(){return{current:null}},Vt.forwardRef=function(L){return{$$typeof:A,render:L}},Vt.isValidElement=Z,Vt.lazy=function(L){return{$$typeof:S,_payload:{_status:-1,_result:L},_init:He}},Vt.memo=function(L,oe){return{$$typeof:E,type:L,compare:oe===void 0?null:oe}},Vt.startTransition=function(L){var oe=P.T,ce={};P.T=ce;try{var pe=L(),ee=P.S;ee!==null&&ee(ce,pe),typeof pe=="object"&&pe!==null&&typeof pe.then=="function"&&pe.then(Ce,Ne)}catch(ie){Ne(ie)}finally{oe!==null&&ce.types!==null&&(oe.types=ce.types),P.T=oe}},Vt.unstable_useCacheRefresh=function(){return P.H.useCacheRefresh()},Vt.use=function(L){return P.H.use(L)},Vt.useActionState=function(L,oe,ce){return P.H.useActionState(L,oe,ce)},Vt.useCallback=function(L,oe){return P.H.useCallback(L,oe)},Vt.useContext=function(L){return P.H.useContext(L)},Vt.useDebugValue=function(){},Vt.useDeferredValue=function(L,oe){return P.H.useDeferredValue(L,oe)},Vt.useEffect=function(L,oe){return P.H.useEffect(L,oe)},Vt.useEffectEvent=function(L){return P.H.useEffectEvent(L)},Vt.useId=function(){return P.H.useId()},Vt.useImperativeHandle=function(L,oe,ce){return P.H.useImperativeHandle(L,oe,ce)},Vt.useInsertionEffect=function(L,oe){return P.H.useInsertionEffect(L,oe)},Vt.useLayoutEffect=function(L,oe){return P.H.useLayoutEffect(L,oe)},Vt.useMemo=function(L,oe){return P.H.useMemo(L,oe)},Vt.useOptimistic=function(L,oe){return P.H.useOptimistic(L,oe)},Vt.useReducer=function(L,oe,ce){return P.H.useReducer(L,oe,ce)},Vt.useRef=function(L){return P.H.useRef(L)},Vt.useState=function(L){return P.H.useState(L)},Vt.useSyncExternalStore=function(L,oe,ce){return P.H.useSyncExternalStore(L,oe,ce)},Vt.useTransition=function(){return P.H.useTransition()},Vt.version="19.2.4",Vt}var Dy;function _m(){return Dy||(Dy=1,y0.exports=mA()),y0.exports}var H=_m(),x0={exports:{}},mu={},v0={exports:{}},w0={};var ky;function gA(){return ky||(ky=1,(function(i){function e(te,ge){var He=te.length;te.push(ge);e:for(;0<He;){var Ne=He-1>>>1,tt=te[Ne];if(0<h(tt,ge))te[Ne]=ge,te[He]=tt,He=Ne;else break e}}function t(te){return te.length===0?null:te[0]}function a(te){if(te.length===0)return null;var ge=te[0],He=te.pop();if(He!==ge){te[0]=He;e:for(var Ne=0,tt=te.length,L=tt>>>1;Ne<L;){var oe=2*(Ne+1)-1,ce=te[oe],pe=oe+1,ee=te[pe];if(0>h(ce,He))pe<tt&&0>h(ee,ce)?(te[Ne]=ee,te[pe]=He,Ne=pe):(te[Ne]=ce,te[oe]=He,Ne=oe);else if(pe<tt&&0>h(ee,He))te[Ne]=ee,te[pe]=He,Ne=pe;else break e}}return ge}function h(te,ge){var He=te.sortIndex-ge.sortIndex;return He!==0?He:te.id-ge.id}if(i.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var f=performance;i.unstable_now=function(){return f.now()}}else{var y=Date,A=y.now();i.unstable_now=function(){return y.now()-A}}var C=[],E=[],S=1,I=null,j=3,Y=!1,X=!1,G=!1,J=!1,ae=typeof setTimeout=="function"?setTimeout:null,ne=typeof clearTimeout=="function"?clearTimeout:null,ue=typeof setImmediate<"u"?setImmediate:null;function be(te){for(var ge=t(E);ge!==null;){if(ge.callback===null)a(E);else if(ge.startTime<=te)a(E),ge.sortIndex=ge.expirationTime,e(C,ge);else break;ge=t(E)}}function Me(te){if(G=!1,be(te),!X)if(t(C)!==null)X=!0,Ce||(Ce=!0,Q());else{var ge=t(E);ge!==null&&me(Me,ge.startTime-te)}}var Ce=!1,P=-1,F=5,B=-1;function se(){return J?!0:!(i.unstable_now()-B<F)}function Z(){if(J=!1,Ce){var te=i.unstable_now();B=te;var ge=!0;try{e:{X=!1,G&&(G=!1,ne(P),P=-1),Y=!0;var He=j;try{t:{for(be(te),I=t(C);I!==null&&!(I.expirationTime>te&&se());){var Ne=I.callback;if(typeof Ne=="function"){I.callback=null,j=I.priorityLevel;var tt=Ne(I.expirationTime<=te);if(te=i.unstable_now(),typeof tt=="function"){I.callback=tt,be(te),ge=!0;break t}I===t(C)&&a(C),be(te)}else a(C);I=t(C)}if(I!==null)ge=!0;else{var L=t(E);L!==null&&me(Me,L.startTime-te),ge=!1}}break e}finally{I=null,j=He,Y=!1}ge=void 0}}finally{ge?Q():Ce=!1}}}var Q;if(typeof ue=="function")Q=function(){ue(Z)};else if(typeof MessageChannel<"u"){var z=new MessageChannel,Ye=z.port2;z.port1.onmessage=Z,Q=function(){Ye.postMessage(null)}}else Q=function(){ae(Z,0)};function me(te,ge){P=ae(function(){te(i.unstable_now())},ge)}i.unstable_IdlePriority=5,i.unstable_ImmediatePriority=1,i.unstable_LowPriority=4,i.unstable_NormalPriority=3,i.unstable_Profiling=null,i.unstable_UserBlockingPriority=2,i.unstable_cancelCallback=function(te){te.callback=null},i.unstable_forceFrameRate=function(te){0>te||125<te?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):F=0<te?Math.floor(1e3/te):5},i.unstable_getCurrentPriorityLevel=function(){return j},i.unstable_next=function(te){switch(j){case 1:case 2:case 3:var ge=3;break;default:ge=j}var He=j;j=ge;try{return te()}finally{j=He}},i.unstable_requestPaint=function(){J=!0},i.unstable_runWithPriority=function(te,ge){switch(te){case 1:case 2:case 3:case 4:case 5:break;default:te=3}var He=j;j=te;try{return ge()}finally{j=He}},i.unstable_scheduleCallback=function(te,ge,He){var Ne=i.unstable_now();switch(typeof He=="object"&&He!==null?(He=He.delay,He=typeof He=="number"&&0<He?Ne+He:Ne):He=Ne,te){case 1:var tt=-1;break;case 2:tt=250;break;case 5:tt=1073741823;break;case 4:tt=1e4;break;default:tt=5e3}return tt=He+tt,te={id:S++,callback:ge,priorityLevel:te,startTime:He,expirationTime:tt,sortIndex:-1},He>Ne?(te.sortIndex=He,e(E,te),t(C)===null&&te===t(E)&&(G?(ne(P),P=-1):G=!0,me(Me,He-Ne))):(te.sortIndex=tt,e(C,te),X||Y||(X=!0,Ce||(Ce=!0,Q()))),te},i.unstable_shouldYield=se,i.unstable_wrapCallback=function(te){var ge=j;return function(){var He=j;j=ge;try{return te.apply(this,arguments)}finally{j=He}}}})(w0)),w0}var My;function pA(){return My||(My=1,v0.exports=gA()),v0.exports}var b0={exports:{}},di={};var Oy;function yA(){if(Oy)return di;Oy=1;var i=_m();function e(C){var E="https://react.dev/errors/"+C;if(1<arguments.length){E+="?args[]="+encodeURIComponent(arguments[1]);for(var S=2;S<arguments.length;S++)E+="&args[]="+encodeURIComponent(arguments[S])}return"Minified React error #"+C+"; visit "+E+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var a={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},h=Symbol.for("react.portal");function f(C,E,S){var I=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:h,key:I==null?null:""+I,children:C,containerInfo:E,implementation:S}}var y=i.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function A(C,E){if(C==="font")return"";if(typeof E=="string")return E==="use-credentials"?E:""}return di.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=a,di.createPortal=function(C,E){var S=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!E||E.nodeType!==1&&E.nodeType!==9&&E.nodeType!==11)throw Error(e(299));return f(C,E,null,S)},di.flushSync=function(C){var E=y.T,S=a.p;try{if(y.T=null,a.p=2,C)return C()}finally{y.T=E,a.p=S,a.d.f()}},di.preconnect=function(C,E){typeof C=="string"&&(E?(E=E.crossOrigin,E=typeof E=="string"?E==="use-credentials"?E:"":void 0):E=null,a.d.C(C,E))},di.prefetchDNS=function(C){typeof C=="string"&&a.d.D(C)},di.preinit=function(C,E){if(typeof C=="string"&&E&&typeof E.as=="string"){var S=E.as,I=A(S,E.crossOrigin),j=typeof E.integrity=="string"?E.integrity:void 0,Y=typeof E.fetchPriority=="string"?E.fetchPriority:void 0;S==="style"?a.d.S(C,typeof E.precedence=="string"?E.precedence:void 0,{crossOrigin:I,integrity:j,fetchPriority:Y}):S==="script"&&a.d.X(C,{crossOrigin:I,integrity:j,fetchPriority:Y,nonce:typeof E.nonce=="string"?E.nonce:void 0})}},di.preinitModule=function(C,E){if(typeof C=="string")if(typeof E=="object"&&E!==null){if(E.as==null||E.as==="script"){var S=A(E.as,E.crossOrigin);a.d.M(C,{crossOrigin:S,integrity:typeof E.integrity=="string"?E.integrity:void 0,nonce:typeof E.nonce=="string"?E.nonce:void 0})}}else E==null&&a.d.M(C)},di.preload=function(C,E){if(typeof C=="string"&&typeof E=="object"&&E!==null&&typeof E.as=="string"){var S=E.as,I=A(S,E.crossOrigin);a.d.L(C,S,{crossOrigin:I,integrity:typeof E.integrity=="string"?E.integrity:void 0,nonce:typeof E.nonce=="string"?E.nonce:void 0,type:typeof E.type=="string"?E.type:void 0,fetchPriority:typeof E.fetchPriority=="string"?E.fetchPriority:void 0,referrerPolicy:typeof E.referrerPolicy=="string"?E.referrerPolicy:void 0,imageSrcSet:typeof E.imageSrcSet=="string"?E.imageSrcSet:void 0,imageSizes:typeof E.imageSizes=="string"?E.imageSizes:void 0,media:typeof E.media=="string"?E.media:void 0})}},di.preloadModule=function(C,E){if(typeof C=="string")if(E){var S=A(E.as,E.crossOrigin);a.d.m(C,{as:typeof E.as=="string"&&E.as!=="script"?E.as:void 0,crossOrigin:S,integrity:typeof E.integrity=="string"?E.integrity:void 0})}else a.d.m(C)},di.requestFormReset=function(C){a.d.r(C)},di.unstable_batchedUpdates=function(C,E){return C(E)},di.useFormState=function(C,E,S){return y.H.useFormState(C,E,S)},di.useFormStatus=function(){return y.H.useHostTransitionStatus()},di.version="19.2.4",di}var jy;function xA(){if(jy)return b0.exports;jy=1;function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(e){console.error(e)}}return i(),b0.exports=yA(),b0.exports}var Ly;function vA(){if(Ly)return mu;Ly=1;var i=pA(),e=_m(),t=xA();function a(n){var r="https://react.dev/errors/"+n;if(1<arguments.length){r+="?args[]="+encodeURIComponent(arguments[1]);for(var c=2;c<arguments.length;c++)r+="&args[]="+encodeURIComponent(arguments[c])}return"Minified React error #"+n+"; visit "+r+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function h(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function f(n){var r=n,c=n;if(n.alternate)for(;r.return;)r=r.return;else{n=r;do r=n,(r.flags&4098)!==0&&(c=r.return),n=r.return;while(n)}return r.tag===3?c:null}function y(n){if(n.tag===13){var r=n.memoizedState;if(r===null&&(n=n.alternate,n!==null&&(r=n.memoizedState)),r!==null)return r.dehydrated}return null}function A(n){if(n.tag===31){var r=n.memoizedState;if(r===null&&(n=n.alternate,n!==null&&(r=n.memoizedState)),r!==null)return r.dehydrated}return null}function C(n){if(f(n)!==n)throw Error(a(188))}function E(n){var r=n.alternate;if(!r){if(r=f(n),r===null)throw Error(a(188));return r!==n?null:n}for(var c=n,g=r;;){var w=c.return;if(w===null)break;var _=w.alternate;if(_===null){if(g=w.return,g!==null){c=g;continue}break}if(w.child===_.child){for(_=w.child;_;){if(_===c)return C(w),n;if(_===g)return C(w),r;_=_.sibling}throw Error(a(188))}if(c.return!==g.return)c=w,g=_;else{for(var D=!1,U=w.child;U;){if(U===c){D=!0,c=w,g=_;break}if(U===g){D=!0,g=w,c=_;break}U=U.sibling}if(!D){for(U=_.child;U;){if(U===c){D=!0,c=_,g=w;break}if(U===g){D=!0,g=_,c=w;break}U=U.sibling}if(!D)throw Error(a(189))}}if(c.alternate!==g)throw Error(a(190))}if(c.tag!==3)throw Error(a(188));return c.stateNode.current===c?n:r}function S(n){var r=n.tag;if(r===5||r===26||r===27||r===6)return n;for(n=n.child;n!==null;){if(r=S(n),r!==null)return r;n=n.sibling}return null}var I=Object.assign,j=Symbol.for("react.element"),Y=Symbol.for("react.transitional.element"),X=Symbol.for("react.portal"),G=Symbol.for("react.fragment"),J=Symbol.for("react.strict_mode"),ae=Symbol.for("react.profiler"),ne=Symbol.for("react.consumer"),ue=Symbol.for("react.context"),be=Symbol.for("react.forward_ref"),Me=Symbol.for("react.suspense"),Ce=Symbol.for("react.suspense_list"),P=Symbol.for("react.memo"),F=Symbol.for("react.lazy"),B=Symbol.for("react.activity"),se=Symbol.for("react.memo_cache_sentinel"),Z=Symbol.iterator;function Q(n){return n===null||typeof n!="object"?null:(n=Z&&n[Z]||n["@@iterator"],typeof n=="function"?n:null)}var z=Symbol.for("react.client.reference");function Ye(n){if(n==null)return null;if(typeof n=="function")return n.$$typeof===z?null:n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case G:return"Fragment";case ae:return"Profiler";case J:return"StrictMode";case Me:return"Suspense";case Ce:return"SuspenseList";case B:return"Activity"}if(typeof n=="object")switch(n.$$typeof){case X:return"Portal";case ue:return n.displayName||"Context";case ne:return(n._context.displayName||"Context")+".Consumer";case be:var r=n.render;return n=n.displayName,n||(n=r.displayName||r.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case P:return r=n.displayName||null,r!==null?r:Ye(n.type)||"Memo";case F:r=n._payload,n=n._init;try{return Ye(n(r))}catch{}}return null}var me=Array.isArray,te=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ge=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,He={pending:!1,data:null,method:null,action:null},Ne=[],tt=-1;function L(n){return{current:n}}function oe(n){0>tt||(n.current=Ne[tt],Ne[tt]=null,tt--)}function ce(n,r){tt++,Ne[tt]=n.current,n.current=r}var pe=L(null),ee=L(null),ie=L(null),Te=L(null);function Pe(n,r){switch(ce(ie,r),ce(ee,n),ce(pe,null),r.nodeType){case 9:case 11:n=(n=r.documentElement)&&(n=n.namespaceURI)?Z2(n):0;break;default:if(n=r.tagName,r=r.namespaceURI)r=Z2(r),n=$2(r,n);else switch(n){case"svg":n=1;break;case"math":n=2;break;default:n=0}}oe(pe),ce(pe,n)}function it(){oe(pe),oe(ee),oe(ie)}function dt(n){n.memoizedState!==null&&ce(Te,n);var r=pe.current,c=$2(r,n.type);r!==c&&(ce(ee,n),ce(pe,c))}function Le(n){ee.current===n&&(oe(pe),oe(ee)),Te.current===n&&(oe(Te),cu._currentValue=He)}var qt,wt;function Zt(n){if(qt===void 0)try{throw Error()}catch(c){var r=c.stack.trim().match(/\n( *(at )?)/);qt=r&&r[1]||"",wt=-1<c.stack.indexOf(`
    at`)?" (<anonymous>)":-1<c.stack.indexOf("@")?"@unknown:0:0":""}return`
`+qt+n+wt}var zt=!1;function Pt(n,r){if(!n||zt)return"";zt=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var g={DetermineComponentFrameRoot:function(){try{if(r){var ze=function(){throw Error()};if(Object.defineProperty(ze.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ze,[])}catch(je){var Se=je}Reflect.construct(n,[],ze)}else{try{ze.call()}catch(je){Se=je}n.call(ze.prototype)}}else{try{throw Error()}catch(je){Se=je}(ze=n())&&typeof ze.catch=="function"&&ze.catch(function(){})}}catch(je){if(je&&Se&&typeof je.stack=="string")return[je.stack,Se.stack]}return[null,null]}};g.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var w=Object.getOwnPropertyDescriptor(g.DetermineComponentFrameRoot,"name");w&&w.configurable&&Object.defineProperty(g.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var _=g.DetermineComponentFrameRoot(),D=_[0],U=_[1];if(D&&U){var re=D.split(`
`),Ae=U.split(`
`);for(w=g=0;g<re.length&&!re[g].includes("DetermineComponentFrameRoot");)g++;for(;w<Ae.length&&!Ae[w].includes("DetermineComponentFrameRoot");)w++;if(g===re.length||w===Ae.length)for(g=re.length-1,w=Ae.length-1;1<=g&&0<=w&&re[g]!==Ae[w];)w--;for(;1<=g&&0<=w;g--,w--)if(re[g]!==Ae[w]){if(g!==1||w!==1)do if(g--,w--,0>w||re[g]!==Ae[w]){var Be=`
`+re[g].replace(" at new "," at ");return n.displayName&&Be.includes("<anonymous>")&&(Be=Be.replace("<anonymous>",n.displayName)),Be}while(1<=g&&0<=w);break}}}finally{zt=!1,Error.prepareStackTrace=c}return(c=n?n.displayName||n.name:"")?Zt(c):""}function st(n,r){switch(n.tag){case 26:case 27:case 5:return Zt(n.type);case 16:return Zt("Lazy");case 13:return n.child!==r&&r!==null?Zt("Suspense Fallback"):Zt("Suspense");case 19:return Zt("SuspenseList");case 0:case 15:return Pt(n.type,!1);case 11:return Pt(n.type.render,!1);case 1:return Pt(n.type,!0);case 31:return Zt("Activity");default:return""}}function mt(n){try{var r="",c=null;do r+=st(n,c),c=n,n=n.return;while(n);return r}catch(g){return`
Error generating stack: `+g.message+`
`+g.stack}}var at=Object.prototype.hasOwnProperty,kt=i.unstable_scheduleCallback,de=i.unstable_cancelCallback,et=i.unstable_shouldYield,Ot=i.unstable_requestPaint,ot=i.unstable_now,xn=i.unstable_getCurrentPriorityLevel,jn=i.unstable_ImmediatePriority,Zn=i.unstable_UserBlockingPriority,Vn=i.unstable_NormalPriority,vn=i.unstable_LowPriority,xs=i.unstable_IdlePriority,Wn=i.log,Cs=i.unstable_setDisableYieldValue,Qt=null,We=null;function en(n){if(typeof Wn=="function"&&Cs(n),We&&typeof We.setStrictMode=="function")try{We.setStrictMode(Qt,n)}catch{}}var Ct=Math.clz32?Math.clz32:Ai,wn=Math.log,Ls=Math.LN2;function Ai(n){return n>>>=0,n===0?32:31-(wn(n)/Ls|0)|0}var Nn=256,It=262144,fn=4194304;function Hs(n){var r=n&42;if(r!==0)return r;switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return n&261888;case 262144:case 524288:case 1048576:case 2097152:return n&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return n&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return n}}function Xs(n,r,c){var g=n.pendingLanes;if(g===0)return 0;var w=0,_=n.suspendedLanes,D=n.pingedLanes;n=n.warmLanes;var U=g&134217727;return U!==0?(g=U&~_,g!==0?w=Hs(g):(D&=U,D!==0?w=Hs(D):c||(c=U&~n,c!==0&&(w=Hs(c))))):(U=g&~_,U!==0?w=Hs(U):D!==0?w=Hs(D):c||(c=g&~n,c!==0&&(w=Hs(c)))),w===0?0:r!==0&&r!==w&&(r&_)===0&&(_=w&-w,c=r&-r,_>=c||_===32&&(c&4194048)!==0)?r:w}function Tn(n,r){return(n.pendingLanes&~(n.suspendedLanes&~n.pingedLanes)&r)===0}function Ci(n,r){switch(n){case 1:case 2:case 4:case 8:case 64:return r+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Yn(){var n=fn;return fn<<=1,(fn&62914560)===0&&(fn=4194304),n}function as(n){for(var r=[],c=0;31>c;c++)r.push(n);return r}function fs(n,r){n.pendingLanes|=r,r!==268435456&&(n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0)}function $n(n,r,c,g,w,_){var D=n.pendingLanes;n.pendingLanes=c,n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0,n.expiredLanes&=c,n.entangledLanes&=c,n.errorRecoveryDisabledLanes&=c,n.shellSuspendCounter=0;var U=n.entanglements,re=n.expirationTimes,Ae=n.hiddenUpdates;for(c=D&~c;0<c;){var Be=31-Ct(c),ze=1<<Be;U[Be]=0,re[Be]=-1;var Se=Ae[Be];if(Se!==null)for(Ae[Be]=null,Be=0;Be<Se.length;Be++){var je=Se[Be];je!==null&&(je.lane&=-536870913)}c&=~ze}g!==0&&xe(n,g,0),_!==0&&w===0&&n.tag!==0&&(n.suspendedLanes|=_&~(D&~r))}function xe(n,r,c){n.pendingLanes|=r,n.suspendedLanes&=~r;var g=31-Ct(r);n.entangledLanes|=r,n.entanglements[g]=n.entanglements[g]|1073741824|c&261930}function Ue(n,r){var c=n.entangledLanes|=r;for(n=n.entanglements;c;){var g=31-Ct(c),w=1<<g;w&r|n[g]&r&&(n[g]|=r),c&=~w}}function Ze(n,r){var c=r&-r;return c=(c&42)!==0?1:$(c),(c&(n.suspendedLanes|r))!==0?0:c}function $(n){switch(n){case 2:n=1;break;case 8:n=4;break;case 32:n=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:n=128;break;case 268435456:n=134217728;break;default:n=0}return n}function Oe(n){return n&=-n,2<n?8<n?(n&134217727)!==0?32:268435456:8:2}function Ke(){var n=ge.p;return n!==0?n:(n=window.event,n===void 0?32:by(n.type))}function Re(n,r){var c=ge.p;try{return ge.p=n,r()}finally{ge.p=c}}var ft=Math.random().toString(36).slice(2),yt="__reactFiber$"+ft,bt="__reactProps$"+ft,Gn="__reactContainer$"+ft,os="__reactEvents$"+ft,Ps="__reactListeners$"+ft,vs="__reactHandles$"+ft,br="__reactResources$"+ft,Ti="__reactMarker$"+ft;function Ts(n){delete n[yt],delete n[bt],delete n[os],delete n[Ps],delete n[vs]}function pt(n){var r=n[yt];if(r)return r;for(var c=n.parentNode;c;){if(r=c[Gn]||c[yt]){if(c=r.alternate,r.child!==null||c!==null&&c.child!==null)for(n=ry(n);n!==null;){if(c=n[yt])return c;n=ry(n)}return r}n=c,c=n.parentNode}return null}function Ht(n){if(n=n[yt]||n[Gn]){var r=n.tag;if(r===5||r===6||r===13||r===31||r===26||r===27||r===3)return n}return null}function Ss(n){var r=n.tag;if(r===5||r===26||r===27||r===6)return n.stateNode;throw Error(a(33))}function Bs(n){var r=n[br];return r||(r=n[br]={hoistableStyles:new Map,hoistableScripts:new Map}),r}function Jn(n){n[Ti]=!0}var Ge=new Set,zo={};function bn(n,r){Ks(n,r),Ks(n+"Capture",r)}function Ks(n,r){for(zo[n]=r,n=0;n<r.length;n++)Ge.add(r[n])}var Ho=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),an={},tn={};function Xt(n){return at.call(tn,n)?!0:at.call(an,n)?!1:Ho.test(n)?tn[n]=!0:(an[n]=!0,!1)}function Pr(n,r,c){if(Xt(r))if(c===null)n.removeAttribute(r);else{switch(typeof c){case"undefined":case"function":case"symbol":n.removeAttribute(r);return;case"boolean":var g=r.toLowerCase().slice(0,5);if(g!=="data-"&&g!=="aria-"){n.removeAttribute(r);return}}n.setAttribute(r,""+c)}}function Qs(n,r,c){if(c===null)n.removeAttribute(r);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(r);return}n.setAttribute(r,""+c)}}function es(n,r,c,g){if(g===null)n.removeAttribute(c);else{switch(typeof g){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(c);return}n.setAttributeNS(r,c,""+g)}}function $t(n){switch(typeof n){case"bigint":case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function Zs(n){var r=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(r==="checkbox"||r==="radio")}function Go(n,r,c){var g=Object.getOwnPropertyDescriptor(n.constructor.prototype,r);if(!n.hasOwnProperty(r)&&typeof g<"u"&&typeof g.get=="function"&&typeof g.set=="function"){var w=g.get,_=g.set;return Object.defineProperty(n,r,{configurable:!0,get:function(){return w.call(this)},set:function(D){c=""+D,_.call(this,D)}}),Object.defineProperty(n,r,{enumerable:g.enumerable}),{getValue:function(){return c},setValue:function(D){c=""+D},stopTracking:function(){n._valueTracker=null,delete n[r]}}}}function St(n){if(!n._valueTracker){var r=Zs(n)?"checked":"value";n._valueTracker=Go(n,r,""+n[r])}}function oi(n){if(!n)return!1;var r=n._valueTracker;if(!r)return!0;var c=r.getValue(),g="";return n&&(g=Zs(n)?n.checked?"true":"false":n.value),n=g,n!==c?(r.setValue(n),!0):!1}function nr(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}var Si=/[\n"\\]/g;function Wt(n){return n.replace(Si,function(r){return"\\"+r.charCodeAt(0).toString(16)+" "})}function ls(n,r,c,g,w,_,D,U){n.name="",D!=null&&typeof D!="function"&&typeof D!="symbol"&&typeof D!="boolean"?n.type=D:n.removeAttribute("type"),r!=null?D==="number"?(r===0&&n.value===""||n.value!=r)&&(n.value=""+$t(r)):n.value!==""+$t(r)&&(n.value=""+$t(r)):D!=="submit"&&D!=="reset"||n.removeAttribute("value"),r!=null?W(n,D,$t(r)):c!=null?W(n,D,$t(c)):g!=null&&n.removeAttribute("value"),w==null&&_!=null&&(n.defaultChecked=!!_),w!=null&&(n.checked=w&&typeof w!="function"&&typeof w!="symbol"),U!=null&&typeof U!="function"&&typeof U!="symbol"&&typeof U!="boolean"?n.name=""+$t(U):n.removeAttribute("name")}function Ee(n,r,c,g,w,_,D,U){if(_!=null&&typeof _!="function"&&typeof _!="symbol"&&typeof _!="boolean"&&(n.type=_),r!=null||c!=null){if(!(_!=="submit"&&_!=="reset"||r!=null)){St(n);return}c=c!=null?""+$t(c):"",r=r!=null?""+$t(r):c,U||r===n.value||(n.value=r),n.defaultValue=r}g=g??w,g=typeof g!="function"&&typeof g!="symbol"&&!!g,n.checked=U?n.checked:!!g,n.defaultChecked=!!g,D!=null&&typeof D!="function"&&typeof D!="symbol"&&typeof D!="boolean"&&(n.name=D),St(n)}function W(n,r,c){r==="number"&&nr(n.ownerDocument)===n||n.defaultValue===""+c||(n.defaultValue=""+c)}function ut(n,r,c,g){if(n=n.options,r){r={};for(var w=0;w<c.length;w++)r["$"+c[w]]=!0;for(c=0;c<n.length;c++)w=r.hasOwnProperty("$"+n[c].value),n[c].selected!==w&&(n[c].selected=w),w&&g&&(n[c].defaultSelected=!0)}else{for(c=""+$t(c),r=null,w=0;w<n.length;w++){if(n[w].value===c){n[w].selected=!0,g&&(n[w].defaultSelected=!0);return}r!==null||n[w].disabled||(r=n[w])}r!==null&&(r.selected=!0)}}function cs(n,r,c){if(r!=null&&(r=""+$t(r),r!==n.value&&(n.value=r),c==null)){n.defaultValue!==r&&(n.defaultValue=r);return}n.defaultValue=c!=null?""+$t(c):""}function ws(n,r,c,g){if(r==null){if(g!=null){if(c!=null)throw Error(a(92));if(me(g)){if(1<g.length)throw Error(a(93));g=g[0]}c=g}c==null&&(c=""),r=c}c=$t(r),n.defaultValue=c,g=n.textContent,g===c&&g!==""&&g!==null&&(n.value=g),St(n)}function li(n,r){if(r){var c=n.firstChild;if(c&&c===n.lastChild&&c.nodeType===3){c.nodeValue=r;return}}n.textContent=r}var qa=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Gs(n,r,c){var g=r.indexOf("--")===0;c==null||typeof c=="boolean"||c===""?g?n.setProperty(r,""):r==="float"?n.cssFloat="":n[r]="":g?n.setProperty(r,c):typeof c!="number"||c===0||qa.has(r)?r==="float"?n.cssFloat=c:n[r]=(""+c).trim():n[r]=c+"px"}function xt(n,r,c){if(r!=null&&typeof r!="object")throw Error(a(62));if(n=n.style,c!=null){for(var g in c)!c.hasOwnProperty(g)||r!=null&&r.hasOwnProperty(g)||(g.indexOf("--")===0?n.setProperty(g,""):g==="float"?n.cssFloat="":n[g]="");for(var w in r)g=r[w],r.hasOwnProperty(w)&&c[w]!==g&&Gs(n,w,g)}else for(var _ in r)r.hasOwnProperty(_)&&Gs(n,_,r[_])}function In(n){if(n.indexOf("-")===-1)return!1;switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var qo=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Br=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Vr(n){return Br.test(""+n)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":n}function ci(){}var ta=null;function Ni(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var Fn=null,ui=null;function hi(n){var r=Ht(n);if(r&&(n=r.stateNode)){var c=n[bt]||null;e:switch(n=r.stateNode,r.type){case"input":if(ls(n,c.value,c.defaultValue,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name),r=c.name,c.type==="radio"&&r!=null){for(c=n;c.parentNode;)c=c.parentNode;for(c=c.querySelectorAll('input[name="'+Wt(""+r)+'"][type="radio"]'),r=0;r<c.length;r++){var g=c[r];if(g!==n&&g.form===n.form){var w=g[bt]||null;if(!w)throw Error(a(90));ls(g,w.value,w.defaultValue,w.defaultValue,w.checked,w.defaultChecked,w.type,w.name)}}for(r=0;r<c.length;r++)g=c[r],g.form===n.form&&oi(g)}break e;case"textarea":cs(n,c.value,c.defaultValue);break e;case"select":r=c.value,r!=null&&ut(n,!!c.multiple,r,!1)}}}var Et=!1;function Fr(n,r,c){if(Et)return n(r,c);Et=!0;try{var g=n(r);return g}finally{if(Et=!1,(Fn!==null||ui!==null)&&(Fh(),Fn&&(r=Fn,n=ui,ui=Fn=null,hi(r),n)))for(r=0;r<n.length;r++)hi(n[r])}}function Tt(n,r){var c=n.stateNode;if(c===null)return null;var g=c[bt]||null;if(g===null)return null;c=g[r];e:switch(r){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(g=!g.disabled)||(n=n.type,g=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!g;break e;default:n=!1}if(n)return null;if(c&&typeof c!="function")throw Error(a(231,r,typeof c));return c}var Rn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),na=!1;if(Rn)try{var _n={};Object.defineProperty(_n,"passive",{get:function(){na=!0}}),window.addEventListener("test",_n,_n),window.removeEventListener("test",_n,_n)}catch{na=!1}var Fi=null,Ui=null,sa=null;function Er(){if(sa)return sa;var n,r=Ui,c=r.length,g,w="value"in Fi?Fi.value:Fi.textContent,_=w.length;for(n=0;n<c&&r[n]===w[n];n++);var D=c-n;for(g=1;g<=D&&r[c-g]===w[_-g];g++);return sa=w.slice(n,1<g?1-g:void 0)}function zi(n){var r=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&r===13&&(n=13)):n=r,n===10&&(n=13),32<=n||n===13?n:0}function xi(){return!0}function Ii(){return!1}function us(n){function r(c,g,w,_,D){this._reactName=c,this._targetInst=w,this.type=g,this.nativeEvent=_,this.target=D,this.currentTarget=null;for(var U in n)n.hasOwnProperty(U)&&(c=n[U],this[U]=c?c(_):_[U]);return this.isDefaultPrevented=(_.defaultPrevented!=null?_.defaultPrevented:_.returnValue===!1)?xi:Ii,this.isPropagationStopped=Ii,this}return I(r.prototype,{preventDefault:function(){this.defaultPrevented=!0;var c=this.nativeEvent;c&&(c.preventDefault?c.preventDefault():typeof c.returnValue!="unknown"&&(c.returnValue=!1),this.isDefaultPrevented=xi)},stopPropagation:function(){var c=this.nativeEvent;c&&(c.stopPropagation?c.stopPropagation():typeof c.cancelBubble!="unknown"&&(c.cancelBubble=!0),this.isPropagationStopped=xi)},persist:function(){},isPersistent:xi}),r}var vi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Xn=us(vi),_r=I({},vi,{view:0,detail:0}),Wa=us(_r),Ar,Ya,sr,Xa=I({},_r,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:rr,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==sr&&(sr&&n.type==="mousemove"?(Ar=n.screenX-sr.screenX,Ya=n.screenY-sr.screenY):Ya=Ar=0,sr=n),Ar)},movementY:function(n){return"movementY"in n?n.movementY:Ya}}),pn=us(Xa),Ur=I({},Xa,{dataTransfer:0}),ia=us(Ur),Hi=I({},_r,{relatedTarget:0}),ra=us(Hi),Ie=I({},vi,{animationName:0,elapsedTime:0,pseudoElement:0}),Bt=us(Ie),ts=I({},vi,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),aa=us(ts),Wo=I({},vi,{data:0}),ir=us(Wo),Tl={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Sl={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Ka={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function ns(n){var r=this.nativeEvent;return r.getModifierState?r.getModifierState(n):(n=Ka[n])?!!r[n]:!1}function rr(){return ns}var Jt=I({},_r,{key:function(n){if(n.key){var r=Tl[n.key]||n.key;if(r!=="Unidentified")return r}return n.type==="keypress"?(n=zi(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?Sl[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:rr,charCode:function(n){return n.type==="keypress"?zi(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?zi(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),oa=us(Jt),ar=I({},Xa,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),nn=us(ar),x=I({},_r,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:rr}),N=us(x),k=I({},vi,{propertyName:0,elapsedTime:0,pseudoElement:0}),q=us(k),ve=I({},Xa,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),ke=us(ve),Je=I({},vi,{newState:0,oldState:0}),Mt=us(Je),ss=[9,13,27,32],mn=Rn&&"CompositionEvent"in window,Un=null;Rn&&"documentMode"in document&&(Un=document.documentMode);var wi=Rn&&"TextEvent"in window&&!Un,or=Rn&&(!mn||Un&&8<Un&&11>=Un),qs=" ",bi=!1;function la(n,r){switch(n){case"keyup":return ss.indexOf(r.keyCode)!==-1;case"keydown":return r.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function lr(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var Qa=!1;function zr(n,r){switch(n){case"compositionend":return lr(r);case"keypress":return r.which!==32?null:(bi=!0,qs);case"textInput":return n=r.data,n===qs&&bi?null:n;default:return null}}function Nl(n,r){if(Qa)return n==="compositionend"||!mn&&la(n,r)?(n=Er(),sa=Ui=Fi=null,Qa=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(r.ctrlKey||r.altKey||r.metaKey)||r.ctrlKey&&r.altKey){if(r.char&&1<r.char.length)return r.char;if(r.which)return String.fromCharCode(r.which)}return null;case"compositionend":return or&&r.locale!=="ko"?null:r.data;default:return null}}var Ri={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Mc(n){var r=n&&n.nodeName&&n.nodeName.toLowerCase();return r==="input"?!!Ri[n.type]:r==="textarea"}function Gi(n,r,c,g){Fn?ui?ui.push(g):ui=[g]:Fn=g,r=Yh(r,"onChange"),0<r.length&&(c=new Xn("onChange","change",null,c,g),n.push({event:c,listeners:r}))}var Yo=null,ca=null;function If(n){q2(n,0)}function Xo(n){var r=Ss(n);if(oi(r))return n}function qi(n,r){if(n==="change")return r}var ih=!1;if(Rn){var Ko;if(Rn){var ua="oninput"in document;if(!ua){var on=document.createElement("div");on.setAttribute("oninput","return;"),ua=typeof on.oninput=="function"}Ko=ua}else Ko=!1;ih=Ko&&(!document.documentMode||9<document.documentMode)}function Qo(){Yo&&(Yo.detachEvent("onpropertychange",M),ca=Yo=null)}function M(n){if(n.propertyName==="value"&&Xo(ca)){var r=[];Gi(r,ca,n,Ni(n)),Fr(If,r)}}function s(n,r,c){n==="focusin"?(Qo(),Yo=r,ca=c,Yo.attachEvent("onpropertychange",M)):n==="focusout"&&Qo()}function o(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return Xo(ca)}function l(n,r){if(n==="click")return Xo(r)}function d(n,r){if(n==="input"||n==="change")return Xo(r)}function m(n,r){return n===r&&(n!==0||1/n===1/r)||n!==n&&r!==r}var p=typeof Object.is=="function"?Object.is:m;function v(n,r){if(p(n,r))return!0;if(typeof n!="object"||n===null||typeof r!="object"||r===null)return!1;var c=Object.keys(n),g=Object.keys(r);if(c.length!==g.length)return!1;for(g=0;g<c.length;g++){var w=c[g];if(!at.call(r,w)||!p(n[w],r[w]))return!1}return!0}function b(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function T(n,r){var c=b(n);n=0;for(var g;c;){if(c.nodeType===3){if(g=n+c.textContent.length,n<=r&&g>=r)return{node:c,offset:r-n};n=g}e:{for(;c;){if(c.nextSibling){c=c.nextSibling;break e}c=c.parentNode}c=void 0}c=b(c)}}function R(n,r){return n&&r?n===r?!0:n&&n.nodeType===3?!1:r&&r.nodeType===3?R(n,r.parentNode):"contains"in n?n.contains(r):n.compareDocumentPosition?!!(n.compareDocumentPosition(r)&16):!1:!1}function O(n){n=n!=null&&n.ownerDocument!=null&&n.ownerDocument.defaultView!=null?n.ownerDocument.defaultView:window;for(var r=nr(n.document);r instanceof n.HTMLIFrameElement;){try{var c=typeof r.contentWindow.location.href=="string"}catch{c=!1}if(c)n=r.contentWindow;else break;r=nr(n.document)}return r}function V(n){var r=n&&n.nodeName&&n.nodeName.toLowerCase();return r&&(r==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||r==="textarea"||n.contentEditable==="true")}var K=Rn&&"documentMode"in document&&11>=document.documentMode,le=null,he=null,we=null,De=!1;function $e(n,r,c){var g=c.window===c?c.document:c.nodeType===9?c:c.ownerDocument;De||le==null||le!==nr(g)||(g=le,"selectionStart"in g&&V(g)?g={start:g.selectionStart,end:g.selectionEnd}:(g=(g.ownerDocument&&g.ownerDocument.defaultView||window).getSelection(),g={anchorNode:g.anchorNode,anchorOffset:g.anchorOffset,focusNode:g.focusNode,focusOffset:g.focusOffset}),we&&v(we,g)||(we=g,g=Yh(he,"onSelect"),0<g.length&&(r=new Xn("onSelect","select",null,r,c),n.push({event:r,listeners:g}),r.target=le)))}function Qe(n,r){var c={};return c[n.toLowerCase()]=r.toLowerCase(),c["Webkit"+n]="webkit"+r,c["Moz"+n]="moz"+r,c}var Xe={animationend:Qe("Animation","AnimationEnd"),animationiteration:Qe("Animation","AnimationIteration"),animationstart:Qe("Animation","AnimationStart"),transitionrun:Qe("Transition","TransitionRun"),transitionstart:Qe("Transition","TransitionStart"),transitioncancel:Qe("Transition","TransitionCancel"),transitionend:Qe("Transition","TransitionEnd")},Kt={},jt={};Rn&&(jt=document.createElement("div").style,"AnimationEvent"in window||(delete Xe.animationend.animation,delete Xe.animationiteration.animation,delete Xe.animationstart.animation),"TransitionEvent"in window||delete Xe.transitionend.transition);function ms(n){if(Kt[n])return Kt[n];if(!Xe[n])return n;var r=Xe[n],c;for(c in r)if(r.hasOwnProperty(c)&&c in jt)return Kt[n]=r[c];return n}var Di=ms("animationend"),$s=ms("animationiteration"),Dn=ms("animationstart"),Vs=ms("transitionrun"),Ei=ms("transitionstart"),Za=ms("transitioncancel"),ha=ms("transitionend"),rh=new Map,Oc="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Oc.push("scrollEnd");function Cr(n,r){rh.set(n,r),bn(r,[n])}var ah=typeof reportError=="function"?reportError:function(n){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var r=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof n=="object"&&n!==null&&typeof n.message=="string"?String(n.message):String(n),error:n});if(!window.dispatchEvent(r))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",n);return}console.error(n)},cr=[],Il=0,Rf=0;function oh(){for(var n=Il,r=Rf=Il=0;r<n;){var c=cr[r];cr[r++]=null;var g=cr[r];cr[r++]=null;var w=cr[r];cr[r++]=null;var _=cr[r];if(cr[r++]=null,g!==null&&w!==null){var D=g.pending;D===null?w.next=w:(w.next=D.next,D.next=w),g.pending=w}_!==0&&Tg(c,w,_)}}function lh(n,r,c,g){cr[Il++]=n,cr[Il++]=r,cr[Il++]=c,cr[Il++]=g,Rf|=g,n.lanes|=g,n=n.alternate,n!==null&&(n.lanes|=g)}function Df(n,r,c,g){return lh(n,r,c,g),ch(n)}function Zo(n,r){return lh(n,null,null,r),ch(n)}function Tg(n,r,c){n.lanes|=c;var g=n.alternate;g!==null&&(g.lanes|=c);for(var w=!1,_=n.return;_!==null;)_.childLanes|=c,g=_.alternate,g!==null&&(g.childLanes|=c),_.tag===22&&(n=_.stateNode,n===null||n._visibility&1||(w=!0)),n=_,_=_.return;return n.tag===3?(_=n.stateNode,w&&r!==null&&(w=31-Ct(c),n=_.hiddenUpdates,g=n[w],g===null?n[w]=[r]:g.push(r),r.lane=c|536870912),_):null}function ch(n){if(50<nu)throw nu=0,F1=null,Error(a(185));for(var r=n.return;r!==null;)n=r,r=n.return;return n.tag===3?n.stateNode:null}var Rl={};function KE(n,r,c,g){this.tag=n,this.key=c,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=r,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=g,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Wi(n,r,c,g){return new KE(n,r,c,g)}function kf(n){return n=n.prototype,!(!n||!n.isReactComponent)}function da(n,r){var c=n.alternate;return c===null?(c=Wi(n.tag,r,n.key,n.mode),c.elementType=n.elementType,c.type=n.type,c.stateNode=n.stateNode,c.alternate=n,n.alternate=c):(c.pendingProps=r,c.type=n.type,c.flags=0,c.subtreeFlags=0,c.deletions=null),c.flags=n.flags&65011712,c.childLanes=n.childLanes,c.lanes=n.lanes,c.child=n.child,c.memoizedProps=n.memoizedProps,c.memoizedState=n.memoizedState,c.updateQueue=n.updateQueue,r=n.dependencies,c.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext},c.sibling=n.sibling,c.index=n.index,c.ref=n.ref,c.refCleanup=n.refCleanup,c}function Sg(n,r){n.flags&=65011714;var c=n.alternate;return c===null?(n.childLanes=0,n.lanes=r,n.child=null,n.subtreeFlags=0,n.memoizedProps=null,n.memoizedState=null,n.updateQueue=null,n.dependencies=null,n.stateNode=null):(n.childLanes=c.childLanes,n.lanes=c.lanes,n.child=c.child,n.subtreeFlags=0,n.deletions=null,n.memoizedProps=c.memoizedProps,n.memoizedState=c.memoizedState,n.updateQueue=c.updateQueue,n.type=c.type,r=c.dependencies,n.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext}),n}function uh(n,r,c,g,w,_){var D=0;if(g=n,typeof n=="function")kf(n)&&(D=1);else if(typeof n=="string")D=eA(n,c,pe.current)?26:n==="html"||n==="head"||n==="body"?27:5;else e:switch(n){case B:return n=Wi(31,c,r,w),n.elementType=B,n.lanes=_,n;case G:return $o(c.children,w,_,r);case J:D=8,w|=24;break;case ae:return n=Wi(12,c,r,w|2),n.elementType=ae,n.lanes=_,n;case Me:return n=Wi(13,c,r,w),n.elementType=Me,n.lanes=_,n;case Ce:return n=Wi(19,c,r,w),n.elementType=Ce,n.lanes=_,n;default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case ue:D=10;break e;case ne:D=9;break e;case be:D=11;break e;case P:D=14;break e;case F:D=16,g=null;break e}D=29,c=Error(a(130,n===null?"null":typeof n,"")),g=null}return r=Wi(D,c,r,w),r.elementType=n,r.type=g,r.lanes=_,r}function $o(n,r,c,g){return n=Wi(7,n,g,r),n.lanes=c,n}function Mf(n,r,c){return n=Wi(6,n,null,r),n.lanes=c,n}function Ng(n){var r=Wi(18,null,null,0);return r.stateNode=n,r}function Of(n,r,c){return r=Wi(4,n.children!==null?n.children:[],n.key,r),r.lanes=c,r.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},r}var Ig=new WeakMap;function ur(n,r){if(typeof n=="object"&&n!==null){var c=Ig.get(n);return c!==void 0?c:(r={value:n,source:r,stack:mt(r)},Ig.set(n,r),r)}return{value:n,source:r,stack:mt(r)}}var Dl=[],kl=0,hh=null,jc=0,hr=[],dr=0,$a=null,Hr=1,Gr="";function fa(n,r){Dl[kl++]=jc,Dl[kl++]=hh,hh=n,jc=r}function Rg(n,r,c){hr[dr++]=Hr,hr[dr++]=Gr,hr[dr++]=$a,$a=n;var g=Hr;n=Gr;var w=32-Ct(g)-1;g&=~(1<<w),c+=1;var _=32-Ct(r)+w;if(30<_){var D=w-w%5;_=(g&(1<<D)-1).toString(32),g>>=D,w-=D,Hr=1<<32-Ct(r)+w|c<<w|g,Gr=_+n}else Hr=1<<_|c<<w|g,Gr=n}function jf(n){n.return!==null&&(fa(n,1),Rg(n,1,0))}function Lf(n){for(;n===hh;)hh=Dl[--kl],Dl[kl]=null,jc=Dl[--kl],Dl[kl]=null;for(;n===$a;)$a=hr[--dr],hr[dr]=null,Gr=hr[--dr],hr[dr]=null,Hr=hr[--dr],hr[dr]=null}function Dg(n,r){hr[dr++]=Hr,hr[dr++]=Gr,hr[dr++]=$a,Hr=r.id,Gr=r.overflow,$a=n}var Js=null,Kn=null,gn=!1,Ja=null,fr=!1,Pf=Error(a(519));function eo(n){var r=Error(a(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Lc(ur(r,n)),Pf}function kg(n){var r=n.stateNode,c=n.type,g=n.memoizedProps;switch(r[yt]=n,r[bt]=g,c){case"dialog":rn("cancel",r),rn("close",r);break;case"iframe":case"object":case"embed":rn("load",r);break;case"video":case"audio":for(c=0;c<iu.length;c++)rn(iu[c],r);break;case"source":rn("error",r);break;case"img":case"image":case"link":rn("error",r),rn("load",r);break;case"details":rn("toggle",r);break;case"input":rn("invalid",r),Ee(r,g.value,g.defaultValue,g.checked,g.defaultChecked,g.type,g.name,!0);break;case"select":rn("invalid",r);break;case"textarea":rn("invalid",r),ws(r,g.value,g.defaultValue,g.children)}c=g.children,typeof c!="string"&&typeof c!="number"&&typeof c!="bigint"||r.textContent===""+c||g.suppressHydrationWarning===!0||K2(r.textContent,c)?(g.popover!=null&&(rn("beforetoggle",r),rn("toggle",r)),g.onScroll!=null&&rn("scroll",r),g.onScrollEnd!=null&&rn("scrollend",r),g.onClick!=null&&(r.onclick=ci),r=!0):r=!1,r||eo(n,!0)}function Mg(n){for(Js=n.return;Js;)switch(Js.tag){case 5:case 31:case 13:fr=!1;return;case 27:case 3:fr=!0;return;default:Js=Js.return}}function Ml(n){if(n!==Js)return!1;if(!gn)return Mg(n),gn=!0,!1;var r=n.tag,c;if((c=r!==3&&r!==27)&&((c=r===5)&&(c=n.type,c=!(c!=="form"&&c!=="button")||t0(n.type,n.memoizedProps)),c=!c),c&&Kn&&eo(n),Mg(n),r===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(a(317));Kn=iy(n)}else if(r===31){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(a(317));Kn=iy(n)}else r===27?(r=Kn,go(n.type)?(n=a0,a0=null,Kn=n):Kn=r):Kn=Js?gr(n.stateNode.nextSibling):null;return!0}function Jo(){Kn=Js=null,gn=!1}function Bf(){var n=Ja;return n!==null&&(ji===null?ji=n:ji.push.apply(ji,n),Ja=null),n}function Lc(n){Ja===null?Ja=[n]:Ja.push(n)}var Vf=L(null),el=null,ma=null;function to(n,r,c){ce(Vf,r._currentValue),r._currentValue=c}function ga(n){n._currentValue=Vf.current,oe(Vf)}function Ff(n,r,c){for(;n!==null;){var g=n.alternate;if((n.childLanes&r)!==r?(n.childLanes|=r,g!==null&&(g.childLanes|=r)):g!==null&&(g.childLanes&r)!==r&&(g.childLanes|=r),n===c)break;n=n.return}}function Uf(n,r,c,g){var w=n.child;for(w!==null&&(w.return=n);w!==null;){var _=w.dependencies;if(_!==null){var D=w.child;_=_.firstContext;e:for(;_!==null;){var U=_;_=w;for(var re=0;re<r.length;re++)if(U.context===r[re]){_.lanes|=c,U=_.alternate,U!==null&&(U.lanes|=c),Ff(_.return,c,n),g||(D=null);break e}_=U.next}}else if(w.tag===18){if(D=w.return,D===null)throw Error(a(341));D.lanes|=c,_=D.alternate,_!==null&&(_.lanes|=c),Ff(D,c,n),D=null}else D=w.child;if(D!==null)D.return=w;else for(D=w;D!==null;){if(D===n){D=null;break}if(w=D.sibling,w!==null){w.return=D.return,D=w;break}D=D.return}w=D}}function Ol(n,r,c,g){n=null;for(var w=r,_=!1;w!==null;){if(!_){if((w.flags&524288)!==0)_=!0;else if((w.flags&262144)!==0)break}if(w.tag===10){var D=w.alternate;if(D===null)throw Error(a(387));if(D=D.memoizedProps,D!==null){var U=w.type;p(w.pendingProps.value,D.value)||(n!==null?n.push(U):n=[U])}}else if(w===Te.current){if(D=w.alternate,D===null)throw Error(a(387));D.memoizedState.memoizedState!==w.memoizedState.memoizedState&&(n!==null?n.push(cu):n=[cu])}w=w.return}n!==null&&Uf(r,n,c,g),r.flags|=262144}function dh(n){for(n=n.firstContext;n!==null;){if(!p(n.context._currentValue,n.memoizedValue))return!0;n=n.next}return!1}function tl(n){el=n,ma=null,n=n.dependencies,n!==null&&(n.firstContext=null)}function ei(n){return Og(el,n)}function fh(n,r){return el===null&&tl(n),Og(n,r)}function Og(n,r){var c=r._currentValue;if(r={context:r,memoizedValue:c,next:null},ma===null){if(n===null)throw Error(a(308));ma=r,n.dependencies={lanes:0,firstContext:r},n.flags|=524288}else ma=ma.next=r;return c}var QE=typeof AbortController<"u"?AbortController:function(){var n=[],r=this.signal={aborted:!1,addEventListener:function(c,g){n.push(g)}};this.abort=function(){r.aborted=!0,n.forEach(function(c){return c()})}},ZE=i.unstable_scheduleCallback,$E=i.unstable_NormalPriority,Ns={$$typeof:ue,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function zf(){return{controller:new QE,data:new Map,refCount:0}}function Pc(n){n.refCount--,n.refCount===0&&ZE($E,function(){n.controller.abort()})}var Bc=null,Hf=0,jl=0,Ll=null;function JE(n,r){if(Bc===null){var c=Bc=[];Hf=0,jl=W1(),Ll={status:"pending",value:void 0,then:function(g){c.push(g)}}}return Hf++,r.then(jg,jg),r}function jg(){if(--Hf===0&&Bc!==null){Ll!==null&&(Ll.status="fulfilled");var n=Bc;Bc=null,jl=0,Ll=null;for(var r=0;r<n.length;r++)(0,n[r])()}}function e_(n,r){var c=[],g={status:"pending",value:null,reason:null,then:function(w){c.push(w)}};return n.then(function(){g.status="fulfilled",g.value=r;for(var w=0;w<c.length;w++)(0,c[w])(r)},function(w){for(g.status="rejected",g.reason=w,w=0;w<c.length;w++)(0,c[w])(void 0)}),g}var Lg=te.S;te.S=function(n,r){v2=ot(),typeof r=="object"&&r!==null&&typeof r.then=="function"&&JE(n,r),Lg!==null&&Lg(n,r)};var nl=L(null);function Gf(){var n=nl.current;return n!==null?n:zn.pooledCache}function mh(n,r){r===null?ce(nl,nl.current):ce(nl,r.pool)}function Pg(){var n=Gf();return n===null?null:{parent:Ns._currentValue,pool:n}}var Pl=Error(a(460)),qf=Error(a(474)),gh=Error(a(542)),ph={then:function(){}};function Bg(n){return n=n.status,n==="fulfilled"||n==="rejected"}function Vg(n,r,c){switch(c=n[c],c===void 0?n.push(r):c!==r&&(r.then(ci,ci),r=c),r.status){case"fulfilled":return r.value;case"rejected":throw n=r.reason,Ug(n),n;default:if(typeof r.status=="string")r.then(ci,ci);else{if(n=zn,n!==null&&100<n.shellSuspendCounter)throw Error(a(482));n=r,n.status="pending",n.then(function(g){if(r.status==="pending"){var w=r;w.status="fulfilled",w.value=g}},function(g){if(r.status==="pending"){var w=r;w.status="rejected",w.reason=g}})}switch(r.status){case"fulfilled":return r.value;case"rejected":throw n=r.reason,Ug(n),n}throw il=r,Pl}}function sl(n){try{var r=n._init;return r(n._payload)}catch(c){throw c!==null&&typeof c=="object"&&typeof c.then=="function"?(il=c,Pl):c}}var il=null;function Fg(){if(il===null)throw Error(a(459));var n=il;return il=null,n}function Ug(n){if(n===Pl||n===gh)throw Error(a(483))}var Bl=null,Vc=0;function yh(n){var r=Vc;return Vc+=1,Bl===null&&(Bl=[]),Vg(Bl,n,r)}function Fc(n,r){r=r.props.ref,n.ref=r!==void 0?r:null}function xh(n,r){throw r.$$typeof===j?Error(a(525)):(n=Object.prototype.toString.call(r),Error(a(31,n==="[object Object]"?"object with keys {"+Object.keys(r).join(", ")+"}":n)))}function zg(n){function r(ye,fe){if(n){var _e=ye.deletions;_e===null?(ye.deletions=[fe],ye.flags|=16):_e.push(fe)}}function c(ye,fe){if(!n)return null;for(;fe!==null;)r(ye,fe),fe=fe.sibling;return null}function g(ye){for(var fe=new Map;ye!==null;)ye.key!==null?fe.set(ye.key,ye):fe.set(ye.index,ye),ye=ye.sibling;return fe}function w(ye,fe){return ye=da(ye,fe),ye.index=0,ye.sibling=null,ye}function _(ye,fe,_e){return ye.index=_e,n?(_e=ye.alternate,_e!==null?(_e=_e.index,_e<fe?(ye.flags|=67108866,fe):_e):(ye.flags|=67108866,fe)):(ye.flags|=1048576,fe)}function D(ye){return n&&ye.alternate===null&&(ye.flags|=67108866),ye}function U(ye,fe,_e,Ve){return fe===null||fe.tag!==6?(fe=Mf(_e,ye.mode,Ve),fe.return=ye,fe):(fe=w(fe,_e),fe.return=ye,fe)}function re(ye,fe,_e,Ve){var _t=_e.type;return _t===G?Be(ye,fe,_e.props.children,Ve,_e.key):fe!==null&&(fe.elementType===_t||typeof _t=="object"&&_t!==null&&_t.$$typeof===F&&sl(_t)===fe.type)?(fe=w(fe,_e.props),Fc(fe,_e),fe.return=ye,fe):(fe=uh(_e.type,_e.key,_e.props,null,ye.mode,Ve),Fc(fe,_e),fe.return=ye,fe)}function Ae(ye,fe,_e,Ve){return fe===null||fe.tag!==4||fe.stateNode.containerInfo!==_e.containerInfo||fe.stateNode.implementation!==_e.implementation?(fe=Of(_e,ye.mode,Ve),fe.return=ye,fe):(fe=w(fe,_e.children||[]),fe.return=ye,fe)}function Be(ye,fe,_e,Ve,_t){return fe===null||fe.tag!==7?(fe=$o(_e,ye.mode,Ve,_t),fe.return=ye,fe):(fe=w(fe,_e),fe.return=ye,fe)}function ze(ye,fe,_e){if(typeof fe=="string"&&fe!==""||typeof fe=="number"||typeof fe=="bigint")return fe=Mf(""+fe,ye.mode,_e),fe.return=ye,fe;if(typeof fe=="object"&&fe!==null){switch(fe.$$typeof){case Y:return _e=uh(fe.type,fe.key,fe.props,null,ye.mode,_e),Fc(_e,fe),_e.return=ye,_e;case X:return fe=Of(fe,ye.mode,_e),fe.return=ye,fe;case F:return fe=sl(fe),ze(ye,fe,_e)}if(me(fe)||Q(fe))return fe=$o(fe,ye.mode,_e,null),fe.return=ye,fe;if(typeof fe.then=="function")return ze(ye,yh(fe),_e);if(fe.$$typeof===ue)return ze(ye,fh(ye,fe),_e);xh(ye,fe)}return null}function Se(ye,fe,_e,Ve){var _t=fe!==null?fe.key:null;if(typeof _e=="string"&&_e!==""||typeof _e=="number"||typeof _e=="bigint")return _t!==null?null:U(ye,fe,""+_e,Ve);if(typeof _e=="object"&&_e!==null){switch(_e.$$typeof){case Y:return _e.key===_t?re(ye,fe,_e,Ve):null;case X:return _e.key===_t?Ae(ye,fe,_e,Ve):null;case F:return _e=sl(_e),Se(ye,fe,_e,Ve)}if(me(_e)||Q(_e))return _t!==null?null:Be(ye,fe,_e,Ve,null);if(typeof _e.then=="function")return Se(ye,fe,yh(_e),Ve);if(_e.$$typeof===ue)return Se(ye,fe,fh(ye,_e),Ve);xh(ye,_e)}return null}function je(ye,fe,_e,Ve,_t){if(typeof Ve=="string"&&Ve!==""||typeof Ve=="number"||typeof Ve=="bigint")return ye=ye.get(_e)||null,U(fe,ye,""+Ve,_t);if(typeof Ve=="object"&&Ve!==null){switch(Ve.$$typeof){case Y:return ye=ye.get(Ve.key===null?_e:Ve.key)||null,re(fe,ye,Ve,_t);case X:return ye=ye.get(Ve.key===null?_e:Ve.key)||null,Ae(fe,ye,Ve,_t);case F:return Ve=sl(Ve),je(ye,fe,_e,Ve,_t)}if(me(Ve)||Q(Ve))return ye=ye.get(_e)||null,Be(fe,ye,Ve,_t,null);if(typeof Ve.then=="function")return je(ye,fe,_e,yh(Ve),_t);if(Ve.$$typeof===ue)return je(ye,fe,_e,fh(fe,Ve),_t);xh(fe,Ve)}return null}function ht(ye,fe,_e,Ve){for(var _t=null,An=null,gt=fe,Yt=fe=0,cn=null;gt!==null&&Yt<_e.length;Yt++){gt.index>Yt?(cn=gt,gt=null):cn=gt.sibling;var Cn=Se(ye,gt,_e[Yt],Ve);if(Cn===null){gt===null&&(gt=cn);break}n&&gt&&Cn.alternate===null&&r(ye,gt),fe=_(Cn,fe,Yt),An===null?_t=Cn:An.sibling=Cn,An=Cn,gt=cn}if(Yt===_e.length)return c(ye,gt),gn&&fa(ye,Yt),_t;if(gt===null){for(;Yt<_e.length;Yt++)gt=ze(ye,_e[Yt],Ve),gt!==null&&(fe=_(gt,fe,Yt),An===null?_t=gt:An.sibling=gt,An=gt);return gn&&fa(ye,Yt),_t}for(gt=g(gt);Yt<_e.length;Yt++)cn=je(gt,ye,Yt,_e[Yt],Ve),cn!==null&&(n&&cn.alternate!==null&&gt.delete(cn.key===null?Yt:cn.key),fe=_(cn,fe,Yt),An===null?_t=cn:An.sibling=cn,An=cn);return n&&gt.forEach(function(wo){return r(ye,wo)}),gn&&fa(ye,Yt),_t}function Nt(ye,fe,_e,Ve){if(_e==null)throw Error(a(151));for(var _t=null,An=null,gt=fe,Yt=fe=0,cn=null,Cn=_e.next();gt!==null&&!Cn.done;Yt++,Cn=_e.next()){gt.index>Yt?(cn=gt,gt=null):cn=gt.sibling;var wo=Se(ye,gt,Cn.value,Ve);if(wo===null){gt===null&&(gt=cn);break}n&&gt&&wo.alternate===null&&r(ye,gt),fe=_(wo,fe,Yt),An===null?_t=wo:An.sibling=wo,An=wo,gt=cn}if(Cn.done)return c(ye,gt),gn&&fa(ye,Yt),_t;if(gt===null){for(;!Cn.done;Yt++,Cn=_e.next())Cn=ze(ye,Cn.value,Ve),Cn!==null&&(fe=_(Cn,fe,Yt),An===null?_t=Cn:An.sibling=Cn,An=Cn);return gn&&fa(ye,Yt),_t}for(gt=g(gt);!Cn.done;Yt++,Cn=_e.next())Cn=je(gt,ye,Yt,Cn.value,Ve),Cn!==null&&(n&&Cn.alternate!==null&&gt.delete(Cn.key===null?Yt:Cn.key),fe=_(Cn,fe,Yt),An===null?_t=Cn:An.sibling=Cn,An=Cn);return n&&gt.forEach(function(hA){return r(ye,hA)}),gn&&fa(ye,Yt),_t}function Bn(ye,fe,_e,Ve){if(typeof _e=="object"&&_e!==null&&_e.type===G&&_e.key===null&&(_e=_e.props.children),typeof _e=="object"&&_e!==null){switch(_e.$$typeof){case Y:e:{for(var _t=_e.key;fe!==null;){if(fe.key===_t){if(_t=_e.type,_t===G){if(fe.tag===7){c(ye,fe.sibling),Ve=w(fe,_e.props.children),Ve.return=ye,ye=Ve;break e}}else if(fe.elementType===_t||typeof _t=="object"&&_t!==null&&_t.$$typeof===F&&sl(_t)===fe.type){c(ye,fe.sibling),Ve=w(fe,_e.props),Fc(Ve,_e),Ve.return=ye,ye=Ve;break e}c(ye,fe);break}else r(ye,fe);fe=fe.sibling}_e.type===G?(Ve=$o(_e.props.children,ye.mode,Ve,_e.key),Ve.return=ye,ye=Ve):(Ve=uh(_e.type,_e.key,_e.props,null,ye.mode,Ve),Fc(Ve,_e),Ve.return=ye,ye=Ve)}return D(ye);case X:e:{for(_t=_e.key;fe!==null;){if(fe.key===_t)if(fe.tag===4&&fe.stateNode.containerInfo===_e.containerInfo&&fe.stateNode.implementation===_e.implementation){c(ye,fe.sibling),Ve=w(fe,_e.children||[]),Ve.return=ye,ye=Ve;break e}else{c(ye,fe);break}else r(ye,fe);fe=fe.sibling}Ve=Of(_e,ye.mode,Ve),Ve.return=ye,ye=Ve}return D(ye);case F:return _e=sl(_e),Bn(ye,fe,_e,Ve)}if(me(_e))return ht(ye,fe,_e,Ve);if(Q(_e)){if(_t=Q(_e),typeof _t!="function")throw Error(a(150));return _e=_t.call(_e),Nt(ye,fe,_e,Ve)}if(typeof _e.then=="function")return Bn(ye,fe,yh(_e),Ve);if(_e.$$typeof===ue)return Bn(ye,fe,fh(ye,_e),Ve);xh(ye,_e)}return typeof _e=="string"&&_e!==""||typeof _e=="number"||typeof _e=="bigint"?(_e=""+_e,fe!==null&&fe.tag===6?(c(ye,fe.sibling),Ve=w(fe,_e),Ve.return=ye,ye=Ve):(c(ye,fe),Ve=Mf(_e,ye.mode,Ve),Ve.return=ye,ye=Ve),D(ye)):c(ye,fe)}return function(ye,fe,_e,Ve){try{Vc=0;var _t=Bn(ye,fe,_e,Ve);return Bl=null,_t}catch(gt){if(gt===Pl||gt===gh)throw gt;var An=Wi(29,gt,null,ye.mode);return An.lanes=Ve,An.return=ye,An}}}var rl=zg(!0),Hg=zg(!1),no=!1;function Wf(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Yf(n,r){n=n.updateQueue,r.updateQueue===n&&(r.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,callbacks:null})}function so(n){return{lane:n,tag:0,payload:null,callback:null,next:null}}function io(n,r,c){var g=n.updateQueue;if(g===null)return null;if(g=g.shared,(Sn&2)!==0){var w=g.pending;return w===null?r.next=r:(r.next=w.next,w.next=r),g.pending=r,r=ch(n),Tg(n,null,c),r}return lh(n,g,r,c),ch(n)}function Uc(n,r,c){if(r=r.updateQueue,r!==null&&(r=r.shared,(c&4194048)!==0)){var g=r.lanes;g&=n.pendingLanes,c|=g,r.lanes=c,Ue(n,c)}}function Xf(n,r){var c=n.updateQueue,g=n.alternate;if(g!==null&&(g=g.updateQueue,c===g)){var w=null,_=null;if(c=c.firstBaseUpdate,c!==null){do{var D={lane:c.lane,tag:c.tag,payload:c.payload,callback:null,next:null};_===null?w=_=D:_=_.next=D,c=c.next}while(c!==null);_===null?w=_=r:_=_.next=r}else w=_=r;c={baseState:g.baseState,firstBaseUpdate:w,lastBaseUpdate:_,shared:g.shared,callbacks:g.callbacks},n.updateQueue=c;return}n=c.lastBaseUpdate,n===null?c.firstBaseUpdate=r:n.next=r,c.lastBaseUpdate=r}var Kf=!1;function zc(){if(Kf){var n=Ll;if(n!==null)throw n}}function Hc(n,r,c,g){Kf=!1;var w=n.updateQueue;no=!1;var _=w.firstBaseUpdate,D=w.lastBaseUpdate,U=w.shared.pending;if(U!==null){w.shared.pending=null;var re=U,Ae=re.next;re.next=null,D===null?_=Ae:D.next=Ae,D=re;var Be=n.alternate;Be!==null&&(Be=Be.updateQueue,U=Be.lastBaseUpdate,U!==D&&(U===null?Be.firstBaseUpdate=Ae:U.next=Ae,Be.lastBaseUpdate=re))}if(_!==null){var ze=w.baseState;D=0,Be=Ae=re=null,U=_;do{var Se=U.lane&-536870913,je=Se!==U.lane;if(je?(ln&Se)===Se:(g&Se)===Se){Se!==0&&Se===jl&&(Kf=!0),Be!==null&&(Be=Be.next={lane:0,tag:U.tag,payload:U.payload,callback:null,next:null});e:{var ht=n,Nt=U;Se=r;var Bn=c;switch(Nt.tag){case 1:if(ht=Nt.payload,typeof ht=="function"){ze=ht.call(Bn,ze,Se);break e}ze=ht;break e;case 3:ht.flags=ht.flags&-65537|128;case 0:if(ht=Nt.payload,Se=typeof ht=="function"?ht.call(Bn,ze,Se):ht,Se==null)break e;ze=I({},ze,Se);break e;case 2:no=!0}}Se=U.callback,Se!==null&&(n.flags|=64,je&&(n.flags|=8192),je=w.callbacks,je===null?w.callbacks=[Se]:je.push(Se))}else je={lane:Se,tag:U.tag,payload:U.payload,callback:U.callback,next:null},Be===null?(Ae=Be=je,re=ze):Be=Be.next=je,D|=Se;if(U=U.next,U===null){if(U=w.shared.pending,U===null)break;je=U,U=je.next,je.next=null,w.lastBaseUpdate=je,w.shared.pending=null}}while(!0);Be===null&&(re=ze),w.baseState=re,w.firstBaseUpdate=Ae,w.lastBaseUpdate=Be,_===null&&(w.shared.lanes=0),co|=D,n.lanes=D,n.memoizedState=ze}}function Gg(n,r){if(typeof n!="function")throw Error(a(191,n));n.call(r)}function qg(n,r){var c=n.callbacks;if(c!==null)for(n.callbacks=null,n=0;n<c.length;n++)Gg(c[n],r)}var Vl=L(null),vh=L(0);function Wg(n,r){n=Aa,ce(vh,n),ce(Vl,r),Aa=n|r.baseLanes}function Qf(){ce(vh,Aa),ce(Vl,Vl.current)}function Zf(){Aa=vh.current,oe(Vl),oe(vh)}var Yi=L(null),mr=null;function ro(n){var r=n.alternate;ce(bs,bs.current&1),ce(Yi,n),mr===null&&(r===null||Vl.current!==null||r.memoizedState!==null)&&(mr=n)}function $f(n){ce(bs,bs.current),ce(Yi,n),mr===null&&(mr=n)}function Yg(n){n.tag===22?(ce(bs,bs.current),ce(Yi,n),mr===null&&(mr=n)):ao()}function ao(){ce(bs,bs.current),ce(Yi,Yi.current)}function Xi(n){oe(Yi),mr===n&&(mr=null),oe(bs)}var bs=L(0);function wh(n){for(var r=n;r!==null;){if(r.tag===13){var c=r.memoizedState;if(c!==null&&(c=c.dehydrated,c===null||i0(c)||r0(c)))return r}else if(r.tag===19&&(r.memoizedProps.revealOrder==="forwards"||r.memoizedProps.revealOrder==="backwards"||r.memoizedProps.revealOrder==="unstable_legacy-backwards"||r.memoizedProps.revealOrder==="together")){if((r.flags&128)!==0)return r}else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===n)break;for(;r.sibling===null;){if(r.return===null||r.return===n)return null;r=r.return}r.sibling.return=r.return,r=r.sibling}return null}var pa=0,Gt=null,Ln=null,Is=null,bh=!1,Fl=!1,al=!1,Eh=0,Gc=0,Ul=null,t_=0;function gs(){throw Error(a(321))}function Jf(n,r){if(r===null)return!1;for(var c=0;c<r.length&&c<n.length;c++)if(!p(n[c],r[c]))return!1;return!0}function e1(n,r,c,g,w,_){return pa=_,Gt=r,r.memoizedState=null,r.updateQueue=null,r.lanes=0,te.H=n===null||n.memoizedState===null?Rp:g1,al=!1,_=c(g,w),al=!1,Fl&&(_=Kg(r,c,g,w)),Xg(n),_}function Xg(n){te.H=Yc;var r=Ln!==null&&Ln.next!==null;if(pa=0,Is=Ln=Gt=null,bh=!1,Gc=0,Ul=null,r)throw Error(a(300));n===null||Rs||(n=n.dependencies,n!==null&&dh(n)&&(Rs=!0))}function Kg(n,r,c,g){Gt=n;var w=0;do{if(Fl&&(Ul=null),Gc=0,Fl=!1,25<=w)throw Error(a(301));if(w+=1,Is=Ln=null,n.updateQueue!=null){var _=n.updateQueue;_.lastEffect=null,_.events=null,_.stores=null,_.memoCache!=null&&(_.memoCache.index=0)}te.H=Dp,_=r(c,g)}while(Fl);return _}function n_(){var n=te.H,r=n.useState()[0];return r=typeof r.then=="function"?qc(r):r,n=n.useState()[0],(Ln!==null?Ln.memoizedState:null)!==n&&(Gt.flags|=1024),r}function t1(){var n=Eh!==0;return Eh=0,n}function n1(n,r,c){r.updateQueue=n.updateQueue,r.flags&=-2053,n.lanes&=~c}function s1(n){if(bh){for(n=n.memoizedState;n!==null;){var r=n.queue;r!==null&&(r.pending=null),n=n.next}bh=!1}pa=0,Is=Ln=Gt=null,Fl=!1,Gc=Eh=0,Ul=null}function _i(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Is===null?Gt.memoizedState=Is=n:Is=Is.next=n,Is}function Es(){if(Ln===null){var n=Gt.alternate;n=n!==null?n.memoizedState:null}else n=Ln.next;var r=Is===null?Gt.memoizedState:Is.next;if(r!==null)Is=r,Ln=n;else{if(n===null)throw Gt.alternate===null?Error(a(467)):Error(a(310));Ln=n,n={memoizedState:Ln.memoizedState,baseState:Ln.baseState,baseQueue:Ln.baseQueue,queue:Ln.queue,next:null},Is===null?Gt.memoizedState=Is=n:Is=Is.next=n}return Is}function _h(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function qc(n){var r=Gc;return Gc+=1,Ul===null&&(Ul=[]),n=Vg(Ul,n,r),r=Gt,(Is===null?r.memoizedState:Is.next)===null&&(r=r.alternate,te.H=r===null||r.memoizedState===null?Rp:g1),n}function Ah(n){if(n!==null&&typeof n=="object"){if(typeof n.then=="function")return qc(n);if(n.$$typeof===ue)return ei(n)}throw Error(a(438,String(n)))}function i1(n){var r=null,c=Gt.updateQueue;if(c!==null&&(r=c.memoCache),r==null){var g=Gt.alternate;g!==null&&(g=g.updateQueue,g!==null&&(g=g.memoCache,g!=null&&(r={data:g.data.map(function(w){return w.slice()}),index:0})))}if(r==null&&(r={data:[],index:0}),c===null&&(c=_h(),Gt.updateQueue=c),c.memoCache=r,c=r.data[r.index],c===void 0)for(c=r.data[r.index]=Array(n),g=0;g<n;g++)c[g]=se;return r.index++,c}function ya(n,r){return typeof r=="function"?r(n):r}function Ch(n){var r=Es();return r1(r,Ln,n)}function r1(n,r,c){var g=n.queue;if(g===null)throw Error(a(311));g.lastRenderedReducer=c;var w=n.baseQueue,_=g.pending;if(_!==null){if(w!==null){var D=w.next;w.next=_.next,_.next=D}r.baseQueue=w=_,g.pending=null}if(_=n.baseState,w===null)n.memoizedState=_;else{r=w.next;var U=D=null,re=null,Ae=r,Be=!1;do{var ze=Ae.lane&-536870913;if(ze!==Ae.lane?(ln&ze)===ze:(pa&ze)===ze){var Se=Ae.revertLane;if(Se===0)re!==null&&(re=re.next={lane:0,revertLane:0,gesture:null,action:Ae.action,hasEagerState:Ae.hasEagerState,eagerState:Ae.eagerState,next:null}),ze===jl&&(Be=!0);else if((pa&Se)===Se){Ae=Ae.next,Se===jl&&(Be=!0);continue}else ze={lane:0,revertLane:Ae.revertLane,gesture:null,action:Ae.action,hasEagerState:Ae.hasEagerState,eagerState:Ae.eagerState,next:null},re===null?(U=re=ze,D=_):re=re.next=ze,Gt.lanes|=Se,co|=Se;ze=Ae.action,al&&c(_,ze),_=Ae.hasEagerState?Ae.eagerState:c(_,ze)}else Se={lane:ze,revertLane:Ae.revertLane,gesture:Ae.gesture,action:Ae.action,hasEagerState:Ae.hasEagerState,eagerState:Ae.eagerState,next:null},re===null?(U=re=Se,D=_):re=re.next=Se,Gt.lanes|=ze,co|=ze;Ae=Ae.next}while(Ae!==null&&Ae!==r);if(re===null?D=_:re.next=U,!p(_,n.memoizedState)&&(Rs=!0,Be&&(c=Ll,c!==null)))throw c;n.memoizedState=_,n.baseState=D,n.baseQueue=re,g.lastRenderedState=_}return w===null&&(g.lanes=0),[n.memoizedState,g.dispatch]}function a1(n){var r=Es(),c=r.queue;if(c===null)throw Error(a(311));c.lastRenderedReducer=n;var g=c.dispatch,w=c.pending,_=r.memoizedState;if(w!==null){c.pending=null;var D=w=w.next;do _=n(_,D.action),D=D.next;while(D!==w);p(_,r.memoizedState)||(Rs=!0),r.memoizedState=_,r.baseQueue===null&&(r.baseState=_),c.lastRenderedState=_}return[_,g]}function Qg(n,r,c){var g=Gt,w=Es(),_=gn;if(_){if(c===void 0)throw Error(a(407));c=c()}else c=r();var D=!p((Ln||w).memoizedState,c);if(D&&(w.memoizedState=c,Rs=!0),w=w.queue,c1(Jg.bind(null,g,w,n),[n]),w.getSnapshot!==r||D||Is!==null&&Is.memoizedState.tag&1){if(g.flags|=2048,zl(9,{destroy:void 0},$g.bind(null,g,w,c,r),null),zn===null)throw Error(a(349));_||(pa&127)!==0||Zg(g,r,c)}return c}function Zg(n,r,c){n.flags|=16384,n={getSnapshot:r,value:c},r=Gt.updateQueue,r===null?(r=_h(),Gt.updateQueue=r,r.stores=[n]):(c=r.stores,c===null?r.stores=[n]:c.push(n))}function $g(n,r,c,g){r.value=c,r.getSnapshot=g,ep(r)&&tp(n)}function Jg(n,r,c){return c(function(){ep(r)&&tp(n)})}function ep(n){var r=n.getSnapshot;n=n.value;try{var c=r();return!p(n,c)}catch{return!0}}function tp(n){var r=Zo(n,2);r!==null&&Li(r,n,2)}function o1(n){var r=_i();if(typeof n=="function"){var c=n;if(n=c(),al){en(!0);try{c()}finally{en(!1)}}}return r.memoizedState=r.baseState=n,r.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ya,lastRenderedState:n},r}function np(n,r,c,g){return n.baseState=c,r1(n,Ln,typeof g=="function"?g:ya)}function s_(n,r,c,g,w){if(Nh(n))throw Error(a(485));if(n=r.action,n!==null){var _={payload:w,action:n,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(D){_.listeners.push(D)}};te.T!==null?c(!0):_.isTransition=!1,g(_),c=r.pending,c===null?(_.next=r.pending=_,sp(r,_)):(_.next=c.next,r.pending=c.next=_)}}function sp(n,r){var c=r.action,g=r.payload,w=n.state;if(r.isTransition){var _=te.T,D={};te.T=D;try{var U=c(w,g),re=te.S;re!==null&&re(D,U),ip(n,r,U)}catch(Ae){l1(n,r,Ae)}finally{_!==null&&D.types!==null&&(_.types=D.types),te.T=_}}else try{_=c(w,g),ip(n,r,_)}catch(Ae){l1(n,r,Ae)}}function ip(n,r,c){c!==null&&typeof c=="object"&&typeof c.then=="function"?c.then(function(g){rp(n,r,g)},function(g){return l1(n,r,g)}):rp(n,r,c)}function rp(n,r,c){r.status="fulfilled",r.value=c,ap(r),n.state=c,r=n.pending,r!==null&&(c=r.next,c===r?n.pending=null:(c=c.next,r.next=c,sp(n,c)))}function l1(n,r,c){var g=n.pending;if(n.pending=null,g!==null){g=g.next;do r.status="rejected",r.reason=c,ap(r),r=r.next;while(r!==g)}n.action=null}function ap(n){n=n.listeners;for(var r=0;r<n.length;r++)(0,n[r])()}function op(n,r){return r}function lp(n,r){if(gn){var c=zn.formState;if(c!==null){e:{var g=Gt;if(gn){if(Kn){t:{for(var w=Kn,_=fr;w.nodeType!==8;){if(!_){w=null;break t}if(w=gr(w.nextSibling),w===null){w=null;break t}}_=w.data,w=_==="F!"||_==="F"?w:null}if(w){Kn=gr(w.nextSibling),g=w.data==="F!";break e}}eo(g)}g=!1}g&&(r=c[0])}}return c=_i(),c.memoizedState=c.baseState=r,g={pending:null,lanes:0,dispatch:null,lastRenderedReducer:op,lastRenderedState:r},c.queue=g,c=Sp.bind(null,Gt,g),g.dispatch=c,g=o1(!1),_=m1.bind(null,Gt,!1,g.queue),g=_i(),w={state:r,dispatch:null,action:n,pending:null},g.queue=w,c=s_.bind(null,Gt,w,_,c),w.dispatch=c,g.memoizedState=n,[r,c,!1]}function cp(n){var r=Es();return up(r,Ln,n)}function up(n,r,c){if(r=r1(n,r,op)[0],n=Ch(ya)[0],typeof r=="object"&&r!==null&&typeof r.then=="function")try{var g=qc(r)}catch(D){throw D===Pl?gh:D}else g=r;r=Es();var w=r.queue,_=w.dispatch;return c!==r.memoizedState&&(Gt.flags|=2048,zl(9,{destroy:void 0},i_.bind(null,w,c),null)),[g,_,n]}function i_(n,r){n.action=r}function hp(n){var r=Es(),c=Ln;if(c!==null)return up(r,c,n);Es(),r=r.memoizedState,c=Es();var g=c.queue.dispatch;return c.memoizedState=n,[r,g,!1]}function zl(n,r,c,g){return n={tag:n,create:c,deps:g,inst:r,next:null},r=Gt.updateQueue,r===null&&(r=_h(),Gt.updateQueue=r),c=r.lastEffect,c===null?r.lastEffect=n.next=n:(g=c.next,c.next=n,n.next=g,r.lastEffect=n),n}function dp(){return Es().memoizedState}function Th(n,r,c,g){var w=_i();Gt.flags|=n,w.memoizedState=zl(1|r,{destroy:void 0},c,g===void 0?null:g)}function Sh(n,r,c,g){var w=Es();g=g===void 0?null:g;var _=w.memoizedState.inst;Ln!==null&&g!==null&&Jf(g,Ln.memoizedState.deps)?w.memoizedState=zl(r,_,c,g):(Gt.flags|=n,w.memoizedState=zl(1|r,_,c,g))}function fp(n,r){Th(8390656,8,n,r)}function c1(n,r){Sh(2048,8,n,r)}function r_(n){Gt.flags|=4;var r=Gt.updateQueue;if(r===null)r=_h(),Gt.updateQueue=r,r.events=[n];else{var c=r.events;c===null?r.events=[n]:c.push(n)}}function mp(n){var r=Es().memoizedState;return r_({ref:r,nextImpl:n}),function(){if((Sn&2)!==0)throw Error(a(440));return r.impl.apply(void 0,arguments)}}function gp(n,r){return Sh(4,2,n,r)}function pp(n,r){return Sh(4,4,n,r)}function yp(n,r){if(typeof r=="function"){n=n();var c=r(n);return function(){typeof c=="function"?c():r(null)}}if(r!=null)return n=n(),r.current=n,function(){r.current=null}}function xp(n,r,c){c=c!=null?c.concat([n]):null,Sh(4,4,yp.bind(null,r,n),c)}function u1(){}function vp(n,r){var c=Es();r=r===void 0?null:r;var g=c.memoizedState;return r!==null&&Jf(r,g[1])?g[0]:(c.memoizedState=[n,r],n)}function wp(n,r){var c=Es();r=r===void 0?null:r;var g=c.memoizedState;if(r!==null&&Jf(r,g[1]))return g[0];if(g=n(),al){en(!0);try{n()}finally{en(!1)}}return c.memoizedState=[g,r],g}function h1(n,r,c){return c===void 0||(pa&1073741824)!==0&&(ln&261930)===0?n.memoizedState=r:(n.memoizedState=c,n=b2(),Gt.lanes|=n,co|=n,c)}function bp(n,r,c,g){return p(c,r)?c:Vl.current!==null?(n=h1(n,c,g),p(n,r)||(Rs=!0),n):(pa&42)===0||(pa&1073741824)!==0&&(ln&261930)===0?(Rs=!0,n.memoizedState=c):(n=b2(),Gt.lanes|=n,co|=n,r)}function Ep(n,r,c,g,w){var _=ge.p;ge.p=_!==0&&8>_?_:8;var D=te.T,U={};te.T=U,m1(n,!1,r,c);try{var re=w(),Ae=te.S;if(Ae!==null&&Ae(U,re),re!==null&&typeof re=="object"&&typeof re.then=="function"){var Be=e_(re,g);Wc(n,r,Be,Zi(n))}else Wc(n,r,g,Zi(n))}catch(ze){Wc(n,r,{then:function(){},status:"rejected",reason:ze},Zi())}finally{ge.p=_,D!==null&&U.types!==null&&(D.types=U.types),te.T=D}}function a_(){}function d1(n,r,c,g){if(n.tag!==5)throw Error(a(476));var w=_p(n).queue;Ep(n,w,r,He,c===null?a_:function(){return Ap(n),c(g)})}function _p(n){var r=n.memoizedState;if(r!==null)return r;r={memoizedState:He,baseState:He,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ya,lastRenderedState:He},next:null};var c={};return r.next={memoizedState:c,baseState:c,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ya,lastRenderedState:c},next:null},n.memoizedState=r,n=n.alternate,n!==null&&(n.memoizedState=r),r}function Ap(n){var r=_p(n);r.next===null&&(r=n.alternate.memoizedState),Wc(n,r.next.queue,{},Zi())}function f1(){return ei(cu)}function Cp(){return Es().memoizedState}function Tp(){return Es().memoizedState}function o_(n){for(var r=n.return;r!==null;){switch(r.tag){case 24:case 3:var c=Zi();n=so(c);var g=io(r,n,c);g!==null&&(Li(g,r,c),Uc(g,r,c)),r={cache:zf()},n.payload=r;return}r=r.return}}function l_(n,r,c){var g=Zi();c={lane:g,revertLane:0,gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},Nh(n)?Np(r,c):(c=Df(n,r,c,g),c!==null&&(Li(c,n,g),Ip(c,r,g)))}function Sp(n,r,c){var g=Zi();Wc(n,r,c,g)}function Wc(n,r,c,g){var w={lane:g,revertLane:0,gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null};if(Nh(n))Np(r,w);else{var _=n.alternate;if(n.lanes===0&&(_===null||_.lanes===0)&&(_=r.lastRenderedReducer,_!==null))try{var D=r.lastRenderedState,U=_(D,c);if(w.hasEagerState=!0,w.eagerState=U,p(U,D))return lh(n,r,w,0),zn===null&&oh(),!1}catch{}if(c=Df(n,r,w,g),c!==null)return Li(c,n,g),Ip(c,r,g),!0}return!1}function m1(n,r,c,g){if(g={lane:2,revertLane:W1(),gesture:null,action:g,hasEagerState:!1,eagerState:null,next:null},Nh(n)){if(r)throw Error(a(479))}else r=Df(n,c,g,2),r!==null&&Li(r,n,2)}function Nh(n){var r=n.alternate;return n===Gt||r!==null&&r===Gt}function Np(n,r){Fl=bh=!0;var c=n.pending;c===null?r.next=r:(r.next=c.next,c.next=r),n.pending=r}function Ip(n,r,c){if((c&4194048)!==0){var g=r.lanes;g&=n.pendingLanes,c|=g,r.lanes=c,Ue(n,c)}}var Yc={readContext:ei,use:Ah,useCallback:gs,useContext:gs,useEffect:gs,useImperativeHandle:gs,useLayoutEffect:gs,useInsertionEffect:gs,useMemo:gs,useReducer:gs,useRef:gs,useState:gs,useDebugValue:gs,useDeferredValue:gs,useTransition:gs,useSyncExternalStore:gs,useId:gs,useHostTransitionStatus:gs,useFormState:gs,useActionState:gs,useOptimistic:gs,useMemoCache:gs,useCacheRefresh:gs};Yc.useEffectEvent=gs;var Rp={readContext:ei,use:Ah,useCallback:function(n,r){return _i().memoizedState=[n,r===void 0?null:r],n},useContext:ei,useEffect:fp,useImperativeHandle:function(n,r,c){c=c!=null?c.concat([n]):null,Th(4194308,4,yp.bind(null,r,n),c)},useLayoutEffect:function(n,r){return Th(4194308,4,n,r)},useInsertionEffect:function(n,r){Th(4,2,n,r)},useMemo:function(n,r){var c=_i();r=r===void 0?null:r;var g=n();if(al){en(!0);try{n()}finally{en(!1)}}return c.memoizedState=[g,r],g},useReducer:function(n,r,c){var g=_i();if(c!==void 0){var w=c(r);if(al){en(!0);try{c(r)}finally{en(!1)}}}else w=r;return g.memoizedState=g.baseState=w,n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:w},g.queue=n,n=n.dispatch=l_.bind(null,Gt,n),[g.memoizedState,n]},useRef:function(n){var r=_i();return n={current:n},r.memoizedState=n},useState:function(n){n=o1(n);var r=n.queue,c=Sp.bind(null,Gt,r);return r.dispatch=c,[n.memoizedState,c]},useDebugValue:u1,useDeferredValue:function(n,r){var c=_i();return h1(c,n,r)},useTransition:function(){var n=o1(!1);return n=Ep.bind(null,Gt,n.queue,!0,!1),_i().memoizedState=n,[!1,n]},useSyncExternalStore:function(n,r,c){var g=Gt,w=_i();if(gn){if(c===void 0)throw Error(a(407));c=c()}else{if(c=r(),zn===null)throw Error(a(349));(ln&127)!==0||Zg(g,r,c)}w.memoizedState=c;var _={value:c,getSnapshot:r};return w.queue=_,fp(Jg.bind(null,g,_,n),[n]),g.flags|=2048,zl(9,{destroy:void 0},$g.bind(null,g,_,c,r),null),c},useId:function(){var n=_i(),r=zn.identifierPrefix;if(gn){var c=Gr,g=Hr;c=(g&~(1<<32-Ct(g)-1)).toString(32)+c,r="_"+r+"R_"+c,c=Eh++,0<c&&(r+="H"+c.toString(32)),r+="_"}else c=t_++,r="_"+r+"r_"+c.toString(32)+"_";return n.memoizedState=r},useHostTransitionStatus:f1,useFormState:lp,useActionState:lp,useOptimistic:function(n){var r=_i();r.memoizedState=r.baseState=n;var c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return r.queue=c,r=m1.bind(null,Gt,!0,c),c.dispatch=r,[n,r]},useMemoCache:i1,useCacheRefresh:function(){return _i().memoizedState=o_.bind(null,Gt)},useEffectEvent:function(n){var r=_i(),c={impl:n};return r.memoizedState=c,function(){if((Sn&2)!==0)throw Error(a(440));return c.impl.apply(void 0,arguments)}}},g1={readContext:ei,use:Ah,useCallback:vp,useContext:ei,useEffect:c1,useImperativeHandle:xp,useInsertionEffect:gp,useLayoutEffect:pp,useMemo:wp,useReducer:Ch,useRef:dp,useState:function(){return Ch(ya)},useDebugValue:u1,useDeferredValue:function(n,r){var c=Es();return bp(c,Ln.memoizedState,n,r)},useTransition:function(){var n=Ch(ya)[0],r=Es().memoizedState;return[typeof n=="boolean"?n:qc(n),r]},useSyncExternalStore:Qg,useId:Cp,useHostTransitionStatus:f1,useFormState:cp,useActionState:cp,useOptimistic:function(n,r){var c=Es();return np(c,Ln,n,r)},useMemoCache:i1,useCacheRefresh:Tp};g1.useEffectEvent=mp;var Dp={readContext:ei,use:Ah,useCallback:vp,useContext:ei,useEffect:c1,useImperativeHandle:xp,useInsertionEffect:gp,useLayoutEffect:pp,useMemo:wp,useReducer:a1,useRef:dp,useState:function(){return a1(ya)},useDebugValue:u1,useDeferredValue:function(n,r){var c=Es();return Ln===null?h1(c,n,r):bp(c,Ln.memoizedState,n,r)},useTransition:function(){var n=a1(ya)[0],r=Es().memoizedState;return[typeof n=="boolean"?n:qc(n),r]},useSyncExternalStore:Qg,useId:Cp,useHostTransitionStatus:f1,useFormState:hp,useActionState:hp,useOptimistic:function(n,r){var c=Es();return Ln!==null?np(c,Ln,n,r):(c.baseState=n,[n,c.queue.dispatch])},useMemoCache:i1,useCacheRefresh:Tp};Dp.useEffectEvent=mp;function p1(n,r,c,g){r=n.memoizedState,c=c(g,r),c=c==null?r:I({},r,c),n.memoizedState=c,n.lanes===0&&(n.updateQueue.baseState=c)}var y1={enqueueSetState:function(n,r,c){n=n._reactInternals;var g=Zi(),w=so(g);w.payload=r,c!=null&&(w.callback=c),r=io(n,w,g),r!==null&&(Li(r,n,g),Uc(r,n,g))},enqueueReplaceState:function(n,r,c){n=n._reactInternals;var g=Zi(),w=so(g);w.tag=1,w.payload=r,c!=null&&(w.callback=c),r=io(n,w,g),r!==null&&(Li(r,n,g),Uc(r,n,g))},enqueueForceUpdate:function(n,r){n=n._reactInternals;var c=Zi(),g=so(c);g.tag=2,r!=null&&(g.callback=r),r=io(n,g,c),r!==null&&(Li(r,n,c),Uc(r,n,c))}};function kp(n,r,c,g,w,_,D){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(g,_,D):r.prototype&&r.prototype.isPureReactComponent?!v(c,g)||!v(w,_):!0}function Mp(n,r,c,g){n=r.state,typeof r.componentWillReceiveProps=="function"&&r.componentWillReceiveProps(c,g),typeof r.UNSAFE_componentWillReceiveProps=="function"&&r.UNSAFE_componentWillReceiveProps(c,g),r.state!==n&&y1.enqueueReplaceState(r,r.state,null)}function ol(n,r){var c=r;if("ref"in r){c={};for(var g in r)g!=="ref"&&(c[g]=r[g])}if(n=n.defaultProps){c===r&&(c=I({},c));for(var w in n)c[w]===void 0&&(c[w]=n[w])}return c}function Op(n){ah(n)}function jp(n){console.error(n)}function Lp(n){ah(n)}function Ih(n,r){try{var c=n.onUncaughtError;c(r.value,{componentStack:r.stack})}catch(g){setTimeout(function(){throw g})}}function Pp(n,r,c){try{var g=n.onCaughtError;g(c.value,{componentStack:c.stack,errorBoundary:r.tag===1?r.stateNode:null})}catch(w){setTimeout(function(){throw w})}}function x1(n,r,c){return c=so(c),c.tag=3,c.payload={element:null},c.callback=function(){Ih(n,r)},c}function Bp(n){return n=so(n),n.tag=3,n}function Vp(n,r,c,g){var w=c.type.getDerivedStateFromError;if(typeof w=="function"){var _=g.value;n.payload=function(){return w(_)},n.callback=function(){Pp(r,c,g)}}var D=c.stateNode;D!==null&&typeof D.componentDidCatch=="function"&&(n.callback=function(){Pp(r,c,g),typeof w!="function"&&(uo===null?uo=new Set([this]):uo.add(this));var U=g.stack;this.componentDidCatch(g.value,{componentStack:U!==null?U:""})})}function c_(n,r,c,g,w){if(c.flags|=32768,g!==null&&typeof g=="object"&&typeof g.then=="function"){if(r=c.alternate,r!==null&&Ol(r,c,w,!0),c=Yi.current,c!==null){switch(c.tag){case 31:case 13:return mr===null?Uh():c.alternate===null&&ps===0&&(ps=3),c.flags&=-257,c.flags|=65536,c.lanes=w,g===ph?c.flags|=16384:(r=c.updateQueue,r===null?c.updateQueue=new Set([g]):r.add(g),H1(n,g,w)),!1;case 22:return c.flags|=65536,g===ph?c.flags|=16384:(r=c.updateQueue,r===null?(r={transitions:null,markerInstances:null,retryQueue:new Set([g])},c.updateQueue=r):(c=r.retryQueue,c===null?r.retryQueue=new Set([g]):c.add(g)),H1(n,g,w)),!1}throw Error(a(435,c.tag))}return H1(n,g,w),Uh(),!1}if(gn)return r=Yi.current,r!==null?((r.flags&65536)===0&&(r.flags|=256),r.flags|=65536,r.lanes=w,g!==Pf&&(n=Error(a(422),{cause:g}),Lc(ur(n,c)))):(g!==Pf&&(r=Error(a(423),{cause:g}),Lc(ur(r,c))),n=n.current.alternate,n.flags|=65536,w&=-w,n.lanes|=w,g=ur(g,c),w=x1(n.stateNode,g,w),Xf(n,w),ps!==4&&(ps=2)),!1;var _=Error(a(520),{cause:g});if(_=ur(_,c),tu===null?tu=[_]:tu.push(_),ps!==4&&(ps=2),r===null)return!0;g=ur(g,c),c=r;do{switch(c.tag){case 3:return c.flags|=65536,n=w&-w,c.lanes|=n,n=x1(c.stateNode,g,n),Xf(c,n),!1;case 1:if(r=c.type,_=c.stateNode,(c.flags&128)===0&&(typeof r.getDerivedStateFromError=="function"||_!==null&&typeof _.componentDidCatch=="function"&&(uo===null||!uo.has(_))))return c.flags|=65536,w&=-w,c.lanes|=w,w=Bp(w),Vp(w,n,c,g),Xf(c,w),!1}c=c.return}while(c!==null);return!1}var v1=Error(a(461)),Rs=!1;function ti(n,r,c,g){r.child=n===null?Hg(r,null,c,g):rl(r,n.child,c,g)}function Fp(n,r,c,g,w){c=c.render;var _=r.ref;if("ref"in g){var D={};for(var U in g)U!=="ref"&&(D[U]=g[U])}else D=g;return tl(r),g=e1(n,r,c,D,_,w),U=t1(),n!==null&&!Rs?(n1(n,r,w),xa(n,r,w)):(gn&&U&&jf(r),r.flags|=1,ti(n,r,g,w),r.child)}function Up(n,r,c,g,w){if(n===null){var _=c.type;return typeof _=="function"&&!kf(_)&&_.defaultProps===void 0&&c.compare===null?(r.tag=15,r.type=_,zp(n,r,_,g,w)):(n=uh(c.type,null,g,r,r.mode,w),n.ref=r.ref,n.return=r,r.child=n)}if(_=n.child,!S1(n,w)){var D=_.memoizedProps;if(c=c.compare,c=c!==null?c:v,c(D,g)&&n.ref===r.ref)return xa(n,r,w)}return r.flags|=1,n=da(_,g),n.ref=r.ref,n.return=r,r.child=n}function zp(n,r,c,g,w){if(n!==null){var _=n.memoizedProps;if(v(_,g)&&n.ref===r.ref)if(Rs=!1,r.pendingProps=g=_,S1(n,w))(n.flags&131072)!==0&&(Rs=!0);else return r.lanes=n.lanes,xa(n,r,w)}return w1(n,r,c,g,w)}function Hp(n,r,c,g){var w=g.children,_=n!==null?n.memoizedState:null;if(n===null&&r.stateNode===null&&(r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),g.mode==="hidden"){if((r.flags&128)!==0){if(_=_!==null?_.baseLanes|c:c,n!==null){for(g=r.child=n.child,w=0;g!==null;)w=w|g.lanes|g.childLanes,g=g.sibling;g=w&~_}else g=0,r.child=null;return Gp(n,r,_,c,g)}if((c&536870912)!==0)r.memoizedState={baseLanes:0,cachePool:null},n!==null&&mh(r,_!==null?_.cachePool:null),_!==null?Wg(r,_):Qf(),Yg(r);else return g=r.lanes=536870912,Gp(n,r,_!==null?_.baseLanes|c:c,c,g)}else _!==null?(mh(r,_.cachePool),Wg(r,_),ao(),r.memoizedState=null):(n!==null&&mh(r,null),Qf(),ao());return ti(n,r,w,c),r.child}function Xc(n,r){return n!==null&&n.tag===22||r.stateNode!==null||(r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),r.sibling}function Gp(n,r,c,g,w){var _=Gf();return _=_===null?null:{parent:Ns._currentValue,pool:_},r.memoizedState={baseLanes:c,cachePool:_},n!==null&&mh(r,null),Qf(),Yg(r),n!==null&&Ol(n,r,g,!0),r.childLanes=w,null}function Rh(n,r){return r=kh({mode:r.mode,children:r.children},n.mode),r.ref=n.ref,n.child=r,r.return=n,r}function qp(n,r,c){return rl(r,n.child,null,c),n=Rh(r,r.pendingProps),n.flags|=2,Xi(r),r.memoizedState=null,n}function u_(n,r,c){var g=r.pendingProps,w=(r.flags&128)!==0;if(r.flags&=-129,n===null){if(gn){if(g.mode==="hidden")return n=Rh(r,g),r.lanes=536870912,Xc(null,n);if($f(r),(n=Kn)?(n=sy(n,fr),n=n!==null&&n.data==="&"?n:null,n!==null&&(r.memoizedState={dehydrated:n,treeContext:$a!==null?{id:Hr,overflow:Gr}:null,retryLane:536870912,hydrationErrors:null},c=Ng(n),c.return=r,r.child=c,Js=r,Kn=null)):n=null,n===null)throw eo(r);return r.lanes=536870912,null}return Rh(r,g)}var _=n.memoizedState;if(_!==null){var D=_.dehydrated;if($f(r),w)if(r.flags&256)r.flags&=-257,r=qp(n,r,c);else if(r.memoizedState!==null)r.child=n.child,r.flags|=128,r=null;else throw Error(a(558));else if(Rs||Ol(n,r,c,!1),w=(c&n.childLanes)!==0,Rs||w){if(g=zn,g!==null&&(D=Ze(g,c),D!==0&&D!==_.retryLane))throw _.retryLane=D,Zo(n,D),Li(g,n,D),v1;Uh(),r=qp(n,r,c)}else n=_.treeContext,Kn=gr(D.nextSibling),Js=r,gn=!0,Ja=null,fr=!1,n!==null&&Dg(r,n),r=Rh(r,g),r.flags|=4096;return r}return n=da(n.child,{mode:g.mode,children:g.children}),n.ref=r.ref,r.child=n,n.return=r,n}function Dh(n,r){var c=r.ref;if(c===null)n!==null&&n.ref!==null&&(r.flags|=4194816);else{if(typeof c!="function"&&typeof c!="object")throw Error(a(284));(n===null||n.ref!==c)&&(r.flags|=4194816)}}function w1(n,r,c,g,w){return tl(r),c=e1(n,r,c,g,void 0,w),g=t1(),n!==null&&!Rs?(n1(n,r,w),xa(n,r,w)):(gn&&g&&jf(r),r.flags|=1,ti(n,r,c,w),r.child)}function Wp(n,r,c,g,w,_){return tl(r),r.updateQueue=null,c=Kg(r,g,c,w),Xg(n),g=t1(),n!==null&&!Rs?(n1(n,r,_),xa(n,r,_)):(gn&&g&&jf(r),r.flags|=1,ti(n,r,c,_),r.child)}function Yp(n,r,c,g,w){if(tl(r),r.stateNode===null){var _=Rl,D=c.contextType;typeof D=="object"&&D!==null&&(_=ei(D)),_=new c(g,_),r.memoizedState=_.state!==null&&_.state!==void 0?_.state:null,_.updater=y1,r.stateNode=_,_._reactInternals=r,_=r.stateNode,_.props=g,_.state=r.memoizedState,_.refs={},Wf(r),D=c.contextType,_.context=typeof D=="object"&&D!==null?ei(D):Rl,_.state=r.memoizedState,D=c.getDerivedStateFromProps,typeof D=="function"&&(p1(r,c,D,g),_.state=r.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof _.getSnapshotBeforeUpdate=="function"||typeof _.UNSAFE_componentWillMount!="function"&&typeof _.componentWillMount!="function"||(D=_.state,typeof _.componentWillMount=="function"&&_.componentWillMount(),typeof _.UNSAFE_componentWillMount=="function"&&_.UNSAFE_componentWillMount(),D!==_.state&&y1.enqueueReplaceState(_,_.state,null),Hc(r,g,_,w),zc(),_.state=r.memoizedState),typeof _.componentDidMount=="function"&&(r.flags|=4194308),g=!0}else if(n===null){_=r.stateNode;var U=r.memoizedProps,re=ol(c,U);_.props=re;var Ae=_.context,Be=c.contextType;D=Rl,typeof Be=="object"&&Be!==null&&(D=ei(Be));var ze=c.getDerivedStateFromProps;Be=typeof ze=="function"||typeof _.getSnapshotBeforeUpdate=="function",U=r.pendingProps!==U,Be||typeof _.UNSAFE_componentWillReceiveProps!="function"&&typeof _.componentWillReceiveProps!="function"||(U||Ae!==D)&&Mp(r,_,g,D),no=!1;var Se=r.memoizedState;_.state=Se,Hc(r,g,_,w),zc(),Ae=r.memoizedState,U||Se!==Ae||no?(typeof ze=="function"&&(p1(r,c,ze,g),Ae=r.memoizedState),(re=no||kp(r,c,re,g,Se,Ae,D))?(Be||typeof _.UNSAFE_componentWillMount!="function"&&typeof _.componentWillMount!="function"||(typeof _.componentWillMount=="function"&&_.componentWillMount(),typeof _.UNSAFE_componentWillMount=="function"&&_.UNSAFE_componentWillMount()),typeof _.componentDidMount=="function"&&(r.flags|=4194308)):(typeof _.componentDidMount=="function"&&(r.flags|=4194308),r.memoizedProps=g,r.memoizedState=Ae),_.props=g,_.state=Ae,_.context=D,g=re):(typeof _.componentDidMount=="function"&&(r.flags|=4194308),g=!1)}else{_=r.stateNode,Yf(n,r),D=r.memoizedProps,Be=ol(c,D),_.props=Be,ze=r.pendingProps,Se=_.context,Ae=c.contextType,re=Rl,typeof Ae=="object"&&Ae!==null&&(re=ei(Ae)),U=c.getDerivedStateFromProps,(Ae=typeof U=="function"||typeof _.getSnapshotBeforeUpdate=="function")||typeof _.UNSAFE_componentWillReceiveProps!="function"&&typeof _.componentWillReceiveProps!="function"||(D!==ze||Se!==re)&&Mp(r,_,g,re),no=!1,Se=r.memoizedState,_.state=Se,Hc(r,g,_,w),zc();var je=r.memoizedState;D!==ze||Se!==je||no||n!==null&&n.dependencies!==null&&dh(n.dependencies)?(typeof U=="function"&&(p1(r,c,U,g),je=r.memoizedState),(Be=no||kp(r,c,Be,g,Se,je,re)||n!==null&&n.dependencies!==null&&dh(n.dependencies))?(Ae||typeof _.UNSAFE_componentWillUpdate!="function"&&typeof _.componentWillUpdate!="function"||(typeof _.componentWillUpdate=="function"&&_.componentWillUpdate(g,je,re),typeof _.UNSAFE_componentWillUpdate=="function"&&_.UNSAFE_componentWillUpdate(g,je,re)),typeof _.componentDidUpdate=="function"&&(r.flags|=4),typeof _.getSnapshotBeforeUpdate=="function"&&(r.flags|=1024)):(typeof _.componentDidUpdate!="function"||D===n.memoizedProps&&Se===n.memoizedState||(r.flags|=4),typeof _.getSnapshotBeforeUpdate!="function"||D===n.memoizedProps&&Se===n.memoizedState||(r.flags|=1024),r.memoizedProps=g,r.memoizedState=je),_.props=g,_.state=je,_.context=re,g=Be):(typeof _.componentDidUpdate!="function"||D===n.memoizedProps&&Se===n.memoizedState||(r.flags|=4),typeof _.getSnapshotBeforeUpdate!="function"||D===n.memoizedProps&&Se===n.memoizedState||(r.flags|=1024),g=!1)}return _=g,Dh(n,r),g=(r.flags&128)!==0,_||g?(_=r.stateNode,c=g&&typeof c.getDerivedStateFromError!="function"?null:_.render(),r.flags|=1,n!==null&&g?(r.child=rl(r,n.child,null,w),r.child=rl(r,null,c,w)):ti(n,r,c,w),r.memoizedState=_.state,n=r.child):n=xa(n,r,w),n}function Xp(n,r,c,g){return Jo(),r.flags|=256,ti(n,r,c,g),r.child}var b1={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function E1(n){return{baseLanes:n,cachePool:Pg()}}function _1(n,r,c){return n=n!==null?n.childLanes&~c:0,r&&(n|=Qi),n}function Kp(n,r,c){var g=r.pendingProps,w=!1,_=(r.flags&128)!==0,D;if((D=_)||(D=n!==null&&n.memoizedState===null?!1:(bs.current&2)!==0),D&&(w=!0,r.flags&=-129),D=(r.flags&32)!==0,r.flags&=-33,n===null){if(gn){if(w?ro(r):ao(),(n=Kn)?(n=sy(n,fr),n=n!==null&&n.data!=="&"?n:null,n!==null&&(r.memoizedState={dehydrated:n,treeContext:$a!==null?{id:Hr,overflow:Gr}:null,retryLane:536870912,hydrationErrors:null},c=Ng(n),c.return=r,r.child=c,Js=r,Kn=null)):n=null,n===null)throw eo(r);return r0(n)?r.lanes=32:r.lanes=536870912,null}var U=g.children;return g=g.fallback,w?(ao(),w=r.mode,U=kh({mode:"hidden",children:U},w),g=$o(g,w,c,null),U.return=r,g.return=r,U.sibling=g,r.child=U,g=r.child,g.memoizedState=E1(c),g.childLanes=_1(n,D,c),r.memoizedState=b1,Xc(null,g)):(ro(r),A1(r,U))}var re=n.memoizedState;if(re!==null&&(U=re.dehydrated,U!==null)){if(_)r.flags&256?(ro(r),r.flags&=-257,r=C1(n,r,c)):r.memoizedState!==null?(ao(),r.child=n.child,r.flags|=128,r=null):(ao(),U=g.fallback,w=r.mode,g=kh({mode:"visible",children:g.children},w),U=$o(U,w,c,null),U.flags|=2,g.return=r,U.return=r,g.sibling=U,r.child=g,rl(r,n.child,null,c),g=r.child,g.memoizedState=E1(c),g.childLanes=_1(n,D,c),r.memoizedState=b1,r=Xc(null,g));else if(ro(r),r0(U)){if(D=U.nextSibling&&U.nextSibling.dataset,D)var Ae=D.dgst;D=Ae,g=Error(a(419)),g.stack="",g.digest=D,Lc({value:g,source:null,stack:null}),r=C1(n,r,c)}else if(Rs||Ol(n,r,c,!1),D=(c&n.childLanes)!==0,Rs||D){if(D=zn,D!==null&&(g=Ze(D,c),g!==0&&g!==re.retryLane))throw re.retryLane=g,Zo(n,g),Li(D,n,g),v1;i0(U)||Uh(),r=C1(n,r,c)}else i0(U)?(r.flags|=192,r.child=n.child,r=null):(n=re.treeContext,Kn=gr(U.nextSibling),Js=r,gn=!0,Ja=null,fr=!1,n!==null&&Dg(r,n),r=A1(r,g.children),r.flags|=4096);return r}return w?(ao(),U=g.fallback,w=r.mode,re=n.child,Ae=re.sibling,g=da(re,{mode:"hidden",children:g.children}),g.subtreeFlags=re.subtreeFlags&65011712,Ae!==null?U=da(Ae,U):(U=$o(U,w,c,null),U.flags|=2),U.return=r,g.return=r,g.sibling=U,r.child=g,Xc(null,g),g=r.child,U=n.child.memoizedState,U===null?U=E1(c):(w=U.cachePool,w!==null?(re=Ns._currentValue,w=w.parent!==re?{parent:re,pool:re}:w):w=Pg(),U={baseLanes:U.baseLanes|c,cachePool:w}),g.memoizedState=U,g.childLanes=_1(n,D,c),r.memoizedState=b1,Xc(n.child,g)):(ro(r),c=n.child,n=c.sibling,c=da(c,{mode:"visible",children:g.children}),c.return=r,c.sibling=null,n!==null&&(D=r.deletions,D===null?(r.deletions=[n],r.flags|=16):D.push(n)),r.child=c,r.memoizedState=null,c)}function A1(n,r){return r=kh({mode:"visible",children:r},n.mode),r.return=n,n.child=r}function kh(n,r){return n=Wi(22,n,null,r),n.lanes=0,n}function C1(n,r,c){return rl(r,n.child,null,c),n=A1(r,r.pendingProps.children),n.flags|=2,r.memoizedState=null,n}function Qp(n,r,c){n.lanes|=r;var g=n.alternate;g!==null&&(g.lanes|=r),Ff(n.return,r,c)}function T1(n,r,c,g,w,_){var D=n.memoizedState;D===null?n.memoizedState={isBackwards:r,rendering:null,renderingStartTime:0,last:g,tail:c,tailMode:w,treeForkCount:_}:(D.isBackwards=r,D.rendering=null,D.renderingStartTime=0,D.last=g,D.tail=c,D.tailMode=w,D.treeForkCount=_)}function Zp(n,r,c){var g=r.pendingProps,w=g.revealOrder,_=g.tail;g=g.children;var D=bs.current,U=(D&2)!==0;if(U?(D=D&1|2,r.flags|=128):D&=1,ce(bs,D),ti(n,r,g,c),g=gn?jc:0,!U&&n!==null&&(n.flags&128)!==0)e:for(n=r.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&Qp(n,c,r);else if(n.tag===19)Qp(n,c,r);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===r)break e;for(;n.sibling===null;){if(n.return===null||n.return===r)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}switch(w){case"forwards":for(c=r.child,w=null;c!==null;)n=c.alternate,n!==null&&wh(n)===null&&(w=c),c=c.sibling;c=w,c===null?(w=r.child,r.child=null):(w=c.sibling,c.sibling=null),T1(r,!1,w,c,_,g);break;case"backwards":case"unstable_legacy-backwards":for(c=null,w=r.child,r.child=null;w!==null;){if(n=w.alternate,n!==null&&wh(n)===null){r.child=w;break}n=w.sibling,w.sibling=c,c=w,w=n}T1(r,!0,c,null,_,g);break;case"together":T1(r,!1,null,null,void 0,g);break;default:r.memoizedState=null}return r.child}function xa(n,r,c){if(n!==null&&(r.dependencies=n.dependencies),co|=r.lanes,(c&r.childLanes)===0)if(n!==null){if(Ol(n,r,c,!1),(c&r.childLanes)===0)return null}else return null;if(n!==null&&r.child!==n.child)throw Error(a(153));if(r.child!==null){for(n=r.child,c=da(n,n.pendingProps),r.child=c,c.return=r;n.sibling!==null;)n=n.sibling,c=c.sibling=da(n,n.pendingProps),c.return=r;c.sibling=null}return r.child}function S1(n,r){return(n.lanes&r)!==0?!0:(n=n.dependencies,!!(n!==null&&dh(n)))}function h_(n,r,c){switch(r.tag){case 3:Pe(r,r.stateNode.containerInfo),to(r,Ns,n.memoizedState.cache),Jo();break;case 27:case 5:dt(r);break;case 4:Pe(r,r.stateNode.containerInfo);break;case 10:to(r,r.type,r.memoizedProps.value);break;case 31:if(r.memoizedState!==null)return r.flags|=128,$f(r),null;break;case 13:var g=r.memoizedState;if(g!==null)return g.dehydrated!==null?(ro(r),r.flags|=128,null):(c&r.child.childLanes)!==0?Kp(n,r,c):(ro(r),n=xa(n,r,c),n!==null?n.sibling:null);ro(r);break;case 19:var w=(n.flags&128)!==0;if(g=(c&r.childLanes)!==0,g||(Ol(n,r,c,!1),g=(c&r.childLanes)!==0),w){if(g)return Zp(n,r,c);r.flags|=128}if(w=r.memoizedState,w!==null&&(w.rendering=null,w.tail=null,w.lastEffect=null),ce(bs,bs.current),g)break;return null;case 22:return r.lanes=0,Hp(n,r,c,r.pendingProps);case 24:to(r,Ns,n.memoizedState.cache)}return xa(n,r,c)}function $p(n,r,c){if(n!==null)if(n.memoizedProps!==r.pendingProps)Rs=!0;else{if(!S1(n,c)&&(r.flags&128)===0)return Rs=!1,h_(n,r,c);Rs=(n.flags&131072)!==0}else Rs=!1,gn&&(r.flags&1048576)!==0&&Rg(r,jc,r.index);switch(r.lanes=0,r.tag){case 16:e:{var g=r.pendingProps;if(n=sl(r.elementType),r.type=n,typeof n=="function")kf(n)?(g=ol(n,g),r.tag=1,r=Yp(null,r,n,g,c)):(r.tag=0,r=w1(null,r,n,g,c));else{if(n!=null){var w=n.$$typeof;if(w===be){r.tag=11,r=Fp(null,r,n,g,c);break e}else if(w===P){r.tag=14,r=Up(null,r,n,g,c);break e}}throw r=Ye(n)||n,Error(a(306,r,""))}}return r;case 0:return w1(n,r,r.type,r.pendingProps,c);case 1:return g=r.type,w=ol(g,r.pendingProps),Yp(n,r,g,w,c);case 3:e:{if(Pe(r,r.stateNode.containerInfo),n===null)throw Error(a(387));g=r.pendingProps;var _=r.memoizedState;w=_.element,Yf(n,r),Hc(r,g,null,c);var D=r.memoizedState;if(g=D.cache,to(r,Ns,g),g!==_.cache&&Uf(r,[Ns],c,!0),zc(),g=D.element,_.isDehydrated)if(_={element:g,isDehydrated:!1,cache:D.cache},r.updateQueue.baseState=_,r.memoizedState=_,r.flags&256){r=Xp(n,r,g,c);break e}else if(g!==w){w=ur(Error(a(424)),r),Lc(w),r=Xp(n,r,g,c);break e}else for(n=r.stateNode.containerInfo,n.nodeType===9?n=n.body:n=n.nodeName==="HTML"?n.ownerDocument.body:n,Kn=gr(n.firstChild),Js=r,gn=!0,Ja=null,fr=!0,c=Hg(r,null,g,c),r.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling;else{if(Jo(),g===w){r=xa(n,r,c);break e}ti(n,r,g,c)}r=r.child}return r;case 26:return Dh(n,r),n===null?(c=cy(r.type,null,r.pendingProps,null))?r.memoizedState=c:gn||(c=r.type,n=r.pendingProps,g=Xh(ie.current).createElement(c),g[yt]=r,g[bt]=n,ni(g,c,n),Jn(g),r.stateNode=g):r.memoizedState=cy(r.type,n.memoizedProps,r.pendingProps,n.memoizedState),null;case 27:return dt(r),n===null&&gn&&(g=r.stateNode=ay(r.type,r.pendingProps,ie.current),Js=r,fr=!0,w=Kn,go(r.type)?(a0=w,Kn=gr(g.firstChild)):Kn=w),ti(n,r,r.pendingProps.children,c),Dh(n,r),n===null&&(r.flags|=4194304),r.child;case 5:return n===null&&gn&&((w=g=Kn)&&(g=U_(g,r.type,r.pendingProps,fr),g!==null?(r.stateNode=g,Js=r,Kn=gr(g.firstChild),fr=!1,w=!0):w=!1),w||eo(r)),dt(r),w=r.type,_=r.pendingProps,D=n!==null?n.memoizedProps:null,g=_.children,t0(w,_)?g=null:D!==null&&t0(w,D)&&(r.flags|=32),r.memoizedState!==null&&(w=e1(n,r,n_,null,null,c),cu._currentValue=w),Dh(n,r),ti(n,r,g,c),r.child;case 6:return n===null&&gn&&((n=c=Kn)&&(c=z_(c,r.pendingProps,fr),c!==null?(r.stateNode=c,Js=r,Kn=null,n=!0):n=!1),n||eo(r)),null;case 13:return Kp(n,r,c);case 4:return Pe(r,r.stateNode.containerInfo),g=r.pendingProps,n===null?r.child=rl(r,null,g,c):ti(n,r,g,c),r.child;case 11:return Fp(n,r,r.type,r.pendingProps,c);case 7:return ti(n,r,r.pendingProps,c),r.child;case 8:return ti(n,r,r.pendingProps.children,c),r.child;case 12:return ti(n,r,r.pendingProps.children,c),r.child;case 10:return g=r.pendingProps,to(r,r.type,g.value),ti(n,r,g.children,c),r.child;case 9:return w=r.type._context,g=r.pendingProps.children,tl(r),w=ei(w),g=g(w),r.flags|=1,ti(n,r,g,c),r.child;case 14:return Up(n,r,r.type,r.pendingProps,c);case 15:return zp(n,r,r.type,r.pendingProps,c);case 19:return Zp(n,r,c);case 31:return u_(n,r,c);case 22:return Hp(n,r,c,r.pendingProps);case 24:return tl(r),g=ei(Ns),n===null?(w=Gf(),w===null&&(w=zn,_=zf(),w.pooledCache=_,_.refCount++,_!==null&&(w.pooledCacheLanes|=c),w=_),r.memoizedState={parent:g,cache:w},Wf(r),to(r,Ns,w)):((n.lanes&c)!==0&&(Yf(n,r),Hc(r,null,null,c),zc()),w=n.memoizedState,_=r.memoizedState,w.parent!==g?(w={parent:g,cache:g},r.memoizedState=w,r.lanes===0&&(r.memoizedState=r.updateQueue.baseState=w),to(r,Ns,g)):(g=_.cache,to(r,Ns,g),g!==w.cache&&Uf(r,[Ns],c,!0))),ti(n,r,r.pendingProps.children,c),r.child;case 29:throw r.pendingProps}throw Error(a(156,r.tag))}function va(n){n.flags|=4}function N1(n,r,c,g,w){if((r=(n.mode&32)!==0)&&(r=!1),r){if(n.flags|=16777216,(w&335544128)===w)if(n.stateNode.complete)n.flags|=8192;else if(C2())n.flags|=8192;else throw il=ph,qf}else n.flags&=-16777217}function Jp(n,r){if(r.type!=="stylesheet"||(r.state.loading&4)!==0)n.flags&=-16777217;else if(n.flags|=16777216,!my(r))if(C2())n.flags|=8192;else throw il=ph,qf}function Mh(n,r){r!==null&&(n.flags|=4),n.flags&16384&&(r=n.tag!==22?Yn():536870912,n.lanes|=r,Wl|=r)}function Kc(n,r){if(!gn)switch(n.tailMode){case"hidden":r=n.tail;for(var c=null;r!==null;)r.alternate!==null&&(c=r),r=r.sibling;c===null?n.tail=null:c.sibling=null;break;case"collapsed":c=n.tail;for(var g=null;c!==null;)c.alternate!==null&&(g=c),c=c.sibling;g===null?r||n.tail===null?n.tail=null:n.tail.sibling=null:g.sibling=null}}function Qn(n){var r=n.alternate!==null&&n.alternate.child===n.child,c=0,g=0;if(r)for(var w=n.child;w!==null;)c|=w.lanes|w.childLanes,g|=w.subtreeFlags&65011712,g|=w.flags&65011712,w.return=n,w=w.sibling;else for(w=n.child;w!==null;)c|=w.lanes|w.childLanes,g|=w.subtreeFlags,g|=w.flags,w.return=n,w=w.sibling;return n.subtreeFlags|=g,n.childLanes=c,r}function d_(n,r,c){var g=r.pendingProps;switch(Lf(r),r.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Qn(r),null;case 1:return Qn(r),null;case 3:return c=r.stateNode,g=null,n!==null&&(g=n.memoizedState.cache),r.memoizedState.cache!==g&&(r.flags|=2048),ga(Ns),it(),c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),(n===null||n.child===null)&&(Ml(r)?va(r):n===null||n.memoizedState.isDehydrated&&(r.flags&256)===0||(r.flags|=1024,Bf())),Qn(r),null;case 26:var w=r.type,_=r.memoizedState;return n===null?(va(r),_!==null?(Qn(r),Jp(r,_)):(Qn(r),N1(r,w,null,g,c))):_?_!==n.memoizedState?(va(r),Qn(r),Jp(r,_)):(Qn(r),r.flags&=-16777217):(n=n.memoizedProps,n!==g&&va(r),Qn(r),N1(r,w,n,g,c)),null;case 27:if(Le(r),c=ie.current,w=r.type,n!==null&&r.stateNode!=null)n.memoizedProps!==g&&va(r);else{if(!g){if(r.stateNode===null)throw Error(a(166));return Qn(r),null}n=pe.current,Ml(r)?kg(r):(n=ay(w,g,c),r.stateNode=n,va(r))}return Qn(r),null;case 5:if(Le(r),w=r.type,n!==null&&r.stateNode!=null)n.memoizedProps!==g&&va(r);else{if(!g){if(r.stateNode===null)throw Error(a(166));return Qn(r),null}if(_=pe.current,Ml(r))kg(r);else{var D=Xh(ie.current);switch(_){case 1:_=D.createElementNS("http://www.w3.org/2000/svg",w);break;case 2:_=D.createElementNS("http://www.w3.org/1998/Math/MathML",w);break;default:switch(w){case"svg":_=D.createElementNS("http://www.w3.org/2000/svg",w);break;case"math":_=D.createElementNS("http://www.w3.org/1998/Math/MathML",w);break;case"script":_=D.createElement("div"),_.innerHTML="<script><\/script>",_=_.removeChild(_.firstChild);break;case"select":_=typeof g.is=="string"?D.createElement("select",{is:g.is}):D.createElement("select"),g.multiple?_.multiple=!0:g.size&&(_.size=g.size);break;default:_=typeof g.is=="string"?D.createElement(w,{is:g.is}):D.createElement(w)}}_[yt]=r,_[bt]=g;e:for(D=r.child;D!==null;){if(D.tag===5||D.tag===6)_.appendChild(D.stateNode);else if(D.tag!==4&&D.tag!==27&&D.child!==null){D.child.return=D,D=D.child;continue}if(D===r)break e;for(;D.sibling===null;){if(D.return===null||D.return===r)break e;D=D.return}D.sibling.return=D.return,D=D.sibling}r.stateNode=_;e:switch(ni(_,w,g),w){case"button":case"input":case"select":case"textarea":g=!!g.autoFocus;break e;case"img":g=!0;break e;default:g=!1}g&&va(r)}}return Qn(r),N1(r,r.type,n===null?null:n.memoizedProps,r.pendingProps,c),null;case 6:if(n&&r.stateNode!=null)n.memoizedProps!==g&&va(r);else{if(typeof g!="string"&&r.stateNode===null)throw Error(a(166));if(n=ie.current,Ml(r)){if(n=r.stateNode,c=r.memoizedProps,g=null,w=Js,w!==null)switch(w.tag){case 27:case 5:g=w.memoizedProps}n[yt]=r,n=!!(n.nodeValue===c||g!==null&&g.suppressHydrationWarning===!0||K2(n.nodeValue,c)),n||eo(r,!0)}else n=Xh(n).createTextNode(g),n[yt]=r,r.stateNode=n}return Qn(r),null;case 31:if(c=r.memoizedState,n===null||n.memoizedState!==null){if(g=Ml(r),c!==null){if(n===null){if(!g)throw Error(a(318));if(n=r.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(a(557));n[yt]=r}else Jo(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;Qn(r),n=!1}else c=Bf(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=c),n=!0;if(!n)return r.flags&256?(Xi(r),r):(Xi(r),null);if((r.flags&128)!==0)throw Error(a(558))}return Qn(r),null;case 13:if(g=r.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(w=Ml(r),g!==null&&g.dehydrated!==null){if(n===null){if(!w)throw Error(a(318));if(w=r.memoizedState,w=w!==null?w.dehydrated:null,!w)throw Error(a(317));w[yt]=r}else Jo(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;Qn(r),w=!1}else w=Bf(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=w),w=!0;if(!w)return r.flags&256?(Xi(r),r):(Xi(r),null)}return Xi(r),(r.flags&128)!==0?(r.lanes=c,r):(c=g!==null,n=n!==null&&n.memoizedState!==null,c&&(g=r.child,w=null,g.alternate!==null&&g.alternate.memoizedState!==null&&g.alternate.memoizedState.cachePool!==null&&(w=g.alternate.memoizedState.cachePool.pool),_=null,g.memoizedState!==null&&g.memoizedState.cachePool!==null&&(_=g.memoizedState.cachePool.pool),_!==w&&(g.flags|=2048)),c!==n&&c&&(r.child.flags|=8192),Mh(r,r.updateQueue),Qn(r),null);case 4:return it(),n===null&&Q1(r.stateNode.containerInfo),Qn(r),null;case 10:return ga(r.type),Qn(r),null;case 19:if(oe(bs),g=r.memoizedState,g===null)return Qn(r),null;if(w=(r.flags&128)!==0,_=g.rendering,_===null)if(w)Kc(g,!1);else{if(ps!==0||n!==null&&(n.flags&128)!==0)for(n=r.child;n!==null;){if(_=wh(n),_!==null){for(r.flags|=128,Kc(g,!1),n=_.updateQueue,r.updateQueue=n,Mh(r,n),r.subtreeFlags=0,n=c,c=r.child;c!==null;)Sg(c,n),c=c.sibling;return ce(bs,bs.current&1|2),gn&&fa(r,g.treeForkCount),r.child}n=n.sibling}g.tail!==null&&ot()>Bh&&(r.flags|=128,w=!0,Kc(g,!1),r.lanes=4194304)}else{if(!w)if(n=wh(_),n!==null){if(r.flags|=128,w=!0,n=n.updateQueue,r.updateQueue=n,Mh(r,n),Kc(g,!0),g.tail===null&&g.tailMode==="hidden"&&!_.alternate&&!gn)return Qn(r),null}else 2*ot()-g.renderingStartTime>Bh&&c!==536870912&&(r.flags|=128,w=!0,Kc(g,!1),r.lanes=4194304);g.isBackwards?(_.sibling=r.child,r.child=_):(n=g.last,n!==null?n.sibling=_:r.child=_,g.last=_)}return g.tail!==null?(n=g.tail,g.rendering=n,g.tail=n.sibling,g.renderingStartTime=ot(),n.sibling=null,c=bs.current,ce(bs,w?c&1|2:c&1),gn&&fa(r,g.treeForkCount),n):(Qn(r),null);case 22:case 23:return Xi(r),Zf(),g=r.memoizedState!==null,n!==null?n.memoizedState!==null!==g&&(r.flags|=8192):g&&(r.flags|=8192),g?(c&536870912)!==0&&(r.flags&128)===0&&(Qn(r),r.subtreeFlags&6&&(r.flags|=8192)):Qn(r),c=r.updateQueue,c!==null&&Mh(r,c.retryQueue),c=null,n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(c=n.memoizedState.cachePool.pool),g=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(g=r.memoizedState.cachePool.pool),g!==c&&(r.flags|=2048),n!==null&&oe(nl),null;case 24:return c=null,n!==null&&(c=n.memoizedState.cache),r.memoizedState.cache!==c&&(r.flags|=2048),ga(Ns),Qn(r),null;case 25:return null;case 30:return null}throw Error(a(156,r.tag))}function f_(n,r){switch(Lf(r),r.tag){case 1:return n=r.flags,n&65536?(r.flags=n&-65537|128,r):null;case 3:return ga(Ns),it(),n=r.flags,(n&65536)!==0&&(n&128)===0?(r.flags=n&-65537|128,r):null;case 26:case 27:case 5:return Le(r),null;case 31:if(r.memoizedState!==null){if(Xi(r),r.alternate===null)throw Error(a(340));Jo()}return n=r.flags,n&65536?(r.flags=n&-65537|128,r):null;case 13:if(Xi(r),n=r.memoizedState,n!==null&&n.dehydrated!==null){if(r.alternate===null)throw Error(a(340));Jo()}return n=r.flags,n&65536?(r.flags=n&-65537|128,r):null;case 19:return oe(bs),null;case 4:return it(),null;case 10:return ga(r.type),null;case 22:case 23:return Xi(r),Zf(),n!==null&&oe(nl),n=r.flags,n&65536?(r.flags=n&-65537|128,r):null;case 24:return ga(Ns),null;case 25:return null;default:return null}}function e2(n,r){switch(Lf(r),r.tag){case 3:ga(Ns),it();break;case 26:case 27:case 5:Le(r);break;case 4:it();break;case 31:r.memoizedState!==null&&Xi(r);break;case 13:Xi(r);break;case 19:oe(bs);break;case 10:ga(r.type);break;case 22:case 23:Xi(r),Zf(),n!==null&&oe(nl);break;case 24:ga(Ns)}}function Qc(n,r){try{var c=r.updateQueue,g=c!==null?c.lastEffect:null;if(g!==null){var w=g.next;c=w;do{if((c.tag&n)===n){g=void 0;var _=c.create,D=c.inst;g=_(),D.destroy=g}c=c.next}while(c!==w)}}catch(U){On(r,r.return,U)}}function oo(n,r,c){try{var g=r.updateQueue,w=g!==null?g.lastEffect:null;if(w!==null){var _=w.next;g=_;do{if((g.tag&n)===n){var D=g.inst,U=D.destroy;if(U!==void 0){D.destroy=void 0,w=r;var re=c,Ae=U;try{Ae()}catch(Be){On(w,re,Be)}}}g=g.next}while(g!==_)}}catch(Be){On(r,r.return,Be)}}function t2(n){var r=n.updateQueue;if(r!==null){var c=n.stateNode;try{qg(r,c)}catch(g){On(n,n.return,g)}}}function n2(n,r,c){c.props=ol(n.type,n.memoizedProps),c.state=n.memoizedState;try{c.componentWillUnmount()}catch(g){On(n,r,g)}}function Zc(n,r){try{var c=n.ref;if(c!==null){switch(n.tag){case 26:case 27:case 5:var g=n.stateNode;break;case 30:g=n.stateNode;break;default:g=n.stateNode}typeof c=="function"?n.refCleanup=c(g):c.current=g}}catch(w){On(n,r,w)}}function qr(n,r){var c=n.ref,g=n.refCleanup;if(c!==null)if(typeof g=="function")try{g()}catch(w){On(n,r,w)}finally{n.refCleanup=null,n=n.alternate,n!=null&&(n.refCleanup=null)}else if(typeof c=="function")try{c(null)}catch(w){On(n,r,w)}else c.current=null}function s2(n){var r=n.type,c=n.memoizedProps,g=n.stateNode;try{e:switch(r){case"button":case"input":case"select":case"textarea":c.autoFocus&&g.focus();break e;case"img":c.src?g.src=c.src:c.srcSet&&(g.srcset=c.srcSet)}}catch(w){On(n,n.return,w)}}function I1(n,r,c){try{var g=n.stateNode;j_(g,n.type,c,r),g[bt]=r}catch(w){On(n,n.return,w)}}function i2(n){return n.tag===5||n.tag===3||n.tag===26||n.tag===27&&go(n.type)||n.tag===4}function R1(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||i2(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.tag===27&&go(n.type)||n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function D1(n,r,c){var g=n.tag;if(g===5||g===6)n=n.stateNode,r?(c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c).insertBefore(n,r):(r=c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c,r.appendChild(n),c=c._reactRootContainer,c!=null||r.onclick!==null||(r.onclick=ci));else if(g!==4&&(g===27&&go(n.type)&&(c=n.stateNode,r=null),n=n.child,n!==null))for(D1(n,r,c),n=n.sibling;n!==null;)D1(n,r,c),n=n.sibling}function Oh(n,r,c){var g=n.tag;if(g===5||g===6)n=n.stateNode,r?c.insertBefore(n,r):c.appendChild(n);else if(g!==4&&(g===27&&go(n.type)&&(c=n.stateNode),n=n.child,n!==null))for(Oh(n,r,c),n=n.sibling;n!==null;)Oh(n,r,c),n=n.sibling}function r2(n){var r=n.stateNode,c=n.memoizedProps;try{for(var g=n.type,w=r.attributes;w.length;)r.removeAttributeNode(w[0]);ni(r,g,c),r[yt]=n,r[bt]=c}catch(_){On(n,n.return,_)}}var wa=!1,Ds=!1,k1=!1,a2=typeof WeakSet=="function"?WeakSet:Set,Ws=null;function m_(n,r){if(n=n.containerInfo,J1=td,n=O(n),V(n)){if("selectionStart"in n)var c={start:n.selectionStart,end:n.selectionEnd};else e:{c=(c=n.ownerDocument)&&c.defaultView||window;var g=c.getSelection&&c.getSelection();if(g&&g.rangeCount!==0){c=g.anchorNode;var w=g.anchorOffset,_=g.focusNode;g=g.focusOffset;try{c.nodeType,_.nodeType}catch{c=null;break e}var D=0,U=-1,re=-1,Ae=0,Be=0,ze=n,Se=null;t:for(;;){for(var je;ze!==c||w!==0&&ze.nodeType!==3||(U=D+w),ze!==_||g!==0&&ze.nodeType!==3||(re=D+g),ze.nodeType===3&&(D+=ze.nodeValue.length),(je=ze.firstChild)!==null;)Se=ze,ze=je;for(;;){if(ze===n)break t;if(Se===c&&++Ae===w&&(U=D),Se===_&&++Be===g&&(re=D),(je=ze.nextSibling)!==null)break;ze=Se,Se=ze.parentNode}ze=je}c=U===-1||re===-1?null:{start:U,end:re}}else c=null}c=c||{start:0,end:0}}else c=null;for(e0={focusedElem:n,selectionRange:c},td=!1,Ws=r;Ws!==null;)if(r=Ws,n=r.child,(r.subtreeFlags&1028)!==0&&n!==null)n.return=r,Ws=n;else for(;Ws!==null;){switch(r=Ws,_=r.alternate,n=r.flags,r.tag){case 0:if((n&4)!==0&&(n=r.updateQueue,n=n!==null?n.events:null,n!==null))for(c=0;c<n.length;c++)w=n[c],w.ref.impl=w.nextImpl;break;case 11:case 15:break;case 1:if((n&1024)!==0&&_!==null){n=void 0,c=r,w=_.memoizedProps,_=_.memoizedState,g=c.stateNode;try{var ht=ol(c.type,w);n=g.getSnapshotBeforeUpdate(ht,_),g.__reactInternalSnapshotBeforeUpdate=n}catch(Nt){On(c,c.return,Nt)}}break;case 3:if((n&1024)!==0){if(n=r.stateNode.containerInfo,c=n.nodeType,c===9)s0(n);else if(c===1)switch(n.nodeName){case"HEAD":case"HTML":case"BODY":s0(n);break;default:n.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((n&1024)!==0)throw Error(a(163))}if(n=r.sibling,n!==null){n.return=r.return,Ws=n;break}Ws=r.return}}function o2(n,r,c){var g=c.flags;switch(c.tag){case 0:case 11:case 15:Ea(n,c),g&4&&Qc(5,c);break;case 1:if(Ea(n,c),g&4)if(n=c.stateNode,r===null)try{n.componentDidMount()}catch(D){On(c,c.return,D)}else{var w=ol(c.type,r.memoizedProps);r=r.memoizedState;try{n.componentDidUpdate(w,r,n.__reactInternalSnapshotBeforeUpdate)}catch(D){On(c,c.return,D)}}g&64&&t2(c),g&512&&Zc(c,c.return);break;case 3:if(Ea(n,c),g&64&&(n=c.updateQueue,n!==null)){if(r=null,c.child!==null)switch(c.child.tag){case 27:case 5:r=c.child.stateNode;break;case 1:r=c.child.stateNode}try{qg(n,r)}catch(D){On(c,c.return,D)}}break;case 27:r===null&&g&4&&r2(c);case 26:case 5:Ea(n,c),r===null&&g&4&&s2(c),g&512&&Zc(c,c.return);break;case 12:Ea(n,c);break;case 31:Ea(n,c),g&4&&u2(n,c);break;case 13:Ea(n,c),g&4&&h2(n,c),g&64&&(n=c.memoizedState,n!==null&&(n=n.dehydrated,n!==null&&(c=__.bind(null,c),H_(n,c))));break;case 22:if(g=c.memoizedState!==null||wa,!g){r=r!==null&&r.memoizedState!==null||Ds,w=wa;var _=Ds;wa=g,(Ds=r)&&!_?_a(n,c,(c.subtreeFlags&8772)!==0):Ea(n,c),wa=w,Ds=_}break;case 30:break;default:Ea(n,c)}}function l2(n){var r=n.alternate;r!==null&&(n.alternate=null,l2(r)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(r=n.stateNode,r!==null&&Ts(r)),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}var is=null,ki=!1;function ba(n,r,c){for(c=c.child;c!==null;)c2(n,r,c),c=c.sibling}function c2(n,r,c){if(We&&typeof We.onCommitFiberUnmount=="function")try{We.onCommitFiberUnmount(Qt,c)}catch{}switch(c.tag){case 26:Ds||qr(c,r),ba(n,r,c),c.memoizedState?c.memoizedState.count--:c.stateNode&&(c=c.stateNode,c.parentNode.removeChild(c));break;case 27:Ds||qr(c,r);var g=is,w=ki;go(c.type)&&(is=c.stateNode,ki=!1),ba(n,r,c),au(c.stateNode),is=g,ki=w;break;case 5:Ds||qr(c,r);case 6:if(g=is,w=ki,is=null,ba(n,r,c),is=g,ki=w,is!==null)if(ki)try{(is.nodeType===9?is.body:is.nodeName==="HTML"?is.ownerDocument.body:is).removeChild(c.stateNode)}catch(_){On(c,r,_)}else try{is.removeChild(c.stateNode)}catch(_){On(c,r,_)}break;case 18:is!==null&&(ki?(n=is,ty(n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n,c.stateNode),ec(n)):ty(is,c.stateNode));break;case 4:g=is,w=ki,is=c.stateNode.containerInfo,ki=!0,ba(n,r,c),is=g,ki=w;break;case 0:case 11:case 14:case 15:oo(2,c,r),Ds||oo(4,c,r),ba(n,r,c);break;case 1:Ds||(qr(c,r),g=c.stateNode,typeof g.componentWillUnmount=="function"&&n2(c,r,g)),ba(n,r,c);break;case 21:ba(n,r,c);break;case 22:Ds=(g=Ds)||c.memoizedState!==null,ba(n,r,c),Ds=g;break;default:ba(n,r,c)}}function u2(n,r){if(r.memoizedState===null&&(n=r.alternate,n!==null&&(n=n.memoizedState,n!==null))){n=n.dehydrated;try{ec(n)}catch(c){On(r,r.return,c)}}}function h2(n,r){if(r.memoizedState===null&&(n=r.alternate,n!==null&&(n=n.memoizedState,n!==null&&(n=n.dehydrated,n!==null))))try{ec(n)}catch(c){On(r,r.return,c)}}function g_(n){switch(n.tag){case 31:case 13:case 19:var r=n.stateNode;return r===null&&(r=n.stateNode=new a2),r;case 22:return n=n.stateNode,r=n._retryCache,r===null&&(r=n._retryCache=new a2),r;default:throw Error(a(435,n.tag))}}function jh(n,r){var c=g_(n);r.forEach(function(g){if(!c.has(g)){c.add(g);var w=A_.bind(null,n,g);g.then(w,w)}})}function Mi(n,r){var c=r.deletions;if(c!==null)for(var g=0;g<c.length;g++){var w=c[g],_=n,D=r,U=D;e:for(;U!==null;){switch(U.tag){case 27:if(go(U.type)){is=U.stateNode,ki=!1;break e}break;case 5:is=U.stateNode,ki=!1;break e;case 3:case 4:is=U.stateNode.containerInfo,ki=!0;break e}U=U.return}if(is===null)throw Error(a(160));c2(_,D,w),is=null,ki=!1,_=w.alternate,_!==null&&(_.return=null),w.return=null}if(r.subtreeFlags&13886)for(r=r.child;r!==null;)d2(r,n),r=r.sibling}var Tr=null;function d2(n,r){var c=n.alternate,g=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:Mi(r,n),Oi(n),g&4&&(oo(3,n,n.return),Qc(3,n),oo(5,n,n.return));break;case 1:Mi(r,n),Oi(n),g&512&&(Ds||c===null||qr(c,c.return)),g&64&&wa&&(n=n.updateQueue,n!==null&&(g=n.callbacks,g!==null&&(c=n.shared.hiddenCallbacks,n.shared.hiddenCallbacks=c===null?g:c.concat(g))));break;case 26:var w=Tr;if(Mi(r,n),Oi(n),g&512&&(Ds||c===null||qr(c,c.return)),g&4){var _=c!==null?c.memoizedState:null;if(g=n.memoizedState,c===null)if(g===null)if(n.stateNode===null){e:{g=n.type,c=n.memoizedProps,w=w.ownerDocument||w;t:switch(g){case"title":_=w.getElementsByTagName("title")[0],(!_||_[Ti]||_[yt]||_.namespaceURI==="http://www.w3.org/2000/svg"||_.hasAttribute("itemprop"))&&(_=w.createElement(g),w.head.insertBefore(_,w.querySelector("head > title"))),ni(_,g,c),_[yt]=n,Jn(_),g=_;break e;case"link":var D=dy("link","href",w).get(g+(c.href||""));if(D){for(var U=0;U<D.length;U++)if(_=D[U],_.getAttribute("href")===(c.href==null||c.href===""?null:c.href)&&_.getAttribute("rel")===(c.rel==null?null:c.rel)&&_.getAttribute("title")===(c.title==null?null:c.title)&&_.getAttribute("crossorigin")===(c.crossOrigin==null?null:c.crossOrigin)){D.splice(U,1);break t}}_=w.createElement(g),ni(_,g,c),w.head.appendChild(_);break;case"meta":if(D=dy("meta","content",w).get(g+(c.content||""))){for(U=0;U<D.length;U++)if(_=D[U],_.getAttribute("content")===(c.content==null?null:""+c.content)&&_.getAttribute("name")===(c.name==null?null:c.name)&&_.getAttribute("property")===(c.property==null?null:c.property)&&_.getAttribute("http-equiv")===(c.httpEquiv==null?null:c.httpEquiv)&&_.getAttribute("charset")===(c.charSet==null?null:c.charSet)){D.splice(U,1);break t}}_=w.createElement(g),ni(_,g,c),w.head.appendChild(_);break;default:throw Error(a(468,g))}_[yt]=n,Jn(_),g=_}n.stateNode=g}else fy(w,n.type,n.stateNode);else n.stateNode=hy(w,g,n.memoizedProps);else _!==g?(_===null?c.stateNode!==null&&(c=c.stateNode,c.parentNode.removeChild(c)):_.count--,g===null?fy(w,n.type,n.stateNode):hy(w,g,n.memoizedProps)):g===null&&n.stateNode!==null&&I1(n,n.memoizedProps,c.memoizedProps)}break;case 27:Mi(r,n),Oi(n),g&512&&(Ds||c===null||qr(c,c.return)),c!==null&&g&4&&I1(n,n.memoizedProps,c.memoizedProps);break;case 5:if(Mi(r,n),Oi(n),g&512&&(Ds||c===null||qr(c,c.return)),n.flags&32){w=n.stateNode;try{li(w,"")}catch(ht){On(n,n.return,ht)}}g&4&&n.stateNode!=null&&(w=n.memoizedProps,I1(n,w,c!==null?c.memoizedProps:w)),g&1024&&(k1=!0);break;case 6:if(Mi(r,n),Oi(n),g&4){if(n.stateNode===null)throw Error(a(162));g=n.memoizedProps,c=n.stateNode;try{c.nodeValue=g}catch(ht){On(n,n.return,ht)}}break;case 3:if(Zh=null,w=Tr,Tr=Kh(r.containerInfo),Mi(r,n),Tr=w,Oi(n),g&4&&c!==null&&c.memoizedState.isDehydrated)try{ec(r.containerInfo)}catch(ht){On(n,n.return,ht)}k1&&(k1=!1,f2(n));break;case 4:g=Tr,Tr=Kh(n.stateNode.containerInfo),Mi(r,n),Oi(n),Tr=g;break;case 12:Mi(r,n),Oi(n);break;case 31:Mi(r,n),Oi(n),g&4&&(g=n.updateQueue,g!==null&&(n.updateQueue=null,jh(n,g)));break;case 13:Mi(r,n),Oi(n),n.child.flags&8192&&n.memoizedState!==null!=(c!==null&&c.memoizedState!==null)&&(Ph=ot()),g&4&&(g=n.updateQueue,g!==null&&(n.updateQueue=null,jh(n,g)));break;case 22:w=n.memoizedState!==null;var re=c!==null&&c.memoizedState!==null,Ae=wa,Be=Ds;if(wa=Ae||w,Ds=Be||re,Mi(r,n),Ds=Be,wa=Ae,Oi(n),g&8192)e:for(r=n.stateNode,r._visibility=w?r._visibility&-2:r._visibility|1,w&&(c===null||re||wa||Ds||ll(n)),c=null,r=n;;){if(r.tag===5||r.tag===26){if(c===null){re=c=r;try{if(_=re.stateNode,w)D=_.style,typeof D.setProperty=="function"?D.setProperty("display","none","important"):D.display="none";else{U=re.stateNode;var ze=re.memoizedProps.style,Se=ze!=null&&ze.hasOwnProperty("display")?ze.display:null;U.style.display=Se==null||typeof Se=="boolean"?"":(""+Se).trim()}}catch(ht){On(re,re.return,ht)}}}else if(r.tag===6){if(c===null){re=r;try{re.stateNode.nodeValue=w?"":re.memoizedProps}catch(ht){On(re,re.return,ht)}}}else if(r.tag===18){if(c===null){re=r;try{var je=re.stateNode;w?ny(je,!0):ny(re.stateNode,!1)}catch(ht){On(re,re.return,ht)}}}else if((r.tag!==22&&r.tag!==23||r.memoizedState===null||r===n)&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===n)break e;for(;r.sibling===null;){if(r.return===null||r.return===n)break e;c===r&&(c=null),r=r.return}c===r&&(c=null),r.sibling.return=r.return,r=r.sibling}g&4&&(g=n.updateQueue,g!==null&&(c=g.retryQueue,c!==null&&(g.retryQueue=null,jh(n,c))));break;case 19:Mi(r,n),Oi(n),g&4&&(g=n.updateQueue,g!==null&&(n.updateQueue=null,jh(n,g)));break;case 30:break;case 21:break;default:Mi(r,n),Oi(n)}}function Oi(n){var r=n.flags;if(r&2){try{for(var c,g=n.return;g!==null;){if(i2(g)){c=g;break}g=g.return}if(c==null)throw Error(a(160));switch(c.tag){case 27:var w=c.stateNode,_=R1(n);Oh(n,_,w);break;case 5:var D=c.stateNode;c.flags&32&&(li(D,""),c.flags&=-33);var U=R1(n);Oh(n,U,D);break;case 3:case 4:var re=c.stateNode.containerInfo,Ae=R1(n);D1(n,Ae,re);break;default:throw Error(a(161))}}catch(Be){On(n,n.return,Be)}n.flags&=-3}r&4096&&(n.flags&=-4097)}function f2(n){if(n.subtreeFlags&1024)for(n=n.child;n!==null;){var r=n;f2(r),r.tag===5&&r.flags&1024&&r.stateNode.reset(),n=n.sibling}}function Ea(n,r){if(r.subtreeFlags&8772)for(r=r.child;r!==null;)o2(n,r.alternate,r),r=r.sibling}function ll(n){for(n=n.child;n!==null;){var r=n;switch(r.tag){case 0:case 11:case 14:case 15:oo(4,r,r.return),ll(r);break;case 1:qr(r,r.return);var c=r.stateNode;typeof c.componentWillUnmount=="function"&&n2(r,r.return,c),ll(r);break;case 27:au(r.stateNode);case 26:case 5:qr(r,r.return),ll(r);break;case 22:r.memoizedState===null&&ll(r);break;case 30:ll(r);break;default:ll(r)}n=n.sibling}}function _a(n,r,c){for(c=c&&(r.subtreeFlags&8772)!==0,r=r.child;r!==null;){var g=r.alternate,w=n,_=r,D=_.flags;switch(_.tag){case 0:case 11:case 15:_a(w,_,c),Qc(4,_);break;case 1:if(_a(w,_,c),g=_,w=g.stateNode,typeof w.componentDidMount=="function")try{w.componentDidMount()}catch(Ae){On(g,g.return,Ae)}if(g=_,w=g.updateQueue,w!==null){var U=g.stateNode;try{var re=w.shared.hiddenCallbacks;if(re!==null)for(w.shared.hiddenCallbacks=null,w=0;w<re.length;w++)Gg(re[w],U)}catch(Ae){On(g,g.return,Ae)}}c&&D&64&&t2(_),Zc(_,_.return);break;case 27:r2(_);case 26:case 5:_a(w,_,c),c&&g===null&&D&4&&s2(_),Zc(_,_.return);break;case 12:_a(w,_,c);break;case 31:_a(w,_,c),c&&D&4&&u2(w,_);break;case 13:_a(w,_,c),c&&D&4&&h2(w,_);break;case 22:_.memoizedState===null&&_a(w,_,c),Zc(_,_.return);break;case 30:break;default:_a(w,_,c)}r=r.sibling}}function M1(n,r){var c=null;n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(c=n.memoizedState.cachePool.pool),n=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(n=r.memoizedState.cachePool.pool),n!==c&&(n!=null&&n.refCount++,c!=null&&Pc(c))}function O1(n,r){n=null,r.alternate!==null&&(n=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==n&&(r.refCount++,n!=null&&Pc(n))}function Sr(n,r,c,g){if(r.subtreeFlags&10256)for(r=r.child;r!==null;)m2(n,r,c,g),r=r.sibling}function m2(n,r,c,g){var w=r.flags;switch(r.tag){case 0:case 11:case 15:Sr(n,r,c,g),w&2048&&Qc(9,r);break;case 1:Sr(n,r,c,g);break;case 3:Sr(n,r,c,g),w&2048&&(n=null,r.alternate!==null&&(n=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==n&&(r.refCount++,n!=null&&Pc(n)));break;case 12:if(w&2048){Sr(n,r,c,g),n=r.stateNode;try{var _=r.memoizedProps,D=_.id,U=_.onPostCommit;typeof U=="function"&&U(D,r.alternate===null?"mount":"update",n.passiveEffectDuration,-0)}catch(re){On(r,r.return,re)}}else Sr(n,r,c,g);break;case 31:Sr(n,r,c,g);break;case 13:Sr(n,r,c,g);break;case 23:break;case 22:_=r.stateNode,D=r.alternate,r.memoizedState!==null?_._visibility&2?Sr(n,r,c,g):$c(n,r):_._visibility&2?Sr(n,r,c,g):(_._visibility|=2,Hl(n,r,c,g,(r.subtreeFlags&10256)!==0||!1)),w&2048&&M1(D,r);break;case 24:Sr(n,r,c,g),w&2048&&O1(r.alternate,r);break;default:Sr(n,r,c,g)}}function Hl(n,r,c,g,w){for(w=w&&((r.subtreeFlags&10256)!==0||!1),r=r.child;r!==null;){var _=n,D=r,U=c,re=g,Ae=D.flags;switch(D.tag){case 0:case 11:case 15:Hl(_,D,U,re,w),Qc(8,D);break;case 23:break;case 22:var Be=D.stateNode;D.memoizedState!==null?Be._visibility&2?Hl(_,D,U,re,w):$c(_,D):(Be._visibility|=2,Hl(_,D,U,re,w)),w&&Ae&2048&&M1(D.alternate,D);break;case 24:Hl(_,D,U,re,w),w&&Ae&2048&&O1(D.alternate,D);break;default:Hl(_,D,U,re,w)}r=r.sibling}}function $c(n,r){if(r.subtreeFlags&10256)for(r=r.child;r!==null;){var c=n,g=r,w=g.flags;switch(g.tag){case 22:$c(c,g),w&2048&&M1(g.alternate,g);break;case 24:$c(c,g),w&2048&&O1(g.alternate,g);break;default:$c(c,g)}r=r.sibling}}var Jc=8192;function Gl(n,r,c){if(n.subtreeFlags&Jc)for(n=n.child;n!==null;)g2(n,r,c),n=n.sibling}function g2(n,r,c){switch(n.tag){case 26:Gl(n,r,c),n.flags&Jc&&n.memoizedState!==null&&tA(c,Tr,n.memoizedState,n.memoizedProps);break;case 5:Gl(n,r,c);break;case 3:case 4:var g=Tr;Tr=Kh(n.stateNode.containerInfo),Gl(n,r,c),Tr=g;break;case 22:n.memoizedState===null&&(g=n.alternate,g!==null&&g.memoizedState!==null?(g=Jc,Jc=16777216,Gl(n,r,c),Jc=g):Gl(n,r,c));break;default:Gl(n,r,c)}}function p2(n){var r=n.alternate;if(r!==null&&(n=r.child,n!==null)){r.child=null;do r=n.sibling,n.sibling=null,n=r;while(n!==null)}}function eu(n){var r=n.deletions;if((n.flags&16)!==0){if(r!==null)for(var c=0;c<r.length;c++){var g=r[c];Ws=g,x2(g,n)}p2(n)}if(n.subtreeFlags&10256)for(n=n.child;n!==null;)y2(n),n=n.sibling}function y2(n){switch(n.tag){case 0:case 11:case 15:eu(n),n.flags&2048&&oo(9,n,n.return);break;case 3:eu(n);break;case 12:eu(n);break;case 22:var r=n.stateNode;n.memoizedState!==null&&r._visibility&2&&(n.return===null||n.return.tag!==13)?(r._visibility&=-3,Lh(n)):eu(n);break;default:eu(n)}}function Lh(n){var r=n.deletions;if((n.flags&16)!==0){if(r!==null)for(var c=0;c<r.length;c++){var g=r[c];Ws=g,x2(g,n)}p2(n)}for(n=n.child;n!==null;){switch(r=n,r.tag){case 0:case 11:case 15:oo(8,r,r.return),Lh(r);break;case 22:c=r.stateNode,c._visibility&2&&(c._visibility&=-3,Lh(r));break;default:Lh(r)}n=n.sibling}}function x2(n,r){for(;Ws!==null;){var c=Ws;switch(c.tag){case 0:case 11:case 15:oo(8,c,r);break;case 23:case 22:if(c.memoizedState!==null&&c.memoizedState.cachePool!==null){var g=c.memoizedState.cachePool.pool;g!=null&&g.refCount++}break;case 24:Pc(c.memoizedState.cache)}if(g=c.child,g!==null)g.return=c,Ws=g;else e:for(c=n;Ws!==null;){g=Ws;var w=g.sibling,_=g.return;if(l2(g),g===c){Ws=null;break e}if(w!==null){w.return=_,Ws=w;break e}Ws=_}}}var p_={getCacheForType:function(n){var r=ei(Ns),c=r.data.get(n);return c===void 0&&(c=n(),r.data.set(n,c)),c},cacheSignal:function(){return ei(Ns).controller.signal}},y_=typeof WeakMap=="function"?WeakMap:Map,Sn=0,zn=null,sn=null,ln=0,Mn=0,Ki=null,lo=!1,ql=!1,j1=!1,Aa=0,ps=0,co=0,cl=0,L1=0,Qi=0,Wl=0,tu=null,ji=null,P1=!1,Ph=0,v2=0,Bh=1/0,Vh=null,uo=null,Fs=0,ho=null,Yl=null,Ca=0,B1=0,V1=null,w2=null,nu=0,F1=null;function Zi(){return(Sn&2)!==0&&ln!==0?ln&-ln:te.T!==null?W1():Ke()}function b2(){if(Qi===0)if((ln&536870912)===0||gn){var n=It;It<<=1,(It&3932160)===0&&(It=262144),Qi=n}else Qi=536870912;return n=Yi.current,n!==null&&(n.flags|=32),Qi}function Li(n,r,c){(n===zn&&(Mn===2||Mn===9)||n.cancelPendingCommit!==null)&&(Xl(n,0),fo(n,ln,Qi,!1)),fs(n,c),((Sn&2)===0||n!==zn)&&(n===zn&&((Sn&2)===0&&(cl|=c),ps===4&&fo(n,ln,Qi,!1)),Wr(n))}function E2(n,r,c){if((Sn&6)!==0)throw Error(a(327));var g=!c&&(r&127)===0&&(r&n.expiredLanes)===0||Tn(n,r),w=g?w_(n,r):z1(n,r,!0),_=g;do{if(w===0){ql&&!g&&fo(n,r,0,!1);break}else{if(c=n.current.alternate,_&&!x_(c)){w=z1(n,r,!1),_=!1;continue}if(w===2){if(_=r,n.errorRecoveryDisabledLanes&_)var D=0;else D=n.pendingLanes&-536870913,D=D!==0?D:D&536870912?536870912:0;if(D!==0){r=D;e:{var U=n;w=tu;var re=U.current.memoizedState.isDehydrated;if(re&&(Xl(U,D).flags|=256),D=z1(U,D,!1),D!==2){if(j1&&!re){U.errorRecoveryDisabledLanes|=_,cl|=_,w=4;break e}_=ji,ji=w,_!==null&&(ji===null?ji=_:ji.push.apply(ji,_))}w=D}if(_=!1,w!==2)continue}}if(w===1){Xl(n,0),fo(n,r,0,!0);break}e:{switch(g=n,_=w,_){case 0:case 1:throw Error(a(345));case 4:if((r&4194048)!==r)break;case 6:fo(g,r,Qi,!lo);break e;case 2:ji=null;break;case 3:case 5:break;default:throw Error(a(329))}if((r&62914560)===r&&(w=Ph+300-ot(),10<w)){if(fo(g,r,Qi,!lo),Xs(g,0,!0)!==0)break e;Ca=r,g.timeoutHandle=J2(_2.bind(null,g,c,ji,Vh,P1,r,Qi,cl,Wl,lo,_,"Throttled",-0,0),w);break e}_2(g,c,ji,Vh,P1,r,Qi,cl,Wl,lo,_,null,-0,0)}}break}while(!0);Wr(n)}function _2(n,r,c,g,w,_,D,U,re,Ae,Be,ze,Se,je){if(n.timeoutHandle=-1,ze=r.subtreeFlags,ze&8192||(ze&16785408)===16785408){ze={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:ci},g2(r,_,ze);var ht=(_&62914560)===_?Ph-ot():(_&4194048)===_?v2-ot():0;if(ht=nA(ze,ht),ht!==null){Ca=_,n.cancelPendingCommit=ht(D2.bind(null,n,r,_,c,g,w,D,U,re,Be,ze,null,Se,je)),fo(n,_,D,!Ae);return}}D2(n,r,_,c,g,w,D,U,re)}function x_(n){for(var r=n;;){var c=r.tag;if((c===0||c===11||c===15)&&r.flags&16384&&(c=r.updateQueue,c!==null&&(c=c.stores,c!==null)))for(var g=0;g<c.length;g++){var w=c[g],_=w.getSnapshot;w=w.value;try{if(!p(_(),w))return!1}catch{return!1}}if(c=r.child,r.subtreeFlags&16384&&c!==null)c.return=r,r=c;else{if(r===n)break;for(;r.sibling===null;){if(r.return===null||r.return===n)return!0;r=r.return}r.sibling.return=r.return,r=r.sibling}}return!0}function fo(n,r,c,g){r&=~L1,r&=~cl,n.suspendedLanes|=r,n.pingedLanes&=~r,g&&(n.warmLanes|=r),g=n.expirationTimes;for(var w=r;0<w;){var _=31-Ct(w),D=1<<_;g[_]=-1,w&=~D}c!==0&&xe(n,c,r)}function Fh(){return(Sn&6)===0?(su(0),!1):!0}function U1(){if(sn!==null){if(Mn===0)var n=sn.return;else n=sn,ma=el=null,s1(n),Bl=null,Vc=0,n=sn;for(;n!==null;)e2(n.alternate,n),n=n.return;sn=null}}function Xl(n,r){var c=n.timeoutHandle;c!==-1&&(n.timeoutHandle=-1,B_(c)),c=n.cancelPendingCommit,c!==null&&(n.cancelPendingCommit=null,c()),Ca=0,U1(),zn=n,sn=c=da(n.current,null),ln=r,Mn=0,Ki=null,lo=!1,ql=Tn(n,r),j1=!1,Wl=Qi=L1=cl=co=ps=0,ji=tu=null,P1=!1,(r&8)!==0&&(r|=r&32);var g=n.entangledLanes;if(g!==0)for(n=n.entanglements,g&=r;0<g;){var w=31-Ct(g),_=1<<w;r|=n[w],g&=~_}return Aa=r,oh(),c}function A2(n,r){Gt=null,te.H=Yc,r===Pl||r===gh?(r=Fg(),Mn=3):r===qf?(r=Fg(),Mn=4):Mn=r===v1?8:r!==null&&typeof r=="object"&&typeof r.then=="function"?6:1,Ki=r,sn===null&&(ps=1,Ih(n,ur(r,n.current)))}function C2(){var n=Yi.current;return n===null?!0:(ln&4194048)===ln?mr===null:(ln&62914560)===ln||(ln&536870912)!==0?n===mr:!1}function T2(){var n=te.H;return te.H=Yc,n===null?Yc:n}function S2(){var n=te.A;return te.A=p_,n}function Uh(){ps=4,lo||(ln&4194048)!==ln&&Yi.current!==null||(ql=!0),(co&134217727)===0&&(cl&134217727)===0||zn===null||fo(zn,ln,Qi,!1)}function z1(n,r,c){var g=Sn;Sn|=2;var w=T2(),_=S2();(zn!==n||ln!==r)&&(Vh=null,Xl(n,r)),r=!1;var D=ps;e:do try{if(Mn!==0&&sn!==null){var U=sn,re=Ki;switch(Mn){case 8:U1(),D=6;break e;case 3:case 2:case 9:case 6:Yi.current===null&&(r=!0);var Ae=Mn;if(Mn=0,Ki=null,Kl(n,U,re,Ae),c&&ql){D=0;break e}break;default:Ae=Mn,Mn=0,Ki=null,Kl(n,U,re,Ae)}}v_(),D=ps;break}catch(Be){A2(n,Be)}while(!0);return r&&n.shellSuspendCounter++,ma=el=null,Sn=g,te.H=w,te.A=_,sn===null&&(zn=null,ln=0,oh()),D}function v_(){for(;sn!==null;)N2(sn)}function w_(n,r){var c=Sn;Sn|=2;var g=T2(),w=S2();zn!==n||ln!==r?(Vh=null,Bh=ot()+500,Xl(n,r)):ql=Tn(n,r);e:do try{if(Mn!==0&&sn!==null){r=sn;var _=Ki;t:switch(Mn){case 1:Mn=0,Ki=null,Kl(n,r,_,1);break;case 2:case 9:if(Bg(_)){Mn=0,Ki=null,I2(r);break}r=function(){Mn!==2&&Mn!==9||zn!==n||(Mn=7),Wr(n)},_.then(r,r);break e;case 3:Mn=7;break e;case 4:Mn=5;break e;case 7:Bg(_)?(Mn=0,Ki=null,I2(r)):(Mn=0,Ki=null,Kl(n,r,_,7));break;case 5:var D=null;switch(sn.tag){case 26:D=sn.memoizedState;case 5:case 27:var U=sn;if(D?my(D):U.stateNode.complete){Mn=0,Ki=null;var re=U.sibling;if(re!==null)sn=re;else{var Ae=U.return;Ae!==null?(sn=Ae,zh(Ae)):sn=null}break t}}Mn=0,Ki=null,Kl(n,r,_,5);break;case 6:Mn=0,Ki=null,Kl(n,r,_,6);break;case 8:U1(),ps=6;break e;default:throw Error(a(462))}}b_();break}catch(Be){A2(n,Be)}while(!0);return ma=el=null,te.H=g,te.A=w,Sn=c,sn!==null?0:(zn=null,ln=0,oh(),ps)}function b_(){for(;sn!==null&&!et();)N2(sn)}function N2(n){var r=$p(n.alternate,n,Aa);n.memoizedProps=n.pendingProps,r===null?zh(n):sn=r}function I2(n){var r=n,c=r.alternate;switch(r.tag){case 15:case 0:r=Wp(c,r,r.pendingProps,r.type,void 0,ln);break;case 11:r=Wp(c,r,r.pendingProps,r.type.render,r.ref,ln);break;case 5:s1(r);default:e2(c,r),r=sn=Sg(r,Aa),r=$p(c,r,Aa)}n.memoizedProps=n.pendingProps,r===null?zh(n):sn=r}function Kl(n,r,c,g){ma=el=null,s1(r),Bl=null,Vc=0;var w=r.return;try{if(c_(n,w,r,c,ln)){ps=1,Ih(n,ur(c,n.current)),sn=null;return}}catch(_){if(w!==null)throw sn=w,_;ps=1,Ih(n,ur(c,n.current)),sn=null;return}r.flags&32768?(gn||g===1?n=!0:ql||(ln&536870912)!==0?n=!1:(lo=n=!0,(g===2||g===9||g===3||g===6)&&(g=Yi.current,g!==null&&g.tag===13&&(g.flags|=16384))),R2(r,n)):zh(r)}function zh(n){var r=n;do{if((r.flags&32768)!==0){R2(r,lo);return}n=r.return;var c=d_(r.alternate,r,Aa);if(c!==null){sn=c;return}if(r=r.sibling,r!==null){sn=r;return}sn=r=n}while(r!==null);ps===0&&(ps=5)}function R2(n,r){do{var c=f_(n.alternate,n);if(c!==null){c.flags&=32767,sn=c;return}if(c=n.return,c!==null&&(c.flags|=32768,c.subtreeFlags=0,c.deletions=null),!r&&(n=n.sibling,n!==null)){sn=n;return}sn=n=c}while(n!==null);ps=6,sn=null}function D2(n,r,c,g,w,_,D,U,re){n.cancelPendingCommit=null;do Hh();while(Fs!==0);if((Sn&6)!==0)throw Error(a(327));if(r!==null){if(r===n.current)throw Error(a(177));if(_=r.lanes|r.childLanes,_|=Rf,$n(n,c,_,D,U,re),n===zn&&(sn=zn=null,ln=0),Yl=r,ho=n,Ca=c,B1=_,V1=w,w2=g,(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?(n.callbackNode=null,n.callbackPriority=0,C_(Vn,function(){return L2(),null})):(n.callbackNode=null,n.callbackPriority=0),g=(r.flags&13878)!==0,(r.subtreeFlags&13878)!==0||g){g=te.T,te.T=null,w=ge.p,ge.p=2,D=Sn,Sn|=4;try{m_(n,r,c)}finally{Sn=D,ge.p=w,te.T=g}}Fs=1,k2(),M2(),O2()}}function k2(){if(Fs===1){Fs=0;var n=ho,r=Yl,c=(r.flags&13878)!==0;if((r.subtreeFlags&13878)!==0||c){c=te.T,te.T=null;var g=ge.p;ge.p=2;var w=Sn;Sn|=4;try{d2(r,n);var _=e0,D=O(n.containerInfo),U=_.focusedElem,re=_.selectionRange;if(D!==U&&U&&U.ownerDocument&&R(U.ownerDocument.documentElement,U)){if(re!==null&&V(U)){var Ae=re.start,Be=re.end;if(Be===void 0&&(Be=Ae),"selectionStart"in U)U.selectionStart=Ae,U.selectionEnd=Math.min(Be,U.value.length);else{var ze=U.ownerDocument||document,Se=ze&&ze.defaultView||window;if(Se.getSelection){var je=Se.getSelection(),ht=U.textContent.length,Nt=Math.min(re.start,ht),Bn=re.end===void 0?Nt:Math.min(re.end,ht);!je.extend&&Nt>Bn&&(D=Bn,Bn=Nt,Nt=D);var ye=T(U,Nt),fe=T(U,Bn);if(ye&&fe&&(je.rangeCount!==1||je.anchorNode!==ye.node||je.anchorOffset!==ye.offset||je.focusNode!==fe.node||je.focusOffset!==fe.offset)){var _e=ze.createRange();_e.setStart(ye.node,ye.offset),je.removeAllRanges(),Nt>Bn?(je.addRange(_e),je.extend(fe.node,fe.offset)):(_e.setEnd(fe.node,fe.offset),je.addRange(_e))}}}}for(ze=[],je=U;je=je.parentNode;)je.nodeType===1&&ze.push({element:je,left:je.scrollLeft,top:je.scrollTop});for(typeof U.focus=="function"&&U.focus(),U=0;U<ze.length;U++){var Ve=ze[U];Ve.element.scrollLeft=Ve.left,Ve.element.scrollTop=Ve.top}}td=!!J1,e0=J1=null}finally{Sn=w,ge.p=g,te.T=c}}n.current=r,Fs=2}}function M2(){if(Fs===2){Fs=0;var n=ho,r=Yl,c=(r.flags&8772)!==0;if((r.subtreeFlags&8772)!==0||c){c=te.T,te.T=null;var g=ge.p;ge.p=2;var w=Sn;Sn|=4;try{o2(n,r.alternate,r)}finally{Sn=w,ge.p=g,te.T=c}}Fs=3}}function O2(){if(Fs===4||Fs===3){Fs=0,Ot();var n=ho,r=Yl,c=Ca,g=w2;(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?Fs=5:(Fs=0,Yl=ho=null,j2(n,n.pendingLanes));var w=n.pendingLanes;if(w===0&&(uo=null),Oe(c),r=r.stateNode,We&&typeof We.onCommitFiberRoot=="function")try{We.onCommitFiberRoot(Qt,r,void 0,(r.current.flags&128)===128)}catch{}if(g!==null){r=te.T,w=ge.p,ge.p=2,te.T=null;try{for(var _=n.onRecoverableError,D=0;D<g.length;D++){var U=g[D];_(U.value,{componentStack:U.stack})}}finally{te.T=r,ge.p=w}}(Ca&3)!==0&&Hh(),Wr(n),w=n.pendingLanes,(c&261930)!==0&&(w&42)!==0?n===F1?nu++:(nu=0,F1=n):nu=0,su(0)}}function j2(n,r){(n.pooledCacheLanes&=r)===0&&(r=n.pooledCache,r!=null&&(n.pooledCache=null,Pc(r)))}function Hh(){return k2(),M2(),O2(),L2()}function L2(){if(Fs!==5)return!1;var n=ho,r=B1;B1=0;var c=Oe(Ca),g=te.T,w=ge.p;try{ge.p=32>c?32:c,te.T=null,c=V1,V1=null;var _=ho,D=Ca;if(Fs=0,Yl=ho=null,Ca=0,(Sn&6)!==0)throw Error(a(331));var U=Sn;if(Sn|=4,y2(_.current),m2(_,_.current,D,c),Sn=U,su(0,!1),We&&typeof We.onPostCommitFiberRoot=="function")try{We.onPostCommitFiberRoot(Qt,_)}catch{}return!0}finally{ge.p=w,te.T=g,j2(n,r)}}function P2(n,r,c){r=ur(c,r),r=x1(n.stateNode,r,2),n=io(n,r,2),n!==null&&(fs(n,2),Wr(n))}function On(n,r,c){if(n.tag===3)P2(n,n,c);else for(;r!==null;){if(r.tag===3){P2(r,n,c);break}else if(r.tag===1){var g=r.stateNode;if(typeof r.type.getDerivedStateFromError=="function"||typeof g.componentDidCatch=="function"&&(uo===null||!uo.has(g))){n=ur(c,n),c=Bp(2),g=io(r,c,2),g!==null&&(Vp(c,g,r,n),fs(g,2),Wr(g));break}}r=r.return}}function H1(n,r,c){var g=n.pingCache;if(g===null){g=n.pingCache=new y_;var w=new Set;g.set(r,w)}else w=g.get(r),w===void 0&&(w=new Set,g.set(r,w));w.has(c)||(j1=!0,w.add(c),n=E_.bind(null,n,r,c),r.then(n,n))}function E_(n,r,c){var g=n.pingCache;g!==null&&g.delete(r),n.pingedLanes|=n.suspendedLanes&c,n.warmLanes&=~c,zn===n&&(ln&c)===c&&(ps===4||ps===3&&(ln&62914560)===ln&&300>ot()-Ph?(Sn&2)===0&&Xl(n,0):L1|=c,Wl===ln&&(Wl=0)),Wr(n)}function B2(n,r){r===0&&(r=Yn()),n=Zo(n,r),n!==null&&(fs(n,r),Wr(n))}function __(n){var r=n.memoizedState,c=0;r!==null&&(c=r.retryLane),B2(n,c)}function A_(n,r){var c=0;switch(n.tag){case 31:case 13:var g=n.stateNode,w=n.memoizedState;w!==null&&(c=w.retryLane);break;case 19:g=n.stateNode;break;case 22:g=n.stateNode._retryCache;break;default:throw Error(a(314))}g!==null&&g.delete(r),B2(n,c)}function C_(n,r){return kt(n,r)}var Gh=null,Ql=null,G1=!1,qh=!1,q1=!1,mo=0;function Wr(n){n!==Ql&&n.next===null&&(Ql===null?Gh=Ql=n:Ql=Ql.next=n),qh=!0,G1||(G1=!0,S_())}function su(n,r){if(!q1&&qh){q1=!0;do for(var c=!1,g=Gh;g!==null;){if(n!==0){var w=g.pendingLanes;if(w===0)var _=0;else{var D=g.suspendedLanes,U=g.pingedLanes;_=(1<<31-Ct(42|n)+1)-1,_&=w&~(D&~U),_=_&201326741?_&201326741|1:_?_|2:0}_!==0&&(c=!0,z2(g,_))}else _=ln,_=Xs(g,g===zn?_:0,g.cancelPendingCommit!==null||g.timeoutHandle!==-1),(_&3)===0||Tn(g,_)||(c=!0,z2(g,_));g=g.next}while(c);q1=!1}}function T_(){V2()}function V2(){qh=G1=!1;var n=0;mo!==0&&P_()&&(n=mo);for(var r=ot(),c=null,g=Gh;g!==null;){var w=g.next,_=F2(g,r);_===0?(g.next=null,c===null?Gh=w:c.next=w,w===null&&(Ql=c)):(c=g,(n!==0||(_&3)!==0)&&(qh=!0)),g=w}Fs!==0&&Fs!==5||su(n),mo!==0&&(mo=0)}function F2(n,r){for(var c=n.suspendedLanes,g=n.pingedLanes,w=n.expirationTimes,_=n.pendingLanes&-62914561;0<_;){var D=31-Ct(_),U=1<<D,re=w[D];re===-1?((U&c)===0||(U&g)!==0)&&(w[D]=Ci(U,r)):re<=r&&(n.expiredLanes|=U),_&=~U}if(r=zn,c=ln,c=Xs(n,n===r?c:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),g=n.callbackNode,c===0||n===r&&(Mn===2||Mn===9)||n.cancelPendingCommit!==null)return g!==null&&g!==null&&de(g),n.callbackNode=null,n.callbackPriority=0;if((c&3)===0||Tn(n,c)){if(r=c&-c,r===n.callbackPriority)return r;switch(g!==null&&de(g),Oe(c)){case 2:case 8:c=Zn;break;case 32:c=Vn;break;case 268435456:c=xs;break;default:c=Vn}return g=U2.bind(null,n),c=kt(c,g),n.callbackPriority=r,n.callbackNode=c,r}return g!==null&&g!==null&&de(g),n.callbackPriority=2,n.callbackNode=null,2}function U2(n,r){if(Fs!==0&&Fs!==5)return n.callbackNode=null,n.callbackPriority=0,null;var c=n.callbackNode;if(Hh()&&n.callbackNode!==c)return null;var g=ln;return g=Xs(n,n===zn?g:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),g===0?null:(E2(n,g,r),F2(n,ot()),n.callbackNode!=null&&n.callbackNode===c?U2.bind(null,n):null)}function z2(n,r){if(Hh())return null;E2(n,r,!0)}function S_(){V_(function(){(Sn&6)!==0?kt(jn,T_):V2()})}function W1(){if(mo===0){var n=jl;n===0&&(n=Nn,Nn<<=1,(Nn&261888)===0&&(Nn=256)),mo=n}return mo}function H2(n){return n==null||typeof n=="symbol"||typeof n=="boolean"?null:typeof n=="function"?n:Vr(""+n)}function G2(n,r){var c=r.ownerDocument.createElement("input");return c.name=r.name,c.value=r.value,n.id&&c.setAttribute("form",n.id),r.parentNode.insertBefore(c,r),n=new FormData(n),c.parentNode.removeChild(c),n}function N_(n,r,c,g,w){if(r==="submit"&&c&&c.stateNode===w){var _=H2((w[bt]||null).action),D=g.submitter;D&&(r=(r=D[bt]||null)?H2(r.formAction):D.getAttribute("formAction"),r!==null&&(_=r,D=null));var U=new Xn("action","action",null,g,w);n.push({event:U,listeners:[{instance:null,listener:function(){if(g.defaultPrevented){if(mo!==0){var re=D?G2(w,D):new FormData(w);d1(c,{pending:!0,data:re,method:w.method,action:_},null,re)}}else typeof _=="function"&&(U.preventDefault(),re=D?G2(w,D):new FormData(w),d1(c,{pending:!0,data:re,method:w.method,action:_},_,re))},currentTarget:w}]})}}for(var Y1=0;Y1<Oc.length;Y1++){var X1=Oc[Y1],I_=X1.toLowerCase(),R_=X1[0].toUpperCase()+X1.slice(1);Cr(I_,"on"+R_)}Cr(Di,"onAnimationEnd"),Cr($s,"onAnimationIteration"),Cr(Dn,"onAnimationStart"),Cr("dblclick","onDoubleClick"),Cr("focusin","onFocus"),Cr("focusout","onBlur"),Cr(Vs,"onTransitionRun"),Cr(Ei,"onTransitionStart"),Cr(Za,"onTransitionCancel"),Cr(ha,"onTransitionEnd"),Ks("onMouseEnter",["mouseout","mouseover"]),Ks("onMouseLeave",["mouseout","mouseover"]),Ks("onPointerEnter",["pointerout","pointerover"]),Ks("onPointerLeave",["pointerout","pointerover"]),bn("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),bn("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),bn("onBeforeInput",["compositionend","keypress","textInput","paste"]),bn("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),bn("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),bn("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var iu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),D_=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(iu));function q2(n,r){r=(r&4)!==0;for(var c=0;c<n.length;c++){var g=n[c],w=g.event;g=g.listeners;e:{var _=void 0;if(r)for(var D=g.length-1;0<=D;D--){var U=g[D],re=U.instance,Ae=U.currentTarget;if(U=U.listener,re!==_&&w.isPropagationStopped())break e;_=U,w.currentTarget=Ae;try{_(w)}catch(Be){ah(Be)}w.currentTarget=null,_=re}else for(D=0;D<g.length;D++){if(U=g[D],re=U.instance,Ae=U.currentTarget,U=U.listener,re!==_&&w.isPropagationStopped())break e;_=U,w.currentTarget=Ae;try{_(w)}catch(Be){ah(Be)}w.currentTarget=null,_=re}}}}function rn(n,r){var c=r[os];c===void 0&&(c=r[os]=new Set);var g=n+"__bubble";c.has(g)||(W2(r,n,2,!1),c.add(g))}function K1(n,r,c){var g=0;r&&(g|=4),W2(c,n,g,r)}var Wh="_reactListening"+Math.random().toString(36).slice(2);function Q1(n){if(!n[Wh]){n[Wh]=!0,Ge.forEach(function(c){c!=="selectionchange"&&(D_.has(c)||K1(c,!1,n),K1(c,!0,n))});var r=n.nodeType===9?n:n.ownerDocument;r===null||r[Wh]||(r[Wh]=!0,K1("selectionchange",!1,r))}}function W2(n,r,c,g){switch(by(r)){case 2:var w=rA;break;case 8:w=aA;break;default:w=h0}c=w.bind(null,r,c,n),w=void 0,!na||r!=="touchstart"&&r!=="touchmove"&&r!=="wheel"||(w=!0),g?w!==void 0?n.addEventListener(r,c,{capture:!0,passive:w}):n.addEventListener(r,c,!0):w!==void 0?n.addEventListener(r,c,{passive:w}):n.addEventListener(r,c,!1)}function Z1(n,r,c,g,w){var _=g;if((r&1)===0&&(r&2)===0&&g!==null)e:for(;;){if(g===null)return;var D=g.tag;if(D===3||D===4){var U=g.stateNode.containerInfo;if(U===w)break;if(D===4)for(D=g.return;D!==null;){var re=D.tag;if((re===3||re===4)&&D.stateNode.containerInfo===w)return;D=D.return}for(;U!==null;){if(D=pt(U),D===null)return;if(re=D.tag,re===5||re===6||re===26||re===27){g=_=D;continue e}U=U.parentNode}}g=g.return}Fr(function(){var Ae=_,Be=Ni(c),ze=[];e:{var Se=rh.get(n);if(Se!==void 0){var je=Xn,ht=n;switch(n){case"keypress":if(zi(c)===0)break e;case"keydown":case"keyup":je=oa;break;case"focusin":ht="focus",je=ra;break;case"focusout":ht="blur",je=ra;break;case"beforeblur":case"afterblur":je=ra;break;case"click":if(c.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":je=pn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":je=ia;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":je=N;break;case Di:case $s:case Dn:je=Bt;break;case ha:je=q;break;case"scroll":case"scrollend":je=Wa;break;case"wheel":je=ke;break;case"copy":case"cut":case"paste":je=aa;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":je=nn;break;case"toggle":case"beforetoggle":je=Mt}var Nt=(r&4)!==0,Bn=!Nt&&(n==="scroll"||n==="scrollend"),ye=Nt?Se!==null?Se+"Capture":null:Se;Nt=[];for(var fe=Ae,_e;fe!==null;){var Ve=fe;if(_e=Ve.stateNode,Ve=Ve.tag,Ve!==5&&Ve!==26&&Ve!==27||_e===null||ye===null||(Ve=Tt(fe,ye),Ve!=null&&Nt.push(ru(fe,Ve,_e))),Bn)break;fe=fe.return}0<Nt.length&&(Se=new je(Se,ht,null,c,Be),ze.push({event:Se,listeners:Nt}))}}if((r&7)===0){e:{if(Se=n==="mouseover"||n==="pointerover",je=n==="mouseout"||n==="pointerout",Se&&c!==ta&&(ht=c.relatedTarget||c.fromElement)&&(pt(ht)||ht[Gn]))break e;if((je||Se)&&(Se=Be.window===Be?Be:(Se=Be.ownerDocument)?Se.defaultView||Se.parentWindow:window,je?(ht=c.relatedTarget||c.toElement,je=Ae,ht=ht?pt(ht):null,ht!==null&&(Bn=f(ht),Nt=ht.tag,ht!==Bn||Nt!==5&&Nt!==27&&Nt!==6)&&(ht=null)):(je=null,ht=Ae),je!==ht)){if(Nt=pn,Ve="onMouseLeave",ye="onMouseEnter",fe="mouse",(n==="pointerout"||n==="pointerover")&&(Nt=nn,Ve="onPointerLeave",ye="onPointerEnter",fe="pointer"),Bn=je==null?Se:Ss(je),_e=ht==null?Se:Ss(ht),Se=new Nt(Ve,fe+"leave",je,c,Be),Se.target=Bn,Se.relatedTarget=_e,Ve=null,pt(Be)===Ae&&(Nt=new Nt(ye,fe+"enter",ht,c,Be),Nt.target=_e,Nt.relatedTarget=Bn,Ve=Nt),Bn=Ve,je&&ht)t:{for(Nt=k_,ye=je,fe=ht,_e=0,Ve=ye;Ve;Ve=Nt(Ve))_e++;Ve=0;for(var _t=fe;_t;_t=Nt(_t))Ve++;for(;0<_e-Ve;)ye=Nt(ye),_e--;for(;0<Ve-_e;)fe=Nt(fe),Ve--;for(;_e--;){if(ye===fe||fe!==null&&ye===fe.alternate){Nt=ye;break t}ye=Nt(ye),fe=Nt(fe)}Nt=null}else Nt=null;je!==null&&Y2(ze,Se,je,Nt,!1),ht!==null&&Bn!==null&&Y2(ze,Bn,ht,Nt,!0)}}e:{if(Se=Ae?Ss(Ae):window,je=Se.nodeName&&Se.nodeName.toLowerCase(),je==="select"||je==="input"&&Se.type==="file")var An=qi;else if(Mc(Se))if(ih)An=d;else{An=o;var gt=s}else je=Se.nodeName,!je||je.toLowerCase()!=="input"||Se.type!=="checkbox"&&Se.type!=="radio"?Ae&&In(Ae.elementType)&&(An=qi):An=l;if(An&&(An=An(n,Ae))){Gi(ze,An,c,Be);break e}gt&&gt(n,Se,Ae),n==="focusout"&&Ae&&Se.type==="number"&&Ae.memoizedProps.value!=null&&W(Se,"number",Se.value)}switch(gt=Ae?Ss(Ae):window,n){case"focusin":(Mc(gt)||gt.contentEditable==="true")&&(le=gt,he=Ae,we=null);break;case"focusout":we=he=le=null;break;case"mousedown":De=!0;break;case"contextmenu":case"mouseup":case"dragend":De=!1,$e(ze,c,Be);break;case"selectionchange":if(K)break;case"keydown":case"keyup":$e(ze,c,Be)}var Yt;if(mn)e:{switch(n){case"compositionstart":var cn="onCompositionStart";break e;case"compositionend":cn="onCompositionEnd";break e;case"compositionupdate":cn="onCompositionUpdate";break e}cn=void 0}else Qa?la(n,c)&&(cn="onCompositionEnd"):n==="keydown"&&c.keyCode===229&&(cn="onCompositionStart");cn&&(or&&c.locale!=="ko"&&(Qa||cn!=="onCompositionStart"?cn==="onCompositionEnd"&&Qa&&(Yt=Er()):(Fi=Be,Ui="value"in Fi?Fi.value:Fi.textContent,Qa=!0)),gt=Yh(Ae,cn),0<gt.length&&(cn=new ir(cn,n,null,c,Be),ze.push({event:cn,listeners:gt}),Yt?cn.data=Yt:(Yt=lr(c),Yt!==null&&(cn.data=Yt)))),(Yt=wi?zr(n,c):Nl(n,c))&&(cn=Yh(Ae,"onBeforeInput"),0<cn.length&&(gt=new ir("onBeforeInput","beforeinput",null,c,Be),ze.push({event:gt,listeners:cn}),gt.data=Yt)),N_(ze,n,Ae,c,Be)}q2(ze,r)})}function ru(n,r,c){return{instance:n,listener:r,currentTarget:c}}function Yh(n,r){for(var c=r+"Capture",g=[];n!==null;){var w=n,_=w.stateNode;if(w=w.tag,w!==5&&w!==26&&w!==27||_===null||(w=Tt(n,c),w!=null&&g.unshift(ru(n,w,_)),w=Tt(n,r),w!=null&&g.push(ru(n,w,_))),n.tag===3)return g;n=n.return}return[]}function k_(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5&&n.tag!==27);return n||null}function Y2(n,r,c,g,w){for(var _=r._reactName,D=[];c!==null&&c!==g;){var U=c,re=U.alternate,Ae=U.stateNode;if(U=U.tag,re!==null&&re===g)break;U!==5&&U!==26&&U!==27||Ae===null||(re=Ae,w?(Ae=Tt(c,_),Ae!=null&&D.unshift(ru(c,Ae,re))):w||(Ae=Tt(c,_),Ae!=null&&D.push(ru(c,Ae,re)))),c=c.return}D.length!==0&&n.push({event:r,listeners:D})}var M_=/\r\n?/g,O_=/\u0000|\uFFFD/g;function X2(n){return(typeof n=="string"?n:""+n).replace(M_,`
`).replace(O_,"")}function K2(n,r){return r=X2(r),X2(n)===r}function Pn(n,r,c,g,w,_){switch(c){case"children":typeof g=="string"?r==="body"||r==="textarea"&&g===""||li(n,g):(typeof g=="number"||typeof g=="bigint")&&r!=="body"&&li(n,""+g);break;case"className":Qs(n,"class",g);break;case"tabIndex":Qs(n,"tabindex",g);break;case"dir":case"role":case"viewBox":case"width":case"height":Qs(n,c,g);break;case"style":xt(n,g,_);break;case"data":if(r!=="object"){Qs(n,"data",g);break}case"src":case"href":if(g===""&&(r!=="a"||c!=="href")){n.removeAttribute(c);break}if(g==null||typeof g=="function"||typeof g=="symbol"||typeof g=="boolean"){n.removeAttribute(c);break}g=Vr(""+g),n.setAttribute(c,g);break;case"action":case"formAction":if(typeof g=="function"){n.setAttribute(c,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof _=="function"&&(c==="formAction"?(r!=="input"&&Pn(n,r,"name",w.name,w,null),Pn(n,r,"formEncType",w.formEncType,w,null),Pn(n,r,"formMethod",w.formMethod,w,null),Pn(n,r,"formTarget",w.formTarget,w,null)):(Pn(n,r,"encType",w.encType,w,null),Pn(n,r,"method",w.method,w,null),Pn(n,r,"target",w.target,w,null)));if(g==null||typeof g=="symbol"||typeof g=="boolean"){n.removeAttribute(c);break}g=Vr(""+g),n.setAttribute(c,g);break;case"onClick":g!=null&&(n.onclick=ci);break;case"onScroll":g!=null&&rn("scroll",n);break;case"onScrollEnd":g!=null&&rn("scrollend",n);break;case"dangerouslySetInnerHTML":if(g!=null){if(typeof g!="object"||!("__html"in g))throw Error(a(61));if(c=g.__html,c!=null){if(w.children!=null)throw Error(a(60));n.innerHTML=c}}break;case"multiple":n.multiple=g&&typeof g!="function"&&typeof g!="symbol";break;case"muted":n.muted=g&&typeof g!="function"&&typeof g!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(g==null||typeof g=="function"||typeof g=="boolean"||typeof g=="symbol"){n.removeAttribute("xlink:href");break}c=Vr(""+g),n.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",c);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":g!=null&&typeof g!="function"&&typeof g!="symbol"?n.setAttribute(c,""+g):n.removeAttribute(c);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":g&&typeof g!="function"&&typeof g!="symbol"?n.setAttribute(c,""):n.removeAttribute(c);break;case"capture":case"download":g===!0?n.setAttribute(c,""):g!==!1&&g!=null&&typeof g!="function"&&typeof g!="symbol"?n.setAttribute(c,g):n.removeAttribute(c);break;case"cols":case"rows":case"size":case"span":g!=null&&typeof g!="function"&&typeof g!="symbol"&&!isNaN(g)&&1<=g?n.setAttribute(c,g):n.removeAttribute(c);break;case"rowSpan":case"start":g==null||typeof g=="function"||typeof g=="symbol"||isNaN(g)?n.removeAttribute(c):n.setAttribute(c,g);break;case"popover":rn("beforetoggle",n),rn("toggle",n),Pr(n,"popover",g);break;case"xlinkActuate":es(n,"http://www.w3.org/1999/xlink","xlink:actuate",g);break;case"xlinkArcrole":es(n,"http://www.w3.org/1999/xlink","xlink:arcrole",g);break;case"xlinkRole":es(n,"http://www.w3.org/1999/xlink","xlink:role",g);break;case"xlinkShow":es(n,"http://www.w3.org/1999/xlink","xlink:show",g);break;case"xlinkTitle":es(n,"http://www.w3.org/1999/xlink","xlink:title",g);break;case"xlinkType":es(n,"http://www.w3.org/1999/xlink","xlink:type",g);break;case"xmlBase":es(n,"http://www.w3.org/XML/1998/namespace","xml:base",g);break;case"xmlLang":es(n,"http://www.w3.org/XML/1998/namespace","xml:lang",g);break;case"xmlSpace":es(n,"http://www.w3.org/XML/1998/namespace","xml:space",g);break;case"is":Pr(n,"is",g);break;case"innerText":case"textContent":break;default:(!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(c=qo.get(c)||c,Pr(n,c,g))}}function $1(n,r,c,g,w,_){switch(c){case"style":xt(n,g,_);break;case"dangerouslySetInnerHTML":if(g!=null){if(typeof g!="object"||!("__html"in g))throw Error(a(61));if(c=g.__html,c!=null){if(w.children!=null)throw Error(a(60));n.innerHTML=c}}break;case"children":typeof g=="string"?li(n,g):(typeof g=="number"||typeof g=="bigint")&&li(n,""+g);break;case"onScroll":g!=null&&rn("scroll",n);break;case"onScrollEnd":g!=null&&rn("scrollend",n);break;case"onClick":g!=null&&(n.onclick=ci);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!zo.hasOwnProperty(c))e:{if(c[0]==="o"&&c[1]==="n"&&(w=c.endsWith("Capture"),r=c.slice(2,w?c.length-7:void 0),_=n[bt]||null,_=_!=null?_[c]:null,typeof _=="function"&&n.removeEventListener(r,_,w),typeof g=="function")){typeof _!="function"&&_!==null&&(c in n?n[c]=null:n.hasAttribute(c)&&n.removeAttribute(c)),n.addEventListener(r,g,w);break e}c in n?n[c]=g:g===!0?n.setAttribute(c,""):Pr(n,c,g)}}}function ni(n,r,c){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":rn("error",n),rn("load",n);var g=!1,w=!1,_;for(_ in c)if(c.hasOwnProperty(_)){var D=c[_];if(D!=null)switch(_){case"src":g=!0;break;case"srcSet":w=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(a(137,r));default:Pn(n,r,_,D,c,null)}}w&&Pn(n,r,"srcSet",c.srcSet,c,null),g&&Pn(n,r,"src",c.src,c,null);return;case"input":rn("invalid",n);var U=_=D=w=null,re=null,Ae=null;for(g in c)if(c.hasOwnProperty(g)){var Be=c[g];if(Be!=null)switch(g){case"name":w=Be;break;case"type":D=Be;break;case"checked":re=Be;break;case"defaultChecked":Ae=Be;break;case"value":_=Be;break;case"defaultValue":U=Be;break;case"children":case"dangerouslySetInnerHTML":if(Be!=null)throw Error(a(137,r));break;default:Pn(n,r,g,Be,c,null)}}Ee(n,_,U,re,Ae,D,w,!1);return;case"select":rn("invalid",n),g=D=_=null;for(w in c)if(c.hasOwnProperty(w)&&(U=c[w],U!=null))switch(w){case"value":_=U;break;case"defaultValue":D=U;break;case"multiple":g=U;default:Pn(n,r,w,U,c,null)}r=_,c=D,n.multiple=!!g,r!=null?ut(n,!!g,r,!1):c!=null&&ut(n,!!g,c,!0);return;case"textarea":rn("invalid",n),_=w=g=null;for(D in c)if(c.hasOwnProperty(D)&&(U=c[D],U!=null))switch(D){case"value":g=U;break;case"defaultValue":w=U;break;case"children":_=U;break;case"dangerouslySetInnerHTML":if(U!=null)throw Error(a(91));break;default:Pn(n,r,D,U,c,null)}ws(n,g,w,_);return;case"option":for(re in c)c.hasOwnProperty(re)&&(g=c[re],g!=null)&&(re==="selected"?n.selected=g&&typeof g!="function"&&typeof g!="symbol":Pn(n,r,re,g,c,null));return;case"dialog":rn("beforetoggle",n),rn("toggle",n),rn("cancel",n),rn("close",n);break;case"iframe":case"object":rn("load",n);break;case"video":case"audio":for(g=0;g<iu.length;g++)rn(iu[g],n);break;case"image":rn("error",n),rn("load",n);break;case"details":rn("toggle",n);break;case"embed":case"source":case"link":rn("error",n),rn("load",n);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Ae in c)if(c.hasOwnProperty(Ae)&&(g=c[Ae],g!=null))switch(Ae){case"children":case"dangerouslySetInnerHTML":throw Error(a(137,r));default:Pn(n,r,Ae,g,c,null)}return;default:if(In(r)){for(Be in c)c.hasOwnProperty(Be)&&(g=c[Be],g!==void 0&&$1(n,r,Be,g,c,void 0));return}}for(U in c)c.hasOwnProperty(U)&&(g=c[U],g!=null&&Pn(n,r,U,g,c,null))}function j_(n,r,c,g){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var w=null,_=null,D=null,U=null,re=null,Ae=null,Be=null;for(je in c){var ze=c[je];if(c.hasOwnProperty(je)&&ze!=null)switch(je){case"checked":break;case"value":break;case"defaultValue":re=ze;default:g.hasOwnProperty(je)||Pn(n,r,je,null,g,ze)}}for(var Se in g){var je=g[Se];if(ze=c[Se],g.hasOwnProperty(Se)&&(je!=null||ze!=null))switch(Se){case"type":_=je;break;case"name":w=je;break;case"checked":Ae=je;break;case"defaultChecked":Be=je;break;case"value":D=je;break;case"defaultValue":U=je;break;case"children":case"dangerouslySetInnerHTML":if(je!=null)throw Error(a(137,r));break;default:je!==ze&&Pn(n,r,Se,je,g,ze)}}ls(n,D,U,re,Ae,Be,_,w);return;case"select":je=D=U=Se=null;for(_ in c)if(re=c[_],c.hasOwnProperty(_)&&re!=null)switch(_){case"value":break;case"multiple":je=re;default:g.hasOwnProperty(_)||Pn(n,r,_,null,g,re)}for(w in g)if(_=g[w],re=c[w],g.hasOwnProperty(w)&&(_!=null||re!=null))switch(w){case"value":Se=_;break;case"defaultValue":U=_;break;case"multiple":D=_;default:_!==re&&Pn(n,r,w,_,g,re)}r=U,c=D,g=je,Se!=null?ut(n,!!c,Se,!1):!!g!=!!c&&(r!=null?ut(n,!!c,r,!0):ut(n,!!c,c?[]:"",!1));return;case"textarea":je=Se=null;for(U in c)if(w=c[U],c.hasOwnProperty(U)&&w!=null&&!g.hasOwnProperty(U))switch(U){case"value":break;case"children":break;default:Pn(n,r,U,null,g,w)}for(D in g)if(w=g[D],_=c[D],g.hasOwnProperty(D)&&(w!=null||_!=null))switch(D){case"value":Se=w;break;case"defaultValue":je=w;break;case"children":break;case"dangerouslySetInnerHTML":if(w!=null)throw Error(a(91));break;default:w!==_&&Pn(n,r,D,w,g,_)}cs(n,Se,je);return;case"option":for(var ht in c)Se=c[ht],c.hasOwnProperty(ht)&&Se!=null&&!g.hasOwnProperty(ht)&&(ht==="selected"?n.selected=!1:Pn(n,r,ht,null,g,Se));for(re in g)Se=g[re],je=c[re],g.hasOwnProperty(re)&&Se!==je&&(Se!=null||je!=null)&&(re==="selected"?n.selected=Se&&typeof Se!="function"&&typeof Se!="symbol":Pn(n,r,re,Se,g,je));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Nt in c)Se=c[Nt],c.hasOwnProperty(Nt)&&Se!=null&&!g.hasOwnProperty(Nt)&&Pn(n,r,Nt,null,g,Se);for(Ae in g)if(Se=g[Ae],je=c[Ae],g.hasOwnProperty(Ae)&&Se!==je&&(Se!=null||je!=null))switch(Ae){case"children":case"dangerouslySetInnerHTML":if(Se!=null)throw Error(a(137,r));break;default:Pn(n,r,Ae,Se,g,je)}return;default:if(In(r)){for(var Bn in c)Se=c[Bn],c.hasOwnProperty(Bn)&&Se!==void 0&&!g.hasOwnProperty(Bn)&&$1(n,r,Bn,void 0,g,Se);for(Be in g)Se=g[Be],je=c[Be],!g.hasOwnProperty(Be)||Se===je||Se===void 0&&je===void 0||$1(n,r,Be,Se,g,je);return}}for(var ye in c)Se=c[ye],c.hasOwnProperty(ye)&&Se!=null&&!g.hasOwnProperty(ye)&&Pn(n,r,ye,null,g,Se);for(ze in g)Se=g[ze],je=c[ze],!g.hasOwnProperty(ze)||Se===je||Se==null&&je==null||Pn(n,r,ze,Se,g,je)}function Q2(n){switch(n){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function L_(){if(typeof performance.getEntriesByType=="function"){for(var n=0,r=0,c=performance.getEntriesByType("resource"),g=0;g<c.length;g++){var w=c[g],_=w.transferSize,D=w.initiatorType,U=w.duration;if(_&&U&&Q2(D)){for(D=0,U=w.responseEnd,g+=1;g<c.length;g++){var re=c[g],Ae=re.startTime;if(Ae>U)break;var Be=re.transferSize,ze=re.initiatorType;Be&&Q2(ze)&&(re=re.responseEnd,D+=Be*(re<U?1:(U-Ae)/(re-Ae)))}if(--g,r+=8*(_+D)/(w.duration/1e3),n++,10<n)break}}if(0<n)return r/n/1e6}return navigator.connection&&(n=navigator.connection.downlink,typeof n=="number")?n:5}var J1=null,e0=null;function Xh(n){return n.nodeType===9?n:n.ownerDocument}function Z2(n){switch(n){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function $2(n,r){if(n===0)switch(r){case"svg":return 1;case"math":return 2;default:return 0}return n===1&&r==="foreignObject"?0:n}function t0(n,r){return n==="textarea"||n==="noscript"||typeof r.children=="string"||typeof r.children=="number"||typeof r.children=="bigint"||typeof r.dangerouslySetInnerHTML=="object"&&r.dangerouslySetInnerHTML!==null&&r.dangerouslySetInnerHTML.__html!=null}var n0=null;function P_(){var n=window.event;return n&&n.type==="popstate"?n===n0?!1:(n0=n,!0):(n0=null,!1)}var J2=typeof setTimeout=="function"?setTimeout:void 0,B_=typeof clearTimeout=="function"?clearTimeout:void 0,ey=typeof Promise=="function"?Promise:void 0,V_=typeof queueMicrotask=="function"?queueMicrotask:typeof ey<"u"?function(n){return ey.resolve(null).then(n).catch(F_)}:J2;function F_(n){setTimeout(function(){throw n})}function go(n){return n==="head"}function ty(n,r){var c=r,g=0;do{var w=c.nextSibling;if(n.removeChild(c),w&&w.nodeType===8)if(c=w.data,c==="/$"||c==="/&"){if(g===0){n.removeChild(w),ec(r);return}g--}else if(c==="$"||c==="$?"||c==="$~"||c==="$!"||c==="&")g++;else if(c==="html")au(n.ownerDocument.documentElement);else if(c==="head"){c=n.ownerDocument.head,au(c);for(var _=c.firstChild;_;){var D=_.nextSibling,U=_.nodeName;_[Ti]||U==="SCRIPT"||U==="STYLE"||U==="LINK"&&_.rel.toLowerCase()==="stylesheet"||c.removeChild(_),_=D}}else c==="body"&&au(n.ownerDocument.body);c=w}while(c);ec(r)}function ny(n,r){var c=n;n=0;do{var g=c.nextSibling;if(c.nodeType===1?r?(c._stashedDisplay=c.style.display,c.style.display="none"):(c.style.display=c._stashedDisplay||"",c.getAttribute("style")===""&&c.removeAttribute("style")):c.nodeType===3&&(r?(c._stashedText=c.nodeValue,c.nodeValue=""):c.nodeValue=c._stashedText||""),g&&g.nodeType===8)if(c=g.data,c==="/$"){if(n===0)break;n--}else c!=="$"&&c!=="$?"&&c!=="$~"&&c!=="$!"||n++;c=g}while(c)}function s0(n){var r=n.firstChild;for(r&&r.nodeType===10&&(r=r.nextSibling);r;){var c=r;switch(r=r.nextSibling,c.nodeName){case"HTML":case"HEAD":case"BODY":s0(c),Ts(c);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(c.rel.toLowerCase()==="stylesheet")continue}n.removeChild(c)}}function U_(n,r,c,g){for(;n.nodeType===1;){var w=c;if(n.nodeName.toLowerCase()!==r.toLowerCase()){if(!g&&(n.nodeName!=="INPUT"||n.type!=="hidden"))break}else if(g){if(!n[Ti])switch(r){case"meta":if(!n.hasAttribute("itemprop"))break;return n;case"link":if(_=n.getAttribute("rel"),_==="stylesheet"&&n.hasAttribute("data-precedence"))break;if(_!==w.rel||n.getAttribute("href")!==(w.href==null||w.href===""?null:w.href)||n.getAttribute("crossorigin")!==(w.crossOrigin==null?null:w.crossOrigin)||n.getAttribute("title")!==(w.title==null?null:w.title))break;return n;case"style":if(n.hasAttribute("data-precedence"))break;return n;case"script":if(_=n.getAttribute("src"),(_!==(w.src==null?null:w.src)||n.getAttribute("type")!==(w.type==null?null:w.type)||n.getAttribute("crossorigin")!==(w.crossOrigin==null?null:w.crossOrigin))&&_&&n.hasAttribute("async")&&!n.hasAttribute("itemprop"))break;return n;default:return n}}else if(r==="input"&&n.type==="hidden"){var _=w.name==null?null:""+w.name;if(w.type==="hidden"&&n.getAttribute("name")===_)return n}else return n;if(n=gr(n.nextSibling),n===null)break}return null}function z_(n,r,c){if(r==="")return null;for(;n.nodeType!==3;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!c||(n=gr(n.nextSibling),n===null))return null;return n}function sy(n,r){for(;n.nodeType!==8;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!r||(n=gr(n.nextSibling),n===null))return null;return n}function i0(n){return n.data==="$?"||n.data==="$~"}function r0(n){return n.data==="$!"||n.data==="$?"&&n.ownerDocument.readyState!=="loading"}function H_(n,r){var c=n.ownerDocument;if(n.data==="$~")n._reactRetry=r;else if(n.data!=="$?"||c.readyState!=="loading")r();else{var g=function(){r(),c.removeEventListener("DOMContentLoaded",g)};c.addEventListener("DOMContentLoaded",g),n._reactRetry=g}}function gr(n){for(;n!=null;n=n.nextSibling){var r=n.nodeType;if(r===1||r===3)break;if(r===8){if(r=n.data,r==="$"||r==="$!"||r==="$?"||r==="$~"||r==="&"||r==="F!"||r==="F")break;if(r==="/$"||r==="/&")return null}}return n}var a0=null;function iy(n){n=n.nextSibling;for(var r=0;n;){if(n.nodeType===8){var c=n.data;if(c==="/$"||c==="/&"){if(r===0)return gr(n.nextSibling);r--}else c!=="$"&&c!=="$!"&&c!=="$?"&&c!=="$~"&&c!=="&"||r++}n=n.nextSibling}return null}function ry(n){n=n.previousSibling;for(var r=0;n;){if(n.nodeType===8){var c=n.data;if(c==="$"||c==="$!"||c==="$?"||c==="$~"||c==="&"){if(r===0)return n;r--}else c!=="/$"&&c!=="/&"||r++}n=n.previousSibling}return null}function ay(n,r,c){switch(r=Xh(c),n){case"html":if(n=r.documentElement,!n)throw Error(a(452));return n;case"head":if(n=r.head,!n)throw Error(a(453));return n;case"body":if(n=r.body,!n)throw Error(a(454));return n;default:throw Error(a(451))}}function au(n){for(var r=n.attributes;r.length;)n.removeAttributeNode(r[0]);Ts(n)}var pr=new Map,oy=new Set;function Kh(n){return typeof n.getRootNode=="function"?n.getRootNode():n.nodeType===9?n:n.ownerDocument}var Ta=ge.d;ge.d={f:G_,r:q_,D:W_,C:Y_,L:X_,m:K_,X:Z_,S:Q_,M:$_};function G_(){var n=Ta.f(),r=Fh();return n||r}function q_(n){var r=Ht(n);r!==null&&r.tag===5&&r.type==="form"?Ap(r):Ta.r(n)}var Zl=typeof document>"u"?null:document;function ly(n,r,c){var g=Zl;if(g&&typeof r=="string"&&r){var w=Wt(r);w='link[rel="'+n+'"][href="'+w+'"]',typeof c=="string"&&(w+='[crossorigin="'+c+'"]'),oy.has(w)||(oy.add(w),n={rel:n,crossOrigin:c,href:r},g.querySelector(w)===null&&(r=g.createElement("link"),ni(r,"link",n),Jn(r),g.head.appendChild(r)))}}function W_(n){Ta.D(n),ly("dns-prefetch",n,null)}function Y_(n,r){Ta.C(n,r),ly("preconnect",n,r)}function X_(n,r,c){Ta.L(n,r,c);var g=Zl;if(g&&n&&r){var w='link[rel="preload"][as="'+Wt(r)+'"]';r==="image"&&c&&c.imageSrcSet?(w+='[imagesrcset="'+Wt(c.imageSrcSet)+'"]',typeof c.imageSizes=="string"&&(w+='[imagesizes="'+Wt(c.imageSizes)+'"]')):w+='[href="'+Wt(n)+'"]';var _=w;switch(r){case"style":_=$l(n);break;case"script":_=Jl(n)}pr.has(_)||(n=I({rel:"preload",href:r==="image"&&c&&c.imageSrcSet?void 0:n,as:r},c),pr.set(_,n),g.querySelector(w)!==null||r==="style"&&g.querySelector(ou(_))||r==="script"&&g.querySelector(lu(_))||(r=g.createElement("link"),ni(r,"link",n),Jn(r),g.head.appendChild(r)))}}function K_(n,r){Ta.m(n,r);var c=Zl;if(c&&n){var g=r&&typeof r.as=="string"?r.as:"script",w='link[rel="modulepreload"][as="'+Wt(g)+'"][href="'+Wt(n)+'"]',_=w;switch(g){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":_=Jl(n)}if(!pr.has(_)&&(n=I({rel:"modulepreload",href:n},r),pr.set(_,n),c.querySelector(w)===null)){switch(g){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(c.querySelector(lu(_)))return}g=c.createElement("link"),ni(g,"link",n),Jn(g),c.head.appendChild(g)}}}function Q_(n,r,c){Ta.S(n,r,c);var g=Zl;if(g&&n){var w=Bs(g).hoistableStyles,_=$l(n);r=r||"default";var D=w.get(_);if(!D){var U={loading:0,preload:null};if(D=g.querySelector(ou(_)))U.loading=5;else{n=I({rel:"stylesheet",href:n,"data-precedence":r},c),(c=pr.get(_))&&o0(n,c);var re=D=g.createElement("link");Jn(re),ni(re,"link",n),re._p=new Promise(function(Ae,Be){re.onload=Ae,re.onerror=Be}),re.addEventListener("load",function(){U.loading|=1}),re.addEventListener("error",function(){U.loading|=2}),U.loading|=4,Qh(D,r,g)}D={type:"stylesheet",instance:D,count:1,state:U},w.set(_,D)}}}function Z_(n,r){Ta.X(n,r);var c=Zl;if(c&&n){var g=Bs(c).hoistableScripts,w=Jl(n),_=g.get(w);_||(_=c.querySelector(lu(w)),_||(n=I({src:n,async:!0},r),(r=pr.get(w))&&l0(n,r),_=c.createElement("script"),Jn(_),ni(_,"link",n),c.head.appendChild(_)),_={type:"script",instance:_,count:1,state:null},g.set(w,_))}}function $_(n,r){Ta.M(n,r);var c=Zl;if(c&&n){var g=Bs(c).hoistableScripts,w=Jl(n),_=g.get(w);_||(_=c.querySelector(lu(w)),_||(n=I({src:n,async:!0,type:"module"},r),(r=pr.get(w))&&l0(n,r),_=c.createElement("script"),Jn(_),ni(_,"link",n),c.head.appendChild(_)),_={type:"script",instance:_,count:1,state:null},g.set(w,_))}}function cy(n,r,c,g){var w=(w=ie.current)?Kh(w):null;if(!w)throw Error(a(446));switch(n){case"meta":case"title":return null;case"style":return typeof c.precedence=="string"&&typeof c.href=="string"?(r=$l(c.href),c=Bs(w).hoistableStyles,g=c.get(r),g||(g={type:"style",instance:null,count:0,state:null},c.set(r,g)),g):{type:"void",instance:null,count:0,state:null};case"link":if(c.rel==="stylesheet"&&typeof c.href=="string"&&typeof c.precedence=="string"){n=$l(c.href);var _=Bs(w).hoistableStyles,D=_.get(n);if(D||(w=w.ownerDocument||w,D={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},_.set(n,D),(_=w.querySelector(ou(n)))&&!_._p&&(D.instance=_,D.state.loading=5),pr.has(n)||(c={rel:"preload",as:"style",href:c.href,crossOrigin:c.crossOrigin,integrity:c.integrity,media:c.media,hrefLang:c.hrefLang,referrerPolicy:c.referrerPolicy},pr.set(n,c),_||J_(w,n,c,D.state))),r&&g===null)throw Error(a(528,""));return D}if(r&&g!==null)throw Error(a(529,""));return null;case"script":return r=c.async,c=c.src,typeof c=="string"&&r&&typeof r!="function"&&typeof r!="symbol"?(r=Jl(c),c=Bs(w).hoistableScripts,g=c.get(r),g||(g={type:"script",instance:null,count:0,state:null},c.set(r,g)),g):{type:"void",instance:null,count:0,state:null};default:throw Error(a(444,n))}}function $l(n){return'href="'+Wt(n)+'"'}function ou(n){return'link[rel="stylesheet"]['+n+"]"}function uy(n){return I({},n,{"data-precedence":n.precedence,precedence:null})}function J_(n,r,c,g){n.querySelector('link[rel="preload"][as="style"]['+r+"]")?g.loading=1:(r=n.createElement("link"),g.preload=r,r.addEventListener("load",function(){return g.loading|=1}),r.addEventListener("error",function(){return g.loading|=2}),ni(r,"link",c),Jn(r),n.head.appendChild(r))}function Jl(n){return'[src="'+Wt(n)+'"]'}function lu(n){return"script[async]"+n}function hy(n,r,c){if(r.count++,r.instance===null)switch(r.type){case"style":var g=n.querySelector('style[data-href~="'+Wt(c.href)+'"]');if(g)return r.instance=g,Jn(g),g;var w=I({},c,{"data-href":c.href,"data-precedence":c.precedence,href:null,precedence:null});return g=(n.ownerDocument||n).createElement("style"),Jn(g),ni(g,"style",w),Qh(g,c.precedence,n),r.instance=g;case"stylesheet":w=$l(c.href);var _=n.querySelector(ou(w));if(_)return r.state.loading|=4,r.instance=_,Jn(_),_;g=uy(c),(w=pr.get(w))&&o0(g,w),_=(n.ownerDocument||n).createElement("link"),Jn(_);var D=_;return D._p=new Promise(function(U,re){D.onload=U,D.onerror=re}),ni(_,"link",g),r.state.loading|=4,Qh(_,c.precedence,n),r.instance=_;case"script":return _=Jl(c.src),(w=n.querySelector(lu(_)))?(r.instance=w,Jn(w),w):(g=c,(w=pr.get(_))&&(g=I({},c),l0(g,w)),n=n.ownerDocument||n,w=n.createElement("script"),Jn(w),ni(w,"link",g),n.head.appendChild(w),r.instance=w);case"void":return null;default:throw Error(a(443,r.type))}else r.type==="stylesheet"&&(r.state.loading&4)===0&&(g=r.instance,r.state.loading|=4,Qh(g,c.precedence,n));return r.instance}function Qh(n,r,c){for(var g=c.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),w=g.length?g[g.length-1]:null,_=w,D=0;D<g.length;D++){var U=g[D];if(U.dataset.precedence===r)_=U;else if(_!==w)break}_?_.parentNode.insertBefore(n,_.nextSibling):(r=c.nodeType===9?c.head:c,r.insertBefore(n,r.firstChild))}function o0(n,r){n.crossOrigin==null&&(n.crossOrigin=r.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=r.referrerPolicy),n.title==null&&(n.title=r.title)}function l0(n,r){n.crossOrigin==null&&(n.crossOrigin=r.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=r.referrerPolicy),n.integrity==null&&(n.integrity=r.integrity)}var Zh=null;function dy(n,r,c){if(Zh===null){var g=new Map,w=Zh=new Map;w.set(c,g)}else w=Zh,g=w.get(c),g||(g=new Map,w.set(c,g));if(g.has(n))return g;for(g.set(n,null),c=c.getElementsByTagName(n),w=0;w<c.length;w++){var _=c[w];if(!(_[Ti]||_[yt]||n==="link"&&_.getAttribute("rel")==="stylesheet")&&_.namespaceURI!=="http://www.w3.org/2000/svg"){var D=_.getAttribute(r)||"";D=n+D;var U=g.get(D);U?U.push(_):g.set(D,[_])}}return g}function fy(n,r,c){n=n.ownerDocument||n,n.head.insertBefore(c,r==="title"?n.querySelector("head > title"):null)}function eA(n,r,c){if(c===1||r.itemProp!=null)return!1;switch(n){case"meta":case"title":return!0;case"style":if(typeof r.precedence!="string"||typeof r.href!="string"||r.href==="")break;return!0;case"link":if(typeof r.rel!="string"||typeof r.href!="string"||r.href===""||r.onLoad||r.onError)break;return r.rel==="stylesheet"?(n=r.disabled,typeof r.precedence=="string"&&n==null):!0;case"script":if(r.async&&typeof r.async!="function"&&typeof r.async!="symbol"&&!r.onLoad&&!r.onError&&r.src&&typeof r.src=="string")return!0}return!1}function my(n){return!(n.type==="stylesheet"&&(n.state.loading&3)===0)}function tA(n,r,c,g){if(c.type==="stylesheet"&&(typeof g.media!="string"||matchMedia(g.media).matches!==!1)&&(c.state.loading&4)===0){if(c.instance===null){var w=$l(g.href),_=r.querySelector(ou(w));if(_){r=_._p,r!==null&&typeof r=="object"&&typeof r.then=="function"&&(n.count++,n=$h.bind(n),r.then(n,n)),c.state.loading|=4,c.instance=_,Jn(_);return}_=r.ownerDocument||r,g=uy(g),(w=pr.get(w))&&o0(g,w),_=_.createElement("link"),Jn(_);var D=_;D._p=new Promise(function(U,re){D.onload=U,D.onerror=re}),ni(_,"link",g),c.instance=_}n.stylesheets===null&&(n.stylesheets=new Map),n.stylesheets.set(c,r),(r=c.state.preload)&&(c.state.loading&3)===0&&(n.count++,c=$h.bind(n),r.addEventListener("load",c),r.addEventListener("error",c))}}var c0=0;function nA(n,r){return n.stylesheets&&n.count===0&&ed(n,n.stylesheets),0<n.count||0<n.imgCount?function(c){var g=setTimeout(function(){if(n.stylesheets&&ed(n,n.stylesheets),n.unsuspend){var _=n.unsuspend;n.unsuspend=null,_()}},6e4+r);0<n.imgBytes&&c0===0&&(c0=62500*L_());var w=setTimeout(function(){if(n.waitingForImages=!1,n.count===0&&(n.stylesheets&&ed(n,n.stylesheets),n.unsuspend)){var _=n.unsuspend;n.unsuspend=null,_()}},(n.imgBytes>c0?50:800)+r);return n.unsuspend=c,function(){n.unsuspend=null,clearTimeout(g),clearTimeout(w)}}:null}function $h(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)ed(this,this.stylesheets);else if(this.unsuspend){var n=this.unsuspend;this.unsuspend=null,n()}}}var Jh=null;function ed(n,r){n.stylesheets=null,n.unsuspend!==null&&(n.count++,Jh=new Map,r.forEach(sA,n),Jh=null,$h.call(n))}function sA(n,r){if(!(r.state.loading&4)){var c=Jh.get(n);if(c)var g=c.get(null);else{c=new Map,Jh.set(n,c);for(var w=n.querySelectorAll("link[data-precedence],style[data-precedence]"),_=0;_<w.length;_++){var D=w[_];(D.nodeName==="LINK"||D.getAttribute("media")!=="not all")&&(c.set(D.dataset.precedence,D),g=D)}g&&c.set(null,g)}w=r.instance,D=w.getAttribute("data-precedence"),_=c.get(D)||g,_===g&&c.set(null,w),c.set(D,w),this.count++,g=$h.bind(this),w.addEventListener("load",g),w.addEventListener("error",g),_?_.parentNode.insertBefore(w,_.nextSibling):(n=n.nodeType===9?n.head:n,n.insertBefore(w,n.firstChild)),r.state.loading|=4}}var cu={$$typeof:ue,Provider:null,Consumer:null,_currentValue:He,_currentValue2:He,_threadCount:0};function iA(n,r,c,g,w,_,D,U,re){this.tag=1,this.containerInfo=n,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=as(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=as(0),this.hiddenUpdates=as(null),this.identifierPrefix=g,this.onUncaughtError=w,this.onCaughtError=_,this.onRecoverableError=D,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=re,this.incompleteTransitions=new Map}function gy(n,r,c,g,w,_,D,U,re,Ae,Be,ze){return n=new iA(n,r,c,D,re,Ae,Be,ze,U),r=1,_===!0&&(r|=24),_=Wi(3,null,null,r),n.current=_,_.stateNode=n,r=zf(),r.refCount++,n.pooledCache=r,r.refCount++,_.memoizedState={element:g,isDehydrated:c,cache:r},Wf(_),n}function py(n){return n?(n=Rl,n):Rl}function yy(n,r,c,g,w,_){w=py(w),g.context===null?g.context=w:g.pendingContext=w,g=so(r),g.payload={element:c},_=_===void 0?null:_,_!==null&&(g.callback=_),c=io(n,g,r),c!==null&&(Li(c,n,r),Uc(c,n,r))}function xy(n,r){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var c=n.retryLane;n.retryLane=c!==0&&c<r?c:r}}function u0(n,r){xy(n,r),(n=n.alternate)&&xy(n,r)}function vy(n){if(n.tag===13||n.tag===31){var r=Zo(n,67108864);r!==null&&Li(r,n,67108864),u0(n,67108864)}}function wy(n){if(n.tag===13||n.tag===31){var r=Zi();r=$(r);var c=Zo(n,r);c!==null&&Li(c,n,r),u0(n,r)}}var td=!0;function rA(n,r,c,g){var w=te.T;te.T=null;var _=ge.p;try{ge.p=2,h0(n,r,c,g)}finally{ge.p=_,te.T=w}}function aA(n,r,c,g){var w=te.T;te.T=null;var _=ge.p;try{ge.p=8,h0(n,r,c,g)}finally{ge.p=_,te.T=w}}function h0(n,r,c,g){if(td){var w=d0(g);if(w===null)Z1(n,r,g,nd,c),Ey(n,g);else if(lA(w,n,r,c,g))g.stopPropagation();else if(Ey(n,g),r&4&&-1<oA.indexOf(n)){for(;w!==null;){var _=Ht(w);if(_!==null)switch(_.tag){case 3:if(_=_.stateNode,_.current.memoizedState.isDehydrated){var D=Hs(_.pendingLanes);if(D!==0){var U=_;for(U.pendingLanes|=2,U.entangledLanes|=2;D;){var re=1<<31-Ct(D);U.entanglements[1]|=re,D&=~re}Wr(_),(Sn&6)===0&&(Bh=ot()+500,su(0))}}break;case 31:case 13:U=Zo(_,2),U!==null&&Li(U,_,2),Fh(),u0(_,2)}if(_=d0(g),_===null&&Z1(n,r,g,nd,c),_===w)break;w=_}w!==null&&g.stopPropagation()}else Z1(n,r,g,null,c)}}function d0(n){return n=Ni(n),f0(n)}var nd=null;function f0(n){if(nd=null,n=pt(n),n!==null){var r=f(n);if(r===null)n=null;else{var c=r.tag;if(c===13){if(n=y(r),n!==null)return n;n=null}else if(c===31){if(n=A(r),n!==null)return n;n=null}else if(c===3){if(r.stateNode.current.memoizedState.isDehydrated)return r.tag===3?r.stateNode.containerInfo:null;n=null}else r!==n&&(n=null)}}return nd=n,null}function by(n){switch(n){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(xn()){case jn:return 2;case Zn:return 8;case Vn:case vn:return 32;case xs:return 268435456;default:return 32}default:return 32}}var m0=!1,po=null,yo=null,xo=null,uu=new Map,hu=new Map,vo=[],oA="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Ey(n,r){switch(n){case"focusin":case"focusout":po=null;break;case"dragenter":case"dragleave":yo=null;break;case"mouseover":case"mouseout":xo=null;break;case"pointerover":case"pointerout":uu.delete(r.pointerId);break;case"gotpointercapture":case"lostpointercapture":hu.delete(r.pointerId)}}function du(n,r,c,g,w,_){return n===null||n.nativeEvent!==_?(n={blockedOn:r,domEventName:c,eventSystemFlags:g,nativeEvent:_,targetContainers:[w]},r!==null&&(r=Ht(r),r!==null&&vy(r)),n):(n.eventSystemFlags|=g,r=n.targetContainers,w!==null&&r.indexOf(w)===-1&&r.push(w),n)}function lA(n,r,c,g,w){switch(r){case"focusin":return po=du(po,n,r,c,g,w),!0;case"dragenter":return yo=du(yo,n,r,c,g,w),!0;case"mouseover":return xo=du(xo,n,r,c,g,w),!0;case"pointerover":var _=w.pointerId;return uu.set(_,du(uu.get(_)||null,n,r,c,g,w)),!0;case"gotpointercapture":return _=w.pointerId,hu.set(_,du(hu.get(_)||null,n,r,c,g,w)),!0}return!1}function _y(n){var r=pt(n.target);if(r!==null){var c=f(r);if(c!==null){if(r=c.tag,r===13){if(r=y(c),r!==null){n.blockedOn=r,Re(n.priority,function(){wy(c)});return}}else if(r===31){if(r=A(c),r!==null){n.blockedOn=r,Re(n.priority,function(){wy(c)});return}}else if(r===3&&c.stateNode.current.memoizedState.isDehydrated){n.blockedOn=c.tag===3?c.stateNode.containerInfo:null;return}}}n.blockedOn=null}function sd(n){if(n.blockedOn!==null)return!1;for(var r=n.targetContainers;0<r.length;){var c=d0(n.nativeEvent);if(c===null){c=n.nativeEvent;var g=new c.constructor(c.type,c);ta=g,c.target.dispatchEvent(g),ta=null}else return r=Ht(c),r!==null&&vy(r),n.blockedOn=c,!1;r.shift()}return!0}function Ay(n,r,c){sd(n)&&c.delete(r)}function cA(){m0=!1,po!==null&&sd(po)&&(po=null),yo!==null&&sd(yo)&&(yo=null),xo!==null&&sd(xo)&&(xo=null),uu.forEach(Ay),hu.forEach(Ay)}function id(n,r){n.blockedOn===r&&(n.blockedOn=null,m0||(m0=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,cA)))}var rd=null;function Cy(n){rd!==n&&(rd=n,i.unstable_scheduleCallback(i.unstable_NormalPriority,function(){rd===n&&(rd=null);for(var r=0;r<n.length;r+=3){var c=n[r],g=n[r+1],w=n[r+2];if(typeof g!="function"){if(f0(g||c)===null)continue;break}var _=Ht(c);_!==null&&(n.splice(r,3),r-=3,d1(_,{pending:!0,data:w,method:c.method,action:g},g,w))}}))}function ec(n){function r(re){return id(re,n)}po!==null&&id(po,n),yo!==null&&id(yo,n),xo!==null&&id(xo,n),uu.forEach(r),hu.forEach(r);for(var c=0;c<vo.length;c++){var g=vo[c];g.blockedOn===n&&(g.blockedOn=null)}for(;0<vo.length&&(c=vo[0],c.blockedOn===null);)_y(c),c.blockedOn===null&&vo.shift();if(c=(n.ownerDocument||n).$$reactFormReplay,c!=null)for(g=0;g<c.length;g+=3){var w=c[g],_=c[g+1],D=w[bt]||null;if(typeof _=="function")D||Cy(c);else if(D){var U=null;if(_&&_.hasAttribute("formAction")){if(w=_,D=_[bt]||null)U=D.formAction;else if(f0(w)!==null)continue}else U=D.action;typeof U=="function"?c[g+1]=U:(c.splice(g,3),g-=3),Cy(c)}}}function Ty(){function n(_){_.canIntercept&&_.info==="react-transition"&&_.intercept({handler:function(){return new Promise(function(D){return w=D})},focusReset:"manual",scroll:"manual"})}function r(){w!==null&&(w(),w=null),g||setTimeout(c,20)}function c(){if(!g&&!navigation.transition){var _=navigation.currentEntry;_&&_.url!=null&&navigation.navigate(_.url,{state:_.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var g=!1,w=null;return navigation.addEventListener("navigate",n),navigation.addEventListener("navigatesuccess",r),navigation.addEventListener("navigateerror",r),setTimeout(c,100),function(){g=!0,navigation.removeEventListener("navigate",n),navigation.removeEventListener("navigatesuccess",r),navigation.removeEventListener("navigateerror",r),w!==null&&(w(),w=null)}}}function g0(n){this._internalRoot=n}ad.prototype.render=g0.prototype.render=function(n){var r=this._internalRoot;if(r===null)throw Error(a(409));var c=r.current,g=Zi();yy(c,g,n,r,null,null)},ad.prototype.unmount=g0.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var r=n.containerInfo;yy(n.current,2,null,n,null,null),Fh(),r[Gn]=null}};function ad(n){this._internalRoot=n}ad.prototype.unstable_scheduleHydration=function(n){if(n){var r=Ke();n={blockedOn:null,target:n,priority:r};for(var c=0;c<vo.length&&r!==0&&r<vo[c].priority;c++);vo.splice(c,0,n),c===0&&_y(n)}};var Sy=e.version;if(Sy!=="19.2.4")throw Error(a(527,Sy,"19.2.4"));ge.findDOMNode=function(n){var r=n._reactInternals;if(r===void 0)throw typeof n.render=="function"?Error(a(188)):(n=Object.keys(n).join(","),Error(a(268,n)));return n=E(r),n=n!==null?S(n):null,n=n===null?null:n.stateNode,n};var uA={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:te,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var od=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!od.isDisabled&&od.supportsFiber)try{Qt=od.inject(uA),We=od}catch{}}return mu.createRoot=function(n,r){if(!h(n))throw Error(a(299));var c=!1,g="",w=Op,_=jp,D=Lp;return r!=null&&(r.unstable_strictMode===!0&&(c=!0),r.identifierPrefix!==void 0&&(g=r.identifierPrefix),r.onUncaughtError!==void 0&&(w=r.onUncaughtError),r.onCaughtError!==void 0&&(_=r.onCaughtError),r.onRecoverableError!==void 0&&(D=r.onRecoverableError)),r=gy(n,1,!1,null,null,c,g,null,w,_,D,Ty),n[Gn]=r.current,Q1(n),new g0(r)},mu.hydrateRoot=function(n,r,c){if(!h(n))throw Error(a(299));var g=!1,w="",_=Op,D=jp,U=Lp,re=null;return c!=null&&(c.unstable_strictMode===!0&&(g=!0),c.identifierPrefix!==void 0&&(w=c.identifierPrefix),c.onUncaughtError!==void 0&&(_=c.onUncaughtError),c.onCaughtError!==void 0&&(D=c.onCaughtError),c.onRecoverableError!==void 0&&(U=c.onRecoverableError),c.formState!==void 0&&(re=c.formState)),r=gy(n,1,!0,r,c??null,g,w,re,_,D,U,Ty),r.context=py(null),c=r.current,g=Zi(),g=$(g),w=so(g),w.callback=null,io(c,w,g),c=g,r.current.lanes=c,fs(r,c),Wr(r),n[Gn]=r.current,Q1(n),new ad(r)},mu.version="19.2.4",mu}var Py;function wA(){if(Py)return x0.exports;Py=1;function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(e){console.error(e)}}return i(),x0.exports=vA(),x0.exports}var bA=wA();var By="popstate";function EA(i={}){function e(a,h){let{pathname:f,search:y,hash:A}=a.location;return H0("",{pathname:f,search:y,hash:A},h.state&&h.state.usr||null,h.state&&h.state.key||"default")}function t(a,h){return typeof h=="string"?h:ku(h)}return AA(e,t,null,i)}function rs(i,e){if(i===!1||i===null||typeof i>"u")throw new Error(e)}function Mr(i,e){if(!i){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function _A(){return Math.random().toString(36).substring(2,10)}function Vy(i,e){return{usr:i.state,key:i.key,idx:e}}function H0(i,e,t=null,a){return{pathname:typeof i=="string"?i:i.pathname,search:"",hash:"",...typeof e=="string"?Ec(e):e,state:t,key:e&&e.key||a||_A()}}function ku({pathname:i="/",search:e="",hash:t=""}){return e&&e!=="?"&&(i+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(i+=t.charAt(0)==="#"?t:"#"+t),i}function Ec(i){let e={};if(i){let t=i.indexOf("#");t>=0&&(e.hash=i.substring(t),i=i.substring(0,t));let a=i.indexOf("?");a>=0&&(e.search=i.substring(a),i=i.substring(0,a)),i&&(e.pathname=i)}return e}function AA(i,e,t,a={}){let{window:h=document.defaultView,v5Compat:f=!1}=a,y=h.history,A="POP",C=null,E=S();E==null&&(E=0,y.replaceState({...y.state,idx:E},""));function S(){return(y.state||{idx:null}).idx}function I(){A="POP";let J=S(),ae=J==null?null:J-E;E=J,C&&C({action:A,location:G.location,delta:ae})}function j(J,ae){A="PUSH";let ne=H0(G.location,J,ae);E=S()+1;let ue=Vy(ne,E),be=G.createHref(ne);try{y.pushState(ue,"",be)}catch(Me){if(Me instanceof DOMException&&Me.name==="DataCloneError")throw Me;h.location.assign(be)}f&&C&&C({action:A,location:G.location,delta:1})}function Y(J,ae){A="REPLACE";let ne=H0(G.location,J,ae);E=S();let ue=Vy(ne,E),be=G.createHref(ne);y.replaceState(ue,"",be),f&&C&&C({action:A,location:G.location,delta:0})}function X(J){return CA(J)}let G={get action(){return A},get location(){return i(h,y)},listen(J){if(C)throw new Error("A history only accepts one active listener");return h.addEventListener(By,I),C=J,()=>{h.removeEventListener(By,I),C=null}},createHref(J){return e(h,J)},createURL:X,encodeLocation(J){let ae=X(J);return{pathname:ae.pathname,search:ae.search,hash:ae.hash}},push:j,replace:Y,go(J){return y.go(J)}};return G}function CA(i,e=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),rs(t,"No window.location.(origin|href) available to create URL");let a=typeof i=="string"?i:ku(i);return a=a.replace(/ $/,"%20"),!e&&a.startsWith("//")&&(a=t+a),new URL(a,t)}function zv(i,e,t="/"){return TA(i,e,t,!1)}function TA(i,e,t,a){let h=typeof e=="string"?Ec(e):e,f=La(h.pathname||"/",t);if(f==null)return null;let y=Hv(i);SA(y);let A=null;for(let C=0;A==null&&C<y.length;++C){let E=BA(f);A=LA(y[C],E,a)}return A}function Hv(i,e=[],t=[],a="",h=!1){let f=(y,A,C=h,E)=>{let S={relativePath:E===void 0?y.path||"":E,caseSensitive:y.caseSensitive===!0,childrenIndex:A,route:y};if(S.relativePath.startsWith("/")){if(!S.relativePath.startsWith(a)&&C)return;rs(S.relativePath.startsWith(a),`Absolute route path "${S.relativePath}" nested under path "${a}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),S.relativePath=S.relativePath.slice(a.length)}let I=ka([a,S.relativePath]),j=t.concat(S);y.children&&y.children.length>0&&(rs(y.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${I}".`),Hv(y.children,e,j,I,C)),!(y.path==null&&!y.index)&&e.push({path:I,score:OA(I,y.index),routesMeta:j})};return i.forEach((y,A)=>{if(y.path===""||!y.path?.includes("?"))f(y,A);else for(let C of Gv(y.path))f(y,A,!0,C)}),e}function Gv(i){let e=i.split("/");if(e.length===0)return[];let[t,...a]=e,h=t.endsWith("?"),f=t.replace(/\?$/,"");if(a.length===0)return h?[f,""]:[f];let y=Gv(a.join("/")),A=[];return A.push(...y.map(C=>C===""?f:[f,C].join("/"))),h&&A.push(...y),A.map(C=>i.startsWith("/")&&C===""?"/":C)}function SA(i){i.sort((e,t)=>e.score!==t.score?t.score-e.score:jA(e.routesMeta.map(a=>a.childrenIndex),t.routesMeta.map(a=>a.childrenIndex)))}var NA=/^:[\w-]+$/,IA=3,RA=2,DA=1,kA=10,MA=-2,Fy=i=>i==="*";function OA(i,e){let t=i.split("/"),a=t.length;return t.some(Fy)&&(a+=MA),e&&(a+=RA),t.filter(h=>!Fy(h)).reduce((h,f)=>h+(NA.test(f)?IA:f===""?DA:kA),a)}function jA(i,e){return i.length===e.length&&i.slice(0,-1).every((a,h)=>a===e[h])?i[i.length-1]-e[e.length-1]:0}function LA(i,e,t=!1){let{routesMeta:a}=i,h={},f="/",y=[];for(let A=0;A<a.length;++A){let C=a[A],E=A===a.length-1,S=f==="/"?e:e.slice(f.length)||"/",I=kd({path:C.relativePath,caseSensitive:C.caseSensitive,end:E},S),j=C.route;if(!I&&E&&t&&!a[a.length-1].route.index&&(I=kd({path:C.relativePath,caseSensitive:C.caseSensitive,end:!1},S)),!I)return null;Object.assign(h,I.params),y.push({params:h,pathname:ka([f,I.pathname]),pathnameBase:zA(ka([f,I.pathnameBase])),route:j}),I.pathnameBase!=="/"&&(f=ka([f,I.pathnameBase]))}return y}function kd(i,e){typeof i=="string"&&(i={path:i,caseSensitive:!1,end:!0});let[t,a]=PA(i.path,i.caseSensitive,i.end),h=e.match(t);if(!h)return null;let f=h[0],y=f.replace(/(.)\/+$/,"$1"),A=h.slice(1);return{params:a.reduce((E,{paramName:S,isOptional:I},j)=>{if(S==="*"){let X=A[j]||"";y=f.slice(0,f.length-X.length).replace(/(.)\/+$/,"$1")}const Y=A[j];return I&&!Y?E[S]=void 0:E[S]=(Y||"").replace(/%2F/g,"/"),E},{}),pathname:f,pathnameBase:y,pattern:i}}function PA(i,e=!1,t=!0){Mr(i==="*"||!i.endsWith("*")||i.endsWith("/*"),`Route path "${i}" will be treated as if it were "${i.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${i.replace(/\*$/,"/*")}".`);let a=[],h="^"+i.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(y,A,C)=>(a.push({paramName:A,isOptional:C!=null}),C?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return i.endsWith("*")?(a.push({paramName:"*"}),h+=i==="*"||i==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?h+="\\/*$":i!==""&&i!=="/"&&(h+="(?:(?=\\/|$))"),[new RegExp(h,e?void 0:"i"),a]}function BA(i){try{return i.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Mr(!1,`The URL path "${i}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),i}}function La(i,e){if(e==="/")return i;if(!i.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,a=i.charAt(t);return a&&a!=="/"?null:i.slice(t)||"/"}var VA=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i;function FA(i,e="/"){let{pathname:t,search:a="",hash:h=""}=typeof i=="string"?Ec(i):i,f;return t?(t=t.replace(/\/\/+/g,"/"),t.startsWith("/")?f=Uy(t.substring(1),"/"):f=Uy(t,e)):f=e,{pathname:f,search:HA(a),hash:GA(h)}}function Uy(i,e){let t=e.replace(/\/+$/,"").split("/");return i.split("/").forEach(h=>{h===".."?t.length>1&&t.pop():h!=="."&&t.push(h)}),t.length>1?t.join("/"):"/"}function E0(i,e,t,a){return`Cannot include a '${i}' character in a manually specified \`to.${e}\` field [${JSON.stringify(a)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function UA(i){return i.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function Am(i){let e=UA(i);return e.map((t,a)=>a===e.length-1?t.pathname:t.pathnameBase)}function Cm(i,e,t,a=!1){let h;typeof i=="string"?h=Ec(i):(h={...i},rs(!h.pathname||!h.pathname.includes("?"),E0("?","pathname","search",h)),rs(!h.pathname||!h.pathname.includes("#"),E0("#","pathname","hash",h)),rs(!h.search||!h.search.includes("#"),E0("#","search","hash",h)));let f=i===""||h.pathname==="",y=f?"/":h.pathname,A;if(y==null)A=t;else{let I=e.length-1;if(!a&&y.startsWith("..")){let j=y.split("/");for(;j[0]==="..";)j.shift(),I-=1;h.pathname=j.join("/")}A=I>=0?e[I]:"/"}let C=FA(h,A),E=y&&y!=="/"&&y.endsWith("/"),S=(f||y===".")&&t.endsWith("/");return!C.pathname.endsWith("/")&&(E||S)&&(C.pathname+="/"),C}var ka=i=>i.join("/").replace(/\/\/+/g,"/"),zA=i=>i.replace(/\/+$/,"").replace(/^\/*/,"/"),HA=i=>!i||i==="?"?"":i.startsWith("?")?i:"?"+i,GA=i=>!i||i==="#"?"":i.startsWith("#")?i:"#"+i,qA=class{constructor(i,e,t,a=!1){this.status=i,this.statusText=e||"",this.internal=a,t instanceof Error?(this.data=t.toString(),this.error=t):this.data=t}};function WA(i){return i!=null&&typeof i.status=="number"&&typeof i.statusText=="string"&&typeof i.internal=="boolean"&&"data"in i}function YA(i){return i.map(e=>e.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var qv=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function Wv(i,e){let t=i;if(typeof t!="string"||!VA.test(t))return{absoluteURL:void 0,isExternal:!1,to:t};let a=t,h=!1;if(qv)try{let f=new URL(window.location.href),y=t.startsWith("//")?new URL(f.protocol+t):new URL(t),A=La(y.pathname,e);y.origin===f.origin&&A!=null?t=A+y.search+y.hash:h=!0}catch{Mr(!1,`<Link to="${t}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:a,isExternal:h,to:t}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var Yv=["POST","PUT","PATCH","DELETE"];new Set(Yv);var XA=["GET",...Yv];new Set(XA);var _c=H.createContext(null);_c.displayName="DataRouter";var af=H.createContext(null);af.displayName="DataRouterState";var KA=H.createContext(!1),Xv=H.createContext({isTransitioning:!1});Xv.displayName="ViewTransition";var QA=H.createContext(new Map);QA.displayName="Fetchers";var ZA=H.createContext(null);ZA.displayName="Await";var tr=H.createContext(null);tr.displayName="Navigation";var Gu=H.createContext(null);Gu.displayName="Location";var ea=H.createContext({outlet:null,matches:[],isDataRoute:!1});ea.displayName="Route";var Tm=H.createContext(null);Tm.displayName="RouteError";var Kv="REACT_ROUTER_ERROR",$A="REDIRECT",JA="ROUTE_ERROR_RESPONSE";function eC(i){if(i.startsWith(`${Kv}:${$A}:{`))try{let e=JSON.parse(i.slice(28));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.location=="string"&&typeof e.reloadDocument=="boolean"&&typeof e.replace=="boolean")return e}catch{}}function tC(i){if(i.startsWith(`${Kv}:${JA}:{`))try{let e=JSON.parse(i.slice(40));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string")return new qA(e.status,e.statusText,e.data)}catch{}}function nC(i,{relative:e}={}){rs(Ac(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:a}=H.useContext(tr),{hash:h,pathname:f,search:y}=qu(i,{relative:e}),A=f;return t!=="/"&&(A=f==="/"?t:ka([t,f])),a.createHref({pathname:A,search:y,hash:h})}function Ac(){return H.useContext(Gu)!=null}function Ua(){return rs(Ac(),"useLocation() may be used only in the context of a <Router> component."),H.useContext(Gu).location}var Qv="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function Zv(i){H.useContext(tr).static||H.useLayoutEffect(i)}function ai(){let{isDataRoute:i}=H.useContext(ea);return i?gC():sC()}function sC(){rs(Ac(),"useNavigate() may be used only in the context of a <Router> component.");let i=H.useContext(_c),{basename:e,navigator:t}=H.useContext(tr),{matches:a}=H.useContext(ea),{pathname:h}=Ua(),f=JSON.stringify(Am(a)),y=H.useRef(!1);return Zv(()=>{y.current=!0}),H.useCallback((C,E={})=>{if(Mr(y.current,Qv),!y.current)return;if(typeof C=="number"){t.go(C);return}let S=Cm(C,JSON.parse(f),h,E.relative==="path");i==null&&e!=="/"&&(S.pathname=S.pathname==="/"?e:ka([e,S.pathname])),(E.replace?t.replace:t.push)(S,E.state,E)},[e,t,f,h,i])}H.createContext(null);function qu(i,{relative:e}={}){let{matches:t}=H.useContext(ea),{pathname:a}=Ua(),h=JSON.stringify(Am(t));return H.useMemo(()=>Cm(i,JSON.parse(h),a,e==="path"),[i,h,a,e])}function iC(i,e){return $v(i,e)}function $v(i,e,t,a,h){rs(Ac(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:f}=H.useContext(tr),{matches:y}=H.useContext(ea),A=y[y.length-1],C=A?A.params:{},E=A?A.pathname:"/",S=A?A.pathnameBase:"/",I=A&&A.route;{let ne=I&&I.path||"";ew(E,!I||ne.endsWith("*")||ne.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${E}" (under <Route path="${ne}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${ne}"> to <Route path="${ne==="/"?"*":`${ne}/*`}">.`)}let j=Ua(),Y;if(e){let ne=typeof e=="string"?Ec(e):e;rs(S==="/"||ne.pathname?.startsWith(S),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${S}" but pathname "${ne.pathname}" was given in the \`location\` prop.`),Y=ne}else Y=j;let X=Y.pathname||"/",G=X;if(S!=="/"){let ne=S.replace(/^\//,"").split("/");G="/"+X.replace(/^\//,"").split("/").slice(ne.length).join("/")}let J=zv(i,{pathname:G});Mr(I||J!=null,`No routes matched location "${Y.pathname}${Y.search}${Y.hash}" `),Mr(J==null||J[J.length-1].route.element!==void 0||J[J.length-1].route.Component!==void 0||J[J.length-1].route.lazy!==void 0,`Matched leaf route at location "${Y.pathname}${Y.search}${Y.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let ae=cC(J&&J.map(ne=>Object.assign({},ne,{params:Object.assign({},C,ne.params),pathname:ka([S,f.encodeLocation?f.encodeLocation(ne.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:ne.pathname]),pathnameBase:ne.pathnameBase==="/"?S:ka([S,f.encodeLocation?f.encodeLocation(ne.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:ne.pathnameBase])})),y,t,a,h);return e&&ae?H.createElement(Gu.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...Y},navigationType:"POP"}},ae):ae}function rC(){let i=mC(),e=WA(i)?`${i.status} ${i.statusText}`:i instanceof Error?i.message:JSON.stringify(i),t=i instanceof Error?i.stack:null,a="rgba(200,200,200, 0.5)",h={padding:"0.5rem",backgroundColor:a},f={padding:"2px 4px",backgroundColor:a},y=null;return console.error("Error handled by React Router default ErrorBoundary:",i),y=H.createElement(H.Fragment,null,H.createElement("p",null," Hey developer "),H.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",H.createElement("code",{style:f},"ErrorBoundary")," or"," ",H.createElement("code",{style:f},"errorElement")," prop on your route.")),H.createElement(H.Fragment,null,H.createElement("h2",null,"Unexpected Application Error!"),H.createElement("h3",{style:{fontStyle:"italic"}},e),t?H.createElement("pre",{style:h},t):null,y)}var aC=H.createElement(rC,null),Jv=class extends H.Component{constructor(i){super(i),this.state={location:i.location,revalidation:i.revalidation,error:i.error}}static getDerivedStateFromError(i){return{error:i}}static getDerivedStateFromProps(i,e){return e.location!==i.location||e.revalidation!=="idle"&&i.revalidation==="idle"?{error:i.error,location:i.location,revalidation:i.revalidation}:{error:i.error!==void 0?i.error:e.error,location:e.location,revalidation:i.revalidation||e.revalidation}}componentDidCatch(i,e){this.props.onError?this.props.onError(i,e):console.error("React Router caught the following error during render",i)}render(){let i=this.state.error;if(this.context&&typeof i=="object"&&i&&"digest"in i&&typeof i.digest=="string"){const t=tC(i.digest);t&&(i=t)}let e=i!==void 0?H.createElement(ea.Provider,{value:this.props.routeContext},H.createElement(Tm.Provider,{value:i,children:this.props.component})):this.props.children;return this.context?H.createElement(oC,{error:i},e):e}};Jv.contextType=KA;var _0=new WeakMap;function oC({children:i,error:e}){let{basename:t}=H.useContext(tr);if(typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){let a=eC(e.digest);if(a){let h=_0.get(e);if(h)throw h;let f=Wv(a.location,t);if(qv&&!_0.get(e))if(f.isExternal||a.reloadDocument)window.location.href=f.absoluteURL||f.to;else{const y=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(f.to,{replace:a.replace}));throw _0.set(e,y),y}return H.createElement("meta",{httpEquiv:"refresh",content:`0;url=${f.absoluteURL||f.to}`})}}return i}function lC({routeContext:i,match:e,children:t}){let a=H.useContext(_c);return a&&a.static&&a.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=e.route.id),H.createElement(ea.Provider,{value:i},t)}function cC(i,e=[],t=null,a=null,h=null){if(i==null){if(!t)return null;if(t.errors)i=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)i=t.matches;else return null}let f=i,y=t?.errors;if(y!=null){let S=f.findIndex(I=>I.route.id&&y?.[I.route.id]!==void 0);rs(S>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(y).join(",")}`),f=f.slice(0,Math.min(f.length,S+1))}let A=!1,C=-1;if(t)for(let S=0;S<f.length;S++){let I=f[S];if((I.route.HydrateFallback||I.route.hydrateFallbackElement)&&(C=S),I.route.id){let{loaderData:j,errors:Y}=t,X=I.route.loader&&!j.hasOwnProperty(I.route.id)&&(!Y||Y[I.route.id]===void 0);if(I.route.lazy||X){A=!0,C>=0?f=f.slice(0,C+1):f=[f[0]];break}}}let E=t&&a?(S,I)=>{a(S,{location:t.location,params:t.matches?.[0]?.params??{},unstable_pattern:YA(t.matches),errorInfo:I})}:void 0;return f.reduceRight((S,I,j)=>{let Y,X=!1,G=null,J=null;t&&(Y=y&&I.route.id?y[I.route.id]:void 0,G=I.route.errorElement||aC,A&&(C<0&&j===0?(ew("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),X=!0,J=null):C===j&&(X=!0,J=I.route.hydrateFallbackElement||null)));let ae=e.concat(f.slice(0,j+1)),ne=()=>{let ue;return Y?ue=G:X?ue=J:I.route.Component?ue=H.createElement(I.route.Component,null):I.route.element?ue=I.route.element:ue=S,H.createElement(lC,{match:I,routeContext:{outlet:S,matches:ae,isDataRoute:t!=null},children:ue})};return t&&(I.route.ErrorBoundary||I.route.errorElement||j===0)?H.createElement(Jv,{location:t.location,revalidation:t.revalidation,component:G,error:Y,children:ne(),routeContext:{outlet:null,matches:ae,isDataRoute:!0},onError:E}):ne()},null)}function Sm(i){return`${i} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function uC(i){let e=H.useContext(_c);return rs(e,Sm(i)),e}function hC(i){let e=H.useContext(af);return rs(e,Sm(i)),e}function dC(i){let e=H.useContext(ea);return rs(e,Sm(i)),e}function Nm(i){let e=dC(i),t=e.matches[e.matches.length-1];return rs(t.route.id,`${i} can only be used on routes that contain a unique "id"`),t.route.id}function fC(){return Nm("useRouteId")}function mC(){let i=H.useContext(Tm),e=hC("useRouteError"),t=Nm("useRouteError");return i!==void 0?i:e.errors?.[t]}function gC(){let{router:i}=uC("useNavigate"),e=Nm("useNavigate"),t=H.useRef(!1);return Zv(()=>{t.current=!0}),H.useCallback(async(h,f={})=>{Mr(t.current,Qv),t.current&&(typeof h=="number"?await i.navigate(h):await i.navigate(h,{fromRouteId:e,...f}))},[i,e])}var zy={};function ew(i,e,t){!e&&!zy[i]&&(zy[i]=!0,Mr(!1,t))}H.memo(pC);function pC({routes:i,future:e,state:t,onError:a}){return $v(i,void 0,t,a,e)}function yC({to:i,replace:e,state:t,relative:a}){rs(Ac(),"<Navigate> may be used only in the context of a <Router> component.");let{static:h}=H.useContext(tr);Mr(!h,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:f}=H.useContext(ea),{pathname:y}=Ua(),A=ai(),C=Cm(i,Am(f),y,a==="path"),E=JSON.stringify(C);return H.useEffect(()=>{A(JSON.parse(E),{replace:e,state:t,relative:a})},[A,E,a,e,t]),null}function mi(i){rs(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function xC({basename:i="/",children:e=null,location:t,navigationType:a="POP",navigator:h,static:f=!1,unstable_useTransitions:y}){rs(!Ac(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let A=i.replace(/^\/*/,"/"),C=H.useMemo(()=>({basename:A,navigator:h,static:f,unstable_useTransitions:y,future:{}}),[A,h,f,y]);typeof t=="string"&&(t=Ec(t));let{pathname:E="/",search:S="",hash:I="",state:j=null,key:Y="default"}=t,X=H.useMemo(()=>{let G=La(E,A);return G==null?null:{location:{pathname:G,search:S,hash:I,state:j,key:Y},navigationType:a}},[A,E,S,I,j,Y,a]);return Mr(X!=null,`<Router basename="${A}"> is not able to match the URL "${E}${S}${I}" because it does not start with the basename, so the <Router> won't render anything.`),X==null?null:H.createElement(tr.Provider,{value:C},H.createElement(Gu.Provider,{children:e,value:X}))}function vC({children:i,location:e}){return iC(G0(i),e)}function G0(i,e=[]){let t=[];return H.Children.forEach(i,(a,h)=>{if(!H.isValidElement(a))return;let f=[...e,h];if(a.type===H.Fragment){t.push.apply(t,G0(a.props.children,f));return}rs(a.type===mi,`[${typeof a.type=="string"?a.type:a.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),rs(!a.props.index||!a.props.children,"An index route cannot have child routes.");let y={id:a.props.id||f.join("-"),caseSensitive:a.props.caseSensitive,element:a.props.element,Component:a.props.Component,index:a.props.index,path:a.props.path,middleware:a.props.middleware,loader:a.props.loader,action:a.props.action,hydrateFallbackElement:a.props.hydrateFallbackElement,HydrateFallback:a.props.HydrateFallback,errorElement:a.props.errorElement,ErrorBoundary:a.props.ErrorBoundary,hasErrorBoundary:a.props.hasErrorBoundary===!0||a.props.ErrorBoundary!=null||a.props.errorElement!=null,shouldRevalidate:a.props.shouldRevalidate,handle:a.props.handle,lazy:a.props.lazy};a.props.children&&(y.children=G0(a.props.children,f)),t.push(y)}),t}var xd="get",vd="application/x-www-form-urlencoded";function of(i){return typeof HTMLElement<"u"&&i instanceof HTMLElement}function wC(i){return of(i)&&i.tagName.toLowerCase()==="button"}function bC(i){return of(i)&&i.tagName.toLowerCase()==="form"}function EC(i){return of(i)&&i.tagName.toLowerCase()==="input"}function _C(i){return!!(i.metaKey||i.altKey||i.ctrlKey||i.shiftKey)}function AC(i,e){return i.button===0&&(!e||e==="_self")&&!_C(i)}var cd=null;function CC(){if(cd===null)try{new FormData(document.createElement("form"),0),cd=!1}catch{cd=!0}return cd}var TC=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function A0(i){return i!=null&&!TC.has(i)?(Mr(!1,`"${i}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${vd}"`),null):i}function SC(i,e){let t,a,h,f,y;if(bC(i)){let A=i.getAttribute("action");a=A?La(A,e):null,t=i.getAttribute("method")||xd,h=A0(i.getAttribute("enctype"))||vd,f=new FormData(i)}else if(wC(i)||EC(i)&&(i.type==="submit"||i.type==="image")){let A=i.form;if(A==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let C=i.getAttribute("formaction")||A.getAttribute("action");if(a=C?La(C,e):null,t=i.getAttribute("formmethod")||A.getAttribute("method")||xd,h=A0(i.getAttribute("formenctype"))||A0(A.getAttribute("enctype"))||vd,f=new FormData(A,i),!CC()){let{name:E,type:S,value:I}=i;if(S==="image"){let j=E?`${E}.`:"";f.append(`${j}x`,"0"),f.append(`${j}y`,"0")}else E&&f.append(E,I)}}else{if(of(i))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=xd,a=null,h=vd,y=i}return f&&h==="text/plain"&&(y=f,f=void 0),{action:a,method:t.toLowerCase(),encType:h,formData:f,body:y}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function Im(i,e){if(i===!1||i===null||typeof i>"u")throw new Error(e)}function NC(i,e,t,a){let h=typeof i=="string"?new URL(i,typeof window>"u"?"server://singlefetch/":window.location.origin):i;return t?h.pathname.endsWith("/")?h.pathname=`${h.pathname}_.${a}`:h.pathname=`${h.pathname}.${a}`:h.pathname==="/"?h.pathname=`_root.${a}`:e&&La(h.pathname,e)==="/"?h.pathname=`${e.replace(/\/$/,"")}/_root.${a}`:h.pathname=`${h.pathname.replace(/\/$/,"")}.${a}`,h}async function IC(i,e){if(i.id in e)return e[i.id];try{let t=await import(i.module);return e[i.id]=t,t}catch(t){return console.error(`Error loading route module \`${i.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function RC(i){return i==null?!1:i.href==null?i.rel==="preload"&&typeof i.imageSrcSet=="string"&&typeof i.imageSizes=="string":typeof i.rel=="string"&&typeof i.href=="string"}async function DC(i,e,t){let a=await Promise.all(i.map(async h=>{let f=e.routes[h.route.id];if(f){let y=await IC(f,t);return y.links?y.links():[]}return[]}));return jC(a.flat(1).filter(RC).filter(h=>h.rel==="stylesheet"||h.rel==="preload").map(h=>h.rel==="stylesheet"?{...h,rel:"prefetch",as:"style"}:{...h,rel:"prefetch"}))}function Hy(i,e,t,a,h,f){let y=(C,E)=>t[E]?C.route.id!==t[E].route.id:!0,A=(C,E)=>t[E].pathname!==C.pathname||t[E].route.path?.endsWith("*")&&t[E].params["*"]!==C.params["*"];return f==="assets"?e.filter((C,E)=>y(C,E)||A(C,E)):f==="data"?e.filter((C,E)=>{let S=a.routes[C.route.id];if(!S||!S.hasLoader)return!1;if(y(C,E)||A(C,E))return!0;if(C.route.shouldRevalidate){let I=C.route.shouldRevalidate({currentUrl:new URL(h.pathname+h.search+h.hash,window.origin),currentParams:t[0]?.params||{},nextUrl:new URL(i,window.origin),nextParams:C.params,defaultShouldRevalidate:!0});if(typeof I=="boolean")return I}return!0}):[]}function kC(i,e,{includeHydrateFallback:t}={}){return MC(i.map(a=>{let h=e.routes[a.route.id];if(!h)return[];let f=[h.module];return h.clientActionModule&&(f=f.concat(h.clientActionModule)),h.clientLoaderModule&&(f=f.concat(h.clientLoaderModule)),t&&h.hydrateFallbackModule&&(f=f.concat(h.hydrateFallbackModule)),h.imports&&(f=f.concat(h.imports)),f}).flat(1))}function MC(i){return[...new Set(i)]}function OC(i){let e={},t=Object.keys(i).sort();for(let a of t)e[a]=i[a];return e}function jC(i,e){let t=new Set;return new Set(e),i.reduce((a,h)=>{let f=JSON.stringify(OC(h));return t.has(f)||(t.add(f),a.push({key:f,link:h})),a},[])}function tw(){let i=H.useContext(_c);return Im(i,"You must render this element inside a <DataRouterContext.Provider> element"),i}function LC(){let i=H.useContext(af);return Im(i,"You must render this element inside a <DataRouterStateContext.Provider> element"),i}var Rm=H.createContext(void 0);Rm.displayName="FrameworkContext";function nw(){let i=H.useContext(Rm);return Im(i,"You must render this element inside a <HydratedRouter> element"),i}function PC(i,e){let t=H.useContext(Rm),[a,h]=H.useState(!1),[f,y]=H.useState(!1),{onFocus:A,onBlur:C,onMouseEnter:E,onMouseLeave:S,onTouchStart:I}=e,j=H.useRef(null);H.useEffect(()=>{if(i==="render"&&y(!0),i==="viewport"){let G=ae=>{ae.forEach(ne=>{y(ne.isIntersecting)})},J=new IntersectionObserver(G,{threshold:.5});return j.current&&J.observe(j.current),()=>{J.disconnect()}}},[i]),H.useEffect(()=>{if(a){let G=setTimeout(()=>{y(!0)},100);return()=>{clearTimeout(G)}}},[a]);let Y=()=>{h(!0)},X=()=>{h(!1),y(!1)};return t?i!=="intent"?[f,j,{}]:[f,j,{onFocus:gu(A,Y),onBlur:gu(C,X),onMouseEnter:gu(E,Y),onMouseLeave:gu(S,X),onTouchStart:gu(I,Y)}]:[!1,j,{}]}function gu(i,e){return t=>{i&&i(t),t.defaultPrevented||e(t)}}function BC({page:i,...e}){let{router:t}=tw(),a=H.useMemo(()=>zv(t.routes,i,t.basename),[t.routes,i,t.basename]);return a?H.createElement(FC,{page:i,matches:a,...e}):null}function VC(i){let{manifest:e,routeModules:t}=nw(),[a,h]=H.useState([]);return H.useEffect(()=>{let f=!1;return DC(i,e,t).then(y=>{f||h(y)}),()=>{f=!0}},[i,e,t]),a}function FC({page:i,matches:e,...t}){let a=Ua(),{future:h,manifest:f,routeModules:y}=nw(),{basename:A}=tw(),{loaderData:C,matches:E}=LC(),S=H.useMemo(()=>Hy(i,e,E,f,a,"data"),[i,e,E,f,a]),I=H.useMemo(()=>Hy(i,e,E,f,a,"assets"),[i,e,E,f,a]),j=H.useMemo(()=>{if(i===a.pathname+a.search+a.hash)return[];let G=new Set,J=!1;if(e.forEach(ne=>{let ue=f.routes[ne.route.id];!ue||!ue.hasLoader||(!S.some(be=>be.route.id===ne.route.id)&&ne.route.id in C&&y[ne.route.id]?.shouldRevalidate||ue.hasClientLoader?J=!0:G.add(ne.route.id))}),G.size===0)return[];let ae=NC(i,A,h.unstable_trailingSlashAwareDataRequests,"data");return J&&G.size>0&&ae.searchParams.set("_routes",e.filter(ne=>G.has(ne.route.id)).map(ne=>ne.route.id).join(",")),[ae.pathname+ae.search]},[A,h.unstable_trailingSlashAwareDataRequests,C,a,f,S,e,i,y]),Y=H.useMemo(()=>kC(I,f),[I,f]),X=VC(I);return H.createElement(H.Fragment,null,j.map(G=>H.createElement("link",{key:G,rel:"prefetch",as:"fetch",href:G,...t})),Y.map(G=>H.createElement("link",{key:G,rel:"modulepreload",href:G,...t})),X.map(({key:G,link:J})=>H.createElement("link",{key:G,nonce:t.nonce,...J,crossOrigin:J.crossOrigin??t.crossOrigin})))}function UC(...i){return e=>{i.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var zC=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{zC&&(window.__reactRouterVersion="7.13.0")}catch{}function HC({basename:i,children:e,unstable_useTransitions:t,window:a}){let h=H.useRef();h.current==null&&(h.current=EA({window:a,v5Compat:!0}));let f=h.current,[y,A]=H.useState({action:f.action,location:f.location}),C=H.useCallback(E=>{t===!1?A(E):H.startTransition(()=>A(E))},[t]);return H.useLayoutEffect(()=>f.listen(C),[f,C]),H.createElement(xC,{basename:i,children:e,location:y.location,navigationType:y.action,navigator:f,unstable_useTransitions:t})}var sw=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,iw=H.forwardRef(function({onClick:e,discover:t="render",prefetch:a="none",relative:h,reloadDocument:f,replace:y,state:A,target:C,to:E,preventScrollReset:S,viewTransition:I,unstable_defaultShouldRevalidate:j,...Y},X){let{basename:G,unstable_useTransitions:J}=H.useContext(tr),ae=typeof E=="string"&&sw.test(E),ne=Wv(E,G);E=ne.to;let ue=nC(E,{relative:h}),[be,Me,Ce]=PC(a,Y),P=YC(E,{replace:y,state:A,target:C,preventScrollReset:S,relative:h,viewTransition:I,unstable_defaultShouldRevalidate:j,unstable_useTransitions:J});function F(se){e&&e(se),se.defaultPrevented||P(se)}let B=H.createElement("a",{...Y,...Ce,href:ne.absoluteURL||ue,onClick:ne.isExternal||f?e:F,ref:UC(X,Me),target:C,"data-discover":!ae&&t==="render"?"true":void 0});return be&&!ae?H.createElement(H.Fragment,null,B,H.createElement(BC,{page:ue})):B});iw.displayName="Link";var GC=H.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:a="",end:h=!1,style:f,to:y,viewTransition:A,children:C,...E},S){let I=qu(y,{relative:E.relative}),j=Ua(),Y=H.useContext(af),{navigator:X,basename:G}=H.useContext(tr),J=Y!=null&&$C(I)&&A===!0,ae=X.encodeLocation?X.encodeLocation(I).pathname:I.pathname,ne=j.pathname,ue=Y&&Y.navigation&&Y.navigation.location?Y.navigation.location.pathname:null;t||(ne=ne.toLowerCase(),ue=ue?ue.toLowerCase():null,ae=ae.toLowerCase()),ue&&G&&(ue=La(ue,G)||ue);const be=ae!=="/"&&ae.endsWith("/")?ae.length-1:ae.length;let Me=ne===ae||!h&&ne.startsWith(ae)&&ne.charAt(be)==="/",Ce=ue!=null&&(ue===ae||!h&&ue.startsWith(ae)&&ue.charAt(ae.length)==="/"),P={isActive:Me,isPending:Ce,isTransitioning:J},F=Me?e:void 0,B;typeof a=="function"?B=a(P):B=[a,Me?"active":null,Ce?"pending":null,J?"transitioning":null].filter(Boolean).join(" ");let se=typeof f=="function"?f(P):f;return H.createElement(iw,{...E,"aria-current":F,className:B,ref:S,style:se,to:y,viewTransition:A},typeof C=="function"?C(P):C)});GC.displayName="NavLink";var qC=H.forwardRef(({discover:i="render",fetcherKey:e,navigate:t,reloadDocument:a,replace:h,state:f,method:y=xd,action:A,onSubmit:C,relative:E,preventScrollReset:S,viewTransition:I,unstable_defaultShouldRevalidate:j,...Y},X)=>{let{unstable_useTransitions:G}=H.useContext(tr),J=QC(),ae=ZC(A,{relative:E}),ne=y.toLowerCase()==="get"?"get":"post",ue=typeof A=="string"&&sw.test(A),be=Me=>{if(C&&C(Me),Me.defaultPrevented)return;Me.preventDefault();let Ce=Me.nativeEvent.submitter,P=Ce?.getAttribute("formmethod")||y,F=()=>J(Ce||Me.currentTarget,{fetcherKey:e,method:P,navigate:t,replace:h,state:f,relative:E,preventScrollReset:S,viewTransition:I,unstable_defaultShouldRevalidate:j});G&&t!==!1?H.startTransition(()=>F()):F()};return H.createElement("form",{ref:X,method:ne,action:ae,onSubmit:a?C:be,...Y,"data-discover":!ue&&i==="render"?"true":void 0})});qC.displayName="Form";function WC(i){return`${i} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function rw(i){let e=H.useContext(_c);return rs(e,WC(i)),e}function YC(i,{target:e,replace:t,state:a,preventScrollReset:h,relative:f,viewTransition:y,unstable_defaultShouldRevalidate:A,unstable_useTransitions:C}={}){let E=ai(),S=Ua(),I=qu(i,{relative:f});return H.useCallback(j=>{if(AC(j,e)){j.preventDefault();let Y=t!==void 0?t:ku(S)===ku(I),X=()=>E(i,{replace:Y,state:a,preventScrollReset:h,relative:f,viewTransition:y,unstable_defaultShouldRevalidate:A});C?H.startTransition(()=>X()):X()}},[S,E,I,t,a,e,i,h,f,y,A,C])}var XC=0,KC=()=>`__${String(++XC)}__`;function QC(){let{router:i}=rw("useSubmit"),{basename:e}=H.useContext(tr),t=fC(),a=i.fetch,h=i.navigate;return H.useCallback(async(f,y={})=>{let{action:A,method:C,encType:E,formData:S,body:I}=SC(f,e);if(y.navigate===!1){let j=y.fetcherKey||KC();await a(j,t,y.action||A,{unstable_defaultShouldRevalidate:y.unstable_defaultShouldRevalidate,preventScrollReset:y.preventScrollReset,formData:S,body:I,formMethod:y.method||C,formEncType:y.encType||E,flushSync:y.flushSync})}else await h(y.action||A,{unstable_defaultShouldRevalidate:y.unstable_defaultShouldRevalidate,preventScrollReset:y.preventScrollReset,formData:S,body:I,formMethod:y.method||C,formEncType:y.encType||E,replace:y.replace,state:y.state,fromRouteId:t,flushSync:y.flushSync,viewTransition:y.viewTransition})},[a,h,e,t])}function ZC(i,{relative:e}={}){let{basename:t}=H.useContext(tr),a=H.useContext(ea);rs(a,"useFormAction must be used inside a RouteContext");let[h]=a.matches.slice(-1),f={...qu(i||".",{relative:e})},y=Ua();if(i==null){f.search=y.search;let A=new URLSearchParams(f.search),C=A.getAll("index");if(C.some(S=>S==="")){A.delete("index"),C.filter(I=>I).forEach(I=>A.append("index",I));let S=A.toString();f.search=S?`?${S}`:""}}return(!i||i===".")&&h.route.index&&(f.search=f.search?f.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(f.pathname=f.pathname==="/"?t:ka([t,f.pathname])),ku(f)}function $C(i,{relative:e}={}){let t=H.useContext(Xv);rs(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:a}=rw("useViewTransitionState"),h=qu(i,{relative:e});if(!t.isTransitioning)return!1;let f=La(t.currentLocation.pathname,a)||t.currentLocation.pathname,y=La(t.nextLocation.pathname,a)||t.nextLocation.pathname;return kd(h.pathname,y)!=null||kd(h.pathname,f)!=null}const JC=()=>{};var Gy={};const aw=function(i){const e=[];let t=0;for(let a=0;a<i.length;a++){let h=i.charCodeAt(a);h<128?e[t++]=h:h<2048?(e[t++]=h>>6|192,e[t++]=h&63|128):(h&64512)===55296&&a+1<i.length&&(i.charCodeAt(a+1)&64512)===56320?(h=65536+((h&1023)<<10)+(i.charCodeAt(++a)&1023),e[t++]=h>>18|240,e[t++]=h>>12&63|128,e[t++]=h>>6&63|128,e[t++]=h&63|128):(e[t++]=h>>12|224,e[t++]=h>>6&63|128,e[t++]=h&63|128)}return e},eT=function(i){const e=[];let t=0,a=0;for(;t<i.length;){const h=i[t++];if(h<128)e[a++]=String.fromCharCode(h);else if(h>191&&h<224){const f=i[t++];e[a++]=String.fromCharCode((h&31)<<6|f&63)}else if(h>239&&h<365){const f=i[t++],y=i[t++],A=i[t++],C=((h&7)<<18|(f&63)<<12|(y&63)<<6|A&63)-65536;e[a++]=String.fromCharCode(55296+(C>>10)),e[a++]=String.fromCharCode(56320+(C&1023))}else{const f=i[t++],y=i[t++];e[a++]=String.fromCharCode((h&15)<<12|(f&63)<<6|y&63)}}return e.join("")},ow={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(i,e){if(!Array.isArray(i))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,a=[];for(let h=0;h<i.length;h+=3){const f=i[h],y=h+1<i.length,A=y?i[h+1]:0,C=h+2<i.length,E=C?i[h+2]:0,S=f>>2,I=(f&3)<<4|A>>4;let j=(A&15)<<2|E>>6,Y=E&63;C||(Y=64,y||(j=64)),a.push(t[S],t[I],t[j],t[Y])}return a.join("")},encodeString(i,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(i):this.encodeByteArray(aw(i),e)},decodeString(i,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(i):eT(this.decodeStringToByteArray(i,e))},decodeStringToByteArray(i,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,a=[];for(let h=0;h<i.length;){const f=t[i.charAt(h++)],A=h<i.length?t[i.charAt(h)]:0;++h;const E=h<i.length?t[i.charAt(h)]:64;++h;const I=h<i.length?t[i.charAt(h)]:64;if(++h,f==null||A==null||E==null||I==null)throw new tT;const j=f<<2|A>>4;if(a.push(j),E!==64){const Y=A<<4&240|E>>2;if(a.push(Y),I!==64){const X=E<<6&192|I;a.push(X)}}}return a},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let i=0;i<this.ENCODED_VALS.length;i++)this.byteToCharMap_[i]=this.ENCODED_VALS.charAt(i),this.charToByteMap_[this.byteToCharMap_[i]]=i,this.byteToCharMapWebSafe_[i]=this.ENCODED_VALS_WEBSAFE.charAt(i),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[i]]=i,i>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(i)]=i,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(i)]=i)}}};class tT extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const nT=function(i){const e=aw(i);return ow.encodeByteArray(e,!0)},Md=function(i){return nT(i).replace(/\./g,"")},lw=function(i){try{return ow.decodeString(i,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function sT(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const iT=()=>sT().__FIREBASE_DEFAULTS__,rT=()=>{if(typeof process>"u"||typeof Gy>"u")return;const i=Gy.__FIREBASE_DEFAULTS__;if(i)return JSON.parse(i)},aT=()=>{if(typeof document>"u")return;let i;try{i=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=i&&lw(i[1]);return e&&JSON.parse(e)},lf=()=>{try{return JC()||iT()||rT()||aT()}catch(i){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${i}`);return}},cw=i=>lf()?.emulatorHosts?.[i],oT=i=>{const e=cw(i);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const a=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),a]:[e.substring(0,t),a]},uw=()=>lf()?.config,hw=i=>lf()?.[`_${i}`];class lT{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,a)=>{t?this.reject(t):this.resolve(a),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,a))}}}function Cc(i){try{return(i.startsWith("http://")||i.startsWith("https://")?new URL(i).hostname:i).endsWith(".cloudworkstations.dev")}catch{return!1}}async function dw(i){return(await fetch(i,{credentials:"include"})).ok}function cT(i,e){if(i.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},a=e||"demo-project",h=i.iat||0,f=i.sub||i.user_id;if(!f)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const y={iss:`https://securetoken.google.com/${a}`,aud:a,iat:h,exp:h+3600,auth_time:h,sub:f,user_id:f,firebase:{sign_in_provider:"custom",identities:{}},...i};return[Md(JSON.stringify(t)),Md(JSON.stringify(y)),""].join(".")}const Tu={};function uT(){const i={prod:[],emulator:[]};for(const e of Object.keys(Tu))Tu[e]?i.emulator.push(e):i.prod.push(e);return i}function hT(i){let e=document.getElementById(i),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",i),t=!0),{created:t,element:e}}let qy=!1;function fw(i,e){if(typeof window>"u"||typeof document>"u"||!Cc(window.location.host)||Tu[i]===e||Tu[i]||qy)return;Tu[i]=e;function t(j){return`__firebase__banner__${j}`}const a="__firebase__banner",f=uT().prod.length>0;function y(){const j=document.getElementById(a);j&&j.remove()}function A(j){j.style.display="flex",j.style.background="#7faaf0",j.style.position="fixed",j.style.bottom="5px",j.style.left="5px",j.style.padding=".5em",j.style.borderRadius="5px",j.style.alignItems="center"}function C(j,Y){j.setAttribute("width","24"),j.setAttribute("id",Y),j.setAttribute("height","24"),j.setAttribute("viewBox","0 0 24 24"),j.setAttribute("fill","none"),j.style.marginLeft="-6px"}function E(){const j=document.createElement("span");return j.style.cursor="pointer",j.style.marginLeft="16px",j.style.fontSize="24px",j.innerHTML=" &times;",j.onclick=()=>{qy=!0,y()},j}function S(j,Y){j.setAttribute("id",Y),j.innerText="Learn more",j.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",j.setAttribute("target","__blank"),j.style.paddingLeft="5px",j.style.textDecoration="underline"}function I(){const j=hT(a),Y=t("text"),X=document.getElementById(Y)||document.createElement("span"),G=t("learnmore"),J=document.getElementById(G)||document.createElement("a"),ae=t("preprendIcon"),ne=document.getElementById(ae)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(j.created){const ue=j.element;A(ue),S(J,G);const be=E();C(ne,ae),ue.append(ne,X,J,be),document.body.appendChild(ue)}f?(X.innerText="Preview backend disconnected.",ne.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(ne.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,X.innerText="Preview backend running in this workspace."),X.setAttribute("id",Y)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",I):I()}function yi(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function dT(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(yi())}function fT(){const i=lf()?.forceEnvironment;if(i==="node")return!0;if(i==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function mT(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function gT(){const i=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof i=="object"&&i.id!==void 0}function pT(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function yT(){const i=yi();return i.indexOf("MSIE ")>=0||i.indexOf("Trident/")>=0}function xT(){return!fT()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function vT(){try{return typeof indexedDB=="object"}catch{return!1}}function wT(){return new Promise((i,e)=>{try{let t=!0;const a="validate-browser-context-for-indexeddb-analytics-module",h=self.indexedDB.open(a);h.onsuccess=()=>{h.result.close(),t||self.indexedDB.deleteDatabase(a),i(!0)},h.onupgradeneeded=()=>{t=!1},h.onerror=()=>{e(h.error?.message||"")}}catch(t){e(t)}})}const bT="FirebaseError";class za extends Error{constructor(e,t,a){super(t),this.code=e,this.customData=a,this.name=bT,Object.setPrototypeOf(this,za.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Wu.prototype.create)}}class Wu{constructor(e,t,a){this.service=e,this.serviceName=t,this.errors=a}create(e,...t){const a=t[0]||{},h=`${this.service}/${e}`,f=this.errors[e],y=f?ET(f,a):"Error",A=`${this.serviceName}: ${y} (${h}).`;return new za(h,A,a)}}function ET(i,e){return i.replace(_T,(t,a)=>{const h=e[a];return h!=null?String(h):`<${a}?>`})}const _T=/\{\$([^}]+)}/g;function AT(i){for(const e in i)if(Object.prototype.hasOwnProperty.call(i,e))return!1;return!0}function ml(i,e){if(i===e)return!0;const t=Object.keys(i),a=Object.keys(e);for(const h of t){if(!a.includes(h))return!1;const f=i[h],y=e[h];if(Wy(f)&&Wy(y)){if(!ml(f,y))return!1}else if(f!==y)return!1}for(const h of a)if(!t.includes(h))return!1;return!0}function Wy(i){return i!==null&&typeof i=="object"}function Yu(i){const e=[];for(const[t,a]of Object.entries(i))Array.isArray(a)?a.forEach(h=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(h))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(a));return e.length?"&"+e.join("&"):""}function vu(i){const e={};return i.replace(/^\?/,"").split("&").forEach(a=>{if(a){const[h,f]=a.split("=");e[decodeURIComponent(h)]=decodeURIComponent(f)}}),e}function wu(i){const e=i.indexOf("?");if(!e)return"";const t=i.indexOf("#",e);return i.substring(e,t>0?t:void 0)}function CT(i,e){const t=new TT(i,e);return t.subscribe.bind(t)}class TT{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(a=>{this.error(a)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,a){let h;if(e===void 0&&t===void 0&&a===void 0)throw new Error("Missing Observer.");ST(e,["next","error","complete"])?h=e:h={next:e,error:t,complete:a},h.next===void 0&&(h.next=C0),h.error===void 0&&(h.error=C0),h.complete===void 0&&(h.complete=C0);const f=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?h.error(this.finalError):h.complete()}catch{}}),this.observers.push(h),f}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(a){typeof console<"u"&&console.error&&console.error(a)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function ST(i,e){if(typeof i!="object"||i===null)return!1;for(const t of e)if(t in i&&typeof i[t]=="function")return!0;return!1}function C0(){}function zs(i){return i&&i._delegate?i._delegate:i}class gl{constructor(e,t,a){this.name=e,this.instanceFactory=t,this.type=a,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const hl="[DEFAULT]";class NT{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const a=new lT;if(this.instancesDeferred.set(t,a),this.isInitialized(t)||this.shouldAutoInitialize())try{const h=this.getOrInitializeService({instanceIdentifier:t});h&&a.resolve(h)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),a=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(h){if(a)return null;throw h}else{if(a)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(RT(e))try{this.getOrInitializeService({instanceIdentifier:hl})}catch{}for(const[t,a]of this.instancesDeferred.entries()){const h=this.normalizeInstanceIdentifier(t);try{const f=this.getOrInitializeService({instanceIdentifier:h});a.resolve(f)}catch{}}}}clearInstance(e=hl){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=hl){return this.instances.has(e)}getOptions(e=hl){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,a=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(a))throw Error(`${this.name}(${a}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const h=this.getOrInitializeService({instanceIdentifier:a,options:t});for(const[f,y]of this.instancesDeferred.entries()){const A=this.normalizeInstanceIdentifier(f);a===A&&y.resolve(h)}return h}onInit(e,t){const a=this.normalizeInstanceIdentifier(t),h=this.onInitCallbacks.get(a)??new Set;h.add(e),this.onInitCallbacks.set(a,h);const f=this.instances.get(a);return f&&e(f,a),()=>{h.delete(e)}}invokeOnInitCallbacks(e,t){const a=this.onInitCallbacks.get(t);if(a)for(const h of a)try{h(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let a=this.instances.get(e);if(!a&&this.component&&(a=this.component.instanceFactory(this.container,{instanceIdentifier:IT(e),options:t}),this.instances.set(e,a),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(a,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,a)}catch{}return a||null}normalizeInstanceIdentifier(e=hl){return this.component?this.component.multipleInstances?e:hl:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function IT(i){return i===hl?void 0:i}function RT(i){return i.instantiationMode==="EAGER"}class DT{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new NT(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}var un;(function(i){i[i.DEBUG=0]="DEBUG",i[i.VERBOSE=1]="VERBOSE",i[i.INFO=2]="INFO",i[i.WARN=3]="WARN",i[i.ERROR=4]="ERROR",i[i.SILENT=5]="SILENT"})(un||(un={}));const kT={debug:un.DEBUG,verbose:un.VERBOSE,info:un.INFO,warn:un.WARN,error:un.ERROR,silent:un.SILENT},MT=un.INFO,OT={[un.DEBUG]:"log",[un.VERBOSE]:"log",[un.INFO]:"info",[un.WARN]:"warn",[un.ERROR]:"error"},jT=(i,e,...t)=>{if(e<i.logLevel)return;const a=new Date().toISOString(),h=OT[e];if(h)console[h](`[${a}]  ${i.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Dm{constructor(e){this.name=e,this._logLevel=MT,this._logHandler=jT,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in un))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?kT[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,un.DEBUG,...e),this._logHandler(this,un.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,un.VERBOSE,...e),this._logHandler(this,un.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,un.INFO,...e),this._logHandler(this,un.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,un.WARN,...e),this._logHandler(this,un.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,un.ERROR,...e),this._logHandler(this,un.ERROR,...e)}}const LT=(i,e)=>e.some(t=>i instanceof t);let Yy,Xy;function PT(){return Yy||(Yy=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function BT(){return Xy||(Xy=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const mw=new WeakMap,q0=new WeakMap,gw=new WeakMap,T0=new WeakMap,km=new WeakMap;function VT(i){const e=new Promise((t,a)=>{const h=()=>{i.removeEventListener("success",f),i.removeEventListener("error",y)},f=()=>{t(So(i.result)),h()},y=()=>{a(i.error),h()};i.addEventListener("success",f),i.addEventListener("error",y)});return e.then(t=>{t instanceof IDBCursor&&mw.set(t,i)}).catch(()=>{}),km.set(e,i),e}function FT(i){if(q0.has(i))return;const e=new Promise((t,a)=>{const h=()=>{i.removeEventListener("complete",f),i.removeEventListener("error",y),i.removeEventListener("abort",y)},f=()=>{t(),h()},y=()=>{a(i.error||new DOMException("AbortError","AbortError")),h()};i.addEventListener("complete",f),i.addEventListener("error",y),i.addEventListener("abort",y)});q0.set(i,e)}let W0={get(i,e,t){if(i instanceof IDBTransaction){if(e==="done")return q0.get(i);if(e==="objectStoreNames")return i.objectStoreNames||gw.get(i);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return So(i[e])},set(i,e,t){return i[e]=t,!0},has(i,e){return i instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in i}};function UT(i){W0=i(W0)}function zT(i){return i===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const a=i.call(S0(this),e,...t);return gw.set(a,e.sort?e.sort():[e]),So(a)}:BT().includes(i)?function(...e){return i.apply(S0(this),e),So(mw.get(this))}:function(...e){return So(i.apply(S0(this),e))}}function HT(i){return typeof i=="function"?zT(i):(i instanceof IDBTransaction&&FT(i),LT(i,PT())?new Proxy(i,W0):i)}function So(i){if(i instanceof IDBRequest)return VT(i);if(T0.has(i))return T0.get(i);const e=HT(i);return e!==i&&(T0.set(i,e),km.set(e,i)),e}const S0=i=>km.get(i);function GT(i,e,{blocked:t,upgrade:a,blocking:h,terminated:f}={}){const y=indexedDB.open(i,e),A=So(y);return a&&y.addEventListener("upgradeneeded",C=>{a(So(y.result),C.oldVersion,C.newVersion,So(y.transaction),C)}),t&&y.addEventListener("blocked",C=>t(C.oldVersion,C.newVersion,C)),A.then(C=>{f&&C.addEventListener("close",()=>f()),h&&C.addEventListener("versionchange",E=>h(E.oldVersion,E.newVersion,E))}).catch(()=>{}),A}const qT=["get","getKey","getAll","getAllKeys","count"],WT=["put","add","delete","clear"],N0=new Map;function Ky(i,e){if(!(i instanceof IDBDatabase&&!(e in i)&&typeof e=="string"))return;if(N0.get(e))return N0.get(e);const t=e.replace(/FromIndex$/,""),a=e!==t,h=WT.includes(t);if(!(t in(a?IDBIndex:IDBObjectStore).prototype)||!(h||qT.includes(t)))return;const f=async function(y,...A){const C=this.transaction(y,h?"readwrite":"readonly");let E=C.store;return a&&(E=E.index(A.shift())),(await Promise.all([E[t](...A),h&&C.done]))[0]};return N0.set(e,f),f}UT(i=>({...i,get:(e,t,a)=>Ky(e,t)||i.get(e,t,a),has:(e,t)=>!!Ky(e,t)||i.has(e,t)}));class YT{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(XT(t)){const a=t.getImmediate();return`${a.library}/${a.version}`}else return null}).filter(t=>t).join(" ")}}function XT(i){return i.getComponent()?.type==="VERSION"}const Y0="@firebase/app",Qy="0.14.7";const Pa=new Dm("@firebase/app"),KT="@firebase/app-compat",QT="@firebase/analytics-compat",ZT="@firebase/analytics",$T="@firebase/app-check-compat",JT="@firebase/app-check",eS="@firebase/auth",tS="@firebase/auth-compat",nS="@firebase/database",sS="@firebase/data-connect",iS="@firebase/database-compat",rS="@firebase/functions",aS="@firebase/functions-compat",oS="@firebase/installations",lS="@firebase/installations-compat",cS="@firebase/messaging",uS="@firebase/messaging-compat",hS="@firebase/performance",dS="@firebase/performance-compat",fS="@firebase/remote-config",mS="@firebase/remote-config-compat",gS="@firebase/storage",pS="@firebase/storage-compat",yS="@firebase/firestore",xS="@firebase/ai",vS="@firebase/firestore-compat",wS="firebase",bS="12.8.0";const X0="[DEFAULT]",ES={[Y0]:"fire-core",[KT]:"fire-core-compat",[ZT]:"fire-analytics",[QT]:"fire-analytics-compat",[JT]:"fire-app-check",[$T]:"fire-app-check-compat",[eS]:"fire-auth",[tS]:"fire-auth-compat",[nS]:"fire-rtdb",[sS]:"fire-data-connect",[iS]:"fire-rtdb-compat",[rS]:"fire-fn",[aS]:"fire-fn-compat",[oS]:"fire-iid",[lS]:"fire-iid-compat",[cS]:"fire-fcm",[uS]:"fire-fcm-compat",[hS]:"fire-perf",[dS]:"fire-perf-compat",[fS]:"fire-rc",[mS]:"fire-rc-compat",[gS]:"fire-gcs",[pS]:"fire-gcs-compat",[yS]:"fire-fst",[vS]:"fire-fst-compat",[xS]:"fire-vertex","fire-js":"fire-js",[wS]:"fire-js-all"};const Od=new Map,_S=new Map,K0=new Map;function Zy(i,e){try{i.container.addComponent(e)}catch(t){Pa.debug(`Component ${e.name} failed to register with FirebaseApp ${i.name}`,t)}}function gc(i){const e=i.name;if(K0.has(e))return Pa.debug(`There were multiple attempts to register component ${e}.`),!1;K0.set(e,i);for(const t of Od.values())Zy(t,i);for(const t of _S.values())Zy(t,i);return!0}function Mm(i,e){const t=i.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),i.container.getProvider(e)}function yr(i){return i==null?!1:i.settings!==void 0}const AS={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},No=new Wu("app","Firebase",AS);class CS{constructor(e,t,a){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=a,this.container.addComponent(new gl("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw No.create("app-deleted",{appName:this._name})}}const Tc=bS;function Om(i,e={}){let t=i;typeof e!="object"&&(e={name:e});const a={name:X0,automaticDataCollectionEnabled:!0,...e},h=a.name;if(typeof h!="string"||!h)throw No.create("bad-app-name",{appName:String(h)});if(t||(t=uw()),!t)throw No.create("no-options");const f=Od.get(h);if(f){if(ml(t,f.options)&&ml(a,f.config))return f;throw No.create("duplicate-app",{appName:h})}const y=new DT(h);for(const C of K0.values())y.addComponent(C);const A=new CS(t,a,y);return Od.set(h,A),A}function pw(i=X0){const e=Od.get(i);if(!e&&i===X0&&uw())return Om();if(!e)throw No.create("no-app",{appName:i});return e}function Io(i,e,t){let a=ES[i]??i;t&&(a+=`-${t}`);const h=a.match(/\s|\//),f=e.match(/\s|\//);if(h||f){const y=[`Unable to register library "${a}" with version "${e}":`];h&&y.push(`library name "${a}" contains illegal characters (whitespace or "/")`),h&&f&&y.push("and"),f&&y.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Pa.warn(y.join(" "));return}gc(new gl(`${a}-version`,()=>({library:a,version:e}),"VERSION"))}const TS="firebase-heartbeat-database",SS=1,Mu="firebase-heartbeat-store";let I0=null;function yw(){return I0||(I0=GT(TS,SS,{upgrade:(i,e)=>{switch(e){case 0:try{i.createObjectStore(Mu)}catch(t){console.warn(t)}}}}).catch(i=>{throw No.create("idb-open",{originalErrorMessage:i.message})})),I0}async function NS(i){try{const t=(await yw()).transaction(Mu),a=await t.objectStore(Mu).get(xw(i));return await t.done,a}catch(e){if(e instanceof za)Pa.warn(e.message);else{const t=No.create("idb-get",{originalErrorMessage:e?.message});Pa.warn(t.message)}}}async function $y(i,e){try{const a=(await yw()).transaction(Mu,"readwrite");await a.objectStore(Mu).put(e,xw(i)),await a.done}catch(t){if(t instanceof za)Pa.warn(t.message);else{const a=No.create("idb-set",{originalErrorMessage:t?.message});Pa.warn(a.message)}}}function xw(i){return`${i.name}!${i.options.appId}`}const IS=1024,RS=30;class DS{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new MS(t),this._heartbeatsCachePromise=this._storage.read().then(a=>(this._heartbeatsCache=a,a))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),a=Jy();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===a||this._heartbeatsCache.heartbeats.some(h=>h.date===a))return;if(this._heartbeatsCache.heartbeats.push({date:a,agent:t}),this._heartbeatsCache.heartbeats.length>RS){const h=OS(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(h,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){Pa.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=Jy(),{heartbeatsToSend:t,unsentEntries:a}=kS(this._heartbeatsCache.heartbeats),h=Md(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,a.length>0?(this._heartbeatsCache.heartbeats=a,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),h}catch(e){return Pa.warn(e),""}}}function Jy(){return new Date().toISOString().substring(0,10)}function kS(i,e=IS){const t=[];let a=i.slice();for(const h of i){const f=t.find(y=>y.agent===h.agent);if(f){if(f.dates.push(h.date),ex(t)>e){f.dates.pop();break}}else if(t.push({agent:h.agent,dates:[h.date]}),ex(t)>e){t.pop();break}a=a.slice(1)}return{heartbeatsToSend:t,unsentEntries:a}}class MS{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return vT()?wT().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await NS(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const a=await this.read();return $y(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??a.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const a=await this.read();return $y(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??a.lastSentHeartbeatDate,heartbeats:[...a.heartbeats,...e.heartbeats]})}else return}}function ex(i){return Md(JSON.stringify({version:2,heartbeats:i})).length}function OS(i){if(i.length===0)return-1;let e=0,t=i[0].date;for(let a=1;a<i.length;a++)i[a].date<t&&(t=i[a].date,e=a);return e}function jS(i){gc(new gl("platform-logger",e=>new YT(e),"PRIVATE")),gc(new gl("heartbeat",e=>new DS(e),"PRIVATE")),Io(Y0,Qy,i),Io(Y0,Qy,"esm2020"),Io("fire-js","")}jS("");function vw(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const LS=vw,ww=new Wu("auth","Firebase",vw());const jd=new Dm("@firebase/auth");function PS(i,...e){jd.logLevel<=un.WARN&&jd.warn(`Auth (${Tc}): ${i}`,...e)}function wd(i,...e){jd.logLevel<=un.ERROR&&jd.error(`Auth (${Tc}): ${i}`,...e)}function Or(i,...e){throw jm(i,...e)}function Xr(i,...e){return jm(i,...e)}function bw(i,e,t){const a={...LS(),[e]:t};return new Wu("auth","Firebase",a).create(e,{appName:i.name})}function Ma(i){return bw(i,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function jm(i,...e){if(typeof i!="string"){const t=e[0],a=[...e.slice(1)];return a[0]&&(a[0].appName=i.name),i._errorFactory.create(t,...a)}return ww.create(i,...e)}function Rt(i,e,...t){if(!i)throw jm(e,...t)}function Ra(i){const e="INTERNAL ASSERTION FAILED: "+i;throw wd(e),new Error(e)}function Ba(i,e){i||Ra(e)}function Q0(){return typeof self<"u"&&self.location?.href||""}function BS(){return tx()==="http:"||tx()==="https:"}function tx(){return typeof self<"u"&&self.location?.protocol||null}function VS(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(BS()||gT()||"connection"in navigator)?navigator.onLine:!0}function FS(){if(typeof navigator>"u")return null;const i=navigator;return i.languages&&i.languages[0]||i.language||null}class Xu{constructor(e,t){this.shortDelay=e,this.longDelay=t,Ba(t>e,"Short delay should be less than long delay!"),this.isMobile=dT()||pT()}get(){return VS()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function Lm(i,e){Ba(i.emulator,"Emulator should always be set here");const{url:t}=i.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class Ew{static initialize(e,t,a){this.fetchImpl=e,t&&(this.headersImpl=t),a&&(this.responseImpl=a)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Ra("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Ra("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Ra("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const US={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const zS=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],HS=new Xu(3e4,6e4);function Ha(i,e){return i.tenantId&&!e.tenantId?{...e,tenantId:i.tenantId}:e}async function Ga(i,e,t,a,h={}){return _w(i,h,async()=>{let f={},y={};a&&(e==="GET"?y=a:f={body:JSON.stringify(a)});const A=Yu({key:i.config.apiKey,...y}).slice(1),C=await i._getAdditionalHeaders();C["Content-Type"]="application/json",i.languageCode&&(C["X-Firebase-Locale"]=i.languageCode);const E={method:e,headers:C,...f};return mT()||(E.referrerPolicy="no-referrer"),i.emulatorConfig&&Cc(i.emulatorConfig.host)&&(E.credentials="include"),Ew.fetch()(await Aw(i,i.config.apiHost,t,A),E)})}async function _w(i,e,t){i._canInitEmulator=!1;const a={...US,...e};try{const h=new qS(i),f=await Promise.race([t(),h.promise]);h.clearNetworkTimeout();const y=await f.json();if("needConfirmation"in y)throw ud(i,"account-exists-with-different-credential",y);if(f.ok&&!("errorMessage"in y))return y;{const A=f.ok?y.errorMessage:y.error.message,[C,E]=A.split(" : ");if(C==="FEDERATED_USER_ID_ALREADY_LINKED")throw ud(i,"credential-already-in-use",y);if(C==="EMAIL_EXISTS")throw ud(i,"email-already-in-use",y);if(C==="USER_DISABLED")throw ud(i,"user-disabled",y);const S=a[C]||C.toLowerCase().replace(/[_\s]+/g,"-");if(E)throw bw(i,S,E);Or(i,S)}}catch(h){if(h instanceof za)throw h;Or(i,"network-request-failed",{message:String(h)})}}async function Ku(i,e,t,a,h={}){const f=await Ga(i,e,t,a,h);return"mfaPendingCredential"in f&&Or(i,"multi-factor-auth-required",{_serverResponse:f}),f}async function Aw(i,e,t,a){const h=`${e}${t}?${a}`,f=i,y=f.config.emulator?Lm(i.config,h):`${i.config.apiScheme}://${h}`;return zS.includes(t)&&(await f._persistenceManagerAvailable,f._getPersistenceType()==="COOKIE")?f._getPersistence()._getFinalTarget(y).toString():y}function GS(i){switch(i){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class qS{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,a)=>{this.timer=setTimeout(()=>a(Xr(this.auth,"network-request-failed")),HS.get())})}}function ud(i,e,t){const a={appName:i.name};t.email&&(a.email=t.email),t.phoneNumber&&(a.phoneNumber=t.phoneNumber);const h=Xr(i,e,a);return h.customData._tokenResponse=t,h}function nx(i){return i!==void 0&&i.enterprise!==void 0}class WS{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return GS(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function YS(i,e){return Ga(i,"GET","/v2/recaptchaConfig",Ha(i,e))}async function XS(i,e){return Ga(i,"POST","/v1/accounts:delete",e)}async function Ld(i,e){return Ga(i,"POST","/v1/accounts:lookup",e)}function Su(i){if(i)try{const e=new Date(Number(i));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function KS(i,e=!1){const t=zs(i),a=await t.getIdToken(e),h=Pm(a);Rt(h&&h.exp&&h.auth_time&&h.iat,t.auth,"internal-error");const f=typeof h.firebase=="object"?h.firebase:void 0,y=f?.sign_in_provider;return{claims:h,token:a,authTime:Su(R0(h.auth_time)),issuedAtTime:Su(R0(h.iat)),expirationTime:Su(R0(h.exp)),signInProvider:y||null,signInSecondFactor:f?.sign_in_second_factor||null}}function R0(i){return Number(i)*1e3}function Pm(i){const[e,t,a]=i.split(".");if(e===void 0||t===void 0||a===void 0)return wd("JWT malformed, contained fewer than 3 sections"),null;try{const h=lw(t);return h?JSON.parse(h):(wd("Failed to decode base64 JWT payload"),null)}catch(h){return wd("Caught error parsing JWT payload as JSON",h?.toString()),null}}function sx(i){const e=Pm(i);return Rt(e,"internal-error"),Rt(typeof e.exp<"u","internal-error"),Rt(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function Ou(i,e,t=!1){if(t)return e;try{return await e}catch(a){throw a instanceof za&&QS(a)&&i.auth.currentUser===i&&await i.auth.signOut(),a}}function QS({code:i}){return i==="auth/user-disabled"||i==="auth/user-token-expired"}class ZS{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const a=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,a)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class Z0{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Su(this.lastLoginAt),this.creationTime=Su(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Pd(i){const e=i.auth,t=await i.getIdToken(),a=await Ou(i,Ld(e,{idToken:t}));Rt(a?.users.length,e,"internal-error");const h=a.users[0];i._notifyReloadListener(h);const f=h.providerUserInfo?.length?Cw(h.providerUserInfo):[],y=JS(i.providerData,f),A=i.isAnonymous,C=!(i.email&&h.passwordHash)&&!y?.length,E=A?C:!1,S={uid:h.localId,displayName:h.displayName||null,photoURL:h.photoUrl||null,email:h.email||null,emailVerified:h.emailVerified||!1,phoneNumber:h.phoneNumber||null,tenantId:h.tenantId||null,providerData:y,metadata:new Z0(h.createdAt,h.lastLoginAt),isAnonymous:E};Object.assign(i,S)}async function $S(i){const e=zs(i);await Pd(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function JS(i,e){return[...i.filter(a=>!e.some(h=>h.providerId===a.providerId)),...e]}function Cw(i){return i.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}async function e3(i,e){const t=await _w(i,{},async()=>{const a=Yu({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:h,apiKey:f}=i.config,y=await Aw(i,h,"/v1/token",`key=${f}`),A=await i._getAdditionalHeaders();A["Content-Type"]="application/x-www-form-urlencoded";const C={method:"POST",headers:A,body:a};return i.emulatorConfig&&Cc(i.emulatorConfig.host)&&(C.credentials="include"),Ew.fetch()(y,C)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function t3(i,e){return Ga(i,"POST","/v2/accounts:revokeToken",Ha(i,e))}class cc{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Rt(e.idToken,"internal-error"),Rt(typeof e.idToken<"u","internal-error"),Rt(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):sx(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Rt(e.length!==0,"internal-error");const t=sx(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Rt(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:a,refreshToken:h,expiresIn:f}=await e3(e,t);this.updateTokensAndExpiration(a,h,Number(f))}updateTokensAndExpiration(e,t,a){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+a*1e3}static fromJSON(e,t){const{refreshToken:a,accessToken:h,expirationTime:f}=t,y=new cc;return a&&(Rt(typeof a=="string","internal-error",{appName:e}),y.refreshToken=a),h&&(Rt(typeof h=="string","internal-error",{appName:e}),y.accessToken=h),f&&(Rt(typeof f=="number","internal-error",{appName:e}),y.expirationTime=f),y}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new cc,this.toJSON())}_performRefresh(){return Ra("not implemented")}}function bo(i,e){Rt(typeof i=="string"||typeof i>"u","internal-error",{appName:e})}class Rr{constructor({uid:e,auth:t,stsTokenManager:a,...h}){this.providerId="firebase",this.proactiveRefresh=new ZS(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=a,this.accessToken=a.accessToken,this.displayName=h.displayName||null,this.email=h.email||null,this.emailVerified=h.emailVerified||!1,this.phoneNumber=h.phoneNumber||null,this.photoURL=h.photoURL||null,this.isAnonymous=h.isAnonymous||!1,this.tenantId=h.tenantId||null,this.providerData=h.providerData?[...h.providerData]:[],this.metadata=new Z0(h.createdAt||void 0,h.lastLoginAt||void 0)}async getIdToken(e){const t=await Ou(this,this.stsTokenManager.getToken(this.auth,e));return Rt(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return KS(this,e)}reload(){return $S(this)}_assign(e){this!==e&&(Rt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Rr({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){Rt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let a=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),a=!0),t&&await Pd(this),await this.auth._persistUserIfCurrent(this),a&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(yr(this.auth.app))return Promise.reject(Ma(this.auth));const e=await this.getIdToken();return await Ou(this,XS(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const a=t.displayName??void 0,h=t.email??void 0,f=t.phoneNumber??void 0,y=t.photoURL??void 0,A=t.tenantId??void 0,C=t._redirectEventId??void 0,E=t.createdAt??void 0,S=t.lastLoginAt??void 0,{uid:I,emailVerified:j,isAnonymous:Y,providerData:X,stsTokenManager:G}=t;Rt(I&&G,e,"internal-error");const J=cc.fromJSON(this.name,G);Rt(typeof I=="string",e,"internal-error"),bo(a,e.name),bo(h,e.name),Rt(typeof j=="boolean",e,"internal-error"),Rt(typeof Y=="boolean",e,"internal-error"),bo(f,e.name),bo(y,e.name),bo(A,e.name),bo(C,e.name),bo(E,e.name),bo(S,e.name);const ae=new Rr({uid:I,auth:e,email:h,emailVerified:j,displayName:a,isAnonymous:Y,photoURL:y,phoneNumber:f,tenantId:A,stsTokenManager:J,createdAt:E,lastLoginAt:S});return X&&Array.isArray(X)&&(ae.providerData=X.map(ne=>({...ne}))),C&&(ae._redirectEventId=C),ae}static async _fromIdTokenResponse(e,t,a=!1){const h=new cc;h.updateFromServerResponse(t);const f=new Rr({uid:t.localId,auth:e,stsTokenManager:h,isAnonymous:a});return await Pd(f),f}static async _fromGetAccountInfoResponse(e,t,a){const h=t.users[0];Rt(h.localId!==void 0,"internal-error");const f=h.providerUserInfo!==void 0?Cw(h.providerUserInfo):[],y=!(h.email&&h.passwordHash)&&!f?.length,A=new cc;A.updateFromIdToken(a);const C=new Rr({uid:h.localId,auth:e,stsTokenManager:A,isAnonymous:y}),E={uid:h.localId,displayName:h.displayName||null,photoURL:h.photoUrl||null,email:h.email||null,emailVerified:h.emailVerified||!1,phoneNumber:h.phoneNumber||null,tenantId:h.tenantId||null,providerData:f,metadata:new Z0(h.createdAt,h.lastLoginAt),isAnonymous:!(h.email&&h.passwordHash)&&!f?.length};return Object.assign(C,E),C}}const ix=new Map;function Da(i){Ba(i instanceof Function,"Expected a class definition");let e=ix.get(i);return e?(Ba(e instanceof i,"Instance stored in cache mismatched with class"),e):(e=new i,ix.set(i,e),e)}class Tw{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}Tw.type="NONE";const rx=Tw;function bd(i,e,t){return`firebase:${i}:${e}:${t}`}class uc{constructor(e,t,a){this.persistence=e,this.auth=t,this.userKey=a;const{config:h,name:f}=this.auth;this.fullUserKey=bd(this.userKey,h.apiKey,f),this.fullPersistenceKey=bd("persistence",h.apiKey,f),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await Ld(this.auth,{idToken:e}).catch(()=>{});return t?Rr._fromGetAccountInfoResponse(this.auth,t,e):null}return Rr._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,a="authUser"){if(!t.length)return new uc(Da(rx),e,a);const h=(await Promise.all(t.map(async E=>{if(await E._isAvailable())return E}))).filter(E=>E);let f=h[0]||Da(rx);const y=bd(a,e.config.apiKey,e.name);let A=null;for(const E of t)try{const S=await E._get(y);if(S){let I;if(typeof S=="string"){const j=await Ld(e,{idToken:S}).catch(()=>{});if(!j)break;I=await Rr._fromGetAccountInfoResponse(e,j,S)}else I=Rr._fromJSON(e,S);E!==f&&(A=I),f=E;break}}catch{}const C=h.filter(E=>E._shouldAllowMigration);return!f._shouldAllowMigration||!C.length?new uc(f,e,a):(f=C[0],A&&await f._set(y,A.toJSON()),await Promise.all(t.map(async E=>{if(E!==f)try{await E._remove(y)}catch{}})),new uc(f,e,a))}}function ax(i){const e=i.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Rw(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Sw(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(kw(e))return"Blackberry";if(Mw(e))return"Webos";if(Nw(e))return"Safari";if((e.includes("chrome/")||Iw(e))&&!e.includes("edge/"))return"Chrome";if(Dw(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,a=i.match(t);if(a?.length===2)return a[1]}return"Other"}function Sw(i=yi()){return/firefox\//i.test(i)}function Nw(i=yi()){const e=i.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Iw(i=yi()){return/crios\//i.test(i)}function Rw(i=yi()){return/iemobile/i.test(i)}function Dw(i=yi()){return/android/i.test(i)}function kw(i=yi()){return/blackberry/i.test(i)}function Mw(i=yi()){return/webos/i.test(i)}function Bm(i=yi()){return/iphone|ipad|ipod/i.test(i)||/macintosh/i.test(i)&&/mobile/i.test(i)}function n3(i=yi()){return Bm(i)&&!!window.navigator?.standalone}function s3(){return yT()&&document.documentMode===10}function Ow(i=yi()){return Bm(i)||Dw(i)||Mw(i)||kw(i)||/windows phone/i.test(i)||Rw(i)}function jw(i,e=[]){let t;switch(i){case"Browser":t=ax(yi());break;case"Worker":t=`${ax(yi())}-${i}`;break;default:t=i}const a=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Tc}/${a}`}class i3{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const a=f=>new Promise((y,A)=>{try{const C=e(f);y(C)}catch(C){A(C)}});a.onAbort=t,this.queue.push(a);const h=this.queue.length-1;return()=>{this.queue[h]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const a of this.queue)await a(e),a.onAbort&&t.push(a.onAbort)}catch(a){t.reverse();for(const h of t)try{h()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:a?.message})}}}async function r3(i,e={}){return Ga(i,"GET","/v2/passwordPolicy",Ha(i,e))}const a3=6;class o3{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??a3,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const a=this.customStrengthOptions.minPasswordLength,h=this.customStrengthOptions.maxPasswordLength;a&&(t.meetsMinPasswordLength=e.length>=a),h&&(t.meetsMaxPasswordLength=e.length<=h)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let a;for(let h=0;h<e.length;h++)a=e.charAt(h),this.updatePasswordCharacterOptionsStatuses(t,a>="a"&&a<="z",a>="A"&&a<="Z",a>="0"&&a<="9",this.allowedNonAlphanumericCharacters.includes(a))}updatePasswordCharacterOptionsStatuses(e,t,a,h,f){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=a)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=h)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=f))}}class l3{constructor(e,t,a,h){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=a,this.config=h,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new ox(this),this.idTokenSubscription=new ox(this),this.beforeStateQueue=new i3(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=ww,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=h.sdkClientVersion,this._persistenceManagerAvailable=new Promise(f=>this._resolvePersistenceManagerAvailable=f)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Da(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await uc.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await Ld(this,{idToken:e}),a=await Rr._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(a)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(yr(this.app)){const f=this.app.settings.authIdToken;return f?new Promise(y=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(f).then(y,y))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let a=t,h=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const f=this.redirectUser?._redirectEventId,y=a?._redirectEventId,A=await this.tryRedirectSignIn(e);(!f||f===y)&&A?.user&&(a=A.user,h=!0)}if(!a)return this.directlySetCurrentUser(null);if(!a._redirectEventId){if(h)try{await this.beforeStateQueue.runMiddleware(a)}catch(f){a=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(f))}return a?this.reloadAndSetCurrentUserOrClear(a):this.directlySetCurrentUser(null)}return Rt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===a._redirectEventId?this.directlySetCurrentUser(a):this.reloadAndSetCurrentUserOrClear(a)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Pd(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=FS()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(yr(this.app))return Promise.reject(Ma(this));const t=e?zs(e):null;return t&&Rt(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Rt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return yr(this.app)?Promise.reject(Ma(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return yr(this.app)?Promise.reject(Ma(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Da(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await r3(this),t=new o3(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Wu("auth","Firebase",e())}onAuthStateChanged(e,t,a){return this.registerStateListener(this.authStateSubscription,e,t,a)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,a){return this.registerStateListener(this.idTokenSubscription,e,t,a)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const a=this.onAuthStateChanged(()=>{a(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),a={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(a.tenantId=this.tenantId),await t3(this,a)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const a=await this.getOrInitRedirectPersistenceManager(t);return e===null?a.removeCurrentUser():a.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Da(e)||this._popupRedirectResolver;Rt(t,this,"argument-error"),this.redirectPersistenceManager=await uc.create(this,[Da(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,a,h){if(this._deleted)return()=>{};const f=typeof t=="function"?t:t.next.bind(t);let y=!1;const A=this._isInitialized?Promise.resolve():this._initializationPromise;if(Rt(A,this,"internal-error"),A.then(()=>{y||f(this.currentUser)}),typeof t=="function"){const C=e.addObserver(t,a,h);return()=>{y=!0,C()}}else{const C=e.addObserver(t);return()=>{y=!0,C()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Rt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=jw(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const a=await this._getAppCheckToken();return a&&(e["X-Firebase-AppCheck"]=a),e}async _getAppCheckToken(){if(yr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&PS(`Error while retrieving App Check token: ${e.error}`),e?.token}}function Vo(i){return zs(i)}class ox{constructor(e){this.auth=e,this.observer=null,this.addObserver=CT(t=>this.observer=t)}get next(){return Rt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let cf={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function c3(i){cf=i}function Lw(i){return cf.loadJS(i)}function u3(){return cf.recaptchaEnterpriseScript}function h3(){return cf.gapiScript}function d3(i){return`__${i}${Math.floor(Math.random()*1e6)}`}class f3{constructor(){this.enterprise=new m3}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class m3{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const g3="recaptcha-enterprise",Pw="NO_RECAPTCHA";class p3{constructor(e){this.type=g3,this.auth=Vo(e)}async verify(e="verify",t=!1){async function a(f){if(!t){if(f.tenantId==null&&f._agentRecaptchaConfig!=null)return f._agentRecaptchaConfig.siteKey;if(f.tenantId!=null&&f._tenantRecaptchaConfigs[f.tenantId]!==void 0)return f._tenantRecaptchaConfigs[f.tenantId].siteKey}return new Promise(async(y,A)=>{YS(f,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(C=>{if(C.recaptchaKey===void 0)A(new Error("recaptcha Enterprise site key undefined"));else{const E=new WS(C);return f.tenantId==null?f._agentRecaptchaConfig=E:f._tenantRecaptchaConfigs[f.tenantId]=E,y(E.siteKey)}}).catch(C=>{A(C)})})}function h(f,y,A){const C=window.grecaptcha;nx(C)?C.enterprise.ready(()=>{C.enterprise.execute(f,{action:e}).then(E=>{y(E)}).catch(()=>{y(Pw)})}):A(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new f3().execute("siteKey",{action:"verify"}):new Promise((f,y)=>{a(this.auth).then(A=>{if(!t&&nx(window.grecaptcha))h(A,f,y);else{if(typeof window>"u"){y(new Error("RecaptchaVerifier is only supported in browser"));return}let C=u3();C.length!==0&&(C+=A),Lw(C).then(()=>{h(A,f,y)}).catch(E=>{y(E)})}}).catch(A=>{y(A)})})}}async function lx(i,e,t,a=!1,h=!1){const f=new p3(i);let y;if(h)y=Pw;else try{y=await f.verify(t)}catch{y=await f.verify(t,!0)}const A={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in A){const C=A.phoneEnrollmentInfo.phoneNumber,E=A.phoneEnrollmentInfo.recaptchaToken;Object.assign(A,{phoneEnrollmentInfo:{phoneNumber:C,recaptchaToken:E,captchaResponse:y,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in A){const C=A.phoneSignInInfo.recaptchaToken;Object.assign(A,{phoneSignInInfo:{recaptchaToken:C,captchaResponse:y,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return A}return a?Object.assign(A,{captchaResp:y}):Object.assign(A,{captchaResponse:y}),Object.assign(A,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(A,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),A}async function Bd(i,e,t,a,h){if(i._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const f=await lx(i,e,t,t==="getOobCode");return a(i,f)}else return a(i,e).catch(async f=>{if(f.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const y=await lx(i,e,t,t==="getOobCode");return a(i,y)}else return Promise.reject(f)})}function y3(i,e){const t=Mm(i,"auth");if(t.isInitialized()){const h=t.getImmediate(),f=t.getOptions();if(ml(f,e??{}))return h;Or(h,"already-initialized")}return t.initialize({options:e})}function x3(i,e){const t=e?.persistence||[],a=(Array.isArray(t)?t:[t]).map(Da);e?.errorMap&&i._updateErrorMap(e.errorMap),i._initializeWithPersistence(a,e?.popupRedirectResolver)}function v3(i,e,t){const a=Vo(i);Rt(/^https?:\/\//.test(e),a,"invalid-emulator-scheme");const h=!1,f=Bw(e),{host:y,port:A}=w3(e),C=A===null?"":`:${A}`,E={url:`${f}//${y}${C}/`},S=Object.freeze({host:y,port:A,protocol:f.replace(":",""),options:Object.freeze({disableWarnings:h})});if(!a._canInitEmulator){Rt(a.config.emulator&&a.emulatorConfig,a,"emulator-config-failed"),Rt(ml(E,a.config.emulator)&&ml(S,a.emulatorConfig),a,"emulator-config-failed");return}a.config.emulator=E,a.emulatorConfig=S,a.settings.appVerificationDisabledForTesting=!0,Cc(y)?(dw(`${f}//${y}${C}`),fw("Auth",!0)):b3()}function Bw(i){const e=i.indexOf(":");return e<0?"":i.substr(0,e+1)}function w3(i){const e=Bw(i),t=/(\/\/)?([^?#/]+)/.exec(i.substr(e.length));if(!t)return{host:"",port:null};const a=t[2].split("@").pop()||"",h=/^(\[[^\]]+\])(:|$)/.exec(a);if(h){const f=h[1];return{host:f,port:cx(a.substr(f.length+1))}}else{const[f,y]=a.split(":");return{host:f,port:cx(y)}}}function cx(i){if(!i)return null;const e=Number(i);return isNaN(e)?null:e}function b3(){function i(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",i):i())}class Vm{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Ra("not implemented")}_getIdTokenResponse(e){return Ra("not implemented")}_linkToIdToken(e,t){return Ra("not implemented")}_getReauthenticationResolver(e){return Ra("not implemented")}}async function E3(i,e){return Ga(i,"POST","/v1/accounts:signUp",e)}async function _3(i,e){return Ku(i,"POST","/v1/accounts:signInWithPassword",Ha(i,e))}async function A3(i,e){return Ga(i,"POST","/v1/accounts:sendOobCode",Ha(i,e))}async function C3(i,e){return A3(i,e)}async function T3(i,e){return Ku(i,"POST","/v1/accounts:signInWithEmailLink",Ha(i,e))}async function S3(i,e){return Ku(i,"POST","/v1/accounts:signInWithEmailLink",Ha(i,e))}class ju extends Vm{constructor(e,t,a,h=null){super("password",a),this._email=e,this._password=t,this._tenantId=h}static _fromEmailAndPassword(e,t){return new ju(e,t,"password")}static _fromEmailAndCode(e,t,a=null){return new ju(e,t,"emailLink",a)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Bd(e,t,"signInWithPassword",_3);case"emailLink":return T3(e,{email:this._email,oobCode:this._password});default:Or(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const a={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Bd(e,a,"signUpPassword",E3);case"emailLink":return S3(e,{idToken:t,email:this._email,oobCode:this._password});default:Or(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function hc(i,e){return Ku(i,"POST","/v1/accounts:signInWithIdp",Ha(i,e))}const N3="http://localhost";class pl extends Vm{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new pl(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Or("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:a,signInMethod:h,...f}=t;if(!a||!h)return null;const y=new pl(a,h);return y.idToken=f.idToken||void 0,y.accessToken=f.accessToken||void 0,y.secret=f.secret,y.nonce=f.nonce,y.pendingToken=f.pendingToken||null,y}_getIdTokenResponse(e){const t=this.buildRequest();return hc(e,t)}_linkToIdToken(e,t){const a=this.buildRequest();return a.idToken=t,hc(e,a)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,hc(e,t)}buildRequest(){const e={requestUri:N3,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Yu(t)}return e}}function I3(i){switch(i){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function R3(i){const e=vu(wu(i)).link,t=e?vu(wu(e)).deep_link_id:null,a=vu(wu(i)).deep_link_id;return(a?vu(wu(a)).link:null)||a||t||e||i}class Fm{constructor(e){const t=vu(wu(e)),a=t.apiKey??null,h=t.oobCode??null,f=I3(t.mode??null);Rt(a&&h&&f,"argument-error"),this.apiKey=a,this.operation=f,this.code=h,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=R3(e);try{return new Fm(t)}catch{return null}}}class Sc{constructor(){this.providerId=Sc.PROVIDER_ID}static credential(e,t){return ju._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const a=Fm.parseLink(t);return Rt(a,"argument-error"),ju._fromEmailAndCode(e,a.code,a.tenantId)}}Sc.PROVIDER_ID="password";Sc.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Sc.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class Vw{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class Qu extends Vw{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Eo extends Qu{constructor(){super("facebook.com")}static credential(e){return pl._fromParams({providerId:Eo.PROVIDER_ID,signInMethod:Eo.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Eo.credentialFromTaggedObject(e)}static credentialFromError(e){return Eo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Eo.credential(e.oauthAccessToken)}catch{return null}}}Eo.FACEBOOK_SIGN_IN_METHOD="facebook.com";Eo.PROVIDER_ID="facebook.com";class _o extends Qu{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return pl._fromParams({providerId:_o.PROVIDER_ID,signInMethod:_o.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return _o.credentialFromTaggedObject(e)}static credentialFromError(e){return _o.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:a}=e;if(!t&&!a)return null;try{return _o.credential(t,a)}catch{return null}}}_o.GOOGLE_SIGN_IN_METHOD="google.com";_o.PROVIDER_ID="google.com";class Ao extends Qu{constructor(){super("github.com")}static credential(e){return pl._fromParams({providerId:Ao.PROVIDER_ID,signInMethod:Ao.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ao.credentialFromTaggedObject(e)}static credentialFromError(e){return Ao.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ao.credential(e.oauthAccessToken)}catch{return null}}}Ao.GITHUB_SIGN_IN_METHOD="github.com";Ao.PROVIDER_ID="github.com";class Co extends Qu{constructor(){super("twitter.com")}static credential(e,t){return pl._fromParams({providerId:Co.PROVIDER_ID,signInMethod:Co.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Co.credentialFromTaggedObject(e)}static credentialFromError(e){return Co.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:a}=e;if(!t||!a)return null;try{return Co.credential(t,a)}catch{return null}}}Co.TWITTER_SIGN_IN_METHOD="twitter.com";Co.PROVIDER_ID="twitter.com";async function D3(i,e){return Ku(i,"POST","/v1/accounts:signUp",Ha(i,e))}class yl{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,a,h=!1){const f=await Rr._fromIdTokenResponse(e,a,h),y=ux(a);return new yl({user:f,providerId:y,_tokenResponse:a,operationType:t})}static async _forOperation(e,t,a){await e._updateTokensIfNecessary(a,!0);const h=ux(a);return new yl({user:e,providerId:h,_tokenResponse:a,operationType:t})}}function ux(i){return i.providerId?i.providerId:"phoneNumber"in i?"phone":null}class Vd extends za{constructor(e,t,a,h){super(t.code,t.message),this.operationType=a,this.user=h,Object.setPrototypeOf(this,Vd.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:a}}static _fromErrorAndOperation(e,t,a,h){return new Vd(e,t,a,h)}}function Fw(i,e,t,a){return(e==="reauthenticate"?t._getReauthenticationResolver(i):t._getIdTokenResponse(i)).catch(f=>{throw f.code==="auth/multi-factor-auth-required"?Vd._fromErrorAndOperation(i,f,e,a):f})}async function k3(i,e,t=!1){const a=await Ou(i,e._linkToIdToken(i.auth,await i.getIdToken()),t);return yl._forOperation(i,"link",a)}async function M3(i,e,t=!1){const{auth:a}=i;if(yr(a.app))return Promise.reject(Ma(a));const h="reauthenticate";try{const f=await Ou(i,Fw(a,h,e,i),t);Rt(f.idToken,a,"internal-error");const y=Pm(f.idToken);Rt(y,a,"internal-error");const{sub:A}=y;return Rt(i.uid===A,a,"user-mismatch"),yl._forOperation(i,h,f)}catch(f){throw f?.code==="auth/user-not-found"&&Or(a,"user-mismatch"),f}}async function Uw(i,e,t=!1){if(yr(i.app))return Promise.reject(Ma(i));const a="signIn",h=await Fw(i,a,e),f=await yl._fromIdTokenResponse(i,a,h);return t||await i._updateCurrentUser(f.user),f}async function O3(i,e){return Uw(Vo(i),e)}async function zw(i){const e=Vo(i);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function j3(i,e,t){const a=Vo(i);await Bd(a,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",C3)}async function Hw(i,e,t){if(yr(i.app))return Promise.reject(Ma(i));const a=Vo(i),y=await Bd(a,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",D3).catch(C=>{throw C.code==="auth/password-does-not-meet-requirements"&&zw(i),C}),A=await yl._fromIdTokenResponse(a,"signIn",y);return await a._updateCurrentUser(A.user),A}function L3(i,e,t){return yr(i.app)?Promise.reject(Ma(i)):O3(zs(i),Sc.credential(e,t)).catch(async a=>{throw a.code==="auth/password-does-not-meet-requirements"&&zw(i),a})}function P3(i,e){return zs(i).setPersistence(e)}function B3(i,e,t,a){return zs(i).onIdTokenChanged(e,t,a)}function V3(i,e,t){return zs(i).beforeAuthStateChanged(e,t)}function F3(i,e,t,a){return zs(i).onAuthStateChanged(e,t,a)}function Um(i){return zs(i).signOut()}const Fd="__sak";class Gw{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Fd,"1"),this.storage.removeItem(Fd),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const U3=1e3,z3=10;class qw extends Gw{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Ow(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const a=this.storage.getItem(t),h=this.localCache[t];a!==h&&e(t,h,a)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((y,A,C)=>{this.notifyListeners(y,C)});return}const a=e.key;t?this.detachListener():this.stopPolling();const h=()=>{const y=this.storage.getItem(a);!t&&this.localCache[a]===y||this.notifyListeners(a,y)},f=this.storage.getItem(a);s3()&&f!==e.newValue&&e.newValue!==e.oldValue?setTimeout(h,z3):h()}notifyListeners(e,t){this.localCache[e]=t;const a=this.listeners[e];if(a)for(const h of Array.from(a))h(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,a)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:a}),!0)})},U3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}qw.type="LOCAL";const Ww=qw;class Yw extends Gw{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}Yw.type="SESSION";const zm=Yw;function H3(i){return Promise.all(i.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class uf{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(h=>h.isListeningto(e));if(t)return t;const a=new uf(e);return this.receivers.push(a),a}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:a,eventType:h,data:f}=t.data,y=this.handlersMap[h];if(!y?.size)return;t.ports[0].postMessage({status:"ack",eventId:a,eventType:h});const A=Array.from(y).map(async E=>E(t.origin,f)),C=await H3(A);t.ports[0].postMessage({status:"done",eventId:a,eventType:h,response:C})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}uf.receivers=[];function Hm(i="",e=10){let t="";for(let a=0;a<e;a++)t+=Math.floor(Math.random()*10);return i+t}class G3{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,a=50){const h=typeof MessageChannel<"u"?new MessageChannel:null;if(!h)throw new Error("connection_unavailable");let f,y;return new Promise((A,C)=>{const E=Hm("",20);h.port1.start();const S=setTimeout(()=>{C(new Error("unsupported_event"))},a);y={messageChannel:h,onMessage(I){const j=I;if(j.data.eventId===E)switch(j.data.status){case"ack":clearTimeout(S),f=setTimeout(()=>{C(new Error("timeout"))},3e3);break;case"done":clearTimeout(f),A(j.data.response);break;default:clearTimeout(S),clearTimeout(f),C(new Error("invalid_response"));break}}},this.handlers.add(y),h.port1.addEventListener("message",y.onMessage),this.target.postMessage({eventType:e,eventId:E,data:t},[h.port2])}).finally(()=>{y&&this.removeMessageHandler(y)})}}function Kr(){return window}function q3(i){Kr().location.href=i}function Xw(){return typeof Kr().WorkerGlobalScope<"u"&&typeof Kr().importScripts=="function"}async function W3(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function Y3(){return navigator?.serviceWorker?.controller||null}function X3(){return Xw()?self:null}const Kw="firebaseLocalStorageDb",K3=1,Ud="firebaseLocalStorage",Qw="fbase_key";class Zu{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function hf(i,e){return i.transaction([Ud],e?"readwrite":"readonly").objectStore(Ud)}function Q3(){const i=indexedDB.deleteDatabase(Kw);return new Zu(i).toPromise()}function $0(){const i=indexedDB.open(Kw,K3);return new Promise((e,t)=>{i.addEventListener("error",()=>{t(i.error)}),i.addEventListener("upgradeneeded",()=>{const a=i.result;try{a.createObjectStore(Ud,{keyPath:Qw})}catch(h){t(h)}}),i.addEventListener("success",async()=>{const a=i.result;a.objectStoreNames.contains(Ud)?e(a):(a.close(),await Q3(),e(await $0()))})})}async function hx(i,e,t){const a=hf(i,!0).put({[Qw]:e,value:t});return new Zu(a).toPromise()}async function Z3(i,e){const t=hf(i,!1).get(e),a=await new Zu(t).toPromise();return a===void 0?null:a.value}function dx(i,e){const t=hf(i,!0).delete(e);return new Zu(t).toPromise()}const $3=800,J3=3;class Zw{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await $0(),this.db)}async _withRetries(e){let t=0;for(;;)try{const a=await this._openDb();return await e(a)}catch(a){if(t++>J3)throw a;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Xw()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=uf._getInstance(X3()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await W3(),!this.activeServiceWorker)return;this.sender=new G3(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||Y3()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await $0();return await hx(e,Fd,"1"),await dx(e,Fd),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(a=>hx(a,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(a=>Z3(a,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>dx(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(h=>{const f=hf(h,!1).getAll();return new Zu(f).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],a=new Set;if(e.length!==0)for(const{fbase_key:h,value:f}of e)a.add(h),JSON.stringify(this.localCache[h])!==JSON.stringify(f)&&(this.notifyListeners(h,f),t.push(h));for(const h of Object.keys(this.localCache))this.localCache[h]&&!a.has(h)&&(this.notifyListeners(h,null),t.push(h));return t}notifyListeners(e,t){this.localCache[e]=t;const a=this.listeners[e];if(a)for(const h of Array.from(a))h(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),$3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}Zw.type="LOCAL";const e4=Zw;new Xu(3e4,6e4);function t4(i,e){return e?Da(e):(Rt(i._popupRedirectResolver,i,"argument-error"),i._popupRedirectResolver)}class Gm extends Vm{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return hc(e,this._buildIdpRequest())}_linkToIdToken(e,t){return hc(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return hc(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function n4(i){return Uw(i.auth,new Gm(i),i.bypassAuthState)}function s4(i){const{auth:e,user:t}=i;return Rt(t,e,"internal-error"),M3(t,new Gm(i),i.bypassAuthState)}async function i4(i){const{auth:e,user:t}=i;return Rt(t,e,"internal-error"),k3(t,new Gm(i),i.bypassAuthState)}class $w{constructor(e,t,a,h,f=!1){this.auth=e,this.resolver=a,this.user=h,this.bypassAuthState=f,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(a){this.reject(a)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:a,postBody:h,tenantId:f,error:y,type:A}=e;if(y){this.reject(y);return}const C={auth:this.auth,requestUri:t,sessionId:a,tenantId:f||void 0,postBody:h||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(A)(C))}catch(E){this.reject(E)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return n4;case"linkViaPopup":case"linkViaRedirect":return i4;case"reauthViaPopup":case"reauthViaRedirect":return s4;default:Or(this.auth,"internal-error")}}resolve(e){Ba(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Ba(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const r4=new Xu(2e3,1e4);class ac extends $w{constructor(e,t,a,h,f){super(e,t,h,f),this.provider=a,this.authWindow=null,this.pollId=null,ac.currentPopupAction&&ac.currentPopupAction.cancel(),ac.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Rt(e,this.auth,"internal-error"),e}async onExecution(){Ba(this.filter.length===1,"Popup operations only handle one event");const e=Hm();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Xr(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(Xr(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,ac.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Xr(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,r4.get())};e()}}ac.currentPopupAction=null;const a4="pendingRedirect",Ed=new Map;class o4 extends $w{constructor(e,t,a=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,a),this.eventId=null}async execute(){let e=Ed.get(this.auth._key());if(!e){try{const a=await l4(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(a)}catch(t){e=()=>Promise.reject(t)}Ed.set(this.auth._key(),e)}return this.bypassAuthState||Ed.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function l4(i,e){const t=h4(e),a=u4(i);if(!await a._isAvailable())return!1;const h=await a._get(t)==="true";return await a._remove(t),h}function c4(i,e){Ed.set(i._key(),e)}function u4(i){return Da(i._redirectPersistence)}function h4(i){return bd(a4,i.config.apiKey,i.name)}async function d4(i,e,t=!1){if(yr(i.app))return Promise.reject(Ma(i));const a=Vo(i),h=t4(a,e),y=await new o4(a,h,t).execute();return y&&!t&&(delete y.user._redirectEventId,await a._persistUserIfCurrent(y.user),await a._setRedirectUser(null,e)),y}const f4=600*1e3;class m4{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(a=>{this.isEventForConsumer(e,a)&&(t=!0,this.sendToConsumer(e,a),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!g4(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!Jw(e)){const a=e.error.code?.split("auth/")[1]||"internal-error";t.onError(Xr(this.auth,a))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const a=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&a}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=f4&&this.cachedEventUids.clear(),this.cachedEventUids.has(fx(e))}saveEventToCache(e){this.cachedEventUids.add(fx(e)),this.lastProcessedEventTime=Date.now()}}function fx(i){return[i.type,i.eventId,i.sessionId,i.tenantId].filter(e=>e).join("-")}function Jw({type:i,error:e}){return i==="unknown"&&e?.code==="auth/no-auth-event"}function g4(i){switch(i.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Jw(i);default:return!1}}async function p4(i,e={}){return Ga(i,"GET","/v1/projects",e)}const y4=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,x4=/^https?/;async function v4(i){if(i.config.emulator)return;const{authorizedDomains:e}=await p4(i);for(const t of e)try{if(w4(t))return}catch{}Or(i,"unauthorized-domain")}function w4(i){const e=Q0(),{protocol:t,hostname:a}=new URL(e);if(i.startsWith("chrome-extension://")){const y=new URL(i);return y.hostname===""&&a===""?t==="chrome-extension:"&&i.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&y.hostname===a}if(!x4.test(t))return!1;if(y4.test(i))return a===i;const h=i.replace(/\./g,"\\.");return new RegExp("^(.+\\."+h+"|"+h+")$","i").test(a)}const b4=new Xu(3e4,6e4);function mx(){const i=Kr().___jsl;if(i?.H){for(const e of Object.keys(i.H))if(i.H[e].r=i.H[e].r||[],i.H[e].L=i.H[e].L||[],i.H[e].r=[...i.H[e].L],i.CP)for(let t=0;t<i.CP.length;t++)i.CP[t]=null}}function E4(i){return new Promise((e,t)=>{function a(){mx(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{mx(),t(Xr(i,"network-request-failed"))},timeout:b4.get()})}if(Kr().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(Kr().gapi?.load)a();else{const h=d3("iframefcb");return Kr()[h]=()=>{gapi.load?a():t(Xr(i,"network-request-failed"))},Lw(`${h3()}?onload=${h}`).catch(f=>t(f))}}).catch(e=>{throw _d=null,e})}let _d=null;function _4(i){return _d=_d||E4(i),_d}const A4=new Xu(5e3,15e3),C4="__/auth/iframe",T4="emulator/auth/iframe",S4={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},N4=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function I4(i){const e=i.config;Rt(e.authDomain,i,"auth-domain-config-required");const t=e.emulator?Lm(e,T4):`https://${i.config.authDomain}/${C4}`,a={apiKey:e.apiKey,appName:i.name,v:Tc},h=N4.get(i.config.apiHost);h&&(a.eid=h);const f=i._getFrameworks();return f.length&&(a.fw=f.join(",")),`${t}?${Yu(a).slice(1)}`}async function R4(i){const e=await _4(i),t=Kr().gapi;return Rt(t,i,"internal-error"),e.open({where:document.body,url:I4(i),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:S4,dontclear:!0},a=>new Promise(async(h,f)=>{await a.restyle({setHideOnLeave:!1});const y=Xr(i,"network-request-failed"),A=Kr().setTimeout(()=>{f(y)},A4.get());function C(){Kr().clearTimeout(A),h(a)}a.ping(C).then(C,()=>{f(y)})}))}const D4={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},k4=500,M4=600,O4="_blank",j4="http://localhost";class gx{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function L4(i,e,t,a=k4,h=M4){const f=Math.max((window.screen.availHeight-h)/2,0).toString(),y=Math.max((window.screen.availWidth-a)/2,0).toString();let A="";const C={...D4,width:a.toString(),height:h.toString(),top:f,left:y},E=yi().toLowerCase();t&&(A=Iw(E)?O4:t),Sw(E)&&(e=e||j4,C.scrollbars="yes");const S=Object.entries(C).reduce((j,[Y,X])=>`${j}${Y}=${X},`,"");if(n3(E)&&A!=="_self")return P4(e||"",A),new gx(null);const I=window.open(e||"",A,S);Rt(I,i,"popup-blocked");try{I.focus()}catch{}return new gx(I)}function P4(i,e){const t=document.createElement("a");t.href=i,t.target=e;const a=document.createEvent("MouseEvent");a.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(a)}const B4="__/auth/handler",V4="emulator/auth/handler",F4=encodeURIComponent("fac");async function px(i,e,t,a,h,f){Rt(i.config.authDomain,i,"auth-domain-config-required"),Rt(i.config.apiKey,i,"invalid-api-key");const y={apiKey:i.config.apiKey,appName:i.name,authType:t,redirectUrl:a,v:Tc,eventId:h};if(e instanceof Vw){e.setDefaultLanguage(i.languageCode),y.providerId=e.providerId||"",AT(e.getCustomParameters())||(y.customParameters=JSON.stringify(e.getCustomParameters()));for(const[S,I]of Object.entries({}))y[S]=I}if(e instanceof Qu){const S=e.getScopes().filter(I=>I!=="");S.length>0&&(y.scopes=S.join(","))}i.tenantId&&(y.tid=i.tenantId);const A=y;for(const S of Object.keys(A))A[S]===void 0&&delete A[S];const C=await i._getAppCheckToken(),E=C?`#${F4}=${encodeURIComponent(C)}`:"";return`${U4(i)}?${Yu(A).slice(1)}${E}`}function U4({config:i}){return i.emulator?Lm(i,V4):`https://${i.authDomain}/${B4}`}const D0="webStorageSupport";class z4{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=zm,this._completeRedirectFn=d4,this._overrideRedirectResult=c4}async _openPopup(e,t,a,h){Ba(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const f=await px(e,t,a,Q0(),h);return L4(e,f,Hm())}async _openRedirect(e,t,a,h){await this._originValidation(e);const f=await px(e,t,a,Q0(),h);return q3(f),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:h,promise:f}=this.eventManagers[t];return h?Promise.resolve(h):(Ba(f,"If manager is not set, promise should be"),f)}const a=this.initAndGetManager(e);return this.eventManagers[t]={promise:a},a.catch(()=>{delete this.eventManagers[t]}),a}async initAndGetManager(e){const t=await R4(e),a=new m4(e);return t.register("authEvent",h=>(Rt(h?.authEvent,e,"invalid-auth-event"),{status:a.onEvent(h.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:a},this.iframes[e._key()]=t,a}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(D0,{type:D0},h=>{const f=h?.[0]?.[D0];f!==void 0&&t(!!f),Or(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=v4(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return Ow()||Nw()||Bm()}}const H4=z4;var yx="@firebase/auth",xx="1.12.0";class G4{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(a=>{e(a?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Rt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function q4(i){switch(i){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function W4(i){gc(new gl("auth",(e,{options:t})=>{const a=e.getProvider("app").getImmediate(),h=e.getProvider("heartbeat"),f=e.getProvider("app-check-internal"),{apiKey:y,authDomain:A}=a.options;Rt(y&&!y.includes(":"),"invalid-api-key",{appName:a.name});const C={apiKey:y,authDomain:A,clientPlatform:i,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:jw(i)},E=new l3(a,h,f,C);return x3(E,t),E},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,a)=>{e.getProvider("auth-internal").initialize()})),gc(new gl("auth-internal",e=>{const t=Vo(e.getProvider("auth").getImmediate());return(a=>new G4(a))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Io(yx,xx,q4(i)),Io(yx,xx,"esm2020")}const Y4=300,X4=hw("authIdTokenMaxAge")||Y4;let vx=null;const K4=i=>async e=>{const t=e&&await e.getIdTokenResult(),a=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(a&&a>X4)return;const h=t?.token;vx!==h&&(vx=h,await fetch(i,{method:h?"POST":"DELETE",headers:h?{Authorization:`Bearer ${h}`}:{}}))};function eb(i=pw()){const e=Mm(i,"auth");if(e.isInitialized())return e.getImmediate();const t=y3(i,{popupRedirectResolver:H4,persistence:[e4,Ww,zm]}),a=hw("authTokenSyncURL");if(a&&typeof isSecureContext=="boolean"&&isSecureContext){const f=new URL(a,location.origin);if(location.origin===f.origin){const y=K4(f.toString());V3(t,y,()=>y(t.currentUser)),B3(t,A=>y(A))}}const h=cw("auth");return h&&v3(t,`http://${h}`),t}function Q4(){return document.getElementsByTagName("head")?.[0]??document}c3({loadJS(i){return new Promise((e,t)=>{const a=document.createElement("script");a.setAttribute("src",i),a.onload=e,a.onerror=h=>{const f=Xr("internal-error");f.customData=h,t(f)},a.type="text/javascript",a.charset="UTF-8",Q4().appendChild(a)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});W4("Browser");var wx=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var Ro,tb;(function(){var i;function e(P,F){function B(){}B.prototype=F.prototype,P.F=F.prototype,P.prototype=new B,P.prototype.constructor=P,P.D=function(se,Z,Q){for(var z=Array(arguments.length-2),Ye=2;Ye<arguments.length;Ye++)z[Ye-2]=arguments[Ye];return F.prototype[Z].apply(se,z)}}function t(){this.blockSize=-1}function a(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(a,t),a.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function h(P,F,B){B||(B=0);const se=Array(16);if(typeof F=="string")for(var Z=0;Z<16;++Z)se[Z]=F.charCodeAt(B++)|F.charCodeAt(B++)<<8|F.charCodeAt(B++)<<16|F.charCodeAt(B++)<<24;else for(Z=0;Z<16;++Z)se[Z]=F[B++]|F[B++]<<8|F[B++]<<16|F[B++]<<24;F=P.g[0],B=P.g[1],Z=P.g[2];let Q=P.g[3],z;z=F+(Q^B&(Z^Q))+se[0]+3614090360&4294967295,F=B+(z<<7&4294967295|z>>>25),z=Q+(Z^F&(B^Z))+se[1]+3905402710&4294967295,Q=F+(z<<12&4294967295|z>>>20),z=Z+(B^Q&(F^B))+se[2]+606105819&4294967295,Z=Q+(z<<17&4294967295|z>>>15),z=B+(F^Z&(Q^F))+se[3]+3250441966&4294967295,B=Z+(z<<22&4294967295|z>>>10),z=F+(Q^B&(Z^Q))+se[4]+4118548399&4294967295,F=B+(z<<7&4294967295|z>>>25),z=Q+(Z^F&(B^Z))+se[5]+1200080426&4294967295,Q=F+(z<<12&4294967295|z>>>20),z=Z+(B^Q&(F^B))+se[6]+2821735955&4294967295,Z=Q+(z<<17&4294967295|z>>>15),z=B+(F^Z&(Q^F))+se[7]+4249261313&4294967295,B=Z+(z<<22&4294967295|z>>>10),z=F+(Q^B&(Z^Q))+se[8]+1770035416&4294967295,F=B+(z<<7&4294967295|z>>>25),z=Q+(Z^F&(B^Z))+se[9]+2336552879&4294967295,Q=F+(z<<12&4294967295|z>>>20),z=Z+(B^Q&(F^B))+se[10]+4294925233&4294967295,Z=Q+(z<<17&4294967295|z>>>15),z=B+(F^Z&(Q^F))+se[11]+2304563134&4294967295,B=Z+(z<<22&4294967295|z>>>10),z=F+(Q^B&(Z^Q))+se[12]+1804603682&4294967295,F=B+(z<<7&4294967295|z>>>25),z=Q+(Z^F&(B^Z))+se[13]+4254626195&4294967295,Q=F+(z<<12&4294967295|z>>>20),z=Z+(B^Q&(F^B))+se[14]+2792965006&4294967295,Z=Q+(z<<17&4294967295|z>>>15),z=B+(F^Z&(Q^F))+se[15]+1236535329&4294967295,B=Z+(z<<22&4294967295|z>>>10),z=F+(Z^Q&(B^Z))+se[1]+4129170786&4294967295,F=B+(z<<5&4294967295|z>>>27),z=Q+(B^Z&(F^B))+se[6]+3225465664&4294967295,Q=F+(z<<9&4294967295|z>>>23),z=Z+(F^B&(Q^F))+se[11]+643717713&4294967295,Z=Q+(z<<14&4294967295|z>>>18),z=B+(Q^F&(Z^Q))+se[0]+3921069994&4294967295,B=Z+(z<<20&4294967295|z>>>12),z=F+(Z^Q&(B^Z))+se[5]+3593408605&4294967295,F=B+(z<<5&4294967295|z>>>27),z=Q+(B^Z&(F^B))+se[10]+38016083&4294967295,Q=F+(z<<9&4294967295|z>>>23),z=Z+(F^B&(Q^F))+se[15]+3634488961&4294967295,Z=Q+(z<<14&4294967295|z>>>18),z=B+(Q^F&(Z^Q))+se[4]+3889429448&4294967295,B=Z+(z<<20&4294967295|z>>>12),z=F+(Z^Q&(B^Z))+se[9]+568446438&4294967295,F=B+(z<<5&4294967295|z>>>27),z=Q+(B^Z&(F^B))+se[14]+3275163606&4294967295,Q=F+(z<<9&4294967295|z>>>23),z=Z+(F^B&(Q^F))+se[3]+4107603335&4294967295,Z=Q+(z<<14&4294967295|z>>>18),z=B+(Q^F&(Z^Q))+se[8]+1163531501&4294967295,B=Z+(z<<20&4294967295|z>>>12),z=F+(Z^Q&(B^Z))+se[13]+2850285829&4294967295,F=B+(z<<5&4294967295|z>>>27),z=Q+(B^Z&(F^B))+se[2]+4243563512&4294967295,Q=F+(z<<9&4294967295|z>>>23),z=Z+(F^B&(Q^F))+se[7]+1735328473&4294967295,Z=Q+(z<<14&4294967295|z>>>18),z=B+(Q^F&(Z^Q))+se[12]+2368359562&4294967295,B=Z+(z<<20&4294967295|z>>>12),z=F+(B^Z^Q)+se[5]+4294588738&4294967295,F=B+(z<<4&4294967295|z>>>28),z=Q+(F^B^Z)+se[8]+2272392833&4294967295,Q=F+(z<<11&4294967295|z>>>21),z=Z+(Q^F^B)+se[11]+1839030562&4294967295,Z=Q+(z<<16&4294967295|z>>>16),z=B+(Z^Q^F)+se[14]+4259657740&4294967295,B=Z+(z<<23&4294967295|z>>>9),z=F+(B^Z^Q)+se[1]+2763975236&4294967295,F=B+(z<<4&4294967295|z>>>28),z=Q+(F^B^Z)+se[4]+1272893353&4294967295,Q=F+(z<<11&4294967295|z>>>21),z=Z+(Q^F^B)+se[7]+4139469664&4294967295,Z=Q+(z<<16&4294967295|z>>>16),z=B+(Z^Q^F)+se[10]+3200236656&4294967295,B=Z+(z<<23&4294967295|z>>>9),z=F+(B^Z^Q)+se[13]+681279174&4294967295,F=B+(z<<4&4294967295|z>>>28),z=Q+(F^B^Z)+se[0]+3936430074&4294967295,Q=F+(z<<11&4294967295|z>>>21),z=Z+(Q^F^B)+se[3]+3572445317&4294967295,Z=Q+(z<<16&4294967295|z>>>16),z=B+(Z^Q^F)+se[6]+76029189&4294967295,B=Z+(z<<23&4294967295|z>>>9),z=F+(B^Z^Q)+se[9]+3654602809&4294967295,F=B+(z<<4&4294967295|z>>>28),z=Q+(F^B^Z)+se[12]+3873151461&4294967295,Q=F+(z<<11&4294967295|z>>>21),z=Z+(Q^F^B)+se[15]+530742520&4294967295,Z=Q+(z<<16&4294967295|z>>>16),z=B+(Z^Q^F)+se[2]+3299628645&4294967295,B=Z+(z<<23&4294967295|z>>>9),z=F+(Z^(B|~Q))+se[0]+4096336452&4294967295,F=B+(z<<6&4294967295|z>>>26),z=Q+(B^(F|~Z))+se[7]+1126891415&4294967295,Q=F+(z<<10&4294967295|z>>>22),z=Z+(F^(Q|~B))+se[14]+2878612391&4294967295,Z=Q+(z<<15&4294967295|z>>>17),z=B+(Q^(Z|~F))+se[5]+4237533241&4294967295,B=Z+(z<<21&4294967295|z>>>11),z=F+(Z^(B|~Q))+se[12]+1700485571&4294967295,F=B+(z<<6&4294967295|z>>>26),z=Q+(B^(F|~Z))+se[3]+2399980690&4294967295,Q=F+(z<<10&4294967295|z>>>22),z=Z+(F^(Q|~B))+se[10]+4293915773&4294967295,Z=Q+(z<<15&4294967295|z>>>17),z=B+(Q^(Z|~F))+se[1]+2240044497&4294967295,B=Z+(z<<21&4294967295|z>>>11),z=F+(Z^(B|~Q))+se[8]+1873313359&4294967295,F=B+(z<<6&4294967295|z>>>26),z=Q+(B^(F|~Z))+se[15]+4264355552&4294967295,Q=F+(z<<10&4294967295|z>>>22),z=Z+(F^(Q|~B))+se[6]+2734768916&4294967295,Z=Q+(z<<15&4294967295|z>>>17),z=B+(Q^(Z|~F))+se[13]+1309151649&4294967295,B=Z+(z<<21&4294967295|z>>>11),z=F+(Z^(B|~Q))+se[4]+4149444226&4294967295,F=B+(z<<6&4294967295|z>>>26),z=Q+(B^(F|~Z))+se[11]+3174756917&4294967295,Q=F+(z<<10&4294967295|z>>>22),z=Z+(F^(Q|~B))+se[2]+718787259&4294967295,Z=Q+(z<<15&4294967295|z>>>17),z=B+(Q^(Z|~F))+se[9]+3951481745&4294967295,P.g[0]=P.g[0]+F&4294967295,P.g[1]=P.g[1]+(Z+(z<<21&4294967295|z>>>11))&4294967295,P.g[2]=P.g[2]+Z&4294967295,P.g[3]=P.g[3]+Q&4294967295}a.prototype.v=function(P,F){F===void 0&&(F=P.length);const B=F-this.blockSize,se=this.C;let Z=this.h,Q=0;for(;Q<F;){if(Z==0)for(;Q<=B;)h(this,P,Q),Q+=this.blockSize;if(typeof P=="string"){for(;Q<F;)if(se[Z++]=P.charCodeAt(Q++),Z==this.blockSize){h(this,se),Z=0;break}}else for(;Q<F;)if(se[Z++]=P[Q++],Z==this.blockSize){h(this,se),Z=0;break}}this.h=Z,this.o+=F},a.prototype.A=function(){var P=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);P[0]=128;for(var F=1;F<P.length-8;++F)P[F]=0;F=this.o*8;for(var B=P.length-8;B<P.length;++B)P[B]=F&255,F/=256;for(this.v(P),P=Array(16),F=0,B=0;B<4;++B)for(let se=0;se<32;se+=8)P[F++]=this.g[B]>>>se&255;return P};function f(P,F){var B=A;return Object.prototype.hasOwnProperty.call(B,P)?B[P]:B[P]=F(P)}function y(P,F){this.h=F;const B=[];let se=!0;for(let Z=P.length-1;Z>=0;Z--){const Q=P[Z]|0;se&&Q==F||(B[Z]=Q,se=!1)}this.g=B}var A={};function C(P){return-128<=P&&P<128?f(P,function(F){return new y([F|0],F<0?-1:0)}):new y([P|0],P<0?-1:0)}function E(P){if(isNaN(P)||!isFinite(P))return I;if(P<0)return J(E(-P));const F=[];let B=1;for(let se=0;P>=B;se++)F[se]=P/B|0,B*=4294967296;return new y(F,0)}function S(P,F){if(P.length==0)throw Error("number format error: empty string");if(F=F||10,F<2||36<F)throw Error("radix out of range: "+F);if(P.charAt(0)=="-")return J(S(P.substring(1),F));if(P.indexOf("-")>=0)throw Error('number format error: interior "-" character');const B=E(Math.pow(F,8));let se=I;for(let Q=0;Q<P.length;Q+=8){var Z=Math.min(8,P.length-Q);const z=parseInt(P.substring(Q,Q+Z),F);Z<8?(Z=E(Math.pow(F,Z)),se=se.j(Z).add(E(z))):(se=se.j(B),se=se.add(E(z)))}return se}var I=C(0),j=C(1),Y=C(16777216);i=y.prototype,i.m=function(){if(G(this))return-J(this).m();let P=0,F=1;for(let B=0;B<this.g.length;B++){const se=this.i(B);P+=(se>=0?se:4294967296+se)*F,F*=4294967296}return P},i.toString=function(P){if(P=P||10,P<2||36<P)throw Error("radix out of range: "+P);if(X(this))return"0";if(G(this))return"-"+J(this).toString(P);const F=E(Math.pow(P,6));var B=this;let se="";for(;;){const Z=be(B,F).g;B=ae(B,Z.j(F));let Q=((B.g.length>0?B.g[0]:B.h)>>>0).toString(P);if(B=Z,X(B))return Q+se;for(;Q.length<6;)Q="0"+Q;se=Q+se}},i.i=function(P){return P<0?0:P<this.g.length?this.g[P]:this.h};function X(P){if(P.h!=0)return!1;for(let F=0;F<P.g.length;F++)if(P.g[F]!=0)return!1;return!0}function G(P){return P.h==-1}i.l=function(P){return P=ae(this,P),G(P)?-1:X(P)?0:1};function J(P){const F=P.g.length,B=[];for(let se=0;se<F;se++)B[se]=~P.g[se];return new y(B,~P.h).add(j)}i.abs=function(){return G(this)?J(this):this},i.add=function(P){const F=Math.max(this.g.length,P.g.length),B=[];let se=0;for(let Z=0;Z<=F;Z++){let Q=se+(this.i(Z)&65535)+(P.i(Z)&65535),z=(Q>>>16)+(this.i(Z)>>>16)+(P.i(Z)>>>16);se=z>>>16,Q&=65535,z&=65535,B[Z]=z<<16|Q}return new y(B,B[B.length-1]&-2147483648?-1:0)};function ae(P,F){return P.add(J(F))}i.j=function(P){if(X(this)||X(P))return I;if(G(this))return G(P)?J(this).j(J(P)):J(J(this).j(P));if(G(P))return J(this.j(J(P)));if(this.l(Y)<0&&P.l(Y)<0)return E(this.m()*P.m());const F=this.g.length+P.g.length,B=[];for(var se=0;se<2*F;se++)B[se]=0;for(se=0;se<this.g.length;se++)for(let Z=0;Z<P.g.length;Z++){const Q=this.i(se)>>>16,z=this.i(se)&65535,Ye=P.i(Z)>>>16,me=P.i(Z)&65535;B[2*se+2*Z]+=z*me,ne(B,2*se+2*Z),B[2*se+2*Z+1]+=Q*me,ne(B,2*se+2*Z+1),B[2*se+2*Z+1]+=z*Ye,ne(B,2*se+2*Z+1),B[2*se+2*Z+2]+=Q*Ye,ne(B,2*se+2*Z+2)}for(P=0;P<F;P++)B[P]=B[2*P+1]<<16|B[2*P];for(P=F;P<2*F;P++)B[P]=0;return new y(B,0)};function ne(P,F){for(;(P[F]&65535)!=P[F];)P[F+1]+=P[F]>>>16,P[F]&=65535,F++}function ue(P,F){this.g=P,this.h=F}function be(P,F){if(X(F))throw Error("division by zero");if(X(P))return new ue(I,I);if(G(P))return F=be(J(P),F),new ue(J(F.g),J(F.h));if(G(F))return F=be(P,J(F)),new ue(J(F.g),F.h);if(P.g.length>30){if(G(P)||G(F))throw Error("slowDivide_ only works with positive integers.");for(var B=j,se=F;se.l(P)<=0;)B=Me(B),se=Me(se);var Z=Ce(B,1),Q=Ce(se,1);for(se=Ce(se,2),B=Ce(B,2);!X(se);){var z=Q.add(se);z.l(P)<=0&&(Z=Z.add(B),Q=z),se=Ce(se,1),B=Ce(B,1)}return F=ae(P,Z.j(F)),new ue(Z,F)}for(Z=I;P.l(F)>=0;){for(B=Math.max(1,Math.floor(P.m()/F.m())),se=Math.ceil(Math.log(B)/Math.LN2),se=se<=48?1:Math.pow(2,se-48),Q=E(B),z=Q.j(F);G(z)||z.l(P)>0;)B-=se,Q=E(B),z=Q.j(F);X(Q)&&(Q=j),Z=Z.add(Q),P=ae(P,z)}return new ue(Z,P)}i.B=function(P){return be(this,P).h},i.and=function(P){const F=Math.max(this.g.length,P.g.length),B=[];for(let se=0;se<F;se++)B[se]=this.i(se)&P.i(se);return new y(B,this.h&P.h)},i.or=function(P){const F=Math.max(this.g.length,P.g.length),B=[];for(let se=0;se<F;se++)B[se]=this.i(se)|P.i(se);return new y(B,this.h|P.h)},i.xor=function(P){const F=Math.max(this.g.length,P.g.length),B=[];for(let se=0;se<F;se++)B[se]=this.i(se)^P.i(se);return new y(B,this.h^P.h)};function Me(P){const F=P.g.length+1,B=[];for(let se=0;se<F;se++)B[se]=P.i(se)<<1|P.i(se-1)>>>31;return new y(B,P.h)}function Ce(P,F){const B=F>>5;F%=32;const se=P.g.length-B,Z=[];for(let Q=0;Q<se;Q++)Z[Q]=F>0?P.i(Q+B)>>>F|P.i(Q+B+1)<<32-F:P.i(Q+B);return new y(Z,P.h)}a.prototype.digest=a.prototype.A,a.prototype.reset=a.prototype.u,a.prototype.update=a.prototype.v,tb=a,y.prototype.add=y.prototype.add,y.prototype.multiply=y.prototype.j,y.prototype.modulo=y.prototype.B,y.prototype.compare=y.prototype.l,y.prototype.toNumber=y.prototype.m,y.prototype.toString=y.prototype.toString,y.prototype.getBits=y.prototype.i,y.fromNumber=E,y.fromString=S,Ro=y}).apply(typeof wx<"u"?wx:typeof self<"u"?self:typeof window<"u"?window:{});var hd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var nb,bu,sb,Ad,J0,ib,rb,ab;(function(){var i,e=Object.defineProperty;function t(x){x=[typeof globalThis=="object"&&globalThis,x,typeof window=="object"&&window,typeof self=="object"&&self,typeof hd=="object"&&hd];for(var N=0;N<x.length;++N){var k=x[N];if(k&&k.Math==Math)return k}throw Error("Cannot find global object")}var a=t(this);function h(x,N){if(N)e:{var k=a;x=x.split(".");for(var q=0;q<x.length-1;q++){var ve=x[q];if(!(ve in k))break e;k=k[ve]}x=x[x.length-1],q=k[x],N=N(q),N!=q&&N!=null&&e(k,x,{configurable:!0,writable:!0,value:N})}}h("Symbol.dispose",function(x){return x||Symbol("Symbol.dispose")}),h("Array.prototype.values",function(x){return x||function(){return this[Symbol.iterator]()}}),h("Object.entries",function(x){return x||function(N){var k=[],q;for(q in N)Object.prototype.hasOwnProperty.call(N,q)&&k.push([q,N[q]]);return k}});var f=f||{},y=this||self;function A(x){var N=typeof x;return N=="object"&&x!=null||N=="function"}function C(x,N,k){return x.call.apply(x.bind,arguments)}function E(x,N,k){return E=C,E.apply(null,arguments)}function S(x,N){var k=Array.prototype.slice.call(arguments,1);return function(){var q=k.slice();return q.push.apply(q,arguments),x.apply(this,q)}}function I(x,N){function k(){}k.prototype=N.prototype,x.Z=N.prototype,x.prototype=new k,x.prototype.constructor=x,x.Ob=function(q,ve,ke){for(var Je=Array(arguments.length-2),Mt=2;Mt<arguments.length;Mt++)Je[Mt-2]=arguments[Mt];return N.prototype[ve].apply(q,Je)}}var j=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?x=>x&&AsyncContext.Snapshot.wrap(x):x=>x;function Y(x){const N=x.length;if(N>0){const k=Array(N);for(let q=0;q<N;q++)k[q]=x[q];return k}return[]}function X(x,N){for(let q=1;q<arguments.length;q++){const ve=arguments[q];var k=typeof ve;if(k=k!="object"?k:ve?Array.isArray(ve)?"array":k:"null",k=="array"||k=="object"&&typeof ve.length=="number"){k=x.length||0;const ke=ve.length||0;x.length=k+ke;for(let Je=0;Je<ke;Je++)x[k+Je]=ve[Je]}else x.push(ve)}}class G{constructor(N,k){this.i=N,this.j=k,this.h=0,this.g=null}get(){let N;return this.h>0?(this.h--,N=this.g,this.g=N.next,N.next=null):N=this.i(),N}}function J(x){y.setTimeout(()=>{throw x},0)}function ae(){var x=P;let N=null;return x.g&&(N=x.g,x.g=x.g.next,x.g||(x.h=null),N.next=null),N}class ne{constructor(){this.h=this.g=null}add(N,k){const q=ue.get();q.set(N,k),this.h?this.h.next=q:this.g=q,this.h=q}}var ue=new G(()=>new be,x=>x.reset());class be{constructor(){this.next=this.g=this.h=null}set(N,k){this.h=N,this.g=k,this.next=null}reset(){this.next=this.g=this.h=null}}let Me,Ce=!1,P=new ne,F=()=>{const x=Promise.resolve(void 0);Me=()=>{x.then(B)}};function B(){for(var x;x=ae();){try{x.h.call(x.g)}catch(k){J(k)}var N=ue;N.j(x),N.h<100&&(N.h++,x.next=N.g,N.g=x)}Ce=!1}function se(){this.u=this.u,this.C=this.C}se.prototype.u=!1,se.prototype.dispose=function(){this.u||(this.u=!0,this.N())},se.prototype[Symbol.dispose]=function(){this.dispose()},se.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function Z(x,N){this.type=x,this.g=this.target=N,this.defaultPrevented=!1}Z.prototype.h=function(){this.defaultPrevented=!0};var Q=(function(){if(!y.addEventListener||!Object.defineProperty)return!1;var x=!1,N=Object.defineProperty({},"passive",{get:function(){x=!0}});try{const k=()=>{};y.addEventListener("test",k,N),y.removeEventListener("test",k,N)}catch{}return x})();function z(x){return/^[\s\xa0]*$/.test(x)}function Ye(x,N){Z.call(this,x?x.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,x&&this.init(x,N)}I(Ye,Z),Ye.prototype.init=function(x,N){const k=this.type=x.type,q=x.changedTouches&&x.changedTouches.length?x.changedTouches[0]:null;this.target=x.target||x.srcElement,this.g=N,N=x.relatedTarget,N||(k=="mouseover"?N=x.fromElement:k=="mouseout"&&(N=x.toElement)),this.relatedTarget=N,q?(this.clientX=q.clientX!==void 0?q.clientX:q.pageX,this.clientY=q.clientY!==void 0?q.clientY:q.pageY,this.screenX=q.screenX||0,this.screenY=q.screenY||0):(this.clientX=x.clientX!==void 0?x.clientX:x.pageX,this.clientY=x.clientY!==void 0?x.clientY:x.pageY,this.screenX=x.screenX||0,this.screenY=x.screenY||0),this.button=x.button,this.key=x.key||"",this.ctrlKey=x.ctrlKey,this.altKey=x.altKey,this.shiftKey=x.shiftKey,this.metaKey=x.metaKey,this.pointerId=x.pointerId||0,this.pointerType=x.pointerType,this.state=x.state,this.i=x,x.defaultPrevented&&Ye.Z.h.call(this)},Ye.prototype.h=function(){Ye.Z.h.call(this);const x=this.i;x.preventDefault?x.preventDefault():x.returnValue=!1};var me="closure_listenable_"+(Math.random()*1e6|0),te=0;function ge(x,N,k,q,ve){this.listener=x,this.proxy=null,this.src=N,this.type=k,this.capture=!!q,this.ha=ve,this.key=++te,this.da=this.fa=!1}function He(x){x.da=!0,x.listener=null,x.proxy=null,x.src=null,x.ha=null}function Ne(x,N,k){for(const q in x)N.call(k,x[q],q,x)}function tt(x,N){for(const k in x)N.call(void 0,x[k],k,x)}function L(x){const N={};for(const k in x)N[k]=x[k];return N}const oe="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function ce(x,N){let k,q;for(let ve=1;ve<arguments.length;ve++){q=arguments[ve];for(k in q)x[k]=q[k];for(let ke=0;ke<oe.length;ke++)k=oe[ke],Object.prototype.hasOwnProperty.call(q,k)&&(x[k]=q[k])}}function pe(x){this.src=x,this.g={},this.h=0}pe.prototype.add=function(x,N,k,q,ve){const ke=x.toString();x=this.g[ke],x||(x=this.g[ke]=[],this.h++);const Je=ie(x,N,q,ve);return Je>-1?(N=x[Je],k||(N.fa=!1)):(N=new ge(N,this.src,ke,!!q,ve),N.fa=k,x.push(N)),N};function ee(x,N){const k=N.type;if(k in x.g){var q=x.g[k],ve=Array.prototype.indexOf.call(q,N,void 0),ke;(ke=ve>=0)&&Array.prototype.splice.call(q,ve,1),ke&&(He(N),x.g[k].length==0&&(delete x.g[k],x.h--))}}function ie(x,N,k,q){for(let ve=0;ve<x.length;++ve){const ke=x[ve];if(!ke.da&&ke.listener==N&&ke.capture==!!k&&ke.ha==q)return ve}return-1}var Te="closure_lm_"+(Math.random()*1e6|0),Pe={};function it(x,N,k,q,ve){if(Array.isArray(N)){for(let ke=0;ke<N.length;ke++)it(x,N[ke],k,q,ve);return null}return k=mt(k),x&&x[me]?x.J(N,k,A(q)?!!q.capture:!1,ve):dt(x,N,k,!1,q,ve)}function dt(x,N,k,q,ve,ke){if(!N)throw Error("Invalid event type");const Je=A(ve)?!!ve.capture:!!ve;let Mt=Pt(x);if(Mt||(x[Te]=Mt=new pe(x)),k=Mt.add(N,k,q,Je,ke),k.proxy)return k;if(q=Le(),k.proxy=q,q.src=x,q.listener=k,x.addEventListener)Q||(ve=Je),ve===void 0&&(ve=!1),x.addEventListener(N.toString(),q,ve);else if(x.attachEvent)x.attachEvent(Zt(N.toString()),q);else if(x.addListener&&x.removeListener)x.addListener(q);else throw Error("addEventListener and attachEvent are unavailable.");return k}function Le(){function x(k){return N.call(x.src,x.listener,k)}const N=zt;return x}function qt(x,N,k,q,ve){if(Array.isArray(N))for(var ke=0;ke<N.length;ke++)qt(x,N[ke],k,q,ve);else q=A(q)?!!q.capture:!!q,k=mt(k),x&&x[me]?(x=x.i,ke=String(N).toString(),ke in x.g&&(N=x.g[ke],k=ie(N,k,q,ve),k>-1&&(He(N[k]),Array.prototype.splice.call(N,k,1),N.length==0&&(delete x.g[ke],x.h--)))):x&&(x=Pt(x))&&(N=x.g[N.toString()],x=-1,N&&(x=ie(N,k,q,ve)),(k=x>-1?N[x]:null)&&wt(k))}function wt(x){if(typeof x!="number"&&x&&!x.da){var N=x.src;if(N&&N[me])ee(N.i,x);else{var k=x.type,q=x.proxy;N.removeEventListener?N.removeEventListener(k,q,x.capture):N.detachEvent?N.detachEvent(Zt(k),q):N.addListener&&N.removeListener&&N.removeListener(q),(k=Pt(N))?(ee(k,x),k.h==0&&(k.src=null,N[Te]=null)):He(x)}}}function Zt(x){return x in Pe?Pe[x]:Pe[x]="on"+x}function zt(x,N){if(x.da)x=!0;else{N=new Ye(N,this);const k=x.listener,q=x.ha||x.src;x.fa&&wt(x),x=k.call(q,N)}return x}function Pt(x){return x=x[Te],x instanceof pe?x:null}var st="__closure_events_fn_"+(Math.random()*1e9>>>0);function mt(x){return typeof x=="function"?x:(x[st]||(x[st]=function(N){return x.handleEvent(N)}),x[st])}function at(){se.call(this),this.i=new pe(this),this.M=this,this.G=null}I(at,se),at.prototype[me]=!0,at.prototype.removeEventListener=function(x,N,k,q){qt(this,x,N,k,q)};function kt(x,N){var k,q=x.G;if(q)for(k=[];q;q=q.G)k.push(q);if(x=x.M,q=N.type||N,typeof N=="string")N=new Z(N,x);else if(N instanceof Z)N.target=N.target||x;else{var ve=N;N=new Z(q,x),ce(N,ve)}ve=!0;let ke,Je;if(k)for(Je=k.length-1;Je>=0;Je--)ke=N.g=k[Je],ve=de(ke,q,!0,N)&&ve;if(ke=N.g=x,ve=de(ke,q,!0,N)&&ve,ve=de(ke,q,!1,N)&&ve,k)for(Je=0;Je<k.length;Je++)ke=N.g=k[Je],ve=de(ke,q,!1,N)&&ve}at.prototype.N=function(){if(at.Z.N.call(this),this.i){var x=this.i;for(const N in x.g){const k=x.g[N];for(let q=0;q<k.length;q++)He(k[q]);delete x.g[N],x.h--}}this.G=null},at.prototype.J=function(x,N,k,q){return this.i.add(String(x),N,!1,k,q)},at.prototype.K=function(x,N,k,q){return this.i.add(String(x),N,!0,k,q)};function de(x,N,k,q){if(N=x.i.g[String(N)],!N)return!0;N=N.concat();let ve=!0;for(let ke=0;ke<N.length;++ke){const Je=N[ke];if(Je&&!Je.da&&Je.capture==k){const Mt=Je.listener,ss=Je.ha||Je.src;Je.fa&&ee(x.i,Je),ve=Mt.call(ss,q)!==!1&&ve}}return ve&&!q.defaultPrevented}function et(x,N){if(typeof x!="function")if(x&&typeof x.handleEvent=="function")x=E(x.handleEvent,x);else throw Error("Invalid listener argument");return Number(N)>2147483647?-1:y.setTimeout(x,N||0)}function Ot(x){x.g=et(()=>{x.g=null,x.i&&(x.i=!1,Ot(x))},x.l);const N=x.h;x.h=null,x.m.apply(null,N)}class ot extends se{constructor(N,k){super(),this.m=N,this.l=k,this.h=null,this.i=!1,this.g=null}j(N){this.h=arguments,this.g?this.i=!0:Ot(this)}N(){super.N(),this.g&&(y.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function xn(x){se.call(this),this.h=x,this.g={}}I(xn,se);var jn=[];function Zn(x){Ne(x.g,function(N,k){this.g.hasOwnProperty(k)&&wt(N)},x),x.g={}}xn.prototype.N=function(){xn.Z.N.call(this),Zn(this)},xn.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Vn=y.JSON.stringify,vn=y.JSON.parse,xs=class{stringify(x){return y.JSON.stringify(x,void 0)}parse(x){return y.JSON.parse(x,void 0)}};function Wn(){}function Cs(){}var Qt={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function We(){Z.call(this,"d")}I(We,Z);function en(){Z.call(this,"c")}I(en,Z);var Ct={},wn=null;function Ls(){return wn=wn||new at}Ct.Ia="serverreachability";function Ai(x){Z.call(this,Ct.Ia,x)}I(Ai,Z);function Nn(x){const N=Ls();kt(N,new Ai(N))}Ct.STAT_EVENT="statevent";function It(x,N){Z.call(this,Ct.STAT_EVENT,x),this.stat=N}I(It,Z);function fn(x){const N=Ls();kt(N,new It(N,x))}Ct.Ja="timingevent";function Hs(x,N){Z.call(this,Ct.Ja,x),this.size=N}I(Hs,Z);function Xs(x,N){if(typeof x!="function")throw Error("Fn must not be null and must be a function");return y.setTimeout(function(){x()},N)}function Tn(){this.g=!0}Tn.prototype.ua=function(){this.g=!1};function Ci(x,N,k,q,ve,ke){x.info(function(){if(x.g)if(ke){var Je="",Mt=ke.split("&");for(let mn=0;mn<Mt.length;mn++){var ss=Mt[mn].split("=");if(ss.length>1){const Un=ss[0];ss=ss[1];const wi=Un.split("_");Je=wi.length>=2&&wi[1]=="type"?Je+(Un+"="+ss+"&"):Je+(Un+"=redacted&")}}}else Je=null;else Je=ke;return"XMLHTTP REQ ("+q+") [attempt "+ve+"]: "+N+`
`+k+`
`+Je})}function Yn(x,N,k,q,ve,ke,Je){x.info(function(){return"XMLHTTP RESP ("+q+") [ attempt "+ve+"]: "+N+`
`+k+`
`+ke+" "+Je})}function as(x,N,k,q){x.info(function(){return"XMLHTTP TEXT ("+N+"): "+$n(x,k)+(q?" "+q:"")})}function fs(x,N){x.info(function(){return"TIMEOUT: "+N})}Tn.prototype.info=function(){};function $n(x,N){if(!x.g)return N;if(!N)return null;try{const ke=JSON.parse(N);if(ke){for(x=0;x<ke.length;x++)if(Array.isArray(ke[x])){var k=ke[x];if(!(k.length<2)){var q=k[1];if(Array.isArray(q)&&!(q.length<1)){var ve=q[0];if(ve!="noop"&&ve!="stop"&&ve!="close")for(let Je=1;Je<q.length;Je++)q[Je]=""}}}}return Vn(ke)}catch{return N}}var xe={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Ue={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Ze;function $(){}I($,Wn),$.prototype.g=function(){return new XMLHttpRequest},Ze=new $;function Oe(x){return encodeURIComponent(String(x))}function Ke(x){var N=1;x=x.split(":");const k=[];for(;N>0&&x.length;)k.push(x.shift()),N--;return x.length&&k.push(x.join(":")),k}function Re(x,N,k,q){this.j=x,this.i=N,this.l=k,this.S=q||1,this.V=new xn(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new ft}function ft(){this.i=null,this.g="",this.h=!1}var yt={},bt={};function Gn(x,N,k){x.M=1,x.A=oi(es(N)),x.u=k,x.R=!0,os(x,null)}function os(x,N){x.F=Date.now(),Ti(x),x.B=es(x.A);var k=x.B,q=x.S;Array.isArray(q)||(q=[String(q)]),In(k.i,"t",q),x.C=0,k=x.j.L,x.h=new ft,x.g=Ka(x.j,k?N:null,!x.u),x.P>0&&(x.O=new ot(E(x.Y,x,x.g),x.P)),N=x.V,k=x.g,q=x.ba;var ve="readystatechange";Array.isArray(ve)||(ve&&(jn[0]=ve.toString()),ve=jn);for(let ke=0;ke<ve.length;ke++){const Je=it(k,ve[ke],q||N.handleEvent,!1,N.h||N);if(!Je)break;N.g[Je.key]=Je}N=x.J?L(x.J):{},x.u?(x.v||(x.v="POST"),N["Content-Type"]="application/x-www-form-urlencoded",x.g.ea(x.B,x.v,x.u,N)):(x.v="GET",x.g.ea(x.B,x.v,null,N)),Nn(),Ci(x.i,x.v,x.B,x.l,x.S,x.u)}Re.prototype.ba=function(x){x=x.target;const N=this.O;N&&Ii(x)==3?N.j():this.Y(x)},Re.prototype.Y=function(x){try{if(x==this.g)e:{const Mt=Ii(this.g),ss=this.g.ya(),mn=this.g.ca();if(!(Mt<3)&&(Mt!=3||this.g&&(this.h.h||this.g.la()||us(this.g)))){this.K||Mt!=4||ss==7||(ss==8||mn<=0?Nn(3):Nn(2)),pt(this);var N=this.g.ca();this.X=N;var k=Ps(this);if(this.o=N==200,Yn(this.i,this.v,this.B,this.l,this.S,Mt,N),this.o){if(this.U&&!this.L){t:{if(this.g){var q,ve=this.g;if((q=ve.g?ve.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!z(q)){var ke=q;break t}}ke=null}if(x=ke)as(this.i,this.l,x,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Bs(this,x);else{this.o=!1,this.m=3,fn(12),Ss(this),Ht(this);break e}}if(this.R){x=!0;let Un;for(;!this.K&&this.C<k.length;)if(Un=br(this,k),Un==bt){Mt==4&&(this.m=4,fn(14),x=!1),as(this.i,this.l,null,"[Incomplete Response]");break}else if(Un==yt){this.m=4,fn(15),as(this.i,this.l,k,"[Invalid Chunk]"),x=!1;break}else as(this.i,this.l,Un,null),Bs(this,Un);if(vs(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Mt!=4||k.length!=0||this.h.h||(this.m=1,fn(16),x=!1),this.o=this.o&&x,!x)as(this.i,this.l,k,"[Invalid Chunked Response]"),Ss(this),Ht(this);else if(k.length>0&&!this.W){this.W=!0;var Je=this.j;Je.g==this&&Je.aa&&!Je.P&&(Je.j.info("Great, no buffering proxy detected. Bytes received: "+k.length),Ie(Je),Je.P=!0,fn(11))}}else as(this.i,this.l,k,null),Bs(this,k);Mt==4&&Ss(this),this.o&&!this.K&&(Mt==4?aa(this.j,this):(this.o=!1,Ti(this)))}else vi(this.g),N==400&&k.indexOf("Unknown SID")>0?(this.m=3,fn(12)):(this.m=0,fn(13)),Ss(this),Ht(this)}}}catch{}};function Ps(x){if(!vs(x))return x.g.la();const N=us(x.g);if(N==="")return"";let k="";const q=N.length,ve=Ii(x.g)==4;if(!x.h.i){if(typeof TextDecoder>"u")return Ss(x),Ht(x),"";x.h.i=new y.TextDecoder}for(let ke=0;ke<q;ke++)x.h.h=!0,k+=x.h.i.decode(N[ke],{stream:!(ve&&ke==q-1)});return N.length=0,x.h.g+=k,x.C=0,x.h.g}function vs(x){return x.g?x.v=="GET"&&x.M!=2&&x.j.Aa:!1}function br(x,N){var k=x.C,q=N.indexOf(`
`,k);return q==-1?bt:(k=Number(N.substring(k,q)),isNaN(k)?yt:(q+=1,q+k>N.length?bt:(N=N.slice(q,q+k),x.C=q+k,N)))}Re.prototype.cancel=function(){this.K=!0,Ss(this)};function Ti(x){x.T=Date.now()+x.H,Ts(x,x.H)}function Ts(x,N){if(x.D!=null)throw Error("WatchDog timer not null");x.D=Xs(E(x.aa,x),N)}function pt(x){x.D&&(y.clearTimeout(x.D),x.D=null)}Re.prototype.aa=function(){this.D=null;const x=Date.now();x-this.T>=0?(fs(this.i,this.B),this.M!=2&&(Nn(),fn(17)),Ss(this),this.m=2,Ht(this)):Ts(this,this.T-x)};function Ht(x){x.j.I==0||x.K||aa(x.j,x)}function Ss(x){pt(x);var N=x.O;N&&typeof N.dispose=="function"&&N.dispose(),x.O=null,Zn(x.V),x.g&&(N=x.g,x.g=null,N.abort(),N.dispose())}function Bs(x,N){try{var k=x.j;if(k.I!=0&&(k.g==x||Ks(k.h,x))){if(!x.L&&Ks(k.h,x)&&k.I==3){try{var q=k.Ba.g.parse(N)}catch{q=null}if(Array.isArray(q)&&q.length==3){var ve=q;if(ve[0]==0){e:if(!k.v){if(k.g)if(k.g.F+3e3<x.F)ts(k),Ar(k);else break e;ra(k),fn(18)}}else k.xa=ve[1],0<k.xa-k.K&&ve[2]<37500&&k.F&&k.A==0&&!k.C&&(k.C=Xs(E(k.Va,k),6e3));bn(k.h)<=1&&k.ta&&(k.ta=void 0)}else ir(k,11)}else if((x.L||k.g==x)&&ts(k),!z(N))for(ve=k.Ba.g.parse(N),N=0;N<ve.length;N++){let mn=ve[N];const Un=mn[0];if(!(Un<=k.K))if(k.K=Un,mn=mn[1],k.I==2)if(mn[0]=="c"){k.M=mn[1],k.ba=mn[2];const wi=mn[3];wi!=null&&(k.ka=wi,k.j.info("VER="+k.ka));const or=mn[4];or!=null&&(k.za=or,k.j.info("SVER="+k.za));const qs=mn[5];qs!=null&&typeof qs=="number"&&qs>0&&(q=1.5*qs,k.O=q,k.j.info("backChannelRequestTimeoutMs_="+q)),q=k;const bi=x.g;if(bi){const la=bi.g?bi.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(la){var ke=q.h;ke.g||la.indexOf("spdy")==-1&&la.indexOf("quic")==-1&&la.indexOf("h2")==-1||(ke.j=ke.l,ke.g=new Set,ke.h&&(Ho(ke,ke.h),ke.h=null))}if(q.G){const lr=bi.g?bi.g.getResponseHeader("X-HTTP-Session-Id"):null;lr&&(q.wa=lr,St(q.J,q.G,lr))}}k.I=3,k.l&&k.l.ra(),k.aa&&(k.T=Date.now()-x.F,k.j.info("Handshake RTT: "+k.T+"ms")),q=k;var Je=x;if(q.na=Sl(q,q.L?q.ba:null,q.W),Je.L){an(q.h,Je);var Mt=Je,ss=q.O;ss&&(Mt.H=ss),Mt.D&&(pt(Mt),Ti(Mt)),q.g=Je}else Hi(q);k.i.length>0&&sr(k)}else mn[0]!="stop"&&mn[0]!="close"||ir(k,7);else k.I==3&&(mn[0]=="stop"||mn[0]=="close"?mn[0]=="stop"?ir(k,7):Wa(k):mn[0]!="noop"&&k.l&&k.l.qa(mn),k.A=0)}}Nn(4)}catch{}}var Jn=class{constructor(x,N){this.g=x,this.map=N}};function Ge(x){this.l=x||10,y.PerformanceNavigationTiming?(x=y.performance.getEntriesByType("navigation"),x=x.length>0&&(x[0].nextHopProtocol=="hq"||x[0].nextHopProtocol=="h2")):x=!!(y.chrome&&y.chrome.loadTimes&&y.chrome.loadTimes()&&y.chrome.loadTimes().wasFetchedViaSpdy),this.j=x?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function zo(x){return x.h?!0:x.g?x.g.size>=x.j:!1}function bn(x){return x.h?1:x.g?x.g.size:0}function Ks(x,N){return x.h?x.h==N:x.g?x.g.has(N):!1}function Ho(x,N){x.g?x.g.add(N):x.h=N}function an(x,N){x.h&&x.h==N?x.h=null:x.g&&x.g.has(N)&&x.g.delete(N)}Ge.prototype.cancel=function(){if(this.i=tn(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const x of this.g.values())x.cancel();this.g.clear()}};function tn(x){if(x.h!=null)return x.i.concat(x.h.G);if(x.g!=null&&x.g.size!==0){let N=x.i;for(const k of x.g.values())N=N.concat(k.G);return N}return Y(x.i)}var Xt=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Pr(x,N){if(x){x=x.split("&");for(let k=0;k<x.length;k++){const q=x[k].indexOf("=");let ve,ke=null;q>=0?(ve=x[k].substring(0,q),ke=x[k].substring(q+1)):ve=x[k],N(ve,ke?decodeURIComponent(ke.replace(/\+/g," ")):"")}}}function Qs(x){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let N;x instanceof Qs?(this.l=x.l,$t(this,x.j),this.o=x.o,this.g=x.g,Zs(this,x.u),this.h=x.h,Go(this,qo(x.i)),this.m=x.m):x&&(N=String(x).match(Xt))?(this.l=!1,$t(this,N[1]||"",!0),this.o=nr(N[2]||""),this.g=nr(N[3]||"",!0),Zs(this,N[4]),this.h=nr(N[5]||"",!0),Go(this,N[6]||"",!0),this.m=nr(N[7]||"")):(this.l=!1,this.i=new ws(null,this.l))}Qs.prototype.toString=function(){const x=[];var N=this.j;N&&x.push(Si(N,ls,!0),":");var k=this.g;return(k||N=="file")&&(x.push("//"),(N=this.o)&&x.push(Si(N,ls,!0),"@"),x.push(Oe(k).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),k=this.u,k!=null&&x.push(":",String(k))),(k=this.h)&&(this.g&&k.charAt(0)!="/"&&x.push("/"),x.push(Si(k,k.charAt(0)=="/"?W:Ee,!0))),(k=this.i.toString())&&x.push("?",k),(k=this.m)&&x.push("#",Si(k,cs)),x.join("")},Qs.prototype.resolve=function(x){const N=es(this);let k=!!x.j;k?$t(N,x.j):k=!!x.o,k?N.o=x.o:k=!!x.g,k?N.g=x.g:k=x.u!=null;var q=x.h;if(k)Zs(N,x.u);else if(k=!!x.h){if(q.charAt(0)!="/")if(this.g&&!this.h)q="/"+q;else{var ve=N.h.lastIndexOf("/");ve!=-1&&(q=N.h.slice(0,ve+1)+q)}if(ve=q,ve==".."||ve==".")q="";else if(ve.indexOf("./")!=-1||ve.indexOf("/.")!=-1){q=ve.lastIndexOf("/",0)==0,ve=ve.split("/");const ke=[];for(let Je=0;Je<ve.length;){const Mt=ve[Je++];Mt=="."?q&&Je==ve.length&&ke.push(""):Mt==".."?((ke.length>1||ke.length==1&&ke[0]!="")&&ke.pop(),q&&Je==ve.length&&ke.push("")):(ke.push(Mt),q=!0)}q=ke.join("/")}else q=ve}return k?N.h=q:k=x.i.toString()!=="",k?Go(N,qo(x.i)):k=!!x.m,k&&(N.m=x.m),N};function es(x){return new Qs(x)}function $t(x,N,k){x.j=k?nr(N,!0):N,x.j&&(x.j=x.j.replace(/:$/,""))}function Zs(x,N){if(N){if(N=Number(N),isNaN(N)||N<0)throw Error("Bad port number "+N);x.u=N}else x.u=null}function Go(x,N,k){N instanceof ws?(x.i=N,Vr(x.i,x.l)):(k||(N=Si(N,ut)),x.i=new ws(N,x.l))}function St(x,N,k){x.i.set(N,k)}function oi(x){return St(x,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),x}function nr(x,N){return x?N?decodeURI(x.replace(/%25/g,"%2525")):decodeURIComponent(x):""}function Si(x,N,k){return typeof x=="string"?(x=encodeURI(x).replace(N,Wt),k&&(x=x.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),x):null}function Wt(x){return x=x.charCodeAt(0),"%"+(x>>4&15).toString(16)+(x&15).toString(16)}var ls=/[#\/\?@]/g,Ee=/[#\?:]/g,W=/[#\?]/g,ut=/[#\?@]/g,cs=/#/g;function ws(x,N){this.h=this.g=null,this.i=x||null,this.j=!!N}function li(x){x.g||(x.g=new Map,x.h=0,x.i&&Pr(x.i,function(N,k){x.add(decodeURIComponent(N.replace(/\+/g," ")),k)}))}i=ws.prototype,i.add=function(x,N){li(this),this.i=null,x=Br(this,x);let k=this.g.get(x);return k||this.g.set(x,k=[]),k.push(N),this.h+=1,this};function qa(x,N){li(x),N=Br(x,N),x.g.has(N)&&(x.i=null,x.h-=x.g.get(N).length,x.g.delete(N))}function Gs(x,N){return li(x),N=Br(x,N),x.g.has(N)}i.forEach=function(x,N){li(this),this.g.forEach(function(k,q){k.forEach(function(ve){x.call(N,ve,q,this)},this)},this)};function xt(x,N){li(x);let k=[];if(typeof N=="string")Gs(x,N)&&(k=k.concat(x.g.get(Br(x,N))));else for(x=Array.from(x.g.values()),N=0;N<x.length;N++)k=k.concat(x[N]);return k}i.set=function(x,N){return li(this),this.i=null,x=Br(this,x),Gs(this,x)&&(this.h-=this.g.get(x).length),this.g.set(x,[N]),this.h+=1,this},i.get=function(x,N){return x?(x=xt(this,x),x.length>0?String(x[0]):N):N};function In(x,N,k){qa(x,N),k.length>0&&(x.i=null,x.g.set(Br(x,N),Y(k)),x.h+=k.length)}i.toString=function(){if(this.i)return this.i;if(!this.g)return"";const x=[],N=Array.from(this.g.keys());for(let q=0;q<N.length;q++){var k=N[q];const ve=Oe(k);k=xt(this,k);for(let ke=0;ke<k.length;ke++){let Je=ve;k[ke]!==""&&(Je+="="+Oe(k[ke])),x.push(Je)}}return this.i=x.join("&")};function qo(x){const N=new ws;return N.i=x.i,x.g&&(N.g=new Map(x.g),N.h=x.h),N}function Br(x,N){return N=String(N),x.j&&(N=N.toLowerCase()),N}function Vr(x,N){N&&!x.j&&(li(x),x.i=null,x.g.forEach(function(k,q){const ve=q.toLowerCase();q!=ve&&(qa(this,q),In(this,ve,k))},x)),x.j=N}function ci(x,N){const k=new Tn;if(y.Image){const q=new Image;q.onload=S(Ni,k,"TestLoadImage: loaded",!0,N,q),q.onerror=S(Ni,k,"TestLoadImage: error",!1,N,q),q.onabort=S(Ni,k,"TestLoadImage: abort",!1,N,q),q.ontimeout=S(Ni,k,"TestLoadImage: timeout",!1,N,q),y.setTimeout(function(){q.ontimeout&&q.ontimeout()},1e4),q.src=x}else N(!1)}function ta(x,N){const k=new Tn,q=new AbortController,ve=setTimeout(()=>{q.abort(),Ni(k,"TestPingServer: timeout",!1,N)},1e4);fetch(x,{signal:q.signal}).then(ke=>{clearTimeout(ve),ke.ok?Ni(k,"TestPingServer: ok",!0,N):Ni(k,"TestPingServer: server error",!1,N)}).catch(()=>{clearTimeout(ve),Ni(k,"TestPingServer: error",!1,N)})}function Ni(x,N,k,q,ve){try{ve&&(ve.onload=null,ve.onerror=null,ve.onabort=null,ve.ontimeout=null),q(k)}catch{}}function Fn(){this.g=new xs}function ui(x){this.i=x.Sb||null,this.h=x.ab||!1}I(ui,Wn),ui.prototype.g=function(){return new hi(this.i,this.h)};function hi(x,N){at.call(this),this.H=x,this.o=N,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}I(hi,at),i=hi.prototype,i.open=function(x,N){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=x,this.D=N,this.readyState=1,Tt(this)},i.send=function(x){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const N={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};x&&(N.body=x),(this.H||y).fetch(new Request(this.D,N)).then(this.Pa.bind(this),this.ga.bind(this))},i.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Fr(this)),this.readyState=0},i.Pa=function(x){if(this.g&&(this.l=x,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=x.headers,this.readyState=2,Tt(this)),this.g&&(this.readyState=3,Tt(this),this.g)))if(this.responseType==="arraybuffer")x.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof y.ReadableStream<"u"&&"body"in x){if(this.j=x.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Et(this)}else x.text().then(this.Oa.bind(this),this.ga.bind(this))};function Et(x){x.j.read().then(x.Ma.bind(x)).catch(x.ga.bind(x))}i.Ma=function(x){if(this.g){if(this.o&&x.value)this.response.push(x.value);else if(!this.o){var N=x.value?x.value:new Uint8Array(0);(N=this.B.decode(N,{stream:!x.done}))&&(this.response=this.responseText+=N)}x.done?Fr(this):Tt(this),this.readyState==3&&Et(this)}},i.Oa=function(x){this.g&&(this.response=this.responseText=x,Fr(this))},i.Na=function(x){this.g&&(this.response=x,Fr(this))},i.ga=function(){this.g&&Fr(this)};function Fr(x){x.readyState=4,x.l=null,x.j=null,x.B=null,Tt(x)}i.setRequestHeader=function(x,N){this.A.append(x,N)},i.getResponseHeader=function(x){return this.h&&this.h.get(x.toLowerCase())||""},i.getAllResponseHeaders=function(){if(!this.h)return"";const x=[],N=this.h.entries();for(var k=N.next();!k.done;)k=k.value,x.push(k[0]+": "+k[1]),k=N.next();return x.join(`\r
`)};function Tt(x){x.onreadystatechange&&x.onreadystatechange.call(x)}Object.defineProperty(hi.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(x){this.m=x?"include":"same-origin"}});function Rn(x){let N="";return Ne(x,function(k,q){N+=q,N+=":",N+=k,N+=`\r
`}),N}function na(x,N,k){e:{for(q in k){var q=!1;break e}q=!0}q||(k=Rn(k),typeof x=="string"?k!=null&&Oe(k):St(x,N,k))}function _n(x){at.call(this),this.headers=new Map,this.L=x||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}I(_n,at);var Fi=/^https?$/i,Ui=["POST","PUT"];i=_n.prototype,i.Fa=function(x){this.H=x},i.ea=function(x,N,k,q){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+x);N=N?N.toUpperCase():"GET",this.D=x,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Ze.g(),this.g.onreadystatechange=j(E(this.Ca,this));try{this.B=!0,this.g.open(N,String(x),!0),this.B=!1}catch(ke){sa(this,ke);return}if(x=k||"",k=new Map(this.headers),q)if(Object.getPrototypeOf(q)===Object.prototype)for(var ve in q)k.set(ve,q[ve]);else if(typeof q.keys=="function"&&typeof q.get=="function")for(const ke of q.keys())k.set(ke,q.get(ke));else throw Error("Unknown input type for opt_headers: "+String(q));q=Array.from(k.keys()).find(ke=>ke.toLowerCase()=="content-type"),ve=y.FormData&&x instanceof y.FormData,!(Array.prototype.indexOf.call(Ui,N,void 0)>=0)||q||ve||k.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[ke,Je]of k)this.g.setRequestHeader(ke,Je);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(x),this.v=!1}catch(ke){sa(this,ke)}};function sa(x,N){x.h=!1,x.g&&(x.j=!0,x.g.abort(),x.j=!1),x.l=N,x.o=5,Er(x),xi(x)}function Er(x){x.A||(x.A=!0,kt(x,"complete"),kt(x,"error"))}i.abort=function(x){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=x||7,kt(this,"complete"),kt(this,"abort"),xi(this))},i.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),xi(this,!0)),_n.Z.N.call(this)},i.Ca=function(){this.u||(this.B||this.v||this.j?zi(this):this.Xa())},i.Xa=function(){zi(this)};function zi(x){if(x.h&&typeof f<"u"){if(x.v&&Ii(x)==4)setTimeout(x.Ca.bind(x),0);else if(kt(x,"readystatechange"),Ii(x)==4){x.h=!1;try{const ke=x.ca();e:switch(ke){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var N=!0;break e;default:N=!1}var k;if(!(k=N)){var q;if(q=ke===0){let Je=String(x.D).match(Xt)[1]||null;!Je&&y.self&&y.self.location&&(Je=y.self.location.protocol.slice(0,-1)),q=!Fi.test(Je?Je.toLowerCase():"")}k=q}if(k)kt(x,"complete"),kt(x,"success");else{x.o=6;try{var ve=Ii(x)>2?x.g.statusText:""}catch{ve=""}x.l=ve+" ["+x.ca()+"]",Er(x)}}finally{xi(x)}}}}function xi(x,N){if(x.g){x.m&&(clearTimeout(x.m),x.m=null);const k=x.g;x.g=null,N||kt(x,"ready");try{k.onreadystatechange=null}catch{}}}i.isActive=function(){return!!this.g};function Ii(x){return x.g?x.g.readyState:0}i.ca=function(){try{return Ii(this)>2?this.g.status:-1}catch{return-1}},i.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},i.La=function(x){if(this.g){var N=this.g.responseText;return x&&N.indexOf(x)==0&&(N=N.substring(x.length)),vn(N)}};function us(x){try{if(!x.g)return null;if("response"in x.g)return x.g.response;switch(x.F){case"":case"text":return x.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in x.g)return x.g.mozResponseArrayBuffer}return null}catch{return null}}function vi(x){const N={};x=(x.g&&Ii(x)>=2&&x.g.getAllResponseHeaders()||"").split(`\r
`);for(let q=0;q<x.length;q++){if(z(x[q]))continue;var k=Ke(x[q]);const ve=k[0];if(k=k[1],typeof k!="string")continue;k=k.trim();const ke=N[ve]||[];N[ve]=ke,ke.push(k)}tt(N,function(q){return q.join(", ")})}i.ya=function(){return this.o},i.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Xn(x,N,k){return k&&k.internalChannelParams&&k.internalChannelParams[x]||N}function _r(x){this.za=0,this.i=[],this.j=new Tn,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Xn("failFast",!1,x),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Xn("baseRetryDelayMs",5e3,x),this.Za=Xn("retryDelaySeedMs",1e4,x),this.Ta=Xn("forwardChannelMaxRetries",2,x),this.va=Xn("forwardChannelRequestTimeoutMs",2e4,x),this.ma=x&&x.xmlHttpFactory||void 0,this.Ua=x&&x.Rb||void 0,this.Aa=x&&x.useFetchStreams||!1,this.O=void 0,this.L=x&&x.supportsCrossDomainXhr||!1,this.M="",this.h=new Ge(x&&x.concurrentRequestLimit),this.Ba=new Fn,this.S=x&&x.fastHandshake||!1,this.R=x&&x.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=x&&x.Pb||!1,x&&x.ua&&this.j.ua(),x&&x.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&x&&x.detectBufferingProxy||!1,this.ia=void 0,x&&x.longPollingTimeout&&x.longPollingTimeout>0&&(this.ia=x.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}i=_r.prototype,i.ka=8,i.I=1,i.connect=function(x,N,k,q){fn(0),this.W=x,this.H=N||{},k&&q!==void 0&&(this.H.OSID=k,this.H.OAID=q),this.F=this.X,this.J=Sl(this,null,this.W),sr(this)};function Wa(x){if(Ya(x),x.I==3){var N=x.V++,k=es(x.J);if(St(k,"SID",x.M),St(k,"RID",N),St(k,"TYPE","terminate"),Ur(x,k),N=new Re(x,x.j,N),N.M=2,N.A=oi(es(k)),k=!1,y.navigator&&y.navigator.sendBeacon)try{k=y.navigator.sendBeacon(N.A.toString(),"")}catch{}!k&&y.Image&&(new Image().src=N.A,k=!0),k||(N.g=Ka(N.j,null),N.g.ea(N.A)),N.F=Date.now(),Ti(N)}Tl(x)}function Ar(x){x.g&&(Ie(x),x.g.cancel(),x.g=null)}function Ya(x){Ar(x),x.v&&(y.clearTimeout(x.v),x.v=null),ts(x),x.h.cancel(),x.m&&(typeof x.m=="number"&&y.clearTimeout(x.m),x.m=null)}function sr(x){if(!zo(x.h)&&!x.m){x.m=!0;var N=x.Ea;Me||F(),Ce||(Me(),Ce=!0),P.add(N,x),x.D=0}}function Xa(x,N){return bn(x.h)>=x.h.j-(x.m?1:0)?!1:x.m?(x.i=N.G.concat(x.i),!0):x.I==1||x.I==2||x.D>=(x.Sa?0:x.Ta)?!1:(x.m=Xs(E(x.Ea,x,N),Wo(x,x.D)),x.D++,!0)}i.Ea=function(x){if(this.m)if(this.m=null,this.I==1){if(!x){this.V=Math.floor(Math.random()*1e5),x=this.V++;const ve=new Re(this,this.j,x);let ke=this.o;if(this.U&&(ke?(ke=L(ke),ce(ke,this.U)):ke=this.U),this.u!==null||this.R||(ve.J=ke,ke=null),this.S)e:{for(var N=0,k=0;k<this.i.length;k++){t:{var q=this.i[k];if("__data__"in q.map&&(q=q.map.__data__,typeof q=="string")){q=q.length;break t}q=void 0}if(q===void 0)break;if(N+=q,N>4096){N=k;break e}if(N===4096||k===this.i.length-1){N=k+1;break e}}N=1e3}else N=1e3;N=ia(this,ve,N),k=es(this.J),St(k,"RID",x),St(k,"CVER",22),this.G&&St(k,"X-HTTP-Session-Id",this.G),Ur(this,k),ke&&(this.R?N="headers="+Oe(Rn(ke))+"&"+N:this.u&&na(k,this.u,ke)),Ho(this.h,ve),this.Ra&&St(k,"TYPE","init"),this.S?(St(k,"$req",N),St(k,"SID","null"),ve.U=!0,Gn(ve,k,null)):Gn(ve,k,N),this.I=2}}else this.I==3&&(x?pn(this,x):this.i.length==0||zo(this.h)||pn(this))};function pn(x,N){var k;N?k=N.l:k=x.V++;const q=es(x.J);St(q,"SID",x.M),St(q,"RID",k),St(q,"AID",x.K),Ur(x,q),x.u&&x.o&&na(q,x.u,x.o),k=new Re(x,x.j,k,x.D+1),x.u===null&&(k.J=x.o),N&&(x.i=N.G.concat(x.i)),N=ia(x,k,1e3),k.H=Math.round(x.va*.5)+Math.round(x.va*.5*Math.random()),Ho(x.h,k),Gn(k,q,N)}function Ur(x,N){x.H&&Ne(x.H,function(k,q){St(N,q,k)}),x.l&&Ne({},function(k,q){St(N,q,k)})}function ia(x,N,k){k=Math.min(x.i.length,k);const q=x.l?E(x.l.Ka,x.l,x):null;e:{var ve=x.i;let Mt=-1;for(;;){const ss=["count="+k];Mt==-1?k>0?(Mt=ve[0].g,ss.push("ofs="+Mt)):Mt=0:ss.push("ofs="+Mt);let mn=!0;for(let Un=0;Un<k;Un++){var ke=ve[Un].g;const wi=ve[Un].map;if(ke-=Mt,ke<0)Mt=Math.max(0,ve[Un].g-100),mn=!1;else try{ke="req"+ke+"_"||"";try{var Je=wi instanceof Map?wi:Object.entries(wi);for(const[or,qs]of Je){let bi=qs;A(qs)&&(bi=Vn(qs)),ss.push(ke+or+"="+encodeURIComponent(bi))}}catch(or){throw ss.push(ke+"type="+encodeURIComponent("_badmap")),or}}catch{q&&q(wi)}}if(mn){Je=ss.join("&");break e}}Je=void 0}return x=x.i.splice(0,k),N.G=x,Je}function Hi(x){if(!x.g&&!x.v){x.Y=1;var N=x.Da;Me||F(),Ce||(Me(),Ce=!0),P.add(N,x),x.A=0}}function ra(x){return x.g||x.v||x.A>=3?!1:(x.Y++,x.v=Xs(E(x.Da,x),Wo(x,x.A)),x.A++,!0)}i.Da=function(){if(this.v=null,Bt(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var x=4*this.T;this.j.info("BP detection timer enabled: "+x),this.B=Xs(E(this.Wa,this),x)}},i.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,fn(10),Ar(this),Bt(this))};function Ie(x){x.B!=null&&(y.clearTimeout(x.B),x.B=null)}function Bt(x){x.g=new Re(x,x.j,"rpc",x.Y),x.u===null&&(x.g.J=x.o),x.g.P=0;var N=es(x.na);St(N,"RID","rpc"),St(N,"SID",x.M),St(N,"AID",x.K),St(N,"CI",x.F?"0":"1"),!x.F&&x.ia&&St(N,"TO",x.ia),St(N,"TYPE","xmlhttp"),Ur(x,N),x.u&&x.o&&na(N,x.u,x.o),x.O&&(x.g.H=x.O);var k=x.g;x=x.ba,k.M=1,k.A=oi(es(N)),k.u=null,k.R=!0,os(k,x)}i.Va=function(){this.C!=null&&(this.C=null,Ar(this),ra(this),fn(19))};function ts(x){x.C!=null&&(y.clearTimeout(x.C),x.C=null)}function aa(x,N){var k=null;if(x.g==N){ts(x),Ie(x),x.g=null;var q=2}else if(Ks(x.h,N))k=N.G,an(x.h,N),q=1;else return;if(x.I!=0){if(N.o)if(q==1){k=N.u?N.u.length:0,N=Date.now()-N.F;var ve=x.D;q=Ls(),kt(q,new Hs(q,k)),sr(x)}else Hi(x);else if(ve=N.m,ve==3||ve==0&&N.X>0||!(q==1&&Xa(x,N)||q==2&&ra(x)))switch(k&&k.length>0&&(N=x.h,N.i=N.i.concat(k)),ve){case 1:ir(x,5);break;case 4:ir(x,10);break;case 3:ir(x,6);break;default:ir(x,2)}}}function Wo(x,N){let k=x.Qa+Math.floor(Math.random()*x.Za);return x.isActive()||(k*=2),k*N}function ir(x,N){if(x.j.info("Error code "+N),N==2){var k=E(x.bb,x),q=x.Ua;const ve=!q;q=new Qs(q||"//www.google.com/images/cleardot.gif"),y.location&&y.location.protocol=="http"||$t(q,"https"),oi(q),ve?ci(q.toString(),k):ta(q.toString(),k)}else fn(2);x.I=0,x.l&&x.l.pa(N),Tl(x),Ya(x)}i.bb=function(x){x?(this.j.info("Successfully pinged google.com"),fn(2)):(this.j.info("Failed to ping google.com"),fn(1))};function Tl(x){if(x.I=0,x.ja=[],x.l){const N=tn(x.h);(N.length!=0||x.i.length!=0)&&(X(x.ja,N),X(x.ja,x.i),x.h.i.length=0,Y(x.i),x.i.length=0),x.l.oa()}}function Sl(x,N,k){var q=k instanceof Qs?es(k):new Qs(k);if(q.g!="")N&&(q.g=N+"."+q.g),Zs(q,q.u);else{var ve=y.location;q=ve.protocol,N=N?N+"."+ve.hostname:ve.hostname,ve=+ve.port;const ke=new Qs(null);q&&$t(ke,q),N&&(ke.g=N),ve&&Zs(ke,ve),k&&(ke.h=k),q=ke}return k=x.G,N=x.wa,k&&N&&St(q,k,N),St(q,"VER",x.ka),Ur(x,q),q}function Ka(x,N,k){if(N&&!x.L)throw Error("Can't create secondary domain capable XhrIo object.");return N=x.Aa&&!x.ma?new _n(new ui({ab:k})):new _n(x.ma),N.Fa(x.L),N}i.isActive=function(){return!!this.l&&this.l.isActive(this)};function ns(){}i=ns.prototype,i.ra=function(){},i.qa=function(){},i.pa=function(){},i.oa=function(){},i.isActive=function(){return!0},i.Ka=function(){};function rr(){}rr.prototype.g=function(x,N){return new Jt(x,N)};function Jt(x,N){at.call(this),this.g=new _r(N),this.l=x,this.h=N&&N.messageUrlParams||null,x=N&&N.messageHeaders||null,N&&N.clientProtocolHeaderRequired&&(x?x["X-Client-Protocol"]="webchannel":x={"X-Client-Protocol":"webchannel"}),this.g.o=x,x=N&&N.initMessageHeaders||null,N&&N.messageContentType&&(x?x["X-WebChannel-Content-Type"]=N.messageContentType:x={"X-WebChannel-Content-Type":N.messageContentType}),N&&N.sa&&(x?x["X-WebChannel-Client-Profile"]=N.sa:x={"X-WebChannel-Client-Profile":N.sa}),this.g.U=x,(x=N&&N.Qb)&&!z(x)&&(this.g.u=x),this.A=N&&N.supportsCrossDomainXhr||!1,this.v=N&&N.sendRawJson||!1,(N=N&&N.httpSessionIdParam)&&!z(N)&&(this.g.G=N,x=this.h,x!==null&&N in x&&(x=this.h,N in x&&delete x[N])),this.j=new nn(this)}I(Jt,at),Jt.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Jt.prototype.close=function(){Wa(this.g)},Jt.prototype.o=function(x){var N=this.g;if(typeof x=="string"){var k={};k.__data__=x,x=k}else this.v&&(k={},k.__data__=Vn(x),x=k);N.i.push(new Jn(N.Ya++,x)),N.I==3&&sr(N)},Jt.prototype.N=function(){this.g.l=null,delete this.j,Wa(this.g),delete this.g,Jt.Z.N.call(this)};function oa(x){We.call(this),x.__headers__&&(this.headers=x.__headers__,this.statusCode=x.__status__,delete x.__headers__,delete x.__status__);var N=x.__sm__;if(N){e:{for(const k in N){x=k;break e}x=void 0}(this.i=x)&&(x=this.i,N=N!==null&&x in N?N[x]:void 0),this.data=N}else this.data=x}I(oa,We);function ar(){en.call(this),this.status=1}I(ar,en);function nn(x){this.g=x}I(nn,ns),nn.prototype.ra=function(){kt(this.g,"a")},nn.prototype.qa=function(x){kt(this.g,new oa(x))},nn.prototype.pa=function(x){kt(this.g,new ar)},nn.prototype.oa=function(){kt(this.g,"b")},rr.prototype.createWebChannel=rr.prototype.g,Jt.prototype.send=Jt.prototype.o,Jt.prototype.open=Jt.prototype.m,Jt.prototype.close=Jt.prototype.close,ab=function(){return new rr},rb=function(){return Ls()},ib=Ct,J0={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},xe.NO_ERROR=0,xe.TIMEOUT=8,xe.HTTP_ERROR=6,Ad=xe,Ue.COMPLETE="complete",sb=Ue,Cs.EventType=Qt,Qt.OPEN="a",Qt.CLOSE="b",Qt.ERROR="c",Qt.MESSAGE="d",at.prototype.listen=at.prototype.J,bu=Cs,_n.prototype.listenOnce=_n.prototype.K,_n.prototype.getLastError=_n.prototype.Ha,_n.prototype.getLastErrorCode=_n.prototype.ya,_n.prototype.getStatus=_n.prototype.ca,_n.prototype.getResponseJson=_n.prototype.La,_n.prototype.getResponseText=_n.prototype.la,_n.prototype.send=_n.prototype.ea,_n.prototype.setWithCredentials=_n.prototype.Fa,nb=_n}).apply(typeof hd<"u"?hd:typeof self<"u"?self:typeof window<"u"?window:{});class gi{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}gi.UNAUTHENTICATED=new gi(null),gi.GOOGLE_CREDENTIALS=new gi("google-credentials-uid"),gi.FIRST_PARTY=new gi("first-party-uid"),gi.MOCK_USER=new gi("mock-user");let Nc="12.8.0";function Z4(i){Nc=i}const xl=new Dm("@firebase/firestore");function nc(){return xl.logLevel}function lt(i,...e){if(xl.logLevel<=un.DEBUG){const t=e.map(qm);xl.debug(`Firestore (${Nc}): ${i}`,...t)}}function Va(i,...e){if(xl.logLevel<=un.ERROR){const t=e.map(qm);xl.error(`Firestore (${Nc}): ${i}`,...t)}}function pc(i,...e){if(xl.logLevel<=un.WARN){const t=e.map(qm);xl.warn(`Firestore (${Nc}): ${i}`,...t)}}function qm(i){if(typeof i=="string")return i;try{return(function(t){return JSON.stringify(t)})(i)}catch{return i}}function Dt(i,e,t){let a="Unexpected state";typeof e=="string"?a=e:t=e,ob(i,a,t)}function ob(i,e,t){let a=`FIRESTORE (${Nc}) INTERNAL ASSERTION FAILED: ${e} (ID: ${i.toString(16)})`;if(t!==void 0)try{a+=" CONTEXT: "+JSON.stringify(t)}catch{a+=" CONTEXT: "+t}throw Va(a),new Error(a)}function kn(i,e,t,a){let h="Unexpected state";typeof t=="string"?h=t:a=t,i||ob(e,h,a)}function Ut(i,e){return i}const Fe={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class rt extends za{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Oa{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class lb{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class $4{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(gi.UNAUTHENTICATED)))}shutdown(){}}class J4{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class eN{constructor(e){this.t=e,this.currentUser=gi.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){kn(this.o===void 0,42304);let a=this.i;const h=C=>this.i!==a?(a=this.i,t(C)):Promise.resolve();let f=new Oa;this.o=()=>{this.i++,this.currentUser=this.u(),f.resolve(),f=new Oa,e.enqueueRetryable((()=>h(this.currentUser)))};const y=()=>{const C=f;e.enqueueRetryable((async()=>{await C.promise,await h(this.currentUser)}))},A=C=>{lt("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=C,this.o&&(this.auth.addAuthTokenListener(this.o),y())};this.t.onInit((C=>A(C))),setTimeout((()=>{if(!this.auth){const C=this.t.getImmediate({optional:!0});C?A(C):(lt("FirebaseAuthCredentialsProvider","Auth not yet detected"),f.resolve(),f=new Oa)}}),0),y()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((a=>this.i!==e?(lt("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):a?(kn(typeof a.accessToken=="string",31837,{l:a}),new lb(a.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return kn(e===null||typeof e=="string",2055,{h:e}),new gi(e)}}class tN{constructor(e,t,a){this.P=e,this.T=t,this.I=a,this.type="FirstParty",this.user=gi.FIRST_PARTY,this.R=new Map}A(){return this.I?this.I():null}get headers(){this.R.set("X-Goog-AuthUser",this.P);const e=this.A();return e&&this.R.set("Authorization",e),this.T&&this.R.set("X-Goog-Iam-Authorization-Token",this.T),this.R}}class nN{constructor(e,t,a){this.P=e,this.T=t,this.I=a}getToken(){return Promise.resolve(new tN(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(gi.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class bx{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class sN{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,yr(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){kn(this.o===void 0,3512);const a=f=>{f.error!=null&&lt("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${f.error.message}`);const y=f.token!==this.m;return this.m=f.token,lt("FirebaseAppCheckTokenProvider",`Received ${y?"new":"existing"} token.`),y?t(f.token):Promise.resolve()};this.o=f=>{e.enqueueRetryable((()=>a(f)))};const h=f=>{lt("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=f,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((f=>h(f))),setTimeout((()=>{if(!this.appCheck){const f=this.V.getImmediate({optional:!0});f?h(f):lt("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new bx(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(kn(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new bx(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function iN(i){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(i);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let a=0;a<i;a++)t[a]=Math.floor(256*Math.random());return t}class Wm{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let a="";for(;a.length<20;){const h=iN(40);for(let f=0;f<h.length;++f)a.length<20&&h[f]<t&&(a+=e.charAt(h[f]%62))}return a}}function hn(i,e){return i<e?-1:i>e?1:0}function em(i,e){const t=Math.min(i.length,e.length);for(let a=0;a<t;a++){const h=i.charAt(a),f=e.charAt(a);if(h!==f)return k0(h)===k0(f)?hn(h,f):k0(h)?1:-1}return hn(i.length,e.length)}const rN=55296,aN=57343;function k0(i){const e=i.charCodeAt(0);return e>=rN&&e<=aN}function yc(i,e,t){return i.length===e.length&&i.every(((a,h)=>t(a,e[h])))}const Ex="__name__";class Yr{constructor(e,t,a){t===void 0?t=0:t>e.length&&Dt(637,{offset:t,range:e.length}),a===void 0?a=e.length-t:a>e.length-t&&Dt(1746,{length:a,range:e.length-t}),this.segments=e,this.offset=t,this.len=a}get length(){return this.len}isEqual(e){return Yr.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Yr?e.forEach((a=>{t.push(a)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,a=this.limit();t<a;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const a=Math.min(e.length,t.length);for(let h=0;h<a;h++){const f=Yr.compareSegments(e.get(h),t.get(h));if(f!==0)return f}return hn(e.length,t.length)}static compareSegments(e,t){const a=Yr.isNumericId(e),h=Yr.isNumericId(t);return a&&!h?-1:!a&&h?1:a&&h?Yr.extractNumericId(e).compare(Yr.extractNumericId(t)):em(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Ro.fromString(e.substring(4,e.length-2))}}class qn extends Yr{construct(e,t,a){return new qn(e,t,a)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const a of e){if(a.indexOf("//")>=0)throw new rt(Fe.INVALID_ARGUMENT,`Invalid segment (${a}). Paths must not contain // in them.`);t.push(...a.split("/").filter((h=>h.length>0)))}return new qn(t)}static emptyPath(){return new qn([])}}const oN=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class ii extends Yr{construct(e,t,a){return new ii(e,t,a)}static isValidIdentifier(e){return oN.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),ii.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===Ex}static keyField(){return new ii([Ex])}static fromServerFormat(e){const t=[];let a="",h=0;const f=()=>{if(a.length===0)throw new rt(Fe.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(a),a=""};let y=!1;for(;h<e.length;){const A=e[h];if(A==="\\"){if(h+1===e.length)throw new rt(Fe.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const C=e[h+1];if(C!=="\\"&&C!=="."&&C!=="`")throw new rt(Fe.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);a+=C,h+=2}else A==="`"?(y=!y,h++):A!=="."||y?(a+=A,h++):(f(),h++)}if(f(),y)throw new rt(Fe.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new ii(t)}static emptyPath(){return new ii([])}}class At{constructor(e){this.path=e}static fromPath(e){return new At(qn.fromString(e))}static fromName(e){return new At(qn.fromString(e).popFirst(5))}static empty(){return new At(qn.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&qn.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return qn.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new At(new qn(e.slice()))}}function cb(i,e,t){if(!t)throw new rt(Fe.INVALID_ARGUMENT,`Function ${i}() cannot be called with an empty ${e}.`)}function lN(i,e,t,a){if(e===!0&&a===!0)throw new rt(Fe.INVALID_ARGUMENT,`${i} and ${t} cannot be used together.`)}function _x(i){if(!At.isDocumentKey(i))throw new rt(Fe.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${i} has ${i.length}.`)}function Ax(i){if(At.isDocumentKey(i))throw new rt(Fe.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${i} has ${i.length}.`)}function ub(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}function df(i){if(i===void 0)return"undefined";if(i===null)return"null";if(typeof i=="string")return i.length>20&&(i=`${i.substring(0,20)}...`),JSON.stringify(i);if(typeof i=="number"||typeof i=="boolean")return""+i;if(typeof i=="object"){if(i instanceof Array)return"an array";{const e=(function(a){return a.constructor?a.constructor.name:null})(i);return e?`a custom ${e} object`:"an object"}}return typeof i=="function"?"a function":Dt(12329,{type:typeof i})}function jr(i,e){if("_delegate"in i&&(i=i._delegate),!(i instanceof e)){if(e.name===i.constructor.name)throw new rt(Fe.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=df(i);throw new rt(Fe.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return i}function js(i,e){const t={typeString:i};return e&&(t.value=e),t}function $u(i,e){if(!ub(i))throw new rt(Fe.INVALID_ARGUMENT,"JSON must be an object");let t;for(const a in e)if(e[a]){const h=e[a].typeString,f="value"in e[a]?{value:e[a].value}:void 0;if(!(a in i)){t=`JSON missing required field: '${a}'`;break}const y=i[a];if(h&&typeof y!==h){t=`JSON field '${a}' must be a ${h}.`;break}if(f!==void 0&&y!==f.value){t=`Expected '${a}' field to equal '${f.value}'`;break}}if(t)throw new rt(Fe.INVALID_ARGUMENT,t);return!0}const Cx=-62135596800,Tx=1e6;class vt{static now(){return vt.fromMillis(Date.now())}static fromDate(e){return vt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),a=Math.floor((e-1e3*t)*Tx);return new vt(t,a)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new rt(Fe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new rt(Fe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<Cx)throw new rt(Fe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new rt(Fe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/Tx}_compareTo(e){return this.seconds===e.seconds?hn(this.nanoseconds,e.nanoseconds):hn(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:vt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if($u(e,vt._jsonSchema))return new vt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-Cx;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}vt._jsonSchemaVersion="firestore/timestamp/1.0",vt._jsonSchema={type:js("string",vt._jsonSchemaVersion),seconds:js("number"),nanoseconds:js("number")};class Lt{static fromTimestamp(e){return new Lt(e)}static min(){return new Lt(new vt(0,0))}static max(){return new Lt(new vt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const Lu=-1;function cN(i,e){const t=i.toTimestamp().seconds,a=i.toTimestamp().nanoseconds+1,h=Lt.fromTimestamp(a===1e9?new vt(t+1,0):new vt(t,a));return new ko(h,At.empty(),e)}function uN(i){return new ko(i.readTime,i.key,Lu)}class ko{constructor(e,t,a){this.readTime=e,this.documentKey=t,this.largestBatchId=a}static min(){return new ko(Lt.min(),At.empty(),Lu)}static max(){return new ko(Lt.max(),At.empty(),Lu)}}function hN(i,e){let t=i.readTime.compareTo(e.readTime);return t!==0?t:(t=At.comparator(i.documentKey,e.documentKey),t!==0?t:hn(i.largestBatchId,e.largestBatchId))}const dN="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class fN{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function Ic(i){if(i.code!==Fe.FAILED_PRECONDITION||i.message!==dN)throw i;lt("LocalStore","Unexpectedly lost primary lease")}class qe{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Dt(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new qe(((a,h)=>{this.nextCallback=f=>{this.wrapSuccess(e,f).next(a,h)},this.catchCallback=f=>{this.wrapFailure(t,f).next(a,h)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof qe?t:qe.resolve(t)}catch(t){return qe.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):qe.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):qe.reject(t)}static resolve(e){return new qe(((t,a)=>{t(e)}))}static reject(e){return new qe(((t,a)=>{a(e)}))}static waitFor(e){return new qe(((t,a)=>{let h=0,f=0,y=!1;e.forEach((A=>{++h,A.next((()=>{++f,y&&f===h&&t()}),(C=>a(C)))})),y=!0,f===h&&t()}))}static or(e){let t=qe.resolve(!1);for(const a of e)t=t.next((h=>h?qe.resolve(h):a()));return t}static forEach(e,t){const a=[];return e.forEach(((h,f)=>{a.push(t.call(this,h,f))})),this.waitFor(a)}static mapArray(e,t){return new qe(((a,h)=>{const f=e.length,y=new Array(f);let A=0;for(let C=0;C<f;C++){const E=C;t(e[E]).next((S=>{y[E]=S,++A,A===f&&a(y)}),(S=>h(S)))}}))}static doWhile(e,t){return new qe(((a,h)=>{const f=()=>{e()===!0?t().next((()=>{f()}),h):a()};f()}))}}function mN(i){const e=i.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function Rc(i){return i.name==="IndexedDbTransactionError"}class ff{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=a=>this.ae(a),this.ue=a=>t.writeSequenceNumber(a))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}ff.ce=-1;const Ym=-1;function mf(i){return i==null}function zd(i){return i===0&&1/i==-1/0}function gN(i){return typeof i=="number"&&Number.isInteger(i)&&!zd(i)&&i<=Number.MAX_SAFE_INTEGER&&i>=Number.MIN_SAFE_INTEGER}const hb="";function pN(i){let e="";for(let t=0;t<i.length;t++)e.length>0&&(e=Sx(e)),e=yN(i.get(t),e);return Sx(e)}function yN(i,e){let t=e;const a=i.length;for(let h=0;h<a;h++){const f=i.charAt(h);switch(f){case"\0":t+="";break;case hb:t+="";break;default:t+=f}}return t}function Sx(i){return i+hb+""}function Nx(i){let e=0;for(const t in i)Object.prototype.hasOwnProperty.call(i,t)&&e++;return e}function Fo(i,e){for(const t in i)Object.prototype.hasOwnProperty.call(i,t)&&e(t,i[t])}function db(i){for(const e in i)if(Object.prototype.hasOwnProperty.call(i,e))return!1;return!0}class ds{constructor(e,t){this.comparator=e,this.root=t||si.EMPTY}insert(e,t){return new ds(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,si.BLACK,null,null))}remove(e){return new ds(this.comparator,this.root.remove(e,this.comparator).copy(null,null,si.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const a=this.comparator(e,t.key);if(a===0)return t.value;a<0?t=t.left:a>0&&(t=t.right)}return null}indexOf(e){let t=0,a=this.root;for(;!a.isEmpty();){const h=this.comparator(e,a.key);if(h===0)return t+a.left.size;h<0?a=a.left:(t+=a.left.size+1,a=a.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,a)=>(e(t,a),!1)))}toString(){const e=[];return this.inorderTraversal(((t,a)=>(e.push(`${t}:${a}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new dd(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new dd(this.root,e,this.comparator,!1)}getReverseIterator(){return new dd(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new dd(this.root,e,this.comparator,!0)}}class dd{constructor(e,t,a,h){this.isReverse=h,this.nodeStack=[];let f=1;for(;!e.isEmpty();)if(f=t?a(e.key,t):1,t&&h&&(f*=-1),f<0)e=this.isReverse?e.left:e.right;else{if(f===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class si{constructor(e,t,a,h,f){this.key=e,this.value=t,this.color=a??si.RED,this.left=h??si.EMPTY,this.right=f??si.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,a,h,f){return new si(e??this.key,t??this.value,a??this.color,h??this.left,f??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,a){let h=this;const f=a(e,h.key);return h=f<0?h.copy(null,null,null,h.left.insert(e,t,a),null):f===0?h.copy(null,t,null,null,null):h.copy(null,null,null,null,h.right.insert(e,t,a)),h.fixUp()}removeMin(){if(this.left.isEmpty())return si.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let a,h=this;if(t(e,h.key)<0)h.left.isEmpty()||h.left.isRed()||h.left.left.isRed()||(h=h.moveRedLeft()),h=h.copy(null,null,null,h.left.remove(e,t),null);else{if(h.left.isRed()&&(h=h.rotateRight()),h.right.isEmpty()||h.right.isRed()||h.right.left.isRed()||(h=h.moveRedRight()),t(e,h.key)===0){if(h.right.isEmpty())return si.EMPTY;a=h.right.min(),h=h.copy(a.key,a.value,null,null,h.right.removeMin())}h=h.copy(null,null,null,null,h.right.remove(e,t))}return h.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,si.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,si.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Dt(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Dt(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Dt(27949);return e+(this.isRed()?0:1)}}si.EMPTY=null,si.RED=!0,si.BLACK=!1;si.EMPTY=new class{constructor(){this.size=0}get key(){throw Dt(57766)}get value(){throw Dt(16141)}get color(){throw Dt(16727)}get left(){throw Dt(29726)}get right(){throw Dt(36894)}copy(e,t,a,h,f){return this}insert(e,t,a){return new si(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Us{constructor(e){this.comparator=e,this.data=new ds(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,a)=>(e(t),!1)))}forEachInRange(e,t){const a=this.data.getIteratorFrom(e[0]);for(;a.hasNext();){const h=a.getNext();if(this.comparator(h.key,e[1])>=0)return;t(h.key)}}forEachWhile(e,t){let a;for(a=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();a.hasNext();)if(!e(a.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Ix(this.data.getIterator())}getIteratorFrom(e){return new Ix(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((a=>{t=t.add(a)})),t}isEqual(e){if(!(e instanceof Us)||this.size!==e.size)return!1;const t=this.data.getIterator(),a=e.data.getIterator();for(;t.hasNext();){const h=t.getNext().key,f=a.getNext().key;if(this.comparator(h,f)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new Us(this.comparator);return t.data=e,t}}class Ix{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class er{constructor(e){this.fields=e,e.sort(ii.comparator)}static empty(){return new er([])}unionWith(e){let t=new Us(ii.comparator);for(const a of this.fields)t=t.add(a);for(const a of e)t=t.add(a);return new er(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return yc(this.fields,e.fields,((t,a)=>t.isEqual(a)))}}class fb extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class ri{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(h){try{return atob(h)}catch(f){throw typeof DOMException<"u"&&f instanceof DOMException?new fb("Invalid base64 string: "+f):f}})(e);return new ri(t)}static fromUint8Array(e){const t=(function(h){let f="";for(let y=0;y<h.length;++y)f+=String.fromCharCode(h[y]);return f})(e);return new ri(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const a=new Uint8Array(t.length);for(let h=0;h<t.length;h++)a[h]=t.charCodeAt(h);return a})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return hn(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}ri.EMPTY_BYTE_STRING=new ri("");const xN=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Mo(i){if(kn(!!i,39018),typeof i=="string"){let e=0;const t=xN.exec(i);if(kn(!!t,46558,{timestamp:i}),t[1]){let h=t[1];h=(h+"000000000").substr(0,9),e=Number(h)}const a=new Date(i);return{seconds:Math.floor(a.getTime()/1e3),nanos:e}}return{seconds:_s(i.seconds),nanos:_s(i.nanos)}}function _s(i){return typeof i=="number"?i:typeof i=="string"?Number(i):0}function Oo(i){return typeof i=="string"?ri.fromBase64String(i):ri.fromUint8Array(i)}const mb="server_timestamp",gb="__type__",pb="__previous_value__",yb="__local_write_time__";function Xm(i){return(i?.mapValue?.fields||{})[gb]?.stringValue===mb}function gf(i){const e=i.mapValue.fields[pb];return Xm(e)?gf(e):e}function Pu(i){const e=Mo(i.mapValue.fields[yb].timestampValue);return new vt(e.seconds,e.nanos)}class vN{constructor(e,t,a,h,f,y,A,C,E,S,I){this.databaseId=e,this.appId=t,this.persistenceKey=a,this.host=h,this.ssl=f,this.forceLongPolling=y,this.autoDetectLongPolling=A,this.longPollingOptions=C,this.useFetchStreams=E,this.isUsingEmulator=S,this.apiKey=I}}const Hd="(default)";class Bu{constructor(e,t){this.projectId=e,this.database=t||Hd}static empty(){return new Bu("","")}get isDefaultDatabase(){return this.database===Hd}isEqual(e){return e instanceof Bu&&e.projectId===this.projectId&&e.database===this.database}}function wN(i,e){if(!Object.prototype.hasOwnProperty.apply(i.options,["projectId"]))throw new rt(Fe.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Bu(i.options.projectId,e)}const xb="__type__",bN="__max__",fd={mapValue:{}},vb="__vector__",Gd="value";function jo(i){return"nullValue"in i?0:"booleanValue"in i?1:"integerValue"in i||"doubleValue"in i?2:"timestampValue"in i?3:"stringValue"in i?5:"bytesValue"in i?6:"referenceValue"in i?7:"geoPointValue"in i?8:"arrayValue"in i?9:"mapValue"in i?Xm(i)?4:_N(i)?9007199254740991:EN(i)?10:11:Dt(28295,{value:i})}function Jr(i,e){if(i===e)return!0;const t=jo(i);if(t!==jo(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return i.booleanValue===e.booleanValue;case 4:return Pu(i).isEqual(Pu(e));case 3:return(function(h,f){if(typeof h.timestampValue=="string"&&typeof f.timestampValue=="string"&&h.timestampValue.length===f.timestampValue.length)return h.timestampValue===f.timestampValue;const y=Mo(h.timestampValue),A=Mo(f.timestampValue);return y.seconds===A.seconds&&y.nanos===A.nanos})(i,e);case 5:return i.stringValue===e.stringValue;case 6:return(function(h,f){return Oo(h.bytesValue).isEqual(Oo(f.bytesValue))})(i,e);case 7:return i.referenceValue===e.referenceValue;case 8:return(function(h,f){return _s(h.geoPointValue.latitude)===_s(f.geoPointValue.latitude)&&_s(h.geoPointValue.longitude)===_s(f.geoPointValue.longitude)})(i,e);case 2:return(function(h,f){if("integerValue"in h&&"integerValue"in f)return _s(h.integerValue)===_s(f.integerValue);if("doubleValue"in h&&"doubleValue"in f){const y=_s(h.doubleValue),A=_s(f.doubleValue);return y===A?zd(y)===zd(A):isNaN(y)&&isNaN(A)}return!1})(i,e);case 9:return yc(i.arrayValue.values||[],e.arrayValue.values||[],Jr);case 10:case 11:return(function(h,f){const y=h.mapValue.fields||{},A=f.mapValue.fields||{};if(Nx(y)!==Nx(A))return!1;for(const C in y)if(y.hasOwnProperty(C)&&(A[C]===void 0||!Jr(y[C],A[C])))return!1;return!0})(i,e);default:return Dt(52216,{left:i})}}function Vu(i,e){return(i.values||[]).find((t=>Jr(t,e)))!==void 0}function xc(i,e){if(i===e)return 0;const t=jo(i),a=jo(e);if(t!==a)return hn(t,a);switch(t){case 0:case 9007199254740991:return 0;case 1:return hn(i.booleanValue,e.booleanValue);case 2:return(function(f,y){const A=_s(f.integerValue||f.doubleValue),C=_s(y.integerValue||y.doubleValue);return A<C?-1:A>C?1:A===C?0:isNaN(A)?isNaN(C)?0:-1:1})(i,e);case 3:return Rx(i.timestampValue,e.timestampValue);case 4:return Rx(Pu(i),Pu(e));case 5:return em(i.stringValue,e.stringValue);case 6:return(function(f,y){const A=Oo(f),C=Oo(y);return A.compareTo(C)})(i.bytesValue,e.bytesValue);case 7:return(function(f,y){const A=f.split("/"),C=y.split("/");for(let E=0;E<A.length&&E<C.length;E++){const S=hn(A[E],C[E]);if(S!==0)return S}return hn(A.length,C.length)})(i.referenceValue,e.referenceValue);case 8:return(function(f,y){const A=hn(_s(f.latitude),_s(y.latitude));return A!==0?A:hn(_s(f.longitude),_s(y.longitude))})(i.geoPointValue,e.geoPointValue);case 9:return Dx(i.arrayValue,e.arrayValue);case 10:return(function(f,y){const A=f.fields||{},C=y.fields||{},E=A[Gd]?.arrayValue,S=C[Gd]?.arrayValue,I=hn(E?.values?.length||0,S?.values?.length||0);return I!==0?I:Dx(E,S)})(i.mapValue,e.mapValue);case 11:return(function(f,y){if(f===fd.mapValue&&y===fd.mapValue)return 0;if(f===fd.mapValue)return 1;if(y===fd.mapValue)return-1;const A=f.fields||{},C=Object.keys(A),E=y.fields||{},S=Object.keys(E);C.sort(),S.sort();for(let I=0;I<C.length&&I<S.length;++I){const j=em(C[I],S[I]);if(j!==0)return j;const Y=xc(A[C[I]],E[S[I]]);if(Y!==0)return Y}return hn(C.length,S.length)})(i.mapValue,e.mapValue);default:throw Dt(23264,{he:t})}}function Rx(i,e){if(typeof i=="string"&&typeof e=="string"&&i.length===e.length)return hn(i,e);const t=Mo(i),a=Mo(e),h=hn(t.seconds,a.seconds);return h!==0?h:hn(t.nanos,a.nanos)}function Dx(i,e){const t=i.values||[],a=e.values||[];for(let h=0;h<t.length&&h<a.length;++h){const f=xc(t[h],a[h]);if(f)return f}return hn(t.length,a.length)}function vc(i){return tm(i)}function tm(i){return"nullValue"in i?"null":"booleanValue"in i?""+i.booleanValue:"integerValue"in i?""+i.integerValue:"doubleValue"in i?""+i.doubleValue:"timestampValue"in i?(function(t){const a=Mo(t);return`time(${a.seconds},${a.nanos})`})(i.timestampValue):"stringValue"in i?i.stringValue:"bytesValue"in i?(function(t){return Oo(t).toBase64()})(i.bytesValue):"referenceValue"in i?(function(t){return At.fromName(t).toString()})(i.referenceValue):"geoPointValue"in i?(function(t){return`geo(${t.latitude},${t.longitude})`})(i.geoPointValue):"arrayValue"in i?(function(t){let a="[",h=!0;for(const f of t.values||[])h?h=!1:a+=",",a+=tm(f);return a+"]"})(i.arrayValue):"mapValue"in i?(function(t){const a=Object.keys(t.fields||{}).sort();let h="{",f=!0;for(const y of a)f?f=!1:h+=",",h+=`${y}:${tm(t.fields[y])}`;return h+"}"})(i.mapValue):Dt(61005,{value:i})}function Cd(i){switch(jo(i)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=gf(i);return e?16+Cd(e):16;case 5:return 2*i.stringValue.length;case 6:return Oo(i.bytesValue).approximateByteSize();case 7:return i.referenceValue.length;case 9:return(function(a){return(a.values||[]).reduce(((h,f)=>h+Cd(f)),0)})(i.arrayValue);case 10:case 11:return(function(a){let h=0;return Fo(a.fields,((f,y)=>{h+=f.length+Cd(y)})),h})(i.mapValue);default:throw Dt(13486,{value:i})}}function kx(i,e){return{referenceValue:`projects/${i.projectId}/databases/${i.database}/documents/${e.path.canonicalString()}`}}function nm(i){return!!i&&"integerValue"in i}function Km(i){return!!i&&"arrayValue"in i}function Mx(i){return!!i&&"nullValue"in i}function Ox(i){return!!i&&"doubleValue"in i&&isNaN(Number(i.doubleValue))}function Td(i){return!!i&&"mapValue"in i}function EN(i){return(i?.mapValue?.fields||{})[xb]?.stringValue===vb}function Nu(i){if(i.geoPointValue)return{geoPointValue:{...i.geoPointValue}};if(i.timestampValue&&typeof i.timestampValue=="object")return{timestampValue:{...i.timestampValue}};if(i.mapValue){const e={mapValue:{fields:{}}};return Fo(i.mapValue.fields,((t,a)=>e.mapValue.fields[t]=Nu(a))),e}if(i.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(i.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Nu(i.arrayValue.values[t]);return e}return{...i}}function _N(i){return(((i.mapValue||{}).fields||{}).__type__||{}).stringValue===bN}class Bi{constructor(e){this.value=e}static empty(){return new Bi({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let a=0;a<e.length-1;++a)if(t=(t.mapValue.fields||{})[e.get(a)],!Td(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Nu(t)}setAll(e){let t=ii.emptyPath(),a={},h=[];e.forEach(((y,A)=>{if(!t.isImmediateParentOf(A)){const C=this.getFieldsMap(t);this.applyChanges(C,a,h),a={},h=[],t=A.popLast()}y?a[A.lastSegment()]=Nu(y):h.push(A.lastSegment())}));const f=this.getFieldsMap(t);this.applyChanges(f,a,h)}delete(e){const t=this.field(e.popLast());Td(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Jr(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let a=0;a<e.length;++a){let h=t.mapValue.fields[e.get(a)];Td(h)&&h.mapValue.fields||(h={mapValue:{fields:{}}},t.mapValue.fields[e.get(a)]=h),t=h}return t.mapValue.fields}applyChanges(e,t,a){Fo(t,((h,f)=>e[h]=f));for(const h of a)delete e[h]}clone(){return new Bi(Nu(this.value))}}function wb(i){const e=[];return Fo(i.fields,((t,a)=>{const h=new ii([t]);if(Td(a)){const f=wb(a.mapValue).fields;if(f.length===0)e.push(h);else for(const y of f)e.push(h.child(y))}else e.push(h)})),new er(e)}class pi{constructor(e,t,a,h,f,y,A){this.key=e,this.documentType=t,this.version=a,this.readTime=h,this.createTime=f,this.data=y,this.documentState=A}static newInvalidDocument(e){return new pi(e,0,Lt.min(),Lt.min(),Lt.min(),Bi.empty(),0)}static newFoundDocument(e,t,a,h){return new pi(e,1,t,Lt.min(),a,h,0)}static newNoDocument(e,t){return new pi(e,2,t,Lt.min(),Lt.min(),Bi.empty(),0)}static newUnknownDocument(e,t){return new pi(e,3,t,Lt.min(),Lt.min(),Bi.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Lt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Bi.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Bi.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Lt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof pi&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new pi(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class qd{constructor(e,t){this.position=e,this.inclusive=t}}function jx(i,e,t){let a=0;for(let h=0;h<i.position.length;h++){const f=e[h],y=i.position[h];if(f.field.isKeyField()?a=At.comparator(At.fromName(y.referenceValue),t.key):a=xc(y,t.data.field(f.field)),f.dir==="desc"&&(a*=-1),a!==0)break}return a}function Lx(i,e){if(i===null)return e===null;if(e===null||i.inclusive!==e.inclusive||i.position.length!==e.position.length)return!1;for(let t=0;t<i.position.length;t++)if(!Jr(i.position[t],e.position[t]))return!1;return!0}class Fu{constructor(e,t="asc"){this.field=e,this.dir=t}}function AN(i,e){return i.dir===e.dir&&i.field.isEqual(e.field)}class bb{}class Os extends bb{constructor(e,t,a){super(),this.field=e,this.op=t,this.value=a}static create(e,t,a){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,a):new TN(e,t,a):t==="array-contains"?new IN(e,a):t==="in"?new RN(e,a):t==="not-in"?new DN(e,a):t==="array-contains-any"?new kN(e,a):new Os(e,t,a)}static createKeyFieldInFilter(e,t,a){return t==="in"?new SN(e,a):new NN(e,a)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(xc(t,this.value)):t!==null&&jo(this.value)===jo(t)&&this.matchesComparison(xc(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Dt(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Lr extends bb{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new Lr(e,t)}matches(e){return Eb(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function Eb(i){return i.op==="and"}function _b(i){return CN(i)&&Eb(i)}function CN(i){for(const e of i.filters)if(e instanceof Lr)return!1;return!0}function sm(i){if(i instanceof Os)return i.field.canonicalString()+i.op.toString()+vc(i.value);if(_b(i))return i.filters.map((e=>sm(e))).join(",");{const e=i.filters.map((t=>sm(t))).join(",");return`${i.op}(${e})`}}function Ab(i,e){return i instanceof Os?(function(a,h){return h instanceof Os&&a.op===h.op&&a.field.isEqual(h.field)&&Jr(a.value,h.value)})(i,e):i instanceof Lr?(function(a,h){return h instanceof Lr&&a.op===h.op&&a.filters.length===h.filters.length?a.filters.reduce(((f,y,A)=>f&&Ab(y,h.filters[A])),!0):!1})(i,e):void Dt(19439)}function Cb(i){return i instanceof Os?(function(t){return`${t.field.canonicalString()} ${t.op} ${vc(t.value)}`})(i):i instanceof Lr?(function(t){return t.op.toString()+" {"+t.getFilters().map(Cb).join(" ,")+"}"})(i):"Filter"}class TN extends Os{constructor(e,t,a){super(e,t,a),this.key=At.fromName(a.referenceValue)}matches(e){const t=At.comparator(e.key,this.key);return this.matchesComparison(t)}}class SN extends Os{constructor(e,t){super(e,"in",t),this.keys=Tb("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class NN extends Os{constructor(e,t){super(e,"not-in",t),this.keys=Tb("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function Tb(i,e){return(e.arrayValue?.values||[]).map((t=>At.fromName(t.referenceValue)))}class IN extends Os{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Km(t)&&Vu(t.arrayValue,this.value)}}class RN extends Os{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Vu(this.value.arrayValue,t)}}class DN extends Os{constructor(e,t){super(e,"not-in",t)}matches(e){if(Vu(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Vu(this.value.arrayValue,t)}}class kN extends Os{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Km(t)||!t.arrayValue.values)&&t.arrayValue.values.some((a=>Vu(this.value.arrayValue,a)))}}class MN{constructor(e,t=null,a=[],h=[],f=null,y=null,A=null){this.path=e,this.collectionGroup=t,this.orderBy=a,this.filters=h,this.limit=f,this.startAt=y,this.endAt=A,this.Te=null}}function Px(i,e=null,t=[],a=[],h=null,f=null,y=null){return new MN(i,e,t,a,h,f,y)}function Qm(i){const e=Ut(i);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((a=>sm(a))).join(","),t+="|ob:",t+=e.orderBy.map((a=>(function(f){return f.field.canonicalString()+f.dir})(a))).join(","),mf(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((a=>vc(a))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((a=>vc(a))).join(",")),e.Te=t}return e.Te}function Zm(i,e){if(i.limit!==e.limit||i.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<i.orderBy.length;t++)if(!AN(i.orderBy[t],e.orderBy[t]))return!1;if(i.filters.length!==e.filters.length)return!1;for(let t=0;t<i.filters.length;t++)if(!Ab(i.filters[t],e.filters[t]))return!1;return i.collectionGroup===e.collectionGroup&&!!i.path.isEqual(e.path)&&!!Lx(i.startAt,e.startAt)&&Lx(i.endAt,e.endAt)}function im(i){return At.isDocumentKey(i.path)&&i.collectionGroup===null&&i.filters.length===0}class Dc{constructor(e,t=null,a=[],h=[],f=null,y="F",A=null,C=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=a,this.filters=h,this.limit=f,this.limitType=y,this.startAt=A,this.endAt=C,this.Ie=null,this.Ee=null,this.Re=null,this.startAt,this.endAt}}function ON(i,e,t,a,h,f,y,A){return new Dc(i,e,t,a,h,f,y,A)}function $m(i){return new Dc(i)}function Bx(i){return i.filters.length===0&&i.limit===null&&i.startAt==null&&i.endAt==null&&(i.explicitOrderBy.length===0||i.explicitOrderBy.length===1&&i.explicitOrderBy[0].field.isKeyField())}function jN(i){return At.isDocumentKey(i.path)&&i.collectionGroup===null&&i.filters.length===0}function Sb(i){return i.collectionGroup!==null}function Iu(i){const e=Ut(i);if(e.Ie===null){e.Ie=[];const t=new Set;for(const f of e.explicitOrderBy)e.Ie.push(f),t.add(f.field.canonicalString());const a=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(y){let A=new Us(ii.comparator);return y.filters.forEach((C=>{C.getFlattenedFilters().forEach((E=>{E.isInequality()&&(A=A.add(E.field))}))})),A})(e).forEach((f=>{t.has(f.canonicalString())||f.isKeyField()||e.Ie.push(new Fu(f,a))})),t.has(ii.keyField().canonicalString())||e.Ie.push(new Fu(ii.keyField(),a))}return e.Ie}function Qr(i){const e=Ut(i);return e.Ee||(e.Ee=LN(e,Iu(i))),e.Ee}function LN(i,e){if(i.limitType==="F")return Px(i.path,i.collectionGroup,e,i.filters,i.limit,i.startAt,i.endAt);{e=e.map((h=>{const f=h.dir==="desc"?"asc":"desc";return new Fu(h.field,f)}));const t=i.endAt?new qd(i.endAt.position,i.endAt.inclusive):null,a=i.startAt?new qd(i.startAt.position,i.startAt.inclusive):null;return Px(i.path,i.collectionGroup,e,i.filters,i.limit,t,a)}}function rm(i,e){const t=i.filters.concat([e]);return new Dc(i.path,i.collectionGroup,i.explicitOrderBy.slice(),t,i.limit,i.limitType,i.startAt,i.endAt)}function PN(i,e){const t=i.explicitOrderBy.concat([e]);return new Dc(i.path,i.collectionGroup,t,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}function am(i,e,t){return new Dc(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),e,t,i.startAt,i.endAt)}function pf(i,e){return Zm(Qr(i),Qr(e))&&i.limitType===e.limitType}function Nb(i){return`${Qm(Qr(i))}|lt:${i.limitType}`}function sc(i){return`Query(target=${(function(t){let a=t.path.canonicalString();return t.collectionGroup!==null&&(a+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(a+=`, filters: [${t.filters.map((h=>Cb(h))).join(", ")}]`),mf(t.limit)||(a+=", limit: "+t.limit),t.orderBy.length>0&&(a+=`, orderBy: [${t.orderBy.map((h=>(function(y){return`${y.field.canonicalString()} (${y.dir})`})(h))).join(", ")}]`),t.startAt&&(a+=", startAt: ",a+=t.startAt.inclusive?"b:":"a:",a+=t.startAt.position.map((h=>vc(h))).join(",")),t.endAt&&(a+=", endAt: ",a+=t.endAt.inclusive?"a:":"b:",a+=t.endAt.position.map((h=>vc(h))).join(",")),`Target(${a})`})(Qr(i))}; limitType=${i.limitType})`}function yf(i,e){return e.isFoundDocument()&&(function(a,h){const f=h.key.path;return a.collectionGroup!==null?h.key.hasCollectionId(a.collectionGroup)&&a.path.isPrefixOf(f):At.isDocumentKey(a.path)?a.path.isEqual(f):a.path.isImmediateParentOf(f)})(i,e)&&(function(a,h){for(const f of Iu(a))if(!f.field.isKeyField()&&h.data.field(f.field)===null)return!1;return!0})(i,e)&&(function(a,h){for(const f of a.filters)if(!f.matches(h))return!1;return!0})(i,e)&&(function(a,h){return!(a.startAt&&!(function(y,A,C){const E=jx(y,A,C);return y.inclusive?E<=0:E<0})(a.startAt,Iu(a),h)||a.endAt&&!(function(y,A,C){const E=jx(y,A,C);return y.inclusive?E>=0:E>0})(a.endAt,Iu(a),h))})(i,e)}function BN(i){return i.collectionGroup||(i.path.length%2==1?i.path.lastSegment():i.path.get(i.path.length-2))}function Ib(i){return(e,t)=>{let a=!1;for(const h of Iu(i)){const f=VN(h,e,t);if(f!==0)return f;a=a||h.field.isKeyField()}return 0}}function VN(i,e,t){const a=i.field.isKeyField()?At.comparator(e.key,t.key):(function(f,y,A){const C=y.data.field(f),E=A.data.field(f);return C!==null&&E!==null?xc(C,E):Dt(42886)})(i.field,e,t);switch(i.dir){case"asc":return a;case"desc":return-1*a;default:return Dt(19790,{direction:i.dir})}}class bl{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),a=this.inner[t];if(a!==void 0){for(const[h,f]of a)if(this.equalsFn(h,e))return f}}has(e){return this.get(e)!==void 0}set(e,t){const a=this.mapKeyFn(e),h=this.inner[a];if(h===void 0)return this.inner[a]=[[e,t]],void this.innerSize++;for(let f=0;f<h.length;f++)if(this.equalsFn(h[f][0],e))return void(h[f]=[e,t]);h.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),a=this.inner[t];if(a===void 0)return!1;for(let h=0;h<a.length;h++)if(this.equalsFn(a[h][0],e))return a.length===1?delete this.inner[t]:a.splice(h,1),this.innerSize--,!0;return!1}forEach(e){Fo(this.inner,((t,a)=>{for(const[h,f]of a)e(h,f)}))}isEmpty(){return db(this.inner)}size(){return this.innerSize}}const FN=new ds(At.comparator);function Fa(){return FN}const Rb=new ds(At.comparator);function Eu(...i){let e=Rb;for(const t of i)e=e.insert(t.key,t);return e}function Db(i){let e=Rb;return i.forEach(((t,a)=>e=e.insert(t,a.overlayedDocument))),e}function dl(){return Ru()}function kb(){return Ru()}function Ru(){return new bl((i=>i.toString()),((i,e)=>i.isEqual(e)))}const UN=new ds(At.comparator),zN=new Us(At.comparator);function dn(...i){let e=zN;for(const t of i)e=e.add(t);return e}const HN=new Us(hn);function GN(){return HN}function Jm(i,e){if(i.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:zd(e)?"-0":e}}function Mb(i){return{integerValue:""+i}}function qN(i,e){return gN(e)?Mb(e):Jm(i,e)}class xf{constructor(){this._=void 0}}function WN(i,e,t){return i instanceof Wd?(function(h,f){const y={fields:{[gb]:{stringValue:mb},[yb]:{timestampValue:{seconds:h.seconds,nanos:h.nanoseconds}}}};return f&&Xm(f)&&(f=gf(f)),f&&(y.fields[pb]=f),{mapValue:y}})(t,e):i instanceof Uu?jb(i,e):i instanceof zu?Lb(i,e):(function(h,f){const y=Ob(h,f),A=Vx(y)+Vx(h.Ae);return nm(y)&&nm(h.Ae)?Mb(A):Jm(h.serializer,A)})(i,e)}function YN(i,e,t){return i instanceof Uu?jb(i,e):i instanceof zu?Lb(i,e):t}function Ob(i,e){return i instanceof Yd?(function(a){return nm(a)||(function(f){return!!f&&"doubleValue"in f})(a)})(e)?e:{integerValue:0}:null}class Wd extends xf{}class Uu extends xf{constructor(e){super(),this.elements=e}}function jb(i,e){const t=Pb(e);for(const a of i.elements)t.some((h=>Jr(h,a)))||t.push(a);return{arrayValue:{values:t}}}class zu extends xf{constructor(e){super(),this.elements=e}}function Lb(i,e){let t=Pb(e);for(const a of i.elements)t=t.filter((h=>!Jr(h,a)));return{arrayValue:{values:t}}}class Yd extends xf{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function Vx(i){return _s(i.integerValue||i.doubleValue)}function Pb(i){return Km(i)&&i.arrayValue.values?i.arrayValue.values.slice():[]}function XN(i,e){return i.field.isEqual(e.field)&&(function(a,h){return a instanceof Uu&&h instanceof Uu||a instanceof zu&&h instanceof zu?yc(a.elements,h.elements,Jr):a instanceof Yd&&h instanceof Yd?Jr(a.Ae,h.Ae):a instanceof Wd&&h instanceof Wd})(i.transform,e.transform)}class KN{constructor(e,t){this.version=e,this.transformResults=t}}class wr{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new wr}static exists(e){return new wr(void 0,e)}static updateTime(e){return new wr(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Sd(i,e){return i.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(i.updateTime):i.exists===void 0||i.exists===e.isFoundDocument()}class vf{}function Bb(i,e){if(!i.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return i.isNoDocument()?new eg(i.key,wr.none()):new Ju(i.key,i.data,wr.none());{const t=i.data,a=Bi.empty();let h=new Us(ii.comparator);for(let f of e.fields)if(!h.has(f)){let y=t.field(f);y===null&&f.length>1&&(f=f.popLast(),y=t.field(f)),y===null?a.delete(f):a.set(f,y),h=h.add(f)}return new Uo(i.key,a,new er(h.toArray()),wr.none())}}function QN(i,e,t){i instanceof Ju?(function(h,f,y){const A=h.value.clone(),C=Ux(h.fieldTransforms,f,y.transformResults);A.setAll(C),f.convertToFoundDocument(y.version,A).setHasCommittedMutations()})(i,e,t):i instanceof Uo?(function(h,f,y){if(!Sd(h.precondition,f))return void f.convertToUnknownDocument(y.version);const A=Ux(h.fieldTransforms,f,y.transformResults),C=f.data;C.setAll(Vb(h)),C.setAll(A),f.convertToFoundDocument(y.version,C).setHasCommittedMutations()})(i,e,t):(function(h,f,y){f.convertToNoDocument(y.version).setHasCommittedMutations()})(0,e,t)}function Du(i,e,t,a){return i instanceof Ju?(function(f,y,A,C){if(!Sd(f.precondition,y))return A;const E=f.value.clone(),S=zx(f.fieldTransforms,C,y);return E.setAll(S),y.convertToFoundDocument(y.version,E).setHasLocalMutations(),null})(i,e,t,a):i instanceof Uo?(function(f,y,A,C){if(!Sd(f.precondition,y))return A;const E=zx(f.fieldTransforms,C,y),S=y.data;return S.setAll(Vb(f)),S.setAll(E),y.convertToFoundDocument(y.version,S).setHasLocalMutations(),A===null?null:A.unionWith(f.fieldMask.fields).unionWith(f.fieldTransforms.map((I=>I.field)))})(i,e,t,a):(function(f,y,A){return Sd(f.precondition,y)?(y.convertToNoDocument(y.version).setHasLocalMutations(),null):A})(i,e,t)}function ZN(i,e){let t=null;for(const a of i.fieldTransforms){const h=e.data.field(a.field),f=Ob(a.transform,h||null);f!=null&&(t===null&&(t=Bi.empty()),t.set(a.field,f))}return t||null}function Fx(i,e){return i.type===e.type&&!!i.key.isEqual(e.key)&&!!i.precondition.isEqual(e.precondition)&&!!(function(a,h){return a===void 0&&h===void 0||!(!a||!h)&&yc(a,h,((f,y)=>XN(f,y)))})(i.fieldTransforms,e.fieldTransforms)&&(i.type===0?i.value.isEqual(e.value):i.type!==1||i.data.isEqual(e.data)&&i.fieldMask.isEqual(e.fieldMask))}class Ju extends vf{constructor(e,t,a,h=[]){super(),this.key=e,this.value=t,this.precondition=a,this.fieldTransforms=h,this.type=0}getFieldMask(){return null}}class Uo extends vf{constructor(e,t,a,h,f=[]){super(),this.key=e,this.data=t,this.fieldMask=a,this.precondition=h,this.fieldTransforms=f,this.type=1}getFieldMask(){return this.fieldMask}}function Vb(i){const e=new Map;return i.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const a=i.data.field(t);e.set(t,a)}})),e}function Ux(i,e,t){const a=new Map;kn(i.length===t.length,32656,{Ve:t.length,de:i.length});for(let h=0;h<t.length;h++){const f=i[h],y=f.transform,A=e.data.field(f.field);a.set(f.field,YN(y,A,t[h]))}return a}function zx(i,e,t){const a=new Map;for(const h of i){const f=h.transform,y=t.data.field(h.field);a.set(h.field,WN(f,y,e))}return a}class eg extends vf{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class $N extends vf{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class JN{constructor(e,t,a,h){this.batchId=e,this.localWriteTime=t,this.baseMutations=a,this.mutations=h}applyToRemoteDocument(e,t){const a=t.mutationResults;for(let h=0;h<this.mutations.length;h++){const f=this.mutations[h];f.key.isEqual(e.key)&&QN(f,e,a[h])}}applyToLocalView(e,t){for(const a of this.baseMutations)a.key.isEqual(e.key)&&(t=Du(a,e,t,this.localWriteTime));for(const a of this.mutations)a.key.isEqual(e.key)&&(t=Du(a,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const a=kb();return this.mutations.forEach((h=>{const f=e.get(h.key),y=f.overlayedDocument;let A=this.applyToLocalView(y,f.mutatedFields);A=t.has(h.key)?null:A;const C=Bb(y,A);C!==null&&a.set(h.key,C),y.isValidDocument()||y.convertToNoDocument(Lt.min())})),a}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),dn())}isEqual(e){return this.batchId===e.batchId&&yc(this.mutations,e.mutations,((t,a)=>Fx(t,a)))&&yc(this.baseMutations,e.baseMutations,((t,a)=>Fx(t,a)))}}class tg{constructor(e,t,a,h){this.batch=e,this.commitVersion=t,this.mutationResults=a,this.docVersions=h}static from(e,t,a){kn(e.mutations.length===a.length,58842,{me:e.mutations.length,fe:a.length});let h=(function(){return UN})();const f=e.mutations;for(let y=0;y<f.length;y++)h=h.insert(f[y].key,a[y].version);return new tg(e,t,a,h)}}class eI{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class tI{constructor(e,t){this.count=e,this.unchangedNames=t}}var ks,yn;function nI(i){switch(i){case Fe.OK:return Dt(64938);case Fe.CANCELLED:case Fe.UNKNOWN:case Fe.DEADLINE_EXCEEDED:case Fe.RESOURCE_EXHAUSTED:case Fe.INTERNAL:case Fe.UNAVAILABLE:case Fe.UNAUTHENTICATED:return!1;case Fe.INVALID_ARGUMENT:case Fe.NOT_FOUND:case Fe.ALREADY_EXISTS:case Fe.PERMISSION_DENIED:case Fe.FAILED_PRECONDITION:case Fe.ABORTED:case Fe.OUT_OF_RANGE:case Fe.UNIMPLEMENTED:case Fe.DATA_LOSS:return!0;default:return Dt(15467,{code:i})}}function Fb(i){if(i===void 0)return Va("GRPC error has no .code"),Fe.UNKNOWN;switch(i){case ks.OK:return Fe.OK;case ks.CANCELLED:return Fe.CANCELLED;case ks.UNKNOWN:return Fe.UNKNOWN;case ks.DEADLINE_EXCEEDED:return Fe.DEADLINE_EXCEEDED;case ks.RESOURCE_EXHAUSTED:return Fe.RESOURCE_EXHAUSTED;case ks.INTERNAL:return Fe.INTERNAL;case ks.UNAVAILABLE:return Fe.UNAVAILABLE;case ks.UNAUTHENTICATED:return Fe.UNAUTHENTICATED;case ks.INVALID_ARGUMENT:return Fe.INVALID_ARGUMENT;case ks.NOT_FOUND:return Fe.NOT_FOUND;case ks.ALREADY_EXISTS:return Fe.ALREADY_EXISTS;case ks.PERMISSION_DENIED:return Fe.PERMISSION_DENIED;case ks.FAILED_PRECONDITION:return Fe.FAILED_PRECONDITION;case ks.ABORTED:return Fe.ABORTED;case ks.OUT_OF_RANGE:return Fe.OUT_OF_RANGE;case ks.UNIMPLEMENTED:return Fe.UNIMPLEMENTED;case ks.DATA_LOSS:return Fe.DATA_LOSS;default:return Dt(39323,{code:i})}}(yn=ks||(ks={}))[yn.OK=0]="OK",yn[yn.CANCELLED=1]="CANCELLED",yn[yn.UNKNOWN=2]="UNKNOWN",yn[yn.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",yn[yn.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",yn[yn.NOT_FOUND=5]="NOT_FOUND",yn[yn.ALREADY_EXISTS=6]="ALREADY_EXISTS",yn[yn.PERMISSION_DENIED=7]="PERMISSION_DENIED",yn[yn.UNAUTHENTICATED=16]="UNAUTHENTICATED",yn[yn.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",yn[yn.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",yn[yn.ABORTED=10]="ABORTED",yn[yn.OUT_OF_RANGE=11]="OUT_OF_RANGE",yn[yn.UNIMPLEMENTED=12]="UNIMPLEMENTED",yn[yn.INTERNAL=13]="INTERNAL",yn[yn.UNAVAILABLE=14]="UNAVAILABLE",yn[yn.DATA_LOSS=15]="DATA_LOSS";function sI(){return new TextEncoder}const iI=new Ro([4294967295,4294967295],0);function Hx(i){const e=sI().encode(i),t=new tb;return t.update(e),new Uint8Array(t.digest())}function Gx(i){const e=new DataView(i.buffer),t=e.getUint32(0,!0),a=e.getUint32(4,!0),h=e.getUint32(8,!0),f=e.getUint32(12,!0);return[new Ro([t,a],0),new Ro([h,f],0)]}class ng{constructor(e,t,a){if(this.bitmap=e,this.padding=t,this.hashCount=a,t<0||t>=8)throw new _u(`Invalid padding: ${t}`);if(a<0)throw new _u(`Invalid hash count: ${a}`);if(e.length>0&&this.hashCount===0)throw new _u(`Invalid hash count: ${a}`);if(e.length===0&&t!==0)throw new _u(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=Ro.fromNumber(this.ge)}ye(e,t,a){let h=e.add(t.multiply(Ro.fromNumber(a)));return h.compare(iI)===1&&(h=new Ro([h.getBits(0),h.getBits(1)],0)),h.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=Hx(e),[a,h]=Gx(t);for(let f=0;f<this.hashCount;f++){const y=this.ye(a,h,f);if(!this.we(y))return!1}return!0}static create(e,t,a){const h=e%8==0?0:8-e%8,f=new Uint8Array(Math.ceil(e/8)),y=new ng(f,h,t);return a.forEach((A=>y.insert(A))),y}insert(e){if(this.ge===0)return;const t=Hx(e),[a,h]=Gx(t);for(let f=0;f<this.hashCount;f++){const y=this.ye(a,h,f);this.be(y)}}be(e){const t=Math.floor(e/8),a=e%8;this.bitmap[t]|=1<<a}}class _u extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class wf{constructor(e,t,a,h,f){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=a,this.documentUpdates=h,this.resolvedLimboDocuments=f}static createSynthesizedRemoteEventForCurrentChange(e,t,a){const h=new Map;return h.set(e,eh.createSynthesizedTargetChangeForCurrentChange(e,t,a)),new wf(Lt.min(),h,new ds(hn),Fa(),dn())}}class eh{constructor(e,t,a,h,f){this.resumeToken=e,this.current=t,this.addedDocuments=a,this.modifiedDocuments=h,this.removedDocuments=f}static createSynthesizedTargetChangeForCurrentChange(e,t,a){return new eh(a,t,dn(),dn(),dn())}}class Nd{constructor(e,t,a,h){this.Se=e,this.removedTargetIds=t,this.key=a,this.De=h}}class Ub{constructor(e,t){this.targetId=e,this.Ce=t}}class zb{constructor(e,t,a=ri.EMPTY_BYTE_STRING,h=null){this.state=e,this.targetIds=t,this.resumeToken=a,this.cause=h}}class qx{constructor(){this.ve=0,this.Fe=Wx(),this.Me=ri.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=dn(),t=dn(),a=dn();return this.Fe.forEach(((h,f)=>{switch(f){case 0:e=e.add(h);break;case 2:t=t.add(h);break;case 1:a=a.add(h);break;default:Dt(38017,{changeType:f})}})),new eh(this.Me,this.xe,e,t,a)}Ke(){this.Oe=!1,this.Fe=Wx()}qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}Ue(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}$e(){this.ve+=1}We(){this.ve-=1,kn(this.ve>=0,3241,{ve:this.ve})}Qe(){this.Oe=!0,this.xe=!0}}class rI{constructor(e){this.Ge=e,this.ze=new Map,this.je=Fa(),this.He=md(),this.Je=md(),this.Ze=new ds(hn)}Xe(e){for(const t of e.Se)e.De&&e.De.isFoundDocument()?this.Ye(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const a=this.nt(t);switch(e.state){case 0:this.rt(t)&&a.Le(e.resumeToken);break;case 1:a.We(),a.Ne||a.Ke(),a.Le(e.resumeToken);break;case 2:a.We(),a.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(a.Qe(),a.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),a.Le(e.resumeToken));break;default:Dt(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((a,h)=>{this.rt(h)&&t(h)}))}st(e){const t=e.targetId,a=e.Ce.count,h=this.ot(t);if(h){const f=h.target;if(im(f))if(a===0){const y=new At(f.path);this.et(t,y,pi.newNoDocument(y,Lt.min()))}else kn(a===1,20013,{expectedCount:a});else{const y=this._t(t);if(y!==a){const A=this.ut(e),C=A?this.ct(A,e,y):1;if(C!==0){this.it(t);const E=C===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(t,E)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:a="",padding:h=0},hashCount:f=0}=t;let y,A;try{y=Oo(a).toUint8Array()}catch(C){if(C instanceof fb)return pc("Decoding the base64 bloom filter in existence filter failed ("+C.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw C}try{A=new ng(y,h,f)}catch(C){return pc(C instanceof _u?"BloomFilter error: ":"Applying bloom filter failed: ",C),null}return A.ge===0?null:A}ct(e,t,a){return t.Ce.count===a-this.Pt(e,t.targetId)?0:2}Pt(e,t){const a=this.Ge.getRemoteKeysForTarget(t);let h=0;return a.forEach((f=>{const y=this.Ge.ht(),A=`projects/${y.projectId}/databases/${y.database}/documents/${f.path.canonicalString()}`;e.mightContain(A)||(this.et(t,f,null),h++)})),h}Tt(e){const t=new Map;this.ze.forEach(((f,y)=>{const A=this.ot(y);if(A){if(f.current&&im(A.target)){const C=new At(A.target.path);this.It(C).has(y)||this.Et(y,C)||this.et(y,C,pi.newNoDocument(C,e))}f.Be&&(t.set(y,f.ke()),f.Ke())}}));let a=dn();this.Je.forEach(((f,y)=>{let A=!0;y.forEachWhile((C=>{const E=this.ot(C);return!E||E.purpose==="TargetPurposeLimboResolution"||(A=!1,!1)})),A&&(a=a.add(f))})),this.je.forEach(((f,y)=>y.setReadTime(e)));const h=new wf(e,t,this.Ze,this.je,a);return this.je=Fa(),this.He=md(),this.Je=md(),this.Ze=new ds(hn),h}Ye(e,t){if(!this.rt(e))return;const a=this.Et(e,t.key)?2:0;this.nt(e).qe(t.key,a),this.je=this.je.insert(t.key,t),this.He=this.He.insert(t.key,this.It(t.key).add(e)),this.Je=this.Je.insert(t.key,this.Rt(t.key).add(e))}et(e,t,a){if(!this.rt(e))return;const h=this.nt(e);this.Et(e,t)?h.qe(t,1):h.Ue(t),this.Je=this.Je.insert(t,this.Rt(t).delete(e)),this.Je=this.Je.insert(t,this.Rt(t).add(e)),a&&(this.je=this.je.insert(t,a))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.nt(e).$e()}nt(e){let t=this.ze.get(e);return t||(t=new qx,this.ze.set(e,t)),t}Rt(e){let t=this.Je.get(e);return t||(t=new Us(hn),this.Je=this.Je.insert(e,t)),t}It(e){let t=this.He.get(e);return t||(t=new Us(hn),this.He=this.He.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||lt("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new qx),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function md(){return new ds(At.comparator)}function Wx(){return new ds(At.comparator)}const aI={asc:"ASCENDING",desc:"DESCENDING"},oI={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},lI={and:"AND",or:"OR"};class cI{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function om(i,e){return i.useProto3Json||mf(e)?e:{value:e}}function Xd(i,e){return i.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Hb(i,e){return i.useProto3Json?e.toBase64():e.toUint8Array()}function uI(i,e){return Xd(i,e.toTimestamp())}function Zr(i){return kn(!!i,49232),Lt.fromTimestamp((function(t){const a=Mo(t);return new vt(a.seconds,a.nanos)})(i))}function sg(i,e){return lm(i,e).canonicalString()}function lm(i,e){const t=(function(h){return new qn(["projects",h.projectId,"databases",h.database])})(i).child("documents");return e===void 0?t:t.child(e)}function Gb(i){const e=qn.fromString(i);return kn(Kb(e),10190,{key:e.toString()}),e}function cm(i,e){return sg(i.databaseId,e.path)}function M0(i,e){const t=Gb(e);if(t.get(1)!==i.databaseId.projectId)throw new rt(Fe.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+i.databaseId.projectId);if(t.get(3)!==i.databaseId.database)throw new rt(Fe.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+i.databaseId.database);return new At(Wb(t))}function qb(i,e){return sg(i.databaseId,e)}function hI(i){const e=Gb(i);return e.length===4?qn.emptyPath():Wb(e)}function um(i){return new qn(["projects",i.databaseId.projectId,"databases",i.databaseId.database]).canonicalString()}function Wb(i){return kn(i.length>4&&i.get(4)==="documents",29091,{key:i.toString()}),i.popFirst(5)}function Yx(i,e,t){return{name:cm(i,e),fields:t.value.mapValue.fields}}function dI(i,e){let t;if("targetChange"in e){e.targetChange;const a=(function(E){return E==="NO_CHANGE"?0:E==="ADD"?1:E==="REMOVE"?2:E==="CURRENT"?3:E==="RESET"?4:Dt(39313,{state:E})})(e.targetChange.targetChangeType||"NO_CHANGE"),h=e.targetChange.targetIds||[],f=(function(E,S){return E.useProto3Json?(kn(S===void 0||typeof S=="string",58123),ri.fromBase64String(S||"")):(kn(S===void 0||S instanceof Buffer||S instanceof Uint8Array,16193),ri.fromUint8Array(S||new Uint8Array))})(i,e.targetChange.resumeToken),y=e.targetChange.cause,A=y&&(function(E){const S=E.code===void 0?Fe.UNKNOWN:Fb(E.code);return new rt(S,E.message||"")})(y);t=new zb(a,h,f,A||null)}else if("documentChange"in e){e.documentChange;const a=e.documentChange;a.document,a.document.name,a.document.updateTime;const h=M0(i,a.document.name),f=Zr(a.document.updateTime),y=a.document.createTime?Zr(a.document.createTime):Lt.min(),A=new Bi({mapValue:{fields:a.document.fields}}),C=pi.newFoundDocument(h,f,y,A),E=a.targetIds||[],S=a.removedTargetIds||[];t=new Nd(E,S,C.key,C)}else if("documentDelete"in e){e.documentDelete;const a=e.documentDelete;a.document;const h=M0(i,a.document),f=a.readTime?Zr(a.readTime):Lt.min(),y=pi.newNoDocument(h,f),A=a.removedTargetIds||[];t=new Nd([],A,y.key,y)}else if("documentRemove"in e){e.documentRemove;const a=e.documentRemove;a.document;const h=M0(i,a.document),f=a.removedTargetIds||[];t=new Nd([],f,h,null)}else{if(!("filter"in e))return Dt(11601,{Vt:e});{e.filter;const a=e.filter;a.targetId;const{count:h=0,unchangedNames:f}=a,y=new tI(h,f),A=a.targetId;t=new Ub(A,y)}}return t}function fI(i,e){let t;if(e instanceof Ju)t={update:Yx(i,e.key,e.value)};else if(e instanceof eg)t={delete:cm(i,e.key)};else if(e instanceof Uo)t={update:Yx(i,e.key,e.data),updateMask:EI(e.fieldMask)};else{if(!(e instanceof $N))return Dt(16599,{dt:e.type});t={verify:cm(i,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((a=>(function(f,y){const A=y.transform;if(A instanceof Wd)return{fieldPath:y.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(A instanceof Uu)return{fieldPath:y.field.canonicalString(),appendMissingElements:{values:A.elements}};if(A instanceof zu)return{fieldPath:y.field.canonicalString(),removeAllFromArray:{values:A.elements}};if(A instanceof Yd)return{fieldPath:y.field.canonicalString(),increment:A.Ae};throw Dt(20930,{transform:y.transform})})(0,a)))),e.precondition.isNone||(t.currentDocument=(function(h,f){return f.updateTime!==void 0?{updateTime:uI(h,f.updateTime)}:f.exists!==void 0?{exists:f.exists}:Dt(27497)})(i,e.precondition)),t}function mI(i,e){return i&&i.length>0?(kn(e!==void 0,14353),i.map((t=>(function(h,f){let y=h.updateTime?Zr(h.updateTime):Zr(f);return y.isEqual(Lt.min())&&(y=Zr(f)),new KN(y,h.transformResults||[])})(t,e)))):[]}function gI(i,e){return{documents:[qb(i,e.path)]}}function pI(i,e){const t={structuredQuery:{}},a=e.path;let h;e.collectionGroup!==null?(h=a,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(h=a.popLast(),t.structuredQuery.from=[{collectionId:a.lastSegment()}]),t.parent=qb(i,h);const f=(function(E){if(E.length!==0)return Xb(Lr.create(E,"and"))})(e.filters);f&&(t.structuredQuery.where=f);const y=(function(E){if(E.length!==0)return E.map((S=>(function(j){return{field:ic(j.field),direction:vI(j.dir)}})(S)))})(e.orderBy);y&&(t.structuredQuery.orderBy=y);const A=om(i,e.limit);return A!==null&&(t.structuredQuery.limit=A),e.startAt&&(t.structuredQuery.startAt=(function(E){return{before:E.inclusive,values:E.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(E){return{before:!E.inclusive,values:E.position}})(e.endAt)),{ft:t,parent:h}}function yI(i){let e=hI(i.parent);const t=i.structuredQuery,a=t.from?t.from.length:0;let h=null;if(a>0){kn(a===1,65062);const S=t.from[0];S.allDescendants?h=S.collectionId:e=e.child(S.collectionId)}let f=[];t.where&&(f=(function(I){const j=Yb(I);return j instanceof Lr&&_b(j)?j.getFilters():[j]})(t.where));let y=[];t.orderBy&&(y=(function(I){return I.map((j=>(function(X){return new Fu(rc(X.field),(function(J){switch(J){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(X.direction))})(j)))})(t.orderBy));let A=null;t.limit&&(A=(function(I){let j;return j=typeof I=="object"?I.value:I,mf(j)?null:j})(t.limit));let C=null;t.startAt&&(C=(function(I){const j=!!I.before,Y=I.values||[];return new qd(Y,j)})(t.startAt));let E=null;return t.endAt&&(E=(function(I){const j=!I.before,Y=I.values||[];return new qd(Y,j)})(t.endAt)),ON(e,h,y,f,A,"F",C,E)}function xI(i,e){const t=(function(h){switch(h){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Dt(28987,{purpose:h})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function Yb(i){return i.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const a=rc(t.unaryFilter.field);return Os.create(a,"==",{doubleValue:NaN});case"IS_NULL":const h=rc(t.unaryFilter.field);return Os.create(h,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const f=rc(t.unaryFilter.field);return Os.create(f,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const y=rc(t.unaryFilter.field);return Os.create(y,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Dt(61313);default:return Dt(60726)}})(i):i.fieldFilter!==void 0?(function(t){return Os.create(rc(t.fieldFilter.field),(function(h){switch(h){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Dt(58110);default:return Dt(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(i):i.compositeFilter!==void 0?(function(t){return Lr.create(t.compositeFilter.filters.map((a=>Yb(a))),(function(h){switch(h){case"AND":return"and";case"OR":return"or";default:return Dt(1026)}})(t.compositeFilter.op))})(i):Dt(30097,{filter:i})}function vI(i){return aI[i]}function wI(i){return oI[i]}function bI(i){return lI[i]}function ic(i){return{fieldPath:i.canonicalString()}}function rc(i){return ii.fromServerFormat(i.fieldPath)}function Xb(i){return i instanceof Os?(function(t){if(t.op==="=="){if(Ox(t.value))return{unaryFilter:{field:ic(t.field),op:"IS_NAN"}};if(Mx(t.value))return{unaryFilter:{field:ic(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(Ox(t.value))return{unaryFilter:{field:ic(t.field),op:"IS_NOT_NAN"}};if(Mx(t.value))return{unaryFilter:{field:ic(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ic(t.field),op:wI(t.op),value:t.value}}})(i):i instanceof Lr?(function(t){const a=t.getFilters().map((h=>Xb(h)));return a.length===1?a[0]:{compositeFilter:{op:bI(t.op),filters:a}}})(i):Dt(54877,{filter:i})}function EI(i){const e=[];return i.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function Kb(i){return i.length>=4&&i.get(0)==="projects"&&i.get(2)==="databases"}function Qb(i){return!!i&&typeof i._toProto=="function"&&i._protoValueType==="ProtoValue"}class To{constructor(e,t,a,h,f=Lt.min(),y=Lt.min(),A=ri.EMPTY_BYTE_STRING,C=null){this.target=e,this.targetId=t,this.purpose=a,this.sequenceNumber=h,this.snapshotVersion=f,this.lastLimboFreeSnapshotVersion=y,this.resumeToken=A,this.expectedCount=C}withSequenceNumber(e){return new To(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new To(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new To(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new To(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class _I{constructor(e){this.yt=e}}function AI(i){const e=yI({parent:i.parent,structuredQuery:i.structuredQuery});return i.limitType==="LAST"?am(e,e.limit,"L"):e}class CI{constructor(){this.Sn=new TI}addToCollectionParentIndex(e,t){return this.Sn.add(t),qe.resolve()}getCollectionParents(e,t){return qe.resolve(this.Sn.getEntries(t))}addFieldIndex(e,t){return qe.resolve()}deleteFieldIndex(e,t){return qe.resolve()}deleteAllFieldIndexes(e){return qe.resolve()}createTargetIndexes(e,t){return qe.resolve()}getDocumentsMatchingTarget(e,t){return qe.resolve(null)}getIndexType(e,t){return qe.resolve(0)}getFieldIndexes(e,t){return qe.resolve([])}getNextCollectionGroupToUpdate(e){return qe.resolve(null)}getMinOffset(e,t){return qe.resolve(ko.min())}getMinOffsetFromCollectionGroup(e,t){return qe.resolve(ko.min())}updateCollectionGroup(e,t,a){return qe.resolve()}updateIndexEntries(e,t){return qe.resolve()}}class TI{constructor(){this.index={}}add(e){const t=e.lastSegment(),a=e.popLast(),h=this.index[t]||new Us(qn.comparator),f=!h.has(a);return this.index[t]=h.add(a),f}has(e){const t=e.lastSegment(),a=e.popLast(),h=this.index[t];return h&&h.has(a)}getEntries(e){return(this.index[e]||new Us(qn.comparator)).toArray()}}const Xx={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Zb=41943040;class Pi{static withCacheSize(e){return new Pi(e,Pi.DEFAULT_COLLECTION_PERCENTILE,Pi.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,a){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=a}}Pi.DEFAULT_COLLECTION_PERCENTILE=10,Pi.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Pi.DEFAULT=new Pi(Zb,Pi.DEFAULT_COLLECTION_PERCENTILE,Pi.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Pi.DISABLED=new Pi(-1,0,0);class wc{constructor(e){this.sr=e}next(){return this.sr+=2,this.sr}static _r(){return new wc(0)}static ar(){return new wc(-1)}}const Kx="LruGarbageCollector",SI=1048576;function Qx([i,e],[t,a]){const h=hn(i,t);return h===0?hn(e,a):h}class NI{constructor(e){this.Pr=e,this.buffer=new Us(Qx),this.Tr=0}Ir(){return++this.Tr}Er(e){const t=[e,this.Ir()];if(this.buffer.size<this.Pr)this.buffer=this.buffer.add(t);else{const a=this.buffer.last();Qx(t,a)<0&&(this.buffer=this.buffer.delete(a).add(t))}}get maxValue(){return this.buffer.last()[0]}}class II{constructor(e,t,a){this.garbageCollector=e,this.asyncQueue=t,this.localStore=a,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Ar(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Ar(e){lt(Kx,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Rc(t)?lt(Kx,"Ignoring IndexedDB error during garbage collection: ",t):await Ic(t)}await this.Ar(3e5)}))}}class RI{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.dr(e).next((a=>Math.floor(t/100*a)))}nthSequenceNumber(e,t){if(t===0)return qe.resolve(ff.ce);const a=new NI(t);return this.Vr.forEachTarget(e,(h=>a.Er(h.sequenceNumber))).next((()=>this.Vr.mr(e,(h=>a.Er(h))))).next((()=>a.maxValue))}removeTargets(e,t,a){return this.Vr.removeTargets(e,t,a)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(lt("LruGarbageCollector","Garbage collection skipped; disabled"),qe.resolve(Xx)):this.getCacheSize(e).next((a=>a<this.params.cacheSizeCollectionThreshold?(lt("LruGarbageCollector",`Garbage collection skipped; Cache size ${a} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Xx):this.gr(e,t)))}getCacheSize(e){return this.Vr.getCacheSize(e)}gr(e,t){let a,h,f,y,A,C,E;const S=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((I=>(I>this.params.maximumSequenceNumbersToCollect?(lt("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${I}`),h=this.params.maximumSequenceNumbersToCollect):h=I,y=Date.now(),this.nthSequenceNumber(e,h)))).next((I=>(a=I,A=Date.now(),this.removeTargets(e,a,t)))).next((I=>(f=I,C=Date.now(),this.removeOrphanedDocuments(e,a)))).next((I=>(E=Date.now(),nc()<=un.DEBUG&&lt("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${y-S}ms
	Determined least recently used ${h} in `+(A-y)+`ms
	Removed ${f} targets in `+(C-A)+`ms
	Removed ${I} documents in `+(E-C)+`ms
Total Duration: ${E-S}ms`),qe.resolve({didRun:!0,sequenceNumbersCollected:h,targetsRemoved:f,documentsRemoved:I}))))}}function DI(i,e){return new RI(i,e)}class kI{constructor(){this.changes=new bl((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,pi.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const a=this.changes.get(t);return a!==void 0?qe.resolve(a):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class MI{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class OI{constructor(e,t,a,h){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=a,this.indexManager=h}getDocument(e,t){let a=null;return this.documentOverlayCache.getOverlay(e,t).next((h=>(a=h,this.remoteDocumentCache.getEntry(e,t)))).next((h=>(a!==null&&Du(a.mutation,h,er.empty(),vt.now()),h)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((a=>this.getLocalViewOfDocuments(e,a,dn()).next((()=>a))))}getLocalViewOfDocuments(e,t,a=dn()){const h=dl();return this.populateOverlays(e,h,t).next((()=>this.computeViews(e,t,h,a).next((f=>{let y=Eu();return f.forEach(((A,C)=>{y=y.insert(A,C.overlayedDocument)})),y}))))}getOverlayedDocuments(e,t){const a=dl();return this.populateOverlays(e,a,t).next((()=>this.computeViews(e,t,a,dn())))}populateOverlays(e,t,a){const h=[];return a.forEach((f=>{t.has(f)||h.push(f)})),this.documentOverlayCache.getOverlays(e,h).next((f=>{f.forEach(((y,A)=>{t.set(y,A)}))}))}computeViews(e,t,a,h){let f=Fa();const y=Ru(),A=(function(){return Ru()})();return t.forEach(((C,E)=>{const S=a.get(E.key);h.has(E.key)&&(S===void 0||S.mutation instanceof Uo)?f=f.insert(E.key,E):S!==void 0?(y.set(E.key,S.mutation.getFieldMask()),Du(S.mutation,E,S.mutation.getFieldMask(),vt.now())):y.set(E.key,er.empty())})),this.recalculateAndSaveOverlays(e,f).next((C=>(C.forEach(((E,S)=>y.set(E,S))),t.forEach(((E,S)=>A.set(E,new MI(S,y.get(E)??null)))),A)))}recalculateAndSaveOverlays(e,t){const a=Ru();let h=new ds(((y,A)=>y-A)),f=dn();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((y=>{for(const A of y)A.keys().forEach((C=>{const E=t.get(C);if(E===null)return;let S=a.get(C)||er.empty();S=A.applyToLocalView(E,S),a.set(C,S);const I=(h.get(A.batchId)||dn()).add(C);h=h.insert(A.batchId,I)}))})).next((()=>{const y=[],A=h.getReverseIterator();for(;A.hasNext();){const C=A.getNext(),E=C.key,S=C.value,I=kb();S.forEach((j=>{if(!f.has(j)){const Y=Bb(t.get(j),a.get(j));Y!==null&&I.set(j,Y),f=f.add(j)}})),y.push(this.documentOverlayCache.saveOverlays(e,E,I))}return qe.waitFor(y)})).next((()=>a))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((a=>this.recalculateAndSaveOverlays(e,a)))}getDocumentsMatchingQuery(e,t,a,h){return jN(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Sb(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,a,h):this.getDocumentsMatchingCollectionQuery(e,t,a,h)}getNextDocuments(e,t,a,h){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,a,h).next((f=>{const y=h-f.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,a.largestBatchId,h-f.size):qe.resolve(dl());let A=Lu,C=f;return y.next((E=>qe.forEach(E,((S,I)=>(A<I.largestBatchId&&(A=I.largestBatchId),f.get(S)?qe.resolve():this.remoteDocumentCache.getEntry(e,S).next((j=>{C=C.insert(S,j)}))))).next((()=>this.populateOverlays(e,E,f))).next((()=>this.computeViews(e,C,E,dn()))).next((S=>({batchId:A,changes:Db(S)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new At(t)).next((a=>{let h=Eu();return a.isFoundDocument()&&(h=h.insert(a.key,a)),h}))}getDocumentsMatchingCollectionGroupQuery(e,t,a,h){const f=t.collectionGroup;let y=Eu();return this.indexManager.getCollectionParents(e,f).next((A=>qe.forEach(A,(C=>{const E=(function(I,j){return new Dc(j,null,I.explicitOrderBy.slice(),I.filters.slice(),I.limit,I.limitType,I.startAt,I.endAt)})(t,C.child(f));return this.getDocumentsMatchingCollectionQuery(e,E,a,h).next((S=>{S.forEach(((I,j)=>{y=y.insert(I,j)}))}))})).next((()=>y))))}getDocumentsMatchingCollectionQuery(e,t,a,h){let f;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,a.largestBatchId).next((y=>(f=y,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,a,f,h)))).next((y=>{f.forEach(((C,E)=>{const S=E.getKey();y.get(S)===null&&(y=y.insert(S,pi.newInvalidDocument(S)))}));let A=Eu();return y.forEach(((C,E)=>{const S=f.get(C);S!==void 0&&Du(S.mutation,E,er.empty(),vt.now()),yf(t,E)&&(A=A.insert(C,E))})),A}))}}class jI{constructor(e){this.serializer=e,this.Nr=new Map,this.Br=new Map}getBundleMetadata(e,t){return qe.resolve(this.Nr.get(t))}saveBundleMetadata(e,t){return this.Nr.set(t.id,(function(h){return{id:h.id,version:h.version,createTime:Zr(h.createTime)}})(t)),qe.resolve()}getNamedQuery(e,t){return qe.resolve(this.Br.get(t))}saveNamedQuery(e,t){return this.Br.set(t.name,(function(h){return{name:h.name,query:AI(h.bundledQuery),readTime:Zr(h.readTime)}})(t)),qe.resolve()}}class LI{constructor(){this.overlays=new ds(At.comparator),this.Lr=new Map}getOverlay(e,t){return qe.resolve(this.overlays.get(t))}getOverlays(e,t){const a=dl();return qe.forEach(t,(h=>this.getOverlay(e,h).next((f=>{f!==null&&a.set(h,f)})))).next((()=>a))}saveOverlays(e,t,a){return a.forEach(((h,f)=>{this.bt(e,t,f)})),qe.resolve()}removeOverlaysForBatchId(e,t,a){const h=this.Lr.get(a);return h!==void 0&&(h.forEach((f=>this.overlays=this.overlays.remove(f))),this.Lr.delete(a)),qe.resolve()}getOverlaysForCollection(e,t,a){const h=dl(),f=t.length+1,y=new At(t.child("")),A=this.overlays.getIteratorFrom(y);for(;A.hasNext();){const C=A.getNext().value,E=C.getKey();if(!t.isPrefixOf(E.path))break;E.path.length===f&&C.largestBatchId>a&&h.set(C.getKey(),C)}return qe.resolve(h)}getOverlaysForCollectionGroup(e,t,a,h){let f=new ds(((E,S)=>E-S));const y=this.overlays.getIterator();for(;y.hasNext();){const E=y.getNext().value;if(E.getKey().getCollectionGroup()===t&&E.largestBatchId>a){let S=f.get(E.largestBatchId);S===null&&(S=dl(),f=f.insert(E.largestBatchId,S)),S.set(E.getKey(),E)}}const A=dl(),C=f.getIterator();for(;C.hasNext()&&(C.getNext().value.forEach(((E,S)=>A.set(E,S))),!(A.size()>=h)););return qe.resolve(A)}bt(e,t,a){const h=this.overlays.get(a.key);if(h!==null){const y=this.Lr.get(h.largestBatchId).delete(a.key);this.Lr.set(h.largestBatchId,y)}this.overlays=this.overlays.insert(a.key,new eI(t,a));let f=this.Lr.get(t);f===void 0&&(f=dn(),this.Lr.set(t,f)),this.Lr.set(t,f.add(a.key))}}class PI{constructor(){this.sessionToken=ri.EMPTY_BYTE_STRING}getSessionToken(e){return qe.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,qe.resolve()}}class ig{constructor(){this.kr=new Us(Ys.Kr),this.qr=new Us(Ys.Ur)}isEmpty(){return this.kr.isEmpty()}addReference(e,t){const a=new Ys(e,t);this.kr=this.kr.add(a),this.qr=this.qr.add(a)}$r(e,t){e.forEach((a=>this.addReference(a,t)))}removeReference(e,t){this.Wr(new Ys(e,t))}Qr(e,t){e.forEach((a=>this.removeReference(a,t)))}Gr(e){const t=new At(new qn([])),a=new Ys(t,e),h=new Ys(t,e+1),f=[];return this.qr.forEachInRange([a,h],(y=>{this.Wr(y),f.push(y.key)})),f}zr(){this.kr.forEach((e=>this.Wr(e)))}Wr(e){this.kr=this.kr.delete(e),this.qr=this.qr.delete(e)}jr(e){const t=new At(new qn([])),a=new Ys(t,e),h=new Ys(t,e+1);let f=dn();return this.qr.forEachInRange([a,h],(y=>{f=f.add(y.key)})),f}containsKey(e){const t=new Ys(e,0),a=this.kr.firstAfterOrEqual(t);return a!==null&&e.isEqual(a.key)}}class Ys{constructor(e,t){this.key=e,this.Hr=t}static Kr(e,t){return At.comparator(e.key,t.key)||hn(e.Hr,t.Hr)}static Ur(e,t){return hn(e.Hr,t.Hr)||At.comparator(e.key,t.key)}}class BI{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Yn=1,this.Jr=new Us(Ys.Kr)}checkEmpty(e){return qe.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,a,h){const f=this.Yn;this.Yn++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const y=new JN(f,t,a,h);this.mutationQueue.push(y);for(const A of h)this.Jr=this.Jr.add(new Ys(A.key,f)),this.indexManager.addToCollectionParentIndex(e,A.key.path.popLast());return qe.resolve(y)}lookupMutationBatch(e,t){return qe.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){const a=t+1,h=this.Xr(a),f=h<0?0:h;return qe.resolve(this.mutationQueue.length>f?this.mutationQueue[f]:null)}getHighestUnacknowledgedBatchId(){return qe.resolve(this.mutationQueue.length===0?Ym:this.Yn-1)}getAllMutationBatches(e){return qe.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const a=new Ys(t,0),h=new Ys(t,Number.POSITIVE_INFINITY),f=[];return this.Jr.forEachInRange([a,h],(y=>{const A=this.Zr(y.Hr);f.push(A)})),qe.resolve(f)}getAllMutationBatchesAffectingDocumentKeys(e,t){let a=new Us(hn);return t.forEach((h=>{const f=new Ys(h,0),y=new Ys(h,Number.POSITIVE_INFINITY);this.Jr.forEachInRange([f,y],(A=>{a=a.add(A.Hr)}))})),qe.resolve(this.Yr(a))}getAllMutationBatchesAffectingQuery(e,t){const a=t.path,h=a.length+1;let f=a;At.isDocumentKey(f)||(f=f.child(""));const y=new Ys(new At(f),0);let A=new Us(hn);return this.Jr.forEachWhile((C=>{const E=C.key.path;return!!a.isPrefixOf(E)&&(E.length===h&&(A=A.add(C.Hr)),!0)}),y),qe.resolve(this.Yr(A))}Yr(e){const t=[];return e.forEach((a=>{const h=this.Zr(a);h!==null&&t.push(h)})),t}removeMutationBatch(e,t){kn(this.ei(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let a=this.Jr;return qe.forEach(t.mutations,(h=>{const f=new Ys(h.key,t.batchId);return a=a.delete(f),this.referenceDelegate.markPotentiallyOrphaned(e,h.key)})).next((()=>{this.Jr=a}))}nr(e){}containsKey(e,t){const a=new Ys(t,0),h=this.Jr.firstAfterOrEqual(a);return qe.resolve(t.isEqual(h&&h.key))}performConsistencyCheck(e){return this.mutationQueue.length,qe.resolve()}ei(e,t){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class VI{constructor(e){this.ti=e,this.docs=(function(){return new ds(At.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const a=t.key,h=this.docs.get(a),f=h?h.size:0,y=this.ti(t);return this.docs=this.docs.insert(a,{document:t.mutableCopy(),size:y}),this.size+=y-f,this.indexManager.addToCollectionParentIndex(e,a.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const a=this.docs.get(t);return qe.resolve(a?a.document.mutableCopy():pi.newInvalidDocument(t))}getEntries(e,t){let a=Fa();return t.forEach((h=>{const f=this.docs.get(h);a=a.insert(h,f?f.document.mutableCopy():pi.newInvalidDocument(h))})),qe.resolve(a)}getDocumentsMatchingQuery(e,t,a,h){let f=Fa();const y=t.path,A=new At(y.child("__id-9223372036854775808__")),C=this.docs.getIteratorFrom(A);for(;C.hasNext();){const{key:E,value:{document:S}}=C.getNext();if(!y.isPrefixOf(E.path))break;E.path.length>y.length+1||hN(uN(S),a)<=0||(h.has(S.key)||yf(t,S))&&(f=f.insert(S.key,S.mutableCopy()))}return qe.resolve(f)}getAllFromCollectionGroup(e,t,a,h){Dt(9500)}ni(e,t){return qe.forEach(this.docs,(a=>t(a)))}newChangeBuffer(e){return new FI(this)}getSize(e){return qe.resolve(this.size)}}class FI extends kI{constructor(e){super(),this.Mr=e}applyChanges(e){const t=[];return this.changes.forEach(((a,h)=>{h.isValidDocument()?t.push(this.Mr.addEntry(e,h)):this.Mr.removeEntry(a)})),qe.waitFor(t)}getFromCache(e,t){return this.Mr.getEntry(e,t)}getAllFromCache(e,t){return this.Mr.getEntries(e,t)}}class UI{constructor(e){this.persistence=e,this.ri=new bl((t=>Qm(t)),Zm),this.lastRemoteSnapshotVersion=Lt.min(),this.highestTargetId=0,this.ii=0,this.si=new ig,this.targetCount=0,this.oi=wc._r()}forEachTarget(e,t){return this.ri.forEach(((a,h)=>t(h))),qe.resolve()}getLastRemoteSnapshotVersion(e){return qe.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return qe.resolve(this.ii)}allocateTargetId(e){return this.highestTargetId=this.oi.next(),qe.resolve(this.highestTargetId)}setTargetsMetadata(e,t,a){return a&&(this.lastRemoteSnapshotVersion=a),t>this.ii&&(this.ii=t),qe.resolve()}lr(e){this.ri.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.oi=new wc(t),this.highestTargetId=t),e.sequenceNumber>this.ii&&(this.ii=e.sequenceNumber)}addTargetData(e,t){return this.lr(t),this.targetCount+=1,qe.resolve()}updateTargetData(e,t){return this.lr(t),qe.resolve()}removeTargetData(e,t){return this.ri.delete(t.target),this.si.Gr(t.targetId),this.targetCount-=1,qe.resolve()}removeTargets(e,t,a){let h=0;const f=[];return this.ri.forEach(((y,A)=>{A.sequenceNumber<=t&&a.get(A.targetId)===null&&(this.ri.delete(y),f.push(this.removeMatchingKeysForTargetId(e,A.targetId)),h++)})),qe.waitFor(f).next((()=>h))}getTargetCount(e){return qe.resolve(this.targetCount)}getTargetData(e,t){const a=this.ri.get(t)||null;return qe.resolve(a)}addMatchingKeys(e,t,a){return this.si.$r(t,a),qe.resolve()}removeMatchingKeys(e,t,a){this.si.Qr(t,a);const h=this.persistence.referenceDelegate,f=[];return h&&t.forEach((y=>{f.push(h.markPotentiallyOrphaned(e,y))})),qe.waitFor(f)}removeMatchingKeysForTargetId(e,t){return this.si.Gr(t),qe.resolve()}getMatchingKeysForTargetId(e,t){const a=this.si.jr(t);return qe.resolve(a)}containsKey(e,t){return qe.resolve(this.si.containsKey(t))}}class $b{constructor(e,t){this._i={},this.overlays={},this.ai=new ff(0),this.ui=!1,this.ui=!0,this.ci=new PI,this.referenceDelegate=e(this),this.li=new UI(this),this.indexManager=new CI,this.remoteDocumentCache=(function(h){return new VI(h)})((a=>this.referenceDelegate.hi(a))),this.serializer=new _I(t),this.Pi=new jI(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ui=!1,Promise.resolve()}get started(){return this.ui}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new LI,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let a=this._i[e.toKey()];return a||(a=new BI(t,this.referenceDelegate),this._i[e.toKey()]=a),a}getGlobalsCache(){return this.ci}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Pi}runTransaction(e,t,a){lt("MemoryPersistence","Starting transaction:",e);const h=new zI(this.ai.next());return this.referenceDelegate.Ti(),a(h).next((f=>this.referenceDelegate.Ii(h).next((()=>f)))).toPromise().then((f=>(h.raiseOnCommittedEvent(),f)))}Ei(e,t){return qe.or(Object.values(this._i).map((a=>()=>a.containsKey(e,t))))}}class zI extends fN{constructor(e){super(),this.currentSequenceNumber=e}}class rg{constructor(e){this.persistence=e,this.Ri=new ig,this.Ai=null}static Vi(e){return new rg(e)}get di(){if(this.Ai)return this.Ai;throw Dt(60996)}addReference(e,t,a){return this.Ri.addReference(a,t),this.di.delete(a.toString()),qe.resolve()}removeReference(e,t,a){return this.Ri.removeReference(a,t),this.di.add(a.toString()),qe.resolve()}markPotentiallyOrphaned(e,t){return this.di.add(t.toString()),qe.resolve()}removeTarget(e,t){this.Ri.Gr(t.targetId).forEach((h=>this.di.add(h.toString())));const a=this.persistence.getTargetCache();return a.getMatchingKeysForTargetId(e,t.targetId).next((h=>{h.forEach((f=>this.di.add(f.toString())))})).next((()=>a.removeTargetData(e,t)))}Ti(){this.Ai=new Set}Ii(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return qe.forEach(this.di,(a=>{const h=At.fromPath(a);return this.mi(e,h).next((f=>{f||t.removeEntry(h,Lt.min())}))})).next((()=>(this.Ai=null,t.apply(e))))}updateLimboDocument(e,t){return this.mi(e,t).next((a=>{a?this.di.delete(t.toString()):this.di.add(t.toString())}))}hi(e){return 0}mi(e,t){return qe.or([()=>qe.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}}class Kd{constructor(e,t){this.persistence=e,this.fi=new bl((a=>pN(a.path)),((a,h)=>a.isEqual(h))),this.garbageCollector=DI(this,t)}static Vi(e,t){return new Kd(e,t)}Ti(){}Ii(e){return qe.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}dr(e){const t=this.pr(e);return this.persistence.getTargetCache().getTargetCount(e).next((a=>t.next((h=>a+h))))}pr(e){let t=0;return this.mr(e,(a=>{t++})).next((()=>t))}mr(e,t){return qe.forEach(this.fi,((a,h)=>this.wr(e,a,h).next((f=>f?qe.resolve():t(h)))))}removeTargets(e,t,a){return this.persistence.getTargetCache().removeTargets(e,t,a)}removeOrphanedDocuments(e,t){let a=0;const h=this.persistence.getRemoteDocumentCache(),f=h.newChangeBuffer();return h.ni(e,(y=>this.wr(e,y,t).next((A=>{A||(a++,f.removeEntry(y,Lt.min()))})))).next((()=>f.apply(e))).next((()=>a))}markPotentiallyOrphaned(e,t){return this.fi.set(t,e.currentSequenceNumber),qe.resolve()}removeTarget(e,t){const a=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,a)}addReference(e,t,a){return this.fi.set(a,e.currentSequenceNumber),qe.resolve()}removeReference(e,t,a){return this.fi.set(a,e.currentSequenceNumber),qe.resolve()}updateLimboDocument(e,t){return this.fi.set(t,e.currentSequenceNumber),qe.resolve()}hi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Cd(e.data.value)),t}wr(e,t,a){return qe.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const h=this.fi.get(t);return qe.resolve(h!==void 0&&h>a)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class ag{constructor(e,t,a,h){this.targetId=e,this.fromCache=t,this.Ts=a,this.Is=h}static Es(e,t){let a=dn(),h=dn();for(const f of t.docChanges)switch(f.type){case 0:a=a.add(f.doc.key);break;case 1:h=h.add(f.doc.key)}return new ag(e,t.fromCache,a,h)}}class HI{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class GI{constructor(){this.Rs=!1,this.As=!1,this.Vs=100,this.ds=(function(){return xT()?8:mN(yi())>0?6:4})()}initialize(e,t){this.fs=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,a,h){const f={result:null};return this.gs(e,t).next((y=>{f.result=y})).next((()=>{if(!f.result)return this.ps(e,t,h,a).next((y=>{f.result=y}))})).next((()=>{if(f.result)return;const y=new HI;return this.ys(e,t,y).next((A=>{if(f.result=A,this.As)return this.ws(e,t,y,A.size)}))})).next((()=>f.result))}ws(e,t,a,h){return a.documentReadCount<this.Vs?(nc()<=un.DEBUG&&lt("QueryEngine","SDK will not create cache indexes for query:",sc(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),qe.resolve()):(nc()<=un.DEBUG&&lt("QueryEngine","Query:",sc(t),"scans",a.documentReadCount,"local documents and returns",h,"documents as results."),a.documentReadCount>this.ds*h?(nc()<=un.DEBUG&&lt("QueryEngine","The SDK decides to create cache indexes for query:",sc(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Qr(t))):qe.resolve())}gs(e,t){if(Bx(t))return qe.resolve(null);let a=Qr(t);return this.indexManager.getIndexType(e,a).next((h=>h===0?null:(t.limit!==null&&h===1&&(t=am(t,null,"F"),a=Qr(t)),this.indexManager.getDocumentsMatchingTarget(e,a).next((f=>{const y=dn(...f);return this.fs.getDocuments(e,y).next((A=>this.indexManager.getMinOffset(e,a).next((C=>{const E=this.bs(t,A);return this.Ss(t,E,y,C.readTime)?this.gs(e,am(t,null,"F")):this.Ds(e,E,t,C)}))))})))))}ps(e,t,a,h){return Bx(t)||h.isEqual(Lt.min())?qe.resolve(null):this.fs.getDocuments(e,a).next((f=>{const y=this.bs(t,f);return this.Ss(t,y,a,h)?qe.resolve(null):(nc()<=un.DEBUG&&lt("QueryEngine","Re-using previous result from %s to execute query: %s",h.toString(),sc(t)),this.Ds(e,y,t,cN(h,Lu)).next((A=>A)))}))}bs(e,t){let a=new Us(Ib(e));return t.forEach(((h,f)=>{yf(e,f)&&(a=a.add(f))})),a}Ss(e,t,a,h){if(e.limit===null)return!1;if(a.size!==t.size)return!0;const f=e.limitType==="F"?t.last():t.first();return!!f&&(f.hasPendingWrites||f.version.compareTo(h)>0)}ys(e,t,a){return nc()<=un.DEBUG&&lt("QueryEngine","Using full collection scan to execute query:",sc(t)),this.fs.getDocumentsMatchingQuery(e,t,ko.min(),a)}Ds(e,t,a,h){return this.fs.getDocumentsMatchingQuery(e,a,h).next((f=>(t.forEach((y=>{f=f.insert(y.key,y)})),f)))}}const og="LocalStore",qI=3e8;class WI{constructor(e,t,a,h){this.persistence=e,this.Cs=t,this.serializer=h,this.vs=new ds(hn),this.Fs=new bl((f=>Qm(f)),Zm),this.Ms=new Map,this.xs=e.getRemoteDocumentCache(),this.li=e.getTargetCache(),this.Pi=e.getBundleCache(),this.Os(a)}Os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new OI(this.xs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.xs.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.vs)))}}function YI(i,e,t,a){return new WI(i,e,t,a)}async function Jb(i,e){const t=Ut(i);return await t.persistence.runTransaction("Handle user change","readonly",(a=>{let h;return t.mutationQueue.getAllMutationBatches(a).next((f=>(h=f,t.Os(e),t.mutationQueue.getAllMutationBatches(a)))).next((f=>{const y=[],A=[];let C=dn();for(const E of h){y.push(E.batchId);for(const S of E.mutations)C=C.add(S.key)}for(const E of f){A.push(E.batchId);for(const S of E.mutations)C=C.add(S.key)}return t.localDocuments.getDocuments(a,C).next((E=>({Ns:E,removedBatchIds:y,addedBatchIds:A})))}))}))}function XI(i,e){const t=Ut(i);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(a=>{const h=e.batch.keys(),f=t.xs.newChangeBuffer({trackRemovals:!0});return(function(A,C,E,S){const I=E.batch,j=I.keys();let Y=qe.resolve();return j.forEach((X=>{Y=Y.next((()=>S.getEntry(C,X))).next((G=>{const J=E.docVersions.get(X);kn(J!==null,48541),G.version.compareTo(J)<0&&(I.applyToRemoteDocument(G,E),G.isValidDocument()&&(G.setReadTime(E.commitVersion),S.addEntry(G)))}))})),Y.next((()=>A.mutationQueue.removeMutationBatch(C,I)))})(t,a,e,f).next((()=>f.apply(a))).next((()=>t.mutationQueue.performConsistencyCheck(a))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(a,h,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(a,(function(A){let C=dn();for(let E=0;E<A.mutationResults.length;++E)A.mutationResults[E].transformResults.length>0&&(C=C.add(A.batch.mutations[E].key));return C})(e)))).next((()=>t.localDocuments.getDocuments(a,h)))}))}function eE(i){const e=Ut(i);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.li.getLastRemoteSnapshotVersion(t)))}function KI(i,e){const t=Ut(i),a=e.snapshotVersion;let h=t.vs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(f=>{const y=t.xs.newChangeBuffer({trackRemovals:!0});h=t.vs;const A=[];e.targetChanges.forEach(((S,I)=>{const j=h.get(I);if(!j)return;A.push(t.li.removeMatchingKeys(f,S.removedDocuments,I).next((()=>t.li.addMatchingKeys(f,S.addedDocuments,I))));let Y=j.withSequenceNumber(f.currentSequenceNumber);e.targetMismatches.get(I)!==null?Y=Y.withResumeToken(ri.EMPTY_BYTE_STRING,Lt.min()).withLastLimboFreeSnapshotVersion(Lt.min()):S.resumeToken.approximateByteSize()>0&&(Y=Y.withResumeToken(S.resumeToken,a)),h=h.insert(I,Y),(function(G,J,ae){return G.resumeToken.approximateByteSize()===0||J.snapshotVersion.toMicroseconds()-G.snapshotVersion.toMicroseconds()>=qI?!0:ae.addedDocuments.size+ae.modifiedDocuments.size+ae.removedDocuments.size>0})(j,Y,S)&&A.push(t.li.updateTargetData(f,Y))}));let C=Fa(),E=dn();if(e.documentUpdates.forEach((S=>{e.resolvedLimboDocuments.has(S)&&A.push(t.persistence.referenceDelegate.updateLimboDocument(f,S))})),A.push(QI(f,y,e.documentUpdates).next((S=>{C=S.Bs,E=S.Ls}))),!a.isEqual(Lt.min())){const S=t.li.getLastRemoteSnapshotVersion(f).next((I=>t.li.setTargetsMetadata(f,f.currentSequenceNumber,a)));A.push(S)}return qe.waitFor(A).next((()=>y.apply(f))).next((()=>t.localDocuments.getLocalViewOfDocuments(f,C,E))).next((()=>C))})).then((f=>(t.vs=h,f)))}function QI(i,e,t){let a=dn(),h=dn();return t.forEach((f=>a=a.add(f))),e.getEntries(i,a).next((f=>{let y=Fa();return t.forEach(((A,C)=>{const E=f.get(A);C.isFoundDocument()!==E.isFoundDocument()&&(h=h.add(A)),C.isNoDocument()&&C.version.isEqual(Lt.min())?(e.removeEntry(A,C.readTime),y=y.insert(A,C)):!E.isValidDocument()||C.version.compareTo(E.version)>0||C.version.compareTo(E.version)===0&&E.hasPendingWrites?(e.addEntry(C),y=y.insert(A,C)):lt(og,"Ignoring outdated watch update for ",A,". Current version:",E.version," Watch version:",C.version)})),{Bs:y,Ls:h}}))}function ZI(i,e){const t=Ut(i);return t.persistence.runTransaction("Get next mutation batch","readonly",(a=>(e===void 0&&(e=Ym),t.mutationQueue.getNextMutationBatchAfterBatchId(a,e))))}function $I(i,e){const t=Ut(i);return t.persistence.runTransaction("Allocate target","readwrite",(a=>{let h;return t.li.getTargetData(a,e).next((f=>f?(h=f,qe.resolve(h)):t.li.allocateTargetId(a).next((y=>(h=new To(e,y,"TargetPurposeListen",a.currentSequenceNumber),t.li.addTargetData(a,h).next((()=>h)))))))})).then((a=>{const h=t.vs.get(a.targetId);return(h===null||a.snapshotVersion.compareTo(h.snapshotVersion)>0)&&(t.vs=t.vs.insert(a.targetId,a),t.Fs.set(e,a.targetId)),a}))}async function hm(i,e,t){const a=Ut(i),h=a.vs.get(e),f=t?"readwrite":"readwrite-primary";try{t||await a.persistence.runTransaction("Release target",f,(y=>a.persistence.referenceDelegate.removeTarget(y,h)))}catch(y){if(!Rc(y))throw y;lt(og,`Failed to update sequence numbers for target ${e}: ${y}`)}a.vs=a.vs.remove(e),a.Fs.delete(h.target)}function Zx(i,e,t){const a=Ut(i);let h=Lt.min(),f=dn();return a.persistence.runTransaction("Execute query","readwrite",(y=>(function(C,E,S){const I=Ut(C),j=I.Fs.get(S);return j!==void 0?qe.resolve(I.vs.get(j)):I.li.getTargetData(E,S)})(a,y,Qr(e)).next((A=>{if(A)return h=A.lastLimboFreeSnapshotVersion,a.li.getMatchingKeysForTargetId(y,A.targetId).next((C=>{f=C}))})).next((()=>a.Cs.getDocumentsMatchingQuery(y,e,t?h:Lt.min(),t?f:dn()))).next((A=>(JI(a,BN(e),A),{documents:A,ks:f})))))}function JI(i,e,t){let a=i.Ms.get(e)||Lt.min();t.forEach(((h,f)=>{f.readTime.compareTo(a)>0&&(a=f.readTime)})),i.Ms.set(e,a)}class $x{constructor(){this.activeTargetIds=GN()}Qs(e){this.activeTargetIds=this.activeTargetIds.add(e)}Gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class e6{constructor(){this.vo=new $x,this.Fo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,a){}addLocalQueryTarget(e,t=!0){return t&&this.vo.Qs(e),this.Fo[e]||"not-current"}updateQueryState(e,t,a){this.Fo[e]=t}removeLocalQueryTarget(e){this.vo.Gs(e)}isLocalQueryTarget(e){return this.vo.activeTargetIds.has(e)}clearQueryState(e){delete this.Fo[e]}getAllActiveQueryTargets(){return this.vo.activeTargetIds}isActiveQueryTarget(e){return this.vo.activeTargetIds.has(e)}start(){return this.vo=new $x,Promise.resolve()}handleUserChange(e,t,a){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class t6{Mo(e){}shutdown(){}}const Jx="ConnectivityMonitor";class ev{constructor(){this.xo=()=>this.Oo(),this.No=()=>this.Bo(),this.Lo=[],this.ko()}Mo(e){this.Lo.push(e)}shutdown(){window.removeEventListener("online",this.xo),window.removeEventListener("offline",this.No)}ko(){window.addEventListener("online",this.xo),window.addEventListener("offline",this.No)}Oo(){lt(Jx,"Network connectivity changed: AVAILABLE");for(const e of this.Lo)e(0)}Bo(){lt(Jx,"Network connectivity changed: UNAVAILABLE");for(const e of this.Lo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let gd=null;function dm(){return gd===null?gd=(function(){return 268435456+Math.round(2147483648*Math.random())})():gd++,"0x"+gd.toString(16)}const O0="RestConnection",n6={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery",ExecutePipeline:"executePipeline"};class s6{get Ko(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",a=encodeURIComponent(this.databaseId.projectId),h=encodeURIComponent(this.databaseId.database);this.qo=t+"://"+e.host,this.Uo=`projects/${a}/databases/${h}`,this.$o=this.databaseId.database===Hd?`project_id=${a}`:`project_id=${a}&database_id=${h}`}Wo(e,t,a,h,f){const y=dm(),A=this.Qo(e,t.toUriEncodedString());lt(O0,`Sending RPC '${e}' ${y}:`,A,a);const C={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.$o};this.Go(C,h,f);const{host:E}=new URL(A),S=Cc(E);return this.zo(e,A,C,a,S).then((I=>(lt(O0,`Received RPC '${e}' ${y}: `,I),I)),(I=>{throw pc(O0,`RPC '${e}' ${y} failed with error: `,I,"url: ",A,"request:",a),I}))}jo(e,t,a,h,f,y){return this.Wo(e,t,a,h,f)}Go(e,t,a){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Nc})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((h,f)=>e[f]=h)),a&&a.headers.forEach(((h,f)=>e[f]=h))}Qo(e,t){const a=n6[e];let h=`${this.qo}/v1/${t}:${a}`;return this.databaseInfo.apiKey&&(h=`${h}?key=${encodeURIComponent(this.databaseInfo.apiKey)}`),h}terminate(){}}class i6{constructor(e){this.Ho=e.Ho,this.Jo=e.Jo}Zo(e){this.Xo=e}Yo(e){this.e_=e}t_(e){this.n_=e}onMessage(e){this.r_=e}close(){this.Jo()}send(e){this.Ho(e)}i_(){this.Xo()}s_(){this.e_()}o_(e){this.n_(e)}__(e){this.r_(e)}}const fi="WebChannelConnection",pu=(i,e,t)=>{i.listen(e,(a=>{try{t(a)}catch(h){setTimeout((()=>{throw h}),0)}}))};class dc extends s6{constructor(e){super(e),this.a_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}static u_(){if(!dc.c_){const e=rb();pu(e,ib.STAT_EVENT,(t=>{t.stat===J0.PROXY?lt(fi,"STAT_EVENT: detected buffering proxy"):t.stat===J0.NOPROXY&&lt(fi,"STAT_EVENT: detected no buffering proxy")})),dc.c_=!0}}zo(e,t,a,h,f){const y=dm();return new Promise(((A,C)=>{const E=new nb;E.setWithCredentials(!0),E.listenOnce(sb.COMPLETE,(()=>{try{switch(E.getLastErrorCode()){case Ad.NO_ERROR:const I=E.getResponseJson();lt(fi,`XHR for RPC '${e}' ${y} received:`,JSON.stringify(I)),A(I);break;case Ad.TIMEOUT:lt(fi,`RPC '${e}' ${y} timed out`),C(new rt(Fe.DEADLINE_EXCEEDED,"Request time out"));break;case Ad.HTTP_ERROR:const j=E.getStatus();if(lt(fi,`RPC '${e}' ${y} failed with status:`,j,"response text:",E.getResponseText()),j>0){let Y=E.getResponseJson();Array.isArray(Y)&&(Y=Y[0]);const X=Y?.error;if(X&&X.status&&X.message){const G=(function(ae){const ne=ae.toLowerCase().replace(/_/g,"-");return Object.values(Fe).indexOf(ne)>=0?ne:Fe.UNKNOWN})(X.status);C(new rt(G,X.message))}else C(new rt(Fe.UNKNOWN,"Server responded with status "+E.getStatus()))}else C(new rt(Fe.UNAVAILABLE,"Connection failed."));break;default:Dt(9055,{l_:e,streamId:y,h_:E.getLastErrorCode(),P_:E.getLastError()})}}finally{lt(fi,`RPC '${e}' ${y} completed.`)}}));const S=JSON.stringify(h);lt(fi,`RPC '${e}' ${y} sending request:`,h),E.send(t,"POST",S,a,15)}))}T_(e,t,a){const h=dm(),f=[this.qo,"/","google.firestore.v1.Firestore","/",e,"/channel"],y=this.createWebChannelTransport(),A={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},C=this.longPollingOptions.timeoutSeconds;C!==void 0&&(A.longPollingTimeout=Math.round(1e3*C)),this.useFetchStreams&&(A.useFetchStreams=!0),this.Go(A.initMessageHeaders,t,a),A.encodeInitMessageHeaders=!0;const E=f.join("");lt(fi,`Creating RPC '${e}' stream ${h}: ${E}`,A);const S=y.createWebChannel(E,A);this.I_(S);let I=!1,j=!1;const Y=new i6({Ho:X=>{j?lt(fi,`Not sending because RPC '${e}' stream ${h} is closed:`,X):(I||(lt(fi,`Opening RPC '${e}' stream ${h} transport.`),S.open(),I=!0),lt(fi,`RPC '${e}' stream ${h} sending:`,X),S.send(X))},Jo:()=>S.close()});return pu(S,bu.EventType.OPEN,(()=>{j||(lt(fi,`RPC '${e}' stream ${h} transport opened.`),Y.i_())})),pu(S,bu.EventType.CLOSE,(()=>{j||(j=!0,lt(fi,`RPC '${e}' stream ${h} transport closed`),Y.o_(),this.E_(S))})),pu(S,bu.EventType.ERROR,(X=>{j||(j=!0,pc(fi,`RPC '${e}' stream ${h} transport errored. Name:`,X.name,"Message:",X.message),Y.o_(new rt(Fe.UNAVAILABLE,"The operation could not be completed")))})),pu(S,bu.EventType.MESSAGE,(X=>{if(!j){const G=X.data[0];kn(!!G,16349);const J=G,ae=J?.error||J[0]?.error;if(ae){lt(fi,`RPC '${e}' stream ${h} received error:`,ae);const ne=ae.status;let ue=(function(Ce){const P=ks[Ce];if(P!==void 0)return Fb(P)})(ne),be=ae.message;ue===void 0&&(ue=Fe.INTERNAL,be="Unknown error status: "+ne+" with message "+ae.message),j=!0,Y.o_(new rt(ue,be)),S.close()}else lt(fi,`RPC '${e}' stream ${h} received:`,G),Y.__(G)}})),dc.u_(),setTimeout((()=>{Y.s_()}),0),Y}terminate(){this.a_.forEach((e=>e.close())),this.a_=[]}I_(e){this.a_.push(e)}E_(e){this.a_=this.a_.filter((t=>t===e))}Go(e,t,a){super.Go(e,t,a),this.databaseInfo.apiKey&&(e["x-goog-api-key"]=this.databaseInfo.apiKey)}createWebChannelTransport(){return ab()}}function r6(i){return new dc(i)}function j0(){return typeof document<"u"?document:null}function bf(i){return new cI(i,!0)}dc.c_=!1;class tE{constructor(e,t,a=1e3,h=1.5,f=6e4){this.Ci=e,this.timerId=t,this.R_=a,this.A_=h,this.V_=f,this.d_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.d_=0}g_(){this.d_=this.V_}p_(e){this.cancel();const t=Math.floor(this.d_+this.y_()),a=Math.max(0,Date.now()-this.f_),h=Math.max(0,t-a);h>0&&lt("ExponentialBackoff",`Backing off for ${h} ms (base delay: ${this.d_} ms, delay with jitter: ${t} ms, last attempt: ${a} ms ago)`),this.m_=this.Ci.enqueueAfterDelay(this.timerId,h,(()=>(this.f_=Date.now(),e()))),this.d_*=this.A_,this.d_<this.R_&&(this.d_=this.R_),this.d_>this.V_&&(this.d_=this.V_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.d_}}const tv="PersistentStream";class nE{constructor(e,t,a,h,f,y,A,C){this.Ci=e,this.b_=a,this.S_=h,this.connection=f,this.authCredentialsProvider=y,this.appCheckCredentialsProvider=A,this.listener=C,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new tE(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Ci.enqueueAfterDelay(this.b_,6e4,(()=>this.k_())))}K_(e){this.q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===Fe.RESOURCE_EXHAUSTED?(Va(t.toString()),Va("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===Fe.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.t_(t)}W_(){}auth(){this.state=1;const e=this.Q_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([a,h])=>{this.D_===t&&this.G_(a,h)}),(a=>{e((()=>{const h=new rt(Fe.UNKNOWN,"Fetching auth token failed: "+a.message);return this.z_(h)}))}))}G_(e,t){const a=this.Q_(this.D_);this.stream=this.j_(e,t),this.stream.Zo((()=>{a((()=>this.listener.Zo()))})),this.stream.Yo((()=>{a((()=>(this.state=2,this.v_=this.Ci.enqueueAfterDelay(this.S_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.Yo())))})),this.stream.t_((h=>{a((()=>this.z_(h)))})),this.stream.onMessage((h=>{a((()=>++this.F_==1?this.H_(h):this.onNext(h)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return lt(tv,`close with error: ${e}`),this.stream=null,this.close(4,e)}Q_(e){return t=>{this.Ci.enqueueAndForget((()=>this.D_===e?t():(lt(tv,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class a6 extends nE{constructor(e,t,a,h,f,y){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,a,h,y),this.serializer=f}j_(e,t){return this.connection.T_("Listen",e,t)}H_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=dI(this.serializer,e),a=(function(f){if(!("targetChange"in f))return Lt.min();const y=f.targetChange;return y.targetIds&&y.targetIds.length?Lt.min():y.readTime?Zr(y.readTime):Lt.min()})(e);return this.listener.J_(t,a)}Z_(e){const t={};t.database=um(this.serializer),t.addTarget=(function(f,y){let A;const C=y.target;if(A=im(C)?{documents:gI(f,C)}:{query:pI(f,C).ft},A.targetId=y.targetId,y.resumeToken.approximateByteSize()>0){A.resumeToken=Hb(f,y.resumeToken);const E=om(f,y.expectedCount);E!==null&&(A.expectedCount=E)}else if(y.snapshotVersion.compareTo(Lt.min())>0){A.readTime=Xd(f,y.snapshotVersion.toTimestamp());const E=om(f,y.expectedCount);E!==null&&(A.expectedCount=E)}return A})(this.serializer,e);const a=xI(this.serializer,e);a&&(t.labels=a),this.K_(t)}X_(e){const t={};t.database=um(this.serializer),t.removeTarget=e,this.K_(t)}}class o6 extends nE{constructor(e,t,a,h,f,y){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,a,h,y),this.serializer=f}get Y_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.Y_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}H_(e){return kn(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,kn(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){kn(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=mI(e.writeResults,e.commitTime),a=Zr(e.commitTime);return this.listener.na(a,t)}ra(){const e={};e.database=um(this.serializer),this.K_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((a=>fI(this.serializer,a)))};this.K_(t)}}class l6{}class c6 extends l6{constructor(e,t,a,h){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=a,this.serializer=h,this.ia=!1}sa(){if(this.ia)throw new rt(Fe.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,a,h){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([f,y])=>this.connection.Wo(e,lm(t,a),h,f,y))).catch((f=>{throw f.name==="FirebaseError"?(f.code===Fe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),f):new rt(Fe.UNKNOWN,f.toString())}))}jo(e,t,a,h,f){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([y,A])=>this.connection.jo(e,lm(t,a),h,y,A,f))).catch((y=>{throw y.name==="FirebaseError"?(y.code===Fe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),y):new rt(Fe.UNKNOWN,y.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}function u6(i,e,t,a){return new c6(i,e,t,a)}class h6{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Va(t),this.aa=!1):lt("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const vl="RemoteStore";class d6{constructor(e,t,a,h,f){this.localStore=e,this.datastore=t,this.asyncQueue=a,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.Ra=[],this.Aa=f,this.Aa.Mo((y=>{a.enqueueAndForget((async()=>{El(this)&&(lt(vl,"Restarting streams for network reachability change."),await(async function(C){const E=Ut(C);E.Ea.add(4),await th(E),E.Va.set("Unknown"),E.Ea.delete(4),await Ef(E)})(this))}))})),this.Va=new h6(a,h)}}async function Ef(i){if(El(i))for(const e of i.Ra)await e(!0)}async function th(i){for(const e of i.Ra)await e(!1)}function sE(i,e){const t=Ut(i);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),hg(t)?ug(t):kc(t).O_()&&cg(t,e))}function lg(i,e){const t=Ut(i),a=kc(t);t.Ia.delete(e),a.O_()&&iE(t,e),t.Ia.size===0&&(a.O_()?a.L_():El(t)&&t.Va.set("Unknown"))}function cg(i,e){if(i.da.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Lt.min())>0){const t=i.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}kc(i).Z_(e)}function iE(i,e){i.da.$e(e),kc(i).X_(e)}function ug(i){i.da=new rI({getRemoteKeysForTarget:e=>i.remoteSyncer.getRemoteKeysForTarget(e),At:e=>i.Ia.get(e)||null,ht:()=>i.datastore.serializer.databaseId}),kc(i).start(),i.Va.ua()}function hg(i){return El(i)&&!kc(i).x_()&&i.Ia.size>0}function El(i){return Ut(i).Ea.size===0}function rE(i){i.da=void 0}async function f6(i){i.Va.set("Online")}async function m6(i){i.Ia.forEach(((e,t)=>{cg(i,e)}))}async function g6(i,e){rE(i),hg(i)?(i.Va.ha(e),ug(i)):i.Va.set("Unknown")}async function p6(i,e,t){if(i.Va.set("Online"),e instanceof zb&&e.state===2&&e.cause)try{await(async function(h,f){const y=f.cause;for(const A of f.targetIds)h.Ia.has(A)&&(await h.remoteSyncer.rejectListen(A,y),h.Ia.delete(A),h.da.removeTarget(A))})(i,e)}catch(a){lt(vl,"Failed to remove targets %s: %s ",e.targetIds.join(","),a),await Qd(i,a)}else if(e instanceof Nd?i.da.Xe(e):e instanceof Ub?i.da.st(e):i.da.tt(e),!t.isEqual(Lt.min()))try{const a=await eE(i.localStore);t.compareTo(a)>=0&&await(function(f,y){const A=f.da.Tt(y);return A.targetChanges.forEach(((C,E)=>{if(C.resumeToken.approximateByteSize()>0){const S=f.Ia.get(E);S&&f.Ia.set(E,S.withResumeToken(C.resumeToken,y))}})),A.targetMismatches.forEach(((C,E)=>{const S=f.Ia.get(C);if(!S)return;f.Ia.set(C,S.withResumeToken(ri.EMPTY_BYTE_STRING,S.snapshotVersion)),iE(f,C);const I=new To(S.target,C,E,S.sequenceNumber);cg(f,I)})),f.remoteSyncer.applyRemoteEvent(A)})(i,t)}catch(a){lt(vl,"Failed to raise snapshot:",a),await Qd(i,a)}}async function Qd(i,e,t){if(!Rc(e))throw e;i.Ea.add(1),await th(i),i.Va.set("Offline"),t||(t=()=>eE(i.localStore)),i.asyncQueue.enqueueRetryable((async()=>{lt(vl,"Retrying IndexedDB access"),await t(),i.Ea.delete(1),await Ef(i)}))}function aE(i,e){return e().catch((t=>Qd(i,t,e)))}async function _f(i){const e=Ut(i),t=Lo(e);let a=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Ym;for(;y6(e);)try{const h=await ZI(e.localStore,a);if(h===null){e.Ta.length===0&&t.L_();break}a=h.batchId,x6(e,h)}catch(h){await Qd(e,h)}oE(e)&&lE(e)}function y6(i){return El(i)&&i.Ta.length<10}function x6(i,e){i.Ta.push(e);const t=Lo(i);t.O_()&&t.Y_&&t.ea(e.mutations)}function oE(i){return El(i)&&!Lo(i).x_()&&i.Ta.length>0}function lE(i){Lo(i).start()}async function v6(i){Lo(i).ra()}async function w6(i){const e=Lo(i);for(const t of i.Ta)e.ea(t.mutations)}async function b6(i,e,t){const a=i.Ta.shift(),h=tg.from(a,e,t);await aE(i,(()=>i.remoteSyncer.applySuccessfulWrite(h))),await _f(i)}async function E6(i,e){e&&Lo(i).Y_&&await(async function(a,h){if((function(y){return nI(y)&&y!==Fe.ABORTED})(h.code)){const f=a.Ta.shift();Lo(a).B_(),await aE(a,(()=>a.remoteSyncer.rejectFailedWrite(f.batchId,h))),await _f(a)}})(i,e),oE(i)&&lE(i)}async function nv(i,e){const t=Ut(i);t.asyncQueue.verifyOperationInProgress(),lt(vl,"RemoteStore received new credentials");const a=El(t);t.Ea.add(3),await th(t),a&&t.Va.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await Ef(t)}async function _6(i,e){const t=Ut(i);e?(t.Ea.delete(2),await Ef(t)):e||(t.Ea.add(2),await th(t),t.Va.set("Unknown"))}function kc(i){return i.ma||(i.ma=(function(t,a,h){const f=Ut(t);return f.sa(),new a6(a,f.connection,f.authCredentials,f.appCheckCredentials,f.serializer,h)})(i.datastore,i.asyncQueue,{Zo:f6.bind(null,i),Yo:m6.bind(null,i),t_:g6.bind(null,i),J_:p6.bind(null,i)}),i.Ra.push((async e=>{e?(i.ma.B_(),hg(i)?ug(i):i.Va.set("Unknown")):(await i.ma.stop(),rE(i))}))),i.ma}function Lo(i){return i.fa||(i.fa=(function(t,a,h){const f=Ut(t);return f.sa(),new o6(a,f.connection,f.authCredentials,f.appCheckCredentials,f.serializer,h)})(i.datastore,i.asyncQueue,{Zo:()=>Promise.resolve(),Yo:v6.bind(null,i),t_:E6.bind(null,i),ta:w6.bind(null,i),na:b6.bind(null,i)}),i.Ra.push((async e=>{e?(i.fa.B_(),await _f(i)):(await i.fa.stop(),i.Ta.length>0&&(lt(vl,`Stopping write stream with ${i.Ta.length} pending writes`),i.Ta=[]))}))),i.fa}class dg{constructor(e,t,a,h,f){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=a,this.op=h,this.removalCallback=f,this.deferred=new Oa,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((y=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,a,h,f){const y=Date.now()+a,A=new dg(e,t,y,h,f);return A.start(a),A}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new rt(Fe.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function fg(i,e){if(Va("AsyncQueue",`${e}: ${i}`),Rc(i))return new rt(Fe.UNAVAILABLE,`${e}: ${i}`);throw i}class fc{static emptySet(e){return new fc(e.comparator)}constructor(e){this.comparator=e?(t,a)=>e(t,a)||At.comparator(t.key,a.key):(t,a)=>At.comparator(t.key,a.key),this.keyedMap=Eu(),this.sortedSet=new ds(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,a)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof fc)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),a=e.sortedSet.getIterator();for(;t.hasNext();){const h=t.getNext().key,f=a.getNext().key;if(!h.isEqual(f))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const a=new fc;return a.comparator=this.comparator,a.keyedMap=e,a.sortedSet=t,a}}class sv{constructor(){this.ga=new ds(At.comparator)}track(e){const t=e.doc.key,a=this.ga.get(t);a?e.type!==0&&a.type===3?this.ga=this.ga.insert(t,e):e.type===3&&a.type!==1?this.ga=this.ga.insert(t,{type:a.type,doc:e.doc}):e.type===2&&a.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&a.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&a.type===0?this.ga=this.ga.remove(t):e.type===1&&a.type===2?this.ga=this.ga.insert(t,{type:1,doc:a.doc}):e.type===0&&a.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):Dt(63341,{Vt:e,pa:a}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,a)=>{e.push(a)})),e}}class bc{constructor(e,t,a,h,f,y,A,C,E){this.query=e,this.docs=t,this.oldDocs=a,this.docChanges=h,this.mutatedKeys=f,this.fromCache=y,this.syncStateChanged=A,this.excludesMetadataChanges=C,this.hasCachedResults=E}static fromInitialDocuments(e,t,a,h,f){const y=[];return t.forEach((A=>{y.push({type:0,doc:A})})),new bc(e,t,fc.emptySet(t),y,a,h,!0,!1,f)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&pf(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,a=e.docChanges;if(t.length!==a.length)return!1;for(let h=0;h<t.length;h++)if(t[h].type!==a[h].type||!t[h].doc.isEqual(a[h].doc))return!1;return!0}}class A6{constructor(){this.wa=void 0,this.ba=[]}Sa(){return this.ba.some((e=>e.Da()))}}class C6{constructor(){this.queries=iv(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,a){const h=Ut(t),f=h.queries;h.queries=iv(),f.forEach(((y,A)=>{for(const C of A.ba)C.onError(a)}))})(this,new rt(Fe.ABORTED,"Firestore shutting down"))}}function iv(){return new bl((i=>Nb(i)),pf)}async function cE(i,e){const t=Ut(i);let a=3;const h=e.query;let f=t.queries.get(h);f?!f.Sa()&&e.Da()&&(a=2):(f=new A6,a=e.Da()?0:1);try{switch(a){case 0:f.wa=await t.onListen(h,!0);break;case 1:f.wa=await t.onListen(h,!1);break;case 2:await t.onFirstRemoteStoreListen(h)}}catch(y){const A=fg(y,`Initialization of query '${sc(e.query)}' failed`);return void e.onError(A)}t.queries.set(h,f),f.ba.push(e),e.va(t.onlineState),f.wa&&e.Fa(f.wa)&&mg(t)}async function uE(i,e){const t=Ut(i),a=e.query;let h=3;const f=t.queries.get(a);if(f){const y=f.ba.indexOf(e);y>=0&&(f.ba.splice(y,1),f.ba.length===0?h=e.Da()?0:1:!f.Sa()&&e.Da()&&(h=2))}switch(h){case 0:return t.queries.delete(a),t.onUnlisten(a,!0);case 1:return t.queries.delete(a),t.onUnlisten(a,!1);case 2:return t.onLastRemoteStoreUnlisten(a);default:return}}function T6(i,e){const t=Ut(i);let a=!1;for(const h of e){const f=h.query,y=t.queries.get(f);if(y){for(const A of y.ba)A.Fa(h)&&(a=!0);y.wa=h}}a&&mg(t)}function S6(i,e,t){const a=Ut(i),h=a.queries.get(e);if(h)for(const f of h.ba)f.onError(t);a.queries.delete(e)}function mg(i){i.Ca.forEach((e=>{e.next()}))}var fm,rv;(rv=fm||(fm={})).Ma="default",rv.Cache="cache";class hE{constructor(e,t,a){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=a||{}}Fa(e){if(!this.options.includeMetadataChanges){const a=[];for(const h of e.docChanges)h.type!==3&&a.push(h);e=new bc(e.query,e.docs,e.oldDocs,a,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const a=t!=="Offline";return(!this.options.Ka||!a)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=bc.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==fm.Cache}}class dE{constructor(e){this.key=e}}class fE{constructor(e){this.key=e}}class N6{constructor(e,t){this.query=e,this.Za=t,this.Xa=null,this.hasCachedResults=!1,this.current=!1,this.Ya=dn(),this.mutatedKeys=dn(),this.eu=Ib(e),this.tu=new fc(this.eu)}get nu(){return this.Za}ru(e,t){const a=t?t.iu:new sv,h=t?t.tu:this.tu;let f=t?t.mutatedKeys:this.mutatedKeys,y=h,A=!1;const C=this.query.limitType==="F"&&h.size===this.query.limit?h.last():null,E=this.query.limitType==="L"&&h.size===this.query.limit?h.first():null;if(e.inorderTraversal(((S,I)=>{const j=h.get(S),Y=yf(this.query,I)?I:null,X=!!j&&this.mutatedKeys.has(j.key),G=!!Y&&(Y.hasLocalMutations||this.mutatedKeys.has(Y.key)&&Y.hasCommittedMutations);let J=!1;j&&Y?j.data.isEqual(Y.data)?X!==G&&(a.track({type:3,doc:Y}),J=!0):this.su(j,Y)||(a.track({type:2,doc:Y}),J=!0,(C&&this.eu(Y,C)>0||E&&this.eu(Y,E)<0)&&(A=!0)):!j&&Y?(a.track({type:0,doc:Y}),J=!0):j&&!Y&&(a.track({type:1,doc:j}),J=!0,(C||E)&&(A=!0)),J&&(Y?(y=y.add(Y),f=G?f.add(S):f.delete(S)):(y=y.delete(S),f=f.delete(S)))})),this.query.limit!==null)for(;y.size>this.query.limit;){const S=this.query.limitType==="F"?y.last():y.first();y=y.delete(S.key),f=f.delete(S.key),a.track({type:1,doc:S})}return{tu:y,iu:a,Ss:A,mutatedKeys:f}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,a,h){const f=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const y=e.iu.ya();y.sort(((S,I)=>(function(Y,X){const G=J=>{switch(J){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Dt(20277,{Vt:J})}};return G(Y)-G(X)})(S.type,I.type)||this.eu(S.doc,I.doc))),this.ou(a),h=h??!1;const A=t&&!h?this._u():[],C=this.Ya.size===0&&this.current&&!h?1:0,E=C!==this.Xa;return this.Xa=C,y.length!==0||E?{snapshot:new bc(this.query,e.tu,f,y,e.mutatedKeys,C===0,E,!1,!!a&&a.resumeToken.approximateByteSize()>0),au:A}:{au:A}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new sv,mutatedKeys:this.mutatedKeys,Ss:!1},!1)):{au:[]}}uu(e){return!this.Za.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Za=this.Za.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Za=this.Za.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Ya;this.Ya=dn(),this.tu.forEach((a=>{this.uu(a.key)&&(this.Ya=this.Ya.add(a.key))}));const t=[];return e.forEach((a=>{this.Ya.has(a)||t.push(new fE(a))})),this.Ya.forEach((a=>{e.has(a)||t.push(new dE(a))})),t}cu(e){this.Za=e.ks,this.Ya=dn();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return bc.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Xa===0,this.hasCachedResults)}}const gg="SyncEngine";class I6{constructor(e,t,a){this.query=e,this.targetId=t,this.view=a}}class R6{constructor(e){this.key=e,this.hu=!1}}class D6{constructor(e,t,a,h,f,y){this.localStore=e,this.remoteStore=t,this.eventManager=a,this.sharedClientState=h,this.currentUser=f,this.maxConcurrentLimboResolutions=y,this.Pu={},this.Tu=new bl((A=>Nb(A)),pf),this.Iu=new Map,this.Eu=new Set,this.Ru=new ds(At.comparator),this.Au=new Map,this.Vu=new ig,this.du={},this.mu=new Map,this.fu=wc.ar(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function k6(i,e,t=!0){const a=vE(i);let h;const f=a.Tu.get(e);return f?(a.sharedClientState.addLocalQueryTarget(f.targetId),h=f.view.lu()):h=await mE(a,e,t,!0),h}async function M6(i,e){const t=vE(i);await mE(t,e,!0,!1)}async function mE(i,e,t,a){const h=await $I(i.localStore,Qr(e)),f=h.targetId,y=i.sharedClientState.addLocalQueryTarget(f,t);let A;return a&&(A=await O6(i,e,f,y==="current",h.resumeToken)),i.isPrimaryClient&&t&&sE(i.remoteStore,h),A}async function O6(i,e,t,a,h){i.pu=(I,j,Y)=>(async function(G,J,ae,ne){let ue=J.view.ru(ae);ue.Ss&&(ue=await Zx(G.localStore,J.query,!1).then((({documents:P})=>J.view.ru(P,ue))));const be=ne&&ne.targetChanges.get(J.targetId),Me=ne&&ne.targetMismatches.get(J.targetId)!=null,Ce=J.view.applyChanges(ue,G.isPrimaryClient,be,Me);return ov(G,J.targetId,Ce.au),Ce.snapshot})(i,I,j,Y);const f=await Zx(i.localStore,e,!0),y=new N6(e,f.ks),A=y.ru(f.documents),C=eh.createSynthesizedTargetChangeForCurrentChange(t,a&&i.onlineState!=="Offline",h),E=y.applyChanges(A,i.isPrimaryClient,C);ov(i,t,E.au);const S=new I6(e,t,y);return i.Tu.set(e,S),i.Iu.has(t)?i.Iu.get(t).push(e):i.Iu.set(t,[e]),E.snapshot}async function j6(i,e,t){const a=Ut(i),h=a.Tu.get(e),f=a.Iu.get(h.targetId);if(f.length>1)return a.Iu.set(h.targetId,f.filter((y=>!pf(y,e)))),void a.Tu.delete(e);a.isPrimaryClient?(a.sharedClientState.removeLocalQueryTarget(h.targetId),a.sharedClientState.isActiveQueryTarget(h.targetId)||await hm(a.localStore,h.targetId,!1).then((()=>{a.sharedClientState.clearQueryState(h.targetId),t&&lg(a.remoteStore,h.targetId),mm(a,h.targetId)})).catch(Ic)):(mm(a,h.targetId),await hm(a.localStore,h.targetId,!0))}async function L6(i,e){const t=Ut(i),a=t.Tu.get(e),h=t.Iu.get(a.targetId);t.isPrimaryClient&&h.length===1&&(t.sharedClientState.removeLocalQueryTarget(a.targetId),lg(t.remoteStore,a.targetId))}async function P6(i,e,t){const a=G6(i);try{const h=await(function(y,A){const C=Ut(y),E=vt.now(),S=A.reduce(((Y,X)=>Y.add(X.key)),dn());let I,j;return C.persistence.runTransaction("Locally write mutations","readwrite",(Y=>{let X=Fa(),G=dn();return C.xs.getEntries(Y,S).next((J=>{X=J,X.forEach(((ae,ne)=>{ne.isValidDocument()||(G=G.add(ae))}))})).next((()=>C.localDocuments.getOverlayedDocuments(Y,X))).next((J=>{I=J;const ae=[];for(const ne of A){const ue=ZN(ne,I.get(ne.key).overlayedDocument);ue!=null&&ae.push(new Uo(ne.key,ue,wb(ue.value.mapValue),wr.exists(!0)))}return C.mutationQueue.addMutationBatch(Y,E,ae,A)})).next((J=>{j=J;const ae=J.applyToLocalDocumentSet(I,G);return C.documentOverlayCache.saveOverlays(Y,J.batchId,ae)}))})).then((()=>({batchId:j.batchId,changes:Db(I)})))})(a.localStore,e);a.sharedClientState.addPendingMutation(h.batchId),(function(y,A,C){let E=y.du[y.currentUser.toKey()];E||(E=new ds(hn)),E=E.insert(A,C),y.du[y.currentUser.toKey()]=E})(a,h.batchId,t),await nh(a,h.changes),await _f(a.remoteStore)}catch(h){const f=fg(h,"Failed to persist write");t.reject(f)}}async function gE(i,e){const t=Ut(i);try{const a=await KI(t.localStore,e);e.targetChanges.forEach(((h,f)=>{const y=t.Au.get(f);y&&(kn(h.addedDocuments.size+h.modifiedDocuments.size+h.removedDocuments.size<=1,22616),h.addedDocuments.size>0?y.hu=!0:h.modifiedDocuments.size>0?kn(y.hu,14607):h.removedDocuments.size>0&&(kn(y.hu,42227),y.hu=!1))})),await nh(t,a,e)}catch(a){await Ic(a)}}function av(i,e,t){const a=Ut(i);if(a.isPrimaryClient&&t===0||!a.isPrimaryClient&&t===1){const h=[];a.Tu.forEach(((f,y)=>{const A=y.view.va(e);A.snapshot&&h.push(A.snapshot)})),(function(y,A){const C=Ut(y);C.onlineState=A;let E=!1;C.queries.forEach(((S,I)=>{for(const j of I.ba)j.va(A)&&(E=!0)})),E&&mg(C)})(a.eventManager,e),h.length&&a.Pu.J_(h),a.onlineState=e,a.isPrimaryClient&&a.sharedClientState.setOnlineState(e)}}async function B6(i,e,t){const a=Ut(i);a.sharedClientState.updateQueryState(e,"rejected",t);const h=a.Au.get(e),f=h&&h.key;if(f){let y=new ds(At.comparator);y=y.insert(f,pi.newNoDocument(f,Lt.min()));const A=dn().add(f),C=new wf(Lt.min(),new Map,new ds(hn),y,A);await gE(a,C),a.Ru=a.Ru.remove(f),a.Au.delete(e),pg(a)}else await hm(a.localStore,e,!1).then((()=>mm(a,e,t))).catch(Ic)}async function V6(i,e){const t=Ut(i),a=e.batch.batchId;try{const h=await XI(t.localStore,e);yE(t,a,null),pE(t,a),t.sharedClientState.updateMutationState(a,"acknowledged"),await nh(t,h)}catch(h){await Ic(h)}}async function F6(i,e,t){const a=Ut(i);try{const h=await(function(y,A){const C=Ut(y);return C.persistence.runTransaction("Reject batch","readwrite-primary",(E=>{let S;return C.mutationQueue.lookupMutationBatch(E,A).next((I=>(kn(I!==null,37113),S=I.keys(),C.mutationQueue.removeMutationBatch(E,I)))).next((()=>C.mutationQueue.performConsistencyCheck(E))).next((()=>C.documentOverlayCache.removeOverlaysForBatchId(E,S,A))).next((()=>C.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(E,S))).next((()=>C.localDocuments.getDocuments(E,S)))}))})(a.localStore,e);yE(a,e,t),pE(a,e),a.sharedClientState.updateMutationState(e,"rejected",t),await nh(a,h)}catch(h){await Ic(h)}}function pE(i,e){(i.mu.get(e)||[]).forEach((t=>{t.resolve()})),i.mu.delete(e)}function yE(i,e,t){const a=Ut(i);let h=a.du[a.currentUser.toKey()];if(h){const f=h.get(e);f&&(t?f.reject(t):f.resolve(),h=h.remove(e)),a.du[a.currentUser.toKey()]=h}}function mm(i,e,t=null){i.sharedClientState.removeLocalQueryTarget(e);for(const a of i.Iu.get(e))i.Tu.delete(a),t&&i.Pu.yu(a,t);i.Iu.delete(e),i.isPrimaryClient&&i.Vu.Gr(e).forEach((a=>{i.Vu.containsKey(a)||xE(i,a)}))}function xE(i,e){i.Eu.delete(e.path.canonicalString());const t=i.Ru.get(e);t!==null&&(lg(i.remoteStore,t),i.Ru=i.Ru.remove(e),i.Au.delete(t),pg(i))}function ov(i,e,t){for(const a of t)a instanceof dE?(i.Vu.addReference(a.key,e),U6(i,a)):a instanceof fE?(lt(gg,"Document no longer in limbo: "+a.key),i.Vu.removeReference(a.key,e),i.Vu.containsKey(a.key)||xE(i,a.key)):Dt(19791,{wu:a})}function U6(i,e){const t=e.key,a=t.path.canonicalString();i.Ru.get(t)||i.Eu.has(a)||(lt(gg,"New document in limbo: "+t),i.Eu.add(a),pg(i))}function pg(i){for(;i.Eu.size>0&&i.Ru.size<i.maxConcurrentLimboResolutions;){const e=i.Eu.values().next().value;i.Eu.delete(e);const t=new At(qn.fromString(e)),a=i.fu.next();i.Au.set(a,new R6(t)),i.Ru=i.Ru.insert(t,a),sE(i.remoteStore,new To(Qr($m(t.path)),a,"TargetPurposeLimboResolution",ff.ce))}}async function nh(i,e,t){const a=Ut(i),h=[],f=[],y=[];a.Tu.isEmpty()||(a.Tu.forEach(((A,C)=>{y.push(a.pu(C,e,t).then((E=>{if((E||t)&&a.isPrimaryClient){const S=E?!E.fromCache:t?.targetChanges.get(C.targetId)?.current;a.sharedClientState.updateQueryState(C.targetId,S?"current":"not-current")}if(E){h.push(E);const S=ag.Es(C.targetId,E);f.push(S)}})))})),await Promise.all(y),a.Pu.J_(h),await(async function(C,E){const S=Ut(C);try{await S.persistence.runTransaction("notifyLocalViewChanges","readwrite",(I=>qe.forEach(E,(j=>qe.forEach(j.Ts,(Y=>S.persistence.referenceDelegate.addReference(I,j.targetId,Y))).next((()=>qe.forEach(j.Is,(Y=>S.persistence.referenceDelegate.removeReference(I,j.targetId,Y)))))))))}catch(I){if(!Rc(I))throw I;lt(og,"Failed to update sequence numbers: "+I)}for(const I of E){const j=I.targetId;if(!I.fromCache){const Y=S.vs.get(j),X=Y.snapshotVersion,G=Y.withLastLimboFreeSnapshotVersion(X);S.vs=S.vs.insert(j,G)}}})(a.localStore,f))}async function z6(i,e){const t=Ut(i);if(!t.currentUser.isEqual(e)){lt(gg,"User change. New user:",e.toKey());const a=await Jb(t.localStore,e);t.currentUser=e,(function(f,y){f.mu.forEach((A=>{A.forEach((C=>{C.reject(new rt(Fe.CANCELLED,y))}))})),f.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,a.removedBatchIds,a.addedBatchIds),await nh(t,a.Ns)}}function H6(i,e){const t=Ut(i),a=t.Au.get(e);if(a&&a.hu)return dn().add(a.key);{let h=dn();const f=t.Iu.get(e);if(!f)return h;for(const y of f){const A=t.Tu.get(y);h=h.unionWith(A.view.nu)}return h}}function vE(i){const e=Ut(i);return e.remoteStore.remoteSyncer.applyRemoteEvent=gE.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=H6.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=B6.bind(null,e),e.Pu.J_=T6.bind(null,e.eventManager),e.Pu.yu=S6.bind(null,e.eventManager),e}function G6(i){const e=Ut(i);return e.remoteStore.remoteSyncer.applySuccessfulWrite=V6.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=F6.bind(null,e),e}class Zd{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=bf(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return YI(this.persistence,new GI,e.initialUser,this.serializer)}Cu(e){return new $b(rg.Vi,this.serializer)}Du(e){return new e6}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Zd.provider={build:()=>new Zd};class q6 extends Zd{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){kn(this.persistence.referenceDelegate instanceof Kd,46915);const a=this.persistence.referenceDelegate.garbageCollector;return new II(a,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?Pi.withCacheSize(this.cacheSizeBytes):Pi.DEFAULT;return new $b((a=>Kd.Vi(a,t)),this.serializer)}}class gm{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=a=>av(this.syncEngine,a,1),this.remoteStore.remoteSyncer.handleCredentialChange=z6.bind(null,this.syncEngine),await _6(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new C6})()}createDatastore(e){const t=bf(e.databaseInfo.databaseId),a=r6(e.databaseInfo);return u6(e.authCredentials,e.appCheckCredentials,a,t)}createRemoteStore(e){return(function(a,h,f,y,A){return new d6(a,h,f,y,A)})(this.localStore,this.datastore,e.asyncQueue,(t=>av(this.syncEngine,t,0)),(function(){return ev.v()?new ev:new t6})())}createSyncEngine(e,t){return(function(h,f,y,A,C,E,S){const I=new D6(h,f,y,A,C,E);return S&&(I.gu=!0),I})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const a=Ut(t);lt(vl,"RemoteStore shutting down."),a.Ea.add(5),await th(a),a.Aa.shutdown(),a.Va.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}gm.provider={build:()=>new gm};class wE{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Va("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}const Po="FirestoreClient";class W6{constructor(e,t,a,h,f){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=a,this._databaseInfo=h,this.user=gi.UNAUTHENTICATED,this.clientId=Wm.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=f,this.authCredentials.start(a,(async y=>{lt(Po,"Received user=",y.uid),await this.authCredentialListener(y),this.user=y})),this.appCheckCredentials.start(a,(y=>(lt(Po,"Received new app check token=",y),this.appCheckCredentialListener(y,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this._databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Oa;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const a=fg(t,"Failed to shutdown persistence");e.reject(a)}})),e.promise}}async function L0(i,e){i.asyncQueue.verifyOperationInProgress(),lt(Po,"Initializing OfflineComponentProvider");const t=i.configuration;await e.initialize(t);let a=t.initialUser;i.setCredentialChangeListener((async h=>{a.isEqual(h)||(await Jb(e.localStore,h),a=h)})),e.persistence.setDatabaseDeletedListener((()=>i.terminate())),i._offlineComponents=e}async function lv(i,e){i.asyncQueue.verifyOperationInProgress();const t=await Y6(i);lt(Po,"Initializing OnlineComponentProvider"),await e.initialize(t,i.configuration),i.setCredentialChangeListener((a=>nv(e.remoteStore,a))),i.setAppCheckTokenChangeListener(((a,h)=>nv(e.remoteStore,h))),i._onlineComponents=e}async function Y6(i){if(!i._offlineComponents)if(i._uninitializedComponentsProvider){lt(Po,"Using user provided OfflineComponentProvider");try{await L0(i,i._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(h){return h.name==="FirebaseError"?h.code===Fe.FAILED_PRECONDITION||h.code===Fe.UNIMPLEMENTED:!(typeof DOMException<"u"&&h instanceof DOMException)||h.code===22||h.code===20||h.code===11})(t))throw t;pc("Error using user provided cache. Falling back to memory cache: "+t),await L0(i,new Zd)}}else lt(Po,"Using default OfflineComponentProvider"),await L0(i,new q6(void 0));return i._offlineComponents}async function bE(i){return i._onlineComponents||(i._uninitializedComponentsProvider?(lt(Po,"Using user provided OnlineComponentProvider"),await lv(i,i._uninitializedComponentsProvider._online)):(lt(Po,"Using default OnlineComponentProvider"),await lv(i,new gm))),i._onlineComponents}function X6(i){return bE(i).then((e=>e.syncEngine))}async function EE(i){const e=await bE(i),t=e.eventManager;return t.onListen=k6.bind(null,e.syncEngine),t.onUnlisten=j6.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=M6.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=L6.bind(null,e.syncEngine),t}function K6(i,e,t={}){const a=new Oa;return i.asyncQueue.enqueueAndForget((async()=>(function(f,y,A,C,E){const S=new wE({next:j=>{S.Nu(),y.enqueueAndForget((()=>uE(f,I)));const Y=j.docs.has(A);!Y&&j.fromCache?E.reject(new rt(Fe.UNAVAILABLE,"Failed to get document because the client is offline.")):Y&&j.fromCache&&C&&C.source==="server"?E.reject(new rt(Fe.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):E.resolve(j)},error:j=>E.reject(j)}),I=new hE($m(A.path),S,{includeMetadataChanges:!0,Ka:!0});return cE(f,I)})(await EE(i),i.asyncQueue,e,t,a))),a.promise}function Q6(i,e,t={}){const a=new Oa;return i.asyncQueue.enqueueAndForget((async()=>(function(f,y,A,C,E){const S=new wE({next:j=>{S.Nu(),y.enqueueAndForget((()=>uE(f,I))),j.fromCache&&C.source==="server"?E.reject(new rt(Fe.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):E.resolve(j)},error:j=>E.reject(j)}),I=new hE(A,S,{includeMetadataChanges:!0,Ka:!0});return cE(f,I)})(await EE(i),i.asyncQueue,e,t,a))),a.promise}function Z6(i,e){const t=new Oa;return i.asyncQueue.enqueueAndForget((async()=>P6(await X6(i),e,t))),t.promise}function _E(i){const e={};return i.timeoutSeconds!==void 0&&(e.timeoutSeconds=i.timeoutSeconds),e}const $6="ComponentProvider",cv=new Map;function J6(i,e,t,a,h){return new vN(i,e,t,h.host,h.ssl,h.experimentalForceLongPolling,h.experimentalAutoDetectLongPolling,_E(h.experimentalLongPollingOptions),h.useFetchStreams,h.isUsingEmulator,a)}const AE="firestore.googleapis.com",uv=!0;class hv{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new rt(Fe.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=AE,this.ssl=uv}else this.host=e.host,this.ssl=e.ssl??uv;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=Zb;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<SI)throw new rt(Fe.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}lN("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=_E(e.experimentalLongPollingOptions??{}),(function(a){if(a.timeoutSeconds!==void 0){if(isNaN(a.timeoutSeconds))throw new rt(Fe.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (must not be NaN)`);if(a.timeoutSeconds<5)throw new rt(Fe.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (minimum allowed value is 5)`);if(a.timeoutSeconds>30)throw new rt(Fe.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(a,h){return a.timeoutSeconds===h.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Af{constructor(e,t,a,h){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=a,this._app=h,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new hv({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new rt(Fe.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new rt(Fe.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new hv(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(a){if(!a)return new $4;switch(a.type){case"firstParty":return new nN(a.sessionIndex||"0",a.iamToken||null,a.authTokenFactory||null);case"provider":return a.client;default:throw new rt(Fe.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const a=cv.get(t);a&&(lt($6,"Removing Datastore"),cv.delete(t),a.terminate())})(this),Promise.resolve()}}function e8(i,e,t,a={}){i=jr(i,Af);const h=Cc(e),f=i._getSettings(),y={...f,emulatorOptions:i._getEmulatorOptions()},A=`${e}:${t}`;h&&(dw(`https://${A}`),fw("Firestore",!0)),f.host!==AE&&f.host!==A&&pc("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const C={...f,host:A,ssl:h,emulatorOptions:a};if(!ml(C,y)&&(i._setSettings(C),a.mockUserToken)){let E,S;if(typeof a.mockUserToken=="string")E=a.mockUserToken,S=gi.MOCK_USER;else{E=cT(a.mockUserToken,i._app?.options.projectId);const I=a.mockUserToken.sub||a.mockUserToken.user_id;if(!I)throw new rt(Fe.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");S=new gi(I)}i._authCredentials=new J4(new lb(E,S))}}class _l{constructor(e,t,a){this.converter=t,this._query=a,this.type="query",this.firestore=e}withConverter(e){return new _l(this.firestore,e,this._query)}}class As{constructor(e,t,a){this.converter=t,this._key=a,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Do(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new As(this.firestore,e,this._key)}toJSON(){return{type:As._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,a){if($u(t,As._jsonSchema))return new As(e,a||null,new At(qn.fromString(t.referencePath)))}}As._jsonSchemaVersion="firestore/documentReference/1.0",As._jsonSchema={type:js("string",As._jsonSchemaVersion),referencePath:js("string")};class Do extends _l{constructor(e,t,a){super(e,t,$m(a)),this._path=a,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new As(this.firestore,null,new At(e))}withConverter(e){return new Do(this.firestore,e,this._path)}}function En(i,e,...t){if(i=zs(i),cb("collection","path",e),i instanceof Af){const a=qn.fromString(e,...t);return Ax(a),new Do(i,null,a)}{if(!(i instanceof As||i instanceof Do))throw new rt(Fe.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const a=i._path.child(qn.fromString(e,...t));return Ax(a),new Do(i.firestore,null,a)}}function Ft(i,e,...t){if(i=zs(i),arguments.length===1&&(e=Wm.newId()),cb("doc","path",e),i instanceof Af){const a=qn.fromString(e,...t);return _x(a),new As(i,null,new At(a))}{if(!(i instanceof As||i instanceof Do))throw new rt(Fe.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const a=i._path.child(qn.fromString(e,...t));return _x(a),new As(i.firestore,i instanceof Do?i.converter:null,new At(a))}}const dv="AsyncQueue";class fv{constructor(e=Promise.resolve()){this.Yu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new tE(this,"async_queue_retry"),this._c=()=>{const a=j0();a&&lt(dv,"Visibility state changed to "+a.visibilityState),this.M_.w_()},this.ac=e;const t=j0();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=j0();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new Oa;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Yu.push(e),this.lc())))}async lc(){if(this.Yu.length!==0){try{await this.Yu[0](),this.Yu.shift(),this.M_.reset()}catch(e){if(!Rc(e))throw e;lt(dv,"Operation failed with retryable error: "+e)}this.Yu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((a=>{throw this.nc=a,this.rc=!1,Va("INTERNAL UNHANDLED ERROR: ",mv(a)),a})).then((a=>(this.rc=!1,a))))));return this.ac=t,t}enqueueAfterDelay(e,t,a){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const h=dg.createAndSchedule(this,e,t,a,(f=>this.hc(f)));return this.tc.push(h),h}uc(){this.nc&&Dt(47125,{Pc:mv(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,a)=>t.targetTimeMs-a.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}Rc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function mv(i){let e=i.message||"";return i.stack&&(e=i.stack.includes(i.message)?i.stack:i.message+`
`+i.stack),e}class Al extends Af{constructor(e,t,a,h){super(e,t,a,h),this.type="firestore",this._queue=new fv,this._persistenceKey=h?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new fv(e),this._firestoreClient=void 0,await e}}}function t8(i,e){const t=typeof i=="object"?i:pw(),a=typeof i=="string"?i:Hd,h=Mm(t,"firestore").getImmediate({identifier:a});if(!h._initialized){const f=oT("firestore");f&&e8(h,...f)}return h}function yg(i){if(i._terminated)throw new rt(Fe.FAILED_PRECONDITION,"The client has already been terminated.");return i._firestoreClient||n8(i),i._firestoreClient}function n8(i){const e=i._freezeSettings(),t=J6(i._databaseId,i._app?.options.appId||"",i._persistenceKey,i._app?.options.apiKey,e);i._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(i._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),i._firestoreClient=new W6(i._authCredentials,i._appCheckCredentials,i._queue,t,i._componentsProvider&&(function(h){const f=h?._online.build();return{_offline:h?._offline.build(f),_online:f}})(i._componentsProvider))}class xr{constructor(e){this._byteString=e}static fromBase64String(e){try{return new xr(ri.fromBase64String(e))}catch(t){throw new rt(Fe.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new xr(ri.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:xr._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if($u(e,xr._jsonSchema))return xr.fromBase64String(e.bytes)}}xr._jsonSchemaVersion="firestore/bytes/1.0",xr._jsonSchema={type:js("string",xr._jsonSchemaVersion),bytes:js("string")};class xg{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new rt(Fe.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ii(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class vg{constructor(e){this._methodName=e}}class $r{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new rt(Fe.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new rt(Fe.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return hn(this._lat,e._lat)||hn(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:$r._jsonSchemaVersion}}static fromJSON(e){if($u(e,$r._jsonSchema))return new $r(e.latitude,e.longitude)}}$r._jsonSchemaVersion="firestore/geoPoint/1.0",$r._jsonSchema={type:js("string",$r._jsonSchemaVersion),latitude:js("number"),longitude:js("number")};class Dr{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(a,h){if(a.length!==h.length)return!1;for(let f=0;f<a.length;++f)if(a[f]!==h[f])return!1;return!0})(this._values,e._values)}toJSON(){return{type:Dr._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if($u(e,Dr._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new Dr(e.vectorValues);throw new rt(Fe.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Dr._jsonSchemaVersion="firestore/vectorValue/1.0",Dr._jsonSchema={type:js("string",Dr._jsonSchemaVersion),vectorValues:js("object")};const s8=/^__.*__$/;class i8{constructor(e,t,a){this.data=e,this.fieldMask=t,this.fieldTransforms=a}toMutation(e,t){return this.fieldMask!==null?new Uo(e,this.data,this.fieldMask,t,this.fieldTransforms):new Ju(e,this.data,t,this.fieldTransforms)}}class CE{constructor(e,t,a){this.data=e,this.fieldMask=t,this.fieldTransforms=a}toMutation(e,t){return new Uo(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function TE(i){switch(i){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Dt(40011,{dataSource:i})}}class wg{constructor(e,t,a,h,f,y){this.settings=e,this.databaseId=t,this.serializer=a,this.ignoreUndefinedProperties=h,f===void 0&&this.validatePath(),this.fieldTransforms=f||[],this.fieldMask=y||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(e){return new wg({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(e){const t=this.path?.child(e),a=this.contextWith({path:t,arrayElement:!1});return a.validatePathSegment(e),a}childContextForFieldPath(e){const t=this.path?.child(e),a=this.contextWith({path:t,arrayElement:!1});return a.validatePath(),a}childContextForArray(e){return this.contextWith({path:void 0,arrayElement:!0})}createError(e){return $d(e,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}validatePath(){if(this.path)for(let e=0;e<this.path.length;e++)this.validatePathSegment(this.path.get(e))}validatePathSegment(e){if(e.length===0)throw this.createError("Document fields must not be empty");if(TE(this.dataSource)&&s8.test(e))throw this.createError('Document fields cannot begin and end with "__"')}}class r8{constructor(e,t,a){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=a||bf(e)}createContext(e,t,a,h=!1){return new wg({dataSource:e,methodName:t,targetDoc:a,path:ii.emptyPath(),arrayElement:!1,hasConverter:h},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Cf(i){const e=i._freezeSettings(),t=bf(i._databaseId);return new r8(i._databaseId,!!e.ignoreUndefinedProperties,t)}function SE(i,e,t,a,h,f={}){const y=i.createContext(f.merge||f.mergeFields?2:0,e,t,h);bg("Data must be an object, but it was:",y,a);const A=NE(a,y);let C,E;if(f.merge)C=new er(y.fieldMask),E=y.fieldTransforms;else if(f.mergeFields){const S=[];for(const I of f.mergeFields){const j=wl(e,I,t);if(!y.contains(j))throw new rt(Fe.INVALID_ARGUMENT,`Field '${j}' is specified in your field mask but missing from your input data.`);DE(S,j)||S.push(j)}C=new er(S),E=y.fieldTransforms.filter((I=>C.covers(I.field)))}else C=null,E=y.fieldTransforms;return new i8(new Bi(A),C,E)}class Tf extends vg{_toFieldTransform(e){if(e.dataSource!==2)throw e.dataSource===1?e.createError(`${this._methodName}() can only appear at the top level of your update data`):e.createError(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Tf}}function a8(i,e,t,a){const h=i.createContext(1,e,t);bg("Data must be an object, but it was:",h,a);const f=[],y=Bi.empty();Fo(a,((C,E)=>{const S=RE(e,C,t);E=zs(E);const I=h.childContextForFieldPath(S);if(E instanceof Tf)f.push(S);else{const j=sh(E,I);j!=null&&(f.push(S),y.set(S,j))}}));const A=new er(f);return new CE(y,A,h.fieldTransforms)}function o8(i,e,t,a,h,f){const y=i.createContext(1,e,t),A=[wl(e,a,t)],C=[h];if(f.length%2!=0)throw new rt(Fe.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let j=0;j<f.length;j+=2)A.push(wl(e,f[j])),C.push(f[j+1]);const E=[],S=Bi.empty();for(let j=A.length-1;j>=0;--j)if(!DE(E,A[j])){const Y=A[j];let X=C[j];X=zs(X);const G=y.childContextForFieldPath(Y);if(X instanceof Tf)E.push(Y);else{const J=sh(X,G);J!=null&&(E.push(Y),S.set(Y,J))}}const I=new er(E);return new CE(S,I,y.fieldTransforms)}function l8(i,e,t,a=!1){return sh(t,i.createContext(a?4:3,e))}function sh(i,e){if(IE(i=zs(i)))return bg("Unsupported field value:",e,i),NE(i,e);if(i instanceof vg)return(function(a,h){if(!TE(h.dataSource))throw h.createError(`${a._methodName}() can only be used with update() and set()`);if(!h.path)throw h.createError(`${a._methodName}() is not currently supported inside arrays`);const f=a._toFieldTransform(h);f&&h.fieldTransforms.push(f)})(i,e),null;if(i===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),i instanceof Array){if(e.settings.arrayElement&&e.dataSource!==4)throw e.createError("Nested arrays are not supported");return(function(a,h){const f=[];let y=0;for(const A of a){let C=sh(A,h.childContextForArray(y));C==null&&(C={nullValue:"NULL_VALUE"}),f.push(C),y++}return{arrayValue:{values:f}}})(i,e)}return(function(a,h){if((a=zs(a))===null)return{nullValue:"NULL_VALUE"};if(typeof a=="number")return qN(h.serializer,a);if(typeof a=="boolean")return{booleanValue:a};if(typeof a=="string")return{stringValue:a};if(a instanceof Date){const f=vt.fromDate(a);return{timestampValue:Xd(h.serializer,f)}}if(a instanceof vt){const f=new vt(a.seconds,1e3*Math.floor(a.nanoseconds/1e3));return{timestampValue:Xd(h.serializer,f)}}if(a instanceof $r)return{geoPointValue:{latitude:a.latitude,longitude:a.longitude}};if(a instanceof xr)return{bytesValue:Hb(h.serializer,a._byteString)};if(a instanceof As){const f=h.databaseId,y=a.firestore._databaseId;if(!y.isEqual(f))throw h.createError(`Document reference is for database ${y.projectId}/${y.database} but should be for database ${f.projectId}/${f.database}`);return{referenceValue:sg(a.firestore._databaseId||h.databaseId,a._key.path)}}if(a instanceof Dr)return(function(y,A){const C=y instanceof Dr?y.toArray():y;return{mapValue:{fields:{[xb]:{stringValue:vb},[Gd]:{arrayValue:{values:C.map((S=>{if(typeof S!="number")throw A.createError("VectorValues must only contain numeric values.");return Jm(A.serializer,S)}))}}}}}})(a,h);if(Qb(a))return a._toProto(h.serializer);throw h.createError(`Unsupported field value: ${df(a)}`)})(i,e)}function NE(i,e){const t={};return db(i)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Fo(i,((a,h)=>{const f=sh(h,e.childContextForField(a));f!=null&&(t[a]=f)})),{mapValue:{fields:t}}}function IE(i){return!(typeof i!="object"||i===null||i instanceof Array||i instanceof Date||i instanceof vt||i instanceof $r||i instanceof xr||i instanceof As||i instanceof vg||i instanceof Dr||Qb(i))}function bg(i,e,t){if(!IE(t)||!ub(t)){const a=df(t);throw a==="an object"?e.createError(i+" a custom object"):e.createError(i+" "+a)}}function wl(i,e,t){if((e=zs(e))instanceof xg)return e._internalPath;if(typeof e=="string")return RE(i,e);throw $d("Field path arguments must be of type string or ",i,!1,void 0,t)}const c8=new RegExp("[~\\*/\\[\\]]");function RE(i,e,t){if(e.search(c8)>=0)throw $d(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,i,!1,void 0,t);try{return new xg(...e.split("."))._internalPath}catch{throw $d(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,i,!1,void 0,t)}}function $d(i,e,t,a,h){const f=a&&!a.isEmpty(),y=h!==void 0;let A=`Function ${e}() called with invalid data`;t&&(A+=" (via `toFirestore()`)"),A+=". ";let C="";return(f||y)&&(C+=" (found",f&&(C+=` in field ${a}`),y&&(C+=` in document ${h}`),C+=")"),new rt(Fe.INVALID_ARGUMENT,A+i+C)}function DE(i,e){return i.some((t=>t.isEqual(e)))}class u8{convertValue(e,t="none"){switch(jo(e)){case 0:return null;case 1:return e.booleanValue;case 2:return _s(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Oo(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Dt(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const a={};return Fo(e,((h,f)=>{a[h]=this.convertValue(f,t)})),a}convertVectorValue(e){const t=e.fields?.[Gd].arrayValue?.values?.map((a=>_s(a.doubleValue)));return new Dr(t)}convertGeoPoint(e){return new $r(_s(e.latitude),_s(e.longitude))}convertArray(e,t){return(e.values||[]).map((a=>this.convertValue(a,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const a=gf(e);return a==null?null:this.convertValue(a,t);case"estimate":return this.convertTimestamp(Pu(e));default:return null}}convertTimestamp(e){const t=Mo(e);return new vt(t.seconds,t.nanos)}convertDocumentKey(e,t){const a=qn.fromString(e);kn(Kb(a),9688,{name:e});const h=new Bu(a.get(1),a.get(3)),f=new At(a.popFirst(5));return h.isEqual(t)||Va(`Document ${f} contains a document reference within a different database (${h.projectId}/${h.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),f}}class kE extends u8{constructor(e){super(),this.firestore=e}convertBytes(e){return new xr(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new As(this.firestore,null,t)}}const gv="@firebase/firestore",pv="4.10.0";class ME{constructor(e,t,a,h,f){this._firestore=e,this._userDataWriter=t,this._key=a,this._document=h,this._converter=f}get id(){return this._key.path.lastSegment()}get ref(){return new As(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new h8(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}_fieldsProto(){return this._document?.data.clone().value.mapValue.fields??void 0}get(e){if(this._document){const t=this._document.data.field(wl("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class h8 extends ME{data(){return super.data()}}function d8(i){if(i.limitType==="L"&&i.explicitOrderBy.length===0)throw new rt(Fe.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Eg{}class OE extends Eg{}function kr(i,e,...t){let a=[];e instanceof Eg&&a.push(e),a=a.concat(t),(function(f){const y=f.filter((C=>C instanceof _g)).length,A=f.filter((C=>C instanceof Sf)).length;if(y>1||y>0&&A>0)throw new rt(Fe.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(a);for(const h of a)i=h._apply(i);return i}class Sf extends OE{constructor(e,t,a){super(),this._field=e,this._op=t,this._value=a,this.type="where"}static _create(e,t,a){return new Sf(e,t,a)}_apply(e){const t=this._parse(e);return jE(e._query,t),new _l(e.firestore,e.converter,rm(e._query,t))}_parse(e){const t=Cf(e.firestore);return(function(f,y,A,C,E,S,I){let j;if(E.isKeyField()){if(S==="array-contains"||S==="array-contains-any")throw new rt(Fe.INVALID_ARGUMENT,`Invalid Query. You can't perform '${S}' queries on documentId().`);if(S==="in"||S==="not-in"){xv(I,S);const X=[];for(const G of I)X.push(yv(C,f,G));j={arrayValue:{values:X}}}else j=yv(C,f,I)}else S!=="in"&&S!=="not-in"&&S!=="array-contains-any"||xv(I,S),j=l8(A,y,I,S==="in"||S==="not-in");return Os.create(E,S,j)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function vr(i,e,t){const a=e,h=wl("where",i);return Sf._create(h,a,t)}class _g extends Eg{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new _g(e,t)}_parse(e){const t=this._queryConstraints.map((a=>a._parse(e))).filter((a=>a.getFilters().length>0));return t.length===1?t[0]:Lr.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(h,f){let y=h;const A=f.getFlattenedFilters();for(const C of A)jE(y,C),y=rm(y,C)})(e._query,t),new _l(e.firestore,e.converter,rm(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Ag extends OE{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new Ag(e,t)}_apply(e){const t=(function(h,f,y){if(h.startAt!==null)throw new rt(Fe.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(h.endAt!==null)throw new rt(Fe.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Fu(f,y)})(e._query,this._field,this._direction);return new _l(e.firestore,e.converter,PN(e._query,t))}}function f8(i,e="asc"){const t=e,a=wl("orderBy",i);return Ag._create(a,t)}function yv(i,e,t){if(typeof(t=zs(t))=="string"){if(t==="")throw new rt(Fe.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Sb(e)&&t.indexOf("/")!==-1)throw new rt(Fe.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const a=e.path.child(qn.fromString(t));if(!At.isDocumentKey(a))throw new rt(Fe.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${a}' is not because it has an odd number of segments (${a.length}).`);return kx(i,new At(a))}if(t instanceof As)return kx(i,t._key);throw new rt(Fe.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${df(t)}.`)}function xv(i,e){if(!Array.isArray(i)||i.length===0)throw new rt(Fe.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function jE(i,e){const t=(function(h,f){for(const y of h)for(const A of y.getFlattenedFilters())if(f.indexOf(A.op)>=0)return A.op;return null})(i.filters,(function(h){switch(h){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new rt(Fe.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new rt(Fe.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}function LE(i,e,t){let a;return a=i?t&&(t.merge||t.mergeFields)?i.toFirestore(e,t):i.toFirestore(e):e,a}class Au{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class fl extends ME{constructor(e,t,a,h,f,y){super(e,t,a,h,y),this._firestore=e,this._firestoreImpl=e,this.metadata=f}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Id(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const a=this._document.data.field(wl("DocumentSnapshot.get",e));if(a!==null)return this._userDataWriter.convertValue(a,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new rt(Fe.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=fl._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}fl._jsonSchemaVersion="firestore/documentSnapshot/1.0",fl._jsonSchema={type:js("string",fl._jsonSchemaVersion),bundleSource:js("string","DocumentSnapshot"),bundleName:js("string"),bundle:js("string")};class Id extends fl{data(e={}){return super.data(e)}}class mc{constructor(e,t,a,h){this._firestore=e,this._userDataWriter=t,this._snapshot=h,this.metadata=new Au(h.hasPendingWrites,h.fromCache),this.query=a}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((a=>{e.call(t,new Id(this._firestore,this._userDataWriter,a.key,a,new Au(this._snapshot.mutatedKeys.has(a.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new rt(Fe.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(h,f){if(h._snapshot.oldDocs.isEmpty()){let y=0;return h._snapshot.docChanges.map((A=>{const C=new Id(h._firestore,h._userDataWriter,A.doc.key,A.doc,new Au(h._snapshot.mutatedKeys.has(A.doc.key),h._snapshot.fromCache),h.query.converter);return A.doc,{type:"added",doc:C,oldIndex:-1,newIndex:y++}}))}{let y=h._snapshot.oldDocs;return h._snapshot.docChanges.filter((A=>f||A.type!==3)).map((A=>{const C=new Id(h._firestore,h._userDataWriter,A.doc.key,A.doc,new Au(h._snapshot.mutatedKeys.has(A.doc.key),h._snapshot.fromCache),h.query.converter);let E=-1,S=-1;return A.type!==0&&(E=y.indexOf(A.doc.key),y=y.delete(A.doc.key)),A.type!==1&&(y=y.add(A.doc),S=y.indexOf(A.doc.key)),{type:m8(A.type),doc:C,oldIndex:E,newIndex:S}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new rt(Fe.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=mc._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Wm.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],a=[],h=[];return this.docs.forEach((f=>{f._document!==null&&(t.push(f._document),a.push(this._userDataWriter.convertObjectMap(f._document.data.value.mapValue.fields,"previous")),h.push(f.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function m8(i){switch(i){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Dt(61501,{type:i})}}mc._jsonSchemaVersion="firestore/querySnapshot/1.0",mc._jsonSchema={type:js("string",mc._jsonSchemaVersion),bundleSource:js("string","QuerySnapshot"),bundleName:js("string"),bundle:js("string")};function Bo(i){i=jr(i,As);const e=jr(i.firestore,Al),t=yg(e);return K6(t,i._key).then((a=>g8(e,i,a)))}function Hn(i){i=jr(i,_l);const e=jr(i.firestore,Al),t=yg(e),a=new kE(e);return d8(i._query),Q6(t,i._query).then((h=>new mc(e,a,i,h)))}function Ia(i,e,t){i=jr(i,As);const a=jr(i.firestore,Al),h=LE(i.converter,e,t),f=Cf(a);return Nf(a,[SE(f,"setDoc",i._key,h,i.converter!==null,t).toMutation(i._key,wr.none())])}function Ms(i,e,t,...a){i=jr(i,As);const h=jr(i.firestore,Al),f=Cf(h);let y;return y=typeof(e=zs(e))=="string"||e instanceof xg?o8(f,"updateDoc",i._key,e,t,a):a8(f,"updateDoc",i._key,e),Nf(h,[y.toMutation(i._key,wr.exists(!0))])}function ja(i){return Nf(jr(i.firestore,Al),[new eg(i._key,wr.none())])}function oc(i,e){const t=jr(i.firestore,Al),a=Ft(i),h=LE(i.converter,e),f=Cf(i.firestore);return Nf(t,[SE(f,"addDoc",a._key,h,i.converter!==null,{}).toMutation(a._key,wr.exists(!1))]).then((()=>a))}function Nf(i,e){const t=yg(i);return Z6(t,e)}function g8(i,e,t){const a=t.docs.get(e._key),h=new kE(i);return new fl(i,h,e._key,a,new Au(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){Z4(Tc),gc(new gl("firestore",((a,{instanceIdentifier:h,options:f})=>{const y=a.getProvider("app").getImmediate(),A=new Al(new eN(a.getProvider("auth-internal")),new sN(y,a.getProvider("app-check-internal")),wN(y,h),y);return f={useFetchStreams:t,...f},A._setSettings(f),A}),"PUBLIC").setMultipleInstances(!0)),Io(gv,pv,e),Io(gv,pv,"esm2020")})();var p8="firebase",y8="12.8.0";Io(p8,y8,"app");const PE={apiKey:"AIzaSyBCIgMJd3By7qkWH27YiW9VooIBGE3bFLs",authDomain:"mind-core-fitness-client.firebaseapp.com",projectId:"mind-core-fitness-client",storageBucket:"mind-core-fitness-client.firebasestorage.app",messagingSenderId:"669343392406",appId:"1:669343392406:web:f5a35ee062387e7d6f58b7"},BE=Om(PE),yu=eb(BE),nt=t8(BE),x8=Om(PE,"secondary"),Jd=eb(x8),v8="EYdciKDOi3UYBLk1u8hHams5tmO2",VE=H.createContext();function Vi(){return H.useContext(VE)}function w8({children:i}){const[e,t]=H.useState(null),[a,h]=H.useState(!1),[f,y]=H.useState(!1),[A,C]=H.useState(null),[E,S]=H.useState(!0);H.useEffect(()=>F3(yu,async J=>{if(t(J),J)if(J.uid===v8)h(!0),y(!1),C(null);else{h(!1);try{const ae=kr(En(nt,"clients"),vr("uid","==",J.uid)),ne=await Hn(ae);if(ne.empty)y(!1),C(null);else{const ue=ne.docs[0];y(!0),C({id:ue.id,...ue.data()})}}catch(ae){console.error("Error fetching client data:",ae),y(!1),C(null)}}else h(!1),y(!1),C(null);S(!1)}),[]);const X={currentUser:e,isAdmin:a,isClient:f,clientData:A,login:async(G,J,ae=!0)=>(await P3(yu,ae?Ww:zm),await L3(yu,G,J)),logout:()=>Um(yu),resetPassword:G=>j3(yu,G),loading:E};return u.jsx(VE.Provider,{value:X,children:i})}const FE=H.createContext();function Cl(){return H.useContext(FE)}function b8({children:i}){const[e,t]=H.useState(()=>{const f=localStorage.getItem("theme");return f?f==="dark":window.matchMedia("(prefers-color-scheme: dark)").matches});H.useEffect(()=>{document.documentElement.setAttribute("data-theme",e?"dark":"light"),localStorage.setItem("theme",e?"dark":"light")},[e]);const h={isDark:e,toggleTheme:()=>t(!e)};return u.jsx(FE.Provider,{value:h,children:i})}function E8(){const[i,e]=H.useState(""),[t,a]=H.useState(""),[h,f]=H.useState(!0),[y,A]=H.useState(""),[C,E]=H.useState(!1),[S,I]=H.useState(!1),[j,Y]=H.useState(!1),{login:X,resetPassword:G,currentUser:J,isAdmin:ae,isClient:ne,clientData:ue,loading:be}=Vi(),Me=ai();if(H.useEffect(()=>{if(!be&&J){if(ae)Me("/dashboard");else if(ne){const F=ue?.clientType;Me(F==="core_buddy"?"/client/core-buddy":F==="circuit_vip"||F==="circuit_dropin"?"/client/circuit":"/client")}}},[be,J,ae,ne,ue,Me]),be)return u.jsx("div",{className:"login-container",children:u.jsx("div",{className:"login-loading",children:u.jsx("img",{src:"/Logo.PNG",alt:"Mind Core Fitness",className:"loading-logo"})})});const Ce=async F=>{F.preventDefault(),A(""),E(!0);try{await X(i,t,h)}catch(B){A(B.message||"Failed to log in"),E(!1)}},P=async F=>{if(F.preventDefault(),A(""),!i.trim()){A("Please enter your email address");return}E(!0);try{await G(i.trim()),Y(!0)}catch(B){B.code==="auth/user-not-found"?A("No account found with this email"):A(B.message||"Failed to send reset email")}E(!1)};return u.jsx("div",{className:"login-container",children:u.jsxs("div",{className:"login-card",children:[u.jsxs("div",{className:"login-header",children:[u.jsx("img",{src:"/Logo.PNG",alt:"Mind Core Fitness",className:"login-logo"}),u.jsx("p",{children:S?"Reset Password":"Client Portal"})]}),y&&u.jsx("div",{className:"error-message",children:y}),j?u.jsxs("div",{className:"reset-sent",children:[u.jsx("div",{className:"reset-sent-icon",children:u.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[u.jsx("path",{d:"M22 2L11 13",strokeLinecap:"round",strokeLinejoin:"round"}),u.jsx("path",{d:"M22 2L15 22L11 13L2 9L22 2Z",strokeLinecap:"round",strokeLinejoin:"round"})]})}),u.jsx("p",{children:"Reset email sent!"}),u.jsx("span",{children:"Check your inbox for a password reset link"}),u.jsx("button",{className:"login-btn",style:{marginTop:"20px"},onClick:()=>{I(!1),Y(!1),A("")},children:"Back to Log In"})]}):S?u.jsxs("form",{onSubmit:P,children:[u.jsxs("div",{className:"form-group",children:[u.jsx("label",{htmlFor:"email",children:"Email"}),u.jsx("input",{type:"email",id:"email",value:i,onChange:F=>e(F.target.value),placeholder:"Enter your email",required:!0})]}),u.jsx("button",{type:"submit",className:"login-btn",disabled:C,children:C?"Sending...":"Send Reset Link"}),u.jsx("button",{type:"button",className:"forgot-link",onClick:()=>{I(!1),A("")},children:"Back to Log In"})]}):u.jsxs(u.Fragment,{children:[u.jsxs("form",{onSubmit:Ce,children:[u.jsxs("div",{className:"form-group",children:[u.jsx("label",{htmlFor:"email",children:"Email"}),u.jsx("input",{type:"email",id:"email",value:i,onChange:F=>e(F.target.value),required:!0})]}),u.jsxs("div",{className:"form-group",children:[u.jsx("label",{htmlFor:"password",children:"Password"}),u.jsx("input",{type:"password",id:"password",value:t,onChange:F=>a(F.target.value),required:!0})]}),u.jsx("div",{className:"remember-me",children:u.jsxs("label",{children:[u.jsx("input",{type:"checkbox",checked:h,onChange:F=>f(F.target.checked)}),u.jsx("span",{children:"Remember me"})]})}),u.jsx("button",{type:"submit",className:"login-btn",disabled:C,children:C?"Logging in...":"Log In"})]}),u.jsx("button",{type:"button",className:"forgot-link",onClick:()=>{I(!0),A("")},children:"Forgot password?"})]}),u.jsx("a",{href:"/",className:"back-link",children:"Back to website"})]})})}function _8(){const[i,e]=H.useState([]),[t,a]=H.useState([]),[h,f]=H.useState(!0),[y,A]=H.useState(null),[C,E]=H.useState({}),[S,I]=H.useState(null),[j,Y]=H.useState(""),[X,G]=H.useState("all");H.useEffect(()=>{J()},[]);const J=async()=>{try{const[L,oe]=await Promise.all([Hn(kr(En(nt,"clients"),f8("createdAt","desc"))),Hn(En(nt,"sessions"))]),ce=L.docs.map(ee=>({id:ee.id,...ee.data()})),pe=oe.docs.map(ee=>({id:ee.id,...ee.data()}));e(ce),a(pe)}catch(L){console.error("Error fetching data:",L)}f(!1)},ae=L=>{const oe=new Date,ce=oe.getFullYear(),pe=(oe.getMonth()+1).toString().padStart(2,"0"),ee=oe.getDate().toString().padStart(2,"0"),ie=`${ce}-${pe}-${ee}`,Te=`${oe.getHours().toString().padStart(2,"0")}:${oe.getMinutes().toString().padStart(2,"0")}`;return t.filter(Pe=>Pe.clientId!==L?!1:Pe.date<ie||Pe.date===ie&&Pe.time<Te).length},ne=L=>{const oe=ae(L.id);return(L.totalSessions||0)-oe},ue=L=>{const oe=new Date,ce=oe.getFullYear(),pe=(oe.getMonth()+1).toString().padStart(2,"0"),ee=oe.getDate().toString().padStart(2,"0"),ie=`${ce}-${pe}-${ee}`,Te=`${oe.getHours().toString().padStart(2,"0")}:${oe.getMinutes().toString().padStart(2,"0")}`;return t.filter(Pe=>Pe.clientId!==L?!1:Pe.date>ie||Pe.date===ie&&Pe.time>=Te).length},be=L=>L?(L.toDate?L.toDate():new Date(L)).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"}):"-",Me=async(L,oe)=>{if(window.confirm(`Are you sure you want to delete ${oe}? This will also delete all their booked sessions.`))try{const pe=t.filter(ee=>ee.clientId===L).map(ee=>ja(Ft(nt,"sessions",ee.id)));await Promise.all(pe),await ja(Ft(nt,"clients",L)),e(i.filter(ee=>ee.id!==L)),a(t.filter(ee=>ee.clientId!==L))}catch(ce){console.error("Error deleting client:",ce),alert("Failed to delete client")}},Ce=L=>{if(!L)return"";const oe=L.toDate?L.toDate():new Date(L),ce=oe.getFullYear(),pe=(oe.getMonth()+1).toString().padStart(2,"0"),ee=oe.getDate().toString().padStart(2,"0");return`${ce}-${pe}-${ee}`},P=L=>{A(L.id),E({name:L.name,email:L.email,password:"",clientType:L.clientType||"block",weeksInBlock:L.weeksInBlock||"",totalSessions:L.totalSessions||"",sessionsRemaining:L.sessionsRemaining,sessionDuration:L.sessionDuration||45,startDate:Ce(L.startDate),endDate:Ce(L.endDate),status:L.status,hasPortalAccess:!!L.uid,circuitAccess:!!L.circuitAccess,coreBuddyAccess:!!L.coreBuddyAccess})},F=L=>{const{name:oe,value:ce}=L.target;if(E(pe=>({...pe,[oe]:ce})),oe==="startDate"||oe==="weeksInBlock"){const pe=oe==="startDate"?ce:C.startDate,ee=parseInt(oe==="weeksInBlock"?ce:C.weeksInBlock);if(pe&&ee>0){const ie=new Date(pe),Te=new Date(ie);Te.setDate(Te.getDate()+ee*7);const Pe=Te.getFullYear(),it=(Te.getMonth()+1).toString().padStart(2,"0"),dt=Te.getDate().toString().padStart(2,"0");E(Le=>({...Le,[oe]:ce,endDate:`${Pe}-${it}-${dt}`}))}}},B=async L=>{try{const oe=i.find(ie=>ie.id===L);let ce=oe?.uid;if(C.password&&C.password.length>=6&&!oe?.uid)try{const ie=await Hw(Jd,C.email.trim().toLowerCase(),C.password);await Um(Jd),ce=ie.user.uid}catch(ie){if(console.error("Error creating auth account:",ie),ie.code==="auth/email-already-in-use")alert("This email already has a portal account. Password not changed.");else if(ie.code==="auth/weak-password"){alert("Password must be at least 6 characters.");return}else{alert("Failed to create portal account: "+ie.message);return}}const pe=C.clientType==="block",ee={name:C.name.trim(),email:C.email.trim().toLowerCase(),clientType:C.clientType,status:C.status,coreBuddyAccess:C.coreBuddyAccess};if(pe)ee.weeksInBlock=parseInt(C.weeksInBlock)||0,ee.totalSessions=parseInt(C.totalSessions)||0,ee.sessionDuration=parseInt(C.sessionDuration),ee.circuitAccess=C.circuitAccess,C.startDate&&(ee.startDate=vt.fromDate(new Date(C.startDate))),C.endDate&&(ee.endDate=vt.fromDate(new Date(C.endDate)));else{const ie=i.find(Te=>Te.id===L);ie?.circuitStrikes===void 0&&(ee.circuitStrikes=0),ie?.circuitBanUntil===void 0&&(ee.circuitBanUntil=null)}ce&&!oe?.uid&&(ee.uid=ce),await Ms(Ft(nt,"clients",L),ee),e(i.map(ie=>ie.id===L?{...ie,...C,uid:ce||ie.uid,weeksInBlock:parseInt(C.weeksInBlock),totalSessions:parseInt(C.totalSessions),sessionDuration:parseInt(C.sessionDuration),startDate:vt.fromDate(new Date(C.startDate)),endDate:vt.fromDate(new Date(C.endDate))}:ie)),A(null),ce&&!oe?.uid&&alert("Portal access created! Client can now log in.")}catch(oe){console.error("Error updating client:",oe),alert("Failed to update client")}},se=async L=>{try{const oe=i.find(ce=>ce.id===L)?.status==="archived"?"active":"archived";await Ms(Ft(nt,"clients",L),{status:oe}),e(i.map(ce=>ce.id===L?{...ce,status:oe}:ce))}catch(oe){console.error("Error archiving client:",oe),alert("Failed to update client status")}};if(h)return u.jsx("div",{className:"client-list-loading",children:"Loading clients..."});if(i.length===0)return u.jsxs("div",{className:"client-list-empty",children:[u.jsx("p",{children:"No clients yet"}),u.jsx("span",{children:"Add your first client to get started"})]});const Z=L=>L.clientType==="circuit_vip"?"VIP":L.clientType==="circuit_dropin"?"Drop-in":L.clientType==="core_buddy"?"Core Buddy":"Block",Q=i.filter(L=>L.name?.toLowerCase().includes(j.toLowerCase())||L.email?.toLowerCase().includes(j.toLowerCase())),z=L=>L.clientType==="circuit_vip"||L.clientType==="circuit_dropin",Ye=L=>L.clientType==="core_buddy",me=Q.filter(L=>!z(L)&&!Ye(L)),te=Q.filter(L=>z(L)),ge=Q.filter(L=>Ye(L)),He=X==="block"?me:X==="circuit"?te:X==="core_buddy"?ge:Q,Ne=L=>{y||I(oe=>oe===L?null:L)},tt=L=>{const oe=S===L.id,ce=y===L.id,pe=!L.clientType||L.clientType==="block";return u.jsxs("div",{className:`client-card ${L.status==="archived"?"archived":""} ${oe||ce?"expanded":"collapsed"}`,children:[u.jsxs("div",{className:"client-name-row",onClick:()=>Ne(L.id),children:[u.jsxs("div",{className:"client-name-row-left",children:[u.jsx("span",{className:"client-name-initial",children:L.name?.charAt(0)?.toUpperCase()}),u.jsxs("div",{className:"client-name-text",children:[u.jsx("h3",{children:L.name}),u.jsx("span",{className:"client-name-sub",children:pe?`${ne(L)}/${L.totalSessions||0} sessions`:Z(L)})]})]}),u.jsxs("div",{className:"client-name-row-right",children:[(L.clientType==="circuit_vip"||L.clientType==="circuit_dropin"||L.clientType==="core_buddy")&&u.jsx("span",{className:`client-type-badge ${L.clientType==="circuit_vip"?"vip":L.clientType==="core_buddy"?"core-buddy":"dropin"}`,children:Z(L)}),u.jsx("span",{className:`status-dot ${L.status}`}),u.jsx("svg",{className:`client-chevron ${oe||ce?"open":""}`,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:u.jsx("path",{d:"M6 9l6 6 6-6"})})]})]}),(oe||ce)&&u.jsx("div",{className:"client-expand-panel",children:ce?u.jsxs("div",{className:"edit-form",children:[u.jsx("div",{className:"edit-type-toggle",children:[{value:"block",label:"Block"},{value:"circuit_vip",label:"VIP"},{value:"circuit_dropin",label:"Drop-in"},{value:"core_buddy",label:"Core Buddy"}].map(ee=>u.jsx("button",{type:"button",className:`edit-type-btn ${C.clientType===ee.value?"active":""}`,onClick:()=>E(ie=>({...ie,clientType:ee.value})),children:ee.label},ee.value))}),u.jsxs("div",{className:"edit-row",children:[u.jsx("input",{type:"text",name:"name",value:C.name,onChange:F,placeholder:"Name"}),u.jsx("input",{type:"email",name:"email",value:C.email,onChange:F,placeholder:"Email"})]}),C.clientType==="block"&&u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"edit-row",children:[u.jsx("input",{type:"number",name:"weeksInBlock",value:C.weeksInBlock,onChange:F,placeholder:"Weeks",min:"1"}),u.jsx("input",{type:"number",name:"totalSessions",value:C.totalSessions,onChange:F,placeholder:"Total Sessions",min:"1"}),u.jsxs("select",{name:"sessionDuration",value:C.sessionDuration,onChange:F,children:[u.jsx("option",{value:"30",children:"30 min"}),u.jsx("option",{value:"45",children:"45 min"})]})]}),u.jsxs("div",{className:"edit-row",children:[u.jsx("input",{type:"date",name:"startDate",value:C.startDate,onChange:F}),u.jsx("input",{type:"date",name:"endDate",value:C.endDate,onChange:F})]})]}),u.jsx("div",{className:"edit-row password-row",children:C.hasPortalAccess?u.jsx("div",{className:"portal-status has-access",children:"Has portal access"}):u.jsxs(u.Fragment,{children:[u.jsx("input",{type:"text",name:"password",value:C.password,onChange:F,placeholder:"Set portal password (min 6 chars)"}),u.jsx("span",{className:"password-hint",children:"Set password to enable client portal"})]})}),C.clientType==="block"&&u.jsx("div",{className:"edit-row circuit-row",children:u.jsxs("label",{className:"circuit-access-toggle",children:[u.jsx("input",{type:"checkbox",checked:C.circuitAccess,onChange:ee=>E(ie=>({...ie,circuitAccess:ee.target.checked}))}),u.jsx("span",{children:"Circuit Class Access"})]})}),C.clientType!=="core_buddy"&&u.jsx("div",{className:"edit-row circuit-row",children:u.jsxs("label",{className:"circuit-access-toggle",children:[u.jsx("input",{type:"checkbox",checked:C.coreBuddyAccess,onChange:ee=>E(ie=>({...ie,coreBuddyAccess:ee.target.checked}))}),u.jsx("span",{children:"Core Buddy Access"})]})}),u.jsxs("div",{className:"edit-actions",children:[u.jsx("button",{className:"save-edit-btn",onClick:()=>B(L.id),children:"Save"}),u.jsx("button",{className:"cancel-edit-btn",onClick:()=>{A(null)},children:"Cancel"})]})]}):u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"client-expand-info",children:[u.jsx("span",{className:"client-email",children:L.email}),u.jsx("span",{className:`status-badge ${L.status}`,children:L.status})]}),pe?u.jsxs("div",{className:"client-details",children:[u.jsxs("div",{className:"detail-item",children:[u.jsx("span",{className:"detail-label",children:"Block"}),u.jsxs("span",{className:"detail-value",children:[L.weeksInBlock," weeks"]})]}),u.jsxs("div",{className:"detail-item",children:[u.jsx("span",{className:"detail-label",children:"Sessions"}),u.jsxs("span",{className:"detail-value",children:[ne(L)," / ",L.totalSessions," remaining"]})]}),u.jsxs("div",{className:"detail-item",children:[u.jsx("span",{className:"detail-label",children:"Booked"}),u.jsxs("span",{className:"detail-value",children:[ue(L.id)," sessions"]})]}),u.jsxs("div",{className:"detail-item",children:[u.jsx("span",{className:"detail-label",children:"Duration"}),u.jsxs("span",{className:"detail-value",children:[L.sessionDuration||45," min"]})]}),u.jsxs("div",{className:"detail-item",children:[u.jsx("span",{className:"detail-label",children:"Start"}),u.jsx("span",{className:"detail-value",children:be(L.startDate)})]}),u.jsxs("div",{className:"detail-item",children:[u.jsx("span",{className:"detail-label",children:"End"}),u.jsx("span",{className:"detail-value",children:be(L.endDate)})]})]}):u.jsxs("div",{className:"client-details circuit-details",children:[u.jsxs("div",{className:"detail-item",children:[u.jsx("span",{className:"detail-label",children:"Type"}),u.jsx("span",{className:"detail-value",children:L.clientType==="circuit_vip"?"Monthly VIP":"Drop-in"})]}),u.jsxs("div",{className:"detail-item",children:[u.jsx("span",{className:"detail-label",children:"Strikes"}),u.jsxs("span",{className:"detail-value",children:[L.circuitStrikes||0,"/3"]})]}),u.jsxs("div",{className:"detail-item",children:[u.jsx("span",{className:"detail-label",children:"Joined"}),u.jsx("span",{className:"detail-value",children:be(L.createdAt)})]})]}),u.jsxs("div",{className:"client-actions",children:[u.jsx("button",{className:"action-btn edit",onClick:ee=>{ee.stopPropagation(),P(L)},children:"Edit"}),u.jsx("button",{className:"action-btn archive",onClick:ee=>{ee.stopPropagation(),se(L.id)},children:L.status==="archived"?"Reactivate":"Archive"}),u.jsx("button",{className:"action-btn delete",onClick:ee=>{ee.stopPropagation(),Me(L.id,L.name)},children:"Delete"})]})]})})]},L.id)};return u.jsxs("div",{className:"client-list",children:[u.jsxs("div",{className:"client-search",children:[u.jsxs("svg",{className:"client-search-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[u.jsx("circle",{cx:"11",cy:"11",r:"8"}),u.jsx("path",{d:"M21 21l-4.35-4.35"})]}),u.jsx("input",{type:"text",placeholder:"Search clients...",value:j,onChange:L=>Y(L.target.value),className:"client-search-input"}),j&&u.jsx("button",{className:"client-search-clear",onClick:()=>Y(""),children:u.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:u.jsx("path",{d:"M18 6L6 18M6 6l12 12"})})})]}),u.jsx("div",{className:"client-type-filter",children:[{value:"all",label:"All",count:Q.length},{value:"block",label:"Block",count:me.length},{value:"circuit",label:"Circuit",count:te.length},{value:"core_buddy",label:"Core Buddy",count:ge.length}].map(L=>u.jsxs("button",{className:`client-filter-btn ${X===L.value?"active":""}`,onClick:()=>G(L.value),children:[L.label,u.jsx("span",{className:"client-filter-count",children:L.count})]},L.value))}),X==="all"?u.jsxs(u.Fragment,{children:[me.length>0&&u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"client-section-header",children:["Block Members ",u.jsx("span",{children:me.length})]}),me.map(tt)]}),te.length>0&&u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"client-section-header",children:["Circuit Members ",u.jsx("span",{children:te.length})]}),te.map(tt)]})]}):u.jsxs(u.Fragment,{children:[He.length===0&&u.jsxs("div",{className:"client-section-empty",children:["No ",X," clients found"]}),He.map(tt)]})]})}const UE={monday:{morning:{start:"06:15",end:"12:00"},afternoon:{start:"15:00",end:"20:00"}},tuesday:{morning:{start:"06:15",end:"12:00"},afternoon:{start:"15:00",end:"20:00"}},wednesday:{morning:{start:"06:15",end:"12:00"},afternoon:{start:"15:00",end:"20:00"}},thursday:{morning:{start:"06:15",end:"12:00"},afternoon:{start:"15:00",end:"20:00"}},friday:{morning:{start:"08:00",end:"10:00"},afternoon:null}},pm=["monday","tuesday","wednesday","thursday","friday"],A8=["Monday","Tuesday","Wednesday","Thursday","Friday"],C8=["Mon","Tue","Wed","Thu","Fri"],vv=i=>{const[e,t]=i.split(":"),a=parseInt(e),h=a>=12?"pm":"am";return`${a>12?a-12:a===0?12:a}:${t}${h}`},T8=i=>{const e=new Date(i),t=e.getDay(),a=e.getDate()-t+(t===0?-6:1);return e.setDate(a),pm.map((h,f)=>{const y=new Date(e);return y.setDate(e.getDate()+f),y})},$i=i=>{const e=i.getFullYear(),t=(i.getMonth()+1).toString().padStart(2,"0"),a=i.getDate().toString().padStart(2,"0");return`${e}-${t}-${a}`},ym=i=>{const[e,t]=i.split(":").map(Number);return e*60+t},ef=(i,e)=>{const t=ym(i)+e,a=Math.floor(t/60),h=t%60;return`${a.toString().padStart(2,"0")}:${h.toString().padStart(2,"0")}`},S8=i=>{const e=UE[i];if(!e)return[];const t=[];if(e.morning){let a=e.morning.start;for(;a<e.morning.end;)t.push({time:a,period:"morning"}),a=ef(a,15)}if(e.afternoon){let a=e.afternoon.start;for(;a<e.afternoon.end;)t.push({time:a,period:"afternoon"}),a=ef(a,15)}return t};function N8(){const[i,e]=H.useState(new Date),[t,a]=H.useState([]),[h,f]=H.useState([]),[y,A]=H.useState([]),[C,E]=H.useState([]),[S,I]=H.useState([]),[j,Y]=H.useState(null),[X,G]=H.useState(null),[J,ae]=H.useState(!1),[ne,ue]=H.useState(!0);H.useEffect(()=>{a(T8(i))},[i]),H.useEffect(()=>{F()},[]);const be=ce=>{if(Y(ce),ae(!1),ce.startDate){const pe=ce.startDate.toDate?ce.startDate.toDate():new Date(ce.startDate);e(pe)}G(null)},Me=ce=>{const pe=new Date,ee=$i(pe),ie=`${pe.getHours().toString().padStart(2,"0")}:${pe.getMinutes().toString().padStart(2,"0")}`;return y.filter(Te=>Te.clientId!==ce?!1:Te.date<ee||Te.date===ee&&Te.time<ie).length},Ce=ce=>{const pe=Me(ce.id);return(ce.totalSessions||0)-pe},P=ce=>{const pe=new Date,ee=pe.getFullYear(),ie=(pe.getMonth()+1).toString().padStart(2,"0"),Te=pe.getDate().toString().padStart(2,"0"),Pe=`${ee}-${ie}-${Te}`,it=`${pe.getHours().toString().padStart(2,"0")}:${pe.getMinutes().toString().padStart(2,"0")}`;return y.filter(dt=>dt.clientId!==ce?!1:dt.date>Pe||dt.date===Pe&&dt.time>=it).length},F=async()=>{try{const pe=(await Hn(En(nt,"clients"))).docs.map(Le=>({id:Le.id,...Le.data()})).filter(Le=>Le.status==="active");f(pe);const ie=(await Hn(En(nt,"sessions"))).docs.map(Le=>({id:Le.id,...Le.data()}));A(ie);const Pe=(await Hn(En(nt,"holidays"))).docs.map(Le=>({id:Le.id,...Le.data()}));E(Pe);const dt=(await Hn(En(nt,"blockedTimes"))).docs.map(Le=>({id:Le.id,...Le.data()}));I(dt)}catch(ce){console.error("Error fetching data:",ce)}ue(!1)},B=ce=>{const pe=new Date(i);pe.setDate(pe.getDate()+ce*7),e(pe),G(null)},se=()=>{e(new Date),G(null)},Z=ce=>{const pe=$i(ce);return C.some(ee=>ee.date===pe)},Q=(ce,pe)=>{const ee=$i(ce);return S.some(ie=>ie.date===ee&&ie.time===pe)},z=async(ce,pe)=>{const ee=$i(ce),ie=S.find(Te=>Te.date===ee&&Te.time===pe);try{if(ie)await ja(Ft(nt,"blockedTimes",ie.id)),I(S.filter(Te=>Te.id!==ie.id));else{const Te=await oc(En(nt,"blockedTimes"),{date:ee,time:pe,createdAt:vt.now()});I([...S,{id:Te.id,date:ee,time:pe}])}}catch(Te){console.error("Error toggling blocked time:",Te),alert("Failed to update time slot")}},Ye=ce=>{const pe=$i(ce);return y.filter(ee=>ee.date===pe)},me=(ce,pe)=>{const ee=$i(ce);return y.find(ie=>ie.date===ee&&ie.time===pe)},te=(ce,pe,ee)=>{const ie=pm[ce.getDay()-1];if(!ie||Z(ce))return!1;const Te=Math.ceil(ee/15);for(let Pt=0;Pt<Te;Pt++){const st=ef(pe,Pt*15);if(Q(ce,st))return!1}const Pe=$i(ce);if(y.find(Pt=>Pt.date===Pe&&Pt.time===pe))return!1;const dt=ef(pe,ee),Le=UE[ie],qt=Le.morning&&dt<=Le.morning.end,wt=Le.afternoon&&dt<=Le.afternoon.end,Zt=Le.morning&&pe>=Le.morning.start&&pe<Le.morning.end,zt=Le.afternoon&&pe>=Le.afternoon.start&&pe<Le.afternoon.end;if(Zt&&!qt||zt&&!wt)return!1;for(const Pt of y){if(Pt.date!==Pe)continue;const st=ym(Pt.time),mt=st+(Pt.duration||45),at=ym(pe),kt=at+ee;if(at<mt&&kt>st)return!1}return!0},ge=async(ce,pe)=>{const ee=me(ce,pe);if(ee){if(window.confirm(`Cancel ${ee.clientName}'s session at ${vv(pe)}?`))try{await ja(Ft(nt,"sessions",ee.id)),A(y.filter(Te=>Te.id!==ee.id))}catch(Te){console.error("Error cancelling session:",Te),alert("Failed to cancel session")}return}if(!j){alert("Please select a client first");return}if(!te(ce,pe,j.sessionDuration||45)){alert("This slot is not available for this client's session duration");return}if(y.filter(Te=>Te.clientId===j.id).length>=j.totalSessions){alert(`${j.name} has already booked all ${j.totalSessions} sessions`);return}try{const Te=$i(ce),Pe={clientId:j.id,clientName:j.name,date:Te,time:pe,duration:j.sessionDuration||45,createdAt:vt.now()},it=await oc(En(nt,"sessions"),Pe);A([...y,{id:it.id,...Pe}])}catch(Te){console.error("Error booking session:",Te),alert("Failed to book session")}},He=async()=>{if(!j)return;const ce=j.startDate?.toDate?j.startDate.toDate():new Date(j.startDate),pe=j.endDate?.toDate?j.endDate.toDate():new Date(j.endDate),ee=y.filter(Le=>Le.clientId!==j.id?!1:t.some(qt=>$i(qt)===Le.date));if(ee.length===0){alert("No sessions in current week to repeat. Book some sessions first, then use this button.");return}const ie=j.weeksInBlock||Math.ceil((pe-ce)/(10080*60*1e3)),Te=ee.map(Le=>({dayOfWeek:new Date(Le.date).getDay(),time:Le.time}));let Pe=[];const it=y.filter(Le=>Le.clientId===j.id).length;for(let Le=0;Le<ie;Le++){const qt=new Date(ce);qt.setDate(qt.getDate()+Le*7);const wt=new Date(qt),Zt=wt.getDay(),zt=wt.getDate()-Zt+(Zt===0?-6:1);wt.setDate(zt);for(const Pt of Te){const st=new Date(wt),mt=Pt.dayOfWeek===0?6:Pt.dayOfWeek-1;st.setDate(wt.getDate()+mt);const at=$i(st);y.some(kt=>kt.clientId===j.id&&kt.date===at&&kt.time===Pt.time)||st<ce||st>pe||C.some(kt=>kt.date===at)||Pe.push({dateKey:at,time:Pt.time,sessionDate:st})}}const dt=it+Pe.length;if(dt>j.totalSessions){alert(`This would create ${Pe.length} new sessions (${dt} total), but client only has ${j.totalSessions} sessions in their package.

You can still book ${j.totalSessions-it} more sessions.`);return}if(Pe.length===0){alert("All weeks already have sessions booked for this pattern.");return}if(window.confirm(`This will create ${Pe.length} new sessions across the block.

(${it} existing + ${Pe.length} new = ${dt} total)

Continue?`))try{const Le=[];for(const qt of Pe){const wt={clientId:j.id,clientName:j.name,date:qt.dateKey,time:qt.time,duration:j.sessionDuration||45,createdAt:vt.now()},Zt=await oc(En(nt,"sessions"),wt);Le.push({id:Zt.id,...wt})}A([...y,...Le]),alert(`Created ${Le.length} new sessions!`)}catch(Le){console.error("Error repeating weekly:",Le),alert("Failed to repeat sessions")}},Ne=async ce=>{const pe=$i(ce),ee=C.find(ie=>ie.date===pe);try{if(ee)await ja(Ft(nt,"holidays",ee.id)),E(C.filter(ie=>ie.id!==ee.id));else{const ie=await oc(En(nt,"holidays"),{date:pe,createdAt:vt.now()});E([...C,{id:ie.id,date:pe}])}}catch(ie){console.error("Error toggling day availability:",ie),alert("Failed to update day availability")}};if(ne)return u.jsx("div",{className:"calendar-loading",children:"Loading calendar..."});const tt=t[0],L=t[4],oe=tt&&L?`${tt.toLocaleDateString("en-GB",{day:"numeric",month:"short"})} - ${L.toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"})}`:"";return u.jsxs("div",{className:"calendar",children:[u.jsxs("div",{className:"calendar-header",children:[u.jsxs("div",{className:"calendar-nav",children:[u.jsx("button",{onClick:()=>B(-1),children:""}),u.jsx("button",{onClick:se,children:"Today"}),u.jsx("button",{onClick:()=>B(1),children:""})]}),u.jsx("h3",{children:oe})]}),u.jsxs("div",{className:"client-selector",children:[u.jsx("span",{className:"selector-label",children:"Booking for:"}),j?u.jsxs("div",{className:"selected-client",children:[u.jsxs("div",{className:"selected-info",children:[u.jsx("strong",{children:j.name}),u.jsxs("span",{children:[j.sessionDuration||45,"min  ",Ce(j),"/",j.totalSessions," remaining"]}),u.jsxs("span",{className:"booked-info",children:[P(j.id)," booked"]})]}),u.jsx("button",{onClick:()=>Y(null),children:"Change"})]}):u.jsx("button",{className:"select-client-btn",onClick:()=>ae(!0),children:"Select Client"})]}),j&&u.jsxs("div",{className:"repeat-weekly-section",children:[u.jsx("button",{className:"repeat-weekly-btn",onClick:He,children:"Repeat This Week's Schedule For All Weeks"}),u.jsx("span",{className:"repeat-hint",children:"Copies current week's sessions to all weeks in block"})]}),u.jsx("div",{className:"day-cards",children:t.map((ce,pe)=>{const ee=Ye(ce),ie=$i(ce)===$i(new Date),Te=Z(ce);return u.jsxs("div",{className:`day-card ${X===pe?"selected":""} ${ie?"today":""} ${Te?"holiday":""}`,onClick:()=>G(X===pe?null:pe),children:[u.jsxs("div",{className:"day-card-header",children:[u.jsx("span",{className:"day-name",children:C8[pe]}),u.jsx("span",{className:"day-date",children:ce.getDate()})]}),Te?u.jsx("div",{className:"day-card-status holiday",children:"Unavailable"}):u.jsxs("div",{className:"day-card-status",children:[ee.length," session",ee.length!==1?"s":""]})]},pe)})}),X!==null&&t[X]&&u.jsxs("div",{className:"time-panel",children:[u.jsxs("div",{className:"time-panel-header",children:[u.jsxs("h4",{children:[A8[X]," ",t[X].getDate()]}),u.jsx("button",{className:"close-panel",onClick:()=>G(null),children:""})]}),u.jsx("div",{className:"availability-toggle",children:u.jsx("button",{className:`toggle-availability-btn ${Z(t[X])?"unavailable":"available"}`,onClick:()=>Ne(t[X]),children:Z(t[X])?"Mark Day Available":"Mark Day Unavailable"})}),Z(t[X])?u.jsxs("div",{className:"day-unavailable-message",children:[u.jsx("p",{children:"This day is marked as unavailable"}),u.jsx("span",{children:"Tap the button above to make it available again"})]}):u.jsx("div",{className:"time-slots",children:S8(pm[X]).map(({time:ce,period:pe},ee,ie)=>{const Te=me(t[X],ce),Pe=Q(t[X],ce),it=j&&te(t[X],ce,j.sessionDuration||45),dt=ee===0||ie[ee-1]?.period!==pe;return u.jsxs("div",{children:[dt&&u.jsx("div",{className:"period-label",children:pe==="morning"?"Morning":"Afternoon"}),u.jsxs("div",{className:"time-slot-row",children:[u.jsxs("button",{className:`time-slot ${Te?"booked":""} ${Pe?"blocked":""} ${it?"available":""} ${!Te&&!Pe&&!it&&j?"unavailable":""}`,onClick:()=>!Pe&&ge(t[X],ce),disabled:Pe,children:[u.jsx("span",{className:"slot-time",children:vv(ce)}),Te?u.jsxs("span",{className:"slot-client",children:[Te.clientName," (",Te.duration,"m)"]}):Pe?u.jsx("span",{className:"slot-blocked",children:"Blocked"}):it?u.jsx("span",{className:"slot-available",children:"Available"}):j?u.jsx("span",{className:"slot-unavailable",children:"Unavailable"}):u.jsx("span",{className:"slot-empty",children:"Select client to book"})]}),u.jsx("button",{className:`block-toggle-btn ${Pe?"is-blocked":""}`,onClick:()=>z(t[X],ce),disabled:!!Te,title:Pe?"Unblock this time":"Block this time",children:Pe?"":""})]})]},ce)})})]}),J&&u.jsx("div",{className:"modal-overlay",onClick:()=>ae(!1),children:u.jsxs("div",{className:"modal-content",onClick:ce=>ce.stopPropagation(),children:[u.jsxs("div",{className:"modal-header",children:[u.jsx("h3",{children:"Select Client"}),u.jsx("button",{className:"close-btn",onClick:()=>ae(!1),children:""})]}),u.jsx("div",{className:"client-list-picker",children:h.length===0?u.jsx("p",{className:"no-items",children:"No active clients"}):h.map(ce=>{const pe=ce.startDate?.toDate?ce.startDate.toDate():new Date(ce.startDate),ee=ce.endDate?.toDate?ce.endDate.toDate():new Date(ce.endDate),ie=Ce(ce),Te=P(ce.id);return u.jsxs("button",{className:"client-option",onClick:()=>be(ce),children:[u.jsx("strong",{children:ce.name}),u.jsxs("span",{children:[ce.sessionDuration||45,"min  ",ie,"/",ce.totalSessions," remaining  ",Te," booked"]}),u.jsxs("span",{className:"client-dates",children:[pe.toLocaleDateString("en-GB",{day:"numeric",month:"short"})," - ",ee.toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"})]})]},ce.id)})})]})})]})}const wv=i=>{const[e,t]=i.split(":"),a=parseInt(e),h=a>=12?"pm":"am";return`${a>12?a-12:a===0?12:a}:${t}${h}`},Hu=i=>{const e=i.getFullYear(),t=(i.getMonth()+1).toString().padStart(2,"0"),a=i.getDate().toString().padStart(2,"0");return`${e}-${t}-${a}`},zE=i=>i===Hu(new Date),I8=i=>{const e=new Date;return e.setDate(e.getDate()+1),i===Hu(e)},bv=i=>zE(i)?"Today":I8(i)?"Tomorrow":new Date(i).toLocaleDateString("en-GB",{weekday:"long",day:"numeric",month:"short"}),Ev=i=>{const e=new Date,t=Hu(e),a=`${e.getHours().toString().padStart(2,"0")}:${e.getMinutes().toString().padStart(2,"0")}`;if(i.date<t)return!0;if(i.date===t){const h=_v(i.time)+(i.duration||45);return _v(a)>=h}return!1},_v=i=>{const[e,t]=i.split(":").map(Number);return e*60+t};function R8(){const[i,e]=H.useState([]),[t,a]=H.useState(!0),[h,f]=H.useState(new Date);H.useEffect(()=>{y();const X=setInterval(()=>{f(new Date)},6e4);return()=>clearInterval(X)},[]);const y=async()=>{try{const G=(await Hn(En(nt,"sessions"))).docs.map(ne=>({id:ne.id,...ne.data()})),J=Hu(new Date),ae=G.filter(ne=>ne.date>=J).sort((ne,ue)=>ne.date!==ue.date?ne.date.localeCompare(ue.date):ne.time.localeCompare(ue.time));e(ae)}catch(X){console.error("Error fetching sessions:",X)}a(!1)},A=async X=>{if(window.confirm(`Cancel ${X.clientName}'s session at ${wv(X.time)} on ${bv(X.date)}?`))try{await ja(Ft(nt,"sessions",X.id)),e(i.filter(G=>G.id!==X.id))}catch(G){console.error("Error cancelling session:",G),alert("Failed to cancel session")}};if(t)return u.jsx("div",{className:"schedule-loading",children:"Loading schedule..."});const C=i.reduce((X,G)=>{const J=G.date;return X[J]||(X[J]=[]),X[J].push(G),X},{}),E=Object.keys(C).sort(),S=Hu(new Date),I=C[S]||[],j=I.filter(X=>Ev(X)).length,Y=I.length-j;return u.jsxs("div",{className:"schedule",children:[u.jsxs("div",{className:"today-summary",children:[u.jsx("h3",{children:"Today's Sessions"}),u.jsx("div",{className:"today-count",children:I.length===0?u.jsx("span",{className:"no-sessions",children:"No sessions today"}):u.jsxs("div",{className:"today-stats",children:[u.jsxs("span",{className:"completed-count",children:[j," completed"]}),u.jsxs("span",{className:"remaining-count",children:[Y," remaining"]})]})})]}),E.length===0?u.jsx("div",{className:"no-upcoming",children:u.jsx("p",{children:"No upcoming sessions booked"})}):u.jsx("div",{className:"sessions-list",children:E.map(X=>u.jsxs("div",{className:`date-group ${zE(X)?"today":""}`,children:[u.jsxs("div",{className:"date-header",children:[u.jsx("span",{className:"date-label",children:bv(X)}),u.jsxs("span",{className:"date-count",children:[C[X].length," session",C[X].length!==1?"s":""]})]}),u.jsx("div",{className:"date-sessions",children:C[X].map(G=>{const J=Ev(G);return u.jsxs("div",{className:`session-card ${J?"completed":""}`,children:[u.jsx("div",{className:"session-time",children:wv(G.time)}),u.jsxs("div",{className:"session-details",children:[u.jsx("strong",{children:G.clientName}),u.jsxs("span",{children:[G.duration,"min session"]})]}),J?u.jsx("div",{className:"completed-badge",children:""}):u.jsx("button",{className:"cancel-session-btn",onClick:()=>A(G),children:"Cancel"})]},G.id)})})]},X))})]})}const HE={monday:{morning:{start:"06:15",end:"12:00"},afternoon:{start:"15:00",end:"20:00"}},tuesday:{morning:{start:"06:15",end:"12:00"},afternoon:{start:"15:00",end:"20:00"}},wednesday:{morning:{start:"06:15",end:"12:00"},afternoon:{start:"15:00",end:"20:00"}},thursday:{morning:{start:"06:15",end:"12:00"},afternoon:{start:"15:00",end:"20:00"}},friday:{morning:{start:"08:00",end:"10:00"},afternoon:null}},xm=["monday","tuesday","wednesday","thursday","friday"],D8=["Monday","Tuesday","Wednesday","Thursday","Friday"],k8=i=>{const[e,t]=i.split(":"),a=parseInt(e),h=a>=12?"pm":"am";return`${a>12?a-12:a===0?12:a}:${t}${h}`},xu=i=>{const e=i.getFullYear(),t=(i.getMonth()+1).toString().padStart(2,"0"),a=i.getDate().toString().padStart(2,"0");return`${e}-${t}-${a}`},M8=i=>{const e=new Date(i),t=e.getDay(),a=e.getDate()-t+(t===0?-6:1);return e.setDate(a),xm.map((h,f)=>{const y=new Date(e);return y.setDate(e.getDate()+f),y})},vm=i=>{const[e,t]=i.split(":").map(Number);return e*60+t},wm=(i,e)=>{const t=vm(i)+e,a=Math.floor(t/60),h=t%60;return`${a.toString().padStart(2,"0")}:${h.toString().padStart(2,"0")}`},O8=i=>{const e=HE[i];if(!e)return[];const t=[];if(e.morning){let a=e.morning.start;for(;a<e.morning.end;)t.push({time:a,period:"morning"}),a=wm(a,15)}if(e.afternoon){let a=e.afternoon.start;for(;a<e.afternoon.end;)t.push({time:a,period:"afternoon"}),a=wm(a,15)}return t};function j8(){const[i,e]=H.useState(new Date),[t,a]=H.useState([]),[h,f]=H.useState([]),[y,A]=H.useState([]),[C,E]=H.useState(!0),[S,I]=H.useState(45);H.useEffect(()=>{a(M8(i))},[i]),H.useEffect(()=>{j()},[]);const j=async()=>{try{const Ce=(await Hn(En(nt,"sessions"))).docs.map(B=>({id:B.id,...B.data()}));f(Ce);const F=(await Hn(En(nt,"holidays"))).docs.map(B=>({id:B.id,...B.data()}));A(F)}catch(Me){console.error("Error fetching data:",Me)}E(!1)},Y=Me=>{const Ce=new Date(i);Ce.setDate(Ce.getDate()+Me*7),e(Ce)},X=()=>{e(new Date)},G=Me=>{const Ce=xu(Me);return y.some(P=>P.date===Ce)},J=(Me,Ce)=>{const P=xm[Me.getDay()-1];if(!P||G(Me))return!1;const F=xu(Me),B=new Date,se=xu(B);if(F<se)return!1;if(F===se){const ge=`${B.getHours().toString().padStart(2,"0")}:${B.getMinutes().toString().padStart(2,"0")}`;if(Ce<ge)return!1}const Z=wm(Ce,S),Q=HE[P],z=Q.morning&&Ce>=Q.morning.start&&Ce<Q.morning.end,Ye=Q.afternoon&&Ce>=Q.afternoon.start&&Ce<Q.afternoon.end,me=Q.morning&&Z<=Q.morning.end,te=Q.afternoon&&Z<=Q.afternoon.end;if(z&&!me||Ye&&!te)return!1;for(const ge of h){if(ge.date!==F)continue;const He=vm(ge.time),Ne=He+(ge.duration||45),tt=vm(Ce),L=tt+S;if(tt<Ne&&L>He)return!1}return!0},ae=(Me,Ce)=>{const P=xm[Ce];return O8(P).filter(B=>J(Me,B.time))};if(C)return u.jsx("div",{className:"availability-loading",children:"Loading availability..."});const ne=t[0],ue=t[4],be=ne&&ue?`${ne.toLocaleDateString("en-GB",{day:"numeric",month:"short"})} - ${ue.toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"})}`:"";return u.jsxs("div",{className:"availability",children:[u.jsxs("div",{className:"availability-header",children:[u.jsxs("div",{className:"availability-nav",children:[u.jsx("button",{onClick:()=>Y(-1),children:""}),u.jsx("button",{onClick:X,children:"Today"}),u.jsx("button",{onClick:()=>Y(1),children:""})]}),u.jsx("h3",{children:be}),u.jsxs("div",{className:"duration-selector",children:[u.jsx("label",{children:"Session:"}),u.jsxs("select",{value:S,onChange:Me=>I(Number(Me.target.value)),children:[u.jsx("option",{value:30,children:"30 min"}),u.jsx("option",{value:45,children:"45 min"}),u.jsx("option",{value:60,children:"60 min"})]})]})]}),u.jsx("div",{className:"availability-grid",children:t.map((Me,Ce)=>{const P=G(Me),F=P?[]:ae(Me,Ce),B=xu(Me)===xu(new Date),se=Me<new Date&&!B;return u.jsxs("div",{className:`day-column ${B?"today":""} ${se?"past":""}`,children:[u.jsxs("div",{className:"day-header",children:[u.jsx("span",{className:"day-name",children:D8[Ce]}),u.jsxs("span",{className:"day-date",children:[Me.getDate(),"/",Me.getMonth()+1]}),P&&u.jsx("span",{className:"holiday-badge",children:"Holiday"})]}),u.jsx("div",{className:"slots-container",children:P?u.jsx("div",{className:"no-slots",children:"Unavailable"}):F.length===0?u.jsx("div",{className:"no-slots",children:"Fully booked"}):u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"slots-count",children:[F.length," slots"]}),u.jsx("div",{className:"slots-list",children:F.map(Z=>u.jsx("div",{className:`slot ${Z.period}`,children:k8(Z.time)},Z.time))})]})})]},Ce)})})]})}const P0=i=>`${i.getFullYear()}-${String(i.getMonth()+1).padStart(2,"0")}-${String(i.getDate()).padStart(2,"0")}`,Av=i=>new Date(i+"T09:00:00").toLocaleDateString("en-GB",{weekday:"short",day:"numeric",month:"short",year:"numeric"}),Cv=()=>{const i=new Date;let t=(6-i.getDay()+7)%7;if(t===0){const h=new Date(i);h.setHours(9,45,0,0),i>h&&(t=7)}const a=new Date(i);return a.setDate(i.getDate()+t),a},Rd=i=>i==="circuit_vip"?"VIP":i==="circuit_dropin"?"Drop-in":"Block",Dd=i=>i==="circuit_vip"?"vip":i==="circuit_dropin"?"dropin":"block";function L8(){const[i,e]=H.useState(!0),[t,a]=H.useState([]),[h,f]=H.useState([]),[y,A]=H.useState(null),[C,E]=H.useState("upcoming"),[S,I]=H.useState(!1),[j,Y]=H.useState(null),[X,G]=H.useState(!1),[J,ae]=H.useState(!1),ne=H.useCallback((ee,ie="info")=>{Y({message:ee,type:ie}),setTimeout(()=>Y(null),4e3)},[]);H.useEffect(()=>{ue()},[]);const ue=async()=>{try{const ie=(await Hn(En(nt,"circuitSessions"))).docs.map(Le=>({id:Le.id,...Le.data()}));ie.sort((Le,qt)=>qt.date.localeCompare(Le.date)),a(ie);const Pe=(await Hn(En(nt,"clients"))).docs.map(Le=>({id:Le.id,...Le.data()})).filter(Le=>Le.clientType==="circuit_vip"||Le.clientType==="circuit_dropin"||Le.circuitAccess===!0);f(Pe);const it=P0(Cv()),dt=ie.find(Le=>Le.date===it);dt?A(dt):ie.length>0&&A(ie[0])}catch(ee){console.error("Error loading circuit data:",ee),ne("Failed to load circuit data","error")}e(!1)},be=async ee=>{if(!(!y||S)&&window.confirm("Remove this member from the slot?")){I(!0);try{const ie=[...y.slots],Te=ie.findIndex(dt=>dt.slotNumber===ee);if(Te===-1){I(!1);return}let Pe=[...y.waitlist||[]];if(Pe.length>0){const dt=Pe.shift();ie[Te]={slotNumber:ee,memberId:dt.memberId,memberName:dt.memberName,memberType:dt.memberType,status:"confirmed",bookedAt:vt.now()},ne(`Slot given to ${dt.memberName} from waitlist`,"success")}else ie[Te]={slotNumber:ee,memberId:null,memberName:null,memberType:null,status:"available"},ne("Member removed from slot","success");await Ms(Ft(nt,"circuitSessions",y.id),{slots:ie,waitlist:Pe});const it={...y,slots:ie,waitlist:Pe};A(it),a(dt=>dt.map(Le=>Le.id===it.id?it:Le))}catch(ie){console.error("Error removing from slot:",ie),ne("Failed to remove member","error")}I(!1)}},Me=async(ee,ie)=>{if(!(!y||S)){I(!0);try{const Te=[...y.slots],Pe=Te.findIndex(Le=>Le.slotNumber===ee&&Le.status==="available");if(Pe===-1){ne("Slot is not available","error"),I(!1);return}if(Te.some(Le=>Le.memberId===ie.id)){ne(`${ie.name} already has a slot`,"error"),I(!1);return}Te[Pe]={slotNumber:ee,memberId:ie.id,memberName:ie.name,memberType:ie.clientType||"block",status:"confirmed",bookedAt:vt.now()};const it=(y.waitlist||[]).filter(Le=>Le.memberId!==ie.id);await Ms(Ft(nt,"circuitSessions",y.id),{slots:Te,waitlist:it});const dt={...y,slots:Te,waitlist:it};A(dt),a(Le=>Le.map(qt=>qt.id===dt.id?dt:qt)),ne(`${ie.name} added to slot ${ee}`,"success")}catch(Te){console.error("Error adding to slot:",Te),ne("Failed to add member","error")}I(!1)}},Ce=async ee=>{if(!(!y||S)){I(!0);try{const ie=(y.waitlist||[]).filter(Pe=>Pe.memberId!==ee);await Ms(Ft(nt,"circuitSessions",y.id),{waitlist:ie});const Te={...y,waitlist:ie};A(Te),a(Pe=>Pe.map(it=>it.id===Te.id?Te:it)),ne("Removed from waitlist","success")}catch(ie){console.error("Error removing from waitlist:",ie),ne("Failed to remove from waitlist","error")}I(!1)}},P=async(ee,ie)=>{if(!(!y||S)){I(!0);try{const Te=[...y.slots],Pe=Te.findIndex(dt=>dt.slotNumber===ee);if(Pe===-1){I(!1);return}if(Te[Pe]={...Te[Pe],attended:ie},await Ms(Ft(nt,"circuitSessions",y.id),{slots:Te}),ie===!1){const dt=Te[Pe].memberId;if(dt){const Le=Ft(nt,"clients",dt),qt=await Bo(Le);if(qt.exists()){const Zt=(qt.data().circuitStrikes||0)+1,zt={circuitStrikes:Zt};if(Zt>=3){const Pt=new Date;Pt.setMonth(Pt.getMonth()+1),zt.circuitBanUntil=vt.fromDate(Pt),zt.circuitStrikes=0,ne(`${Te[Pe].memberName} banned for 1 month (3 strikes)`,"error")}else ne(`No-show recorded - ${Te[Pe].memberName} (${Zt}/3 strikes)`,"error");await Ms(Le,zt)}}}else ne(`${Te[Pe].memberName} marked as attended`,"success");const it={...y,slots:Te};A(it),a(dt=>dt.map(Le=>Le.id===it.id?it:Le))}catch(Te){console.error("Error marking attendance:",Te),ne("Failed to update attendance","error")}I(!1)}},F=async(ee,ie)=>{if(!S&&window.confirm(`Reset strikes for ${ie}?`)){I(!0);try{await Ms(Ft(nt,"clients",ee),{circuitStrikes:0,circuitBanUntil:null}),f(Te=>Te.map(Pe=>Pe.id===ee?{...Pe,circuitStrikes:0,circuitBanUntil:null}:Pe)),ne(`Strikes reset for ${ie}`,"success")}catch(Te){console.error("Error resetting strikes:",Te),ne("Failed to reset strikes","error")}I(!1)}},B=async(ee,ie)=>{if(!S&&window.confirm(`Lift ban for ${ie}?`)){I(!0);try{await Ms(Ft(nt,"clients",ee),{circuitBanUntil:null,circuitStrikes:0}),f(Te=>Te.map(Pe=>Pe.id===ee?{...Pe,circuitBanUntil:null,circuitStrikes:0}:Pe)),ne(`Ban lifted for ${ie}`,"success")}catch(Te){console.error("Error lifting ban:",Te),ne("Failed to lift ban","error")}I(!1)}};if(i)return u.jsxs("div",{className:"cm-loading",children:[u.jsx("div",{className:"cm-loading-spinner"}),u.jsx("span",{children:"Loading circuit data..."})]});const se=P0(new Date),Z=P0(Cv()),Q=t.filter(ee=>ee.date>=se),z=t.filter(ee=>ee.date<se),Ye=C==="upcoming"?Q:z,me=y?y.slots.filter(ee=>ee.status!=="available").length:0,te=y?y.slots.filter(ee=>ee.status==="available").length:0,ge=y?y.date>=se:!1,He=y?y.slots.filter(ee=>ee.memberId).map(ee=>ee.memberId):[],Ne=y?(y.waitlist||[]).map(ee=>ee.memberId):[],tt=h.filter(ee=>!He.includes(ee.id)&&!Ne.includes(ee.id)),L=h.filter(ee=>ee.clientType==="circuit_vip").length,oe=h.filter(ee=>ee.clientType==="circuit_dropin").length,ce=h.filter(ee=>ee.circuitAccess&&ee.clientType!=="circuit_vip"&&ee.clientType!=="circuit_dropin").length,pe=h.filter(ee=>ee.circuitBanUntil?(ee.circuitBanUntil.toDate?ee.circuitBanUntil.toDate():new Date(ee.circuitBanUntil))>new Date:!1);return u.jsxs("div",{className:"cm-container",children:[u.jsxs("div",{className:"cm-stats-row",children:[u.jsxs("div",{className:"cm-stat-pill",children:[u.jsx("span",{className:"cm-stat-num",children:L}),u.jsx("span",{className:"cm-stat-label",children:"VIP"})]}),u.jsxs("div",{className:"cm-stat-pill",children:[u.jsx("span",{className:"cm-stat-num",children:oe}),u.jsx("span",{className:"cm-stat-label",children:"Drop-in"})]}),u.jsxs("div",{className:"cm-stat-pill",children:[u.jsx("span",{className:"cm-stat-num",children:ce}),u.jsx("span",{className:"cm-stat-label",children:"Block"})]}),u.jsxs("div",{className:"cm-stat-pill",children:[u.jsx("span",{className:"cm-stat-num",children:t.length}),u.jsx("span",{className:"cm-stat-label",children:"Sessions"})]})]}),u.jsxs("div",{className:"cm-view-toggle",children:[u.jsx("button",{className:`cm-toggle-btn ${X?"":"active"}`,onClick:()=>G(!1),children:"Sessions"}),u.jsx("button",{className:`cm-toggle-btn ${X?"active":""}`,onClick:()=>G(!0),children:"Members"})]}),!X&&u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"cm-tabs",children:[u.jsxs("button",{className:`cm-tab ${C==="upcoming"?"active":""}`,onClick:()=>E("upcoming"),children:["Upcoming (",Q.length,")"]}),u.jsxs("button",{className:`cm-tab ${C==="past"?"active":""}`,onClick:()=>E("past"),children:["Past (",z.length,")"]})]}),u.jsx("div",{className:"cm-sessions-list",children:Ye.length===0?u.jsx("div",{className:"cm-empty",children:u.jsxs("p",{children:["No ",C," sessions"]})}):Ye.map(ee=>{const ie=ee.slots.filter(it=>it.status!=="available").length,Te=y?.id===ee.id,Pe=ee.date===Z;return u.jsxs("button",{className:`cm-session-btn ${Te?"selected":""} ${Pe?"next":""}`,onClick:()=>{A(ee),ae(!1)},children:[u.jsxs("div",{className:"cm-session-btn-left",children:[u.jsx("span",{className:"cm-session-date",children:Av(ee.date)}),Pe&&u.jsx("span",{className:"cm-next-badge",children:"Next"})]}),u.jsxs("div",{className:"cm-session-btn-right",children:[u.jsxs("span",{className:"cm-session-fill",children:[ie,"/8"]}),(ee.waitlist?.length||0)>0&&u.jsxs("span",{className:"cm-waitlist-count",children:["+",ee.waitlist.length," wl"]})]})]},ee.id)})}),y&&u.jsxs("div",{className:"cm-detail",children:[u.jsxs("div",{className:"cm-detail-header",children:[u.jsxs("div",{children:[u.jsx("h3",{children:Av(y.date)}),u.jsxs("p",{children:[y.time," - ",y.endTime,"  ",me,"/8 booked  ",te," available"]})]}),!ge&&u.jsx("button",{className:`cm-attendance-btn ${J?"active":""}`,onClick:()=>ae(!J),children:J?"Done":"Attendance"})]}),u.jsx("div",{className:"cm-slots",children:y.slots.map(ee=>{const ie=ee.status==="available";return u.jsxs("div",{className:`cm-slot ${ie?"empty":"filled"} ${ee.attended===!0?"attended":""} ${ee.attended===!1?"no-show":""}`,children:[u.jsx("span",{className:"cm-slot-num",children:ee.slotNumber}),ie?u.jsxs("div",{className:"cm-slot-empty",children:[u.jsx("span",{children:"Available"}),ge&&u.jsx(P8,{members:tt,onSelect:Te=>Me(ee.slotNumber,Te),disabled:S})]}):u.jsxs("div",{className:"cm-slot-filled",children:[u.jsxs("div",{className:"cm-slot-info",children:[u.jsx("span",{className:"cm-slot-name",children:ee.memberName}),u.jsx("span",{className:`cm-type-badge ${Dd(ee.memberType)}`,children:Rd(ee.memberType)})]}),u.jsxs("div",{className:"cm-slot-actions",children:[J&&ee.attended===void 0&&u.jsxs(u.Fragment,{children:[u.jsx("button",{className:"cm-attend-yes",onClick:()=>P(ee.slotNumber,!0),disabled:S,title:"Attended",children:u.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:u.jsx("path",{d:"M5 13l4 4L19 7"})})}),u.jsx("button",{className:"cm-attend-no",onClick:()=>P(ee.slotNumber,!1),disabled:S,title:"No-show",children:u.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:u.jsx("path",{d:"M18 6L6 18M6 6l12 12"})})})]}),ee.attended===!0&&u.jsx("span",{className:"cm-attended-label",children:"Attended"}),ee.attended===!1&&u.jsx("span",{className:"cm-noshow-label",children:"No-show"}),ge&&u.jsx("button",{className:"cm-remove-btn",onClick:()=>be(ee.slotNumber),disabled:S,title:"Remove from slot",children:u.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:u.jsx("path",{d:"M18 6L6 18M6 6l12 12"})})})]})]})]},ee.slotNumber)})}),(y.waitlist?.length||0)>0&&u.jsxs("div",{className:"cm-waitlist",children:[u.jsxs("h4",{children:["Waitlist (",y.waitlist.length,")"]}),y.waitlist.map((ee,ie)=>u.jsxs("div",{className:"cm-waitlist-row",children:[u.jsxs("span",{className:"cm-wl-pos",children:["#",ie+1]}),u.jsx("span",{className:"cm-wl-name",children:ee.memberName}),u.jsx("span",{className:`cm-type-badge ${Dd(ee.memberType)}`,children:Rd(ee.memberType)}),ge&&u.jsx("button",{className:"cm-wl-remove",onClick:()=>Ce(ee.memberId),disabled:S,children:"Remove"})]},ee.memberId))]})]})]}),X&&u.jsxs("div",{className:"cm-members",children:[pe.length>0&&u.jsxs("div",{className:"cm-ban-alert",children:[u.jsxs("h4",{children:["Currently Banned (",pe.length,")"]}),pe.map(ee=>{const ie=ee.circuitBanUntil?.toDate?ee.circuitBanUntil.toDate():new Date(ee.circuitBanUntil);return u.jsxs("div",{className:"cm-ban-row",children:[u.jsxs("div",{className:"cm-ban-info",children:[u.jsx("span",{className:"cm-ban-name",children:ee.name}),u.jsxs("span",{className:"cm-ban-until",children:["Until ",ie.toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"})]})]}),u.jsx("button",{className:"cm-lift-ban-btn",onClick:()=>B(ee.id,ee.name),disabled:S,children:"Lift Ban"})]},ee.id)})]}),u.jsx("div",{className:"cm-members-list",children:h.length===0?u.jsxs("div",{className:"cm-empty",children:[u.jsx("p",{children:"No circuit members yet"}),u.jsx("span",{children:"Add members via the Clients page"})]}):h.map(ee=>{const ie=ee.circuitStrikes||0,Te=pe.some(Pe=>Pe.id===ee.id);return u.jsxs("div",{className:`cm-member-card ${Te?"banned":""}`,children:[u.jsxs("div",{className:"cm-member-top",children:[u.jsx("span",{className:"cm-member-name",children:ee.name}),u.jsx("span",{className:`cm-type-badge ${Dd(ee.clientType)}`,children:Rd(ee.clientType)})]}),u.jsxs("div",{className:"cm-member-bottom",children:[u.jsxs("div",{className:"cm-strikes",children:[[0,1,2].map(Pe=>u.jsx("span",{className:`cm-strike-dot ${Pe<ie?"active":""}`},Pe)),u.jsxs("span",{className:"cm-strike-text",children:[ie,"/3 strikes"]})]}),u.jsxs("div",{className:"cm-member-actions",children:[Te&&u.jsx("button",{className:"cm-small-btn ban",onClick:()=>B(ee.id,ee.name),disabled:S,children:"Lift Ban"}),ie>0&&!Te&&u.jsx("button",{className:"cm-small-btn reset",onClick:()=>F(ee.id,ee.name),disabled:S,children:"Reset"})]})]})]},ee.id)})})]}),j&&u.jsx("div",{className:`cm-toast ${j.type}`,children:u.jsx("span",{children:j.message})})]})}function P8({members:i,onSelect:e,disabled:t}){const[a,h]=H.useState(!1),[f,y]=H.useState(""),A=i.filter(C=>C.name.toLowerCase().includes(f.toLowerCase()));return i.length===0?null:u.jsxs("div",{className:"cm-add-dropdown",children:[u.jsx("button",{className:"cm-add-trigger",onClick:()=>h(!a),disabled:t,children:"+ Add"}),a&&u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"cm-dropdown-backdrop",onClick:()=>{h(!1),y("")}}),u.jsxs("div",{className:"cm-dropdown-menu",children:[i.length>4&&u.jsx("input",{type:"text",className:"cm-dropdown-search",placeholder:"Search...",value:f,onChange:C=>y(C.target.value),autoFocus:!0}),u.jsxs("div",{className:"cm-dropdown-list",children:[A.map(C=>u.jsxs("button",{className:"cm-dropdown-item",onClick:()=>{e(C),h(!1),y("")},children:[u.jsx("span",{children:C.name}),u.jsx("span",{className:`cm-type-badge sm ${Dd(C.clientType)}`,children:Rd(C.clientType)})]},C.id)),A.length===0&&u.jsx("div",{className:"cm-dropdown-empty",children:"No members found"})]})]})]})]})}function B8(){const[i,e]=H.useState(()=>localStorage.getItem("adminActiveView")||"schedule"),t=te=>{e(te),localStorage.setItem("adminActiveView",te)},[a,h]=H.useState(0),[f,y]=H.useState(!1),[A,C]=H.useState([]),[E,S]=H.useState(null),[I,j]=H.useState(null),{currentUser:Y,logout:X,isAdmin:G,loading:J}=Vi(),{isDark:ae,toggleTheme:ne}=Cl(),ue=ai(),be=H.useRef(0),Me=H.useRef(!1);H.useRef(null);const Ce=H.useCallback((te,ge="info")=>{j({message:te,type:ge}),setTimeout(()=>j(null),4e3)},[]);H.useEffect(()=>{!J&&(!Y||!G)&&ue("/")},[Y,G,J,ue]),H.useEffect(()=>{Y&&G&&P()},[Y,G]);const P=async()=>{try{const te=kr(En(nt,"rescheduleRequests"),vr("status","==","pending")),He=(await Hn(te)).docs.map(Ne=>({id:Ne.id,...Ne.data()}));He.sort((Ne,tt)=>{const L=Ne.createdAt?.toDate?Ne.createdAt.toDate():new Date(0);return(tt.createdAt?.toDate?tt.createdAt.toDate():new Date(0))-L}),C(He)}catch(te){console.error("Error fetching reschedule requests:",te)}};H.useEffect(()=>{(async()=>{if(!(!Y||!G))try{const[ge,He]=await Promise.all([Hn(En(nt,"clients")),Hn(En(nt,"sessions"))]),Ne=new Set(ge.docs.map(L=>L.id)),tt=He.docs.filter(L=>!Ne.has(L.data().clientId));if(tt.length>0){console.log(`Cleaning up ${tt.length} orphaned sessions...`);const L=tt.map(oe=>ja(Ft(nt,"sessions",oe.id)));await Promise.all(L),console.log("Orphaned sessions cleaned up successfully")}}catch(ge){console.error("Error cleaning up orphaned sessions:",ge)}})()},[Y,G]),H.useEffect(()=>{const te=()=>window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0,ge=tt=>{te()<=0&&(be.current=tt.touches[0].clientY,Me.current=!1)},He=tt=>{const L=te(),ce=tt.touches[0].clientY-be.current;if(L>5||ce<=0){Me.current=!1,h(0);return}ce>20&&L<=0&&(Me.current=!0,h(Math.min((ce-20)*.4,80)))},Ne=()=>{Me.current&&a>60?(y(!0),setTimeout(()=>{window.location.reload()},300)):h(0),Me.current=!1};return document.addEventListener("touchstart",ge,{passive:!0}),document.addEventListener("touchmove",He,{passive:!0}),document.addEventListener("touchend",Ne),()=>{document.removeEventListener("touchstart",ge),document.removeEventListener("touchmove",He),document.removeEventListener("touchend",Ne)}},[a]);const F=()=>{y(!0),setTimeout(()=>{window.location.reload()},300)},B=async()=>{try{await X(),ue("/")}catch(te){console.error("Failed to log out:",te)}},se=()=>{ue("/add-client")},Z=te=>new Date(te).toLocaleDateString("en-GB",{weekday:"short",day:"numeric",month:"short"}),Q=te=>{const[ge,He]=te.split(":"),Ne=parseInt(ge),tt=Ne>=12?"pm":"am";return`${Ne>12?Ne-12:Ne===0?12:Ne}:${He}${tt}`},z=async te=>{if(window.confirm(`Approve reschedule for ${te.clientName}?

From: ${Z(te.originalDate)} at ${Q(te.originalTime)}
To: ${Z(te.requestedDate)} at ${Q(te.requestedTime)}`)){S(te.id);try{await Ms(Ft(nt,"sessions",te.sessionId),{date:te.requestedDate,time:te.requestedTime}),await Ms(Ft(nt,"rescheduleRequests",te.id),{status:"approved",respondedAt:vt.now()}),C(A.filter(ge=>ge.id!==te.id)),Ce(`Approved reschedule for ${te.clientName}`,"success")}catch(ge){console.error("Error approving request:",ge),Ce("Failed to approve request","error")}S(null)}},Ye=async te=>{if(window.confirm(`Reject reschedule request from ${te.clientName}?`)){S(te.id);try{await Ms(Ft(nt,"rescheduleRequests",te.id),{status:"rejected",respondedAt:vt.now()}),C(A.filter(ge=>ge.id!==te.id)),Ce(`Request from ${te.clientName} rejected`,"info")}catch(ge){console.error("Error rejecting request:",ge),Ce("Failed to reject request","error")}S(null)}};if(J)return u.jsx("div",{className:"loading",children:"Loading..."});if(!Y||!G)return null;const me=A.length;return u.jsxs("div",{className:"dashboard",children:[a>0&&u.jsxs("div",{className:"pull-indicator",style:{height:a},children:[u.jsx("div",{className:`pull-spinner ${f?"spinning":""}`,children:f?"":""}),u.jsx("span",{children:f?"Refreshing...":a>60?"Release to refresh":"Pull to refresh"})]}),u.jsxs("header",{className:"dashboard-header",children:[u.jsxs("div",{className:"header-left",children:[u.jsx("img",{src:"/Logo.PNG",alt:"Mind Core Fitness",className:"admin-header-logo"}),u.jsx("span",{className:"admin-badge",children:"Admin"})]}),u.jsxs("nav",{className:"header-nav",children:[u.jsx("button",{className:`nav-btn ${i==="schedule"?"active":""}`,onClick:()=>t("schedule"),children:"Today"}),u.jsx("button",{className:`nav-btn ${i==="clients"?"active":""}`,onClick:()=>t("clients"),children:"Clients"}),u.jsx("button",{className:`nav-btn ${i==="calendar"?"active":""}`,onClick:()=>t("calendar"),children:"Calendar"}),u.jsxs("button",{className:`nav-btn ${i==="requests"?"active":""} ${me>0?"has-badge":""}`,onClick:()=>t("requests"),children:["Requests",me>0&&u.jsx("span",{className:"nav-badge",children:me})]}),u.jsx("button",{className:`nav-btn ${i==="availability"?"active":""}`,onClick:()=>t("availability"),children:"Slots"}),u.jsx("button",{className:`nav-btn ${i==="circuits"?"active":""}`,onClick:()=>t("circuits"),children:"Circuits"})]}),u.jsxs("div",{className:"header-actions",children:[u.jsx("button",{className:"theme-toggle-btn",onClick:ne,"aria-label":ae?"Switch to light mode":"Switch to dark mode",children:ae?u.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:u.jsx("path",{d:"M12 3a9 9 0 109 9c0-.46-.04-.92-.1-1.36a5.389 5.389 0 01-4.4 2.26 5.403 5.403 0 01-3.14-9.8c-.44-.06-.9-.1-1.36-.1z"})}):u.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:u.jsx("path",{d:"M12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zM2 13h2c.55 0 1-.45 1-1s-.45-1-1-1H2c-.55 0-1 .45-1 1s.45 1 1 1zm18 0h2c.55 0 1-.45 1-1s-.45-1-1-1h-2c-.55 0-1 .45-1 1s.45 1 1 1zM11 2v2c0 .55.45 1 1 1s1-.45 1-1V2c0-.55-.45-1-1-1s-1 .45-1 1zm0 18v2c0 .55.45 1 1 1s1-.45 1-1v-2c0-.55-.45-1-1-1s-1 .45-1 1zM5.99 4.58a.996.996 0 00-1.41 0 .996.996 0 000 1.41l1.06 1.06c.39.39 1.03.39 1.41 0s.39-1.03 0-1.41L5.99 4.58zm12.37 12.37a.996.996 0 00-1.41 0 .996.996 0 000 1.41l1.06 1.06c.39.39 1.03.39 1.41 0a.996.996 0 000-1.41l-1.06-1.06zm1.06-10.96a.996.996 0 000-1.41.996.996 0 00-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06zM7.05 18.36a.996.996 0 000-1.41.996.996 0 00-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06z"})})}),u.jsx("button",{className:"refresh-btn",onClick:F,disabled:f,children:f?"":""}),u.jsx("button",{className:"logout-btn",onClick:B,children:"Log Out"})]})]}),I&&u.jsx("div",{className:"toast-container",children:u.jsxs("div",{className:`toast ${I.type}`,children:[u.jsxs("span",{className:"toast-icon",children:[I.type==="success"&&u.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:u.jsx("path",{d:"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"})}),I.type==="error"&&u.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:u.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"})}),I.type==="info"&&u.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:u.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"})})]}),u.jsx("span",{className:"toast-message",children:I.message})]})}),u.jsxs("main",{className:"dashboard-main",children:[i==="schedule"&&u.jsxs("div",{className:"schedule-view",children:[u.jsx("div",{className:"view-header",children:u.jsx("h2",{children:"Schedule"})}),u.jsx(R8,{})]}),i==="clients"&&u.jsxs("div",{className:"clients-view",children:[u.jsxs("div",{className:"view-header",children:[u.jsx("h2",{children:"Clients"}),u.jsx("button",{className:"add-btn",onClick:se,children:"+ Add Client"})]}),u.jsx(_8,{})]}),i==="calendar"&&u.jsxs("div",{className:"calendar-view",children:[u.jsx("div",{className:"view-header",children:u.jsx("h2",{children:"Calendar"})}),u.jsx(N8,{})]}),i==="requests"&&u.jsxs("div",{className:"requests-view",children:[u.jsx("div",{className:"view-header",children:u.jsx("h2",{children:"Reschedule Requests"})}),A.length===0?u.jsxs("div",{className:"no-requests",children:[u.jsx("div",{className:"empty-icon",children:u.jsxs("svg",{viewBox:"0 0 100 100",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[u.jsx("rect",{x:"20",y:"25",width:"60",height:"50",rx:"4"}),u.jsx("path",{d:"M20 35 L50 55 L80 35"}),u.jsx("circle",{cx:"50",cy:"70",r:"3",fill:"currentColor"})]})}),u.jsx("p",{children:"No pending requests"}),u.jsx("span",{children:"When clients request to reschedule, they will appear here"})]}):u.jsx("div",{className:"requests-list",children:A.map(te=>u.jsxs("div",{className:"request-card",children:[u.jsxs("div",{className:"request-header",children:[u.jsx("span",{className:"client-name",children:te.clientName}),u.jsx("span",{className:"request-time",children:te.createdAt?.toDate?te.createdAt.toDate().toLocaleDateString("en-GB",{day:"numeric",month:"short",hour:"2-digit",minute:"2-digit"}):""})]}),u.jsx("div",{className:"request-details",children:u.jsxs("div",{className:"request-change",children:[u.jsxs("div",{className:"from-session",children:[u.jsx("span",{className:"label",children:"From:"}),u.jsxs("span",{className:"value",children:[Z(te.originalDate)," at ",Q(te.originalTime)]})]}),u.jsx("div",{className:"arrow",children:""}),u.jsxs("div",{className:"to-session",children:[u.jsx("span",{className:"label",children:"To:"}),u.jsxs("span",{className:"value",children:[Z(te.requestedDate)," at ",Q(te.requestedTime)]})]})]})}),u.jsxs("div",{className:"request-actions",children:[u.jsx("button",{className:"approve-btn",onClick:()=>z(te),disabled:E===te.id,children:E===te.id?"Processing...":"Approve"}),u.jsx("button",{className:"reject-btn",onClick:()=>Ye(te),disabled:E===te.id,children:"Reject"})]})]},te.id))})]}),i==="availability"&&u.jsxs("div",{className:"availability-view",children:[u.jsx("div",{className:"view-header",children:u.jsx("h2",{children:"Available Slots"})}),u.jsx(j8,{})]}),i==="circuits"&&u.jsxs("div",{className:"circuits-view",children:[u.jsx("div",{className:"view-header",children:u.jsx("h2",{children:"Circuit Management"})}),u.jsx(L8,{})]})]})]})}const V8=[{value:"block",label:"Block (1-2-1)"},{value:"circuit_vip",label:"Circuit VIP"},{value:"circuit_dropin",label:"Circuit Drop-in"}];function F8(){const[i,e]=H.useState({name:"",email:"",password:"",clientType:"block",circuitAccess:!1,weeksInBlock:"",numberOfSessions:"",sessionDuration:"45",startDate:"",endDate:""}),[t,a]=H.useState(!1),[h,f]=H.useState(""),{currentUser:y,isAdmin:A,loading:C}=Vi(),E=ai();H.useEffect(()=>{!C&&(!y||!A)&&E("/")},[y,A,C,E]),H.useEffect(()=>{if(i.startDate&&i.weeksInBlock){const X=new Date(i.startDate),G=parseInt(i.weeksInBlock);if(!isNaN(G)&&G>0){const J=new Date(X);J.setDate(J.getDate()+G*7);const ae=J.getFullYear(),ne=(J.getMonth()+1).toString().padStart(2,"0"),ue=J.getDate().toString().padStart(2,"0");e(be=>({...be,endDate:`${ae}-${ne}-${ue}`}))}}},[i.startDate,i.weeksInBlock]);const S=X=>{const{name:G,value:J,type:ae,checked:ne}=X.target;e(ue=>({...ue,[G]:ae==="checkbox"?ne:J}))},I=async X=>{X.preventDefault(),f(""),a(!0);try{const G=await Hw(Jd,i.email.trim().toLowerCase(),i.password);await Um(Jd);const J=i.clientType==="block",ae={uid:G.user.uid,name:i.name.trim(),email:i.email.trim().toLowerCase(),clientType:i.clientType,status:"active",createdAt:vt.now()};J?(ae.circuitAccess=i.circuitAccess,ae.weeksInBlock=parseInt(i.weeksInBlock),ae.totalSessions=parseInt(i.numberOfSessions),ae.sessionsRemaining=parseInt(i.numberOfSessions),ae.sessionDuration=parseInt(i.sessionDuration),ae.startDate=vt.fromDate(new Date(i.startDate)),ae.endDate=vt.fromDate(new Date(i.endDate))):(ae.circuitStrikes=0,ae.circuitBanUntil=null),await oc(En(nt,"clients"),ae),E("/dashboard")}catch(G){console.error("Error adding client:",G),G.code==="auth/email-already-in-use"?f("This email is already registered."):G.code==="auth/weak-password"?f("Password should be at least 6 characters."):f("Failed to add client. Please try again."),a(!1)}},j=()=>{E("/dashboard")};if(C)return u.jsx("div",{className:"loading",children:"Loading..."});if(!y||!A)return null;const Y=i.clientType==="block";return u.jsxs("div",{className:"add-client-page",children:[u.jsxs("header",{className:"page-header",children:[u.jsx("button",{className:"back-btn",onClick:j,children:" Back"}),u.jsx("h1",{children:"Add New Client"})]}),u.jsxs("main",{className:"page-content",children:[h&&u.jsx("div",{className:"form-error",children:h}),u.jsxs("form",{onSubmit:I,children:[u.jsxs("div",{className:"form-group",children:[u.jsx("label",{children:"Client Type"}),u.jsx("div",{className:"client-type-toggle",children:V8.map(X=>u.jsx("button",{type:"button",className:`type-btn ${i.clientType===X.value?"active":""}`,onClick:()=>e(G=>({...G,clientType:X.value})),children:X.label},X.value))})]}),u.jsxs("div",{className:"form-group",children:[u.jsx("label",{htmlFor:"name",children:"Client Name"}),u.jsx("input",{type:"text",id:"name",name:"name",value:i.name,onChange:S,placeholder:"John Smith",required:!0})]}),u.jsxs("div",{className:"form-group",children:[u.jsx("label",{htmlFor:"email",children:"Client Email"}),u.jsx("input",{type:"email",id:"email",name:"email",value:i.email,onChange:S,placeholder:"john@example.com",required:!0})]}),u.jsxs("div",{className:"form-group",children:[u.jsx("label",{htmlFor:"password",children:"Client Portal Password"}),u.jsx("input",{type:"text",id:"password",name:"password",value:i.password,onChange:S,placeholder:"Set a password for client login",minLength:"6",required:!0}),u.jsx("span",{className:"helper-text",children:"Minimum 6 characters. Share this with your client."})]}),Y&&u.jsx("div",{className:"form-group",children:u.jsxs("label",{className:"circuit-toggle-label",children:[u.jsx("input",{type:"checkbox",name:"circuitAccess",checked:i.circuitAccess,onChange:S}),u.jsx("span",{children:"Also allow Circuit Class access"})]})}),Y&&u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"form-group",children:[u.jsx("label",{htmlFor:"weeksInBlock",children:"Weeks in Block"}),u.jsx("input",{type:"number",id:"weeksInBlock",name:"weeksInBlock",value:i.weeksInBlock,onChange:S,placeholder:"8",min:"1",required:!0})]}),u.jsxs("div",{className:"form-group",children:[u.jsx("label",{htmlFor:"numberOfSessions",children:"Number of Sessions"}),u.jsx("input",{type:"number",id:"numberOfSessions",name:"numberOfSessions",value:i.numberOfSessions,onChange:S,placeholder:"16",min:"1",required:!0})]}),u.jsxs("div",{className:"form-group",children:[u.jsx("label",{htmlFor:"sessionDuration",children:"Session Duration"}),u.jsxs("select",{id:"sessionDuration",name:"sessionDuration",value:i.sessionDuration,onChange:S,required:!0,children:[u.jsx("option",{value:"30",children:"30 minutes"}),u.jsx("option",{value:"45",children:"45 minutes"})]})]}),u.jsxs("div",{className:"form-group",children:[u.jsx("label",{htmlFor:"startDate",children:"Start Date"}),u.jsx("input",{type:"date",id:"startDate",name:"startDate",value:i.startDate,onChange:S,required:!0})]}),u.jsxs("div",{className:"form-group",children:[u.jsx("label",{htmlFor:"endDate",children:"End Date (auto-calculated)"}),u.jsx("input",{type:"date",id:"endDate",name:"endDate",value:i.endDate,onChange:S,required:!0}),u.jsx("span",{className:"helper-text",children:"Calculated from start date + weeks"})]})]}),u.jsxs("div",{className:"form-actions",children:[u.jsx("button",{type:"button",className:"cancel-btn",onClick:j,children:"Cancel"}),u.jsx("button",{type:"submit",className:"submit-btn",disabled:t,children:t?"Saving...":"Save Client"})]})]})]})]})}const GE={monday:{morning:{start:"06:15",end:"12:00"},afternoon:{start:"15:00",end:"20:00"}},tuesday:{morning:{start:"06:15",end:"12:00"},afternoon:{start:"15:00",end:"20:00"}},wednesday:{morning:{start:"06:15",end:"12:00"},afternoon:{start:"15:00",end:"20:00"}},thursday:{morning:{start:"06:15",end:"12:00"},afternoon:{start:"15:00",end:"20:00"}},friday:{morning:{start:"08:00",end:"10:00"},afternoon:null}},U8=["monday","tuesday","wednesday","thursday","friday"],Na=i=>{const e=i.getFullYear(),t=(i.getMonth()+1).toString().padStart(2,"0"),a=i.getDate().toString().padStart(2,"0");return`${e}-${t}-${a}`},bm=i=>{const[e,t]=i.split(":").map(Number);return e*60+t},tf=(i,e)=>{const t=bm(i)+e,a=Math.floor(t/60),h=t%60;return`${a.toString().padStart(2,"0")}:${h.toString().padStart(2,"0")}`},z8=i=>{const e=GE[i];if(!e)return[];const t=[];if(e.morning){let a=e.morning.start;for(;a<e.morning.end;)t.push({time:a,period:"morning"}),a=tf(a,15)}if(e.afternoon){let a=e.afternoon.start;for(;a<e.afternoon.end;)t.push({time:a,period:"afternoon"}),a=tf(a,15)}return t},H8=i=>{const e=i.getDay();return e>=1&&e<=5},qE=i=>{const e=i.getDay();return e===0||e===6?null:U8[e-1]},G8=(i,e,t,a,h,f=null,y=[])=>{const A=qE(i);if(!A)return!1;const C=Na(i);if(h.some(ne=>ne.date===C))return!1;const E=Math.ceil(t/15);for(let ne=0;ne<E;ne++){const ue=tf(e,ne*15);if(y.some(be=>be.date===C&&be.time===ue))return!1}const S=new Date,I=Na(S);if(C<I)return!1;if(C===I){const ne=`${S.getHours().toString().padStart(2,"0")}:${S.getMinutes().toString().padStart(2,"0")}`;if(e<ne)return!1}const j=tf(e,t),Y=GE[A],X=Y.morning&&e>=Y.morning.start&&e<Y.morning.end,G=Y.afternoon&&e>=Y.afternoon.start&&e<Y.afternoon.end,J=Y.morning&&j<=Y.morning.end,ae=Y.afternoon&&j<=Y.afternoon.end;if(X&&!J||G&&!ae||!X&&!G)return!1;for(const ne of a){if(f&&ne.id===f||ne.date!==C)continue;const ue=bm(ne.time),be=ue+(ne.duration||45),Me=bm(e),Ce=Me+t;if(Me<be&&Ce>ue)return!1}return!0},q8=(i,e,t,a,h=null,f=[])=>{const y=qE(i);return y?z8(y).filter(C=>G8(i,C.time,e,t,a,h,f)):[]};function W8(){const[i,e]=H.useState([]),[t,a]=H.useState([]),[h,f]=H.useState([]),[y,A]=H.useState([]),[C,E]=H.useState([]),[S,I]=H.useState(!0),[j,Y]=H.useState(null),[X,G]=H.useState(!1),[J,ae]=H.useState(null),[ne,ue]=H.useState(null),[be,Me]=H.useState(null),[Ce,P]=H.useState([]),[F,B]=H.useState(!1),[se,Z]=H.useState([]),[Q,z]=H.useState(null),[Ye,me]=H.useState(!1),[te,ge]=H.useState(0),He=H.useRef(null),Ne=H.useRef(0),tt=H.useRef(!1),[L,oe]=H.useState(null),[ce,pe]=H.useState(null),[ee,ie]=H.useState(!1),[Te,Pe]=H.useState([]),[it,dt]=H.useState(!1),[Le,qt]=H.useState(null),[wt,Zt]=H.useState(null),{currentUser:zt,isClient:Pt,clientData:st,logout:mt,loading:at}=Vi(),{isDark:kt,toggleTheme:de}=Cl(),et=ai(),Ot=H.useCallback(($,Oe="info")=>{z({message:$,type:Oe}),setTimeout(()=>z(null),4e3)},[]),ot=$=>{const Oe=$.currentTarget,Ke=Oe.querySelector(".ripple");Ke&&Ke.remove();const Re=document.createElement("span"),ft=Math.max(Oe.clientWidth,Oe.clientHeight),yt=ft/2,bt=Oe.getBoundingClientRect();Re.style.width=Re.style.height=`${ft}px`,Re.style.left=`${$.clientX-bt.left-yt}px`,Re.style.top=`${$.clientY-bt.top-yt}px`,Re.classList.add("ripple"),Oe.appendChild(Re),setTimeout(()=>Re.remove(),600)},xn=$=>{He.current&&He.current.scrollTop===0&&(Ne.current=$.touches[0].clientY,tt.current=!0)},jn=$=>{if(!tt.current||!He.current)return;const Ke=$.touches[0].clientY-Ne.current;Ke>20&&He.current.scrollTop===0&&($.preventDefault(),ge(Math.min((Ke-20)*.35,80)))},Zn=async()=>{te>55&&!Ye&&(me(!0),await xs(),Ot("Refreshed!","success"),me(!1)),ge(0),tt.current=!1},Vn=($,Oe)=>{const Ke=$.touches[0];$.currentTarget.dataset.startX=Ke.clientX,$.currentTarget.dataset.startY=Ke.clientY},vn=($,Oe)=>{const Ke=$.touches[0],Re=parseFloat($.currentTarget.dataset.startX),ft=parseFloat($.currentTarget.dataset.startY),yt=Ke.clientX-Re,bt=Ke.clientY-ft;Math.abs(yt)>Math.abs(bt)&&Math.abs(yt)>10&&($.preventDefault(),yt<-50?oe(Oe):yt>50&&oe(null))};H.useEffect(()=>{!at&&(!zt||!Pt)&&et("/")},[zt,Pt,at,et]),H.useEffect(()=>{st&&xs()},[st]),H.useEffect(()=>{if(!S&&st){const $=setTimeout(()=>dt(!0),300);return()=>clearTimeout($)}},[S,st]),H.useEffect(()=>{const $=()=>{const Ke=wn();if(Ke.length===0){qt(null);return}const Re=Ke[0],ft=new Date,bt=new Date(Re.date+"T"+Re.time)-ft;if(bt<=0){qt(null);return}const Gn=Math.floor(bt/(1e3*60*60*24)),os=Math.floor(bt%(1e3*60*60*24)/(1e3*60*60)),Ps=Math.floor(bt%(1e3*60*60)/(1e3*60)),vs=Math.floor(bt%(1e3*60)/1e3);qt({days:Gn,hours:os,minutes:Ps,seconds:vs,session:Re})};$();const Oe=setInterval($,1e3);return()=>clearInterval(Oe)},[i,S]);const xs=async()=>{try{const $=kr(En(nt,"sessions"),vr("clientId","==",st.id)),Ke=(await Hn($)).docs.map(pt=>({id:pt.id,...pt.data()}));Ke.sort((pt,Ht)=>pt.date!==Ht.date?pt.date.localeCompare(Ht.date):pt.time.localeCompare(Ht.time)),e(Ke);const Re=await Hn(En(nt,"sessions"));a(Re.docs.map(pt=>({id:pt.id,...pt.data()})));const ft=await Hn(En(nt,"holidays"));f(ft.docs.map(pt=>({id:pt.id,...pt.data()})));const yt=await Hn(En(nt,"blockedTimes"));A(yt.docs.map(pt=>({id:pt.id,...pt.data()})));const bt=kr(En(nt,"rescheduleRequests"),vr("clientId","==",st.id)),os=(await Hn(bt)).docs.map(pt=>({id:pt.id,...pt.data()}));Z(os.filter(pt=>pt.status==="pending"));const Ps=os.filter(pt=>{if(pt.status==="pending"||!pt.respondedAt)return!1;const Ht=pt.respondedAt.toDate?pt.respondedAt.toDate():new Date(pt.respondedAt),Ss=new Date;return Ss.setDate(Ss.getDate()-7),Ht>Ss&&!pt.dismissed});E(Ps);const vs=kr(En(nt,"achievements"),vr("clientId","==",st.id)),br=await Hn(vs);if(!br.empty){const pt=br.docs[0].data().badges||[];Pe(pt)}const Ti=new Date().toISOString().split("T")[0],Ts=await Bo(Ft(nt,"clients",st.id));if(Ts.exists()){const pt=Ts.data();pt.dailyQuote&&pt.dailyQuote.date===Ti?Zt(pt.dailyQuote):Zt(null)}}catch($){console.error("Error fetching data:",$)}I(!1)},Wn=$=>new Date($).toLocaleDateString("en-GB",{weekday:"long",day:"numeric",month:"long"}),Cs=$=>{const[Oe,Ke]=$.split(":"),Re=parseInt(Oe),ft=Re>=12?"pm":"am";return`${Re>12?Re-12:Re===0?12:Re}:${Ke}${ft}`},Qt=$=>$?($.toDate?$.toDate():new Date($)).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"}):"-",We=$=>{const Oe=new Date,Ke=Na(Oe),Re=`${Oe.getHours().toString().padStart(2,"0")}:${Oe.getMinutes().toString().padStart(2,"0")}`;return $.date<Ke||$.date===Ke&&$.time<Re},en=$=>{const Ke=Na(new Date);return $.date===Ke&&!We($)},Ct=()=>i.filter($=>We($)).length,wn=()=>i.filter($=>!We($)),Ls=$=>{pe({title:"Cancel Session?",message:`Cancel your session on ${Wn($.date)} at ${Cs($.time)}? This cannot be undone.`,onConfirm:async()=>{pe(null),Y($.id),oe(null);try{await ja(Ft(nt,"sessions",$.id)),e(i.filter(Oe=>Oe.id!==$.id)),Ot("Session cancelled","success")}catch(Oe){console.error("Error cancelling session:",Oe),Ot("Failed to cancel session. Please try again.","error")}Y(null)},onCancel:()=>pe(null)})},Ai=async()=>{try{await mt(),et("/")}catch($){console.error("Failed to log out:",$)}},Nn=$=>se.some(Oe=>Oe.sessionId===$),It=$=>{ae($),ue(null),Me(null),P([]),G(!0)},fn=()=>{G(!1),ae(null),ue(null),Me(null),P([])},Hs=()=>st.endDate?st.endDate.toDate?st.endDate.toDate():new Date(st.endDate):new Date,Xs=()=>{const $=[],Oe=new Date,Ke=Hs(),Re=new Date(Oe);for(Re.setDate(Re.getDate()+1);Re<=Ke;){if(H8(Re)){const ft=Na(Re);h.some(bt=>bt.date===ft)||$.push(new Date(Re))}Re.setDate(Re.getDate()+1)}return $},Tn=$=>{ue($),Me(null);const Oe=J?.duration||st.sessionDuration||45;let Ke=q8($,Oe,t,h,J?.id,y);J&&Na($)===J.date&&(Ke=Ke.filter(Re=>Re.time!==J.time)),P(Ke)},Ci=async()=>{if(!(!ne||!be||!J)){B(!0);try{await oc(En(nt,"rescheduleRequests"),{sessionId:J.id,clientId:st.id,clientName:st.name,originalDate:J.date,originalTime:J.time,requestedDate:Na(ne),requestedTime:be,duration:J.duration,status:"pending",createdAt:vt.now(),respondedAt:null,dismissed:!1}),fn(),Ot("Reschedule request submitted! You'll be notified when your trainer responds.","success"),xs()}catch($){console.error("Error submitting reschedule request:",$),Ot("Failed to submit request. Please try again.","error")}B(!1)}},Yn=async $=>{try{await Ms(Ft(nt,"rescheduleRequests",$),{dismissed:!0}),E(C.filter(Oe=>Oe.id!==$))}catch(Oe){console.error("Error dismissing notification:",Oe)}},as=()=>{const $=wn();if($.length===0)return null;const Oe=$[0],Ke=new Date,ft=new Date(Oe.date+"T"+Oe.time)-Ke;if(ft<=0)return null;const yt=Math.floor(ft/(1e3*60*60*24)),bt=Math.floor(ft%(1e3*60*60*24)/(1e3*60*60)),Gn=Math.floor(ft%(1e3*60*60)/(1e3*60));return{days:yt,hours:bt,minutes:Gn,session:Oe}};if(at||S)return u.jsxs("div",{className:"client-dashboard",children:[u.jsx("header",{className:"client-header",children:u.jsx("div",{className:"header-content",children:u.jsx("div",{className:"skeleton skeleton-logo"})})}),u.jsxs("main",{className:"client-main",children:[u.jsxs("div",{className:"skeleton-welcome",children:[u.jsx("div",{className:"skeleton skeleton-title"}),u.jsx("div",{className:"skeleton skeleton-btn-small"})]}),u.jsxs("div",{className:"skeleton-actions",children:[u.jsx("div",{className:"skeleton skeleton-btn"}),u.jsx("div",{className:"skeleton skeleton-btn"})]}),u.jsx("div",{className:"skeleton skeleton-card-large"}),u.jsx("div",{className:"skeleton skeleton-card-medium"}),u.jsx("div",{className:"skeleton skeleton-card-medium"})]})]});if(!zt||!Pt||!st)return null;const fs=Ct(),$n=st.totalSessions-fs,xe=wn(),Ue=X?Xs():[];as();const Ze=st.totalSessions>0?fs/st.totalSessions*100:0;return u.jsxs("div",{className:"client-dashboard",children:[u.jsx("header",{className:"client-header",children:u.jsx("div",{className:"header-content",children:u.jsx("img",{src:"/Logo.PNG",alt:"Mind Core Fitness",className:"header-logo"})})}),u.jsxs("div",{className:`pull-refresh-indicator ${te>0?"visible":""} ${Ye?"refreshing":""}`,style:{height:te},children:[u.jsx("div",{className:`refresh-spinner ${Ye?"spinning":""}`,children:u.jsx("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:u.jsx("path",{fill:"currentColor",d:"M17.65 6.35A7.958 7.958 0 0012 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08A5.99 5.99 0 0112 18c-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"})})}),u.jsx("span",{className:"refresh-text",children:Ye?"Refreshing...":"Pull to refresh"})]}),u.jsxs("main",{className:"client-main page-transition-enter",ref:He,onTouchStart:xn,onTouchMove:jn,onTouchEnd:Zn,children:[u.jsxs("div",{className:"welcome-section",children:[u.jsxs("h2",{children:["Welcome, ",st.name.split(" ")[0]]}),u.jsxs("div",{className:"welcome-actions",children:[u.jsx("button",{className:"theme-toggle",onClick:de,"aria-label":kt?"Switch to light mode":"Switch to dark mode",children:kt?u.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:u.jsx("path",{d:"M12 3a9 9 0 109 9c0-.46-.04-.92-.1-1.36a5.389 5.389 0 01-4.4 2.26 5.403 5.403 0 01-3.14-9.8c-.44-.06-.9-.1-1.36-.1z"})}):u.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:u.jsx("path",{d:"M12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zM2 13h2c.55 0 1-.45 1-1s-.45-1-1-1H2c-.55 0-1 .45-1 1s.45 1 1 1zm18 0h2c.55 0 1-.45 1-1s-.45-1-1-1h-2c-.55 0-1 .45-1 1s.45 1 1 1zM11 2v2c0 .55.45 1 1 1s1-.45 1-1V2c0-.55-.45-1-1-1s-1 .45-1 1zm0 18v2c0 .55.45 1 1 1s1-.45 1-1v-2c0-.55-.45-1-1-1s-1 .45-1 1zM5.99 4.58a.996.996 0 00-1.41 0 .996.996 0 000 1.41l1.06 1.06c.39.39 1.03.39 1.41 0s.39-1.03 0-1.41L5.99 4.58zm12.37 12.37a.996.996 0 00-1.41 0 .996.996 0 000 1.41l1.06 1.06c.39.39 1.03.39 1.41 0a.996.996 0 000-1.41l-1.06-1.06zm1.06-10.96a.996.996 0 000-1.41.996.996 0 00-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06zM7.05 18.36a.996.996 0 000-1.41.996.996 0 00-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06z"})})}),u.jsx("button",{className:"logout-btn",onClick:Ai,children:"Log Out"})]})]}),C.length>0&&u.jsx("div",{className:"notifications-section",children:C.map($=>u.jsxs("div",{className:`notification ${$.status}`,children:[u.jsxs("div",{className:"notification-content",children:[u.jsx("span",{className:"notification-icon",children:$.status==="approved"?"":""}),u.jsxs("div",{className:"notification-text",children:[u.jsx("strong",{children:$.status==="approved"?"Reschedule Approved!":"Reschedule Declined"}),u.jsx("p",{children:$.status==="approved"?`Your session has been moved to ${Wn($.requestedDate)} at ${Cs($.requestedTime)}`:`Your request to reschedule from ${Wn($.originalDate)} was declined. Please contact your trainer.`})]})]}),u.jsx("button",{className:"dismiss-btn",onClick:()=>Yn($.id),children:""})]},$.id))}),Le&&u.jsxs("div",{className:"ring-timer-container",children:[u.jsxs("div",{className:"ring-timer",children:[u.jsx("svg",{className:"ring-timer-svg",viewBox:"0 0 200 200",children:[...Array(60)].map(($,Oe)=>{const Ke=(Oe*6-90)*(Math.PI/180),Re=85,ft=96,yt=100+Re*Math.cos(Ke),bt=100+Re*Math.sin(Ke),Gn=100+ft*Math.cos(Ke),os=100+ft*Math.sin(Ke),vs=60-Le.seconds,br=Oe<vs;return u.jsx("line",{x1:yt,y1:bt,x2:Gn,y2:os,className:`ring-tick ${br?"elapsed":"remaining"}`,strokeWidth:Oe%5===0?"3":"2"},Oe)})}),u.jsxs("div",{className:"ring-timer-center",children:[u.jsx("div",{className:"ring-timer-logo",children:u.jsx("img",{src:"/Logo.PNG",alt:"Mind Core Fitness"})}),u.jsxs("div",{className:"ring-timer-countdown",children:[Le.days>0&&u.jsxs(u.Fragment,{children:[u.jsx("span",{className:"timer-digit",children:String(Le.days).padStart(2,"0")}),u.jsx("span",{className:"timer-colon",children:":"})]}),u.jsx("span",{className:"timer-digit",children:String(Le.hours).padStart(2,"0")}),u.jsx("span",{className:"timer-colon",children:":"}),u.jsx("span",{className:"timer-digit",children:String(Le.minutes).padStart(2,"0")}),u.jsx("span",{className:"timer-colon",children:":"}),u.jsx("span",{className:"timer-digit timer-seconds",children:String(Le.seconds).padStart(2,"0")})]}),u.jsx("div",{className:"ring-timer-label",children:"until next session"})]})]}),u.jsxs("div",{className:"ring-timer-session-info",children:[Wn(Le.session.date)," at ",Cs(Le.session.time)]})]}),u.jsxs("div",{className:"block-info-card",children:[u.jsx("div",{className:"block-header-row",children:u.jsx("h3",{children:"Your Training Block"})}),u.jsxs("div",{className:"progress-section",children:[u.jsxs("div",{className:"progress-ring-container",children:[u.jsxs("svg",{className:"progress-ring",viewBox:"0 0 100 100",children:[u.jsx("circle",{className:"progress-ring-bg",cx:"50",cy:"50",r:"42",fill:"none",strokeWidth:"8"}),u.jsx("circle",{className:`progress-ring-fill ${it?"animate":""}`,cx:"50",cy:"50",r:"42",fill:"none",strokeWidth:"8",strokeDasharray:`${2*Math.PI*42}`,strokeDashoffset:it?`${2*Math.PI*42*(1-Ze/100)}`:`${2*Math.PI*42}`,strokeLinecap:"round"})]}),u.jsxs("div",{className:"progress-ring-text",children:[u.jsxs("span",{className:"progress-percent",children:[Math.round(Ze),"%"]}),u.jsx("span",{className:"progress-label",children:"complete"})]})]}),u.jsxs("div",{className:"progress-stats",children:[u.jsxs("div",{className:"progress-stat",children:[u.jsx("span",{className:"progress-stat-value",children:fs}),u.jsx("span",{className:"progress-stat-label",children:"Completed"})]}),u.jsxs("div",{className:"progress-stat",children:[u.jsx("span",{className:"progress-stat-value",children:$n}),u.jsx("span",{className:"progress-stat-label",children:"Remaining"})]}),u.jsxs("div",{className:"progress-stat",children:[u.jsx("span",{className:"progress-stat-value",children:st.totalSessions}),u.jsx("span",{className:"progress-stat-label",children:"Total"})]})]})]}),u.jsxs("div",{className:"block-dates",children:[u.jsxs("div",{className:"date-item",children:[u.jsx("span",{className:"date-label",children:"Start Date"}),u.jsx("span",{className:"date-value",children:Qt(st.startDate)})]}),u.jsxs("div",{className:"date-item",children:[u.jsx("span",{className:"date-label",children:"End Date"}),u.jsx("span",{className:"date-value",children:Qt(st.endDate)})]}),u.jsxs("div",{className:"date-item",children:[u.jsx("span",{className:"date-label",children:"Session Duration"}),u.jsxs("span",{className:"date-value",children:[st.sessionDuration," minutes"]})]})]})]}),u.jsxs("div",{className:"quick-actions",children:[u.jsx("button",{className:"forms-btn ripple-btn",onClick:$=>{ot($),et("/client/forms")},children:"Forms & Questionnaires"}),u.jsx("button",{className:"tools-btn ripple-btn",onClick:$=>{ot($),et("/client/tools")},children:"Tools & Calculators"})]}),u.jsx("div",{className:"quick-actions",style:{marginTop:"-8px"},children:u.jsx("button",{className:"forms-btn ripple-btn",onClick:$=>{ot($),et("/client/personal-bests")},style:{flex:"1 1 100%"},children:"Personal Bests & Progress"})}),Te.length>0&&u.jsxs("div",{className:"achievements-card",children:[u.jsxs("div",{className:"achievements-card-header",children:[u.jsxs("div",{className:"achievements-card-title",children:[u.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:u.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),u.jsx("span",{children:"Targets Achieved"})]}),u.jsx("span",{className:"achievements-card-count",children:Te.length})]}),u.jsx("div",{className:"achievements-card-list",children:[...Te].reverse().slice(0,3).map(($,Oe)=>u.jsxs("div",{className:"achievements-card-item",children:[u.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:u.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),u.jsx("span",{className:"achievements-card-label",children:$.label}),u.jsx("span",{className:"achievements-card-date",children:$.achievedMonth})]},Oe))}),Te.length>3&&u.jsxs("button",{className:"achievements-card-viewall",onClick:()=>et("/client/personal-bests"),children:["View all ",Te.length," achievements",u.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:u.jsx("path",{d:"M8.59 16.59L10 18l6-6-6-6-1.41 1.41L13.17 12z"})})]})]}),wt?u.jsxs("div",{className:"daily-quote-card",children:[u.jsx("div",{className:"daily-quote-icon",children:u.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:u.jsx("path",{d:"M6 17h3l2-4V7H5v6h3zm8 0h3l2-4V7h-6v6h3z"})})}),u.jsxs("div",{className:"daily-quote-content",children:[u.jsx("div",{className:"daily-quote-text",children:wt.text}),u.jsxs("div",{className:"daily-quote-author",children:[" ",wt.author]})]})]}):u.jsxs("div",{className:"daily-quote-cta",onClick:()=>et("/client/tools/motivation"),children:[u.jsx("div",{className:"daily-quote-cta-icon",children:u.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:u.jsx("path",{d:"M12 2L15.09 8.26L22 9.27L17 14.14L18.18 21.02L12 17.77L5.82 21.02L7 14.14L2 9.27L8.91 8.26L12 2Z"})})}),u.jsxs("div",{className:"daily-quote-cta-text",children:[u.jsx("span",{className:"daily-quote-cta-title",children:"Get More Inspiration"}),u.jsx("span",{className:"daily-quote-cta-sub",children:"Tap to get today's motivation"})]}),u.jsx("svg",{className:"daily-quote-cta-arrow",viewBox:"0 0 24 24",fill:"currentColor",children:u.jsx("path",{d:"M8.59 16.59L10 18l6-6-6-6-1.41 1.41L13.17 12z"})})]}),u.jsxs("div",{className:"sessions-section",children:[u.jsxs("h3",{children:["Upcoming Sessions (",xe.length,")"]}),xe.length===0?u.jsxs("div",{className:"empty-state",children:[u.jsx("div",{className:"empty-state-icon",children:u.jsxs("svg",{viewBox:"0 0 100 100",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[u.jsx("rect",{x:"20",y:"15",width:"60",height:"70",rx:"4"}),u.jsx("line",{x1:"20",y1:"35",x2:"80",y2:"35"}),u.jsx("line",{x1:"35",y1:"15",x2:"35",y2:"35"}),u.jsx("line",{x1:"65",y1:"15",x2:"65",y2:"35"}),u.jsx("circle",{cx:"40",cy:"55",r:"4",fill:"currentColor",opacity:"0.3"}),u.jsx("circle",{cx:"60",cy:"55",r:"4",fill:"currentColor",opacity:"0.3"}),u.jsx("circle",{cx:"40",cy:"70",r:"4",fill:"currentColor",opacity:"0.3"}),u.jsx("circle",{cx:"60",cy:"70",r:"4",fill:"currentColor",opacity:"0.3"})]})}),u.jsx("h4",{children:"No upcoming sessions"}),u.jsx("p",{children:"Contact your trainer to book sessions"})]}):u.jsx("div",{className:"sessions-list",children:xe.map($=>u.jsxs("div",{className:`session-card-wrapper ${L===$.id?"swiped":""}`,onTouchStart:Oe=>Vn(Oe,$.id),onTouchMove:Oe=>vn(Oe,$.id),children:[u.jsxs("div",{className:"session-card-swipe-actions",children:[u.jsx("button",{className:"swipe-action-btn reschedule ripple-btn",onClick:Oe=>{ot(Oe),oe(null),It($)},disabled:Nn($.id),children:"Reschedule"}),u.jsx("button",{className:"swipe-action-btn cancel ripple-btn",onClick:Oe=>{ot(Oe),Ls($)},disabled:j===$.id,children:"Cancel"})]}),u.jsxs("div",{className:`session-card ${en($)?"today-session":""}`,onClick:()=>L===$.id&&oe(null),children:[u.jsxs("div",{className:"session-info",children:[u.jsxs("div",{className:"session-date",children:[en($)&&u.jsx("span",{className:"today-label",children:"Today - "}),Wn($.date)]}),u.jsxs("div",{className:"session-time",children:[Cs($.time)," (",$.duration," min)"]}),Nn($.id)&&u.jsx("div",{className:"pending-badge",children:"Reschedule pending"})]}),u.jsxs("div",{className:"session-actions",children:[u.jsx("button",{className:"reschedule-btn ripple-btn",onClick:Oe=>{Oe.stopPropagation(),ot(Oe),It($)},disabled:Nn($.id),children:"Reschedule"}),u.jsx("button",{className:"cancel-btn ripple-btn",onClick:Oe=>{Oe.stopPropagation(),ot(Oe),Ls($)},disabled:j===$.id,children:j===$.id?"Cancelling...":"Cancel"})]}),u.jsxs("div",{className:"swipe-hint",children:[u.jsx("span",{className:"swipe-hint-text",children:"Swipe"}),u.jsxs("span",{className:"swipe-hint-chevrons",children:[u.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:u.jsx("path",{d:"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"})}),u.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:u.jsx("path",{d:"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"})}),u.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:u.jsx("path",{d:"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"})})]})]})]})]},$.id))})]}),u.jsxs("div",{className:"completed-section",children:[u.jsxs("h3",{children:["Completed Sessions (",fs,")"]}),fs===0?u.jsxs("div",{className:"empty-state",children:[u.jsx("div",{className:"empty-state-icon",children:u.jsxs("svg",{viewBox:"0 0 100 100",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[u.jsx("circle",{cx:"50",cy:"50",r:"35"}),u.jsx("path",{d:"M35 50 L45 60 L65 40",strokeLinecap:"round",strokeLinejoin:"round",opacity:"0.3"}),u.jsx("path",{d:"M50 25 L50 50 L65 55",strokeLinecap:"round",strokeLinejoin:"round"})]})}),u.jsx("h4",{children:"No completed sessions yet"}),u.jsx("p",{children:"Your completed sessions will appear here"})]}):u.jsxs("div",{className:"sessions-list completed",children:[i.filter($=>We($)).slice(-5).reverse().map($=>u.jsxs("div",{className:"session-card completed",children:[u.jsxs("div",{className:"session-info",children:[u.jsx("div",{className:"session-date",children:Wn($.date)}),u.jsx("div",{className:"session-time",children:Cs($.time)})]}),u.jsx("span",{className:"completed-badge",children:"Completed"})]},$.id)),fs>5&&u.jsxs("div",{className:"more-sessions",children:["And ",fs-5," more completed sessions"]})]})]})]}),X&&J&&u.jsx("div",{className:"modal-overlay",onClick:fn,children:u.jsxs("div",{className:"reschedule-modal",onClick:$=>$.stopPropagation(),children:[u.jsxs("div",{className:"modal-header",children:[u.jsx("h3",{children:"Reschedule Session"}),u.jsx("button",{className:"close-modal-btn",onClick:fn,children:""})]}),u.jsxs("div",{className:"modal-body",children:[u.jsx("div",{className:"current-session-info",children:u.jsxs("p",{children:["Current: ",u.jsx("strong",{children:Wn(J.date)})," at ",u.jsx("strong",{children:Cs(J.time)})]})}),u.jsxs("div",{className:"date-selection",children:[u.jsx("h4",{children:"Select New Date"}),Ue.length===0?u.jsx("p",{className:"no-dates",children:"No available dates within your training block"}):u.jsx("div",{className:"dates-grid",children:Ue.map(($,Oe)=>u.jsxs("button",{className:`date-btn ${ne&&Na(ne)===Na($)?"selected":""}`,onClick:()=>Tn($),children:[u.jsx("span",{className:"date-day",children:$.toLocaleDateString("en-GB",{weekday:"short"})}),u.jsx("span",{className:"date-num",children:$.getDate()}),u.jsx("span",{className:"date-month",children:$.toLocaleDateString("en-GB",{month:"short"})})]},Oe))})]}),ne&&u.jsxs("div",{className:"time-selection",children:[u.jsx("h4",{children:"Select Time"}),Ce.length===0?u.jsx("p",{className:"no-slots",children:"No available slots on this date"}):u.jsx("div",{className:"times-grid",children:Ce.map(($,Oe)=>u.jsx("button",{className:`time-btn ${be===$.time?"selected":""} ${$.period}`,onClick:()=>Me($.time),children:Cs($.time)},Oe))})]})]}),u.jsxs("div",{className:"modal-footer",children:[u.jsx("button",{className:"cancel-modal-btn",onClick:fn,children:"Cancel"}),u.jsx("button",{className:"submit-reschedule-btn",onClick:Ci,disabled:!ne||!be||F,children:F?"Submitting...":"Request Reschedule"})]})]})}),Q&&u.jsxs("div",{className:`toast-notification ${Q.type}`,children:[u.jsx("span",{className:"toast-icon",children:Q.type==="success"?u.jsx("svg",{className:"success-check-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:u.jsx("path",{className:"check-path",d:"M5 13 L9 17 L19 7"})}):Q.type==="error"?u.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[u.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),u.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]}):u.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:[u.jsx("circle",{cx:"12",cy:"12",r:"10"}),u.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),u.jsx("circle",{cx:"12",cy:"16",r:"1",fill:"currentColor"})]})}),u.jsx("span",{className:"toast-message",children:Q.message}),u.jsx("button",{className:"toast-close",onClick:()=>z(null),children:""})]}),ce&&u.jsx("div",{className:"confirm-modal-overlay",onClick:ce.onCancel,children:u.jsxs("div",{className:"confirm-modal",onClick:$=>$.stopPropagation(),children:[u.jsx("h3",{children:ce.title}),u.jsx("p",{children:ce.message}),u.jsxs("div",{className:"confirm-modal-actions",children:[u.jsx("button",{className:"confirm-cancel-btn ripple-btn",onClick:$=>{ot($),ce.onCancel()},children:"Keep Session"}),u.jsx("button",{className:"confirm-btn ripple-btn",onClick:$=>{ot($),ce.onConfirm()},children:"Yes, Cancel"})]})]})}),ee&&u.jsx("div",{className:"fab-backdrop",onClick:()=>ie(!1)}),u.jsxs("div",{className:`fab-container ${ee?"open":""}`,children:[u.jsx("button",{className:`fab-main ripple-btn ${ee?"open":""}`,onClick:$=>{ot($),ie(!ee)},"aria-label":"Quick actions",children:u.jsx("span",{className:"fab-icon",children:"+"})}),u.jsxs("div",{className:"fab-actions",children:[u.jsxs("button",{className:"fab-action ripple-btn",onClick:$=>{ot($),ie(!1),et("/client/tools")},children:[u.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:u.jsx("path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"})}),"Tools & Calculators"]}),u.jsxs("button",{className:"fab-action ripple-btn",onClick:$=>{ot($),ie(!1),et("/client/forms")},children:[u.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[u.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),u.jsx("polyline",{points:"14 2 14 8 20 8"}),u.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),u.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"}),u.jsx("polyline",{points:"10 9 9 9 8 9"})]}),"Forms & Questionnaires"]}),u.jsxs("button",{className:"fab-action ripple-btn",onClick:$=>{ot($),ie(!1),et("/client/personal-bests")},children:[u.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[u.jsx("path",{d:"M12 20V10"}),u.jsx("path",{d:"M18 20V4"}),u.jsx("path",{d:"M6 20v-4"})]}),"Personal Bests"]}),st?.circuitAccess&&u.jsxs("button",{className:"fab-action ripple-btn",onClick:$=>{ot($),ie(!1),et("/client/circuit")},children:[u.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[u.jsx("circle",{cx:"12",cy:"12",r:"10"}),u.jsx("path",{d:"M12 6v6l4 2"})]}),"Circuit Classes"]}),st?.coreBuddyAccess&&u.jsxs("button",{className:"fab-action ripple-btn",onClick:$=>{ot($),ie(!1),et("/client/core-buddy")},children:[u.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[u.jsx("path",{d:"M18 8h1a4 4 0 0 1 0 8h-1"}),u.jsx("path",{d:"M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z"}),u.jsx("line",{x1:"6",y1:"1",x2:"6",y2:"4"}),u.jsx("line",{x1:"10",y1:"1",x2:"10",y2:"4"}),u.jsx("line",{x1:"14",y1:"1",x2:"14",y2:"4"})]}),"Core Buddy"]})]})]})]})}function Y8(){const[i,e]=H.useState(null),[t,a]=H.useState(!1),{currentUser:h,isClient:f,clientData:y,logout:A,loading:C}=Vi(),E=ai(),[S,I]=H.useState({fitnessGoals:"",currentActivityLevel:"",exerciseHistory:"",injuries:"",medicalConditions:"",sleepHours:"",stressLevel:"",dietaryInfo:"",availability:"",additionalInfo:""}),[j,Y]=H.useState({q1HeartCondition:!1,q2ChestPain:!1,q3ChestPainLastMonth:!1,q4Balance:!1,q5BoneJoint:!1,q6BloodPressure:!1,q7OtherReason:!1,additionalDetails:"",declaration:!1});H.useEffect(()=>{!C&&(!h||!f)&&E("/")},[h,f,C,E]),H.useEffect(()=>{y?.welcomeForm&&I(y.welcomeForm),y?.parqForm&&Y(y.parqForm)},[y]);const X=be=>{const{name:Me,value:Ce}=be.target;I(P=>({...P,[Me]:Ce}))},G=be=>{const{name:Me,type:Ce,checked:P,value:F}=be.target;Y(B=>({...B,[Me]:Ce==="checkbox"?P:F}))},J=async()=>{a(!0);try{await Ms(Ft(nt,"clients",y.id),{welcomeForm:{...S,completedAt:vt.now()}}),alert("Welcome form saved successfully!"),e(null)}catch(be){console.error("Error saving welcome form:",be),alert("Failed to save form. Please try again.")}a(!1)},ae=async()=>{if(!j.declaration){alert("Please confirm the declaration to submit the form.");return}a(!0);try{await Ms(Ft(nt,"clients",y.id),{parqForm:{...j,completedAt:vt.now()}}),alert("PAR-Q form saved successfully!"),e(null)}catch(be){console.error("Error saving PAR-Q form:",be),alert("Failed to save form. Please try again.")}a(!1)};if(C)return u.jsx("div",{className:"client-loading",children:"Loading..."});if(!h||!f||!y)return null;const ne=!!y?.welcomeForm?.completedAt,ue=!!y?.parqForm?.completedAt;return u.jsxs("div",{className:"client-forms-page",children:[u.jsx("header",{className:"client-header",children:u.jsx("div",{className:"header-content",children:u.jsx("img",{src:"/Logo.PNG",alt:"Mind Core Fitness",className:"header-logo"})})}),u.jsxs("main",{className:"forms-main page-transition-enter",children:[u.jsx("button",{className:"back-btn",onClick:()=>E("/client"),children:" Back"}),i?i==="welcome"?u.jsxs("div",{className:"form-container",children:[u.jsxs("div",{className:"form-header",children:[u.jsx("h2",{children:"Welcome Questionnaire"}),u.jsx("button",{className:"close-form",onClick:()=>e(null),children:""})]}),u.jsxs("div",{className:"form-body",children:[u.jsxs("div",{className:"form-group",children:[u.jsx("label",{children:"What are your main fitness goals?"}),u.jsx("textarea",{name:"fitnessGoals",value:S.fitnessGoals,onChange:X,placeholder:"e.g., Lose weight, build muscle, improve endurance, increase flexibility...",rows:"3"})]}),u.jsxs("div",{className:"form-group",children:[u.jsx("label",{children:"How would you describe your current activity level?"}),u.jsxs("select",{name:"currentActivityLevel",value:S.currentActivityLevel,onChange:X,children:[u.jsx("option",{value:"",children:"Select..."}),u.jsx("option",{value:"sedentary",children:"Sedentary (little to no exercise)"}),u.jsx("option",{value:"light",children:"Lightly Active (1-2 days/week)"}),u.jsx("option",{value:"moderate",children:"Moderately Active (3-4 days/week)"}),u.jsx("option",{value:"active",children:"Very Active (5+ days/week)"}),u.jsx("option",{value:"athlete",children:"Athlete/Highly Active"})]})]}),u.jsxs("div",{className:"form-group",children:[u.jsx("label",{children:"What is your exercise history?"}),u.jsx("textarea",{name:"exerciseHistory",value:S.exerciseHistory,onChange:X,placeholder:"Describe your previous experience with exercise, sports, or training...",rows:"3"})]}),u.jsxs("div",{className:"form-group",children:[u.jsx("label",{children:"Do you have any current or past injuries?"}),u.jsx("textarea",{name:"injuries",value:S.injuries,onChange:X,placeholder:"List any injuries that may affect your training...",rows:"2"})]}),u.jsxs("div",{className:"form-group",children:[u.jsx("label",{children:"Do you have any medical conditions we should know about?"}),u.jsx("textarea",{name:"medicalConditions",value:S.medicalConditions,onChange:X,placeholder:"e.g., Diabetes, asthma, heart conditions...",rows:"2"})]}),u.jsxs("div",{className:"form-group",children:[u.jsx("label",{children:"How many hours of sleep do you typically get?"}),u.jsxs("select",{name:"sleepHours",value:S.sleepHours,onChange:X,children:[u.jsx("option",{value:"",children:"Select..."}),u.jsx("option",{value:"less-5",children:"Less than 5 hours"}),u.jsx("option",{value:"5-6",children:"5-6 hours"}),u.jsx("option",{value:"7-8",children:"7-8 hours"}),u.jsx("option",{value:"more-8",children:"More than 8 hours"})]})]}),u.jsxs("div",{className:"form-group",children:[u.jsx("label",{children:"How would you rate your current stress level?"}),u.jsxs("select",{name:"stressLevel",value:S.stressLevel,onChange:X,children:[u.jsx("option",{value:"",children:"Select..."}),u.jsx("option",{value:"low",children:"Low"}),u.jsx("option",{value:"moderate",children:"Moderate"}),u.jsx("option",{value:"high",children:"High"}),u.jsx("option",{value:"very-high",children:"Very High"})]})]}),u.jsxs("div",{className:"form-group",children:[u.jsx("label",{children:"Tell us about your diet/nutrition"}),u.jsx("textarea",{name:"dietaryInfo",value:S.dietaryInfo,onChange:X,placeholder:"Any dietary restrictions, typical eating habits, nutrition goals...",rows:"3"})]}),u.jsxs("div",{className:"form-group",children:[u.jsx("label",{children:"What is your preferred training schedule/availability?"}),u.jsx("textarea",{name:"availability",value:S.availability,onChange:X,placeholder:"Days and times that work best for you...",rows:"2"})]}),u.jsxs("div",{className:"form-group",children:[u.jsx("label",{children:"Anything else you'd like us to know?"}),u.jsx("textarea",{name:"additionalInfo",value:S.additionalInfo,onChange:X,placeholder:"Any other information that might be helpful...",rows:"3"})]}),u.jsxs("div",{className:"form-actions",children:[u.jsx("button",{className:"cancel-btn",onClick:()=>e(null),children:"Cancel"}),u.jsx("button",{className:"save-btn",onClick:J,disabled:t,children:t?"Saving...":"Save"})]})]})]}):u.jsxs("div",{className:"form-container",children:[u.jsxs("div",{className:"form-header",children:[u.jsx("h2",{children:"PAR-Q Health Screening"}),u.jsx("button",{className:"close-form",onClick:()=>e(null),children:""})]}),u.jsxs("div",{className:"form-body",children:[u.jsx("div",{className:"parq-intro",children:u.jsx("p",{children:"The Physical Activity Readiness Questionnaire (PAR-Q) is designed to identify those who should check with a doctor before starting an exercise program."})}),u.jsxs("div",{className:"parq-questions",children:[u.jsx("div",{className:"parq-question",children:u.jsxs("label",{children:[u.jsx("input",{type:"checkbox",name:"q1HeartCondition",checked:j.q1HeartCondition,onChange:G}),u.jsx("span",{children:"Has your doctor ever said that you have a heart condition and that you should only do physical activity recommended by a doctor?"})]})}),u.jsx("div",{className:"parq-question",children:u.jsxs("label",{children:[u.jsx("input",{type:"checkbox",name:"q2ChestPain",checked:j.q2ChestPain,onChange:G}),u.jsx("span",{children:"Do you feel pain in your chest when you do physical activity?"})]})}),u.jsx("div",{className:"parq-question",children:u.jsxs("label",{children:[u.jsx("input",{type:"checkbox",name:"q3ChestPainLastMonth",checked:j.q3ChestPainLastMonth,onChange:G}),u.jsx("span",{children:"In the past month, have you had chest pain when you were not doing physical activity?"})]})}),u.jsx("div",{className:"parq-question",children:u.jsxs("label",{children:[u.jsx("input",{type:"checkbox",name:"q4Balance",checked:j.q4Balance,onChange:G}),u.jsx("span",{children:"Do you lose your balance because of dizziness or do you ever lose consciousness?"})]})}),u.jsx("div",{className:"parq-question",children:u.jsxs("label",{children:[u.jsx("input",{type:"checkbox",name:"q5BoneJoint",checked:j.q5BoneJoint,onChange:G}),u.jsx("span",{children:"Do you have a bone or joint problem that could be made worse by a change in your physical activity?"})]})}),u.jsx("div",{className:"parq-question",children:u.jsxs("label",{children:[u.jsx("input",{type:"checkbox",name:"q6BloodPressure",checked:j.q6BloodPressure,onChange:G}),u.jsx("span",{children:"Is your doctor currently prescribing drugs for your blood pressure or heart condition?"})]})}),u.jsx("div",{className:"parq-question",children:u.jsxs("label",{children:[u.jsx("input",{type:"checkbox",name:"q7OtherReason",checked:j.q7OtherReason,onChange:G}),u.jsx("span",{children:"Do you know of any other reason why you should not do physical activity?"})]})})]}),u.jsxs("div",{className:"form-group",children:[u.jsx("label",{children:"If you answered YES to any questions, please provide details:"}),u.jsx("textarea",{name:"additionalDetails",value:j.additionalDetails,onChange:G,placeholder:"Please explain any conditions or concerns...",rows:"4"})]}),u.jsx("div",{className:"parq-declaration",children:u.jsxs("label",{children:[u.jsx("input",{type:"checkbox",name:"declaration",checked:j.declaration,onChange:G}),u.jsx("span",{children:"I have read, understood and completed this questionnaire. Any questions I had were answered to my full satisfaction. I confirm that the information provided is accurate to the best of my knowledge."})]})}),u.jsxs("div",{className:"form-actions",children:[u.jsx("button",{className:"cancel-btn",onClick:()=>e(null),children:"Cancel"}),u.jsx("button",{className:"save-btn",onClick:ae,disabled:t,children:t?"Saving...":"Submit"})]})]})]}):u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"forms-intro",children:[u.jsx("h2",{children:"Forms"}),u.jsx("p",{children:"Please complete these forms to help us better understand your fitness journey and ensure your safety."})]}),u.jsxs("div",{className:"forms-list",children:[u.jsxs("div",{className:`form-card ${ne?"completed":""}`,children:[u.jsxs("div",{className:"form-card-info",children:[u.jsx("h3",{children:"Welcome Questionnaire"}),u.jsx("p",{children:"Tell us about your fitness goals, experience, and lifestyle."}),ne&&u.jsx("span",{className:"completed-badge",children:"Completed"})]}),u.jsx("button",{onClick:()=>e("welcome"),children:ne?"View / Edit":"Start"})]}),u.jsxs("div",{className:`form-card ${ue?"completed":""}`,children:[u.jsxs("div",{className:"form-card-info",children:[u.jsx("h3",{children:"PAR-Q Health Screening"}),u.jsx("p",{children:"Physical Activity Readiness Questionnaire for your safety."}),ue&&u.jsx("span",{className:"completed-badge",children:"Completed"})]}),u.jsx("button",{onClick:()=>e("parq"),children:ue?"View / Edit":"Start"})]})]})]})]})]})}function X8(){const{currentUser:i,isClient:e,clientData:t,loading:a}=Vi(),h=ai();return H.useEffect(()=>{!a&&(!i||!e)&&h("/")},[i,e,a,h]),a?u.jsx("div",{className:"client-loading",children:"Loading..."}):!i||!e||!t?null:u.jsxs("div",{className:"client-tools-page",children:[u.jsx("header",{className:"client-header",children:u.jsx("div",{className:"header-content",children:u.jsx("img",{src:"/Logo.PNG",alt:"Mind Core Fitness",className:"header-logo"})})}),u.jsxs("main",{className:"tools-main page-transition-enter",children:[u.jsx("button",{className:"back-btn",onClick:()=>h("/client"),children:" Back"}),u.jsxs("div",{className:"tools-intro",children:[u.jsx("h2",{children:"Tools"}),u.jsx("p",{children:"Use these tools to help plan your nutrition and stay motivated."})]}),u.jsxs("div",{className:"tools-grid",children:[u.jsxs("div",{className:"tool-select-card",onClick:()=>h("/client/tools/macros"),children:[u.jsx("div",{className:"tool-select-icon",children:u.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[u.jsx("path",{d:"M4 6h16M4 12h16M4 18h7"}),u.jsx("circle",{cx:"17",cy:"18",r:"3"}),u.jsx("path",{d:"M17 15v6M14 18h6"})]})}),u.jsxs("div",{className:"tool-select-info",children:[u.jsx("h3",{children:"Macro Calculator"}),u.jsx("p",{children:"Calculate your daily calorie and macro targets based on your goals."})]}),u.jsx("svg",{className:"tool-select-arrow",viewBox:"0 0 24 24",fill:"currentColor",children:u.jsx("path",{d:"M8.59 16.59L10 18l6-6-6-6-1.41 1.41L13.17 12z"})})]}),u.jsxs("div",{className:"tool-select-card",onClick:()=>h("/client/tools/snacks"),children:[u.jsx("div",{className:"tool-select-icon snack-icon",children:u.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[u.jsx("path",{d:"M18 8h1a4 4 0 010 8h-1"}),u.jsx("path",{d:"M2 8h16v9a4 4 0 01-4 4H6a4 4 0 01-4-4V8z"}),u.jsx("line",{x1:"6",y1:"1",x2:"6",y2:"4"}),u.jsx("line",{x1:"10",y1:"1",x2:"10",y2:"4"}),u.jsx("line",{x1:"14",y1:"1",x2:"14",y2:"4"})]})}),u.jsxs("div",{className:"tool-select-info",children:[u.jsx("h3",{children:"Protein Snack Generator"}),u.jsx("p",{children:"Quick, easy high-protein snack ideas to fuel your training."})]}),u.jsx("svg",{className:"tool-select-arrow",viewBox:"0 0 24 24",fill:"currentColor",children:u.jsx("path",{d:"M8.59 16.59L10 18l6-6-6-6-1.41 1.41L13.17 12z"})})]}),u.jsxs("div",{className:"tool-select-card",onClick:()=>h("/client/tools/motivation"),children:[u.jsx("div",{className:"tool-select-icon quote-icon",children:u.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:u.jsx("path",{d:"M12 2L15.09 8.26L22 9.27L17 14.14L18.18 21.02L12 17.77L5.82 21.02L7 14.14L2 9.27L8.91 8.26L12 2Z"})})}),u.jsxs("div",{className:"tool-select-info",children:[u.jsx("h3",{children:"Daily Motivation"}),u.jsx("p",{children:"Get your daily dose of inspiration to keep you on track."})]}),u.jsx("svg",{className:"tool-select-arrow",viewBox:"0 0 24 24",fill:"currentColor",children:u.jsx("path",{d:"M8.59 16.59L10 18l6-6-6-6-1.41 1.41L13.17 12z"})})]})]})]})]})}function K8(){const{currentUser:i,isClient:e,clientData:t,loading:a}=Vi(),h=ai(),[f,y]=H.useState({gender:"male",age:"",weight:"",weightUnit:"kg",height:"",heightUnit:"cm",heightFeet:"",heightInches:"",activityLevel:"moderate",goal:"maintain",deficitLevel:"moderate"}),[A,C]=H.useState(null),[E,S]=H.useState(!1);H.useEffect(()=>{!a&&(!i||!e)&&h("/")},[i,e,a,h]);const I=G=>{const{name:J,value:ae}=G.target;y(ne=>({...ne,[J]:ae})),S(!1)},j=()=>{let G=parseFloat(f.weight);f.weightUnit==="lbs"&&(G=G*.453592);let J;if(f.heightUnit==="cm")J=parseFloat(f.height);else{const me=parseFloat(f.heightFeet)||0,te=parseFloat(f.heightInches)||0;J=me*30.48+te*2.54}const ae=parseInt(f.age);let ne;f.gender==="male"?ne=10*G+6.25*J-5*ae+5:ne=10*G+6.25*J-5*ae-161;const be=ne*{sedentary:1.2,light:1.375,moderate:1.55,active:1.725,veryActive:1.9}[f.activityLevel];let Me=be,Ce,P;switch(f.goal){case"lose":Me=be-{light:250,moderate:500,harsh:750}[f.deficitLevel],Ce=2.2,P=.3;break;case"build":Me=be+300,Ce=2,P=.22;break;default:Ce=1.8,P=.25;break}const F=f.gender==="male"?1500:1200;Me=Math.max(Me,F);const B=Math.round(G*Ce),se=B*4,Z=Me*P,Q=Math.round(Z/9),z=Me-se-Z,Ye=Math.max(0,Math.round(z/4));C({bmr:Math.round(ne),tdee:Math.round(be),targetCalories:Math.round(Me),protein:B,carbs:Ye,fats:Q,proteinCalories:Math.round(se),carbCalories:Math.round(z),fatCalories:Math.round(Z)}),S(!0)},Y=()=>{const G=f.weight&&parseFloat(f.weight)>0,J=f.age&&parseInt(f.age)>0;let ae;return f.heightUnit==="cm"?ae=f.height&&parseFloat(f.height)>0:ae=f.heightFeet&&parseFloat(f.heightFeet)>0||f.heightInches&&parseFloat(f.heightInches)>0,G&&J&&ae},X=()=>{switch(f.goal){case"lose":return"Weight Loss";case"build":return"Muscle Building";default:return"Maintenance"}};return a?u.jsx("div",{className:"client-loading",children:"Loading..."}):!i||!e||!t?null:u.jsxs("div",{className:"client-tools-page",children:[u.jsx("header",{className:"client-header",children:u.jsx("div",{className:"header-content",children:u.jsx("img",{src:"/Logo.PNG",alt:"Mind Core Fitness",className:"header-logo"})})}),u.jsxs("main",{className:"tools-main page-transition-enter",children:[u.jsx("button",{className:"back-btn",onClick:()=>h("/client/tools"),children:" Back to Tools"}),u.jsxs("div",{className:"tool-card",children:[u.jsxs("div",{className:"tool-header",children:[u.jsx("h3",{children:"Macro Calculator"}),u.jsx("p",{children:"Calculate your daily calorie and macro targets based on your goals."})]}),u.jsxs("div",{className:"calculator-form",children:[u.jsxs("div",{className:"form-row",children:[u.jsxs("div",{className:"form-group",children:[u.jsx("label",{children:"Gender"}),u.jsxs("div",{className:"toggle-group",children:[u.jsx("button",{type:"button",className:f.gender==="male"?"active":"",onClick:()=>{y(G=>({...G,gender:"male"})),S(!1)},children:"Male"}),u.jsx("button",{type:"button",className:f.gender==="female"?"active":"",onClick:()=>{y(G=>({...G,gender:"female"})),S(!1)},children:"Female"})]})]}),u.jsxs("div",{className:"form-group",children:[u.jsx("label",{children:"Age"}),u.jsx("input",{type:"number",name:"age",value:f.age,onChange:I,placeholder:"Years",min:"15",max:"100"})]})]}),u.jsxs("div",{className:"form-row",children:[u.jsxs("div",{className:"form-group",children:[u.jsx("label",{children:"Weight"}),u.jsxs("div",{className:"input-with-unit",children:[u.jsx("input",{type:"number",name:"weight",value:f.weight,onChange:I,placeholder:f.weightUnit==="kg"?"kg":"lbs",min:"30",max:"300"}),u.jsxs("div",{className:"unit-toggle",children:[u.jsx("button",{type:"button",className:f.weightUnit==="kg"?"active":"",onClick:()=>{y(G=>({...G,weightUnit:"kg"})),S(!1)},children:"kg"}),u.jsx("button",{type:"button",className:f.weightUnit==="lbs"?"active":"",onClick:()=>{y(G=>({...G,weightUnit:"lbs"})),S(!1)},children:"lbs"})]})]})]}),u.jsxs("div",{className:"form-group",children:[u.jsx("label",{children:"Height"}),u.jsxs("div",{className:"input-with-unit",children:[f.heightUnit==="cm"?u.jsx("input",{type:"number",name:"height",value:f.height,onChange:I,placeholder:"cm",min:"100",max:"250"}):u.jsxs("div",{className:"height-imperial",children:[u.jsx("input",{type:"number",name:"heightFeet",value:f.heightFeet,onChange:I,placeholder:"ft",min:"4",max:"7"}),u.jsx("input",{type:"number",name:"heightInches",value:f.heightInches,onChange:I,placeholder:"in",min:"0",max:"11"})]}),u.jsxs("div",{className:"unit-toggle",children:[u.jsx("button",{type:"button",className:f.heightUnit==="cm"?"active":"",onClick:()=>{y(G=>({...G,heightUnit:"cm"})),S(!1)},children:"cm"}),u.jsx("button",{type:"button",className:f.heightUnit==="ft"?"active":"",onClick:()=>{y(G=>({...G,heightUnit:"ft"})),S(!1)},children:"ft/in"})]})]})]})]}),u.jsxs("div",{className:"form-group full-width",children:[u.jsx("label",{children:"Activity Level"}),u.jsxs("select",{name:"activityLevel",value:f.activityLevel,onChange:I,children:[u.jsx("option",{value:"sedentary",children:"Sedentary (little to no exercise)"}),u.jsx("option",{value:"light",children:"Lightly Active (1-3 days/week)"}),u.jsx("option",{value:"moderate",children:"Moderately Active (3-5 days/week)"}),u.jsx("option",{value:"active",children:"Very Active (6-7 days/week)"}),u.jsx("option",{value:"veryActive",children:"Extra Active (athlete/physical job)"})]})]}),u.jsxs("div",{className:"form-group full-width",children:[u.jsx("label",{children:"Fitness Goal"}),u.jsxs("div",{className:"goal-options",children:[u.jsxs("button",{type:"button",className:`goal-btn ${f.goal==="lose"?"active":""}`,onClick:()=>{y(G=>({...G,goal:"lose"})),S(!1)},children:[u.jsx("span",{className:"goal-icon",children:"-"}),u.jsx("span",{children:"Lose Weight"})]}),u.jsxs("button",{type:"button",className:`goal-btn ${f.goal==="maintain"?"active":""}`,onClick:()=>{y(G=>({...G,goal:"maintain"})),S(!1)},children:[u.jsx("span",{className:"goal-icon",children:"="}),u.jsx("span",{children:"Maintain"})]}),u.jsxs("button",{type:"button",className:`goal-btn ${f.goal==="build"?"active":""}`,onClick:()=>{y(G=>({...G,goal:"build"})),S(!1)},children:[u.jsx("span",{className:"goal-icon",children:"+"}),u.jsx("span",{children:"Build Muscle"})]})]})]}),f.goal==="lose"&&u.jsxs("div",{className:"form-group full-width deficit-section",children:[u.jsx("label",{children:"Calorie Deficit Level"}),u.jsxs("div",{className:"deficit-options",children:[u.jsxs("button",{type:"button",className:`deficit-btn ${f.deficitLevel==="light"?"active":""}`,onClick:()=>{y(G=>({...G,deficitLevel:"light"})),S(!1)},children:[u.jsx("span",{className:"deficit-name",children:"Light"}),u.jsx("span",{className:"deficit-desc",children:"-250 cal/day"}),u.jsx("span",{className:"deficit-rate",children:"~0.5 lb/week"})]}),u.jsxs("button",{type:"button",className:`deficit-btn ${f.deficitLevel==="moderate"?"active":""}`,onClick:()=>{y(G=>({...G,deficitLevel:"moderate"})),S(!1)},children:[u.jsx("span",{className:"deficit-name",children:"Moderate"}),u.jsx("span",{className:"deficit-desc",children:"-500 cal/day"}),u.jsx("span",{className:"deficit-rate",children:"~1 lb/week"})]}),u.jsxs("button",{type:"button",className:`deficit-btn ${f.deficitLevel==="harsh"?"active":""}`,onClick:()=>{y(G=>({...G,deficitLevel:"harsh"})),S(!1)},children:[u.jsx("span",{className:"deficit-name",children:"Aggressive"}),u.jsx("span",{className:"deficit-desc",children:"-750 cal/day"}),u.jsx("span",{className:"deficit-rate",children:"~1.5 lb/week"})]})]})]}),u.jsx("button",{className:"calculate-btn",onClick:j,disabled:!Y(),children:"Calculate Macros"})]}),E&&A&&(()=>{const G=A.proteinCalories+A.carbCalories+A.fatCalories,J=Math.round(A.proteinCalories/G*100),ae=Math.round(A.carbCalories/G*100),ne=100-J-ae;return u.jsxs("div",{className:"results-section",children:[u.jsxs("div",{className:"results-header",children:[u.jsx("h4",{children:"Your Daily Targets"}),u.jsx("span",{className:"goal-badge",children:X()})]}),u.jsxs("div",{className:"calories-display",children:[u.jsx("span",{className:"calories-value",children:A.targetCalories}),u.jsx("span",{className:"calories-label",children:"calories/day"})]}),u.jsxs("div",{className:"macro-percentage-bar",children:[u.jsxs("div",{className:"macro-bar-track",children:[u.jsx("div",{className:"macro-bar-segment protein",style:{width:`${J}%`},children:J>=12&&u.jsxs("span",{children:[J,"%"]})}),u.jsx("div",{className:"macro-bar-segment carbs",style:{width:`${ae}%`},children:ae>=12&&u.jsxs("span",{children:[ae,"%"]})}),u.jsx("div",{className:"macro-bar-segment fats",style:{width:`${ne}%`},children:ne>=12&&u.jsxs("span",{children:[ne,"%"]})})]}),u.jsxs("div",{className:"macro-bar-legend",children:[u.jsxs("div",{className:"legend-item",children:[u.jsx("span",{className:"legend-dot protein"}),"Protein ",J,"%"]}),u.jsxs("div",{className:"legend-item",children:[u.jsx("span",{className:"legend-dot carbs"}),"Carbs ",ae,"%"]}),u.jsxs("div",{className:"legend-item",children:[u.jsx("span",{className:"legend-dot fats"}),"Fats ",ne,"%"]})]})]}),u.jsxs("div",{className:"macros-grid",children:[u.jsxs("div",{className:"macro-card protein",style:{animationDelay:"0.1s"},children:[u.jsxs("div",{className:"macro-value",children:[A.protein,"g"]}),u.jsx("div",{className:"macro-label",children:"Protein"}),u.jsxs("div",{className:"macro-calories",children:[A.proteinCalories," cal"]})]}),u.jsxs("div",{className:"macro-card carbs",style:{animationDelay:"0.2s"},children:[u.jsxs("div",{className:"macro-value",children:[A.carbs,"g"]}),u.jsx("div",{className:"macro-label",children:"Carbs"}),u.jsxs("div",{className:"macro-calories",children:[A.carbCalories," cal"]})]}),u.jsxs("div",{className:"macro-card fats",style:{animationDelay:"0.3s"},children:[u.jsxs("div",{className:"macro-value",children:[A.fats,"g"]}),u.jsx("div",{className:"macro-label",children:"Fats"}),u.jsxs("div",{className:"macro-calories",children:[A.fatCalories," cal"]})]})]}),u.jsxs("div",{className:"results-info",children:[u.jsxs("div",{className:"info-row",children:[u.jsx("span",{children:"Basal Metabolic Rate (BMR)"}),u.jsxs("span",{className:"info-value",children:[A.bmr," cal"]})]}),u.jsxs("div",{className:"info-row",children:[u.jsx("span",{children:"Total Daily Energy Expenditure (TDEE)"}),u.jsxs("span",{className:"info-value",children:[A.tdee," cal"]})]})]}),u.jsx("div",{className:"results-note",children:u.jsx("p",{children:"These are estimated values. Individual results may vary based on metabolism, body composition, and other factors. Consult with your trainer for personalized guidance."})})]})})()]})]})]})}const Tv=[{name:"Greek Yoghurt & Honey",protein:20,calories:180,prep:0,category:"no-prep",instructions:"Grab a pot of Greek yoghurt, drizzle with honey. Done. Go for full-fat or 0% depending on your macros."},{name:"Protein Bar",protein:20,calories:220,prep:0,category:"no-prep",instructions:"Unwrap and eat. Keep one in your bag for emergencies. Look for bars with 20g+ protein and under 5g sugar."},{name:"Beef Jerky",protein:15,calories:120,prep:0,category:"no-prep",instructions:"Open the pack and snack. Great for on the go. Check the label  some brands are loaded with sugar."},{name:"Handful of Almonds",protein:7,calories:170,prep:0,category:"no-prep",instructions:"Grab about 30g (roughly 23 almonds). Good fats and protein. Keep a bag at your desk or in your car."},{name:"Boiled Eggs (x2)",protein:12,calories:140,prep:0,category:"no-prep",instructions:"Batch boil at the start of the week  10 mins in boiling water, cool in ice water, peel and store in the fridge. Grab 2 when you need them."},{name:"String Cheese (x2)",protein:14,calories:160,prep:0,category:"no-prep",instructions:"Peel and eat. Keep a few in the fridge for quick grabs. Pair with some fruit if you want extra carbs."},{name:"Cottage Cheese Pot",protein:14,calories:110,prep:0,category:"no-prep",instructions:"Eat straight from the pot. Add a pinch of salt and pepper, or keep it sweet with a drizzle of honey."},{name:"Edamame Beans",protein:11,calories:120,prep:0,category:"no-prep",instructions:"Buy pre-cooked and shelled from the supermarket. Sprinkle with sea salt or chilli flakes. Eat cold or warm in the microwave for 1 min."},{name:"Turkey Slices (50g)",protein:12,calories:60,prep:0,category:"no-prep",instructions:"Straight from the pack. Roll up a few slices on their own or wrap around some cheese for extra protein."},{name:"Roasted Chickpeas",protein:10,calories:160,prep:0,category:"no-prep",instructions:"Buy a bag of roasted chickpeas or make a batch: drain tinned chickpeas, toss in oil and spices, roast at 200C for 25 mins. Store in a jar."},{name:"Protein Shake & Banana",protein:30,calories:280,prep:1,category:"quick",instructions:"Add one scoop of protein powder to 300ml water or milk in a shaker. Shake for 10 seconds. Eat a banana on the side."},{name:"Peanut Butter on Rice Cakes",protein:14,calories:260,prep:1,category:"quick",instructions:"Spread 1-2 tablespoons of peanut butter across 2 rice cakes. Top with sliced banana or a drizzle of honey if you want."},{name:"Greek Yoghurt & Granola",protein:22,calories:300,prep:1,category:"quick",instructions:"Scoop Greek yoghurt into a bowl. Top with a handful of granola and some berries. Use high-protein granola if you can find it."},{name:"Turkey & Cream Cheese Roll-Ups",protein:18,calories:180,prep:2,category:"quick",instructions:"Lay out 3-4 turkey slices. Spread a thin layer of cream cheese on each. Roll them up. Add cucumber or spinach inside for crunch."},{name:"Cottage Cheese & Pineapple",protein:15,calories:160,prep:1,category:"quick",instructions:"Scoop cottage cheese into a bowl, top with tinned or fresh pineapple chunks. The sweet and savoury combo works surprisingly well."},{name:"Ham & Cheese Wrap",protein:22,calories:320,prep:2,category:"quick",instructions:"Lay a tortilla flat. Add 2-3 ham slices and a slice of cheese. Add lettuce or spinach if you have it. Roll up tight and eat."},{name:"Tuna & Crackers",protein:20,calories:220,prep:2,category:"quick",instructions:"Drain a small tin of tuna, mix with a squeeze of lemon and black pepper. Spoon onto 4-5 crackers. Add hot sauce if you like it."},{name:"Protein Yoghurt Bowl",protein:25,calories:250,prep:1,category:"quick",instructions:"Mix a scoop of protein powder into Greek yoghurt until smooth. Top with berries, nuts, or a drizzle of honey."},{name:"Hummus & Veggie Sticks",protein:8,calories:180,prep:1,category:"quick",instructions:"Grab a pot of hummus and chop up carrots, cucumber, and peppers into sticks. Dip and eat. Simple."},{name:"Chocolate Milk (500ml)",protein:17,calories:340,prep:1,category:"quick",instructions:"Pour 500ml milk, stir in 2 tablespoons of chocolate protein powder or cocoa. Great post-workout  the carbs help recovery."},{name:"Peanut Butter & Apple Slices",protein:10,calories:250,prep:1,category:"quick",instructions:"Slice an apple into wedges. Dip into 1-2 tablespoons of peanut butter. Sweet, crunchy, and filling."},{name:"Overnight Oats (pre-made)",protein:18,calories:310,prep:1,category:"quick",instructions:"Prep the night before: mix 50g oats, 1 scoop protein powder, 150ml milk, and a handful of berries in a jar. Refrigerate overnight. Grab and eat cold."},{name:"Smoked Salmon on Crackers",protein:16,calories:200,prep:2,category:"quick",instructions:"Lay out 4-5 crackers. Top each with a slice of smoked salmon and a small squeeze of lemon. Add cream cheese if you want extra."},{name:"Protein Smoothie Bowl",protein:28,calories:350,prep:2,category:"quick",instructions:"Blend 1 scoop protein powder, 1 frozen banana, and a splash of milk until thick. Pour into a bowl. Top with granola, berries, and seeds."},{name:"Almond Butter & Banana Toast",protein:12,calories:280,prep:2,category:"quick",instructions:"Toast a slice of wholemeal bread. Spread with almond butter. Slice half a banana on top. Sprinkle with cinnamon."},{name:"Scrambled Eggs on Toast",protein:22,calories:320,prep:4,category:"cook",instructions:"Crack 3 eggs into a pan on medium-low heat. Stir continuously with a spatula until just set  keep them soft. Season with salt and pepper, serve on wholemeal toast."},{name:"Protein Pancake Mug Cake",protein:25,calories:280,prep:3,category:"cook",instructions:"Mix 1 scoop protein powder, 1 egg, and 2 tablespoons of oats in a mug. Microwave for 90 seconds. Top with peanut butter or berries."},{name:"Tuna Mayo on Toast",protein:24,calories:340,prep:3,category:"cook",instructions:"Drain a tin of tuna, mix with 1 tablespoon of light mayo, salt, pepper, and a squeeze of lemon. Toast 2 slices of bread. Pile the tuna on top."},{name:"Egg & Cheese Muffin",protein:18,calories:300,prep:4,category:"cook",instructions:"Fry or microwave an egg. Toast an English muffin. Layer the egg with a slice of cheese and optionally a slice of ham. Press together."},{name:"Chicken Quesadilla",protein:26,calories:380,prep:5,category:"cook",instructions:"Use leftover chicken or pre-cooked slices. Lay a tortilla in a dry pan on medium heat. Add chicken and grated cheese on one half. Fold over, cook 2 mins each side until golden and melted."},{name:"Beans on Toast",protein:16,calories:340,prep:3,category:"cook",instructions:"Heat a tin of baked beans in the microwave for 2 mins, stirring halfway. Toast 2 slices of wholemeal bread. Pour beans on top. Add grated cheese for extra protein."},{name:"Omelette (2 eggs)",protein:14,calories:180,prep:4,category:"cook",instructions:"Beat 2 eggs with salt and pepper. Pour into a hot, lightly oiled pan. Swirl to cover the base. Add fillings (cheese, ham, peppers) when the edges set. Fold in half and serve."},{name:"Protein Porridge",protein:28,calories:380,prep:4,category:"cook",instructions:"Cook 50g oats with 250ml milk in a pan or microwave (3 mins). Stir in 1 scoop of protein powder once it cools slightly. Top with banana and a drizzle of honey."},{name:"Cheese Toastie",protein:16,calories:350,prep:3,category:"cook",instructions:"Butter the outside of 2 slices of bread. Place cheese (and ham if you have it) between the unbuttered sides. Cook in a dry pan on medium heat, 2 mins each side until golden."},{name:"Egg Fried Rice (leftover rice)",protein:16,calories:360,prep:5,category:"cook",instructions:"Heat a splash of oil in a pan on high heat. Add leftover cold rice and stir-fry for 2 mins. Push to one side, crack in 2 eggs and scramble. Mix together, add soy sauce to taste."}];function Q8(){const{currentUser:i,isClient:e,clientData:t,loading:a}=Vi(),h=ai(),[f,y]=H.useState(null),[A,C]=H.useState("all"),[E,S]=H.useState(!1),I=H.useRef([]);H.useEffect(()=>{!a&&(!i||!e)&&h("/")},[i,e,a,h]);const j=J=>{const ae=[...J];for(let ne=ae.length-1;ne>0;ne--){const ue=Math.floor(Math.random()*(ne+1));[ae[ne],ae[ue]]=[ae[ue],ae[ne]]}return ae},Y=()=>{const J=A==="all"?Tv:Tv.filter(ae=>ae.category===A);I.current.length===0&&(I.current=j(J)),S(!0),setTimeout(()=>{const ae=I.current.pop();y(ae),S(!1)},300)},X=J=>J===0?"No prep":`${J} min`,G=J=>{switch(J){case"no-prep":return"Grab & Go";case"quick":return"Quick Prep";case"cook":return"Light Cook";default:return J}};return a?u.jsx("div",{className:"client-loading",children:"Loading..."}):!i||!e||!t?null:u.jsxs("div",{className:"client-tools-page",children:[u.jsx("header",{className:"client-header",children:u.jsx("div",{className:"header-content",children:u.jsx("img",{src:"/Logo.PNG",alt:"Mind Core Fitness",className:"header-logo"})})}),u.jsxs("main",{className:"tools-main page-transition-enter",children:[u.jsx("button",{className:"back-btn",onClick:()=>h("/client/tools"),children:" Back to Tools"}),u.jsxs("div",{className:"tool-card",children:[u.jsxs("div",{className:"tool-header",children:[u.jsx("h3",{children:"Protein Snack Generator"}),u.jsx("p",{children:"Quick, easy high-protein snack ideas to fuel your training."})]}),u.jsxs("div",{className:"snack-generator",children:[u.jsx("div",{className:"snack-filters",children:[{value:"all",label:"All"},{value:"no-prep",label:"Grab & Go"},{value:"quick",label:"Quick Prep"},{value:"cook",label:"Light Cook"}].map(J=>u.jsx("button",{className:`snack-filter-btn ${A===J.value?"active":""}`,onClick:()=>{C(J.value),y(null),I.current=[]},children:J.label},J.value))}),f&&!E&&u.jsxs("div",{className:"snack-result",children:[u.jsx("div",{className:"snack-name",children:f.name}),u.jsxs("div",{className:"snack-details",children:[u.jsxs("div",{className:"snack-detail",children:[u.jsxs("span",{className:"snack-detail-value",children:[f.protein,"g"]}),u.jsx("span",{className:"snack-detail-label",children:"Protein"})]}),u.jsxs("div",{className:"snack-detail",children:[u.jsx("span",{className:"snack-detail-value",children:f.calories}),u.jsx("span",{className:"snack-detail-label",children:"Calories"})]}),u.jsxs("div",{className:"snack-detail",children:[u.jsx("span",{className:"snack-detail-value",children:X(f.prep)}),u.jsx("span",{className:"snack-detail-label",children:"Prep Time"})]})]}),u.jsxs("div",{className:"snack-prep-indicator",children:[u.jsx("div",{className:`prep-dot ${f.category==="no-prep"||f.category==="quick"||f.category==="cook"?"active":""}`}),u.jsx("div",{className:`prep-dot ${f.category==="quick"||f.category==="cook"?"active":""}`}),u.jsx("div",{className:`prep-dot ${f.category==="cook"?"active":""}`}),u.jsx("span",{className:"prep-indicator-label",children:G(f.category)})]}),u.jsxs("div",{className:"snack-instructions",children:[u.jsx("div",{className:"snack-instructions-label",children:"How to make it"}),u.jsx("p",{children:f.instructions})]})]}),E&&u.jsx("div",{className:"snack-result shuffling",children:u.jsx("div",{className:"snack-shuffle-icon",children:u.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:u.jsx("path",{d:"M16 3h5v5M4 20L21 3M21 16v5h-5M15 15l6 6M4 4l5 5"})})})}),u.jsx("button",{className:"snack-generate-btn",onClick:Y,children:f?"Give Me Another":"Give Me a Snack"})]})]})]})]})}const B0=[{text:"The only bad workout is the one that didn't happen.",author:"Unknown"},{text:"Your body can stand almost anything. It's your mind that you have to convince.",author:"Unknown"},{text:"Discipline is choosing between what you want now and what you want most.",author:"Abraham Lincoln"},{text:"The pain you feel today will be the strength you feel tomorrow.",author:"Unknown"},{text:"Don't wish for it. Work for it.",author:"Unknown"},{text:"Success isn't always about greatness. It's about consistency.",author:"Dwayne Johnson"},{text:"The harder you work, the luckier you get.",author:"Gary Player"},{text:"Fall seven times, stand up eight.",author:"Japanese Proverb"},{text:"What seems impossible today will one day become your warm-up.",author:"Unknown"},{text:"You don't have to be extreme, just consistent.",author:"Unknown"},{text:"Strength does not come from the body. It comes from the will.",author:"Unknown"},{text:"The only way to define your limits is by going beyond them.",author:"Arthur C. Clarke"},{text:"Motivation gets you started. Habit keeps you going.",author:"Jim Ryun"},{text:"If it doesn't challenge you, it doesn't change you.",author:"Fred DeVito"},{text:"Progress, not perfection.",author:"Unknown"},{text:"The best project you'll ever work on is you.",author:"Unknown"},{text:"A year from now you'll wish you had started today.",author:"Karen Lamb"},{text:"You are one workout away from a good mood.",author:"Unknown"},{text:"Push yourself, because no one else is going to do it for you.",author:"Unknown"},{text:"The body achieves what the mind believes.",author:"Unknown"},{text:"Small daily improvements are the key to staggering long-term results.",author:"Unknown"},{text:"It's not about having time. It's about making time.",author:"Unknown"},{text:"Sore today, strong tomorrow.",author:"Unknown"},{text:"Champions keep playing until they get it right.",author:"Billie Jean King"},{text:"Be stronger than your excuses.",author:"Unknown"},{text:"When you feel like quitting, think about why you started.",author:"Unknown"},{text:"The difference between try and triumph is a little umph.",author:"Marvin Phillips"},{text:"Your only limit is you.",author:"Unknown"},{text:"Believe you can and you're halfway there.",author:"Theodore Roosevelt"},{text:"Making excuses burns zero calories per hour.",author:"Unknown"},{text:"Results happen over time, not overnight. Work hard, stay consistent, and be patient.",author:"Unknown"},{text:"You don't find willpower, you create it.",author:"Unknown"},{text:"Wake up with determination. Go to bed with satisfaction.",author:"Unknown"},{text:"Sweat is just fat crying.",author:"Unknown"},{text:"Today I will do what others won't, so tomorrow I can do what others can't.",author:"Jerry Rice"},{text:"The only person you are destined to become is the person you decide to be.",author:"Ralph Waldo Emerson"},{text:"Don't count the days, make the days count.",author:"Muhammad Ali"},{text:"It never gets easier, you just get stronger.",author:"Unknown"},{text:"Suffer the pain of discipline or suffer the pain of regret.",author:"Jim Rohn"},{text:"Strive for progress, not perfection.",author:"Unknown"},{text:"Your health is an investment, not an expense.",author:"Unknown"},{text:"Action is the foundational key to all success.",author:"Pablo Picasso"},{text:"Good things come to those who sweat.",author:"Unknown"},{text:"The secret of getting ahead is getting started.",author:"Mark Twain"},{text:"No matter how slow you go, you're still lapping everyone on the couch.",author:"Unknown"},{text:"Train insane or remain the same.",author:"Unknown"},{text:"The hardest step is the first one out the door.",author:"Unknown"},{text:"Work hard in silence, let your results be the noise.",author:"Frank Ocean"},{text:"Every champion was once a contender who refused to give up.",author:"Rocky Balboa"},{text:"Take care of your body. It's the only place you have to live.",author:"Jim Rohn"},{text:"Energy and persistence conquer all things.",author:"Benjamin Franklin"},{text:"The mind is the most important muscle.",author:"Unknown"},{text:"You are stronger than you think.",author:"Unknown"},{text:"Obsessed is a word the lazy use to describe the dedicated.",author:"Unknown"},{text:"The only weight you need to lose is the weight of your doubts.",author:"Unknown"}];function Z8(){const{currentUser:i,isClient:e,clientData:t,loading:a}=Vi(),h=ai(),[f,y]=H.useState(null),[A,C]=H.useState(!0),[E,S]=H.useState(!1);H.useEffect(()=>{!a&&(!i||!e)&&h("/")},[i,e,a,h]),H.useEffect(()=>{t&&I()},[t]);const I=async()=>{try{const Y=new Date().toISOString().split("T")[0],X=Ft(nt,"clients",t.id),G=await Bo(X);if(G.exists()){const J=G.data();J.dailyQuote&&J.dailyQuote.date===Y&&y(J.dailyQuote)}}catch(Y){console.error("Error loading daily quote:",Y)}C(!1)},j=async()=>{if(f)return;S(!0);const Y=new Date().toISOString().split("T")[0];let X=[];try{const be=await Bo(Ft(nt,"clients",t.id));be.exists()&&(X=be.data().quoteUsedIndices||[])}catch{}X.length>=B0.length&&(X=[]);const G=B0.map((be,Me)=>Me).filter(be=>!X.includes(be)),J=Math.floor(Math.random()*G.length),ae=G[J],ne=B0[ae],ue={text:ne.text,author:ne.author,date:Y};try{await Ia(Ft(nt,"clients",t.id),{dailyQuote:ue,quoteUsedIndices:[...X,ae]},{merge:!0}),setTimeout(()=>{y(ue),S(!1)},300)}catch(be){console.error("Error saving daily quote:",be),S(!1)}};return a?u.jsx("div",{className:"client-loading",children:"Loading..."}):!i||!e||!t?null:u.jsxs("div",{className:"client-tools-page",children:[u.jsx("header",{className:"client-header",children:u.jsx("div",{className:"header-content",children:u.jsx("img",{src:"/Logo.PNG",alt:"Mind Core Fitness",className:"header-logo"})})}),u.jsxs("main",{className:"tools-main page-transition-enter",children:[u.jsx("button",{className:"back-btn",onClick:()=>h("/client/tools"),children:" Back to Tools"}),u.jsxs("div",{className:"tool-card",children:[u.jsxs("div",{className:"tool-header",children:[u.jsx("h3",{children:"Daily Motivation"}),u.jsx("p",{children:"Get your daily dose of inspiration to keep you on track."})]}),u.jsxs("div",{className:"quote-generator",children:[A?u.jsxs("div",{className:"quote-skeleton",children:[u.jsx("div",{className:"skeleton-icon"}),u.jsx("div",{className:"skeleton-line long"}),u.jsx("div",{className:"skeleton-line medium"}),u.jsx("div",{className:"skeleton-line short"})]}):f?u.jsxs("div",{className:"quote-result",children:[u.jsx("div",{className:"quote-icon",children:u.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:u.jsx("path",{d:"M6 17h3l2-4V7H5v6h3zm8 0h3l2-4V7h-6v6h3z"})})}),u.jsx("div",{className:"quote-text",children:f.text}),u.jsxs("div",{className:"quote-author",children:[" ",f.author]}),u.jsx("div",{className:"quote-date-note",children:"Your inspiration for today"})]}):E?u.jsx("div",{className:"quote-result shuffling",children:u.jsx("div",{className:"quote-shuffle-icon",children:u.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[u.jsx("circle",{cx:"12",cy:"12",r:"10"}),u.jsx("path",{d:"M12 6v6l4 2"})]})})}):u.jsxs("div",{className:"quote-empty",children:[u.jsx("div",{className:"quote-empty-graphic",children:u.jsxs("svg",{viewBox:"0 0 80 80",fill:"none",children:[u.jsx("circle",{cx:"40",cy:"40",r:"36",stroke:"var(--border-color)",strokeWidth:"2",strokeDasharray:"4 4"}),u.jsx("path",{d:"M28 48h8l4-8V28H24v12h8zm16 0h8l4-8V28H40v12h8z",fill:"var(--color-primary)",opacity:"0.2"}),u.jsx("path",{d:"M28 48h8l4-8V28H24v12h8zm16 0h8l4-8V28H40v12h8z",stroke:"var(--color-primary)",strokeWidth:"1.5"})]})}),u.jsx("h4",{className:"quote-empty-title",children:"Your Daily Inspiration"}),u.jsx("p",{children:"Tap below to reveal today's motivational quote  a new one every day to keep you going."})]}),!f&&!A&&u.jsx("button",{className:"quote-generate-btn",onClick:j,disabled:E,children:E?"Finding your quote...":"Get Inspired"})]})]})]})]})}const Nr=[{key:"chestPress",name:"Chest Press",category:"Upper Body - Push",unit:"weight"},{key:"shoulderPress",name:"Shoulder Press",category:"Upper Body - Push",unit:"weight"},{key:"seatedRow",name:"Seated Row",category:"Upper Body - Pull",unit:"weight"},{key:"latPulldown",name:"Lat Pulldown",category:"Upper Body - Pull",unit:"weight"},{key:"squat",name:"Squat",category:"Lower Body",unit:"weight"},{key:"deadlift",name:"Deadlift",category:"Lower Body",unit:"weight"},{key:"plank",name:"Plank",category:"Core",unit:"time"}],ul=[{key:"weight",name:"Weight",suffix:"kg"},{key:"chest",name:"Chest",suffix:"cm"},{key:"waist",name:"Waist",suffix:"cm"},{key:"hips",name:"Hips",suffix:"cm"},{key:"leftArm",name:"Left Arm",suffix:"cm"},{key:"rightArm",name:"Right Arm",suffix:"cm"},{key:"leftThigh",name:"Left Thigh",suffix:"cm"},{key:"rightThigh",name:"Right Thigh",suffix:"cm"}];function $8(){const i=new Date;return`${i.getFullYear()}-${String(i.getMonth()+1).padStart(2,"0")}`}function Ir(i){const[e,t]=i.split("-");return new Date(parseInt(e),parseInt(t)-1).toLocaleDateString("en-GB",{month:"long",year:"numeric"})}function pd(i){if(!i&&i!==0)return"-";const e=Math.floor(i/60),t=(i%60).toFixed(2);return e>0?`${e}m ${parseFloat(t).toFixed(0)}s`:`${parseFloat(t).toFixed(2)}s`}function Sv(i,e){return!i&&i!==0?"-":!e&&e!==0?`${i}kg`:`${i}kg x ${e}`}function tc(i,e){return e?i.unit==="time"?e.time||0:(e.weight||0)*(e.reps||0):0}function V0(i,e){return!e||e===0?null:(i-e)/e*100}function J8({data:i,exerciseKey:e,unit:t}){if(!i||i.length<2)return u.jsx("div",{className:"pb-trend-empty",children:u.jsx("p",{children:"Not enough data for trend line yet"})});const a=i.map(G=>{const J=G.benchmarks?.[e];return J?t==="time"?J.time||0:(J.weight||0)*(J.reps||0):0}),h=Math.max(...a),f=Math.min(...a),y=h-f||1,A=300,C=100,E=20,S=A-E*2,I=C-E*2,j=a.map((G,J)=>{const ae=E+J/(a.length-1)*S,ne=E+I-(G-f)/y*I;return{x:ae,y:ne,value:G}}),Y=j.map((G,J)=>`${J===0?"M":"L"} ${G.x} ${G.y}`).join(" "),X=Y+` L ${j[j.length-1].x} ${E+I} L ${j[0].x} ${E+I} Z`;return u.jsxs("div",{className:"pb-trend-chart",children:[u.jsxs("svg",{viewBox:`0 0 ${A} ${C}`,preserveAspectRatio:"xMidYMid meet",children:[u.jsx("defs",{children:u.jsxs("linearGradient",{id:"trendGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[u.jsx("stop",{offset:"0%",stopColor:"var(--color-primary)",stopOpacity:"0.3"}),u.jsx("stop",{offset:"100%",stopColor:"var(--color-primary)",stopOpacity:"0.02"})]})}),u.jsx("path",{d:X,fill:"url(#trendGradient)"}),u.jsx("path",{d:Y,fill:"none",stroke:"var(--color-primary)",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round"}),j.map((G,J)=>u.jsx("circle",{cx:G.x,cy:G.y,r:"4",fill:"var(--bg-card)",stroke:"var(--color-primary)",strokeWidth:"2"},J))]}),u.jsx("div",{className:"pb-trend-labels",children:i.map((G,J)=>u.jsxs("span",{className:"pb-trend-label",children:[G.month.split("-")[1],"/",G.month.split("-")[0].slice(2)]},J))})]})}function eR(){const[i,e]=H.useState("bests"),[t,a]=H.useState([]),[h,f]=H.useState(!0),[y,A]=H.useState(!1),[C,E]=H.useState(0),[S,I]=H.useState(!1),[j,Y]=H.useState(!1),[X,G]=H.useState(!1),[J,ae]=H.useState({}),[ne,ue]=H.useState({}),[be,Me]=H.useState({}),[Ce,P]=H.useState({}),[F,B]=H.useState({}),[se,Z]=H.useState(!1),[Q,z]=H.useState({}),[Ye,me]=H.useState([]),[te,ge]=H.useState(null),[He,Ne]=H.useState(null),[tt,L]=H.useState(!1),[oe,ce]=H.useState(""),[pe,ee]=H.useState(""),ie=H.useRef(null),Te=H.useRef(0),Pe=H.useRef(0),{currentUser:it,isClient:dt,clientData:Le,loading:qt}=Vi(),{isDark:wt}=Cl(),Zt=ai(),zt=H.useCallback((xe,Ue="info")=>{Ne({message:xe,type:Ue}),setTimeout(()=>Ne(null),4e3)},[]);H.useEffect(()=>{!qt&&(!it||!dt)&&Zt("/")},[it,dt,qt,Zt]),H.useEffect(()=>{Le&&Pt()},[Le]);const Pt=async()=>{try{const xe=kr(En(nt,"personalBests"),vr("clientId","==",Le.id)),Ze=(await Hn(xe)).docs.map(ft=>({id:ft.id,...ft.data()}));Ze.sort((ft,yt)=>ft.month.localeCompare(yt.month)),a(Ze);const $=kr(En(nt,"personalBestTargets"),vr("clientId","==",Le.id)),Oe=await Hn($);if(!Oe.empty){const ft=Oe.docs[0].data();Me(ft.targets||{}),P(ft.metricTargets||{}),B(ft.targets||{}),z(ft.metricTargets||{})}const Ke=kr(En(nt,"achievements"),vr("clientId","==",Le.id)),Re=await Hn(Ke);Re.empty||me(Re.docs[0].data().badges||[])}catch(xe){console.error("Error fetching personal bests:",xe)}f(!1)},st=$8(),mt=t.find(xe=>xe.month===st),at=t.filter(xe=>xe.month<st),kt=at.length>0?at[at.length-1]:null;H.useEffect(()=>{mt?(ae(mt.benchmarks||{}),ue(mt.bodyMetrics||{})):(ae({}),ue({}))},[mt?.id]);const de=async(xe,Ue)=>{const Ze=[];if(xe==="strength"?Nr.forEach($=>{const Oe=be[$.key];if(!Oe||!Oe.targetValue)return;const Ke=Ue[$.key];if(!Ke)return;let Re=0;Oe.targetType==="weight"?Re=Ke.weight||0:Oe.targetType==="reps"?Re=Ke.reps||0:Oe.targetType==="time"&&(Re=Ke.time||0);const ft=Oe.startValue||0,yt=Oe.targetValue,bt=yt-ft;if((bt===0?Re>=yt?1:0:Math.max(0,(Re-ft)/bt))>=1&&!Ye.some(Ps=>Ps.type==="strength"&&Ps.key===$.key&&Ps.targetValue===yt)){const Ps=Oe.targetType==="weight"?"kg":Oe.targetType==="reps"?" reps":"s";Ze.push({type:"strength",key:$.key,targetType:Oe.targetType,targetValue:yt,achievedMonth:st,label:`${$.name} ${yt}${Ps}`})}}):ul.forEach($=>{const Oe=Ce[$.key];if(!Oe||!Oe.targetValue)return;const Ke=Ue[$.key];if(Ke==null)return;const Re=Oe.startValue||0,ft=Oe.targetValue,yt=ft-Re;(yt===0?Ke===ft?1:0:Math.max(0,(Ke-Re)/yt))>=1&&(Ye.some(os=>os.type==="metric"&&os.key===$.key&&os.targetValue===ft)||Ze.push({type:"metric",key:$.key,targetValue:ft,achievedMonth:st,label:`${$.name} ${ft}${$.suffix}`}))}),Ze.length>0){const $=[...Ye,...Ze];await Ia(Ft(nt,"achievements",Le.id),{clientId:Le.id,badges:$,updatedAt:vt.now()}),me($),ge(Ze),setTimeout(()=>ge(null),5e3)}},et=(xe,Ue)=>{if(xe==="strength"){const Ze=be[Ue];return!Ze||!Ze.targetValue?!1:Ye.some($=>$.type==="strength"&&$.key===Ue&&$.targetValue===Ze.targetValue)}else{const Ze=Ce[Ue];return!Ze||!Ze.targetValue?!1:Ye.some($=>$.type==="metric"&&$.key===Ue&&$.targetValue===Ze.targetValue)}},Ot=async()=>{A(!0);try{const xe=`${Le.id}_${st}`,Ue=mt||{};await Ia(Ft(nt,"personalBests",xe),{clientId:Le.id,month:st,benchmarks:J,bodyMetrics:Ue.bodyMetrics||ne||{},createdAt:Ue.createdAt||vt.now(),updatedAt:vt.now()}),await de("strength",J),zt("Benchmarks saved!","success"),I(!1),await Pt()}catch(xe){console.error("Error saving benchmarks:",xe),zt("Failed to save. Please try again.","error")}A(!1)},ot=async()=>{A(!0);try{const xe=`${Le.id}_${st}`,Ue=mt||{};await Ia(Ft(nt,"personalBests",xe),{clientId:Le.id,month:st,benchmarks:Ue.benchmarks||J||{},bodyMetrics:ne,createdAt:Ue.createdAt||vt.now(),updatedAt:vt.now()}),await de("metric",ne),zt("Body metrics saved!","success"),Y(!1),await Pt()}catch(xe){console.error("Error saving metrics:",xe),zt("Failed to save. Please try again.","error")}A(!1)},xn=(xe,Ue,Ze)=>{ae($=>({...$,[xe]:{...$[xe],[Ue]:Ze===""?"":parseFloat(Ze)}}))},jn=(xe,Ue)=>{ue(Ze=>({...Ze,[xe]:Ue===""?"":parseFloat(Ue)}))},Zn=(xe,Ue,Ze)=>{B($=>({...$,[xe]:{...$[xe],[Ue]:Ue==="targetType"?Ze:Ze===""?"":parseFloat(Ze)}}))},Vn=async()=>{A(!0);try{const xe=`targets_${Le.id}`,Ue=mt?.benchmarks||{},Ze={};Nr.forEach($=>{if(F[$.key]?.targetValue){const Oe=F[$.key].targetType||($.unit==="time"?"time":"weight");let Ke=0;const Re=Ue[$.key];Re&&(Oe==="weight"?Ke=Re.weight||0:Oe==="reps"?Ke=Re.reps||0:Oe==="time"&&(Ke=Re.time||0)),Ze[$.key]={targetType:Oe,targetValue:F[$.key].targetValue,startValue:Ke}}}),await Ia(Ft(nt,"personalBestTargets",xe),{clientId:Le.id,targets:Ze,metricTargets:Ce,updatedAt:vt.now()}),Me(Ze),B(Ze),zt("Targets saved!","success"),G(!1)}catch(xe){console.error("Error saving targets:",xe),zt("Failed to save targets.","error")}A(!1)},vn=(xe,Ue)=>{z(Ze=>({...Ze,[xe]:{...Ze[xe],targetValue:Ue===""?"":parseFloat(Ue)}}))},xs=async()=>{A(!0);try{const xe=`targets_${Le.id}`,Ue={};ul.forEach(Ze=>{if(Q[Ze.key]?.targetValue){const $=mt?.bodyMetrics?.[Ze.key]||0;Ue[Ze.key]={targetValue:Q[Ze.key].targetValue,startValue:$}}}),await Ia(Ft(nt,"personalBestTargets",xe),{clientId:Le.id,targets:be,metricTargets:Ue,updatedAt:vt.now()}),P(Ue),z(Ue),zt("Metric targets saved!","success"),Z(!1)}catch(xe){console.error("Error saving metric targets:",xe),zt("Failed to save targets.","error")}A(!1)},Wn=async()=>{if(window.confirm("Reset all goals? This will clear all strength and body metric targets. Your recorded benchmarks and measurements will NOT be affected.")){A(!0);try{const xe=Ft(nt,"personalBestTargets",`targets_${Le.id}`);await ja(xe),Me({}),P({}),B({}),z({}),zt("All goals have been reset","success")}catch(xe){console.error("Error resetting targets:",xe),zt("Failed to reset goals","error")}A(!1)}},Cs=(xe,Ue)=>{const Ze=be[xe];if(!Ze||!Ze.targetValue||!Ue)return null;const $=Ze.startValue||0,Oe=Ze.targetValue;let Ke=0;Ze.targetType==="weight"?Ke=Ue.weight||0:Ze.targetType==="reps"?Ke=Ue.reps||0:Ze.targetType==="time"&&(Ke=Ue.time||0);const Re=Oe-$;return Re<=0?Ke>=Oe?1:0:Math.max(0,Math.min((Ke-$)/Re,1))},Qt=xe=>{const Ue=Ce[xe];if(!Ue||!Ue.targetValue)return null;const Ze=mt?.bodyMetrics?.[xe];if(Ze==null)return null;const $=Ue.startValue||0,Oe=Ue.targetValue,Ke=Oe-$;return Ke===0?Ze===Oe?1:0:Math.max(0,Math.min((Ze-$)/Ke,1))},We=xe=>{Te.current=xe.touches[0].clientX,Pe.current=0},en=xe=>{Pe.current=xe.touches[0].clientX-Te.current},Ct=()=>{Pe.current<-50&&C<Nr.length-1?E(xe=>xe+1):Pe.current>50&&C>0&&E(xe=>xe-1),Pe.current=0},wn=xe=>{const Ue=mt?.bodyMetrics?.[xe],Ze=kt?.bodyMetrics?.[xe];return Ue==null||Ze==null?null:parseFloat((Ue-Ze).toFixed(2))},Ls=t.find(xe=>xe.month===oe),Ai=t.find(xe=>xe.month===pe);if(qt||h)return u.jsxs("div",{className:"pb-page",children:[u.jsx("header",{className:"client-header",children:u.jsx("div",{className:"header-content",children:u.jsx("img",{src:"/Logo.PNG",alt:"Mind Core Fitness",className:"header-logo"})})}),u.jsxs("main",{className:"pb-main",children:[u.jsx("div",{className:"skeleton skeleton-title",style:{width:180,height:28,marginBottom:20}}),u.jsx("div",{className:"skeleton skeleton-card-large",style:{height:320,borderRadius:16}})]})]});if(!it||!dt||!Le)return null;const Nn=Nr[C],It=mt?.benchmarks?.[Nn.key],fn=kt?.benchmarks?.[Nn.key],Hs=tc(Nn,It),Xs=tc(Nn,fn),Tn=V0(Hs,Xs),Ci=Cs(Nn.key,It),Yn=Ci!==null,as=Ci!==null&&Ci>=1,fs=Yn?Math.round(Ci*60):Hs>0?15:0,$n=be[Nn.key];return u.jsxs("div",{className:"pb-page",children:[u.jsx("header",{className:"client-header",children:u.jsx("div",{className:"header-content",children:u.jsx("img",{src:"/Logo.PNG",alt:"Mind Core Fitness",className:"header-logo"})})}),u.jsxs("main",{className:"pb-main page-transition-enter",children:[u.jsx("button",{className:"back-btn",onClick:()=>Zt(-1),children:" Back"}),u.jsxs("div",{className:"pb-intro",children:[u.jsx("h2",{children:"Personal Bests"}),u.jsx("p",{children:"Track your strength benchmarks and body measurements each month."})]}),u.jsxs("div",{className:"pb-tabs",children:[u.jsx("button",{className:`pb-tab ${i==="bests"?"active":""}`,onClick:()=>e("bests"),children:"Strength"}),u.jsx("button",{className:`pb-tab ${i==="metrics"?"active":""}`,onClick:()=>e("metrics"),children:"Body Metrics"}),u.jsx("button",{className:`pb-tab ${i==="history"?"active":""}`,onClick:()=>e("history"),children:"History"})]}),i==="bests"&&u.jsxs("div",{className:"pb-strength-section",children:[!S&&u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"pb-carousel",ref:ie,onTouchStart:We,onTouchMove:en,onTouchEnd:Ct,children:[u.jsx("div",{className:"pb-ring-container",children:u.jsxs("div",{className:"pb-ring",children:[u.jsx("svg",{className:"pb-ring-svg",viewBox:"0 0 200 200",children:[...Array(60)].map((xe,Ue)=>{const Ze=(Ue*6-90)*(Math.PI/180),$=85,Oe=96,Ke=100+$*Math.cos(Ze),Re=100+$*Math.sin(Ze),ft=100+Oe*Math.cos(Ze),yt=100+Oe*Math.sin(Ze),bt=Ue<Math.round(fs);return u.jsx("line",{x1:Ke,y1:Re,x2:ft,y2:yt,className:`pb-ring-tick ${bt?as?"hit":"filled":"empty"}`,strokeWidth:Ue%5===0?"3":"2"},Ue)})}),u.jsxs("div",{className:"pb-ring-center",children:[u.jsx("div",{className:"pb-ring-category",children:Nn.category}),u.jsxs("div",{className:"pb-ring-exercise",children:[Nn.name,et("strength",Nn.key)&&u.jsx("svg",{className:"pb-badge-icon",viewBox:"0 0 24 24",fill:"currentColor",children:u.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})]}),u.jsx("div",{className:"pb-ring-value",children:It?Nn.unit==="time"?pd(It.time):Sv(It.weight,It.reps):"-"}),Tn!==null&&u.jsxs("div",{className:`pb-ring-change ${Tn>=0?"positive":"negative"}`,children:[Tn>=0?"+":"",Tn.toFixed(1),"%"]}),Tn===null&&It&&u.jsx("div",{className:"pb-ring-change neutral",children:"New entry"}),$n&&u.jsxs("div",{className:`pb-ring-target ${as?"hit":""}`,children:[as?"Target hit!":`${$n.startValue||0}  ${$n.targetValue}`," ",$n.targetType==="weight"?"kg":$n.targetType==="reps"?"reps":$n.targetType==="time"?"s":"kg"]}),!$n&&u.jsx("div",{className:"pb-ring-target none",children:"No target set"})]})]})}),u.jsx("div",{className:"pb-carousel-dots",children:Nr.map((xe,Ue)=>u.jsx("button",{className:`pb-dot ${Ue===C?"active":""}`,onClick:()=>E(Ue)},Ue))}),u.jsx("button",{className:"pb-carousel-arrow left",onClick:()=>E(xe=>Math.max(0,xe-1)),disabled:C===0,children:u.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:u.jsx("path",{d:"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"})})}),u.jsx("button",{className:"pb-carousel-arrow right",onClick:()=>E(xe=>Math.min(Nr.length-1,xe+1)),disabled:C===Nr.length-1,children:u.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:u.jsx("path",{d:"M8.59 16.59L10 18l6-6-6-6-1.41 1.41L13.17 12z"})})})]}),u.jsxs("div",{className:"pb-trend-section",children:[u.jsx("h4",{children:"Trend"}),u.jsx(J8,{data:t,exerciseKey:Nn.key,unit:Nn.unit})]})]}),!S&&!X&&u.jsxs("div",{className:"pb-action-buttons",children:[u.jsx("button",{className:"pb-edit-btn",onClick:()=>I(!0),children:mt?.benchmarks?"Edit This Month's Benchmarks":"Add This Month's Benchmarks"}),u.jsx("button",{className:"pb-edit-btn pb-target-btn",onClick:()=>G(!0),children:Object.keys(be).length>0?"Edit Targets":"Set Targets"}),(Object.keys(be).length>0||Object.keys(Ce).length>0)&&u.jsx("button",{className:"pb-edit-btn pb-reset-btn",onClick:Wn,disabled:y,children:"Reset All Goals"})]}),S&&u.jsxs("div",{className:"pb-edit-card",children:[u.jsxs("div",{className:"pb-edit-header",children:[u.jsxs("h3",{children:["Benchmarks - ",Ir(st)]}),u.jsx("button",{className:"pb-edit-close",onClick:()=>{I(!1),ae(mt?.benchmarks||{})},children:""})]}),u.jsx("div",{className:"pb-edit-body",children:Nr.map(xe=>u.jsxs("div",{className:"pb-edit-exercise",children:[u.jsx("div",{className:"pb-edit-exercise-name",children:xe.name}),xe.unit==="weight"?u.jsxs("div",{className:"pb-edit-row",children:[u.jsxs("div",{className:"pb-edit-field",children:[u.jsx("label",{children:"Weight (kg)"}),u.jsx("input",{type:"number",step:"0.5",value:J[xe.key]?.weight??"",onChange:Ue=>xn(xe.key,"weight",Ue.target.value),placeholder:"0"})]}),u.jsxs("div",{className:"pb-edit-field",children:[u.jsx("label",{children:"Reps"}),u.jsx("input",{type:"number",value:J[xe.key]?.reps??"",onChange:Ue=>xn(xe.key,"reps",Ue.target.value),placeholder:"0"})]})]}):u.jsx("div",{className:"pb-edit-row",children:u.jsxs("div",{className:"pb-edit-field full",children:[u.jsx("label",{children:"Time (seconds)"}),u.jsx("input",{type:"number",step:"0.01",value:J[xe.key]?.time??"",onChange:Ue=>xn(xe.key,"time",Ue.target.value),placeholder:"0"})]})})]},xe.key))}),u.jsxs("div",{className:"pb-edit-actions",children:[u.jsx("button",{className:"pb-cancel-btn",onClick:()=>{I(!1),ae(mt?.benchmarks||{})},children:"Cancel"}),u.jsx("button",{className:"pb-save-btn",onClick:Ot,disabled:y,children:y?"Saving...":"Save"})]})]}),X&&u.jsxs("div",{className:"pb-edit-card",children:[u.jsxs("div",{className:"pb-edit-header",children:[u.jsx("h3",{children:"Set Your Targets"}),u.jsx("button",{className:"pb-edit-close",onClick:()=>{G(!1),B(be)},children:""})]}),u.jsxs("div",{className:"pb-edit-body",children:[u.jsx("p",{className:"pb-target-hint",children:"Set a target for each exercise. Your current best is captured automatically from your latest benchmarks."}),Nr.map(xe=>{const Ue=F[xe.key]?.targetType||(xe.unit==="time"?"time":"weight"),Ze=Ue==="weight"?"kg":Ue==="reps"?"reps":"seconds",$=mt?.benchmarks?.[xe.key];let Oe="-";return $&&(Ue==="weight"&&$.weight?Oe=`${$.weight}kg`:Ue==="reps"&&$.reps?Oe=`${$.reps} reps`:Ue==="time"&&$.time&&(Oe=`${$.time}s`)),u.jsxs("div",{className:"pb-edit-exercise",children:[u.jsxs("div",{className:"pb-edit-exercise-header",children:[u.jsx("div",{className:"pb-edit-exercise-name",children:xe.name}),u.jsxs("div",{className:"pb-edit-current-best",children:["Current: ",Oe]})]}),xe.unit==="weight"&&u.jsxs("div",{className:"pb-target-type-toggle",children:[u.jsx("button",{type:"button",className:Ue==="weight"?"active":"",onClick:()=>Zn(xe.key,"targetType","weight"),children:"Weight"}),u.jsx("button",{type:"button",className:Ue==="reps"?"active":"",onClick:()=>Zn(xe.key,"targetType","reps"),children:"Reps"})]}),u.jsx("div",{className:"pb-edit-row",children:u.jsxs("div",{className:"pb-edit-field full",children:[u.jsxs("label",{children:["Target (",Ze,")"]}),u.jsx("input",{type:"number",step:Ue==="weight"?"0.5":"1",value:F[xe.key]?.targetValue??"",onChange:Ke=>Zn(xe.key,"targetValue",Ke.target.value),placeholder:"0"})]})})]},xe.key)})]}),u.jsxs("div",{className:"pb-edit-actions",children:[u.jsx("button",{className:"pb-cancel-btn",onClick:()=>{G(!1),B(be)},children:"Cancel"}),u.jsx("button",{className:"pb-save-btn",onClick:Vn,disabled:y,children:y?"Saving...":"Save Targets"})]})]})]}),i==="metrics"&&u.jsxs("div",{className:"pb-metrics-section",children:[!j&&!se&&u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"pb-metrics-card",children:[u.jsx("h3",{children:"Body Measurements"}),u.jsx("p",{className:"pb-metrics-month",children:Ir(st)}),u.jsx("div",{className:"pb-metrics-list",children:ul.map(xe=>{const Ue=mt?.bodyMetrics?.[xe.key],Ze=wn(xe.key),$=Ce[xe.key],Oe=Qt(xe.key),Ke=Oe!==null&&Oe>=1;return u.jsxs("div",{className:"pb-metric-row",children:[u.jsxs("div",{className:"pb-metric-top",children:[u.jsxs("div",{className:"pb-metric-left",children:[u.jsxs("span",{className:"pb-metric-name",children:[xe.name,et("metric",xe.key)&&u.jsx("svg",{className:"pb-badge-icon-sm",viewBox:"0 0 24 24",fill:"currentColor",children:u.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})]}),$&&u.jsxs("span",{className:"pb-metric-target-label",children:["Target: ",$.targetValue," ",xe.suffix]})]}),u.jsxs("div",{className:"pb-metric-values",children:[u.jsx("span",{className:"pb-metric-current",children:Ue!=null?`${Ue} ${xe.suffix}`:"-"}),Ze!==null&&u.jsxs("span",{className:`pb-metric-change ${Ze>0?"up":Ze<0?"down":"same"}`,children:[Ze>0?"+":"",Ze," ",xe.suffix]})]})]}),Oe!==null&&u.jsxs("div",{className:"pb-metric-progress",children:[u.jsx("div",{className:"pb-metric-bar",children:u.jsx("div",{className:`pb-metric-bar-fill ${Ke?"hit":""}`,style:{width:`${Math.round(Oe*100)}%`}})}),u.jsx("span",{className:`pb-metric-percent ${Ke?"hit":""}`,children:Ke?"Hit!":`${Math.round(Oe*100)}%`})]})]},xe.key)})})]}),u.jsxs("div",{className:"pb-action-buttons",children:[u.jsx("button",{className:"pb-edit-btn",onClick:()=>Y(!0),children:mt?.bodyMetrics?"Edit This Month's Measurements":"Add This Month's Measurements"}),u.jsx("button",{className:"pb-edit-btn pb-target-btn",onClick:()=>Z(!0),children:Object.keys(Ce).length>0?"Edit Targets":"Set Targets"}),(Object.keys(be).length>0||Object.keys(Ce).length>0)&&u.jsx("button",{className:"pb-edit-btn pb-reset-btn",onClick:Wn,disabled:y,children:"Reset All Goals"})]})]}),j&&u.jsxs("div",{className:"pb-edit-card",children:[u.jsxs("div",{className:"pb-edit-header",children:[u.jsxs("h3",{children:["Measurements - ",Ir(st)]}),u.jsx("button",{className:"pb-edit-close",onClick:()=>{Y(!1),ue(mt?.bodyMetrics||{})},children:""})]}),u.jsx("div",{className:"pb-edit-body",children:ul.map(xe=>u.jsx("div",{className:"pb-edit-metric",children:u.jsxs("div",{className:"pb-edit-field full",children:[u.jsxs("label",{children:[xe.name," (",xe.suffix,")"]}),u.jsx("input",{type:"number",step:"0.1",value:ne[xe.key]??"",onChange:Ue=>jn(xe.key,Ue.target.value),placeholder:"0"})]})},xe.key))}),u.jsxs("div",{className:"pb-edit-actions",children:[u.jsx("button",{className:"pb-cancel-btn",onClick:()=>{Y(!1),ue(mt?.bodyMetrics||{})},children:"Cancel"}),u.jsx("button",{className:"pb-save-btn",onClick:ot,disabled:y,children:y?"Saving...":"Save"})]})]}),se&&u.jsxs("div",{className:"pb-edit-card",children:[u.jsxs("div",{className:"pb-edit-header",children:[u.jsx("h3",{children:"Body Metric Targets"}),u.jsx("button",{className:"pb-edit-close",onClick:()=>{Z(!1),z(Ce)},children:""})]}),u.jsxs("div",{className:"pb-edit-body",children:[u.jsx("p",{className:"pb-target-hint",children:"Set targets for your body measurements. Your current measurement is captured automatically."}),ul.map(xe=>{const Ue=mt?.bodyMetrics?.[xe.key];return u.jsxs("div",{className:"pb-edit-exercise",children:[u.jsxs("div",{className:"pb-edit-exercise-header",children:[u.jsx("div",{className:"pb-edit-exercise-name",children:xe.name}),u.jsxs("div",{className:"pb-edit-current-best",children:["Current: ",Ue!=null?`${Ue} ${xe.suffix}`:"-"]})]}),u.jsx("div",{className:"pb-edit-row",children:u.jsxs("div",{className:"pb-edit-field full",children:[u.jsxs("label",{children:["Target (",xe.suffix,")"]}),u.jsx("input",{type:"number",step:"0.1",value:Q[xe.key]?.targetValue??"",onChange:Ze=>vn(xe.key,Ze.target.value),placeholder:"0"})]})})]},xe.key)})]}),u.jsxs("div",{className:"pb-edit-actions",children:[u.jsx("button",{className:"pb-cancel-btn",onClick:()=>{Z(!1),z(Ce)},children:"Cancel"}),u.jsx("button",{className:"pb-save-btn",onClick:xs,disabled:y,children:y?"Saving...":"Save Targets"})]})]})]}),i==="history"&&u.jsx("div",{className:"pb-history-section",children:t.length===0?u.jsxs("div",{className:"pb-empty",children:[u.jsx("h4",{children:"No records yet"}),u.jsx("p",{children:"Start adding your monthly benchmarks and measurements to track your progress over time."})]}):u.jsxs(u.Fragment,{children:[Ye.length>0&&u.jsxs("div",{className:"pb-achievements-wall",children:[u.jsxs("h4",{className:"pb-achievements-wall-title",children:[u.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"18",height:"18",children:u.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),"Targets Achieved"]}),u.jsx("div",{className:"pb-achievements-list",children:[...Ye].reverse().map((xe,Ue)=>u.jsxs("div",{className:"pb-achievement-item",style:{animationDelay:`${Ue*.05}s`},children:[u.jsx("div",{className:"pb-achievement-star",children:u.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:u.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),u.jsxs("div",{className:"pb-achievement-info",children:[u.jsx("span",{className:"pb-achievement-label",children:xe.label}),u.jsx("span",{className:"pb-achievement-date",children:Ir(xe.achievedMonth)})]})]},Ue))})]}),u.jsx("div",{className:"pb-history-controls",children:u.jsx("button",{className:`pb-compare-toggle ${tt?"active":""}`,onClick:()=>{L(!tt),!tt&&t.length>=2&&(ce(t[0].month),ee(t[t.length-1].month))},children:tt?"Back to Timeline":"Compare Months"})}),tt?u.jsxs("div",{className:"pb-compare",children:[u.jsxs("div",{className:"pb-compare-selectors",children:[u.jsxs("div",{className:"pb-compare-select",children:[u.jsx("label",{children:"From"}),u.jsx("select",{value:oe,onChange:xe=>ce(xe.target.value),children:t.map(xe=>u.jsx("option",{value:xe.month,children:Ir(xe.month)},xe.month))})]}),u.jsx("div",{className:"pb-compare-vs",children:"vs"}),u.jsxs("div",{className:"pb-compare-select",children:[u.jsx("label",{children:"To"}),u.jsx("select",{value:pe,onChange:xe=>ee(xe.target.value),children:t.map(xe=>u.jsx("option",{value:xe.month,children:Ir(xe.month)},xe.month))})]})]}),Ls&&Ai&&u.jsxs("div",{className:"pb-compare-results",children:[u.jsxs("div",{className:"pb-compare-group",children:[u.jsx("h4",{children:"Strength Benchmarks"}),u.jsxs("div",{className:"pb-compare-table",children:[u.jsxs("div",{className:"pb-compare-header-row",children:[u.jsx("span",{children:"Exercise"}),u.jsx("span",{children:Ir(oe).split(" ")[0]}),u.jsx("span",{children:Ir(pe).split(" ")[0]}),u.jsx("span",{children:"Change"})]}),Nr.map(xe=>{const Ue=Ls.benchmarks?.[xe.key],Ze=Ai.benchmarks?.[xe.key],$=tc(xe,Ue),Oe=tc(xe,Ze),Ke=V0(Oe,$);return u.jsxs("div",{className:"pb-compare-row",children:[u.jsx("span",{className:"pb-compare-name",children:xe.name}),u.jsx("span",{className:"pb-compare-val",children:Ue?xe.unit==="time"?pd(Ue.time):`${Ue.weight}x${Ue.reps}`:"-"}),u.jsx("span",{className:"pb-compare-val",children:Ze?xe.unit==="time"?pd(Ze.time):`${Ze.weight}x${Ze.reps}`:"-"}),u.jsx("span",{className:`pb-compare-change ${Ke!==null?Ke>=0?"positive":"negative":""}`,children:Ke!==null?`${Ke>=0?"+":""}${Ke.toFixed(1)}%`:"-"})]},xe.key)})]})]}),u.jsxs("div",{className:"pb-compare-group",children:[u.jsx("h4",{children:"Body Measurements"}),u.jsxs("div",{className:"pb-compare-table",children:[u.jsxs("div",{className:"pb-compare-header-row",children:[u.jsx("span",{children:"Measurement"}),u.jsx("span",{children:Ir(oe).split(" ")[0]}),u.jsx("span",{children:Ir(pe).split(" ")[0]}),u.jsx("span",{children:"Change"})]}),ul.map(xe=>{const Ue=Ls.bodyMetrics?.[xe.key],Ze=Ai.bodyMetrics?.[xe.key],$=Ue!=null&&Ze!=null?parseFloat((Ze-Ue).toFixed(2)):null;return u.jsxs("div",{className:"pb-compare-row",children:[u.jsx("span",{className:"pb-compare-name",children:xe.name}),u.jsx("span",{className:"pb-compare-val",children:Ue!=null?`${Ue}`:"-"}),u.jsx("span",{className:"pb-compare-val",children:Ze!=null?`${Ze}`:"-"}),u.jsx("span",{className:`pb-compare-change ${$!==null?$>0?"positive":$<0?"negative":"neutral":""}`,children:$!==null?`${$>0?"+":""}${$} ${xe.suffix}`:"-"})]},xe.key)})]})]})]})]}):u.jsx("div",{className:"pb-timeline",children:[...t].reverse().map((xe,Ue)=>{const Ze=t.find($=>$.month<xe.month&&t.indexOf($)===t.indexOf(xe)-1)||t.filter($=>$.month<xe.month).pop();return u.jsxs("div",{className:"pb-timeline-item",style:{animationDelay:`${Ue*.05}s`},children:[u.jsx("div",{className:"pb-timeline-dot"}),u.jsxs("div",{className:"pb-timeline-card",children:[u.jsx("h4",{children:Ir(xe.month)}),xe.benchmarks&&Object.keys(xe.benchmarks).length>0&&u.jsxs("div",{className:"pb-timeline-group",children:[u.jsx("h5",{children:"Strength Benchmarks"}),Nr.map($=>{const Oe=xe.benchmarks[$.key];if(!Oe)return null;const Ke=Ze?.benchmarks?.[$.key],Re=tc($,Oe),ft=tc($,Ke),yt=V0(Re,ft);return u.jsxs("div",{className:"pb-timeline-row",children:[u.jsx("span",{className:"pb-timeline-label",children:$.name}),u.jsxs("div",{className:"pb-timeline-values",children:[u.jsx("span",{className:"pb-timeline-value",children:$.unit==="time"?pd(Oe.time):Sv(Oe.weight,Oe.reps)}),yt!==null&&u.jsxs("span",{className:`pb-timeline-change ${yt>=0?"positive":"negative"}`,children:[yt>=0?"+":"",yt.toFixed(1),"%"]})]})]},$.key)})]}),xe.bodyMetrics&&Object.keys(xe.bodyMetrics).length>0&&u.jsxs("div",{className:"pb-timeline-group",children:[u.jsx("h5",{children:"Body Measurements"}),ul.map($=>{const Oe=xe.bodyMetrics[$.key];if(Oe==null)return null;const Ke=Ze?.bodyMetrics?.[$.key],Re=Ke!=null?parseFloat((Oe-Ke).toFixed(2)):null;return u.jsxs("div",{className:"pb-timeline-row",children:[u.jsx("span",{className:"pb-timeline-label",children:$.name}),u.jsxs("div",{className:"pb-timeline-values",children:[u.jsxs("span",{className:"pb-timeline-value",children:[Oe," ",$.suffix]}),Re!==null&&u.jsxs("span",{className:`pb-timeline-change ${Re>0?"positive":Re<0?"negative":"neutral"}`,children:[Re>0?"+":"",Re," ",$.suffix]})]})]},$.key)})]})]})]},xe.id)})})]})})]}),te&&u.jsx("div",{className:"pb-celebration-overlay",onClick:()=>ge(null),children:u.jsxs("div",{className:"pb-celebration-card",children:[u.jsx("div",{className:"pb-celebration-icon",children:u.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:u.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),u.jsx("h3",{className:"pb-celebration-title",children:te.length===1?"Target Achieved!":`${te.length} Targets Achieved!`}),u.jsx("div",{className:"pb-celebration-badges",children:te.map((xe,Ue)=>u.jsx("div",{className:"pb-celebration-badge",children:xe.label},Ue))}),u.jsx("p",{className:"pb-celebration-sub",children:"Tap to dismiss"})]})}),He&&u.jsxs("div",{className:`toast-notification ${He.type}`,children:[u.jsx("span",{className:"toast-icon",children:He.type==="success"?u.jsx("svg",{className:"success-check-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:u.jsx("path",{className:"check-path",d:"M5 13 L9 17 L19 7"})}):u.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[u.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),u.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})}),u.jsx("span",{className:"toast-message",children:He.message}),u.jsx("button",{className:"toast-close",onClick:()=>Ne(null),children:""})]})]})}const F0=()=>{const i=new Date;let t=(6-i.getDay()+7)%7;if(t===0){const h=new Date(i);h.setHours(9,45,0,0),i>h&&(t=7)}const a=new Date(i);return a.setDate(i.getDate()+t),a},U0=i=>`${i.getFullYear()}-${String(i.getMonth()+1).padStart(2,"0")}-${String(i.getDate()).padStart(2,"0")}`,tR=i=>new Date(i+"T09:00:00").toLocaleDateString("en-GB",{weekday:"long",day:"numeric",month:"long",year:"numeric"});function nR(){const[i,e]=H.useState(!0),[t,a]=H.useState(null),[h,f]=H.useState(null),[y,A]=H.useState({attended:0,streak:0,strikes:0}),[C,E]=H.useState(null),{currentUser:S,isClient:I,clientData:j,logout:Y,loading:X}=Vi(),{isDark:G,toggleTheme:J}=Cl(),ae=ai();H.useCallback((P,F="info")=>{E({message:P,type:F}),setTimeout(()=>E(null),4e3)},[]),H.useEffect(()=>{!X&&(!S||!I)&&ae("/")},[S,I,X,ae]),H.useEffect(()=>{const P=()=>{const B=new Date,se=F0();se.setHours(9,0,0,0);const Z=se-B;if(Z<=0){a({days:0,hours:0,minutes:0,seconds:0});return}a({days:Math.floor(Z/864e5),hours:Math.floor(Z%864e5/36e5),minutes:Math.floor(Z%36e5/6e4),seconds:Math.floor(Z%6e4/1e3)})};P();const F=setInterval(P,1e3);return()=>clearInterval(F)},[]),H.useEffect(()=>{j&&ne()},[j]);const ne=async()=>{try{const P=U0(F0()),F=Ft(nt,"circuitSessions",P),B=await Bo(F);if(B.exists()){const tt=B.data().slots?.find(L=>L.memberId===j.id);f(tt||null)}else f(null);const Z=(await Hn(En(nt,"circuitSessions"))).docs.map(Ne=>({id:Ne.id,...Ne.data()})),Q=new Date;Q.setHours(0,0,0,0);let z=0;const Ye=[];Z.forEach(Ne=>{new Date(Ne.date+"T09:00:00")<Q&&Ne.slots?.some(oe=>oe.memberId===j.id&&(oe.status==="confirmed"||oe.status==="attended"))&&(z++,Ye.push(Ne.date))}),Ye.sort((Ne,tt)=>tt.localeCompare(Ne));let me=0,te=new Date(Q);const ge=te.getDay(),He=ge>=6?ge-6:ge+1;te.setDate(te.getDate()-He);for(const Ne of Ye)if(Ne===U0(te))me++,te.setDate(te.getDate()-7);else break;A({attended:z,streak:me,strikes:j.circuitStrikes||0,banUntil:j.circuitBanUntil||null})}catch(P){console.error("Error fetching circuit data:",P)}e(!1)};if(X||i)return u.jsx("div",{className:"circuit-page",children:u.jsx("div",{className:"circuit-loading",children:u.jsx("img",{src:"/Logo.PNG",alt:"Mind Core Fitness",className:"circuit-loading-logo"})})});const ue=U0(F0()),be=j?.clientType||"block",Me=be==="circuit_vip"||be==="circuit_dropin",Ce=be==="circuit_vip"?"VIP":be==="circuit_dropin"?"Drop-in":"Block";return u.jsxs("div",{className:`circuit-page ${G?"dark":""}`,children:[u.jsxs("header",{className:"circuit-header",children:[u.jsxs("div",{className:"circuit-header-left",children:[!Me&&u.jsx("button",{className:"circuit-back-btn",onClick:()=>ae("/client"),children:u.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:u.jsx("path",{d:"M19 12H5M12 19l-7-7 7-7"})})}),u.jsx("img",{src:"/Logo.PNG",alt:"MCF",className:"circuit-header-logo"})]}),u.jsxs("div",{className:"circuit-header-right",children:[u.jsx("button",{className:"circuit-icon-btn",onClick:J,children:G?"":""}),Me&&u.jsx("button",{className:"circuit-icon-btn logout",onClick:Y,children:u.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:u.jsx("path",{d:"M9 21H5a2 2 0 01-2-2V5a2 2 0 012-2h4M16 17l5-5-5-5M21 12H9"})})})]})]}),u.jsxs("main",{className:"circuit-main",children:[u.jsxs("div",{className:"circuit-intro",children:[u.jsx("h2",{children:"Circuit Class"}),u.jsxs("p",{children:["Hey ",j?.name?.split(" ")[0],"! Your Saturday session awaits."]})]}),t&&u.jsxs("div",{className:"circuit-countdown",children:[u.jsxs("div",{className:"circuit-ring",children:[u.jsx("svg",{className:"circuit-ring-svg",viewBox:"0 0 200 200",children:[...Array(60)].map((P,F)=>{const B=(F*6-90)*(Math.PI/180),se=85,Z=96,Q=100+se*Math.cos(B),z=100+se*Math.sin(B),Ye=100+Z*Math.cos(B),me=100+Z*Math.sin(B),te=60-t.seconds,ge=F<te;return u.jsx("line",{x1:Q,y1:z,x2:Ye,y2:me,className:`circuit-tick ${ge?"elapsed":"remaining"}`,strokeWidth:F%5===0?"3":"2"},F)})}),u.jsxs("div",{className:"circuit-ring-center",children:[u.jsx("div",{className:"circuit-ring-logo",children:u.jsx("img",{src:"/Logo.PNG",alt:"Mind Core Fitness"})}),u.jsx("div",{className:"circuit-ring-label",children:"Next Class"}),u.jsxs("div",{className:"circuit-ring-countdown",children:[t.days>0&&u.jsxs(u.Fragment,{children:[u.jsx("span",{className:"circuit-digit",children:String(t.days).padStart(2,"0")}),u.jsx("span",{className:"circuit-colon",children:":"})]}),u.jsx("span",{className:"circuit-digit",children:String(t.hours).padStart(2,"0")}),u.jsx("span",{className:"circuit-colon",children:":"}),u.jsx("span",{className:"circuit-digit",children:String(t.minutes).padStart(2,"0")}),u.jsx("span",{className:"circuit-colon",children:":"}),u.jsx("span",{className:"circuit-digit circuit-seconds",children:String(t.seconds).padStart(2,"0")})]}),u.jsx("div",{className:"circuit-ring-sub",children:"Saturday 9:00am"})]})]}),u.jsx("p",{className:"circuit-date-full",children:tR(ue)})]}),u.jsx("div",{className:`circuit-status-card ${h?"booked":"not-booked"}`,children:h?u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"circuit-status-check",children:u.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:u.jsx("path",{d:"M5 13l4 4L19 7"})})}),u.jsxs("div",{className:"circuit-status-info",children:[u.jsx("h3",{children:"You're Locked In"}),u.jsxs("p",{children:["Slot #",h.slotNumber,"  ",Ce]})]})]}):u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"circuit-status-alert",children:"!"}),u.jsxs("div",{className:"circuit-status-info",children:[u.jsx("h3",{children:"Not Booked Yet"}),u.jsx("p",{children:"Tap below to view and book your slot"})]}),u.jsx("button",{className:"circuit-book-now-btn",onClick:()=>ae("/client/circuit/booking"),children:"Book Now"})]})}),u.jsxs("div",{className:"circuit-stats-card",children:[u.jsx("h3",{children:"Your Stats"}),u.jsxs("div",{className:"circuit-stats-grid",children:[u.jsxs("div",{className:"circuit-stat",children:[u.jsx("span",{className:"circuit-stat-value",children:y.attended}),u.jsx("span",{className:"circuit-stat-label",children:"Classes"})]}),u.jsxs("div",{className:"circuit-stat",children:[u.jsx("span",{className:"circuit-stat-value",children:y.streak}),u.jsx("span",{className:"circuit-stat-label",children:"Week Streak"})]}),u.jsxs("div",{className:"circuit-stat",children:[u.jsxs("span",{className:`circuit-stat-value ${y.strikes>=2?"warning":""}`,children:[y.strikes,"/3"]}),u.jsx("span",{className:"circuit-stat-label",children:"Strikes"})]})]}),y.banUntil&&(()=>{const P=y.banUntil.toDate?y.banUntil.toDate():new Date(y.banUntil.seconds*1e3);return P>new Date?u.jsxs("div",{className:"circuit-ban-notice",children:["Booking suspended until ",P.toLocaleDateString("en-GB",{day:"numeric",month:"long"})]}):null})()]}),u.jsxs("div",{className:"circuit-rules",children:[u.jsx("h4",{children:"Class Rules"}),u.jsxs("ul",{children:[u.jsxs("li",{children:["Lock in your slot by ",u.jsx("strong",{children:"Wednesday"})]}),u.jsxs("li",{children:["Cancel at least ",u.jsx("strong",{children:"24 hours"})," before class"]}),u.jsx("li",{children:"3 no-show strikes = 1 month booking ban"})]})]}),be!=="circuit_vip"&&u.jsxs("div",{className:"circuit-vip-promo",children:[u.jsx("div",{className:"vip-promo-badge",children:"VIP"}),u.jsx("h3",{children:"Become a VIP Member"}),u.jsxs("p",{className:"vip-promo-price",children:["Just ",u.jsx("strong",{children:"25"}),"/month"]}),u.jsx("p",{className:"vip-promo-desc",children:"Full access with a priority spot every week  your slot is automatically locked in before anyone else can book."}),u.jsxs("ul",{className:"vip-promo-perks",children:[u.jsx("li",{children:"Guaranteed slot every Saturday"}),u.jsx("li",{children:"Auto-booked  no need to race for a spot"}),u.jsx("li",{children:"Cancel anytime for the week, reinstated the next"})]}),u.jsxs("a",{href:"https://wa.me/447449782055?text=Hi%20Ross%2C%20I%27d%20like%20to%20become%20a%20VIP%20circuit%20member!",target:"_blank",rel:"noopener noreferrer",className:"vip-promo-wa-btn",children:[u.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:u.jsx("path",{d:"M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"})}),"Message on WhatsApp"]})]})]}),u.jsx("button",{className:"circuit-fab",onClick:()=>ae("/client/circuit/booking"),children:u.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[u.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),u.jsx("path",{d:"M3 9h18M9 21V9"})]})}),C&&u.jsx("div",{className:`toast-notification ${C.type}`,children:u.jsx("span",{children:C.message})})]})}const yd=()=>{const i=new Date;let t=(6-i.getDay()+7)%7;if(t===0){const h=new Date(i);h.setHours(9,45,0,0),i>h&&(t=7)}const a=new Date(i);return a.setDate(i.getDate()+t),a},sR=i=>`${i.getFullYear()}-${String(i.getMonth()+1).padStart(2,"0")}-${String(i.getDate()).padStart(2,"0")}`,iR=i=>new Date(i+"T09:00:00").toLocaleDateString("en-GB",{weekday:"long",day:"numeric",month:"long"}),Nv=i=>i==="circuit_vip"?"VIP":i==="circuit_dropin"?"Drop-in":"Block",Iv=i=>i==="circuit_vip"?"vip":i==="circuit_dropin"?"dropin":"block";function rR(){const[i,e]=H.useState(!0),[t,a]=H.useState(!1),[h,f]=H.useState(null),[y,A]=H.useState(null),{currentUser:C,isClient:E,clientData:S,loading:I}=Vi(),{isDark:j}=Cl(),Y=ai(),X=H.useCallback((z,Ye="info")=>{A({message:z,type:Ye}),setTimeout(()=>A(null),4e3)},[]);H.useEffect(()=>{!I&&(!C||!E)&&Y("/")},[C,E,I,Y]),H.useEffect(()=>{S&&G()},[S]);const G=async()=>{try{const z=sR(yd()),Ye=Ft(nt,"circuitSessions",z),me=await Bo(Ye);if(me.exists()){const te={id:me.id,...me.data()},ge=kr(En(nt,"clients"),vr("clientType","==","circuit_vip"),vr("status","==","active")),Ne=(await Hn(ge)).docs.map(oe=>({id:oe.id,...oe.data()})),tt=te.slots.filter(oe=>oe.memberId).map(oe=>oe.memberId),L=Ne.filter(oe=>!tt.includes(oe.id));if(L.length>0){const oe=[...te.slots];let ce=!1;for(const pe of L){const ee=oe.findIndex(ie=>ie.status==="available");if(ee===-1)break;oe[ee]={slotNumber:oe[ee].slotNumber,memberId:pe.id,memberName:pe.name,memberType:"circuit_vip",status:"confirmed",bookedAt:vt.now()},ce=!0}ce&&(await Ms(Ye,{slots:oe}),te.slots=oe)}f(te)}else{const te=kr(En(nt,"clients"),vr("clientType","==","circuit_vip"),vr("status","==","active")),He=(await Hn(te)).docs.map(L=>({id:L.id,...L.data()})),Ne=[];for(let L=0;L<8;L++)L<He.length?Ne.push({slotNumber:L+1,memberId:He[L].id,memberName:He[L].name,memberType:"circuit_vip",status:"confirmed",bookedAt:vt.now()}):Ne.push({slotNumber:L+1,memberId:null,memberName:null,memberType:null,status:"available"});const tt={date:z,time:"09:00",endTime:"09:45",maxCapacity:8,slots:Ne,waitlist:[],createdAt:vt.now()};await Ia(Ye,tt),f({id:z,...tt})}}catch(z){console.error("Error loading session:",z),X("Failed to load session","error")}e(!1)},J=async z=>{if(!t){a(!0);try{if(S.circuitBanUntil&&(S.circuitBanUntil.toDate?S.circuitBanUntil.toDate():new Date(S.circuitBanUntil))>new Date){X("You are currently suspended from booking","error"),a(!1);return}const Ye=yd(),me=new Date(Ye);if(me.setDate(me.getDate()-3),me.setHours(23,59,59,999),new Date>me){X("Booking deadline has passed (Wednesday)","error"),a(!1);return}if(h.slots.some(Ne=>Ne.memberId===S.id)){X("You already have a slot booked","error"),a(!1);return}const te=[...h.slots],ge=te.findIndex(Ne=>Ne.slotNumber===z&&Ne.status==="available");if(ge===-1){X("Slot is no longer available","error"),a(!1);return}te[ge]={slotNumber:z,memberId:S.id,memberName:S.name,memberType:S.clientType||"block",status:"confirmed",bookedAt:vt.now()};const He=(h.waitlist||[]).filter(Ne=>Ne.memberId!==S.id);await Ms(Ft(nt,"circuitSessions",h.id),{slots:te,waitlist:He}),f(Ne=>({...Ne,slots:te,waitlist:He})),X("Slot booked!","success")}catch(Ye){console.error("Error booking slot:",Ye),X("Failed to book slot","error")}a(!1)}},ae=async()=>{if(!t){a(!0);try{const z=yd();z.setHours(9,0,0,0);const Ye=new Date(z.getTime()-1440*60*1e3);if(new Date>Ye){X("Cancellation deadline passed (24hrs before class)","error"),a(!1);return}const me=[...h.slots],te=me.findIndex(Ne=>Ne.memberId===S.id);if(te===-1){a(!1);return}const ge=me[te].slotNumber;let He=[...h.waitlist||[]];if(He.length>0){const Ne=He.shift();me[te]={slotNumber:ge,memberId:Ne.memberId,memberName:Ne.memberName,memberType:Ne.memberType,status:"confirmed",bookedAt:vt.now()}}else me[te]={slotNumber:ge,memberId:null,memberName:null,memberType:null,status:"available"};await Ms(Ft(nt,"circuitSessions",h.id),{slots:me,waitlist:He}),f(Ne=>({...Ne,slots:me,waitlist:He})),X("Slot released","success")}catch(z){console.error("Error releasing slot:",z),X("Failed to release slot","error")}a(!1)}},ne=async()=>{if(!t){a(!0);try{if(h.waitlist?.some(Ye=>Ye.memberId===S.id)){X("Already on the waitlist","error"),a(!1);return}if(h.slots.some(Ye=>Ye.memberId===S.id)){X("You already have a slot","error"),a(!1);return}const z=[...h.waitlist||[],{memberId:S.id,memberName:S.name,memberType:S.clientType||"block",addedAt:vt.now()}];await Ms(Ft(nt,"circuitSessions",h.id),{waitlist:z}),f(Ye=>({...Ye,waitlist:z})),X("Added to waitlist!","success")}catch(z){console.error("Error joining waitlist:",z),X("Failed to join waitlist","error")}a(!1)}},ue=async()=>{if(!t){a(!0);try{const z=(h.waitlist||[]).filter(Ye=>Ye.memberId!==S.id);await Ms(Ft(nt,"circuitSessions",h.id),{waitlist:z}),f(Ye=>({...Ye,waitlist:z})),X("Removed from waitlist","success")}catch(z){console.error("Error leaving waitlist:",z),X("Failed to leave waitlist","error")}a(!1)}};if(I||i)return u.jsx("div",{className:"cb-page",children:u.jsx("div",{className:"cb-loading",children:u.jsx("img",{src:"/Logo.PNG",alt:"Mind Core Fitness",className:"cb-loading-logo"})})});if(!h)return null;const be=h.slots.find(z=>z.memberId===S.id),Me=h.waitlist?.some(z=>z.memberId===S.id),Ce=h.slots.filter(z=>z.status==="available").length,P=Ce===0,F=yd(),B=new Date(F);B.setDate(B.getDate()-3),B.setHours(23,59,59,999);const se=new Date>B,Z=new Date(F);Z.setHours(9,0,0,0),Z.setTime(Z.getTime()-1440*60*1e3);const Q=new Date>Z;return u.jsxs("div",{className:`cb-page ${j?"dark":""}`,children:[u.jsxs("header",{className:"cb-header",children:[u.jsx("button",{className:"cb-back-btn",onClick:()=>Y("/client/circuit"),children:u.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:u.jsx("path",{d:"M19 12H5M12 19l-7-7 7-7"})})}),u.jsx("h1",{children:"Class Booking"}),u.jsx("div",{className:"cb-header-spacer"})]}),u.jsxs("main",{className:"cb-main",children:[u.jsxs("div",{className:"cb-class-info",children:[u.jsx("h2",{children:iR(h.date)}),u.jsxs("p",{children:[h.time," - ",h.endTime,"  ",Ce," slot",Ce!==1?"s":""," available"]})]}),se&&!be&&u.jsx("div",{className:"cb-deadline-notice",children:"Booking deadline has passed for this week"}),u.jsx("div",{className:"cb-slots-grid",children:h.slots.map(z=>{const Ye=z.memberId===S.id,me=z.status==="available";return z.memberType,u.jsxs("div",{className:`cb-slot ${Ye?"mine":""} ${me?"available":"filled"}`,children:[u.jsx("div",{className:"cb-slot-number",children:z.slotNumber}),u.jsx("div",{className:"cb-slot-body",children:me?u.jsxs(u.Fragment,{children:[u.jsx("span",{className:"cb-slot-available",children:"Available"}),!be&&!se&&u.jsx("button",{className:"cb-slot-book-btn",onClick:()=>J(z.slotNumber),disabled:t,children:"Book"})]}):u.jsxs(u.Fragment,{children:[u.jsx("span",{className:"cb-slot-name",children:z.memberName}),u.jsx("span",{className:`cb-slot-badge ${Iv(z.memberType)}`,children:Nv(z.memberType)})]})}),Ye&&u.jsx("button",{className:"cb-slot-release-btn",onClick:ae,disabled:t||Q,title:Q?"Cancellation deadline passed":"Cancel this slot",children:Q?"Locked":"Cancel"})]},z.slotNumber)})}),!be&&P&&u.jsx("div",{className:"cb-waitlist-section",children:Me?u.jsxs("div",{className:"cb-waitlist-status",children:[u.jsxs("p",{children:["You're on the waitlist (position #",(h.waitlist?.findIndex(z=>z.memberId===S.id)||0)+1,")"]}),u.jsx("button",{className:"cb-waitlist-leave-btn",onClick:ue,disabled:t,children:"Leave Waitlist"})]}):u.jsx("button",{className:"cb-waitlist-join-btn",onClick:ne,disabled:t,children:"Class Full - Join Waitlist"})}),h.waitlist?.length>0&&u.jsxs("div",{className:"cb-waitlist-preview",children:[u.jsxs("h4",{children:["Waitlist (",h.waitlist.length,")"]}),h.waitlist.map((z,Ye)=>u.jsxs("div",{className:"cb-waitlist-item",children:[u.jsxs("span",{className:"cb-waitlist-pos",children:["#",Ye+1]}),u.jsx("span",{className:"cb-waitlist-name",children:z.memberName}),u.jsx("span",{className:`cb-slot-badge ${Iv(z.memberType)}`,children:Nv(z.memberType)})]},z.memberId))]}),u.jsx("div",{className:"cb-rules",children:u.jsxs("p",{children:[u.jsx("strong",{children:"Book by Wednesday"}),"  ",u.jsx("strong",{children:"Cancel 24hrs before"}),"  ",u.jsx("strong",{children:"3 no-shows = 1 month ban"})]})})]}),y&&u.jsx("div",{className:`toast-notification ${y.type}`,children:u.jsx("span",{children:y.message})})]})}function aR(){const{currentUser:i,isClient:e,clientData:t,logout:a,loading:h}=Vi(),{isDark:f,toggleTheme:y}=Cl(),A=ai(),[C,E]=H.useState({hours:0,minutes:0,seconds:0}),[S,I]=H.useState(0),[j,Y]=H.useState(null),X=H.useCallback((ae,ne="info")=>{Y({message:ae,type:ne}),setTimeout(()=>Y(null),4e3)},[]);H.useEffect(()=>{!h&&!i&&A("/")},[h,i,A]),H.useEffect(()=>{const ae=()=>{const ue=new Date,be=new Date(ue);be.setHours(23,59,59,999);const Me=be-ue,Ce=Math.floor(Me/(1e3*60*60)),P=Math.floor(Me%(1e3*60*60)/(1e3*60)),F=Math.floor(Me%(1e3*60)/1e3);E({hours:Ce,minutes:P,seconds:F}),I(60-F)};ae();const ne=setInterval(ae,1e3);return()=>clearInterval(ne)},[]);const G=ae=>{const ne=ae.currentTarget,ue=ne.querySelector(".ripple");ue&&ue.remove();const be=ne.getBoundingClientRect(),Me=Math.max(be.width,be.height),Ce=ae.clientX-be.left-Me/2,P=ae.clientY-be.top-Me/2,F=document.createElement("span");F.className="ripple",F.style.cssText=`width:${Me}px;height:${Me}px;left:${Ce}px;top:${P}px;`,ne.appendChild(F),setTimeout(()=>F.remove(),600)},J=t?.name?.split(" ")[0]||"there";return h?u.jsx("div",{className:"cb-loading",children:u.jsx("div",{className:"cb-loading-spinner"})}):u.jsxs("div",{className:"cb-dashboard","data-theme":f?"dark":"light",children:[u.jsxs("header",{className:"cb-header",children:[u.jsxs("div",{className:"cb-header-left",children:[u.jsx("img",{src:"/Logo.PNG",alt:"Mind Core Fitness",className:"cb-header-logo"}),u.jsx("span",{className:"cb-header-title",children:"Core Buddy"})]}),u.jsxs("div",{className:"cb-header-right",children:[u.jsx("button",{className:"cb-theme-toggle",onClick:y,"aria-label":"Toggle theme",children:f?u.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[u.jsx("circle",{cx:"12",cy:"12",r:"5"}),u.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):u.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:u.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})}),u.jsx("button",{className:"cb-logout",onClick:a,"aria-label":"Log out",children:u.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[u.jsx("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),u.jsx("polyline",{points:"16 17 21 12 16 7"}),u.jsx("line",{x1:"21",y1:"12",x2:"9",y2:"12"})]})})]})]}),u.jsxs("main",{className:"cb-main",children:[u.jsx("div",{className:"cb-greeting",children:u.jsxs("h2",{children:["Hey ",J]})}),u.jsxs("div",{className:"cb-ring-container",children:[u.jsxs("div",{className:"cb-ring",children:[u.jsx("svg",{className:"cb-ring-svg",viewBox:"0 0 200 200",children:[...Array(60)].map((ae,ne)=>{const ue=(ne*6-90)*(Math.PI/180),be=85,Me=96,Ce=100+be*Math.cos(ue),P=100+be*Math.sin(ue),F=100+Me*Math.cos(ue),B=100+Me*Math.sin(ue),se=ne<S;return u.jsx("line",{x1:Ce,y1:P,x2:F,y2:B,className:`ring-tick ${se?"elapsed":"remaining"}`,strokeWidth:ne%5===0?"3":"2"},ne)})}),u.jsxs("div",{className:"cb-ring-center",children:[u.jsx("div",{className:"cb-ring-logo",children:u.jsx("img",{src:"/Logo.PNG",alt:"Mind Core Fitness"})}),u.jsxs("div",{className:"cb-ring-countdown",children:[u.jsx("span",{className:"cb-timer-digit",children:String(C.hours).padStart(2,"0")}),u.jsx("span",{className:"cb-timer-colon",children:":"}),u.jsx("span",{className:"cb-timer-digit",children:String(C.minutes).padStart(2,"0")}),u.jsx("span",{className:"cb-timer-colon",children:":"}),u.jsx("span",{className:"cb-timer-digit cb-timer-seconds",children:String(C.seconds).padStart(2,"0")})]}),u.jsx("div",{className:"cb-ring-label",children:"remaining today"})]})]}),u.jsxs("p",{className:"cb-ring-tagline",children:["You have 24 hours a day... ",u.jsx("strong",{children:"make it count"})," with Core Buddy"]})]}),u.jsxs("div",{className:"cb-features",children:[u.jsxs("button",{className:"cb-feature-card cb-card-nutrition cb-card-has-preview ripple-btn",onClick:ae=>{G(ae),A("/client/core-buddy/nutrition")},children:[u.jsxs("div",{className:"cb-card-top-row",children:[u.jsx("div",{className:"cb-card-icon cb-icon-nutrition",children:u.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[u.jsx("path",{d:"M18 8h1a4 4 0 0 1 0 8h-1"}),u.jsx("path",{d:"M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z"}),u.jsx("line",{x1:"6",y1:"1",x2:"6",y2:"4"}),u.jsx("line",{x1:"10",y1:"1",x2:"10",y2:"4"}),u.jsx("line",{x1:"14",y1:"1",x2:"14",y2:"4"})]})}),u.jsx("div",{className:"cb-card-content",children:u.jsx("h3",{children:"Today's Nutrition"})}),u.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:u.jsx("path",{d:"M9 18l6-6-6-6"})})]}),u.jsx("div",{className:"cb-card-preview-row",children:u.jsx("div",{className:"cb-mini-rings",children:[{cls:"cb-ring-protein",label:"P",filled:15},{cls:"cb-ring-carbs",label:"C",filled:28},{cls:"cb-ring-fats",label:"F",filled:38},{cls:"cb-ring-cals",label:"Cal",filled:22}].map(ae=>u.jsxs("div",{className:`cb-mini-ring ${ae.cls}`,children:[u.jsx("svg",{viewBox:"0 0 100 100",children:[...Array(60)].map((ne,ue)=>{const be=(ue*6-90)*(Math.PI/180),Me=50+38*Math.cos(be),Ce=50+38*Math.sin(be),P=50+46*Math.cos(be),F=50+46*Math.sin(be);return u.jsx("line",{x1:Me,y1:Ce,x2:P,y2:F,className:ue<ae.filled?"cb-tick-filled":"cb-tick-empty",strokeWidth:ue%5===0?"3":"2"},ue)})}),u.jsx("span",{children:ae.label})]},ae.cls))})}),u.jsx("p",{className:"cb-card-desc",children:"Track macros, scan barcodes, log water"})]}),u.jsxs("button",{className:"cb-feature-card cb-card-workouts ripple-btn",onClick:ae=>{G(ae),X("Workouts coming soon!","info")},children:[u.jsx("div",{className:"cb-card-icon cb-icon-workouts",children:u.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[u.jsx("path",{d:"M6.5 6.5L17.5 17.5"}),u.jsx("path",{d:"M3 10V7a1 1 0 0 1 1-1h3"}),u.jsx("path",{d:"M14 3h3a1 1 0 0 1 1 1v3"}),u.jsx("path",{d:"M21 14v3a1 1 0 0 1-1 1h-3"}),u.jsx("path",{d:"M10 21H7a1 1 0 0 1-1-1v-3"})]})}),u.jsxs("div",{className:"cb-card-content",children:[u.jsx("h3",{children:"Workouts"}),u.jsx("p",{children:"Randomise or build your own session"})]}),u.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:u.jsx("path",{d:"M9 18l6-6-6-6"})})]}),u.jsxs("button",{className:"cb-feature-card cb-card-progress ripple-btn",onClick:ae=>{G(ae),A("/client/personal-bests")},children:[u.jsx("div",{className:"cb-card-icon cb-icon-progress",children:u.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:u.jsx("polyline",{points:"22 12 18 12 15 21 9 3 6 12 2 12"})})}),u.jsxs("div",{className:"cb-card-content",children:[u.jsx("h3",{children:"My Progress"}),u.jsx("p",{children:"Track personal bests and body metrics"})]}),u.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:u.jsx("path",{d:"M9 18l6-6-6-6"})})]}),u.jsxs("button",{className:"cb-feature-card cb-card-consistency cb-card-has-preview ripple-btn",onClick:ae=>{G(ae),X("Consistency tracking coming soon!","info")},children:[u.jsxs("div",{className:"cb-card-top-row",children:[u.jsx("div",{className:"cb-card-icon cb-icon-consistency",children:u.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:u.jsx("path",{d:"M12 2L15.09 8.26L22 9.27L17 14.14L18.18 21.02L12 17.77L5.82 21.02L7 14.14L2 9.27L8.91 8.26L12 2z"})})}),u.jsx("div",{className:"cb-card-content",children:u.jsx("h3",{children:"Consistency"})}),u.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:u.jsx("path",{d:"M9 18l6-6-6-6"})})]}),u.jsx("div",{className:"cb-card-preview-row",children:u.jsx("div",{className:"cb-week-rings",children:["M","T","W","T","F","S","S"].map((ae,ne)=>{const ue=ne<3?[55,42,30][ne]:0;return u.jsxs("div",{className:`cb-week-ring ${ne<3?"cb-week-ring-active":""}`,children:[u.jsx("svg",{viewBox:"0 0 100 100",children:[...Array(60)].map((be,Me)=>{const Ce=(Me*6-90)*(Math.PI/180),P=50+38*Math.cos(Ce),F=50+38*Math.sin(Ce),B=50+46*Math.cos(Ce),se=50+46*Math.sin(Ce);return u.jsx("line",{x1:P,y1:F,x2:B,y2:se,className:Me<ue?"cb-week-tick-filled":"cb-week-tick-empty",strokeWidth:Me%5===0?"3":"2"},Me)})}),u.jsx("span",{children:ae})]},ne)})})}),u.jsx("p",{className:"cb-card-desc",children:"Weekly streaks and habit tracking"})]}),u.jsxs("button",{className:"cb-feature-card cb-card-leaderboard cb-card-locked ripple-btn",onClick:ae=>{G(ae),X("Leaderboard coming soon!","info")},children:[u.jsx("div",{className:"cb-card-icon cb-icon-leaderboard",children:u.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[u.jsx("path",{d:"M8 21h8"}),u.jsx("path",{d:"M12 17v4"}),u.jsx("path",{d:"M7 4h10l-1 9H8L7 4z"}),u.jsx("path",{d:"M17 4c0 0 2 0 2 2s-2 4-2 4"}),u.jsx("path",{d:"M7 4c0 0-2 0-2 2s2 4 2 4"})]})}),u.jsxs("div",{className:"cb-card-content",children:[u.jsx("h3",{children:"Leaderboard"}),u.jsx("p",{children:"Compete with your Core Buddies"})]}),u.jsx("span",{className:"cb-coming-soon",children:"Coming Soon"}),u.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:u.jsx("path",{d:"M9 18l6-6-6-6"})})]})]})]}),j&&u.jsxs("div",{className:`toast-notification ${j.type}`,children:[j.type==="info"&&u.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[u.jsx("circle",{cx:"12",cy:"12",r:"10"}),u.jsx("line",{x1:"12",y1:"16",x2:"12",y2:"12"}),u.jsx("line",{x1:"12",y1:"8",x2:"12.01",y2:"8"})]}),j.message]})]})}var ct;(function(i){i[i.QR_CODE=0]="QR_CODE",i[i.AZTEC=1]="AZTEC",i[i.CODABAR=2]="CODABAR",i[i.CODE_39=3]="CODE_39",i[i.CODE_93=4]="CODE_93",i[i.CODE_128=5]="CODE_128",i[i.DATA_MATRIX=6]="DATA_MATRIX",i[i.MAXICODE=7]="MAXICODE",i[i.ITF=8]="ITF",i[i.EAN_13=9]="EAN_13",i[i.EAN_8=10]="EAN_8",i[i.PDF_417=11]="PDF_417",i[i.RSS_14=12]="RSS_14",i[i.RSS_EXPANDED=13]="RSS_EXPANDED",i[i.UPC_A=14]="UPC_A",i[i.UPC_E=15]="UPC_E",i[i.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"})(ct||(ct={}));var Rv=new Map([[ct.QR_CODE,"QR_CODE"],[ct.AZTEC,"AZTEC"],[ct.CODABAR,"CODABAR"],[ct.CODE_39,"CODE_39"],[ct.CODE_93,"CODE_93"],[ct.CODE_128,"CODE_128"],[ct.DATA_MATRIX,"DATA_MATRIX"],[ct.MAXICODE,"MAXICODE"],[ct.ITF,"ITF"],[ct.EAN_13,"EAN_13"],[ct.EAN_8,"EAN_8"],[ct.PDF_417,"PDF_417"],[ct.RSS_14,"RSS_14"],[ct.RSS_EXPANDED,"RSS_EXPANDED"],[ct.UPC_A,"UPC_A"],[ct.UPC_E,"UPC_E"],[ct.UPC_EAN_EXTENSION,"UPC_EAN_EXTENSION"]]),Dv;(function(i){i[i.UNKNOWN=0]="UNKNOWN",i[i.URL=1]="URL"})(Dv||(Dv={}));function oR(i){return Object.values(ct).includes(i)}var nf;(function(i){i[i.SCAN_TYPE_CAMERA=0]="SCAN_TYPE_CAMERA",i[i.SCAN_TYPE_FILE=1]="SCAN_TYPE_FILE"})(nf||(nf={}));var lR=(function(){function i(){}return i.GITHUB_PROJECT_URL="https://github.com/mebjas/html5-qrcode",i.SCAN_DEFAULT_FPS=2,i.DEFAULT_DISABLE_FLIP=!1,i.DEFAULT_REMEMBER_LAST_CAMERA_USED=!0,i.DEFAULT_SUPPORTED_SCAN_TYPE=[nf.SCAN_TYPE_CAMERA,nf.SCAN_TYPE_FILE],i})(),WE=(function(){function i(e,t){this.format=e,this.formatName=t}return i.prototype.toString=function(){return this.formatName},i.create=function(e){if(!Rv.has(e))throw"".concat(e," not in html5QrcodeSupportedFormatsTextMap");return new i(e,Rv.get(e))},i})(),kv=(function(){function i(){}return i.createFromText=function(e){var t={text:e};return{decodedText:e,result:t}},i.createFromQrcodeResult=function(e){return{decodedText:e.text,result:e}},i})(),Em;(function(i){i[i.UNKWOWN_ERROR=0]="UNKWOWN_ERROR",i[i.IMPLEMENTATION_ERROR=1]="IMPLEMENTATION_ERROR",i[i.NO_CODE_FOUND_ERROR=2]="NO_CODE_FOUND_ERROR"})(Em||(Em={}));var cR=(function(){function i(){}return i.createFrom=function(e){return{errorMessage:e,type:Em.UNKWOWN_ERROR}},i})(),uR=(function(){function i(e){this.verbose=e}return i.prototype.log=function(e){this.verbose&&console.log(e)},i.prototype.warn=function(e){this.verbose&&console.warn(e)},i.prototype.logError=function(e,t){(this.verbose||t===!0)&&console.error(e)},i.prototype.logErrors=function(e){if(e.length===0)throw"Logger#logError called without arguments";this.verbose&&console.error(e)},i})();function Sa(i){return typeof i>"u"||i===null}var lc=(function(){function i(){}return i.codeParseError=function(e){return"QR code parse error, error = ".concat(e)},i.errorGettingUserMedia=function(e){return"Error getting userMedia, error = ".concat(e)},i.onlyDeviceSupportedError=function(){return"The device doesn't support navigator.mediaDevices , only supported cameraIdOrConfig in this case is deviceId parameter (string)."},i.cameraStreamingNotSupported=function(){return"Camera streaming not supported by the browser."},i.unableToQuerySupportedDevices=function(){return"Unable to query supported devices, unknown error."},i.insecureContextCameraQueryError=function(){return"Camera access is only supported in secure context like https or localhost."},i.scannerPaused=function(){return"Scanner paused"},i})(),YE=(function(){function i(){}return i.isMediaStreamConstraintsValid=function(e,t){if(typeof e!="object"){var a=typeof e;return t.logError("videoConstraints should be of type object, the "+"object passed is of type ".concat(a,"."),!0),!1}for(var h=["autoGainControl","channelCount","echoCancellation","latency","noiseSuppression","sampleRate","sampleSize","volume"],f=new Set(h),y=Object.keys(e),A=0,C=y;A<C.length;A++){var E=C[A];if(f.has(E))return t.logError("".concat(E," is not supported videoConstaints."),!0),!1}return!0},i})(),Cu={exports:{}},hR=Cu.exports,Mv;function dR(){return Mv||(Mv=1,(function(i,e){(function(t,a){a(e)})(hR,(function(t){function a(M){return M==null}var h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(M,s){M.__proto__=s}||function(M,s){for(var o in s)s.hasOwnProperty(o)&&(M[o]=s[o])};function f(M,s){h(M,s);function o(){this.constructor=M}M.prototype=s===null?Object.create(s):(o.prototype=s.prototype,new o)}function y(M,s){var o=Object.setPrototypeOf;o?o(M,s):M.__proto__=s}function A(M,s){s===void 0&&(s=M.constructor);var o=Error.captureStackTrace;o&&o(M,s)}var C=(function(M){f(s,M);function s(o){var l=this.constructor,d=M.call(this,o)||this;return Object.defineProperty(d,"name",{value:l.name,enumerable:!1}),y(d,l.prototype),A(d),d}return s})(Error);class E extends C{constructor(s=void 0){super(s),this.message=s}getKind(){return this.constructor.kind}}E.kind="Exception";class S extends E{}S.kind="ArgumentException";class I extends E{}I.kind="IllegalArgumentException";class j{constructor(s){if(this.binarizer=s,s===null)throw new I("Binarizer must be non-null.")}getWidth(){return this.binarizer.getWidth()}getHeight(){return this.binarizer.getHeight()}getBlackRow(s,o){return this.binarizer.getBlackRow(s,o)}getBlackMatrix(){return(this.matrix===null||this.matrix===void 0)&&(this.matrix=this.binarizer.getBlackMatrix()),this.matrix}isCropSupported(){return this.binarizer.getLuminanceSource().isCropSupported()}crop(s,o,l,d){const m=this.binarizer.getLuminanceSource().crop(s,o,l,d);return new j(this.binarizer.createBinarizer(m))}isRotateSupported(){return this.binarizer.getLuminanceSource().isRotateSupported()}rotateCounterClockwise(){const s=this.binarizer.getLuminanceSource().rotateCounterClockwise();return new j(this.binarizer.createBinarizer(s))}rotateCounterClockwise45(){const s=this.binarizer.getLuminanceSource().rotateCounterClockwise45();return new j(this.binarizer.createBinarizer(s))}toString(){try{return this.getBlackMatrix().toString()}catch{return""}}}class Y extends E{static getChecksumInstance(){return new Y}}Y.kind="ChecksumException";class X{constructor(s){this.source=s}getLuminanceSource(){return this.source}getWidth(){return this.source.getWidth()}getHeight(){return this.source.getHeight()}}class G{static arraycopy(s,o,l,d,m){for(;m--;)l[d++]=s[o++]}static currentTimeMillis(){return Date.now()}}class J extends E{}J.kind="IndexOutOfBoundsException";class ae extends J{constructor(s=void 0,o=void 0){super(o),this.index=s,this.message=o}}ae.kind="ArrayIndexOutOfBoundsException";class ne{static fill(s,o){for(let l=0,d=s.length;l<d;l++)s[l]=o}static fillWithin(s,o,l,d){ne.rangeCheck(s.length,o,l);for(let m=o;m<l;m++)s[m]=d}static rangeCheck(s,o,l){if(o>l)throw new I("fromIndex("+o+") > toIndex("+l+")");if(o<0)throw new ae(o);if(l>s)throw new ae(l)}static asList(...s){return s}static create(s,o,l){return Array.from({length:s}).map(m=>Array.from({length:o}).fill(l))}static createInt32Array(s,o,l){return Array.from({length:s}).map(m=>Int32Array.from({length:o}).fill(l))}static equals(s,o){if(!s||!o||!s.length||!o.length||s.length!==o.length)return!1;for(let l=0,d=s.length;l<d;l++)if(s[l]!==o[l])return!1;return!0}static hashCode(s){if(s===null)return 0;let o=1;for(const l of s)o=31*o+l;return o}static fillUint8Array(s,o){for(let l=0;l!==s.length;l++)s[l]=o}static copyOf(s,o){return s.slice(0,o)}static copyOfUint8Array(s,o){if(s.length<=o){const l=new Uint8Array(o);return l.set(s),l}return s.slice(0,o)}static copyOfRange(s,o,l){const d=l-o,m=new Int32Array(d);return G.arraycopy(s,o,m,0,d),m}static binarySearch(s,o,l){l===void 0&&(l=ne.numberComparator);let d=0,m=s.length-1;for(;d<=m;){const p=m+d>>1,v=l(o,s[p]);if(v>0)d=p+1;else if(v<0)m=p-1;else return p}return-d-1}static numberComparator(s,o){return s-o}}class ue{static numberOfTrailingZeros(s){let o;if(s===0)return 32;let l=31;return o=s<<16,o!==0&&(l-=16,s=o),o=s<<8,o!==0&&(l-=8,s=o),o=s<<4,o!==0&&(l-=4,s=o),o=s<<2,o!==0&&(l-=2,s=o),l-(s<<1>>>31)}static numberOfLeadingZeros(s){if(s===0)return 32;let o=1;return s>>>16||(o+=16,s<<=16),s>>>24||(o+=8,s<<=8),s>>>28||(o+=4,s<<=4),s>>>30||(o+=2,s<<=2),o-=s>>>31,o}static toHexString(s){return s.toString(16)}static toBinaryString(s){return String(parseInt(String(s),2))}static bitCount(s){return s=s-(s>>>1&1431655765),s=(s&858993459)+(s>>>2&858993459),s=s+(s>>>4)&252645135,s=s+(s>>>8),s=s+(s>>>16),s&63}static truncDivision(s,o){return Math.trunc(s/o)}static parseInt(s,o=void 0){return parseInt(s,o)}}ue.MIN_VALUE_32_BITS=-2147483648,ue.MAX_VALUE=Number.MAX_SAFE_INTEGER;class be{constructor(s,o){s===void 0?(this.size=0,this.bits=new Int32Array(1)):(this.size=s,o==null?this.bits=be.makeArray(s):this.bits=o)}getSize(){return this.size}getSizeInBytes(){return Math.floor((this.size+7)/8)}ensureCapacity(s){if(s>this.bits.length*32){const o=be.makeArray(s);G.arraycopy(this.bits,0,o,0,this.bits.length),this.bits=o}}get(s){return(this.bits[Math.floor(s/32)]&1<<(s&31))!==0}set(s){this.bits[Math.floor(s/32)]|=1<<(s&31)}flip(s){this.bits[Math.floor(s/32)]^=1<<(s&31)}getNextSet(s){const o=this.size;if(s>=o)return o;const l=this.bits;let d=Math.floor(s/32),m=l[d];m&=~((1<<(s&31))-1);const p=l.length;for(;m===0;){if(++d===p)return o;m=l[d]}const v=d*32+ue.numberOfTrailingZeros(m);return v>o?o:v}getNextUnset(s){const o=this.size;if(s>=o)return o;const l=this.bits;let d=Math.floor(s/32),m=~l[d];m&=~((1<<(s&31))-1);const p=l.length;for(;m===0;){if(++d===p)return o;m=~l[d]}const v=d*32+ue.numberOfTrailingZeros(m);return v>o?o:v}setBulk(s,o){this.bits[Math.floor(s/32)]=o}setRange(s,o){if(o<s||s<0||o>this.size)throw new I;if(o===s)return;o--;const l=Math.floor(s/32),d=Math.floor(o/32),m=this.bits;for(let p=l;p<=d;p++){const v=p>l?0:s&31,T=(2<<(p<d?31:o&31))-(1<<v);m[p]|=T}}clear(){const s=this.bits.length,o=this.bits;for(let l=0;l<s;l++)o[l]=0}isRange(s,o,l){if(o<s||s<0||o>this.size)throw new I;if(o===s)return!0;o--;const d=Math.floor(s/32),m=Math.floor(o/32),p=this.bits;for(let v=d;v<=m;v++){const b=v>d?0:s&31,R=(2<<(v<m?31:o&31))-(1<<b)&4294967295;if((p[v]&R)!==(l?R:0))return!1}return!0}appendBit(s){this.ensureCapacity(this.size+1),s&&(this.bits[Math.floor(this.size/32)]|=1<<(this.size&31)),this.size++}appendBits(s,o){if(o<0||o>32)throw new I("Num bits must be between 0 and 32");this.ensureCapacity(this.size+o);for(let l=o;l>0;l--)this.appendBit((s>>l-1&1)===1)}appendBitArray(s){const o=s.size;this.ensureCapacity(this.size+o);for(let l=0;l<o;l++)this.appendBit(s.get(l))}xor(s){if(this.size!==s.size)throw new I("Sizes don't match");const o=this.bits;for(let l=0,d=o.length;l<d;l++)o[l]^=s.bits[l]}toBytes(s,o,l,d){for(let m=0;m<d;m++){let p=0;for(let v=0;v<8;v++)this.get(s)&&(p|=1<<7-v),s++;o[l+m]=p}}getBitArray(){return this.bits}reverse(){const s=new Int32Array(this.bits.length),o=Math.floor((this.size-1)/32),l=o+1,d=this.bits;for(let m=0;m<l;m++){let p=d[m];p=p>>1&1431655765|(p&1431655765)<<1,p=p>>2&858993459|(p&858993459)<<2,p=p>>4&252645135|(p&252645135)<<4,p=p>>8&16711935|(p&16711935)<<8,p=p>>16&65535|(p&65535)<<16,s[o-m]=p}if(this.size!==l*32){const m=l*32-this.size;let p=s[0]>>>m;for(let v=1;v<l;v++){const b=s[v];p|=b<<32-m,s[v-1]=p,p=b>>>m}s[l-1]=p}this.bits=s}static makeArray(s){return new Int32Array(Math.floor((s+31)/32))}equals(s){if(!(s instanceof be))return!1;const o=s;return this.size===o.size&&ne.equals(this.bits,o.bits)}hashCode(){return 31*this.size+ne.hashCode(this.bits)}toString(){let s="";for(let o=0,l=this.size;o<l;o++)(o&7)===0&&(s+=" "),s+=this.get(o)?"X":".";return s}clone(){return new be(this.size,this.bits.slice())}}var Me;(function(M){M[M.OTHER=0]="OTHER",M[M.PURE_BARCODE=1]="PURE_BARCODE",M[M.POSSIBLE_FORMATS=2]="POSSIBLE_FORMATS",M[M.TRY_HARDER=3]="TRY_HARDER",M[M.CHARACTER_SET=4]="CHARACTER_SET",M[M.ALLOWED_LENGTHS=5]="ALLOWED_LENGTHS",M[M.ASSUME_CODE_39_CHECK_DIGIT=6]="ASSUME_CODE_39_CHECK_DIGIT",M[M.ASSUME_GS1=7]="ASSUME_GS1",M[M.RETURN_CODABAR_START_END=8]="RETURN_CODABAR_START_END",M[M.NEED_RESULT_POINT_CALLBACK=9]="NEED_RESULT_POINT_CALLBACK",M[M.ALLOWED_EAN_EXTENSIONS=10]="ALLOWED_EAN_EXTENSIONS"})(Me||(Me={}));var Ce=Me;class P extends E{static getFormatInstance(){return new P}}P.kind="FormatException";var F;(function(M){M[M.Cp437=0]="Cp437",M[M.ISO8859_1=1]="ISO8859_1",M[M.ISO8859_2=2]="ISO8859_2",M[M.ISO8859_3=3]="ISO8859_3",M[M.ISO8859_4=4]="ISO8859_4",M[M.ISO8859_5=5]="ISO8859_5",M[M.ISO8859_6=6]="ISO8859_6",M[M.ISO8859_7=7]="ISO8859_7",M[M.ISO8859_8=8]="ISO8859_8",M[M.ISO8859_9=9]="ISO8859_9",M[M.ISO8859_10=10]="ISO8859_10",M[M.ISO8859_11=11]="ISO8859_11",M[M.ISO8859_13=12]="ISO8859_13",M[M.ISO8859_14=13]="ISO8859_14",M[M.ISO8859_15=14]="ISO8859_15",M[M.ISO8859_16=15]="ISO8859_16",M[M.SJIS=16]="SJIS",M[M.Cp1250=17]="Cp1250",M[M.Cp1251=18]="Cp1251",M[M.Cp1252=19]="Cp1252",M[M.Cp1256=20]="Cp1256",M[M.UnicodeBigUnmarked=21]="UnicodeBigUnmarked",M[M.UTF8=22]="UTF8",M[M.ASCII=23]="ASCII",M[M.Big5=24]="Big5",M[M.GB18030=25]="GB18030",M[M.EUC_KR=26]="EUC_KR"})(F||(F={}));class B{constructor(s,o,l,...d){this.valueIdentifier=s,this.name=l,typeof o=="number"?this.values=Int32Array.from([o]):this.values=o,this.otherEncodingNames=d,B.VALUE_IDENTIFIER_TO_ECI.set(s,this),B.NAME_TO_ECI.set(l,this);const m=this.values;for(let p=0,v=m.length;p!==v;p++){const b=m[p];B.VALUES_TO_ECI.set(b,this)}for(const p of d)B.NAME_TO_ECI.set(p,this)}getValueIdentifier(){return this.valueIdentifier}getName(){return this.name}getValue(){return this.values[0]}static getCharacterSetECIByValue(s){if(s<0||s>=900)throw new P("incorect value");const o=B.VALUES_TO_ECI.get(s);if(o===void 0)throw new P("incorect value");return o}static getCharacterSetECIByName(s){const o=B.NAME_TO_ECI.get(s);if(o===void 0)throw new P("incorect value");return o}equals(s){if(!(s instanceof B))return!1;const o=s;return this.getName()===o.getName()}}B.VALUE_IDENTIFIER_TO_ECI=new Map,B.VALUES_TO_ECI=new Map,B.NAME_TO_ECI=new Map,B.Cp437=new B(F.Cp437,Int32Array.from([0,2]),"Cp437"),B.ISO8859_1=new B(F.ISO8859_1,Int32Array.from([1,3]),"ISO-8859-1","ISO88591","ISO8859_1"),B.ISO8859_2=new B(F.ISO8859_2,4,"ISO-8859-2","ISO88592","ISO8859_2"),B.ISO8859_3=new B(F.ISO8859_3,5,"ISO-8859-3","ISO88593","ISO8859_3"),B.ISO8859_4=new B(F.ISO8859_4,6,"ISO-8859-4","ISO88594","ISO8859_4"),B.ISO8859_5=new B(F.ISO8859_5,7,"ISO-8859-5","ISO88595","ISO8859_5"),B.ISO8859_6=new B(F.ISO8859_6,8,"ISO-8859-6","ISO88596","ISO8859_6"),B.ISO8859_7=new B(F.ISO8859_7,9,"ISO-8859-7","ISO88597","ISO8859_7"),B.ISO8859_8=new B(F.ISO8859_8,10,"ISO-8859-8","ISO88598","ISO8859_8"),B.ISO8859_9=new B(F.ISO8859_9,11,"ISO-8859-9","ISO88599","ISO8859_9"),B.ISO8859_10=new B(F.ISO8859_10,12,"ISO-8859-10","ISO885910","ISO8859_10"),B.ISO8859_11=new B(F.ISO8859_11,13,"ISO-8859-11","ISO885911","ISO8859_11"),B.ISO8859_13=new B(F.ISO8859_13,15,"ISO-8859-13","ISO885913","ISO8859_13"),B.ISO8859_14=new B(F.ISO8859_14,16,"ISO-8859-14","ISO885914","ISO8859_14"),B.ISO8859_15=new B(F.ISO8859_15,17,"ISO-8859-15","ISO885915","ISO8859_15"),B.ISO8859_16=new B(F.ISO8859_16,18,"ISO-8859-16","ISO885916","ISO8859_16"),B.SJIS=new B(F.SJIS,20,"SJIS","Shift_JIS"),B.Cp1250=new B(F.Cp1250,21,"Cp1250","windows-1250"),B.Cp1251=new B(F.Cp1251,22,"Cp1251","windows-1251"),B.Cp1252=new B(F.Cp1252,23,"Cp1252","windows-1252"),B.Cp1256=new B(F.Cp1256,24,"Cp1256","windows-1256"),B.UnicodeBigUnmarked=new B(F.UnicodeBigUnmarked,25,"UnicodeBigUnmarked","UTF-16BE","UnicodeBig"),B.UTF8=new B(F.UTF8,26,"UTF8","UTF-8"),B.ASCII=new B(F.ASCII,Int32Array.from([27,170]),"ASCII","US-ASCII"),B.Big5=new B(F.Big5,28,"Big5"),B.GB18030=new B(F.GB18030,29,"GB18030","GB2312","EUC_CN","GBK"),B.EUC_KR=new B(F.EUC_KR,30,"EUC_KR","EUC-KR");class se extends E{}se.kind="UnsupportedOperationException";class Z{static decode(s,o){const l=this.encodingName(o);return this.customDecoder?this.customDecoder(s,l):typeof TextDecoder>"u"||this.shouldDecodeOnFallback(l)?this.decodeFallback(s,l):new TextDecoder(l).decode(s)}static shouldDecodeOnFallback(s){return!Z.isBrowser()&&s==="ISO-8859-1"}static encode(s,o){const l=this.encodingName(o);return this.customEncoder?this.customEncoder(s,l):typeof TextEncoder>"u"?this.encodeFallback(s):new TextEncoder().encode(s)}static isBrowser(){return typeof window<"u"&&{}.toString.call(window)==="[object Window]"}static encodingName(s){return typeof s=="string"?s:s.getName()}static encodingCharacterSet(s){return s instanceof B?s:B.getCharacterSetECIByName(s)}static decodeFallback(s,o){const l=this.encodingCharacterSet(o);if(Z.isDecodeFallbackSupported(l)){let d="";for(let m=0,p=s.length;m<p;m++){let v=s[m].toString(16);v.length<2&&(v="0"+v),d+="%"+v}return decodeURIComponent(d)}if(l.equals(B.UnicodeBigUnmarked))return String.fromCharCode.apply(null,new Uint16Array(s.buffer));throw new se(`Encoding ${this.encodingName(o)} not supported by fallback.`)}static isDecodeFallbackSupported(s){return s.equals(B.UTF8)||s.equals(B.ISO8859_1)||s.equals(B.ASCII)}static encodeFallback(s){const l=btoa(unescape(encodeURIComponent(s))).split(""),d=[];for(let m=0;m<l.length;m++)d.push(l[m].charCodeAt(0));return new Uint8Array(d)}}class Q{static castAsNonUtf8Char(s,o=null){const l=o?o.getName():this.ISO88591;return Z.decode(new Uint8Array([s]),l)}static guessEncoding(s,o){if(o!=null&&o.get(Ce.CHARACTER_SET)!==void 0)return o.get(Ce.CHARACTER_SET).toString();const l=s.length;let d=!0,m=!0,p=!0,v=0,b=0,T=0,R=0,O=0,V=0,K=0,le=0,he=0,we=0,De=0;const $e=s.length>3&&s[0]===239&&s[1]===187&&s[2]===191;for(let Qe=0;Qe<l&&(d||m||p);Qe++){const Xe=s[Qe]&255;p&&(v>0?(Xe&128)===0?p=!1:v--:(Xe&128)!==0&&((Xe&64)===0?p=!1:(v++,(Xe&32)===0?b++:(v++,(Xe&16)===0?T++:(v++,(Xe&8)===0?R++:p=!1))))),d&&(Xe>127&&Xe<160?d=!1:Xe>159&&(Xe<192||Xe===215||Xe===247)&&De++),m&&(O>0?Xe<64||Xe===127||Xe>252?m=!1:O--:Xe===128||Xe===160||Xe>239?m=!1:Xe>160&&Xe<224?(V++,le=0,K++,K>he&&(he=K)):Xe>127?(O++,K=0,le++,le>we&&(we=le)):(K=0,le=0))}return p&&v>0&&(p=!1),m&&O>0&&(m=!1),p&&($e||b+T+R>0)?Q.UTF8:m&&(Q.ASSUME_SHIFT_JIS||he>=3||we>=3)?Q.SHIFT_JIS:d&&m?he===2&&V===2||De*10>=l?Q.SHIFT_JIS:Q.ISO88591:d?Q.ISO88591:m?Q.SHIFT_JIS:p?Q.UTF8:Q.PLATFORM_DEFAULT_ENCODING}static format(s,...o){let l=-1;function d(p,v,b,T,R,O){if(p==="%%")return"%";if(o[++l]===void 0)return;p=T?parseInt(T.substr(1)):void 0;let V=R?parseInt(R.substr(1)):void 0,K;switch(O){case"s":K=o[l];break;case"c":K=o[l][0];break;case"f":K=parseFloat(o[l]).toFixed(p);break;case"p":K=parseFloat(o[l]).toPrecision(p);break;case"e":K=parseFloat(o[l]).toExponential(p);break;case"x":K=parseInt(o[l]).toString(V||16);break;case"d":K=parseFloat(parseInt(o[l],V||10).toPrecision(p)).toFixed(0);break}K=typeof K=="object"?JSON.stringify(K):(+K).toString(V);let le=parseInt(b),he=b&&b[0]+""=="0"?"0":" ";for(;K.length<le;)K=v!==void 0?K+he:he+K;return K}let m=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return s.replace(m,d)}static getBytes(s,o){return Z.encode(s,o)}static getCharCode(s,o=0){return s.charCodeAt(o)}static getCharAt(s){return String.fromCharCode(s)}}Q.SHIFT_JIS=B.SJIS.getName(),Q.GB2312="GB2312",Q.ISO88591=B.ISO8859_1.getName(),Q.EUC_JP="EUC_JP",Q.UTF8=B.UTF8.getName(),Q.PLATFORM_DEFAULT_ENCODING=Q.UTF8,Q.ASSUME_SHIFT_JIS=!1;class z{constructor(s=""){this.value=s}enableDecoding(s){return this.encoding=s,this}append(s){return typeof s=="string"?this.value+=s.toString():this.encoding?this.value+=Q.castAsNonUtf8Char(s,this.encoding):this.value+=String.fromCharCode(s),this}appendChars(s,o,l){for(let d=o;o<o+l;d++)this.append(s[d]);return this}length(){return this.value.length}charAt(s){return this.value.charAt(s)}deleteCharAt(s){this.value=this.value.substr(0,s)+this.value.substring(s+1)}setCharAt(s,o){this.value=this.value.substr(0,s)+o+this.value.substr(s+1)}substring(s,o){return this.value.substring(s,o)}setLengthToZero(){this.value=""}toString(){return this.value}insert(s,o){this.value=this.value.substr(0,s)+o+this.value.substr(s+o.length)}}class Ye{constructor(s,o,l,d){if(this.width=s,this.height=o,this.rowSize=l,this.bits=d,o==null&&(o=s),this.height=o,s<1||o<1)throw new I("Both dimensions must be greater than 0");l==null&&(l=Math.floor((s+31)/32)),this.rowSize=l,d==null&&(this.bits=new Int32Array(this.rowSize*this.height))}static parseFromBooleanArray(s){const o=s.length,l=s[0].length,d=new Ye(l,o);for(let m=0;m<o;m++){const p=s[m];for(let v=0;v<l;v++)p[v]&&d.set(v,m)}return d}static parseFromString(s,o,l){if(s===null)throw new I("stringRepresentation cannot be null");const d=new Array(s.length);let m=0,p=0,v=-1,b=0,T=0;for(;T<s.length;)if(s.charAt(T)===`
`||s.charAt(T)==="\r"){if(m>p){if(v===-1)v=m-p;else if(m-p!==v)throw new I("row lengths do not match");p=m,b++}T++}else if(s.substring(T,T+o.length)===o)T+=o.length,d[m]=!0,m++;else if(s.substring(T,T+l.length)===l)T+=l.length,d[m]=!1,m++;else throw new I("illegal character encountered: "+s.substring(T));if(m>p){if(v===-1)v=m-p;else if(m-p!==v)throw new I("row lengths do not match");b++}const R=new Ye(v,b);for(let O=0;O<m;O++)d[O]&&R.set(Math.floor(O%v),Math.floor(O/v));return R}get(s,o){const l=o*this.rowSize+Math.floor(s/32);return(this.bits[l]>>>(s&31)&1)!==0}set(s,o){const l=o*this.rowSize+Math.floor(s/32);this.bits[l]|=1<<(s&31)&4294967295}unset(s,o){const l=o*this.rowSize+Math.floor(s/32);this.bits[l]&=~(1<<(s&31)&4294967295)}flip(s,o){const l=o*this.rowSize+Math.floor(s/32);this.bits[l]^=1<<(s&31)&4294967295}xor(s){if(this.width!==s.getWidth()||this.height!==s.getHeight()||this.rowSize!==s.getRowSize())throw new I("input matrix dimensions do not match");const o=new be(Math.floor(this.width/32)+1),l=this.rowSize,d=this.bits;for(let m=0,p=this.height;m<p;m++){const v=m*l,b=s.getRow(m,o).getBitArray();for(let T=0;T<l;T++)d[v+T]^=b[T]}}clear(){const s=this.bits,o=s.length;for(let l=0;l<o;l++)s[l]=0}setRegion(s,o,l,d){if(o<0||s<0)throw new I("Left and top must be nonnegative");if(d<1||l<1)throw new I("Height and width must be at least 1");const m=s+l,p=o+d;if(p>this.height||m>this.width)throw new I("The region must fit inside the matrix");const v=this.rowSize,b=this.bits;for(let T=o;T<p;T++){const R=T*v;for(let O=s;O<m;O++)b[R+Math.floor(O/32)]|=1<<(O&31)&4294967295}}getRow(s,o){o==null||o.getSize()<this.width?o=new be(this.width):o.clear();const l=this.rowSize,d=this.bits,m=s*l;for(let p=0;p<l;p++)o.setBulk(p*32,d[m+p]);return o}setRow(s,o){G.arraycopy(o.getBitArray(),0,this.bits,s*this.rowSize,this.rowSize)}rotate180(){const s=this.getWidth(),o=this.getHeight();let l=new be(s),d=new be(s);for(let m=0,p=Math.floor((o+1)/2);m<p;m++)l=this.getRow(m,l),d=this.getRow(o-1-m,d),l.reverse(),d.reverse(),this.setRow(m,d),this.setRow(o-1-m,l)}getEnclosingRectangle(){const s=this.width,o=this.height,l=this.rowSize,d=this.bits;let m=s,p=o,v=-1,b=-1;for(let T=0;T<o;T++)for(let R=0;R<l;R++){const O=d[T*l+R];if(O!==0){if(T<p&&(p=T),T>b&&(b=T),R*32<m){let V=0;for(;(O<<31-V&4294967295)===0;)V++;R*32+V<m&&(m=R*32+V)}if(R*32+31>v){let V=31;for(;!(O>>>V);)V--;R*32+V>v&&(v=R*32+V)}}}return v<m||b<p?null:Int32Array.from([m,p,v-m+1,b-p+1])}getTopLeftOnBit(){const s=this.rowSize,o=this.bits;let l=0;for(;l<o.length&&o[l]===0;)l++;if(l===o.length)return null;const d=l/s;let m=l%s*32;const p=o[l];let v=0;for(;(p<<31-v&4294967295)===0;)v++;return m+=v,Int32Array.from([m,d])}getBottomRightOnBit(){const s=this.rowSize,o=this.bits;let l=o.length-1;for(;l>=0&&o[l]===0;)l--;if(l<0)return null;const d=Math.floor(l/s);let m=Math.floor(l%s)*32;const p=o[l];let v=31;for(;!(p>>>v);)v--;return m+=v,Int32Array.from([m,d])}getWidth(){return this.width}getHeight(){return this.height}getRowSize(){return this.rowSize}equals(s){if(!(s instanceof Ye))return!1;const o=s;return this.width===o.width&&this.height===o.height&&this.rowSize===o.rowSize&&ne.equals(this.bits,o.bits)}hashCode(){let s=this.width;return s=31*s+this.width,s=31*s+this.height,s=31*s+this.rowSize,s=31*s+ne.hashCode(this.bits),s}toString(s="X ",o="  ",l=`
`){return this.buildToString(s,o,l)}buildToString(s,o,l){let d=new z;for(let m=0,p=this.height;m<p;m++){for(let v=0,b=this.width;v<b;v++)d.append(this.get(v,m)?s:o);d.append(l)}return d.toString()}clone(){return new Ye(this.width,this.height,this.rowSize,this.bits.slice())}}class me extends E{static getNotFoundInstance(){return new me}}me.kind="NotFoundException";class te extends X{constructor(s){super(s),this.luminances=te.EMPTY,this.buckets=new Int32Array(te.LUMINANCE_BUCKETS)}getBlackRow(s,o){const l=this.getLuminanceSource(),d=l.getWidth();o==null||o.getSize()<d?o=new be(d):o.clear(),this.initArrays(d);const m=l.getRow(s,this.luminances),p=this.buckets;for(let b=0;b<d;b++)p[(m[b]&255)>>te.LUMINANCE_SHIFT]++;const v=te.estimateBlackPoint(p);if(d<3)for(let b=0;b<d;b++)(m[b]&255)<v&&o.set(b);else{let b=m[0]&255,T=m[1]&255;for(let R=1;R<d-1;R++){const O=m[R+1]&255;(T*4-b-O)/2<v&&o.set(R),b=T,T=O}}return o}getBlackMatrix(){const s=this.getLuminanceSource(),o=s.getWidth(),l=s.getHeight(),d=new Ye(o,l);this.initArrays(o);const m=this.buckets;for(let b=1;b<5;b++){const T=Math.floor(l*b/5),R=s.getRow(T,this.luminances),O=Math.floor(o*4/5);for(let V=Math.floor(o/5);V<O;V++){const K=R[V]&255;m[K>>te.LUMINANCE_SHIFT]++}}const p=te.estimateBlackPoint(m),v=s.getMatrix();for(let b=0;b<l;b++){const T=b*o;for(let R=0;R<o;R++)(v[T+R]&255)<p&&d.set(R,b)}return d}createBinarizer(s){return new te(s)}initArrays(s){this.luminances.length<s&&(this.luminances=new Uint8ClampedArray(s));const o=this.buckets;for(let l=0;l<te.LUMINANCE_BUCKETS;l++)o[l]=0}static estimateBlackPoint(s){const o=s.length;let l=0,d=0,m=0;for(let R=0;R<o;R++)s[R]>m&&(d=R,m=s[R]),s[R]>l&&(l=s[R]);let p=0,v=0;for(let R=0;R<o;R++){const O=R-d,V=s[R]*O*O;V>v&&(p=R,v=V)}if(d>p){const R=d;d=p,p=R}if(p-d<=o/16)throw new me;let b=p-1,T=-1;for(let R=p-1;R>d;R--){const O=R-d,V=O*O*(p-R)*(l-s[R]);V>T&&(b=R,T=V)}return b<<te.LUMINANCE_SHIFT}}te.LUMINANCE_BITS=5,te.LUMINANCE_SHIFT=8-te.LUMINANCE_BITS,te.LUMINANCE_BUCKETS=1<<te.LUMINANCE_BITS,te.EMPTY=Uint8ClampedArray.from([0]);class ge extends te{constructor(s){super(s),this.matrix=null}getBlackMatrix(){if(this.matrix!==null)return this.matrix;const s=this.getLuminanceSource(),o=s.getWidth(),l=s.getHeight();if(o>=ge.MINIMUM_DIMENSION&&l>=ge.MINIMUM_DIMENSION){const d=s.getMatrix();let m=o>>ge.BLOCK_SIZE_POWER;(o&ge.BLOCK_SIZE_MASK)!==0&&m++;let p=l>>ge.BLOCK_SIZE_POWER;(l&ge.BLOCK_SIZE_MASK)!==0&&p++;const v=ge.calculateBlackPoints(d,m,p,o,l),b=new Ye(o,l);ge.calculateThresholdForBlock(d,m,p,o,l,v,b),this.matrix=b}else this.matrix=super.getBlackMatrix();return this.matrix}createBinarizer(s){return new ge(s)}static calculateThresholdForBlock(s,o,l,d,m,p,v){const b=m-ge.BLOCK_SIZE,T=d-ge.BLOCK_SIZE;for(let R=0;R<l;R++){let O=R<<ge.BLOCK_SIZE_POWER;O>b&&(O=b);const V=ge.cap(R,2,l-3);for(let K=0;K<o;K++){let le=K<<ge.BLOCK_SIZE_POWER;le>T&&(le=T);const he=ge.cap(K,2,o-3);let we=0;for(let $e=-2;$e<=2;$e++){const Qe=p[V+$e];we+=Qe[he-2]+Qe[he-1]+Qe[he]+Qe[he+1]+Qe[he+2]}const De=we/25;ge.thresholdBlock(s,le,O,De,d,v)}}}static cap(s,o,l){return s<o?o:s>l?l:s}static thresholdBlock(s,o,l,d,m,p){for(let v=0,b=l*m+o;v<ge.BLOCK_SIZE;v++,b+=m)for(let T=0;T<ge.BLOCK_SIZE;T++)(s[b+T]&255)<=d&&p.set(o+T,l+v)}static calculateBlackPoints(s,o,l,d,m){const p=m-ge.BLOCK_SIZE,v=d-ge.BLOCK_SIZE,b=new Array(l);for(let T=0;T<l;T++){b[T]=new Int32Array(o);let R=T<<ge.BLOCK_SIZE_POWER;R>p&&(R=p);for(let O=0;O<o;O++){let V=O<<ge.BLOCK_SIZE_POWER;V>v&&(V=v);let K=0,le=255,he=0;for(let De=0,$e=R*d+V;De<ge.BLOCK_SIZE;De++,$e+=d){for(let Qe=0;Qe<ge.BLOCK_SIZE;Qe++){const Xe=s[$e+Qe]&255;K+=Xe,Xe<le&&(le=Xe),Xe>he&&(he=Xe)}if(he-le>ge.MIN_DYNAMIC_RANGE)for(De++,$e+=d;De<ge.BLOCK_SIZE;De++,$e+=d)for(let Qe=0;Qe<ge.BLOCK_SIZE;Qe++)K+=s[$e+Qe]&255}let we=K>>ge.BLOCK_SIZE_POWER*2;if(he-le<=ge.MIN_DYNAMIC_RANGE&&(we=le/2,T>0&&O>0)){const De=(b[T-1][O]+2*b[T][O-1]+b[T-1][O-1])/4;le<De&&(we=De)}b[T][O]=we}}return b}}ge.BLOCK_SIZE_POWER=3,ge.BLOCK_SIZE=1<<ge.BLOCK_SIZE_POWER,ge.BLOCK_SIZE_MASK=ge.BLOCK_SIZE-1,ge.MINIMUM_DIMENSION=ge.BLOCK_SIZE*5,ge.MIN_DYNAMIC_RANGE=24;class He{constructor(s,o){this.width=s,this.height=o}getWidth(){return this.width}getHeight(){return this.height}isCropSupported(){return!1}crop(s,o,l,d){throw new se("This luminance source does not support cropping.")}isRotateSupported(){return!1}rotateCounterClockwise(){throw new se("This luminance source does not support rotation by 90 degrees.")}rotateCounterClockwise45(){throw new se("This luminance source does not support rotation by 45 degrees.")}toString(){const s=new Uint8ClampedArray(this.width);let o=new z;for(let l=0;l<this.height;l++){const d=this.getRow(l,s);for(let m=0;m<this.width;m++){const p=d[m]&255;let v;p<64?v="#":p<128?v="+":p<192?v=".":v=" ",o.append(v)}o.append(`
`)}return o.toString()}}class Ne extends He{constructor(s){super(s.getWidth(),s.getHeight()),this.delegate=s}getRow(s,o){const l=this.delegate.getRow(s,o),d=this.getWidth();for(let m=0;m<d;m++)l[m]=255-(l[m]&255);return l}getMatrix(){const s=this.delegate.getMatrix(),o=this.getWidth()*this.getHeight(),l=new Uint8ClampedArray(o);for(let d=0;d<o;d++)l[d]=255-(s[d]&255);return l}isCropSupported(){return this.delegate.isCropSupported()}crop(s,o,l,d){return new Ne(this.delegate.crop(s,o,l,d))}isRotateSupported(){return this.delegate.isRotateSupported()}invert(){return this.delegate}rotateCounterClockwise(){return new Ne(this.delegate.rotateCounterClockwise())}rotateCounterClockwise45(){return new Ne(this.delegate.rotateCounterClockwise45())}}class tt extends He{constructor(s){super(s.width,s.height),this.canvas=s,this.tempCanvasElement=null,this.buffer=tt.makeBufferFromCanvasImageData(s)}static makeBufferFromCanvasImageData(s){const o=s.getContext("2d").getImageData(0,0,s.width,s.height);return tt.toGrayscaleBuffer(o.data,s.width,s.height)}static toGrayscaleBuffer(s,o,l){const d=new Uint8ClampedArray(o*l);for(let m=0,p=0,v=s.length;m<v;m+=4,p++){let b;if(s[m+3]===0)b=255;else{const R=s[m],O=s[m+1],V=s[m+2];b=306*R+601*O+117*V+512>>10}d[p]=b}return d}getRow(s,o){if(s<0||s>=this.getHeight())throw new I("Requested row is outside the image: "+s);const l=this.getWidth(),d=s*l;return o===null?o=this.buffer.slice(d,d+l):(o.length<l&&(o=new Uint8ClampedArray(l)),o.set(this.buffer.slice(d,d+l))),o}getMatrix(){return this.buffer}isCropSupported(){return!0}crop(s,o,l,d){return super.crop(s,o,l,d),this}isRotateSupported(){return!0}rotateCounterClockwise(){return this.rotate(-90),this}rotateCounterClockwise45(){return this.rotate(-45),this}getTempCanvasElement(){if(this.tempCanvasElement===null){const s=this.canvas.ownerDocument.createElement("canvas");s.width=this.canvas.width,s.height=this.canvas.height,this.tempCanvasElement=s}return this.tempCanvasElement}rotate(s){const o=this.getTempCanvasElement(),l=o.getContext("2d"),d=s*tt.DEGREE_TO_RADIANS,m=this.canvas.width,p=this.canvas.height,v=Math.ceil(Math.abs(Math.cos(d))*m+Math.abs(Math.sin(d))*p),b=Math.ceil(Math.abs(Math.sin(d))*m+Math.abs(Math.cos(d))*p);return o.width=v,o.height=b,l.translate(v/2,b/2),l.rotate(d),l.drawImage(this.canvas,m/-2,p/-2),this.buffer=tt.makeBufferFromCanvasImageData(o),this}invert(){return new Ne(this)}}tt.DEGREE_TO_RADIANS=Math.PI/180;class L{constructor(s,o,l){this.deviceId=s,this.label=o,this.kind="videoinput",this.groupId=l||void 0}toJSON(){return{kind:this.kind,groupId:this.groupId,deviceId:this.deviceId,label:this.label}}}var oe=(globalThis||ld||self||window||void 0)&&(globalThis||ld||self||window||void 0).__awaiter||function(M,s,o,l){function d(m){return m instanceof o?m:new o(function(p){p(m)})}return new(o||(o=Promise))(function(m,p){function v(R){try{T(l.next(R))}catch(O){p(O)}}function b(R){try{T(l.throw(R))}catch(O){p(O)}}function T(R){R.done?m(R.value):d(R.value).then(v,b)}T((l=l.apply(M,s||[])).next())})};class ce{constructor(s,o=500,l){this.reader=s,this.timeBetweenScansMillis=o,this._hints=l,this._stopContinuousDecode=!1,this._stopAsyncDecode=!1,this._timeBetweenDecodingAttempts=0}get hasNavigator(){return typeof navigator<"u"}get isMediaDevicesSuported(){return this.hasNavigator&&!!navigator.mediaDevices}get canEnumerateDevices(){return!!(this.isMediaDevicesSuported&&navigator.mediaDevices.enumerateDevices)}get timeBetweenDecodingAttempts(){return this._timeBetweenDecodingAttempts}set timeBetweenDecodingAttempts(s){this._timeBetweenDecodingAttempts=s<0?0:s}set hints(s){this._hints=s||null}get hints(){return this._hints}listVideoInputDevices(){return oe(this,void 0,void 0,function*(){if(!this.hasNavigator)throw new Error("Can't enumerate devices, navigator is not present.");if(!this.canEnumerateDevices)throw new Error("Can't enumerate devices, method not supported.");const s=yield navigator.mediaDevices.enumerateDevices(),o=[];for(const l of s){const d=l.kind==="video"?"videoinput":l.kind;if(d!=="videoinput")continue;const m=l.deviceId||l.id,p=l.label||`Video device ${o.length+1}`,v=l.groupId,b={deviceId:m,label:p,kind:d,groupId:v};o.push(b)}return o})}getVideoInputDevices(){return oe(this,void 0,void 0,function*(){return(yield this.listVideoInputDevices()).map(o=>new L(o.deviceId,o.label))})}findDeviceById(s){return oe(this,void 0,void 0,function*(){const o=yield this.listVideoInputDevices();return o?o.find(l=>l.deviceId===s):null})}decodeFromInputVideoDevice(s,o){return oe(this,void 0,void 0,function*(){return yield this.decodeOnceFromVideoDevice(s,o)})}decodeOnceFromVideoDevice(s,o){return oe(this,void 0,void 0,function*(){this.reset();let l;s?l={deviceId:{exact:s}}:l={facingMode:"environment"};const d={video:l};return yield this.decodeOnceFromConstraints(d,o)})}decodeOnceFromConstraints(s,o){return oe(this,void 0,void 0,function*(){const l=yield navigator.mediaDevices.getUserMedia(s);return yield this.decodeOnceFromStream(l,o)})}decodeOnceFromStream(s,o){return oe(this,void 0,void 0,function*(){this.reset();const l=yield this.attachStreamToVideo(s,o);return yield this.decodeOnce(l)})}decodeFromInputVideoDeviceContinuously(s,o,l){return oe(this,void 0,void 0,function*(){return yield this.decodeFromVideoDevice(s,o,l)})}decodeFromVideoDevice(s,o,l){return oe(this,void 0,void 0,function*(){let d;s?d={deviceId:{exact:s}}:d={facingMode:"environment"};const m={video:d};return yield this.decodeFromConstraints(m,o,l)})}decodeFromConstraints(s,o,l){return oe(this,void 0,void 0,function*(){const d=yield navigator.mediaDevices.getUserMedia(s);return yield this.decodeFromStream(d,o,l)})}decodeFromStream(s,o,l){return oe(this,void 0,void 0,function*(){this.reset();const d=yield this.attachStreamToVideo(s,o);return yield this.decodeContinuously(d,l)})}stopAsyncDecode(){this._stopAsyncDecode=!0}stopContinuousDecode(){this._stopContinuousDecode=!0}attachStreamToVideo(s,o){return oe(this,void 0,void 0,function*(){const l=this.prepareVideoElement(o);return this.addVideoSource(l,s),this.videoElement=l,this.stream=s,yield this.playVideoOnLoadAsync(l),l})}playVideoOnLoadAsync(s){return new Promise((o,l)=>this.playVideoOnLoad(s,()=>o()))}playVideoOnLoad(s,o){this.videoEndedListener=()=>this.stopStreams(),this.videoCanPlayListener=()=>this.tryPlayVideo(s),s.addEventListener("ended",this.videoEndedListener),s.addEventListener("canplay",this.videoCanPlayListener),s.addEventListener("playing",o),this.tryPlayVideo(s)}isVideoPlaying(s){return s.currentTime>0&&!s.paused&&!s.ended&&s.readyState>2}tryPlayVideo(s){return oe(this,void 0,void 0,function*(){if(this.isVideoPlaying(s)){console.warn("Trying to play video that is already playing.");return}try{yield s.play()}catch{console.warn("It was not possible to play the video.")}})}getMediaElement(s,o){const l=document.getElementById(s);if(!l)throw new S(`element with id '${s}' not found`);if(l.nodeName.toLowerCase()!==o.toLowerCase())throw new S(`element with id '${s}' must be an ${o} element`);return l}decodeFromImage(s,o){if(!s&&!o)throw new S("either imageElement with a src set or an url must be provided");return o&&!s?this.decodeFromImageUrl(o):this.decodeFromImageElement(s)}decodeFromVideo(s,o){if(!s&&!o)throw new S("Either an element with a src set or an URL must be provided");return o&&!s?this.decodeFromVideoUrl(o):this.decodeFromVideoElement(s)}decodeFromVideoContinuously(s,o,l){if(s===void 0&&o===void 0)throw new S("Either an element with a src set or an URL must be provided");return o&&!s?this.decodeFromVideoUrlContinuously(o,l):this.decodeFromVideoElementContinuously(s,l)}decodeFromImageElement(s){if(!s)throw new S("An image element must be provided.");this.reset();const o=this.prepareImageElement(s);this.imageElement=o;let l;return this.isImageLoaded(o)?l=this.decodeOnce(o,!1,!0):l=this._decodeOnLoadImage(o),l}decodeFromVideoElement(s){const o=this._decodeFromVideoElementSetup(s);return this._decodeOnLoadVideo(o)}decodeFromVideoElementContinuously(s,o){const l=this._decodeFromVideoElementSetup(s);return this._decodeOnLoadVideoContinuously(l,o)}_decodeFromVideoElementSetup(s){if(!s)throw new S("A video element must be provided.");this.reset();const o=this.prepareVideoElement(s);return this.videoElement=o,o}decodeFromImageUrl(s){if(!s)throw new S("An URL must be provided.");this.reset();const o=this.prepareImageElement();this.imageElement=o;const l=this._decodeOnLoadImage(o);return o.src=s,l}decodeFromVideoUrl(s){if(!s)throw new S("An URL must be provided.");this.reset();const o=this.prepareVideoElement(),l=this.decodeFromVideoElement(o);return o.src=s,l}decodeFromVideoUrlContinuously(s,o){if(!s)throw new S("An URL must be provided.");this.reset();const l=this.prepareVideoElement(),d=this.decodeFromVideoElementContinuously(l,o);return l.src=s,d}_decodeOnLoadImage(s){return new Promise((o,l)=>{this.imageLoadedListener=()=>this.decodeOnce(s,!1,!0).then(o,l),s.addEventListener("load",this.imageLoadedListener)})}_decodeOnLoadVideo(s){return oe(this,void 0,void 0,function*(){return yield this.playVideoOnLoadAsync(s),yield this.decodeOnce(s)})}_decodeOnLoadVideoContinuously(s,o){return oe(this,void 0,void 0,function*(){yield this.playVideoOnLoadAsync(s),this.decodeContinuously(s,o)})}isImageLoaded(s){return!(!s.complete||s.naturalWidth===0)}prepareImageElement(s){let o;return typeof s>"u"&&(o=document.createElement("img"),o.width=200,o.height=200),typeof s=="string"&&(o=this.getMediaElement(s,"img")),s instanceof HTMLImageElement&&(o=s),o}prepareVideoElement(s){let o;return!s&&typeof document<"u"&&(o=document.createElement("video"),o.width=200,o.height=200),typeof s=="string"&&(o=this.getMediaElement(s,"video")),s instanceof HTMLVideoElement&&(o=s),o.setAttribute("autoplay","true"),o.setAttribute("muted","true"),o.setAttribute("playsinline","true"),o}decodeOnce(s,o=!0,l=!0){this._stopAsyncDecode=!1;const d=(m,p)=>{if(this._stopAsyncDecode){p(new me("Video stream has ended before any code could be detected.")),this._stopAsyncDecode=void 0;return}try{const v=this.decode(s);m(v)}catch(v){const b=o&&v instanceof me,R=(v instanceof Y||v instanceof P)&&l;if(b||R)return setTimeout(d,this._timeBetweenDecodingAttempts,m,p);p(v)}};return new Promise((m,p)=>d(m,p))}decodeContinuously(s,o){this._stopContinuousDecode=!1;const l=()=>{if(this._stopContinuousDecode){this._stopContinuousDecode=void 0;return}try{const d=this.decode(s);o(d,null),setTimeout(l,this.timeBetweenScansMillis)}catch(d){o(null,d);const m=d instanceof Y||d instanceof P,p=d instanceof me;(m||p)&&setTimeout(l,this._timeBetweenDecodingAttempts)}};l()}decode(s){const o=this.createBinaryBitmap(s);return this.decodeBitmap(o)}_isHTMLVideoElement(s){return s.videoWidth!==0}drawFrameOnCanvas(s,o,l){o||(o={sx:0,sy:0,sWidth:s.videoWidth,sHeight:s.videoHeight,dx:0,dy:0,dWidth:s.videoWidth,dHeight:s.videoHeight}),l||(l=this.captureCanvasContext),l.drawImage(s,o.sx,o.sy,o.sWidth,o.sHeight,o.dx,o.dy,o.dWidth,o.dHeight)}drawImageOnCanvas(s,o,l=this.captureCanvasContext){o||(o={sx:0,sy:0,sWidth:s.naturalWidth,sHeight:s.naturalHeight,dx:0,dy:0,dWidth:s.naturalWidth,dHeight:s.naturalHeight}),l||(l=this.captureCanvasContext),l.drawImage(s,o.sx,o.sy,o.sWidth,o.sHeight,o.dx,o.dy,o.dWidth,o.dHeight)}createBinaryBitmap(s){this.getCaptureCanvasContext(s),this._isHTMLVideoElement(s)?this.drawFrameOnCanvas(s):this.drawImageOnCanvas(s);const o=this.getCaptureCanvas(s),l=new tt(o),d=new ge(l);return new j(d)}getCaptureCanvasContext(s){if(!this.captureCanvasContext){const l=this.getCaptureCanvas(s).getContext("2d");this.captureCanvasContext=l}return this.captureCanvasContext}getCaptureCanvas(s){if(!this.captureCanvas){const o=this.createCaptureCanvas(s);this.captureCanvas=o}return this.captureCanvas}decodeBitmap(s){return this.reader.decode(s,this._hints)}createCaptureCanvas(s){if(typeof document>"u")return this._destroyCaptureCanvas(),null;const o=document.createElement("canvas");let l,d;return typeof s<"u"&&(s instanceof HTMLVideoElement?(l=s.videoWidth,d=s.videoHeight):s instanceof HTMLImageElement&&(l=s.naturalWidth||s.width,d=s.naturalHeight||s.height)),o.style.width=l+"px",o.style.height=d+"px",o.width=l,o.height=d,o}stopStreams(){this.stream&&(this.stream.getVideoTracks().forEach(s=>s.stop()),this.stream=void 0),this._stopAsyncDecode===!1&&this.stopAsyncDecode(),this._stopContinuousDecode===!1&&this.stopContinuousDecode()}reset(){this.stopStreams(),this._destroyVideoElement(),this._destroyImageElement(),this._destroyCaptureCanvas()}_destroyVideoElement(){this.videoElement&&(typeof this.videoEndedListener<"u"&&this.videoElement.removeEventListener("ended",this.videoEndedListener),typeof this.videoPlayingEventListener<"u"&&this.videoElement.removeEventListener("playing",this.videoPlayingEventListener),typeof this.videoCanPlayListener<"u"&&this.videoElement.removeEventListener("loadedmetadata",this.videoCanPlayListener),this.cleanVideoSource(this.videoElement),this.videoElement=void 0)}_destroyImageElement(){this.imageElement&&(this.imageLoadedListener!==void 0&&this.imageElement.removeEventListener("load",this.imageLoadedListener),this.imageElement.src=void 0,this.imageElement.removeAttribute("src"),this.imageElement=void 0)}_destroyCaptureCanvas(){this.captureCanvasContext=void 0,this.captureCanvas=void 0}addVideoSource(s,o){try{s.srcObject=o}catch{s.src=URL.createObjectURL(o)}}cleanVideoSource(s){try{s.srcObject=null}catch{s.src=""}this.videoElement.removeAttribute("src")}}class pe{constructor(s,o,l=o==null?0:8*o.length,d,m,p=G.currentTimeMillis()){this.text=s,this.rawBytes=o,this.numBits=l,this.resultPoints=d,this.format=m,this.timestamp=p,this.text=s,this.rawBytes=o,l==null?this.numBits=o==null?0:8*o.length:this.numBits=l,this.resultPoints=d,this.format=m,this.resultMetadata=null,p==null?this.timestamp=G.currentTimeMillis():this.timestamp=p}getText(){return this.text}getRawBytes(){return this.rawBytes}getNumBits(){return this.numBits}getResultPoints(){return this.resultPoints}getBarcodeFormat(){return this.format}getResultMetadata(){return this.resultMetadata}putMetadata(s,o){this.resultMetadata===null&&(this.resultMetadata=new Map),this.resultMetadata.set(s,o)}putAllMetadata(s){s!==null&&(this.resultMetadata===null?this.resultMetadata=s:this.resultMetadata=new Map(s))}addResultPoints(s){const o=this.resultPoints;if(o===null)this.resultPoints=s;else if(s!==null&&s.length>0){const l=new Array(o.length+s.length);G.arraycopy(o,0,l,0,o.length),G.arraycopy(s,0,l,o.length,s.length),this.resultPoints=l}}getTimestamp(){return this.timestamp}toString(){return this.text}}var ee;(function(M){M[M.AZTEC=0]="AZTEC",M[M.CODABAR=1]="CODABAR",M[M.CODE_39=2]="CODE_39",M[M.CODE_93=3]="CODE_93",M[M.CODE_128=4]="CODE_128",M[M.DATA_MATRIX=5]="DATA_MATRIX",M[M.EAN_8=6]="EAN_8",M[M.EAN_13=7]="EAN_13",M[M.ITF=8]="ITF",M[M.MAXICODE=9]="MAXICODE",M[M.PDF_417=10]="PDF_417",M[M.QR_CODE=11]="QR_CODE",M[M.RSS_14=12]="RSS_14",M[M.RSS_EXPANDED=13]="RSS_EXPANDED",M[M.UPC_A=14]="UPC_A",M[M.UPC_E=15]="UPC_E",M[M.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"})(ee||(ee={}));var ie=ee,Te;(function(M){M[M.OTHER=0]="OTHER",M[M.ORIENTATION=1]="ORIENTATION",M[M.BYTE_SEGMENTS=2]="BYTE_SEGMENTS",M[M.ERROR_CORRECTION_LEVEL=3]="ERROR_CORRECTION_LEVEL",M[M.ISSUE_NUMBER=4]="ISSUE_NUMBER",M[M.SUGGESTED_PRICE=5]="SUGGESTED_PRICE",M[M.POSSIBLE_COUNTRY=6]="POSSIBLE_COUNTRY",M[M.UPC_EAN_EXTENSION=7]="UPC_EAN_EXTENSION",M[M.PDF417_EXTRA_METADATA=8]="PDF417_EXTRA_METADATA",M[M.STRUCTURED_APPEND_SEQUENCE=9]="STRUCTURED_APPEND_SEQUENCE",M[M.STRUCTURED_APPEND_PARITY=10]="STRUCTURED_APPEND_PARITY"})(Te||(Te={}));var Pe=Te;class it{constructor(s,o,l,d,m=-1,p=-1){this.rawBytes=s,this.text=o,this.byteSegments=l,this.ecLevel=d,this.structuredAppendSequenceNumber=m,this.structuredAppendParity=p,this.numBits=s==null?0:8*s.length}getRawBytes(){return this.rawBytes}getNumBits(){return this.numBits}setNumBits(s){this.numBits=s}getText(){return this.text}getByteSegments(){return this.byteSegments}getECLevel(){return this.ecLevel}getErrorsCorrected(){return this.errorsCorrected}setErrorsCorrected(s){this.errorsCorrected=s}getErasures(){return this.erasures}setErasures(s){this.erasures=s}getOther(){return this.other}setOther(s){this.other=s}hasStructuredAppend(){return this.structuredAppendParity>=0&&this.structuredAppendSequenceNumber>=0}getStructuredAppendParity(){return this.structuredAppendParity}getStructuredAppendSequenceNumber(){return this.structuredAppendSequenceNumber}}class dt{exp(s){return this.expTable[s]}log(s){if(s===0)throw new I;return this.logTable[s]}static addOrSubtract(s,o){return s^o}}class Le{constructor(s,o){if(o.length===0)throw new I;this.field=s;const l=o.length;if(l>1&&o[0]===0){let d=1;for(;d<l&&o[d]===0;)d++;d===l?this.coefficients=Int32Array.from([0]):(this.coefficients=new Int32Array(l-d),G.arraycopy(o,d,this.coefficients,0,this.coefficients.length))}else this.coefficients=o}getCoefficients(){return this.coefficients}getDegree(){return this.coefficients.length-1}isZero(){return this.coefficients[0]===0}getCoefficient(s){return this.coefficients[this.coefficients.length-1-s]}evaluateAt(s){if(s===0)return this.getCoefficient(0);const o=this.coefficients;let l;if(s===1){l=0;for(let p=0,v=o.length;p!==v;p++){const b=o[p];l=dt.addOrSubtract(l,b)}return l}l=o[0];const d=o.length,m=this.field;for(let p=1;p<d;p++)l=dt.addOrSubtract(m.multiply(s,l),o[p]);return l}addOrSubtract(s){if(!this.field.equals(s.field))throw new I("GenericGFPolys do not have same GenericGF field");if(this.isZero())return s;if(s.isZero())return this;let o=this.coefficients,l=s.coefficients;if(o.length>l.length){const p=o;o=l,l=p}let d=new Int32Array(l.length);const m=l.length-o.length;G.arraycopy(l,0,d,0,m);for(let p=m;p<l.length;p++)d[p]=dt.addOrSubtract(o[p-m],l[p]);return new Le(this.field,d)}multiply(s){if(!this.field.equals(s.field))throw new I("GenericGFPolys do not have same GenericGF field");if(this.isZero()||s.isZero())return this.field.getZero();const o=this.coefficients,l=o.length,d=s.coefficients,m=d.length,p=new Int32Array(l+m-1),v=this.field;for(let b=0;b<l;b++){const T=o[b];for(let R=0;R<m;R++)p[b+R]=dt.addOrSubtract(p[b+R],v.multiply(T,d[R]))}return new Le(v,p)}multiplyScalar(s){if(s===0)return this.field.getZero();if(s===1)return this;const o=this.coefficients.length,l=this.field,d=new Int32Array(o),m=this.coefficients;for(let p=0;p<o;p++)d[p]=l.multiply(m[p],s);return new Le(l,d)}multiplyByMonomial(s,o){if(s<0)throw new I;if(o===0)return this.field.getZero();const l=this.coefficients,d=l.length,m=new Int32Array(d+s),p=this.field;for(let v=0;v<d;v++)m[v]=p.multiply(l[v],o);return new Le(p,m)}divide(s){if(!this.field.equals(s.field))throw new I("GenericGFPolys do not have same GenericGF field");if(s.isZero())throw new I("Divide by 0");const o=this.field;let l=o.getZero(),d=this;const m=s.getCoefficient(s.getDegree()),p=o.inverse(m);for(;d.getDegree()>=s.getDegree()&&!d.isZero();){const v=d.getDegree()-s.getDegree(),b=o.multiply(d.getCoefficient(d.getDegree()),p),T=s.multiplyByMonomial(v,b),R=o.buildMonomial(v,b);l=l.addOrSubtract(R),d=d.addOrSubtract(T)}return[l,d]}toString(){let s="";for(let o=this.getDegree();o>=0;o--){let l=this.getCoefficient(o);if(l!==0){if(l<0?(s+=" - ",l=-l):s.length>0&&(s+=" + "),o===0||l!==1){const d=this.field.log(l);d===0?s+="1":d===1?s+="a":(s+="a^",s+=d)}o!==0&&(o===1?s+="x":(s+="x^",s+=o))}}return s}}class qt extends E{}qt.kind="ArithmeticException";class wt extends dt{constructor(s,o,l){super(),this.primitive=s,this.size=o,this.generatorBase=l;const d=new Int32Array(o);let m=1;for(let v=0;v<o;v++)d[v]=m,m*=2,m>=o&&(m^=s,m&=o-1);this.expTable=d;const p=new Int32Array(o);for(let v=0;v<o-1;v++)p[d[v]]=v;this.logTable=p,this.zero=new Le(this,Int32Array.from([0])),this.one=new Le(this,Int32Array.from([1]))}getZero(){return this.zero}getOne(){return this.one}buildMonomial(s,o){if(s<0)throw new I;if(o===0)return this.zero;const l=new Int32Array(s+1);return l[0]=o,new Le(this,l)}inverse(s){if(s===0)throw new qt;return this.expTable[this.size-this.logTable[s]-1]}multiply(s,o){return s===0||o===0?0:this.expTable[(this.logTable[s]+this.logTable[o])%(this.size-1)]}getSize(){return this.size}getGeneratorBase(){return this.generatorBase}toString(){return"GF(0x"+ue.toHexString(this.primitive)+","+this.size+")"}equals(s){return s===this}}wt.AZTEC_DATA_12=new wt(4201,4096,1),wt.AZTEC_DATA_10=new wt(1033,1024,1),wt.AZTEC_DATA_6=new wt(67,64,1),wt.AZTEC_PARAM=new wt(19,16,1),wt.QR_CODE_FIELD_256=new wt(285,256,0),wt.DATA_MATRIX_FIELD_256=new wt(301,256,1),wt.AZTEC_DATA_8=wt.DATA_MATRIX_FIELD_256,wt.MAXICODE_FIELD_64=wt.AZTEC_DATA_6;class Zt extends E{}Zt.kind="ReedSolomonException";class zt extends E{}zt.kind="IllegalStateException";class Pt{constructor(s){this.field=s}decode(s,o){const l=this.field,d=new Le(l,s),m=new Int32Array(o);let p=!0;for(let K=0;K<o;K++){const le=d.evaluateAt(l.exp(K+l.getGeneratorBase()));m[m.length-1-K]=le,le!==0&&(p=!1)}if(p)return;const v=new Le(l,m),b=this.runEuclideanAlgorithm(l.buildMonomial(o,1),v,o),T=b[0],R=b[1],O=this.findErrorLocations(T),V=this.findErrorMagnitudes(R,O);for(let K=0;K<O.length;K++){const le=s.length-1-l.log(O[K]);if(le<0)throw new Zt("Bad error location");s[le]=wt.addOrSubtract(s[le],V[K])}}runEuclideanAlgorithm(s,o,l){if(s.getDegree()<o.getDegree()){const K=s;s=o,o=K}const d=this.field;let m=s,p=o,v=d.getZero(),b=d.getOne();for(;p.getDegree()>=(l/2|0);){let K=m,le=v;if(m=p,v=b,m.isZero())throw new Zt("r_{i-1} was zero");p=K;let he=d.getZero();const we=m.getCoefficient(m.getDegree()),De=d.inverse(we);for(;p.getDegree()>=m.getDegree()&&!p.isZero();){const $e=p.getDegree()-m.getDegree(),Qe=d.multiply(p.getCoefficient(p.getDegree()),De);he=he.addOrSubtract(d.buildMonomial($e,Qe)),p=p.addOrSubtract(m.multiplyByMonomial($e,Qe))}if(b=he.multiply(v).addOrSubtract(le),p.getDegree()>=m.getDegree())throw new zt("Division algorithm failed to reduce polynomial?")}const T=b.getCoefficient(0);if(T===0)throw new Zt("sigmaTilde(0) was zero");const R=d.inverse(T),O=b.multiplyScalar(R),V=p.multiplyScalar(R);return[O,V]}findErrorLocations(s){const o=s.getDegree();if(o===1)return Int32Array.from([s.getCoefficient(1)]);const l=new Int32Array(o);let d=0;const m=this.field;for(let p=1;p<m.getSize()&&d<o;p++)s.evaluateAt(p)===0&&(l[d]=m.inverse(p),d++);if(d!==o)throw new Zt("Error locator degree does not match number of roots");return l}findErrorMagnitudes(s,o){const l=o.length,d=new Int32Array(l),m=this.field;for(let p=0;p<l;p++){const v=m.inverse(o[p]);let b=1;for(let T=0;T<l;T++)if(p!==T){const R=m.multiply(o[T],v),O=(R&1)===0?R|1:R&-2;b=m.multiply(b,O)}d[p]=m.multiply(s.evaluateAt(v),m.inverse(b)),m.getGeneratorBase()!==0&&(d[p]=m.multiply(d[p],v))}return d}}var st;(function(M){M[M.UPPER=0]="UPPER",M[M.LOWER=1]="LOWER",M[M.MIXED=2]="MIXED",M[M.DIGIT=3]="DIGIT",M[M.PUNCT=4]="PUNCT",M[M.BINARY=5]="BINARY"})(st||(st={}));class mt{decode(s){this.ddata=s;let o=s.getBits(),l=this.extractBits(o),d=this.correctBits(l),m=mt.convertBoolArrayToByteArray(d),p=mt.getEncodedData(d),v=new it(m,p,null,null);return v.setNumBits(d.length),v}static highLevelDecode(s){return this.getEncodedData(s)}static getEncodedData(s){let o=s.length,l=st.UPPER,d=st.UPPER,m="",p=0;for(;p<o;)if(d===st.BINARY){if(o-p<5)break;let v=mt.readCode(s,p,5);if(p+=5,v===0){if(o-p<11)break;v=mt.readCode(s,p,11)+31,p+=11}for(let b=0;b<v;b++){if(o-p<8){p=o;break}const T=mt.readCode(s,p,8);m+=Q.castAsNonUtf8Char(T),p+=8}d=l}else{let v=d===st.DIGIT?4:5;if(o-p<v)break;let b=mt.readCode(s,p,v);p+=v;let T=mt.getCharacter(d,b);T.startsWith("CTRL_")?(l=d,d=mt.getTable(T.charAt(5)),T.charAt(6)==="L"&&(l=d)):(m+=T,d=l)}return m}static getTable(s){switch(s){case"L":return st.LOWER;case"P":return st.PUNCT;case"M":return st.MIXED;case"D":return st.DIGIT;case"B":return st.BINARY;default:return st.UPPER}}static getCharacter(s,o){switch(s){case st.UPPER:return mt.UPPER_TABLE[o];case st.LOWER:return mt.LOWER_TABLE[o];case st.MIXED:return mt.MIXED_TABLE[o];case st.PUNCT:return mt.PUNCT_TABLE[o];case st.DIGIT:return mt.DIGIT_TABLE[o];default:throw new zt("Bad table")}}correctBits(s){let o,l;this.ddata.getNbLayers()<=2?(l=6,o=wt.AZTEC_DATA_6):this.ddata.getNbLayers()<=8?(l=8,o=wt.AZTEC_DATA_8):this.ddata.getNbLayers()<=22?(l=10,o=wt.AZTEC_DATA_10):(l=12,o=wt.AZTEC_DATA_12);let d=this.ddata.getNbDatablocks(),m=s.length/l;if(m<d)throw new P;let p=s.length%l,v=new Int32Array(m);for(let V=0;V<m;V++,p+=l)v[V]=mt.readCode(s,p,l);try{new Pt(o).decode(v,m-d)}catch(V){throw new P(V)}let b=(1<<l)-1,T=0;for(let V=0;V<d;V++){let K=v[V];if(K===0||K===b)throw new P;(K===1||K===b-1)&&T++}let R=new Array(d*l-T),O=0;for(let V=0;V<d;V++){let K=v[V];if(K===1||K===b-1)R.fill(K>1,O,O+l-1),O+=l-1;else for(let le=l-1;le>=0;--le)R[O++]=(K&1<<le)!==0}return R}extractBits(s){let o=this.ddata.isCompact(),l=this.ddata.getNbLayers(),d=(o?11:14)+l*4,m=new Int32Array(d),p=new Array(this.totalBitsInLayer(l,o));if(o)for(let v=0;v<m.length;v++)m[v]=v;else{let v=d+1+2*ue.truncDivision(ue.truncDivision(d,2)-1,15),b=d/2,T=ue.truncDivision(v,2);for(let R=0;R<b;R++){let O=R+ue.truncDivision(R,15);m[b-R-1]=T-O-1,m[b+R]=T+O+1}}for(let v=0,b=0;v<l;v++){let T=(l-v)*4+(o?9:12),R=v*2,O=d-1-R;for(let V=0;V<T;V++){let K=V*2;for(let le=0;le<2;le++)p[b+K+le]=s.get(m[R+le],m[R+V]),p[b+2*T+K+le]=s.get(m[R+V],m[O-le]),p[b+4*T+K+le]=s.get(m[O-le],m[O-V]),p[b+6*T+K+le]=s.get(m[O-V],m[R+le])}b+=T*8}return p}static readCode(s,o,l){let d=0;for(let m=o;m<o+l;m++)d<<=1,s[m]&&(d|=1);return d}static readByte(s,o){let l=s.length-o;return l>=8?mt.readCode(s,o,8):mt.readCode(s,o,l)<<8-l}static convertBoolArrayToByteArray(s){let o=new Uint8Array((s.length+7)/8);for(let l=0;l<o.length;l++)o[l]=mt.readByte(s,8*l);return o}totalBitsInLayer(s,o){return((o?88:112)+16*s)*s}}mt.UPPER_TABLE=["CTRL_PS"," ","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","CTRL_LL","CTRL_ML","CTRL_DL","CTRL_BS"],mt.LOWER_TABLE=["CTRL_PS"," ","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","CTRL_US","CTRL_ML","CTRL_DL","CTRL_BS"],mt.MIXED_TABLE=["CTRL_PS"," ","\\1","\\2","\\3","\\4","\\5","\\6","\\7","\b","	",`
`,"\\13","\f","\r","\\33","\\34","\\35","\\36","\\37","@","\\","^","_","`","|","~","\\177","CTRL_LL","CTRL_UL","CTRL_PL","CTRL_BS"],mt.PUNCT_TABLE=["","\r",`\r
`,". ",", ",": ","!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}","CTRL_UL"],mt.DIGIT_TABLE=["CTRL_PS"," ","0","1","2","3","4","5","6","7","8","9",",",".","CTRL_UL","CTRL_US"];class at{constructor(){}static round(s){return s===NaN?0:s<=Number.MIN_SAFE_INTEGER?Number.MIN_SAFE_INTEGER:s>=Number.MAX_SAFE_INTEGER?Number.MAX_SAFE_INTEGER:s+(s<0?-.5:.5)|0}static distance(s,o,l,d){const m=s-l,p=o-d;return Math.sqrt(m*m+p*p)}static sum(s){let o=0;for(let l=0,d=s.length;l!==d;l++){const m=s[l];o+=m}return o}}class kt{static floatToIntBits(s){return s}}kt.MAX_VALUE=Number.MAX_SAFE_INTEGER;class de{constructor(s,o){this.x=s,this.y=o}getX(){return this.x}getY(){return this.y}equals(s){if(s instanceof de){const o=s;return this.x===o.x&&this.y===o.y}return!1}hashCode(){return 31*kt.floatToIntBits(this.x)+kt.floatToIntBits(this.y)}toString(){return"("+this.x+","+this.y+")"}static orderBestPatterns(s){const o=this.distance(s[0],s[1]),l=this.distance(s[1],s[2]),d=this.distance(s[0],s[2]);let m,p,v;if(l>=o&&l>=d?(p=s[0],m=s[1],v=s[2]):d>=l&&d>=o?(p=s[1],m=s[0],v=s[2]):(p=s[2],m=s[0],v=s[1]),this.crossProductZ(m,p,v)<0){const b=m;m=v,v=b}s[0]=m,s[1]=p,s[2]=v}static distance(s,o){return at.distance(s.x,s.y,o.x,o.y)}static crossProductZ(s,o,l){const d=o.x,m=o.y;return(l.x-d)*(s.y-m)-(l.y-m)*(s.x-d)}}class et{constructor(s,o){this.bits=s,this.points=o}getBits(){return this.bits}getPoints(){return this.points}}class Ot extends et{constructor(s,o,l,d,m){super(s,o),this.compact=l,this.nbDatablocks=d,this.nbLayers=m}getNbLayers(){return this.nbLayers}getNbDatablocks(){return this.nbDatablocks}isCompact(){return this.compact}}class ot{constructor(s,o,l,d){this.image=s,this.height=s.getHeight(),this.width=s.getWidth(),o==null&&(o=ot.INIT_SIZE),l==null&&(l=s.getWidth()/2|0),d==null&&(d=s.getHeight()/2|0);const m=o/2|0;if(this.leftInit=l-m,this.rightInit=l+m,this.upInit=d-m,this.downInit=d+m,this.upInit<0||this.leftInit<0||this.downInit>=this.height||this.rightInit>=this.width)throw new me}detect(){let s=this.leftInit,o=this.rightInit,l=this.upInit,d=this.downInit,m=!1,p=!0,v=!1,b=!1,T=!1,R=!1,O=!1;const V=this.width,K=this.height;for(;p;){p=!1;let le=!0;for(;(le||!b)&&o<V;)le=this.containsBlackPoint(l,d,o,!1),le?(o++,p=!0,b=!0):b||o++;if(o>=V){m=!0;break}let he=!0;for(;(he||!T)&&d<K;)he=this.containsBlackPoint(s,o,d,!0),he?(d++,p=!0,T=!0):T||d++;if(d>=K){m=!0;break}let we=!0;for(;(we||!R)&&s>=0;)we=this.containsBlackPoint(l,d,s,!1),we?(s--,p=!0,R=!0):R||s--;if(s<0){m=!0;break}let De=!0;for(;(De||!O)&&l>=0;)De=this.containsBlackPoint(s,o,l,!0),De?(l--,p=!0,O=!0):O||l--;if(l<0){m=!0;break}p&&(v=!0)}if(!m&&v){const le=o-s;let he=null;for(let Qe=1;he===null&&Qe<le;Qe++)he=this.getBlackPointOnSegment(s,d-Qe,s+Qe,d);if(he==null)throw new me;let we=null;for(let Qe=1;we===null&&Qe<le;Qe++)we=this.getBlackPointOnSegment(s,l+Qe,s+Qe,l);if(we==null)throw new me;let De=null;for(let Qe=1;De===null&&Qe<le;Qe++)De=this.getBlackPointOnSegment(o,l+Qe,o-Qe,l);if(De==null)throw new me;let $e=null;for(let Qe=1;$e===null&&Qe<le;Qe++)$e=this.getBlackPointOnSegment(o,d-Qe,o-Qe,d);if($e==null)throw new me;return this.centerEdges($e,he,De,we)}else throw new me}getBlackPointOnSegment(s,o,l,d){const m=at.round(at.distance(s,o,l,d)),p=(l-s)/m,v=(d-o)/m,b=this.image;for(let T=0;T<m;T++){const R=at.round(s+T*p),O=at.round(o+T*v);if(b.get(R,O))return new de(R,O)}return null}centerEdges(s,o,l,d){const m=s.getX(),p=s.getY(),v=o.getX(),b=o.getY(),T=l.getX(),R=l.getY(),O=d.getX(),V=d.getY(),K=ot.CORR;return m<this.width/2?[new de(O-K,V+K),new de(v+K,b+K),new de(T-K,R-K),new de(m+K,p-K)]:[new de(O+K,V+K),new de(v+K,b-K),new de(T-K,R+K),new de(m-K,p-K)]}containsBlackPoint(s,o,l,d){const m=this.image;if(d){for(let p=s;p<=o;p++)if(m.get(p,l))return!0}else for(let p=s;p<=o;p++)if(m.get(l,p))return!0;return!1}}ot.INIT_SIZE=10,ot.CORR=1;class xn{static checkAndNudgePoints(s,o){const l=s.getWidth(),d=s.getHeight();let m=!0;for(let p=0;p<o.length&&m;p+=2){const v=Math.floor(o[p]),b=Math.floor(o[p+1]);if(v<-1||v>l||b<-1||b>d)throw new me;m=!1,v===-1?(o[p]=0,m=!0):v===l&&(o[p]=l-1,m=!0),b===-1?(o[p+1]=0,m=!0):b===d&&(o[p+1]=d-1,m=!0)}m=!0;for(let p=o.length-2;p>=0&&m;p-=2){const v=Math.floor(o[p]),b=Math.floor(o[p+1]);if(v<-1||v>l||b<-1||b>d)throw new me;m=!1,v===-1?(o[p]=0,m=!0):v===l&&(o[p]=l-1,m=!0),b===-1?(o[p+1]=0,m=!0):b===d&&(o[p+1]=d-1,m=!0)}}}class jn{constructor(s,o,l,d,m,p,v,b,T){this.a11=s,this.a21=o,this.a31=l,this.a12=d,this.a22=m,this.a32=p,this.a13=v,this.a23=b,this.a33=T}static quadrilateralToQuadrilateral(s,o,l,d,m,p,v,b,T,R,O,V,K,le,he,we){const De=jn.quadrilateralToSquare(s,o,l,d,m,p,v,b);return jn.squareToQuadrilateral(T,R,O,V,K,le,he,we).times(De)}transformPoints(s){const o=s.length,l=this.a11,d=this.a12,m=this.a13,p=this.a21,v=this.a22,b=this.a23,T=this.a31,R=this.a32,O=this.a33;for(let V=0;V<o;V+=2){const K=s[V],le=s[V+1],he=m*K+b*le+O;s[V]=(l*K+p*le+T)/he,s[V+1]=(d*K+v*le+R)/he}}transformPointsWithValues(s,o){const l=this.a11,d=this.a12,m=this.a13,p=this.a21,v=this.a22,b=this.a23,T=this.a31,R=this.a32,O=this.a33,V=s.length;for(let K=0;K<V;K++){const le=s[K],he=o[K],we=m*le+b*he+O;s[K]=(l*le+p*he+T)/we,o[K]=(d*le+v*he+R)/we}}static squareToQuadrilateral(s,o,l,d,m,p,v,b){const T=s-l+m-v,R=o-d+p-b;if(T===0&&R===0)return new jn(l-s,m-l,s,d-o,p-d,o,0,0,1);{const O=l-m,V=v-m,K=d-p,le=b-p,he=O*le-V*K,we=(T*le-V*R)/he,De=(O*R-T*K)/he;return new jn(l-s+we*l,v-s+De*v,s,d-o+we*d,b-o+De*b,o,we,De,1)}}static quadrilateralToSquare(s,o,l,d,m,p,v,b){return jn.squareToQuadrilateral(s,o,l,d,m,p,v,b).buildAdjoint()}buildAdjoint(){return new jn(this.a22*this.a33-this.a23*this.a32,this.a23*this.a31-this.a21*this.a33,this.a21*this.a32-this.a22*this.a31,this.a13*this.a32-this.a12*this.a33,this.a11*this.a33-this.a13*this.a31,this.a12*this.a31-this.a11*this.a32,this.a12*this.a23-this.a13*this.a22,this.a13*this.a21-this.a11*this.a23,this.a11*this.a22-this.a12*this.a21)}times(s){return new jn(this.a11*s.a11+this.a21*s.a12+this.a31*s.a13,this.a11*s.a21+this.a21*s.a22+this.a31*s.a23,this.a11*s.a31+this.a21*s.a32+this.a31*s.a33,this.a12*s.a11+this.a22*s.a12+this.a32*s.a13,this.a12*s.a21+this.a22*s.a22+this.a32*s.a23,this.a12*s.a31+this.a22*s.a32+this.a32*s.a33,this.a13*s.a11+this.a23*s.a12+this.a33*s.a13,this.a13*s.a21+this.a23*s.a22+this.a33*s.a23,this.a13*s.a31+this.a23*s.a32+this.a33*s.a33)}}class Zn extends xn{sampleGrid(s,o,l,d,m,p,v,b,T,R,O,V,K,le,he,we,De,$e,Qe){const Xe=jn.quadrilateralToQuadrilateral(d,m,p,v,b,T,R,O,V,K,le,he,we,De,$e,Qe);return this.sampleGridWithTransform(s,o,l,Xe)}sampleGridWithTransform(s,o,l,d){if(o<=0||l<=0)throw new me;const m=new Ye(o,l),p=new Float32Array(2*o);for(let v=0;v<l;v++){const b=p.length,T=v+.5;for(let R=0;R<b;R+=2)p[R]=R/2+.5,p[R+1]=T;d.transformPoints(p),xn.checkAndNudgePoints(s,p);try{for(let R=0;R<b;R+=2)s.get(Math.floor(p[R]),Math.floor(p[R+1]))&&m.set(R/2,v)}catch{throw new me}}return m}}class Vn{static setGridSampler(s){Vn.gridSampler=s}static getInstance(){return Vn.gridSampler}}Vn.gridSampler=new Zn;class vn{constructor(s,o){this.x=s,this.y=o}toResultPoint(){return new de(this.getX(),this.getY())}getX(){return this.x}getY(){return this.y}}class xs{constructor(s){this.EXPECTED_CORNER_BITS=new Int32Array([3808,476,2107,1799]),this.image=s}detect(){return this.detectMirror(!1)}detectMirror(s){let o=this.getMatrixCenter(),l=this.getBullsEyeCorners(o);if(s){let p=l[0];l[0]=l[2],l[2]=p}this.extractParameters(l);let d=this.sampleGrid(this.image,l[this.shift%4],l[(this.shift+1)%4],l[(this.shift+2)%4],l[(this.shift+3)%4]),m=this.getMatrixCornerPoints(l);return new Ot(d,m,this.compact,this.nbDataBlocks,this.nbLayers)}extractParameters(s){if(!this.isValidPoint(s[0])||!this.isValidPoint(s[1])||!this.isValidPoint(s[2])||!this.isValidPoint(s[3]))throw new me;let o=2*this.nbCenterLayers,l=new Int32Array([this.sampleLine(s[0],s[1],o),this.sampleLine(s[1],s[2],o),this.sampleLine(s[2],s[3],o),this.sampleLine(s[3],s[0],o)]);this.shift=this.getRotation(l,o);let d=0;for(let p=0;p<4;p++){let v=l[(this.shift+p)%4];this.compact?(d<<=7,d+=v>>1&127):(d<<=10,d+=(v>>2&992)+(v>>1&31))}let m=this.getCorrectedParameterData(d,this.compact);this.compact?(this.nbLayers=(m>>6)+1,this.nbDataBlocks=(m&63)+1):(this.nbLayers=(m>>11)+1,this.nbDataBlocks=(m&2047)+1)}getRotation(s,o){let l=0;s.forEach((d,m,p)=>{let v=(d>>o-2<<1)+(d&1);l=(l<<3)+v}),l=((l&1)<<11)+(l>>1);for(let d=0;d<4;d++)if(ue.bitCount(l^this.EXPECTED_CORNER_BITS[d])<=2)return d;throw new me}getCorrectedParameterData(s,o){let l,d;o?(l=7,d=2):(l=10,d=4);let m=l-d,p=new Int32Array(l);for(let b=l-1;b>=0;--b)p[b]=s&15,s>>=4;try{new Pt(wt.AZTEC_PARAM).decode(p,m)}catch{throw new me}let v=0;for(let b=0;b<d;b++)v=(v<<4)+p[b];return v}getBullsEyeCorners(s){let o=s,l=s,d=s,m=s,p=!0;for(this.nbCenterLayers=1;this.nbCenterLayers<9;this.nbCenterLayers++){let O=this.getFirstDifferent(o,p,1,-1),V=this.getFirstDifferent(l,p,1,1),K=this.getFirstDifferent(d,p,-1,1),le=this.getFirstDifferent(m,p,-1,-1);if(this.nbCenterLayers>2){let he=this.distancePoint(le,O)*this.nbCenterLayers/(this.distancePoint(m,o)*(this.nbCenterLayers+2));if(he<.75||he>1.25||!this.isWhiteOrBlackRectangle(O,V,K,le))break}o=O,l=V,d=K,m=le,p=!p}if(this.nbCenterLayers!==5&&this.nbCenterLayers!==7)throw new me;this.compact=this.nbCenterLayers===5;let v=new de(o.getX()+.5,o.getY()-.5),b=new de(l.getX()+.5,l.getY()+.5),T=new de(d.getX()-.5,d.getY()+.5),R=new de(m.getX()-.5,m.getY()-.5);return this.expandSquare([v,b,T,R],2*this.nbCenterLayers-3,2*this.nbCenterLayers)}getMatrixCenter(){let s,o,l,d;try{let v=new ot(this.image).detect();s=v[0],o=v[1],l=v[2],d=v[3]}catch{let b=this.image.getWidth()/2,T=this.image.getHeight()/2;s=this.getFirstDifferent(new vn(b+7,T-7),!1,1,-1).toResultPoint(),o=this.getFirstDifferent(new vn(b+7,T+7),!1,1,1).toResultPoint(),l=this.getFirstDifferent(new vn(b-7,T+7),!1,-1,1).toResultPoint(),d=this.getFirstDifferent(new vn(b-7,T-7),!1,-1,-1).toResultPoint()}let m=at.round((s.getX()+d.getX()+o.getX()+l.getX())/4),p=at.round((s.getY()+d.getY()+o.getY()+l.getY())/4);try{let v=new ot(this.image,15,m,p).detect();s=v[0],o=v[1],l=v[2],d=v[3]}catch{s=this.getFirstDifferent(new vn(m+7,p-7),!1,1,-1).toResultPoint(),o=this.getFirstDifferent(new vn(m+7,p+7),!1,1,1).toResultPoint(),l=this.getFirstDifferent(new vn(m-7,p+7),!1,-1,1).toResultPoint(),d=this.getFirstDifferent(new vn(m-7,p-7),!1,-1,-1).toResultPoint()}return m=at.round((s.getX()+d.getX()+o.getX()+l.getX())/4),p=at.round((s.getY()+d.getY()+o.getY()+l.getY())/4),new vn(m,p)}getMatrixCornerPoints(s){return this.expandSquare(s,2*this.nbCenterLayers,this.getDimension())}sampleGrid(s,o,l,d,m){let p=Vn.getInstance(),v=this.getDimension(),b=v/2-this.nbCenterLayers,T=v/2+this.nbCenterLayers;return p.sampleGrid(s,v,v,b,b,T,b,T,T,b,T,o.getX(),o.getY(),l.getX(),l.getY(),d.getX(),d.getY(),m.getX(),m.getY())}sampleLine(s,o,l){let d=0,m=this.distanceResultPoint(s,o),p=m/l,v=s.getX(),b=s.getY(),T=p*(o.getX()-s.getX())/m,R=p*(o.getY()-s.getY())/m;for(let O=0;O<l;O++)this.image.get(at.round(v+O*T),at.round(b+O*R))&&(d|=1<<l-O-1);return d}isWhiteOrBlackRectangle(s,o,l,d){let m=3;s=new vn(s.getX()-m,s.getY()+m),o=new vn(o.getX()-m,o.getY()-m),l=new vn(l.getX()+m,l.getY()-m),d=new vn(d.getX()+m,d.getY()+m);let p=this.getColor(d,s);if(p===0)return!1;let v=this.getColor(s,o);return v!==p||(v=this.getColor(o,l),v!==p)?!1:(v=this.getColor(l,d),v===p)}getColor(s,o){let l=this.distancePoint(s,o),d=(o.getX()-s.getX())/l,m=(o.getY()-s.getY())/l,p=0,v=s.getX(),b=s.getY(),T=this.image.get(s.getX(),s.getY()),R=Math.ceil(l);for(let V=0;V<R;V++)v+=d,b+=m,this.image.get(at.round(v),at.round(b))!==T&&p++;let O=p/l;return O>.1&&O<.9?0:O<=.1===T?1:-1}getFirstDifferent(s,o,l,d){let m=s.getX()+l,p=s.getY()+d;for(;this.isValid(m,p)&&this.image.get(m,p)===o;)m+=l,p+=d;for(m-=l,p-=d;this.isValid(m,p)&&this.image.get(m,p)===o;)m+=l;for(m-=l;this.isValid(m,p)&&this.image.get(m,p)===o;)p+=d;return p-=d,new vn(m,p)}expandSquare(s,o,l){let d=l/(2*o),m=s[0].getX()-s[2].getX(),p=s[0].getY()-s[2].getY(),v=(s[0].getX()+s[2].getX())/2,b=(s[0].getY()+s[2].getY())/2,T=new de(v+d*m,b+d*p),R=new de(v-d*m,b-d*p);m=s[1].getX()-s[3].getX(),p=s[1].getY()-s[3].getY(),v=(s[1].getX()+s[3].getX())/2,b=(s[1].getY()+s[3].getY())/2;let O=new de(v+d*m,b+d*p),V=new de(v-d*m,b-d*p);return[T,O,R,V]}isValid(s,o){return s>=0&&s<this.image.getWidth()&&o>0&&o<this.image.getHeight()}isValidPoint(s){let o=at.round(s.getX()),l=at.round(s.getY());return this.isValid(o,l)}distancePoint(s,o){return at.distance(s.getX(),s.getY(),o.getX(),o.getY())}distanceResultPoint(s,o){return at.distance(s.getX(),s.getY(),o.getX(),o.getY())}getDimension(){return this.compact?4*this.nbLayers+11:this.nbLayers<=4?4*this.nbLayers+15:4*this.nbLayers+2*(ue.truncDivision(this.nbLayers-4,8)+1)+15}}class Wn{decode(s,o=null){let l=null,d=new xs(s.getBlackMatrix()),m=null,p=null;try{let R=d.detectMirror(!1);m=R.getPoints(),this.reportFoundResultPoints(o,m),p=new mt().decode(R)}catch(R){l=R}if(p==null)try{let R=d.detectMirror(!0);m=R.getPoints(),this.reportFoundResultPoints(o,m),p=new mt().decode(R)}catch(R){throw l??R}let v=new pe(p.getText(),p.getRawBytes(),p.getNumBits(),m,ie.AZTEC,G.currentTimeMillis()),b=p.getByteSegments();b!=null&&v.putMetadata(Pe.BYTE_SEGMENTS,b);let T=p.getECLevel();return T!=null&&v.putMetadata(Pe.ERROR_CORRECTION_LEVEL,T),v}reportFoundResultPoints(s,o){if(s!=null){let l=s.get(Ce.NEED_RESULT_POINT_CALLBACK);l!=null&&o.forEach((d,m,p)=>{l.foundPossibleResultPoint(d)})}}reset(){}}class Cs extends ce{constructor(s=500){super(new Wn,s)}}class Qt{decode(s,o){try{return this.doDecode(s,o)}catch{if(o&&o.get(Ce.TRY_HARDER)===!0&&s.isRotateSupported()){const m=s.rotateCounterClockwise(),p=this.doDecode(m,o),v=p.getResultMetadata();let b=270;v!==null&&v.get(Pe.ORIENTATION)===!0&&(b=b+v.get(Pe.ORIENTATION)%360),p.putMetadata(Pe.ORIENTATION,b);const T=p.getResultPoints();if(T!==null){const R=m.getHeight();for(let O=0;O<T.length;O++)T[O]=new de(R-T[O].getY()-1,T[O].getX())}return p}else throw new me}}reset(){}doDecode(s,o){const l=s.getWidth(),d=s.getHeight();let m=new be(l);const p=o&&o.get(Ce.TRY_HARDER)===!0,v=Math.max(1,d>>(p?8:5));let b;p?b=d:b=15;const T=Math.trunc(d/2);for(let R=0;R<b;R++){const O=Math.trunc((R+1)/2),V=(R&1)===0,K=T+v*(V?O:-O);if(K<0||K>=d)break;try{m=s.getBlackRow(K,m)}catch{continue}for(let le=0;le<2;le++){if(le===1&&(m.reverse(),o&&o.get(Ce.NEED_RESULT_POINT_CALLBACK)===!0)){const he=new Map;o.forEach((we,De)=>he.set(De,we)),he.delete(Ce.NEED_RESULT_POINT_CALLBACK),o=he}try{const he=this.decodeRow(K,m,o);if(le===1){he.putMetadata(Pe.ORIENTATION,180);const we=he.getResultPoints();we!==null&&(we[0]=new de(l-we[0].getX()-1,we[0].getY()),we[1]=new de(l-we[1].getX()-1,we[1].getY()))}return he}catch{}}}throw new me}static recordPattern(s,o,l){const d=l.length;for(let T=0;T<d;T++)l[T]=0;const m=s.getSize();if(o>=m)throw new me;let p=!s.get(o),v=0,b=o;for(;b<m;){if(s.get(b)!==p)l[v]++;else{if(++v===d)break;l[v]=1,p=!p}b++}if(!(v===d||v===d-1&&b===m))throw new me}static recordPatternInReverse(s,o,l){let d=l.length,m=s.get(o);for(;o>0&&d>=0;)s.get(--o)!==m&&(d--,m=!m);if(d>=0)throw new me;Qt.recordPattern(s,o+1,l)}static patternMatchVariance(s,o,l){const d=s.length;let m=0,p=0;for(let T=0;T<d;T++)m+=s[T],p+=o[T];if(m<p)return Number.POSITIVE_INFINITY;const v=m/p;l*=v;let b=0;for(let T=0;T<d;T++){const R=s[T],O=o[T]*v,V=R>O?R-O:O-R;if(V>l)return Number.POSITIVE_INFINITY;b+=V}return b/m}}class We extends Qt{static findStartPattern(s){const o=s.getSize(),l=s.getNextSet(0);let d=0,m=Int32Array.from([0,0,0,0,0,0]),p=l,v=!1;const b=6;for(let T=l;T<o;T++)if(s.get(T)!==v)m[d]++;else{if(d===b-1){let R=We.MAX_AVG_VARIANCE,O=-1;for(let V=We.CODE_START_A;V<=We.CODE_START_C;V++){const K=Qt.patternMatchVariance(m,We.CODE_PATTERNS[V],We.MAX_INDIVIDUAL_VARIANCE);K<R&&(R=K,O=V)}if(O>=0&&s.isRange(Math.max(0,p-(T-p)/2),p,!1))return Int32Array.from([p,T,O]);p+=m[0]+m[1],m=m.slice(2,m.length-1),m[d-1]=0,m[d]=0,d--}else d++;m[d]=1,v=!v}throw new me}static decodeCode(s,o,l){Qt.recordPattern(s,l,o);let d=We.MAX_AVG_VARIANCE,m=-1;for(let p=0;p<We.CODE_PATTERNS.length;p++){const v=We.CODE_PATTERNS[p],b=this.patternMatchVariance(o,v,We.MAX_INDIVIDUAL_VARIANCE);b<d&&(d=b,m=p)}if(m>=0)return m;throw new me}decodeRow(s,o,l){const d=l&&l.get(Ce.ASSUME_GS1)===!0,m=We.findStartPattern(o),p=m[2];let v=0;const b=new Uint8Array(20);b[v++]=p;let T;switch(p){case We.CODE_START_A:T=We.CODE_CODE_A;break;case We.CODE_START_B:T=We.CODE_CODE_B;break;case We.CODE_START_C:T=We.CODE_CODE_C;break;default:throw new P}let R=!1,O=!1,V="",K=m[0],le=m[1];const he=Int32Array.from([0,0,0,0,0,0]);let we=0,De=0,$e=p,Qe=0,Xe=!0,Kt=!1,jt=!1;for(;!R;){const ha=O;switch(O=!1,we=De,De=We.decodeCode(o,he,le),b[v++]=De,De!==We.CODE_STOP&&(Xe=!0),De!==We.CODE_STOP&&(Qe++,$e+=Qe*De),K=le,le+=he.reduce((rh,Oc)=>rh+Oc,0),De){case We.CODE_START_A:case We.CODE_START_B:case We.CODE_START_C:throw new P}switch(T){case We.CODE_CODE_A:if(De<64)jt===Kt?V+=String.fromCharCode(32+De):V+=String.fromCharCode(32+De+128),jt=!1;else if(De<96)jt===Kt?V+=String.fromCharCode(De-64):V+=String.fromCharCode(De+64),jt=!1;else switch(De!==We.CODE_STOP&&(Xe=!1),De){case We.CODE_FNC_1:d&&(V.length===0?V+="]C1":V+="");break;case We.CODE_FNC_2:case We.CODE_FNC_3:break;case We.CODE_FNC_4_A:!Kt&&jt?(Kt=!0,jt=!1):Kt&&jt?(Kt=!1,jt=!1):jt=!0;break;case We.CODE_SHIFT:O=!0,T=We.CODE_CODE_B;break;case We.CODE_CODE_B:T=We.CODE_CODE_B;break;case We.CODE_CODE_C:T=We.CODE_CODE_C;break;case We.CODE_STOP:R=!0;break}break;case We.CODE_CODE_B:if(De<96)jt===Kt?V+=String.fromCharCode(32+De):V+=String.fromCharCode(32+De+128),jt=!1;else switch(De!==We.CODE_STOP&&(Xe=!1),De){case We.CODE_FNC_1:d&&(V.length===0?V+="]C1":V+="");break;case We.CODE_FNC_2:case We.CODE_FNC_3:break;case We.CODE_FNC_4_B:!Kt&&jt?(Kt=!0,jt=!1):Kt&&jt?(Kt=!1,jt=!1):jt=!0;break;case We.CODE_SHIFT:O=!0,T=We.CODE_CODE_A;break;case We.CODE_CODE_A:T=We.CODE_CODE_A;break;case We.CODE_CODE_C:T=We.CODE_CODE_C;break;case We.CODE_STOP:R=!0;break}break;case We.CODE_CODE_C:if(De<100)De<10&&(V+="0"),V+=De;else switch(De!==We.CODE_STOP&&(Xe=!1),De){case We.CODE_FNC_1:d&&(V.length===0?V+="]C1":V+="");break;case We.CODE_CODE_A:T=We.CODE_CODE_A;break;case We.CODE_CODE_B:T=We.CODE_CODE_B;break;case We.CODE_STOP:R=!0;break}break}ha&&(T=T===We.CODE_CODE_A?We.CODE_CODE_B:We.CODE_CODE_A)}const ms=le-K;if(le=o.getNextUnset(le),!o.isRange(le,Math.min(o.getSize(),le+(le-K)/2),!1))throw new me;if($e-=Qe*we,$e%103!==we)throw new Y;const Di=V.length;if(Di===0)throw new me;Di>0&&Xe&&(T===We.CODE_CODE_C?V=V.substring(0,Di-2):V=V.substring(0,Di-1));const $s=(m[1]+m[0])/2,Dn=K+ms/2,Vs=b.length,Ei=new Uint8Array(Vs);for(let ha=0;ha<Vs;ha++)Ei[ha]=b[ha];const Za=[new de($s,s),new de(Dn,s)];return new pe(V,Ei,0,Za,ie.CODE_128,new Date().getTime())}}We.CODE_PATTERNS=[Int32Array.from([2,1,2,2,2,2]),Int32Array.from([2,2,2,1,2,2]),Int32Array.from([2,2,2,2,2,1]),Int32Array.from([1,2,1,2,2,3]),Int32Array.from([1,2,1,3,2,2]),Int32Array.from([1,3,1,2,2,2]),Int32Array.from([1,2,2,2,1,3]),Int32Array.from([1,2,2,3,1,2]),Int32Array.from([1,3,2,2,1,2]),Int32Array.from([2,2,1,2,1,3]),Int32Array.from([2,2,1,3,1,2]),Int32Array.from([2,3,1,2,1,2]),Int32Array.from([1,1,2,2,3,2]),Int32Array.from([1,2,2,1,3,2]),Int32Array.from([1,2,2,2,3,1]),Int32Array.from([1,1,3,2,2,2]),Int32Array.from([1,2,3,1,2,2]),Int32Array.from([1,2,3,2,2,1]),Int32Array.from([2,2,3,2,1,1]),Int32Array.from([2,2,1,1,3,2]),Int32Array.from([2,2,1,2,3,1]),Int32Array.from([2,1,3,2,1,2]),Int32Array.from([2,2,3,1,1,2]),Int32Array.from([3,1,2,1,3,1]),Int32Array.from([3,1,1,2,2,2]),Int32Array.from([3,2,1,1,2,2]),Int32Array.from([3,2,1,2,2,1]),Int32Array.from([3,1,2,2,1,2]),Int32Array.from([3,2,2,1,1,2]),Int32Array.from([3,2,2,2,1,1]),Int32Array.from([2,1,2,1,2,3]),Int32Array.from([2,1,2,3,2,1]),Int32Array.from([2,3,2,1,2,1]),Int32Array.from([1,1,1,3,2,3]),Int32Array.from([1,3,1,1,2,3]),Int32Array.from([1,3,1,3,2,1]),Int32Array.from([1,1,2,3,1,3]),Int32Array.from([1,3,2,1,1,3]),Int32Array.from([1,3,2,3,1,1]),Int32Array.from([2,1,1,3,1,3]),Int32Array.from([2,3,1,1,1,3]),Int32Array.from([2,3,1,3,1,1]),Int32Array.from([1,1,2,1,3,3]),Int32Array.from([1,1,2,3,3,1]),Int32Array.from([1,3,2,1,3,1]),Int32Array.from([1,1,3,1,2,3]),Int32Array.from([1,1,3,3,2,1]),Int32Array.from([1,3,3,1,2,1]),Int32Array.from([3,1,3,1,2,1]),Int32Array.from([2,1,1,3,3,1]),Int32Array.from([2,3,1,1,3,1]),Int32Array.from([2,1,3,1,1,3]),Int32Array.from([2,1,3,3,1,1]),Int32Array.from([2,1,3,1,3,1]),Int32Array.from([3,1,1,1,2,3]),Int32Array.from([3,1,1,3,2,1]),Int32Array.from([3,3,1,1,2,1]),Int32Array.from([3,1,2,1,1,3]),Int32Array.from([3,1,2,3,1,1]),Int32Array.from([3,3,2,1,1,1]),Int32Array.from([3,1,4,1,1,1]),Int32Array.from([2,2,1,4,1,1]),Int32Array.from([4,3,1,1,1,1]),Int32Array.from([1,1,1,2,2,4]),Int32Array.from([1,1,1,4,2,2]),Int32Array.from([1,2,1,1,2,4]),Int32Array.from([1,2,1,4,2,1]),Int32Array.from([1,4,1,1,2,2]),Int32Array.from([1,4,1,2,2,1]),Int32Array.from([1,1,2,2,1,4]),Int32Array.from([1,1,2,4,1,2]),Int32Array.from([1,2,2,1,1,4]),Int32Array.from([1,2,2,4,1,1]),Int32Array.from([1,4,2,1,1,2]),Int32Array.from([1,4,2,2,1,1]),Int32Array.from([2,4,1,2,1,1]),Int32Array.from([2,2,1,1,1,4]),Int32Array.from([4,1,3,1,1,1]),Int32Array.from([2,4,1,1,1,2]),Int32Array.from([1,3,4,1,1,1]),Int32Array.from([1,1,1,2,4,2]),Int32Array.from([1,2,1,1,4,2]),Int32Array.from([1,2,1,2,4,1]),Int32Array.from([1,1,4,2,1,2]),Int32Array.from([1,2,4,1,1,2]),Int32Array.from([1,2,4,2,1,1]),Int32Array.from([4,1,1,2,1,2]),Int32Array.from([4,2,1,1,1,2]),Int32Array.from([4,2,1,2,1,1]),Int32Array.from([2,1,2,1,4,1]),Int32Array.from([2,1,4,1,2,1]),Int32Array.from([4,1,2,1,2,1]),Int32Array.from([1,1,1,1,4,3]),Int32Array.from([1,1,1,3,4,1]),Int32Array.from([1,3,1,1,4,1]),Int32Array.from([1,1,4,1,1,3]),Int32Array.from([1,1,4,3,1,1]),Int32Array.from([4,1,1,1,1,3]),Int32Array.from([4,1,1,3,1,1]),Int32Array.from([1,1,3,1,4,1]),Int32Array.from([1,1,4,1,3,1]),Int32Array.from([3,1,1,1,4,1]),Int32Array.from([4,1,1,1,3,1]),Int32Array.from([2,1,1,4,1,2]),Int32Array.from([2,1,1,2,1,4]),Int32Array.from([2,1,1,2,3,2]),Int32Array.from([2,3,3,1,1,1,2])],We.MAX_AVG_VARIANCE=.25,We.MAX_INDIVIDUAL_VARIANCE=.7,We.CODE_SHIFT=98,We.CODE_CODE_C=99,We.CODE_CODE_B=100,We.CODE_CODE_A=101,We.CODE_FNC_1=102,We.CODE_FNC_2=97,We.CODE_FNC_3=96,We.CODE_FNC_4_A=101,We.CODE_FNC_4_B=100,We.CODE_START_A=103,We.CODE_START_B=104,We.CODE_START_C=105,We.CODE_STOP=106;class en extends Qt{constructor(s=!1,o=!1){super(),this.usingCheckDigit=s,this.extendedMode=o,this.decodeRowResult="",this.counters=new Int32Array(9)}decodeRow(s,o,l){let d=this.counters;d.fill(0),this.decodeRowResult="";let m=en.findAsteriskPattern(o,d),p=o.getNextSet(m[1]),v=o.getSize(),b,T;do{en.recordPattern(o,p,d);let he=en.toNarrowWidePattern(d);if(he<0)throw new me;b=en.patternToChar(he),this.decodeRowResult+=b,T=p;for(let we of d)p+=we;p=o.getNextSet(p)}while(b!=="*");this.decodeRowResult=this.decodeRowResult.substring(0,this.decodeRowResult.length-1);let R=0;for(let he of d)R+=he;let O=p-T-R;if(p!==v&&O*2<R)throw new me;if(this.usingCheckDigit){let he=this.decodeRowResult.length-1,we=0;for(let De=0;De<he;De++)we+=en.ALPHABET_STRING.indexOf(this.decodeRowResult.charAt(De));if(this.decodeRowResult.charAt(he)!==en.ALPHABET_STRING.charAt(we%43))throw new Y;this.decodeRowResult=this.decodeRowResult.substring(0,he)}if(this.decodeRowResult.length===0)throw new me;let V;this.extendedMode?V=en.decodeExtended(this.decodeRowResult):V=this.decodeRowResult;let K=(m[1]+m[0])/2,le=T+R/2;return new pe(V,null,0,[new de(K,s),new de(le,s)],ie.CODE_39,new Date().getTime())}static findAsteriskPattern(s,o){let l=s.getSize(),d=s.getNextSet(0),m=0,p=d,v=!1,b=o.length;for(let T=d;T<l;T++)if(s.get(T)!==v)o[m]++;else{if(m===b-1){if(this.toNarrowWidePattern(o)===en.ASTERISK_ENCODING&&s.isRange(Math.max(0,p-Math.floor((T-p)/2)),p,!1))return[p,T];p+=o[0]+o[1],o.copyWithin(0,2,2+m-1),o[m-1]=0,o[m]=0,m--}else m++;o[m]=1,v=!v}throw new me}static toNarrowWidePattern(s){let o=s.length,l=0,d;do{let m=2147483647;for(let b of s)b<m&&b>l&&(m=b);l=m,d=0;let p=0,v=0;for(let b=0;b<o;b++){let T=s[b];T>l&&(v|=1<<o-1-b,d++,p+=T)}if(d===3){for(let b=0;b<o&&d>0;b++){let T=s[b];if(T>l&&(d--,T*2>=p))return-1}return v}}while(d>3);return-1}static patternToChar(s){for(let o=0;o<en.CHARACTER_ENCODINGS.length;o++)if(en.CHARACTER_ENCODINGS[o]===s)return en.ALPHABET_STRING.charAt(o);if(s===en.ASTERISK_ENCODING)return"*";throw new me}static decodeExtended(s){let o=s.length,l="";for(let d=0;d<o;d++){let m=s.charAt(d);if(m==="+"||m==="$"||m==="%"||m==="/"){let p=s.charAt(d+1),v="\0";switch(m){case"+":if(p>="A"&&p<="Z")v=String.fromCharCode(p.charCodeAt(0)+32);else throw new P;break;case"$":if(p>="A"&&p<="Z")v=String.fromCharCode(p.charCodeAt(0)-64);else throw new P;break;case"%":if(p>="A"&&p<="E")v=String.fromCharCode(p.charCodeAt(0)-38);else if(p>="F"&&p<="J")v=String.fromCharCode(p.charCodeAt(0)-11);else if(p>="K"&&p<="O")v=String.fromCharCode(p.charCodeAt(0)+16);else if(p>="P"&&p<="T")v=String.fromCharCode(p.charCodeAt(0)+43);else if(p==="U")v="\0";else if(p==="V")v="@";else if(p==="W")v="`";else if(p==="X"||p==="Y"||p==="Z")v="";else throw new P;break;case"/":if(p>="A"&&p<="O")v=String.fromCharCode(p.charCodeAt(0)-32);else if(p==="Z")v=":";else throw new P;break}l+=v,d++}else l+=m}return l}}en.ALPHABET_STRING="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ-. $/+%",en.CHARACTER_ENCODINGS=[52,289,97,352,49,304,112,37,292,100,265,73,328,25,280,88,13,268,76,28,259,67,322,19,274,82,7,262,70,22,385,193,448,145,400,208,133,388,196,168,162,138,42],en.ASTERISK_ENCODING=148;class Ct extends Qt{constructor(){super(...arguments),this.narrowLineWidth=-1}decodeRow(s,o,l){let d=this.decodeStart(o),m=this.decodeEnd(o),p=new z;Ct.decodeMiddle(o,d[1],m[0],p);let v=p.toString(),b=null;l!=null&&(b=l.get(Ce.ALLOWED_LENGTHS)),b==null&&(b=Ct.DEFAULT_ALLOWED_LENGTHS);let T=v.length,R=!1,O=0;for(let le of b){if(T===le){R=!0;break}le>O&&(O=le)}if(!R&&T>O&&(R=!0),!R)throw new P;const V=[new de(d[1],s),new de(m[0],s)];return new pe(v,null,0,V,ie.ITF,new Date().getTime())}static decodeMiddle(s,o,l,d){let m=new Int32Array(10),p=new Int32Array(5),v=new Int32Array(5);for(m.fill(0),p.fill(0),v.fill(0);o<l;){Qt.recordPattern(s,o,m);for(let T=0;T<5;T++){let R=2*T;p[T]=m[R],v[T]=m[R+1]}let b=Ct.decodeDigit(p);d.append(b.toString()),b=this.decodeDigit(v),d.append(b.toString()),m.forEach(function(T){o+=T})}}decodeStart(s){let o=Ct.skipWhiteSpace(s),l=Ct.findGuardPattern(s,o,Ct.START_PATTERN);return this.narrowLineWidth=(l[1]-l[0])/4,this.validateQuietZone(s,l[0]),l}validateQuietZone(s,o){let l=this.narrowLineWidth*10;l=l<o?l:o;for(let d=o-1;l>0&&d>=0&&!s.get(d);d--)l--;if(l!==0)throw new me}static skipWhiteSpace(s){const o=s.getSize(),l=s.getNextSet(0);if(l===o)throw new me;return l}decodeEnd(s){s.reverse();try{let o=Ct.skipWhiteSpace(s),l;try{l=Ct.findGuardPattern(s,o,Ct.END_PATTERN_REVERSED[0])}catch(m){m instanceof me&&(l=Ct.findGuardPattern(s,o,Ct.END_PATTERN_REVERSED[1]))}this.validateQuietZone(s,l[0]);let d=l[0];return l[0]=s.getSize()-l[1],l[1]=s.getSize()-d,l}finally{s.reverse()}}static findGuardPattern(s,o,l){let d=l.length,m=new Int32Array(d),p=s.getSize(),v=!1,b=0,T=o;m.fill(0);for(let R=o;R<p;R++)if(s.get(R)!==v)m[b]++;else{if(b===d-1){if(Qt.patternMatchVariance(m,l,Ct.MAX_INDIVIDUAL_VARIANCE)<Ct.MAX_AVG_VARIANCE)return[T,R];T+=m[0]+m[1],G.arraycopy(m,2,m,0,b-1),m[b-1]=0,m[b]=0,b--}else b++;m[b]=1,v=!v}throw new me}static decodeDigit(s){let o=Ct.MAX_AVG_VARIANCE,l=-1,d=Ct.PATTERNS.length;for(let m=0;m<d;m++){let p=Ct.PATTERNS[m],v=Qt.patternMatchVariance(s,p,Ct.MAX_INDIVIDUAL_VARIANCE);v<o?(o=v,l=m):v===o&&(l=-1)}if(l>=0)return l%10;throw new me}}Ct.PATTERNS=[Int32Array.from([1,1,2,2,1]),Int32Array.from([2,1,1,1,2]),Int32Array.from([1,2,1,1,2]),Int32Array.from([2,2,1,1,1]),Int32Array.from([1,1,2,1,2]),Int32Array.from([2,1,2,1,1]),Int32Array.from([1,2,2,1,1]),Int32Array.from([1,1,1,2,2]),Int32Array.from([2,1,1,2,1]),Int32Array.from([1,2,1,2,1]),Int32Array.from([1,1,3,3,1]),Int32Array.from([3,1,1,1,3]),Int32Array.from([1,3,1,1,3]),Int32Array.from([3,3,1,1,1]),Int32Array.from([1,1,3,1,3]),Int32Array.from([3,1,3,1,1]),Int32Array.from([1,3,3,1,1]),Int32Array.from([1,1,1,3,3]),Int32Array.from([3,1,1,3,1]),Int32Array.from([1,3,1,3,1])],Ct.MAX_AVG_VARIANCE=.38,Ct.MAX_INDIVIDUAL_VARIANCE=.5,Ct.DEFAULT_ALLOWED_LENGTHS=[6,8,10,12,14],Ct.START_PATTERN=Int32Array.from([1,1,1,1]),Ct.END_PATTERN_REVERSED=[Int32Array.from([1,1,2]),Int32Array.from([1,1,3])];class wn extends Qt{constructor(){super(...arguments),this.decodeRowStringBuffer=""}static findStartGuardPattern(s){let o=!1,l,d=0,m=Int32Array.from([0,0,0]);for(;!o;){m=Int32Array.from([0,0,0]),l=wn.findGuardPattern(s,d,!1,this.START_END_PATTERN,m);let p=l[0];d=l[1];let v=p-(d-p);v>=0&&(o=s.isRange(v,p,!1))}return l}static checkChecksum(s){return wn.checkStandardUPCEANChecksum(s)}static checkStandardUPCEANChecksum(s){let o=s.length;if(o===0)return!1;let l=parseInt(s.charAt(o-1),10);return wn.getStandardUPCEANChecksum(s.substring(0,o-1))===l}static getStandardUPCEANChecksum(s){let o=s.length,l=0;for(let d=o-1;d>=0;d-=2){let m=s.charAt(d).charCodeAt(0)-48;if(m<0||m>9)throw new P;l+=m}l*=3;for(let d=o-2;d>=0;d-=2){let m=s.charAt(d).charCodeAt(0)-48;if(m<0||m>9)throw new P;l+=m}return(1e3-l)%10}static decodeEnd(s,o){return wn.findGuardPattern(s,o,!1,wn.START_END_PATTERN,new Int32Array(wn.START_END_PATTERN.length).fill(0))}static findGuardPatternWithoutCounters(s,o,l,d){return this.findGuardPattern(s,o,l,d,new Int32Array(d.length))}static findGuardPattern(s,o,l,d,m){let p=s.getSize();o=l?s.getNextUnset(o):s.getNextSet(o);let v=0,b=o,T=d.length,R=l;for(let O=o;O<p;O++)if(s.get(O)!==R)m[v]++;else{if(v===T-1){if(Qt.patternMatchVariance(m,d,wn.MAX_INDIVIDUAL_VARIANCE)<wn.MAX_AVG_VARIANCE)return Int32Array.from([b,O]);b+=m[0]+m[1];let V=m.slice(2,m.length-1);for(let K=0;K<v-1;K++)m[K]=V[K];m[v-1]=0,m[v]=0,v--}else v++;m[v]=1,R=!R}throw new me}static decodeDigit(s,o,l,d){this.recordPattern(s,l,o);let m=this.MAX_AVG_VARIANCE,p=-1,v=d.length;for(let b=0;b<v;b++){let T=d[b],R=Qt.patternMatchVariance(o,T,wn.MAX_INDIVIDUAL_VARIANCE);R<m&&(m=R,p=b)}if(p>=0)return p;throw new me}}wn.MAX_AVG_VARIANCE=.48,wn.MAX_INDIVIDUAL_VARIANCE=.7,wn.START_END_PATTERN=Int32Array.from([1,1,1]),wn.MIDDLE_PATTERN=Int32Array.from([1,1,1,1,1]),wn.END_PATTERN=Int32Array.from([1,1,1,1,1,1]),wn.L_PATTERNS=[Int32Array.from([3,2,1,1]),Int32Array.from([2,2,2,1]),Int32Array.from([2,1,2,2]),Int32Array.from([1,4,1,1]),Int32Array.from([1,1,3,2]),Int32Array.from([1,2,3,1]),Int32Array.from([1,1,1,4]),Int32Array.from([1,3,1,2]),Int32Array.from([1,2,1,3]),Int32Array.from([3,1,1,2])];class Ls{constructor(){this.CHECK_DIGIT_ENCODINGS=[24,20,18,17,12,6,3,10,9,5],this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}decodeRow(s,o,l){let d=this.decodeRowStringBuffer,m=this.decodeMiddle(o,l,d),p=d.toString(),v=Ls.parseExtensionString(p),b=[new de((l[0]+l[1])/2,s),new de(m,s)],T=new pe(p,null,0,b,ie.UPC_EAN_EXTENSION,new Date().getTime());return v!=null&&T.putAllMetadata(v),T}decodeMiddle(s,o,l){let d=this.decodeMiddleCounters;d[0]=0,d[1]=0,d[2]=0,d[3]=0;let m=s.getSize(),p=o[1],v=0;for(let T=0;T<5&&p<m;T++){let R=wn.decodeDigit(s,d,p,wn.L_AND_G_PATTERNS);l+=String.fromCharCode(48+R%10);for(let O of d)p+=O;R>=10&&(v|=1<<4-T),T!==4&&(p=s.getNextSet(p),p=s.getNextUnset(p))}if(l.length!==5)throw new me;let b=this.determineCheckDigit(v);if(Ls.extensionChecksum(l.toString())!==b)throw new me;return p}static extensionChecksum(s){let o=s.length,l=0;for(let d=o-2;d>=0;d-=2)l+=s.charAt(d).charCodeAt(0)-48;l*=3;for(let d=o-1;d>=0;d-=2)l+=s.charAt(d).charCodeAt(0)-48;return l*=3,l%10}determineCheckDigit(s){for(let o=0;o<10;o++)if(s===this.CHECK_DIGIT_ENCODINGS[o])return o;throw new me}static parseExtensionString(s){if(s.length!==5)return null;let o=Ls.parseExtension5String(s);return o==null?null:new Map([[Pe.SUGGESTED_PRICE,o]])}static parseExtension5String(s){let o;switch(s.charAt(0)){case"0":o="";break;case"5":o="$";break;case"9":switch(s){case"90000":return null;case"99991":return"0.00";case"99990":return"Used"}o="";break;default:o="";break}let l=parseInt(s.substring(1)),d=(l/100).toString(),m=l%100,p=m<10?"0"+m:m.toString();return o+d+"."+p}}class Ai{constructor(){this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}decodeRow(s,o,l){let d=this.decodeRowStringBuffer,m=this.decodeMiddle(o,l,d),p=d.toString(),v=Ai.parseExtensionString(p),b=[new de((l[0]+l[1])/2,s),new de(m,s)],T=new pe(p,null,0,b,ie.UPC_EAN_EXTENSION,new Date().getTime());return v!=null&&T.putAllMetadata(v),T}decodeMiddle(s,o,l){let d=this.decodeMiddleCounters;d[0]=0,d[1]=0,d[2]=0,d[3]=0;let m=s.getSize(),p=o[1],v=0;for(let b=0;b<2&&p<m;b++){let T=wn.decodeDigit(s,d,p,wn.L_AND_G_PATTERNS);l+=String.fromCharCode(48+T%10);for(let R of d)p+=R;T>=10&&(v|=1<<1-b),b!==1&&(p=s.getNextSet(p),p=s.getNextUnset(p))}if(l.length!==2)throw new me;if(parseInt(l.toString())%4!==v)throw new me;return p}static parseExtensionString(s){return s.length!==2?null:new Map([[Pe.ISSUE_NUMBER,parseInt(s)]])}}class Nn{static decodeRow(s,o,l){let d=wn.findGuardPattern(o,l,!1,this.EXTENSION_START_PATTERN,new Int32Array(this.EXTENSION_START_PATTERN.length).fill(0));try{return new Ls().decodeRow(s,o,d)}catch{return new Ai().decodeRow(s,o,d)}}}Nn.EXTENSION_START_PATTERN=Int32Array.from([1,1,2]);class It extends wn{constructor(){super(),this.decodeRowStringBuffer="",It.L_AND_G_PATTERNS=It.L_PATTERNS.map(s=>Int32Array.from(s));for(let s=10;s<20;s++){let o=It.L_PATTERNS[s-10],l=new Int32Array(o.length);for(let d=0;d<o.length;d++)l[d]=o[o.length-d-1];It.L_AND_G_PATTERNS[s]=l}}decodeRow(s,o,l){let d=It.findStartGuardPattern(o),m=l==null?null:l.get(Ce.NEED_RESULT_POINT_CALLBACK);if(m!=null){const Xe=new de((d[0]+d[1])/2,s);m.foundPossibleResultPoint(Xe)}let p=this.decodeMiddle(o,d,this.decodeRowStringBuffer),v=p.rowOffset,b=p.resultString;if(m!=null){const Xe=new de(v,s);m.foundPossibleResultPoint(Xe)}let T=this.decodeEnd(o,v);if(m!=null){const Xe=new de((T[0]+T[1])/2,s);m.foundPossibleResultPoint(Xe)}let R=T[1],O=R+(R-T[0]);if(O>=o.getSize()||!o.isRange(R,O,!1))throw new me;let V=b.toString();if(V.length<8)throw new P;if(!It.checkChecksum(V))throw new Y;let K=(d[1]+d[0])/2,le=(T[1]+T[0])/2,he=this.getBarcodeFormat(),we=[new de(K,s),new de(le,s)],De=new pe(V,null,0,we,he,new Date().getTime()),$e=0;try{let Xe=Nn.decodeRow(s,o,T[1]);De.putMetadata(Pe.UPC_EAN_EXTENSION,Xe.getText()),De.putAllMetadata(Xe.getResultMetadata()),De.addResultPoints(Xe.getResultPoints()),$e=Xe.getText().length}catch{}let Qe=l==null?null:l.get(Ce.ALLOWED_EAN_EXTENSIONS);if(Qe!=null){let Xe=!1;for(let Kt in Qe)if($e.toString()===Kt){Xe=!0;break}if(!Xe)throw new me}return De}decodeEnd(s,o){return It.findGuardPattern(s,o,!1,It.START_END_PATTERN,new Int32Array(It.START_END_PATTERN.length).fill(0))}static checkChecksum(s){return It.checkStandardUPCEANChecksum(s)}static checkStandardUPCEANChecksum(s){let o=s.length;if(o===0)return!1;let l=parseInt(s.charAt(o-1),10);return It.getStandardUPCEANChecksum(s.substring(0,o-1))===l}static getStandardUPCEANChecksum(s){let o=s.length,l=0;for(let d=o-1;d>=0;d-=2){let m=s.charAt(d).charCodeAt(0)-48;if(m<0||m>9)throw new P;l+=m}l*=3;for(let d=o-2;d>=0;d-=2){let m=s.charAt(d).charCodeAt(0)-48;if(m<0||m>9)throw new P;l+=m}return(1e3-l)%10}}class fn extends It{constructor(){super(),this.decodeMiddleCounters=Int32Array.from([0,0,0,0])}decodeMiddle(s,o,l){let d=this.decodeMiddleCounters;d[0]=0,d[1]=0,d[2]=0,d[3]=0;let m=s.getSize(),p=o[1],v=0;for(let T=0;T<6&&p<m;T++){let R=It.decodeDigit(s,d,p,It.L_AND_G_PATTERNS);l+=String.fromCharCode(48+R%10);for(let O of d)p+=O;R>=10&&(v|=1<<5-T)}l=fn.determineFirstDigit(l,v),p=It.findGuardPattern(s,p,!0,It.MIDDLE_PATTERN,new Int32Array(It.MIDDLE_PATTERN.length).fill(0))[1];for(let T=0;T<6&&p<m;T++){let R=It.decodeDigit(s,d,p,It.L_PATTERNS);l+=String.fromCharCode(48+R);for(let O of d)p+=O}return{rowOffset:p,resultString:l}}getBarcodeFormat(){return ie.EAN_13}static determineFirstDigit(s,o){for(let l=0;l<10;l++)if(o===this.FIRST_DIGIT_ENCODINGS[l])return s=String.fromCharCode(48+l)+s,s;throw new me}}fn.FIRST_DIGIT_ENCODINGS=[0,11,13,14,19,25,28,21,22,26];class Hs extends It{constructor(){super(),this.decodeMiddleCounters=Int32Array.from([0,0,0,0])}decodeMiddle(s,o,l){const d=this.decodeMiddleCounters;d[0]=0,d[1]=0,d[2]=0,d[3]=0;let m=s.getSize(),p=o[1];for(let b=0;b<4&&p<m;b++){let T=It.decodeDigit(s,d,p,It.L_PATTERNS);l+=String.fromCharCode(48+T);for(let R of d)p+=R}p=It.findGuardPattern(s,p,!0,It.MIDDLE_PATTERN,new Int32Array(It.MIDDLE_PATTERN.length).fill(0))[1];for(let b=0;b<4&&p<m;b++){let T=It.decodeDigit(s,d,p,It.L_PATTERNS);l+=String.fromCharCode(48+T);for(let R of d)p+=R}return{rowOffset:p,resultString:l}}getBarcodeFormat(){return ie.EAN_8}}class Xs extends It{constructor(){super(...arguments),this.ean13Reader=new fn}getBarcodeFormat(){return ie.UPC_A}decode(s,o){return this.maybeReturnResult(this.ean13Reader.decode(s))}decodeRow(s,o,l){return this.maybeReturnResult(this.ean13Reader.decodeRow(s,o,l))}decodeMiddle(s,o,l){return this.ean13Reader.decodeMiddle(s,o,l)}maybeReturnResult(s){let o=s.getText();if(o.charAt(0)==="0"){let l=new pe(o.substring(1),null,null,s.getResultPoints(),ie.UPC_A);return s.getResultMetadata()!=null&&l.putAllMetadata(s.getResultMetadata()),l}else throw new me}reset(){this.ean13Reader.reset()}}class Tn extends It{constructor(){super(),this.decodeMiddleCounters=new Int32Array(4)}decodeMiddle(s,o,l){const d=this.decodeMiddleCounters.map(T=>T);d[0]=0,d[1]=0,d[2]=0,d[3]=0;const m=s.getSize();let p=o[1],v=0;for(let T=0;T<6&&p<m;T++){const R=Tn.decodeDigit(s,d,p,Tn.L_AND_G_PATTERNS);l+=String.fromCharCode(48+R%10);for(let O of d)p+=O;R>=10&&(v|=1<<5-T)}let b=Tn.determineNumSysAndCheckDigit(l,v);return{rowOffset:p,resultString:b}}decodeEnd(s,o){return Tn.findGuardPatternWithoutCounters(s,o,!0,Tn.MIDDLE_END_PATTERN)}checkChecksum(s){return It.checkChecksum(Tn.convertUPCEtoUPCA(s))}static determineNumSysAndCheckDigit(s,o){for(let l=0;l<=1;l++)for(let d=0;d<10;d++)if(o===this.NUMSYS_AND_CHECK_DIGIT_PATTERNS[l][d]){let m=String.fromCharCode(48+l),p=String.fromCharCode(48+d);return m+s+p}throw me.getNotFoundInstance()}getBarcodeFormat(){return ie.UPC_E}static convertUPCEtoUPCA(s){const o=s.slice(1,7).split("").map(m=>m.charCodeAt(0)),l=new z;l.append(s.charAt(0));let d=o[5];switch(d){case 0:case 1:case 2:l.appendChars(o,0,2),l.append(d),l.append("0000"),l.appendChars(o,2,3);break;case 3:l.appendChars(o,0,3),l.append("00000"),l.appendChars(o,3,2);break;case 4:l.appendChars(o,0,4),l.append("00000"),l.append(o[4]);break;default:l.appendChars(o,0,5),l.append("0000"),l.append(d);break}return s.length>=8&&l.append(s.charAt(7)),l.toString()}}Tn.MIDDLE_END_PATTERN=Int32Array.from([1,1,1,1,1,1]),Tn.NUMSYS_AND_CHECK_DIGIT_PATTERNS=[Int32Array.from([56,52,50,49,44,38,35,42,41,37]),Int32Array.from([7,11,13,14,19,25,28,21,22,26])];class Ci extends Qt{constructor(s){super();let o=s==null?null:s.get(Ce.POSSIBLE_FORMATS),l=[];a(o)?(l.push(new fn),l.push(new Xs),l.push(new Hs),l.push(new Tn)):(o.indexOf(ie.EAN_13)>-1&&l.push(new fn),o.indexOf(ie.UPC_A)>-1&&l.push(new Xs),o.indexOf(ie.EAN_8)>-1&&l.push(new Hs),o.indexOf(ie.UPC_E)>-1&&l.push(new Tn)),this.readers=l}decodeRow(s,o,l){for(let d of this.readers)try{const m=d.decodeRow(s,o,l),p=m.getBarcodeFormat()===ie.EAN_13&&m.getText().charAt(0)==="0",v=l==null?null:l.get(Ce.POSSIBLE_FORMATS),b=v==null||v.includes(ie.UPC_A);if(p&&b){const T=m.getRawBytes(),R=new pe(m.getText().substring(1),T,T?T.length:null,m.getResultPoints(),ie.UPC_A);return R.putAllMetadata(m.getResultMetadata()),R}return m}catch{}throw new me}reset(){for(let s of this.readers)s.reset()}}class Yn extends Qt{constructor(){super(),this.decodeFinderCounters=new Int32Array(4),this.dataCharacterCounters=new Int32Array(8),this.oddRoundingErrors=new Array(4),this.evenRoundingErrors=new Array(4),this.oddCounts=new Array(this.dataCharacterCounters.length/2),this.evenCounts=new Array(this.dataCharacterCounters.length/2)}getDecodeFinderCounters(){return this.decodeFinderCounters}getDataCharacterCounters(){return this.dataCharacterCounters}getOddRoundingErrors(){return this.oddRoundingErrors}getEvenRoundingErrors(){return this.evenRoundingErrors}getOddCounts(){return this.oddCounts}getEvenCounts(){return this.evenCounts}parseFinderValue(s,o){for(let l=0;l<o.length;l++)if(Qt.patternMatchVariance(s,o[l],Yn.MAX_INDIVIDUAL_VARIANCE)<Yn.MAX_AVG_VARIANCE)return l;throw new me}static count(s){return at.sum(new Int32Array(s))}static increment(s,o){let l=0,d=o[0];for(let m=1;m<s.length;m++)o[m]>d&&(d=o[m],l=m);s[l]++}static decrement(s,o){let l=0,d=o[0];for(let m=1;m<s.length;m++)o[m]<d&&(d=o[m],l=m);s[l]--}static isFinderPattern(s){let o=s[0]+s[1],l=o+s[2]+s[3],d=o/l;if(d>=Yn.MIN_FINDER_PATTERN_RATIO&&d<=Yn.MAX_FINDER_PATTERN_RATIO){let m=Number.MAX_SAFE_INTEGER,p=Number.MIN_SAFE_INTEGER;for(let v of s)v>p&&(p=v),v<m&&(m=v);return p<10*m}return!1}}Yn.MAX_AVG_VARIANCE=.2,Yn.MAX_INDIVIDUAL_VARIANCE=.45,Yn.MIN_FINDER_PATTERN_RATIO=9.5/12,Yn.MAX_FINDER_PATTERN_RATIO=12.5/14;class as{constructor(s,o){this.value=s,this.checksumPortion=o}getValue(){return this.value}getChecksumPortion(){return this.checksumPortion}toString(){return this.value+"("+this.checksumPortion+")"}equals(s){if(!(s instanceof as))return!1;const o=s;return this.value===o.value&&this.checksumPortion===o.checksumPortion}hashCode(){return this.value^this.checksumPortion}}class fs{constructor(s,o,l,d,m){this.value=s,this.startEnd=o,this.value=s,this.startEnd=o,this.resultPoints=new Array,this.resultPoints.push(new de(l,m)),this.resultPoints.push(new de(d,m))}getValue(){return this.value}getStartEnd(){return this.startEnd}getResultPoints(){return this.resultPoints}equals(s){if(!(s instanceof fs))return!1;const o=s;return this.value===o.value}hashCode(){return this.value}}class $n{constructor(){}static getRSSvalue(s,o,l){let d=0;for(let b of s)d+=b;let m=0,p=0,v=s.length;for(let b=0;b<v-1;b++){let T;for(T=1,p|=1<<b;T<s[b];T++,p&=~(1<<b)){let R=$n.combins(d-T-1,v-b-2);if(l&&p===0&&d-T-(v-b-1)>=v-b-1&&(R-=$n.combins(d-T-(v-b),v-b-2)),v-b-1>1){let O=0;for(let V=d-T-(v-b-2);V>o;V--)O+=$n.combins(d-T-V-1,v-b-3);R-=O*(v-1-b)}else d-T>o&&R--;m+=R}d-=T}return m}static combins(s,o){let l,d;s-o>o?(d=o,l=s-o):(d=s-o,l=o);let m=1,p=1;for(let v=s;v>l;v--)m*=v,p<=d&&(m/=p,p++);for(;p<=d;)m/=p,p++;return m}}class xe{static buildBitArray(s){let o=s.length*2-1;s[s.length-1].getRightChar()==null&&(o-=1);let l=12*o,d=new be(l),m=0,v=s[0].getRightChar().getValue();for(let b=11;b>=0;--b)(v&1<<b)!=0&&d.set(m),m++;for(let b=1;b<s.length;++b){let T=s[b],R=T.getLeftChar().getValue();for(let O=11;O>=0;--O)(R&1<<O)!=0&&d.set(m),m++;if(T.getRightChar()!=null){let O=T.getRightChar().getValue();for(let V=11;V>=0;--V)(O&1<<V)!=0&&d.set(m),m++}}return d}}class Ue{constructor(s,o){o?this.decodedInformation=null:(this.finished=s,this.decodedInformation=o)}getDecodedInformation(){return this.decodedInformation}isFinished(){return this.finished}}class Ze{constructor(s){this.newPosition=s}getNewPosition(){return this.newPosition}}class $ extends Ze{constructor(s,o){super(s),this.value=o}getValue(){return this.value}isFNC1(){return this.value===$.FNC1}}$.FNC1="$";class Oe extends Ze{constructor(s,o,l){super(s),l?(this.remaining=!0,this.remainingValue=this.remainingValue):(this.remaining=!1,this.remainingValue=0),this.newString=o}getNewString(){return this.newString}isRemaining(){return this.remaining}getRemainingValue(){return this.remainingValue}}class Ke extends Ze{constructor(s,o,l){if(super(s),o<0||o>10||l<0||l>10)throw new P;this.firstDigit=o,this.secondDigit=l}getFirstDigit(){return this.firstDigit}getSecondDigit(){return this.secondDigit}getValue(){return this.firstDigit*10+this.secondDigit}isFirstDigitFNC1(){return this.firstDigit===Ke.FNC1}isSecondDigitFNC1(){return this.secondDigit===Ke.FNC1}isAnyFNC1(){return this.firstDigit===Ke.FNC1||this.secondDigit===Ke.FNC1}}Ke.FNC1=10;class Re{constructor(){}static parseFieldsInGeneralPurpose(s){if(!s)return null;if(s.length<2)throw new me;let o=s.substring(0,2);for(let m of Re.TWO_DIGIT_DATA_LENGTH)if(m[0]===o)return m[1]===Re.VARIABLE_LENGTH?Re.processVariableAI(2,m[2],s):Re.processFixedAI(2,m[1],s);if(s.length<3)throw new me;let l=s.substring(0,3);for(let m of Re.THREE_DIGIT_DATA_LENGTH)if(m[0]===l)return m[1]===Re.VARIABLE_LENGTH?Re.processVariableAI(3,m[2],s):Re.processFixedAI(3,m[1],s);for(let m of Re.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH)if(m[0]===l)return m[1]===Re.VARIABLE_LENGTH?Re.processVariableAI(4,m[2],s):Re.processFixedAI(4,m[1],s);if(s.length<4)throw new me;let d=s.substring(0,4);for(let m of Re.FOUR_DIGIT_DATA_LENGTH)if(m[0]===d)return m[1]===Re.VARIABLE_LENGTH?Re.processVariableAI(4,m[2],s):Re.processFixedAI(4,m[1],s);throw new me}static processFixedAI(s,o,l){if(l.length<s)throw new me;let d=l.substring(0,s);if(l.length<s+o)throw new me;let m=l.substring(s,s+o),p=l.substring(s+o),v="("+d+")"+m,b=Re.parseFieldsInGeneralPurpose(p);return b==null?v:v+b}static processVariableAI(s,o,l){let d=l.substring(0,s),m;l.length<s+o?m=l.length:m=s+o;let p=l.substring(s,m),v=l.substring(m),b="("+d+")"+p,T=Re.parseFieldsInGeneralPurpose(v);return T==null?b:b+T}}Re.VARIABLE_LENGTH=[],Re.TWO_DIGIT_DATA_LENGTH=[["00",18],["01",14],["02",14],["10",Re.VARIABLE_LENGTH,20],["11",6],["12",6],["13",6],["15",6],["17",6],["20",2],["21",Re.VARIABLE_LENGTH,20],["22",Re.VARIABLE_LENGTH,29],["30",Re.VARIABLE_LENGTH,8],["37",Re.VARIABLE_LENGTH,8],["90",Re.VARIABLE_LENGTH,30],["91",Re.VARIABLE_LENGTH,30],["92",Re.VARIABLE_LENGTH,30],["93",Re.VARIABLE_LENGTH,30],["94",Re.VARIABLE_LENGTH,30],["95",Re.VARIABLE_LENGTH,30],["96",Re.VARIABLE_LENGTH,30],["97",Re.VARIABLE_LENGTH,3],["98",Re.VARIABLE_LENGTH,30],["99",Re.VARIABLE_LENGTH,30]],Re.THREE_DIGIT_DATA_LENGTH=[["240",Re.VARIABLE_LENGTH,30],["241",Re.VARIABLE_LENGTH,30],["242",Re.VARIABLE_LENGTH,6],["250",Re.VARIABLE_LENGTH,30],["251",Re.VARIABLE_LENGTH,30],["253",Re.VARIABLE_LENGTH,17],["254",Re.VARIABLE_LENGTH,20],["400",Re.VARIABLE_LENGTH,30],["401",Re.VARIABLE_LENGTH,30],["402",17],["403",Re.VARIABLE_LENGTH,30],["410",13],["411",13],["412",13],["413",13],["414",13],["420",Re.VARIABLE_LENGTH,20],["421",Re.VARIABLE_LENGTH,15],["422",3],["423",Re.VARIABLE_LENGTH,15],["424",3],["425",3],["426",3]],Re.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH=[["310",6],["311",6],["312",6],["313",6],["314",6],["315",6],["316",6],["320",6],["321",6],["322",6],["323",6],["324",6],["325",6],["326",6],["327",6],["328",6],["329",6],["330",6],["331",6],["332",6],["333",6],["334",6],["335",6],["336",6],["340",6],["341",6],["342",6],["343",6],["344",6],["345",6],["346",6],["347",6],["348",6],["349",6],["350",6],["351",6],["352",6],["353",6],["354",6],["355",6],["356",6],["357",6],["360",6],["361",6],["362",6],["363",6],["364",6],["365",6],["366",6],["367",6],["368",6],["369",6],["390",Re.VARIABLE_LENGTH,15],["391",Re.VARIABLE_LENGTH,18],["392",Re.VARIABLE_LENGTH,15],["393",Re.VARIABLE_LENGTH,18],["703",Re.VARIABLE_LENGTH,30]],Re.FOUR_DIGIT_DATA_LENGTH=[["7001",13],["7002",Re.VARIABLE_LENGTH,30],["7003",10],["8001",14],["8002",Re.VARIABLE_LENGTH,20],["8003",Re.VARIABLE_LENGTH,30],["8004",Re.VARIABLE_LENGTH,30],["8005",6],["8006",18],["8007",Re.VARIABLE_LENGTH,30],["8008",Re.VARIABLE_LENGTH,12],["8018",18],["8020",Re.VARIABLE_LENGTH,25],["8100",6],["8101",10],["8102",2],["8110",Re.VARIABLE_LENGTH,70],["8200",Re.VARIABLE_LENGTH,70]];class ft{constructor(s){this.buffer=new z,this.information=s}decodeAllCodes(s,o){let l=o,d=null;do{let m=this.decodeGeneralPurposeField(l,d),p=Re.parseFieldsInGeneralPurpose(m.getNewString());if(p!=null&&s.append(p),m.isRemaining()?d=""+m.getRemainingValue():d=null,l===m.getNewPosition())break;l=m.getNewPosition()}while(!0);return s.toString()}isStillNumeric(s){if(s+7>this.information.getSize())return s+4<=this.information.getSize();for(let o=s;o<s+3;++o)if(this.information.get(o))return!0;return this.information.get(s+3)}decodeNumeric(s){if(s+7>this.information.getSize()){let m=this.extractNumericValueFromBitArray(s,4);return m===0?new Ke(this.information.getSize(),Ke.FNC1,Ke.FNC1):new Ke(this.information.getSize(),m-1,Ke.FNC1)}let o=this.extractNumericValueFromBitArray(s,7),l=(o-8)/11,d=(o-8)%11;return new Ke(s+7,l,d)}extractNumericValueFromBitArray(s,o){return ft.extractNumericValueFromBitArray(this.information,s,o)}static extractNumericValueFromBitArray(s,o,l){let d=0;for(let m=0;m<l;++m)s.get(o+m)&&(d|=1<<l-m-1);return d}decodeGeneralPurposeField(s,o){this.buffer.setLengthToZero(),o!=null&&this.buffer.append(o),this.current.setPosition(s);let l=this.parseBlocks();return l!=null&&l.isRemaining()?new Oe(this.current.getPosition(),this.buffer.toString(),l.getRemainingValue()):new Oe(this.current.getPosition(),this.buffer.toString())}parseBlocks(){let s,o;do{let l=this.current.getPosition();if(this.current.isAlpha()?(o=this.parseAlphaBlock(),s=o.isFinished()):this.current.isIsoIec646()?(o=this.parseIsoIec646Block(),s=o.isFinished()):(o=this.parseNumericBlock(),s=o.isFinished()),!(l!==this.current.getPosition())&&!s)break}while(!s);return o.getDecodedInformation()}parseNumericBlock(){for(;this.isStillNumeric(this.current.getPosition());){let s=this.decodeNumeric(this.current.getPosition());if(this.current.setPosition(s.getNewPosition()),s.isFirstDigitFNC1()){let o;return s.isSecondDigitFNC1()?o=new Oe(this.current.getPosition(),this.buffer.toString()):o=new Oe(this.current.getPosition(),this.buffer.toString(),s.getSecondDigit()),new Ue(!0,o)}if(this.buffer.append(s.getFirstDigit()),s.isSecondDigitFNC1()){let o=new Oe(this.current.getPosition(),this.buffer.toString());return new Ue(!0,o)}this.buffer.append(s.getSecondDigit())}return this.isNumericToAlphaNumericLatch(this.current.getPosition())&&(this.current.setAlpha(),this.current.incrementPosition(4)),new Ue(!1)}parseIsoIec646Block(){for(;this.isStillIsoIec646(this.current.getPosition());){let s=this.decodeIsoIec646(this.current.getPosition());if(this.current.setPosition(s.getNewPosition()),s.isFNC1()){let o=new Oe(this.current.getPosition(),this.buffer.toString());return new Ue(!0,o)}this.buffer.append(s.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setAlpha()),new Ue(!1)}parseAlphaBlock(){for(;this.isStillAlpha(this.current.getPosition());){let s=this.decodeAlphanumeric(this.current.getPosition());if(this.current.setPosition(s.getNewPosition()),s.isFNC1()){let o=new Oe(this.current.getPosition(),this.buffer.toString());return new Ue(!0,o)}this.buffer.append(s.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setIsoIec646()),new Ue(!1)}isStillIsoIec646(s){if(s+5>this.information.getSize())return!1;let o=this.extractNumericValueFromBitArray(s,5);if(o>=5&&o<16)return!0;if(s+7>this.information.getSize())return!1;let l=this.extractNumericValueFromBitArray(s,7);if(l>=64&&l<116)return!0;if(s+8>this.information.getSize())return!1;let d=this.extractNumericValueFromBitArray(s,8);return d>=232&&d<253}decodeIsoIec646(s){let o=this.extractNumericValueFromBitArray(s,5);if(o===15)return new $(s+5,$.FNC1);if(o>=5&&o<15)return new $(s+5,"0"+(o-5));let l=this.extractNumericValueFromBitArray(s,7);if(l>=64&&l<90)return new $(s+7,""+(l+1));if(l>=90&&l<116)return new $(s+7,""+(l+7));let d=this.extractNumericValueFromBitArray(s,8),m;switch(d){case 232:m="!";break;case 233:m='"';break;case 234:m="%";break;case 235:m="&";break;case 236:m="'";break;case 237:m="(";break;case 238:m=")";break;case 239:m="*";break;case 240:m="+";break;case 241:m=",";break;case 242:m="-";break;case 243:m=".";break;case 244:m="/";break;case 245:m=":";break;case 246:m=";";break;case 247:m="<";break;case 248:m="=";break;case 249:m=">";break;case 250:m="?";break;case 251:m="_";break;case 252:m=" ";break;default:throw new P}return new $(s+8,m)}isStillAlpha(s){if(s+5>this.information.getSize())return!1;let o=this.extractNumericValueFromBitArray(s,5);if(o>=5&&o<16)return!0;if(s+6>this.information.getSize())return!1;let l=this.extractNumericValueFromBitArray(s,6);return l>=16&&l<63}decodeAlphanumeric(s){let o=this.extractNumericValueFromBitArray(s,5);if(o===15)return new $(s+5,$.FNC1);if(o>=5&&o<15)return new $(s+5,"0"+(o-5));let l=this.extractNumericValueFromBitArray(s,6);if(l>=32&&l<58)return new $(s+6,""+(l+33));let d;switch(l){case 58:d="*";break;case 59:d=",";break;case 60:d="-";break;case 61:d=".";break;case 62:d="/";break;default:throw new zt("Decoding invalid alphanumeric value: "+l)}return new $(s+6,d)}isAlphaTo646ToAlphaLatch(s){if(s+1>this.information.getSize())return!1;for(let o=0;o<5&&o+s<this.information.getSize();++o)if(o===2){if(!this.information.get(s+2))return!1}else if(this.information.get(s+o))return!1;return!0}isAlphaOr646ToNumericLatch(s){if(s+3>this.information.getSize())return!1;for(let o=s;o<s+3;++o)if(this.information.get(o))return!1;return!0}isNumericToAlphaNumericLatch(s){if(s+1>this.information.getSize())return!1;for(let o=0;o<4&&o+s<this.information.getSize();++o)if(this.information.get(s+o))return!1;return!0}}class yt{constructor(s){this.information=s,this.generalDecoder=new ft(s)}getInformation(){return this.information}getGeneralDecoder(){return this.generalDecoder}}class bt extends yt{constructor(s){super(s)}encodeCompressedGtin(s,o){s.append("(01)");let l=s.length();s.append("9"),this.encodeCompressedGtinWithoutAI(s,o,l)}encodeCompressedGtinWithoutAI(s,o,l){for(let d=0;d<4;++d){let m=this.getGeneralDecoder().extractNumericValueFromBitArray(o+10*d,10);m/100===0&&s.append("0"),m/10===0&&s.append("0"),s.append(m)}bt.appendCheckDigit(s,l)}static appendCheckDigit(s,o){let l=0;for(let d=0;d<13;d++){let m=s.charAt(d+o).charCodeAt(0)-48;l+=(d&1)===0?3*m:m}l=10-l%10,l===10&&(l=0),s.append(l)}}bt.GTIN_SIZE=40;class Gn extends bt{constructor(s){super(s)}parseInformation(){let s=new z;s.append("(01)");let o=s.length(),l=this.getGeneralDecoder().extractNumericValueFromBitArray(Gn.HEADER_SIZE,4);return s.append(l),this.encodeCompressedGtinWithoutAI(s,Gn.HEADER_SIZE+4,o),this.getGeneralDecoder().decodeAllCodes(s,Gn.HEADER_SIZE+44)}}Gn.HEADER_SIZE=4;class os extends yt{constructor(s){super(s)}parseInformation(){let s=new z;return this.getGeneralDecoder().decodeAllCodes(s,os.HEADER_SIZE)}}os.HEADER_SIZE=5;class Ps extends bt{constructor(s){super(s)}encodeCompressedWeight(s,o,l){let d=this.getGeneralDecoder().extractNumericValueFromBitArray(o,l);this.addWeightCode(s,d);let m=this.checkWeight(d),p=1e5;for(let v=0;v<5;++v)m/p===0&&s.append("0"),p/=10;s.append(m)}}class vs extends Ps{constructor(s){super(s)}parseInformation(){if(this.getInformation().getSize()!=vs.HEADER_SIZE+Ps.GTIN_SIZE+vs.WEIGHT_SIZE)throw new me;let s=new z;return this.encodeCompressedGtin(s,vs.HEADER_SIZE),this.encodeCompressedWeight(s,vs.HEADER_SIZE+Ps.GTIN_SIZE,vs.WEIGHT_SIZE),s.toString()}}vs.HEADER_SIZE=5,vs.WEIGHT_SIZE=15;class br extends vs{constructor(s){super(s)}addWeightCode(s,o){s.append("(3103)")}checkWeight(s){return s}}class Ti extends vs{constructor(s){super(s)}addWeightCode(s,o){o<1e4?s.append("(3202)"):s.append("(3203)")}checkWeight(s){return s<1e4?s:s-1e4}}class Ts extends bt{constructor(s){super(s)}parseInformation(){if(this.getInformation().getSize()<Ts.HEADER_SIZE+bt.GTIN_SIZE)throw new me;let s=new z;this.encodeCompressedGtin(s,Ts.HEADER_SIZE);let o=this.getGeneralDecoder().extractNumericValueFromBitArray(Ts.HEADER_SIZE+bt.GTIN_SIZE,Ts.LAST_DIGIT_SIZE);s.append("(392"),s.append(o),s.append(")");let l=this.getGeneralDecoder().decodeGeneralPurposeField(Ts.HEADER_SIZE+bt.GTIN_SIZE+Ts.LAST_DIGIT_SIZE,null);return s.append(l.getNewString()),s.toString()}}Ts.HEADER_SIZE=8,Ts.LAST_DIGIT_SIZE=2;class pt extends bt{constructor(s){super(s)}parseInformation(){if(this.getInformation().getSize()<pt.HEADER_SIZE+bt.GTIN_SIZE)throw new me;let s=new z;this.encodeCompressedGtin(s,pt.HEADER_SIZE);let o=this.getGeneralDecoder().extractNumericValueFromBitArray(pt.HEADER_SIZE+bt.GTIN_SIZE,pt.LAST_DIGIT_SIZE);s.append("(393"),s.append(o),s.append(")");let l=this.getGeneralDecoder().extractNumericValueFromBitArray(pt.HEADER_SIZE+bt.GTIN_SIZE+pt.LAST_DIGIT_SIZE,pt.FIRST_THREE_DIGITS_SIZE);l/100==0&&s.append("0"),l/10==0&&s.append("0"),s.append(l);let d=this.getGeneralDecoder().decodeGeneralPurposeField(pt.HEADER_SIZE+bt.GTIN_SIZE+pt.LAST_DIGIT_SIZE+pt.FIRST_THREE_DIGITS_SIZE,null);return s.append(d.getNewString()),s.toString()}}pt.HEADER_SIZE=8,pt.LAST_DIGIT_SIZE=2,pt.FIRST_THREE_DIGITS_SIZE=10;class Ht extends Ps{constructor(s,o,l){super(s),this.dateCode=l,this.firstAIdigits=o}parseInformation(){if(this.getInformation().getSize()!=Ht.HEADER_SIZE+Ht.GTIN_SIZE+Ht.WEIGHT_SIZE+Ht.DATE_SIZE)throw new me;let s=new z;return this.encodeCompressedGtin(s,Ht.HEADER_SIZE),this.encodeCompressedWeight(s,Ht.HEADER_SIZE+Ht.GTIN_SIZE,Ht.WEIGHT_SIZE),this.encodeCompressedDate(s,Ht.HEADER_SIZE+Ht.GTIN_SIZE+Ht.WEIGHT_SIZE),s.toString()}encodeCompressedDate(s,o){let l=this.getGeneralDecoder().extractNumericValueFromBitArray(o,Ht.DATE_SIZE);if(l==38400)return;s.append("("),s.append(this.dateCode),s.append(")");let d=l%32;l/=32;let m=l%12+1;l/=12;let p=l;p/10==0&&s.append("0"),s.append(p),m/10==0&&s.append("0"),s.append(m),d/10==0&&s.append("0"),s.append(d)}addWeightCode(s,o){s.append("("),s.append(this.firstAIdigits),s.append(o/1e5),s.append(")")}checkWeight(s){return s%1e5}}Ht.HEADER_SIZE=8,Ht.WEIGHT_SIZE=20,Ht.DATE_SIZE=16;function Ss(M){try{if(M.get(1))return new Gn(M);if(!M.get(2))return new os(M);switch(ft.extractNumericValueFromBitArray(M,1,4)){case 4:return new br(M);case 5:return new Ti(M)}switch(ft.extractNumericValueFromBitArray(M,1,5)){case 12:return new Ts(M);case 13:return new pt(M)}switch(ft.extractNumericValueFromBitArray(M,1,7)){case 56:return new Ht(M,"310","11");case 57:return new Ht(M,"320","11");case 58:return new Ht(M,"310","13");case 59:return new Ht(M,"320","13");case 60:return new Ht(M,"310","15");case 61:return new Ht(M,"320","15");case 62:return new Ht(M,"310","17");case 63:return new Ht(M,"320","17")}}catch(s){throw console.log(s),new zt("unknown decoder: "+M)}}class Bs{constructor(s,o,l,d){this.leftchar=s,this.rightchar=o,this.finderpattern=l,this.maybeLast=d}mayBeLast(){return this.maybeLast}getLeftChar(){return this.leftchar}getRightChar(){return this.rightchar}getFinderPattern(){return this.finderpattern}mustBeLast(){return this.rightchar==null}toString(){return"[ "+this.leftchar+", "+this.rightchar+" : "+(this.finderpattern==null?"null":this.finderpattern.getValue())+" ]"}static equals(s,o){return s instanceof Bs?Bs.equalsOrNull(s.leftchar,o.leftchar)&&Bs.equalsOrNull(s.rightchar,o.rightchar)&&Bs.equalsOrNull(s.finderpattern,o.finderpattern):!1}static equalsOrNull(s,o){return s===null?o===null:Bs.equals(s,o)}hashCode(){return this.leftchar.getValue()^this.rightchar.getValue()^this.finderpattern.getValue()}}class Jn{constructor(s,o,l){this.pairs=s,this.rowNumber=o,this.wasReversed=l}getPairs(){return this.pairs}getRowNumber(){return this.rowNumber}isReversed(){return this.wasReversed}isEquivalent(s){return this.checkEqualitity(this,s)}toString(){return"{ "+this.pairs+" }"}equals(s,o){return s instanceof Jn?this.checkEqualitity(s,o)&&s.wasReversed===o.wasReversed:!1}checkEqualitity(s,o){if(!s||!o)return;let l;return s.forEach((d,m)=>{o.forEach(p=>{d.getLeftChar().getValue()===p.getLeftChar().getValue()&&d.getRightChar().getValue()===p.getRightChar().getValue()&&d.getFinderPatter().getValue()===p.getFinderPatter().getValue()&&(l=!0)})}),l}}class Ge extends Yn{constructor(s){super(...arguments),this.pairs=new Array(Ge.MAX_PAIRS),this.rows=new Array,this.startEnd=[2],this.verbose=s===!0}decodeRow(s,o,l){this.pairs.length=0,this.startFromEven=!1;try{return Ge.constructResult(this.decodeRow2pairs(s,o))}catch(d){this.verbose&&console.log(d)}return this.pairs.length=0,this.startFromEven=!0,Ge.constructResult(this.decodeRow2pairs(s,o))}reset(){this.pairs.length=0,this.rows.length=0}decodeRow2pairs(s,o){let l=!1;for(;!l;)try{this.pairs.push(this.retrieveNextPair(o,this.pairs,s))}catch(m){if(m instanceof me){if(!this.pairs.length)throw new me;l=!0}}if(this.checkChecksum())return this.pairs;let d;if(this.rows.length?d=!0:d=!1,this.storeRow(s,!1),d){let m=this.checkRowsBoolean(!1);if(m!=null||(m=this.checkRowsBoolean(!0),m!=null))return m}throw new me}checkRowsBoolean(s){if(this.rows.length>25)return this.rows.length=0,null;this.pairs.length=0,s&&(this.rows=this.rows.reverse());let o=null;try{o=this.checkRows(new Array,0)}catch(l){this.verbose&&console.log(l)}return s&&(this.rows=this.rows.reverse()),o}checkRows(s,o){for(let l=o;l<this.rows.length;l++){let d=this.rows[l];this.pairs.length=0;for(let p of s)this.pairs.push(p.getPairs());if(this.pairs.push(d.getPairs()),!Ge.isValidSequence(this.pairs))continue;if(this.checkChecksum())return this.pairs;let m=new Array(s);m.push(d);try{return this.checkRows(m,l+1)}catch(p){this.verbose&&console.log(p)}}throw new me}static isValidSequence(s){for(let o of Ge.FINDER_PATTERN_SEQUENCES){if(s.length>o.length)continue;let l=!0;for(let d=0;d<s.length;d++)if(s[d].getFinderPattern().getValue()!=o[d]){l=!1;break}if(l)return!0}return!1}storeRow(s,o){let l=0,d=!1,m=!1;for(;l<this.rows.length;){let p=this.rows[l];if(p.getRowNumber()>s){m=p.isEquivalent(this.pairs);break}d=p.isEquivalent(this.pairs),l++}m||d||Ge.isPartialRow(this.pairs,this.rows)||(this.rows.push(l,new Jn(this.pairs,s,o)),this.removePartialRows(this.pairs,this.rows))}removePartialRows(s,o){for(let l of o)if(l.getPairs().length!==s.length){for(let d of l.getPairs())for(let m of s)if(Bs.equals(d,m))break}}static isPartialRow(s,o){for(let l of o){let d=!0;for(let m of s){let p=!1;for(let v of l.getPairs())if(m.equals(v)){p=!0;break}if(!p){d=!1;break}}if(d)return!0}return!1}getRows(){return this.rows}static constructResult(s){let o=xe.buildBitArray(s),d=Ss(o).parseInformation(),m=s[0].getFinderPattern().getResultPoints(),p=s[s.length-1].getFinderPattern().getResultPoints(),v=[m[0],m[1],p[0],p[1]];return new pe(d,null,null,v,ie.RSS_EXPANDED,null)}checkChecksum(){let s=this.pairs.get(0),o=s.getLeftChar(),l=s.getRightChar();if(l==null)return!1;let d=l.getChecksumPortion(),m=2;for(let v=1;v<this.pairs.size();++v){let b=this.pairs.get(v);d+=b.getLeftChar().getChecksumPortion(),m++;let T=b.getRightChar();T!=null&&(d+=T.getChecksumPortion(),m++)}return d%=211,211*(m-4)+d==o.getValue()}static getNextSecondBar(s,o){let l;return s.get(o)?(l=s.getNextUnset(o),l=s.getNextSet(l)):(l=s.getNextSet(o),l=s.getNextUnset(l)),l}retrieveNextPair(s,o,l){let d=o.length%2==0;this.startFromEven&&(d=!d);let m,p=!0,v=-1;do this.findNextPair(s,o,v),m=this.parseFoundFinderPattern(s,l,d),m==null?v=Ge.getNextSecondBar(s,this.startEnd[0]):p=!1;while(p);let b=this.decodeDataCharacter(s,m,d,!0);if(!this.isEmptyPair(o)&&o[o.length-1].mustBeLast())throw new me;let T;try{T=this.decodeDataCharacter(s,m,d,!1)}catch(R){T=null,this.verbose&&console.log(R)}return new Bs(b,T,m,!0)}isEmptyPair(s){return s.length===0}findNextPair(s,o,l){let d=this.getDecodeFinderCounters();d[0]=0,d[1]=0,d[2]=0,d[3]=0;let m=s.getSize(),p;l>=0?p=l:this.isEmptyPair(o)?p=0:p=o[o.length-1].getFinderPattern().getStartEnd()[1];let v=o.length%2!=0;this.startFromEven&&(v=!v);let b=!1;for(;p<m&&(b=!s.get(p),!!b);)p++;let T=0,R=p;for(let O=p;O<m;O++)if(s.get(O)!=b)d[T]++;else{if(T==3){if(v&&Ge.reverseCounters(d),Ge.isFinderPattern(d)){this.startEnd[0]=R,this.startEnd[1]=O;return}v&&Ge.reverseCounters(d),R+=d[0]+d[1],d[0]=d[2],d[1]=d[3],d[2]=0,d[3]=0,T--}else T++;d[T]=1,b=!b}throw new me}static reverseCounters(s){let o=s.length;for(let l=0;l<o/2;++l){let d=s[l];s[l]=s[o-l-1],s[o-l-1]=d}}parseFoundFinderPattern(s,o,l){let d,m,p;if(l){let T=this.startEnd[0]-1;for(;T>=0&&!s.get(T);)T--;T++,d=this.startEnd[0]-T,m=T,p=this.startEnd[1]}else m=this.startEnd[0],p=s.getNextUnset(this.startEnd[1]+1),d=p-this.startEnd[1];let v=this.getDecodeFinderCounters();G.arraycopy(v,0,v,1,v.length-1),v[0]=d;let b;try{b=this.parseFinderValue(v,Ge.FINDER_PATTERNS)}catch{return null}return new fs(b,[m,p],m,p,o)}decodeDataCharacter(s,o,l,d){let m=this.getDataCharacterCounters();for(let Dn=0;Dn<m.length;Dn++)m[Dn]=0;if(d)Ge.recordPatternInReverse(s,o.getStartEnd()[0],m);else{Ge.recordPattern(s,o.getStartEnd()[1],m);for(let Dn=0,Vs=m.length-1;Dn<Vs;Dn++,Vs--){let Ei=m[Dn];m[Dn]=m[Vs],m[Vs]=Ei}}let p=17,v=at.sum(new Int32Array(m))/p,b=(o.getStartEnd()[1]-o.getStartEnd()[0])/15;if(Math.abs(v-b)/b>.3)throw new me;let T=this.getOddCounts(),R=this.getEvenCounts(),O=this.getOddRoundingErrors(),V=this.getEvenRoundingErrors();for(let Dn=0;Dn<m.length;Dn++){let Vs=1*m[Dn]/v,Ei=Vs+.5;if(Ei<1){if(Vs<.3)throw new me;Ei=1}else if(Ei>8){if(Vs>8.7)throw new me;Ei=8}let Za=Dn/2;(Dn&1)==0?(T[Za]=Ei,O[Za]=Vs-Ei):(R[Za]=Ei,V[Za]=Vs-Ei)}this.adjustOddEvenCounts(p);let K=4*o.getValue()+(l?0:2)+(d?0:1)-1,le=0,he=0;for(let Dn=T.length-1;Dn>=0;Dn--){if(Ge.isNotA1left(o,l,d)){let Vs=Ge.WEIGHTS[K][2*Dn];he+=T[Dn]*Vs}le+=T[Dn]}let we=0;for(let Dn=R.length-1;Dn>=0;Dn--)if(Ge.isNotA1left(o,l,d)){let Vs=Ge.WEIGHTS[K][2*Dn+1];we+=R[Dn]*Vs}let De=he+we;if((le&1)!=0||le>13||le<4)throw new me;let $e=(13-le)/2,Qe=Ge.SYMBOL_WIDEST[$e],Xe=9-Qe,Kt=$n.getRSSvalue(T,Qe,!0),jt=$n.getRSSvalue(R,Xe,!1),ms=Ge.EVEN_TOTAL_SUBSET[$e],Di=Ge.GSUM[$e],$s=Kt*ms+jt+Di;return new as($s,De)}static isNotA1left(s,o,l){return!(s.getValue()==0&&o&&l)}adjustOddEvenCounts(s){let o=at.sum(new Int32Array(this.getOddCounts())),l=at.sum(new Int32Array(this.getEvenCounts())),d=!1,m=!1;o>13?m=!0:o<4&&(d=!0);let p=!1,v=!1;l>13?v=!0:l<4&&(p=!0);let b=o+l-s,T=(o&1)==1,R=(l&1)==0;if(b==1)if(T){if(R)throw new me;m=!0}else{if(!R)throw new me;v=!0}else if(b==-1)if(T){if(R)throw new me;d=!0}else{if(!R)throw new me;p=!0}else if(b==0){if(T){if(!R)throw new me;o<l?(d=!0,v=!0):(m=!0,p=!0)}else if(R)throw new me}else throw new me;if(d){if(m)throw new me;Ge.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(m&&Ge.decrement(this.getOddCounts(),this.getOddRoundingErrors()),p){if(v)throw new me;Ge.increment(this.getEvenCounts(),this.getOddRoundingErrors())}v&&Ge.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())}}Ge.SYMBOL_WIDEST=[7,5,4,3,1],Ge.EVEN_TOTAL_SUBSET=[4,20,52,104,204],Ge.GSUM=[0,348,1388,2948,3988],Ge.FINDER_PATTERNS=[Int32Array.from([1,8,4,1]),Int32Array.from([3,6,4,1]),Int32Array.from([3,4,6,1]),Int32Array.from([3,2,8,1]),Int32Array.from([2,6,5,1]),Int32Array.from([2,2,9,1])],Ge.WEIGHTS=[[1,3,9,27,81,32,96,77],[20,60,180,118,143,7,21,63],[189,145,13,39,117,140,209,205],[193,157,49,147,19,57,171,91],[62,186,136,197,169,85,44,132],[185,133,188,142,4,12,36,108],[113,128,173,97,80,29,87,50],[150,28,84,41,123,158,52,156],[46,138,203,187,139,206,196,166],[76,17,51,153,37,111,122,155],[43,129,176,106,107,110,119,146],[16,48,144,10,30,90,59,177],[109,116,137,200,178,112,125,164],[70,210,208,202,184,130,179,115],[134,191,151,31,93,68,204,190],[148,22,66,198,172,94,71,2],[6,18,54,162,64,192,154,40],[120,149,25,75,14,42,126,167],[79,26,78,23,69,207,199,175],[103,98,83,38,114,131,182,124],[161,61,183,127,170,88,53,159],[55,165,73,8,24,72,5,15],[45,135,194,160,58,174,100,89]],Ge.FINDER_PAT_A=0,Ge.FINDER_PAT_B=1,Ge.FINDER_PAT_C=2,Ge.FINDER_PAT_D=3,Ge.FINDER_PAT_E=4,Ge.FINDER_PAT_F=5,Ge.FINDER_PATTERN_SEQUENCES=[[Ge.FINDER_PAT_A,Ge.FINDER_PAT_A],[Ge.FINDER_PAT_A,Ge.FINDER_PAT_B,Ge.FINDER_PAT_B],[Ge.FINDER_PAT_A,Ge.FINDER_PAT_C,Ge.FINDER_PAT_B,Ge.FINDER_PAT_D],[Ge.FINDER_PAT_A,Ge.FINDER_PAT_E,Ge.FINDER_PAT_B,Ge.FINDER_PAT_D,Ge.FINDER_PAT_C],[Ge.FINDER_PAT_A,Ge.FINDER_PAT_E,Ge.FINDER_PAT_B,Ge.FINDER_PAT_D,Ge.FINDER_PAT_D,Ge.FINDER_PAT_F],[Ge.FINDER_PAT_A,Ge.FINDER_PAT_E,Ge.FINDER_PAT_B,Ge.FINDER_PAT_D,Ge.FINDER_PAT_E,Ge.FINDER_PAT_F,Ge.FINDER_PAT_F],[Ge.FINDER_PAT_A,Ge.FINDER_PAT_A,Ge.FINDER_PAT_B,Ge.FINDER_PAT_B,Ge.FINDER_PAT_C,Ge.FINDER_PAT_C,Ge.FINDER_PAT_D,Ge.FINDER_PAT_D],[Ge.FINDER_PAT_A,Ge.FINDER_PAT_A,Ge.FINDER_PAT_B,Ge.FINDER_PAT_B,Ge.FINDER_PAT_C,Ge.FINDER_PAT_C,Ge.FINDER_PAT_D,Ge.FINDER_PAT_E,Ge.FINDER_PAT_E],[Ge.FINDER_PAT_A,Ge.FINDER_PAT_A,Ge.FINDER_PAT_B,Ge.FINDER_PAT_B,Ge.FINDER_PAT_C,Ge.FINDER_PAT_C,Ge.FINDER_PAT_D,Ge.FINDER_PAT_E,Ge.FINDER_PAT_F,Ge.FINDER_PAT_F],[Ge.FINDER_PAT_A,Ge.FINDER_PAT_A,Ge.FINDER_PAT_B,Ge.FINDER_PAT_B,Ge.FINDER_PAT_C,Ge.FINDER_PAT_D,Ge.FINDER_PAT_D,Ge.FINDER_PAT_E,Ge.FINDER_PAT_E,Ge.FINDER_PAT_F,Ge.FINDER_PAT_F]],Ge.MAX_PAIRS=11;class zo extends as{constructor(s,o,l){super(s,o),this.count=0,this.finderPattern=l}getFinderPattern(){return this.finderPattern}getCount(){return this.count}incrementCount(){this.count++}}class bn extends Yn{constructor(){super(...arguments),this.possibleLeftPairs=[],this.possibleRightPairs=[]}decodeRow(s,o,l){const d=this.decodePair(o,!1,s,l);bn.addOrTally(this.possibleLeftPairs,d),o.reverse();let m=this.decodePair(o,!0,s,l);bn.addOrTally(this.possibleRightPairs,m),o.reverse();for(let p of this.possibleLeftPairs)if(p.getCount()>1){for(let v of this.possibleRightPairs)if(v.getCount()>1&&bn.checkChecksum(p,v))return bn.constructResult(p,v)}throw new me}static addOrTally(s,o){if(o==null)return;let l=!1;for(let d of s)if(d.getValue()===o.getValue()){d.incrementCount(),l=!0;break}l||s.push(o)}reset(){this.possibleLeftPairs.length=0,this.possibleRightPairs.length=0}static constructResult(s,o){let l=4537077*s.getValue()+o.getValue(),d=new String(l).toString(),m=new z;for(let T=13-d.length;T>0;T--)m.append("0");m.append(d);let p=0;for(let T=0;T<13;T++){let R=m.charAt(T).charCodeAt(0)-48;p+=(T&1)===0?3*R:R}p=10-p%10,p===10&&(p=0),m.append(p.toString());let v=s.getFinderPattern().getResultPoints(),b=o.getFinderPattern().getResultPoints();return new pe(m.toString(),null,0,[v[0],v[1],b[0],b[1]],ie.RSS_14,new Date().getTime())}static checkChecksum(s,o){let l=(s.getChecksumPortion()+16*o.getChecksumPortion())%79,d=9*s.getFinderPattern().getValue()+o.getFinderPattern().getValue();return d>72&&d--,d>8&&d--,l===d}decodePair(s,o,l,d){try{let m=this.findFinderPattern(s,o),p=this.parseFoundFinderPattern(s,l,o,m),v=d==null?null:d.get(Ce.NEED_RESULT_POINT_CALLBACK);if(v!=null){let R=(m[0]+m[1])/2;o&&(R=s.getSize()-1-R),v.foundPossibleResultPoint(new de(R,l))}let b=this.decodeDataCharacter(s,p,!0),T=this.decodeDataCharacter(s,p,!1);return new zo(1597*b.getValue()+T.getValue(),b.getChecksumPortion()+4*T.getChecksumPortion(),p)}catch{return null}}decodeDataCharacter(s,o,l){let d=this.getDataCharacterCounters();for(let we=0;we<d.length;we++)d[we]=0;if(l)Qt.recordPatternInReverse(s,o.getStartEnd()[0],d);else{Qt.recordPattern(s,o.getStartEnd()[1]+1,d);for(let we=0,De=d.length-1;we<De;we++,De--){let $e=d[we];d[we]=d[De],d[De]=$e}}let m=l?16:15,p=at.sum(new Int32Array(d))/m,v=this.getOddCounts(),b=this.getEvenCounts(),T=this.getOddRoundingErrors(),R=this.getEvenRoundingErrors();for(let we=0;we<d.length;we++){let De=d[we]/p,$e=Math.floor(De+.5);$e<1?$e=1:$e>8&&($e=8);let Qe=Math.floor(we/2);(we&1)===0?(v[Qe]=$e,T[Qe]=De-$e):(b[Qe]=$e,R[Qe]=De-$e)}this.adjustOddEvenCounts(l,m);let O=0,V=0;for(let we=v.length-1;we>=0;we--)V*=9,V+=v[we],O+=v[we];let K=0,le=0;for(let we=b.length-1;we>=0;we--)K*=9,K+=b[we],le+=b[we];let he=V+3*K;if(l){if((O&1)!==0||O>12||O<4)throw new me;let we=(12-O)/2,De=bn.OUTSIDE_ODD_WIDEST[we],$e=9-De,Qe=$n.getRSSvalue(v,De,!1),Xe=$n.getRSSvalue(b,$e,!0),Kt=bn.OUTSIDE_EVEN_TOTAL_SUBSET[we],jt=bn.OUTSIDE_GSUM[we];return new as(Qe*Kt+Xe+jt,he)}else{if((le&1)!==0||le>10||le<4)throw new me;let we=(10-le)/2,De=bn.INSIDE_ODD_WIDEST[we],$e=9-De,Qe=$n.getRSSvalue(v,De,!0),Xe=$n.getRSSvalue(b,$e,!1),Kt=bn.INSIDE_ODD_TOTAL_SUBSET[we],jt=bn.INSIDE_GSUM[we];return new as(Xe*Kt+Qe+jt,he)}}findFinderPattern(s,o){let l=this.getDecodeFinderCounters();l[0]=0,l[1]=0,l[2]=0,l[3]=0;let d=s.getSize(),m=!1,p=0;for(;p<d&&(m=!s.get(p),o!==m);)p++;let v=0,b=p;for(let T=p;T<d;T++)if(s.get(T)!==m)l[v]++;else{if(v===3){if(Yn.isFinderPattern(l))return[b,T];b+=l[0]+l[1],l[0]=l[2],l[1]=l[3],l[2]=0,l[3]=0,v--}else v++;l[v]=1,m=!m}throw new me}parseFoundFinderPattern(s,o,l,d){let m=s.get(d[0]),p=d[0]-1;for(;p>=0&&m!==s.get(p);)p--;p++;const v=d[0]-p,b=this.getDecodeFinderCounters(),T=new Int32Array(b.length);G.arraycopy(b,0,T,1,b.length-1),T[0]=v;const R=this.parseFinderValue(T,bn.FINDER_PATTERNS);let O=p,V=d[1];return l&&(O=s.getSize()-1-O,V=s.getSize()-1-V),new fs(R,[p,d[1]],O,V,o)}adjustOddEvenCounts(s,o){let l=at.sum(new Int32Array(this.getOddCounts())),d=at.sum(new Int32Array(this.getEvenCounts())),m=!1,p=!1,v=!1,b=!1;s?(l>12?p=!0:l<4&&(m=!0),d>12?b=!0:d<4&&(v=!0)):(l>11?p=!0:l<5&&(m=!0),d>10?b=!0:d<4&&(v=!0));let T=l+d-o,R=(l&1)===(s?1:0),O=(d&1)===1;if(T===1)if(R){if(O)throw new me;p=!0}else{if(!O)throw new me;b=!0}else if(T===-1)if(R){if(O)throw new me;m=!0}else{if(!O)throw new me;v=!0}else if(T===0){if(R){if(!O)throw new me;l<d?(m=!0,b=!0):(p=!0,v=!0)}else if(O)throw new me}else throw new me;if(m){if(p)throw new me;Yn.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(p&&Yn.decrement(this.getOddCounts(),this.getOddRoundingErrors()),v){if(b)throw new me;Yn.increment(this.getEvenCounts(),this.getOddRoundingErrors())}b&&Yn.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())}}bn.OUTSIDE_EVEN_TOTAL_SUBSET=[1,10,34,70,126],bn.INSIDE_ODD_TOTAL_SUBSET=[4,20,48,81],bn.OUTSIDE_GSUM=[0,161,961,2015,2715],bn.INSIDE_GSUM=[0,336,1036,1516],bn.OUTSIDE_ODD_WIDEST=[8,6,4,3,1],bn.INSIDE_ODD_WIDEST=[2,4,6,8],bn.FINDER_PATTERNS=[Int32Array.from([3,8,2,1]),Int32Array.from([3,5,5,1]),Int32Array.from([3,3,7,1]),Int32Array.from([3,1,9,1]),Int32Array.from([2,7,4,1]),Int32Array.from([2,5,6,1]),Int32Array.from([2,3,8,1]),Int32Array.from([1,5,7,1]),Int32Array.from([1,3,9,1])];class Ks extends Qt{constructor(s,o){super(),this.readers=[],this.verbose=o===!0;const l=s?s.get(Ce.POSSIBLE_FORMATS):null,d=s&&s.get(Ce.ASSUME_CODE_39_CHECK_DIGIT)!==void 0;l?((l.includes(ie.EAN_13)||l.includes(ie.UPC_A)||l.includes(ie.EAN_8)||l.includes(ie.UPC_E))&&this.readers.push(new Ci(s)),l.includes(ie.CODE_39)&&this.readers.push(new en(d)),l.includes(ie.CODE_128)&&this.readers.push(new We),l.includes(ie.ITF)&&this.readers.push(new Ct),l.includes(ie.RSS_14)&&this.readers.push(new bn),l.includes(ie.RSS_EXPANDED)&&this.readers.push(new Ge(this.verbose))):(this.readers.push(new Ci(s)),this.readers.push(new en),this.readers.push(new Ci(s)),this.readers.push(new We),this.readers.push(new Ct),this.readers.push(new bn),this.readers.push(new Ge(this.verbose)))}decodeRow(s,o,l){for(let d=0;d<this.readers.length;d++)try{return this.readers[d].decodeRow(s,o,l)}catch{}throw new me}reset(){this.readers.forEach(s=>s.reset())}}class Ho extends ce{constructor(s=500,o){super(new Ks(o),s,o)}}class an{constructor(s,o,l){this.ecCodewords=s,this.ecBlocks=[o],l&&this.ecBlocks.push(l)}getECCodewords(){return this.ecCodewords}getECBlocks(){return this.ecBlocks}}class tn{constructor(s,o){this.count=s,this.dataCodewords=o}getCount(){return this.count}getDataCodewords(){return this.dataCodewords}}class Xt{constructor(s,o,l,d,m,p){this.versionNumber=s,this.symbolSizeRows=o,this.symbolSizeColumns=l,this.dataRegionSizeRows=d,this.dataRegionSizeColumns=m,this.ecBlocks=p;let v=0;const b=p.getECCodewords(),T=p.getECBlocks();for(let R of T)v+=R.getCount()*(R.getDataCodewords()+b);this.totalCodewords=v}getVersionNumber(){return this.versionNumber}getSymbolSizeRows(){return this.symbolSizeRows}getSymbolSizeColumns(){return this.symbolSizeColumns}getDataRegionSizeRows(){return this.dataRegionSizeRows}getDataRegionSizeColumns(){return this.dataRegionSizeColumns}getTotalCodewords(){return this.totalCodewords}getECBlocks(){return this.ecBlocks}static getVersionForDimensions(s,o){if((s&1)!==0||(o&1)!==0)throw new P;for(let l of Xt.VERSIONS)if(l.symbolSizeRows===s&&l.symbolSizeColumns===o)return l;throw new P}toString(){return""+this.versionNumber}static buildVersions(){return[new Xt(1,10,10,8,8,new an(5,new tn(1,3))),new Xt(2,12,12,10,10,new an(7,new tn(1,5))),new Xt(3,14,14,12,12,new an(10,new tn(1,8))),new Xt(4,16,16,14,14,new an(12,new tn(1,12))),new Xt(5,18,18,16,16,new an(14,new tn(1,18))),new Xt(6,20,20,18,18,new an(18,new tn(1,22))),new Xt(7,22,22,20,20,new an(20,new tn(1,30))),new Xt(8,24,24,22,22,new an(24,new tn(1,36))),new Xt(9,26,26,24,24,new an(28,new tn(1,44))),new Xt(10,32,32,14,14,new an(36,new tn(1,62))),new Xt(11,36,36,16,16,new an(42,new tn(1,86))),new Xt(12,40,40,18,18,new an(48,new tn(1,114))),new Xt(13,44,44,20,20,new an(56,new tn(1,144))),new Xt(14,48,48,22,22,new an(68,new tn(1,174))),new Xt(15,52,52,24,24,new an(42,new tn(2,102))),new Xt(16,64,64,14,14,new an(56,new tn(2,140))),new Xt(17,72,72,16,16,new an(36,new tn(4,92))),new Xt(18,80,80,18,18,new an(48,new tn(4,114))),new Xt(19,88,88,20,20,new an(56,new tn(4,144))),new Xt(20,96,96,22,22,new an(68,new tn(4,174))),new Xt(21,104,104,24,24,new an(56,new tn(6,136))),new Xt(22,120,120,18,18,new an(68,new tn(6,175))),new Xt(23,132,132,20,20,new an(62,new tn(8,163))),new Xt(24,144,144,22,22,new an(62,new tn(8,156),new tn(2,155))),new Xt(25,8,18,6,16,new an(7,new tn(1,5))),new Xt(26,8,32,6,14,new an(11,new tn(1,10))),new Xt(27,12,26,10,24,new an(14,new tn(1,16))),new Xt(28,12,36,10,16,new an(18,new tn(1,22))),new Xt(29,16,36,14,16,new an(24,new tn(1,32))),new Xt(30,16,48,14,22,new an(28,new tn(1,49)))]}}Xt.VERSIONS=Xt.buildVersions();class Pr{constructor(s){const o=s.getHeight();if(o<8||o>144||(o&1)!==0)throw new P;this.version=Pr.readVersion(s),this.mappingBitMatrix=this.extractDataRegion(s),this.readMappingMatrix=new Ye(this.mappingBitMatrix.getWidth(),this.mappingBitMatrix.getHeight())}getVersion(){return this.version}static readVersion(s){const o=s.getHeight(),l=s.getWidth();return Xt.getVersionForDimensions(o,l)}readCodewords(){const s=new Int8Array(this.version.getTotalCodewords());let o=0,l=4,d=0;const m=this.mappingBitMatrix.getHeight(),p=this.mappingBitMatrix.getWidth();let v=!1,b=!1,T=!1,R=!1;do if(l===m&&d===0&&!v)s[o++]=this.readCorner1(m,p)&255,l-=2,d+=2,v=!0;else if(l===m-2&&d===0&&(p&3)!==0&&!b)s[o++]=this.readCorner2(m,p)&255,l-=2,d+=2,b=!0;else if(l===m+4&&d===2&&(p&7)===0&&!T)s[o++]=this.readCorner3(m,p)&255,l-=2,d+=2,T=!0;else if(l===m-2&&d===0&&(p&7)===4&&!R)s[o++]=this.readCorner4(m,p)&255,l-=2,d+=2,R=!0;else{do l<m&&d>=0&&!this.readMappingMatrix.get(d,l)&&(s[o++]=this.readUtah(l,d,m,p)&255),l-=2,d+=2;while(l>=0&&d<p);l+=1,d+=3;do l>=0&&d<p&&!this.readMappingMatrix.get(d,l)&&(s[o++]=this.readUtah(l,d,m,p)&255),l+=2,d-=2;while(l<m&&d>=0);l+=3,d+=1}while(l<m||d<p);if(o!==this.version.getTotalCodewords())throw new P;return s}readModule(s,o,l,d){return s<0&&(s+=l,o+=4-(l+4&7)),o<0&&(o+=d,s+=4-(d+4&7)),this.readMappingMatrix.set(o,s),this.mappingBitMatrix.get(o,s)}readUtah(s,o,l,d){let m=0;return this.readModule(s-2,o-2,l,d)&&(m|=1),m<<=1,this.readModule(s-2,o-1,l,d)&&(m|=1),m<<=1,this.readModule(s-1,o-2,l,d)&&(m|=1),m<<=1,this.readModule(s-1,o-1,l,d)&&(m|=1),m<<=1,this.readModule(s-1,o,l,d)&&(m|=1),m<<=1,this.readModule(s,o-2,l,d)&&(m|=1),m<<=1,this.readModule(s,o-1,l,d)&&(m|=1),m<<=1,this.readModule(s,o,l,d)&&(m|=1),m}readCorner1(s,o){let l=0;return this.readModule(s-1,0,s,o)&&(l|=1),l<<=1,this.readModule(s-1,1,s,o)&&(l|=1),l<<=1,this.readModule(s-1,2,s,o)&&(l|=1),l<<=1,this.readModule(0,o-2,s,o)&&(l|=1),l<<=1,this.readModule(0,o-1,s,o)&&(l|=1),l<<=1,this.readModule(1,o-1,s,o)&&(l|=1),l<<=1,this.readModule(2,o-1,s,o)&&(l|=1),l<<=1,this.readModule(3,o-1,s,o)&&(l|=1),l}readCorner2(s,o){let l=0;return this.readModule(s-3,0,s,o)&&(l|=1),l<<=1,this.readModule(s-2,0,s,o)&&(l|=1),l<<=1,this.readModule(s-1,0,s,o)&&(l|=1),l<<=1,this.readModule(0,o-4,s,o)&&(l|=1),l<<=1,this.readModule(0,o-3,s,o)&&(l|=1),l<<=1,this.readModule(0,o-2,s,o)&&(l|=1),l<<=1,this.readModule(0,o-1,s,o)&&(l|=1),l<<=1,this.readModule(1,o-1,s,o)&&(l|=1),l}readCorner3(s,o){let l=0;return this.readModule(s-1,0,s,o)&&(l|=1),l<<=1,this.readModule(s-1,o-1,s,o)&&(l|=1),l<<=1,this.readModule(0,o-3,s,o)&&(l|=1),l<<=1,this.readModule(0,o-2,s,o)&&(l|=1),l<<=1,this.readModule(0,o-1,s,o)&&(l|=1),l<<=1,this.readModule(1,o-3,s,o)&&(l|=1),l<<=1,this.readModule(1,o-2,s,o)&&(l|=1),l<<=1,this.readModule(1,o-1,s,o)&&(l|=1),l}readCorner4(s,o){let l=0;return this.readModule(s-3,0,s,o)&&(l|=1),l<<=1,this.readModule(s-2,0,s,o)&&(l|=1),l<<=1,this.readModule(s-1,0,s,o)&&(l|=1),l<<=1,this.readModule(0,o-2,s,o)&&(l|=1),l<<=1,this.readModule(0,o-1,s,o)&&(l|=1),l<<=1,this.readModule(1,o-1,s,o)&&(l|=1),l<<=1,this.readModule(2,o-1,s,o)&&(l|=1),l<<=1,this.readModule(3,o-1,s,o)&&(l|=1),l}extractDataRegion(s){const o=this.version.getSymbolSizeRows(),l=this.version.getSymbolSizeColumns();if(s.getHeight()!==o)throw new I("Dimension of bitMatrix must match the version size");const d=this.version.getDataRegionSizeRows(),m=this.version.getDataRegionSizeColumns(),p=o/d|0,v=l/m|0,b=p*d,T=v*m,R=new Ye(T,b);for(let O=0;O<p;++O){const V=O*d;for(let K=0;K<v;++K){const le=K*m;for(let he=0;he<d;++he){const we=O*(d+2)+1+he,De=V+he;for(let $e=0;$e<m;++$e){const Qe=K*(m+2)+1+$e;if(s.get(Qe,we)){const Xe=le+$e;R.set(Xe,De)}}}}}return R}}class Qs{constructor(s,o){this.numDataCodewords=s,this.codewords=o}static getDataBlocks(s,o){const l=o.getECBlocks();let d=0;const m=l.getECBlocks();for(let he of m)d+=he.getCount();const p=new Array(d);let v=0;for(let he of m)for(let we=0;we<he.getCount();we++){const De=he.getDataCodewords(),$e=l.getECCodewords()+De;p[v++]=new Qs(De,new Uint8Array($e))}const T=p[0].codewords.length-l.getECCodewords(),R=T-1;let O=0;for(let he=0;he<R;he++)for(let we=0;we<v;we++)p[we].codewords[he]=s[O++];const V=o.getVersionNumber()===24,K=V?8:v;for(let he=0;he<K;he++)p[he].codewords[T-1]=s[O++];const le=p[0].codewords.length;for(let he=T;he<le;he++)for(let we=0;we<v;we++){const De=V?(we+8)%v:we,$e=V&&De>7?he-1:he;p[De].codewords[$e]=s[O++]}if(O!==s.length)throw new I;return p}getNumDataCodewords(){return this.numDataCodewords}getCodewords(){return this.codewords}}class es{constructor(s){this.bytes=s,this.byteOffset=0,this.bitOffset=0}getBitOffset(){return this.bitOffset}getByteOffset(){return this.byteOffset}readBits(s){if(s<1||s>32||s>this.available())throw new I(""+s);let o=0,l=this.bitOffset,d=this.byteOffset;const m=this.bytes;if(l>0){const p=8-l,v=s<p?s:p,b=p-v,T=255>>8-v<<b;o=(m[d]&T)>>b,s-=v,l+=v,l===8&&(l=0,d++)}if(s>0){for(;s>=8;)o=o<<8|m[d]&255,d++,s-=8;if(s>0){const p=8-s,v=255>>p<<p;o=o<<s|(m[d]&v)>>p,l+=s}}return this.bitOffset=l,this.byteOffset=d,o}available(){return 8*(this.bytes.length-this.byteOffset)-this.bitOffset}}var $t;(function(M){M[M.PAD_ENCODE=0]="PAD_ENCODE",M[M.ASCII_ENCODE=1]="ASCII_ENCODE",M[M.C40_ENCODE=2]="C40_ENCODE",M[M.TEXT_ENCODE=3]="TEXT_ENCODE",M[M.ANSIX12_ENCODE=4]="ANSIX12_ENCODE",M[M.EDIFACT_ENCODE=5]="EDIFACT_ENCODE",M[M.BASE256_ENCODE=6]="BASE256_ENCODE"})($t||($t={}));class Zs{static decode(s){const o=new es(s),l=new z,d=new z,m=new Array;let p=$t.ASCII_ENCODE;do if(p===$t.ASCII_ENCODE)p=this.decodeAsciiSegment(o,l,d);else{switch(p){case $t.C40_ENCODE:this.decodeC40Segment(o,l);break;case $t.TEXT_ENCODE:this.decodeTextSegment(o,l);break;case $t.ANSIX12_ENCODE:this.decodeAnsiX12Segment(o,l);break;case $t.EDIFACT_ENCODE:this.decodeEdifactSegment(o,l);break;case $t.BASE256_ENCODE:this.decodeBase256Segment(o,l,m);break;default:throw new P}p=$t.ASCII_ENCODE}while(p!==$t.PAD_ENCODE&&o.available()>0);return d.length()>0&&l.append(d.toString()),new it(s,l.toString(),m.length===0?null:m,null)}static decodeAsciiSegment(s,o,l){let d=!1;do{let m=s.readBits(8);if(m===0)throw new P;if(m<=128)return d&&(m+=128),o.append(String.fromCharCode(m-1)),$t.ASCII_ENCODE;if(m===129)return $t.PAD_ENCODE;if(m<=229){const p=m-130;p<10&&o.append("0"),o.append(""+p)}else switch(m){case 230:return $t.C40_ENCODE;case 231:return $t.BASE256_ENCODE;case 232:o.append("");break;case 233:case 234:break;case 235:d=!0;break;case 236:o.append("[)>05"),l.insert(0,"");break;case 237:o.append("[)>06"),l.insert(0,"");break;case 238:return $t.ANSIX12_ENCODE;case 239:return $t.TEXT_ENCODE;case 240:return $t.EDIFACT_ENCODE;case 241:break;default:if(m!==254||s.available()!==0)throw new P;break}}while(s.available()>0);return $t.ASCII_ENCODE}static decodeC40Segment(s,o){let l=!1;const d=[];let m=0;do{if(s.available()===8)return;const p=s.readBits(8);if(p===254)return;this.parseTwoBytes(p,s.readBits(8),d);for(let v=0;v<3;v++){const b=d[v];switch(m){case 0:if(b<3)m=b+1;else if(b<this.C40_BASIC_SET_CHARS.length){const T=this.C40_BASIC_SET_CHARS[b];l?(o.append(String.fromCharCode(T.charCodeAt(0)+128)),l=!1):o.append(T)}else throw new P;break;case 1:l?(o.append(String.fromCharCode(b+128)),l=!1):o.append(String.fromCharCode(b)),m=0;break;case 2:if(b<this.C40_SHIFT2_SET_CHARS.length){const T=this.C40_SHIFT2_SET_CHARS[b];l?(o.append(String.fromCharCode(T.charCodeAt(0)+128)),l=!1):o.append(T)}else switch(b){case 27:o.append("");break;case 30:l=!0;break;default:throw new P}m=0;break;case 3:l?(o.append(String.fromCharCode(b+224)),l=!1):o.append(String.fromCharCode(b+96)),m=0;break;default:throw new P}}}while(s.available()>0)}static decodeTextSegment(s,o){let l=!1,d=[],m=0;do{if(s.available()===8)return;const p=s.readBits(8);if(p===254)return;this.parseTwoBytes(p,s.readBits(8),d);for(let v=0;v<3;v++){const b=d[v];switch(m){case 0:if(b<3)m=b+1;else if(b<this.TEXT_BASIC_SET_CHARS.length){const T=this.TEXT_BASIC_SET_CHARS[b];l?(o.append(String.fromCharCode(T.charCodeAt(0)+128)),l=!1):o.append(T)}else throw new P;break;case 1:l?(o.append(String.fromCharCode(b+128)),l=!1):o.append(String.fromCharCode(b)),m=0;break;case 2:if(b<this.TEXT_SHIFT2_SET_CHARS.length){const T=this.TEXT_SHIFT2_SET_CHARS[b];l?(o.append(String.fromCharCode(T.charCodeAt(0)+128)),l=!1):o.append(T)}else switch(b){case 27:o.append("");break;case 30:l=!0;break;default:throw new P}m=0;break;case 3:if(b<this.TEXT_SHIFT3_SET_CHARS.length){const T=this.TEXT_SHIFT3_SET_CHARS[b];l?(o.append(String.fromCharCode(T.charCodeAt(0)+128)),l=!1):o.append(T),m=0}else throw new P;break;default:throw new P}}}while(s.available()>0)}static decodeAnsiX12Segment(s,o){const l=[];do{if(s.available()===8)return;const d=s.readBits(8);if(d===254)return;this.parseTwoBytes(d,s.readBits(8),l);for(let m=0;m<3;m++){const p=l[m];switch(p){case 0:o.append("\r");break;case 1:o.append("*");break;case 2:o.append(">");break;case 3:o.append(" ");break;default:if(p<14)o.append(String.fromCharCode(p+44));else if(p<40)o.append(String.fromCharCode(p+51));else throw new P;break}}}while(s.available()>0)}static parseTwoBytes(s,o,l){let d=(s<<8)+o-1,m=Math.floor(d/1600);l[0]=m,d-=m*1600,m=Math.floor(d/40),l[1]=m,l[2]=d-m*40}static decodeEdifactSegment(s,o){do{if(s.available()<=16)return;for(let l=0;l<4;l++){let d=s.readBits(6);if(d===31){const m=8-s.getBitOffset();m!==8&&s.readBits(m);return}(d&32)===0&&(d|=64),o.append(String.fromCharCode(d))}}while(s.available()>0)}static decodeBase256Segment(s,o,l){let d=1+s.getByteOffset();const m=this.unrandomize255State(s.readBits(8),d++);let p;if(m===0?p=s.available()/8|0:m<250?p=m:p=250*(m-249)+this.unrandomize255State(s.readBits(8),d++),p<0)throw new P;const v=new Uint8Array(p);for(let b=0;b<p;b++){if(s.available()<8)throw new P;v[b]=this.unrandomize255State(s.readBits(8),d++)}l.push(v);try{o.append(Z.decode(v,Q.ISO88591))}catch(b){throw new zt("Platform does not support required encoding: "+b.message)}}static unrandomize255State(s,o){const l=149*o%255+1,d=s-l;return d>=0?d:d+256}}Zs.C40_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],Zs.C40_SHIFT2_SET_CHARS=["!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","@","[","\\","]","^","_"],Zs.TEXT_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],Zs.TEXT_SHIFT2_SET_CHARS=Zs.C40_SHIFT2_SET_CHARS,Zs.TEXT_SHIFT3_SET_CHARS=["`","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","{","|","}","~",""];class Go{constructor(){this.rsDecoder=new Pt(wt.DATA_MATRIX_FIELD_256)}decode(s){const o=new Pr(s),l=o.getVersion(),d=o.readCodewords(),m=Qs.getDataBlocks(d,l);let p=0;for(let T of m)p+=T.getNumDataCodewords();const v=new Uint8Array(p),b=m.length;for(let T=0;T<b;T++){const R=m[T],O=R.getCodewords(),V=R.getNumDataCodewords();this.correctErrors(O,V);for(let K=0;K<V;K++)v[K*b+T]=O[K]}return Zs.decode(v)}correctErrors(s,o){const l=new Int32Array(s);try{this.rsDecoder.decode(l,s.length-o)}catch{throw new Y}for(let d=0;d<o;d++)s[d]=l[d]}}class St{constructor(s){this.image=s,this.rectangleDetector=new ot(this.image)}detect(){const s=this.rectangleDetector.detect();let o=this.detectSolid1(s);if(o=this.detectSolid2(o),o[3]=this.correctTopRight(o),!o[3])throw new me;o=this.shiftToModuleCenter(o);const l=o[0],d=o[1],m=o[2],p=o[3];let v=this.transitionsBetween(l,p)+1,b=this.transitionsBetween(m,p)+1;(v&1)===1&&(v+=1),(b&1)===1&&(b+=1),4*v<7*b&&4*b<7*v&&(v=b=Math.max(v,b));let T=St.sampleGrid(this.image,l,d,m,p,v,b);return new et(T,[l,d,m,p])}static shiftPoint(s,o,l){let d=(o.getX()-s.getX())/(l+1),m=(o.getY()-s.getY())/(l+1);return new de(s.getX()+d,s.getY()+m)}static moveAway(s,o,l){let d=s.getX(),m=s.getY();return d<o?d-=1:d+=1,m<l?m-=1:m+=1,new de(d,m)}detectSolid1(s){let o=s[0],l=s[1],d=s[3],m=s[2],p=this.transitionsBetween(o,l),v=this.transitionsBetween(l,d),b=this.transitionsBetween(d,m),T=this.transitionsBetween(m,o),R=p,O=[m,o,l,d];return R>v&&(R=v,O[0]=o,O[1]=l,O[2]=d,O[3]=m),R>b&&(R=b,O[0]=l,O[1]=d,O[2]=m,O[3]=o),R>T&&(O[0]=d,O[1]=m,O[2]=o,O[3]=l),O}detectSolid2(s){let o=s[0],l=s[1],d=s[2],m=s[3],p=this.transitionsBetween(o,m),v=St.shiftPoint(l,d,(p+1)*4),b=St.shiftPoint(d,l,(p+1)*4),T=this.transitionsBetween(v,o),R=this.transitionsBetween(b,m);return T<R?(s[0]=o,s[1]=l,s[2]=d,s[3]=m):(s[0]=l,s[1]=d,s[2]=m,s[3]=o),s}correctTopRight(s){let o=s[0],l=s[1],d=s[2],m=s[3],p=this.transitionsBetween(o,m),v=this.transitionsBetween(l,m),b=St.shiftPoint(o,l,(v+1)*4),T=St.shiftPoint(d,l,(p+1)*4);p=this.transitionsBetween(b,m),v=this.transitionsBetween(T,m);let R=new de(m.getX()+(d.getX()-l.getX())/(p+1),m.getY()+(d.getY()-l.getY())/(p+1)),O=new de(m.getX()+(o.getX()-l.getX())/(v+1),m.getY()+(o.getY()-l.getY())/(v+1));if(!this.isValid(R))return this.isValid(O)?O:null;if(!this.isValid(O))return R;let V=this.transitionsBetween(b,R)+this.transitionsBetween(T,R),K=this.transitionsBetween(b,O)+this.transitionsBetween(T,O);return V>K?R:O}shiftToModuleCenter(s){let o=s[0],l=s[1],d=s[2],m=s[3],p=this.transitionsBetween(o,m)+1,v=this.transitionsBetween(d,m)+1,b=St.shiftPoint(o,l,v*4),T=St.shiftPoint(d,l,p*4);p=this.transitionsBetween(b,m)+1,v=this.transitionsBetween(T,m)+1,(p&1)===1&&(p+=1),(v&1)===1&&(v+=1);let R=(o.getX()+l.getX()+d.getX()+m.getX())/4,O=(o.getY()+l.getY()+d.getY()+m.getY())/4;o=St.moveAway(o,R,O),l=St.moveAway(l,R,O),d=St.moveAway(d,R,O),m=St.moveAway(m,R,O);let V,K;return b=St.shiftPoint(o,l,v*4),b=St.shiftPoint(b,m,p*4),V=St.shiftPoint(l,o,v*4),V=St.shiftPoint(V,d,p*4),T=St.shiftPoint(d,m,v*4),T=St.shiftPoint(T,l,p*4),K=St.shiftPoint(m,d,v*4),K=St.shiftPoint(K,o,p*4),[b,V,T,K]}isValid(s){return s.getX()>=0&&s.getX()<this.image.getWidth()&&s.getY()>0&&s.getY()<this.image.getHeight()}static sampleGrid(s,o,l,d,m,p,v){return Vn.getInstance().sampleGrid(s,p,v,.5,.5,p-.5,.5,p-.5,v-.5,.5,v-.5,o.getX(),o.getY(),m.getX(),m.getY(),d.getX(),d.getY(),l.getX(),l.getY())}transitionsBetween(s,o){let l=Math.trunc(s.getX()),d=Math.trunc(s.getY()),m=Math.trunc(o.getX()),p=Math.trunc(o.getY()),v=Math.abs(p-d)>Math.abs(m-l);if(v){let he=l;l=d,d=he,he=m,m=p,p=he}let b=Math.abs(m-l),T=Math.abs(p-d),R=-b/2,O=d<p?1:-1,V=l<m?1:-1,K=0,le=this.image.get(v?d:l,v?l:d);for(let he=l,we=d;he!==m;he+=V){let De=this.image.get(v?we:he,v?he:we);if(De!==le&&(K++,le=De),R+=T,R>0){if(we===p)break;we+=O,R-=b}}return K}}class oi{constructor(){this.decoder=new Go}decode(s,o=null){let l,d;if(o!=null&&o.has(Ce.PURE_BARCODE)){const T=oi.extractPureBits(s.getBlackMatrix());l=this.decoder.decode(T),d=oi.NO_POINTS}else{const T=new St(s.getBlackMatrix()).detect();l=this.decoder.decode(T.getBits()),d=T.getPoints()}const m=l.getRawBytes(),p=new pe(l.getText(),m,8*m.length,d,ie.DATA_MATRIX,G.currentTimeMillis()),v=l.getByteSegments();v!=null&&p.putMetadata(Pe.BYTE_SEGMENTS,v);const b=l.getECLevel();return b!=null&&p.putMetadata(Pe.ERROR_CORRECTION_LEVEL,b),p}reset(){}static extractPureBits(s){const o=s.getTopLeftOnBit(),l=s.getBottomRightOnBit();if(o==null||l==null)throw new me;const d=this.moduleSize(o,s);let m=o[1];const p=l[1];let v=o[0];const T=(l[0]-v+1)/d,R=(p-m+1)/d;if(T<=0||R<=0)throw new me;const O=d/2;m+=O,v+=O;const V=new Ye(T,R);for(let K=0;K<R;K++){const le=m+K*d;for(let he=0;he<T;he++)s.get(v+he*d,le)&&V.set(he,K)}return V}static moduleSize(s,o){const l=o.getWidth();let d=s[0];const m=s[1];for(;d<l&&o.get(d,m);)d++;if(d===l)throw new me;const p=d-s[0];if(p===0)throw new me;return p}}oi.NO_POINTS=[];class nr extends ce{constructor(s=500){super(new oi,s)}}var Si;(function(M){M[M.L=0]="L",M[M.M=1]="M",M[M.Q=2]="Q",M[M.H=3]="H"})(Si||(Si={}));class Wt{constructor(s,o,l){this.value=s,this.stringValue=o,this.bits=l,Wt.FOR_BITS.set(l,this),Wt.FOR_VALUE.set(s,this)}getValue(){return this.value}getBits(){return this.bits}static fromString(s){switch(s){case"L":return Wt.L;case"M":return Wt.M;case"Q":return Wt.Q;case"H":return Wt.H;default:throw new S(s+"not available")}}toString(){return this.stringValue}equals(s){if(!(s instanceof Wt))return!1;const o=s;return this.value===o.value}static forBits(s){if(s<0||s>=Wt.FOR_BITS.size)throw new I;return Wt.FOR_BITS.get(s)}}Wt.FOR_BITS=new Map,Wt.FOR_VALUE=new Map,Wt.L=new Wt(Si.L,"L",1),Wt.M=new Wt(Si.M,"M",0),Wt.Q=new Wt(Si.Q,"Q",3),Wt.H=new Wt(Si.H,"H",2);class ls{constructor(s){this.errorCorrectionLevel=Wt.forBits(s>>3&3),this.dataMask=s&7}static numBitsDiffering(s,o){return ue.bitCount(s^o)}static decodeFormatInformation(s,o){const l=ls.doDecodeFormatInformation(s,o);return l!==null?l:ls.doDecodeFormatInformation(s^ls.FORMAT_INFO_MASK_QR,o^ls.FORMAT_INFO_MASK_QR)}static doDecodeFormatInformation(s,o){let l=Number.MAX_SAFE_INTEGER,d=0;for(const m of ls.FORMAT_INFO_DECODE_LOOKUP){const p=m[0];if(p===s||p===o)return new ls(m[1]);let v=ls.numBitsDiffering(s,p);v<l&&(d=m[1],l=v),s!==o&&(v=ls.numBitsDiffering(o,p),v<l&&(d=m[1],l=v))}return l<=3?new ls(d):null}getErrorCorrectionLevel(){return this.errorCorrectionLevel}getDataMask(){return this.dataMask}hashCode(){return this.errorCorrectionLevel.getBits()<<3|this.dataMask}equals(s){if(!(s instanceof ls))return!1;const o=s;return this.errorCorrectionLevel===o.errorCorrectionLevel&&this.dataMask===o.dataMask}}ls.FORMAT_INFO_MASK_QR=21522,ls.FORMAT_INFO_DECODE_LOOKUP=[Int32Array.from([21522,0]),Int32Array.from([20773,1]),Int32Array.from([24188,2]),Int32Array.from([23371,3]),Int32Array.from([17913,4]),Int32Array.from([16590,5]),Int32Array.from([20375,6]),Int32Array.from([19104,7]),Int32Array.from([30660,8]),Int32Array.from([29427,9]),Int32Array.from([32170,10]),Int32Array.from([30877,11]),Int32Array.from([26159,12]),Int32Array.from([25368,13]),Int32Array.from([27713,14]),Int32Array.from([26998,15]),Int32Array.from([5769,16]),Int32Array.from([5054,17]),Int32Array.from([7399,18]),Int32Array.from([6608,19]),Int32Array.from([1890,20]),Int32Array.from([597,21]),Int32Array.from([3340,22]),Int32Array.from([2107,23]),Int32Array.from([13663,24]),Int32Array.from([12392,25]),Int32Array.from([16177,26]),Int32Array.from([14854,27]),Int32Array.from([9396,28]),Int32Array.from([8579,29]),Int32Array.from([11994,30]),Int32Array.from([11245,31])];class Ee{constructor(s,...o){this.ecCodewordsPerBlock=s,this.ecBlocks=o}getECCodewordsPerBlock(){return this.ecCodewordsPerBlock}getNumBlocks(){let s=0;const o=this.ecBlocks;for(const l of o)s+=l.getCount();return s}getTotalECCodewords(){return this.ecCodewordsPerBlock*this.getNumBlocks()}getECBlocks(){return this.ecBlocks}}class W{constructor(s,o){this.count=s,this.dataCodewords=o}getCount(){return this.count}getDataCodewords(){return this.dataCodewords}}class ut{constructor(s,o,...l){this.versionNumber=s,this.alignmentPatternCenters=o,this.ecBlocks=l;let d=0;const m=l[0].getECCodewordsPerBlock(),p=l[0].getECBlocks();for(const v of p)d+=v.getCount()*(v.getDataCodewords()+m);this.totalCodewords=d}getVersionNumber(){return this.versionNumber}getAlignmentPatternCenters(){return this.alignmentPatternCenters}getTotalCodewords(){return this.totalCodewords}getDimensionForVersion(){return 17+4*this.versionNumber}getECBlocksForLevel(s){return this.ecBlocks[s.getValue()]}static getProvisionalVersionForDimension(s){if(s%4!==1)throw new P;try{return this.getVersionForNumber((s-17)/4)}catch{throw new P}}static getVersionForNumber(s){if(s<1||s>40)throw new I;return ut.VERSIONS[s-1]}static decodeVersionInformation(s){let o=Number.MAX_SAFE_INTEGER,l=0;for(let d=0;d<ut.VERSION_DECODE_INFO.length;d++){const m=ut.VERSION_DECODE_INFO[d];if(m===s)return ut.getVersionForNumber(d+7);const p=ls.numBitsDiffering(s,m);p<o&&(l=d+7,o=p)}return o<=3?ut.getVersionForNumber(l):null}buildFunctionPattern(){const s=this.getDimensionForVersion(),o=new Ye(s);o.setRegion(0,0,9,9),o.setRegion(s-8,0,8,9),o.setRegion(0,s-8,9,8);const l=this.alignmentPatternCenters.length;for(let d=0;d<l;d++){const m=this.alignmentPatternCenters[d]-2;for(let p=0;p<l;p++)d===0&&(p===0||p===l-1)||d===l-1&&p===0||o.setRegion(this.alignmentPatternCenters[p]-2,m,5,5)}return o.setRegion(6,9,1,s-17),o.setRegion(9,6,s-17,1),this.versionNumber>6&&(o.setRegion(s-11,0,3,6),o.setRegion(0,s-11,6,3)),o}toString(){return""+this.versionNumber}}ut.VERSION_DECODE_INFO=Int32Array.from([31892,34236,39577,42195,48118,51042,55367,58893,63784,68472,70749,76311,79154,84390,87683,92361,96236,102084,102881,110507,110734,117786,119615,126325,127568,133589,136944,141498,145311,150283,152622,158308,161089,167017]),ut.VERSIONS=[new ut(1,new Int32Array(0),new Ee(7,new W(1,19)),new Ee(10,new W(1,16)),new Ee(13,new W(1,13)),new Ee(17,new W(1,9))),new ut(2,Int32Array.from([6,18]),new Ee(10,new W(1,34)),new Ee(16,new W(1,28)),new Ee(22,new W(1,22)),new Ee(28,new W(1,16))),new ut(3,Int32Array.from([6,22]),new Ee(15,new W(1,55)),new Ee(26,new W(1,44)),new Ee(18,new W(2,17)),new Ee(22,new W(2,13))),new ut(4,Int32Array.from([6,26]),new Ee(20,new W(1,80)),new Ee(18,new W(2,32)),new Ee(26,new W(2,24)),new Ee(16,new W(4,9))),new ut(5,Int32Array.from([6,30]),new Ee(26,new W(1,108)),new Ee(24,new W(2,43)),new Ee(18,new W(2,15),new W(2,16)),new Ee(22,new W(2,11),new W(2,12))),new ut(6,Int32Array.from([6,34]),new Ee(18,new W(2,68)),new Ee(16,new W(4,27)),new Ee(24,new W(4,19)),new Ee(28,new W(4,15))),new ut(7,Int32Array.from([6,22,38]),new Ee(20,new W(2,78)),new Ee(18,new W(4,31)),new Ee(18,new W(2,14),new W(4,15)),new Ee(26,new W(4,13),new W(1,14))),new ut(8,Int32Array.from([6,24,42]),new Ee(24,new W(2,97)),new Ee(22,new W(2,38),new W(2,39)),new Ee(22,new W(4,18),new W(2,19)),new Ee(26,new W(4,14),new W(2,15))),new ut(9,Int32Array.from([6,26,46]),new Ee(30,new W(2,116)),new Ee(22,new W(3,36),new W(2,37)),new Ee(20,new W(4,16),new W(4,17)),new Ee(24,new W(4,12),new W(4,13))),new ut(10,Int32Array.from([6,28,50]),new Ee(18,new W(2,68),new W(2,69)),new Ee(26,new W(4,43),new W(1,44)),new Ee(24,new W(6,19),new W(2,20)),new Ee(28,new W(6,15),new W(2,16))),new ut(11,Int32Array.from([6,30,54]),new Ee(20,new W(4,81)),new Ee(30,new W(1,50),new W(4,51)),new Ee(28,new W(4,22),new W(4,23)),new Ee(24,new W(3,12),new W(8,13))),new ut(12,Int32Array.from([6,32,58]),new Ee(24,new W(2,92),new W(2,93)),new Ee(22,new W(6,36),new W(2,37)),new Ee(26,new W(4,20),new W(6,21)),new Ee(28,new W(7,14),new W(4,15))),new ut(13,Int32Array.from([6,34,62]),new Ee(26,new W(4,107)),new Ee(22,new W(8,37),new W(1,38)),new Ee(24,new W(8,20),new W(4,21)),new Ee(22,new W(12,11),new W(4,12))),new ut(14,Int32Array.from([6,26,46,66]),new Ee(30,new W(3,115),new W(1,116)),new Ee(24,new W(4,40),new W(5,41)),new Ee(20,new W(11,16),new W(5,17)),new Ee(24,new W(11,12),new W(5,13))),new ut(15,Int32Array.from([6,26,48,70]),new Ee(22,new W(5,87),new W(1,88)),new Ee(24,new W(5,41),new W(5,42)),new Ee(30,new W(5,24),new W(7,25)),new Ee(24,new W(11,12),new W(7,13))),new ut(16,Int32Array.from([6,26,50,74]),new Ee(24,new W(5,98),new W(1,99)),new Ee(28,new W(7,45),new W(3,46)),new Ee(24,new W(15,19),new W(2,20)),new Ee(30,new W(3,15),new W(13,16))),new ut(17,Int32Array.from([6,30,54,78]),new Ee(28,new W(1,107),new W(5,108)),new Ee(28,new W(10,46),new W(1,47)),new Ee(28,new W(1,22),new W(15,23)),new Ee(28,new W(2,14),new W(17,15))),new ut(18,Int32Array.from([6,30,56,82]),new Ee(30,new W(5,120),new W(1,121)),new Ee(26,new W(9,43),new W(4,44)),new Ee(28,new W(17,22),new W(1,23)),new Ee(28,new W(2,14),new W(19,15))),new ut(19,Int32Array.from([6,30,58,86]),new Ee(28,new W(3,113),new W(4,114)),new Ee(26,new W(3,44),new W(11,45)),new Ee(26,new W(17,21),new W(4,22)),new Ee(26,new W(9,13),new W(16,14))),new ut(20,Int32Array.from([6,34,62,90]),new Ee(28,new W(3,107),new W(5,108)),new Ee(26,new W(3,41),new W(13,42)),new Ee(30,new W(15,24),new W(5,25)),new Ee(28,new W(15,15),new W(10,16))),new ut(21,Int32Array.from([6,28,50,72,94]),new Ee(28,new W(4,116),new W(4,117)),new Ee(26,new W(17,42)),new Ee(28,new W(17,22),new W(6,23)),new Ee(30,new W(19,16),new W(6,17))),new ut(22,Int32Array.from([6,26,50,74,98]),new Ee(28,new W(2,111),new W(7,112)),new Ee(28,new W(17,46)),new Ee(30,new W(7,24),new W(16,25)),new Ee(24,new W(34,13))),new ut(23,Int32Array.from([6,30,54,78,102]),new Ee(30,new W(4,121),new W(5,122)),new Ee(28,new W(4,47),new W(14,48)),new Ee(30,new W(11,24),new W(14,25)),new Ee(30,new W(16,15),new W(14,16))),new ut(24,Int32Array.from([6,28,54,80,106]),new Ee(30,new W(6,117),new W(4,118)),new Ee(28,new W(6,45),new W(14,46)),new Ee(30,new W(11,24),new W(16,25)),new Ee(30,new W(30,16),new W(2,17))),new ut(25,Int32Array.from([6,32,58,84,110]),new Ee(26,new W(8,106),new W(4,107)),new Ee(28,new W(8,47),new W(13,48)),new Ee(30,new W(7,24),new W(22,25)),new Ee(30,new W(22,15),new W(13,16))),new ut(26,Int32Array.from([6,30,58,86,114]),new Ee(28,new W(10,114),new W(2,115)),new Ee(28,new W(19,46),new W(4,47)),new Ee(28,new W(28,22),new W(6,23)),new Ee(30,new W(33,16),new W(4,17))),new ut(27,Int32Array.from([6,34,62,90,118]),new Ee(30,new W(8,122),new W(4,123)),new Ee(28,new W(22,45),new W(3,46)),new Ee(30,new W(8,23),new W(26,24)),new Ee(30,new W(12,15),new W(28,16))),new ut(28,Int32Array.from([6,26,50,74,98,122]),new Ee(30,new W(3,117),new W(10,118)),new Ee(28,new W(3,45),new W(23,46)),new Ee(30,new W(4,24),new W(31,25)),new Ee(30,new W(11,15),new W(31,16))),new ut(29,Int32Array.from([6,30,54,78,102,126]),new Ee(30,new W(7,116),new W(7,117)),new Ee(28,new W(21,45),new W(7,46)),new Ee(30,new W(1,23),new W(37,24)),new Ee(30,new W(19,15),new W(26,16))),new ut(30,Int32Array.from([6,26,52,78,104,130]),new Ee(30,new W(5,115),new W(10,116)),new Ee(28,new W(19,47),new W(10,48)),new Ee(30,new W(15,24),new W(25,25)),new Ee(30,new W(23,15),new W(25,16))),new ut(31,Int32Array.from([6,30,56,82,108,134]),new Ee(30,new W(13,115),new W(3,116)),new Ee(28,new W(2,46),new W(29,47)),new Ee(30,new W(42,24),new W(1,25)),new Ee(30,new W(23,15),new W(28,16))),new ut(32,Int32Array.from([6,34,60,86,112,138]),new Ee(30,new W(17,115)),new Ee(28,new W(10,46),new W(23,47)),new Ee(30,new W(10,24),new W(35,25)),new Ee(30,new W(19,15),new W(35,16))),new ut(33,Int32Array.from([6,30,58,86,114,142]),new Ee(30,new W(17,115),new W(1,116)),new Ee(28,new W(14,46),new W(21,47)),new Ee(30,new W(29,24),new W(19,25)),new Ee(30,new W(11,15),new W(46,16))),new ut(34,Int32Array.from([6,34,62,90,118,146]),new Ee(30,new W(13,115),new W(6,116)),new Ee(28,new W(14,46),new W(23,47)),new Ee(30,new W(44,24),new W(7,25)),new Ee(30,new W(59,16),new W(1,17))),new ut(35,Int32Array.from([6,30,54,78,102,126,150]),new Ee(30,new W(12,121),new W(7,122)),new Ee(28,new W(12,47),new W(26,48)),new Ee(30,new W(39,24),new W(14,25)),new Ee(30,new W(22,15),new W(41,16))),new ut(36,Int32Array.from([6,24,50,76,102,128,154]),new Ee(30,new W(6,121),new W(14,122)),new Ee(28,new W(6,47),new W(34,48)),new Ee(30,new W(46,24),new W(10,25)),new Ee(30,new W(2,15),new W(64,16))),new ut(37,Int32Array.from([6,28,54,80,106,132,158]),new Ee(30,new W(17,122),new W(4,123)),new Ee(28,new W(29,46),new W(14,47)),new Ee(30,new W(49,24),new W(10,25)),new Ee(30,new W(24,15),new W(46,16))),new ut(38,Int32Array.from([6,32,58,84,110,136,162]),new Ee(30,new W(4,122),new W(18,123)),new Ee(28,new W(13,46),new W(32,47)),new Ee(30,new W(48,24),new W(14,25)),new Ee(30,new W(42,15),new W(32,16))),new ut(39,Int32Array.from([6,26,54,82,110,138,166]),new Ee(30,new W(20,117),new W(4,118)),new Ee(28,new W(40,47),new W(7,48)),new Ee(30,new W(43,24),new W(22,25)),new Ee(30,new W(10,15),new W(67,16))),new ut(40,Int32Array.from([6,30,58,86,114,142,170]),new Ee(30,new W(19,118),new W(6,119)),new Ee(28,new W(18,47),new W(31,48)),new Ee(30,new W(34,24),new W(34,25)),new Ee(30,new W(20,15),new W(61,16)))];var cs;(function(M){M[M.DATA_MASK_000=0]="DATA_MASK_000",M[M.DATA_MASK_001=1]="DATA_MASK_001",M[M.DATA_MASK_010=2]="DATA_MASK_010",M[M.DATA_MASK_011=3]="DATA_MASK_011",M[M.DATA_MASK_100=4]="DATA_MASK_100",M[M.DATA_MASK_101=5]="DATA_MASK_101",M[M.DATA_MASK_110=6]="DATA_MASK_110",M[M.DATA_MASK_111=7]="DATA_MASK_111"})(cs||(cs={}));class ws{constructor(s,o){this.value=s,this.isMasked=o}unmaskBitMatrix(s,o){for(let l=0;l<o;l++)for(let d=0;d<o;d++)this.isMasked(l,d)&&s.flip(d,l)}}ws.values=new Map([[cs.DATA_MASK_000,new ws(cs.DATA_MASK_000,(M,s)=>(M+s&1)===0)],[cs.DATA_MASK_001,new ws(cs.DATA_MASK_001,(M,s)=>(M&1)===0)],[cs.DATA_MASK_010,new ws(cs.DATA_MASK_010,(M,s)=>s%3===0)],[cs.DATA_MASK_011,new ws(cs.DATA_MASK_011,(M,s)=>(M+s)%3===0)],[cs.DATA_MASK_100,new ws(cs.DATA_MASK_100,(M,s)=>(Math.floor(M/2)+Math.floor(s/3)&1)===0)],[cs.DATA_MASK_101,new ws(cs.DATA_MASK_101,(M,s)=>M*s%6===0)],[cs.DATA_MASK_110,new ws(cs.DATA_MASK_110,(M,s)=>M*s%6<3)],[cs.DATA_MASK_111,new ws(cs.DATA_MASK_111,(M,s)=>(M+s+M*s%3&1)===0)]]);class li{constructor(s){const o=s.getHeight();if(o<21||(o&3)!==1)throw new P;this.bitMatrix=s}readFormatInformation(){if(this.parsedFormatInfo!==null&&this.parsedFormatInfo!==void 0)return this.parsedFormatInfo;let s=0;for(let m=0;m<6;m++)s=this.copyBit(m,8,s);s=this.copyBit(7,8,s),s=this.copyBit(8,8,s),s=this.copyBit(8,7,s);for(let m=5;m>=0;m--)s=this.copyBit(8,m,s);const o=this.bitMatrix.getHeight();let l=0;const d=o-7;for(let m=o-1;m>=d;m--)l=this.copyBit(8,m,l);for(let m=o-8;m<o;m++)l=this.copyBit(m,8,l);if(this.parsedFormatInfo=ls.decodeFormatInformation(s,l),this.parsedFormatInfo!==null)return this.parsedFormatInfo;throw new P}readVersion(){if(this.parsedVersion!==null&&this.parsedVersion!==void 0)return this.parsedVersion;const s=this.bitMatrix.getHeight(),o=Math.floor((s-17)/4);if(o<=6)return ut.getVersionForNumber(o);let l=0;const d=s-11;for(let p=5;p>=0;p--)for(let v=s-9;v>=d;v--)l=this.copyBit(v,p,l);let m=ut.decodeVersionInformation(l);if(m!==null&&m.getDimensionForVersion()===s)return this.parsedVersion=m,m;l=0;for(let p=5;p>=0;p--)for(let v=s-9;v>=d;v--)l=this.copyBit(p,v,l);if(m=ut.decodeVersionInformation(l),m!==null&&m.getDimensionForVersion()===s)return this.parsedVersion=m,m;throw new P}copyBit(s,o,l){return(this.isMirror?this.bitMatrix.get(o,s):this.bitMatrix.get(s,o))?l<<1|1:l<<1}readCodewords(){const s=this.readFormatInformation(),o=this.readVersion(),l=ws.values.get(s.getDataMask()),d=this.bitMatrix.getHeight();l.unmaskBitMatrix(this.bitMatrix,d);const m=o.buildFunctionPattern();let p=!0;const v=new Uint8Array(o.getTotalCodewords());let b=0,T=0,R=0;for(let O=d-1;O>0;O-=2){O===6&&O--;for(let V=0;V<d;V++){const K=p?d-1-V:V;for(let le=0;le<2;le++)m.get(O-le,K)||(R++,T<<=1,this.bitMatrix.get(O-le,K)&&(T|=1),R===8&&(v[b++]=T,R=0,T=0))}p=!p}if(b!==o.getTotalCodewords())throw new P;return v}remask(){if(this.parsedFormatInfo===null)return;const s=ws.values[this.parsedFormatInfo.getDataMask()],o=this.bitMatrix.getHeight();s.unmaskBitMatrix(this.bitMatrix,o)}setMirror(s){this.parsedVersion=null,this.parsedFormatInfo=null,this.isMirror=s}mirror(){const s=this.bitMatrix;for(let o=0,l=s.getWidth();o<l;o++)for(let d=o+1,m=s.getHeight();d<m;d++)s.get(o,d)!==s.get(d,o)&&(s.flip(d,o),s.flip(o,d))}}class qa{constructor(s,o){this.numDataCodewords=s,this.codewords=o}static getDataBlocks(s,o,l){if(s.length!==o.getTotalCodewords())throw new I;const d=o.getECBlocksForLevel(l);let m=0;const p=d.getECBlocks();for(const le of p)m+=le.getCount();const v=new Array(m);let b=0;for(const le of p)for(let he=0;he<le.getCount();he++){const we=le.getDataCodewords(),De=d.getECCodewordsPerBlock()+we;v[b++]=new qa(we,new Uint8Array(De))}const T=v[0].codewords.length;let R=v.length-1;for(;R>=0&&v[R].codewords.length!==T;)R--;R++;const O=T-d.getECCodewordsPerBlock();let V=0;for(let le=0;le<O;le++)for(let he=0;he<b;he++)v[he].codewords[le]=s[V++];for(let le=R;le<b;le++)v[le].codewords[O]=s[V++];const K=v[0].codewords.length;for(let le=O;le<K;le++)for(let he=0;he<b;he++){const we=he<R?le:le+1;v[he].codewords[we]=s[V++]}return v}getNumDataCodewords(){return this.numDataCodewords}getCodewords(){return this.codewords}}var Gs;(function(M){M[M.TERMINATOR=0]="TERMINATOR",M[M.NUMERIC=1]="NUMERIC",M[M.ALPHANUMERIC=2]="ALPHANUMERIC",M[M.STRUCTURED_APPEND=3]="STRUCTURED_APPEND",M[M.BYTE=4]="BYTE",M[M.ECI=5]="ECI",M[M.KANJI=6]="KANJI",M[M.FNC1_FIRST_POSITION=7]="FNC1_FIRST_POSITION",M[M.FNC1_SECOND_POSITION=8]="FNC1_SECOND_POSITION",M[M.HANZI=9]="HANZI"})(Gs||(Gs={}));class xt{constructor(s,o,l,d){this.value=s,this.stringValue=o,this.characterCountBitsForVersions=l,this.bits=d,xt.FOR_BITS.set(d,this),xt.FOR_VALUE.set(s,this)}static forBits(s){const o=xt.FOR_BITS.get(s);if(o===void 0)throw new I;return o}getCharacterCountBits(s){const o=s.getVersionNumber();let l;return o<=9?l=0:o<=26?l=1:l=2,this.characterCountBitsForVersions[l]}getValue(){return this.value}getBits(){return this.bits}equals(s){if(!(s instanceof xt))return!1;const o=s;return this.value===o.value}toString(){return this.stringValue}}xt.FOR_BITS=new Map,xt.FOR_VALUE=new Map,xt.TERMINATOR=new xt(Gs.TERMINATOR,"TERMINATOR",Int32Array.from([0,0,0]),0),xt.NUMERIC=new xt(Gs.NUMERIC,"NUMERIC",Int32Array.from([10,12,14]),1),xt.ALPHANUMERIC=new xt(Gs.ALPHANUMERIC,"ALPHANUMERIC",Int32Array.from([9,11,13]),2),xt.STRUCTURED_APPEND=new xt(Gs.STRUCTURED_APPEND,"STRUCTURED_APPEND",Int32Array.from([0,0,0]),3),xt.BYTE=new xt(Gs.BYTE,"BYTE",Int32Array.from([8,16,16]),4),xt.ECI=new xt(Gs.ECI,"ECI",Int32Array.from([0,0,0]),7),xt.KANJI=new xt(Gs.KANJI,"KANJI",Int32Array.from([8,10,12]),8),xt.FNC1_FIRST_POSITION=new xt(Gs.FNC1_FIRST_POSITION,"FNC1_FIRST_POSITION",Int32Array.from([0,0,0]),5),xt.FNC1_SECOND_POSITION=new xt(Gs.FNC1_SECOND_POSITION,"FNC1_SECOND_POSITION",Int32Array.from([0,0,0]),9),xt.HANZI=new xt(Gs.HANZI,"HANZI",Int32Array.from([8,10,12]),13);class In{static decode(s,o,l,d){const m=new es(s);let p=new z;const v=new Array;let b=-1,T=-1;try{let R=null,O=!1,V;do{if(m.available()<4)V=xt.TERMINATOR;else{const K=m.readBits(4);V=xt.forBits(K)}switch(V){case xt.TERMINATOR:break;case xt.FNC1_FIRST_POSITION:case xt.FNC1_SECOND_POSITION:O=!0;break;case xt.STRUCTURED_APPEND:if(m.available()<16)throw new P;b=m.readBits(8),T=m.readBits(8);break;case xt.ECI:const K=In.parseECIValue(m);if(R=B.getCharacterSetECIByValue(K),R===null)throw new P;break;case xt.HANZI:const le=m.readBits(4),he=m.readBits(V.getCharacterCountBits(o));le===In.GB2312_SUBSET&&In.decodeHanziSegment(m,p,he);break;default:const we=m.readBits(V.getCharacterCountBits(o));switch(V){case xt.NUMERIC:In.decodeNumericSegment(m,p,we);break;case xt.ALPHANUMERIC:In.decodeAlphanumericSegment(m,p,we,O);break;case xt.BYTE:In.decodeByteSegment(m,p,we,R,v,d);break;case xt.KANJI:In.decodeKanjiSegment(m,p,we);break;default:throw new P}break}}while(V!==xt.TERMINATOR)}catch{throw new P}return new it(s,p.toString(),v.length===0?null:v,l===null?null:l.toString(),b,T)}static decodeHanziSegment(s,o,l){if(l*13>s.available())throw new P;const d=new Uint8Array(2*l);let m=0;for(;l>0;){const p=s.readBits(13);let v=p/96<<8&4294967295|p%96;v<959?v+=41377:v+=42657,d[m]=v>>8&255,d[m+1]=v&255,m+=2,l--}try{o.append(Z.decode(d,Q.GB2312))}catch(p){throw new P(p)}}static decodeKanjiSegment(s,o,l){if(l*13>s.available())throw new P;const d=new Uint8Array(2*l);let m=0;for(;l>0;){const p=s.readBits(13);let v=p/192<<8&4294967295|p%192;v<7936?v+=33088:v+=49472,d[m]=v>>8,d[m+1]=v,m+=2,l--}try{o.append(Z.decode(d,Q.SHIFT_JIS))}catch(p){throw new P(p)}}static decodeByteSegment(s,o,l,d,m,p){if(8*l>s.available())throw new P;const v=new Uint8Array(l);for(let T=0;T<l;T++)v[T]=s.readBits(8);let b;d===null?b=Q.guessEncoding(v,p):b=d.getName();try{o.append(Z.decode(v,b))}catch(T){throw new P(T)}m.push(v)}static toAlphaNumericChar(s){if(s>=In.ALPHANUMERIC_CHARS.length)throw new P;return In.ALPHANUMERIC_CHARS[s]}static decodeAlphanumericSegment(s,o,l,d){const m=o.length();for(;l>1;){if(s.available()<11)throw new P;const p=s.readBits(11);o.append(In.toAlphaNumericChar(Math.floor(p/45))),o.append(In.toAlphaNumericChar(p%45)),l-=2}if(l===1){if(s.available()<6)throw new P;o.append(In.toAlphaNumericChar(s.readBits(6)))}if(d)for(let p=m;p<o.length();p++)o.charAt(p)==="%"&&(p<o.length()-1&&o.charAt(p+1)==="%"?o.deleteCharAt(p+1):o.setCharAt(p,""))}static decodeNumericSegment(s,o,l){for(;l>=3;){if(s.available()<10)throw new P;const d=s.readBits(10);if(d>=1e3)throw new P;o.append(In.toAlphaNumericChar(Math.floor(d/100))),o.append(In.toAlphaNumericChar(Math.floor(d/10)%10)),o.append(In.toAlphaNumericChar(d%10)),l-=3}if(l===2){if(s.available()<7)throw new P;const d=s.readBits(7);if(d>=100)throw new P;o.append(In.toAlphaNumericChar(Math.floor(d/10))),o.append(In.toAlphaNumericChar(d%10))}else if(l===1){if(s.available()<4)throw new P;const d=s.readBits(4);if(d>=10)throw new P;o.append(In.toAlphaNumericChar(d))}}static parseECIValue(s){const o=s.readBits(8);if((o&128)===0)return o&127;if((o&192)===128){const l=s.readBits(8);return(o&63)<<8&4294967295|l}if((o&224)===192){const l=s.readBits(16);return(o&31)<<16&4294967295|l}throw new P}}In.ALPHANUMERIC_CHARS="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:",In.GB2312_SUBSET=1;class qo{constructor(s){this.mirrored=s}isMirrored(){return this.mirrored}applyMirroredCorrection(s){if(!this.mirrored||s===null||s.length<3)return;const o=s[0];s[0]=s[2],s[2]=o}}class Br{constructor(){this.rsDecoder=new Pt(wt.QR_CODE_FIELD_256)}decodeBooleanArray(s,o){return this.decodeBitMatrix(Ye.parseFromBooleanArray(s),o)}decodeBitMatrix(s,o){const l=new li(s);let d=null;try{return this.decodeBitMatrixParser(l,o)}catch(m){d=m}try{l.remask(),l.setMirror(!0),l.readVersion(),l.readFormatInformation(),l.mirror();const m=this.decodeBitMatrixParser(l,o);return m.setOther(new qo(!0)),m}catch(m){throw d!==null?d:m}}decodeBitMatrixParser(s,o){const l=s.readVersion(),d=s.readFormatInformation().getErrorCorrectionLevel(),m=s.readCodewords(),p=qa.getDataBlocks(m,l,d);let v=0;for(const R of p)v+=R.getNumDataCodewords();const b=new Uint8Array(v);let T=0;for(const R of p){const O=R.getCodewords(),V=R.getNumDataCodewords();this.correctErrors(O,V);for(let K=0;K<V;K++)b[T++]=O[K]}return In.decode(b,l,d,o)}correctErrors(s,o){const l=new Int32Array(s);try{this.rsDecoder.decode(l,s.length-o)}catch{throw new Y}for(let d=0;d<o;d++)s[d]=l[d]}}class Vr extends de{constructor(s,o,l){super(s,o),this.estimatedModuleSize=l}aboutEquals(s,o,l){if(Math.abs(o-this.getY())<=s&&Math.abs(l-this.getX())<=s){const d=Math.abs(s-this.estimatedModuleSize);return d<=1||d<=this.estimatedModuleSize}return!1}combineEstimate(s,o,l){const d=(this.getX()+o)/2,m=(this.getY()+s)/2,p=(this.estimatedModuleSize+l)/2;return new Vr(d,m,p)}}class ci{constructor(s,o,l,d,m,p,v){this.image=s,this.startX=o,this.startY=l,this.width=d,this.height=m,this.moduleSize=p,this.resultPointCallback=v,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(3)}find(){const s=this.startX,o=this.height,l=this.width,d=s+l,m=this.startY+o/2,p=new Int32Array(3),v=this.image;for(let b=0;b<o;b++){const T=m+((b&1)===0?Math.floor((b+1)/2):-Math.floor((b+1)/2));p[0]=0,p[1]=0,p[2]=0;let R=s;for(;R<d&&!v.get(R,T);)R++;let O=0;for(;R<d;){if(v.get(R,T))if(O===1)p[1]++;else if(O===2){if(this.foundPatternCross(p)){const V=this.handlePossibleCenter(p,T,R);if(V!==null)return V}p[0]=p[2],p[1]=1,p[2]=0,O=1}else p[++O]++;else O===1&&O++,p[O]++;R++}if(this.foundPatternCross(p)){const V=this.handlePossibleCenter(p,T,d);if(V!==null)return V}}if(this.possibleCenters.length!==0)return this.possibleCenters[0];throw new me}static centerFromEnd(s,o){return o-s[2]-s[1]/2}foundPatternCross(s){const o=this.moduleSize,l=o/2;for(let d=0;d<3;d++)if(Math.abs(o-s[d])>=l)return!1;return!0}crossCheckVertical(s,o,l,d){const m=this.image,p=m.getHeight(),v=this.crossCheckStateCount;v[0]=0,v[1]=0,v[2]=0;let b=s;for(;b>=0&&m.get(o,b)&&v[1]<=l;)v[1]++,b--;if(b<0||v[1]>l)return NaN;for(;b>=0&&!m.get(o,b)&&v[0]<=l;)v[0]++,b--;if(v[0]>l)return NaN;for(b=s+1;b<p&&m.get(o,b)&&v[1]<=l;)v[1]++,b++;if(b===p||v[1]>l)return NaN;for(;b<p&&!m.get(o,b)&&v[2]<=l;)v[2]++,b++;if(v[2]>l)return NaN;const T=v[0]+v[1]+v[2];return 5*Math.abs(T-d)>=2*d?NaN:this.foundPatternCross(v)?ci.centerFromEnd(v,b):NaN}handlePossibleCenter(s,o,l){const d=s[0]+s[1]+s[2],m=ci.centerFromEnd(s,l),p=this.crossCheckVertical(o,m,2*s[1],d);if(!isNaN(p)){const v=(s[0]+s[1]+s[2])/3;for(const T of this.possibleCenters)if(T.aboutEquals(v,p,m))return T.combineEstimate(p,m,v);const b=new Vr(m,p,v);this.possibleCenters.push(b),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(b)}return null}}class ta extends de{constructor(s,o,l,d){super(s,o),this.estimatedModuleSize=l,this.count=d,d===void 0&&(this.count=1)}getEstimatedModuleSize(){return this.estimatedModuleSize}getCount(){return this.count}aboutEquals(s,o,l){if(Math.abs(o-this.getY())<=s&&Math.abs(l-this.getX())<=s){const d=Math.abs(s-this.estimatedModuleSize);return d<=1||d<=this.estimatedModuleSize}return!1}combineEstimate(s,o,l){const d=this.count+1,m=(this.count*this.getX()+o)/d,p=(this.count*this.getY()+s)/d,v=(this.count*this.estimatedModuleSize+l)/d;return new ta(m,p,v,d)}}class Ni{constructor(s){this.bottomLeft=s[0],this.topLeft=s[1],this.topRight=s[2]}getBottomLeft(){return this.bottomLeft}getTopLeft(){return this.topLeft}getTopRight(){return this.topRight}}class Fn{constructor(s,o){this.image=s,this.resultPointCallback=o,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(5),this.resultPointCallback=o}getImage(){return this.image}getPossibleCenters(){return this.possibleCenters}find(s){const o=s!=null&&s.get(Ce.TRY_HARDER)!==void 0,l=s!=null&&s.get(Ce.PURE_BARCODE)!==void 0,d=this.image,m=d.getHeight(),p=d.getWidth();let v=Math.floor(3*m/(4*Fn.MAX_MODULES));(v<Fn.MIN_SKIP||o)&&(v=Fn.MIN_SKIP);let b=!1;const T=new Int32Array(5);for(let O=v-1;O<m&&!b;O+=v){T[0]=0,T[1]=0,T[2]=0,T[3]=0,T[4]=0;let V=0;for(let K=0;K<p;K++)if(d.get(K,O))(V&1)===1&&V++,T[V]++;else if((V&1)===0)if(V===4)if(Fn.foundPatternCross(T)){if(this.handlePossibleCenter(T,O,K,l)===!0)if(v=2,this.hasSkipped===!0)b=this.haveMultiplyConfirmedCenters();else{const he=this.findRowSkip();he>T[2]&&(O+=he-T[2]-v,K=p-1)}else{T[0]=T[2],T[1]=T[3],T[2]=T[4],T[3]=1,T[4]=0,V=3;continue}V=0,T[0]=0,T[1]=0,T[2]=0,T[3]=0,T[4]=0}else T[0]=T[2],T[1]=T[3],T[2]=T[4],T[3]=1,T[4]=0,V=3;else T[++V]++;else T[V]++;Fn.foundPatternCross(T)&&this.handlePossibleCenter(T,O,p,l)===!0&&(v=T[0],this.hasSkipped&&(b=this.haveMultiplyConfirmedCenters()))}const R=this.selectBestPatterns();return de.orderBestPatterns(R),new Ni(R)}static centerFromEnd(s,o){return o-s[4]-s[3]-s[2]/2}static foundPatternCross(s){let o=0;for(let m=0;m<5;m++){const p=s[m];if(p===0)return!1;o+=p}if(o<7)return!1;const l=o/7,d=l/2;return Math.abs(l-s[0])<d&&Math.abs(l-s[1])<d&&Math.abs(3*l-s[2])<3*d&&Math.abs(l-s[3])<d&&Math.abs(l-s[4])<d}getCrossCheckStateCount(){const s=this.crossCheckStateCount;return s[0]=0,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s}crossCheckDiagonal(s,o,l,d){const m=this.getCrossCheckStateCount();let p=0;const v=this.image;for(;s>=p&&o>=p&&v.get(o-p,s-p);)m[2]++,p++;if(s<p||o<p)return!1;for(;s>=p&&o>=p&&!v.get(o-p,s-p)&&m[1]<=l;)m[1]++,p++;if(s<p||o<p||m[1]>l)return!1;for(;s>=p&&o>=p&&v.get(o-p,s-p)&&m[0]<=l;)m[0]++,p++;if(m[0]>l)return!1;const b=v.getHeight(),T=v.getWidth();for(p=1;s+p<b&&o+p<T&&v.get(o+p,s+p);)m[2]++,p++;if(s+p>=b||o+p>=T)return!1;for(;s+p<b&&o+p<T&&!v.get(o+p,s+p)&&m[3]<l;)m[3]++,p++;if(s+p>=b||o+p>=T||m[3]>=l)return!1;for(;s+p<b&&o+p<T&&v.get(o+p,s+p)&&m[4]<l;)m[4]++,p++;if(m[4]>=l)return!1;const R=m[0]+m[1]+m[2]+m[3]+m[4];return Math.abs(R-d)<2*d&&Fn.foundPatternCross(m)}crossCheckVertical(s,o,l,d){const m=this.image,p=m.getHeight(),v=this.getCrossCheckStateCount();let b=s;for(;b>=0&&m.get(o,b);)v[2]++,b--;if(b<0)return NaN;for(;b>=0&&!m.get(o,b)&&v[1]<=l;)v[1]++,b--;if(b<0||v[1]>l)return NaN;for(;b>=0&&m.get(o,b)&&v[0]<=l;)v[0]++,b--;if(v[0]>l)return NaN;for(b=s+1;b<p&&m.get(o,b);)v[2]++,b++;if(b===p)return NaN;for(;b<p&&!m.get(o,b)&&v[3]<l;)v[3]++,b++;if(b===p||v[3]>=l)return NaN;for(;b<p&&m.get(o,b)&&v[4]<l;)v[4]++,b++;if(v[4]>=l)return NaN;const T=v[0]+v[1]+v[2]+v[3]+v[4];return 5*Math.abs(T-d)>=2*d?NaN:Fn.foundPatternCross(v)?Fn.centerFromEnd(v,b):NaN}crossCheckHorizontal(s,o,l,d){const m=this.image,p=m.getWidth(),v=this.getCrossCheckStateCount();let b=s;for(;b>=0&&m.get(b,o);)v[2]++,b--;if(b<0)return NaN;for(;b>=0&&!m.get(b,o)&&v[1]<=l;)v[1]++,b--;if(b<0||v[1]>l)return NaN;for(;b>=0&&m.get(b,o)&&v[0]<=l;)v[0]++,b--;if(v[0]>l)return NaN;for(b=s+1;b<p&&m.get(b,o);)v[2]++,b++;if(b===p)return NaN;for(;b<p&&!m.get(b,o)&&v[3]<l;)v[3]++,b++;if(b===p||v[3]>=l)return NaN;for(;b<p&&m.get(b,o)&&v[4]<l;)v[4]++,b++;if(v[4]>=l)return NaN;const T=v[0]+v[1]+v[2]+v[3]+v[4];return 5*Math.abs(T-d)>=d?NaN:Fn.foundPatternCross(v)?Fn.centerFromEnd(v,b):NaN}handlePossibleCenter(s,o,l,d){const m=s[0]+s[1]+s[2]+s[3]+s[4];let p=Fn.centerFromEnd(s,l),v=this.crossCheckVertical(o,Math.floor(p),s[2],m);if(!isNaN(v)&&(p=this.crossCheckHorizontal(Math.floor(p),Math.floor(v),s[2],m),!isNaN(p)&&(!d||this.crossCheckDiagonal(Math.floor(v),Math.floor(p),s[2],m)))){const b=m/7;let T=!1;const R=this.possibleCenters;for(let O=0,V=R.length;O<V;O++){const K=R[O];if(K.aboutEquals(b,v,p)){R[O]=K.combineEstimate(v,p,b),T=!0;break}}if(!T){const O=new ta(p,v,b);R.push(O),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(O)}return!0}return!1}findRowSkip(){if(this.possibleCenters.length<=1)return 0;let o=null;for(const l of this.possibleCenters)if(l.getCount()>=Fn.CENTER_QUORUM)if(o==null)o=l;else return this.hasSkipped=!0,Math.floor((Math.abs(o.getX()-l.getX())-Math.abs(o.getY()-l.getY()))/2);return 0}haveMultiplyConfirmedCenters(){let s=0,o=0;const l=this.possibleCenters.length;for(const p of this.possibleCenters)p.getCount()>=Fn.CENTER_QUORUM&&(s++,o+=p.getEstimatedModuleSize());if(s<3)return!1;const d=o/l;let m=0;for(const p of this.possibleCenters)m+=Math.abs(p.getEstimatedModuleSize()-d);return m<=.05*o}selectBestPatterns(){const s=this.possibleCenters.length;if(s<3)throw new me;const o=this.possibleCenters;let l;if(s>3){let d=0,m=0;for(const b of this.possibleCenters){const T=b.getEstimatedModuleSize();d+=T,m+=T*T}l=d/s;let p=Math.sqrt(m/s-l*l);o.sort((b,T)=>{const R=Math.abs(T.getEstimatedModuleSize()-l),O=Math.abs(b.getEstimatedModuleSize()-l);return R<O?-1:R>O?1:0});const v=Math.max(.2*l,p);for(let b=0;b<o.length&&o.length>3;b++){const T=o[b];Math.abs(T.getEstimatedModuleSize()-l)>v&&(o.splice(b,1),b--)}}if(o.length>3){let d=0;for(const m of o)d+=m.getEstimatedModuleSize();l=d/o.length,o.sort((m,p)=>{if(p.getCount()===m.getCount()){const v=Math.abs(p.getEstimatedModuleSize()-l),b=Math.abs(m.getEstimatedModuleSize()-l);return v<b?1:v>b?-1:0}else return p.getCount()-m.getCount()}),o.splice(3)}return[o[0],o[1],o[2]]}}Fn.CENTER_QUORUM=2,Fn.MIN_SKIP=3,Fn.MAX_MODULES=57;class ui{constructor(s){this.image=s}getImage(){return this.image}getResultPointCallback(){return this.resultPointCallback}detect(s){this.resultPointCallback=s==null?null:s.get(Ce.NEED_RESULT_POINT_CALLBACK);const l=new Fn(this.image,this.resultPointCallback).find(s);return this.processFinderPatternInfo(l)}processFinderPatternInfo(s){const o=s.getTopLeft(),l=s.getTopRight(),d=s.getBottomLeft(),m=this.calculateModuleSize(o,l,d);if(m<1)throw new me("No pattern found in proccess finder.");const p=ui.computeDimension(o,l,d,m),v=ut.getProvisionalVersionForDimension(p),b=v.getDimensionForVersion()-7;let T=null;if(v.getAlignmentPatternCenters().length>0){const K=l.getX()-o.getX()+d.getX(),le=l.getY()-o.getY()+d.getY(),he=1-3/b,we=Math.floor(o.getX()+he*(K-o.getX())),De=Math.floor(o.getY()+he*(le-o.getY()));for(let $e=4;$e<=16;$e<<=1)try{T=this.findAlignmentInRegion(m,we,De,$e);break}catch(Qe){if(!(Qe instanceof me))throw Qe}}const R=ui.createTransform(o,l,d,T,p),O=ui.sampleGrid(this.image,R,p);let V;return T===null?V=[d,o,l]:V=[d,o,l,T],new et(O,V)}static createTransform(s,o,l,d,m){const p=m-3.5;let v,b,T,R;return d!==null?(v=d.getX(),b=d.getY(),T=p-3,R=T):(v=o.getX()-s.getX()+l.getX(),b=o.getY()-s.getY()+l.getY(),T=p,R=p),jn.quadrilateralToQuadrilateral(3.5,3.5,p,3.5,T,R,3.5,p,s.getX(),s.getY(),o.getX(),o.getY(),v,b,l.getX(),l.getY())}static sampleGrid(s,o,l){return Vn.getInstance().sampleGridWithTransform(s,l,l,o)}static computeDimension(s,o,l,d){const m=at.round(de.distance(s,o)/d),p=at.round(de.distance(s,l)/d);let v=Math.floor((m+p)/2)+7;switch(v&3){case 0:v++;break;case 2:v--;break;case 3:throw new me("Dimensions could be not found.")}return v}calculateModuleSize(s,o,l){return(this.calculateModuleSizeOneWay(s,o)+this.calculateModuleSizeOneWay(s,l))/2}calculateModuleSizeOneWay(s,o){const l=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(s.getX()),Math.floor(s.getY()),Math.floor(o.getX()),Math.floor(o.getY())),d=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(o.getX()),Math.floor(o.getY()),Math.floor(s.getX()),Math.floor(s.getY()));return isNaN(l)?d/7:isNaN(d)?l/7:(l+d)/14}sizeOfBlackWhiteBlackRunBothWays(s,o,l,d){let m=this.sizeOfBlackWhiteBlackRun(s,o,l,d),p=1,v=s-(l-s);v<0?(p=s/(s-v),v=0):v>=this.image.getWidth()&&(p=(this.image.getWidth()-1-s)/(v-s),v=this.image.getWidth()-1);let b=Math.floor(o-(d-o)*p);return p=1,b<0?(p=o/(o-b),b=0):b>=this.image.getHeight()&&(p=(this.image.getHeight()-1-o)/(b-o),b=this.image.getHeight()-1),v=Math.floor(s+(v-s)*p),m+=this.sizeOfBlackWhiteBlackRun(s,o,v,b),m-1}sizeOfBlackWhiteBlackRun(s,o,l,d){const m=Math.abs(d-o)>Math.abs(l-s);if(m){let K=s;s=o,o=K,K=l,l=d,d=K}const p=Math.abs(l-s),v=Math.abs(d-o);let b=-p/2;const T=s<l?1:-1,R=o<d?1:-1;let O=0;const V=l+T;for(let K=s,le=o;K!==V;K+=T){const he=m?le:K,we=m?K:le;if(O===1===this.image.get(he,we)){if(O===2)return at.distance(K,le,s,o);O++}if(b+=v,b>0){if(le===d)break;le+=R,b-=p}}return O===2?at.distance(l+T,d,s,o):NaN}findAlignmentInRegion(s,o,l,d){const m=Math.floor(d*s),p=Math.max(0,o-m),v=Math.min(this.image.getWidth()-1,o+m);if(v-p<s*3)throw new me("Alignment top exceeds estimated module size.");const b=Math.max(0,l-m),T=Math.min(this.image.getHeight()-1,l+m);if(T-b<s*3)throw new me("Alignment bottom exceeds estimated module size.");return new ci(this.image,p,b,v-p,T-b,s,this.resultPointCallback).find()}}class hi{constructor(){this.decoder=new Br}getDecoder(){return this.decoder}decode(s,o){let l,d;if(o!=null&&o.get(Ce.PURE_BARCODE)!==void 0){const b=hi.extractPureBits(s.getBlackMatrix());l=this.decoder.decodeBitMatrix(b,o),d=hi.NO_POINTS}else{const b=new ui(s.getBlackMatrix()).detect(o);l=this.decoder.decodeBitMatrix(b.getBits(),o),d=b.getPoints()}l.getOther()instanceof qo&&l.getOther().applyMirroredCorrection(d);const m=new pe(l.getText(),l.getRawBytes(),void 0,d,ie.QR_CODE,void 0),p=l.getByteSegments();p!==null&&m.putMetadata(Pe.BYTE_SEGMENTS,p);const v=l.getECLevel();return v!==null&&m.putMetadata(Pe.ERROR_CORRECTION_LEVEL,v),l.hasStructuredAppend()&&(m.putMetadata(Pe.STRUCTURED_APPEND_SEQUENCE,l.getStructuredAppendSequenceNumber()),m.putMetadata(Pe.STRUCTURED_APPEND_PARITY,l.getStructuredAppendParity())),m}reset(){}static extractPureBits(s){const o=s.getTopLeftOnBit(),l=s.getBottomRightOnBit();if(o===null||l===null)throw new me;const d=this.moduleSize(o,s);let m=o[1],p=l[1],v=o[0],b=l[0];if(v>=b||m>=p)throw new me;if(p-m!==b-v&&(b=v+(p-m),b>=s.getWidth()))throw new me;const T=Math.round((b-v+1)/d),R=Math.round((p-m+1)/d);if(T<=0||R<=0)throw new me;if(R!==T)throw new me;const O=Math.floor(d/2);m+=O,v+=O;const V=v+Math.floor((T-1)*d)-b;if(V>0){if(V>O)throw new me;v-=V}const K=m+Math.floor((R-1)*d)-p;if(K>0){if(K>O)throw new me;m-=K}const le=new Ye(T,R);for(let he=0;he<R;he++){const we=m+Math.floor(he*d);for(let De=0;De<T;De++)s.get(v+Math.floor(De*d),we)&&le.set(De,he)}return le}static moduleSize(s,o){const l=o.getHeight(),d=o.getWidth();let m=s[0],p=s[1],v=!0,b=0;for(;m<d&&p<l;){if(v!==o.get(m,p)){if(++b===5)break;v=!v}m++,p++}if(m===d||p===l)throw new me;return(m-s[0])/7}}hi.NO_POINTS=new Array;class Et{PDF417Common(){}static getBitCountSum(s){return at.sum(s)}static toIntArray(s){if(s==null||!s.length)return Et.EMPTY_INT_ARRAY;const o=new Int32Array(s.length);let l=0;for(const d of s)o[l++]=d;return o}static getCodeword(s){const o=ne.binarySearch(Et.SYMBOL_TABLE,s&262143);return o<0?-1:(Et.CODEWORD_TABLE[o]-1)%Et.NUMBER_OF_CODEWORDS}}Et.NUMBER_OF_CODEWORDS=929,Et.MAX_CODEWORDS_IN_BARCODE=Et.NUMBER_OF_CODEWORDS-1,Et.MIN_ROWS_IN_BARCODE=3,Et.MAX_ROWS_IN_BARCODE=90,Et.MODULES_IN_CODEWORD=17,Et.MODULES_IN_STOP_PATTERN=18,Et.BARS_IN_MODULE=8,Et.EMPTY_INT_ARRAY=new Int32Array([]),Et.SYMBOL_TABLE=Int32Array.from([66142,66170,66206,66236,66290,66292,66350,66382,66396,66454,66470,66476,66594,66600,66614,66626,66628,66632,66640,66654,66662,66668,66682,66690,66718,66720,66748,66758,66776,66798,66802,66804,66820,66824,66832,66846,66848,66876,66880,66936,66950,66956,66968,66992,67006,67022,67036,67042,67044,67048,67062,67118,67150,67164,67214,67228,67256,67294,67322,67350,67366,67372,67398,67404,67416,67438,67474,67476,67490,67492,67496,67510,67618,67624,67650,67656,67664,67678,67686,67692,67706,67714,67716,67728,67742,67744,67772,67782,67788,67800,67822,67826,67828,67842,67848,67870,67872,67900,67904,67960,67974,67992,68016,68030,68046,68060,68066,68068,68072,68086,68104,68112,68126,68128,68156,68160,68216,68336,68358,68364,68376,68400,68414,68448,68476,68494,68508,68536,68546,68548,68552,68560,68574,68582,68588,68654,68686,68700,68706,68708,68712,68726,68750,68764,68792,68802,68804,68808,68816,68830,68838,68844,68858,68878,68892,68920,68976,68990,68994,68996,69e3,69008,69022,69024,69052,69062,69068,69080,69102,69106,69108,69142,69158,69164,69190,69208,69230,69254,69260,69272,69296,69310,69326,69340,69386,69394,69396,69410,69416,69430,69442,69444,69448,69456,69470,69478,69484,69554,69556,69666,69672,69698,69704,69712,69726,69754,69762,69764,69776,69790,69792,69820,69830,69836,69848,69870,69874,69876,69890,69918,69920,69948,69952,70008,70022,70040,70064,70078,70094,70108,70114,70116,70120,70134,70152,70174,70176,70264,70384,70412,70448,70462,70496,70524,70542,70556,70584,70594,70600,70608,70622,70630,70636,70664,70672,70686,70688,70716,70720,70776,70896,71136,71180,71192,71216,71230,71264,71292,71360,71416,71452,71480,71536,71550,71554,71556,71560,71568,71582,71584,71612,71622,71628,71640,71662,71726,71732,71758,71772,71778,71780,71784,71798,71822,71836,71864,71874,71880,71888,71902,71910,71916,71930,71950,71964,71992,72048,72062,72066,72068,72080,72094,72096,72124,72134,72140,72152,72174,72178,72180,72206,72220,72248,72304,72318,72416,72444,72456,72464,72478,72480,72508,72512,72568,72588,72600,72624,72638,72654,72668,72674,72676,72680,72694,72726,72742,72748,72774,72780,72792,72814,72838,72856,72880,72894,72910,72924,72930,72932,72936,72950,72966,72972,72984,73008,73022,73056,73084,73102,73116,73144,73156,73160,73168,73182,73190,73196,73210,73226,73234,73236,73250,73252,73256,73270,73282,73284,73296,73310,73318,73324,73346,73348,73352,73360,73374,73376,73404,73414,73420,73432,73454,73498,73518,73522,73524,73550,73564,73570,73572,73576,73590,73800,73822,73858,73860,73872,73886,73888,73916,73944,73970,73972,73992,74014,74016,74044,74048,74104,74118,74136,74160,74174,74210,74212,74216,74230,74244,74256,74270,74272,74360,74480,74502,74508,74544,74558,74592,74620,74638,74652,74680,74690,74696,74704,74726,74732,74782,74784,74812,74992,75232,75288,75326,75360,75388,75456,75512,75576,75632,75646,75650,75652,75664,75678,75680,75708,75718,75724,75736,75758,75808,75836,75840,75896,76016,76256,76736,76824,76848,76862,76896,76924,76992,77048,77296,77340,77368,77424,77438,77536,77564,77572,77576,77584,77600,77628,77632,77688,77702,77708,77720,77744,77758,77774,77788,77870,77902,77916,77922,77928,77966,77980,78008,78018,78024,78032,78046,78060,78074,78094,78136,78192,78206,78210,78212,78224,78238,78240,78268,78278,78284,78296,78322,78324,78350,78364,78448,78462,78560,78588,78600,78622,78624,78652,78656,78712,78726,78744,78768,78782,78798,78812,78818,78820,78824,78838,78862,78876,78904,78960,78974,79072,79100,79296,79352,79368,79376,79390,79392,79420,79424,79480,79600,79628,79640,79664,79678,79712,79740,79772,79800,79810,79812,79816,79824,79838,79846,79852,79894,79910,79916,79942,79948,79960,79982,79988,80006,80024,80048,80062,80078,80092,80098,80100,80104,80134,80140,80176,80190,80224,80252,80270,80284,80312,80328,80336,80350,80358,80364,80378,80390,80396,80408,80432,80446,80480,80508,80576,80632,80654,80668,80696,80752,80766,80776,80784,80798,80800,80828,80844,80856,80878,80882,80884,80914,80916,80930,80932,80936,80950,80962,80968,80976,80990,80998,81004,81026,81028,81040,81054,81056,81084,81094,81100,81112,81134,81154,81156,81160,81168,81182,81184,81212,81216,81272,81286,81292,81304,81328,81342,81358,81372,81380,81384,81398,81434,81454,81458,81460,81486,81500,81506,81508,81512,81526,81550,81564,81592,81602,81604,81608,81616,81630,81638,81644,81702,81708,81722,81734,81740,81752,81774,81778,81780,82050,82078,82080,82108,82180,82184,82192,82206,82208,82236,82240,82296,82316,82328,82352,82366,82402,82404,82408,82440,82448,82462,82464,82492,82496,82552,82672,82694,82700,82712,82736,82750,82784,82812,82830,82882,82884,82888,82896,82918,82924,82952,82960,82974,82976,83004,83008,83064,83184,83424,83468,83480,83504,83518,83552,83580,83648,83704,83740,83768,83824,83838,83842,83844,83848,83856,83872,83900,83910,83916,83928,83950,83984,84e3,84028,84032,84088,84208,84448,84928,85040,85054,85088,85116,85184,85240,85488,85560,85616,85630,85728,85756,85764,85768,85776,85790,85792,85820,85824,85880,85894,85900,85912,85936,85966,85980,86048,86080,86136,86256,86496,86976,88160,88188,88256,88312,88560,89056,89200,89214,89312,89340,89536,89592,89608,89616,89632,89664,89720,89840,89868,89880,89904,89952,89980,89998,90012,90040,90190,90204,90254,90268,90296,90306,90308,90312,90334,90382,90396,90424,90480,90494,90500,90504,90512,90526,90528,90556,90566,90572,90584,90610,90612,90638,90652,90680,90736,90750,90848,90876,90884,90888,90896,90910,90912,90940,90944,91e3,91014,91020,91032,91056,91070,91086,91100,91106,91108,91112,91126,91150,91164,91192,91248,91262,91360,91388,91584,91640,91664,91678,91680,91708,91712,91768,91888,91928,91952,91966,92e3,92028,92046,92060,92088,92098,92100,92104,92112,92126,92134,92140,92188,92216,92272,92384,92412,92608,92664,93168,93200,93214,93216,93244,93248,93304,93424,93664,93720,93744,93758,93792,93820,93888,93944,93980,94008,94064,94078,94084,94088,94096,94110,94112,94140,94150,94156,94168,94246,94252,94278,94284,94296,94318,94342,94348,94360,94384,94398,94414,94428,94440,94470,94476,94488,94512,94526,94560,94588,94606,94620,94648,94658,94660,94664,94672,94686,94694,94700,94714,94726,94732,94744,94768,94782,94816,94844,94912,94968,94990,95004,95032,95088,95102,95112,95120,95134,95136,95164,95180,95192,95214,95218,95220,95244,95256,95280,95294,95328,95356,95424,95480,95728,95758,95772,95800,95856,95870,95968,95996,96008,96016,96030,96032,96060,96064,96120,96152,96176,96190,96220,96226,96228,96232,96290,96292,96296,96310,96322,96324,96328,96336,96350,96358,96364,96386,96388,96392,96400,96414,96416,96444,96454,96460,96472,96494,96498,96500,96514,96516,96520,96528,96542,96544,96572,96576,96632,96646,96652,96664,96688,96702,96718,96732,96738,96740,96744,96758,96772,96776,96784,96798,96800,96828,96832,96888,97008,97030,97036,97048,97072,97086,97120,97148,97166,97180,97208,97220,97224,97232,97246,97254,97260,97326,97330,97332,97358,97372,97378,97380,97384,97398,97422,97436,97464,97474,97476,97480,97488,97502,97510,97516,97550,97564,97592,97648,97666,97668,97672,97680,97694,97696,97724,97734,97740,97752,97774,97830,97836,97850,97862,97868,97880,97902,97906,97908,97926,97932,97944,97968,97998,98012,98018,98020,98024,98038,98618,98674,98676,98838,98854,98874,98892,98904,98926,98930,98932,98968,99006,99042,99044,99048,99062,99166,99194,99246,99286,99350,99366,99372,99386,99398,99416,99438,99442,99444,99462,99504,99518,99534,99548,99554,99556,99560,99574,99590,99596,99608,99632,99646,99680,99708,99726,99740,99768,99778,99780,99784,99792,99806,99814,99820,99834,99858,99860,99874,99880,99894,99906,99920,99934,99962,99970,99972,99976,99984,99998,1e5,100028,100038,100044,100056,100078,100082,100084,100142,100174,100188,100246,100262,100268,100306,100308,100390,100396,100410,100422,100428,100440,100462,100466,100468,100486,100504,100528,100542,100558,100572,100578,100580,100584,100598,100620,100656,100670,100704,100732,100750,100792,100802,100808,100816,100830,100838,100844,100858,100888,100912,100926,100960,100988,101056,101112,101148,101176,101232,101246,101250,101252,101256,101264,101278,101280,101308,101318,101324,101336,101358,101362,101364,101410,101412,101416,101430,101442,101448,101456,101470,101478,101498,101506,101508,101520,101534,101536,101564,101580,101618,101620,101636,101640,101648,101662,101664,101692,101696,101752,101766,101784,101838,101858,101860,101864,101934,101938,101940,101966,101980,101986,101988,101992,102030,102044,102072,102082,102084,102088,102096,102138,102166,102182,102188,102214,102220,102232,102254,102282,102290,102292,102306,102308,102312,102326,102444,102458,102470,102476,102488,102514,102516,102534,102552,102576,102590,102606,102620,102626,102632,102646,102662,102668,102704,102718,102752,102780,102798,102812,102840,102850,102856,102864,102878,102886,102892,102906,102936,102974,103008,103036,103104,103160,103224,103280,103294,103298,103300,103312,103326,103328,103356,103366,103372,103384,103406,103410,103412,103472,103486,103520,103548,103616,103672,103920,103992,104048,104062,104160,104188,104194,104196,104200,104208,104224,104252,104256,104312,104326,104332,104344,104368,104382,104398,104412,104418,104420,104424,104482,104484,104514,104520,104528,104542,104550,104570,104578,104580,104592,104606,104608,104636,104652,104690,104692,104706,104712,104734,104736,104764,104768,104824,104838,104856,104910,104930,104932,104936,104968,104976,104990,104992,105020,105024,105080,105200,105240,105278,105312,105372,105410,105412,105416,105424,105446,105518,105524,105550,105564,105570,105572,105576,105614,105628,105656,105666,105672,105680,105702,105722,105742,105756,105784,105840,105854,105858,105860,105864,105872,105888,105932,105970,105972,106006,106022,106028,106054,106060,106072,106100,106118,106124,106136,106160,106174,106190,106210,106212,106216,106250,106258,106260,106274,106276,106280,106306,106308,106312,106320,106334,106348,106394,106414,106418,106420,106566,106572,106610,106612,106630,106636,106648,106672,106686,106722,106724,106728,106742,106758,106764,106776,106800,106814,106848,106876,106894,106908,106936,106946,106948,106952,106960,106974,106982,106988,107032,107056,107070,107104,107132,107200,107256,107292,107320,107376,107390,107394,107396,107400,107408,107422,107424,107452,107462,107468,107480,107502,107506,107508,107544,107568,107582,107616,107644,107712,107768,108016,108060,108088,108144,108158,108256,108284,108290,108292,108296,108304,108318,108320,108348,108352,108408,108422,108428,108440,108464,108478,108494,108508,108514,108516,108520,108592,108640,108668,108736,108792,109040,109536,109680,109694,109792,109820,110016,110072,110084,110088,110096,110112,110140,110144,110200,110320,110342,110348,110360,110384,110398,110432,110460,110478,110492,110520,110532,110536,110544,110558,110658,110686,110714,110722,110724,110728,110736,110750,110752,110780,110796,110834,110836,110850,110852,110856,110864,110878,110880,110908,110912,110968,110982,111e3,111054,111074,111076,111080,111108,111112,111120,111134,111136,111164,111168,111224,111344,111372,111422,111456,111516,111554,111556,111560,111568,111590,111632,111646,111648,111676,111680,111736,111856,112096,112152,112224,112252,112320,112440,112514,112516,112520,112528,112542,112544,112588,112686,112718,112732,112782,112796,112824,112834,112836,112840,112848,112870,112890,112910,112924,112952,113008,113022,113026,113028,113032,113040,113054,113056,113100,113138,113140,113166,113180,113208,113264,113278,113376,113404,113416,113424,113440,113468,113472,113560,113614,113634,113636,113640,113686,113702,113708,113734,113740,113752,113778,113780,113798,113804,113816,113840,113854,113870,113890,113892,113896,113926,113932,113944,113968,113982,114016,114044,114076,114114,114116,114120,114128,114150,114170,114194,114196,114210,114212,114216,114242,114244,114248,114256,114270,114278,114306,114308,114312,114320,114334,114336,114364,114380,114420,114458,114478,114482,114484,114510,114524,114530,114532,114536,114842,114866,114868,114970,114994,114996,115042,115044,115048,115062,115130,115226,115250,115252,115278,115292,115298,115300,115304,115318,115342,115394,115396,115400,115408,115422,115430,115436,115450,115478,115494,115514,115526,115532,115570,115572,115738,115758,115762,115764,115790,115804,115810,115812,115816,115830,115854,115868,115896,115906,115912,115920,115934,115942,115948,115962,115996,116024,116080,116094,116098,116100,116104,116112,116126,116128,116156,116166,116172,116184,116206,116210,116212,116246,116262,116268,116282,116294,116300,116312,116334,116338,116340,116358,116364,116376,116400,116414,116430,116444,116450,116452,116456,116498,116500,116514,116520,116534,116546,116548,116552,116560,116574,116582,116588,116602,116654,116694,116714,116762,116782,116786,116788,116814,116828,116834,116836,116840,116854,116878,116892,116920,116930,116936,116944,116958,116966,116972,116986,117006,117048,117104,117118,117122,117124,117136,117150,117152,117180,117190,117196,117208,117230,117234,117236,117304,117360,117374,117472,117500,117506,117508,117512,117520,117536,117564,117568,117624,117638,117644,117656,117680,117694,117710,117724,117730,117732,117736,117750,117782,117798,117804,117818,117830,117848,117874,117876,117894,117936,117950,117966,117986,117988,117992,118022,118028,118040,118064,118078,118112,118140,118172,118210,118212,118216,118224,118238,118246,118266,118306,118312,118338,118352,118366,118374,118394,118402,118404,118408,118416,118430,118432,118460,118476,118514,118516,118574,118578,118580,118606,118620,118626,118628,118632,118678,118694,118700,118730,118738,118740,118830,118834,118836,118862,118876,118882,118884,118888,118902,118926,118940,118968,118978,118980,118984,118992,119006,119014,119020,119034,119068,119096,119152,119166,119170,119172,119176,119184,119198,119200,119228,119238,119244,119256,119278,119282,119284,119324,119352,119408,119422,119520,119548,119554,119556,119560,119568,119582,119584,119612,119616,119672,119686,119692,119704,119728,119742,119758,119772,119778,119780,119784,119798,119920,119934,120032,120060,120256,120312,120324,120328,120336,120352,120384,120440,120560,120582,120588,120600,120624,120638,120672,120700,120718,120732,120760,120770,120772,120776,120784,120798,120806,120812,120870,120876,120890,120902,120908,120920,120946,120948,120966,120972,120984,121008,121022,121038,121058,121060,121064,121078,121100,121112,121136,121150,121184,121212,121244,121282,121284,121288,121296,121318,121338,121356,121368,121392,121406,121440,121468,121536,121592,121656,121730,121732,121736,121744,121758,121760,121804,121842,121844,121890,121922,121924,121928,121936,121950,121958,121978,121986,121988,121992,122e3,122014,122016,122044,122060,122098,122100,122116,122120,122128,122142,122144,122172,122176,122232,122246,122264,122318,122338,122340,122344,122414,122418,122420,122446,122460,122466,122468,122472,122510,122524,122552,122562,122564,122568,122576,122598,122618,122646,122662,122668,122694,122700,122712,122738,122740,122762,122770,122772,122786,122788,122792,123018,123026,123028,123042,123044,123048,123062,123098,123146,123154,123156,123170,123172,123176,123190,123202,123204,123208,123216,123238,123244,123258,123290,123314,123316,123402,123410,123412,123426,123428,123432,123446,123458,123464,123472,123486,123494,123500,123514,123522,123524,123528,123536,123552,123580,123590,123596,123608,123630,123634,123636,123674,123698,123700,123740,123746,123748,123752,123834,123914,123922,123924,123938,123944,123958,123970,123976,123984,123998,124006,124012,124026,124034,124036,124048,124062,124064,124092,124102,124108,124120,124142,124146,124148,124162,124164,124168,124176,124190,124192,124220,124224,124280,124294,124300,124312,124336,124350,124366,124380,124386,124388,124392,124406,124442,124462,124466,124468,124494,124508,124514,124520,124558,124572,124600,124610,124612,124616,124624,124646,124666,124694,124710,124716,124730,124742,124748,124760,124786,124788,124818,124820,124834,124836,124840,124854,124946,124948,124962,124964,124968,124982,124994,124996,125e3,125008,125022,125030,125036,125050,125058,125060,125064,125072,125086,125088,125116,125126,125132,125144,125166,125170,125172,125186,125188,125192,125200,125216,125244,125248,125304,125318,125324,125336,125360,125374,125390,125404,125410,125412,125416,125430,125444,125448,125456,125472,125504,125560,125680,125702,125708,125720,125744,125758,125792,125820,125838,125852,125880,125890,125892,125896,125904,125918,125926,125932,125978,125998,126002,126004,126030,126044,126050,126052,126056,126094,126108,126136,126146,126148,126152,126160,126182,126202,126222,126236,126264,126320,126334,126338,126340,126344,126352,126366,126368,126412,126450,126452,126486,126502,126508,126522,126534,126540,126552,126574,126578,126580,126598,126604,126616,126640,126654,126670,126684,126690,126692,126696,126738,126754,126756,126760,126774,126786,126788,126792,126800,126814,126822,126828,126842,126894,126898,126900,126934,127126,127142,127148,127162,127178,127186,127188,127254,127270,127276,127290,127302,127308,127320,127342,127346,127348,127370,127378,127380,127394,127396,127400,127450,127510,127526,127532,127546,127558,127576,127598,127602,127604,127622,127628,127640,127664,127678,127694,127708,127714,127716,127720,127734,127754,127762,127764,127778,127784,127810,127812,127816,127824,127838,127846,127866,127898,127918,127922,127924,128022,128038,128044,128058,128070,128076,128088,128110,128114,128116,128134,128140,128152,128176,128190,128206,128220,128226,128228,128232,128246,128262,128268,128280,128304,128318,128352,128380,128398,128412,128440,128450,128452,128456,128464,128478,128486,128492,128506,128522,128530,128532,128546,128548,128552,128566,128578,128580,128584,128592,128606,128614,128634,128642,128644,128648,128656,128670,128672,128700,128716,128754,128756,128794,128814,128818,128820,128846,128860,128866,128868,128872,128886,128918,128934,128940,128954,128978,128980,129178,129198,129202,129204,129238,129258,129306,129326,129330,129332,129358,129372,129378,129380,129384,129398,129430,129446,129452,129466,129482,129490,129492,129562,129582,129586,129588,129614,129628,129634,129636,129640,129654,129678,129692,129720,129730,129732,129736,129744,129758,129766,129772,129814,129830,129836,129850,129862,129868,129880,129902,129906,129908,129930,129938,129940,129954,129956,129960,129974,130010]),Et.CODEWORD_TABLE=Int32Array.from([2627,1819,2622,2621,1813,1812,2729,2724,2723,2779,2774,2773,902,896,908,868,865,861,859,2511,873,871,1780,835,2493,825,2491,842,837,844,1764,1762,811,810,809,2483,807,2482,806,2480,815,814,813,812,2484,817,816,1745,1744,1742,1746,2655,2637,2635,2626,2625,2623,2628,1820,2752,2739,2737,2728,2727,2725,2730,2785,2783,2778,2777,2775,2780,787,781,747,739,736,2413,754,752,1719,692,689,681,2371,678,2369,700,697,694,703,1688,1686,642,638,2343,631,2341,627,2338,651,646,643,2345,654,652,1652,1650,1647,1654,601,599,2322,596,2321,594,2319,2317,611,610,608,606,2324,603,2323,615,614,612,1617,1616,1614,1612,616,1619,1618,2575,2538,2536,905,901,898,909,2509,2507,2504,870,867,864,860,2512,875,872,1781,2490,2489,2487,2485,1748,836,834,832,830,2494,827,2492,843,841,839,845,1765,1763,2701,2676,2674,2653,2648,2656,2634,2633,2631,2629,1821,2638,2636,2770,2763,2761,2750,2745,2753,2736,2735,2733,2731,1848,2740,2738,2786,2784,591,588,576,569,566,2296,1590,537,534,526,2276,522,2274,545,542,539,548,1572,1570,481,2245,466,2242,462,2239,492,485,482,2249,496,494,1534,1531,1528,1538,413,2196,406,2191,2188,425,419,2202,415,2199,432,430,427,1472,1467,1464,433,1476,1474,368,367,2160,365,2159,362,2157,2155,2152,378,377,375,2166,372,2165,369,2162,383,381,379,2168,1419,1418,1416,1414,385,1411,384,1423,1422,1420,1424,2461,802,2441,2439,790,786,783,794,2409,2406,2403,750,742,738,2414,756,753,1720,2367,2365,2362,2359,1663,693,691,684,2373,680,2370,702,699,696,704,1690,1687,2337,2336,2334,2332,1624,2329,1622,640,637,2344,634,2342,630,2340,650,648,645,2346,655,653,1653,1651,1649,1655,2612,2597,2595,2571,2568,2565,2576,2534,2529,2526,1787,2540,2537,907,904,900,910,2503,2502,2500,2498,1768,2495,1767,2510,2508,2506,869,866,863,2513,876,874,1782,2720,2713,2711,2697,2694,2691,2702,2672,2670,2664,1828,2678,2675,2647,2646,2644,2642,1823,2639,1822,2654,2652,2650,2657,2771,1855,2765,2762,1850,1849,2751,2749,2747,2754,353,2148,344,342,336,2142,332,2140,345,1375,1373,306,2130,299,2128,295,2125,319,314,311,2132,1354,1352,1349,1356,262,257,2101,253,2096,2093,274,273,267,2107,263,2104,280,278,275,1316,1311,1308,1320,1318,2052,202,2050,2044,2040,219,2063,212,2060,208,2055,224,221,2066,1260,1258,1252,231,1248,229,1266,1264,1261,1268,155,1998,153,1996,1994,1991,1988,165,164,2007,162,2006,159,2003,2e3,172,171,169,2012,166,2010,1186,1184,1182,1179,175,1176,173,1192,1191,1189,1187,176,1194,1193,2313,2307,2305,592,589,2294,2292,2289,578,572,568,2297,580,1591,2272,2267,2264,1547,538,536,529,2278,525,2275,547,544,541,1574,1571,2237,2235,2229,1493,2225,1489,478,2247,470,2244,465,2241,493,488,484,2250,498,495,1536,1533,1530,1539,2187,2186,2184,2182,1432,2179,1430,2176,1427,414,412,2197,409,2195,405,2193,2190,426,424,421,2203,418,2201,431,429,1473,1471,1469,1466,434,1477,1475,2478,2472,2470,2459,2457,2454,2462,803,2437,2432,2429,1726,2443,2440,792,789,785,2401,2399,2393,1702,2389,1699,2411,2408,2405,745,741,2415,758,755,1721,2358,2357,2355,2353,1661,2350,1660,2347,1657,2368,2366,2364,2361,1666,690,687,2374,683,2372,701,698,705,1691,1689,2619,2617,2610,2608,2605,2613,2593,2588,2585,1803,2599,2596,2563,2561,2555,1797,2551,1795,2573,2570,2567,2577,2525,2524,2522,2520,1786,2517,1785,2514,1783,2535,2533,2531,2528,1788,2541,2539,906,903,911,2721,1844,2715,2712,1838,1836,2699,2696,2693,2703,1827,1826,1824,2673,2671,2669,2666,1829,2679,2677,1858,1857,2772,1854,1853,1851,1856,2766,2764,143,1987,139,1986,135,133,131,1984,128,1983,125,1981,138,137,136,1985,1133,1132,1130,112,110,1974,107,1973,104,1971,1969,122,121,119,117,1977,114,1976,124,1115,1114,1112,1110,1117,1116,84,83,1953,81,1952,78,1950,1948,1945,94,93,91,1959,88,1958,85,1955,99,97,95,1961,1086,1085,1083,1081,1078,100,1090,1089,1087,1091,49,47,1917,44,1915,1913,1910,1907,59,1926,56,1925,53,1922,1919,66,64,1931,61,1929,1042,1040,1038,71,1035,70,1032,68,1048,1047,1045,1043,1050,1049,12,10,1869,1867,1864,1861,21,1880,19,1877,1874,1871,28,1888,25,1886,22,1883,982,980,977,974,32,30,991,989,987,984,34,995,994,992,2151,2150,2147,2146,2144,356,355,354,2149,2139,2138,2136,2134,1359,343,341,338,2143,335,2141,348,347,346,1376,1374,2124,2123,2121,2119,1326,2116,1324,310,308,305,2131,302,2129,298,2127,320,318,316,313,2133,322,321,1355,1353,1351,1357,2092,2091,2089,2087,1276,2084,1274,2081,1271,259,2102,256,2100,252,2098,2095,272,269,2108,266,2106,281,279,277,1317,1315,1313,1310,282,1321,1319,2039,2037,2035,2032,1203,2029,1200,1197,207,2053,205,2051,201,2049,2046,2043,220,218,2064,215,2062,211,2059,228,226,223,2069,1259,1257,1254,232,1251,230,1267,1265,1263,2316,2315,2312,2311,2309,2314,2304,2303,2301,2299,1593,2308,2306,590,2288,2287,2285,2283,1578,2280,1577,2295,2293,2291,579,577,574,571,2298,582,581,1592,2263,2262,2260,2258,1545,2255,1544,2252,1541,2273,2271,2269,2266,1550,535,532,2279,528,2277,546,543,549,1575,1573,2224,2222,2220,1486,2217,1485,2214,1482,1479,2238,2236,2234,2231,1496,2228,1492,480,477,2248,473,2246,469,2243,490,487,2251,497,1537,1535,1532,2477,2476,2474,2479,2469,2468,2466,2464,1730,2473,2471,2453,2452,2450,2448,1729,2445,1728,2460,2458,2456,2463,805,804,2428,2427,2425,2423,1725,2420,1724,2417,1722,2438,2436,2434,2431,1727,2444,2442,793,791,788,795,2388,2386,2384,1697,2381,1696,2378,1694,1692,2402,2400,2398,2395,1703,2392,1701,2412,2410,2407,751,748,744,2416,759,757,1807,2620,2618,1806,1805,2611,2609,2607,2614,1802,1801,1799,2594,2592,2590,2587,1804,2600,2598,1794,1793,1791,1789,2564,2562,2560,2557,1798,2554,1796,2574,2572,2569,2578,1847,1846,2722,1843,1842,1840,1845,2716,2714,1835,1834,1832,1830,1839,1837,2700,2698,2695,2704,1817,1811,1810,897,862,1777,829,826,838,1760,1758,808,2481,1741,1740,1738,1743,2624,1818,2726,2776,782,740,737,1715,686,679,695,1682,1680,639,628,2339,647,644,1645,1643,1640,1648,602,600,597,595,2320,593,2318,609,607,604,1611,1610,1608,1606,613,1615,1613,2328,926,924,892,886,899,857,850,2505,1778,824,823,821,819,2488,818,2486,833,831,828,840,1761,1759,2649,2632,2630,2746,2734,2732,2782,2781,570,567,1587,531,527,523,540,1566,1564,476,467,463,2240,486,483,1524,1521,1518,1529,411,403,2192,399,2189,423,416,1462,1457,1454,428,1468,1465,2210,366,363,2158,360,2156,357,2153,376,373,370,2163,1410,1409,1407,1405,382,1402,380,1417,1415,1412,1421,2175,2174,777,774,771,784,732,725,722,2404,743,1716,676,674,668,2363,665,2360,685,1684,1681,626,624,622,2335,620,2333,617,2330,641,635,649,1646,1644,1642,2566,928,925,2530,2527,894,891,888,2501,2499,2496,858,856,854,851,1779,2692,2668,2665,2645,2643,2640,2651,2768,2759,2757,2744,2743,2741,2748,352,1382,340,337,333,1371,1369,307,300,296,2126,315,312,1347,1342,1350,261,258,250,2097,246,2094,271,268,264,1306,1301,1298,276,1312,1309,2115,203,2048,195,2045,191,2041,213,209,2056,1246,1244,1238,225,1234,222,1256,1253,1249,1262,2080,2079,154,1997,150,1995,147,1992,1989,163,160,2004,156,2001,1175,1174,1172,1170,1167,170,1164,167,1185,1183,1180,1177,174,1190,1188,2025,2024,2022,587,586,564,559,556,2290,573,1588,520,518,512,2268,508,2265,530,1568,1565,461,457,2233,450,2230,446,2226,479,471,489,1526,1523,1520,397,395,2185,392,2183,389,2180,2177,410,2194,402,422,1463,1461,1459,1456,1470,2455,799,2433,2430,779,776,773,2397,2394,2390,734,728,724,746,1717,2356,2354,2351,2348,1658,677,675,673,670,667,688,1685,1683,2606,2589,2586,2559,2556,2552,927,2523,2521,2518,2515,1784,2532,895,893,890,2718,2709,2707,2689,2687,2684,2663,2662,2660,2658,1825,2667,2769,1852,2760,2758,142,141,1139,1138,134,132,129,126,1982,1129,1128,1126,1131,113,111,108,105,1972,101,1970,120,118,115,1109,1108,1106,1104,123,1113,1111,82,79,1951,75,1949,72,1946,92,89,86,1956,1077,1076,1074,1072,98,1069,96,1084,1082,1079,1088,1968,1967,48,45,1916,42,1914,39,1911,1908,60,57,54,1923,50,1920,1031,1030,1028,1026,67,1023,65,1020,62,1041,1039,1036,1033,69,1046,1044,1944,1943,1941,11,9,1868,7,1865,1862,1859,20,1878,16,1875,13,1872,970,968,966,963,29,960,26,23,983,981,978,975,33,971,31,990,988,985,1906,1904,1902,993,351,2145,1383,331,330,328,326,2137,323,2135,339,1372,1370,294,293,291,289,2122,286,2120,283,2117,309,303,317,1348,1346,1344,245,244,242,2090,239,2088,236,2085,2082,260,2099,249,270,1307,1305,1303,1300,1314,189,2038,186,2036,183,2033,2030,2026,206,198,2047,194,216,1247,1245,1243,1240,227,1237,1255,2310,2302,2300,2286,2284,2281,565,563,561,558,575,1589,2261,2259,2256,2253,1542,521,519,517,514,2270,511,533,1569,1567,2223,2221,2218,2215,1483,2211,1480,459,456,453,2232,449,474,491,1527,1525,1522,2475,2467,2465,2451,2449,2446,801,800,2426,2424,2421,2418,1723,2435,780,778,775,2387,2385,2382,2379,1695,2375,1693,2396,735,733,730,727,749,1718,2616,2615,2604,2603,2601,2584,2583,2581,2579,1800,2591,2550,2549,2547,2545,1792,2542,1790,2558,929,2719,1841,2710,2708,1833,1831,2690,2688,2686,1815,1809,1808,1774,1756,1754,1737,1736,1734,1739,1816,1711,1676,1674,633,629,1638,1636,1633,1641,598,1605,1604,1602,1600,605,1609,1607,2327,887,853,1775,822,820,1757,1755,1584,524,1560,1558,468,464,1514,1511,1508,1519,408,404,400,1452,1447,1444,417,1458,1455,2208,364,361,358,2154,1401,1400,1398,1396,374,1393,371,1408,1406,1403,1413,2173,2172,772,726,723,1712,672,669,666,682,1678,1675,625,623,621,618,2331,636,632,1639,1637,1635,920,918,884,880,889,849,848,847,846,2497,855,852,1776,2641,2742,2787,1380,334,1367,1365,301,297,1340,1338,1335,1343,255,251,247,1296,1291,1288,265,1302,1299,2113,204,196,192,2042,1232,1230,1224,214,1220,210,1242,1239,1235,1250,2077,2075,151,148,1993,144,1990,1163,1162,1160,1158,1155,161,1152,157,1173,1171,1168,1165,168,1181,1178,2021,2020,2018,2023,585,560,557,1585,516,509,1562,1559,458,447,2227,472,1516,1513,1510,398,396,393,390,2181,386,2178,407,1453,1451,1449,1446,420,1460,2209,769,764,720,712,2391,729,1713,664,663,661,659,2352,656,2349,671,1679,1677,2553,922,919,2519,2516,885,883,881,2685,2661,2659,2767,2756,2755,140,1137,1136,130,127,1125,1124,1122,1127,109,106,102,1103,1102,1100,1098,116,1107,1105,1980,80,76,73,1947,1068,1067,1065,1063,90,1060,87,1075,1073,1070,1080,1966,1965,46,43,40,1912,36,1909,1019,1018,1016,1014,58,1011,55,1008,51,1029,1027,1024,1021,63,1037,1034,1940,1939,1937,1942,8,1866,4,1863,1,1860,956,954,952,949,946,17,14,969,967,964,961,27,957,24,979,976,972,1901,1900,1898,1896,986,1905,1903,350,349,1381,329,327,324,1368,1366,292,290,287,284,2118,304,1341,1339,1337,1345,243,240,237,2086,233,2083,254,1297,1295,1293,1290,1304,2114,190,187,184,2034,180,2031,177,2027,199,1233,1231,1229,1226,217,1223,1241,2078,2076,584,555,554,552,550,2282,562,1586,507,506,504,502,2257,499,2254,515,1563,1561,445,443,441,2219,438,2216,435,2212,460,454,475,1517,1515,1512,2447,798,797,2422,2419,770,768,766,2383,2380,2376,721,719,717,714,731,1714,2602,2582,2580,2548,2546,2543,923,921,2717,2706,2705,2683,2682,2680,1771,1752,1750,1733,1732,1731,1735,1814,1707,1670,1668,1631,1629,1626,1634,1599,1598,1596,1594,1603,1601,2326,1772,1753,1751,1581,1554,1552,1504,1501,1498,1509,1442,1437,1434,401,1448,1445,2206,1392,1391,1389,1387,1384,359,1399,1397,1394,1404,2171,2170,1708,1672,1669,619,1632,1630,1628,1773,1378,1363,1361,1333,1328,1336,1286,1281,1278,248,1292,1289,2111,1218,1216,1210,197,1206,193,1228,1225,1221,1236,2073,2071,1151,1150,1148,1146,152,1143,149,1140,145,1161,1159,1156,1153,158,1169,1166,2017,2016,2014,2019,1582,510,1556,1553,452,448,1506,1500,394,391,387,1443,1441,1439,1436,1450,2207,765,716,713,1709,662,660,657,1673,1671,916,914,879,878,877,882,1135,1134,1121,1120,1118,1123,1097,1096,1094,1092,103,1101,1099,1979,1059,1058,1056,1054,77,1051,74,1066,1064,1061,1071,1964,1963,1007,1006,1004,1002,999,41,996,37,1017,1015,1012,1009,52,1025,1022,1936,1935,1933,1938,942,940,938,935,932,5,2,955,953,950,947,18,943,15,965,962,958,1895,1894,1892,1890,973,1899,1897,1379,325,1364,1362,288,285,1334,1332,1330,241,238,234,1287,1285,1283,1280,1294,2112,188,185,181,178,2028,1219,1217,1215,1212,200,1209,1227,2074,2072,583,553,551,1583,505,503,500,513,1557,1555,444,442,439,436,2213,455,451,1507,1505,1502,796,763,762,760,767,711,710,708,706,2377,718,715,1710,2544,917,915,2681,1627,1597,1595,2325,1769,1749,1747,1499,1438,1435,2204,1390,1388,1385,1395,2169,2167,1704,1665,1662,1625,1623,1620,1770,1329,1282,1279,2109,1214,1207,1222,2068,2065,1149,1147,1144,1141,146,1157,1154,2013,2011,2008,2015,1579,1549,1546,1495,1487,1433,1431,1428,1425,388,1440,2205,1705,658,1667,1664,1119,1095,1093,1978,1057,1055,1052,1062,1962,1960,1005,1003,1e3,997,38,1013,1010,1932,1930,1927,1934,941,939,936,933,6,930,3,951,948,944,1889,1887,1884,1881,959,1893,1891,35,1377,1360,1358,1327,1325,1322,1331,1277,1275,1272,1269,235,1284,2110,1205,1204,1201,1198,182,1195,179,1213,2070,2067,1580,501,1551,1548,440,437,1497,1494,1490,1503,761,709,707,1706,913,912,2198,1386,2164,2161,1621,1766,2103,1208,2058,2054,1145,1142,2005,2002,1999,2009,1488,1429,1426,2200,1698,1659,1656,1975,1053,1957,1954,1001,998,1924,1921,1918,1928,937,934,931,1879,1876,1873,1870,945,1885,1882,1323,1273,1270,2105,1202,1199,1196,1211,2061,2057,1576,1543,1540,1484,1481,1478,1491,1700]);class Fr{constructor(s,o){this.bits=s,this.points=o}getBits(){return this.bits}getPoints(){return this.points}}class Tt{static detectMultiple(s,o,l){let d=s.getBlackMatrix(),m=Tt.detect(l,d);return m.length||(d=d.clone(),d.rotate180(),m=Tt.detect(l,d)),new Fr(d,m)}static detect(s,o){const l=new Array;let d=0,m=0,p=!1;for(;d<o.getHeight();){const v=Tt.findVertices(o,d,m);if(v[0]==null&&v[3]==null){if(!p)break;p=!1,m=0;for(const b of l)b[1]!=null&&(d=Math.trunc(Math.max(d,b[1].getY()))),b[3]!=null&&(d=Math.max(d,Math.trunc(b[3].getY())));d+=Tt.ROW_STEP;continue}if(p=!0,l.push(v),!s)break;v[2]!=null?(m=Math.trunc(v[2].getX()),d=Math.trunc(v[2].getY())):(m=Math.trunc(v[4].getX()),d=Math.trunc(v[4].getY()))}return l}static findVertices(s,o,l){const d=s.getHeight(),m=s.getWidth(),p=new Array(8);return Tt.copyToResult(p,Tt.findRowsWithPattern(s,d,m,o,l,Tt.START_PATTERN),Tt.INDEXES_START_PATTERN),p[4]!=null&&(l=Math.trunc(p[4].getX()),o=Math.trunc(p[4].getY())),Tt.copyToResult(p,Tt.findRowsWithPattern(s,d,m,o,l,Tt.STOP_PATTERN),Tt.INDEXES_STOP_PATTERN),p}static copyToResult(s,o,l){for(let d=0;d<l.length;d++)s[l[d]]=o[d]}static findRowsWithPattern(s,o,l,d,m,p){const v=new Array(4);let b=!1;const T=new Int32Array(p.length);for(;d<o;d+=Tt.ROW_STEP){let O=Tt.findGuardPattern(s,m,d,l,!1,p,T);if(O!=null){for(;d>0;){const V=Tt.findGuardPattern(s,m,--d,l,!1,p,T);if(V!=null)O=V;else{d++;break}}v[0]=new de(O[0],d),v[1]=new de(O[1],d),b=!0;break}}let R=d+1;if(b){let O=0,V=Int32Array.from([Math.trunc(v[0].getX()),Math.trunc(v[1].getX())]);for(;R<o;R++){const K=Tt.findGuardPattern(s,V[0],R,l,!1,p,T);if(K!=null&&Math.abs(V[0]-K[0])<Tt.MAX_PATTERN_DRIFT&&Math.abs(V[1]-K[1])<Tt.MAX_PATTERN_DRIFT)V=K,O=0;else{if(O>Tt.SKIPPED_ROW_COUNT_MAX)break;O++}}R-=O+1,v[2]=new de(V[0],R),v[3]=new de(V[1],R)}return R-d<Tt.BARCODE_MIN_HEIGHT&&ne.fill(v,null),v}static findGuardPattern(s,o,l,d,m,p,v){ne.fillWithin(v,0,v.length,0);let b=o,T=0;for(;s.get(b,l)&&b>0&&T++<Tt.MAX_PIXEL_DRIFT;)b--;let R=b,O=0,V=p.length;for(let K=m;R<d;R++)if(s.get(R,l)!==K)v[O]++;else{if(O===V-1){if(Tt.patternMatchVariance(v,p,Tt.MAX_INDIVIDUAL_VARIANCE)<Tt.MAX_AVG_VARIANCE)return new Int32Array([b,R]);b+=v[0]+v[1],G.arraycopy(v,2,v,0,O-1),v[O-1]=0,v[O]=0,O--}else O++;v[O]=1,K=!K}return O===V-1&&Tt.patternMatchVariance(v,p,Tt.MAX_INDIVIDUAL_VARIANCE)<Tt.MAX_AVG_VARIANCE?new Int32Array([b,R-1]):null}static patternMatchVariance(s,o,l){let d=s.length,m=0,p=0;for(let T=0;T<d;T++)m+=s[T],p+=o[T];if(m<p)return 1/0;let v=m/p;l*=v;let b=0;for(let T=0;T<d;T++){let R=s[T],O=o[T]*v,V=R>O?R-O:O-R;if(V>l)return 1/0;b+=V}return b/m}}Tt.INDEXES_START_PATTERN=Int32Array.from([0,4,1,5]),Tt.INDEXES_STOP_PATTERN=Int32Array.from([6,2,7,3]),Tt.MAX_AVG_VARIANCE=.42,Tt.MAX_INDIVIDUAL_VARIANCE=.8,Tt.START_PATTERN=Int32Array.from([8,1,1,1,1,1,1,3]),Tt.STOP_PATTERN=Int32Array.from([7,1,1,3,1,1,1,2,1]),Tt.MAX_PIXEL_DRIFT=3,Tt.MAX_PATTERN_DRIFT=5,Tt.SKIPPED_ROW_COUNT_MAX=25,Tt.ROW_STEP=5,Tt.BARCODE_MIN_HEIGHT=10;class Rn{constructor(s,o){if(o.length===0)throw new I;this.field=s;let l=o.length;if(l>1&&o[0]===0){let d=1;for(;d<l&&o[d]===0;)d++;d===l?this.coefficients=new Int32Array([0]):(this.coefficients=new Int32Array(l-d),G.arraycopy(o,d,this.coefficients,0,this.coefficients.length))}else this.coefficients=o}getCoefficients(){return this.coefficients}getDegree(){return this.coefficients.length-1}isZero(){return this.coefficients[0]===0}getCoefficient(s){return this.coefficients[this.coefficients.length-1-s]}evaluateAt(s){if(s===0)return this.getCoefficient(0);if(s===1){let d=0;for(let m of this.coefficients)d=this.field.add(d,m);return d}let o=this.coefficients[0],l=this.coefficients.length;for(let d=1;d<l;d++)o=this.field.add(this.field.multiply(s,o),this.coefficients[d]);return o}add(s){if(!this.field.equals(s.field))throw new I("ModulusPolys do not have same ModulusGF field");if(this.isZero())return s;if(s.isZero())return this;let o=this.coefficients,l=s.coefficients;if(o.length>l.length){let p=o;o=l,l=p}let d=new Int32Array(l.length),m=l.length-o.length;G.arraycopy(l,0,d,0,m);for(let p=m;p<l.length;p++)d[p]=this.field.add(o[p-m],l[p]);return new Rn(this.field,d)}subtract(s){if(!this.field.equals(s.field))throw new I("ModulusPolys do not have same ModulusGF field");return s.isZero()?this:this.add(s.negative())}multiply(s){return s instanceof Rn?this.multiplyOther(s):this.multiplyScalar(s)}multiplyOther(s){if(!this.field.equals(s.field))throw new I("ModulusPolys do not have same ModulusGF field");if(this.isZero()||s.isZero())return new Rn(this.field,new Int32Array([0]));let o=this.coefficients,l=o.length,d=s.coefficients,m=d.length,p=new Int32Array(l+m-1);for(let v=0;v<l;v++){let b=o[v];for(let T=0;T<m;T++)p[v+T]=this.field.add(p[v+T],this.field.multiply(b,d[T]))}return new Rn(this.field,p)}negative(){let s=this.coefficients.length,o=new Int32Array(s);for(let l=0;l<s;l++)o[l]=this.field.subtract(0,this.coefficients[l]);return new Rn(this.field,o)}multiplyScalar(s){if(s===0)return new Rn(this.field,new Int32Array([0]));if(s===1)return this;let o=this.coefficients.length,l=new Int32Array(o);for(let d=0;d<o;d++)l[d]=this.field.multiply(this.coefficients[d],s);return new Rn(this.field,l)}multiplyByMonomial(s,o){if(s<0)throw new I;if(o===0)return new Rn(this.field,new Int32Array([0]));let l=this.coefficients.length,d=new Int32Array(l+s);for(let m=0;m<l;m++)d[m]=this.field.multiply(this.coefficients[m],o);return new Rn(this.field,d)}toString(){let s=new z;for(let o=this.getDegree();o>=0;o--){let l=this.getCoefficient(o);l!==0&&(l<0?(s.append(" - "),l=-l):s.length()>0&&s.append(" + "),(o===0||l!==1)&&s.append(l),o!==0&&(o===1?s.append("x"):(s.append("x^"),s.append(o))))}return s.toString()}}class na{add(s,o){return(s+o)%this.modulus}subtract(s,o){return(this.modulus+s-o)%this.modulus}exp(s){return this.expTable[s]}log(s){if(s===0)throw new I;return this.logTable[s]}inverse(s){if(s===0)throw new qt;return this.expTable[this.modulus-this.logTable[s]-1]}multiply(s,o){return s===0||o===0?0:this.expTable[(this.logTable[s]+this.logTable[o])%(this.modulus-1)]}getSize(){return this.modulus}equals(s){return s===this}}class _n extends na{constructor(s,o){super(),this.modulus=s,this.expTable=new Int32Array(s),this.logTable=new Int32Array(s);let l=1;for(let d=0;d<s;d++)this.expTable[d]=l,l=l*o%s;for(let d=0;d<s-1;d++)this.logTable[this.expTable[d]]=d;this.zero=new Rn(this,new Int32Array([0])),this.one=new Rn(this,new Int32Array([1]))}getZero(){return this.zero}getOne(){return this.one}buildMonomial(s,o){if(s<0)throw new I;if(o===0)return this.zero;let l=new Int32Array(s+1);return l[0]=o,new Rn(this,l)}}_n.PDF417_GF=new _n(Et.NUMBER_OF_CODEWORDS,3);class Fi{constructor(){this.field=_n.PDF417_GF}decode(s,o,l){let d=new Rn(this.field,s),m=new Int32Array(o),p=!1;for(let le=o;le>0;le--){let he=d.evaluateAt(this.field.exp(le));m[o-le]=he,he!==0&&(p=!0)}if(!p)return 0;let v=this.field.getOne();if(l!=null)for(const le of l){let he=this.field.exp(s.length-1-le),we=new Rn(this.field,new Int32Array([this.field.subtract(0,he),1]));v=v.multiply(we)}let b=new Rn(this.field,m),T=this.runEuclideanAlgorithm(this.field.buildMonomial(o,1),b,o),R=T[0],O=T[1],V=this.findErrorLocations(R),K=this.findErrorMagnitudes(O,R,V);for(let le=0;le<V.length;le++){let he=s.length-1-this.field.log(V[le]);if(he<0)throw Y.getChecksumInstance();s[he]=this.field.subtract(s[he],K[le])}return V.length}runEuclideanAlgorithm(s,o,l){if(s.getDegree()<o.getDegree()){let V=s;s=o,o=V}let d=s,m=o,p=this.field.getZero(),v=this.field.getOne();for(;m.getDegree()>=Math.round(l/2);){let V=d,K=p;if(d=m,p=v,d.isZero())throw Y.getChecksumInstance();m=V;let le=this.field.getZero(),he=d.getCoefficient(d.getDegree()),we=this.field.inverse(he);for(;m.getDegree()>=d.getDegree()&&!m.isZero();){let De=m.getDegree()-d.getDegree(),$e=this.field.multiply(m.getCoefficient(m.getDegree()),we);le=le.add(this.field.buildMonomial(De,$e)),m=m.subtract(d.multiplyByMonomial(De,$e))}v=le.multiply(p).subtract(K).negative()}let b=v.getCoefficient(0);if(b===0)throw Y.getChecksumInstance();let T=this.field.inverse(b),R=v.multiply(T),O=m.multiply(T);return[R,O]}findErrorLocations(s){let o=s.getDegree(),l=new Int32Array(o),d=0;for(let m=1;m<this.field.getSize()&&d<o;m++)s.evaluateAt(m)===0&&(l[d]=this.field.inverse(m),d++);if(d!==o)throw Y.getChecksumInstance();return l}findErrorMagnitudes(s,o,l){let d=o.getDegree(),m=new Int32Array(d);for(let T=1;T<=d;T++)m[d-T]=this.field.multiply(T,o.getCoefficient(T));let p=new Rn(this.field,m),v=l.length,b=new Int32Array(v);for(let T=0;T<v;T++){let R=this.field.inverse(l[T]),O=this.field.subtract(0,s.evaluateAt(R)),V=this.field.inverse(p.evaluateAt(R));b[T]=this.field.multiply(O,V)}return b}}class Ui{constructor(s,o,l,d,m){s instanceof Ui?this.constructor_2(s):this.constructor_1(s,o,l,d,m)}constructor_1(s,o,l,d,m){const p=o==null||l==null,v=d==null||m==null;if(p&&v)throw new me;p?(o=new de(0,d.getY()),l=new de(0,m.getY())):v&&(d=new de(s.getWidth()-1,o.getY()),m=new de(s.getWidth()-1,l.getY())),this.image=s,this.topLeft=o,this.bottomLeft=l,this.topRight=d,this.bottomRight=m,this.minX=Math.trunc(Math.min(o.getX(),l.getX())),this.maxX=Math.trunc(Math.max(d.getX(),m.getX())),this.minY=Math.trunc(Math.min(o.getY(),d.getY())),this.maxY=Math.trunc(Math.max(l.getY(),m.getY()))}constructor_2(s){this.image=s.image,this.topLeft=s.getTopLeft(),this.bottomLeft=s.getBottomLeft(),this.topRight=s.getTopRight(),this.bottomRight=s.getBottomRight(),this.minX=s.getMinX(),this.maxX=s.getMaxX(),this.minY=s.getMinY(),this.maxY=s.getMaxY()}static merge(s,o){return s==null?o:o==null?s:new Ui(s.image,s.topLeft,s.bottomLeft,o.topRight,o.bottomRight)}addMissingRows(s,o,l){let d=this.topLeft,m=this.bottomLeft,p=this.topRight,v=this.bottomRight;if(s>0){let b=l?this.topLeft:this.topRight,T=Math.trunc(b.getY()-s);T<0&&(T=0);let R=new de(b.getX(),T);l?d=R:p=R}if(o>0){let b=l?this.bottomLeft:this.bottomRight,T=Math.trunc(b.getY()+o);T>=this.image.getHeight()&&(T=this.image.getHeight()-1);let R=new de(b.getX(),T);l?m=R:v=R}return new Ui(this.image,d,m,p,v)}getMinX(){return this.minX}getMaxX(){return this.maxX}getMinY(){return this.minY}getMaxY(){return this.maxY}getTopLeft(){return this.topLeft}getTopRight(){return this.topRight}getBottomLeft(){return this.bottomLeft}getBottomRight(){return this.bottomRight}}class sa{constructor(s,o,l,d){this.columnCount=s,this.errorCorrectionLevel=d,this.rowCountUpperPart=o,this.rowCountLowerPart=l,this.rowCount=o+l}getColumnCount(){return this.columnCount}getErrorCorrectionLevel(){return this.errorCorrectionLevel}getRowCount(){return this.rowCount}getRowCountUpperPart(){return this.rowCountUpperPart}getRowCountLowerPart(){return this.rowCountLowerPart}}class Er{constructor(){this.buffer=""}static form(s,o){let l=-1;function d(p,v,b,T,R,O){if(p==="%%")return"%";if(o[++l]===void 0)return;p=T?parseInt(T.substr(1)):void 0;let V=R?parseInt(R.substr(1)):void 0,K;switch(O){case"s":K=o[l];break;case"c":K=o[l][0];break;case"f":K=parseFloat(o[l]).toFixed(p);break;case"p":K=parseFloat(o[l]).toPrecision(p);break;case"e":K=parseFloat(o[l]).toExponential(p);break;case"x":K=parseInt(o[l]).toString(V||16);break;case"d":K=parseFloat(parseInt(o[l],V||10).toPrecision(p)).toFixed(0);break}K=typeof K=="object"?JSON.stringify(K):(+K).toString(V);let le=parseInt(b),he=b&&b[0]+""=="0"?"0":" ";for(;K.length<le;)K=v!==void 0?K+he:he+K;return K}let m=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return s.replace(m,d)}format(s,...o){this.buffer+=Er.form(s,o)}toString(){return this.buffer}}class zi{constructor(s){this.boundingBox=new Ui(s),this.codewords=new Array(s.getMaxY()-s.getMinY()+1)}getCodewordNearby(s){let o=this.getCodeword(s);if(o!=null)return o;for(let l=1;l<zi.MAX_NEARBY_DISTANCE;l++){let d=this.imageRowToCodewordIndex(s)-l;if(d>=0&&(o=this.codewords[d],o!=null)||(d=this.imageRowToCodewordIndex(s)+l,d<this.codewords.length&&(o=this.codewords[d],o!=null)))return o}return null}imageRowToCodewordIndex(s){return s-this.boundingBox.getMinY()}setCodeword(s,o){this.codewords[this.imageRowToCodewordIndex(s)]=o}getCodeword(s){return this.codewords[this.imageRowToCodewordIndex(s)]}getBoundingBox(){return this.boundingBox}getCodewords(){return this.codewords}toString(){const s=new Er;let o=0;for(const l of this.codewords){if(l==null){s.format("%3d:    |   %n",o++);continue}s.format("%3d: %3d|%3d%n",o++,l.getRowNumber(),l.getValue())}return s.toString()}}zi.MAX_NEARBY_DISTANCE=5;class xi{constructor(){this.values=new Map}setValue(s){s=Math.trunc(s);let o=this.values.get(s);o==null&&(o=0),o++,this.values.set(s,o)}getValue(){let s=-1,o=new Array;for(const[l,d]of this.values.entries()){const m={getKey:()=>l,getValue:()=>d};m.getValue()>s?(s=m.getValue(),o=[],o.push(m.getKey())):m.getValue()===s&&o.push(m.getKey())}return Et.toIntArray(o)}getConfidence(s){return this.values.get(s)}}class Ii extends zi{constructor(s,o){super(s),this._isLeft=o}setRowNumbers(){for(let s of this.getCodewords())s?.setRowNumberAsRowIndicatorColumn()}adjustCompleteIndicatorColumnRowNumbers(s){let o=this.getCodewords();this.setRowNumbers(),this.removeIncorrectCodewords(o,s);let l=this.getBoundingBox(),d=this._isLeft?l.getTopLeft():l.getTopRight(),m=this._isLeft?l.getBottomLeft():l.getBottomRight(),p=this.imageRowToCodewordIndex(Math.trunc(d.getY())),v=this.imageRowToCodewordIndex(Math.trunc(m.getY())),b=-1,T=1,R=0;for(let O=p;O<v;O++){if(o[O]==null)continue;let V=o[O],K=V.getRowNumber()-b;if(K===0)R++;else if(K===1)T=Math.max(T,R),R=1,b=V.getRowNumber();else if(K<0||V.getRowNumber()>=s.getRowCount()||K>O)o[O]=null;else{let le;T>2?le=(T-2)*K:le=K;let he=le>=O;for(let we=1;we<=le&&!he;we++)he=o[O-we]!=null;he?o[O]=null:(b=V.getRowNumber(),R=1)}}}getRowHeights(){let s=this.getBarcodeMetadata();if(s==null)return null;this.adjustIncompleteIndicatorColumnRowNumbers(s);let o=new Int32Array(s.getRowCount());for(let l of this.getCodewords())if(l!=null){let d=l.getRowNumber();if(d>=o.length)continue;o[d]++}return o}adjustIncompleteIndicatorColumnRowNumbers(s){let o=this.getBoundingBox(),l=this._isLeft?o.getTopLeft():o.getTopRight(),d=this._isLeft?o.getBottomLeft():o.getBottomRight(),m=this.imageRowToCodewordIndex(Math.trunc(l.getY())),p=this.imageRowToCodewordIndex(Math.trunc(d.getY())),v=this.getCodewords(),b=-1;for(let T=m;T<p;T++){if(v[T]==null)continue;let R=v[T];R.setRowNumberAsRowIndicatorColumn();let O=R.getRowNumber()-b;O===0||(O===1?b=R.getRowNumber():R.getRowNumber()>=s.getRowCount()?v[T]=null:b=R.getRowNumber())}}getBarcodeMetadata(){let s=this.getCodewords(),o=new xi,l=new xi,d=new xi,m=new xi;for(let v of s){if(v==null)continue;v.setRowNumberAsRowIndicatorColumn();let b=v.getValue()%30,T=v.getRowNumber();switch(this._isLeft||(T+=2),T%3){case 0:l.setValue(b*3+1);break;case 1:m.setValue(b/3),d.setValue(b%3);break;case 2:o.setValue(b+1);break}}if(o.getValue().length===0||l.getValue().length===0||d.getValue().length===0||m.getValue().length===0||o.getValue()[0]<1||l.getValue()[0]+d.getValue()[0]<Et.MIN_ROWS_IN_BARCODE||l.getValue()[0]+d.getValue()[0]>Et.MAX_ROWS_IN_BARCODE)return null;let p=new sa(o.getValue()[0],l.getValue()[0],d.getValue()[0],m.getValue()[0]);return this.removeIncorrectCodewords(s,p),p}removeIncorrectCodewords(s,o){for(let l=0;l<s.length;l++){let d=s[l];if(s[l]==null)continue;let m=d.getValue()%30,p=d.getRowNumber();if(p>o.getRowCount()){s[l]=null;continue}switch(this._isLeft||(p+=2),p%3){case 0:m*3+1!==o.getRowCountUpperPart()&&(s[l]=null);break;case 1:(Math.trunc(m/3)!==o.getErrorCorrectionLevel()||m%3!==o.getRowCountLowerPart())&&(s[l]=null);break;case 2:m+1!==o.getColumnCount()&&(s[l]=null);break}}}isLeft(){return this._isLeft}toString(){return"IsLeft: "+this._isLeft+`
`+super.toString()}}class us{constructor(s,o){this.ADJUST_ROW_NUMBER_SKIP=2,this.barcodeMetadata=s,this.barcodeColumnCount=s.getColumnCount(),this.boundingBox=o,this.detectionResultColumns=new Array(this.barcodeColumnCount+2)}getDetectionResultColumns(){this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[0]),this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[this.barcodeColumnCount+1]);let s=Et.MAX_CODEWORDS_IN_BARCODE,o;do o=s,s=this.adjustRowNumbersAndGetCount();while(s>0&&s<o);return this.detectionResultColumns}adjustIndicatorColumnRowNumbers(s){s?.adjustCompleteIndicatorColumnRowNumbers(this.barcodeMetadata)}adjustRowNumbersAndGetCount(){let s=this.adjustRowNumbersByRow();if(s===0)return 0;for(let o=1;o<this.barcodeColumnCount+1;o++){let l=this.detectionResultColumns[o].getCodewords();for(let d=0;d<l.length;d++)l[d]!=null&&(l[d].hasValidRowNumber()||this.adjustRowNumbers(o,d,l))}return s}adjustRowNumbersByRow(){return this.adjustRowNumbersFromBothRI(),this.adjustRowNumbersFromLRI()+this.adjustRowNumbersFromRRI()}adjustRowNumbersFromBothRI(){if(this.detectionResultColumns[0]==null||this.detectionResultColumns[this.barcodeColumnCount+1]==null)return;let s=this.detectionResultColumns[0].getCodewords(),o=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords();for(let l=0;l<s.length;l++)if(s[l]!=null&&o[l]!=null&&s[l].getRowNumber()===o[l].getRowNumber())for(let d=1;d<=this.barcodeColumnCount;d++){let m=this.detectionResultColumns[d].getCodewords()[l];m!=null&&(m.setRowNumber(s[l].getRowNumber()),m.hasValidRowNumber()||(this.detectionResultColumns[d].getCodewords()[l]=null))}}adjustRowNumbersFromRRI(){if(this.detectionResultColumns[this.barcodeColumnCount+1]==null)return 0;let s=0,o=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords();for(let l=0;l<o.length;l++){if(o[l]==null)continue;let d=o[l].getRowNumber(),m=0;for(let p=this.barcodeColumnCount+1;p>0&&m<this.ADJUST_ROW_NUMBER_SKIP;p--){let v=this.detectionResultColumns[p].getCodewords()[l];v!=null&&(m=us.adjustRowNumberIfValid(d,m,v),v.hasValidRowNumber()||s++)}}return s}adjustRowNumbersFromLRI(){if(this.detectionResultColumns[0]==null)return 0;let s=0,o=this.detectionResultColumns[0].getCodewords();for(let l=0;l<o.length;l++){if(o[l]==null)continue;let d=o[l].getRowNumber(),m=0;for(let p=1;p<this.barcodeColumnCount+1&&m<this.ADJUST_ROW_NUMBER_SKIP;p++){let v=this.detectionResultColumns[p].getCodewords()[l];v!=null&&(m=us.adjustRowNumberIfValid(d,m,v),v.hasValidRowNumber()||s++)}}return s}static adjustRowNumberIfValid(s,o,l){return l==null||l.hasValidRowNumber()||(l.isValidRowNumber(s)?(l.setRowNumber(s),o=0):++o),o}adjustRowNumbers(s,o,l){if(!this.detectionResultColumns[s-1])return;let d=l[o],m=this.detectionResultColumns[s-1].getCodewords(),p=m;this.detectionResultColumns[s+1]!=null&&(p=this.detectionResultColumns[s+1].getCodewords());let v=new Array(14);v[2]=m[o],v[3]=p[o],o>0&&(v[0]=l[o-1],v[4]=m[o-1],v[5]=p[o-1]),o>1&&(v[8]=l[o-2],v[10]=m[o-2],v[11]=p[o-2]),o<l.length-1&&(v[1]=l[o+1],v[6]=m[o+1],v[7]=p[o+1]),o<l.length-2&&(v[9]=l[o+2],v[12]=m[o+2],v[13]=p[o+2]);for(let b of v)if(us.adjustRowNumber(d,b))return}static adjustRowNumber(s,o){return o==null?!1:o.hasValidRowNumber()&&o.getBucket()===s.getBucket()?(s.setRowNumber(o.getRowNumber()),!0):!1}getBarcodeColumnCount(){return this.barcodeColumnCount}getBarcodeRowCount(){return this.barcodeMetadata.getRowCount()}getBarcodeECLevel(){return this.barcodeMetadata.getErrorCorrectionLevel()}setBoundingBox(s){this.boundingBox=s}getBoundingBox(){return this.boundingBox}setDetectionResultColumn(s,o){this.detectionResultColumns[s]=o}getDetectionResultColumn(s){return this.detectionResultColumns[s]}toString(){let s=this.detectionResultColumns[0];s==null&&(s=this.detectionResultColumns[this.barcodeColumnCount+1]);let o=new Er;for(let l=0;l<s.getCodewords().length;l++){o.format("CW %3d:",l);for(let d=0;d<this.barcodeColumnCount+2;d++){if(this.detectionResultColumns[d]==null){o.format("    |   ");continue}let m=this.detectionResultColumns[d].getCodewords()[l];if(m==null){o.format("    |   ");continue}o.format(" %3d|%3d",m.getRowNumber(),m.getValue())}o.format("%n")}return o.toString()}}class vi{constructor(s,o,l,d){this.rowNumber=vi.BARCODE_ROW_UNKNOWN,this.startX=Math.trunc(s),this.endX=Math.trunc(o),this.bucket=Math.trunc(l),this.value=Math.trunc(d)}hasValidRowNumber(){return this.isValidRowNumber(this.rowNumber)}isValidRowNumber(s){return s!==vi.BARCODE_ROW_UNKNOWN&&this.bucket===s%3*3}setRowNumberAsRowIndicatorColumn(){this.rowNumber=Math.trunc(Math.trunc(this.value/30)*3+Math.trunc(this.bucket/3))}getWidth(){return this.endX-this.startX}getStartX(){return this.startX}getEndX(){return this.endX}getBucket(){return this.bucket}getValue(){return this.value}getRowNumber(){return this.rowNumber}setRowNumber(s){this.rowNumber=s}toString(){return this.rowNumber+"|"+this.value}}vi.BARCODE_ROW_UNKNOWN=-1;class Xn{static initialize(){for(let s=0;s<Et.SYMBOL_TABLE.length;s++){let o=Et.SYMBOL_TABLE[s],l=o&1;for(let d=0;d<Et.BARS_IN_MODULE;d++){let m=0;for(;(o&1)===l;)m+=1,o>>=1;l=o&1,Xn.RATIOS_TABLE[s]||(Xn.RATIOS_TABLE[s]=new Array(Et.BARS_IN_MODULE)),Xn.RATIOS_TABLE[s][Et.BARS_IN_MODULE-d-1]=Math.fround(m/Et.MODULES_IN_CODEWORD)}}this.bSymbolTableReady=!0}static getDecodedValue(s){let o=Xn.getDecodedCodewordValue(Xn.sampleBitCounts(s));return o!==-1?o:Xn.getClosestDecodedValue(s)}static sampleBitCounts(s){let o=at.sum(s),l=new Int32Array(Et.BARS_IN_MODULE),d=0,m=0;for(let p=0;p<Et.MODULES_IN_CODEWORD;p++){let v=o/(2*Et.MODULES_IN_CODEWORD)+p*o/Et.MODULES_IN_CODEWORD;m+s[d]<=v&&(m+=s[d],d++),l[d]++}return l}static getDecodedCodewordValue(s){let o=Xn.getBitValue(s);return Et.getCodeword(o)===-1?-1:o}static getBitValue(s){let o=0;for(let l=0;l<s.length;l++)for(let d=0;d<s[l];d++)o=o<<1|(l%2===0?1:0);return Math.trunc(o)}static getClosestDecodedValue(s){let o=at.sum(s),l=new Array(Et.BARS_IN_MODULE);if(o>1)for(let p=0;p<l.length;p++)l[p]=Math.fround(s[p]/o);let d=kt.MAX_VALUE,m=-1;this.bSymbolTableReady||Xn.initialize();for(let p=0;p<Xn.RATIOS_TABLE.length;p++){let v=0,b=Xn.RATIOS_TABLE[p];for(let T=0;T<Et.BARS_IN_MODULE;T++){let R=Math.fround(b[T]-l[T]);if(v+=Math.fround(R*R),v>=d)break}v<d&&(d=v,m=Et.SYMBOL_TABLE[p])}return m}}Xn.bSymbolTableReady=!1,Xn.RATIOS_TABLE=new Array(Et.SYMBOL_TABLE.length).map(M=>new Array(Et.BARS_IN_MODULE));class _r{constructor(){this.segmentCount=-1,this.fileSize=-1,this.timestamp=-1,this.checksum=-1}getSegmentIndex(){return this.segmentIndex}setSegmentIndex(s){this.segmentIndex=s}getFileId(){return this.fileId}setFileId(s){this.fileId=s}getOptionalData(){return this.optionalData}setOptionalData(s){this.optionalData=s}isLastSegment(){return this.lastSegment}setLastSegment(s){this.lastSegment=s}getSegmentCount(){return this.segmentCount}setSegmentCount(s){this.segmentCount=s}getSender(){return this.sender||null}setSender(s){this.sender=s}getAddressee(){return this.addressee||null}setAddressee(s){this.addressee=s}getFileName(){return this.fileName}setFileName(s){this.fileName=s}getFileSize(){return this.fileSize}setFileSize(s){this.fileSize=s}getChecksum(){return this.checksum}setChecksum(s){this.checksum=s}getTimestamp(){return this.timestamp}setTimestamp(s){this.timestamp=s}}class Wa{static parseLong(s,o=void 0){return parseInt(s,o)}}class Ar extends E{}Ar.kind="NullPointerException";class Ya{writeBytes(s){this.writeBytesOffset(s,0,s.length)}writeBytesOffset(s,o,l){if(s==null)throw new Ar;if(o<0||o>s.length||l<0||o+l>s.length||o+l<0)throw new J;if(l===0)return;for(let d=0;d<l;d++)this.write(s[o+d])}flush(){}close(){}}class sr extends E{}class Xa extends Ya{constructor(s=32){if(super(),this.count=0,s<0)throw new I("Negative initial size: "+s);this.buf=new Uint8Array(s)}ensureCapacity(s){s-this.buf.length>0&&this.grow(s)}grow(s){let l=this.buf.length<<1;if(l-s<0&&(l=s),l<0){if(s<0)throw new sr;l=ue.MAX_VALUE}this.buf=ne.copyOfUint8Array(this.buf,l)}write(s){this.ensureCapacity(this.count+1),this.buf[this.count]=s,this.count+=1}writeBytesOffset(s,o,l){if(o<0||o>s.length||l<0||o+l-s.length>0)throw new J;this.ensureCapacity(this.count+l),G.arraycopy(s,o,this.buf,this.count,l),this.count+=l}writeTo(s){s.writeBytesOffset(this.buf,0,this.count)}reset(){this.count=0}toByteArray(){return ne.copyOfUint8Array(this.buf,this.count)}size(){return this.count}toString(s){return s?typeof s=="string"?this.toString_string(s):this.toString_number(s):this.toString_void()}toString_void(){return new String(this.buf).toString()}toString_string(s){return new String(this.buf).toString()}toString_number(s){return new String(this.buf).toString()}close(){}}var pn;(function(M){M[M.ALPHA=0]="ALPHA",M[M.LOWER=1]="LOWER",M[M.MIXED=2]="MIXED",M[M.PUNCT=3]="PUNCT",M[M.ALPHA_SHIFT=4]="ALPHA_SHIFT",M[M.PUNCT_SHIFT=5]="PUNCT_SHIFT"})(pn||(pn={}));function Ur(){if(typeof window<"u")return window.BigInt||null;if(typeof ld<"u")return ld.BigInt||null;if(typeof self<"u")return self.BigInt||null;throw new Error("Can't search globals for BigInt!")}let ia;function Hi(M){if(typeof ia>"u"&&(ia=Ur()),ia===null)throw new Error("BigInt is not supported!");return ia(M)}function ra(){let M=[];M[0]=Hi(1);let s=Hi(900);M[1]=s;for(let o=2;o<16;o++)M[o]=M[o-1]*s;return M}class Ie{static decode(s,o){let l=new z(""),d=B.ISO8859_1;l.enableDecoding(d);let m=1,p=s[m++],v=new _r;for(;m<s[0];){switch(p){case Ie.TEXT_COMPACTION_MODE_LATCH:m=Ie.textCompaction(s,m,l);break;case Ie.BYTE_COMPACTION_MODE_LATCH:case Ie.BYTE_COMPACTION_MODE_LATCH_6:m=Ie.byteCompaction(p,s,d,m,l);break;case Ie.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:l.append(s[m++]);break;case Ie.NUMERIC_COMPACTION_MODE_LATCH:m=Ie.numericCompaction(s,m,l);break;case Ie.ECI_CHARSET:B.getCharacterSetECIByValue(s[m++]);break;case Ie.ECI_GENERAL_PURPOSE:m+=2;break;case Ie.ECI_USER_DEFINED:m++;break;case Ie.BEGIN_MACRO_PDF417_CONTROL_BLOCK:m=Ie.decodeMacroBlock(s,m,v);break;case Ie.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case Ie.MACRO_PDF417_TERMINATOR:throw new P;default:m--,m=Ie.textCompaction(s,m,l);break}if(m<s.length)p=s[m++];else throw P.getFormatInstance()}if(l.length()===0)throw P.getFormatInstance();let b=new it(null,l.toString(),null,o);return b.setOther(v),b}static decodeMacroBlock(s,o,l){if(o+Ie.NUMBER_OF_SEQUENCE_CODEWORDS>s[0])throw P.getFormatInstance();let d=new Int32Array(Ie.NUMBER_OF_SEQUENCE_CODEWORDS);for(let v=0;v<Ie.NUMBER_OF_SEQUENCE_CODEWORDS;v++,o++)d[v]=s[o];l.setSegmentIndex(ue.parseInt(Ie.decodeBase900toBase10(d,Ie.NUMBER_OF_SEQUENCE_CODEWORDS)));let m=new z;o=Ie.textCompaction(s,o,m),l.setFileId(m.toString());let p=-1;for(s[o]===Ie.BEGIN_MACRO_PDF417_OPTIONAL_FIELD&&(p=o+1);o<s[0];)switch(s[o]){case Ie.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:switch(o++,s[o]){case Ie.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME:let v=new z;o=Ie.textCompaction(s,o+1,v),l.setFileName(v.toString());break;case Ie.MACRO_PDF417_OPTIONAL_FIELD_SENDER:let b=new z;o=Ie.textCompaction(s,o+1,b),l.setSender(b.toString());break;case Ie.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE:let T=new z;o=Ie.textCompaction(s,o+1,T),l.setAddressee(T.toString());break;case Ie.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT:let R=new z;o=Ie.numericCompaction(s,o+1,R),l.setSegmentCount(ue.parseInt(R.toString()));break;case Ie.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP:let O=new z;o=Ie.numericCompaction(s,o+1,O),l.setTimestamp(Wa.parseLong(O.toString()));break;case Ie.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM:let V=new z;o=Ie.numericCompaction(s,o+1,V),l.setChecksum(ue.parseInt(V.toString()));break;case Ie.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE:let K=new z;o=Ie.numericCompaction(s,o+1,K),l.setFileSize(Wa.parseLong(K.toString()));break;default:throw P.getFormatInstance()}break;case Ie.MACRO_PDF417_TERMINATOR:o++,l.setLastSegment(!0);break;default:throw P.getFormatInstance()}if(p!==-1){let v=o-p;l.isLastSegment()&&v--,l.setOptionalData(ne.copyOfRange(s,p,p+v))}return o}static textCompaction(s,o,l){let d=new Int32Array((s[0]-o)*2),m=new Int32Array((s[0]-o)*2),p=0,v=!1;for(;o<s[0]&&!v;){let b=s[o++];if(b<Ie.TEXT_COMPACTION_MODE_LATCH)d[p]=b/30,d[p+1]=b%30,p+=2;else switch(b){case Ie.TEXT_COMPACTION_MODE_LATCH:d[p++]=Ie.TEXT_COMPACTION_MODE_LATCH;break;case Ie.BYTE_COMPACTION_MODE_LATCH:case Ie.BYTE_COMPACTION_MODE_LATCH_6:case Ie.NUMERIC_COMPACTION_MODE_LATCH:case Ie.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case Ie.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case Ie.MACRO_PDF417_TERMINATOR:o--,v=!0;break;case Ie.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:d[p]=Ie.MODE_SHIFT_TO_BYTE_COMPACTION_MODE,b=s[o++],m[p]=b,p++;break}}return Ie.decodeTextCompaction(d,m,p,l),o}static decodeTextCompaction(s,o,l,d){let m=pn.ALPHA,p=pn.ALPHA,v=0;for(;v<l;){let b=s[v],T="";switch(m){case pn.ALPHA:if(b<26)T=String.fromCharCode(65+b);else switch(b){case 26:T=" ";break;case Ie.LL:m=pn.LOWER;break;case Ie.ML:m=pn.MIXED;break;case Ie.PS:p=m,m=pn.PUNCT_SHIFT;break;case Ie.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:d.append(o[v]);break;case Ie.TEXT_COMPACTION_MODE_LATCH:m=pn.ALPHA;break}break;case pn.LOWER:if(b<26)T=String.fromCharCode(97+b);else switch(b){case 26:T=" ";break;case Ie.AS:p=m,m=pn.ALPHA_SHIFT;break;case Ie.ML:m=pn.MIXED;break;case Ie.PS:p=m,m=pn.PUNCT_SHIFT;break;case Ie.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:d.append(o[v]);break;case Ie.TEXT_COMPACTION_MODE_LATCH:m=pn.ALPHA;break}break;case pn.MIXED:if(b<Ie.PL)T=Ie.MIXED_CHARS[b];else switch(b){case Ie.PL:m=pn.PUNCT;break;case 26:T=" ";break;case Ie.LL:m=pn.LOWER;break;case Ie.AL:m=pn.ALPHA;break;case Ie.PS:p=m,m=pn.PUNCT_SHIFT;break;case Ie.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:d.append(o[v]);break;case Ie.TEXT_COMPACTION_MODE_LATCH:m=pn.ALPHA;break}break;case pn.PUNCT:if(b<Ie.PAL)T=Ie.PUNCT_CHARS[b];else switch(b){case Ie.PAL:m=pn.ALPHA;break;case Ie.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:d.append(o[v]);break;case Ie.TEXT_COMPACTION_MODE_LATCH:m=pn.ALPHA;break}break;case pn.ALPHA_SHIFT:if(m=p,b<26)T=String.fromCharCode(65+b);else switch(b){case 26:T=" ";break;case Ie.TEXT_COMPACTION_MODE_LATCH:m=pn.ALPHA;break}break;case pn.PUNCT_SHIFT:if(m=p,b<Ie.PAL)T=Ie.PUNCT_CHARS[b];else switch(b){case Ie.PAL:m=pn.ALPHA;break;case Ie.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:d.append(o[v]);break;case Ie.TEXT_COMPACTION_MODE_LATCH:m=pn.ALPHA;break}break}T!==""&&d.append(T),v++}}static byteCompaction(s,o,l,d,m){let p=new Xa,v=0,b=0,T=!1;switch(s){case Ie.BYTE_COMPACTION_MODE_LATCH:let R=new Int32Array(6),O=o[d++];for(;d<o[0]&&!T;)switch(R[v++]=O,b=900*b+O,O=o[d++],O){case Ie.TEXT_COMPACTION_MODE_LATCH:case Ie.BYTE_COMPACTION_MODE_LATCH:case Ie.NUMERIC_COMPACTION_MODE_LATCH:case Ie.BYTE_COMPACTION_MODE_LATCH_6:case Ie.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case Ie.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case Ie.MACRO_PDF417_TERMINATOR:d--,T=!0;break;default:if(v%5===0&&v>0){for(let V=0;V<6;++V)p.write(Number(Hi(b)>>Hi(8*(5-V))));b=0,v=0}break}d===o[0]&&O<Ie.TEXT_COMPACTION_MODE_LATCH&&(R[v++]=O);for(let V=0;V<v;V++)p.write(R[V]);break;case Ie.BYTE_COMPACTION_MODE_LATCH_6:for(;d<o[0]&&!T;){let V=o[d++];if(V<Ie.TEXT_COMPACTION_MODE_LATCH)v++,b=900*b+V;else switch(V){case Ie.TEXT_COMPACTION_MODE_LATCH:case Ie.BYTE_COMPACTION_MODE_LATCH:case Ie.NUMERIC_COMPACTION_MODE_LATCH:case Ie.BYTE_COMPACTION_MODE_LATCH_6:case Ie.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case Ie.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case Ie.MACRO_PDF417_TERMINATOR:d--,T=!0;break}if(v%5===0&&v>0){for(let K=0;K<6;++K)p.write(Number(Hi(b)>>Hi(8*(5-K))));b=0,v=0}}break}return m.append(Z.decode(p.toByteArray(),l)),d}static numericCompaction(s,o,l){let d=0,m=!1,p=new Int32Array(Ie.MAX_NUMERIC_CODEWORDS);for(;o<s[0]&&!m;){let v=s[o++];if(o===s[0]&&(m=!0),v<Ie.TEXT_COMPACTION_MODE_LATCH)p[d]=v,d++;else switch(v){case Ie.TEXT_COMPACTION_MODE_LATCH:case Ie.BYTE_COMPACTION_MODE_LATCH:case Ie.BYTE_COMPACTION_MODE_LATCH_6:case Ie.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case Ie.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case Ie.MACRO_PDF417_TERMINATOR:o--,m=!0;break}(d%Ie.MAX_NUMERIC_CODEWORDS===0||v===Ie.NUMERIC_COMPACTION_MODE_LATCH||m)&&d>0&&(l.append(Ie.decodeBase900toBase10(p,d)),d=0)}return o}static decodeBase900toBase10(s,o){let l=Hi(0);for(let m=0;m<o;m++)l+=Ie.EXP900[o-m-1]*Hi(s[m]);let d=l.toString();if(d.charAt(0)!=="1")throw new P;return d.substring(1)}}Ie.TEXT_COMPACTION_MODE_LATCH=900,Ie.BYTE_COMPACTION_MODE_LATCH=901,Ie.NUMERIC_COMPACTION_MODE_LATCH=902,Ie.BYTE_COMPACTION_MODE_LATCH_6=924,Ie.ECI_USER_DEFINED=925,Ie.ECI_GENERAL_PURPOSE=926,Ie.ECI_CHARSET=927,Ie.BEGIN_MACRO_PDF417_CONTROL_BLOCK=928,Ie.BEGIN_MACRO_PDF417_OPTIONAL_FIELD=923,Ie.MACRO_PDF417_TERMINATOR=922,Ie.MODE_SHIFT_TO_BYTE_COMPACTION_MODE=913,Ie.MAX_NUMERIC_CODEWORDS=15,Ie.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME=0,Ie.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT=1,Ie.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP=2,Ie.MACRO_PDF417_OPTIONAL_FIELD_SENDER=3,Ie.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE=4,Ie.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE=5,Ie.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM=6,Ie.PL=25,Ie.LL=27,Ie.AS=27,Ie.ML=28,Ie.AL=28,Ie.PS=29,Ie.PAL=29,Ie.PUNCT_CHARS=`;<>@[\\]_\`~!\r	,:
-.$/"|*()?{}'`,Ie.MIXED_CHARS="0123456789&\r	,:#-.$/+%*=^",Ie.EXP900=Ur()?ra():[],Ie.NUMBER_OF_SEQUENCE_CODEWORDS=2;class Bt{constructor(){}static decode(s,o,l,d,m,p,v){let b=new Ui(s,o,l,d,m),T=null,R=null,O;for(let le=!0;;le=!1){if(o!=null&&(T=Bt.getRowIndicatorColumn(s,b,o,!0,p,v)),d!=null&&(R=Bt.getRowIndicatorColumn(s,b,d,!1,p,v)),O=Bt.merge(T,R),O==null)throw me.getNotFoundInstance();let he=O.getBoundingBox();if(le&&he!=null&&(he.getMinY()<b.getMinY()||he.getMaxY()>b.getMaxY()))b=he;else break}O.setBoundingBox(b);let V=O.getBarcodeColumnCount()+1;O.setDetectionResultColumn(0,T),O.setDetectionResultColumn(V,R);let K=T!=null;for(let le=1;le<=V;le++){let he=K?le:V-le;if(O.getDetectionResultColumn(he)!==void 0)continue;let we;he===0||he===V?we=new Ii(b,he===0):we=new zi(b),O.setDetectionResultColumn(he,we);let De=-1,$e=De;for(let Qe=b.getMinY();Qe<=b.getMaxY();Qe++){if(De=Bt.getStartColumn(O,he,Qe,K),De<0||De>b.getMaxX()){if($e===-1)continue;De=$e}let Xe=Bt.detectCodeword(s,b.getMinX(),b.getMaxX(),K,De,Qe,p,v);Xe!=null&&(we.setCodeword(Qe,Xe),$e=De,p=Math.min(p,Xe.getWidth()),v=Math.max(v,Xe.getWidth()))}}return Bt.createDecoderResult(O)}static merge(s,o){if(s==null&&o==null)return null;let l=Bt.getBarcodeMetadata(s,o);if(l==null)return null;let d=Ui.merge(Bt.adjustBoundingBox(s),Bt.adjustBoundingBox(o));return new us(l,d)}static adjustBoundingBox(s){if(s==null)return null;let o=s.getRowHeights();if(o==null)return null;let l=Bt.getMax(o),d=0;for(let v of o)if(d+=l-v,v>0)break;let m=s.getCodewords();for(let v=0;d>0&&m[v]==null;v++)d--;let p=0;for(let v=o.length-1;v>=0&&(p+=l-o[v],!(o[v]>0));v--);for(let v=m.length-1;p>0&&m[v]==null;v--)p--;return s.getBoundingBox().addMissingRows(d,p,s.isLeft())}static getMax(s){let o=-1;for(let l of s)o=Math.max(o,l);return o}static getBarcodeMetadata(s,o){let l;if(s==null||(l=s.getBarcodeMetadata())==null)return o==null?null:o.getBarcodeMetadata();let d;return o==null||(d=o.getBarcodeMetadata())==null?l:l.getColumnCount()!==d.getColumnCount()&&l.getErrorCorrectionLevel()!==d.getErrorCorrectionLevel()&&l.getRowCount()!==d.getRowCount()?null:l}static getRowIndicatorColumn(s,o,l,d,m,p){let v=new Ii(o,d);for(let b=0;b<2;b++){let T=b===0?1:-1,R=Math.trunc(Math.trunc(l.getX()));for(let O=Math.trunc(Math.trunc(l.getY()));O<=o.getMaxY()&&O>=o.getMinY();O+=T){let V=Bt.detectCodeword(s,0,s.getWidth(),d,R,O,m,p);V!=null&&(v.setCodeword(O,V),d?R=V.getStartX():R=V.getEndX())}}return v}static adjustCodewordCount(s,o){let l=o[0][1],d=l.getValue(),m=s.getBarcodeColumnCount()*s.getBarcodeRowCount()-Bt.getNumberOfECCodeWords(s.getBarcodeECLevel());if(d.length===0){if(m<1||m>Et.MAX_CODEWORDS_IN_BARCODE)throw me.getNotFoundInstance();l.setValue(m)}else d[0]!==m&&l.setValue(m)}static createDecoderResult(s){let o=Bt.createBarcodeMatrix(s);Bt.adjustCodewordCount(s,o);let l=new Array,d=new Int32Array(s.getBarcodeRowCount()*s.getBarcodeColumnCount()),m=[],p=new Array;for(let b=0;b<s.getBarcodeRowCount();b++)for(let T=0;T<s.getBarcodeColumnCount();T++){let R=o[b][T+1].getValue(),O=b*s.getBarcodeColumnCount()+T;R.length===0?l.push(O):R.length===1?d[O]=R[0]:(p.push(O),m.push(R))}let v=new Array(m.length);for(let b=0;b<v.length;b++)v[b]=m[b];return Bt.createDecoderResultFromAmbiguousValues(s.getBarcodeECLevel(),d,Et.toIntArray(l),Et.toIntArray(p),v)}static createDecoderResultFromAmbiguousValues(s,o,l,d,m){let p=new Int32Array(d.length),v=100;for(;v-- >0;){for(let b=0;b<p.length;b++)o[d[b]]=m[b][p[b]];try{return Bt.decodeCodewords(o,s,l)}catch(b){if(!(b instanceof Y))throw b}if(p.length===0)throw Y.getChecksumInstance();for(let b=0;b<p.length;b++)if(p[b]<m[b].length-1){p[b]++;break}else if(p[b]=0,b===p.length-1)throw Y.getChecksumInstance()}throw Y.getChecksumInstance()}static createBarcodeMatrix(s){let o=Array.from({length:s.getBarcodeRowCount()},()=>new Array(s.getBarcodeColumnCount()+2));for(let d=0;d<o.length;d++)for(let m=0;m<o[d].length;m++)o[d][m]=new xi;let l=0;for(let d of s.getDetectionResultColumns()){if(d!=null){for(let m of d.getCodewords())if(m!=null){let p=m.getRowNumber();if(p>=0){if(p>=o.length)continue;o[p][l].setValue(m.getValue())}}}l++}return o}static isValidBarcodeColumn(s,o){return o>=0&&o<=s.getBarcodeColumnCount()+1}static getStartColumn(s,o,l,d){let m=d?1:-1,p=null;if(Bt.isValidBarcodeColumn(s,o-m)&&(p=s.getDetectionResultColumn(o-m).getCodeword(l)),p!=null)return d?p.getEndX():p.getStartX();if(p=s.getDetectionResultColumn(o).getCodewordNearby(l),p!=null)return d?p.getStartX():p.getEndX();if(Bt.isValidBarcodeColumn(s,o-m)&&(p=s.getDetectionResultColumn(o-m).getCodewordNearby(l)),p!=null)return d?p.getEndX():p.getStartX();let v=0;for(;Bt.isValidBarcodeColumn(s,o-m);){o-=m;for(let b of s.getDetectionResultColumn(o).getCodewords())if(b!=null)return(d?b.getEndX():b.getStartX())+m*v*(b.getEndX()-b.getStartX());v++}return d?s.getBoundingBox().getMinX():s.getBoundingBox().getMaxX()}static detectCodeword(s,o,l,d,m,p,v,b){m=Bt.adjustCodewordStartColumn(s,o,l,d,m,p);let T=Bt.getModuleBitCount(s,o,l,d,m,p);if(T==null)return null;let R,O=at.sum(T);if(d)R=m+O;else{for(let le=0;le<T.length/2;le++){let he=T[le];T[le]=T[T.length-1-le],T[T.length-1-le]=he}R=m,m=R-O}if(!Bt.checkCodewordSkew(O,v,b))return null;let V=Xn.getDecodedValue(T),K=Et.getCodeword(V);return K===-1?null:new vi(m,R,Bt.getCodewordBucketNumber(V),K)}static getModuleBitCount(s,o,l,d,m,p){let v=m,b=new Int32Array(8),T=0,R=d?1:-1,O=d;for(;(d?v<l:v>=o)&&T<b.length;)s.get(v,p)===O?(b[T]++,v+=R):(T++,O=!O);return T===b.length||v===(d?l:o)&&T===b.length-1?b:null}static getNumberOfECCodeWords(s){return 2<<s}static adjustCodewordStartColumn(s,o,l,d,m,p){let v=m,b=d?-1:1;for(let T=0;T<2;T++){for(;(d?v>=o:v<l)&&d===s.get(v,p);){if(Math.abs(m-v)>Bt.CODEWORD_SKEW_SIZE)return m;v+=b}b=-b,d=!d}return v}static checkCodewordSkew(s,o,l){return o-Bt.CODEWORD_SKEW_SIZE<=s&&s<=l+Bt.CODEWORD_SKEW_SIZE}static decodeCodewords(s,o,l){if(s.length===0)throw P.getFormatInstance();let d=1<<o+1,m=Bt.correctErrors(s,l,d);Bt.verifyCodewordCount(s,d);let p=Ie.decode(s,""+o);return p.setErrorsCorrected(m),p.setErasures(l.length),p}static correctErrors(s,o,l){if(o!=null&&o.length>l/2+Bt.MAX_ERRORS||l<0||l>Bt.MAX_EC_CODEWORDS)throw Y.getChecksumInstance();return Bt.errorCorrection.decode(s,l,o)}static verifyCodewordCount(s,o){if(s.length<4)throw P.getFormatInstance();let l=s[0];if(l>s.length)throw P.getFormatInstance();if(l===0)if(o<s.length)s[0]=s.length-o;else throw P.getFormatInstance()}static getBitCountForCodeword(s){let o=new Int32Array(8),l=0,d=o.length-1;for(;!((s&1)!==l&&(l=s&1,d--,d<0));)o[d]++,s>>=1;return o}static getCodewordBucketNumber(s){return s instanceof Int32Array?this.getCodewordBucketNumber_Int32Array(s):this.getCodewordBucketNumber_number(s)}static getCodewordBucketNumber_number(s){return Bt.getCodewordBucketNumber(Bt.getBitCountForCodeword(s))}static getCodewordBucketNumber_Int32Array(s){return(s[0]-s[2]+s[4]-s[6]+9)%9}static toString(s){let o=new Er;for(let l=0;l<s.length;l++){o.format("Row %2d: ",l);for(let d=0;d<s[l].length;d++){let m=s[l][d];m.getValue().length===0?o.format("        ",null):o.format("%4d(%2d)",m.getValue()[0],m.getConfidence(m.getValue()[0]))}o.format("%n")}return o.toString()}}Bt.CODEWORD_SKEW_SIZE=2,Bt.MAX_ERRORS=3,Bt.MAX_EC_CODEWORDS=512,Bt.errorCorrection=new Fi;class ts{decode(s,o=null){let l=ts.decode(s,o,!1);if(l==null||l.length===0||l[0]==null)throw me.getNotFoundInstance();return l[0]}decodeMultiple(s,o=null){try{return ts.decode(s,o,!0)}catch(l){throw l instanceof P||l instanceof Y?me.getNotFoundInstance():l}}static decode(s,o,l){const d=new Array,m=Tt.detectMultiple(s,o,l);for(const p of m.getPoints()){const v=Bt.decode(m.getBits(),p[4],p[5],p[6],p[7],ts.getMinCodewordWidth(p),ts.getMaxCodewordWidth(p)),b=new pe(v.getText(),v.getRawBytes(),void 0,p,ie.PDF_417);b.putMetadata(Pe.ERROR_CORRECTION_LEVEL,v.getECLevel());const T=v.getOther();T!=null&&b.putMetadata(Pe.PDF417_EXTRA_METADATA,T),d.push(b)}return d.map(p=>p)}static getMaxWidth(s,o){return s==null||o==null?0:Math.trunc(Math.abs(s.getX()-o.getX()))}static getMinWidth(s,o){return s==null||o==null?ue.MAX_VALUE:Math.trunc(Math.abs(s.getX()-o.getX()))}static getMaxCodewordWidth(s){return Math.floor(Math.max(Math.max(ts.getMaxWidth(s[0],s[4]),ts.getMaxWidth(s[6],s[2])*Et.MODULES_IN_CODEWORD/Et.MODULES_IN_STOP_PATTERN),Math.max(ts.getMaxWidth(s[1],s[5]),ts.getMaxWidth(s[7],s[3])*Et.MODULES_IN_CODEWORD/Et.MODULES_IN_STOP_PATTERN)))}static getMinCodewordWidth(s){return Math.floor(Math.min(Math.min(ts.getMinWidth(s[0],s[4]),ts.getMinWidth(s[6],s[2])*Et.MODULES_IN_CODEWORD/Et.MODULES_IN_STOP_PATTERN),Math.min(ts.getMinWidth(s[1],s[5]),ts.getMinWidth(s[7],s[3])*Et.MODULES_IN_CODEWORD/Et.MODULES_IN_STOP_PATTERN)))}reset(){}}class aa extends E{}aa.kind="ReaderException";class Wo{constructor(s,o){this.verbose=s===!0,o&&this.setHints(o)}decode(s,o){return o&&this.setHints(o),this.decodeInternal(s)}decodeWithState(s){return(this.readers===null||this.readers===void 0)&&this.setHints(null),this.decodeInternal(s)}setHints(s){this.hints=s;const o=!a(s)&&s.get(Ce.TRY_HARDER)===!0,l=a(s)?null:s.get(Ce.POSSIBLE_FORMATS),d=new Array;if(!a(l)){const m=l.some(p=>p===ie.UPC_A||p===ie.UPC_E||p===ie.EAN_13||p===ie.EAN_8||p===ie.CODABAR||p===ie.CODE_39||p===ie.CODE_93||p===ie.CODE_128||p===ie.ITF||p===ie.RSS_14||p===ie.RSS_EXPANDED);m&&!o&&d.push(new Ks(s,this.verbose)),l.includes(ie.QR_CODE)&&d.push(new hi),l.includes(ie.DATA_MATRIX)&&d.push(new oi),l.includes(ie.AZTEC)&&d.push(new Wn),l.includes(ie.PDF_417)&&d.push(new ts),m&&o&&d.push(new Ks(s,this.verbose))}d.length===0&&(o||d.push(new Ks(s,this.verbose)),d.push(new hi),d.push(new oi),d.push(new Wn),d.push(new ts),o&&d.push(new Ks(s,this.verbose))),this.readers=d}reset(){if(this.readers!==null)for(const s of this.readers)s.reset()}decodeInternal(s){if(this.readers===null)throw new aa("No readers where selected, nothing can be read.");for(const o of this.readers)try{return o.decode(s,this.hints)}catch(l){if(l instanceof aa)continue}throw new me("No MultiFormat Readers were able to detect the code.")}}class ir extends ce{constructor(s=null,o=500){const l=new Wo;l.setHints(s),super(l,o)}decodeBitmap(s){return this.reader.decodeWithState(s)}}class Tl extends ce{constructor(s=500){super(new ts,s)}}class Sl extends ce{constructor(s=500){super(new hi,s)}}var Ka;(function(M){M[M.ERROR_CORRECTION=0]="ERROR_CORRECTION",M[M.CHARACTER_SET=1]="CHARACTER_SET",M[M.DATA_MATRIX_SHAPE=2]="DATA_MATRIX_SHAPE",M[M.MIN_SIZE=3]="MIN_SIZE",M[M.MAX_SIZE=4]="MAX_SIZE",M[M.MARGIN=5]="MARGIN",M[M.PDF417_COMPACT=6]="PDF417_COMPACT",M[M.PDF417_COMPACTION=7]="PDF417_COMPACTION",M[M.PDF417_DIMENSIONS=8]="PDF417_DIMENSIONS",M[M.AZTEC_LAYERS=9]="AZTEC_LAYERS",M[M.QR_VERSION=10]="QR_VERSION"})(Ka||(Ka={}));var ns=Ka;class rr{constructor(s){this.field=s,this.cachedGenerators=[],this.cachedGenerators.push(new Le(s,Int32Array.from([1])))}buildGenerator(s){const o=this.cachedGenerators;if(s>=o.length){let l=o[o.length-1];const d=this.field;for(let m=o.length;m<=s;m++){const p=l.multiply(new Le(d,Int32Array.from([1,d.exp(m-1+d.getGeneratorBase())])));o.push(p),l=p}}return o[s]}encode(s,o){if(o===0)throw new I("No error correction bytes");const l=s.length-o;if(l<=0)throw new I("No data bytes provided");const d=this.buildGenerator(o),m=new Int32Array(l);G.arraycopy(s,0,m,0,l);let p=new Le(this.field,m);p=p.multiplyByMonomial(o,1);const b=p.divide(d)[1].getCoefficients(),T=o-b.length;for(let R=0;R<T;R++)s[l+R]=0;G.arraycopy(b,0,s,l+T,b.length)}}class Jt{constructor(){}static applyMaskPenaltyRule1(s){return Jt.applyMaskPenaltyRule1Internal(s,!0)+Jt.applyMaskPenaltyRule1Internal(s,!1)}static applyMaskPenaltyRule2(s){let o=0;const l=s.getArray(),d=s.getWidth(),m=s.getHeight();for(let p=0;p<m-1;p++){const v=l[p];for(let b=0;b<d-1;b++){const T=v[b];T===v[b+1]&&T===l[p+1][b]&&T===l[p+1][b+1]&&o++}}return Jt.N2*o}static applyMaskPenaltyRule3(s){let o=0;const l=s.getArray(),d=s.getWidth(),m=s.getHeight();for(let p=0;p<m;p++)for(let v=0;v<d;v++){const b=l[p];v+6<d&&b[v]===1&&b[v+1]===0&&b[v+2]===1&&b[v+3]===1&&b[v+4]===1&&b[v+5]===0&&b[v+6]===1&&(Jt.isWhiteHorizontal(b,v-4,v)||Jt.isWhiteHorizontal(b,v+7,v+11))&&o++,p+6<m&&l[p][v]===1&&l[p+1][v]===0&&l[p+2][v]===1&&l[p+3][v]===1&&l[p+4][v]===1&&l[p+5][v]===0&&l[p+6][v]===1&&(Jt.isWhiteVertical(l,v,p-4,p)||Jt.isWhiteVertical(l,v,p+7,p+11))&&o++}return o*Jt.N3}static isWhiteHorizontal(s,o,l){o=Math.max(o,0),l=Math.min(l,s.length);for(let d=o;d<l;d++)if(s[d]===1)return!1;return!0}static isWhiteVertical(s,o,l,d){l=Math.max(l,0),d=Math.min(d,s.length);for(let m=l;m<d;m++)if(s[m][o]===1)return!1;return!0}static applyMaskPenaltyRule4(s){let o=0;const l=s.getArray(),d=s.getWidth(),m=s.getHeight();for(let b=0;b<m;b++){const T=l[b];for(let R=0;R<d;R++)T[R]===1&&o++}const p=s.getHeight()*s.getWidth();return Math.floor(Math.abs(o*2-p)*10/p)*Jt.N4}static getDataMaskBit(s,o,l){let d,m;switch(s){case 0:d=l+o&1;break;case 1:d=l&1;break;case 2:d=o%3;break;case 3:d=(l+o)%3;break;case 4:d=Math.floor(l/2)+Math.floor(o/3)&1;break;case 5:m=l*o,d=(m&1)+m%3;break;case 6:m=l*o,d=(m&1)+m%3&1;break;case 7:m=l*o,d=m%3+(l+o&1)&1;break;default:throw new I("Invalid mask pattern: "+s)}return d===0}static applyMaskPenaltyRule1Internal(s,o){let l=0;const d=o?s.getHeight():s.getWidth(),m=o?s.getWidth():s.getHeight(),p=s.getArray();for(let v=0;v<d;v++){let b=0,T=-1;for(let R=0;R<m;R++){const O=o?p[v][R]:p[R][v];O===T?b++:(b>=5&&(l+=Jt.N1+(b-5)),b=1,T=O)}b>=5&&(l+=Jt.N1+(b-5))}return l}}Jt.N1=3,Jt.N2=3,Jt.N3=40,Jt.N4=10;class oa{constructor(s,o){this.width=s,this.height=o;const l=new Array(o);for(let d=0;d!==o;d++)l[d]=new Uint8Array(s);this.bytes=l}getHeight(){return this.height}getWidth(){return this.width}get(s,o){return this.bytes[o][s]}getArray(){return this.bytes}setNumber(s,o,l){this.bytes[o][s]=l}setBoolean(s,o,l){this.bytes[o][s]=l?1:0}clear(s){for(const o of this.bytes)ne.fill(o,s)}equals(s){if(!(s instanceof oa))return!1;const o=s;if(this.width!==o.width||this.height!==o.height)return!1;for(let l=0,d=this.height;l<d;++l){const m=this.bytes[l],p=o.bytes[l];for(let v=0,b=this.width;v<b;++v)if(m[v]!==p[v])return!1}return!0}toString(){const s=new z;for(let o=0,l=this.height;o<l;++o){const d=this.bytes[o];for(let m=0,p=this.width;m<p;++m)switch(d[m]){case 0:s.append(" 0");break;case 1:s.append(" 1");break;default:s.append("  ");break}s.append(`
`)}return s.toString()}}class ar{constructor(){this.maskPattern=-1}getMode(){return this.mode}getECLevel(){return this.ecLevel}getVersion(){return this.version}getMaskPattern(){return this.maskPattern}getMatrix(){return this.matrix}toString(){const s=new z;return s.append(`<<
`),s.append(" mode: "),s.append(this.mode?this.mode.toString():"null"),s.append(`
 ecLevel: `),s.append(this.ecLevel?this.ecLevel.toString():"null"),s.append(`
 version: `),s.append(this.version?this.version.toString():"null"),s.append(`
 maskPattern: `),s.append(this.maskPattern.toString()),this.matrix?(s.append(`
 matrix:
`),s.append(this.matrix.toString())):s.append(`
 matrix: null
`),s.append(`>>
`),s.toString()}setMode(s){this.mode=s}setECLevel(s){this.ecLevel=s}setVersion(s){this.version=s}setMaskPattern(s){this.maskPattern=s}setMatrix(s){this.matrix=s}static isValidMaskPattern(s){return s>=0&&s<ar.NUM_MASK_PATTERNS}}ar.NUM_MASK_PATTERNS=8;class nn extends E{}nn.kind="WriterException";class x{constructor(){}static clearMatrix(s){s.clear(255)}static buildMatrix(s,o,l,d,m){x.clearMatrix(m),x.embedBasicPatterns(l,m),x.embedTypeInfo(o,d,m),x.maybeEmbedVersionInfo(l,m),x.embedDataBits(s,d,m)}static embedBasicPatterns(s,o){x.embedPositionDetectionPatternsAndSeparators(o),x.embedDarkDotAtLeftBottomCorner(o),x.maybeEmbedPositionAdjustmentPatterns(s,o),x.embedTimingPatterns(o)}static embedTypeInfo(s,o,l){const d=new be;x.makeTypeInfoBits(s,o,d);for(let m=0,p=d.getSize();m<p;++m){const v=d.get(d.getSize()-1-m),b=x.TYPE_INFO_COORDINATES[m],T=b[0],R=b[1];if(l.setBoolean(T,R,v),m<8){const O=l.getWidth()-m-1;l.setBoolean(O,8,v)}else{const V=l.getHeight()-7+(m-8);l.setBoolean(8,V,v)}}}static maybeEmbedVersionInfo(s,o){if(s.getVersionNumber()<7)return;const l=new be;x.makeVersionInfoBits(s,l);let d=17;for(let m=0;m<6;++m)for(let p=0;p<3;++p){const v=l.get(d);d--,o.setBoolean(m,o.getHeight()-11+p,v),o.setBoolean(o.getHeight()-11+p,m,v)}}static embedDataBits(s,o,l){let d=0,m=-1,p=l.getWidth()-1,v=l.getHeight()-1;for(;p>0;){for(p===6&&(p-=1);v>=0&&v<l.getHeight();){for(let b=0;b<2;++b){const T=p-b;if(!x.isEmpty(l.get(T,v)))continue;let R;d<s.getSize()?(R=s.get(d),++d):R=!1,o!==255&&Jt.getDataMaskBit(o,T,v)&&(R=!R),l.setBoolean(T,v,R)}v+=m}m=-m,v+=m,p-=2}if(d!==s.getSize())throw new nn("Not all bits consumed: "+d+"/"+s.getSize())}static findMSBSet(s){return 32-ue.numberOfLeadingZeros(s)}static calculateBCHCode(s,o){if(o===0)throw new I("0 polynomial");const l=x.findMSBSet(o);for(s<<=l-1;x.findMSBSet(s)>=l;)s^=o<<x.findMSBSet(s)-l;return s}static makeTypeInfoBits(s,o,l){if(!ar.isValidMaskPattern(o))throw new nn("Invalid mask pattern");const d=s.getBits()<<3|o;l.appendBits(d,5);const m=x.calculateBCHCode(d,x.TYPE_INFO_POLY);l.appendBits(m,10);const p=new be;if(p.appendBits(x.TYPE_INFO_MASK_PATTERN,15),l.xor(p),l.getSize()!==15)throw new nn("should not happen but we got: "+l.getSize())}static makeVersionInfoBits(s,o){o.appendBits(s.getVersionNumber(),6);const l=x.calculateBCHCode(s.getVersionNumber(),x.VERSION_INFO_POLY);if(o.appendBits(l,12),o.getSize()!==18)throw new nn("should not happen but we got: "+o.getSize())}static isEmpty(s){return s===255}static embedTimingPatterns(s){for(let o=8;o<s.getWidth()-8;++o){const l=(o+1)%2;x.isEmpty(s.get(o,6))&&s.setNumber(o,6,l),x.isEmpty(s.get(6,o))&&s.setNumber(6,o,l)}}static embedDarkDotAtLeftBottomCorner(s){if(s.get(8,s.getHeight()-8)===0)throw new nn;s.setNumber(8,s.getHeight()-8,1)}static embedHorizontalSeparationPattern(s,o,l){for(let d=0;d<8;++d){if(!x.isEmpty(l.get(s+d,o)))throw new nn;l.setNumber(s+d,o,0)}}static embedVerticalSeparationPattern(s,o,l){for(let d=0;d<7;++d){if(!x.isEmpty(l.get(s,o+d)))throw new nn;l.setNumber(s,o+d,0)}}static embedPositionAdjustmentPattern(s,o,l){for(let d=0;d<5;++d){const m=x.POSITION_ADJUSTMENT_PATTERN[d];for(let p=0;p<5;++p)l.setNumber(s+p,o+d,m[p])}}static embedPositionDetectionPattern(s,o,l){for(let d=0;d<7;++d){const m=x.POSITION_DETECTION_PATTERN[d];for(let p=0;p<7;++p)l.setNumber(s+p,o+d,m[p])}}static embedPositionDetectionPatternsAndSeparators(s){const o=x.POSITION_DETECTION_PATTERN[0].length;x.embedPositionDetectionPattern(0,0,s),x.embedPositionDetectionPattern(s.getWidth()-o,0,s),x.embedPositionDetectionPattern(0,s.getWidth()-o,s);const l=8;x.embedHorizontalSeparationPattern(0,l-1,s),x.embedHorizontalSeparationPattern(s.getWidth()-l,l-1,s),x.embedHorizontalSeparationPattern(0,s.getWidth()-l,s);const d=7;x.embedVerticalSeparationPattern(d,0,s),x.embedVerticalSeparationPattern(s.getHeight()-d-1,0,s),x.embedVerticalSeparationPattern(d,s.getHeight()-d,s)}static maybeEmbedPositionAdjustmentPatterns(s,o){if(s.getVersionNumber()<2)return;const l=s.getVersionNumber()-1,d=x.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE[l];for(let m=0,p=d.length;m!==p;m++){const v=d[m];if(v>=0)for(let b=0;b!==p;b++){const T=d[b];T>=0&&x.isEmpty(o.get(T,v))&&x.embedPositionAdjustmentPattern(T-2,v-2,o)}}}}x.POSITION_DETECTION_PATTERN=Array.from([Int32Array.from([1,1,1,1,1,1,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,1,1,1,1,1,1])]),x.POSITION_ADJUSTMENT_PATTERN=Array.from([Int32Array.from([1,1,1,1,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,0,1,0,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,1,1,1,1])]),x.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE=Array.from([Int32Array.from([-1,-1,-1,-1,-1,-1,-1]),Int32Array.from([6,18,-1,-1,-1,-1,-1]),Int32Array.from([6,22,-1,-1,-1,-1,-1]),Int32Array.from([6,26,-1,-1,-1,-1,-1]),Int32Array.from([6,30,-1,-1,-1,-1,-1]),Int32Array.from([6,34,-1,-1,-1,-1,-1]),Int32Array.from([6,22,38,-1,-1,-1,-1]),Int32Array.from([6,24,42,-1,-1,-1,-1]),Int32Array.from([6,26,46,-1,-1,-1,-1]),Int32Array.from([6,28,50,-1,-1,-1,-1]),Int32Array.from([6,30,54,-1,-1,-1,-1]),Int32Array.from([6,32,58,-1,-1,-1,-1]),Int32Array.from([6,34,62,-1,-1,-1,-1]),Int32Array.from([6,26,46,66,-1,-1,-1]),Int32Array.from([6,26,48,70,-1,-1,-1]),Int32Array.from([6,26,50,74,-1,-1,-1]),Int32Array.from([6,30,54,78,-1,-1,-1]),Int32Array.from([6,30,56,82,-1,-1,-1]),Int32Array.from([6,30,58,86,-1,-1,-1]),Int32Array.from([6,34,62,90,-1,-1,-1]),Int32Array.from([6,28,50,72,94,-1,-1]),Int32Array.from([6,26,50,74,98,-1,-1]),Int32Array.from([6,30,54,78,102,-1,-1]),Int32Array.from([6,28,54,80,106,-1,-1]),Int32Array.from([6,32,58,84,110,-1,-1]),Int32Array.from([6,30,58,86,114,-1,-1]),Int32Array.from([6,34,62,90,118,-1,-1]),Int32Array.from([6,26,50,74,98,122,-1]),Int32Array.from([6,30,54,78,102,126,-1]),Int32Array.from([6,26,52,78,104,130,-1]),Int32Array.from([6,30,56,82,108,134,-1]),Int32Array.from([6,34,60,86,112,138,-1]),Int32Array.from([6,30,58,86,114,142,-1]),Int32Array.from([6,34,62,90,118,146,-1]),Int32Array.from([6,30,54,78,102,126,150]),Int32Array.from([6,24,50,76,102,128,154]),Int32Array.from([6,28,54,80,106,132,158]),Int32Array.from([6,32,58,84,110,136,162]),Int32Array.from([6,26,54,82,110,138,166]),Int32Array.from([6,30,58,86,114,142,170])]),x.TYPE_INFO_COORDINATES=Array.from([Int32Array.from([8,0]),Int32Array.from([8,1]),Int32Array.from([8,2]),Int32Array.from([8,3]),Int32Array.from([8,4]),Int32Array.from([8,5]),Int32Array.from([8,7]),Int32Array.from([8,8]),Int32Array.from([7,8]),Int32Array.from([5,8]),Int32Array.from([4,8]),Int32Array.from([3,8]),Int32Array.from([2,8]),Int32Array.from([1,8]),Int32Array.from([0,8])]),x.VERSION_INFO_POLY=7973,x.TYPE_INFO_POLY=1335,x.TYPE_INFO_MASK_PATTERN=21522;class N{constructor(s,o){this.dataBytes=s,this.errorCorrectionBytes=o}getDataBytes(){return this.dataBytes}getErrorCorrectionBytes(){return this.errorCorrectionBytes}}class k{constructor(){}static calculateMaskPenalty(s){return Jt.applyMaskPenaltyRule1(s)+Jt.applyMaskPenaltyRule2(s)+Jt.applyMaskPenaltyRule3(s)+Jt.applyMaskPenaltyRule4(s)}static encode(s,o,l=null){let d=k.DEFAULT_BYTE_MODE_ENCODING;const m=l!==null&&l.get(ns.CHARACTER_SET)!==void 0;m&&(d=l.get(ns.CHARACTER_SET).toString());const p=this.chooseMode(s,d),v=new be;if(p===xt.BYTE&&(m||k.DEFAULT_BYTE_MODE_ENCODING!==d)){const Qe=B.getCharacterSetECIByName(d);Qe!==void 0&&this.appendECI(Qe,v)}this.appendModeInfo(p,v);const b=new be;this.appendBytes(s,p,b,d);let T;if(l!==null&&l.get(ns.QR_VERSION)!==void 0){const Qe=Number.parseInt(l.get(ns.QR_VERSION).toString(),10);T=ut.getVersionForNumber(Qe);const Xe=this.calculateBitsNeeded(p,v,b,T);if(!this.willFit(Xe,T,o))throw new nn("Data too big for requested version")}else T=this.recommendVersion(o,p,v,b);const R=new be;R.appendBitArray(v);const O=p===xt.BYTE?b.getSizeInBytes():s.length;this.appendLengthInfo(O,T,p,R),R.appendBitArray(b);const V=T.getECBlocksForLevel(o),K=T.getTotalCodewords()-V.getTotalECCodewords();this.terminateBits(K,R);const le=this.interleaveWithECBytes(R,T.getTotalCodewords(),K,V.getNumBlocks()),he=new ar;he.setECLevel(o),he.setMode(p),he.setVersion(T);const we=T.getDimensionForVersion(),De=new oa(we,we),$e=this.chooseMaskPattern(le,o,T,De);return he.setMaskPattern($e),x.buildMatrix(le,o,T,$e,De),he.setMatrix(De),he}static recommendVersion(s,o,l,d){const m=this.calculateBitsNeeded(o,l,d,ut.getVersionForNumber(1)),p=this.chooseVersion(m,s),v=this.calculateBitsNeeded(o,l,d,p);return this.chooseVersion(v,s)}static calculateBitsNeeded(s,o,l,d){return o.getSize()+s.getCharacterCountBits(d)+l.getSize()}static getAlphanumericCode(s){return s<k.ALPHANUMERIC_TABLE.length?k.ALPHANUMERIC_TABLE[s]:-1}static chooseMode(s,o=null){if(B.SJIS.getName()===o&&this.isOnlyDoubleByteKanji(s))return xt.KANJI;let l=!1,d=!1;for(let m=0,p=s.length;m<p;++m){const v=s.charAt(m);if(k.isDigit(v))l=!0;else if(this.getAlphanumericCode(v.charCodeAt(0))!==-1)d=!0;else return xt.BYTE}return d?xt.ALPHANUMERIC:l?xt.NUMERIC:xt.BYTE}static isOnlyDoubleByteKanji(s){let o;try{o=Z.encode(s,B.SJIS)}catch{return!1}const l=o.length;if(l%2!==0)return!1;for(let d=0;d<l;d+=2){const m=o[d]&255;if((m<129||m>159)&&(m<224||m>235))return!1}return!0}static chooseMaskPattern(s,o,l,d){let m=Number.MAX_SAFE_INTEGER,p=-1;for(let v=0;v<ar.NUM_MASK_PATTERNS;v++){x.buildMatrix(s,o,l,v,d);let b=this.calculateMaskPenalty(d);b<m&&(m=b,p=v)}return p}static chooseVersion(s,o){for(let l=1;l<=40;l++){const d=ut.getVersionForNumber(l);if(k.willFit(s,d,o))return d}throw new nn("Data too big")}static willFit(s,o,l){const d=o.getTotalCodewords(),p=o.getECBlocksForLevel(l).getTotalECCodewords(),v=d-p,b=(s+7)/8;return v>=b}static terminateBits(s,o){const l=s*8;if(o.getSize()>l)throw new nn("data bits cannot fit in the QR Code"+o.getSize()+" > "+l);for(let p=0;p<4&&o.getSize()<l;++p)o.appendBit(!1);const d=o.getSize()&7;if(d>0)for(let p=d;p<8;p++)o.appendBit(!1);const m=s-o.getSizeInBytes();for(let p=0;p<m;++p)o.appendBits((p&1)===0?236:17,8);if(o.getSize()!==l)throw new nn("Bits size does not equal capacity")}static getNumDataBytesAndNumECBytesForBlockID(s,o,l,d,m,p){if(d>=l)throw new nn("Block ID too large");const v=s%l,b=l-v,T=Math.floor(s/l),R=T+1,O=Math.floor(o/l),V=O+1,K=T-O,le=R-V;if(K!==le)throw new nn("EC bytes mismatch");if(l!==b+v)throw new nn("RS blocks mismatch");if(s!==(O+K)*b+(V+le)*v)throw new nn("Total bytes mismatch");d<b?(m[0]=O,p[0]=K):(m[0]=V,p[0]=le)}static interleaveWithECBytes(s,o,l,d){if(s.getSizeInBytes()!==l)throw new nn("Number of bits and data bytes does not match");let m=0,p=0,v=0;const b=new Array;for(let R=0;R<d;++R){const O=new Int32Array(1),V=new Int32Array(1);k.getNumDataBytesAndNumECBytesForBlockID(o,l,d,R,O,V);const K=O[0],le=new Uint8Array(K);s.toBytes(8*m,le,0,K);const he=k.generateECBytes(le,V[0]);b.push(new N(le,he)),p=Math.max(p,K),v=Math.max(v,he.length),m+=O[0]}if(l!==m)throw new nn("Data bytes does not match offset");const T=new be;for(let R=0;R<p;++R)for(const O of b){const V=O.getDataBytes();R<V.length&&T.appendBits(V[R],8)}for(let R=0;R<v;++R)for(const O of b){const V=O.getErrorCorrectionBytes();R<V.length&&T.appendBits(V[R],8)}if(o!==T.getSizeInBytes())throw new nn("Interleaving error: "+o+" and "+T.getSizeInBytes()+" differ.");return T}static generateECBytes(s,o){const l=s.length,d=new Int32Array(l+o);for(let p=0;p<l;p++)d[p]=s[p]&255;new rr(wt.QR_CODE_FIELD_256).encode(d,o);const m=new Uint8Array(o);for(let p=0;p<o;p++)m[p]=d[l+p];return m}static appendModeInfo(s,o){o.appendBits(s.getBits(),4)}static appendLengthInfo(s,o,l,d){const m=l.getCharacterCountBits(o);if(s>=1<<m)throw new nn(s+" is bigger than "+((1<<m)-1));d.appendBits(s,m)}static appendBytes(s,o,l,d){switch(o){case xt.NUMERIC:k.appendNumericBytes(s,l);break;case xt.ALPHANUMERIC:k.appendAlphanumericBytes(s,l);break;case xt.BYTE:k.append8BitBytes(s,l,d);break;case xt.KANJI:k.appendKanjiBytes(s,l);break;default:throw new nn("Invalid mode: "+o)}}static getDigit(s){return s.charCodeAt(0)-48}static isDigit(s){const o=k.getDigit(s);return o>=0&&o<=9}static appendNumericBytes(s,o){const l=s.length;let d=0;for(;d<l;){const m=k.getDigit(s.charAt(d));if(d+2<l){const p=k.getDigit(s.charAt(d+1)),v=k.getDigit(s.charAt(d+2));o.appendBits(m*100+p*10+v,10),d+=3}else if(d+1<l){const p=k.getDigit(s.charAt(d+1));o.appendBits(m*10+p,7),d+=2}else o.appendBits(m,4),d++}}static appendAlphanumericBytes(s,o){const l=s.length;let d=0;for(;d<l;){const m=k.getAlphanumericCode(s.charCodeAt(d));if(m===-1)throw new nn;if(d+1<l){const p=k.getAlphanumericCode(s.charCodeAt(d+1));if(p===-1)throw new nn;o.appendBits(m*45+p,11),d+=2}else o.appendBits(m,6),d++}}static append8BitBytes(s,o,l){let d;try{d=Z.encode(s,l)}catch(m){throw new nn(m)}for(let m=0,p=d.length;m!==p;m++){const v=d[m];o.appendBits(v,8)}}static appendKanjiBytes(s,o){let l;try{l=Z.encode(s,B.SJIS)}catch(m){throw new nn(m)}const d=l.length;for(let m=0;m<d;m+=2){const p=l[m]&255,v=l[m+1]&255,b=p<<8&4294967295|v;let T=-1;if(b>=33088&&b<=40956?T=b-33088:b>=57408&&b<=60351&&(T=b-49472),T===-1)throw new nn("Invalid byte sequence");const R=(T>>8)*192+(T&255);o.appendBits(R,13)}}static appendECI(s,o){o.appendBits(xt.ECI.getBits(),4),o.appendBits(s.getValue(),8)}}k.ALPHANUMERIC_TABLE=Int32Array.from([-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,36,-1,-1,-1,37,38,-1,-1,-1,-1,39,40,-1,41,42,43,0,1,2,3,4,5,6,7,8,9,44,-1,-1,-1,-1,-1,-1,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,-1,-1,-1,-1,-1]),k.DEFAULT_BYTE_MODE_ENCODING=B.UTF8.getName();class q{write(s,o,l,d=null){if(s.length===0)throw new I("Found empty contents");if(o<0||l<0)throw new I("Requested dimensions are too small: "+o+"x"+l);let m=Wt.L,p=q.QUIET_ZONE_SIZE;d!==null&&(d.get(ns.ERROR_CORRECTION)!==void 0&&(m=Wt.fromString(d.get(ns.ERROR_CORRECTION).toString())),d.get(ns.MARGIN)!==void 0&&(p=Number.parseInt(d.get(ns.MARGIN).toString(),10)));const v=k.encode(s,m,d);return this.renderResult(v,o,l,p)}writeToDom(s,o,l,d,m=null){typeof s=="string"&&(s=document.querySelector(s));const p=this.write(o,l,d,m);s&&s.appendChild(p)}renderResult(s,o,l,d){const m=s.getMatrix();if(m===null)throw new zt;const p=m.getWidth(),v=m.getHeight(),b=p+d*2,T=v+d*2,R=Math.max(o,b),O=Math.max(l,T),V=Math.min(Math.floor(R/b),Math.floor(O/T)),K=Math.floor((R-p*V)/2),le=Math.floor((O-v*V)/2),he=this.createSVGElement(R,O);for(let we=0,De=le;we<v;we++,De+=V)for(let $e=0,Qe=K;$e<p;$e++,Qe+=V)if(m.get($e,we)===1){const Xe=this.createSvgRectElement(Qe,De,V,V);he.appendChild(Xe)}return he}createSVGElement(s,o){const l=document.createElementNS(q.SVG_NS,"svg");return l.setAttributeNS(null,"height",s.toString()),l.setAttributeNS(null,"width",o.toString()),l}createSvgRectElement(s,o,l,d){const m=document.createElementNS(q.SVG_NS,"rect");return m.setAttributeNS(null,"x",s.toString()),m.setAttributeNS(null,"y",o.toString()),m.setAttributeNS(null,"height",l.toString()),m.setAttributeNS(null,"width",d.toString()),m.setAttributeNS(null,"fill","#000000"),m}}q.QUIET_ZONE_SIZE=4,q.SVG_NS="http://www.w3.org/2000/svg";class ve{encode(s,o,l,d,m){if(s.length===0)throw new I("Found empty contents");if(o!==ie.QR_CODE)throw new I("Can only encode QR_CODE, but got "+o);if(l<0||d<0)throw new I(`Requested dimensions are too small: ${l}x${d}`);let p=Wt.L,v=ve.QUIET_ZONE_SIZE;m!==null&&(m.get(ns.ERROR_CORRECTION)!==void 0&&(p=Wt.fromString(m.get(ns.ERROR_CORRECTION).toString())),m.get(ns.MARGIN)!==void 0&&(v=Number.parseInt(m.get(ns.MARGIN).toString(),10)));const b=k.encode(s,p,m);return ve.renderResult(b,l,d,v)}static renderResult(s,o,l,d){const m=s.getMatrix();if(m===null)throw new zt;const p=m.getWidth(),v=m.getHeight(),b=p+d*2,T=v+d*2,R=Math.max(o,b),O=Math.max(l,T),V=Math.min(Math.floor(R/b),Math.floor(O/T)),K=Math.floor((R-p*V)/2),le=Math.floor((O-v*V)/2),he=new Ye(R,O);for(let we=0,De=le;we<v;we++,De+=V)for(let $e=0,Qe=K;$e<p;$e++,Qe+=V)m.get($e,we)===1&&he.setRegion(Qe,De,V,V);return he}}ve.QUIET_ZONE_SIZE=4;class ke{encode(s,o,l,d,m){let p;if(o===ie.QR_CODE)p=new ve;else throw new I("No encoder available for format "+o);return p.encode(s,o,l,d,m)}}class Je extends He{constructor(s,o,l,d,m,p,v,b){if(super(p,v),this.yuvData=s,this.dataWidth=o,this.dataHeight=l,this.left=d,this.top=m,d+p>o||m+v>l)throw new I("Crop rectangle does not fit within image data.");b&&this.reverseHorizontal(p,v)}getRow(s,o){if(s<0||s>=this.getHeight())throw new I("Requested row is outside the image: "+s);const l=this.getWidth();(o==null||o.length<l)&&(o=new Uint8ClampedArray(l));const d=(s+this.top)*this.dataWidth+this.left;return G.arraycopy(this.yuvData,d,o,0,l),o}getMatrix(){const s=this.getWidth(),o=this.getHeight();if(s===this.dataWidth&&o===this.dataHeight)return this.yuvData;const l=s*o,d=new Uint8ClampedArray(l);let m=this.top*this.dataWidth+this.left;if(s===this.dataWidth)return G.arraycopy(this.yuvData,m,d,0,l),d;for(let p=0;p<o;p++){const v=p*s;G.arraycopy(this.yuvData,m,d,v,s),m+=this.dataWidth}return d}isCropSupported(){return!0}crop(s,o,l,d){return new Je(this.yuvData,this.dataWidth,this.dataHeight,this.left+s,this.top+o,l,d,!1)}renderThumbnail(){const s=this.getWidth()/Je.THUMBNAIL_SCALE_FACTOR,o=this.getHeight()/Je.THUMBNAIL_SCALE_FACTOR,l=new Int32Array(s*o),d=this.yuvData;let m=this.top*this.dataWidth+this.left;for(let p=0;p<o;p++){const v=p*s;for(let b=0;b<s;b++){const T=d[m+b*Je.THUMBNAIL_SCALE_FACTOR]&255;l[v+b]=4278190080|T*65793}m+=this.dataWidth*Je.THUMBNAIL_SCALE_FACTOR}return l}getThumbnailWidth(){return this.getWidth()/Je.THUMBNAIL_SCALE_FACTOR}getThumbnailHeight(){return this.getHeight()/Je.THUMBNAIL_SCALE_FACTOR}reverseHorizontal(s,o){const l=this.yuvData;for(let d=0,m=this.top*this.dataWidth+this.left;d<o;d++,m+=this.dataWidth){const p=m+s/2;for(let v=m,b=m+s-1;v<p;v++,b--){const T=l[v];l[v]=l[b],l[b]=T}}}invert(){return new Ne(this)}}Je.THUMBNAIL_SCALE_FACTOR=2;class Mt extends He{constructor(s,o,l,d,m,p,v){if(super(o,l),this.dataWidth=d,this.dataHeight=m,this.left=p,this.top=v,s.BYTES_PER_ELEMENT===4){const b=o*l,T=new Uint8ClampedArray(b);for(let R=0;R<b;R++){const O=s[R],V=O>>16&255,K=O>>7&510,le=O&255;T[R]=(V+K+le)/4&255}this.luminances=T}else this.luminances=s;if(d===void 0&&(this.dataWidth=o),m===void 0&&(this.dataHeight=l),p===void 0&&(this.left=0),v===void 0&&(this.top=0),this.left+o>this.dataWidth||this.top+l>this.dataHeight)throw new I("Crop rectangle does not fit within image data.")}getRow(s,o){if(s<0||s>=this.getHeight())throw new I("Requested row is outside the image: "+s);const l=this.getWidth();(o==null||o.length<l)&&(o=new Uint8ClampedArray(l));const d=(s+this.top)*this.dataWidth+this.left;return G.arraycopy(this.luminances,d,o,0,l),o}getMatrix(){const s=this.getWidth(),o=this.getHeight();if(s===this.dataWidth&&o===this.dataHeight)return this.luminances;const l=s*o,d=new Uint8ClampedArray(l);let m=this.top*this.dataWidth+this.left;if(s===this.dataWidth)return G.arraycopy(this.luminances,m,d,0,l),d;for(let p=0;p<o;p++){const v=p*s;G.arraycopy(this.luminances,m,d,v,s),m+=this.dataWidth}return d}isCropSupported(){return!0}crop(s,o,l,d){return new Mt(this.luminances,l,d,this.dataWidth,this.dataHeight,this.left+s,this.top+o)}invert(){return new Ne(this)}}class ss extends B{static forName(s){return this.getCharacterSetECIByName(s)}}class mn{}mn.ISO_8859_1=B.ISO8859_1;class Un{isCompact(){return this.compact}setCompact(s){this.compact=s}getSize(){return this.size}setSize(s){this.size=s}getLayers(){return this.layers}setLayers(s){this.layers=s}getCodeWords(){return this.codeWords}setCodeWords(s){this.codeWords=s}getMatrix(){return this.matrix}setMatrix(s){this.matrix=s}}class wi{static singletonList(s){return[s]}static min(s,o){return s.sort(o)[0]}}class or{constructor(s){this.previous=s}getPrevious(){return this.previous}}class qs extends or{constructor(s,o,l){super(s),this.value=o,this.bitCount=l}appendTo(s,o){s.appendBits(this.value,this.bitCount)}add(s,o){return new qs(this,s,o)}addBinaryShift(s,o){return console.warn("addBinaryShift on SimpleToken, this simply returns a copy of this token"),new qs(this,s,o)}toString(){let s=this.value&(1<<this.bitCount)-1;return s|=1<<this.bitCount,"<"+ue.toBinaryString(s|1<<this.bitCount).substring(1)+">"}}class bi extends qs{constructor(s,o,l){super(s,0,0),this.binaryShiftStart=o,this.binaryShiftByteCount=l}appendTo(s,o){for(let l=0;l<this.binaryShiftByteCount;l++)(l===0||l===31&&this.binaryShiftByteCount<=62)&&(s.appendBits(31,5),this.binaryShiftByteCount>62?s.appendBits(this.binaryShiftByteCount-31,16):l===0?s.appendBits(Math.min(this.binaryShiftByteCount,31),5):s.appendBits(this.binaryShiftByteCount-31,5)),s.appendBits(o[this.binaryShiftStart+l],8)}addBinaryShift(s,o){return new bi(this,s,o)}toString(){return"<"+this.binaryShiftStart+"::"+(this.binaryShiftStart+this.binaryShiftByteCount-1)+">"}}function la(M,s,o){return new bi(M,s,o)}function lr(M,s,o){return new qs(M,s,o)}const Qa=["UPPER","LOWER","DIGIT","MIXED","PUNCT"],zr=0,Nl=1,Ri=2,Mc=3,Gi=4,Yo=new qs(null,0,0),ca=[Int32Array.from([0,(5<<16)+28,(5<<16)+30,(5<<16)+29,656318]),Int32Array.from([(9<<16)+480+14,0,(5<<16)+30,(5<<16)+29,656318]),Int32Array.from([(4<<16)+14,(9<<16)+448+28,0,(9<<16)+448+29,932798]),Int32Array.from([(5<<16)+29,(5<<16)+28,656318,0,(5<<16)+30]),Int32Array.from([(5<<16)+31,656380,656382,656381,0])];function If(M){for(let s of M)ne.fill(s,-1);return M[zr][Gi]=0,M[Nl][Gi]=0,M[Nl][zr]=28,M[Mc][Gi]=0,M[Ri][Gi]=0,M[Ri][zr]=15,M}const Xo=If(ne.createInt32Array(6,6));class qi{constructor(s,o,l,d){this.token=s,this.mode=o,this.binaryShiftByteCount=l,this.bitCount=d}getMode(){return this.mode}getToken(){return this.token}getBinaryShiftByteCount(){return this.binaryShiftByteCount}getBitCount(){return this.bitCount}latchAndAppend(s,o){let l=this.bitCount,d=this.token;if(s!==this.mode){let p=ca[this.mode][s];d=lr(d,p&65535,p>>16),l+=p>>16}let m=s===Ri?4:5;return d=lr(d,o,m),new qi(d,s,0,l+m)}shiftAndAppend(s,o){let l=this.token,d=this.mode===Ri?4:5;return l=lr(l,Xo[this.mode][s],d),l=lr(l,o,5),new qi(l,this.mode,0,this.bitCount+d+5)}addBinaryShiftChar(s){let o=this.token,l=this.mode,d=this.bitCount;if(this.mode===Gi||this.mode===Ri){let v=ca[l][zr];o=lr(o,v&65535,v>>16),d+=v>>16,l=zr}let m=this.binaryShiftByteCount===0||this.binaryShiftByteCount===31?18:this.binaryShiftByteCount===62?9:8,p=new qi(o,l,this.binaryShiftByteCount+1,d+m);return p.binaryShiftByteCount===2078&&(p=p.endBinaryShift(s+1)),p}endBinaryShift(s){if(this.binaryShiftByteCount===0)return this;let o=this.token;return o=la(o,s-this.binaryShiftByteCount,this.binaryShiftByteCount),new qi(o,this.mode,0,this.bitCount)}isBetterThanOrEqualTo(s){let o=this.bitCount+(ca[this.mode][s.mode]>>16);return this.binaryShiftByteCount<s.binaryShiftByteCount?o+=qi.calculateBinaryShiftCost(s)-qi.calculateBinaryShiftCost(this):this.binaryShiftByteCount>s.binaryShiftByteCount&&s.binaryShiftByteCount>0&&(o+=10),o<=s.bitCount}toBitArray(s){let o=[];for(let d=this.endBinaryShift(s.length).token;d!==null;d=d.getPrevious())o.unshift(d);let l=new be;for(const d of o)d.appendTo(l,s);return l}toString(){return Q.format("%s bits=%d bytes=%d",Qa[this.mode],this.bitCount,this.binaryShiftByteCount)}static calculateBinaryShiftCost(s){return s.binaryShiftByteCount>62?21:s.binaryShiftByteCount>31?20:s.binaryShiftByteCount>0?10:0}}qi.INITIAL_STATE=new qi(Yo,zr,0,0);function ih(M){const s=Q.getCharCode(" "),o=Q.getCharCode("."),l=Q.getCharCode(",");M[zr][s]=1;const d=Q.getCharCode("Z"),m=Q.getCharCode("A");for(let V=m;V<=d;V++)M[zr][V]=V-m+2;M[Nl][s]=1;const p=Q.getCharCode("z"),v=Q.getCharCode("a");for(let V=v;V<=p;V++)M[Nl][V]=V-v+2;M[Ri][s]=1;const b=Q.getCharCode("9"),T=Q.getCharCode("0");for(let V=T;V<=b;V++)M[Ri][V]=V-T+2;M[Ri][l]=12,M[Ri][o]=13;const R=["\0"," ","","","","","","","\x07","\b","	",`
`,"\v","\f","\r","\x1B","","","","","@","\\","^","_","`","|","~",""];for(let V=0;V<R.length;V++)M[Mc][Q.getCharCode(R[V])]=V;const O=["\0","\r","\0","\0","\0","\0","!","'","#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}"];for(let V=0;V<O.length;V++)Q.getCharCode(O[V])>0&&(M[Gi][Q.getCharCode(O[V])]=V);return M}const Ko=ih(ne.createInt32Array(5,256));class ua{constructor(s){this.text=s}encode(){const s=Q.getCharCode(" "),o=Q.getCharCode(`
`);let l=wi.singletonList(qi.INITIAL_STATE);for(let m=0;m<this.text.length;m++){let p,v=m+1<this.text.length?this.text[m+1]:0;switch(this.text[m]){case Q.getCharCode("\r"):p=v===o?2:0;break;case Q.getCharCode("."):p=v===s?3:0;break;case Q.getCharCode(","):p=v===s?4:0;break;case Q.getCharCode(":"):p=v===s?5:0;break;default:p=0}p>0?(l=ua.updateStateListForPair(l,m,p),m++):l=this.updateStateListForChar(l,m)}return wi.min(l,(m,p)=>m.getBitCount()-p.getBitCount()).toBitArray(this.text)}updateStateListForChar(s,o){const l=[];for(let d of s)this.updateStateForChar(d,o,l);return ua.simplifyStates(l)}updateStateForChar(s,o,l){let d=this.text[o]&255,m=Ko[s.getMode()][d]>0,p=null;for(let v=0;v<=Gi;v++){let b=Ko[v][d];if(b>0){if(p==null&&(p=s.endBinaryShift(o)),!m||v===s.getMode()||v===Ri){const T=p.latchAndAppend(v,b);l.push(T)}if(!m&&Xo[s.getMode()][v]>=0){const T=p.shiftAndAppend(v,b);l.push(T)}}}if(s.getBinaryShiftByteCount()>0||Ko[s.getMode()][d]===0){let v=s.addBinaryShiftChar(o);l.push(v)}}static updateStateListForPair(s,o,l){const d=[];for(let m of s)this.updateStateForPair(m,o,l,d);return this.simplifyStates(d)}static updateStateForPair(s,o,l,d){let m=s.endBinaryShift(o);if(d.push(m.latchAndAppend(Gi,l)),s.getMode()!==Gi&&d.push(m.shiftAndAppend(Gi,l)),l===3||l===4){let p=m.latchAndAppend(Ri,16-l).latchAndAppend(Ri,1);d.push(p)}if(s.getBinaryShiftByteCount()>0){let p=s.addBinaryShiftChar(o).addBinaryShiftChar(o+1);d.push(p)}}static simplifyStates(s){let o=[];for(const l of s){let d=!0;for(const m of o){if(m.isBetterThanOrEqualTo(l)){d=!1;break}l.isBetterThanOrEqualTo(m)&&(o=o.filter(p=>p!==m))}d&&o.push(l)}return o}}class on{constructor(){}static encodeBytes(s){return on.encode(s,on.DEFAULT_EC_PERCENT,on.DEFAULT_AZTEC_LAYERS)}static encode(s,o,l){let d=new ua(s).encode(),m=ue.truncDivision(d.getSize()*o,100)+11,p=d.getSize()+m,v,b,T,R,O;if(l!==on.DEFAULT_AZTEC_LAYERS){if(v=l<0,b=Math.abs(l),b>(v?on.MAX_NB_BITS_COMPACT:on.MAX_NB_BITS))throw new I(Q.format("Illegal value %s for layers",l));T=on.totalBitsInLayer(b,v),R=on.WORD_SIZE[b];let Xe=T-T%R;if(O=on.stuffBits(d,R),O.getSize()+m>Xe)throw new I("Data to large for user specified layer");if(v&&O.getSize()>R*64)throw new I("Data to large for user specified layer")}else{R=0,O=null;for(let Xe=0;;Xe++){if(Xe>on.MAX_NB_BITS)throw new I("Data too large for an Aztec code");if(v=Xe<=3,b=v?Xe+1:Xe,T=on.totalBitsInLayer(b,v),p>T)continue;(O==null||R!==on.WORD_SIZE[b])&&(R=on.WORD_SIZE[b],O=on.stuffBits(d,R));let Kt=T-T%R;if(!(v&&O.getSize()>R*64)&&O.getSize()+m<=Kt)break}}let V=on.generateCheckWords(O,T,R),K=O.getSize()/R,le=on.generateModeMessage(v,b,K),he=(v?11:14)+b*4,we=new Int32Array(he),De;if(v){De=he;for(let Xe=0;Xe<we.length;Xe++)we[Xe]=Xe}else{De=he+1+2*ue.truncDivision(ue.truncDivision(he,2)-1,15);let Xe=ue.truncDivision(he,2),Kt=ue.truncDivision(De,2);for(let jt=0;jt<Xe;jt++){let ms=jt+ue.truncDivision(jt,15);we[Xe-jt-1]=Kt-ms-1,we[Xe+jt]=Kt+ms+1}}let $e=new Ye(De);for(let Xe=0,Kt=0;Xe<b;Xe++){let jt=(b-Xe)*4+(v?9:12);for(let ms=0;ms<jt;ms++){let Di=ms*2;for(let $s=0;$s<2;$s++)V.get(Kt+Di+$s)&&$e.set(we[Xe*2+$s],we[Xe*2+ms]),V.get(Kt+jt*2+Di+$s)&&$e.set(we[Xe*2+ms],we[he-1-Xe*2-$s]),V.get(Kt+jt*4+Di+$s)&&$e.set(we[he-1-Xe*2-$s],we[he-1-Xe*2-ms]),V.get(Kt+jt*6+Di+$s)&&$e.set(we[he-1-Xe*2-ms],we[Xe*2+$s])}Kt+=jt*8}if(on.drawModeMessage($e,v,De,le),v)on.drawBullsEye($e,ue.truncDivision(De,2),5);else{on.drawBullsEye($e,ue.truncDivision(De,2),7);for(let Xe=0,Kt=0;Xe<ue.truncDivision(he,2)-1;Xe+=15,Kt+=16)for(let jt=ue.truncDivision(De,2)&1;jt<De;jt+=2)$e.set(ue.truncDivision(De,2)-Kt,jt),$e.set(ue.truncDivision(De,2)+Kt,jt),$e.set(jt,ue.truncDivision(De,2)-Kt),$e.set(jt,ue.truncDivision(De,2)+Kt)}let Qe=new Un;return Qe.setCompact(v),Qe.setSize(De),Qe.setLayers(b),Qe.setCodeWords(K),Qe.setMatrix($e),Qe}static drawBullsEye(s,o,l){for(let d=0;d<l;d+=2)for(let m=o-d;m<=o+d;m++)s.set(m,o-d),s.set(m,o+d),s.set(o-d,m),s.set(o+d,m);s.set(o-l,o-l),s.set(o-l+1,o-l),s.set(o-l,o-l+1),s.set(o+l,o-l),s.set(o+l,o-l+1),s.set(o+l,o+l-1)}static generateModeMessage(s,o,l){let d=new be;return s?(d.appendBits(o-1,2),d.appendBits(l-1,6),d=on.generateCheckWords(d,28,4)):(d.appendBits(o-1,5),d.appendBits(l-1,11),d=on.generateCheckWords(d,40,4)),d}static drawModeMessage(s,o,l,d){let m=ue.truncDivision(l,2);if(o)for(let p=0;p<7;p++){let v=m-3+p;d.get(p)&&s.set(v,m-5),d.get(p+7)&&s.set(m+5,v),d.get(20-p)&&s.set(v,m+5),d.get(27-p)&&s.set(m-5,v)}else for(let p=0;p<10;p++){let v=m-5+p+ue.truncDivision(p,5);d.get(p)&&s.set(v,m-7),d.get(p+10)&&s.set(m+7,v),d.get(29-p)&&s.set(v,m+7),d.get(39-p)&&s.set(m-7,v)}}static generateCheckWords(s,o,l){let d=s.getSize()/l,m=new rr(on.getGF(l)),p=ue.truncDivision(o,l),v=on.bitsToWords(s,l,p);m.encode(v,p-d);let b=o%l,T=new be;T.appendBits(0,b);for(const R of Array.from(v))T.appendBits(R,l);return T}static bitsToWords(s,o,l){let d=new Int32Array(l),m,p;for(m=0,p=s.getSize()/o;m<p;m++){let v=0;for(let b=0;b<o;b++)v|=s.get(m*o+b)?1<<o-b-1:0;d[m]=v}return d}static getGF(s){switch(s){case 4:return wt.AZTEC_PARAM;case 6:return wt.AZTEC_DATA_6;case 8:return wt.AZTEC_DATA_8;case 10:return wt.AZTEC_DATA_10;case 12:return wt.AZTEC_DATA_12;default:throw new I("Unsupported word size "+s)}}static stuffBits(s,o){let l=new be,d=s.getSize(),m=(1<<o)-2;for(let p=0;p<d;p+=o){let v=0;for(let b=0;b<o;b++)(p+b>=d||s.get(p+b))&&(v|=1<<o-1-b);(v&m)===m?(l.appendBits(v&m,o),p--):(v&m)===0?(l.appendBits(v|1,o),p--):l.appendBits(v,o)}return l}static totalBitsInLayer(s,o){return((o?88:112)+16*s)*s}}on.DEFAULT_EC_PERCENT=33,on.DEFAULT_AZTEC_LAYERS=0,on.MAX_NB_BITS=32,on.MAX_NB_BITS_COMPACT=4,on.WORD_SIZE=Int32Array.from([4,6,6,8,8,8,8,8,8,10,10,10,10,10,10,10,10,10,10,10,10,10,10,12,12,12,12,12,12,12,12,12,12]);class Qo{encode(s,o,l,d){return this.encodeWithHints(s,o,l,d,null)}encodeWithHints(s,o,l,d,m){let p=mn.ISO_8859_1,v=on.DEFAULT_EC_PERCENT,b=on.DEFAULT_AZTEC_LAYERS;return m!=null&&(m.has(ns.CHARACTER_SET)&&(p=ss.forName(m.get(ns.CHARACTER_SET).toString())),m.has(ns.ERROR_CORRECTION)&&(v=ue.parseInt(m.get(ns.ERROR_CORRECTION).toString())),m.has(ns.AZTEC_LAYERS)&&(b=ue.parseInt(m.get(ns.AZTEC_LAYERS).toString()))),Qo.encodeLayers(s,o,l,d,p,v,b)}static encodeLayers(s,o,l,d,m,p,v){if(o!==ie.AZTEC)throw new I("Can only encode AZTEC, but got "+o);let b=on.encode(Q.getBytes(s,m),p,v);return Qo.renderResult(b,l,d)}static renderResult(s,o,l){let d=s.getMatrix();if(d==null)throw new zt;let m=d.getWidth(),p=d.getHeight(),v=Math.max(o,m),b=Math.max(l,p),T=Math.min(v/m,b/p),R=(v-m*T)/2,O=(b-p*T)/2,V=new Ye(v,b);for(let K=0,le=O;K<p;K++,le+=T)for(let he=0,we=R;he<m;he++,we+=T)d.get(he,K)&&V.setRegion(we,le,T,T);return V}}t.AbstractExpandedDecoder=yt,t.ArgumentException=S,t.ArithmeticException=qt,t.AztecCode=Un,t.AztecCodeReader=Wn,t.AztecCodeWriter=Qo,t.AztecDecoder=mt,t.AztecDetector=xs,t.AztecDetectorResult=Ot,t.AztecEncoder=on,t.AztecHighLevelEncoder=ua,t.AztecPoint=vn,t.BarcodeFormat=ie,t.Binarizer=X,t.BinaryBitmap=j,t.BitArray=be,t.BitMatrix=Ye,t.BitSource=es,t.BrowserAztecCodeReader=Cs,t.BrowserBarcodeReader=Ho,t.BrowserCodeReader=ce,t.BrowserDatamatrixCodeReader=nr,t.BrowserMultiFormatReader=ir,t.BrowserPDF417Reader=Tl,t.BrowserQRCodeReader=Sl,t.BrowserQRCodeSvgWriter=q,t.CharacterSetECI=B,t.ChecksumException=Y,t.Code128Reader=We,t.Code39Reader=en,t.DataMatrixDecodedBitStreamParser=Zs,t.DataMatrixReader=oi,t.DecodeHintType=Ce,t.DecoderResult=it,t.DefaultGridSampler=Zn,t.DetectorResult=et,t.EAN13Reader=fn,t.EncodeHintType=ns,t.Exception=E,t.FormatException=P,t.GenericGF=wt,t.GenericGFPoly=Le,t.GlobalHistogramBinarizer=te,t.GridSampler=xn,t.GridSamplerInstance=Vn,t.HTMLCanvasElementLuminanceSource=tt,t.HybridBinarizer=ge,t.ITFReader=Ct,t.IllegalArgumentException=I,t.IllegalStateException=zt,t.InvertedLuminanceSource=Ne,t.LuminanceSource=He,t.MathUtils=at,t.MultiFormatOneDReader=Ks,t.MultiFormatReader=Wo,t.MultiFormatWriter=ke,t.NotFoundException=me,t.OneDReader=Qt,t.PDF417DecodedBitStreamParser=Ie,t.PDF417DecoderErrorCorrection=Fi,t.PDF417Reader=ts,t.PDF417ResultMetadata=_r,t.PerspectiveTransform=jn,t.PlanarYUVLuminanceSource=Je,t.QRCodeByteMatrix=oa,t.QRCodeDataMask=ws,t.QRCodeDecodedBitStreamParser=In,t.QRCodeDecoderErrorCorrectionLevel=Wt,t.QRCodeDecoderFormatInformation=ls,t.QRCodeEncoder=k,t.QRCodeEncoderQRCode=ar,t.QRCodeMaskUtil=Jt,t.QRCodeMatrixUtil=x,t.QRCodeMode=xt,t.QRCodeReader=hi,t.QRCodeVersion=ut,t.QRCodeWriter=ve,t.RGBLuminanceSource=Mt,t.RSS14Reader=bn,t.RSSExpandedReader=Ge,t.ReaderException=aa,t.ReedSolomonDecoder=Pt,t.ReedSolomonEncoder=rr,t.ReedSolomonException=Zt,t.Result=pe,t.ResultMetadataType=Pe,t.ResultPoint=de,t.StringUtils=Q,t.UnsupportedOperationException=se,t.VideoInputDevice=L,t.WhiteRectangleDetector=ot,t.WriterException=nn,t.ZXingArrays=ne,t.ZXingCharset=ss,t.ZXingInteger=ue,t.ZXingStandardCharsets=mn,t.ZXingStringBuilder=z,t.ZXingStringEncoding=Z,t.ZXingSystem=G,t.createAbstractExpandedDecoder=Ss,Object.defineProperty(t,"__esModule",{value:!0})}))})(Cu,Cu.exports)),Cu.exports}var hs=dR();const fR=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"}));var Ov=(function(){function i(e,t,a){if(this.formatMap=new Map([[ct.QR_CODE,hs.BarcodeFormat.QR_CODE],[ct.AZTEC,hs.BarcodeFormat.AZTEC],[ct.CODABAR,hs.BarcodeFormat.CODABAR],[ct.CODE_39,hs.BarcodeFormat.CODE_39],[ct.CODE_93,hs.BarcodeFormat.CODE_93],[ct.CODE_128,hs.BarcodeFormat.CODE_128],[ct.DATA_MATRIX,hs.BarcodeFormat.DATA_MATRIX],[ct.MAXICODE,hs.BarcodeFormat.MAXICODE],[ct.ITF,hs.BarcodeFormat.ITF],[ct.EAN_13,hs.BarcodeFormat.EAN_13],[ct.EAN_8,hs.BarcodeFormat.EAN_8],[ct.PDF_417,hs.BarcodeFormat.PDF_417],[ct.RSS_14,hs.BarcodeFormat.RSS_14],[ct.RSS_EXPANDED,hs.BarcodeFormat.RSS_EXPANDED],[ct.UPC_A,hs.BarcodeFormat.UPC_A],[ct.UPC_E,hs.BarcodeFormat.UPC_E],[ct.UPC_EAN_EXTENSION,hs.BarcodeFormat.UPC_EAN_EXTENSION]]),this.reverseFormatMap=this.createReverseFormatMap(),!fR)throw"Use html5qrcode.min.js without edit, ZXing not found.";this.verbose=t,this.logger=a;var h=this.createZXingFormats(e),f=new Map;f.set(hs.DecodeHintType.POSSIBLE_FORMATS,h),f.set(hs.DecodeHintType.TRY_HARDER,!1),this.hints=f}return i.prototype.decodeAsync=function(e){var t=this;return new Promise(function(a,h){try{a(t.decode(e))}catch(f){h(f)}})},i.prototype.decode=function(e){var t=new hs.MultiFormatReader(this.verbose,this.hints),a=new hs.HTMLCanvasElementLuminanceSource(e),h=new hs.BinaryBitmap(new hs.HybridBinarizer(a)),f=t.decode(h);return{text:f.text,format:WE.create(this.toHtml5QrcodeSupportedFormats(f.format)),debugData:this.createDebugData()}},i.prototype.createReverseFormatMap=function(){var e=new Map;return this.formatMap.forEach(function(t,a,h){e.set(t,a)}),e},i.prototype.toHtml5QrcodeSupportedFormats=function(e){if(!this.reverseFormatMap.has(e))throw"reverseFormatMap doesn't have ".concat(e);return this.reverseFormatMap.get(e)},i.prototype.createZXingFormats=function(e){for(var t=[],a=0,h=e;a<h.length;a++){var f=h[a];this.formatMap.has(f)?t.push(this.formatMap.get(f)):this.logger.logError("".concat(f," is not supported by")+"ZXingHtml5QrcodeShim")}return t},i.prototype.createDebugData=function(){return{decoderName:"zxing-js"}},i})(),mR=function(i,e,t,a){function h(f){return f instanceof t?f:new t(function(y){y(f)})}return new(t||(t=Promise))(function(f,y){function A(S){try{E(a.next(S))}catch(I){y(I)}}function C(S){try{E(a.throw(S))}catch(I){y(I)}}function E(S){S.done?f(S.value):h(S.value).then(A,C)}E((a=a.apply(i,e||[])).next())})},gR=function(i,e){var t={label:0,sent:function(){if(f[0]&1)throw f[1];return f[1]},trys:[],ops:[]},a,h,f,y;return y={next:A(0),throw:A(1),return:A(2)},typeof Symbol=="function"&&(y[Symbol.iterator]=function(){return this}),y;function A(E){return function(S){return C([E,S])}}function C(E){if(a)throw new TypeError("Generator is already executing.");for(;y&&(y=0,E[0]&&(t=0)),t;)try{if(a=1,h&&(f=E[0]&2?h.return:E[0]?h.throw||((f=h.return)&&f.call(h),0):h.next)&&!(f=f.call(h,E[1])).done)return f;switch(h=0,f&&(E=[E[0]&2,f.value]),E[0]){case 0:case 1:f=E;break;case 4:return t.label++,{value:E[1],done:!1};case 5:t.label++,h=E[1],E=[0];continue;case 7:E=t.ops.pop(),t.trys.pop();continue;default:if(f=t.trys,!(f=f.length>0&&f[f.length-1])&&(E[0]===6||E[0]===2)){t=0;continue}if(E[0]===3&&(!f||E[1]>f[0]&&E[1]<f[3])){t.label=E[1];break}if(E[0]===6&&t.label<f[1]){t.label=f[1],f=E;break}if(f&&t.label<f[2]){t.label=f[2],t.ops.push(E);break}f[2]&&t.ops.pop(),t.trys.pop();continue}E=e.call(i,t)}catch(S){E=[6,S],h=0}finally{a=f=0}if(E[0]&5)throw E[1];return{value:E[0]?E[1]:void 0,done:!0}}},jv=(function(){function i(e,t,a){if(this.formatMap=new Map([[ct.QR_CODE,"qr_code"],[ct.AZTEC,"aztec"],[ct.CODABAR,"codabar"],[ct.CODE_39,"code_39"],[ct.CODE_93,"code_93"],[ct.CODE_128,"code_128"],[ct.DATA_MATRIX,"data_matrix"],[ct.ITF,"itf"],[ct.EAN_13,"ean_13"],[ct.EAN_8,"ean_8"],[ct.PDF_417,"pdf417"],[ct.UPC_A,"upc_a"],[ct.UPC_E,"upc_e"]]),this.reverseFormatMap=this.createReverseFormatMap(),!i.isSupported())throw"Use html5qrcode.min.js without edit, Use BarcodeDetectorDelegate only if it isSupported();";this.verbose=t,this.logger=a;var h=this.createBarcodeDetectorFormats(e);if(this.detector=new BarcodeDetector(h),!this.detector)throw"BarcodeDetector detector not supported"}return i.isSupported=function(){if(!("BarcodeDetector"in window))return!1;var e=new BarcodeDetector({formats:["qr_code"]});return typeof e<"u"},i.prototype.decodeAsync=function(e){return mR(this,void 0,void 0,function(){var t,a;return gR(this,function(h){switch(h.label){case 0:return[4,this.detector.detect(e)];case 1:if(t=h.sent(),!t||t.length===0)throw"No barcode or QR code detected.";return a=this.selectLargestBarcode(t),[2,{text:a.rawValue,format:WE.create(this.toHtml5QrcodeSupportedFormats(a.format)),debugData:this.createDebugData()}]}})})},i.prototype.selectLargestBarcode=function(e){for(var t=null,a=0,h=0,f=e;h<f.length;h++){var y=f[h],A=y.boundingBox.width*y.boundingBox.height;A>a&&(a=A,t=y)}if(!t)throw"No largest barcode found";return t},i.prototype.createBarcodeDetectorFormats=function(e){for(var t=[],a=0,h=e;a<h.length;a++){var f=h[a];this.formatMap.has(f)?t.push(this.formatMap.get(f)):this.logger.warn("".concat(f," is not supported by")+"BarcodeDetectorDelegate")}return{formats:t}},i.prototype.toHtml5QrcodeSupportedFormats=function(e){if(!this.reverseFormatMap.has(e))throw"reverseFormatMap doesn't have ".concat(e);return this.reverseFormatMap.get(e)},i.prototype.createReverseFormatMap=function(){var e=new Map;return this.formatMap.forEach(function(t,a,h){e.set(t,a)}),e},i.prototype.createDebugData=function(){return{decoderName:"BarcodeDetector"}},i})(),Lv=function(i,e,t,a){function h(f){return f instanceof t?f:new t(function(y){y(f)})}return new(t||(t=Promise))(function(f,y){function A(S){try{E(a.next(S))}catch(I){y(I)}}function C(S){try{E(a.throw(S))}catch(I){y(I)}}function E(S){S.done?f(S.value):h(S.value).then(A,C)}E((a=a.apply(i,e||[])).next())})},Pv=function(i,e){var t={label:0,sent:function(){if(f[0]&1)throw f[1];return f[1]},trys:[],ops:[]},a,h,f,y;return y={next:A(0),throw:A(1),return:A(2)},typeof Symbol=="function"&&(y[Symbol.iterator]=function(){return this}),y;function A(E){return function(S){return C([E,S])}}function C(E){if(a)throw new TypeError("Generator is already executing.");for(;y&&(y=0,E[0]&&(t=0)),t;)try{if(a=1,h&&(f=E[0]&2?h.return:E[0]?h.throw||((f=h.return)&&f.call(h),0):h.next)&&!(f=f.call(h,E[1])).done)return f;switch(h=0,f&&(E=[E[0]&2,f.value]),E[0]){case 0:case 1:f=E;break;case 4:return t.label++,{value:E[1],done:!1};case 5:t.label++,h=E[1],E=[0];continue;case 7:E=t.ops.pop(),t.trys.pop();continue;default:if(f=t.trys,!(f=f.length>0&&f[f.length-1])&&(E[0]===6||E[0]===2)){t=0;continue}if(E[0]===3&&(!f||E[1]>f[0]&&E[1]<f[3])){t.label=E[1];break}if(E[0]===6&&t.label<f[1]){t.label=f[1],f=E;break}if(f&&t.label<f[2]){t.label=f[2],t.ops.push(E);break}f[2]&&t.ops.pop(),t.trys.pop();continue}E=e.call(i,t)}catch(S){E=[6,S],h=0}finally{a=f=0}if(E[0]&5)throw E[1];return{value:E[0]?E[1]:void 0,done:!0}}},pR=(function(){function i(e,t,a,h){this.EXECUTIONS_TO_REPORT_PERFORMANCE=100,this.executions=0,this.executionResults=[],this.wasPrimaryDecoderUsedInLastDecode=!1,this.verbose=a,t&&jv.isSupported()?(this.primaryDecoder=new jv(e,a,h),this.secondaryDecoder=new Ov(e,a,h)):this.primaryDecoder=new Ov(e,a,h)}return i.prototype.decodeAsync=function(e){return Lv(this,void 0,void 0,function(){var t;return Pv(this,function(a){switch(a.label){case 0:t=performance.now(),a.label=1;case 1:return a.trys.push([1,,3,4]),[4,this.getDecoder().decodeAsync(e)];case 2:return[2,a.sent()];case 3:return this.possiblyLogPerformance(t),[7];case 4:return[2]}})})},i.prototype.decodeRobustlyAsync=function(e){return Lv(this,void 0,void 0,function(){var t,a;return Pv(this,function(h){switch(h.label){case 0:t=performance.now(),h.label=1;case 1:return h.trys.push([1,3,4,5]),[4,this.primaryDecoder.decodeAsync(e)];case 2:return[2,h.sent()];case 3:if(a=h.sent(),this.secondaryDecoder)return[2,this.secondaryDecoder.decodeAsync(e)];throw a;case 4:return this.possiblyLogPerformance(t),[7];case 5:return[2]}})})},i.prototype.getDecoder=function(){return this.secondaryDecoder?this.wasPrimaryDecoderUsedInLastDecode===!1?(this.wasPrimaryDecoderUsedInLastDecode=!0,this.primaryDecoder):(this.wasPrimaryDecoderUsedInLastDecode=!1,this.secondaryDecoder):this.primaryDecoder},i.prototype.possiblyLogPerformance=function(e){if(this.verbose){var t=performance.now()-e;this.executionResults.push(t),this.executions++,this.possiblyFlushPerformanceReport()}},i.prototype.possiblyFlushPerformanceReport=function(){if(!(this.executions<this.EXECUTIONS_TO_REPORT_PERFORMANCE)){for(var e=0,t=0,a=this.executionResults;t<a.length;t++){var h=a[t];e+=h}var f=e/this.executionResults.length;console.log("".concat(f," ms for ").concat(this.executionResults.length," last runs.")),this.executions=0,this.executionResults=[]}},i})(),Cg=(function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,h){a.__proto__=h}||function(a,h){for(var f in h)Object.prototype.hasOwnProperty.call(h,f)&&(a[f]=h[f])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function a(){this.constructor=e}e.prototype=t===null?Object.create(t):(a.prototype=t.prototype,new a)}})(),sf=function(i,e,t,a){function h(f){return f instanceof t?f:new t(function(y){y(f)})}return new(t||(t=Promise))(function(f,y){function A(S){try{E(a.next(S))}catch(I){y(I)}}function C(S){try{E(a.throw(S))}catch(I){y(I)}}function E(S){S.done?f(S.value):h(S.value).then(A,C)}E((a=a.apply(i,e||[])).next())})},rf=function(i,e){var t={label:0,sent:function(){if(f[0]&1)throw f[1];return f[1]},trys:[],ops:[]},a,h,f,y;return y={next:A(0),throw:A(1),return:A(2)},typeof Symbol=="function"&&(y[Symbol.iterator]=function(){return this}),y;function A(E){return function(S){return C([E,S])}}function C(E){if(a)throw new TypeError("Generator is already executing.");for(;y&&(y=0,E[0]&&(t=0)),t;)try{if(a=1,h&&(f=E[0]&2?h.return:E[0]?h.throw||((f=h.return)&&f.call(h),0):h.next)&&!(f=f.call(h,E[1])).done)return f;switch(h=0,f&&(E=[E[0]&2,f.value]),E[0]){case 0:case 1:f=E;break;case 4:return t.label++,{value:E[1],done:!1};case 5:t.label++,h=E[1],E=[0];continue;case 7:E=t.ops.pop(),t.trys.pop();continue;default:if(f=t.trys,!(f=f.length>0&&f[f.length-1])&&(E[0]===6||E[0]===2)){t=0;continue}if(E[0]===3&&(!f||E[1]>f[0]&&E[1]<f[3])){t.label=E[1];break}if(E[0]===6&&t.label<f[1]){t.label=f[1],f=E;break}if(f&&t.label<f[2]){t.label=f[2],t.ops.push(E);break}f[2]&&t.ops.pop(),t.trys.pop();continue}E=e.call(i,t)}catch(S){E=[6,S],h=0}finally{a=f=0}if(E[0]&5)throw E[1];return{value:E[0]?E[1]:void 0,done:!0}}},XE=(function(){function i(e,t){this.name=e,this.track=t}return i.prototype.isSupported=function(){return this.track.getCapabilities?this.name in this.track.getCapabilities():!1},i.prototype.apply=function(e){var t={};t[this.name]=e;var a={advanced:[t]};return this.track.applyConstraints(a)},i.prototype.value=function(){var e=this.track.getSettings();if(this.name in e){var t=e[this.name];return t}return null},i})(),yR=(function(i){Cg(e,i);function e(t,a){return i.call(this,t,a)||this}return e.prototype.min=function(){return this.getCapabilities().min},e.prototype.max=function(){return this.getCapabilities().max},e.prototype.step=function(){return this.getCapabilities().step},e.prototype.apply=function(t){var a={};a[this.name]=t;var h={advanced:[a]};return this.track.applyConstraints(h)},e.prototype.getCapabilities=function(){this.failIfNotSupported();var t=this.track.getCapabilities(),a=t[this.name];return{min:a.min,max:a.max,step:a.step}},e.prototype.failIfNotSupported=function(){if(!this.isSupported())throw new Error("".concat(this.name," capability not supported"))},e})(XE),xR=(function(i){Cg(e,i);function e(t){return i.call(this,"zoom",t)||this}return e})(yR),vR=(function(i){Cg(e,i);function e(t){return i.call(this,"torch",t)||this}return e})(XE),wR=(function(){function i(e){this.track=e}return i.prototype.zoomFeature=function(){return new xR(this.track)},i.prototype.torchFeature=function(){return new vR(this.track)},i})(),bR=(function(){function i(e,t,a){this.isClosed=!1,this.parentElement=e,this.mediaStream=t,this.callbacks=a,this.surface=this.createVideoElement(this.parentElement.clientWidth),e.append(this.surface)}return i.prototype.createVideoElement=function(e){var t=document.createElement("video");return t.style.width="".concat(e,"px"),t.style.display="block",t.muted=!0,t.setAttribute("muted","true"),t.playsInline=!0,t},i.prototype.setupSurface=function(){var e=this;this.surface.onabort=function(){throw"RenderedCameraImpl video surface onabort() called"},this.surface.onerror=function(){throw"RenderedCameraImpl video surface onerror() called"};var t=function(){var a=e.surface.clientWidth,h=e.surface.clientHeight;e.callbacks.onRenderSurfaceReady(a,h),e.surface.removeEventListener("playing",t)};this.surface.addEventListener("playing",t),this.surface.srcObject=this.mediaStream,this.surface.play()},i.create=function(e,t,a,h){return sf(this,void 0,void 0,function(){var f,y;return rf(this,function(A){switch(A.label){case 0:return f=new i(e,t,h),a.aspectRatio?(y={aspectRatio:a.aspectRatio},[4,f.getFirstTrackOrFail().applyConstraints(y)]):[3,2];case 1:A.sent(),A.label=2;case 2:return f.setupSurface(),[2,f]}})})},i.prototype.failIfClosed=function(){if(this.isClosed)throw"The RenderedCamera has already been closed."},i.prototype.getFirstTrackOrFail=function(){if(this.failIfClosed(),this.mediaStream.getVideoTracks().length===0)throw"No video tracks found";return this.mediaStream.getVideoTracks()[0]},i.prototype.pause=function(){this.failIfClosed(),this.surface.pause()},i.prototype.resume=function(e){this.failIfClosed();var t=this,a=function(){setTimeout(e,200),t.surface.removeEventListener("playing",a)};this.surface.addEventListener("playing",a),this.surface.play()},i.prototype.isPaused=function(){return this.failIfClosed(),this.surface.paused},i.prototype.getSurface=function(){return this.failIfClosed(),this.surface},i.prototype.getRunningTrackCapabilities=function(){return this.getFirstTrackOrFail().getCapabilities()},i.prototype.getRunningTrackSettings=function(){return this.getFirstTrackOrFail().getSettings()},i.prototype.applyVideoConstraints=function(e){return sf(this,void 0,void 0,function(){return rf(this,function(t){if("aspectRatio"in e)throw"Changing 'aspectRatio' in run-time is not yet supported.";return[2,this.getFirstTrackOrFail().applyConstraints(e)]})})},i.prototype.close=function(){if(this.isClosed)return Promise.resolve();var e=this;return new Promise(function(t,a){var h=e.mediaStream.getVideoTracks(),f=h.length,y=0;e.mediaStream.getVideoTracks().forEach(function(A){e.mediaStream.removeTrack(A),A.stop(),++y,y>=f&&(e.isClosed=!0,e.parentElement.removeChild(e.surface),t())})})},i.prototype.getCapabilities=function(){return new wR(this.getFirstTrackOrFail())},i})(),ER=(function(){function i(e){this.mediaStream=e}return i.prototype.render=function(e,t,a){return sf(this,void 0,void 0,function(){return rf(this,function(h){return[2,bR.create(e,this.mediaStream,t,a)]})})},i.create=function(e){return sf(this,void 0,void 0,function(){var t,a;return rf(this,function(h){switch(h.label){case 0:if(!navigator.mediaDevices)throw"navigator.mediaDevices not supported";return t={audio:!1,video:e},[4,navigator.mediaDevices.getUserMedia(t)];case 1:return a=h.sent(),[2,new i(a)]}})})},i})(),Bv=function(i,e,t,a){function h(f){return f instanceof t?f:new t(function(y){y(f)})}return new(t||(t=Promise))(function(f,y){function A(S){try{E(a.next(S))}catch(I){y(I)}}function C(S){try{E(a.throw(S))}catch(I){y(I)}}function E(S){S.done?f(S.value):h(S.value).then(A,C)}E((a=a.apply(i,e||[])).next())})},Vv=function(i,e){var t={label:0,sent:function(){if(f[0]&1)throw f[1];return f[1]},trys:[],ops:[]},a,h,f,y;return y={next:A(0),throw:A(1),return:A(2)},typeof Symbol=="function"&&(y[Symbol.iterator]=function(){return this}),y;function A(E){return function(S){return C([E,S])}}function C(E){if(a)throw new TypeError("Generator is already executing.");for(;y&&(y=0,E[0]&&(t=0)),t;)try{if(a=1,h&&(f=E[0]&2?h.return:E[0]?h.throw||((f=h.return)&&f.call(h),0):h.next)&&!(f=f.call(h,E[1])).done)return f;switch(h=0,f&&(E=[E[0]&2,f.value]),E[0]){case 0:case 1:f=E;break;case 4:return t.label++,{value:E[1],done:!1};case 5:t.label++,h=E[1],E=[0];continue;case 7:E=t.ops.pop(),t.trys.pop();continue;default:if(f=t.trys,!(f=f.length>0&&f[f.length-1])&&(E[0]===6||E[0]===2)){t=0;continue}if(E[0]===3&&(!f||E[1]>f[0]&&E[1]<f[3])){t.label=E[1];break}if(E[0]===6&&t.label<f[1]){t.label=f[1],f=E;break}if(f&&t.label<f[2]){t.label=f[2],t.ops.push(E);break}f[2]&&t.ops.pop(),t.trys.pop();continue}E=e.call(i,t)}catch(S){E=[6,S],h=0}finally{a=f=0}if(E[0]&5)throw E[1];return{value:E[0]?E[1]:void 0,done:!0}}},_R=(function(){function i(){}return i.failIfNotSupported=function(){return Bv(this,void 0,void 0,function(){return Vv(this,function(e){if(!navigator.mediaDevices)throw"navigator.mediaDevices not supported";return[2,new i]})})},i.prototype.create=function(e){return Bv(this,void 0,void 0,function(){return Vv(this,function(t){return[2,ER.create(e)]})})},i})(),AR=function(i,e,t,a){function h(f){return f instanceof t?f:new t(function(y){y(f)})}return new(t||(t=Promise))(function(f,y){function A(S){try{E(a.next(S))}catch(I){y(I)}}function C(S){try{E(a.throw(S))}catch(I){y(I)}}function E(S){S.done?f(S.value):h(S.value).then(A,C)}E((a=a.apply(i,e||[])).next())})},CR=function(i,e){var t={label:0,sent:function(){if(f[0]&1)throw f[1];return f[1]},trys:[],ops:[]},a,h,f,y;return y={next:A(0),throw:A(1),return:A(2)},typeof Symbol=="function"&&(y[Symbol.iterator]=function(){return this}),y;function A(E){return function(S){return C([E,S])}}function C(E){if(a)throw new TypeError("Generator is already executing.");for(;y&&(y=0,E[0]&&(t=0)),t;)try{if(a=1,h&&(f=E[0]&2?h.return:E[0]?h.throw||((f=h.return)&&f.call(h),0):h.next)&&!(f=f.call(h,E[1])).done)return f;switch(h=0,f&&(E=[E[0]&2,f.value]),E[0]){case 0:case 1:f=E;break;case 4:return t.label++,{value:E[1],done:!1};case 5:t.label++,h=E[1],E=[0];continue;case 7:E=t.ops.pop(),t.trys.pop();continue;default:if(f=t.trys,!(f=f.length>0&&f[f.length-1])&&(E[0]===6||E[0]===2)){t=0;continue}if(E[0]===3&&(!f||E[1]>f[0]&&E[1]<f[3])){t.label=E[1];break}if(E[0]===6&&t.label<f[1]){t.label=f[1],f=E;break}if(f&&t.label<f[2]){t.label=f[2],t.ops.push(E);break}f[2]&&t.ops.pop(),t.trys.pop();continue}E=e.call(i,t)}catch(S){E=[6,S],h=0}finally{a=f=0}if(E[0]&5)throw E[1];return{value:E[0]?E[1]:void 0,done:!0}}},TR=(function(){function i(){}return i.retrieve=function(){if(navigator.mediaDevices)return i.getCamerasFromMediaDevices();var e=MediaStreamTrack;return MediaStreamTrack&&e.getSources?i.getCamerasFromMediaStreamTrack():i.rejectWithError()},i.rejectWithError=function(){var e=lc.unableToQuerySupportedDevices();return i.isHttpsOrLocalhost()||(e=lc.insecureContextCameraQueryError()),Promise.reject(e)},i.isHttpsOrLocalhost=function(){if(location.protocol==="https:")return!0;var e=location.host.split(":")[0];return e==="127.0.0.1"||e==="localhost"},i.getCamerasFromMediaDevices=function(){return AR(this,void 0,void 0,function(){var e,t,a,h,f,y,A;return CR(this,function(C){switch(C.label){case 0:return e=function(E){for(var S=E.getVideoTracks(),I=0,j=S;I<j.length;I++){var Y=j[I];Y.enabled=!1,Y.stop(),E.removeTrack(Y)}},[4,navigator.mediaDevices.getUserMedia({audio:!1,video:!0})];case 1:return t=C.sent(),[4,navigator.mediaDevices.enumerateDevices()];case 2:for(a=C.sent(),h=[],f=0,y=a;f<y.length;f++)A=y[f],A.kind==="videoinput"&&h.push({id:A.deviceId,label:A.label});return e(t),[2,h]}})})},i.getCamerasFromMediaStreamTrack=function(){return new Promise(function(e,t){var a=function(f){for(var y=[],A=0,C=f;A<C.length;A++){var E=C[A];E.kind==="video"&&y.push({id:E.id,label:E.label})}e(y)},h=MediaStreamTrack;h.getSources(a)})},i})(),ys;(function(i){i[i.UNKNOWN=0]="UNKNOWN",i[i.NOT_STARTED=1]="NOT_STARTED",i[i.SCANNING=2]="SCANNING",i[i.PAUSED=3]="PAUSED"})(ys||(ys={}));var SR=(function(){function i(){this.state=ys.NOT_STARTED,this.onGoingTransactionNewState=ys.UNKNOWN}return i.prototype.directTransition=function(e){this.failIfTransitionOngoing(),this.validateTransition(e),this.state=e},i.prototype.startTransition=function(e){return this.failIfTransitionOngoing(),this.validateTransition(e),this.onGoingTransactionNewState=e,this},i.prototype.execute=function(){if(this.onGoingTransactionNewState===ys.UNKNOWN)throw"Transaction is already cancelled, cannot execute().";var e=this.onGoingTransactionNewState;this.onGoingTransactionNewState=ys.UNKNOWN,this.directTransition(e)},i.prototype.cancel=function(){if(this.onGoingTransactionNewState===ys.UNKNOWN)throw"Transaction is already cancelled, cannot cancel().";this.onGoingTransactionNewState=ys.UNKNOWN},i.prototype.getState=function(){return this.state},i.prototype.failIfTransitionOngoing=function(){if(this.onGoingTransactionNewState!==ys.UNKNOWN)throw"Cannot transition to a new state, already under transition"},i.prototype.validateTransition=function(e){switch(this.state){case ys.UNKNOWN:throw"Transition from unknown is not allowed";case ys.NOT_STARTED:this.failIfNewStateIs(e,[ys.PAUSED]);break;case ys.SCANNING:break;case ys.PAUSED:break}},i.prototype.failIfNewStateIs=function(e,t){for(var a=0,h=t;a<h.length;a++){var f=h[a];if(e===f)throw"Cannot transition from ".concat(this.state," to ").concat(e)}},i})(),NR=(function(){function i(e){this.stateManager=e}return i.prototype.startTransition=function(e){return this.stateManager.startTransition(e)},i.prototype.directTransition=function(e){this.stateManager.directTransition(e)},i.prototype.getState=function(){return this.stateManager.getState()},i.prototype.canScanFile=function(){return this.stateManager.getState()===ys.NOT_STARTED},i.prototype.isScanning=function(){return this.stateManager.getState()!==ys.NOT_STARTED},i.prototype.isStrictlyScanning=function(){return this.stateManager.getState()===ys.SCANNING},i.prototype.isPaused=function(){return this.stateManager.getState()===ys.PAUSED},i})(),IR=(function(){function i(){}return i.create=function(){return new NR(new SR)},i})(),RR=(function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,h){a.__proto__=h}||function(a,h){for(var f in h)Object.prototype.hasOwnProperty.call(h,f)&&(a[f]=h[f])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function a(){this.constructor=e}e.prototype=t===null?Object.create(t):(a.prototype=t.prototype,new a)}})(),Ji=(function(i){RR(e,i);function e(){return i!==null&&i.apply(this,arguments)||this}return e.DEFAULT_WIDTH=300,e.DEFAULT_WIDTH_OFFSET=2,e.FILE_SCAN_MIN_HEIGHT=300,e.FILE_SCAN_HIDDEN_CANVAS_PADDING=100,e.MIN_QR_BOX_SIZE=50,e.SHADED_LEFT=1,e.SHADED_RIGHT=2,e.SHADED_TOP=3,e.SHADED_BOTTOM=4,e.SHADED_REGION_ELEMENT_ID="qr-shaded-region",e.VERBOSE=!1,e.BORDER_SHADER_DEFAULT_COLOR="#ffffff",e.BORDER_SHADER_MATCH_COLOR="rgb(90, 193, 56)",e})(lR),DR=(function(){function i(e,t){this.logger=t,this.fps=Ji.SCAN_DEFAULT_FPS,e?(e.fps&&(this.fps=e.fps),this.disableFlip=e.disableFlip===!0,this.qrbox=e.qrbox,this.aspectRatio=e.aspectRatio,this.videoConstraints=e.videoConstraints):this.disableFlip=Ji.DEFAULT_DISABLE_FLIP}return i.prototype.isMediaStreamConstraintsValid=function(){return this.videoConstraints?YE.isMediaStreamConstraintsValid(this.videoConstraints,this.logger):(this.logger.logError("Empty videoConstraints",!0),!1)},i.prototype.isShadedBoxEnabled=function(){return!Sa(this.qrbox)},i.create=function(e,t){return new i(e,t)},i})(),kR=(function(){function i(e,t){if(this.element=null,this.canvasElement=null,this.scannerPausedUiElement=null,this.hasBorderShaders=null,this.borderShaders=null,this.qrMatch=null,this.renderedCamera=null,this.qrRegion=null,this.context=null,this.lastScanImageFile=null,this.isScanning=!1,!document.getElementById(e))throw"HTML Element with id=".concat(e," not found");this.elementId=e,this.verbose=!1;var a;typeof t=="boolean"?this.verbose=t===!0:t&&(a=t,this.verbose=a.verbose===!0,a.experimentalFeatures),this.logger=new uR(this.verbose),this.qrcode=new pR(this.getSupportedFormats(t),this.getUseBarCodeDetectorIfSupported(a),this.verbose,this.logger),this.foreverScanTimeout,this.shouldScan=!0,this.stateManagerProxy=IR.create()}return i.prototype.start=function(e,t,a,h){var f=this;if(!e)throw"cameraIdOrConfig is required";if(!a||typeof a!="function")throw"qrCodeSuccessCallback is required and should be a function.";var y;h?y=h:y=this.verbose?this.logger.log:function(){};var A=DR.create(t,this.logger);this.clearElement();var C=!1;A.videoConstraints&&(A.isMediaStreamConstraintsValid()?C=!0:this.logger.logError("'videoConstraints' is not valid 'MediaStreamConstraints, it will be ignored.'",!0));var E=C,S=document.getElementById(this.elementId);S.clientWidth?S.clientWidth:Ji.DEFAULT_WIDTH,S.style.position="relative",this.shouldScan=!0,this.element=S;var I=this,j=this.stateManagerProxy.startTransition(ys.SCANNING);return new Promise(function(Y,X){var G=E?A.videoConstraints:I.createVideoConstraints(e);if(!G){j.cancel(),X("videoConstraints should be defined");return}var J={};(!E||A.aspectRatio)&&(J.aspectRatio=A.aspectRatio);var ae={onRenderSurfaceReady:function(ne,ue){I.setupUi(ne,ue,A),I.isScanning=!0,I.foreverScan(A,a,y)}};_R.failIfNotSupported().then(function(ne){ne.create(G).then(function(ue){return ue.render(f.element,J,ae).then(function(be){I.renderedCamera=be,j.execute(),Y(null)}).catch(function(be){j.cancel(),X(be)})}).catch(function(ue){j.cancel(),X(lc.errorGettingUserMedia(ue))})}).catch(function(ne){j.cancel(),X(lc.cameraStreamingNotSupported())})})},i.prototype.pause=function(e){if(!this.stateManagerProxy.isStrictlyScanning())throw"Cannot pause, scanner is not scanning.";this.stateManagerProxy.directTransition(ys.PAUSED),this.showPausedState(),(Sa(e)||e!==!0)&&(e=!1),e&&this.renderedCamera&&this.renderedCamera.pause()},i.prototype.resume=function(){if(!this.stateManagerProxy.isPaused())throw"Cannot result, scanner is not paused.";if(!this.renderedCamera)throw"renderedCamera doesn't exist while trying resume()";var e=this,t=function(){e.stateManagerProxy.directTransition(ys.SCANNING),e.hidePausedState()};if(!this.renderedCamera.isPaused()){t();return}this.renderedCamera.resume(function(){t()})},i.prototype.getState=function(){return this.stateManagerProxy.getState()},i.prototype.stop=function(){var e=this;if(!this.stateManagerProxy.isScanning())throw"Cannot stop, scanner is not running or paused.";var t=this.stateManagerProxy.startTransition(ys.NOT_STARTED);this.shouldScan=!1,this.foreverScanTimeout&&clearTimeout(this.foreverScanTimeout);var a=function(){if(e.element){var f=document.getElementById(Ji.SHADED_REGION_ELEMENT_ID);f&&e.element.removeChild(f)}},h=this;return this.renderedCamera.close().then(function(){return h.renderedCamera=null,h.element&&(h.element.removeChild(h.canvasElement),h.canvasElement=null),a(),h.qrRegion&&(h.qrRegion=null),h.context&&(h.context=null),t.execute(),h.hidePausedState(),h.isScanning=!1,Promise.resolve()})},i.prototype.scanFile=function(e,t){return this.scanFileV2(e,t).then(function(a){return a.decodedText})},i.prototype.scanFileV2=function(e,t){var a=this;if(!e||!(e instanceof File))throw"imageFile argument is mandatory and should be instance of File. Use 'event.target.files[0]'.";if(Sa(t)&&(t=!0),!this.stateManagerProxy.canScanFile())throw"Cannot start file scan - ongoing camera scan";return new Promise(function(h,f){a.possiblyCloseLastScanImageFile(),a.clearElement(),a.lastScanImageFile=URL.createObjectURL(e);var y=new Image;y.onload=function(){var A=y.width,C=y.height,E=document.getElementById(a.elementId),S=E.clientWidth?E.clientWidth:Ji.DEFAULT_WIDTH,I=Math.max(E.clientHeight?E.clientHeight:C,Ji.FILE_SCAN_MIN_HEIGHT),j=a.computeCanvasDrawConfig(A,C,S,I);if(t){var Y=a.createCanvasElement(S,I,"qr-canvas-visible");Y.style.display="inline-block",E.appendChild(Y);var X=Y.getContext("2d");if(!X)throw"Unable to get 2d context from canvas";X.canvas.width=S,X.canvas.height=I,X.drawImage(y,0,0,A,C,j.x,j.y,j.width,j.height)}var G=Ji.FILE_SCAN_HIDDEN_CANVAS_PADDING,J=Math.max(y.width,j.width),ae=Math.max(y.height,j.height),ne=J+2*G,ue=ae+2*G,be=a.createCanvasElement(ne,ue);E.appendChild(be);var Me=be.getContext("2d");if(!Me)throw"Unable to get 2d context from canvas";Me.canvas.width=ne,Me.canvas.height=ue,Me.drawImage(y,0,0,A,C,G,G,J,ae);try{a.qrcode.decodeRobustlyAsync(be).then(function(Ce){h(kv.createFromQrcodeResult(Ce))}).catch(f)}catch(Ce){f("QR code parse error, error = ".concat(Ce))}},y.onerror=f,y.onabort=f,y.onstalled=f,y.onsuspend=f,y.src=URL.createObjectURL(e)})},i.prototype.clear=function(){this.clearElement()},i.getCameras=function(){return TR.retrieve()},i.prototype.getRunningTrackCapabilities=function(){return this.getRenderedCameraOrFail().getRunningTrackCapabilities()},i.prototype.getRunningTrackSettings=function(){return this.getRenderedCameraOrFail().getRunningTrackSettings()},i.prototype.getRunningTrackCameraCapabilities=function(){return this.getRenderedCameraOrFail().getCapabilities()},i.prototype.applyVideoConstraints=function(e){if(e){if(!YE.isMediaStreamConstraintsValid(e,this.logger))throw"invalid videoConstaints passed, check logs for more details"}else throw"videoConstaints is required argument.";return this.getRenderedCameraOrFail().applyVideoConstraints(e)},i.prototype.getRenderedCameraOrFail=function(){if(this.renderedCamera==null)throw"Scanning is not in running state, call this API only when QR code scanning using camera is in running state.";return this.renderedCamera},i.prototype.getSupportedFormats=function(e){var t=[ct.QR_CODE,ct.AZTEC,ct.CODABAR,ct.CODE_39,ct.CODE_93,ct.CODE_128,ct.DATA_MATRIX,ct.MAXICODE,ct.ITF,ct.EAN_13,ct.EAN_8,ct.PDF_417,ct.RSS_14,ct.RSS_EXPANDED,ct.UPC_A,ct.UPC_E,ct.UPC_EAN_EXTENSION];if(!e||typeof e=="boolean"||!e.formatsToSupport)return t;if(!Array.isArray(e.formatsToSupport))throw"configOrVerbosityFlag.formatsToSupport should be undefined or an array.";if(e.formatsToSupport.length===0)throw"Atleast 1 formatsToSupport is needed.";for(var a=[],h=0,f=e.formatsToSupport;h<f.length;h++){var y=f[h];oR(y)?a.push(y):this.logger.warn("Invalid format: ".concat(y," passed in config, ignoring."))}if(a.length===0)throw"None of formatsToSupport match supported values.";return a},i.prototype.getUseBarCodeDetectorIfSupported=function(e){if(Sa(e))return!0;if(!Sa(e.useBarCodeDetectorIfSupported))return e.useBarCodeDetectorIfSupported!==!1;if(Sa(e.experimentalFeatures))return!0;var t=e.experimentalFeatures;return Sa(t.useBarCodeDetectorIfSupported)?!0:t.useBarCodeDetectorIfSupported!==!1},i.prototype.validateQrboxSize=function(e,t,a){var h=this,f=a.qrbox;this.validateQrboxConfig(f);var y=this.toQrdimensions(e,t,f),A=function(E){if(E<Ji.MIN_QR_BOX_SIZE)throw"minimum size of 'config.qrbox' dimension value is"+" ".concat(Ji.MIN_QR_BOX_SIZE,"px.")},C=function(E){return E>e&&(h.logger.warn("`qrbox.width` or `qrbox` is larger than the width of the root element. The width will be truncated to the width of root element."),E=e),E};A(y.width),A(y.height),y.width=C(y.width)},i.prototype.validateQrboxConfig=function(e){if(typeof e!="number"&&typeof e!="function"&&(e.width===void 0||e.height===void 0))throw"Invalid instance of QrDimensions passed for 'config.qrbox'. Both 'width' and 'height' should be set."},i.prototype.toQrdimensions=function(e,t,a){if(typeof a=="number")return{width:a,height:a};if(typeof a=="function")try{return a(e,t)}catch(h){throw new Error("qrbox config was passed as a function but it failed with unknown error"+h)}return a},i.prototype.setupUi=function(e,t,a){a.isShadedBoxEnabled()&&this.validateQrboxSize(e,t,a);var h=Sa(a.qrbox)?{width:e,height:t}:a.qrbox;this.validateQrboxConfig(h);var f=this.toQrdimensions(e,t,h);f.height>t&&this.logger.warn("[Html5Qrcode] config.qrbox has height that isgreater than the height of the video stream. Shading will be ignored");var y=a.isShadedBoxEnabled()&&f.height<=t,A={x:0,y:0,width:e,height:t},C=y?this.getShadedRegionBounds(e,t,f):A,E=this.createCanvasElement(C.width,C.height),S={willReadFrequently:!0},I=E.getContext("2d",S);I.canvas.width=C.width,I.canvas.height=C.height,this.element.append(E),y&&this.possiblyInsertShadingElement(this.element,e,t,f),this.createScannerPausedUiElement(this.element),this.qrRegion=C,this.context=I,this.canvasElement=E},i.prototype.createScannerPausedUiElement=function(e){var t=document.createElement("div");t.innerText=lc.scannerPaused(),t.style.display="none",t.style.position="absolute",t.style.top="0px",t.style.zIndex="1",t.style.background="rgba(9, 9, 9, 0.46)",t.style.color="#FFECEC",t.style.textAlign="center",t.style.width="100%",e.appendChild(t),this.scannerPausedUiElement=t},i.prototype.scanContext=function(e,t){var a=this;return this.stateManagerProxy.isPaused()?Promise.resolve(!1):this.qrcode.decodeAsync(this.canvasElement).then(function(h){return e(h.text,kv.createFromQrcodeResult(h)),a.possiblyUpdateShaders(!0),!0}).catch(function(h){a.possiblyUpdateShaders(!1);var f=lc.codeParseError(h);return t(f,cR.createFrom(f)),!1})},i.prototype.foreverScan=function(e,t,a){var h=this;if(this.shouldScan&&this.renderedCamera){var f=this.renderedCamera.getSurface(),y=f.videoWidth/f.clientWidth,A=f.videoHeight/f.clientHeight;if(!this.qrRegion)throw"qrRegion undefined when localMediaStream is ready.";var C=this.qrRegion.width*y,E=this.qrRegion.height*A,S=this.qrRegion.x*y,I=this.qrRegion.y*A;this.context.drawImage(f,S,I,C,E,0,0,this.qrRegion.width,this.qrRegion.height);var j=function(){h.foreverScanTimeout=setTimeout(function(){h.foreverScan(e,t,a)},h.getTimeoutFps(e.fps))};this.scanContext(t,a).then(function(Y){!Y&&e.disableFlip!==!0?(h.context.translate(h.context.canvas.width,0),h.context.scale(-1,1),h.scanContext(t,a).finally(function(){j()})):j()}).catch(function(Y){h.logger.logError("Error happend while scanning context",Y),j()})}},i.prototype.createVideoConstraints=function(e){if(typeof e=="string")return{deviceId:{exact:e}};if(typeof e=="object"){var t="facingMode",a="deviceId",h={user:!0,environment:!0},f="exact",y=function(X){if(X in h)return!0;throw"config has invalid 'facingMode' value = "+"'".concat(X,"'")},A=Object.keys(e);if(A.length!==1)throw"'cameraIdOrConfig' object should have exactly 1 key,"+" if passed as an object, found ".concat(A.length," keys");var C=Object.keys(e)[0];if(C!==t&&C!==a)throw"Only '".concat(t,"' and '").concat(a,"' ")+" are supported for 'cameraIdOrConfig'";if(C===t){var E=e.facingMode;if(typeof E=="string"){if(y(E))return{facingMode:E}}else if(typeof E=="object")if(f in E){if(y(E["".concat(f)]))return{facingMode:{exact:E["".concat(f)]}}}else throw"'facingMode' should be string or object with"+" ".concat(f," as key.");else{var S=typeof E;throw"Invalid type of 'facingMode' = ".concat(S)}}else{var I=e.deviceId;if(typeof I=="string")return{deviceId:I};if(typeof I=="object"){if(f in I)return{deviceId:{exact:I["".concat(f)]}};throw"'deviceId' should be string or object with"+" ".concat(f," as key.")}else{var j=typeof I;throw"Invalid type of 'deviceId' = ".concat(j)}}}var Y=typeof e;throw"Invalid type of 'cameraIdOrConfig' = ".concat(Y)},i.prototype.computeCanvasDrawConfig=function(e,t,a,h){if(e<=a&&t<=h){var f=(a-e)/2,y=(h-t)/2;return{x:f,y,width:e,height:t}}else{var A=e,C=t;return e>a&&(t=a/e*t,e=a),t>h&&(e=h/t*e,t=h),this.logger.log("Image downsampled from "+"".concat(A,"X").concat(C)+" to ".concat(e,"X").concat(t,".")),this.computeCanvasDrawConfig(e,t,a,h)}},i.prototype.clearElement=function(){if(this.stateManagerProxy.isScanning())throw"Cannot clear while scan is ongoing, close it first.";var e=document.getElementById(this.elementId);e&&(e.innerHTML="")},i.prototype.possiblyUpdateShaders=function(e){this.qrMatch!==e&&(this.hasBorderShaders&&this.borderShaders&&this.borderShaders.length&&this.borderShaders.forEach(function(t){t.style.backgroundColor=e?Ji.BORDER_SHADER_MATCH_COLOR:Ji.BORDER_SHADER_DEFAULT_COLOR}),this.qrMatch=e)},i.prototype.possiblyCloseLastScanImageFile=function(){this.lastScanImageFile&&(URL.revokeObjectURL(this.lastScanImageFile),this.lastScanImageFile=null)},i.prototype.createCanvasElement=function(e,t,a){var h=e,f=t,y=document.createElement("canvas");return y.style.width="".concat(h,"px"),y.style.height="".concat(f,"px"),y.style.display="none",y.id=Sa(a)?"qr-canvas":a,y},i.prototype.getShadedRegionBounds=function(e,t,a){if(a.width>e||a.height>t)throw"'config.qrbox' dimensions should not be greater than the dimensions of the root HTML element.";return{x:(e-a.width)/2,y:(t-a.height)/2,width:a.width,height:a.height}},i.prototype.possiblyInsertShadingElement=function(e,t,a,h){if(!(t-h.width<1||a-h.height<1)){var f=document.createElement("div");f.style.position="absolute";var y=(t-h.width)/2,A=(a-h.height)/2;if(f.style.borderLeft="".concat(y,"px solid rgba(0, 0, 0, 0.48)"),f.style.borderRight="".concat(y,"px solid rgba(0, 0, 0, 0.48)"),f.style.borderTop="".concat(A,"px solid rgba(0, 0, 0, 0.48)"),f.style.borderBottom="".concat(A,"px solid rgba(0, 0, 0, 0.48)"),f.style.boxSizing="border-box",f.style.top="0px",f.style.bottom="0px",f.style.left="0px",f.style.right="0px",f.id="".concat(Ji.SHADED_REGION_ELEMENT_ID),t-h.width<11||a-h.height<11)this.hasBorderShaders=!1;else{var C=5,E=40;this.insertShaderBorders(f,E,C,-C,null,0,!0),this.insertShaderBorders(f,E,C,-C,null,0,!1),this.insertShaderBorders(f,E,C,null,-C,0,!0),this.insertShaderBorders(f,E,C,null,-C,0,!1),this.insertShaderBorders(f,C,E+C,-C,null,-C,!0),this.insertShaderBorders(f,C,E+C,null,-C,-C,!0),this.insertShaderBorders(f,C,E+C,-C,null,-C,!1),this.insertShaderBorders(f,C,E+C,null,-C,-C,!1),this.hasBorderShaders=!0}e.append(f)}},i.prototype.insertShaderBorders=function(e,t,a,h,f,y,A){var C=document.createElement("div");C.style.position="absolute",C.style.backgroundColor=Ji.BORDER_SHADER_DEFAULT_COLOR,C.style.width="".concat(t,"px"),C.style.height="".concat(a,"px"),h!==null&&(C.style.top="".concat(h,"px")),f!==null&&(C.style.bottom="".concat(f,"px")),A?C.style.left="".concat(y,"px"):C.style.right="".concat(y,"px"),this.borderShaders||(this.borderShaders=[]),this.borderShaders.push(C),e.appendChild(C)},i.prototype.showPausedState=function(){if(!this.scannerPausedUiElement)throw"[internal error] scanner paused UI element not found";this.scannerPausedUiElement.style.display="block"},i.prototype.hidePausedState=function(){if(!this.scannerPausedUiElement)throw"[internal error] scanner paused UI element not found";this.scannerPausedUiElement.style.display="none"},i.prototype.getTimeoutFps=function(e){return 1e3/e},i})(),Fv;(function(i){i[i.STATUS_DEFAULT=0]="STATUS_DEFAULT",i[i.STATUS_SUCCESS=1]="STATUS_SUCCESS",i[i.STATUS_WARNING=2]="STATUS_WARNING",i[i.STATUS_REQUESTING_PERMISSION=3]="STATUS_REQUESTING_PERMISSION"})(Fv||(Fv={}));const z0=60;function Uv(){return new Date().toISOString().split("T")[0]}function MR(){const{currentUser:i,isClient:e,clientData:t,loading:a}=Vi(),{isDark:h,toggleTheme:f}=Cl(),y=ai(),[A,C]=H.useState("loading"),[E,S]=H.useState(null),[I,j]=H.useState({gender:"male",age:"",weight:"",weightUnit:"kg",height:"",heightUnit:"cm",heightFeet:"",heightInches:"",activityLevel:"moderate",goal:"maintain",deficitLevel:"moderate"}),[Y,X]=H.useState(null),[G,J]=H.useState({entries:[],water:0}),[ae,ne]=H.useState({protein:0,carbs:0,fats:0,calories:0}),[ue,be]=H.useState(null),[Me,Ce]=H.useState(!1),[P,F]=H.useState(""),[B,se]=H.useState(!1),[Z,Q]=H.useState(""),[z,Ye]=H.useState([]),[me,te]=H.useState(!1),[ge,He]=H.useState({name:"",protein:"",carbs:"",fats:"",calories:"",serving:""}),[Ne,tt]=H.useState(null),[L,oe]=H.useState(1),[ce,pe]=H.useState(null);H.useRef(null);const ee=H.useRef(null),ie=H.useCallback((de,et="info")=>{pe({message:de,type:et}),setTimeout(()=>pe(null),3e3)},[]);H.useEffect(()=>{!a&&(!i||!e)&&y("/")},[i,e,a,y]),H.useEffect(()=>{if(!t?.id)return;(async()=>{try{const et=await Bo(Ft(nt,"nutritionTargets",t.id));et.exists()?(S(et.data()),C("dashboard")):C("setup");const Ot=Uv(),ot=await Bo(Ft(nt,"nutritionLogs",`${t.id}_${Ot}`));if(ot.exists()){const xn=ot.data();J({entries:xn.entries||[],water:xn.water||0})}}catch(et){console.error("Error loading nutrition data:",et),C("setup")}})()},[t?.id]),H.useEffect(()=>{const de=G.entries.reduce((et,Ot)=>({protein:et.protein+(Ot.protein||0),carbs:et.carbs+(Ot.carbs||0),fats:et.fats+(Ot.fats||0),calories:et.calories+(Ot.calories||0)}),{protein:0,carbs:0,fats:0,calories:0});ne(de)},[G.entries]);const Te=async de=>{const et=Uv();try{await Ia(Ft(nt,"nutritionLogs",`${t.id}_${et}`),{clientId:t.id,date:et,entries:de.entries,water:de.water,updatedAt:vt.now()})}catch(Ot){console.error("Error saving nutrition log:",Ot)}},Pe=()=>{let de=parseFloat(I.weight);I.weightUnit==="lbs"&&(de*=.453592);let et;I.heightUnit==="cm"?et=parseFloat(I.height):et=(parseFloat(I.heightFeet)||0)*30.48+(parseFloat(I.heightInches)||0)*2.54;const Ot=parseInt(I.age);let ot=I.gender==="male"?10*de+6.25*et-5*Ot+5:10*de+6.25*et-5*Ot-161;const jn=ot*{sedentary:1.2,light:1.375,moderate:1.55,active:1.725,veryActive:1.9}[I.activityLevel];let Zn=jn,Vn,vn;switch(I.goal){case"lose":Zn=jn-{light:250,moderate:500,harsh:750}[I.deficitLevel],Vn=2.2,vn=.3;break;case"build":Zn=jn+300,Vn=2,vn=.22;break;default:Vn=1.8,vn=.25}Zn=Math.max(Zn,I.gender==="male"?1500:1200);const xs=Math.round(de*Vn),Wn=Math.round(Zn*vn/9),Cs=Math.max(0,Math.round((Zn-xs*4-Wn*9)/4));X({calories:Math.round(Zn),protein:xs,carbs:Cs,fats:Wn,bmr:Math.round(ot),tdee:Math.round(jn)})},it=async()=>{if(!Y)return;const de={clientId:t.id,calories:Y.calories,protein:Y.protein,carbs:Y.carbs,fats:Y.fats,waterGoal:8,goal:I.goal,updatedAt:vt.now()};await Ia(Ft(nt,"nutritionTargets",t.id),de),S(de),C("dashboard"),ie("Macro targets saved!","success")},dt=()=>{const de=I.weight&&parseFloat(I.weight)>0,et=I.age&&parseInt(I.age)>0,Ot=I.heightUnit==="cm"?I.height&&parseFloat(I.height)>0:I.heightFeet&&parseFloat(I.heightFeet)>0||I.heightInches&&parseFloat(I.heightInches)>0;return de&&et&&Ot},Le=de=>{const et=[...G.entries,{...de,id:Date.now(),addedAt:new Date().toISOString()}],Ot={...G,entries:et};J(Ot),Te(Ot),be(null),tt(null),oe(1),He({name:"",protein:"",carbs:"",fats:"",calories:"",serving:""}),ie("Food added!","success")},qt=de=>{const et=G.entries.filter(ot=>ot.id!==de),Ot={...G,entries:et};J(Ot),Te(Ot)},wt=async()=>{Ce(!0);try{const de=new kR("barcode-reader");ee.current=de,await de.start({facingMode:"environment"},{fps:10,qrbox:{width:250,height:120}},async et=>{await de.stop(),ee.current=null,Ce(!1),zt(et)},()=>{})}catch(de){console.error("Scanner error:",de),Ce(!1),ie("Could not access camera","error")}},Zt=async()=>{if(ee.current){try{await ee.current.stop()}catch{}ee.current=null}Ce(!1)},zt=async de=>{se(!0);try{const Ot=await(await fetch(`https://world.openfoodfacts.org/api/v0/product/${de}.json`)).json();if(Ot.status===1&&Ot.product){const ot=Ot.product,xn=ot.nutriments||{};tt({name:ot.product_name||"Unknown Product",brand:ot.brands||"",image:ot.image_small_url||null,servingSize:ot.serving_size||"100g",protein:Math.round(xn.proteins_100g||0),carbs:Math.round(xn.carbohydrates_100g||0),fats:Math.round(xn.fat_100g||0),calories:Math.round(xn["energy-kcal_100g"]||0),per100g:!0}),oe(1),F("")}else ie("Product not found. Try manual entry.","error")}catch(et){console.error("Barcode lookup error:",et),ie("Failed to look up product. Check your connection.","error")}se(!1)},Pt=async()=>{if(Z.trim()){te(!0);try{const Ot=((await(await fetch(`https://world.openfoodfacts.org/cgi/search.pl?search_terms=${encodeURIComponent(Z)}&search_simple=1&action=process&json=1&page_size=10`)).json()).products||[]).map(ot=>{const xn=ot.nutriments||{};return{name:ot.product_name||"Unknown",brand:ot.brands||"",image:ot.image_small_url||null,servingSize:ot.serving_size||"100g",protein:Math.round(xn.proteins_100g||0),carbs:Math.round(xn.carbohydrates_100g||0),fats:Math.round(xn.fat_100g||0),calories:Math.round(xn["energy-kcal_100g"]||0),per100g:!0}}).filter(ot=>ot.name!=="Unknown");Ye(Ot)}catch(de){console.error("Search error:",de),ie("Search failed. Try again.","error")}te(!1)}},st=()=>{const de={...G,water:G.water+1};J(de),Te(de)},mt=()=>{if(G.water<=0)return;const de={...G,water:G.water-1};J(de),Te(de)},at=(de,et)=>!et||et<=0?0:Math.min(z0,Math.round(de/et*z0)),kt=(de,et,Ot,ot,xn)=>{const jn=at(Ot,ot),Zn=ot>0?Math.min(100,Math.round(Ot/ot*100)):0;return u.jsxs("div",{className:`nut-ring-wrap ${xn}`,children:[u.jsx("svg",{className:"nut-ring-svg",viewBox:"0 0 200 200",children:[...Array(z0)].map((Vn,vn)=>{const xs=(vn*6-90)*(Math.PI/180),Wn=100+82*Math.cos(xs),Cs=100+82*Math.sin(xs),Qt=100+94*Math.cos(xs),We=100+94*Math.sin(xs);return u.jsx("line",{x1:Wn,y1:Cs,x2:Qt,y2:We,className:vn<jn?"nut-tick-filled":"nut-tick-empty",strokeWidth:vn%5===0?"3":"2"},vn)})}),u.jsxs("div",{className:"nut-ring-center",children:[u.jsx("span",{className:"nut-ring-value",children:Math.round(Ot)}),u.jsxs("span",{className:"nut-ring-target",children:["/ ",ot,de==="Calories"?"":"g"]}),u.jsx("span",{className:"nut-ring-label",children:et})]}),u.jsxs("span",{className:"nut-ring-pct",children:[Zn,"%"]})]})};return H.useEffect(()=>()=>{if(ee.current)try{ee.current.stop()}catch{}},[]),a||A==="loading"?u.jsx("div",{className:"cb-loading",children:u.jsx("div",{className:"cb-loading-spinner"})}):A==="setup"?u.jsxs("div",{className:"nut-page","data-theme":h?"dark":"light",children:[u.jsxs("header",{className:"cb-header",children:[u.jsxs("div",{className:"cb-header-left",children:[u.jsx("img",{src:"/Logo.PNG",alt:"Mind Core Fitness",className:"cb-header-logo"}),u.jsx("span",{className:"cb-header-title",children:"Nutrition Setup"})]}),u.jsx("div",{className:"cb-header-right",children:u.jsx("button",{className:"cb-theme-toggle",onClick:f,"aria-label":"Toggle theme",children:h?u.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[u.jsx("circle",{cx:"12",cy:"12",r:"5"}),u.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):u.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:u.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]}),u.jsxs("main",{className:"nut-main",children:[u.jsx("button",{className:"nut-back-btn",onClick:()=>y(-1),children:" Back"}),u.jsxs("div",{className:"nut-setup-intro",children:[u.jsx("h2",{children:"Set Your Daily Targets"}),u.jsx("p",{children:"Calculate your personalised macros based on your body and goals."})]}),u.jsxs("div",{className:"nut-calc-form",children:[u.jsxs("div",{className:"nut-form-group",children:[u.jsx("label",{children:"Gender"}),u.jsxs("div",{className:"nut-toggle-group",children:[u.jsx("button",{className:I.gender==="male"?"active":"",onClick:()=>{j(de=>({...de,gender:"male"})),X(null)},children:"Male"}),u.jsx("button",{className:I.gender==="female"?"active":"",onClick:()=>{j(de=>({...de,gender:"female"})),X(null)},children:"Female"})]})]}),u.jsxs("div",{className:"nut-form-row",children:[u.jsxs("div",{className:"nut-form-group",children:[u.jsx("label",{children:"Age"}),u.jsx("input",{type:"number",value:I.age,onChange:de=>{j(et=>({...et,age:de.target.value})),X(null)},placeholder:"Years",min:"15",max:"100"})]}),u.jsxs("div",{className:"nut-form-group",children:[u.jsx("label",{children:"Weight"}),u.jsxs("div",{className:"nut-input-unit",children:[u.jsx("input",{type:"number",value:I.weight,onChange:de=>{j(et=>({...et,weight:de.target.value})),X(null)},placeholder:I.weightUnit,min:"30",max:"300"}),u.jsxs("div",{className:"nut-unit-toggle",children:[u.jsx("button",{className:I.weightUnit==="kg"?"active":"",onClick:()=>{j(de=>({...de,weightUnit:"kg"})),X(null)},children:"kg"}),u.jsx("button",{className:I.weightUnit==="lbs"?"active":"",onClick:()=>{j(de=>({...de,weightUnit:"lbs"})),X(null)},children:"lbs"})]})]})]})]}),u.jsxs("div",{className:"nut-form-group",children:[u.jsx("label",{children:"Height"}),u.jsxs("div",{className:"nut-input-unit",children:[I.heightUnit==="cm"?u.jsx("input",{type:"number",value:I.height,onChange:de=>{j(et=>({...et,height:de.target.value})),X(null)},placeholder:"cm",min:"100",max:"250"}):u.jsxs("div",{className:"nut-height-imperial",children:[u.jsx("input",{type:"number",value:I.heightFeet,onChange:de=>{j(et=>({...et,heightFeet:de.target.value})),X(null)},placeholder:"ft",min:"4",max:"7"}),u.jsx("input",{type:"number",value:I.heightInches,onChange:de=>{j(et=>({...et,heightInches:de.target.value})),X(null)},placeholder:"in",min:"0",max:"11"})]}),u.jsxs("div",{className:"nut-unit-toggle",children:[u.jsx("button",{className:I.heightUnit==="cm"?"active":"",onClick:()=>{j(de=>({...de,heightUnit:"cm"})),X(null)},children:"cm"}),u.jsx("button",{className:I.heightUnit==="ft"?"active":"",onClick:()=>{j(de=>({...de,heightUnit:"ft"})),X(null)},children:"ft/in"})]})]})]}),u.jsxs("div",{className:"nut-form-group",children:[u.jsx("label",{children:"Activity Level"}),u.jsxs("select",{value:I.activityLevel,onChange:de=>{j(et=>({...et,activityLevel:de.target.value})),X(null)},children:[u.jsx("option",{value:"sedentary",children:"Sedentary (little to no exercise)"}),u.jsx("option",{value:"light",children:"Lightly Active (1-3 days/week)"}),u.jsx("option",{value:"moderate",children:"Moderately Active (3-5 days/week)"}),u.jsx("option",{value:"active",children:"Very Active (6-7 days/week)"}),u.jsx("option",{value:"veryActive",children:"Extra Active (athlete/physical job)"})]})]}),u.jsxs("div",{className:"nut-form-group",children:[u.jsx("label",{children:"Fitness Goal"}),u.jsxs("div",{className:"nut-goal-options",children:[u.jsxs("button",{className:I.goal==="lose"?"active":"",onClick:()=>{j(de=>({...de,goal:"lose"})),X(null)},children:[u.jsx("span",{className:"nut-goal-icon",children:"-"}),u.jsx("span",{children:"Lose Weight"})]}),u.jsxs("button",{className:I.goal==="maintain"?"active":"",onClick:()=>{j(de=>({...de,goal:"maintain"})),X(null)},children:[u.jsx("span",{className:"nut-goal-icon",children:"="}),u.jsx("span",{children:"Maintain"})]}),u.jsxs("button",{className:I.goal==="build"?"active":"",onClick:()=>{j(de=>({...de,goal:"build"})),X(null)},children:[u.jsx("span",{className:"nut-goal-icon",children:"+"}),u.jsx("span",{children:"Build Muscle"})]})]})]}),I.goal==="lose"&&u.jsxs("div",{className:"nut-form-group",children:[u.jsx("label",{children:"Deficit Level"}),u.jsxs("div",{className:"nut-deficit-options",children:[u.jsxs("button",{className:I.deficitLevel==="light"?"active":"",onClick:()=>{j(de=>({...de,deficitLevel:"light"})),X(null)},children:[u.jsx("strong",{children:"Light"}),u.jsx("span",{children:"-250 cal/day"})]}),u.jsxs("button",{className:I.deficitLevel==="moderate"?"active":"",onClick:()=>{j(de=>({...de,deficitLevel:"moderate"})),X(null)},children:[u.jsx("strong",{children:"Moderate"}),u.jsx("span",{children:"-500 cal/day"})]}),u.jsxs("button",{className:I.deficitLevel==="harsh"?"active":"",onClick:()=>{j(de=>({...de,deficitLevel:"harsh"})),X(null)},children:[u.jsx("strong",{children:"Aggressive"}),u.jsx("span",{children:"-750 cal/day"})]})]})]}),u.jsx("button",{className:"nut-calc-btn",onClick:Pe,disabled:!dt(),children:"Calculate Macros"})]}),Y&&u.jsxs("div",{className:"nut-calc-results",children:[u.jsx("h3",{children:"Your Daily Targets"}),u.jsxs("div",{className:"nut-calc-rings",children:[kt("Protein","Protein",Y.protein,Y.protein,"ring-protein"),kt("Carbs","Carbs",Y.carbs,Y.carbs,"ring-carbs"),kt("Fats","Fats",Y.fats,Y.fats,"ring-fats"),kt("Calories","Calories",Y.calories,Y.calories,"ring-cals")]}),u.jsxs("div",{className:"nut-calc-info",children:[u.jsxs("div",{className:"nut-calc-info-row",children:[u.jsx("span",{children:"BMR"}),u.jsxs("span",{children:[Y.bmr," cal"]})]}),u.jsxs("div",{className:"nut-calc-info-row",children:[u.jsx("span",{children:"TDEE"}),u.jsxs("span",{children:[Y.tdee," cal"]})]})]}),u.jsx("button",{className:"nut-save-targets-btn",onClick:it,children:"Set as My Daily Targets"})]})]})]}):u.jsxs("div",{className:"nut-page","data-theme":h?"dark":"light",children:[u.jsxs("header",{className:"cb-header",children:[u.jsxs("div",{className:"cb-header-left",children:[u.jsx("img",{src:"/Logo.PNG",alt:"Mind Core Fitness",className:"cb-header-logo"}),u.jsx("span",{className:"cb-header-title",children:"Nutrition"})]}),u.jsxs("div",{className:"cb-header-right",children:[u.jsx("button",{className:"nut-settings-btn",onClick:()=>{C("setup"),X(null)},"aria-label":"Recalculate macros",children:u.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[u.jsx("circle",{cx:"12",cy:"12",r:"3"}),u.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 1 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 1 1-2.83-2.83l.06-.06A1.65 1.65 0 0 0 4.68 15a1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1 0-4h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 1 1 2.83-2.83l.06.06A1.65 1.65 0 0 0 9 4.68a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 1 1 2.83 2.83l-.06.06A1.65 1.65 0 0 0 19.4 9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1z"})]})}),u.jsx("button",{className:"cb-theme-toggle",onClick:f,"aria-label":"Toggle theme",children:h?u.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[u.jsx("circle",{cx:"12",cy:"12",r:"5"}),u.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):u.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:u.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})]})]}),u.jsxs("main",{className:"nut-main",children:[u.jsx("button",{className:"nut-back-btn",onClick:()=>y(-1),children:" Back"}),u.jsxs("div",{className:"nut-rings-grid",children:[kt("Protein","Protein",ae.protein,E.protein,"ring-protein"),kt("Carbs","Carbs",ae.carbs,E.carbs,"ring-carbs"),kt("Fats","Fats",ae.fats,E.fats,"ring-fats"),kt("Calories","Calories",ae.calories,E.calories,"ring-cals")]}),u.jsxs("div",{className:"nut-add-buttons",children:[u.jsxs("button",{className:"nut-add-btn nut-add-scan",onClick:()=>{be("scan"),tt(null)},children:[u.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[u.jsx("path",{d:"M3 7V5a2 2 0 0 1 2-2h2"}),u.jsx("path",{d:"M17 3h2a2 2 0 0 1 2 2v2"}),u.jsx("path",{d:"M21 17v2a2 2 0 0 1-2 2h-2"}),u.jsx("path",{d:"M7 21H5a2 2 0 0 1-2-2v-2"}),u.jsx("line",{x1:"7",y1:"12",x2:"17",y2:"12"})]}),u.jsx("span",{children:"Scan"})]}),u.jsxs("button",{className:"nut-add-btn nut-add-search",onClick:()=>{be("search"),Ye([]),Q("")},children:[u.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[u.jsx("circle",{cx:"11",cy:"11",r:"8"}),u.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),u.jsx("span",{children:"Search"})]}),u.jsxs("button",{className:"nut-add-btn nut-add-manual",onClick:()=>{be("manual"),He({name:"",protein:"",carbs:"",fats:"",calories:"",serving:""})},children:[u.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[u.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),u.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),u.jsx("span",{children:"Manual"})]})]}),u.jsxs("div",{className:"nut-water-section",children:[u.jsxs("div",{className:"nut-water-header",children:[u.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:u.jsx("path",{d:"M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z"})}),u.jsx("span",{children:"Water"}),u.jsxs("span",{className:"nut-water-count",children:[G.water," / ",E?.waterGoal||8," glasses"]})]}),u.jsx("div",{className:"nut-water-glasses",children:[...Array(E?.waterGoal||8)].map((de,et)=>u.jsx("div",{className:`nut-water-glass ${et<G.water?"filled":""}`,children:u.jsx("svg",{viewBox:"0 0 24 24",fill:et<G.water?"currentColor":"none",stroke:"currentColor",strokeWidth:"1.5",children:u.jsx("path",{d:"M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z"})})},et))}),u.jsxs("div",{className:"nut-water-btns",children:[u.jsx("button",{onClick:mt,disabled:G.water<=0,children:"-"}),u.jsx("button",{onClick:st,children:"+"})]})]}),u.jsxs("div",{className:"nut-log-section",children:[u.jsx("h3",{children:"Today's Log"}),G.entries.length===0?u.jsx("div",{className:"nut-log-empty",children:u.jsx("p",{children:"No food logged yet today. Add your first meal above!"})}):u.jsx("div",{className:"nut-log-list",children:G.entries.map(de=>u.jsxs("div",{className:"nut-log-item",children:[u.jsxs("div",{className:"nut-log-item-info",children:[u.jsx("span",{className:"nut-log-item-name",children:de.name}),de.serving&&u.jsx("span",{className:"nut-log-item-serving",children:de.serving})]}),u.jsxs("div",{className:"nut-log-item-macros",children:[u.jsxs("span",{className:"nut-macro-p",children:[de.protein,"p"]}),u.jsxs("span",{className:"nut-macro-c",children:[de.carbs,"c"]}),u.jsxs("span",{className:"nut-macro-f",children:[de.fats,"f"]}),u.jsx("span",{className:"nut-macro-cal",children:de.calories})]}),u.jsx("button",{className:"nut-log-delete",onClick:()=>qt(de.id),"aria-label":"Remove",children:u.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[u.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),u.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]},de.id))})]})]}),ue&&u.jsx("div",{className:"nut-modal-overlay",onClick:()=>{Zt(),be(null),tt(null)},children:u.jsxs("div",{className:"nut-modal",onClick:de=>de.stopPropagation(),children:[u.jsxs("div",{className:"nut-modal-header",children:[u.jsx("h3",{children:ue==="scan"?"Scan Barcode":ue==="search"?"Search Food":"Manual Entry"}),u.jsx("button",{className:"nut-modal-close",onClick:()=>{Zt(),be(null),tt(null)},children:u.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[u.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),u.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),ue==="scan"&&!Ne&&u.jsxs("div",{className:"nut-scan-area",children:[u.jsx("div",{id:"barcode-reader",className:"nut-scanner-view"}),!Me&&u.jsxs("button",{className:"nut-scan-start-btn",onClick:wt,children:[u.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[u.jsx("path",{d:"M3 7V5a2 2 0 0 1 2-2h2"}),u.jsx("path",{d:"M17 3h2a2 2 0 0 1 2 2v2"}),u.jsx("path",{d:"M21 17v2a2 2 0 0 1-2 2h-2"}),u.jsx("path",{d:"M7 21H5a2 2 0 0 1-2-2v-2"}),u.jsx("line",{x1:"7",y1:"12",x2:"17",y2:"12"})]}),"Open Camera"]}),Me&&u.jsx("p",{className:"nut-scan-hint",children:"Point camera at barcode..."}),u.jsx("div",{className:"nut-barcode-divider",children:u.jsx("span",{children:"or enter barcode manually"})}),u.jsxs("div",{className:"nut-barcode-manual",children:[u.jsx("input",{type:"text",inputMode:"numeric",value:P,onChange:de=>F(de.target.value),onKeyDown:de=>de.key==="Enter"&&P.trim()&&zt(P.trim()),placeholder:"Enter barcode number"}),u.jsx("button",{onClick:()=>P.trim()&&zt(P.trim()),disabled:!P.trim()||B,children:B?"...":"Look Up"})]})]}),ue==="scan"&&Ne&&u.jsxs("div",{className:"nut-product-result",children:[Ne.image&&u.jsx("img",{src:Ne.image,alt:"",className:"nut-product-img"}),u.jsx("h4",{children:Ne.name}),Ne.brand&&u.jsx("p",{className:"nut-product-brand",children:Ne.brand}),u.jsx("p",{className:"nut-product-per",children:"Per 100g:"}),u.jsxs("div",{className:"nut-product-macros",children:[u.jsxs("span",{className:"nut-macro-p",children:[Ne.protein,"g P"]}),u.jsxs("span",{className:"nut-macro-c",children:[Ne.carbs,"g C"]}),u.jsxs("span",{className:"nut-macro-f",children:[Ne.fats,"g F"]}),u.jsxs("span",{className:"nut-macro-cal",children:[Ne.calories," cal"]})]}),u.jsxs("div",{className:"nut-serving-adjust",children:[u.jsx("label",{children:"Serving (g)"}),u.jsx("input",{type:"number",value:Math.round(L*100),onChange:de=>oe(Math.max(0,parseFloat(de.target.value)||0)/100),min:"1"})]}),u.jsx("div",{className:"nut-product-total",children:u.jsxs("span",{children:["Total: ",Math.round(Ne.protein*L),"p / ",Math.round(Ne.carbs*L),"c / ",Math.round(Ne.fats*L),"f / ",Math.round(Ne.calories*L)," cal"]})}),u.jsxs("div",{className:"nut-product-actions",children:[u.jsx("button",{className:"nut-btn-secondary",onClick:()=>{tt(null),be("scan")},children:"Scan Again"}),u.jsx("button",{className:"nut-btn-primary",onClick:()=>Le({name:Ne.name,protein:Math.round(Ne.protein*L),carbs:Math.round(Ne.carbs*L),fats:Math.round(Ne.fats*L),calories:Math.round(Ne.calories*L),serving:`${Math.round(L*100)}g`}),children:"Add"})]})]}),ue==="search"&&!Ne&&u.jsxs("div",{className:"nut-search-area",children:[u.jsxs("div",{className:"nut-search-bar",children:[u.jsx("input",{type:"text",value:Z,onChange:de=>Q(de.target.value),onKeyDown:de=>de.key==="Enter"&&Pt(),placeholder:"Search food or product...",autoFocus:!0}),u.jsx("button",{onClick:Pt,disabled:me,children:me?"...":"Search"})]}),u.jsxs("div",{className:"nut-search-results",children:[z.map((de,et)=>u.jsxs("button",{className:"nut-search-item",onClick:()=>{tt(de),oe(1)},children:[de.image&&u.jsx("img",{src:de.image,alt:""}),u.jsxs("div",{className:"nut-search-item-info",children:[u.jsx("span",{className:"nut-search-item-name",children:de.name}),de.brand&&u.jsx("span",{className:"nut-search-item-brand",children:de.brand}),u.jsxs("span",{className:"nut-search-item-macros",children:[de.calories," cal  ",de.protein,"p  ",de.carbs,"c  ",de.fats,"f per 100g"]})]})]},et)),z.length===0&&Z&&!me&&u.jsx("p",{className:"nut-search-empty",children:"No results found. Try a different search or use manual entry."})]})]}),ue==="search"&&Ne&&u.jsxs("div",{className:"nut-product-result",children:[Ne.image&&u.jsx("img",{src:Ne.image,alt:"",className:"nut-product-img"}),u.jsx("h4",{children:Ne.name}),Ne.brand&&u.jsx("p",{className:"nut-product-brand",children:Ne.brand}),u.jsx("p",{className:"nut-product-per",children:"Per 100g:"}),u.jsxs("div",{className:"nut-product-macros",children:[u.jsxs("span",{className:"nut-macro-p",children:[Ne.protein,"g P"]}),u.jsxs("span",{className:"nut-macro-c",children:[Ne.carbs,"g C"]}),u.jsxs("span",{className:"nut-macro-f",children:[Ne.fats,"g F"]}),u.jsxs("span",{className:"nut-macro-cal",children:[Ne.calories," cal"]})]}),u.jsxs("div",{className:"nut-serving-adjust",children:[u.jsx("label",{children:"Serving (g)"}),u.jsx("input",{type:"number",value:Math.round(L*100),onChange:de=>oe(Math.max(0,parseFloat(de.target.value)||0)/100),min:"1"})]}),u.jsx("div",{className:"nut-product-total",children:u.jsxs("span",{children:["Total: ",Math.round(Ne.protein*L),"p / ",Math.round(Ne.carbs*L),"c / ",Math.round(Ne.fats*L),"f / ",Math.round(Ne.calories*L)," cal"]})}),u.jsxs("div",{className:"nut-product-actions",children:[u.jsx("button",{className:"nut-btn-secondary",onClick:()=>tt(null),children:"Back to Search"}),u.jsx("button",{className:"nut-btn-primary",onClick:()=>Le({name:Ne.name,protein:Math.round(Ne.protein*L),carbs:Math.round(Ne.carbs*L),fats:Math.round(Ne.fats*L),calories:Math.round(Ne.calories*L),serving:`${Math.round(L*100)}g`}),children:"Add"})]})]}),ue==="manual"&&u.jsxs("div",{className:"nut-manual-form",children:[u.jsxs("div",{className:"nut-form-group",children:[u.jsx("label",{children:"Food Name"}),u.jsx("input",{type:"text",value:ge.name,onChange:de=>He(et=>({...et,name:de.target.value})),placeholder:"e.g. Chicken Breast",autoFocus:!0})]}),u.jsxs("div",{className:"nut-form-group",children:[u.jsx("label",{children:"Serving Size (optional)"}),u.jsx("input",{type:"text",value:ge.serving,onChange:de=>He(et=>({...et,serving:de.target.value})),placeholder:"e.g. 150g, 1 cup"})]}),u.jsxs("div",{className:"nut-manual-macros",children:[u.jsxs("div",{className:"nut-form-group",children:[u.jsx("label",{children:"Protein (g)"}),u.jsx("input",{type:"number",value:ge.protein,onChange:de=>He(et=>({...et,protein:de.target.value})),min:"0"})]}),u.jsxs("div",{className:"nut-form-group",children:[u.jsx("label",{children:"Carbs (g)"}),u.jsx("input",{type:"number",value:ge.carbs,onChange:de=>He(et=>({...et,carbs:de.target.value})),min:"0"})]}),u.jsxs("div",{className:"nut-form-group",children:[u.jsx("label",{children:"Fats (g)"}),u.jsx("input",{type:"number",value:ge.fats,onChange:de=>He(et=>({...et,fats:de.target.value})),min:"0"})]}),u.jsxs("div",{className:"nut-form-group",children:[u.jsx("label",{children:"Calories"}),u.jsx("input",{type:"number",value:ge.calories,onChange:de=>He(et=>({...et,calories:de.target.value})),min:"0"})]})]}),u.jsx("button",{className:"nut-btn-primary",disabled:!ge.name.trim(),onClick:()=>Le({name:ge.name,protein:parseFloat(ge.protein)||0,carbs:parseFloat(ge.carbs)||0,fats:parseFloat(ge.fats)||0,calories:parseFloat(ge.calories)||0,serving:ge.serving||""}),children:"Add Food"})]})]})}),ce&&u.jsx("div",{className:`toast-notification ${ce.type}`,children:ce.message})]})}function OR(){const{pathname:i}=Ua();return H.useEffect(()=>{window.scrollTo(0,0)},[i]),null}function jR(){const i=ai();return H.useEffect(()=>{const e=sessionStorage.getItem("redirect");if(e){sessionStorage.removeItem("redirect");const t=e.replace("/login","")||"/";i(t,{replace:!0})}},[i]),null}function LR(){return u.jsx(b8,{children:u.jsx(w8,{children:u.jsxs(HC,{basename:"/login",children:[u.jsx(OR,{}),u.jsx(jR,{}),u.jsxs(vC,{children:[u.jsx(mi,{path:"/",element:u.jsx(E8,{})}),u.jsx(mi,{path:"/dashboard",element:u.jsx(B8,{})}),u.jsx(mi,{path:"/add-client",element:u.jsx(F8,{})}),u.jsx(mi,{path:"/client",element:u.jsx(W8,{})}),u.jsx(mi,{path:"/client/forms",element:u.jsx(Y8,{})}),u.jsx(mi,{path:"/client/tools",element:u.jsx(X8,{})}),u.jsx(mi,{path:"/client/tools/macros",element:u.jsx(K8,{})}),u.jsx(mi,{path:"/client/tools/snacks",element:u.jsx(Q8,{})}),u.jsx(mi,{path:"/client/tools/motivation",element:u.jsx(Z8,{})}),u.jsx(mi,{path:"/client/personal-bests",element:u.jsx(eR,{})}),u.jsx(mi,{path:"/client/circuit",element:u.jsx(nR,{})}),u.jsx(mi,{path:"/client/circuit/booking",element:u.jsx(rR,{})}),u.jsx(mi,{path:"/client/core-buddy",element:u.jsx(aR,{})}),u.jsx(mi,{path:"/client/core-buddy/nutrition",element:u.jsx(MR,{})}),u.jsx(mi,{path:"*",element:u.jsx(yC,{to:"/",replace:!0})})]})]})})})}bA.createRoot(document.getElementById("root")).render(u.jsx(H.StrictMode,{children:u.jsx(LR,{})}));
