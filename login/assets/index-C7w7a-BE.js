const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Dashboard-ByFx2QoU.js","assets/Dashboard-kTCGLGDk.css","assets/AddClient-CQAUtRgK.js","assets/AddClient-DH1OFzHo.css","assets/ClientForms-C_FTmrLl.js","assets/ClientForms-GDNtnrAx.css","assets/ClientTools-Cm_5Pxop.js","assets/ClientTools-DQRPoST3.css","assets/MacroCalculator-BckXyetb.js","assets/ProteinSnacks-DVgisA-p.js","assets/DailyMotivation-CU5UVvtp.js","assets/CircuitDashboard-BlpNXdsN.js","assets/CircuitDashboard-C8T0uect.css","assets/CircuitBooking-BAgYrKqo.js","assets/CircuitBooking-ruk9Q4Wj.css","assets/Leaderboard-Bwf80T9N.js","assets/Leaderboard-Dq-r5svP.css","assets/UpgradePage-C8upnP2j.js","assets/stripe-7qEIN5w7.js","assets/UpgradePage-Blt11CID.css","assets/Onboarding-CyY-27ss.js","assets/Onboarding-Bku4iVdQ.css"])))=>i.map(i=>d[i]);
(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))i(l);new MutationObserver(l=>{for(const u of l)if(u.type==="childList")for(const d of u.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&i(d)}).observe(document,{childList:!0,subtree:!0});function t(l){const u={};return l.integrity&&(u.integrity=l.integrity),l.referrerPolicy&&(u.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?u.credentials="include":l.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function i(l){if(l.ep)return;l.ep=!0;const u=t(l);fetch(l.href,u)}})();var fp={exports:{}},Hc={};var g1;function mT(){if(g1)return Hc;g1=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(i,l,u){var d=null;if(u!==void 0&&(d=""+u),l.key!==void 0&&(d=""+l.key),"key"in l){u={};for(var p in l)p!=="key"&&(u[p]=l[p])}else u=l;return l=u.ref,{$$typeof:n,type:i,key:d,ref:l!==void 0?l:null,props:u}}return Hc.Fragment=e,Hc.jsx=t,Hc.jsxs=t,Hc}var y1;function fT(){return y1||(y1=1,fp.exports=mT()),fp.exports}var r=fT(),pp={exports:{}},Xt={};var b1;function pT(){if(b1)return Xt;b1=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),l=Symbol.for("react.profiler"),u=Symbol.for("react.consumer"),d=Symbol.for("react.context"),p=Symbol.for("react.forward_ref"),g=Symbol.for("react.suspense"),y=Symbol.for("react.memo"),w=Symbol.for("react.lazy"),k=Symbol.for("react.activity"),j=Symbol.iterator;function O(P){return P===null||typeof P!="object"?null:(P=j&&P[j]||P["@@iterator"],typeof P=="function"?P:null)}var H={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},B=Object.assign,V={};function se(P,re,Re){this.props=P,this.context=re,this.refs=V,this.updater=Re||H}se.prototype.isReactComponent={},se.prototype.setState=function(P,re){if(typeof P!="object"&&typeof P!="function"&&P!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,P,re,"setState")},se.prototype.forceUpdate=function(P){this.updater.enqueueForceUpdate(this,P,"forceUpdate")};function K(){}K.prototype=se.prototype;function oe(P,re,Re){this.props=P,this.context=re,this.refs=V,this.updater=Re||H}var ye=oe.prototype=new K;ye.constructor=oe,B(ye,se.prototype),ye.isPureReactComponent=!0;var Pe=Array.isArray;function Ee(){}var R={H:null,A:null,T:null,S:null},T=Object.prototype.hasOwnProperty;function A(P,re,Re){var Le=Re.ref;return{$$typeof:n,type:P,key:re,ref:Le!==void 0?Le:null,props:Re}}function L(P,re){return A(P.type,re,P.props)}function D(P){return typeof P=="object"&&P!==null&&P.$$typeof===n}function z(P){var re={"=":"=0",":":"=2"};return"$"+P.replace(/[=:]/g,function(Re){return re[Re]})}var M=/\/+/g;function Ge(P,re){return typeof P=="object"&&P!==null&&P.key!=null?z(""+P.key):re.toString(36)}function mt(P){switch(P.status){case"fulfilled":return P.value;case"rejected":throw P.reason;default:switch(typeof P.status=="string"?P.then(Ee,Ee):(P.status="pending",P.then(function(re){P.status==="pending"&&(P.status="fulfilled",P.value=re)},function(re){P.status==="pending"&&(P.status="rejected",P.reason=re)})),P.status){case"fulfilled":return P.value;case"rejected":throw P.reason}}throw P}function $(P,re,Re,Le,tt){var qe=typeof P;(qe==="undefined"||qe==="boolean")&&(P=null);var ft=!1;if(P===null)ft=!0;else switch(qe){case"bigint":case"string":case"number":ft=!0;break;case"object":switch(P.$$typeof){case n:case e:ft=!0;break;case w:return ft=P._init,$(ft(P._payload),re,Re,Le,tt)}}if(ft)return tt=tt(P),ft=Le===""?"."+Ge(P,0):Le,Pe(tt)?(Re="",ft!=null&&(Re=ft.replace(M,"$&/")+"/"),$(tt,re,Re,"",function(Wt){return Wt})):tt!=null&&(D(tt)&&(tt=L(tt,Re+(tt.key==null||P&&P.key===tt.key?"":(""+tt.key).replace(M,"$&/")+"/")+ft)),re.push(tt)),1;ft=0;var kt=Le===""?".":Le+":";if(Pe(P))for(var rt=0;rt<P.length;rt++)Le=P[rt],qe=kt+Ge(Le,rt),ft+=$(Le,re,Re,qe,tt);else if(rt=O(P),typeof rt=="function")for(P=rt.call(P),rt=0;!(Le=P.next()).done;)Le=Le.value,qe=kt+Ge(Le,rt++),ft+=$(Le,re,Re,qe,tt);else if(qe==="object"){if(typeof P.then=="function")return $(mt(P),re,Re,Le,tt);throw re=String(P),Error("Objects are not valid as a React child (found: "+(re==="[object Object]"?"object with keys {"+Object.keys(P).join(", ")+"}":re)+"). If you meant to render a collection of children, use an array instead.")}return ft}function pe(P,re,Re){if(P==null)return P;var Le=[],tt=0;return $(P,Le,"","",function(qe){return re.call(Re,qe,tt++)}),Le}function Me(P){if(P._status===-1){var re=P._result;re=re(),re.then(function(Re){(P._status===0||P._status===-1)&&(P._status=1,P._result=Re)},function(Re){(P._status===0||P._status===-1)&&(P._status=2,P._result=Re)}),P._status===-1&&(P._status=0,P._result=re)}if(P._status===1)return P._result.default;throw P._result}var Qe=typeof reportError=="function"?reportError:function(P){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var re=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof P=="object"&&P!==null&&typeof P.message=="string"?String(P.message):String(P),error:P});if(!window.dispatchEvent(re))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",P);return}console.error(P)},X={map:pe,forEach:function(P,re,Re){pe(P,function(){re.apply(this,arguments)},Re)},count:function(P){var re=0;return pe(P,function(){re++}),re},toArray:function(P){return pe(P,function(re){return re})||[]},only:function(P){if(!D(P))throw Error("React.Children.only expected to receive a single React element child.");return P}};return Xt.Activity=k,Xt.Children=X,Xt.Component=se,Xt.Fragment=t,Xt.Profiler=l,Xt.PureComponent=oe,Xt.StrictMode=i,Xt.Suspense=g,Xt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=R,Xt.__COMPILER_RUNTIME={__proto__:null,c:function(P){return R.H.useMemoCache(P)}},Xt.cache=function(P){return function(){return P.apply(null,arguments)}},Xt.cacheSignal=function(){return null},Xt.cloneElement=function(P,re,Re){if(P==null)throw Error("The argument must be a React element, but you passed "+P+".");var Le=B({},P.props),tt=P.key;if(re!=null)for(qe in re.key!==void 0&&(tt=""+re.key),re)!T.call(re,qe)||qe==="key"||qe==="__self"||qe==="__source"||qe==="ref"&&re.ref===void 0||(Le[qe]=re[qe]);var qe=arguments.length-2;if(qe===1)Le.children=Re;else if(1<qe){for(var ft=Array(qe),kt=0;kt<qe;kt++)ft[kt]=arguments[kt+2];Le.children=ft}return A(P.type,tt,Le)},Xt.createContext=function(P){return P={$$typeof:d,_currentValue:P,_currentValue2:P,_threadCount:0,Provider:null,Consumer:null},P.Provider=P,P.Consumer={$$typeof:u,_context:P},P},Xt.createElement=function(P,re,Re){var Le,tt={},qe=null;if(re!=null)for(Le in re.key!==void 0&&(qe=""+re.key),re)T.call(re,Le)&&Le!=="key"&&Le!=="__self"&&Le!=="__source"&&(tt[Le]=re[Le]);var ft=arguments.length-2;if(ft===1)tt.children=Re;else if(1<ft){for(var kt=Array(ft),rt=0;rt<ft;rt++)kt[rt]=arguments[rt+2];tt.children=kt}if(P&&P.defaultProps)for(Le in ft=P.defaultProps,ft)tt[Le]===void 0&&(tt[Le]=ft[Le]);return A(P,qe,tt)},Xt.createRef=function(){return{current:null}},Xt.forwardRef=function(P){return{$$typeof:p,render:P}},Xt.isValidElement=D,Xt.lazy=function(P){return{$$typeof:w,_payload:{_status:-1,_result:P},_init:Me}},Xt.memo=function(P,re){return{$$typeof:y,type:P,compare:re===void 0?null:re}},Xt.startTransition=function(P){var re=R.T,Re={};R.T=Re;try{var Le=P(),tt=R.S;tt!==null&&tt(Re,Le),typeof Le=="object"&&Le!==null&&typeof Le.then=="function"&&Le.then(Ee,Qe)}catch(qe){Qe(qe)}finally{re!==null&&Re.types!==null&&(re.types=Re.types),R.T=re}},Xt.unstable_useCacheRefresh=function(){return R.H.useCacheRefresh()},Xt.use=function(P){return R.H.use(P)},Xt.useActionState=function(P,re,Re){return R.H.useActionState(P,re,Re)},Xt.useCallback=function(P,re){return R.H.useCallback(P,re)},Xt.useContext=function(P){return R.H.useContext(P)},Xt.useDebugValue=function(){},Xt.useDeferredValue=function(P,re){return R.H.useDeferredValue(P,re)},Xt.useEffect=function(P,re){return R.H.useEffect(P,re)},Xt.useEffectEvent=function(P){return R.H.useEffectEvent(P)},Xt.useId=function(){return R.H.useId()},Xt.useImperativeHandle=function(P,re,Re){return R.H.useImperativeHandle(P,re,Re)},Xt.useInsertionEffect=function(P,re){return R.H.useInsertionEffect(P,re)},Xt.useLayoutEffect=function(P,re){return R.H.useLayoutEffect(P,re)},Xt.useMemo=function(P,re){return R.H.useMemo(P,re)},Xt.useOptimistic=function(P,re){return R.H.useOptimistic(P,re)},Xt.useReducer=function(P,re,Re){return R.H.useReducer(P,re,Re)},Xt.useRef=function(P){return R.H.useRef(P)},Xt.useState=function(P){return R.H.useState(P)},Xt.useSyncExternalStore=function(P,re,Re){return R.H.useSyncExternalStore(P,re,Re)},Xt.useTransition=function(){return R.H.useTransition()},Xt.version="19.2.4",Xt}var v1;function Rg(){return v1||(v1=1,pp.exports=pT()),pp.exports}var v=Rg(),gp={exports:{}},$c={},yp={exports:{}},bp={};var x1;function gT(){return x1||(x1=1,(function(n){function e($,pe){var Me=$.length;$.push(pe);e:for(;0<Me;){var Qe=Me-1>>>1,X=$[Qe];if(0<l(X,pe))$[Qe]=pe,$[Me]=X,Me=Qe;else break e}}function t($){return $.length===0?null:$[0]}function i($){if($.length===0)return null;var pe=$[0],Me=$.pop();if(Me!==pe){$[0]=Me;e:for(var Qe=0,X=$.length,P=X>>>1;Qe<P;){var re=2*(Qe+1)-1,Re=$[re],Le=re+1,tt=$[Le];if(0>l(Re,Me))Le<X&&0>l(tt,Re)?($[Qe]=tt,$[Le]=Me,Qe=Le):($[Qe]=Re,$[re]=Me,Qe=re);else if(Le<X&&0>l(tt,Me))$[Qe]=tt,$[Le]=Me,Qe=Le;else break e}}return pe}function l($,pe){var Me=$.sortIndex-pe.sortIndex;return Me!==0?Me:$.id-pe.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var u=performance;n.unstable_now=function(){return u.now()}}else{var d=Date,p=d.now();n.unstable_now=function(){return d.now()-p}}var g=[],y=[],w=1,k=null,j=3,O=!1,H=!1,B=!1,V=!1,se=typeof setTimeout=="function"?setTimeout:null,K=typeof clearTimeout=="function"?clearTimeout:null,oe=typeof setImmediate<"u"?setImmediate:null;function ye($){for(var pe=t(y);pe!==null;){if(pe.callback===null)i(y);else if(pe.startTime<=$)i(y),pe.sortIndex=pe.expirationTime,e(g,pe);else break;pe=t(y)}}function Pe($){if(B=!1,ye($),!H)if(t(g)!==null)H=!0,Ee||(Ee=!0,z());else{var pe=t(y);pe!==null&&mt(Pe,pe.startTime-$)}}var Ee=!1,R=-1,T=5,A=-1;function L(){return V?!0:!(n.unstable_now()-A<T)}function D(){if(V=!1,Ee){var $=n.unstable_now();A=$;var pe=!0;try{e:{H=!1,B&&(B=!1,K(R),R=-1),O=!0;var Me=j;try{t:{for(ye($),k=t(g);k!==null&&!(k.expirationTime>$&&L());){var Qe=k.callback;if(typeof Qe=="function"){k.callback=null,j=k.priorityLevel;var X=Qe(k.expirationTime<=$);if($=n.unstable_now(),typeof X=="function"){k.callback=X,ye($),pe=!0;break t}k===t(g)&&i(g),ye($)}else i(g);k=t(g)}if(k!==null)pe=!0;else{var P=t(y);P!==null&&mt(Pe,P.startTime-$),pe=!1}}break e}finally{k=null,j=Me,O=!1}pe=void 0}}finally{pe?z():Ee=!1}}}var z;if(typeof oe=="function")z=function(){oe(D)};else if(typeof MessageChannel<"u"){var M=new MessageChannel,Ge=M.port2;M.port1.onmessage=D,z=function(){Ge.postMessage(null)}}else z=function(){se(D,0)};function mt($,pe){R=se(function(){$(n.unstable_now())},pe)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function($){$.callback=null},n.unstable_forceFrameRate=function($){0>$||125<$?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<$?Math.floor(1e3/$):5},n.unstable_getCurrentPriorityLevel=function(){return j},n.unstable_next=function($){switch(j){case 1:case 2:case 3:var pe=3;break;default:pe=j}var Me=j;j=pe;try{return $()}finally{j=Me}},n.unstable_requestPaint=function(){V=!0},n.unstable_runWithPriority=function($,pe){switch($){case 1:case 2:case 3:case 4:case 5:break;default:$=3}var Me=j;j=$;try{return pe()}finally{j=Me}},n.unstable_scheduleCallback=function($,pe,Me){var Qe=n.unstable_now();switch(typeof Me=="object"&&Me!==null?(Me=Me.delay,Me=typeof Me=="number"&&0<Me?Qe+Me:Qe):Me=Qe,$){case 1:var X=-1;break;case 2:X=250;break;case 5:X=1073741823;break;case 4:X=1e4;break;default:X=5e3}return X=Me+X,$={id:w++,callback:pe,priorityLevel:$,startTime:Me,expirationTime:X,sortIndex:-1},Me>Qe?($.sortIndex=Me,e(y,$),t(g)===null&&$===t(y)&&(B?(K(R),R=-1):B=!0,mt(Pe,Me-Qe))):($.sortIndex=X,e(g,$),H||O||(H=!0,Ee||(Ee=!0,z()))),$},n.unstable_shouldYield=L,n.unstable_wrapCallback=function($){var pe=j;return function(){var Me=j;j=pe;try{return $.apply(this,arguments)}finally{j=Me}}}})(bp)),bp}var w1;function yT(){return w1||(w1=1,yp.exports=gT()),yp.exports}var vp={exports:{}},ar={};var _1;function bT(){if(_1)return ar;_1=1;var n=Rg();function e(g){var y="https://react.dev/errors/"+g;if(1<arguments.length){y+="?args[]="+encodeURIComponent(arguments[1]);for(var w=2;w<arguments.length;w++)y+="&args[]="+encodeURIComponent(arguments[w])}return"Minified React error #"+g+"; visit "+y+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var i={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},l=Symbol.for("react.portal");function u(g,y,w){var k=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:l,key:k==null?null:""+k,children:g,containerInfo:y,implementation:w}}var d=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function p(g,y){if(g==="font")return"";if(typeof y=="string")return y==="use-credentials"?y:""}return ar.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,ar.createPortal=function(g,y){var w=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!y||y.nodeType!==1&&y.nodeType!==9&&y.nodeType!==11)throw Error(e(299));return u(g,y,null,w)},ar.flushSync=function(g){var y=d.T,w=i.p;try{if(d.T=null,i.p=2,g)return g()}finally{d.T=y,i.p=w,i.d.f()}},ar.preconnect=function(g,y){typeof g=="string"&&(y?(y=y.crossOrigin,y=typeof y=="string"?y==="use-credentials"?y:"":void 0):y=null,i.d.C(g,y))},ar.prefetchDNS=function(g){typeof g=="string"&&i.d.D(g)},ar.preinit=function(g,y){if(typeof g=="string"&&y&&typeof y.as=="string"){var w=y.as,k=p(w,y.crossOrigin),j=typeof y.integrity=="string"?y.integrity:void 0,O=typeof y.fetchPriority=="string"?y.fetchPriority:void 0;w==="style"?i.d.S(g,typeof y.precedence=="string"?y.precedence:void 0,{crossOrigin:k,integrity:j,fetchPriority:O}):w==="script"&&i.d.X(g,{crossOrigin:k,integrity:j,fetchPriority:O,nonce:typeof y.nonce=="string"?y.nonce:void 0})}},ar.preinitModule=function(g,y){if(typeof g=="string")if(typeof y=="object"&&y!==null){if(y.as==null||y.as==="script"){var w=p(y.as,y.crossOrigin);i.d.M(g,{crossOrigin:w,integrity:typeof y.integrity=="string"?y.integrity:void 0,nonce:typeof y.nonce=="string"?y.nonce:void 0})}}else y==null&&i.d.M(g)},ar.preload=function(g,y){if(typeof g=="string"&&typeof y=="object"&&y!==null&&typeof y.as=="string"){var w=y.as,k=p(w,y.crossOrigin);i.d.L(g,w,{crossOrigin:k,integrity:typeof y.integrity=="string"?y.integrity:void 0,nonce:typeof y.nonce=="string"?y.nonce:void 0,type:typeof y.type=="string"?y.type:void 0,fetchPriority:typeof y.fetchPriority=="string"?y.fetchPriority:void 0,referrerPolicy:typeof y.referrerPolicy=="string"?y.referrerPolicy:void 0,imageSrcSet:typeof y.imageSrcSet=="string"?y.imageSrcSet:void 0,imageSizes:typeof y.imageSizes=="string"?y.imageSizes:void 0,media:typeof y.media=="string"?y.media:void 0})}},ar.preloadModule=function(g,y){if(typeof g=="string")if(y){var w=p(y.as,y.crossOrigin);i.d.m(g,{as:typeof y.as=="string"&&y.as!=="script"?y.as:void 0,crossOrigin:w,integrity:typeof y.integrity=="string"?y.integrity:void 0})}else i.d.m(g)},ar.requestFormReset=function(g){i.d.r(g)},ar.unstable_batchedUpdates=function(g,y){return g(y)},ar.useFormState=function(g,y,w){return d.H.useFormState(g,y,w)},ar.useFormStatus=function(){return d.H.useHostTransitionStatus()},ar.version="19.2.4",ar}var k1;function vT(){if(k1)return vp.exports;k1=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),vp.exports=bT(),vp.exports}var j1;function xT(){if(j1)return $c;j1=1;var n=yT(),e=Rg(),t=vT();function i(s){var a="https://react.dev/errors/"+s;if(1<arguments.length){a+="?args[]="+encodeURIComponent(arguments[1]);for(var o=2;o<arguments.length;o++)a+="&args[]="+encodeURIComponent(arguments[o])}return"Minified React error #"+s+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function l(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function u(s){var a=s,o=s;if(s.alternate)for(;a.return;)a=a.return;else{s=a;do a=s,(a.flags&4098)!==0&&(o=a.return),s=a.return;while(s)}return a.tag===3?o:null}function d(s){if(s.tag===13){var a=s.memoizedState;if(a===null&&(s=s.alternate,s!==null&&(a=s.memoizedState)),a!==null)return a.dehydrated}return null}function p(s){if(s.tag===31){var a=s.memoizedState;if(a===null&&(s=s.alternate,s!==null&&(a=s.memoizedState)),a!==null)return a.dehydrated}return null}function g(s){if(u(s)!==s)throw Error(i(188))}function y(s){var a=s.alternate;if(!a){if(a=u(s),a===null)throw Error(i(188));return a!==s?null:s}for(var o=s,c=a;;){var m=o.return;if(m===null)break;var f=m.alternate;if(f===null){if(c=m.return,c!==null){o=c;continue}break}if(m.child===f.child){for(f=m.child;f;){if(f===o)return g(m),s;if(f===c)return g(m),a;f=f.sibling}throw Error(i(188))}if(o.return!==c.return)o=m,c=f;else{for(var x=!1,N=m.child;N;){if(N===o){x=!0,o=m,c=f;break}if(N===c){x=!0,c=m,o=f;break}N=N.sibling}if(!x){for(N=f.child;N;){if(N===o){x=!0,o=f,c=m;break}if(N===c){x=!0,c=f,o=m;break}N=N.sibling}if(!x)throw Error(i(189))}}if(o.alternate!==c)throw Error(i(190))}if(o.tag!==3)throw Error(i(188));return o.stateNode.current===o?s:a}function w(s){var a=s.tag;if(a===5||a===26||a===27||a===6)return s;for(s=s.child;s!==null;){if(a=w(s),a!==null)return a;s=s.sibling}return null}var k=Object.assign,j=Symbol.for("react.element"),O=Symbol.for("react.transitional.element"),H=Symbol.for("react.portal"),B=Symbol.for("react.fragment"),V=Symbol.for("react.strict_mode"),se=Symbol.for("react.profiler"),K=Symbol.for("react.consumer"),oe=Symbol.for("react.context"),ye=Symbol.for("react.forward_ref"),Pe=Symbol.for("react.suspense"),Ee=Symbol.for("react.suspense_list"),R=Symbol.for("react.memo"),T=Symbol.for("react.lazy"),A=Symbol.for("react.activity"),L=Symbol.for("react.memo_cache_sentinel"),D=Symbol.iterator;function z(s){return s===null||typeof s!="object"?null:(s=D&&s[D]||s["@@iterator"],typeof s=="function"?s:null)}var M=Symbol.for("react.client.reference");function Ge(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===M?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case B:return"Fragment";case se:return"Profiler";case V:return"StrictMode";case Pe:return"Suspense";case Ee:return"SuspenseList";case A:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case H:return"Portal";case oe:return s.displayName||"Context";case K:return(s._context.displayName||"Context")+".Consumer";case ye:var a=s.render;return s=s.displayName,s||(s=a.displayName||a.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case R:return a=s.displayName||null,a!==null?a:Ge(s.type)||"Memo";case T:a=s._payload,s=s._init;try{return Ge(s(a))}catch{}}return null}var mt=Array.isArray,$=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,pe=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Me={pending:!1,data:null,method:null,action:null},Qe=[],X=-1;function P(s){return{current:s}}function re(s){0>X||(s.current=Qe[X],Qe[X]=null,X--)}function Re(s,a){X++,Qe[X]=s.current,s.current=a}var Le=P(null),tt=P(null),qe=P(null),ft=P(null);function kt(s,a){switch(Re(qe,a),Re(tt,s),Re(Le,null),a.nodeType){case 9:case 11:s=(s=a.documentElement)&&(s=s.namespaceURI)?B0(s):0;break;default:if(s=a.tagName,a=a.namespaceURI)a=B0(a),s=U0(a,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}re(Le),Re(Le,s)}function rt(){re(Le),re(tt),re(qe)}function Wt(s){s.memoizedState!==null&&Re(ft,s);var a=Le.current,o=U0(a,s.type);a!==o&&(Re(tt,s),Re(Le,o))}function _s(s){tt.current===s&&(re(Le),re(tt)),ft.current===s&&(re(ft),Uc._currentValue=Me)}var At,pt;function ue(s){if(At===void 0)try{throw Error()}catch(o){var a=o.stack.trim().match(/\n( *(at )?)/);At=a&&a[1]||"",pt=-1<o.stack.indexOf(`
    at`)?" (<anonymous>)":-1<o.stack.indexOf("@")?"@unknown:0:0":""}return`
`+At+s+pt}var Zt=!1;function Ae(s,a){if(!s||Zt)return"";Zt=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var c={DetermineComponentFrameRoot:function(){try{if(a){var Ce=function(){throw Error()};if(Object.defineProperty(Ce.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Ce,[])}catch(me){var le=me}Reflect.construct(s,[],Ce)}else{try{Ce.call()}catch(me){le=me}s.call(Ce.prototype)}}else{try{throw Error()}catch(me){le=me}(Ce=s())&&typeof Ce.catch=="function"&&Ce.catch(function(){})}}catch(me){if(me&&le&&typeof me.stack=="string")return[me.stack,le.stack]}return[null,null]}};c.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var m=Object.getOwnPropertyDescriptor(c.DetermineComponentFrameRoot,"name");m&&m.configurable&&Object.defineProperty(c.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var f=c.DetermineComponentFrameRoot(),x=f[0],N=f[1];if(x&&N){var U=x.split(`
`),ie=N.split(`
`);for(m=c=0;c<U.length&&!U[c].includes("DetermineComponentFrameRoot");)c++;for(;m<ie.length&&!ie[m].includes("DetermineComponentFrameRoot");)m++;if(c===U.length||m===ie.length)for(c=U.length-1,m=ie.length-1;1<=c&&0<=m&&U[c]!==ie[m];)m--;for(;1<=c&&0<=m;c--,m--)if(U[c]!==ie[m]){if(c!==1||m!==1)do if(c--,m--,0>m||U[c]!==ie[m]){var ke=`
`+U[c].replace(" at new "," at ");return s.displayName&&ke.includes("<anonymous>")&&(ke=ke.replace("<anonymous>",s.displayName)),ke}while(1<=c&&0<=m);break}}}finally{Zt=!1,Error.prepareStackTrace=o}return(o=s?s.displayName||s.name:"")?ue(o):""}function Fe(s,a){switch(s.tag){case 26:case 27:case 5:return ue(s.type);case 16:return ue("Lazy");case 13:return s.child!==a&&a!==null?ue("Suspense Fallback"):ue("Suspense");case 19:return ue("SuspenseList");case 0:case 15:return Ae(s.type,!1);case 11:return Ae(s.type.render,!1);case 1:return Ae(s.type,!0);case 31:return ue("Activity");default:return""}}function Ze(s){try{var a="",o=null;do a+=Fe(s,o),o=s,s=s.return;while(s);return a}catch(c){return`
Error generating stack: `+c.message+`
`+c.stack}}var Ke=Object.prototype.hasOwnProperty,Xe=n.unstable_scheduleCallback,Ct=n.unstable_cancelCallback,zs=n.unstable_shouldYield,gt=n.unstable_requestPaint,Ut=n.unstable_now,Bs=n.unstable_getCurrentPriorityLevel,qt=n.unstable_ImmediatePriority,Cs=n.unstable_UserBlockingPriority,is=n.unstable_NormalPriority,Ts=n.unstable_LowPriority,ce=n.unstable_IdlePriority,Se=n.log,Be=n.unstable_setDisableYieldValue,et=null,Ue=null;function De(s){if(typeof Se=="function"&&Be(s),Ue&&typeof Ue.setStrictMode=="function")try{Ue.setStrictMode(et,s)}catch{}}var He=Math.clz32?Math.clz32:Mt,wt=Math.log,yt=Math.LN2;function Mt(s){return s>>>=0,s===0?32:31-(wt(s)/yt|0)|0}var Yt=256,J=262144,be=4194304;function it(s){var a=s&42;if(a!==0)return a;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return s&261888;case 262144:case 524288:case 1048576:case 2097152:return s&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function Dt(s,a,o){var c=s.pendingLanes;if(c===0)return 0;var m=0,f=s.suspendedLanes,x=s.pingedLanes;s=s.warmLanes;var N=c&134217727;return N!==0?(c=N&~f,c!==0?m=it(c):(x&=N,x!==0?m=it(x):o||(o=N&~s,o!==0&&(m=it(o))))):(N=c&~f,N!==0?m=it(N):x!==0?m=it(x):o||(o=c&~s,o!==0&&(m=it(o)))),m===0?0:a!==0&&a!==m&&(a&f)===0&&(f=m&-m,o=a&-a,f>=o||f===32&&(o&4194048)!==0)?a:m}function jt(s,a){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&a)===0}function ss(s,a){switch(s){case 1:case 2:case 4:case 8:case 64:return a+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Qt(){var s=be;return be<<=1,(be&62914560)===0&&(be=4194304),s}function zt(s){for(var a=[],o=0;31>o;o++)a.push(s);return a}function Rs(s,a){s.pendingLanes|=a,a!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function Zs(s,a,o,c,m,f){var x=s.pendingLanes;s.pendingLanes=o,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=o,s.entangledLanes&=o,s.errorRecoveryDisabledLanes&=o,s.shellSuspendCounter=0;var N=s.entanglements,U=s.expirationTimes,ie=s.hiddenUpdates;for(o=x&~o;0<o;){var ke=31-He(o),Ce=1<<ke;N[ke]=0,U[ke]=-1;var le=ie[ke];if(le!==null)for(ie[ke]=null,ke=0;ke<le.length;ke++){var me=le[ke];me!==null&&(me.lane&=-536870913)}o&=~Ce}c!==0&&ds(s,c,0),f!==0&&m===0&&s.tag!==0&&(s.suspendedLanes|=f&~(x&~a))}function ds(s,a,o){s.pendingLanes|=a,s.suspendedLanes&=~a;var c=31-He(a);s.entangledLanes|=a,s.entanglements[c]=s.entanglements[c]|1073741824|o&261930}function Es(s,a){var o=s.entangledLanes|=a;for(s=s.entanglements;o;){var c=31-He(o),m=1<<c;m&a|s[c]&a&&(s[c]|=a),o&=~m}}function Ls(s,a){var o=a&-a;return o=(o&42)!==0?1:F(o),(o&(s.suspendedLanes|a))!==0?0:o}function F(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function ve(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function we(){var s=pe.p;return s!==0?s:(s=window.event,s===void 0?32:c1(s.type))}function _e(s,a){var o=pe.p;try{return pe.p=s,a()}finally{pe.p=o}}var ge=Math.random().toString(36).slice(2),at="__reactFiber$"+ge,Rt="__reactProps$"+ge,lt="__reactContainer$"+ge,bt="__reactEvents$"+ge,Tt="__reactListeners$"+ge,os="__reactHandles$"+ge,Bn="__reactResources$"+ge,fn="__reactMarker$"+ge;function _n(s){delete s[at],delete s[Rt],delete s[bt],delete s[Tt],delete s[os]}function Ys(s){var a=s[at];if(a)return a;for(var o=s.parentNode;o;){if(a=o[lt]||o[at]){if(o=a.alternate,a.child!==null||o!==null&&o.child!==null)for(s=G0(s);s!==null;){if(o=s[at])return o;s=G0(s)}return a}s=o,o=s.parentNode}return null}function G(s){if(s=s[at]||s[lt]){var a=s.tag;if(a===5||a===6||a===13||a===31||a===26||a===27||a===3)return s}return null}function he(s){var a=s.tag;if(a===5||a===26||a===27||a===6)return s.stateNode;throw Error(i(33))}function E(s){var a=s[Bn];return a||(a=s[Bn]={hoistableStyles:new Map,hoistableScripts:new Map}),a}function S(s){s[fn]=!0}var q=new Set,Z={};function $e(s,a){Oe(s,a),Oe(s+"Capture",a)}function Oe(s,a){for(Z[s]=a,s=0;s<a.length;s++)q.add(a[s])}var Ve=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),It={},Et={};function hs(s){return Ke.call(Et,s)?!0:Ke.call(It,s)?!1:Ve.test(s)?Et[s]=!0:(It[s]=!0,!1)}function an(s,a,o){if(hs(a))if(o===null)s.removeAttribute(a);else{switch(typeof o){case"undefined":case"function":case"symbol":s.removeAttribute(a);return;case"boolean":var c=a.toLowerCase().slice(0,5);if(c!=="data-"&&c!=="aria-"){s.removeAttribute(a);return}}s.setAttribute(a,""+o)}}function Hs(s,a,o){if(o===null)s.removeAttribute(a);else{switch(typeof o){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(a);return}s.setAttribute(a,""+o)}}function As(s,a,o,c){if(c===null)s.removeAttribute(o);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(o);return}s.setAttributeNS(a,o,""+c)}}function Is(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function Y(s){var a=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(a==="checkbox"||a==="radio")}function xe(s,a,o){var c=Object.getOwnPropertyDescriptor(s.constructor.prototype,a);if(!s.hasOwnProperty(a)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var m=c.get,f=c.set;return Object.defineProperty(s,a,{configurable:!0,get:function(){return m.call(this)},set:function(x){o=""+x,f.call(this,x)}}),Object.defineProperty(s,a,{enumerable:c.enumerable}),{getValue:function(){return o},setValue:function(x){o=""+x},stopTracking:function(){s._valueTracker=null,delete s[a]}}}}function te(s){if(!s._valueTracker){var a=Y(s)?"checked":"value";s._valueTracker=xe(s,a,""+s[a])}}function ze(s){if(!s)return!1;var a=s._valueTracker;if(!a)return!0;var o=a.getValue(),c="";return s&&(c=Y(s)?s.checked?"true":"false":s.value),s=c,s!==o?(a.setValue(s),!0):!1}function Ye(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var ct=/[\n"\\]/g;function xt(s){return s.replace(ct,function(a){return"\\"+a.charCodeAt(0).toString(16)+" "})}function Lt(s,a,o,c,m,f,x,N){s.name="",x!=null&&typeof x!="function"&&typeof x!="symbol"&&typeof x!="boolean"?s.type=x:s.removeAttribute("type"),a!=null?x==="number"?(a===0&&s.value===""||s.value!=a)&&(s.value=""+Is(a)):s.value!==""+Is(a)&&(s.value=""+Is(a)):x!=="submit"&&x!=="reset"||s.removeAttribute("value"),a!=null?un(s,x,Is(a)):o!=null?un(s,x,Is(o)):c!=null&&s.removeAttribute("value"),m==null&&f!=null&&(s.defaultChecked=!!f),m!=null&&(s.checked=m&&typeof m!="function"&&typeof m!="symbol"),N!=null&&typeof N!="function"&&typeof N!="symbol"&&typeof N!="boolean"?s.name=""+Is(N):s.removeAttribute("name")}function vs(s,a,o,c,m,f,x,N){if(f!=null&&typeof f!="function"&&typeof f!="symbol"&&typeof f!="boolean"&&(s.type=f),a!=null||o!=null){if(!(f!=="submit"&&f!=="reset"||a!=null)){te(s);return}o=o!=null?""+Is(o):"",a=a!=null?""+Is(a):o,N||a===s.value||(s.value=a),s.defaultValue=a}c=c??m,c=typeof c!="function"&&typeof c!="symbol"&&!!c,s.checked=N?s.checked:!!c,s.defaultChecked=!!c,x!=null&&typeof x!="function"&&typeof x!="symbol"&&typeof x!="boolean"&&(s.name=x),te(s)}function un(s,a,o){a==="number"&&Ye(s.ownerDocument)===s||s.defaultValue===""+o||(s.defaultValue=""+o)}function ms(s,a,o,c){if(s=s.options,a){a={};for(var m=0;m<o.length;m++)a["$"+o[m]]=!0;for(o=0;o<s.length;o++)m=a.hasOwnProperty("$"+s[o].value),s[o].selected!==m&&(s[o].selected=m),m&&c&&(s[o].defaultSelected=!0)}else{for(o=""+Is(o),a=null,m=0;m<s.length;m++){if(s[m].value===o){s[m].selected=!0,c&&(s[m].defaultSelected=!0);return}a!==null||s[m].disabled||(a=s[m])}a!==null&&(a.selected=!0)}}function Wn(s,a,o){if(a!=null&&(a=""+Is(a),a!==s.value&&(s.value=a),o==null)){s.defaultValue!==a&&(s.defaultValue=a);return}s.defaultValue=o!=null?""+Is(o):""}function Gr(s,a,o,c){if(a==null){if(c!=null){if(o!=null)throw Error(i(92));if(mt(c)){if(1<c.length)throw Error(i(93));c=c[0]}o=c}o==null&&(o=""),a=o}o=Is(a),s.defaultValue=o,c=s.textContent,c===o&&c!==""&&c!==null&&(s.value=c),te(s)}function pn(s,a){if(a){var o=s.firstChild;if(o&&o===s.lastChild&&o.nodeType===3){o.nodeValue=a;return}}s.textContent=a}var ja=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Un(s,a,o){var c=a.indexOf("--")===0;o==null||typeof o=="boolean"||o===""?c?s.setProperty(a,""):a==="float"?s.cssFloat="":s[a]="":c?s.setProperty(a,o):typeof o!="number"||o===0||ja.has(a)?a==="float"?s.cssFloat=o:s[a]=(""+o).trim():s[a]=o+"px"}function as(s,a,o){if(a!=null&&typeof a!="object")throw Error(i(62));if(s=s.style,o!=null){for(var c in o)!o.hasOwnProperty(c)||a!=null&&a.hasOwnProperty(c)||(c.indexOf("--")===0?s.setProperty(c,""):c==="float"?s.cssFloat="":s[c]="");for(var m in a)c=a[m],a.hasOwnProperty(m)&&o[m]!==c&&Un(s,m,c)}else for(var f in a)a.hasOwnProperty(f)&&Un(s,f,a[f])}function dn(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var sr=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Gn=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function _r(s){return Gn.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}function sn(){}var Pn=null;function Nn(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var kr=null,jr=null;function Dr(s){var a=G(s);if(a&&(s=a.stateNode)){var o=s[Rt]||null;e:switch(s=a.stateNode,a.type){case"input":if(Lt(s,o.value,o.defaultValue,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name),a=o.name,o.type==="radio"&&a!=null){for(o=s;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll('input[name="'+xt(""+a)+'"][type="radio"]'),a=0;a<o.length;a++){var c=o[a];if(c!==s&&c.form===s.form){var m=c[Rt]||null;if(!m)throw Error(i(90));Lt(c,m.value,m.defaultValue,m.defaultValue,m.checked,m.defaultChecked,m.type,m.name)}}for(a=0;a<o.length;a++)c=o[a],c.form===s.form&&ze(c)}break e;case"textarea":Wn(s,o.value,o.defaultValue);break e;case"select":a=o.value,a!=null&&ms(s,!!o.multiple,a,!1)}}}var wi=!1;function Ta(s,a,o){if(wi)return s(a,o);wi=!0;try{var c=s(a);return c}finally{if(wi=!1,(kr!==null||jr!==null)&&(Rd(),kr&&(a=kr,s=jr,jr=kr=null,Dr(a),s)))for(a=0;a<s.length;a++)Dr(s[a])}}function Pr(s,a){var o=s.stateNode;if(o===null)return null;var c=o[Rt]||null;if(c===null)return null;o=c[a];e:switch(a){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(c=!c.disabled)||(s=s.type,c=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!c;break e;default:s=!1}if(s)return null;if(o&&typeof o!="function")throw Error(i(231,a,typeof o));return o}var I=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ee=!1;if(I)try{var je={};Object.defineProperty(je,"passive",{get:function(){ee=!0}}),window.addEventListener("test",je,je),window.removeEventListener("test",je,je)}catch{ee=!1}var st=null,_t=null,Ot=null;function ot(){if(Ot)return Ot;var s,a=_t,o=a.length,c,m="value"in st?st.value:st.textContent,f=m.length;for(s=0;s<o&&a[s]===m[s];s++);var x=o-s;for(c=1;c<=x&&a[o-c]===m[f-c];c++);return Ot=m.slice(s,1<c?1-c:void 0)}function Ft(s){var a=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&a===13&&(s=13)):s=a,s===10&&(s=13),32<=s||s===13?s:0}function Gt(){return!0}function rs(){return!1}function Ht(s){function a(o,c,m,f,x){this._reactName=o,this._targetInst=m,this.type=c,this.nativeEvent=f,this.target=x,this.currentTarget=null;for(var N in s)s.hasOwnProperty(N)&&(o=s[N],this[N]=o?o(f):f[N]);return this.isDefaultPrevented=(f.defaultPrevented!=null?f.defaultPrevented:f.returnValue===!1)?Gt:rs,this.isPropagationStopped=rs,this}return k(a.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=Gt)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=Gt)},persist:function(){},isPersistent:Gt}),a}var xs={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},zn=Ht(xs),ur=k({},xs,{view:0,detail:0}),en=Ht(ur),Qs,Fn,hn,Ln=k({},ur,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:_i,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==hn&&(hn&&s.type==="mousemove"?(Qs=s.screenX-hn.screenX,Fn=s.screenY-hn.screenY):Fn=Qs=0,hn=s),Qs)},movementY:function(s){return"movementY"in s?s.movementY:Fn}}),nr=Ht(Ln),Kn=k({},Ln,{dataTransfer:0}),dr=Ht(Kn),rr=k({},ur,{relatedTarget:0}),gn=Ht(rr),hr=k({},xs,{animationName:0,elapsedTime:0,pseudoElement:0}),Tr=Ht(hr),Ha=k({},xs,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),tl=Ht(Ha),sl=k({},xs,{data:0}),mr=Ht(sl),ia={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},oa={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},$u={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Wu(s){var a=this.nativeEvent;return a.getModifierState?a.getModifierState(s):(s=$u[s])?!!a[s]:!1}function _i(){return Wu}var fr=k({},ur,{key:function(s){if(s.key){var a=ia[s.key]||s.key;if(a!=="Unidentified")return a}return s.type==="keypress"?(s=Ft(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?oa[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:_i,charCode:function(s){return s.type==="keypress"?Ft(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?Ft(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),Gu=Ht(fr),Ku=k({},Ln,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),$a=Ht(Ku),h=k({},ur,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:_i}),b=Ht(h),_=k({},xs,{propertyName:0,elapsedTime:0,pseudoElement:0}),C=Ht(_),ne=k({},Ln,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),de=Ht(ne),Je=k({},xs,{newState:0,oldState:0}),es=Ht(Je),kn=[9,13,27,32],Os=I&&"CompositionEvent"in window,on=null;I&&"documentMode"in document&&(on=document.documentMode);var Kr=I&&"TextEvent"in window&&!on,Ea=I&&(!Os||on&&8<on&&11>=on),la=" ",ca=!1;function bo(s,a){switch(s){case"keyup":return kn.indexOf(a.keyCode)!==-1;case"keydown":return a.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function nl(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var rl=!1;function Ok(s,a){switch(s){case"compositionend":return nl(a);case"keypress":return a.which!==32?null:(ca=!0,la);case"textInput":return s=a.data,s===la&&ca?null:s;default:return null}}function Vk(s,a){if(rl)return s==="compositionend"||!Os&&bo(s,a)?(s=ot(),Ot=_t=st=null,rl=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(a.ctrlKey||a.altKey||a.metaKey)||a.ctrlKey&&a.altKey){if(a.char&&1<a.char.length)return a.char;if(a.which)return String.fromCharCode(a.which)}return null;case"compositionend":return Ea&&a.locale!=="ko"?null:a.data;default:return null}}var Bk={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Qy(s){var a=s&&s.nodeName&&s.nodeName.toLowerCase();return a==="input"?!!Bk[s.type]:a==="textarea"}function Xy(s,a,o,c){kr?jr?jr.push(c):jr=[c]:kr=c,a=Od(a,"onChange"),0<a.length&&(o=new zn("onChange","change",null,o,c),s.push({event:o,listeners:a}))}var lc=null,cc=null;function Uk(s){M0(s,0)}function Yu(s){var a=he(s);if(ze(a))return s}function Jy(s,a){if(s==="change")return a}var Zy=!1;if(I){var xm;if(I){var wm="oninput"in document;if(!wm){var eb=document.createElement("div");eb.setAttribute("oninput","return;"),wm=typeof eb.oninput=="function"}xm=wm}else xm=!1;Zy=xm&&(!document.documentMode||9<document.documentMode)}function tb(){lc&&(lc.detachEvent("onpropertychange",sb),cc=lc=null)}function sb(s){if(s.propertyName==="value"&&Yu(cc)){var a=[];Xy(a,cc,s,Nn(s)),Ta(Uk,a)}}function zk(s,a,o){s==="focusin"?(tb(),lc=a,cc=o,lc.attachEvent("onpropertychange",sb)):s==="focusout"&&tb()}function Fk(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return Yu(cc)}function qk(s,a){if(s==="click")return Yu(a)}function Hk(s,a){if(s==="input"||s==="change")return Yu(a)}function $k(s,a){return s===a&&(s!==0||1/s===1/a)||s!==s&&a!==a}var Lr=typeof Object.is=="function"?Object.is:$k;function uc(s,a){if(Lr(s,a))return!0;if(typeof s!="object"||s===null||typeof a!="object"||a===null)return!1;var o=Object.keys(s),c=Object.keys(a);if(o.length!==c.length)return!1;for(c=0;c<o.length;c++){var m=o[c];if(!Ke.call(a,m)||!Lr(s[m],a[m]))return!1}return!0}function nb(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function rb(s,a){var o=nb(s);s=0;for(var c;o;){if(o.nodeType===3){if(c=s+o.textContent.length,s<=a&&c>=a)return{node:o,offset:a-s};s=c}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=nb(o)}}function ab(s,a){return s&&a?s===a?!0:s&&s.nodeType===3?!1:a&&a.nodeType===3?ab(s,a.parentNode):"contains"in s?s.contains(a):s.compareDocumentPosition?!!(s.compareDocumentPosition(a)&16):!1:!1}function ib(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var a=Ye(s.document);a instanceof s.HTMLIFrameElement;){try{var o=typeof a.contentWindow.location.href=="string"}catch{o=!1}if(o)s=a.contentWindow;else break;a=Ye(s.document)}return a}function _m(s){var a=s&&s.nodeName&&s.nodeName.toLowerCase();return a&&(a==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||a==="textarea"||s.contentEditable==="true")}var Wk=I&&"documentMode"in document&&11>=document.documentMode,al=null,km=null,dc=null,jm=!1;function ob(s,a,o){var c=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;jm||al==null||al!==Ye(c)||(c=al,"selectionStart"in c&&_m(c)?c={start:c.selectionStart,end:c.selectionEnd}:(c=(c.ownerDocument&&c.ownerDocument.defaultView||window).getSelection(),c={anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset}),dc&&uc(dc,c)||(dc=c,c=Od(km,"onSelect"),0<c.length&&(a=new zn("onSelect","select",null,a,o),s.push({event:a,listeners:c}),a.target=al)))}function vo(s,a){var o={};return o[s.toLowerCase()]=a.toLowerCase(),o["Webkit"+s]="webkit"+a,o["Moz"+s]="moz"+a,o}var il={animationend:vo("Animation","AnimationEnd"),animationiteration:vo("Animation","AnimationIteration"),animationstart:vo("Animation","AnimationStart"),transitionrun:vo("Transition","TransitionRun"),transitionstart:vo("Transition","TransitionStart"),transitioncancel:vo("Transition","TransitionCancel"),transitionend:vo("Transition","TransitionEnd")},Tm={},lb={};I&&(lb=document.createElement("div").style,"AnimationEvent"in window||(delete il.animationend.animation,delete il.animationiteration.animation,delete il.animationstart.animation),"TransitionEvent"in window||delete il.transitionend.transition);function xo(s){if(Tm[s])return Tm[s];if(!il[s])return s;var a=il[s],o;for(o in a)if(a.hasOwnProperty(o)&&o in lb)return Tm[s]=a[o];return s}var cb=xo("animationend"),ub=xo("animationiteration"),db=xo("animationstart"),Gk=xo("transitionrun"),Kk=xo("transitionstart"),Yk=xo("transitioncancel"),hb=xo("transitionend"),mb=new Map,Em="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Em.push("scrollEnd");function ua(s,a){mb.set(s,a),$e(a,[s])}var Qu=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var a=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(a))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)},Yr=[],ol=0,Nm=0;function Xu(){for(var s=ol,a=Nm=ol=0;a<s;){var o=Yr[a];Yr[a++]=null;var c=Yr[a];Yr[a++]=null;var m=Yr[a];Yr[a++]=null;var f=Yr[a];if(Yr[a++]=null,c!==null&&m!==null){var x=c.pending;x===null?m.next=m:(m.next=x.next,x.next=m),c.pending=m}f!==0&&fb(o,m,f)}}function Ju(s,a,o,c){Yr[ol++]=s,Yr[ol++]=a,Yr[ol++]=o,Yr[ol++]=c,Nm|=c,s.lanes|=c,s=s.alternate,s!==null&&(s.lanes|=c)}function Sm(s,a,o,c){return Ju(s,a,o,c),Zu(s)}function wo(s,a){return Ju(s,null,null,a),Zu(s)}function fb(s,a,o){s.lanes|=o;var c=s.alternate;c!==null&&(c.lanes|=o);for(var m=!1,f=s.return;f!==null;)f.childLanes|=o,c=f.alternate,c!==null&&(c.childLanes|=o),f.tag===22&&(s=f.stateNode,s===null||s._visibility&1||(m=!0)),s=f,f=f.return;return s.tag===3?(f=s.stateNode,m&&a!==null&&(m=31-He(o),s=f.hiddenUpdates,c=s[m],c===null?s[m]=[a]:c.push(a),a.lane=o|536870912),f):null}function Zu(s){if(50<Mc)throw Mc=0,Vf=null,Error(i(185));for(var a=s.return;a!==null;)s=a,a=s.return;return s.tag===3?s.stateNode:null}var ll={};function Qk(s,a,o,c){this.tag=s,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=a,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=c,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Or(s,a,o,c){return new Qk(s,a,o,c)}function Cm(s){return s=s.prototype,!(!s||!s.isReactComponent)}function Wa(s,a){var o=s.alternate;return o===null?(o=Or(s.tag,a,s.key,s.mode),o.elementType=s.elementType,o.type=s.type,o.stateNode=s.stateNode,o.alternate=s,s.alternate=o):(o.pendingProps=a,o.type=s.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=s.flags&65011712,o.childLanes=s.childLanes,o.lanes=s.lanes,o.child=s.child,o.memoizedProps=s.memoizedProps,o.memoizedState=s.memoizedState,o.updateQueue=s.updateQueue,a=s.dependencies,o.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext},o.sibling=s.sibling,o.index=s.index,o.ref=s.ref,o.refCleanup=s.refCleanup,o}function pb(s,a){s.flags&=65011714;var o=s.alternate;return o===null?(s.childLanes=0,s.lanes=a,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,a=o.dependencies,s.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),s}function ed(s,a,o,c,m,f){var x=0;if(c=s,typeof s=="function")Cm(s)&&(x=1);else if(typeof s=="string")x=tT(s,o,Le.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case A:return s=Or(31,o,a,m),s.elementType=A,s.lanes=f,s;case B:return _o(o.children,m,f,a);case V:x=8,m|=24;break;case se:return s=Or(12,o,a,m|2),s.elementType=se,s.lanes=f,s;case Pe:return s=Or(13,o,a,m),s.elementType=Pe,s.lanes=f,s;case Ee:return s=Or(19,o,a,m),s.elementType=Ee,s.lanes=f,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case oe:x=10;break e;case K:x=9;break e;case ye:x=11;break e;case R:x=14;break e;case T:x=16,c=null;break e}x=29,o=Error(i(130,s===null?"null":typeof s,"")),c=null}return a=Or(x,o,a,m),a.elementType=s,a.type=c,a.lanes=f,a}function _o(s,a,o,c){return s=Or(7,s,c,a),s.lanes=o,s}function Rm(s,a,o){return s=Or(6,s,null,a),s.lanes=o,s}function gb(s){var a=Or(18,null,null,0);return a.stateNode=s,a}function Am(s,a,o){return a=Or(4,s.children!==null?s.children:[],s.key,a),a.lanes=o,a.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},a}var yb=new WeakMap;function Qr(s,a){if(typeof s=="object"&&s!==null){var o=yb.get(s);return o!==void 0?o:(a={value:s,source:a,stack:Ze(a)},yb.set(s,a),a)}return{value:s,source:a,stack:Ze(a)}}var cl=[],ul=0,td=null,hc=0,Xr=[],Jr=0,ki=null,Na=1,Sa="";function Ga(s,a){cl[ul++]=hc,cl[ul++]=td,td=s,hc=a}function bb(s,a,o){Xr[Jr++]=Na,Xr[Jr++]=Sa,Xr[Jr++]=ki,ki=s;var c=Na;s=Sa;var m=32-He(c)-1;c&=~(1<<m),o+=1;var f=32-He(a)+m;if(30<f){var x=m-m%5;f=(c&(1<<x)-1).toString(32),c>>=x,m-=x,Na=1<<32-He(a)+m|o<<m|c,Sa=f+s}else Na=1<<f|o<<m|c,Sa=s}function Im(s){s.return!==null&&(Ga(s,1),bb(s,1,0))}function Mm(s){for(;s===td;)td=cl[--ul],cl[ul]=null,hc=cl[--ul],cl[ul]=null;for(;s===ki;)ki=Xr[--Jr],Xr[Jr]=null,Sa=Xr[--Jr],Xr[Jr]=null,Na=Xr[--Jr],Xr[Jr]=null}function vb(s,a){Xr[Jr++]=Na,Xr[Jr++]=Sa,Xr[Jr++]=ki,Na=a.id,Sa=a.overflow,ki=s}var Yn=null,nn=null,ws=!1,ji=null,Zr=!1,Dm=Error(i(519));function Ti(s){var a=Error(i(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw mc(Qr(a,s)),Dm}function xb(s){var a=s.stateNode,o=s.type,c=s.memoizedProps;switch(a[at]=s,a[Rt]=c,o){case"dialog":cs("cancel",a),cs("close",a);break;case"iframe":case"object":case"embed":cs("load",a);break;case"video":case"audio":for(o=0;o<Pc.length;o++)cs(Pc[o],a);break;case"source":cs("error",a);break;case"img":case"image":case"link":cs("error",a),cs("load",a);break;case"details":cs("toggle",a);break;case"input":cs("invalid",a),vs(a,c.value,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name,!0);break;case"select":cs("invalid",a);break;case"textarea":cs("invalid",a),Gr(a,c.value,c.defaultValue,c.children)}o=c.children,typeof o!="string"&&typeof o!="number"&&typeof o!="bigint"||a.textContent===""+o||c.suppressHydrationWarning===!0||O0(a.textContent,o)?(c.popover!=null&&(cs("beforetoggle",a),cs("toggle",a)),c.onScroll!=null&&cs("scroll",a),c.onScrollEnd!=null&&cs("scrollend",a),c.onClick!=null&&(a.onclick=sn),a=!0):a=!1,a||Ti(s,!0)}function wb(s){for(Yn=s.return;Yn;)switch(Yn.tag){case 5:case 31:case 13:Zr=!1;return;case 27:case 3:Zr=!0;return;default:Yn=Yn.return}}function dl(s){if(s!==Yn)return!1;if(!ws)return wb(s),ws=!0,!1;var a=s.tag,o;if((o=a!==3&&a!==27)&&((o=a===5)&&(o=s.type,o=!(o!=="form"&&o!=="button")||Zf(s.type,s.memoizedProps)),o=!o),o&&nn&&Ti(s),wb(s),a===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(317));nn=W0(s)}else if(a===31){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(317));nn=W0(s)}else a===27?(a=nn,Bi(s.type)?(s=rp,rp=null,nn=s):nn=a):nn=Yn?ta(s.stateNode.nextSibling):null;return!0}function ko(){nn=Yn=null,ws=!1}function Pm(){var s=ji;return s!==null&&(Cr===null?Cr=s:Cr.push.apply(Cr,s),ji=null),s}function mc(s){ji===null?ji=[s]:ji.push(s)}var Lm=P(null),jo=null,Ka=null;function Ei(s,a,o){Re(Lm,a._currentValue),a._currentValue=o}function Ya(s){s._currentValue=Lm.current,re(Lm)}function Om(s,a,o){for(;s!==null;){var c=s.alternate;if((s.childLanes&a)!==a?(s.childLanes|=a,c!==null&&(c.childLanes|=a)):c!==null&&(c.childLanes&a)!==a&&(c.childLanes|=a),s===o)break;s=s.return}}function Vm(s,a,o,c){var m=s.child;for(m!==null&&(m.return=s);m!==null;){var f=m.dependencies;if(f!==null){var x=m.child;f=f.firstContext;e:for(;f!==null;){var N=f;f=m;for(var U=0;U<a.length;U++)if(N.context===a[U]){f.lanes|=o,N=f.alternate,N!==null&&(N.lanes|=o),Om(f.return,o,s),c||(x=null);break e}f=N.next}}else if(m.tag===18){if(x=m.return,x===null)throw Error(i(341));x.lanes|=o,f=x.alternate,f!==null&&(f.lanes|=o),Om(x,o,s),x=null}else x=m.child;if(x!==null)x.return=m;else for(x=m;x!==null;){if(x===s){x=null;break}if(m=x.sibling,m!==null){m.return=x.return,x=m;break}x=x.return}m=x}}function hl(s,a,o,c){s=null;for(var m=a,f=!1;m!==null;){if(!f){if((m.flags&524288)!==0)f=!0;else if((m.flags&262144)!==0)break}if(m.tag===10){var x=m.alternate;if(x===null)throw Error(i(387));if(x=x.memoizedProps,x!==null){var N=m.type;Lr(m.pendingProps.value,x.value)||(s!==null?s.push(N):s=[N])}}else if(m===ft.current){if(x=m.alternate,x===null)throw Error(i(387));x.memoizedState.memoizedState!==m.memoizedState.memoizedState&&(s!==null?s.push(Uc):s=[Uc])}m=m.return}s!==null&&Vm(a,s,o,c),a.flags|=262144}function sd(s){for(s=s.firstContext;s!==null;){if(!Lr(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function To(s){jo=s,Ka=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function Qn(s){return _b(jo,s)}function nd(s,a){return jo===null&&To(s),_b(s,a)}function _b(s,a){var o=a._currentValue;if(a={context:a,memoizedValue:o,next:null},Ka===null){if(s===null)throw Error(i(308));Ka=a,s.dependencies={lanes:0,firstContext:a},s.flags|=524288}else Ka=Ka.next=a;return o}var Xk=typeof AbortController<"u"?AbortController:function(){var s=[],a=this.signal={aborted:!1,addEventListener:function(o,c){s.push(c)}};this.abort=function(){a.aborted=!0,s.forEach(function(o){return o()})}},Jk=n.unstable_scheduleCallback,Zk=n.unstable_NormalPriority,Sn={$$typeof:oe,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Bm(){return{controller:new Xk,data:new Map,refCount:0}}function fc(s){s.refCount--,s.refCount===0&&Jk(Zk,function(){s.controller.abort()})}var pc=null,Um=0,ml=0,fl=null;function ej(s,a){if(pc===null){var o=pc=[];Um=0,ml=Hf(),fl={status:"pending",value:void 0,then:function(c){o.push(c)}}}return Um++,a.then(kb,kb),a}function kb(){if(--Um===0&&pc!==null){fl!==null&&(fl.status="fulfilled");var s=pc;pc=null,ml=0,fl=null;for(var a=0;a<s.length;a++)(0,s[a])()}}function tj(s,a){var o=[],c={status:"pending",value:null,reason:null,then:function(m){o.push(m)}};return s.then(function(){c.status="fulfilled",c.value=a;for(var m=0;m<o.length;m++)(0,o[m])(a)},function(m){for(c.status="rejected",c.reason=m,m=0;m<o.length;m++)(0,o[m])(void 0)}),c}var jb=$.S;$.S=function(s,a){o0=Ut(),typeof a=="object"&&a!==null&&typeof a.then=="function"&&ej(s,a),jb!==null&&jb(s,a)};var Eo=P(null);function zm(){var s=Eo.current;return s!==null?s:Xs.pooledCache}function rd(s,a){a===null?Re(Eo,Eo.current):Re(Eo,a.pool)}function Tb(){var s=zm();return s===null?null:{parent:Sn._currentValue,pool:s}}var pl=Error(i(460)),Fm=Error(i(474)),ad=Error(i(542)),id={then:function(){}};function Eb(s){return s=s.status,s==="fulfilled"||s==="rejected"}function Nb(s,a,o){switch(o=s[o],o===void 0?s.push(a):o!==a&&(a.then(sn,sn),a=o),a.status){case"fulfilled":return a.value;case"rejected":throw s=a.reason,Cb(s),s;default:if(typeof a.status=="string")a.then(sn,sn);else{if(s=Xs,s!==null&&100<s.shellSuspendCounter)throw Error(i(482));s=a,s.status="pending",s.then(function(c){if(a.status==="pending"){var m=a;m.status="fulfilled",m.value=c}},function(c){if(a.status==="pending"){var m=a;m.status="rejected",m.reason=c}})}switch(a.status){case"fulfilled":return a.value;case"rejected":throw s=a.reason,Cb(s),s}throw So=a,pl}}function No(s){try{var a=s._init;return a(s._payload)}catch(o){throw o!==null&&typeof o=="object"&&typeof o.then=="function"?(So=o,pl):o}}var So=null;function Sb(){if(So===null)throw Error(i(459));var s=So;return So=null,s}function Cb(s){if(s===pl||s===ad)throw Error(i(483))}var gl=null,gc=0;function od(s){var a=gc;return gc+=1,gl===null&&(gl=[]),Nb(gl,s,a)}function yc(s,a){a=a.props.ref,s.ref=a!==void 0?a:null}function ld(s,a){throw a.$$typeof===j?Error(i(525)):(s=Object.prototype.toString.call(a),Error(i(31,s==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":s)))}function Rb(s){function a(Q,W){if(s){var ae=Q.deletions;ae===null?(Q.deletions=[W],Q.flags|=16):ae.push(W)}}function o(Q,W){if(!s)return null;for(;W!==null;)a(Q,W),W=W.sibling;return null}function c(Q){for(var W=new Map;Q!==null;)Q.key!==null?W.set(Q.key,Q):W.set(Q.index,Q),Q=Q.sibling;return W}function m(Q,W){return Q=Wa(Q,W),Q.index=0,Q.sibling=null,Q}function f(Q,W,ae){return Q.index=ae,s?(ae=Q.alternate,ae!==null?(ae=ae.index,ae<W?(Q.flags|=67108866,W):ae):(Q.flags|=67108866,W)):(Q.flags|=1048576,W)}function x(Q){return s&&Q.alternate===null&&(Q.flags|=67108866),Q}function N(Q,W,ae,Ne){return W===null||W.tag!==6?(W=Rm(ae,Q.mode,Ne),W.return=Q,W):(W=m(W,ae),W.return=Q,W)}function U(Q,W,ae,Ne){var Nt=ae.type;return Nt===B?ke(Q,W,ae.props.children,Ne,ae.key):W!==null&&(W.elementType===Nt||typeof Nt=="object"&&Nt!==null&&Nt.$$typeof===T&&No(Nt)===W.type)?(W=m(W,ae.props),yc(W,ae),W.return=Q,W):(W=ed(ae.type,ae.key,ae.props,null,Q.mode,Ne),yc(W,ae),W.return=Q,W)}function ie(Q,W,ae,Ne){return W===null||W.tag!==4||W.stateNode.containerInfo!==ae.containerInfo||W.stateNode.implementation!==ae.implementation?(W=Am(ae,Q.mode,Ne),W.return=Q,W):(W=m(W,ae.children||[]),W.return=Q,W)}function ke(Q,W,ae,Ne,Nt){return W===null||W.tag!==7?(W=_o(ae,Q.mode,Ne,Nt),W.return=Q,W):(W=m(W,ae),W.return=Q,W)}function Ce(Q,W,ae){if(typeof W=="string"&&W!==""||typeof W=="number"||typeof W=="bigint")return W=Rm(""+W,Q.mode,ae),W.return=Q,W;if(typeof W=="object"&&W!==null){switch(W.$$typeof){case O:return ae=ed(W.type,W.key,W.props,null,Q.mode,ae),yc(ae,W),ae.return=Q,ae;case H:return W=Am(W,Q.mode,ae),W.return=Q,W;case T:return W=No(W),Ce(Q,W,ae)}if(mt(W)||z(W))return W=_o(W,Q.mode,ae,null),W.return=Q,W;if(typeof W.then=="function")return Ce(Q,od(W),ae);if(W.$$typeof===oe)return Ce(Q,nd(Q,W),ae);ld(Q,W)}return null}function le(Q,W,ae,Ne){var Nt=W!==null?W.key:null;if(typeof ae=="string"&&ae!==""||typeof ae=="number"||typeof ae=="bigint")return Nt!==null?null:N(Q,W,""+ae,Ne);if(typeof ae=="object"&&ae!==null){switch(ae.$$typeof){case O:return ae.key===Nt?U(Q,W,ae,Ne):null;case H:return ae.key===Nt?ie(Q,W,ae,Ne):null;case T:return ae=No(ae),le(Q,W,ae,Ne)}if(mt(ae)||z(ae))return Nt!==null?null:ke(Q,W,ae,Ne,null);if(typeof ae.then=="function")return le(Q,W,od(ae),Ne);if(ae.$$typeof===oe)return le(Q,W,nd(Q,ae),Ne);ld(Q,ae)}return null}function me(Q,W,ae,Ne,Nt){if(typeof Ne=="string"&&Ne!==""||typeof Ne=="number"||typeof Ne=="bigint")return Q=Q.get(ae)||null,N(W,Q,""+Ne,Nt);if(typeof Ne=="object"&&Ne!==null){switch(Ne.$$typeof){case O:return Q=Q.get(Ne.key===null?ae:Ne.key)||null,U(W,Q,Ne,Nt);case H:return Q=Q.get(Ne.key===null?ae:Ne.key)||null,ie(W,Q,Ne,Nt);case T:return Ne=No(Ne),me(Q,W,ae,Ne,Nt)}if(mt(Ne)||z(Ne))return Q=Q.get(ae)||null,ke(W,Q,Ne,Nt,null);if(typeof Ne.then=="function")return me(Q,W,ae,od(Ne),Nt);if(Ne.$$typeof===oe)return me(Q,W,ae,nd(W,Ne),Nt);ld(W,Ne)}return null}function dt(Q,W,ae,Ne){for(var Nt=null,Ms=null,ht=W,ns=W=0,ps=null;ht!==null&&ns<ae.length;ns++){ht.index>ns?(ps=ht,ht=null):ps=ht.sibling;var Ds=le(Q,ht,ae[ns],Ne);if(Ds===null){ht===null&&(ht=ps);break}s&&ht&&Ds.alternate===null&&a(Q,ht),W=f(Ds,W,ns),Ms===null?Nt=Ds:Ms.sibling=Ds,Ms=Ds,ht=ps}if(ns===ae.length)return o(Q,ht),ws&&Ga(Q,ns),Nt;if(ht===null){for(;ns<ae.length;ns++)ht=Ce(Q,ae[ns],Ne),ht!==null&&(W=f(ht,W,ns),Ms===null?Nt=ht:Ms.sibling=ht,Ms=ht);return ws&&Ga(Q,ns),Nt}for(ht=c(ht);ns<ae.length;ns++)ps=me(ht,Q,ns,ae[ns],Ne),ps!==null&&(s&&ps.alternate!==null&&ht.delete(ps.key===null?ns:ps.key),W=f(ps,W,ns),Ms===null?Nt=ps:Ms.sibling=ps,Ms=ps);return s&&ht.forEach(function(Hi){return a(Q,Hi)}),ws&&Ga(Q,ns),Nt}function Pt(Q,W,ae,Ne){if(ae==null)throw Error(i(151));for(var Nt=null,Ms=null,ht=W,ns=W=0,ps=null,Ds=ae.next();ht!==null&&!Ds.done;ns++,Ds=ae.next()){ht.index>ns?(ps=ht,ht=null):ps=ht.sibling;var Hi=le(Q,ht,Ds.value,Ne);if(Hi===null){ht===null&&(ht=ps);break}s&&ht&&Hi.alternate===null&&a(Q,ht),W=f(Hi,W,ns),Ms===null?Nt=Hi:Ms.sibling=Hi,Ms=Hi,ht=ps}if(Ds.done)return o(Q,ht),ws&&Ga(Q,ns),Nt;if(ht===null){for(;!Ds.done;ns++,Ds=ae.next())Ds=Ce(Q,Ds.value,Ne),Ds!==null&&(W=f(Ds,W,ns),Ms===null?Nt=Ds:Ms.sibling=Ds,Ms=Ds);return ws&&Ga(Q,ns),Nt}for(ht=c(ht);!Ds.done;ns++,Ds=ae.next())Ds=me(ht,Q,ns,Ds.value,Ne),Ds!==null&&(s&&Ds.alternate!==null&&ht.delete(Ds.key===null?ns:Ds.key),W=f(Ds,W,ns),Ms===null?Nt=Ds:Ms.sibling=Ds,Ms=Ds);return s&&ht.forEach(function(hT){return a(Q,hT)}),ws&&Ga(Q,ns),Nt}function Gs(Q,W,ae,Ne){if(typeof ae=="object"&&ae!==null&&ae.type===B&&ae.key===null&&(ae=ae.props.children),typeof ae=="object"&&ae!==null){switch(ae.$$typeof){case O:e:{for(var Nt=ae.key;W!==null;){if(W.key===Nt){if(Nt=ae.type,Nt===B){if(W.tag===7){o(Q,W.sibling),Ne=m(W,ae.props.children),Ne.return=Q,Q=Ne;break e}}else if(W.elementType===Nt||typeof Nt=="object"&&Nt!==null&&Nt.$$typeof===T&&No(Nt)===W.type){o(Q,W.sibling),Ne=m(W,ae.props),yc(Ne,ae),Ne.return=Q,Q=Ne;break e}o(Q,W);break}else a(Q,W);W=W.sibling}ae.type===B?(Ne=_o(ae.props.children,Q.mode,Ne,ae.key),Ne.return=Q,Q=Ne):(Ne=ed(ae.type,ae.key,ae.props,null,Q.mode,Ne),yc(Ne,ae),Ne.return=Q,Q=Ne)}return x(Q);case H:e:{for(Nt=ae.key;W!==null;){if(W.key===Nt)if(W.tag===4&&W.stateNode.containerInfo===ae.containerInfo&&W.stateNode.implementation===ae.implementation){o(Q,W.sibling),Ne=m(W,ae.children||[]),Ne.return=Q,Q=Ne;break e}else{o(Q,W);break}else a(Q,W);W=W.sibling}Ne=Am(ae,Q.mode,Ne),Ne.return=Q,Q=Ne}return x(Q);case T:return ae=No(ae),Gs(Q,W,ae,Ne)}if(mt(ae))return dt(Q,W,ae,Ne);if(z(ae)){if(Nt=z(ae),typeof Nt!="function")throw Error(i(150));return ae=Nt.call(ae),Pt(Q,W,ae,Ne)}if(typeof ae.then=="function")return Gs(Q,W,od(ae),Ne);if(ae.$$typeof===oe)return Gs(Q,W,nd(Q,ae),Ne);ld(Q,ae)}return typeof ae=="string"&&ae!==""||typeof ae=="number"||typeof ae=="bigint"?(ae=""+ae,W!==null&&W.tag===6?(o(Q,W.sibling),Ne=m(W,ae),Ne.return=Q,Q=Ne):(o(Q,W),Ne=Rm(ae,Q.mode,Ne),Ne.return=Q,Q=Ne),x(Q)):o(Q,W)}return function(Q,W,ae,Ne){try{gc=0;var Nt=Gs(Q,W,ae,Ne);return gl=null,Nt}catch(ht){if(ht===pl||ht===ad)throw ht;var Ms=Or(29,ht,null,Q.mode);return Ms.lanes=Ne,Ms.return=Q,Ms}}}var Co=Rb(!0),Ab=Rb(!1),Ni=!1;function qm(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Hm(s,a){s=s.updateQueue,a.updateQueue===s&&(a.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function Si(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function Ci(s,a,o){var c=s.updateQueue;if(c===null)return null;if(c=c.shared,(Vs&2)!==0){var m=c.pending;return m===null?a.next=a:(a.next=m.next,m.next=a),c.pending=a,a=Zu(s),fb(s,null,o),a}return Ju(s,c,a,o),Zu(s)}function bc(s,a,o){if(a=a.updateQueue,a!==null&&(a=a.shared,(o&4194048)!==0)){var c=a.lanes;c&=s.pendingLanes,o|=c,a.lanes=o,Es(s,o)}}function $m(s,a){var o=s.updateQueue,c=s.alternate;if(c!==null&&(c=c.updateQueue,o===c)){var m=null,f=null;if(o=o.firstBaseUpdate,o!==null){do{var x={lane:o.lane,tag:o.tag,payload:o.payload,callback:null,next:null};f===null?m=f=x:f=f.next=x,o=o.next}while(o!==null);f===null?m=f=a:f=f.next=a}else m=f=a;o={baseState:c.baseState,firstBaseUpdate:m,lastBaseUpdate:f,shared:c.shared,callbacks:c.callbacks},s.updateQueue=o;return}s=o.lastBaseUpdate,s===null?o.firstBaseUpdate=a:s.next=a,o.lastBaseUpdate=a}var Wm=!1;function vc(){if(Wm){var s=fl;if(s!==null)throw s}}function xc(s,a,o,c){Wm=!1;var m=s.updateQueue;Ni=!1;var f=m.firstBaseUpdate,x=m.lastBaseUpdate,N=m.shared.pending;if(N!==null){m.shared.pending=null;var U=N,ie=U.next;U.next=null,x===null?f=ie:x.next=ie,x=U;var ke=s.alternate;ke!==null&&(ke=ke.updateQueue,N=ke.lastBaseUpdate,N!==x&&(N===null?ke.firstBaseUpdate=ie:N.next=ie,ke.lastBaseUpdate=U))}if(f!==null){var Ce=m.baseState;x=0,ke=ie=U=null,N=f;do{var le=N.lane&-536870913,me=le!==N.lane;if(me?(fs&le)===le:(c&le)===le){le!==0&&le===ml&&(Wm=!0),ke!==null&&(ke=ke.next={lane:0,tag:N.tag,payload:N.payload,callback:null,next:null});e:{var dt=s,Pt=N;le=a;var Gs=o;switch(Pt.tag){case 1:if(dt=Pt.payload,typeof dt=="function"){Ce=dt.call(Gs,Ce,le);break e}Ce=dt;break e;case 3:dt.flags=dt.flags&-65537|128;case 0:if(dt=Pt.payload,le=typeof dt=="function"?dt.call(Gs,Ce,le):dt,le==null)break e;Ce=k({},Ce,le);break e;case 2:Ni=!0}}le=N.callback,le!==null&&(s.flags|=64,me&&(s.flags|=8192),me=m.callbacks,me===null?m.callbacks=[le]:me.push(le))}else me={lane:le,tag:N.tag,payload:N.payload,callback:N.callback,next:null},ke===null?(ie=ke=me,U=Ce):ke=ke.next=me,x|=le;if(N=N.next,N===null){if(N=m.shared.pending,N===null)break;me=N,N=me.next,me.next=null,m.lastBaseUpdate=me,m.shared.pending=null}}while(!0);ke===null&&(U=Ce),m.baseState=U,m.firstBaseUpdate=ie,m.lastBaseUpdate=ke,f===null&&(m.shared.lanes=0),Di|=x,s.lanes=x,s.memoizedState=Ce}}function Ib(s,a){if(typeof s!="function")throw Error(i(191,s));s.call(a)}function Mb(s,a){var o=s.callbacks;if(o!==null)for(s.callbacks=null,s=0;s<o.length;s++)Ib(o[s],a)}var yl=P(null),cd=P(0);function Db(s,a){s=ri,Re(cd,s),Re(yl,a),ri=s|a.baseLanes}function Gm(){Re(cd,ri),Re(yl,yl.current)}function Km(){ri=cd.current,re(yl),re(cd)}var Vr=P(null),ea=null;function Ri(s){var a=s.alternate;Re(jn,jn.current&1),Re(Vr,s),ea===null&&(a===null||yl.current!==null||a.memoizedState!==null)&&(ea=s)}function Ym(s){Re(jn,jn.current),Re(Vr,s),ea===null&&(ea=s)}function Pb(s){s.tag===22?(Re(jn,jn.current),Re(Vr,s),ea===null&&(ea=s)):Ai()}function Ai(){Re(jn,jn.current),Re(Vr,Vr.current)}function Br(s){re(Vr),ea===s&&(ea=null),re(jn)}var jn=P(0);function ud(s){for(var a=s;a!==null;){if(a.tag===13){var o=a.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||sp(o)||np(o)))return a}else if(a.tag===19&&(a.memoizedProps.revealOrder==="forwards"||a.memoizedProps.revealOrder==="backwards"||a.memoizedProps.revealOrder==="unstable_legacy-backwards"||a.memoizedProps.revealOrder==="together")){if((a.flags&128)!==0)return a}else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===s)break;for(;a.sibling===null;){if(a.return===null||a.return===s)return null;a=a.return}a.sibling.return=a.return,a=a.sibling}return null}var Qa=0,ts=null,$s=null,Cn=null,dd=!1,bl=!1,Ro=!1,hd=0,wc=0,vl=null,sj=0;function yn(){throw Error(i(321))}function Qm(s,a){if(a===null)return!1;for(var o=0;o<a.length&&o<s.length;o++)if(!Lr(s[o],a[o]))return!1;return!0}function Xm(s,a,o,c,m,f){return Qa=f,ts=a,a.memoizedState=null,a.updateQueue=null,a.lanes=0,$.H=s===null||s.memoizedState===null?bv:mf,Ro=!1,f=o(c,m),Ro=!1,bl&&(f=Ob(a,o,c,m)),Lb(s),f}function Lb(s){$.H=jc;var a=$s!==null&&$s.next!==null;if(Qa=0,Cn=$s=ts=null,dd=!1,wc=0,vl=null,a)throw Error(i(300));s===null||Rn||(s=s.dependencies,s!==null&&sd(s)&&(Rn=!0))}function Ob(s,a,o,c){ts=s;var m=0;do{if(bl&&(vl=null),wc=0,bl=!1,25<=m)throw Error(i(301));if(m+=1,Cn=$s=null,s.updateQueue!=null){var f=s.updateQueue;f.lastEffect=null,f.events=null,f.stores=null,f.memoCache!=null&&(f.memoCache.index=0)}$.H=vv,f=a(o,c)}while(bl);return f}function nj(){var s=$.H,a=s.useState()[0];return a=typeof a.then=="function"?_c(a):a,s=s.useState()[0],($s!==null?$s.memoizedState:null)!==s&&(ts.flags|=1024),a}function Jm(){var s=hd!==0;return hd=0,s}function Zm(s,a,o){a.updateQueue=s.updateQueue,a.flags&=-2053,s.lanes&=~o}function ef(s){if(dd){for(s=s.memoizedState;s!==null;){var a=s.queue;a!==null&&(a.pending=null),s=s.next}dd=!1}Qa=0,Cn=$s=ts=null,bl=!1,wc=hd=0,vl=null}function pr(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Cn===null?ts.memoizedState=Cn=s:Cn=Cn.next=s,Cn}function Tn(){if($s===null){var s=ts.alternate;s=s!==null?s.memoizedState:null}else s=$s.next;var a=Cn===null?ts.memoizedState:Cn.next;if(a!==null)Cn=a,$s=s;else{if(s===null)throw ts.alternate===null?Error(i(467)):Error(i(310));$s=s,s={memoizedState:$s.memoizedState,baseState:$s.baseState,baseQueue:$s.baseQueue,queue:$s.queue,next:null},Cn===null?ts.memoizedState=Cn=s:Cn=Cn.next=s}return Cn}function md(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function _c(s){var a=wc;return wc+=1,vl===null&&(vl=[]),s=Nb(vl,s,a),a=ts,(Cn===null?a.memoizedState:Cn.next)===null&&(a=a.alternate,$.H=a===null||a.memoizedState===null?bv:mf),s}function fd(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return _c(s);if(s.$$typeof===oe)return Qn(s)}throw Error(i(438,String(s)))}function tf(s){var a=null,o=ts.updateQueue;if(o!==null&&(a=o.memoCache),a==null){var c=ts.alternate;c!==null&&(c=c.updateQueue,c!==null&&(c=c.memoCache,c!=null&&(a={data:c.data.map(function(m){return m.slice()}),index:0})))}if(a==null&&(a={data:[],index:0}),o===null&&(o=md(),ts.updateQueue=o),o.memoCache=a,o=a.data[a.index],o===void 0)for(o=a.data[a.index]=Array(s),c=0;c<s;c++)o[c]=L;return a.index++,o}function Xa(s,a){return typeof a=="function"?a(s):a}function pd(s){var a=Tn();return sf(a,$s,s)}function sf(s,a,o){var c=s.queue;if(c===null)throw Error(i(311));c.lastRenderedReducer=o;var m=s.baseQueue,f=c.pending;if(f!==null){if(m!==null){var x=m.next;m.next=f.next,f.next=x}a.baseQueue=m=f,c.pending=null}if(f=s.baseState,m===null)s.memoizedState=f;else{a=m.next;var N=x=null,U=null,ie=a,ke=!1;do{var Ce=ie.lane&-536870913;if(Ce!==ie.lane?(fs&Ce)===Ce:(Qa&Ce)===Ce){var le=ie.revertLane;if(le===0)U!==null&&(U=U.next={lane:0,revertLane:0,gesture:null,action:ie.action,hasEagerState:ie.hasEagerState,eagerState:ie.eagerState,next:null}),Ce===ml&&(ke=!0);else if((Qa&le)===le){ie=ie.next,le===ml&&(ke=!0);continue}else Ce={lane:0,revertLane:ie.revertLane,gesture:null,action:ie.action,hasEagerState:ie.hasEagerState,eagerState:ie.eagerState,next:null},U===null?(N=U=Ce,x=f):U=U.next=Ce,ts.lanes|=le,Di|=le;Ce=ie.action,Ro&&o(f,Ce),f=ie.hasEagerState?ie.eagerState:o(f,Ce)}else le={lane:Ce,revertLane:ie.revertLane,gesture:ie.gesture,action:ie.action,hasEagerState:ie.hasEagerState,eagerState:ie.eagerState,next:null},U===null?(N=U=le,x=f):U=U.next=le,ts.lanes|=Ce,Di|=Ce;ie=ie.next}while(ie!==null&&ie!==a);if(U===null?x=f:U.next=N,!Lr(f,s.memoizedState)&&(Rn=!0,ke&&(o=fl,o!==null)))throw o;s.memoizedState=f,s.baseState=x,s.baseQueue=U,c.lastRenderedState=f}return m===null&&(c.lanes=0),[s.memoizedState,c.dispatch]}function nf(s){var a=Tn(),o=a.queue;if(o===null)throw Error(i(311));o.lastRenderedReducer=s;var c=o.dispatch,m=o.pending,f=a.memoizedState;if(m!==null){o.pending=null;var x=m=m.next;do f=s(f,x.action),x=x.next;while(x!==m);Lr(f,a.memoizedState)||(Rn=!0),a.memoizedState=f,a.baseQueue===null&&(a.baseState=f),o.lastRenderedState=f}return[f,c]}function Vb(s,a,o){var c=ts,m=Tn(),f=ws;if(f){if(o===void 0)throw Error(i(407));o=o()}else o=a();var x=!Lr(($s||m).memoizedState,o);if(x&&(m.memoizedState=o,Rn=!0),m=m.queue,of(zb.bind(null,c,m,s),[s]),m.getSnapshot!==a||x||Cn!==null&&Cn.memoizedState.tag&1){if(c.flags|=2048,xl(9,{destroy:void 0},Ub.bind(null,c,m,o,a),null),Xs===null)throw Error(i(349));f||(Qa&127)!==0||Bb(c,a,o)}return o}function Bb(s,a,o){s.flags|=16384,s={getSnapshot:a,value:o},a=ts.updateQueue,a===null?(a=md(),ts.updateQueue=a,a.stores=[s]):(o=a.stores,o===null?a.stores=[s]:o.push(s))}function Ub(s,a,o,c){a.value=o,a.getSnapshot=c,Fb(a)&&qb(s)}function zb(s,a,o){return o(function(){Fb(a)&&qb(s)})}function Fb(s){var a=s.getSnapshot;s=s.value;try{var o=a();return!Lr(s,o)}catch{return!0}}function qb(s){var a=wo(s,2);a!==null&&Rr(a,s,2)}function rf(s){var a=pr();if(typeof s=="function"){var o=s;if(s=o(),Ro){De(!0);try{o()}finally{De(!1)}}}return a.memoizedState=a.baseState=s,a.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Xa,lastRenderedState:s},a}function Hb(s,a,o,c){return s.baseState=o,sf(s,$s,typeof c=="function"?c:Xa)}function rj(s,a,o,c,m){if(bd(s))throw Error(i(485));if(s=a.action,s!==null){var f={payload:m,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(x){f.listeners.push(x)}};$.T!==null?o(!0):f.isTransition=!1,c(f),o=a.pending,o===null?(f.next=a.pending=f,$b(a,f)):(f.next=o.next,a.pending=o.next=f)}}function $b(s,a){var o=a.action,c=a.payload,m=s.state;if(a.isTransition){var f=$.T,x={};$.T=x;try{var N=o(m,c),U=$.S;U!==null&&U(x,N),Wb(s,a,N)}catch(ie){af(s,a,ie)}finally{f!==null&&x.types!==null&&(f.types=x.types),$.T=f}}else try{f=o(m,c),Wb(s,a,f)}catch(ie){af(s,a,ie)}}function Wb(s,a,o){o!==null&&typeof o=="object"&&typeof o.then=="function"?o.then(function(c){Gb(s,a,c)},function(c){return af(s,a,c)}):Gb(s,a,o)}function Gb(s,a,o){a.status="fulfilled",a.value=o,Kb(a),s.state=o,a=s.pending,a!==null&&(o=a.next,o===a?s.pending=null:(o=o.next,a.next=o,$b(s,o)))}function af(s,a,o){var c=s.pending;if(s.pending=null,c!==null){c=c.next;do a.status="rejected",a.reason=o,Kb(a),a=a.next;while(a!==c)}s.action=null}function Kb(s){s=s.listeners;for(var a=0;a<s.length;a++)(0,s[a])()}function Yb(s,a){return a}function Qb(s,a){if(ws){var o=Xs.formState;if(o!==null){e:{var c=ts;if(ws){if(nn){t:{for(var m=nn,f=Zr;m.nodeType!==8;){if(!f){m=null;break t}if(m=ta(m.nextSibling),m===null){m=null;break t}}f=m.data,m=f==="F!"||f==="F"?m:null}if(m){nn=ta(m.nextSibling),c=m.data==="F!";break e}}Ti(c)}c=!1}c&&(a=o[0])}}return o=pr(),o.memoizedState=o.baseState=a,c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Yb,lastRenderedState:a},o.queue=c,o=pv.bind(null,ts,c),c.dispatch=o,c=rf(!1),f=hf.bind(null,ts,!1,c.queue),c=pr(),m={state:a,dispatch:null,action:s,pending:null},c.queue=m,o=rj.bind(null,ts,m,f,o),m.dispatch=o,c.memoizedState=s,[a,o,!1]}function Xb(s){var a=Tn();return Jb(a,$s,s)}function Jb(s,a,o){if(a=sf(s,a,Yb)[0],s=pd(Xa)[0],typeof a=="object"&&a!==null&&typeof a.then=="function")try{var c=_c(a)}catch(x){throw x===pl?ad:x}else c=a;a=Tn();var m=a.queue,f=m.dispatch;return o!==a.memoizedState&&(ts.flags|=2048,xl(9,{destroy:void 0},aj.bind(null,m,o),null)),[c,f,s]}function aj(s,a){s.action=a}function Zb(s){var a=Tn(),o=$s;if(o!==null)return Jb(a,o,s);Tn(),a=a.memoizedState,o=Tn();var c=o.queue.dispatch;return o.memoizedState=s,[a,c,!1]}function xl(s,a,o,c){return s={tag:s,create:o,deps:c,inst:a,next:null},a=ts.updateQueue,a===null&&(a=md(),ts.updateQueue=a),o=a.lastEffect,o===null?a.lastEffect=s.next=s:(c=o.next,o.next=s,s.next=c,a.lastEffect=s),s}function ev(){return Tn().memoizedState}function gd(s,a,o,c){var m=pr();ts.flags|=s,m.memoizedState=xl(1|a,{destroy:void 0},o,c===void 0?null:c)}function yd(s,a,o,c){var m=Tn();c=c===void 0?null:c;var f=m.memoizedState.inst;$s!==null&&c!==null&&Qm(c,$s.memoizedState.deps)?m.memoizedState=xl(a,f,o,c):(ts.flags|=s,m.memoizedState=xl(1|a,f,o,c))}function tv(s,a){gd(8390656,8,s,a)}function of(s,a){yd(2048,8,s,a)}function ij(s){ts.flags|=4;var a=ts.updateQueue;if(a===null)a=md(),ts.updateQueue=a,a.events=[s];else{var o=a.events;o===null?a.events=[s]:o.push(s)}}function sv(s){var a=Tn().memoizedState;return ij({ref:a,nextImpl:s}),function(){if((Vs&2)!==0)throw Error(i(440));return a.impl.apply(void 0,arguments)}}function nv(s,a){return yd(4,2,s,a)}function rv(s,a){return yd(4,4,s,a)}function av(s,a){if(typeof a=="function"){s=s();var o=a(s);return function(){typeof o=="function"?o():a(null)}}if(a!=null)return s=s(),a.current=s,function(){a.current=null}}function iv(s,a,o){o=o!=null?o.concat([s]):null,yd(4,4,av.bind(null,a,s),o)}function lf(){}function ov(s,a){var o=Tn();a=a===void 0?null:a;var c=o.memoizedState;return a!==null&&Qm(a,c[1])?c[0]:(o.memoizedState=[s,a],s)}function lv(s,a){var o=Tn();a=a===void 0?null:a;var c=o.memoizedState;if(a!==null&&Qm(a,c[1]))return c[0];if(c=s(),Ro){De(!0);try{s()}finally{De(!1)}}return o.memoizedState=[c,a],c}function cf(s,a,o){return o===void 0||(Qa&1073741824)!==0&&(fs&261930)===0?s.memoizedState=a:(s.memoizedState=o,s=c0(),ts.lanes|=s,Di|=s,o)}function cv(s,a,o,c){return Lr(o,a)?o:yl.current!==null?(s=cf(s,o,c),Lr(s,a)||(Rn=!0),s):(Qa&42)===0||(Qa&1073741824)!==0&&(fs&261930)===0?(Rn=!0,s.memoizedState=o):(s=c0(),ts.lanes|=s,Di|=s,a)}function uv(s,a,o,c,m){var f=pe.p;pe.p=f!==0&&8>f?f:8;var x=$.T,N={};$.T=N,hf(s,!1,a,o);try{var U=m(),ie=$.S;if(ie!==null&&ie(N,U),U!==null&&typeof U=="object"&&typeof U.then=="function"){var ke=tj(U,c);kc(s,a,ke,Fr(s))}else kc(s,a,c,Fr(s))}catch(Ce){kc(s,a,{then:function(){},status:"rejected",reason:Ce},Fr())}finally{pe.p=f,x!==null&&N.types!==null&&(x.types=N.types),$.T=x}}function oj(){}function uf(s,a,o,c){if(s.tag!==5)throw Error(i(476));var m=dv(s).queue;uv(s,m,a,Me,o===null?oj:function(){return hv(s),o(c)})}function dv(s){var a=s.memoizedState;if(a!==null)return a;a={memoizedState:Me,baseState:Me,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Xa,lastRenderedState:Me},next:null};var o={};return a.next={memoizedState:o,baseState:o,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Xa,lastRenderedState:o},next:null},s.memoizedState=a,s=s.alternate,s!==null&&(s.memoizedState=a),a}function hv(s){var a=dv(s);a.next===null&&(a=s.alternate.memoizedState),kc(s,a.next.queue,{},Fr())}function df(){return Qn(Uc)}function mv(){return Tn().memoizedState}function fv(){return Tn().memoizedState}function lj(s){for(var a=s.return;a!==null;){switch(a.tag){case 24:case 3:var o=Fr();s=Si(o);var c=Ci(a,s,o);c!==null&&(Rr(c,a,o),bc(c,a,o)),a={cache:Bm()},s.payload=a;return}a=a.return}}function cj(s,a,o){var c=Fr();o={lane:c,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null},bd(s)?gv(a,o):(o=Sm(s,a,o,c),o!==null&&(Rr(o,s,c),yv(o,a,c)))}function pv(s,a,o){var c=Fr();kc(s,a,o,c)}function kc(s,a,o,c){var m={lane:c,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null};if(bd(s))gv(a,m);else{var f=s.alternate;if(s.lanes===0&&(f===null||f.lanes===0)&&(f=a.lastRenderedReducer,f!==null))try{var x=a.lastRenderedState,N=f(x,o);if(m.hasEagerState=!0,m.eagerState=N,Lr(N,x))return Ju(s,a,m,0),Xs===null&&Xu(),!1}catch{}if(o=Sm(s,a,m,c),o!==null)return Rr(o,s,c),yv(o,a,c),!0}return!1}function hf(s,a,o,c){if(c={lane:2,revertLane:Hf(),gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},bd(s)){if(a)throw Error(i(479))}else a=Sm(s,o,c,2),a!==null&&Rr(a,s,2)}function bd(s){var a=s.alternate;return s===ts||a!==null&&a===ts}function gv(s,a){bl=dd=!0;var o=s.pending;o===null?a.next=a:(a.next=o.next,o.next=a),s.pending=a}function yv(s,a,o){if((o&4194048)!==0){var c=a.lanes;c&=s.pendingLanes,o|=c,a.lanes=o,Es(s,o)}}var jc={readContext:Qn,use:fd,useCallback:yn,useContext:yn,useEffect:yn,useImperativeHandle:yn,useLayoutEffect:yn,useInsertionEffect:yn,useMemo:yn,useReducer:yn,useRef:yn,useState:yn,useDebugValue:yn,useDeferredValue:yn,useTransition:yn,useSyncExternalStore:yn,useId:yn,useHostTransitionStatus:yn,useFormState:yn,useActionState:yn,useOptimistic:yn,useMemoCache:yn,useCacheRefresh:yn};jc.useEffectEvent=yn;var bv={readContext:Qn,use:fd,useCallback:function(s,a){return pr().memoizedState=[s,a===void 0?null:a],s},useContext:Qn,useEffect:tv,useImperativeHandle:function(s,a,o){o=o!=null?o.concat([s]):null,gd(4194308,4,av.bind(null,a,s),o)},useLayoutEffect:function(s,a){return gd(4194308,4,s,a)},useInsertionEffect:function(s,a){gd(4,2,s,a)},useMemo:function(s,a){var o=pr();a=a===void 0?null:a;var c=s();if(Ro){De(!0);try{s()}finally{De(!1)}}return o.memoizedState=[c,a],c},useReducer:function(s,a,o){var c=pr();if(o!==void 0){var m=o(a);if(Ro){De(!0);try{o(a)}finally{De(!1)}}}else m=a;return c.memoizedState=c.baseState=m,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:m},c.queue=s,s=s.dispatch=cj.bind(null,ts,s),[c.memoizedState,s]},useRef:function(s){var a=pr();return s={current:s},a.memoizedState=s},useState:function(s){s=rf(s);var a=s.queue,o=pv.bind(null,ts,a);return a.dispatch=o,[s.memoizedState,o]},useDebugValue:lf,useDeferredValue:function(s,a){var o=pr();return cf(o,s,a)},useTransition:function(){var s=rf(!1);return s=uv.bind(null,ts,s.queue,!0,!1),pr().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,a,o){var c=ts,m=pr();if(ws){if(o===void 0)throw Error(i(407));o=o()}else{if(o=a(),Xs===null)throw Error(i(349));(fs&127)!==0||Bb(c,a,o)}m.memoizedState=o;var f={value:o,getSnapshot:a};return m.queue=f,tv(zb.bind(null,c,f,s),[s]),c.flags|=2048,xl(9,{destroy:void 0},Ub.bind(null,c,f,o,a),null),o},useId:function(){var s=pr(),a=Xs.identifierPrefix;if(ws){var o=Sa,c=Na;o=(c&~(1<<32-He(c)-1)).toString(32)+o,a="_"+a+"R_"+o,o=hd++,0<o&&(a+="H"+o.toString(32)),a+="_"}else o=sj++,a="_"+a+"r_"+o.toString(32)+"_";return s.memoizedState=a},useHostTransitionStatus:df,useFormState:Qb,useActionState:Qb,useOptimistic:function(s){var a=pr();a.memoizedState=a.baseState=s;var o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return a.queue=o,a=hf.bind(null,ts,!0,o),o.dispatch=a,[s,a]},useMemoCache:tf,useCacheRefresh:function(){return pr().memoizedState=lj.bind(null,ts)},useEffectEvent:function(s){var a=pr(),o={impl:s};return a.memoizedState=o,function(){if((Vs&2)!==0)throw Error(i(440));return o.impl.apply(void 0,arguments)}}},mf={readContext:Qn,use:fd,useCallback:ov,useContext:Qn,useEffect:of,useImperativeHandle:iv,useInsertionEffect:nv,useLayoutEffect:rv,useMemo:lv,useReducer:pd,useRef:ev,useState:function(){return pd(Xa)},useDebugValue:lf,useDeferredValue:function(s,a){var o=Tn();return cv(o,$s.memoizedState,s,a)},useTransition:function(){var s=pd(Xa)[0],a=Tn().memoizedState;return[typeof s=="boolean"?s:_c(s),a]},useSyncExternalStore:Vb,useId:mv,useHostTransitionStatus:df,useFormState:Xb,useActionState:Xb,useOptimistic:function(s,a){var o=Tn();return Hb(o,$s,s,a)},useMemoCache:tf,useCacheRefresh:fv};mf.useEffectEvent=sv;var vv={readContext:Qn,use:fd,useCallback:ov,useContext:Qn,useEffect:of,useImperativeHandle:iv,useInsertionEffect:nv,useLayoutEffect:rv,useMemo:lv,useReducer:nf,useRef:ev,useState:function(){return nf(Xa)},useDebugValue:lf,useDeferredValue:function(s,a){var o=Tn();return $s===null?cf(o,s,a):cv(o,$s.memoizedState,s,a)},useTransition:function(){var s=nf(Xa)[0],a=Tn().memoizedState;return[typeof s=="boolean"?s:_c(s),a]},useSyncExternalStore:Vb,useId:mv,useHostTransitionStatus:df,useFormState:Zb,useActionState:Zb,useOptimistic:function(s,a){var o=Tn();return $s!==null?Hb(o,$s,s,a):(o.baseState=s,[s,o.queue.dispatch])},useMemoCache:tf,useCacheRefresh:fv};vv.useEffectEvent=sv;function ff(s,a,o,c){a=s.memoizedState,o=o(c,a),o=o==null?a:k({},a,o),s.memoizedState=o,s.lanes===0&&(s.updateQueue.baseState=o)}var pf={enqueueSetState:function(s,a,o){s=s._reactInternals;var c=Fr(),m=Si(c);m.payload=a,o!=null&&(m.callback=o),a=Ci(s,m,c),a!==null&&(Rr(a,s,c),bc(a,s,c))},enqueueReplaceState:function(s,a,o){s=s._reactInternals;var c=Fr(),m=Si(c);m.tag=1,m.payload=a,o!=null&&(m.callback=o),a=Ci(s,m,c),a!==null&&(Rr(a,s,c),bc(a,s,c))},enqueueForceUpdate:function(s,a){s=s._reactInternals;var o=Fr(),c=Si(o);c.tag=2,a!=null&&(c.callback=a),a=Ci(s,c,o),a!==null&&(Rr(a,s,o),bc(a,s,o))}};function xv(s,a,o,c,m,f,x){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(c,f,x):a.prototype&&a.prototype.isPureReactComponent?!uc(o,c)||!uc(m,f):!0}function wv(s,a,o,c){s=a.state,typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps(o,c),typeof a.UNSAFE_componentWillReceiveProps=="function"&&a.UNSAFE_componentWillReceiveProps(o,c),a.state!==s&&pf.enqueueReplaceState(a,a.state,null)}function Ao(s,a){var o=a;if("ref"in a){o={};for(var c in a)c!=="ref"&&(o[c]=a[c])}if(s=s.defaultProps){o===a&&(o=k({},o));for(var m in s)o[m]===void 0&&(o[m]=s[m])}return o}function _v(s){Qu(s)}function kv(s){console.error(s)}function jv(s){Qu(s)}function vd(s,a){try{var o=s.onUncaughtError;o(a.value,{componentStack:a.stack})}catch(c){setTimeout(function(){throw c})}}function Tv(s,a,o){try{var c=s.onCaughtError;c(o.value,{componentStack:o.stack,errorBoundary:a.tag===1?a.stateNode:null})}catch(m){setTimeout(function(){throw m})}}function gf(s,a,o){return o=Si(o),o.tag=3,o.payload={element:null},o.callback=function(){vd(s,a)},o}function Ev(s){return s=Si(s),s.tag=3,s}function Nv(s,a,o,c){var m=o.type.getDerivedStateFromError;if(typeof m=="function"){var f=c.value;s.payload=function(){return m(f)},s.callback=function(){Tv(a,o,c)}}var x=o.stateNode;x!==null&&typeof x.componentDidCatch=="function"&&(s.callback=function(){Tv(a,o,c),typeof m!="function"&&(Pi===null?Pi=new Set([this]):Pi.add(this));var N=c.stack;this.componentDidCatch(c.value,{componentStack:N!==null?N:""})})}function uj(s,a,o,c,m){if(o.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){if(a=o.alternate,a!==null&&hl(a,o,m,!0),o=Vr.current,o!==null){switch(o.tag){case 31:case 13:return ea===null?Ad():o.alternate===null&&bn===0&&(bn=3),o.flags&=-257,o.flags|=65536,o.lanes=m,c===id?o.flags|=16384:(a=o.updateQueue,a===null?o.updateQueue=new Set([c]):a.add(c),zf(s,c,m)),!1;case 22:return o.flags|=65536,c===id?o.flags|=16384:(a=o.updateQueue,a===null?(a={transitions:null,markerInstances:null,retryQueue:new Set([c])},o.updateQueue=a):(o=a.retryQueue,o===null?a.retryQueue=new Set([c]):o.add(c)),zf(s,c,m)),!1}throw Error(i(435,o.tag))}return zf(s,c,m),Ad(),!1}if(ws)return a=Vr.current,a!==null?((a.flags&65536)===0&&(a.flags|=256),a.flags|=65536,a.lanes=m,c!==Dm&&(s=Error(i(422),{cause:c}),mc(Qr(s,o)))):(c!==Dm&&(a=Error(i(423),{cause:c}),mc(Qr(a,o))),s=s.current.alternate,s.flags|=65536,m&=-m,s.lanes|=m,c=Qr(c,o),m=gf(s.stateNode,c,m),$m(s,m),bn!==4&&(bn=2)),!1;var f=Error(i(520),{cause:c});if(f=Qr(f,o),Ic===null?Ic=[f]:Ic.push(f),bn!==4&&(bn=2),a===null)return!0;c=Qr(c,o),o=a;do{switch(o.tag){case 3:return o.flags|=65536,s=m&-m,o.lanes|=s,s=gf(o.stateNode,c,s),$m(o,s),!1;case 1:if(a=o.type,f=o.stateNode,(o.flags&128)===0&&(typeof a.getDerivedStateFromError=="function"||f!==null&&typeof f.componentDidCatch=="function"&&(Pi===null||!Pi.has(f))))return o.flags|=65536,m&=-m,o.lanes|=m,m=Ev(m),Nv(m,s,o,c),$m(o,m),!1}o=o.return}while(o!==null);return!1}var yf=Error(i(461)),Rn=!1;function Xn(s,a,o,c){a.child=s===null?Ab(a,null,o,c):Co(a,s.child,o,c)}function Sv(s,a,o,c,m){o=o.render;var f=a.ref;if("ref"in c){var x={};for(var N in c)N!=="ref"&&(x[N]=c[N])}else x=c;return To(a),c=Xm(s,a,o,x,f,m),N=Jm(),s!==null&&!Rn?(Zm(s,a,m),Ja(s,a,m)):(ws&&N&&Im(a),a.flags|=1,Xn(s,a,c,m),a.child)}function Cv(s,a,o,c,m){if(s===null){var f=o.type;return typeof f=="function"&&!Cm(f)&&f.defaultProps===void 0&&o.compare===null?(a.tag=15,a.type=f,Rv(s,a,f,c,m)):(s=ed(o.type,null,c,a,a.mode,m),s.ref=a.ref,s.return=a,a.child=s)}if(f=s.child,!Tf(s,m)){var x=f.memoizedProps;if(o=o.compare,o=o!==null?o:uc,o(x,c)&&s.ref===a.ref)return Ja(s,a,m)}return a.flags|=1,s=Wa(f,c),s.ref=a.ref,s.return=a,a.child=s}function Rv(s,a,o,c,m){if(s!==null){var f=s.memoizedProps;if(uc(f,c)&&s.ref===a.ref)if(Rn=!1,a.pendingProps=c=f,Tf(s,m))(s.flags&131072)!==0&&(Rn=!0);else return a.lanes=s.lanes,Ja(s,a,m)}return bf(s,a,o,c,m)}function Av(s,a,o,c){var m=c.children,f=s!==null?s.memoizedState:null;if(s===null&&a.stateNode===null&&(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),c.mode==="hidden"){if((a.flags&128)!==0){if(f=f!==null?f.baseLanes|o:o,s!==null){for(c=a.child=s.child,m=0;c!==null;)m=m|c.lanes|c.childLanes,c=c.sibling;c=m&~f}else c=0,a.child=null;return Iv(s,a,f,o,c)}if((o&536870912)!==0)a.memoizedState={baseLanes:0,cachePool:null},s!==null&&rd(a,f!==null?f.cachePool:null),f!==null?Db(a,f):Gm(),Pb(a);else return c=a.lanes=536870912,Iv(s,a,f!==null?f.baseLanes|o:o,o,c)}else f!==null?(rd(a,f.cachePool),Db(a,f),Ai(),a.memoizedState=null):(s!==null&&rd(a,null),Gm(),Ai());return Xn(s,a,m,o),a.child}function Tc(s,a){return s!==null&&s.tag===22||a.stateNode!==null||(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),a.sibling}function Iv(s,a,o,c,m){var f=zm();return f=f===null?null:{parent:Sn._currentValue,pool:f},a.memoizedState={baseLanes:o,cachePool:f},s!==null&&rd(a,null),Gm(),Pb(a),s!==null&&hl(s,a,c,!0),a.childLanes=m,null}function xd(s,a){return a=_d({mode:a.mode,children:a.children},s.mode),a.ref=s.ref,s.child=a,a.return=s,a}function Mv(s,a,o){return Co(a,s.child,null,o),s=xd(a,a.pendingProps),s.flags|=2,Br(a),a.memoizedState=null,s}function dj(s,a,o){var c=a.pendingProps,m=(a.flags&128)!==0;if(a.flags&=-129,s===null){if(ws){if(c.mode==="hidden")return s=xd(a,c),a.lanes=536870912,Tc(null,s);if(Ym(a),(s=nn)?(s=$0(s,Zr),s=s!==null&&s.data==="&"?s:null,s!==null&&(a.memoizedState={dehydrated:s,treeContext:ki!==null?{id:Na,overflow:Sa}:null,retryLane:536870912,hydrationErrors:null},o=gb(s),o.return=a,a.child=o,Yn=a,nn=null)):s=null,s===null)throw Ti(a);return a.lanes=536870912,null}return xd(a,c)}var f=s.memoizedState;if(f!==null){var x=f.dehydrated;if(Ym(a),m)if(a.flags&256)a.flags&=-257,a=Mv(s,a,o);else if(a.memoizedState!==null)a.child=s.child,a.flags|=128,a=null;else throw Error(i(558));else if(Rn||hl(s,a,o,!1),m=(o&s.childLanes)!==0,Rn||m){if(c=Xs,c!==null&&(x=Ls(c,o),x!==0&&x!==f.retryLane))throw f.retryLane=x,wo(s,x),Rr(c,s,x),yf;Ad(),a=Mv(s,a,o)}else s=f.treeContext,nn=ta(x.nextSibling),Yn=a,ws=!0,ji=null,Zr=!1,s!==null&&vb(a,s),a=xd(a,c),a.flags|=4096;return a}return s=Wa(s.child,{mode:c.mode,children:c.children}),s.ref=a.ref,a.child=s,s.return=a,s}function wd(s,a){var o=a.ref;if(o===null)s!==null&&s.ref!==null&&(a.flags|=4194816);else{if(typeof o!="function"&&typeof o!="object")throw Error(i(284));(s===null||s.ref!==o)&&(a.flags|=4194816)}}function bf(s,a,o,c,m){return To(a),o=Xm(s,a,o,c,void 0,m),c=Jm(),s!==null&&!Rn?(Zm(s,a,m),Ja(s,a,m)):(ws&&c&&Im(a),a.flags|=1,Xn(s,a,o,m),a.child)}function Dv(s,a,o,c,m,f){return To(a),a.updateQueue=null,o=Ob(a,c,o,m),Lb(s),c=Jm(),s!==null&&!Rn?(Zm(s,a,f),Ja(s,a,f)):(ws&&c&&Im(a),a.flags|=1,Xn(s,a,o,f),a.child)}function Pv(s,a,o,c,m){if(To(a),a.stateNode===null){var f=ll,x=o.contextType;typeof x=="object"&&x!==null&&(f=Qn(x)),f=new o(c,f),a.memoizedState=f.state!==null&&f.state!==void 0?f.state:null,f.updater=pf,a.stateNode=f,f._reactInternals=a,f=a.stateNode,f.props=c,f.state=a.memoizedState,f.refs={},qm(a),x=o.contextType,f.context=typeof x=="object"&&x!==null?Qn(x):ll,f.state=a.memoizedState,x=o.getDerivedStateFromProps,typeof x=="function"&&(ff(a,o,x,c),f.state=a.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof f.getSnapshotBeforeUpdate=="function"||typeof f.UNSAFE_componentWillMount!="function"&&typeof f.componentWillMount!="function"||(x=f.state,typeof f.componentWillMount=="function"&&f.componentWillMount(),typeof f.UNSAFE_componentWillMount=="function"&&f.UNSAFE_componentWillMount(),x!==f.state&&pf.enqueueReplaceState(f,f.state,null),xc(a,c,f,m),vc(),f.state=a.memoizedState),typeof f.componentDidMount=="function"&&(a.flags|=4194308),c=!0}else if(s===null){f=a.stateNode;var N=a.memoizedProps,U=Ao(o,N);f.props=U;var ie=f.context,ke=o.contextType;x=ll,typeof ke=="object"&&ke!==null&&(x=Qn(ke));var Ce=o.getDerivedStateFromProps;ke=typeof Ce=="function"||typeof f.getSnapshotBeforeUpdate=="function",N=a.pendingProps!==N,ke||typeof f.UNSAFE_componentWillReceiveProps!="function"&&typeof f.componentWillReceiveProps!="function"||(N||ie!==x)&&wv(a,f,c,x),Ni=!1;var le=a.memoizedState;f.state=le,xc(a,c,f,m),vc(),ie=a.memoizedState,N||le!==ie||Ni?(typeof Ce=="function"&&(ff(a,o,Ce,c),ie=a.memoizedState),(U=Ni||xv(a,o,U,c,le,ie,x))?(ke||typeof f.UNSAFE_componentWillMount!="function"&&typeof f.componentWillMount!="function"||(typeof f.componentWillMount=="function"&&f.componentWillMount(),typeof f.UNSAFE_componentWillMount=="function"&&f.UNSAFE_componentWillMount()),typeof f.componentDidMount=="function"&&(a.flags|=4194308)):(typeof f.componentDidMount=="function"&&(a.flags|=4194308),a.memoizedProps=c,a.memoizedState=ie),f.props=c,f.state=ie,f.context=x,c=U):(typeof f.componentDidMount=="function"&&(a.flags|=4194308),c=!1)}else{f=a.stateNode,Hm(s,a),x=a.memoizedProps,ke=Ao(o,x),f.props=ke,Ce=a.pendingProps,le=f.context,ie=o.contextType,U=ll,typeof ie=="object"&&ie!==null&&(U=Qn(ie)),N=o.getDerivedStateFromProps,(ie=typeof N=="function"||typeof f.getSnapshotBeforeUpdate=="function")||typeof f.UNSAFE_componentWillReceiveProps!="function"&&typeof f.componentWillReceiveProps!="function"||(x!==Ce||le!==U)&&wv(a,f,c,U),Ni=!1,le=a.memoizedState,f.state=le,xc(a,c,f,m),vc();var me=a.memoizedState;x!==Ce||le!==me||Ni||s!==null&&s.dependencies!==null&&sd(s.dependencies)?(typeof N=="function"&&(ff(a,o,N,c),me=a.memoizedState),(ke=Ni||xv(a,o,ke,c,le,me,U)||s!==null&&s.dependencies!==null&&sd(s.dependencies))?(ie||typeof f.UNSAFE_componentWillUpdate!="function"&&typeof f.componentWillUpdate!="function"||(typeof f.componentWillUpdate=="function"&&f.componentWillUpdate(c,me,U),typeof f.UNSAFE_componentWillUpdate=="function"&&f.UNSAFE_componentWillUpdate(c,me,U)),typeof f.componentDidUpdate=="function"&&(a.flags|=4),typeof f.getSnapshotBeforeUpdate=="function"&&(a.flags|=1024)):(typeof f.componentDidUpdate!="function"||x===s.memoizedProps&&le===s.memoizedState||(a.flags|=4),typeof f.getSnapshotBeforeUpdate!="function"||x===s.memoizedProps&&le===s.memoizedState||(a.flags|=1024),a.memoizedProps=c,a.memoizedState=me),f.props=c,f.state=me,f.context=U,c=ke):(typeof f.componentDidUpdate!="function"||x===s.memoizedProps&&le===s.memoizedState||(a.flags|=4),typeof f.getSnapshotBeforeUpdate!="function"||x===s.memoizedProps&&le===s.memoizedState||(a.flags|=1024),c=!1)}return f=c,wd(s,a),c=(a.flags&128)!==0,f||c?(f=a.stateNode,o=c&&typeof o.getDerivedStateFromError!="function"?null:f.render(),a.flags|=1,s!==null&&c?(a.child=Co(a,s.child,null,m),a.child=Co(a,null,o,m)):Xn(s,a,o,m),a.memoizedState=f.state,s=a.child):s=Ja(s,a,m),s}function Lv(s,a,o,c){return ko(),a.flags|=256,Xn(s,a,o,c),a.child}var vf={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function xf(s){return{baseLanes:s,cachePool:Tb()}}function wf(s,a,o){return s=s!==null?s.childLanes&~o:0,a&&(s|=zr),s}function Ov(s,a,o){var c=a.pendingProps,m=!1,f=(a.flags&128)!==0,x;if((x=f)||(x=s!==null&&s.memoizedState===null?!1:(jn.current&2)!==0),x&&(m=!0,a.flags&=-129),x=(a.flags&32)!==0,a.flags&=-33,s===null){if(ws){if(m?Ri(a):Ai(),(s=nn)?(s=$0(s,Zr),s=s!==null&&s.data!=="&"?s:null,s!==null&&(a.memoizedState={dehydrated:s,treeContext:ki!==null?{id:Na,overflow:Sa}:null,retryLane:536870912,hydrationErrors:null},o=gb(s),o.return=a,a.child=o,Yn=a,nn=null)):s=null,s===null)throw Ti(a);return np(s)?a.lanes=32:a.lanes=536870912,null}var N=c.children;return c=c.fallback,m?(Ai(),m=a.mode,N=_d({mode:"hidden",children:N},m),c=_o(c,m,o,null),N.return=a,c.return=a,N.sibling=c,a.child=N,c=a.child,c.memoizedState=xf(o),c.childLanes=wf(s,x,o),a.memoizedState=vf,Tc(null,c)):(Ri(a),_f(a,N))}var U=s.memoizedState;if(U!==null&&(N=U.dehydrated,N!==null)){if(f)a.flags&256?(Ri(a),a.flags&=-257,a=kf(s,a,o)):a.memoizedState!==null?(Ai(),a.child=s.child,a.flags|=128,a=null):(Ai(),N=c.fallback,m=a.mode,c=_d({mode:"visible",children:c.children},m),N=_o(N,m,o,null),N.flags|=2,c.return=a,N.return=a,c.sibling=N,a.child=c,Co(a,s.child,null,o),c=a.child,c.memoizedState=xf(o),c.childLanes=wf(s,x,o),a.memoizedState=vf,a=Tc(null,c));else if(Ri(a),np(N)){if(x=N.nextSibling&&N.nextSibling.dataset,x)var ie=x.dgst;x=ie,c=Error(i(419)),c.stack="",c.digest=x,mc({value:c,source:null,stack:null}),a=kf(s,a,o)}else if(Rn||hl(s,a,o,!1),x=(o&s.childLanes)!==0,Rn||x){if(x=Xs,x!==null&&(c=Ls(x,o),c!==0&&c!==U.retryLane))throw U.retryLane=c,wo(s,c),Rr(x,s,c),yf;sp(N)||Ad(),a=kf(s,a,o)}else sp(N)?(a.flags|=192,a.child=s.child,a=null):(s=U.treeContext,nn=ta(N.nextSibling),Yn=a,ws=!0,ji=null,Zr=!1,s!==null&&vb(a,s),a=_f(a,c.children),a.flags|=4096);return a}return m?(Ai(),N=c.fallback,m=a.mode,U=s.child,ie=U.sibling,c=Wa(U,{mode:"hidden",children:c.children}),c.subtreeFlags=U.subtreeFlags&65011712,ie!==null?N=Wa(ie,N):(N=_o(N,m,o,null),N.flags|=2),N.return=a,c.return=a,c.sibling=N,a.child=c,Tc(null,c),c=a.child,N=s.child.memoizedState,N===null?N=xf(o):(m=N.cachePool,m!==null?(U=Sn._currentValue,m=m.parent!==U?{parent:U,pool:U}:m):m=Tb(),N={baseLanes:N.baseLanes|o,cachePool:m}),c.memoizedState=N,c.childLanes=wf(s,x,o),a.memoizedState=vf,Tc(s.child,c)):(Ri(a),o=s.child,s=o.sibling,o=Wa(o,{mode:"visible",children:c.children}),o.return=a,o.sibling=null,s!==null&&(x=a.deletions,x===null?(a.deletions=[s],a.flags|=16):x.push(s)),a.child=o,a.memoizedState=null,o)}function _f(s,a){return a=_d({mode:"visible",children:a},s.mode),a.return=s,s.child=a}function _d(s,a){return s=Or(22,s,null,a),s.lanes=0,s}function kf(s,a,o){return Co(a,s.child,null,o),s=_f(a,a.pendingProps.children),s.flags|=2,a.memoizedState=null,s}function Vv(s,a,o){s.lanes|=a;var c=s.alternate;c!==null&&(c.lanes|=a),Om(s.return,a,o)}function jf(s,a,o,c,m,f){var x=s.memoizedState;x===null?s.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:c,tail:o,tailMode:m,treeForkCount:f}:(x.isBackwards=a,x.rendering=null,x.renderingStartTime=0,x.last=c,x.tail=o,x.tailMode=m,x.treeForkCount=f)}function Bv(s,a,o){var c=a.pendingProps,m=c.revealOrder,f=c.tail;c=c.children;var x=jn.current,N=(x&2)!==0;if(N?(x=x&1|2,a.flags|=128):x&=1,Re(jn,x),Xn(s,a,c,o),c=ws?hc:0,!N&&s!==null&&(s.flags&128)!==0)e:for(s=a.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&Vv(s,o,a);else if(s.tag===19)Vv(s,o,a);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===a)break e;for(;s.sibling===null;){if(s.return===null||s.return===a)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}switch(m){case"forwards":for(o=a.child,m=null;o!==null;)s=o.alternate,s!==null&&ud(s)===null&&(m=o),o=o.sibling;o=m,o===null?(m=a.child,a.child=null):(m=o.sibling,o.sibling=null),jf(a,!1,m,o,f,c);break;case"backwards":case"unstable_legacy-backwards":for(o=null,m=a.child,a.child=null;m!==null;){if(s=m.alternate,s!==null&&ud(s)===null){a.child=m;break}s=m.sibling,m.sibling=o,o=m,m=s}jf(a,!0,o,null,f,c);break;case"together":jf(a,!1,null,null,void 0,c);break;default:a.memoizedState=null}return a.child}function Ja(s,a,o){if(s!==null&&(a.dependencies=s.dependencies),Di|=a.lanes,(o&a.childLanes)===0)if(s!==null){if(hl(s,a,o,!1),(o&a.childLanes)===0)return null}else return null;if(s!==null&&a.child!==s.child)throw Error(i(153));if(a.child!==null){for(s=a.child,o=Wa(s,s.pendingProps),a.child=o,o.return=a;s.sibling!==null;)s=s.sibling,o=o.sibling=Wa(s,s.pendingProps),o.return=a;o.sibling=null}return a.child}function Tf(s,a){return(s.lanes&a)!==0?!0:(s=s.dependencies,!!(s!==null&&sd(s)))}function hj(s,a,o){switch(a.tag){case 3:kt(a,a.stateNode.containerInfo),Ei(a,Sn,s.memoizedState.cache),ko();break;case 27:case 5:Wt(a);break;case 4:kt(a,a.stateNode.containerInfo);break;case 10:Ei(a,a.type,a.memoizedProps.value);break;case 31:if(a.memoizedState!==null)return a.flags|=128,Ym(a),null;break;case 13:var c=a.memoizedState;if(c!==null)return c.dehydrated!==null?(Ri(a),a.flags|=128,null):(o&a.child.childLanes)!==0?Ov(s,a,o):(Ri(a),s=Ja(s,a,o),s!==null?s.sibling:null);Ri(a);break;case 19:var m=(s.flags&128)!==0;if(c=(o&a.childLanes)!==0,c||(hl(s,a,o,!1),c=(o&a.childLanes)!==0),m){if(c)return Bv(s,a,o);a.flags|=128}if(m=a.memoizedState,m!==null&&(m.rendering=null,m.tail=null,m.lastEffect=null),Re(jn,jn.current),c)break;return null;case 22:return a.lanes=0,Av(s,a,o,a.pendingProps);case 24:Ei(a,Sn,s.memoizedState.cache)}return Ja(s,a,o)}function Uv(s,a,o){if(s!==null)if(s.memoizedProps!==a.pendingProps)Rn=!0;else{if(!Tf(s,o)&&(a.flags&128)===0)return Rn=!1,hj(s,a,o);Rn=(s.flags&131072)!==0}else Rn=!1,ws&&(a.flags&1048576)!==0&&bb(a,hc,a.index);switch(a.lanes=0,a.tag){case 16:e:{var c=a.pendingProps;if(s=No(a.elementType),a.type=s,typeof s=="function")Cm(s)?(c=Ao(s,c),a.tag=1,a=Pv(null,a,s,c,o)):(a.tag=0,a=bf(null,a,s,c,o));else{if(s!=null){var m=s.$$typeof;if(m===ye){a.tag=11,a=Sv(null,a,s,c,o);break e}else if(m===R){a.tag=14,a=Cv(null,a,s,c,o);break e}}throw a=Ge(s)||s,Error(i(306,a,""))}}return a;case 0:return bf(s,a,a.type,a.pendingProps,o);case 1:return c=a.type,m=Ao(c,a.pendingProps),Pv(s,a,c,m,o);case 3:e:{if(kt(a,a.stateNode.containerInfo),s===null)throw Error(i(387));c=a.pendingProps;var f=a.memoizedState;m=f.element,Hm(s,a),xc(a,c,null,o);var x=a.memoizedState;if(c=x.cache,Ei(a,Sn,c),c!==f.cache&&Vm(a,[Sn],o,!0),vc(),c=x.element,f.isDehydrated)if(f={element:c,isDehydrated:!1,cache:x.cache},a.updateQueue.baseState=f,a.memoizedState=f,a.flags&256){a=Lv(s,a,c,o);break e}else if(c!==m){m=Qr(Error(i(424)),a),mc(m),a=Lv(s,a,c,o);break e}else for(s=a.stateNode.containerInfo,s.nodeType===9?s=s.body:s=s.nodeName==="HTML"?s.ownerDocument.body:s,nn=ta(s.firstChild),Yn=a,ws=!0,ji=null,Zr=!0,o=Ab(a,null,c,o),a.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling;else{if(ko(),c===m){a=Ja(s,a,o);break e}Xn(s,a,c,o)}a=a.child}return a;case 26:return wd(s,a),s===null?(o=X0(a.type,null,a.pendingProps,null))?a.memoizedState=o:ws||(o=a.type,s=a.pendingProps,c=Vd(qe.current).createElement(o),c[at]=a,c[Rt]=s,Jn(c,o,s),S(c),a.stateNode=c):a.memoizedState=X0(a.type,s.memoizedProps,a.pendingProps,s.memoizedState),null;case 27:return Wt(a),s===null&&ws&&(c=a.stateNode=K0(a.type,a.pendingProps,qe.current),Yn=a,Zr=!0,m=nn,Bi(a.type)?(rp=m,nn=ta(c.firstChild)):nn=m),Xn(s,a,a.pendingProps.children,o),wd(s,a),s===null&&(a.flags|=4194304),a.child;case 5:return s===null&&ws&&((m=c=nn)&&(c=Fj(c,a.type,a.pendingProps,Zr),c!==null?(a.stateNode=c,Yn=a,nn=ta(c.firstChild),Zr=!1,m=!0):m=!1),m||Ti(a)),Wt(a),m=a.type,f=a.pendingProps,x=s!==null?s.memoizedProps:null,c=f.children,Zf(m,f)?c=null:x!==null&&Zf(m,x)&&(a.flags|=32),a.memoizedState!==null&&(m=Xm(s,a,nj,null,null,o),Uc._currentValue=m),wd(s,a),Xn(s,a,c,o),a.child;case 6:return s===null&&ws&&((s=o=nn)&&(o=qj(o,a.pendingProps,Zr),o!==null?(a.stateNode=o,Yn=a,nn=null,s=!0):s=!1),s||Ti(a)),null;case 13:return Ov(s,a,o);case 4:return kt(a,a.stateNode.containerInfo),c=a.pendingProps,s===null?a.child=Co(a,null,c,o):Xn(s,a,c,o),a.child;case 11:return Sv(s,a,a.type,a.pendingProps,o);case 7:return Xn(s,a,a.pendingProps,o),a.child;case 8:return Xn(s,a,a.pendingProps.children,o),a.child;case 12:return Xn(s,a,a.pendingProps.children,o),a.child;case 10:return c=a.pendingProps,Ei(a,a.type,c.value),Xn(s,a,c.children,o),a.child;case 9:return m=a.type._context,c=a.pendingProps.children,To(a),m=Qn(m),c=c(m),a.flags|=1,Xn(s,a,c,o),a.child;case 14:return Cv(s,a,a.type,a.pendingProps,o);case 15:return Rv(s,a,a.type,a.pendingProps,o);case 19:return Bv(s,a,o);case 31:return dj(s,a,o);case 22:return Av(s,a,o,a.pendingProps);case 24:return To(a),c=Qn(Sn),s===null?(m=zm(),m===null&&(m=Xs,f=Bm(),m.pooledCache=f,f.refCount++,f!==null&&(m.pooledCacheLanes|=o),m=f),a.memoizedState={parent:c,cache:m},qm(a),Ei(a,Sn,m)):((s.lanes&o)!==0&&(Hm(s,a),xc(a,null,null,o),vc()),m=s.memoizedState,f=a.memoizedState,m.parent!==c?(m={parent:c,cache:c},a.memoizedState=m,a.lanes===0&&(a.memoizedState=a.updateQueue.baseState=m),Ei(a,Sn,c)):(c=f.cache,Ei(a,Sn,c),c!==m.cache&&Vm(a,[Sn],o,!0))),Xn(s,a,a.pendingProps.children,o),a.child;case 29:throw a.pendingProps}throw Error(i(156,a.tag))}function Za(s){s.flags|=4}function Ef(s,a,o,c,m){if((a=(s.mode&32)!==0)&&(a=!1),a){if(s.flags|=16777216,(m&335544128)===m)if(s.stateNode.complete)s.flags|=8192;else if(m0())s.flags|=8192;else throw So=id,Fm}else s.flags&=-16777217}function zv(s,a){if(a.type!=="stylesheet"||(a.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!s1(a))if(m0())s.flags|=8192;else throw So=id,Fm}function kd(s,a){a!==null&&(s.flags|=4),s.flags&16384&&(a=s.tag!==22?Qt():536870912,s.lanes|=a,jl|=a)}function Ec(s,a){if(!ws)switch(s.tailMode){case"hidden":a=s.tail;for(var o=null;a!==null;)a.alternate!==null&&(o=a),a=a.sibling;o===null?s.tail=null:o.sibling=null;break;case"collapsed":o=s.tail;for(var c=null;o!==null;)o.alternate!==null&&(c=o),o=o.sibling;c===null?a||s.tail===null?s.tail=null:s.tail.sibling=null:c.sibling=null}}function rn(s){var a=s.alternate!==null&&s.alternate.child===s.child,o=0,c=0;if(a)for(var m=s.child;m!==null;)o|=m.lanes|m.childLanes,c|=m.subtreeFlags&65011712,c|=m.flags&65011712,m.return=s,m=m.sibling;else for(m=s.child;m!==null;)o|=m.lanes|m.childLanes,c|=m.subtreeFlags,c|=m.flags,m.return=s,m=m.sibling;return s.subtreeFlags|=c,s.childLanes=o,a}function mj(s,a,o){var c=a.pendingProps;switch(Mm(a),a.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return rn(a),null;case 1:return rn(a),null;case 3:return o=a.stateNode,c=null,s!==null&&(c=s.memoizedState.cache),a.memoizedState.cache!==c&&(a.flags|=2048),Ya(Sn),rt(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(s===null||s.child===null)&&(dl(a)?Za(a):s===null||s.memoizedState.isDehydrated&&(a.flags&256)===0||(a.flags|=1024,Pm())),rn(a),null;case 26:var m=a.type,f=a.memoizedState;return s===null?(Za(a),f!==null?(rn(a),zv(a,f)):(rn(a),Ef(a,m,null,c,o))):f?f!==s.memoizedState?(Za(a),rn(a),zv(a,f)):(rn(a),a.flags&=-16777217):(s=s.memoizedProps,s!==c&&Za(a),rn(a),Ef(a,m,s,c,o)),null;case 27:if(_s(a),o=qe.current,m=a.type,s!==null&&a.stateNode!=null)s.memoizedProps!==c&&Za(a);else{if(!c){if(a.stateNode===null)throw Error(i(166));return rn(a),null}s=Le.current,dl(a)?xb(a):(s=K0(m,c,o),a.stateNode=s,Za(a))}return rn(a),null;case 5:if(_s(a),m=a.type,s!==null&&a.stateNode!=null)s.memoizedProps!==c&&Za(a);else{if(!c){if(a.stateNode===null)throw Error(i(166));return rn(a),null}if(f=Le.current,dl(a))xb(a);else{var x=Vd(qe.current);switch(f){case 1:f=x.createElementNS("http://www.w3.org/2000/svg",m);break;case 2:f=x.createElementNS("http://www.w3.org/1998/Math/MathML",m);break;default:switch(m){case"svg":f=x.createElementNS("http://www.w3.org/2000/svg",m);break;case"math":f=x.createElementNS("http://www.w3.org/1998/Math/MathML",m);break;case"script":f=x.createElement("div"),f.innerHTML="<script><\/script>",f=f.removeChild(f.firstChild);break;case"select":f=typeof c.is=="string"?x.createElement("select",{is:c.is}):x.createElement("select"),c.multiple?f.multiple=!0:c.size&&(f.size=c.size);break;default:f=typeof c.is=="string"?x.createElement(m,{is:c.is}):x.createElement(m)}}f[at]=a,f[Rt]=c;e:for(x=a.child;x!==null;){if(x.tag===5||x.tag===6)f.appendChild(x.stateNode);else if(x.tag!==4&&x.tag!==27&&x.child!==null){x.child.return=x,x=x.child;continue}if(x===a)break e;for(;x.sibling===null;){if(x.return===null||x.return===a)break e;x=x.return}x.sibling.return=x.return,x=x.sibling}a.stateNode=f;e:switch(Jn(f,m,c),m){case"button":case"input":case"select":case"textarea":c=!!c.autoFocus;break e;case"img":c=!0;break e;default:c=!1}c&&Za(a)}}return rn(a),Ef(a,a.type,s===null?null:s.memoizedProps,a.pendingProps,o),null;case 6:if(s&&a.stateNode!=null)s.memoizedProps!==c&&Za(a);else{if(typeof c!="string"&&a.stateNode===null)throw Error(i(166));if(s=qe.current,dl(a)){if(s=a.stateNode,o=a.memoizedProps,c=null,m=Yn,m!==null)switch(m.tag){case 27:case 5:c=m.memoizedProps}s[at]=a,s=!!(s.nodeValue===o||c!==null&&c.suppressHydrationWarning===!0||O0(s.nodeValue,o)),s||Ti(a,!0)}else s=Vd(s).createTextNode(c),s[at]=a,a.stateNode=s}return rn(a),null;case 31:if(o=a.memoizedState,s===null||s.memoizedState!==null){if(c=dl(a),o!==null){if(s===null){if(!c)throw Error(i(318));if(s=a.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(557));s[at]=a}else ko(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;rn(a),s=!1}else o=Pm(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=o),s=!0;if(!s)return a.flags&256?(Br(a),a):(Br(a),null);if((a.flags&128)!==0)throw Error(i(558))}return rn(a),null;case 13:if(c=a.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(m=dl(a),c!==null&&c.dehydrated!==null){if(s===null){if(!m)throw Error(i(318));if(m=a.memoizedState,m=m!==null?m.dehydrated:null,!m)throw Error(i(317));m[at]=a}else ko(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;rn(a),m=!1}else m=Pm(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=m),m=!0;if(!m)return a.flags&256?(Br(a),a):(Br(a),null)}return Br(a),(a.flags&128)!==0?(a.lanes=o,a):(o=c!==null,s=s!==null&&s.memoizedState!==null,o&&(c=a.child,m=null,c.alternate!==null&&c.alternate.memoizedState!==null&&c.alternate.memoizedState.cachePool!==null&&(m=c.alternate.memoizedState.cachePool.pool),f=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(f=c.memoizedState.cachePool.pool),f!==m&&(c.flags|=2048)),o!==s&&o&&(a.child.flags|=8192),kd(a,a.updateQueue),rn(a),null);case 4:return rt(),s===null&&Kf(a.stateNode.containerInfo),rn(a),null;case 10:return Ya(a.type),rn(a),null;case 19:if(re(jn),c=a.memoizedState,c===null)return rn(a),null;if(m=(a.flags&128)!==0,f=c.rendering,f===null)if(m)Ec(c,!1);else{if(bn!==0||s!==null&&(s.flags&128)!==0)for(s=a.child;s!==null;){if(f=ud(s),f!==null){for(a.flags|=128,Ec(c,!1),s=f.updateQueue,a.updateQueue=s,kd(a,s),a.subtreeFlags=0,s=o,o=a.child;o!==null;)pb(o,s),o=o.sibling;return Re(jn,jn.current&1|2),ws&&Ga(a,c.treeForkCount),a.child}s=s.sibling}c.tail!==null&&Ut()>Sd&&(a.flags|=128,m=!0,Ec(c,!1),a.lanes=4194304)}else{if(!m)if(s=ud(f),s!==null){if(a.flags|=128,m=!0,s=s.updateQueue,a.updateQueue=s,kd(a,s),Ec(c,!0),c.tail===null&&c.tailMode==="hidden"&&!f.alternate&&!ws)return rn(a),null}else 2*Ut()-c.renderingStartTime>Sd&&o!==536870912&&(a.flags|=128,m=!0,Ec(c,!1),a.lanes=4194304);c.isBackwards?(f.sibling=a.child,a.child=f):(s=c.last,s!==null?s.sibling=f:a.child=f,c.last=f)}return c.tail!==null?(s=c.tail,c.rendering=s,c.tail=s.sibling,c.renderingStartTime=Ut(),s.sibling=null,o=jn.current,Re(jn,m?o&1|2:o&1),ws&&Ga(a,c.treeForkCount),s):(rn(a),null);case 22:case 23:return Br(a),Km(),c=a.memoizedState!==null,s!==null?s.memoizedState!==null!==c&&(a.flags|=8192):c&&(a.flags|=8192),c?(o&536870912)!==0&&(a.flags&128)===0&&(rn(a),a.subtreeFlags&6&&(a.flags|=8192)):rn(a),o=a.updateQueue,o!==null&&kd(a,o.retryQueue),o=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(o=s.memoizedState.cachePool.pool),c=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(c=a.memoizedState.cachePool.pool),c!==o&&(a.flags|=2048),s!==null&&re(Eo),null;case 24:return o=null,s!==null&&(o=s.memoizedState.cache),a.memoizedState.cache!==o&&(a.flags|=2048),Ya(Sn),rn(a),null;case 25:return null;case 30:return null}throw Error(i(156,a.tag))}function fj(s,a){switch(Mm(a),a.tag){case 1:return s=a.flags,s&65536?(a.flags=s&-65537|128,a):null;case 3:return Ya(Sn),rt(),s=a.flags,(s&65536)!==0&&(s&128)===0?(a.flags=s&-65537|128,a):null;case 26:case 27:case 5:return _s(a),null;case 31:if(a.memoizedState!==null){if(Br(a),a.alternate===null)throw Error(i(340));ko()}return s=a.flags,s&65536?(a.flags=s&-65537|128,a):null;case 13:if(Br(a),s=a.memoizedState,s!==null&&s.dehydrated!==null){if(a.alternate===null)throw Error(i(340));ko()}return s=a.flags,s&65536?(a.flags=s&-65537|128,a):null;case 19:return re(jn),null;case 4:return rt(),null;case 10:return Ya(a.type),null;case 22:case 23:return Br(a),Km(),s!==null&&re(Eo),s=a.flags,s&65536?(a.flags=s&-65537|128,a):null;case 24:return Ya(Sn),null;case 25:return null;default:return null}}function Fv(s,a){switch(Mm(a),a.tag){case 3:Ya(Sn),rt();break;case 26:case 27:case 5:_s(a);break;case 4:rt();break;case 31:a.memoizedState!==null&&Br(a);break;case 13:Br(a);break;case 19:re(jn);break;case 10:Ya(a.type);break;case 22:case 23:Br(a),Km(),s!==null&&re(Eo);break;case 24:Ya(Sn)}}function Nc(s,a){try{var o=a.updateQueue,c=o!==null?o.lastEffect:null;if(c!==null){var m=c.next;o=m;do{if((o.tag&s)===s){c=void 0;var f=o.create,x=o.inst;c=f(),x.destroy=c}o=o.next}while(o!==m)}}catch(N){qs(a,a.return,N)}}function Ii(s,a,o){try{var c=a.updateQueue,m=c!==null?c.lastEffect:null;if(m!==null){var f=m.next;c=f;do{if((c.tag&s)===s){var x=c.inst,N=x.destroy;if(N!==void 0){x.destroy=void 0,m=a;var U=o,ie=N;try{ie()}catch(ke){qs(m,U,ke)}}}c=c.next}while(c!==f)}}catch(ke){qs(a,a.return,ke)}}function qv(s){var a=s.updateQueue;if(a!==null){var o=s.stateNode;try{Mb(a,o)}catch(c){qs(s,s.return,c)}}}function Hv(s,a,o){o.props=Ao(s.type,s.memoizedProps),o.state=s.memoizedState;try{o.componentWillUnmount()}catch(c){qs(s,a,c)}}function Sc(s,a){try{var o=s.ref;if(o!==null){switch(s.tag){case 26:case 27:case 5:var c=s.stateNode;break;case 30:c=s.stateNode;break;default:c=s.stateNode}typeof o=="function"?s.refCleanup=o(c):o.current=c}}catch(m){qs(s,a,m)}}function Ca(s,a){var o=s.ref,c=s.refCleanup;if(o!==null)if(typeof c=="function")try{c()}catch(m){qs(s,a,m)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof o=="function")try{o(null)}catch(m){qs(s,a,m)}else o.current=null}function $v(s){var a=s.type,o=s.memoizedProps,c=s.stateNode;try{e:switch(a){case"button":case"input":case"select":case"textarea":o.autoFocus&&c.focus();break e;case"img":o.src?c.src=o.src:o.srcSet&&(c.srcset=o.srcSet)}}catch(m){qs(s,s.return,m)}}function Nf(s,a,o){try{var c=s.stateNode;Lj(c,s.type,o,a),c[Rt]=a}catch(m){qs(s,s.return,m)}}function Wv(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&Bi(s.type)||s.tag===4}function Sf(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||Wv(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&Bi(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function Cf(s,a,o){var c=s.tag;if(c===5||c===6)s=s.stateNode,a?(o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o).insertBefore(s,a):(a=o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o,a.appendChild(s),o=o._reactRootContainer,o!=null||a.onclick!==null||(a.onclick=sn));else if(c!==4&&(c===27&&Bi(s.type)&&(o=s.stateNode,a=null),s=s.child,s!==null))for(Cf(s,a,o),s=s.sibling;s!==null;)Cf(s,a,o),s=s.sibling}function jd(s,a,o){var c=s.tag;if(c===5||c===6)s=s.stateNode,a?o.insertBefore(s,a):o.appendChild(s);else if(c!==4&&(c===27&&Bi(s.type)&&(o=s.stateNode),s=s.child,s!==null))for(jd(s,a,o),s=s.sibling;s!==null;)jd(s,a,o),s=s.sibling}function Gv(s){var a=s.stateNode,o=s.memoizedProps;try{for(var c=s.type,m=a.attributes;m.length;)a.removeAttributeNode(m[0]);Jn(a,c,o),a[at]=s,a[Rt]=o}catch(f){qs(s,s.return,f)}}var ei=!1,An=!1,Rf=!1,Kv=typeof WeakSet=="function"?WeakSet:Set,qn=null;function pj(s,a){if(s=s.containerInfo,Xf=$d,s=ib(s),_m(s)){if("selectionStart"in s)var o={start:s.selectionStart,end:s.selectionEnd};else e:{o=(o=s.ownerDocument)&&o.defaultView||window;var c=o.getSelection&&o.getSelection();if(c&&c.rangeCount!==0){o=c.anchorNode;var m=c.anchorOffset,f=c.focusNode;c=c.focusOffset;try{o.nodeType,f.nodeType}catch{o=null;break e}var x=0,N=-1,U=-1,ie=0,ke=0,Ce=s,le=null;t:for(;;){for(var me;Ce!==o||m!==0&&Ce.nodeType!==3||(N=x+m),Ce!==f||c!==0&&Ce.nodeType!==3||(U=x+c),Ce.nodeType===3&&(x+=Ce.nodeValue.length),(me=Ce.firstChild)!==null;)le=Ce,Ce=me;for(;;){if(Ce===s)break t;if(le===o&&++ie===m&&(N=x),le===f&&++ke===c&&(U=x),(me=Ce.nextSibling)!==null)break;Ce=le,le=Ce.parentNode}Ce=me}o=N===-1||U===-1?null:{start:N,end:U}}else o=null}o=o||{start:0,end:0}}else o=null;for(Jf={focusedElem:s,selectionRange:o},$d=!1,qn=a;qn!==null;)if(a=qn,s=a.child,(a.subtreeFlags&1028)!==0&&s!==null)s.return=a,qn=s;else for(;qn!==null;){switch(a=qn,f=a.alternate,s=a.flags,a.tag){case 0:if((s&4)!==0&&(s=a.updateQueue,s=s!==null?s.events:null,s!==null))for(o=0;o<s.length;o++)m=s[o],m.ref.impl=m.nextImpl;break;case 11:case 15:break;case 1:if((s&1024)!==0&&f!==null){s=void 0,o=a,m=f.memoizedProps,f=f.memoizedState,c=o.stateNode;try{var dt=Ao(o.type,m);s=c.getSnapshotBeforeUpdate(dt,f),c.__reactInternalSnapshotBeforeUpdate=s}catch(Pt){qs(o,o.return,Pt)}}break;case 3:if((s&1024)!==0){if(s=a.stateNode.containerInfo,o=s.nodeType,o===9)tp(s);else if(o===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":tp(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(i(163))}if(s=a.sibling,s!==null){s.return=a.return,qn=s;break}qn=a.return}}function Yv(s,a,o){var c=o.flags;switch(o.tag){case 0:case 11:case 15:si(s,o),c&4&&Nc(5,o);break;case 1:if(si(s,o),c&4)if(s=o.stateNode,a===null)try{s.componentDidMount()}catch(x){qs(o,o.return,x)}else{var m=Ao(o.type,a.memoizedProps);a=a.memoizedState;try{s.componentDidUpdate(m,a,s.__reactInternalSnapshotBeforeUpdate)}catch(x){qs(o,o.return,x)}}c&64&&qv(o),c&512&&Sc(o,o.return);break;case 3:if(si(s,o),c&64&&(s=o.updateQueue,s!==null)){if(a=null,o.child!==null)switch(o.child.tag){case 27:case 5:a=o.child.stateNode;break;case 1:a=o.child.stateNode}try{Mb(s,a)}catch(x){qs(o,o.return,x)}}break;case 27:a===null&&c&4&&Gv(o);case 26:case 5:si(s,o),a===null&&c&4&&$v(o),c&512&&Sc(o,o.return);break;case 12:si(s,o);break;case 31:si(s,o),c&4&&Jv(s,o);break;case 13:si(s,o),c&4&&Zv(s,o),c&64&&(s=o.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(o=jj.bind(null,o),Hj(s,o))));break;case 22:if(c=o.memoizedState!==null||ei,!c){a=a!==null&&a.memoizedState!==null||An,m=ei;var f=An;ei=c,(An=a)&&!f?ni(s,o,(o.subtreeFlags&8772)!==0):si(s,o),ei=m,An=f}break;case 30:break;default:si(s,o)}}function Qv(s){var a=s.alternate;a!==null&&(s.alternate=null,Qv(a)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(a=s.stateNode,a!==null&&_n(a)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var ln=null,Er=!1;function ti(s,a,o){for(o=o.child;o!==null;)Xv(s,a,o),o=o.sibling}function Xv(s,a,o){if(Ue&&typeof Ue.onCommitFiberUnmount=="function")try{Ue.onCommitFiberUnmount(et,o)}catch{}switch(o.tag){case 26:An||Ca(o,a),ti(s,a,o),o.memoizedState?o.memoizedState.count--:o.stateNode&&(o=o.stateNode,o.parentNode.removeChild(o));break;case 27:An||Ca(o,a);var c=ln,m=Er;Bi(o.type)&&(ln=o.stateNode,Er=!1),ti(s,a,o),Oc(o.stateNode),ln=c,Er=m;break;case 5:An||Ca(o,a);case 6:if(c=ln,m=Er,ln=null,ti(s,a,o),ln=c,Er=m,ln!==null)if(Er)try{(ln.nodeType===9?ln.body:ln.nodeName==="HTML"?ln.ownerDocument.body:ln).removeChild(o.stateNode)}catch(f){qs(o,a,f)}else try{ln.removeChild(o.stateNode)}catch(f){qs(o,a,f)}break;case 18:ln!==null&&(Er?(s=ln,q0(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,o.stateNode),Il(s)):q0(ln,o.stateNode));break;case 4:c=ln,m=Er,ln=o.stateNode.containerInfo,Er=!0,ti(s,a,o),ln=c,Er=m;break;case 0:case 11:case 14:case 15:Ii(2,o,a),An||Ii(4,o,a),ti(s,a,o);break;case 1:An||(Ca(o,a),c=o.stateNode,typeof c.componentWillUnmount=="function"&&Hv(o,a,c)),ti(s,a,o);break;case 21:ti(s,a,o);break;case 22:An=(c=An)||o.memoizedState!==null,ti(s,a,o),An=c;break;default:ti(s,a,o)}}function Jv(s,a){if(a.memoizedState===null&&(s=a.alternate,s!==null&&(s=s.memoizedState,s!==null))){s=s.dehydrated;try{Il(s)}catch(o){qs(a,a.return,o)}}}function Zv(s,a){if(a.memoizedState===null&&(s=a.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{Il(s)}catch(o){qs(a,a.return,o)}}function gj(s){switch(s.tag){case 31:case 13:case 19:var a=s.stateNode;return a===null&&(a=s.stateNode=new Kv),a;case 22:return s=s.stateNode,a=s._retryCache,a===null&&(a=s._retryCache=new Kv),a;default:throw Error(i(435,s.tag))}}function Td(s,a){var o=gj(s);a.forEach(function(c){if(!o.has(c)){o.add(c);var m=Tj.bind(null,s,c);c.then(m,m)}})}function Nr(s,a){var o=a.deletions;if(o!==null)for(var c=0;c<o.length;c++){var m=o[c],f=s,x=a,N=x;e:for(;N!==null;){switch(N.tag){case 27:if(Bi(N.type)){ln=N.stateNode,Er=!1;break e}break;case 5:ln=N.stateNode,Er=!1;break e;case 3:case 4:ln=N.stateNode.containerInfo,Er=!0;break e}N=N.return}if(ln===null)throw Error(i(160));Xv(f,x,m),ln=null,Er=!1,f=m.alternate,f!==null&&(f.return=null),m.return=null}if(a.subtreeFlags&13886)for(a=a.child;a!==null;)e0(a,s),a=a.sibling}var da=null;function e0(s,a){var o=s.alternate,c=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:Nr(a,s),Sr(s),c&4&&(Ii(3,s,s.return),Nc(3,s),Ii(5,s,s.return));break;case 1:Nr(a,s),Sr(s),c&512&&(An||o===null||Ca(o,o.return)),c&64&&ei&&(s=s.updateQueue,s!==null&&(c=s.callbacks,c!==null&&(o=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=o===null?c:o.concat(c))));break;case 26:var m=da;if(Nr(a,s),Sr(s),c&512&&(An||o===null||Ca(o,o.return)),c&4){var f=o!==null?o.memoizedState:null;if(c=s.memoizedState,o===null)if(c===null)if(s.stateNode===null){e:{c=s.type,o=s.memoizedProps,m=m.ownerDocument||m;t:switch(c){case"title":f=m.getElementsByTagName("title")[0],(!f||f[fn]||f[at]||f.namespaceURI==="http://www.w3.org/2000/svg"||f.hasAttribute("itemprop"))&&(f=m.createElement(c),m.head.insertBefore(f,m.querySelector("head > title"))),Jn(f,c,o),f[at]=s,S(f),c=f;break e;case"link":var x=e1("link","href",m).get(c+(o.href||""));if(x){for(var N=0;N<x.length;N++)if(f=x[N],f.getAttribute("href")===(o.href==null||o.href===""?null:o.href)&&f.getAttribute("rel")===(o.rel==null?null:o.rel)&&f.getAttribute("title")===(o.title==null?null:o.title)&&f.getAttribute("crossorigin")===(o.crossOrigin==null?null:o.crossOrigin)){x.splice(N,1);break t}}f=m.createElement(c),Jn(f,c,o),m.head.appendChild(f);break;case"meta":if(x=e1("meta","content",m).get(c+(o.content||""))){for(N=0;N<x.length;N++)if(f=x[N],f.getAttribute("content")===(o.content==null?null:""+o.content)&&f.getAttribute("name")===(o.name==null?null:o.name)&&f.getAttribute("property")===(o.property==null?null:o.property)&&f.getAttribute("http-equiv")===(o.httpEquiv==null?null:o.httpEquiv)&&f.getAttribute("charset")===(o.charSet==null?null:o.charSet)){x.splice(N,1);break t}}f=m.createElement(c),Jn(f,c,o),m.head.appendChild(f);break;default:throw Error(i(468,c))}f[at]=s,S(f),c=f}s.stateNode=c}else t1(m,s.type,s.stateNode);else s.stateNode=Z0(m,c,s.memoizedProps);else f!==c?(f===null?o.stateNode!==null&&(o=o.stateNode,o.parentNode.removeChild(o)):f.count--,c===null?t1(m,s.type,s.stateNode):Z0(m,c,s.memoizedProps)):c===null&&s.stateNode!==null&&Nf(s,s.memoizedProps,o.memoizedProps)}break;case 27:Nr(a,s),Sr(s),c&512&&(An||o===null||Ca(o,o.return)),o!==null&&c&4&&Nf(s,s.memoizedProps,o.memoizedProps);break;case 5:if(Nr(a,s),Sr(s),c&512&&(An||o===null||Ca(o,o.return)),s.flags&32){m=s.stateNode;try{pn(m,"")}catch(dt){qs(s,s.return,dt)}}c&4&&s.stateNode!=null&&(m=s.memoizedProps,Nf(s,m,o!==null?o.memoizedProps:m)),c&1024&&(Rf=!0);break;case 6:if(Nr(a,s),Sr(s),c&4){if(s.stateNode===null)throw Error(i(162));c=s.memoizedProps,o=s.stateNode;try{o.nodeValue=c}catch(dt){qs(s,s.return,dt)}}break;case 3:if(zd=null,m=da,da=Bd(a.containerInfo),Nr(a,s),da=m,Sr(s),c&4&&o!==null&&o.memoizedState.isDehydrated)try{Il(a.containerInfo)}catch(dt){qs(s,s.return,dt)}Rf&&(Rf=!1,t0(s));break;case 4:c=da,da=Bd(s.stateNode.containerInfo),Nr(a,s),Sr(s),da=c;break;case 12:Nr(a,s),Sr(s);break;case 31:Nr(a,s),Sr(s),c&4&&(c=s.updateQueue,c!==null&&(s.updateQueue=null,Td(s,c)));break;case 13:Nr(a,s),Sr(s),s.child.flags&8192&&s.memoizedState!==null!=(o!==null&&o.memoizedState!==null)&&(Nd=Ut()),c&4&&(c=s.updateQueue,c!==null&&(s.updateQueue=null,Td(s,c)));break;case 22:m=s.memoizedState!==null;var U=o!==null&&o.memoizedState!==null,ie=ei,ke=An;if(ei=ie||m,An=ke||U,Nr(a,s),An=ke,ei=ie,Sr(s),c&8192)e:for(a=s.stateNode,a._visibility=m?a._visibility&-2:a._visibility|1,m&&(o===null||U||ei||An||Io(s)),o=null,a=s;;){if(a.tag===5||a.tag===26){if(o===null){U=o=a;try{if(f=U.stateNode,m)x=f.style,typeof x.setProperty=="function"?x.setProperty("display","none","important"):x.display="none";else{N=U.stateNode;var Ce=U.memoizedProps.style,le=Ce!=null&&Ce.hasOwnProperty("display")?Ce.display:null;N.style.display=le==null||typeof le=="boolean"?"":(""+le).trim()}}catch(dt){qs(U,U.return,dt)}}}else if(a.tag===6){if(o===null){U=a;try{U.stateNode.nodeValue=m?"":U.memoizedProps}catch(dt){qs(U,U.return,dt)}}}else if(a.tag===18){if(o===null){U=a;try{var me=U.stateNode;m?H0(me,!0):H0(U.stateNode,!1)}catch(dt){qs(U,U.return,dt)}}}else if((a.tag!==22&&a.tag!==23||a.memoizedState===null||a===s)&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===s)break e;for(;a.sibling===null;){if(a.return===null||a.return===s)break e;o===a&&(o=null),a=a.return}o===a&&(o=null),a.sibling.return=a.return,a=a.sibling}c&4&&(c=s.updateQueue,c!==null&&(o=c.retryQueue,o!==null&&(c.retryQueue=null,Td(s,o))));break;case 19:Nr(a,s),Sr(s),c&4&&(c=s.updateQueue,c!==null&&(s.updateQueue=null,Td(s,c)));break;case 30:break;case 21:break;default:Nr(a,s),Sr(s)}}function Sr(s){var a=s.flags;if(a&2){try{for(var o,c=s.return;c!==null;){if(Wv(c)){o=c;break}c=c.return}if(o==null)throw Error(i(160));switch(o.tag){case 27:var m=o.stateNode,f=Sf(s);jd(s,f,m);break;case 5:var x=o.stateNode;o.flags&32&&(pn(x,""),o.flags&=-33);var N=Sf(s);jd(s,N,x);break;case 3:case 4:var U=o.stateNode.containerInfo,ie=Sf(s);Cf(s,ie,U);break;default:throw Error(i(161))}}catch(ke){qs(s,s.return,ke)}s.flags&=-3}a&4096&&(s.flags&=-4097)}function t0(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var a=s;t0(a),a.tag===5&&a.flags&1024&&a.stateNode.reset(),s=s.sibling}}function si(s,a){if(a.subtreeFlags&8772)for(a=a.child;a!==null;)Yv(s,a.alternate,a),a=a.sibling}function Io(s){for(s=s.child;s!==null;){var a=s;switch(a.tag){case 0:case 11:case 14:case 15:Ii(4,a,a.return),Io(a);break;case 1:Ca(a,a.return);var o=a.stateNode;typeof o.componentWillUnmount=="function"&&Hv(a,a.return,o),Io(a);break;case 27:Oc(a.stateNode);case 26:case 5:Ca(a,a.return),Io(a);break;case 22:a.memoizedState===null&&Io(a);break;case 30:Io(a);break;default:Io(a)}s=s.sibling}}function ni(s,a,o){for(o=o&&(a.subtreeFlags&8772)!==0,a=a.child;a!==null;){var c=a.alternate,m=s,f=a,x=f.flags;switch(f.tag){case 0:case 11:case 15:ni(m,f,o),Nc(4,f);break;case 1:if(ni(m,f,o),c=f,m=c.stateNode,typeof m.componentDidMount=="function")try{m.componentDidMount()}catch(ie){qs(c,c.return,ie)}if(c=f,m=c.updateQueue,m!==null){var N=c.stateNode;try{var U=m.shared.hiddenCallbacks;if(U!==null)for(m.shared.hiddenCallbacks=null,m=0;m<U.length;m++)Ib(U[m],N)}catch(ie){qs(c,c.return,ie)}}o&&x&64&&qv(f),Sc(f,f.return);break;case 27:Gv(f);case 26:case 5:ni(m,f,o),o&&c===null&&x&4&&$v(f),Sc(f,f.return);break;case 12:ni(m,f,o);break;case 31:ni(m,f,o),o&&x&4&&Jv(m,f);break;case 13:ni(m,f,o),o&&x&4&&Zv(m,f);break;case 22:f.memoizedState===null&&ni(m,f,o),Sc(f,f.return);break;case 30:break;default:ni(m,f,o)}a=a.sibling}}function Af(s,a){var o=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(o=s.memoizedState.cachePool.pool),s=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(s=a.memoizedState.cachePool.pool),s!==o&&(s!=null&&s.refCount++,o!=null&&fc(o))}function If(s,a){s=null,a.alternate!==null&&(s=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==s&&(a.refCount++,s!=null&&fc(s))}function ha(s,a,o,c){if(a.subtreeFlags&10256)for(a=a.child;a!==null;)s0(s,a,o,c),a=a.sibling}function s0(s,a,o,c){var m=a.flags;switch(a.tag){case 0:case 11:case 15:ha(s,a,o,c),m&2048&&Nc(9,a);break;case 1:ha(s,a,o,c);break;case 3:ha(s,a,o,c),m&2048&&(s=null,a.alternate!==null&&(s=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==s&&(a.refCount++,s!=null&&fc(s)));break;case 12:if(m&2048){ha(s,a,o,c),s=a.stateNode;try{var f=a.memoizedProps,x=f.id,N=f.onPostCommit;typeof N=="function"&&N(x,a.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(U){qs(a,a.return,U)}}else ha(s,a,o,c);break;case 31:ha(s,a,o,c);break;case 13:ha(s,a,o,c);break;case 23:break;case 22:f=a.stateNode,x=a.alternate,a.memoizedState!==null?f._visibility&2?ha(s,a,o,c):Cc(s,a):f._visibility&2?ha(s,a,o,c):(f._visibility|=2,wl(s,a,o,c,(a.subtreeFlags&10256)!==0||!1)),m&2048&&Af(x,a);break;case 24:ha(s,a,o,c),m&2048&&If(a.alternate,a);break;default:ha(s,a,o,c)}}function wl(s,a,o,c,m){for(m=m&&((a.subtreeFlags&10256)!==0||!1),a=a.child;a!==null;){var f=s,x=a,N=o,U=c,ie=x.flags;switch(x.tag){case 0:case 11:case 15:wl(f,x,N,U,m),Nc(8,x);break;case 23:break;case 22:var ke=x.stateNode;x.memoizedState!==null?ke._visibility&2?wl(f,x,N,U,m):Cc(f,x):(ke._visibility|=2,wl(f,x,N,U,m)),m&&ie&2048&&Af(x.alternate,x);break;case 24:wl(f,x,N,U,m),m&&ie&2048&&If(x.alternate,x);break;default:wl(f,x,N,U,m)}a=a.sibling}}function Cc(s,a){if(a.subtreeFlags&10256)for(a=a.child;a!==null;){var o=s,c=a,m=c.flags;switch(c.tag){case 22:Cc(o,c),m&2048&&Af(c.alternate,c);break;case 24:Cc(o,c),m&2048&&If(c.alternate,c);break;default:Cc(o,c)}a=a.sibling}}var Rc=8192;function _l(s,a,o){if(s.subtreeFlags&Rc)for(s=s.child;s!==null;)n0(s,a,o),s=s.sibling}function n0(s,a,o){switch(s.tag){case 26:_l(s,a,o),s.flags&Rc&&s.memoizedState!==null&&sT(o,da,s.memoizedState,s.memoizedProps);break;case 5:_l(s,a,o);break;case 3:case 4:var c=da;da=Bd(s.stateNode.containerInfo),_l(s,a,o),da=c;break;case 22:s.memoizedState===null&&(c=s.alternate,c!==null&&c.memoizedState!==null?(c=Rc,Rc=16777216,_l(s,a,o),Rc=c):_l(s,a,o));break;default:_l(s,a,o)}}function r0(s){var a=s.alternate;if(a!==null&&(s=a.child,s!==null)){a.child=null;do a=s.sibling,s.sibling=null,s=a;while(s!==null)}}function Ac(s){var a=s.deletions;if((s.flags&16)!==0){if(a!==null)for(var o=0;o<a.length;o++){var c=a[o];qn=c,i0(c,s)}r0(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)a0(s),s=s.sibling}function a0(s){switch(s.tag){case 0:case 11:case 15:Ac(s),s.flags&2048&&Ii(9,s,s.return);break;case 3:Ac(s);break;case 12:Ac(s);break;case 22:var a=s.stateNode;s.memoizedState!==null&&a._visibility&2&&(s.return===null||s.return.tag!==13)?(a._visibility&=-3,Ed(s)):Ac(s);break;default:Ac(s)}}function Ed(s){var a=s.deletions;if((s.flags&16)!==0){if(a!==null)for(var o=0;o<a.length;o++){var c=a[o];qn=c,i0(c,s)}r0(s)}for(s=s.child;s!==null;){switch(a=s,a.tag){case 0:case 11:case 15:Ii(8,a,a.return),Ed(a);break;case 22:o=a.stateNode,o._visibility&2&&(o._visibility&=-3,Ed(a));break;default:Ed(a)}s=s.sibling}}function i0(s,a){for(;qn!==null;){var o=qn;switch(o.tag){case 0:case 11:case 15:Ii(8,o,a);break;case 23:case 22:if(o.memoizedState!==null&&o.memoizedState.cachePool!==null){var c=o.memoizedState.cachePool.pool;c!=null&&c.refCount++}break;case 24:fc(o.memoizedState.cache)}if(c=o.child,c!==null)c.return=o,qn=c;else e:for(o=s;qn!==null;){c=qn;var m=c.sibling,f=c.return;if(Qv(c),c===o){qn=null;break e}if(m!==null){m.return=f,qn=m;break e}qn=f}}}var yj={getCacheForType:function(s){var a=Qn(Sn),o=a.data.get(s);return o===void 0&&(o=s(),a.data.set(s,o)),o},cacheSignal:function(){return Qn(Sn).controller.signal}},bj=typeof WeakMap=="function"?WeakMap:Map,Vs=0,Xs=null,ls=null,fs=0,Fs=0,Ur=null,Mi=!1,kl=!1,Mf=!1,ri=0,bn=0,Di=0,Mo=0,Df=0,zr=0,jl=0,Ic=null,Cr=null,Pf=!1,Nd=0,o0=0,Sd=1/0,Cd=null,Pi=null,On=0,Li=null,Tl=null,ai=0,Lf=0,Of=null,l0=null,Mc=0,Vf=null;function Fr(){return(Vs&2)!==0&&fs!==0?fs&-fs:$.T!==null?Hf():we()}function c0(){if(zr===0)if((fs&536870912)===0||ws){var s=J;J<<=1,(J&3932160)===0&&(J=262144),zr=s}else zr=536870912;return s=Vr.current,s!==null&&(s.flags|=32),zr}function Rr(s,a,o){(s===Xs&&(Fs===2||Fs===9)||s.cancelPendingCommit!==null)&&(El(s,0),Oi(s,fs,zr,!1)),Rs(s,o),((Vs&2)===0||s!==Xs)&&(s===Xs&&((Vs&2)===0&&(Mo|=o),bn===4&&Oi(s,fs,zr,!1)),Ra(s))}function u0(s,a,o){if((Vs&6)!==0)throw Error(i(327));var c=!o&&(a&127)===0&&(a&s.expiredLanes)===0||jt(s,a),m=c?wj(s,a):Uf(s,a,!0),f=c;do{if(m===0){kl&&!c&&Oi(s,a,0,!1);break}else{if(o=s.current.alternate,f&&!vj(o)){m=Uf(s,a,!1),f=!1;continue}if(m===2){if(f=a,s.errorRecoveryDisabledLanes&f)var x=0;else x=s.pendingLanes&-536870913,x=x!==0?x:x&536870912?536870912:0;if(x!==0){a=x;e:{var N=s;m=Ic;var U=N.current.memoizedState.isDehydrated;if(U&&(El(N,x).flags|=256),x=Uf(N,x,!1),x!==2){if(Mf&&!U){N.errorRecoveryDisabledLanes|=f,Mo|=f,m=4;break e}f=Cr,Cr=m,f!==null&&(Cr===null?Cr=f:Cr.push.apply(Cr,f))}m=x}if(f=!1,m!==2)continue}}if(m===1){El(s,0),Oi(s,a,0,!0);break}e:{switch(c=s,f=m,f){case 0:case 1:throw Error(i(345));case 4:if((a&4194048)!==a)break;case 6:Oi(c,a,zr,!Mi);break e;case 2:Cr=null;break;case 3:case 5:break;default:throw Error(i(329))}if((a&62914560)===a&&(m=Nd+300-Ut(),10<m)){if(Oi(c,a,zr,!Mi),Dt(c,0,!0)!==0)break e;ai=a,c.timeoutHandle=z0(d0.bind(null,c,o,Cr,Cd,Pf,a,zr,Mo,jl,Mi,f,"Throttled",-0,0),m);break e}d0(c,o,Cr,Cd,Pf,a,zr,Mo,jl,Mi,f,null,-0,0)}}break}while(!0);Ra(s)}function d0(s,a,o,c,m,f,x,N,U,ie,ke,Ce,le,me){if(s.timeoutHandle=-1,Ce=a.subtreeFlags,Ce&8192||(Ce&16785408)===16785408){Ce={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:sn},n0(a,f,Ce);var dt=(f&62914560)===f?Nd-Ut():(f&4194048)===f?o0-Ut():0;if(dt=nT(Ce,dt),dt!==null){ai=f,s.cancelPendingCommit=dt(v0.bind(null,s,a,f,o,c,m,x,N,U,ke,Ce,null,le,me)),Oi(s,f,x,!ie);return}}v0(s,a,f,o,c,m,x,N,U)}function vj(s){for(var a=s;;){var o=a.tag;if((o===0||o===11||o===15)&&a.flags&16384&&(o=a.updateQueue,o!==null&&(o=o.stores,o!==null)))for(var c=0;c<o.length;c++){var m=o[c],f=m.getSnapshot;m=m.value;try{if(!Lr(f(),m))return!1}catch{return!1}}if(o=a.child,a.subtreeFlags&16384&&o!==null)o.return=a,a=o;else{if(a===s)break;for(;a.sibling===null;){if(a.return===null||a.return===s)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}}return!0}function Oi(s,a,o,c){a&=~Df,a&=~Mo,s.suspendedLanes|=a,s.pingedLanes&=~a,c&&(s.warmLanes|=a),c=s.expirationTimes;for(var m=a;0<m;){var f=31-He(m),x=1<<f;c[f]=-1,m&=~x}o!==0&&ds(s,o,a)}function Rd(){return(Vs&6)===0?(Dc(0),!1):!0}function Bf(){if(ls!==null){if(Fs===0)var s=ls.return;else s=ls,Ka=jo=null,ef(s),gl=null,gc=0,s=ls;for(;s!==null;)Fv(s.alternate,s),s=s.return;ls=null}}function El(s,a){var o=s.timeoutHandle;o!==-1&&(s.timeoutHandle=-1,Bj(o)),o=s.cancelPendingCommit,o!==null&&(s.cancelPendingCommit=null,o()),ai=0,Bf(),Xs=s,ls=o=Wa(s.current,null),fs=a,Fs=0,Ur=null,Mi=!1,kl=jt(s,a),Mf=!1,jl=zr=Df=Mo=Di=bn=0,Cr=Ic=null,Pf=!1,(a&8)!==0&&(a|=a&32);var c=s.entangledLanes;if(c!==0)for(s=s.entanglements,c&=a;0<c;){var m=31-He(c),f=1<<m;a|=s[m],c&=~f}return ri=a,Xu(),o}function h0(s,a){ts=null,$.H=jc,a===pl||a===ad?(a=Sb(),Fs=3):a===Fm?(a=Sb(),Fs=4):Fs=a===yf?8:a!==null&&typeof a=="object"&&typeof a.then=="function"?6:1,Ur=a,ls===null&&(bn=1,vd(s,Qr(a,s.current)))}function m0(){var s=Vr.current;return s===null?!0:(fs&4194048)===fs?ea===null:(fs&62914560)===fs||(fs&536870912)!==0?s===ea:!1}function f0(){var s=$.H;return $.H=jc,s===null?jc:s}function p0(){var s=$.A;return $.A=yj,s}function Ad(){bn=4,Mi||(fs&4194048)!==fs&&Vr.current!==null||(kl=!0),(Di&134217727)===0&&(Mo&134217727)===0||Xs===null||Oi(Xs,fs,zr,!1)}function Uf(s,a,o){var c=Vs;Vs|=2;var m=f0(),f=p0();(Xs!==s||fs!==a)&&(Cd=null,El(s,a)),a=!1;var x=bn;e:do try{if(Fs!==0&&ls!==null){var N=ls,U=Ur;switch(Fs){case 8:Bf(),x=6;break e;case 3:case 2:case 9:case 6:Vr.current===null&&(a=!0);var ie=Fs;if(Fs=0,Ur=null,Nl(s,N,U,ie),o&&kl){x=0;break e}break;default:ie=Fs,Fs=0,Ur=null,Nl(s,N,U,ie)}}xj(),x=bn;break}catch(ke){h0(s,ke)}while(!0);return a&&s.shellSuspendCounter++,Ka=jo=null,Vs=c,$.H=m,$.A=f,ls===null&&(Xs=null,fs=0,Xu()),x}function xj(){for(;ls!==null;)g0(ls)}function wj(s,a){var o=Vs;Vs|=2;var c=f0(),m=p0();Xs!==s||fs!==a?(Cd=null,Sd=Ut()+500,El(s,a)):kl=jt(s,a);e:do try{if(Fs!==0&&ls!==null){a=ls;var f=Ur;t:switch(Fs){case 1:Fs=0,Ur=null,Nl(s,a,f,1);break;case 2:case 9:if(Eb(f)){Fs=0,Ur=null,y0(a);break}a=function(){Fs!==2&&Fs!==9||Xs!==s||(Fs=7),Ra(s)},f.then(a,a);break e;case 3:Fs=7;break e;case 4:Fs=5;break e;case 7:Eb(f)?(Fs=0,Ur=null,y0(a)):(Fs=0,Ur=null,Nl(s,a,f,7));break;case 5:var x=null;switch(ls.tag){case 26:x=ls.memoizedState;case 5:case 27:var N=ls;if(x?s1(x):N.stateNode.complete){Fs=0,Ur=null;var U=N.sibling;if(U!==null)ls=U;else{var ie=N.return;ie!==null?(ls=ie,Id(ie)):ls=null}break t}}Fs=0,Ur=null,Nl(s,a,f,5);break;case 6:Fs=0,Ur=null,Nl(s,a,f,6);break;case 8:Bf(),bn=6;break e;default:throw Error(i(462))}}_j();break}catch(ke){h0(s,ke)}while(!0);return Ka=jo=null,$.H=c,$.A=m,Vs=o,ls!==null?0:(Xs=null,fs=0,Xu(),bn)}function _j(){for(;ls!==null&&!zs();)g0(ls)}function g0(s){var a=Uv(s.alternate,s,ri);s.memoizedProps=s.pendingProps,a===null?Id(s):ls=a}function y0(s){var a=s,o=a.alternate;switch(a.tag){case 15:case 0:a=Dv(o,a,a.pendingProps,a.type,void 0,fs);break;case 11:a=Dv(o,a,a.pendingProps,a.type.render,a.ref,fs);break;case 5:ef(a);default:Fv(o,a),a=ls=pb(a,ri),a=Uv(o,a,ri)}s.memoizedProps=s.pendingProps,a===null?Id(s):ls=a}function Nl(s,a,o,c){Ka=jo=null,ef(a),gl=null,gc=0;var m=a.return;try{if(uj(s,m,a,o,fs)){bn=1,vd(s,Qr(o,s.current)),ls=null;return}}catch(f){if(m!==null)throw ls=m,f;bn=1,vd(s,Qr(o,s.current)),ls=null;return}a.flags&32768?(ws||c===1?s=!0:kl||(fs&536870912)!==0?s=!1:(Mi=s=!0,(c===2||c===9||c===3||c===6)&&(c=Vr.current,c!==null&&c.tag===13&&(c.flags|=16384))),b0(a,s)):Id(a)}function Id(s){var a=s;do{if((a.flags&32768)!==0){b0(a,Mi);return}s=a.return;var o=mj(a.alternate,a,ri);if(o!==null){ls=o;return}if(a=a.sibling,a!==null){ls=a;return}ls=a=s}while(a!==null);bn===0&&(bn=5)}function b0(s,a){do{var o=fj(s.alternate,s);if(o!==null){o.flags&=32767,ls=o;return}if(o=s.return,o!==null&&(o.flags|=32768,o.subtreeFlags=0,o.deletions=null),!a&&(s=s.sibling,s!==null)){ls=s;return}ls=s=o}while(s!==null);bn=6,ls=null}function v0(s,a,o,c,m,f,x,N,U){s.cancelPendingCommit=null;do Md();while(On!==0);if((Vs&6)!==0)throw Error(i(327));if(a!==null){if(a===s.current)throw Error(i(177));if(f=a.lanes|a.childLanes,f|=Nm,Zs(s,o,f,x,N,U),s===Xs&&(ls=Xs=null,fs=0),Tl=a,Li=s,ai=o,Lf=f,Of=m,l0=c,(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,Ej(is,function(){return j0(),null})):(s.callbackNode=null,s.callbackPriority=0),c=(a.flags&13878)!==0,(a.subtreeFlags&13878)!==0||c){c=$.T,$.T=null,m=pe.p,pe.p=2,x=Vs,Vs|=4;try{pj(s,a,o)}finally{Vs=x,pe.p=m,$.T=c}}On=1,x0(),w0(),_0()}}function x0(){if(On===1){On=0;var s=Li,a=Tl,o=(a.flags&13878)!==0;if((a.subtreeFlags&13878)!==0||o){o=$.T,$.T=null;var c=pe.p;pe.p=2;var m=Vs;Vs|=4;try{e0(a,s);var f=Jf,x=ib(s.containerInfo),N=f.focusedElem,U=f.selectionRange;if(x!==N&&N&&N.ownerDocument&&ab(N.ownerDocument.documentElement,N)){if(U!==null&&_m(N)){var ie=U.start,ke=U.end;if(ke===void 0&&(ke=ie),"selectionStart"in N)N.selectionStart=ie,N.selectionEnd=Math.min(ke,N.value.length);else{var Ce=N.ownerDocument||document,le=Ce&&Ce.defaultView||window;if(le.getSelection){var me=le.getSelection(),dt=N.textContent.length,Pt=Math.min(U.start,dt),Gs=U.end===void 0?Pt:Math.min(U.end,dt);!me.extend&&Pt>Gs&&(x=Gs,Gs=Pt,Pt=x);var Q=rb(N,Pt),W=rb(N,Gs);if(Q&&W&&(me.rangeCount!==1||me.anchorNode!==Q.node||me.anchorOffset!==Q.offset||me.focusNode!==W.node||me.focusOffset!==W.offset)){var ae=Ce.createRange();ae.setStart(Q.node,Q.offset),me.removeAllRanges(),Pt>Gs?(me.addRange(ae),me.extend(W.node,W.offset)):(ae.setEnd(W.node,W.offset),me.addRange(ae))}}}}for(Ce=[],me=N;me=me.parentNode;)me.nodeType===1&&Ce.push({element:me,left:me.scrollLeft,top:me.scrollTop});for(typeof N.focus=="function"&&N.focus(),N=0;N<Ce.length;N++){var Ne=Ce[N];Ne.element.scrollLeft=Ne.left,Ne.element.scrollTop=Ne.top}}$d=!!Xf,Jf=Xf=null}finally{Vs=m,pe.p=c,$.T=o}}s.current=a,On=2}}function w0(){if(On===2){On=0;var s=Li,a=Tl,o=(a.flags&8772)!==0;if((a.subtreeFlags&8772)!==0||o){o=$.T,$.T=null;var c=pe.p;pe.p=2;var m=Vs;Vs|=4;try{Yv(s,a.alternate,a)}finally{Vs=m,pe.p=c,$.T=o}}On=3}}function _0(){if(On===4||On===3){On=0,gt();var s=Li,a=Tl,o=ai,c=l0;(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?On=5:(On=0,Tl=Li=null,k0(s,s.pendingLanes));var m=s.pendingLanes;if(m===0&&(Pi=null),ve(o),a=a.stateNode,Ue&&typeof Ue.onCommitFiberRoot=="function")try{Ue.onCommitFiberRoot(et,a,void 0,(a.current.flags&128)===128)}catch{}if(c!==null){a=$.T,m=pe.p,pe.p=2,$.T=null;try{for(var f=s.onRecoverableError,x=0;x<c.length;x++){var N=c[x];f(N.value,{componentStack:N.stack})}}finally{$.T=a,pe.p=m}}(ai&3)!==0&&Md(),Ra(s),m=s.pendingLanes,(o&261930)!==0&&(m&42)!==0?s===Vf?Mc++:(Mc=0,Vf=s):Mc=0,Dc(0)}}function k0(s,a){(s.pooledCacheLanes&=a)===0&&(a=s.pooledCache,a!=null&&(s.pooledCache=null,fc(a)))}function Md(){return x0(),w0(),_0(),j0()}function j0(){if(On!==5)return!1;var s=Li,a=Lf;Lf=0;var o=ve(ai),c=$.T,m=pe.p;try{pe.p=32>o?32:o,$.T=null,o=Of,Of=null;var f=Li,x=ai;if(On=0,Tl=Li=null,ai=0,(Vs&6)!==0)throw Error(i(331));var N=Vs;if(Vs|=4,a0(f.current),s0(f,f.current,x,o),Vs=N,Dc(0,!1),Ue&&typeof Ue.onPostCommitFiberRoot=="function")try{Ue.onPostCommitFiberRoot(et,f)}catch{}return!0}finally{pe.p=m,$.T=c,k0(s,a)}}function T0(s,a,o){a=Qr(o,a),a=gf(s.stateNode,a,2),s=Ci(s,a,2),s!==null&&(Rs(s,2),Ra(s))}function qs(s,a,o){if(s.tag===3)T0(s,s,o);else for(;a!==null;){if(a.tag===3){T0(a,s,o);break}else if(a.tag===1){var c=a.stateNode;if(typeof a.type.getDerivedStateFromError=="function"||typeof c.componentDidCatch=="function"&&(Pi===null||!Pi.has(c))){s=Qr(o,s),o=Ev(2),c=Ci(a,o,2),c!==null&&(Nv(o,c,a,s),Rs(c,2),Ra(c));break}}a=a.return}}function zf(s,a,o){var c=s.pingCache;if(c===null){c=s.pingCache=new bj;var m=new Set;c.set(a,m)}else m=c.get(a),m===void 0&&(m=new Set,c.set(a,m));m.has(o)||(Mf=!0,m.add(o),s=kj.bind(null,s,a,o),a.then(s,s))}function kj(s,a,o){var c=s.pingCache;c!==null&&c.delete(a),s.pingedLanes|=s.suspendedLanes&o,s.warmLanes&=~o,Xs===s&&(fs&o)===o&&(bn===4||bn===3&&(fs&62914560)===fs&&300>Ut()-Nd?(Vs&2)===0&&El(s,0):Df|=o,jl===fs&&(jl=0)),Ra(s)}function E0(s,a){a===0&&(a=Qt()),s=wo(s,a),s!==null&&(Rs(s,a),Ra(s))}function jj(s){var a=s.memoizedState,o=0;a!==null&&(o=a.retryLane),E0(s,o)}function Tj(s,a){var o=0;switch(s.tag){case 31:case 13:var c=s.stateNode,m=s.memoizedState;m!==null&&(o=m.retryLane);break;case 19:c=s.stateNode;break;case 22:c=s.stateNode._retryCache;break;default:throw Error(i(314))}c!==null&&c.delete(a),E0(s,o)}function Ej(s,a){return Xe(s,a)}var Dd=null,Sl=null,Ff=!1,Pd=!1,qf=!1,Vi=0;function Ra(s){s!==Sl&&s.next===null&&(Sl===null?Dd=Sl=s:Sl=Sl.next=s),Pd=!0,Ff||(Ff=!0,Sj())}function Dc(s,a){if(!qf&&Pd){qf=!0;do for(var o=!1,c=Dd;c!==null;){if(s!==0){var m=c.pendingLanes;if(m===0)var f=0;else{var x=c.suspendedLanes,N=c.pingedLanes;f=(1<<31-He(42|s)+1)-1,f&=m&~(x&~N),f=f&201326741?f&201326741|1:f?f|2:0}f!==0&&(o=!0,R0(c,f))}else f=fs,f=Dt(c,c===Xs?f:0,c.cancelPendingCommit!==null||c.timeoutHandle!==-1),(f&3)===0||jt(c,f)||(o=!0,R0(c,f));c=c.next}while(o);qf=!1}}function Nj(){N0()}function N0(){Pd=Ff=!1;var s=0;Vi!==0&&Vj()&&(s=Vi);for(var a=Ut(),o=null,c=Dd;c!==null;){var m=c.next,f=S0(c,a);f===0?(c.next=null,o===null?Dd=m:o.next=m,m===null&&(Sl=o)):(o=c,(s!==0||(f&3)!==0)&&(Pd=!0)),c=m}On!==0&&On!==5||Dc(s),Vi!==0&&(Vi=0)}function S0(s,a){for(var o=s.suspendedLanes,c=s.pingedLanes,m=s.expirationTimes,f=s.pendingLanes&-62914561;0<f;){var x=31-He(f),N=1<<x,U=m[x];U===-1?((N&o)===0||(N&c)!==0)&&(m[x]=ss(N,a)):U<=a&&(s.expiredLanes|=N),f&=~N}if(a=Xs,o=fs,o=Dt(s,s===a?o:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),c=s.callbackNode,o===0||s===a&&(Fs===2||Fs===9)||s.cancelPendingCommit!==null)return c!==null&&c!==null&&Ct(c),s.callbackNode=null,s.callbackPriority=0;if((o&3)===0||jt(s,o)){if(a=o&-o,a===s.callbackPriority)return a;switch(c!==null&&Ct(c),ve(o)){case 2:case 8:o=Cs;break;case 32:o=is;break;case 268435456:o=ce;break;default:o=is}return c=C0.bind(null,s),o=Xe(o,c),s.callbackPriority=a,s.callbackNode=o,a}return c!==null&&c!==null&&Ct(c),s.callbackPriority=2,s.callbackNode=null,2}function C0(s,a){if(On!==0&&On!==5)return s.callbackNode=null,s.callbackPriority=0,null;var o=s.callbackNode;if(Md()&&s.callbackNode!==o)return null;var c=fs;return c=Dt(s,s===Xs?c:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),c===0?null:(u0(s,c,a),S0(s,Ut()),s.callbackNode!=null&&s.callbackNode===o?C0.bind(null,s):null)}function R0(s,a){if(Md())return null;u0(s,a,!0)}function Sj(){Uj(function(){(Vs&6)!==0?Xe(qt,Nj):N0()})}function Hf(){if(Vi===0){var s=ml;s===0&&(s=Yt,Yt<<=1,(Yt&261888)===0&&(Yt=256)),Vi=s}return Vi}function A0(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:_r(""+s)}function I0(s,a){var o=a.ownerDocument.createElement("input");return o.name=a.name,o.value=a.value,s.id&&o.setAttribute("form",s.id),a.parentNode.insertBefore(o,a),s=new FormData(s),o.parentNode.removeChild(o),s}function Cj(s,a,o,c,m){if(a==="submit"&&o&&o.stateNode===m){var f=A0((m[Rt]||null).action),x=c.submitter;x&&(a=(a=x[Rt]||null)?A0(a.formAction):x.getAttribute("formAction"),a!==null&&(f=a,x=null));var N=new zn("action","action",null,c,m);s.push({event:N,listeners:[{instance:null,listener:function(){if(c.defaultPrevented){if(Vi!==0){var U=x?I0(m,x):new FormData(m);uf(o,{pending:!0,data:U,method:m.method,action:f},null,U)}}else typeof f=="function"&&(N.preventDefault(),U=x?I0(m,x):new FormData(m),uf(o,{pending:!0,data:U,method:m.method,action:f},f,U))},currentTarget:m}]})}}for(var $f=0;$f<Em.length;$f++){var Wf=Em[$f],Rj=Wf.toLowerCase(),Aj=Wf[0].toUpperCase()+Wf.slice(1);ua(Rj,"on"+Aj)}ua(cb,"onAnimationEnd"),ua(ub,"onAnimationIteration"),ua(db,"onAnimationStart"),ua("dblclick","onDoubleClick"),ua("focusin","onFocus"),ua("focusout","onBlur"),ua(Gk,"onTransitionRun"),ua(Kk,"onTransitionStart"),ua(Yk,"onTransitionCancel"),ua(hb,"onTransitionEnd"),Oe("onMouseEnter",["mouseout","mouseover"]),Oe("onMouseLeave",["mouseout","mouseover"]),Oe("onPointerEnter",["pointerout","pointerover"]),Oe("onPointerLeave",["pointerout","pointerover"]),$e("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),$e("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),$e("onBeforeInput",["compositionend","keypress","textInput","paste"]),$e("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),$e("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),$e("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Pc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Ij=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Pc));function M0(s,a){a=(a&4)!==0;for(var o=0;o<s.length;o++){var c=s[o],m=c.event;c=c.listeners;e:{var f=void 0;if(a)for(var x=c.length-1;0<=x;x--){var N=c[x],U=N.instance,ie=N.currentTarget;if(N=N.listener,U!==f&&m.isPropagationStopped())break e;f=N,m.currentTarget=ie;try{f(m)}catch(ke){Qu(ke)}m.currentTarget=null,f=U}else for(x=0;x<c.length;x++){if(N=c[x],U=N.instance,ie=N.currentTarget,N=N.listener,U!==f&&m.isPropagationStopped())break e;f=N,m.currentTarget=ie;try{f(m)}catch(ke){Qu(ke)}m.currentTarget=null,f=U}}}}function cs(s,a){var o=a[bt];o===void 0&&(o=a[bt]=new Set);var c=s+"__bubble";o.has(c)||(D0(a,s,2,!1),o.add(c))}function Gf(s,a,o){var c=0;a&&(c|=4),D0(o,s,c,a)}var Ld="_reactListening"+Math.random().toString(36).slice(2);function Kf(s){if(!s[Ld]){s[Ld]=!0,q.forEach(function(o){o!=="selectionchange"&&(Ij.has(o)||Gf(o,!1,s),Gf(o,!0,s))});var a=s.nodeType===9?s:s.ownerDocument;a===null||a[Ld]||(a[Ld]=!0,Gf("selectionchange",!1,a))}}function D0(s,a,o,c){switch(c1(a)){case 2:var m=iT;break;case 8:m=oT;break;default:m=cp}o=m.bind(null,a,o,s),m=void 0,!ee||a!=="touchstart"&&a!=="touchmove"&&a!=="wheel"||(m=!0),c?m!==void 0?s.addEventListener(a,o,{capture:!0,passive:m}):s.addEventListener(a,o,!0):m!==void 0?s.addEventListener(a,o,{passive:m}):s.addEventListener(a,o,!1)}function Yf(s,a,o,c,m){var f=c;if((a&1)===0&&(a&2)===0&&c!==null)e:for(;;){if(c===null)return;var x=c.tag;if(x===3||x===4){var N=c.stateNode.containerInfo;if(N===m)break;if(x===4)for(x=c.return;x!==null;){var U=x.tag;if((U===3||U===4)&&x.stateNode.containerInfo===m)return;x=x.return}for(;N!==null;){if(x=Ys(N),x===null)return;if(U=x.tag,U===5||U===6||U===26||U===27){c=f=x;continue e}N=N.parentNode}}c=c.return}Ta(function(){var ie=f,ke=Nn(o),Ce=[];e:{var le=mb.get(s);if(le!==void 0){var me=zn,dt=s;switch(s){case"keypress":if(Ft(o)===0)break e;case"keydown":case"keyup":me=Gu;break;case"focusin":dt="focus",me=gn;break;case"focusout":dt="blur",me=gn;break;case"beforeblur":case"afterblur":me=gn;break;case"click":if(o.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":me=nr;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":me=dr;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":me=b;break;case cb:case ub:case db:me=Tr;break;case hb:me=C;break;case"scroll":case"scrollend":me=en;break;case"wheel":me=de;break;case"copy":case"cut":case"paste":me=tl;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":me=$a;break;case"toggle":case"beforetoggle":me=es}var Pt=(a&4)!==0,Gs=!Pt&&(s==="scroll"||s==="scrollend"),Q=Pt?le!==null?le+"Capture":null:le;Pt=[];for(var W=ie,ae;W!==null;){var Ne=W;if(ae=Ne.stateNode,Ne=Ne.tag,Ne!==5&&Ne!==26&&Ne!==27||ae===null||Q===null||(Ne=Pr(W,Q),Ne!=null&&Pt.push(Lc(W,Ne,ae))),Gs)break;W=W.return}0<Pt.length&&(le=new me(le,dt,null,o,ke),Ce.push({event:le,listeners:Pt}))}}if((a&7)===0){e:{if(le=s==="mouseover"||s==="pointerover",me=s==="mouseout"||s==="pointerout",le&&o!==Pn&&(dt=o.relatedTarget||o.fromElement)&&(Ys(dt)||dt[lt]))break e;if((me||le)&&(le=ke.window===ke?ke:(le=ke.ownerDocument)?le.defaultView||le.parentWindow:window,me?(dt=o.relatedTarget||o.toElement,me=ie,dt=dt?Ys(dt):null,dt!==null&&(Gs=u(dt),Pt=dt.tag,dt!==Gs||Pt!==5&&Pt!==27&&Pt!==6)&&(dt=null)):(me=null,dt=ie),me!==dt)){if(Pt=nr,Ne="onMouseLeave",Q="onMouseEnter",W="mouse",(s==="pointerout"||s==="pointerover")&&(Pt=$a,Ne="onPointerLeave",Q="onPointerEnter",W="pointer"),Gs=me==null?le:he(me),ae=dt==null?le:he(dt),le=new Pt(Ne,W+"leave",me,o,ke),le.target=Gs,le.relatedTarget=ae,Ne=null,Ys(ke)===ie&&(Pt=new Pt(Q,W+"enter",dt,o,ke),Pt.target=ae,Pt.relatedTarget=Gs,Ne=Pt),Gs=Ne,me&&dt)t:{for(Pt=Mj,Q=me,W=dt,ae=0,Ne=Q;Ne;Ne=Pt(Ne))ae++;Ne=0;for(var Nt=W;Nt;Nt=Pt(Nt))Ne++;for(;0<ae-Ne;)Q=Pt(Q),ae--;for(;0<Ne-ae;)W=Pt(W),Ne--;for(;ae--;){if(Q===W||W!==null&&Q===W.alternate){Pt=Q;break t}Q=Pt(Q),W=Pt(W)}Pt=null}else Pt=null;me!==null&&P0(Ce,le,me,Pt,!1),dt!==null&&Gs!==null&&P0(Ce,Gs,dt,Pt,!0)}}e:{if(le=ie?he(ie):window,me=le.nodeName&&le.nodeName.toLowerCase(),me==="select"||me==="input"&&le.type==="file")var Ms=Jy;else if(Qy(le))if(Zy)Ms=Hk;else{Ms=Fk;var ht=zk}else me=le.nodeName,!me||me.toLowerCase()!=="input"||le.type!=="checkbox"&&le.type!=="radio"?ie&&dn(ie.elementType)&&(Ms=Jy):Ms=qk;if(Ms&&(Ms=Ms(s,ie))){Xy(Ce,Ms,o,ke);break e}ht&&ht(s,le,ie),s==="focusout"&&ie&&le.type==="number"&&ie.memoizedProps.value!=null&&un(le,"number",le.value)}switch(ht=ie?he(ie):window,s){case"focusin":(Qy(ht)||ht.contentEditable==="true")&&(al=ht,km=ie,dc=null);break;case"focusout":dc=km=al=null;break;case"mousedown":jm=!0;break;case"contextmenu":case"mouseup":case"dragend":jm=!1,ob(Ce,o,ke);break;case"selectionchange":if(Wk)break;case"keydown":case"keyup":ob(Ce,o,ke)}var ns;if(Os)e:{switch(s){case"compositionstart":var ps="onCompositionStart";break e;case"compositionend":ps="onCompositionEnd";break e;case"compositionupdate":ps="onCompositionUpdate";break e}ps=void 0}else rl?bo(s,o)&&(ps="onCompositionEnd"):s==="keydown"&&o.keyCode===229&&(ps="onCompositionStart");ps&&(Ea&&o.locale!=="ko"&&(rl||ps!=="onCompositionStart"?ps==="onCompositionEnd"&&rl&&(ns=ot()):(st=ke,_t="value"in st?st.value:st.textContent,rl=!0)),ht=Od(ie,ps),0<ht.length&&(ps=new mr(ps,s,null,o,ke),Ce.push({event:ps,listeners:ht}),ns?ps.data=ns:(ns=nl(o),ns!==null&&(ps.data=ns)))),(ns=Kr?Ok(s,o):Vk(s,o))&&(ps=Od(ie,"onBeforeInput"),0<ps.length&&(ht=new mr("onBeforeInput","beforeinput",null,o,ke),Ce.push({event:ht,listeners:ps}),ht.data=ns)),Cj(Ce,s,ie,o,ke)}M0(Ce,a)})}function Lc(s,a,o){return{instance:s,listener:a,currentTarget:o}}function Od(s,a){for(var o=a+"Capture",c=[];s!==null;){var m=s,f=m.stateNode;if(m=m.tag,m!==5&&m!==26&&m!==27||f===null||(m=Pr(s,o),m!=null&&c.unshift(Lc(s,m,f)),m=Pr(s,a),m!=null&&c.push(Lc(s,m,f))),s.tag===3)return c;s=s.return}return[]}function Mj(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function P0(s,a,o,c,m){for(var f=a._reactName,x=[];o!==null&&o!==c;){var N=o,U=N.alternate,ie=N.stateNode;if(N=N.tag,U!==null&&U===c)break;N!==5&&N!==26&&N!==27||ie===null||(U=ie,m?(ie=Pr(o,f),ie!=null&&x.unshift(Lc(o,ie,U))):m||(ie=Pr(o,f),ie!=null&&x.push(Lc(o,ie,U)))),o=o.return}x.length!==0&&s.push({event:a,listeners:x})}var Dj=/\r\n?/g,Pj=/\u0000|\uFFFD/g;function L0(s){return(typeof s=="string"?s:""+s).replace(Dj,`
`).replace(Pj,"")}function O0(s,a){return a=L0(a),L0(s)===a}function Ws(s,a,o,c,m,f){switch(o){case"children":typeof c=="string"?a==="body"||a==="textarea"&&c===""||pn(s,c):(typeof c=="number"||typeof c=="bigint")&&a!=="body"&&pn(s,""+c);break;case"className":Hs(s,"class",c);break;case"tabIndex":Hs(s,"tabindex",c);break;case"dir":case"role":case"viewBox":case"width":case"height":Hs(s,o,c);break;case"style":as(s,c,f);break;case"data":if(a!=="object"){Hs(s,"data",c);break}case"src":case"href":if(c===""&&(a!=="a"||o!=="href")){s.removeAttribute(o);break}if(c==null||typeof c=="function"||typeof c=="symbol"||typeof c=="boolean"){s.removeAttribute(o);break}c=_r(""+c),s.setAttribute(o,c);break;case"action":case"formAction":if(typeof c=="function"){s.setAttribute(o,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof f=="function"&&(o==="formAction"?(a!=="input"&&Ws(s,a,"name",m.name,m,null),Ws(s,a,"formEncType",m.formEncType,m,null),Ws(s,a,"formMethod",m.formMethod,m,null),Ws(s,a,"formTarget",m.formTarget,m,null)):(Ws(s,a,"encType",m.encType,m,null),Ws(s,a,"method",m.method,m,null),Ws(s,a,"target",m.target,m,null)));if(c==null||typeof c=="symbol"||typeof c=="boolean"){s.removeAttribute(o);break}c=_r(""+c),s.setAttribute(o,c);break;case"onClick":c!=null&&(s.onclick=sn);break;case"onScroll":c!=null&&cs("scroll",s);break;case"onScrollEnd":c!=null&&cs("scrollend",s);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(i(61));if(o=c.__html,o!=null){if(m.children!=null)throw Error(i(60));s.innerHTML=o}}break;case"multiple":s.multiple=c&&typeof c!="function"&&typeof c!="symbol";break;case"muted":s.muted=c&&typeof c!="function"&&typeof c!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(c==null||typeof c=="function"||typeof c=="boolean"||typeof c=="symbol"){s.removeAttribute("xlink:href");break}o=_r(""+c),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",o);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":c!=null&&typeof c!="function"&&typeof c!="symbol"?s.setAttribute(o,""+c):s.removeAttribute(o);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":c&&typeof c!="function"&&typeof c!="symbol"?s.setAttribute(o,""):s.removeAttribute(o);break;case"capture":case"download":c===!0?s.setAttribute(o,""):c!==!1&&c!=null&&typeof c!="function"&&typeof c!="symbol"?s.setAttribute(o,c):s.removeAttribute(o);break;case"cols":case"rows":case"size":case"span":c!=null&&typeof c!="function"&&typeof c!="symbol"&&!isNaN(c)&&1<=c?s.setAttribute(o,c):s.removeAttribute(o);break;case"rowSpan":case"start":c==null||typeof c=="function"||typeof c=="symbol"||isNaN(c)?s.removeAttribute(o):s.setAttribute(o,c);break;case"popover":cs("beforetoggle",s),cs("toggle",s),an(s,"popover",c);break;case"xlinkActuate":As(s,"http://www.w3.org/1999/xlink","xlink:actuate",c);break;case"xlinkArcrole":As(s,"http://www.w3.org/1999/xlink","xlink:arcrole",c);break;case"xlinkRole":As(s,"http://www.w3.org/1999/xlink","xlink:role",c);break;case"xlinkShow":As(s,"http://www.w3.org/1999/xlink","xlink:show",c);break;case"xlinkTitle":As(s,"http://www.w3.org/1999/xlink","xlink:title",c);break;case"xlinkType":As(s,"http://www.w3.org/1999/xlink","xlink:type",c);break;case"xmlBase":As(s,"http://www.w3.org/XML/1998/namespace","xml:base",c);break;case"xmlLang":As(s,"http://www.w3.org/XML/1998/namespace","xml:lang",c);break;case"xmlSpace":As(s,"http://www.w3.org/XML/1998/namespace","xml:space",c);break;case"is":an(s,"is",c);break;case"innerText":case"textContent":break;default:(!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(o=sr.get(o)||o,an(s,o,c))}}function Qf(s,a,o,c,m,f){switch(o){case"style":as(s,c,f);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(i(61));if(o=c.__html,o!=null){if(m.children!=null)throw Error(i(60));s.innerHTML=o}}break;case"children":typeof c=="string"?pn(s,c):(typeof c=="number"||typeof c=="bigint")&&pn(s,""+c);break;case"onScroll":c!=null&&cs("scroll",s);break;case"onScrollEnd":c!=null&&cs("scrollend",s);break;case"onClick":c!=null&&(s.onclick=sn);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Z.hasOwnProperty(o))e:{if(o[0]==="o"&&o[1]==="n"&&(m=o.endsWith("Capture"),a=o.slice(2,m?o.length-7:void 0),f=s[Rt]||null,f=f!=null?f[o]:null,typeof f=="function"&&s.removeEventListener(a,f,m),typeof c=="function")){typeof f!="function"&&f!==null&&(o in s?s[o]=null:s.hasAttribute(o)&&s.removeAttribute(o)),s.addEventListener(a,c,m);break e}o in s?s[o]=c:c===!0?s.setAttribute(o,""):an(s,o,c)}}}function Jn(s,a,o){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":cs("error",s),cs("load",s);var c=!1,m=!1,f;for(f in o)if(o.hasOwnProperty(f)){var x=o[f];if(x!=null)switch(f){case"src":c=!0;break;case"srcSet":m=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,a));default:Ws(s,a,f,x,o,null)}}m&&Ws(s,a,"srcSet",o.srcSet,o,null),c&&Ws(s,a,"src",o.src,o,null);return;case"input":cs("invalid",s);var N=f=x=m=null,U=null,ie=null;for(c in o)if(o.hasOwnProperty(c)){var ke=o[c];if(ke!=null)switch(c){case"name":m=ke;break;case"type":x=ke;break;case"checked":U=ke;break;case"defaultChecked":ie=ke;break;case"value":f=ke;break;case"defaultValue":N=ke;break;case"children":case"dangerouslySetInnerHTML":if(ke!=null)throw Error(i(137,a));break;default:Ws(s,a,c,ke,o,null)}}vs(s,f,N,U,ie,x,m,!1);return;case"select":cs("invalid",s),c=x=f=null;for(m in o)if(o.hasOwnProperty(m)&&(N=o[m],N!=null))switch(m){case"value":f=N;break;case"defaultValue":x=N;break;case"multiple":c=N;default:Ws(s,a,m,N,o,null)}a=f,o=x,s.multiple=!!c,a!=null?ms(s,!!c,a,!1):o!=null&&ms(s,!!c,o,!0);return;case"textarea":cs("invalid",s),f=m=c=null;for(x in o)if(o.hasOwnProperty(x)&&(N=o[x],N!=null))switch(x){case"value":c=N;break;case"defaultValue":m=N;break;case"children":f=N;break;case"dangerouslySetInnerHTML":if(N!=null)throw Error(i(91));break;default:Ws(s,a,x,N,o,null)}Gr(s,c,m,f);return;case"option":for(U in o)o.hasOwnProperty(U)&&(c=o[U],c!=null)&&(U==="selected"?s.selected=c&&typeof c!="function"&&typeof c!="symbol":Ws(s,a,U,c,o,null));return;case"dialog":cs("beforetoggle",s),cs("toggle",s),cs("cancel",s),cs("close",s);break;case"iframe":case"object":cs("load",s);break;case"video":case"audio":for(c=0;c<Pc.length;c++)cs(Pc[c],s);break;case"image":cs("error",s),cs("load",s);break;case"details":cs("toggle",s);break;case"embed":case"source":case"link":cs("error",s),cs("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ie in o)if(o.hasOwnProperty(ie)&&(c=o[ie],c!=null))switch(ie){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,a));default:Ws(s,a,ie,c,o,null)}return;default:if(dn(a)){for(ke in o)o.hasOwnProperty(ke)&&(c=o[ke],c!==void 0&&Qf(s,a,ke,c,o,void 0));return}}for(N in o)o.hasOwnProperty(N)&&(c=o[N],c!=null&&Ws(s,a,N,c,o,null))}function Lj(s,a,o,c){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var m=null,f=null,x=null,N=null,U=null,ie=null,ke=null;for(me in o){var Ce=o[me];if(o.hasOwnProperty(me)&&Ce!=null)switch(me){case"checked":break;case"value":break;case"defaultValue":U=Ce;default:c.hasOwnProperty(me)||Ws(s,a,me,null,c,Ce)}}for(var le in c){var me=c[le];if(Ce=o[le],c.hasOwnProperty(le)&&(me!=null||Ce!=null))switch(le){case"type":f=me;break;case"name":m=me;break;case"checked":ie=me;break;case"defaultChecked":ke=me;break;case"value":x=me;break;case"defaultValue":N=me;break;case"children":case"dangerouslySetInnerHTML":if(me!=null)throw Error(i(137,a));break;default:me!==Ce&&Ws(s,a,le,me,c,Ce)}}Lt(s,x,N,U,ie,ke,f,m);return;case"select":me=x=N=le=null;for(f in o)if(U=o[f],o.hasOwnProperty(f)&&U!=null)switch(f){case"value":break;case"multiple":me=U;default:c.hasOwnProperty(f)||Ws(s,a,f,null,c,U)}for(m in c)if(f=c[m],U=o[m],c.hasOwnProperty(m)&&(f!=null||U!=null))switch(m){case"value":le=f;break;case"defaultValue":N=f;break;case"multiple":x=f;default:f!==U&&Ws(s,a,m,f,c,U)}a=N,o=x,c=me,le!=null?ms(s,!!o,le,!1):!!c!=!!o&&(a!=null?ms(s,!!o,a,!0):ms(s,!!o,o?[]:"",!1));return;case"textarea":me=le=null;for(N in o)if(m=o[N],o.hasOwnProperty(N)&&m!=null&&!c.hasOwnProperty(N))switch(N){case"value":break;case"children":break;default:Ws(s,a,N,null,c,m)}for(x in c)if(m=c[x],f=o[x],c.hasOwnProperty(x)&&(m!=null||f!=null))switch(x){case"value":le=m;break;case"defaultValue":me=m;break;case"children":break;case"dangerouslySetInnerHTML":if(m!=null)throw Error(i(91));break;default:m!==f&&Ws(s,a,x,m,c,f)}Wn(s,le,me);return;case"option":for(var dt in o)le=o[dt],o.hasOwnProperty(dt)&&le!=null&&!c.hasOwnProperty(dt)&&(dt==="selected"?s.selected=!1:Ws(s,a,dt,null,c,le));for(U in c)le=c[U],me=o[U],c.hasOwnProperty(U)&&le!==me&&(le!=null||me!=null)&&(U==="selected"?s.selected=le&&typeof le!="function"&&typeof le!="symbol":Ws(s,a,U,le,c,me));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Pt in o)le=o[Pt],o.hasOwnProperty(Pt)&&le!=null&&!c.hasOwnProperty(Pt)&&Ws(s,a,Pt,null,c,le);for(ie in c)if(le=c[ie],me=o[ie],c.hasOwnProperty(ie)&&le!==me&&(le!=null||me!=null))switch(ie){case"children":case"dangerouslySetInnerHTML":if(le!=null)throw Error(i(137,a));break;default:Ws(s,a,ie,le,c,me)}return;default:if(dn(a)){for(var Gs in o)le=o[Gs],o.hasOwnProperty(Gs)&&le!==void 0&&!c.hasOwnProperty(Gs)&&Qf(s,a,Gs,void 0,c,le);for(ke in c)le=c[ke],me=o[ke],!c.hasOwnProperty(ke)||le===me||le===void 0&&me===void 0||Qf(s,a,ke,le,c,me);return}}for(var Q in o)le=o[Q],o.hasOwnProperty(Q)&&le!=null&&!c.hasOwnProperty(Q)&&Ws(s,a,Q,null,c,le);for(Ce in c)le=c[Ce],me=o[Ce],!c.hasOwnProperty(Ce)||le===me||le==null&&me==null||Ws(s,a,Ce,le,c,me)}function V0(s){switch(s){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function Oj(){if(typeof performance.getEntriesByType=="function"){for(var s=0,a=0,o=performance.getEntriesByType("resource"),c=0;c<o.length;c++){var m=o[c],f=m.transferSize,x=m.initiatorType,N=m.duration;if(f&&N&&V0(x)){for(x=0,N=m.responseEnd,c+=1;c<o.length;c++){var U=o[c],ie=U.startTime;if(ie>N)break;var ke=U.transferSize,Ce=U.initiatorType;ke&&V0(Ce)&&(U=U.responseEnd,x+=ke*(U<N?1:(N-ie)/(U-ie)))}if(--c,a+=8*(f+x)/(m.duration/1e3),s++,10<s)break}}if(0<s)return a/s/1e6}return navigator.connection&&(s=navigator.connection.downlink,typeof s=="number")?s:5}var Xf=null,Jf=null;function Vd(s){return s.nodeType===9?s:s.ownerDocument}function B0(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function U0(s,a){if(s===0)switch(a){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&a==="foreignObject"?0:s}function Zf(s,a){return s==="textarea"||s==="noscript"||typeof a.children=="string"||typeof a.children=="number"||typeof a.children=="bigint"||typeof a.dangerouslySetInnerHTML=="object"&&a.dangerouslySetInnerHTML!==null&&a.dangerouslySetInnerHTML.__html!=null}var ep=null;function Vj(){var s=window.event;return s&&s.type==="popstate"?s===ep?!1:(ep=s,!0):(ep=null,!1)}var z0=typeof setTimeout=="function"?setTimeout:void 0,Bj=typeof clearTimeout=="function"?clearTimeout:void 0,F0=typeof Promise=="function"?Promise:void 0,Uj=typeof queueMicrotask=="function"?queueMicrotask:typeof F0<"u"?function(s){return F0.resolve(null).then(s).catch(zj)}:z0;function zj(s){setTimeout(function(){throw s})}function Bi(s){return s==="head"}function q0(s,a){var o=a,c=0;do{var m=o.nextSibling;if(s.removeChild(o),m&&m.nodeType===8)if(o=m.data,o==="/$"||o==="/&"){if(c===0){s.removeChild(m),Il(a);return}c--}else if(o==="$"||o==="$?"||o==="$~"||o==="$!"||o==="&")c++;else if(o==="html")Oc(s.ownerDocument.documentElement);else if(o==="head"){o=s.ownerDocument.head,Oc(o);for(var f=o.firstChild;f;){var x=f.nextSibling,N=f.nodeName;f[fn]||N==="SCRIPT"||N==="STYLE"||N==="LINK"&&f.rel.toLowerCase()==="stylesheet"||o.removeChild(f),f=x}}else o==="body"&&Oc(s.ownerDocument.body);o=m}while(o);Il(a)}function H0(s,a){var o=s;s=0;do{var c=o.nextSibling;if(o.nodeType===1?a?(o._stashedDisplay=o.style.display,o.style.display="none"):(o.style.display=o._stashedDisplay||"",o.getAttribute("style")===""&&o.removeAttribute("style")):o.nodeType===3&&(a?(o._stashedText=o.nodeValue,o.nodeValue=""):o.nodeValue=o._stashedText||""),c&&c.nodeType===8)if(o=c.data,o==="/$"){if(s===0)break;s--}else o!=="$"&&o!=="$?"&&o!=="$~"&&o!=="$!"||s++;o=c}while(o)}function tp(s){var a=s.firstChild;for(a&&a.nodeType===10&&(a=a.nextSibling);a;){var o=a;switch(a=a.nextSibling,o.nodeName){case"HTML":case"HEAD":case"BODY":tp(o),_n(o);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(o.rel.toLowerCase()==="stylesheet")continue}s.removeChild(o)}}function Fj(s,a,o,c){for(;s.nodeType===1;){var m=o;if(s.nodeName.toLowerCase()!==a.toLowerCase()){if(!c&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(c){if(!s[fn])switch(a){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(f=s.getAttribute("rel"),f==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(f!==m.rel||s.getAttribute("href")!==(m.href==null||m.href===""?null:m.href)||s.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin)||s.getAttribute("title")!==(m.title==null?null:m.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(f=s.getAttribute("src"),(f!==(m.src==null?null:m.src)||s.getAttribute("type")!==(m.type==null?null:m.type)||s.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin))&&f&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(a==="input"&&s.type==="hidden"){var f=m.name==null?null:""+m.name;if(m.type==="hidden"&&s.getAttribute("name")===f)return s}else return s;if(s=ta(s.nextSibling),s===null)break}return null}function qj(s,a,o){if(a==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!o||(s=ta(s.nextSibling),s===null))return null;return s}function $0(s,a){for(;s.nodeType!==8;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!a||(s=ta(s.nextSibling),s===null))return null;return s}function sp(s){return s.data==="$?"||s.data==="$~"}function np(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState!=="loading"}function Hj(s,a){var o=s.ownerDocument;if(s.data==="$~")s._reactRetry=a;else if(s.data!=="$?"||o.readyState!=="loading")a();else{var c=function(){a(),o.removeEventListener("DOMContentLoaded",c)};o.addEventListener("DOMContentLoaded",c),s._reactRetry=c}}function ta(s){for(;s!=null;s=s.nextSibling){var a=s.nodeType;if(a===1||a===3)break;if(a===8){if(a=s.data,a==="$"||a==="$!"||a==="$?"||a==="$~"||a==="&"||a==="F!"||a==="F")break;if(a==="/$"||a==="/&")return null}}return s}var rp=null;function W0(s){s=s.nextSibling;for(var a=0;s;){if(s.nodeType===8){var o=s.data;if(o==="/$"||o==="/&"){if(a===0)return ta(s.nextSibling);a--}else o!=="$"&&o!=="$!"&&o!=="$?"&&o!=="$~"&&o!=="&"||a++}s=s.nextSibling}return null}function G0(s){s=s.previousSibling;for(var a=0;s;){if(s.nodeType===8){var o=s.data;if(o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"){if(a===0)return s;a--}else o!=="/$"&&o!=="/&"||a++}s=s.previousSibling}return null}function K0(s,a,o){switch(a=Vd(o),s){case"html":if(s=a.documentElement,!s)throw Error(i(452));return s;case"head":if(s=a.head,!s)throw Error(i(453));return s;case"body":if(s=a.body,!s)throw Error(i(454));return s;default:throw Error(i(451))}}function Oc(s){for(var a=s.attributes;a.length;)s.removeAttributeNode(a[0]);_n(s)}var sa=new Map,Y0=new Set;function Bd(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var ii=pe.d;pe.d={f:$j,r:Wj,D:Gj,C:Kj,L:Yj,m:Qj,X:Jj,S:Xj,M:Zj};function $j(){var s=ii.f(),a=Rd();return s||a}function Wj(s){var a=G(s);a!==null&&a.tag===5&&a.type==="form"?hv(a):ii.r(s)}var Cl=typeof document>"u"?null:document;function Q0(s,a,o){var c=Cl;if(c&&typeof a=="string"&&a){var m=xt(a);m='link[rel="'+s+'"][href="'+m+'"]',typeof o=="string"&&(m+='[crossorigin="'+o+'"]'),Y0.has(m)||(Y0.add(m),s={rel:s,crossOrigin:o,href:a},c.querySelector(m)===null&&(a=c.createElement("link"),Jn(a,"link",s),S(a),c.head.appendChild(a)))}}function Gj(s){ii.D(s),Q0("dns-prefetch",s,null)}function Kj(s,a){ii.C(s,a),Q0("preconnect",s,a)}function Yj(s,a,o){ii.L(s,a,o);var c=Cl;if(c&&s&&a){var m='link[rel="preload"][as="'+xt(a)+'"]';a==="image"&&o&&o.imageSrcSet?(m+='[imagesrcset="'+xt(o.imageSrcSet)+'"]',typeof o.imageSizes=="string"&&(m+='[imagesizes="'+xt(o.imageSizes)+'"]')):m+='[href="'+xt(s)+'"]';var f=m;switch(a){case"style":f=Rl(s);break;case"script":f=Al(s)}sa.has(f)||(s=k({rel:"preload",href:a==="image"&&o&&o.imageSrcSet?void 0:s,as:a},o),sa.set(f,s),c.querySelector(m)!==null||a==="style"&&c.querySelector(Vc(f))||a==="script"&&c.querySelector(Bc(f))||(a=c.createElement("link"),Jn(a,"link",s),S(a),c.head.appendChild(a)))}}function Qj(s,a){ii.m(s,a);var o=Cl;if(o&&s){var c=a&&typeof a.as=="string"?a.as:"script",m='link[rel="modulepreload"][as="'+xt(c)+'"][href="'+xt(s)+'"]',f=m;switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":f=Al(s)}if(!sa.has(f)&&(s=k({rel:"modulepreload",href:s},a),sa.set(f,s),o.querySelector(m)===null)){switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(o.querySelector(Bc(f)))return}c=o.createElement("link"),Jn(c,"link",s),S(c),o.head.appendChild(c)}}}function Xj(s,a,o){ii.S(s,a,o);var c=Cl;if(c&&s){var m=E(c).hoistableStyles,f=Rl(s);a=a||"default";var x=m.get(f);if(!x){var N={loading:0,preload:null};if(x=c.querySelector(Vc(f)))N.loading=5;else{s=k({rel:"stylesheet",href:s,"data-precedence":a},o),(o=sa.get(f))&&ap(s,o);var U=x=c.createElement("link");S(U),Jn(U,"link",s),U._p=new Promise(function(ie,ke){U.onload=ie,U.onerror=ke}),U.addEventListener("load",function(){N.loading|=1}),U.addEventListener("error",function(){N.loading|=2}),N.loading|=4,Ud(x,a,c)}x={type:"stylesheet",instance:x,count:1,state:N},m.set(f,x)}}}function Jj(s,a){ii.X(s,a);var o=Cl;if(o&&s){var c=E(o).hoistableScripts,m=Al(s),f=c.get(m);f||(f=o.querySelector(Bc(m)),f||(s=k({src:s,async:!0},a),(a=sa.get(m))&&ip(s,a),f=o.createElement("script"),S(f),Jn(f,"link",s),o.head.appendChild(f)),f={type:"script",instance:f,count:1,state:null},c.set(m,f))}}function Zj(s,a){ii.M(s,a);var o=Cl;if(o&&s){var c=E(o).hoistableScripts,m=Al(s),f=c.get(m);f||(f=o.querySelector(Bc(m)),f||(s=k({src:s,async:!0,type:"module"},a),(a=sa.get(m))&&ip(s,a),f=o.createElement("script"),S(f),Jn(f,"link",s),o.head.appendChild(f)),f={type:"script",instance:f,count:1,state:null},c.set(m,f))}}function X0(s,a,o,c){var m=(m=qe.current)?Bd(m):null;if(!m)throw Error(i(446));switch(s){case"meta":case"title":return null;case"style":return typeof o.precedence=="string"&&typeof o.href=="string"?(a=Rl(o.href),o=E(m).hoistableStyles,c=o.get(a),c||(c={type:"style",instance:null,count:0,state:null},o.set(a,c)),c):{type:"void",instance:null,count:0,state:null};case"link":if(o.rel==="stylesheet"&&typeof o.href=="string"&&typeof o.precedence=="string"){s=Rl(o.href);var f=E(m).hoistableStyles,x=f.get(s);if(x||(m=m.ownerDocument||m,x={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},f.set(s,x),(f=m.querySelector(Vc(s)))&&!f._p&&(x.instance=f,x.state.loading=5),sa.has(s)||(o={rel:"preload",as:"style",href:o.href,crossOrigin:o.crossOrigin,integrity:o.integrity,media:o.media,hrefLang:o.hrefLang,referrerPolicy:o.referrerPolicy},sa.set(s,o),f||eT(m,s,o,x.state))),a&&c===null)throw Error(i(528,""));return x}if(a&&c!==null)throw Error(i(529,""));return null;case"script":return a=o.async,o=o.src,typeof o=="string"&&a&&typeof a!="function"&&typeof a!="symbol"?(a=Al(o),o=E(m).hoistableScripts,c=o.get(a),c||(c={type:"script",instance:null,count:0,state:null},o.set(a,c)),c):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,s))}}function Rl(s){return'href="'+xt(s)+'"'}function Vc(s){return'link[rel="stylesheet"]['+s+"]"}function J0(s){return k({},s,{"data-precedence":s.precedence,precedence:null})}function eT(s,a,o,c){s.querySelector('link[rel="preload"][as="style"]['+a+"]")?c.loading=1:(a=s.createElement("link"),c.preload=a,a.addEventListener("load",function(){return c.loading|=1}),a.addEventListener("error",function(){return c.loading|=2}),Jn(a,"link",o),S(a),s.head.appendChild(a))}function Al(s){return'[src="'+xt(s)+'"]'}function Bc(s){return"script[async]"+s}function Z0(s,a,o){if(a.count++,a.instance===null)switch(a.type){case"style":var c=s.querySelector('style[data-href~="'+xt(o.href)+'"]');if(c)return a.instance=c,S(c),c;var m=k({},o,{"data-href":o.href,"data-precedence":o.precedence,href:null,precedence:null});return c=(s.ownerDocument||s).createElement("style"),S(c),Jn(c,"style",m),Ud(c,o.precedence,s),a.instance=c;case"stylesheet":m=Rl(o.href);var f=s.querySelector(Vc(m));if(f)return a.state.loading|=4,a.instance=f,S(f),f;c=J0(o),(m=sa.get(m))&&ap(c,m),f=(s.ownerDocument||s).createElement("link"),S(f);var x=f;return x._p=new Promise(function(N,U){x.onload=N,x.onerror=U}),Jn(f,"link",c),a.state.loading|=4,Ud(f,o.precedence,s),a.instance=f;case"script":return f=Al(o.src),(m=s.querySelector(Bc(f)))?(a.instance=m,S(m),m):(c=o,(m=sa.get(f))&&(c=k({},o),ip(c,m)),s=s.ownerDocument||s,m=s.createElement("script"),S(m),Jn(m,"link",c),s.head.appendChild(m),a.instance=m);case"void":return null;default:throw Error(i(443,a.type))}else a.type==="stylesheet"&&(a.state.loading&4)===0&&(c=a.instance,a.state.loading|=4,Ud(c,o.precedence,s));return a.instance}function Ud(s,a,o){for(var c=o.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),m=c.length?c[c.length-1]:null,f=m,x=0;x<c.length;x++){var N=c[x];if(N.dataset.precedence===a)f=N;else if(f!==m)break}f?f.parentNode.insertBefore(s,f.nextSibling):(a=o.nodeType===9?o.head:o,a.insertBefore(s,a.firstChild))}function ap(s,a){s.crossOrigin==null&&(s.crossOrigin=a.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=a.referrerPolicy),s.title==null&&(s.title=a.title)}function ip(s,a){s.crossOrigin==null&&(s.crossOrigin=a.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=a.referrerPolicy),s.integrity==null&&(s.integrity=a.integrity)}var zd=null;function e1(s,a,o){if(zd===null){var c=new Map,m=zd=new Map;m.set(o,c)}else m=zd,c=m.get(o),c||(c=new Map,m.set(o,c));if(c.has(s))return c;for(c.set(s,null),o=o.getElementsByTagName(s),m=0;m<o.length;m++){var f=o[m];if(!(f[fn]||f[at]||s==="link"&&f.getAttribute("rel")==="stylesheet")&&f.namespaceURI!=="http://www.w3.org/2000/svg"){var x=f.getAttribute(a)||"";x=s+x;var N=c.get(x);N?N.push(f):c.set(x,[f])}}return c}function t1(s,a,o){s=s.ownerDocument||s,s.head.insertBefore(o,a==="title"?s.querySelector("head > title"):null)}function tT(s,a,o){if(o===1||a.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof a.precedence!="string"||typeof a.href!="string"||a.href==="")break;return!0;case"link":if(typeof a.rel!="string"||typeof a.href!="string"||a.href===""||a.onLoad||a.onError)break;return a.rel==="stylesheet"?(s=a.disabled,typeof a.precedence=="string"&&s==null):!0;case"script":if(a.async&&typeof a.async!="function"&&typeof a.async!="symbol"&&!a.onLoad&&!a.onError&&a.src&&typeof a.src=="string")return!0}return!1}function s1(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}function sT(s,a,o,c){if(o.type==="stylesheet"&&(typeof c.media!="string"||matchMedia(c.media).matches!==!1)&&(o.state.loading&4)===0){if(o.instance===null){var m=Rl(c.href),f=a.querySelector(Vc(m));if(f){a=f._p,a!==null&&typeof a=="object"&&typeof a.then=="function"&&(s.count++,s=Fd.bind(s),a.then(s,s)),o.state.loading|=4,o.instance=f,S(f);return}f=a.ownerDocument||a,c=J0(c),(m=sa.get(m))&&ap(c,m),f=f.createElement("link"),S(f);var x=f;x._p=new Promise(function(N,U){x.onload=N,x.onerror=U}),Jn(f,"link",c),o.instance=f}s.stylesheets===null&&(s.stylesheets=new Map),s.stylesheets.set(o,a),(a=o.state.preload)&&(o.state.loading&3)===0&&(s.count++,o=Fd.bind(s),a.addEventListener("load",o),a.addEventListener("error",o))}}var op=0;function nT(s,a){return s.stylesheets&&s.count===0&&Hd(s,s.stylesheets),0<s.count||0<s.imgCount?function(o){var c=setTimeout(function(){if(s.stylesheets&&Hd(s,s.stylesheets),s.unsuspend){var f=s.unsuspend;s.unsuspend=null,f()}},6e4+a);0<s.imgBytes&&op===0&&(op=62500*Oj());var m=setTimeout(function(){if(s.waitingForImages=!1,s.count===0&&(s.stylesheets&&Hd(s,s.stylesheets),s.unsuspend)){var f=s.unsuspend;s.unsuspend=null,f()}},(s.imgBytes>op?50:800)+a);return s.unsuspend=o,function(){s.unsuspend=null,clearTimeout(c),clearTimeout(m)}}:null}function Fd(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Hd(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var qd=null;function Hd(s,a){s.stylesheets=null,s.unsuspend!==null&&(s.count++,qd=new Map,a.forEach(rT,s),qd=null,Fd.call(s))}function rT(s,a){if(!(a.state.loading&4)){var o=qd.get(s);if(o)var c=o.get(null);else{o=new Map,qd.set(s,o);for(var m=s.querySelectorAll("link[data-precedence],style[data-precedence]"),f=0;f<m.length;f++){var x=m[f];(x.nodeName==="LINK"||x.getAttribute("media")!=="not all")&&(o.set(x.dataset.precedence,x),c=x)}c&&o.set(null,c)}m=a.instance,x=m.getAttribute("data-precedence"),f=o.get(x)||c,f===c&&o.set(null,m),o.set(x,m),this.count++,c=Fd.bind(this),m.addEventListener("load",c),m.addEventListener("error",c),f?f.parentNode.insertBefore(m,f.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(m,s.firstChild)),a.state.loading|=4}}var Uc={$$typeof:oe,Provider:null,Consumer:null,_currentValue:Me,_currentValue2:Me,_threadCount:0};function aT(s,a,o,c,m,f,x,N,U){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=zt(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=zt(0),this.hiddenUpdates=zt(null),this.identifierPrefix=c,this.onUncaughtError=m,this.onCaughtError=f,this.onRecoverableError=x,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=U,this.incompleteTransitions=new Map}function n1(s,a,o,c,m,f,x,N,U,ie,ke,Ce){return s=new aT(s,a,o,x,U,ie,ke,Ce,N),a=1,f===!0&&(a|=24),f=Or(3,null,null,a),s.current=f,f.stateNode=s,a=Bm(),a.refCount++,s.pooledCache=a,a.refCount++,f.memoizedState={element:c,isDehydrated:o,cache:a},qm(f),s}function r1(s){return s?(s=ll,s):ll}function a1(s,a,o,c,m,f){m=r1(m),c.context===null?c.context=m:c.pendingContext=m,c=Si(a),c.payload={element:o},f=f===void 0?null:f,f!==null&&(c.callback=f),o=Ci(s,c,a),o!==null&&(Rr(o,s,a),bc(o,s,a))}function i1(s,a){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var o=s.retryLane;s.retryLane=o!==0&&o<a?o:a}}function lp(s,a){i1(s,a),(s=s.alternate)&&i1(s,a)}function o1(s){if(s.tag===13||s.tag===31){var a=wo(s,67108864);a!==null&&Rr(a,s,67108864),lp(s,67108864)}}function l1(s){if(s.tag===13||s.tag===31){var a=Fr();a=F(a);var o=wo(s,a);o!==null&&Rr(o,s,a),lp(s,a)}}var $d=!0;function iT(s,a,o,c){var m=$.T;$.T=null;var f=pe.p;try{pe.p=2,cp(s,a,o,c)}finally{pe.p=f,$.T=m}}function oT(s,a,o,c){var m=$.T;$.T=null;var f=pe.p;try{pe.p=8,cp(s,a,o,c)}finally{pe.p=f,$.T=m}}function cp(s,a,o,c){if($d){var m=up(c);if(m===null)Yf(s,a,c,Wd,o),u1(s,c);else if(cT(m,s,a,o,c))c.stopPropagation();else if(u1(s,c),a&4&&-1<lT.indexOf(s)){for(;m!==null;){var f=G(m);if(f!==null)switch(f.tag){case 3:if(f=f.stateNode,f.current.memoizedState.isDehydrated){var x=it(f.pendingLanes);if(x!==0){var N=f;for(N.pendingLanes|=2,N.entangledLanes|=2;x;){var U=1<<31-He(x);N.entanglements[1]|=U,x&=~U}Ra(f),(Vs&6)===0&&(Sd=Ut()+500,Dc(0))}}break;case 31:case 13:N=wo(f,2),N!==null&&Rr(N,f,2),Rd(),lp(f,2)}if(f=up(c),f===null&&Yf(s,a,c,Wd,o),f===m)break;m=f}m!==null&&c.stopPropagation()}else Yf(s,a,c,null,o)}}function up(s){return s=Nn(s),dp(s)}var Wd=null;function dp(s){if(Wd=null,s=Ys(s),s!==null){var a=u(s);if(a===null)s=null;else{var o=a.tag;if(o===13){if(s=d(a),s!==null)return s;s=null}else if(o===31){if(s=p(a),s!==null)return s;s=null}else if(o===3){if(a.stateNode.current.memoizedState.isDehydrated)return a.tag===3?a.stateNode.containerInfo:null;s=null}else a!==s&&(s=null)}}return Wd=s,null}function c1(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Bs()){case qt:return 2;case Cs:return 8;case is:case Ts:return 32;case ce:return 268435456;default:return 32}default:return 32}}var hp=!1,Ui=null,zi=null,Fi=null,zc=new Map,Fc=new Map,qi=[],lT="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function u1(s,a){switch(s){case"focusin":case"focusout":Ui=null;break;case"dragenter":case"dragleave":zi=null;break;case"mouseover":case"mouseout":Fi=null;break;case"pointerover":case"pointerout":zc.delete(a.pointerId);break;case"gotpointercapture":case"lostpointercapture":Fc.delete(a.pointerId)}}function qc(s,a,o,c,m,f){return s===null||s.nativeEvent!==f?(s={blockedOn:a,domEventName:o,eventSystemFlags:c,nativeEvent:f,targetContainers:[m]},a!==null&&(a=G(a),a!==null&&o1(a)),s):(s.eventSystemFlags|=c,a=s.targetContainers,m!==null&&a.indexOf(m)===-1&&a.push(m),s)}function cT(s,a,o,c,m){switch(a){case"focusin":return Ui=qc(Ui,s,a,o,c,m),!0;case"dragenter":return zi=qc(zi,s,a,o,c,m),!0;case"mouseover":return Fi=qc(Fi,s,a,o,c,m),!0;case"pointerover":var f=m.pointerId;return zc.set(f,qc(zc.get(f)||null,s,a,o,c,m)),!0;case"gotpointercapture":return f=m.pointerId,Fc.set(f,qc(Fc.get(f)||null,s,a,o,c,m)),!0}return!1}function d1(s){var a=Ys(s.target);if(a!==null){var o=u(a);if(o!==null){if(a=o.tag,a===13){if(a=d(o),a!==null){s.blockedOn=a,_e(s.priority,function(){l1(o)});return}}else if(a===31){if(a=p(o),a!==null){s.blockedOn=a,_e(s.priority,function(){l1(o)});return}}else if(a===3&&o.stateNode.current.memoizedState.isDehydrated){s.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}s.blockedOn=null}function Gd(s){if(s.blockedOn!==null)return!1;for(var a=s.targetContainers;0<a.length;){var o=up(s.nativeEvent);if(o===null){o=s.nativeEvent;var c=new o.constructor(o.type,o);Pn=c,o.target.dispatchEvent(c),Pn=null}else return a=G(o),a!==null&&o1(a),s.blockedOn=o,!1;a.shift()}return!0}function h1(s,a,o){Gd(s)&&o.delete(a)}function uT(){hp=!1,Ui!==null&&Gd(Ui)&&(Ui=null),zi!==null&&Gd(zi)&&(zi=null),Fi!==null&&Gd(Fi)&&(Fi=null),zc.forEach(h1),Fc.forEach(h1)}function Kd(s,a){s.blockedOn===a&&(s.blockedOn=null,hp||(hp=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,uT)))}var Yd=null;function m1(s){Yd!==s&&(Yd=s,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){Yd===s&&(Yd=null);for(var a=0;a<s.length;a+=3){var o=s[a],c=s[a+1],m=s[a+2];if(typeof c!="function"){if(dp(c||o)===null)continue;break}var f=G(o);f!==null&&(s.splice(a,3),a-=3,uf(f,{pending:!0,data:m,method:o.method,action:c},c,m))}}))}function Il(s){function a(U){return Kd(U,s)}Ui!==null&&Kd(Ui,s),zi!==null&&Kd(zi,s),Fi!==null&&Kd(Fi,s),zc.forEach(a),Fc.forEach(a);for(var o=0;o<qi.length;o++){var c=qi[o];c.blockedOn===s&&(c.blockedOn=null)}for(;0<qi.length&&(o=qi[0],o.blockedOn===null);)d1(o),o.blockedOn===null&&qi.shift();if(o=(s.ownerDocument||s).$$reactFormReplay,o!=null)for(c=0;c<o.length;c+=3){var m=o[c],f=o[c+1],x=m[Rt]||null;if(typeof f=="function")x||m1(o);else if(x){var N=null;if(f&&f.hasAttribute("formAction")){if(m=f,x=f[Rt]||null)N=x.formAction;else if(dp(m)!==null)continue}else N=x.action;typeof N=="function"?o[c+1]=N:(o.splice(c,3),c-=3),m1(o)}}}function f1(){function s(f){f.canIntercept&&f.info==="react-transition"&&f.intercept({handler:function(){return new Promise(function(x){return m=x})},focusReset:"manual",scroll:"manual"})}function a(){m!==null&&(m(),m=null),c||setTimeout(o,20)}function o(){if(!c&&!navigation.transition){var f=navigation.currentEntry;f&&f.url!=null&&navigation.navigate(f.url,{state:f.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var c=!1,m=null;return navigation.addEventListener("navigate",s),navigation.addEventListener("navigatesuccess",a),navigation.addEventListener("navigateerror",a),setTimeout(o,100),function(){c=!0,navigation.removeEventListener("navigate",s),navigation.removeEventListener("navigatesuccess",a),navigation.removeEventListener("navigateerror",a),m!==null&&(m(),m=null)}}}function mp(s){this._internalRoot=s}Qd.prototype.render=mp.prototype.render=function(s){var a=this._internalRoot;if(a===null)throw Error(i(409));var o=a.current,c=Fr();a1(o,c,s,a,null,null)},Qd.prototype.unmount=mp.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var a=s.containerInfo;a1(s.current,2,null,s,null,null),Rd(),a[lt]=null}};function Qd(s){this._internalRoot=s}Qd.prototype.unstable_scheduleHydration=function(s){if(s){var a=we();s={blockedOn:null,target:s,priority:a};for(var o=0;o<qi.length&&a!==0&&a<qi[o].priority;o++);qi.splice(o,0,s),o===0&&d1(s)}};var p1=e.version;if(p1!=="19.2.4")throw Error(i(527,p1,"19.2.4"));pe.findDOMNode=function(s){var a=s._reactInternals;if(a===void 0)throw typeof s.render=="function"?Error(i(188)):(s=Object.keys(s).join(","),Error(i(268,s)));return s=y(a),s=s!==null?w(s):null,s=s===null?null:s.stateNode,s};var dT={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:$,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Xd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Xd.isDisabled&&Xd.supportsFiber)try{et=Xd.inject(dT),Ue=Xd}catch{}}return $c.createRoot=function(s,a){if(!l(s))throw Error(i(299));var o=!1,c="",m=_v,f=kv,x=jv;return a!=null&&(a.unstable_strictMode===!0&&(o=!0),a.identifierPrefix!==void 0&&(c=a.identifierPrefix),a.onUncaughtError!==void 0&&(m=a.onUncaughtError),a.onCaughtError!==void 0&&(f=a.onCaughtError),a.onRecoverableError!==void 0&&(x=a.onRecoverableError)),a=n1(s,1,!1,null,null,o,c,null,m,f,x,f1),s[lt]=a.current,Kf(s),new mp(a)},$c.hydrateRoot=function(s,a,o){if(!l(s))throw Error(i(299));var c=!1,m="",f=_v,x=kv,N=jv,U=null;return o!=null&&(o.unstable_strictMode===!0&&(c=!0),o.identifierPrefix!==void 0&&(m=o.identifierPrefix),o.onUncaughtError!==void 0&&(f=o.onUncaughtError),o.onCaughtError!==void 0&&(x=o.onCaughtError),o.onRecoverableError!==void 0&&(N=o.onRecoverableError),o.formState!==void 0&&(U=o.formState)),a=n1(s,1,!0,a,o??null,c,m,U,f,x,N,f1),a.context=r1(null),o=a.current,c=Fr(),c=F(c),m=Si(c),m.callback=null,Ci(o,m,c),o=c,a.current.lanes=o,Rs(a,o),Ra(a),s[lt]=a.current,Kf(s),new Qd(a)},$c.version="19.2.4",$c}var T1;function wT(){if(T1)return gp.exports;T1=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),gp.exports=xT(),gp.exports}var _T=wT();const kT="modulepreload",jT=function(n){return"/login/"+n},E1={},wr=function(e,t,i){let l=Promise.resolve();if(t&&t.length>0){let g=function(y){return Promise.all(y.map(w=>Promise.resolve(w).then(k=>({status:"fulfilled",value:k}),k=>({status:"rejected",reason:k}))))};document.getElementsByTagName("link");const d=document.querySelector("meta[property=csp-nonce]"),p=d?.nonce||d?.getAttribute("nonce");l=g(t.map(y=>{if(y=jT(y),y in E1)return;E1[y]=!0;const w=y.endsWith(".css"),k=w?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${y}"]${k}`))return;const j=document.createElement("link");if(j.rel=w?"stylesheet":kT,w||(j.as="script"),j.crossOrigin="",j.href=y,p&&j.setAttribute("nonce",p),document.head.appendChild(j),w)return new Promise((O,H)=>{j.addEventListener("load",O),j.addEventListener("error",()=>H(new Error(`Unable to preload CSS for ${y}`)))})}))}function u(d){const p=new Event("vite:preloadError",{cancelable:!0});if(p.payload=d,window.dispatchEvent(p),!p.defaultPrevented)throw d}return l.then(d=>{for(const p of d||[])p.status==="rejected"&&u(p.reason);return e().catch(u)})};var N1="popstate";function TT(n={}){function e(i,l){let{pathname:u,search:d,hash:p}=i.location;return eg("",{pathname:u,search:d,hash:p},l.state&&l.state.usr||null,l.state&&l.state.key||"default")}function t(i,l){return typeof l=="string"?l:mu(l)}return NT(e,t,null,n)}function cn(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function ra(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function ET(){return Math.random().toString(36).substring(2,10)}function S1(n,e){return{usr:n.state,key:n.key,idx:e}}function eg(n,e,t=null,i){return{pathname:typeof n=="string"?n:n.pathname,search:"",hash:"",...typeof e=="string"?Zl(e):e,state:t,key:e&&e.key||i||ET()}}function mu({pathname:n="/",search:e="",hash:t=""}){return e&&e!=="?"&&(n+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(n+=t.charAt(0)==="#"?t:"#"+t),n}function Zl(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substring(t),n=n.substring(0,t));let i=n.indexOf("?");i>=0&&(e.search=n.substring(i),n=n.substring(0,i)),n&&(e.pathname=n)}return e}function NT(n,e,t,i={}){let{window:l=document.defaultView,v5Compat:u=!1}=i,d=l.history,p="POP",g=null,y=w();y==null&&(y=0,d.replaceState({...d.state,idx:y},""));function w(){return(d.state||{idx:null}).idx}function k(){p="POP";let V=w(),se=V==null?null:V-y;y=V,g&&g({action:p,location:B.location,delta:se})}function j(V,se){p="PUSH";let K=eg(B.location,V,se);y=w()+1;let oe=S1(K,y),ye=B.createHref(K);try{d.pushState(oe,"",ye)}catch(Pe){if(Pe instanceof DOMException&&Pe.name==="DataCloneError")throw Pe;l.location.assign(ye)}u&&g&&g({action:p,location:B.location,delta:1})}function O(V,se){p="REPLACE";let K=eg(B.location,V,se);y=w();let oe=S1(K,y),ye=B.createHref(K);d.replaceState(oe,"",ye),u&&g&&g({action:p,location:B.location,delta:0})}function H(V){return ST(V)}let B={get action(){return p},get location(){return n(l,d)},listen(V){if(g)throw new Error("A history only accepts one active listener");return l.addEventListener(N1,k),g=V,()=>{l.removeEventListener(N1,k),g=null}},createHref(V){return e(l,V)},createURL:H,encodeLocation(V){let se=H(V);return{pathname:se.pathname,search:se.search,hash:se.hash}},push:j,replace:O,go(V){return d.go(V)}};return B}function ST(n,e=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),cn(t,"No window.location.(origin|href) available to create URL");let i=typeof n=="string"?n:mu(n);return i=i.replace(/ $/,"%20"),!e&&i.startsWith("//")&&(i=t+i),new URL(i,t)}function N2(n,e,t="/"){return CT(n,e,t,!1)}function CT(n,e,t,i){let l=typeof e=="string"?Zl(e):e,u=mi(l.pathname||"/",t);if(u==null)return null;let d=S2(n);RT(d);let p=null;for(let g=0;p==null&&g<d.length;++g){let y=zT(u);p=BT(d[g],y,i)}return p}function S2(n,e=[],t=[],i="",l=!1){let u=(d,p,g=l,y)=>{let w={relativePath:y===void 0?d.path||"":y,caseSensitive:d.caseSensitive===!0,childrenIndex:p,route:d};if(w.relativePath.startsWith("/")){if(!w.relativePath.startsWith(i)&&g)return;cn(w.relativePath.startsWith(i),`Absolute route path "${w.relativePath}" nested under path "${i}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),w.relativePath=w.relativePath.slice(i.length)}let k=ci([i,w.relativePath]),j=t.concat(w);d.children&&d.children.length>0&&(cn(d.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${k}".`),S2(d.children,e,j,k,g)),!(d.path==null&&!d.index)&&e.push({path:k,score:OT(k,d.index),routesMeta:j})};return n.forEach((d,p)=>{if(d.path===""||!d.path?.includes("?"))u(d,p);else for(let g of C2(d.path))u(d,p,!0,g)}),e}function C2(n){let e=n.split("/");if(e.length===0)return[];let[t,...i]=e,l=t.endsWith("?"),u=t.replace(/\?$/,"");if(i.length===0)return l?[u,""]:[u];let d=C2(i.join("/")),p=[];return p.push(...d.map(g=>g===""?u:[u,g].join("/"))),l&&p.push(...d),p.map(g=>n.startsWith("/")&&g===""?"/":g)}function RT(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:VT(e.routesMeta.map(i=>i.childrenIndex),t.routesMeta.map(i=>i.childrenIndex)))}var AT=/^:[\w-]+$/,IT=3,MT=2,DT=1,PT=10,LT=-2,C1=n=>n==="*";function OT(n,e){let t=n.split("/"),i=t.length;return t.some(C1)&&(i+=LT),e&&(i+=MT),t.filter(l=>!C1(l)).reduce((l,u)=>l+(AT.test(u)?IT:u===""?DT:PT),i)}function VT(n,e){return n.length===e.length&&n.slice(0,-1).every((i,l)=>i===e[l])?n[n.length-1]-e[e.length-1]:0}function BT(n,e,t=!1){let{routesMeta:i}=n,l={},u="/",d=[];for(let p=0;p<i.length;++p){let g=i[p],y=p===i.length-1,w=u==="/"?e:e.slice(u.length)||"/",k=jh({path:g.relativePath,caseSensitive:g.caseSensitive,end:y},w),j=g.route;if(!k&&y&&t&&!i[i.length-1].route.index&&(k=jh({path:g.relativePath,caseSensitive:g.caseSensitive,end:!1},w)),!k)return null;Object.assign(l,k.params),d.push({params:l,pathname:ci([u,k.pathname]),pathnameBase:$T(ci([u,k.pathnameBase])),route:j}),k.pathnameBase!=="/"&&(u=ci([u,k.pathnameBase]))}return d}function jh(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,i]=UT(n.path,n.caseSensitive,n.end),l=e.match(t);if(!l)return null;let u=l[0],d=u.replace(/(.)\/+$/,"$1"),p=l.slice(1);return{params:i.reduce((y,{paramName:w,isOptional:k},j)=>{if(w==="*"){let H=p[j]||"";d=u.slice(0,u.length-H.length).replace(/(.)\/+$/,"$1")}const O=p[j];return k&&!O?y[w]=void 0:y[w]=(O||"").replace(/%2F/g,"/"),y},{}),pathname:u,pathnameBase:d,pattern:n}}function UT(n,e=!1,t=!0){ra(n==="*"||!n.endsWith("*")||n.endsWith("/*"),`Route path "${n}" will be treated as if it were "${n.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${n.replace(/\*$/,"/*")}".`);let i=[],l="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(d,p,g)=>(i.push({paramName:p,isOptional:g!=null}),g?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return n.endsWith("*")?(i.push({paramName:"*"}),l+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?l+="\\/*$":n!==""&&n!=="/"&&(l+="(?:(?=\\/|$))"),[new RegExp(l,e?void 0:"i"),i]}function zT(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return ra(!1,`The URL path "${n}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),n}}function mi(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,i=n.charAt(t);return i&&i!=="/"?null:n.slice(t)||"/"}var FT=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i;function qT(n,e="/"){let{pathname:t,search:i="",hash:l=""}=typeof n=="string"?Zl(n):n,u;return t?(t=t.replace(/\/\/+/g,"/"),t.startsWith("/")?u=R1(t.substring(1),"/"):u=R1(t,e)):u=e,{pathname:u,search:WT(i),hash:GT(l)}}function R1(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(l=>{l===".."?t.length>1&&t.pop():l!=="."&&t.push(l)}),t.length>1?t.join("/"):"/"}function xp(n,e,t,i){return`Cannot include a '${n}' character in a manually specified \`to.${e}\` field [${JSON.stringify(i)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function HT(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function Ag(n){let e=HT(n);return e.map((t,i)=>i===e.length-1?t.pathname:t.pathnameBase)}function Ig(n,e,t,i=!1){let l;typeof n=="string"?l=Zl(n):(l={...n},cn(!l.pathname||!l.pathname.includes("?"),xp("?","pathname","search",l)),cn(!l.pathname||!l.pathname.includes("#"),xp("#","pathname","hash",l)),cn(!l.search||!l.search.includes("#"),xp("#","search","hash",l)));let u=n===""||l.pathname==="",d=u?"/":l.pathname,p;if(d==null)p=t;else{let k=e.length-1;if(!i&&d.startsWith("..")){let j=d.split("/");for(;j[0]==="..";)j.shift(),k-=1;l.pathname=j.join("/")}p=k>=0?e[k]:"/"}let g=qT(l,p),y=d&&d!=="/"&&d.endsWith("/"),w=(u||d===".")&&t.endsWith("/");return!g.pathname.endsWith("/")&&(y||w)&&(g.pathname+="/"),g}var ci=n=>n.join("/").replace(/\/\/+/g,"/"),$T=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),WT=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,GT=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n,KT=class{constructor(n,e,t,i=!1){this.status=n,this.statusText=e||"",this.internal=i,t instanceof Error?(this.data=t.toString(),this.error=t):this.data=t}};function YT(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}function QT(n){return n.map(e=>e.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var R2=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function A2(n,e){let t=n;if(typeof t!="string"||!FT.test(t))return{absoluteURL:void 0,isExternal:!1,to:t};let i=t,l=!1;if(R2)try{let u=new URL(window.location.href),d=t.startsWith("//")?new URL(u.protocol+t):new URL(t),p=mi(d.pathname,e);d.origin===u.origin&&p!=null?t=p+d.search+d.hash:l=!0}catch{ra(!1,`<Link to="${t}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:i,isExternal:l,to:t}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var I2=["POST","PUT","PATCH","DELETE"];new Set(I2);var XT=["GET",...I2];new Set(XT);var ec=v.createContext(null);ec.displayName="DataRouter";var Gh=v.createContext(null);Gh.displayName="DataRouterState";var JT=v.createContext(!1),M2=v.createContext({isTransitioning:!1});M2.displayName="ViewTransition";var ZT=v.createContext(new Map);ZT.displayName="Fetchers";var eE=v.createContext(null);eE.displayName="Await";var Wr=v.createContext(null);Wr.displayName="Navigation";var Eu=v.createContext(null);Eu.displayName="Location";var wa=v.createContext({outlet:null,matches:[],isDataRoute:!1});wa.displayName="Route";var Mg=v.createContext(null);Mg.displayName="RouteError";var D2="REACT_ROUTER_ERROR",tE="REDIRECT",sE="ROUTE_ERROR_RESPONSE";function nE(n){if(n.startsWith(`${D2}:${tE}:{`))try{let e=JSON.parse(n.slice(28));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.location=="string"&&typeof e.reloadDocument=="boolean"&&typeof e.replace=="boolean")return e}catch{}}function rE(n){if(n.startsWith(`${D2}:${sE}:{`))try{let e=JSON.parse(n.slice(40));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string")return new KT(e.status,e.statusText,e.data)}catch{}}function aE(n,{relative:e}={}){cn(tc(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:i}=v.useContext(Wr),{hash:l,pathname:u,search:d}=Nu(n,{relative:e}),p=u;return t!=="/"&&(p=u==="/"?t:ci([t,u])),i.createHref({pathname:p,search:d,hash:l})}function tc(){return v.useContext(Eu)!=null}function _a(){return cn(tc(),"useLocation() may be used only in the context of a <Router> component."),v.useContext(Eu).location}var P2="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function L2(n){v.useContext(Wr).static||v.useLayoutEffect(n)}function $n(){let{isDataRoute:n}=v.useContext(wa);return n?vE():iE()}function iE(){cn(tc(),"useNavigate() may be used only in the context of a <Router> component.");let n=v.useContext(ec),{basename:e,navigator:t}=v.useContext(Wr),{matches:i}=v.useContext(wa),{pathname:l}=_a(),u=JSON.stringify(Ag(i)),d=v.useRef(!1);return L2(()=>{d.current=!0}),v.useCallback((g,y={})=>{if(ra(d.current,P2),!d.current)return;if(typeof g=="number"){t.go(g);return}let w=Ig(g,JSON.parse(u),l,y.relative==="path");n==null&&e!=="/"&&(w.pathname=w.pathname==="/"?e:ci([e,w.pathname])),(y.replace?t.replace:t.push)(w,y.state,y)},[e,t,u,l,n])}v.createContext(null);function oE(){let{matches:n}=v.useContext(wa),e=n[n.length-1];return e?e.params:{}}function Nu(n,{relative:e}={}){let{matches:t}=v.useContext(wa),{pathname:i}=_a(),l=JSON.stringify(Ag(t));return v.useMemo(()=>Ig(n,JSON.parse(l),i,e==="path"),[n,l,i,e])}function lE(n,e){return O2(n,e)}function O2(n,e,t,i,l){cn(tc(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:u}=v.useContext(Wr),{matches:d}=v.useContext(wa),p=d[d.length-1],g=p?p.params:{},y=p?p.pathname:"/",w=p?p.pathnameBase:"/",k=p&&p.route;{let K=k&&k.path||"";B2(y,!k||K.endsWith("*")||K.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${y}" (under <Route path="${K}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${K}"> to <Route path="${K==="/"?"*":`${K}/*`}">.`)}let j=_a(),O;if(e){let K=typeof e=="string"?Zl(e):e;cn(w==="/"||K.pathname?.startsWith(w),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${w}" but pathname "${K.pathname}" was given in the \`location\` prop.`),O=K}else O=j;let H=O.pathname||"/",B=H;if(w!=="/"){let K=w.replace(/^\//,"").split("/");B="/"+H.replace(/^\//,"").split("/").slice(K.length).join("/")}let V=N2(n,{pathname:B});ra(k||V!=null,`No routes matched location "${O.pathname}${O.search}${O.hash}" `),ra(V==null||V[V.length-1].route.element!==void 0||V[V.length-1].route.Component!==void 0||V[V.length-1].route.lazy!==void 0,`Matched leaf route at location "${O.pathname}${O.search}${O.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let se=mE(V&&V.map(K=>Object.assign({},K,{params:Object.assign({},g,K.params),pathname:ci([w,u.encodeLocation?u.encodeLocation(K.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:K.pathname]),pathnameBase:K.pathnameBase==="/"?w:ci([w,u.encodeLocation?u.encodeLocation(K.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:K.pathnameBase])})),d,t,i,l);return e&&se?v.createElement(Eu.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...O},navigationType:"POP"}},se):se}function cE(){let n=bE(),e=YT(n)?`${n.status} ${n.statusText}`:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,i="rgba(200,200,200, 0.5)",l={padding:"0.5rem",backgroundColor:i},u={padding:"2px 4px",backgroundColor:i},d=null;return console.error("Error handled by React Router default ErrorBoundary:",n),d=v.createElement(v.Fragment,null,v.createElement("p",null," Hey developer "),v.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",v.createElement("code",{style:u},"ErrorBoundary")," or"," ",v.createElement("code",{style:u},"errorElement")," prop on your route.")),v.createElement(v.Fragment,null,v.createElement("h2",null,"Unexpected Application Error!"),v.createElement("h3",{style:{fontStyle:"italic"}},e),t?v.createElement("pre",{style:l},t):null,d)}var uE=v.createElement(cE,null),V2=class extends v.Component{constructor(n){super(n),this.state={location:n.location,revalidation:n.revalidation,error:n.error}}static getDerivedStateFromError(n){return{error:n}}static getDerivedStateFromProps(n,e){return e.location!==n.location||e.revalidation!=="idle"&&n.revalidation==="idle"?{error:n.error,location:n.location,revalidation:n.revalidation}:{error:n.error!==void 0?n.error:e.error,location:e.location,revalidation:n.revalidation||e.revalidation}}componentDidCatch(n,e){this.props.onError?this.props.onError(n,e):console.error("React Router caught the following error during render",n)}render(){let n=this.state.error;if(this.context&&typeof n=="object"&&n&&"digest"in n&&typeof n.digest=="string"){const t=rE(n.digest);t&&(n=t)}let e=n!==void 0?v.createElement(wa.Provider,{value:this.props.routeContext},v.createElement(Mg.Provider,{value:n,children:this.props.component})):this.props.children;return this.context?v.createElement(dE,{error:n},e):e}};V2.contextType=JT;var wp=new WeakMap;function dE({children:n,error:e}){let{basename:t}=v.useContext(Wr);if(typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){let i=nE(e.digest);if(i){let l=wp.get(e);if(l)throw l;let u=A2(i.location,t);if(R2&&!wp.get(e))if(u.isExternal||i.reloadDocument)window.location.href=u.absoluteURL||u.to;else{const d=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(u.to,{replace:i.replace}));throw wp.set(e,d),d}return v.createElement("meta",{httpEquiv:"refresh",content:`0;url=${u.absoluteURL||u.to}`})}}return n}function hE({routeContext:n,match:e,children:t}){let i=v.useContext(ec);return i&&i.static&&i.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=e.route.id),v.createElement(wa.Provider,{value:n},t)}function mE(n,e=[],t=null,i=null,l=null){if(n==null){if(!t)return null;if(t.errors)n=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let u=n,d=t?.errors;if(d!=null){let w=u.findIndex(k=>k.route.id&&d?.[k.route.id]!==void 0);cn(w>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(d).join(",")}`),u=u.slice(0,Math.min(u.length,w+1))}let p=!1,g=-1;if(t)for(let w=0;w<u.length;w++){let k=u[w];if((k.route.HydrateFallback||k.route.hydrateFallbackElement)&&(g=w),k.route.id){let{loaderData:j,errors:O}=t,H=k.route.loader&&!j.hasOwnProperty(k.route.id)&&(!O||O[k.route.id]===void 0);if(k.route.lazy||H){p=!0,g>=0?u=u.slice(0,g+1):u=[u[0]];break}}}let y=t&&i?(w,k)=>{i(w,{location:t.location,params:t.matches?.[0]?.params??{},unstable_pattern:QT(t.matches),errorInfo:k})}:void 0;return u.reduceRight((w,k,j)=>{let O,H=!1,B=null,V=null;t&&(O=d&&k.route.id?d[k.route.id]:void 0,B=k.route.errorElement||uE,p&&(g<0&&j===0?(B2("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),H=!0,V=null):g===j&&(H=!0,V=k.route.hydrateFallbackElement||null)));let se=e.concat(u.slice(0,j+1)),K=()=>{let oe;return O?oe=B:H?oe=V:k.route.Component?oe=v.createElement(k.route.Component,null):k.route.element?oe=k.route.element:oe=w,v.createElement(hE,{match:k,routeContext:{outlet:w,matches:se,isDataRoute:t!=null},children:oe})};return t&&(k.route.ErrorBoundary||k.route.errorElement||j===0)?v.createElement(V2,{location:t.location,revalidation:t.revalidation,component:B,error:O,children:K(),routeContext:{outlet:null,matches:se,isDataRoute:!0},onError:y}):K()},null)}function Dg(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function fE(n){let e=v.useContext(ec);return cn(e,Dg(n)),e}function pE(n){let e=v.useContext(Gh);return cn(e,Dg(n)),e}function gE(n){let e=v.useContext(wa);return cn(e,Dg(n)),e}function Pg(n){let e=gE(n),t=e.matches[e.matches.length-1];return cn(t.route.id,`${n} can only be used on routes that contain a unique "id"`),t.route.id}function yE(){return Pg("useRouteId")}function bE(){let n=v.useContext(Mg),e=pE("useRouteError"),t=Pg("useRouteError");return n!==void 0?n:e.errors?.[t]}function vE(){let{router:n}=fE("useNavigate"),e=Pg("useNavigate"),t=v.useRef(!1);return L2(()=>{t.current=!0}),v.useCallback(async(l,u={})=>{ra(t.current,P2),t.current&&(typeof l=="number"?await n.navigate(l):await n.navigate(l,{fromRouteId:e,...u}))},[n,e])}var A1={};function B2(n,e,t){!e&&!A1[n]&&(A1[n]=!0,ra(!1,t))}v.memo(xE);function xE({routes:n,future:e,state:t,onError:i}){return O2(n,void 0,t,i,e)}function wE({to:n,replace:e,state:t,relative:i}){cn(tc(),"<Navigate> may be used only in the context of a <Router> component.");let{static:l}=v.useContext(Wr);ra(!l,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:u}=v.useContext(wa),{pathname:d}=_a(),p=$n(),g=Ig(n,Ag(u),d,i==="path"),y=JSON.stringify(g);return v.useEffect(()=>{p(JSON.parse(y),{replace:e,state:t,relative:i})},[p,y,i,e,t]),null}function Js(n){cn(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function _E({basename:n="/",children:e=null,location:t,navigationType:i="POP",navigator:l,static:u=!1,unstable_useTransitions:d}){cn(!tc(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let p=n.replace(/^\/*/,"/"),g=v.useMemo(()=>({basename:p,navigator:l,static:u,unstable_useTransitions:d,future:{}}),[p,l,u,d]);typeof t=="string"&&(t=Zl(t));let{pathname:y="/",search:w="",hash:k="",state:j=null,key:O="default"}=t,H=v.useMemo(()=>{let B=mi(y,p);return B==null?null:{location:{pathname:B,search:w,hash:k,state:j,key:O},navigationType:i}},[p,y,w,k,j,O,i]);return ra(H!=null,`<Router basename="${p}"> is not able to match the URL "${y}${w}${k}" because it does not start with the basename, so the <Router> won't render anything.`),H==null?null:v.createElement(Wr.Provider,{value:g},v.createElement(Eu.Provider,{children:e,value:H}))}function kE({children:n,location:e}){return lE(tg(n),e)}function tg(n,e=[]){let t=[];return v.Children.forEach(n,(i,l)=>{if(!v.isValidElement(i))return;let u=[...e,l];if(i.type===v.Fragment){t.push.apply(t,tg(i.props.children,u));return}cn(i.type===Js,`[${typeof i.type=="string"?i.type:i.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),cn(!i.props.index||!i.props.children,"An index route cannot have child routes.");let d={id:i.props.id||u.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,middleware:i.props.middleware,loader:i.props.loader,action:i.props.action,hydrateFallbackElement:i.props.hydrateFallbackElement,HydrateFallback:i.props.HydrateFallback,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.hasErrorBoundary===!0||i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(d.children=tg(i.props.children,u)),t.push(d)}),t}var hh="get",mh="application/x-www-form-urlencoded";function Kh(n){return typeof HTMLElement<"u"&&n instanceof HTMLElement}function jE(n){return Kh(n)&&n.tagName.toLowerCase()==="button"}function TE(n){return Kh(n)&&n.tagName.toLowerCase()==="form"}function EE(n){return Kh(n)&&n.tagName.toLowerCase()==="input"}function NE(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function SE(n,e){return n.button===0&&(!e||e==="_self")&&!NE(n)}function sg(n=""){return new URLSearchParams(typeof n=="string"||Array.isArray(n)||n instanceof URLSearchParams?n:Object.keys(n).reduce((e,t)=>{let i=n[t];return e.concat(Array.isArray(i)?i.map(l=>[t,l]):[[t,i]])},[]))}function CE(n,e){let t=sg(n);return e&&e.forEach((i,l)=>{t.has(l)||e.getAll(l).forEach(u=>{t.append(l,u)})}),t}var Jd=null;function RE(){if(Jd===null)try{new FormData(document.createElement("form"),0),Jd=!1}catch{Jd=!0}return Jd}var AE=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function _p(n){return n!=null&&!AE.has(n)?(ra(!1,`"${n}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${mh}"`),null):n}function IE(n,e){let t,i,l,u,d;if(TE(n)){let p=n.getAttribute("action");i=p?mi(p,e):null,t=n.getAttribute("method")||hh,l=_p(n.getAttribute("enctype"))||mh,u=new FormData(n)}else if(jE(n)||EE(n)&&(n.type==="submit"||n.type==="image")){let p=n.form;if(p==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let g=n.getAttribute("formaction")||p.getAttribute("action");if(i=g?mi(g,e):null,t=n.getAttribute("formmethod")||p.getAttribute("method")||hh,l=_p(n.getAttribute("formenctype"))||_p(p.getAttribute("enctype"))||mh,u=new FormData(p,n),!RE()){let{name:y,type:w,value:k}=n;if(w==="image"){let j=y?`${y}.`:"";u.append(`${j}x`,"0"),u.append(`${j}y`,"0")}else y&&u.append(y,k)}}else{if(Kh(n))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=hh,i=null,l=mh,d=n}return u&&l==="text/plain"&&(d=u,u=void 0),{action:i,method:t.toLowerCase(),encType:l,formData:u,body:d}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function Lg(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function ME(n,e,t,i){let l=typeof n=="string"?new URL(n,typeof window>"u"?"server://singlefetch/":window.location.origin):n;return t?l.pathname.endsWith("/")?l.pathname=`${l.pathname}_.${i}`:l.pathname=`${l.pathname}.${i}`:l.pathname==="/"?l.pathname=`_root.${i}`:e&&mi(l.pathname,e)==="/"?l.pathname=`${e.replace(/\/$/,"")}/_root.${i}`:l.pathname=`${l.pathname.replace(/\/$/,"")}.${i}`,l}async function DE(n,e){if(n.id in e)return e[n.id];try{let t=await import(n.module);return e[n.id]=t,t}catch(t){return console.error(`Error loading route module \`${n.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function PE(n){return n==null?!1:n.href==null?n.rel==="preload"&&typeof n.imageSrcSet=="string"&&typeof n.imageSizes=="string":typeof n.rel=="string"&&typeof n.href=="string"}async function LE(n,e,t){let i=await Promise.all(n.map(async l=>{let u=e.routes[l.route.id];if(u){let d=await DE(u,t);return d.links?d.links():[]}return[]}));return UE(i.flat(1).filter(PE).filter(l=>l.rel==="stylesheet"||l.rel==="preload").map(l=>l.rel==="stylesheet"?{...l,rel:"prefetch",as:"style"}:{...l,rel:"prefetch"}))}function I1(n,e,t,i,l,u){let d=(g,y)=>t[y]?g.route.id!==t[y].route.id:!0,p=(g,y)=>t[y].pathname!==g.pathname||t[y].route.path?.endsWith("*")&&t[y].params["*"]!==g.params["*"];return u==="assets"?e.filter((g,y)=>d(g,y)||p(g,y)):u==="data"?e.filter((g,y)=>{let w=i.routes[g.route.id];if(!w||!w.hasLoader)return!1;if(d(g,y)||p(g,y))return!0;if(g.route.shouldRevalidate){let k=g.route.shouldRevalidate({currentUrl:new URL(l.pathname+l.search+l.hash,window.origin),currentParams:t[0]?.params||{},nextUrl:new URL(n,window.origin),nextParams:g.params,defaultShouldRevalidate:!0});if(typeof k=="boolean")return k}return!0}):[]}function OE(n,e,{includeHydrateFallback:t}={}){return VE(n.map(i=>{let l=e.routes[i.route.id];if(!l)return[];let u=[l.module];return l.clientActionModule&&(u=u.concat(l.clientActionModule)),l.clientLoaderModule&&(u=u.concat(l.clientLoaderModule)),t&&l.hydrateFallbackModule&&(u=u.concat(l.hydrateFallbackModule)),l.imports&&(u=u.concat(l.imports)),u}).flat(1))}function VE(n){return[...new Set(n)]}function BE(n){let e={},t=Object.keys(n).sort();for(let i of t)e[i]=n[i];return e}function UE(n,e){let t=new Set;return new Set(e),n.reduce((i,l)=>{let u=JSON.stringify(BE(l));return t.has(u)||(t.add(u),i.push({key:u,link:l})),i},[])}function U2(){let n=v.useContext(ec);return Lg(n,"You must render this element inside a <DataRouterContext.Provider> element"),n}function zE(){let n=v.useContext(Gh);return Lg(n,"You must render this element inside a <DataRouterStateContext.Provider> element"),n}var Og=v.createContext(void 0);Og.displayName="FrameworkContext";function z2(){let n=v.useContext(Og);return Lg(n,"You must render this element inside a <HydratedRouter> element"),n}function FE(n,e){let t=v.useContext(Og),[i,l]=v.useState(!1),[u,d]=v.useState(!1),{onFocus:p,onBlur:g,onMouseEnter:y,onMouseLeave:w,onTouchStart:k}=e,j=v.useRef(null);v.useEffect(()=>{if(n==="render"&&d(!0),n==="viewport"){let B=se=>{se.forEach(K=>{d(K.isIntersecting)})},V=new IntersectionObserver(B,{threshold:.5});return j.current&&V.observe(j.current),()=>{V.disconnect()}}},[n]),v.useEffect(()=>{if(i){let B=setTimeout(()=>{d(!0)},100);return()=>{clearTimeout(B)}}},[i]);let O=()=>{l(!0)},H=()=>{l(!1),d(!1)};return t?n!=="intent"?[u,j,{}]:[u,j,{onFocus:Wc(p,O),onBlur:Wc(g,H),onMouseEnter:Wc(y,O),onMouseLeave:Wc(w,H),onTouchStart:Wc(k,O)}]:[!1,j,{}]}function Wc(n,e){return t=>{n&&n(t),t.defaultPrevented||e(t)}}function qE({page:n,...e}){let{router:t}=U2(),i=v.useMemo(()=>N2(t.routes,n,t.basename),[t.routes,n,t.basename]);return i?v.createElement($E,{page:n,matches:i,...e}):null}function HE(n){let{manifest:e,routeModules:t}=z2(),[i,l]=v.useState([]);return v.useEffect(()=>{let u=!1;return LE(n,e,t).then(d=>{u||l(d)}),()=>{u=!0}},[n,e,t]),i}function $E({page:n,matches:e,...t}){let i=_a(),{future:l,manifest:u,routeModules:d}=z2(),{basename:p}=U2(),{loaderData:g,matches:y}=zE(),w=v.useMemo(()=>I1(n,e,y,u,i,"data"),[n,e,y,u,i]),k=v.useMemo(()=>I1(n,e,y,u,i,"assets"),[n,e,y,u,i]),j=v.useMemo(()=>{if(n===i.pathname+i.search+i.hash)return[];let B=new Set,V=!1;if(e.forEach(K=>{let oe=u.routes[K.route.id];!oe||!oe.hasLoader||(!w.some(ye=>ye.route.id===K.route.id)&&K.route.id in g&&d[K.route.id]?.shouldRevalidate||oe.hasClientLoader?V=!0:B.add(K.route.id))}),B.size===0)return[];let se=ME(n,p,l.unstable_trailingSlashAwareDataRequests,"data");return V&&B.size>0&&se.searchParams.set("_routes",e.filter(K=>B.has(K.route.id)).map(K=>K.route.id).join(",")),[se.pathname+se.search]},[p,l.unstable_trailingSlashAwareDataRequests,g,i,u,w,e,n,d]),O=v.useMemo(()=>OE(k,u),[k,u]),H=HE(k);return v.createElement(v.Fragment,null,j.map(B=>v.createElement("link",{key:B,rel:"prefetch",as:"fetch",href:B,...t})),O.map(B=>v.createElement("link",{key:B,rel:"modulepreload",href:B,...t})),H.map(({key:B,link:V})=>v.createElement("link",{key:B,nonce:t.nonce,...V,crossOrigin:V.crossOrigin??t.crossOrigin})))}function WE(...n){return e=>{n.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var GE=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{GE&&(window.__reactRouterVersion="7.13.0")}catch{}function KE({basename:n,children:e,unstable_useTransitions:t,window:i}){let l=v.useRef();l.current==null&&(l.current=TT({window:i,v5Compat:!0}));let u=l.current,[d,p]=v.useState({action:u.action,location:u.location}),g=v.useCallback(y=>{t===!1?p(y):v.startTransition(()=>p(y))},[t]);return v.useLayoutEffect(()=>u.listen(g),[u,g]),v.createElement(_E,{basename:n,children:e,location:d.location,navigationType:d.action,navigator:u,unstable_useTransitions:t})}var F2=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,q2=v.forwardRef(function({onClick:e,discover:t="render",prefetch:i="none",relative:l,reloadDocument:u,replace:d,state:p,target:g,to:y,preventScrollReset:w,viewTransition:k,unstable_defaultShouldRevalidate:j,...O},H){let{basename:B,unstable_useTransitions:V}=v.useContext(Wr),se=typeof y=="string"&&F2.test(y),K=A2(y,B);y=K.to;let oe=aE(y,{relative:l}),[ye,Pe,Ee]=FE(i,O),R=JE(y,{replace:d,state:p,target:g,preventScrollReset:w,relative:l,viewTransition:k,unstable_defaultShouldRevalidate:j,unstable_useTransitions:V});function T(L){e&&e(L),L.defaultPrevented||R(L)}let A=v.createElement("a",{...O,...Ee,href:K.absoluteURL||oe,onClick:K.isExternal||u?e:T,ref:WE(H,Pe),target:g,"data-discover":!se&&t==="render"?"true":void 0});return ye&&!se?v.createElement(v.Fragment,null,A,v.createElement(qE,{page:oe})):A});q2.displayName="Link";var YE=v.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:i="",end:l=!1,style:u,to:d,viewTransition:p,children:g,...y},w){let k=Nu(d,{relative:y.relative}),j=_a(),O=v.useContext(Gh),{navigator:H,basename:B}=v.useContext(Wr),V=O!=null&&rN(k)&&p===!0,se=H.encodeLocation?H.encodeLocation(k).pathname:k.pathname,K=j.pathname,oe=O&&O.navigation&&O.navigation.location?O.navigation.location.pathname:null;t||(K=K.toLowerCase(),oe=oe?oe.toLowerCase():null,se=se.toLowerCase()),oe&&B&&(oe=mi(oe,B)||oe);const ye=se!=="/"&&se.endsWith("/")?se.length-1:se.length;let Pe=K===se||!l&&K.startsWith(se)&&K.charAt(ye)==="/",Ee=oe!=null&&(oe===se||!l&&oe.startsWith(se)&&oe.charAt(se.length)==="/"),R={isActive:Pe,isPending:Ee,isTransitioning:V},T=Pe?e:void 0,A;typeof i=="function"?A=i(R):A=[i,Pe?"active":null,Ee?"pending":null,V?"transitioning":null].filter(Boolean).join(" ");let L=typeof u=="function"?u(R):u;return v.createElement(q2,{...y,"aria-current":T,className:A,ref:w,style:L,to:d,viewTransition:p},typeof g=="function"?g(R):g)});YE.displayName="NavLink";var QE=v.forwardRef(({discover:n="render",fetcherKey:e,navigate:t,reloadDocument:i,replace:l,state:u,method:d=hh,action:p,onSubmit:g,relative:y,preventScrollReset:w,viewTransition:k,unstable_defaultShouldRevalidate:j,...O},H)=>{let{unstable_useTransitions:B}=v.useContext(Wr),V=sN(),se=nN(p,{relative:y}),K=d.toLowerCase()==="get"?"get":"post",oe=typeof p=="string"&&F2.test(p),ye=Pe=>{if(g&&g(Pe),Pe.defaultPrevented)return;Pe.preventDefault();let Ee=Pe.nativeEvent.submitter,R=Ee?.getAttribute("formmethod")||d,T=()=>V(Ee||Pe.currentTarget,{fetcherKey:e,method:R,navigate:t,replace:l,state:u,relative:y,preventScrollReset:w,viewTransition:k,unstable_defaultShouldRevalidate:j});B&&t!==!1?v.startTransition(()=>T()):T()};return v.createElement("form",{ref:H,method:K,action:se,onSubmit:i?g:ye,...O,"data-discover":!oe&&n==="render"?"true":void 0})});QE.displayName="Form";function XE(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function H2(n){let e=v.useContext(ec);return cn(e,XE(n)),e}function JE(n,{target:e,replace:t,state:i,preventScrollReset:l,relative:u,viewTransition:d,unstable_defaultShouldRevalidate:p,unstable_useTransitions:g}={}){let y=$n(),w=_a(),k=Nu(n,{relative:u});return v.useCallback(j=>{if(SE(j,e)){j.preventDefault();let O=t!==void 0?t:mu(w)===mu(k),H=()=>y(n,{replace:O,state:i,preventScrollReset:l,relative:u,viewTransition:d,unstable_defaultShouldRevalidate:p});g?v.startTransition(()=>H()):H()}},[w,y,k,t,i,e,n,l,u,d,p,g])}function ZE(n){ra(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let e=v.useRef(sg(n)),t=v.useRef(!1),i=_a(),l=v.useMemo(()=>CE(i.search,t.current?null:e.current),[i.search]),u=$n(),d=v.useCallback((p,g)=>{const y=sg(typeof p=="function"?p(new URLSearchParams(l)):p);t.current=!0,u("?"+y,g)},[u,l]);return[l,d]}var eN=0,tN=()=>`__${String(++eN)}__`;function sN(){let{router:n}=H2("useSubmit"),{basename:e}=v.useContext(Wr),t=yE(),i=n.fetch,l=n.navigate;return v.useCallback(async(u,d={})=>{let{action:p,method:g,encType:y,formData:w,body:k}=IE(u,e);if(d.navigate===!1){let j=d.fetcherKey||tN();await i(j,t,d.action||p,{unstable_defaultShouldRevalidate:d.unstable_defaultShouldRevalidate,preventScrollReset:d.preventScrollReset,formData:w,body:k,formMethod:d.method||g,formEncType:d.encType||y,flushSync:d.flushSync})}else await l(d.action||p,{unstable_defaultShouldRevalidate:d.unstable_defaultShouldRevalidate,preventScrollReset:d.preventScrollReset,formData:w,body:k,formMethod:d.method||g,formEncType:d.encType||y,replace:d.replace,state:d.state,fromRouteId:t,flushSync:d.flushSync,viewTransition:d.viewTransition})},[i,l,e,t])}function nN(n,{relative:e}={}){let{basename:t}=v.useContext(Wr),i=v.useContext(wa);cn(i,"useFormAction must be used inside a RouteContext");let[l]=i.matches.slice(-1),u={...Nu(n||".",{relative:e})},d=_a();if(n==null){u.search=d.search;let p=new URLSearchParams(u.search),g=p.getAll("index");if(g.some(w=>w==="")){p.delete("index"),g.filter(k=>k).forEach(k=>p.append("index",k));let w=p.toString();u.search=w?`?${w}`:""}}return(!n||n===".")&&l.route.index&&(u.search=u.search?u.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(u.pathname=u.pathname==="/"?t:ci([t,u.pathname])),mu(u)}function rN(n,{relative:e}={}){let t=v.useContext(M2);cn(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:i}=H2("useViewTransitionState"),l=Nu(n,{relative:e});if(!t.isTransitioning)return!1;let u=mi(t.currentLocation.pathname,i)||t.currentLocation.pathname,d=mi(t.nextLocation.pathname,i)||t.nextLocation.pathname;return jh(l.pathname,d)!=null||jh(l.pathname,u)!=null}const aN=()=>{};var M1={};const $2=function(n){const e=[];let t=0;for(let i=0;i<n.length;i++){let l=n.charCodeAt(i);l<128?e[t++]=l:l<2048?(e[t++]=l>>6|192,e[t++]=l&63|128):(l&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(l=65536+((l&1023)<<10)+(n.charCodeAt(++i)&1023),e[t++]=l>>18|240,e[t++]=l>>12&63|128,e[t++]=l>>6&63|128,e[t++]=l&63|128):(e[t++]=l>>12|224,e[t++]=l>>6&63|128,e[t++]=l&63|128)}return e},iN=function(n){const e=[];let t=0,i=0;for(;t<n.length;){const l=n[t++];if(l<128)e[i++]=String.fromCharCode(l);else if(l>191&&l<224){const u=n[t++];e[i++]=String.fromCharCode((l&31)<<6|u&63)}else if(l>239&&l<365){const u=n[t++],d=n[t++],p=n[t++],g=((l&7)<<18|(u&63)<<12|(d&63)<<6|p&63)-65536;e[i++]=String.fromCharCode(55296+(g>>10)),e[i++]=String.fromCharCode(56320+(g&1023))}else{const u=n[t++],d=n[t++];e[i++]=String.fromCharCode((l&15)<<12|(u&63)<<6|d&63)}}return e.join("")},W2={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let l=0;l<n.length;l+=3){const u=n[l],d=l+1<n.length,p=d?n[l+1]:0,g=l+2<n.length,y=g?n[l+2]:0,w=u>>2,k=(u&3)<<4|p>>4;let j=(p&15)<<2|y>>6,O=y&63;g||(O=64,d||(j=64)),i.push(t[w],t[k],t[j],t[O])}return i.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray($2(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):iN(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let l=0;l<n.length;){const u=t[n.charAt(l++)],p=l<n.length?t[n.charAt(l)]:0;++l;const y=l<n.length?t[n.charAt(l)]:64;++l;const k=l<n.length?t[n.charAt(l)]:64;if(++l,u==null||p==null||y==null||k==null)throw new oN;const j=u<<2|p>>4;if(i.push(j),y!==64){const O=p<<4&240|y>>2;if(i.push(O),k!==64){const H=y<<6&192|k;i.push(H)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class oN extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const lN=function(n){const e=$2(n);return W2.encodeByteArray(e,!0)},Th=function(n){return lN(n).replace(/\./g,"")},G2=function(n){try{return W2.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function cN(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const uN=()=>cN().__FIREBASE_DEFAULTS__,dN=()=>{if(typeof process>"u"||typeof M1>"u")return;const n=M1.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},hN=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&G2(n[1]);return e&&JSON.parse(e)},Yh=()=>{try{return aN()||uN()||dN()||hN()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},K2=n=>Yh()?.emulatorHosts?.[n],Y2=n=>{const e=K2(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),i]:[e.substring(0,t),i]},Q2=()=>Yh()?.config,X2=n=>Yh()?.[`_${n}`];class mN{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}}function fo(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Vg(n){return(await fetch(n,{credentials:"include"})).ok}function J2(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},i=e||"demo-project",l=n.iat||0,u=n.sub||n.user_id;if(!u)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const d={iss:`https://securetoken.google.com/${i}`,aud:i,iat:l,exp:l+3600,auth_time:l,sub:u,user_id:u,firebase:{sign_in_provider:"custom",identities:{}},...n};return[Th(JSON.stringify(t)),Th(JSON.stringify(d)),""].join(".")}const ru={};function fN(){const n={prod:[],emulator:[]};for(const e of Object.keys(ru))ru[e]?n.emulator.push(e):n.prod.push(e);return n}function pN(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let D1=!1;function Bg(n,e){if(typeof window>"u"||typeof document>"u"||!fo(window.location.host)||ru[n]===e||ru[n]||D1)return;ru[n]=e;function t(j){return`__firebase__banner__${j}`}const i="__firebase__banner",u=fN().prod.length>0;function d(){const j=document.getElementById(i);j&&j.remove()}function p(j){j.style.display="flex",j.style.background="#7faaf0",j.style.position="fixed",j.style.bottom="5px",j.style.left="5px",j.style.padding=".5em",j.style.borderRadius="5px",j.style.alignItems="center"}function g(j,O){j.setAttribute("width","24"),j.setAttribute("id",O),j.setAttribute("height","24"),j.setAttribute("viewBox","0 0 24 24"),j.setAttribute("fill","none"),j.style.marginLeft="-6px"}function y(){const j=document.createElement("span");return j.style.cursor="pointer",j.style.marginLeft="16px",j.style.fontSize="24px",j.innerHTML=" &times;",j.onclick=()=>{D1=!0,d()},j}function w(j,O){j.setAttribute("id",O),j.innerText="Learn more",j.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",j.setAttribute("target","__blank"),j.style.paddingLeft="5px",j.style.textDecoration="underline"}function k(){const j=pN(i),O=t("text"),H=document.getElementById(O)||document.createElement("span"),B=t("learnmore"),V=document.getElementById(B)||document.createElement("a"),se=t("preprendIcon"),K=document.getElementById(se)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(j.created){const oe=j.element;p(oe),w(V,B);const ye=y();g(K,se),oe.append(K,H,V,ye),document.body.appendChild(oe)}u?(H.innerText="Preview backend disconnected.",K.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(K.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,H.innerText="Preview backend running in this workspace."),H.setAttribute("id",O)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",k):k()}function cr(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function gN(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(cr())}function yN(){const n=Yh()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function bN(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function vN(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function xN(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function wN(){const n=cr();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function _N(){return!yN()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function kN(){try{return typeof indexedDB=="object"}catch{return!1}}function jN(){return new Promise((n,e)=>{try{let t=!0;const i="validate-browser-context-for-indexeddb-analytics-module",l=self.indexedDB.open(i);l.onsuccess=()=>{l.result.close(),t||self.indexedDB.deleteDatabase(i),n(!0)},l.onupgradeneeded=()=>{t=!1},l.onerror=()=>{e(l.error?.message||"")}}catch(t){e(t)}})}const TN="FirebaseError";class qa extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=TN,Object.setPrototypeOf(this,qa.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Su.prototype.create)}}class Su{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){const i=t[0]||{},l=`${this.service}/${e}`,u=this.errors[e],d=u?EN(u,i):"Error",p=`${this.serviceName}: ${d} (${l}).`;return new qa(l,p,i)}}function EN(n,e){return n.replace(NN,(t,i)=>{const l=e[i];return l!=null?String(l):`<${i}?>`})}const NN=/\{\$([^}]+)}/g;function SN(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Ho(n,e){if(n===e)return!0;const t=Object.keys(n),i=Object.keys(e);for(const l of t){if(!i.includes(l))return!1;const u=n[l],d=e[l];if(P1(u)&&P1(d)){if(!Ho(u,d))return!1}else if(u!==d)return!1}for(const l of i)if(!t.includes(l))return!1;return!0}function P1(n){return n!==null&&typeof n=="object"}function Cu(n){const e=[];for(const[t,i]of Object.entries(n))Array.isArray(i)?i.forEach(l=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(l))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function Jc(n){const e={};return n.replace(/^\?/,"").split("&").forEach(i=>{if(i){const[l,u]=i.split("=");e[decodeURIComponent(l)]=decodeURIComponent(u)}}),e}function Zc(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function CN(n,e){const t=new RN(n,e);return t.subscribe.bind(t)}class RN{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,i){let l;if(e===void 0&&t===void 0&&i===void 0)throw new Error("Missing Observer.");AN(e,["next","error","complete"])?l=e:l={next:e,error:t,complete:i},l.next===void 0&&(l.next=kp),l.error===void 0&&(l.error=kp),l.complete===void 0&&(l.complete=kp);const u=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?l.error(this.finalError):l.complete()}catch{}}),this.observers.push(l),u}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function AN(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function kp(){}function Ks(n){return n&&n._delegate?n._delegate:n}class io{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const Oo="[DEFAULT]";class IN{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const i=new mN;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{const l=this.getOrInitializeService({instanceIdentifier:t});l&&i.resolve(l)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),i=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(l){if(i)return null;throw l}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(DN(e))try{this.getOrInitializeService({instanceIdentifier:Oo})}catch{}for(const[t,i]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(t);try{const u=this.getOrInitializeService({instanceIdentifier:l});i.resolve(u)}catch{}}}}clearInstance(e=Oo){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Oo){return this.instances.has(e)}getOptions(e=Oo){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const l=this.getOrInitializeService({instanceIdentifier:i,options:t});for(const[u,d]of this.instancesDeferred.entries()){const p=this.normalizeInstanceIdentifier(u);i===p&&d.resolve(l)}return l}onInit(e,t){const i=this.normalizeInstanceIdentifier(t),l=this.onInitCallbacks.get(i)??new Set;l.add(e),this.onInitCallbacks.set(i,l);const u=this.instances.get(i);return u&&e(u,i),()=>{l.delete(e)}}invokeOnInitCallbacks(e,t){const i=this.onInitCallbacks.get(t);if(i)for(const l of i)try{l(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:MN(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=Oo){return this.component?this.component.multipleInstances?e:Oo:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function MN(n){return n===Oo?void 0:n}function DN(n){return n.instantiationMode==="EAGER"}class PN{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new IN(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}var gs;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(gs||(gs={}));const LN={debug:gs.DEBUG,verbose:gs.VERBOSE,info:gs.INFO,warn:gs.WARN,error:gs.ERROR,silent:gs.SILENT},ON=gs.INFO,VN={[gs.DEBUG]:"log",[gs.VERBOSE]:"log",[gs.INFO]:"info",[gs.WARN]:"warn",[gs.ERROR]:"error"},BN=(n,e,...t)=>{if(e<n.logLevel)return;const i=new Date().toISOString(),l=VN[e];if(l)console[l](`[${i}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Ug{constructor(e){this.name=e,this._logLevel=ON,this._logHandler=BN,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in gs))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?LN[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,gs.DEBUG,...e),this._logHandler(this,gs.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,gs.VERBOSE,...e),this._logHandler(this,gs.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,gs.INFO,...e),this._logHandler(this,gs.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,gs.WARN,...e),this._logHandler(this,gs.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,gs.ERROR,...e),this._logHandler(this,gs.ERROR,...e)}}const UN=(n,e)=>e.some(t=>n instanceof t);let L1,O1;function zN(){return L1||(L1=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function FN(){return O1||(O1=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Z2=new WeakMap,ng=new WeakMap,ew=new WeakMap,jp=new WeakMap,zg=new WeakMap;function qN(n){const e=new Promise((t,i)=>{const l=()=>{n.removeEventListener("success",u),n.removeEventListener("error",d)},u=()=>{t(so(n.result)),l()},d=()=>{i(n.error),l()};n.addEventListener("success",u),n.addEventListener("error",d)});return e.then(t=>{t instanceof IDBCursor&&Z2.set(t,n)}).catch(()=>{}),zg.set(e,n),e}function HN(n){if(ng.has(n))return;const e=new Promise((t,i)=>{const l=()=>{n.removeEventListener("complete",u),n.removeEventListener("error",d),n.removeEventListener("abort",d)},u=()=>{t(),l()},d=()=>{i(n.error||new DOMException("AbortError","AbortError")),l()};n.addEventListener("complete",u),n.addEventListener("error",d),n.addEventListener("abort",d)});ng.set(n,e)}let rg={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return ng.get(n);if(e==="objectStoreNames")return n.objectStoreNames||ew.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return so(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function $N(n){rg=n(rg)}function WN(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const i=n.call(Tp(this),e,...t);return ew.set(i,e.sort?e.sort():[e]),so(i)}:FN().includes(n)?function(...e){return n.apply(Tp(this),e),so(Z2.get(this))}:function(...e){return so(n.apply(Tp(this),e))}}function GN(n){return typeof n=="function"?WN(n):(n instanceof IDBTransaction&&HN(n),UN(n,zN())?new Proxy(n,rg):n)}function so(n){if(n instanceof IDBRequest)return qN(n);if(jp.has(n))return jp.get(n);const e=GN(n);return e!==n&&(jp.set(n,e),zg.set(e,n)),e}const Tp=n=>zg.get(n);function KN(n,e,{blocked:t,upgrade:i,blocking:l,terminated:u}={}){const d=indexedDB.open(n,e),p=so(d);return i&&d.addEventListener("upgradeneeded",g=>{i(so(d.result),g.oldVersion,g.newVersion,so(d.transaction),g)}),t&&d.addEventListener("blocked",g=>t(g.oldVersion,g.newVersion,g)),p.then(g=>{u&&g.addEventListener("close",()=>u()),l&&g.addEventListener("versionchange",y=>l(y.oldVersion,y.newVersion,y))}).catch(()=>{}),p}const YN=["get","getKey","getAll","getAllKeys","count"],QN=["put","add","delete","clear"],Ep=new Map;function V1(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Ep.get(e))return Ep.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,l=QN.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(l||YN.includes(t)))return;const u=async function(d,...p){const g=this.transaction(d,l?"readwrite":"readonly");let y=g.store;return i&&(y=y.index(p.shift())),(await Promise.all([y[t](...p),l&&g.done]))[0]};return Ep.set(e,u),u}$N(n=>({...n,get:(e,t,i)=>V1(e,t)||n.get(e,t,i),has:(e,t)=>!!V1(e,t)||n.has(e,t)}));class XN{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(JN(t)){const i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}}function JN(n){return n.getComponent()?.type==="VERSION"}const ag="@firebase/app",B1="0.14.7";const fi=new Ug("@firebase/app"),ZN="@firebase/app-compat",eS="@firebase/analytics-compat",tS="@firebase/analytics",sS="@firebase/app-check-compat",nS="@firebase/app-check",rS="@firebase/auth",aS="@firebase/auth-compat",iS="@firebase/database",oS="@firebase/data-connect",lS="@firebase/database-compat",cS="@firebase/functions",uS="@firebase/functions-compat",dS="@firebase/installations",hS="@firebase/installations-compat",mS="@firebase/messaging",fS="@firebase/messaging-compat",pS="@firebase/performance",gS="@firebase/performance-compat",yS="@firebase/remote-config",bS="@firebase/remote-config-compat",vS="@firebase/storage",xS="@firebase/storage-compat",wS="@firebase/firestore",_S="@firebase/ai",kS="@firebase/firestore-compat",jS="firebase",TS="12.8.0";const ig="[DEFAULT]",ES={[ag]:"fire-core",[ZN]:"fire-core-compat",[tS]:"fire-analytics",[eS]:"fire-analytics-compat",[nS]:"fire-app-check",[sS]:"fire-app-check-compat",[rS]:"fire-auth",[aS]:"fire-auth-compat",[iS]:"fire-rtdb",[oS]:"fire-data-connect",[lS]:"fire-rtdb-compat",[cS]:"fire-fn",[uS]:"fire-fn-compat",[dS]:"fire-iid",[hS]:"fire-iid-compat",[mS]:"fire-fcm",[fS]:"fire-fcm-compat",[pS]:"fire-perf",[gS]:"fire-perf-compat",[yS]:"fire-rc",[bS]:"fire-rc-compat",[vS]:"fire-gcs",[xS]:"fire-gcs-compat",[wS]:"fire-fst",[kS]:"fire-fst-compat",[_S]:"fire-vertex","fire-js":"fire-js",[jS]:"fire-js-all"};const Eh=new Map,NS=new Map,og=new Map;function U1(n,e){try{n.container.addComponent(e)}catch(t){fi.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function $o(n){const e=n.name;if(og.has(e))return fi.debug(`There were multiple attempts to register component ${e}.`),!1;og.set(e,n);for(const t of Eh.values())U1(t,n);for(const t of NS.values())U1(t,n);return!0}function Qh(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function qr(n){return n==null?!1:n.settings!==void 0}const SS={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},no=new Su("app","Firebase",SS);class CS{constructor(e,t,i){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new io("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw no.create("app-deleted",{appName:this._name})}}const Jo=TS;function Fg(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const i={name:ig,automaticDataCollectionEnabled:!0,...e},l=i.name;if(typeof l!="string"||!l)throw no.create("bad-app-name",{appName:String(l)});if(t||(t=Q2()),!t)throw no.create("no-options");const u=Eh.get(l);if(u){if(Ho(t,u.options)&&Ho(i,u.config))return u;throw no.create("duplicate-app",{appName:l})}const d=new PN(l);for(const g of og.values())d.addComponent(g);const p=new CS(t,i,d);return Eh.set(l,p),p}function qg(n=ig){const e=Eh.get(n);if(!e&&n===ig&&Q2())return Fg();if(!e)throw no.create("no-app",{appName:n});return e}function Pa(n,e,t){let i=ES[n]??n;t&&(i+=`-${t}`);const l=i.match(/\s|\//),u=e.match(/\s|\//);if(l||u){const d=[`Unable to register library "${i}" with version "${e}":`];l&&d.push(`library name "${i}" contains illegal characters (whitespace or "/")`),l&&u&&d.push("and"),u&&d.push(`version name "${e}" contains illegal characters (whitespace or "/")`),fi.warn(d.join(" "));return}$o(new io(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}const RS="firebase-heartbeat-database",AS=1,fu="firebase-heartbeat-store";let Np=null;function tw(){return Np||(Np=KN(RS,AS,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(fu)}catch(t){console.warn(t)}}}}).catch(n=>{throw no.create("idb-open",{originalErrorMessage:n.message})})),Np}async function IS(n){try{const t=(await tw()).transaction(fu),i=await t.objectStore(fu).get(sw(n));return await t.done,i}catch(e){if(e instanceof qa)fi.warn(e.message);else{const t=no.create("idb-get",{originalErrorMessage:e?.message});fi.warn(t.message)}}}async function z1(n,e){try{const i=(await tw()).transaction(fu,"readwrite");await i.objectStore(fu).put(e,sw(n)),await i.done}catch(t){if(t instanceof qa)fi.warn(t.message);else{const i=no.create("idb-set",{originalErrorMessage:t?.message});fi.warn(i.message)}}}function sw(n){return`${n.name}!${n.options.appId}`}const MS=1024,DS=30;class PS{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new OS(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=F1();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(l=>l.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:t}),this._heartbeatsCache.heartbeats.length>DS){const l=VS(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(l,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){fi.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=F1(),{heartbeatsToSend:t,unsentEntries:i}=LS(this._heartbeatsCache.heartbeats),l=Th(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),l}catch(e){return fi.warn(e),""}}}function F1(){return new Date().toISOString().substring(0,10)}function LS(n,e=MS){const t=[];let i=n.slice();for(const l of n){const u=t.find(d=>d.agent===l.agent);if(u){if(u.dates.push(l.date),q1(t)>e){u.dates.pop();break}}else if(t.push({agent:l.agent,dates:[l.date]}),q1(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}class OS{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return kN()?jN().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await IS(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return z1(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return z1(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function q1(n){return Th(JSON.stringify({version:2,heartbeats:n})).length}function VS(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let i=1;i<n.length;i++)n[i].date<t&&(t=n[i].date,e=i);return e}function BS(n){$o(new io("platform-logger",e=>new XN(e),"PRIVATE")),$o(new io("heartbeat",e=>new PS(e),"PRIVATE")),Pa(ag,B1,n),Pa(ag,B1,"esm2020"),Pa("fire-js","")}BS("");function nw(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const US=nw,rw=new Su("auth","Firebase",nw());const Nh=new Ug("@firebase/auth");function zS(n,...e){Nh.logLevel<=gs.WARN&&Nh.warn(`Auth (${Jo}): ${n}`,...e)}function fh(n,...e){Nh.logLevel<=gs.ERROR&&Nh.error(`Auth (${Jo}): ${n}`,...e)}function ba(n,...e){throw Hg(n,...e)}function La(n,...e){return Hg(n,...e)}function aw(n,e,t){const i={...US(),[e]:t};return new Su("auth","Firebase",i).create(e,{appName:n.name})}function ui(n){return aw(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Hg(n,...e){if(typeof n!="string"){const t=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=n.name),n._errorFactory.create(t,...i)}return rw.create(n,...e)}function Vt(n,e,...t){if(!n)throw Hg(e,...t)}function oi(n){const e="INTERNAL ASSERTION FAILED: "+n;throw fh(e),new Error(e)}function pi(n,e){n||oi(e)}function lg(){return typeof self<"u"&&self.location?.href||""}function FS(){return H1()==="http:"||H1()==="https:"}function H1(){return typeof self<"u"&&self.location?.protocol||null}function qS(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(FS()||vN()||"connection"in navigator)?navigator.onLine:!0}function HS(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}class Ru{constructor(e,t){this.shortDelay=e,this.longDelay=t,pi(t>e,"Short delay should be less than long delay!"),this.isMobile=gN()||xN()}get(){return qS()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function $g(n,e){pi(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class iw{static initialize(e,t,i){this.fetchImpl=e,t&&(this.headersImpl=t),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;oi("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;oi("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;oi("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const $S={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const WS=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],GS=new Ru(3e4,6e4);function bi(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function vi(n,e,t,i,l={}){return ow(n,l,async()=>{let u={},d={};i&&(e==="GET"?d=i:u={body:JSON.stringify(i)});const p=Cu({key:n.config.apiKey,...d}).slice(1),g=await n._getAdditionalHeaders();g["Content-Type"]="application/json",n.languageCode&&(g["X-Firebase-Locale"]=n.languageCode);const y={method:e,headers:g,...u};return bN()||(y.referrerPolicy="no-referrer"),n.emulatorConfig&&fo(n.emulatorConfig.host)&&(y.credentials="include"),iw.fetch()(await lw(n,n.config.apiHost,t,p),y)})}async function ow(n,e,t){n._canInitEmulator=!1;const i={...$S,...e};try{const l=new YS(n),u=await Promise.race([t(),l.promise]);l.clearNetworkTimeout();const d=await u.json();if("needConfirmation"in d)throw Zd(n,"account-exists-with-different-credential",d);if(u.ok&&!("errorMessage"in d))return d;{const p=u.ok?d.errorMessage:d.error.message,[g,y]=p.split(" : ");if(g==="FEDERATED_USER_ID_ALREADY_LINKED")throw Zd(n,"credential-already-in-use",d);if(g==="EMAIL_EXISTS")throw Zd(n,"email-already-in-use",d);if(g==="USER_DISABLED")throw Zd(n,"user-disabled",d);const w=i[g]||g.toLowerCase().replace(/[_\s]+/g,"-");if(y)throw aw(n,w,y);ba(n,w)}}catch(l){if(l instanceof qa)throw l;ba(n,"network-request-failed",{message:String(l)})}}async function Au(n,e,t,i,l={}){const u=await vi(n,e,t,i,l);return"mfaPendingCredential"in u&&ba(n,"multi-factor-auth-required",{_serverResponse:u}),u}async function lw(n,e,t,i){const l=`${e}${t}?${i}`,u=n,d=u.config.emulator?$g(n.config,l):`${n.config.apiScheme}://${l}`;return WS.includes(t)&&(await u._persistenceManagerAvailable,u._getPersistenceType()==="COOKIE")?u._getPersistence()._getFinalTarget(d).toString():d}function KS(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class YS{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,i)=>{this.timer=setTimeout(()=>i(La(this.auth,"network-request-failed")),GS.get())})}}function Zd(n,e,t){const i={appName:n.name};t.email&&(i.email=t.email),t.phoneNumber&&(i.phoneNumber=t.phoneNumber);const l=La(n,e,i);return l.customData._tokenResponse=t,l}function $1(n){return n!==void 0&&n.enterprise!==void 0}class QS{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return KS(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function XS(n,e){return vi(n,"GET","/v2/recaptchaConfig",bi(n,e))}async function JS(n,e){return vi(n,"POST","/v1/accounts:delete",e)}async function Sh(n,e){return vi(n,"POST","/v1/accounts:lookup",e)}function au(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function ZS(n,e=!1){const t=Ks(n),i=await t.getIdToken(e),l=Wg(i);Vt(l&&l.exp&&l.auth_time&&l.iat,t.auth,"internal-error");const u=typeof l.firebase=="object"?l.firebase:void 0,d=u?.sign_in_provider;return{claims:l,token:i,authTime:au(Sp(l.auth_time)),issuedAtTime:au(Sp(l.iat)),expirationTime:au(Sp(l.exp)),signInProvider:d||null,signInSecondFactor:u?.sign_in_second_factor||null}}function Sp(n){return Number(n)*1e3}function Wg(n){const[e,t,i]=n.split(".");if(e===void 0||t===void 0||i===void 0)return fh("JWT malformed, contained fewer than 3 sections"),null;try{const l=G2(t);return l?JSON.parse(l):(fh("Failed to decode base64 JWT payload"),null)}catch(l){return fh("Caught error parsing JWT payload as JSON",l?.toString()),null}}function W1(n){const e=Wg(n);return Vt(e,"internal-error"),Vt(typeof e.exp<"u","internal-error"),Vt(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function pu(n,e,t=!1){if(t)return e;try{return await e}catch(i){throw i instanceof qa&&eC(i)&&n.auth.currentUser===n&&await n.auth.signOut(),i}}function eC({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}class tC{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const i=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class cg{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=au(this.lastLoginAt),this.creationTime=au(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Ch(n){const e=n.auth,t=await n.getIdToken(),i=await pu(n,Sh(e,{idToken:t}));Vt(i?.users.length,e,"internal-error");const l=i.users[0];n._notifyReloadListener(l);const u=l.providerUserInfo?.length?cw(l.providerUserInfo):[],d=nC(n.providerData,u),p=n.isAnonymous,g=!(n.email&&l.passwordHash)&&!d?.length,y=p?g:!1,w={uid:l.localId,displayName:l.displayName||null,photoURL:l.photoUrl||null,email:l.email||null,emailVerified:l.emailVerified||!1,phoneNumber:l.phoneNumber||null,tenantId:l.tenantId||null,providerData:d,metadata:new cg(l.createdAt,l.lastLoginAt),isAnonymous:y};Object.assign(n,w)}async function sC(n){const e=Ks(n);await Ch(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function nC(n,e){return[...n.filter(i=>!e.some(l=>l.providerId===i.providerId)),...e]}function cw(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}async function rC(n,e){const t=await ow(n,{},async()=>{const i=Cu({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:l,apiKey:u}=n.config,d=await lw(n,l,"/v1/token",`key=${u}`),p=await n._getAdditionalHeaders();p["Content-Type"]="application/x-www-form-urlencoded";const g={method:"POST",headers:p,body:i};return n.emulatorConfig&&fo(n.emulatorConfig.host)&&(g.credentials="include"),iw.fetch()(d,g)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function aC(n,e){return vi(n,"POST","/v2/accounts:revokeToken",bi(n,e))}class Fl{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Vt(e.idToken,"internal-error"),Vt(typeof e.idToken<"u","internal-error"),Vt(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):W1(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Vt(e.length!==0,"internal-error");const t=W1(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Vt(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:i,refreshToken:l,expiresIn:u}=await rC(e,t);this.updateTokensAndExpiration(i,l,Number(u))}updateTokensAndExpiration(e,t,i){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,t){const{refreshToken:i,accessToken:l,expirationTime:u}=t,d=new Fl;return i&&(Vt(typeof i=="string","internal-error",{appName:e}),d.refreshToken=i),l&&(Vt(typeof l=="string","internal-error",{appName:e}),d.accessToken=l),u&&(Vt(typeof u=="number","internal-error",{appName:e}),d.expirationTime=u),d}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Fl,this.toJSON())}_performRefresh(){return oi("not implemented")}}function $i(n,e){Vt(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class ga{constructor({uid:e,auth:t,stsTokenManager:i,...l}){this.providerId="firebase",this.proactiveRefresh=new tC(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=l.displayName||null,this.email=l.email||null,this.emailVerified=l.emailVerified||!1,this.phoneNumber=l.phoneNumber||null,this.photoURL=l.photoURL||null,this.isAnonymous=l.isAnonymous||!1,this.tenantId=l.tenantId||null,this.providerData=l.providerData?[...l.providerData]:[],this.metadata=new cg(l.createdAt||void 0,l.lastLoginAt||void 0)}async getIdToken(e){const t=await pu(this,this.stsTokenManager.getToken(this.auth,e));return Vt(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return ZS(this,e)}reload(){return sC(this)}_assign(e){this!==e&&(Vt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new ga({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){Vt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),t&&await Ch(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(qr(this.auth.app))return Promise.reject(ui(this.auth));const e=await this.getIdToken();return await pu(this,JS(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const i=t.displayName??void 0,l=t.email??void 0,u=t.phoneNumber??void 0,d=t.photoURL??void 0,p=t.tenantId??void 0,g=t._redirectEventId??void 0,y=t.createdAt??void 0,w=t.lastLoginAt??void 0,{uid:k,emailVerified:j,isAnonymous:O,providerData:H,stsTokenManager:B}=t;Vt(k&&B,e,"internal-error");const V=Fl.fromJSON(this.name,B);Vt(typeof k=="string",e,"internal-error"),$i(i,e.name),$i(l,e.name),Vt(typeof j=="boolean",e,"internal-error"),Vt(typeof O=="boolean",e,"internal-error"),$i(u,e.name),$i(d,e.name),$i(p,e.name),$i(g,e.name),$i(y,e.name),$i(w,e.name);const se=new ga({uid:k,auth:e,email:l,emailVerified:j,displayName:i,isAnonymous:O,photoURL:d,phoneNumber:u,tenantId:p,stsTokenManager:V,createdAt:y,lastLoginAt:w});return H&&Array.isArray(H)&&(se.providerData=H.map(K=>({...K}))),g&&(se._redirectEventId=g),se}static async _fromIdTokenResponse(e,t,i=!1){const l=new Fl;l.updateFromServerResponse(t);const u=new ga({uid:t.localId,auth:e,stsTokenManager:l,isAnonymous:i});return await Ch(u),u}static async _fromGetAccountInfoResponse(e,t,i){const l=t.users[0];Vt(l.localId!==void 0,"internal-error");const u=l.providerUserInfo!==void 0?cw(l.providerUserInfo):[],d=!(l.email&&l.passwordHash)&&!u?.length,p=new Fl;p.updateFromIdToken(i);const g=new ga({uid:l.localId,auth:e,stsTokenManager:p,isAnonymous:d}),y={uid:l.localId,displayName:l.displayName||null,photoURL:l.photoUrl||null,email:l.email||null,emailVerified:l.emailVerified||!1,phoneNumber:l.phoneNumber||null,tenantId:l.tenantId||null,providerData:u,metadata:new cg(l.createdAt,l.lastLoginAt),isAnonymous:!(l.email&&l.passwordHash)&&!u?.length};return Object.assign(g,y),g}}const G1=new Map;function li(n){pi(n instanceof Function,"Expected a class definition");let e=G1.get(n);return e?(pi(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,G1.set(n,e),e)}class uw{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}uw.type="NONE";const K1=uw;function ph(n,e,t){return`firebase:${n}:${e}:${t}`}class ql{constructor(e,t,i){this.persistence=e,this.auth=t,this.userKey=i;const{config:l,name:u}=this.auth;this.fullUserKey=ph(this.userKey,l.apiKey,u),this.fullPersistenceKey=ph("persistence",l.apiKey,u),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await Sh(this.auth,{idToken:e}).catch(()=>{});return t?ga._fromGetAccountInfoResponse(this.auth,t,e):null}return ga._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,i="authUser"){if(!t.length)return new ql(li(K1),e,i);const l=(await Promise.all(t.map(async y=>{if(await y._isAvailable())return y}))).filter(y=>y);let u=l[0]||li(K1);const d=ph(i,e.config.apiKey,e.name);let p=null;for(const y of t)try{const w=await y._get(d);if(w){let k;if(typeof w=="string"){const j=await Sh(e,{idToken:w}).catch(()=>{});if(!j)break;k=await ga._fromGetAccountInfoResponse(e,j,w)}else k=ga._fromJSON(e,w);y!==u&&(p=k),u=y;break}}catch{}const g=l.filter(y=>y._shouldAllowMigration);return!u._shouldAllowMigration||!g.length?new ql(u,e,i):(u=g[0],p&&await u._set(d,p.toJSON()),await Promise.all(t.map(async y=>{if(y!==u)try{await y._remove(d)}catch{}})),new ql(u,e,i))}}function Y1(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(fw(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(dw(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(gw(e))return"Blackberry";if(yw(e))return"Webos";if(hw(e))return"Safari";if((e.includes("chrome/")||mw(e))&&!e.includes("edge/"))return"Chrome";if(pw(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=n.match(t);if(i?.length===2)return i[1]}return"Other"}function dw(n=cr()){return/firefox\//i.test(n)}function hw(n=cr()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function mw(n=cr()){return/crios\//i.test(n)}function fw(n=cr()){return/iemobile/i.test(n)}function pw(n=cr()){return/android/i.test(n)}function gw(n=cr()){return/blackberry/i.test(n)}function yw(n=cr()){return/webos/i.test(n)}function Gg(n=cr()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function iC(n=cr()){return Gg(n)&&!!window.navigator?.standalone}function oC(){return wN()&&document.documentMode===10}function bw(n=cr()){return Gg(n)||pw(n)||yw(n)||gw(n)||/windows phone/i.test(n)||fw(n)}function vw(n,e=[]){let t;switch(n){case"Browser":t=Y1(cr());break;case"Worker":t=`${Y1(cr())}-${n}`;break;default:t=n}const i=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Jo}/${i}`}class lC{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const i=u=>new Promise((d,p)=>{try{const g=e(u);d(g)}catch(g){p(g)}});i.onAbort=t,this.queue.push(i);const l=this.queue.length-1;return()=>{this.queue[l]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const i of this.queue)await i(e),i.onAbort&&t.push(i.onAbort)}catch(i){t.reverse();for(const l of t)try{l()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i?.message})}}}async function cC(n,e={}){return vi(n,"GET","/v2/passwordPolicy",bi(n,e))}const uC=6;class dC{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??uC,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const i=this.customStrengthOptions.minPasswordLength,l=this.customStrengthOptions.maxPasswordLength;i&&(t.meetsMinPasswordLength=e.length>=i),l&&(t.meetsMaxPasswordLength=e.length<=l)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let i;for(let l=0;l<e.length;l++)i=e.charAt(l),this.updatePasswordCharacterOptionsStatuses(t,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,t,i,l,u){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=l)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=u))}}class hC{constructor(e,t,i,l){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=i,this.config=l,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Q1(this),this.idTokenSubscription=new Q1(this),this.beforeStateQueue=new lC(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=rw,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=l.sdkClientVersion,this._persistenceManagerAvailable=new Promise(u=>this._resolvePersistenceManagerAvailable=u)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=li(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await ql.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await Sh(this,{idToken:e}),i=await ga._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(i)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(qr(this.app)){const u=this.app.settings.authIdToken;return u?new Promise(d=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(u).then(d,d))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let i=t,l=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const u=this.redirectUser?._redirectEventId,d=i?._redirectEventId,p=await this.tryRedirectSignIn(e);(!u||u===d)&&p?.user&&(i=p.user,l=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(l)try{await this.beforeStateQueue.runMiddleware(i)}catch(u){i=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(u))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return Vt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Ch(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=HS()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(qr(this.app))return Promise.reject(ui(this));const t=e?Ks(e):null;return t&&Vt(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Vt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return qr(this.app)?Promise.reject(ui(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return qr(this.app)?Promise.reject(ui(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(li(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await cC(this),t=new dC(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Su("auth","Firebase",e())}onAuthStateChanged(e,t,i){return this.registerStateListener(this.authStateSubscription,e,t,i)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,i){return this.registerStateListener(this.idTokenSubscription,e,t,i)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const i=this.onAuthStateChanged(()=>{i(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(i.tenantId=this.tenantId),await aC(this,i)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const i=await this.getOrInitRedirectPersistenceManager(t);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&li(e)||this._popupRedirectResolver;Vt(t,this,"argument-error"),this.redirectPersistenceManager=await ql.create(this,[li(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,i,l){if(this._deleted)return()=>{};const u=typeof t=="function"?t:t.next.bind(t);let d=!1;const p=this._isInitialized?Promise.resolve():this._initializationPromise;if(Vt(p,this,"internal-error"),p.then(()=>{d||u(this.currentUser)}),typeof t=="function"){const g=e.addObserver(t,i,l);return()=>{d=!0,g()}}else{const g=e.addObserver(t);return()=>{d=!0,g()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Vt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=vw(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const i=await this._getAppCheckToken();return i&&(e["X-Firebase-AppCheck"]=i),e}async _getAppCheckToken(){if(qr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&zS(`Error while retrieving App Check token: ${e.error}`),e?.token}}function po(n){return Ks(n)}class Q1{constructor(e){this.auth=e,this.observer=null,this.addObserver=CN(t=>this.observer=t)}get next(){return Vt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let Xh={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function mC(n){Xh=n}function xw(n){return Xh.loadJS(n)}function fC(){return Xh.recaptchaEnterpriseScript}function pC(){return Xh.gapiScript}function gC(n){return`__${n}${Math.floor(Math.random()*1e6)}`}class yC{constructor(){this.enterprise=new bC}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class bC{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const vC="recaptcha-enterprise",ww="NO_RECAPTCHA";class xC{constructor(e){this.type=vC,this.auth=po(e)}async verify(e="verify",t=!1){async function i(u){if(!t){if(u.tenantId==null&&u._agentRecaptchaConfig!=null)return u._agentRecaptchaConfig.siteKey;if(u.tenantId!=null&&u._tenantRecaptchaConfigs[u.tenantId]!==void 0)return u._tenantRecaptchaConfigs[u.tenantId].siteKey}return new Promise(async(d,p)=>{XS(u,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(g=>{if(g.recaptchaKey===void 0)p(new Error("recaptcha Enterprise site key undefined"));else{const y=new QS(g);return u.tenantId==null?u._agentRecaptchaConfig=y:u._tenantRecaptchaConfigs[u.tenantId]=y,d(y.siteKey)}}).catch(g=>{p(g)})})}function l(u,d,p){const g=window.grecaptcha;$1(g)?g.enterprise.ready(()=>{g.enterprise.execute(u,{action:e}).then(y=>{d(y)}).catch(()=>{d(ww)})}):p(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new yC().execute("siteKey",{action:"verify"}):new Promise((u,d)=>{i(this.auth).then(p=>{if(!t&&$1(window.grecaptcha))l(p,u,d);else{if(typeof window>"u"){d(new Error("RecaptchaVerifier is only supported in browser"));return}let g=fC();g.length!==0&&(g+=p),xw(g).then(()=>{l(p,u,d)}).catch(y=>{d(y)})}}).catch(p=>{d(p)})})}}async function X1(n,e,t,i=!1,l=!1){const u=new xC(n);let d;if(l)d=ww;else try{d=await u.verify(t)}catch{d=await u.verify(t,!0)}const p={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in p){const g=p.phoneEnrollmentInfo.phoneNumber,y=p.phoneEnrollmentInfo.recaptchaToken;Object.assign(p,{phoneEnrollmentInfo:{phoneNumber:g,recaptchaToken:y,captchaResponse:d,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in p){const g=p.phoneSignInInfo.recaptchaToken;Object.assign(p,{phoneSignInInfo:{recaptchaToken:g,captchaResponse:d,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return p}return i?Object.assign(p,{captchaResp:d}):Object.assign(p,{captchaResponse:d}),Object.assign(p,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(p,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),p}async function Rh(n,e,t,i,l){if(n._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const u=await X1(n,e,t,t==="getOobCode");return i(n,u)}else return i(n,e).catch(async u=>{if(u.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const d=await X1(n,e,t,t==="getOobCode");return i(n,d)}else return Promise.reject(u)})}function wC(n,e){const t=Qh(n,"auth");if(t.isInitialized()){const l=t.getImmediate(),u=t.getOptions();if(Ho(u,e??{}))return l;ba(l,"already-initialized")}return t.initialize({options:e})}function _C(n,e){const t=e?.persistence||[],i=(Array.isArray(t)?t:[t]).map(li);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(i,e?.popupRedirectResolver)}function kC(n,e,t){const i=po(n);Vt(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const l=!1,u=_w(e),{host:d,port:p}=jC(e),g=p===null?"":`:${p}`,y={url:`${u}//${d}${g}/`},w=Object.freeze({host:d,port:p,protocol:u.replace(":",""),options:Object.freeze({disableWarnings:l})});if(!i._canInitEmulator){Vt(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),Vt(Ho(y,i.config.emulator)&&Ho(w,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=y,i.emulatorConfig=w,i.settings.appVerificationDisabledForTesting=!0,fo(d)?(Vg(`${u}//${d}${g}`),Bg("Auth",!0)):TC()}function _w(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function jC(n){const e=_w(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const i=t[2].split("@").pop()||"",l=/^(\[[^\]]+\])(:|$)/.exec(i);if(l){const u=l[1];return{host:u,port:J1(i.substr(u.length+1))}}else{const[u,d]=i.split(":");return{host:u,port:J1(d)}}}function J1(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function TC(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}class Kg{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return oi("not implemented")}_getIdTokenResponse(e){return oi("not implemented")}_linkToIdToken(e,t){return oi("not implemented")}_getReauthenticationResolver(e){return oi("not implemented")}}async function EC(n,e){return vi(n,"POST","/v1/accounts:signUp",e)}async function NC(n,e){return Au(n,"POST","/v1/accounts:signInWithPassword",bi(n,e))}async function kw(n,e){return vi(n,"POST","/v1/accounts:sendOobCode",bi(n,e))}async function SC(n,e){return kw(n,e)}async function CC(n,e){return kw(n,e)}async function RC(n,e){return Au(n,"POST","/v1/accounts:signInWithEmailLink",bi(n,e))}async function AC(n,e){return Au(n,"POST","/v1/accounts:signInWithEmailLink",bi(n,e))}class gu extends Kg{constructor(e,t,i,l=null){super("password",i),this._email=e,this._password=t,this._tenantId=l}static _fromEmailAndPassword(e,t){return new gu(e,t,"password")}static _fromEmailAndCode(e,t,i=null){return new gu(e,t,"emailLink",i)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Rh(e,t,"signInWithPassword",NC);case"emailLink":return RC(e,{email:this._email,oobCode:this._password});default:ba(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const i={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Rh(e,i,"signUpPassword",EC);case"emailLink":return AC(e,{idToken:t,email:this._email,oobCode:this._password});default:ba(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function Hl(n,e){return Au(n,"POST","/v1/accounts:signInWithIdp",bi(n,e))}const IC="http://localhost";class Wo extends Kg{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Wo(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):ba("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:l,...u}=t;if(!i||!l)return null;const d=new Wo(i,l);return d.idToken=u.idToken||void 0,d.accessToken=u.accessToken||void 0,d.secret=u.secret,d.nonce=u.nonce,d.pendingToken=u.pendingToken||null,d}_getIdTokenResponse(e){const t=this.buildRequest();return Hl(e,t)}_linkToIdToken(e,t){const i=this.buildRequest();return i.idToken=t,Hl(e,i)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Hl(e,t)}buildRequest(){const e={requestUri:IC,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Cu(t)}return e}}function MC(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function DC(n){const e=Jc(Zc(n)).link,t=e?Jc(Zc(e)).deep_link_id:null,i=Jc(Zc(n)).deep_link_id;return(i?Jc(Zc(i)).link:null)||i||t||e||n}class Yg{constructor(e){const t=Jc(Zc(e)),i=t.apiKey??null,l=t.oobCode??null,u=MC(t.mode??null);Vt(i&&l&&u,"argument-error"),this.apiKey=i,this.operation=u,this.code=l,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=DC(e);try{return new Yg(t)}catch{return null}}}class sc{constructor(){this.providerId=sc.PROVIDER_ID}static credential(e,t){return gu._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const i=Yg.parseLink(t);return Vt(i,"argument-error"),gu._fromEmailAndCode(e,i.code,i.tenantId)}}sc.PROVIDER_ID="password";sc.EMAIL_PASSWORD_SIGN_IN_METHOD="password";sc.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class jw{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class Iu extends jw{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Ki extends Iu{constructor(){super("facebook.com")}static credential(e){return Wo._fromParams({providerId:Ki.PROVIDER_ID,signInMethod:Ki.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ki.credentialFromTaggedObject(e)}static credentialFromError(e){return Ki.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ki.credential(e.oauthAccessToken)}catch{return null}}}Ki.FACEBOOK_SIGN_IN_METHOD="facebook.com";Ki.PROVIDER_ID="facebook.com";class Yi extends Iu{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Wo._fromParams({providerId:Yi.PROVIDER_ID,signInMethod:Yi.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Yi.credentialFromTaggedObject(e)}static credentialFromError(e){return Yi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:i}=e;if(!t&&!i)return null;try{return Yi.credential(t,i)}catch{return null}}}Yi.GOOGLE_SIGN_IN_METHOD="google.com";Yi.PROVIDER_ID="google.com";class Qi extends Iu{constructor(){super("github.com")}static credential(e){return Wo._fromParams({providerId:Qi.PROVIDER_ID,signInMethod:Qi.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Qi.credentialFromTaggedObject(e)}static credentialFromError(e){return Qi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Qi.credential(e.oauthAccessToken)}catch{return null}}}Qi.GITHUB_SIGN_IN_METHOD="github.com";Qi.PROVIDER_ID="github.com";class Xi extends Iu{constructor(){super("twitter.com")}static credential(e,t){return Wo._fromParams({providerId:Xi.PROVIDER_ID,signInMethod:Xi.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Xi.credentialFromTaggedObject(e)}static credentialFromError(e){return Xi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:i}=e;if(!t||!i)return null;try{return Xi.credential(t,i)}catch{return null}}}Xi.TWITTER_SIGN_IN_METHOD="twitter.com";Xi.PROVIDER_ID="twitter.com";async function PC(n,e){return Au(n,"POST","/v1/accounts:signUp",bi(n,e))}class Go{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,i,l=!1){const u=await ga._fromIdTokenResponse(e,i,l),d=Z1(i);return new Go({user:u,providerId:d,_tokenResponse:i,operationType:t})}static async _forOperation(e,t,i){await e._updateTokensIfNecessary(i,!0);const l=Z1(i);return new Go({user:e,providerId:l,_tokenResponse:i,operationType:t})}}function Z1(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}class Ah extends qa{constructor(e,t,i,l){super(t.code,t.message),this.operationType=i,this.user=l,Object.setPrototypeOf(this,Ah.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,t,i,l){return new Ah(e,t,i,l)}}function Tw(n,e,t,i){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(u=>{throw u.code==="auth/multi-factor-auth-required"?Ah._fromErrorAndOperation(n,u,e,i):u})}async function LC(n,e,t=!1){const i=await pu(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return Go._forOperation(n,"link",i)}async function OC(n,e,t=!1){const{auth:i}=n;if(qr(i.app))return Promise.reject(ui(i));const l="reauthenticate";try{const u=await pu(n,Tw(i,l,e,n),t);Vt(u.idToken,i,"internal-error");const d=Wg(u.idToken);Vt(d,i,"internal-error");const{sub:p}=d;return Vt(n.uid===p,i,"user-mismatch"),Go._forOperation(n,l,u)}catch(u){throw u?.code==="auth/user-not-found"&&ba(i,"user-mismatch"),u}}async function Ew(n,e,t=!1){if(qr(n.app))return Promise.reject(ui(n));const i="signIn",l=await Tw(n,i,e),u=await Go._fromIdTokenResponse(n,i,l);return t||await n._updateCurrentUser(u.user),u}async function VC(n,e){return Ew(po(n),e)}async function Nw(n){const e=po(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function BC(n,e,t){const i=po(n);await Rh(i,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",CC)}async function UC(n,e,t){if(qr(n.app))return Promise.reject(ui(n));const i=po(n),d=await Rh(i,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",PC).catch(g=>{throw g.code==="auth/password-does-not-meet-requirements"&&Nw(n),g}),p=await Go._fromIdTokenResponse(i,"signIn",d);return await i._updateCurrentUser(p.user),p}function zC(n,e,t){return qr(n.app)?Promise.reject(ui(n)):VC(Ks(n),sc.credential(e,t)).catch(async i=>{throw i.code==="auth/password-does-not-meet-requirements"&&Nw(n),i})}async function EP(n,e){const t=Ks(n),l={requestType:"VERIFY_EMAIL",idToken:await n.getIdToken()},{email:u}=await SC(t.auth,l);u!==n.email&&await n.reload()}function ex(n,e){return Ks(n).setPersistence(e)}function FC(n,e,t,i){return Ks(n).onIdTokenChanged(e,t,i)}function qC(n,e,t){return Ks(n).beforeAuthStateChanged(e,t)}function HC(n,e,t,i){return Ks(n).onAuthStateChanged(e,t,i)}function $C(n){return Ks(n).signOut()}const Ih="__sak";class Sw{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Ih,"1"),this.storage.removeItem(Ih),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const WC=1e3,GC=10;class Cw extends Sw{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=bw(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const i=this.storage.getItem(t),l=this.localCache[t];i!==l&&e(t,l,i)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((d,p,g)=>{this.notifyListeners(d,g)});return}const i=e.key;t?this.detachListener():this.stopPolling();const l=()=>{const d=this.storage.getItem(i);!t&&this.localCache[i]===d||this.notifyListeners(i,d)},u=this.storage.getItem(i);oC()&&u!==e.newValue&&e.newValue!==e.oldValue?setTimeout(l,GC):l()}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const l of Array.from(i))l(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:i}),!0)})},WC)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}Cw.type="LOCAL";const ug=Cw;class Rw extends Sw{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}Rw.type="SESSION";const Qg=Rw;function KC(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class Jh{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(l=>l.isListeningto(e));if(t)return t;const i=new Jh(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:i,eventType:l,data:u}=t.data,d=this.handlersMap[l];if(!d?.size)return;t.ports[0].postMessage({status:"ack",eventId:i,eventType:l});const p=Array.from(d).map(async y=>y(t.origin,u)),g=await KC(p);t.ports[0].postMessage({status:"done",eventId:i,eventType:l,response:g})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Jh.receivers=[];function Xg(n="",e=10){let t="";for(let i=0;i<e;i++)t+=Math.floor(Math.random()*10);return n+t}class YC{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,i=50){const l=typeof MessageChannel<"u"?new MessageChannel:null;if(!l)throw new Error("connection_unavailable");let u,d;return new Promise((p,g)=>{const y=Xg("",20);l.port1.start();const w=setTimeout(()=>{g(new Error("unsupported_event"))},i);d={messageChannel:l,onMessage(k){const j=k;if(j.data.eventId===y)switch(j.data.status){case"ack":clearTimeout(w),u=setTimeout(()=>{g(new Error("timeout"))},3e3);break;case"done":clearTimeout(u),p(j.data.response);break;default:clearTimeout(w),clearTimeout(u),g(new Error("invalid_response"));break}}},this.handlers.add(d),l.port1.addEventListener("message",d.onMessage),this.target.postMessage({eventType:e,eventId:y,data:t},[l.port2])}).finally(()=>{d&&this.removeMessageHandler(d)})}}function Oa(){return window}function QC(n){Oa().location.href=n}function Aw(){return typeof Oa().WorkerGlobalScope<"u"&&typeof Oa().importScripts=="function"}async function XC(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function JC(){return navigator?.serviceWorker?.controller||null}function ZC(){return Aw()?self:null}const Iw="firebaseLocalStorageDb",e4=1,Mh="firebaseLocalStorage",Mw="fbase_key";class Mu{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Zh(n,e){return n.transaction([Mh],e?"readwrite":"readonly").objectStore(Mh)}function t4(){const n=indexedDB.deleteDatabase(Iw);return new Mu(n).toPromise()}function dg(){const n=indexedDB.open(Iw,e4);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const i=n.result;try{i.createObjectStore(Mh,{keyPath:Mw})}catch(l){t(l)}}),n.addEventListener("success",async()=>{const i=n.result;i.objectStoreNames.contains(Mh)?e(i):(i.close(),await t4(),e(await dg()))})})}async function tx(n,e,t){const i=Zh(n,!0).put({[Mw]:e,value:t});return new Mu(i).toPromise()}async function s4(n,e){const t=Zh(n,!1).get(e),i=await new Mu(t).toPromise();return i===void 0?null:i.value}function sx(n,e){const t=Zh(n,!0).delete(e);return new Mu(t).toPromise()}const n4=800,r4=3;class Dw{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await dg(),this.db)}async _withRetries(e){let t=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(i){if(t++>r4)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Aw()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Jh._getInstance(ZC()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await XC(),!this.activeServiceWorker)return;this.sender=new YC(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||JC()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await dg();return await tx(e,Ih,"1"),await sx(e,Ih),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(i=>tx(i,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(i=>s4(i,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>sx(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(l=>{const u=Zh(l,!1).getAll();return new Mu(u).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],i=new Set;if(e.length!==0)for(const{fbase_key:l,value:u}of e)i.add(l),JSON.stringify(this.localCache[l])!==JSON.stringify(u)&&(this.notifyListeners(l,u),t.push(l));for(const l of Object.keys(this.localCache))this.localCache[l]&&!i.has(l)&&(this.notifyListeners(l,null),t.push(l));return t}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const l of Array.from(i))l(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),n4)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}Dw.type="LOCAL";const a4=Dw;new Ru(3e4,6e4);function i4(n,e){return e?li(e):(Vt(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}class Jg extends Kg{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Hl(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Hl(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Hl(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function o4(n){return Ew(n.auth,new Jg(n),n.bypassAuthState)}function l4(n){const{auth:e,user:t}=n;return Vt(t,e,"internal-error"),OC(t,new Jg(n),n.bypassAuthState)}async function c4(n){const{auth:e,user:t}=n;return Vt(t,e,"internal-error"),LC(t,new Jg(n),n.bypassAuthState)}class Pw{constructor(e,t,i,l,u=!1){this.auth=e,this.resolver=i,this.user=l,this.bypassAuthState=u,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:i,postBody:l,tenantId:u,error:d,type:p}=e;if(d){this.reject(d);return}const g={auth:this.auth,requestUri:t,sessionId:i,tenantId:u||void 0,postBody:l||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(p)(g))}catch(y){this.reject(y)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return o4;case"linkViaPopup":case"linkViaRedirect":return c4;case"reauthViaPopup":case"reauthViaRedirect":return l4;default:ba(this.auth,"internal-error")}}resolve(e){pi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){pi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const u4=new Ru(2e3,1e4);class zl extends Pw{constructor(e,t,i,l,u){super(e,t,l,u),this.provider=i,this.authWindow=null,this.pollId=null,zl.currentPopupAction&&zl.currentPopupAction.cancel(),zl.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Vt(e,this.auth,"internal-error"),e}async onExecution(){pi(this.filter.length===1,"Popup operations only handle one event");const e=Xg();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(La(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(La(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,zl.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(La(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,u4.get())};e()}}zl.currentPopupAction=null;const d4="pendingRedirect",gh=new Map;class h4 extends Pw{constructor(e,t,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,i),this.eventId=null}async execute(){let e=gh.get(this.auth._key());if(!e){try{const i=await m4(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(t){e=()=>Promise.reject(t)}gh.set(this.auth._key(),e)}return this.bypassAuthState||gh.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function m4(n,e){const t=g4(e),i=p4(n);if(!await i._isAvailable())return!1;const l=await i._get(t)==="true";return await i._remove(t),l}function f4(n,e){gh.set(n._key(),e)}function p4(n){return li(n._redirectPersistence)}function g4(n){return ph(d4,n.config.apiKey,n.name)}async function y4(n,e,t=!1){if(qr(n.app))return Promise.reject(ui(n));const i=po(n),l=i4(i,e),d=await new h4(i,l,t).execute();return d&&!t&&(delete d.user._redirectEventId,await i._persistUserIfCurrent(d.user),await i._setRedirectUser(null,e)),d}const b4=600*1e3;class v4{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(t=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!x4(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!Lw(e)){const i=e.error.code?.split("auth/")[1]||"internal-error";t.onError(La(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const i=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=b4&&this.cachedEventUids.clear(),this.cachedEventUids.has(nx(e))}saveEventToCache(e){this.cachedEventUids.add(nx(e)),this.lastProcessedEventTime=Date.now()}}function nx(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function Lw({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function x4(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Lw(n);default:return!1}}async function w4(n,e={}){return vi(n,"GET","/v1/projects",e)}const _4=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,k4=/^https?/;async function j4(n){if(n.config.emulator)return;const{authorizedDomains:e}=await w4(n);for(const t of e)try{if(T4(t))return}catch{}ba(n,"unauthorized-domain")}function T4(n){const e=lg(),{protocol:t,hostname:i}=new URL(e);if(n.startsWith("chrome-extension://")){const d=new URL(n);return d.hostname===""&&i===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&d.hostname===i}if(!k4.test(t))return!1;if(_4.test(n))return i===n;const l=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+l+"|"+l+")$","i").test(i)}const E4=new Ru(3e4,6e4);function rx(){const n=Oa().___jsl;if(n?.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function N4(n){return new Promise((e,t)=>{function i(){rx(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{rx(),t(La(n,"network-request-failed"))},timeout:E4.get()})}if(Oa().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(Oa().gapi?.load)i();else{const l=gC("iframefcb");return Oa()[l]=()=>{gapi.load?i():t(La(n,"network-request-failed"))},xw(`${pC()}?onload=${l}`).catch(u=>t(u))}}).catch(e=>{throw yh=null,e})}let yh=null;function S4(n){return yh=yh||N4(n),yh}const C4=new Ru(5e3,15e3),R4="__/auth/iframe",A4="emulator/auth/iframe",I4={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},M4=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function D4(n){const e=n.config;Vt(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?$g(e,A4):`https://${n.config.authDomain}/${R4}`,i={apiKey:e.apiKey,appName:n.name,v:Jo},l=M4.get(n.config.apiHost);l&&(i.eid=l);const u=n._getFrameworks();return u.length&&(i.fw=u.join(",")),`${t}?${Cu(i).slice(1)}`}async function P4(n){const e=await S4(n),t=Oa().gapi;return Vt(t,n,"internal-error"),e.open({where:document.body,url:D4(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:I4,dontclear:!0},i=>new Promise(async(l,u)=>{await i.restyle({setHideOnLeave:!1});const d=La(n,"network-request-failed"),p=Oa().setTimeout(()=>{u(d)},C4.get());function g(){Oa().clearTimeout(p),l(i)}i.ping(g).then(g,()=>{u(d)})}))}const L4={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},O4=500,V4=600,B4="_blank",U4="http://localhost";class ax{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function z4(n,e,t,i=O4,l=V4){const u=Math.max((window.screen.availHeight-l)/2,0).toString(),d=Math.max((window.screen.availWidth-i)/2,0).toString();let p="";const g={...L4,width:i.toString(),height:l.toString(),top:u,left:d},y=cr().toLowerCase();t&&(p=mw(y)?B4:t),dw(y)&&(e=e||U4,g.scrollbars="yes");const w=Object.entries(g).reduce((j,[O,H])=>`${j}${O}=${H},`,"");if(iC(y)&&p!=="_self")return F4(e||"",p),new ax(null);const k=window.open(e||"",p,w);Vt(k,n,"popup-blocked");try{k.focus()}catch{}return new ax(k)}function F4(n,e){const t=document.createElement("a");t.href=n,t.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(i)}const q4="__/auth/handler",H4="emulator/auth/handler",$4=encodeURIComponent("fac");async function ix(n,e,t,i,l,u){Vt(n.config.authDomain,n,"auth-domain-config-required"),Vt(n.config.apiKey,n,"invalid-api-key");const d={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:i,v:Jo,eventId:l};if(e instanceof jw){e.setDefaultLanguage(n.languageCode),d.providerId=e.providerId||"",SN(e.getCustomParameters())||(d.customParameters=JSON.stringify(e.getCustomParameters()));for(const[w,k]of Object.entries({}))d[w]=k}if(e instanceof Iu){const w=e.getScopes().filter(k=>k!=="");w.length>0&&(d.scopes=w.join(","))}n.tenantId&&(d.tid=n.tenantId);const p=d;for(const w of Object.keys(p))p[w]===void 0&&delete p[w];const g=await n._getAppCheckToken(),y=g?`#${$4}=${encodeURIComponent(g)}`:"";return`${W4(n)}?${Cu(p).slice(1)}${y}`}function W4({config:n}){return n.emulator?$g(n,H4):`https://${n.authDomain}/${q4}`}const Cp="webStorageSupport";class G4{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Qg,this._completeRedirectFn=y4,this._overrideRedirectResult=f4}async _openPopup(e,t,i,l){pi(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const u=await ix(e,t,i,lg(),l);return z4(e,u,Xg())}async _openRedirect(e,t,i,l){await this._originValidation(e);const u=await ix(e,t,i,lg(),l);return QC(u),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:l,promise:u}=this.eventManagers[t];return l?Promise.resolve(l):(pi(u,"If manager is not set, promise should be"),u)}const i=this.initAndGetManager(e);return this.eventManagers[t]={promise:i},i.catch(()=>{delete this.eventManagers[t]}),i}async initAndGetManager(e){const t=await P4(e),i=new v4(e);return t.register("authEvent",l=>(Vt(l?.authEvent,e,"invalid-auth-event"),{status:i.onEvent(l.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=t,i}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Cp,{type:Cp},l=>{const u=l?.[0]?.[Cp];u!==void 0&&t(!!u),ba(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=j4(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return bw()||hw()||Gg()}}const K4=G4;var ox="@firebase/auth",lx="1.12.0";class Y4{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(i=>{e(i?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Vt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function Q4(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function X4(n){$o(new io("auth",(e,{options:t})=>{const i=e.getProvider("app").getImmediate(),l=e.getProvider("heartbeat"),u=e.getProvider("app-check-internal"),{apiKey:d,authDomain:p}=i.options;Vt(d&&!d.includes(":"),"invalid-api-key",{appName:i.name});const g={apiKey:d,authDomain:p,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:vw(n)},y=new hC(i,l,u,g);return _C(y,t),y},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,i)=>{e.getProvider("auth-internal").initialize()})),$o(new io("auth-internal",e=>{const t=po(e.getProvider("auth").getImmediate());return(i=>new Y4(i))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Pa(ox,lx,Q4(n)),Pa(ox,lx,"esm2020")}const J4=300,Z4=X2("authIdTokenMaxAge")||J4;let cx=null;const eR=n=>async e=>{const t=e&&await e.getIdTokenResult(),i=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(i&&i>Z4)return;const l=t?.token;cx!==l&&(cx=l,await fetch(n,{method:l?"POST":"DELETE",headers:l?{Authorization:`Bearer ${l}`}:{}}))};function Ow(n=qg()){const e=Qh(n,"auth");if(e.isInitialized())return e.getImmediate();const t=wC(n,{popupRedirectResolver:K4,persistence:[a4,ug,Qg]}),i=X2("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const u=new URL(i,location.origin);if(location.origin===u.origin){const d=eR(u.toString());qC(t,d,()=>d(t.currentUser)),FC(t,p=>d(p))}}const l=K2("auth");return l&&kC(t,`http://${l}`),t}function tR(){return document.getElementsByTagName("head")?.[0]??document}mC({loadJS(n){return new Promise((e,t)=>{const i=document.createElement("script");i.setAttribute("src",n),i.onload=e,i.onerror=l=>{const u=La("internal-error");u.customData=l,t(u)},i.type="text/javascript",i.charset="UTF-8",tR().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});X4("Browser");var ux=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var ro,Vw;(function(){var n;function e(R,T){function A(){}A.prototype=T.prototype,R.F=T.prototype,R.prototype=new A,R.prototype.constructor=R,R.D=function(L,D,z){for(var M=Array(arguments.length-2),Ge=2;Ge<arguments.length;Ge++)M[Ge-2]=arguments[Ge];return T.prototype[D].apply(L,M)}}function t(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(i,t),i.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function l(R,T,A){A||(A=0);const L=Array(16);if(typeof T=="string")for(var D=0;D<16;++D)L[D]=T.charCodeAt(A++)|T.charCodeAt(A++)<<8|T.charCodeAt(A++)<<16|T.charCodeAt(A++)<<24;else for(D=0;D<16;++D)L[D]=T[A++]|T[A++]<<8|T[A++]<<16|T[A++]<<24;T=R.g[0],A=R.g[1],D=R.g[2];let z=R.g[3],M;M=T+(z^A&(D^z))+L[0]+3614090360&4294967295,T=A+(M<<7&4294967295|M>>>25),M=z+(D^T&(A^D))+L[1]+3905402710&4294967295,z=T+(M<<12&4294967295|M>>>20),M=D+(A^z&(T^A))+L[2]+606105819&4294967295,D=z+(M<<17&4294967295|M>>>15),M=A+(T^D&(z^T))+L[3]+3250441966&4294967295,A=D+(M<<22&4294967295|M>>>10),M=T+(z^A&(D^z))+L[4]+4118548399&4294967295,T=A+(M<<7&4294967295|M>>>25),M=z+(D^T&(A^D))+L[5]+1200080426&4294967295,z=T+(M<<12&4294967295|M>>>20),M=D+(A^z&(T^A))+L[6]+2821735955&4294967295,D=z+(M<<17&4294967295|M>>>15),M=A+(T^D&(z^T))+L[7]+4249261313&4294967295,A=D+(M<<22&4294967295|M>>>10),M=T+(z^A&(D^z))+L[8]+1770035416&4294967295,T=A+(M<<7&4294967295|M>>>25),M=z+(D^T&(A^D))+L[9]+2336552879&4294967295,z=T+(M<<12&4294967295|M>>>20),M=D+(A^z&(T^A))+L[10]+4294925233&4294967295,D=z+(M<<17&4294967295|M>>>15),M=A+(T^D&(z^T))+L[11]+2304563134&4294967295,A=D+(M<<22&4294967295|M>>>10),M=T+(z^A&(D^z))+L[12]+1804603682&4294967295,T=A+(M<<7&4294967295|M>>>25),M=z+(D^T&(A^D))+L[13]+4254626195&4294967295,z=T+(M<<12&4294967295|M>>>20),M=D+(A^z&(T^A))+L[14]+2792965006&4294967295,D=z+(M<<17&4294967295|M>>>15),M=A+(T^D&(z^T))+L[15]+1236535329&4294967295,A=D+(M<<22&4294967295|M>>>10),M=T+(D^z&(A^D))+L[1]+4129170786&4294967295,T=A+(M<<5&4294967295|M>>>27),M=z+(A^D&(T^A))+L[6]+3225465664&4294967295,z=T+(M<<9&4294967295|M>>>23),M=D+(T^A&(z^T))+L[11]+643717713&4294967295,D=z+(M<<14&4294967295|M>>>18),M=A+(z^T&(D^z))+L[0]+3921069994&4294967295,A=D+(M<<20&4294967295|M>>>12),M=T+(D^z&(A^D))+L[5]+3593408605&4294967295,T=A+(M<<5&4294967295|M>>>27),M=z+(A^D&(T^A))+L[10]+38016083&4294967295,z=T+(M<<9&4294967295|M>>>23),M=D+(T^A&(z^T))+L[15]+3634488961&4294967295,D=z+(M<<14&4294967295|M>>>18),M=A+(z^T&(D^z))+L[4]+3889429448&4294967295,A=D+(M<<20&4294967295|M>>>12),M=T+(D^z&(A^D))+L[9]+568446438&4294967295,T=A+(M<<5&4294967295|M>>>27),M=z+(A^D&(T^A))+L[14]+3275163606&4294967295,z=T+(M<<9&4294967295|M>>>23),M=D+(T^A&(z^T))+L[3]+4107603335&4294967295,D=z+(M<<14&4294967295|M>>>18),M=A+(z^T&(D^z))+L[8]+1163531501&4294967295,A=D+(M<<20&4294967295|M>>>12),M=T+(D^z&(A^D))+L[13]+2850285829&4294967295,T=A+(M<<5&4294967295|M>>>27),M=z+(A^D&(T^A))+L[2]+4243563512&4294967295,z=T+(M<<9&4294967295|M>>>23),M=D+(T^A&(z^T))+L[7]+1735328473&4294967295,D=z+(M<<14&4294967295|M>>>18),M=A+(z^T&(D^z))+L[12]+2368359562&4294967295,A=D+(M<<20&4294967295|M>>>12),M=T+(A^D^z)+L[5]+4294588738&4294967295,T=A+(M<<4&4294967295|M>>>28),M=z+(T^A^D)+L[8]+2272392833&4294967295,z=T+(M<<11&4294967295|M>>>21),M=D+(z^T^A)+L[11]+1839030562&4294967295,D=z+(M<<16&4294967295|M>>>16),M=A+(D^z^T)+L[14]+4259657740&4294967295,A=D+(M<<23&4294967295|M>>>9),M=T+(A^D^z)+L[1]+2763975236&4294967295,T=A+(M<<4&4294967295|M>>>28),M=z+(T^A^D)+L[4]+1272893353&4294967295,z=T+(M<<11&4294967295|M>>>21),M=D+(z^T^A)+L[7]+4139469664&4294967295,D=z+(M<<16&4294967295|M>>>16),M=A+(D^z^T)+L[10]+3200236656&4294967295,A=D+(M<<23&4294967295|M>>>9),M=T+(A^D^z)+L[13]+681279174&4294967295,T=A+(M<<4&4294967295|M>>>28),M=z+(T^A^D)+L[0]+3936430074&4294967295,z=T+(M<<11&4294967295|M>>>21),M=D+(z^T^A)+L[3]+3572445317&4294967295,D=z+(M<<16&4294967295|M>>>16),M=A+(D^z^T)+L[6]+76029189&4294967295,A=D+(M<<23&4294967295|M>>>9),M=T+(A^D^z)+L[9]+3654602809&4294967295,T=A+(M<<4&4294967295|M>>>28),M=z+(T^A^D)+L[12]+3873151461&4294967295,z=T+(M<<11&4294967295|M>>>21),M=D+(z^T^A)+L[15]+530742520&4294967295,D=z+(M<<16&4294967295|M>>>16),M=A+(D^z^T)+L[2]+3299628645&4294967295,A=D+(M<<23&4294967295|M>>>9),M=T+(D^(A|~z))+L[0]+4096336452&4294967295,T=A+(M<<6&4294967295|M>>>26),M=z+(A^(T|~D))+L[7]+1126891415&4294967295,z=T+(M<<10&4294967295|M>>>22),M=D+(T^(z|~A))+L[14]+2878612391&4294967295,D=z+(M<<15&4294967295|M>>>17),M=A+(z^(D|~T))+L[5]+4237533241&4294967295,A=D+(M<<21&4294967295|M>>>11),M=T+(D^(A|~z))+L[12]+1700485571&4294967295,T=A+(M<<6&4294967295|M>>>26),M=z+(A^(T|~D))+L[3]+2399980690&4294967295,z=T+(M<<10&4294967295|M>>>22),M=D+(T^(z|~A))+L[10]+4293915773&4294967295,D=z+(M<<15&4294967295|M>>>17),M=A+(z^(D|~T))+L[1]+2240044497&4294967295,A=D+(M<<21&4294967295|M>>>11),M=T+(D^(A|~z))+L[8]+1873313359&4294967295,T=A+(M<<6&4294967295|M>>>26),M=z+(A^(T|~D))+L[15]+4264355552&4294967295,z=T+(M<<10&4294967295|M>>>22),M=D+(T^(z|~A))+L[6]+2734768916&4294967295,D=z+(M<<15&4294967295|M>>>17),M=A+(z^(D|~T))+L[13]+1309151649&4294967295,A=D+(M<<21&4294967295|M>>>11),M=T+(D^(A|~z))+L[4]+4149444226&4294967295,T=A+(M<<6&4294967295|M>>>26),M=z+(A^(T|~D))+L[11]+3174756917&4294967295,z=T+(M<<10&4294967295|M>>>22),M=D+(T^(z|~A))+L[2]+718787259&4294967295,D=z+(M<<15&4294967295|M>>>17),M=A+(z^(D|~T))+L[9]+3951481745&4294967295,R.g[0]=R.g[0]+T&4294967295,R.g[1]=R.g[1]+(D+(M<<21&4294967295|M>>>11))&4294967295,R.g[2]=R.g[2]+D&4294967295,R.g[3]=R.g[3]+z&4294967295}i.prototype.v=function(R,T){T===void 0&&(T=R.length);const A=T-this.blockSize,L=this.C;let D=this.h,z=0;for(;z<T;){if(D==0)for(;z<=A;)l(this,R,z),z+=this.blockSize;if(typeof R=="string"){for(;z<T;)if(L[D++]=R.charCodeAt(z++),D==this.blockSize){l(this,L),D=0;break}}else for(;z<T;)if(L[D++]=R[z++],D==this.blockSize){l(this,L),D=0;break}}this.h=D,this.o+=T},i.prototype.A=function(){var R=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);R[0]=128;for(var T=1;T<R.length-8;++T)R[T]=0;T=this.o*8;for(var A=R.length-8;A<R.length;++A)R[A]=T&255,T/=256;for(this.v(R),R=Array(16),T=0,A=0;A<4;++A)for(let L=0;L<32;L+=8)R[T++]=this.g[A]>>>L&255;return R};function u(R,T){var A=p;return Object.prototype.hasOwnProperty.call(A,R)?A[R]:A[R]=T(R)}function d(R,T){this.h=T;const A=[];let L=!0;for(let D=R.length-1;D>=0;D--){const z=R[D]|0;L&&z==T||(A[D]=z,L=!1)}this.g=A}var p={};function g(R){return-128<=R&&R<128?u(R,function(T){return new d([T|0],T<0?-1:0)}):new d([R|0],R<0?-1:0)}function y(R){if(isNaN(R)||!isFinite(R))return k;if(R<0)return V(y(-R));const T=[];let A=1;for(let L=0;R>=A;L++)T[L]=R/A|0,A*=4294967296;return new d(T,0)}function w(R,T){if(R.length==0)throw Error("number format error: empty string");if(T=T||10,T<2||36<T)throw Error("radix out of range: "+T);if(R.charAt(0)=="-")return V(w(R.substring(1),T));if(R.indexOf("-")>=0)throw Error('number format error: interior "-" character');const A=y(Math.pow(T,8));let L=k;for(let z=0;z<R.length;z+=8){var D=Math.min(8,R.length-z);const M=parseInt(R.substring(z,z+D),T);D<8?(D=y(Math.pow(T,D)),L=L.j(D).add(y(M))):(L=L.j(A),L=L.add(y(M)))}return L}var k=g(0),j=g(1),O=g(16777216);n=d.prototype,n.m=function(){if(B(this))return-V(this).m();let R=0,T=1;for(let A=0;A<this.g.length;A++){const L=this.i(A);R+=(L>=0?L:4294967296+L)*T,T*=4294967296}return R},n.toString=function(R){if(R=R||10,R<2||36<R)throw Error("radix out of range: "+R);if(H(this))return"0";if(B(this))return"-"+V(this).toString(R);const T=y(Math.pow(R,6));var A=this;let L="";for(;;){const D=ye(A,T).g;A=se(A,D.j(T));let z=((A.g.length>0?A.g[0]:A.h)>>>0).toString(R);if(A=D,H(A))return z+L;for(;z.length<6;)z="0"+z;L=z+L}},n.i=function(R){return R<0?0:R<this.g.length?this.g[R]:this.h};function H(R){if(R.h!=0)return!1;for(let T=0;T<R.g.length;T++)if(R.g[T]!=0)return!1;return!0}function B(R){return R.h==-1}n.l=function(R){return R=se(this,R),B(R)?-1:H(R)?0:1};function V(R){const T=R.g.length,A=[];for(let L=0;L<T;L++)A[L]=~R.g[L];return new d(A,~R.h).add(j)}n.abs=function(){return B(this)?V(this):this},n.add=function(R){const T=Math.max(this.g.length,R.g.length),A=[];let L=0;for(let D=0;D<=T;D++){let z=L+(this.i(D)&65535)+(R.i(D)&65535),M=(z>>>16)+(this.i(D)>>>16)+(R.i(D)>>>16);L=M>>>16,z&=65535,M&=65535,A[D]=M<<16|z}return new d(A,A[A.length-1]&-2147483648?-1:0)};function se(R,T){return R.add(V(T))}n.j=function(R){if(H(this)||H(R))return k;if(B(this))return B(R)?V(this).j(V(R)):V(V(this).j(R));if(B(R))return V(this.j(V(R)));if(this.l(O)<0&&R.l(O)<0)return y(this.m()*R.m());const T=this.g.length+R.g.length,A=[];for(var L=0;L<2*T;L++)A[L]=0;for(L=0;L<this.g.length;L++)for(let D=0;D<R.g.length;D++){const z=this.i(L)>>>16,M=this.i(L)&65535,Ge=R.i(D)>>>16,mt=R.i(D)&65535;A[2*L+2*D]+=M*mt,K(A,2*L+2*D),A[2*L+2*D+1]+=z*mt,K(A,2*L+2*D+1),A[2*L+2*D+1]+=M*Ge,K(A,2*L+2*D+1),A[2*L+2*D+2]+=z*Ge,K(A,2*L+2*D+2)}for(R=0;R<T;R++)A[R]=A[2*R+1]<<16|A[2*R];for(R=T;R<2*T;R++)A[R]=0;return new d(A,0)};function K(R,T){for(;(R[T]&65535)!=R[T];)R[T+1]+=R[T]>>>16,R[T]&=65535,T++}function oe(R,T){this.g=R,this.h=T}function ye(R,T){if(H(T))throw Error("division by zero");if(H(R))return new oe(k,k);if(B(R))return T=ye(V(R),T),new oe(V(T.g),V(T.h));if(B(T))return T=ye(R,V(T)),new oe(V(T.g),T.h);if(R.g.length>30){if(B(R)||B(T))throw Error("slowDivide_ only works with positive integers.");for(var A=j,L=T;L.l(R)<=0;)A=Pe(A),L=Pe(L);var D=Ee(A,1),z=Ee(L,1);for(L=Ee(L,2),A=Ee(A,2);!H(L);){var M=z.add(L);M.l(R)<=0&&(D=D.add(A),z=M),L=Ee(L,1),A=Ee(A,1)}return T=se(R,D.j(T)),new oe(D,T)}for(D=k;R.l(T)>=0;){for(A=Math.max(1,Math.floor(R.m()/T.m())),L=Math.ceil(Math.log(A)/Math.LN2),L=L<=48?1:Math.pow(2,L-48),z=y(A),M=z.j(T);B(M)||M.l(R)>0;)A-=L,z=y(A),M=z.j(T);H(z)&&(z=j),D=D.add(z),R=se(R,M)}return new oe(D,R)}n.B=function(R){return ye(this,R).h},n.and=function(R){const T=Math.max(this.g.length,R.g.length),A=[];for(let L=0;L<T;L++)A[L]=this.i(L)&R.i(L);return new d(A,this.h&R.h)},n.or=function(R){const T=Math.max(this.g.length,R.g.length),A=[];for(let L=0;L<T;L++)A[L]=this.i(L)|R.i(L);return new d(A,this.h|R.h)},n.xor=function(R){const T=Math.max(this.g.length,R.g.length),A=[];for(let L=0;L<T;L++)A[L]=this.i(L)^R.i(L);return new d(A,this.h^R.h)};function Pe(R){const T=R.g.length+1,A=[];for(let L=0;L<T;L++)A[L]=R.i(L)<<1|R.i(L-1)>>>31;return new d(A,R.h)}function Ee(R,T){const A=T>>5;T%=32;const L=R.g.length-A,D=[];for(let z=0;z<L;z++)D[z]=T>0?R.i(z+A)>>>T|R.i(z+A+1)<<32-T:R.i(z+A);return new d(D,R.h)}i.prototype.digest=i.prototype.A,i.prototype.reset=i.prototype.u,i.prototype.update=i.prototype.v,Vw=i,d.prototype.add=d.prototype.add,d.prototype.multiply=d.prototype.j,d.prototype.modulo=d.prototype.B,d.prototype.compare=d.prototype.l,d.prototype.toNumber=d.prototype.m,d.prototype.toString=d.prototype.toString,d.prototype.getBits=d.prototype.i,d.fromNumber=y,d.fromString=w,ro=d}).apply(typeof ux<"u"?ux:typeof self<"u"?self:typeof window<"u"?window:{});var eh=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var Bw,eu,Uw,bh,hg,zw,Fw,qw;(function(){var n,e=Object.defineProperty;function t(h){h=[typeof globalThis=="object"&&globalThis,h,typeof window=="object"&&window,typeof self=="object"&&self,typeof eh=="object"&&eh];for(var b=0;b<h.length;++b){var _=h[b];if(_&&_.Math==Math)return _}throw Error("Cannot find global object")}var i=t(this);function l(h,b){if(b)e:{var _=i;h=h.split(".");for(var C=0;C<h.length-1;C++){var ne=h[C];if(!(ne in _))break e;_=_[ne]}h=h[h.length-1],C=_[h],b=b(C),b!=C&&b!=null&&e(_,h,{configurable:!0,writable:!0,value:b})}}l("Symbol.dispose",function(h){return h||Symbol("Symbol.dispose")}),l("Array.prototype.values",function(h){return h||function(){return this[Symbol.iterator]()}}),l("Object.entries",function(h){return h||function(b){var _=[],C;for(C in b)Object.prototype.hasOwnProperty.call(b,C)&&_.push([C,b[C]]);return _}});var u=u||{},d=this||self;function p(h){var b=typeof h;return b=="object"&&h!=null||b=="function"}function g(h,b,_){return h.call.apply(h.bind,arguments)}function y(h,b,_){return y=g,y.apply(null,arguments)}function w(h,b){var _=Array.prototype.slice.call(arguments,1);return function(){var C=_.slice();return C.push.apply(C,arguments),h.apply(this,C)}}function k(h,b){function _(){}_.prototype=b.prototype,h.Z=b.prototype,h.prototype=new _,h.prototype.constructor=h,h.Ob=function(C,ne,de){for(var Je=Array(arguments.length-2),es=2;es<arguments.length;es++)Je[es-2]=arguments[es];return b.prototype[ne].apply(C,Je)}}var j=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?h=>h&&AsyncContext.Snapshot.wrap(h):h=>h;function O(h){const b=h.length;if(b>0){const _=Array(b);for(let C=0;C<b;C++)_[C]=h[C];return _}return[]}function H(h,b){for(let C=1;C<arguments.length;C++){const ne=arguments[C];var _=typeof ne;if(_=_!="object"?_:ne?Array.isArray(ne)?"array":_:"null",_=="array"||_=="object"&&typeof ne.length=="number"){_=h.length||0;const de=ne.length||0;h.length=_+de;for(let Je=0;Je<de;Je++)h[_+Je]=ne[Je]}else h.push(ne)}}class B{constructor(b,_){this.i=b,this.j=_,this.h=0,this.g=null}get(){let b;return this.h>0?(this.h--,b=this.g,this.g=b.next,b.next=null):b=this.i(),b}}function V(h){d.setTimeout(()=>{throw h},0)}function se(){var h=R;let b=null;return h.g&&(b=h.g,h.g=h.g.next,h.g||(h.h=null),b.next=null),b}class K{constructor(){this.h=this.g=null}add(b,_){const C=oe.get();C.set(b,_),this.h?this.h.next=C:this.g=C,this.h=C}}var oe=new B(()=>new ye,h=>h.reset());class ye{constructor(){this.next=this.g=this.h=null}set(b,_){this.h=b,this.g=_,this.next=null}reset(){this.next=this.g=this.h=null}}let Pe,Ee=!1,R=new K,T=()=>{const h=Promise.resolve(void 0);Pe=()=>{h.then(A)}};function A(){for(var h;h=se();){try{h.h.call(h.g)}catch(_){V(_)}var b=oe;b.j(h),b.h<100&&(b.h++,h.next=b.g,b.g=h)}Ee=!1}function L(){this.u=this.u,this.C=this.C}L.prototype.u=!1,L.prototype.dispose=function(){this.u||(this.u=!0,this.N())},L.prototype[Symbol.dispose]=function(){this.dispose()},L.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function D(h,b){this.type=h,this.g=this.target=b,this.defaultPrevented=!1}D.prototype.h=function(){this.defaultPrevented=!0};var z=(function(){if(!d.addEventListener||!Object.defineProperty)return!1;var h=!1,b=Object.defineProperty({},"passive",{get:function(){h=!0}});try{const _=()=>{};d.addEventListener("test",_,b),d.removeEventListener("test",_,b)}catch{}return h})();function M(h){return/^[\s\xa0]*$/.test(h)}function Ge(h,b){D.call(this,h?h.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,h&&this.init(h,b)}k(Ge,D),Ge.prototype.init=function(h,b){const _=this.type=h.type,C=h.changedTouches&&h.changedTouches.length?h.changedTouches[0]:null;this.target=h.target||h.srcElement,this.g=b,b=h.relatedTarget,b||(_=="mouseover"?b=h.fromElement:_=="mouseout"&&(b=h.toElement)),this.relatedTarget=b,C?(this.clientX=C.clientX!==void 0?C.clientX:C.pageX,this.clientY=C.clientY!==void 0?C.clientY:C.pageY,this.screenX=C.screenX||0,this.screenY=C.screenY||0):(this.clientX=h.clientX!==void 0?h.clientX:h.pageX,this.clientY=h.clientY!==void 0?h.clientY:h.pageY,this.screenX=h.screenX||0,this.screenY=h.screenY||0),this.button=h.button,this.key=h.key||"",this.ctrlKey=h.ctrlKey,this.altKey=h.altKey,this.shiftKey=h.shiftKey,this.metaKey=h.metaKey,this.pointerId=h.pointerId||0,this.pointerType=h.pointerType,this.state=h.state,this.i=h,h.defaultPrevented&&Ge.Z.h.call(this)},Ge.prototype.h=function(){Ge.Z.h.call(this);const h=this.i;h.preventDefault?h.preventDefault():h.returnValue=!1};var mt="closure_listenable_"+(Math.random()*1e6|0),$=0;function pe(h,b,_,C,ne){this.listener=h,this.proxy=null,this.src=b,this.type=_,this.capture=!!C,this.ha=ne,this.key=++$,this.da=this.fa=!1}function Me(h){h.da=!0,h.listener=null,h.proxy=null,h.src=null,h.ha=null}function Qe(h,b,_){for(const C in h)b.call(_,h[C],C,h)}function X(h,b){for(const _ in h)b.call(void 0,h[_],_,h)}function P(h){const b={};for(const _ in h)b[_]=h[_];return b}const re="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Re(h,b){let _,C;for(let ne=1;ne<arguments.length;ne++){C=arguments[ne];for(_ in C)h[_]=C[_];for(let de=0;de<re.length;de++)_=re[de],Object.prototype.hasOwnProperty.call(C,_)&&(h[_]=C[_])}}function Le(h){this.src=h,this.g={},this.h=0}Le.prototype.add=function(h,b,_,C,ne){const de=h.toString();h=this.g[de],h||(h=this.g[de]=[],this.h++);const Je=qe(h,b,C,ne);return Je>-1?(b=h[Je],_||(b.fa=!1)):(b=new pe(b,this.src,de,!!C,ne),b.fa=_,h.push(b)),b};function tt(h,b){const _=b.type;if(_ in h.g){var C=h.g[_],ne=Array.prototype.indexOf.call(C,b,void 0),de;(de=ne>=0)&&Array.prototype.splice.call(C,ne,1),de&&(Me(b),h.g[_].length==0&&(delete h.g[_],h.h--))}}function qe(h,b,_,C){for(let ne=0;ne<h.length;++ne){const de=h[ne];if(!de.da&&de.listener==b&&de.capture==!!_&&de.ha==C)return ne}return-1}var ft="closure_lm_"+(Math.random()*1e6|0),kt={};function rt(h,b,_,C,ne){if(Array.isArray(b)){for(let de=0;de<b.length;de++)rt(h,b[de],_,C,ne);return null}return _=Ze(_),h&&h[mt]?h.J(b,_,p(C)?!!C.capture:!1,ne):Wt(h,b,_,!1,C,ne)}function Wt(h,b,_,C,ne,de){if(!b)throw Error("Invalid event type");const Je=p(ne)?!!ne.capture:!!ne;let es=Ae(h);if(es||(h[ft]=es=new Le(h)),_=es.add(b,_,C,Je,de),_.proxy)return _;if(C=_s(),_.proxy=C,C.src=h,C.listener=_,h.addEventListener)z||(ne=Je),ne===void 0&&(ne=!1),h.addEventListener(b.toString(),C,ne);else if(h.attachEvent)h.attachEvent(ue(b.toString()),C);else if(h.addListener&&h.removeListener)h.addListener(C);else throw Error("addEventListener and attachEvent are unavailable.");return _}function _s(){function h(_){return b.call(h.src,h.listener,_)}const b=Zt;return h}function At(h,b,_,C,ne){if(Array.isArray(b))for(var de=0;de<b.length;de++)At(h,b[de],_,C,ne);else C=p(C)?!!C.capture:!!C,_=Ze(_),h&&h[mt]?(h=h.i,de=String(b).toString(),de in h.g&&(b=h.g[de],_=qe(b,_,C,ne),_>-1&&(Me(b[_]),Array.prototype.splice.call(b,_,1),b.length==0&&(delete h.g[de],h.h--)))):h&&(h=Ae(h))&&(b=h.g[b.toString()],h=-1,b&&(h=qe(b,_,C,ne)),(_=h>-1?b[h]:null)&&pt(_))}function pt(h){if(typeof h!="number"&&h&&!h.da){var b=h.src;if(b&&b[mt])tt(b.i,h);else{var _=h.type,C=h.proxy;b.removeEventListener?b.removeEventListener(_,C,h.capture):b.detachEvent?b.detachEvent(ue(_),C):b.addListener&&b.removeListener&&b.removeListener(C),(_=Ae(b))?(tt(_,h),_.h==0&&(_.src=null,b[ft]=null)):Me(h)}}}function ue(h){return h in kt?kt[h]:kt[h]="on"+h}function Zt(h,b){if(h.da)h=!0;else{b=new Ge(b,this);const _=h.listener,C=h.ha||h.src;h.fa&&pt(h),h=_.call(C,b)}return h}function Ae(h){return h=h[ft],h instanceof Le?h:null}var Fe="__closure_events_fn_"+(Math.random()*1e9>>>0);function Ze(h){return typeof h=="function"?h:(h[Fe]||(h[Fe]=function(b){return h.handleEvent(b)}),h[Fe])}function Ke(){L.call(this),this.i=new Le(this),this.M=this,this.G=null}k(Ke,L),Ke.prototype[mt]=!0,Ke.prototype.removeEventListener=function(h,b,_,C){At(this,h,b,_,C)};function Xe(h,b){var _,C=h.G;if(C)for(_=[];C;C=C.G)_.push(C);if(h=h.M,C=b.type||b,typeof b=="string")b=new D(b,h);else if(b instanceof D)b.target=b.target||h;else{var ne=b;b=new D(C,h),Re(b,ne)}ne=!0;let de,Je;if(_)for(Je=_.length-1;Je>=0;Je--)de=b.g=_[Je],ne=Ct(de,C,!0,b)&&ne;if(de=b.g=h,ne=Ct(de,C,!0,b)&&ne,ne=Ct(de,C,!1,b)&&ne,_)for(Je=0;Je<_.length;Je++)de=b.g=_[Je],ne=Ct(de,C,!1,b)&&ne}Ke.prototype.N=function(){if(Ke.Z.N.call(this),this.i){var h=this.i;for(const b in h.g){const _=h.g[b];for(let C=0;C<_.length;C++)Me(_[C]);delete h.g[b],h.h--}}this.G=null},Ke.prototype.J=function(h,b,_,C){return this.i.add(String(h),b,!1,_,C)},Ke.prototype.K=function(h,b,_,C){return this.i.add(String(h),b,!0,_,C)};function Ct(h,b,_,C){if(b=h.i.g[String(b)],!b)return!0;b=b.concat();let ne=!0;for(let de=0;de<b.length;++de){const Je=b[de];if(Je&&!Je.da&&Je.capture==_){const es=Je.listener,kn=Je.ha||Je.src;Je.fa&&tt(h.i,Je),ne=es.call(kn,C)!==!1&&ne}}return ne&&!C.defaultPrevented}function zs(h,b){if(typeof h!="function")if(h&&typeof h.handleEvent=="function")h=y(h.handleEvent,h);else throw Error("Invalid listener argument");return Number(b)>2147483647?-1:d.setTimeout(h,b||0)}function gt(h){h.g=zs(()=>{h.g=null,h.i&&(h.i=!1,gt(h))},h.l);const b=h.h;h.h=null,h.m.apply(null,b)}class Ut extends L{constructor(b,_){super(),this.m=b,this.l=_,this.h=null,this.i=!1,this.g=null}j(b){this.h=arguments,this.g?this.i=!0:gt(this)}N(){super.N(),this.g&&(d.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Bs(h){L.call(this),this.h=h,this.g={}}k(Bs,L);var qt=[];function Cs(h){Qe(h.g,function(b,_){this.g.hasOwnProperty(_)&&pt(b)},h),h.g={}}Bs.prototype.N=function(){Bs.Z.N.call(this),Cs(this)},Bs.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var is=d.JSON.stringify,Ts=d.JSON.parse,ce=class{stringify(h){return d.JSON.stringify(h,void 0)}parse(h){return d.JSON.parse(h,void 0)}};function Se(){}function Be(){}var et={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Ue(){D.call(this,"d")}k(Ue,D);function De(){D.call(this,"c")}k(De,D);var He={},wt=null;function yt(){return wt=wt||new Ke}He.Ia="serverreachability";function Mt(h){D.call(this,He.Ia,h)}k(Mt,D);function Yt(h){const b=yt();Xe(b,new Mt(b))}He.STAT_EVENT="statevent";function J(h,b){D.call(this,He.STAT_EVENT,h),this.stat=b}k(J,D);function be(h){const b=yt();Xe(b,new J(b,h))}He.Ja="timingevent";function it(h,b){D.call(this,He.Ja,h),this.size=b}k(it,D);function Dt(h,b){if(typeof h!="function")throw Error("Fn must not be null and must be a function");return d.setTimeout(function(){h()},b)}function jt(){this.g=!0}jt.prototype.ua=function(){this.g=!1};function ss(h,b,_,C,ne,de){h.info(function(){if(h.g)if(de){var Je="",es=de.split("&");for(let Os=0;Os<es.length;Os++){var kn=es[Os].split("=");if(kn.length>1){const on=kn[0];kn=kn[1];const Kr=on.split("_");Je=Kr.length>=2&&Kr[1]=="type"?Je+(on+"="+kn+"&"):Je+(on+"=redacted&")}}}else Je=null;else Je=de;return"XMLHTTP REQ ("+C+") [attempt "+ne+"]: "+b+`
`+_+`
`+Je})}function Qt(h,b,_,C,ne,de,Je){h.info(function(){return"XMLHTTP RESP ("+C+") [ attempt "+ne+"]: "+b+`
`+_+`
`+de+" "+Je})}function zt(h,b,_,C){h.info(function(){return"XMLHTTP TEXT ("+b+"): "+Zs(h,_)+(C?" "+C:"")})}function Rs(h,b){h.info(function(){return"TIMEOUT: "+b})}jt.prototype.info=function(){};function Zs(h,b){if(!h.g)return b;if(!b)return null;try{const de=JSON.parse(b);if(de){for(h=0;h<de.length;h++)if(Array.isArray(de[h])){var _=de[h];if(!(_.length<2)){var C=_[1];if(Array.isArray(C)&&!(C.length<1)){var ne=C[0];if(ne!="noop"&&ne!="stop"&&ne!="close")for(let Je=1;Je<C.length;Je++)C[Je]=""}}}}return is(de)}catch{return b}}var ds={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Es={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Ls;function F(){}k(F,Se),F.prototype.g=function(){return new XMLHttpRequest},Ls=new F;function ve(h){return encodeURIComponent(String(h))}function we(h){var b=1;h=h.split(":");const _=[];for(;b>0&&h.length;)_.push(h.shift()),b--;return h.length&&_.push(h.join(":")),_}function _e(h,b,_,C){this.j=h,this.i=b,this.l=_,this.S=C||1,this.V=new Bs(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new ge}function ge(){this.i=null,this.g="",this.h=!1}var at={},Rt={};function lt(h,b,_){h.M=1,h.A=ze(As(b)),h.u=_,h.R=!0,bt(h,null)}function bt(h,b){h.F=Date.now(),fn(h),h.B=As(h.A);var _=h.B,C=h.S;Array.isArray(C)||(C=[String(C)]),dn(_.i,"t",C),h.C=0,_=h.j.L,h.h=new ge,h.g=$u(h.j,_?b:null,!h.u),h.P>0&&(h.O=new Ut(y(h.Y,h,h.g),h.P)),b=h.V,_=h.g,C=h.ba;var ne="readystatechange";Array.isArray(ne)||(ne&&(qt[0]=ne.toString()),ne=qt);for(let de=0;de<ne.length;de++){const Je=rt(_,ne[de],C||b.handleEvent,!1,b.h||b);if(!Je)break;b.g[Je.key]=Je}b=h.J?P(h.J):{},h.u?(h.v||(h.v="POST"),b["Content-Type"]="application/x-www-form-urlencoded",h.g.ea(h.B,h.v,h.u,b)):(h.v="GET",h.g.ea(h.B,h.v,null,b)),Yt(),ss(h.i,h.v,h.B,h.l,h.S,h.u)}_e.prototype.ba=function(h){h=h.target;const b=this.O;b&&rs(h)==3?b.j():this.Y(h)},_e.prototype.Y=function(h){try{if(h==this.g)e:{const es=rs(this.g),kn=this.g.ya(),Os=this.g.ca();if(!(es<3)&&(es!=3||this.g&&(this.h.h||this.g.la()||Ht(this.g)))){this.K||es!=4||kn==7||(kn==8||Os<=0?Yt(3):Yt(2)),Ys(this);var b=this.g.ca();this.X=b;var _=Tt(this);if(this.o=b==200,Qt(this.i,this.v,this.B,this.l,this.S,es,b),this.o){if(this.U&&!this.L){t:{if(this.g){var C,ne=this.g;if((C=ne.g?ne.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!M(C)){var de=C;break t}}de=null}if(h=de)zt(this.i,this.l,h,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,E(this,h);else{this.o=!1,this.m=3,be(12),he(this),G(this);break e}}if(this.R){h=!0;let on;for(;!this.K&&this.C<_.length;)if(on=Bn(this,_),on==Rt){es==4&&(this.m=4,be(14),h=!1),zt(this.i,this.l,null,"[Incomplete Response]");break}else if(on==at){this.m=4,be(15),zt(this.i,this.l,_,"[Invalid Chunk]"),h=!1;break}else zt(this.i,this.l,on,null),E(this,on);if(os(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),es!=4||_.length!=0||this.h.h||(this.m=1,be(16),h=!1),this.o=this.o&&h,!h)zt(this.i,this.l,_,"[Invalid Chunked Response]"),he(this),G(this);else if(_.length>0&&!this.W){this.W=!0;var Je=this.j;Je.g==this&&Je.aa&&!Je.P&&(Je.j.info("Great, no buffering proxy detected. Bytes received: "+_.length),hr(Je),Je.P=!0,be(11))}}else zt(this.i,this.l,_,null),E(this,_);es==4&&he(this),this.o&&!this.K&&(es==4?tl(this.j,this):(this.o=!1,fn(this)))}else xs(this.g),b==400&&_.indexOf("Unknown SID")>0?(this.m=3,be(12)):(this.m=0,be(13)),he(this),G(this)}}}catch{}};function Tt(h){if(!os(h))return h.g.la();const b=Ht(h.g);if(b==="")return"";let _="";const C=b.length,ne=rs(h.g)==4;if(!h.h.i){if(typeof TextDecoder>"u")return he(h),G(h),"";h.h.i=new d.TextDecoder}for(let de=0;de<C;de++)h.h.h=!0,_+=h.h.i.decode(b[de],{stream:!(ne&&de==C-1)});return b.length=0,h.h.g+=_,h.C=0,h.h.g}function os(h){return h.g?h.v=="GET"&&h.M!=2&&h.j.Aa:!1}function Bn(h,b){var _=h.C,C=b.indexOf(`
`,_);return C==-1?Rt:(_=Number(b.substring(_,C)),isNaN(_)?at:(C+=1,C+_>b.length?Rt:(b=b.slice(C,C+_),h.C=C+_,b)))}_e.prototype.cancel=function(){this.K=!0,he(this)};function fn(h){h.T=Date.now()+h.H,_n(h,h.H)}function _n(h,b){if(h.D!=null)throw Error("WatchDog timer not null");h.D=Dt(y(h.aa,h),b)}function Ys(h){h.D&&(d.clearTimeout(h.D),h.D=null)}_e.prototype.aa=function(){this.D=null;const h=Date.now();h-this.T>=0?(Rs(this.i,this.B),this.M!=2&&(Yt(),be(17)),he(this),this.m=2,G(this)):_n(this,this.T-h)};function G(h){h.j.I==0||h.K||tl(h.j,h)}function he(h){Ys(h);var b=h.O;b&&typeof b.dispose=="function"&&b.dispose(),h.O=null,Cs(h.V),h.g&&(b=h.g,h.g=null,b.abort(),b.dispose())}function E(h,b){try{var _=h.j;if(_.I!=0&&(_.g==h||Oe(_.h,h))){if(!h.L&&Oe(_.h,h)&&_.I==3){try{var C=_.Ba.g.parse(b)}catch{C=null}if(Array.isArray(C)&&C.length==3){var ne=C;if(ne[0]==0){e:if(!_.v){if(_.g)if(_.g.F+3e3<h.F)Ha(_),Qs(_);else break e;gn(_),be(18)}}else _.xa=ne[1],0<_.xa-_.K&&ne[2]<37500&&_.F&&_.A==0&&!_.C&&(_.C=Dt(y(_.Va,_),6e3));$e(_.h)<=1&&_.ta&&(_.ta=void 0)}else mr(_,11)}else if((h.L||_.g==h)&&Ha(_),!M(b))for(ne=_.Ba.g.parse(b),b=0;b<ne.length;b++){let Os=ne[b];const on=Os[0];if(!(on<=_.K))if(_.K=on,Os=Os[1],_.I==2)if(Os[0]=="c"){_.M=Os[1],_.ba=Os[2];const Kr=Os[3];Kr!=null&&(_.ka=Kr,_.j.info("VER="+_.ka));const Ea=Os[4];Ea!=null&&(_.za=Ea,_.j.info("SVER="+_.za));const la=Os[5];la!=null&&typeof la=="number"&&la>0&&(C=1.5*la,_.O=C,_.j.info("backChannelRequestTimeoutMs_="+C)),C=_;const ca=h.g;if(ca){const bo=ca.g?ca.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(bo){var de=C.h;de.g||bo.indexOf("spdy")==-1&&bo.indexOf("quic")==-1&&bo.indexOf("h2")==-1||(de.j=de.l,de.g=new Set,de.h&&(Ve(de,de.h),de.h=null))}if(C.G){const nl=ca.g?ca.g.getResponseHeader("X-HTTP-Session-Id"):null;nl&&(C.wa=nl,te(C.J,C.G,nl))}}_.I=3,_.l&&_.l.ra(),_.aa&&(_.T=Date.now()-h.F,_.j.info("Handshake RTT: "+_.T+"ms")),C=_;var Je=h;if(C.na=oa(C,C.L?C.ba:null,C.W),Je.L){It(C.h,Je);var es=Je,kn=C.O;kn&&(es.H=kn),es.D&&(Ys(es),fn(es)),C.g=Je}else rr(C);_.i.length>0&&hn(_)}else Os[0]!="stop"&&Os[0]!="close"||mr(_,7);else _.I==3&&(Os[0]=="stop"||Os[0]=="close"?Os[0]=="stop"?mr(_,7):en(_):Os[0]!="noop"&&_.l&&_.l.qa(Os),_.A=0)}}Yt(4)}catch{}}var S=class{constructor(h,b){this.g=h,this.map=b}};function q(h){this.l=h||10,d.PerformanceNavigationTiming?(h=d.performance.getEntriesByType("navigation"),h=h.length>0&&(h[0].nextHopProtocol=="hq"||h[0].nextHopProtocol=="h2")):h=!!(d.chrome&&d.chrome.loadTimes&&d.chrome.loadTimes()&&d.chrome.loadTimes().wasFetchedViaSpdy),this.j=h?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Z(h){return h.h?!0:h.g?h.g.size>=h.j:!1}function $e(h){return h.h?1:h.g?h.g.size:0}function Oe(h,b){return h.h?h.h==b:h.g?h.g.has(b):!1}function Ve(h,b){h.g?h.g.add(b):h.h=b}function It(h,b){h.h&&h.h==b?h.h=null:h.g&&h.g.has(b)&&h.g.delete(b)}q.prototype.cancel=function(){if(this.i=Et(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const h of this.g.values())h.cancel();this.g.clear()}};function Et(h){if(h.h!=null)return h.i.concat(h.h.G);if(h.g!=null&&h.g.size!==0){let b=h.i;for(const _ of h.g.values())b=b.concat(_.G);return b}return O(h.i)}var hs=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function an(h,b){if(h){h=h.split("&");for(let _=0;_<h.length;_++){const C=h[_].indexOf("=");let ne,de=null;C>=0?(ne=h[_].substring(0,C),de=h[_].substring(C+1)):ne=h[_],b(ne,de?decodeURIComponent(de.replace(/\+/g," ")):"")}}}function Hs(h){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let b;h instanceof Hs?(this.l=h.l,Is(this,h.j),this.o=h.o,this.g=h.g,Y(this,h.u),this.h=h.h,xe(this,sr(h.i)),this.m=h.m):h&&(b=String(h).match(hs))?(this.l=!1,Is(this,b[1]||"",!0),this.o=Ye(b[2]||""),this.g=Ye(b[3]||"",!0),Y(this,b[4]),this.h=Ye(b[5]||"",!0),xe(this,b[6]||"",!0),this.m=Ye(b[7]||"")):(this.l=!1,this.i=new Gr(null,this.l))}Hs.prototype.toString=function(){const h=[];var b=this.j;b&&h.push(ct(b,Lt,!0),":");var _=this.g;return(_||b=="file")&&(h.push("//"),(b=this.o)&&h.push(ct(b,Lt,!0),"@"),h.push(ve(_).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),_=this.u,_!=null&&h.push(":",String(_))),(_=this.h)&&(this.g&&_.charAt(0)!="/"&&h.push("/"),h.push(ct(_,_.charAt(0)=="/"?un:vs,!0))),(_=this.i.toString())&&h.push("?",_),(_=this.m)&&h.push("#",ct(_,Wn)),h.join("")},Hs.prototype.resolve=function(h){const b=As(this);let _=!!h.j;_?Is(b,h.j):_=!!h.o,_?b.o=h.o:_=!!h.g,_?b.g=h.g:_=h.u!=null;var C=h.h;if(_)Y(b,h.u);else if(_=!!h.h){if(C.charAt(0)!="/")if(this.g&&!this.h)C="/"+C;else{var ne=b.h.lastIndexOf("/");ne!=-1&&(C=b.h.slice(0,ne+1)+C)}if(ne=C,ne==".."||ne==".")C="";else if(ne.indexOf("./")!=-1||ne.indexOf("/.")!=-1){C=ne.lastIndexOf("/",0)==0,ne=ne.split("/");const de=[];for(let Je=0;Je<ne.length;){const es=ne[Je++];es=="."?C&&Je==ne.length&&de.push(""):es==".."?((de.length>1||de.length==1&&de[0]!="")&&de.pop(),C&&Je==ne.length&&de.push("")):(de.push(es),C=!0)}C=de.join("/")}else C=ne}return _?b.h=C:_=h.i.toString()!=="",_?xe(b,sr(h.i)):_=!!h.m,_&&(b.m=h.m),b};function As(h){return new Hs(h)}function Is(h,b,_){h.j=_?Ye(b,!0):b,h.j&&(h.j=h.j.replace(/:$/,""))}function Y(h,b){if(b){if(b=Number(b),isNaN(b)||b<0)throw Error("Bad port number "+b);h.u=b}else h.u=null}function xe(h,b,_){b instanceof Gr?(h.i=b,_r(h.i,h.l)):(_||(b=ct(b,ms)),h.i=new Gr(b,h.l))}function te(h,b,_){h.i.set(b,_)}function ze(h){return te(h,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),h}function Ye(h,b){return h?b?decodeURI(h.replace(/%25/g,"%2525")):decodeURIComponent(h):""}function ct(h,b,_){return typeof h=="string"?(h=encodeURI(h).replace(b,xt),_&&(h=h.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),h):null}function xt(h){return h=h.charCodeAt(0),"%"+(h>>4&15).toString(16)+(h&15).toString(16)}var Lt=/[#\/\?@]/g,vs=/[#\?:]/g,un=/[#\?]/g,ms=/[#\?@]/g,Wn=/#/g;function Gr(h,b){this.h=this.g=null,this.i=h||null,this.j=!!b}function pn(h){h.g||(h.g=new Map,h.h=0,h.i&&an(h.i,function(b,_){h.add(decodeURIComponent(b.replace(/\+/g," ")),_)}))}n=Gr.prototype,n.add=function(h,b){pn(this),this.i=null,h=Gn(this,h);let _=this.g.get(h);return _||this.g.set(h,_=[]),_.push(b),this.h+=1,this};function ja(h,b){pn(h),b=Gn(h,b),h.g.has(b)&&(h.i=null,h.h-=h.g.get(b).length,h.g.delete(b))}function Un(h,b){return pn(h),b=Gn(h,b),h.g.has(b)}n.forEach=function(h,b){pn(this),this.g.forEach(function(_,C){_.forEach(function(ne){h.call(b,ne,C,this)},this)},this)};function as(h,b){pn(h);let _=[];if(typeof b=="string")Un(h,b)&&(_=_.concat(h.g.get(Gn(h,b))));else for(h=Array.from(h.g.values()),b=0;b<h.length;b++)_=_.concat(h[b]);return _}n.set=function(h,b){return pn(this),this.i=null,h=Gn(this,h),Un(this,h)&&(this.h-=this.g.get(h).length),this.g.set(h,[b]),this.h+=1,this},n.get=function(h,b){return h?(h=as(this,h),h.length>0?String(h[0]):b):b};function dn(h,b,_){ja(h,b),_.length>0&&(h.i=null,h.g.set(Gn(h,b),O(_)),h.h+=_.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const h=[],b=Array.from(this.g.keys());for(let C=0;C<b.length;C++){var _=b[C];const ne=ve(_);_=as(this,_);for(let de=0;de<_.length;de++){let Je=ne;_[de]!==""&&(Je+="="+ve(_[de])),h.push(Je)}}return this.i=h.join("&")};function sr(h){const b=new Gr;return b.i=h.i,h.g&&(b.g=new Map(h.g),b.h=h.h),b}function Gn(h,b){return b=String(b),h.j&&(b=b.toLowerCase()),b}function _r(h,b){b&&!h.j&&(pn(h),h.i=null,h.g.forEach(function(_,C){const ne=C.toLowerCase();C!=ne&&(ja(this,C),dn(this,ne,_))},h)),h.j=b}function sn(h,b){const _=new jt;if(d.Image){const C=new Image;C.onload=w(Nn,_,"TestLoadImage: loaded",!0,b,C),C.onerror=w(Nn,_,"TestLoadImage: error",!1,b,C),C.onabort=w(Nn,_,"TestLoadImage: abort",!1,b,C),C.ontimeout=w(Nn,_,"TestLoadImage: timeout",!1,b,C),d.setTimeout(function(){C.ontimeout&&C.ontimeout()},1e4),C.src=h}else b(!1)}function Pn(h,b){const _=new jt,C=new AbortController,ne=setTimeout(()=>{C.abort(),Nn(_,"TestPingServer: timeout",!1,b)},1e4);fetch(h,{signal:C.signal}).then(de=>{clearTimeout(ne),de.ok?Nn(_,"TestPingServer: ok",!0,b):Nn(_,"TestPingServer: server error",!1,b)}).catch(()=>{clearTimeout(ne),Nn(_,"TestPingServer: error",!1,b)})}function Nn(h,b,_,C,ne){try{ne&&(ne.onload=null,ne.onerror=null,ne.onabort=null,ne.ontimeout=null),C(_)}catch{}}function kr(){this.g=new ce}function jr(h){this.i=h.Sb||null,this.h=h.ab||!1}k(jr,Se),jr.prototype.g=function(){return new Dr(this.i,this.h)};function Dr(h,b){Ke.call(this),this.H=h,this.o=b,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}k(Dr,Ke),n=Dr.prototype,n.open=function(h,b){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=h,this.D=b,this.readyState=1,Pr(this)},n.send=function(h){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const b={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};h&&(b.body=h),(this.H||d).fetch(new Request(this.D,b)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Ta(this)),this.readyState=0},n.Pa=function(h){if(this.g&&(this.l=h,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=h.headers,this.readyState=2,Pr(this)),this.g&&(this.readyState=3,Pr(this),this.g)))if(this.responseType==="arraybuffer")h.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof d.ReadableStream<"u"&&"body"in h){if(this.j=h.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;wi(this)}else h.text().then(this.Oa.bind(this),this.ga.bind(this))};function wi(h){h.j.read().then(h.Ma.bind(h)).catch(h.ga.bind(h))}n.Ma=function(h){if(this.g){if(this.o&&h.value)this.response.push(h.value);else if(!this.o){var b=h.value?h.value:new Uint8Array(0);(b=this.B.decode(b,{stream:!h.done}))&&(this.response=this.responseText+=b)}h.done?Ta(this):Pr(this),this.readyState==3&&wi(this)}},n.Oa=function(h){this.g&&(this.response=this.responseText=h,Ta(this))},n.Na=function(h){this.g&&(this.response=h,Ta(this))},n.ga=function(){this.g&&Ta(this)};function Ta(h){h.readyState=4,h.l=null,h.j=null,h.B=null,Pr(h)}n.setRequestHeader=function(h,b){this.A.append(h,b)},n.getResponseHeader=function(h){return this.h&&this.h.get(h.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const h=[],b=this.h.entries();for(var _=b.next();!_.done;)_=_.value,h.push(_[0]+": "+_[1]),_=b.next();return h.join(`\r
`)};function Pr(h){h.onreadystatechange&&h.onreadystatechange.call(h)}Object.defineProperty(Dr.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(h){this.m=h?"include":"same-origin"}});function I(h){let b="";return Qe(h,function(_,C){b+=C,b+=":",b+=_,b+=`\r
`}),b}function ee(h,b,_){e:{for(C in _){var C=!1;break e}C=!0}C||(_=I(_),typeof h=="string"?_!=null&&ve(_):te(h,b,_))}function je(h){Ke.call(this),this.headers=new Map,this.L=h||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}k(je,Ke);var st=/^https?$/i,_t=["POST","PUT"];n=je.prototype,n.Fa=function(h){this.H=h},n.ea=function(h,b,_,C){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+h);b=b?b.toUpperCase():"GET",this.D=h,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Ls.g(),this.g.onreadystatechange=j(y(this.Ca,this));try{this.B=!0,this.g.open(b,String(h),!0),this.B=!1}catch(de){Ot(this,de);return}if(h=_||"",_=new Map(this.headers),C)if(Object.getPrototypeOf(C)===Object.prototype)for(var ne in C)_.set(ne,C[ne]);else if(typeof C.keys=="function"&&typeof C.get=="function")for(const de of C.keys())_.set(de,C.get(de));else throw Error("Unknown input type for opt_headers: "+String(C));C=Array.from(_.keys()).find(de=>de.toLowerCase()=="content-type"),ne=d.FormData&&h instanceof d.FormData,!(Array.prototype.indexOf.call(_t,b,void 0)>=0)||C||ne||_.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[de,Je]of _)this.g.setRequestHeader(de,Je);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(h),this.v=!1}catch(de){Ot(this,de)}};function Ot(h,b){h.h=!1,h.g&&(h.j=!0,h.g.abort(),h.j=!1),h.l=b,h.o=5,ot(h),Gt(h)}function ot(h){h.A||(h.A=!0,Xe(h,"complete"),Xe(h,"error"))}n.abort=function(h){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=h||7,Xe(this,"complete"),Xe(this,"abort"),Gt(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Gt(this,!0)),je.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?Ft(this):this.Xa())},n.Xa=function(){Ft(this)};function Ft(h){if(h.h&&typeof u<"u"){if(h.v&&rs(h)==4)setTimeout(h.Ca.bind(h),0);else if(Xe(h,"readystatechange"),rs(h)==4){h.h=!1;try{const de=h.ca();e:switch(de){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var b=!0;break e;default:b=!1}var _;if(!(_=b)){var C;if(C=de===0){let Je=String(h.D).match(hs)[1]||null;!Je&&d.self&&d.self.location&&(Je=d.self.location.protocol.slice(0,-1)),C=!st.test(Je?Je.toLowerCase():"")}_=C}if(_)Xe(h,"complete"),Xe(h,"success");else{h.o=6;try{var ne=rs(h)>2?h.g.statusText:""}catch{ne=""}h.l=ne+" ["+h.ca()+"]",ot(h)}}finally{Gt(h)}}}}function Gt(h,b){if(h.g){h.m&&(clearTimeout(h.m),h.m=null);const _=h.g;h.g=null,b||Xe(h,"ready");try{_.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function rs(h){return h.g?h.g.readyState:0}n.ca=function(){try{return rs(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(h){if(this.g){var b=this.g.responseText;return h&&b.indexOf(h)==0&&(b=b.substring(h.length)),Ts(b)}};function Ht(h){try{if(!h.g)return null;if("response"in h.g)return h.g.response;switch(h.F){case"":case"text":return h.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in h.g)return h.g.mozResponseArrayBuffer}return null}catch{return null}}function xs(h){const b={};h=(h.g&&rs(h)>=2&&h.g.getAllResponseHeaders()||"").split(`\r
`);for(let C=0;C<h.length;C++){if(M(h[C]))continue;var _=we(h[C]);const ne=_[0];if(_=_[1],typeof _!="string")continue;_=_.trim();const de=b[ne]||[];b[ne]=de,de.push(_)}X(b,function(C){return C.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function zn(h,b,_){return _&&_.internalChannelParams&&_.internalChannelParams[h]||b}function ur(h){this.za=0,this.i=[],this.j=new jt,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=zn("failFast",!1,h),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=zn("baseRetryDelayMs",5e3,h),this.Za=zn("retryDelaySeedMs",1e4,h),this.Ta=zn("forwardChannelMaxRetries",2,h),this.va=zn("forwardChannelRequestTimeoutMs",2e4,h),this.ma=h&&h.xmlHttpFactory||void 0,this.Ua=h&&h.Rb||void 0,this.Aa=h&&h.useFetchStreams||!1,this.O=void 0,this.L=h&&h.supportsCrossDomainXhr||!1,this.M="",this.h=new q(h&&h.concurrentRequestLimit),this.Ba=new kr,this.S=h&&h.fastHandshake||!1,this.R=h&&h.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=h&&h.Pb||!1,h&&h.ua&&this.j.ua(),h&&h.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&h&&h.detectBufferingProxy||!1,this.ia=void 0,h&&h.longPollingTimeout&&h.longPollingTimeout>0&&(this.ia=h.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=ur.prototype,n.ka=8,n.I=1,n.connect=function(h,b,_,C){be(0),this.W=h,this.H=b||{},_&&C!==void 0&&(this.H.OSID=_,this.H.OAID=C),this.F=this.X,this.J=oa(this,null,this.W),hn(this)};function en(h){if(Fn(h),h.I==3){var b=h.V++,_=As(h.J);if(te(_,"SID",h.M),te(_,"RID",b),te(_,"TYPE","terminate"),Kn(h,_),b=new _e(h,h.j,b),b.M=2,b.A=ze(As(_)),_=!1,d.navigator&&d.navigator.sendBeacon)try{_=d.navigator.sendBeacon(b.A.toString(),"")}catch{}!_&&d.Image&&(new Image().src=b.A,_=!0),_||(b.g=$u(b.j,null),b.g.ea(b.A)),b.F=Date.now(),fn(b)}ia(h)}function Qs(h){h.g&&(hr(h),h.g.cancel(),h.g=null)}function Fn(h){Qs(h),h.v&&(d.clearTimeout(h.v),h.v=null),Ha(h),h.h.cancel(),h.m&&(typeof h.m=="number"&&d.clearTimeout(h.m),h.m=null)}function hn(h){if(!Z(h.h)&&!h.m){h.m=!0;var b=h.Ea;Pe||T(),Ee||(Pe(),Ee=!0),R.add(b,h),h.D=0}}function Ln(h,b){return $e(h.h)>=h.h.j-(h.m?1:0)?!1:h.m?(h.i=b.G.concat(h.i),!0):h.I==1||h.I==2||h.D>=(h.Sa?0:h.Ta)?!1:(h.m=Dt(y(h.Ea,h,b),sl(h,h.D)),h.D++,!0)}n.Ea=function(h){if(this.m)if(this.m=null,this.I==1){if(!h){this.V=Math.floor(Math.random()*1e5),h=this.V++;const ne=new _e(this,this.j,h);let de=this.o;if(this.U&&(de?(de=P(de),Re(de,this.U)):de=this.U),this.u!==null||this.R||(ne.J=de,de=null),this.S)e:{for(var b=0,_=0;_<this.i.length;_++){t:{var C=this.i[_];if("__data__"in C.map&&(C=C.map.__data__,typeof C=="string")){C=C.length;break t}C=void 0}if(C===void 0)break;if(b+=C,b>4096){b=_;break e}if(b===4096||_===this.i.length-1){b=_+1;break e}}b=1e3}else b=1e3;b=dr(this,ne,b),_=As(this.J),te(_,"RID",h),te(_,"CVER",22),this.G&&te(_,"X-HTTP-Session-Id",this.G),Kn(this,_),de&&(this.R?b="headers="+ve(I(de))+"&"+b:this.u&&ee(_,this.u,de)),Ve(this.h,ne),this.Ra&&te(_,"TYPE","init"),this.S?(te(_,"$req",b),te(_,"SID","null"),ne.U=!0,lt(ne,_,null)):lt(ne,_,b),this.I=2}}else this.I==3&&(h?nr(this,h):this.i.length==0||Z(this.h)||nr(this))};function nr(h,b){var _;b?_=b.l:_=h.V++;const C=As(h.J);te(C,"SID",h.M),te(C,"RID",_),te(C,"AID",h.K),Kn(h,C),h.u&&h.o&&ee(C,h.u,h.o),_=new _e(h,h.j,_,h.D+1),h.u===null&&(_.J=h.o),b&&(h.i=b.G.concat(h.i)),b=dr(h,_,1e3),_.H=Math.round(h.va*.5)+Math.round(h.va*.5*Math.random()),Ve(h.h,_),lt(_,C,b)}function Kn(h,b){h.H&&Qe(h.H,function(_,C){te(b,C,_)}),h.l&&Qe({},function(_,C){te(b,C,_)})}function dr(h,b,_){_=Math.min(h.i.length,_);const C=h.l?y(h.l.Ka,h.l,h):null;e:{var ne=h.i;let es=-1;for(;;){const kn=["count="+_];es==-1?_>0?(es=ne[0].g,kn.push("ofs="+es)):es=0:kn.push("ofs="+es);let Os=!0;for(let on=0;on<_;on++){var de=ne[on].g;const Kr=ne[on].map;if(de-=es,de<0)es=Math.max(0,ne[on].g-100),Os=!1;else try{de="req"+de+"_"||"";try{var Je=Kr instanceof Map?Kr:Object.entries(Kr);for(const[Ea,la]of Je){let ca=la;p(la)&&(ca=is(la)),kn.push(de+Ea+"="+encodeURIComponent(ca))}}catch(Ea){throw kn.push(de+"type="+encodeURIComponent("_badmap")),Ea}}catch{C&&C(Kr)}}if(Os){Je=kn.join("&");break e}}Je=void 0}return h=h.i.splice(0,_),b.G=h,Je}function rr(h){if(!h.g&&!h.v){h.Y=1;var b=h.Da;Pe||T(),Ee||(Pe(),Ee=!0),R.add(b,h),h.A=0}}function gn(h){return h.g||h.v||h.A>=3?!1:(h.Y++,h.v=Dt(y(h.Da,h),sl(h,h.A)),h.A++,!0)}n.Da=function(){if(this.v=null,Tr(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var h=4*this.T;this.j.info("BP detection timer enabled: "+h),this.B=Dt(y(this.Wa,this),h)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,be(10),Qs(this),Tr(this))};function hr(h){h.B!=null&&(d.clearTimeout(h.B),h.B=null)}function Tr(h){h.g=new _e(h,h.j,"rpc",h.Y),h.u===null&&(h.g.J=h.o),h.g.P=0;var b=As(h.na);te(b,"RID","rpc"),te(b,"SID",h.M),te(b,"AID",h.K),te(b,"CI",h.F?"0":"1"),!h.F&&h.ia&&te(b,"TO",h.ia),te(b,"TYPE","xmlhttp"),Kn(h,b),h.u&&h.o&&ee(b,h.u,h.o),h.O&&(h.g.H=h.O);var _=h.g;h=h.ba,_.M=1,_.A=ze(As(b)),_.u=null,_.R=!0,bt(_,h)}n.Va=function(){this.C!=null&&(this.C=null,Qs(this),gn(this),be(19))};function Ha(h){h.C!=null&&(d.clearTimeout(h.C),h.C=null)}function tl(h,b){var _=null;if(h.g==b){Ha(h),hr(h),h.g=null;var C=2}else if(Oe(h.h,b))_=b.G,It(h.h,b),C=1;else return;if(h.I!=0){if(b.o)if(C==1){_=b.u?b.u.length:0,b=Date.now()-b.F;var ne=h.D;C=yt(),Xe(C,new it(C,_)),hn(h)}else rr(h);else if(ne=b.m,ne==3||ne==0&&b.X>0||!(C==1&&Ln(h,b)||C==2&&gn(h)))switch(_&&_.length>0&&(b=h.h,b.i=b.i.concat(_)),ne){case 1:mr(h,5);break;case 4:mr(h,10);break;case 3:mr(h,6);break;default:mr(h,2)}}}function sl(h,b){let _=h.Qa+Math.floor(Math.random()*h.Za);return h.isActive()||(_*=2),_*b}function mr(h,b){if(h.j.info("Error code "+b),b==2){var _=y(h.bb,h),C=h.Ua;const ne=!C;C=new Hs(C||"//www.google.com/images/cleardot.gif"),d.location&&d.location.protocol=="http"||Is(C,"https"),ze(C),ne?sn(C.toString(),_):Pn(C.toString(),_)}else be(2);h.I=0,h.l&&h.l.pa(b),ia(h),Fn(h)}n.bb=function(h){h?(this.j.info("Successfully pinged google.com"),be(2)):(this.j.info("Failed to ping google.com"),be(1))};function ia(h){if(h.I=0,h.ja=[],h.l){const b=Et(h.h);(b.length!=0||h.i.length!=0)&&(H(h.ja,b),H(h.ja,h.i),h.h.i.length=0,O(h.i),h.i.length=0),h.l.oa()}}function oa(h,b,_){var C=_ instanceof Hs?As(_):new Hs(_);if(C.g!="")b&&(C.g=b+"."+C.g),Y(C,C.u);else{var ne=d.location;C=ne.protocol,b=b?b+"."+ne.hostname:ne.hostname,ne=+ne.port;const de=new Hs(null);C&&Is(de,C),b&&(de.g=b),ne&&Y(de,ne),_&&(de.h=_),C=de}return _=h.G,b=h.wa,_&&b&&te(C,_,b),te(C,"VER",h.ka),Kn(h,C),C}function $u(h,b,_){if(b&&!h.L)throw Error("Can't create secondary domain capable XhrIo object.");return b=h.Aa&&!h.ma?new je(new jr({ab:_})):new je(h.ma),b.Fa(h.L),b}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Wu(){}n=Wu.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function _i(){}_i.prototype.g=function(h,b){return new fr(h,b)};function fr(h,b){Ke.call(this),this.g=new ur(b),this.l=h,this.h=b&&b.messageUrlParams||null,h=b&&b.messageHeaders||null,b&&b.clientProtocolHeaderRequired&&(h?h["X-Client-Protocol"]="webchannel":h={"X-Client-Protocol":"webchannel"}),this.g.o=h,h=b&&b.initMessageHeaders||null,b&&b.messageContentType&&(h?h["X-WebChannel-Content-Type"]=b.messageContentType:h={"X-WebChannel-Content-Type":b.messageContentType}),b&&b.sa&&(h?h["X-WebChannel-Client-Profile"]=b.sa:h={"X-WebChannel-Client-Profile":b.sa}),this.g.U=h,(h=b&&b.Qb)&&!M(h)&&(this.g.u=h),this.A=b&&b.supportsCrossDomainXhr||!1,this.v=b&&b.sendRawJson||!1,(b=b&&b.httpSessionIdParam)&&!M(b)&&(this.g.G=b,h=this.h,h!==null&&b in h&&(h=this.h,b in h&&delete h[b])),this.j=new $a(this)}k(fr,Ke),fr.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},fr.prototype.close=function(){en(this.g)},fr.prototype.o=function(h){var b=this.g;if(typeof h=="string"){var _={};_.__data__=h,h=_}else this.v&&(_={},_.__data__=is(h),h=_);b.i.push(new S(b.Ya++,h)),b.I==3&&hn(b)},fr.prototype.N=function(){this.g.l=null,delete this.j,en(this.g),delete this.g,fr.Z.N.call(this)};function Gu(h){Ue.call(this),h.__headers__&&(this.headers=h.__headers__,this.statusCode=h.__status__,delete h.__headers__,delete h.__status__);var b=h.__sm__;if(b){e:{for(const _ in b){h=_;break e}h=void 0}(this.i=h)&&(h=this.i,b=b!==null&&h in b?b[h]:void 0),this.data=b}else this.data=h}k(Gu,Ue);function Ku(){De.call(this),this.status=1}k(Ku,De);function $a(h){this.g=h}k($a,Wu),$a.prototype.ra=function(){Xe(this.g,"a")},$a.prototype.qa=function(h){Xe(this.g,new Gu(h))},$a.prototype.pa=function(h){Xe(this.g,new Ku)},$a.prototype.oa=function(){Xe(this.g,"b")},_i.prototype.createWebChannel=_i.prototype.g,fr.prototype.send=fr.prototype.o,fr.prototype.open=fr.prototype.m,fr.prototype.close=fr.prototype.close,qw=function(){return new _i},Fw=function(){return yt()},zw=He,hg={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},ds.NO_ERROR=0,ds.TIMEOUT=8,ds.HTTP_ERROR=6,bh=ds,Es.COMPLETE="complete",Uw=Es,Be.EventType=et,et.OPEN="a",et.CLOSE="b",et.ERROR="c",et.MESSAGE="d",Ke.prototype.listen=Ke.prototype.J,eu=Be,je.prototype.listenOnce=je.prototype.K,je.prototype.getLastError=je.prototype.Ha,je.prototype.getLastErrorCode=je.prototype.ya,je.prototype.getStatus=je.prototype.ca,je.prototype.getResponseJson=je.prototype.La,je.prototype.getResponseText=je.prototype.la,je.prototype.send=je.prototype.ea,je.prototype.setWithCredentials=je.prototype.Fa,Bw=je}).apply(typeof eh<"u"?eh:typeof self<"u"?self:typeof window<"u"?window:{});class or{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}or.UNAUTHENTICATED=new or(null),or.GOOGLE_CREDENTIALS=new or("google-credentials-uid"),or.FIRST_PARTY=new or("first-party-uid"),or.MOCK_USER=new or("mock-user");let nc="12.8.0";function sR(n){nc=n}const Ko=new Ug("@firebase/firestore");function Ol(){return Ko.logLevel}function ut(n,...e){if(Ko.logLevel<=gs.DEBUG){const t=e.map(Zg);Ko.debug(`Firestore (${nc}): ${n}`,...t)}}function gi(n,...e){if(Ko.logLevel<=gs.ERROR){const t=e.map(Zg);Ko.error(`Firestore (${nc}): ${n}`,...t)}}function Gl(n,...e){if(Ko.logLevel<=gs.WARN){const t=e.map(Zg);Ko.warn(`Firestore (${nc}): ${n}`,...t)}}function Zg(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}function Bt(n,e,t){let i="Unexpected state";typeof e=="string"?i=e:t=e,Hw(n,i,t)}function Hw(n,e,t){let i=`FIRESTORE (${nc}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{i+=" CONTEXT: "+JSON.stringify(t)}catch{i+=" CONTEXT: "+t}throw gi(i),new Error(i)}function Us(n,e,t,i){let l="Unexpected state";typeof t=="string"?l=t:i=t,n||Hw(e,l,i)}function Jt(n,e){return n}const Te={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class nt extends qa{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class di{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class $w{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class nR{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(or.UNAUTHENTICATED)))}shutdown(){}}class rR{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class aR{constructor(e){this.t=e,this.currentUser=or.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Us(this.o===void 0,42304);let i=this.i;const l=g=>this.i!==i?(i=this.i,t(g)):Promise.resolve();let u=new di;this.o=()=>{this.i++,this.currentUser=this.u(),u.resolve(),u=new di,e.enqueueRetryable((()=>l(this.currentUser)))};const d=()=>{const g=u;e.enqueueRetryable((async()=>{await g.promise,await l(this.currentUser)}))},p=g=>{ut("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=g,this.o&&(this.auth.addAuthTokenListener(this.o),d())};this.t.onInit((g=>p(g))),setTimeout((()=>{if(!this.auth){const g=this.t.getImmediate({optional:!0});g?p(g):(ut("FirebaseAuthCredentialsProvider","Auth not yet detected"),u.resolve(),u=new di)}}),0),d()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((i=>this.i!==e?(ut("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(Us(typeof i.accessToken=="string",31837,{l:i}),new $w(i.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Us(e===null||typeof e=="string",2055,{h:e}),new or(e)}}class iR{constructor(e,t,i){this.P=e,this.T=t,this.I=i,this.type="FirstParty",this.user=or.FIRST_PARTY,this.R=new Map}A(){return this.I?this.I():null}get headers(){this.R.set("X-Goog-AuthUser",this.P);const e=this.A();return e&&this.R.set("Authorization",e),this.T&&this.R.set("X-Goog-Iam-Authorization-Token",this.T),this.R}}class oR{constructor(e,t,i){this.P=e,this.T=t,this.I=i}getToken(){return Promise.resolve(new iR(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(or.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class dx{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class lR{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,qr(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Us(this.o===void 0,3512);const i=u=>{u.error!=null&&ut("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${u.error.message}`);const d=u.token!==this.m;return this.m=u.token,ut("FirebaseAppCheckTokenProvider",`Received ${d?"new":"existing"} token.`),d?t(u.token):Promise.resolve()};this.o=u=>{e.enqueueRetryable((()=>i(u)))};const l=u=>{ut("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=u,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((u=>l(u))),setTimeout((()=>{if(!this.appCheck){const u=this.V.getImmediate({optional:!0});u?l(u):ut("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new dx(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(Us(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new dx(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function cR(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let i=0;i<n;i++)t[i]=Math.floor(256*Math.random());return t}class ey{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const l=cR(40);for(let u=0;u<l.length;++u)i.length<20&&l[u]<t&&(i+=e.charAt(l[u]%62))}return i}}function ys(n,e){return n<e?-1:n>e?1:0}function mg(n,e){const t=Math.min(n.length,e.length);for(let i=0;i<t;i++){const l=n.charAt(i),u=e.charAt(i);if(l!==u)return Rp(l)===Rp(u)?ys(l,u):Rp(l)?1:-1}return ys(n.length,e.length)}const uR=55296,dR=57343;function Rp(n){const e=n.charCodeAt(0);return e>=uR&&e<=dR}function Kl(n,e,t){return n.length===e.length&&n.every(((i,l)=>t(i,e[l])))}const hx="__name__";class Ia{constructor(e,t,i){t===void 0?t=0:t>e.length&&Bt(637,{offset:t,range:e.length}),i===void 0?i=e.length-t:i>e.length-t&&Bt(1746,{length:i,range:e.length-t}),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return Ia.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Ia?e.forEach((i=>{t.push(i)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const i=Math.min(e.length,t.length);for(let l=0;l<i;l++){const u=Ia.compareSegments(e.get(l),t.get(l));if(u!==0)return u}return ys(e.length,t.length)}static compareSegments(e,t){const i=Ia.isNumericId(e),l=Ia.isNumericId(t);return i&&!l?-1:!i&&l?1:i&&l?Ia.extractNumericId(e).compare(Ia.extractNumericId(t)):mg(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return ro.fromString(e.substring(4,e.length-2))}}class tn extends Ia{construct(e,t,i){return new tn(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const i of e){if(i.indexOf("//")>=0)throw new nt(Te.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter((l=>l.length>0)))}return new tn(t)}static emptyPath(){return new tn([])}}const hR=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class er extends Ia{construct(e,t,i){return new er(e,t,i)}static isValidIdentifier(e){return hR.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),er.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===hx}static keyField(){return new er([hx])}static fromServerFormat(e){const t=[];let i="",l=0;const u=()=>{if(i.length===0)throw new nt(Te.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""};let d=!1;for(;l<e.length;){const p=e[l];if(p==="\\"){if(l+1===e.length)throw new nt(Te.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const g=e[l+1];if(g!=="\\"&&g!=="."&&g!=="`")throw new nt(Te.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=g,l+=2}else p==="`"?(d=!d,l++):p!=="."||d?(i+=p,l++):(u(),l++)}if(u(),d)throw new nt(Te.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new er(t)}static emptyPath(){return new er([])}}class St{constructor(e){this.path=e}static fromPath(e){return new St(tn.fromString(e))}static fromName(e){return new St(tn.fromString(e).popFirst(5))}static empty(){return new St(tn.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&tn.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return tn.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new St(new tn(e.slice()))}}function Ww(n,e,t){if(!t)throw new nt(Te.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function mR(n,e,t,i){if(e===!0&&i===!0)throw new nt(Te.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function mx(n){if(!St.isDocumentKey(n))throw new nt(Te.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function fx(n){if(St.isDocumentKey(n))throw new nt(Te.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function Gw(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function em(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(i){return i.constructor?i.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Bt(12329,{type:typeof n})}function vr(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new nt(Te.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=em(n);throw new nt(Te.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function fR(n,e){if(e<=0)throw new nt(Te.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}function Dn(n,e){const t={typeString:n};return e&&(t.value=e),t}function Du(n,e){if(!Gw(n))throw new nt(Te.INVALID_ARGUMENT,"JSON must be an object");let t;for(const i in e)if(e[i]){const l=e[i].typeString,u="value"in e[i]?{value:e[i].value}:void 0;if(!(i in n)){t=`JSON missing required field: '${i}'`;break}const d=n[i];if(l&&typeof d!==l){t=`JSON field '${i}' must be a ${l}.`;break}if(u!==void 0&&d!==u.value){t=`Expected '${i}' field to equal '${u.value}'`;break}}if(t)throw new nt(Te.INVALID_ARGUMENT,t);return!0}const px=-62135596800,gx=1e6;class vt{static now(){return vt.fromMillis(Date.now())}static fromDate(e){return vt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),i=Math.floor((e-1e3*t)*gx);return new vt(t,i)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new nt(Te.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new nt(Te.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<px)throw new nt(Te.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new nt(Te.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/gx}_compareTo(e){return this.seconds===e.seconds?ys(this.nanoseconds,e.nanoseconds):ys(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:vt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Du(e,vt._jsonSchema))return new vt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-px;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}vt._jsonSchemaVersion="firestore/timestamp/1.0",vt._jsonSchema={type:Dn("string",vt._jsonSchemaVersion),seconds:Dn("number"),nanoseconds:Dn("number")};class Kt{static fromTimestamp(e){return new Kt(e)}static min(){return new Kt(new vt(0,0))}static max(){return new Kt(new vt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const yu=-1;function pR(n,e){const t=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,l=Kt.fromTimestamp(i===1e9?new vt(t+1,0):new vt(t,i));return new oo(l,St.empty(),e)}function gR(n){return new oo(n.readTime,n.key,yu)}class oo{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new oo(Kt.min(),St.empty(),yu)}static max(){return new oo(Kt.max(),St.empty(),yu)}}function yR(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=St.comparator(n.documentKey,e.documentKey),t!==0?t:ys(n.largestBatchId,e.largestBatchId))}const bR="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class vR{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function rc(n){if(n.code!==Te.FAILED_PRECONDITION||n.message!==bR)throw n;ut("LocalStore","Unexpectedly lost primary lease")}class Ie{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Bt(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new Ie(((i,l)=>{this.nextCallback=u=>{this.wrapSuccess(e,u).next(i,l)},this.catchCallback=u=>{this.wrapFailure(t,u).next(i,l)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof Ie?t:Ie.resolve(t)}catch(t){return Ie.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):Ie.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):Ie.reject(t)}static resolve(e){return new Ie(((t,i)=>{t(e)}))}static reject(e){return new Ie(((t,i)=>{i(e)}))}static waitFor(e){return new Ie(((t,i)=>{let l=0,u=0,d=!1;e.forEach((p=>{++l,p.next((()=>{++u,d&&u===l&&t()}),(g=>i(g)))})),d=!0,u===l&&t()}))}static or(e){let t=Ie.resolve(!1);for(const i of e)t=t.next((l=>l?Ie.resolve(l):i()));return t}static forEach(e,t){const i=[];return e.forEach(((l,u)=>{i.push(t.call(this,l,u))})),this.waitFor(i)}static mapArray(e,t){return new Ie(((i,l)=>{const u=e.length,d=new Array(u);let p=0;for(let g=0;g<u;g++){const y=g;t(e[y]).next((w=>{d[y]=w,++p,p===u&&i(d)}),(w=>l(w)))}}))}static doWhile(e,t){return new Ie(((i,l)=>{const u=()=>{e()===!0?t().next((()=>{u()}),l):i()};u()}))}}function xR(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function ac(n){return n.name==="IndexedDbTransactionError"}class tm{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=i=>this.ae(i),this.ue=i=>t.writeSequenceNumber(i))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}tm.ce=-1;const ty=-1;function sm(n){return n==null}function Dh(n){return n===0&&1/n==-1/0}function wR(n){return typeof n=="number"&&Number.isInteger(n)&&!Dh(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}const Kw="";function _R(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=yx(e)),e=kR(n.get(t),e);return yx(e)}function kR(n,e){let t=e;const i=n.length;for(let l=0;l<i;l++){const u=n.charAt(l);switch(u){case"\0":t+="";break;case Kw:t+="";break;default:t+=u}}return t}function yx(n){return n+Kw+""}function bx(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function go(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function Yw(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}class mn{constructor(e,t){this.comparator=e,this.root=t||Zn.EMPTY}insert(e,t){return new mn(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Zn.BLACK,null,null))}remove(e){return new mn(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Zn.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const i=this.comparator(e,t.key);if(i===0)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){const l=this.comparator(e,i.key);if(l===0)return t+i.left.size;l<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,i)=>(e(t,i),!1)))}toString(){const e=[];return this.inorderTraversal(((t,i)=>(e.push(`${t}:${i}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new th(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new th(this.root,e,this.comparator,!1)}getReverseIterator(){return new th(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new th(this.root,e,this.comparator,!0)}}class th{constructor(e,t,i,l){this.isReverse=l,this.nodeStack=[];let u=1;for(;!e.isEmpty();)if(u=t?i(e.key,t):1,t&&l&&(u*=-1),u<0)e=this.isReverse?e.left:e.right;else{if(u===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Zn{constructor(e,t,i,l,u){this.key=e,this.value=t,this.color=i??Zn.RED,this.left=l??Zn.EMPTY,this.right=u??Zn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,l,u){return new Zn(e??this.key,t??this.value,i??this.color,l??this.left,u??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let l=this;const u=i(e,l.key);return l=u<0?l.copy(null,null,null,l.left.insert(e,t,i),null):u===0?l.copy(null,t,null,null,null):l.copy(null,null,null,null,l.right.insert(e,t,i)),l.fixUp()}removeMin(){if(this.left.isEmpty())return Zn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,l=this;if(t(e,l.key)<0)l.left.isEmpty()||l.left.isRed()||l.left.left.isRed()||(l=l.moveRedLeft()),l=l.copy(null,null,null,l.left.remove(e,t),null);else{if(l.left.isRed()&&(l=l.rotateRight()),l.right.isEmpty()||l.right.isRed()||l.right.left.isRed()||(l=l.moveRedRight()),t(e,l.key)===0){if(l.right.isEmpty())return Zn.EMPTY;i=l.right.min(),l=l.copy(i.key,i.value,null,null,l.right.removeMin())}l=l.copy(null,null,null,null,l.right.remove(e,t))}return l.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Zn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Zn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Bt(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Bt(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Bt(27949);return e+(this.isRed()?0:1)}}Zn.EMPTY=null,Zn.RED=!0,Zn.BLACK=!1;Zn.EMPTY=new class{constructor(){this.size=0}get key(){throw Bt(57766)}get value(){throw Bt(16141)}get color(){throw Bt(16727)}get left(){throw Bt(29726)}get right(){throw Bt(36894)}copy(e,t,i,l,u){return this}insert(e,t,i){return new Zn(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Vn{constructor(e){this.comparator=e,this.data=new mn(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,i)=>(e(t),!1)))}forEachInRange(e,t){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const l=i.getNext();if(this.comparator(l.key,e[1])>=0)return;t(l.key)}}forEachWhile(e,t){let i;for(i=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new vx(this.data.getIterator())}getIteratorFrom(e){return new vx(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((i=>{t=t.add(i)})),t}isEqual(e){if(!(e instanceof Vn)||this.size!==e.size)return!1;const t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){const l=t.getNext().key,u=i.getNext().key;if(this.comparator(l,u)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new Vn(this.comparator);return t.data=e,t}}class vx{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class $r{constructor(e){this.fields=e,e.sort(er.comparator)}static empty(){return new $r([])}unionWith(e){let t=new Vn(er.comparator);for(const i of this.fields)t=t.add(i);for(const i of e)t=t.add(i);return new $r(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Kl(this.fields,e.fields,((t,i)=>t.isEqual(i)))}}class Qw extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class tr{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(l){try{return atob(l)}catch(u){throw typeof DOMException<"u"&&u instanceof DOMException?new Qw("Invalid base64 string: "+u):u}})(e);return new tr(t)}static fromUint8Array(e){const t=(function(l){let u="";for(let d=0;d<l.length;++d)u+=String.fromCharCode(l[d]);return u})(e);return new tr(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const i=new Uint8Array(t.length);for(let l=0;l<t.length;l++)i[l]=t.charCodeAt(l);return i})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ys(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}tr.EMPTY_BYTE_STRING=new tr("");const jR=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function lo(n){if(Us(!!n,39018),typeof n=="string"){let e=0;const t=jR.exec(n);if(Us(!!t,46558,{timestamp:n}),t[1]){let l=t[1];l=(l+"000000000").substr(0,9),e=Number(l)}const i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:En(n.seconds),nanos:En(n.nanos)}}function En(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function co(n){return typeof n=="string"?tr.fromBase64String(n):tr.fromUint8Array(n)}const Xw="server_timestamp",Jw="__type__",Zw="__previous_value__",e_="__local_write_time__";function sy(n){return(n?.mapValue?.fields||{})[Jw]?.stringValue===Xw}function nm(n){const e=n.mapValue.fields[Zw];return sy(e)?nm(e):e}function bu(n){const e=lo(n.mapValue.fields[e_].timestampValue);return new vt(e.seconds,e.nanos)}class TR{constructor(e,t,i,l,u,d,p,g,y,w,k){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=l,this.ssl=u,this.forceLongPolling=d,this.autoDetectLongPolling=p,this.longPollingOptions=g,this.useFetchStreams=y,this.isUsingEmulator=w,this.apiKey=k}}const Ph="(default)";class vu{constructor(e,t){this.projectId=e,this.database=t||Ph}static empty(){return new vu("","")}get isDefaultDatabase(){return this.database===Ph}isEqual(e){return e instanceof vu&&e.projectId===this.projectId&&e.database===this.database}}function ER(n,e){if(!Object.prototype.hasOwnProperty.apply(n.options,["projectId"]))throw new nt(Te.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new vu(n.options.projectId,e)}const t_="__type__",NR="__max__",sh={mapValue:{}},s_="__vector__",Lh="value";function uo(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?sy(n)?4:CR(n)?9007199254740991:SR(n)?10:11:Bt(28295,{value:n})}function za(n,e){if(n===e)return!0;const t=uo(n);if(t!==uo(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return bu(n).isEqual(bu(e));case 3:return(function(l,u){if(typeof l.timestampValue=="string"&&typeof u.timestampValue=="string"&&l.timestampValue.length===u.timestampValue.length)return l.timestampValue===u.timestampValue;const d=lo(l.timestampValue),p=lo(u.timestampValue);return d.seconds===p.seconds&&d.nanos===p.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(l,u){return co(l.bytesValue).isEqual(co(u.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(l,u){return En(l.geoPointValue.latitude)===En(u.geoPointValue.latitude)&&En(l.geoPointValue.longitude)===En(u.geoPointValue.longitude)})(n,e);case 2:return(function(l,u){if("integerValue"in l&&"integerValue"in u)return En(l.integerValue)===En(u.integerValue);if("doubleValue"in l&&"doubleValue"in u){const d=En(l.doubleValue),p=En(u.doubleValue);return d===p?Dh(d)===Dh(p):isNaN(d)&&isNaN(p)}return!1})(n,e);case 9:return Kl(n.arrayValue.values||[],e.arrayValue.values||[],za);case 10:case 11:return(function(l,u){const d=l.mapValue.fields||{},p=u.mapValue.fields||{};if(bx(d)!==bx(p))return!1;for(const g in d)if(d.hasOwnProperty(g)&&(p[g]===void 0||!za(d[g],p[g])))return!1;return!0})(n,e);default:return Bt(52216,{left:n})}}function xu(n,e){return(n.values||[]).find((t=>za(t,e)))!==void 0}function Yl(n,e){if(n===e)return 0;const t=uo(n),i=uo(e);if(t!==i)return ys(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return ys(n.booleanValue,e.booleanValue);case 2:return(function(u,d){const p=En(u.integerValue||u.doubleValue),g=En(d.integerValue||d.doubleValue);return p<g?-1:p>g?1:p===g?0:isNaN(p)?isNaN(g)?0:-1:1})(n,e);case 3:return xx(n.timestampValue,e.timestampValue);case 4:return xx(bu(n),bu(e));case 5:return mg(n.stringValue,e.stringValue);case 6:return(function(u,d){const p=co(u),g=co(d);return p.compareTo(g)})(n.bytesValue,e.bytesValue);case 7:return(function(u,d){const p=u.split("/"),g=d.split("/");for(let y=0;y<p.length&&y<g.length;y++){const w=ys(p[y],g[y]);if(w!==0)return w}return ys(p.length,g.length)})(n.referenceValue,e.referenceValue);case 8:return(function(u,d){const p=ys(En(u.latitude),En(d.latitude));return p!==0?p:ys(En(u.longitude),En(d.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return wx(n.arrayValue,e.arrayValue);case 10:return(function(u,d){const p=u.fields||{},g=d.fields||{},y=p[Lh]?.arrayValue,w=g[Lh]?.arrayValue,k=ys(y?.values?.length||0,w?.values?.length||0);return k!==0?k:wx(y,w)})(n.mapValue,e.mapValue);case 11:return(function(u,d){if(u===sh.mapValue&&d===sh.mapValue)return 0;if(u===sh.mapValue)return 1;if(d===sh.mapValue)return-1;const p=u.fields||{},g=Object.keys(p),y=d.fields||{},w=Object.keys(y);g.sort(),w.sort();for(let k=0;k<g.length&&k<w.length;++k){const j=mg(g[k],w[k]);if(j!==0)return j;const O=Yl(p[g[k]],y[w[k]]);if(O!==0)return O}return ys(g.length,w.length)})(n.mapValue,e.mapValue);default:throw Bt(23264,{he:t})}}function xx(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return ys(n,e);const t=lo(n),i=lo(e),l=ys(t.seconds,i.seconds);return l!==0?l:ys(t.nanos,i.nanos)}function wx(n,e){const t=n.values||[],i=e.values||[];for(let l=0;l<t.length&&l<i.length;++l){const u=Yl(t[l],i[l]);if(u)return u}return ys(t.length,i.length)}function Ql(n){return fg(n)}function fg(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const i=lo(t);return`time(${i.seconds},${i.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return co(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return St.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let i="[",l=!0;for(const u of t.values||[])l?l=!1:i+=",",i+=fg(u);return i+"]"})(n.arrayValue):"mapValue"in n?(function(t){const i=Object.keys(t.fields||{}).sort();let l="{",u=!0;for(const d of i)u?u=!1:l+=",",l+=`${d}:${fg(t.fields[d])}`;return l+"}"})(n.mapValue):Bt(61005,{value:n})}function vh(n){switch(uo(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=nm(n);return e?16+vh(e):16;case 5:return 2*n.stringValue.length;case 6:return co(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(i){return(i.values||[]).reduce(((l,u)=>l+vh(u)),0)})(n.arrayValue);case 10:case 11:return(function(i){let l=0;return go(i.fields,((u,d)=>{l+=u.length+vh(d)})),l})(n.mapValue);default:throw Bt(13486,{value:n})}}function _x(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function pg(n){return!!n&&"integerValue"in n}function ny(n){return!!n&&"arrayValue"in n}function kx(n){return!!n&&"nullValue"in n}function jx(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function xh(n){return!!n&&"mapValue"in n}function SR(n){return(n?.mapValue?.fields||{})[t_]?.stringValue===s_}function iu(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return go(n.mapValue.fields,((t,i)=>e.mapValue.fields[t]=iu(i))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=iu(n.arrayValue.values[t]);return e}return{...n}}function CR(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===NR}class Ir{constructor(e){this.value=e}static empty(){return new Ir({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!xh(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=iu(t)}setAll(e){let t=er.emptyPath(),i={},l=[];e.forEach(((d,p)=>{if(!t.isImmediateParentOf(p)){const g=this.getFieldsMap(t);this.applyChanges(g,i,l),i={},l=[],t=p.popLast()}d?i[p.lastSegment()]=iu(d):l.push(p.lastSegment())}));const u=this.getFieldsMap(t);this.applyChanges(u,i,l)}delete(e){const t=this.field(e.popLast());xh(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return za(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let l=t.mapValue.fields[e.get(i)];xh(l)&&l.mapValue.fields||(l={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=l),t=l}return t.mapValue.fields}applyChanges(e,t,i){go(t,((l,u)=>e[l]=u));for(const l of i)delete e[l]}clone(){return new Ir(iu(this.value))}}function n_(n){const e=[];return go(n.fields,((t,i)=>{const l=new er([t]);if(xh(i)){const u=n_(i.mapValue).fields;if(u.length===0)e.push(l);else for(const d of u)e.push(l.child(d))}else e.push(l)})),new $r(e)}class lr{constructor(e,t,i,l,u,d,p){this.key=e,this.documentType=t,this.version=i,this.readTime=l,this.createTime=u,this.data=d,this.documentState=p}static newInvalidDocument(e){return new lr(e,0,Kt.min(),Kt.min(),Kt.min(),Ir.empty(),0)}static newFoundDocument(e,t,i,l){return new lr(e,1,t,Kt.min(),i,l,0)}static newNoDocument(e,t){return new lr(e,2,t,Kt.min(),Kt.min(),Ir.empty(),0)}static newUnknownDocument(e,t){return new lr(e,3,t,Kt.min(),Kt.min(),Ir.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Kt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Ir.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Ir.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Kt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof lr&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new lr(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Oh{constructor(e,t){this.position=e,this.inclusive=t}}function Tx(n,e,t){let i=0;for(let l=0;l<n.position.length;l++){const u=e[l],d=n.position[l];if(u.field.isKeyField()?i=St.comparator(St.fromName(d.referenceValue),t.key):i=Yl(d,t.data.field(u.field)),u.dir==="desc"&&(i*=-1),i!==0)break}return i}function Ex(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!za(n.position[t],e.position[t]))return!1;return!0}class wu{constructor(e,t="asc"){this.field=e,this.dir=t}}function RR(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}class r_{}class Mn extends r_{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,i):new IR(e,t,i):t==="array-contains"?new PR(e,i):t==="in"?new LR(e,i):t==="not-in"?new OR(e,i):t==="array-contains-any"?new VR(e,i):new Mn(e,t,i)}static createKeyFieldInFilter(e,t,i){return t==="in"?new MR(e,i):new DR(e,i)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Yl(t,this.value)):t!==null&&uo(this.value)===uo(t)&&this.matchesComparison(Yl(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Bt(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class va extends r_{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new va(e,t)}matches(e){return a_(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function a_(n){return n.op==="and"}function i_(n){return AR(n)&&a_(n)}function AR(n){for(const e of n.filters)if(e instanceof va)return!1;return!0}function gg(n){if(n instanceof Mn)return n.field.canonicalString()+n.op.toString()+Ql(n.value);if(i_(n))return n.filters.map((e=>gg(e))).join(",");{const e=n.filters.map((t=>gg(t))).join(",");return`${n.op}(${e})`}}function o_(n,e){return n instanceof Mn?(function(i,l){return l instanceof Mn&&i.op===l.op&&i.field.isEqual(l.field)&&za(i.value,l.value)})(n,e):n instanceof va?(function(i,l){return l instanceof va&&i.op===l.op&&i.filters.length===l.filters.length?i.filters.reduce(((u,d,p)=>u&&o_(d,l.filters[p])),!0):!1})(n,e):void Bt(19439)}function l_(n){return n instanceof Mn?(function(t){return`${t.field.canonicalString()} ${t.op} ${Ql(t.value)}`})(n):n instanceof va?(function(t){return t.op.toString()+" {"+t.getFilters().map(l_).join(" ,")+"}"})(n):"Filter"}class IR extends Mn{constructor(e,t,i){super(e,t,i),this.key=St.fromName(i.referenceValue)}matches(e){const t=St.comparator(e.key,this.key);return this.matchesComparison(t)}}class MR extends Mn{constructor(e,t){super(e,"in",t),this.keys=c_("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class DR extends Mn{constructor(e,t){super(e,"not-in",t),this.keys=c_("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function c_(n,e){return(e.arrayValue?.values||[]).map((t=>St.fromName(t.referenceValue)))}class PR extends Mn{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return ny(t)&&xu(t.arrayValue,this.value)}}class LR extends Mn{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&xu(this.value.arrayValue,t)}}class OR extends Mn{constructor(e,t){super(e,"not-in",t)}matches(e){if(xu(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!xu(this.value.arrayValue,t)}}class VR extends Mn{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!ny(t)||!t.arrayValue.values)&&t.arrayValue.values.some((i=>xu(this.value.arrayValue,i)))}}class BR{constructor(e,t=null,i=[],l=[],u=null,d=null,p=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=l,this.limit=u,this.startAt=d,this.endAt=p,this.Te=null}}function Nx(n,e=null,t=[],i=[],l=null,u=null,d=null){return new BR(n,e,t,i,l,u,d)}function ry(n){const e=Jt(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((i=>gg(i))).join(","),t+="|ob:",t+=e.orderBy.map((i=>(function(u){return u.field.canonicalString()+u.dir})(i))).join(","),sm(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((i=>Ql(i))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((i=>Ql(i))).join(",")),e.Te=t}return e.Te}function ay(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!RR(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!o_(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!Ex(n.startAt,e.startAt)&&Ex(n.endAt,e.endAt)}function yg(n){return St.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}class ic{constructor(e,t=null,i=[],l=[],u=null,d="F",p=null,g=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=l,this.limit=u,this.limitType=d,this.startAt=p,this.endAt=g,this.Ie=null,this.Ee=null,this.Re=null,this.startAt,this.endAt}}function UR(n,e,t,i,l,u,d,p){return new ic(n,e,t,i,l,u,d,p)}function rm(n){return new ic(n)}function Sx(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function zR(n){return St.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function u_(n){return n.collectionGroup!==null}function ou(n){const e=Jt(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const u of e.explicitOrderBy)e.Ie.push(u),t.add(u.field.canonicalString());const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(d){let p=new Vn(er.comparator);return d.filters.forEach((g=>{g.getFlattenedFilters().forEach((y=>{y.isInequality()&&(p=p.add(y.field))}))})),p})(e).forEach((u=>{t.has(u.canonicalString())||u.isKeyField()||e.Ie.push(new wu(u,i))})),t.has(er.keyField().canonicalString())||e.Ie.push(new wu(er.keyField(),i))}return e.Ie}function Va(n){const e=Jt(n);return e.Ee||(e.Ee=FR(e,ou(n))),e.Ee}function FR(n,e){if(n.limitType==="F")return Nx(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((l=>{const u=l.dir==="desc"?"asc":"desc";return new wu(l.field,u)}));const t=n.endAt?new Oh(n.endAt.position,n.endAt.inclusive):null,i=n.startAt?new Oh(n.startAt.position,n.startAt.inclusive):null;return Nx(n.path,n.collectionGroup,e,n.filters,n.limit,t,i)}}function bg(n,e){const t=n.filters.concat([e]);return new ic(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function qR(n,e){const t=n.explicitOrderBy.concat([e]);return new ic(n.path,n.collectionGroup,t,n.filters.slice(),n.limit,n.limitType,n.startAt,n.endAt)}function Vh(n,e,t){return new ic(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function am(n,e){return ay(Va(n),Va(e))&&n.limitType===e.limitType}function d_(n){return`${ry(Va(n))}|lt:${n.limitType}`}function Vl(n){return`Query(target=${(function(t){let i=t.path.canonicalString();return t.collectionGroup!==null&&(i+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(i+=`, filters: [${t.filters.map((l=>l_(l))).join(", ")}]`),sm(t.limit)||(i+=", limit: "+t.limit),t.orderBy.length>0&&(i+=`, orderBy: [${t.orderBy.map((l=>(function(d){return`${d.field.canonicalString()} (${d.dir})`})(l))).join(", ")}]`),t.startAt&&(i+=", startAt: ",i+=t.startAt.inclusive?"b:":"a:",i+=t.startAt.position.map((l=>Ql(l))).join(",")),t.endAt&&(i+=", endAt: ",i+=t.endAt.inclusive?"a:":"b:",i+=t.endAt.position.map((l=>Ql(l))).join(",")),`Target(${i})`})(Va(n))}; limitType=${n.limitType})`}function im(n,e){return e.isFoundDocument()&&(function(i,l){const u=l.key.path;return i.collectionGroup!==null?l.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(u):St.isDocumentKey(i.path)?i.path.isEqual(u):i.path.isImmediateParentOf(u)})(n,e)&&(function(i,l){for(const u of ou(i))if(!u.field.isKeyField()&&l.data.field(u.field)===null)return!1;return!0})(n,e)&&(function(i,l){for(const u of i.filters)if(!u.matches(l))return!1;return!0})(n,e)&&(function(i,l){return!(i.startAt&&!(function(d,p,g){const y=Tx(d,p,g);return d.inclusive?y<=0:y<0})(i.startAt,ou(i),l)||i.endAt&&!(function(d,p,g){const y=Tx(d,p,g);return d.inclusive?y>=0:y>0})(i.endAt,ou(i),l))})(n,e)}function HR(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function h_(n){return(e,t)=>{let i=!1;for(const l of ou(n)){const u=$R(l,e,t);if(u!==0)return u;i=i||l.field.isKeyField()}return 0}}function $R(n,e,t){const i=n.field.isKeyField()?St.comparator(e.key,t.key):(function(u,d,p){const g=d.data.field(u),y=p.data.field(u);return g!==null&&y!==null?Yl(g,y):Bt(42886)})(n.field,e,t);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return Bt(19790,{direction:n.dir})}}class Zo{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i!==void 0){for(const[l,u]of i)if(this.equalsFn(l,e))return u}}has(e){return this.get(e)!==void 0}set(e,t){const i=this.mapKeyFn(e),l=this.inner[i];if(l===void 0)return this.inner[i]=[[e,t]],void this.innerSize++;for(let u=0;u<l.length;u++)if(this.equalsFn(l[u][0],e))return void(l[u]=[e,t]);l.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i===void 0)return!1;for(let l=0;l<i.length;l++)if(this.equalsFn(i[l][0],e))return i.length===1?delete this.inner[t]:i.splice(l,1),this.innerSize--,!0;return!1}forEach(e){go(this.inner,((t,i)=>{for(const[l,u]of i)e(l,u)}))}isEmpty(){return Yw(this.inner)}size(){return this.innerSize}}const WR=new mn(St.comparator);function yi(){return WR}const m_=new mn(St.comparator);function tu(...n){let e=m_;for(const t of n)e=e.insert(t.key,t);return e}function f_(n){let e=m_;return n.forEach(((t,i)=>e=e.insert(t,i.overlayedDocument))),e}function Vo(){return lu()}function p_(){return lu()}function lu(){return new Zo((n=>n.toString()),((n,e)=>n.isEqual(e)))}const GR=new mn(St.comparator),KR=new Vn(St.comparator);function bs(...n){let e=KR;for(const t of n)e=e.add(t);return e}const YR=new Vn(ys);function QR(){return YR}function iy(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Dh(e)?"-0":e}}function g_(n){return{integerValue:""+n}}function y_(n,e){return wR(e)?g_(e):iy(n,e)}class om{constructor(){this._=void 0}}function XR(n,e,t){return n instanceof _u?(function(l,u){const d={fields:{[Jw]:{stringValue:Xw},[e_]:{timestampValue:{seconds:l.seconds,nanos:l.nanoseconds}}}};return u&&sy(u)&&(u=nm(u)),u&&(d.fields[Zw]=u),{mapValue:d}})(t,e):n instanceof ku?v_(n,e):n instanceof ju?x_(n,e):(function(l,u){const d=b_(l,u),p=Cx(d)+Cx(l.Ae);return pg(d)&&pg(l.Ae)?g_(p):iy(l.serializer,p)})(n,e)}function JR(n,e,t){return n instanceof ku?v_(n,e):n instanceof ju?x_(n,e):t}function b_(n,e){return n instanceof Tu?(function(i){return pg(i)||(function(u){return!!u&&"doubleValue"in u})(i)})(e)?e:{integerValue:0}:null}class _u extends om{}class ku extends om{constructor(e){super(),this.elements=e}}function v_(n,e){const t=w_(e);for(const i of n.elements)t.some((l=>za(l,i)))||t.push(i);return{arrayValue:{values:t}}}class ju extends om{constructor(e){super(),this.elements=e}}function x_(n,e){let t=w_(e);for(const i of n.elements)t=t.filter((l=>!za(l,i)));return{arrayValue:{values:t}}}class Tu extends om{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function Cx(n){return En(n.integerValue||n.doubleValue)}function w_(n){return ny(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class __{constructor(e,t){this.field=e,this.transform=t}}function ZR(n,e){return n.field.isEqual(e.field)&&(function(i,l){return i instanceof ku&&l instanceof ku||i instanceof ju&&l instanceof ju?Kl(i.elements,l.elements,za):i instanceof Tu&&l instanceof Tu?za(i.Ae,l.Ae):i instanceof _u&&l instanceof _u})(n.transform,e.transform)}class eA{constructor(e,t){this.version=e,this.transformResults=t}}class xr{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new xr}static exists(e){return new xr(void 0,e)}static updateTime(e){return new xr(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function wh(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class lm{}function k_(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new cm(n.key,xr.none()):new Pu(n.key,n.data,xr.none());{const t=n.data,i=Ir.empty();let l=new Vn(er.comparator);for(let u of e.fields)if(!l.has(u)){let d=t.field(u);d===null&&u.length>1&&(u=u.popLast(),d=t.field(u)),d===null?i.delete(u):i.set(u,d),l=l.add(u)}return new yo(n.key,i,new $r(l.toArray()),xr.none())}}function tA(n,e,t){n instanceof Pu?(function(l,u,d){const p=l.value.clone(),g=Ax(l.fieldTransforms,u,d.transformResults);p.setAll(g),u.convertToFoundDocument(d.version,p).setHasCommittedMutations()})(n,e,t):n instanceof yo?(function(l,u,d){if(!wh(l.precondition,u))return void u.convertToUnknownDocument(d.version);const p=Ax(l.fieldTransforms,u,d.transformResults),g=u.data;g.setAll(j_(l)),g.setAll(p),u.convertToFoundDocument(d.version,g).setHasCommittedMutations()})(n,e,t):(function(l,u,d){u.convertToNoDocument(d.version).setHasCommittedMutations()})(0,e,t)}function cu(n,e,t,i){return n instanceof Pu?(function(u,d,p,g){if(!wh(u.precondition,d))return p;const y=u.value.clone(),w=Ix(u.fieldTransforms,g,d);return y.setAll(w),d.convertToFoundDocument(d.version,y).setHasLocalMutations(),null})(n,e,t,i):n instanceof yo?(function(u,d,p,g){if(!wh(u.precondition,d))return p;const y=Ix(u.fieldTransforms,g,d),w=d.data;return w.setAll(j_(u)),w.setAll(y),d.convertToFoundDocument(d.version,w).setHasLocalMutations(),p===null?null:p.unionWith(u.fieldMask.fields).unionWith(u.fieldTransforms.map((k=>k.field)))})(n,e,t,i):(function(u,d,p){return wh(u.precondition,d)?(d.convertToNoDocument(d.version).setHasLocalMutations(),null):p})(n,e,t)}function sA(n,e){let t=null;for(const i of n.fieldTransforms){const l=e.data.field(i.field),u=b_(i.transform,l||null);u!=null&&(t===null&&(t=Ir.empty()),t.set(i.field,u))}return t||null}function Rx(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(i,l){return i===void 0&&l===void 0||!(!i||!l)&&Kl(i,l,((u,d)=>ZR(u,d)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class Pu extends lm{constructor(e,t,i,l=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=l,this.type=0}getFieldMask(){return null}}class yo extends lm{constructor(e,t,i,l,u=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=l,this.fieldTransforms=u,this.type=1}getFieldMask(){return this.fieldMask}}function j_(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const i=n.data.field(t);e.set(t,i)}})),e}function Ax(n,e,t){const i=new Map;Us(n.length===t.length,32656,{Ve:t.length,de:n.length});for(let l=0;l<t.length;l++){const u=n[l],d=u.transform,p=e.data.field(u.field);i.set(u.field,JR(d,p,t[l]))}return i}function Ix(n,e,t){const i=new Map;for(const l of n){const u=l.transform,d=t.data.field(l.field);i.set(l.field,XR(u,d,e))}return i}class cm extends lm{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class nA extends lm{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class rA{constructor(e,t,i,l){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=l}applyToRemoteDocument(e,t){const i=t.mutationResults;for(let l=0;l<this.mutations.length;l++){const u=this.mutations[l];u.key.isEqual(e.key)&&tA(u,e,i[l])}}applyToLocalView(e,t){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(t=cu(i,e,t,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(t=cu(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const i=p_();return this.mutations.forEach((l=>{const u=e.get(l.key),d=u.overlayedDocument;let p=this.applyToLocalView(d,u.mutatedFields);p=t.has(l.key)?null:p;const g=k_(d,p);g!==null&&i.set(l.key,g),d.isValidDocument()||d.convertToNoDocument(Kt.min())})),i}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),bs())}isEqual(e){return this.batchId===e.batchId&&Kl(this.mutations,e.mutations,((t,i)=>Rx(t,i)))&&Kl(this.baseMutations,e.baseMutations,((t,i)=>Rx(t,i)))}}class oy{constructor(e,t,i,l){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=l}static from(e,t,i){Us(e.mutations.length===i.length,58842,{me:e.mutations.length,fe:i.length});let l=(function(){return GR})();const u=e.mutations;for(let d=0;d<u.length;d++)l=l.insert(u[d].key,i[d].version);return new oy(e,t,i,l)}}class aA{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class iA{constructor(e,t){this.count=e,this.unchangedNames=t}}var In,ks;function oA(n){switch(n){case Te.OK:return Bt(64938);case Te.CANCELLED:case Te.UNKNOWN:case Te.DEADLINE_EXCEEDED:case Te.RESOURCE_EXHAUSTED:case Te.INTERNAL:case Te.UNAVAILABLE:case Te.UNAUTHENTICATED:return!1;case Te.INVALID_ARGUMENT:case Te.NOT_FOUND:case Te.ALREADY_EXISTS:case Te.PERMISSION_DENIED:case Te.FAILED_PRECONDITION:case Te.ABORTED:case Te.OUT_OF_RANGE:case Te.UNIMPLEMENTED:case Te.DATA_LOSS:return!0;default:return Bt(15467,{code:n})}}function T_(n){if(n===void 0)return gi("GRPC error has no .code"),Te.UNKNOWN;switch(n){case In.OK:return Te.OK;case In.CANCELLED:return Te.CANCELLED;case In.UNKNOWN:return Te.UNKNOWN;case In.DEADLINE_EXCEEDED:return Te.DEADLINE_EXCEEDED;case In.RESOURCE_EXHAUSTED:return Te.RESOURCE_EXHAUSTED;case In.INTERNAL:return Te.INTERNAL;case In.UNAVAILABLE:return Te.UNAVAILABLE;case In.UNAUTHENTICATED:return Te.UNAUTHENTICATED;case In.INVALID_ARGUMENT:return Te.INVALID_ARGUMENT;case In.NOT_FOUND:return Te.NOT_FOUND;case In.ALREADY_EXISTS:return Te.ALREADY_EXISTS;case In.PERMISSION_DENIED:return Te.PERMISSION_DENIED;case In.FAILED_PRECONDITION:return Te.FAILED_PRECONDITION;case In.ABORTED:return Te.ABORTED;case In.OUT_OF_RANGE:return Te.OUT_OF_RANGE;case In.UNIMPLEMENTED:return Te.UNIMPLEMENTED;case In.DATA_LOSS:return Te.DATA_LOSS;default:return Bt(39323,{code:n})}}(ks=In||(In={}))[ks.OK=0]="OK",ks[ks.CANCELLED=1]="CANCELLED",ks[ks.UNKNOWN=2]="UNKNOWN",ks[ks.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ks[ks.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ks[ks.NOT_FOUND=5]="NOT_FOUND",ks[ks.ALREADY_EXISTS=6]="ALREADY_EXISTS",ks[ks.PERMISSION_DENIED=7]="PERMISSION_DENIED",ks[ks.UNAUTHENTICATED=16]="UNAUTHENTICATED",ks[ks.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ks[ks.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ks[ks.ABORTED=10]="ABORTED",ks[ks.OUT_OF_RANGE=11]="OUT_OF_RANGE",ks[ks.UNIMPLEMENTED=12]="UNIMPLEMENTED",ks[ks.INTERNAL=13]="INTERNAL",ks[ks.UNAVAILABLE=14]="UNAVAILABLE",ks[ks.DATA_LOSS=15]="DATA_LOSS";function lA(){return new TextEncoder}const cA=new ro([4294967295,4294967295],0);function Mx(n){const e=lA().encode(n),t=new Vw;return t.update(e),new Uint8Array(t.digest())}function Dx(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),i=e.getUint32(4,!0),l=e.getUint32(8,!0),u=e.getUint32(12,!0);return[new ro([t,i],0),new ro([l,u],0)]}class ly{constructor(e,t,i){if(this.bitmap=e,this.padding=t,this.hashCount=i,t<0||t>=8)throw new su(`Invalid padding: ${t}`);if(i<0)throw new su(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new su(`Invalid hash count: ${i}`);if(e.length===0&&t!==0)throw new su(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=ro.fromNumber(this.ge)}ye(e,t,i){let l=e.add(t.multiply(ro.fromNumber(i)));return l.compare(cA)===1&&(l=new ro([l.getBits(0),l.getBits(1)],0)),l.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=Mx(e),[i,l]=Dx(t);for(let u=0;u<this.hashCount;u++){const d=this.ye(i,l,u);if(!this.we(d))return!1}return!0}static create(e,t,i){const l=e%8==0?0:8-e%8,u=new Uint8Array(Math.ceil(e/8)),d=new ly(u,l,t);return i.forEach((p=>d.insert(p))),d}insert(e){if(this.ge===0)return;const t=Mx(e),[i,l]=Dx(t);for(let u=0;u<this.hashCount;u++){const d=this.ye(i,l,u);this.be(d)}}be(e){const t=Math.floor(e/8),i=e%8;this.bitmap[t]|=1<<i}}class su extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class um{constructor(e,t,i,l,u){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=i,this.documentUpdates=l,this.resolvedLimboDocuments=u}static createSynthesizedRemoteEventForCurrentChange(e,t,i){const l=new Map;return l.set(e,Lu.createSynthesizedTargetChangeForCurrentChange(e,t,i)),new um(Kt.min(),l,new mn(ys),yi(),bs())}}class Lu{constructor(e,t,i,l,u){this.resumeToken=e,this.current=t,this.addedDocuments=i,this.modifiedDocuments=l,this.removedDocuments=u}static createSynthesizedTargetChangeForCurrentChange(e,t,i){return new Lu(i,t,bs(),bs(),bs())}}class _h{constructor(e,t,i,l){this.Se=e,this.removedTargetIds=t,this.key=i,this.De=l}}class E_{constructor(e,t){this.targetId=e,this.Ce=t}}class N_{constructor(e,t,i=tr.EMPTY_BYTE_STRING,l=null){this.state=e,this.targetIds=t,this.resumeToken=i,this.cause=l}}class Px{constructor(){this.ve=0,this.Fe=Lx(),this.Me=tr.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=bs(),t=bs(),i=bs();return this.Fe.forEach(((l,u)=>{switch(u){case 0:e=e.add(l);break;case 2:t=t.add(l);break;case 1:i=i.add(l);break;default:Bt(38017,{changeType:u})}})),new Lu(this.Me,this.xe,e,t,i)}Ke(){this.Oe=!1,this.Fe=Lx()}qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}Ue(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}$e(){this.ve+=1}We(){this.ve-=1,Us(this.ve>=0,3241,{ve:this.ve})}Qe(){this.Oe=!0,this.xe=!0}}class uA{constructor(e){this.Ge=e,this.ze=new Map,this.je=yi(),this.He=nh(),this.Je=nh(),this.Ze=new mn(ys)}Xe(e){for(const t of e.Se)e.De&&e.De.isFoundDocument()?this.Ye(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const i=this.nt(t);switch(e.state){case 0:this.rt(t)&&i.Le(e.resumeToken);break;case 1:i.We(),i.Ne||i.Ke(),i.Le(e.resumeToken);break;case 2:i.We(),i.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(i.Qe(),i.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),i.Le(e.resumeToken));break;default:Bt(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((i,l)=>{this.rt(l)&&t(l)}))}st(e){const t=e.targetId,i=e.Ce.count,l=this.ot(t);if(l){const u=l.target;if(yg(u))if(i===0){const d=new St(u.path);this.et(t,d,lr.newNoDocument(d,Kt.min()))}else Us(i===1,20013,{expectedCount:i});else{const d=this._t(t);if(d!==i){const p=this.ut(e),g=p?this.ct(p,e,d):1;if(g!==0){this.it(t);const y=g===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(t,y)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:i="",padding:l=0},hashCount:u=0}=t;let d,p;try{d=co(i).toUint8Array()}catch(g){if(g instanceof Qw)return Gl("Decoding the base64 bloom filter in existence filter failed ("+g.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw g}try{p=new ly(d,l,u)}catch(g){return Gl(g instanceof su?"BloomFilter error: ":"Applying bloom filter failed: ",g),null}return p.ge===0?null:p}ct(e,t,i){return t.Ce.count===i-this.Pt(e,t.targetId)?0:2}Pt(e,t){const i=this.Ge.getRemoteKeysForTarget(t);let l=0;return i.forEach((u=>{const d=this.Ge.ht(),p=`projects/${d.projectId}/databases/${d.database}/documents/${u.path.canonicalString()}`;e.mightContain(p)||(this.et(t,u,null),l++)})),l}Tt(e){const t=new Map;this.ze.forEach(((u,d)=>{const p=this.ot(d);if(p){if(u.current&&yg(p.target)){const g=new St(p.target.path);this.It(g).has(d)||this.Et(d,g)||this.et(d,g,lr.newNoDocument(g,e))}u.Be&&(t.set(d,u.ke()),u.Ke())}}));let i=bs();this.Je.forEach(((u,d)=>{let p=!0;d.forEachWhile((g=>{const y=this.ot(g);return!y||y.purpose==="TargetPurposeLimboResolution"||(p=!1,!1)})),p&&(i=i.add(u))})),this.je.forEach(((u,d)=>d.setReadTime(e)));const l=new um(e,t,this.Ze,this.je,i);return this.je=yi(),this.He=nh(),this.Je=nh(),this.Ze=new mn(ys),l}Ye(e,t){if(!this.rt(e))return;const i=this.Et(e,t.key)?2:0;this.nt(e).qe(t.key,i),this.je=this.je.insert(t.key,t),this.He=this.He.insert(t.key,this.It(t.key).add(e)),this.Je=this.Je.insert(t.key,this.Rt(t.key).add(e))}et(e,t,i){if(!this.rt(e))return;const l=this.nt(e);this.Et(e,t)?l.qe(t,1):l.Ue(t),this.Je=this.Je.insert(t,this.Rt(t).delete(e)),this.Je=this.Je.insert(t,this.Rt(t).add(e)),i&&(this.je=this.je.insert(t,i))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.nt(e).$e()}nt(e){let t=this.ze.get(e);return t||(t=new Px,this.ze.set(e,t)),t}Rt(e){let t=this.Je.get(e);return t||(t=new Vn(ys),this.Je=this.Je.insert(e,t)),t}It(e){let t=this.He.get(e);return t||(t=new Vn(ys),this.He=this.He.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||ut("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new Px),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function nh(){return new mn(St.comparator)}function Lx(){return new mn(St.comparator)}const dA={asc:"ASCENDING",desc:"DESCENDING"},hA={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},mA={and:"AND",or:"OR"};class fA{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function vg(n,e){return n.useProto3Json||sm(e)?e:{value:e}}function Bh(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function S_(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function pA(n,e){return Bh(n,e.toTimestamp())}function Ba(n){return Us(!!n,49232),Kt.fromTimestamp((function(t){const i=lo(t);return new vt(i.seconds,i.nanos)})(n))}function cy(n,e){return xg(n,e).canonicalString()}function xg(n,e){const t=(function(l){return new tn(["projects",l.projectId,"databases",l.database])})(n).child("documents");return e===void 0?t:t.child(e)}function C_(n){const e=tn.fromString(n);return Us(D_(e),10190,{key:e.toString()}),e}function wg(n,e){return cy(n.databaseId,e.path)}function Ap(n,e){const t=C_(e);if(t.get(1)!==n.databaseId.projectId)throw new nt(Te.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new nt(Te.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new St(A_(t))}function R_(n,e){return cy(n.databaseId,e)}function gA(n){const e=C_(n);return e.length===4?tn.emptyPath():A_(e)}function _g(n){return new tn(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function A_(n){return Us(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function Ox(n,e,t){return{name:wg(n,e),fields:t.value.mapValue.fields}}function yA(n,e){let t;if("targetChange"in e){e.targetChange;const i=(function(y){return y==="NO_CHANGE"?0:y==="ADD"?1:y==="REMOVE"?2:y==="CURRENT"?3:y==="RESET"?4:Bt(39313,{state:y})})(e.targetChange.targetChangeType||"NO_CHANGE"),l=e.targetChange.targetIds||[],u=(function(y,w){return y.useProto3Json?(Us(w===void 0||typeof w=="string",58123),tr.fromBase64String(w||"")):(Us(w===void 0||w instanceof Buffer||w instanceof Uint8Array,16193),tr.fromUint8Array(w||new Uint8Array))})(n,e.targetChange.resumeToken),d=e.targetChange.cause,p=d&&(function(y){const w=y.code===void 0?Te.UNKNOWN:T_(y.code);return new nt(w,y.message||"")})(d);t=new N_(i,l,u,p||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const l=Ap(n,i.document.name),u=Ba(i.document.updateTime),d=i.document.createTime?Ba(i.document.createTime):Kt.min(),p=new Ir({mapValue:{fields:i.document.fields}}),g=lr.newFoundDocument(l,u,d,p),y=i.targetIds||[],w=i.removedTargetIds||[];t=new _h(y,w,g.key,g)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const l=Ap(n,i.document),u=i.readTime?Ba(i.readTime):Kt.min(),d=lr.newNoDocument(l,u),p=i.removedTargetIds||[];t=new _h([],p,d.key,d)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const l=Ap(n,i.document),u=i.removedTargetIds||[];t=new _h([],u,l,null)}else{if(!("filter"in e))return Bt(11601,{Vt:e});{e.filter;const i=e.filter;i.targetId;const{count:l=0,unchangedNames:u}=i,d=new iA(l,u),p=i.targetId;t=new E_(p,d)}}return t}function bA(n,e){let t;if(e instanceof Pu)t={update:Ox(n,e.key,e.value)};else if(e instanceof cm)t={delete:wg(n,e.key)};else if(e instanceof yo)t={update:Ox(n,e.key,e.data),updateMask:NA(e.fieldMask)};else{if(!(e instanceof nA))return Bt(16599,{dt:e.type});t={verify:wg(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((i=>(function(u,d){const p=d.transform;if(p instanceof _u)return{fieldPath:d.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(p instanceof ku)return{fieldPath:d.field.canonicalString(),appendMissingElements:{values:p.elements}};if(p instanceof ju)return{fieldPath:d.field.canonicalString(),removeAllFromArray:{values:p.elements}};if(p instanceof Tu)return{fieldPath:d.field.canonicalString(),increment:p.Ae};throw Bt(20930,{transform:d.transform})})(0,i)))),e.precondition.isNone||(t.currentDocument=(function(l,u){return u.updateTime!==void 0?{updateTime:pA(l,u.updateTime)}:u.exists!==void 0?{exists:u.exists}:Bt(27497)})(n,e.precondition)),t}function vA(n,e){return n&&n.length>0?(Us(e!==void 0,14353),n.map((t=>(function(l,u){let d=l.updateTime?Ba(l.updateTime):Ba(u);return d.isEqual(Kt.min())&&(d=Ba(u)),new eA(d,l.transformResults||[])})(t,e)))):[]}function xA(n,e){return{documents:[R_(n,e.path)]}}function wA(n,e){const t={structuredQuery:{}},i=e.path;let l;e.collectionGroup!==null?(l=i,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(l=i.popLast(),t.structuredQuery.from=[{collectionId:i.lastSegment()}]),t.parent=R_(n,l);const u=(function(y){if(y.length!==0)return M_(va.create(y,"and"))})(e.filters);u&&(t.structuredQuery.where=u);const d=(function(y){if(y.length!==0)return y.map((w=>(function(j){return{field:Bl(j.field),direction:jA(j.dir)}})(w)))})(e.orderBy);d&&(t.structuredQuery.orderBy=d);const p=vg(n,e.limit);return p!==null&&(t.structuredQuery.limit=p),e.startAt&&(t.structuredQuery.startAt=(function(y){return{before:y.inclusive,values:y.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(y){return{before:!y.inclusive,values:y.position}})(e.endAt)),{ft:t,parent:l}}function _A(n){let e=gA(n.parent);const t=n.structuredQuery,i=t.from?t.from.length:0;let l=null;if(i>0){Us(i===1,65062);const w=t.from[0];w.allDescendants?l=w.collectionId:e=e.child(w.collectionId)}let u=[];t.where&&(u=(function(k){const j=I_(k);return j instanceof va&&i_(j)?j.getFilters():[j]})(t.where));let d=[];t.orderBy&&(d=(function(k){return k.map((j=>(function(H){return new wu(Ul(H.field),(function(V){switch(V){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(H.direction))})(j)))})(t.orderBy));let p=null;t.limit&&(p=(function(k){let j;return j=typeof k=="object"?k.value:k,sm(j)?null:j})(t.limit));let g=null;t.startAt&&(g=(function(k){const j=!!k.before,O=k.values||[];return new Oh(O,j)})(t.startAt));let y=null;return t.endAt&&(y=(function(k){const j=!k.before,O=k.values||[];return new Oh(O,j)})(t.endAt)),UR(e,l,d,u,p,"F",g,y)}function kA(n,e){const t=(function(l){switch(l){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Bt(28987,{purpose:l})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function I_(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const i=Ul(t.unaryFilter.field);return Mn.create(i,"==",{doubleValue:NaN});case"IS_NULL":const l=Ul(t.unaryFilter.field);return Mn.create(l,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const u=Ul(t.unaryFilter.field);return Mn.create(u,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const d=Ul(t.unaryFilter.field);return Mn.create(d,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Bt(61313);default:return Bt(60726)}})(n):n.fieldFilter!==void 0?(function(t){return Mn.create(Ul(t.fieldFilter.field),(function(l){switch(l){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Bt(58110);default:return Bt(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return va.create(t.compositeFilter.filters.map((i=>I_(i))),(function(l){switch(l){case"AND":return"and";case"OR":return"or";default:return Bt(1026)}})(t.compositeFilter.op))})(n):Bt(30097,{filter:n})}function jA(n){return dA[n]}function TA(n){return hA[n]}function EA(n){return mA[n]}function Bl(n){return{fieldPath:n.canonicalString()}}function Ul(n){return er.fromServerFormat(n.fieldPath)}function M_(n){return n instanceof Mn?(function(t){if(t.op==="=="){if(jx(t.value))return{unaryFilter:{field:Bl(t.field),op:"IS_NAN"}};if(kx(t.value))return{unaryFilter:{field:Bl(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(jx(t.value))return{unaryFilter:{field:Bl(t.field),op:"IS_NOT_NAN"}};if(kx(t.value))return{unaryFilter:{field:Bl(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Bl(t.field),op:TA(t.op),value:t.value}}})(n):n instanceof va?(function(t){const i=t.getFilters().map((l=>M_(l)));return i.length===1?i[0]:{compositeFilter:{op:EA(t.op),filters:i}}})(n):Bt(54877,{filter:n})}function NA(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function D_(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}function P_(n){return!!n&&typeof n._toProto=="function"&&n._protoValueType==="ProtoValue"}class Zi{constructor(e,t,i,l,u=Kt.min(),d=Kt.min(),p=tr.EMPTY_BYTE_STRING,g=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=l,this.snapshotVersion=u,this.lastLimboFreeSnapshotVersion=d,this.resumeToken=p,this.expectedCount=g}withSequenceNumber(e){return new Zi(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Zi(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Zi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Zi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class SA{constructor(e){this.yt=e}}function CA(n){const e=_A({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Vh(e,e.limit,"L"):e}class RA{constructor(){this.Sn=new AA}addToCollectionParentIndex(e,t){return this.Sn.add(t),Ie.resolve()}getCollectionParents(e,t){return Ie.resolve(this.Sn.getEntries(t))}addFieldIndex(e,t){return Ie.resolve()}deleteFieldIndex(e,t){return Ie.resolve()}deleteAllFieldIndexes(e){return Ie.resolve()}createTargetIndexes(e,t){return Ie.resolve()}getDocumentsMatchingTarget(e,t){return Ie.resolve(null)}getIndexType(e,t){return Ie.resolve(0)}getFieldIndexes(e,t){return Ie.resolve([])}getNextCollectionGroupToUpdate(e){return Ie.resolve(null)}getMinOffset(e,t){return Ie.resolve(oo.min())}getMinOffsetFromCollectionGroup(e,t){return Ie.resolve(oo.min())}updateCollectionGroup(e,t,i){return Ie.resolve()}updateIndexEntries(e,t){return Ie.resolve()}}class AA{constructor(){this.index={}}add(e){const t=e.lastSegment(),i=e.popLast(),l=this.index[t]||new Vn(tn.comparator),u=!l.has(i);return this.index[t]=l.add(i),u}has(e){const t=e.lastSegment(),i=e.popLast(),l=this.index[t];return l&&l.has(i)}getEntries(e){return(this.index[e]||new Vn(tn.comparator)).toArray()}}const Vx={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},L_=41943040;class Ar{static withCacheSize(e){return new Ar(e,Ar.DEFAULT_COLLECTION_PERCENTILE,Ar.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}}Ar.DEFAULT_COLLECTION_PERCENTILE=10,Ar.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Ar.DEFAULT=new Ar(L_,Ar.DEFAULT_COLLECTION_PERCENTILE,Ar.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Ar.DISABLED=new Ar(-1,0,0);class Xl{constructor(e){this.sr=e}next(){return this.sr+=2,this.sr}static _r(){return new Xl(0)}static ar(){return new Xl(-1)}}const Bx="LruGarbageCollector",IA=1048576;function Ux([n,e],[t,i]){const l=ys(n,t);return l===0?ys(e,i):l}class MA{constructor(e){this.Pr=e,this.buffer=new Vn(Ux),this.Tr=0}Ir(){return++this.Tr}Er(e){const t=[e,this.Ir()];if(this.buffer.size<this.Pr)this.buffer=this.buffer.add(t);else{const i=this.buffer.last();Ux(t,i)<0&&(this.buffer=this.buffer.delete(i).add(t))}}get maxValue(){return this.buffer.last()[0]}}class DA{constructor(e,t,i){this.garbageCollector=e,this.asyncQueue=t,this.localStore=i,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Ar(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Ar(e){ut(Bx,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){ac(t)?ut(Bx,"Ignoring IndexedDB error during garbage collection: ",t):await rc(t)}await this.Ar(3e5)}))}}class PA{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.dr(e).next((i=>Math.floor(t/100*i)))}nthSequenceNumber(e,t){if(t===0)return Ie.resolve(tm.ce);const i=new MA(t);return this.Vr.forEachTarget(e,(l=>i.Er(l.sequenceNumber))).next((()=>this.Vr.mr(e,(l=>i.Er(l))))).next((()=>i.maxValue))}removeTargets(e,t,i){return this.Vr.removeTargets(e,t,i)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(ut("LruGarbageCollector","Garbage collection skipped; disabled"),Ie.resolve(Vx)):this.getCacheSize(e).next((i=>i<this.params.cacheSizeCollectionThreshold?(ut("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Vx):this.gr(e,t)))}getCacheSize(e){return this.Vr.getCacheSize(e)}gr(e,t){let i,l,u,d,p,g,y;const w=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((k=>(k>this.params.maximumSequenceNumbersToCollect?(ut("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${k}`),l=this.params.maximumSequenceNumbersToCollect):l=k,d=Date.now(),this.nthSequenceNumber(e,l)))).next((k=>(i=k,p=Date.now(),this.removeTargets(e,i,t)))).next((k=>(u=k,g=Date.now(),this.removeOrphanedDocuments(e,i)))).next((k=>(y=Date.now(),Ol()<=gs.DEBUG&&ut("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${d-w}ms
	Determined least recently used ${l} in `+(p-d)+`ms
	Removed ${u} targets in `+(g-p)+`ms
	Removed ${k} documents in `+(y-g)+`ms
Total Duration: ${y-w}ms`),Ie.resolve({didRun:!0,sequenceNumbersCollected:l,targetsRemoved:u,documentsRemoved:k}))))}}function LA(n,e){return new PA(n,e)}class OA{constructor(){this.changes=new Zo((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,lr.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const i=this.changes.get(t);return i!==void 0?Ie.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class VA{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class BA{constructor(e,t,i,l){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=l}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next((l=>(i=l,this.remoteDocumentCache.getEntry(e,t)))).next((l=>(i!==null&&cu(i.mutation,l,$r.empty(),vt.now()),l)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.getLocalViewOfDocuments(e,i,bs()).next((()=>i))))}getLocalViewOfDocuments(e,t,i=bs()){const l=Vo();return this.populateOverlays(e,l,t).next((()=>this.computeViews(e,t,l,i).next((u=>{let d=tu();return u.forEach(((p,g)=>{d=d.insert(p,g.overlayedDocument)})),d}))))}getOverlayedDocuments(e,t){const i=Vo();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,bs())))}populateOverlays(e,t,i){const l=[];return i.forEach((u=>{t.has(u)||l.push(u)})),this.documentOverlayCache.getOverlays(e,l).next((u=>{u.forEach(((d,p)=>{t.set(d,p)}))}))}computeViews(e,t,i,l){let u=yi();const d=lu(),p=(function(){return lu()})();return t.forEach(((g,y)=>{const w=i.get(y.key);l.has(y.key)&&(w===void 0||w.mutation instanceof yo)?u=u.insert(y.key,y):w!==void 0?(d.set(y.key,w.mutation.getFieldMask()),cu(w.mutation,y,w.mutation.getFieldMask(),vt.now())):d.set(y.key,$r.empty())})),this.recalculateAndSaveOverlays(e,u).next((g=>(g.forEach(((y,w)=>d.set(y,w))),t.forEach(((y,w)=>p.set(y,new VA(w,d.get(y)??null)))),p)))}recalculateAndSaveOverlays(e,t){const i=lu();let l=new mn(((d,p)=>d-p)),u=bs();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((d=>{for(const p of d)p.keys().forEach((g=>{const y=t.get(g);if(y===null)return;let w=i.get(g)||$r.empty();w=p.applyToLocalView(y,w),i.set(g,w);const k=(l.get(p.batchId)||bs()).add(g);l=l.insert(p.batchId,k)}))})).next((()=>{const d=[],p=l.getReverseIterator();for(;p.hasNext();){const g=p.getNext(),y=g.key,w=g.value,k=p_();w.forEach((j=>{if(!u.has(j)){const O=k_(t.get(j),i.get(j));O!==null&&k.set(j,O),u=u.add(j)}})),d.push(this.documentOverlayCache.saveOverlays(e,y,k))}return Ie.waitFor(d)})).next((()=>i))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.recalculateAndSaveOverlays(e,i)))}getDocumentsMatchingQuery(e,t,i,l){return zR(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):u_(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i,l):this.getDocumentsMatchingCollectionQuery(e,t,i,l)}getNextDocuments(e,t,i,l){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,l).next((u=>{const d=l-u.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,l-u.size):Ie.resolve(Vo());let p=yu,g=u;return d.next((y=>Ie.forEach(y,((w,k)=>(p<k.largestBatchId&&(p=k.largestBatchId),u.get(w)?Ie.resolve():this.remoteDocumentCache.getEntry(e,w).next((j=>{g=g.insert(w,j)}))))).next((()=>this.populateOverlays(e,y,u))).next((()=>this.computeViews(e,g,y,bs()))).next((w=>({batchId:p,changes:f_(w)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new St(t)).next((i=>{let l=tu();return i.isFoundDocument()&&(l=l.insert(i.key,i)),l}))}getDocumentsMatchingCollectionGroupQuery(e,t,i,l){const u=t.collectionGroup;let d=tu();return this.indexManager.getCollectionParents(e,u).next((p=>Ie.forEach(p,(g=>{const y=(function(k,j){return new ic(j,null,k.explicitOrderBy.slice(),k.filters.slice(),k.limit,k.limitType,k.startAt,k.endAt)})(t,g.child(u));return this.getDocumentsMatchingCollectionQuery(e,y,i,l).next((w=>{w.forEach(((k,j)=>{d=d.insert(k,j)}))}))})).next((()=>d))))}getDocumentsMatchingCollectionQuery(e,t,i,l){let u;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next((d=>(u=d,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,u,l)))).next((d=>{u.forEach(((g,y)=>{const w=y.getKey();d.get(w)===null&&(d=d.insert(w,lr.newInvalidDocument(w)))}));let p=tu();return d.forEach(((g,y)=>{const w=u.get(g);w!==void 0&&cu(w.mutation,y,$r.empty(),vt.now()),im(t,y)&&(p=p.insert(g,y))})),p}))}}class UA{constructor(e){this.serializer=e,this.Nr=new Map,this.Br=new Map}getBundleMetadata(e,t){return Ie.resolve(this.Nr.get(t))}saveBundleMetadata(e,t){return this.Nr.set(t.id,(function(l){return{id:l.id,version:l.version,createTime:Ba(l.createTime)}})(t)),Ie.resolve()}getNamedQuery(e,t){return Ie.resolve(this.Br.get(t))}saveNamedQuery(e,t){return this.Br.set(t.name,(function(l){return{name:l.name,query:CA(l.bundledQuery),readTime:Ba(l.readTime)}})(t)),Ie.resolve()}}class zA{constructor(){this.overlays=new mn(St.comparator),this.Lr=new Map}getOverlay(e,t){return Ie.resolve(this.overlays.get(t))}getOverlays(e,t){const i=Vo();return Ie.forEach(t,(l=>this.getOverlay(e,l).next((u=>{u!==null&&i.set(l,u)})))).next((()=>i))}saveOverlays(e,t,i){return i.forEach(((l,u)=>{this.bt(e,t,u)})),Ie.resolve()}removeOverlaysForBatchId(e,t,i){const l=this.Lr.get(i);return l!==void 0&&(l.forEach((u=>this.overlays=this.overlays.remove(u))),this.Lr.delete(i)),Ie.resolve()}getOverlaysForCollection(e,t,i){const l=Vo(),u=t.length+1,d=new St(t.child("")),p=this.overlays.getIteratorFrom(d);for(;p.hasNext();){const g=p.getNext().value,y=g.getKey();if(!t.isPrefixOf(y.path))break;y.path.length===u&&g.largestBatchId>i&&l.set(g.getKey(),g)}return Ie.resolve(l)}getOverlaysForCollectionGroup(e,t,i,l){let u=new mn(((y,w)=>y-w));const d=this.overlays.getIterator();for(;d.hasNext();){const y=d.getNext().value;if(y.getKey().getCollectionGroup()===t&&y.largestBatchId>i){let w=u.get(y.largestBatchId);w===null&&(w=Vo(),u=u.insert(y.largestBatchId,w)),w.set(y.getKey(),y)}}const p=Vo(),g=u.getIterator();for(;g.hasNext()&&(g.getNext().value.forEach(((y,w)=>p.set(y,w))),!(p.size()>=l)););return Ie.resolve(p)}bt(e,t,i){const l=this.overlays.get(i.key);if(l!==null){const d=this.Lr.get(l.largestBatchId).delete(i.key);this.Lr.set(l.largestBatchId,d)}this.overlays=this.overlays.insert(i.key,new aA(t,i));let u=this.Lr.get(t);u===void 0&&(u=bs(),this.Lr.set(t,u)),this.Lr.set(t,u.add(i.key))}}class FA{constructor(){this.sessionToken=tr.EMPTY_BYTE_STRING}getSessionToken(e){return Ie.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,Ie.resolve()}}class uy{constructor(){this.kr=new Vn(Hn.Kr),this.qr=new Vn(Hn.Ur)}isEmpty(){return this.kr.isEmpty()}addReference(e,t){const i=new Hn(e,t);this.kr=this.kr.add(i),this.qr=this.qr.add(i)}$r(e,t){e.forEach((i=>this.addReference(i,t)))}removeReference(e,t){this.Wr(new Hn(e,t))}Qr(e,t){e.forEach((i=>this.removeReference(i,t)))}Gr(e){const t=new St(new tn([])),i=new Hn(t,e),l=new Hn(t,e+1),u=[];return this.qr.forEachInRange([i,l],(d=>{this.Wr(d),u.push(d.key)})),u}zr(){this.kr.forEach((e=>this.Wr(e)))}Wr(e){this.kr=this.kr.delete(e),this.qr=this.qr.delete(e)}jr(e){const t=new St(new tn([])),i=new Hn(t,e),l=new Hn(t,e+1);let u=bs();return this.qr.forEachInRange([i,l],(d=>{u=u.add(d.key)})),u}containsKey(e){const t=new Hn(e,0),i=this.kr.firstAfterOrEqual(t);return i!==null&&e.isEqual(i.key)}}class Hn{constructor(e,t){this.key=e,this.Hr=t}static Kr(e,t){return St.comparator(e.key,t.key)||ys(e.Hr,t.Hr)}static Ur(e,t){return ys(e.Hr,t.Hr)||St.comparator(e.key,t.key)}}class qA{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Yn=1,this.Jr=new Vn(Hn.Kr)}checkEmpty(e){return Ie.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,i,l){const u=this.Yn;this.Yn++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const d=new rA(u,t,i,l);this.mutationQueue.push(d);for(const p of l)this.Jr=this.Jr.add(new Hn(p.key,u)),this.indexManager.addToCollectionParentIndex(e,p.key.path.popLast());return Ie.resolve(d)}lookupMutationBatch(e,t){return Ie.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,l=this.Xr(i),u=l<0?0:l;return Ie.resolve(this.mutationQueue.length>u?this.mutationQueue[u]:null)}getHighestUnacknowledgedBatchId(){return Ie.resolve(this.mutationQueue.length===0?ty:this.Yn-1)}getAllMutationBatches(e){return Ie.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const i=new Hn(t,0),l=new Hn(t,Number.POSITIVE_INFINITY),u=[];return this.Jr.forEachInRange([i,l],(d=>{const p=this.Zr(d.Hr);u.push(p)})),Ie.resolve(u)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new Vn(ys);return t.forEach((l=>{const u=new Hn(l,0),d=new Hn(l,Number.POSITIVE_INFINITY);this.Jr.forEachInRange([u,d],(p=>{i=i.add(p.Hr)}))})),Ie.resolve(this.Yr(i))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,l=i.length+1;let u=i;St.isDocumentKey(u)||(u=u.child(""));const d=new Hn(new St(u),0);let p=new Vn(ys);return this.Jr.forEachWhile((g=>{const y=g.key.path;return!!i.isPrefixOf(y)&&(y.length===l&&(p=p.add(g.Hr)),!0)}),d),Ie.resolve(this.Yr(p))}Yr(e){const t=[];return e.forEach((i=>{const l=this.Zr(i);l!==null&&t.push(l)})),t}removeMutationBatch(e,t){Us(this.ei(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.Jr;return Ie.forEach(t.mutations,(l=>{const u=new Hn(l.key,t.batchId);return i=i.delete(u),this.referenceDelegate.markPotentiallyOrphaned(e,l.key)})).next((()=>{this.Jr=i}))}nr(e){}containsKey(e,t){const i=new Hn(t,0),l=this.Jr.firstAfterOrEqual(i);return Ie.resolve(t.isEqual(l&&l.key))}performConsistencyCheck(e){return this.mutationQueue.length,Ie.resolve()}ei(e,t){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class HA{constructor(e){this.ti=e,this.docs=(function(){return new mn(St.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const i=t.key,l=this.docs.get(i),u=l?l.size:0,d=this.ti(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:d}),this.size+=d-u,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const i=this.docs.get(t);return Ie.resolve(i?i.document.mutableCopy():lr.newInvalidDocument(t))}getEntries(e,t){let i=yi();return t.forEach((l=>{const u=this.docs.get(l);i=i.insert(l,u?u.document.mutableCopy():lr.newInvalidDocument(l))})),Ie.resolve(i)}getDocumentsMatchingQuery(e,t,i,l){let u=yi();const d=t.path,p=new St(d.child("__id-9223372036854775808__")),g=this.docs.getIteratorFrom(p);for(;g.hasNext();){const{key:y,value:{document:w}}=g.getNext();if(!d.isPrefixOf(y.path))break;y.path.length>d.length+1||yR(gR(w),i)<=0||(l.has(w.key)||im(t,w))&&(u=u.insert(w.key,w.mutableCopy()))}return Ie.resolve(u)}getAllFromCollectionGroup(e,t,i,l){Bt(9500)}ni(e,t){return Ie.forEach(this.docs,(i=>t(i)))}newChangeBuffer(e){return new $A(this)}getSize(e){return Ie.resolve(this.size)}}class $A extends OA{constructor(e){super(),this.Mr=e}applyChanges(e){const t=[];return this.changes.forEach(((i,l)=>{l.isValidDocument()?t.push(this.Mr.addEntry(e,l)):this.Mr.removeEntry(i)})),Ie.waitFor(t)}getFromCache(e,t){return this.Mr.getEntry(e,t)}getAllFromCache(e,t){return this.Mr.getEntries(e,t)}}class WA{constructor(e){this.persistence=e,this.ri=new Zo((t=>ry(t)),ay),this.lastRemoteSnapshotVersion=Kt.min(),this.highestTargetId=0,this.ii=0,this.si=new uy,this.targetCount=0,this.oi=Xl._r()}forEachTarget(e,t){return this.ri.forEach(((i,l)=>t(l))),Ie.resolve()}getLastRemoteSnapshotVersion(e){return Ie.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Ie.resolve(this.ii)}allocateTargetId(e){return this.highestTargetId=this.oi.next(),Ie.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.ii&&(this.ii=t),Ie.resolve()}lr(e){this.ri.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.oi=new Xl(t),this.highestTargetId=t),e.sequenceNumber>this.ii&&(this.ii=e.sequenceNumber)}addTargetData(e,t){return this.lr(t),this.targetCount+=1,Ie.resolve()}updateTargetData(e,t){return this.lr(t),Ie.resolve()}removeTargetData(e,t){return this.ri.delete(t.target),this.si.Gr(t.targetId),this.targetCount-=1,Ie.resolve()}removeTargets(e,t,i){let l=0;const u=[];return this.ri.forEach(((d,p)=>{p.sequenceNumber<=t&&i.get(p.targetId)===null&&(this.ri.delete(d),u.push(this.removeMatchingKeysForTargetId(e,p.targetId)),l++)})),Ie.waitFor(u).next((()=>l))}getTargetCount(e){return Ie.resolve(this.targetCount)}getTargetData(e,t){const i=this.ri.get(t)||null;return Ie.resolve(i)}addMatchingKeys(e,t,i){return this.si.$r(t,i),Ie.resolve()}removeMatchingKeys(e,t,i){this.si.Qr(t,i);const l=this.persistence.referenceDelegate,u=[];return l&&t.forEach((d=>{u.push(l.markPotentiallyOrphaned(e,d))})),Ie.waitFor(u)}removeMatchingKeysForTargetId(e,t){return this.si.Gr(t),Ie.resolve()}getMatchingKeysForTargetId(e,t){const i=this.si.jr(t);return Ie.resolve(i)}containsKey(e,t){return Ie.resolve(this.si.containsKey(t))}}class O_{constructor(e,t){this._i={},this.overlays={},this.ai=new tm(0),this.ui=!1,this.ui=!0,this.ci=new FA,this.referenceDelegate=e(this),this.li=new WA(this),this.indexManager=new RA,this.remoteDocumentCache=(function(l){return new HA(l)})((i=>this.referenceDelegate.hi(i))),this.serializer=new SA(t),this.Pi=new UA(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ui=!1,Promise.resolve()}get started(){return this.ui}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new zA,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this._i[e.toKey()];return i||(i=new qA(t,this.referenceDelegate),this._i[e.toKey()]=i),i}getGlobalsCache(){return this.ci}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Pi}runTransaction(e,t,i){ut("MemoryPersistence","Starting transaction:",e);const l=new GA(this.ai.next());return this.referenceDelegate.Ti(),i(l).next((u=>this.referenceDelegate.Ii(l).next((()=>u)))).toPromise().then((u=>(l.raiseOnCommittedEvent(),u)))}Ei(e,t){return Ie.or(Object.values(this._i).map((i=>()=>i.containsKey(e,t))))}}class GA extends vR{constructor(e){super(),this.currentSequenceNumber=e}}class dy{constructor(e){this.persistence=e,this.Ri=new uy,this.Ai=null}static Vi(e){return new dy(e)}get di(){if(this.Ai)return this.Ai;throw Bt(60996)}addReference(e,t,i){return this.Ri.addReference(i,t),this.di.delete(i.toString()),Ie.resolve()}removeReference(e,t,i){return this.Ri.removeReference(i,t),this.di.add(i.toString()),Ie.resolve()}markPotentiallyOrphaned(e,t){return this.di.add(t.toString()),Ie.resolve()}removeTarget(e,t){this.Ri.Gr(t.targetId).forEach((l=>this.di.add(l.toString())));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next((l=>{l.forEach((u=>this.di.add(u.toString())))})).next((()=>i.removeTargetData(e,t)))}Ti(){this.Ai=new Set}Ii(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Ie.forEach(this.di,(i=>{const l=St.fromPath(i);return this.mi(e,l).next((u=>{u||t.removeEntry(l,Kt.min())}))})).next((()=>(this.Ai=null,t.apply(e))))}updateLimboDocument(e,t){return this.mi(e,t).next((i=>{i?this.di.delete(t.toString()):this.di.add(t.toString())}))}hi(e){return 0}mi(e,t){return Ie.or([()=>Ie.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}}class Uh{constructor(e,t){this.persistence=e,this.fi=new Zo((i=>_R(i.path)),((i,l)=>i.isEqual(l))),this.garbageCollector=LA(this,t)}static Vi(e,t){return new Uh(e,t)}Ti(){}Ii(e){return Ie.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}dr(e){const t=this.pr(e);return this.persistence.getTargetCache().getTargetCount(e).next((i=>t.next((l=>i+l))))}pr(e){let t=0;return this.mr(e,(i=>{t++})).next((()=>t))}mr(e,t){return Ie.forEach(this.fi,((i,l)=>this.wr(e,i,l).next((u=>u?Ie.resolve():t(l)))))}removeTargets(e,t,i){return this.persistence.getTargetCache().removeTargets(e,t,i)}removeOrphanedDocuments(e,t){let i=0;const l=this.persistence.getRemoteDocumentCache(),u=l.newChangeBuffer();return l.ni(e,(d=>this.wr(e,d,t).next((p=>{p||(i++,u.removeEntry(d,Kt.min()))})))).next((()=>u.apply(e))).next((()=>i))}markPotentiallyOrphaned(e,t){return this.fi.set(t,e.currentSequenceNumber),Ie.resolve()}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,i)}addReference(e,t,i){return this.fi.set(i,e.currentSequenceNumber),Ie.resolve()}removeReference(e,t,i){return this.fi.set(i,e.currentSequenceNumber),Ie.resolve()}updateLimboDocument(e,t){return this.fi.set(t,e.currentSequenceNumber),Ie.resolve()}hi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=vh(e.data.value)),t}wr(e,t,i){return Ie.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const l=this.fi.get(t);return Ie.resolve(l!==void 0&&l>i)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class hy{constructor(e,t,i,l){this.targetId=e,this.fromCache=t,this.Ts=i,this.Is=l}static Es(e,t){let i=bs(),l=bs();for(const u of t.docChanges)switch(u.type){case 0:i=i.add(u.doc.key);break;case 1:l=l.add(u.doc.key)}return new hy(e,t.fromCache,i,l)}}class KA{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class YA{constructor(){this.Rs=!1,this.As=!1,this.Vs=100,this.ds=(function(){return _N()?8:xR(cr())>0?6:4})()}initialize(e,t){this.fs=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,i,l){const u={result:null};return this.gs(e,t).next((d=>{u.result=d})).next((()=>{if(!u.result)return this.ps(e,t,l,i).next((d=>{u.result=d}))})).next((()=>{if(u.result)return;const d=new KA;return this.ys(e,t,d).next((p=>{if(u.result=p,this.As)return this.ws(e,t,d,p.size)}))})).next((()=>u.result))}ws(e,t,i,l){return i.documentReadCount<this.Vs?(Ol()<=gs.DEBUG&&ut("QueryEngine","SDK will not create cache indexes for query:",Vl(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),Ie.resolve()):(Ol()<=gs.DEBUG&&ut("QueryEngine","Query:",Vl(t),"scans",i.documentReadCount,"local documents and returns",l,"documents as results."),i.documentReadCount>this.ds*l?(Ol()<=gs.DEBUG&&ut("QueryEngine","The SDK decides to create cache indexes for query:",Vl(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Va(t))):Ie.resolve())}gs(e,t){if(Sx(t))return Ie.resolve(null);let i=Va(t);return this.indexManager.getIndexType(e,i).next((l=>l===0?null:(t.limit!==null&&l===1&&(t=Vh(t,null,"F"),i=Va(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next((u=>{const d=bs(...u);return this.fs.getDocuments(e,d).next((p=>this.indexManager.getMinOffset(e,i).next((g=>{const y=this.bs(t,p);return this.Ss(t,y,d,g.readTime)?this.gs(e,Vh(t,null,"F")):this.Ds(e,y,t,g)}))))})))))}ps(e,t,i,l){return Sx(t)||l.isEqual(Kt.min())?Ie.resolve(null):this.fs.getDocuments(e,i).next((u=>{const d=this.bs(t,u);return this.Ss(t,d,i,l)?Ie.resolve(null):(Ol()<=gs.DEBUG&&ut("QueryEngine","Re-using previous result from %s to execute query: %s",l.toString(),Vl(t)),this.Ds(e,d,t,pR(l,yu)).next((p=>p)))}))}bs(e,t){let i=new Vn(h_(e));return t.forEach(((l,u)=>{im(e,u)&&(i=i.add(u))})),i}Ss(e,t,i,l){if(e.limit===null)return!1;if(i.size!==t.size)return!0;const u=e.limitType==="F"?t.last():t.first();return!!u&&(u.hasPendingWrites||u.version.compareTo(l)>0)}ys(e,t,i){return Ol()<=gs.DEBUG&&ut("QueryEngine","Using full collection scan to execute query:",Vl(t)),this.fs.getDocumentsMatchingQuery(e,t,oo.min(),i)}Ds(e,t,i,l){return this.fs.getDocumentsMatchingQuery(e,i,l).next((u=>(t.forEach((d=>{u=u.insert(d.key,d)})),u)))}}const my="LocalStore",QA=3e8;class XA{constructor(e,t,i,l){this.persistence=e,this.Cs=t,this.serializer=l,this.vs=new mn(ys),this.Fs=new Zo((u=>ry(u)),ay),this.Ms=new Map,this.xs=e.getRemoteDocumentCache(),this.li=e.getTargetCache(),this.Pi=e.getBundleCache(),this.Os(i)}Os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new BA(this.xs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.xs.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.vs)))}}function JA(n,e,t,i){return new XA(n,e,t,i)}async function V_(n,e){const t=Jt(n);return await t.persistence.runTransaction("Handle user change","readonly",(i=>{let l;return t.mutationQueue.getAllMutationBatches(i).next((u=>(l=u,t.Os(e),t.mutationQueue.getAllMutationBatches(i)))).next((u=>{const d=[],p=[];let g=bs();for(const y of l){d.push(y.batchId);for(const w of y.mutations)g=g.add(w.key)}for(const y of u){p.push(y.batchId);for(const w of y.mutations)g=g.add(w.key)}return t.localDocuments.getDocuments(i,g).next((y=>({Ns:y,removedBatchIds:d,addedBatchIds:p})))}))}))}function ZA(n,e){const t=Jt(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(i=>{const l=e.batch.keys(),u=t.xs.newChangeBuffer({trackRemovals:!0});return(function(p,g,y,w){const k=y.batch,j=k.keys();let O=Ie.resolve();return j.forEach((H=>{O=O.next((()=>w.getEntry(g,H))).next((B=>{const V=y.docVersions.get(H);Us(V!==null,48541),B.version.compareTo(V)<0&&(k.applyToRemoteDocument(B,y),B.isValidDocument()&&(B.setReadTime(y.commitVersion),w.addEntry(B)))}))})),O.next((()=>p.mutationQueue.removeMutationBatch(g,k)))})(t,i,e,u).next((()=>u.apply(i))).next((()=>t.mutationQueue.performConsistencyCheck(i))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(i,l,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,(function(p){let g=bs();for(let y=0;y<p.mutationResults.length;++y)p.mutationResults[y].transformResults.length>0&&(g=g.add(p.batch.mutations[y].key));return g})(e)))).next((()=>t.localDocuments.getDocuments(i,l)))}))}function B_(n){const e=Jt(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.li.getLastRemoteSnapshotVersion(t)))}function eI(n,e){const t=Jt(n),i=e.snapshotVersion;let l=t.vs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(u=>{const d=t.xs.newChangeBuffer({trackRemovals:!0});l=t.vs;const p=[];e.targetChanges.forEach(((w,k)=>{const j=l.get(k);if(!j)return;p.push(t.li.removeMatchingKeys(u,w.removedDocuments,k).next((()=>t.li.addMatchingKeys(u,w.addedDocuments,k))));let O=j.withSequenceNumber(u.currentSequenceNumber);e.targetMismatches.get(k)!==null?O=O.withResumeToken(tr.EMPTY_BYTE_STRING,Kt.min()).withLastLimboFreeSnapshotVersion(Kt.min()):w.resumeToken.approximateByteSize()>0&&(O=O.withResumeToken(w.resumeToken,i)),l=l.insert(k,O),(function(B,V,se){return B.resumeToken.approximateByteSize()===0||V.snapshotVersion.toMicroseconds()-B.snapshotVersion.toMicroseconds()>=QA?!0:se.addedDocuments.size+se.modifiedDocuments.size+se.removedDocuments.size>0})(j,O,w)&&p.push(t.li.updateTargetData(u,O))}));let g=yi(),y=bs();if(e.documentUpdates.forEach((w=>{e.resolvedLimboDocuments.has(w)&&p.push(t.persistence.referenceDelegate.updateLimboDocument(u,w))})),p.push(tI(u,d,e.documentUpdates).next((w=>{g=w.Bs,y=w.Ls}))),!i.isEqual(Kt.min())){const w=t.li.getLastRemoteSnapshotVersion(u).next((k=>t.li.setTargetsMetadata(u,u.currentSequenceNumber,i)));p.push(w)}return Ie.waitFor(p).next((()=>d.apply(u))).next((()=>t.localDocuments.getLocalViewOfDocuments(u,g,y))).next((()=>g))})).then((u=>(t.vs=l,u)))}function tI(n,e,t){let i=bs(),l=bs();return t.forEach((u=>i=i.add(u))),e.getEntries(n,i).next((u=>{let d=yi();return t.forEach(((p,g)=>{const y=u.get(p);g.isFoundDocument()!==y.isFoundDocument()&&(l=l.add(p)),g.isNoDocument()&&g.version.isEqual(Kt.min())?(e.removeEntry(p,g.readTime),d=d.insert(p,g)):!y.isValidDocument()||g.version.compareTo(y.version)>0||g.version.compareTo(y.version)===0&&y.hasPendingWrites?(e.addEntry(g),d=d.insert(p,g)):ut(my,"Ignoring outdated watch update for ",p,". Current version:",y.version," Watch version:",g.version)})),{Bs:d,Ls:l}}))}function sI(n,e){const t=Jt(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(i=>(e===void 0&&(e=ty),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e))))}function nI(n,e){const t=Jt(n);return t.persistence.runTransaction("Allocate target","readwrite",(i=>{let l;return t.li.getTargetData(i,e).next((u=>u?(l=u,Ie.resolve(l)):t.li.allocateTargetId(i).next((d=>(l=new Zi(e,d,"TargetPurposeListen",i.currentSequenceNumber),t.li.addTargetData(i,l).next((()=>l)))))))})).then((i=>{const l=t.vs.get(i.targetId);return(l===null||i.snapshotVersion.compareTo(l.snapshotVersion)>0)&&(t.vs=t.vs.insert(i.targetId,i),t.Fs.set(e,i.targetId)),i}))}async function kg(n,e,t){const i=Jt(n),l=i.vs.get(e),u=t?"readwrite":"readwrite-primary";try{t||await i.persistence.runTransaction("Release target",u,(d=>i.persistence.referenceDelegate.removeTarget(d,l)))}catch(d){if(!ac(d))throw d;ut(my,`Failed to update sequence numbers for target ${e}: ${d}`)}i.vs=i.vs.remove(e),i.Fs.delete(l.target)}function zx(n,e,t){const i=Jt(n);let l=Kt.min(),u=bs();return i.persistence.runTransaction("Execute query","readwrite",(d=>(function(g,y,w){const k=Jt(g),j=k.Fs.get(w);return j!==void 0?Ie.resolve(k.vs.get(j)):k.li.getTargetData(y,w)})(i,d,Va(e)).next((p=>{if(p)return l=p.lastLimboFreeSnapshotVersion,i.li.getMatchingKeysForTargetId(d,p.targetId).next((g=>{u=g}))})).next((()=>i.Cs.getDocumentsMatchingQuery(d,e,t?l:Kt.min(),t?u:bs()))).next((p=>(rI(i,HR(e),p),{documents:p,ks:u})))))}function rI(n,e,t){let i=n.Ms.get(e)||Kt.min();t.forEach(((l,u)=>{u.readTime.compareTo(i)>0&&(i=u.readTime)})),n.Ms.set(e,i)}class Fx{constructor(){this.activeTargetIds=QR()}Qs(e){this.activeTargetIds=this.activeTargetIds.add(e)}Gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class aI{constructor(){this.vo=new Fx,this.Fo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e,t=!0){return t&&this.vo.Qs(e),this.Fo[e]||"not-current"}updateQueryState(e,t,i){this.Fo[e]=t}removeLocalQueryTarget(e){this.vo.Gs(e)}isLocalQueryTarget(e){return this.vo.activeTargetIds.has(e)}clearQueryState(e){delete this.Fo[e]}getAllActiveQueryTargets(){return this.vo.activeTargetIds}isActiveQueryTarget(e){return this.vo.activeTargetIds.has(e)}start(){return this.vo=new Fx,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class iI{Mo(e){}shutdown(){}}const qx="ConnectivityMonitor";class Hx{constructor(){this.xo=()=>this.Oo(),this.No=()=>this.Bo(),this.Lo=[],this.ko()}Mo(e){this.Lo.push(e)}shutdown(){window.removeEventListener("online",this.xo),window.removeEventListener("offline",this.No)}ko(){window.addEventListener("online",this.xo),window.addEventListener("offline",this.No)}Oo(){ut(qx,"Network connectivity changed: AVAILABLE");for(const e of this.Lo)e(0)}Bo(){ut(qx,"Network connectivity changed: UNAVAILABLE");for(const e of this.Lo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let rh=null;function jg(){return rh===null?rh=(function(){return 268435456+Math.round(2147483648*Math.random())})():rh++,"0x"+rh.toString(16)}const Ip="RestConnection",oI={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery",ExecutePipeline:"executePipeline"};class lI{get Ko(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),l=encodeURIComponent(this.databaseId.database);this.qo=t+"://"+e.host,this.Uo=`projects/${i}/databases/${l}`,this.$o=this.databaseId.database===Ph?`project_id=${i}`:`project_id=${i}&database_id=${l}`}Wo(e,t,i,l,u){const d=jg(),p=this.Qo(e,t.toUriEncodedString());ut(Ip,`Sending RPC '${e}' ${d}:`,p,i);const g={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.$o};this.Go(g,l,u);const{host:y}=new URL(p),w=fo(y);return this.zo(e,p,g,i,w).then((k=>(ut(Ip,`Received RPC '${e}' ${d}: `,k),k)),(k=>{throw Gl(Ip,`RPC '${e}' ${d} failed with error: `,k,"url: ",p,"request:",i),k}))}jo(e,t,i,l,u,d){return this.Wo(e,t,i,l,u)}Go(e,t,i){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+nc})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((l,u)=>e[u]=l)),i&&i.headers.forEach(((l,u)=>e[u]=l))}Qo(e,t){const i=oI[e];let l=`${this.qo}/v1/${t}:${i}`;return this.databaseInfo.apiKey&&(l=`${l}?key=${encodeURIComponent(this.databaseInfo.apiKey)}`),l}terminate(){}}class cI{constructor(e){this.Ho=e.Ho,this.Jo=e.Jo}Zo(e){this.Xo=e}Yo(e){this.e_=e}t_(e){this.n_=e}onMessage(e){this.r_=e}close(){this.Jo()}send(e){this.Ho(e)}i_(){this.Xo()}s_(){this.e_()}o_(e){this.n_(e)}__(e){this.r_(e)}}const ir="WebChannelConnection",Gc=(n,e,t)=>{n.listen(e,(i=>{try{t(i)}catch(l){setTimeout((()=>{throw l}),0)}}))};class $l extends lI{constructor(e){super(e),this.a_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}static u_(){if(!$l.c_){const e=Fw();Gc(e,zw.STAT_EVENT,(t=>{t.stat===hg.PROXY?ut(ir,"STAT_EVENT: detected buffering proxy"):t.stat===hg.NOPROXY&&ut(ir,"STAT_EVENT: detected no buffering proxy")})),$l.c_=!0}}zo(e,t,i,l,u){const d=jg();return new Promise(((p,g)=>{const y=new Bw;y.setWithCredentials(!0),y.listenOnce(Uw.COMPLETE,(()=>{try{switch(y.getLastErrorCode()){case bh.NO_ERROR:const k=y.getResponseJson();ut(ir,`XHR for RPC '${e}' ${d} received:`,JSON.stringify(k)),p(k);break;case bh.TIMEOUT:ut(ir,`RPC '${e}' ${d} timed out`),g(new nt(Te.DEADLINE_EXCEEDED,"Request time out"));break;case bh.HTTP_ERROR:const j=y.getStatus();if(ut(ir,`RPC '${e}' ${d} failed with status:`,j,"response text:",y.getResponseText()),j>0){let O=y.getResponseJson();Array.isArray(O)&&(O=O[0]);const H=O?.error;if(H&&H.status&&H.message){const B=(function(se){const K=se.toLowerCase().replace(/_/g,"-");return Object.values(Te).indexOf(K)>=0?K:Te.UNKNOWN})(H.status);g(new nt(B,H.message))}else g(new nt(Te.UNKNOWN,"Server responded with status "+y.getStatus()))}else g(new nt(Te.UNAVAILABLE,"Connection failed."));break;default:Bt(9055,{l_:e,streamId:d,h_:y.getLastErrorCode(),P_:y.getLastError()})}}finally{ut(ir,`RPC '${e}' ${d} completed.`)}}));const w=JSON.stringify(l);ut(ir,`RPC '${e}' ${d} sending request:`,l),y.send(t,"POST",w,i,15)}))}T_(e,t,i){const l=jg(),u=[this.qo,"/","google.firestore.v1.Firestore","/",e,"/channel"],d=this.createWebChannelTransport(),p={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},g=this.longPollingOptions.timeoutSeconds;g!==void 0&&(p.longPollingTimeout=Math.round(1e3*g)),this.useFetchStreams&&(p.useFetchStreams=!0),this.Go(p.initMessageHeaders,t,i),p.encodeInitMessageHeaders=!0;const y=u.join("");ut(ir,`Creating RPC '${e}' stream ${l}: ${y}`,p);const w=d.createWebChannel(y,p);this.I_(w);let k=!1,j=!1;const O=new cI({Ho:H=>{j?ut(ir,`Not sending because RPC '${e}' stream ${l} is closed:`,H):(k||(ut(ir,`Opening RPC '${e}' stream ${l} transport.`),w.open(),k=!0),ut(ir,`RPC '${e}' stream ${l} sending:`,H),w.send(H))},Jo:()=>w.close()});return Gc(w,eu.EventType.OPEN,(()=>{j||(ut(ir,`RPC '${e}' stream ${l} transport opened.`),O.i_())})),Gc(w,eu.EventType.CLOSE,(()=>{j||(j=!0,ut(ir,`RPC '${e}' stream ${l} transport closed`),O.o_(),this.E_(w))})),Gc(w,eu.EventType.ERROR,(H=>{j||(j=!0,Gl(ir,`RPC '${e}' stream ${l} transport errored. Name:`,H.name,"Message:",H.message),O.o_(new nt(Te.UNAVAILABLE,"The operation could not be completed")))})),Gc(w,eu.EventType.MESSAGE,(H=>{if(!j){const B=H.data[0];Us(!!B,16349);const V=B,se=V?.error||V[0]?.error;if(se){ut(ir,`RPC '${e}' stream ${l} received error:`,se);const K=se.status;let oe=(function(Ee){const R=In[Ee];if(R!==void 0)return T_(R)})(K),ye=se.message;oe===void 0&&(oe=Te.INTERNAL,ye="Unknown error status: "+K+" with message "+se.message),j=!0,O.o_(new nt(oe,ye)),w.close()}else ut(ir,`RPC '${e}' stream ${l} received:`,B),O.__(B)}})),$l.u_(),setTimeout((()=>{O.s_()}),0),O}terminate(){this.a_.forEach((e=>e.close())),this.a_=[]}I_(e){this.a_.push(e)}E_(e){this.a_=this.a_.filter((t=>t===e))}Go(e,t,i){super.Go(e,t,i),this.databaseInfo.apiKey&&(e["x-goog-api-key"]=this.databaseInfo.apiKey)}createWebChannelTransport(){return qw()}}function uI(n){return new $l(n)}function Mp(){return typeof document<"u"?document:null}function dm(n){return new fA(n,!0)}$l.c_=!1;class U_{constructor(e,t,i=1e3,l=1.5,u=6e4){this.Ci=e,this.timerId=t,this.R_=i,this.A_=l,this.V_=u,this.d_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.d_=0}g_(){this.d_=this.V_}p_(e){this.cancel();const t=Math.floor(this.d_+this.y_()),i=Math.max(0,Date.now()-this.f_),l=Math.max(0,t-i);l>0&&ut("ExponentialBackoff",`Backing off for ${l} ms (base delay: ${this.d_} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.m_=this.Ci.enqueueAfterDelay(this.timerId,l,(()=>(this.f_=Date.now(),e()))),this.d_*=this.A_,this.d_<this.R_&&(this.d_=this.R_),this.d_>this.V_&&(this.d_=this.V_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.d_}}const $x="PersistentStream";class z_{constructor(e,t,i,l,u,d,p,g){this.Ci=e,this.b_=i,this.S_=l,this.connection=u,this.authCredentialsProvider=d,this.appCheckCredentialsProvider=p,this.listener=g,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new U_(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Ci.enqueueAfterDelay(this.b_,6e4,(()=>this.k_())))}K_(e){this.q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===Te.RESOURCE_EXHAUSTED?(gi(t.toString()),gi("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===Te.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.t_(t)}W_(){}auth(){this.state=1;const e=this.Q_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([i,l])=>{this.D_===t&&this.G_(i,l)}),(i=>{e((()=>{const l=new nt(Te.UNKNOWN,"Fetching auth token failed: "+i.message);return this.z_(l)}))}))}G_(e,t){const i=this.Q_(this.D_);this.stream=this.j_(e,t),this.stream.Zo((()=>{i((()=>this.listener.Zo()))})),this.stream.Yo((()=>{i((()=>(this.state=2,this.v_=this.Ci.enqueueAfterDelay(this.S_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.Yo())))})),this.stream.t_((l=>{i((()=>this.z_(l)))})),this.stream.onMessage((l=>{i((()=>++this.F_==1?this.H_(l):this.onNext(l)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return ut($x,`close with error: ${e}`),this.stream=null,this.close(4,e)}Q_(e){return t=>{this.Ci.enqueueAndForget((()=>this.D_===e?t():(ut($x,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class dI extends z_{constructor(e,t,i,l,u,d){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,i,l,d),this.serializer=u}j_(e,t){return this.connection.T_("Listen",e,t)}H_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=yA(this.serializer,e),i=(function(u){if(!("targetChange"in u))return Kt.min();const d=u.targetChange;return d.targetIds&&d.targetIds.length?Kt.min():d.readTime?Ba(d.readTime):Kt.min()})(e);return this.listener.J_(t,i)}Z_(e){const t={};t.database=_g(this.serializer),t.addTarget=(function(u,d){let p;const g=d.target;if(p=yg(g)?{documents:xA(u,g)}:{query:wA(u,g).ft},p.targetId=d.targetId,d.resumeToken.approximateByteSize()>0){p.resumeToken=S_(u,d.resumeToken);const y=vg(u,d.expectedCount);y!==null&&(p.expectedCount=y)}else if(d.snapshotVersion.compareTo(Kt.min())>0){p.readTime=Bh(u,d.snapshotVersion.toTimestamp());const y=vg(u,d.expectedCount);y!==null&&(p.expectedCount=y)}return p})(this.serializer,e);const i=kA(this.serializer,e);i&&(t.labels=i),this.K_(t)}X_(e){const t={};t.database=_g(this.serializer),t.removeTarget=e,this.K_(t)}}class hI extends z_{constructor(e,t,i,l,u,d){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,l,d),this.serializer=u}get Y_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.Y_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}H_(e){return Us(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Us(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Us(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=vA(e.writeResults,e.commitTime),i=Ba(e.commitTime);return this.listener.na(i,t)}ra(){const e={};e.database=_g(this.serializer),this.K_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((i=>bA(this.serializer,i)))};this.K_(t)}}class mI{}class fI extends mI{constructor(e,t,i,l){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=l,this.ia=!1}sa(){if(this.ia)throw new nt(Te.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,i,l){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([u,d])=>this.connection.Wo(e,xg(t,i),l,u,d))).catch((u=>{throw u.name==="FirebaseError"?(u.code===Te.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),u):new nt(Te.UNKNOWN,u.toString())}))}jo(e,t,i,l,u){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([d,p])=>this.connection.jo(e,xg(t,i),l,d,p,u))).catch((d=>{throw d.name==="FirebaseError"?(d.code===Te.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),d):new nt(Te.UNKNOWN,d.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}function pI(n,e,t,i){return new fI(n,e,t,i)}class gI{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(gi(t),this.aa=!1):ut("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const Yo="RemoteStore";class yI{constructor(e,t,i,l,u){this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.Ra=[],this.Aa=u,this.Aa.Mo((d=>{i.enqueueAndForget((async()=>{el(this)&&(ut(Yo,"Restarting streams for network reachability change."),await(async function(g){const y=Jt(g);y.Ea.add(4),await Ou(y),y.Va.set("Unknown"),y.Ea.delete(4),await hm(y)})(this))}))})),this.Va=new gI(i,l)}}async function hm(n){if(el(n))for(const e of n.Ra)await e(!0)}async function Ou(n){for(const e of n.Ra)await e(!1)}function F_(n,e){const t=Jt(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),yy(t)?gy(t):oc(t).O_()&&py(t,e))}function fy(n,e){const t=Jt(n),i=oc(t);t.Ia.delete(e),i.O_()&&q_(t,e),t.Ia.size===0&&(i.O_()?i.L_():el(t)&&t.Va.set("Unknown"))}function py(n,e){if(n.da.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Kt.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}oc(n).Z_(e)}function q_(n,e){n.da.$e(e),oc(n).X_(e)}function gy(n){n.da=new uA({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),oc(n).start(),n.Va.ua()}function yy(n){return el(n)&&!oc(n).x_()&&n.Ia.size>0}function el(n){return Jt(n).Ea.size===0}function H_(n){n.da=void 0}async function bI(n){n.Va.set("Online")}async function vI(n){n.Ia.forEach(((e,t)=>{py(n,e)}))}async function xI(n,e){H_(n),yy(n)?(n.Va.ha(e),gy(n)):n.Va.set("Unknown")}async function wI(n,e,t){if(n.Va.set("Online"),e instanceof N_&&e.state===2&&e.cause)try{await(async function(l,u){const d=u.cause;for(const p of u.targetIds)l.Ia.has(p)&&(await l.remoteSyncer.rejectListen(p,d),l.Ia.delete(p),l.da.removeTarget(p))})(n,e)}catch(i){ut(Yo,"Failed to remove targets %s: %s ",e.targetIds.join(","),i),await zh(n,i)}else if(e instanceof _h?n.da.Xe(e):e instanceof E_?n.da.st(e):n.da.tt(e),!t.isEqual(Kt.min()))try{const i=await B_(n.localStore);t.compareTo(i)>=0&&await(function(u,d){const p=u.da.Tt(d);return p.targetChanges.forEach(((g,y)=>{if(g.resumeToken.approximateByteSize()>0){const w=u.Ia.get(y);w&&u.Ia.set(y,w.withResumeToken(g.resumeToken,d))}})),p.targetMismatches.forEach(((g,y)=>{const w=u.Ia.get(g);if(!w)return;u.Ia.set(g,w.withResumeToken(tr.EMPTY_BYTE_STRING,w.snapshotVersion)),q_(u,g);const k=new Zi(w.target,g,y,w.sequenceNumber);py(u,k)})),u.remoteSyncer.applyRemoteEvent(p)})(n,t)}catch(i){ut(Yo,"Failed to raise snapshot:",i),await zh(n,i)}}async function zh(n,e,t){if(!ac(e))throw e;n.Ea.add(1),await Ou(n),n.Va.set("Offline"),t||(t=()=>B_(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{ut(Yo,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await hm(n)}))}function $_(n,e){return e().catch((t=>zh(n,t,e)))}async function mm(n){const e=Jt(n),t=ho(e);let i=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:ty;for(;_I(e);)try{const l=await sI(e.localStore,i);if(l===null){e.Ta.length===0&&t.L_();break}i=l.batchId,kI(e,l)}catch(l){await zh(e,l)}W_(e)&&G_(e)}function _I(n){return el(n)&&n.Ta.length<10}function kI(n,e){n.Ta.push(e);const t=ho(n);t.O_()&&t.Y_&&t.ea(e.mutations)}function W_(n){return el(n)&&!ho(n).x_()&&n.Ta.length>0}function G_(n){ho(n).start()}async function jI(n){ho(n).ra()}async function TI(n){const e=ho(n);for(const t of n.Ta)e.ea(t.mutations)}async function EI(n,e,t){const i=n.Ta.shift(),l=oy.from(i,e,t);await $_(n,(()=>n.remoteSyncer.applySuccessfulWrite(l))),await mm(n)}async function NI(n,e){e&&ho(n).Y_&&await(async function(i,l){if((function(d){return oA(d)&&d!==Te.ABORTED})(l.code)){const u=i.Ta.shift();ho(i).B_(),await $_(i,(()=>i.remoteSyncer.rejectFailedWrite(u.batchId,l))),await mm(i)}})(n,e),W_(n)&&G_(n)}async function Wx(n,e){const t=Jt(n);t.asyncQueue.verifyOperationInProgress(),ut(Yo,"RemoteStore received new credentials");const i=el(t);t.Ea.add(3),await Ou(t),i&&t.Va.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await hm(t)}async function SI(n,e){const t=Jt(n);e?(t.Ea.delete(2),await hm(t)):e||(t.Ea.add(2),await Ou(t),t.Va.set("Unknown"))}function oc(n){return n.ma||(n.ma=(function(t,i,l){const u=Jt(t);return u.sa(),new dI(i,u.connection,u.authCredentials,u.appCheckCredentials,u.serializer,l)})(n.datastore,n.asyncQueue,{Zo:bI.bind(null,n),Yo:vI.bind(null,n),t_:xI.bind(null,n),J_:wI.bind(null,n)}),n.Ra.push((async e=>{e?(n.ma.B_(),yy(n)?gy(n):n.Va.set("Unknown")):(await n.ma.stop(),H_(n))}))),n.ma}function ho(n){return n.fa||(n.fa=(function(t,i,l){const u=Jt(t);return u.sa(),new hI(i,u.connection,u.authCredentials,u.appCheckCredentials,u.serializer,l)})(n.datastore,n.asyncQueue,{Zo:()=>Promise.resolve(),Yo:jI.bind(null,n),t_:NI.bind(null,n),ta:TI.bind(null,n),na:EI.bind(null,n)}),n.Ra.push((async e=>{e?(n.fa.B_(),await mm(n)):(await n.fa.stop(),n.Ta.length>0&&(ut(Yo,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}class by{constructor(e,t,i,l,u){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=l,this.removalCallback=u,this.deferred=new di,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((d=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,l,u){const d=Date.now()+i,p=new by(e,t,d,l,u);return p.start(i),p}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new nt(Te.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function vy(n,e){if(gi("AsyncQueue",`${e}: ${n}`),ac(n))return new nt(Te.UNAVAILABLE,`${e}: ${n}`);throw n}class Wl{static emptySet(e){return new Wl(e.comparator)}constructor(e){this.comparator=e?(t,i)=>e(t,i)||St.comparator(t.key,i.key):(t,i)=>St.comparator(t.key,i.key),this.keyedMap=tu(),this.sortedSet=new mn(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,i)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Wl)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;t.hasNext();){const l=t.getNext().key,u=i.getNext().key;if(!l.isEqual(u))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const i=new Wl;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=t,i}}class Gx{constructor(){this.ga=new mn(St.comparator)}track(e){const t=e.doc.key,i=this.ga.get(t);i?e.type!==0&&i.type===3?this.ga=this.ga.insert(t,e):e.type===3&&i.type!==1?this.ga=this.ga.insert(t,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.ga=this.ga.remove(t):e.type===1&&i.type===2?this.ga=this.ga.insert(t,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):Bt(63341,{Vt:e,pa:i}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,i)=>{e.push(i)})),e}}class Jl{constructor(e,t,i,l,u,d,p,g,y){this.query=e,this.docs=t,this.oldDocs=i,this.docChanges=l,this.mutatedKeys=u,this.fromCache=d,this.syncStateChanged=p,this.excludesMetadataChanges=g,this.hasCachedResults=y}static fromInitialDocuments(e,t,i,l,u){const d=[];return t.forEach((p=>{d.push({type:0,doc:p})})),new Jl(e,t,Wl.emptySet(t),d,i,l,!0,!1,u)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&am(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,i=e.docChanges;if(t.length!==i.length)return!1;for(let l=0;l<t.length;l++)if(t[l].type!==i[l].type||!t[l].doc.isEqual(i[l].doc))return!1;return!0}}class CI{constructor(){this.wa=void 0,this.ba=[]}Sa(){return this.ba.some((e=>e.Da()))}}class RI{constructor(){this.queries=Kx(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,i){const l=Jt(t),u=l.queries;l.queries=Kx(),u.forEach(((d,p)=>{for(const g of p.ba)g.onError(i)}))})(this,new nt(Te.ABORTED,"Firestore shutting down"))}}function Kx(){return new Zo((n=>d_(n)),am)}async function xy(n,e){const t=Jt(n);let i=3;const l=e.query;let u=t.queries.get(l);u?!u.Sa()&&e.Da()&&(i=2):(u=new CI,i=e.Da()?0:1);try{switch(i){case 0:u.wa=await t.onListen(l,!0);break;case 1:u.wa=await t.onListen(l,!1);break;case 2:await t.onFirstRemoteStoreListen(l)}}catch(d){const p=vy(d,`Initialization of query '${Vl(e.query)}' failed`);return void e.onError(p)}t.queries.set(l,u),u.ba.push(e),e.va(t.onlineState),u.wa&&e.Fa(u.wa)&&_y(t)}async function wy(n,e){const t=Jt(n),i=e.query;let l=3;const u=t.queries.get(i);if(u){const d=u.ba.indexOf(e);d>=0&&(u.ba.splice(d,1),u.ba.length===0?l=e.Da()?0:1:!u.Sa()&&e.Da()&&(l=2))}switch(l){case 0:return t.queries.delete(i),t.onUnlisten(i,!0);case 1:return t.queries.delete(i),t.onUnlisten(i,!1);case 2:return t.onLastRemoteStoreUnlisten(i);default:return}}function AI(n,e){const t=Jt(n);let i=!1;for(const l of e){const u=l.query,d=t.queries.get(u);if(d){for(const p of d.ba)p.Fa(l)&&(i=!0);d.wa=l}}i&&_y(t)}function II(n,e,t){const i=Jt(n),l=i.queries.get(e);if(l)for(const u of l.ba)u.onError(t);i.queries.delete(e)}function _y(n){n.Ca.forEach((e=>{e.next()}))}var Tg,Yx;(Yx=Tg||(Tg={})).Ma="default",Yx.Cache="cache";class ky{constructor(e,t,i){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=i||{}}Fa(e){if(!this.options.includeMetadataChanges){const i=[];for(const l of e.docChanges)l.type!==3&&i.push(l);e=new Jl(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const i=t!=="Offline";return(!this.options.Ka||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=Jl.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Tg.Cache}}class K_{constructor(e){this.key=e}}class Y_{constructor(e){this.key=e}}class MI{constructor(e,t){this.query=e,this.Za=t,this.Xa=null,this.hasCachedResults=!1,this.current=!1,this.Ya=bs(),this.mutatedKeys=bs(),this.eu=h_(e),this.tu=new Wl(this.eu)}get nu(){return this.Za}ru(e,t){const i=t?t.iu:new Gx,l=t?t.tu:this.tu;let u=t?t.mutatedKeys:this.mutatedKeys,d=l,p=!1;const g=this.query.limitType==="F"&&l.size===this.query.limit?l.last():null,y=this.query.limitType==="L"&&l.size===this.query.limit?l.first():null;if(e.inorderTraversal(((w,k)=>{const j=l.get(w),O=im(this.query,k)?k:null,H=!!j&&this.mutatedKeys.has(j.key),B=!!O&&(O.hasLocalMutations||this.mutatedKeys.has(O.key)&&O.hasCommittedMutations);let V=!1;j&&O?j.data.isEqual(O.data)?H!==B&&(i.track({type:3,doc:O}),V=!0):this.su(j,O)||(i.track({type:2,doc:O}),V=!0,(g&&this.eu(O,g)>0||y&&this.eu(O,y)<0)&&(p=!0)):!j&&O?(i.track({type:0,doc:O}),V=!0):j&&!O&&(i.track({type:1,doc:j}),V=!0,(g||y)&&(p=!0)),V&&(O?(d=d.add(O),u=B?u.add(w):u.delete(w)):(d=d.delete(w),u=u.delete(w)))})),this.query.limit!==null)for(;d.size>this.query.limit;){const w=this.query.limitType==="F"?d.last():d.first();d=d.delete(w.key),u=u.delete(w.key),i.track({type:1,doc:w})}return{tu:d,iu:i,Ss:p,mutatedKeys:u}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,i,l){const u=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const d=e.iu.ya();d.sort(((w,k)=>(function(O,H){const B=V=>{switch(V){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Bt(20277,{Vt:V})}};return B(O)-B(H)})(w.type,k.type)||this.eu(w.doc,k.doc))),this.ou(i),l=l??!1;const p=t&&!l?this._u():[],g=this.Ya.size===0&&this.current&&!l?1:0,y=g!==this.Xa;return this.Xa=g,d.length!==0||y?{snapshot:new Jl(this.query,e.tu,u,d,e.mutatedKeys,g===0,y,!1,!!i&&i.resumeToken.approximateByteSize()>0),au:p}:{au:p}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Gx,mutatedKeys:this.mutatedKeys,Ss:!1},!1)):{au:[]}}uu(e){return!this.Za.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Za=this.Za.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Za=this.Za.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Ya;this.Ya=bs(),this.tu.forEach((i=>{this.uu(i.key)&&(this.Ya=this.Ya.add(i.key))}));const t=[];return e.forEach((i=>{this.Ya.has(i)||t.push(new Y_(i))})),this.Ya.forEach((i=>{e.has(i)||t.push(new K_(i))})),t}cu(e){this.Za=e.ks,this.Ya=bs();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return Jl.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Xa===0,this.hasCachedResults)}}const jy="SyncEngine";class DI{constructor(e,t,i){this.query=e,this.targetId=t,this.view=i}}class PI{constructor(e){this.key=e,this.hu=!1}}class LI{constructor(e,t,i,l,u,d){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=l,this.currentUser=u,this.maxConcurrentLimboResolutions=d,this.Pu={},this.Tu=new Zo((p=>d_(p)),am),this.Iu=new Map,this.Eu=new Set,this.Ru=new mn(St.comparator),this.Au=new Map,this.Vu=new uy,this.du={},this.mu=new Map,this.fu=Xl.ar(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function OI(n,e,t=!0){const i=tk(n);let l;const u=i.Tu.get(e);return u?(i.sharedClientState.addLocalQueryTarget(u.targetId),l=u.view.lu()):l=await Q_(i,e,t,!0),l}async function VI(n,e){const t=tk(n);await Q_(t,e,!0,!1)}async function Q_(n,e,t,i){const l=await nI(n.localStore,Va(e)),u=l.targetId,d=n.sharedClientState.addLocalQueryTarget(u,t);let p;return i&&(p=await BI(n,e,u,d==="current",l.resumeToken)),n.isPrimaryClient&&t&&F_(n.remoteStore,l),p}async function BI(n,e,t,i,l){n.pu=(k,j,O)=>(async function(B,V,se,K){let oe=V.view.ru(se);oe.Ss&&(oe=await zx(B.localStore,V.query,!1).then((({documents:R})=>V.view.ru(R,oe))));const ye=K&&K.targetChanges.get(V.targetId),Pe=K&&K.targetMismatches.get(V.targetId)!=null,Ee=V.view.applyChanges(oe,B.isPrimaryClient,ye,Pe);return Xx(B,V.targetId,Ee.au),Ee.snapshot})(n,k,j,O);const u=await zx(n.localStore,e,!0),d=new MI(e,u.ks),p=d.ru(u.documents),g=Lu.createSynthesizedTargetChangeForCurrentChange(t,i&&n.onlineState!=="Offline",l),y=d.applyChanges(p,n.isPrimaryClient,g);Xx(n,t,y.au);const w=new DI(e,t,d);return n.Tu.set(e,w),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),y.snapshot}async function UI(n,e,t){const i=Jt(n),l=i.Tu.get(e),u=i.Iu.get(l.targetId);if(u.length>1)return i.Iu.set(l.targetId,u.filter((d=>!am(d,e)))),void i.Tu.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(l.targetId),i.sharedClientState.isActiveQueryTarget(l.targetId)||await kg(i.localStore,l.targetId,!1).then((()=>{i.sharedClientState.clearQueryState(l.targetId),t&&fy(i.remoteStore,l.targetId),Eg(i,l.targetId)})).catch(rc)):(Eg(i,l.targetId),await kg(i.localStore,l.targetId,!0))}async function zI(n,e){const t=Jt(n),i=t.Tu.get(e),l=t.Iu.get(i.targetId);t.isPrimaryClient&&l.length===1&&(t.sharedClientState.removeLocalQueryTarget(i.targetId),fy(t.remoteStore,i.targetId))}async function FI(n,e,t){const i=YI(n);try{const l=await(function(d,p){const g=Jt(d),y=vt.now(),w=p.reduce(((O,H)=>O.add(H.key)),bs());let k,j;return g.persistence.runTransaction("Locally write mutations","readwrite",(O=>{let H=yi(),B=bs();return g.xs.getEntries(O,w).next((V=>{H=V,H.forEach(((se,K)=>{K.isValidDocument()||(B=B.add(se))}))})).next((()=>g.localDocuments.getOverlayedDocuments(O,H))).next((V=>{k=V;const se=[];for(const K of p){const oe=sA(K,k.get(K.key).overlayedDocument);oe!=null&&se.push(new yo(K.key,oe,n_(oe.value.mapValue),xr.exists(!0)))}return g.mutationQueue.addMutationBatch(O,y,se,p)})).next((V=>{j=V;const se=V.applyToLocalDocumentSet(k,B);return g.documentOverlayCache.saveOverlays(O,V.batchId,se)}))})).then((()=>({batchId:j.batchId,changes:f_(k)})))})(i.localStore,e);i.sharedClientState.addPendingMutation(l.batchId),(function(d,p,g){let y=d.du[d.currentUser.toKey()];y||(y=new mn(ys)),y=y.insert(p,g),d.du[d.currentUser.toKey()]=y})(i,l.batchId,t),await Vu(i,l.changes),await mm(i.remoteStore)}catch(l){const u=vy(l,"Failed to persist write");t.reject(u)}}async function X_(n,e){const t=Jt(n);try{const i=await eI(t.localStore,e);e.targetChanges.forEach(((l,u)=>{const d=t.Au.get(u);d&&(Us(l.addedDocuments.size+l.modifiedDocuments.size+l.removedDocuments.size<=1,22616),l.addedDocuments.size>0?d.hu=!0:l.modifiedDocuments.size>0?Us(d.hu,14607):l.removedDocuments.size>0&&(Us(d.hu,42227),d.hu=!1))})),await Vu(t,i,e)}catch(i){await rc(i)}}function Qx(n,e,t){const i=Jt(n);if(i.isPrimaryClient&&t===0||!i.isPrimaryClient&&t===1){const l=[];i.Tu.forEach(((u,d)=>{const p=d.view.va(e);p.snapshot&&l.push(p.snapshot)})),(function(d,p){const g=Jt(d);g.onlineState=p;let y=!1;g.queries.forEach(((w,k)=>{for(const j of k.ba)j.va(p)&&(y=!0)})),y&&_y(g)})(i.eventManager,e),l.length&&i.Pu.J_(l),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function qI(n,e,t){const i=Jt(n);i.sharedClientState.updateQueryState(e,"rejected",t);const l=i.Au.get(e),u=l&&l.key;if(u){let d=new mn(St.comparator);d=d.insert(u,lr.newNoDocument(u,Kt.min()));const p=bs().add(u),g=new um(Kt.min(),new Map,new mn(ys),d,p);await X_(i,g),i.Ru=i.Ru.remove(u),i.Au.delete(e),Ty(i)}else await kg(i.localStore,e,!1).then((()=>Eg(i,e,t))).catch(rc)}async function HI(n,e){const t=Jt(n),i=e.batch.batchId;try{const l=await ZA(t.localStore,e);Z_(t,i,null),J_(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),await Vu(t,l)}catch(l){await rc(l)}}async function $I(n,e,t){const i=Jt(n);try{const l=await(function(d,p){const g=Jt(d);return g.persistence.runTransaction("Reject batch","readwrite-primary",(y=>{let w;return g.mutationQueue.lookupMutationBatch(y,p).next((k=>(Us(k!==null,37113),w=k.keys(),g.mutationQueue.removeMutationBatch(y,k)))).next((()=>g.mutationQueue.performConsistencyCheck(y))).next((()=>g.documentOverlayCache.removeOverlaysForBatchId(y,w,p))).next((()=>g.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(y,w))).next((()=>g.localDocuments.getDocuments(y,w)))}))})(i.localStore,e);Z_(i,e,t),J_(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),await Vu(i,l)}catch(l){await rc(l)}}function J_(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function Z_(n,e,t){const i=Jt(n);let l=i.du[i.currentUser.toKey()];if(l){const u=l.get(e);u&&(t?u.reject(t):u.resolve(),l=l.remove(e)),i.du[i.currentUser.toKey()]=l}}function Eg(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const i of n.Iu.get(e))n.Tu.delete(i),t&&n.Pu.yu(i,t);n.Iu.delete(e),n.isPrimaryClient&&n.Vu.Gr(e).forEach((i=>{n.Vu.containsKey(i)||ek(n,i)}))}function ek(n,e){n.Eu.delete(e.path.canonicalString());const t=n.Ru.get(e);t!==null&&(fy(n.remoteStore,t),n.Ru=n.Ru.remove(e),n.Au.delete(t),Ty(n))}function Xx(n,e,t){for(const i of t)i instanceof K_?(n.Vu.addReference(i.key,e),WI(n,i)):i instanceof Y_?(ut(jy,"Document no longer in limbo: "+i.key),n.Vu.removeReference(i.key,e),n.Vu.containsKey(i.key)||ek(n,i.key)):Bt(19791,{wu:i})}function WI(n,e){const t=e.key,i=t.path.canonicalString();n.Ru.get(t)||n.Eu.has(i)||(ut(jy,"New document in limbo: "+t),n.Eu.add(i),Ty(n))}function Ty(n){for(;n.Eu.size>0&&n.Ru.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new St(tn.fromString(e)),i=n.fu.next();n.Au.set(i,new PI(t)),n.Ru=n.Ru.insert(t,i),F_(n.remoteStore,new Zi(Va(rm(t.path)),i,"TargetPurposeLimboResolution",tm.ce))}}async function Vu(n,e,t){const i=Jt(n),l=[],u=[],d=[];i.Tu.isEmpty()||(i.Tu.forEach(((p,g)=>{d.push(i.pu(g,e,t).then((y=>{if((y||t)&&i.isPrimaryClient){const w=y?!y.fromCache:t?.targetChanges.get(g.targetId)?.current;i.sharedClientState.updateQueryState(g.targetId,w?"current":"not-current")}if(y){l.push(y);const w=hy.Es(g.targetId,y);u.push(w)}})))})),await Promise.all(d),i.Pu.J_(l),await(async function(g,y){const w=Jt(g);try{await w.persistence.runTransaction("notifyLocalViewChanges","readwrite",(k=>Ie.forEach(y,(j=>Ie.forEach(j.Ts,(O=>w.persistence.referenceDelegate.addReference(k,j.targetId,O))).next((()=>Ie.forEach(j.Is,(O=>w.persistence.referenceDelegate.removeReference(k,j.targetId,O)))))))))}catch(k){if(!ac(k))throw k;ut(my,"Failed to update sequence numbers: "+k)}for(const k of y){const j=k.targetId;if(!k.fromCache){const O=w.vs.get(j),H=O.snapshotVersion,B=O.withLastLimboFreeSnapshotVersion(H);w.vs=w.vs.insert(j,B)}}})(i.localStore,u))}async function GI(n,e){const t=Jt(n);if(!t.currentUser.isEqual(e)){ut(jy,"User change. New user:",e.toKey());const i=await V_(t.localStore,e);t.currentUser=e,(function(u,d){u.mu.forEach((p=>{p.forEach((g=>{g.reject(new nt(Te.CANCELLED,d))}))})),u.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await Vu(t,i.Ns)}}function KI(n,e){const t=Jt(n),i=t.Au.get(e);if(i&&i.hu)return bs().add(i.key);{let l=bs();const u=t.Iu.get(e);if(!u)return l;for(const d of u){const p=t.Tu.get(d);l=l.unionWith(p.view.nu)}return l}}function tk(n){const e=Jt(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=X_.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=KI.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=qI.bind(null,e),e.Pu.J_=AI.bind(null,e.eventManager),e.Pu.yu=II.bind(null,e.eventManager),e}function YI(n){const e=Jt(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=HI.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=$I.bind(null,e),e}class Fh{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=dm(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return JA(this.persistence,new YA,e.initialUser,this.serializer)}Cu(e){return new O_(dy.Vi,this.serializer)}Du(e){return new aI}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Fh.provider={build:()=>new Fh};class QI extends Fh{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){Us(this.persistence.referenceDelegate instanceof Uh,46915);const i=this.persistence.referenceDelegate.garbageCollector;return new DA(i,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?Ar.withCacheSize(this.cacheSizeBytes):Ar.DEFAULT;return new O_((i=>Uh.Vi(i,t)),this.serializer)}}class Ng{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>Qx(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=GI.bind(null,this.syncEngine),await SI(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new RI})()}createDatastore(e){const t=dm(e.databaseInfo.databaseId),i=uI(e.databaseInfo);return pI(e.authCredentials,e.appCheckCredentials,i,t)}createRemoteStore(e){return(function(i,l,u,d,p){return new yI(i,l,u,d,p)})(this.localStore,this.datastore,e.asyncQueue,(t=>Qx(this.syncEngine,t,0)),(function(){return Hx.v()?new Hx:new iI})())}createSyncEngine(e,t){return(function(l,u,d,p,g,y,w){const k=new LI(l,u,d,p,g,y);return w&&(k.gu=!0),k})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const i=Jt(t);ut(Yo,"RemoteStore shutting down."),i.Ea.add(5),await Ou(i),i.Aa.shutdown(),i.Va.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}Ng.provider={build:()=>new Ng};class Ey{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):gi("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}const mo="FirestoreClient";class XI{constructor(e,t,i,l,u){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this._databaseInfo=l,this.user=or.UNAUTHENTICATED,this.clientId=ey.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=u,this.authCredentials.start(i,(async d=>{ut(mo,"Received user=",d.uid),await this.authCredentialListener(d),this.user=d})),this.appCheckCredentials.start(i,(d=>(ut(mo,"Received new app check token=",d),this.appCheckCredentialListener(d,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this._databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new di;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const i=vy(t,"Failed to shutdown persistence");e.reject(i)}})),e.promise}}async function Dp(n,e){n.asyncQueue.verifyOperationInProgress(),ut(mo,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let i=t.initialUser;n.setCredentialChangeListener((async l=>{i.isEqual(l)||(await V_(e.localStore,l),i=l)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function Jx(n,e){n.asyncQueue.verifyOperationInProgress();const t=await JI(n);ut(mo,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((i=>Wx(e.remoteStore,i))),n.setAppCheckTokenChangeListener(((i,l)=>Wx(e.remoteStore,l))),n._onlineComponents=e}async function JI(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){ut(mo,"Using user provided OfflineComponentProvider");try{await Dp(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(l){return l.name==="FirebaseError"?l.code===Te.FAILED_PRECONDITION||l.code===Te.UNIMPLEMENTED:!(typeof DOMException<"u"&&l instanceof DOMException)||l.code===22||l.code===20||l.code===11})(t))throw t;Gl("Error using user provided cache. Falling back to memory cache: "+t),await Dp(n,new Fh)}}else ut(mo,"Using default OfflineComponentProvider"),await Dp(n,new QI(void 0));return n._offlineComponents}async function sk(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(ut(mo,"Using user provided OnlineComponentProvider"),await Jx(n,n._uninitializedComponentsProvider._online)):(ut(mo,"Using default OnlineComponentProvider"),await Jx(n,new Ng))),n._onlineComponents}function ZI(n){return sk(n).then((e=>e.syncEngine))}async function qh(n){const e=await sk(n),t=e.eventManager;return t.onListen=OI.bind(null,e.syncEngine),t.onUnlisten=UI.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=VI.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=zI.bind(null,e.syncEngine),t}function eM(n,e,t,i){const l=new Ey(i),u=new ky(e,l,t);return n.asyncQueue.enqueueAndForget((async()=>xy(await qh(n),u))),()=>{l.Nu(),n.asyncQueue.enqueueAndForget((async()=>wy(await qh(n),u)))}}function tM(n,e,t={}){const i=new di;return n.asyncQueue.enqueueAndForget((async()=>(function(u,d,p,g,y){const w=new Ey({next:j=>{w.Nu(),d.enqueueAndForget((()=>wy(u,k)));const O=j.docs.has(p);!O&&j.fromCache?y.reject(new nt(Te.UNAVAILABLE,"Failed to get document because the client is offline.")):O&&j.fromCache&&g&&g.source==="server"?y.reject(new nt(Te.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):y.resolve(j)},error:j=>y.reject(j)}),k=new ky(rm(p.path),w,{includeMetadataChanges:!0,Ka:!0});return xy(u,k)})(await qh(n),n.asyncQueue,e,t,i))),i.promise}function sM(n,e,t={}){const i=new di;return n.asyncQueue.enqueueAndForget((async()=>(function(u,d,p,g,y){const w=new Ey({next:j=>{w.Nu(),d.enqueueAndForget((()=>wy(u,k))),j.fromCache&&g.source==="server"?y.reject(new nt(Te.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):y.resolve(j)},error:j=>y.reject(j)}),k=new ky(p,w,{includeMetadataChanges:!0,Ka:!0});return xy(u,k)})(await qh(n),n.asyncQueue,e,t,i))),i.promise}function nM(n,e){const t=new di;return n.asyncQueue.enqueueAndForget((async()=>FI(await ZI(n),e,t))),t.promise}function nk(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}const rM="ComponentProvider",Zx=new Map;function aM(n,e,t,i,l){return new TR(n,e,t,l.host,l.ssl,l.experimentalForceLongPolling,l.experimentalAutoDetectLongPolling,nk(l.experimentalLongPollingOptions),l.useFetchStreams,l.isUsingEmulator,i)}const rk="firestore.googleapis.com",e2=!0;class t2{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new nt(Te.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=rk,this.ssl=e2}else this.host=e.host,this.ssl=e.ssl??e2;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=L_;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<IA)throw new nt(Te.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}mR("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=nk(e.experimentalLongPollingOptions??{}),(function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new nt(Te.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new nt(Te.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new nt(Te.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(i,l){return i.timeoutSeconds===l.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class fm{constructor(e,t,i,l){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=l,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new t2({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new nt(Te.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new nt(Te.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new t2(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(i){if(!i)return new nR;switch(i.type){case"firstParty":return new oR(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new nt(Te.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const i=Zx.get(t);i&&(ut(rM,"Removing Datastore"),Zx.delete(t),i.terminate())})(this),Promise.resolve()}}function iM(n,e,t,i={}){n=vr(n,fm);const l=fo(e),u=n._getSettings(),d={...u,emulatorOptions:n._getEmulatorOptions()},p=`${e}:${t}`;l&&(Vg(`https://${p}`),Bg("Firestore",!0)),u.host!==rk&&u.host!==p&&Gl("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const g={...u,host:p,ssl:l,emulatorOptions:i};if(!Ho(g,d)&&(n._setSettings(g),i.mockUserToken)){let y,w;if(typeof i.mockUserToken=="string")y=i.mockUserToken,w=or.MOCK_USER;else{y=J2(i.mockUserToken,n._app?.options.projectId);const k=i.mockUserToken.sub||i.mockUserToken.user_id;if(!k)throw new nt(Te.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");w=new or(k)}n._authCredentials=new rR(new $w(y,w))}}class xi{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new xi(this.firestore,e,this._query)}}class vn{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new ao(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new vn(this.firestore,e,this._key)}toJSON(){return{type:vn._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,i){if(Du(t,vn._jsonSchema))return new vn(e,i||null,new St(tn.fromString(t.referencePath)))}}vn._jsonSchemaVersion="firestore/documentReference/1.0",vn._jsonSchema={type:Dn("string",vn._jsonSchemaVersion),referencePath:Dn("string")};class ao extends xi{constructor(e,t,i){super(e,t,rm(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new vn(this.firestore,null,new St(e))}withConverter(e){return new ao(this.firestore,e,this._path)}}function $t(n,e,...t){if(n=Ks(n),Ww("collection","path",e),n instanceof fm){const i=tn.fromString(e,...t);return fx(i),new ao(n,null,i)}{if(!(n instanceof vn||n instanceof ao))throw new nt(Te.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(tn.fromString(e,...t));return fx(i),new ao(n.firestore,null,i)}}function We(n,e,...t){if(n=Ks(n),arguments.length===1&&(e=ey.newId()),Ww("doc","path",e),n instanceof fm){const i=tn.fromString(e,...t);return mx(i),new vn(n,null,new St(i))}{if(!(n instanceof vn||n instanceof ao))throw new nt(Te.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(tn.fromString(e,...t));return mx(i),new vn(n.firestore,n instanceof ao?n.converter:null,new St(i))}}const s2="AsyncQueue";class n2{constructor(e=Promise.resolve()){this.Yu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new U_(this,"async_queue_retry"),this._c=()=>{const i=Mp();i&&ut(s2,"Visibility state changed to "+i.visibilityState),this.M_.w_()},this.ac=e;const t=Mp();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=Mp();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new di;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Yu.push(e),this.lc())))}async lc(){if(this.Yu.length!==0){try{await this.Yu[0](),this.Yu.shift(),this.M_.reset()}catch(e){if(!ac(e))throw e;ut(s2,"Operation failed with retryable error: "+e)}this.Yu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((i=>{throw this.nc=i,this.rc=!1,gi("INTERNAL UNHANDLED ERROR: ",r2(i)),i})).then((i=>(this.rc=!1,i))))));return this.ac=t,t}enqueueAfterDelay(e,t,i){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const l=by.createAndSchedule(this,e,t,i,(u=>this.hc(u)));return this.tc.push(l),l}uc(){this.nc&&Bt(47125,{Pc:r2(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,i)=>t.targetTimeMs-i.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}Rc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function r2(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}class Fa extends fm{constructor(e,t,i,l){super(e,t,i,l),this.type="firestore",this._queue=new n2,this._persistenceKey=l?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new n2(e),this._firestoreClient=void 0,await e}}}function oM(n,e){const t=typeof n=="object"?n:qg(),i=typeof n=="string"?n:Ph,l=Qh(t,"firestore").getImmediate({identifier:i});if(!l._initialized){const u=Y2("firestore");u&&iM(l,...u)}return l}function Bu(n){if(n._terminated)throw new nt(Te.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||lM(n),n._firestoreClient}function lM(n){const e=n._freezeSettings(),t=aM(n._databaseId,n._app?.options.appId||"",n._persistenceKey,n._app?.options.apiKey,e);n._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new XI(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(l){const u=l?._online.build();return{_offline:l?._offline.build(u),_online:u}})(n._componentsProvider))}class na{constructor(e){this._byteString=e}static fromBase64String(e){try{return new na(tr.fromBase64String(e))}catch(t){throw new nt(Te.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new na(tr.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:na._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Du(e,na._jsonSchema))return na.fromBase64String(e.bytes)}}na._jsonSchemaVersion="firestore/bytes/1.0",na._jsonSchema={type:Dn("string",na._jsonSchemaVersion),bytes:Dn("string")};class pm{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new nt(Te.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new er(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Uu{constructor(e){this._methodName=e}}class Ua{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new nt(Te.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new nt(Te.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return ys(this._lat,e._lat)||ys(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Ua._jsonSchemaVersion}}static fromJSON(e){if(Du(e,Ua._jsonSchema))return new Ua(e.latitude,e.longitude)}}Ua._jsonSchemaVersion="firestore/geoPoint/1.0",Ua._jsonSchema={type:Dn("string",Ua._jsonSchemaVersion),latitude:Dn("number"),longitude:Dn("number")};class ya{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(i,l){if(i.length!==l.length)return!1;for(let u=0;u<i.length;++u)if(i[u]!==l[u])return!1;return!0})(this._values,e._values)}toJSON(){return{type:ya._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Du(e,ya._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new ya(e.vectorValues);throw new nt(Te.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}ya._jsonSchemaVersion="firestore/vectorValue/1.0",ya._jsonSchema={type:Dn("string",ya._jsonSchemaVersion),vectorValues:Dn("object")};const cM=/^__.*__$/;class uM{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return this.fieldMask!==null?new yo(e,this.data,this.fieldMask,t,this.fieldTransforms):new Pu(e,this.data,t,this.fieldTransforms)}}class ak{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return new yo(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function ik(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Bt(40011,{dataSource:n})}}class Ny{constructor(e,t,i,l,u,d){this.settings=e,this.databaseId=t,this.serializer=i,this.ignoreUndefinedProperties=l,u===void 0&&this.validatePath(),this.fieldTransforms=u||[],this.fieldMask=d||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(e){return new Ny({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(e){const t=this.path?.child(e),i=this.contextWith({path:t,arrayElement:!1});return i.validatePathSegment(e),i}childContextForFieldPath(e){const t=this.path?.child(e),i=this.contextWith({path:t,arrayElement:!1});return i.validatePath(),i}childContextForArray(e){return this.contextWith({path:void 0,arrayElement:!0})}createError(e){return Hh(e,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}validatePath(){if(this.path)for(let e=0;e<this.path.length;e++)this.validatePathSegment(this.path.get(e))}validatePathSegment(e){if(e.length===0)throw this.createError("Document fields must not be empty");if(ik(this.dataSource)&&cM.test(e))throw this.createError('Document fields cannot begin and end with "__"')}}class dM{constructor(e,t,i){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=i||dm(e)}createContext(e,t,i,l=!1){return new Ny({dataSource:e,methodName:t,targetDoc:i,path:er.emptyPath(),arrayElement:!1,hasConverter:l},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function zu(n){const e=n._freezeSettings(),t=dm(n._databaseId);return new dM(n._databaseId,!!e.ignoreUndefinedProperties,t)}function Sy(n,e,t,i,l,u={}){const d=n.createContext(u.merge||u.mergeFields?2:0,e,t,l);Ay("Data must be an object, but it was:",d,i);const p=ck(i,d);let g,y;if(u.merge)g=new $r(d.fieldMask),y=d.fieldTransforms;else if(u.mergeFields){const w=[];for(const k of u.mergeFields){const j=Qo(e,k,t);if(!d.contains(j))throw new nt(Te.INVALID_ARGUMENT,`Field '${j}' is specified in your field mask but missing from your input data.`);hk(w,j)||w.push(j)}g=new $r(w),y=d.fieldTransforms.filter((k=>g.covers(k.field)))}else g=null,y=d.fieldTransforms;return new uM(new Ir(p),g,y)}class gm extends Uu{_toFieldTransform(e){if(e.dataSource!==2)throw e.dataSource===1?e.createError(`${this._methodName}() can only appear at the top level of your update data`):e.createError(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof gm}}class Cy extends Uu{_toFieldTransform(e){return new __(e.path,new _u)}isEqual(e){return e instanceof Cy}}class Ry extends Uu{constructor(e,t){super(e),this.Vc=t}_toFieldTransform(e){const t=new Tu(e.serializer,y_(e.serializer,this.Vc));return new __(e.path,t)}isEqual(e){return e instanceof Ry&&this.Vc===e.Vc}}function ok(n,e,t,i){const l=n.createContext(1,e,t);Ay("Data must be an object, but it was:",l,i);const u=[],d=Ir.empty();go(i,((g,y)=>{const w=dk(e,g,t);y=Ks(y);const k=l.childContextForFieldPath(w);if(y instanceof gm)u.push(w);else{const j=Fu(y,k);j!=null&&(u.push(w),d.set(w,j))}}));const p=new $r(u);return new ak(d,p,l.fieldTransforms)}function lk(n,e,t,i,l,u){const d=n.createContext(1,e,t),p=[Qo(e,i,t)],g=[l];if(u.length%2!=0)throw new nt(Te.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let j=0;j<u.length;j+=2)p.push(Qo(e,u[j])),g.push(u[j+1]);const y=[],w=Ir.empty();for(let j=p.length-1;j>=0;--j)if(!hk(y,p[j])){const O=p[j];let H=g[j];H=Ks(H);const B=d.childContextForFieldPath(O);if(H instanceof gm)y.push(O);else{const V=Fu(H,B);V!=null&&(y.push(O),w.set(O,V))}}const k=new $r(y);return new ak(w,k,d.fieldTransforms)}function hM(n,e,t,i=!1){return Fu(t,n.createContext(i?4:3,e))}function Fu(n,e){if(uk(n=Ks(n)))return Ay("Unsupported field value:",e,n),ck(n,e);if(n instanceof Uu)return(function(i,l){if(!ik(l.dataSource))throw l.createError(`${i._methodName}() can only be used with update() and set()`);if(!l.path)throw l.createError(`${i._methodName}() is not currently supported inside arrays`);const u=i._toFieldTransform(l);u&&l.fieldTransforms.push(u)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.arrayElement&&e.dataSource!==4)throw e.createError("Nested arrays are not supported");return(function(i,l){const u=[];let d=0;for(const p of i){let g=Fu(p,l.childContextForArray(d));g==null&&(g={nullValue:"NULL_VALUE"}),u.push(g),d++}return{arrayValue:{values:u}}})(n,e)}return(function(i,l){if((i=Ks(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return y_(l.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const u=vt.fromDate(i);return{timestampValue:Bh(l.serializer,u)}}if(i instanceof vt){const u=new vt(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:Bh(l.serializer,u)}}if(i instanceof Ua)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof na)return{bytesValue:S_(l.serializer,i._byteString)};if(i instanceof vn){const u=l.databaseId,d=i.firestore._databaseId;if(!d.isEqual(u))throw l.createError(`Document reference is for database ${d.projectId}/${d.database} but should be for database ${u.projectId}/${u.database}`);return{referenceValue:cy(i.firestore._databaseId||l.databaseId,i._key.path)}}if(i instanceof ya)return(function(d,p){const g=d instanceof ya?d.toArray():d;return{mapValue:{fields:{[t_]:{stringValue:s_},[Lh]:{arrayValue:{values:g.map((w=>{if(typeof w!="number")throw p.createError("VectorValues must only contain numeric values.");return iy(p.serializer,w)}))}}}}}})(i,l);if(P_(i))return i._toProto(l.serializer);throw l.createError(`Unsupported field value: ${em(i)}`)})(n,e)}function ck(n,e){const t={};return Yw(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):go(n,((i,l)=>{const u=Fu(l,e.childContextForField(i));u!=null&&(t[i]=u)})),{mapValue:{fields:t}}}function uk(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof vt||n instanceof Ua||n instanceof na||n instanceof vn||n instanceof Uu||n instanceof ya||P_(n))}function Ay(n,e,t){if(!uk(t)||!Gw(t)){const i=em(t);throw i==="an object"?e.createError(n+" a custom object"):e.createError(n+" "+i)}}function Qo(n,e,t){if((e=Ks(e))instanceof pm)return e._internalPath;if(typeof e=="string")return dk(n,e);throw Hh("Field path arguments must be of type string or ",n,!1,void 0,t)}const mM=new RegExp("[~\\*/\\[\\]]");function dk(n,e,t){if(e.search(mM)>=0)throw Hh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new pm(...e.split("."))._internalPath}catch{throw Hh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Hh(n,e,t,i,l){const u=i&&!i.isEmpty(),d=l!==void 0;let p=`Function ${e}() called with invalid data`;t&&(p+=" (via `toFirestore()`)"),p+=". ";let g="";return(u||d)&&(g+=" (found",u&&(g+=` in field ${i}`),d&&(g+=` in document ${l}`),g+=")"),new nt(Te.INVALID_ARGUMENT,p+n+g)}function hk(n,e){return n.some((t=>t.isEqual(e)))}class fM{convertValue(e,t="none"){switch(uo(e)){case 0:return null;case 1:return e.booleanValue;case 2:return En(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(co(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Bt(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const i={};return go(e,((l,u)=>{i[l]=this.convertValue(u,t)})),i}convertVectorValue(e){const t=e.fields?.[Lh].arrayValue?.values?.map((i=>En(i.doubleValue)));return new ya(t)}convertGeoPoint(e){return new Ua(En(e.latitude),En(e.longitude))}convertArray(e,t){return(e.values||[]).map((i=>this.convertValue(i,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const i=nm(e);return i==null?null:this.convertValue(i,t);case"estimate":return this.convertTimestamp(bu(e));default:return null}}convertTimestamp(e){const t=lo(e);return new vt(t.seconds,t.nanos)}convertDocumentKey(e,t){const i=tn.fromString(e);Us(D_(i),9688,{name:e});const l=new vu(i.get(1),i.get(3)),u=new St(i.popFirst(5));return l.isEqual(t)||gi(`Document ${u} contains a document reference within a different database (${l.projectId}/${l.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),u}}class Iy extends fM{constructor(e){super(),this.firestore=e}convertBytes(e){return new na(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new vn(this.firestore,null,t)}}function Hr(){return new Cy("serverTimestamp")}function Bo(n){return new Ry("increment",n)}const a2="@firebase/firestore",i2="4.10.0";function o2(n){return(function(t,i){if(typeof t!="object"||t===null)return!1;const l=t;for(const u of i)if(u in l&&typeof l[u]=="function")return!0;return!1})(n,["next","error","complete"])}class mk{constructor(e,t,i,l,u){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=l,this._converter=u}get id(){return this._key.path.lastSegment()}get ref(){return new vn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new pM(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}_fieldsProto(){return this._document?.data.clone().value.mapValue.fields??void 0}get(e){if(this._document){const t=this._document.data.field(Qo("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class pM extends mk{data(){return super.data()}}function fk(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new nt(Te.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class My{}class Dy extends My{}function Ps(n,e,...t){let i=[];e instanceof My&&i.push(e),i=i.concat(t),(function(u){const d=u.filter((g=>g instanceof Py)).length,p=u.filter((g=>g instanceof ym)).length;if(d>1||d>0&&p>0)throw new nt(Te.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(i);for(const l of i)n=l._apply(n);return n}class ym extends Dy{constructor(e,t,i){super(),this._field=e,this._op=t,this._value=i,this.type="where"}static _create(e,t,i){return new ym(e,t,i)}_apply(e){const t=this._parse(e);return pk(e._query,t),new xi(e.firestore,e.converter,bg(e._query,t))}_parse(e){const t=zu(e.firestore);return(function(u,d,p,g,y,w,k){let j;if(y.isKeyField()){if(w==="array-contains"||w==="array-contains-any")throw new nt(Te.INVALID_ARGUMENT,`Invalid Query. You can't perform '${w}' queries on documentId().`);if(w==="in"||w==="not-in"){c2(k,w);const H=[];for(const B of k)H.push(l2(g,u,B));j={arrayValue:{values:H}}}else j=l2(g,u,k)}else w!=="in"&&w!=="not-in"&&w!=="array-contains-any"||c2(k,w),j=hM(p,d,k,w==="in"||w==="not-in");return Mn.create(y,w,j)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function us(n,e,t){const i=e,l=Qo("where",n);return ym._create(l,i,t)}class Py extends My{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Py(e,t)}_parse(e){const t=this._queryConstraints.map((i=>i._parse(e))).filter((i=>i.getFilters().length>0));return t.length===1?t[0]:va.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(l,u){let d=l;const p=u.getFlattenedFilters();for(const g of p)pk(d,g),d=bg(d,g)})(e._query,t),new xi(e.firestore,e.converter,bg(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Ly extends Dy{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new Ly(e,t)}_apply(e){const t=(function(l,u,d){if(l.startAt!==null)throw new nt(Te.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(l.endAt!==null)throw new nt(Te.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new wu(u,d)})(e._query,this._field,this._direction);return new xi(e.firestore,e.converter,qR(e._query,t))}}function $h(n,e="asc"){const t=e,i=Qo("orderBy",n);return Ly._create(i,t)}class Oy extends Dy{constructor(e,t,i){super(),this.type=e,this._limit=t,this._limitType=i}static _create(e,t,i){return new Oy(e,t,i)}_apply(e){return new xi(e.firestore,e.converter,Vh(e._query,this._limit,this._limitType))}}function Wh(n){return fR("limit",n),Oy._create("limit",n,"F")}function l2(n,e,t){if(typeof(t=Ks(t))=="string"){if(t==="")throw new nt(Te.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!u_(e)&&t.indexOf("/")!==-1)throw new nt(Te.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const i=e.path.child(tn.fromString(t));if(!St.isDocumentKey(i))throw new nt(Te.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return _x(n,new St(i))}if(t instanceof vn)return _x(n,t._key);throw new nt(Te.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${em(t)}.`)}function c2(n,e){if(!Array.isArray(n)||n.length===0)throw new nt(Te.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function pk(n,e){const t=(function(l,u){for(const d of l)for(const p of d.getFlattenedFilters())if(u.indexOf(p.op)>=0)return p.op;return null})(n.filters,(function(l){switch(l){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new nt(Te.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new nt(Te.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}function Vy(n,e,t){let i;return i=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,i}class nu{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Uo extends mk{constructor(e,t,i,l,u,d){super(e,t,i,l,d),this._firestore=e,this._firestoreImpl=e,this.metadata=u}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new kh(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const i=this._document.data.field(Qo("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new nt(Te.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=Uo._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}Uo._jsonSchemaVersion="firestore/documentSnapshot/1.0",Uo._jsonSchema={type:Dn("string",Uo._jsonSchemaVersion),bundleSource:Dn("string","DocumentSnapshot"),bundleName:Dn("string"),bundle:Dn("string")};class kh extends Uo{data(e={}){return super.data(e)}}class zo{constructor(e,t,i,l){this._firestore=e,this._userDataWriter=t,this._snapshot=l,this.metadata=new nu(l.hasPendingWrites,l.fromCache),this.query=i}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((i=>{e.call(t,new kh(this._firestore,this._userDataWriter,i.key,i,new nu(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new nt(Te.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(l,u){if(l._snapshot.oldDocs.isEmpty()){let d=0;return l._snapshot.docChanges.map((p=>{const g=new kh(l._firestore,l._userDataWriter,p.doc.key,p.doc,new nu(l._snapshot.mutatedKeys.has(p.doc.key),l._snapshot.fromCache),l.query.converter);return p.doc,{type:"added",doc:g,oldIndex:-1,newIndex:d++}}))}{let d=l._snapshot.oldDocs;return l._snapshot.docChanges.filter((p=>u||p.type!==3)).map((p=>{const g=new kh(l._firestore,l._userDataWriter,p.doc.key,p.doc,new nu(l._snapshot.mutatedKeys.has(p.doc.key),l._snapshot.fromCache),l.query.converter);let y=-1,w=-1;return p.type!==0&&(y=d.indexOf(p.doc.key),d=d.delete(p.doc.key)),p.type!==1&&(d=d.add(p.doc),w=d.indexOf(p.doc.key)),{type:gM(p.type),doc:g,oldIndex:y,newIndex:w}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new nt(Te.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=zo._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=ey.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],i=[],l=[];return this.docs.forEach((u=>{u._document!==null&&(t.push(u._document),i.push(this._userDataWriter.convertObjectMap(u._document.data.value.mapValue.fields,"previous")),l.push(u.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function gM(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Bt(61501,{type:n})}}zo._jsonSchemaVersion="firestore/querySnapshot/1.0",zo._jsonSchema={type:Dn("string",zo._jsonSchemaVersion),bundleSource:Dn("string","QuerySnapshot"),bundleName:Dn("string"),bundle:Dn("string")};class yM{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=zu(e)}set(e,t,i){this._verifyNotCommitted();const l=Pp(e,this._firestore),u=Vy(l.converter,t,i),d=Sy(this._dataReader,"WriteBatch.set",l._key,u,l.converter!==null,i);return this._mutations.push(d.toMutation(l._key,xr.none())),this}update(e,t,i,...l){this._verifyNotCommitted();const u=Pp(e,this._firestore);let d;return d=typeof(t=Ks(t))=="string"||t instanceof pm?lk(this._dataReader,"WriteBatch.update",u._key,t,i,l):ok(this._dataReader,"WriteBatch.update",u._key,t),this._mutations.push(d.toMutation(u._key,xr.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=Pp(e,this._firestore);return this._mutations=this._mutations.concat(new cm(t._key,xr.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new nt(Te.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Pp(n,e){if((n=Ks(n)).firestore!==e)throw new nt(Te.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}function Ns(n){n=vr(n,vn);const e=vr(n.firestore,Fa),t=Bu(e);return tM(t,n._key).then((i=>yk(e,n,i)))}function js(n){n=vr(n,xi);const e=vr(n.firestore,Fa),t=Bu(e),i=new Iy(e);return fk(n._query),sM(t,n._query).then((l=>new zo(e,i,n,l)))}function Ss(n,e,t){n=vr(n,vn);const i=vr(n.firestore,Fa),l=Vy(n.converter,e,t),u=zu(i);return qu(i,[Sy(u,"setDoc",n._key,l,n.converter!==null,t).toMutation(n._key,xr.none())])}function Ma(n,e,t,...i){n=vr(n,vn);const l=vr(n.firestore,Fa),u=zu(l);let d;return d=typeof(e=Ks(e))=="string"||e instanceof pm?lk(u,"updateDoc",n._key,e,t,i):ok(u,"updateDoc",n._key,e),qu(l,[d.toMutation(n._key,xr.exists(!0))])}function yr(n){return qu(vr(n.firestore,Fa),[new cm(n._key,xr.none())])}function hi(n,e){const t=vr(n.firestore,Fa),i=We(n),l=Vy(n.converter,e),u=zu(n.firestore);return qu(t,[Sy(u,"addDoc",i._key,l,n.converter!==null,{}).toMutation(i._key,xr.exists(!1))]).then((()=>i))}function gk(n,...e){n=Ks(n);let t={includeMetadataChanges:!1,source:"default"},i=0;typeof e[i]!="object"||o2(e[i])||(t=e[i++]);const l={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(o2(e[i])){const y=e[i];e[i]=y.next?.bind(y),e[i+1]=y.error?.bind(y),e[i+2]=y.complete?.bind(y)}let u,d,p;if(n instanceof vn)d=vr(n.firestore,Fa),p=rm(n._key.path),u={next:y=>{e[i]&&e[i](yk(d,n,y))},error:e[i+1],complete:e[i+2]};else{const y=vr(n,xi);d=vr(y.firestore,Fa),p=y._query;const w=new Iy(d);u={next:k=>{e[i]&&e[i](new zo(d,w,y,k))},error:e[i+1],complete:e[i+2]},fk(n._query)}const g=Bu(d);return eM(g,p,l,u)}function qu(n,e){const t=Bu(n);return nM(t,e)}function yk(n,e,t){const i=t.docs.get(e._key),l=new Iy(n);return new Uo(n,l,e._key,i,new nu(t.hasPendingWrites,t.fromCache),e.converter)}function u2(n){return n=vr(n,Fa),Bu(n),new yM(n,(e=>qu(n,e)))}(function(e,t=!0){sR(Jo),$o(new io("firestore",((i,{instanceIdentifier:l,options:u})=>{const d=i.getProvider("app").getImmediate(),p=new Fa(new aR(i.getProvider("auth-internal")),new lR(d,i.getProvider("app-check-internal")),ER(d,l),d);return u={useFetchStreams:t,...u},p._setSettings(u),p}),"PUBLIC").setMultipleInstances(!0)),Pa(a2,i2,e),Pa(a2,i2,"esm2020")})();var bM="firebase",vM="12.8.0";Pa(bM,vM,"app");const bk="firebasestorage.googleapis.com",vk="storageBucket",xM=120*1e3,wM=600*1e3;class wn extends qa{constructor(e,t,i=0){super(Lp(e),`Firebase Storage: ${t} (${Lp(e)})`),this.status_=i,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,wn.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Lp(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var xn;(function(n){n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(xn||(xn={}));function Lp(n){return"storage/"+n}function By(){const n="An unknown error occurred, please check the error payload for server response.";return new wn(xn.UNKNOWN,n)}function _M(n){return new wn(xn.OBJECT_NOT_FOUND,"Object '"+n+"' does not exist.")}function kM(n){return new wn(xn.QUOTA_EXCEEDED,"Quota for bucket '"+n+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function jM(){const n="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new wn(xn.UNAUTHENTICATED,n)}function TM(){return new wn(xn.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function EM(n){return new wn(xn.UNAUTHORIZED,"User does not have permission to access '"+n+"'.")}function NM(){return new wn(xn.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function SM(){return new wn(xn.CANCELED,"User canceled the upload/download.")}function CM(n){return new wn(xn.INVALID_URL,"Invalid URL '"+n+"'.")}function RM(n){return new wn(xn.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function AM(){return new wn(xn.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+vk+"' property when initializing the app?")}function IM(){return new wn(xn.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function MM(){return new wn(xn.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function DM(n){return new wn(xn.UNSUPPORTED_ENVIRONMENT,`${n} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function Sg(n){return new wn(xn.INVALID_ARGUMENT,n)}function xk(){return new wn(xn.APP_DELETED,"The Firebase app was deleted.")}function PM(n){return new wn(xn.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function uu(n,e){return new wn(xn.INVALID_FORMAT,"String does not match format '"+n+"': "+e)}function Kc(n){throw new wn(xn.INTERNAL_ERROR,"Internal error: "+n)}class br{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let i;try{i=br.makeFromUrl(e,t)}catch{return new br(e,"")}if(i.path==="")return i;throw RM(e)}static makeFromUrl(e,t){let i=null;const l="([A-Za-z0-9.\\-_]+)";function u(ye){ye.path.charAt(ye.path.length-1)==="/"&&(ye.path_=ye.path_.slice(0,-1))}const d="(/(.*))?$",p=new RegExp("^gs://"+l+d,"i"),g={bucket:1,path:3};function y(ye){ye.path_=decodeURIComponent(ye.path)}const w="v[A-Za-z0-9_]+",k=t.replace(/[.]/g,"\\."),j="(/([^?#]*).*)?$",O=new RegExp(`^https?://${k}/${w}/b/${l}/o${j}`,"i"),H={bucket:1,path:3},B=t===bk?"(?:storage.googleapis.com|storage.cloud.google.com)":t,V="([^?#]*)",se=new RegExp(`^https?://${B}/${l}/${V}`,"i"),oe=[{regex:p,indices:g,postModify:u},{regex:O,indices:H,postModify:y},{regex:se,indices:{bucket:1,path:2},postModify:y}];for(let ye=0;ye<oe.length;ye++){const Pe=oe[ye],Ee=Pe.regex.exec(e);if(Ee){const R=Ee[Pe.indices.bucket];let T=Ee[Pe.indices.path];T||(T=""),i=new br(R,T),Pe.postModify(i);break}}if(i==null)throw CM(e);return i}}class LM{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function OM(n,e,t){let i=1,l=null,u=null,d=!1,p=0;function g(){return p===2}let y=!1;function w(...V){y||(y=!0,e.apply(null,V))}function k(V){l=setTimeout(()=>{l=null,n(O,g())},V)}function j(){u&&clearTimeout(u)}function O(V,...se){if(y){j();return}if(V){j(),w.call(null,V,...se);return}if(g()||d){j(),w.call(null,V,...se);return}i<64&&(i*=2);let oe;p===1?(p=2,oe=0):oe=(i+Math.random())*1e3,k(oe)}let H=!1;function B(V){H||(H=!0,j(),!y&&(l!==null?(V||(p=2),clearTimeout(l),k(0)):V||(p=1)))}return k(0),u=setTimeout(()=>{d=!0,B(!0)},t),B}function VM(n){n(!1)}function BM(n){return n!==void 0}function UM(n){return typeof n=="object"&&!Array.isArray(n)}function Uy(n){return typeof n=="string"||n instanceof String}function d2(n){return zy()&&n instanceof Blob}function zy(){return typeof Blob<"u"}function Cg(n,e,t,i){if(i<e)throw Sg(`Invalid value for '${n}'. Expected ${e} or greater.`);if(i>t)throw Sg(`Invalid value for '${n}'. Expected ${t} or less.`)}function bm(n,e,t){let i=e;return t==null&&(i=`https://${e}`),`${t}://${i}/v0${n}`}function wk(n){const e=encodeURIComponent;let t="?";for(const i in n)if(n.hasOwnProperty(i)){const l=e(i)+"="+e(n[i]);t=t+l+"&"}return t=t.slice(0,-1),t}var Fo;(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"})(Fo||(Fo={}));function zM(n,e){const t=n>=500&&n<600,l=[408,429].indexOf(n)!==-1,u=e.indexOf(n)!==-1;return t||l||u}class FM{constructor(e,t,i,l,u,d,p,g,y,w,k,j=!0,O=!1){this.url_=e,this.method_=t,this.headers_=i,this.body_=l,this.successCodes_=u,this.additionalRetryCodes_=d,this.callback_=p,this.errorCallback_=g,this.timeout_=y,this.progressCallback_=w,this.connectionFactory_=k,this.retry=j,this.isUsingEmulator=O,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((H,B)=>{this.resolve_=H,this.reject_=B,this.start_()})}start_(){const e=(i,l)=>{if(l){i(!1,new ah(!1,null,!0));return}const u=this.connectionFactory_();this.pendingConnection_=u;const d=p=>{const g=p.loaded,y=p.lengthComputable?p.total:-1;this.progressCallback_!==null&&this.progressCallback_(g,y)};this.progressCallback_!==null&&u.addUploadProgressListener(d),u.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&u.removeUploadProgressListener(d),this.pendingConnection_=null;const p=u.getErrorCode()===Fo.NO_ERROR,g=u.getStatus();if(!p||zM(g,this.additionalRetryCodes_)&&this.retry){const w=u.getErrorCode()===Fo.ABORT;i(!1,new ah(!1,null,w));return}const y=this.successCodes_.indexOf(g)!==-1;i(!0,new ah(y,u))})},t=(i,l)=>{const u=this.resolve_,d=this.reject_,p=l.connection;if(l.wasSuccessCode)try{const g=this.callback_(p,p.getResponse());BM(g)?u(g):u()}catch(g){d(g)}else if(p!==null){const g=By();g.serverResponse=p.getErrorText(),this.errorCallback_?d(this.errorCallback_(p,g)):d(g)}else if(l.canceled){const g=this.appDelete_?xk():SM();d(g)}else{const g=NM();d(g)}};this.canceled_?t(!1,new ah(!1,null,!0)):this.backoffId_=OM(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&VM(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class ah{constructor(e,t,i){this.wasSuccessCode=e,this.connection=t,this.canceled=!!i}}function qM(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function HM(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function $M(n,e){e&&(n["X-Firebase-GMPID"]=e)}function WM(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function GM(n,e,t,i,l,u,d=!0,p=!1){const g=wk(n.urlParams),y=n.url+g,w=Object.assign({},n.headers);return $M(w,e),qM(w,t),HM(w,u),WM(w,i),new FM(y,n.method,w,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,l,d,p)}function KM(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function YM(...n){const e=KM();if(e!==void 0){const t=new e;for(let i=0;i<n.length;i++)t.append(n[i]);return t.getBlob()}else{if(zy())return new Blob(n);throw new wn(xn.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function QM(n,e,t){return n.webkitSlice?n.webkitSlice(e,t):n.mozSlice?n.mozSlice(e,t):n.slice?n.slice(e,t):null}function XM(n){if(typeof atob>"u")throw DM("base-64");return atob(n)}const Da={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class Op{constructor(e,t){this.data=e,this.contentType=t||null}}function JM(n,e){switch(n){case Da.RAW:return new Op(_k(e));case Da.BASE64:case Da.BASE64URL:return new Op(kk(n,e));case Da.DATA_URL:return new Op(e3(e),t3(e))}throw By()}function _k(n){const e=[];for(let t=0;t<n.length;t++){let i=n.charCodeAt(t);if(i<=127)e.push(i);else if(i<=2047)e.push(192|i>>6,128|i&63);else if((i&64512)===55296)if(!(t<n.length-1&&(n.charCodeAt(t+1)&64512)===56320))e.push(239,191,189);else{const u=i,d=n.charCodeAt(++t);i=65536|(u&1023)<<10|d&1023,e.push(240|i>>18,128|i>>12&63,128|i>>6&63,128|i&63)}else(i&64512)===56320?e.push(239,191,189):e.push(224|i>>12,128|i>>6&63,128|i&63)}return new Uint8Array(e)}function ZM(n){let e;try{e=decodeURIComponent(n)}catch{throw uu(Da.DATA_URL,"Malformed data URL.")}return _k(e)}function kk(n,e){switch(n){case Da.BASE64:{const l=e.indexOf("-")!==-1,u=e.indexOf("_")!==-1;if(l||u)throw uu(n,"Invalid character '"+(l?"-":"_")+"' found: is it base64url encoded?");break}case Da.BASE64URL:{const l=e.indexOf("+")!==-1,u=e.indexOf("/")!==-1;if(l||u)throw uu(n,"Invalid character '"+(l?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let t;try{t=XM(e)}catch(l){throw l.message.includes("polyfill")?l:uu(n,"Invalid character found")}const i=new Uint8Array(t.length);for(let l=0;l<t.length;l++)i[l]=t.charCodeAt(l);return i}class jk{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(t===null)throw uu(Da.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const i=t[1]||null;i!=null&&(this.base64=s3(i,";base64"),this.contentType=this.base64?i.substring(0,i.length-7):i),this.rest=e.substring(e.indexOf(",")+1)}}function e3(n){const e=new jk(n);return e.base64?kk(Da.BASE64,e.rest):ZM(e.rest)}function t3(n){return new jk(n).contentType}function s3(n,e){return n.length>=e.length?n.substring(n.length-e.length)===e:!1}class Ji{constructor(e,t){let i=0,l="";d2(e)?(this.data_=e,i=e.size,l=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),i=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),i=e.length),this.size_=i,this.type_=l}size(){return this.size_}type(){return this.type_}slice(e,t){if(d2(this.data_)){const i=this.data_,l=QM(i,e,t);return l===null?null:new Ji(l)}else{const i=new Uint8Array(this.data_.buffer,e,t-e);return new Ji(i,!0)}}static getBlob(...e){if(zy()){const t=e.map(i=>i instanceof Ji?i.data_:i);return new Ji(YM.apply(null,t))}else{const t=e.map(d=>Uy(d)?JM(Da.RAW,d).data:d.data_);let i=0;t.forEach(d=>{i+=d.byteLength});const l=new Uint8Array(i);let u=0;return t.forEach(d=>{for(let p=0;p<d.length;p++)l[u++]=d[p]}),new Ji(l,!0)}}uploadData(){return this.data_}}function Fy(n){let e;try{e=JSON.parse(n)}catch{return null}return UM(e)?e:null}function n3(n){if(n.length===0)return null;const e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function r3(n,e){const t=e.split("/").filter(i=>i.length>0).join("/");return n.length===0?t:n+"/"+t}function Tk(n){const e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}function a3(n,e){return e}class gr{constructor(e,t,i,l){this.server=e,this.local=t||e,this.writable=!!i,this.xform=l||a3}}let ih=null;function i3(n){return!Uy(n)||n.length<2?n:Tk(n)}function Ek(){if(ih)return ih;const n=[];n.push(new gr("bucket")),n.push(new gr("generation")),n.push(new gr("metageneration")),n.push(new gr("name","fullPath",!0));function e(u,d){return i3(d)}const t=new gr("name");t.xform=e,n.push(t);function i(u,d){return d!==void 0?Number(d):d}const l=new gr("size");return l.xform=i,n.push(l),n.push(new gr("timeCreated")),n.push(new gr("updated")),n.push(new gr("md5Hash",null,!0)),n.push(new gr("cacheControl",null,!0)),n.push(new gr("contentDisposition",null,!0)),n.push(new gr("contentEncoding",null,!0)),n.push(new gr("contentLanguage",null,!0)),n.push(new gr("contentType",null,!0)),n.push(new gr("metadata","customMetadata",!0)),ih=n,ih}function o3(n,e){function t(){const i=n.bucket,l=n.fullPath,u=new br(i,l);return e._makeStorageReference(u)}Object.defineProperty(n,"ref",{get:t})}function l3(n,e,t){const i={};i.type="file";const l=t.length;for(let u=0;u<l;u++){const d=t[u];i[d.local]=d.xform(i,e[d.server])}return o3(i,n),i}function Nk(n,e,t){const i=Fy(e);return i===null?null:l3(n,i,t)}function c3(n,e,t,i){const l=Fy(e);if(l===null||!Uy(l.downloadTokens))return null;const u=l.downloadTokens;if(u.length===0)return null;const d=encodeURIComponent;return u.split(",").map(y=>{const w=n.bucket,k=n.fullPath,j="/b/"+d(w)+"/o/"+d(k),O=bm(j,t,i),H=wk({alt:"media",token:y});return O+H})[0]}function u3(n,e){const t={},i=e.length;for(let l=0;l<i;l++){const u=e[l];u.writable&&(t[u.server]=n[u.local])}return JSON.stringify(t)}const h2="prefixes",m2="items";function d3(n,e,t){const i={prefixes:[],items:[],nextPageToken:t.nextPageToken};if(t[h2])for(const l of t[h2]){const u=l.replace(/\/$/,""),d=n._makeStorageReference(new br(e,u));i.prefixes.push(d)}if(t[m2])for(const l of t[m2]){const u=n._makeStorageReference(new br(e,l.name));i.items.push(u)}return i}function h3(n,e,t){const i=Fy(t);return i===null?null:d3(n,e,i)}class qy{constructor(e,t,i,l){this.url=e,this.method=t,this.handler=i,this.timeout=l,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function Hy(n){if(!n)throw By()}function m3(n,e){function t(i,l){const u=Nk(n,l,e);return Hy(u!==null),u}return t}function f3(n,e){function t(i,l){const u=h3(n,e,l);return Hy(u!==null),u}return t}function p3(n,e){function t(i,l){const u=Nk(n,l,e);return Hy(u!==null),c3(u,l,n.host,n._protocol)}return t}function $y(n){function e(t,i){let l;return t.getStatus()===401?t.getErrorText().includes("Firebase App Check token is invalid")?l=TM():l=jM():t.getStatus()===402?l=kM(n.bucket):t.getStatus()===403?l=EM(n.path):l=i,l.status=t.getStatus(),l.serverResponse=i.serverResponse,l}return e}function g3(n){const e=$y(n);function t(i,l){let u=e(i,l);return i.getStatus()===404&&(u=_M(n.path)),u.serverResponse=l.serverResponse,u}return t}function y3(n,e,t,i,l){const u={};e.isRoot?u.prefix="":u.prefix=e.path+"/",t.length>0&&(u.delimiter=t),i&&(u.pageToken=i),l&&(u.maxResults=l);const d=e.bucketOnlyServerUrl(),p=bm(d,n.host,n._protocol),g="GET",y=n.maxOperationRetryTime,w=new qy(p,g,f3(n,e.bucket),y);return w.urlParams=u,w.errorHandler=$y(e),w}function b3(n,e,t){const i=e.fullServerUrl(),l=bm(i,n.host,n._protocol),u="GET",d=n.maxOperationRetryTime,p=new qy(l,u,p3(n,t),d);return p.errorHandler=g3(e),p}function v3(n,e){return n&&n.contentType||e&&e.type()||"application/octet-stream"}function x3(n,e,t){const i=Object.assign({},t);return i.fullPath=n.path,i.size=e.size(),i.contentType||(i.contentType=v3(null,e)),i}function w3(n,e,t,i,l){const u=e.bucketOnlyServerUrl(),d={"X-Goog-Upload-Protocol":"multipart"};function p(){let oe="";for(let ye=0;ye<2;ye++)oe=oe+Math.random().toString().slice(2);return oe}const g=p();d["Content-Type"]="multipart/related; boundary="+g;const y=x3(e,i,l),w=u3(y,t),k="--"+g+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+w+`\r
--`+g+`\r
Content-Type: `+y.contentType+`\r
\r
`,j=`\r
--`+g+"--",O=Ji.getBlob(k,i,j);if(O===null)throw IM();const H={name:y.fullPath},B=bm(u,n.host,n._protocol),V="POST",se=n.maxUploadRetryTime,K=new qy(B,V,m3(n,t),se);return K.urlParams=H,K.headers=d,K.body=O.uploadData(),K.errorHandler=$y(e),K}class _3{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Fo.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Fo.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Fo.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,i,l,u){if(this.sent_)throw Kc("cannot .send() more than once");if(fo(e)&&i&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(t,e,!0),u!==void 0)for(const d in u)u.hasOwnProperty(d)&&this.xhr_.setRequestHeader(d,u[d].toString());return l!==void 0?this.xhr_.send(l):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Kc("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Kc("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw Kc("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Kc("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class k3 extends _3{initXhr(){this.xhr_.responseType="text"}}function Wy(){return new k3}class Xo{constructor(e,t){this._service=e,t instanceof br?this._location=t:this._location=br.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new Xo(e,t)}get root(){const e=new br(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return Tk(this._location.path)}get storage(){return this._service}get parent(){const e=n3(this._location.path);if(e===null)return null;const t=new br(this._location.bucket,e);return new Xo(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw PM(e)}}function j3(n,e,t){n._throwIfRoot("uploadBytes");const i=w3(n.storage,n._location,Ek(),new Ji(e,!0),t);return n.storage.makeRequestWithTokens(i,Wy).then(l=>({metadata:l,ref:n}))}function T3(n){const e={prefixes:[],items:[]};return Sk(n,e).then(()=>e)}async function Sk(n,e,t){const l=await E3(n,{pageToken:t});e.prefixes.push(...l.prefixes),e.items.push(...l.items),l.nextPageToken!=null&&await Sk(n,e,l.nextPageToken)}function E3(n,e){e!=null&&typeof e.maxResults=="number"&&Cg("options.maxResults",1,1e3,e.maxResults);const t=e||{},i=y3(n.storage,n._location,"/",t.pageToken,t.maxResults);return n.storage.makeRequestWithTokens(i,Wy)}function N3(n){n._throwIfRoot("getDownloadURL");const e=b3(n.storage,n._location,Ek());return n.storage.makeRequestWithTokens(e,Wy).then(t=>{if(t===null)throw MM();return t})}function S3(n,e){const t=r3(n._location.path,e),i=new br(n._location.bucket,t);return new Xo(n.storage,i)}function C3(n){return/^[A-Za-z]+:\/\//.test(n)}function R3(n,e){return new Xo(n,e)}function Ck(n,e){if(n instanceof Gy){const t=n;if(t._bucket==null)throw AM();const i=new Xo(t,t._bucket);return e!=null?Ck(i,e):i}else return e!==void 0?S3(n,e):n}function A3(n,e){if(e&&C3(e)){if(n instanceof Gy)return R3(n,e);throw Sg("To use ref(service, url), the first argument must be a Storage instance.")}else return Ck(n,e)}function f2(n,e){const t=e?.[vk];return t==null?null:br.makeFromBucketSpec(t,n)}function I3(n,e,t,i={}){n.host=`${e}:${t}`;const l=fo(e);l&&(Vg(`https://${n.host}/b`),Bg("Storage",!0)),n._isUsingEmulator=!0,n._protocol=l?"https":"http";const{mockUserToken:u}=i;u&&(n._overrideAuthToken=typeof u=="string"?u:J2(u,n.app.options.projectId))}class Gy{constructor(e,t,i,l,u,d=!1){this.app=e,this._authProvider=t,this._appCheckProvider=i,this._url=l,this._firebaseVersion=u,this._isUsingEmulator=d,this._bucket=null,this._host=bk,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=xM,this._maxUploadRetryTime=wM,this._requests=new Set,l!=null?this._bucket=br.makeFromBucketSpec(l,this._host):this._bucket=f2(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=br.makeFromBucketSpec(this._url,e):this._bucket=f2(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){Cg("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){Cg("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(qr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Xo(this,e)}_makeRequest(e,t,i,l,u=!0){if(this._deleted)return new LM(xk());{const d=GM(e,this._appId,i,l,t,this._firebaseVersion,u,this._isUsingEmulator);return this._requests.add(d),d.getPromise().then(()=>this._requests.delete(d),()=>this._requests.delete(d)),d}}async makeRequestWithTokens(e,t){const[i,l]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,i,l).getPromise()}}const p2="@firebase/storage",g2="0.14.0";const Rk="storage";function Vp(n,e,t){return n=Ks(n),j3(n,e,t)}function y2(n){return n=Ks(n),T3(n)}function qo(n){return n=Ks(n),N3(n)}function eo(n,e){return n=Ks(n),A3(n,e)}function M3(n=qg(),e){n=Ks(n);const i=Qh(n,Rk).getImmediate({identifier:e}),l=Y2("storage");return l&&D3(i,...l),i}function D3(n,e,t,i={}){I3(n,e,t,i)}function P3(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),i=n.getProvider("auth-internal"),l=n.getProvider("app-check-internal");return new Gy(t,i,l,e,Jo)}function L3(){$o(new io(Rk,P3,"PUBLIC").setMultipleInstances(!0)),Pa(p2,g2,""),Pa(p2,g2,"esm2020")}L3();const Ak={apiKey:"AIzaSyBCIgMJd3By7qkWH27YiW9VooIBGE3bFLs",authDomain:"mind-core-fitness-client.firebaseapp.com",projectId:"mind-core-fitness-client",storageBucket:"mind-core-fitness-client.firebasestorage.app",messagingSenderId:"669343392406",appId:"1:669343392406:web:f5a35ee062387e7d6f58b7"},Ky=Fg(Ak),Do=Ow(Ky),fe=oM(Ky),to=M3(Ky),O3=Fg(Ak,"secondary"),SP=Ow(O3),V3="EYdciKDOi3UYBLk1u8hHams5tmO2",Ik=v.createContext();function Mr(){return v.useContext(Ik)}function B3({children:n}){const[e,t]=v.useState(null),[i,l]=v.useState(!1),[u,d]=v.useState(!1),[p,g]=v.useState(null),[y,w]=v.useState(!0);v.useEffect(()=>{let K=null;const oe=HC(Do,ye=>{if(t(ye),K&&(K(),K=null),ye)if(ye.uid===V3)l(!0),d(!1),g(null),w(!1);else{l(!1);const Pe=Ps($t(fe,"clients"),us("uid","==",ye.uid)),Ee=async()=>{const R=localStorage.getItem("mcf_clientId");if(R)try{const T=await Ns(We(fe,"clients",R));T.exists()&&(d(!0),g({id:T.id,...T.data()}))}catch(T){console.error("Direct client read failed:",T)}};K=gk(Pe,async R=>{if(R.empty)await Ee();else{const T=R.docs[0];d(!0),g({id:T.id,...T.data()});try{localStorage.setItem("mcf_clientId",T.id)}catch{}}w(!1)},async R=>{console.error("Error listening to client data:",R),await Ee(),w(!1)})}else l(!1),d(!1),g(null),w(!1)});return()=>{oe(),K&&K()}},[]);const se={currentUser:e,isAdmin:i,isClient:u,clientData:p,updateClientData:K=>{g(oe=>oe?{...oe,...K}:K)},resolveClient:async()=>{if(p)return p;const K=localStorage.getItem("mcf_clientId");if(K)try{const oe=await Ns(We(fe,"clients",K));if(oe.exists()){const ye={id:oe.id,...oe.data()};return d(!0),g(ye),ye}}catch(oe){console.error("resolveClient direct read failed:",oe)}if(e){const oe=Ps($t(fe,"clients"),us("uid","==",e.uid)),ye=await js(oe);if(!ye.empty){const Pe={id:ye.docs[0].id,...ye.docs[0].data()};return d(!0),g(Pe),Pe}}return null},login:async(K,oe,ye=!0)=>(await ex(Do,ye?ug:Qg),await zC(Do,K,oe)),signup:async(K,oe,ye)=>{await ex(Do,ug);const Pe=await UC(Do,oe.trim().toLowerCase(),ye),Ee=Pe.user,R=We($t(fe,"clients")),T={uid:Ee.uid,name:K.trim(),email:oe.trim().toLowerCase(),clientType:"core_buddy",coreBuddyAccess:!0,status:"active",tier:"free",subscriptionStatus:null,signupSource:"self_signup",createdAt:vt.now()};await Ss(R,T),d(!0),g({id:R.id,...T});try{localStorage.setItem("mcf_clientId",R.id)}catch{}return Pe},logout:()=>{try{localStorage.removeItem("mcf_clientId")}catch{}return $C(Do)},resetPassword:K=>BC(Do,K),loading:y};return r.jsx(Ik.Provider,{value:se,children:n})}const Mk=v.createContext();function ka(){return v.useContext(Mk)}function U3({children:n}){const[e,t]=v.useState(()=>{const g=localStorage.getItem("theme");return g?g==="dark":window.matchMedia("(prefers-color-scheme: dark)").matches}),[i,l]=v.useState(()=>localStorage.getItem("accent")||"red");v.useEffect(()=>{document.documentElement.setAttribute("data-theme",e?"dark":"light"),localStorage.setItem("theme",e?"dark":"light")},[e]),v.useEffect(()=>{localStorage.setItem("accent",i)},[i]);const p={isDark:e,toggleTheme:()=>{document.documentElement.setAttribute("data-theme-transitioning",""),t(!e),setTimeout(()=>{document.documentElement.removeAttribute("data-theme-transitioning")},350)},accent:i,setAccent:g=>l(g)};return r.jsx(Mk.Provider,{value:p,children:n})}const Dk=v.createContext();function vm(){return v.useContext(Dk)}const z3=["nutrition","consistency","personalBests","achievements","buddies","programmes","leaderboard"],F3=[5,10],q3=1;function H3({children:n}){const{clientData:e,loading:t}=Mr(),i=v.useMemo(()=>{const l=e?.tier||"free",u=e?.subscriptionStatus||null,d=e&&e.signupSource!=="self_signup",p=l==="premium"||!!d;function g(y){return p?!0:!z3.includes(y)}return{tier:l,subscriptionStatus:u,isPremium:p,canAccess:g,loading:t,FREE_RANDOMISER_DURATIONS:F3,FREE_RANDOMISER_WEEKLY_LIMIT:q3}},[e?.tier,e?.subscriptionStatus,e?.signupSource,t]);return r.jsx(Dk.Provider,{value:i,children:n})}function $3(n){if(n?.signupSource==="self_signup"&&!n?.onboardingComplete)return"/onboarding";const e=n?.clientType;return e==="core_buddy"?"/client/core-buddy":e==="circuit_vip"||e==="circuit_dropin"?"/client/circuit":"/client"}function W3({className:n=""}){const{isDark:e,toggleTheme:t}=ka();return r.jsx("button",{className:n||"theme-toggle",onClick:t,"aria-label":e?"Switch to light mode":"Switch to dark mode",children:e?r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20",children:r.jsx("path",{d:"M12 3a9 9 0 109 9c0-.46-.04-.92-.1-1.36a5.389 5.389 0 01-4.4 2.26 5.403 5.403 0 01-3.14-9.8c-.44-.06-.9-.1-1.36-.1z"})}):r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20",children:r.jsx("path",{d:"M12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zM2 13h2c.55 0 1-.45 1-1s-.45-1-1-1H2c-.55 0-1 .45-1 1s.45 1 1 1zm18 0h2c.55 0 1-.45 1-1s-.45-1-1-1h-2c-.55 0-1 .45-1 1s.45 1 1 1zM11 2v2c0 .55.45 1 1 1s1-.45 1-1V2c0-.55-.45-1-1-1s-1 .45-1 1zm0 18v2c0 .55.45 1 1 1s1-.45 1-1v-2c0-.55-.45-1-1-1s-1 .45-1 1zM5.99 4.58a.996.996 0 00-1.41 0 .996.996 0 000 1.41l1.06 1.06c.39.39 1.03.39 1.41 0s.39-1.03 0-1.41L5.99 4.58zm12.37 12.37a.996.996 0 00-1.41 0 .996.996 0 000 1.41l1.06 1.06c.39.39 1.03.39 1.41 0a.996.996 0 000-1.41l-1.06-1.06zm1.06-10.96a.996.996 0 000-1.41.996.996 0 00-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06zM7.05 18.36a.996.996 0 000-1.41.996.996 0 00-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06z"})})})}function G3(){const[n,e]=v.useState(""),[t,i]=v.useState(""),[l,u]=v.useState(!0),[d,p]=v.useState(""),[g,y]=v.useState(!1),[w,k]=v.useState(!1),[j,O]=v.useState(!1),{login:H,resetPassword:B,currentUser:V,isAdmin:se,isClient:K,clientData:oe,loading:ye}=Mr(),Pe=$n();if(v.useEffect(()=>{!ye&&V&&(se?Pe("/dashboard"):K?Pe($3(oe)):(y(!1),p("No account found. Please sign up or contact your trainer.")))},[ye,V,se,K,oe,Pe]),ye||V)return null;const Ee=async T=>{T.preventDefault(),p(""),y(!0);try{await H(n,t,l)}catch(A){p(A.message||"Failed to log in"),y(!1)}},R=async T=>{if(T.preventDefault(),p(""),!n.trim()){p("Please enter your email address");return}y(!0);try{await B(n.trim()),O(!0)}catch(A){A.code==="auth/user-not-found"?p("No account found with this email"):p(A.message||"Failed to send reset email")}y(!1)};return r.jsxs("div",{className:"login-container",children:[r.jsx(W3,{className:"login-theme-toggle"}),r.jsxs("div",{className:"login-card",children:[r.jsxs("div",{className:"login-header",children:[r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"login-logo"}),r.jsx("p",{children:r.jsx("strong",{children:w?"Reset Password":"Sign in as 1-2-1 or a Core Buddy"})})]}),d&&r.jsx("div",{className:"error-message",children:d}),j?r.jsxs("div",{className:"reset-sent",children:[r.jsx("div",{className:"reset-sent-icon",children:r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M22 2L11 13",strokeLinecap:"round",strokeLinejoin:"round"}),r.jsx("path",{d:"M22 2L15 22L11 13L2 9L22 2Z",strokeLinecap:"round",strokeLinejoin:"round"})]})}),r.jsx("p",{children:"Reset email sent!"}),r.jsx("span",{children:"Check your inbox for a password reset link"}),r.jsx("button",{className:"login-btn",style:{marginTop:"20px"},onClick:()=>{k(!1),O(!1),p("")},children:"Back to Log In"})]}):w?r.jsxs("form",{onSubmit:R,children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"email",children:"Email"}),r.jsx("input",{type:"email",id:"email",value:n,onChange:T=>e(T.target.value),placeholder:"Enter your email",required:!0})]}),r.jsx("button",{type:"submit",className:"login-btn",disabled:g,children:g?"Sending...":"Send Reset Link"}),r.jsx("button",{type:"button",className:"forgot-link",onClick:()=>{k(!1),p("")},children:"Back to Log In"})]}):r.jsxs(r.Fragment,{children:[r.jsxs("form",{onSubmit:Ee,children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"email",children:"Email"}),r.jsx("input",{type:"email",id:"email",value:n,onChange:T=>e(T.target.value),required:!0})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"password",children:"Password"}),r.jsx("input",{type:"password",id:"password",value:t,onChange:T=>i(T.target.value),required:!0})]}),r.jsx("div",{className:"remember-me",children:r.jsxs("label",{children:[r.jsx("input",{type:"checkbox",checked:l,onChange:T=>u(T.target.checked)}),r.jsx("span",{children:"Remember me"})]})}),r.jsx("button",{type:"submit",className:"login-btn",disabled:g,children:g?"Logging in...":"Log In"})]}),r.jsx("button",{type:"button",className:"forgot-link",onClick:()=>{k(!0),p("")},children:"Forgot password?"})]}),r.jsx("a",{href:"/",className:"back-link",children:"Back to website"})]})]})}function Ml({feature:n,children:e}){const{canAccess:t,loading:i}=vm(),l=$n();return i||t(n)?e:r.jsxs("div",{className:"locked-feature-wrap",children:[r.jsx("div",{className:"locked-feature-bg","aria-hidden":"true",children:e}),r.jsx("div",{className:"locked-feature-overlay",children:r.jsxs("div",{className:"locked-feature-card",children:[r.jsx("div",{className:"locked-icon",children:r.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),r.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]})}),r.jsx("h2",{children:"Premium Feature"}),r.jsx("p",{children:"Upgrade to Core Buddy Premium to unlock this feature and get full access to everything."}),r.jsx("button",{className:"locked-upgrade-btn",onClick:()=>l("/upgrade"),children:"Upgrade Now"})]})})]})}function aa({active:n}){const e=$n(),{clientData:t}=Mr(),{isPremium:i}=vm(),l=t?.clientType==="block"&&t?.coreBuddyAccess;return r.jsxs("nav",{className:"block-bottom-nav",children:[r.jsxs("button",{className:`block-nav-tab${n==="home"?" active":""}`,onClick:()=>e("/client/core-buddy"),children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),r.jsx("circle",{cx:"12",cy:"7",r:"4"})]}),r.jsx("span",{children:"Profile"})]}),r.jsxs("button",{className:`block-nav-tab${n==="workouts"?" active":""}`,onClick:()=>e("/client/core-buddy/workouts"),children:[r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"currentColor",stroke:"none",children:r.jsx("path",{d:"M1 9h2v6H1V9zm3-2h2v10H4V7zm3 4h10v2H7v-2zm10-4h2v10h-2V7zm3 2h2v6h-2V9z"})}),r.jsx("span",{children:"Workouts"})]}),r.jsxs("button",{className:`block-nav-tab${n==="nutrition"?" active":""}`,onClick:()=>e(i?"/client/core-buddy/nutrition":"/upgrade"),children:[r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M18 8h1a4 4 0 0 1 0 8h-1M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z"})}),r.jsx("span",{children:"Nutrition"})]}),r.jsxs("button",{className:`block-nav-tab${n==="buddies"?" active":""}`,onClick:()=>e(i?"/client/core-buddy/buddies":"/upgrade"),children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),r.jsx("circle",{cx:"9",cy:"7",r:"4"}),r.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),r.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),r.jsx("span",{children:"Buddies"})]}),l&&r.jsxs("button",{className:"block-nav-tab",onClick:()=>e("/client"),children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"3",width:"7",height:"7"}),r.jsx("rect",{x:"14",y:"3",width:"7",height:"7"}),r.jsx("rect",{x:"14",y:"14",width:"7",height:"7"}),r.jsx("rect",{x:"3",y:"14",width:"7",height:"7"})]}),r.jsx("span",{children:"Block"})]})]})}function xa({children:n,onRefresh:e}){const[t,i]=v.useState(0),[l,u]=v.useState(!1),d=v.useRef(null),p=v.useRef(0),g=v.useRef(!1),y=v.useCallback(j=>{window.scrollY<=0&&(p.current=j.touches[0].clientY,g.current=!0)},[]),w=v.useCallback(j=>{if(!g.current||l)return;const O=j.touches[0].clientY-p.current;O>20&&window.scrollY<=0&&(j.preventDefault(),i(Math.min((O-20)*.35,80)))},[l]),k=v.useCallback(async()=>{t>55&&!l&&(u(!0),e?await e():window.location.reload(),u(!1)),i(0),g.current=!1},[t,l,e]);return r.jsxs("div",{ref:d,onTouchStart:y,onTouchMove:w,onTouchEnd:k,children:[r.jsxs("div",{className:`pull-refresh-indicator ${t>0?"visible":""} ${l?"refreshing":""}`,style:{height:t},children:[r.jsx("div",{className:`refresh-spinner ${l?"spinning":""}`,children:r.jsx("svg",{viewBox:"0 0 24 24",width:"24",height:"24",children:r.jsx("path",{fill:"currentColor",d:"M17.65 6.35A7.958 7.958 0 0012 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08A5.99 5.99 0 0112 18c-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"})})}),r.jsx("span",{className:"refresh-text",children:l?"Refreshing...":"Pull to refresh"})]}),n]})}function Hu(n,e,t,i,l){const u=[];for(let d=0;d<n;d++){const p=(d*(360/n)-90)*(Math.PI/180);u.push({x1:e+i*Math.cos(p),y1:t+i*Math.sin(p),x2:e+l*Math.cos(p),y2:t+l*Math.sin(p),thick:d%5===0})}return u}const Yy=Hu(60,100,100,85,96),du=Hu(60,100,100,78,94),K3=Hu(60,100,100,82,94);Hu(60,50,50,38,46);const b2=Hu(60,40,40,30,37),Y3="/login/assets/first_workout-B8SFkzJX.PNG",Q3="/login/assets/workouts_10-Z5R3u0xH.PNG",X3="/login/assets/workouts_25-CzxSlcAj.PNG",J3="/login/assets/workouts_50-BpzWup3V.PNG",Z3="/login/assets/workouts_100-D7_r6tn1.PNG",eD="/login/assets/streak_2-CsRr-XA9.PNG",tD="/login/assets/streak_4-BHO09tbw.PNG",sD="/login/assets/streak_8-DX2UWMko.PNG",nD="/login/assets/first_pb-aVf_CNWy.PNG",rD="/login/assets/pbs_5-Cippawgg.PNG",aD="/login/assets/pbs_10-CZgGh9Kv.PNG",iD="/login/assets/pbs_100-C67b1wfS.PNG",oD="/login/assets/nutrition_7-CHVV11fj.PNG",lD="/login/assets/leaderboard_join-BLoId4Hz.PNG",cD="/login/assets/habits_7-Dvki70KO.PNG",hu=[{id:"first_workout",img:Y3,name:"First Rep",desc:"Complete your first workout",category:"workouts",threshold:1},{id:"workouts_10",img:Q3,name:"On Fire",desc:"Complete 10 workouts",category:"workouts",threshold:10},{id:"workouts_25",img:X3,name:"Dedicated",desc:"Complete 25 workouts",category:"workouts",threshold:25},{id:"workouts_50",img:J3,name:"Unstoppable",desc:"Complete 50 workouts",category:"workouts",threshold:50},{id:"workouts_100",img:Z3,name:"Century",desc:"Complete 100 workouts",category:"workouts",threshold:100},{id:"streak_2",img:eD,name:"2 Week Streak",desc:"Work out for 2 weeks in a row",category:"streaks",threshold:2},{id:"streak_4",img:tD,name:"Month Strong",desc:"Work out for 4 weeks in a row",category:"streaks",threshold:4},{id:"streak_8",img:sD,name:"Iron Will",desc:"Work out for 8 weeks in a row",category:"streaks",threshold:8},{id:"first_pb",img:nD,name:"First PB",desc:"Set your first personal best",category:"pbs",threshold:1},{id:"pbs_5",img:rD,name:"PB Hunter",desc:"Set 5 personal bests",category:"pbs",threshold:5},{id:"pbs_10",img:aD,name:"PB Machine",desc:"Set 10 personal bests",category:"pbs",threshold:10},{id:"pbs_100",img:iD,name:"PB Legend",desc:"Set 100 personal bests",category:"pbs",threshold:100},{id:"nutrition_7",img:oD,name:"Macro Master",desc:"Hit your macro targets 7 days in a row",category:"nutrition",threshold:7},{id:"leaderboard_join",img:lD,name:"Competitor",desc:"Join the leaderboard",category:"leaderboard",threshold:1},{id:"habits_7",img:cD,name:"Habit Streak",desc:"Complete your daily habits 7 days in a row",category:"habits",threshold:7}];function uD({steps:n,onFinish:e,active:t}){const[i,l]=v.useState(0),[u,d]=v.useState(null),[p,g]=v.useState("below"),[y,w]=v.useState(!1),k=v.useRef(null),j=v.useRef(t);j.current=t,v.useEffect(()=>{t||l(0)},[t]),v.useEffect(()=>{if(!t)return;const Pe=Ee=>Ee.preventDefault();return document.addEventListener("touchmove",Pe,{passive:!1}),document.addEventListener("wheel",Pe,{passive:!1}),document.body.style.overflow="hidden",()=>{document.removeEventListener("touchmove",Pe),document.removeEventListener("wheel",Pe),document.body.style.overflow=""}},[t]);const O=v.useMemo(()=>t?n.filter(Pe=>document.querySelector(Pe.selector)):[],[t]),H=O[i],B=i===O.length-1,V=H?.selector,se=v.useCallback(()=>{if(!V)return;const Pe=document.querySelector(V);if(!Pe){d(null);return}const Ee=Pe.getBoundingClientRect(),R=8;d({top:Ee.top-R,left:Ee.left-R,width:Ee.width+R*2,height:Ee.height+R*2});const T=window.innerHeight-Ee.bottom;g(T<260?"above":"below")},[V]);if(v.useEffect(()=>{if(!t||!V)return;w(!0);const Pe=document.querySelector(V);if(Pe){document.body.style.overflow="",Pe.scrollIntoView({behavior:"smooth",block:"center"});let Ee=null,R=0,T=0;const A=60,L=()=>{T++;const M=Pe.getBoundingClientRect(),Ge=Math.round(M.top);if(Ee!==null&&Ge===Ee?R++:R=0,Ee=Ge,R>=3||T>=A){j.current&&(document.body.style.overflow="hidden"),se(),w(!1);return}D=requestAnimationFrame(L)};let D;const z=setTimeout(()=>{D=requestAnimationFrame(L)},120);return()=>{clearTimeout(z),D&&cancelAnimationFrame(D),j.current&&(document.body.style.overflow="hidden")}}},[t,i,V,se]),v.useEffect(()=>{if(!t)return;const Pe=()=>{k.current&&cancelAnimationFrame(k.current),k.current=requestAnimationFrame(se)};return window.addEventListener("scroll",Pe,!0),window.addEventListener("resize",Pe),()=>{window.removeEventListener("scroll",Pe,!0),window.removeEventListener("resize",Pe),k.current&&cancelAnimationFrame(k.current)}},[t,se]),!t||!H||O.length===0)return null;const K=()=>{B?e():l(i+1)},oe=()=>{i>0&&l(i-1)},ye=()=>e();return r.jsxs("div",{className:"st-overlay",onClick:Pe=>{Pe.stopPropagation()},children:[r.jsx("div",{className:"st-backdrop",onClick:K}),u&&r.jsx("div",{className:`st-spotlight${y?" st-transitioning":""}`,style:{top:u.top,left:u.left,width:u.width,height:u.height}}),u&&r.jsxs("div",{className:`st-tooltip st-tooltip-${p}${y?" st-transitioning":""}`,style:{top:p==="below"?Math.min(Math.max(u.top+u.height+16,16),window.innerHeight-200):void 0,bottom:p==="above"?Math.min(Math.max(window.innerHeight-u.top+16,16),window.innerHeight-60):void 0,left:Math.max(16,Math.min(u.left,window.innerWidth-320))},children:[r.jsx("div",{className:"st-dots",children:O.map((Pe,Ee)=>r.jsx("span",{className:`st-dot${Ee===i?" active":""}${Ee<i?" done":""}`},Ee))}),r.jsx("h3",{className:"st-title",children:H.title}),r.jsx("p",{className:"st-body",children:H.body}),r.jsxs("div",{className:"st-actions",children:[i>0&&r.jsx("button",{className:"st-btn st-btn-back",onClick:oe,children:"Back"}),r.jsx("button",{className:"st-btn st-btn-next",onClick:K,children:H.cta||(B?"Let's Go!":"Next")})]}),r.jsx("button",{className:"st-skip",onClick:ye,children:"Skip tour"})]})]})}const Bp=[10,25,50,100,200,500,1e3],Wi=5;function Yc(n){return n.toISOString().split("T")[0]}function dD(n){let e=0;for(const t of Bp){if(n<t)return{prev:e,next:t};e=t}return{prev:Bp[Bp.length-1],next:n+100}}const hD={fullbody_4wk:{duration:4,daysPerWeek:3},fullbody_8wk:{duration:8,daysPerWeek:3},fullbody_12wk:{duration:12,daysPerWeek:3},core_4wk:{duration:4,daysPerWeek:3},core_8wk:{duration:8,daysPerWeek:3},core_12wk:{duration:12,daysPerWeek:3},upper_4wk:{duration:4,daysPerWeek:3},lower_4wk:{duration:4,daysPerWeek:3}},mD={fullbody_4wk:["Push Focus","Pull Focus","Legs & Core"],fullbody_8wk:["Strength","Power","Endurance"],fullbody_12wk:["Upper Push","Lower Body","Upper Pull"],core_4wk:["Abs","Stability","Power Core"],core_8wk:["Anti-Extension","Rotation","Power"],core_12wk:["Strength","Endurance","Power"],upper_4wk:["Push","Pull","Mixed"],lower_4wk:["Quad Dominant","Hamstring & Glute","Power & Stability"]},Up=[{text:"You have 24 hours a day...",bold:"make it count"},{text:"Discipline beats motivation...",bold:"every single time"},{text:"Rest when you're done,",bold:"not when you're tired"},{text:"Small daily gains...",bold:"create massive results"},{text:"Your body keeps score,",bold:"train it well"},{text:"Consistency over intensity...",bold:"always wins"},{text:"The only bad workout...",bold:"is the one you skipped"}];function zp(n){if(!n)return"";const e=n instanceof Date?n:n.toDate?n.toDate():new Date(n),t=Math.floor((new Date-e)/1e3);return t<60?"just now":t<3600?`${Math.floor(t/60)}m ago`:t<86400?`${Math.floor(t/3600)}h ago`:t<604800?`${Math.floor(t/86400)}d ago`:e.toLocaleDateString("en-GB",{day:"numeric",month:"short"})}function Qc(n){if(!n)return"?";const e=n.trim().split(/\s+/);return e.length===1?e[0][0].toUpperCase():(e[0][0]+e[e.length-1][0]).toUpperCase()}function fD(n,e=800){return new Promise(t=>{const i=new Image;i.onload=()=>{const l=document.createElement("canvas");let u=i.width,d=i.height;u>d?u>e&&(d=Math.round(d*e/u),u=e):d>e&&(u=Math.round(u*e/d),d=e),l.width=u,l.height=d,l.getContext("2d").drawImage(i,0,0,u,d),l.toBlob(p=>t(p),"image/jpeg",.8)},i.src=URL.createObjectURL(n)})}function pD(){const{currentUser:n,isClient:e,clientData:t,logout:i,updateClientData:l,loading:u}=Mr(),{isDark:d,toggleTheme:p}=ka(),{isPremium:g}=vm(),y=$n(),[w,k]=v.useState({hours:0,minutes:0,seconds:0}),[j,O]=v.useState(0),[H,B]=v.useState(0),[V,se]=v.useState(""),[K,oe]=v.useState(0),[ye,Pe]=v.useState(0),[Ee,R]=v.useState(!1),[T,A]=v.useState({protein:0,carbs:0,fats:0,calories:0}),[L,D]=v.useState(null),[z,M]=v.useState(0),[Ge,mt]=v.useState(null),[$,pe]=v.useState(!1),[Me,Qe]=v.useState(!1),[X,P]=v.useState(0),[re,Re]=v.useState(0),[Le,tt]=v.useState([]),[qe,ft]=v.useState([]),[kt,rt]=v.useState(null),[Wt,_s]=v.useState(!1),At=v.useRef(null),[pt,ue]=v.useState([]),[Zt,Ae]=v.useState(null),[Fe,Ze]=v.useState(null),Ke=v.useRef(null),[Xe,Ct]=v.useState(0),[zs,gt]=v.useState(0),[Ut,Bs]=v.useState(0),[qt,Cs]=v.useState(0),[is,Ts]=v.useState(null),ce=v.useCallback((I,ee="info")=>{Ts({message:I,type:ee}),setTimeout(()=>Ts(null),4e3)},[]),[Se,Be]=v.useState([]),[et,Ue]=v.useState(!1),[De,He]=v.useState(""),[wt,yt]=v.useState(null),[Mt,Yt]=v.useState(null),[J,be]=v.useState(!1),[it,Dt]=v.useState(new Set),[jt,ss]=v.useState(new Set),[Qt,zt]=v.useState({}),[Rs,Zs]=v.useState({}),[ds,Es]=v.useState({}),[Ls,F]=v.useState({}),[ve,we]=v.useState({}),[_e,ge]=v.useState({}),at=v.useRef(null),Rt=v.useRef(null),lt=v.useRef({}),[bt,Tt]=v.useState([]),[os,Bn]=v.useState(!1),fn=v.useRef(null),[_n,Ys]=v.useState([]),[G,he]=v.useState(""),[E,S]=v.useState(!1),[q,Z]=v.useState(null),[$e,Oe]=v.useState([]),[Ve,It]=v.useState(null),[Et,hs]=v.useState(!1),an=v.useRef(!1),Hs=(()=>{const I=[{selector:".cb-ring-container",title:"Your 24-Hour Countdown",body:"Every day resets. This ring tracks the time you have left  tap your photo to personalise your profile.",cta:"Next"},{selector:".cb-stats-row",title:"Progress at a Glance",body:"Programme completion, workouts this week, and daily habits  all in one row. These fill up as you go."},{selector:".cb-nudge-card",title:"Smart Suggestions",body:"We'll highlight what needs your attention  your next session, unfinished habits, or a meal to log."},{selector:".cb-card-workouts-hero",title:"Workouts",body:"Quick randomiser sessions or structured programmes  pick your focus, level and time.",cta:"Next"}];return g&&I.push({selector:".cb-card-nutrition",title:"Nutrition Tracking",body:"Set your macro targets, scan barcodes, and log meals to hit your daily goals."},{selector:".cb-card-consistency",title:"Daily Habits",body:"5 simple habits each day  train, hit protein, 10k steps, sleep, and hydrate. Build your streak."},{selector:".cb-card-buddies",title:"Buddies & Social",body:"Connect with other members, share your journey, and keep each other accountable."},{selector:".cb-journey-section",title:"Share Your Journey",body:"Post photos, updates, and milestones  your fitness journey in one place. Like and comment on each other's posts."},{selector:".cb-achievements-section",title:"Achievements",body:"Every rep counts towards badges  volume milestones, workout streaks, and more to unlock."}),I.push({selector:".block-bottom-nav",title:"You're All Set!",body:"Use the nav bar to jump between your profile, workouts, nutrition, and buddies. Time to get after it.",cta:"Let's Go!"}),I})();v.useEffect(()=>{!u&&!n&&y("/")},[u,n,y]),v.useEffect(()=>{!u&&t&&t.signupSource==="self_signup"&&!t.onboardingComplete&&y("/onboarding")},[u,t,y]),v.useEffect(()=>{let I=t?.tourComplete||an.current;if(!I&&t?.id)try{I=!!localStorage.getItem(`tourDone_${t.id}`)}catch{}if(Ee&&t&&!I){const ee=setTimeout(()=>hs(!0),600);return()=>clearTimeout(ee)}},[Ee,t]),v.useEffect(()=>{if(t)try{const I=sessionStorage.getItem(`cbDash_${t.id}`);if(I){const ee=JSON.parse(I);B(ee.programmePct??0),se(ee.programmeName??""),oe(ee.totalWorkouts??0),Pe(ee.habitWeekPct??0),A(ee.nutritionTotals??{protein:0,carbs:0,fats:0,calories:0}),D(ee.nutritionTargetData??null),M(ee.todayHabitsCount??0),mt(ee.nextSession??null),pe(ee.hasProgramme??!1),Qe(ee.programmeComplete??!1),P(ee.weeklyWorkouts??0),Re(ee.pbCount??0),tt(ee.topPBs??[]),ft(ee.leaderboardTop3??[]),ue(ee.unlockedBadges??[]),Ke.current=ee.unlockedBadges??[],Ct(ee.streakWeeks??0),R(!0)}}catch{}},[t]),v.useEffect(()=>{t?.photoURL&&rt(t.photoURL)},[t]),v.useEffect(()=>{if(!t)return;const I=Ps($t(fe,"notifications"),us("toId","==",t.id)),ee=gk(I,je=>{const st=je.docs.map(_t=>({id:_t.id,..._t.data()}));st.sort((_t,Ot)=>{const ot=_t.createdAt?.toMillis?.()||0;return(Ot.createdAt?.toMillis?.()||0)-ot}),Tt(st.slice(0,50))},je=>{console.error("Notification listener error:",je),je.code==="permission-denied"&&console.warn("Firestore rules may be missing for the notifications collection. Please update your Firestore rules in the Firebase Console.")});return()=>ee()},[t]),v.useEffect(()=>{const I=ee=>{fn.current&&!fn.current.contains(ee.target)&&Bn(!1)};return document.addEventListener("mousedown",I),()=>document.removeEventListener("mousedown",I)},[]),v.useEffect(()=>{if(!t)return;const I=t.id;(async()=>{try{const[ee,je,st]=await Promise.all([js(Ps($t(fe,"buddies"),us("user1","==",I))),js(Ps($t(fe,"buddies"),us("user2","==",I))),js($t(fe,"clients"))]),_t=new Set;[...ee.docs,...je.docs].forEach(ot=>{const Ft=ot.data();_t.add(Ft.user1===I?Ft.user2:Ft.user1)});const Ot={};st.docs.forEach(ot=>{Ot[ot.id]=ot.data()}),Ys(Array.from(_t).filter(ot=>Ot[ot]).map(ot=>({id:ot,name:Ot[ot].name,photoURL:Ot[ot].photoURL||null})))}catch(ee){console.error("Error loading buddies for mentions:",ee)}})()},[t]);const As=bt.filter(I=>!I.read).length,Is=async()=>{const I=bt.filter(je=>!je.read);if(!I.length)return;const ee=u2(fe);I.forEach(je=>ee.update(We(fe,"notifications",je.id),{read:!0})),await ee.commit()},Y=async()=>{if(!bt.length)return;const I=u2(fe);bt.forEach(ee=>I.delete(We(fe,"notifications",ee.id))),await I.commit()},xe=async(I,ee,je={})=>{if(!(!t||I===t.id))try{await hi($t(fe,"notifications"),{toId:I,fromId:t.id,fromName:t.name||"Someone",fromPhotoURL:t.photoURL||null,type:ee,read:!1,createdAt:Hr(),...je})}catch(st){console.error("Notification create error:",st),st.code==="permission-denied"&&ce("Notifications blocked  check Firestore rules","error")}},te=(I,ee)=>{const je=ee==="compose"?at.current?.selectionStart:null,_t=(je!=null?I.slice(0,je):I).match(/@(\w*)$/);if(_t){S(!0),Z(ee),he(_t[1].toLowerCase());const Ot=_n.filter(ot=>ot.name&&ot.name.toLowerCase().includes(_t[1].toLowerCase())).slice(0,5);Oe(Ot)}else S(!1),Oe([])},ze=(I,ee)=>{if(ee==="compose"){const je=at.current,st=De,_t=je?.selectionStart??st.length,Ot=st.slice(0,_t),ot=st.slice(_t),Ft=Ot.replace(/@\w*$/,`@${I.name} `);He(Ft+ot),setTimeout(()=>{je?.focus(),je.selectionStart=je.selectionEnd=Ft.length},0)}else{const st=(Rs[ee]||"").replace(/@\w*$/,`@${I.name} `);Zs(_t=>({..._t,[ee]:st}))}S(!1),Oe([])},Ye=I=>I&&I.split(/(@\w[\w\s]*?\s)/g).map((je,st)=>je.startsWith("@")&&_n.some(_t=>je.trim()===`@${_t.name}`)?r.jsx("span",{className:"mention-highlight",children:je.trim()},st):je),ct=async I=>{const ee=I.target.files?.[0];if(!(!ee||!t)){if(!ee.type.startsWith("image/")){ce("Please select an image file","error");return}if(ee.size>5*1024*1024){ce("Image must be under 5MB","error");return}_s(!0);try{const je=await new Promise(Ot=>{const ot=new Image;ot.onload=()=>{const Ft=document.createElement("canvas"),Gt=400;let rs=ot.width,Ht=ot.height;rs>Ht?(Ht=Ht/rs*Gt,rs=Gt):(rs=rs/Ht*Gt,Ht=Gt),Ft.width=rs,Ft.height=Ht,Ft.getContext("2d").drawImage(ot,0,0,rs,Ht),Ft.toBlob(xs=>Ot(xs),"image/jpeg",.75)},ot.src=URL.createObjectURL(ee)}),st=eo(to,`profilePhotos/${t.id}`);await Vp(st,je);const _t=await qo(st);await Ma(We(fe,"clients",t.id),{photoURL:_t}),rt(_t),l({photoURL:_t}),ce("Profile photo updated!","success")}catch(je){console.error("Photo upload error:",je),ce("Failed to upload photo","error")}_s(!1),At.current&&(At.current.value="")}};v.useEffect(()=>{const I=()=>{const je=new Date,st=new Date(je);st.setHours(23,59,59,999);const _t=st-je,Ot=Math.floor(_t/(1e3*60*60)),ot=Math.floor(_t%(1e3*60*60)/(1e3*60)),Ft=Math.floor(_t%(1e3*60)/1e3);k({hours:Ot,minutes:ot,seconds:Ft}),O(60-Ft)};I();const ee=setInterval(I,1e3);return()=>clearInterval(ee)},[]),v.useEffect(()=>{const I=setInterval(()=>{Cs(ee=>(ee+1)%Up.length)},8e3);return()=>clearInterval(I)},[]),v.useEffect(()=>{if(!n||!t)return;(async()=>{let ee=null,je=0,st=[],_t=!1,Ot=null;try{const ot=Yc(new Date),Ft=await Ns(We(fe,"clientProgrammes",t.id));if(Ft.exists()){const rr=Ft.data(),gn=hD[rr.templateId];if(pe(!0),gn){const hr=rr.completedSessions||{},Tr=Object.keys(hr).length,Ha=gn.duration*gn.daysPerWeek;B(Ha>0?Math.round(Tr/Ha*100):0);const tl=rr.templateId.replace(/_/g," ").replace(/\b\w/g,ia=>ia.toUpperCase());se(tl);const sl=mD[rr.templateId];let mr=!1;for(let ia=1;ia<=gn.duration&&!mr;ia++)for(let oa=0;oa<gn.daysPerWeek&&!mr;oa++)hr[`w${ia}d${oa}`]||(mt({week:ia,dayIdx:oa,label:sl?.[oa]||`Day ${oa+1}`}),mr=!0);mr||(Qe(!0),_t=!0)}}const Gt=$t(fe,"workoutLogs"),rs=Ps(Gt,us("clientId","==",t.id));ee=await js(rs),oe(ee.docs.length);const Ht=new Date,xs=Ht.getDay(),zn=xs===0?6:xs-1,ur=new Date(Ht);ur.setDate(Ht.getDate()-zn),ur.setHours(0,0,0,0);const en=ur.getTime(),Qs=ee.docs.filter(rr=>{const gn=rr.data().completedAt;return gn?(gn.toDate?gn.toDate().getTime():new Date(gn).getTime())>=en:!1}).length;P(Qs);const Fn=$t(fe,"habitLogs"),hn=Ps(Fn,us("clientId","==",t.id),us("date","==",ot)),Ln=await js(hn);let nr=0;if(!Ln.empty){const rr=Ln.docs[0].data().habits||{};nr=Object.values(rr).filter(Boolean).length}Pe(Math.round(nr/Wi*100)),M(nr);const Kn=await Ns(We(fe,"nutritionTargets",t.id));Kn.exists()&&(D(Kn.data()),Ot=Kn.data());const dr=await Ns(We(fe,"nutritionLogs",`${t.id}_${ot}`));if(dr.exists()){const gn=(dr.data().entries||[]).reduce((hr,Tr)=>({protein:hr.protein+(Tr.protein||0),carbs:hr.carbs+(Tr.carbs||0),fats:hr.fats+(Tr.fats||0),calories:hr.calories+(Tr.calories||0)}),{protein:0,carbs:0,fats:0,calories:0});A(gn)}}catch(ot){console.error("Error loading dashboard stats:",ot)}try{let ot=[];const Ft=await Ns(We(fe,"coreBuddyPBs",t.id));if(Ft.exists()){const Gt=Ft.data().exercises||{};Re(Object.keys(Gt).length),je=Object.keys(Gt).length,ot=Object.entries(Gt).sort(([,rs],[,Ht])=>(Ht.weight||0)-(rs.weight||0)).slice(0,3).map(([rs,Ht])=>({name:rs,weight:Ht.weight,reps:Ht.reps}))}st=ot,tt(ot)}catch(ot){console.error("PB fetch error:",ot)}try{const ot=$t(fe,"clients"),Ft=Ps(ot,us("leaderboardOptIn","==",!0)),rs=(await js(Ft)).docs.map(Ht=>({id:Ht.id,name:Ht.data().name,photoURL:Ht.data().photoURL||null}));ft(rs.slice(0,3))}catch(ot){console.error("Leaderboard preview error:",ot)}try{let ot=0;if(ee){const en=ee.docs.map(Qs=>Qs.data().date).filter(Boolean).sort().reverse();if(en.length>0){const Qs=new Date;let Fn=new Date(Qs);e:for(let hn=0;hn<52;hn++){const Ln=new Date(Fn),nr=Ln.getDay(),Kn=nr===0?6:nr-1;Ln.setDate(Ln.getDate()-Kn),Ln.setHours(0,0,0,0);const dr=new Date(Ln);dr.setDate(dr.getDate()+7);const rr=Yc(Ln),gn=Yc(dr);if(en.some(Tr=>Tr>=rr&&Tr<gn))ot++;else{if(hn>0)break e;break}Fn.setDate(Fn.getDate()-7)}}}Ct(ot);let Ft=0;for(let en=0;en<30;en++){const Qs=new Date;Qs.setDate(Qs.getDate()-en);const Fn=Yc(Qs);try{const hn=await js(Ps($t(fe,"habitLogs"),us("clientId","==",t.id),us("date","==",Fn)));if(hn.empty)break;{const Ln=hn.docs[0].data().habits||{};if(Object.values(Ln).filter(Boolean).length>=Wi)Ft++;else break}}catch{break}}gt(Ft);let Gt=0;for(let en=0;en<30;en++){const Qs=new Date;Qs.setDate(Qs.getDate()-en);const Fn=Yc(Qs);try{const hn=await Ns(We(fe,"nutritionLogs",`${t.id}_${Fn}`));if(hn.exists()&&(hn.data().entries||[]).length>0)if(Ot){const nr=(hn.data().entries||[]).reduce((Kn,dr)=>({protein:Kn.protein+(dr.protein||0),carbs:Kn.carbs+(dr.carbs||0),fats:Kn.fats+(dr.fats||0)}),{protein:0,carbs:0,fats:0});if(nr.protein>=(Ot.protein||0)&&nr.carbs>=(Ot.carbs||0)&&nr.fats>=(Ot.fats||0))Gt++;else break}else Gt++;else break}catch{break}}Bs(Gt);const rs=ee?ee.docs.length:0,Ht=[],xs=en=>Ht.push(en);rs>=1&&xs("first_workout"),rs>=10&&xs("workouts_10"),rs>=25&&xs("workouts_25"),rs>=50&&xs("workouts_50"),rs>=100&&xs("workouts_100"),ot>=2&&xs("streak_2"),ot>=4&&xs("streak_4"),ot>=8&&xs("streak_8"),je>=1&&xs("first_pb"),je>=5&&xs("pbs_5"),je>=10&&xs("pbs_10"),je>=100&&xs("pbs_100"),Gt>=7&&xs("nutrition_7"),t.leaderboardOptIn&&xs("leaderboard_join"),Ft>=7&&xs("habits_7"),ue(Ht);const zn=Ke.current;if(zn!==null){const en=Ht.filter(Qs=>!zn.includes(Qs));if(en.length>0){const Qs=hu.find(Fn=>Fn.id===en[en.length-1]);Qs&&setTimeout(()=>Ze(Qs),600)}}Ke.current=Ht;const ur={};Ht.forEach(en=>{ur[en]={unlockedAt:new Date().toISOString()}}),Ss(We(fe,"achievements",t.id),{badges:ur,progress:{streakWeeks:ot,pbCount:je,nutritionStreak:Gt,habitStreak:Ft},updatedAt:new Date().toISOString()},{merge:!0}).catch(()=>{})}catch(ot){console.error("Achievement computation error:",ot)}R(!0)})()},[n,t]),v.useEffect(()=>{if(!(!Ee||!t))try{sessionStorage.setItem(`cbDash_${t.id}`,JSON.stringify({programmePct:H,programmeName:V,totalWorkouts:K,habitWeekPct:ye,nutritionTotals:T,nutritionTargetData:L,todayHabitsCount:z,nextSession:Ge,hasProgramme:$,programmeComplete:Me,weeklyWorkouts:X,pbCount:re,topPBs:Le,leaderboardTop3:qe,unlockedBadges:pt,streakWeeks:Xe}))}catch{}},[Ee,H,V,K,ye,T,L,z,Ge,$,Me,X,re,Le,qe,pt,Xe,t]);const xt=v.useCallback(async()=>{if(an.current=!0,hs(!1),l({tourComplete:!0}),t?.id){try{localStorage.setItem(`tourDone_${t.id}`,"1")}catch{}try{await Ma(We(fe,"clients",t.id),{tourComplete:!0})}catch(I){console.error("Failed to save tour completion:",I)}}},[t,l]),Lt=I=>{const ee=I.currentTarget,je=ee.querySelector(".ripple");je&&je.remove();const st=ee.getBoundingClientRect(),_t=Math.max(st.width,st.height),Ot=I.clientX-st.left-_t/2,ot=I.clientY-st.top-_t/2,Ft=document.createElement("span");Ft.className="ripple",Ft.style.cssText=`width:${_t}px;height:${_t}px;left:${Ot}px;top:${ot}px;`,ee.appendChild(Ft),setTimeout(()=>Ft.remove(),600)},vs=t?.name?.split(" ")[0]||"there",{prev:un,next:ms}=dD(K),Wn=ms>un?Math.round((K-un)/(ms-un)*100):100,Gr=[{label:"Programme",value:`${H}%`,pct:H,color:"#14b8a6",size:"normal"},{label:"Workouts",value:`${K}`,pct:Wn,color:"var(--color-primary)",size:"large"},{label:"Habits Today",value:`${ye}%`,pct:ye,color:"#38B6FF",size:"normal"}],pn=I=>!L||!L[I]?0:Math.min(Math.round(T[I]/L[I]*100),100),ja=(()=>{const I=new Date().getHours();return Ee&&z>=Wi&&T.calories>0?{main:"Smashed it today,",sub:"Rest up and go again tomorrow."}:I>=5&&I<12?{main:"Rise and grind,",sub:"let's get after it!"}:I>=12&&I<17?{main:"Oye",sub:"crack on and make it count!"}:I>=17&&I<21?{main:"Evening session?",sub:"Let's finish strong!"}:{main:"Burning the midnight oil,",sub:"Respect the hustle!"}})(),Un=Ee?$&&Ge&&!Me?{label:"NEXT SESSION",message:`Week ${Ge.week}, Day ${Ge.dayIdx+1}  ${Ge.label}`,cta:"Continue",action:()=>y("/client/core-buddy/programmes"),pct:H,ringLabel:`${H}%`}:z<Wi?{label:"DAILY HABITS",message:`${z}/${Wi} completed`,cta:"Open Habits",action:()=>y("/client/core-buddy/consistency"),pct:ye,ringLabel:`${z}/${Wi}`}:T.calories===0?{label:"NUTRITION",message:"No meals logged today",cta:"Log Meal",action:()=>y("/client/core-buddy/nutrition"),pct:0,ringLabel:"0"}:$?Me?{label:"COMPLETE",message:"Programme finished!",cta:"New Programme",action:()=>y("/client/core-buddy/workouts"),pct:100,ringLabel:"100%"}:{label:"TODAY",message:"You're crushing it!",cta:null,action:null,pct:100,ringLabel:""}:{label:"PROGRAMMES",message:"Start a programme to level up",cta:"Browse",action:()=>y("/client/core-buddy/workouts"),pct:0,ringLabel:""}:null,as=v.useCallback(async()=>{if(t){Ue(!0);try{const I=await js(Ps($t(fe,"posts"),us("authorId","==",t.id),$h("createdAt","desc"),Wh(30)));Be(I.docs.map(je=>({id:je.id,...je.data()})));const ee=await js(Ps($t(fe,"postLikes"),us("userId","==",t.id)));Dt(new Set(ee.docs.map(je=>je.data().postId)))}catch(I){console.error("Error loading journey:",I)}finally{Ue(!1)}}},[t]);v.useEffect(()=>{Ee&&t&&as()},[Ee,t,as]);const dn=I=>{const ee=I.target.files?.[0];if(ee){if(!ee.type.startsWith("image/")){ce("Please select an image file","error");return}if(ee.size>10*1024*1024){ce("Image must be under 10MB","error");return}yt(ee),Yt(URL.createObjectURL(ee))}},sr=()=>{yt(null),Mt&&URL.revokeObjectURL(Mt),Yt(null),Rt.current&&(Rt.current.value="")},Gn=async()=>{if(!(!De.trim()&&!wt||J||!t)){be(!0);try{let I=null;if(wt){const st=await fD(wt),_t=`${Date.now()}_${Math.random().toString(36).slice(2,8)}`,Ot=eo(to,`postImages/${t.id}/${_t}`);await Vp(Ot,st),I=await qo(Ot)}await hi($t(fe,"posts"),{authorId:t.id,authorName:t.name||"Unknown",authorPhotoURL:t.photoURL||null,content:De.trim(),type:I?"image":"text",imageURL:I||null,createdAt:Hr(),likeCount:0,commentCount:0});const je=De.trim().match(/@[\w\s]+?(?=\s@|\s*$|[.,!?])/g);if(je){const st=new Set;je.forEach(_t=>{const Ot=_t.slice(1).trim(),ot=_n.find(Ft=>Ft.name&&Ft.name.toLowerCase()===Ot.toLowerCase());ot&&!st.has(ot.id)&&(st.add(ot.id),xe(ot.id,"mention",{}))})}He(""),sr(),at.current&&(at.current.style.height="auto"),await as(),ce("Posted!","success")}catch(I){console.error("Error posting:",I),ce(I?.message||"Failed to post","error")}finally{be(!1)}}},_r=async I=>{if(window.confirm("Delete this post?"))try{await yr(We(fe,"posts",I)),Be(ee=>ee.filter(je=>je.id!==I)),ce("Post deleted","info")}catch(ee){console.error("Delete error:",ee),ce("Failed to delete","error")}},sn=async I=>{if(!t)return;const ee=t.id,je=`${I}_${ee}`,st=it.has(I),_t=new Set(it);st?_t.delete(I):_t.add(I),Dt(_t),Be(Ot=>Ot.map(ot=>ot.id===I?{...ot,likeCount:Math.max(0,(ot.likeCount||0)+(st?-1:1))}:ot));try{if(st)await yr(We(fe,"postLikes",je)),await Ma(We(fe,"posts",I),{likeCount:Bo(-1)});else{await Ss(We(fe,"postLikes",je),{postId:I,userId:ee,createdAt:Hr()}),await Ma(We(fe,"posts",I),{likeCount:Bo(1)});const Ot=Se.find(ot=>ot.id===I);Ot&&xe(Ot.authorId,"like",{postId:I})}}catch(Ot){console.error("Like error:",Ot),as()}},Pn=async I=>{try{const ee=await js(Ps($t(fe,"postComments"),us("postId","==",I),$h("createdAt","asc"),Wh(50)));zt(je=>({...je,[I]:ee.docs.map(st=>({id:st.id,...st.data()}))}))}catch(ee){console.error("Error loading comments:",ee)}},Nn=I=>{const ee=new Set(jt);ee.has(I)?ee.delete(I):(ee.add(I),Qt[I]||Pn(I)),ss(ee)},kr=async I=>{const ee=(Rs[I]||"").trim(),je=ve[I];if(!(!ee&&!je||!t)){Es(st=>({...st,[I]:!0}));try{let st=null;if(je){const Gt=eo(to,`comment-images/${Date.now()}_${je.name}`);await Vp(Gt,je),st=await qo(Gt)}const _t={postId:I,authorId:t.id,authorName:t.name||"Unknown",authorPhotoURL:t.photoURL||null,content:ee||"",createdAt:Hr()};st&&(_t.imageURL=st);const Ot=Ls[I];Ot&&(_t.replyToId=Ot.id,_t.replyToName=Ot.authorName),await hi($t(fe,"postComments"),_t),await Ma(We(fe,"posts",I),{commentCount:Bo(1)});const ot=Se.find(Gt=>Gt.id===I);ot&&xe(ot.authorId,"comment",{postId:I});const Ft=ee.match(/@[\w\s]+?(?=\s@|\s*$|[.,!?])/g);if(Ft){const Gt=new Set;Ft.forEach(rs=>{const Ht=rs.slice(1).trim(),xs=_n.find(zn=>zn.name&&zn.name.toLowerCase()===Ht.toLowerCase());xs&&!Gt.has(xs.id)&&(Gt.add(xs.id),xe(xs.id,"mention",{postId:I}))})}Zs(Gt=>({...Gt,[I]:""})),we(Gt=>({...Gt,[I]:null})),ge(Gt=>({...Gt,[I]:null})),F(Gt=>({...Gt,[I]:null})),lt.current[I]&&(lt.current[I].value=""),Be(Gt=>Gt.map(rs=>rs.id===I?{...rs,commentCount:(rs.commentCount||0)+1}:rs)),await Pn(I)}catch(st){console.error("Comment error:",st),ce("Failed to comment","error")}finally{Es(st=>({...st,[I]:!1}))}}},jr=async(I,ee)=>{try{await yr(We(fe,"postComments",ee)),await Ma(We(fe,"posts",I),{commentCount:Bo(-1)}),zt(je=>({...je,[I]:(je[I]||[]).filter(st=>st.id!==ee)})),Be(je=>je.map(st=>st.id===I?{...st,commentCount:Math.max((st.commentCount||1)-1,0)}:st))}catch(je){console.error("Delete comment error:",je),ce("Failed to delete comment","error")}},Dr=(I,ee)=>{const je=ee.target.files?.[0];if(!je)return;if(je.size>5*1024*1024){ce("Image must be under 5MB","error");return}we(_t=>({..._t,[I]:je}));const st=new FileReader;st.onload=_t=>ge(Ot=>({...Ot,[I]:_t.target.result})),st.readAsDataURL(je)},wi=I=>{we(ee=>({...ee,[I]:null})),ge(ee=>({...ee,[I]:null})),lt.current[I]&&(lt.current[I].value="")},Ta=I=>{He(I.target.value),I.target.style.height="auto",I.target.style.height=Math.min(I.target.scrollHeight,120)+"px",te(I.target.value,"compose")},Pr=(I,ee)=>{Zs(je=>({...je,[I]:ee})),te(ee,I)};return r.jsx(xa,{children:r.jsxs("div",{className:"cb-dashboard","data-theme":d?"dark":"light",children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsxs("div",{className:"header-notif-wrap",ref:fn,children:[r.jsxs("button",{className:"header-notif-btn",onClick:()=>{Bn(!os),os||Is()},"aria-label":"Notifications",children:[r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"}),r.jsx("path",{d:"M13.73 21a2 2 0 0 1-3.46 0"})]}),As>0&&r.jsx("span",{className:"header-notif-badge",children:As>9?"9+":As})]}),os&&r.jsxs("div",{className:"notif-panel",children:[r.jsxs("div",{className:"notif-panel-header",children:[r.jsx("span",{className:"notif-panel-title",children:"Notifications"}),bt.length>0&&r.jsx("button",{className:"notif-clear-btn",onClick:Y,children:"Clear all"})]}),r.jsx("div",{className:"notif-panel-list",children:bt.length===0?r.jsx("div",{className:"notif-empty",children:"No notifications yet"}):bt.map(I=>r.jsxs("div",{className:`notif-item${I.read?"":" unread"}`,onClick:()=>{if(Bn(!1),I.type==="buddy_request"||I.type==="buddy_accept")y("/client/core-buddy/buddies");else if((I.type==="like"||I.type==="comment")&&I.postId){if(!jt.has(I.postId)){const ee=new Set(jt);ee.add(I.postId),ss(ee),Qt[I.postId]||Pn(I.postId)}setTimeout(()=>{const ee=document.getElementById(`post-${I.postId}`);ee&&ee.scrollIntoView({behavior:"smooth",block:"center"})},150)}else I.type==="like"||I.type==="comment"?document.querySelector(".cb-journey-section")?.scrollIntoView({behavior:"smooth"}):I.type==="mention"&&y(`/client/core-buddy/profile/${I.fromId}`)},children:[r.jsx("div",{className:"notif-item-avatar",children:I.fromPhotoURL?r.jsx("img",{src:I.fromPhotoURL,alt:""}):r.jsx("span",{children:(I.fromName||"?")[0]})}),r.jsxs("div",{className:"notif-item-body",children:[r.jsxs("p",{className:"notif-item-text",children:[r.jsx("strong",{children:I.fromName})," ",I.type==="buddy_request"&&"sent you a buddy request",I.type==="buddy_accept"&&"accepted your buddy request",I.type==="like"&&"liked your post",I.type==="comment"&&"commented on your post",I.type==="mention"&&"mentioned you"]}),r.jsx("span",{className:"notif-item-time",children:zp(I.createdAt)})]})]},I.id))})]})]}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsxs("div",{className:"header-actions",children:[r.jsx("button",{onClick:p,"aria-label":"Toggle theme",children:d?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})}),r.jsx("button",{onClick:i,"aria-label":"Log out",children:r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),r.jsx("polyline",{points:"16 17 21 12 16 7"}),r.jsx("line",{x1:"21",y1:"12",x2:"9",y2:"12"})]})})]})]})}),r.jsxs("main",{className:"cb-main",children:[r.jsxs("div",{className:"cb-ring-container",children:[r.jsxs("div",{className:"cb-ring",children:[r.jsx("svg",{className:"cb-ring-svg",viewBox:"0 0 200 200",children:Yy.map((I,ee)=>{const je=ee<j;return r.jsx("line",{x1:I.x1,y1:I.y1,x2:I.x2,y2:I.y2,className:`ring-tick ${je?"elapsed":"remaining"}`,strokeWidth:I.thick?"3":"2"},ee)})}),r.jsxs("div",{className:"cb-ring-center",children:[r.jsxs("div",{className:"cb-ring-logo",onClick:()=>At.current?.click(),role:"button",tabIndex:0,"aria-label":"Change profile photo",children:[r.jsx("img",{src:kt||"/Logo.webp",alt:kt?"Profile":"Mind Core Fitness"}),r.jsx("div",{className:`cb-photo-overlay${Wt?" uploading":""}`,children:Wt?r.jsx("div",{className:"cb-photo-spinner"}):r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"#fff",strokeWidth:"2",children:[r.jsx("path",{d:"M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"}),r.jsx("circle",{cx:"12",cy:"13",r:"4"})]})}),r.jsx("input",{ref:At,type:"file",accept:"image/*",onChange:ct,style:{display:"none"}})]}),!kt&&!Wt&&r.jsx("div",{className:"cb-photo-badge",onClick:()=>At.current?.click(),children:r.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"#fff",strokeWidth:"2.5",children:[r.jsx("path",{d:"M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"}),r.jsx("circle",{cx:"12",cy:"13",r:"4"})]})})]})]}),r.jsxs("div",{className:"cb-ring-countdown",children:[r.jsx("span",{className:"cb-timer-digit",children:String(w.hours).padStart(2,"0")}),r.jsx("span",{className:"cb-timer-colon",children:":"}),r.jsx("span",{className:"cb-timer-digit",children:String(w.minutes).padStart(2,"0")}),r.jsx("span",{className:"cb-timer-colon",children:":"}),r.jsx("span",{className:"cb-timer-digit cb-timer-seconds",children:String(w.seconds).padStart(2,"0")})]}),r.jsx("span",{className:"cb-ring-label",children:"remaining today"}),r.jsxs("p",{className:"cb-ring-tagline",children:[Up[qt].text," ",r.jsx("strong",{children:Up[qt].bold})]},qt)]}),r.jsx("div",{className:"cb-stats-row",children:Gr.map(I=>{const ee=(I.size==="large",38),je=2*Math.PI*ee,st=je-I.pct/100*je;return r.jsxs("div",{className:`cb-stat-item${I.size==="large"?" cb-stat-large":""}`,children:[r.jsxs("div",{className:"cb-stat-ring",children:[r.jsxs("svg",{viewBox:"0 0 100 100",children:[r.jsx("circle",{className:"cb-stat-track",cx:"50",cy:"50",r:ee}),r.jsx("circle",{className:"cb-stat-fill",cx:"50",cy:"50",r:ee,style:{stroke:I.color},strokeDasharray:je,strokeDashoffset:st})]}),r.jsx("span",{className:"cb-stat-value",style:{color:I.color},children:I.value})]}),r.jsx("span",{className:"cb-stat-label",children:I.label})]},I.label)})}),r.jsxs("p",{className:"cb-coach-msg",children:[ja.main," ",r.jsx("strong",{children:vs}),"  ",ja.sub]}),Un&&r.jsxs("button",{className:"cb-nudge-card",onClick:Un.action||void 0,style:Un.action?void 0:{cursor:"default"},children:[r.jsxs("div",{className:"cb-nudge-ring",children:[r.jsxs("svg",{viewBox:"0 0 100 100",children:[r.jsx("circle",{className:"cb-nudge-ring-track",cx:"50",cy:"50",r:"38"}),r.jsx("circle",{className:"cb-nudge-ring-fill",cx:"50",cy:"50",r:"38",strokeDasharray:2*Math.PI*38,strokeDashoffset:2*Math.PI*38-Un.pct/100*2*Math.PI*38})]}),r.jsx("span",{className:"cb-nudge-ring-val",children:Un.ringLabel})]}),r.jsxs("div",{className:"cb-nudge-info",children:[r.jsx("span",{className:"cb-nudge-label",children:Un.label}),r.jsx("span",{className:"cb-nudge-title",children:Un.message}),Un.cta&&r.jsxs("span",{className:"cb-nudge-cta",children:[Un.cta," "]})]})]}),r.jsxs("div",{className:"cb-features",children:[t?.buddyEnabled&&r.jsxs("button",{className:"cb-feature-card cb-card-buddy ripple-btn",onClick:I=>{Lt(I),y("/client/core-buddy/buddy")},children:[r.jsx("div",{className:"cb-buddy-icon",children:r.jsxs("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M12 2a4 4 0 0 1 4 4v2a4 4 0 0 1-8 0V6a4 4 0 0 1 4-4z"}),r.jsx("path",{d:"M18 14c2 1 3 3 3 5v2H3v-2c0-2 1-4 3-5"}),r.jsx("circle",{cx:"9",cy:"7",r:"0.5",fill:"currentColor"}),r.jsx("circle",{cx:"15",cy:"7",r:"0.5",fill:"currentColor"}),r.jsx("path",{d:"M9.5 10a2.5 2.5 0 0 0 5 0"}),r.jsx("path",{d:"M7 13c1.5 1 3.5 1.5 5 1.5s3.5-.5 5-1.5"})]})}),r.jsxs("div",{className:"cb-card-content",children:[r.jsxs("h3",{children:["Buddy ",r.jsx("span",{className:"cb-buddy-badge",children:"AI"})]}),r.jsx("p",{className:"cb-card-desc",children:"Your AI training partner"})]}),r.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})]}),r.jsxs("button",{className:`cb-feature-card cb-card-nutrition cb-card-has-preview ripple-btn${g?"":" cb-card-locked"}`,onClick:I=>{Lt(I),y(g?"/client/core-buddy/nutrition":"/upgrade")},children:[r.jsxs("div",{className:"cb-card-top-row",children:[r.jsx("div",{className:"cb-card-content",children:r.jsxs("h3",{children:["Today's Nutrition ",!g&&r.jsx("span",{className:"cb-premium-badge",children:"PREMIUM"})]})}),r.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})]}),r.jsx("div",{className:"cb-card-preview-row",children:r.jsx("div",{className:"cb-mini-rings",children:[{label:"P",pct:pn("protein"),color:"#14b8a6"},{label:"C",pct:pn("carbs"),color:"var(--color-primary)"},{label:"F",pct:pn("fats"),color:"#eab308"},{label:"Cal",pct:pn("calories"),color:"#38B6FF"}].map(I=>{const je=2*Math.PI*38,st=je-I.pct/100*je;return r.jsxs("div",{className:"cb-mini-ring",children:[r.jsxs("svg",{viewBox:"0 0 100 100",children:[r.jsx("circle",{className:"cb-mini-track",cx:"50",cy:"50",r:38}),r.jsx("circle",{className:"cb-mini-fill",cx:"50",cy:"50",r:38,style:{stroke:I.color},strokeDasharray:je,strokeDashoffset:st})]}),r.jsx("span",{style:{color:I.color},children:I.label})]},I.label)})})}),r.jsx("p",{className:"cb-card-desc",children:"Track macros, scan barcodes, log water"})]}),r.jsxs("button",{className:"cb-feature-card cb-card-workouts-hero ripple-btn",onClick:I=>{Lt(I),y("/client/core-buddy/workouts")},children:[r.jsx("h3",{className:"cb-hero-title",children:"Workouts"}),r.jsxs("div",{className:"cb-hero-stats",children:[r.jsxs("span",{children:[X," this week"]}),r.jsx("span",{className:"cb-hero-dot",children:""}),r.jsxs("span",{children:[K," total"]})]}),r.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})]}),r.jsxs("div",{className:"cb-grid-row",children:[r.jsxs("button",{className:`cb-feature-card cb-grid-card cb-card-consistency ripple-btn${g?"":" cb-card-locked"}`,onClick:I=>{Lt(I),y(g?"/client/core-buddy/consistency":"/upgrade")},children:[r.jsxs("div",{className:"cb-card-content",children:[r.jsxs("h3",{children:["Habits ",!g&&r.jsx("span",{className:"cb-premium-badge",children:"PREMIUM"})]}),r.jsx("div",{className:"cb-habit-dots",children:Array.from({length:Wi},(I,ee)=>r.jsx("span",{className:`cb-habit-dot${ee<z?" done":""}`},ee))}),r.jsxs("span",{className:"cb-habit-dots-label",children:[z,"/",Wi," today"]})]}),r.jsx("svg",{className:"cb-card-arrow cb-grid-arrow",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})]}),r.jsxs("button",{className:`cb-feature-card cb-grid-card cb-card-progress ripple-btn${g?"":" cb-card-locked"}`,onClick:I=>{Lt(I),y(g?"/client/personal-bests?mode=corebuddy":"/upgrade")},children:[r.jsxs("div",{className:"cb-card-content",children:[r.jsxs("h3",{children:["PBs ",!g&&r.jsx("span",{className:"cb-premium-badge",children:"PREMIUM"})]}),Le.length>0?r.jsx("div",{className:"cb-pb-preview",children:Le.slice(0,2).map(I=>r.jsxs("div",{className:"cb-pb-entry",children:[r.jsx("span",{className:"cb-pb-name",children:I.name}),r.jsxs("span",{className:"cb-pb-value",children:[I.weight,"kg"]})]},I.name))}):r.jsxs("div",{className:"cb-progress-preview",children:[r.jsx("svg",{className:"cb-progress-icon",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M13 2L3 14h9l-1 8 10-12h-9l1-8z"})}),r.jsx("span",{children:"Start lifting!"})]})]}),r.jsx("svg",{className:"cb-card-arrow cb-grid-arrow",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})]})]}),r.jsxs("button",{className:`cb-feature-card cb-card-leaderboard ripple-btn${g?"":" cb-card-locked"}`,onClick:I=>{Lt(I),y(g?"/client/leaderboard":"/upgrade")},children:[r.jsxs("div",{className:"cb-card-content",children:[r.jsxs("h3",{children:["Leaderboard ",!g&&r.jsx("span",{className:"cb-premium-badge",children:"PREMIUM"})]}),qe.length>0?r.jsx("div",{className:"cb-lb-preview",children:qe.map((I,ee)=>{const je=["#FFD700","#A8B4C0","#CD7F32"][ee],st=I.name?I.name.split(" ").map(Ot=>Ot[0]).join("").slice(0,2).toUpperCase():"?",_t=I.id===t?.id;return r.jsxs("div",{className:`cb-lb-entry${_t?" cb-lb-me":""}`,children:[r.jsx("div",{className:"cb-lb-avatar",style:{borderColor:je},children:I.photoURL?r.jsx("img",{src:I.photoURL,alt:"",className:"cb-lb-avatar-img"}):r.jsx("span",{children:st})}),r.jsxs("span",{className:"cb-lb-rank",style:{color:je},children:["#",ee+1]})]},I.id)})}):r.jsx("p",{children:"Opt in to compete with your Core Buddies"})]}),r.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})]}),r.jsxs("button",{className:`cb-feature-card cb-card-buddies ripple-btn${g?"":" cb-card-locked"}`,onClick:I=>{Lt(I),y(g?"/client/core-buddy/buddies":"/upgrade")},children:[r.jsxs("div",{className:"cb-card-content",children:[r.jsxs("h3",{children:["Buddies ",!g&&r.jsx("span",{className:"cb-premium-badge",children:"PREMIUM"})]}),r.jsx("p",{children:"Connect with other members and track each other's progress"})]}),r.jsx("svg",{className:"cb-card-arrow",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})]}),r.jsxs("div",{className:`cb-achievements-section${g?"":" cb-card-locked"}`,children:[r.jsxs("h3",{className:"cb-achievements-title",children:["Achievements ",!g&&r.jsx("span",{className:"cb-premium-badge",children:"PREMIUM"})]}),g?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"cb-badges-scroll",children:hu.map(I=>{const ee=pt.includes(I.id);return r.jsx("button",{className:`cb-badge${ee?" unlocked":" locked"}`,onClick:()=>Ae(I),children:r.jsx("img",{src:I.img,alt:I.name,className:"cb-badge-img"})},I.id)})}),r.jsxs("p",{className:"cb-badges-count",children:[pt.length,"/",hu.length," unlocked"]})]}):r.jsxs("button",{className:"cb-upgrade-teaser",onClick:()=>y("/upgrade"),children:[r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),r.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}),r.jsx("span",{children:"Upgrade to unlock achievements"})]})]}),r.jsxs("div",{className:"cb-journey-section",children:[r.jsxs("h3",{className:"cb-journey-title",children:["My Journey ",!g&&r.jsx("span",{className:"cb-premium-badge",children:"PREMIUM"})]}),g?r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"journey-compose",children:[r.jsx("div",{className:"journey-compose-avatar",children:kt?r.jsx("img",{src:kt,alt:""}):r.jsx("span",{children:Qc(t?.name)})}),r.jsxs("div",{className:"journey-compose-body",style:{position:"relative"},children:[r.jsx("textarea",{ref:at,placeholder:"Share your progress... (use @ to mention)",value:De,onChange:Ta,rows:1,maxLength:500}),E&&q==="compose"&&$e.length>0&&r.jsx("div",{className:"mention-dropdown",children:$e.map(I=>r.jsxs("button",{className:"mention-option",onClick:()=>ze(I,"compose"),children:[r.jsx("div",{className:"mention-option-avatar",children:I.photoURL?r.jsx("img",{src:I.photoURL,alt:""}):r.jsx("span",{children:Qc(I.name)})}),r.jsx("span",{children:I.name})]},I.id))}),Mt&&r.jsxs("div",{className:"journey-image-preview",children:[r.jsx("img",{src:Mt,alt:"Preview"}),r.jsx("button",{className:"journey-image-remove",onClick:sr,"aria-label":"Remove image",children:r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",children:[r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})})]}),r.jsxs("div",{className:"journey-compose-actions",children:[r.jsx("button",{className:"journey-image-btn",onClick:()=>Rt.current?.click(),"aria-label":"Add image",children:r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),r.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),r.jsx("path",{d:"M21 15l-5-5L5 21"})]})}),r.jsx("input",{ref:Rt,type:"file",accept:"image/*",onChange:dn,hidden:!0}),(De.trim()||wt)&&r.jsx("button",{className:"journey-post-btn",onClick:Gn,disabled:J,children:J?r.jsx("div",{className:"journey-btn-spinner"}):"Post"})]})]})]}),et?r.jsx("div",{className:"journey-loading",children:r.jsx("div",{className:"cb-spinner"})}):Se.length===0?r.jsxs("div",{className:"journey-empty",children:[r.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),r.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),r.jsx("path",{d:"M21 15l-5-5L5 21"})]}),r.jsx("p",{children:"Start sharing your fitness journey!"})]}):r.jsx("div",{className:"journey-list",children:Se.map(I=>r.jsxs("div",{id:`post-${I.id}`,className:"journey-post",children:[r.jsxs("div",{className:"journey-post-header",children:[r.jsx("div",{className:"journey-post-avatar",children:I.authorPhotoURL?r.jsx("img",{src:I.authorPhotoURL,alt:""}):r.jsx("span",{children:Qc(I.authorName)})}),r.jsxs("div",{className:"journey-post-meta",children:[r.jsx("span",{className:"journey-post-name",children:I.authorName}),r.jsx("span",{className:"journey-post-time",children:zp(I.createdAt)})]}),r.jsx("button",{className:"journey-delete-btn",onClick:()=>_r(I.id),"aria-label":"Delete post",children:r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M3 6h18"}),r.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),r.jsx("path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]}),I.content&&r.jsx("p",{className:"journey-post-content",children:Ye(I.content)}),I.imageURL&&r.jsx("div",{className:"journey-post-image",children:r.jsx("img",{src:I.imageURL,alt:"Post",loading:"lazy"})}),r.jsxs("div",{className:"journey-post-actions",children:[r.jsxs("button",{className:`journey-action-btn${it.has(I.id)?" liked":""}`,onClick:()=>sn(I.id),children:[r.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:it.has(I.id)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})}),r.jsx("span",{children:I.likeCount||0})]}),r.jsxs("button",{className:`journey-action-btn${jt.has(I.id)?" active":""}`,onClick:()=>Nn(I.id),children:[r.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})}),r.jsx("span",{children:I.commentCount||0})]})]}),jt.has(I.id)&&r.jsxs("div",{className:"journey-comments",children:[Qt[I.id]?.length>0?Qt[I.id].map(ee=>r.jsxs("div",{className:"journey-comment",children:[r.jsx("div",{className:"journey-comment-avatar",children:ee.authorPhotoURL?r.jsx("img",{src:ee.authorPhotoURL,alt:""}):r.jsx("span",{children:Qc(ee.authorName)})}),r.jsxs("div",{className:"journey-comment-body",children:[r.jsxs("div",{className:"journey-comment-bubble",children:[r.jsx("span",{className:"journey-comment-name",children:ee.authorName}),ee.replyToName&&r.jsxs("span",{className:"journey-comment-reply-tag",children:[r.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("polyline",{points:"9 14 4 9 9 4"}),r.jsx("path",{d:"M20 20v-7a4 4 0 0 0-4-4H4"})]}),ee.replyToName]}),ee.content&&r.jsx("span",{className:"journey-comment-text",children:Ye(ee.content)}),ee.imageURL&&r.jsx("img",{className:"journey-comment-image",src:ee.imageURL,alt:"Comment",loading:"lazy"})]}),r.jsxs("div",{className:"journey-comment-actions-row",children:[r.jsx("span",{className:"journey-comment-time",children:zp(ee.createdAt)}),r.jsx("button",{className:"journey-comment-reply-btn",onClick:()=>F(je=>({...je,[I.id]:{id:ee.id,authorName:ee.authorName}})),children:"Reply"}),r.jsx("button",{className:"journey-comment-delete-btn",onClick:()=>jr(I.id,ee.id),"aria-label":"Delete comment",children:r.jsxs("svg",{width:"13",height:"13",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M3 6h18"}),r.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),r.jsx("path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]})]})]},ee.id)):r.jsx("p",{className:"journey-no-comments",children:"No comments yet"}),Ls[I.id]&&r.jsxs("div",{className:"journey-comment-replying",children:[r.jsxs("span",{children:["Replying to ",r.jsx("strong",{children:Ls[I.id].authorName})]}),r.jsx("button",{onClick:()=>F(ee=>({...ee,[I.id]:null})),"aria-label":"Cancel reply",children:r.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",children:[r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})})]}),_e[I.id]&&r.jsxs("div",{className:"journey-comment-img-preview",children:[r.jsx("img",{src:_e[I.id],alt:"Preview"}),r.jsx("button",{onClick:()=>wi(I.id),"aria-label":"Remove image",children:r.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",children:[r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})})]}),r.jsxs("div",{className:"journey-comment-input",style:{position:"relative"},children:[r.jsx("button",{className:"journey-comment-img-btn",onClick:()=>lt.current[I.id]?.click(),"aria-label":"Add image",children:r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),r.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),r.jsx("path",{d:"M21 15l-5-5L5 21"})]})}),r.jsx("input",{ref:ee=>{lt.current[I.id]=ee},type:"file",accept:"image/*",onChange:ee=>Dr(I.id,ee),hidden:!0}),r.jsx("input",{type:"text",placeholder:"Comment",value:Rs[I.id]||"",onChange:ee=>Pr(I.id,ee.target.value),onKeyDown:ee=>{ee.key==="Enter"&&kr(I.id)},maxLength:300}),E&&q===I.id&&$e.length>0&&r.jsx("div",{className:"mention-dropdown mention-dropdown-up",children:$e.map(ee=>r.jsxs("button",{className:"mention-option",onClick:()=>ze(ee,I.id),children:[r.jsx("div",{className:"mention-option-avatar",children:ee.photoURL?r.jsx("img",{src:ee.photoURL,alt:""}):r.jsx("span",{children:Qc(ee.name)})}),r.jsx("span",{children:ee.name})]},ee.id))}),r.jsx("button",{onClick:()=>kr(I.id),disabled:!(Rs[I.id]||"").trim()&&!ve[I.id]||ds[I.id],children:ds[I.id]?r.jsx("div",{className:"journey-btn-spinner-sm"}):r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"22",y1:"2",x2:"11",y2:"13"}),r.jsx("polygon",{points:"22 2 15 22 11 13 2 9 22 2"})]})})]})]})]},I.id))})]}):r.jsxs("button",{className:"cb-upgrade-teaser",onClick:()=>y("/upgrade"),children:[r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),r.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}),r.jsx("span",{children:"Upgrade to share your journey"})]})]})]})]}),Zt&&r.jsx("div",{className:"cb-badge-overlay",onClick:()=>Ae(null),children:r.jsxs("div",{className:"cb-badge-overlay-content",onClick:I=>I.stopPropagation(),children:[r.jsx("img",{src:Zt.img,alt:Zt.name,className:`cb-badge-overlay-img${pt.includes(Zt.id)?"":" cb-badge-overlay-img-locked"}`}),pt.includes(Zt.id)?r.jsx("span",{className:"cb-badge-status unlocked",children:"Unlocked"}):r.jsx("span",{className:"cb-badge-status locked",children:"Locked"}),r.jsx("button",{className:"cb-badge-overlay-close",onClick:()=>Ae(null),children:"Tap to close"})]})}),r.jsx(aa,{active:"home"}),is&&r.jsxs("div",{className:`toast-notification ${is.type}`,children:[is.type==="info"&&r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("line",{x1:"12",y1:"16",x2:"12",y2:"12"}),r.jsx("line",{x1:"12",y1:"8",x2:"12.01",y2:"8"})]}),is.message]}),r.jsx(uD,{steps:Hs,active:Et,onFinish:xt}),Fe&&r.jsxs("div",{className:"cb-celebration-overlay",onClick:()=>Ze(null),children:[r.jsx("div",{className:"cb-confetti-container",children:Array.from({length:30},(I,ee)=>r.jsx("span",{className:"cb-confetti-piece",style:{"--angle":`${Math.random()*360}deg`,"--distance":`${80+Math.random()*120}px`,"--delay":`${Math.random()*.3}s`,"--color":["#FFD700","#FF6B6B","#4ECDC4","#45B7D1","#F7DC6F","#BB8FCE","#FF8C42","#38B6FF"][ee%8],"--size":`${6+Math.random()*6}px`,"--drift":`${(Math.random()-.5)*60}px`}},ee))}),r.jsxs("div",{className:"cb-celebration-content",onClick:I=>I.stopPropagation(),children:[r.jsx("div",{className:"cb-celebration-glow"}),r.jsx("img",{src:Fe.img,alt:Fe.name,className:"cb-celebration-badge-img"}),r.jsx("h2",{className:"cb-celebration-title",children:"Badge Unlocked!"}),r.jsx("p",{className:"cb-celebration-name",children:Fe.name}),r.jsx("button",{className:"cb-celebration-dismiss",onClick:()=>Ze(null),children:"Tap to continue"})]})]})]})})}const Fp=new Map;function Gi(){return new Date().toISOString().split("T")[0]}const v2=[{key:"breakfast",label:"Breakfast"},{key:"lunch",label:"Lunch"},{key:"dinner",label:"Dinner"},{key:"snacks",label:"Snacks"}],gD={breakfast:r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M18 8h1a4 4 0 0 1 0 8h-1"}),r.jsx("path",{d:"M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z"}),r.jsx("line",{x1:"6",y1:"1",x2:"6",y2:"4"}),r.jsx("line",{x1:"10",y1:"1",x2:"10",y2:"4"}),r.jsx("line",{x1:"14",y1:"1",x2:"14",y2:"4"})]}),lunch:r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}),dinner:r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})}),snacks:r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})})};function yD(){const n=new Date().getHours();return n<11?"breakfast":n<14?"lunch":n<17?"snacks":"dinner"}function bD(){const{currentUser:n,isClient:e,clientData:t,loading:i}=Mr(),{isDark:l,toggleTheme:u,accent:d}=ka(),p=$n(),[g,y]=v.useState("loading"),[w,k]=v.useState(null),[j,O]=v.useState({gender:"male",age:"",weight:"",weightUnit:"kg",height:"",heightUnit:"cm",heightFeet:"",heightInches:"",dailyActivity:"sedentary",trainingFrequency:"moderate",goal:"maintain",deficitLevel:"moderate"}),[H,B]=v.useState(null),[V,se]=v.useState(Gi()),[K,oe]=v.useState({entries:[],water:0}),[ye,Pe]=v.useState({protein:0,carbs:0,fats:0,calories:0}),[Ee,R]=v.useState(!1),[T,A]=v.useState(!1),[L,D]=v.useState(()=>{const E=new Date;return{year:E.getFullYear(),month:E.getMonth()}}),[z,M]=v.useState(yD),[Ge,mt]=v.useState(null),[$,pe]=v.useState(null),[Me,Qe]=v.useState(!1),[X,P]=v.useState(null),[re,Re]=v.useState(""),[Le,tt]=v.useState(!1),[qe,ft]=v.useState(""),[kt,rt]=v.useState([]),[Wt,_s]=v.useState(!1),[At,pt]=v.useState({name:"",protein:"",carbs:"",fats:"",calories:"",serving:""}),[ue,Zt]=v.useState(null),[Ae,Fe]=v.useState("100"),[Ze,Ke]=v.useState(0),[Xe,Ct]=v.useState("weight"),[zs,gt]=v.useState(0),[Ut,Bs]=v.useState(null);v.useRef(null);const qt=v.useRef(!1),Cs=v.useRef(null),is=v.useRef(null),Ts=v.useRef(null),ce=v.useCallback((E,S="info")=>{Bs({message:E,type:S}),setTimeout(()=>Bs(null),3e3)},[]);v.useEffect(()=>{!i&&(!n||!e)&&p("/")},[n,e,i,p]),v.useEffect(()=>{if(!t?.id)return;(async()=>{try{const S=await Ns(We(fe,"nutritionTargets",t.id));S.exists()?(k(S.data()),y("dashboard")):y("setup")}catch(S){console.error("Error loading nutrition data:",S),y("setup")}})()},[t?.id]),v.useEffect(()=>{if(!t?.id)return;(async()=>{try{const S=await Ns(We(fe,"nutritionLogs",`${t.id}_${V}`));if(S.exists()){const q=S.data();oe({entries:q.entries||[],water:q.water||0})}else oe({entries:[],water:0})}catch(S){console.error("Error loading log:",S),oe({entries:[],water:0})}})()},[t?.id,V]),v.useEffect(()=>{const E=K.entries.reduce((S,q)=>({protein:S.protein+(q.protein||0),carbs:S.carbs+(q.carbs||0),fats:S.fats+(q.fats||0),calories:S.calories+(q.calories||0)}),{protein:0,carbs:0,fats:0,calories:0});Pe(E)},[K.entries]);const Se=async E=>{try{await Ss(We(fe,"nutritionLogs",`${t.id}_${V}`),{clientId:t.id,date:V,entries:E.entries,water:E.water,updatedAt:vt.now()})}catch(S){console.error("Error saving nutrition log:",S)}},Be=V===Gi(),et=(E,S)=>new Date(E,S+1,0).getDate(),Ue=(E,S)=>new Date(E,S,1).getDay(),De=["January","February","March","April","May","June","July","August","September","October","November","December"],He=["Su","Mo","Tu","We","Th","Fr","Sa"],wt=()=>{let E=parseFloat(j.weight);j.weightUnit==="lbs"&&(E*=.453592);let S;j.heightUnit==="cm"?S=parseFloat(j.height):S=(parseFloat(j.heightFeet)||0)*30.48+(parseFloat(j.heightInches)||0)*2.54;const q=parseInt(j.age);let Z=j.gender==="male"?10*E+6.25*S-5*q+5:10*E+6.25*S-5*q-161;const Oe=Z*{sedentary:1.2,light:1.3,moderate:1.4,active:1.5}[j.dailyActivity],Ve={low:100,moderate:200,high:300,daily:400},It=Math.round(Oe+Ve[j.trainingFrequency]);let Et=It,hs,an;switch(j.goal){case"lose":Et=It*(1-{light:.15,moderate:.2,harsh:.25}[j.deficitLevel]),hs=2.2,an=.3;break;case"build":Et=It*1.1,hs=2,an=.22;break;default:hs=1.8,an=.25}Et=Math.max(Et,j.gender==="male"?1400:1100);const Hs=Math.round(E*hs),As=Math.round(Et*an/9),Is=Math.max(0,Math.round((Et-Hs*4-As*9)/4));B({calories:Math.round(Et),protein:Hs,carbs:Is,fats:As,bmr:Math.round(Z),neat:Math.round(Oe),exerciseAdd:Ve[j.trainingFrequency],tdee:Math.round(It)})},yt=async()=>{if(H)try{const E={clientId:t.id,calories:H.calories,protein:H.protein,carbs:H.carbs,fats:H.fats,waterGoal:8,goal:j.goal,updatedAt:vt.now()};await Ss(We(fe,"nutritionTargets",t.id),E),k(E),y("dashboard"),ce("Macro targets saved!","success")}catch(E){console.error("Error saving targets:",E),ce("Failed to save targets. Please try again.","error")}},Mt=()=>{const E=j.weight&&parseFloat(j.weight)>0,S=j.age&&parseInt(j.age)>0,q=j.heightUnit==="cm"?j.height&&parseFloat(j.height)>0:j.heightFeet&&parseFloat(j.heightFeet)>0||j.heightInches&&parseFloat(j.heightInches)>0;return E&&S&&q},Yt="nut_favourite_foods",J=()=>{try{return JSON.parse(localStorage.getItem(Yt)||"[]")}catch{return[]}},be=E=>J().some(S=>S.name.toLowerCase()===(E||"").toLowerCase()),it=E=>{const S=J(),q=S.findIndex(Z=>Z.name.toLowerCase()===E.name.toLowerCase());q>=0?S.splice(q,1):S.unshift({name:E.name,protein:E.protein,carbs:E.carbs,fats:E.fats,calories:E.calories,serving:E.serving,per100g:E.per100g||null,servingUnit:E.servingUnit||"g",portion:E.portion||null}),localStorage.setItem(Yt,JSON.stringify(S)),gt(Z=>Z+1)},Dt=E=>{const S=[...K.entries,{...E,meal:z,id:Date.now(),addedAt:new Date().toISOString()}],q={...K,entries:S};oe(q),Se(q),pe(null),Zt(null),Fe("100"),Ke(0),Ct("weight"),pt({name:"",protein:"",carbs:"",fats:"",calories:"",serving:""}),ce("Food added!","success")},jt=E=>{const S=K.entries.filter(Z=>Z.id!==E),q={...K,entries:S};oe(q),Se(q)},ss=v.useRef(null),Qt=async()=>{Qe(!0);const E=document.querySelector("#barcode-reader");if(!E){Qe(!1),ce("Scanner container not found.","error");return}if(!ss.current)try{const q=await wr(()=>import("./quagga.min-BbicSfvA.js").then(Z=>Z.q),[]);ss.current=q.default}catch(q){console.error("Failed to load barcode scanner:",q),Qe(!1),ce("Could not load scanner.","error");return}const S=ss.current;S.init({inputStream:{type:"LiveStream",target:E,constraints:{facingMode:"environment",width:{min:640,ideal:1280,max:1920},height:{min:480,ideal:720,max:1080}}},locator:{patchSize:"medium",halfSample:!0},numOfWorkers:navigator.hardwareConcurrency||2,decoder:{readers:["ean_reader","ean_8_reader","upc_reader","upc_e_reader","code_128_reader","code_39_reader"]},locate:!0},q=>{if(q){console.error("Quagga init error:",q),Qe(!1),ce("Could not access camera. Check permissions.","error");return}S.start(),qt.current=!0}),S.onDetected(q=>{const Z=q.codeResult.decodedCodes?.filter(Oe=>Oe.error!==void 0)?.map(Oe=>Oe.error)||[];if((Z.length>0?Z.reduce((Oe,Ve)=>Oe+Ve,0)/Z.length:1)<.15){const Oe=q.codeResult.code;S.offDetected(),P(Oe)}})},zt=()=>{const E=ss.current;qt.current&&E&&(E.stop(),E.offDetected(),qt.current=!1),Qe(!1)},Rs=/\b(milk|semi.skimmed|skimmed|whole milk|oat milk|almond milk|soy milk|juice|smoothie|water|squash|cordial|cola|pepsi|fanta|lemonade|soda|beer|wine|cider|lager|spirit|whisky|vodka|rum|gin|brandy|cream|yoghurt drink|milkshake|coffee|tea|broth|stock|soup|sauce|ketchup|vinegar|oil|syrup|honey|custard|coconut water|kombucha|energy drink|protein shake)\b/i,Zs=E=>/ml|cl|\dl(?!b)|litre|liter|fl\s?oz/i.test((E||"").replace(/\s/g,"")),ds=E=>{if(!E)return{value:100,unit:"g"};const S=E.toLowerCase().replace(/\s/g,""),q=S.match(/([\d.]+)/),Z=q?parseFloat(q[1]):100;return Zs(E)?/cl/.test(S)?{value:Z*10,unit:"ml"}:/(?:^|\d)l(?!i)/.test(S)&&!/ml/.test(S)?{value:Z*1e3,unit:"ml"}:{value:Z,unit:"ml"}:{value:Z,unit:"g"}},Es=E=>{if(Zs(E.serving_size)||Zs(E.quantity))return"ml";const S=E.product_name||E.product_name_en||"";return Rs.test(S)?"ml":"g"},Ls=[{pattern:/\b(toast|bread|loaf|brioche|bagel|pitta|wrap|tortilla|crumpet|muffin|waffle|pancake)\b/i,label:"slice",weight:36},{pattern:/\begg\b/i,label:"egg",weight:60},{pattern:/\b(biscuit|cookie|digestive|hobnob|rich tea|oreo)\b/i,label:"biscuit",weight:13},{pattern:/\b(sausage|banger)\b/i,label:"sausage",weight:57},{pattern:/\b(rasher|bacon)\b/i,label:"rasher",weight:25},{pattern:/\b(rice cake)\b/i,label:"cake",weight:9},{pattern:/\b(cracker|ryvita)\b/i,label:"cracker",weight:10}],F=(E,S)=>{const q=E||"",Z=q.match(/\((\d+\.?\d*)\s*g\)/i),$e=q.match(/(?:^|per\s+)(\d*\s*[a-z][a-z\s]*?)(?:\s*\(|\s*-\s*|\s*$)/i);if(Z&&$e){const It=parseFloat(Z[1]);let Et=$e[1].replace(/^\d+\s*/,"").trim();if(Et&&It>0)return{label:Et,weight:It}}const Oe=q.match(/(\d+\.?\d*)\s*g\s*[\/=]\s*(\d*\s*[a-z][a-z\s]*)/i);if(Oe){const It=parseFloat(Oe[1]);let Et=Oe[2].replace(/^\d+\s*/,"").trim();if(Et&&It>0)return{label:Et,weight:It}}const Ve=S||"";for(const{pattern:It,label:Et,weight:hs}of Ls)if(It.test(Ve))return{label:Et,weight:hs};return null},ve=E=>{const S=E.nutriments||{},q=Es(E),Z=ds(E.serving_size),$e=q==="ml"?Z.unit==="ml"?Z.value:100:Z.value,Oe=E.product_name||E.product_name_en||"Unknown Product",Ve=F(E.serving_size,Oe);return{name:Oe,brand:E.brands||"",image:E.image_small_url||E.image_url||null,servingSize:E.serving_size||"100g",servingValue:$e,servingUnit:q,portion:Ve,protein:Math.round(S.proteins_100g||S.proteins||0),carbs:Math.round(S.carbohydrates_100g||S.carbohydrates||0),fats:Math.round(S.fat_100g||S.fat||0),calories:Math.round(S["energy-kcal_100g"]||S["energy-kcal"]||(S.energy_100g?S.energy_100g/4.184:0)),per100g:!0}},we=async E=>{tt(!0);try{const S=`https://world.openfoodfacts.org/api/v2/product/${E}?fields=product_name,product_name_en,brands,image_small_url,image_url,serving_size,quantity,nutriments`,q=await fetch(S);if(!q.ok)throw new Error(`HTTP ${q.status}`);const Z=await q.json();if(Z.status==="success"||Z.status===1||Z.product){const $e=ve(Z.product);$e.calories===0&&$e.protein===0&&$e.carbs===0?ce("Product found but no nutrition data available.","error"):(Zt($e),$e.portion?(Ke(1),Fe(String($e.portion.weight)),Ct("portion")):(Ke(0),Fe(String($e.servingValue||100)),Ct("weight")),Re(""))}else ce("Product not found. Try search or manual entry.","error")}catch(S){console.error("Barcode lookup error:",S),ce("Failed to look up product. Check your connection.","error")}tt(!1)},_e=(E,S,q)=>{const Z=E.toLowerCase().trim(),$e=S.toLowerCase().trim(),Oe=q.toLowerCase().trim();let Ve=0;return(Z===Oe||Z===Oe+"s"||Z+"s"===Oe)&&(Ve+=100),(Z.endsWith(" "+Oe)||Z.endsWith(" "+Oe+"s"))&&(Ve+=40),(Z.startsWith(Oe+" ")||Z.startsWith(Oe+"s "))&&(Ve+=15),Oe.split(/\s+/).some(Et=>$e===Et||$e.startsWith(Et))&&(Ve+=30),Ve+=Math.max(0,30-Z.length),Ve},ge=async()=>{if(!qe.trim())return;Cs.current&&Cs.current.abort();const E=new AbortController;Cs.current=E;const S=qe.trim().toLowerCase(),q=S.split(/\s+/).filter(Boolean);if(Fp.has(S)){rt(Fp.get(S));return}_s(!0);try{const $e=`https://world.openfoodfacts.org/cgi/search.pl?search_terms=${encodeURIComponent(qe.trim())}&search_simple=1&action=process&json=1&page_size=10&lc=en&sort_by=unique_scans_n&fields=product_name,product_name_en,brands,image_small_url,image_url,serving_size,quantity,nutriments`,Oe=await fetch($e,{signal:E.signal});if(!Oe.ok)throw new Error(`HTTP ${Oe.status}`);const It=((await Oe.json()).products||[]).map(Et=>ve(Et)).filter(Et=>Et.name!=="Unknown Product"&&(Et.calories>0||Et.protein>0)).filter(Et=>{const hs=(Et.name+" "+Et.brand).toLowerCase();return q.every(an=>hs.includes(an))}).sort((Et,hs)=>_e(hs.name,hs.brand,S)-_e(Et.name,Et.brand,S)).slice(0,10);Fp.set(S,It),rt(It),It.length===0&&ce("No results found. Try a different search.","info")}catch(Z){if(Z.name==="AbortError")return;console.error("Search error:",Z),ce("Search failed. Check your connection.","error")}_s(!1)};v.useEffect(()=>{if(is.current&&clearTimeout(is.current),!(!qe.trim()||$!=="search"||ue))return is.current=setTimeout(()=>{ge()},700),()=>clearTimeout(is.current)},[qe]);const at=()=>{const E={...K,water:K.water+1};oe(E),Se(E)},Rt=()=>{if(K.water<=0)return;const E={...K,water:K.water-1};oe(E),Se(E)},lt={"ring-protein":"#14b8a6","ring-carbs":"var(--color-primary)","ring-fats":"#eab308","ring-cals":"rgba(150,150,150,0.55)"},bt=80,Tt=2*Math.PI*bt,os=(E,S,q,Z,$e)=>{const Oe=Z>0?Math.min(100,Math.round(q/Z*100)):0,Ve=Tt-Oe/100*Tt,It=lt[$e]||"#14b8a6";return r.jsxs("div",{className:"nut-ring-wrap",children:[r.jsxs("svg",{className:"nut-ring-svg",viewBox:"0 0 200 200",children:[r.jsx("circle",{className:"nut-arc-track",cx:"100",cy:"100",r:bt}),r.jsx("circle",{className:"nut-arc-fill",cx:"100",cy:"100",r:bt,style:{stroke:It},strokeDasharray:Tt,strokeDashoffset:Ve})]}),r.jsxs("div",{className:"nut-ring-center",children:[r.jsx("span",{className:"nut-ring-value",style:{color:It},children:Math.round(q)}),r.jsxs("span",{className:"nut-ring-target",children:["/ ",Z,E==="Calories"?"":"g"]}),r.jsx("span",{className:"nut-ring-label",style:{color:It},children:S})]}),r.jsxs("span",{className:"nut-ring-pct",style:{color:It},children:[Oe,"%"]})]})};if(v.useEffect(()=>{if(!X)return;const E=setTimeout(()=>{const S=X;zt(),P(null),we(S)},1500);return()=>clearTimeout(E)},[X]),v.useEffect(()=>()=>{const E=ss.current;if(qt.current&&E){try{E.stop(),E.offDetected()}catch{}qt.current=!1}},[]),i||g==="loading")return r.jsxs("div",{className:"nut-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>p("/client/core-buddy"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})]})}),r.jsx("div",{className:"nut-loading-inline",children:r.jsx("div",{className:"cb-loading-spinner"})})]});if(g==="setup")return r.jsxs("div",{className:"nut-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>p("/client/core-buddy"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),r.jsxs("main",{className:"nut-main",children:[r.jsxs("div",{className:"nut-setup-intro",children:[r.jsx("h2",{children:"Set Your Daily Targets"}),r.jsx("p",{children:"Calculate your personalised macros based on your body and goals."})]}),r.jsxs("div",{className:"nut-calc-form",children:[r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Gender"}),r.jsxs("div",{className:"nut-toggle-group",children:[r.jsx("button",{className:j.gender==="male"?"active":"",onClick:()=>{O(E=>({...E,gender:"male"})),B(null)},children:"Male"}),r.jsx("button",{className:j.gender==="female"?"active":"",onClick:()=>{O(E=>({...E,gender:"female"})),B(null)},children:"Female"})]})]}),r.jsxs("div",{className:"nut-form-row",children:[r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Age"}),r.jsx("input",{type:"number",value:j.age,onChange:E=>{O(S=>({...S,age:E.target.value})),B(null)},placeholder:"Years",min:"15",max:"100"})]}),r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Weight"}),r.jsxs("div",{className:"nut-input-unit",children:[r.jsx("input",{type:"number",value:j.weight,onChange:E=>{O(S=>({...S,weight:E.target.value})),B(null)},placeholder:j.weightUnit,min:"30",max:"300"}),r.jsxs("div",{className:"nut-unit-toggle",children:[r.jsx("button",{className:j.weightUnit==="kg"?"active":"",onClick:()=>{O(E=>({...E,weightUnit:"kg"})),B(null)},children:"kg"}),r.jsx("button",{className:j.weightUnit==="lbs"?"active":"",onClick:()=>{O(E=>({...E,weightUnit:"lbs"})),B(null)},children:"lbs"})]})]})]})]}),r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Height"}),r.jsxs("div",{className:"nut-input-unit",children:[j.heightUnit==="cm"?r.jsx("input",{type:"number",value:j.height,onChange:E=>{O(S=>({...S,height:E.target.value})),B(null)},placeholder:"cm",min:"100",max:"250"}):r.jsxs("div",{className:"nut-height-imperial",children:[r.jsx("input",{type:"number",value:j.heightFeet,onChange:E=>{O(S=>({...S,heightFeet:E.target.value})),B(null)},placeholder:"ft",min:"4",max:"7"}),r.jsx("input",{type:"number",value:j.heightInches,onChange:E=>{O(S=>({...S,heightInches:E.target.value})),B(null)},placeholder:"in",min:"0",max:"11"})]}),r.jsxs("div",{className:"nut-unit-toggle",children:[r.jsx("button",{className:j.heightUnit==="cm"?"active":"",onClick:()=>{O(E=>({...E,heightUnit:"cm"})),B(null)},children:"cm"}),r.jsx("button",{className:j.heightUnit==="ft"?"active":"",onClick:()=>{O(E=>({...E,heightUnit:"ft"})),B(null)},children:"ft/in"})]})]})]}),r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Daily Activity (outside of training)"}),r.jsxs("select",{value:j.dailyActivity,onChange:E=>{O(S=>({...S,dailyActivity:E.target.value})),B(null)},children:[r.jsx("option",{value:"sedentary",children:"Sedentary  desk job, under 5k steps"}),r.jsx("option",{value:"light",children:"Lightly Active  office + walking, 5-8k steps"}),r.jsx("option",{value:"moderate",children:"Moderately Active  on feet often, 8-12k steps"}),r.jsx("option",{value:"active",children:"Very Active  physical job, 12k+ steps"})]})]}),r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Training Sessions per Week"}),r.jsxs("select",{value:j.trainingFrequency,onChange:E=>{O(S=>({...S,trainingFrequency:E.target.value})),B(null)},children:[r.jsx("option",{value:"low",children:"1-2 sessions"}),r.jsx("option",{value:"moderate",children:"3-4 sessions"}),r.jsx("option",{value:"high",children:"5-6 sessions"}),r.jsx("option",{value:"daily",children:"7+ sessions"})]})]}),r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Fitness Goal"}),r.jsxs("div",{className:"nut-goal-options",children:[r.jsxs("button",{className:j.goal==="lose"?"active":"",onClick:()=>{O(E=>({...E,goal:"lose"})),B(null)},children:[r.jsx("span",{className:"nut-goal-icon",children:"-"}),r.jsx("span",{children:"Lose Weight"})]}),r.jsxs("button",{className:j.goal==="maintain"?"active":"",onClick:()=>{O(E=>({...E,goal:"maintain"})),B(null)},children:[r.jsx("span",{className:"nut-goal-icon",children:"="}),r.jsx("span",{children:"Maintain"})]}),r.jsxs("button",{className:j.goal==="build"?"active":"",onClick:()=>{O(E=>({...E,goal:"build"})),B(null)},children:[r.jsx("span",{className:"nut-goal-icon",children:"+"}),r.jsx("span",{children:"Build Muscle"})]})]})]}),j.goal==="lose"&&r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Deficit Level"}),r.jsxs("div",{className:"nut-deficit-options",children:[r.jsxs("button",{className:j.deficitLevel==="light"?"active":"",onClick:()=>{O(E=>({...E,deficitLevel:"light"})),B(null)},children:[r.jsx("strong",{children:"Mild"}),r.jsx("span",{children:"15% below TDEE"})]}),r.jsxs("button",{className:j.deficitLevel==="moderate"?"active":"",onClick:()=>{O(E=>({...E,deficitLevel:"moderate"})),B(null)},children:[r.jsx("strong",{children:"Moderate"}),r.jsx("span",{children:"20% below TDEE"})]}),r.jsxs("button",{className:j.deficitLevel==="harsh"?"active":"",onClick:()=>{O(E=>({...E,deficitLevel:"harsh"})),B(null)},children:[r.jsx("strong",{children:"Aggressive"}),r.jsx("span",{children:"25% below TDEE"})]})]})]}),r.jsx("button",{className:"nut-calc-btn",onClick:wt,disabled:!Mt(),children:"Calculate Macros"})]}),H&&r.jsxs("div",{className:"nut-calc-results",children:[r.jsx("h3",{children:"Your Daily Targets"}),r.jsxs("div",{className:"nut-calc-rings",children:[os("Protein","Protein",H.protein,H.protein,"ring-protein"),os("Carbs","Carbs",H.carbs,H.carbs,"ring-carbs"),os("Fats","Fats",H.fats,H.fats,"ring-fats"),os("Calories","Calories",H.calories,H.calories,"ring-cals")]}),r.jsxs("div",{className:"nut-calc-info",children:[r.jsxs("div",{className:"nut-calc-info-row",children:[r.jsx("span",{children:"BMR (body at rest)"}),r.jsxs("span",{children:[H.bmr," cal"]})]}),r.jsxs("div",{className:"nut-calc-info-row",children:[r.jsx("span",{children:"+ Daily activity (NEAT)"}),r.jsxs("span",{children:[H.neat," cal"]})]}),r.jsxs("div",{className:"nut-calc-info-row",children:[r.jsx("span",{children:"+ Training sessions"}),r.jsxs("span",{children:["+",H.exerciseAdd," cal"]})]}),r.jsxs("div",{className:"nut-calc-info-row",style:{fontWeight:600},children:[r.jsx("span",{children:"TDEE (total burn)"}),r.jsxs("span",{children:[H.tdee," cal"]})]})]}),r.jsx("button",{className:"nut-save-targets-btn",onClick:yt,children:"Set as My Daily Targets"})]})]}),Ut&&r.jsx("div",{className:`toast-notification ${Ut.type}`,children:Ut.message})]});const Bn=E=>{const S=new Date(E+"T12:00:00"),q=S.getDay(),Z=new Date(S);Z.setDate(S.getDate()-(q+6)%7);const $e=[];for(let Oe=0;Oe<7;Oe++){const Ve=new Date(Z);Ve.setDate(Z.getDate()+Oe),$e.push(Ve.toISOString().split("T")[0])}return $e},fn=["M","T","W","T","F","S","S"],_n=(E,S="search")=>{M(E),S==="scan"?(pe("scan"),Zt(null)):S==="manual"?(pe("manual"),pt({name:"",protein:"",carbs:"",fats:"",calories:"",serving:""})):S==="favourites"?pe("favourites"):(pe("search"),rt([]),ft(""))},Ys=Bn(V),G=new Date(V+"T12:00:00"),he=`${De[G.getMonth()]} ${G.getFullYear()}`;return r.jsx(xa,{children:r.jsxs("div",{className:"nut-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsxs("div",{className:"nut-dark-zone",children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>p("/client/core-buddy"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsxs("div",{className:"header-actions",children:[r.jsx("button",{onClick:()=>{y("setup"),B(null)},"aria-label":"Recalculate macros",children:r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"3"}),r.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 1 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 1 1-2.83-2.83l.06-.06A1.65 1.65 0 0 0 4.68 15a1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1 0-4h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 1 1 2.83-2.83l.06.06A1.65 1.65 0 0 0 9 4.68a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 2.83l-.06.06A1.65 1.65 0 0 0 19.4 9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1z"})]})}),r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})]})]})}),r.jsxs("div",{className:"nut-dark-content",children:[r.jsxs("div",{className:"nut-week-strip",children:[r.jsxs("div",{className:"nut-week-header",children:[r.jsx("button",{className:"nut-week-arrow",onClick:()=>{const E=new Date(V+"T12:00:00");E.setDate(E.getDate()-7);const S=E.toISOString().split("T")[0];se(S)},"aria-label":"Previous week",children:r.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:r.jsx("polyline",{points:"15 18 9 12 15 6"})})}),r.jsx("button",{className:"nut-week-month-label",onClick:()=>{R(!Ee),D({year:G.getFullYear(),month:G.getMonth()})},children:he}),r.jsx("button",{className:"nut-week-arrow",onClick:()=>{const E=new Date(V+"T12:00:00");E.setDate(E.getDate()+7);const S=E.toISOString().split("T")[0];S<=Gi()&&se(S)},"aria-label":"Next week",disabled:Ys[6]>=Gi(),children:r.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:r.jsx("polyline",{points:"9 18 15 12 9 6"})})})]}),r.jsx("div",{className:"nut-week-days",children:Ys.map((E,S)=>{const q=new Date(E+"T12:00:00").getDate(),Z=E===V,$e=E>Gi(),Oe=E===Gi();return r.jsxs("button",{className:`nut-week-day${Z?" selected":""}${Oe?" today":""}${$e?" future":""}`,disabled:$e,onClick:()=>se(E),children:[r.jsx("span",{className:"nut-week-day-letter",children:fn[S]}),r.jsx("span",{className:"nut-week-day-num",children:q})]},E)})})]}),Ee&&r.jsxs("div",{className:"nut-calendar nut-calendar-dark",children:[r.jsxs("div",{className:"nut-cal-header",children:[r.jsx("button",{onClick:()=>D(E=>{let S=E.month-1,q=E.year;return S<0&&(S=11,q--),{year:q,month:S}}),children:r.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("polyline",{points:"15 18 9 12 15 6"})})}),r.jsxs("span",{children:[De[L.month]," ",L.year]}),r.jsx("button",{onClick:()=>D(E=>{let S=E.month+1,q=E.year;return S>11&&(S=0,q++),{year:q,month:S}}),disabled:L.year===new Date().getFullYear()&&L.month>=new Date().getMonth(),children:r.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("polyline",{points:"9 18 15 12 9 6"})})})]}),r.jsx("div",{className:"nut-cal-days-header",children:He.map(E=>r.jsx("span",{children:E},E))}),r.jsxs("div",{className:"nut-cal-grid",children:[[...Array(Ue(L.year,L.month))].map((E,S)=>r.jsx("span",{},`e${S}`)),[...Array(et(L.year,L.month))].map((E,S)=>{const q=S+1,Z=`${L.year}-${String(L.month+1).padStart(2,"0")}-${String(q).padStart(2,"0")}`,$e=Z>Gi(),Oe=Z===V,Ve=Z===Gi();return r.jsx("button",{className:`nut-cal-day${Oe?" selected":""}${Ve?" today":""}${$e?" future":""}`,disabled:$e,onClick:()=>{se(Z),R(!1)},children:q},q)})]})]}),r.jsxs("div",{className:"nut-rings-row",children:[os("Protein","Protein",ye.protein,w.protein,"ring-protein"),os("Carbs","Carbs",ye.carbs,w.carbs,"ring-carbs"),os("Fats","Fats",ye.fats,w.fats,"ring-fats"),os("Calories","kCal",ye.calories,w.calories,"ring-cals")]})]})]}),r.jsx("div",{className:"nut-light-zone",children:r.jsxs("div",{className:"nut-light-content",children:[Be&&r.jsxs("button",{className:"nut-water-quick",onClick:()=>A(!0),children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",stroke:"none",width:"18",height:"18",children:r.jsx("path",{d:"M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z"})}),r.jsxs("span",{className:"nut-water-quick-count",children:[K.water," / ",w?.waterGoal||8]}),r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",width:"14",height:"14",children:[r.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),r.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})]}),r.jsx("div",{className:"nut-log-section",children:r.jsx("div",{className:"nut-meals-list",children:v2.map(E=>{const S=K.entries.filter(Z=>(Z.meal||"snacks")===E.key),q=S.reduce((Z,$e)=>({protein:Z.protein+($e.protein||0),carbs:Z.carbs+($e.carbs||0),fats:Z.fats+($e.fats||0),calories:Z.calories+($e.calories||0)}),{protein:0,carbs:0,fats:0,calories:0});return r.jsxs("div",{className:"nut-meal-card",children:[r.jsxs("div",{className:"nut-meal-card-header",children:[r.jsx("span",{className:`nut-meal-card-icon nut-meal-icon-${E.key}`,children:gD[E.key]}),r.jsx("span",{className:"nut-meal-card-title",children:E.label}),S.length>0&&r.jsxs("span",{className:"nut-meal-card-cal",children:[q.calories," cal"]}),Be&&r.jsx("button",{className:"nut-meal-add-btn",onClick:()=>mt(Ge===E.key?null:E.key),"aria-label":`Add to ${E.label}`,children:r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:[r.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),r.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})})]}),S.length>0&&r.jsxs("div",{className:"nut-meal-bars",children:[r.jsxs("div",{className:"nut-meal-bar-row",children:[r.jsx("span",{className:"nut-meal-bar-label nut-macro-p",children:"P"}),r.jsx("div",{className:"nut-meal-bar-track",children:r.jsx("div",{className:"nut-meal-bar-fill bar-protein",style:{width:`${Math.min(100,w.protein>0?q.protein/w.protein*100:0)}%`}})}),r.jsxs("span",{className:"nut-meal-bar-val",children:[q.protein,"g"]})]}),r.jsxs("div",{className:"nut-meal-bar-row",children:[r.jsx("span",{className:"nut-meal-bar-label nut-macro-c",children:"C"}),r.jsx("div",{className:"nut-meal-bar-track",children:r.jsx("div",{className:"nut-meal-bar-fill bar-carbs",style:{width:`${Math.min(100,w.carbs>0?q.carbs/w.carbs*100:0)}%`}})}),r.jsxs("span",{className:"nut-meal-bar-val",children:[q.carbs,"g"]})]}),r.jsxs("div",{className:"nut-meal-bar-row",children:[r.jsx("span",{className:"nut-meal-bar-label nut-macro-f",children:"F"}),r.jsx("div",{className:"nut-meal-bar-track",children:r.jsx("div",{className:"nut-meal-bar-fill bar-fats",style:{width:`${Math.min(100,w.fats>0?q.fats/w.fats*100:0)}%`}})}),r.jsxs("span",{className:"nut-meal-bar-val",children:[q.fats,"g"]})]}),r.jsxs("div",{className:"nut-meal-bar-row",children:[r.jsx("span",{className:"nut-meal-bar-label nut-macro-cal",children:"K"}),r.jsx("div",{className:"nut-meal-bar-track",children:r.jsx("div",{className:"nut-meal-bar-fill bar-cals",style:{width:`${Math.min(100,w.calories>0?q.calories/w.calories*100:0)}%`}})}),r.jsx("span",{className:"nut-meal-bar-val",children:q.calories})]})]}),S.length>0&&r.jsx("div",{className:"nut-log-list",children:S.map(Z=>r.jsxs("div",{className:"nut-log-item",children:[r.jsxs("div",{className:"nut-log-item-info",children:[r.jsx("span",{className:"nut-log-item-name",children:Z.name}),Z.serving&&r.jsx("span",{className:"nut-log-item-serving",children:Z.serving})]}),r.jsxs("div",{className:"nut-log-item-macros",children:[r.jsxs("span",{className:"nut-macro-p",children:[Z.protein,"p"]}),r.jsxs("span",{className:"nut-macro-c",children:[Z.carbs,"c"]}),r.jsxs("span",{className:"nut-macro-f",children:[Z.fats,"f"]}),r.jsx("span",{className:"nut-macro-cal",children:Z.calories})]}),Be&&r.jsx("button",{className:"nut-log-delete",onClick:()=>jt(Z.id),"aria-label":"Remove",children:r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]},Z.id))}),S.length===0&&r.jsx("div",{className:"nut-meal-empty",children:r.jsx("p",{children:Be?"Tap + to add food":"No entries"})})]},E.key)})})})]})}),Ge&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"nut-add-picker-backdrop",onClick:()=>mt(null)}),r.jsxs("div",{className:"nut-add-picker",children:[r.jsx("div",{className:"nut-add-picker-handle"}),r.jsxs("h3",{className:"nut-add-picker-title",children:["Add to ",v2.find(E=>E.key===Ge)?.label]}),r.jsxs("div",{className:"nut-add-picker-options",children:[r.jsxs("button",{onClick:()=>{const E=Ge;mt(null),_n(E,"scan")},children:[r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M3 7V5a2 2 0 0 1 2-2h2"}),r.jsx("path",{d:"M17 3h2a2 2 0 0 1 2 2v2"}),r.jsx("path",{d:"M21 17v2a2 2 0 0 1-2 2h-2"}),r.jsx("path",{d:"M7 21H5a2 2 0 0 1-2-2v-2"}),r.jsx("line",{x1:"7",y1:"12",x2:"17",y2:"12"})]}),r.jsx("span",{children:"Scan Barcode"})]}),r.jsxs("button",{onClick:()=>{const E=Ge;mt(null),_n(E,"search")},children:[r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"11",cy:"11",r:"8"}),r.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),r.jsx("span",{children:"Search Food"})]}),r.jsxs("button",{onClick:()=>{const E=Ge;mt(null),_n(E,"manual")},children:[r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),r.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]}),r.jsx("span",{children:"Manual Entry"})]}),r.jsxs("button",{onClick:()=>{const E=Ge;mt(null),_n(E,"favourites")},children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),r.jsx("span",{children:"Favourites"})]})]})]})]}),T&&r.jsx("div",{className:"nut-modal-overlay",onClick:()=>A(!1),children:r.jsxs("div",{className:"nut-water-popup",onClick:E=>E.stopPropagation(),children:[r.jsxs("div",{className:"nut-water-popup-header",children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",stroke:"none",width:"20",height:"20",style:{color:"#2196f3"},children:r.jsx("path",{d:"M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z"})}),r.jsx("span",{children:"Water Intake"}),r.jsx("button",{className:"nut-modal-close",onClick:()=>A(!1),children:r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),r.jsxs("div",{className:"nut-water-popup-body",children:[r.jsx("div",{className:"nut-water-glasses",children:[...Array(w?.waterGoal||8)].map((E,S)=>r.jsx("div",{className:`nut-water-glass ${S<K.water?"filled":""}`,children:r.jsx("svg",{viewBox:"0 0 24 24",fill:S<K.water?"currentColor":"none",stroke:"currentColor",strokeWidth:"1.5",children:r.jsx("path",{d:"M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z"})})},S))}),r.jsxs("div",{className:"nut-water-popup-count",children:[K.water," / ",w?.waterGoal||8," glasses"]}),r.jsxs("div",{className:"nut-water-btns",children:[r.jsx("button",{onClick:Rt,disabled:K.water<=0,children:"-"}),r.jsx("button",{onClick:at,children:"+"})]})]})]})}),$&&r.jsx("div",{className:"nut-modal-overlay",onClick:()=>{zt(),P(null),pe(null),Zt(null)},children:r.jsxs("div",{className:"nut-modal",onClick:E=>E.stopPropagation(),children:[r.jsxs("div",{className:"nut-modal-header",children:[r.jsx("h3",{children:$==="scan"?"Scan Barcode":$==="search"?"Search Food":$==="favourites"?"Favourites":"Manual Entry"}),r.jsx("button",{className:"nut-modal-close",onClick:()=>{zt(),P(null),pe(null),Zt(null)},children:r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),$==="scan"&&!ue&&r.jsxs("div",{className:"nut-scan-area",children:[r.jsxs("div",{className:"nut-scanner-wrapper",children:[r.jsx("div",{id:"barcode-reader",className:"nut-scanner-view"}),Me&&!X&&r.jsx("div",{className:"nut-scan-line"}),X&&r.jsxs("div",{className:"nut-scan-detected-overlay",children:[r.jsx("svg",{className:"nut-scan-detected-tick",viewBox:"0 0 24 24",fill:"none",stroke:"#4caf50",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M20 6L9 17l-5-5"})}),r.jsx("p",{className:"nut-scan-detected-label",children:"Barcode found!"}),r.jsx("p",{className:"nut-scan-detected-code",children:X})]})]}),!Me&&r.jsxs("button",{className:"nut-scan-start-btn",onClick:Qt,children:[r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M3 7V5a2 2 0 0 1 2-2h2"}),r.jsx("path",{d:"M17 3h2a2 2 0 0 1 2 2v2"}),r.jsx("path",{d:"M21 17v2a2 2 0 0 1-2 2h-2"}),r.jsx("path",{d:"M7 21H5a2 2 0 0 1-2-2v-2"}),r.jsx("line",{x1:"7",y1:"12",x2:"17",y2:"12"})]}),"Open Camera"]}),Me&&!X&&r.jsx("p",{className:"nut-scan-hint",children:"Align barcode within the frame"}),r.jsx("div",{className:"nut-barcode-divider",children:r.jsx("span",{children:"or enter barcode manually"})}),r.jsxs("div",{className:"nut-barcode-manual",children:[r.jsx("input",{type:"text",inputMode:"numeric",value:re,onChange:E=>Re(E.target.value),onKeyDown:E=>E.key==="Enter"&&re.trim()&&we(re.trim()),placeholder:"Enter barcode number"}),r.jsx("button",{onClick:()=>re.trim()&&we(re.trim()),disabled:!re.trim()||Le,children:Le?"...":"Look Up"})]})]}),$==="scan"&&ue&&(()=>{const E=ue.servingUnit||"g",S=ue.portion,q=Xe==="portion"&&S?Ze*S.weight:parseFloat(Ae)||0,Z=q/100,$e=E==="ml"?[100,200,250,500]:[50,100,150,200],Oe=Xe==="portion"&&S?`${Ze} ${S.label}${Ze!==1?"s":""} (${Math.round(q)}${E})`:`${Math.round(q)}${E}`;return r.jsxs("div",{className:"nut-product-result",children:[ue.image&&r.jsx("img",{src:ue.image,alt:ue.name||"Product",className:"nut-product-img",loading:"lazy"}),r.jsxs("div",{className:"nut-product-name-row",children:[r.jsx("h4",{children:ue.name}),r.jsx("button",{className:`nut-fav-star confirm${be(ue.name)?" active":""}`,onClick:()=>it({name:ue.name,protein:ue.protein,carbs:ue.carbs,fats:ue.fats,calories:ue.calories,serving:ue.servingSize,per100g:{protein:ue.protein,carbs:ue.carbs,fats:ue.fats,calories:ue.calories},servingUnit:ue.servingUnit||"g",portion:ue.portion||null}),children:r.jsx("svg",{viewBox:"0 0 24 24",width:"22",height:"22",fill:be(ue.name)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})})]}),ue.brand&&r.jsx("p",{className:"nut-product-brand",children:ue.brand}),r.jsxs("p",{className:"nut-product-per",children:["Per 100",E,":"]}),r.jsxs("div",{className:"nut-product-macros",children:[r.jsxs("span",{className:"nut-macro-p",children:[ue.protein,"g P"]}),r.jsxs("span",{className:"nut-macro-c",children:[ue.carbs,"g C"]}),r.jsxs("span",{className:"nut-macro-f",children:[ue.fats,"g F"]}),r.jsxs("span",{className:"nut-macro-cal",children:[ue.calories," cal"]})]}),S&&r.jsxs("div",{className:"nut-mode-toggle",children:[r.jsx("button",{className:Xe==="portion"?"active":"",onClick:()=>{Ct("portion"),Ze<1&&Ke(1)},children:"Portions"}),r.jsxs("button",{className:Xe==="weight"?"active":"",onClick:()=>{Ct("weight"),Fe(String(Math.round(q)||100))},children:["Custom (",E,")"]})]}),Xe==="portion"&&S?r.jsxs("div",{className:"nut-portion-stepper",children:[r.jsx("button",{className:"nut-stepper-btn",onClick:()=>Ke(Math.max(1,Ze-1)),children:"-"}),r.jsxs("div",{className:"nut-stepper-display",children:[r.jsx("span",{className:"nut-stepper-count",children:Ze}),r.jsxs("span",{className:"nut-stepper-label",children:[S.label,Ze!==1?"s":""]}),r.jsxs("span",{className:"nut-stepper-weight",children:[Math.round(q),E]})]}),r.jsx("button",{className:"nut-stepper-btn",onClick:()=>Ke(Ze+1),children:"+"})]}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"nut-serving-adjust",children:[r.jsxs("label",{children:["Serving (",E,")"]}),r.jsx("input",{type:"number",inputMode:"numeric",value:Ae,onChange:Ve=>Fe(Ve.target.value),onFocus:Ve=>Ve.target.select(),min:"0"})]}),r.jsx("div",{className:"nut-quick-amounts",children:$e.map(Ve=>r.jsxs("button",{className:`nut-quick-btn${Ae===String(Ve)?" active":""}`,onClick:()=>Fe(String(Ve)),children:[Ve,E]},Ve))})]}),r.jsx("div",{className:"nut-product-total",children:r.jsxs("span",{children:["Total: ",Math.round(ue.protein*Z),"p / ",Math.round(ue.carbs*Z),"c / ",Math.round(ue.fats*Z),"f / ",Math.round(ue.calories*Z)," cal"]})}),r.jsxs("div",{className:"nut-product-actions",children:[r.jsx("button",{className:"nut-btn-secondary",onClick:()=>{Zt(null),pe("scan")},children:"Scan Again"}),r.jsx("button",{className:"nut-btn-primary",onClick:()=>Dt({name:ue.name,protein:Math.round(ue.protein*Z),carbs:Math.round(ue.carbs*Z),fats:Math.round(ue.fats*Z),calories:Math.round(ue.calories*Z),serving:Oe}),children:"Add"})]})]})})(),$==="search"&&!ue&&r.jsxs("div",{className:"nut-search-area",children:[r.jsxs("div",{className:"nut-search-bar",children:[r.jsx("input",{type:"text",ref:Ts,value:qe,onChange:E=>ft(E.target.value),onKeyDown:E=>{E.key==="Enter"&&(clearTimeout(is.current),ge())},onFocus:()=>setTimeout(()=>Ts.current?.scrollIntoView({behavior:"smooth",block:"center"}),350),placeholder:"Search food or product...",autoFocus:!0}),r.jsx("button",{onClick:ge,disabled:Wt,children:Wt?"...":"Search"})]}),r.jsxs("div",{className:"nut-search-results",children:[kt.map((E,S)=>r.jsxs("button",{className:"nut-search-item",onClick:()=>{Zt(E),E.portion?(Ke(1),Fe(String(E.portion.weight)),Ct("portion")):(Ke(0),Fe(String(E.servingValue||100)),Ct("weight"))},children:[E.image&&r.jsx("img",{src:E.image,alt:E.name||"Product",loading:"lazy"}),r.jsxs("div",{className:"nut-search-item-info",children:[r.jsx("span",{className:"nut-search-item-name",children:E.name}),E.brand&&r.jsx("span",{className:"nut-search-item-brand",children:E.brand}),r.jsxs("span",{className:"nut-search-item-macros",children:[E.calories," cal  ",E.protein,"p  ",E.carbs,"c  ",E.fats,"f per 100",E.servingUnit||"g"]})]})]},S)),kt.length===0&&qe&&!Wt&&r.jsx("p",{className:"nut-search-empty",children:"No results found. Try a different search or use manual entry."})]})]}),$==="search"&&ue&&(()=>{const E=ue.servingUnit||"g",S=ue.portion,q=Xe==="portion"&&S?Ze*S.weight:parseFloat(Ae)||0,Z=q/100,$e=E==="ml"?[100,200,250,500]:[50,100,150,200],Oe=Xe==="portion"&&S?`${Ze} ${S.label}${Ze!==1?"s":""} (${Math.round(q)}${E})`:`${Math.round(q)}${E}`;return r.jsxs("div",{className:"nut-product-result",children:[ue.image&&r.jsx("img",{src:ue.image,alt:ue.name||"Product",className:"nut-product-img",loading:"lazy"}),r.jsxs("div",{className:"nut-product-name-row",children:[r.jsx("h4",{children:ue.name}),r.jsx("button",{className:`nut-fav-star confirm${be(ue.name)?" active":""}`,onClick:()=>it({name:ue.name,protein:ue.protein,carbs:ue.carbs,fats:ue.fats,calories:ue.calories,serving:ue.servingSize,per100g:{protein:ue.protein,carbs:ue.carbs,fats:ue.fats,calories:ue.calories},servingUnit:ue.servingUnit||"g",portion:ue.portion||null}),children:r.jsx("svg",{viewBox:"0 0 24 24",width:"22",height:"22",fill:be(ue.name)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})})]}),ue.brand&&r.jsx("p",{className:"nut-product-brand",children:ue.brand}),r.jsxs("p",{className:"nut-product-per",children:["Per 100",E,":"]}),r.jsxs("div",{className:"nut-product-macros",children:[r.jsxs("span",{className:"nut-macro-p",children:[ue.protein,"g P"]}),r.jsxs("span",{className:"nut-macro-c",children:[ue.carbs,"g C"]}),r.jsxs("span",{className:"nut-macro-f",children:[ue.fats,"g F"]}),r.jsxs("span",{className:"nut-macro-cal",children:[ue.calories," cal"]})]}),S&&r.jsxs("div",{className:"nut-mode-toggle",children:[r.jsx("button",{className:Xe==="portion"?"active":"",onClick:()=>{Ct("portion"),Ze<1&&Ke(1)},children:"Portions"}),r.jsxs("button",{className:Xe==="weight"?"active":"",onClick:()=>{Ct("weight"),Fe(String(Math.round(q)||100))},children:["Custom (",E,")"]})]}),Xe==="portion"&&S?r.jsxs("div",{className:"nut-portion-stepper",children:[r.jsx("button",{className:"nut-stepper-btn",onClick:()=>Ke(Math.max(1,Ze-1)),children:"-"}),r.jsxs("div",{className:"nut-stepper-display",children:[r.jsx("span",{className:"nut-stepper-count",children:Ze}),r.jsxs("span",{className:"nut-stepper-label",children:[S.label,Ze!==1?"s":""]}),r.jsxs("span",{className:"nut-stepper-weight",children:[Math.round(q),E]})]}),r.jsx("button",{className:"nut-stepper-btn",onClick:()=>Ke(Ze+1),children:"+"})]}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"nut-serving-adjust",children:[r.jsxs("label",{children:["Serving (",E,")"]}),r.jsx("input",{type:"number",inputMode:"numeric",value:Ae,onChange:Ve=>Fe(Ve.target.value),onFocus:Ve=>Ve.target.select(),min:"0"})]}),r.jsx("div",{className:"nut-quick-amounts",children:$e.map(Ve=>r.jsxs("button",{className:`nut-quick-btn${Ae===String(Ve)?" active":""}`,onClick:()=>Fe(String(Ve)),children:[Ve,E]},Ve))})]}),r.jsx("div",{className:"nut-product-total",children:r.jsxs("span",{children:["Total: ",Math.round(ue.protein*Z),"p / ",Math.round(ue.carbs*Z),"c / ",Math.round(ue.fats*Z),"f / ",Math.round(ue.calories*Z)," cal"]})}),r.jsxs("div",{className:"nut-product-actions",children:[r.jsx("button",{className:"nut-btn-secondary",onClick:()=>Zt(null),children:"Back to Search"}),r.jsx("button",{className:"nut-btn-primary",onClick:()=>Dt({name:ue.name,protein:Math.round(ue.protein*Z),carbs:Math.round(ue.carbs*Z),fats:Math.round(ue.fats*Z),calories:Math.round(ue.calories*Z),serving:Oe}),children:"Add"})]})]})})(),$==="manual"&&r.jsxs("div",{className:"nut-manual-form",children:[r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Food Name"}),r.jsx("input",{type:"text",value:At.name,onChange:E=>pt(S=>({...S,name:E.target.value})),placeholder:"e.g. Chicken Breast",autoFocus:!0})]}),r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Serving Size (optional)"}),r.jsx("input",{type:"text",value:At.serving,onChange:E=>pt(S=>({...S,serving:E.target.value})),placeholder:"e.g. 150g, 1 cup"})]}),r.jsxs("div",{className:"nut-manual-macros",children:[r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Protein (g)"}),r.jsx("input",{type:"number",value:At.protein,onChange:E=>pt(S=>({...S,protein:E.target.value})),min:"0"})]}),r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Carbs (g)"}),r.jsx("input",{type:"number",value:At.carbs,onChange:E=>pt(S=>({...S,carbs:E.target.value})),min:"0"})]}),r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Fats (g)"}),r.jsx("input",{type:"number",value:At.fats,onChange:E=>pt(S=>({...S,fats:E.target.value})),min:"0"})]}),r.jsxs("div",{className:"nut-form-group",children:[r.jsx("label",{children:"Calories"}),r.jsx("input",{type:"number",value:At.calories,onChange:E=>pt(S=>({...S,calories:E.target.value})),min:"0"})]})]}),r.jsx("button",{className:"nut-btn-primary",disabled:!At.name.trim(),onClick:()=>Dt({name:At.name,protein:parseFloat(At.protein)||0,carbs:parseFloat(At.carbs)||0,fats:parseFloat(At.fats)||0,calories:parseFloat(At.calories)||0,serving:At.serving||""}),children:"Add Food"})]}),$==="favourites"&&!ue&&(()=>{const E=J(),S=q=>{if(q.per100g){const Z=q.per100g;Zt({name:q.name,brand:"",image:null,servingSize:q.serving||"100g",servingValue:100,servingUnit:q.servingUnit||"g",portion:q.portion||null,protein:Z.protein,carbs:Z.carbs,fats:Z.fats,calories:Z.calories,per100g:!0}),q.portion?(Ke(1),Fe(String(q.portion.weight)),Ct("portion")):(Ke(0),Fe("100"),Ct("weight"))}else Dt({name:q.name,protein:q.protein,carbs:q.carbs,fats:q.fats,calories:q.calories,serving:q.serving||""})};return r.jsx("div",{className:"nut-recent-area",children:E.length===0?r.jsx("p",{className:"nut-search-empty",children:"No favourites yet. Tap the star on any food to save it here."}):r.jsx("div",{className:"nut-recent-list",children:E.map((q,Z)=>r.jsxs("div",{className:"nut-recent-item-row",children:[r.jsx("button",{className:"nut-fav-star active",onClick:$e=>{$e.stopPropagation(),it(q)},children:r.jsx("svg",{viewBox:"0 0 24 24",width:"18",height:"18",fill:"currentColor",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),r.jsxs("button",{className:"nut-recent-item",onClick:()=>S(q),children:[r.jsxs("div",{className:"nut-recent-item-info",children:[r.jsx("span",{className:"nut-recent-item-name",children:q.name}),r.jsx("span",{className:"nut-recent-item-serving",children:q.serving||""})]}),r.jsxs("span",{className:"nut-recent-item-macros",children:[q.calories," cal"]})]})]},Z))})})})(),$==="favourites"&&ue&&(()=>{const E=ue.servingUnit||"g",S=ue.portion,q=Xe==="portion"&&S?Ze*S.weight:parseFloat(Ae)||0,Z=q/100,$e=E==="ml"?[100,200,250,500]:[50,100,150,200],Oe=Xe==="portion"&&S?`${Ze} ${S.label}${Ze!==1?"s":""} (${Math.round(q)}${E})`:`${Math.round(q)}${E}`;return r.jsxs("div",{className:"nut-product-result",children:[r.jsxs("div",{className:"nut-product-name-row",children:[r.jsx("h4",{children:ue.name}),r.jsx("button",{className:`nut-fav-star confirm${be(ue.name)?" active":""}`,onClick:()=>it({name:ue.name,protein:ue.protein,carbs:ue.carbs,fats:ue.fats,calories:ue.calories,serving:ue.servingSize,per100g:{protein:ue.protein,carbs:ue.carbs,fats:ue.fats,calories:ue.calories},servingUnit:ue.servingUnit||"g",portion:ue.portion||null}),children:r.jsx("svg",{viewBox:"0 0 24 24",width:"22",height:"22",fill:be(ue.name)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})})]}),r.jsxs("p",{className:"nut-product-per",children:["Per 100",E,":"]}),r.jsxs("div",{className:"nut-product-macros",children:[r.jsxs("span",{className:"nut-macro-p",children:[ue.protein,"g P"]}),r.jsxs("span",{className:"nut-macro-c",children:[ue.carbs,"g C"]}),r.jsxs("span",{className:"nut-macro-f",children:[ue.fats,"g F"]}),r.jsxs("span",{className:"nut-macro-cal",children:[ue.calories," cal"]})]}),S&&r.jsxs("div",{className:"nut-mode-toggle",children:[r.jsx("button",{className:Xe==="portion"?"active":"",onClick:()=>{Ct("portion"),Ze<1&&Ke(1)},children:"Portions"}),r.jsxs("button",{className:Xe==="weight"?"active":"",onClick:()=>{Ct("weight"),Fe(String(Math.round(q)||100))},children:["Custom (",E,")"]})]}),Xe==="portion"&&S?r.jsxs("div",{className:"nut-portion-stepper",children:[r.jsx("button",{className:"nut-stepper-btn",onClick:()=>Ke(Math.max(1,Ze-1)),children:"-"}),r.jsxs("div",{className:"nut-stepper-display",children:[r.jsx("span",{className:"nut-stepper-count",children:Ze}),r.jsxs("span",{className:"nut-stepper-label",children:[S.label,Ze!==1?"s":""]}),r.jsxs("span",{className:"nut-stepper-weight",children:[Math.round(q),E]})]}),r.jsx("button",{className:"nut-stepper-btn",onClick:()=>Ke(Ze+1),children:"+"})]}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"nut-serving-adjust",children:[r.jsxs("label",{children:["Serving (",E,")"]}),r.jsx("input",{type:"number",inputMode:"numeric",value:Ae,onChange:Ve=>Fe(Ve.target.value),onFocus:Ve=>Ve.target.select(),min:"0"})]}),r.jsx("div",{className:"nut-quick-amounts",children:$e.map(Ve=>r.jsxs("button",{className:`nut-quick-btn${Ae===String(Ve)?" active":""}`,onClick:()=>Fe(String(Ve)),children:[Ve,E]},Ve))})]}),r.jsx("div",{className:"nut-product-total",children:r.jsxs("span",{children:["Total: ",Math.round(ue.protein*Z),"p / ",Math.round(ue.carbs*Z),"c / ",Math.round(ue.fats*Z),"f / ",Math.round(ue.calories*Z)," cal"]})}),r.jsxs("div",{className:"nut-product-actions",children:[r.jsx("button",{className:"nut-btn-secondary",onClick:()=>Zt(null),children:"Back to Favourites"}),r.jsx("button",{className:"nut-btn-primary",onClick:()=>Dt({name:ue.name,protein:Math.round(ue.protein*Z),carbs:Math.round(ue.carbs*Z),fats:Math.round(ue.fats*Z),calories:Math.round(ue.calories*Z),serving:Oe}),children:"Add"})]})]})})()]})}),r.jsx(aa,{active:"nutrition"}),Ut&&r.jsx("div",{className:`toast-notification ${Ut.type}`,children:Ut.message})]})})}const x2="/login/assets/randomiser-glq9YJkL.jpg",vD="/login/assets/programme-card-workout-CnNzTYkz.webp",xD="/login/assets/prog-fullbody-4wk-r6m9HJys.jpg",wD="/login/assets/mg-arms-BeOQU3wx.jpg",_D=60,qp=5,kD=[{threshold:1e3,label:"1 Tonne"},{threshold:5e3,label:"5 Tonne"},{threshold:1e4,label:"10 Tonne"},{threshold:25e3,label:"25 Tonne"},{threshold:5e4,label:"50 Tonne"},{threshold:1e5,label:"100 Tonne"},{threshold:25e4,label:"250 Tonne"},{threshold:5e5,label:"500 Tonne"},{threshold:1e6,label:"1 Million kg"}],jD={"Dumbbell Floor Press":"push","Seated Dumbbell Shoulder Press":"push","Seated Dumbbell Arnold Press":"push","Dumbbell Overhead Tricep Extension":"push",Skullcrushers:"push","Dumbbell Lateral Raise":"push","Dumbbell Front Raise":"push","Dumbbell Squeeze Press":"push","Incline Dumbbell Press":"push","Dumbbell Fly":"push","Dumbbell Pullover":"push","Tricep Kickback":"push","Dumbbell Shrug":"push","Dumbbell Y-Raise":"push","Dumbbell Bent Over Row":"pull","Single Arm Bent Over Row":"pull","Bicep Curl":"pull","Hammer Curl":"pull","Dumbbell Bent Over Rear Delt Fly":"pull","Renegade Row":"pull","Wide Dumbbell Bent Over Row":"pull","Reverse Fly":"pull","Concentration Curl":"pull","Wide Grip Bicep Curl":"pull","Wrist Curl":"pull","Dumbbell Goblet Squats":"lower","Romanian Deadlifts":"lower","Forward Dumbbell Lunges":"lower","Dumbbell Sumo Squats":"lower","Weighted Calf Raises":"lower","1 Legged RDL":"lower","Dumbbell Box Step Ups":"lower","Dumbbell Squat Pulses":"lower","Dumbbell Reverse Lunges":"lower","Kettlebell Romanian Deadlift":"lower","Russian Twists Dumbbell":"core","Kettlebell Russian Twist":"core","Kettlebell Side Bends":"core","Kneeling Kettlebell Halo":"core","Kettlebell Bird Dog Drag":"core"},TD={fullbody_4wk:{duration:4,daysPerWeek:3},fullbody_8wk:{duration:8,daysPerWeek:3},fullbody_12wk:{duration:12,daysPerWeek:3},core_4wk:{duration:4,daysPerWeek:3},core_8wk:{duration:8,daysPerWeek:3},core_12wk:{duration:12,daysPerWeek:3},upper_4wk:{duration:4,daysPerWeek:3},lower_4wk:{duration:4,daysPerWeek:3}},ED={fullbody:"linear-gradient(160deg, rgba(153,49,60,0.15) 0%, rgba(153,49,60,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)",core:"linear-gradient(160deg, rgba(30,80,120,0.2) 0%, rgba(30,80,120,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)",upper:"linear-gradient(160deg, rgba(100,60,140,0.2) 0%, rgba(100,60,140,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)",lower:"linear-gradient(160deg, rgba(40,120,80,0.2) 0%, rgba(40,120,80,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.88) 80%, rgba(0,0,0,0.95) 100%)"},Hp={arms:"linear-gradient(160deg, rgba(180,60,60,0.2) 0%, rgba(180,60,60,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",chest:"linear-gradient(160deg, rgba(50,100,160,0.2) 0%, rgba(50,100,160,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",back:"linear-gradient(160deg, rgba(80,130,60,0.2) 0%, rgba(80,130,60,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",shoulders:"linear-gradient(160deg, rgba(160,100,40,0.2) 0%, rgba(160,100,40,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",legs:"linear-gradient(160deg, rgba(100,50,140,0.2) 0%, rgba(100,50,140,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)",core:"linear-gradient(160deg, rgba(30,80,120,0.2) 0%, rgba(30,80,120,0.35) 30%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.9) 80%, rgba(0,0,0,0.96) 100%)"},$p=[{id:"fullbody_4wk",name:"4-Week Full Body",focus:"fullbody",duration:4,level:"All Levels",daysPerWeek:3,image:xD},{id:"fullbody_8wk",name:"8-Week Full Body",focus:"fullbody",duration:8,level:"Intermediate",daysPerWeek:3},{id:"fullbody_12wk",name:"12-Week Full Body",focus:"fullbody",duration:12,level:"Advanced",daysPerWeek:3},{id:"core_4wk",name:"4-Week Core",focus:"core",duration:4,level:"Beginner",daysPerWeek:3},{id:"core_8wk",name:"8-Week Core",focus:"core",duration:8,level:"Intermediate",daysPerWeek:3},{id:"core_12wk",name:"12-Week Core",focus:"core",duration:12,level:"Advanced",daysPerWeek:3},{id:"upper_4wk",name:"4-Week Upper Body",focus:"upper",duration:4,level:"Intermediate",daysPerWeek:3},{id:"lower_4wk",name:"4-Week Lower Body",focus:"lower",duration:4,level:"Intermediate",daysPerWeek:3}],Xc=[{key:"arms",label:"Arms",icon:"M7 5h2v14H7V5zm8 0h2v14h-2V5zm-5 4h4v6h-4V9z",image:wD},{key:"chest",label:"Chest",icon:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 15H9v-2h2v2zm4 0h-2v-2h2v2zm3-6c0 1.1-.36 2.12-.97 2.95l-.87-.87C16.7 12.53 17 11.8 17 11c0-2.76-2.24-5-5-5S7 8.24 7 11c0 .8.3 1.53.84 2.08l-.87.87A4.977 4.977 0 0 1 6 11c0-3.31 2.69-6 6-6s6 2.69 6 6z"},{key:"back",label:"Back",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm4 18H8v-6l-4-4 1.41-1.41L8 11.17V8h8v3.17l2.59-2.58L20 10l-4 4v6z"},{key:"shoulders",label:"Shoulders",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm8 10l-3-1.5c-.5-.25-1-.5-1.5-.5h-7c-.5 0-1 .25-1.5.5L4 12l-2 6h4l1.5 4h9L18 18h4l-2-6z"},{key:"legs",label:"Legs",icon:"M16.5 3A2.5 2.5 0 0 0 14 5.5 2.5 2.5 0 0 0 16.5 8 2.5 2.5 0 0 0 19 5.5 2.5 2.5 0 0 0 16.5 3zM14 9l-3 7h2l1 6h2l1-6h2l-3-7h-2z"},{key:"core",label:"Core",icon:"M12 2a4 4 0 0 1 4 4v1h-2V6a2 2 0 1 0-4 0v1H8V6a4 4 0 0 1 4-4zM8 9h8v2H8V9zm-1 4h10l-1 9H8l-1-9z"}],w2={chest:[{id:"chest_strength",name:"Chest Strength",desc:"Heavy pressing for max strength",level:"Intermediate",overview:"A heavy pressing session designed to build raw chest strength. Focus on controlled negatives and powerful pressing movements.",tips:["Go heavy  pick a weight where the last 2 reps are a real challenge","Control the negative (lowering phase) for 2-3 seconds","Keep your shoulder blades squeezed together throughout all pressing movements","Rest 90-120 seconds between sets to allow full recovery"],exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:4,reps:8,storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Dumbbell Squeeze Press",type:"weighted",sets:3,reps:10,storagePath:null},{name:"Incline Dumbbell Press",type:"weighted",sets:3,reps:10,storagePath:null},{name:"Dumbbell Pullover",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Dumbbell Fly",type:"weighted",sets:3,reps:12,storagePath:null}]},{id:"chest_hypertrophy",name:"Chest Hypertrophy",desc:"Volume training for muscle growth",level:"Intermediate",overview:"A high-volume chest session focused on time under tension and muscle growth. Lighter weights, more reps, and slow controlled movements.",tips:["Use moderate weight  you should feel the burn by rep 10","Squeeze your chest at the top of every rep for 1 second","Keep rest periods short at 60-90 seconds to keep the pump going","On press ups, go to failure on the final set"],exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Wide Press Up",type:"reps",sets:3,reps:15,storagePath:null},{name:"Dumbbell Fly",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Incline Dumbbell Press",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Press Up",type:"reps",sets:3,reps:20,storagePath:"exercises/bodyweight/upper/press up.mp4"}]},{id:"chest_endurance",name:"Chest Endurance",desc:"Bodyweight pushing to failure",level:"All Levels",overview:"No weights needed. This bodyweight-only session builds chest endurance and muscular stamina through high-rep push up variations.",tips:["Focus on full range of motion  chest to floor on every rep","Keep your core tight and body in a straight line throughout","Scale down to knee press ups if you can't maintain form","Push through the burn  the last 5 reps are where the growth happens"],exercises:[{name:"Press Up",type:"reps",sets:4,reps:20,storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Wide Press Up",type:"reps",sets:3,reps:15,storagePath:null},{name:"Diamond Press Up",type:"reps",sets:3,reps:12,storagePath:null},{name:"Decline Press Up",type:"reps",sets:3,reps:15,storagePath:null},{name:"Press Up Hold",type:"timed",sets:3,time:30,storagePath:null}]}],back:[{id:"back_strength",name:"Back Strength",desc:"Heavy rows for a thick back",level:"Intermediate",overview:"Build a thick, powerful back with heavy rowing movements. This session targets your lats, rhomboids, and traps for overall back development.",tips:["Go heavy on rows  use a weight that challenges you by rep 6-8","Drive your elbows back and squeeze your shoulder blades together at the top","Keep a slight bend in your knees and hinge at the hips for bent over movements","Rest 90-120 seconds between sets for full recovery"],exercises:[{name:"Dumbbell Bent Over Row",type:"weighted",sets:4,reps:8,storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Single Arm Bent Over Row",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Dumbbell Pullover",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Dumbbell Shrug",type:"weighted",sets:3,reps:15,storagePath:null}]},{id:"back_hypertrophy",name:"Back Hypertrophy",desc:"Width and thickness volume work",level:"Intermediate",overview:"A volume-focused back session combining rows and isolation moves to build width and thickness. Focus on the mind-muscle connection.",tips:["Use moderate weight  feel the stretch and squeeze on every rep","On renegade rows, keep your hips square to the floor and avoid rotating","For reverse flys, use lighter weight and focus on squeezing your rear delts","Keep rest to 60-90 seconds to maintain intensity"],exercises:[{name:"Renegade Row",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/upper/renegade row.mp4"},{name:"Wide Dumbbell Bent Over Row",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Single Arm Bent Over Row",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Reverse Fly",type:"weighted",sets:3,reps:15,storagePath:null},{name:"Prone Y-T-W Raises",type:"reps",sets:3,reps:10,storagePath:null}]},{id:"back_endurance",name:"Back Endurance",desc:"Bodyweight back conditioning",level:"All Levels",overview:"A bodyweight session to strengthen your posterior chain and improve posture. Great for back health, mobility, and muscular endurance.",tips:["On superman holds, lift your arms and legs simultaneously and hold tight","Focus on slow, controlled movements  quality over speed","Breathe steadily throughout timed holds  don't hold your breath","Engage your glutes and lower back together on every movement"],exercises:[{name:"Superman Hold",type:"timed",sets:4,time:30,storagePath:"exercises/bodyweight/upper/Superman Hold.mp4"},{name:"Prone Y-T-W Raises",type:"reps",sets:3,reps:12,storagePath:null},{name:"Reverse Snow Angel",type:"reps",sets:3,reps:12,storagePath:null},{name:"Bird Dog",type:"reps",sets:3,reps:12,storagePath:"exercises/bodyweight/core/Bird Dog.mp4"},{name:"Back Extension Hold",type:"timed",sets:3,time:30,storagePath:null}]}],shoulders:[{id:"shoulders_strength",name:"Shoulder Strength",desc:"Heavy pressing for boulder shoulders",level:"Intermediate",overview:"A heavy overhead pressing session to build strong, powerful shoulders. Compound movements first, followed by isolation work for all three delt heads.",tips:["Go heavy on presses  pick a weight where you struggle on the last 2 reps","Brace your core and avoid arching your back during overhead movements","Press straight up and control the weight down slowly","Rest 90-120 seconds between pressing sets, 60 seconds for isolation moves"],exercises:[{name:"Seated Dumbbell Shoulder Press",type:"weighted",sets:4,reps:8,storagePath:"exercises/dumbbells/upper/seated dumbbell shoulder press.mp4"},{name:"Seated Dumbbell Arnold Press",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/upper/seated dumbbell arnold press.mp4"},{name:"Dumbbell Front Raise",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell front raise.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Dumbbell Shrug",type:"weighted",sets:3,reps:15,storagePath:null}]},{id:"shoulders_hypertrophy",name:"Shoulder Hypertrophy",desc:"Volume and isolation for 3D delts",level:"Intermediate",overview:"A high-volume session targeting all three heads of the deltoid for that 3D capped shoulder look. Moderate weight, high reps, constant tension.",tips:["Use lighter weight than you think  shoulders respond best to high reps","On lateral raises, lead with your elbows and don't swing the weight","Pause at the top of each raise for a 1-second squeeze","Keep rest periods at 60 seconds to maximise the pump"],exercises:[{name:"Seated Dumbbell Arnold Press",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/seated dumbbell arnold press.mp4"},{name:"Dumbbell Lateral Raise",type:"weighted",sets:4,reps:15,storagePath:"exercises/dumbbells/upper/dumbbell lateral raise.mp4"},{name:"Dumbbell Front Raise",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell front raise.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,reps:15,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Dumbbell Y-Raise",type:"weighted",sets:3,reps:12,storagePath:null}]},{id:"shoulders_endurance",name:"Shoulder Endurance",desc:"Bodyweight and high-rep work",level:"All Levels",overview:"A shoulder endurance session combining bodyweight movements with high-rep dumbbell work. Builds stamina, stability, and shoulder resilience.",tips:["On pike push ups, walk your feet close to your hands to increase the angle","For high-rep lateral raises, use a very light weight and focus on form","Wall walks are advanced  scale to pike push ups if needed","Keep your core braced throughout to protect your lower back"],exercises:[{name:"Pike Push Ups",type:"reps",sets:4,reps:12,storagePath:"exercises/bodyweight/upper/pike push ups.mp4"},{name:"Dumbbell Lateral Raise",type:"weighted",sets:3,reps:20,storagePath:"exercises/dumbbells/upper/dumbbell lateral raise.mp4"},{name:"Wall Walks",type:"reps",sets:3,reps:6,storagePath:null},{name:"Prone Y-T-W Raises",type:"reps",sets:3,reps:10,storagePath:null},{name:"Shoulder Tap Hold",type:"timed",sets:3,time:30,storagePath:null}]}],arms:[{id:"arms_bicep",name:"Bicep Focus",desc:"Curl variations for peak biceps",level:"All Levels",overview:"An arm session dedicated entirely to biceps. Multiple curl variations target different parts of the bicep for maximum peak and thickness.",tips:["Keep your elbows pinned to your sides  no swinging","Control the negative (lowering) for 2-3 seconds on every rep","Start with your heaviest weight and decrease as you fatigue","Squeeze hard at the top of each curl for a full contraction"],exercises:[{name:"Bicep Curl",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Hammer Curl",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/hammer curl.mp4"},{name:"Concentration Curl",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Wide Grip Bicep Curl",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Isometric Bicep Hold",type:"timed",sets:3,time:20,storagePath:null}]},{id:"arms_tricep",name:"Tricep Focus",desc:"Extensions and dips for horseshoe triceps",level:"All Levels",overview:"All-out tricep training with extensions, dips, and pressing movements. The triceps make up two-thirds of your arm  this session builds serious size.",tips:["On overhead extensions, keep your elbows close to your head","For skullcrushers, lower the weight slowly to just above your forehead","On dips, lean slightly forward to reduce shoulder strain","Full lockout at the top of every extension for maximum tricep contraction"],exercises:[{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Skullcrushers",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/skullcrushers.mp4"},{name:"Tricep Dips",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/upper/tricep dips.mp4"},{name:"Tricep Kickback",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Diamond Press Up",type:"reps",sets:3,reps:12,storagePath:null}]},{id:"arms_full",name:"Full Arms",desc:"Superset biceps and triceps",level:"All Levels",overview:"A balanced arm session alternating between biceps and triceps. Superset style keeps the intensity high and maximises the pump.",tips:["Superset each pair  do biceps then immediately hit triceps","Use moderate weight that lets you maintain strict form for all reps","Rest 60 seconds after each superset pair","Focus on the squeeze at the peak contraction of every rep"],exercises:[{name:"Bicep Curl",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Tricep Kickback",type:"weighted",sets:3,reps:12,storagePath:null},{name:"Hammer Curl",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/hammer curl.mp4"},{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Wrist Curl",type:"weighted",sets:3,reps:15,storagePath:null}]}],legs:[{id:"legs_quad",name:"Quad Dominant",desc:"Squats and lunges for quad power",level:"All Levels",overview:"A quad-focused leg session built around squats and lunges. Heavy compound movements to build strong, powerful quads and overall leg strength.",tips:["On goblet squats, hold the dumbbell close to your chest and sit deep","Keep your knees tracking over your toes  don't let them cave inward","Drive through your heels on all squatting movements","Rest 90-120 seconds between heavy sets, 60 seconds on bodyweight moves"],exercises:[{name:"Dumbbell Goblet Squats",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Forward Dumbbell Lunges",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.mp4"},{name:"Dumbbell Squat Pulses",type:"weighted",sets:3,reps:15,storagePath:"exercises/dumbbells/lower/dumbbell squat pulses.mp4"},{name:"Bulgarian Split Squats",type:"reps",sets:3,reps:12,storagePath:"exercises/bodyweight/lower/bulgarian split squats.mp4"},{name:"Squat And Hold",type:"timed",sets:3,time:30,storagePath:"exercises/bodyweight/lower/squat and hold.mp4"}]},{id:"legs_ham_glute",name:"Hamstring & Glute",desc:"Posterior chain focus",level:"Intermediate",overview:"Target the back of your legs with deadlift and hip hinge variations. This session builds a strong posterior chain  hamstrings, glutes, and lower back.",tips:["On RDLs, push your hips back and feel the stretch in your hamstrings","Keep a slight bend in your knees throughout hip hinge movements","Squeeze your glutes hard at the top of every rep","For single leg work, start with your weaker side first"],exercises:[{name:"Romanian Deadlifts",type:"weighted",sets:4,reps:10,storagePath:"exercises/dumbbells/lower/romanian deadlifts.mp4"},{name:"1 Legged RDL",type:"weighted",sets:3,reps:10,storagePath:"exercises/dumbbells/lower/1 legged rdl.mp4"},{name:"Hip Thrusts",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/lower/hip thrusts.mp4"},{name:"Dumbbell Sumo Squats",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/dumbbell sumo squats.mp4"},{name:"Donkey Kicks",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/lower/donkey kicks.mp4"}]},{id:"legs_power",name:"Power & Plyo",desc:"Explosive leg training",level:"Intermediate",overview:"An explosive leg session combining plyometrics with weighted movements. Build power, speed, and athletic performance.",tips:["On jump squats, land softly with bent knees to absorb the impact","Explode up on every rep  power comes from speed, not just weight","Keep rest periods at 60-90 seconds to maintain intensity","Focus on landing mechanics  knees out, chest up, soft landing"],exercises:[{name:"Jump Squats",type:"reps",sets:4,reps:12,storagePath:"exercises/bodyweight/lower/jump squats.mp4"},{name:"Dumbbell Box Step Ups",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/dumbbell box step ups.mp4"},{name:"Skater Jumps",type:"reps",sets:3,reps:15,storagePath:"exercises/bodyweight/lower/skater jumps.mp4"},{name:"Dumbbell Reverse Lunges",type:"weighted",sets:3,reps:12,storagePath:"exercises/dumbbells/lower/dumbbell reverse lunges.mp4"},{name:"Weighted Calf Raises",type:"weighted",sets:4,reps:15,storagePath:"exercises/dumbbells/lower/weighted calf raises.mp4"}]}],core:[{id:"core_lower_abs",name:"Lower Abs Blast",desc:"40s work / 20s rest  3 rounds",level:"Intermediate",overview:"An interval-based core burner targeting the lower abdominals. 40 seconds of work followed by 20 seconds of rest  keep the intensity high and your lower back pressed into the floor throughout.",tips:["Press your lower back firmly into the floor on every rep","Exhale hard as you contract your abs  don't hold your breath","If your lower back lifts off the ground, reduce the range of motion","Focus on slow, controlled movements rather than speed"],interval:!0,rounds:3,work:40,rest:20,exercises:[{name:"Leg Raises",storagePath:"exercises/bodyweight/core/Leg Raises.mp4"},{name:"Reverse Crunch To Leg Raise",storagePath:"exercises/bodyweight/core/Reverse Crunch To Leg Raise.mp4"},{name:"Flutter Kicks",storagePath:"exercises/bodyweight/core/Flutter Kicks.mp4"},{name:"Dead Bug Single Leg Drop",storagePath:"exercises/bodyweight/core/Dead Bug Single Leg Drop.mp4"},{name:"Hollow Body Hold",storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"},{name:"Hollow Hold Flutter Kicks",storagePath:"exercises/bodyweight/core/Hollow Hold Flutter Kicks.mp4"}]},{id:"core_obliques",name:"Obliques & Rotation",desc:"35s work / 25s rest  3 rounds",level:"Intermediate",overview:"Target the obliques and rotational core muscles with this interval session. 35 seconds of work with 25 seconds rest  every exercise involves twisting, rotating, or side-bracing movements.",tips:["Rotate from your ribcage, not just your arms","Keep your hips as still as possible during twisting exercises","Brace your core before each movement  think about squeezing a belt","On side planks, stack your hips and push the floor away"],interval:!0,rounds:3,work:35,rest:25,exercises:[{name:"Russian Twist",storagePath:"exercises/bodyweight/core/Russian Twist.mp4"},{name:"Side Plank Rotation",storagePath:"exercises/bodyweight/core/Side Plank Rotation.mp4"},{name:"Cross Body Mountain Climbers",storagePath:"exercises/bodyweight/core/Cross Body Mountain Climbers.mp4"},{name:"Hip Dips Plank",storagePath:"exercises/bodyweight/core/Hip Dips Plank.mp4"},{name:"Bicycle Crunch",storagePath:"exercises/bodyweight/core/Bicycle Crunch.mp4"},{name:"Side Plank",storagePath:"exercises/bodyweight/core/Side Plank.mp4"}]},{id:"core_weighted",name:"Weighted Core",desc:"40s work / 20s rest  3 rounds",level:"Advanced",overview:"Add resistance to your core training with dumbbells and kettlebells. 40 seconds of weighted work followed by 20 seconds rest  this session builds serious core strength and stability.",tips:["Start with a moderate weight  form is more important than load","Brace your entire core before picking up the weight each round","Keep movements controlled  no swinging or using momentum","If grip fails before core does, go slightly lighter next time"],interval:!0,rounds:3,work:40,rest:20,exercises:[{name:"Russian Twists Dumbbell",storagePath:"exercises/dumbbells/core/russian twists dumbbell.mp4"},{name:"Kettlebell Russian Twist",storagePath:"exercises/kettlebells/core/kettlebell russian twist.mp4"},{name:"Kettlebell Side Bends",storagePath:"exercises/kettlebells/core/kettlebell side bends.mp4"},{name:"Kneeling Kettlebell Halo",storagePath:"exercises/kettlebells/core/kneeling kettlebell halo.mp4"},{name:"Kettlebell Bird Dog Drag",storagePath:"exercises/kettlebells/core/kettlebell bird dog drag.mp4"},{name:"Dumbbell Plank Pull Through",storagePath:null}]}]},_2=[{key:"bodyweight",label:"Bodyweight",icon:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 3c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm0 14.2c-2.5 0-4.71-1.28-6-3.22.03-1.99 4-3.08 6-3.08 1.99 0 5.97 1.09 6 3.08-1.29 1.94-3.5 3.22-6 3.22z"},{key:"dumbbells",label:"Dumbbells",icon:"M1 9h2v6H1V9zm3-2h2v10H4V7zm3 4h10v2H7v-2zm10-4h2v10h-2V7zm3 2h2v6h-2V9z"},{key:"kettlebells",label:"Kettlebells",icon:"M12 2C9.24 2 7 4.24 7 7c0 1.1.36 2.12.97 2.95C6.76 11.08 6 12.96 6 15c0 3.87 2.69 7 6 7s6-3.13 6-7c0-2.04-.76-3.92-1.97-5.05.61-.83.97-1.85.97-2.95 0-2.76-2.24-5-5-5zm0 2c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3z"}],Wp=[{key:"core",label:"Core",icon:"M12 2a4 4 0 0 1 4 4v1h-2V6a2 2 0 1 0-4 0v1H8V6a4 4 0 0 1 4-4zM8 9h8v2H8V9zm-1 4h10l-1 9H8l-1-9z"},{key:"upper",label:"Upper",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm8 10l-3-1.5c-.5-.25-1-.5-1.5-.5h-7c-.5 0-1 .25-1.5.5L4 12l-2 6h4l1.5 4h9L18 18h4l-2-6z"},{key:"lower",label:"Lower",icon:"M16.5 3A2.5 2.5 0 0 0 14 5.5 2.5 2.5 0 0 0 16.5 8 2.5 2.5 0 0 0 19 5.5 2.5 2.5 0 0 0 16.5 3zM14 9l-3 7h2l1 6h2l1-6h2l-3-7h-2z"},{key:"fullbody",label:"Full Body",icon:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm-2 8h4l1 4h2l-1 4h-2l-1 4h-2l-1-4H8l-1-4h2l1-4z"},{key:"mix",label:"Mix It Up",icon:"M10.59 9.17L5.41 4 4 5.41l5.17 5.17 1.42-1.41zM14.5 4l2.04 2.04L4 18.59 5.41 20 17.96 7.46 20 9.5V4h-5.5zm-.83 9.41l-1.42 1.42L17.96 20.54l1.42-1.42-5.71-5.71z"}],Dl=[{key:"beginner",label:"Beginner",work:30,rest:30,desc:"30s work / 30s rest"},{key:"intermediate",label:"Intermediate",work:40,rest:20,desc:"40s work / 20s rest"},{key:"advanced",label:"Advanced",work:40,rest:15,desc:"40s work / 15s rest"}],Gp=[5,10,15,20,30];function ND(n){return n.replace(/\b\w/g,e=>e.toUpperCase())}function SD(n){const e=[...n];for(let t=e.length-1;t>0;t--){const i=Math.floor(Math.random()*(t+1));[e[t],e[i]]=[e[i],e[t]]}return e}function CD(){const{currentUser:n,isClient:e,clientData:t,loading:i}=Mr(),{isDark:l,toggleTheme:u,accent:d}=ka(),{isPremium:p,FREE_RANDOMISER_DURATIONS:g,FREE_RANDOMISER_WEEKLY_LIMIT:y}=vm(),w=$n(),[k,j]=v.useState("menu"),[O,H]=v.useState(["bodyweight"]),[B,V]=v.useState("core"),[se,K]=v.useState("intermediate"),[oe,ye]=v.useState(p?15:5),[Pe,Ee]=v.useState([]),[R,T]=v.useState(!1),A=v.useRef(!1),L=v.useRef([]),[D,z]=v.useState([]),[M,Ge]=v.useState(2),[mt,$]=v.useState(Dl[1]),[pe,Me]=v.useState(1),[Qe,X]=v.useState(0),[P,re]=v.useState("work"),[Re,Le]=v.useState(0),[tt,qe]=v.useState(!1),[ft,kt]=v.useState(0),[rt,Wt]=v.useState(null),_s=v.useRef(null);v.useRef(null),v.useRef(null);const[At,pt]=v.useState(null),ue=v.useCallback((Y,xe="info")=>{pt({message:Y,type:xe}),setTimeout(()=>pt(null),3e3)},[]),[Zt,Ae]=v.useState(null),[Fe,Ze]=v.useState(null),[Ke,Xe]=v.useState(0),[Ct,zs]=v.useState(0),[gt,Ut]=v.useState([]),[Bs,qt]=v.useState(""),[Cs,is]=v.useState(""),[Ts,ce]=v.useState(!1),[Se,Be]=v.useState(0),[et,Ue]=v.useState(!1),[De,He]=v.useState({}),wt=v.useRef(null),yt=v.useRef(null),[Mt,Yt]=v.useState([]),[J,be]=v.useState(null),[it,Dt]=v.useState(0),[jt,ss]=v.useState(0),[Qt,zt]=v.useState(0),[Rs,Zs]=v.useState(0),[ds,Es]=v.useState(0),[Ls,F]=v.useState(0),[ve,we]=v.useState({beginner:0,intermediate:0,advanced:0}),_e=p?Gp:Gp.filter(Y=>g.includes(Y)),ge=!p&&it>=y,[at,Rt]=v.useState(null),[lt,bt]=v.useState(""),[Tt,os]=v.useState(!1);v.useEffect(()=>{!i&&(!n||!e)&&w("/")},[n,e,i,w]),v.useEffect(()=>{if(!n||!t)return;(async()=>{try{const xe=$t(fe,"workoutLogs"),te=Ps(xe,us("clientId","==",t.id)),Ye=(await js(te)).docs.map(as=>as.data()),ct=Ye.filter(as=>as.type!=="programme");Zs(ct.length);const xt=ct.reduce((as,dn)=>as+(dn.duration||0),0);Es(xt);const Lt={beginner:0,intermediate:0,advanced:0};ct.forEach(as=>{as.level&&Lt[as.level]!==void 0&&Lt[as.level]++}),we(Lt);const vs=new Date,un=vs.getDay(),ms=un===0?-6:1-un,Wn=new Date(vs);Wn.setDate(vs.getDate()+ms),Wn.setHours(0,0,0,0);const Gr=Wn.getTime(),pn=Ye.filter(as=>{const dn=as.completedAt;return dn?(dn.toDate?dn.toDate().getTime():new Date(dn).getTime())>=Gr:!1});Dt(pn.filter(as=>as.type!=="programme").length);let ja=0;if(t)try{const as=await Ns(We(fe,"clientProgrammes",t.id));if(as.exists()){const dn=as.data(),sr=dn.templateId;ja=pn.filter(sn=>sn.type==="programme"&&sn.programmeId===sr).length,Rt(sr);const Gn=$p.find(sn=>sn.id===sr);Gn&&bt(Gn.name);const _r=TD[sr];if(_r){const sn=Object.keys(dn.completedSessions||{}).length,Pn=_r.duration*_r.daysPerWeek;zt(Pn>0?Math.round(sn/Pn*100):0)}}else Rt(null),bt(""),zt(0)}catch{}ss(ja);const Un=ct.map(as=>as.completedAt).filter(Boolean).map(as=>as.toDate?as.toDate().getTime():new Date(as).getTime()).sort((as,dn)=>dn-as);if(Un.length===0)F(0);else{const as=new Set;Un.forEach(Pn=>{const Nn=new Date(Pn),kr=Nn.getDay(),jr=kr===0?-6:1-kr,Dr=new Date(Nn);Dr.setDate(Nn.getDate()+jr),Dr.setHours(0,0,0,0),as.add(Dr.getTime())});const dn=[...as].sort((Pn,Nn)=>Nn-Pn);let sr=0;const Gn=new Date(vs),_r=vs.getDay()===0?-6:1-vs.getDay();Gn.setDate(vs.getDate()+_r),Gn.setHours(0,0,0,0);let sn=Gn.getTime();dn.includes(sn)||(sn-=10080*60*1e3);for(let Pn=0;Pn<200&&dn.includes(sn);Pn++)sr++,sn-=10080*60*1e3;F(sr)}}catch(xe){console.error("Error loading workout stats:",xe)}finally{os(!0)}})()},[n,t,k]);const Bn=()=>{const Y=[];let xe;B==="mix"?xe=["core","upper","lower"]:B==="fullbody"?xe=["upper","lower"]:xe=[B];for(const te of O)for(const ze of xe)Y.push(`exercises/${te}/${ze}`);return Y},fn=async()=>{if(A.current){for(;A.current;)await new Promise(Y=>setTimeout(Y,200));return L.current}A.current=!0,T(!0);try{const Y=Bn(),xe=[];for(const ct of Y)try{const xt=eo(to,ct),Lt=await y2(xt);xe.push(...Lt.items)}catch{console.warn(`Folder ${ct} not found, skipping.`)}if(xe.length===0&&O.includes("bodyweight")&&B==="core")try{const ct=eo(to,"core"),xt=await y2(ct);xe.push(...xt.items)}catch{console.warn("Legacy core/ folder not found either.")}if(xe.length===0){const ct=O.map(Lt=>_2.find(vs=>vs.key===Lt)?.label).join(" + "),xt=Wp.find(Lt=>Lt.key===B)?.label;return ue(`No exercises found for ${ct} / ${xt}. Upload videos to Firebase Storage.`,"error"),A.current=!1,T(!1),[]}const te=new Set,ze=xe.filter(ct=>{const xt=ct.name.replace(/\.(mp4|gif)$/i,"");return te.has(xt)?!1:(te.add(xt),!0)}),Ye=await Promise.all(ze.map(async ct=>{const xt=await qo(ct),Lt=ND(ct.name.replace(/\.(mp4|gif)$/i,"")),vs=/\.gif$/i.test(ct.name);return{name:Lt,videoUrl:xt,isGif:vs}}));return L.current=Ye,Ee(Ye),A.current=!1,T(!1),Ye}catch(Y){console.error("Error loading exercises:",Y);const xe=Y.code==="storage/unauthorized"?"Storage access denied. Check Firebase Storage rules allow read access.":`Failed to load exercises: ${Y.message||Y.code||"Unknown error"}`;return ue(xe,"error"),A.current=!1,T(!1),[]}},_n=async()=>{if(ge)return;j("spinning"),L.current=[];const Y=await fn();if(Y.length===0){j("setup");return}const xe=Dl.find(un=>un.key===se);$(xe);const te=xe.work+xe.rest,ze=oe*60,Ye=Math.floor(ze/te);let ct,xt;Ye<=6?(ct=Math.max(3,Math.floor(Ye/2)),xt=Math.floor(Ye/ct)):Ye<=12?(ct=Math.min(6,Math.floor(Ye/2)),xt=Math.floor(Ye/ct)):(ct=Math.min(10,Math.floor(Ye/2)),xt=Math.floor(Ye/ct)),xt=Math.max(2,xt);const Lt=SD(Y),vs=Lt.slice(0,Math.min(ct,Lt.length));z(vs),Ge(xt),setTimeout(()=>j("preview"),2e3)},Ys=()=>{j("countdown"),kt(3)};v.useEffect(()=>{if(k!=="countdown")return;if(ft<=0){j("workout"),Me(1),X(0),re("work"),Le(mt.work),qe(!1),an();return}hs();const Y=setTimeout(()=>kt(xe=>xe-1),1e3);return()=>clearTimeout(Y)},[ft,k]),v.useEffect(()=>{if(k!=="workout"||tt)return;if(Re<=0){G();return}Re<=3&&hs();const Y=setTimeout(()=>Le(xe=>xe-1),1e3);return()=>clearTimeout(Y)},[Re,k,tt]);const G=()=>{if(P==="work")re("rest"),Le(mt.rest);else{const Y=Qe+1;if(Y>=D.length){const xe=pe+1;if(xe>M){j("complete"),he();return}Me(xe),X(0)}else X(Y);re("work"),Le(mt.work),an()}},he=async()=>{if(n)try{await hi($t(fe,"workoutLogs"),{clientId:t.id,level:se,duration:oe,equipment:O,focus:B,exerciseCount:D.length,rounds:M,exercises:D.map(Y=>Y.name),completedAt:vt.now()}),Dt(Y=>Y+1),Zs(Y=>Y+1),Es(Y=>Y+oe),we(Y=>({...Y,[se]:(Y[se]||0)+1}))}catch(Y){console.error("Error saving workout log:",Y)}},E=async(Y,xe,te)=>{if(!(!t||!xe))try{const ze=t.id,Ye=await Ns(We(fe,"coreBuddyPBs",ze)),xt=(Ye.exists()?Ye.data():null)?.exercises||{},Lt=xt[Y];let vs=!1;if(Lt?(xe>(Lt.weight||0)||xe===(Lt.weight||0)&&te>(Lt.reps||0))&&(vs=!0):vs=!0,vs){const un={...xt,[Y]:{weight:xe,reps:te,achievedAt:vt.now()}};await Ss(We(fe,"coreBuddyPBs",ze),{clientId:t.id,exercises:un,updatedAt:vt.now()}),ue(`New PB! ${xe}kg  ${te} reps`,"success"),hs(),await S(Y,xe)}}catch(ze){console.error("Error checking PB:",ze)}},S=async(Y,xe)=>{if(t)try{const te=await Ns(We(fe,"coreBuddyTargets",t.id));if(!te.exists())return;const Ye=(te.data().targets||{})[Y];if(!Ye||xe<Ye.targetWeight)return;const ct=await Ns(We(fe,"coreBuddyAchievements",t.id)),xt=ct.exists()?ct.data():{clientId:t.id,badges:[],totalVolume:0};if(xt.badges.some(ms=>ms.type==="pb_target"&&ms.exercise===Y&&ms.targetWeight===Ye.targetWeight))return;const vs={type:"pb_target",exercise:Y,group:jD[Y]||"push",targetWeight:Ye.targetWeight,achievedAt:vt.now()},un=[...xt.badges,vs];await Ss(We(fe,"coreBuddyAchievements",t.id),{...xt,badges:un,updatedAt:vt.now()}),Yt(ms=>[...ms,vs])}catch(te){console.error("Error checking target badge:",te)}},q=async Y=>{if(!(!t||Y<=0))try{const xe=await Ns(We(fe,"coreBuddyAchievements",t.id)),te=xe.exists()?xe.data():{clientId:t.id,badges:[],totalVolume:0},ze=te.totalVolume||0,Ye=ze+Y,ct=[];kD.forEach(Lt=>{Ye>=Lt.threshold&&ze<Lt.threshold&&(te.badges.some(un=>un.type==="volume_milestone"&&un.milestone===Lt.threshold)||ct.push({type:"volume_milestone",milestone:Lt.threshold,label:Lt.label,achievedAt:vt.now()}))});const xt=[...te.badges,...ct];await Ss(We(fe,"coreBuddyAchievements",t.id),{clientId:t.id,badges:xt,totalVolume:Math.round(Ye),updatedAt:vt.now()}),ct.length>0&&Yt(Lt=>[...Lt,...ct])}catch(xe){console.error("Error updating volume:",xe)}},Z=async Y=>{if(Ze(Y),Y.interval){const ze=[];for(const Ye of Y.exercises){let ct=null,xt=!1;if(Ye.storagePath)try{const Lt=eo(to,Ye.storagePath);ct=await qo(Lt),xt=/\.gif$/i.test(Ye.storagePath)}catch{}ze.push({name:Ye.name,videoUrl:ct,isGif:xt})}z(ze),Ge(Y.rounds),$({work:Y.work,rest:Y.rest}),j("preview");return}const xe={};for(const ze of Y.exercises)if(ze.storagePath)try{const Ye=eo(to,ze.storagePath);xe[ze.name]={url:await qo(Ye),isGif:/\.gif$/i.test(ze.storagePath)}}catch{}He(xe);const te=Y.exercises.map(ze=>({name:ze.name,type:ze.type,targetSets:ze.sets,targetReps:ze.reps||0,targetTime:ze.time||0,sets:[]}));Ut(te),Xe(0),zs(0),qt(""),is(""),Ue(!1),ce(!1),Be(0),Yt([]),be(null),j("muscle_workout")},$e=()=>{const Y=wt.current;Y&&(Y.paused?(Y.play(),Ue(!0)):(Y.pause(),Ue(!1)))};v.useEffect(()=>{if(k!=="muscle_workout"||!Ts||Se<=0){k==="muscle_workout"&&Ts&&Se<=0&&(ce(!1),hs());return}return yt.current=setTimeout(()=>Be(Y=>Y-1),1e3),()=>clearTimeout(yt.current)},[k,Ts,Se]);const Oe=async()=>{const Y=gt[Ke];let xe={};if(Y.type==="weighted"){const Ye=parseFloat(Bs)||0,ct=parseInt(Cs)||0;if(ct===0){ue("Enter your reps","error");return}xe={weight:Ye,reps:ct}}else if(Y.type==="reps"){const Ye=parseInt(Cs)||0;if(Ye===0){ue("Enter your reps","error");return}xe={reps:Ye}}else if(Y.type==="timed"){const Ye=Y.targetTime-Se;xe={time:Math.max(Ye,1)}}const te=[...gt];te[Ke]={...Y,sets:[...Y.sets,xe]},Ut(te),Y.type==="weighted"&&xe.weight>0&&await E(Y.name,xe.weight,xe.reps);const ze=Y.sets.length+1;if(ze<Y.targetSets)zs(ze),is(""),ce(!1),Be(0);else if(Ke+1<gt.length){const Ye=Ke+1;Xe(Ye),zs(0),qt(""),is(""),Ue(!1),ce(!1),Be(0)}else await Ve(te),j("muscle_complete")},Ve=async Y=>{if(!(!n||!t))try{const xe=Y.reduce((ze,Ye)=>ze+Ye.sets.reduce((ct,xt)=>ct+(xt.weight||0)*(xt.reps||0),0),0),te=Y.reduce((ze,Ye)=>ze+Ye.sets.length,0);await hi($t(fe,"workoutLogs"),{clientId:t.id,type:"muscle_group",muscleGroup:Zt,sessionId:Fe?.id,sessionName:Fe?.name,exerciseCount:Y.length,totalSets:te,duration:Math.round(te*1.5),volume:Math.round(xe),exercises:Y.map(ze=>({name:ze.name,type:ze.type,sets:ze.sets})),completedAt:vt.now()}),xe>0&&await q(xe),Mt.length>0&&be({badges:[...Mt]})}catch(xe){console.error("Error saving muscle group workout log:",xe)}},It=v.useRef(null),Et=()=>(It.current||(It.current=new(window.AudioContext||window.webkitAudioContext)),It.current),hs=()=>{try{const Y=Et(),xe=Y.createOscillator(),te=Y.createGain();xe.connect(te),te.connect(Y.destination),xe.frequency.value=880,te.gain.value=.3,xe.start(Y.currentTime),xe.stop(Y.currentTime+.15)}catch{}},an=()=>{try{const Y=Et(),xe=Y.createOscillator(),te=Y.createGain();xe.connect(te),te.connect(Y.destination),xe.frequency.value=1200,te.gain.value=.4,xe.start(Y.currentTime),xe.stop(Y.currentTime+.3)}catch{}};v.useEffect(()=>{if(k!=="workout"||P!=="work"||!D[Qe]?.isGif)return;const xe=setInterval(()=>{const te=_s.current;if(!te)return;const ze=te.getAttribute("src");te.removeAttribute("src"),setTimeout(()=>{_s.current&&_s.current.setAttribute("src",ze)},0)},4e3);return()=>clearInterval(xe)},[k,P,Qe,pe,D]);const Hs=(Y,xe,te)=>{const ze=Math.round(Y/xe*_D);return r.jsx("svg",{className:"wk-ring-svg",viewBox:"0 0 200 200",children:K3.map((Ye,ct)=>r.jsx("line",{x1:Ye.x1,y1:Ye.y1,x2:Ye.x2,y2:Ye.y2,className:ct<ze?`wk-tick-filled ${te}`:"wk-tick-empty",strokeWidth:Ye.thick?"3":"2"},ct))})},As=()=>{const Y=D.length*M;return((pe-1)*D.length+Qe+(P==="rest"?.5:0))/Y},Is=At&&r.jsx("div",{className:`toast-notification ${At.type}`,children:At.message});if(i)return r.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>w("/client/core-buddy"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})]})}),r.jsx("div",{className:"wk-loading-inline",children:r.jsx("div",{className:"wk-loading-spinner"})})]});if(k==="menu")return r.jsx(xa,{children:r.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>w("/client/core-buddy"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),r.jsxs("main",{className:"wk-main",children:[r.jsxs("div",{className:"wk-menu-heading",children:[r.jsx("h2",{children:"Choose Your Workout"}),r.jsx("p",{children:"No excuses. Just results."})]}),r.jsx("button",{className:"wk-hero-card",onClick:()=>j("setup"),children:r.jsx("img",{src:x2,alt:"Randomise Workout",className:"wk-hero-bg"})}),r.jsxs("div",{className:"wk-section-header",children:[r.jsxs("h2",{children:["Programmes ",!p&&r.jsx("span",{className:"cb-premium-badge",children:"PREMIUM"})]}),r.jsxs("span",{className:"wk-section-count",children:[$p.length," available"]})]}),p?r.jsx("div",{className:"wk-prog-scroll-wrap",children:r.jsx("div",{className:"wk-prog-scroll",children:$p.map((Y,xe)=>Y.image?r.jsxs("button",{className:"wk-prog-img-card",onClick:()=>w("/client/core-buddy/programmes",{state:{templateId:Y.id}}),style:{animationDelay:`${xe*.06}s`},children:[r.jsx("img",{src:Y.image,alt:Y.name,className:"wk-prog-img"}),xe===0&&r.jsx("div",{className:"wk-swipe-arrow",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})})]},Y.id):r.jsxs("button",{className:"wk-prog-hero-card",onClick:()=>w("/client/core-buddy/programmes",{state:{templateId:Y.id}}),style:{animationDelay:`${xe*.06}s`},children:[r.jsx("img",{src:vD,alt:"Programme",className:"wk-prog-hero-bg",loading:"lazy"}),r.jsx("div",{className:"wk-prog-hero-overlay",style:{background:ED[Y.focus]}}),r.jsxs("div",{className:"wk-prog-hero-content",children:[r.jsxs("div",{className:"wk-prog-hero-top",children:[r.jsxs("span",{className:"wk-prog-hero-badge",children:[Y.duration," WEEKS"]}),r.jsx("span",{className:"wk-prog-hero-level",children:Y.level})]}),r.jsxs("div",{className:"wk-prog-hero-bottom",children:[r.jsx("h3",{children:Y.name.toUpperCase()}),r.jsxs("p",{children:[Y.daysPerWeek,"x per week  ",Y.focus==="fullbody"?"Full Body":Y.focus.charAt(0).toUpperCase()+Y.focus.slice(1)," Focus"]}),r.jsx("span",{className:"wk-prog-hero-go",children:"VIEW PROGRAMME "})]})]}),xe===0&&r.jsx("div",{className:"wk-swipe-arrow",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})})]},Y.id))})}):r.jsxs("button",{className:"cb-upgrade-teaser",onClick:()=>w("/upgrade"),children:[r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),r.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}),r.jsx("span",{children:"Upgrade to unlock programmes"})]}),r.jsxs("div",{className:"wk-section-header",children:[r.jsxs("h2",{children:["Muscle Groups ",!p&&r.jsx("span",{className:"cb-premium-badge",children:"PREMIUM"})]}),r.jsxs("span",{className:"wk-section-count",children:[Xc.length," groups"]})]}),p?r.jsx("div",{className:"wk-muscle-grid",children:Xc.map((Y,xe)=>r.jsx("button",{className:`wk-muscle-hero-card${Y.image?" wk-muscle-thumb":""}`,onClick:()=>{Ae(Y.key),j("muscle_sessions")},style:{animationDelay:`${xe*.05}s`},children:Y.image?r.jsx("img",{src:Y.image,alt:Y.label,className:"wk-muscle-thumb-img"}):r.jsxs(r.Fragment,{children:[r.jsx("img",{src:x2,alt:"Muscle group",className:"wk-muscle-hero-bg",loading:"lazy"}),r.jsx("div",{className:"wk-muscle-hero-overlay",style:{background:Hp[Y.key]}}),r.jsxs("div",{className:"wk-muscle-hero-content",children:[r.jsx("div",{className:"wk-muscle-hero-icon",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:Y.icon})})}),r.jsxs("div",{className:"wk-muscle-hero-text",children:[r.jsx("span",{className:"wk-muscle-hero-name",children:Y.label}),r.jsxs("span",{className:"wk-muscle-hero-count",children:[w2[Y.key]?.length||0," sessions"]})]})]})]})},Y.key))}):r.jsxs("button",{className:"cb-upgrade-teaser",onClick:()=>w("/upgrade"),children:[r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),r.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}),r.jsx("span",{children:"Upgrade to unlock muscle group workouts"})]})]}),r.jsx(aa,{active:"workouts"}),Is]})});if(k==="setup"){const Y=Wp.find(te=>te.key===B)?.label||B,xe=Dl.find(te=>te.key===se)?.label||se;return r.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>j("menu"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),r.jsxs("main",{className:"wk-main wk-setup-main",children:[r.jsx("div",{className:"wk-stats-row",children:[{label:"Total",value:`${Rs}`,pct:Rs>0?Math.min(Math.round(Rs/100*100),100):0,color:"#14b8a6",size:"normal"},{label:"This Week",value:`${it}/${qp}`,pct:Math.round(Math.min(it,qp)/qp*100),color:"var(--color-primary)",size:"large"},{label:"Wk Streak",value:`${Ls}`,pct:Ls>0?Math.min(Math.round(Ls/12*100),100):0,color:"#38B6FF",size:"normal"}].map(te=>{const Ye=2*Math.PI*38,ct=Ye-te.pct/100*Ye;return r.jsxs("div",{className:`wk-stat-item${te.size==="large"?" wk-stat-large":""}`,children:[r.jsxs("div",{className:"wk-stat-ring",children:[r.jsxs("svg",{viewBox:"0 0 100 100",children:[r.jsx("circle",{className:"wk-stat-track",cx:"50",cy:"50",r:38}),r.jsx("circle",{className:"wk-stat-fill",cx:"50",cy:"50",r:38,style:{stroke:te.color},strokeDasharray:Ye,strokeDashoffset:ct})]}),r.jsx("span",{className:"wk-stat-value",style:{color:te.color},children:te.value})]}),r.jsx("span",{className:"wk-stat-label",children:te.label})]},te.label)})}),r.jsxs("div",{className:"wk-setup-flow",children:[r.jsxs("div",{className:"wk-setup-section",children:[r.jsx("h2",{children:"Focus Area"}),r.jsx("div",{className:"wk-focus-grid",children:Wp.map(te=>r.jsxs("button",{className:`wk-equip-btn${B===te.key?" active":""}${te.key==="mix"?" wk-mix-btn":""}`,onClick:()=>V(te.key),children:[r.jsx("svg",{className:"wk-equip-icon",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:te.icon})}),r.jsx("span",{children:te.label})]},te.key))})]}),r.jsxs("div",{className:"wk-setup-section",children:[r.jsx("h2",{children:"Level"}),r.jsx("div",{className:"wk-level-cards",children:Dl.map(te=>r.jsxs("button",{className:`wk-level-card wk-level-${te.key}${se===te.key?" active":""}`,onClick:()=>K(te.key),children:[r.jsx("span",{className:"wk-level-name",children:te.label}),r.jsx("span",{className:"wk-level-desc",children:te.desc})]},te.key))})]}),r.jsxs("div",{className:"wk-setup-section",children:[r.jsx("h2",{children:"Time"}),r.jsx("div",{className:"wk-time-options",children:Gp.map(te=>{const ze=!_e.includes(te);return r.jsxs("button",{className:`wk-time-btn${oe===te?" active":""}${ze?" locked":""}`,onClick:()=>!ze&&ye(te),disabled:ze,children:[r.jsx("span",{className:"wk-time-num",children:te}),r.jsx("span",{className:"wk-time-unit",children:ze?r.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),r.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]}):"min"})]},te)})})]}),r.jsxs("div",{className:"wk-setup-section",children:[r.jsx("h2",{children:"Equipment"}),r.jsx("div",{className:"wk-equip-options",children:_2.map(te=>{const ze=O.includes(te.key);return r.jsxs("button",{className:`wk-equip-btn${ze?" active":""}`,onClick:()=>{H(Ye=>ze&&Ye.length===1?Ye:ze?Ye.filter(ct=>ct!==te.key):[...Ye,te.key])},children:[r.jsx("svg",{className:"wk-equip-icon",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:te.icon})}),r.jsx("span",{children:te.label})]},te.key)})})]}),r.jsx("div",{className:"wk-setup-summary",children:r.jsxs("span",{children:[Y,"  ",xe,"  ",oe," min"]})})]})]}),r.jsxs("div",{className:"wk-go-sticky",children:[ge&&r.jsx("p",{className:"wk-free-limit-msg",children:"You've used your free workout this week. Upgrade for unlimited access."}),r.jsx("button",{className:"wk-randomise-btn",onClick:_n,disabled:R||ge,children:R?"Loading exercises...":ge?"Limit Reached":"Randomise Workout"})]}),Is]})}if(k==="spinning")return r.jsxs("div",{className:"wk-page wk-page-center","data-theme":l?"dark":"light","data-accent":d,children:[r.jsxs("div",{className:"wk-spin-container",children:[r.jsxs("div",{className:"wk-spin-ring",children:[r.jsx("svg",{className:"wk-spin-svg",viewBox:"0 0 200 200",children:du.map((Y,xe)=>r.jsx("line",{x1:Y.x1,y1:Y.y1,x2:Y.x2,y2:Y.y2,className:"wk-spin-tick",strokeWidth:Y.thick?"3.5":"2",style:{animationDelay:`${xe*.03}s`}},xe))}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"wk-spin-logo",width:"50",height:"50"})]}),r.jsx("p",{className:"wk-spin-text",children:"Generating workout..."})]}),Is]});if(k==="preview"){const Y=Fe?.interval?{work:Fe.work,rest:Fe.rest}:Dl.find(te=>te.key===se),xe=D.length*M*(Y.work+Y.rest);return r.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>j(Fe?.interval?"muscle_sessions":"setup"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),r.jsxs("main",{className:"wk-main",children:[Fe?.interval&&r.jsx("h2",{className:"mg-preview-title",children:Fe.name}),r.jsxs("div",{className:"wk-preview-stats",children:[r.jsxs("div",{className:"wk-stat",children:[r.jsx("span",{className:"wk-stat-val",children:D.length}),r.jsx("span",{className:"wk-stat-label",children:"Exercises"})]}),r.jsxs("div",{className:"wk-stat",children:[r.jsx("span",{className:"wk-stat-val",children:M}),r.jsx("span",{className:"wk-stat-label",children:"Rounds"})]}),r.jsxs("div",{className:"wk-stat",children:[r.jsx("span",{className:"wk-stat-val",children:Math.ceil(xe/60)}),r.jsx("span",{className:"wk-stat-label",children:"Minutes"})]}),r.jsxs("div",{className:"wk-stat",children:[r.jsxs("span",{className:"wk-stat-val",children:[Y.work,"/",Y.rest]}),r.jsx("span",{className:"wk-stat-label",children:"Work/Rest"})]})]}),r.jsx("div",{className:"wk-preview-list",children:D.map((te,ze)=>r.jsxs("div",{className:"wk-preview-item",style:{animationDelay:`${ze*.06}s`},onClick:()=>Wt(te),children:[r.jsx("span",{className:"wk-preview-num",children:ze+1}),r.jsx("div",{className:"wk-preview-thumb",children:te.isGif?r.jsx("img",{src:te.videoUrl,alt:te.name,loading:"lazy"}):r.jsx("video",{src:`${te.videoUrl}#t=0.1`,muted:!0,playsInline:!0,preload:"auto"})}),r.jsx("span",{className:"wk-preview-name",children:te.name}),r.jsx("svg",{className:"wk-preview-play",width:"22",height:"22",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})})]},ze))}),rt&&r.jsx("div",{className:"wk-preview-modal-backdrop",onClick:()=>Wt(null),children:r.jsxs("div",{className:"wk-preview-modal",onClick:te=>te.stopPropagation(),children:[r.jsx("button",{className:"wk-preview-modal-close",onClick:()=>Wt(null),"aria-label":"Close preview",children:r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})}),r.jsx("div",{className:"wk-preview-modal-video",children:rt.isGif?r.jsx("img",{src:rt.videoUrl,alt:rt.name}):r.jsx("video",{src:rt.videoUrl,autoPlay:!0,loop:!0,muted:!0,playsInline:!0})}),r.jsx("h3",{className:"wk-preview-modal-title",children:rt.name})]})}),r.jsxs("div",{className:"wk-preview-actions",children:[!Fe?.interval&&r.jsxs("button",{className:"wk-btn-secondary",onClick:()=>_n(),children:[r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("polyline",{points:"1 4 1 10 7 10"}),r.jsx("path",{d:"M3.51 15a9 9 0 1 0 2.13-9.36L1 10"})]}),"Reshuffle"]}),r.jsx("button",{className:"wk-btn-primary",onClick:Ys,children:"Start Workout"})]})]})]})}if(k==="countdown")return r.jsx("div",{className:"wk-page wk-page-center wk-page-dark","data-theme":l?"dark":"light","data-accent":d,children:r.jsxs("div",{className:"wk-countdown-big",children:[r.jsx("span",{className:"wk-countdown-num",children:ft}),r.jsx("span",{className:"wk-countdown-label",children:"GET READY"})]})});if(k==="workout"){const Y=D[Qe],xe=P==="work"?mt.work:mt.rest,te=P==="rest"?Qe+1<D.length?D[Qe+1]:pe<M?D[0]:null:null;return r.jsxs("div",{className:"wk-page wk-page-workout","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("div",{className:"wk-video-container",children:P==="work"?Y.isGif?r.jsx("img",{ref:_s,className:"wk-video",src:Y.videoUrl,alt:Y.name},Y.videoUrl):r.jsx("video",{className:"wk-video",src:Y.videoUrl,autoPlay:!0,loop:!0,muted:!0,playsInline:!0},Y.videoUrl):r.jsxs("div",{className:"wk-rest-screen",children:[r.jsx("span",{className:"wk-rest-label",children:"REST"}),te&&r.jsxs("span",{className:"wk-next-label",children:["Next: ",te.name]})]})}),r.jsx("div",{className:"wk-back-row",children:r.jsxs("button",{className:"wk-back-btn",onClick:()=>{confirm("Leave workout?")&&j("menu")},children:[r.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})}),"Back"]})}),r.jsx("div",{className:"wk-spotify",children:r.jsx("iframe",{src:"https://open.spotify.com/embed/playlist/37i9dQZF1DZ06evO3FJyYF?utm_source=generator&theme=0",width:"100%",height:"80",frameBorder:"0",allow:"autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture",loading:"lazy",title:"Spotify Playlist"})}),r.jsxs("div",{className:"wk-exercise-info",children:[r.jsxs("span",{className:"wk-exercise-counter",children:[Qe+1," / ",D.length]}),r.jsx("h2",{className:"wk-exercise-name",children:Y.name}),r.jsxs("span",{className:"wk-round-label",children:["Round ",pe," of ",M]})]}),r.jsx("div",{className:"wk-timer-section",children:r.jsxs("div",{className:"wk-timer-ring-wrap",children:[Hs(Re,xe,P==="work"?"wk-tick-work":"wk-tick-rest"),r.jsxs("div",{className:"wk-timer-center",children:[r.jsx("span",{className:"wk-timer-time",children:Re}),r.jsx("span",{className:`wk-timer-phase ${P}`,children:P==="work"?"WORK":"REST"})]})]})}),r.jsxs("div",{className:"wk-controls",children:[r.jsx("button",{className:"wk-ctrl-btn wk-ctrl-stop",onClick:()=>{confirm("End workout early?")&&j("menu")},children:r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("rect",{x:"4",y:"4",width:"16",height:"16",rx:"2"})})}),r.jsx("button",{className:"wk-ctrl-btn wk-ctrl-pause",onClick:()=>qe(!tt),children:tt?r.jsx("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})}):r.jsxs("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"currentColor",children:[r.jsx("rect",{x:"6",y:"4",width:"4",height:"16"}),r.jsx("rect",{x:"14",y:"4",width:"4",height:"16"})]})}),r.jsx("button",{className:"wk-ctrl-btn wk-ctrl-skip",onClick:()=>{Le(0)},children:r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:[r.jsx("polygon",{points:"5 4 15 12 5 20 5 4"}),r.jsx("rect",{x:"15",y:"4",width:"4",height:"16"})]})})]}),r.jsx("div",{className:"wk-progress-bar",children:r.jsx("div",{className:"wk-progress-fill",style:{width:`${As()*100}%`}})})]})}if(k==="complete"){const Y=Dl.find(te=>te.key===se),xe=D.length*M*(Y.work+Y.rest);return r.jsx("div",{className:"wk-page wk-page-center","data-theme":l?"dark":"light","data-accent":d,children:r.jsxs("div",{className:"wk-complete",children:[r.jsxs("div",{className:"wk-complete-ring",children:[r.jsx("svg",{className:"wk-complete-svg",viewBox:"0 0 200 200",children:du.map((te,ze)=>r.jsx("line",{x1:te.x1,y1:te.y1,x2:te.x2,y2:te.y2,className:"wk-tick-complete",strokeWidth:te.thick?"3.5":"2",style:{animationDelay:`${ze*.02}s`}},ze))}),r.jsx("div",{className:"wk-complete-center",children:r.jsx("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"#4caf50",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M20 6L9 17l-5-5"})})})]}),r.jsx("h2",{className:"wk-complete-title",children:"Workout Complete!"}),r.jsxs("div",{className:"wk-complete-stats",children:[r.jsxs("div",{className:"wk-stat",children:[r.jsx("span",{className:"wk-stat-val",children:Math.ceil(xe/60)}),r.jsx("span",{className:"wk-stat-label",children:"Minutes"})]}),r.jsxs("div",{className:"wk-stat",children:[r.jsx("span",{className:"wk-stat-val",children:D.length*M}),r.jsx("span",{className:"wk-stat-label",children:"Intervals"})]}),r.jsxs("div",{className:"wk-stat",children:[r.jsx("span",{className:"wk-stat-val",children:M}),r.jsx("span",{className:"wk-stat-label",children:"Rounds"})]})]}),r.jsx("div",{className:"wk-complete-actions",children:r.jsx("button",{className:"wk-btn-primary",onClick:()=>{Ze(null),Ae(null),j("menu")},children:"Done"})})]})})}if(k==="muscle_sessions"){const Y=Xc.find(te=>te.key===Zt),xe=w2[Zt]||[];return r.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>j("menu"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),r.jsxs("main",{className:"wk-main",children:[r.jsxs("div",{className:"mg-sessions-header",children:[r.jsx("div",{className:"mg-sessions-icon",style:{background:Hp[Zt]},children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:Y?.icon})})}),r.jsxs("h2",{children:[Y?.label," Workouts"]}),r.jsxs("p",{children:[xe.length," sessions available"]})]}),r.jsx("div",{className:"mg-sessions-list",children:xe.map((te,ze)=>r.jsxs("button",{className:"mg-session-card",onClick:()=>{Ze(te),j("muscle_overview")},style:{animationDelay:`${ze*.08}s`},children:[r.jsxs("div",{className:"mg-session-info",children:[r.jsx("h3",{children:te.name}),r.jsx("p",{children:te.desc}),r.jsx("div",{className:"mg-session-meta",children:te.interval?r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"mg-session-tag mg-tag-interval",children:"Interval"}),r.jsxs("span",{className:"mg-session-tag",children:[te.exercises.length," exercises"]}),r.jsxs("span",{className:"mg-session-tag",children:[te.rounds," rounds"]})]}):r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"mg-session-tag mg-tag-strength",children:"Strength"}),r.jsxs("span",{className:"mg-session-tag",children:[te.exercises.length," exercises"]}),r.jsx("span",{className:"mg-session-tag",children:(()=>{const Ye=te.exercises.map(Lt=>Lt.sets||0),ct=Math.min(...Ye),xt=Math.max(...Ye);return ct===xt?`${ct} sets each`:`${ct}-${xt} sets each`})()})]})})]}),r.jsx("div",{className:"mg-session-arrow",children:r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})})]},te.id))})]}),Is]})}if(k==="muscle_overview"){const Y=Fe;if(!Y)return null;const xe=Xc.find(te=>te.key===Zt);return r.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>j("muscle_sessions"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),r.jsxs("main",{className:"wk-main mg-overview-main",children:[r.jsx("div",{className:"mg-overview-hero",style:{background:Hp[Zt]},children:r.jsx("div",{className:"mg-overview-hero-content",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",className:"mg-overview-hero-icon",children:r.jsx("path",{d:xe?.icon})})})}),r.jsxs("div",{className:"mg-overview-header",children:[r.jsxs("div",{className:"mg-overview-title-row",children:[r.jsx("h2",{children:Y.name}),Y.level&&r.jsx("span",{className:"mg-overview-level",children:Y.level})]}),r.jsx("p",{className:"mg-overview-desc",children:Y.desc})]}),Y.overview&&r.jsxs("div",{className:"mg-overview-section",children:[r.jsxs("h3",{children:[r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("path",{d:"M12 16v-4M12 8h.01"})]}),"About This Workout"]}),r.jsx("p",{children:Y.overview})]}),Y.tips&&Y.tips.length>0&&r.jsxs("div",{className:"mg-overview-section",children:[r.jsxs("h3",{children:[r.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 1 1 7.072 0l-.548.547A3.374 3.374 0 0 0 14 18.469V19a2 2 0 1 1-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),"Tips & Form"]}),r.jsx("ul",{className:"mg-overview-tips",children:Y.tips.map((te,ze)=>r.jsx("li",{children:te},ze))})]}),r.jsxs("div",{className:"mg-overview-section",children:[r.jsxs("h3",{children:[r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M9 5H7a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-2"}),r.jsx("rect",{x:"9",y:"3",width:"6",height:"4",rx:"1"}),r.jsx("path",{d:"M9 14l2 2 4-4"})]}),"Exercises (",Y.exercises.length,")"]}),r.jsx("div",{className:"mg-overview-exercises",children:Y.exercises.map((te,ze)=>r.jsxs("div",{className:"mg-overview-exercise",children:[r.jsx("span",{className:"mg-overview-ex-num",children:ze+1}),r.jsxs("div",{className:"mg-overview-ex-info",children:[r.jsx("span",{className:"mg-overview-ex-name",children:te.name}),Y.interval?r.jsxs("span",{className:"mg-overview-ex-detail",children:[Y.work,"s work / ",Y.rest,"s rest"]}):r.jsxs("span",{className:"mg-overview-ex-detail",children:[te.sets," sets  ",te.reps?`${te.reps} reps`:`${te.time}s`,te.type==="weighted"&&"  weighted"]})]})]},ze))})]}),r.jsxs("button",{className:"mg-overview-start-btn",onClick:()=>Z(Y),children:[r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M8 5v14l11-7z"})}),"Start Workout"]})]}),Is]})}if(k==="muscle_workout"){const Y=Fe;if(!Y)return null;const xe=Y.exercises[Ke],te=gt[Ke];if(!xe||!te)return null;const ze=te.sets.length,Ye=Y.exercises.length,ct=Y.exercises.reduce((ms,Wn)=>ms+(Wn.sets||0),0),Lt=gt.reduce((ms,Wn)=>ms+Wn.sets.length,0)/ct*100,vs=De[xe.name];xe.type==="timed"&&Se===0&&!Ts&&ze===Ct&&setTimeout(()=>Be(xe.time),0);const un=ze+1<xe.sets?"Log Set":Ke+1<Ye?"Log Set  Next Exercise":"Log Set  Complete";return r.jsxs("div",{className:"wk-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("div",{className:"mg-session-progress",children:r.jsx("div",{className:"mg-session-progress-fill",style:{width:`${Lt}%`}})}),r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>{confirm("End workout early?")&&j("muscle_overview")},"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsxs("span",{className:"mg-header-info",children:["Exercise ",Ke+1,"/",Ye]}),r.jsx("div",{style:{width:22}})]})}),r.jsxs("main",{className:"wk-main",children:[vs?r.jsxs("div",{className:"mg-video-container",onClick:$e,children:[vs.isGif?r.jsx("img",{className:"mg-video",src:vs.url,alt:xe.name}):r.jsx("video",{ref:wt,className:"mg-video",src:vs.url,loop:!0,muted:!0,playsInline:!0},xe.name),!et&&!vs.isGif&&r.jsxs("div",{className:"mg-video-overlay",children:[r.jsx("svg",{className:"mg-play-icon",width:"48",height:"48",viewBox:"0 0 24 24",fill:"rgba(255,255,255,0.9)",children:r.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})}),r.jsx("span",{className:"mg-video-hint",children:"Tap for demo"})]})]}):r.jsxs("div",{className:"mg-video-placeholder",children:[r.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",opacity:"0.4",children:[r.jsx("rect",{x:"2",y:"2",width:"20",height:"20",rx:"2.18",ry:"2.18"}),r.jsx("line",{x1:"7",y1:"2",x2:"7",y2:"22"}),r.jsx("line",{x1:"17",y1:"2",x2:"17",y2:"22"}),r.jsx("line",{x1:"2",y1:"12",x2:"22",y2:"12"}),r.jsx("line",{x1:"2",y1:"7",x2:"7",y2:"7"}),r.jsx("line",{x1:"2",y1:"17",x2:"7",y2:"17"}),r.jsx("line",{x1:"17",y1:"7",x2:"22",y2:"7"}),r.jsx("line",{x1:"17",y1:"17",x2:"22",y2:"17"})]}),r.jsx("span",{children:"Video coming soon"})]}),r.jsx("div",{className:"wk-spotify",children:r.jsx("iframe",{src:"https://open.spotify.com/embed/playlist/37i9dQZF1DZ06evO3FJyYF?utm_source=generator&theme=0",width:"100%",height:"80",frameBorder:"0",allow:"autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture",loading:"lazy",title:"Spotify Playlist"})}),r.jsxs("div",{className:"mg-exercise-card",children:[r.jsx("h2",{className:"mg-ex-name",children:xe.name}),r.jsx("span",{className:`mg-ex-type-badge ${xe.type}`,children:xe.type==="weighted"?"Weight + Reps":xe.type==="reps"?"Reps Only":"Timed"}),r.jsxs("div",{className:"mg-ex-set-info",children:[r.jsxs("span",{className:"mg-ex-set-num",children:["Set ",ze+1," of ",xe.sets]}),xe.type!=="timed"&&r.jsxs("span",{className:"mg-ex-target",children:["Target: ",xe.reps," reps"]}),xe.type==="timed"&&r.jsxs("span",{className:"mg-ex-target",children:["Target: ",xe.time,"s"]})]}),xe.type==="weighted"&&r.jsxs("div",{className:"mg-input-area",children:[r.jsxs("div",{className:"mg-input-group",children:[r.jsx("label",{children:"Weight (kg)"}),r.jsx("input",{type:"number",inputMode:"decimal",className:"mg-input",value:Bs,onChange:ms=>qt(ms.target.value),placeholder:"0"})]}),r.jsxs("div",{className:"mg-input-group",children:[r.jsx("label",{children:"Reps"}),r.jsx("input",{type:"number",inputMode:"numeric",className:"mg-input",value:Cs,onChange:ms=>is(ms.target.value),placeholder:"0"})]})]}),xe.type==="reps"&&r.jsx("div",{className:"mg-input-area",children:r.jsxs("div",{className:"mg-input-group mg-input-single",children:[r.jsx("label",{children:"Reps"}),r.jsx("input",{type:"number",inputMode:"numeric",className:"mg-input",value:Cs,onChange:ms=>is(ms.target.value),placeholder:"0"})]})}),xe.type==="timed"&&r.jsxs("div",{className:"mg-timer-area",children:[r.jsx("div",{className:"mg-timer-display",children:r.jsxs("span",{className:"mg-timer-value",children:[Se,"s"]})}),Ts?r.jsx("button",{className:"mg-timer-btn mg-timer-stop",onClick:()=>ce(!1),children:"Stop"}):r.jsx("button",{className:"mg-timer-btn",onClick:()=>{Se===0&&Be(xe.time),ce(!0)},children:Se<xe.time&&Se>0?"Resume":"Start Timer"})]}),r.jsx("button",{className:"mg-log-set-btn",onClick:Oe,children:un}),te.sets.length>0&&r.jsx("div",{className:"mg-completed-sets",children:te.sets.map((ms,Wn)=>r.jsxs("div",{className:"mg-completed-set",children:[r.jsx("span",{className:"mg-completed-set-check",children:""}),r.jsxs("span",{children:["Set ",Wn+1,": ",ms.weight!=null?`${ms.weight}kg  ${ms.reps}`:ms.reps!=null?`${ms.reps} reps`:`${ms.time}s`]})]},Wn))})]})]}),Is]})}if(k==="muscle_complete"){const Y=gt.reduce((ze,Ye)=>ze+Ye.sets.length,0),xe=gt.reduce((ze,Ye)=>ze+Ye.sets.reduce((ct,xt)=>ct+(xt.weight||0)*(xt.reps||0),0),0),te=Xc.find(ze=>ze.key===Zt)?.label||"";return r.jsxs("div",{className:"wk-page wk-page-center","data-theme":l?"dark":"light","data-accent":d,children:[r.jsxs("div",{className:"wk-complete",children:[r.jsxs("div",{className:"wk-complete-ring",children:[r.jsx("svg",{className:"wk-complete-svg",viewBox:"0 0 200 200",children:du.map((ze,Ye)=>r.jsx("line",{x1:ze.x1,y1:ze.y1,x2:ze.x2,y2:ze.y2,className:"wk-tick-complete",strokeWidth:ze.thick?"3.5":"2",style:{animationDelay:`${Ye*.02}s`}},Ye))}),r.jsx("div",{className:"wk-complete-center",children:r.jsx("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"#4caf50",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M20 6L9 17l-5-5"})})})]}),r.jsxs("h2",{className:"wk-complete-title",children:[te," Complete!"]}),r.jsx("p",{className:"mg-complete-session-name",children:Fe?.name}),r.jsxs("div",{className:"wk-complete-stats",children:[r.jsxs("div",{className:"wk-stat",children:[r.jsx("span",{className:"wk-stat-val",children:gt.length}),r.jsx("span",{className:"wk-stat-label",children:"Exercises"})]}),r.jsxs("div",{className:"wk-stat",children:[r.jsx("span",{className:"wk-stat-val",children:Y}),r.jsx("span",{className:"wk-stat-label",children:"Sets"})]}),xe>0&&r.jsxs("div",{className:"wk-stat",children:[r.jsx("span",{className:"wk-stat-val",children:Math.round(xe).toLocaleString()}),r.jsx("span",{className:"wk-stat-label",children:"Volume (kg)"})]})]}),r.jsx("div",{className:"wk-complete-actions",children:r.jsx("button",{className:"wk-btn-primary",onClick:()=>{Ze(null),Ae(null),be(null),j("menu")},children:"Done"})})]}),J&&r.jsx("div",{className:"mg-badge-celebration",onClick:()=>be(null),children:r.jsxs("div",{className:"mg-badge-celebration-card",children:[r.jsx("div",{className:"mg-badge-celebration-icon",children:r.jsx("svg",{viewBox:"0 0 24 24",width:"48",height:"48",fill:"#ffc107",children:r.jsx("polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"})})}),r.jsx("h3",{className:"mg-badge-celebration-title",children:J.badges.length===1?"Badge Earned!":`${J.badges.length} Badges Earned!`}),r.jsx("div",{className:"mg-badge-celebration-list",children:J.badges.map((ze,Ye)=>r.jsx("div",{className:"mg-badge-celebration-item",children:ze.type==="pb_target"?`${ze.exercise}  ${ze.targetWeight}kg`:ze.label},Ye))}),r.jsx("button",{className:"mg-badge-celebration-dismiss",children:"Tap to dismiss"})]})})]})}return null}const RD=60,AD={"Dumbbell Floor Press":"push","Seated Dumbbell Shoulder Press":"push","Seated Dumbbell Arnold Press":"push","Dumbbell Overhead Tricep Extension":"push",Skullcrushers:"push","Dumbbell Lateral Raise":"push","Dumbbell Front Raise":"push","Dumbbell Bent Over Row":"pull","Single Arm Bent Over Row":"pull","Bicep Curl":"pull","Hammer Curl":"pull","Dumbbell Bent Over Rear Delt Fly":"pull","Renegade Row":"pull","Dumbbell Goblet Squats":"lower","Romanian Deadlifts":"lower","Forward Dumbbell Lunges":"lower","Dumbbell Sumo Squats":"lower","Weighted Calf Raises":"lower","1 Legged RDL":"lower","Dumbbell Box Step Ups":"lower","Dumbbell Squat Pulses":"lower","Dumbbell Reverse Lunges":"lower","Kettlebell Romanian Deadlift":"lower","Russian Twists Dumbbell":"core","Kettlebell Russian Twist":"core","Kettlebell Side Bends":"core","Kneeling Kettlebell Halo":"core"},ID=[{threshold:1e3,label:"1 Tonne"},{threshold:5e3,label:"5 Tonne"},{threshold:1e4,label:"10 Tonne"},{threshold:25e3,label:"25 Tonne"},{threshold:5e4,label:"50 Tonne"},{threshold:1e5,label:"100 Tonne"},{threshold:25e4,label:"250 Tonne"},{threshold:5e5,label:"500 Tonne"},{threshold:1e6,label:"1 Million kg"}],k2=[{id:"fullbody_4wk",name:"4-Week Full Body",focus:"fullbody",duration:4,daysPerWeek:3,level:"All Levels",description:"Build total body strength with compound dumbbell movements and bodyweight finishers",repProg:2,timeProg:5,days:[{name:"Day 1",label:"Push Focus",exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:3,baseReps:10,pbKey:"chestPress",storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Seated Dumbbell Shoulder Press",type:"weighted",sets:3,baseReps:10,pbKey:"shoulderPress",storagePath:"exercises/dumbbells/upper/seated dumbbell shoulder press.mp4"},{name:"Dumbbell Goblet Squats",type:"weighted",sets:3,baseReps:10,pbKey:"squat",storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Press Up",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Mountain Climbers",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Mountain Climbers.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]},{name:"Day 2",label:"Pull Focus",exercises:[{name:"Dumbbell Bent Over Row",type:"weighted",sets:3,baseReps:10,pbKey:"seatedRow",storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Bicep Curl",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Romanian Deadlifts",type:"weighted",sets:3,baseReps:10,pbKey:"deadlift",storagePath:"exercises/dumbbells/lower/romanian deadlifts.GIF"},{name:"Reverse Lunge",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/lower/reverse lunge.GIF"},{name:"Russian Twist",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Russian Twist.mp4"},{name:"Side Plank",type:"timed",sets:2,baseTime:25,storagePath:"exercises/bodyweight/core/Side Plank.mp4"}]},{name:"Day 3",label:"Legs & Core",exercises:[{name:"Forward Dumbbell Lunges",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.GIF"},{name:"Dumbbell Sumo Squats",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/lower/dumbbell sumo squats.GIF"},{name:"Weighted Calf Raises",type:"weighted",sets:3,baseReps:15,storagePath:"exercises/dumbbells/lower/weighted calf raises.GIF"},{name:"Box Step Ups",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/lower/box step ups.GIF"},{name:"Burpee",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]}]},{id:"fullbody_8wk",name:"8-Week Full Body",focus:"fullbody",duration:8,daysPerWeek:3,level:"Intermediate",description:"Two-phase programme building strength and endurance across your full body",repProg:1,timeProg:3,days:[{name:"Day 1",label:"Strength",exercises:[{name:"Dumbbell Goblet Squats",type:"weighted",sets:4,baseReps:8,pbKey:"squat",storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Dumbbell Floor Press",type:"weighted",sets:4,baseReps:8,pbKey:"chestPress",storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Dumbbell Bent Over Row",type:"weighted",sets:4,baseReps:8,pbKey:"seatedRow",storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Seated Dumbbell Shoulder Press",type:"weighted",sets:3,baseReps:10,pbKey:"shoulderPress",storagePath:"exercises/dumbbells/upper/seated dumbbell shoulder press.mp4"},{name:"Mountain Climbers",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Mountain Climbers.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:35,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]},{name:"Day 2",label:"Power",exercises:[{name:"Romanian Deadlifts",type:"weighted",sets:4,baseReps:8,pbKey:"deadlift",storagePath:"exercises/dumbbells/lower/romanian deadlifts.GIF"},{name:"Forward Dumbbell Lunges",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.GIF"},{name:"Single Arm Bent Over Row",type:"weighted",sets:4,baseReps:8,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Hammer Curl",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/hammer curl.mp4"},{name:"Bulgarian Split Squats",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/lower/bulgarian split squats.GIF"},{name:"Russian Twist",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Russian Twist.mp4"}]},{name:"Day 3",label:"Endurance",exercises:[{name:"Dumbbell Sumo Squats",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/lower/dumbbell sumo squats.GIF"},{name:"Weighted Calf Raises",type:"weighted",sets:3,baseReps:15,storagePath:"exercises/dumbbells/lower/weighted calf raises.GIF"},{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Press Up",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Burpee",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:40,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]}]},{id:"fullbody_12wk",name:"12-Week Full Body",focus:"fullbody",duration:12,daysPerWeek:3,level:"Advanced",description:"Complete transformation programme: push, pull, and legs over three phases",repProg:1,timeProg:2,days:[{name:"Day 1",label:"Upper Push",exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:4,baseReps:8,pbKey:"chestPress",storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Seated Dumbbell Arnold Press",type:"weighted",sets:4,baseReps:8,storagePath:"exercises/dumbbells/upper/seated dumbbell arnold press.mp4"},{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Skullcrushers",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/skullcrushers.mp4"},{name:"Press Up",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]},{name:"Day 2",label:"Lower Body",exercises:[{name:"Dumbbell Goblet Squats",type:"weighted",sets:4,baseReps:8,pbKey:"squat",storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Romanian Deadlifts",type:"weighted",sets:4,baseReps:8,pbKey:"deadlift",storagePath:"exercises/dumbbells/lower/romanian deadlifts.GIF"},{name:"Forward Dumbbell Lunges",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.GIF"},{name:"Weighted Calf Raises",type:"weighted",sets:3,baseReps:15,storagePath:"exercises/dumbbells/lower/weighted calf raises.GIF"},{name:"Jump Squats",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/lower/jump squats.GIF"},{name:"Hollow Body Hold",type:"timed",sets:3,baseTime:30,storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"}]},{name:"Day 3",label:"Upper Pull",exercises:[{name:"Dumbbell Bent Over Row",type:"weighted",sets:4,baseReps:8,pbKey:"seatedRow",storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Single Arm Bent Over Row",type:"weighted",sets:4,baseReps:8,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Bicep Curl",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Burpee",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Side Plank",type:"timed",sets:2,baseTime:25,storagePath:"exercises/bodyweight/core/Side Plank.mp4"}]}]},{id:"core_4wk",name:"4-Week Core",focus:"core",duration:4,daysPerWeek:3,level:"Beginner",description:"Build a solid core foundation with targeted ab and stability work",repProg:2,timeProg:5,days:[{name:"Day 1",label:"Abs",exercises:[{name:"Crunch",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/core/Crunch.mp4"},{name:"Leg Raises",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Leg Raises.mp4"},{name:"Russian Twist",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Russian Twist.mp4"},{name:"Bicycle Crunch",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Bicycle Crunch.mp4"},{name:"Mountain Climbers",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Mountain Climbers.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]},{name:"Day 2",label:"Stability",exercises:[{name:"Dead Bug",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Dead Bug.mp4"},{name:"Bird Dog",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Bird Dog.mp4"},{name:"Side Plank",type:"timed",sets:2,baseTime:20,storagePath:"exercises/bodyweight/core/Side Plank.mp4"},{name:"Flutter Kicks",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Flutter Kicks.mp4"},{name:"Hollow Body Hold",type:"timed",sets:3,baseTime:20,storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"},{name:"High Plank Shoulder Taps",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/High Plank Shoulder Taps.mp4"}]},{name:"Day 3",label:"Power Core",exercises:[{name:"Single Leg V-Up",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Single Leg V-Up.mp4"},{name:"Toe Reaches",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/core/toe reaches.GIF"},{name:"Russian Twists Dumbbell",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/core/russian twists dumbbell.GIF"},{name:"Burpee",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Fast Mountain Climbers",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Fast Mountain Climbers.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]}]},{id:"core_8wk",name:"8-Week Core",focus:"core",duration:8,daysPerWeek:3,level:"Intermediate",description:"Develop deep core strength and rotational power over two phases",repProg:1,timeProg:3,days:[{name:"Day 1",label:"Anti-Extension",exercises:[{name:"Forearm Plank",type:"timed",sets:3,baseTime:35,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"},{name:"Dead Bug",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Dead Bug.mp4"},{name:"Plank Walkout",type:"reps",sets:3,baseReps:8,storagePath:"exercises/bodyweight/core/Plank Walkout.mp4"},{name:"Hollow Body Hold",type:"timed",sets:3,baseTime:25,storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"},{name:"Leg Raises",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Leg Raises.mp4"},{name:"Mountain Climbers",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Mountain Climbers.mp4"}]},{name:"Day 2",label:"Rotation",exercises:[{name:"Russian Twist",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Russian Twist.mp4"},{name:"Kettlebell Russian Twist",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/kettlebells/core/kettlebell russian twist.mp4"},{name:"Bicycle Crunch",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Bicycle Crunch.mp4"},{name:"Side Plank Rotation",type:"reps",sets:2,baseReps:10,storagePath:"exercises/bodyweight/core/Side Plank Rotation.mp4"},{name:"High Plank Shoulder Taps",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/core/High Plank Shoulder Taps.mp4"},{name:"Hollow Hold To V-Sit",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Hollow Hold To V-sit.mp4"}]},{name:"Day 3",label:"Power",exercises:[{name:"Crunch",type:"reps",sets:4,baseReps:15,storagePath:"exercises/bodyweight/core/Crunch.mp4"},{name:"Flutter Kicks",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Flutter Kicks.mp4"},{name:"Reverse Crunch To Leg Raise",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Reverse Crunch To Leg Raise.mp4"},{name:"Burpee",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Kettlebell Bird Dog Drag",type:"reps",sets:3,baseReps:10,storagePath:"exercises/kettlebells/core/kettlebell bird dog drag.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:40,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]}]},{id:"core_12wk",name:"12-Week Core",focus:"core",duration:12,daysPerWeek:3,level:"Advanced",description:"Ultimate core transformation: stability, strength, and power across three phases",repProg:1,timeProg:2,days:[{name:"Day 1",label:"Strength",exercises:[{name:"Forearm Plank",type:"timed",sets:4,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"},{name:"Plank Walkout",type:"reps",sets:4,baseReps:8,storagePath:"exercises/bodyweight/core/Plank Walkout.mp4"},{name:"Leg Raises",type:"reps",sets:4,baseReps:12,storagePath:"exercises/bodyweight/core/Leg Raises.mp4"},{name:"Kettlebell Side Bends",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/kettlebells/core/kettlebell side bends.mp4"},{name:"Dead Bug Single Leg Drop",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Dead Bug Single Leg Drop.mp4"},{name:"Hollow Body Hold",type:"timed",sets:3,baseTime:25,storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"}]},{name:"Day 2",label:"Endurance",exercises:[{name:"Crunch",type:"reps",sets:4,baseReps:15,storagePath:"exercises/bodyweight/core/Crunch.mp4"},{name:"Kettlebell Russian Twist",type:"weighted",sets:4,baseReps:15,storagePath:"exercises/kettlebells/core/kettlebell russian twist.mp4"},{name:"Bicycle Crunch",type:"reps",sets:3,baseReps:20,storagePath:"exercises/bodyweight/core/Bicycle Crunch.mp4"},{name:"Hollow Hold Flutter Kicks",type:"reps",sets:3,baseReps:25,storagePath:"exercises/bodyweight/core/Hollow Hold Flutter Kicks.mp4"},{name:"Cross Body Mountain Climbers",type:"reps",sets:3,baseReps:25,storagePath:"exercises/bodyweight/core/Cross Body Mountain Climbers.mp4"},{name:"Side Plank",type:"timed",sets:2,baseTime:25,storagePath:"exercises/bodyweight/core/Side Plank.mp4"}]},{name:"Day 3",label:"Power",exercises:[{name:"Hollow Hold To V-Sit",type:"reps",sets:4,baseReps:10,storagePath:"exercises/bodyweight/core/Hollow Hold To V-sit.mp4"},{name:"Reverse Crunch To Leg Raise",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Reverse Crunch To Leg Raise.mp4"},{name:"Burpee",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Hip Dips Plank",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/core/Hip Dips Plank.mp4"},{name:"Kneeling Kettlebell Halo",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/kettlebells/core/kneeling kettlebell halo.mp4"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:35,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]}]},{id:"upper_4wk",name:"4-Week Upper Body",focus:"upper",duration:4,daysPerWeek:3,level:"Intermediate",description:"Sculpt and strengthen your chest, back, shoulders, and arms",repProg:2,timeProg:5,days:[{name:"Day 1",label:"Push",exercises:[{name:"Dumbbell Floor Press",type:"weighted",sets:4,baseReps:10,pbKey:"chestPress",storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Seated Dumbbell Shoulder Press",type:"weighted",sets:3,baseReps:10,pbKey:"shoulderPress",storagePath:"exercises/dumbbells/upper/seated dumbbell shoulder press.mp4"},{name:"Dumbbell Overhead Tricep Extension",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Tricep Dips",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/upper/tricep dips.mp4"},{name:"Pike Push Ups",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/upper/pike push ups.GIF"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]},{name:"Day 2",label:"Pull",exercises:[{name:"Dumbbell Bent Over Row",type:"weighted",sets:4,baseReps:10,pbKey:"seatedRow",storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Single Arm Bent Over Row",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Bicep Curl",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Hammer Curl",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/hammer curl.mp4"},{name:"Reverse Plank",type:"timed",sets:3,baseTime:20,storagePath:"exercises/bodyweight/upper/reverse plank.GIF"}]},{name:"Day 3",label:"Mixed",exercises:[{name:"Seated Dumbbell Arnold Press",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/seated dumbbell arnold press.mp4"},{name:"Dumbbell Lateral Raise",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/dumbbell lateral raise.mp4"},{name:"Dumbbell Front Raise",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/upper/dumbbell front raise.mp4"},{name:"Press Up",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Renegade Row",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/upper/renegade row.mp4"},{name:"Superman Hold",type:"timed",sets:3,baseTime:30,storagePath:"exercises/bodyweight/core/Superman Hold.mp4"}]}]},{id:"lower_4wk",name:"4-Week Lower Body",focus:"lower",duration:4,daysPerWeek:3,level:"Intermediate",description:"Build powerful legs and glutes with squats, deadlifts, and plyometrics",repProg:2,timeProg:5,days:[{name:"Day 1",label:"Quad Dominant",exercises:[{name:"Dumbbell Goblet Squats",type:"weighted",sets:4,baseReps:10,pbKey:"squat",storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Forward Dumbbell Lunges",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.GIF"},{name:"Dumbbell Box Step Ups",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/lower/dumbbell box step ups.mp4"},{name:"Dumbbell Squat Pulses",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/lower/dumbbell squat pulses.GIF"},{name:"Jump Squats",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/lower/jump squats.GIF"},{name:"Squat And Hold",type:"timed",sets:3,baseTime:30,storagePath:"exercises/bodyweight/lower/squat and hold.GIF"}]},{name:"Day 2",label:"Hamstring & Glute",exercises:[{name:"Romanian Deadlifts",type:"weighted",sets:4,baseReps:8,pbKey:"deadlift",storagePath:"exercises/dumbbells/lower/romanian deadlifts.GIF"},{name:"1 Legged RDL",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/lower/1 legged rdl.GIF"},{name:"Hip Thrusts",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/lower/hip thrusts.GIF"},{name:"Dumbbell Reverse Lunges",type:"weighted",sets:3,baseReps:12,storagePath:"exercises/dumbbells/lower/dumbbell reverse lunges.GIF"},{name:"Donkey Kicks",type:"reps",sets:3,baseReps:15,storagePath:"exercises/bodyweight/lower/donkey kicks.GIF"},{name:"Forearm Plank",type:"timed",sets:3,baseTime:30,pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"}]},{name:"Day 3",label:"Power & Stability",exercises:[{name:"Dumbbell Sumo Squats",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/dumbbells/lower/dumbbell sumo squats.GIF"},{name:"Kettlebell Romanian Deadlift",type:"weighted",sets:3,baseReps:10,storagePath:"exercises/kettlebells/lower/kettlebell romanian deadlift.mp4"},{name:"Weighted Calf Raises",type:"weighted",sets:3,baseReps:15,storagePath:"exercises/dumbbells/lower/weighted calf raises.GIF"},{name:"Bulgarian Split Squats",type:"reps",sets:3,baseReps:10,storagePath:"exercises/bodyweight/lower/bulgarian split squats.GIF"},{name:"Skater Jumps",type:"reps",sets:3,baseReps:12,storagePath:"exercises/bodyweight/lower/skater jumps.GIF"},{name:"Side Plank",type:"timed",sets:2,baseTime:25,storagePath:"exercises/bodyweight/core/Side Plank.mp4"}]}]}];function oh(n,e,t){const i=n.baseReps?n.baseReps+(e-1)*(t.repProg||0):void 0,l=n.baseTime?n.baseTime+(e-1)*(t.timeProg||0):void 0;return{sets:n.sets,reps:i,time:l}}const MD={fullbody:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm-2 8h4l1 4h2l-1 4h-2l-1 4h-2l-1-4H8l-1-4h2l1-4z",core:"M12 2a4 4 0 0 1 4 4v1h-2V6a2 2 0 1 0-4 0v1H8V6a4 4 0 0 1 4-4zM8 9h8v2H8V9zm-1 4h10l-1 9H8l-1-9z",upper:"M12 2a3 3 0 0 1 3 3 3 3 0 0 1-3 3 3 3 0 0 1-3-3 3 3 0 0 1 3-3zm8 10l-3-1.5c-.5-.25-1-.5-1.5-.5h-7c-.5 0-1 .25-1.5.5L4 12l-2 6h4l1.5 4h9L18 18h4l-2-6z",lower:"M16.5 3A2.5 2.5 0 0 0 14 5.5 2.5 2.5 0 0 0 16.5 8 2.5 2.5 0 0 0 19 5.5 2.5 2.5 0 0 0 16.5 3zM14 9l-3 7h2l1 6h2l1-6h2l-3-7h-2z"};function DD(){const{currentUser:n,isClient:e,clientData:t,loading:i}=Mr(),{isDark:l,toggleTheme:u,accent:d}=ka(),p=$n(),g=_a(),[y,w]=v.useState("loading"),[k,j]=v.useState(null),O=v.useRef(!1),[H,B]=v.useState(null),[V,se]=v.useState(1),[K,oe]=v.useState(0),[ye,Pe]=v.useState(0),[Ee,R]=v.useState(0),[T,A]=v.useState([]),[L,D]=v.useState(""),[z,M]=v.useState(""),[Ge,mt]=v.useState(!1),[$,pe]=v.useState(0),Me=v.useRef(null),[Qe,X]=v.useState({}),[P,re]=v.useState(!1),Re=v.useRef(null),[Le,tt]=v.useState(null),[qe,ft]=v.useState([]);v.useEffect(()=>{window.scrollTo(0,0)},[y]);const[kt,rt]=v.useState(null),Wt=v.useCallback((ce,Se="info")=>{rt({message:ce,type:Se}),setTimeout(()=>rt(null),4e3)},[]),_s=v.useRef(null),At=()=>(_s.current||(_s.current=new(window.AudioContext||window.webkitAudioContext)),_s.current),pt=()=>{try{const ce=At(),Se=ce.createOscillator(),Be=ce.createGain();Se.connect(Be),Be.connect(ce.destination),Se.frequency.value=1200,Be.gain.value=.4,Se.start(ce.currentTime),Se.stop(ce.currentTime+.3)}catch{}};v.useEffect(()=>{!i&&(!n||!e)&&p("/")},[n,e,i,p]),v.useEffect(()=>{if(!t)return;(async()=>{try{const Se=We(fe,"clientProgrammes",t.id),Be=await Ns(Se);Be.exists()&&B(Be.data());const et=g.state?.templateId;if(et&&!O.current){const Ue=k2.find(De=>De.id===et);if(Ue){O.current=!0,j(Ue),w("overview");return}}Be.exists()?w("dashboard"):p("/client/core-buddy/workouts",{replace:!0})}catch(Se){console.error("Error loading programme:",Se),p("/client/core-buddy/workouts",{replace:!0})}})()},[t]),v.useEffect(()=>{if(!Ge||$<=0){Ge&&$<=0&&(mt(!1),pt());return}return Me.current=setTimeout(()=>pe(ce=>ce-1),1e3),()=>clearTimeout(Me.current)},[Ge,$]);const ue=async ce=>{if(t)try{await Ss(We(fe,"clientProgrammes",t.id),ce),B(ce)}catch(Se){console.error("Error saving programme:",Se),Wt("Failed to save. Check Firestore rules for clientProgrammes.","error")}},Zt=async ce=>{const Se={templateId:ce.id,startDate:vt.now(),completedSessions:{}};await ue(Se),w("dashboard")},Ae=async()=>{if(t)try{await yr(We(fe,"clientProgrammes",t.id)),B(null),w("browse")}catch(ce){console.error("Error quitting programme:",ce)}},Fe=()=>H?k2.find(ce=>ce.id===H.templateId):null,Ze=()=>{if(!H?.startDate)return 1;const ce=H.startDate.toDate?H.startDate.toDate():new Date(H.startDate),Be=new Date-ce,et=Math.floor(Be/(1e3*60*60*24));return Math.floor(et/7)+1},Ke=()=>{if(!H)return{currentWeek:1,completedThisWeek:0,nextDay:0,totalCompleted:0};const ce=H.completedSessions||{},Se=Object.keys(ce).length,Be=Fe();if(!Be)return{currentWeek:1,completedThisWeek:0,nextDay:0,totalCompleted:0};const et=Be.duration*Be.daysPerWeek,Ue=Ze(),De=Math.min(Ue,Be.duration);let He=0;for(let yt=0;yt<Be.daysPerWeek;yt++)ce[`w${De}d${yt}`]&&He++;if(Se>=et)return{currentWeek:Be.duration,completedThisWeek:Be.daysPerWeek,nextDay:-1,totalCompleted:Se,totalSessions:et,complete:!0};if(Ue>Be.duration)return{currentWeek:Be.duration,completedThisWeek:He,nextDay:-1,totalCompleted:Se,totalSessions:et,complete:!0};let wt=-1;for(let yt=0;yt<Be.daysPerWeek;yt++)if(!ce[`w${De}d${yt}`]){wt=yt;break}return{currentWeek:De,completedThisWeek:He,nextDay:wt,nextWeek:De,totalCompleted:Se,totalSessions:et}},Xe=ce=>{const Se=Ze();return ce<Se},Ct=(ce,Se,Be)=>{if(!H||ce<=1)return null;const et=`w${ce-1}d${Se}`,Ue=H.completedSessions?.[et];if(!Ue)return null;const De=Ue.exercises?.find(He=>He.name===Be);return De?.sets?.length?De.sets[De.sets.length-1]:null},zs=(ce,Se)=>{const Be=Fe();if(!Be)return;se(ce),oe(Se),Pe(0),R(0),A([]),M(""),mt(!1),pe(0),re(!1),X({});const et=Be.days[Se],Ue=et.exercises.map(yt=>{const Mt=oh(yt,ce,Be);return{name:yt.name,type:yt.type,pbKey:yt.pbKey,targetSets:Mt.sets,targetReps:Mt.reps,targetTime:Mt.time,sets:[]}});A(Ue);const De=et.exercises[0],He=Ct(ce,Se,De.name);He?.weight&&De.type==="weighted"?D(String(He.weight)):D(""),(async()=>{const yt={};for(const Mt of et.exercises)if(Mt.storagePath)try{const Yt=eo(to,Mt.storagePath),J=await qo(Yt);yt[Mt.name]={url:J,isGif:/\.gif$/i.test(Mt.storagePath)}}catch(Yt){console.warn(`Video not found for ${Mt.name}:`,Yt)}X(yt)})(),w("session")},gt=async()=>{Fe();const ce=T[ye];if(!ce)return;let Se={};if(ce.type==="weighted"){const Ue=parseFloat(L)||0,De=parseInt(z)||0;if(De===0){Wt("Enter your reps","error");return}Se={weight:Ue,reps:De}}else if(ce.type==="reps"){const Ue=parseInt(z)||0;if(Ue===0){Wt("Enter your reps","error");return}Se={reps:Ue}}else if(ce.type==="timed"){const Ue=ce.targetTime-$;Se={time:Math.max(Ue,1)}}const Be=[...T];Be[ye]={...ce,sets:[...ce.sets,Se]},A(Be),ce.type==="weighted"&&Se.weight>0&&await qt(ce.name,Se.weight,Se.reps);const et=ce.sets.length+1;if(et<ce.targetSets)R(et),D(Se.weight?String(Se.weight):""),M(""),mt(!1),pe(0);else if(ye+1<T.length){const Ue=ye+1;Pe(Ue),R(0),re(!1);const He=Fe()?.days[K]?.exercises[Ue],wt=Ct(V,K,He?.name);wt?.weight&&He?.type==="weighted"?D(String(wt.weight)):D(""),M(""),mt(!1),pe(0)}else await Ut(Be)},Ut=async ce=>{if(!H||!t)return;const Se=`w${V}d${K}`,Be={...H.completedSessions,[Se]:{completedAt:new Date().toISOString(),exercises:ce.map(De=>({name:De.name,type:De.type,sets:De.sets}))}},et={...H,completedSessions:Be};await ue(et);const Ue=ce.reduce((De,He)=>De+He.sets.reduce((wt,yt)=>wt+(yt.weight||0)*(yt.reps||0),0),0);Ue>0&&await Bs(Ue);try{const De=Fe();await hi($t(fe,"workoutLogs"),{clientId:t.id,type:"programme",programmeId:De?.id,programmeName:De?.name,week:V,day:K+1,exerciseCount:ce.length,duration:Math.round(ce.reduce((He,wt)=>He+wt.sets.length*1.5,0)),volume:Math.round(Ue),completedAt:vt.now()})}catch(De){console.error("Error saving workout log:",De)}qe.length>0&&(tt({badges:[...qe]}),ft([])),w("sessionComplete")},Bs=async ce=>{if(t)try{const Se=await Ns(We(fe,"coreBuddyAchievements",t.id)),Be=Se.exists()?Se.data():{clientId:t.id,badges:[],totalVolume:0},et=Be.totalVolume||0,Ue=et+ce,De=[];ID.forEach(wt=>{Ue>=wt.threshold&&et<wt.threshold&&(Be.badges.some(Mt=>Mt.type==="volume_milestone"&&Mt.milestone===wt.threshold)||De.push({type:"volume_milestone",milestone:wt.threshold,label:wt.label,achievedAt:vt.now()}))});const He=[...Be.badges,...De];await Ss(We(fe,"coreBuddyAchievements",t.id),{clientId:t.id,badges:He,totalVolume:Math.round(Ue),updatedAt:vt.now()}),De.length>0&&ft(wt=>[...wt,...De])}catch(Se){console.error("Error updating volume:",Se)}},qt=async(ce,Se,Be)=>{if(t)try{const et=t.id,Ue=await Ns(We(fe,"coreBuddyPBs",et)),He=(Ue.exists()?Ue.data():null)?.exercises||{},wt=He[ce];let yt=!1;if(wt?(Se>(wt.weight||0)||Se===(wt.weight||0)&&Be>(wt.reps||0))&&(yt=!0):yt=!0,yt){const Mt={...He,[ce]:{weight:Se,reps:Be,achievedAt:vt.now()}};await Ss(We(fe,"coreBuddyPBs",et),{clientId:t.id,exercises:Mt,updatedAt:vt.now()}),Wt(`New PB! ${Se}kg  ${Be} reps`,"success"),pt(),await Cs(ce,Se)}}catch(et){console.error("Error checking PB:",et)}},Cs=async(ce,Se)=>{if(t)try{const Be=await Ns(We(fe,"coreBuddyTargets",t.id));if(!Be.exists())return;const Ue=(Be.data().targets||{})[ce];if(!Ue||Se<Ue.targetWeight)return;const De=await Ns(We(fe,"coreBuddyAchievements",t.id)),He=De.exists()?De.data():{clientId:t.id,badges:[],totalVolume:0};if(He.badges.some(Yt=>Yt.type==="pb_target"&&Yt.exercise===ce&&Yt.targetWeight===Ue.targetWeight))return;const yt={type:"pb_target",exercise:ce,group:AD[ce]||"push",targetWeight:Ue.targetWeight,achievedAt:vt.now()},Mt=[...He.badges,yt];await Ss(We(fe,"coreBuddyAchievements",t.id),{...He,badges:Mt,updatedAt:vt.now()}),ft(Yt=>[...Yt,yt])}catch(Be){console.error("Error checking target badge:",Be)}},is=kt&&r.jsxs("div",{className:`toast-notification ${kt.type}`,children:[kt.type==="success"&&r.jsx("span",{children:" "}),kt.message]}),Ts=(ce,Se)=>r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:Se,"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})});if(i||y==="loading")return r.jsx("div",{className:"cb-loading",children:r.jsx("div",{className:"cb-loading-spinner"})});if(y==="browse")return p("/client/core-buddy/workouts",{replace:!0}),null;if(y==="overview"&&k){const ce=k;return r.jsx(xa,{children:r.jsxs("div",{className:"pg-page","data-theme":l?"dark":"light","data-accent":d,children:[Ts(ce.name,()=>p("/client/core-buddy/workouts")),r.jsxs("main",{className:"pg-main",children:[r.jsxs("div",{className:"pg-overview-hero",children:[r.jsx("svg",{className:"pg-overview-icon",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:MD[ce.focus]})}),r.jsx("h2",{className:"pg-overview-name",children:ce.name}),r.jsx("p",{className:"pg-overview-desc",children:ce.description}),r.jsxs("div",{className:"pg-overview-stats",children:[r.jsxs("div",{className:"pg-ov-stat",children:[r.jsx("span",{className:"pg-ov-stat-num",children:ce.duration}),r.jsx("span",{className:"pg-ov-stat-label",children:"Weeks"})]}),r.jsxs("div",{className:"pg-ov-stat",children:[r.jsx("span",{className:"pg-ov-stat-num",children:ce.daysPerWeek}),r.jsx("span",{className:"pg-ov-stat-label",children:"Days/Week"})]}),r.jsxs("div",{className:"pg-ov-stat",children:[r.jsx("span",{className:"pg-ov-stat-num",children:ce.duration*ce.daysPerWeek}),r.jsx("span",{className:"pg-ov-stat-label",children:"Sessions"})]})]})]}),r.jsx("div",{className:"pg-overview-days",children:ce.days.map((Se,Be)=>r.jsxs("div",{className:"pg-day-card",children:[r.jsxs("div",{className:"pg-day-header",children:[r.jsx("span",{className:"pg-day-name",children:Se.name}),r.jsx("span",{className:"pg-day-label",children:Se.label})]}),r.jsx("div",{className:"pg-day-exercises",children:Se.exercises.map((et,Ue)=>{const De=oh(et,1,ce);return r.jsxs("div",{className:"pg-day-ex",children:[r.jsx("span",{className:"pg-day-ex-name",children:et.name}),r.jsx("span",{className:"pg-day-ex-target",children:et.type==="timed"?`${De.sets}${De.time}s`:`${De.sets}${De.reps}`}),r.jsx("span",{className:`pg-day-ex-badge pg-badge-${et.type}`,children:et.type==="weighted"?"WT":et.type==="timed"?"TMR":"BW"})]},Ue)})})]},Be))}),r.jsxs("div",{className:"pg-overview-note",children:[r.jsx("strong",{children:"Progressive Overload:"})," +",ce.repProg," reps/week",ce.timeProg?`, +${ce.timeProg}s/week for timed`:""]}),r.jsx("button",{className:"pg-start-btn",onClick:()=>Zt(ce),children:"Start Programme"})]}),is]})})}if(y==="dashboard"){const ce=Fe();if(!ce)return w("browse"),null;const Se=Ke(),Be=H?.completedSessions||{},et=Se.totalSessions?Math.round(Se.totalCompleted/Se.totalSessions*100):0;return Math.round(Se.totalCompleted/(Se.totalSessions||1)*RD),r.jsx(xa,{children:r.jsxs("div",{className:"pg-page","data-theme":l?"dark":"light","data-accent":d,children:[Ts("Programme",()=>p("/client/core-buddy/workouts")),r.jsxs("main",{className:"pg-main",children:[r.jsxs("div",{className:"pg-dash-hero",children:[r.jsxs("div",{className:"pg-dash-ring-wrap",children:[r.jsxs("svg",{viewBox:"0 0 200 200",children:[r.jsx("circle",{className:"pg-arc-track",cx:"100",cy:"100",r:"80"}),r.jsx("circle",{className:"pg-arc-fill",cx:"100",cy:"100",r:"80",strokeDasharray:2*Math.PI*80,strokeDashoffset:2*Math.PI*80-et/100*2*Math.PI*80})]}),r.jsxs("div",{className:"pg-ring-center",children:[r.jsxs("span",{className:"pg-ring-pct",children:[et,"%"]}),r.jsx("span",{className:"pg-ring-label",children:"complete"})]})]}),r.jsx("h2",{className:"pg-dash-name",children:ce.name}),r.jsxs("div",{className:"pg-dash-progress-text",children:[r.jsxs("span",{className:"pg-dash-pct",children:[et,"%"]}),r.jsxs("span",{className:"pg-dash-week",children:["Week ",Se.currentWeek," of ",ce.duration]})]})]}),r.jsx("div",{className:"pg-weeks",children:Array.from({length:ce.duration},(Ue,De)=>{const He=De+1,wt=Xe(He);return r.jsxs("div",{className:`pg-week-row${He===Se.currentWeek?" pg-week-current":""}`,children:[r.jsxs("span",{className:"pg-week-label",children:["W",He]}),r.jsx("div",{className:"pg-week-days",children:ce.days.map((yt,Mt)=>{const Yt=`w${He}d${Mt}`,J=!!Be[Yt],be=!J&&wt,it=!J&&!be&&He===Se.currentWeek&&!Se.complete;return r.jsx("button",{className:`pg-day-dot${J?" done":""}${be?" missed":""}${it?" next":""}`,disabled:!it,onClick:()=>{it&&zs(He,Mt)},children:J?r.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:r.jsx("path",{d:"M20 6L9 17l-5-5"})}):be?r.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]}):r.jsx("span",{children:yt.name.replace("Day ","")})},Mt)})})]},De)})}),!Se.complete&&(()=>{const Ue=ce.days.map((De,He)=>({day:De,d:He})).filter(({d:De})=>!Be[`w${Se.currentWeek}d${De}`]);return Ue.length===0?null:r.jsxs("div",{className:"pg-next-session",children:[r.jsx("h3",{children:Ue.length===ce.daysPerWeek?"Choose a Session":"Remaining Sessions"}),r.jsxs("p",{className:"pg-next-info",children:["Week ",Se.currentWeek,"  ",Ue.length," session",Ue.length!==1?"s":""," left this week"]}),Ue.map(({day:De,d:He})=>r.jsxs("div",{className:"pg-available-session",children:[r.jsxs("div",{className:"pg-next-exercises",children:[r.jsxs("span",{className:"pg-avail-day-label",children:[De.name,": ",De.label]}),De.exercises.map((wt,yt)=>{const Mt=oh(wt,Se.currentWeek,ce);return r.jsxs("div",{className:"pg-next-ex",children:[r.jsx("span",{className:"pg-next-ex-name",children:wt.name}),r.jsx("span",{className:"pg-next-ex-target",children:wt.type==="timed"?`${Mt.sets}${Mt.time}s`:`${Mt.sets}${Mt.reps}`})]},yt)})]}),r.jsxs("button",{className:"pg-start-btn",onClick:()=>zs(Se.currentWeek,He),children:["Start ",De.name]})]},He))]})})(),Se.complete&&r.jsxs("div",{className:"pg-complete-msg",children:[r.jsx("h3",{children:"Programme Complete! "}),r.jsxs("p",{children:["You finished all ",Se.totalSessions," sessions."]}),r.jsx("button",{className:"pg-start-btn",onClick:Ae,children:"Choose New Programme"})]}),r.jsx("button",{className:"pg-quit-btn",onClick:()=>{confirm("Quit this programme? Progress will be lost.")&&Ae()},children:"Quit Programme"})]}),r.jsx(aa,{active:"workouts"}),is]})})}if(y==="session"){const ce=Fe();if(!ce)return null;const Se=ce.days[K],Be=Se.exercises[ye],et=oh(Be,V,ce),Ue=T[ye],De=Ue?.sets?.length||0,He=Se.exercises.length,wt=(ye+De/et.sets)/He,yt=Qe[Be.name],Mt=Ct(V,K,Be.name);Be.type==="timed"&&$===0&&!Ge&&De===Ee&&setTimeout(()=>pe(et.time),0);const Yt=()=>{yt?.isGif?re(!P):Re.current&&(P?Re.current.pause():Re.current.play(),re(!P))};return r.jsxs("div",{className:"pg-page pg-page-session","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("div",{className:"pg-session-progress",children:r.jsx("div",{className:"pg-session-progress-fill",style:{width:`${wt*100}%`}})}),r.jsxs("div",{className:"pg-session-header",children:[r.jsx("button",{className:"pg-session-back",onClick:()=>{confirm("Leave session? Progress will be lost.")&&w("dashboard")},children:r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M19 12H5M12 5l-7 7 7 7"})})}),r.jsxs("div",{className:"pg-session-title",children:[r.jsxs("span",{className:"pg-session-counter",children:[ye+1," / ",He]}),r.jsxs("span",{className:"pg-session-week",children:["Week ",V,"  ",Se.name]})]})]}),yt&&r.jsxs("div",{className:"pg-video-container",onClick:Yt,children:[yt.isGif?r.jsx("img",{className:"pg-video",src:yt.url,alt:Be.name}):r.jsx("video",{ref:Re,className:"pg-video",src:yt.url,loop:!0,muted:!0,playsInline:!0},Be.name),!P&&r.jsxs("div",{className:"pg-video-overlay",children:[r.jsx("svg",{className:"pg-play-icon",viewBox:"0 0 24 24",fill:"white",children:r.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})}),r.jsx("span",{className:"pg-video-hint",children:"Tap for demo"})]})]}),r.jsx("div",{className:"pg-spotify",children:r.jsx("iframe",{src:"https://open.spotify.com/embed/playlist/37i9dQZF1DZ06evO3FJyYF?utm_source=generator&theme=0",width:"100%",height:"80",frameBorder:"0",allow:"autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture",loading:"lazy",title:"Spotify Playlist"})}),r.jsxs("div",{className:"pg-exercise-card",children:[r.jsx("h2",{className:"pg-ex-name",children:Be.name}),r.jsx("span",{className:`pg-ex-type-badge pg-badge-${Be.type}`,children:Be.type==="weighted"?"Weight + Reps":Be.type==="timed"?"Timed":"Reps Only"}),Be.type==="weighted"&&Mt&&r.jsxs("div",{className:"pg-last-week",children:[r.jsx("span",{className:"pg-last-week-label",children:"Last week:"}),r.jsxs("span",{className:"pg-last-week-value",children:[Mt.weight,"kg x ",Mt.reps," reps"]})]}),r.jsxs("div",{className:"pg-ex-set-info",children:[r.jsxs("span",{className:"pg-ex-set-num",children:["Set ",De+1," of ",et.sets]}),r.jsxs("span",{className:"pg-ex-target",children:["Target: ",Be.type==="timed"?`${et.time}s hold`:`${et.reps} reps`]})]}),Be.type==="weighted"&&r.jsxs("div",{className:"pg-input-area",children:[r.jsxs("div",{className:"pg-input-group",children:[r.jsx("label",{children:"Weight (kg)"}),r.jsx("input",{type:"number",inputMode:"decimal",value:L,onChange:J=>D(J.target.value),placeholder:"0",className:"pg-input"})]}),r.jsxs("div",{className:"pg-input-group",children:[r.jsx("label",{children:"Reps"}),r.jsx("input",{type:"number",inputMode:"numeric",value:z,onChange:J=>M(J.target.value),placeholder:String(et.reps),className:"pg-input"})]})]}),Be.type==="reps"&&r.jsx("div",{className:"pg-input-area",children:r.jsxs("div",{className:"pg-input-group pg-input-single",children:[r.jsx("label",{children:"Reps"}),r.jsx("input",{type:"number",inputMode:"numeric",value:z,onChange:J=>M(J.target.value),placeholder:String(et.reps),className:"pg-input"})]})}),Be.type==="timed"&&r.jsxs("div",{className:"pg-timer-area",children:[r.jsx("div",{className:"pg-timer-display",children:r.jsxs("span",{className:"pg-timer-value",children:[$,"s"]})}),Ge?r.jsx("button",{className:"pg-timer-btn pg-timer-stop",onClick:()=>mt(!1),children:"Stop"}):r.jsx("button",{className:"pg-timer-btn",onClick:()=>{$===0&&pe(et.time),mt(!0)},children:$<et.time&&$>0?"Resume":"Start Timer"})]}),r.jsx("button",{className:"pg-log-set-btn",onClick:gt,disabled:Be.type==="timed"&&Ge,children:De+1<et.sets?"Log Set":ye+1<He?"Log Set  Next Exercise":"Log Set  Complete"}),Ue?.sets?.length>0&&r.jsx("div",{className:"pg-completed-sets",children:Ue.sets.map((J,be)=>r.jsxs("div",{className:"pg-completed-set",children:[r.jsx("span",{className:"pg-completed-set-check",children:""}),r.jsxs("span",{children:["Set ",be+1,": ",J.weight!==void 0?`${J.weight}kg  ${J.reps}`:J.time!==void 0?`${J.time}s`:`${J.reps} reps`]})]},be))})]}),is]})}if(y==="sessionComplete"){const Se=Fe()?.days[K],Be=T.reduce((Ue,De)=>Ue+De.sets.length,0),et=T.reduce((Ue,De)=>Ue+De.sets.reduce((He,wt)=>He+(wt.weight||0)*(wt.reps||0),0),0);return r.jsxs("div",{className:"pg-page pg-page-center","data-theme":l?"dark":"light","data-accent":d,children:[r.jsxs("div",{className:"pg-session-done",children:[r.jsxs("div",{className:"pg-done-ring",children:[r.jsx("svg",{className:"pg-done-ring-svg",viewBox:"0 0 200 200",children:du.map((Ue,De)=>r.jsx("line",{x1:Ue.x1,y1:Ue.y1,x2:Ue.x2,y2:Ue.y2,className:"pg-tick-complete",strokeWidth:Ue.thick?"3.5":"2",style:{animationDelay:`${De*.02}s`}},De))}),r.jsx("div",{className:"pg-done-center",children:r.jsx("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"#4caf50",strokeWidth:"2.5",strokeLinecap:"round",children:r.jsx("path",{d:"M20 6L9 17l-5-5"})})})]}),r.jsx("h2",{className:"pg-done-title",children:"Session Complete!"}),r.jsxs("p",{className:"pg-done-subtitle",children:["Week ",V,"  ",Se?.name,": ",Se?.label]}),r.jsxs("div",{className:"pg-done-stats",children:[r.jsxs("div",{className:"pg-done-stat",children:[r.jsx("span",{className:"pg-done-stat-num",children:T.length}),r.jsx("span",{className:"pg-done-stat-label",children:"Exercises"})]}),r.jsxs("div",{className:"pg-done-stat",children:[r.jsx("span",{className:"pg-done-stat-num",children:Be}),r.jsx("span",{className:"pg-done-stat-label",children:"Sets"})]}),et>0&&r.jsxs("div",{className:"pg-done-stat",children:[r.jsx("span",{className:"pg-done-stat-num",children:Math.round(et).toLocaleString()}),r.jsx("span",{className:"pg-done-stat-label",children:"Volume (kg)"})]})]}),r.jsx("button",{className:"pg-start-btn",onClick:()=>w("dashboard"),children:"Back to Programme"})]}),Le&&r.jsx("div",{className:"pg-badge-celebration",onClick:()=>tt(null),children:r.jsxs("div",{className:"pg-badge-celebration-card",onClick:Ue=>Ue.stopPropagation(),children:[r.jsx("div",{className:"pg-badge-celebration-icon",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),r.jsx("h3",{className:"pg-badge-celebration-title",children:Le.badges.length===1?"Badge Earned!":`${Le.badges.length} Badges Earned!`}),r.jsx("div",{className:"pg-badge-celebration-list",children:Le.badges.map((Ue,De)=>r.jsx("div",{className:"pg-badge-celebration-item",children:Ue.type==="pb_target"?`${Ue.exercise}  ${Ue.targetWeight}kg`:Ue.label},De))}),r.jsx("button",{className:"pg-badge-celebration-dismiss",onClick:()=>tt(null),children:"Tap to dismiss"})]})}),is]})}return null}const PD={"Dumbbell Floor Press":"push","Seated Dumbbell Shoulder Press":"push","Seated Dumbbell Arnold Press":"push","Dumbbell Overhead Tricep Extension":"push",Skullcrushers:"push","Dumbbell Lateral Raise":"push","Dumbbell Front Raise":"push","Dumbbell Bent Over Row":"pull","Single Arm Bent Over Row":"pull","Bicep Curl":"pull","Hammer Curl":"pull","Dumbbell Bent Over Rear Delt Fly":"pull","Renegade Row":"pull","Dumbbell Goblet Squats":"lower","Romanian Deadlifts":"lower","Forward Dumbbell Lunges":"lower","Dumbbell Sumo Squats":"lower","Weighted Calf Raises":"lower","1 Legged RDL":"lower","Dumbbell Box Step Ups":"lower","Dumbbell Squat Pulses":"lower","Dumbbell Reverse Lunges":"lower","Kettlebell Romanian Deadlift":"lower","Russian Twists Dumbbell":"core","Kettlebell Russian Twist":"core","Kettlebell Side Bends":"core","Kneeling Kettlebell Halo":"core"},LD={push:{label:"Push",color:"#c75f6b",icon:"M4 12h3l3-9 4 18 3-9h3"},pull:{label:"Pull",color:"#5f8ac7",icon:"M12 2v10m0 0l-4-4m4 4l4-4M4 20h16"},lower:{label:"Lower",color:"#5fc77a",icon:"M12 2v8m-4 4l4 8 4-8m-8 0h8"},core:{label:"Core",color:"#c7a45f",icon:"M12 2a4 4 0 014 4v1h-2V6a2 2 0 10-4 0v1H8V6a4 4 0 014-4zM8 9h8v2H8V9zm-1 4h10l-1 9H8l-1-9z"}},Kp=[{threshold:1e3,label:"1 Tonne",icon:"1T"},{threshold:5e3,label:"5 Tonne",icon:"5T"},{threshold:1e4,label:"10 Tonne",icon:"10T"},{threshold:25e3,label:"25 Tonne",icon:"25T"},{threshold:5e4,label:"50 Tonne",icon:"50T"},{threshold:1e5,label:"100 Tonne",icon:"100T"},{threshold:25e4,label:"250 Tonne",icon:"250T"},{threshold:5e5,label:"500 Tonne",icon:"500T"},{threshold:1e6,label:"1 Million kg",icon:"1M"}];function OD(n){return PD[n]||"push"}function VD(n){return n>=1e6?`${(n/1e6).toFixed(1)}M`:n>=1e3?`${(n/1e3).toFixed(1)}T`:`${Math.round(n)}`}function BD(n){return n>=1e6?"million kg":n>=1e3?"tonnes":"kg"}function UD(){const{currentUser:n,isClient:e,clientData:t,loading:i}=Mr(),{isDark:l,toggleTheme:u,accent:d}=ka(),p=$n(),[g,y]=v.useState(!0),[w,k]=v.useState(null),[j,O]=v.useState({}),[H,B]=v.useState([]),[V,se]=v.useState(null),[K,oe]=v.useState(0),[ye,Pe]=v.useState({});v.useRef(null),v.useEffect(()=>{!i&&(!n||!e)&&p("/")},[n,e,i,p]),v.useEffect(()=>{if(!t)return;(async()=>{try{const[pe,Me,Qe,X]=await Promise.all([Ns(We(fe,"coreBuddyAchievements",t.id)),Ns(We(fe,"coreBuddyPBs",t.id)),Ns(We(fe,"achievements",t.id)),js(Ps($t(fe,"workoutLogs"),us("clientId","==",t.id)))]);pe.exists()&&k(pe.data()),Me.exists()&&O(Me.data().exercises||{}),Qe.exists()&&(B(Object.keys(Qe.data().badges||{})),Pe(Qe.data().progress||{})),oe(X.docs.length)}catch(pe){console.error("Error loading achievements:",pe)}y(!1)})()},[t]);const Ee=w?.badges||[],R=w?.totalVolume||0,T=Ee.filter($=>$.type==="pb_target"),A=Ee.filter($=>$.type==="volume_milestone"),L={push:[],pull:[],lower:[],core:[]};T.forEach($=>{const pe=$.group||OD($.exercise);L[pe]&&L[pe].push($)});const D=Kp.find($=>R<$.threshold),z=Kp.filter($=>R>=$.threshold).pop()?.threshold||0,M=D?(R-z)/(D.threshold-z):1;if(i||g)return r.jsxs("div",{className:"ach-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsx("div",{className:"header-content",children:r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})})}),r.jsx("div",{className:"ach-loading-inline",children:r.jsx("div",{className:"cb-loading-spinner"})})]});const Ge=Ee.length+H.length,mt=Ge>0||R>0||K>0;return r.jsx(xa,{children:r.jsxs("div",{className:"ach-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),r.jsxs("main",{className:"ach-main",children:[r.jsx("button",{className:"nut-back-btn",onClick:()=>p("/client/personal-bests?mode=corebuddy"),children:" Back"}),r.jsxs("div",{className:"ach-stats-banner",children:[r.jsxs("div",{className:"ach-stat-item",children:[r.jsx("span",{className:"ach-stat-num",children:Ge}),r.jsx("span",{className:"ach-stat-label",children:Ge===1?"Badge":"Badges"})]}),r.jsx("div",{className:"ach-stat-divider"}),r.jsxs("div",{className:"ach-stat-item",children:[r.jsx("span",{className:"ach-stat-num",children:VD(R)}),r.jsxs("span",{className:"ach-stat-label",children:[BD(R)," lifted"]})]}),r.jsx("div",{className:"ach-stat-divider"}),r.jsxs("div",{className:"ach-stat-item",children:[r.jsx("span",{className:"ach-stat-num",children:Object.keys(j).length}),r.jsx("span",{className:"ach-stat-label",children:"PBs"})]})]}),!mt&&r.jsxs("div",{className:"ach-empty",children:[r.jsx("div",{className:"ach-empty-icon",children:r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[r.jsx("path",{d:"M12 15l-3-3h6l-3 3z"}),r.jsx("path",{d:"M5 7h14l-1.5 9h-11L5 7z"}),r.jsx("path",{d:"M8.5 7V5a3.5 3.5 0 017 0v2"})]})}),r.jsx("h4",{children:"No achievements yet"}),r.jsx("p",{children:"Complete workouts to track volume and set PB targets to start earning badges."})]}),[{key:"workouts",title:"Workout Badges",iconPath:"M20.57 14.86L22 13.43 20.57 12 17 15.57 8.43 7 12 3.43 10.57 2 9.14 3.43 7.71 2 5.57 4.14 4.14 2.71 2.71 4.14l1.43 1.43L2 7.71l1.43 1.43L2 10.57 3.43 12 7 8.43 15.57 17 12 20.57 13.43 22l1.43-1.43L16.29 22l2.14-2.14 1.43 1.43 1.43-1.43-1.43-1.43L22 16.29z"},{key:"streaks",title:"Streak Badges",iconPath:"M13.5.67s.74 2.65.74 4.8c0 2.06-1.35 3.73-3.41 3.73-2.07 0-3.63-1.67-3.63-3.73l.03-.36C5.21 7.51 4 10.62 4 14c0 4.42 3.58 8 8 8s8-3.58 8-8C20 8.61 17.41 3.8 13.5.67z"},{key:"pbs",title:"Personal Best Badges",iconPath:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"},{key:"nutrition",title:"Nutrition Badges",iconPath:"M18.06 23h1.66c.84 0 1.53-.65 1.63-1.47L23 5.05h-5V1h-2v4.05h-5l.3 2.34c1.71.47 3.31 1.32 4.27 2.26 1.44 1.42 2.43 2.89 2.43 5.29V23zM1 22v-1h15.03v1c0 .55-.45 1-1.01 1H2.01c-.56 0-1.01-.45-1.01-1zm15.03-7c0-4.87-4.66-5.84-8.03-5.97l.72 5.52L1 15.05v5.95h15.03V15z"},{key:"habits",title:"Habit Badges",iconPath:"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z"},{key:"leaderboard",title:"Leaderboard Badges",iconPath:"M7.5 21H2V9h5.5v12zm7.25-18h-5.5v18h5.5V3zM22 11h-5.5v10H22V11z"}].map($=>{const pe=hu.filter(X=>X.category===$.key);if(pe.length===0)return null;const Me=(()=>{switch($.key){case"workouts":return K;case"streaks":return ye.streakWeeks||0;case"pbs":return Object.keys(j).length;case"nutrition":return ye.nutritionStreak||0;case"leaderboard":return t?.leaderboardOptIn?1:0;case"habits":return ye.habitStreak||0;default:return 0}})(),Qe=pe.filter(X=>H.includes(X.id)).length;return r.jsxs("div",{className:"ach-section",children:[r.jsxs("h3",{className:"ach-section-title",children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20",children:r.jsx("path",{d:$.iconPath})}),$.title]}),r.jsx("div",{className:"ach-workout-carousel",children:pe.map(X=>{const P=H.includes(X.id);return r.jsxs("button",{className:`ach-workout-badge${P?" unlocked":" locked"}`,onClick:()=>se(X),children:[r.jsx("img",{src:X.img,alt:X.name,className:"ach-workout-badge-img"}),!P&&X.threshold&&r.jsx("div",{className:"ach-workout-badge-progress",children:r.jsx("div",{className:"ach-workout-badge-progress-fill",style:{width:`${Math.min(Me/X.threshold*100,100)}%`}})})]},X.id)})}),r.jsxs("p",{className:"ach-workout-badges-count",children:[Qe,"/",pe.length," unlocked"]})]},$.key)}),V&&r.jsx("div",{className:"ach-badge-overlay",onClick:()=>se(null),children:r.jsxs("div",{className:"ach-badge-overlay-content",onClick:$=>$.stopPropagation(),children:[r.jsx("img",{src:V.img,alt:V.name,className:`ach-badge-overlay-img${H.includes(V.id)?"":" ach-badge-overlay-img-locked"}`}),r.jsx("p",{className:"ach-badge-overlay-desc",children:V.desc}),H.includes(V.id)?r.jsx("span",{className:"ach-badge-overlay-status unlocked",children:"Unlocked"}):r.jsx("span",{className:"ach-badge-overlay-status locked",children:"Locked"}),r.jsx("button",{className:"ach-badge-overlay-close",onClick:()=>se(null),children:"Tap to close"})]})}),r.jsxs("div",{className:"ach-section",children:[r.jsxs("h3",{className:"ach-section-title",children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20",children:r.jsx("path",{d:"M20.57 14.86L22 13.43 20.57 12 17 15.57 8.43 7 12 3.43 10.57 2 9.14 3.43 7.71 2 5.57 4.14 4.14 2.71 2.71 4.14l1.43 1.43L2 7.71l1.43 1.43L2 10.57 3.43 12 7 8.43 15.57 17 12 20.57 13.43 22l1.43-1.43L16.29 22l2.14-2.14 1.43 1.43 1.43-1.43-1.43-1.43L22 16.29z"})}),"Volume Milestones"]}),r.jsxs("div",{className:"ach-volume-hero",children:[r.jsxs("div",{className:"ach-volume-ring",children:[r.jsx("svg",{className:"ach-volume-ring-svg",viewBox:"0 0 200 200",children:du.map(($,pe)=>{const Me=pe<Math.round(M*60);return r.jsx("line",{x1:$.x1,y1:$.y1,x2:$.x2,y2:$.y2,className:Me?"ach-tick-filled":"ach-tick-empty",strokeWidth:$.thick?"3":"2"},pe)})}),r.jsxs("div",{className:"ach-volume-center",children:[r.jsx("span",{className:"ach-volume-number",children:Math.round(R).toLocaleString()}),r.jsx("span",{className:"ach-volume-unit",children:"kg lifted"})]})]}),D&&r.jsxs("div",{className:"ach-volume-next",children:["Next: ",r.jsx("strong",{children:D.label})," (",(D.threshold-R).toLocaleString(),"kg to go)"]})]}),r.jsx("div",{className:"ach-milestone-shelf",children:Kp.map(($,pe)=>{const Me=R>=$.threshold,Qe=A.find(X=>X.milestone===$.threshold);return r.jsxs("div",{className:`ach-milestone ${Me?"unlocked":"locked"}`,children:[r.jsx("div",{className:"ach-milestone-hex",children:r.jsx("span",{className:"ach-milestone-icon",children:$.icon})}),r.jsx("span",{className:"ach-milestone-label",children:$.label}),Qe?.achievedAt&&r.jsx("span",{className:"ach-milestone-date",children:(Qe.achievedAt.toDate?Qe.achievedAt.toDate():new Date(Qe.achievedAt)).toLocaleDateString("en-GB",{day:"numeric",month:"short"})})]},pe)})})]}),r.jsxs("div",{className:"ach-section",children:[r.jsxs("h3",{className:"ach-section-title",children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),"PB Target Badges"]}),T.length===0?r.jsx("div",{className:"ach-pb-empty",children:r.jsxs("p",{children:["Set targets on your personal bests to start earning badges. Go to ",r.jsx("strong",{children:"My Progress"}),' and tap "Set Target" on any PB.']})}):Object.entries(L).map(([$,pe])=>{if(pe.length===0)return null;const Me=LD[$];return r.jsxs("div",{className:"ach-group",children:[r.jsxs("div",{className:"ach-group-header",style:{borderLeftColor:Me.color},children:[r.jsx("span",{className:"ach-group-label",style:{color:Me.color},children:Me.label}),r.jsx("span",{className:"ach-group-count",children:pe.length})]}),r.jsx("div",{className:"ach-badge-grid",children:pe.map((Qe,X)=>r.jsxs("div",{className:"ach-badge-card",style:{animationDelay:`${X*.06}s`,"--group-color":Me.color},children:[r.jsx("div",{className:"ach-badge-hex",style:{borderColor:Me.color,boxShadow:`0 0 12px ${Me.color}33`},children:r.jsx("svg",{className:"ach-badge-hex-icon",viewBox:"0 0 24 24",fill:"none",stroke:Me.color,strokeWidth:"2",strokeLinecap:"round",children:r.jsx("path",{d:Me.icon})})}),r.jsxs("div",{className:"ach-badge-info",children:[r.jsx("span",{className:"ach-badge-exercise",children:Qe.exercise}),r.jsxs("span",{className:"ach-badge-value",style:{color:Me.color},children:[Qe.targetWeight,"kg"]}),Qe.achievedAt&&r.jsx("span",{className:"ach-badge-date",children:(Qe.achievedAt.toDate?Qe.achievedAt.toDate():new Date(Qe.achievedAt)).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"})})]})]},X))})]},$)})]})]}),r.jsx(aa,{active:"home"})]})})}const zD=[{key:"trained",label:"Trained",icon:"M4 10v4M8 7v10M8 12h8M16 7v10M20 10v4",color:"#A12F3A"},{key:"protein",label:"Hit Protein",icon:"M12 22c5.52 0 10-4.48 10-10S17.52 2 12 2 2 6.48 2 12s4.48 10 10 10zM12 18c3.31 0 6-2.69 6-6s-2.69-6-6-6-6 2.69-6 6 2.69 6 6 6zM12 14a2 2 0 1 0 0-4 2 2 0 0 0 0 4z",color:"#4caf50"},{key:"steps",label:"10k Steps",icon:"M4 19.5A2.5 2.5 0 0 1 6.5 17H20M4 12.5A2.5 2.5 0 0 1 6.5 10H20M4 5.5A2.5 2.5 0 0 1 6.5 3H20",color:"#ff9800"},{key:"sleep",label:"8hrs Sleep",icon:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z",color:"#7c3aed"},{key:"water",label:"2L Water",icon:"M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z",color:"#2196f3"}],FD="M12 2l2.4 7.2L22 12l-7.6 2.8L12 22l-2.4-7.2L2 12l7.6-2.8z",qD="#e91e63";function HD(n){const e=new Date(n),t=e.getDay(),i=t===0?-6:1-t;return e.setDate(e.getDate()+i),e.setHours(0,0,0,0),e}function Yp(n){return n.toISOString().split("T")[0]}function $D(n){return Array.from({length:7},(e,t)=>{const i=new Date(n);return i.setDate(n.getDate()+t),i})}function WD(){const{currentUser:n,isClient:e,clientData:t,loading:i}=Mr(),{isDark:l,toggleTheme:u,accent:d}=ka(),p=$n(),[g,y]=v.useState({}),[w,k]=v.useState([]),[j,O]=v.useState(!0),[H,B]=v.useState(!1),[V,se]=v.useState(0),[K,oe]=v.useState(null),[ye,Pe]=v.useState(null),[Ee,R]=v.useState(!1),[T,A]=v.useState(!1),[L,D]=v.useState(""),[z,M]=v.useState(null),[Ge,mt]=v.useState([]),$=v.useRef([]),pe=v.useRef([]),Me=v.useCallback((Ae,Fe="info")=>{oe({message:Ae,type:Fe}),setTimeout(()=>oe(null),3e3)},[]),Qe=new Date,X=Yp(Qe),P=HD(Qe),re=$D(P),Re=["M","T","W","T","F","S","S"],Le=[...zD.filter(Ae=>!Ge.includes(Ae.key)),...w.map(Ae=>({key:`custom_${Ae.id}`,label:Ae.label,icon:FD,color:qD,isCustom:!0,id:Ae.id}))];v.useEffect(()=>{!i&&(!n||!e)&&p("/")},[n,e,i,p]),v.useEffect(()=>{if(!n||!t)return;(async()=>{try{const Fe=$t(fe,"habitLogs"),Ze=Ps(Fe,us("clientId","==",t.id)),Ke=await js(Ze),Xe={};Ke.docs.forEach(Ut=>{const Bs=Ut.data();Xe[Bs.date]={...Bs,_id:Ut.id}}),y(Xe);const Ct=await Ns(We(fe,"customHabits",t.id));if(Ct.exists()){const Ut=Ct.data();k(Ut.habits||[]),mt(Ut.hiddenDefaults||[])}let zs=0;const gt=new Date(Qe);for(;;){const Ut=Yp(gt),Bs=Xe[Ut];if(Bs)if(Object.values(Bs.habits||{}).filter(Boolean).length>=3)zs++,gt.setDate(gt.getDate()-1);else break;else if(Ut===X)gt.setDate(gt.getDate()-1);else break}se(zs)}catch(Fe){console.error("Error loading habit logs:",Fe)}finally{O(!1)}})()},[n,t]);const tt=g[X]||{habits:{}},qe=async Ae=>{if(!n||H)return;const Fe=tt.habits?.[Ae]||!1;Fe||($.current=[...Array(10)].map((Ze,Ke)=>{const Xe=Ke/10*2*Math.PI,Ct=18+Math.random()*20;return{tx:Math.cos(Xe)*Ct,ty:Math.sin(Xe)*Ct,size:3+Math.random()*4,duration:.4+Math.random()*.3}}),Pe(Ae),setTimeout(()=>Pe(null),700)),B(!0);try{const Ze=tt.habits||{},Ke={...Ze,[Ae]:!Ze[Ae]},Xe=tt._id||`${t.id}_${X}`;await Ss(We(fe,"habitLogs",Xe),{clientId:t.id,date:X,habits:Ke}),y(zs=>({...zs,[X]:{clientId:t.id,date:X,habits:Ke,_id:Xe}})),Object.values(Ke).filter(Boolean).length===Le.length&&!Fe&&(pe.current=[...Array(50)].map((zs,gt)=>({x:5+Math.random()*90,delay:Math.random()*.6,color:["#4caf50","#ff9800","#2196f3","#e91e63","#ffeb3b","#9c27b0"][gt%6],drift:(Math.random()-.5)*120,spin:Math.random()*720-360,duration:1.5+Math.random()*1.5,width:4+Math.random()*8,height:4+Math.random()*10})),setTimeout(()=>{R(!0),setTimeout(()=>R(!1),3500)},500))}catch(Ze){console.error("Error saving habit:",Ze),Me("Failed to save. Try again.","error")}finally{B(!1)}},ft=async()=>{const Ae=L.trim();if(!Ae)return;if(!t?.id){Me("Still loading, try again","error");return}const Fe=Date.now().toString(36),Ze=[...w,{id:Fe,label:Ae}];try{await Ss(We(fe,"customHabits",t.id),{clientId:t.id,habits:Ze,hiddenDefaults:Ge},{merge:!0}),k(Ze),D(""),A(!1),Me(`Added "${Ae}"`,"success")}catch(Ke){console.error("Error adding custom habit:",Ke),Me(Ke?.code==="permission-denied"?"Permission denied  check Firestore rules for customHabits":`Failed to add habit: ${Ke?.message||"Unknown error"}`,"error")}},kt=async Ae=>{if(!t?.id)return;const Fe=w.filter(Ze=>Ze.id!==Ae);try{await Ss(We(fe,"customHabits",t.id),{clientId:t.id,habits:Fe,hiddenDefaults:Ge},{merge:!0}),k(Fe),M(null),Me("Habit removed","success")}catch(Ze){console.error("Error deleting habit:",Ze),Me("Failed to remove","error")}},rt=async Ae=>{if(!t?.id)return;const Fe=[...Ge,Ae];try{await Ss(We(fe,"customHabits",t.id),{clientId:t.id,habits:w,hiddenDefaults:Fe},{merge:!0}),mt(Fe),M(null),Me("Habit removed","success")}catch(Ze){console.error("Error hiding default habit:",Ze),Me("Failed to remove","error")}},Wt=re.map(Ae=>{const Fe=Yp(Ae),Ze=g[Fe],Ke=Ze?Object.values(Ze.habits||{}).filter(Boolean).length:0;return{date:Ae,dateStr:Fe,completed:Ke,total:Le.length}}),_s=Wt.reduce((Ae,Fe)=>Ae+Fe.completed,0),At=Wt.reduce((Ae,Fe)=>Ae+Fe.total,0),pt=At>0?Math.round(_s/At*100):0,ue=Object.values(tt.habits||{}).filter(Boolean).length,Zt=Le.length>0?Math.round(ue/Le.length*100):0;return r.jsx(xa,{children:r.jsxs("div",{className:"cbc-page","data-theme":l?"dark":"light","data-accent":d,children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>p("/client/core-buddy"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),i||j?r.jsx("div",{className:"cbc-loading-inline",children:r.jsx("div",{className:"cbc-loading-spinner"})}):r.jsxs("main",{className:"cbc-main",children:[r.jsxs("div",{className:"cbc-ring-section",children:[r.jsxs("div",{className:"cbc-progress-ring",children:[r.jsxs("svg",{viewBox:"0 0 200 200",children:[r.jsx("circle",{className:"cbc-arc-track",cx:"100",cy:"100",r:"80"}),r.jsx("circle",{className:"cbc-arc-fill",cx:"100",cy:"100",r:"80",strokeDasharray:2*Math.PI*80,strokeDashoffset:2*Math.PI*80-Zt/100*2*Math.PI*80})]}),r.jsxs("div",{className:"cbc-ring-center",children:[r.jsxs("span",{className:"cbc-ring-pct",children:[Zt,"%"]}),r.jsx("span",{className:"cbc-ring-label",children:"today"})]})]}),r.jsxs("div",{className:"cbc-streak",children:[r.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"var(--color-primary)",strokeWidth:"2",children:r.jsx("path",{d:"M13 2L3 14h9l-1 8 10-12h-9l1-8z"})}),r.jsx("span",{className:"cbc-streak-count",children:V}),r.jsx("span",{className:"cbc-streak-label",children:"day streak"})]})]}),r.jsxs("div",{className:"cbc-section",children:[r.jsx("h2",{className:"cbc-section-title",children:"Today's Habits"}),r.jsxs("div",{className:"cbc-habits",children:[Le.map(Ae=>{const Fe=tt.habits?.[Ae.key]||!1,Ze=ye===Ae.key;return r.jsxs("button",{className:`cbc-habit-btn ${Fe?"cbc-habit-done":""} ${Ze?"cbc-habit-just-checked":""}`,onClick:()=>qe(Ae.key),disabled:H,style:{"--habit-color":Ae.color},children:[r.jsxs("div",{className:"cbc-habit-icon-wrap",style:{"--habit-color":Ae.color},children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:r.jsx("path",{d:Ae.icon})}),Fe&&r.jsx("div",{className:"cbc-habit-done-badge",children:r.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"#fff",strokeWidth:"3",children:r.jsx("polyline",{points:"20 6 9 17 4 12"})})})]}),Ze&&r.jsx("div",{className:"cbc-particles",children:$.current.map((Ke,Xe)=>r.jsx("span",{className:"cbc-particle",style:{"--tx":`${Ke.tx}px`,"--ty":`${Ke.ty}px`,"--size":`${Ke.size}px`,"--particle-color":Ae.color,animationDuration:`${Ke.duration}s`}},Xe))}),r.jsxs("div",{className:"cbc-habit-text",children:[r.jsx("span",{className:"cbc-habit-label",children:Ae.label}),Fe&&r.jsx("span",{className:"cbc-habit-done-tag",children:"Done"})]}),r.jsx("button",{className:"cbc-habit-delete",onClick:Ke=>{Ke.stopPropagation(),M(Ae.isCustom?{type:"custom",id:Ae.id,label:Ae.label}:{type:"default",key:Ae.key,label:Ae.label})},"aria-label":`Remove ${Ae.label}`,children:r.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]},Ae.key)}),r.jsxs("button",{className:"cbc-add-habit-btn",onClick:()=>A(!0),children:[r.jsx("div",{className:"cbc-add-habit-icon",children:r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),r.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})}),r.jsx("span",{children:"Add your own habit"})]})]})]}),r.jsxs("div",{className:"cbc-section",children:[r.jsx("h2",{className:"cbc-section-title",children:"This Week"}),r.jsx("div",{className:"cbc-week-grid",children:Wt.map((Ae,Fe)=>{const Ze=Ae.dateStr===X,Ke=Ae.total>0?Ae.completed/Ae.total:0,Xe=38,Ct=2*Math.PI*Xe,zs=Ct-Ke*Ct;return r.jsxs("div",{className:`cbc-day-ring ${Ze?"cbc-day-today":""} ${Ae.completed>0?"cbc-day-active":""}`,children:[r.jsxs("svg",{viewBox:"0 0 100 100",children:[r.jsx("circle",{className:"cbc-day-track",cx:"50",cy:"50",r:Xe}),r.jsx("circle",{className:"cbc-day-fill",cx:"50",cy:"50",r:Xe,strokeDasharray:Ct,strokeDashoffset:zs})]}),r.jsx("span",{className:"cbc-day-label",children:Re[Fe]}),r.jsxs("span",{className:"cbc-day-count",children:[Ae.completed,"/",Ae.total]})]},Fe)})}),r.jsxs("div",{className:"cbc-week-summary",children:[r.jsx("div",{className:"cbc-week-summary-bar",children:r.jsx("div",{className:"cbc-week-summary-fill",style:{width:`${pt}%`}})}),r.jsxs("span",{className:"cbc-week-summary-text",children:[_s," / ",At," habits this week (",pt,"%)"]})]})]})]}),r.jsx(aa,{active:"home"}),T&&r.jsx("div",{className:"cbc-modal-overlay",onClick:()=>A(!1),children:r.jsxs("div",{className:"cbc-modal",onClick:Ae=>Ae.stopPropagation(),children:[r.jsx("h3",{className:"cbc-modal-title",children:"Add Habit"}),r.jsx("p",{className:"cbc-modal-desc",children:"Track something personal to your routine."}),r.jsx("input",{className:"cbc-modal-input",type:"text",placeholder:"e.g. Meditate, Stretch, Read...",value:L,onChange:Ae=>D(Ae.target.value),maxLength:30,autoFocus:!0,onKeyDown:Ae=>Ae.key==="Enter"&&ft()}),r.jsxs("div",{className:"cbc-modal-actions",children:[r.jsx("button",{className:"cbc-modal-cancel",onClick:()=>{A(!1),D("")},children:"Cancel"}),r.jsx("button",{className:"cbc-modal-save",onClick:ft,disabled:!L.trim(),children:"Add"})]})]})}),z&&r.jsx("div",{className:"cbc-modal-overlay",onClick:()=>M(null),children:r.jsxs("div",{className:"cbc-modal",onClick:Ae=>Ae.stopPropagation(),children:[r.jsxs("h3",{className:"cbc-modal-title",children:['Remove "',z.label,'"?']}),r.jsx("p",{className:"cbc-modal-desc",children:"This will remove the habit from your daily tracker. Past logs won't be affected."}),r.jsxs("div",{className:"cbc-modal-actions",children:[r.jsx("button",{className:"cbc-modal-cancel",onClick:()=>M(null),children:"Keep"}),r.jsx("button",{className:"cbc-modal-delete",onClick:()=>z.type==="custom"?kt(z.id):rt(z.key),children:"Remove"})]})]})}),Ee&&r.jsxs("div",{className:"cbc-celebration",onClick:()=>R(!1),children:[r.jsx("div",{className:"cbc-confetti-container",children:pe.current.map((Ae,Fe)=>r.jsx("span",{className:"cbc-confetti-piece",style:{"--x":`${Ae.x}%`,"--delay":`${Ae.delay}s`,"--color":Ae.color,"--drift":`${Ae.drift}px`,"--spin":`${Ae.spin}deg`,"--duration":`${Ae.duration}s`,width:`${Ae.width}px`,height:`${Ae.height}px`}},Fe))}),r.jsxs("div",{className:"cbc-celebration-card",children:[r.jsxs("svg",{className:"cbc-celebration-icon",viewBox:"0 0 24 24",fill:"none",stroke:"var(--color-primary)",strokeWidth:"2",children:[r.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),r.jsx("polyline",{points:"22 4 12 14.01 9 11.01"})]}),r.jsx("h2",{className:"cbc-celebration-title",children:"Crushed it!"}),r.jsx("p",{className:"cbc-celebration-sub",children:"All habits complete today"})]})]}),K&&r.jsx("div",{className:`toast-notification ${K.type}`,children:K.message})]})})}function lh(n){if(!n)return"?";const e=n.trim().split(/\s+/);return e.length===1?e[0][0].toUpperCase():(e[0][0]+e[e.length-1][0]).toUpperCase()}function j2(n,e){return[n,e].sort().join("_")}function GD(){const{currentUser:n,isClient:e,clientData:t,loading:i}=Mr(),{isDark:l,toggleTheme:u}=ka(),d=$n(),[p,g]=v.useState("buddies"),[y,w]=v.useState([]),[k,j]=v.useState([]),[O,H]=v.useState([]),[B,V]=v.useState(""),[se,K]=v.useState([]),[oe,ye]=v.useState([]),[Pe,Ee]=v.useState(!0),[R,T]=v.useState(null),[A,L]=v.useState(null),D=v.useCallback((X,P="info")=>{L({message:X,type:P}),setTimeout(()=>L(null),3500)},[]);v.useEffect(()=>{!i&&(!n||!e)&&d("/")},[n,e,i,d]);const z=v.useCallback(async()=>{if(t){Ee(!0);try{const X=t.id,re=(await js($t(fe,"clients"))).docs.map(rt=>({id:rt.id,...rt.data()}));ye(re);const Re=Object.fromEntries(re.map(rt=>[rt.id,rt])),Le=await js(Ps($t(fe,"buddies"),us("user1","==",X))),tt=await js(Ps($t(fe,"buddies"),us("user2","==",X))),qe=new Set;[...Le.docs,...tt.docs].forEach(rt=>{const Wt=rt.data(),_s=Wt.user1===X?Wt.user2:Wt.user1;qe.add(_s)}),w(Array.from(qe).map(rt=>Re[rt]).filter(Boolean));const ft=await js(Ps($t(fe,"buddyRequests"),us("toId","==",X),us("status","==","pending")));j(ft.docs.map(rt=>({reqId:rt.id,...rt.data(),fromClient:Re[rt.data().fromId]})).filter(rt=>rt.fromClient));const kt=await js(Ps($t(fe,"buddyRequests"),us("fromId","==",X),us("status","==","pending")));H(kt.docs.map(rt=>({reqId:rt.id,...rt.data(),toClient:Re[rt.data().toId]})).filter(rt=>rt.toClient))}catch(X){console.error("Error fetching buddy data:",X),D("Failed to load buddies","error")}finally{Ee(!1)}}},[t,D]);v.useEffect(()=>{z()},[z]),v.useEffect(()=>{if(!B.trim()||!t){K([]);return}const X=B.toLowerCase(),P=t.id,re=new Set(y.map(qe=>qe.id)),Re=new Set(O.map(qe=>qe.toId)),Le=new Set(k.map(qe=>qe.fromId)),tt=oe.filter(qe=>qe.id===P||!qe.name||!qe.coreBuddyAccess&&qe.clientType!=="core_buddy"?!1:qe.name.toLowerCase().includes(X)).map(qe=>({...qe,isBuddy:re.has(qe.id),isPendingOut:Re.has(qe.id),isPendingIn:Le.has(qe.id)})).slice(0,20);K(tt)},[B,oe,y,O,k,t]);const M=async(X,P)=>{if(!(!t||X===t.id))try{await hi($t(fe,"notifications"),{toId:X,fromId:t.id,fromName:t.name||"Someone",fromPhotoURL:t.photoURL||null,type:P,read:!1,createdAt:Hr()})}catch(re){console.error("Notification error:",re),re.code==="permission-denied"&&D("Notifications blocked  check Firestore rules","error")}},Ge=async X=>{T(X);try{const P=`${t.id}_${X}`;await Ss(We(fe,"buddyRequests",P),{fromId:t.id,toId:X,status:"pending",createdAt:Hr()}),await M(X,"buddy_request"),D("Buddy request sent!","success"),await z()}catch(P){console.error("Error sending request:",P),D("Failed to send request","error")}finally{T(null)}},mt=async X=>{T(X.reqId);try{const P=j2(X.fromId,t.id);await Ss(We(fe,"buddies",P),{user1:[X.fromId,t.id].sort()[0],user2:[X.fromId,t.id].sort()[1],connectedAt:Hr()}),await yr(We(fe,"buddyRequests",X.reqId)),await M(X.fromId,"buddy_accept"),D("Buddy added!","success"),await z()}catch(P){console.error("Error accepting request:",P),D("Failed to accept","error")}finally{T(null)}},$=async X=>{T(X.reqId);try{await yr(We(fe,"buddyRequests",X.reqId)),D("Request declined","info"),await z()}catch(P){console.error("Error declining:",P),D("Failed to decline","error")}finally{T(null)}},pe=async X=>{T(X.reqId);try{await yr(We(fe,"buddyRequests",X.reqId)),D("Request cancelled","info"),await z()}catch(P){console.error("Error cancelling:",P),D("Failed to cancel","error")}finally{T(null)}},Me=async X=>{T(X);try{const P=j2(t.id,X);await yr(We(fe,"buddies",P)),D("Buddy removed","info"),await z()}catch(P){console.error("Error removing buddy:",P),D("Failed to remove buddy","error")}finally{T(null)}},Qe=k.length;return i?r.jsx("div",{className:"bdy-loading",children:r.jsx("div",{className:"bdy-spinner"})}):!n||!e||!t?null:r.jsx(xa,{children:r.jsxs("div",{className:"bdy-page","data-theme":l?"dark":"light",children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>d("/client/core-buddy"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:u,"aria-label":"Toggle theme",children:l?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),r.jsxs("main",{className:"bdy-main",children:[r.jsx("h1",{className:"bdy-title",children:"Buddies"}),r.jsxs("button",{className:"bdy-leaderboard-link",onClick:()=>d("/client/leaderboard"),children:[r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5C7 4 7 7 7 7"}),r.jsx("path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5C17 4 17 7 17 7"}),r.jsx("rect",{x:"6",y:"9",width:"12",height:"13",rx:"2"}),r.jsx("path",{d:"M12 9v13"}),r.jsx("path",{d:"M2 22h20"})]}),r.jsx("span",{children:"Leaderboard"}),r.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})]}),r.jsxs("div",{className:"bdy-tabs",children:[r.jsxs("button",{className:`bdy-tab${p==="buddies"?" active":""}`,onClick:()=>g("buddies"),children:[r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),r.jsx("circle",{cx:"9",cy:"7",r:"4"}),r.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),r.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),r.jsx("span",{children:"My Buddies"})]}),r.jsxs("button",{className:`bdy-tab${p==="requests"?" active":""}`,onClick:()=>g("requests"),children:[r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),r.jsx("circle",{cx:"9",cy:"7",r:"4"}),r.jsx("line",{x1:"19",y1:"8",x2:"19",y2:"14"}),r.jsx("line",{x1:"22",y1:"11",x2:"16",y2:"11"})]}),r.jsx("span",{children:"Requests"}),Qe>0&&r.jsx("span",{className:"bdy-tab-badge",children:Qe})]}),r.jsxs("button",{className:`bdy-tab${p==="search"?" active":""}`,onClick:()=>g("search"),children:[r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("circle",{cx:"11",cy:"11",r:"8"}),r.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),r.jsx("span",{children:"Find"})]})]}),Pe?r.jsx("div",{className:"bdy-content-loading",children:r.jsx("div",{className:"bdy-spinner"})}):r.jsxs(r.Fragment,{children:[p==="buddies"&&r.jsx("div",{className:"bdy-section",children:y.length===0?r.jsxs("div",{className:"bdy-empty",children:[r.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),r.jsx("circle",{cx:"9",cy:"7",r:"4"}),r.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),r.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),r.jsx("h3",{children:"No buddies yet"}),r.jsx("p",{children:"Find members and send buddy requests to connect!"}),r.jsx("button",{className:"bdy-empty-btn",onClick:()=>g("search"),children:"Find Buddies"})]}):r.jsx("div",{className:"bdy-list",children:y.map(X=>r.jsxs("div",{className:"bdy-card",onClick:()=>d(`/client/core-buddy/profile/${X.id}`),children:[r.jsx("div",{className:"bdy-avatar",children:X.photoURL?r.jsx("img",{src:X.photoURL,alt:X.name}):r.jsx("span",{children:lh(X.name)})}),r.jsx("div",{className:"bdy-card-info",children:r.jsx("span",{className:"bdy-card-name",children:X.name})}),r.jsx("button",{className:"bdy-remove-btn",onClick:P=>{P.stopPropagation(),Me(X.id)},disabled:R===X.id,"aria-label":"Remove buddy",children:R===X.id?r.jsx("div",{className:"bdy-btn-spinner"}):r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]},X.id))})}),p==="requests"&&r.jsxs("div",{className:"bdy-section",children:[k.length>0&&r.jsxs(r.Fragment,{children:[r.jsx("h3",{className:"bdy-section-title",children:"Incoming"}),r.jsx("div",{className:"bdy-list",children:k.map(X=>r.jsxs("div",{className:"bdy-card",children:[r.jsx("div",{className:"bdy-avatar",children:X.fromClient.photoURL?r.jsx("img",{src:X.fromClient.photoURL,alt:X.fromClient.name}):r.jsx("span",{children:lh(X.fromClient.name)})}),r.jsxs("div",{className:"bdy-card-info",children:[r.jsx("span",{className:"bdy-card-name",children:X.fromClient.name}),r.jsx("span",{className:"bdy-card-sub",children:"wants to be your buddy"})]}),r.jsxs("div",{className:"bdy-action-pair",children:[r.jsx("button",{className:"bdy-accept-btn",onClick:()=>mt(X),disabled:R===X.reqId,children:R===X.reqId?r.jsx("div",{className:"bdy-btn-spinner"}):r.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:r.jsx("path",{d:"M5 13l4 4L19 7"})})}),r.jsx("button",{className:"bdy-decline-btn",onClick:()=>$(X),disabled:R===X.reqId,children:r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]})]},X.reqId))})]}),O.length>0&&r.jsxs(r.Fragment,{children:[r.jsx("h3",{className:"bdy-section-title",children:"Sent"}),r.jsx("div",{className:"bdy-list",children:O.map(X=>r.jsxs("div",{className:"bdy-card",children:[r.jsx("div",{className:"bdy-avatar",children:X.toClient?.photoURL?r.jsx("img",{src:X.toClient.photoURL,alt:X.toClient.name}):r.jsx("span",{children:lh(X.toClient?.name)})}),r.jsxs("div",{className:"bdy-card-info",children:[r.jsx("span",{className:"bdy-card-name",children:X.toClient?.name}),r.jsx("span",{className:"bdy-card-sub",children:"pending"})]}),r.jsx("button",{className:"bdy-cancel-btn",onClick:()=>pe(X),disabled:R===X.reqId,children:R===X.reqId?r.jsx("div",{className:"bdy-btn-spinner"}):"Cancel"})]},X.reqId))})]}),k.length===0&&O.length===0&&r.jsxs("div",{className:"bdy-empty",children:[r.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[r.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),r.jsx("path",{d:"M22 4L12 14.01l-3-3"})]}),r.jsx("h3",{children:"No pending requests"}),r.jsx("p",{children:"All caught up!"})]})]}),p==="search"&&r.jsxs("div",{className:"bdy-section",children:[r.jsxs("div",{className:"bdy-search-bar",children:[r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("circle",{cx:"11",cy:"11",r:"8"}),r.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),r.jsx("input",{type:"text",placeholder:"Search by name...",value:B,onChange:X=>V(X.target.value),autoFocus:!0}),B&&r.jsx("button",{className:"bdy-search-clear",onClick:()=>V(""),children:r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),B.trim()&&se.length===0&&r.jsx("div",{className:"bdy-empty bdy-empty-sm",children:r.jsxs("p",{children:['No members found for "',B,'"']})}),se.length>0&&r.jsx("div",{className:"bdy-list",children:se.map(X=>r.jsxs("div",{className:"bdy-card",onClick:()=>d(`/client/core-buddy/profile/${X.id}`),children:[r.jsx("div",{className:"bdy-avatar",children:X.photoURL?r.jsx("img",{src:X.photoURL,alt:X.name}):r.jsx("span",{children:lh(X.name)})}),r.jsxs("div",{className:"bdy-card-info",children:[r.jsx("span",{className:"bdy-card-name",children:X.name}),X.isBuddy&&r.jsx("span",{className:"bdy-card-badge",children:"Buddy"})]}),X.isBuddy?r.jsx("span",{className:"bdy-status-icon",children:r.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"var(--color-success)",strokeWidth:"2.5",children:r.jsx("path",{d:"M5 13l4 4L19 7"})})}):X.isPendingOut?r.jsx("span",{className:"bdy-pending-label",children:"Pending"}):X.isPendingIn?r.jsx("button",{className:"bdy-accept-btn",onClick:P=>{P.stopPropagation();const re=k.find(Re=>Re.fromId===X.id);re&&mt(re)},disabled:!!R,children:r.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:r.jsx("path",{d:"M5 13l4 4L19 7"})})}):r.jsx("button",{className:"bdy-add-btn",onClick:P=>{P.stopPropagation(),Ge(X.id)},disabled:R===X.id,children:R===X.id?r.jsx("div",{className:"bdy-btn-spinner"}):r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),r.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})})]},X.id))})]})]})]}),r.jsx(aa,{}),A&&r.jsxs("div",{className:`toast-notification ${A.type}`,children:[r.jsx("span",{className:"toast-icon",children:A.type==="success"?r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M5 13 L9 17 L19 7"})}):A.type==="error"?r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]}):r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),r.jsx("circle",{cx:"12",cy:"16",r:"1",fill:"currentColor"})]})}),r.jsx("span",{className:"toast-message",children:A.message})]})]})})}function ch(n){if(!n)return"?";const e=n.trim().split(/\s+/);return e.length===1?e[0][0].toUpperCase():(e[0][0]+e[e.length-1][0]).toUpperCase()}function Qp(n,e){return[n,e].sort().join("_")}const KD=5;function Xp(n){return n.toISOString().split("T")[0]}function YD(n){return n>=1e6?`${(n/1e6).toFixed(1)}M`:n>=1e3?`${(n/1e3).toFixed(1)}T`:`${Math.round(n)}`}const QD={fullbody_4wk:{duration:4,daysPerWeek:3},fullbody_8wk:{duration:8,daysPerWeek:3},fullbody_12wk:{duration:12,daysPerWeek:3},core_4wk:{duration:4,daysPerWeek:3},core_8wk:{duration:8,daysPerWeek:3},core_12wk:{duration:12,daysPerWeek:3},upper_4wk:{duration:4,daysPerWeek:3},lower_4wk:{duration:4,daysPerWeek:3}};function T2(n){if(!n)return"";const e=n instanceof Date?n:n.toDate?n.toDate():new Date(n),t=Math.floor((new Date-e)/1e3);return t<60?"just now":t<3600?`${Math.floor(t/60)}m ago`:t<86400?`${Math.floor(t/3600)}h ago`:t<604800?`${Math.floor(t/86400)}d ago`:e.toLocaleDateString("en-GB",{day:"numeric",month:"short"})}function XD(){const{userId:n}=oE(),{currentUser:e,isClient:t,clientData:i,loading:l}=Mr(),{isDark:u,toggleTheme:d}=ka(),p=$n(),[g,y]=v.useState(null),[w,k]=v.useState("none"),[j,O]=v.useState(null),[H,B]=v.useState(!0),[V,se]=v.useState(!1),[K,oe]=v.useState(null),[ye,Pe]=v.useState([]),[Ee,R]=v.useState(!1),[T,A]=v.useState(new Set),[L,D]=v.useState(new Set),[z,M]=v.useState({}),[Ge,mt]=v.useState({}),[$,pe]=v.useState({}),[Me,Qe]=v.useState(!0),[X,P]=v.useState(0),[re,Re]=v.useState(0),[Le,tt]=v.useState(0),[qe,ft]=v.useState(0),[kt,rt]=v.useState([]),[Wt,_s]=v.useState([]),[At,pt]=v.useState(null),[ue,Zt]=v.useState(null),[Ae,Fe]=v.useState(0),[Ze,Ke]=v.useState([]),[Xe,Ct]=v.useState(!1),[zs,gt]=v.useState(null),[Ut,Bs]=v.useState([]),qt=v.useCallback((J,be="info")=>{oe({message:J,type:be}),setTimeout(()=>oe(null),3500)},[]);v.useEffect(()=>{!l&&(!e||!t)&&p("/")},[e,t,l,p]),v.useEffect(()=>{i&&n&&i.id===n&&p("/client/core-buddy",{replace:!0})},[i,n,p]),v.useEffect(()=>{if(!i||!n||i.id===n)return;let J=!1;return(async()=>{B(!0);try{const Dt=(await js($t(fe,"clients"))).docs.map(zt=>({id:zt.id,...zt.data()})).find(zt=>zt.id===n);if(!Dt){J||B(!1);return}J||y(Dt);const jt=i.id,ss=Qp(jt,n);if((await Ns(We(fe,"buddies",ss))).exists())J||k("buddy");else{const zt=`${jt}_${n}`,Rs=await Ns(We(fe,"buddyRequests",zt));if(Rs.exists()&&Rs.data().status==="pending")J||(k("pending_out"),O(zt));else{const Zs=`${n}_${jt}`,ds=await Ns(We(fe,"buddyRequests",Zs));ds.exists()&&ds.data().status==="pending"?J||(k("pending_in"),O(Zs)):J||k("none")}}}catch(be){console.error("Error loading profile:",be)}finally{J||B(!1)}})(),()=>{J=!0}},[i,n]),v.useEffect(()=>{if(!n||!g)return;let J=!1;return(async()=>{Qe(!0);try{const[be,it,Dt,jt]=await Promise.all([js(Ps($t(fe,"workoutLogs"),us("clientId","==",n))),Ns(We(fe,"coreBuddyAchievements",n)),Ns(We(fe,"coreBuddyPBs",n)),Ns(We(fe,"clientProgrammes",n))]);if(J)return;const ss=be.docs.length;P(ss),it.exists()&&Re(it.data().totalVolume||0);let Qt=0;const zt=be.docs.map(ds=>ds.data().date).filter(Boolean).sort().reverse();if(zt.length>0){const ds=new Date;let Es=new Date(ds);for(let Ls=0;Ls<52;Ls++){const F=new Date(Es),ve=F.getDay(),we=ve===0?6:ve-1;F.setDate(F.getDate()-we),F.setHours(0,0,0,0);const _e=new Date(F);_e.setDate(_e.getDate()+7);const ge=Xp(F),at=Xp(_e);if(zt.some(lt=>lt>=ge&&lt<at))Qt++;else{if(Ls>0)break;break}Es.setDate(Es.getDate()-7)}}if(J||tt(Qt),Dt.exists()){const ds=Dt.data().exercises||{},Es=Object.entries(ds).sort(([,Ls],[,F])=>(F.weight||0)-(Ls.weight||0)).slice(0,3).map(([Ls,F])=>({name:Ls,weight:F.weight,reps:F.reps}));J||rt(Es)}if(jt.exists()){const ds=jt.data(),Es=QD[ds.templateId];if(Es){const Ls=Object.keys(ds.completedSessions||{}).length,F=Es.duration*Es.daysPerWeek;J||(Zt(ds.templateId.replace(/_/g," ").replace(/\b\w/g,ve=>ve.toUpperCase())),Fe(F>0?Math.round(Ls/F*100):0))}}const Rs=await Ns(We(fe,"achievements",n));if(!J&&Rs.exists()){const ds=Rs.data().badges||{};_s(Object.keys(ds))}let Zs=0;for(let ds=0;ds<30;ds++){const Es=new Date;Es.setDate(Es.getDate()-ds);const Ls=Xp(Es);try{const F=await js(Ps($t(fe,"habitLogs"),us("clientId","==",n),us("date","==",Ls)));if(F.empty)break;{const ve=F.docs[0].data().habits||{};if(Object.values(ve).filter(Boolean).length>=KD)Zs++;else break}}catch{break}}J||ft(Zs)}catch(be){console.error("Error loading buddy stats:",be)}finally{J||Qe(!1)}})(),()=>{J=!0}},[n,g]),v.useEffect(()=>{if(!i)return;const J=i.id;(async()=>{try{const[be,it,Dt]=await Promise.all([js(Ps($t(fe,"buddies"),us("user1","==",J))),js(Ps($t(fe,"buddies"),us("user2","==",J))),js($t(fe,"clients"))]),jt=new Set;[...be.docs,...it.docs].forEach(Qt=>{const zt=Qt.data();jt.add(zt.user1===J?zt.user2:zt.user1)});const ss={};Dt.docs.forEach(Qt=>{ss[Qt.id]=Qt.data()}),Ke(Array.from(jt).filter(Qt=>ss[Qt]).map(Qt=>({id:Qt,name:ss[Qt].name,photoURL:ss[Qt].photoURL||null})))}catch(be){console.error("Error loading buddies for mentions:",be)}})()},[i]);const Cs=async(J,be,it={})=>{if(!(!i||J===i.id))try{await hi($t(fe,"notifications"),{toId:J,fromId:i.id,fromName:i.name||"Someone",fromPhotoURL:i.photoURL||null,type:be,read:!1,createdAt:Hr(),...it})}catch(Dt){console.error("Notification error:",Dt),Dt.code==="permission-denied"&&qt("Notifications blocked  check Firestore rules","error")}},is=async()=>{se(!0);try{const J=`${i.id}_${n}`;await Ss(We(fe,"buddyRequests",J),{fromId:i.id,toId:n,status:"pending",createdAt:Hr()}),await Cs(n,"buddy_request"),k("pending_out"),O(J),qt("Buddy request sent!","success")}catch(J){console.error(J),qt("Failed to send request","error")}finally{se(!1)}},Ts=async()=>{if(j){se(!0);try{const J=Qp(i.id,n);await Ss(We(fe,"buddies",J),{user1:[i.id,n].sort()[0],user2:[i.id,n].sort()[1],connectedAt:Hr()}),await yr(We(fe,"buddyRequests",j)),await Cs(n,"buddy_accept"),k("buddy"),qt("Buddy added!","success")}catch(J){console.error(J),qt("Failed to accept","error")}finally{se(!1)}}},ce=async()=>{if(j){se(!0);try{await yr(We(fe,"buddyRequests",j)),k("none"),qt(w==="pending_out"?"Request cancelled":"Request declined","info")}catch(J){console.error(J),qt("Failed","error")}finally{se(!1)}}},Se=async()=>{se(!0);try{const J=Qp(i.id,n);await yr(We(fe,"buddies",J)),k("none"),qt("Buddy removed","info")}catch(J){console.error(J),qt("Failed to remove","error")}finally{se(!1)}},Be=v.useCallback(async()=>{if(n){R(!0);try{const J=await js(Ps($t(fe,"posts"),us("authorId","==",n),$h("createdAt","desc"),Wh(30)));if(Pe(J.docs.map(be=>({id:be.id,...be.data()}))),i){const be=await js(Ps($t(fe,"postLikes"),us("userId","==",i.id)));A(new Set(be.docs.map(it=>it.data().postId)))}}catch(J){console.error("Error loading journey:",J)}finally{R(!1)}}},[n,i]);v.useEffect(()=>{!H&&g&&Be()},[H,g,Be]);const et=async J=>{if(window.confirm("Delete this post?"))try{await yr(We(fe,"posts",J)),Pe(be=>be.filter(it=>it.id!==J)),qt("Post deleted","info")}catch(be){console.error("Delete error:",be),qt("Failed to delete","error")}},Ue=async J=>{if(!i)return;const be=i.id,it=`${J}_${be}`,Dt=T.has(J),jt=new Set(T);Dt?jt.delete(J):jt.add(J),A(jt),Pe(ss=>ss.map(Qt=>Qt.id===J?{...Qt,likeCount:Math.max(0,(Qt.likeCount||0)+(Dt?-1:1))}:Qt));try{if(Dt)await yr(We(fe,"postLikes",it)),await Ma(We(fe,"posts",J),{likeCount:Bo(-1)});else{await Ss(We(fe,"postLikes",it),{postId:J,userId:be,createdAt:Hr()}),await Ma(We(fe,"posts",J),{likeCount:Bo(1)});const ss=ye.find(Qt=>Qt.id===J);ss&&Cs(ss.authorId,"like",{postId:J})}}catch(ss){console.error("Like error:",ss),Be()}},De=async J=>{try{const be=await js(Ps($t(fe,"postComments"),us("postId","==",J),$h("createdAt","asc"),Wh(50)));M(it=>({...it,[J]:be.docs.map(Dt=>({id:Dt.id,...Dt.data()}))}))}catch(be){console.error("Error loading comments:",be)}},He=J=>{const be=new Set(L);be.has(J)?be.delete(J):(be.add(J),z[J]||De(J)),D(be)},wt=(J,be)=>{const it=J.match(/@(\w*)$/);if(it){Ct(!0),gt(be);const Dt=Ze.filter(jt=>jt.name&&jt.name.toLowerCase().includes(it[1].toLowerCase())).slice(0,5);Bs(Dt)}else Ct(!1),Bs([])},yt=(J,be)=>{const Dt=(Ge[be]||"").replace(/@\w*$/,`@${J.name} `);mt(jt=>({...jt,[be]:Dt})),Ct(!1),Bs([])},Mt=(J,be)=>{mt(it=>({...it,[J]:be})),wt(be,J)},Yt=async J=>{const be=(Ge[J]||"").trim();if(!(!be||!i)){pe(it=>({...it,[J]:!0}));try{await hi($t(fe,"postComments"),{postId:J,authorId:i.id,authorName:i.name||"Unknown",authorPhotoURL:i.photoURL||null,content:be,createdAt:Hr()}),await Ma(We(fe,"posts",J),{commentCount:Bo(1)});const it=ye.find(jt=>jt.id===J);it&&Cs(it.authorId,"comment",{postId:J});const Dt=be.match(/@[\w\s]+?(?=\s@|\s*$|[.,!?])/g);if(Dt){const jt=new Set;Dt.forEach(ss=>{const Qt=ss.slice(1).trim(),zt=Ze.find(Rs=>Rs.name&&Rs.name.toLowerCase()===Qt.toLowerCase());zt&&!jt.has(zt.id)&&(jt.add(zt.id),Cs(zt.id,"mention",{postId:J}))})}mt(jt=>({...jt,[J]:""})),Pe(jt=>jt.map(ss=>ss.id===J?{...ss,commentCount:(ss.commentCount||0)+1}:ss)),await De(J)}catch(it){console.error("Comment error:",it),qt("Failed to comment","error")}finally{pe(it=>({...it,[J]:!1}))}}};return l||H||!i?r.jsx("div",{className:"prf-loading","data-theme":u?"dark":"light",children:r.jsx("div",{className:"prf-spinner"})}):!e||!t?null:g?r.jsx(xa,{children:r.jsxs("div",{className:"prf-page","data-theme":u?"dark":"light",children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>p(-1),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions",children:r.jsx("button",{onClick:d,"aria-label":"Toggle theme",children:u?r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"5"}),r.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]}):r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})})]})}),r.jsxs("main",{className:"prf-main",children:[r.jsxs("div",{className:"prf-hero",children:[r.jsx("div",{className:"prf-avatar-lg",children:g.photoURL?r.jsx("img",{src:g.photoURL,alt:g.name}):r.jsx("span",{children:ch(g.name)})}),r.jsx("h1",{className:"prf-name",children:g.name}),r.jsxs("div",{className:"prf-buddy-action",children:[w==="none"&&r.jsx("button",{className:"prf-btn prf-btn-primary",onClick:is,disabled:V,children:V?r.jsx("div",{className:"prf-btn-spinner"}):r.jsxs(r.Fragment,{children:[r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),r.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),"Add Buddy"]})}),w==="pending_out"&&r.jsx("button",{className:"prf-btn prf-btn-secondary",onClick:ce,disabled:V,children:V?r.jsx("div",{className:"prf-btn-spinner dark"}):"Cancel Request"}),w==="pending_in"&&r.jsxs("div",{className:"prf-btn-pair",children:[r.jsx("button",{className:"prf-btn prf-btn-success",onClick:Ts,disabled:V,children:V?r.jsx("div",{className:"prf-btn-spinner"}):"Accept"}),r.jsx("button",{className:"prf-btn prf-btn-secondary",onClick:ce,disabled:V,children:"Decline"})]}),w==="buddy"&&r.jsx("button",{className:"prf-btn prf-btn-danger",onClick:Se,disabled:V,children:V?r.jsx("div",{className:"prf-btn-spinner"}):"Remove Buddy"})]})]}),Me?r.jsx("div",{className:"prf-stats-loading",children:r.jsx("div",{className:"prf-spinner"})}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"prf-stats",children:[r.jsxs("div",{className:"prf-stat",children:[r.jsx("span",{className:"prf-stat-value",children:X}),r.jsx("span",{className:"prf-stat-label",children:"Workouts"})]}),r.jsxs("div",{className:"prf-stat",children:[r.jsxs("span",{className:"prf-stat-value",children:[YD(re),r.jsx("span",{className:"prf-stat-unit",children:re>=1e3?"":"kg"})]}),r.jsxs("span",{className:"prf-stat-label",children:[re>=1e6?"Million kg":re>=1e3?"Tonnes":"Volume"," Lifted"]})]}),r.jsxs("div",{className:"prf-stat",children:[r.jsxs("span",{className:"prf-stat-value",children:[Le,r.jsx("span",{className:"prf-stat-unit",children:"wk"})]}),r.jsx("span",{className:"prf-stat-label",children:"Streak"})]})]}),(ue||qe>0)&&r.jsxs("div",{className:"prf-info-row",children:[ue&&r.jsxs("div",{className:"prf-info-card info-programme",children:[r.jsx("div",{className:"prf-info-icon",children:r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M4 19.5A2.5 2.5 0 0 1 6.5 17H20"}),r.jsx("path",{d:"M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"})]})}),r.jsxs("div",{className:"prf-info-text",children:[r.jsx("span",{className:"prf-info-label",children:ue}),r.jsx("div",{className:"prf-info-progress-bar",children:r.jsx("div",{className:"prf-info-progress-fill",style:{width:`${Math.min(Ae,100)}%`}})}),r.jsxs("span",{className:"prf-info-sub",children:[Ae,"% complete"]})]})]}),qe>0&&r.jsxs("div",{className:"prf-info-card info-habit",children:[r.jsx("div",{className:"prf-info-icon",children:r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),r.jsx("path",{d:"M22 4L12 14.01l-3-3"})]})}),r.jsxs("div",{className:"prf-info-text",children:[r.jsxs("span",{className:"prf-info-value",children:[qe," day",qe!==1?"s":""]}),r.jsx("span",{className:"prf-info-sub",children:"Habit Streak"})]})]})]}),kt.length>0&&r.jsxs("div",{className:"prf-section",children:[r.jsx("h2",{className:"prf-section-title",children:"Top Lifts"}),r.jsx("div",{className:"prf-pb-list",children:kt.map((J,be)=>r.jsxs("div",{className:"prf-pb-item",children:[r.jsx("div",{className:"prf-pb-rank",children:be===0?r.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",stroke:"none",children:r.jsx("path",{d:"M12 2l2.4 7.4H22l-6 4.4 2.3 7.2L12 16.6 5.7 21l2.3-7.2-6-4.4h7.6z"})}):`#${be+1}`}),r.jsx("span",{className:"prf-pb-name",children:J.name}),r.jsxs("span",{className:"prf-pb-weight",children:[J.weight,r.jsx("span",{className:"prf-pb-unit",children:"kg"})," x",J.reps]})]},be))})]}),Wt.length>0&&r.jsxs("div",{className:"prf-section",children:[r.jsxs("h2",{className:"prf-section-title",children:["Badges Earned (",Wt.length,")"]}),r.jsx("div",{className:"prf-badge-row",children:Wt.map(J=>{const be=hu.find(it=>it.id===J);return be?r.jsx("button",{className:"prf-badge-chip",onClick:()=>pt(be),children:r.jsx("img",{src:be.img,alt:be.name,className:"prf-badge-chip-img"})},J):null})})]}),At&&r.jsx("div",{className:"prf-badge-overlay",onClick:()=>pt(null),children:r.jsxs("div",{className:"prf-badge-overlay-content",onClick:J=>J.stopPropagation(),children:[r.jsx("img",{src:At.img,alt:At.name,className:"prf-badge-overlay-img"}),r.jsx("p",{className:"prf-badge-overlay-desc",children:At.desc}),r.jsx("button",{className:"prf-badge-overlay-close",onClick:()=>pt(null),children:"Tap to close"})]})})]}),r.jsxs("div",{className:"prf-section",children:[r.jsx("h2",{className:"prf-section-title",children:`${g.name?.split(" ")[0]}'s Journey`}),Ee?r.jsx("div",{className:"journey-loading",children:r.jsx("div",{className:"prf-spinner"})}):ye.length===0?r.jsxs("div",{className:"journey-empty",children:[r.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),r.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),r.jsx("path",{d:"M21 15l-5-5L5 21"})]}),r.jsx("p",{children:"No posts yet"})]}):r.jsx("div",{className:"journey-list",children:ye.map(J=>r.jsxs("div",{className:"journey-post",children:[r.jsxs("div",{className:"journey-post-header",children:[r.jsx("div",{className:"journey-post-avatar",children:J.authorPhotoURL?r.jsx("img",{src:J.authorPhotoURL,alt:""}):r.jsx("span",{children:ch(J.authorName)})}),r.jsxs("div",{className:"journey-post-meta",children:[r.jsx("span",{className:"journey-post-name",children:J.authorName}),r.jsx("span",{className:"journey-post-time",children:T2(J.createdAt)})]}),J.authorId===i.id&&r.jsx("button",{className:"journey-delete-btn",onClick:()=>et(J.id),"aria-label":"Delete post",children:r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M3 6h18"}),r.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),r.jsx("path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]}),J.content&&r.jsx("p",{className:"journey-post-content",children:J.content}),J.imageURL&&r.jsx("div",{className:"journey-post-image",children:r.jsx("img",{src:J.imageURL,alt:"Post",loading:"lazy"})}),r.jsxs("div",{className:"journey-post-actions",children:[r.jsxs("button",{className:`journey-action-btn${T.has(J.id)?" liked":""}`,onClick:()=>Ue(J.id),children:[r.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:T.has(J.id)?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})}),r.jsx("span",{children:J.likeCount||0})]}),r.jsxs("button",{className:`journey-action-btn${L.has(J.id)?" active":""}`,onClick:()=>He(J.id),children:[r.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})}),r.jsx("span",{children:J.commentCount||0})]})]}),L.has(J.id)&&r.jsxs("div",{className:"journey-comments",children:[z[J.id]?.length>0?z[J.id].map(be=>r.jsxs("div",{className:"journey-comment",children:[r.jsx("div",{className:"journey-comment-avatar",onClick:()=>p(`/client/core-buddy/profile/${be.authorId}`),children:be.authorPhotoURL?r.jsx("img",{src:be.authorPhotoURL,alt:""}):r.jsx("span",{children:ch(be.authorName)})}),r.jsxs("div",{className:"journey-comment-body",children:[r.jsxs("div",{className:"journey-comment-bubble",children:[r.jsx("span",{className:"journey-comment-name",children:be.authorName}),r.jsx("span",{className:"journey-comment-text",children:be.content})]}),r.jsx("span",{className:"journey-comment-time",children:T2(be.createdAt)})]})]},be.id)):r.jsx("p",{className:"journey-no-comments",children:"No comments yet"}),r.jsxs("div",{className:"journey-comment-input",style:{position:"relative"},children:[r.jsx("input",{type:"text",placeholder:"Comment... (@ to mention)",value:Ge[J.id]||"",onChange:be=>Mt(J.id,be.target.value),onKeyDown:be=>{be.key==="Enter"&&Yt(J.id)},maxLength:300}),Xe&&zs===J.id&&Ut.length>0&&r.jsx("div",{className:"mention-dropdown mention-dropdown-up",children:Ut.map(be=>r.jsxs("button",{className:"mention-option",onClick:()=>yt(be,J.id),children:[r.jsx("div",{className:"mention-option-avatar",children:be.photoURL?r.jsx("img",{src:be.photoURL,alt:""}):r.jsx("span",{children:ch(be.name)})}),r.jsx("span",{children:be.name})]},be.id))}),r.jsx("button",{onClick:()=>Yt(J.id),disabled:!(Ge[J.id]||"").trim()||$[J.id],children:$[J.id]?r.jsx("div",{className:"journey-btn-spinner-sm"}):r.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("line",{x1:"22",y1:"2",x2:"11",y2:"13"}),r.jsx("polygon",{points:"22 2 15 22 11 13 2 9 22 2"})]})})]})]})]},J.id))})]})]}),r.jsx(aa,{}),K&&r.jsxs("div",{className:`toast-notification ${K.type}`,children:[r.jsx("span",{className:"toast-icon",children:K.type==="success"?r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M5 13 L9 17 L19 7"})}):K.type==="error"?r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]}):r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),r.jsx("circle",{cx:"12",cy:"16",r:"1",fill:"currentColor"})]})}),r.jsx("span",{className:"toast-message",children:K.message})]})]})}):r.jsxs("div",{className:"prf-page","data-theme":u?"dark":"light",children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>p(-1),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"}),r.jsx("div",{className:"header-actions"})]})}),r.jsx("main",{className:"prf-main",children:r.jsx("p",{style:{textAlign:"center",color:"var(--text-tertiary)",padding:"40px 0"},children:"User not found"})}),r.jsx(aa,{})]})}function JD(){const n=$n(),{clientData:e,currentUser:t,resolveClient:i,updateClientData:l}=Mr(),[u,d]=v.useState([]),[p,g]=v.useState(""),[y,w]=v.useState(!1),[k,j]=v.useState(null),[O,H]=v.useState(!1),[B,V]=v.useState(null),se=v.useRef(null),K=v.useRef(null);if(!e?.buddyEnabled)return r.jsxs("div",{className:"buddy-page",children:[r.jsxs("div",{className:"buddy-container",children:[r.jsx("p",{children:"Buddy is not enabled on your account."}),r.jsx("button",{onClick:()=>n("/client/core-buddy"),children:"Back to Dashboard"})]}),r.jsx(aa,{active:"home"})]});v.useEffect(()=>{se.current&&se.current.scrollIntoView({behavior:"smooth"})},[u,y]),v.useEffect(()=>{u.length===0&&!y&&oe([])},[]);const oe=async T=>{w(!0),j(null);try{const L=await(await fetch("/api/buddy-onboarding",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({messages:T,clientName:e?.name||t?.displayName||"there"})})).json();if(L.error){j(L.error);return}const D={role:"assistant",content:L.reply};d(z=>[...z,D]),L.profileData&&(await R(L.profileData),V(L.profileData),H(!0))}catch(A){console.error("Buddy chat error:",A),j("Something went wrong  try sending again.")}finally{w(!1)}},ye=()=>{const T=p.trim();if(!T||y)return;const A={role:"user",content:T},L=[...u,A];d(L),g(""),K.current&&K.current.focus(),oe(L)},Pe=T=>{T.key==="Enter"&&!T.shiftKey&&(T.preventDefault(),ye())},Ee=T=>{const A=T?.experience||"beginner";return A==="advanced"?{id:"fullbody_12wk",name:"12-Week Full Body",duration:12,level:"Advanced",daysPerWeek:3,description:"Complete transformation programme  push, pull, and legs over three phases."}:A==="intermediate"?{id:"fullbody_8wk",name:"8-Week Full Body",duration:8,level:"Intermediate",daysPerWeek:3,description:"Two-phase programme building strength and endurance across your full body."}:{id:"fullbody_4wk",name:"4-Week Full Body",duration:4,level:"All Levels",daysPerWeek:3,description:"Build total body strength with compound dumbbell movements and bodyweight finishers."}},R=async T=>{try{const A=await i();if(!A)return;await Ss(We(fe,"onboardingSubmissions",A.id),{clientId:A.id,clientName:A.name,email:A.email,source:"buddy_chat",welcome:{dob:T.dob||null,gender:T.gender||null,goals:T.goals||[],experience:T.experience||null,injuries:T.injuries||null,activityLevel:T.activityLevel||null,exerciseHistory:T.exerciseHistory||null,sleepHours:T.sleepHours||null,stressLevel:T.stressLevel||null,dietaryInfo:T.dietaryInfo||null,availability:T.availability||null,additionalInfo:T.additionalInfo||null},submittedAt:Hr()});const L=T.goals||[];await Ma(We(fe,"clients",A.id),{fitnessGoal:L[0]||null,fitnessGoals:L,experienceLevel:T.experience||null,dob:T.dob||null,injuries:T.injuries||null}),l({fitnessGoal:L[0]||null,fitnessGoals:L,experienceLevel:T.experience,dob:T.dob})}catch(A){console.error("Save profile error:",A)}};return r.jsx(xa,{children:r.jsxs("div",{className:"buddy-page buddy-page--chat",children:[r.jsxs("div",{className:"buddy-chat-container",children:[r.jsxs("div",{className:"buddy-chat-top",children:[r.jsx("button",{className:"buddy-back",onClick:()=>n("/client/core-buddy"),children:r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsxs("div",{className:"buddy-chat-header",children:[r.jsx("div",{className:"buddy-chat-avatar",children:r.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M12 2a4 4 0 0 1 4 4v2a4 4 0 0 1-8 0V6a4 4 0 0 1 4-4z"}),r.jsx("path",{d:"M18 14c2 1 3 3 3 5v2H3v-2c0-2 1-4 3-5"}),r.jsx("circle",{cx:"9",cy:"7",r:"0.5",fill:"currentColor"}),r.jsx("circle",{cx:"15",cy:"7",r:"0.5",fill:"currentColor"}),r.jsx("path",{d:"M9.5 10a2.5 2.5 0 0 0 5 0"})]})}),r.jsxs("div",{children:[r.jsx("h2",{className:"buddy-chat-name",children:"Buddy"}),r.jsx("span",{className:"buddy-chat-status",children:y?"typing...":"Your AI Coach"})]})]})]}),r.jsxs("div",{className:"buddy-chat-messages",children:[u.map((T,A)=>r.jsxs("div",{className:`buddy-chat-bubble buddy-chat-${T.role}`,children:[T.role==="assistant"&&r.jsx("div",{className:"buddy-chat-bubble-avatar",children:"B"}),r.jsx("div",{className:"buddy-chat-bubble-content",children:T.content})]},A)),y&&r.jsxs("div",{className:"buddy-chat-bubble buddy-chat-assistant",children:[r.jsx("div",{className:"buddy-chat-bubble-avatar",children:"B"}),r.jsxs("div",{className:"buddy-chat-bubble-content buddy-chat-typing",children:[r.jsx("span",{}),r.jsx("span",{}),r.jsx("span",{})]})]}),k&&r.jsxs("div",{className:"buddy-chat-error",children:[k,r.jsx("button",{onClick:()=>oe(u),children:"Retry"})]}),r.jsx("div",{ref:se})]}),O?r.jsx("div",{className:"buddy-chat-done",children:B?(()=>{const T=Ee(B);return r.jsxs(r.Fragment,{children:[r.jsx("p",{className:"buddy-chat-done-text",children:"Profile saved! Here's my pick for you:"}),r.jsxs("div",{className:"buddy-rec-card",onClick:()=>n("/client/core-buddy/programmes",{state:{templateId:T.id}}),children:[r.jsx("div",{className:"buddy-rec-name",children:T.name}),r.jsxs("div",{className:"buddy-rec-meta",children:[T.duration," weeks  ",T.daysPerWeek," days/week  ",T.level]}),r.jsx("div",{className:"buddy-rec-desc",children:T.description}),r.jsx("div",{className:"buddy-rec-cta",children:"View Programme"})]}),r.jsx("button",{className:"buddy-chat-skip-btn",onClick:()=>n("/client/core-buddy"),children:"Maybe later"})]})})():r.jsxs(r.Fragment,{children:[r.jsx("p",{className:"buddy-chat-done-text",children:"Profile saved  you're all set."}),r.jsx("button",{className:"buddy-chat-done-btn",onClick:()=>n("/client/core-buddy"),children:"Back to Dashboard"})]})}):r.jsxs("div",{className:"buddy-chat-input-wrap",children:[r.jsx("textarea",{ref:K,className:"buddy-chat-input",placeholder:"Type your message...",value:p,onChange:T=>g(T.target.value),onKeyDown:Pe,rows:1,disabled:y}),r.jsx("button",{className:"buddy-chat-send",onClick:ye,disabled:!p.trim()||y,"aria-label":"Send message",children:r.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("line",{x1:"22",y1:"2",x2:"11",y2:"13"}),r.jsx("polygon",{points:"22 2 15 22 11 13 2 9 22 2"})]})})]})]}),r.jsx(aa,{active:"home"})]})})}const ma=[{key:"pressUps",name:"Press-Ups",category:"Upper Body",unit:"reps"},{key:"squats",name:"Squats",category:"Lower Body",unit:"reps"},{key:"longJump",name:"Standing Long Jump",category:"Power",unit:"distance"},{key:"deadHang",name:"Dead Hang",category:"Upper Body",unit:"time"},{key:"plank",name:"Plank",category:"Core",unit:"time"},{key:"wallSit",name:"Wall Sit",category:"Lower Body",unit:"time"},{key:"chestPress",name:"Chest Press",category:"Upper Body",unit:"weight"}],Po=[{key:"weight",name:"Weight",suffix:"kg"},{key:"chest",name:"Chest",suffix:"cm"},{key:"waist",name:"Waist",suffix:"cm"},{key:"hips",name:"Hips",suffix:"cm"},{key:"leftArm",name:"Left Arm",suffix:"cm"},{key:"rightArm",name:"Right Arm",suffix:"cm"},{key:"leftThigh",name:"Left Thigh",suffix:"cm"},{key:"rightThigh",name:"Right Thigh",suffix:"cm"}];function ZD(){const n=new Date;return`${n.getFullYear()}-${String(n.getMonth()+1).padStart(2,"0")}`}function fa(n){const[e,t]=n.split("-");return new Date(parseInt(e),parseInt(t)-1).toLocaleDateString("en-GB",{month:"long",year:"numeric"})}function eP(n){if(!n&&n!==0)return"-";const e=Math.floor(n/60),t=(n%60).toFixed(2);return e>0?`${e}m ${parseFloat(t).toFixed(0)}s`:`${parseFloat(t).toFixed(2)}s`}function tP(n,e){return!n&&n!==0?"-":!e&&e!==0?`${n}kg`:`${n}kg x ${e}`}function uh(n,e){if(!e)return"-";switch(n.unit){case"weight":return tP(e.weight,e.reps);case"time":return eP(e.time);case"reps":return e.reps?`${e.reps} reps`:"-";case"distance":return e.distance?`${e.distance} cm`:"-";default:return"-"}}function Pl(n,e){if(!e)return 0;switch(n.unit){case"weight":return(e.weight||0)*(e.reps||0);case"time":return e.time||0;case"reps":return e.reps||0;case"distance":return e.distance||0;default:return 0}}function Jp(n,e){return!e||e===0?null:(n-e)/e*100}function sP({data:n,exerciseKey:e,unit:t}){if(!n||n.length<2)return r.jsx("div",{className:"pb-trend-empty",children:r.jsx("p",{children:"Not enough data for trend line yet"})});const i=n.map(B=>{const V=B.benchmarks?.[e];if(!V)return 0;switch(t){case"weight":return(V.weight||0)*(V.reps||0);case"time":return V.time||0;case"reps":return V.reps||0;case"distance":return V.distance||0;default:return 0}}),l=Math.max(...i),u=Math.min(...i),d=l-u||1,p=300,g=100,y=20,w=p-y*2,k=g-y*2,j=i.map((B,V)=>{const se=y+V/(i.length-1)*w,K=y+k-(B-u)/d*k;return{x:se,y:K,value:B}}),O=j.map((B,V)=>`${V===0?"M":"L"} ${B.x} ${B.y}`).join(" "),H=O+` L ${j[j.length-1].x} ${y+k} L ${j[0].x} ${y+k} Z`;return r.jsxs("div",{className:"pb-trend-chart",children:[r.jsxs("svg",{viewBox:`0 0 ${p} ${g}`,preserveAspectRatio:"xMidYMid meet",children:[r.jsx("defs",{children:r.jsxs("linearGradient",{id:"trendGradientJr",x1:"0",y1:"0",x2:"0",y2:"1",children:[r.jsx("stop",{offset:"0%",stopColor:"var(--color-primary)",stopOpacity:"0.3"}),r.jsx("stop",{offset:"100%",stopColor:"var(--color-primary)",stopOpacity:"0.02"})]})}),r.jsx("path",{d:H,fill:"url(#trendGradientJr)"}),r.jsx("path",{d:O,fill:"none",stroke:"var(--color-primary)",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round"}),j.map((B,V)=>r.jsx("circle",{cx:B.x,cy:B.y,r:"4",fill:"var(--bg-card)",stroke:"var(--color-primary)",strokeWidth:"2"},V))]}),r.jsx("div",{className:"pb-trend-labels",children:n.map((B,V)=>r.jsxs("span",{className:"pb-trend-label",children:[B.month.split("-")[1],"/",B.month.split("-")[0].slice(2)]},V))})]})}function nP(){const[n,e]=v.useState("bests"),[t,i]=v.useState([]),[l,u]=v.useState(!0),[d,p]=v.useState(!1),[g,y]=v.useState(0),[w,k]=v.useState(!1),[j,O]=v.useState(!1),[H,B]=v.useState(!1),[V,se]=v.useState({}),[K,oe]=v.useState({}),[ye,Pe]=v.useState({}),[Ee,R]=v.useState({}),[T,A]=v.useState({}),[L,D]=v.useState(!1),[z,M]=v.useState({}),[Ge,mt]=v.useState([]),[$,pe]=v.useState(null),[Me,Qe]=v.useState(null),[X,P]=v.useState(!1),[re,Re]=v.useState(""),[Le,tt]=v.useState(""),qe=v.useRef(null),ft=v.useRef(0),kt=v.useRef(0),rt=v.useRef("right"),Wt=v.useCallback(F=>{y(ve=>{const we=Math.max(0,Math.min(ma.length-1,F));return we===ve?ve:(rt.current=we>ve?"right":"left",we)})},[]),{currentUser:_s,isClient:At,clientData:pt,loading:ue}=Mr(),{isDark:Zt}=ka(),Ae=$n(),Fe=v.useCallback((F,ve="info")=>{Qe({message:F,type:ve}),setTimeout(()=>Qe(null),4e3)},[]);v.useEffect(()=>{!ue&&(!_s||!At)&&Ae("/")},[_s,At,ue,Ae]),v.useEffect(()=>{pt&&Ze()},[pt]);const Ze=async()=>{try{const F=Ps($t(fe,"juniorPBs"),us("clientId","==",pt.id)),we=(await js(F)).docs.map(lt=>({id:lt.id,...lt.data()}));we.sort((lt,bt)=>lt.month.localeCompare(bt.month)),i(we);const _e=Ps($t(fe,"juniorPBTargets"),us("clientId","==",pt.id)),ge=await js(_e);if(!ge.empty){const lt=ge.docs[0].data();Pe(lt.targets||{}),R(lt.metricTargets||{}),A(lt.targets||{}),M(lt.metricTargets||{})}const at=Ps($t(fe,"juniorAchievements"),us("clientId","==",pt.id)),Rt=await js(at);Rt.empty||mt(Rt.docs[0].data().badges||[])}catch(F){console.error("Error fetching junior personal bests:",F)}u(!1)},Ke=ZD(),Xe=t.find(F=>F.month===Ke),Ct=t.filter(F=>F.month<Ke),zs=Ct.length>0?Ct[Ct.length-1]:null;v.useEffect(()=>{Xe?(se(Xe.benchmarks||{}),oe(Xe.bodyMetrics||{})):(se({}),oe({}))},[Xe?.id]);const gt=async(F,ve)=>{const we=[];if(F==="strength"?ma.forEach(_e=>{const ge=ye[_e.key];if(!ge)return;const at=ve[_e.key];if(!at)return;let Rt;if(ge.targetType==="time"){if(!ge.targetValue)return;const lt=ge.startValue||0,bt=at.time||0,Tt=ge.targetValue-lt;Rt=Tt===0?bt>=ge.targetValue?1:0:Math.max(0,(bt-lt)/Tt)}else if(ge.targetType==="reps"){if(!ge.targetReps)return;const lt=ge.startReps||0,bt=at.reps||0,Tt=ge.targetReps-lt;Rt=Tt===0?bt>=ge.targetReps?1:0:Math.max(0,(bt-lt)/Tt)}else if(ge.targetType==="distance"){if(!ge.targetDistance)return;const lt=ge.startDistance||0,bt=at.distance||0,Tt=ge.targetDistance-lt;Rt=Tt===0?bt>=ge.targetDistance?1:0:Math.max(0,(bt-lt)/Tt)}else{if(!ge.targetWeight&&!ge.targetReps)return;const lt=(ge.startWeight||0)*(ge.startReps||0),bt=(ge.targetWeight||0)*(ge.targetReps||0),Tt=(at.weight||0)*(at.reps||0),os=bt-lt;Rt=os===0?Tt>=bt?1:0:Math.max(0,(Tt-lt)/os)}if(Rt>=1){let lt,bt;ge.targetType==="time"?(lt=Ge.some(Tt=>Tt.type==="strength"&&Tt.key===_e.key&&Tt.targetValue===ge.targetValue),bt=`${_e.name} ${ge.targetValue}s`):ge.targetType==="reps"?(lt=Ge.some(Tt=>Tt.type==="strength"&&Tt.key===_e.key&&Tt.targetReps===ge.targetReps),bt=`${_e.name} ${ge.targetReps} reps`):ge.targetType==="distance"?(lt=Ge.some(Tt=>Tt.type==="strength"&&Tt.key===_e.key&&Tt.targetDistance===ge.targetDistance),bt=`${_e.name} ${ge.targetDistance}cm`):(lt=Ge.some(Tt=>Tt.type==="strength"&&Tt.key===_e.key&&Tt.targetWeight===ge.targetWeight&&Tt.targetReps===ge.targetReps),bt=`${_e.name} ${ge.targetWeight}kg  ${ge.targetReps}`),lt||we.push({type:"strength",key:_e.key,...ge.targetType==="time"?{targetType:"time",targetValue:ge.targetValue}:ge.targetType==="reps"?{targetType:"reps",targetReps:ge.targetReps}:ge.targetType==="distance"?{targetType:"distance",targetDistance:ge.targetDistance}:{targetWeight:ge.targetWeight,targetReps:ge.targetReps},achievedMonth:Ke,label:bt})}}):Po.forEach(_e=>{const ge=Ee[_e.key];if(!ge||!ge.targetValue)return;const at=ve[_e.key];if(at==null)return;const Rt=ge.startValue||0,lt=ge.targetValue,bt=lt-Rt;(bt===0?at===lt?1:0:Math.max(0,(at-Rt)/bt))>=1&&(Ge.some(Bn=>Bn.type==="metric"&&Bn.key===_e.key&&Bn.targetValue===lt)||we.push({type:"metric",key:_e.key,targetValue:lt,achievedMonth:Ke,label:`${_e.name} ${lt}${_e.suffix}`}))}),we.length>0){const _e=[...Ge,...we];await Ss(We(fe,"juniorAchievements",pt.id),{clientId:pt.id,badges:_e,updatedAt:vt.now()}),mt(_e),pe(we),setTimeout(()=>pe(null),5e3)}},Ut=(F,ve)=>{if(F==="strength"){const we=ye[ve];if(!we)return!1;switch(ma.find(ge=>ge.key===ve)?.unit){case"time":return Ge.some(ge=>ge.type==="strength"&&ge.key===ve&&ge.targetValue===we.targetValue);case"reps":return Ge.some(ge=>ge.type==="strength"&&ge.key===ve&&ge.targetReps===we.targetReps);case"distance":return Ge.some(ge=>ge.type==="strength"&&ge.key===ve&&ge.targetDistance===we.targetDistance);default:return!we.targetWeight&&!we.targetReps?!1:Ge.some(ge=>ge.type==="strength"&&ge.key===ve&&ge.targetWeight===we.targetWeight&&ge.targetReps===we.targetReps)}}else{const we=Ee[ve];return!we||!we.targetValue?!1:Ge.some(_e=>_e.type==="metric"&&_e.key===ve&&_e.targetValue===we.targetValue)}},Bs=async()=>{p(!0);try{const F=`${pt.id}_${Ke}`,ve=Xe||{};await Ss(We(fe,"juniorPBs",F),{clientId:pt.id,month:Ke,benchmarks:V,bodyMetrics:ve.bodyMetrics||K||{},createdAt:ve.createdAt||vt.now(),updatedAt:vt.now()}),await gt("strength",V),Fe("Benchmarks saved!","success"),k(!1),await Ze()}catch(F){console.error("Error saving benchmarks:",F),Fe("Failed to save. Please try again.","error")}p(!1)},qt=async()=>{p(!0);try{const F=`${pt.id}_${Ke}`,ve=Xe||{};await Ss(We(fe,"juniorPBs",F),{clientId:pt.id,month:Ke,benchmarks:ve.benchmarks||V||{},bodyMetrics:K,createdAt:ve.createdAt||vt.now(),updatedAt:vt.now()}),await gt("metric",K),Fe("Body metrics saved!","success"),O(!1),await Ze()}catch(F){console.error("Error saving metrics:",F),Fe("Failed to save. Please try again.","error")}p(!1)},Cs=(F,ve,we)=>{se(_e=>({..._e,[F]:{..._e[F],[ve]:we===""?"":parseFloat(we)}}))},is=(F,ve)=>{oe(we=>({...we,[F]:ve===""?"":parseFloat(ve)}))},Ts=(F,ve,we)=>{A(_e=>({..._e,[F]:{..._e[F],[ve]:we===""?"":parseFloat(we)}}))},ce=async()=>{p(!0);try{const F=`targets_${pt.id}`,ve=Xe?.benchmarks||{},we={};ma.forEach(_e=>{const ge=ve[_e.key];switch(_e.unit){case"time":T[_e.key]?.targetValue&&(we[_e.key]={targetType:"time",targetValue:T[_e.key].targetValue,startValue:ge?.time||0});break;case"reps":T[_e.key]?.targetReps&&(we[_e.key]={targetType:"reps",targetReps:T[_e.key].targetReps,startReps:ge?.reps||0});break;case"distance":T[_e.key]?.targetDistance&&(we[_e.key]={targetType:"distance",targetDistance:T[_e.key].targetDistance,startDistance:ge?.distance||0});break;default:(T[_e.key]?.targetWeight||T[_e.key]?.targetReps)&&(we[_e.key]={targetWeight:T[_e.key].targetWeight||0,targetReps:T[_e.key].targetReps||0,startWeight:ge?.weight||0,startReps:ge?.reps||0})}}),await Ss(We(fe,"juniorPBTargets",F),{clientId:pt.id,targets:we,metricTargets:Ee,updatedAt:vt.now()}),Pe(we),A(we),Fe("Targets saved!","success"),B(!1)}catch(F){console.error("Error saving targets:",F),Fe("Failed to save targets.","error")}p(!1)},Se=(F,ve)=>{M(we=>({...we,[F]:{...we[F],targetValue:ve===""?"":parseFloat(ve)}}))},Be=async()=>{p(!0);try{const F=`targets_${pt.id}`,ve={};Po.forEach(we=>{if(z[we.key]?.targetValue){const _e=Xe?.bodyMetrics?.[we.key]||0;ve[we.key]={targetValue:z[we.key].targetValue,startValue:_e}}}),await Ss(We(fe,"juniorPBTargets",F),{clientId:pt.id,targets:ye,metricTargets:ve,updatedAt:vt.now()}),R(ve),M(ve),Fe("Metric targets saved!","success"),D(!1)}catch(F){console.error("Error saving metric targets:",F),Fe("Failed to save targets.","error")}p(!1)},et=async()=>{if(window.confirm("Reset all goals? This will clear all strength and body metric targets. Your recorded benchmarks and measurements will NOT be affected.")){p(!0);try{const F=We(fe,"juniorPBTargets",`targets_${pt.id}`);await yr(F),Pe({}),R({}),A({}),M({}),Fe("All goals have been reset","success")}catch(F){console.error("Error resetting targets:",F),Fe("Failed to reset goals","error")}p(!1)}},Ue=(F,ve)=>{const we=ye[F];if(!we||!ve)return null;if(we.targetType==="time"){if(!we.targetValue)return null;const lt=we.startValue||0,bt=we.targetValue,Tt=ve.time||0,os=bt-lt;return os<=0?Tt>=bt?1:0:Math.max(0,Math.min((Tt-lt)/os,1))}if(we.targetType==="reps"){if(!we.targetReps)return null;const lt=we.startReps||0,bt=we.targetReps,Tt=ve.reps||0,os=bt-lt;return os<=0?Tt>=bt?1:0:Math.max(0,Math.min((Tt-lt)/os,1))}if(we.targetType==="distance"){if(!we.targetDistance)return null;const lt=we.startDistance||0,bt=we.targetDistance,Tt=ve.distance||0,os=bt-lt;return os<=0?Tt>=bt?1:0:Math.max(0,Math.min((Tt-lt)/os,1))}if(!we.targetWeight&&!we.targetReps)return null;const _e=(we.startWeight||0)*(we.startReps||0),ge=(we.targetWeight||0)*(we.targetReps||0),at=(ve.weight||0)*(ve.reps||0),Rt=ge-_e;return Rt<=0?at>=ge?1:0:Math.max(0,Math.min((at-_e)/Rt,1))},De=F=>{const ve=Ee[F];if(!ve||!ve.targetValue)return null;const we=Xe?.bodyMetrics?.[F];if(we==null)return null;const _e=ve.startValue||0,ge=ve.targetValue,at=ge-_e;return at===0?we===ge?1:0:Math.max(0,Math.min((we-_e)/at,1))},He=F=>{ft.current=F.touches[0].clientX,kt.current=0},wt=F=>{kt.current=F.touches[0].clientX-ft.current},yt=()=>{kt.current<-50?Wt(g+1):kt.current>50&&Wt(g-1),kt.current=0},Mt=F=>{const ve=Xe?.bodyMetrics?.[F],we=zs?.bodyMetrics?.[F];return ve==null||we==null?null:parseFloat((ve-we).toFixed(2))},Yt=t.find(F=>F.month===re),J=t.find(F=>F.month===Le);if(ue||l)return r.jsxs("div",{className:"pb-page",children:[r.jsx("header",{className:"client-header",children:r.jsx("div",{className:"header-content",children:r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})})}),r.jsxs("main",{className:"pb-main",children:[r.jsx("div",{className:"skeleton skeleton-title",style:{width:180,height:28,marginBottom:20}}),r.jsx("div",{className:"skeleton skeleton-card-large",style:{height:320,borderRadius:16}})]})]});if(!_s||!At||!pt)return null;const be=ma[g],it=Xe?.benchmarks?.[be.key],Dt=zs?.benchmarks?.[be.key],jt=Pl(be,it),ss=Pl(be,Dt),Qt=Jp(jt,ss),zt=Ue(be.key,it),Rs=zt!==null,Zs=zt!==null&&zt>=1,ds=Rs?Math.round(zt*60):jt>0?15:0,Es=ye[be.key],Ls=F=>F?F.targetType==="time"?`${F.startValue||0}s  ${F.targetValue}s`:F.targetType==="reps"?`${F.startReps||0}  ${F.targetReps} reps`:F.targetType==="distance"?`${F.startDistance||0}  ${F.targetDistance}cm`:`${F.startWeight||0}kg${F.startReps||0}  ${F.targetWeight}kg${F.targetReps}`:null;return r.jsxs("div",{className:"pb-page",children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>Ae("/client"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})]})}),r.jsxs("main",{className:"pb-main page-transition-enter",children:[r.jsxs("div",{className:"pb-intro",children:[r.jsx("h2",{children:"Junior Strength Tests"}),r.jsx("p",{children:"Track your strength test results and body measurements each month."})]}),r.jsxs("div",{className:"pb-tabs",children:[r.jsx("button",{className:`pb-tab ${n==="bests"?"active":""}`,onClick:()=>e("bests"),children:"Strength"}),r.jsx("button",{className:`pb-tab ${n==="metrics"?"active":""}`,onClick:()=>e("metrics"),children:"Body Metrics"}),r.jsx("button",{className:`pb-tab ${n==="history"?"active":""}`,onClick:()=>e("history"),children:"History"})]}),n==="bests"&&r.jsxs("div",{className:"pb-strength-section",children:[!w&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"pb-carousel",ref:qe,onTouchStart:He,onTouchMove:wt,onTouchEnd:yt,children:[r.jsx("div",{className:`pb-ring-container slide-from-${rt.current}`,children:r.jsxs("div",{className:"pb-ring",children:[r.jsx("svg",{className:"pb-ring-svg",viewBox:"0 0 200 200",children:Yy.map((F,ve)=>{const we=ve<Math.round(ds);return r.jsx("line",{x1:F.x1,y1:F.y1,x2:F.x2,y2:F.y2,className:`pb-ring-tick ${we?Zs?"hit":"filled":"empty"}`,strokeWidth:F.thick?"3":"2"},ve)})}),r.jsxs("div",{className:"pb-ring-center",children:[r.jsx("div",{className:"pb-ring-category",children:be.category}),r.jsxs("div",{className:"pb-ring-exercise",children:[be.name,Ut("strength",be.key)&&r.jsx("svg",{className:"pb-badge-icon",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})]}),r.jsx("div",{className:"pb-ring-value",children:it?uh(be,it):"-"}),Qt!==null&&r.jsxs("div",{className:`pb-ring-change ${Qt>=0?"positive":"negative"}`,children:[Qt>=0?"+":"",Qt.toFixed(1),"%"]}),Qt===null&&it&&r.jsx("div",{className:"pb-ring-change neutral",children:"New entry"}),Es&&r.jsx("div",{className:`pb-ring-target ${Zs?"hit":""}`,children:Zs?"Target hit!":Ls(Es)}),!Es&&r.jsx("div",{className:"pb-ring-target none",children:"No target set"})]})]})},g),r.jsx("div",{className:"pb-carousel-dots",children:ma.map((F,ve)=>r.jsx("button",{className:`pb-dot ${ve===g?"active":""}`,onClick:()=>Wt(ve)},ve))}),r.jsx("button",{className:"pb-carousel-arrow left",onClick:()=>Wt(g-1),disabled:g===0,children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"})})}),r.jsx("button",{className:"pb-carousel-arrow right",onClick:()=>Wt(g+1),disabled:g===ma.length-1,children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M8.59 16.59L10 18l6-6-6-6-1.41 1.41L13.17 12z"})})})]}),r.jsxs("div",{className:"pb-trend-section",children:[r.jsx("h4",{children:"Trend"}),r.jsx(sP,{data:t,exerciseKey:be.key,unit:be.unit})]})]}),!w&&!H&&r.jsxs("div",{className:"pb-action-buttons",children:[r.jsx("button",{className:"pb-edit-btn",onClick:()=>k(!0),children:Xe?.benchmarks?"Edit This Month's Benchmarks":"Add This Month's Benchmarks"}),r.jsx("button",{className:"pb-edit-btn pb-target-btn",onClick:()=>B(!0),children:Object.keys(ye).length>0?"Edit Targets":"Set Targets"}),(Object.keys(ye).length>0||Object.keys(Ee).length>0)&&r.jsx("button",{className:"pb-edit-btn pb-reset-btn",onClick:et,disabled:d,children:"Reset All Goals"})]}),w&&r.jsxs("div",{className:"pb-edit-card",children:[r.jsxs("div",{className:"pb-edit-header",children:[r.jsxs("h3",{children:["Benchmarks - ",fa(Ke)]}),r.jsx("button",{className:"pb-edit-close",onClick:()=>{k(!1),se(Xe?.benchmarks||{})},children:""})]}),r.jsx("div",{className:"pb-edit-body",children:ma.map(F=>r.jsxs("div",{className:"pb-edit-exercise",children:[r.jsx("div",{className:"pb-edit-exercise-name",children:F.name}),F.unit==="weight"?r.jsxs("div",{className:"pb-edit-row",children:[r.jsxs("div",{className:"pb-edit-field",children:[r.jsx("label",{children:"Weight (kg)"}),r.jsx("input",{type:"number",step:"0.5",value:V[F.key]?.weight??"",onChange:ve=>Cs(F.key,"weight",ve.target.value),placeholder:"0"})]}),r.jsxs("div",{className:"pb-edit-field",children:[r.jsx("label",{children:"Reps"}),r.jsx("input",{type:"number",value:V[F.key]?.reps??"",onChange:ve=>Cs(F.key,"reps",ve.target.value),placeholder:"0"})]})]}):F.unit==="reps"?r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsx("label",{children:"Reps (max in 1 min)"}),r.jsx("input",{type:"number",value:V[F.key]?.reps??"",onChange:ve=>Cs(F.key,"reps",ve.target.value),placeholder:"0"})]})}):F.unit==="distance"?r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsx("label",{children:"Distance (cm)"}),r.jsx("input",{type:"number",step:"0.5",value:V[F.key]?.distance??"",onChange:ve=>Cs(F.key,"distance",ve.target.value),placeholder:"0"})]})}):r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsx("label",{children:"Time (seconds)"}),r.jsx("input",{type:"number",step:"0.01",value:V[F.key]?.time??"",onChange:ve=>Cs(F.key,"time",ve.target.value),placeholder:"0"})]})})]},F.key))}),r.jsxs("div",{className:"pb-edit-actions",children:[r.jsx("button",{className:"pb-cancel-btn",onClick:()=>{k(!1),se(Xe?.benchmarks||{})},children:"Cancel"}),r.jsx("button",{className:"pb-save-btn",onClick:Bs,disabled:d,children:d?"Saving...":"Save"})]})]}),H&&r.jsxs("div",{className:"pb-edit-card",children:[r.jsxs("div",{className:"pb-edit-header",children:[r.jsx("h3",{children:"Set Your Targets"}),r.jsx("button",{className:"pb-edit-close",onClick:()=>{B(!1),A(ye)},children:""})]}),r.jsxs("div",{className:"pb-edit-body",children:[r.jsx("p",{className:"pb-target-hint",children:"Set a target for each exercise. Your current best is captured automatically from your latest benchmarks."}),ma.map(F=>{const ve=Xe?.benchmarks?.[F.key];let we="-";if(ve)switch(F.unit){case"weight":(ve.weight||ve.reps)&&(we=`${ve.weight||0}kg  ${ve.reps||0}`);break;case"time":ve.time&&(we=`${ve.time}s`);break;case"reps":ve.reps&&(we=`${ve.reps} reps`);break;case"distance":ve.distance&&(we=`${ve.distance} cm`);break}return r.jsxs("div",{className:"pb-edit-exercise",children:[r.jsxs("div",{className:"pb-edit-exercise-header",children:[r.jsx("div",{className:"pb-edit-exercise-name",children:F.name}),r.jsxs("div",{className:"pb-edit-current-best",children:["Current: ",we]})]}),F.unit==="weight"?r.jsxs("div",{className:"pb-edit-row",children:[r.jsxs("div",{className:"pb-edit-field",children:[r.jsx("label",{children:"Target Weight (kg)"}),r.jsx("input",{type:"number",step:"0.5",value:T[F.key]?.targetWeight??"",onChange:_e=>Ts(F.key,"targetWeight",_e.target.value),placeholder:"0"})]}),r.jsxs("div",{className:"pb-edit-field",children:[r.jsx("label",{children:"Target Reps"}),r.jsx("input",{type:"number",value:T[F.key]?.targetReps??"",onChange:_e=>Ts(F.key,"targetReps",_e.target.value),placeholder:"0"})]})]}):F.unit==="reps"?r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsx("label",{children:"Target Reps (in 1 min)"}),r.jsx("input",{type:"number",value:T[F.key]?.targetReps??"",onChange:_e=>Ts(F.key,"targetReps",_e.target.value),placeholder:"0"})]})}):F.unit==="distance"?r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsx("label",{children:"Target Distance (cm)"}),r.jsx("input",{type:"number",step:"0.5",value:T[F.key]?.targetDistance??"",onChange:_e=>Ts(F.key,"targetDistance",_e.target.value),placeholder:"0"})]})}):r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsx("label",{children:"Target (seconds)"}),r.jsx("input",{type:"number",step:"1",value:T[F.key]?.targetValue??"",onChange:_e=>Ts(F.key,"targetValue",_e.target.value),placeholder:"0"})]})})]},F.key)})]}),r.jsxs("div",{className:"pb-edit-actions",children:[r.jsx("button",{className:"pb-cancel-btn",onClick:()=>{B(!1),A(ye)},children:"Cancel"}),r.jsx("button",{className:"pb-save-btn",onClick:ce,disabled:d,children:d?"Saving...":"Save Targets"})]})]})]}),n==="metrics"&&r.jsxs("div",{className:"pb-metrics-section",children:[!j&&!L&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"pb-metrics-card",children:[r.jsx("h3",{children:"Body Measurements"}),r.jsx("p",{className:"pb-metrics-month",children:fa(Ke)}),r.jsx("div",{className:"pb-metrics-list",children:Po.map(F=>{const ve=Xe?.bodyMetrics?.[F.key],we=Mt(F.key),_e=Ee[F.key],ge=De(F.key),at=ge!==null&&ge>=1;return r.jsxs("div",{className:"pb-metric-row",children:[r.jsxs("div",{className:"pb-metric-top",children:[r.jsxs("div",{className:"pb-metric-left",children:[r.jsxs("span",{className:"pb-metric-name",children:[F.name,Ut("metric",F.key)&&r.jsx("svg",{className:"pb-badge-icon-sm",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})]}),_e&&r.jsxs("span",{className:"pb-metric-target-label",children:["Target: ",_e.targetValue," ",F.suffix]})]}),r.jsxs("div",{className:"pb-metric-values",children:[r.jsx("span",{className:"pb-metric-current",children:ve!=null?`${ve} ${F.suffix}`:"-"}),we!==null&&r.jsxs("span",{className:`pb-metric-change ${we>0?"up":we<0?"down":"same"}`,children:[we>0?"+":"",we," ",F.suffix]})]})]}),ge!==null&&r.jsxs("div",{className:"pb-metric-progress",children:[r.jsx("div",{className:"pb-metric-bar",children:r.jsx("div",{className:`pb-metric-bar-fill ${at?"hit":""}`,style:{width:`${Math.round(ge*100)}%`}})}),r.jsx("span",{className:`pb-metric-percent ${at?"hit":""}`,children:at?"Hit!":`${Math.round(ge*100)}%`})]})]},F.key)})})]}),r.jsxs("div",{className:"pb-action-buttons",children:[r.jsx("button",{className:"pb-edit-btn",onClick:()=>O(!0),children:Xe?.bodyMetrics?"Edit This Month's Measurements":"Add This Month's Measurements"}),r.jsx("button",{className:"pb-edit-btn pb-target-btn",onClick:()=>D(!0),children:Object.keys(Ee).length>0?"Edit Targets":"Set Targets"}),(Object.keys(ye).length>0||Object.keys(Ee).length>0)&&r.jsx("button",{className:"pb-edit-btn pb-reset-btn",onClick:et,disabled:d,children:"Reset All Goals"})]})]}),j&&r.jsxs("div",{className:"pb-edit-card",children:[r.jsxs("div",{className:"pb-edit-header",children:[r.jsxs("h3",{children:["Measurements - ",fa(Ke)]}),r.jsx("button",{className:"pb-edit-close",onClick:()=>{O(!1),oe(Xe?.bodyMetrics||{})},children:""})]}),r.jsx("div",{className:"pb-edit-body",children:Po.map(F=>r.jsx("div",{className:"pb-edit-metric",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsxs("label",{children:[F.name," (",F.suffix,")"]}),r.jsx("input",{type:"number",step:"0.1",value:K[F.key]??"",onChange:ve=>is(F.key,ve.target.value),placeholder:"0"})]})},F.key))}),r.jsxs("div",{className:"pb-edit-actions",children:[r.jsx("button",{className:"pb-cancel-btn",onClick:()=>{O(!1),oe(Xe?.bodyMetrics||{})},children:"Cancel"}),r.jsx("button",{className:"pb-save-btn",onClick:qt,disabled:d,children:d?"Saving...":"Save"})]})]}),L&&r.jsxs("div",{className:"pb-edit-card",children:[r.jsxs("div",{className:"pb-edit-header",children:[r.jsx("h3",{children:"Body Metric Targets"}),r.jsx("button",{className:"pb-edit-close",onClick:()=>{D(!1),M(Ee)},children:""})]}),r.jsxs("div",{className:"pb-edit-body",children:[r.jsx("p",{className:"pb-target-hint",children:"Set targets for your body measurements. Your current measurement is captured automatically."}),Po.map(F=>{const ve=Xe?.bodyMetrics?.[F.key];return r.jsxs("div",{className:"pb-edit-exercise",children:[r.jsxs("div",{className:"pb-edit-exercise-header",children:[r.jsx("div",{className:"pb-edit-exercise-name",children:F.name}),r.jsxs("div",{className:"pb-edit-current-best",children:["Current: ",ve!=null?`${ve} ${F.suffix}`:"-"]})]}),r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsxs("label",{children:["Target (",F.suffix,")"]}),r.jsx("input",{type:"number",step:"0.1",value:z[F.key]?.targetValue??"",onChange:we=>Se(F.key,we.target.value),placeholder:"0"})]})})]},F.key)})]}),r.jsxs("div",{className:"pb-edit-actions",children:[r.jsx("button",{className:"pb-cancel-btn",onClick:()=>{D(!1),M(Ee)},children:"Cancel"}),r.jsx("button",{className:"pb-save-btn",onClick:Be,disabled:d,children:d?"Saving...":"Save Targets"})]})]})]}),n==="history"&&r.jsx("div",{className:"pb-history-section",children:t.length===0?r.jsxs("div",{className:"pb-empty",children:[r.jsx("h4",{children:"No records yet"}),r.jsx("p",{children:"Start adding your monthly benchmarks and measurements to track your progress over time."})]}):r.jsxs(r.Fragment,{children:[Ge.length>0&&r.jsxs("div",{className:"pb-achievements-wall",children:[r.jsxs("h4",{className:"pb-achievements-wall-title",children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"18",height:"18",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),"Targets Achieved"]}),r.jsx("div",{className:"pb-achievements-list",children:[...Ge].reverse().map((F,ve)=>r.jsxs("div",{className:"pb-achievement-item",style:{animationDelay:`${ve*.05}s`},children:[r.jsx("div",{className:"pb-achievement-star",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),r.jsxs("div",{className:"pb-achievement-info",children:[r.jsx("span",{className:"pb-achievement-label",children:F.label}),r.jsx("span",{className:"pb-achievement-date",children:fa(F.achievedMonth)})]})]},ve))})]}),r.jsx("div",{className:"pb-history-controls",children:r.jsx("button",{className:`pb-compare-toggle ${X?"active":""}`,onClick:()=>{P(!X),!X&&t.length>=2&&(Re(t[0].month),tt(t[t.length-1].month))},children:X?"Back to Timeline":"Compare Months"})}),X?r.jsxs("div",{className:"pb-compare",children:[r.jsxs("div",{className:"pb-compare-selectors",children:[r.jsxs("div",{className:"pb-compare-select",children:[r.jsx("label",{children:"From"}),r.jsx("select",{value:re,onChange:F=>Re(F.target.value),children:t.map(F=>r.jsx("option",{value:F.month,children:fa(F.month)},F.month))})]}),r.jsx("div",{className:"pb-compare-vs",children:"vs"}),r.jsxs("div",{className:"pb-compare-select",children:[r.jsx("label",{children:"To"}),r.jsx("select",{value:Le,onChange:F=>tt(F.target.value),children:t.map(F=>r.jsx("option",{value:F.month,children:fa(F.month)},F.month))})]})]}),Yt&&J&&r.jsxs("div",{className:"pb-compare-results",children:[r.jsxs("div",{className:"pb-compare-group",children:[r.jsx("h4",{children:"Strength Tests"}),r.jsxs("div",{className:"pb-compare-table",children:[r.jsxs("div",{className:"pb-compare-header-row",children:[r.jsx("span",{children:"Exercise"}),r.jsx("span",{children:fa(re).split(" ")[0]}),r.jsx("span",{children:fa(Le).split(" ")[0]}),r.jsx("span",{children:"Change"})]}),ma.map(F=>{const ve=Yt.benchmarks?.[F.key],we=J.benchmarks?.[F.key],_e=Pl(F,ve),ge=Pl(F,we),at=Jp(ge,_e);return r.jsxs("div",{className:"pb-compare-row",children:[r.jsx("span",{className:"pb-compare-name",children:F.name}),r.jsx("span",{className:"pb-compare-val",children:ve?uh(F,ve):"-"}),r.jsx("span",{className:"pb-compare-val",children:we?uh(F,we):"-"}),r.jsx("span",{className:`pb-compare-change ${at!==null?at>=0?"positive":"negative":""}`,children:at!==null?`${at>=0?"+":""}${at.toFixed(1)}%`:"-"})]},F.key)})]})]}),r.jsxs("div",{className:"pb-compare-group",children:[r.jsx("h4",{children:"Body Measurements"}),r.jsxs("div",{className:"pb-compare-table",children:[r.jsxs("div",{className:"pb-compare-header-row",children:[r.jsx("span",{children:"Measurement"}),r.jsx("span",{children:fa(re).split(" ")[0]}),r.jsx("span",{children:fa(Le).split(" ")[0]}),r.jsx("span",{children:"Change"})]}),Po.map(F=>{const ve=Yt.bodyMetrics?.[F.key],we=J.bodyMetrics?.[F.key],_e=ve!=null&&we!=null?parseFloat((we-ve).toFixed(2)):null;return r.jsxs("div",{className:"pb-compare-row",children:[r.jsx("span",{className:"pb-compare-name",children:F.name}),r.jsx("span",{className:"pb-compare-val",children:ve!=null?`${ve}`:"-"}),r.jsx("span",{className:"pb-compare-val",children:we!=null?`${we}`:"-"}),r.jsx("span",{className:`pb-compare-change ${_e!==null?_e>0?"positive":_e<0?"negative":"neutral":""}`,children:_e!==null?`${_e>0?"+":""}${_e} ${F.suffix}`:"-"})]},F.key)})]})]})]})]}):r.jsx("div",{className:"pb-timeline",children:[...t].reverse().map((F,ve)=>{const we=t.filter(_e=>_e.month<F.month).pop();return r.jsxs("div",{className:"pb-timeline-item",style:{animationDelay:`${ve*.05}s`},children:[r.jsx("div",{className:"pb-timeline-dot"}),r.jsxs("div",{className:"pb-timeline-card",children:[r.jsx("h4",{children:fa(F.month)}),F.benchmarks&&Object.keys(F.benchmarks).length>0&&r.jsxs("div",{className:"pb-timeline-group",children:[r.jsx("h5",{children:"Strength Tests"}),ma.map(_e=>{const ge=F.benchmarks[_e.key];if(!ge)return null;const at=we?.benchmarks?.[_e.key],Rt=Pl(_e,ge),lt=Pl(_e,at),bt=Jp(Rt,lt);return r.jsxs("div",{className:"pb-timeline-row",children:[r.jsx("span",{className:"pb-timeline-label",children:_e.name}),r.jsxs("div",{className:"pb-timeline-values",children:[r.jsx("span",{className:"pb-timeline-value",children:uh(_e,ge)}),bt!==null&&r.jsxs("span",{className:`pb-timeline-change ${bt>=0?"positive":"negative"}`,children:[bt>=0?"+":"",bt.toFixed(1),"%"]})]})]},_e.key)})]}),F.bodyMetrics&&Object.keys(F.bodyMetrics).length>0&&r.jsxs("div",{className:"pb-timeline-group",children:[r.jsx("h5",{children:"Body Measurements"}),Po.map(_e=>{const ge=F.bodyMetrics[_e.key];if(ge==null)return null;const at=we?.bodyMetrics?.[_e.key],Rt=at!=null?parseFloat((ge-at).toFixed(2)):null;return r.jsxs("div",{className:"pb-timeline-row",children:[r.jsx("span",{className:"pb-timeline-label",children:_e.name}),r.jsxs("div",{className:"pb-timeline-values",children:[r.jsxs("span",{className:"pb-timeline-value",children:[ge," ",_e.suffix]}),Rt!==null&&r.jsxs("span",{className:`pb-timeline-change ${Rt>0?"positive":Rt<0?"negative":"neutral"}`,children:[Rt>0?"+":"",Rt," ",_e.suffix]})]})]},_e.key)})]})]})]},F.id)})})]})})]}),$&&r.jsx("div",{className:"pb-celebration-overlay",onClick:()=>pe(null),children:r.jsxs("div",{className:"pb-celebration-card",children:[r.jsx("div",{className:"pb-celebration-icon",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),r.jsx("h3",{className:"pb-celebration-title",children:$.length===1?"Target Achieved!":`${$.length} Targets Achieved!`}),r.jsx("div",{className:"pb-celebration-badges",children:$.map((F,ve)=>r.jsx("div",{className:"pb-celebration-badge",children:F.label},ve))}),r.jsx("p",{className:"pb-celebration-sub",children:"Tap to dismiss"})]})}),Me&&r.jsxs("div",{className:`toast-notification ${Me.type}`,children:[r.jsx("span",{className:"toast-icon",children:Me.type==="success"?r.jsx("svg",{className:"success-check-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{className:"check-path",d:"M5 13 L9 17 L19 7"})}):r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})}),r.jsx("span",{className:"toast-message",children:Me.message}),r.jsx("button",{className:"toast-close",onClick:()=>Qe(null),children:""})]}),r.jsxs("nav",{className:"block-bottom-nav",children:[r.jsxs("button",{className:"block-nav-tab",onClick:()=>Ae("/client"),children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}),r.jsx("polyline",{points:"9 22 9 12 15 12 15 22"})]}),r.jsx("span",{children:"Home"})]}),r.jsxs("button",{className:"block-nav-tab",onClick:()=>Ae("/client/forms"),children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),r.jsx("polyline",{points:"14 2 14 8 20 8"}),r.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),r.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"})]}),r.jsx("span",{children:"Forms"})]}),r.jsxs("button",{className:"block-nav-tab",onClick:()=>Ae("/client/tools"),children:[r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"})}),r.jsx("span",{children:"Tools"})]}),r.jsxs("button",{className:"block-nav-tab active",children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M12 20V10"}),r.jsx("path",{d:"M18 20V4"}),r.jsx("path",{d:"M6 20v-4"})]}),r.jsx("span",{children:"PBs"})]}),pt?.circuitAccess&&r.jsxs("button",{className:"block-nav-tab",onClick:()=>Ae("/client/circuit"),children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("path",{d:"M12 6v6l4 2"})]}),r.jsx("span",{children:"Circuit"})]})]})]})}const Pk=[{name:"Dumbbell Floor Press",type:"weighted",equipment:"dumbbells",group:"push",pbKey:"chestPress",storagePath:"exercises/dumbbells/upper/dumbbell floor press.mp4"},{name:"Seated Dumbbell Shoulder Press",type:"weighted",equipment:"dumbbells",group:"push",pbKey:"shoulderPress",storagePath:"exercises/dumbbells/upper/seated dumbbell shoulder press.mp4"},{name:"Seated Dumbbell Arnold Press",type:"weighted",equipment:"dumbbells",group:"push",storagePath:"exercises/dumbbells/upper/seated dumbbell arnold press.mp4"},{name:"Dumbbell Overhead Tricep Extension",type:"weighted",equipment:"dumbbells",group:"push",storagePath:"exercises/dumbbells/upper/dumbbell overhead tricep extension.mp4"},{name:"Skullcrushers",type:"weighted",equipment:"dumbbells",group:"push",storagePath:"exercises/dumbbells/upper/skullcrushers.mp4"},{name:"Dumbbell Lateral Raise",type:"weighted",equipment:"dumbbells",group:"push",storagePath:"exercises/dumbbells/upper/dumbbell lateral raise.mp4"},{name:"Dumbbell Front Raise",type:"weighted",equipment:"dumbbells",group:"push",storagePath:"exercises/dumbbells/upper/dumbbell front raise.mp4"},{name:"Press Up",type:"reps",equipment:"bodyweight",group:"push",storagePath:"exercises/bodyweight/upper/press up.mp4"},{name:"Tricep Dips",type:"reps",equipment:"bodyweight",group:"push",storagePath:"exercises/bodyweight/upper/tricep dips.mp4"},{name:"Pike Push Ups",type:"reps",equipment:"bodyweight",group:"push",storagePath:"exercises/bodyweight/upper/pike push ups.GIF"},{name:"Reverse Plank",type:"timed",equipment:"bodyweight",group:"push",storagePath:"exercises/bodyweight/upper/reverse plank.GIF"},{name:"Dumbbell Squeeze Press",type:"weighted",equipment:"dumbbells",group:"push",storagePath:null},{name:"Incline Dumbbell Press",type:"weighted",equipment:"dumbbells",group:"push",storagePath:null},{name:"Dumbbell Pullover",type:"weighted",equipment:"dumbbells",group:"push",storagePath:null},{name:"Dumbbell Fly",type:"weighted",equipment:"dumbbells",group:"push",storagePath:null},{name:"Tricep Kickback",type:"weighted",equipment:"dumbbells",group:"push",storagePath:null},{name:"Dumbbell Shrug",type:"weighted",equipment:"dumbbells",group:"push",storagePath:null},{name:"Dumbbell Y-Raise",type:"weighted",equipment:"dumbbells",group:"push",storagePath:null},{name:"Wide Press Up",type:"reps",equipment:"bodyweight",group:"push",storagePath:null},{name:"Diamond Press Up",type:"reps",equipment:"bodyweight",group:"push",storagePath:null},{name:"Decline Press Up",type:"reps",equipment:"bodyweight",group:"push",storagePath:null},{name:"Wall Walks",type:"reps",equipment:"bodyweight",group:"push",storagePath:null},{name:"Press Up Hold",type:"timed",equipment:"bodyweight",group:"push",storagePath:null},{name:"Shoulder Tap Hold",type:"timed",equipment:"bodyweight",group:"push",storagePath:null},{name:"Dumbbell Bent Over Row",type:"weighted",equipment:"dumbbells",group:"pull",pbKey:"seatedRow",storagePath:"exercises/dumbbells/upper/dumbbell bent over row.mp4"},{name:"Single Arm Bent Over Row",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:"exercises/dumbbells/upper/single arm bent over row.mp4"},{name:"Bicep Curl",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:"exercises/dumbbells/upper/bicep curl.mp4"},{name:"Hammer Curl",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:"exercises/dumbbells/upper/hammer curl.mp4"},{name:"Dumbbell Bent Over Rear Delt Fly",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:"exercises/dumbbells/upper/dumbbell bent over rear delt fly.mp4"},{name:"Renegade Row",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:"exercises/dumbbells/upper/renegade row.mp4"},{name:"Wide Dumbbell Bent Over Row",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:null},{name:"Reverse Fly",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:null},{name:"Concentration Curl",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:null},{name:"Wide Grip Bicep Curl",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:null},{name:"Wrist Curl",type:"weighted",equipment:"dumbbells",group:"pull",storagePath:null},{name:"Prone Y-T-W Raises",type:"reps",equipment:"bodyweight",group:"pull",storagePath:null},{name:"Reverse Snow Angel",type:"reps",equipment:"bodyweight",group:"pull",storagePath:null},{name:"Isometric Bicep Hold",type:"timed",equipment:"bodyweight",group:"pull",storagePath:null},{name:"Dumbbell Goblet Squats",type:"weighted",equipment:"dumbbells",group:"lower",pbKey:"squat",storagePath:"exercises/dumbbells/lower/dumbbell goblet squats.mp4"},{name:"Romanian Deadlifts",type:"weighted",equipment:"dumbbells",group:"lower",pbKey:"deadlift",storagePath:"exercises/dumbbells/lower/romanian deadlifts.GIF"},{name:"Forward Dumbbell Lunges",type:"weighted",equipment:"dumbbells",group:"lower",storagePath:"exercises/dumbbells/lower/forward dumbbell lunges.GIF"},{name:"Dumbbell Sumo Squats",type:"weighted",equipment:"dumbbells",group:"lower",storagePath:"exercises/dumbbells/lower/dumbbell sumo squats.GIF"},{name:"Weighted Calf Raises",type:"weighted",equipment:"dumbbells",group:"lower",storagePath:"exercises/dumbbells/lower/weighted calf raises.GIF"},{name:"1 Legged RDL",type:"weighted",equipment:"dumbbells",group:"lower",storagePath:"exercises/dumbbells/lower/1 legged rdl.GIF"},{name:"Dumbbell Box Step Ups",type:"weighted",equipment:"dumbbells",group:"lower",storagePath:"exercises/dumbbells/lower/dumbbell box step ups.mp4"},{name:"Dumbbell Squat Pulses",type:"weighted",equipment:"dumbbells",group:"lower",storagePath:"exercises/dumbbells/lower/dumbbell squat pulses.GIF"},{name:"Dumbbell Reverse Lunges",type:"weighted",equipment:"dumbbells",group:"lower",storagePath:"exercises/dumbbells/lower/dumbbell reverse lunges.GIF"},{name:"Kettlebell Romanian Deadlift",type:"weighted",equipment:"kettlebell",group:"lower",storagePath:"exercises/kettlebells/lower/kettlebell romanian deadlift.mp4"},{name:"Reverse Lunge",type:"reps",equipment:"bodyweight",group:"lower",storagePath:"exercises/bodyweight/lower/reverse lunge.GIF"},{name:"Box Step Ups",type:"reps",equipment:"bodyweight",group:"lower",storagePath:"exercises/bodyweight/lower/box step ups.GIF"},{name:"Bulgarian Split Squats",type:"reps",equipment:"bodyweight",group:"lower",storagePath:"exercises/bodyweight/lower/bulgarian split squats.GIF"},{name:"Jump Squats",type:"reps",equipment:"bodyweight",group:"lower",storagePath:"exercises/bodyweight/lower/jump squats.GIF"},{name:"Hip Thrusts",type:"reps",equipment:"bodyweight",group:"lower",storagePath:"exercises/bodyweight/lower/hip thrusts.GIF"},{name:"Donkey Kicks",type:"reps",equipment:"bodyweight",group:"lower",storagePath:"exercises/bodyweight/lower/donkey kicks.GIF"},{name:"Skater Jumps",type:"reps",equipment:"bodyweight",group:"lower",storagePath:"exercises/bodyweight/lower/skater jumps.GIF"},{name:"Squat And Hold",type:"timed",equipment:"bodyweight",group:"lower",storagePath:"exercises/bodyweight/lower/squat and hold.GIF"},{name:"Forearm Plank",type:"timed",equipment:"bodyweight",group:"core",pbKey:"plank",storagePath:"exercises/bodyweight/core/Forearm Plank.mp4"},{name:"Side Plank",type:"timed",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Side Plank.mp4"},{name:"Hollow Body Hold",type:"timed",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Hollow Body Hold.mp4"},{name:"Superman Hold",type:"timed",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Superman Hold.mp4"},{name:"Mountain Climbers",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Mountain Climbers.mp4"},{name:"Fast Mountain Climbers",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Fast Mountain Climbers.mp4"},{name:"Cross Body Mountain Climbers",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Cross Body Mountain Climbers.mp4"},{name:"Russian Twist",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Russian Twist.mp4"},{name:"Crunch",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Crunch.mp4"},{name:"Bicycle Crunch",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Bicycle Crunch.mp4"},{name:"Leg Raises",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Leg Raises.mp4"},{name:"Dead Bug",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Dead Bug.mp4"},{name:"Dead Bug Single Leg Drop",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Dead Bug Single Leg Drop.mp4"},{name:"Bird Dog",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Bird Dog.mp4"},{name:"Flutter Kicks",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Flutter Kicks.mp4"},{name:"Hollow Hold Flutter Kicks",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Hollow Hold Flutter Kicks.mp4"},{name:"High Plank Shoulder Taps",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/High Plank Shoulder Taps.mp4"},{name:"Hip Dips Plank",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Hip Dips Plank.mp4"},{name:"Single Leg V-Up",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Single Leg V-Up.mp4"},{name:"Hollow Hold To V-Sit",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Hollow Hold To V-sit.mp4"},{name:"Toe Reaches",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/toe reaches.GIF"},{name:"Side Plank Rotation",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Side Plank Rotation.mp4"},{name:"Plank Walkout",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Plank Walkout.mp4"},{name:"Reverse Crunch To Leg Raise",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Reverse Crunch To Leg Raise.mp4"},{name:"Burpee",type:"reps",equipment:"bodyweight",group:"core",storagePath:"exercises/bodyweight/core/Burpee.mp4"},{name:"Russian Twists Dumbbell",type:"weighted",equipment:"dumbbells",group:"core",storagePath:"exercises/dumbbells/core/russian twists dumbbell.GIF"},{name:"Kettlebell Russian Twist",type:"weighted",equipment:"kettlebell",group:"core",storagePath:"exercises/kettlebells/core/kettlebell russian twist.mp4"},{name:"Kettlebell Side Bends",type:"weighted",equipment:"kettlebell",group:"core",storagePath:"exercises/kettlebells/core/kettlebell side bends.mp4"},{name:"Kneeling Kettlebell Halo",type:"weighted",equipment:"kettlebell",group:"core",storagePath:"exercises/kettlebells/core/kneeling kettlebell halo.mp4"},{name:"Kettlebell Bird Dog Drag",type:"reps",equipment:"kettlebell",group:"core",storagePath:"exercises/kettlebells/core/kettlebell bird dog drag.mp4"},{name:"Back Extension Hold",type:"timed",equipment:"bodyweight",group:"core",storagePath:null},{name:"Dumbbell Plank Pull Through",type:"weighted",equipment:"dumbbells",group:"core",storagePath:null}];Pk.filter(n=>n.storagePath!==null);const rP=[{key:"push",label:"Push",subtitle:"Chest / Shoulders / Triceps",color:"#A12F3A",icon:"M4 10v4M8 7v10M8 12h8M16 7v10M20 10v4"},{key:"pull",label:"Pull",subtitle:"Back / Biceps",color:"#2196f3",icon:"M4 12h16M12 4v16M7 7l10 10M17 7L7 17"},{key:"lower",label:"Lower",subtitle:"Legs / Glutes",color:"#ff9800",icon:"M13 2L3 14h9l-1 8 10-12h-9l1-8z"},{key:"core",label:"Core",subtitle:"Abs / Stability",color:"#7c3aed",icon:"M12 22c5.52 0 10-4.48 10-10S17.52 2 12 2 2 6.48 2 12s4.48 10 10 10zM12 18c3.31 0 6-2.69 6-6s-2.69-6-6-6-6 2.69-6 6 2.69 6 6 6zM12 14a2 2 0 1 0 0-4 2 2 0 0 0 0 4z"}],Lk={};Pk.forEach(n=>{Lk[n.name]=n.group});function aP(n){return Lk[n]||null}const Aa=[{key:"chestPress",name:"Chest Press",category:"Upper Body - Push",unit:"weight"},{key:"shoulderPress",name:"Shoulder Press",category:"Upper Body - Push",unit:"weight"},{key:"seatedRow",name:"Seated Row",category:"Upper Body - Pull",unit:"weight"},{key:"latPulldown",name:"Lat Pulldown",category:"Upper Body - Pull",unit:"weight"},{key:"squat",name:"Squat",category:"Lower Body",unit:"weight"},{key:"deadlift",name:"Deadlift",category:"Lower Body",unit:"weight"},{key:"plank",name:"Plank",category:"Core",unit:"time"}],Lo=[{key:"weight",name:"Weight",suffix:"kg"},{key:"chest",name:"Chest",suffix:"cm"},{key:"waist",name:"Waist",suffix:"cm"},{key:"hips",name:"Hips",suffix:"cm"},{key:"leftArm",name:"Left Arm",suffix:"cm"},{key:"rightArm",name:"Right Arm",suffix:"cm"},{key:"leftThigh",name:"Left Thigh",suffix:"cm"},{key:"rightThigh",name:"Right Thigh",suffix:"cm"}];function iP(){const n=new Date;return`${n.getFullYear()}-${String(n.getMonth()+1).padStart(2,"0")}`}function pa(n){const[e,t]=n.split("-");return new Date(parseInt(e),parseInt(t)-1).toLocaleDateString("en-GB",{month:"long",year:"numeric"})}function dh(n){if(!n&&n!==0)return"-";const e=Math.floor(n/60),t=(n%60).toFixed(2);return e>0?`${e}m ${parseFloat(t).toFixed(0)}s`:`${parseFloat(t).toFixed(2)}s`}function E2(n,e){return!n&&n!==0?"-":!e&&e!==0?`${n}kg`:`${n}kg x ${e}`}function Ll(n,e){return e?n.unit==="time"?e.time||0:(e.weight||0)*(e.reps||0):0}function Zp(n,e){return!e||e===0?null:(n-e)/e*100}function oP({data:n,exerciseKey:e,unit:t}){if(!n||n.length<2)return r.jsx("div",{className:"pb-trend-empty",children:r.jsx("p",{children:"Not enough data for trend line yet"})});const i=n.map(B=>{const V=B.benchmarks?.[e];return V?t==="time"?V.time||0:(V.weight||0)*(V.reps||0):0}),l=Math.max(...i),u=Math.min(...i),d=l-u||1,p=300,g=100,y=20,w=p-y*2,k=g-y*2,j=i.map((B,V)=>{const se=y+V/(i.length-1)*w,K=y+k-(B-u)/d*k;return{x:se,y:K,value:B}}),O=j.map((B,V)=>`${V===0?"M":"L"} ${B.x} ${B.y}`).join(" "),H=O+` L ${j[j.length-1].x} ${y+k} L ${j[0].x} ${y+k} Z`;return r.jsxs("div",{className:"pb-trend-chart",children:[r.jsxs("svg",{viewBox:`0 0 ${p} ${g}`,preserveAspectRatio:"xMidYMid meet",children:[r.jsx("defs",{children:r.jsxs("linearGradient",{id:"trendGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[r.jsx("stop",{offset:"0%",stopColor:"var(--color-primary)",stopOpacity:"0.3"}),r.jsx("stop",{offset:"100%",stopColor:"var(--color-primary)",stopOpacity:"0.02"})]})}),r.jsx("path",{d:H,fill:"url(#trendGradient)"}),r.jsx("path",{d:O,fill:"none",stroke:"var(--color-primary)",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round"}),j.map((B,V)=>r.jsx("circle",{cx:B.x,cy:B.y,r:"4",fill:"var(--bg-card)",stroke:"var(--color-primary)",strokeWidth:"2"},V))]}),r.jsx("div",{className:"pb-trend-labels",children:n.map((B,V)=>r.jsxs("span",{className:"pb-trend-label",children:[B.month.split("-")[1],"/",B.month.split("-")[0].slice(2)]},V))})]})}function lP(){const[n,e]=v.useState("bests"),[t,i]=v.useState([]),[l,u]=v.useState(!0),[d,p]=v.useState(!1),[g,y]=v.useState(0),[w,k]=v.useState(!1),[j,O]=v.useState(!1),[H,B]=v.useState(!1),[V,se]=v.useState({}),[K,oe]=v.useState({}),[ye,Pe]=v.useState({}),[Ee,R]=v.useState({}),[T,A]=v.useState({}),[L,D]=v.useState(!1),[z,M]=v.useState({}),[Ge,mt]=v.useState([]),[$,pe]=v.useState(null),[Me,Qe]=v.useState(null),[X,P]=v.useState(!1),[re,Re]=v.useState(""),[Le,tt]=v.useState(""),[qe,ft]=v.useState({}),[kt,rt]=v.useState({}),[Wt,_s]=v.useState(null),[At,pt]=v.useState(null),[ue,Zt]=v.useState(""),Ae=v.useRef(null),Fe=v.useRef(0),Ze=v.useRef(0),Ke=v.useRef("right"),Xe=v.useCallback(G=>{y(he=>{const E=Math.max(0,Math.min(Aa.length-1,G));return E===he?he:(Ke.current=E>he?"right":"left",E)})},[]),{currentUser:Ct,isClient:zs,clientData:gt,loading:Ut}=Mr(),{isDark:Bs}=ka(),qt=$n(),[Cs]=ZE(),is=Cs.get("mode")==="corebuddy",Ts=!is&&(!gt?.clientType||gt.clientType==="block"),ce=v.useCallback((G,he="info")=>{Qe({message:G,type:he}),setTimeout(()=>Qe(null),4e3)},[]);v.useEffect(()=>{!Ut&&(!Ct||!zs)&&qt("/")},[Ct,zs,Ut,qt]),v.useEffect(()=>{gt&&(Ts?Se():(async()=>{try{const[he,E,S]=await Promise.all([Ns(We(fe,"coreBuddyPBs",gt.id)),Ns(We(fe,"coreBuddyTargets",gt.id)),Ns(We(fe,"coreBuddyAchievements",gt.id))]);he.exists()&&ft(he.data().exercises||{}),E.exists()&&rt(E.data().targets||{}),S.exists()&&_s(S.data())}catch(he){console.error("Error loading Core Buddy PBs:",he)}u(!1)})())},[gt]);const Se=async()=>{try{const G=Ps($t(fe,"personalBests"),us("clientId","==",gt.id)),E=(await js(G)).docs.map(Oe=>({id:Oe.id,...Oe.data()}));E.sort((Oe,Ve)=>Oe.month.localeCompare(Ve.month)),i(E);const S=Ps($t(fe,"personalBestTargets"),us("clientId","==",gt.id)),q=await js(S);if(!q.empty){const Oe=q.docs[0].data();Pe(Oe.targets||{}),R(Oe.metricTargets||{}),A(Oe.targets||{}),M(Oe.metricTargets||{})}const Z=Ps($t(fe,"achievements"),us("clientId","==",gt.id)),$e=await js(Z);$e.empty||mt($e.docs[0].data().badges||[])}catch(G){console.error("Error fetching personal bests:",G)}u(!1)},Be=async()=>{if(!At||!ue||!gt)return;const G=parseFloat(ue),he=qe[At];if(!he||G<=he.weight){ce("Target must be higher than current PB","error");return}p(!0);try{const E={...kt,[At]:{targetWeight:G,setAt:vt.now(),currentPBWhenSet:he.weight}};await Ss(We(fe,"coreBuddyTargets",gt.id),{clientId:gt.id,targets:E,updatedAt:vt.now()}),rt(E),pt(null),Zt(""),ce("Target set!","success")}catch(E){console.error("Error saving target:",E),ce("Failed to save target","error")}p(!1)},et=G=>{if(!Wt?.badges)return!1;const he=kt[G];return he?Wt.badges.some(E=>E.type==="pb_target"&&E.exercise===G&&E.targetWeight===he.targetWeight):!1},Ue=G=>{const he=kt[G];if(!he)return null;const E=qe[G];if(!E)return 0;const S=he.currentPBWhenSet||0,q=he.targetWeight,Z=q-S;return Z<=0?E.weight>=q?1:0:Math.max(0,Math.min((E.weight-S)/Z,1))},De=iP(),He=t.find(G=>G.month===De),wt=t.filter(G=>G.month<De),yt=wt.length>0?wt[wt.length-1]:null;v.useEffect(()=>{He?(se(He.benchmarks||{}),oe(He.bodyMetrics||{})):(se({}),oe({}))},[He?.id]);const Mt=async(G,he)=>{const E=[];if(G==="strength"?Aa.forEach(S=>{const q=ye[S.key];if(!q)return;const Z=he[S.key];if(!Z)return;let $e;if(q.targetType==="time"){if(!q.targetValue)return;const Oe=q.startValue||0,Ve=Z.time||0,It=q.targetValue-Oe;$e=It===0?Ve>=q.targetValue?1:0:Math.max(0,(Ve-Oe)/It)}else{if(!q.targetWeight&&!q.targetReps)return;const Oe=(q.startWeight||0)*(q.startReps||0),Ve=(q.targetWeight||0)*(q.targetReps||0),It=(Z.weight||0)*(Z.reps||0),Et=Ve-Oe;$e=Et===0?It>=Ve?1:0:Math.max(0,(It-Oe)/Et)}if($e>=1&&!(q.targetType==="time"?Ge.some(Ve=>Ve.type==="strength"&&Ve.key===S.key&&Ve.targetValue===q.targetValue):Ge.some(Ve=>Ve.type==="strength"&&Ve.key===S.key&&Ve.targetWeight===q.targetWeight&&Ve.targetReps===q.targetReps))){const Ve=q.targetType==="time"?`${S.name} ${q.targetValue}s`:`${S.name} ${q.targetWeight}kg  ${q.targetReps}`;E.push({type:"strength",key:S.key,...q.targetType==="time"?{targetType:"time",targetValue:q.targetValue}:{targetWeight:q.targetWeight,targetReps:q.targetReps},achievedMonth:De,label:Ve})}}):Lo.forEach(S=>{const q=Ee[S.key];if(!q||!q.targetValue)return;const Z=he[S.key];if(Z==null)return;const $e=q.startValue||0,Oe=q.targetValue,Ve=Oe-$e;(Ve===0?Z===Oe?1:0:Math.max(0,(Z-$e)/Ve))>=1&&(Ge.some(hs=>hs.type==="metric"&&hs.key===S.key&&hs.targetValue===Oe)||E.push({type:"metric",key:S.key,targetValue:Oe,achievedMonth:De,label:`${S.name} ${Oe}${S.suffix}`}))}),E.length>0){const S=[...Ge,...E];await Ss(We(fe,"achievements",gt.id),{clientId:gt.id,badges:S,updatedAt:vt.now()}),mt(S),pe(E),setTimeout(()=>pe(null),5e3)}},Yt=(G,he)=>{if(G==="strength"){const E=ye[he];return E?E.targetType==="time"?Ge.some(S=>S.type==="strength"&&S.key===he&&S.targetValue===E.targetValue):!E.targetWeight&&!E.targetReps?!1:Ge.some(S=>S.type==="strength"&&S.key===he&&S.targetWeight===E.targetWeight&&S.targetReps===E.targetReps):!1}else{const E=Ee[he];return!E||!E.targetValue?!1:Ge.some(S=>S.type==="metric"&&S.key===he&&S.targetValue===E.targetValue)}},J=async()=>{p(!0);try{const G=`${gt.id}_${De}`,he=He||{};await Ss(We(fe,"personalBests",G),{clientId:gt.id,month:De,benchmarks:V,bodyMetrics:he.bodyMetrics||K||{},createdAt:he.createdAt||vt.now(),updatedAt:vt.now()}),await Mt("strength",V),ce("Benchmarks saved!","success"),k(!1),await Se()}catch(G){console.error("Error saving benchmarks:",G),ce("Failed to save. Please try again.","error")}p(!1)},be=async()=>{p(!0);try{const G=`${gt.id}_${De}`,he=He||{};await Ss(We(fe,"personalBests",G),{clientId:gt.id,month:De,benchmarks:he.benchmarks||V||{},bodyMetrics:K,createdAt:he.createdAt||vt.now(),updatedAt:vt.now()}),await Mt("metric",K),ce("Body metrics saved!","success"),O(!1),await Se()}catch(G){console.error("Error saving metrics:",G),ce("Failed to save. Please try again.","error")}p(!1)},it=(G,he,E)=>{se(S=>({...S,[G]:{...S[G],[he]:E===""?"":parseFloat(E)}}))},Dt=(G,he)=>{oe(E=>({...E,[G]:he===""?"":parseFloat(he)}))},jt=(G,he,E)=>{A(S=>({...S,[G]:{...S[G],[he]:E===""?"":parseFloat(E)}}))},ss=async()=>{p(!0);try{const G=`targets_${gt.id}`,he=He?.benchmarks||{},E={};Aa.forEach(S=>{const q=he[S.key];S.unit==="time"?T[S.key]?.targetValue&&(E[S.key]={targetType:"time",targetValue:T[S.key].targetValue,startValue:q?.time||0}):(T[S.key]?.targetWeight||T[S.key]?.targetReps)&&(E[S.key]={targetWeight:T[S.key].targetWeight||0,targetReps:T[S.key].targetReps||0,startWeight:q?.weight||0,startReps:q?.reps||0})}),await Ss(We(fe,"personalBestTargets",G),{clientId:gt.id,targets:E,metricTargets:Ee,updatedAt:vt.now()}),Pe(E),A(E),ce("Targets saved!","success"),B(!1)}catch(G){console.error("Error saving targets:",G),ce("Failed to save targets.","error")}p(!1)},Qt=(G,he)=>{M(E=>({...E,[G]:{...E[G],targetValue:he===""?"":parseFloat(he)}}))},zt=async()=>{p(!0);try{const G=`targets_${gt.id}`,he={};Lo.forEach(E=>{if(z[E.key]?.targetValue){const S=He?.bodyMetrics?.[E.key]||0;he[E.key]={targetValue:z[E.key].targetValue,startValue:S}}}),await Ss(We(fe,"personalBestTargets",G),{clientId:gt.id,targets:ye,metricTargets:he,updatedAt:vt.now()}),R(he),M(he),ce("Metric targets saved!","success"),D(!1)}catch(G){console.error("Error saving metric targets:",G),ce("Failed to save targets.","error")}p(!1)},Rs=async()=>{if(window.confirm("Reset all goals? This will clear all strength and body metric targets. Your recorded benchmarks and measurements will NOT be affected.")){p(!0);try{const G=We(fe,"personalBestTargets",`targets_${gt.id}`);await yr(G),Pe({}),R({}),A({}),M({}),ce("All goals have been reset","success")}catch(G){console.error("Error resetting targets:",G),ce("Failed to reset goals","error")}p(!1)}},Zs=(G,he)=>{const E=ye[G];if(!E||!he)return null;if(E.targetType==="time"){if(!E.targetValue)return null;const Oe=E.startValue||0,Ve=E.targetValue,It=he.time||0,Et=Ve-Oe;return Et<=0?It>=Ve?1:0:Math.max(0,Math.min((It-Oe)/Et,1))}if(!E.targetWeight&&!E.targetReps)return null;const S=(E.startWeight||0)*(E.startReps||0),q=(E.targetWeight||0)*(E.targetReps||0),Z=(he.weight||0)*(he.reps||0),$e=q-S;return $e<=0?Z>=q?1:0:Math.max(0,Math.min((Z-S)/$e,1))},ds=G=>{const he=Ee[G];if(!he||!he.targetValue)return null;const E=He?.bodyMetrics?.[G];if(E==null)return null;const S=he.startValue||0,q=he.targetValue,Z=q-S;return Z===0?E===q?1:0:Math.max(0,Math.min((E-S)/Z,1))},Es=G=>{Fe.current=G.touches[0].clientX,Ze.current=0},Ls=G=>{Ze.current=G.touches[0].clientX-Fe.current},F=()=>{Ze.current<-50?Xe(g+1):Ze.current>50&&Xe(g-1),Ze.current=0},ve=G=>{const he=He?.bodyMetrics?.[G],E=yt?.bodyMetrics?.[G];return he==null||E==null?null:parseFloat((he-E).toFixed(2))},we=t.find(G=>G.month===re),_e=t.find(G=>G.month===Le);if(Ut||l)return r.jsxs("div",{className:"pb-page",children:[r.jsx("header",{className:"client-header",children:r.jsx("div",{className:"header-content",children:r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})})}),r.jsxs("main",{className:"pb-main",children:[r.jsx("div",{className:"skeleton skeleton-title",style:{width:180,height:28,marginBottom:20}}),r.jsx("div",{className:"skeleton skeleton-card-large",style:{height:320,borderRadius:16}})]})]});if(!Ct||!zs||!gt)return null;if(Ts&&gt?.isJunior)return r.jsx(nP,{});const ge=Aa[g],at=He?.benchmarks?.[ge.key],Rt=yt?.benchmarks?.[ge.key],lt=Ll(ge,at),bt=Ll(ge,Rt),Tt=Zp(lt,bt),os=Zs(ge.key,at),Bn=os!==null,fn=os!==null&&os>=1,_n=Bn?Math.round(os*60):lt>0?15:0,Ys=ye[ge.key];return r.jsx(xa,{children:r.jsxs("div",{className:"pb-page",children:[r.jsx("header",{className:"client-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{className:"header-back-btn",onClick:()=>qt(is?"/client/core-buddy":"/client"),"aria-label":"Go back",children:r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M15 18l-6-6 6-6"})})}),r.jsx("img",{src:"/Logo.webp",alt:"Mind Core Fitness",className:"header-logo",width:"50",height:"50"})]})}),r.jsxs("main",{className:"pb-main page-transition-enter",children:[r.jsxs("div",{className:"pb-intro",children:[r.jsx("h2",{children:"Personal Bests"}),r.jsx("p",{children:Ts?"Track your strength benchmarks and body measurements each month.":"Your all-time best lifts from programme workouts."})]}),!Ts&&r.jsxs("div",{className:"pb-cb-section",children:[Object.keys(qe).length===0?r.jsxs("div",{className:"pb-empty",children:[r.jsx("div",{className:"pb-cb-empty-icon",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M20.57 14.86L22 13.43 20.57 12 17 15.57 8.43 7 12 3.43 10.57 2 9.14 3.43 7.71 2 5.57 4.14 4.14 2.71 2.71 4.14l1.43 1.43L2 7.71l1.43 1.43L2 10.57 3.43 12 7 8.43 15.57 17 12 20.57 13.43 22l1.43-1.43L16.29 22l2.14-2.14 1.43 1.43 1.43-1.43-1.43-1.43L22 16.29z"})})}),r.jsx("h4",{children:"No personal bests yet"}),r.jsx("p",{children:"Complete weight-based workouts to start tracking your personal bests."})]}):r.jsx("div",{className:"pb-cb-grouped",children:(()=>{const G={},he=[];Object.entries(qe).forEach(([S,q])=>{const Z=aP(S);Z?(G[Z]||(G[Z]=[]),G[Z].push([S,q])):he.push([S,q])}),Object.values(G).forEach(S=>S.sort(([q],[Z])=>q.localeCompare(Z))),he.sort(([S],[q])=>S.localeCompare(q));let E=0;return r.jsxs(r.Fragment,{children:[rP.map(S=>{const q=G[S.key];return!q||q.length===0?null:r.jsxs("div",{className:"pb-cb-group",children:[r.jsxs("div",{className:"pb-cb-group-header",style:{"--group-color":S.color},children:[r.jsx("div",{className:"pb-cb-group-icon",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:r.jsx("path",{d:S.icon})})}),r.jsxs("div",{className:"pb-cb-group-text",children:[r.jsx("h3",{className:"pb-cb-group-label",children:S.label}),r.jsx("span",{className:"pb-cb-group-subtitle",children:S.subtitle})]}),r.jsx("span",{className:"pb-cb-group-count",children:q.length})]}),r.jsx("div",{className:"pb-cb-grid",children:q.map(([Z,$e])=>{const Oe=kt[Z],Ve=Ue(Z),It=Ve!==null&&Ve>=1,Et=et(Z),hs=Ve!==null?Math.round(Ve*60):60,an=E++;return r.jsxs("div",{className:"pb-cb-card",style:{"--group-color":S.color,animationDelay:`${an*.05}s`},children:[r.jsxs("div",{className:"pb-cb-card-top",children:[r.jsxs("div",{className:"pb-cb-card-ring",children:[r.jsx("svg",{className:"pb-cb-ring-svg",viewBox:"0 0 80 80",children:b2.map((Hs,As)=>{const Is=As<hs;return r.jsx("line",{x1:Hs.x1,y1:Hs.y1,x2:Hs.x2,y2:Hs.y2,className:`pb-ring-tick ${Is?It?"hit":"filled":"empty"}`,style:Is&&!It?{stroke:S.color}:void 0,strokeWidth:Hs.thick?"2":"1.5"},As)})}),r.jsx("div",{className:"pb-cb-ring-icon",style:{color:S.color},children:Et?r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",className:"pb-cb-badge-earned",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}):r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:r.jsx("path",{d:S.icon})})})]}),r.jsxs("div",{className:"pb-cb-card-info",children:[r.jsx("h4",{className:"pb-cb-card-name",children:Z}),r.jsxs("div",{className:"pb-cb-card-value",style:{color:S.color},children:[$e.weight,"kg  ",$e.reps]}),$e.achievedAt&&r.jsx("div",{className:"pb-cb-card-date",children:($e.achievedAt.toDate?$e.achievedAt.toDate():new Date($e.achievedAt)).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"})}),Oe&&It&&!Et&&r.jsx("div",{className:"pb-cb-target-info hit",children:"Target hit!"}),Et&&r.jsx("div",{className:"pb-cb-target-info earned",children:"Badge earned!"})]}),r.jsx("div",{className:"pb-cb-card-action",children:r.jsx("button",{className:"pb-cb-target-btn",style:{borderColor:S.color,background:`color-mix(in srgb, ${S.color} 10%, transparent)`,color:S.color},onClick:()=>{pt(Z),Zt("")},children:Oe?It&&Et?r.jsx("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M12 5v14M5 12h14"})}):r.jsxs("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),r.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]}):r.jsxs("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("circle",{cx:"12",cy:"12",r:"6"}),r.jsx("circle",{cx:"12",cy:"12",r:"2"})]})})})]}),Oe&&!It&&r.jsxs("div",{className:"pb-cb-card-progress",children:[r.jsxs("div",{className:"pb-cb-progress-labels",children:[r.jsxs("span",{className:"pb-cb-progress-current",children:[$e.weight,"kg"]}),r.jsxs("span",{className:"pb-cb-progress-target",style:{color:S.color},children:["Target: ",Oe.targetWeight,"kg"]})]}),r.jsx("div",{className:"pb-cb-progress-bar",children:r.jsx("div",{className:"pb-cb-progress-bar-fill",style:{width:`${Math.round((Ve||0)*100)}%`,background:S.color}})}),r.jsxs("div",{className:"pb-cb-progress-pct",style:{color:S.color},children:[Math.round((Ve||0)*100),"%"]})]}),Oe&&It&&r.jsx("div",{className:"pb-cb-card-progress",children:r.jsx("div",{className:"pb-cb-progress-bar",children:r.jsx("div",{className:"pb-cb-progress-bar-fill hit",style:{width:"100%"}})})})]},Z)})})]},S.key)}),he.length>0&&r.jsxs("div",{className:"pb-cb-group",children:[r.jsxs("div",{className:"pb-cb-group-header",style:{"--group-color":"var(--text-tertiary)"},children:[r.jsx("div",{className:"pb-cb-group-text",children:r.jsx("h3",{className:"pb-cb-group-label",children:"Other"})}),r.jsx("span",{className:"pb-cb-group-count",children:he.length})]}),r.jsx("div",{className:"pb-cb-grid",children:he.map(([S,q])=>{const Z=kt[S],$e=Ue(S),Oe=$e!==null&&$e>=1,Ve=et(S),It=$e!==null?Math.round($e*60):60,Et=E++;return r.jsxs("div",{className:"pb-cb-card",style:{animationDelay:`${Et*.05}s`},children:[r.jsxs("div",{className:"pb-cb-card-top",children:[r.jsxs("div",{className:"pb-cb-card-ring",children:[r.jsx("svg",{className:"pb-cb-ring-svg",viewBox:"0 0 80 80",children:b2.map((hs,an)=>{const Hs=an<It;return r.jsx("line",{x1:hs.x1,y1:hs.y1,x2:hs.x2,y2:hs.y2,className:`pb-ring-tick ${Hs?Oe?"hit":"filled":"empty"}`,strokeWidth:hs.thick?"2":"1.5"},an)})}),r.jsx("div",{className:"pb-cb-ring-icon",children:Ve?r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",className:"pb-cb-badge-earned",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}):r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M20.57 14.86L22 13.43 20.57 12 17 15.57 8.43 7 12 3.43 10.57 2 9.14 3.43 7.71 2 5.57 4.14 4.14 2.71 2.71 4.14l1.43 1.43L2 7.71l1.43 1.43L2 10.57 3.43 12 7 8.43 15.57 17 12 20.57 13.43 22l1.43-1.43L16.29 22l2.14-2.14 1.43 1.43 1.43-1.43-1.43-1.43L22 16.29z"})})})]}),r.jsxs("div",{className:"pb-cb-card-info",children:[r.jsx("h4",{className:"pb-cb-card-name",children:S}),r.jsxs("div",{className:"pb-cb-card-value",children:[q.weight,"kg  ",q.reps]}),q.achievedAt&&r.jsx("div",{className:"pb-cb-card-date",children:(q.achievedAt.toDate?q.achievedAt.toDate():new Date(q.achievedAt)).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"})}),Z&&Oe&&!Ve&&r.jsx("div",{className:"pb-cb-target-info hit",children:"Target hit!"}),Ve&&r.jsx("div",{className:"pb-cb-target-info earned",children:"Badge earned!"})]}),r.jsx("div",{className:"pb-cb-card-action",children:r.jsx("button",{className:"pb-cb-target-btn",onClick:()=>{pt(S),Zt("")},children:Z?Oe&&Ve?r.jsx("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M12 5v14M5 12h14"})}):r.jsxs("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),r.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]}):r.jsxs("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("circle",{cx:"12",cy:"12",r:"6"}),r.jsx("circle",{cx:"12",cy:"12",r:"2"})]})})})]}),Z&&!Oe&&r.jsxs("div",{className:"pb-cb-card-progress",children:[r.jsxs("div",{className:"pb-cb-progress-labels",children:[r.jsxs("span",{className:"pb-cb-progress-current",children:[q.weight,"kg"]}),r.jsxs("span",{className:"pb-cb-progress-target",children:["Target: ",Z.targetWeight,"kg"]})]}),r.jsx("div",{className:"pb-cb-progress-bar",children:r.jsx("div",{className:"pb-cb-progress-bar-fill",style:{width:`${Math.round(($e||0)*100)}%`}})}),r.jsxs("div",{className:"pb-cb-progress-pct",children:[Math.round(($e||0)*100),"%"]})]}),Z&&Oe&&r.jsx("div",{className:"pb-cb-card-progress",children:r.jsx("div",{className:"pb-cb-progress-bar",children:r.jsx("div",{className:"pb-cb-progress-bar-fill hit",style:{width:"100%"}})})})]},S)})})]})]})})()}),Object.keys(qe).length>0&&r.jsxs("button",{className:"pb-cb-achievements-link",onClick:()=>qt("/client/core-buddy/achievements"),children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"18",height:"18",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),"View Achievements",r.jsx("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M9 18l6-6-6-6"})})]}),At&&r.jsx("div",{className:"pb-cb-target-modal-overlay",onClick:()=>pt(null),children:r.jsxs("div",{className:"pb-cb-target-modal",onClick:G=>G.stopPropagation(),children:[r.jsx("h3",{children:"Set Target"}),r.jsx("p",{className:"pb-cb-target-exercise-name",children:At}),r.jsxs("div",{className:"pb-cb-target-current",children:["Current PB: ",r.jsxs("strong",{children:[qe[At]?.weight,"kg"]})]}),r.jsxs("div",{className:"pb-cb-target-input-wrap",children:[r.jsx("label",{children:"Your target (kg)"}),r.jsx("input",{type:"number",inputMode:"decimal",step:"0.5",value:ue,onChange:G=>Zt(G.target.value),placeholder:String((qe[At]?.weight||0)+5),className:"pb-cb-target-input",autoFocus:!0})]}),r.jsxs("div",{className:"pb-cb-target-actions",children:[r.jsx("button",{className:"pb-cancel-btn",onClick:()=>pt(null),children:"Cancel"}),r.jsx("button",{className:"pb-save-btn",onClick:Be,disabled:d,children:d?"Saving...":"Set Target"})]})]})})]}),Ts&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"pb-tabs",children:[r.jsx("button",{className:`pb-tab ${n==="bests"?"active":""}`,onClick:()=>e("bests"),children:"Strength"}),r.jsx("button",{className:`pb-tab ${n==="metrics"?"active":""}`,onClick:()=>e("metrics"),children:"Body Metrics"}),r.jsx("button",{className:`pb-tab ${n==="history"?"active":""}`,onClick:()=>e("history"),children:"History"})]}),n==="bests"&&r.jsxs("div",{className:"pb-strength-section",children:[!w&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"pb-carousel",ref:Ae,onTouchStart:Es,onTouchMove:Ls,onTouchEnd:F,children:[r.jsx("div",{className:`pb-ring-container slide-from-${Ke.current}`,children:r.jsxs("div",{className:"pb-ring",children:[r.jsx("svg",{className:"pb-ring-svg",viewBox:"0 0 200 200",children:Yy.map((G,he)=>{const E=he<Math.round(_n);return r.jsx("line",{x1:G.x1,y1:G.y1,x2:G.x2,y2:G.y2,className:`pb-ring-tick ${E?fn?"hit":"filled":"empty"}`,strokeWidth:G.thick?"3":"2"},he)})}),r.jsxs("div",{className:"pb-ring-center",children:[r.jsx("div",{className:"pb-ring-category",children:ge.category}),r.jsxs("div",{className:"pb-ring-exercise",children:[ge.name,Yt("strength",ge.key)&&r.jsx("svg",{className:"pb-badge-icon",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})]}),r.jsx("div",{className:"pb-ring-value",children:at?ge.unit==="time"?dh(at.time):E2(at.weight,at.reps):"-"}),Tt!==null&&r.jsxs("div",{className:`pb-ring-change ${Tt>=0?"positive":"negative"}`,children:[Tt>=0?"+":"",Tt.toFixed(1),"%"]}),Tt===null&&at&&r.jsx("div",{className:"pb-ring-change neutral",children:"New entry"}),Ys&&r.jsx("div",{className:`pb-ring-target ${fn?"hit":""}`,children:fn?"Target hit!":Ys.targetType==="time"?`${Ys.startValue||0}s  ${Ys.targetValue}s`:`${Ys.startWeight||0}kg${Ys.startReps||0}  ${Ys.targetWeight}kg${Ys.targetReps}`}),!Ys&&r.jsx("div",{className:"pb-ring-target none",children:"No target set"})]})]})},g),r.jsx("div",{className:"pb-carousel-dots",children:Aa.map((G,he)=>r.jsx("button",{className:`pb-dot ${he===g?"active":""}`,onClick:()=>Xe(he)},he))}),r.jsx("button",{className:"pb-carousel-arrow left",onClick:()=>Xe(g-1),disabled:g===0,children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"})})}),r.jsx("button",{className:"pb-carousel-arrow right",onClick:()=>Xe(g+1),disabled:g===Aa.length-1,children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M8.59 16.59L10 18l6-6-6-6-1.41 1.41L13.17 12z"})})})]}),r.jsxs("div",{className:"pb-trend-section",children:[r.jsx("h4",{children:"Trend"}),r.jsx(oP,{data:t,exerciseKey:ge.key,unit:ge.unit})]})]}),!w&&!H&&r.jsxs("div",{className:"pb-action-buttons",children:[r.jsx("button",{className:"pb-edit-btn",onClick:()=>k(!0),children:He?.benchmarks?"Edit This Month's Benchmarks":"Add This Month's Benchmarks"}),r.jsx("button",{className:"pb-edit-btn pb-target-btn",onClick:()=>B(!0),children:Object.keys(ye).length>0?"Edit Targets":"Set Targets"}),(Object.keys(ye).length>0||Object.keys(Ee).length>0)&&r.jsx("button",{className:"pb-edit-btn pb-reset-btn",onClick:Rs,disabled:d,children:"Reset All Goals"})]}),w&&r.jsxs("div",{className:"pb-edit-card",children:[r.jsxs("div",{className:"pb-edit-header",children:[r.jsxs("h3",{children:["Benchmarks - ",pa(De)]}),r.jsx("button",{className:"pb-edit-close",onClick:()=>{k(!1),se(He?.benchmarks||{})},children:""})]}),r.jsx("div",{className:"pb-edit-body",children:Aa.map(G=>r.jsxs("div",{className:"pb-edit-exercise",children:[r.jsx("div",{className:"pb-edit-exercise-name",children:G.name}),G.unit==="weight"?r.jsxs("div",{className:"pb-edit-row",children:[r.jsxs("div",{className:"pb-edit-field",children:[r.jsx("label",{children:"Weight (kg)"}),r.jsx("input",{type:"number",step:"0.5",value:V[G.key]?.weight??"",onChange:he=>it(G.key,"weight",he.target.value),placeholder:"0"})]}),r.jsxs("div",{className:"pb-edit-field",children:[r.jsx("label",{children:"Reps"}),r.jsx("input",{type:"number",value:V[G.key]?.reps??"",onChange:he=>it(G.key,"reps",he.target.value),placeholder:"0"})]})]}):r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsx("label",{children:"Time (seconds)"}),r.jsx("input",{type:"number",step:"0.01",value:V[G.key]?.time??"",onChange:he=>it(G.key,"time",he.target.value),placeholder:"0"})]})})]},G.key))}),r.jsxs("div",{className:"pb-edit-actions",children:[r.jsx("button",{className:"pb-cancel-btn",onClick:()=>{k(!1),se(He?.benchmarks||{})},children:"Cancel"}),r.jsx("button",{className:"pb-save-btn",onClick:J,disabled:d,children:d?"Saving...":"Save"})]})]}),H&&r.jsxs("div",{className:"pb-edit-card",children:[r.jsxs("div",{className:"pb-edit-header",children:[r.jsx("h3",{children:"Set Your Targets"}),r.jsx("button",{className:"pb-edit-close",onClick:()=>{B(!1),A(ye)},children:""})]}),r.jsxs("div",{className:"pb-edit-body",children:[r.jsx("p",{className:"pb-target-hint",children:"Set a target for each exercise. Your current best is captured automatically from your latest benchmarks."}),Aa.map(G=>{const he=He?.benchmarks?.[G.key];let E="-";return he&&(G.unit==="time"&&he.time?E=`${he.time}s`:(he.weight||he.reps)&&(E=`${he.weight||0}kg  ${he.reps||0}`)),r.jsxs("div",{className:"pb-edit-exercise",children:[r.jsxs("div",{className:"pb-edit-exercise-header",children:[r.jsx("div",{className:"pb-edit-exercise-name",children:G.name}),r.jsxs("div",{className:"pb-edit-current-best",children:["Current: ",E]})]}),G.unit==="weight"?r.jsxs("div",{className:"pb-edit-row",children:[r.jsxs("div",{className:"pb-edit-field",children:[r.jsx("label",{children:"Target Weight (kg)"}),r.jsx("input",{type:"number",step:"0.5",value:T[G.key]?.targetWeight??"",onChange:S=>jt(G.key,"targetWeight",S.target.value),placeholder:"0"})]}),r.jsxs("div",{className:"pb-edit-field",children:[r.jsx("label",{children:"Target Reps"}),r.jsx("input",{type:"number",value:T[G.key]?.targetReps??"",onChange:S=>jt(G.key,"targetReps",S.target.value),placeholder:"0"})]})]}):r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsx("label",{children:"Target (seconds)"}),r.jsx("input",{type:"number",step:"1",value:T[G.key]?.targetValue??"",onChange:S=>jt(G.key,"targetValue",S.target.value),placeholder:"0"})]})})]},G.key)})]}),r.jsxs("div",{className:"pb-edit-actions",children:[r.jsx("button",{className:"pb-cancel-btn",onClick:()=>{B(!1),A(ye)},children:"Cancel"}),r.jsx("button",{className:"pb-save-btn",onClick:ss,disabled:d,children:d?"Saving...":"Save Targets"})]})]})]}),n==="metrics"&&r.jsxs("div",{className:"pb-metrics-section",children:[!j&&!L&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"pb-metrics-card",children:[r.jsx("h3",{children:"Body Measurements"}),r.jsx("p",{className:"pb-metrics-month",children:pa(De)}),r.jsx("div",{className:"pb-metrics-list",children:Lo.map(G=>{const he=He?.bodyMetrics?.[G.key],E=ve(G.key),S=Ee[G.key],q=ds(G.key),Z=q!==null&&q>=1;return r.jsxs("div",{className:"pb-metric-row",children:[r.jsxs("div",{className:"pb-metric-top",children:[r.jsxs("div",{className:"pb-metric-left",children:[r.jsxs("span",{className:"pb-metric-name",children:[G.name,Yt("metric",G.key)&&r.jsx("svg",{className:"pb-badge-icon-sm",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})]}),S&&r.jsxs("span",{className:"pb-metric-target-label",children:["Target: ",S.targetValue," ",G.suffix]})]}),r.jsxs("div",{className:"pb-metric-values",children:[r.jsx("span",{className:"pb-metric-current",children:he!=null?`${he} ${G.suffix}`:"-"}),E!==null&&r.jsxs("span",{className:`pb-metric-change ${E>0?"up":E<0?"down":"same"}`,children:[E>0?"+":"",E," ",G.suffix]})]})]}),q!==null&&r.jsxs("div",{className:"pb-metric-progress",children:[r.jsx("div",{className:"pb-metric-bar",children:r.jsx("div",{className:`pb-metric-bar-fill ${Z?"hit":""}`,style:{width:`${Math.round(q*100)}%`}})}),r.jsx("span",{className:`pb-metric-percent ${Z?"hit":""}`,children:Z?"Hit!":`${Math.round(q*100)}%`})]})]},G.key)})})]}),r.jsxs("div",{className:"pb-action-buttons",children:[r.jsx("button",{className:"pb-edit-btn",onClick:()=>O(!0),children:He?.bodyMetrics?"Edit This Month's Measurements":"Add This Month's Measurements"}),r.jsx("button",{className:"pb-edit-btn pb-target-btn",onClick:()=>D(!0),children:Object.keys(Ee).length>0?"Edit Targets":"Set Targets"}),(Object.keys(ye).length>0||Object.keys(Ee).length>0)&&r.jsx("button",{className:"pb-edit-btn pb-reset-btn",onClick:Rs,disabled:d,children:"Reset All Goals"})]})]}),j&&r.jsxs("div",{className:"pb-edit-card",children:[r.jsxs("div",{className:"pb-edit-header",children:[r.jsxs("h3",{children:["Measurements - ",pa(De)]}),r.jsx("button",{className:"pb-edit-close",onClick:()=>{O(!1),oe(He?.bodyMetrics||{})},children:""})]}),r.jsx("div",{className:"pb-edit-body",children:Lo.map(G=>r.jsx("div",{className:"pb-edit-metric",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsxs("label",{children:[G.name," (",G.suffix,")"]}),r.jsx("input",{type:"number",step:"0.1",value:K[G.key]??"",onChange:he=>Dt(G.key,he.target.value),placeholder:"0"})]})},G.key))}),r.jsxs("div",{className:"pb-edit-actions",children:[r.jsx("button",{className:"pb-cancel-btn",onClick:()=>{O(!1),oe(He?.bodyMetrics||{})},children:"Cancel"}),r.jsx("button",{className:"pb-save-btn",onClick:be,disabled:d,children:d?"Saving...":"Save"})]})]}),L&&r.jsxs("div",{className:"pb-edit-card",children:[r.jsxs("div",{className:"pb-edit-header",children:[r.jsx("h3",{children:"Body Metric Targets"}),r.jsx("button",{className:"pb-edit-close",onClick:()=>{D(!1),M(Ee)},children:""})]}),r.jsxs("div",{className:"pb-edit-body",children:[r.jsx("p",{className:"pb-target-hint",children:"Set targets for your body measurements. Your current measurement is captured automatically."}),Lo.map(G=>{const he=He?.bodyMetrics?.[G.key];return r.jsxs("div",{className:"pb-edit-exercise",children:[r.jsxs("div",{className:"pb-edit-exercise-header",children:[r.jsx("div",{className:"pb-edit-exercise-name",children:G.name}),r.jsxs("div",{className:"pb-edit-current-best",children:["Current: ",he!=null?`${he} ${G.suffix}`:"-"]})]}),r.jsx("div",{className:"pb-edit-row",children:r.jsxs("div",{className:"pb-edit-field full",children:[r.jsxs("label",{children:["Target (",G.suffix,")"]}),r.jsx("input",{type:"number",step:"0.1",value:z[G.key]?.targetValue??"",onChange:E=>Qt(G.key,E.target.value),placeholder:"0"})]})})]},G.key)})]}),r.jsxs("div",{className:"pb-edit-actions",children:[r.jsx("button",{className:"pb-cancel-btn",onClick:()=>{D(!1),M(Ee)},children:"Cancel"}),r.jsx("button",{className:"pb-save-btn",onClick:zt,disabled:d,children:d?"Saving...":"Save Targets"})]})]})]}),n==="history"&&r.jsx("div",{className:"pb-history-section",children:t.length===0?r.jsxs("div",{className:"pb-empty",children:[r.jsx("h4",{children:"No records yet"}),r.jsx("p",{children:"Start adding your monthly benchmarks and measurements to track your progress over time."})]}):r.jsxs(r.Fragment,{children:[Ge.length>0&&r.jsxs("div",{className:"pb-achievements-wall",children:[r.jsxs("h4",{className:"pb-achievements-wall-title",children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"18",height:"18",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),"Targets Achieved"]}),r.jsx("div",{className:"pb-achievements-list",children:[...Ge].reverse().map((G,he)=>r.jsxs("div",{className:"pb-achievement-item",style:{animationDelay:`${he*.05}s`},children:[r.jsx("div",{className:"pb-achievement-star",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),r.jsxs("div",{className:"pb-achievement-info",children:[r.jsx("span",{className:"pb-achievement-label",children:G.label}),r.jsx("span",{className:"pb-achievement-date",children:pa(G.achievedMonth)})]})]},he))})]}),r.jsx("div",{className:"pb-history-controls",children:r.jsx("button",{className:`pb-compare-toggle ${X?"active":""}`,onClick:()=>{P(!X),!X&&t.length>=2&&(Re(t[0].month),tt(t[t.length-1].month))},children:X?"Back to Timeline":"Compare Months"})}),X?r.jsxs("div",{className:"pb-compare",children:[r.jsxs("div",{className:"pb-compare-selectors",children:[r.jsxs("div",{className:"pb-compare-select",children:[r.jsx("label",{children:"From"}),r.jsx("select",{value:re,onChange:G=>Re(G.target.value),children:t.map(G=>r.jsx("option",{value:G.month,children:pa(G.month)},G.month))})]}),r.jsx("div",{className:"pb-compare-vs",children:"vs"}),r.jsxs("div",{className:"pb-compare-select",children:[r.jsx("label",{children:"To"}),r.jsx("select",{value:Le,onChange:G=>tt(G.target.value),children:t.map(G=>r.jsx("option",{value:G.month,children:pa(G.month)},G.month))})]})]}),we&&_e&&r.jsxs("div",{className:"pb-compare-results",children:[r.jsxs("div",{className:"pb-compare-group",children:[r.jsx("h4",{children:"Strength Benchmarks"}),r.jsxs("div",{className:"pb-compare-table",children:[r.jsxs("div",{className:"pb-compare-header-row",children:[r.jsx("span",{children:"Exercise"}),r.jsx("span",{children:pa(re).split(" ")[0]}),r.jsx("span",{children:pa(Le).split(" ")[0]}),r.jsx("span",{children:"Change"})]}),Aa.map(G=>{const he=we.benchmarks?.[G.key],E=_e.benchmarks?.[G.key],S=Ll(G,he),q=Ll(G,E),Z=Zp(q,S);return r.jsxs("div",{className:"pb-compare-row",children:[r.jsx("span",{className:"pb-compare-name",children:G.name}),r.jsx("span",{className:"pb-compare-val",children:he?G.unit==="time"?dh(he.time):`${he.weight}x${he.reps}`:"-"}),r.jsx("span",{className:"pb-compare-val",children:E?G.unit==="time"?dh(E.time):`${E.weight}x${E.reps}`:"-"}),r.jsx("span",{className:`pb-compare-change ${Z!==null?Z>=0?"positive":"negative":""}`,children:Z!==null?`${Z>=0?"+":""}${Z.toFixed(1)}%`:"-"})]},G.key)})]})]}),r.jsxs("div",{className:"pb-compare-group",children:[r.jsx("h4",{children:"Body Measurements"}),r.jsxs("div",{className:"pb-compare-table",children:[r.jsxs("div",{className:"pb-compare-header-row",children:[r.jsx("span",{children:"Measurement"}),r.jsx("span",{children:pa(re).split(" ")[0]}),r.jsx("span",{children:pa(Le).split(" ")[0]}),r.jsx("span",{children:"Change"})]}),Lo.map(G=>{const he=we.bodyMetrics?.[G.key],E=_e.bodyMetrics?.[G.key],S=he!=null&&E!=null?parseFloat((E-he).toFixed(2)):null;return r.jsxs("div",{className:"pb-compare-row",children:[r.jsx("span",{className:"pb-compare-name",children:G.name}),r.jsx("span",{className:"pb-compare-val",children:he!=null?`${he}`:"-"}),r.jsx("span",{className:"pb-compare-val",children:E!=null?`${E}`:"-"}),r.jsx("span",{className:`pb-compare-change ${S!==null?S>0?"positive":S<0?"negative":"neutral":""}`,children:S!==null?`${S>0?"+":""}${S} ${G.suffix}`:"-"})]},G.key)})]})]})]})]}):r.jsx("div",{className:"pb-timeline",children:[...t].reverse().map((G,he)=>{const E=t.find(S=>S.month<G.month&&t.indexOf(S)===t.indexOf(G)-1)||t.filter(S=>S.month<G.month).pop();return r.jsxs("div",{className:"pb-timeline-item",style:{animationDelay:`${he*.05}s`},children:[r.jsx("div",{className:"pb-timeline-dot"}),r.jsxs("div",{className:"pb-timeline-card",children:[r.jsx("h4",{children:pa(G.month)}),G.benchmarks&&Object.keys(G.benchmarks).length>0&&r.jsxs("div",{className:"pb-timeline-group",children:[r.jsx("h5",{children:"Strength Benchmarks"}),Aa.map(S=>{const q=G.benchmarks[S.key];if(!q)return null;const Z=E?.benchmarks?.[S.key],$e=Ll(S,q),Oe=Ll(S,Z),Ve=Zp($e,Oe);return r.jsxs("div",{className:"pb-timeline-row",children:[r.jsx("span",{className:"pb-timeline-label",children:S.name}),r.jsxs("div",{className:"pb-timeline-values",children:[r.jsx("span",{className:"pb-timeline-value",children:S.unit==="time"?dh(q.time):E2(q.weight,q.reps)}),Ve!==null&&r.jsxs("span",{className:`pb-timeline-change ${Ve>=0?"positive":"negative"}`,children:[Ve>=0?"+":"",Ve.toFixed(1),"%"]})]})]},S.key)})]}),G.bodyMetrics&&Object.keys(G.bodyMetrics).length>0&&r.jsxs("div",{className:"pb-timeline-group",children:[r.jsx("h5",{children:"Body Measurements"}),Lo.map(S=>{const q=G.bodyMetrics[S.key];if(q==null)return null;const Z=E?.bodyMetrics?.[S.key],$e=Z!=null?parseFloat((q-Z).toFixed(2)):null;return r.jsxs("div",{className:"pb-timeline-row",children:[r.jsx("span",{className:"pb-timeline-label",children:S.name}),r.jsxs("div",{className:"pb-timeline-values",children:[r.jsxs("span",{className:"pb-timeline-value",children:[q," ",S.suffix]}),$e!==null&&r.jsxs("span",{className:`pb-timeline-change ${$e>0?"positive":$e<0?"negative":"neutral"}`,children:[$e>0?"+":"",$e," ",S.suffix]})]})]},S.key)})]})]})]},G.id)})})]})})]})]}),$&&r.jsx("div",{className:"pb-celebration-overlay",onClick:()=>pe(null),children:r.jsxs("div",{className:"pb-celebration-card",children:[r.jsx("div",{className:"pb-celebration-icon",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),r.jsx("h3",{className:"pb-celebration-title",children:$.length===1?"Target Achieved!":`${$.length} Targets Achieved!`}),r.jsx("div",{className:"pb-celebration-badges",children:$.map((G,he)=>r.jsx("div",{className:"pb-celebration-badge",children:G.label},he))}),r.jsx("p",{className:"pb-celebration-sub",children:"Tap to dismiss"})]})}),Me&&r.jsxs("div",{className:`toast-notification ${Me.type}`,children:[r.jsx("span",{className:"toast-icon",children:Me.type==="success"?r.jsx("svg",{className:"success-check-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{className:"check-path",d:"M5 13 L9 17 L19 7"})}):r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",children:[r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"}),r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"})]})}),r.jsx("span",{className:"toast-message",children:Me.message}),r.jsx("button",{className:"toast-close",onClick:()=>Qe(null),children:""})]}),Ts&&r.jsxs("nav",{className:"block-bottom-nav",children:[r.jsxs("button",{className:"block-nav-tab",onClick:()=>qt("/client"),children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}),r.jsx("polyline",{points:"9 22 9 12 15 12 15 22"})]}),r.jsx("span",{children:"Home"})]}),r.jsxs("button",{className:"block-nav-tab",onClick:()=>qt("/client/forms"),children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),r.jsx("polyline",{points:"14 2 14 8 20 8"}),r.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),r.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"})]}),r.jsx("span",{children:"Forms"})]}),r.jsxs("button",{className:"block-nav-tab",onClick:()=>qt("/client/tools"),children:[r.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"})}),r.jsx("span",{children:"Tools"})]}),r.jsxs("button",{className:"block-nav-tab active",children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M12 20V10"}),r.jsx("path",{d:"M18 20V4"}),r.jsx("path",{d:"M6 20v-4"})]}),r.jsx("span",{children:"PBs"})]}),gt?.circuitAccess&&r.jsxs("button",{className:"block-nav-tab",onClick:()=>qt("/client/circuit"),children:[r.jsxs("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("path",{d:"M12 6v6l4 2"})]}),r.jsx("span",{children:"Circuit"})]})]}),is&&r.jsx(aa,{active:"progress"})]})})}const cP=v.lazy(()=>wr(()=>import("./Dashboard-ByFx2QoU.js"),__vite__mapDeps([0,1]))),uP=v.lazy(()=>wr(()=>import("./AddClient-CQAUtRgK.js"),__vite__mapDeps([2,3]))),dP=v.lazy(()=>wr(()=>import("./ClientDashboard-NoSl3reU.js"),[])),hP=v.lazy(()=>wr(()=>import("./ClientForms-C_FTmrLl.js"),__vite__mapDeps([4,5]))),mP=v.lazy(()=>wr(()=>import("./ClientTools-Cm_5Pxop.js"),__vite__mapDeps([6,7]))),fP=v.lazy(()=>wr(()=>import("./MacroCalculator-BckXyetb.js"),__vite__mapDeps([8,7]))),pP=v.lazy(()=>wr(()=>import("./ProteinSnacks-DVgisA-p.js"),__vite__mapDeps([9,7]))),gP=v.lazy(()=>wr(()=>import("./DailyMotivation-CU5UVvtp.js"),__vite__mapDeps([10,7]))),yP=v.lazy(()=>wr(()=>import("./CircuitDashboard-BlpNXdsN.js"),__vite__mapDeps([11,12]))),bP=v.lazy(()=>wr(()=>import("./CircuitBooking-BAgYrKqo.js"),__vite__mapDeps([13,14,12]))),vP=v.lazy(()=>wr(()=>import("./Leaderboard-Bwf80T9N.js"),__vite__mapDeps([15,16]))),xP=v.lazy(()=>wr(()=>import("./UpgradePage-C8upnP2j.js"),__vite__mapDeps([17,18,19]))),wP=v.lazy(()=>wr(()=>import("./SignUp-CjpSFbT0.js"),[])),_P=v.lazy(()=>wr(()=>import("./Onboarding-CyY-27ss.js"),__vite__mapDeps([20,18,21])));function kP({children:n}){const{pathname:e}=_a();return v.useEffect(()=>{"scrollRestoration"in window.history&&(window.history.scrollRestoration="manual")},[]),v.useEffect(()=>{window.scrollTo({top:0,left:0,behavior:"instant"})},[e]),n}function jP(){const n=$n();return v.useEffect(()=>{const e=sessionStorage.getItem("redirect");if(e){sessionStorage.removeItem("redirect");const t=e.replace("/login","")||"/";n(t,{replace:!0})}},[n]),null}function TP(){return r.jsx(U3,{children:r.jsx(B3,{children:r.jsx(H3,{children:r.jsxs(KE,{basename:"/login",children:[r.jsx(jP,{}),r.jsx(kP,{children:r.jsx(v.Suspense,{fallback:null,children:r.jsxs(kE,{children:[r.jsx(Js,{path:"/",element:r.jsx(G3,{})}),r.jsx(Js,{path:"/dashboard",element:r.jsx(cP,{})}),r.jsx(Js,{path:"/add-client",element:r.jsx(uP,{})}),r.jsx(Js,{path:"/client",element:r.jsx(dP,{})}),r.jsx(Js,{path:"/client/forms",element:r.jsx(hP,{})}),r.jsx(Js,{path:"/client/tools",element:r.jsx(mP,{})}),r.jsx(Js,{path:"/client/tools/macros",element:r.jsx(fP,{})}),r.jsx(Js,{path:"/client/tools/snacks",element:r.jsx(pP,{})}),r.jsx(Js,{path:"/client/tools/motivation",element:r.jsx(gP,{})}),r.jsx(Js,{path:"/client/personal-bests",element:r.jsx(lP,{})}),r.jsx(Js,{path:"/client/circuit",element:r.jsx(yP,{})}),r.jsx(Js,{path:"/client/circuit/booking",element:r.jsx(bP,{})}),r.jsx(Js,{path:"/client/core-buddy",element:r.jsx(pD,{})}),r.jsx(Js,{path:"/client/core-buddy/nutrition",element:r.jsx(Ml,{feature:"nutrition",children:r.jsx(bD,{})})}),r.jsx(Js,{path:"/client/core-buddy/workouts",element:r.jsx(CD,{})}),r.jsx(Js,{path:"/client/core-buddy/programmes",element:r.jsx(Ml,{feature:"programmes",children:r.jsx(DD,{})})}),r.jsx(Js,{path:"/client/core-buddy/achievements",element:r.jsx(Ml,{feature:"achievements",children:r.jsx(UD,{})})}),r.jsx(Js,{path:"/client/core-buddy/consistency",element:r.jsx(Ml,{feature:"consistency",children:r.jsx(WD,{})})}),r.jsx(Js,{path:"/client/core-buddy/buddies",element:r.jsx(Ml,{feature:"buddies",children:r.jsx(GD,{})})}),r.jsx(Js,{path:"/client/core-buddy/buddy",element:r.jsx(JD,{})}),r.jsx(Js,{path:"/client/core-buddy/profile/:userId",element:r.jsx(XD,{})}),r.jsx(Js,{path:"/client/leaderboard",element:r.jsx(Ml,{feature:"leaderboard",children:r.jsx(vP,{})})}),r.jsx(Js,{path:"/signup",element:r.jsx(wP,{})}),r.jsx(Js,{path:"/onboarding",element:r.jsx(_P,{})}),r.jsx(Js,{path:"/upgrade",element:r.jsx(xP,{})}),r.jsx(Js,{path:"*",element:r.jsx(wE,{to:"/",replace:!0})})]})})})]})})})})}_T.createRoot(document.getElementById("root")).render(r.jsx(v.StrictMode,{children:r.jsx(TP,{})}));"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/login/sw.js").catch(()=>{})});export{Hr as A,aa as C,xa as P,vt as T,hi as a,yr as b,$t as c,fe as d,We as e,UC as f,js as g,$C as h,Ss as i,r as j,Ns as k,Mr as l,ka as m,$n as n,$h as o,Yy as p,Ps as q,v as r,SP as s,vm as t,Ma as u,W3 as v,us as w,$3 as x,EP as y,ZE as z};
